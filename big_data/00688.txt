Neoclassical transport in pedestal with impurities

Global eﬀects on neoclassical transport in the pedestal with impurities

I. Pusztai,1, a) S. Buller,1 and M. Landreman2
1)Department of Physics, Chalmers University of Technology, SE-41296 G¨oteborg,
Sweden
2)Insitute for Research in Electronics and Applied Physics, University of Maryland, College Park, MD 20742,
USA.

(Dated: 3 March 2016)

We present a numerical study of collisional transport in a tokamak pedestal in the presence of non-trace impu-
rities, using the radially global δf neoclassical solver Perfect [M. Landreman et al. 2014 Plasma Phys. Con-
trol. Fusion 56 045005]. It is known that in a tokamak core with non-trace impurities present the radial im-
purity ﬂux opposes the bulk ion ﬂux to provide an ambipolar particle transport, with the electron transport
being negligibly small. However, in a sharp density pedestal with sub-sonic ion ﬂows the electron transport
can be comparable to the ion and impurity ﬂows. Furthermore, the neoclassical particle transport is not
intrinsically ambipolar, and the non-ambipolarity of the ﬂuxes extends outside the pedestal region by the
radial coupling of the perturbations. The neoclassical momentum transport, which is ﬁnite in the presence
of ion orbit-width scale proﬁle variations, is signiﬁcantly enhanced when impurities are present in non-trace
quantities, even if the total parallel mass ﬂow is dominated by the bulk ions.

PACS numbers:
Keywords:

I.

INTRODUCTION

The global conﬁnement in tokamaks is strongly corre-
lated with the performance indicators of the edge trans-
port barrier1,2. Accordingly, having a good pedestal per-
formance in a fusion reactor is considered to be crucial.
In the pedestal, turbulent transport is dramatically re-
duced by decorrelation of turbulence by strong sheared
ﬂows3,4, thus the relative role of the (otherwise negligi-
ble) collisional transport becomes more important.

Fusion reactors will need to operate with carbon-free
and low-erosion plasma facing components to achieve
reasonable lifetimes and for nuclear safety. To gain
more operational experience in the proposed metallic wall
devices, originally carbon walled tokamak experiments,
such as JET and ASDEX have transitioned to opera-
tion with “ITER-like walls” (with Be and W compo-
nents) in recent years. With this transition a global con-
ﬁnement degradation has been observed5,6, especially on
JET. This is a serious concern, since the data on which
experimental scaling relations (and projections for ITER)
are based has been mostly collected on carbon wall exper-
iments. This degradation is found to be primarily caused
by reduced pedestal performance5,6. Impurity injection
appears to have a beneﬁcial eﬀect in certain cases7. Over
and above the general importance of collisional impurity
transport, these observations motivate consideration of
the eﬀects of non-trace impurities in the pedestal.

Modeling of neoclassical transport in the pedestal is
diﬃcult, since the very sharp proﬁle variations make gra-
dient scale lengths comparable to the radial extent of the
ion drift orbits8, which renders the usual radially local

a)Electronic mail: pusztai@chalmers.se

modeling inadequate for the problem. It has been demon-
strated analytically that ﬁnite orbit width eﬀects can sig-
niﬁcantly modify neoclassical transport phenomena9–14,
producing modiﬁed ion heat transport, ﬂows, bootstrap
current, and even zonal ﬂow response. These studies are
limited to large aspect-ratio, circular cross-section plas-
mas and describe proﬁle variations mostly through local
plasma parameters, and point at the importance of a
short scale global variation of ﬂows14. In this paper we
go beyond the large aspect-ratio limit, and present a ra-
dially global numerical study of neoclassical transport in
the presence of non-trace impurities.

There are diﬀerent possible modeling options of vari-
ous sophistication and diﬃculty. The simplest option is
the computationally cheap and usually adopted local δf
formalism, which assumes small orbit width compared to
proﬁle length scales and neglects the radial coupling of
the perturbations. On the other end, the global full-f
approach includes both neoclassical and turbulent trans-
port (these transport channels cannot be completely de-
coupled in a pedestal,
in contrast to the local limit)
and allows for strong deviations from local thermody-
namic equilibrium. This approach requires nonlinear col-
lision operators to fully live up to its promises15, and is
currently numerically too expensive to be used for ex-
ploratory studies16,17. In this work, we use the global δf
formalism18. This is a speciﬁc generalization of the local
δf formalism which includes global eﬀects, while still al-
lowing the distribution function to be linearized around
an appropriately chosen lowest order Maxwellian. This
linearization, which assumes sub-sonic parallel ﬂows, im-
poses limitations on the proﬁles that can be considered.
Accordingly, we restrict ourselves to using suitable model
proﬁles, but with experimentally identiﬁable features.

In core plasmas the neoclassical perturbations of the
ion distribution are only weakly aﬀected by the electrons.

6
1
0
2

 
r
a

M
2

 

 
 
]
h
p
-
m
s
a
l
p

.
s
c
i
s
y
h
p
[
 
 

1
v
8
8
6
0
0

.

3
0
6
1
:
v
i
X
r
a

We ﬁnd that neoclassical particle transport in a pedestal
with subsonic ion ﬂows can be very diﬀerent from that
in the plasma core (Fig. 2a-c): The electron particle ﬂux
can be comparable to the ion particle ﬂux even in the
presence of non-trace impurities, and the collisional par-
ticle transport is not ambipolar in general. Consequently,
it can happen that ions and impurities are transported in
the same direction. In the presence of sharp proﬁle vari-
ations the neoclassical momentum transport is nonzero,
and we observe that its magnitude is notably aﬀected by
non-trace impurities (Fig. 8a).

The remainder of this paper is organized as follows. In
Sec. II, we describe the global δf method implemented
in Perfect, and how this aﬀects our choice of model
proﬁles. In Sec. III we ﬁrst present the neoclassical ﬂuxes,
ﬂows and poloidal density variations for our baseline case,
and then compare the results between plasmas with trace
and non-trace impurity content. Finally, in Sec. IV we
discuss our results and conclude.

II. METHODS

In a tokamak core the plasma parameter proﬁles of-
ten exhibit suﬃciently slow radial variations that the de-
parture of the distribution function from a Maxwellian
remains small, and the collisional dynamics can be de-
scribed in terms of local plasma parameters.
In this
situation neoclassical transport can be calculated using
the local δf formalism that yields a linear system for
the perturbed distribution. If the driving radial gradi-
ents are strong enough to generate substantial parallel
particle ﬂows, and poloidal variation in plasma parame-
ters, the problem becomes nonlinear19. Furthermore, if
all plasma parameters are allowed to vary over a radial
width of a typical ion orbit, the transport becomes radi-
ally non-local. To study such general situations a global
full-f simulation code with a nonlinear collision operator
would be necessary. While a limited number of such sim-
ulation codes exist16,20,21, their computational expense
make them unﬁt for our exploratory purposes. To keep
the problem tractable, we will only consider situations
when the distribution functions are not far from Maxwell-
Boltzmann distributions, but ﬁnite orbit width eﬀects
are still important. For this purpose, we use the radially
global, δf , Eulerian neoclassical solver Perfect.

The fact that the distribution functions must be close
to Maxwellians puts constraints on the proﬁles, as will
be discussed in the following section. These constraints
might not typically be satisﬁed in an experiment. There-
fore, we do not attempt to base our exploratory modeling
on speciﬁc experimental proﬁles, instead we use model
proﬁles chosen speciﬁcally to satisfy the assumptions in
Perfect, while they are supposed to be representative
of experimental proﬁles in some respects. The speciﬁc
proﬁles we use are presented in Appendix A. To explain
the origin of the constraints, the next section contains a
brief summary of the equations solved in Perfect (for a

II METHODS

more detailed description of the code, we refer the reader
to 18).

In addition to the constraints outlined below, Per-
fect does not capture the geometry of an X-point or
the open ﬁeld line region. Orbit losses22 and an inﬂux of
neutral atoms23 are expected to become important very
close to the separatrix. For this reason we expect that
our results are representative only of the inner part of
the pedestal.

A. The global δf problem solved by PERFECT

Perfect solves for the non-adiabatic perturbed dis-

tribution function

ga = fa − fM a +

eaΦ1
Ta

fM a,

(1)

ﬂux surface average is deﬁned as (cid:104)X(cid:105) = (cid:82) 2π
∇θ)−1/(cid:82) 2π

where fa is the distribution function, ea is the charge, and
Ta is the temperature of species a, Φ1 = Φ − Φ0 is the
perturbed potential, with the unperturbed electrostatic
potential Φ0 taken to be a ﬂux function, Φ0 = (cid:104)Φ(cid:105). The
0 Xdθ(B ·
0 dθ(B·∇θ)−1, where θ is a 2π-periodic angle-
like poloidal coordinate and B is the magnetic ﬁeld. The
perturbation ga is required to be small compared to the
lowest order distribution function, which is a Maxwell-
Boltzmann distribution

fM a(ψ, Wa0) = ηa(ψ)

− maWa0
e
Ta (ψ) ,

(2)

(cid:18) ma

(cid:19)3/2

2πTa(ψ)

where the radial coordinate ψ is 1/(2π) times the
poloidal magnetic ﬂux, ma is the mass, maWa0 =
mav2/2 + eaΦ0 is the total unperturbed energy, and
ηa = na(ψ)eeaΦ0(ψ)/Ta(ψ) is the pseudo-density. Hence-
forth, X1 refers to a ﬁrst-order correction to the quantity
X, which is allowed to vary poloidally, while all the lowest
order quantities are assumed to be ﬂux functions. The
linearized equation that Perfect solves is

(cid:0)v(cid:107)b + vda0

(cid:1)

· (∇ga)−Cla(ga) − Sa

(cid:18) ∂fM a

(cid:19)

= −vma · ∇ψ

∂ψ

, 18

(3)

where b = B/|B|, v(cid:107) = v · b with the velocity v, the
lowest order drift velocity vda0 contains the lowest or-
der E × B drift and magnetic drifts vma, Cla is the lin-
earized Fokker-Planck operator, and Sa is a source term,
which will be explained shortly. The partial derivatives
are taken at ﬁxed magnetic moment µa = mav2/(2B)
and unperturbed total energy Wa0.

Note that boundary conditions in ψ are needed to fully
specify ga by (3), in contrast to the local equation. Since
the local theory should apply suﬃciently far from the
pedestal, the result of local simulations – in which the
term is dropped from (3) – are im-
vda0 · (∇ga)µ,Wa0
posed as boundary conditions where particles enter the
domain18.

2

A The global δf problem solved by PERFECT

II METHODS

As inputs, Perfect requires zeroth order (ﬂux func-
tion) densities na, temperature Ta and potential Φ0.
Given these equilibrium proﬁles, ga is calculated from (3),
and appropriate velocity moments of ga provide the neo-
classical ﬂows and ﬂuxes. The ﬂuxes will in general not
be divergence free and thus incompatible with the time-
independent equilibrium proﬁles. It may seem instructive
to restore the time derivative in (3), and solve a time-
dependent problem, in a hope to reach a steady state
equilibrium. However, only exceptional proﬁles would
lead to a steady state solution. More generally, particles
and energy would accumulate in (or leave) the simulation
domain until the δf approach breaks down. Instead, the
approach adopted is to add spatially varying sources Sa
so that the zeroth-order proﬁles become consistent; these
sources are solved for in the code alongside ga. These
sources can be thought of as representing the eﬀects of
non-neoclassical transport needed to make the proﬁles
consistent, and should also be present in a real pedestal.
To guarantee that ga (cid:28) fa, the driving gradients in

the right-hand side of (3) should remain small. From

(cid:12)(cid:12)(cid:12)(cid:12)Wa0

∂fM a

∂ψ

η(cid:48)
a
ηa

+

=

(cid:18) maWa0

Ta −

3
2

(cid:19) T (cid:48)

a
Ta

,

(4)

where prime denotes the ψ-derivative, we see that the η
and temperature gradients set the size of ga, and thus
drive the deviations from a Maxwellian. Hence the den-
sity and the electrostatic potential may have sharp gra-
dients as long as they produce a slowly varying η. To
quantify what we mean by a sharp gradient, we may bal-
ance the v(cid:107)b·∇g and vma·∇ψ∂ψfM a terms in (3) to ﬁnd
that

ρpa|∇ψ|(log X)(cid:48)

(cid:28) 1

(5)

should be satisﬁed by Ta and ηa; that is, these quantities
should have a small relative change as experienced by
a particle during its radial drift excursion. Here ρpa =
vama/(eaBp) is the poloidal Larmor radius of the species,

with the thermal speed va =(cid:112)2Ta/ma, and the poloidal

magnetic ﬁeld Bp = B · ∇θ/|∇θ|.

B. Model proﬁles and magnetic geometry

Although we would like to use pedestal proﬁles which
are representative of experiments in some aspects, we re-
quire (5) to be satisﬁed in the simulations for all species
(a = {e, i, z} for electrons, ions and impurities, respec-
tively). We consider pedestals where na and Te are al-
lowed to vary on the ρpi scale, while the T and η gradients
of the bulk and impurity ion species are constrained by
(5).

As a starting point we considered proﬁles from typi-
cal JET discharges (Figure 16 of 24), and modiﬁed them
as necessary to satisfy our orderings, and to reduce the
need for heat sources in the simulation domain. The
speciﬁc choices made in constructing the model proﬁles

a

b

c

d

e

f

g

h

FIG. 1:

Ion (solid curve), impurity (dashed) and

electron (dash-dotted) input proﬁles (a-d) and derived

quantities (e-h) for the baseline simulation.

are discussed in Appendix A. The resulting input pro-
ﬁles for our baseline case as functions of the normalized
poloidal ﬂux ψN are shown in Fig. 1a-d. Here, we intro-
duced ψN = ψ/ψLCFS, where ψLCFS is the poloidal ﬂux
at the last closed ﬂux surface (LCFS). Note, that the
density proﬁle of impurities is much steeper than that
of the bulk ions to make ηa vary slowly. We consider
a deuterium plasma and fully ionized nitrogen impuri-
ties (Zz = 7) with a concentration nz/ni = 0.01 in the
core. The radii marking the beginning and the end of
the pedestal are indicated by dotted vertical lines in the
ﬁgures.

In the simulations we use a local Miller model
geometry25 (and neglect the radial variation of BP and
BT in the domain), with elongation κ = 1.58, sκ ≡
(r/κ)dκ/dr = 0.479, triangularity δ = 0.24, sδ ≡
(r/√1 − δ2)dδ/dr = 0.845, ∂R/∂r = −0.14, q = 3.5, and
inverse aspect ratio  ≡ r/R = 0.263. These parameters
were taken from 26.
The numerical resolution and convergence tests are de-

tailed in Appendix B.

3

1234n/(1020m−3)×10−11234×10−30.250.500.751.00T/keV0.01.53.0Φ/kV×10−110−310−1U10−310−1δn10−310−1δT0.900.920.940.960.981.003.03.54.04.5ˆν×10−2ψNC. Units

An input quantity X is supplied to Perfect in a nor-
malized, dimensionless form ˆX = X/ ¯X, with the nor-
malizing, dimensional quantity ¯X. We choose ¯R = 3.8 m
and ¯B = 2.9 T to be the major radius and magnetic ﬁeld
at the magnetic axis. Furthermore we choose the follow-
ing convenient units ¯n = 1020 m−3, ¯T = e ¯Φ = 1 keV,
¯m = md (deuterium mass), and ¯e is the elementary
charge. We deﬁne the reference speed and collision fre-

quency as ¯v =(cid:112)2 ¯T / ¯m and

√2
12π3/2

¯ν =

e4 ¯n ln Λ
0√ ¯m ¯T 3/2
2

,

(6)

where 0 denotes the vacuum permittivity and ln Λ is the
Coulomb logarithm. The ordinary same-species collision
frequency νaa is deﬁned as (6) but with ¯T and ¯n replaced
by Ta and na, from which we may deﬁne the collisionality
as ˆνaa = νaaqR/va.

To quantify when the local approximation fails, it is
useful to deﬁne a few additional quantities: The normal-
ized electric ﬁeld Ua = I/(Bva) dΦ0/dψ measures how
much the E × B drift competes with parallel streaming
in terms of poloidal particle motion. The normalized
logarithmic derivative δX = −Iva/(Ωa) d(ln X)/dψ mea-
sures the variation of quantity X along a typical drift
orbit, where Ωa = eaB/ma and I = RBT . Local neo-
classical theory is valid only when U , δn, δη, and δT are
all much smaller than unity in magnitude. The global δf
model also requires that |δT| (cid:28) 1 and |δη| (cid:28) 1, but U
and δn can be O(1). These derived quantities together
with ˆν are shown for the baseline proﬁles in Fig. 1e-h.

III.

LOCAL AND GLOBAL SIMULATION RESULTS

To study the diﬀerences between local and global neo-
classical transport we performed a number of Perfect
simulations with the proﬁles and magnetic geometry de-
scribed in Sec. II B. Before presenting the simulation re-
sults for our baseline set of proﬁles, we discuss the input
quantities.

sources, ˆSa = ¯v2 ¯RSa/(∆¯n ˆm3/2

We deﬁne the following normalized output quantities:
a ), with ∆ = ¯m¯v/(¯e ¯B ¯R);

ˆV (cid:48) = V (cid:48) ¯B/ ¯R, with V (cid:48) = (cid:72) dθ/|B · ∇θ|; particle
ﬂux, ˆΓa = (cid:82) d3vgavma/(¯n¯v); momentum ﬂux (divided
by mass), ˆΠa = (cid:82) d3vgav(cid:107)Ivma/(¯n¯v2 ¯RB); heat ﬂux,
ˆQa =(cid:82) d3vgamav2vma/(2 ¯T ¯n¯v); conductive heat ﬂuxes,
(cid:82) d3vv(cid:107)ga/(¯v∆na); parallel current, ˆJ(cid:107) = (cid:80)

ˆqa = ˆQa − (5/2) ˆT ˆΓa; parallel ﬂow velocity, ˆV(cid:107),a =
a Za ˆna ˆV(cid:107),a.
The neoclassical ﬂow coeﬃcient k(cid:107) is deﬁned so that it
(cid:19)
reduces to the ﬂux function poloidal ﬂow coeﬃcient for
a single ion species plasma in the local limit,

(cid:18) eaB

(cid:18) dT

dψ

(cid:19)−1 (cid:104)B2(cid:105)

B2

1
na

dpa
dψ

+ ea

dΦ
dψ

V(cid:107),a +

I

k(cid:107) =

,

(7)

4

III

LOCAL AND GLOBAL SIMULATION RESULTS

a

b

c

d

e

f

FIG. 2: Particle and heat ﬂuxes divided by the

normalized density, where the diﬀerent subplots show

the ﬂuxes for diﬀerent species. Solid (dashed) lines

represent global (local) simulations.

where pa = naTa is the pressure. Furthermore, we deﬁne
the non-adiabatic density perturbation ˜n(g)

a = (cid:82) d3vga,
the total density perturbation ˜na = (cid:82) d3v(fa − fM a),

and normalized scalar ﬂuxes
ˆψa ˆV (cid:48) ¯R
∆2π (cid:104) ˆFa · ∇ψN(cid:105),

ˆFa =

(8)

with ˆFa ( ˆFa) representing ˆΓa, ˆqa or ˆΠa (ˆΓa, ˆqa or ˆΠa,
respectively), and ˆψa = ψLCFS/( ¯R2 ¯B). Note that the
ﬂux normalizations are species independent.

A. Results for the baseline case

The scalar ﬂuxes of (8) divided by ˆn are shown in
Fig. 2. Throughout Sec. III solid lines represent global
simulation results, and dashed lines represent local ones.
When the impurity strength α = Zeﬀ − 1 is order unity
– as in our baseline – the magnitude of the particle trans-

port of electrons is typically (cid:112)me/mi/α smaller than
ity(cid:80)

that of the the impurities, where Zeﬀ denotes the eﬀec-
tive ion charge. In this case it is common to neglect ˆΓe
and calculate the ion particle transport from ambipolar-
a(cid:54)=e Za ˆΓa = 0, leading to opposing ion and impurity
particle ﬂuxes. The local simulations in the core region
obey these expectations. Since dTi/dψ is small in our
baseline, temperature screening does not dominate, thus

0.00.40.81.2ˆΓ/ˆni−101ˆΓ/ˆnz0.250.500.751.00ˆΓ/ˆne0.81.62.43.2ˆq/ˆni0.40.81.21.6ˆq/ˆnz0.900.920.940.960.981.000.00.40.81.2ˆq/ˆn×10−1eψNA Results for the baseline case

III

LOCAL AND GLOBAL SIMULATION RESULTS

a

b

c

a

b

c

FIG. 3: Particle (dark curves) and heat (light curves)

sources for the various species.

the local ﬂuxes obey ˆΓi > 0 and ˆΓz < 0. In the pedestal
the parallel ion-electron friction can be suﬃciently large
to compete with the ion-impurity friction, due to the high
electron ﬂow speeds. Therefore ˆΓe cannot be neglected
anymore in the ambipolarity condition: the strong out-
ward electron ﬂux means that both ˆΓz and ˆΓi are positive
simultaneously. Thus the outward local ˆΓz is not a result
of temperature screening.

As expected from the small Ue and δne values, seen
in Fig. 1e and f, the electron local and global ﬂuxes are
practically the same. However, ﬁnite orbit width eﬀects
strongly aﬀect the ion and impurity dynamics.
In the
pedestal ˆΓi
is increased compared to the local value,
which causes ˆΓz to change sign compared to its local
value. It is worth noting that the deviation between local
and global results is not localized to the pedestal region
only. For instance, the global and local ˆΓi deviate well
below ψN = 0.94; the ion particle ﬂux changes sign at
ψN = 0.91 while the local result is positive everywhere.
This is a result of radial coupling of the perturbations
across the ﬂux surfaces. The global particle ﬂuxes are
not ambipolar as seen at ψN = 0.94, where ˆΓi and ˆΓz are
both inward, and ˆΓe is small, very close to its local value.
Note that while in a local simulation the radial current
and momentum ﬂux should vanish, it does not need to
be so in global simulations, as pointed out in 18.

For both ions and impurities we observe that the con-
ductive heat ﬂux can signiﬁcantly diﬀer from the local
value. A reduction compared to the the local value –
observed around the pedestal top – may be explained by
the shift of the trapped region towards the tail of the
distribution at U ∼ 1. However, we also ﬁnd regions
where the heat ﬂuxes increase from their local values.
Just as for the particle ﬂuxes, we see a reduction inside
the pedestal top: ˆqi (ˆqz) reaches a minimum at ψN ≈ 0.92
(ψN ≈ 0.94).
The corresponding sources are presented in Fig. 3.
We use poloidally symmetric sources with speed depen-
dencies (x2
a) for particle and heat
sources, respectively, where xa = v/va. We see that to

a − {5, 3}/2) exp(−x2

FIG. 4: k(cid:107), deﬁned in (7), with darker lines being k(cid:107) at

the inboard side, θ = π, lighter at θ = 0, dashed lines

show the results of corresponding local simulations (the

outboard and inboard curves overlap).

some degree the main ion particle and heat sources qual-
itatively mirror each other, and tend towards zero out-
side the pedestal. Recall that we speciﬁcally choose Ti
to reduce the need for Shi, while Spi also remains small,
because ˆΓi tends to be smaller than ˆqi. The tremendous
drop in ˆnz in the pedestal leads to a sharp peak in Spz,
and again we see an opposing trend for Shz, but for im-
purities the combined sources are positive. The electron
sources are localized to the pedestal and comparable in
size to those of the main ions.

The neoclassical ﬂow coeﬃcients, k(cid:107), are presented in
Fig. 4. The local (dashed lines) k(cid:107)i is positive as expected
in the banana regime, and exhibits a slight variation as a
response to the radial variation of ˆν. In the local case k(cid:107)
is a ﬂux function, while globally it varies from the inboard
side (darker curves) to the outboard side (lighter curves).
These poloidal variations in the ﬂow appear together with
poloidal density variations, as will be discussed shortly.
It has been shown analytically10,12,14 that k(cid:107) is aﬀected
by ﬁnite orbit width eﬀects. As seen from the analytical
results, where vda0 · ∇θ is kept but the radial coupling
is neglected, k(cid:107) is expected to decrease or become more
negative in both the banana and plateau regimes10,12.
However, the global modiﬁcation to k(cid:107) is not a function
of local plasma parameters (such as Ua) only, but even
in the semi-global treatment of 14 it satisﬁes a radial
diﬀerential equation (i.e. ∂g/∂ψ cannot be neglected).
This is why k(cid:107) can diﬀer in sign and magnitude from the
local value well outside the pedestal, and can be larger
than its local value inside the pedestal. It is interesting
to note that there is a diﬀerence between global and local
k(cid:107) even for the electrons.

The density perturbations are shown in Fig. 5. We ﬁrst
consider only the non-adiabatic contribution to the per-
turbations, ˜n(g)
a /na, shown in Fig. 5a-f, where the global
(local) results are plotted in the a-c (d-f) panels. The
local simulations predict purely up-down density asym-
metry for all species, which is weaker for bulk ions and

5

−1.50.01.5×10−1i0.00.51.01.5×10−3z0.900.920.940.960.981.00−1012×10−1eˆSp,ˆShψN−2−10i−1.8−1.2−0.60.0×101z0.900.920.940.960.981.000.81.62.43.2ekkψNA Results for the baseline case

III

LOCAL AND GLOBAL SIMULATION RESULTS

a

d

g

j

b

e

h

k

c

f

i

l

FIG. 5: The non-adiabatic contribution to the density
perturbation (a-f), and the total density perturbation
(g-l). Dashed frame (d-f and j-l) indicates local results.

electrons than for impurities. The global results show
a more complicated poloidal density variation for both
ions and impurities. For ions we see an in-out asymme-
try (i.e. excess density around θ = π) at the pedestal
top, which transforms into an out-in asymmetry in the
pedestal, and reverses again further out (similarly to the
single species simulations of 27). For impurities the most
important diﬀerence compared to the local results is the
weak in-out (instead of strong up-down) asymmetry in
the pedestal. The electron density perturbation mostly
follows its local behavior, exhibiting a large increase in
the up-down asymmetry in the pedestal. To understand
the total density perturbation ˜na/na in global simula-
tions we note that the potential perturbation Φ1 follows
mostly the non-adiabatic ion density perturbation. The
total electron density perturbation is dominated by the
adiabatic response of electrons, thus it is very similar to
the ion density perturbation. The impurity density vari-
ations show a competition between adiabatic response –
especially in the pedestal where it tries to oppose the
ion density perturbation – and non-adiabatic response.
The relative impurity density variation stays below 10%
everywhere, showing that the assumption of the density
being nearly a ﬂux function is not violated. However, for
suﬃciently high Zz, nonlinearity from poloidal asymme-
tries can arise19,28,29.

6

a

b

c

d

FIG. 6:

(cid:104)BV(cid:107)(cid:105) for the diﬀerent species (b-d), and the
parallel current these add up to (a). Solid (dashed)
lines represent global (local) simulation.

Finally, we consider the parallel ﬂows and the boot-
strap current for our baseline case; these are plotted in
Fig. 6. The global result for the parallel electron ﬂow
follows the local one, and it strongly increases in mag-
nitude inside the pedestal, where the strong E × B and
diamagnetic rotation contribute with the same sign for
this species. For ions the ﬂows remain small inside the
pedestal, as their proﬁles were chosen speciﬁcally so that
their diamagnetic and E×B ﬂows mostly cancel. The ion
and impurity ﬂows deviate from the local results, being
larger in magnitude from the middle of the pedestal in-
ward. This is partly due to the reduction in k(cid:107) compared
to the local value observed in Fig. 4. Since we have a
weak ion temperature pedestal, the modiﬁcations of the
ion ﬂows are not suﬃcient to cause an appreciable devia-
tion of the bootstrap current from the local result inside
the pedestal, as seen in Fig. 6a. If anything, outside the
pedestal there is a slight diﬀerence between the local and
global results (barely visible on the scale accommodating
the huge bootstrap peak in the pedestal), since the elec-
tron ﬂow is relatively small in those regions, while the
global eﬀects on k(cid:107) extend outside the pedestal.

B. Non-trace impurities

We want to assess whether, and how, non-trace impu-
rities can aﬀect collisional transport in the pedestal. To
this end, we performed simulations with proﬁles similar
to our baseline, except that we varied the impurity con-
centration by constant factors. The simulations shown in
this section have impurity concentrations such that the
impurity strength in the core is either α = 0.02 (trace
impurities; shown with thin lines in the ﬁgures) or α = 2
(non-trace; thick lines). Note that nz/ni drops rapidly

0.51.01.5ize92.595.097.50.51.01.592.595.097.592.595.097.5−101×10−2−2.50.02.5×10−2−303×10−3θ/π100ψN0.51.01.5ize92.595.097.50.51.01.592.595.097.592.595.097.5−505×10−3−303×10−2−505×10−3θ/π100ψN1234hˆBˆjki×1020.60.81.01.2hˆBˆVki×102i0.450.600.750.90hˆBˆVki×102z0.900.920.940.960.981.00−0.9−0.6−0.30.0hˆBˆVki×103eψNB Non-trace impurities

III

LOCAL AND GLOBAL SIMULATION RESULTS

a

b

c

d

e

f

g

h

i

a

b

c

FIG. 8: Total momentum ﬂux (a), radial current (b)

and parallel mass ﬂow (c). Thick (thin) lines

correspond to α = 2 (α = 0.02).

ˆΓz, and its core behavior is dominated by following the
outward electron ﬂux. It is interesting to note that while
above ψN = 0.97 the local curves for diﬀerent impurity
concentration collapsed onto each other because of the
low nz/ni, the diﬀerence in the global ˆΓi/ˆni survives
much further out in the pedestal.

The d-f panels of Fig. 7 show the heat ﬂuxes. In the
core and close to the pedestal top the global results for qi
are lower than the local values. This reduction is some-
what stronger in the presence of impurities. The local re-
sults for ˆΓz and ˆqz are even higher in the pedestal at high
impurity concentration, than would be expected simply
due to the linear increase with ˆnz. This extra increase is
reduced by the global eﬀects so that the global results at
diﬀerent concentrations are closer to each other.

FIG. 7: Particle (a-c), heat (d-f) and momentum (g-i)
ﬂuxes divided by the normalized density for the various

species. Solid (dashed) lines represent global (local)

simulations, and thick (thin) lines correspond to α = 2

(α = 0.02).

across the pedestal, thus the impurities eventually be-
come trace even if they have a high core concentration
(this is necessary in the presence of an electron density
pedestal if we restrict proﬁle variations to obey the or-
derings of (5) for all ion species).

The a-c panels of Fig. 7 compare the local and global
particle ﬂuxes with trace and non-trace impurity concen-
tration. As usual, the local and global results for ˆΓe are
virtually the same. At higher impurity content the in-
crease in ˆΓe/ˆne around ψN = 0.95 reﬂects the increased
ne gradient due to the rapidly varying impurity concen-
tration (note that ni is kept ﬁxed in the impurity scan,
thus the ne proﬁle changes). The local ˆΓi behaves as
expected from the ambipolarity condition:
it increases
with impurity content in the core to balance the inward

7

Π = (cid:80)

The momentum ﬂux values for the diﬀerent species
(shown in Fig. 7g-i) vanish in the local limit, as they
should, but are ﬁnite when global eﬀects are considered.
Unlike ˆΓe and ˆqe, the global results for ˆΠe are diﬀer-
ent to the local ones, i.e. they are also ﬁnite, although
the electrons do not transport an appreciable amount of
momentum, as me/mi (cid:28) 1. The total momentum ﬂux,
a ˆma ˆΠa, shown in Fig. 8a, is mostly negative in
the studied radial range, and is strongly increase by the
presence of non-trace impurities. The ions are responsi-
ble for most of the momentum transport for both impu-
rity concentrations, thus the increase in |Π| is not due to
the increase in | ˆΠz|, but the modiﬁcations in ˆΠi in the
presence of impurities.
a Za ˆΓa (Fig. 8b) – that in
isolation from other transport channels would lead to
charge separation and the evolution of the radial elec-
tric ﬁeld – is also signiﬁcantly increased in magnitude by
the presence of the impurities over most of the studied
radial domain. Although we observe a ﬁnite radial neo-
classical current, we do not attempt to self-consistently
calculate the radial electric ﬁeld. For the interpreta-
tion of the momentum ﬂuxes and the radial current it
is useful to note that conservation of particle number

The radial current ˆj = (cid:80)

0.00.51.01.5ˆΓ/ˆni−1012ˆΓ/ˆnz0.40.81.21.6ˆΓ/ˆne0123ˆq/ˆni0.51.01.52.0ˆq/ˆnz0.00.51.0ˆq/ˆn×10−1e−5.0−2.50.0ˆmˆΠ/ˆn×10−1i−3.0−1.50.01.5ˆmˆΠ/ˆnz0.900.920.940.960.981.00−1.8−1.2−0.60.0ˆmˆΠ/ˆn×10−4eψN−1.2−0.60.0Π×10−1−1.50.01.5ˆj×10−10.900.920.940.960.981.000.81.62.4u×101ψNB Non-trace impurities

III

LOCAL AND GLOBAL SIMULATION RESULTS

a

b

a

b

c

FIG. 9:

(cid:104)BV(cid:107)(cid:105) for ions and impurities. Solid (dashed)
lines represent global (local) simulations, and thick

(thin) lines correspond to α = 2 (α = 0.02).

and parallel momentum (in steady state, for a radially
constant V (cid:48), and with sources even in v(cid:107)) imply that
dˆΓa/dψN ∝ ˆT 3/2 ˆSpa and dΠ/dψN ∝ ˆj. The latter prop-

particle sources for which(cid:80)

erty is apparent from a comparison of Fig. 8a and b. The
former relation states that non-ambipolar ﬂuxes require
a Za ˆSpa = 0 is not satisﬁed
locally (the factor ˆT 3/2 comes from the assumed velocity
space structure of Spa).

In radially local formalisms momentum transport is
often decomposed into diﬀusive (∝ −dua/dψN , where
ua = ˆna(cid:104) ˆB ˆV(cid:107)a(cid:105) ˆma is the normalized parallel mass ﬂow),
conductive (∝ ua) and intrinsic (independent of ua)
terms. Such a decomposition is not possible in our global
formalism since the parallel mass ﬂow is a non-local func-
tion of the various plasma parameter proﬁles, and so is
the momentum transport. Nevertheless, it is instruc-
tive to compare the radial proﬁle of the total momentum
transport Π to the radial variation of the total mass ﬂow
a ua shown in Fig. 8c (both quantities are domi-
nated by the main ion contributions). By increasing the
impurity content, u increases in the core region. This is

u =(cid:80)

caused by the higher ˆnz(cid:104) ˆB ˆV(cid:107)z(cid:105) at higher ˆnz not being
compensated by the slight reduction in (cid:104) ˆB ˆV(cid:107)i(cid:105) (shown

in Fig. 9). As the impurity concentration drops radially
across the pedestal, the eﬀect from the reduction in the
parallel ion ﬂow becomes dominant. The radial drop in
the global results for u across the pedestal is mostly due
to the density variation in the pedestal. If the transport
was local and purely diﬀusive this non-monotonic behav-
ior of u would be accompanied by a sign change in the
momentum transport. It is also interesting to note that
at the point where we see the greatest relative increase
in |Π| between the diﬀerent simulations (ψN ≈ 0.96), the
global u becomes lower for higher core impurity concen-
tration.

The radial current is aﬀected by the particle sources.
The ion particle source proﬁle shown in Fig. 10a is only
weakly aﬀected by the presence of non-trace impurities.
In the meantime, the increase in impurity sources are
approximately proportional to the increase in their con-

centration: the normalized particle source ˆSp(ni/nz)|core

is approximately the same in the two simulations, con-

FIG. 10: Particle (dark curves) and heat (light curves)
sources for the main ion and the impurity species, the
latter normalized by the impurity fraction in the core.

Thick (thin) lines correspond to α = 2 (α = 0.02).

a

b

c

FIG. 11: Total momentum ﬂux (a), radial current (b)
and parallel mass ﬂow (c) for beryllium impurity with
modiﬁed η proﬁles that make the impurity density less

steep. Thick (thin) lines correspond to α = 2

(α = 0.02).

sidering that the impurity content changes by a factor
100.

Finally we would like to assess how much our pro-
ﬁle choices aﬀect the observation of increased momen-
tum ﬂux in the presence of non-trace impurities. One
unnatural feature of our impurity density proﬁle is its
extreme steepness. Allowing ηi have a radial drop across
the pedestal – within what is allowed by (5) – to reduce
the inward radial electric ﬁeld, together with allowing ηz
to have an increase in the same region, leads to a less
sharp impurity pedestal. To further reduce the impurity
density gradient in the pedestal we consider a fully ion-
ized beryllium impurity (Z = 4). These changes make
our pedestal less deeply sub-sonic, as seen from the in-
creased mass ﬂow in Fig. 11c, which shows the results of
the modiﬁed input proﬁles. From Fig. 11a we can con-
clude that impurities also signiﬁcantly increase the mag-
nitude of the neoclassical momentum ﬂux in the pedestal

8

0.60.81.01.2hˆBˆVki×102i0.900.920.940.960.981.000.40.60.81.0hˆBˆVki×102zψN−3.0−1.50.01.5×10−1i0.00.51.01.5×10−1z0.900.920.940.960.981.00−1.50.01.5×10−1e{ˆSp,ˆSh}(ni/na)coreψN−1.6−0.80.0Π×10−1−2024ˆj×10−10.900.920.940.960.981.00012u×101ψNfor more natural impurity proﬁles, when the inputs push
the limitations imposed by the required orderings.

IV. DISCUSSION AND CONCLUSIONS

We have studied the diﬀerences in the collisional trans-
port between radially local and global formalisms using
the global δf neoclassical solver Perfect, with a spe-
cial emphasis on the eﬀects of non-trace impurities. If the
impurity density proﬁle is arbitrary, impurities are likely
to develop sonic ﬂows and strong poloidal asymmetries
in the pedestal. We use model proﬁles speciﬁcally cho-
sen to guarantee that impurity ﬂows remain sub-sonic,
so that the assumptions of the δf formalism are valid.
In this way we can gain some insights into the eﬀect of
non-trace impurities without the need for a non-linear
collision operator.

In an impure plasma the electron particle transport is
usually negligible, and the ion and impurity ﬂuxes oppose
each other to maintain ambipolarity. However, since in
the pedestal the magnitude of the parallel electron ﬂow
can be much larger than the parallel ion and impurity
ﬂows, the friction of the various ion species on electrons
can become non-negligible. Consequently, a substantial
neoclassical electron particle transport can arise, which
competes with the radial transport of other species. In
particular, the ion and impurity ﬂuxes can have the same
sign. In the presence of strong radial proﬁle variations
on the ρpi scale, the ambipolarity of ﬂuxes is violated, as
reported in previous studies18. We emphasize that the
diﬀerences in neoclassical ﬂows and ﬂuxes between the
local and global theory are not restricted to the pedestal
region only but die oﬀ within a distance comparable with
the ion orbit width. In our baseline from the outer core
region to the pedestal top we observe that both the ion
and impurity ﬂuxes are inward due to global eﬀects (see
Fig. 2a-c). Inside the pedestal, local simulations predict
both the impurity and the ion ﬂuxes to be outward, due
to the large outward electron ﬂux, but in global simula-
tions the impurity ﬂux reverses to be inward.

For our model proﬁles, chosen to give small parallel ion
ﬂows, the bootstrap current remains almost completely
unaﬀected, while this need not be so if the ion tempera-
ture varies more rapidly than allowed by our orderings.
Indeed, the neoclassical parallel ﬂow coeﬃcient k(cid:107) of ions
and impurities is signiﬁcantly aﬀected by global eﬀects.
Due to the radial coupling even the sign of k(cid:107)i is diﬀerent
from the local result well inside of the pedestal top.

We observe that in the presence of global eﬀects the
poloidal variation of the density perturbation is not re-
stricted to an up-down asymmetry, it can be more signif-
icant, and can develop rapid radial variations (in accor-
dance with previous numerical results27,30). The poloidal
asymmetries observed here arise in the presence of ﬁnite
inverse aspect ratio and ﬁnite orbit width eﬀects, and are
not closely related to those predicted by the analytical
theories in19,28,29, since those require signiﬁcant poloidal

9

IV DISCUSSION AND CONCLUSIONS

variations in the ion-impurity friction. The adiabatic re-
sponse to the electrostatic perturbation generated by the
ions competes with non-adiabatic contributions in deter-
mining the poloidal asymmetries developed by the impu-
rities. For the moderate impurity charge considered here
(Z = 7) the relative poloidal variation of the impurity
density is still small so that the perturbative treatment
remains valid. At suﬃciently high Z the relative poloidal
variation of the impurity density is expected to become
order unity and then – if the impurities are non-trace
– nonlinear eﬀects would start to play a role. The nu-
merical investigation of that situation is left for a future
study.

In the pedestal, the neoclassical radial current does not
vanish in general, and the momentum transport remains
ﬁnite – in contrast to the local theory. In the vicinity of
the pedestal the total neoclassical momentum transport
is found to be negative in the studied case, which happens
if the charge sources (resulting from the particle sources
needed to sustain the pedestal) are mostly positive in
that region. The radial variation of the parallel mass ﬂow
is non-monotonic with a sharply decreasing feature where
the density drops in the pedestal. This non-monotonicity
is not reﬂected in the radial momentum transport, which
is now a non-local function of the mass ﬂow. A simple
decomposition of the momentum transport into diﬀusive,
pinch and intrinsic terms is not possible in the global
picture. Note that the same is also true for all the radial
ﬂuxes.

We observe a strong eﬀect of impurities on the total
momentum transport, the magnitude of which increases
signiﬁcantly in the presence of non-trace impurities (see
Fig. 8a). While it is not possible to disentangle the exact
cause of this, it may be due to the sharp radial variation
of the parallel impurity mass ﬂow. The impurities rep-
resent only a minor fraction of the total mass ﬂow, but
their collisional coupling to the main ions is signiﬁcant
at an impurity strength of order unity. Pushing the lim-
itations of our orderings we reduced the sharpness of the
impurity density proﬁle, in an attempt to demonstrate
the robustness of the impact of impurities on neoclassical
momentum transport. Although the impurity proﬁle is
chosen to be very speciﬁc, strong eﬀects may occur when
the impurities have more general density variations, es-
pecially because they then have much stronger relative
ﬂow speeds compared to the ions.

Impurity seeding in tokamaks operating with ITER-
like metallic walls has been experimentally found to have
beneﬁcial eﬀects on the pedestal performance. It is then
natural to raise the question of whether our results are
consistent with this observation. Without taking into
account other non-intrinsically ambipolar processes and
turbulent transport it is not possible to evolve the pro-
ﬁles towards a steady state. However, we may speculate
about possible consequences of the increased momentum
transport in the presence of impurities. In steady state
the neoclassical radial current and momentum transport
should be balanced by opposing contributions of turbu-

A THE CONSTRUCTION OF MODEL PEDESTAL PROFILES

lent and other origin. An increased neoclassical momen-
tum transport in the presence of impurities requires these
contributions to increase as well. Suﬃciently far from
the open ﬁeld line region the turbulent transport can
dominate these opposing contributions. Impurities tend
to reduce the turbulence level by dilution31–33.
If the
non-diﬀusive turbulent momentum transport is to be in-
creased in spite of dilution eﬀects, stronger deviations
of the non-ﬂuctuating distribution from a Maxwellian34
and stronger proﬁle variations35 may be necessary; which
could require a steepening of the pedestal to reach a new
steady state. Whether this is indeed the case and, if so,
its role in the observed conﬁnement improvement in im-
purity seeded discharges, remains an open question and
should be the basis of future investigation.

ACKNOWLEDGMENTS

The authors are grateful for J. Omotani, T. F¨ul¨op
and S. Newton for fruitful discussions and instructive
comments on the paper.
IP and SB were supported
by the International Career Grant of Vetenskapsr˚adet
(Dnr. 330-2014-6313), and ML was supported by the
U.S. DoE under award numbers DEFG0293ER54197
and DEFC0208ER54964. The simulations used com-
putational resources of Hebbe at C3SE (project nr.
C3SE2016-1-10).

Appendix A: The construction of model pedestal proﬁles

Here, we describe a method to construct appropriate
densities given Ta, ηz, ηi proﬁles satisfying (5), and an
arbitrary ni. The orderings for the electrons are not a
concern, since ρpe is much smaller than the radial scale
length of any proﬁle in an experiment.

The density proﬁles and potential discussed in this sec-
tion are the inputs to Perfect and are thus, strictly
speaking, only the zeroth order contributions to these
quantities, assumed to be ﬂux functions.

Once we have speciﬁed both ηi and ni (to be detailed
shortly), the relation ηa = naeeaΦ/Ta gives the potential

(cid:18) ηi

(cid:19)

ni

Φ0 =

Ti
ei

log

.

(A1)

A strong electric ﬁeld from Φ0 compensates for the po-
tentially large ion pressure drop to make the variation
of ηi small (the situation of “electrostatic ion conﬁne-
ment,” which is borne out in experimental results36,37).
In the radial force balance the ion pressure drop could
in principle be balanced by a sonic ion ﬂow, however we
consider sub-sonic ion ﬂows. Note that by allowing sonic
ion ﬂows, the relative ﬂow speed of two ion species would
in general also be sonic, which would severely complicate
the treatment of collisions. Such a scenario is currently
not supported by Perfect. We emphasize that Φ0 and

10

na are fundamental inputs to the code, thus the relation
(A1) is not an attempt to self-consistently calculate the
potential.

Then, given Φ0 from (A1) and an ηz, we obtain the

impurity density

nz = ηz

(cid:18) ni

(cid:19) ez Ti

eiTz

ηi

.

(A2)

Note that (A2) leads to impurity density proﬁles with
a typical logarithmic density gradient in the pedestal
Zz times larger than that of the main ions; this is un-
avoidable if (5) is to be satisﬁed for all
ion species
(Zj = ej/|ee|). Finally, the electron density is obtained
by demanding quasi-neutrality

ne = Zini + Zznz.

(A3)

The resulting ηe satisﬁes (5) by virtue of the electron
gyroradius being small.

Although we have constraints and relations between
proﬁles, we still have a large degree of freedom in spec-
ifying them. Here we discuss some speciﬁc choices we
made for the proﬁle set used as a baseline for the simu-
lations.

Since we use the local solution for the boundary condi-
tion, we also need to make sure that the assumptions of
the local theory are satisﬁed at the boundary. This means
that the sharp density or potential variations should be
limited to the middle of the radial domain, suﬃciently
far from the boundaries. For weak electric ﬁelds the lo-
cal and global results should agree, so we choose the ηi
proﬁle so that the potential calculated from (A1) is com-
pletely ﬂat at the boundaries. We do this by letting

ηi = ni

(A4)

in the vicinity of the inner boundary, namely in the core
up to the pedestal top where ni (and so ηi) should be
slowly varying. Thus Φ0 = 0 in this region, independent
of the Ti proﬁle. To achieve a ﬂat potential in the vicinity
of the outer boundary, we let

ηi = ni exp (C/Ti),

(A5)

in that region, where C is a constant which ﬁxes the
value of eΦ0. To remove the ambiguity of ηi far from the
boundaries in a way that makes it a simple and smooth
function, we linearly extrapolate ηi given by (A4) from
the core region up to the bottom of the pedestal (where
the sharp feature in ni ends) and match it to the other
expression (A5), choosing C = eΦ0 from (A1) at the
matching point.

The ηz proﬁle is chosen to be a linear function of ψ over
the whole domain, with a logarithmic gradient matching
that of ni at the left boundary.

Since the global δf ordering does not allow an ion tem-
perature pedestal, we consider Ti = Tz proﬁles with a
gradient across the pedestal (and further out) equal to

that of the electron temperature gradient in the core.
Due to the density drop in the pedestal and the de-
creasing temperature proﬁle, the ion heat ﬂux is bound
to be vastly diﬀerent at the two boundaries, requiring
large heat sources in the domain, except if a variation in
dTi/dψ balances them. This can be avoided by setting
a proxy for the heat ﬂuxes, ∝ niT 3/2
dT /dψ, to be equal
at the boundaries. Thus, we artiﬁcially reduce dTi/dψ
in the core to remove the need for sources close to the
boundaries.

i

Experimental density and temperature proﬁles can
drop orders of magnitude across the pedestal, and a sig-
niﬁcant part of these variations occur in the open ﬁeld
line region. As an additional consideration, if we let the
bulk densities and temperatures drop across the simu-
lation domain as much as in a real pedestal, it would
lead to diﬃculties related to large logarithmic gradients,
and huge changes in collision frequency. Since the code
does not capture the physics in the open ﬁeld line region
(where the pedestal foot would be in an experiment), the
region outside the middle of the pedestal does not carry
too much physical relevance and can be considered as
a numerical buﬀer zone. To avoid the above mentioned
complications we reduce the gradients starting from a
point where crossing the separatrix would be expected
in an experiment. We thus arbitrarily pick this reduced
dTe/dψ to be 0.05 of its pedestal value, with dni/dψ
equal to its core value.

Motivated by typical JET discharges (Figure 16 of 24),
for our baseline case we choose the Te and ni pedestal
widths to be ∼ 3 cm, with the values Te = 0.9 keV
and ne = 4 · 1019 m−3 at the pedestal top. These
logarithmic gradients of about
correspond to typical
−d(ln ne)/d(r/a) = 32.55 and −d(ln Te)/d(r/a) = 32.56,
where r is the minor radius deﬁned as half of the width
of the ﬂux surface at the elevation of its centroid, and
r = a at the last closed ﬂux surface. The Te and ni
proﬁles are generated by Bezier curve interpolation be-
tween three regions with linear proﬁle variation: a core,
a pedestal, and an outer “buﬀer” region.
(Using this
type of smoothing ensures that the gradients transition
smoothly and monotonically.)

To transform the proﬁles from r to ψN space, ψ(r) is
needed. This we obtain from q(r) = dχ/dψ where 2πχ is
the toroidal magnetic ﬂux which we calculate assuming
simple elongated ﬂux surfaces. Since we do not intend
to model a speciﬁc experiment, we take model proﬁles
for the safety factor q and the elongation κ, shown in
Fig. 12. The q95 was chosen as 3.5. For the on-axis
toroidal magnetic ﬁelds we take BT = 2.9 T and neglect
2 corrections together with higher order shaping eﬀects
to get dr/dψN , where R denotes the major radius. The
resulting dr/dψN|LCFS = 0.57 is taken to be constant
across the entire pedestal.

11

B NUMERICAL RESOLUTION

FIG. 12: q (solid curve) and κ (dashed) proﬁles used to

calculate ψ(r).

a

b

c

FIG. 13: The particle sources from a baseline

simulation (red), plotted alongside simulations with
Nξ = 30 (yellow), Nθ = 90 (cyan), Nψ = 255 (violet).

Appendix B: Numerical resolution

The simulations used Nψ = 204 radial grid points and
cover a domain of ψN = 0.85−1.1 (the whole ψN domain
is not shown in the ﬁgures). The number of poloidal grid
points is Nθ = 75. The number of expansion polynomials
in the pitch angle cosine ξ = v(cid:107)/v is Nξ = 24 for the
distribution function and N RP
ξ = 4 for the Rosenbluth
potentials (RP). The number of speed grid points is Nx =
8 and N RP

x = 150 for the RP.

To demonstrate the degree of convergence, in Fig. 13
we present the particle sources for the baseline simulation
for the above mentioned resolution (red curve), together
with three other cases, where we increase Nψ to 255 (vi-
olet), Nθ to Nθ = 90 (cyan), and Nξ to 30 (yellow), with
all other parameters kept ﬁxed. These three are the res-
olution parameters to which the accuracy of the solution
is most sensitive. The results are almost identical except
for slight diﬀerences near a few sharp features.

(cid:16)(cid:82) 1

(cid:17)

(cid:16)(cid:82) 1

To quantify the
0.9 |X2 − X1|dψN

/

(cid:17)

error, we deﬁne

err(X) =

0.9 |X1|dψN

.

Taking

the

0.00.20.40.60.81.0ρ=r/a0.00.51.01.52.02.53.03.54.0κ,q0.00.40.8×10−1i0.00.51.01.5×10−3z0.900.920.940.960.981.00−1.0−0.50.00.5×10−1eˆSpψNNψ = 255 simulation as the reference X2, we ﬁnd that
the quantity with the highest error is the electron par-
ticle source, with err( ˆSpe) = 5.6%. For other quantities,
such as particle ﬂows and radial ﬂuxes, we observe errors
below 0.5%, thus Fig. 13 presents the most stringent
test for numerical convergence. The same convergence
test was performed for all the simulations, with resulting
errors (including those of the sources) all being below
6%.

1A. E. Hubbard, “Physics and scaling of the h-mode pedestal,”
Plasma Physics and Controlled Fusion 42, A15 (2000).
2R. J. Groebner, A. W. Leonard, T. C. Luce, M. E. Fensterma-
cher, G. L. Jackson, T. H. Osborne, D. M. Thomas, and M. R.
Wade, “Comparison of H-mode pedestals in diﬀerent conﬁnement
regimes in DIII-D,” Plasma Physics and Controlled Fusion 48,
A109 (2006).
3P. W. Terry, “Suppression of turbulence and transport by sheared
ﬂow,” Rev. Mod. Phys. 72, 109–165 (2000).
4E. G. Highcock, A. A. Schekochihin, S. C. Cowley, M. Barnes,
F. I. Parra, C. M. Roach, and W. Dorland, “Zero-turbulence
manifold in a toroidal plasma,” Phys. Rev. Lett. 109, 265001
(2012).
5M. N. A. Beurskens, J. Schweinzer, C. Angioni, A. Burck-
hart, C. D. Challis, I. Chapman, R. Fischer, J. Flanagan,
L. Frassinetti, C. Giroud, J. Hobirk, E. Joﬀrin, A. Kallen-
bach, M. Kempenaars, M. Leyland, P. Lomas, G. Maddison,
M. Maslov, R. McDermott, R. Neu, I. Nunes, T. Osborne,
F. Ryter, S. Saarelma, P. A. Schneider, P. Snyder, G. Tardini,
E. Viezzer, E. Wolfrum, the ASDEX Upgrade Team, and JET-
EFDA Contributors, “The eﬀect of a metal wall on conﬁnement
in jet and asdex upgrade,” Plasma Physics and Controlled Fusion
55, 124043 (2013).
6M. Beurskens, L. Frassinetti, C. Challis, C. Giroud, S. Saarelma,
B. Alper, C. Angioni, P. Bilkova, C. Bourdelle, S. Brezinsek,
P. Buratti, G. Calabro, T. Eich, J. Flanagan, E. Giovannozzi,
M. Groth, J. Hobirk, E. Joﬀrin, M. Leyland, P. Lomas, E. de la
Luna, M. Kempenaars, G. Maddison, C. Maggi, P. Mantica,
M. Maslov, G. Matthews, M.-L. Mayoral, R. Neu, I. Nunes,
T. Osborne, F. Rimini, R. Scannell, E. Solano, P. Snyder, I. Voit-
sekhovitch, P. de Vries, and JET-EFDA Contributors, “Global
and pedestal conﬁnement in JET with a Be/W metallic wall,”
Nuclear Fusion 54, 043001 (2014).
7L. Frassinetti, D. Dodt, M. Beurskens, A. Sirinelli, J. Boom,
T. Eich, J. Flanagan, C. Giroud, M. Jachmich, M. Kempenaars,
P. Lomas, G. Maddison, C. Maggi, R. Neu, I. Nunes, C. P. von
Thun, B. Sieglin, M. Stamp, and JET-EFDA Contributors, “Ef-
fect of nitrogen seeding on the energy losses and on the time
scales of the electron temperature and density collapse of type-
I ELMs in JET with the ITER-like wall,” Nuclear Fusion 55,
023007 (2015).
8K. D. Marr, B. Lipschultz, P. J. Catto, R. M. McDermott, M. L.
Reinke, and A. N. Simakov, “Comparison of neoclassical predic-
tions with measured ﬂows and evaluation of a poloidal impurity
density asymmetry,” Plasma Physics and Controlled Fusion 52,
055010 (2010).
9G. Kagan and P. J. Catto, “Arbitrary poloidal gyroradius eﬀects
in tokamak pedestals and transport barriers,” Plasma Physics
and Controlled Fusion 50, 085010 (2008).

10G. Kagan and P. J. Catto, “Neoclassical

ion heat ﬂux and
poloidal ﬂow in a tokamak pedestal,” Plasma Physics and Con-
trolled Fusion 52, 055004 (2010).

11G. Kagan and P. J. Catto, “Enhancement of the bootstrap cur-
rent in a tokamak pedestal,” Phys. Rev. Lett. 105, 045002 (2010).
12I. Pusztai and P. J. Catto, “Neoclassical plateau regime transport
in a tokamak pedestal,” Plasma Physics and Controlled Fusion
52, 075016 (2010).

13P. J. Catto, G. Kagan, M. Landreman, and I. Pusztai, “A uni-

12

B NUMERICAL RESOLUTION

ﬁed treatment of kinetic eﬀects in a tokamak pedestal,” Plasma
Physics and Controlled Fusion 53, 054004 (2011).

14P. J. Catto, F. I. Parra, G. Kagan, J. B. Parker, I. Pusztai, and
M. Landreman, “Kinetic eﬀects on a tokamak pedestal ion ﬂow,
ion heat transport and bootstrap current,” Plasma Physics and
Controlled Fusion 55, 045009 (2013).

15J. Candy and E. A. Belli, “Neoclassical transport including col-

lisional nonlinearity,” Phys. Rev. Lett. 106, 235003 (2011).

16S. Koh, C. S. Chang, S. Ku, J. E. Menard, H. Weitzner, and
W. Choe, “Bootstrap current for the edge pedestal plasma in
a diverted tokamak geometry,” Physics of Plasmas 19, 072505
(2012), http://dx.doi.org/10.1063/1.4736953.

17J. Seo, C. S. Chang, S. Ku, J. M. Kwon, W. Choe,

and
S. H. M¨uller, “Intrinsic momentum generation by a com-
bined neoclassical and turbulence mechanism in diverted DIII-
D plasma edge,” Physics of Plasmas 21, 092501 (2014),
http://dx.doi.org/10.1063/1.4894242.

18M. Landreman, F. I. Parra, P. J. Catto, D. R. Ernst, and I. Pusz-
tai, “Radially global δf computation of neoclassical phenomena
in a tokamak pedestal,” Plasma Physics and Controlled Fusion
56, 045005 (2014), arXiv:1312.2148 [physics.plasm-ph].

19T. F¨ul¨op and P. Helander, “Nonlinear neoclassical transport in

toroidal edge plasmas,” Physics of Plasmas 8 (2001).

20X. Q. Xu, “Neoclassical simulation of tokamak plasmas using
the continuum gyrokinetic code TEMPEST,” Phys. Rev. E 78,
016406 (2008).

21M. A. Dorf, R. H. Cohen, M. Dorr, T. Rognlien, J. Hittinger,
J. Compton, P. Colella, D. Martin,
and P. McCorquodale,
“Simulation of neoclassical transport with the continuum gyroki-
netic code COGENT,” Physics of Plasmas 20, 012513 (2013),
http://dx.doi.org/10.1063/1.4776712.

22M. Dorf, M. Dorr, R. Cohen, T. Rognlien, and J. Hittinger,
“Modeling of ion orbit loss and intrinsic toroidal rotation with
the COGENT code,” Bulletin of the American Physical Society,
56th Annual Meeting of the APS Division of Plasma Physics
(Savannah GA, USA) 59, ”TP8.27” (2015).

23T. F¨ul¨op, P. Helander, and P. J. Catto, “Eﬀect of poloidal den-
sity variation of neutral atoms on the tokamak edge,” Phys. Rev.
Lett. 89, 225003 (2002).

24C. Maggi, S. Saarelma, F. Casson, C. Challis, E. de la Luna,
L. Frassinetti, C. Giroud, E. Joﬀrin, J. Simpson, M. Beurskens,
I. Chapman, J. Hobirk, M. Leyland, P. Lomas, C. Lowry,
I. Nunes, F. Rimini, A. Sips, and H. Urano, “Pedestal conﬁne-
ment and stability in JET-ILW ELMy H-modes,” Nuclear Fusion
55, 113031 (2015).

25R. L. Miller, M. S. Chu, J. M. Greene, Y. R. Lin-Liu, and R. E.
Waltz, “Noncircular, ﬁnite aspect ratio, local equilibrium model,”
Physics of Plasmas 5, 973–978 (1998).

26E. A. Belli, G. W. Hammett, and W. Dorland, “Eﬀects of plasma
shaping on nonlinear gyrokinetic turbulence,” Physics of Plasmas
15, 092303 (2008), http://dx.doi.org/10.1063/1.2972160.
27I. Pusztai, M. Landreman, A. Moll´en, Y. O. Kazakov,

and
T. F¨ul¨op, “Radio frequency induced and neoclassical asymme-
tries and their eﬀects on turbulent impurity transport in a toka-
mak,” Contributions to Plasma Physics 54, 534–542 (2014).

28T. F¨ul¨op and P. Helander, “Nonlinear neoclassical transport in a
rotating impure plasma with large gradients,” Physics of Plasmas
6 (1999).

29M. Landreman, T. F¨ul¨op,

and D. Guszejnov, “Impu-
rity ﬂows and plateau-regime poloidal density variation in a
tokamak pedestal,” Physics of Plasmas 18, 092507 (2011),
http://dx.doi.org/10.1063/1.3631819.

30M. Landreman and D. R. Ernst, “Local and global Fokker-
Planck neoclassical calculations showing ﬂow and bootstrap cur-
rent modiﬁcation in a pedestal,” Plasma Physics and Controlled
Fusion 54, 115006 (2012).

31I. Pusztai, J. Candy, and P. Gohil, “Isotope mass and charge ef-
fects in tokamak plasmas,” Physics of Plasmas 18, 122501 (2011),
http://dx.doi.org/10.1063/1.3663844.

32M. Porkolab, J. Dorris, P. Ennever, C. Fiore, M. Greenwald,

B NUMERICAL RESOLUTION

A. Hubbard, Y. Ma, E. Marmar, Y. Podpaly, M. L. Reinke, J. E.
Rice, J. C. Rost, N. Tsujii, D. Ernst, J. Candy, G. M. Staebler,
and R. E. Waltz, “Transport and turbulence studies in the linear
ohmic conﬁnement regime in alcator c-mod,” Plasma Physics and
Controlled Fusion 54, 124029 (2012).

33I. Pusztai, A. Moll´en, T. F¨ul¨op,

and J. Candy, “Turbulent
transport of impurities and their eﬀect on energy conﬁnement,”
Plasma Physics and Controlled Fusion 55, 074012 (2013).

34J. Lee, F. I. Parra, and M. Barnes, “Turbulent momentum pinch
of diamagnetic ﬂows in a tokamak,” Nuclear Fusion 54, 022002
(2014).

35T. Sung, R. Buchholz, F. J. Casson, E. Fable, S. R. Grosshauser,
W. A. Hornsby, P. Migliano, and A. G. Peeters, “Toroidal mo-

mentum transport in a tokamak caused by symmetry break-
ing parallel derivatives,” Physics of Plasmas 20, 042506 (2013),
http://dx.doi.org/10.1063/1.4799750.

36E. Viezzer, “Radial electric ﬁeld studies in the plasma edge of

asdex,” (2013).

37R. M. McDermott, B. Lipschultz, J. W. Hughes, P. J. Catto,
A. E. Hubbard, I. H. Hutchinson, R. S. Granetz, M. Green-
wald, B. LaBombard, K. Marr, M. L. Reinke, J. E. Rice,
D. Whyte,
and A. C.-M. Team, “Edge radial electric ﬁeld
structure and its connections to h-mode conﬁnement in alca-
tor c-mod plasmas,” Physics of Plasmas 16, 056103 (2009),
http://dx.doi.org/10.1063/1.3080721.

13

