Extraction of cylinders and cones from minimal point sets

Laurent Bus´ea, Andr´e Galligoa,b, Jiajun Zhanga,c

aINRIA Sophia Antipolis - M´editerann´ee

bLaboratoire J.-A. Dieudonn´e, Universit´e de Nice Sophia Antipolis

c ´Ecole Polytechnique de l’Universit´e de Nice Sophia Antipolis

6
1
0
2

 
r
a

 

M
5
1

 
 
]

G
C
.
s
c
[
 
 

1
v
2
8
5
4
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

We propose new algebraic methods for extracting cylinders and cones from minimal point sets, including oriented
points. More precisely, we are interested in computing eﬃciently cylinders through a set of three points, one of them
being oriented, or through a set of ﬁve simple points. We are also interested in computing eﬃciently cones through a set
of two oriented points, through a set of four points, one of them being oriented, or through a set of six points. For these
diﬀerent interpolation problems, we give optimal bounds on the number of solutions. Moreover, we describe algebraic
methods targeted to eﬃciently solve these problems.

Keywords: Mixed set of 3D points, cylinders, cones, interpolation.

1. Introduction

The extraction of geometric primitives from 3D point
clouds is an important problem in reverse engineering.
These 3D point clouds are typically obtained by means
of accurate 3D scanners and there exist several methods
for performing 3D geometric primitives extraction [1]. An
important category among these methods are based on the
RANSAC approach [4, 7, 1]. For such methods, the prim-
itives are directly extracted from the input point cloud.
The basic idea is to extract a particular elementary type
of shape, such as planes, spheres, cylinders, cones or tori,
from the smallest possible set of points and then to judge if
this extracted primitive is relevant to the full point cloud.
Therefore, for this category of methods it is very important
to compute a particular type of shape through the smallest
possible number of points, including normals if available.
If the extraction of planes and spheres is easy to treat, the
cases of cylinders and cones are more involved. In this pa-
per we provide new methods for extracting these geomet-
ric primitives from the smallest possible number of points,
counting multiplicities of oriented points (i.e. points given
with their normal vector). As far as we know, and surpris-
ingly, these problems have not appeared in the existing lit-
erature with the exception of [3]. Instead, the classical ap-
proaches to these interpolation problems usually extract,
actually we should say estimate, these geometric primi-
tives from an overdetermined number of points, counting
multiplicities (e.g. [6]).

An oriented point is a couple of a point and a nonzero
vector. A surface is said to interpolate an oriented point if
the point belongs to the surface and its associated vector
is colinear to the normal of the surface at this point, we
do not assume that the orientation of the normal of the

point is the same as the orientation of the surface; since
often in the data sets normals are unoriented. Moreover,
it is important to deal with inhomogeneous data, that is
to say some points are oriented but not all, in order to
take into account the estimated accuracy of oriented point
clouds that are obtained by means of normal estimation
algorithms. A set of data made of points and oriented
points will be called a mixed set of points.

We emphasize that interpolating at a point imposes a
single algebraic condition on a given shape whereas inter-
polating at an oriented 3D point imposes three algebraic
conditions. Typically, a 3D plane is uniquely deﬁned either
by three distinct points or by one oriented point. A sphere
is uniquely deﬁned either by four points or by one oriented
point and an additional point. In these two cases, it turns
out that there is a unique shape that interpolates a mixed
set of points corresponding to the number of parameters of
this shape (a plane is determined by three parameters and
the sphere is determined by four parameters). In this pa-
per, we will treat interpolation of two other basic shapes,
namely cylinders and cones for which the situation is more
involved.

Our approach is inspired by eﬀective methods in alge-
braic geometry. We consider two families of unknowns:
ﬁrst, the parameters needed to describe all features of
the targeted surface (e.g.
the radius and axis of a cir-
cular cylinder) hence their equation ; second, auxiliaries
unknowns (e.g. such as a special point on that axis) which
permits to describe a collection of geometric constructions.
These constructions are designed to establish a complete
link between the input and the ﬁrst family of unknowns.
Then, we translate algebraically the collection of constr-
aints attached to theses geometric constructions into a sys-
tem of polynomial equations that we further analyze and

Preprint submitted to Elsevier

March 16, 2016

simplify, discarding spurious solutions if needed. Since the
input and output are (and should be) real approximate
data, we designed eﬃcient algorithms to compute very ac-
curate real solutions of these systems of equations. Indeed,
in all the considered cases, we were able to express the re-
sults as the solutions of (generalized) eigenvalues problems
together with close formulas. This allows to rely on clas-
sical matrix computations software and achieve accuracy
and eﬃciency. Prototypes of our algorithms were imple-
mented in the computer algebra system MAPLE, and we
provide some statistics and timings (which are quite sat-
isfactory).

2. Interpolation of cylinders

A cylinder (more precisely a right circular cylinder) is
deﬁned as the set of points in the three-dimensional aﬃne
space R3 located at a ﬁxed distance (called the radius of
the cylinder) of a given straight line (called the axis of the
cylinder). It is hence deﬁned by means of ﬁve parameters :
four parameters describe a line in R3 and an additional
parameter measures the radius.

A popular determination of a cylinder is done by in-
terpolation of two points with normals, which imposes six
conditions (instead of ﬁve). So, a priori no cylinder in-
terpolates these datas; therefore some approximations are
necessary.
In this section, we will give new methods to
compute the cylinders using just ﬁve independent condi-
tions. There are two possible such minimal conﬁgurations,
either an oriented point and two other distinct points, or
ﬁve distinct points.

2.1. Cylinders through a mixed minimal point set

We seek for the cylinders that interpolate a given mixed
minimal set of points P. Since a cylinder is given by 5
parameters, P is assumed to be composed of an oriented
point p1 with its normal vector n1 and two other distinct
points p2, p3 in R3.

First, by a linear change of coordinates, one can as-
sume that p1 = (0, 0, 0) and n1 = (0, 0, 1) and we set
p2 = (x2, y2, z2) and p3 = (x3, y3, z3). Then, the axis of a
cylinder interpolating P must be orthogonal to the z-axis
and must intersect it.
It follows that a normal plane Π
contains the z-axis, hence is given by an equation of the
form lx + my = 0 where t := (l, m, 0) is the corresponding
direction of the axis. Observe that these directions are in
correspondence with a projective line P1. For simplicity,
we set ρ :=

l2 + m2 = (cid:107)t(cid:107) > 0.

√

Now, we compute the orthogonal projections q1 and q2
of p2 and p3, respectively, onto the plane Π. Π contains the
point p1 and is generated by the two orthogonal vectors
n1 and v = n1 ∧ t = (−m, l, 0). The matrix

 l

ρ

− m
ρ
0

M =



m
ρ
l
ρ
0

0
0
1

deﬁnes the change of coordinates from the current coordi-
nate system (x, y, z) to a new coordinate system (x(cid:48), y(cid:48), z(cid:48)),
with the same origin p1, deﬁned by the three vectors t/ρ,
v/ρ, n1, where Π has equation x(cid:48) = 0. It follows that the
i, z(cid:48)
coordinates (x(cid:48)
i) of pi, i = 2, 3, in this new coordinate
system are given by

i, y(cid:48)

(x(cid:48)

i, y(cid:48)

i, z(cid:48)

i) =

xi

l
ρ

+ yi

,−xi

m
ρ

m
ρ

+ yi

l
ρ

, zi

.

(cid:19)

(cid:18)

(cid:18)

Therefore, the coordinates of the orthogonal projections
qi, i = 2, 3 are given by

(cid:19)

qi =

−xi

m
ρ

+ yi

l
ρ

, zi

∈ Π

in the basis v/ρ, n1.

The existence of a cylinder interpolating P is equivalent
to the fact that the points p1, q2 and q3 all belongs to a
circle whose center c is located on the z-axis, say c =
(0, 0, r). Such a circle has an equation of the form y(cid:48)2+(z(cid:48)−
r)2 = r2, or equivalently y(cid:48)2 + z(cid:48)2 − 2rz(cid:48) = 0. Therefore,
this cocyclicity condition can be written as

0 =

(cid:12)(cid:12)(cid:12)(cid:12) y(cid:48)2

2 + z2
2
y(cid:48)2
3 + z2
3
1
ρ2

=

(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12) (−x2m + y2l)2 + (l2 + m2)z2

(−x3m + y3l)2 + (l2 + m2)z2

z2
z3

2

3

(cid:12)(cid:12)(cid:12)(cid:12) .

z2
z3

Since ρ > 0, the expansion of this latter determinant al-
lows to rewrite this condition as a degree 2 homogeneous
equation al2 + blm + cm2 where the coeﬃcients a, b, c are
given by the following closed formulas

(cid:12)(cid:12)(cid:12)(cid:12) y2

2 + z2
2
y2
3 + z2
3

a :=

z2
z3

(cid:12)(cid:12)(cid:12)(cid:12) , b := −2
(cid:12)(cid:12)(cid:12)(cid:12) x2

2 + z2
2
x2
3 + z2
3

z2
z3

(cid:12)(cid:12)(cid:12)(cid:12) x2y2
(cid:12)(cid:12)(cid:12)(cid:12) .

x3y3

c :=

(cid:12)(cid:12)(cid:12)(cid:12) ,

z2
z3

Unless a = b = c = 0, this equation has two roots,
counting multiplicities, in the ﬁeld of complex numbers. If
a real solution is found, that is to say the direction of a
real cylinder interpolating P (observe that one can impose
ρ = 1 since the condition is homogeneous in l, m), then
the remaining parameter r is uniquely determined by one
of the formulas

2z2r = y(cid:48)2
2z3r = y(cid:48)2

2 + z2

2 =

3 + z2

3 =

1

ρ2 (−x2m + y2l)2 + z2
ρ2 (−x3m + y3l)2 + z2

1

3,

2,

(1)

(2)

depending whether z2 (cid:54)= 0 or z3 (cid:54)= 0. We notice that if
z2 = z3 = 0 then a = b = c = 0.
Theorem 1. Suppose given a mixed set of points P com-
posed of an oriented point p1, n1 and two other points p2, p3
such that

2

i) p1, p2, p3 are all distinct,

ii) p1, p2, p3 do not belong to a same plane which is nor-

mal to n1,

iii) p2 and p3 are not symmetric with respect to the line

through p1 and generated by n1,

then there exist at most 2 real cylinders interpolating P.
Otherwise, there exist a cylinder (possibly ”ﬂat”, i.e. with
inﬁnite radius) interpolating P in any direction which is
normal to n1.

Proof. Following the above discussion, this theorem will be
proved if we show that a = b = c = 0 if and only if at least
one of the three conditions i), ii), iii) holds. It is not hard
to check that if one of the three latter conditions holds
then a = b = c = 0. To prove the converse, we observe
that by a linear change of coordinate, we can assume that
x2 = 0 in addition to the fact that p1 = (0, 0, 0) and
n1 = (0, 0, 1). Then, we have b = 2x3y3z2 and hence three
cases to analyze.
If x3 = 0, then c = z2z3(z2 − z3) so that c = 0 implies
If x3 = z2 = 0,
that z2 = 0, or z3 = 0 or z2 = z3.
then a = y2
2z3 so that a = 0 implies that i) or ii) hold.
Similarly, if x3 = z3 = 0 then a = y2
3z2 so that a = 0
implies that i) or ii) hold. Finally, if x3 = 0 and z2 = z3
then a = z2(y2
3) so that a = 0 implies that i) or iii)
hold.

2 − y2

The case corresponding to y3 = 0 can be treated ex-
actly as the previous case x3 = 0, exchanging x2 with x3
and y2 with y3 leaves unchanged b and permute a and c.
Finally, if z2 = 0, then c = 0 (recall x2 = 0) and
a = y2
2z3. So a = 0 if either y2 = 0 or z3 = 0. But y2 = 0
means that p1 = p2, i.e. i) holds, and z3 = 0 means that
ii) holds.

When a mixed set of points P satisﬁes conditions i), ii)
and iii) in the above theorem, then a, b and c are not all
zero and hence the fact of having zero, one or two homo-
geneous real solutions to the equation al2 + blm + cm2 = 0
is decided by means of the discriminant ∆ := b2 − 4ac
which depends on the coordinates of p2 and p3. If ∆ < 0
then there is no real homogeneous solution, if ∆ = 0 then
there exist a double homogeneous solution and if ∆ > 0
then there exists two distinct homogeneous solutions. As
we have already observed in the proof of Theorem 1, it is
possible to assume, without loss of generality, that x2 = 0
in addition of p1 = (0, 0, 0) and n1 = (1, 0, 0). Then, a
straightforward computation shows that

∆ = 4z2z3

(cid:0)y2

2(cid:0)x3

−z2z3

(cid:16)

2 + z3

2(cid:1) + z2

2(cid:1)

2(cid:0)x3
2 + (z2 − z3)2(cid:17)(cid:17)

2 + y3

x3

2 + y2

2 + y3

to n1 (i.e. z2 and z3 have opposite signs). Another in-
teresting case is to assume that p2 belongs to the plane
through p1 and normal to n1 (i.e. z2 = 0).
Indeed, in
this case ∆ = 0 so there is a unique cylinder (counted
with multiplicity two) through P :
its direction is given
by t = (−b, 2a, 0) = (2x2y2z3, 2y2
2z3, 0) and r is still de-
ﬁned by (1) (z3 is assumed to be nonzero for otherwise
a = b = c = 0).

Finally, we notice that if a = 0 then the directions are
given by the equation blm + cm2 = 0. It follows that these
directions are given by (1, 0, 0) and (−c, b, 0). Of course,
if in addition b = 0 then there is a single interpolation
cylinder that appears with multiplicity 2 (the discriminant
vanishes). The radius r1 and r2 are then deduced from (1).
Similarly, if c = 0 then the directions of the interpolating
cylinders are given by (0, 1, 0) and (−b, a, 0).

Extraction algorithm. From the above analysis, we de-
duce the following extraction algorithm of cylinders from
a mixed point set P:

1. Perform a linear change of coordinates so that the
oriented point is at the origin and its normal vector
is (0, 0, 1). If z2z3 < 0 then there is no solution.

2. Compute the quantities a, b and c. If a = b = c = 0
then stop because there are inﬁnitely many interpo-
lating cylinders.

3. If a = 0 or c = 0 then compute the interpolating

cylinders as explained above and stop.

4. Otherwise, solve the equation al2 + blm + cm2 = 0
and keep only those roots that are real numbers (up
to numerical precision). For each such root, compute
the corresponding radius by means of (1) and return
the interpolating cylinder.

This algorithm has been implemented with the Maple
software and all timings are measured on a Mac laptop
equipped with Intel Core i7 CPU @ 2.8GHz, 16 GB mem-
ory. We observed that the computation of the cylinders
through a random set of points takes in average 3.5ms and
is almost constant independently of the point set. The pro-
portion of the number of cylinders found through random
point sets is given in Table 1 and an illustrative picture is
given in Figure 1.

Number of cylinders

0

2

Proportion (%)

46.87

53.13

Table 1: Proportion of the number of cylinders found through a
thousand random point sets.

.

2.2. Cylinders through ﬁve points

For instance, from this equation we see directly that there
is no real cylinders interpolating P if p2 and p3 and not
on the same side of the plane through p1 and normal

The problem of extracting a cylinder passing through
ﬁve points has already been treated in the literature, see
[3, 2, 5]. These works solve the problem by relying on a
polynomial system solver. In this section, we brieﬂy review

3

Now, the points q1, q2, q3 and q4 are cocyclic (or aligned,
which corresponds to a circle of inﬁnite radius) providing

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1

2

1

1
x(cid:48)
y(cid:48)
x(cid:48)2
1 + y(cid:48)2
1 = y(cid:48)

1
x(cid:48)
y(cid:48)
x(cid:48)2
2 + y(cid:48)2
√
1 = 0, x(cid:48)

2 =

2

1

2

3

1
x(cid:48)
y(cid:48)
x(cid:48)2
3 + y(cid:48)3

3

3

4

1
x(cid:48)
y(cid:48)
x(cid:48)2
4 + y(cid:48)2

4

4

m2+n2
(cid:107)t(cid:107)

x2, y(cid:48)

2 = 0 and

Since x(cid:48)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) = 0.

Figure 1: A general mixed set of points with the two interpolated
cylinders.

for i = 3, 4, we deduce that the points p1, p2, p3, p4 all
belong to a cylinder of direction t if and only if

x(cid:48)2
i + y(cid:48)2

i = (cid:107)qi(cid:107)2 = (cid:107)pi(cid:107)2 − (t.pi)2
(cid:107)t(cid:107)2

the model already described in [3] and then we propose
an improvement to gain eﬃciently. Our key ingredient
removes some spurious solutions by means of additional
algebraic manipulations.

2.2.1. Geometric analysis
We suppose given a set P of ﬁve points p1, p2, p3, p4, p5
and we seek for cylinders through P. First of all, by linear
change of coordinates, we assume without loss of generality
that the coordinate system (x, y, z) is such that

p1 = (0, 0, 0), p2 = (x2, 0, 0), p3 = (x3, y3, 0),

(3)

p4 = (x4, y4, z4), p5 = (x5, y5, z5).

Let us pick a nonzero vector t = (l, m, n) (which will
represent the direction of the axis) and denote by Π the
plane through the origin which is orthogonal to t. Let us
also denote by qi the orthogonal projection of pi onto Π,
for all i = 1, . . . , 5. Then, p1, . . . , p5 belongs to a cylinder
of direction t if and only if the coplanar points q1, . . . , q5
are cocyclic. In order to make explicit this latter condition,
we consider a new system of coordinates (x(cid:48), y,(cid:48) , z(cid:48)) whose
third axis is parallel to t. More precisely, we choose the
coordinates system (x(cid:48), y(cid:48), z(cid:48)) which is obtained from the
coordinate system (x, y, z) by the change of coordinates
deﬁned by the orthogonal matrix

 √

M =

m2+n2 −

−

m2+n2
(cid:107)t(cid:107)
0
l(cid:107)t(cid:107)

lm

(cid:107)t(cid:107)√
n√
m2+n2
m(cid:107)t(cid:107)

ln
m2+n2

(cid:107)t(cid:107)√
− m√
m2+n2
n(cid:107)t(cid:107)

 .

(cid:32)

xi

Therefore, the coordinates of qi in the system (x(cid:48), y(cid:48), z(cid:48))
are given by

√

−

m2 + n2
(cid:107)t(cid:107)
n√
m2 + n2

(cid:107)t(cid:107)√
yi −

yi −

lm
m2 + n2
m√
m2 + n2

(cid:107)t(cid:107)√
(cid:19)

ln
m2 + n2
=: (x(cid:48)
i, y(cid:48)

zi, 0

zi,

i, 0).

Cp1,p2,p3,p4 (l, m, n) = 0

where, after some calculus,

Cp1,p2,p3,p4 (l, m, n) := x2

2(m2 + n2)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

l
m y3
0
n

x3 x4
y4
z4

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) .

y3
0

(cid:107)t(cid:107)2(cid:107)p3(cid:107)2 − (t.p3)2

y4
z4

(cid:107)t(cid:107)2(cid:107)p4(cid:107)2 − (t.p4)2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) m

n
0

− x2

This condition is given by a homogeneous polynomial of
degree 3 in l, m, n. Observe that it is satisﬁed for the six
particular directions corresponding to the lines (pipj), 1 ≤
i < j ≤ 4. Then, to determine the cylinders through the
ﬁve points p1, . . . , p5, we consider the polynomial system
of equations

Cp1,p2,p3,p4(l, m, n) = Cp1,p2,p3,p5 (l, m, n) = 0

(4)

It corresponds geometrically to the intersection of two cu-
bic curves, which is composed of nine points whenever this
intersection is ﬁnite. As already noticed, the directions
corresponding to the lines (p1p2), (p1p3) and (p2p3) are
roots of these two equations, but they do not imply the
existence of a cylinder interpolating P, they have to be
removed once (if there is indeed a cylinder in this direc-
tion, then it will appear as a multiple solution). Moreover,
when a direction of a cylinder through P is found, then it
is completely determined since its radius and a point on
its axis are given by the center and the radius of the circle
through the points q1, q2, q3, q4, q5. Therefore, we have the
following result.

Theorem 2 ([3]). If the algebraic system of equations (4)
has a ﬁnite number of solutions, then there may be zero,
two, four or six real cylinders through P.

In [3, 2, 5], various polynomial system solvers are used
in order to extract the directions of the cylinders through
P. We will describe a new approach where we ﬁrst simplify
this algebraic system and then rely on eigen-computations.

4

To begin with, we observe that the three extraneous

2.2.2. Solving via eigencomputations

directions (p1p2), (p1p3) and (p2p3) which write
(x2, 0, 0), (x3, y3, 0), (x3 − x2, y3, 0),

are the common roots of both algebraic equations
F := nx2 = 0, G := (mx3−mx2−ly3)(mx3−ly3)mx2 = 0.

Then a result in algebraic geometry says that the two poly-
nomials Cp1,p2,p3,pj , j = 4, 5, belong to the ideal gener-
ated by F and G; and suggests to explicitly compute these
membership relations. Computing the Euclidean (pseudo-
)division of Cp1,p2,p3,p4 and Cp1,p2,p3,p5 by the polynomial
x2n, we get two homogeneous polynomials of degree 2,

+ ((2yjy3x3 − 2yjxjy3) m + zj (x2y3 − 2xjy3) n) l+

2 + yj

Dj(l, m, n) =(cid:0)−yjy3
(cid:0)x2yjx3 − x2xjy3 − yjx3
(cid:0)−x2x3 + x3
(cid:0)x2yjx3 − x2xjy3 − yjx3
(cid:19)(cid:18) F

(cid:18) D4

(cid:19)

+ zj

where j = 4, 5, such that

2 + y3
2 + xj

2y3 + zj

2 + xj

2y3

2y3 + zj

(cid:1) l2
(cid:1) m2
(cid:1) nm+
(cid:1) n2
(cid:19)
(cid:18) Cp1,p2,p3,p4

2 − 2yjy3
2y3 − yjy3

2 + yj

2y3

2y3

.

Cp1,p2,p3,p5

z4
z5

D5

=

G

Proposition 3. If z4 (cid:54)= 0 (resp. z5 (cid:54)= 0), then the direc-
tions of the cylinders interpolating P are obtained as all
the common roots of both equations Cp1,p2,p3,p4 (l, m, n) = 0
and ∆(l, m, n) := z5D4(l, m, n) − z4D5(l, m, n) = 0 (resp.
Cp1,p2,p3,p5(l, m, n) = 0 and ∆(l, m, n) = 0).
Proof. If z4 (cid:54)= 0 then the system (4) is obviously equivalent
to Cp1,p2,p3,p4 = 0 and

z4Cp1,p2,p3,p5(l, m, n) − z5Cp1,p2,p3,p4(l, m, n) =

nx2(z4D5 − z5D4) = 0.

The solutions corresponding to n = 0 satisfy n = G = 0
so that they deﬁne exactly the three extraneous directions
(p1p2), (p1p3) and (p2p3). Therefore, the remaining poly-
nomial system

Cp1,p2,p3,p4(l, m, n) = 0, ∆(l, m, n) = 0

(5)
gives exactly the six solutions of interest. The case z5 (cid:54)= 0
is treated similarly.

We notice that the case where z4 = z5 = 0 corresponds
geometrically to ﬁve coplanar points. If these points are
also aligned, then are inﬁnitely many cylinders.
If they
belong to a conic, there are two non-degenerated cylin-
ders thought these points. In all cases, they belong to a
degenerated “ﬂat” cylinder (inﬁnite radius).

Now, we describe a method that allows to compute
eﬃciently the roots of the system of algebraic equations
given in Proposition 3 as the eigenvalues of a pencil of
matrices which is given in closed form.
It is based on
technics that are described in [2].

First, in order to treat apart the case n = 0, observe
that the common roots of Cp1,p2,p3,p5 = 0 and ∆ = 0 such
that n = 0 are easily computed since they are among the
three directions (p1p2), (p1p3) and (p2p3) (i.e. the roots of
n = G = 0) and the decision is given by the evaluation of
the equation ∆(l, m, n) at these directions. For instance,
the direction (1, 0, 0) is a solution if and only if

(cid:0)−y4y3

− z4

2 + y4

(cid:0)−y5y3

2y3 + z4
2 + y5

2y3
2y3 + z5

2y3

(cid:1) = 0.

(cid:1)

∆(1, 0, 0) = z5

Therefore, from now on we set n = 1.

We consider the Sylvester Matrix S of the polynomials
Cp1,p2,p3,p5(l, m, 1) and ∆(l, m, 1) seen as univariate poly-
nomials in the variable m. This matrix is a polynomial
matrix of degree 2 in l. More precisely, it is of the form
M2l2 + M1l + M0 where each Mi is a 5 × 5-matrix whose
coeﬃcients are given in closed forms in terms of P. For
instance,



M2 :=

0

0

0

0

0

0 x2 y3

2z4

b

0

0

0

0

0

a

0

0

x2 y3

2z4

0

a

0

0

b

0

0

a



(cid:19)

where

a := −y3

2y4 z5 + y3

2z4 y5 + y3 y4

2z5 − y3 z4 y5
+ y3 z4

2z5 − y3 z4 z5

2

2

and

b := −x2 y3

2y4 + x2 y3 y4

2 + x2 y3 z4

2.

Now, following [2], we linearize this polynomial matrix by
considering its companion matrices that are deﬁned by

(cid:18) 0

(cid:19)

(cid:18) I

A =

I
0 M t
1

M t

, B =

0
0 −M t

2

where I stands for the 5×5-identity matrix and M t
i stands
for the transpose of the matrix Mi. These matrices are of
size 10 × 10 and their main feature and importance is the
fact that for all λ ∈ C and all vector v ∈ Cm we have

St(λ)v = 0 ⇔ (A − λB)

= 0.

(cid:19)

(cid:18) v

λv

In other words, the solutions to the system

Cp1,p2,p3,p4(l, m, 1) = 0, ∆(l, m, 1) = 0

5

can be computed from the eigenvalues and eigenvectors
of the pencil A, B which is given in closed form in terms
of the input data P. We refer the reader to [2] for more
details on these computations.

2.2.3. Extraction algorithm
traction algorithm of cylinders through a point set P:

From the above analysis, we deduce the following ex-

1. Perform a linear change of coordinates so that the

ﬁve points are of the form (3).

rithm stops here.

2. If z4 = z5 = 0 the points are coplanar and the algo-
3. Assume z4 (cid:54)= 0. Then, instantiate the pre-computed
matrices M0, M1, M2, and hence A, B, with the co-
ordinates of the points pi, i = 1, . . . , 5.

4. Compute the six ﬁnite eigenvalues of the pencil A, B
(see [2] for details), and sort them in order to keep
only those which are real numbers (up to a given
precision).

5. For each real eigenvalue obtained in the previous
step, compute the remaining coordinate of the di-
rection by means of the associated eigenvectors (see
[2] for details); keep those directions that are given
by real numbers.
6. For each real direction of a cylinder through P, com-
pute q1, q2, q3 then the radius and the center of their
circumcircle.

This algorithm has been implemented with the Maple
software. We observed that the computation of the cylin-
ders through a random set of points takes in average 15ms
and is almost constant independently of the point set. The
proportion of the number of cylinders found through ran-
dom point sets is given in Table 2. Some illustrative con-
ﬁgurations are presented in Figure 2.

Number of cylinders

0

2

4

Proportion (%)

22.7

53.9

21.4

6
2

Table 2: Proportion of the number of cylinders found through a
thousand random point sets.

Figure 2: Three conﬁgurations of P with 2,4 and 6 cylinders passing
through P.

3. Interpolation of cones

A cone (more precisely a right circular cone) is a three-
dimensional geometric shape that consists of the locus of
all straight lines (the generatrices) joining a ﬁxed point,
called the apex to the points of a circle, the apex lying
on the line, called the axis, passing through the center of
the circle and normal to the plane containing this circle.
It is determined by six parameters : four parameters for
the axis, an additional parameter for the apex, which is a
point on the axis and a last parameter for the angle of the
cone, that is to say the angle made at the apex between
the axis and any of the straight lines generating the cone.

6

It is classical to determine a cone from three oriented
points. Indeed, each normal plane to each oriented point
must contains the apex, so the apex can be determined
as the intersection of three such planes. Nevertheless, this
approach is overdetermined in the sense that it will not
yield a cone in general. The reason is that three general
oriented points give nine conditions whereas a cone has
only six parameters. Hereafter, we provide methods for
interpolating a cone through a mixed point set that deﬁne
exactly six conditions. There are three possibilities of such
mixed point sets : either two oriented points, or one ori-
ented point and three other distinct points, or six distinct
points.

3.1. Cones through two oriented points

We seek for cones through a set P of two oriented points
that we will denote by p1, n1 and p2, n2. By a linear change
of coordinates, one can assume without loss of generality
that p1 := (0, 0, 0) and n1 := (0, 0, 1). For the remaining
data, we set p2 = (x2, y2, z2) and n2 = (a2, b2, c2).

Assuming that n2 is not proportional to n1, i.e. a2 (cid:54)= 0
or b2 (cid:54)= 0, the normal plane to n1 through p1 and the
normal plane to n2 through p2 intersect along a line L. A
key remark is that the apex of a cone through P must be
on L. This line is deﬁned by the equations

(cid:26) z = 0

L :

a2x + b2y + c2z − p2.n2 = 0.

If n2 is proportional to n1, then we get a degenerated sit-
uation. Indeed, either z2 (cid:54)= 0 and there is no cone through
P, or either z2 = 0 and there are inﬁnitely many cones
through P (the line through p1 and p2 deﬁne a generatrix
of the cone and then the apex can be freely chosen on this
line, as well as the angle of the cone). So, from now on we
assume that n2 is not proportional to n1, i.e. a2
2 > 0.
The axis of a cone through P must intersect the line L1
through p1 with direction n1 and also intersect the line L2
through p2 with direction n2. So to characterize this axis,
we pick a point on each of these lines, say q1 = λ1n1 ∈ L1
and q2 = p2+λ2n2 ∈ L2 where λ1, λ2 ∈ R, and we consider
the line A through q1 and q2. The only special case when
A is not well deﬁned is when L1 and L2 intersect and both
q1 and q2 are located at this intersection point. For the
sake of clarity, we will treat this case separately and we
assume for the moment that L1 and L2 do not intersect.
The line A will be the axis of a cone through P pro-

2 + b2

viding the two following conditions hold:

• A intersect L, in which case the intersection point is

the apex of the cone,

• the angle between n1 and A must be equal to the

angle between n2 and A.

A can be parameterized as the set of points (1− λ)q1 + λq2
for λ ∈ R. It is necessary to have z2 + λ2c2 − λ1 (cid:54)= 0 for
otherwise A is parallel to the plane z = 0 and hence it does
not intersect L, unless λ1 = z2 + λ2c2 = 0 but in this case
the apex would be p1 which is impossible (normal vector is
not well deﬁned at the apex). So, assuming z2+λ2c2−λ1 (cid:54)=
0, the intersection point between A and the plane z = 0 is
the point of coordinates

(cid:19)

(cid:18)

−λ1

x2 + λ2a2

z2 + λ2c2 − λ1

,−λ1

y2 + λ2b2

z2 + λ2c2 − λ1

, 0

.

(6)

Reporting this point in L we get the following ﬁrst con-
straint on λ1 and λ2 :

λ1λ2(a2

2 + b2

2) − λ1z2c2 + (p2.n2)(z2 + λ2c2) = 0.

(7)

7

Now, denote by q the vector q2−q1, the second condition is
obtained by imposing q.n1 = ±q.n2/(cid:107)n2(cid:107), the sign change
being a consequence of the fact that the normals are sup-
posed to be oriented with respect to the interpolating cone.
More explicitly, we obtain the equation

2 + b2

2 + c2

2z2 − b2c2y2

ρ(z2 + λ2c2 − λ1) = ε(−c2λ1 + ρ2λ2 + p2.n2),

(8)
2 and ε = ±1. This lat-
ter condition being linear in λ1 and λ2, one can solve the
system of equations (7) and (8) in closed form. More pre-
cisely, once ε is ﬁxed, we get the two following solutions :

where ρ = (cid:107)n2(cid:107) = (cid:112)a2
 λ(cid:48)

2z2 − a2c2x2 + b2
a2
1 =
a2
2 + b2
2
2 = − a2x2 + b2y2
λ(cid:48)

p2.n2
c2 + ερ
λ2 = − z2

a2
2 + b2
2

c2 + ερ
Observe that |c2| (cid:54)= ρ since it is assumed that n2 is not
parallel to n1. Another important observation is that the
solution (λ(cid:48)
2) is independent of ε and moreover satisﬁes
z2 + λ(cid:48)
1 = 0. Therefore, it is not a valid solution.
So, we are left with two solutions to our geometric inter-
polation problem, namely

1, λ(cid:48)
2c2 − λ(cid:48)

 λ1 =

,

.

 λ1 =

p2.n2
c2 − ρ
λ2 = − z2
c2 − ρ

,

 λ1 =

p2.n2
c2 + ρ
λ2 = − z2
c2 + ρ

.

(9)

Once such a solution is chosen, then one can determine
a unique cone through P :
its apex is given by (6), its
direction is given by q = q2 − q1 and its angle is given by
the angle between the vectors p1 − apex and q.

It remains to treat the case where the lines L1 and L2
intersect. Let us denote by Π the plane that contains these
two lines, by N1 the normal line to L1 through p1, by N2
the normal line to L2 through p2 and by ω the intersection
point between N1 and N2. We notice that ω is nothing but
the intersection point between Π and L.
First, we observe that there are always two cones through
P. These two cones have the same apex ω and their axis
are the perpendicular bisectors of the lines N1 and N2
through ω. Therefore, these two cones are symmetric with
respect to the plane Π and their intersection is composed
of the two lines N1 ∪N2. They are no other cones through
P and whose axis is contained in Π (equivalently whose
apex is ω).
Now, we are looking for cones through P and whose
apex α is such that α ∈ L \ {ω}. Since the axis of such
a cone must intersect L1 and L2 and go through α which
is not in Π, then it must be the line through α and q :=
L1 ∩ L2 ∈ Π (recall that it is assumed that n2 and n1 are
not proportional). Therefore, a necessary condition for the
existence of a cone through P and whose axis is the line
through α and q is that (cid:107)qp1(cid:107) = (cid:107)qp2(cid:107) (Euclidian distance)
because p1 and p2 must be on the same circle (normal
section) of the cone. But it turns out that this is also a

suﬃcient condition. More precisely, if (cid:107)qp1(cid:107) = (cid:107)qp2(cid:107) then
for any point α ∈ L \ {ω} there exists a cone through P
and whose axis is the line through q and α. To prove this,
we have to show that the angles (αq, αp1) and (αq, αp2)
are the same. For i = 1, 2, we have that

(cid:126)αq. (cid:126)αpi = ( (cid:126)αω + (cid:126)ωq).( (cid:126)αω + (cid:126)ωpi) = (cid:107) (cid:126)αω(cid:107)2 + (cid:126)ωq. (cid:126)ωpi

because L is normal to Π by construction. But since
(cid:107)qp1(cid:107) = (cid:107)qp2(cid:107), the points q, p1, p2, ω form an orthodiago-
nal quadrilateral and it follows that (cid:126)ωq. (cid:126)ωp1 = (cid:126)ωq. (cid:126)ωp2.
In summary, when the lines L1 and L2 intersect there
always exists two cones through P, whose axis are con-
If (cid:107)qp1(cid:107) (cid:54)= (cid:107)qp2(cid:107) then there are no more
tained in Π.
cones through P, otherwise there are inﬁnitely many cones
through P, more precisely a 1-dimensional family of cones
which is parameterized by L. A last observation is that if
(cid:107)qp1(cid:107) = (cid:107)qp2(cid:107) then the two perpendicular bisectors of N1
and N2 through ω goes through q, so that there is a conti-
nuity in this family of cones through P when α is moving
on the line L.

Theorem 4. Suppose given an oriented set of two distinct
points P and denote by L the line through p1 with direction
n1 and by L2 the line through p2 with direction n2. If the
two following conditions hold

i) n1 and n2 are not proportional,
ii) if the lines L1 and L2 intersect at a point q then

(cid:107)qp1(cid:107) (cid:54)= (cid:107)qp2(cid:107),

then there are exactly two real cones through P. More-
over, the intersection of these two cones consists only of
the points p1 and p2, except if they share the same apex in
which case their intersection consists of the lines N1 and
N2.
If n1 is parallel to n2 then there is no cone through P
unless p2 belongs to the plane N1, in which case there are
inﬁnitely many cones through P.
If the lines L1 and L2 intersect at a point q such that
(cid:107)qp1(cid:107) = (cid:107)qp2(cid:107), then there are inﬁnitely many cones through
P.

Extraction algorithm. From the above analysis, we deduce
the following extraction algorithm of cones through a set
of two oriented points P.

1. Perform a linear change of coordinates so that we

have p1 = (0, 0, 0) and n1 = (0, 0, 1).
2. If n1 and n2 are proportional then check wether p2
belongs to N1 and return that either there is no
cone through P, or there are inﬁnitely many cones
through P.
3. If L1 intersect L2, then if (cid:107)qp1(cid:107) (cid:54)= (cid:107)qp2(cid:107) return the
two cones through P, otherwise if (cid:107)qp1(cid:107) = (cid:107)qp2(cid:107)
return that there are inﬁnitely many cones through
P.

8

Figure 3: Two cones through a general set of two oriented points.

Figure 4: Two cones intersecting along two lines and sharing the
same apex.

4. Now, since n1 is not proportional to n2 and L1∪L2 =
∅, there are exactly two cones through P that are
computed by means of the closed formulas (9).

This algorithm has been implemented with the Maple
software. We observed that the computation of the cylin-
ders through a random set of points takes in average 3.8ms
and is almost constant independently of the point set.
Some illustrative conﬁgurations are shown in Figure 3 and
Figure 4.

3.2. Cones through a mixed minimal point set

We seek for cones through a set P which is composed
of an oriented point (p1, n1) and three other simple points
p2, p3, p4. By a linear change of coordinates, one can as-
sume without loss of generality that p1 := (0, 0, 0) and
n1 := (0, 0, 1). For the remaining data, we set p2 =
(x2, y2, z2) , p3 = (x3, y3, z3) and p4 = (x4, y4, z4).

The axis of a cone through P must intersect the line
generated by n1 through p1 in a point q = (0, 0, r). Ob-
serve that r must be nonzero otherwise p1 would be the
apex of such a cone, which is impossible since it is a non-
singular point. In addition, the apex of a cone through P
must belong to the normal plane to n1 through the point
p1 and we choose to represent the coordinates of this point
by p = (ar, br, 0). Again, observe for the same reason that
a and b must be nonzero, i.e. a2 + b2 (cid:54)= 0.

1. Perform a linear change of coordinates so that we

have p1 = (0, 0, 0) and n1 = (0, 0, 1).

2. Instantiate the pencil of matrices A, B with the co-

3. Compute the eigenvalues and eigenvectors and de-

ordinates of the input points.
duce the real cones through P.

This algorithm has been implemented with the Maple
software. We observed that the computation of the cylin-
ders through a random set of points takes in average 7.5ms
and is almost constant independently of the point set. The
proportion of the number of cylinders found through ran-
dom point sets is given in Table 3 and some illustrative
conﬁgurations are shown in Figure 5.

Now, a point m = (x, y, z) belonging to a cone through

P must satisfy

( (cid:126)pm · (cid:126)pq)2 = (cid:107)pm(cid:107)2(cid:107)pq(cid:107)2κ,

that is to say

r2 (−a(x − ar) − b(y − br) − z)2 =

r2(cid:0)(x − ar)2 + (y − br)2 + z2(cid:1)(cid:0)a2 + b2 + 1(cid:1) κ

where κ > 0 is a constant that corresponds to the angle of
the cone. The factor r2 can be cancelled out. Moreover,
the cone goes through p1 so we deduce that

= r2(cid:0)a2 + b2(cid:1)(cid:0)a2 + b2 + 1(cid:1) κ.

r2(cid:0)a2 + b2(cid:1)2

Reporting in the previous equation, we ﬁnally deduce that
the point m = (x, y, z) belonging to a cone through P must
satisfy F (x, y, z) = 0 where

F (x, y, z) = 2(cid:0)a2 + b2(cid:1) zr +(cid:0)a2 + b2 − 1(cid:1) z2

− 2 (ax + by) z + (bx − ay)2 .

The three parameters a, b and r are to be determined and
we will use the three points p2, p3 and p4 for that purpose.
Assume that one of the point p2, p3, p4, say p2, is not in
the plane of equation z = 0 (the case where all the points
are in this plane will be discussed later). Hence z2 (cid:54)= 0.
Then, there exists a cone through P if and only if
F (x2, y2, z2) = 0, z3F (x2, y2, z2) − z2F (x3, y3, z3) = 0,

z4F (x2, y2, z2) − z2F (x4, y4, z4) = 0.

It turns out that the two last equations are independent
of r; for i = 3, 4 we have

ziF (x2, y2, z2) − z2F (xi, yi, zi) =
2zi − yi

(cid:0)y2
−(2x2z2zi − 2xiz2zi) a+(cid:0)x2

2(cid:1) a2 − (2x2y2zi − 2xiyiz2) ab
2(cid:1) b2

2zi − z2zi

2z2 + z2

2.

2zi − xi

2z2 + z2
− (2y2z2zi − 2yiz2zi) b − z2

2zi − z2zi
2zi + z2zi

Since these two equations are quadratic in a and b, they
have four common roots. Once a and b are determined
then r is uniquely deﬁned by the equation F (x2, y2, z2) = 0
which is linear in r. So, we have proved the following
result.
Theorem 5. Suppose given a general mixed point set P,
then there is 0, 2 or 4 cones through P.

Extraction algorithm. From the above analysis, the ex-
traction algorithm of cones through a mixed point set
P composed of an oriented point and three other dis-
tinct points relies on the solving of two algebraic equa-
tions in two variables. To solve such systems, we pro-
ceed as in Section 2.2.2 by means of eigen-computations
from a pencil of matrices which is in closed form in terms
of the input data. This pencil A, B of 8 × 8 matrices
is obtained as the companion matrices of both equations
ziF (x2, y2, z2) − z2F (xi, yi, zi) = 0, i = 3, 4.

9

Figure 5: Two conﬁgurations of P with 2 and 4 cones passing through
P.

Number of cones
Proportion (%)

0
6.9

2

85.9

4
7.2

Table 3: Proportion of the number of cylinders found through a
thousand random point sets.

3.3. Cones through six points

We seek for cones through a set P composed of six
simple points p1, p2, p3, p4, p5, p6. By a linear change of
coordinates, we can assume without loss of generality that

p1 = (0, 0, 0), p2 = (x2, 0, 0), p3 = (x3, y3, 0),
p4 = (x4, y4, z4), p5 = (x5, y5, z5), p6 = (x6, y6, z6).

(10)

Geometric analysis. The general equation of a cone de-
pends on 6 parameters:

F (x, y, z) :=

(x−a)2+(y−b)2+(z−c)2−(l(x−a)+m(y−b)+n(z−c))2

(11)

where (a, b, c) are the coordinates of the apex and the vec-
tor (l, m, n) encodes the direction of the axis as well as the
angle of the cone (l2 + m2 + n2 = 1/ cos2(θ), θ being the
angle of the cone).

We introduce the quantity k := al + bm + cn. Since p1

is the origin, we get the equation

F (p1) = a2 + b2 + c2 − k2 = 0.
Moreover, we observe that the polynomial

(12)

F (x, y, z)− F (p1) = 2 (lx + my + nz) k− 2(ax + by + cz)
−2lmxy−2lnxz−2mnyz−l2x2−m2y2−n2z2+x2+y2+z2

is linear in a, b, c and k. From the equation
F (p2) − F (p1) = 2lx2k − 2x2a − l2x2

2 + x2

2 = 0

we get, assuming x2 (cid:54)= 0, i.e. p2 (cid:54)= p1,
(1 − l2).

a = lk +

x2
2

(13)

(14)

Now, we have that

F (p3) − F (p1) = 2my3k − 2y3b + x3l2x2
− l2x3
2 − x3x2 + x3

2 − 2lmx3y3 − m2y3

2 + y3

2 = 0

and we get, assuming y3 (cid:54)= 0, i.e. assuming that p1, p2 and
p3 are not aligned,

1
2y3

b = mk +

2 − 2lmx3y3
2 − x3x2 + x3
Continuing this way, we get the equation

−m2y3

2(cid:1) .

(15)

2 + y3

(cid:0)x3l2x2 − l2x3

F (p4) − F (p1) = 2z4nk − 2z4c

1
y3

(−l2x2x3y4 + l2x2x4y3 + l2x3

2y4 − l2x4
+
+ 2lmx3y3y4 − 2lmx4y4y3 − 2lnx4z4y3 + m2y3
− m2y4

2y3 − 2mny4z4y3 − n2z4
− x3

2y3 − y3

2y4 + x4

2y4
2y3 + x2x3y4 − x2x4y3
2y3) = 0

2y3 + z4

2y4 + y4

2y3

we get, assuming that z4 (cid:54)= 0, i.e. assuming that p1, p2, p3
and p4 are not coplanar,

1

2y3z4

c = nk +

(−l2x2x3y4 +l2x2x4y3 +l2x3
+2lmx3y3y4−2lmx4y4y3−2lnx4z4y3 +m2y3
− 2mny4z4y3 − n2z4

2y3 + x2x3y4 − x2x4y3 − x3
2y3 + z4

2y4 + y4

− y3

2y4−l2x4
2y4−m2y4
2y4 + x4
2y3).

2y3

2y3
2y3
(16)

From here, we substitute a, b and c by the above quantity
that we found in both equations F (pi) − F (p1) = 0 with
i = 5, 6. It is important to notice that these two equations
do not depend on k because of the cancellation of the two
terms 2 (lx + my + nz) k − 2(ax + by + cz) in (13) by this
substitution. We get two equations Hi(l, m, n), i = 5, 6,
that satisfy

y3z4Hi(l, m, n) =

(x2x3y4zi − x2x3yiz4 − x2x4y3zi + x2xiy3z4
−x3

2y3zi − xi

2y4zi + x3

2yiz4 + x4

2y3z4

+ (−2x3y3y4zi + 2x3y3yiz4 + 2x4y3y4zi − 2xiy3yiz4) lm

+(cid:0)−y3
+ (2y3y4z4zi − 2y3yiz4zi) mn +(cid:0)y3z4

+ (2x4y3z4zi − 2xiy3z4zi) ln
2zi − yi
2y4zi + y3

2yiz4 + y3y4

2y3z4
− x2x3y4zi + x2x3yiz4 + x2x4y3zi − x2xiy3z4

2y3z4
2zi − zi

2y4zi − x3
+ x3
2yiz4 − y3y4

2yiz4 − x4
2zi + yi

2y3zi + xi
2y3z4 − y3z4

− y3

2y3z4 + y3
2zi + zi

2y4zi
2y3z4 = 0.

(cid:1) l2
(cid:1) m2
(cid:1) n2

These equations H5 and H6 are polynomials of degree 2 in
l, m, n and only the constant term and monomials of degree
2 have nonzero coeﬃcients. The equation H5 depends on
the coeﬃcients of p2, p3, p4 and p5 whereas H6 depends
on the coeﬃcients of p2, p3, p4 and p6. Now, applying the
same substitutions and replacing k by its deﬁning value
in (12), we get another equation H0(l, m, n) which is of
degree 6 in l, m, n and such that only monomials of even
degree have nonzero coeﬃcients. Observe that H0 only
depend on the coordinates of p2, p3 and p4. To give an
idea, we have

4y2

(cid:0)−x2

2z4

2y4

4(l2 + m2 + n2 − 1)H0 =
3z2
2 + 2x2
2x3
3z4
3y3
2x4

2 − x2
2x3
3y4
2 + 2x2x3
2y3y4 + 2x2x4
+2x3

+2x2x3
−2x2x3x4

2x4

2

2y3

2x3x4y3y4 − x2
2 − 2x2x3
2x4y3y4
2 − x3
2 − x3
4y4
2y3y4 − x4
4y3

2(cid:1) l6 + ···

4z4

2

We notice that the quantity l2+m2+n2−1 can be assumed
to be nonzero because cones such that l2 + m2 + n2 = 1
are degenerated to straight lines.
The common roots of the equations H0, H5 and H6
yields exactly all the cones through P. If ﬁnite, this num-
ber is at most 2 × 2 × 6 = 24 because of the B´ezout the-
orem. However, each cone through P yields two solutions

10

be actually given in closed form in terms of l, m, n and the
coordinates of the input points. This is because the three
equations (14), (15) and (16) yields a linear system in a, b, c
after replacing k by its deﬁning value al + bm + cn.

In Figure 6 it is shown that all the possible number
of solutions are reached in practice. Finally, observe that
the particular case w = n2 = 0 can be treated indepen-
dently in the same vain as above.
Indeed, the remain-
ing variables l, m can be computed from the equations
H5(l, m, 0) = 0 and H6(l, m, 0) = 0. Moreover, to solve
eﬃciently this system one can perform a transformation
similar to σ by considering the equations H5(um, m, 0) = 0
and H6(um, m, 0) = 0 that are linear equations in m2. At
the end, the computed solutions have to satisﬁed the equa-
tion H0 in order to validate that they correspond to cones
through the given set of points P.

of this polynomial system H0 = 0, H5 = 0, H6 = 0, namely
(l0, m0, n0) and (−l0,−m0,−n0). This latter property is a
consequence of the fact that H0, H5, H6 can be written on
monomials of even total degree in l, m, n. Therefore, we
deduce that there is at most 12 cones through P. Never-
theless, in order to devise an eﬃcient algorithm for com-
puting those cones through P, we apply a transformation
(called a σ-process or a blow-up in birational geometry) in
order to break the above central symmetry and reduce the
degree of the equations so that each cone will correspond
to a unique root of the new polynomial system.

Consider the transformation

(cid:18)

σ : R3 → R3
(l, m, n)

(cid:55)→

u :=

l
n

, v :=

m
n

(cid:19)

, w := n

.

Since the equations H0, H5 and H6 only contain even de-
gree monomials, their transform under σ will be a poly-
nomial in n2 (and not only a polynomial in n). More
precisely, setting w := n2, we have

H0(un, vn, n) = w3P (u, v) + w2Q(u, v) + wR(u, v) + S,
H5(un, vn, n) = wH(u, v) + C,
H6(un, vn, n) = wK(u, v) + D,

where H, K, P, Q, R are polynomials in u, v of degree 2, 2,
6, 4, 2 respectively, and where C, D, S are constant that
only depends on the xi’s, yi’s and zi’s. Now, since the
two last equations are linear in w we can simplify this
polynomial system by w, assuming w (cid:54)= 0, to get

E0(u, v) = C 3P (u, v) − C 2Q(u, v)H(u, v)

(17)
+ CR(u, v)H(u, v)2 − SH(u, v)3,

E1(u, v) = DH(u, v) − CK(u, v),

E2(u, v, w) = wK(u, v) + D.

The two equations E0 and E1 are bivariate polynomials in
u, v of degree 6 and 2 respectively. Therefore, they deﬁne
at most 12 solutions.
In addition, for each solution the
value of w can be computed from E2. As a consequence,
we have just proved the following result.
Theorem 6. Suppose given a point set P composed of six
distinct points. Then, if ﬁnite, there is an even number of
cones through P, which is possibly 0 and at most 12.

Proof. The solving of the polynomial system E0(u, v) =
E1(u, v) leads to an even number of real solutions with a
maximum of 12 = 6×2 solutions. So the only thing to show
is that there is a bijection between these solutions and the
cones through P. For that purpose, we ﬁrst observe that
the value of w is uniquely determined from each of those
roots by equation E2. And then the solutions (u, v, w) are
uniquely pullback to a solution (l, m, n) under σ.

So, it remains to show that once a solution (l, m, n)
is computed, then the parameters a, b and c are uniquely
determined. This is indeed the case because a, b and c can

Figure 6: Conﬁgurations of points P with 2, 4, 6, 8, 10 and 12 cones
passing through P.

Extraction algorithm. Summarizing the above analysis, the
solving of the cones through P can be done as follows.

1. Perform a linear change of coordinates so that the

ﬁve points are of the form (10).

2. If x2, y3 or z4 is equal to zero then we are in a par-
ticular conﬁguration (see Section 3.3) then this algo-
rithm stops here.

11

Number of cones
Proportion (%)
Number of cones
Proportion (%)

0
1
8

18,7

2

10,5
10
3,9

4

28,7
12
0,9

6

36,3

Table 4: Proportion of the number of cones found through a thousand
random point sets.

3. Build the system of equations (17) which is given in
closed form in terms of the coordinates of the input
points.

4. Solve the system E0(u, v) = E1(u, v) = 0 in the two
variables u, v by means of eigenvectors and eigenval-
ues computations, as explained in Section 2.2.2 (see
[2] for details). It returns a list of an even number
between 0 and 12 of reals solutions (up to a given
precision).

5. For each above solution (ui, vi), compute the corre-

sponding value of wi with the equation E2(ui, vi, wi) =
0. Then, pullback the solution (ui, vi, wi) under σ to
wi) of
get the solutions (li = uini, mi = vini, ni =
the polynomial system H0 = H5 = H6 = 0.

√

6. For each solution (li, mi, ni), compute the correspond-
ing (ai, bi, ci) (as explained in the proof of Theorem
6) and return the corresponding cone through P.

This algorithm has been implemented with the Maple
software. We observed that the computation of the cones
through a random set of points takes in average 80ms and
is almost constant independently of the point set. In Ta-
ble 4, we provide the repartition of the number of cones
through a set of point P for a random sample of a thousand
point sets P.

Some particular conﬁgurations. If any subset of four points
in P is coplanar then all the six points in P are necessar-
ily coplanar. In such a conﬁguration, there exists a cone
through P if and only if P can be interpolated by a conic
section (parabola, hyperbola or ellipse). If this is the case,
then there are inﬁnitely many cones through P. When a
subset of ﬁve points in P are coplanar then we get inter-
esting particular conﬁgurations.
Theorem 7. Suppose given a point set P where ﬁve points
are coplanar but not six. Then, there exists a cone through
P if these ﬁve points are located on a conic section. More-
over, if this is the case then there are at most four cones
through P.
More speciﬁcally, if the ﬁve points are co-circular, then
there are two cones through P and if they are on a parabola
then there are at most 3 cones through P.

Proof. It is clear that the ﬁve coplanar points must be
on a conic section if there exists a cone through P. By
a change of coordinate system, one can assume that this
conic section in the plane z = 0 and is in its canonical

αϕ2(n) +

β
α

= 4c2z2

0(αn2 − β)2 = 4z2

0

(αn2 − β)

β
α

which is an equation of degree 4 in n. Therefore, once
m is chosen from the condition m2 = 1 − β/α, we obtain

12

form. We examine below the three cases that correspond
to an ellipse, an hyperbola and a parabola.

Ellipse. The equation of the conic section is of the form

αx2 + βy2 − 1 = 0, α, β > 0

and it must coincide with the intersection of the implicit
equation of a cone (11) after the substitution z = 0. Now,
we proceed by identiﬁcation of the monomial coeﬃcients
of these two equations.
the coeﬃcient of the monomial
xy yields the condition 2lm = 0 so that l = 0 or m = 0.
If l = 0, then the coeﬃcients of y2 yields the condition
m2 = 1 − β/α and if m = 0 then the coeﬃcients of x2
yields the condition l2 = 1 − α/β. Depending on the ratio
α/β, only one case leads to real solutions. From now on
we assume that α/β ≥ 1, the other case can be treated
similarly. So we have that

l = 0, m2 = 1 − β
α

≥ 0.

The coeﬃcient of the monomial x yields the condition a =
0 and the coeﬃcient of y gives the condition

b = − cmn
m2 − 1

=

α
β

cmn

(18)

(observe that m2 − 1 (cid:54)= 0). Finally, the coeﬃcients of the
monomial 1 yields the condition

(αn2 − β)c2 − β
α

= 0.

(19)

Now, let (x0, y0, z0) be the coordinates of the sixth point.
The evaluation of (11) at this point together with the con-
ditions l = 0, a = 0 and (18) yields the condition

(cid:18)

(cid:19)

(cid:18)

(cid:19)

c2

n2 − β
α

− 2cz0

n2 − β
α

+ ϕ2(n) = 0

(20)

(recall that α, β > 0 and in particular m2 − 1 (cid:54)= 0) where

2(cid:1) n2 +(cid:0)−2 m3y0z0 + 2 my0z0

(cid:1) n

ϕ2(n) :=(cid:0)−m2z0

2 + z0

− m4y0

2 + m2x0

2 + 2 m2y0

2 + m2z0

2 − x0

2 − y0

2 − z0

2

is a degree 2 polynomial in n which is independent of c.
The cones through P are in correspondence with the solu-
tions of the equations (19) and (20) in the variables c and
n. Using (19), Equation (20) becomes

(cid:0)αn2 − β(cid:1) = αϕ2(n) +

β
α

and hence we get

(cid:18)

2cz0

(cid:19)2

4. Conclusion

In this paper, we have presented several methods in or-
der to extract eﬃciently cylinders and cones from minimal
point sets. We have also provided a detailed analysis of
these interpolation problems and we have given optimal
bounds on the number of solutions. Our approach relies
on closed algebraic formulas that have been computed and
experimented with the help of a computer algebra system.
In a near future, we plan to implement these methods into
an eﬃcient C++ library. Another future research direc-
tion will be the extraction of tori from a minimal point
set, tori being described by means of seven parameters.

Ackowledgments

The authors are grateful to Pierre Alliez for several in-
teresting discussions about RANSAC-type algorithms and
the extraction of geometric primitives in 3D point sets.

References

References

[1] Matthew Berger, Andrea Tagliasacchi, Lee Seversky, Pierre Al-
liez, Joshua Levine, Andrei Sharf, and Claudio Silva. State of the
Art in Surface Reconstruction from Point Clouds. In Eurograph-
ics 2014 - State of the Art Reports, volume 1 of EUROGRAPH-
ICS star report, pages 161–185, Strasbourg, France, April 2014.
and Bernard Mourrain.
Resultant-based methods for plane curves intersection problems.
In Victor G. Ganzha, Ernst W. Mayr, and Evgenii V. Vorozhtsov,
editors, Computer Algebra in Scientiﬁc Computing (CASC), vol-
ume 3718, pages 75–92, Kalamata, Greece, September 2005.
Springer Berlin / Heidelberg.

[2] Laurent Bus´e, Houssam Khalil,

[3] Olivier Devillers, Bernard Mourrain, Franco P. Preparata, and
Philippe Trebuchet. Circular cylinders through four or ﬁve points
in space. Discrete & Computational Geometry, 29(1):83–104,
2002.

[4] Martin A. Fischler and Robert C. Bolles. Random sample
consensus: A paradigm for model ﬁtting with applications to
image analysis and automated cartography. Commun. ACM,
24(6):381–395, June 1981.

[5] Daniel Lichtblau. Cylinders through ﬁve points: Computational
algebra and geometry. Journal of Mathematics Research, 4(6),
2012.

[6] Gabor Luk´acs, Ralph Martin, and Dave Marshall. Faithful least-
squares ﬁtting of spheres, cylinders, cones and tori for reliable
segmentation. In Hans Burkhardt and Bernd Neumann, editors,
Computer Vision — ECCV’98, volume 1406 of Lecture Notes in
Computer Science, pages 671–686. Springer Berlin Heidelberg,
1998.

[7] Ruwen Schnabel, Roland Wahl, and Reinhard Klein. Eﬃcient
ransac for point-cloud shape detection. Computer Graphics Fo-
rum, 26(2):214–226, June 2007.

at most 4 values of n and all the others parameters are
uniquely determined. We conclude that we have at most
four cones through P, as claimed.

0(n2− 1)− (x2

If the conic section is a circle, i.e. α = β, we have
l = m = 0. In this case, ϕ2(n) = z2
0) and
hence the degree 4 equation in n is actually an equation in
n2. Therefore, the 4 solutions arises by pairs of opposite
solutions and we deduce that we have two cones through
P.
Hyperbola. The equation of the conic section is of the form

0 + y2

αx2 − βy2 − 1 = 0, α, β > 0

and we proceed similarly to the case of the ellipse. The
identiﬁcation of xy implies that 2lm = 0 so we have to
cases to consider, namely l = 0 and m = 0.

If l = 0 then the coeﬃcient of y2 yields m2 = 1 + β/α.
The coeﬃcient of x shows that a = 0 and the coeﬃcient
of y gives

b = − α
β

cmn.

Then, the constant term yields the equality
b2 + c2 − (bm + cn)2 = − 1
α
which becomes, after the substitution of b,

(cid:18)

(cid:19)

c2

1 +

α
β

n2

= − 1
α

.

Therefore, there are no real solutions in this case.

Now, if m = 0, then l2 = 1 + α/β. the coeﬃcient of y

shows that b = 0 and the coeﬃcient of x gives

a = − ncl
l2 − 1

= − β
α

ncl.

Then, the constant coeﬃcient yields the equation

c2(l2 + n2 − 1)

l2 − 1

=

1
β

.

From here, we use the sixth point as in the case of the
ellipse and we get again 4 possible real cones through P.
Parabola. The equation of the conic section is of the form

x2 − αy = 0, α > 0.

again, we inspect the coeﬃcients of (11) after the substi-
tution z = 0. The coeﬃcient of x2 gives l = 0 and the
coeﬃcient of y2 gives m2 = 1. The coeﬃcient of x gives
a = 0 and the coeﬃcient of y gives 2cmn = −α. Finally,
the constant coeﬃcient yields

b = − c2(1 − n2)

.

α

Now, choosing m = 1 and using the sixth point of coor-
dinates (x0, y0, z0), the equation (11) gives an equation of
degree 3 in n, namely

− 2z0

2n3 + (−αz0 − 4y0z0) n2

+(cid:0)−2y0α + 2x0

2 + 2z0

2(cid:1) n + αz0 = 0

and from here c can be uniquely determined.

13

