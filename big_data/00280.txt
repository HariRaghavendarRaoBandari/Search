6
1
0
2

 
r
a

M
1

 

 
 
]

.

G
D
h
t
a
m

[
 
 

1
v
0
8
2
0
0

.

3
0
6
1
:
v
i
X
r
a

SMOOTHING AND NON-SMOOTHING VIA A FLOW

TANGENT TO THE RICCI FLOW

MATTHIAS ERBAR AND NICOLAS JUILLET

Abstract. We study a transformation of metric measure spaces in-
troduced by Gigli and Mantegazza consisting in replacing the original
distance with the length distance induced by the transport distance
between heat kernel measures. We study the smoothing eﬀect of this
procedure in two important examples. Firstly, we show that in the case
of some Euclidean cones, a singularity persists at the apex. Secondly, we
generalize the construction to a sub-Riemannian manifold, namely the
Heisenberg group, and show that it regularizes the space instantaneously
to a smooth Riemannian manifold.

1. Introduction

There are many ways to deform a Riemannian manifold into a singular met-
ric space as discussed for instance in the inﬂuential essay of Gromov [18]. We
are interested in the opposite question whether there exists a deformation,
intrinsically deﬁned for a wide class of metric spaces that instantaneously
turns the space into a Riemannian manifold. In this paper, we investigate
a method that has been introduced by Gigli and Mantegazza [17]. We ex-
amine its regularization properties in two important cases: Euclidean cones
and the Heisenberg group. These are emblematic examples of Alexandrov
spaces and subRiemannian spaces respectively. We also discuss normed
vector spaces where the transformation turns out to be the identity as an
example of Finsler structures.
Before we state our results we brieﬂy explain the main features of the con-
struction of Gigli and Mantegazza which is based on the interplay of optimal
transport and Ricci curvature. The starting point is a metric measure space
(X, d, m) on which a reasonable notion of heat kernel can be deﬁned. For
t > 0 a new distance dt(x, y) is deﬁned as the length distance induced by
the L2 Wasserstein distance built from d between the heat kernel measures
centered at x and y.
The striking feature of this approach is the following main result of [17]:
When (X, d, m) is a Riemannian manifold then dt is induced by a smooth
metric tensor gt that is tangent to the Ricci ﬂow, i.e. ∂t|t=0gt = −2 Ric
in a weak sense. Gigli and Mantegazza then generalize this construction
to metric measures spaces with generalized Ricci curvature lower bounds,
namely the RCD condition, which ensures existence of a well-behaved heat
kernel. This can be seen as a ﬁrst step into constructing a Ricci ﬂow for

2010 Mathematics Subject Classiﬁcation. Primary 53C44; Secondary: 49Q20, 51F99,

51K10, 53C17.

Key words and phrases. Ricci ﬂow, optimal transport, Euclidean cone, Heisenberg

group.

1

2

MATTHIAS ERBAR AND NICOLAS JUILLET

non-smooth initial data. A related synthetic characterization of super-Ricci
ﬂows based on optimal transport has been obtained by McCann and Topping
[24].
One can think of dt as a sort of convolution of the original distance with
the heat kernel. Having the smoothing eﬀect of the heat equation and Ricci
ﬂow in mind, one might expect that this procedure gives a canonical way of
regularizing the metric measure space.
A ﬁrst study of the regularizing eﬀects of the Gigli-Mantegazza ﬂow has
been performed by Bandara, Lakzian and Munn [6] in the case where the
distance d is induced by a metric tensor with low regularity and isolated
conic singularities. It is shown that dt is induced by a metric tensor with at
least the same regularity away from the original singular set. The question,
what happens at the singularities has been left unanswered.
In the present paper, we give an answer showing that conic singularities can
persist under the Gigli-Mantegazza transformation. We analyse in detail
the transformation for two speciﬁc Euclidean cones of angle π and π/2. Our
results are the following (see Theorem 3.11 and Proposition 3.10 below).

Theorem 1.1. Let C(π) be the two-dimensional Euclidean cone of angle π
and d its distance. For every t > 0 the convoluted distance dt has a conic
singularity of angle √2π at the apex.
As t goes to zero, the metric space (C(π), dt) tends to (C(π), d) pointwise
and in the pointed Gromov–Hausdorﬀ topology. As t goes to inﬁnity, it
tends to the Euclidean cone of angle √2π in the pointed Gromov–Hausdorﬀ
topology.

In fact, it turns out that for ﬁxed θ > 0 all spaces (C(θ), dt) for t > 0 are
isometric up to a multiplicative constant. An isometry is induced by the
radial dilation x ∈ C(θ) 7→ t−1/2x. Our second result shows that for the
cone of angle π/2 the behavior of the singularity is even worse (see Theorem
3.17 and Proposition 3.16 below).

Theorem 1.2. Let C(π/2) be the two dimensional Euclidean cone of an-
gle π/2 and d its distance. For every t > 0, the distance dt has a conic
singularity of angle zero at the apex.
As t goes to zero, the metric space (C(π/2), dt) tends to (C(π/2), d) point-
wise and in the pointed Gromov–Hausdorﬀ topology. As t goes to inﬁnity, it
tends to R+ with the Euclidean distance in the pointed Gromov–Hausdorﬀ
sense.

The reason why we focus on these two speciﬁc cones is that they can be
conveniently represented as quotients of R2 under rotation by π and π/2
respectively. It turns out that the convoluted distance dt is the length dis-
tance induced by the L2 Wasserstein distance between a mixtures of two
(respectively four) rotated copies of Gaussian measures with variance 2t.
A corollary of the previous theorem is that the space (C(π/2), dt) is not an
Alexandrov space even though C(π/2) is. In fact, in Alexandrov spaces a
triangle with one angle zero is ﬂat, which is wrong for (C(π/2), dt). This
negative result has to be compared to positive results by Takatsu [31], where
it is shown that the subspace made of all Gaussian measures in the Wasser-
stein space over Euclidean space is an Alexandrov space. Note moreover,

3

that the Wasserstein space over a non-negatively curved Alexandrov space is
again a non-negatively curved Alexandrov space [30, Proposition I.2.10] and
that many subspaces of ﬁnite dimensional Alexandrov spaces are known to
be Alexandrov spaces, for instance convex hypersurfaces in Euclidean spaces
or Riemannian manifolds of sectional curvature bounded below [1, 8, 25].
Given the relation of the Gigli–Mantagazza ﬂow with the Ricci ﬂow, the
convergence of dt to the original cone distance d has to be compared with
the fact that any Euclidean cones of dimension 2 can be obtained as the
backward limit of classical solutions to the Ricci ﬂow [13, Chapter 4.5]. See
also [29, 14] for related results in higher dimension.

Our second contribution in this paper is an investigation of the Gigli–
Mantegazza ﬂow applied to the ﬁrst Heisenberg group equipped with the
Carnot-Carath´eodory distance. The Heisenberg group is one of the sim-
plest examples of a non trivial Carnot group, i.e a nilpotent stratiﬁed Lie
groups with a left-invariant metric on the ﬁrst strata, and of a non triv-
ial subRiemannian manifold. These classes are of course connected: As
proved by Bella¨ıche [7], the tangent cones at points of subRiemannian spaces
are Carnot groups. The diﬀerentiable structure of the Heisenberg group is
the one of R3 and the group structure is given in coordinates (x, y, u) by
(x, y, u).(x′, y′, u′) = (x + x′, y + y′, u + u′ + (1/2)(xy′ − x′y)).
The Carnot–Carath´eodory distance is obtained by minimizing the length of
curves that are tangent to the 2-dimensional horizontal subbundle spanned
by X = ∂x − y
2 ∂u. A standard way to approximate this
distance is to consider for ε > 0 the Riemannian distance dRiem(ε) obtained
by considering X, Y, ε∂u as an orthonormal frame. In fact, this penalization
principle permits to see any subRiemannian manifold as a limit of Riemann-
ian manifolds. Note that (H, dcc) does not satisfy a generalized lower Ricci
curvature bound in the sense of the RCD condition. Therefore we slightly
generalize the construction in [17] and obtain the following result (see The-
orem 4.6 and Proposition 4.9 below).

2 ∂u and Y = ∂y + x

Theorem 1.3. Let (H, dcc) be the ﬁrst Heisenberg group equipped with the
Carnot–Carath´eodory distance. For t > 0, the convoluted distance dt co-
incides with KdRiem(κ√t), for some constants K, κ satisfying K ≥ 2 and
K/κ < √2.
As t goes to zero the distance dt converges to Kdcc pointwise. In the pointed
Gromov–Hausdorﬀ topology the space (H, dt) converges to (H, dcc).

The striking part of the theorem is that also non-horizontal curve can have
ﬁnite length after lifting them to the Wasserstein space built from dcc via
the heat kernel and thus dt becomes a Riemannian distance. We believe
that this behavior also holds for more general contact manifolds. However,
let us stress the fact that even for the Heisenberg group the distance dt does
not converge pointwise to dcc as t goes to zero. Convergence in pointed
Gromov–Hausdorﬀ sense only holds due to the high amount of symmetry
of the space, in particular, due to the fact that the dilation (x, y, u) 7→
(Kx, Ky, K 2u) is an isometry between (H, Kdcc) and (H, dcc). The Gromov–
Hausdorﬀ convergence probably does not hold for generic contact manifolds
of dimension 3 with a subRiemannian metric on the nonholonomic contact

4

MATTHIAS ERBAR AND NICOLAS JUILLET

distribution. Finally, note that also the Heisenberg group can be obtained
as a backward limit of classical solution to the Ricci ﬂow as was shown by
Cao and Saloﬀ-Coste [11].

Three sections follow this introduction. The next section contains the con-
struction of the convoluted distance dt in a general setting. As a ﬁrst ex-
ample we discuss the case of normed spaces. In Section 3 we establish our
results on the Euclidean cones C(π) and C(π/2). Section 4 is devoted to
the Heisenberg group.

Acknowledgements. The authors would like to thank Michel Bonnefont,
Thomas Richard and Andr´e Schlichting for stimulating discussions on this
work and related topics. Part of this work was accomplished while the
authors were enjoying the hospitality of the Hausdorﬀ Research Institute
for Mathematics in Bonn during the Junior Trimester Program on Optimal
Transport. They would like to thank HIM for its support and the inspiring
atmosphere. M.E. gratefully acknowledges support by the German Research
Foundation through the Collaborative Research Center 1060 The Mathemat-
ics of Emergent Eﬀects and the Hausdorﬀ Center for Mathematics. N.J. is
partially supported by the Programme ANR JCJC GMT (ANR 2011 JS01
011 01).

2. Construction of the flow

In this section we present the construction of the convoluted distance dt
in a general framework. The reason is that the framework of RCD spaces
considered in [17] (see subsection 2.3) does not cover the Heisenberg group.
Moreover, unlike in [17] the spaces of the present paper are non-compact

2.1. Preliminaries. Let (X, d) be a Polish metric space. Recall that for
p ≥ 1 a curve (γ)t∈[0,T ] in (X, d) is called p-absolutely continuous, for short
any 0 ≤ s ≤ t ≤ T :

γ ∈ ACp(cid:0)[0, T ], (X, d)(cid:1), if there exist a function m ∈ Lp(0, T ) such that for

d(γ(s), γ(t)) ≤ Z t

s

m(r) dr .

For p = 1, we may simply call it an absolutely continuous curve. In this
case the metric derivative deﬁned by

| ˙γs| = lim
h→0

d(γs+h, γs)

h

exists for a.e. s ∈ (0, T ) and is the minimal m as above, see [2, Thm. 1.2.1].
Lipschitz curves with respect to a distance d are called d-Lipschitz curves,
they are locally p-absolutely continuous for every p ≥ 1.
We denote by P(X) the set of Borel probability measures. The subset of
measures with ﬁnite second moment, i.e. satisfying

Z d(x0, x)2 dµ(x) < ∞

for some, hence any x0 ∈ X will be denoted by P2(X). Given µ, ν ∈ P2(X)
their L2-Wasserstein distance is deﬁned by

W (µ, ν) = inf

π sZ d(x, y)2 dπ(x, y) ,

5

where the inﬁmum is taken over all couplings π of µ and ν. Recall that

(cid:0)P2(X), W(cid:1) is again a Polish metric space. Sometimes we will write WX

or W(X,d) to avoid confusion about the underlying metric space (X, d).

2.2. Construction of the ﬂow. Recall that (X, d) is a metric Polish space.
Let us assume in addition that it is proper, i.e. closed balls are compact,
and that it is a length space, i.e. we have

d(x, y) = inf

| ˙γs| ds ,

γ Z T

0

where the inﬁmum is taken over all absolutely continuous curves γ connect-
ing x to y. Notice that (X, d) is in fact geodesic, i.e. each pair of points can
be joint by a curve whose length equals d(x, y).
The construction is based on a family of maps from X to P2(X) satisfying
some properties that we list now. One should keep in mind that in the
examples coming later the points are mapped to heat kernel measures.
Assumption 2.1. There exists a family (ιt)t≥0 of maps ιt : X → P2(X)
with the following properties:

• ι0(x) = δx for all x ∈ X,
• ιt is injective for all t ≥ 0,
• ιt is Lipschitz, more precisely, there exist constants Ct > 0 such that
(2.1)

W(cid:0)ιt(x), ιt(y)(cid:1) ≤ Ctd(x, y) ∀x, y ∈ X ,

• the curve [0,∞) ∋ t 7→ ιt(x) is continuous with respect to W for all

and t 7→ Ct is locally bounded from above,
x ∈ X.

t ≥ 0 given by

edt(x, y) = W(cid:0)ιt(x), ιt(y)(cid:1) .

distance. It is the chord distance induced by the embedding ιt. The main
object of study here will be the corresponding arc distance, i.e. the length

We introduce a new family of distance functions edt : X × X → [0,∞) for
As W is a distance it follows from the injectivity of ιt that edt is also a
distance induced by edt, denoted by dt. More precisely, we deﬁne for t ≥ 0
where the inﬁmum is taken over all curves γ ∈ AC(cid:0)[0, T ]; (X,edt)(cid:1) such that
γ0 = x, γT = y and | ˙γs|t denotes the metric derivative with respect to edt.

Note that (2.1) implies that

and x, y ∈ X:

γ Z T

dt(x, y) = inf

| ˙γs|t ds ,

0

(2.2)

dt(x, y) ≤ Ctd(x, y)

∀x, y ∈ X .

(2.3)

6

MATTHIAS ERBAR AND NICOLAS JUILLET

Indeed, for any curve (γs)s that is absolutely continuous with respect to d its
metric derivative with respect to d is bounded above as | ˙γs|t ≤ Ct| ˙γs|. The
claim then follows by integrating in s and taking the inﬁmum over all such
curves (γs)s noting that they are also absolutely continuous with respect

Remark 2.2. This construction is slightly diﬀerent from the one in [17],

to edt and that (X, d) is a length space.
where the inﬁmum in the deﬁnition of dt is taken over γ in AC(cid:0)[0, T ]; (X, d)(cid:1)
which is a subset of AC(cid:0)[0, T ]; (X,edt)(cid:1) by the Lipschitz assumption (2.1).

Allowing curves in the latter larger class will be crucial when applying the
construction in the case of the Heisenberg group in Section 4. In the case of
the Euclidean cones C(π), C(π/2) discussed in Section 3, we show in Lemma
3.6 that the inﬁma over both classes of curves agree so that we are consistent
with the construction in [17].

if we restrict the inﬁmum to edt-Lipschitz curves.

Remark 2.3. Note that the value of the inﬁmum in (2.2) does not change,
Indeed, the right hand
side of (2.2) is invariant by reparametrizreparametrizationation and every
absolutely continuous curve can be reparametrized as a Lipschitz curve, see
for instance [2, Lem. 1.1.4].

We can reformulate the deﬁnition of dt as follows. Given an absolutely

curve (µt

continuous curve (γs)s∈[0,T ] in (X,edt) we obtain an absolutely continuous

γs)s∈[0,T ] in(cid:0)P2(X), W(cid:1) by setting µt
| ˙µt
γs| ds ,

γs = ιt(γs). Then we have

dt(x, y) = inf

γ Z T

0

where | ˙µt
alent formulation is

γs| denotes the metric derivative with respect to W . Another equiv-

dt(x, y) = inf sup

W (µt

γsi

, µt

γsi+1

),

(2.4)

N−1Xi=0 edt(γsi, γsi+1) = inf sup

N−1Xi=0

the supremum being taken over all partitions 0 = s0 < s1 < ··· < sN = 1
and the inﬁmum over all continuous curves (γs)s∈[0,1] connecting x to y.
In this general setup we have the following continuity properties.

Gromov–Hausdorﬀ convergence. Moreover, assume in addition to Assump-

Proof. We ﬁrst prove the convergence statement. Let (tn)n converge to t.

Proposition 2.4. For all x, y ∈ X, the curve [0,∞) ∋ t 7→ edt(x, y) is con-
tinuous and the curve t 7→ (X,edt) is continuous with respect to the pointed
tion 2.1 that bounded sets in (X,edt) are bounded in (X, d). Then the dis-
tances edt and dt induce the same topology as the original distance d.
As an immediate consequence of Assumption 2.1 we have that edtn(x, y) →
edt(x, y) for ﬁxed x, y ∈ X. Moreover, by (2.1), for each compact set K
in (X, d) the functions edtn(·,·) are equicontinuous on K × K. Thus, they
converge uniformly to edt(·,·). This readily yields the convergence of (X,edtn )
to (X,edt) in the pointed Gromov–Hausdorﬀ sense. Now, we turn to the
second statement. First, recall from (2.3) that edt ≤ dt ≤ Ctd. Thus, it

7

suﬃces to show that for any sequence (xn)n, and element x of X with

the sequence xn is bounded in (X, d). Thus, up to taking a subsequence we

and we infer that x′ = x. This being independent of the subsequence chosen,
we conclude that the full sequence xn converges to x in (X, d).
(cid:3)

edt(x, xn) → 0 as n → ∞ we also have that d(xn, x) → 0. By assumption,
can assume that d(xn, x′) → 0 for some x′ ∈ X. Hence, also edt(xn, x′) → 0
Remark 2.5. We proved the continuity of the map t 7→ edt(x, y). The conti-

nuity of t 7→ dt(x, y) fails for the Heisenberg group at t = 0 as we will see
in Section 4. This is in contrast to [17, Thm. 5.18] where right-continuity
of this map is shown. Note however, that the Heisenberg group does not
satisfy the RCD condition and our construction is slightly diﬀerent in this
case, see Remark 2.2.

2.3. Riemannian manifolds and RCD spaces. In [17] the preceding
construction has been introduced and studied in the case where (X, d) is a
Riemannian manifold or more generally a metric measure spaces satisfying
the Riemannian curvature-dimension condition for some curvature param-
eter K ∈ R, denoted by RCD(K,∞). For short we call such spaces RCD
spaces. In both cases the embedding ιt is constructed using the heat kernel.
Let us brieﬂy recall the main results in [17].

Let (X, g) be a smooth compact and connected Riemannian manifold with
metric tensor g and let d and vol be the associated Riemannian distance and
volume measure. One can deﬁne a map ιt : X → P2(X) be setting ιt(x) =
x, where νt
νt
x(dy) = pt(x, y) vol(dy) is the heat kernel measure, i.e. pt(·,·) is
the fundamental solution to the heat equation on X. It can be veriﬁed that
Assumption 2.1 and Proposition 2.4 hold in this case.
Gigli and Mantegazza prove that the distances dt are induced by a family
of smooth metric tensors (gt)t≥0 and that this ﬂow of tensors is initially
tangent to the Ricci ﬂow [17, Prop. 3.5,Thm. 4.6]. More precisely, for every
geodesic (γs)s∈[0,1] with respect to g = g0:

d
dt

gt( ˙γs, ˙γs)(cid:12)(cid:12)t=0 = Ric( ˙γs, ˙γs)

for almost every s ∈ (0, 1) ,

where Ric denotes the Ricci tensor of g. Gigli and Mantegazza then gen-
eralize the construction for the initial data being a metric measure space
satisfying the RCD(K,∞). Since we do not work in this general setting,
we will describe it only brieﬂy. For more details on RCD spaces we refer to
[3, 4].
Roughly speaking, RCD spaces form a natural class of metric measure spaces
that can be equipped with a canonical notion of Laplace operator and a well
behaved associated heat kernel. The RCD(K,∞) is a reinforcement of the
curvature-dimension condition CD(K,∞) introduced by Lott–Villani and
Sturm [23, 30] as a synthetic deﬁnition of a lower bound K on the Ricci
curvature for a metric measure space (X, d, m). The condition CD(K,∞)
asks for the relative entropy

Ent(µ) =Z ρ log ρ dm ,

for µ = ρm ∈ P2(X)

8

MATTHIAS ERBAR AND NICOLAS JUILLET

to be K-convex along Wasserstein geodesics, i.e.

Ent(µs) ≤ (1 − s) Ent(µ0) + s Ent(µ1) −

K
2

s(1 − s)W (µ0, µ1)2 .

The RCD(K,∞) condition requires in addition that the ‘heat ﬂow’ obtained
as the Wasserstein gradient ﬂow of the entropy in the spirit of Otto [28] is
linear. This excludes e.g. Finslerian geometries. It is a deep insight that the
two requirements can be encoded simultaneously in the following property
(which we take as a deﬁnition of RCD spaces for the purpose of this paper).

Theorem 2.6 (Deﬁnition of the RCD spaces through the EVI [4, Thm.
5.1]). Let K be a real number. The metric measure space (X, d, m) satisﬁes
the Riemannian curvature-dimension condition RCD(K,∞) if and only if
for every µ ∈ P2(X) there exist an absolutely continuous curve (µt)t≥0 in
(P2(X), W ) starting from µ in the sense that W2(µ, µt) → 0 as t → 0 and
solving the Evolution Variational Inequality (in short EVI) of parameter K,
i.e. for all ν ∈ P2(X) such that Ent(χ|m) < ∞ and a.e. t > 0:
W (µt, χ)2 ≤ Ent(χ) − Ent(µt) .

W (µt, χ)2 +

K
2

d
dt

1
2

In fact, the solution µt to the EVI is unique and, putting Htµ = µt, one
obtains a linear semigroup on P2(X) which is called the heat ﬂow (acting
on measures) in X. The construction in [17] then proceeds as presented in
Section 2 by choosing the map ιt : X → P2(X) to be ιt(x) = Htδx. A
natural example of RCD spaces are Euclidean cones, see [21].

2.4. Normed spaces. For an example that can be studied rapidly and
is rather diﬀerent let us consider the ﬂow for Rn equipped with a norm
k·k. Indeed, the metric measure space (Rn,k·k, Leb) satisﬁes the condition
CD(0,∞) but does not satisfy RCD(0,∞) unless k·k is induced by an inner
product. It is possible to consider in this setting a non-linear heat equation,
driven by a non-linear Laplace operator, see [26] for the a study in the much
more general setting of Finsler manifolds. However, for a non-Hilbert norm
there is no canonical choice of a heat kernel, i.e. a solution starting from a
Dirac mass since contraction of the heat ﬂow fails [27]. Note however, that
a particular solution is given by the appealing formula [27, Example 4.3]

ft(x) =

C
4πt

exp(cid:18)−kxk2
4t (cid:19) ,

where C is a normalization constant. Hence a choice satisfying Assumption
2.1 is ιt(x) = ft(·−x) Leb. Any other reasonable choice should be translation
invariant. Let us show that in this case the distance dt coincides with the
original one, i.e. dt(x, y) = kx − yk. Indeed, consider ιt : x 7→ (τx)#νt where
νt ∈ P2(Rd,k·k) is a measure and τx the translation by x.
It is easily
checked using Jensen’s inequality on the convex function (u, v) 7→ ku − vk2
that W(Rn,k·k)(cid:0)ιt(x), ιt(y)(cid:1) = kx − yk. The translation τy−x is an optimal
map, in other words (τx, τy)#νt is an optimal coupling. Since the original
distance was already a length distance we ﬁnd dt(x, y) = edt(x, y) = kx − yk.

Hence the ﬂow leaves the space invariant and does not regularize it to a
Riemannian manifold.

9

Remark 2.7. We stress that the approximation of some normed spaces by
Riemannian manifolds is possible by using periodic Riemannian metrics
with a period diameter going to zero. Consider for instance the sequence
(Rn, k−1dg)k≥1 where dg is a ﬁxed periodic Riemannian distance. It con-
verges to Rn equipped with its “stable norm” as deﬁned for instance in [9,
section 8.5.2]. It is not clear whether any norm may be attained in this way
and this question is related to the notorious open problem of characterizing
the stable norms [10]. Finally, note that it is impossible to approximate a
non-Hilbertian normed space in Gromov Hausdorﬀ topology by Riemannian
manifolds with non-negative Ricci curvature. This is because any such limit
metric measure space that contains a line has to split as a product of R
and another metric measure space by the splitting theorem for Ricci limit
spaces established by Cheeger and Colding [12], see also [32, Conclusions
and open problems]. This argument also applies to the Heisenberg group.
Moreover it is proven in [19] that (H, dcc) also cannot be approximated by
a sequence of Riemannian manifolds with any uniform lower bound on the
Ricci curvature.

3. Gigli–Mantegazza flow starting from a cone

In this section we will analyse the construction in the case where the initial
datum is an Euclidean cone. More precisely, we will consider the cones of
angle π and π/2. We will show that for all times t the resulting metric
dt retains a warped product form in both cases.
In the ﬁrst case, it has
a conic singularity of angle √2π at the apex for all t. In the second case,
the asymptotic angle at the apex is zero for all t. Thus in these natural
examples, the ﬂow does not smoothen out the singularity.
In Sections 3.1 to 3.3 we will present the case of the cone of angle π in detail.
For the cone of angle π/2 we will state the main results in Section 3.4 and
omit part of the proofs, since the arguments are very similar.

3.1. Preliminaries. We will ﬁrst recall basic properties of Euclidean cones
and give an explicit representation of the heat kernel on the cone of angle π
in the sense of RCD spaces. Moreover, we will exhibit a convenient way to
calculate Wasserstein distances in the cone, via a lifting procedure from the
cone to R2.

3.1.1. Euclidean cones and optimal transport. The Euclidean cone C(θ) with
angle θ ∈ [0, 2π] is deﬁned as the quotient

C(θ) = (cid:16)[0,∞) × [0, θ](cid:17). ∼ ,

where we write (r, α) ∼ (s, β) if and only if r = s = 0 or |α − β| ∈ {0, θ}.
The cone distance d is given by

d(cid:0)r, α), (s, β)(cid:1) = qr2 + s2 − 2rs cos(cid:0) min(cid:0)|α − β|, θ − |α − β|(cid:1)(cid:1) ,

which is well deﬁned on the quotient. Note that the cone without the apex,
i.e C(θ)\{o}, where o is the equivalence class of (0, 0), is an open Riemannian
manifold with the metric tensor (dr)2 + r2(dα)2.
Its geometry is locally
Euclidean. The associated Riemannian distance is the cone distance and
the distance on the full cone C(θ) is its metric completion.

10

MATTHIAS ERBAR AND NICOLAS JUILLET

We will be concerned in particular with the cone of angle π. In this case we
have the alternative characterization as the quotient

C(π) = R2(cid:14)σ ,

where the map σ : R2 → R2 is the reﬂection at the origin, i.e. σ(x) = −x.
Let us denote by P : R2 → C(π) the canonical projection. Then the cone
distance between p, q ∈ C(π) can be written as

d(p, q) = min(cid:0)|x − y|,|x + y|(cid:1) ,

where x, y ∈ R2 are such that P (x) = p, P (y) = q. The Hausdorﬀ measure
on C(π) is given as m = 1
2 P# Leb, where Leb denotes the Lebesgue measure
on R2.
Now, we show how to calculate eﬃciently Wasserstein distance in the cone
C(π). We will denote by WR2 and WC(π) the L2 transport distances on
R2 and C(π) built from the Euclidean distance and the cone distance d
respectively. If no confusion can arise we shall simply write W .
Let us introduce the set of measures on R2 with ﬁnite second moment, that
are symmetric with respect to the origin. We set

P sym

2

(R2) = {µ ∈ P2(R2) : σ#µ = µ} .

Note that given a measure ν ∈ P2(C(π)) there exists a unique measure
L(ν) ∈ P sym
(R2) such that P#L(ν) = ν. We call L(ν) the symmetric lift
of ν.
We have the following useful fact.

2

Lemma 3.1. For any two measures µ, ν ∈ P2(C(π)) it holds

WC(π)(µ, ν) = WR2(L(µ), L(ν)) .

In other words, the mapping P sym
etry. Moreover, for any two measures µ, ν ∈ P2(R2) we have

(R2) → P2(C(π)), µ 7→ P#µ is an isom-

2

WC(π)(P#µ, P#ν) ≤ WR2(µ, ν) .

Proof. Let us ﬁrst prove the second statement. Let µ, ν ∈ P(R2) and π a
transport plan between µ and ν. Deﬁne a transport plan ¯π between P#µ
and P#ν by setting ¯π = (P ⊗ P )#π. Therefore,

Z |y − x|2 dπ(x, y) ≥Z d(P (y), P (x))2 dπ(x, y) =Z d2 d¯π .

(3.1)

2

Taking the inﬁmum over π, we get the second statement. We turn now to the
ﬁrst statement. Let µ, ν ∈ P sym
(R2) and let ¯π be a transport plan between
P#µ and P#ν. We can ﬁnd a measurable map Q : C(π) × C(π) → R2 × R2
such that (P ⊗ P ) ◦ Q = Id and |x − y| = d(p, q) for Q(p, q) = (x, y). These
properties also hold for −Q that we note Q−. The marginals of the transport
2 (Q# ¯π + Q−# ¯π) are symmetric, hence they coincide with µ and ν.
plan π = 1
Moreover π is concentrated on the set {(x, y) ∈ R2 × R2, d(P (x), P (y)) =
|y − x|} so that we have equality in (3.1). Taking the inﬁmum over ¯π and
taking into account the second statement, we obtain the ﬁrst statement. (cid:3)

11

3.1.2. RCD structure and the heat kernel. Here we verify that the cone C(π)
ﬁts into the framework of RCD spaces considered in [17] and we give an
explicit description of the heat kernel in this case.
Indeed, the metric measure space (C(π), d, m) satisﬁes the condition RCD(0,∞)
as proven for instance in [21, Thm. 1.1]. In order to identify the heat semi-
group Ht acting on measures and the heat kernel Htδx in this example, it
is suﬃcient to exhibit an explicit solution to the Evolution Variational In-
equality using [4, Thm. 5.1], see Section 2.3. This will be done again via
the lifting to R2.
We denote by γt

x the Gaussian measure with variance 2t centered at x ∈ R2:

γt
x(dy) =

1
4πt

exp(cid:18)−|y − x|2

4t (cid:19) dy .
t µ(dx) =R γt

The heat semigroup in R2 acting on measures is denoted by H R2
precisely, for any µ ∈ P2(R2) we set H R2
Now, put νt
H C(π)

t
y(dx) dµ(y).

x) where x is such that P (x) = p. We deﬁne a semigroup

acting on P(C(π)) via

p = P#(γt

. More

t

H C(π)

t

µ(dq) =Z νt
= P# ◦ H R2

t ◦ L.

p(dq) dµ(p) .

Note that we have H C(π)

t

Lemma 3.2 (Evolution Variational Inequality). For every µ, χ ∈ P2(C(π))
such that Ent(χ) < ∞ and every t ≥ 0 we have

t

1
2

W 2

W 2

C(π)(H C(π)

1
µ, χ) −
2
Proof. Let L(µ), L(χ) ∈ P σ
the symmetric lift of H C(π)
Inequality, see e.g. [2, Thm. 11.2.5], we ﬁnd

t

t

C(π)(µ, χ) ≤ t(cid:2) Ent(χ) − Ent(H C(π)

t

µ)(cid:3) .

2 (R2) be the lifts of µ, χ. Note that H R2
µ. Since H R2

t L(µ) is
satisﬁes the Evolution Variational

1
2

W 2

R2(H R2

t L(µ), L(χ)) −

1
2

W 2

R2(L(µ), L(χ))

≤ t(cid:2) Ent(L(χ)) − Ent(H R2

t L(µ))(cid:3) .

Observing that Ent(L(µ)) = Ent(µ) for any µ ∈ P2(C(π)) and its symmet-
ric lift L(µ) and using Lemma 3.1, this immediately yields the claim.

(cid:3)

t

In view of [4, Thm. 5.1], this shows again that (C(π), d, m) satisﬁes RCD(0,∞)
and that H C(π)
p =
H C(π)
We ﬁnish this section by noting the following contraction property of the
heat ﬂow:

δp is the heat kernel at time t centered at p.

is the associated heat semigroup.

In particular, νt

t

WC(π)(νt

p, νt

q) ≤ d(p, q),

∀p, q ∈ C(π), t ≥ 0 .

(3.2)

12

MATTHIAS ERBAR AND NICOLAS JUILLET

Indeed, choosing x, y with P (x) = p, P (y) = q and d(p, q) = |x − y|, by
Lemma 3.1 and convexity of the squared Wasserstein distance we have

WC(π)(νt

p, νt

q) = WR2(cid:18) 1
2
≤ WR2(γt
x, γt

(γt

x + γt

−x),

1
2

(γt

y + γt

y) = |x − y| = d(p, q) .

−y)(cid:19)

3.1.3. Absolutely continuous curves and the continuity equation. We recall
the characterization of absolutely continuous curves in the Wasserstein space
of the Euclidean spaces via solutions to the continuity equation. Moreover,
we formulate a convenient estimate on the driving vector ﬁeld in the conti-
nuity equation.

Proposition 3.3 ([2, Thm. 8.3.1]). A weakly continuous curve (µs)s∈[0,T ]
in P2(Rn) is 2-absolutely continuous with respect to W if and only if there
L2(µs;Rn) ds < ∞ such

exists a Borel family of vector ﬁelds Vs with R T

that the continuity equation

0 kVsk2

∂sµ + div(µsVs) = 0

holds in distribution sense. In this case we have | ˙µs| ≤ kVskL2(µs;Rn) for
a.e. s. Moreover, Vs is uniquely determined for a.e. s if we require

Vs ∈ Tµs

P2(Rn) := {∇ψ | ψ ∈ C∞c (Rn)}

L2(µs;Rn)

and it holds | ˙µs| = kVskL2(µs;Rn).
The next lemma states a simple condition for existence and uniqueness of
solutions to the continuity equation.
Lemma 3.4. Let µ ∈ P2(Rn) with strictly positive Lebesgue density ρ and
assume that µ satisﬁes the Poincar´e inequality

Z |f|2 dµ ≤ CZ |∇f|2 dµ ,

for all f ∈ C∞c (Rn) with R f dµ = 0. Let s ∈ L1(Rn, Leb) be such that
R s = 0 and
Then there exists a unique vector ﬁeld V ∈ TµP2(Rn) such that the equation

L2 = Z s2(x)

ks/√ρk2

dx < ∞ .

ρ(x)

s + div(µV ) = 0

holds in distribution sense. Moreover, we have

L2(µ;Rn) = Z |V |2 dµ ≤ Cks/√ρk2
kV k2

L2 .

(3.3)

Proof. For any f ∈ C∞c (Rn) withR f dµ = 0 we deduce from the Cauchy–
Schwarz and Poincar´e inequalities that the bilinear B : f 7→R sf satisﬁes

2

ρ(cid:19) 1
2(cid:18)Z f 2ρ(cid:19) 1
B(f ) ≤ (cid:18)Z s2

2

≤ ks/√ρkL2√C(cid:18)Z |∇f|2 dµ(cid:19) 1

.

13

Thus, identifying f with its gradient, the map B can be extended to a
bounded linear functional on the Hilbert space Tµ := TµP2(Rn) equipped
with the scalar product

hU, WiL2(µ;Rn) =Z U · W dµ .

Moreover, the norm of B is bounded by √Cks/√ρkL2. Thus, by the Riesz
representation theorem there exists a unique vector ﬁeld V ∈ Tµ such that
B(W ) = hV, WiL2(µ;Rn) and kV kL2(µ;Rn) ≤ √Cks/√ρkL2. In particular, for
any f as above we have

Z sf = B(f ) = Z V · ∇f dµ .

Thus V is the unique distributional solution to s + div(µV ) = 0 in Tµ. (cid:3)

3.2. Warped structure of the convoluted cone. Having identiﬁed the
heat kernel in Lemma 3.2, we can now analyse in detail the construction of
[17] in the case of C(π). Let us deﬁne ιt : C(π) → P2(C(π)) via ιt(p) = νt
p.
This map is obviously injective and by (3.2) satisﬁes Assumption 2.1. Thus,
as outlined in Section 2 we introduce

edt(p, q) = WC(π)(νt

p, νt
q)

and deﬁne dt to be the associated length distance as in (2.2). Recall that the
use of the the heat equation is supposed to produce a kind of convolution
for metric spaces. The rotational symmetry of C(π) is preserved by this
transformation so that the resulting space will retain a warped structure.
We ﬁrst give a partial converse to the Lipschitz estimate (2.1).
Lemma 3.5. For any t ≥ 0 and r > 0 there exists a constant C(t, r) such
that for all p, q ∈ C(π) \ Br:

(3.4)

where Br = {p ∈ C(π) : d(o, p) ≤ r}.

C(t, r)d(p, q) ≤ edt(p, q) ,

In particular, in view of Proposition 2.4 this shows that edt and dt induce
the same topology as the cone distance on C(π).
Proof. Let x, y ∈ R2 such that d(p, q) = |x − y|. Without restriction we can
assume that |x| ≤ |y| and that x = (x1, 0), y = (y1, y2) with y1, y2 ≥ 0.
Let A be the line passing through the origin at angle 3π/8 with the ﬁrst
coordinate axis and let prA denote the orthogonal projection onto L. Then,
setting µt

x = 1

2 (γt

x + γt

−x), we have
x, µt

edt(p, q) = WR2(µt

y) ≥ WR1((prA)#µt

x, (prA)#µt
y)

Note that (prA)#µt
x is the mixture of two one-dimensional Gaussians with
variance 2t and centers ± prA x. Note further that | prA(x) − prA(y)| ≥
cos(3π/8)|x − y| since the angle of A with y − x is less than 3π/8. Thus
it suﬃces to establish the following claim: For any t0 ≥ 0 and r > 0 there
exists a constant C(t0, r) such that for all t ≤ t0 and x, y ≥ r:

C(t0, r)|x − y| ≤ WR(cid:0) 1

2

(γt

x + γt

−x),

1
2

(γt

y + γt

−y)(cid:1) ,

(3.5)

14

MATTHIAS ERBAR AND NICOLAS JUILLET

x + γ1

x, ω#γ1

where by abuse of notation γt
x denotes also the one-dimensional Gaussian
measure with variance 2t and center x. By convexity of W 2
R the right hand
side is decreasing in t. Thus, by scaling it suﬃces to consider t = 1.
In
dimension 1, the optimal transport plan is known to be the monotonic re-
arrangement. The two measures in (3.5) are symmetric so that the mass on
−x restricted to R+ is
R+ is mapped on R+. Observe that the measure γ1
distributed as ω#γ1
x where ω : x 7→ |x|. Hence the right hand side of (3.5) is
WR(ω#γ1
y ). Applying Jensen’s inequality in the deﬁnition of WR we
see that the distance between the means of these measures is a lower bound.
But the mean of ω#γ1
0(s). As a function of
x ∈ R+, this is a strictly convex function with derivative zero at zero on the
right and tangent to the ﬁrst bisector at +∞. In fact the second derivative
in distribution sense is 2γ1
0 . The estimate (3.5) follows from these remarks
together, provided x, y ≥ r for some r > 0.
(cid:3)
Next, we show that in the deﬁnition of dt we can restrict the inﬁmum to
Lipschitz curves with respect to the cone distance d.
Lemma 3.6. For any t ≥ 0 and p, q ∈ C(π) we have

x(s) =R |s − x| dγ1

x is R |s| dγ1

dt(p, q) = inf(cid:26)Z T

0

| ˙ps|t ds(cid:27) ,

(3.6)

where the inﬁmum is taken over all d-Lipschitz curves (ps)s∈[0,T ] such that

p0 = p, pT = q and | ˙ps|t denotes the metric derivative with respect to edt. If

p 6= o and q 6= o, one can restrict to the curves supported in C(π) \ {o}.
Thus the construction of dt given here is consistent with the general con-
struction in RCD spaces given in [17] (see Remark 2.2).
Proof. The inequality “≤” follows immediately from the fact that any d-

Lipschitz curves. Then the statement follows from Lemma 3.5.

Lipschitz curve is also edt-Lipschitz by (3.2). To see the reverse inequality,
ﬁrst recall that by Remark 2.3 we can restrict the inﬁmum in (2.2) to edt-
given ε > 0, let (ps)s∈[0,T ] be a edt-Lipschitz curve such that

Indeed,

| ˙ps|t ds ≤ dt(p, q) + ε .

Z T

0

Recall that (ps) is d-continuous.
If it avoids the origin (and thus also a
neighborhood around it) then (ps) is also d-Lipschitz by (3.4). If the curve
hits the origin, put for suﬃciently small r > 0:

s1 := inf{s ∈ [0, T ] : ps ∈ Br} ,

s2 := sup{s ∈ [0, T ] : ps ∈ Br} .

We can construct a d-Lipschitz curve (eps) by replacing the part (ps)s∈[s1,s2]
with a piece of circle connecting ps1 to ps2. From (3.2) we see that the edt-
length of (eps) is bounded by dt(p, q) + ε + πr. Choosing r suﬃciently small

and using the arbitrariness of ε we obtain the inequality “≥” in (3.6).
In the case p = o or q = o, the ray from or to the apex is a minimizing
curve. Note that it is a d-Lipschitz curve.
(cid:3)

Let us further observe the particular behavior of the distance under scaling
of space and time.

Lemma 3.7. For any t > 0 and p, q ∈ C(π) we have

dt(p, q) = √t · d1(cid:0)√t−1

p,√t−1

q(cid:1) .

Here, for λ ≥ 0 and p = (r, α) ∈ C(π) we set λp = (λr, α).

15

(3.7)

Proof. It suﬃces to establish the identity (3.7) with dt replaced by edt. It
then passes easily to the associated length distance. Recall that edt(p, q) =
W2,R2( 1
duce the dilation sλ : x 7→ λx and note that γt
claim is immediate.

−y) for x, y such that P (x) = p, P (y) = q. Intro-
. Now the

x = (s√t)#γ1√t

−x), 1

x + γt

y + γt

2 (γt

2 (γt

(cid:3)

−1

x

We have the following result on the metric structure of the convoluted cone.

Proposition 3.8. The distance dt is induced by a metric tensor gt on the
open manifold C(π) \ {o} which is of warped product form
(r,α)(·,·) = R(r/√t)dr2 + r2A(r/√t)dα2 ,

(3.8)
where R, A : (0,∞) → (0, 1] are bounded functions. Moreover, the distance
dt on the full cone is obtained for p0, p1 ∈ C(π) by

gt

dt(cid:0)p0, p1(cid:1) = infZ 1

0 qR(rs/√t)| ˙rs|2 + r2

s A(rs/√t)| ˙αs|2 ds ,

(3.9)

where the inﬁmum is taken over all Lipschitz curves (ps)s∈[0,1] of (C(π), d)
connecting p0, p1 and | ˙rs|,| ˙αs| denote the metric derivatives of the polar
coordinates of ps.

In (3.8) R and A stand for radial and angular.

Proof. Recall from Section 2 that

dt(p, q) = inf

(ps)Z T

0

| ˙νt
ps| ds ,

p = ιt(p) and | ˙νt

where νt
ps| denotes the metric derivative with respect to
WC(π). We will ﬁrst use the lifting to R2 and the characterization of the
Wasserstein metric derivative in terms of solutions to the continuity equation
to relate dt to a smooth metric tensor on R2 and then we will push this tensor
to the cone to obtain the desired warped structure.
From Lemma 3.7 we immediately infer that it is suﬃcient to consider t = 1.
For brevity let us set µx = 1
2 γ−x and let fx be its density, i.e. fx(y) =
2 η(y − x) + 1
1
4π exp(−|y|2/4) is the density of the
2-dimensional Gaussian at time 1.

2 η(y + x), where η(y) = 1

2 γx + 1

where V w

We deﬁne a metric tensoreg on R2 by setting for x, w ∈ R2:
dh(cid:12)(cid:12)h=0fx+hw =

egx(v, w) = Z hV v
w ·(cid:0)∇η(x + y) − ∇η(x − y)(cid:1) = − div(µxV w

x i dµx ,
P(R2) solving

x is the unique vector ﬁeld in Tµx

given by Lemma 3.4 (applied to s = d
uniqueness, V w

dh fx+hw and µ = µx).

x , V w

1
2

d

x depends linearly on w, hence gx(v, w) is a bilinear form.

x ) (3.10)

Indeed, by

16

MATTHIAS ERBAR AND NICOLAS JUILLET

Now, deﬁne a metric tensor g on the open manifold C(π) \ {o} by setting
for p = (r, α) ∈ C(π) \ {o} and v, θ ∈ R:

where

gp(cid:0)(v, θ), (v, θ)(cid:1) =egx(w, w) ,
sin α(cid:19) , w = v(cid:18)cos α

sin α(cid:19) + θr(cid:18)− sin α
cos α (cid:19) ,

x = r(cid:18)cos α

and extend via polarization. That g takes the form (3.8) is a consequence

itly, we have

of the fact that egx(w, w) is invariant under reﬂecting w at the line passing
through the origin and x, implying that gp(cid:0)(v, θ), (v, θ)(cid:1) = gp(cid:0)(v,−θ), (v,−θ)(cid:1),
and the invariance ofegx(w, w) under simultaneous rotation of x, w. Explic-
R(r) =egr(1,0)(cid:0)(1, 0), (1, 0)(cid:1) ,

Let us now prove (3.9), i.e. that d1 is induced by the tensor g. By Lemma
3.6 we have

A(r) =egr(1,0)(cid:0)(0, 1), (0, 1)(cid:1) .

(3.11)

d1(p0, p1) = infZ 1

0 | ˙ps|1 ds ,

where | ˙ps|1 is the metric derivative of ps with respect to the distance ed1 and

the inﬁmum is over Lipschitz curves in (C(π), d). Let us consider a Lipschitz
curve (ps)s∈[0,1] in (C(π), d) with polar coordinates (rs)s and (αs)s. Let
(xs)s∈[0,1] be a continuous a curve such that P (xs) = ps. By (3.2) the curves
ν1
ps and µxs are Lipschitz with respect to WC(π) and WR2 respectively and

by deﬁnition of ed1 and Lemma 3.1 we have

| ˙ps|1 = | ˙ν1

ps| = | ˙µxs| ,

where the latter two metric derivatives are calculated with respect to WC(π)
and WR2 respectively. By the characterization of absolutely continuous
P(R2) such that the
curves, there exists for a.e. s a vector ﬁeld Vs ∈ Tµxs
continuity equation ∂sµxs = − div(µxsVs) holds in distribution sense. But
for a.e. s the left hand side is given by 1

2 ws ·(cid:0)∇η(· + xs) − ∇η(· − xs)(cid:1) with

ws = ˙rs(cid:18)cos αs

sin αs(cid:19) + ˙αsrs(cid:18)− sin αs
cos αs (cid:19) .

Hence, the uniqueness statement in Lemma 3.4 implies that for a.e. s we
have Vs = V ws

xs and thus

| ˙ps|2

1 =egxs(ws, ws) = gps(cid:0)( ˙rs, ˙αs), ( ˙rs, ˙αs)(cid:1) = | ˙rs|2R(rs) + r2

This yields that dt(p0, p1) is given by the right hand side in (3.9).
Finally, we turn to the boundedness of R and A.
In fact for w a vector
of R2 the vector ﬁeld V : y 7→ λx(y)w + (1 − λx(y))(−w) where λx(y) =
[η(y − x)/(η(y − x) + η(y + x))] satisﬁes (3.10) in place of V w
x . It is an ele-
ment of L2(µx; Rn) with norm smaller than or equal to |w|. The orthogonal
P(R2) contracts the norm and provides another solution
projection on Tµx
to (3.10). According to the uniqueness statement in Lemma 3.4 it is V w
x .

s| ˙αs|2A(rs) .

R deﬁned in (3.11) are bounded from above by 1.

Hence we have provedegx(w, w) ≤ |w|2. It follows that the functions A and

(cid:3)

17

Remark 3.9. We believe that the functions R and A in the proposition
above are smooth, so that dt would be induced by a smooth metric tensor
on C(π) \ {o}. From the explicit expression (3.16) for R given below in the
proof of Theorem 3.11, it is readily checked R is smooth. Proving smoothness
for A seems non-trivial due to the non-compactness of the cone.

Proposition 3.10. As t goes to zero, the metric space (C(π), dt) tends to
(C(π), d) pointwise and in the pointed Gromov–Hausdorﬀ topology.

Proof. By construction of dt and by the contractivity (3.2) with (2.3) we
have the chain of inequalities

From Proposition 2.4 we already know that edt pointwise converges to d as

t → 0 whence the convergence of dt follows. The convergence in pointed
Gromov–Hausdorﬀ topology follows as in the proof of Proposition 2.4. (cid:3)

edt ≤ dt ≤ d .

As an immediate consequence of Proposition 3.8, we deduce that a dt-
minimizing curve connecting the apex o = (0, 0) to the point (r, 0) ∈ C(π)
is given by the curve (sr, 0)s∈[0,1]. Hence the distance of (r, 0) from the apex
o is

dt(cid:0)(r, 0), o(cid:1) =Z 1

0

rqR(cid:0)sr/√t(cid:1) ds =Z r

0 rR(cid:16)s/√t(cid:17) ds .

(3.12)

3.3. Persistence of the conic singularity for C(π). We will show that
the new distance dt has a conic singularity at the origin of angle √2π inde-
pendent of t. In order to do so we will compare for small r the distance of a
point pr = (r, 0) from the origin to the length of a circle around the origin
passing through pr.

More precisely, for r > 0 set ρt(r) = dt(cid:0)(0, r), o(cid:1) and deﬁne
s|t ds .
where the curve pr : [0, π] → C(π) is given by pr
Theorem 3.11. For each t > 0 we have

lt(r) =Z π
0 | ˙pr

s = (r, s).

lt(r)
ρt(r)

lim
r→0

= √2π .

In other words, the angle at the apex o is √2π. In particular, a singularity
persists at o. With the notation of Proposition 3.8 we have more precisely
R(r) ∼ r2/2 and A(r) ∼ r2/4 as r → 0.
Moreover, C(√2π) is both, the tangent space of (C(π), dt) at o, and the limit
in the pointed Gromov–Hausdorﬀ topology as t goes to inﬁnity.

Remark 3.12. The discontinuity at t = 0 of the asymptotic angle at o might
seem intriguing at ﬁrst in view of the convergence of dt to the original
distance d given by Proposition 3.10. Note however, that the asymptotic
angle is in a certain sense a ﬁrst order quantity, while the convergence of
distances is zero order.
Intuitively, the discontinuity can be understood
from the scaling property (3.7). After zooming in at scale r, the heat kernel

18

MATTHIAS ERBAR AND NICOLAS JUILLET

measure at a very small time t looks like the heat kernel measure at the
larger time t/√r at the original scale.

Proof. We will calculate ρt and lt asymptotically as r → 0.
From Proposition 3.8 and (3.12) we have

rqR(cid:0)sr/√t(cid:1) ds

ρt(r) =Z 1
lt(r) = πrqA(cid:0)r/√t(cid:1) .

0

(3.13)

(3.14)

Thus, it remains to calculate R and A. Denote by fx the density of µ1
1
x + 1
2 γ1
2 γ1
3.8 that

x =
−x. We set xr = (r, 0) ∈ R2 and recall from the proof of Proposition

||2
||2

xr

R(r) = ||V (1,0)
A(r) = ||V (0,1)
x ∈ Tµ1

xr

x

L2(µ1

L2(µ1

xr ;R2) ,
xr ;R2) ,

where the vector ﬁeld V w
equation

P(R2) is deﬁned uniquely by the continuity

Note that

d

dh(cid:12)(cid:12)h=0fx+hw = − div(fxV w

x ) .

(3.15)

where η denotes y 7→ (4πt)−1/2 exp(−y2/4t), the 1-dimensional Gaussian
density at time 1. Let us ﬁrst concentrate on R. Here, we have to solve

fx(y) = 1/2(cid:0)η(y1 − x1)η(x2 − y2) + η(x1 + y1)η(x2 + y2)(cid:1) ,
dh(cid:12)(cid:12)h=0fxr+h(1,0)(y) = η(y2)

2(cid:0) − η′(y1 − r) + η′(y1 + r)(cid:1)

d

1

It is easily checked that the solution is given by

= −div(cid:16)fxr V (1,0)
xr (cid:17) (y) .
0(cid:19)η(y1 − r) − η(y1 + r)

η(y1 − r) + η(y1 + r)

.

V (1,0)
xr

(y) =(cid:18)1

which indeed belongs to Tµ1
xr

P(R2). Thus, we have

R(r) =Z |V (1,0)

xr

|2 dµ1

xr =

1

2Z Z η(y2)|η(y1 − r) − η(y1 + r)|2

η(y1 − r) + η(y1 + r)

=

1

η(y1 − r) + η(y1 + r)

2Z |η(y1 − r) − η(y1 + r)|2
r2Z |2η′(y1)|2

2η(y1)

To determine the asymptotic behavior as r → 0, we ﬁrst note that
r2
η(y1) dy1 + o(r2) =
2

dx + o(r2) = r2Z y2

R(r) =

1
4

1
2

dy1 .

dy1 dy2

(3.16)

+ o(r2) .

(3.17)

Let us turn to calculating A. First we note that the left hand side βr of the
continuity equation (3.15) is

19

βr =

d

dh(cid:12)(cid:12)h=0fxr+h(0,1)(y) = η′(y2)

1

2(cid:2) − η(y1 − r) + η(y1 + r)(cid:3)

= rη′(y1)η′(y2) + o(r) .

xrP(R2) but
Unfortunately, we can not explicitly solve equation (3.15) in Tµ1
we can approximate the solution. To this end introduce the function ψr :
R2 → R given by
We calculate δr(y) where δr : y 7→ − div(cid:0)fxr∇ψr(cid:1)(y).

ψr(y) = r

y1y2 .

1
4

1

r

δr(y) = −

r

1

+ η′(y2)y1

4hy2η(y2)
2(cid:0)η′(y1 + r) + η′(y1 − r)(cid:1)
2(cid:0)η(y1 + r) + η(y1 − r)(cid:1)i
4h(1 + 1)η′(y2)(cid:0)η′(y1 + r) + η′(y1 − r)(cid:1)
2(cid:0)η(y1 + r) − η(y1 − r)(cid:1)i
η′(y2)(cid:0)η′(y1 + r) + η′(y1 − r)(cid:1)
η′(y2)(cid:0)η(y1 + r) − η(y1 − r)(cid:1) ,

+ rη′(y2)

r2
8

r
2

+

1

=

=

where in the ﬁrst line we used several times the identity η′(t) = −(t/2)η(t).
Considering an expansion in r at r = 0 we check that as r → 0 we have

1

r2Z |βr − δr|2

fxr → 0 .

Since the measures µ1
pendent of r, we deduce by Lemma 3.4 (applied to ∇ψr − V (0,1)

xr satisfy the Poincar´e inequality with constant inde-
xr )

and µ1

xr

that

1
rk∇ψr − V (0,1)

xr

kL2(µ1

xr ;R2) → 0 .

It thus suﬃces to calculate

xr ;R2)

r

=

||∇ψr||L2(µ1
4(cid:18)Z (y2
ThuspA(r) = r

r
2

=

+ o(r2) .

1 + y2

2)η(y2)

1

2(cid:0)η(y1 + r) + η(y1 − r)(cid:1) dy1 dy2(cid:19) 1

2

2 + o(r). This together with (3.13), (3.14) yields

ρt(r) =

1
2√2t
1
2√t
This gives the claim on the limit ratio.

lt(r) = π

r2 + o(r2) ,

r2 + o(r2) .

20

MATTHIAS ERBAR AND NICOLAS JUILLET

For the last part of the statement let us consider the reparametrization
T : (r, θ) ∈ C(π) 7→ (ρ(r), θ) ∈ C(π) where ρ stands for ρt at time 1. We
note (¯r, ¯θ) the new coordinates. The function ρ is continuously diﬀerentiable
of positive derivative so that T is a diﬀeomorphism outside the apex. A curve
(γs)s∈[0,T ] with support on C(π) \ {o} is Lipschitz if and only if (T ◦ γs)s
is Lipschitz too. Moreover, a change of variable shows how to compute the
length on the second curve with the tensor deﬁned by

¯R = 1

and

¯A(¯r)¯r2 = A(ρ−1(¯r)) × ρ−1(¯r)2

in place of R and A. We proved in Lemma 3.5 that in the minimisation
problem (3.9) it is possible to use Lipschitz curves outside the apex, or
Lipschitz rays from or to the apex. Both classes of curves are preserved by T
and T −1. Finally similarly as in Lemma 3.5 the inﬁmum of the length in the
new coordinates remains the same if it is allowed to test the Lipschitz curves
going through o. Using the equivalents of A and ρ we obtain ¯A1/2 ∼¯r→0 √2.
Note that the equation ¯A = c would corresponds to the metric of C(cπ).
With the new coordinates we easily recognize that the tangent space at zero
is C(√2π). Together with the time-space scaling of Lemma 3.7 we obtain
the same limit space when t goes to inﬁnity.

(cid:3)

Remark 3.13. The intuition for ﬁnding a good candidate ∇ϕ for the solution
to

βr = − div(fxr∇ϕ)

is as follows. Since we are interested only in the limit r → 0 we expand the
continuity equation in r. Note that fxr (y1, y2) = η(y1)η(y2) + O(r2). We
expand ∇ϕ = ∇ϕ(0) + r∇ϕ(1) + o(r). Since βr = rη′(y1)η′(y2) + o(r) we
conclude that ∇ϕ0 = 0 and that we must have

η′(y1)η′(y2) = − div(η ⊗ η∇ϕ(1))(y1, y2)

= −η′(y1)η(y2)∂y1ϕ(1) − η(y1)η′(y2)∂y2 ϕ(1)
− η(y1)η(y2)∆ϕ(1)(y1, y2)

or equivalently, since η′(u) = −(u/2)η(u),

y1y2/4 − (y1/2)∂y1 ϕ(1)(y) − (y2/2)∂y2 ϕ(1)(y) + ∆ϕ(1)(y) = 0 .

A solution to this is given by ϕ(1)(y) = 1

4 y1y2.

Remark 3.14. Unsurprisingly, the asymptotic angle of(cid:0)C(π), dt(cid:1) at inﬁnity

remains π independently of t. More precisely, for any t ≥ 0:

lt(r)
ρt(r)

lim
r→∞

= π .

(3.18)

Indeed, in view of (3.13), (3.14) we ﬁnd after a change of variables in the
integral that

lt(r)
ρt(r)

=

πqA(r/√t) × (r/√t)
R r/√t
0 pR(s) ds

.

C(π/2) = C(cid:14)σ ,

where the map σ : C → C is the direct rotation by π/2, i.e. σ(z) = iz.
Let us denote by P : C → C(π/2) the canonical projection. Then the cone
distance between p, q ∈ C(π/2) can be written as

d(p, q) = minn|z − eikπ/2z′| : k = 0, 1, 2, 3o ,

Thus we have

lt(r)
ρt(r)

lim
r→∞

= lim
t→0

lt(r)
ρt(r)

= π .

21

representation of the length of type (2.4) together with edt ≤ dt ≤ d for

In the last equality we used Proposition 3.10 for ρt(r) → r and also a
lr(t) → πr.
3.4. The cone of angle π/2. Like C(π), the cone C(π/2) admits an alter-
native characterization as a quotient of R2, however, it will be convenient
to phrase this in terms of complex numbers. We have

where z, z′ ∈ C are such that P (z) = p, P (z′) = q. The Hausdorﬀ measure on
C(π/2) is given as m = 1
4 P# Leb, where Leb denotes the Lebesgue measure
on C.
As in section 3.1 we can calculate Wasserstein distances in the cone via
lifting. Given ν ∈ P2(C(π/2)) we denote by L(ν) the symmetric lift of ν,
i.e. the unique measure in

P sym

2

(C) := {µ ∈ P2(C) : σ#µ = µ} .

such that P#L(ν) = ν. Then, in analogy to Lemma 3.1, for any two measures
µ, ν ∈ P2(C(π/2)) we obtain

WC(π/2)(µ, ν) = WC(L(µ), L(ν)) .

z denotes the two-dimensional Gaussian measure with variance
z), where p = P (z). By the obvious
p is the heat kernel measure on C(π/2) in the sense

p = P#(γt

Recall that γt
2t centered at z ∈ C. We set νt
analogue of Lemma 3.2, νt
of RCD spaces. Note that its lift is given by
4hγt

iz + γt

z + γt

L(νt

p) =

1

Let dt be the length distance associated to edt(p, q) = WC(π/2)(νt

It
is found again to satisfy the scaling relation (3.7). Arguing exactly as in
Proposition 3.8 and Proposition 3.10 we obtain

p, νt

q).

−z + γt

−izi .

Proposition 3.15. The distance dt is induced by a metric tensor gt on the
open manifold C(π/2) \ {o} which is of warped product form
(r,α)(·,·) = R(r/√t)dr2 + r2A(r/√t)dα2 ,

(3.19)

gt

where R, A : (0,∞) → (0, 1] are bounded functions.
Of course, the precise form of the functions R and A is diﬀerent for C(π/2)
and C(π).

Proposition 3.16. As t goes to zero, the metric space (C(π/2), dt) tends
to (C(π/2), d) pointwise and in the pointed Gromov–Hausdorﬀ topology.

22

MATTHIAS ERBAR AND NICOLAS JUILLET

In order to calculate the angle at the apex, for r > 0 let us set again

ρt(r) = dt(cid:0)o, (0, r)(cid:1), where o denotes the apex, as well as

lt(r) =Z π/2

0

| ˙pr
s|t ds .

where the curve pr : [0, π/2] → C(π/2) =(cid:0)[0,∞) × [0, π/2](cid:1)(cid:14) ∼ is given by

pr
s = (r, s).

Theorem 3.17. For each t > 0 we have

lt(r)
ρt(r)

lim
r→0

= 0 .

In other words, the angle at the apex o is zero. We have more precisely
R(r) ∼ r2/4 and A(r) ∈ O(r3) as r → 0.
Moreover, R+ is both, the tangent space of (C(π/2), dt) at o, and the limit
in the pointed Gromov–Hausdorﬀ topology as t goes to inﬁnity.

z = 1

z + γ1

iz + γ1

4(cid:2)γ1

Proof. We will follow the same reasoning as in the proof of Theorem 3.11.
Let us highlight the main steps. By scaling, we can again assume that
t = 1. Let us denote by µ1
P (z) and
denote by fz its density with respect to the Lebesgue measure. Recalling the
expressions (3.13), (3.14) (the latter with π replaced by π/2) for ρ and l, it
is suﬃcient to calculate R(r) and A(r) asymptotically as r → 0. A rotation
of π/4 permits us to see the measures µt
z as product measures. This allows
us to calculate R exactly in a similar way as in Theorem 3.11. Thus, we
set zr = reiπ/4 and recall that R(r) = kVrk2
zr ;R2), where Vr is the unique
vector ﬁeld in Tµ1
zr

−iz(cid:3) the lift of ν1

P(R2) solving the continuity equation

−z + γ1

L2(µ1

d

dh(cid:12)(cid:12)(cid:12)h=0

Using the explicit expression

fzr+heiπ/4 + div(fzr Vr) = 0 .

(3.20)

fzr (z) =

1

4hη(x1 − r/√2) + η(x1 + r/√2)ihη(x2 − r/√2) + η(x2 + r/√2)i ,

we readily check that

1

1

d

+

fzr+heiπ/4 =

dh(cid:12)(cid:12)(cid:12)h=0
4√2h − η′(x1 − r/√2) + η′(x1 + r/√2)ihη(x2 − r/√2) + η(x2 + r/√2)i
4√2hη(x1 − r/√2) + η(x1 + r/√2)ih − η′(x2 − r/√2) + η′(x2 + r/√2)i ,
Vr(z) =(cid:18)ϕr(x1)
ϕr(x2)(cid:19) ,

η(x + r/√2) − η(x − r/√2)
η(x + r/√2) + η(x − r/√2)

and that the solution to (3.20) is given by

ϕr(x) =

1
√2

.

Thus, we ﬁnd

R(r) =

=

1

2ZR2 |Vr|2fzr =

r2
4

+ o(r2) .

23

1

8Z |η(x + r/√2) − η(x − r/√2)|2
η(x + r/√2) + η(x − r/√2)

dx

Let us turn to calculating A. Here, it is convenient to set zr = (r, 0) and re-
P(R2)
call that A(r) = kVrk2
L2(µ1
to the continuity equation

zr ;R2), where Vr is the unique solution in Tµ1

zr

d

dh(cid:12)(cid:12)(cid:12)h=0

fzr+(0,h) + div(fz0Vr) = 0 .

(3.21)

We will again approximate the solution. First note that

βr =

=

=

=

1

d

fzr+(0,h)(z)

dh(cid:12)(cid:12)(cid:12)h=0
4hη′(x1)(cid:16)η(x2 − r) − η(x2 + r)(cid:17) − η′(x2)(cid:16)η(x1 − r) − η(x1 + r)(cid:17)i
12hη′′′(x1)η′(x2) − η′(x1)η′′′(x2)i + o(r3)

r3

r3
48

(x3
1x2 − x1x3

2)η(x1)η(x2) + o(r3) ,

where in the last equality we have used that η′(u) = −(u/2)η(u) and η′′′(u) =
(−(u3/4) + (5u/4))η(u). Now, set ψr(y) = r3

1y2 − y1y3

2] and calculate

96 [y3

δr = − div(fzr∇ψr) = −∂1fzr ∂1ψr − ∂2fzr ∂2ψr

r3
96

(3x2

1x2 − x3
2)

r3
96

−

(3x2

2x1 − x3
1)

1

4hη′(x1)(cid:0)η(x2 − r) + η(x2 + r)(cid:1)
4hη(x1)(cid:0)η′(x2 − r) + η′(x2 + r)(cid:1)

+ η(x2)(cid:0)η′(x1 − r) + η′(x1 + r)(cid:1)i
+ η′(x2)(cid:0)η(x1 − r) + η(x1 + r)(cid:1)i

1

r3

96h(3x2

1x2 − x3
1x2 − x1x3
(x3

r3
48

2)η′(x1)η(x2) − (3x2
2)η(x1)η(x2) + o(r3) .

2x1 − x3

1)η(x1)η′(x2)i + o(r3)

=

=

=

Hence, as r → 0 we obtain that

1

r6Z |βr − δr|2

fzr → 0 .

Since the measures µ1
pendent of r, we deduce by Lemma 3.4 that

zr satisfy the Poincar´e inequality with constant inde-

1
r3k∇ψr − VrkL2(µ1

zr ;R2) → 0 .

24

MATTHIAS ERBAR AND NICOLAS JUILLET

This yields thatpA(r) = k∇ψrkL2(µ1

zr ) + o(r3) = Cr3 + o(r3) for a suitable
constant C. Using ﬁnally (3.13), (3.14) we ﬁnd that ρ1(r) is of order r2,
while l1(r) is of order r3. This yields the claim on the ratio.
In analogy with the end of the proof of Theorem 3.11 concerning the trans-
formation T , and with the notation adapted from it we ﬁnd ¯R = 1 and
¯A = o(1) when ¯r goes to zero. One recognizes that the tangent cone is R+
and, using the space-time scaling similarly to Lemma 3.7 one sees that R+
is also the pointed Gromov–Hausdorﬀ limit when t goes to inﬁnity.
(cid:3)

4. Smoothing the Heisenberg group

4.1. Heisenberg group. Most of the considerations in this section can be
generalized to the higher-dimensional Heisenberg groups, but for simplic-
ity we consider only the ﬁrst Heisenberg group H. This Lie group can be
represented by H = C × R with the multiplicative structure

(z, u) · (z′, u′) =(cid:18)z + z′, u + u′ −

1
2

Im(z ¯z′)(cid:19) ,

where Im is the imaginary part of a complex number.
A basis for the Lie algebra is given by the left invariant vector ﬁelds

X = ∂x −

y
2

∂u , Y = ∂y +

x
2

∂u , U = ∂u ,

and the relation [X, Y] = U. We will also consider the right invariant vector
ﬁelds

ˆX = ∂x +

y
2

∂u ,

ˆY = ∂y −

x
2

∂u ,

ˆU = U .

The Haar measure associated with the group structure is up to a constant
multiple the 3-dimensional Lebesgue measure, denoted by L, it is both left-
and right-invariant.

4.2. Riemannian and sub-Riemannian distances. The Heisenberg group
carries a sub-Riemannian structure given by the pseudo-norm

kaX + bY + cUk2

cc =(a2 + b2

+∞

if c = 0,
otherwise.

The Carnot–Carath´eodory distance dcc is obtained by minimizing the sub-
Riemannian length of curves connecting two points. More precisely, given
p, q ∈ H we have

dcc(p, q) = infZ T

0 k ˙γskcc ds ,

where the inﬁmum is taken e.g. over all absolutely continuous curves (γs)s∈[0,T ]
with respect to the Euclidean distance such that γ0 = p, γT = q. Note that
the sub-Riemannian length of γ is only ﬁnite if γ is horizontal, i.e. for a.e. s
the tangent vector ˙γs is contained in the horizontal sub-bundle

TH = Vect(X, Y) .

As a consequence of the so-called H¨ormander condition, namely that the
horizontal vector ﬁelds generate the full tangent space, the distance dcc is
ﬁnite: any two points of Hn can be connected by a horizontal curve of ﬁnite

25

length and even a minimizing curve can be found. Note that a curve is
absolutely continuous with respect to the Carnot–Carath´eodory distance if
and only if it is absolutely continuous with respect to the Euclidean distance,
its tangent vector is horizontal at almost every point and its sub-Riemannian
length is ﬁnite.
The 3-dimensional Lebesgue measure L coincides with the 4-dimension Haus-
dorﬀ measure of the metric space (H, dcc). It has been shown in [19] that the
metric measure space (H, dcc,L) does not satisfy the curvature-dimension
condition CD(K, N ) for any K, N .
However, the sub-Riemannian pseudo-norm is naturally approximated by a
family of Riemannian metrics indexed by ε > 0 and deﬁned via

kaX + bY + cUk2

Riem(ε) = a2 + b2 + (c/ε)2 .

We denote the associated Riemannian distance by dRiem(ε). The associated
Riemannian volume coincides with L up to a constant. One can check that
the best lower bound on the Ricci curvature of k·kRiem(ε) is − 1
2 ε−2, see
e.g. [5]. We have the following comparison of dcc and dRiem, that stand for
dRiem(1).

Proposition 4.1 ([20, Lemma1.1]). We have

dRiem ≤ dcc ≤ dRiem + 4π .

Moreover, there are positive constants c and C such that for any point p =
(z, u) ∈ H = C × R:

max(|z|, c(|z| + |u|1/2)) ≤ dcc(0H, p) ≤ C(|z| + |u|1/2) .

4.3. Isometries. For every p ∈ H, we denote by τp : H → H and θp : H → H
the left and right translations respectively, i.e.

τp(q) = p · q = θq(p) .

By deﬁnition a vector ﬁeld V is a left invariant if and only if Dτp(V ) = V for
every p ∈ H. Hence, the left translation τp is an isometry for both distances
dcc and dRiem. This is false for θq unless q = 0H.
Other isometries are

• the rotations ρα : H ∋ (z, u) 7→ (eiαz, u) deﬁned for α ∈ R,
• the reﬂection ξ : H ∋ (z, u) 7→ (¯z,−u),

and up to the multiplicative constant λ,

• the dilations δλ : H ∋ (z, u) 7→ (λz, λ2u) where λ > 0.

One has Dδλ(V ) = λV if and only if V is horizontal. In general one has

Dδλ(aX + bY + cU) = λ(aX + bY) + λ2cU .

Therefore δλ is an isometry between (H, dcc) and (H, λ−1dcc) as well as be-
tween (H, dRiem(ε)) and (H, λ−1dRiem(ελ)). Hence, all the Riemannian man-
ifolds (H, dRiem(ε))ε>0 are isometric up to a multiplicative constant, which
justiﬁes that we mainly consider (H, dRiem) corresponding to ε = 1.

26

MATTHIAS ERBAR AND NICOLAS JUILLET

4.4. Wasserstein space over the Heisenberg group and absolutely
continuous curves of measures. Denote by WH the L2-Wasserstein dis-
tance build from the Carnot–Carath´eodory distance dcc. We will recall here

the characterization of 2-absolutely continuous curves in (cid:0)P2(H, dcc), WH(cid:1)

via solutions to the continuity equation.
Denote by div V the divergence of a vector ﬁeld V on R3 with respect to
the Lebesgue measure. Note that the basis vector ﬁelds X, Y, U all have
divergence zero and moreover, we have div(f X+gY +hV) = Xf + Yg + Uh
for every smooth functions f, g, h. We denote by

∇Hf = (Xf )X + (Yf )Y ,

the horizontal gradient of a function f . Then, for any smooth, compactly
supported function f and vector ﬁeld V we have the integration by parts
formula

ZH

f div V dL = −ZHh∇Hf, Vicc dL .

Further let us denote by L2
equipped with the norm

cc(µ) the Hilbert space of Borel vector ﬁelds V

kVk2

L2
cc

=Z kVk2

cc dµ .

Note that any V ∈ L2
following characterization of absolutely continuous curves.

cc(µ) must be horizontal µ-a.e. Now, we have the

Proposition 4.2 ([20, Proposition 3.1]). A weakly continuous curve (µs)s∈[0,T ]
in P2(H) is 2-absolutely continuous with respect to WH if and only if there
cc(µs) ds < ∞ such

exists a Borel family of vector ﬁelds Vs with R T

that the continuity equation

0 kVsk2

L2

∂sµ + div(µsVs) = 0

holds in distribution sense. In this case we have | ˙µs| ≤ kVskL2
s. Moreover, Vs is uniquely determined for a.e. s if we require

cc(µs) for a.e.

Vs ∈ Tµs

P2(H) := {∇Hψ | ψ ∈ C∞c (R3)}

L2

cc(µs)

and there holds | ˙µs| = kVskL2
Following verbatim the argument of Lemma 3.4 we obtain a similar state-
ment in the Heisenberg group.

cc(µs).

Lemma 4.3. Let µ = ρL ∈ P2(H) with strictly positive density ρ. Assume
that µ satisﬁes the Poincar´e type inequality

for all f ∈ C∞c (H) withR f dµ = 0. Let s ∈ L1(H,L) be such thatR s dL = 0

and

(4.1)

Z |f|2 dµ ≤ CZ k∇Hfk2

cc dµ ,

ks/√ρk2

L2 = Z s2

ρ

dL < ∞ .

Then there exists a unique horizontal vector ﬁeld V ∈ TµP2(H) such that
the equation

holds in distribution sense. Moreover, we have

s + div(µV ) = 0

27

kV k2

L2

cc(µ) ≤ Cks/√ρk2
L2 .

(4.2)

4.5. Heat kernel. Another important consequence of the H¨ormander con-
dition is the hypoellipticity of the operators ∆cc = X2 + Y2 and ∆cc − ∂t,
which in particular means that distributional solutions ρ : (0,∞) × H → R
of the heat equation

∂tρ = ∆ccρ,

are smooth. Note that the heat equation is left invariant. As shown by
Gaveau [16], the unique distributional solution µt = ρtL with initial con-
dition µ0 ∈ P2(H) is given via convolution with a fundamental solution
ht:

ρt(p) =Z ht(q−1p) dµ0(q) ,

where ht is given explicitly by

ht(z, u) =

2

(4πt)2ZR

exp(cid:18) λ

t (cid:18)iu − |z|2

4

coth λ(cid:19)(cid:19) λ

sinh λ

dλ.

In fact ht is the density of Xt = (B2t, L2t) where the process (Bt)t≥0 is a
planar Brownian motion B = B1 + iB2 and Lt = 1
s dB1
s )
is the L´evy area. Hence ht is a strictly positive probability density with
respect to L for all t. Moreover, htL ∈ P2(H).
We will need the following estimates [5, (14) and proof of Thm. 3.1].

2R t

s − B2

s dB2

0 (B1

Z (cid:0)(X log ht)2 + (Y log ht)2(cid:1)ht dL =

2
t

,

Z (U log ht)2ht dL < ∞ . (4.3)

The same estimates hold for the right invariant vector ﬁelds ˆX, ˆY, ˆU. Note
also the scaling relation

ht(z, u) =

h1(z/√t, u/t) .

1
t2

(4.4)

Given t ≥ 0 and q ∈ H we deﬁne the measure νt

q ∈ P2(H) via

q =(δq

νt

if t = 0 ,
(τq)#(htL) = ht(q−1p)L(dp) otherwise,

and call it the heat kernel measure centered at q.
Lemma 4.4. The map ιt : (H, dcc) ∋ q 7→ νt
and Lipschitz. Moreover, WH(νt
inﬁnity.

p, νt

q ∈ (P2(H), WH) is injective
q) tends to inﬁnity as dcc(p, q) goes to

Before we go to the proof, let us stress that the isometries of (H, dcc) intro-
duced in paragraph 4.3 give rise to isometries of (P2(H), WH) via pushfor-
ward. In particular, translations of measures (τp)# are isometries.

28

MATTHIAS ERBAR AND NICOLAS JUILLET

(z,u) 6= νt

(z ′,u′) provided z 6= z′. Further, note that νt

Proof. We ﬁrst check injectivity. Form the probabilistic interpretation of
ht one sees that the projection P C : H → C transports νt
(z,u) to the 2-
dimensional Gaussian measure centered at z with covariance 2t · Id. There-
fore, we have νt
(z,u) =
(τ(0,u′−u))#νt
(z,u′). Hence, the two measures are distinct provided u 6= u′
since (τ(0,u′−u))# is an isometry. This proves injectivity of ιt.
Lipschitz continuity of ιt follows from Kuwada’s duality between Lq-Wasserstein
contraction estimates and Lp-gradient estimates on the heat kernel of the
Heisenberg group, established e.g. in [5]. See [22, Prop. 4.1] and the discus-
sion thereafter. The distance WH(δp, νt
p) = WH(δ0H , ν) is independent from
p. Hence

q) ≥ WH(δp, δq) − 2WH(δ0H , ν)
tends to inﬁnity as dcc(p, q) = WH(δp, δq) tends to inﬁnity.

WH(νt

p, νt

(cid:3)

Finally, we note that for any t > 0 the measures νt
q satisfy the Poincar´e type
inequality (4.1) with a constant C = c · t for some c > 0, see [15, Thm. 1.7].
4.6. Smoothing eﬀect of the transformation. In view of Lemma 4.4 the
map ιt : H ∋ q 7→ νt
q ∈ P2(H) satisﬁes Assumption 2.1 and the hypotheses
of Proposition 2.4 are also satisﬁed. Thus as outlined in Section 2 we can
introduce the new distance

as well as the associated length distance

edt(p, q) = WH(νt

p, νt

q) ,

dt(q, p) = infZ T

0

| ˙ps|t ds = infZ T

0

| ˙νt
ps| ds ,

where the inﬁmum is taken over absolutely continuous (or equivalently Lip-

schitz) curves (ps)s∈[0,T ] in (H,edt) such that p0 = p, pT = q and | ˙ps|t and
ps| denote the metric derivatives with respect to edt and WH respectively.
| ˙νt
We have the following scaling relation.

Proposition 4.5. For t > 0 and every p, q ∈ H we have

dt(δ√tp, δ√tq) = √t · d1(p, q) .

(4.5)

In other words, the dilation δ√t is an isometry from (H,√td1) to (H, dt).
Proof. The measure dilation (δλ)# dilates the Wasserstein distance WH by
the factor λ. As a consequence of the scaling relation (4.4) we ﬁnd that
(δλ)#νt
easily passes to the induced length distance.

δλ(q). Thus, we obtain (4.5) with d replaced by ed, which then

q = νλ2t

We can now state our main theorem about the smoothing eﬀect of the
transformation of the distance.

(cid:3)

Theorem 4.6. The distance dt is induced by a left-invariant Riemannian
metric tensor gt. More precisely, we have dt = K · dRiem(κ√t), where the
constant K, κ satisfy K ≥ 2 and K/κ < √2.

29

The numerical estimates on κ and K will be given in Remarks 4.7 and 4.8.
The ﬁrst remark explains the reason why the convolution procedure allows
to recover the forbidden non-horizontal direction. The second remark relates
K to the optimal constant in Wasserstein contraction estimates for the heat
ﬂow. Together with the convergence results in Proposition 4.9, this result
proves Theorem 1.3 claimed in the introduction.

Proof of Theorem 4.6. By Proposition 4.5 it suﬃces to consider t = 1 and
we will do so for the moment. We suppress the index t = 1 in the notation,

setting d = d1,ed = ed1 and νq = ν1

Deﬁnition of g: For q ∈ H and a, b, c ∈ R we deﬁne:
k2

q .

q

is the unique vector ﬁeld in Tνq

gq(cid:0)(aX + bY + cU)(q)(cid:1) = kVa,b,c
∂s(cid:12)(cid:12)s=0νqs + div(νqVa,b,c

q

where Va,b,c
equation

q

cc(νq) ,
L2

(4.6)

P2(H) solving the continuity

) = 0

(4.7)

with a curve (qs)s such that q0 = q and ˙qs = (aX + bY + cU)(qs). Existence
and uniqueness of Va,b,c
are ensured by Lemma 4.3. We will show below
that g is indeed a metric tensor after polarizing it to a bilinear form. First
we have to check that the assumptions of Lemma 4.3 are fulﬁlled.
Note that the continuity equation can be rewritten as

q

) = 0 ,

(4.8)

where ρs(p) = h1(q−1
yields

s p) is the density of νqs. The derivation of s 7→ q−1

s .qs

∂s(cid:12)(cid:12)s=0ρs + div(ρ0Va,b,c

q

d
ds

q−1
s = −q−1

s

˙qsq−1

s = −(a ˆX + b ˆY + c ˆU)(q−1
s )

where we use the equalities between left- and right-invariant vector ﬁelds at
0H = q−1

.qs. We obtain

s

∂s(cid:12)(cid:12)s=0ρs(p) = −(cid:0)(a ˆX + b ˆY + c ˆU)h1(cid:1)(q−1p) .

Thus, by the left invariance of L and (4.3), we have that

Z |∂s|s=0ρs|2

ρ0

dL =Z |(a ˆX + b ˆY + c ˆU)h1|2

h1

dL < ∞ .

Hence, Lemma 4.3 is indeed applicable.

The metric g is Riemannian: By linearity of (4.7) and uniqueness of the
solution, Va,b,c
depends linearly on a, b, c. Thus gq(·) is quadratic and indeed
gives rise to a metric tensor after polarization. Note moreover, that Va,b,c
q =
Dτq(Va,b,c

0H ). This implies that g is left invariant, i.e.

q

gq(cid:0)(aX + bY + cU)(q)(cid:1) = g0H(cid:0)(aX + bY + cU)(0H)(cid:1) .

In particular, gq depends smoothly on q.

Characterization of the Riemannian metrics obtained by convolution: It is
readily checked that g is also invariant under rotations ρα. Left invariant and
rotation invariant Riemannian metrics g on H form a two parameter family

30

MATTHIAS ERBAR AND NICOLAS JUILLET

indexed by K, κ > 0 deﬁned by K = g(X)1/2 = g(Y)1/2 and K/κ = g(U)1/2.
Thus, we must have that g = K 2k·k2
The distance d coincides with the Riemannian distance: Let us denote by dg
the Riemannian distance induced by g and recall that

Riem(κ).

dg(p, q) = infZ T

0 qgqs( ˙qs) ds ,

where the inﬁmum is taken e.g. over all curves (qs)s∈[0,T ] connecting p to q
that are Lipschitz with respect to Euclidean distance. To see that d coincides

if it is locally Lipschitz in Euclidean sense and for any such curve we have

with dg, it is suﬃcient to check that a curve (qs)s is ed-Lipschitz if and only
where the left hand side is the metric derivative with respect to ed.

So let (qs)s∈[0,T ] be a Euclidean Lipschitz curve such that ˙qs = (asX+ bsY +
csU)(qs). Following the reasoning in the ﬁrst part of the proof, we see that
the continuity equation

| ˙qs|2 = gqs( ˙qs) ,

(4.9)

∂sνqs + div(νqsVas,bs,cs

qs

) = 0

qs

k2

L2

s + b2

s + c2

s + c2

s + b2

cc(νqs ) = K 2(a2

holds with kVas,bs,cs
s/κ2). Thus, by the charac-
terization of absolutely continuous curves in (P2(H), WH), Proposition 4.2,
and the deﬁnition of ed, the curve (qs)s is locally edt-absolutely continuous
with metric derivative Kpa2
(4.9) holds by deﬁnition of g. Conversely, to see that any ed-Lipschitz curve
shows in particular, that ed ≤ d1 ≤ K · dRiem(κ) and that dRiem(κ) is locally

is also Euclidean Lipschitz, it suﬃces to note that the previous argument

s/κ2, and also Lipschitz. Moreover,

equivalent to the Euclidean distance.

Remark 4.7 (Estimate on κ). The crucial feature of the regularized distance
dt as opposed to dcc is that also non-horizontal curves can have ﬁnite length.
This is due to the eﬀect that even when the length of a curve (qs)s with
respect to dcc is inﬁnite, the length of (νt
qs)s with respect to the Wasserstein
distance build from dcc may be ﬁnite. Let us make this more explicit for
the special curve qs = (0, 0, s). This curve is not horizontal and has inﬁnite

length, actually dcc(qs, qr) = c·p|s − r|, where c = dcc(0H, q1), which follows

from the behavior of dcc under translations and dilations. However, the curve
qs = ρt
νt

s p) satisﬁes the continuity equation

sL with ρs(p) = ht(q−1

(cid:3)

∂sρs = −Uρs = − [X, Y] ρs = −X(Yρs) + Y(Xρs) = − div(ρsVs)

with the horizontal, but not of gradient type vector ﬁeld Vs = (Y log ρs)X−
(X log ρs)Y. Hence, we have

| ˙νqs| < kVskL2

cc

=sZ (Xht)2 + (Yht)2

ht

dL =r 2

t

by (4.3). Therefore the curve (νqs) has indeed ﬁnite WH-length and K/κ =

g1(U) ≤ √2.

Remark 4.8 (Estimate on K). It has been proved by Kuwada [22] that

the ratio edt/dcc is related to a gradient estimate established by Driver and

Melcher [15]. In fact the constant C2 in this estimate can be dually deﬁned
by

31

C2 = sup
p6=q

dcc(p, q)−1W (νt

p, νt

q),

so that it is in particular independent from t. From [15] it is known C2 ≥ 2
and a conjecture is C2 = 2, see [5, Remark 3.2]. Let us show K = C2, which
gives a new understanding of this constant. We have

edt/dcc = (dt/dcc) × (edt/dt)

with dt/dcc ≤ K and edt/dt ≤ 1. But for qs = (s, 0, 0) we see that that the

quotient of the distances between 0 and qs tend to K and 1 respectively as
s goes to zero. Therefore g1(X) = K = C2 ≥ 2.
We conclude this section with an observation on the limiting behavior of the
convoluted distances as t → 0.
Proposition 4.9. As t → 0, for all p, q ∈ H we have:

edt(p, q) → dcc(p, q) ,

dt(p, q) → K · dcc(p, q) .

Moreover, the metric spaces (H, dt) converge to (H, dcc) in the pointed Gromov–
Hausdorﬀ sense.

Proof. The pointwise convergence of edt to dcc follows from Proposition 2.4.

The pointwise convergence of dt follows immediately from the explicit for-
mula for dt = KdRiem(κ√t) in Theorem 4.6. As the usual approximation
of the subRiemannian Heisenberg group holds in the pointed Gromov–
Hausdorﬀ sense, the space (H, dt) tends to (H, Kdcc). But as explained
in paragraph 4.3, (H, K · dcc) is isometric to (H, dcc) via the dilation δK.
The last statement follows.

(cid:3)

References

[1] S. Alexander, V. Kapovitch, and A. Petrunin. An optimal lower curvature bound for
convex hypersurfaces in Riemannian manifolds. Illinois J. Math., 52(3):1031–1033,
2008.

[2] L. Ambrosio, N. Gigli, and G. Savar´e. Gradient ﬂows in metric spaces and in the space
of probability measures. Lectures in Mathematics ETH Z¨urich. Birkh¨auser Verlag,
Basel, second edition, 2008.

[3] L. Ambrosio, N. Gigli, and G. Savar´e. Calculus and heat ﬂow in metric measure spaces
and applications to spaces with Ricci bounds from below. Invent. Math., 195(2):289–
391, 2014.

[4] L. Ambrosio, N. Gigli, and G. Savar´e. Metric measure spaces with Riemannian Ricci

curvature bounded from below. Duke Math. J., 163(7):1405–1490, 2014.

[5] D. Bakry, F. Baudoin, M. Bonnefont, and D. Chafai. On gradient bounds for the
heat kernel on the Heisenberg group. Journal of Functional Analysis, 255:1905–1938,
2008.

[6] L. Bandara, S. Lakzian, and M. Munn. Geometric singularities and a ﬂow tangent to

the Ricci ﬂow. to appear in Ann. Sc. Norm. Super. Pisa Cl. Sci. (5), May 2015.

[7] A. Bella¨ıche. The tangent space in sub-Riemannian geometry. J. Math. Sci. (New

York), 83(4):461–476, 1997. Dynamical systems, 3.

32

MATTHIAS ERBAR AND NICOLAS JUILLET

[8] S. Bujalo. Shortest arcs on convex hypersurfaces of a Riemannian space. Zap. Nauchn.

Semin. Leningr. Otd. Mat. Inst. Steklova, 66:114–132, 1976.

[9] D. Burago, Y. Burago, and S. Ivanov. A course in metric geometry, volume 33 of
Graduate Studies in Mathematics. American Mathematical Society, Providence, RI,
2001.

[10] D. Burago, S. Ivanov, and B. Kleiner. On the structure of the stable norm of periodic

metrics. Math. Res. Lett., 4(6):791–808, 1997.

[11] X. Cao and L. Saloﬀ-Coste. Backward Ricci ﬂow on locally homogeneous 3-manifolds.

Comm. Anal. Geom., 17(2):305–325, 2009.

[12] J. Cheeger and T. H. Colding. Lower bounds on Ricci curvature and the almost

rigidity of warped products. Ann. of Math. (2), 144(1):189–237, 1996.

[13] B. Chow, P. Lu, and L. Ni. Hamilton’s Ricci ﬂow, volume 77 of Graduate Studies in
Mathematics. American Mathematical Society, Providence, RI; Science Press, New
York, 2006.

[14] A. Deruelle. Smoothing out positively curved metric cones by Ricci expanders. ArXiv

e-prints, Feb. 2015.

[15] B. K. Driver and T. Melcher. Hypoelliptic heat kernel inequalities on the Heisenberg

group. Journal of Functional Analysis, 221(2):340 – 365, 2005.

[16] B. Gaveau. Principe de moindre action, propagation de la chaleur et estim´ees sous

elliptiques sur certains groupes nilpotents. Acta Math., 139(1-2):95–153, 1977.

[17] N. Gigli and C. Mantegazza. A ﬂow tangent to the Ricci ﬂow via heat kernels and

mass transport. Adv. Math., 250:74–104, 2014.

[18] M. Gromov. Metric structures for Riemannian and non-Riemannian spaces. Modern
Birkh¨auser Classics. Birkh¨auser Boston, Inc., Boston, MA, english edition, 2007.
Based on the 1981 French original, With appendices by M. Katz, P. Pansu and S.
Semmes, Translated from the French by Sean Michael Bates.

[19] N. Juillet. Geometric inequalities and generalized Ricci bounds in the Heisenberg

group. Int. Math. Res. Not. IMRN, 2009(13):2347–2373, 2009.

[20] N. Juillet. Diﬀusion by optimal transport in Heisenberg groups. Calc. Var. Partial

Diﬀerential Equations, 50(3-4):693–721, 2014.

[21] C. Ketterer. Cones over metric measure spaces and the maximal diameter theorem.

J. Math. Pures Appl. (9), 103(5):1228–1275, 2015.

[22] K. Kuwada. Duality on gradient estimates and Wasserstein controls. J. Funct. Anal.,

258(11):3758–3774, 2010.

[23] J. Lott and C. Villani. Ricci curvature for metric-measure spaces via optimal trans-

port. Ann. Math. (2), 169(3):903–991, 2009.

[24] R. J. McCann and P. M. Topping. Ricci ﬂow, entropy and optimal transportation.

Amer. J. Math., 132(3):711–730, 2010.

[25] A. D. Milka. Shortest lines on convex surfaces. Dokl. Akad. Nauk SSSR, 248(1):34–36,

1979.

[26] S.-I. Ohta and K.-T. Sturm. Heat ﬂow on Finsler manifolds. Comm. Pure Appl. Math.,

62(10):1386–1433, 2009.

[27] S.-i. Ohta and K.-T. Sturm. Non-contraction of heat ﬂow on Minkowski spaces. Arch.

Ration. Mech. Anal., 204(3):917–944, 2012.

[28] F. Otto. The geometry of dissipative evolution equations: the porous medium equa-

tion. Comm. Partial Diﬀerential Equations, 26(1-2):101–174, 2001.

[29] F. Schulze and M. Simon. Expanding solitons with non-negative curvature operator

coming out of cones. Math. Z., 275(1-2):625–639, 2013.

[30] K.-T. Sturm. On the geometry of metric measure spaces. I and II. Acta Math.,

196(1):65–177, 2006.

[31] A. Takatsu. Wasserstein geometry of Gaussian measures. Osaka J. Math., 48(4):1005–

1026, 2011.

[32] C. Villani. Optimal transport, Old and new, volume 338 of Grundlehren der Mathe-

matischen Wissenschaften. Springer-Verlag, Berlin, 2009.

University of Bonn, Institute for Applied Mathematics, Endenicher Allee 60,
53115 Bonn, Germany
E-mail address: erbar@iam.uni-bonn.de

Institut de Recherche Math´ematique Avanc´ee, UMR 7501, Universit´e de Stras-
bourg et CNRS, 7 rue Ren´e Descartes, 67 000 Strasbourg, France
E-mail address: nicolas.juillet@math.unistra.fr

33

