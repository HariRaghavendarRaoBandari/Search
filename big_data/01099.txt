6
1
0
2

 
r
a

M
2

 

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
9
9
0
1
0

.

3
0
6
1
:
v
i
X
r
a

Design and characterization of

integrated components for SiN photonic

quantum circuits

Menno Poot, Carsten Schuck, Xiao-song Ma, Xiang Guo, and

Hong X. Tang∗
*hong.tang@yale.edu

Department of Electrical Engineering, Yale University, New Haven, CT 06520, USA

Abstract:
The design, fabrication, and detailed calibration of essen-
tial building blocks towards fully integrated linear-optics quantum com-
putation are discussed. Photonic devices are made from silicon nitride rib
waveguides, where measurements on ring resonators show small propaga-
tion losses. Directional couplers are designed to be insensitive to fabrica-
tion variations. Their offset and coupling lengths are measured, as well as
the phase difference between the transmitted and reﬂected light. With care-
ful calibrations, the insertion loss of the directional couplers is found to
be small. Finally, an integrated controlled-NOT circuit is characterized by
measuring the transmission through different combinations of inputs and
outputs. The gate ﬁdelity for the CNOT operation with this circuit is es-
timated to be 99.81% after post selection. This high ﬁdelity is due to our
robust design, good fabrication reproducibility, and extensive characteriza-
tions.
OCIS codes: (230.3120) Integrated optics devices (270.5585) Quantum information and pro-
cessing.

References and links

1. E. Knill, R. Laﬂamme, and G. J. Milburn, “A scheme for efﬁcient quantum computation with linear optics,”

Nature 409, 46–52 (2001).

2. P. Kok, W. J. Munro, K. Nemoto, T. C. Ralph, J. P. Dowling, and G. J. Milburn, “Linear optical quantum com-

puting with photonic qubits,” Rev. Mod. Phys. 79, 135–174 (2007).

3. M. A. Nielsen and I. L. Chuang, Quantum computation and quantum information (Cambridge University, Cam-

bridge, 2010).

4. J. L. O’Brien, G. J. Pryde, A. Gilchrist, D. F. V. James, N. K. Langford, T. C. Ralph, and A. G. White, “Quantum

process tomography of a controlled-not gate,” Phys. Rev. Lett. 93, 080502 (2004).

5. P. Walther, K. J. Resch, T. Rudolph, E. Schenck, H. Weinfurter, V. Vedral, M. Aspelmeyer, and A. Zeilinger,

“Experimental one-way quantum computing,” Nature 434, 169–176 (2005).

6. T. B. Pittman, B. C. Jacobs, and J. D. Franson, “Demonstration of quantum error correction using linear optics,”

Phys. Rev. A 71, 052332 (2005).

7. R. Okamoto, J. L. OBrien, H. F. Hofmann, and S. Takeuchi, “Realization of a Knill-Laﬂamme-Milburn
controlled-NOT photonic quantum circuit combining effective optical nonlinearities,” Proc. Natl. Acad. Sci. USA
108, 10067–10071 (2011).

8. W.-B. Gao, A. M. Goebel, C.-Y. Lu, H.-N. Dai, C. Wagenknecht, Q. Zhang, B. Zhao, C.-Z. Peng, Z.-B. Chen,
Y.-A. Chen, and J.-W. Pan, “Teleportation-based realization of an optical quantum two-qubit entangling gate,”
Proceedings of the National Academy of Sciences 107, 20869–20874 (2010).

9. A. Politi, M. J. Cryan, J. G. Rarity, S. Yu, and J. L. O’Brien, “Silica-on-silicon waveguide quantum circuits,”

Science 320, 646–649 (2008).

10. B. Lounis and M. Orrit, “Single-photon sources,” Rep. Prog. Phys. 68, 1129 (2005).
11. M. D. Eisaman, J. Fan, A. Migdall, and S. V. Polyakov, “Invited review article: Single-photon sources and de-

tectors,” Rev. Sci. Instrum. 82, 071101 (2011).

12. M. A. Broome, A. Fedrizzi, S. Rahimi-Keshari, J. Dove, S. Aaronson, T. C. Ralph, and A. G. White, “Photonic

boson sampling in a tunable circuit,” Science 339, 794–798 (2013).

13. J. Carolan, C. Harrold, C. Sparrow, E. Martn-Lpez, N. J. Russell, J. W. Silverstone, P. J. Shadbolt, N. Matsuda,
M. Oguma, M. Itoh, G. D. Marshall, M. G. Thompson, J. C. F. Matthews, T. Hashimoto, J. L. OBrien, and
A. Laing, “Universal linear optics,” Science 349, 711–716 (2015).

14. C. M. Natarajan, M. G. Tanner, and R. H. Hadﬁeld, “Superconducting nanowire single-photon detectors: physics

and applications,” Supercond. Sci. Technol. 25, 063001 (2012).

15. W. Pernice, C. Schuck, O. Minaeva, M. Li, G. Goltsman, A. Sergienko, and H. Tang, “High-speed and high-
efﬁciency travelling wave single-photon detectors embedded in nanophotonic circuits,” Nat Commun 3, 1325
(2012).

16. C. Schuck, W. H. Pernice, X. Ma, and H. X. Tang, “Optical time domain reﬂectometry with low noise waveguide-

coupled superconducting nanowire single-photon detectors,” Appl. Phys. Lett. 102, 191104 (2013).

17. J. P. Sprengers, A. Gaggero, D. Sahin, S. Jahanmirinejad, G. Frucci, F. Mattioli, R. Leoni, J. Beetz, M. Ler-
mer, M. Kamp, S. Hﬂing, R. Sanjines, and A. Fiore, “Waveguide superconducting single-photon detectors for
integrated quantum photonic circuits,” Appl. Phys. Lett. 99, 181110 (2011).

18. C. Schuck, W. H. P. Pernice, and H. X. Tang, “Waveguide integrated low noise NbTiN nanowire single-photon

detectors with milli-Hz dark count rate,” Sci. Rep. 3, 1–6 (2013).

19. M. Poot and H. X. Tang, “Broadband nanoelectromechanical phase shifting of light on a chip,” Appl. Phys. Lett.

104, 061101 (2014).

20. M. Poot and H. X. Tang, “High-quality opto-electromechanical resonators,” In preparation (2015).
21. M. Poot, K. Y. Fong, and H. X. Tang, “Classical non-gaussian state preparation through squeezing in an opto-

electromechanical resonator,” Phys. Rev. A 90, 063809 (2014).

22. M. Poot, K. Y. Fong, and H. X. Tang, “Deep feedback-stabilized parametric squeezing in an opto-

electromechanical system,” New J. Phys. 17, 043056 (2015).

23. P. Rath, S. Ummethala, S. Diewald, G. Lewes-Malandrakis, D. Brink, N. Heidrich, C. Nebel, and W. H. P. Pernice,
“Diamond electro-optomechanical resonators integrated in nanophotonic circuits,” Appl. Phys. Lett. 105, 251102
(2014).

24. R. St-Gelais, B. Guha, L. Zhu, S. Fan, and M. Lipson, “Demonstration of strong near-ﬁeld radiative heat transfer

between integrated nanostructures,” Nano Lett. 14, 6971–6975 (2014). PMID: 25420115.

25. C. Schuck, X. Guo, L. Fan, X. Ma, M. Poot, and H. X. Tang, “Quantum interference in heterogeneous

superconducting-photonic circuits on a silicon chip,” Nat Commun 7, 10352 (2016).

26. C. Xiong, W. H. P. Pernice, X. Sun, C. Schuck, K. Y. Fong, and H. X. Tang, “Aluminum nitride as a new material

for chip-scale optomechanics and nonlinear optics,” New J. Phys. 14, 095014 (2012).

27. C. Xiong, W. Pernice, K. K. Ryu, C. Schuck, K. Y. Fong, T. Palacios, and H. X. Tang, “Integrated gan photonic

circuits on silicon (100) for second harmonic generation,” Opt. Express 19, 10462–10470 (2011).

28. C. Wang, M. J. Burek, Z. Lin, H. A. Atikian, V. Venkataraman, I.-C. Huang, P. Stark, and M. Lonˇcar, “Integrated

high quality factor lithium niobate microdisk resonators,” Opt. Express 22, 30924–30933 (2014).

29. J. E. Sharping, K. F. Lee, M. A. Foster, A. C. Turner, B. S. Schmidt, M. Lipson, A. L. Gaeta, and P. Kumar,

“Generation of correlated photons in nanoscale silicon waveguides,” Opt. Express 14, 12388–12393 (2006).

30. H. Takesue, Y. Tokura, H. Fukuda, T. Tsuchizawa, T. Watanabe, K. Yamada, and S.-i. Itabashi, “Entanglement

generation using silicon wire waveguide,” Appl. Phys. Lett. 91, 201108 (2007).

31. A. Dutt, K. Luke, S. Manipatruni, A. L. Gaeta, P. Nussenzveig, and M. Lipson, “On-chip optical squeezing,”

Phys. Rev. Applied 3, 044005 (2015).

32. A. Gondarenko, J. S. Levy, and M. Lipson, “High conﬁnement micron-scale silicon nitride high q ring resonator,”

Opt. Express 17, 11366–11370 (2009).

33. M.-C. Tien, J. F. Bauters, M. J. R. Heck, D. T. Spencer, D. J. Blumenthal, and J. E. Bowers, “Ultra-high quality

factor planar Si3N4 ring resonators on si substrates,” Opt. Express 19, 13551–13556 (2011).

34. D. Taillaert, W. Bogaerts, P. Bienstman, T. Krauss, P. Van Daele, I. Moerman, S. Verstuyft, K. De Mesel, and
R. Baets, “An out-of-plane grating coupler for efﬁcient butt-coupling between compact planar waveguides and
single-mode ﬁbers,” Quantum Electronics, IEEE Journal of 38, 949–955 (2002).

35. M. Melchiorri, N. Daldosso, F. Sbrana, L. Pavesi, G. Pucker, C. Kompocholis, P. Bellutti, and A. Lui, “Propaga-

tion losses of silicon nitride waveguides in the near-infrared range,” Appl. Phys. Lett. 86, 121111 (2005).

36. N. Gruhler, C. Benz, H. Jang, J.-H. Ahn, R. Danneau, and W. H. P. Pernice, “High-quality Si3N4 circuits as a

platform for graphene-based nanophotonic devices,” Opt. Express 21, 31678–31689 (2013).

37. W. Bogaerts, P. De Heyn, T. Van Vaerenbergh, K. De Vos, S. Kumar Selvaraja, T. Claes, P. Dumon, P. Bienstman,

D. Van Thourhout, and R. Baets, “Silicon microring resonators,” Laser & Photonics Reviews 6, 47–73 (2012).

38. P. Rabiei, W. H. Steier, C. Zhang, and L. R. Dalton, “Polymer micro-ring ﬁlters and modulators,” J. Lightw.

Technol. 20, 1968–1975 (2002).

39. P. Rath, N. Gruhler, S. Khasminskaya, C. Nebel, C. Wild, and W. H. P. Pernice, “Waferscale nanophotonic circuits

made from diamond-on-insulator substrates,” Opt. Express 21, 11031–11036 (2013).

40. K. Y. Fong, M. Poot, and H. X. Tang, “Nano-optomechanical resonators in microﬂuidics,” Nano Lett. 15, 6116–

6120 (2015).

41. M. Reck, A. Zeilinger, H. J. Bernstein, and P. Bertani, “Experimental realization of any discrete unitary operator,”

Phys. Rev. Lett. 73, 58–61 (1994).

42. W.-P. Huang, “Coupled-mode theory for optical waveguides: an overview,” J. Opt. Soc. Am. A 11, 963–983

(1994).

43. T. C. Ralph, N. K. Langford, T. B. Bell, and A. G. White, “Linear optical controlled-not gate in the coincidence

basis,” Phys. Rev. A 65, 062324 (2002).

44. Y. Zhang, S. Yang, A. E.-J. Lim, G.-Q. Lo, C. Galland, T. Baehr-Jones, and M. Hochberg, “A compact and low

loss y-junction for submicron silicon waveguide,” Opt. Express 21, 1310–1316 (2013).

45. Z. Lu, H. Yun, Y. Wang, Z. Chen, F. Zhang, N. A. F. Jaeger, and L. Chrostowski, “Broadband silicon photonic

directional coupler using asymmetric-waveguide based phase control,” Opt. Express 23, 3795–3808 (2015).

46. A. Zeilinger, “General properties of lossless beam splitters in interferometry,” Am. J. Phys. 49, 882–883 (1981).
47. M. W. Mitchell, C. W. Ellenor, S. Schneider, and A. M. Steinberg, “Diagnosis, prescription, and prognosis of a

bell-state ﬁlter by quantum process tomography,” Phys. Rev. Lett. 91, 120402 (2003).

48. S. Rahimi-Keshari, M. A. Broome, R. Fickler, A. Fedrizzi, T. C. Ralph, and A. G. White, “Direct characterization

of linear-optical networks,” Opt. Express 21, 13450–13458 (2013).

49. B. J. Metcalf, N. Thomas-Peter, J. B. Spring, D. Kundys, M. A. Broome, P. C. Humphreys, X.-M. Jin, M. Barbieri,
W. Steven Kolthammer, J. C. Gates, B. J. Smith, N. K. Langford, P. G. Smith, and I. A. Walmsley, “Multiphoton
quantum interference in a multiport integrated photonic device,” Nat Commun 4, 1356 (2013).

50. J. Skaar, J. C. Garc´ıa Escart´ın, and H. Landro, “Quantum mechanical description of linear optics,” American

Journal of Physics 72, 1385–1391 (2004).

51. U. Leonhardt and A. Neumaier, “Explicit effective hamiltonians for general linear quantum-optical networks,”

Journal of Optics B: Quantum and Semiclassical Optics 6, L1 (2004).

1.

Introduction

Single photons combined with linear optical elements and efﬁcient detectors show tremendous
promise for universal quantum computation [1, 2, 3]. In linear-optics quantum computation
(LOQC) quantum information is carried by single photons which are manipulated using linear
optical elements such as beam splitters, waveplates, and phase shifters. The ﬁrst steps towards
the goal of universal quantum computation [2, 3] have been achieved, see e.g. [4, 5, 6, 7, 8].
However, scaling these experiments to larger system sizes is difﬁcult in bulk optics due to its
limited mechanical stability and space requirements. On the other hand, integrated photonic
circuits easily achieve scalability, compactness, and interferometric stability [9]. Here we dis-
cuss the design, fabrication, and characterization of photonic circuits for on-chip LOQC based
on an integrated silicon nitride platform. Our vision is to integrate all the required compo-
nents for LOQC on a single chip to minimize coupling (i.e. interconnect) losses. This includes
sources of single photons [10, 11], programmable circuitry for realizing quantum-logic opera-
tions [12, 13], and detection of the single photons that make up the qubits [11, 14, 15].

There are different ways to encode quantum information using photons, for example using
their polarization, or through time-bin encoding [3]. However, in integrated photonic circuits,
a natural way is to encode quantum information in the spatial mode of the single photon [2].
In this framework the logical states of the qubit (written as |1i and |0i) correspond to which
(single-mode) waveguide a single photon travels through. Single-qubit operations then are im-
plemented using relative phase shifts and directional couplers. Another essential element for
quantum computation are multi-qubit operations such as controlled-NOT (CNOT), controlled-
Z, and Toffoli gates [3]. Finally, after (or even during) the computation the single photons have
to be detected with high efﬁciency. For this purpose superconducting nanowire single photon
detectors (SNSPDs) are an excellent choice because of their good quantum efﬁciency at near-
infrared wavelengths, and high counting speed [14].

In our vision, all the required components will be fabricated on a single monolithically-
integrated chip. This thus also includes the SNSPDs, which can be fabricated directly on top
of the photonic waveguides [15, 16, 17, 18]. In this way, coupling losses between the quantum
circuitry and the detectors that would occur if SNSPDs were situated on a separate chip [14],
are avoided. However, since such completely integrated chips have to be measured at cryogenic

temperatures, the on-chip power dissipation should be small. For this purpose, we have devel-
oped opto-electromechanical phase shifters [19, 20], which are also used for optomechanics
experiments [21, 22, 23, 24]. Currently, the nonclassical light for our experiments is gener-
ated off the chip using spontaneous parametric down-conversion (SPDC) of 777 nm light in
a periodically-poled potassium-titanyl-phosphate (pp-KTP) waveguide [25]. Future integration
of the source can be done, for example, by using deposited AlN [26], bonded GaN [27], or
LiNbO3 [28] as the source material for SPDC. Alternatively, photon pairs generated through
spontaneous four-wave mixing can be used, e.g. [29, 30] Unlike SPDC this process is also
possible in materials with inversion symmetry, including SiN [31].

After our previous demonstrations of phase shifters and single photon detectors, in this work
we focus on the photonic circuits themselves. Section 2 discusses the choice for the SiN mate-
rial platform and the fabrication of the circuits. It is shown in Sec. 3 that the resulting waveg-
uides have low propagation loss. The directional couplers are the subject of Sec. 4 to 7: Their
photonic design is discussed in Sec. 4 and the characterization in Sec. 5. The interaction loss is
the topic of Sec. 6 and the phase between the outputs of the directional couplers is studied in
Sec. 7. Finally, in Sec. 8 a complete quantum-operation circuit is measured and characterized
using the transmission of classical light.

2. Photonic design and fabrication

In our integration approach, our photonic quantum-optics platform includes mechanically ac-
tive elements, nanophotonic waveguides, as well as thin superconducting detectors. The choice
of materials should thus be compatible with the release of the mechanical parts, allow for low-
loss waveguides (as the loss of a photon would destroy the qubit), and enable deposition of
high-quality superconducting material. Taking these considerations into account leads to the
conclusion that silicon nitride is the best candidate for our platform. High-stress SiN has excel-
lent mechanical properties as well as good optical transmission for near-infrared light [32, 33].
Moreover, it is compatible with the sputter-deposition of NbTiN for highly efﬁcient SNSPDs
[18].

After selecting SiN as the material of choice, a fabrication process has to be devised which
should be accurate and reproducible, yield low-loss waveguides, and be compatible with releas-
ing the mechanical structures, without degrading the superconducting material. The devices in
this work only contain the optical circuitry and can thus be made in a simpler, but fully com-
patible, process ﬂow. However, since the detectors and phase shifters are essential elements in
our fully integrated programmable photonic platform, we will now ﬁrst outline the entire fab-
rication process envisioned for photonic chips with opto-electromechanical phase shifters and
SNSPDs (“full devices”) before focusing on the simpliﬁed process that is used for the devices
presented here. For full devices, the starting point will be a silicon wafer with an oxide cladding
layer and a SiN device layer in which the photonic circuits will be deﬁned. After deposition of
the superconducting material, the entire fabrication scheme for a full device including elec-
tromechanical phase shifters and superconducting detectors will consist of 6 lithography steps.
First, metallic markers and electrodes will be deﬁned by electron-beam lithography and evap-
oration. Then the SNSPDs will be written and etched. Next a protective layer will be placed
over the alignment markers and then the silicon nitride is to be etched in two separate steps:
one for the mechanical structures that have to be released, and another one where a thin layer
of SiN remains. This layer will act as an etch mask that protects the underlying silicon oxide
during the release of mechanical structures [19, 20]. In the ﬁnal step, etch windows around
the optomechanical phase shifters will be opened in photoresist such that only the mechanical
structures will be exposed to buffered hydroﬂuoric acid for release. The remaining photoresist
will protect the NbTiN detectors during the release and is to be removed afterwards. This is the

process ﬂow that we envision for the future generation of completely integrated quantum-optics
chips.

On the other hand, without movable parts and SNSPDs, the photonic devices presented in
this work are made in a single lithography step. A silicon chip with a 3.3 m m thick silicon
oxide cladding and a 330 nm thick high-stress SiN device layer is cleaned and spin-coated
with ZEP520A resist. The patterns are deﬁned by electron beam lithography using a Raith
EBPG5000+. After development in xylene, the nanophotonic structures are etched using a
CHF3/O2 plasma. The etch is timed such that ∼ 50 nm of SiN remains; the photonic waveg-
uides thus have a so-called rib structure.

To couple light onto and out of the chip, grating couplers are etched into the SiN [34]. By
placing an array of single-mode optical ﬁbers above such structures, light is coupled from
the ﬁbers into the waveguides and vice versa. The waveguides support a single TE-like mode
and the polarization of the input light is adjusted using a ﬁber polarization controller. Since
the sample can move freely underneath the ﬁber array (that holds eight ﬁbers), it is easy to
sequentially measure the large number of devices required for this work.

3. Propagation loss measurements

As explained above, the photonic circuits for LOQC need to have low optical losses as absorp-
tion or scattering of a photon would destroy the qubit. Rib waveguides made out of SiN can
have low propagation losses [35, 36], which is also true for our devices as we will show next.
Figure 1(a) shows a picture of a test device to quantify the propagation loss. It consists of a
ring resonator that is coupled to a waveguide connecting two grating couplers for optical input
and output. The resonances of the ring appear in the optical transmission spectrum, as shown
in Fig. 1(b). Their spacing is used to extract the group index ng, whereas their linewidths de-
termine the propagation loss. A free-spectral range of FSR = 3.465 nm is found by ﬁtting the
resonances. From this value the group index can be obtained using ng = l 2/(2p R × FSR) [37].
Here R = 55 m m is the ring radius and l = 1550 nm is the vacuum wavelength. This is done
for four different devices with different separations between the waveguide and the ring. The
group index is independent of this distance and has a mean value ng = 1.9936 ± 0.0017. This
value is typical for such waveguides [36]. On the other hand, the resonances themselves do
depend on the ring-waveguide separation. This is because the coupling between the waveguide
and the ring, as quantiﬁed by the coupling linewidth wc, increases with decreasing separation.
The total width of the resonance is the sum of wc and the linewidth due to internal losses such
as scattering and absorption, wint. Note that wint does not depend on the separation, so that by
decreasing the separation the resonances go from undercoupled (wc ≪ wint) through critically
coupled (wc = wint) to overcoupled (wc ≫ wint). The extinction, i.e. the depth of the resonances,
has a maximum at critical coupling. As shown in Fig. 1(c) for small separation (cyan) the dip is
shallow and wide, which is characteristic for an overcoupled resonance. For larger separations
the dip is much narrower and has a higher extinction. From input-output theory the shape of the
resonance is expected to be Lorentzian [37]. However, Figure 1(b) shows that the (off-resonant)
transmission is not ﬂat: it contains Fabry-P´erot fringes due to reﬂection at the grating couplers.
The ﬁt function is the product of these two contributions:

T (l ) =

T0

1 + Fc sin2(p [l − l fp]/FSRfp)

×(cid:18)1 −

wcwint

(wc + wint)2/4 + (l − l 0)2(cid:19) ,

(1)

where T0, Fc, l fp, and FSRfp are the ﬁt parameters for the fringes, and l 0, wint, and wc are
those for the actual resonance. The dashed lines in Fig. 1(c) are the resulting ﬁts; they describe
the data well and give accurate values for the resonance wavelength l 0 and both the internal
and couplings linewidths wint and wc, respectively. However, the same ﬁt is obtained with their

-0.05

0

0.05

0.1

Detuning (nm)

w
w

c

int

700

(c)

n
o
i
s
s
i
m
s
n
a
r
t
d
e
z
i
l
a
m
r
o
N

(d)

)

m
n
(
h
t
d
w
e
n
L

i

i

5

0

-5

-10

-15

(a)

(b)

)

i

i

B
d
(
n
o
s
s
m
s
n
a
r
t
d
e
z
i
l

a
m
r
o
N

3

2.5

2

460 nm

540 nm

1.5

620 nm

1

0.5

700 nm

0
-0.1

0.06

0.05

0.04

0.03

0.02

0.01

-20

1520

1530

1540

1550

1560

1570

Wavelength (nm)

0
450

500

550
Separation (nm)

600

650

Q = 233k

int

Fig. 1. (a) Optical micrograph of a ring resonator with a feeding waveguide and grating
couplers (triangular structures). The spacing between the grating couplers is 250 um and
the ring has a diameter of 110 um. (b) Optical transmission of a device with a waveguide
width of 1 um and a separation between the ring and the feeding waveguide of 700 nm.
The transmission is normalized to that of the grating couplers. The shaded area indicates
the resonance highlighted in panel (c). (c) Zooms of resonances near 1552 nm with ﬁts
(dashed lines) for different separations between the waveguide and the ring on a linear
scale. The curves are offset for clarity. (d) Linewidths extracted from the ﬁts. The solid
symbols are the linewidths due to the coupling between the feed waveguide and the ring,
whereas the open circles are the internal linewidths. The colors are consistent between all
panels.

values interchanged, as Eq. (1) is symmetric with respect to these two parameters. Hence, for
a single ring it is not possible to distinguish between these two contributions (unless one has
access to the phase of the transmitted light), but they can be identiﬁed via their dependence on
the separation between the ring and the feeding waveguide [Fig. 1(d)]. The larger of the two
linewidths (solid markers) clearly decreases with increasing separation, whereas the smaller of
the two (open symbols) is independent of the gap. The former is thus identiﬁed as the cou-
pling linewidth, whereas the latter is due to the internal losses. Its mean value of wint = 6.65 pm
yields an intrinsic quality factor Qint = l 0/wint = 2.33 × 105. As mentioned above, Qint is di-
rectly related to the propagation loss of the ring by Qint = 2p ng/al
is the
propagation loss coefﬁcient and l
the free-space wavelength. Inserting the values for Qint and
ng gives a = 0.35 cm−1 which equals 1.5 dB/cm. This shows that for the devices shown in
this work, where the light travels through less than 1 mm of waveguide, propagation losses are
negligible. However, we note the loss can be reduced even further by reﬂowing the developed

[38, 39], where a

min

0

max

transition region

interaction length Lint

transition region

(a)

1

4

2

3

S31

S21

S11

S41

20
60
Interaction length (um)

40

80

300

(b)

200

100

)

m
n
(

t
h
g
i
e
H

0

SiN

-100

-2

SiO cladding

2

-1

0

1

2

Cross section (mm)

5 um

1

(d)

0.5

2

|

1
j

S

|

0

-5

10

0
0

200

400

600

800

1000

Slot width (nm)

separation sint

y

z

(c)

x

1.58

1.57

1.56

1.55

1.54

1.53
0

f
f
e

n

+

-

Δn

Fig. 2. (a) Finite element simulation of a directional coupler (top view) when light is sent
into port 1. The z-component of the magnetic ﬁeld Hz is shown according to the color
scale. The inset shows a zoom of Hz near the outputs (ports 2,3). (b) Measured atomic-
force microscope proﬁle (averaged) across the center of a directional coupler with 1000 nm
wide waveguides and 400 nm separation between them. The image is colored to indicate the
guiding and cladding layer. The distance between the top of the waveguide and the cladding
is 330 nm. Note the difference in the horizontal and vertical scales. (c) Calculated effective
refractive index of the even (green) mode and the odd (blue) mode versus the separation
between the two waveguides. The insets show the Ey ﬁeld of the modes. (d) Magnitudes of
the elements of the scattering matrix for different Lint obtained from FEM simulations as
in panel (a).

resist before etching the photonic structures [40, 36]. This smoothes the waveguide, thus reduc-
ing the scattering loss even further. After characterizing the loss in isolated waveguides, next
the design of the directional coupler, another important element for LOQC, is discussed.

4. Directional coupler design

Beam splitters are very important elements for linear quantum optics circuits when using free
space optics. Together with phase shifters they can be used to generate any unitary operation
[41]. In integrated photonics the device equivalent to a beam splitter is called a directional
coupler. As shown in Fig. 2(a) it consists of two waveguides that are initially well separated,
but over a transition region they are brought in close proximity to each other. In this cen-
tral area with interaction length Lint the waveguides run parallel to each other with separation
sint, and they are close enough so that the evanescent ﬁelds couple their optical modes [42].
Figure 2(b) shows a cross-section of an actual directional coupler measured with an atomic
force microscope. By simulating this structure through ﬁnite-element (FEM) simulations, the
two guided optical modes are found as shown in Fig. 2(c). For large slot widths their effec-
tive indices are similar and approach the effective refractive index of an isolated waveguide:
neff → 1.548.However, when the slot is narrowed, the mode coupling increases and the effec-
tive indices split into an upward (neff,+) and downward (neff,−) branch. The insets show that
these modes correspond to the symmetric (even) and anti-symmetric (odd) superpositions of
the waveguide modes, respectively. When light is sent into one port, say the upper right arm of

the directional coupler in Fig. 2(a), the light is initially localized in the mode of that waveguide,
which is an equal superposition of the even and odd eigenmodes. The light in those modes then
propagates along the length of the directional coupler. However, due to the difference in effec-
tive refractive indices D n = neff,+ − neff,−, a phase difference develops between the light in the
even and odd mode. This phase difference is important when projecting the eigenmodes back
onto the uncoupled waveguide modes for analysis at the outputs of the directional coupler. A
full power transfer from one waveguide to the other results when the acquired phase difference
is p . By varying the interaction length Lint of the directional coupler, the phase difference, and
hence the power splitting ratio, can be controlled.

The analysis of the directional coupler using the effective refractive indices does not take the
transition regions into account. To include these, ﬁnite-element simulation as shown in Fig. 2(a)
are performed. The amplitude and phase of the output ﬁelds, and thus the power-splitting ratio,
are related to the input ﬁelds by the scattering matrix S. The device has four ports and thus S
is in principle a 4 × 4 matrix. However, similarly to a bulk optic beam splitter, hardly any light
is reﬂected backwards [that is, back to port 1 or 4 for light inserted into port 1 as in Fig. 2(a)].
This is conﬁrmed by the simulation results shown in the lower panel of Fig. 2(d), where the
magnitudes |S11|2 and |S41|2 are found to be below 10−5. It is then often convenient to identify
the input and output ports of the directional coupler and use a reduced 2 × 2 scattering matrix
S′ to relate those ﬁelds:

S24

=(cid:18) S21

S31

S34 (cid:19)(cid:18) a1

(cid:18) a2
a3 (cid:19)out
11|2 indicates how much power of the input light (with power Pin) simply goes through
21|2 indicates how much crosses over (Pc). From coupled-

22 (cid:19)(cid:18) a1

a4 (cid:19)in

↔(cid:18) a1

a2 (cid:19)′

=(cid:18) S′

11
S′
21

a2 (cid:19)′

Here |S′
the original waveguide (Pt) and |S′
mode theory [42] it is found that

S′
12
S′

.

in

(2)

out

≡ C = |S′

21|2 = sin2(cid:18)p

2

Pc
Pin

Lint + ℓ0

ℓc (cid:19) .

(3)

Here, ℓ0 is the offset length which takes into account the power transferred in the transition
l /D n is the coupling length. Note that both ℓc and ℓ0 do not correspond
region. Moreover, ℓc = 1
2
to any physical dimension of the coupler. They both depend on sint and on the wavelength l : a
smaller sint results in a stronger coupling between the waveguide modes and thus in a shorter
ℓc. To design a directional coupler with a certain target splitting ratio Ctarget, one can either
select sint, which ﬁxes ℓc and ℓ0, and then ﬁnd the required Lint using Eq. (3). Alternatively,
one can also ﬁrst ﬁx a value for Lint and then (numerically) solve for sint, but, as discussed
below, the former approach is used for designing our devices. Graphically, the solutions are
the intersections of the red curve in Fig. 2(d) with a horizontal line at C = Ctarget. For each
maximum of the sinusoidal curve there are two intersections with different signs of their slopes.
The maxima themselves can be labeled by an integer k = round({Lint + ℓ0}/2ℓc) that counts
the number of times light has been transferred back and forth between the two waveguides after
traversing the directional coupler. Inverting Eq. (3) yields the solutions Lint = ℓc[2k ±arccos(1−
2C)/p ] − ℓ0. It can be seen in Fig. 2(d) that solutions labeled with a + (-) sign have a negative
(positive) slope, and that solutions with higher k correspond to larger device lengths. By taking
the derivative of Eq. (3) with respect to l , the wavelength dependence of the splitting ratio is
found:

From FEM simulations it is found that ¶ ℓ0/¶l
than the negative-valued ¶ ℓc/¶l

is positive and an order of magnitude smaller
. This means that the lowest value of k for which there is

=

1

ℓcpC(1 −C)(cid:26)p

¶ ℓ0
¶l − [2p k ± arccos(1 − 2C)]

¶ ℓc
¶l (cid:27) .

(4)

¶ C
¶l

(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

Table 1. Changes of the coupling length d ℓc from the nominal value ℓc = 37.47m m for
variations of the device parameters. The values of the variations (third column) represent
estimated fabrication uncertainties around the target values (second column). The “remain-
ing thickness” is the thickness of the SiN remaining on top of the SiO2 after etching, far
outside the coupler region. The “center thickness” is the thickness remaining in between the
two waveguides, which is larger due to the narrow slot. All variations d p are small enough
for the changes in coupling length to be proportional to the variation in the parameter p that
caused it: d ℓc ≈ ¶ ℓc/¶ p × d p.

Quantity

width left waveguide
width right waveguide

slot width sint
lateral etch
SiN thickness

remaining thickness

center thickness
ref. index SiN
ref. index SiO2
sidewall angle
wavelength l

Value
1000 nm
1000 nm
400 nm

-

330 nm
50 nm
70 nm
2.00
1.44
17 deg
1550 nm

Variation

-25 nm
-25 nm
+25 nm
+25 nm
-10 nm
-10 nm
-10 nm
0.01
0.01
1 deg
5 nm

d ℓc(m m)
-1.15
-1.15
3.29
1.85
-1.46
-0.62
2.06
1.07
-0.33
-0.26
-0.59

a positive Lint results in the smallest wavelength dependence, i.e. when working on the ﬁrst
period of the oscillations of the power between the two waveguides [cf. Fig. 2(d)].

As explained above, using either FEM simulations or measurements on previous devices, the
design parameters for a directional coupler with a certain splitting ratio can be calculated. In
practice, it is hard to exactly match the target dimensions for the directional coupler and also
variations between fabrication runs occur. However, as will be shown in Sec. 8 the splitting
ratios C have to be close to their target values for performing high-ﬁdelity operations. Therefore,
it is important to see how the coupling length ℓc (which is the most important contribution; see
the discussion on the wavelength dependence above) changes due to differences in the coupler
geometry. The smaller these changes d ℓc are, the more reproducible the directional couplers
will be. To optimize these, ﬁrst a FEM simulation is performed with device parameters (second
column of Table 1) that reﬂect the cross section of fabricated directional couplers [Fig. 2(b)].
For this nominal geometry the resulting coupling length is ℓc = 37.47 m m. Now a change in ℓc
can be converted to a change in C using Eq. (3). For example, for a 50/50 directional coupler it
is found that C changes by -0.021 per micrometer change in ℓc.
After simulating the nominal device, simulations are performed with small changes in the
device geometry. Table 1 shows the resulting changes d ℓc. As an example, consider the effect
of changes in the width of the left waveguide (ﬁrst row). Its designed width is 1000 nm but
if the waveguide turns out to be 25 nm narrower, the coupling length decreases by 1.15 m m.
This is because the modes will be less conﬁned in a narrower waveguide, which increases the
coupling between the modes. Hence, D n increases from 0.02069 to 0.02135, resulting in the
shorter ℓc. The effects of other variations are given in the other rows of Table 1. It is clear
that ℓc is most sensitive to the slot width. In practice the waveguide and slot widths, as deﬁned
in electron beam lithography, are very accurate; variations mainly arise during the dry etch
of SiN. A small amount of lateral etching reduces the widths of both waveguides and at the
same time increases the width of the slot. In our device geometry these contributions have
opposite effects on ℓc so that they largely cancel each other: 25 nm of lateral etching on both

sides of each waveguide only increases the coupling length by 1.85 m m. This number is to
be compared to the situation where both waveguides are 50 nm narrower but where the slot
width stays the same; in that case ℓc changes much more: d ℓc = 4 × −1.15 m m = −4.6 m m.
Similarly, when sint is 50 nm larger, d ℓc = 2 × 3.29 m m = +6.6 m m. These opposite effects thus
largely cancel each other for lateral etching, indicating that our design is quite robust against
such variations. Another important variation can arise when the superconductor is removed
in the fully integrated device (i.e. one with the superconducting detectors and phase shifters):
Since the dry etch is not selective between NbTiN and SiN, a thin layer of the underlying SiN
ﬁlm will be removed in that process. As indicated in Table 1 a 10 nm thinner SiN ﬁlm results
in a 1.46 m m shorter ℓc. However, if, despite the thinner ﬁlm, the etch depth that deﬁnes the
waveguides is kept the same, the thickness of the SiN remaining in the center of the slot will
also be thinner, which increases ℓc by 2.06 m m. Moreover, the remaining SiN away from the
directional coupler is also thinned giving d ℓc = −0.62 m m. Adding up these three contributions
results in a vanishing change in ℓc, again indicating the robustness of the chosen design.

5. Characterization of the directional couplers

Linear optics quantum circuits require directional couplers with well-deﬁned splitting ratios.
For example, a particular design of a CNOT gate (see Sec. 8) requires directional couplers with
C = 1/2 and C = 2/3 [43]. The closer the splitting ratios are to those ideal values, the higher the
ﬁdelity of the quantum operation is [43]. Getting as close as possible to the design values is thus
extremely important. As discussed in the previous section, realizing a certain splitting ratio for
a directional coupler means ﬁnding the right interaction length Lint, which requires knowledge
of ℓc and ℓ0. The simulations of Sec. 4 give a good indication of their expected values, but the
agreement between simulation and experiment has to be checked in order to obtain the right
splitting ratios that are required for high-ﬁdelity operations.

Using devices such as the one shown in Fig. 3(a) with varying Lint, we experimentally obtain
ℓc and ℓ0. Light is sent into the input (blue arrow) and is split equally using a Y-splitter [44].
Half of the light goes to the reference output (left), whereas the other half is sent into the lower
arm of the directional coupler where it is redistributed over the two outputs. The resulting
powers Pt and Pc are then detected at the respective outputs. Figure 3(b) shows the normalized
cross power Pc/(Pc + Pt) = C for 22 different devices with Lint ranging from 0 to 50 m m. For the
shortest device only a small amount of power crosses over and the remaining light goes through
the same waveguide. Initially, C increases with increasing Lint until the maximum where all
the light crosses over to the opposite waveguide is reached at Lint = 26 m m. For even longer
interaction lengths the cross power steadily drops, indicating that more light is transferred back
to the original (“through”) waveguide. The solid line is a ﬁt of Eq. (3) and describes the data
well. The period is 2ℓc, whereas −ℓ0 is the (negative) value where the function reaches zero.
By repeating these ﬁts at different wavelengths, the wavelength dependence of ℓc and ℓ0 shown
in Fig. 3(c) is obtained. The offset length depends only weakly on l , but the coupling length
shows a clear decrease with increasing wavelength: at longer wavelengths the evanescent ﬁeld
extends further out from the waveguide. Hence the coupling is stronger, resulting in a shorter ℓc.
Figure 3(d) shows the wavelength-dependence of the cross power for two interaction lengths. At
l = 1554 nm, i.e., the wavelength where our SPDC source operates [25], the coupling ratios are
very close to the values of 1/2 and 2/3 that are required for the CNOT gate (dashed lines). When
moving away from this center wavelength, deviations in the beam-splitting ratio become larger.
However, within the bandwidth of the down-converted photons (∼ 4.6 nm [25]), the splitting
ratio only changes from C1/2 = 0.489 to 0.499 and C2/3 = 0.660 to 0.671 for Lint = 8.5 and
12.4 m m respectively. The splitting ratios are thus less than 0.011 away from the ideal values
over the entire wavelength range of interest. A further reduction of the dispersion could be

(a)

m
u
 
0
0
1

ref.

input

through

cross

(b)

(c)

(d)

s

int =

400 nm

s

int =

400 nm

L =int

Fig. 3. (a) Optical dark-ﬁeld image of a device to calibrate the coupling ratio of the direc-
tional coupler (dashed rectangle). The insets show two directional couplers with different
interaction lengths. (b) Measured normalized cross power Pc/(Pt + Pc) at a wavelength of
1554 nm for different Lint, together with a ﬁt of Eq. (3) (solid line) to the data. The data
is obtained by measuring the transmission proﬁles with a tunable laser, followed by a 2
nm averaging. (c) The extracted wavelength dependence of the coupling length ℓc and the
offset length ℓ0. (d) The cross power as a function of wavelength for directional couplers
with two different Lint values. The dashed lines indicate 50/50 and 33/67 beam splitters.

achieved by adapting an asymmetric design for the directional coupler [45].

Finally, we tested the reproducibility of our directional couplers by comparing chips that
were fabricated months apart: The values of ℓ0 and ℓc for these runs differed by only ∼ 2%,
highlighting the robustness of our directional coupler design and fabrication.

6.

Insertion loss

Another important parameter of a directional coupler is its insertion loss, i.e., how many of
the photons sent into the input do not come out of the two outputs. In other words: how many
photons are lost, for example due to absorption, reﬂection, or scattering? To this end, the com-
bined optical power at the output ports Pt + Pc is compared with the power at the input of the
directional coupler, which equals the power at the reference port Pref. Determining small inser-
tion losses requires accurate measurements of the relative transmission through many devices
on the chip. Hence such a measurement is only possible after careful calibration as there are
several factors that need to be taken into account. First of all, the sample needs to be posi-
tioned underneath the ﬁber array exactly the same way for each device. We also note that the
actual location of the individual ﬁbers (more precisely, their cores) in the array varies slightly,

(a)

T1 2←

T

1 2←

Y/2

T

3 2←

Y/2

T

1 2←

Y/2

T

4 2←

Y/2

T

T

T

1¬2

3¬2

4¬2

Y

(b)

-30

)

B
d
(
n
o
i
s
s
i
m
s
n
a
r
T

-35

-40

10

5

0

-45

1520

1530

1540

1550

1560

Wavelength (nm)

-5
1570

(c)

n
o
i
s
s
i
m
s
n
a
r
t
 
l
a
t
o
t

Fig. 4. (a) Schematics of calibration devices to determine the insertion loss. Light is sent
into port 2 (blue arrow) and detected at the other ports (orange). The three devices have
different routings that enable extraction of the coupler transmissions Ti←2 and the insertion
loss of the Y-splitter Y . The combinations that the light encounters are indicated at each
output grating coupler. (b) Extracted transmission proﬁles Ti←2(l ) and Y (l ). (c) Insertion
loss of the 22 directional couplers (same devices as Fig. 3, averaged over wavelength) and a
box plot showing the median value (red), 25 and 75% percentile (box) and the extent (bars).
The interaction length is varied from 0 to 50 m m when going from device D3 to AB3.

leading to small differences in the measured transmission for different combinations of input
and output ﬁbers. Differences in the measured signal can also occur due to different gains of the
photo detectors. Finally, the vertical distance between the sample and the ﬁber array can change
when moving from one device to another. These issues are addressed by measuring different
calibration devices in addition to the devices with the actual directional couplers. By carefully
measuring their transmissions, the abovementioned factors can be quantiﬁed and corrected for
to determine the insertion loss of the directional couplers.

For the measurements, every device (i.e., both the calibration and actual devices) is ﬁrst
placed underneath the ﬁber array and then its position is optimized using an automated proce-
dure that allows for repeatability of the transmission (and thus of the position) at the percent
level. This is done by maximizing the transmission between the input and the reference output
to ensure that all four ﬁbers are always at the same position above the grating couplers. Note
that this would not necessarily be the case when maximizing the total power Pref + Pt + Pc as
the relative power at each output varies from device to device (as the splitting ratio is varied).
After this optimization, the wavelength of the laser is swept and the transmission Ti←2(l ) at
each of the three outputs [i = 1 (ref.), 3 (through), and 4 (cross); see Fig. 4(a)] is measured.

The three different types of calibration devices are shown in Fig. 4(a). The ﬁrst (top) is a
direct connection between the input (port 2) and the reference output (port 1). It thus allows
calibration of T1←2(l ). In the center calibration device the input light is split equally (using
a Y-splitter) between the reference and port 3. The relative power at the reference port P1/Pin
is thus the product of the transmission through the Y-splitter Y and T1←2. Since T1←2(l ) is
known from the ﬁrst calibration device, this allows determination of Y (l ). Likewise P3/Pin
is the product of Y and T3←2, from which T3←2(l ) can be determined. Finally, in the bottom
device Pin is again split equally, but now between the reference and port 4, which yields the
last transmission T4←2(l ).1 Figure 4(b) shows the resulting transmission proﬁles Ti←2(l ) as
well as the transmission through the Y-splitter. The latter is Y ∼ −0.8 dB, largely independent
of wavelength. Only small (< 0.5 dB) differences in the transmission proﬁles Ti←2 are visible2.
For example, the transmission through output 3 is about 1 dB larger than through port 4; the
transmission through the reference port is in between the other two. If these differences were not
accounted for, the apparent power coming out of the directional coupler, and thus the insertion
loss, could be off by about half a dB.

After performing this calibration procedure the measured powers at each detector are cor-
rected using the corresponding Ti←2(l ) before calculating the insertion loss (Pc + Pt)/Pref. Fig-
ure 4(c) shows that the insertion loss of the 22 directional couplers has a mean value of 0.06 dB
which is comparable to the standard deviation of 0.07 dB. The former indicates that > 98% of
the photons that are incident on the beam splitter either go to the through or to the cross-over
port; the insertion loss of the directional couplers is thus small.

7. Beam splitter phase shift

Another important question about beam splitters and directional couplers is what relative phase
difference it imprints on the output ﬁelds [46]. In bulk optics this phase difference depends
on the details of the beam splitter that is used. For example, upon reﬂection from a metallic
beam-splitting surface a phase change of p occurs with respect to the transmitted ﬁeld. On the
other hands, when the beam splitter is made using dielectric layers the situation is different.
Moreover, the polarization of the incident light and coatings on the beam splitter can further
complicate the relation between the output light ﬁelds [47]. For the actual design of the quantum
circuitry it is essential to know this phase difference: compare for example the assignments of
the ports of the CNOT gate in Ref. [43] with our design in Sec. 8. These differences are solely
due to the difference in the beam-splitter phase relations.

To ﬁnd the optical phase difference between the outputs of our integrated directional couplers
we have made and measured the devices shown in Fig. 5 which consist of two Mach-Zehnder
interferometers (MZIs). Relative shifts between the fringes of these two unbalanced MZIs will
be used to infer the phase difference between the outputs of the directional coupler. They work
as follows: light from a central input is split equally and guided to the inputs of two MZIs
(referred to as “left” and “right”). At the input of each of these MZIs the light is split into
two arms. After traveling through those arms (the shorter inner one and the longer outer arm;
the latter acting as the reference arm of the MZI) the light is recombined at the output of
each interferometer. Interference fringes, from which the phase difference can be determined,

1In practice, the transmissions are not determined in this step-by-step process, but instead all measured (logarithmic)
transmission data is ﬁtted simultaneously by using 15-th order polynomials in l
for Ti←2(l ) and Y (l ). This is done
through linear ﬁtting via LU decomposition. The ﬁnal results do not depend signiﬁcantly on the order of the polynomial
as long as the order is high enough to follow the overall proﬁle, but low enough to ﬁlter out the ﬁne fringes. The small
upturns near 1570 nm in the curves shown in Fig. 4(a) are artifacts of the polynomial ﬁts due the end of the data range.
2The maximum transmission in Fig. 4(b) is ∼ −32dB. This value is lower than typical for our SiN devices (∼
−15dB) since the ﬁber array was kept far away from the sample to prevent any accidental touching or scratching while
scanning the entire chip. Note that none of the results presented here depend on the absolute transmission.

(a)

(b)

(d)

r
e
t
u
o

r
e
n
n

i

r
e
n
n

i

r
e
t
u
o

m
u
 
0
0
1

left

input

right

left

input

right

10 um

(c)

(e)

(f)

t
h
g
i
r

t
f
e

l

Fig. 5. (a) optical micrograph of a device to determine the phase difference between the two
outputs of a directional coupler (b,d) schematics of the two type of interferometers. The left
(right) MZI is indicated in blue (orange). The colorized electron micrograph on the right
side of (d) shows the central area of a device with a directional coupler. (c,e) MZI fringes
measured at the two outputs of the device (light blue, orange) together with ﬁts (blue and
black lines) to determine the periods and wavelength shift. The phase of the fringes relative
to the fringes of the left MZI is indicated on the top axis. Panels (a) to (c) show a reference
device, and (d) and (e) are for a device with a directional coupler with an interaction length
of 8m m. (f) Phase difference between the two interferometers.

are measured by detecting the intensities at the outputs of the two unbalanced MZIs while
sweeping the wavelength. These relative-phase measurements are performed on two different
types of devices: one that consists of symmetric, uncoupled MZIs [Fig. 5(b)], and a second type
where the inner arms are connected via a directional coupler [Fig. 5(d)]. As shown in Fig. 5(c)
the fringes of the symmetric, uncoupled device overlap, indicating that the phase difference
f R, is small. These symmetric devices serve as validity
between two interferometers, D
checks of the method because they demonstrate that our interferometers have identical phase-
stable path lengths. In other words, the waveguides in different parts of our circuits can be
controlled to have propagation-phase differences ≪ p .

f L − D

In the second type of device [Fig. 5(d,e)] a directional coupler connects the two inner arms

21 − 6 S′

11.

of the interferometers. Light from the left inner arm is split between the left and right interfer-
ometers via the directional coupler; no light from the right side enters the directional coupler.
The phase of light that propagated through the outer arms is f outer,L(R). The phase of light in
the inner arms f inner,L(R) consist of two parts: Firstly, the phase f p,L(R) accumulated by prop-
agating from the bottom splitter to the directional coupler and from the directional coupler to
the top of the interferometer where it combines with light that has traveled through the outer
arms. The second contribution is the phase due to the directional coupler, which is given by
the argument of the corresponding element of its scattering matrix. The phase differences are
21) − f outer,L(R). Apart from the connections to the directional
thus D
coupler all elements of the device are designed entirely symmetric and thus f p,L = f p,R and
f outer,L = f outer,R as was veriﬁed with the symmetric devices. Now, a relative shift between the
two fringes indicates that there is a phase difference between the two outputs of the directional
coupler since D

f L(R) = f p,L(R) + 6 S′

11(6 S′

f L = 6 S′

f R − D

21 − 6 S′

A shift between the fringes is indeed visible in Fig. 5(e); the fringes of the right interferometer
are at shorter wavelengths compared to those of the left MZI. Since a full fringe period corre-
sponds to a 2p change in D
f L(R), the wavelength shift can be converted to a relative phase shift3
f L as indicated on the top axis of panels (c) and (e). By ﬁtting the fringes, both the fringe
f R −D
l and the wavelengths of the maxima l (L,R) can be determined. Using the period and
period D
l .
position of the fringes the phase difference is obtained: 6 S′
The result for devices with different interaction lengths (i.e. splitting ratios) is shown in Fig.
5(f). The symmetric devices are close to zero phase difference, whereas the directional-coupler
MZIs are all close to p /2. The mean value of the latter is +0.54p with a standard deviation of
0.04p , indicating that the light picks up a factor of i when crossing over to the other side of the
beam splitter4. This is also conﬁrmed by the FEM simulation shown in the inset of Fig. 2(a)
where the ﬁeld in the bottom waveguide is shifted by p /2 compared to the top one. Note that
although Fig. 5(f) shows that the phase difference is independent of the interaction length, this
is only valid up to the ﬁrst maximum in C [cf. Fig. 2(d)]. After each maximum, an additional
p phase shift is acquired and the phase difference would be −p /2. The phase shift would also
change sign if the effective refractive index of the even mode were smaller than that of the odd
mode [i.e. the reverse of the situation in Fig. 2(c)]. In any case, the devices that are used in this
work are thus accurately described by the scattering matrix

11 = 2p (l max

L − l max

)/D

R

S′ =(cid:18) t

ic

ic

t (cid:19) ,

(5)

where t is the transmission coefﬁcient, and c = (1 − t2)1/2 is the cross-over coefﬁcient. By
21 = iC1/2 when S′
comparing Eq. (5) with Eq. (2) we identify t = S′
11
is real and positive.

22 and ic = S′

11 = S′

12 = S′

8. Characterization of a quantum circuit

The directional coupler characterization in Sections 5 to 7 shows that with careful calibration
the transmission through the device reveals the splitting ratio, phase shifts, and insertion loss.
This approach also works for more complex photonic circuits [48], such as, for example, the
controlled-NOT circuit [2] shown Fig. 6. A CNOT gate is a quantum operation that acts on two
3The convention where the optical ﬁeld is proportional to exp(−iw t) is used. In this case the phase of light propa-
gating in, say, the +x direction is f p = +2p neffx/l . Since the outer arms are the reference arms, the phase difference is
deﬁned as D
p/¶l = −f p/l
(without dispersion), the phase difference increases with increasing wavelength.

f = f inner −f outer. The outer arm is longer than the inner arm and hence D

f < 0. Since ¶f

4Although in a general beam splitter any value of the phase difference is allowed (with constraints on their combi-

nation), for a symmetric design such as our directional coupler, only −p /2 and +p /2 are possible [46].

D
qubits, the so-called control and target qubit. When CNOT gates are combined with single-qubit
operations, any arbitrary unitary quantum operation on any number of qubits can be performed
[3]. In this section the transmission of classical light through a CNOT circuit is investigated.
Using the obtained scattering matrix its quantum behavior is predicted.

A CNOT ﬂips its target qubit |0it ↔ |1it when the control qubit is in the logical quantum
state |1ic, but leaves the target qubit unchanged when the control qubit is in the logical zero
state |0ic. The linear-optics implementation of Fig. 6 relies on post selection, i.e., the outcome
is nondeterministic, and the probability of success of the two-qubit operation is 1/9 [2]. Each
qubit is encoded in the spatial-mode degree of freedom (i.e. waveguide) that a single photon
takes. The four inputs are labeled 1..4 [see Fig. 6(a)] and represent the logical states |1ic, |0ic,
|1it, and |0it respectively; the upper two ports thus form the control qubit whereas the lower
two ports are the target qubit. In the case where the control qubit is in the |1ic state (i.e. the
photon is in waveguide 1), the target-qubit and control-qubit photon are in different parts of
the circuit and thus do not interfere with each other. The target qubit is ﬂipped (goes to the
other waveguide) by the sequence of the two 50/50 beam splitters (unless it crosses over in a
C = 2/3 directional couplers; those cases are excluded via post selection). On the other hand,
when the control qubit is in the |0ic state, the two photons are in the same part of the circuit.
Their interference at the central C = 2/3 directional coupler ensures that after post selection [2]
the target photon is found in the same output waveguide as where it came from. In this case,
the target qubit remains unchanged. The desired result is thus obtained for every value of the
control qubit.

Since the operation of the CNOT relies on interference at the central beam splitter, it requires
precise control over the splitting ratios of the directional couplers and phase stability of the opti-
cal paths. In an integrated circuit path length control is readily achieved as shown in Sec. 7. Yet
it is imperative to conﬁrm that after fabrication of the device the circuits perform as designed,
i.e. that the splitting ratios of all the directional couplers are correct. In a bulk optics experi-
ment this can easily be veriﬁed by placing photodetectors in the paths of interest and measuring
the relative powers. In a photonic circuit that is not as straightforward and one is often limited
to using the input and output ports for characterization, although recently characterization of
circuits using imaging of scattered light from the top has been reported [49].

As shown in Fig. 6(a) our device has four inputs and four outputs and hence its (reduced)
scattering matrix consists of 16 elements. Devices connecting different combinations of input
i j|2 is measured. As
j and output ports i are fabricated and their normalized transmission |S′
41|2 [which should be, and is, zero as is
an example, Fig. 6(b) shows a device to measure |S′
readily veriﬁed from the schematic in Fig. 6(a)]. All combinations are shown in Fig. 6(c) and
these should be compared with the transmission matrix of an ideal CNOT shown in Fig. 6(d).
The latter has 8 elements which are 1/3 and the other 8 are zero. The experimental data looks
similar, but some deviations that will be studied in more detail below can be seen.

By cascading the scattering matrices of all the individual components of the CNOT circuit,
one can also calculate the total transmission amplitudes as a function of the splitting ratios of
the directional couplers that are ideally 1/2 and 2/3 [see Fig. 6(a)]. The actual splitting ratios of
the two types of directional couplers, C1/2 and C2/3 respectively, are determined by ﬁtting the
transmissions calculated via a model of the circuit to the experimental ones. Note that, given
the reproducibility of the directional couplers demonstrated in Sec. 5, the coupling ratios of
directional couplers with the same design are assumed to be identical in the ﬁtting procedure.
The model transmissions are calculated using the cascaded scattering matrices of the individual
components of the circuit. The ﬁtting is done for the devices of Fig. 6, as well as for a second
set of similar devices. The ﬁts at l = 1554 nm [Fig. 6(c)] give C1/2 = 0.477 (0.480) and C2/3 =
0.676 (0.669) for the ﬁrst (second) set. The small variation in the ﬁt parameters between the two

measured

2/3

2/3

2/3

(c)

’

1

2

3

4

1/2

output i

ideal CNOT

(d)

’

output i

output

λ = 1554 nm

input j

output i

input j

(f)

0.6

5
.9

0.55

2
/
1
c

0.5

0 . 9 9

0

.

9

9

0.999

0.45

0

.

9

7

.

9

5

0.4

0.6

7
0.9

5
9
.
0

0.65

0.7

0.75

c2/3

(a)
1

2

3

1/2

4
input j

(b)

input

0.4

(e)

2

|
’

j
i

S

|

0.3

0.2

0.1

0

Data
Fit
Ideal

1

1

1

1

2

2

2

2

3

3

3

3

4

4

4

4

→

→

→

→

→

→

→

→

→

→

→

→

→

→

→

→

1

2

3

4

1

2

3

4

1

2

3

4

1

2

3

4

Combination j® i

Fig. 6. (a) Schematic of a CNOT gate for linear-optics quantum computation. The port
number and the cross-over ratios of the directional couplers are indicated. (b) Micrograph
41|2. The waveguide above the CNOT gate is used to locate the
of a device to measure |S′
device as some combinations (including this one) have zero transmission. This auxiliary
waveguide does not inﬂuence the actual CNOT circuit. (c) Measured normalized transmis-
sion matrix and that for an ideal CNOT gate (d). (e) Bar chart comparing the measured
data [cf. (c)], the ﬁt, and the transmission for an ideal CNOT gate [cf. (d)]. (f) Calculated
ﬁdelity, i.e. the probability of obtaining the right result after post selection vs. C1/2 and
C2/3. The dot indicates the ﬁtted values of (e), and the cross is located at the ideal values.

datasets again illustrates the excellent reproducibility of our integrated nanophotonic circuits.
Also, the scattering matrices of the measured device and the ﬁt are very similar: The mean of the
absolute deviation between the measured and the ﬁtted transmission is 0.02 for both datasets.
This value corresponds to ﬂuctuations of about 0.1 dB in the measured transmission and is
comparable to the stochastic ﬂuctuations measured in the transmission of calibration devices.
The small deviations between the ﬁt and measurement can thus be attributed to measurement
uncertainties. The deviations between the ﬁt and the transmission of an ideal CNOT are even
smaller: 0.009 and 0.006 respectively. This shows the ability to build more complex quantum
circuits.

As discussed above, the outcome of a CNOT gate as in Fig. 6(a) is post selected when for
both qubits a single photon is detected in just one of the two waveguides representing |0i and |1i
[2]. For the ideal design this occurs statistically in 1/9 of the attempts. After post selection, the
ideal gate always yields the right outcome (its ﬁdelity is 1). However, since the splitting ratios
are in practice slightly different from the ideal values, the gate ﬁdelities and the probabilities
of getting a post-selected event will also be different [43]. The ﬁnal state |y outi for an input

ˆU † = (cid:229)

j S jia†

ini is given by |y outi = ˆU |y

state |y
ini, where ˆU is a unitary operator that is directly related
to the classical scattering matrix of the linear circuit [50, 51] through the transformation of the
creation operators of mode i: ˆUa†
j. Using this formalism, the quantum behavior
i
of the circuit can be predicted, in particular it can be used to estimate how often the circuit
gives the right result (i.e. the outcome expected from the truth table) [43]. Figure 6(f) shows a
contour plot of the probability of the right outcome as a function of the two splitting ratios in
the circuit, averaged over the input states |00i ≡ |0ic ⊗ |0it, |01i, |10i, and |11i. Exactly at the
target values the ﬁdelity is 1, but this value drops when moving away from this ideal case. For
the ﬁtted values C1/2 = 0.477 and C2/3 = 0.676 [as indicated by the dot in Fig. 6(f)] the right
outcome occurs 99.81% of the time and the probability of obtaining a post-selectable output
state is 10.95% (compared to 1/9 ≈ 11.11% for the ideal case). The nonideal splitting ratios
thus only give a modest reduction of the ﬁdelity of the CNOT gate. For the second dataset we
obtain 99.92%, and using the values from the directional couplers (Sec. 5) 99.993%. We note
that with such high values, in the future, the quantum process ﬁdelity will probably be limited
by the purity of the single photon source and not by the gate operation.

9. Conclusion

Targeting integrated linear optics quantum circuits in a silicon-nitride material platform, we
have developed several essential components and established a detailed calibration procedure
for each of them. By measuring the length dependence of the splitting ratio of directional cou-
plers, the coupling length and offset length are determined, as well as their wavelength depen-
dence. Also the phase difference between the transmitted and reﬂected light is studied, and
the insertion loss is found to be small. By measuring and ﬁtting the optical transmission be-
tween different pairs of ports of a CNOT gate, the splitting ratios of each of its constituents are
found. The values obtained from our ﬁtting procedure are close to the ideal values, indicating
that the quantum operation should have a high ﬁdelity. The fabrication process ﬂow for these
devices is entirely compatible with integration of SNSPDs and opto-electromechanical phase-
shifters. This enables operation of monolithically integrated programmable quantum circuits
with highly efﬁcient superconducting detectors on the same chip. The next step is to build cir-
cuits that combine initialization, computation, tomography, and detection, and use nonclassical
light to perform the desired quantum operations. With the integrated approach, more complex
operations are certainly possible and the ultimate goal of a universal quantum computer based
on LOQC may be within reach.

Acknowledgments

This work was partly funded by the Packard Foundation. C.S. acknowledges ﬁnancial support
from the Deutsche Forschungsgemeinschaft (SCHU 2871/2-1). H.X.T. acknowledges support
from a career award from National Science Foundation. Facilities used were supported by Yale
Institute for Nanoscience and Quantum Engineering and NSF MRSEC DMR 1119826.

