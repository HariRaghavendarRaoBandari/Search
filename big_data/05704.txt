6
1
0
2

 
r
a

 

M
7
1
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
4
0
7
5
0

.

3
0
6
1
:
v
i
X
r
a

A generalization of circulant Hadamard and conference matrices

Ondˇrej Turek

Nuclear Physics Institute, Academy of Sciences of the Czech Republic

250 68 ˇReˇz, Czech Republic

Bogolyubov Laboratory of Theoretical Physics, Joint Institute for Nuclear Research

141980 Dubna, Russia

Laboratory of Uniﬁed Quantum Devices, Kochi University of Technology

Kochi 782-8502, Japan

email: o.turek@ujf.cas.cz

Dardo Goyeneche

Faculty of Physics, Warsaw University, Pasteura 5, 02-093, Warsaw, Poland

Faculty of Applied Physics and Mathematics, Technical University of Gda´nsk

80-233 Gda´nsk, Poland

Institute of Physics, Jagiellonian University, Krak´ow, Poland

email: dgoyeneche@cefop.udec.cl

March 21, 2016

Abstract

We study the existence and construction of circulant matrices C of order n ≥ 2 with diagonal
entries d ≥ 0, oﬀ-diagonal entries ±1 and mutually orthogonal columns. Matrices C with d on the
diagonal generalize circulant conference (d = 0) and circulant Hadamard (d = 1) matrices. We
demonstrate that matrices C exist for every order n and for d chosen such that n = 2(d + 1), and
we ﬁnd all solutions C with this property. Furthermore, we prove that if C is symmetric, or n − 1
is prime, or d is not an odd integer, then the relation n = 2(d + 1) holds. Finally, we conjecture
that n = 2(d + 1) holds for any matrix C, which generalizes the circulant Hadamard conjecture. We
support the conjecture by computing all the existing solutions up to n = 50.

1

1

Introduction

A circulant matrix is a square matrix in which each row is obtained as a cyclic shift of the precedent row
by one position to the right. That is, a circulant matrix of order n takes the form

C =

c0

cn−1
...

c2
c1





c1
c0

cn−1

c2

···
c1

c0
. . .
···

cn−2

. . .
. . .
cn−1

cn−1
cn−2
...

c1
c0

.





(1)

A circulant matrix is fully speciﬁed by its ﬁrst row, (c0, c1, . . . , cn−1), which we call the generator of C.

Let us consider two special types of real circulant matrices, namely

• circulant Hadamard matrices, deﬁned by conditions cj ∈ {1,−1} for j = 0, 1, . . . , n − 1 and CCT =

nI (the superscript T denotes transposition);

• circulant conference matrices, deﬁned by conditions cj ∈ {1,−1} for j = 1, . . . , n − 1, c0 = 0 and

CCT = (n − 1)I.

The circulant Hadamard conjecture says that circulant Hadamard matrices exist only for n = 1 and
n = 4. The conjecture is open already for over half a century: according to Schmidt [19], “the conjecture
was ﬁrst mentioned in Ryser’s book [18] (1963), but goes back further to obscure sources”. Turyn [24]
proved in 1965 that n can only take values 4u2 for an odd u and derived further necessary conditions
on n. Schmidt [19, 20] showed that the circulant Hadamard conjecture is true for orders up to n = 1011
with three possible exceptions. On top of these results, it is known that a circulant Hadamard matrix
cannot be symmetric for n > 4 (Johnsen [14], Brualdi and Newman [6], McKay and Wang [17], Craigen
and Kharaghani [9]).

By contrast, the problem of existence of circulant conference matrices is fully solved. Stanton and
Mullin [22] demonstrated that circulant conference matrices only exist of order n = 2; later Craigen [8]
proposed a simpler proof of this fact.

The two kinds of matrices described above serve as a main motivation for our paper. We are concerned
with their common generalization, in which we allow the diagonal entries of the matrix C to take an
arbitrary value d ∈ R. For the sake of convenience, we assume d ≥ 0 without loss of generality, and we
exclude the trivial case n = 1. The aim of our work is thus to study matrices C deﬁned by the following
conditions:




C is a circulant matrix of order n ≥ 2 with generator (c0, c1, . . . , cn−1) ;
cj ∈ {1,−1} ∀ j = 1, . . . , n − 1 ;
c0 = d ≥ 0 ;
CCT = (d2 + n − 1)I .

(2)

Matrices C for d = 1 and d = 0 correspond to circulant Hadamard matrices and circulant conference
matrices, respectively. In this paper we ﬁnd all solutions of problem (2) for any value d ≥ 0 that is not an
odd integer. The case of d being odd involves the circulant Hadamard conjecture and is thus much harder;
for that case we conjecture that all matrices obeying conditions (2) satisfy the relation n = 2(d + 1). We
verify the conjecture up to n = 50.

2

There exists another generalization of circulant Hadamard and conference matrices called circulant
weighing matrices. A weighing matrix W of order n and weight k is an n × n matrix having entries
from the set {0, 1,−1} such that W W T = kI. Circulant weighing matrices and their classiﬁcation were
studied by several authors, see works of Eades and Hain [10], Arasu et al. [3, 2], Ang et al. [1].

To the best of our knowledge, the problem (2) has not been studied before. However, similar paramet-
ric matrix problems without the circulancy assumption were already considered. Seberry and Lam [21]
examined symmetric matrices with orthogonal columns having a constant m on the diagonal and ±1 oﬀ
the diagonal, and Lam [16] later extended the study to the non-symmetric case. Recently, Hermitian
unitary matrices with ±d on the diagonal and unit complex numbers oﬀ the diagonal were studied in
mathematical physics in relation to scattering in quantum graph vertices (Turek and Cheon [23], Kurasov
and Ogik [15]).

k=0

Our matrices are also closely related to Barker codes. A Barker code is a ﬁnite sequence of n numbers
{ck} with ck ∈ {−1, 1} and 0 ≤ k ≤ n − 1 such that it satisﬁes the equation |Pn−m−1
ckck+m| ≤ 1 for
every 0 ≤ m ≤ n − 1. It has been proven that only eight Barker codes exist for length n ≤ 13 [5], if
we assume c0 = c1 = 1 without loss of generality. Furthermore, the existence of a Barker code of length
n > 13 would imply that a circulant Hadamard matrix of size n exists (see [4, Chapter VI, §14]). This
means that Barker codes of length n > 13 necessarily imply perfect auto-correlation for the sequence.
We say that an auto-correlation is perfect ifPn−1
k=0 ckck+m mod n = 0 for every 1 ≤ m ≤ n − 1. Sequences
with low auto-correlation have a fundamental importance in radar signals theory [7], data transmission
and data compression [12]. It is thus interesting to search for new ﬁnite sequences having perfect auto-
correlation, in a similar way as Huﬀman generalized Barker codes [13]. With this aim, in the present
work we deﬁne sequences having the ﬁrst element c0 ≥ 0 with absolute value diﬀerent than one in general,
i.e., the sequence {ck} does not have all its elements with constant amplitude. This perturbation in the
amplitude of the signal allows us to ﬁnd interesting novel results for sequences of any length n. From the
point of view of correlations of ﬁnite sequences the main result of our paper can be stated as follows: We
ﬁnd the complete set of sequences {ck} of length n with c0 = n/2 − 1, ck ∈ {−1, 1} for 1 ≤ k ≤ n − 1
and having perfect auto-correlation. These sequences exist for every n ≥ 2. Furthermore, we conjecture
that every ﬁnite sequence of length n, with c0 ≥ 0, ck ∈ {−1, 1} for 1 ≤ k ≤ n − 1 and having perfect
correlation satisﬁes c0 = n/2 − 1. If this conjecture is true, then Barker codes of length n > 13 do not
exist.

The paper is organized as follows. In Section 2 we review basic properties of matrices C satisfying
conditions (2). In particular, we prove that a matrix C of order n with diagonal entries d exists only if
n ≥ 2(d + 1). In Section 3 we derive further necessary conditions and bring in additional results obtained
by a computer calculation. On the basis of our ﬁndings, we formulate a conjecture that extends the
circulant Hadamard conjecture. In Section 4 we prove that a symmetric matrix C with diagonal entries
d exists if and only if n = 2(d + 1). In Section 5 we ﬁnd all matrices C that obey conditions (2) and have
the property n = 2(d + 1). Finally, we summarize the most important results in Section 6.

2 Preliminaries

Let C be a circulant matrix of order n. Circulant matrices are diagonalized by the discrete Fourier
transform. The vectors

vk =

,

1

√n(cid:16)1, ωk, ω2k, . . . , ω(n−1)k(cid:17)T

3

where ω = e2πi/n, are normalized eigenvectors of C for all k = 0, 1, . . . , n − 1.
generator (c0, c1, . . . , cn−1), then the corresponding eigenvalues of C are

If the matrix C has

λk = c0 + c1ωk + c2ω2k + ··· + cn−1ω(n−1)k .

(3)

From now on we focus on circulant matrices C with generator (c0, c1, . . . , cn−1) satisfying conditions (2).
For the sake of convenience, we will adopt the following convention.
Convention 2.1. The rows and columns of C are indexed from 0 to n − 1, i.e., they will be refered to as
0th, 1st,. . . , (n − 1)th.

In the rest of the section we prove two useful propositions. The ﬁrst one relates the generator of C

to the diagonal d and the order n.

Proposition 2.2. If C satisﬁes conditions (2), then

Moreover, if n is even, then

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xj=0

n−1

n−1

cj(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
=pd2 + n − 1 .
Xj=0
(−1)jcj(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

=pd2 + n − 1 .

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(4)

(5)

Proof. The assumption CCT = (d2 + n− 1)I implies that the eigenvalues λk of C, given by equation (3),
obey |λk| = √d2 + n − 1 for all k = 0, 1, . . . , n − 1. In the special case k = 0 we obtain equation (4). If

n is even, then k = n

2 leads to equation (5).

The following proposition gives a basic restriction on the diagonal d.

Proposition 2.3. Let C satisfy conditions (2).

(i) If n is even, then d ≤ n
(ii) If n is odd, then d = n

2 − 1 and d ≡ n
2 − 1 and the generator of C has the form (d,−1,−1, . . . ,−1).

2 − 1 (mod 2).

Proof. (i) If n is even, the orthogonality between the 0th and the n
numbering introduced in Convention 2.1) implies that

2 th row of C (recall that we use the

2dc n

2

+ 2

We have cj ∈ {1,−1} and d ≥ 0; hence

n

2 −1

Xj=1

cjc n

2 +j = 0.

cjc n

.

(6)

Since cjc n
an integer less than or equal to n

2 +j ∈ {1,−1} for all j = 1, . . . , n

2 − 1, the expression on the right hand side of equation (6) is

2 − 1 and congruent to n

2 − 1 modulo 2.

n

2 −1

Xj=1

d =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

2 +j(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

4

(ii) Let n be odd. For any k ∈ {1, . . . , n − 1}, the scalar product of the 0th and kth row of C must

be zero, i.e.,

d(ck + cn−k) +

n−1

Xj=1

j6=n−k

cjc(j+k) mod n = 0 .

(7)

The sum P cjc(j+k) mod n on the left hand side contains an odd number of summands of type ±1;
therefore, it has a nonzero value. Equation (7) thus cannot be satisﬁed unless ck + cn−k 6= 0 for all
k = 1, . . . , n − 1. With regard to cj ∈ {1,−1}, we conclude that C must be symmetric.
Consider an arbitrary k ∈ {1, . . . , n − 1} and denote ck = cn−k = γ. We write down the 0th and kth

row of C and rearrange the columns in the following way:

We obviously have

d γ +1 ··· + 1 +1 ··· + 1 −1 ··· − 1 −1 ··· − 1
γ
−1 ··· − 1
|
}

d +1 ··· + 1
+1 ··· + 1
|
|
}
{z
}
ℓ1 + ℓ2 + ℓ3 + ℓ4 = n − 2 .

{z

−1 ··· − 1
|
}

{z

ℓ4

{z

ℓ1

ℓ2

ℓ3

.

Since C is circulant, every row of C has the same sum of elements, i.e.,

d + γ + ℓ1 + ℓ2 − ℓ3 − ℓ4 = γ + d + ℓ1 − ℓ2 + ℓ3 − ℓ4 .

Since C is orthogonal, the scalar product of the 0th and the kth row must be 0; hence

The system of equations (8)–(10) implies

2γd + ℓ1 − ℓ2 − ℓ3 + ℓ4 = 0 .

Consequently,

4ℓ2 = n − 2 + 2γd .

n − 2 + 2γd ≡ 0

(mod 4) .

(8)

(9)

(10)

(11)

If cj = 1 for all j = 1, . . . , n − 1, then the rows of C would not be orthogonal. Therefore, there must

exist a k such that ck = cn−k = −1. Equation (11) for γ = −1 leads to

If there was also a k′ such that ck′ = cn−k′ = +1, then, with regard to equation (11), we would have one
more equation, namely,

n − 2 − 2d ≡ 0

(mod 4) .

(12)

n − 2 + 2d ≡ 0

(mod 4) .

This equation together with equation (12) implies 2n−4 ≡ 0 (mod 4), which is obviously in contradiction
with the assumption that n is odd. We conclude that cj = −1 for all j = 1, . . . , n − 1, i.e., the generator
of C is (d,−1,−1, . . . ,−1). The scalar product of any two rows of such matrix C is equal to −2d + n− 2.
This quantity must be 0 due to the orthogonality. Hence we obtain d = n

2 − 1.

5

3 Relations between the order n and the diagonal d

As we have seen in Proposition 2.3, if a matrix C satisﬁes conditions (2), then its order n and the value
d on the diagonal are related. The aim of this section is to derive further restrictions that the pair (n, d)
has to obey. We start from a statement that follows straightforwardly from Proposition 2.3. The symbol
N0 used in the text denotes the set of non-negative integers.

Proposition 3.1. If a matrix C satisﬁes conditions (2), then 2d is an integer and n ≥ 2(d+1). Moreover,
we have:

• If d is an integer, then n is even and the equivalence (d is odd ⇔ n
• if d is a half-integer, then n is odd and n = 2(d + 1).

2 is even) holds;

Proof. Proposition 2.3 implies that 2d is an integer and (d is integer ⇔ n is even). We distinguish two
cases.

If d is an integer, n is even. Then Proposition 2.3 (i) gives the inequality n ≥ 2(d + 1) and the

equivalence (d is odd ⇔ n

2 − 1 is odd).

If d is a half integer, then n is odd and we use Proposition 2.3 (ii) to infer that n = 2(d + 1).

Remark 3.2. A matrix C obeying conditions (2) exists for every d ≥ 0 such that 2d is an integer. To see
the validity of the statement, it suﬃces to consider the generator (d,−1,−1, . . . ,−1) ∈ Rn for n = 2(d+1).
Proposition 3.3 below gives a useful necessary condition of the existence of matrices C for the case

when d is an integer.

Proposition 3.3. If a matrix C satisﬁes assumptions (2) and d ∈ N0, then

n = k(2d + k) + 1

for a certain k ∈ N.
Proof. From equation (4) we have

|d + c1 + ··· + cn−1| =pd2 + n − 1 .

(13)

(14)

Since cj ∈ {1,−1} for all j = 1, . . . , n − 1, the left hand side of equation (14) is an integer. Therefore,
there exists a k ∈ Z such that |d + c1 + ··· + cn−1| = d + k. With regard to the right hand side of
equation (14), k is positive. To sum up, we have d + k = √d2 + n − 1 for a certain k ∈ N. Hence we

obtain equation (13).

Corollary 3.4. If a matrix C of order n satisﬁes assumptions (2) and n − 1 is a prime number, then
d = n

2 − 1.

Proof. If n − 1 = 2, then n = 3 is odd and the statement follows from Proposition 2.3 (ii). From now
on let n − 1 be an odd prime. Since n is even, Proposition 2.3 (i) implies d ∈ N0. We can thus use
k − k(cid:1) for a certain k that divides n − 1. Since
Proposition 3.3. According to equation (13), d = 1
n − 1 is a prime number, we have k = 1, which leads to d = n

2(cid:0) n−1

2 − 1.

We are going to demonstrate that matrices satisfying conditions (2) for even values d on the diagonal
exist only of orders n = 2(d + 1). We derive at ﬁrst three auxiliary results on matrices C of orders n ≡ 2
(mod 4).

6

Proposition 3.5. If C satisﬁes conditions (2) and n ≡ 2 (mod 4), then C is symmetric.
Proof. We prove the statement by contradiction. Assume that n ≡ 2 (mod 4) and C is not symmetric.
Then there exists a j ∈ {1, . . . , n − 1} such that cj = 1 and cn−j = −1. We write down the 0th row and
the jth row of C and rearrange the columns as follows.

d +1 +1 ··· + 1 +1 ··· + 1 −1 ··· − 1 −1 ··· − 1
−1 ··· − 1
−1
|
}

d +1 ··· + 1
{z
}
ℓ1 + ℓ2 + ℓ3 + ℓ4 = n − 2 .
Furthermore, all rows of C have the same sum of elements, thus

+1 ··· + 1
|
}

−1 ··· − 1
|
}

We have

{z

ℓ4

{z

ℓ2

{z

|

ℓ1

ℓ3

d + 1 + ℓ1 + ℓ2 − ℓ3 − ℓ4 = −1 + d + ℓ1 − ℓ2 + ℓ3 − ℓ4 .

Finally, the scalar product of the two rows must be 0, i.e.,

ℓ1 − ℓ2 − ℓ3 + ℓ4 = 0 .
Solving the system of equations (15)–(17), we get in particular

ℓ2 =

n
4 − 1 .

.

(15)

(16)

(17)

Consequently, n is a multiple of 4. This contradicts the assumption n ≡ 2 (mod 4).
Proposition 3.6. If C satisﬁes conditions (2) and n ≡ 2 (mod 4), then d ≡ n
Proof. According to Proposition 3.5, the matrix C is symmetric. Hence cn−j = cj for all j = 1, . . . , n− 1.
Therefore, the 0th and the n

2 − 1 (mod 4).

2 th row of C read

d
c n
2

c1
c n

2 −1

c2
c n

2 −2

···
···

c n
2 −1
c1

c n
2
d

c n
2 −1
c1

···
···

c2
c n

2 −2

c1
c n

2 −1

.

The two rows must be orthogonal, which implies

2dc n
2

+ 2

n

2 −1

Xj=1

cjc n

2 −j = 0 .

Since c n

2 ∈ {1,−1} and d ≥ 0, we get

Xj=1
The assumption n ≡ 2 (mod 4) gives the identity

n

2 −1

d =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

cjc n

.

(18)

therefore, we can rewrite equation (18) in the form

n

2 −1

Xj=1

cjc n

2 −j = 2

cjc n

2 −j ;

n−2

2 −j(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
4Xj=1
2 −j(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

cjc n

.

d
2

n−2

4Xj=1

=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

7

Since the sum on the right hand side has the same parity as the number n−2
Hence we get trivially d ≡ n

2 − 1 (mod 4).

4 , we have d

2 ≡ n−2

4

(mod 2).

n
2




c2j−1


Xj=1
j=0 c2j, b =P n
(a + b)2 = d2 + n − 1 ,

2 −1

Proposition 3.7. If C satisﬁes conditions (2) and n ≡ 2 (mod 4), then

2

= d2 + n − 1 .

(19)

Proof. Let us denote a =P n

2

j=1 c2j−1. Equations (4) and (5) imply

(a − b)2 = d2 + n − 1 .

Hence we get an alternative

(cid:0)a = 0 ∧ b2 = d2 + n − 1(cid:1) ∨ (cid:0)b = 0 ∧ a2 = d2 + n − 1(cid:1) .
2 summands of type ±1 and n

Since b consists of n
b 6= 0. Therefore, a = 0 and b2 = d2 + n − 1, as we set to prove.

2 is odd due to the assumption n ≡ 2 (mod 4), we have

Now we are ready to prove a result on matrices C with the diagonal entries d equal to an even
integer. Theorem 3.8 below generalizes a theorem of Stanton and Mullin [22] which says that a circulant
conference matrix exists only for n = 2. The idea of the proof is based on [22].

Theorem 3.8. If a matrix C satisﬁes conditions (2) and d is an even integer, then n = 2(d + 1).

Proof. First of all we realize that if d is even, then n ≡ 2 (mod 4) according to Proposition 3.1. Then we
2 − 1(cid:9)
have that C is symmetric due to Proposition 3.5. The 0th row of C and the ℓth row for ℓ ∈(cid:8)1, . . . , n

thus take the form

d
cℓ

c1
cℓ−1

···
···

cℓ−1
c1

cℓ
d

cℓ+1
c1

···
···

c n
2
c n

2 −ℓ

Their scalar product shall be zero, i.e.,

2 −1

c n
c n

2 −ℓ+1

···
···

c n
2 −ℓ+1
c n

2 −1

c n
2 −ℓ
c n
2

···
···

c1
cℓ+1

.

2dcℓ +

ℓ−1

Xj=1

cjcℓ−j + 2

n

2 −ℓ

Xj=1

cjcj+ℓ +

n

2 −1

Xj= n

2 −ℓ+1

cjcn−ℓ−j = 0 .

(20)

From now on let ℓ be odd. We have ℓ = 2h + 1 for a certain h, and

With regard to these two identities, equation (20) implies

Let us denote the sum appearing on the right hand side of equation (21) by S, i.e.,

cjcℓ−j = 2

ℓ−1

Xj=1

cjcℓ−j ;

h

n

Xj=1
Xj= n

2 −1

2 −h

cjcn−ℓ−j = 2

cjcn−ℓ−j .

2 −ℓ+1

n

2 −1

Xj= n
d =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Xj=1

2 −ℓ

n

cjcℓ+j +

cjcℓ−j +

h

Xj=1

n

2 −1

Xj= n

2 −h

.

cjcn−ℓ−j(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

S :=

n

2 −ℓ

Xj=1
|

cjcℓ+j

+

S1

{z

}

h

Xj=1
|

cjcℓ−j

+

}

S2

{z

8

2 −h

n

2 −1

Xj= n
|

cjcn−ℓ−j

.

S3

{z

}

(21)

(22)

The sum S consists of products cicj for i, j ∈ {1, . . . , n
i, j ∈ {1, . . . , n
V = {1, . . . , n

2}. It is easy to see that each product cicj for
2} occurs at most once in S. Let us deﬁne a graph G = (V, E) with the set of vertices
2} and the set of edges E given by the condition

{i, j} ∈ E ⇔ the product cicj is a summand of S.

The graph G has the following properties: (i) Vertex ℓ is incident with only one edge in E; (ii) vertex n
2
is incident with only one edge in E; (iii) each vertex in the set {1, . . . , n
2 − 1}\{ℓ} is incident with two
edges in E. The properties are obvious from the following facts:

• If j ∈ [ℓ + 1, n

cjcj+ℓ and cj−ℓcj.

2 − ℓ], then the factor cj occurs only in summands of S1, namely, in the products

• If j ∈ [1, ℓ − 1], then the factor cj occurs once in S1 in the product cjcj+ℓ and once in S2 in the

product cjcℓ−j.

• If j ∈ [ n

2 − ℓ + 1, n

in the product cjcn−ℓ−j.

2 − 1], then the factor cj occurs once in S1 in the product cj−ℓcj and once in S3

• The factor cℓ occurs only in the sum S1, namely, in the product cℓc2ℓ.
• The factor c n

occurs only in the sum S1, namely, in the product c n

2

2 −ℓc n

2

.

Properties (i)–(iii) imply that the graph G consists of connected components of two types:

• a simple path P = (v0, v1, . . . , vL) with v0 = ℓ and vL = n
2 ;
• a certain number (possibly zero) of simple cycles Rk = (v(k)
0 , v(k)
Lk , where
k ∈ K. Elements of K index the set of simple cycles in G. If the graph G is connected, then G
consists of the simple path P and the set K is empty.

Lk ) with v(k)

1 , . . . , v(k)

0 = v(k)

The lengths L and Lk, as well as the number of simple cycles (the cardinality of K) are not important
for our considerations.

Since the summands of S represent the edges of G, we can rearrange them to follow the order of edges

on the path P and on the cycles Rk,

S =

L−1

Xi=0

cvi cvi+1 + Xk∈K

Lk−1

Xi=0

cv(k)

i

cv(k)

i+1

.

(23)

The sum S contains n

2 − 1 terms of type ±1, cf. equation (22). Therefore, S = n

the total number of negative summands in S. Moreover, S is an even integer, because n
to the assumption n ≡ 2 (mod 4). Equation (21) says that d = |S|, i.e.,

2 − 1 − 2s, where s is
2 − 1 is even due

(24)

The left hand side of equation (24) satisﬁes d ≡ n
hand side of equation (24) is an even integer; hence obviously | n
these two facts, we obtain n
i.e., the sum S must contain an even number of negative summands.

2 − 1 (mod 4) according to Proposition 3.6. The right
2 −1−2s (mod 4). Combining
2 − 1 − 2s (mod 4), i.e., 2s ≡ 0 (mod 4). This means that s is even,

2 −1−2s| ≡ n

2 − 1 ≡ n

d =(cid:12)(cid:12)(cid:12)

n

2 − 1 − 2s(cid:12)(cid:12)(cid:12) .

9

Equation (23) implies that the number of negative summands in S is equal to the number of sign
, . . . , cv(k)
contains

changes in the sequence cv0 , . . . , cvL plus the number of sign changes in all the sequences cv(k)
for k ∈ K. Since v(k)
, . . . , cv(k)

Lk for each k (recall that Rk is a cycle), each sequence cv(k)

0 = v(k)

an even number of sign changes. Therefore, there must be an even number of sign changes in the sequence
cv1 , . . . , cvL as well. This requirement is equivalent to cv0 = cvL . We have v0 = ℓ and vL = n
2 , whence we
get the condition

0

0

L

L

k

k

cℓ = c n

2

.

(25)

Equation (25) is valid for any odd number ℓ = 1, 3, . . . , n
all i = 1, . . . , n

2 ; therefore, equation (25) is satisﬁed also for ℓ = n

2 − 2. The symmetry of C means ci = cn−i for

2 + 2, . . . , n − 3, n − 1. Consequently,

At the same time we have, due to Proposition 3.7,

n
2

Xj=1

c2j−1 =

n
2

c n

2

.

(26)

n

2




= d2 + n − 1 .

c2j−1
2Xj=1

Equations (26) and (27) imply d2 + n − 1 =(cid:0) n
2(cid:1)2
Recall that whenever 2d ∈ N0, there exists a matrix C of order n = 2(d+1) that satisﬁes conditions (2)
for that value of d (cf. Rem. 3.2), and the matrix can be chosen symmetric. As we will see in Section 5,
matrices C of order n = 2(d + 1) can be fully characterized. The situation is, however, very diﬀerent for
matrices C of order n > 2(d + 1). Proposition 3.1 and Theorem 3.8 disprove their existence for any d
being a non-integer or an even integer, respectively, and Proposition 3.3 poses further restrictions on n.
For example, up to n = 50, all pairs (n, d) with n > 2(d + 1) are excluded except for

; hence d = n

2 − 1.

(27)

(16, 1), (28, 3), (36, 1), (40, 5) .

We carried out a computer calculation, which conﬁrmed that there is no solution for any of the pairs
(n, d) in the above list. In other words, up to the order n = 50 there is no matrix C obeying conditions (2)
with n 6= 2(d + 1).

Our ﬁndings lead us to establishing the following conjecture.

Conjecture 3.9. A circulant matrix C of order n ≥ 2 having the generator (d, c1, . . . , cn−1) with d ≥ 0
and cj ∈ {1,−1} for all j = 1, . . . , n − 1 satisﬁes the condition CCT = (d2 + n− 1)I only if n = 2(d + 1).
Remark 3.10. Let us summarize facts concerning the validity of Conjecture 3.9.

• We proved the conjecture in situations when d is a half-integer (cf. Prop. 3.1), as well as when d is

even (cf. Thm. 3.8).

• If 2d is not an integer, the conjecture remains valid as well. Indeed, formula n = 2(d + 1) gives an
n /∈ N in this case, implying that a matrix C with diagonal d does not exist, which is consistent
with the statement of Proposition 3.1.

• As a result of performed computer calculations, the conjecture is conﬁrmed for matrices C of orders

up to n = 50.

10

• Conjecture 3.9 generalizes the circulant Hadamard conjecture. Indeed, the relation n = 2(d + 1)
applied on the special case d = 1 means that circulant Hadamard matrices of order n ≥ 2 exist only
for n = 4.

4 Symmetric solutions

, c n

2 −1, c n

Proof. Since d is an odd integer, n is even due to Proposition 3.1. Equation (4) then implies that

In this section we prove that if a matrix C satisfying conditions (2) is symmetric, then the order n ≥ 2 of
C is related to the value d on its diagonal by equation n = 2(d + 1). Our result generalizes the well-known
theorem about the nonexistence of symmetric circulant Hadamard matrices of order n > 4.
Proposition 4.1. If a matrix C satisﬁes assumptions (2) for an odd d and C is symmetric, then d2 − 1
is divisible by 2√d2 + n − 1.
√d2 + n − 1 is an even integer; let us denote this integer by ℓ. If C is symmetric, it has a generator
2 −1, . . . , c1). Following an idea from [8, proof of Thm. 8], let us consider a circulant
(d, c1, . . . , c n
2 −1). The matrix M is obviously symmetric.
matrix M with the generator (c n
2
Furthermore, since CCT = (d2 + n − 1)I and M = P C for a certain permutation matrix P , we have
M M T = (d2 +n−1)I. Therefore, M has eigenvalues ±ℓ for ℓ = √d2 + n − 1. If we denote the multiplicity
of the eigenvalue +ℓ of M by m, the sum of eigenvalues of M is 2(cid:0)m − n
2(cid:1) ℓ. At the same time the sum
. Comparing these quantities, we obtain 2ℓ | n. Now we
of eigenvalues of M is equal to Tr(M ) = nc n
2
express n in terms of ℓ, i.e., n = ℓ2 + 1 − d2. Since ℓ is even, we have 2ℓ | ℓ2. This allows us to transform
the condition 2ℓ | (ℓ2 + 1 − d2) into 2ℓ | (d2 − 1).
Example 4.2. Proposition 4.1 implies that a symmetric matrix C satisfying (2) with d = 3 exists only
for n = 8. Indeed, 2√33 + n − 1 | (32 − 1) requires √8 + n = 4; hence n = 8.

2 −1, . . . , c1, d, c1, . . . , c n

2

, c n

Now we will take advantage of an idea of McKay and Wang [17], which they used for disproving
the existence of symmetric Hadamard matrices of order n > 4. Namely, they found a strong inequality
that relates the order n of a symmetric circulant Hadamard matrix with the prime factorization of n.
Following their approach, we prove a similar inequality valid for matrices C with a general d ∈ N on
the diagonal. The inequality, derived in Proposition 4.3 below, relates the prime factorization of n to
the integer k appearing in formula (13). Recall that according to Proposition 3.3, matrices C satisfying
conditions (2) can be only of orders n = k(2d + k) + 1, where d is the value on the diagonal and k ∈ N.
Proposition 4.3. Let a symmetric matrix C satisfy assumptions (2) with d ∈ N and n = k(2d + k) + 1
for a certain k ∈ N. Let n = qα1

be the prime factorization of n. Then

2 ··· qαr

1 qα2

r

Proof. We will proceed in the same way as McKay and Wang did in [17, Proof of Thm. 3], with just
minor modiﬁcations that are required with regard to the generality of d.

The ﬁrst step consists in proving the implication

k + 1 ≤ 2r .

(28)

gcd(j, n) = m ⇒ cj = cm .

(29)

For each m | n we deﬁne the polynomial

Pm(x) = c0 + c1x + c2x2 + ··· + cn−1xn−1 − λm ,

11

where λm are eigenvalues of C, given by formula (3). Since C = CT and CCT = (d2 + n − 1)I, the
eigenvalues of C satisfy λm = ±√d2 + n − 1. The assumption n = k(2d + k) + 1 for a certain k ∈ N then
gives λm = ±(d + k) ∈ Z for all m. Therefore, the polynomial Pm(x) has integer coeﬃcients for each m.
Furthermore, Pm(ωm) = λm − λm = 0 for every m, where ω = e2πi/n.

Let ΦN (x) denote the N th cyclotomic polynomial. Then ΦN (e2πiK/N ) = 0 for every K ∈ {0, 1, . . . , N−
m (ωm) = 0. Since Pm(ωm) = 0 and

m and K = 1, we get Φ n

1} satisfying gcd(K, N ) = 1. If we set N = n
ΦN (x) is irreducible by deﬁnition, necessarily Φ n

m (x) | Pm(x).

The fact Φ n
If we set N = n
we infer Pm(e2πij/n) = 0. This means λj − λm = 0, i.e., λj = λm.

m (x) | Pm(x) implies that Pm(x) = 0 whenever Φ n
m and K = j

m , we have gcd(K, N ) = 1

m (x) = 0. From now on let gcd(j, n) = m.
m (e2πij/n) = 0. Hence

m gcd(j, n) = 1. Therefore, Φ n

Since the vector (λ0, λ1, . . . , λn−1)T is obtained by the discrete Fourier transform (DFT) of (c0, c1, . . . , cn−1)T

and DFT is an invertible transformation, we have λj = λm ⇒ cj = cm. We conclude: If gcd(j, n) = m,
then cj = cm.

Let us proceed to the second step. We keep following the approach of McKay and Wang, slightly
modiﬁed to ﬁt our problem. Equation (3) together with equation (29) allows us to express the eigenvalue
λ1 of C in the form

λ1 = c0 +

n−1

Xj=1

cjωj = c0 + Xm|n

1≤m≤n−1

cm
 Xgcd(j,n)=m

1≤j≤n−1

ωj


,

(ωm)q ,

where c0 = d. We have

Xgcd(j,n)=m

1≤j≤n−1

ωj = Xgcd(q, n

1≤q≤ n

m )=1
m −1

which is the sum of primitive n
this sum is equal to µ( n

m ), where µ is the M¨obius function. Therefore,

λ1 = d + Xm|n

1≤m≤n−1

m(cid:17) .
cmµ(cid:16) n

Since µ(1) = 1, we can rewrite the equation in the form

λ1 = d − 1 + µ(1) + Xm|n

1≤m≤n−1

m(cid:17) .
cmµ(cid:16) n

m th roots of unity. According to a classical formula (cf. [11, eq. (16.6.4)]),

We have |λ1| = d + k, d ∈ N and |cj| = 1 for all j ≥ 1. Therefore, equation (30) implies

Hence

d + k ≤ d − 1 + Xm|n

|µ(m)| .

1≤m≤n

(cid:12)(cid:12)(cid:12)µ(cid:16) n
m(cid:17)(cid:12)(cid:12)(cid:12) = d − 1 + Xm|n
k + 1 ≤ Xm|n

|µ(m)| .

1≤m≤n

1≤m≤n

Let n = qα1

1 qα2

2 ··· qαr

r be the prime factorization of n. By deﬁnition of µ, we have

1,

0,

|µ(ℓ)| =


if ℓ is a square-free positive integer;

if ℓ has a squared prime factor.

12

(30)

(31)

1 qα2

2 ··· qαr

Therefore, if n = qα1
of subsets of {q1, . . . , qr}, i.e., to 2r. Hence we obtain inequality (28).
Remark 4.4. The original inequality of McKay and Wang, derived for d = 1 and n > 1, reads √n ≤ 2r.

r , the sum on the right hand side of inequality (31) is equal to the number

A technical Lemma 4.5 below contains a result that will be important two times in the sequel. At
ﬁrst, it will allow us to estimate n in the proof of Proposition 4.6. Secondly, it will be crucial for reducing
the proof of Proposition 4.7 to an examination of a ﬁnite number of cases.

Let us recall that the existence of matrices C satisfying conditions (2) of orders n 6= 2(d + 1) is
generally impossible whenever d /∈ N0 or d is even, cf. Proposition 3.1 and Theorem 3.8. Therefore, we
can impose an additional assumption that d is an odd integer wherever convenient.

Lemma 4.5. Let a symmetric matrix C satisfy assumptions (2) for an odd d, and let n = k(2d + k) + 1
for a certain k > 1. Then there exist t, u, w, z ∈ N such that w < t and

k + 1

2

= tu ,

k − 1

2

= wz

and n = 4tz(2tu − 1 − uw) .

(32)

Proof. Since n = k(2d + k) + 1 is even, the number k is obviously odd. Hence we have k+1
and d+k

2 ∈ N, k−1

2 ∈ N

2 ∈ N. We set

d + 1
d + k

=

s
t

for s, t ∈ N, gcd(s, t) = 1 .

(33)

With regard to the assumption k > 1, we have s < t. Equation (33) implies d+k
gcd(s, t) = 1, we have s | d+1

2 = zs for a certain z ∈ N. Then

2 , i.e., d+1

2 = t

s · d+1

2 . Since

d + k

2

=

t
s ·

d + 1

2

= tz .

According to Proposition 4.1, we have 2(d + k) | (d2 − 1). Therefore, (d+1)(d−1)
again the assumption gcd(s, t) = 1 to infer that d−1

t · d−1
2 = vt for a certain v ∈ N. Hence we get

2(d+k) = s

2 ∈ N. We use

k + 1

d + k

d − 1
d + 1

2

2

2

=

=

d + k

k − 1

= tz − vt = t(z − v) ;
= tz − zs = z(t − s) .

2 −
2 −
If we set z − v =: u and t − s =: w, we get k+1
t, u, w, z. For this purpose we rewrite
(cid:19)
n = k(2d + k) + 1 = 2(d + k)(k + 1) − 2(d + k) − k2 + 1 = (d + k)(cid:18)2(k + 1) − 2 −
and take advantage of equations k + 1 = 2tu, k − 1 = 2wz and d + k = 2tz derived above. This gives

(k + 1)(k − 1)

2 = tu and k−1

2 = zw. It remains to express n in terms of

d + k

2

n = 2tz(cid:18)4tu − 2 −

2tz (cid:19) = 4tz(2tu − 1 − uw) .
2tu · 2zw

Proposition 4.6. Let d be odd and n = k(2d + k) + 1. If k ≥ 27, then a symmetric matrix C satisfying
assumptions (2) for those values of d and n does not exist.

13

1 qα2

2 ··· qαr

Proof. Let n = qα1
whenever k ≥ 27. The statement then follows straighforwardly from Proposition 4.3.

r be the prime factorization of n. We will demonstrate that k + 1 > 2r

The implication k ≥ 27 ⇒ k + 1 > 2r holds trivially for any n such that r ≤ 7. Therefore, it remains
to prove that k + 1 > 2r for r ≥ 8. According to Lemma 4.5, values n and k satisfy equations (32). In
particular, we have

hence we get

tu = wz + 1 > z ;

n = 4tz(2tu − 1 − uw) < 4t · tu · 2tu = 8t3u2 ≤ 8t3u3 = (2tu)3 = (k + 1)3 .

Since d is odd, n is a multiple of 4 (cf. Prop. 3.1). Therefore, q1 = 2 and α1 ≥ 2. Then

n ≥ 22q2q3 ··· qr ≥ 2pr# ,

(34)

(35)

j=1 pj = 2 · 3 · 5 ··· pr is the rth primorial number (the product of the ﬁrst r primes). We

where pr# =Qr

have

which follows from the fact that p8# = 9699690, 83
combine inequalities (34), (35) and (36), we get

pr# >

8r
2

for all r ≥ 8 ,
2 = 8388608 and pj > 8 for all j > 8. When we

(36)

k + 1 > 3p2pr# > 2r

for all r ≥ 8 .

Proposition 4.7. Let d be odd and n = k(2d + k) + 1. If 1 < k ≤ 27, then a symmetric matrix C
of order n satisfying assumptions (2) does not exist with possible exceptions for k = 7, n = 120 and
k = 13, n = 924.

Proof. The proof relies on the fact that if C is symmetric, then for every k ∈ N there are only ﬁnitely
many possible orders n allowed in the formula n = k(2d + k) + 1, which follows from Lemma 4.5. This
fact enables us to verify that for every k ≤ 27 and for every n conforming system (32), except for
k = 7, n = 120 and k = 13, n = 924, we have k + 1 > 2r, where qα1
1 qα2
is the prime factorization
of n. Once this is proved, the statement follows from Proposition 4.3.

2 ··· qαr

r

The veriﬁcation can be done step by step for each k = 3, 5, 7, . . . , 27 − 1 (note that even values k do

not obey equations (32)), using the following procedure.

1. Find all possible 4-tuples (t, u, w, z) ∈ N4 such that k+1
2 = wz with w < t.
2. For each (t, u, w, z), set n = 4tz(2tu − 1 − uw) and ﬁnd the prime factorization n = qα1
3. Check the inequality k + 1 > 2r for all values r found in the previous step.

2 = tu and k−1

1 qα2

2 ··· qαr
r .

We will demonstrate the procedure for k = 3, 5, 7.

• Let k = 3, i.e., k+1

2 = 2. Step 1: The system tu = 2, wz = 1, w < t implies t = 2, u = 1, w = 1,

z = 1. Step 2: n = 4 · 2(2 · 2 − 1 − 1) = 16 = 24; hence r = 1. Step 3: We have 2 · 2 > 21.

• Let k = 5. Step 1: tu = 3, wz = 2, w < t implies (t, u, w, z) ∈ {(3, 1, 2, 1), (3, 1, 1, 2)}. Step 2: For
(3, 1, 2, 1) we get n = 12 · 3 = 22 · 32; hence r = 2. For (3, 1, 1, 2) we get n = 24 · 4 = 25 · 3; hence
r = 2. Step 3: In both cases we have 2 · 3 > 22.

14

• Let k = 7. Step 1: tu = 4, wz = 3, w < t implies (t, u, w, z) ∈ {(4, 1, 3, 1), (4, 1, 1, 3), (2, 2, 1, 3)}.
Step 2: For (4, 1, 3, 1) we get n = 16 · 4 = 26; hence r = 1. For (4, 1, 1, 3) we get n = 48 · 6 = 25 · 32;
hence r = 2. For (2, 2, 1, 3) we get n = 24 · 5 = 23 · 3 · 5; hence r = 3. Step 3: If r = 1 or r = 2,
then 2 · 4 > 2r. If r = 3, we have 2 · 4 = 2r, i.e., 2 · 4 6> 2r. Case r = 3 occurs for

n = 120 ,

d =

1

2(cid:18) n − 1

k − k(cid:19) =

1

2(cid:18) 119

7 − 7(cid:19) = 5 ;

therefore, there may exist a symmetric C for (n, d) = (120, 5).

Repeating the procedure for the remaining odd values of k up to k = 127 is straighforward. The
algorithm is very simple, and the calculation can be thus carried out on a computer, which will give
results immediately. One ﬁnds that the inequality k + 1 > 2r is satisﬁed for all k ≥ 9 except for k = 13
and (t, u, w, z) = (7, 1, 2, 3). In this case we have n = 924 = 22 · 3 · 7· 11, thus r = 4, and k + 1 = 14 6> 2r.
The corresponding value of d is d = 1

Proposition 4.8. There exists no symmetric matrix C satisfying conditions (2) for n = 120, d = 5 or
n = 924, d = 29.

2(cid:0) 924−1

13 − 13(cid:1) = 29.

Proof. Equation (30) together with |λ1| = d + k, obtained in the proof of Proposition 4.3, implies

,

(37)

cmµ(cid:16) n

m(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1≤m≤n−1

d − 1 + µ(1) + Xm|n

d + k =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
1≤m≤n(cid:12)(cid:12)µ(cid:0) n
m(cid:1)(cid:12)(cid:12) = 2r, where n = qα1
m(cid:17) = Xm|n
µ(1) + Xm|n

cmµ(cid:16) n

1≤m≤n−1

where k ∈ N is related to d and n by the formula n = k(2d + k) + 1. We have µ(1) = 1, µ(ℓ) ∈ {1,−1, 0}
for all ℓ ∈ N and P m|n
2 ··· qαr
is the prime factorization of n. Let s
denote the number of proper divisors m of n such that cmµ(cid:0) n
m(cid:1) = −1. Then
(cid:12)(cid:12)(cid:12)µ(cid:16) n
m(cid:17)(cid:12)(cid:12)(cid:12) − 2s = 2r − 2s .

1 qα2

1≤m≤n

r

This allows us to rewrite equation (37) in the form

d + k = |d − 1 + 2r − 2s| .

(38)

With equation (38) in hand, we can proceed to disproving the existence of matrices C for n = 120, d = 5
and n = 924, d = 29.

Let n = 120, d = 5. Using equation n = k(2d + k) + 1 and the prime decomposition of n = 120, we

get k = 7 and r = 3 (cf. the proof of Proposition 4.7). Equation (38) thus takes the form

Hence we have s = 0 or s = 12. Let us start with the case s = 0 (as we will see below, the case s = 12

5 + 7 =(cid:12)(cid:12)5 − 1 + 23 − 2s(cid:12)(cid:12) .

is not possible). By deﬁnition of s, equation s = 0 means that cm = µ(cid:0) n
m(cid:1) for every m < n such that
m | n and µ(cid:0) n
m(cid:1) 6= 0. This allows us to ﬁnd cm explicitly for each proper divisor m of n that satisﬁes
m(cid:1) = ±1. Knowing cm for an m being a divisor of n, one can use equation (29) to ﬁnd values cj for
µ(cid:0) n

all j such that gcd(j, n) = m. In this way we obtain Table 1. The last column shows those j for which

15

m
1
2
3
4
5
6
8
10
12
15
20
24
30
40
60

n
m

23 · 3 · 5
22 · 3 · 5
23 · 5
2 · 3 · 5
23 · 3
22 · 5
3 · 5
22 · 3
2 · 5
23
2 · 3
5
22
3
2

µ(cid:0) n
m(cid:1)

0
0
0
−1
0
0
1
0
1
0
1
−1
0
−1
−1

2 : cj = cn−j = cm

cm j ≤ n
c1
c2
c3
−1
c5
c6
1
c10
1
c15
1
−1
c30
−1
−1

1, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 49, 53, 59
2, 14, 22, 26, 34, 38, 46, 58
3, 21, 33, 39, 51, 57
4, 28, 44, 52
5, 35, 55
6, 42
8, 56
10
12
15
20
24
30
40
60

Table 1: Values cj for n = 120, d = 5.

gcd(j, n) = m < j. For the sake of brevity, we list only numbers j ≤ n
2 can be
found from the symmetry of C using equation cj = cn−j for all 1 ≤ j ≤ n − 1. Table 1 determines the
matrix C up to eight parameters c1, c2, c3, c5, c6, c10, c15, c30 that take values from {1,−1}. We performed
a computer calculation for each possible 8-tuple (c1, c2, c3, c5, c6, c10, c15, c30), ﬁnding that the rows of C
are never mutually orthogonal. Therefore, a symmetric matrix C corresponding to s = 0 does not exist.
It remains to comment on the case s = 12. Table 1 above shows that there are only 7 proper divisors

2 ; values cj for j > n

of 120 such that µ(cid:0) n

there exists no symmetric matrix C of order 120 satisfying conditions (2) for d = 5.
Let n = 924, d = 29. Then k = 13 and r = 4, and equation (38) takes the form

m(cid:1) 6= 0, i.e., s cannot exceed 7. The case s = 12 can be thus excluded. To sum up,

hence s = 1 (the other solution, s = 43, is impossible, because 924 has only 23 proper divisors). Equation
s = 1 means that there is a proper divisor m0 of n such that

29 + 13 =(cid:12)(cid:12)29 − 1 + 24 − 2s(cid:12)(cid:12) ;
m0(cid:19) 6= 0 ∧ cm0 = −µ(cid:18) n
µ(cid:18) n

m0(cid:19) ,

and for all the other proper divisors of n we have

(cid:16)m0 6= m < n ∧ µ(cid:16) n

m(cid:17) 6= 0(cid:17) ⇒ cm = µ(cid:16) n
m(cid:17) .

Therefore, for each proper divisor of n such that µ(cid:0) n
m(cid:1), where the values
bm form a vector that is a permutation of (−1, 1, 1, 1, . . . , 1). Properties of the M¨obius function µ imply
that the size of the vector is 2r − 1. Values cj are shown in Table 2. They depend on parameters
c1, c3, c7, c11, c21, c33, c77, c231 ∈ {1,−1} and on the following permutation of (−1, 1, 1, 1, . . . , 1),

m(cid:1) 6= 0, we have cm = bmµ(cid:0) n

(b2, b4, b6, b12, b14, b22, b28, b42, b44, b66, b84, b132, b154, b308, b462) .

16

m
1
2
3
4
6
7
11
12
14
21
22
28

n
m

22 · 3 · 7 · 11
2 · 3 · 7 · 11
22 · 7 · 11
3 · 7 · 11
2 · 7 · 11
22 · 3 · 11
22 · 3 · 7
7 · 11
2 · 3 · 11
22 · 11
2 · 3 · 7
3 · 11

µ(cid:0) n
m(cid:1)

0
1
0
−1
−1
0
0
1
−1
0
−1
1

cm
c1
b2
c3
−b4
−b6
c7
c11
b12
−b14
c21
−b22
b28

m
33
42
44
66
77
84
132
154
231
308
462

n
m

22 · 7
2 · 11
3 · 7
2 · 7
22 · 3
11
7
2 · 3
22
3
2

µ(cid:0) n
m(cid:1)

0
1
1
1
0
−1
−1
1
0
−1
−1

cm
c33
b42
b44
b66
c77
−b84
−b132
b154
c231
−b308
−b462

Table 2: Values cj for n = 924, d = 29.

Entries of C that are not listed in Table 2 can be obtained using equation (29). A computer calculation
shows that for each choice of parameters cj and bj, the rows of C are not mutually orthogonal. Therefore,
a symmetric matrix C of order 924 satisfying conditions (2) for d = 29 does not exist.

Theorem 4.9. If a symmetric matrix C satisﬁes conditions (2) for a given d ≥ 0, then n = 2(d + 1).
Proof. If d /∈ N0 or d ∈ N0 is even, then n = 2(d + 1) according to results of Section 3, see Remark 3.10.
If d = 1, the existence of symmetric Hadamard matrices of orders n > 2(d + 1) = 4 was disproved in
papers [14, 6, 17, 9]. It remains to show the validity of the statement for odd numbers d > 1. According
to Proposition 3.3, the order n obeys n = k(2d + k) + 1 for a certain k ∈ N. However,

• the case k > 128 is excluded by Proposition 4.6;
• the case 1 < k ≤ 128 is excluded by Proposition 4.7, except for (k, n, d) = (7, 120, 5) and (k, n, d) =

(13, 924, 29);

• the existence of symmetric matrices obeying conditions (2) for (n, d) = (120, 5) and (n, d) = (924, 29)

is disproved by Proposition 4.8.

To sum up, k = 1; hence n = 2(d + 1).

With regard to results of Section 3, we can also give a partial condition for matrices C that are not

symmetric:

Proposition 4.10. If a matrix C satisfying conditions (2) is not symmetric, then d is odd and n ≡ 0
(mod 4).

Proof. The existence of C implies that 2d is an integer, see Proposition 3.1. If d is a half-integer or an
even integer, we have n = 2(d + 1) according to Proposition 3.1 and Theorem 3.8; then C is symmetric
due to Theorem 5.3. Consequently, a matrix C that is not symmetric exists only for odd d. Finally, d is
odd is equivalent to n ≡ 0 (mod 4), cf. Proposition 3.1.

17

5 Matrices C satisfying n = 2(d + 1)

According to Proposition 3.1, the smallest possible order of matrices C obeying conditions (2) with a
given value d on the diagonal is n = 2(d + 1). Other results of Sections 3 and 4 conﬁrmed that this order
is special and deserves a particular attention. Recall that the relation n = 2(d+ 1) is satisﬁed for matrices
C whenever d is a half-integer or an even integer (cf. Rem. 3.10), as well as whenever C is symmetric
(Thm. 4.9). Conjecture 3.9 states that the relation n = 2(d + 1) holds true generally for any matrix C
obeying conditions (2).

Considering the prominence of matrices C satisfying n = 2(d + 1), we devote this section to their
Indeed, if d is a half-integer,

full characterization. The problem is easy when d is not an integer.

then the only possible generator of C is (cid:0) n
2 − 1,−1,−1, . . . ,−1(cid:1) (see Prop. 3.1 and Prop. 2.3), whereas
there is no solution in case that 2d /∈ N0 (cf. Prop. 3.1). The examination of matrices C for d being
In the ﬁrst step we address the special
an integer is more diﬃcult, and we divide it into two steps.
case when cj = 1 ∨ cn−j = 1 for all j = 1, . . . , n − 1 (Proposition 5.1).
In the second step we
proceed to the characterization of matrices C with the property (∃m ∈ {1, . . . , n − 1}) (cm = cn−m = −1)
(Proposition 5.2).

Proposition 5.1. Let C satisfy conditions (2) for n = 2(d + 1). Let cj = 1 ∨ cn−j = 1 for all
j = 1, . . . , n − 1. Then
• either n = 2 and

C = C2 := 0

1

1

0! ;

• or n = 4 and

C = C4a :=


1
1
−1
1
1 −1
1

1 −1
1
1
1
1
1
1 −1




or

C = C4b :=


1 −1
1
1
−1

1
1 −1
1
1

1
1
1 −1
1
1

.




Proof. Proposition 2.3 implies that n is even. The assumption cj = 1 ∨ cn−j = 1 applied on j = n
c n
2

2 denote the minimal number with the property

= cn− n

2

2 gives

= 1. Let m ≤ n

cm = cn−m = 1 ;

then

cj = −cn−j
The 0th and the mth row of C take the form

for all j = 1, . . . , m − 1 .

(cid:0) n
2 − 1(cid:1)

1

c1

c2

cn−m+1

cn−m+2

···
···

cm−1
cn−1

Their scalar product must be zero; hence we obtain

1

(cid:0) n
2 − 1(cid:1)

cm+1

c1

···
···

cn−2

cn−1

cn−m−2

cn−m−1

.

n−1

Xj=n−m+1

cjcj+m−n +

n−m−1

Xj=1

18

cjcj+m = −(n − 2) .

(39)

(40)

(41)

We see that each of the n − 2 summands on the left hand side of equation (41) must be equal to −1. In
particular,

cjcj+m = −1 for all j ∈ {1, . . . , n − m − 1} .

(42)

2 . Indeed, if m < n

Now let us show that m = n
2 , then both j = m and j = n − 2m satisfy j ∈ {1, . . . , n −
m − 1}. If we use equation (42) with these two values of j, we get cmc2m = −1 and cn−2mcn−m = −1.
Taking equation (39) into account, we conclude that c2m = cn−2m = −1. This is, however, a contradiction
with the assumptions of the proposition. Hence necessarily m = n
2 . Conditions (42) are thus equivalent
to

cj = −cj+ n

2

for all j = 1, . . . ,

n
2 − 1 .

It is easy to see that conditions (43) together with equations (40) and (39) imply that C has the block
form

C =  (cid:0) n

2 − 1(cid:1) I + A
I − A

I − A

2 − 1(cid:1) I + A ! ,
(cid:0) n

(43)

(44)

(45)

where A is a Toeplitz matrix with the 0th row equal to (0, c1, . . . , c n
to (0,−c1, . . . ,−c n
of A implies

2 −1) and with the 0th column equal
2 −1)T . Therefore, A is antisymmetric. Equation (44) together with the antisymmetry

CCT =  (d2 + 1)I + 2AAT
2dI − 2AAT

(d2 + 1)I + 2AAT ! ,
2dI − 2AAT

where d = n

2 − 1. We see from equation (45) that the condition CCT = (d2 + n − 1)I is equivalent to

Hence we can immediately ﬁnd solutions for n = 2 and n = 4:

AAT = dI =(cid:16) n

2 − 1(cid:17) I .

(46)

• If n = 2, then A is a 1 × 1 matrix satifying AAT = 0, i.e., A = (0). When we substitute n = 2 and

A = (0) into equation (44), we obtain the solution C2.

• If n = 4, A has to be a 2 × 2 antisymmetric matrix such that AAT = I. Hence

A =  0

0 ! .
−1 0! or A = 0 −1

1

1

These two matrices, when substituted into (44), lead to the solutions C4a and C4b.

In the rest of the proof we show that equation (46) is never satisﬁed by the above deﬁned antisymmetric
Toeplitz matrix A when n > 4. For the sake of convenience, we will keep using the symbol m = n
2 ,
assuming that m > 2.

First of all, m cannot be odd. Indeed, the orthogonality of the 0th and 1st row of A gives the condition

cjcj+1 = 0 .

m−2

Xj=1

If m is odd, the left hand side is an odd number, and thus nonzero.

Let m > 2 be even. We use equations (43) and (40) to derive the relation

cj = −cj+m = −(−cn−(j+m)) = cm−j

for all j = 1, . . . , m − 1.

(47)

19

Relation (47) implies that the 0th row of A takes the form

0 c1

c2

c3

···

c m

2 −1

c m

2

c m

2 −1

c m

2 −2

c m

2 −3

···

c2

c1

.

The 1st and 2nd row of A read

−c1
0
−c2 −c1

c1
0

c2
c1

···
···

c m
c m

2 −2

2 −3

c m
c m

2 −1

2 −2

c m

2

c m

2 −1

c m

2 −1
c m

2

The scalar product of the 0th with the 1st row is equal to

c m
c m

2 −2

2 −1

···
···

c3
c4

c2
c3

.

Similarly, the scalar product of the 0th with the 2nd row equals

2


m

2 −1

Xj=1

cjcj+2

cjcj+1
 .
 = 2

Xj=1

2 −2

m

∧

m

2 −2

Xj=1

cjcj+2
 .

cjcj+2 = 0 .

1 + c2

m

−c2

2 −1 + 2


m

2 −2

Xj=1

m

2 −1

Xj=1

cjcj+1 = 0

Both scalar products should be zero. Hence we obtain the requirement

However, since the two sums have diﬀerent parities, the two equations cannot be satisﬁed at the same
time.

Proposition 5.2. Let C satisfy conditions (2) for n = 2(d + 1). Let there be an m ∈ {1, . . . , n − 1} such
that cm = cn−m = −1. Then C is a block circulant matrix taking the form

C =

B + n
2 I

B
B
...
B





B

B + n
2 I

B
B

B + n
2 I

B
B
B

···
···

. . .

B
...
B

B

B + n
2 I





where the block B is either the 1 × 1 matrix (−1) or B is one of the matrices

,

(48)

C2 − I , C4a − 2I , C4b − 2I

(49)

for C2, C4a, C4b deﬁned in Proposition 5.1.

Proof. Let m be the minimal number with the property cm = cn−m = −1. The 0th and the mth row of
C take the form

2 − 1(cid:1)
(cid:0) n
−1

···
···
Their scalar product must be zero; hence

cn−m+2

cn−m+1

c1

c2

cm−1
cn−1

n−1

Xj=n−m+1

cjcj+m−n +

−1
(cid:0) n
2 − 1(cid:1)
Xj=1

n−m−1

20

cm+1

c1

···
···

cn−2

cn−1

cn−m−2

cn−m−1

.

cjcj+m = n − 2 .

(50)

Equation (50) is satisﬁed if and only if all the summands on the left hand side are equal to 1, i.e.,

cj = c(j+m) mod n

for all j = 1, . . . , n − 1, j 6= n − m .

(51)

Let us show that m divides n. Indeed, if (n mod m) = k 6= 0, we get

−1 = cm = c2m = ··· = cn−k ;
−1 = cn−m = cn−2m = ··· = ck ,

i.e., ck = cn−k = −1 for a certain k < m. This would contradict the deﬁnition of m. Therefore, m divides
n. Equation (51) thus gives the generator of C in the form

(cid:16) n
2 − 1, c1, . . . , cm−1,−1, c1, . . . , cm−1,−1, c1, . . . , cm−1, . . . ,−1, c1, . . . , cm−1(cid:17) .

This result implies that C has the block form (48). It remains to determine the matrix B. With regard
to the structure of the generator (52), matrix B is circulant and has the generator (−1, c1, . . . , cm−1). If
m = 1, we obtain immediately B = (−1). If m ≥ 2, the minimality of m trivially implies that

(52)

Furthermore, a straightforward calculation for C given by equation (48) leads to

cj = 1 ∨ cm−j = 1 for all j = 1, . . . , m − 1.

(53)

CCT =





F G G ··· G
G F G ··· G
G
G G F
...
G G G

. . .

F

...

,





F =

n
m

BBT +

n
2

(B + BT ) +

n2
4

I ,

G =

n
m

BBT +

n
2

(B + BT ) .

where

By assumption, matrix C satisﬁes CCT = (d2 + n − 1)I with d = n
obtain conditions F = n2

4 I and G = 0, which are both equal to

2 − 1, i.e., CCT = n2

4 I. Hence we

To sum up, if m ≥ 2, then B + m
and with properties (53) and (54).
Proposition 5.1. Therefore, B + m
B, as given in equation (49).

=

I .

m2
4

m
2

m
2

I(cid:17)T

I(cid:17)(cid:16)B +

(cid:16)B +
2 I is an m × m circulant matrix with generator (−1 + m

2 , c1, . . . , cm−1)
2 I satisﬁes all assumptions of
2 I is equal to C2, C4a or C4b. Hence we obtain three possible matrices

In other words, the matrix B + m

(54)

Theorem 5.3 below summarizes results found in this section.

Theorem 5.3. A matrix C satisﬁes conditions (2) with n = 2(d + 1) if and only if the generator of C
takes one of the forms below.

g1 =(cid:16) n
g2 =(cid:16) n
g4a =(cid:16) n
g4b =(cid:16) n

2 − 1,−1,−1, . . . ,−1(cid:17) (for any n ≥ 2) ;
2 − 1, 1,−1, 1,−1, 1, . . . ,−1, 1(cid:17) (for even n) ;
2 − 1, 1, 1,−1,−1, 1, 1,−1, . . .,−1, 1, 1,−1(cid:17) (for n being a multiple of 4) ;
2 − 1,−1, 1, 1,−1,−1, 1, 1, . . .,−1,−1, 1, 1(cid:17) (for n being a multiple of 4) .

In particular, a matrix C with n = 2(d + 1) exists for every n ≥ 2.

21

Proof. One can easily check that all vectors in the list generate circulant matrices satisfying conditions (2).
It suﬃces to verify that the generators g1, g2, g4a, g4b cover all possibilities found in Proposition 5.1 and
Proposition 5.2. We have:

• the choice B = (−1) in Proposition 5.2 corresponds to vector g1;
• matrix C2 in Proposition 5.1 and the choice B = C2 − I in Proposition 5.2 correspond to vector g2;
• matrix C4a in Proposition 5.1 and the choice B = C4a − 2I in Proposition 5.2 correspond to vector

g4a;

• matrix C4b in Proposition 5.1 and the choice B = C4b − 2I in Proposition 5.2 correspond to vector

g4b.

Remark 5.4. A matrix C satisfying conditions (2) for n = 2(d + 1) may or may not be symmetric:

• If C is a circulant matrix with generator g1 or g2, then CT = C.
• Let Ca, Cb be circulant n × n matrices with generators g4a and g4b, respectively. Then CT

a = Cb 6=

Ca.

Remark 5.5. Theorem 5.3 applied on d = 1 gives us four circulant Hadamard matrices of order 4.
Multiplying each of them by −1, we obtain four more matrices. These 8 matrices of order 4 together
with the matrices (1), (−1) of order 1 are the only known circulant Hadamard matrices. The Hadamard
circulant conjecture says that no other solution exists.

If Conjecture 3.9 is true, then generators g1, g2, g4a, g4b from Theorem 5.3 determine all the matrices

C satisfying conditions (2), giving thus a complete solution to the problem (2).

6 Summary and conclusions

We studied circulant matrices C of order n ≥ 2 with diagonal entries d ≥ 0, oﬀ-diagonal entries equal
to ±1 and mutually orthogonal columns. These matrices generalize circulant Hadamard and circulant
conference matrices, which correspond to d = 1 and d = 0, respectively. Matrices C can be constructed
for every order n with the value d on the diagonal chosen such that n = 2(d + 1).

We demonstrated that a matrix C with diagonal d exists if and only if 2d is an integer. Furthermore,
we proved that the order n is uniquely determined by the diagonal d via formula n = 2(d + 1) whenever
d is an even integer or a half-integer; the case of d being an odd integer remains open. The formula
n = 2(d + 1) for the special value d = 0 gives the well-known result obtained by Stanton and Mullin
(1976), which says that circulant conference matrices exist only of order 2. In addition, we proved that the
relation n = 2(d + 1) holds true whenever n − 1 is prime or C is symmetric. The latter result generalizes
a well-known theorem that there is no symmetric circulant Hadamard matrix of order n > 4.

With regard to our ﬁndings, we conjectured that the relation n = 2(d + 1) holds for every matrix C
deﬁned above, including those C with odd diagonal values d. The conjecture generalizes the circulant
Hadamard conjecture, which corresponds to the special case d = 1. We further supported the conjecture
by verifying it for all existing solutions C of order n up to n = 50.

22

Finally, we found all matrices C of order n ≥ 2 with the property n = 2(d + 1). If the above stated
conjecture is true, then those explicitly constructed matrices C with n = 2(d + 1) represent the complete
set of solutions of the studied problem.

Acknowledgements

The authors thank J. Seberry and R. Craigen for useful comments on the topic. O. T. appreciates
the hospitality at Jagellonian University in Krakow, where a part of this work was done. The research
was supported by the Czech Science Foundation (GA ˇCR) within the project 14-06818S, by the Polish
National Science Center within the project DEC-2011/02/A/ST1/00119, by the European Union FP7
project PhoQuS@UW (Grant Agreement No. 316244), and by the John Templeton Foundation under the
project No. 56033.

References

[1] M. H. Ang, K. T. Arasu, S. L. Ma, Y. Strassler, Study of proper circulant weighing matrices with

weight 9, Discrete Math. 308 (2008) 2802–2809.

[2] K. T. Arasu, K. H. Leung, S. L. Ma, A. Nabavi, D. K. Ray-Chaudhuri, Determination of all possible

orders of weight 16 circulant weighing matrices, Finite Fields Th. App. 12 (2006) 498–538.

[3] K. T. Arasu, J. Seberry, On circulant weighing matrices, Australasian J. Combin. 17 (1998) 21–37.

[4] T. Beth, D. Jungnickel, H. Lenz, Design Theory (2nd edition), Cambridge University Press, 1999.

[5] P. Borwein, M. Mossinghoﬀ, Barker sequences and ﬂat polynomials, in: J. McKee, C.s Smyth
(Eds.), Number Theory and Polynomials (Bristol, U.K., 2006). London Math. Soc. Lecture Note
Ser., vol. 352, Cambridge Univ. Press, 2008, pp. 71–88.

[6] R. A. Brualdi, A note on multipliers of diﬀerence sets, J. Res. Natl. Bur. Stand. 69B (1965) 87–89.

[7] C. Cook, M. Bernfeld, Radar signals: An Introduction to Theory and Application, Academic Press,

New York, 1967.

[8] R. Craigen, Trace, symmetry and orthogonality, Canad. Math. Bull. 37 (1994) 461–467.

[9] R. Craigen, H. Kharaghani, On the nonexistence of Hermitian circulant complex Hadamard matrices,

Australas. J. Combin. 7 (1993) 225–227.

[10] P. Eades, R.M. Hain, On circulant weighing matrices, Ars Combin. 2 (1976) 265–284.

[11] G. H. Hardy, E. M. Wright, An Introduction to the Theory of Numbers (5th ed.), Oxford University

Press, Oxford, 1980.

[12] D. Huﬀman, A method for the construction of minimum redundancy codes, Proc. of the IRE, vol. 40

(1952) pp. 1098–1101.

[13] D. Huﬀman, The generation of impulse-equivalent pulse trains, IRE Trans. on Information Theory,

vol. 8 (1962) 10–16.

23

[14] E. C. Johnsen, The inverse multiplier for abelian group diﬀerence sets, Canad. J. Math. 16 (1964)

787–796.

[15] P. Kurasov, R. Ogik, On equi-transmitting matrices, Research Reports in Mathematics, no. 1 (2014),

Stockholm University.

[16] C. W. H. Lam, Non-skew symmetric orthogonal matrices with constant diagonals, Discrete Math.

43 (1983) 65–78.

[17] J. H. McKay, S.S.-S. Wang, On a theorem of Brualdi and Newman, Linear Algebra Appl. 92 (1987)

39–43.

[18] H. J. Ryser, Combinatorial mathematics, Willey, New York, 1963.

[19] B. Schmidt, Cyclotomic integers and ﬁnite geometry, J. Am. Math. Soc. 12 (1999) 929–952.

[20] B. Schmidt, Towards Ryser’s conjecture, in: C. Casacuberta et al., eds., Proc. of 3rd European

Congress on Mathematics, Progress in Mathematics, vol. 201, Birkh¨auser 2001, pp. 533–541.

[21] J. Seberry, C. W. H. Lam, On orthogonal matrices with constant diagonal, Linear Algebra Appl. 46

(1982) 117–129.

[22] R. G. Stanton, R. C. Mullin, On the nonexistence of a class of circulant balanced weighing matrices,

SIAM J. Appl. Math. 30 (1976) 98–102.

[23] O. Turek, T. Cheon, Hermitian unitary matrices with modular permutation symmetry, Linear Al-

gebra Appl. 469 (2015) 569–593.

[24] R. Turyn, Character sums and diﬀerence sets, Paciﬁc J. Math. 15 (1965) 319–346.

24

