6
1
0
2

 
r
a

M
2

 

 
 
]

.

A
G
h
p
-
o
r
t
s
a
[
 
 

1
v
6
2
5
0
0

.

3
0
6
1
:
v
i
X
r
a

MNRAS 000, 1–16 (2016)

Preprint 3 March 2016

Compiled using MNRAS LATEX style ﬁle v3.0

From cusps to cores: a stochastic model

Amr A. El-Zant1(cid:63), Jonathan Freundlich2,3 and Fran¸coise Combes2,3
1Centre for Theoretical Physics, The British University in Egypt, Sherouk City 11837, Cairo, Egypt
2Coll`ege de France, PSL Research University, F-75005, Paris, France
3LERMA, Observatoire de Paris, CNRS, Sorbonne Universit´es, UPMC Univ. Paris 06, F-75014, Paris, France

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
The cold dark matter model of structure formation faces apparent problems on galactic
scales. Several threads point to excessive halo concentration, including central densities
that rise too steeply with decreasing radius. Yet, random ﬂuctuations in the gaseous
component can ’heat’ the centres of haloes, decreasing their densities. We present a
theoretical model deriving this eﬀect from ﬁrst principles: stochastic variations in the
gas density are converted into potential ﬂuctuations that act on the dark matter; the
associated force correlation function is calculated and the corresponding stochastic
equation solved. Assuming a power law spectrum of ﬂuctuations with maximal and
minimal cutoﬀ scales, we derive the velocity dispersion imparted to the halo parti-
cles and the relevant relaxation time. We further perform numerical simulations, with
ﬂuctuations realised as a Gaussian random ﬁeld, which conﬁrm the formation of a
core within a timescale comparable to that derived analytically. Non-radial collec-
tive modes enhance the energy transport process that erases the cusp, though the
parametrisations of the analytical model persist. In our model, the dominant contri-
bution to the dynamical coupling driving the cusp-core transformation comes from the
largest scale ﬂuctuations. Yet, the eﬃciency of the transformation is independent of
the value of the largest scale and depends weakly (linearly) on the power law exponent;
it eﬀectively depends on two parameters: the gas mass fraction and the normalisation
of the power spectrum. This suggests that cusp-core transformations observed in hy-
drodynamic simulations of galaxy formation may be understood and parametrised in
simple terms, the physical and numerical complexities of the various implementations
notwithstanding.

Key words: dark matter – galaxies: haloes – galaxies: evolution — galaxies: formation

1 INTRODUCTION

Shortly after it was shown that simulated haloes within the
cold dark matter structure formation scenario display a sin-
gular central density proﬁle up to the resolution radius (Du-
binski & Carlberg 1991; Warren et al. 1992), it was suggested
that these might be in tension with observations of dark
matter dominated galaxies (Flores & Primack 1994; Moore
1994). Since then, there has been much debate concerning
the signiﬁcance and severity of the discrepancy between the-
oretical and observed rotation curves, especially given the
possible systematic uncertainties in the observations and
their interpretation (for example due to beam smearing ef-
fects, center oﬀsets or non-circular motions (e.g., van den
Bosch & Swaters 2001; de Blok 2010; Oh et al. 2011)). Nev-
ertheless, it seems clear that in most cases ﬁnite density
‘cores’ are favoured over singular ‘cusps’; and that there is,

(cid:63) E-mail: amr.elzant@bue.edu.eg

c(cid:13) 2016 The Authors

in general, simply too much mass in the central regions of
simulated CDM haloes for these to simultaneously ﬁt the
inner and outer rotation curves of dark matter dominated
galaxies (e.g., Weinberg et al. 2013). This ‘cusp/core’ co-
nundrum seems particularly severe in dwarf galaxies (e.g.,
Adams et al. 2014; Oh et al. 2015). It is also probed in low
surface brightness galaxies (e.g., McGaugh & de Blok 1998;
Kuzio de Naray & Spekkens 2011), and may even be present
in Milky Way satellites (Goerdt et al. 2006; Walker & Pe˜nar-
rubia 2011) and the central galaxies of clusters (Newman
et al. 2015). Moreover, the high pattern speed of galactic
bars in disk galaxies such as the Milky Way could also sug-
gest the presence of a core rather than a cusp (Debattista &
Sellwood 1998).

In this context, the following questions arose: what pre-
cisely were the simulations predicting in terms of central
slope of the density proﬁle and mass contained in the cen-
tral region of dark matter haloes? Were the proﬁles inferred
from cosmological simulations a necessary theoretical predic-

2

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

tion of CDM cosmology? And, ﬁnally, if actual discrepancies
with observations do exist, how are these to be accounted
for?

Those questions have been addressed in numerous stud-
ies. Cosmological haloes were found to have an essentially
universal density proﬁle approximately characterised by the
NFW formula (Navarro et al. 1996, 1997). The inner loga-
rithmic slope is about −1, though it may ﬂatten somewhat
in the innermost regions (Stadel et al. 2009; Navarro et al.
2010); the mass contained within the central region is deter-
mined by a concentration parameter, which correlates with
the virial mass (Bullock et al. 2001; Macci`o et al. 2007;
Klypin et al. 2011; Diemer & Kravtsov 2015) and depends
on the halo formation history (Zhao et al. 2003; Zhao &
He 2009). The combination of the form of the inner density
proﬁle and the mass concentration relation makes it diﬃ-
cult to ﬁt the mass distribution inferred from observations.
The second question pertains to theoretically understanding
the origin of the proﬁles and the correlation between their
parameters; despite much eﬀort there is as yet no general
theoretical model achieving this from ﬁrst principles (see
Frenk & White 2012,
for a brief review). Nevertheless, cen-
tral cups do appear to be a generic product of cold collapse
(Huss et al. 1999; Moore et al. 1999; Shapiro et al. 2004;
El Zant 2013) and these cusps appear to be robust in the
sense of being invariant under merging (Kazantzidis et al.
2006; Boylan-Kolchin & Ma 2004; El-Zant 2008). The third
question above may be related to other problems that col-
lectively threaten the CDM paradigm; such as the ‘too big
to fail’ phenomenon (Boylan-Kolchin et al. 2011) which in-
volves the excessive rotation speeds of galactic subhaloes
and may be alleviated if those subhaloes are cored or with
a shallow cusp (Ogiya & Burkert 2015). Proposed solutions
can be broadly categorized into those considering fundamen-
tal changes in the physics of the model and those concerned
with the baryonic processes at stake during galaxy forma-
tion and evolution. The ﬁrst category comprises alternatives
to cold, collisionless dark matter such as warm dark mat-
ter, self-interacting dark matter, and models that radically
change the gravitational law. Quantum eﬀects are also some-
times invoked (e.g., Goodman 2000; Hu et al. 2000; Destri
et al. 2013; Schive et al. 2014; Marsh & Silk 2014).

If cusps are a consequence of cold collapse then it might
seem natural to consider particles that start out warm, in
the sense of having a larger primordial velocity dispersion.
Such models have indeed been studied for over a decade
(Col´ın et al. 2000; Bode et al. 2001; Schneider et al. 2012;
Lovell et al. 2014). The resulting haloes are less concen-
trated, though proper cores are hard to reproduce without
underproducing small haloes (Macci`o et al. 2012a), as cold
top hat collapse still holds for warm dark matter. The mass
of thermal warm dark matter particles is also tightly con-
strained from below via Lyman-α bounds (Croft et al. 1999;
Viel et al. 2013; Kennedy et al. 2014) and for some can-
didates from above by X-ray observations (Watson et al.
2006). Moreover, the required abundance is not easily ob-
tained unless recourse is made to low reheating scenarios in
the early universe and a suppressed weak interaction crossec-
tion (El-Zant et al. 2015). Since cusps display a ‘temperature
inversion’, in the sense that the velocity disperion increases
with radius near the centre, they can be erased through the
‘heat conduction’ that collisions between dark matter par-

ticles could enable. However, the crossection of such self in-
teracting dark matter (Spergel & Steinhardt 2000) has to be
chosen so as to avoid eventual core collapse (Burkert 2000;
Kochanek & White 2000) born of gravothermal catastro-
phe (Lynden-Bell & Wood 1968), and violating the inferred
shapes of clusters (Miralda-Escud´e 2002; Peter et al. 2013).
The latter appears to be particularly constraining for con-
stant cross sections independent of velocity (Zavala et al.
2013) (see however Elbert et al. (2015)). Alternatively, Mil-
grom (1983) proposed an empirical modiﬁcation of the grav-
itational law which is able to reproduce the rotation curves
and density proﬁles of galaxies from their observed luminos-
ity without invoking non-baryonic dark matter (e.g., Gentile
et al. 2011; Famaey & McGaugh 2012), but attempts to jus-
tify this modiﬁcation with a broader relativistic theory fail to
match the angular power spectrum of the cosmic microwave
background (e.g., Skordis et al. 2006) while observations
at cluster scales still seem to require a form of dark matter
(e.g., Sanders 1999; Clowe et al. 2006).

Given that the CDM paradigm only begins to face sig-
niﬁcant problems at precisely such scales when complex
baryonic physics begins to play an important role, it is nat-
ural to inquire whether it is the central culprit behind er-
roneous theoretical predictions. It was for example realised
early on that energy from supernovae may be suﬃcient for
driving gas out of the potential wells of dwarf galaxies, the
associated mass deﬁcit resulting in the expansion of the cen-
tral halo region and the ﬂattening of the density proﬁle.
More generally, many hydrodynamical simulations imple-
menting stellar and AGN baryonic feedback processes in a
cosmological context are able to reproduce cores (e.g., Gov-
ernato et al. 2010, 2012; Macci`o et al. 2012b; Martizzi et al.
2012; Di Cintio et al. 2014; Chan et al. 2015). However, the
complexity of such simulations obscures the physical mecha-
nisms through which these processes aﬀect the dark matter
distribution. These mechanisms normally invoke ‘heating’ of
the cold central density cusp through an irreversible process,
such as dynamical friction from infalling clumps (El-Zant
et al. 2001, 2004; Tonini et al. 2006; Romano-D´ıaz et al.
2008; Goerdt et al. 2010; Cole et al. 2011; Del Popolo et al.
2014; Nipoti & Binney 2015). Alternatively, repeated gravi-
tational potential ﬂuctuations induced by stellar winds, su-
pernova explosions and active galactic nuclei (AGN) could
also dynamically heat the central halo (Read & Gilmore
2005; Mashchenko et al. 2006, 2008; Pontzen & Governato
2012; Governato et al. 2012; Zolotov et al. 2012; Martizzi
et al. 2013; Teyssier et al. 2013; Madau et al. 2014; Pontzen
& Governato 2014). Although the last mechanism may seem
most closely related to the supernovae driven wind outﬂows
discussed above, it is in principle more closely connected to
the dynamical friction proposal, in the sense that it involves
irreversible stochastic dynamics: one may envisage the po-
tential ﬂuctuations leading to cusp-core transformation as
originating from stochastic density variations; the relevant
‘clumps’ would be associated with ﬂuctuation scales, as op-
posed to physically distinct objects dissipating orbital en-
ergy via dynamical friction; nevertheless, the basic physical
mechanism through which the energy is transferred to the
dark matter is similar. For, as is the case in general with
processes involving ﬂuctuation and dissipation, ﬂuctuations
in a gravitational system can be approximated as stochastic
processes described by power spectra and correlation func-

MNRAS 000, 1–16 (2016)

tions, and they can be accompanied by dissipation in the
form of dynamical friction (Chandrasekhar 1943; Nelson &
Tremaine 1999).

The purpose of this paper is to present and test a model
for the case when the ﬂuctuations are driven by stellar winds,
supernova explosions or AGN. The aim is to theoretically es-
timate the eﬀect of such perturbations on the halo structure,
given the shape of the density ﬂuctuation power spectrum
and its normalization. This should help in understanding the
basic physics and dynamics of the process; to estimate the
eﬀect of potential ﬂuctuations analytically or through sim-
ple simulations; and to interpret, from ﬁrst principles, com-
plex hydrodynamical cosmological simulations, which diﬀer
in physical input and numerical implementation, and often
on the inferred conclusion concerning the eﬀectiveness of
the process. At some level, the model incorporates scenarios
whereby cusp-core transformation takes place due to poten-
tial variations arising from repeated outﬂows and inﬂows in
the central region as the inferred mass variations, associated
with the density ﬂuctuations, can be quite large in regions
smaller than the largest ﬂuctuation scales. In addition, it
takes into account clumping and turbulent cascades that re-
sult in continuous mass and density ﬂuctuation spectra.

In Section 2 we outline the analytical model, solve it
for power law spectra with cutoﬀs and derive an associated
relaxation time, determining the timescale on which such
ﬂuctuations act to modify halo particle trajectories (details
of the calculations are reproduced in the appendices). In
Section 3 we test our model by evaluating the eﬀect of the
ﬂuctuating ﬁeld, with given power spectrum and normal-
ization, on a live dark matter halo of the NFW form. Our
conclusions are presented in Section 4.

2 DYNAMICAL RELAXATION SPURRED BY

STOCHASTIC DENSITY FIELDS

2.1 Outline

2.1.1 Basic theoretical setup

We envisage a two component system; a collisionless self
gravitating system (primarily a dark matter halo) with
smooth density distribution, which hosts a gaseous medium
with density ﬁeld exhibiting signiﬁcant stochastic spatio-
temporal variations in density. These can originate from
stellar or AGN feedback; they lead to potential and force
perturbations, which inﬂuence the motion of halo particles.
These then deviate from their paths in the smooth potential
within a relaxation time. This is the time for the poten-
tial ﬂuctuations to signiﬁcantly aﬀect particle trajectories;
it is analogous to the relaxation time in a stellar system,
where the ﬂuctuations due to point particle interactions can
roughly be represented as white noise. The relaxation time
is evaluated as follows.

The density ﬂuctuations are characterised by power
spectra and associated correlation functions. Once the power
spectrum of density ﬂuctuations is deﬁned, the induced grav-
itational potential variations can be derived in a manner
analogous to what is done in calculations concerned with cos-
mological large scale structure. The force correlation func-
tion can then be evaluated from the potential ﬂuctuations
power spectrum, and from this the velocity variance imposed

MNRAS 000, 1–16 (2016)

From cusps to cores: a stochastic model

3

on halo particle trajectories by the force born of the density
ﬂuctuations. As in the standard calculation of stellar dynam-
ics, the velocity variance is then divided by the square of the
average particle speed and equated to unity to obtain the
relaxation time, which is the characteristic time associated
with the eﬀect of potential ﬂuctuations on the collisionless
component.

2.1.2 Simplifying assumptions

In order to render the model more tractable, and isolate
the basic mechanism at work, we invoke some simplifying
assumptions.

We assume that the process we are interested in occurs
while the galaxy in question is gas rich. The collisionless
component will therefore solely consist of a halo, assumed
to initially be in NFW form. Any stellar component present,
being collisionless, would couple to the gas ﬂuctuations as
the dominant dark matter, though initial distribution need
not follow the halo of course. We therefore implicitly assume
that this component’s contribution to the mass distribution
is small, especially as compared to the halo. This assump-
tion will be especially justiﬁed if the star formation eﬃciency
is assumed to be small. Indeed, a low star formation eﬃ-
ciency seems to be implied if hydrodynamical simulations
invoking feedback are to simultaneously produce a halo core
and match the stellar mass in dwarf galaxies (Teyssier et al.
2013); if the energy input stems from AGN feedback the
assumption would seem even more justiﬁed. The gas mass
fraction is taken to be independent of time; again, an im-
plicit assumption here is that star formation is not eﬃcient
enough to induce a signiﬁcant change in the gas mass frac-
tion throughout the process.

In this initial study, we conﬁne ourselves to the case
where the gas is homogeneous on scales signiﬁcantly larger
than the largest ﬂuctuation scales. Stellar and AGN feedback
driven gaseous ﬂuctuations are expected to be important in
the central regions, and their dynamical eﬀects, leading to
core formation, signiﬁcant within radii ∼ rs. We therefore
assume that ﬂuctuations are important only within a sphere
of diameter d around the centre. Within this region, which
is much larger than that bounded by rs, we assume a gas
fraction f = Mgas/MDM. The gas mass fraction is a func-
tion of distance l from the centre, thus in general f = f (l).
Since the gas is assumed to be homogeneous (barring ﬂuc-
tuations) and the dark matter is centrally concentrated, the
gas mass fraction rapidly decreases with decreasing radius.
This means that if we assume, as we will, a gas mass frac-
tion of the order of the universal baryon fraction, we may
be actually underestimating the gas fraction in the central
regions, and hence the eﬀect of the ﬂuctuating gaseous com-
ponent, on the halo cusp.

It is assumed that the aﬀected collisionless matter dis-
tribution in the inner region of the halo remains near dynam-
ical equilibrium. This naturally excludes haloes undergoing
major mergers. However, cusps can reform during the merg-
ing process, and long lived cores seem to emerge only after
the epoch of rapid mass buildup is complete (Chan et al.
2015). Moreover, as the gas mass is about an order of mag-
nitude smaller than the dark matter mass, the process of
cusp-core transformation via baryonic feedback should take
place while the central halo remains in quasi-equilibrium.

4

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

Indeed, it will turn out that the core cusp transformation
takes place over many dynamical times for realistic choice
of parameters.

In a system composed of dissipative gas that is repet-
itively driven by stellar winds, supernovae or AGN energy
input with stationary statistical properties, there should be
a continuous power spectrum characterizing the ﬂuctuations
in the density ﬁeld representing the transient gas clumps of
diﬀerent sizes. The general procedure outlined below is valid
for any such power spectrum associated with a well deﬁned
correlation function, as long as it decreases suﬃciently fast
so that its integral converges. Nevertheless, we assume that
the power spectrum is a power law with maximum and min-
imum cutoﬀ. This is motivated by theoretical considerations
and observations of astrophysical ﬂuids.

Fully turbulent media are expected to display power
law velocity spectra as ﬂuctuations initiated at large scales
would cascade into smaller scales up to the dissipation scale.
If one associates the power law spectrum with standard tur-
bulence, the maximal scale is the energy driving scale, the
standard (Kolmogorov) power law index is 5/3. In compress-
ible media the power spectrum of density ﬂuctuations can
approximately mimic that of their velocity counterparts, as
seems to be the case in the cores of galaxy clusters (e.g.,
Gaspari et al. 2014; Zhuravleva et al. 2015). It is also well
established now that the interstellar medium (ISM) is highly
inhomogeneous, and characterized by supersonic velocities.
The structure of the ISM can be compared to a fractal struc-
ture, with a hierarchy of clumps with masses varying with
the scale as a power law (e.g., Larson 1981; Falgarone et al.
1992; Elmegreen 2002). The slope of the power law (or the
fractal dimension) is between 1.5 − 2.0 (Chappell & Scalo
2001; S´anchez et al. 2005). The origin of the fractal could
be self-gravity (Pfenniger & Combes 1994; de Vega et al.
1996), with the minimum and maximum scales being 10 AU
and ∼ 100 pc, but turbulence and magnetic ﬁelds have also
been invoked (e.g., V´azquez-Semadeni et al. 1997; Elmegreen
1999; Padoan et al. 2004). Besides small-scale structures of
the ISM, which might be bound by self-gravity, there must
exist kpc-scale structures, due to large-scale instabilities, like
spiral arms, or large kpc-scale clumps at high redshift (e.g.,
Noguchi 1998; Bournaud et al. 2007; Elmegreen et al. 2009).
In addition, the thermal and kinetic feedback due to star-
bursts and AGN can create some transient kpc-size struc-
tures (Stinson et al. 2006; Dalla Vecchia & Schaye 2008;
Oppenheimer & Dav´e 2008).

Finally, in this section, we do not take into account the
collective self gravitating response of the halo to the gas ﬂuc-
tuations; or any nonlinear (e.g., resonant) coupling between
the ﬂuctuating force and the orbital motion of halo particles.
These eﬀects are taken into account in Section 3.

2.1.3 Speciﬁc illustration

Our general theoretical setup applies to any two component
system as described above; and the calculations of the follow-
ing sections to any such system under the assumptions laid
out in section 2.1.2. The analytical formulas can be rescaled
to evaluate the eﬀect of gaseous ﬂuctuations on the dark
matter halo (and stellar) proﬁle for diﬀerent collisionless
matter distributions and gas mass fractions. Nevertheless,
for the sake of speciﬁc illustration, we will be focussing on

the case of a small gas rich galaxy, assumed to be in early
stages of evolution. The relevant parameters are given in Ta-
ble 1. We assume a gas mass fraction of 0.17 within the region
where the ﬂuctuations are considered important. However,
we note that as the gas mass fraction and ﬂuctuation lev-
els enter multiplicatively in our calculations, these can be
varied accordingly to get the same eﬀect.

2.2 The force correlation function

Let ρ0 denote the average density of a ﬂuid, representing
galactic or cluster gas that is driven by an energy source,
causing large scale ﬂuctuations within the ﬂuid over a vol-
ume V = d3, the dimension d being signiﬁcantly larger than
the largest ﬂuctuation scale. The potential Φ and density
contrast δ = ρ(r)
ρ0

− 1 can be Fourier decomposed such that
φke−ik.rdk,

(1)

(cid:90)
(cid:90)

Φ(r) =

V

(2π)3

and

δ(r) =

V

(2π)3

δke−ik.rdk.

(2)

In this convention, physical and k-space potential and den-
sity contrast have the same dimensions. If we assume the
ﬂuctuations deﬁne a stationary process so that ensemble av-
erages are time independent, the density ﬂuctuation power
spectrum is given by
P(k) = V(cid:104)|δk|2(cid:105)
while the components φk and δk are related, via the Poisson
equation ∇2Φ = 4πGρ0δ, through
φk = −4πGρ0δkk−2.

(4)

(3)

For a gaseous conﬁguration that is isotropic on large
scales, the force power spectrum is related to the potential
ﬂuctuations by
PF(k) = Vk2(cid:104)|φk|2(cid:105),
(5)
where k = |k|. For a system that is furthermore homogeneous
on large scales, the force correlation function, which is the
Fourier transform of the force power spectrum, is given by
(cid:104)F(0).F(r)(cid:105) =

4πk2dk

(cid:90)

(6)

V

k2(cid:104)|φk|2(cid:105) sin(kr)
kr

(2π)3

We assume that the gaseous component is embedded in a
dark matter halo and that the ﬂuctuations are present within
some distance of about d/2 the centre of the halo mass distri-
bution. This is the characteristic length scale within which
the processes ’stirring’ the gas are signiﬁcant and lead to
ﬂuctuations that display stationary statistical properties.
One can then write
(cid:104)F(0).F(r)(cid:105) =

k3(cid:104)|φk|2(cid:105) sin(kr)dk.

(cid:90)

(7)

d3
2π2r

For power law density ﬂuctuations
(cid:104)|δk|2(cid:105) = Ck−n,
the corresponding potential ﬂuctuations are characterized
by
(cid:104)|φk|2(cid:105) = (−4πGρ0)2Ck−4−n.

(8)

(9)

MNRAS 000, 1–16 (2016)

Consequently,
(cid:104)F(0).F(r)(cid:105) =

D
r

(cid:90) kx

km

sin(kr)
kn+1 dk,

(10)

(11)

(−ikmr)nΓ(−n,−ikmr) + C.C.,

where
D = 8(Gρ0)2Cd3,
and where km corresponds to the minimal ﬂuctuation scale
and kx to the maximal one. Assuming kx (cid:29) km, and n >
0 the integral is evaluated in terms of incomplete Gamma
functions to give
(cid:104)F(0).F(r)(cid:105) = −ik−n D
2r
where C.C. refers to the complex conjugate. Note that for
large kmr (cid:29) 1, that is for correlation between points sepa-
rated by distances much larger than the largest ﬂuctuation
scale λmax/2π = 1/km,
Γ(−n,−ikmr) ∼ (−ikmr)−n−1eikr;
so that, in the diﬀusion limit we will be interested in below,
(cid:104)F(0).F(r)(cid:105) ∼ D
r2

cos(kmr).

(13)

(12)

(14)

1
kn+1
m

2.3 The velocity variance

We are interested in the eﬀect of the force ﬂuctuations, born
of the density variations in the gaseous ﬁeld, on the motions
of the particles composing the surrounding halo. The veloc-
ity variance resulting from such eﬀects can be evaluated as
follows.

Starting from the Newtonian equation dv/dt = F, and
assuming that F is a random function with stationary sta-
tistical properties, one can multiply this equation by itself,
take the ensemble average and change the time variables to
obtain (e.g., Osterbrock 1952)
(cid:104)(∆v)2(cid:105) = 2
(T − t)(cid:104)F(0).F(t)(cid:105)dt.

(cid:90) T

(15)

0

Up to now, the correlation function was calculated in
terms of spatial separation between two points at some given
time. Temporal variations can be included by considering
test halo particle moving with respect to the ﬂuctuating
gaseous ﬁeld. The main contributions to its relative velocity
will come from a mean ﬂow arising from its orbital velocity
(cid:104)v(cid:105) (and of any large scale ﬂow associated with, e.g, fountain
eﬀects) and from the temporal variations in the ﬁeld on the
largest ﬂuctuation scales, which will randomly ’sweep’ with
it the smaller scales with a characteristic velocity (cid:104)u2(cid:105)1/2.
The way the spatial statistical properties of the ﬁeld are
transported (or ’swept’) into the temporal domain has been
extensively studied in the case of turbulent geophysical and
atmospheric ﬂows. If the spatial ﬁeld properties are simply
transported ’frozen in’ via a bulk ﬂow with average velocity
(cid:104)v(cid:105) the situation is similar to that invoked in the context
of the classic Taylor (1938) hypothesis; while if it randomly
swept with velocity (cid:104)u2(cid:105)1/2 the case corresponds to the ran-
dom Taylor (or random sweeping) hypothesis (Kraichnan
1964; Tennekes 1975). Theoretical, numerical and experi-
mental studies, in the case of standard fully developed tur-
bulence, suggest that in general the spatial statistical prop-
erties of the ﬁeld in the temporal domain can be related to

MNRAS 000, 1–16 (2016)

From cusps to cores: a stochastic model

those in the spatial one via a velocity vr = (cid:112)(cid:104)v(cid:105)2 + (cid:104)u2(cid:105), such

5

that the statistical properties in time at some given point are
simply the spatial properties of the ﬂuid transported with
velocity vr through that point (e.g., L’vov et al. 2001; He &
Zhang 2006; Zhao & He 2009; He & Tong 2011; Wilczek &
Narita 2012; Wilczek et al. 2014).

In our case, both the mean ﬂow and large scale random
gaseous motions should have timescales of order of the cross-
ing, or dynamical, time. Indeed, the orbital motions of the
halo particles are directly driven by the gravitational ﬁeld,
while large scale gaseous ﬂuctuations and associated ﬂows
should be in energy equilibrium with it, as we assume that
there are no inﬂows or outﬂows from or out of the central re-
gion within radius d/2 in which the ﬂuctuations occur. Thus,
for some characteristic scale length l ≤ d/2, the relevant ve-
locity will scale with the dynamical time as vr ∼ l/tD(l). In
particular, if the ﬂuctuating gas ﬁeld is swept by the largest
ﬂows then vr ∼ d/2tD(d/2). Given this, one can deﬁne r = vrt,
to be the distance a test halo particle travels with respect to
the ﬂuctuating gas ﬁeld during time t, and similarly R = vrT ,
the corresponding distance traveled during the duration T .
Making these replacements in Eq. (15) one gets
(cid:104)(∆v)2(cid:105) =
which yields, when kx (cid:29) km,
(cid:104)(∆v)2(cid:105) =

(R − r)(cid:104)F(0).F(r)(cid:105)dr,

Si (kmR) + T1(kmR) + T2(kmR)

(cid:90) R

(cid:32) 2

2
v2
r

(16)

(17)

(cid:33)

0

Dk−n
m R
v2
r

n

where Si refers to the Sine integral and the transient terms
are given by

i(ikmR)nΓ(−n, ikmR) + C.C.

(18)

(cid:32) 1

n

T1(kmR) =

and

(cid:33)

− 1
n + 1

2

1
kmR

(cos (kmR) − 1) .

n + 1

T2(kmR) =
(19)
For kmR (cid:29) 1, these transient terms are much smaller than
the ﬁrst term inside the parenthesis, which converges to π/n.
Thus for large enough R = vrt,
(cid:104)(∆v)2(cid:105) =

(20)

.

πD
nvr

T
kn
m

This is the formula we will use in estimating the eﬀect of
ﬂuctuations in the gaseous medium on the trajectories of
halo particles. It assumes that the particle moves a large
enough distance R (cid:29) k−1
m with respect to the ﬂuctuating
ﬁeld, i.e. much larger than the maximum ﬂuctuation scale
λmax/2π, either due to its own orbital motion or as a result of
temporal variations in the ﬁeld. Such a regime corresponds
to the diﬀusion limit, in which the halo particle is not bal-
listically displaced by steady forces but instead undergoes a
random walk initiated by the persistent density ﬂuctuations.
The condition R (cid:29) k−1
m will be satisﬁed on a dynamical time
tD(l) ∼ l/vr provided that l (cid:29) λmax, where l either corre-
sponds to a spatial scale associated with the orbital extent
of an unperturbed test particle orbit, or to d/2 in the case
that the relative velocity is due to large scale gaseous ﬂuc-
tuations sweeping the ﬂuctuating ﬁeld as described above.
Since, for some orbits l will be smaller than the largest ﬂuc-
tuation scales, the sweeping of ﬂuctuations by the largest
scale motions, with typical scale d/2, is expected to be more

6

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

eﬀective in driving the approach to the diﬀusion limit, espe-
cially as it involves motions that are inherently random and
non periodic. In the following we will assume that this is the
case.

2.4 The relaxation time

.

=

T
kn
m

πD
nvr(cid:104)v(cid:105)2

From Eq. (20), the ratio of the variance in velocity of the
test particle produced by the ﬂuctuating ﬁeld to the square
of the average orbital velocity of that particle is given by
(cid:104)(∆v)2(cid:105)
(cid:104)v(cid:105)2
As in the standard calculation of the two body relaxation in
stellar dynamics, we deﬁne the relaxation time as the time it
takes for the left hand side of the above equation to become
unity; that is for the eﬀect of ﬂuctuations on the velocities
to become numerically of the same order of the velocities in
the smoothed out gravitational potential. This gives

(21)

trelax =

nvr(cid:104)v(cid:105)2kn
πD .

m

(22)

Using Eq. (11) for D and noting that the constant deter-
mining the normalisation of the power spectrum can be ex-
pressed in terms of the level of ﬂuctuations at the maximum
scale, such that C = kn

(cid:105), one gets

m(cid:104)δ2

km

nvr(cid:104)v(cid:105)2

(23)

8π(Gρ0)2P(km) ,
(cid:105)d3.

trelax =
where P(km) = (cid:104)δ2
(cid:112)

km

Both velocities vr and (cid:104)v(cid:105) are determined by the gravita-
tional ﬁeld, which we assume to be dark matter dominated.
Hence, for some characteristic orbital scale l, (cid:104)v(cid:105) ∼ l/tD(l)
with tD(l) ∼ 1/
Gρ(< l), where ρ(< l) is the average density
inside radius l. Assuming that the main contribution to the
motion of the particle velocity relative to the ﬂuctuating
gaseous ﬁeld comes from large scale motions with scale d/2
(cid:33)2
in that ﬁeld leads to vr ∼ d
trelax ≈

Gρ(< d/2)/2. Thus

(cid:32) l

tD(d/2)

(cid:112)

(24)

n
16π(cid:104)δ2

km

(cid:105) f (l)−2

d

ρ(< d/2)
ρ(< l)

where f (l) = ρ0/ρ(< l) is the total gas fraction within radius
l. Assuming a constant unperturbed gas density ρ0, the re-
laxation time is a constant function of radius for a singular
isothermal sphere of density ρ(l) ∝ l−2; for shallower power
law density cusps, it is an increasing function of radius. At
d/2 it is generally given by
trelax(d/2) ≈

(cid:105) f (d/2)−2 tD(d/2).

n
64π(cid:104)δ2

(25)

km

The expressions (24) and (25) for the relaxation time are
analogous to those obtained for two-body relaxation in N-
body systems, for example in the case of stars or dark matter
particles deﬂected by their successive interactions with one
another (e.g., Binney & Tremaine 1987; Huang et al. 1993;
El-Zant 2006). Two-body relaxation is modeled as a diﬀusion
process due to random encounters between particles. The
associated relaxation time in the case of a system constituted
by N identical stars or dark matter particles can be expressed
as
trelax ∼ 0.1

(26)

tD,

N
lnΛ

where Λ = bmax/bmin is the ratio between the maximum and
minimum impact parameters while tD is the dynamical time
(Binney & Tremaine 1987). On the other hand, a random
distribution of particles leads to white noise (n = 0 in the
power spectrum). We do not deal with this special case in
detail here; though we note that, in such a system, the mass
variance is expected to be proportional to N. Thus the vari-
ance associated with the relative density contrast (cid:104)δ2(cid:105) ∝ 1/N,
and an expression analogous to (26) can be deduced by using
this result and imposing a maximum and minimum cutoﬀ
on a white noise power spectrum.

km

If we assume the gas mass fraction inside radius d/2 is
of order 0.17, it can be seen from Eq. (25) that one needs
(cid:104)δ2
(cid:105) ∼ 0.005 in order to have a signiﬁcant eﬀect within a
hundred dynamical times or so within the region where ﬂuc-
tuations are assumed to be present (for 2 <∼ n <∼ 3). As (cid:104)δ2
(cid:105)
km
represents the contribution to the variance in density ﬂuc-
tuations from the maximal ﬂuctuation scale per k-space vol-
ume (2π/d)3, it depends explicitly on the scale of the region
where the ﬂuctuations are assumed to occur. In the follow-
ing we will evaluate the radial dependence of the relaxation
time and relate its normalisation to descriptors of density
ﬂuctuations that do not bear this dependence, namely the
power spectrum (which is a measure of the contribution to
the variance per unit k-space volume) and associated dimen-
sionless spectrum and mass variance.

3 FLUCTUATION LEVELS AND THEIR

DYNAMICAL EFFECTS

3.1 Fluctuation levels leading to relaxation on

realistic timescale

In Fig. 1 we plot the relaxation time deduced from equa-
tion (24) for a galaxy with a dark matter halo of the NFW
form. The halo is assumed to have a scale length rs = 0.9 kpc
and a total mass of 2.23 × 1011M(cid:12) inside Rvir = 30 kpc. The
gas mass fraction f inside d/2 is 0.17. The power spectrum
at maximum ﬂuctuation scale is P(km) = 4.6 kpc3 (this corre-
(cid:105) = 0.0046 if d = 10 kpc) and the spectral index
sponds to (cid:104)δ2
is taken as n = 2.4. These are the same parameters that we
will use below in connection to what will be referred to as our
ﬁducial simulation. The relaxation time is expressed in terms
of the dynamical time within d/2 = 5 kpc. Accordingly, our
calculations suggest that, for the parameters chosen here,
one should expect halo particles to be aﬀected by potential
ﬂuctuations in the gas at all radii r <∼ rs within a timescale
of order of a hundred dynamical times.

km

One would like to quantify the density ﬂuctuation lev-
els that are required in the gas in order to produce potential
ﬂuctuations leading to relaxation on that timescale. As the
power spectrum has dimensions of volume it is not ideal for
this purpose. Instead, we estimate the expected RMS ﬂuc-
tuations associated with the dimensionless power spectrum

∆2(k) =

k3

2π2 P(k),

(27)

which is a measure of the variance in density contrast δ per
unit ln k, which measures the contribution to the variance of
in density ﬂuctuations from logarithmic bins around wave
number k. In Fig. 2 we plot ∆(k), for a power law power
spectrum with ﬁducial cutoﬀ scales, P(km) = 103 kpc3 and

MNRAS 000, 1–16 (2016)

From cusps to cores: a stochastic model

7

Figure 2. Dimensionless RMS ﬂuctuations ∆(k) of the density
contrast for a power law power spectrum as in Eq. 8, with cutoﬀ
scales λmin = 2π/kx = 10 pc, λmax = 2π/km = 1 kpc and P(km) =
4.6 kpc3.

a given snapshot (as in studies of large scale structure up to
the limits imposed by cosmic variance).

Theoretically, the variance can be evaluated, given a
power spectrum, by ﬁltering over diﬀerent scales. Thus the
variance over a ﬁltering scale R is given by (e.g., Mart´ınez
& Saar 2002; Mo et al. 2010)
W2(k, R)P(k)k2dk,

(cid:90) ∞

(30)

σ2

R =

1
2π2

0

where W is the Fourier transform of the window ﬁltering
function. If the mechanism of core formation is indeed well
modeled by the eﬀects of random Gaussian ﬂuctuations in
the density ﬁeld with a power law spectrum, then σR derived
from simulations where cores are produced through potential
ﬂuctuations should be well ﬁt by plugging in a power law
P(k) into equation (30); this constrains the normalisation
P(km) and index n.

As an example we show in Fig. 3 the RMS ﬂuctua-
tions as a function of radius enclosed using a Gaussian ﬁl-
ter, W(k, R) = e−k2R2/2, for diﬀerent values of the maximum
ﬂuctuation scale λmax. These can be compared with RMS
ﬂuctuations in mass enclosed within radius ∼ R in hydro-
dynamical simulations. For example, Teyssier et al. (2013)
plot the variation in mass enclosed within diﬀerent radii of
an isolated dwarf galaxy simulated via the RAMSES code
(Teyssier 2002), with gas ﬂuctuations driven by star forma-
tion. The general level of ﬂuctuations suggested by Fig. 3
seems compatible with what can be inferred by eye from
their Fig. 7. More quantitative, detailed comparison between
our model and full hydrodynamical simulations are left to
a forthcoming study. Below, we will test our model in the
more controlled context of a self gravitating halo with parti-
cles subjected to forces arising from the ﬂuctuating density
ﬁeld.

We note that, as the mass ﬂuctuations in the central
regions can be of order one or larger, the assumed stochastic
density ﬂuctuations incorporate the eﬀect of repeated rapid
outﬂows (and subsequent inﬂows) that can be invoked as
sources of non-adiabatic dynamics leading to core formation

Figure 1. Evolution of the relaxation time as calculated from
Eq. (24) in the case of a ﬁducial NFW halo submitted to per-
sistent density perturbations. The relaxation time is expressed in
terms of the dynamical time tD(d/2) within d/2 = 5 kpc and in
corresponding physical units

.

diﬀerent values of the exponent n. The variance over all k in
density ﬂuctuation contrast is given by
(cid:104)δ2(cid:105) =

P(k)4πk2dk =

(cid:90) kx

(cid:90) kx

∆2(k)d ln k,

(28)

1

(2π)3)

km

km

x

2π2 kn

mP(km)

k3−n
3 − n

hence
(cid:104)δ2(cid:105) ≈ 1
(29)
for power law spectra with cutoﬀ scales kx (cid:29) km and n < 3.
As can be seen by plugging in typical values for P(km), km,
kx and n (say for maximum ﬂuctuation scale λmax = 2π/km
between of order 1 kpc, minimal scale 0.01 to 0.1 kpc and n =
1.5−2.5) the inferred ﬂuctuation levels are large. However, as
we will see below, they appear compatible with those found
in hydrodynamical simulations where the eﬀects discussed
in this paper appear.

It is to be noted that although the variance in density
contrast depends on km and kx, for power indexes consid-
ered here the force ﬂuctuations are dominated by the largest
scales, so that ﬂuctuations at kx are relatively unimportant;
in addition, as we will see in section 4.4.3, in the diﬀusion
limit, the dynamics is also independent of km. The crucial
parameter therefore is the normalisation P(km). This is in
line with what can be inferred from equation (24).

3.2 Mass ﬂuctuations and power spectrum

normalisation

If one wishes to estimate the strength of density ﬂuctuations
in a realistic hydrodynamical simulation (or eventually pos-
sibly from observations), a natural measure is the variance
of the average density on a particular scale R. If the random
process giving rise to the density ﬂuctuations is stationary
the procedure involves measuring the standard deviation of
the mass over a suﬃciently long timespan; or, for suﬃciently
small cells, the volume average of the mass and its square in

MNRAS 000, 1–16 (2016)

012345r [kpc]020406080100120trelax/tD(d/2)0.00.51.01.52.02.53.03.54.0trelax [Gyr] 10102103k [kpc−1]10100∆(k)n=2.4n=5/3n=0.5n=1n=1.5n=2n=2.58

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

Table 1. Parameters describing the halo initial conditions for our
ﬁducial run.

Dark matter halo mass
NFW cut-oﬀ radius
NFW characteristic radius
Gas fraction

Mvir
Rvir
rs
f (d/2)

2.26 1011 M(cid:12)
30 kpc
0.9 kpc
0.17

ﬂuctuations in the gas are expected to be important primar-
ily in the central region, where feedback is most eﬀective, and
that the dynamical eﬀects of the ﬂuctuations are expected to
be signiﬁcant mainly within radius l ∼ rs (cid:28) d/2, we only ap-
ply the ﬂuctuating force to particles within l < d/2 = 5 kpc.
The gas mass fraction within this region is f (d/2) = 0.1, in
line with the large gas mass fractions observed in high red-
shift galaxies (e.g., Daddi et al. 2010; Tacconi et al. 2010,
2013; F¨orster Schreiber et al. 2011). Table 1 summarises
the parameters describing the halo initial conditions for our
ﬁducial run.

4.2 Realisation of the power spectrum in terms of

Gaussian random ﬁeld

In this realisation, the density ﬂuctuations are felt on the
particle via a stochastic force. In line with the general setup
presented in section 2, the contribution of a density pertur-
bation δk to the stochastic force felt by a halo particle should
be
Fk = −ikΦk = 4πiGρ0kk−2δk
where ρ0 corresponds to the homogeneous gas density that
is assumed. As the force depends on the direction of k, we
(cid:17)
consider a random direction (θk, φk) for each value of k, with
θk ∈ [0, π] and φk ∈ [0, 2π], so that
cos(φk)ux + sin(φk)uy
k = k

+ cos(θk)uz

sin(θk)

(31)

(32)

(cid:16)

(cid:104)

(cid:105)

,

and we introduce a random phase ψk and the pulsation fre-
quency associated to the density ﬂuctuations ω(k). The force
corresponding to mode k felt by a halo particle situated at
point r at time t is consequently such that
Fk(r, t) ∝ k k−n/2−2 sin (ω(k)t − k.r + ψk) .

(33)

The force is rescaled a posteriori to match the assumed
power spectrum normalisation, ﬁxed through the choice of
P(km), as Eq. (4) and hence (33) only ﬁx the relative values of
φk while the absolute value depend on V. This is done using
Eq. (12), which yields the variance of the force resulting from
the density ﬂuctuations at all scales:
(cid:104)F(0)2(cid:105) =

8 (Gρ0)2 P(km)

(cid:32) km

(cid:33)n−1 .

1 −

(34)

km

n − 1

kx

Again, we expect feedback processes and their associated
dynamical eﬀects on the halo to aﬀect mostly the inner re-
gion, hence the ﬂuctuating force Fk is only applied when
computing trajectories inside region of radius d/2. Table 2
summarizes the basic parameters used in deriving the per-
turbation force due to gaseous ﬂuctuations for our ﬁducial
run.

Finally, we need to choose the frequency of pertur-
bation ω. For this purpose, we adopt two diﬀerent ap-
proaches, each with its own set of simulations. The ﬁrst

MNRAS 000, 1–16 (2016)

Figure 3. Relative RMS mass ﬂuctuations averaged at diﬀerent
radii from Eq. 30 for a power law power spectrum. In this plot,
we ﬁx P(km) = 4.6 kpc3, n = 2.4 and λmin = 10 pc, but the curves
are in fact largely independent of the power law exponent n and
of the minimum scale of the perturbations λmin.

(Pontzen & Governato 2012). The ﬂuctuations are rapid in
our case, in the sense that their velocity vr is larger than the
local orbital velocities in the central regions.

4 NUMERICAL EXPERIMENTS

In this section the ﬂuctuations imposed on NFW halo parti-
cles are realised as Gaussian random processes. The eﬀect on
the dark matter cusp is inferred. From the theoretical model
described above we were able to estimate the timescale on
which the ﬂuctuating force is expected to aﬀect halo particle
trajectories. This eﬀect can be intuitively expected to drive
the particles to higher energy levels and thus lead to de-
crease in central density and cusp-core transformation. We
here show that this is indeed the case.

As opposed to the case of the analytical calculations,
any nonlinear (e.g. resonant) coupling between the imposed
ﬂuctuating force and the orbital motion in the smoothed out
potential is implicitly included and the self gravity of the
system of particles (and hence its collective response to the
potential ﬂuctuations) is taken into account. The diﬀusion
limit is not assumed a priori.

4.1 Code and initial conditions

To evolve the dark matter distribution we use the self con-
sistent ﬁeld code of Hernquist & Ostriker (1992), which eval-
uates the density and potential via functional expansion
suited for nearly spherical systems. The setup is particu-
larly powerful in capturing the interaction between stochas-
tic processes and large scale modes induced by self gravity
(e.g., Weinberg et al. 2013); which turns out to be quite
signiﬁcant.

For the sake of speciﬁc illustration, we focus on the case
of a small galaxy with an initial NFW halo with concentra-
tion parameter c ≈ 30, scale length rs = 0.9 kpc and mass
Mvir = 2.26× 1011M(cid:12) within radius Rvir = crs. Given that the

0.10.20.30.40.50.60.70.80.91.0R [kpc]10-410-310-210-1100101σRλmax=0.5 kpcλmax=1 kpcλmax=1.5 pcλmax=2 kpcTable 2. Parameters describing the perturbations and their val-
ues for our ﬁducial run. The power spectrum normalisation corre-
sponds to dimensionless power spectra and mass variance shown
on ﬁgures 2 and 3. When the parameters of Table 1 are used, this
normalisation results in the relaxation time shown in Fig. 1

Minimum scale
Maximum scale
Cutoﬀ radius
Power-law exponent
Power spectrum at km

λmin = 2π/kx
λmax = 2π/km
rcut = d/2
n
P(km)

0.01 kpc
1 kpc
5 kpc
2.4
4.6 kpc3

(cid:112)

set of simulations adopts the random sweeping approxima-
tion introduced in section 2.3; the gas is assumed to be a
fully turbulent medium with the smaller scales ‘swept’ by
the larger ones, which determines a common characteris-
tic velocity independent of k. The characteristic timescale is
tD(d/2) = 1/
Gρ(< d/2). The velocity associated to the Four-
rier component then is vr = d/tD(d/2) as in section 2.4 and
the frequency is given by ω(k) = vrk. Given our parameters
and d/2 = rcut = 5 kpc, we have vr = 134 km.s−1 for our ﬁducial
simulation. This value lies in the velocity range observed for
molecular outﬂows in nearby galaxies. Indeed, Cicone et al.
(2014) report average outﬂow velocities ranging from 50 to
800 km.s−1 in local ULIRGs and quasar-hosts with a median
of about 200 km.s−1. While outﬂow velocities can sometimes
reach values close and above 1000 km.s−1 (Fischer et al. 2010;
Sturm et al. 2011; Dasyra & Combes 2012), values of a few
hundreds of km.s−1 seem to be common (Sakamoto et al.
2009; Combes et al. 2013).

To examine the eﬀect of k dependence on vr, in the sec-
ond set of simulations, we deﬁne ω(k) from Larson’s relation,
which relates the velocity dispersion of a gaseous structure
to its size (Larson 1981; Solomon et al. 1987). We can in-
deed expect the velocity associated to a density perturba-
tion mode of size λ to scale as its velocity dispersion σ(λ).
This latter quantity can be derived from Larson’s relation
(Solomon et al. 1987),

σ

(cid:39) 1.0

λ
pc

.

(35)

km.s−1
√
Assuming that vr = dω/dk equals σ, this empirical relation
yields approximately ω(k) (cid:39) 2
k, with ω in (10 Myr)−1 and
k in kpc−1, which also corresponds approximately to a char-
acteristic time scale τ = 2π/ω of 10 Myr for a kpc-sized
structure. This time scale corresponds to the dynamical time
within the gaseous structures and is comparable to the life-
times of large star-forming molecular clouds, which are eval-
uated at a few tens of Myr (Blitz & Shu 1980; Larson 1981;
Elmegreen 1991). It is also of the same order of magnitude
as the time needed for massive molecular outﬂows to expel
the cold gas reservoir from a galaxy, as notably evaluated for
Mrk 231 from IRAM Plateau-de-Bure CO(1-0) observations
by Feruglio et al. (2010) or for a set of diﬀerent galaxies by
Sturm et al. (2011).

(cid:32)

(cid:33)

(cid:32)

(cid:33)0.5

4.3 Cusp ﬂattening due to stochastic ﬂuctuations:

Strictly spherical case

At each time step during the SCF simulations, the density
and the gravitational potential are approximated by a series

MNRAS 000, 1–16 (2016)

From cusps to cores: a stochastic model

9

of basis functions deriving from spherical harmonics which
separate the radial and angular components. The expansion
is truncated beyond radial and orbital ‘quantum’ numbers
nmax and lmax, whose choice is crucial to capture the radial and
angular structure of the halo without being dominated by
the particle noise (e.g., Weinberg 1996; Meiron et al. 2014).
A cutoﬀ lmax = 0, on the other hand, corresponds to
forcing strict spherical symmetry on the density and po-
tential ﬁelds at each time step: density ﬂuctuations are ef-
fectively smoothed out over the angular variables θ and φ
and non-radial modes washed out. This eliminates the ef-
fect of non-radial global modes, but facillitates comparison
with the analytical results in which the eﬀect of collective
self-gravitating response of the system is not taken into ac-
count. For, as in the case of standard two body relaxation,
the relaxation time is an estimate of the timescale over which
individual trajectories are expected to perturbed due to the
imposed ﬂuctuating force, it does not take into account how
energy may be transported and redistributed via global self-
gravitating modes, which may aﬀect the rate of evolution of
the self-consistent mass distribution.

The results are shown in Fig. 4, for our ﬁducial pa-
rameters and constant vr. The dark matter density proﬁle
eventually converges to that obtained in 500 Myr in the
ﬁducial simulation (Fig. 5). As can be seen the ﬂuctuations
imposed on the system of self gravitating halo particles does
indeed produce a core from the initial cusp on the timescale
predicted by the analytical calculations. This suggests that
resonant coupling between the ﬂuctuating force and the halo
orbits is unimportant to the core formation process, and so
are radial collective modes. As we will see below, on the other
hand, azimuthal modes seem to signiﬁcantly boost the cusp
formation process.

4.4 Cusp ﬂattening due to stochastic ﬂuctuations:

General case

In this section we evaluate the eﬀect of cusp ﬂattening in
the general case, without imposing strict spherical symme-
try. After some trials, through which convergence of the re-
sults was veriﬁed, we carry out simulations with nmax = 10
and lmax = 4. The results of Vasiliev (2013) suggest that this
combination should be optimal, given the number of parti-
cles (N = 240000). In this context, we repeat the simulation
of the previous subsection. We also examine the eﬀect of k-
dependent speed vr of the gaseous ﬁeld relative to dark mat-
ter particles, and the dependence of the process on maximal
and minimal ﬂuctuation scales and the power law exponent,
as well as on the time resolution of the simulations.

4.4.1 Accelerated cusp-core transformation

In Fig. 5 we show the evolution of initial cusped proﬁle un-
der the inﬂuence of a stochastic force born of density ﬂuctu-
ations as described in the previous subsection. This is done
for a constant speed vr of the halo particles with respect to
the ﬂuctuating ﬁeld (as in the theoretical calculations of sec-
tion 2), as well of k-dependent speed derived from Larson’s
relation. The parameters are those of the ﬁducial simulation
(as summarized in Tables 1 and 2). As can be seen, by the
end of the simulation (500 Myr), there is a signiﬁcant eﬀect

10

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

Figure 4. Evolution over 5 Gyr of the dark matter density pro-
ﬁle with strict spherically symmetry imposed on the halo density
and potential at each time step (lmax = 0). The halo is submitted
to a ﬂuctuating gravitational potential stemming from power-law
density ﬂuctuations as described in section 2; the parameters are
those of Tables 1 and 2. The radius r is indicated in kpc while the
density ρ is in units of 2.26 109 M(cid:12)/kpc3. The pulsation frequency
associated to each Fourier component was chosen as ω(k) = vrk,
with a constant velocity vr = 134 km.s−1. The rate of cusp-core
transformation is in agreement with the analytical calculations
(Fig. 1). It is signiﬁcantly slower however than the case when az-
imuthal modes are taken into account. For comparison, the black
dashed line shows the averaged proﬁle after 500 Myr for ten ran-
dom realisations of a simulation including non-radial collective
modes (as in Fig. 5).

at all radii within the initial NFW scale length rs = 0.9 kpc,
and this eﬀect is to erase the central cusp, transforming it
into a nearly constant density core. At larger radii, particle
trajectories are also aﬀected by the stochastic force, but the
eﬀect is similar at all radii (as the relaxation time ﬂattens);
the overall eﬀect is suppressed and the shape of density at
these radii remains largely unaltered.

Evidently, the core-cusp transformation is signiﬁcantly
faster here than in the case when strict spherical symmetry
was imposed. This phenomenon suggests that the azimuthal
smoothing suppresses the energy redistribution within the
halo and slows its collective response. As the perturbation
imposed on the halo particle trajectories is the same as in
the case when spherical symmetry is enforced, the diﬀerence
must stem from how the imparted energy is transported and
redistributed within the halo, a process which can involve
collective modes activated by self-gravity. That stochastic
noise can excite global ’sloshing’ modes, enhancing its over-
all eﬀect, has been previously realised by Weinberg (1998).
In our case, such modes may act as to speed up the process of
velocity dispersion equalisation in the cusp, and hence of its
transformation into a core. Pontzen et al. (2015), also note
that a triaxial halo submitted to time-dependent potential
ﬂuctuations ﬂattens into a core within 1 Gyr while a similar
spherical halo remains cuspy on such a timescale: aspheric-
ity seems to be a key ingredient for an eﬃcient cusp-core
transition.

Figure 5. Evolution of the dark matter density proﬁle with pa-
rameters given in Tables 1 and 2 and no strict spherical symmetry
imposed. The solid lines correspond to the case when the pulsa-
tion frequency associated to each Fourier component was chosen
as ω(k) = vrk, with a constant velocity vr = 134 km.s−1. The shaded
area highlights the scatter after 500 Myr between ten random re-
alisations of the simulation. Alternatively, the dashed line displays
the dark matter density proﬁle after 500 Myr when the pulsation
frequency is deﬁned from Larson’s relation as ω(k) = 2
k: both
approaches yield similar results.

√

4.4.2 Power spectrum normalisation and gas mass

fraction

As may be expected, the normalisation the density ﬂuctu-
ation power spectrum, and hence of the imposed force (as
deﬁned by Eq. 34), plays an important part in the magni-
tude of the ensuing eﬀect. This is illustrated in Fig. 6, where
we show the eﬀect of varying the values of the power spec-
trum normalisation P(km). To factor out the variations due
to diﬀerent random initial conditions we average the results
over ten runs for each value and show the contours asso-
ciated with these values. We note that since the gas mass
fraction and the ﬂuctuation levels enter multiplicatively in
our formulation, we could have changed the gas mass frac-
tion instead of the power spectrum normalisation to obtain
analogous results. Fig. 7 shows the gas mass fraction varia-
tion with power spectrum normalisation that keep the force
normalisation at the same level as that assumed in the ﬁdu-
cial simulation.

4.4.3 Independence of the ﬂattening on the maximum and

minimum ﬂuctuation scales

The normalisation of the ﬂuctuating force (Eq. 34) only
weakly depends on the minimum ﬂuctuation scale kx as
kx (cid:28) km, but does depend on the maximum ﬂuctuation scale
determined by km. Nevertheless, in the diﬀusion limit, the ac-
tual eﬀect on particle trajectories, as determined by (cid:104)(∆v)2(cid:105),
is not expected to depend on km if the velocity of the per-
turbations relative to the halo particles vr is independent of
k. This can be explained using the following heuristic argu-
ment. In a diﬀusion process, particle trajectories are aﬀected
by small successive kicks, each of them associated to a veloc-
ity change ∆v ∼ F∆t, where ∆t is the characteristic duration

MNRAS 000, 1–16 (2016)

0.50.00.51.0log(r)43210log(ρ)t=0 Gyrt=1 Gyrt=2 Gyrt=3 Gyrt=4 Gyrt=5 Gyr0.50.00.51.0log(r)43210log(ρ)t=0 Myrt=100 Myrt=200 Myrt=300 Myrt=400 Myrt=500 MyrFrom cusps to cores: a stochastic model

11

Figure 6. Evolution of the dark matter density proﬁle after 500
Myr for diﬀerent values of P(km) in the case of density ﬂuctuations
with constant speed of the turbulent ﬂow with respect to the dark
matter. The power spectrum normalisation grows by a factor 4
between two successive curves. Each proﬁle has been averaged
over ten random realizations of the simulation; the shaded areas
correspond to the span of these ten realizations. The dotted line
corresponds to the initial proﬁle; the units are as in the previous
ﬁgures.

Figure 8. Dark matter density proﬁles after 500 Myr of pertur-
bations for diﬀerent values of the minimum (up) and maximum
(down) scales of the perturbations. The parameters of the simula-
tions correspond to the ﬁducial ones, with a constant speed of tur-
buleng ﬂow vr. The maximum scale of perturbations is λmax = 1 kpc
when varying λmin (upper panel), and λmin = 10 pc when varying
λmax (lower panel). The dotted line corresponds to the initial pro-
ﬁle; the units are as in the previous ﬁgures.

Fig. 8 shows that the eﬀect of the ﬂuctuations is indeed
largely independent of the maximal and minimal ﬂuctuation
scales. This is also expected from the analytical formula for
the relaxation time (Eq. (24).

4.4.4 Comparison with a Kolmogorov exponent

Fig. 9 compares the ﬁducial evolution of the dark matter
density proﬁle with that obtained with a Kolmogorov ex-
ponent n = 5/3. The small power-law exponent leads to an
increased ﬂattening of the density proﬁle within 500 Myr,
which is consistent with Eq. 24: the relaxation time is pro-
portional to n so smaller values of the exponent result in an
increased eﬃciency of the energy transfer to the dark matter
particles. A smaller exponent also corresponds to a ﬂatter
power spectrum, i.e., to higher amplitudes at wave numbers
larger than km. Nevertheless, the increased eﬃciency of the
process remains limited due to the linear dependence of the
relaxation time on the power law index n, which is likely con-
strained to a rather limited range of values (cf. section 2). In

Figure 7. Values of the gas mass fraction f (d/2) and of the power
spectrum normalisation P(km) that keep the force normalisation
as that assumed in the ﬁducial simulation, from Eq. (34). The
minimum and maximum cutoﬀ scales and the power law exponent
are left unchanged.

of the kick. If we assume a pulsation frequency ω = vrk, ∆t
varies as 1/k. The square of the kicks adds up linearly; such
that, after a given time interval in which a test halo parti-
cle is subjected to N kicks, the resulting velocity variance
is (cid:104)(∆v)2(cid:105) ∼ N(∆v)2. However, since ∆t ∝ 1/k, the number of
kicks during this time interval is proportional to k. Conse-
quently, (cid:104)(∆v)2(cid:105) ∝ N F2 ∆t2 ∝ F2/k. As (cid:104)F(0)2(cid:105) ∝ km from
Eq. (33) in the limit kx (cid:28) km, the resulting velocity variance
should be independent of km even though this wavenumber
determines the dominant scale of the perturbations.

MNRAS 000, 1–16 (2016)

0.50.00.51.0log(r)43210log(ρ)P(km)=1.1 kpc3P(km)=4.6 kpc3P(km)=18.3 kpc310-210-1100f(d/2)10-1100101102103P(km)0.50.00.51.0log(r)43210log(ρ)λmin=10 pcλmin=25 pcλmin=50 pcλmin=75 pcλmin=100 pc0.50.00.51.0log(r)43210log(ρ)λmax=0.25 kpcλmax=0.5 kpcλmax=0.75 kpcλmax=1 kpcλmax=2 kpcλmax=3 kpc12

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

T(km) = 12.53 Myr and T(kx) = 1.25 Myr. As the smallest time
scale for the ﬁducial simulations is 0.075 Myr, the Nyquist-
Shannon sampling theorem a priori requires selecting a time
step inferior to 0.03 Myr. However, as shown Fig. 10, the
simulations already converge for time steps of about 1 Myr,
i.e., for time steps which only resolve the highest pertur-
bation scales: because the amplitude of the density power
spectrum decreases from km to kx and because the small
scale perturbations are swept out by the larger ones, the
ﬂuctuations are dominated by those near km. As simulations
with δt = 0.01 Myr and δt = 0.1 Myr yield similar results,
we carried out most of our simulations with the less time-
consuming time step δt = 0.1 Myr.

5 CONCLUSION

We have presented a theoretical model that attempts to
describe, from ﬁrst principles, halo core formation due to
coupling with ﬂuctuations in a hosted gaseous component.
Gravitational potential ﬂuctuations leading to core forma-
tion in dark matter haloes arise from density variations in
the gas distribution hosted by the halo during its early evo-
lution. It is then possible to understand the dynamics of
core formation in terms of the statistical properties of the
ﬂuctuations in the gaseous density ﬁeld, assumed here to be
stationary in time. In particular, it is possible to derive a
correlation function for the force born of the density ﬂuctu-
ations, and which aﬀects the trajectories of the dark matter
halo. In the diﬀusion limit, when particles undergo random
walks initiated by the persistent density ﬂuctuations, a re-
laxation time, analogous to the two body relaxation time in
N-body systems, can be derived.

The framework thus described is general, and valid for
any form of the density ﬂuctuation power spectrum (pro-
vided the time integrals of the associated force correlation
functions converge). However, in this initial study, we have
conﬁned ourselves to pure power-law power density ﬂuctua-
tion spectra, described by an exponent n and maximal and
minimal cutoﬀ scales. The relaxation time does not depend
on these, and depends only weakly (linearly) on n. We also
assume that the gas is homogeneous on large scales, and its
distribution thus determined by the gas mass fraction. For a
given dark matter conﬁguration, the important parameters
determining the relaxation rate are the gas mass fraction
and the normalisation of the power spectrum of the density
ﬂuctuations.

For numerical parameters associated with a small gas-
rich galaxy halo (Tables 1 and 2), our calculations suggest
that the stochastic processes discussed here can indeed lead
to signiﬁcant eﬀects on the dark matter particle dynamics
within a fraction of the Hubble time for a gas mass fraction
of comparable to the universal gas baryon fraction in the
region where ﬂuctuations are signiﬁcant. The magnitude of
the RMS density ﬂuctuations associated with dimensionless
power spectrum need to be of order one to ten at the max-
imal ﬂuctuation length scale, which is the dominant scale
driving the cusp-core transformation in our model. The mass
ﬂuctuations within radius 0.1kpc (∼ 0.1rs) also need to be of
the same order. These appear compatible with the mass ﬂuc-
tuations time series presented by Teyssier et al. (2013), who
do produce a core in a dwarf galaxy halo due to potential

MNRAS 000, 1–16 (2016)

Figure 9. Dark matter density proﬁles after 500 Myr of pertur-
bations for the ﬁducial set of parameters and for a Kolmogorov
exponent n = 5/3. Each proﬁle has been averaged over ten random
realizations. The dotted line corresponds to the initial proﬁle; the
units are as in the previous ﬁgures.

Figure 10. Dark matter density proﬁles after 500 Myr for dif-
ferent values of the time step δt, in the case of density ﬂuc-
tuations with constant speed of turbulent ﬂow vr. Time steps
δt > 3 Myr undersample all perturbation modes while those with
0.03 Myr < δt < 3 Myr properly sample the largest ﬂuctuation scales
close to km but theoretically undersample the smallest ones. The
dotted line corresponds to the initial proﬁle; the units are as in
the previous ﬁgures.

our model, the power spectrum tilt is therefore expected to
have a relatively mild inﬂuence on the ﬁnal density proﬁle.

4.4.5 The eﬀect of the time step

To each perturbation mode between km and kx corresponds
a timescale, which depends on the deﬁnition of the pulsa-
tion frequency. When it is deﬁned as ω(k) = vr k, the ex-
tremal timescales associated to the ﬁducial parameters are
√
T(km) = 2π/ω(km) = 7.5 Myr and T(kx) = 0.075 Myr. When
it is instead deﬁned from Larson’s relation as ω(k) = 2
k,

0.50.00.51.0log(r)43210log(ρ)0.50.00.51.0log(r)43210log(ρ)Initial profileδt=10 Myrδt=7.5 Myrδt=5 Myrδt=2.5 Myrδt=1 Myrδt=0.1 Myrδt=0.01 Myrﬂuctuations driven by gaseous feedback and the mass ﬂuc-
tuations.

This may suggest that the ﬂuctuations leading to core
formation in dark matter haloes can be modeled as stochas-
tic processes determined by a power spectrum and the asso-
ciated dynamical eﬀects modeled as a diﬀusion process; and
that the relevant power spectrum may consist of a power
law with maximal and minimal cutoﬀ scales. As the required
mass ﬂuctuations in the central regions are large, the model
can incorporate the eﬀects of repeated outﬂows and inﬂows
in the central region. In addition, it takes into account the
eﬀects of fragmentation and turbulent cascades giving rise
to continuous mass and density ﬂuctuation spectra.

Detailed comparison with full hydrodynamic simula-
tions is left to a future study. However, we tested our model
through N-body simulations in which an additional ﬂuctu-
ating force is imposed on the halo particles. This is inferred
from a Gaussian random realisations of the the statistical
properties of the assumed gaseous ﬁeld, as deﬁned by the
power spectrum of its density ﬂcutuations. The simulations
include the self gravity of the dark matter halo and any
nonlinear coupling between the unperturbed halo particle
trajectories and the imposed force; the diﬀusion limit is not
assumed a priori. They conﬁrm that the dynamical eﬀects of
the processes studied are independent of the process on the
maximum and minimum ﬂuctuation scales and only weakly
dependent on the spectral index of the power-law spectrum.
We use the self consistent ﬁeld code of Hernquist & Os-
triker (1992), which facilitates the isolation of eﬀects due to
collective modes. The results suggest that the transfer of en-
ergy imparted from the ﬂuctuating force on the individual
particles, and its redistribution through the self gravitating
conﬁguration, is greatly enhanced by the eﬀects of collective
modes born of self gravity: the process of core formation is
signiﬁcantly reduced if non-radial collective modes are re-
moved by imposing strict spherical symmetry on the conﬁg-
uration. In this latter case, the observed evolution timescales
are as those inferred from the theoretical calculation of the
relaxation time. In the general case, on the other hand, the
process of core formation is faster, taking place within a few
hundred Myr (the aforementioned scalings and parameter
dependence, however, remain in line with the analytical cal-
culations). That stochastic ﬂuctuations can couple to global
modes to enhance their overall eﬀect is a phenomenon that
has already been already observed and studied (Weinberg
1998).

Our results also suggest that when the time resolution
of the simulations is not suﬃcient, the ﬂuctuations are ran-
dom sampled as white noise (n → 0) and the halo particles
feel a ﬂat power spectrum instead of the proper one arising
from the actual physical processes which are modeled, which
leads to signiﬁcant enhancement of the eﬀect of core forma-
tion. Nevertheless, since the force ﬂuctuations are dominated
by the largest scales, the resulting error is not catastrophic
unless even the those scales remain unresolved.

The model presented here can be used to understand
how the physics leading to a particular spectrum of ﬂuc-
tuations aﬀects the dynamics of core formation in realistic
simulations; and also how particular numerical implemen-
tations aﬀect the process. Possible extensions include the
introduction of more general power spectra and gas density
distributions. In its present formulation, the model predicts

MNRAS 000, 1–16 (2016)

From cusps to cores: a stochastic model

13

that the process of core formation primarily depends on only
two parameters — the normalisation of the power spectrum
and the gas mass fraction inside the region where the eﬀect
of the ﬂuctuations is important (parameters which may in
fact be correlated through the star formation eﬃciency). It
can can hence be understood and parametrised in particu-
larly simple terms.

ACKNOWLEDGEMENTS

This work beneﬁted from the Franco-Egyptian Partenariat
Hubert Curien (PHC) Imhotep and the ERC-Momentum-
267399. The authors acknowledge interesting discussions
with Gary Mamon, Avishai Dekel, Andrea Macci`o, James
Bullock and C´eline Boehm.

REFERENCES

Adams J. J., et al., 2014, ApJ, 789, 63
Binney J., Tremaine S., 1987, Galactic dynamics
Blitz L., Shu F. H., 1980, ApJ, 238, 148
Bode P., Ostriker J. P., Turok N., 2001, ApJ, 556, 93
Bournaud F., Elmegreen B. G., Elmegreen D. M., 2007, ApJ, 670,

237

Boylan-Kolchin M., Ma C.-P., 2004, MNRAS, 349, 1117
Boylan-Kolchin M., Bullock J. S., Kaplinghat M., 2011, MNRAS,

415, L40

Bullock J. S., Kolatt T. S., Sigad Y., Somerville R. S., Kravtsov
A. V., Klypin A. A., Primack J. R., Dekel A., 2001, MNRAS,
321, 559

Burkert A., 2000, ApJ, 534, L143
Chan T. K., Kereˇs D., O˜norbe J., Hopkins P. F., Muratov A. L.,
Faucher-Gigu`ere C.-A., Quataert E., 2015, ArXiv: 1507.02282,

Chandrasekhar S., 1943, ApJ, 97, 255
Chappell D., Scalo J., 2001, ApJ, 551, 712
Cicone C., et al., 2014, A&A, 562, A21
Clowe D., Bradaˇc M., Gonzalez A. H., Markevitch M., Randall

S. W., Jones C., Zaritsky D., 2006, ApJ, 648, L109

Cole D. R., Dehnen W., Wilkinson M. I., 2011, MNRAS, 416,

1118

Col´ın P., Avila-Reese V., Valenzuela O., 2000, ApJ, 542, 622
Combes F., Garc´ıa-Burillo S., Braine J., Schinnerer E., Walter F.,

Colina L., 2013, A&A, 550, A41

Croft R. A. C., Weinberg D. H., Pettini M., Hernquist L., Katz

N., 1999, ApJ, 520, 1

Daddi E., et al., 2010, ApJ, 713, 686
Dalla Vecchia C., Schaye J., 2008, MNRAS, 387, 1431
Dasyra K. M., Combes F., 2012, A&A, 541, L7
Debattista V. P., Sellwood J. A., 1998, ApJ, 493, L5
Del Popolo A., Lima J. A. S., Fabris J. C., Rodrigues D. C., 2014,

J. Cosmology Astropart. Phys., 4, 21

Destri C., de Vega H. J., Sanchez N. G., 2013, New Astron., 22,

39

Di Cintio A., Brook C. B., Macci`o A. V., Stinson G. S., Knebe

A., Dutton A. A., Wadsley J., 2014, MNRAS, 437, 415

Diemer B., Kravtsov A. V., 2015, ApJ, 799, 108
Dubinski J., Carlberg R. G., 1991, ApJ, 378, 496
El-Zant A. A., 2006, MNRAS, 370, 1247
El-Zant A. A., 2008, ApJ, 681, 1058
El Zant A. A., 2013, ApJ, 779, 64
El-Zant A., Shlosman I., Hoﬀman Y., 2001, ApJ, 560, 636
El-Zant A. A., Hoﬀman Y., Primack J., Combes F., Shlosman I.,

2004, ApJ, 607, L75

El-Zant A., Khalil S., Sil A., 2015, Phys. Rev. D, 91, 035030

14

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

Elbert O. D., Bullock J. S., Garrison-Kimmel S., Rocha M.,

Meiron Y., Li B., Holley-Bockelmann K., Spurzem R., 2014, ApJ,

O˜norbe J., Peter A. H. G., 2015, MNRAS, 453, 29

792, 98

Elmegreen B. G., 1991, in Lada C. J., Kylaﬁs N. D., eds, NATO
Advanced Science Institutes (ASI) Series C Vol. 342, NATO
Advanced Science Institutes (ASI) Series C. p. 35

Elmegreen B. G., 1999, ApJ, 527, 266
Elmegreen B. G., 2002, ApJ, 564, 773
Elmegreen B. G., Elmegreen D. M., Fernandez M. X., Lemonias

Milgrom M., 1983, ApJ, 270, 365
Miralda-Escud´e J., 2002, ApJ, 564, 60
Mo H., van den Bosch F. C., White S., 2010, “Galaxy Formation

and Evolution”

Moore B., 1994, Nature, 370, 629
Moore B., Quinn T., Governato F., Stadel J., Lake G., 1999,

J. J., 2009, ApJ, 692, 12

MNRAS, 310, 1147

Falgarone E., Puget J.-L., Perault M., 1992, A&A, 257, 715
Famaey B., McGaugh S. S., 2012, Living Reviews in Relativity,

15, 10

Feruglio C., Maiolino R., Piconcelli E., Menci N., Aussel H.,

Lamastra A., Fiore F., 2010, A&A, 518, L155

Fischer J., et al., 2010, A&A, 518, L41
Flores R. A., Primack J. R., 1994, ApJ, 427, L1
F¨orster Schreiber N. M., et al., 2011, ApJ, 739, 45
Frenk C. S., White S. D. M., 2012, Annalen der Physik, 524, 507
Gaspari M., Churazov E., Nagai D., Lau E. T., Zhuravleva I.,

2014, A&A, 569, A67

Gentile G., Famaey B., de Blok W. J. G., 2011, A&A, 527, A76
Goerdt T., Moore B., Read J. I., Stadel J., Zemp M., 2006, MN-

RAS, 368, 1073

Goerdt T., Moore B., Read J. I., Stadel J., 2010, ApJ, 725, 1707
Goodman J., 2000, New Astron., 5, 103
Governato F., et al., 2010, Nature, 463, 203
Governato F., et al., 2012, MNRAS, 422, 1231
He X., Tong P., 2011, Phys. Rev. E, 83, 037302
He G.-W., Zhang J.-B., 2006, Phys. Rev. E, 73, 055303
Hernquist L., Ostriker J. P., 1992, ApJ, 386, 375
Hu W., Barkana R., Gruzinov A., 2000, Physical Review Letters,

85, 1158

Huang S., Dubinski J., Carlberg R. G., 1993, ApJ, 404, 73
Huss A., Jain B., Steinmetz M., 1999, ApJ, 517, 64
Kazantzidis S., Zentner A. R., Kravtsov A. V., 2006, ApJ, 641,

647

Kennedy R., Frenk C., Cole S., Benson A., 2014, MNRAS, 442,

2487

Klypin A. A., Trujillo-Gomez S., Primack J., 2011, ApJ, 740, 102
Kochanek C. S., White M., 2000, ApJ, 543, 514
Kraichnan R. H., 1964, Physics of Fluids, 7, 1723
Kuzio de Naray R., Spekkens K., 2011, ApJ, 741, L29
Larson R. B., 1981, MNRAS, 194, 809
Lovell M. R., Frenk C. S., Eke V. R., Jenkins A., Gao L., Theuns

Navarro J. F., Frenk C. S., White S. D. M., 1996, ApJ, 462, 563
Navarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493
Navarro J. F., et al., 2010, MNRAS, 402, 21
Nelson R. W., Tremaine S., 1999, MNRAS, 306, 1
Newman A. B., Ellis R. S., Treu T., 2015, ApJ, 814, 26
Nipoti C., Binney J., 2015, MNRAS, 446, 1820
Noguchi M., 1998, Nature, 392, 253
Ogiya G., Burkert A., 2015, MNRAS, 446, 2363
Oh S.-H., de Blok W. J. G., Brinks E., Walter F., Kennicutt Jr.

R. C., 2011, AJ, 141, 193

Oh S.-H., et al., 2015, AJ, 149, 180
Oppenheimer B. D., Dav´e R., 2008, MNRAS, 387, 577
Osterbrock D. E., 1952, ApJ, 116, 164
Padoan P., Jimenez R., Nordlund ˚A., Boldyrev S., 2004, Physical

Review Letters, 92, 191102

Peter A. H. G., Rocha M., Bullock J. S., Kaplinghat M., 2013,

MNRAS, 430, 105

Pfenniger D., Combes F., 1994, A&A, 285
Pontzen A., Governato F., 2012, MNRAS, 421, 3464
Pontzen A., Governato F., 2014, Nature, 506, 171
Pontzen A., Read J. I., Teyssier R., Governato F., Gualandris A.,

Roth N., Devriendt J., 2015, MNRAS, 451, 1366

Read J. I., Gilmore G., 2005, MNRAS, 356, 107
Romano-D´ıaz E., Shlosman I., Hoﬀman Y., Heller C., 2008, ApJ,

685, L105

Sakamoto K., et al., 2009, ApJ, 700, L104
S´anchez N., Alfaro E. J., P´erez E., 2005, ApJ, 625, 849
Sanders R. H., 1999, ApJ, 512, L23
Schive H.-Y., Liao M.-H., Woo T.-P., Wong S.-K., Chiueh T.,
Broadhurst T., Hwang W.-Y. P., 2014, Physical Review Let-
ters, 113, 261302

Schneider A., Smith R. E., Macci`o A. V., Moore B., 2012, MN-

RAS, 424, 684

Shapiro P. R., Iliev I. T., Martel H., Ahn K., Alvarez M. A., 2004,

ArXiv Astrophysics e-prints,

T., 2014, MNRAS, 439, 300

Skordis C., Mota D. F., Ferreira P. G., Bœhm C., 2006, Physical

L’vov V. S., Pomyalov A., Procaccia I., 2001, Phys. Rev. E, 63,

Review Letters, 96, 011301

056118

Solomon P. M., Rivolo A. R., Barrett J., Yahil A., 1987, ApJ,

Lynden-Bell D., Wood R., 1968, MNRAS, 138, 495
Macci`o A. V., Dutton A. A., van den Bosch F. C., Moore B.,

319, 730

Spergel D. N., Steinhardt P. J., 2000, Physical Review Letters,

Potter D., Stadel J., 2007, MNRAS, 378, 55

84, 3760

Macci`o A. V., Paduroiu S., Anderhalden D., Schneider A., Moore

Stadel J., Potter D., Moore B., Diemand J., Madau P., Zemp M.,

B., 2012a, MNRAS, 424, 1105

Macci`o A. V., Stinson G., Brook C. B., Wadsley J., Couchman
H. M. P., Shen S., Gibson B. K., Quinn T., 2012b, ApJ, 744,
L9

Madau P., Shen S., Governato F., 2014, ApJ, 789, L17
Marsh D. J. E., Silk J., 2014, MNRAS, 437, 2652
Mart´ınez V. J., Saar E., 2002, Statistics of the Galaxy Distribu-

tion. Chapman

Martizzi D., Teyssier R., Moore B., Wentz T., 2012, MNRAS,

422, 3081

Martizzi D., Teyssier R., Moore B., 2013, MNRAS, 432, 1947
Mashchenko S., Couchman H. M. P., Wadsley J., 2006, Nature,

442, 539

Mashchenko S., Wadsley J., Couchman H. M. P., 2008, Science,

319, 174

Kuhlen M., Quilis V., 2009, MNRAS, 398, L21

Stinson G., Seth A., Katz N., Wadsley J., Governato F., Quinn

T., 2006, MNRAS, 373, 1074

Sturm E., et al., 2011, ApJ, 733, L16
Tacconi L. J., et al., 2010, Nature, 463, 781
Tacconi L. J., et al., 2013, ApJ, 768, 74
Taylor G. I., 1938, Proceedings of the Royal Society of London A:

Mathematical, Physical and Engineering Sciences, 164, 476

Tennekes H., 1975, Journal of Fluid Mechanics, 67, 561
Teyssier R., 2002, A&A, 385, 337
Teyssier R., Pontzen A., Dubois Y., Read J. I., 2013, MNRAS,

429, 3068

Tonini C., Lapi A., Salucci P., 2006, ApJ, 649, 591
Vasiliev E., 2013, MNRAS, 434, 3174
V´azquez-Semadeni E., Ballesteros-Paredes J., Rodr´ıguez L. F.,

McGaugh S. S., de Blok W. J. G., 1998, ApJ, 499, 41

1997, ApJ, 474, 292

MNRAS 000, 1–16 (2016)

Viel M., Becker G. D., Bolton J. S., Haehnelt M. G., 2013, Phys.

Rev. D, 88, 043502

Walker M. G., Pe˜narrubia J., 2011, ApJ, 742, 20
Warren M. S., Quinn P. J., Salmon J. K., Zurek W. H., 1992,

ApJ, 399, 405

Watson C. R., Beacom J. F., Y¨uksel H., Walker T. P., 2006, Phys.

Rev. D, 74, 033009

Weinberg M. D., 1996, ApJ, 470, 715
Weinberg M. D., 1998, MNRAS, 297, 101
Weinberg D. H., Bullock J. S., Governato F., Kuzio de Naray R.,

Peter A. H. G., 2013, ArXiv: 1306.0913,

Wilczek M., Narita Y., 2012, Phys. Rev. E, 86, 066308
Wilczek M., Xu H., Narita Y., 2014, Nonlinear Processes in Geo-

physics, 21, 645

Zavala J., Vogelsberger M., Walker M. G., 2013, MNRAS, 431,

L20

Zhao X., He G.-W., 2009, Phys. Rev. E, 79, 046316
Zhao D. H., Jing Y. P., Mo H. J., B¨orner G., 2003, ApJ, 597, L9
Zhuravleva I., et al., 2015, MNRAS, 450, 4184
Zolotov A., et al., 2012, ApJ, 761, 71
de Blok W. J. G., 2010, Advances in Astronomy, 2010, 5
de Vega H. J., S´anchez N., Combes F., 1996, Nature, 383, 56
van den Bosch F. C., Swaters R. A., 2001, MNRAS, 325, 1017

APPENDIX A: DERIVATION OF THE FORCE
CORRELATION FUNCTION

A1 Expression as an integral

The Wiener-Khinchin theorem enables to write the force
auto-correlation function as the inverse Fourier transform of
the force power spectrum so that, when assuming isotropy,
(cid:104)F(0).F(r)(cid:105) =

(cid:90) ∞

(A1)

dk.

PF(k) 4πk2 sin kr
kr

1

(2π)3

0

From cusps to cores: a stochastic model

15

for complex variables:
(cid:104)F(0).F(r)(cid:105) =

=

(cid:104)F(0).F(r)(cid:105) =

eikr − e−ikr

(cid:90) kx
(cid:90) ikxr
(cid:16)
(cid:17)
Γ(−n, ikxr) − Γ(−n, ikmr)

dk
ex − e−x
xn+1

1
2i
1
2i

D
r
km
D
(ir)n
r
D (ir)n−1

kn+1

dx

ikmr

2

+ C.C.

(A5)

A3 Asymptotic behavior

Given that

(A6)

Γ(s, x) ∼|x|→+∞ xs−1e−x,
the asymptotic behavior of the force correlation function
when kxr (cid:29) kmr (cid:29) 1 and n + 1 > 0 is
(cid:104)
(cid:104)F(0).F(r)(cid:105) ∼ − D
e−ikxr − k−n−1
2r2
∼ D
cos(kmr) − k−n−1
k−n−1
m
r2
(cid:104)F(0).F(r)(cid:105) ∼ D
1
cos(kmr).
kn+1
r2
m

e−ikmr(cid:105)

cos(kxr)

k−n−1

+ C.C.

(A7)

(cid:104)

(cid:105)

m

x

x

A4 An estimate of the force
The value of (cid:104)F(0)2(cid:105) can be used as an estimate of the square
of the force. Eq. A3 yields
(cid:104)F(0)2(cid:105) = D

(cid:90) kx

− k−n+1

k−n+1

(A8)

1
kn dk =

D
n − 1

km

so that
(cid:104)F(0)2(cid:105) =

8 (Gρ0)2 (cid:104)δ2
n − 1

km

(cid:105) d3

km

(A9)

m

(cid:18)
1 −

x

(cid:19)
(cid:33)n−1 .

(cid:32) km

kx

Given Eq. (4) and (5),
PF(k) = V (4πGρ0)2 k−2 (cid:104)|δk|2(cid:105)

APPENDIX B: VELOCITY VARIANCE

(A2)

B1 Expression from the equation of motion

so for power law density ﬂuctuations bounded by km and kx
as deﬁned in section 2.2,

Considering the eﬀect of the random perturbation force in
direction i during a time T , the equation of motion leads to

(cid:90) T

(cid:90) kx

km

(cid:104)F(0).F(r)(cid:105) =

D
r

sin kr
kn+1

dk

(A3)

with D = 8 (Gρ0)2 Cd3.

A2 In terms of incomplete Gamma functions

(cid:90) ∞

A2.1 Expression in terms of incomplete Gamma functions

The upper incomplete Gamma function is deﬁned as

Γ(s, x) =

ts−1e−tdt.

(A4)

x

It can be expressed as power series, and as such, developed
into a holomorphic function of complex variables with the
same properties. The force auto-correlation function can be
expressed in terms of incomplete Gamma functions extended

MNRAS 000, 1–16 (2016)

0

(B1)

− v0i

= v0i +

Fi(τ)dτ,

(cid:90) T

(cid:90) T

(cid:32) dxi

(cid:33)2(cid:105) =

dxi
dt
where v0i is the initial velocity in direction i. The velocity
variance is obtained by averaging this equation:
(cid:48))(cid:105) dτdτ
(cid:104)(∆vi)2(cid:105) = (cid:104)
(cid:48)
(B2)
The integrand is symmetrical in τ, τ(cid:48) and the integration do-
main correspond to a square of length T in the corresponding
plane. We can thus replace the integral over the square by
twice the integral over the triangle deﬁned by 0 < τ < T and
τ < τ(cid:48) < T so that
(cid:104)(∆vi)2(cid:105) = 2

(cid:48) (cid:104)Fi(τ)Fi(τ

(cid:104)Fi(τ)Fi(τ

(cid:48))(cid:105),

(B3)

dτ

dτ

dt

0

0

.

which can be rewritten as
(cid:104)(∆vi)2(cid:105) = 2

dt

0

0

dτ (cid:104)Fi(τ)Fi(τ + t)(cid:105).

(B4)

(cid:90) T
(cid:90) T

0

(cid:90) T
(cid:90) T−t

τ

16

Amr A. El-Zant, Jonathan Freundlich and Fran¸coise Combes

(cid:104)Fi(τ)Fi(τ + t)(cid:105) =

Hence,

(cid:104)(∆v)2(cid:105)kx

(cid:33)
(cid:33)

(cid:32) 2
(cid:32) 2

n

n

= − DR
v2
r kn
x

DR
v2
r kn
m

Si (kxR) + T1(kxR) + T2(kxR)

(B18)

while the component depending on km similarly yields
(cid:104)(∆v)2(cid:105)km

Si (kmR) + T1(kmR) + T2(kmR)

=

,

(B19)

where the functions T1 and T2 have been deﬁned in Eq. (18)
and (19). The total velocity variance is simply (cid:104)(∆v)2(cid:105) =
(cid:104)(∆v)2(cid:105)kx
+(cid:104)(∆v)2(cid:105)km , which simpliﬁes to its second term when
kx (cid:29) km.

B3 Asymptotic behavior

(cid:32) 1

(cid:33) 2

n

kxR

cos(kxR)

Eq. (A6) results in
− 1
T1(kxR) ∼
(B20)
n + 1
when kxR (cid:29) 1 so all the terms in T1 and T2 go to zero when
kxR (cid:29) 1 and kmR (cid:29) 1. In this limit and when kx (cid:29) km, we
consequently have
(cid:104)(∆v)2(cid:105) ∼ πRD
nv2
r

(B21)

1
kn
m

.

This paper has been typeset from a TEX/LATEX ﬁle prepared by
the author.

(cid:90) T
The perturbations being stationary,
(cid:104)Fi(0)Fi(t)(cid:105), the expression simpliﬁes to
(cid:104)(∆vi)2(cid:105) = 2
(cid:90) T

and the total velocity variance is given by
(cid:104)(∆v)2(cid:105) = 2

(T − t)(cid:104)Fi(0)Fi(t)(cid:105) dt.

(T − t)(cid:104)F(0).F(t)(cid:105) dt.

0

(B5)

(B6)

0

As indicated in section 2.3, this quantity can also be ex-
pressed in terms of the spatial correlation function (cid:104)F(0).F(r)(cid:105)
by introducing a velocity vr corresponding to the movement
of the ﬂuctuating gaseous ﬁeld (Eq. 16).

B2 Explicit expression of the velocity variance

The expression of the force auto-correlation function ob-
tained in Eq. (A5) can be separated in two analogous com-
ponents, one depending on kx and the other on km. The one
depending on kx can be developed as
(cid:104)F(0).F(r)(cid:105)kx

k−n+1

(B7)

(cid:17)

=

x

D
2

(cid:16)
(ikxr)n−1 Γ(−n, ikxr) + C.C.
(cid:33)

and results for the velocity variance (as expressed by Eq. 16)
in a component
k−n+1

I1(kxR)

(cid:104)(∆v)2(cid:105)kx

(B8)

=

+

x

(cid:32)

− iR
kx

n

1
k2
x

I2(kxR)
n + 1

D
v2
r

(cid:90) ikxR
(cid:90) ikxR

−ikxR

0

with
I1(kxR)

n

and
I2(kxR)
n + 1

=

=

(cid:90)

xn−1Γ(−n, x) dx

xnΓ(−n, x) dx + C.C.

(B9)

(B10)

(B11)

(B12)

(B13)

(B14)

Given that

xb−1 Γ(s, x) dx =

xbΓ(s, x) − Γ(s + b, x)

(cid:105)

,

(cid:104)

1
b

integrating by parts yields
I1(kxR) = (ikxR)n Γ(−n, ikxR) − Γ(0, ikxR) − C.C.
and
I2(kxR) = (ikxR)n+1 Γ(−n, ikxR) − Γ(1, ikxR) + Γ(1, 0) + C.C.

dt is the Sine integral function, and

Further noticing that
Γ(0, ikxR) − C.C. = 2i Si(kxR),
where Si(X) ≡
that

(cid:90) X

sin t

t

0

we obtain

Γ(1, 0) − Γ(1, ikxR) + C.C. = −2(cid:0) cos(kxR) − 1(cid:1),
(cid:17) − 2i Si(kxR)
(cid:17) − 2
(cid:16)

(ikxR)n+1 Γ(−n, ikxR) + C.C.

(ikxR)n Γ(−n, ikxR) − C.C.

I1(kxR) =

I2(kxR) =

(cid:16)
(cid:16)

and

(cid:17)
cos(kxR) − 1

.

(B15)

(B16)

(B17)

MNRAS 000, 1–16 (2016)

