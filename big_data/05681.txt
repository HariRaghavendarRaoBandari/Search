6
1
0
2

 
r
a

 

M
7
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
1
8
6
5
0

.

3
0
6
1
:
v
i
X
r
a

Hybrid Quantum-Classical Hierarchy for Mitigation of Decoherence and

Determination of Excited States

Jarrod R. McClean,1, ∗ Mollie E. Schwartz,2 Jonathan Carter,1 and Wibe A. de Jong1

1Computational Research Division, Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA

2Quantum Nanoelectronics Laboratory, Department of Physics,
University of California, Berkeley, Berkeley, CA 94720, USA

Using quantum devices supported by classical computational resources is a promising approach
to quantum-enabled computation. One example of such a hybrid quantum-classical approach is
the variational quantum eigensolver (VQE) built to utilize quantum resources for the solution of
eigenvalue problems and optimizations with minimal coherence time requirements by leveraging
classical computational resources. These algorithms have been placed among the candidates for
ﬁrst to achieve supremacy over classical computation. Here, we provide evidence for the conjecture
that variational approaches can automatically suppress even non-systematic decoherence errors by
introducing an exactly solvable channel model of variational state preparation. Moreover, we show
how variational quantum-classical approaches ﬁt in a more general hierarchy of measurement and
classical computation that allows one to obtain increasingly accurate solutions with additional clas-
sical resources. We demonstrate numerically on a sample electronic system that this method both
allows for the accurate determination of excited electronic states as well as reduces the impact of
decoherence, without using any additional quantum coherence time or formal error correction codes.

First conceived of by Richard Feynman [1], quantum
computers have the potential to oﬀer radical advances
in solving important problems ranging from optimiza-
tion and eigenvalue problems to materials design. One
problem of particular recent interest is that of quantum
chemistry, where quantum computers have the potential
to oﬀer an exponential speedup in the determination of
physical and chemical properties [2–4]. This problem has
received attention both because of its great practical util-
ity, and because it is believed that it may be one of the
ﬁrst approaches to demonstrate the superiority of a quan-
tum computer over currently available classical comput-
ers [5, 6].

Recently, there have been a number of advances in
quantum chemistry on quantum computers both algo-
rithmically and technologically. The original work uti-
lized the quantum phase estimation algorithm [7–9] and
analyzed the use of adiabatic state preparation in chemi-
cal problems. Since then, the cost of the quantum phase
estimation procedure has been brought down dramati-
cally through considerations of physical locality of in-
teractions, chemical insights, and more general algorith-
mic enhancements [10–14]. Additionally, prototype im-
plementations of many of these algorithms have now been
veriﬁed in the lab on quantum technologies such as quan-
tum photonics, ion traps, NMR computers, and nitrogen
vacancies in diamond [15–20].

While there have been signiﬁcant developments in
quantum hardware across a variety of platforms, many
of these algorithms cannot be faithfully run on current
or near-future technology. To combat this problem, a
hybrid quantum classical approach was developed, with
the the idea that quantum processors should only be

∗ Corresponding author: jmcclean@lbl.gov

FIG. 1. A cartoon schematic of the quantum subspace expan-
sion proposed in this work. One prepares a quantum state |Ψ(cid:105)
that is passed through a quantum channel. At the exit of the
channel, partial tomography of the state is used to expand in
a linear subspace around the resulting quantum state. This
subspace is used to determine both the ground and excited
states of a quantum Hamiltonian of interest while also poten-
tially correcting for errors caused by the quantum channel.

used for tasks that have a strong comparative advan-
tage in the quantum domain. [18]. Hybrid quantum-
classical variational approaches work analogously to clas-
sical variational approaches, by preparing a parameter-
ized ansatz on the quantum device and minimizing the
energy with respect to the parameters. The use of a
quantum device expands the classes of ansatz one may
explore, including many which are believed to be classi-
cally intractable. A similar approach was codiscovered
in the context of simulations for quantum ﬁeld theo-
ries [21]. Since this approach was introduced,
it has
been expanded and enhanced theoretically both in the
general sense [5, 10, 22] and for speciﬁc use with ion
trap quantum computers [23]. Recently, variants using a
similar approach for thermodynamic properties and ex-
tended systems have also appeared [24, 25]. Moreover

2

(cid:35)

quantum channel, potentially determined by prior exper-
iments. Mathematically we may state this as choosing
the pure state |Ψ(cid:105) that minimizes

(cid:34)(cid:32)(cid:88)

(cid:33)
the transformed Hamiltonian H(cid:48) =(cid:80)

Ki |Ψ(cid:105)(cid:104)Ψ| K

This problem is equivalent to an eigenvalue problem on
†
i HKi (see sup-
plemental materials for a short proof) such that one may
solve

H

.

(1)

i K

†
i

Tr

i

FIG. 2. The ﬁdelity of the initial and ﬁnal states after be-
ing passed through three diﬀerent quantum channels (Ph–
Dephasing, AP–Amplitude and Phasing Damping, Depol–
Depolarizing) improves under variation in the presence of the
channel (VCS solution, solid lines with markers) when com-
pared to the exact less ground state as input (ground state
of untransformed Hamiltonian, markers only). The channels
are characterized by an experiment time Tp relative to co-
herence time parameters T1 = T2 = Tdepol time such that
Tp/T1 = 0.05.

it has been speculated that the robustness and resource
adaptive nature of this approach places it as a candidate
for one of the ﬁrst algorithms to surpass the capabilities
of a classical computer on a pre-threshold or minimally
error corrected quantum device [5]. This conjecture is
supported by recent experimental work comparing the
performance of quantum phase estimation with varia-
tional approaches on superconducting qubits [26]. We
strengthen this evidence here by showing that it holds
in a parameterization-independent model of these varia-
tional algorithms in non-ideal conditions.

To understand the performance of a hybrid quantum-
classical variational approach on a quantum device ex-
periencing interactions with an environment, here we de-
velop a theoretical model of variational state prepara-
tion that we term the variational channel state (VCS)
preparation. Speciﬁcally, we deﬁne the VCS model as
the preparation of an arbitrary pure state followed by the
action of a quantum channel deﬁned by a set of Kraus op-
erators [27]. The purpose of this model is to allow one to
the study the optimal possible performance of quantum-
classical variational algorithms in experiments separate
from the considerations of ansatz choice or experimental
protocol.

In this model, the problem to solve is to ﬁnd the pure
state |Ψ(cid:105) that minimizes the energy given a target Hamil-
tonian H after action by a quantum channel that maps
†
ρ = |Ψ(cid:105)(cid:104)Ψ| →
i , where Ki are the Kraus opera-
tors deﬁning eﬀective non-unitary actions of a dissipative

(cid:80)

i KiρK

(cid:48)

H

|Ψ(cid:105) = E |Ψ(cid:105)

(2)

for the lowest eigenvalue and eigenvector pair to ﬁnd the
solution, which both quantiﬁes the optimal performance
of a quantum variational algorithm in these conditions
and determines the input state that achieves this optimal
performance, independent of state parameterization.

In Fig. 2 we use the VCS model to compare the ﬁdelity
of a 4-qubit quantum state representing H2 communi-
cated through several channels with and without varia-
tional optimization, with details of the channels given as
supplemental information. We ﬁnd that variational opti-
mization in the presence of the channel is able to improve
the ﬁdelity and ﬁnd decoherence resistant subspaces au-
tomatically in some cases. In the case of the dephasing
channel, the variational algorithm automatically locates
a decoherence free subspace, whereas input of the ideal
solution without variational relaxation (or exact diago-
nalization of the untransformed Hamiltonian, possible in
this case due to the limited number of qubits) in the
presence of the channel degrades in quality. The discon-
tinuities in the variational curves correspond to a spin
symmetry breaking in the Hamiltonian resulting from
an eﬀective interaction induced by the quantum channel.
Thus we see that the variational eigensolver is partially
self-correcting in the presence of inevitable qubit decay
and dephasing.

We now move on to extensions of the variational
method to the capturing of excited states. To date,
hybrid variational quantum-classical algorithms have fo-
cused on the ground state in ideal conditions, however we
will show that through a straightforward extension of the
original machinery, one may both substantially mitigate
decoherence and obtain excited states. The original VQE
algorithm determines 1- and 2- electron reduced density
matrices (1- and 2-RDM) of the system from which static
properties of the chemical or material can be determined
without any additional quantum experiments. The 1-
and 2- electron reduced density matrices for fermionic
systems are deﬁned as

1Di

2Dij

†
†
i ak |Ψ(cid:105) = Tr[a
k = (cid:104)Ψ| a
i akρ]
†
†
1
jalak |Ψ(cid:105) =
2 (cid:104)Ψ| a
kl =
i a
†
where here a
i and ai are fermionic creation and annihi-
lation operators acting on spin-orbitals or a generic lat-
tice and ρ = |Ψ(cid:105)(cid:104)Ψ| but may represent a more general

†
†
i a
Tr[a
jalakρ]

(4)

(3)

1
2

0.51.01.52.02.53.0R(˚A)0.900.920.940.960.981.00FidelityPhAPDepol3

FIG. 4. The energy of diﬀerent electronic states as a func-
tion of internuclear separation for the H2 molecule in a mini-
mal STO-6G basis, encoded into qubits by the Jordan-Wigner
mapping. Both the entire exact spectrum is shown with dot-
dashed lines, as well as the exact spectrum restricted to a
neutral molecule (Ne = 2). In this case the linear response
(LR) approximation from an exact reference is suﬃcient to
capture exactly the excited states with the correct number
symmetry, as the excitation operators conserve the number
from the exact reference state.

the quantum reference state with bases

f

(8)

†
†
†
ik ajk |Ψ(cid:105) | ik, jk ∈ [1, M ]}.
i1 aj1a
i2aj2 . . . a

Bk
f = {a
where B1
f is clearly the linear response space above, with
more and more of the space being spanned until k = Ne
and BNe
spans the entire Ne-Fermion space. At this
point, the classical diagonalization is equivalent to clas-
sical exact diagonalization and provides an exact result
but has a computational cost that scales exponentially
in the size of the system. While exact diagonalization
is not advantageous from a complexity point of view, at
ﬁxed levels of the hierarchy before this, one eﬃciently
determines a result that is diﬃcult to obtain classically
by virtue of the diﬃculty of preparing and manipulat-
ing |Ψ(cid:105) and attains more information from |Ψ(cid:105) from only
additional measurements and classical computation. We
refer to this approach generically as fermionic quantum
subspace expansion (QSE). A cartoon schematic of this
work is depicted in Fig. 1, where the eﬀect of a quan-
tum channel contracts an ideal pure state, and expanding
about the result allows one to compensate for the eﬀect
of the dissipative channel while also capturing additional
information with the structure of the linear subspace.

We assess the performance of the QSE extension to
the original hybrid quantum classical approach on the
spectrum of a simple molecule, H2 in a minimal STO-6G
basis [29] under the Jordan-Wigner (JW) qubit encod-
ing [30], using the VCS model.

FIG. 3. A cartoon schematic of the basis hierarchy obtained
from expanding about the VQE solution reference. At k = 1
one has the linear response (LR) subspace and at k = 2 one
has the the quadratic response (QR) space continuing to k =
Ne where one spans the entire subspace corresponding to the
particle number of the reference state.

mixed quantum state ρ. The average energy is obviously
expressible as the following contraction once the 1- and
2-RDM are determined

(cid:88)

(cid:88)

(cid:104)H(cid:105) =

hik

1Di

k +

hijkl

2Dij
lk.

(5)

ik

ijkl

Extending this idea, we now develop a method that re-
quires only a polynomial number of additional measure-
ments to determine the 3- and 4-RDM of the system (see
supplemental information for explicit matrix elements),
from which excited state energies and properties can be
determined. More explicitly, we expand about the refer-
ence |Ψ(cid:105) to form a linear subspace spanned by the vectors
(6)

†
i aj |Ψ(cid:105) .
a

The justiﬁcation for including these particular states is
that they are the dominant contribution in a linear re-
sponse (LR) theory of local time-dependent perturba-
tions to the system [28].

In this linear subspace, the optimal solution within this
subspace can be found by solving the generalized eigen-
value problem

HLRC = SLRCE

(7)

for the ground and excited states, where HLR is the
Hamiltonian in this subspace, SLR is the overlap ma-
trix, E is the diagonal matrix of eigenvalues and C is
the matrix of eigenvectors. One may continue to expand
the subspace about the reference to an arbitrary order.
This forms a natural hierarchy of subspaces built from

0.00.51.01.52.02.53.0R(˚A)−1.0−0.50.00.51.0E(Eh)ExactExact(Ne=2)LR4

a variational channel state model (VCS) to understand
the potential performance of quantum variational algo-
rithms in non-ideal conditions. This approach motivates
a general hierarchy of quantum-classical approximations,
in which a tradeoﬀ between numbers of measurements
and system accuracy can be easily tailored to suit com-
putational purposes. We believe our advances pave the
way for better understanding of quantum devices in the
role of co-processors and pushes the boundaries of our
capabilities closer to the edge of outperforming a purely
classical computing device in the near future.

A. Acknowledgements

The authors acknowledge valuable discussions with Ir-
fan Siddiqi and Chris Macklin. J.R.M. is supported by
the Luis W. Alvarez fellowship in computing sciences
at Lawrence Berkeley National Laboratory. M.E.S. ac-
knowledges support from the Fannie and John Hertz
Foundation. This work was supported by Laboratory Di-
rected Research and Development (LDRD) funding from
Berkeley Lab, provided by the Director, Oﬃce of Sci-
ence, of the U.S. Department of Energy under Contract
No. DE-AC02-05CH11231.

I. SUPPLEMENTAL INFORMATION I

A. Quantum Chemistry

The electronic structure problem is a problem of great
interest due both to its ability to accurately model real
molecules from ﬁrst principles and the potential of quan-
tum computers to greatly accelerate ﬁnding its solutions.
Here we provide background on this topic and its map-
ping to quantum computers for interested readers. The
problem is deﬁned by the electronic eigenstates of a ﬁxed
nuclear conﬁguration with positions and charges Ri and
Zi with a ﬁxed number of electrons Ne. Under the Born-
Oppenheimer approximation, the non-relativistic Hamil-
tonian governing the interactions is given by

(cid:88)
(cid:88)

i

ri

∇2
2 −
ZiZj

(cid:88)

i,j

H = −

+

i,j>i

|Ri − Rj|

Zi

(cid:88)

|Ri − rj|
1

i,j>i

|ri − rj|

(9)

+

in atomic units, and Ri are nuclear positions, ri elec-
tronic positions, and Mi are nuclear masses. This real-
space representation where fermion anti-symmetry may
be enforced in the solutions is called the ﬁrst-quantized
representation. While progress has been made in solving
the ﬁrst-quantized problem on a quantum computer [31–
35], in this work we will focus on the case where the
solution is projected into a ﬁnite orthonormal basis and
anti-symmetry is enforced through the operators, also

FIG. 5. In examining the energy as a function of separation
for the ground state of H2 under a particular amplitude and
phase damping channel (AP), one sees that in the linear re-
sponse subspace (AP LR), the solution quality in increased
with respect to the optimal solution of the quantum channel
model (AP). The qualitative kink in the approximate solu-
tion can be repaired by enforcing the correct spin symmetry
(S2 = 0). This also demonstrates the eﬀect on the energy
between variational minimization with the channel (AP) and
without (No Var).

First we examine the performance of the fermionic
LR expansion in determining excited states on the ex-
act ground state of H2. This allows one to understand
properties of the method in situations where very good
approximations to the ground state may be prepared.
The excellent accuracy of the method in this case is ex-
empliﬁed in Fig. 4. One sees from this plot a nice feature
of the LR method, which is that it conﬁnes one to the
physical subspace of Ne = 2 particles exactly even though
the Jordan-Wigner transformation encodes the unphysi-
cal space of Ne = 0 to the number of spin-orbital sites.

In an imperfect preparation, a quantum channel eﬀec-
tively restricts the space of preparable quantum states.
As such,
it’s reasonable that re-expanding the result-
ing state and solving the problem within the expanded
space may also help to improve the quality of the ground
state. This calculation is shown in Fig. 5 for an am-
plitude and phase damping channel with an experiment
time Tp relative to coherence parameters T1 = T2 of
Tp/T2 = 0.05, demonstrating the capability of the expan-
sion to improve the quality of the solution under noise.
n this work, we explore a variational channel state model
to understand the performance of quantum variational
algorithms in currently-realizable physical systems. We
introduce a simple but powerful approach that naturally
mitigates noise, improves estimates of the ground state,
and ﬁnds excited states based on the projective mea-
surement scheme of the original VQE, which we call the
quantum subspace expansion. Additionally, we develop

0.51.01.52.02.53.0R(˚A)−1.15−1.10−1.05−1.00−0.95−0.90−0.85E(Eh)ExactAPAPLRAPLR(S2=0)NoVar(cid:88)

pqrs

known as the second quantized approach [36].
approach, the Hamiltonian is given by

H =

†
hpqa
paq +

1
2

†
†
pa
hpqrsa
qaras

(10)

where the coeﬃcients are determined by the integrals
over the chosen ﬁnite basis as
−∇2
2 −

(cid:88)

∗
p(σ)

hpq =

ϕq(σ)

dσ ϕ

Zi

r

|Ri − r|

i

(cid:32)

(cid:33)

(cid:88)

pq

(cid:90)
(cid:90)

ϕ∗
p(σ1)ϕ∗

q(σ2)ϕs(σ1)ϕr(σ2)
|r1 − r2|

(11)

(12)

hpqrs =

dσ1 dσ2

where ϕi are spin-orbitals and σi are the spatial and spin
degrees of freedom of an electron as σi = (ri, si). The
†
i and ai obey the standard fermion commu-
operators a
tation relations as
†
†
†
p, ar} ≡ a
{a
par + ara
p = δp,r
†
†
r} = {ap, ar} = 0.
{a
p, a

(14)

(13)

In quantum computing, one must represent anti-
symmetric fermions by distinguishable qubits. At least
two isomorphisms are known for accomplishing this,
namely the Jordan-Wigner [30, 37] and Bravyi-Kitaev
transformations [38–40]. Each of these approaches have
their tradeoﬀs in implementation, but in this work we
will use the Jordan-Wigner transformation deﬁned by

(cid:89)
(cid:89)
σz
m)σ
≡ (σx ∓ iσy) /2

m)σ+
σz
p
−
p

m<p

m<p

†
a
p = (

ap = (
±

σ

(15)

(16)

(17)

This encoding allows one to express the second-quantized
Hamiltonian entirely in terms of tensor products of Pauli
operators. Moreover, this transformation leaves the num-
ber of terms the same up to a constant factor, and may
be used to derive the Pauli representation of any desired
fermion operator.

with the number operator N = (cid:80)

One practical property to note with regards to this
mapping is that it encodes all particle number manifolds.
That is, the quantum chemistry Hamiltonian commutes
†
i a
i ai, such that the
number of electrons is a good quantum number. Equiva-
lently, the Hamiltonian can be decomposed into a block
diagonal representation where diﬀerent number states are
uncoupled. Using this symmetry classically allows one
to remain in the desired number manifold at all times.
However, on a quantum device, the plethora of unphys-
ical excited states can pollute the spectrum as a result
of this wasteful encoding. While some approaches have
been developed to project out only the correct states at
the operator level [41], provably polynomial methods for
doing this are still under development. We explore in the
body of this work how these unphysical excited states
may enter in practice, and show how they can be tem-
pered using the extra structure in our method.

In this

B. Hybrid Quantum-Classical Variational

Approach

5

Quantum phase estimation provided the ﬁrst demon-
stration that quantum computers could aid in the solu-
tion of electronic structure problems for quantum chem-
istry [2]. However, this approach requires long coherent
sequences of quantum operations that are not easily im-
plemented on current quantum architectures.
In order
to study this problem on current and near-future archi-
tectures, a hybrid quantum-classical approach called the
variational quantum eigensolver (VQE) was developed,
which leverages classical computing power alongside the
power of a quantum device to minimize coherence time
requirements. Here we brieﬂy review the parts of this
algorithm relevant to the main body of this work, and
refer readers to the original works for more detailed al-
gorithmic analysis of the original approach [18, 22].

The VQE approach depends on the choice of a state
ansatz parameterized on some set of experimental param-
eters (cid:126)θ. These parameters could be used to specify a gate
sequence such as in the unitary coupled cluster or param-
eterized adiabatic state preparation approach [22, 26], or
they could be more directly related to the hardware such
as the angles on beamsplitters as was used in the ﬁrst
experimental implementation of the algorithm [18].
In
either case, the state that is produced becomes a func-
tion of the discrete set of input parameters, and we may
call the resulting state |Ψ((cid:126)θ)(cid:105). The goal of the algorithm
is to ﬁnd a set of parameters (cid:126)θ such that the expecta-
tion value of the energy (cid:104)H(cid:105) is a minimum. That is, we
exploit the Rayleigh-Ritz variational formulation of the
eigenvalue problem [42, 43] such that the best approxi-
mation to the ground state eigenvalue may be found from

min

(cid:126)θ

(cid:104)H(cid:105) ((cid:126)θ) = (cid:104)Ψ((cid:126)θ)| H |Ψ((cid:126)θ)(cid:105)
(cid:104)Ψ((cid:126)θ)|Ψ((cid:126)θ)(cid:105)

.

(18)

Generically, the VQE approach can be broken into three
subtasks, namely preparation of |Ψ((cid:126)θ)(cid:105), measurement of
(cid:104)H(cid:105) ((cid:126)θ) with respect to |Ψ((cid:126)θ)(cid:105), and the update of (cid:126)θ based
on the measured values. In this work we focus on how
projective measurement type approaches can be extended
and better utilized.

In particular, we advocate a projective measurement
approach for the determination of the average energy
(cid:104)H(cid:105) ((cid:126)θ) through repeated state preparation and partial
tomography. The speciﬁc Pauli measurements one per-
forms following state preparation can be derived from
the mapping from fermionic operators to qubits such as
the JW transformation. That is, without considering po-
tential variance reducing optimizations, the estimator for
our average may be constructed as

(cid:88)

ij

(cid:104)H(cid:105) ((cid:126)θ) =

†
i aj(cid:105) ((cid:126)θ) +
(cid:104)a

1
2

(cid:88)

ijkl

†
hijkl (cid:104)a
i a

†
jakal(cid:105) ((cid:126)θ)

(19)

†
†
†
jakal(cid:105) ((cid:126)θ) being de-
i aj(cid:105) ((cid:126)θ) and (cid:104)a
with each average (cid:104)a
i a
termined by ﬁrst mapping the operator to a Pauli string
through the JW transformation, and determining the av-
erage by repeated state preparation and measurement of
the resulting term on the quantum state |Ψ((cid:126)θ)(cid:105). The
energy estimator is then evaluated by classically adding
each of the individual estimators along with the weight
factors hijkl. However, as we will emphasize, the in-
formation gained by evaluating the expectation values
†
†
(cid:104)a
jakal(cid:105) on a quantum state is actually far greater than
i a
simply the energy.
As has been shown previously [22], the minimization
can be modiﬁed using penalty terms to enforce certain
constraints on the ﬁnal solution, similar to other penalty
methods used in quantum computing [44]. This is done
by modifying to Hamiltonian to

(cid:88)

i

6

of a diﬀerent symmetry than the ground state. An exam-
ple of this is when the ground state is known to be a spin
singlet while excited states of interest are spin triplets.

To enforce desired symmetries in the linear subspace,
one ﬁrst constructs the matrix representation of both the
Hamiltonian and the symmetry operator O in the lin-
ear response subspace as was done for the Hamiltonian.
General expressions for these expansions are given later
in the supplemental information. The eigenvectors cor-
responding to the desired symmetry eigenvalues of OLR
may then be used to project the Hamiltonian into a par-
ticular symmetry subspace, where a subsequent diagonal-
ization yields the optimal solution subject to the symme-
try constraint.

H → H +

λi(Oi − oi)2

(20)

D. Quantum Channel Model Solution

where Oi and oi are the corresponding symmetry op-
erators and eigenvalues desired.
In the limit that the
penalty parameters λi approach inﬁnity, the solutions of
the minimization exactly satisfy the desired symmetry,
assuming it is possible with the given parameterization
of the wavefunction.
In practice ﬁnite values of λi are
usually suﬃcient to satisfy the symmetry to a desired
precision. Of particular interest in this work will be the
spin and number operators S2 and N . We note that if
the symmetry operator is a one-fermion operator such as
the number operator N , then this modiﬁcation requires
no additional measurements beyond those required for
the original measurements.

C. Symmetries in the subspace

One advantage of the QSE approach is that the addi-
tional structure of the linear subspace allows one to ex-
actly enforce symmetries. As discussed in the body of the
text, with this representation of the operator and overlap
in this linear subspace, the optimal solution within this
subspace can be found by solving the generalized eigen-
value problem

Here we present the short proof that the quantum
channel state preparation model is equivalent to a Hermi-
tian eigenvalue problem on the transformed Hamiltonian

†
i HKi. Starting with the original problem

H(cid:48) =(cid:80)

i K

(cid:33)

(cid:35)

min|Ψ(cid:105) Tr

Ki |Ψ(cid:105)(cid:104)Ψ| K

†
i

H

.

(22)

(cid:34)(cid:32)(cid:88)

i

we require that the function we are minimizing vanish
under arbitrary variations in the state (cid:104)Ψ| → (cid:104)Ψ| +
(cid:104)δΨ| (note that we only need consider variations in the
bra(dual) for simplicity due to the symmetric real val-
ued nature of this functional), and enforce the constraint
of normalization on the pure state through a Lagrange
multiplier E, resulting in

(cid:33)

(cid:35)

Ki |Ψ(cid:105)(cid:104)δΨ| K

†
i

H

− E(cid:104)δΨ|Ψ(cid:105) = 0

(23)

(cid:34)(cid:32)(cid:88)

i

Tr

By cyclic invariance of the trace and independence of |Ψ(cid:105)
from i, equivalently

Tr [|Ψ(cid:105)(cid:104)δΨ| H

(cid:48)

] − E(cid:104)δΨ|Ψ(cid:105) = 0

(24)

HLRC = SLRCE.

(21)

Expanding the trace over a basis composed of |Ψ(cid:105) and
its orthogonal complement

Expanding the problem into a linear subspace also al-
lows the use of additional analysis and solution tools.
One tool of great practical is the ability to enforce par-
ticular symmetries in this linear subspace. For example,
in the JW encoding of the quantum chemistry Hamilto-
nian, all number states from Ne = 0 to M are encoded,
however often only a particular number state is of phys-
ical interest. The non-linear penalty method introduced
for the VQE is one way to enforce this symmetry on the
reference, however it can be prohibitively expensive and
also may not generalize well to excited states if they are

(cid:48)

(cid:104)δΨ| H

|Ψ(cid:105) − E(cid:104)δΨ|Ψ(cid:105) = 0.

(25)

By requiring that this vanish under arbitrary variations
(cid:104)δΨ| we arrive at the eigenvalue equation

H

|Ψ(cid:105) = E |Ψ(cid:105)

(26)
and the Hermiticity of H(cid:48) follows trivially from the Her-
miticity of H and the form of H(cid:48), guaranteeing it may
be diagonalized by a unitary matrix.

(cid:48)

E. Quantum Channels

While the quantum channels used in this work are stan-
dard, for completeness we detail the speciﬁc Kraus opera-
tors and channels used in this section as well as our map-
pings between the experimental parameters correspond-
ing to the total experiment time Tp, the decay time T1,
and the dephasing time T2. In particular, we will recall
the Kraus operator deﬁnitions for the dephasing, ampli-
tude and phase damping, and depolarizing channel in
terms of these parameters.

One of the simplest quantum channels is the dephas-
ing channel, which is related to the T2 time of quantum
systems. It has a set of Kraus operators deﬁned by

(cid:88)
(cid:114)
(cid:114)

i

KiρK

†
i

˜pi
2

I

1.0 −
˜pi
2

Z

FP (˜pi)[ρ] =

K0 =

K1 =

(27)

(28)

(29)

(30)

(cid:19)

(cid:19)

(cid:18)

(cid:18)

where Z is the standard Pauli z matrix. The eﬀect of
this map on an arbitrary one-particle density matrix is
given by

FP (˜pi)[ρ] =

ρ00

(1 − ˜pi)ρ10

(1 − ˜pi)ρ01

ρ11

where we choose the values of ˜pi = 1− exp(−Tp/T2) such
that the resulting action on a one qubit density matrix
is given by

FP (˜pi)[ρ] =

ρ00

e−Tp/T2ρ10

e−Tp/T2ρ01

ρ11

(31)

Another important quantum channel we will consider
in more detail in this work is an amplitude and phase
damping channel applied independently to each qubit
with three input parameters, namely a total time of
state preparation Tp and the qubit decay and dephas-
ing times T1 and T2. Mathematically, we construct the
amplitude and phase damping channels in a Kraus opera-
tors formalism such that the quantum map FAP (pi)[ρ] =
FP (˜pi) [FA(pi)[ρ]] where FA and FP are amplitude and
phase damping operators. FP is deﬁned as above, and
FA is given by

†
i

KiρK

(cid:88)
(cid:18) 1
(cid:18) 0 √pi
(cid:19)
0 √1 − pi

0

i

.

0

0

FA(pi)[ρ] =

K0 =

K1 =

(cid:19)

(32)

(33)

(34)

The probabilities are determined by the probability such
an event would have occurred in the preceding gate op-
eration, given some values of T1 and T2.

7

(cid:19)

The eﬀect of the composite map on an arbitrary one-

particle density matrix is given by

(cid:18)

FAP (pi)[ρ] =

ρ00 + piρ11

(1 − ˜pi)√1 − piρ01
(1 − ˜pi)√1 − piρ10
(cid:19)
(cid:18) ρ00 + (1 − e−Tp/T1 )ρ11 e−Tp/T2ρ01

(1 − pi)ρ11

e−Tp/T2ρ10

e−Tp/T1ρ11

.

(35)

and the values of pi and ˜pi are determined such that

FAP (˜pi)[ρ] =

It’s clear from this construction that the relevant dimen-
sionless parameters that determine performance will be
Tp/T1 and Tp/T2, or the ratios of the state preparation
time to the decay and dephasing time of the qubits.

(36)

Finally, we also consider the depolarizing quantum
channel FD that corresponds to uniform contraction of
the Bloch sphere of a qubit, and has corresponding Kraus
operators given by

KiρK

1 − pi
X

i

(cid:88)
(cid:112)
(cid:114) pi
(cid:114) pi
(cid:114) pi

3

3

3

Y

Z

FD(pi)[ρ] =

K0 =

K1 =

K2 =

K3 =

†
i

(37)

(38)

(39)

(40)

(41)

where X, Y , and Z correspond to the standard Pauli
matrices.
In the case of the depolarizing channel, we
choose pi = 1 − exp(−Tp/T2).
The qualitative eﬀects of a diﬀerent number of channels
under the VCS model on the electronic ground state of H2
in a STO-3G basis are depicted in Fig. 6. In this work, all
channels utilize parameters of (Tp/T1) = (Tp/T2) = 0.05,
or a total gate sequence time corresponding to roughly
5% of an expected coherence time.

F. Spin Quantum Subspace Expansion

While the fermionic speciﬁcation of the quantum sub-
space expansion (QSE) is of great interest for the study
chemistry and materials, it is valuable to consider such
expansions at the level of qubits as well. Moreover, be-
fore using a quantum device, fermionic problems are ﬁrst
mapped to qubit systems where similar considerations
will apply. Given a quantum state of N qubits |Ψ(cid:105), we
can deﬁne a qubit QSE about that state as

ik |Ψ(cid:105) | αi ∈ [I, X, Y, Z](cid:9)

q =(cid:8)σα1

Bk

i1 σα2

i2 . . . σαk

(42)

where an operator σα
is Pauli operator acting on qubit
i
i and α identiﬁes if the operator is I, X, Y , or Z. This

8

exclusively focuses on the performance of error supres-
sion in fermionic QSE in this work, leaving more general
expansions as a subject of future research.

G. Linear Response Representations from RDMs

In this short section we explicitly construct the repre-
sentations of one- and two-body fermion operators in the
linear response subspace from the reduced density ma-
trices of the system. The reduced density matrices are
deﬁned as

kDi1i2...ik

j1j2...jk =

=

†
†
†
1
k! (cid:104)Ψ| a
ik ajk ajk−1 ...aj1 |Ψ(cid:105)
i2...a
i1a
†
†
†
1
Tr[a
i1 a
i2 ...a
ik ajk ajk−1...aj1 ρ]
k!

(43)

where we call kD the k fermion reduced density matrix
or k−RDM. We will examine matrix elements that cou-
ple the reference state |Ψ(cid:105) denoted by index g and the
linear response space. For any operator O, these matrix
elements are deﬁned as

†
†
Oij
g = (cid:104)Ψ| (a
i aj)
†
†
Oij
kl = (cid:104)Ψ| (a
i aj)

†
†
O |Ψ(cid:105) = Tr[(a
Oρ]
i aj)
†
†
†
kal |Ψ(cid:105) = Tr[(a
Oa
i aj)

†
Oa
kalρ]

(44)

(45)

A crucial factor in all the above calculations is the overlap
operator or metric S, which in the linear subspace of ρ is
given by

par have the following

l − 2 2Djk
li .
pr a†
(cid:105)

One-electron operators F =(cid:80)

g = 1Dj
Sij
Sij
kl = δik

i
1Dj

matrix elements

(cid:88)
(cid:88)

pr

(cid:104)
(cid:104)

pr

F ij

g =

F ij

kl =

ri

δip

1Dj

rl + δipδkr

r − 2 2Djp
(cid:105)
2Djp
.
pqrs a†

−2δik
li − 6 3Djkp

Two-body operators V = (cid:80)

−2δkr

2Djp

rli

elements given by

1Dj

l + 2δip

(46)

(47)

2Djk
rl

(48)

(49)

(cid:88)
(cid:88)

pqrs

(cid:104)
(cid:104)

pqrs

V ij
g =

V ij
kl =

pa†

qaras have matrix

(cid:105)

2δip

2Djq

sr − 2δiq

2Djp

sr + 6 3Djpq

sri

6δik

3Djpq

srl + 2δipδkr

2Djq

(50)

2Djq
rl

sl − 2δipδks
2Djp
rl

srl − 2δiqδkr
srl + 6δkr

3Djpq

2Djp
sli − 6δks

sl + 2δiqδks
3Djpq
rli

3Djkq
− 6δip
3Djkp
+ 6δiq
−24 4Djkpq

srli

(cid:105)

.

(51)

The Hamiltonian and any other operators expressed
as sums of one- and two-body operators in the linear re-
sponse subspace can be formed by simply summing these
expressions together.

FIG. 6. The exact solution of the VCS model for the ground
state of H2 is shown for a number of diﬀerent quantum chan-
nels including amplitude and phase damping (AP), dephasing
only (Ph), and depolarizing noise (Dep). These results are
shown along side both the exact (Ex) ground state, an anti-
symmetric product state approximation (RHF), and the best
solution of a dephasing channel constrained to have correct
spin (S2 = 0).
It is seen that dephasing noise is suﬃcient
to destroy the entanglement required to describe the dissoci-
ated limit, in that the solution without symmetry constraints
obtains an accurate energy, but only by breaking spin symme-
try in an unphysical way, as evidenced by the diﬀerence when
compared to the optimal dephasing solution under symme-
try constraints. Other types of noise raise the energy of the
whole curve due to number symmetry breaking. The kink
in the curves without symmetry enforcement results from a
spin symmetry breaking in the variationally optimal solution
in the presence of decohering noise.

hierarchy expands in a basis that has low Hamming dis-
tance (or number of spins diﬀerent) from the original
state. Whether this constitutes a good approximation
hierarchy will depend on this problem of interest, and
indeed hierarchies should be based on the interactions
the problems are likely to experience. However, low or-
der truncations of this hierarchy play an interesting role
with respect to error suppression.

Speciﬁcally, imagine that after preparation of |Ψ(cid:105) the
state is passed through a channel in which one if its
spins is acted upon by a Pauli error operator such as
X1. By expanding in B1
q , the original desired state is
contained within the subspace, and the error can be cor-
rected exactly through the solution of the linear eigen-
value problem on B1
q . More generically, k qubit errors
can be mitigated by solving the problem in the subspace
Bk
q , requiring again, only additional measurements and
classical computation. This is especially appealing for
pre-threshold devices and those with minimal error cor-
rection, as it utilizes classical computation to extend the
capabilities of the quantum device. Our numerical work

0.51.01.52.02.53.0R(˚A)−1.1−1.0−0.9−0.8−0.7−0.6E(Eh)ExPhAPDepPh(S2=0)RHFexpansions as

1D = 1∆
2D = 2∆ + 1∆ ∧ 1∆
3D = 3∆ + 32∆ ∧ 1∆ + 1∆ ∧ 1∆ ∧ 1∆
4D = 4∆ + 43∆ ∧ 1∆ + 32∆ ∧ 2∆

+ 62∆ ∧ 1∆ ∧ 1∆ + 1∆ ∧ 1∆ ∧ 1∆ ∧ 1∆.

9

(55)

(56)

(57)

(58)

Physically, we may interpret terms such as m∆ ∧ n∆ as
the product between irreducible m and n body correla-
tions which contribute to the overall (m + n) body cor-
relations.

I. Approximate QSE

While the fermionic QSE approach has favorable co-
herence time requirements, it can still be prohibitively
expensive in the number of measurements required. As
such, we examine here some techniques that have been
developed in classical electronic structure theory for 2-
RDMs for approximating the eigenvalue problem requir-
ing only the 3-RDM or even only the 2-RDM for ap-
proximating the solution in the linear response space
B1
f following closely the techniques developed by Mazz-
iotti [45, 46]. In such a scheme, even the original measure-
ments used to determine the ground state energy are suf-
ﬁcient to determine approximations for the excited states
of the system.

Suppose that the quantum state prepared |Ψ(cid:105) is the
exact ground state. In this case, the following commu-
tator identity may be used to remove dependence of the
solution on the 4-RDM

†
H ij
kl = (cid:104)Ψ| (a
i aj)

†

[H, a

†
†
†
kal]|Ψ(cid:105) + Eg (cid:104)Ψ| (a
i aj)

†
kal |Ψ(cid:105)(59)
a

where Eg is the eigenvalue associated with the exact
ground state, or expectation value of |Ψ(cid:105) in the case
of an approximation, which depends at most on the 2-
RDM. The commutator reduces the rank of this expres-
sion such that it depends at most on the 3-RDM requir-
ing only O(M 6) terms to be measured, and is exact in
the case that |Ψ(cid:105) is exact. The explicit dependence on
the 3-RDM can be removed through approximate den-
sity matrix reconstruction techniques, requiring only the
original 2-RDM measurements to produce excited state
approximations. The simplest such approximation ne-
glects the irreducible 3-body correlations in the commu-
tator expansion above, setting 3∆ = 0, where 3∆ is the
3 particle cumulant, and we call this approximation the
zero in commutator approximation (ZC).

Another similar approximation starts from the origi-
nal expression for the 4-RDM without the commutator
reduction, and assumes that both the irreducible 3 and
4 particle correlations are negligible and reconstructs the
4-RDM from only the 2-RDM assuming 4∆ = 3∆ = 0.

FIG. 7. The ground and ﬁrst two excited states of H2 are
plotted as a function of internuclear separation using both
the Zero Approximation (ZA) and the Zero Approximation
under the commutator construction (ZC). Both methods re-
quire only the original measurements used for the ground state
to approximate the excited states, and we see here that ZC
achieves an extremely high accuracy, while ZA is qualitatively
correct in some cases but produces sub-variational solutions
in others.

H. Cumulant Expansions of the k−RDMs

(cid:104)

Here we document the cumulant expansions of the re-
duced density matrices up to k = 4, which are important
in approximation schemes for the reduced density ma-
trices. The fermionic k−RDM on a quantum state ρ is
deﬁned by

kDi1i2...ik

j1j2...jk =

1
k!

Tr

†
i1a
a

†
†
ik ajk ajk−1...aj1 ρ
i2 ...a

(52)

The cumulant expansions decompose the reduced den-
sity matrices into their non-separable (connected) com-
ponents and separable unconnected components, and are
quite useful for both developing approximations and en-
hancing understanding. A convenient notation for ex-
pressing these expansions is given by the Grassmann
wedge product deﬁned generally by

(cid:105)

(cid:18) 1

(cid:19)2(cid:88)

N !

π,σ

a ∧ b =

(π)(σ) π σ a ⊗ b

(53)

where π and σ are permutations on the upper and lower
indices of the tensor a ⊗ b and  denotes the parity of
each permutation. As an example one might consider
the wedge product of a cumulant matrix with itself

(cid:2)1∆ ∧ 1∆(cid:3)i1i2

j1j2

=

1
2

(cid:0)1∆i1

j1

1∆i2

j2 − 1∆i1

j2

1∆i2
j1

(54)

(cid:1) .

With this notation, the reduced density matrices up to
k = 4 are iteratively deﬁned in terms of the cumulant

0.00.51.01.52.02.53.0R(˚A)−1.5−1.0−0.50.00.51.0E(Eh)Exact(Ne=2)ZAZCWe term this this full zero approximation, or ZA. The
performance of the ZC and ZA methods are shown in

Fig. 7. We see that the extra structure in the ZC ap-
proximations yields superior qualitative and quantitive
accuracy for the sample problem.

10

[1] R. P. Feynman, Int. J. Theor. Phys. 21, 467 (1982).
[2] A. Aspuru-Guzik, A. D. Dutoi, P. J. Love, and M. Head-

and M. Troyer, ArXiv e-prints (2015), arXiv:1510.03859
[quant-ph].

Gordon, Science 309, 1704 (2005).

[3] I. Kassal, J. D. Whitﬁeld, A. Perdomo-Ortiz, M.-H.
Yung, and A. Aspuru-Guzik, Ann. Rev. Phys. Chem.
62, 185 (2011).

[4] J. Huh, G. G. Guerreschi, B. Peropadre, J. R. McClean,

and A. Aspuru-Guzik, Nat. Photon. 9, 615 (2015).

[5] D. Wecker, M. B. Hastings, and M. Troyer, Phys. Rev.

A 92, 042303 (2015).

[6] L. Mueck, Nat. Chem. 7, 361 (2015).
[7] D. S. Abrams and S. Lloyd, Phys. Rev. Lett. 79, 4 (1997).
[8] D. S. Abrams and S. Lloyd, Phys. Rev. Lett. 83, 5162

(1999).

[9] A. Y. Kitaev, Russian Math. Surveys 52, 1191 (1997).

[10] J. R. McClean, R. Babbush, P. J. Love, and A. Aspuru-

Guzik, J. Phys. Chem. Lett. 5, 4368 (2014).

[11] R. Babbush, J. R. McClean, D. Wecker, A. Aspuru-
Guzik, and N. Wiebe, Phys. Rev. A 91, 022311 (2015).
[12] M. B. Hastings, D. Wecker, B. Bauer, and M. Troyer,

Quantum Inf. Comput. 15, 1 (2015).

[13] D. Poulin, M. B. Hastings, D. Wecker, N. Wiebe,
A. C. Doherty, and M. Troyer, ArXiv e-prints (2014),
arXiv:1406.4920 [quant-ph].

[14] R. Babbush, D. W. Berry, I. D. Kivlichan, A. Y. Wei,
P. J. Love, and A. Aspuru-Guzik, ArXiv e-prints (2015),
arXiv:1506.01020 [quant-ph].

[15] B. P. Lanyon, J. D. Whitﬁeld, G. G. Gillett, M. E.
Goggin, M. P. Almeida, I. Kassal, J. D. Biamonte,
M. Mohseni, B. J. Powell, M. Barbieri, A. Aspuru-Guzik,
and A. G. White, Nat. Chem. 2, 106 (2010).

[26] P. J. J. O’Malley, R. Babbush,

I. D. Kivlichan,
J. Romero, J. R. McClean, R. Barends, J. Kelly,
P. Roushan, A. Tranter, N. Ding, B. Campbell, Y. Chen,
Z. Chen, B. Chiaro, A. Dunsworth, A. G. Fowler, E. Jef-
frey, A. Megrant, J. Y. Mutus, C. Neill, C. Quintana,
D. Sank, A. Vainsencher, J. Wenner, T. C. White, P. V.
Coveney, P. J. Love, H. Neven, A. Aspuru-Guzik, and
J. M. Martinis, ArXiv e-prints (2015), arXiv:1512.06860
[quant-ph].

[27] K. Kraus, A. Bhm, J. D. Dollard, and W. H. Wootters,
eds., States, Eﬀects, and Operations Fundamental No-
tions of Quantum Theory (Springer Berlin Heidelberg,
1983).

[28] T. Watermann, A. Scherrer, and D. Sebastiani, in Many-
Electron Approaches in Physics, Chemistry and Mathe-
matics, Mathematical Physics Studies, edited by V. Bach
and L. Delle Site (Springer International Publishing,
2014) pp. 97–110.

[29] W. J. Hehre, J. Chem. Phys. 51, 2657 (1969).
[30] P. Jordan and E. Wigner, Zeitschrift f¨ur Physik 47, 631

(1928).

[31] I. Kassal, S. P. Jordan, P. J. Love, M. Mohseni, and
A. Aspuru-Guzik, Proc. Natl. Acad. Sci. U.S.A. 105,
18681 (2008).

[32] N. J. Ward, I. Kassal, and A. Aspuru-Guzik, J. Chem.

Phys. 130, 194105 (2009).

[33] B. Toloui and P. J. Love, ArXiv e-prints

(2013),

arXiv:1312.2579 [quant-ph].

[34] J. Welch, D. Greenbaum, S. Mostame, and A. Aspuru-

[16] D. Lu, N. Xu, R. Xu, H. Chen, J. Gong, X. Peng, and

Guzik, New J. Phys. 16, 033040 (2014).

J. Du, Phys. Rev. Lett. 107, 020501 (2011).

[35] J. D. Whitﬁeld, ArXiv e-prints (2015), arXiv:1502.03771

[17] A. Aspuru-Guzik and P. Walther, Nat. Phys. 8, 285

[quant-ph].

(2012).

[18] A. Peruzzo, J. McClean, P. Shadbolt, M.-H. Yung, X.-Q.
Zhou, P. J. Love, A. Aspuru-Guzik, and J. L. O’Brien,
Nat. Commun. 5 (2014).
[19] Y. Wang, F. Dolde,

J. Biamonte, R. Babbush,
V. Bergholm, S. Yang,
I. Jakobi, P. Neumann,
A. Aspuru-Guzik, J. D. Whitﬁeld, and J. Wrachtrup,
ACS Nano (2015).

[20] Y. Shen, X. Zhang, S. Zhang, J.-N. Zhang, M.-H. Yung,
(2015), arXiv:1506.00443

and K. Kim, ArXiv e-prints
[quant-ph].

[21] S. Barrett, K. Hammerer, S. Harrison, T. E. Northup,
and T. J. Osborne, Phys. Rev. Lett. 110, 090501 (2013).
[22] J. R. McClean, J. Romero, R. Babbush, and A. Aspuru-
Guzik, ArXiv e-prints (2015), arXiv:1509.04279 [quant-
ph].

[23] M. H. Yung, J. Casanova, A. Mezzacapo, J. R. McClean,
L. Lamata, A. Aspuru-Guzik, and E. Solano, Sci. Rep.
4, 1 (2014).

[36] T. Helgaker, P. Jorgensen,

and J. Olsen, Molecular

electronic-structure theory (John Wiley & Sons, 2014).

[37] R. Somma, G. Ortiz, J. Gubernatis, E. Knill,

and

R. Laﬂamme, Phys. Rev. A 65, 17 (2002).

[38] S. Bravyi and A. Kitaev, Ann. Phys. 298, 18 (2000).
[39] J. T. Seeley, M. J. Richard, and P. J. Love, J. Chem.

Phys. 137, 224109 (2012).

[40] A. Tranter, S. Soﬁa, J. Seeley, M. Kaicher, J. McClean,
R. Babbush, P. V. Coveney, F. Mintert, F. Wilhelm, and
P. J. Love, Int. J. Quant. Chem. 115, 1431 (2015).

[41] N. Moll, A. Fuhrer, P. Staar, and I. Tavernelli, ArXiv

e-prints (2015), arXiv:1510.04048 [quant-ph].

[42] D. Weinstein, Proc. Natl. Acad. Sci. U.S.A. 20, 529

(1934).

[43] J. MacDonald, Phys. Rev. 46, 828 (1934).
[44] A. D. Bookatz, E. Farhi, and L. Zhou, ArXiv e-prints

(2014), arXiv:1407.1485 [quant-ph].

[45] D. A. Mazziotti, Physical Review A 68, 052501 (2003).
[46] L. Greenman and D. A. Mazziotti, J. Chem. Phys. 128,

[24] P.-L. Dallaire-Demers and F. K. Wilhelm, ArXiv e-prints

114109 (2008).

(2015), arXiv:1508.04328 [quant-ph].

[25] B. Bauer, D. Wecker, A. J. Millis, M. B. Hastings,

