6
1
0
2

 
r
a

 

M
1
2

 
 
]

.

R
P
n
i
f
-
q
[
 
 

1
v
9
8
3
6
0

.

3
0
6
1
:
v
i
X
r
a

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

Abstract. We explore the robust replication of forward-start straddles given quoted (Call and Put options)

market data. One approach to this problem classically follows semi-inﬁnite linear programming arguments, and

we propose a discretisation scheme to reduce its dimensionality and hence its complexity. Alternatively, one

can consider the dual problem, consisting in ﬁnding optimal martingale measures under which the upper and

the lower bounds are attained. Semi-analytical solutions to this dual problem were proposed by Hobson and

Klimmek [13] and by Hobson and Neuberger [14]. We recast this dual approach as a ﬁnite dimensional linear

programme, and reconcile numerically, in the Black-Scholes and in the Heston model, the two approaches.

1. Introduction

Since David Hobson’s seminal contribution [11], an important stream of literature has focused on developing

model-free sub(super)-hedges for multi-dimensional derivative products or path-dependent options, given a set

of European option instruments. The key observation is that the model-free sub(super)-hedging cost is closely

related to the Skorokhod Embedding problem (see the exhaustive survey papers by Hobson [12] and Ob l´oj [17]

in the context of mathematical ﬁnance). Recently, Beiglb¨ock, Henry-Labord`ere and Penkner [3] studied this

problem in the framework of martingale optimal transport theory. Assuming that European Call/Put option

prices are known for all strikes and some maturities (equivalently the marginal distributions of the asset price

are known at these times), optimal transport then yields a no-arbitrage range of prices of a derivative product

consistent with these marginal distributions. The primal problem endeavours to ﬁnd the supremum, or the

inﬁmum, of these prices over all joint martingale measures (transport plans). The dual problem, in turn, seeks

to ﬁnd the ‘best’ super(sub)-replicating portfolio; this dual formulation has the advantage of a natural ﬁnancial

interpretation and can be cast as an (inﬁnite) linear programme, amenable to numerical implementations, as

proposed in [9].

Forward-start options (of Type I and of Type II) are among the simplest products amenable to these tech-
niques. The upper bound price for the at-the-money Type-II forward-start straddle (with payoﬀ |St+τ − St| for
some t, τ > 0) was computed by Hobson and Neuberger [14], where the support of the optimal martingale mea-

sure is a binomial tree. Unfortunately the optimal measure and the associated super-hedging portfolio are not

available analytically. The martingale optimal transference plan for the lower bound price of the at-the-money

Type-II forward-start straddle has been characterised semi-analytically by Hobson and Klimmek [13], and the

transference plan (supported along a trinomial tree) is found by solving a set of coupled ODEs. Recently, Campi,

Laachir and Martini [6] studied the change of numeraire in these two-dimensional optimal transport problems

Date: March 22, 2016.

2010 Mathematics Subject Classiﬁcation. 91G20, 91G80, 90C46, 90C05, 90C34.

Key words and phrases. martingale optimal transport, robust bounds, forward-start, heston.
The authors are indebted to Claude Martini for stimulating discussions. AJ acknowledges ﬁnancial support from the EPSRC

First Grant EP/M008436/1.

1

2

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

and showed that, under some technical conditions, the lower bound for the Type-I at-the-money forward-start

straddle is also attained by the Hobson-Klimmek transference plan.

In this paper, we numerically investigate the no-arbitrage bounds of the Type-II forward-start straddle. The

inﬁnite-dimensional linear programme corresponding to the optimal transport problem is presented in Section 2.

Section 3 focuses on a reduction of the dimension of the problem, by discretising the support of the marginal

distributions at times t and t + τ , which respects the consistency of the primal and the dual problems with

observed option prices, and yields robust numerical results. Our discretisation method diﬀers from that of

Henry-Labord`ere [9], and requires far fewer points, thus reducing the complexity of the ﬁnite-dimensional linear

programmes to be solved, thereby improving the algorithmic speed. In Section 5, we specialise our computation

of the upper and lower bounds to the cases where the marginal distributions are generated from a Black-Scholes

model (lognormal marginals) and from the Heston stochastic volatility model. In the lower bound at-the-money

case we numerically solve, in Section 4, the coupled ordinary diﬀerential equations associated with the Hobson-

Klimmek transference plan, and show that it is in striking agreement with the LP solution of the dual problem.

In Section 6 we numerically solve the primal problem and provide the optimal transport plans for a large range

of strikes. The transport plans are only known for the at-the-money case [13, 14], and we highlight numerical

evidence that the optimal transference plans are more subtle in these cases, and appear to be a combination of

the lower and upper bound at-the-money plans. The optimal transport plan gives insight into the key model

risk for this product: intuitively, the extremal measure exploits this risk to produce the maximum (or minimum)

value of the product. The key model risk for forward-start options appears to be the exposure of the product

to the kurtosis of the conditional distribution of the asset price process; see in particular Sections 4 and 6

and [13, 14].

In the examples explored in Section 5 the range of forward smiles consistent with the marginal laws is

large, and of the same magnitude as shown in [9, Section 5.5]. This supports the claim that using European

vanilla options to ‘lock-in’ (replicate) forward volatility or hedge forward volatility dependent claims seems

illusory. Forward-start options should be seen as fundamental building blocks for exotic option pricing and

not decomposable (or approximately decomposable) into European options. Models used for forward volatility-

dependent exotics should be able to calibrate forward-start option prices and should produce realistic forward

smiles consistent with trader expectations and observable prices.

Notations: Bb(R) denotes the set of bounded measurable functions on the real line, R+ := [0,∞) represents

the positive half-line; h·,·i denotes the Euclidean inner product, and k · k the L1 norm.

2. Problem formulation

We consider an asset price process (St)t≥0 starting at S0 = 1, and we assume that interest rates and dividends
are null. For t, τ > 0, let µ and ν denote the distributions of St and St+τ , assumed to have common ﬁnite mean,
supported on [0,∞), and absolutely continuous with respect to the Lebesgue measure. We say that the bivariate
(y− x)ζ(dx, dy) = 0
for each x ∈ R+. Following [19], we shall say that µ and ν are in convex, or balayage, order (which we denote
(y−x)+ν(dy) for all x ∈ R. This assumption
ensures (see [2]) that the set M(µ, ν) is not empty. Our objective is to ﬁnd the tightest possible lower and
upper bounds, consistent with the two marginal distributions, for the forward-start straddle payoﬀ |St+τ − KSt|

law ζ is a martingale coupling, and write ζ ∈ M(µ, ν), if ζ has marginals µ and ν andRy∈R+
µ (cid:22) ν) if they have equal means and satisfyRR+

(y−x)+µ(dy) ≤RR+

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

3

with K > 0. To this end we deﬁne our primal problems:

(2.1)

P(µ, ν) := inf

ζ∈M(µ,ν)ZR2

+

|y − Kx|ζ(dx, dy),

and

P(µ, ν) := sup

ζ∈M(µ,ν)ZR2

+

|y − Kx|ζ(dx, dy).

We now deﬁne the following sub- and super-replicating portfolios:

The dual problems are then deﬁned as the supremum (inﬁmum) over all sub (super)-replicating portfolios:

Q :=(cid:8)(ψ0, ψ1, δ) ∈ L1(µ) × L1(ν) × Bb(R+) : ψ1(y) + ψ0(x) + δ(x)(y − x) ≤ |y − Kx|, for all x, y ∈ R+(cid:9) ,
Q :=(cid:8)(ψ0, ψ1, δ) ∈ L1(µ) × L1(ν) × Bb(R+) : ψ1(y) + ψ0(x) + δ(x)(y − x) ≥ |y − Kx|, for all x, y ∈ R+(cid:9) .
Clearly if (ψ0, ψ1, δ) ∈ Q (respectively ∈ Q) thenRR2
(ψ0,ψ1,δ)∈Q(ZR+
(ψ0,ψ1,δ)∈Q(ZR+

+ |y − Kx|ζ(dx, dy) ≥ (≤)RR+
ψ0(x)µ(dx) +ZR+
ψ0(x)µ(dx) +ZR+

ψ0(x)µ(dx) +RR+
ψ1(y)ν(dy)) =: D(µ, ν),
ψ1(y)ν(dy)) =: D(µ, ν).

|y − Kx|ζ(dx, dy) ≥

|y − Kx|ζ(dx, dy) ≤

+

ZR2
ZR2

+

ψ1(y)ν(dy).

(2.2)

sup

inf

In [3, Theorem 1 and Corollary 1.1], the authors proved (actually for a more general class of payoﬀ functions)
that there is no duality gap, namely that both equalities P(µ, ν) = D(µ, ν) and P(µ, ν) = D(µ, ν) hold. However,
the optimal values may not be attained in the dual problems, as proved in [3, Proposition 4.1]. In [13] and [14]

the authors showed that in the at-the-money case (K = 1), with an additional dispersion assumption on the

measures µ and ν the optimal values of the dual problems (2.2) are actually attained. More precisely, the

following result summarises [13] (see also Section 4 below for more details about the technical assumption):

Assumption 2.1. The support of η := (µ − ν)+ is given by an interval [a, b] ⊂ R+, and the support of
γ := (ν − µ)+ is given by R+ \ [a, b].
Theorem 2.2. The set equalities D(µ, ν) = P(µ, ν) and D(µ, ν) = P(µ, ν) hold, and the primal optima in (2.1)
are attained: there exist martingale measures QL and QU in M(µ, ν) such that P(µ, ν) = EQL|St+τ − KSt|
and P(µ, ν) = EQU|St+τ − KSt|. Furthermore, under Assumption 2.1, the inﬁmum and supremum in the dual
problems (2.2) are attained when K = 1.

3. No-Arbitrage discretisation of the primal and dual problems

3.1. No-arbitrage discretisation of the density. Let t > 0 be some given time horizon, St the random
variable describing the stock price at time t, and µ the law of St. Fix m > 1 and suppose that we are
given a set x = (x1, . . . , xm) ∈ Rm
+ of points 0 < x1 < x2 < ... < xm in the support of µ, and a discrete
distribution q with atom qi at the point xi sampled from µ (for example if µ admits density f then one can
take qi = f (xi)/Pm
i=1 f (xi)). We wish to ﬁnd a discrete distribution p, close to q, matching the ﬁrst l ≤ m
moments of µ, in particular satisfying the ‘martingale’ condition hp, xi = 1. Let T : R+ → Rl
+ be given by
T(x) := (x, x2, ..., xl) and deﬁne the moment vector T :=RR+
+. Such a matching condition is not
necessarily consistent with a given set of (European) option prices. In order to ensure that the discrete density

T(x)µ(dx) ∈ Rl

re-prices these options, we add a second layer: Borwein, Choksi and Mar´echal [4] suggested to recover discrete

probability distributions from observed market prices of European Call options by minimising the Kullback-

Leibler divergence to the uniform distribution (they also comment that any prior distribution can be chosen).

4

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

In particular given the law µ of St and a set of European Call options P ∈ RM
K1 < ··· < KM , we can solve the minimisation problem:
(3.1)

min

p∈[0,1]m:kpk=1

pi log(cid:18) pi
qi(cid:19) ,

mXi=1

subject to (cid:16)(hCj (x), pi)j=1,...,M , (hTj(x), pi)j=1,...,l(cid:17) = (P, T).

+ , maturing at t with strikes

for some prior discrete distribution q, where Cj(x) := ((x1 − Kj)+, . . . , (xm − Kj)+), for j = 1, . . . , M , denotes
the payoﬀ vector of the options and Tj(x) := (xj

m) is the j-th moment vector (j = 1, . . . , l).

1, . . . , xj

Deﬁnition 3.1. The discrete distribution p is consistent with P whenever the following hold:

i=1 pi = 1;

(i) Pm
(ii) hCj(x), pi =Pm

(iii) hT1(x), pi = hx, pi = T1 = 1;

i=1 piCj(xi) = Pj for all j = 1, . . . , M ;

Note that the last item in the deﬁnition above is nothing else than the martingale condition. It must be noted

and the price vector can be deﬁned as P :=RR+

that if the full marginal distribution µ of St is known, any ﬁnite subset of European options can be chosen above
C(x)µ(dx), where C(x) := ((x − K1)+, . . . , (x − KM )+) ∈ RM
for any x ∈ R+. In particular the solution to this problem can be obtained as a modiﬁcation of the solution
in [20], which itself is based on arguments by Borwein and Lewis [5, Corollary 2.6]:

+

(3.2)

pi =

qi exp(cid:16) hλ∗, (C(xi), T(xi))i(cid:17)
i=1 qi exp(cid:16)hλ∗, (C(xi), T(xi))i(cid:17) , where λ∗ := argmin
Pm

We can now consider the following algorithm:

λ∈RM +l(− hλ, (P, T)i + log  mXi=1

qiehλ,(C(xi),T(xi))i!) .

Algorithm 3.2.

(i) Several choices are possible for the m points 0 < x1 < ... < xm; for instance:

(a) Binomial : Let Σ denote the at-the-money lognormal volatility (for European options maturing at t).

(ii) For the discrete distribution q, we can follow several routes:

− 1(cid:17)1/2
Set δ := t/(m − 1), u := 1 +(cid:16)eδΣ2
(a) if µ admits a density fµ, then, for i = 1, . . . , m, set qi := fµ(xi)/Pm

(b) alternatively, for i = 1, ..., m, let qi := µ([xi−1, xi)) (with x0 = 0);

, d := 1 −(cid:16)eδΣ2

− 1(cid:17)1/2

(iii) Compute the discretised measure p through (3.2).

j=1 fµ(xj );

(b) Gauss-Hermite: xi := e˜xi, where ˜x1, ..., ˜xm are the nodes of an N -point Gauss-Hermite quadrature.

, and xi := ui−1dm−i;

Remark 3.3. As pointed out by Tanaka and Toda [20] the choice of discretisation points x1, . . . , xm in Algo-

The weights w(·) are chosen in accordance with a given quadrature rule; in the case of Algorithm 3.2 the weights

rithm 3.2 is dictated by the discretisation of the integralsRR+
are chosen constant w(xi) = (Pm

i=1 fµ(xi))−1 for all i = 1, . . . , m.

(C(x), T(x))dfµ(x) ≈Pm

In the particular case where the discretisation nodes and the given strikes satisfy some speciﬁc ordering, it

i=1 w(xi)(C(xi), T(xi))fµ(xi).

is possible to choose a more explicit weighting scheme p consistent with P with minimal assumptions on the

choice of discretisation:

Lemma 3.4. Let m = M + 2. Consistency with P is ensured if both sets of conditions hold:
(i) x1 < K1, xM+2 ≥ (PM−1KM − PM KM−1) / (PM−1 − PM ) and xi+1 = Ki for i = 1, . . . , M ;

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

5

(ii) pM+2 = PM / (xM+2 − KM ), p1 = 1 −

pj, and, for any i = M, . . . , 1,

M+2Xj=2

pi+1 =

1

xi+1 − Ki−1Pi−1 −

M+2Xj=i+2

pj(xj − Ki−1) ,

with the convention K0 := x1 and P0 := 1 − x1.
Proof. Note ﬁrst that, since the strikes are ordered and P satisﬁes no-arbitrage conditions (in the sense of [7,
Theorem 3.1]), the assumption xM+2 ≥ (PM−1KM − PM KM−1) / (PM−1 − PM ) immediately implies that
xM+2 > KM . The consistency of the weighting scheme with P can be written as Apx = P, with

A :=

1

x1

0
...

0

0

1

x2

(x2 − K1)

. . .
. . .
. . .

. . .

. . .
. . .
. . .

0

0



. . .

. . .
. . .
. . .

1

xM+2

(xM+2 − K1)

...

(xM − KM−1)

0

(xM+2 − KM−1)
(xM+2 − KM )



,

px :=

p1
p2
...
pM
pM+2





, P :=

1

1

P1
...
PM





.

Here A is a real upper triangular matrix, so that the system has a unique solution given in the lemma. It remains
to check that the feasible solutions of the system satisfy the additional constraints pi ≥ 0 for i = 1, . . . , M + 2.

Since xM+2 ≥ PM −1KM−PM KM −1

PM −1−PM

it follows that

pM+2 =

PM

xM+2 − KM ≤

PM−1 − PM
KM − KM−1 ≤ −KM−1 + KM
KM − KM−1

,

where the last inequality follows from the Put-Call Parity and absence of arbitrage in P. By deﬁnition we have

pM+1 =

1

KM − KM−1

(PM−1 − pM+2(xM+2 − KM−1)) =

1

KM − KM−1(cid:18)PM−1 − PM − PM

KM − KM−1

xM+2 − KM (cid:19) ,

and by assumption on xM+2 we have that pM+1 ≥ 0. Similarly for pM we have

[PM−2 − pM+1(KM − KM−2) − pM (xM+2 − KM−2)]

pM =

=

=

1

KM−1 − KM−2
PM−2 − PM−1
KM−1 − KM−2 −
PM−2 − PM−1
KM−1 − KM−2 −

PM−1 − pM+2(xM+2 − KM )

KM − KM−1

PM−1 − PM
KM − KM−1

.

Proceeding recursively we observe that for i = 2, . . . , M − 1 we have

pi =

Pi−2 − Pi−1
Ki−1 − Ki−2 −

Pi−1 − Pi
Ki − Ki−1

.

Since the prices P satisfy no-arbitrage conditions, then pi ≥ 0 for i = 1, . . . , M + 2.

Note that, when xM+2 = PM −1KM−PM KM −1

,

PM −1−PM

pM+2 =

PM−1 − PM
KM − KM−1

,

pM+1 = 0,

pi =

Pi−2 − Pi−1
Ki−1 − Ki−2 −

Pi−1 − Pi
Ki − Ki−1

,

for i = 2, . . . , M and the discretisation reduces to M + 1 points, where xM+1 = KM is discarded.

(cid:3)

6

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

Remark 3.5. One could in principle generalise Lemma 3.4 to a construction where xi+1 ∈ (Ki−1, Ki] for
i = 1, . . . , M (and obviously x1 < K1 and xM+2 > KM ). Quick computations however reveal that writing a clear
set of suﬃcient conditions for consistency with P is notationally cumbersome and practically not particularly

enlightening.

(x − K x

i )+µ(dx) = Px

3.2. Balayage-consistent discretisation. Assume now that there are M European Call options Px available
with maturity t and N options Py available with maturity t + τ , and that the measures µ and ν are calibrated
to those European options: RR+
j for
all j = 1, . . . , N . We further assume that Px and Py do not contain arbitrage (in the sense of [7, Theorem
4.2]), otherwise there is no equivalent martingale measure and the primal problem (2.1) is infeasible. For two
discretisation meshes x = (x1, . . . , xm) ∈ Rm
+, Algorithm 3.2, for instance, produces
discrete distributions px and py supported on x and y. It is not however guaranteed that the convex ordering
of the original measures µ and ν is preserved for px and py. The following lemma provides suﬃcient conditions
ensuring this.

i for all i = 1, . . . , M and RR+

+ and y = (y1, . . . , yn) ∈ Rn

j )+ν(dy) = Py

(y − K y

Lemma 3.6. Let px and py be two discrete measures supported on x and y. The following conditions altogether
ensure that px (cid:22) py:
(i) px and py have the same mean equal, y1 ≤ x1 and yn ≥ xm;
(ii) Assumption 2.1 holds with µ = px and ν = py.

Remark 3.7. In our framework, the discrete measures px and py arise as discretisations of the original mea-
sures µ and ν. If px and py are to be consistent with Px and Py, then the discretisation nodes x and y must
be ﬁner than the sets of input strikes, which we can write as

1 , y1 < K y

M and yn > K y
N ;

1 , xm > K x

j ∈ {1, . . . , N − 1}, there exists kj ∈ {2, . . . , n − 1} such that K y

• x1 < K x
• for all i ∈ {1, . . . , M − 1}, there exists ki ∈ {2, . . . , m − 1} such that K x
j ≤ ykj ≤ K y

i ≤ xki ≤ K x
Proof of Lemma 3.6. To ﬁx the notations, for any set A ⊂ R, deﬁne px(A) := P{i:xi∈A}
P{j:yj∈A}

py
j . In particular for any z ∈ [0, yn] we have

j+1.

i+1, and for all

i and py(A) :=
px

py([0, z]) = X{j≤n:yj≤z}

py
j ,

and

px([0, z]) = X{i≤m:xi≤z}

px
i .

Deﬁne furthermore the function δF : R+ → R by δF (z) := py([0, z]) − px([0, z]). Assumption 2.1 with µ = px
and ν = py, together with the boundary conditions in Lemma 3.6(i), can therefore be written as

(3.3)

( η(A) = (px(A) − py(A))+ > 0,
γ(A) = (py(A) − px(A))+ > 0,

for any A ⊆ [a, b],
for any A ⊆ [0, yn] \ [a, b].

Deﬁne now the functions fx, gy : R+ → R+ by fx(K) := hpx, (x − K)+i and gy(K) := hpy, (y − K)+i. By [2,
Chapter 2, Deﬁnition 2.1.6], the balayage condition px (cid:22) py will be satisﬁed as soon as fx and gy are convex
and fx(K) ≤ gy(K) for all K ∈ R+. Since px and py have non-negative components, the functions fx and gy
are clearly convex, so we are left to prove that fx(·) ≤ gy(·) on R+.

We ﬁrst show that the conditions y1 ≤ x1 and xm ≤ yn are necessary. If x1 < y1, then fx(K) = gy(K) = 1−K
i (xi − K) =

for all K ∈ [0, x1]. Also, for any K ∈ (x1, x2 ∧ y1), gy(K) = 1 − K and fx(K) = Pm

i=2 px

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

7

1(K−x1) > (1−K), which violates the balayage order. Similarly, if xm > yn, let i∗ := inf{i : xi ≥ yn};

i=i∗ px

i (xi − K) which yields the conclusion.

(1−K)+px
then for any K ∈ (yn, xm), gy(K) = 0 and fx(K) =Pm

Introduce now the function G : [0, yn] → R as
py

G(K) := gy(K) − fx(K) = X{j:yj >K}
= X{i:xi>K}

j (yj − K) − X{i:xi>K}
i − X{j:yj >K}

py

px

j K + X{j:yj >K}

px
i (xi − K)

(3.4)

py

j yj − X{i:xi>K}

px
i xi.

The function G is piecewise linear on [0, yn], not diﬀerentiable at the points {xi}1≤i≤m and {yj}1≤j≤n, attains
its maximum and minimum on [0, yn] and G(0) = G(yn) = 0. The lemma then follows if G(K) ≥ 0 for all
K ∈ [0, yn]. Let ∂+G denote its right derivative on [0, yn] (with the convention ∂+G(yn) = 0). The positivity
of G together with the boundary conditions at 0 and yn are therefore equivalent to the following:

where K∗ := arg maxKG(K). From (3.4), we can therefore write, for any K ∈ [0, yn],

∂+G(K) ≥ 0,
∂+G(K) = X{i:xi>K}

for all K ≤ K∗
i − X{j:yj >K}

px

and

∂+G(K) ≤ 0,
j − X{i:xi≤K}

py

py

j = X{j:yj≤K}

for all K > K∗,

px
i = δF (K),

with δF deﬁned above. Since δF is piecewise constant, it remains to show that it admits a maximum and a

minimum attained on unique subsets of [0, yn]. Note ﬁrst that δF (0) = 0 = δF (yn), and that the image of [0, yn]
by δF is exactly [−1, 1]. For any z ∈ [0, a)∪ (b, yn], δF (z) = γ([0, z]), and therefore δF is an increasing function
on [0, a) ∪ (b, yn]. On [a, b], however, one has

δF (z) = py([0, z]) − px([0, z]) = py([a, z]) − px([a, z]) + py([0, a)) − px([0, a)) = −η([a, z]) + γ([0, a)).

Since γ([0, a)) > 0 and η is a measure on [a, b], then δF is decreasing on [a, b]. Therefore there exists a
unique quadruplet (c, d, e, f ) such that [c, d] ⊂ [0, yn], [e, f ] ⊂ [0, yn] and [c, d] = arg maxzδF (z) and [e, f ] =
arg minzδF (z). It therefore follows that δF (·) ≥ 0 on [0, z∗) and δF (·) ≤ 0 on [z∗, yn], for some z∗ ∈ (d, e). (cid:3)
Remark 3.8. Note that the dispersion Assumption 2.1 intuitively implies that the variance of the underlying

price process increases with maturity, which is the case for all stochastic volatility models. Lemma 3.6 provides

general conditions to ensure that convex order is preserved under discretisation of continuous measures. These

are however diﬃcult to verify analytically for general distributions, or even for those obtained by Algorithm 3.2.

In Figure 3.2 below, we provide numerical evidence that the convex order is preserved for these distributions.

3.3. Primal and dual formulation. We focus here on the discretisation of the primal and dual formulations

for the upper bound, and note that an analogous formulation holds for the lower bound. We use Algorithm 3.2

to approximate the random variables St and St+τ by discrete random variables eSt and eSt+τ with distributions px
and py supported on x ∈ Rm
+ and y ∈ Rn
+ Xi,j
P(µ, ν) := max
(3.5)
ζ∈M m,n

+. The linear programme for the primal problem (2.1) then reads

ζi,j|yj − Kxi|,

subject to (kζi,·k)i=1,...,m = px,

(kζ·,jk)j=1,...,n = py,

(hζi,·, (xi − y)i)i=1,...,m = 0 ∈ Rm,

where M m,n

+

denotes the set of matrices of size m × n with non-negative entries. For the dual problem, denote
i , where

the Call option price (with strike K and maturity t) on eSt by eC(t, K) := E(eSt − K)+ =Pm

i=i∗ (xi − K)px

8

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

0.5

0.4

0.3

0.2

0.1

e
c
i
r
P

T =  1.00
T =  1.50

0.0

0.4

0.6

0.8

1.0

1.2

Strike

1.4

1.6

1.8

2.0

Figure 1. Call prices with maturities t = 1 (dashed) and t+τ = 1.5 (crosses) computed using

the discretised densities of the Black-Scholes model, with parameter σ = 0.2. As a consistency

check, the Call prices with maturity t + τ are strictly greater than those with maturity t, and

both functions are convex.

i∗ := inf{1 ≤ i ≤ m : xi > K} and eC(t, K) = 0 if xm ≤ K. The next result is essential for the discretisation of

the dual problem, and follows by simple, yet careful, manipulations of telescopic sums.

Lemma 3.9. Let l ∈ N and K = (K1, . . . , Kl). For any one-dimensional real random variable Z, the following
representation holds almost surely:

(3.6)

ϕ(Z) = ϕ(K1) + Dϕ(K1) (Z − K1)+ +

l−1Xi=2

(Dϕ(Ki) − Dϕ(Ki−1)) (Z − Ki)+ ,

for any continuous function ϕ, where the forward ﬁnite-diﬀerence operator D is deﬁned as

Dϕ(Ki) :=

ϕ(Ki+1) − ϕ(Ki)

Ki+1 − Ki

,

for i = 1, . . . , l − 1.

+ . With obvious notations, Equality (3.6)

wx

i )+, so that

+ , an analogous formulation holds at time t + τ :

1 )+ +

0 + wx

1 (eSt − K x

Let now Z = eSt, ϕ ≡ ψ0, and consider the vector of strikes Kx ∈ RM
M−1Xi=2
i (eSt − K x
can be rewritten as ψ0(eSt) = wx
1(cid:17)+
1 E(cid:16)eSt − K x
M−1Xi=2
1(cid:17)+
1 E(cid:16)eSt+τ − K y

Eψ0(eSt) = wx
Likewise, for Z = eSt+τ , ϕ ≡ ψ1 and Ky ∈ RN

Eψ1(eSt+τ ) = wy

N−1Xi=2

0 + wy

0 + wx

+

Deﬁne the set

wx

i ).

i eC(t, K x

+

i ).

wy

i eC(t + τ, K y

and assume from now on that K x
1 ≤ x1 and K y
K x

X := {(x, y) : x ∈ Supp(eSt), y ∈ Supp(eSt+τ )},
1 and eSt+τ ≥ K y

1 are such that eSt ≥ K x

1 and K y

1 ≤ y1), so that the martingale property (ensured via Algorithm 3.2) yields E(eSt−K x

1 almost surely (equivalently,
1 )+ = 1−K x

1

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

9

1 . The dual problem (2.2) then reads

(3.7)

and E(eSt+τ − K y
1 )+ = 1 − K y
D(µ, ν) = min(v + wx

with wx = (wx

0 , . . . , wx

v + wx

1 x + wy

1 y +

1 +

1 + wy

M−1Xi=2
M−1), wy = (wy
M−1Xi=2

wx
i (x − K x

i )+ +

wx

i ) +

i eC(t, K x
N−1Xi=2

N−1Xi=2

wy

i eC(t + τ, K y

i ) : (wx, wy, δ) ∈ RM+N × Cb(R+)) ,

0 , . . . , wy

N−1), subject to the constraints

i (y − K y
wy
0 + wy
wx

i )+ + δ(x)(y − x) ≥ |y − Kx|,
0 − wx

1 − wy

1 = v.

1 K y

1 K x

for all (x, y) ∈ X ,





The dual problem here is semi-inﬁnite dimensional since the minimisation is performed over the ﬁnite-dimensional
vectors wx and wy, but also over the space of continuous and bounded functions δ on R+ (it is enough to con-
sider only continuous and bounded functions instead of bounded measurable functions as pointed out in [3,

Section 1.5]). The importance of incorporating the martingale conditions into the discretisation is critical. This

is easily seen in the following example for the primal problem, which also yields an issue for the dual. Suppose

that St can take value 0.75 or 1.25 each with 50% probability and St+τ can take value 0.5 or 1.5 each with
50% probability. Note that E(St) = E(St+τ ) = 1. We consider the primal problem. The constraints kζi,·k = µi
and (hζi,·, (xi − y)i)i = 0 fully determine the probabilities ζ1,1 = ζ2,2 = 3/8 and ζ1,2 = ζ2,1 = 1/8. The ﬁnal
constraints kζ·,jk = νj are only true if ν1 = ν2 = 1/2 or E(St+τ ) = 1. Otherwise, there will be no solution to
this LP. This stresses the importance of a consistent no-arbitrage discretisation of the problem.

3.3.1. Approximation of the dual. In order to reduce the dual problem (3.7) to a purely ﬁnite-dimensional

problem, we further add a layer of discretisation for the continuous and bounded delta hedges δ. Similar to [9],
ﬁx Mb ∈ N and a ﬁnite-dimensional basis (φi)i=1,...,Mb on Cb(R+), and let wb := (wb
in RMb ; deﬁne then the discretised hedgeeδ : R+ → R as
MbXi=1
eδ(x) :=

so that the new (discretised) dual problem now has the following ﬁnite-dimensional form:

) be a vector

1, . . . , wb

i φi(x),

(3.8)

wb

Mb

(3.9) Db(µ, ν) = min(v + wx

1 + wy

1 +

subject to the constraints

M−1Xi=2

v + wx

1 x + wy

1 y +

M−1Xi=2

wx
i (x − K x

i )+ +

i ) +

wx

i eC(t, K x
N−1Xi=2

i (y − K y
wy
0 + wy
wx

N−1Xi=2

i ) : (wx, wy, wb) ∈ RM+N +Mb) ,

wy

i eC(t + τ, K y

i )+ +eδ(x)(y − x) ≥ |y − Kx|,
0 − wx

1 − wy

1 = v.

1 K y

1 K x

for all (x, y) ∈ X ,

4. Primal solution for the at-the-money case

In [13], Hobson and Klimmek derived the lower bound optimal martingale transport plan for the at-the-money
0 fµ(u)du for all z ≥ 0; then Assumption 2.1—
crucial in Hobson and Klimmek’s analysis—is equivalent to ∆ having a single maximiser [6, Lemma 5.1]. This

(K = 1) forward-start straddle. Let ∆(z) := R z

0 fν(u)du −R z

assumption imposes constraints on the tail behaviour of the diﬀerence between the two laws µ and ν, and is

clearly satisﬁed, for instance, in the Black-Scholes case.

10

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

4.1. Structure of the transport plan. The key risk for an at-the-money forward-start straddle is that a long

position is equivalent to being short the kurtosis of the conditional distribution of the underlying asset (see for

example [14]). Therefore to produce the lowest possible price it seems reasonable to require a transport plan

that maximises the kurtosis of the conditional distribution. This is indeed the structure of the solution in [13].
We leave as much common mass (µ ∧ ν) in place and then map the residual mass η on [a, b] to the tails of
the distribution γ via two decreasing functions p : [a, b] → [0, a] and q : [a, b] → [b,∞). Using the martingale
condition, Hobson and Klimmek [13] derive a system of coupled diﬀerential equations for (p, q):

(4.1)

p′(x) =

q(x) − x
q(x) − p(x)

fµ(x) − fν(x)

fµ(p(x)) − fν(p(x))

,

q′(x) =

x − p(x)
q(x) − p(x)

fµ(x) − fν(x)

fµ(q(x)) − fν(q(x))

,

with boundary conditions

p(b) = inf {x ≥ 0 : γ([0, x]) > 0} ,
q(b) = inf {x ≥ 0 : γ([0, x]) > γ([0, b])} ,
p(a) = sup{x ≥ 0 : η([0, x]) < η([0, a])} ,
q(a) = sup{x ≥ 0 : γ([0, x]) < 1} .

By taking limits, we obtain that p(a) = a, p(b) = 0 q(a) = +∞ and q(b) = b, see also [6, Proposition 5.6].

4.2. Implementation. The right-hand side of the equations in (4.1) are undeﬁned at the boundary points. An
application of L’Hˆopital’s rule shows that limx↑b q′(x) = −1 if f′µ(b) 6= f′ν(b), which is a reasonable assumption in
practice, as will be illustrated in Section 5. On the other hand limx↑b p′(x) depends on the marginal measures µ
and ν. For instance, in the lognormal example in Section 5, we ﬁnd that p′(x) = O(cid:16)eα(log p(x))2(cid:17) for some
α > 0 as x tends to b from below, and limx↑b p′(x) = −∞ (see for example Figure 2(b)). On the other hand if
for example fµ(0) 6= fν(0) or f′µ(0) 6= f′ν(0) then limx↑b p′(x) = 0.

In order to circumvent these issues so that we can apply the Runge-Kutta method to solve these ODEs, we

introduce the following pre-processing step: ﬁx a small ε > 0 (in our implementations, we choose ε = 0.001),
integrate both sides of (4.1) over [b− ε, b] and then approximate the right-hand side by using the rectangle rule
for the integral with the unknown values p∗ := p(b− ε) and q∗ := q(b− ε). This yields the following simultaneous
equations for p∗ and q∗ which we solve numerically:

p∗ = −ε

q∗ = b − ε

q∗ − b + ε
q∗ − p∗
b − ε − p∗
q∗ − p∗

fµ(b − ε) − fν(b − ε)

fµ(p∗) − fν(p∗)

fµ(b − ε) − fν(b − ε)

fµ(q∗) − fν(q∗)

,

.

These equations can easily be reduced into one root search; the ﬁrst equation gives

q∗ =

(p∗)2 [fµ(p∗) − fν(p∗)] + ε(b − ε) [fµ(b − ε) − fν(b − ε)]

p∗ [fµ(p∗) − fν(p∗)] + ε [fµ(b − ε) − fν(b − ε)]

,

which in turn can be plugged into the second equation to solve for p∗. The pair (p, q) in (4.1) is then solved for
x ∈ [a, b−ε] using standard Runge-Kutta methods with the new boundary conditions p(b−ε) = p∗, q(b−ε) = q∗.
The lower bound for the at-the-money forward-start straddle price is then given using the optimal conditional

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

11

density ρ∗(Y = y|X = x) given in [13, page 199]:
(cid:18)1 −

ρ∗(Y = y|X = x) =

fη(x)
fµ(x)

q(x) − x
q(x) − p(x)
fη(x)

fµ(x)(cid:19) ,

x − p(x)
q(x) − p(x)

11{y=p(x)},

if y < x,

if y = x,

11{y=q(x)},

if y > x,

fη(x)
fµ(x)



and hence straightforward computations yield

E(|Y − X|) =ZR
=ZRZ x
=Z b

a

(4.2)

E(|Y − X||X = x)fµ(x)dx =ZRZR

fη(x)

q(x) − x
q(x) − p(x)
−∞
2(x − p(x))(q(x) − x)

11{y=p(x)}|y − x|dydx +ZRZ +∞

ρ∗(Y = y|X = x)fµ(x)|y − x|dydx
x − p(x)
q(x) − p(x)

fη(x)

x

11{y=q(x)}|y − x|dydx

fη(x)dx.

q(x) − p(x)
5. Numerical analysis of the no-arbitrage bounds

We now illustrate the numerical methods developed in Sections 3 and 4 on the Black-Scholes and the Heston

models. These examples involve forward-start option prices (and forward implied volatility smile), which we

now quickly recall. In the Black-Scholes model, the dynamics of the stock price process under the risk-neutral

measure are given by dSt = StΣdWt, S0 = 1, where Σ > 0 represents the instantaneous volatility and W is a
standard Brownian motion. The no-arbitrage price of the Call option at time zero then reads BS(τ, K, Σ) :=
E (Sτ − K)+ = N (d+) − ekN (d−), with d± := − k
function. Since the increments of the stock price process are stationary and independent, the forward-start
option with payoﬀ (St+τ − KSt)+ with t, τ > 0 is worth BS(τ, K, Σ). For a given market or model price
Cobs(t, τ, K) of the option at strike K, forward-start date t and maturity τ , the forward implied volatility smile
σt,τ (K) is then deﬁned as the unique solution to Cobs(t, τ, K) = BS(τ, k, σt,τ (K)).

2 Σ√τ , where N is the standard normal distribution

Σ√τ ± 1

In the following two subsections, we shall consider the observed vanilla Call option prices as computed from the

Black-Scholes and the Heston model. We shall discretise the corresponding dual problems following Section 3.3,

by considering the compact interval [0, 5] for the supports of the discretised random variables eSt and eSt+τ with
m = n = 500 discretisation points; the vectors of observed strikes are taken as Kx = Ky = {0.3, 0.4, 0.5, . . . , 2}.
5.1. Application to the Black-Scholes model. Let N ( ¯m, Σ2) denote the Gaussian distribution with mean ¯m
and variance Σ2, and assume that the random variables St and St+τ are distributed according to

log(St) ∼ N(cid:18)−

1
2

Σ2t, Σ2t(cid:19)

and

log(St+τ ) ∼ N(cid:18)−

1
2

Σ2(t + τ ), Σ2(t + τ )(cid:19) .

Clearly a candidate martingale coupling is the Black-Scholes model with volatility Σ and starting at S0 = 1; in
this case the forward volatility, i.e. the implied volatility computed from the forward-start option, is constant

and also equal to Σ. In Figure 2(a), we consider the values Σ = 0.2, t = 1 and τ = 0.5, and plot the distributions

of St and St+τ .

In Figure 2(b) we plot the lower and upper bounds for the forward implied volatility smile computed from

the discretisation of the dual problems (2.2) via (3.9). The lower bound at-the-money case using the Hobson-

Klimmek solution and the LP dual solution are virtually identical (6.95% vs 6.98%), illustrating the consistency

of the two approaches. Note that even in this simple case the range of possible forward smiles consistent with

12

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

the two marginal laws is wide. The magnitude of the bounds produced is similar to bounds obtained in [9]

for cliquet options which are very closely related to forward-start straddles. This behaviour can be explained

intuitively as no conditional instruments are used to hedge the straddle, hence there is no restriction on the

conditional probabilities between times t and t + τ . The only restriction is that the two marginal laws at those

times are placed in convex order, producing a very large class of feasible martingale measures.

ææææ
æ
æ

æ

æ

æ

æ

æ
àààààà
à
æ
à
à
à
æ
à
æ
à

æ

æ

à

à

æ

à

à

æ

à

PDF

2.0

1.5

1.0

0.5

à
æ

à
æ

à

à

æ

à

æ

à

æ

à

æ

à

à

æ
à

æ
à

æ
à
à
æ
à
æ
à
æ
à
à
æ
à
æ
à
æ
à
à
æ
à
æ
à
æ
à
à
æ
æ
æ

à

æ

à

æ

à

à

æ

æ

àààààààààààààààààààààààààà
æææææææææææææææææææææææææææææ
0.0
0.5

1.0

ààààààààààààààààààààààààààààà
æææææææææææææææææææææææææææææ

1.5

2.0

FwdSmile
0.7

0.6

0.5

à

0.4

0.3

0.2

æ

ì

0.1

0.6

StockPrice

à

æ

ì

à

æ

ì

0.8

à

æ

ì

à

æ

ì

à

æ

XX

ì

1.0

à

æ

ì

1.2

à

æ
ì

à

æ

ì

Strike

1.4

(a) Densities.

(b) Robust bounds via the dual problem.

Figure 2. (a) the circles represent the one-year lognormal density and the squares the 1.5-

year lognormal density. (b) the circles represent the constant Black-Scholes forward volatility Σ

consistent with the marginals. The squares and the diamonds are the lower and upper bounds

found by solving the dual problems (2.2) via (3.9); the X cross is the Hobson-Klimmek solu-

tion (4.2) for the lower bound at-the-money case.

5.2. Application to the Heston model. The marginal distributions for expiries t = 1 and t + τ = 1.5 are

now generated according to the Heston stochastic volatility model [10], in which the stock price process is the

unique strong solution to the stochastic diﬀerential equation

(5.1)

dSt = St√VtdWt,
dVt = κ (θ − Vt) dt + ξ√VtdZt, V0 = v > 0,

S0 = 1,

where W and Z are two one-dimensional standard Brownian motions with dhW, Zit = ρdt, and κ, θ, ξ > 0 and
ρ ∈ [−1, 1]. We consider here the following values: v = θ = 0.07, κ = 1, ξ = 0.4 and ρ = −0.8. The (spot)
implied volatility smiles and corresponding densities are displayed in Figure 3. Figure 4 shows the Heston

forward smile consistent with the marginals (computed using the inverse Fourier transform representation and

a simple root search method) and the lower and upper bounds for the forward smile, from the discretised

version (3.9) of the dual problems (2.2). For the discretisation of the delta hedge (3.8), we consider the
monomials (φ1, φ2, φ3)(x) ≡ (1, x, x2). As in the Black-Scholes case, the Hobson-Klimmek solution (7.77%) and
the dual solution (7.80%) for the lower-bound at-the-money volatility are virtually identical. Figure 5(a) shows

the payoﬀ of the option prices in the super-hedge: one enters into positions with long convexity for the 1.5-year

maturity and short convexity for the 1-year maturity.

In both examples the range of forward smiles consistent with the marginal laws is large. Using European

options to ‘lock-in’ (replicate) forward volatility or hedge forward volatility dependent claims seems illusory.

Forward-start options should be seen as fundamental building blocks for exotic pricing and not decomposable

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

13

æ

à

Smile

0.40

0.35
æ
à

æ

à

0.30

0.25

0.20

æ

à

æ

à

æ

à

æ
à

æ
à

æ
à

æ
à

æ
à

æ
à

æ
à

à
æ

à
æ

à
æ

à
æ

à
æ

à
æ

0.6

0.8

1.0

1.2

Strike

1.4

(a) Spot implied volatility.

PDF

1.5

1.0

0.5

æææææ
æ
æ

æ

æ

æ

æ

æ

æ

æ

æ

æ

à

à

æ

à

à

ààààààààà

æ

à

æ
à

à

à

æ
à

æ
à

æ
à
æ
à
à
æ
à
æ
à
æ
à
à
æ
à
æ
à
æ
à
à
æ
à
æ
à
æ
à
æ

à
æ
à

à
æ
à

à
æ

à
æ

à

æ

à

à

æ

à

æ

à

à

æ

æ

à

à

æ

æ

à

à

à
æ

à
æ

à
æ

à
æ

à
æ

à
æ

ææææàààààààààààààààààààààà
æææææææææææææææææææææ

0.0

0.5

æ

ààààààààààààààààààààààà
ææææææææææææææææææææææææææ
2.0
1.5

StockPrice

1.0

(b) Densities.

Figure 3. (a) Circles (squares) represent the 1 year (1.5 year) spot implied volatility. (b)

circles (squares) represents the corresponding marginal densities.

FwdSmile
0.7

à

æ
ì

0.6

à

0.5

0.4

æ

0.3

ì

0.2

0.1

à

æ

ì

à

æ

ì

à

æ

ì

0.6

0.8

à

æ

ì

à

æ

XX

ì

1.0

à

æ

ì

1.2

à

æ

ì

à

æ

ì

Strike

1.4

Figure 4. The circles represent the Heston forward volatility consistent with the marginals,

and the squares and diamonds stand far the lower and upper bounds found by solving the

LP problem in Section 3, and X is the primal Hobson-Klimmek solution for the lower bound

at-the-money case (Section 4).

DeltaHedgeRatio

2

6

4

2

0

2.0

1.5

SuperHedge

2.0

1.5

1.0
y

0.5

0.5

1.0
x

0.0
0.0

-2

-4

-6

-8

2.5

StockPrice

3.0

1.5

1.0

0.5

2.0

ææææææææææææææææææææææææææææææææææææææææææææææææææ

æ

æ

æ

æ

æ

æ

æ

æ

æ

æ

æ

(a) Superhedging portfolio and forward-start payoﬀs

(b) Discretised Delta hedge

Figure 5. The strike is taken at the money: K = 1. (a) Superhedging portfolio (top plot) and

forward-start payoﬀs (below); (b) Optimal discretised delta hedgeeδ deﬁned in (3.8).

14

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

(or approximately decomposable) into European options. Models used for forward volatility dependent exotics

should have the capability of calibration to forward-start option prices and at a minimum should produce

realistic forward smiles that are consistent with trader expectations and observable prices.

6. Numerical analysis of the transport plans

As mentioned in Section 4, the key risk for the at-the-money forward-start straddle is that a long position

is equivalent to being short the kurtosis of the conditional distribution. The solution in the lower bound case

(under Assumption 2.1) was detailed in Section 4, where – intuitively – the transport plan maximises the

kurtosis of the conditional distribution. In the upper bound case (see [14]) the support of the transport plan is

concentrated on a binomial map with no mass being left in place, i.e. all the mass of µ gets mapped to ν via
two increasing, continuous and diﬀerentiable functions f, g : R+ → R+ satisfying f (x) ≤ x ≤ g(x). Functions f
and g must satisfy the system of integral equations [14, Equations (5.19) and (5.20)]

g−1(y) (cid:0)g(z) − f−1(y)(cid:1)

dz,

g(z) − f (z)
dz,

1

g(z) − f (z)

0 =Z f −1(y)
1 =Z f −1(y)

g−1(y)



and if it is possible to ﬁnd a solution to this system then [14, Lemma 7.1] provides an optimality result in the at-

the-money case. Intuitively in this case the solution minimises the kurtosis of the conditional distribution. For

out-of-the-money options the situation is more subtle. As the strike moves further away from the money, a long

option position becomes longer the kurtosis of the conditional distribution. Intuitively one would then expect

the transport plan to be some combination of the lower and upper at-the-money transport plans discussed above.

Using the lognormal example of Section 5, we now numerically solve for the transport plans using the discretised

primal problem (3.5) and make qualitative conjectures concerning the structure of the transport plans. The

supports of the discretised random variables eSt and eSt+τ (introduced in Section 3.3) are taken respectively
as [0, 10] (with m = 1000 points) and [0, 30] (with n = 3000 points); the vectors of observed strikes are again
Kx = Ky = {0.3, 0.4, 0.5, . . . , 2}, and the discrete probabilities in each bucket were obtained by integrating the
lognormal density over each bucket.

StockPrice

2.5

2.0

1.5

1.0

1.0

1.5

2.0

StockPrice

Figure 6. The dashed and dark lines are the transport maps for the upper bound at-the-money

case and the grey line is the identity. The horizontal and vertical axes are St and St+τ .

In Figure 6 we compute the transport maps f and g for the at-the-money upper bound case, i.e. the supremum

case in (2.1). In this case no mass is left in place in the transport plan; in Figure 7 we plot the transport plan

for the at-the-money lower bound case. This lower bound case is in striking agreement with Hobson-Klimmek:

as much mass as possible is left in place and the residual mass is mapped to the tails of the distribution via

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

15

Prob

0.20

0.15

0.10

0.05

à

X

æ

à

X

æ

à

X X X X X X

à à à à à
æ æ æ æ æ
0.5

æ

æ

StockPrice

æ

à

X X

à

æ

X

à

æ

X

à

X

æ
à

à
æ

X

à
æ

X

1.5

1.0

à
æ

X X X X X

à
à à à
æ æ æ æ
2.0

3.5

3.0

2.5

2.0

1.5

1.0

0.5

Stock

0.9

1.0

1.1

1.2

StockPrice

(a) Lower Bound.

(b) Transport maps

Figure 7. Here the strike is taken at the money: K = 1. (a) discretisation of the measures µ

(circles) and ν (squares) and the amount of mass that must be left in place (X’s) in the transport

plan for the at-the-money (K = 1) lower bound case. (b) transport maps for the residual mass,

computed from (4.1) or, equivalently, by solving the primal problem (3.5).

Prob

0.20

0.15

0.10

0.05

æ

à

æ

à

à

æ

ì

ì

ì

æ

à

ì

æ

à

ì

à

æ
ì

à

æ
à

à
æ

à
æ

æ
à
ì ì ì ì ì ì
æ æ æ æ æ
à à à à
0.5

1.0

à
æ

à
à à à
æ æ æ æ
ì ì ì ì ì ì ì ì
2.0

1.5

StockPrice

1.8

1.6

1.4

1.2

1.0

0.8

Stock

1.0

1.2

1.4

1.6

StockPrice

(a) Mass in place K = 0.9: Upper Bound.

(b) Transport Maps K = 0.9: Upper

Bound.

Figure 8. (a) discretisation of the measures µ (circles), ν (squares) and the amount of mass

that must be left in place (diamonds) in the transport plan for the K = 0.9 upper bound case.

(b) transport maps for the residual mass: the axes are labelled as in Figure 6.

Prob

0.20

0.15

0.10

0.05

à
ì ì ì ì ì
æ æ æ æ æ
à à à à
0.5

æ

à

ì

æ

à
ì

æ

à

ì

à

æ
ì

à

ì
æ

à

ì
æ

1.0

æ

à

ì

æ
à

ì

StockPrice

1.8

1.6

1.4

1.2

1.0

0.8

0.6

Stock

1.0

1.2

1.4

1.6

StockPrice

à
æ

à
æ

à
æ

à
à à à
æ æ æ æ
ì ì ì ì ì ì ì
2.0

1.5

(a) Mass in place K = 0.7: Upper Bound.

(b) Transport Maps K = 0.7: Upper

Bound.

Figure 9. (a) discretisation of the measures µ (circles), ν (squares) and the amount of mass

that must be left in place (diamonds) in the transport plan for the K = 0.7 upper bound case.

(b) transport maps for the residual mass: the axes are labelled as in Figure 6.

16

SERGEY BADIKOV, ANTOINE JACQUIER, DAPHNE QING LIU AND PATRICK ROOME

Prob

0.20

0.15

0.10

0.05

à
ì ì ì ì ì
æ æ æ æ æ
à à à à
0.5

æ

ì
à

æ

ì
à

æ

à

ì

à

ì
æ

à

ì
æ

à

ì
æ

1.0

æ

à

æ
à

ì

ì

à
æ

ì

StockPrice
1.8

1.6

1.4

1.2

1.0

0.8

0.6

Stock

1.1

1.2

1.3

1.4

1.5

1.6

1.7

StockPrice

à
æ

à
æ

à
à à à
æ æ æ æ
ì ì ì ì ì ì
2.0
1.5

(a) Mass in place K = 1.05: Lower Bound.

(b) Transport Maps K = 1.05: Lower

Bound.

Figure 10. (a) discretisation of the measures µ (circles), ν (squares) and the amount of mass

that must be left in place (diamonds) in the transport plan for the K = 1.05 lower bound case.

(b) transport maps for the residual mass: the axes are labelled as in Figure 6.

Prob

0.20

0.15

0.10

0.05

à
ì ì ì ì ì
æ æ æ æ æ
à à à à
0.5

æ

à

æ

à

æ

à

à

æ

ì ì

æ

à

à

ì

ì

æ
à

æ

ì

à

æ
ì

ì

ì

à
æ

ì

1.0

StockPrice

1.8

1.6

1.4

1.2

1.0

0.8

0.6

Stock

0.8

1.0

1.2

1.4

1.6

StockPrice

à
æ

à
æ

à
à à à
æ æ æ æ
ì ì ì ì ì ì
2.0
1.5

(a) Mass in place K = 1.3: Lower Bound.

(b) Transport Maps K = 1.3: Lower

Bound.

Figure 11. (a) discretisation of the measures µ (circles), ν (squares) and the amount of mass

left in place (diamonds) in the transport plan for the K = 1.3 lower bound case. (b) transport

maps for the residual mass: the axes are labelled as in Figure 6.

two decreasing functions. Note the agreement with the transport maps in Figure 2(b). In this case the forward

volatility is 6.92% matching the Hobson-Klimmek analytical solution and the numerical solution of the dual.

Figures 8 and 9 illustrate the transport plan for the upper bound case and strikes K = 0.7 and K = 0.9. As

the strike decreases from at-the-money, more and more mass is left in place (starting from the left tail), and

the residual mass of µ is mapped to ν via two increasing functions; one maps the residual mass to the left tail

of ν while the other maps the residual mass to the right tail of ν. For strikes greater than at-the-money a

mirror-image transport plan emerges where more and more mass is left in place (starting from the right tail)

and again the residual mass of µ is mapped to ν via two increasing functions (for brevity we omit the plots).

Figures 10 and 11 illustrate the transport plan for the lower bound case and strikes K = 1.05 and K = 1.3. As

the strike increases from at-the-money, less and less mass is left in place (removing mass ﬁrst from the right tail)

and the residual mass of µ is mapped to ν via two functions: one maps the residual mass to the left tail of ν,

the other maps the residual mass to the right tail of ν. These functions appear to be increasing for large strikes

(Figure 11(b)), but since the transport maps are decreasing for the at-the-money strike (Figure 7(b)), for strikes

close to the money these maps could be decreasing 10(b). For strikes lower than the money a mirror-image

NO-ARBITRAGE BOUNDS FOR THE FORWARD SMILE GIVEN MARGINALS

17

transport plan emerges where less and less mass stays in place (removing mass ﬁrst from the left tail) and again

the residual mass of µ is mapped to ν via two functions (for brevity we omit the plots).

7. Summary and Conclusion

In this article, we endeavoured to provide a quantitative answer to the question as to whether forward-start

options could be eﬀectively replicated using Vanilla products. The take-away message here is that they should

rather be thought of as fundamental building blocks, and that trying to replicate them using European options

is not reasonable. Our approach using inﬁnite linear programming arguments, makes the methodology directly

amenable to computation and calibration to market data; we in particular propose a discretisation scheme to

reduce its (inﬁnite) dimensionality, and therefore its complexity. Alternatively, in line with the current active

research on robust ﬁnance, one could rephrase the problem—using duality arguments—into an optimisation

over sets of (martingale) measures, consistent with market data. Several results already exist in that direction,

and we leave this for further study.

References

[1] M. Avellaneda. Calibrating volatility surfaces via relative-entropy minimisation. Applied Math Finance, 4(1): 37-64, 1997.

[2] D. Baker. Martingales with speciﬁed marginals. PhD thesis, Paris 6, tel.archives-ouvertes.fr/tel-00760040v2/document, 2012.

[3] M. Beiglb¨ock, P. Henry-Labord`ere and F. Penkner. Model-independent bounds for option prices: a mass transport approach.

Finance and Stochastics, 17(3): 477-501, 2013.

[4] J. Borwein, R. Choksi and P. Mar´echal. Probability distributions of assets inferred from option prices via the principle of

maximum entropy. SIAM Journal of Optimization, 14(2): 464-478, 2003.

[5] J. Borwein, A. S. Lewis. Duality relationships for entropy-like minimization problems. SIAM Journal of Control and Opti-

mization, 29(2): 325-338, 1991.

[6] L. Campi, I. Laachir and C. Martini, Change of numeraire in the two-marginals martingale transport problem. Preprint,

arXiv:1406.6951, 2014.

[7] M.H.A. Davis and D. Hobson. The range of traded option prices. Mathematical Finance, 17: 1-14, 2007.

[8] P. Henry-Labord`ere and N. Touzi. An explicit martingale version of the one-dimensional Brenier theorem. Finance and Stochas-

tics, to appear.

[9] P. Henry-Labord`ere. Automated Option Pricing: Numerical Methods. Intern. Journal Theor. App. Fin., 16(8), 2013.

[10] S. Heston. A closed-form solution for options with stochastic volatility with applications to bond and currency options. The

Review of Financial Studies, 6(2): 327-342, 1993.

[11] D. Hobson. Robust hedging of the lookback option. Finance and Stochastics, 2: 329-347, 1998.

[12] D. Hobson. The Skorokhod embedding problem and model-independent bounds for option prices. Paris-Princeton Lectures on

Mathematical Finance 2010, 2003: 267-318. Springer, Berlin, 2010.

[13] D. Hobson and M. Klimmek. Robust price bounds for the forward starting straddle. Fin. Stochastics, 19(1): 189-214, 2015.

[14] D. Hobson and A. Neuberger. Robust bounds for forward start options. Mathematical Finance, 22(1), 31-56, 2012.

[15] D.G. Luenberger and Y. Ye, Linear and Nonlinear Programming. Springer US, 2008

[16] S. Mehrotra and D. Papp. Generating nested quadrature formulas for general weight functions with known moments. Preprint,

arXiv:1203.1554, 2012.

[17] J. Ob l´oj. The Skorokhod embedding problem and its oﬀspring. Probability Surveys, 1: 321-390, 2004.

[18] S. Shreve. Stochastic calculus for ﬁnance I. The binomial asset pricing model. Springer, 2004.

[19] V. Strassen. The existence of probability measures with given marginals. Annals of Mathematical Statistics, 36: 423-439, 1965.

[20] K. Tanaka and A. Toda. Discrete approximations of continuous distributions by maximum entropy. Economics Letters, 118:

445-450, 2013.

Department of Mathematics, Imperial College London

E-mail address: sergey.badikov08@imperial.ac.uk, a.jacquier@imperial.ac.uk, q.liu12@imperial.ac.uk, p.roome11@imperial.ac.uk

