6
1
0
2

 
r
a

 

M
5
1

 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 

1
v
4
3
6
4
0

.

3
0
6
1
:
v
i
X
r
a

Conditions for describing triplet states in reduced density matrix functional theory

Iris Theophilou,1, 2 Nektarios N. Lathiotakis,3, 4 and Nicole Helbig2

1Max Planck Institute for the Structure and Dynamics of Matter,

Luruper Chaussee 149, 22761 Hamburg, Germany

2Peter-Gr¨unberg Institut and Institute for Advanced Simulation,

Forschungszentrum J¨ulich, D-52425 J¨ulich, Germany∗

3Theoretical and Physical Chemistry Institute, National Hellenic Research Foundation,

4Max-Planck-Institut f¨ur Mikrostrukturphysik, Weinberg 2, D-06120 Halle (Saale), Germany

Vass. Constantinou 48, GR-11635 Athens, Greece

(Dated: March 16, 2016)

We consider necessary conditions for the one body-reduced density matrix (1RDM) to correspond
to a triplet wave-function of a two electron system. The conditions concern the occupation numbers
and are diﬀerent for the high spin projections, Sz = ±1, and the Sz = 0 projection. We employ
these conditions in reduced density matrix functional theory calculations for the triplet excitations
of two electron systems. In addition, we propose that these conditions can be used in the calculation
of triplet states of systems with more than two electrons by restricting the active space and assess
this procedure in calculations for a few atomic and molecular systems. We show that the quality of
the optimal 1RDMs improves by applying the conditions in all the cases we studied.

I.

INTRODUCTION

The main focus of reduced density matrix functional
theory (RDMFT) [1], a framework where the one-body
reduced density matrix (1RDM) plays the role of the
fundamental variable, has been the proper description of
ground-state singlet states. Little has been done on de-
veloping a RDMFT treatment of doublet or triplet states
[2–4]. The extension of the theory for such states can fol-
low two diﬀerent directions which can also be combined.
The ﬁrst concerns the development of approximate func-
tionals or the extension of existing ones to describe such
states. The second is the derivation of additional con-
ditions to restrict the minimization of the existing func-
tionals to the domain of 1RDMs that correspond to a
prescribed spin state. The present work is a step in the
second direction.

Since the many-electron problem, in general, cannot be
solved exactly, several approximations were introduced
where the total electronic energy is expressed as a func-
tional of a density or density matrix. In this way, one
switches from calculating the many-body state to cal-
culating quantities like the density in density functional
theory (DFT) [5] or the 1RDM in RDMFT. RDMFT
[1, 6] got signiﬁcant attention in the last twenty years
as an alternative to DFT. Several approximations have
been introduced [7–25] with promising results in cases
like molecular dissociation [9–13, 26] or the gaps of peri-
odic systems [16, 17, 27, 28], where the results of basic
DFT functionals are not satisfactory. Among these ap-
proximations, a central position is held by the M¨uller
functional [7, 9] which was found to overcorrelate sub-
stantially but served as a starting point for further im-
provements. Several modiﬁcations of this functional were

∗ iris.theophilou@mpsd.mpg.de

introduced [6] in order to correct its overcorrelation: the
functional of Goedecker and Umrigar [8], the BBCn (n
= 1,2,3) [10, 11, 14], the approximation of Marques and
Lathiotakis [15], the Power functional [16–18, 29], the
PNOFn, n = 1,...6 [12, 19–21], and the theory of the
anti-symmetrized product of strongly orthogonal gemi-
nals (APSG) [13, 22–24].

In any RDMFT calculation, one searches for the
1RDM that minimizes the total energy functional. How-
ever, the search has to be restricted in the domain of
functions (trial 1RDMs) that satisfy certain constraints,
known as N -representability conditions, which guaran-
tee that the optimal 1RDM corresponds to a fermionic
system. Given the exact ground-state total energy func-
tional, the ensemble N -representability conditions of
Coleman [30] are suﬃcient to ensure that one ﬁnds the
1RDM that corresponds to the non-degenerate ground-
state wave function. The reason is that any ensemble of
pure states would always include excited states and would
lead to a higher total energy. For approximate function-
als, on the other hand, the ensemble conditions do not
guarantee that the minimizing 1RDM could be obtained
from a many-body fermionic wave function. The class of
spin-compensated systems with time-reversal symmetry
is a notable exception, since, in that case, the conditions
for pure-state N -representability collapse to the ensemble
conditions [31]. The necessary and suﬃcient conditions
for pure-state N -representability, also called generalized
Pauli constraints, have only recently been discussed and
explicitly expressed for systems with a small number of
particles and speciﬁc ﬁnite sizes of the Hilbert space [32–
36]. Recently, it has been demonstrated that with enforc-
ing only the ensemble conditions in a RDMFT calculation
for open-shell systems, the pure-state conditions will be
violated for many functionals of the 1RDM [37]. Hence,
the enforcement of the pure state conditions leads to a
diﬀerent solution. We should mention that the number

of pure-state conditions explodes as the number of elec-
trons and the dimension of the Hilbert space increase and
their consideration in a minimization procedure becomes
a very diﬃcult task.

In many cases, the many-body Hamiltonian commutes
with the total spin and the spin projection in any partic-
ular direction. As a result, one can choose the solutions
of the many-body Schr¨odinger equation to be eigenstates
of the Hamiltonian, ˆS2, and ˆSz simultaneously. Typi-
cal cases where the Hamiltonian does not commute with
the spin operators include the application of non-uniform
magnetic ﬁelds to the system or the inclusion of spin-
orbit coupling. However, we are not considering such
cases in this work. Thus, for the cases discussed here,
it is desirable that the optimal 1RDMs correspond to
eigenstates of the spin operators as well. While the pure-
state conditions ensure that there exists a many-body
wave function corresponding to a given 1RDM, there is
generally no guarantee that this many-body state is an
eigenstate of any spin operator or even corresponds to a
speciﬁc expectation value of it. Hence, the question arises
if one can ﬁnd constraints such that the solutions pre-
serve the symmetries of the original many-body Hamil-
tonian, i.e. whether the optimal 1RDM which one ﬁnds in
a RDMFT calculation corresponds to a many-body state
with a prescribed, speciﬁc total spin and Sz. For the z-
component of the spin one typically constrains separately
the number of up and down electrons in the system [2]
to be correct. The expectation value of ˆSz is then given
by (N↑ − N↓)/2 (atomic units are used throughout this
paper unless explicitly stated otherwise). However, this
constraint guarantees only that the expectation value of
ˆSz has the correct, prescribed value. Therefore, it is a
necessary condition for the 1RDM to correspond to an
eigenstate of ˆSz but not a suﬃcient one. The situation
is even more complicated for the total spin. Contrary to
ˆSz the total spin ˆS2 is not a single particle operator. Its
expectation value is, therefore, not a trivial functional of
the 1RDM. Consequently, restricting the 1RDMs to have
a speciﬁc expectation value for ˆS2 is non-trivial as well
since it requires the knowledge of the expectation value
as a functional of the 1RDM. Since the expectation value
of ˆS2 can easily be written as a functional of the 2-body
reduced density matrix (2RDM), Γ(2), as [38]

hˆS2i = −

4

N (N − 4)
+ Xσ1,σ2

Z d3r1d3r2Γ(2)(r1σ1, r2σ2|r1σ2, r2σ1),

(1)

several attempts have been made to apply constraints on
the 2RDM [3, 39, 40] which then also aﬀect the 1RDM.
The same problem arises in DFT, as the density func-
tional to calculate hˆS2i is not known. As an approximate
functional, one then usually evaluates ˆS2 using the Kohn-
Sham Slater determinant. However, this, in general, does
not yield the correct value of hˆS2i of the interacting sys-
tem [41–43].

2

In this work, we discuss some necessary conditions for
the 1RDM of a two-electron system to correspond to a
triplet conﬁguration. As we will see, these spin con-
straints are generally violated by a calculation if they are
not explicitly enforced. We also discuss the application
of these conditions, in an approximate way, to systems
with an even number of electrons with N > 2. In this
case, we assume that N − 2 natural orbitals form a sin-
glet conﬁguration and only two active electrons form the
triplet. We apply the triplet conditions to various small
systems, which have a singlet ground state, to calculate
the ﬁrst excited triplet state. We show that the results
for the optimal 1RDMs, if we impose the spin constraints,
are closer to the exact ones from multi-conﬁguration self-
consistent ﬁeld (MCSCF) calculations than without im-
posing the constraints. The results for the singlet-triplet
transition energies vary depending on the system and the
functional that is used.

This paper is organized as follows: In section II we
present the necessary conditions we consider for the
triplet state of two electron systems and their general-
ization in order to be applicable for more electrons. Our
results are presented in section III, where we asses the
inclusion of these constraints in RDMFT calculations as
far as the optimal 1RDM and triplet excitation energies
are concerned. Finally, our conclusions are included in
section IV.

II. SPIN CONSTRAINTS

Writing the 1RDM, γ(r, r′) in its spectral representa-

tion

γ(r, r′) =

∞

Xj=1

njϕ∗

j (r′)ϕj (r)

(2)

with the occupation numbers nj and the natural or-
bitals ϕj(r) one can easily express the ensemble N -
representability conditions [30] as

∞

Xj=1

nj = N,

0 ≤ nj ≤ 1.

(3)

These two conditions ensure that the 1RDM corresponds
to a system of N fermions but not necessarily to a pure
N -particle state. Obviously, in any practical calculation
the number of natural orbitals is restricted to a ﬁnite
number M with M > N which is a valid approxima-
tion since the occupation numbers nj fall oﬀ rapidly for
j > N . Restricting the system to not only fermionic en-
sembles but actual N -particle states requires additional
constraints which increase rapidly in number with the
number of particles N and the number of orbitals M .
For small N and M they can be given explicitly [32–34].
In the present work, we allow for spin dependent den-
sity matrices and occupation numbers, the natural or-

bitals, however, remain spin independent [2], i.e.

and

γσ(r, r′) =

∞

Xj=1

njσϕ∗

j (r′)ϕj(r)

γ(r, r′) = Xσ=↑,↓

γσ(r, r′).

(4)

(5)

Note that the choice of having the same set of spatial
orbitals for both spin channels is not related to describing
density matrices with a speciﬁc Sz (which can be also
achieved with diﬀerent sets of spin orbitals [4]) but, as
we will see later, facilitates the description of γ with a
speciﬁc expectation value of ˆS2. From now on, with the
notation Sz we mean, in general, the expectation value
h ˆSzi. In order to describe a system with a speciﬁc Sz one
requires that

∞

Xj=1

njσ = Nσ, Xσ

Nσ = N.

(6)

However, while this guarantees that the expectation
value of ˆSz is given by (N↑− N↓)/2, it is only a necessary
but not a suﬃcient condition for the 1RDM to correspond
to an eigenstate of ˆSz. For example, the state

Ψ(r1σ1, r2σ2) =

1

√2 (cid:0)|1↑2↑i + |3↓4↓i(cid:1)

(7)

is a linear combination of an Sz = 1 and an Sz = −1
eigenstate. We denote the natural orbital ϕ1(r) being
occupied with a spin up electron as 1↑ and the Slater
determinant as | i. The non-zero occupation numbers of
this state are given by

n1↑ = n2↑ = n3↓ = n4↓ =

1
2

(8)

and the sum of the occupation numbers in each spin chan-
nel is N↑ = N↓ = 1. Thus, even when both N↑ and N↓
are ﬁxed to integer values, the 1RDM does not need to
correspond to an eigenstate of the ˆSz operator. Excep-
tions are the maximally polarized states, i.e. for ﬁxed
N↑ = N and N↓ = 0 or vice versa. In these cases, one is
guaranteed to ﬁnd a ˆSz eigenstate with Sz = ±N/2. Fur-
thermore, for these states there exists only one ˆS2 eigen-
state. Therefore, in this speciﬁc situation, enforcing a
certain value for Sz ensures that the 1RDM corresponds
to an eigenstate of both ˆSz and ˆS2 with the latter having
the eigenvalue S(S + 1) = (N/2)(N/2 + 1), provided one
enforces pure-state N -representability. If pure-state N -
representability is not enforced the calculation will gener-
ally yield an ensemble of states with Sz = ±N/2. In other
words, each of the states in the ensemble will be an eigen-
state of ˆSz and ˆS2 and the expectation values of the whole
ensemble will be ±N/2 and N/2(N/2 + 1), respectively.
The pure-state N -representability can be ensured by sim-
ply transferring the known pure-state N -representability

3

conditions [32–36] to the occupation numbers of the spin
channel that is occupied in the system.

For N = 2, there are only two possible conﬁgurations
for the total spin, S = 1 or S = 0. The fully polarized
states correspond to Sz = ±1 and, as discussed above,
are easy to distinguish in RDMFT from the Sz = 0 states.
The necessary and suﬃcient conditions for pure-state N -
representability for N = 2 only require a double degener-
acy of the occupation numbers [44]. Hence, enforcing all
occupation numbers of the up (down) spin channel to be
doubly degenerate yields a triplet eigenstate with Sz = 1
(Sz = −1). It remains the question how to distinguish
between the two Sz = 0 states, i.e. the triplet state with
Sz = 0 and the singlet state. We can construct the wave
function for the triplet state with Sz = 0 starting from
the fully polarized state
|S = 1, Sz = 1i = a1|1↑2↑i + a2|3↑4↑i + a3|5↑6↑i... . (9)
Note that one needs an even number of natural orbitals
M since only doubly excited Slater determinants are al-
lowed in the expansion. Including a determinant which
is a single excitation of any other determinant in the ex-
pansion leads to oﬀ-diagonal terms in the 1RDM which is
forbidden as we are constructing the Slater determinants
from natural orbitals. As one can see, the occupation
numbers for such a state are pairwise degenerate with

n1↑ = n2↑ = |a1|2, n3↑ = n4↑ = |a2|2...,

(10)

i.e. the pure-state constraint is satisﬁed. The same con-
dition can be derived from symmetry considerations of
the triplet wave function [44]. Applying ˆS− to the state
(9) we obtain

|S = 1, Sz = 0i =

1

√2(cid:0)a1[|1↓2↑i + |1↑2↓i]

+a2[|3↓4↑i + |3↑4↓i] + ...(cid:1),

(11)

where 1↑ denotes that the natural orbital ϕ1 is occupied
with an up electron in the Slater determinant, the spatial
dependence of 1↑ and 1↓ is identical. The corresponding
occupation numbers are four-fold degenerate with

n1↑ = n1↓ = n2↑ = n2↓ = |a1|2/2,
n3↑ = n3↓ = n4↑ = n4↓ = |a2|2/2,
...

(12)

We also see from Eqs. (9) and (11) that the spatial parts
of the natural orbitals of the two spin channels are the
same since the spin operator only acts on the spin parts.
Corresponding to the triplet Sz = 0 state there also exists
a singlet state

|S = 0, Sz = 0i =

1

√2(cid:0)a1[|1↓2↑i − |1↑2↓i]

+a2[|3↓4↑i − |3↑4↓i] + ...(cid:1)

(13)

which also has the occupation numbers given by Eq. (12).
In other words, the four-fold degeneracy of the occupa-
tion numbers is a necessary but not suﬃcient condition

for the 1RDM to belong to a triplet state with Sz = 0. As
a result, contrary to the fully polarized states, enforcing
a four-fold degeneracy on the occupation numbers might
still yield a singlet state rather than the Sz = 0 triplet
state. However, this is not the most general singlet state.
One can also construct a singlet as

which leads to the following occupation numbers

n1↑ = n1↓ = 1,

n2↑ = n3↑,
n6↑ = n7↑,

n4↑ = n5↑,
. . . .

4

(19)

(20)

(21)

|S = 0, Sz = 0i = c1|1↓1↑i + c2|2↓2↑i + ...

(14)

which leads to occupation numbers that are doubly de-
generate only.

Running a RDMFT calculation with N↑ = N↓ = 1
without enforcing extra constraints we typically ﬁnd the
double degeneracy of the occupations that corresponds
to the general singlet conﬁguration, Eq. (14). This is
true not only for approximate functionals but also for
the exact one which is known for N = 2 [44]. This is not
surprising since the occupation numbers have more vari-
ational freedom than for the states (11) and (13) where a
four-fold degeneracy is required. Even a linear combina-
tion of the general singlet state (14) and the triplet state
(11) yields some occupation numbers which are four-fold
degenerate. For example, the state

c1|1↓1↑i + c2(cid:0)|2↓3↑i + |2↑3↓i(cid:1) ,

where the ﬁrst part is a singlet state while the second
one is a Sz = 0 triplet state, corresponds to occupation
numbers

(15)

(16)

(17)

n1↑ = n1↓ = |c1|2,
n2↑ = n2↓ = n3↑ = n3↓ = |c2|2.

In other words, the occupation numbers coming from the
triplet part are again four-fold degenerate. Note that
due to the fact that we are expanding in natural orbitals,
an orbital from the singlet part of Eq. (15) cannot be
used again in the triplet part since this would introduce
determinants which are single excitations of each other.
Energetically, unless the Hamiltonian contains a mag-
netic ﬁeld or any other spin-speciﬁc terms, the two states
(9) and (11) are degenerate. Hence, for calculating the
triplet energy it should be irrelevant which state is calcu-
lated. However, many RDMFT functionals do not satisfy
this degeneracy. An exception is the M¨uller functional for
which one can show that the states (9) and (11) have the
same energy (see appendix A). In those cases where the
degeneracy is broken one can calculate the Sz = 0 triplet
state by enforcing the four-fold degeneracy of the occu-
pation numbers. This prevents the minimization from
ﬁnding the general singlet state (14) which is lower in
energy. The singlet state with four-fold degeneracy (13)
has a higher energy than the triplet state (11) [45].

For more than two electrons, one often encounters
cases where only the two outer electrons are important
for describing the correct physics. Within any multi-
conﬁguration wave function approach, this corresponds
to working with only two active electrons. For example,
for four electrons one writes the wave function as
|S = 1, Sz = 1i = a1|1↑1↓2↑3↑i + a2|1↑1↓4↑5↑i

+ a3|1↑1↓6↑7↑i + . . .

(18)

Acting with ˆS− on the state (18) we obtain

|S = 1, Sz = 0i =
+

+

a1√2 (cid:0)|1↑1↓2↑3↓i + |1↑1↓2↓3↑i(cid:1)
a2√2 (cid:0)|1↑1↓4↑5↓i + |1↑1↓4↓5↑i(cid:1)
a3√2 (cid:0)|1↑1↓6↑7↓i + |1↑1↓6↓7↑i(cid:1)

+ . . .

with occupation numbers

n1↑ = n1↓ = 1,

n2↑ = n2↓ = n3↑ = n3↓,
n4↑ = n4↓ = n5↑ = n5↓,
n6↑ = n6↓ = n7↑ = n7↓,

...

... .

However, for the |S = 1, Sz = 1i, the choice of forcing
all the inner orbitals to have occupation number equal to
one is very restrictive and leaves no variational freedom
in the spin-down channel. There are cases, as we will
see later, where the corresponding constraints imposed
in an energy minimization lead to an overestimation of
the energy of the triplet state. As an alternative, we
suggest to assume that the inner orbitals are equally, but
not necessarily fully, occupied in the two spin channels,
such that these orbitals give a S = 0 contribution to the
total spin. Hence, we enforce the following conditions on
the occupation numbers for Sz = 1

n1↑ = n1↓,

n2↑ = n3↑,
n6↑ = n7↑
...

n4↑ = n5↑,

... ,

(22)

and leave the occupation numbers of the down channel,
except for n1↓, unconstrained. The conditions for four
electrons (19), (21), and (22) can be extended to any
even number of electrons. One can then apply them to
calculate, for example, approximate triplet excitation en-
ergies. We expect these excitation energies to be correct
for the ﬁrst excited triplet state because the assumption
that this triplet state is built entirely by the two outer
electrons is a good approximation in this case. We would
like to point out that with the constraints (22) the calcu-
lated 1RDM will not necessarily correspond to the correct
expectation value of ˆS2. The, hopefully small, violation
of the triplet will be due to the outer down electrons.
However, as our numerical ﬁndings suggest, this seems

to be the price to pay in order not to overestimate signif-
icantly the energy of the triplet state (see section III B).
We note that enforcing the pinning of some occupa-
tion numbers to one, which is generally an approxima-
tion, reduces dramatically the number of pure-state N -
representability conditions and makes it easier to apply
them in practical implementations. As the number of
electrons and the dimension of the Hilbert space increase,
the number of the exact generalized Pauli constraints ex-
plodes and their consideration in the minimization is ex-
tremely diﬃcult. Pinning an occupation number means
that it has no inﬂuence in the question of pure-state or
ensemble N -representability. From Eqs. (18)-(21) we can
see that the orbitals which correspond to pinned occupa-
tion numbers appear in every Slater determinant in a
pure state. For an ensemble such an orbital would ap-
pear in every Slater determinant of every term that con-
tributes to the ensemble. Consequently, for those systems
where pinning the occupation numbers for all but two
electrons is a valid approximation, we could simply con-
sider the generalized Pauli constraints for two electrons
and for those occupation numbers which are not pinned.
For a two-electron triplet with Sz = ±1 the double de-
generacy constraint (10) coincides with the generalized
Pauli constraint. For the triplet with Sz = 0, the four-
fold degeneracy constraint (12) is stricter but fulﬁls the
generalized Pauli constraints.

So far, we have discussed constraints on the triplet
states. In order to calculate the excitation energy from
a singlet ground state to the ﬁrst excited triplet state,
we also need to calculate the energy of the singlet. Since
many approximations were derived aiming at the correct
description of singlet ground states, we expect to obtain
quantitatively correct results for the singlet ground-state
energies by just enforcing Sz = 0 despite the fact that
we cannot exclude that our density matrix might be con-
taminated by contributions from states with total spin
S larger than zero. Note that for systems with an even
number of electrons, a non-degenerate ground state and
a Hamiltonian which has time-reversal symmetry, by en-
forcing Sz = 0 setting the constraint nj↑ = nj↓, we also
satisfy the generalized Pauli constraints [31].

Let us point out that even when the generalized Pauli
constraints are satisﬁed this does not mean that the
1RDM that we have corresponds necessarily to a pure
state, it could also correspond to an ensemble. However,
by satisfying these constraints we exclude the case that a
given 1RDM corresponds to ensembles only and cannot
correspond to a pure state.

III. RESULTS

We now apply the constraints discussed in the last sec-
tion to the energy minimization in real RDMFT calcu-
lations. We employed three diﬀerent approximations for
the total energy within RDMFT, namely the M¨uller, the
BBC3, and the Power functionals [7, 10, 16]. We ﬁrst,

5

compare the 1RDMs obtained from the constrained cal-
culations to those obtained without these constraints and
the “exact” 1RDM from a MCSCF calculation. We re-
fer to the calculations without the constraints discussed
in this work, related to hˆS2i, as minimizations without
constraint. Despite this name, we still impose the con-
straint (6) which ﬁxes the expectation value of ˆSz and
the correct number of electrons in all our calculations.

As test systems, we considered Helium, H2, Be, BH,
H2O and Mg for which, due to their small size, the MC-
SCF calculations are feasible. For Helium, H2, Be, BH
we used the cc-pVTZ basis set, and the energy mini-
mization for all methods was performed using 10, 14, 35,
and 24 natural orbitals, respectively. For H2O and Mg
we used the cc-pVDZ with 20 and 17 natural orbitals,
respectively.
In all cases, we used less natural orbitals
than the basis sets would allow, since, for small systems,
we obtained very small occupation numbers which cause
numerical problems in the convergence of the MCSCF
calculations. In addition, for larger systems the demands
in memory become prohibitive for the MCSCF calcula-
tion because we want to compare to the exact 1RDM
and, therefore, cannot pin occupations to one. The MC-
SCF triplet as well as the one- and two-electron integral
calculations were performed using the Gamess US code
[46]. The RDMFT calculations were performed with the
HIPPO computer code [47].

A. Quality of 1-RDMs using hˆS2i constraints

As discussed in the previous section, a two electron
wave function with Sz = 1 expressed in terms of natural
orbitals has the form (9), which results in the restric-
tions (10). Thus, we tested if these exact conditions are
satisﬁed for the helium atom and the hydrogen molecule
at diﬀerent internuclear separations by calculating the
ground state for N↑ = 2 and N↓ = 0. We ﬁnd that the
conditions are violated in all cases, i.e. the occupations
are not pairwise equal but show diﬀerences of up to 0.09
within the pairs. The conditions are, as expected, satis-
ﬁed by the MCSCF calculations and, as can be shown an-
alytically, by the exact two-electron RDMFT functional
(LSH) [44]. We then perform the RDMFT calculations
using Eq. (10) as an additional constraint during the op-
timization of the occupation numbers.

We also perform RDMFT minimizations for larger sys-
tems with an even number of particles with the approx-
imate constraint (19), where we assume that the triplet
is formed from the two outermost electrons and the in-
ner orbitals have occupations pinned to one and with the
constraint (22), where we allow the inner occupations to
be less than one. We compare the occupation numbers
from these RDMFT minimizations, with and without en-
forcing the constraints, with occupation numbers from
“exact” MCSCF calculations to check whether the con-
straints help to get a density matrix closer to the exact
one.

6

M¨uller

BBC3

Power

w/o

He
0.001505
H2 (1.4 a.u.) 0.000743
H2 (2.5 a.u.) 0.004083
H2 (5.0 a.u.) 0.001690
average ∆ 0.00201

cons.

0.000063
0.000855
0.000853
0.000808
0.00064

w/o

0.000108
0.000743
0.000312
0.000294
0.00036

cons.

0.000014
0.000006
0.000064
0.000089
0.00004

w/o

0.000109
0.002157
0.000377
0.000161
0.00070

cons.

0.000005
0.000060
0.000063
0.000075
0.00005

w/o

cons. pin.

cons.

w/o

cons.pin

cons.

w/o

cons. pin.

cons.

Be
BH
H2O
Mg
average ∆ 0.09427

0.207842 0.090246 0.068044 0.001813 0.000302 0.000166 0.164014 0.022162 0.010776
0.081441 0.023143 0.0091545 0.028337 0.000731 0.000274 0.078891 0.004478 0.001066
0.034401 0.003178 0.0077090 0.001668 0.000476 0.000152 0.011851 0.000708 0.000877
0.053385 0.034422 0.0162205 0.011861 0.001604 0.000128 0.053019 0.003068 0.003617
0.00408

0.03775

0.02528 0.01092 0.00078 0.00018 0.07694

0.00760

TABLE I. For the Sz = 1 state of two electron systems (top): Deviation ∆ (see Eq. (23)) of the occupation numbers from
the exact occupations (MCSCF) calculated with diﬀerent RDMFT functionals, without (w/o) enforcing the additional exact
spin constraint (10) and with the constraint (cons.). For systems with more than two electrons (bottom): The same deviation
without any constraint (w/o), with the constraint (19) (cons.pin.), or using Eq. (22) (cons.). For each system we used the same
number of natural orbitals and the same basis set for the RDMFT and MCSCF calculations.

As the constraints concern the occupation numbers,
an important criterion for the quality of the calculated
1RDMs is the square diﬀerence

∆ =

1
N

M

Xj=1


 Xσ=↑,↓(cid:0)nRDMFT

jσ

− nMCSCF

jσ

2

(cid:1)


(23)

of the obtained RDMFT occupations from the exact ones,
which we show in table I. In Eq. (23), M denotes the
number of natural orbitals included in the calculation
and N the total number of electrons. We show results
for ∆ without imposing the additional constraints (w/o)
and from calculations with the spin constraint (10) for
two electrons (cons.) in the top half of the table. For
more than two electrons, we impose the constraints (19)
(cons. pin.) and (22) (cons.), and the results are shown
in the bottom half. For the two-electron systems, im-
posing the exact constraint (10), in calculations with the
approximate 1RDM functionals we adopted, results in
optimal occupation numbers closer to the exact ones.
Moreover, for more than two electrons, both approximate
constraints, Eqs. (19) and (22), improve signiﬁcantly the
1RDM as the occupation numbers are much closer to the
exact ones than the occupations from the energy mini-
mization without additional constraints. We should em-
phasize that, although the constraint (22) does not guar-
antee that we get the correct hˆS2i, it leads to occupations
closer to the exact than the constraint (19) which repro-
duces the correct hˆS2i.

Correlations in RDMFT are manifested by fractional
occupation numbers. A measure for the correlation is the
total electronic charge of “weakly” occupied orbitals, i.e.

those with occupations smaller than 1/2, deﬁned as

w = Xnjσ < 1

2

njσ.

(24)

We again compare to the results from a MCSCF calcu-
lation using

(25)

∆w = (cid:12)(cid:12)w − wM CSCF(cid:12)(cid:12)

which is then averaged over all the systems considered.
A known deﬁciency of many approximate functionals,
which can also be seen in table II, is that they typically
overestimate w. For two electron systems, imposing the
exact constraint (10) for S = 1 and Sz = 1, lowers w
to values closer to the exact ones. The only exception
here is H2 at equilibrium distance with the M¨uller func-
tional. For systems with more than two electrons, both
the constraints (19) and (22) reduce w to values closer to
the “exact” MCSCF result. Results with the constraint
(22), i.e. without pinning the inner occupation numbers,
are the closest to MCSCF.

So far, we have assessed the quality of the optimal
1RDMs from our calculations by comparing them to the
results from MCSCF calculations. However, the goal was
to calculate 1RDMs with a speciﬁc expectation value for
the total spin which requires a functional of hˆS2i in terms
of the 1RDM. For the M¨uller functional, the energy func-
tional was derived using an ansatz for the second order
reduced density matrix Γ(2) in terms of the 1RDM [7].
Using this ansatz for Γ(2) we can calculate hˆS2i from Eq.
(1). The resulting expression reads

hˆS2iM¨uller =

(N↑ − N↓)2

4
∞

+ (N↑ + N↓)

1
2

−

Xj=1 Xσσ′=↑,↓q(njσ, njσ′ ).

(26)

M¨uller

BBC3

Power

MCSCF

w/o

4.9·10−2
He
H2 (1.4 a.u.) 3.8·10−2
H2 (2.5 a.u.) 8.5·10−2
H2 (5.0 a.u.) 5.4·10−2
average ∆w 5.4·10−2

cons.

1.3·10−2
5.5·10−2
5.4·10−2
5.1·10−2
4.1·10−2

w/o

1.3·10−2
3.8·10−2
2.5·10−2
2.3·10−2
2.3·10−2

cons.

6.3·10−3
1.7·10−2
1.7·10−2
1.7·10−2
1.2·10−2

w/o

1.3·10−2
6.1·10−2
2.7·10−2
1.7·10−2
2.7·10−2

cons.

3.8·10−3
1.9·10−2
1.7·10−2
1.5·10−4
1.1·10−2

1.9·10−4
5.7·10−3
3.0·10−3
2.5·10−4

-

7

w/o

cons. pin.

cons.

w/0

6.8·10−1 6.8·10−1 5.9·10−1 8.2·10−2 5.5·10−2 4.3·10−2
4.5·10−1 3.8·10−1 3.4·10−1 7.2·10−2 5.5·10−2

1.1

cons. pin.
3.3·10−1 2.3·10−1 1.5·10−2
2.0·10−1 1.3·10−1 7.7·10−2
4.1·10−1 2.3·10−1 2.0·10−1 1.1·10−1 8.6·10−2 6.7·10−2 2.3·10−1 1.1·10−1 7.9·10−2 8.1·10−2
2.3·10−1 2.3·10−1 1.3·10−2

Be
BH
H2O
Mg
average ∆w 7.5·10−1 4.7·10−1 3.3·10−1 1.6·10−1 5.0·10−2 1.5·10−2 7.7·10−1 7.2·10−1 1.2·10−1

7.1·10−1 5.0·10−1 3.0·10−1 1.6·10−1 5.6·10−2

cons.pin cons.

1.0
1.0

w/o

cons.

1.0

1.0

-

TABLE II. Same as table I but for the sum of the occupation numbers of the weakly occupied orbitals, w (see Eq. (24)). ∆w
denotes the absolute deviation from the “exact” MCSCF results which is then averaged over all systems in each part of the
table.

Without constraint
With constraint

ployed, the functionals for hˆS2i that are consistent with
the energy functionals are not available.

0.6

0.5

0.4

2

S
∆

0.3

0.2

0.1

0.0

Be

BH

H2O

Mg

FIG. 1. Diﬀerence between hˆS2i calculated from Eq. (26) and
the exact hˆS2i = 2 for a triplet state. The triplet is calculated
without any constraints for ˆS2 (green shaded) and with the
constraint Eq. (22) (red full).

The correct expectation value of the triplet state is
hˆS2i = 2. Thus, we calculate the diﬀerence

∆S2 = 2 − hˆS2iM¨uller

(27)

to examine whether imposing the constraint (22) im-
proves hˆS2i or not. The results we obtained are shown
It is apparent that in all cases the consid-
in Fig. 1.
ered approximate constraint improves the values of hˆS2i
obtained with Eq. (26). Note that with the constraint
(19), where we pin the inner occupation numbers to one,
and for two-electron systems, where Eq. (10) is the exact
constraint, ∆S2 is zero and therefore not included in Fig.
1.

Let us point out that the M¨uller ansatz for Γ(2) is not
exact, therefore, the calculated value hˆS2iM¨uller is also not
exact. However, the value is consistent with the energy
functional which was used in the minimization procedure.
Unfortunately, for the other approximations that we em-

B. Energy of excited triplet states

In this subsection, we discuss the eﬀect of imposing the
constraints for hˆS2i on the total energies of excited triplet
states. By imposing the constraint (10) we calculate the
lowest lying triplet energy of two-electron systems with
Sz = 1 and compare it with the energy that we get using
the constraint (12) for the triplet with Sz = 0. As we
shown in appendix A, the M¨uller functional respects the
degeneracy between the Sz = 0 triplet state and the fully
polarized triplet states. This is not the case for the other
approximations we employed in this work.

In Fig. 2, we plot the energy diﬀerence between the ﬁrst
excited triplet and the the ground-state singlet of the H2
molecule, i.e. the ﬁrst singlet to triplet excitation energy,
using the BBC3 functional. The unconstrained calcula-
tion for Sz = 1 agrees only qualitatively with the MCSCF
results. Enforcing the constraint (10) for S = 1, Sz = 1
slightly improves the excitation energies. The best re-
sults are obtained by enforcing the constraint (12) for
S = 1, Sz = 0. The diﬀerence in the two constrained
calculations arises from the fact that the degeneracy of
S = 1, Sz = 1 and S = 1, Sz = 0 is broken by the func-
tional. In table III we show the singlet-triplet excitation
energies of the helium atom and the hydrogen molecule
at two diﬀerent interatomic distances for all functionals
that we used. In all the cases, the constraints for hˆS2i
improve the corresponding energies compared to the un-
constrained Sz = 1 calculation. Furthermore, for the
BBC3 and Power functionals, where the S = 1, Sz = 1
and S = 1, Sz = 0 constraints give diﬀerent results, the
second one gives energies closer to the exact ones in all
the cases considered here. Nevertheless, we see that for

BBC3 Sz=1
BBC3 Sz=1 constraint
BBC3 Sz=0 constraint
MCSCF

)

V
e
(
 
y
g
r
e
n
e
 

n
o
i
t
a
t
i
c
x
E

 

10

8

6

4

2

0

1.5

2

2.5

3
3.5
R (a.u.)

4

4.5

5

FIG. 2. Excitation energy, ground-state singlet to the lowest
triplet, of the hydrogen molecule using the BBC3 functional.
The triplet is calculated either by just imposing Sz = 1 with
no constraint for hˆS2i or by additionally imposing the con-
straint for S = 1, Sz = 1 (Eq. (10)) or for S = 1, Sz = 0 (Eq.
(12)).

some cases where the functionals fail signiﬁcantly to re-
produce the excitation energies, the constraints are not
enough to recover quantitatively satisfactory results. As
a measure for the quality of the functional in calculating
triplet energies we include the mean deviation from the
MCSCF energies, i.e.

|∆E|
|E|

= |E − EM CSCF|

|EM CSCF|

,

(28)

where E is the RDMFT energy. The average of this
quantity over diﬀerent systems is also given in table III.
In table III, we also include results for systems with
more than two electrons. These systems are chosen be-
cause one can assume that their ﬁrst excited triplet is
formed by the two outermost electrons only. In the sec-
ond column, we give the excitation energy which is cal-
culated using the constraint (19), i.e. by pinning the oc-
cupations of all core orbitals to one and letting only the
outer orbitals for the majority spin to be fractionally oc-
cupied with two electrons. Although this guarantees the
correct hˆS2i=2, the restriction of pinning the occupation
numbers results in many cases in a signiﬁcant overesti-
mation of the excitation energies, giving overall worse
results than imposing no extra constraint. Therefore, we
loosened the constraint for the inner occupations by only
enforcing the constraint (22). The results are given in
the third column. As discussed before, the expectation
value hˆS2i is now only approximately reproduced but, as
we saw in Fig. 1, is still closer to the exact than impos-
ing no additional restriction. For the BBC3 and Power
functionals, imposing (22) improves on average the ex-
citation energies compared to the unconstrained calcula-
tions, however, the results for water with the BBC3 func-
tional deteriorate. For the M¨uller functional, the excita-
tion energies improve except for the BH molecule where

8

the excitation energy is largely overestimated which then
leads to a large average deviation. In the fourth column,
we state the excitation energies calculated for Sz = 0
with the constraint (21). For the M¨uller and the Power
functionals, this restriction overall improves the excita-
tion energies while the results for BBC3 are on average
worse than the ones from the unconstrained calculation.
In detail, the results for this constraint are mixed, for
some systems and some functionals the excitation ener-
gies improve while they deteriorate for other.

Overall, applying the constraints discussed in this
manuscript in combination with three approximate func-
tionals did not give a systematic improvement or deterio-
ration of the excitation energies. Additionally, the small
number of systems that we considered, does not allow us
to draw a decisive conclusion on the eﬀect of the con-
straints on the excitation energies. The excitation en-
ergies (with or without the additional constraints) show
a large error compared to those from MCSCF, for all
the functionals we employed. This is, at least partially,
due to the fact that functionals in RDMFT are typically
devised and tuned to reproduce the energies of ground-
state singlets. They even fail, in some cases, to identify
that there is a triplet with lower energy. For example
the M¨uller functional yields a singlet as the ground state
for the Oxygen and Carbon atoms instead of the correct
triplet states.

As we discussed before, with the restriction (22) we
cannot guarantee that we get a triplet as there exists
a singlet with the same occupations. However, if the
triplet is lower in energy than the corresponding singlet
then the minimization will ﬁnd it. The advantage of this
restriction is that it can be applied for functionals that
are devised to treat systems with the same number of up
and down electrons.

IV. CONCLUSION

We have considered necessary conditions for the one
body-reduced density matrix of a system of two elec-
trons to correspond to a triplet state. There are separate
conditions for the fully polarized triplet states Sz = ±1
and for the Sz = 0 state. In a spin restricted descrip-
tion, i.e. assuming the same spatial dependence of the
natural orbitals in the two spin channels, the conditions
for Sz = ±1 restrict the occupation numbers to be dou-
bly degenerate. For Sz = 0, on the other hand, a 4-
fold degeneracy of the occupation numbers was found.
We ﬁrst tested if the conditions are satisﬁed for the
fully polarized, Sz = ±1, triplet states of prototype two
electron systems, namely the helium atom and the H2
molecule, using typical approximate RDMFT functionals
and found that they are violated signiﬁcantly. They are,
however, satisﬁed by the exact functional for two elec-
trons, as can be shown analytically, and in MCSCF cal-
culations. Since the conditions only aﬀect the degeneracy
of the occupation numbers they can easily be enforced in

9

Sz=1
w/o

25.18
He
9.20
H2 1.4 a.u.
3.31
H2 2.5 a.u.
average |∆E|/|E| 0.12

M¨uller
Sz=1
cons.

25.63
9.91
3.57
0.07

Sz=0 Sz=1
cons. w/0

25.63 25.44
9.91 9.71
3.57 3.29
0.07 0.10

BBC3
Sz=1
cons.

25.59
10.02
3.41
0.08

Sz=0 Sz=1
cons. w/o

25.73 25.17
10.55 9.50
3.81 2.83
0.03 0.15

Power
Sz=1
cons.

25.30
9.75
2.91
0.13

MCSCF

Sz=0
cons.

27.81 26.19
11.60 10.67
4.78
4.00
0.11

Sz=1 Sz=1 Sz=1 Sz=0 Sz=1 Sz=1 Sz=1 Sz=0 Sz=1 Sz=1 Sz=1 Sz=0
w/o cons. pin. cons. cons. w/0 cons.pin cons. cons. w/o cons. pin. cons. cons.

1.37
Be
2.06
BH
6.12
H2O
Mg
1.86
average |∆E|/|E| 0.38

2.61
4.88
12.83
3.19
0.92

2.51 1.40 2.19
3.79 1.16 1.13
9.08 5.37 8.16
2.91 1.44 2.09
0.57 0.34 0.12

2.58
1.91
10.84
2.71
0.24

2.47 2.63 0.86
1.40 1.96 0.79
9.09 9.33 6.94
2.26 2.41 1.30
0.08 0.17 0.42

1.78
1.99
9.58
2.29
0.27

1.74 2.49
1.71 1.43
8.39 6.83
2.11 2.26
0.20 0.09

2.73
1.32
8.12
2.38

-

TABLE III. Energy diﬀerence between the ﬁrst excited triplet state and the singlet ground state (in e.V.) for diﬀerent RDMFT
functionals calculated with or without additional constraints for hˆS2i. For two electron systems the triplet is calculated either
by just imposing Sz = 1 without additional constraints, or by imposing the constraint (10) for S = 1, Sz = 1 or the constraint
(12) for S = 1, Sz = 0. For systems with more than two electrons the triplet is calculated with Sz = 1 without any additional
spin constraint, with Sz = 1 and imposing the constraint (19), where we pin the inner occupations to one, and with Sz = 1
and imposing the constraint (22). For Sz = 0 we impose the constraint (21). The exact energies obtained with MCSCF using
the same basis set and the same number of natural orbitals are also given for comparison.

realistic RDMFT calculations as additional constraints
in the energy minimization. Thus, we applied the con-
ditions for Sz = 1 to calculate the lowest excited triplet
states of the aforementioned two-electron systems. We
found that, with the employed approximations, the opti-
mal occupation numbers improve signiﬁcantly compared
to “exact” MCSCF results. We also applied the condi-
tions for Sz = 1 and Sz = 0 triplets to calculate the
excitation energies between the triplet and the ground-
state singlet and found an overall improvement of the ex-
citation energies. However, in cases where the employed
approximate functionals fail signiﬁcantly in giving the
excitation energies, the conditions are not enough to re-
produce a quantitatively satisfactory result.

We also evaluated the idea of applying the aforemen-
tioned conditions, which are exact for two electron sys-
tems, to systems with more than two electrons. For
Sz = ±1, we employed two diﬀerent approximate con-
straints: In the ﬁrst, all electrons from the minority spin
channel and all but two electrons for the majority spin
channel occupy pinned natural orbitals, leaving only two
electrons from the majority spin channel to lead to frac-
tional occupation numbers. In the second, spin-up and
spin-down core natural orbitals have equal occupancies
which are not necessarily pinned to one, and the two-
fold degeneracy is assumed only for the weakly occu-
pied natural orbitals which accommodate the two addi-
tional electrons of the majority spin. Following the sec-
ond path one only obtains an approximate triplet state.
We evaluated the approximate constraints that we pro-
pose by testing their eﬀect when imposed as additional
constraints in RDMFT minimizations of some atoms and

molecules and found that in all cases we get occupation
numbers closer to the exact ones than without imposing
them. For Sz = 0 triplets, the extension we considered
assumes that core natural orbitals accommodating all but
two electrons form a singlet state and are pinned, while
the rest of the orbitals, which accommodate the two re-
maining electrons follow the 4-fold degeneracy as in the
case of only two electrons. Same as for the two-electron
systems, we applied the constraints both for Sz = ±1 and
Sz = 0 to RDMFT minimizations with diﬀerent function-
als to calculate excitation energies between the singlet
ground state and the ﬁrst excited triplet. Our results
for the excitation energies are not conclusive as we do
not ﬁnd a systematic improvement for any of the func-
tionals. For some systems, the energies do improve by
applying the constraints while for others they get worse.
It is our belief that this is due to the fact that singlet
state total energies are the main focus of present day ap-
proximations and there is no guarantee of the quality of
their results when extended to triplet states. For exam-
ple, most functionals break the degeneracy between the
fully polarized and the Sz = 0 triplet states.

The present work is a signiﬁcant step in the description
of high-spin states using reduced density matrix func-
tional theory. Our ﬁndings motivate the development
of approximations which could oﬀer a better description
for triplet states by following the proposed recipe. A
benchmark for these approximations would be the pre-
diction of the triplet ground states of atomic and molec-
ular systems. Finally, with the proposed methodology,
it becomes feasible to access the Sz = 0 triplet state in
RDMFT by applying the appropriate necessary condi-

tions. Consequently, for any new functional one could
test the degeneracy between the fully polarized and the
Sz = triplet states.
In the future, with the improve-
ment of available approximations, it will be possible for
RDMFT to study cases of broken degeneracy of the
triplet states, e.g. when magnetic ﬁelds are applied.

V. ACKNOWLEDGMENTS

IT and NH acknowledge support from a Emmy-
Noether grant from Deutsche Forschungsgemeinschaft.
NNL acknowledges support from the Greek Ministry of
Education (EΣΠA program), GSRT action KPHΠIΣ,
project “New multifunctional Nanostructured Materials
and Devices - POLYNANO” (No. 447963).
IT would
like to acknowledge Dr. S.Thanos for useful discussions
on the manuscript.

Appendix A: Degeneracies in the M¨uller functional

In this Appendix, we show that for two-electron sys-
tems, the M¨uller functional respects the energy degen-
eracy of the Sz = 1 and Sz = 0 triplet states. The
states (9) and (11) have the same natural orbitals but
diﬀer in their occupation. If the occupation numbers of
the Sz = 1 state are denoted by nj↑ (the down channel
is empty) then the occupation numbers for the Sz = 0
state, ˜njσ, are given by

˜nj↑ = ˜nj↓ = nj↑/2.

(A1)

Starting from the solution of the fully polarized state we
know that the total energy is given by

E =

nj↑Z d3rϕ∗

j (r)(cid:18)−∇2

2

nj↑nk↑Jjk −

1
2

∞

Xj,k=1

∞

Xj=1
Xj,k=1

∞

+

1
2

with

+ vext(r)(cid:19) ϕj (r)
√nj↑nk↑Kjk

(A2)

Jjk = ZZ d3rd3r′ |ϕj(r)|2|ϕk(r′)|2
Kjk = ZZ d3rd3r′ ϕ∗

|r − r′|

j (r)ϕ∗

k(r′)ϕk(r)ϕj (r′)
|r − r′|

,

(A3)

.

(A4)

The derivative of the total energy wrt. the occupation
number nj↑ reads as

10

As we are at the solution point, the derivatives wrt. all
fractional occupation numbers satisfy

∂E
∂nj↑

= µ,

(A6)

where µ denotes the chemical potential of the system.

Using the occupation numbers ˜njσ of the h ˆSzi = 0

state instead, the total energy is given as

j (r)(cid:18)−∇2

2

∞

1

∞

+

˜njσ Z d3rϕ∗

Xj=1
E = Xσ
2 Xσσ′
Xj,k=1
Xj,k=1p˜njσ ˜nkσKjk.
2 Xσ

˜njσ ˜nkσ′ Jjk

−

∞

1

+ vext(r)(cid:19) ϕj (r)

(A7)

Making the spin sums explicit this can be rewritten as

E =

+

−

∞

2

∞

1
2

j (r)(cid:18)−∇2

(˜nj↑ + ˜nj↓)Z d3rϕ∗

Xj=1
Xj,k=1
Xj,k=1(cid:16)p˜nj↑ ˜nk↑ +p˜nj↓ ˜nk↓(cid:17) Kjk

(˜nj↑ + ˜nj↓) (˜nk↑ + ˜nk↓) Jjk

1
2

∞

+ vext(r)(cid:19) ϕj(r)

(A8)

which, using Eq. (A1) is identical to the energy of the
h ˆSzi = 1 state, Eq. (A2). However, we still need to show
that this energy is also an extremum. For the derivative
wrt. the occupation numbers we obtain

∂E
∂ ˜njσ

= Z d3rϕ∗
+ Xσ′
Xk=1

j (r)(cid:18)−∇2
+ vext(r)(cid:19) ϕj(r)
Xk=1

˜nkσ′ Jjk −

Kjk.

∞

∞

2

√˜nkσ
2p˜njσ

(A9)

Again making the spin sum explicit in the second term
and using ˜nkσ/˜njσ = nk↑/nj↑ we ﬁnd that the derivative
is the same as in Eq. (A5). Hence, if the occupation
numbers nj↑ minimize the total energy for the triplet
Sz = 1 state then the occupation numbers ˜njσ deﬁned in
Eq. (A1) form the minimum for the triplet Sz = 0 state.
We note that this derivation crucially depends on the
square root dependence in the exchange term. For a gen-
eral power α, i.e. (njσnkσ)α in the exchange energy, one
ﬁnds factors of 2/22α and 1/22α−1 in the exchange en-
ergy and its derivative, respectively, when comparing the
terms for nj↑ and ˜njσ. In other words, the terms are only
the same for α = 1/2.

∂E
∂nj↑

= Z d3rϕ∗
Xk=1

j (r)(cid:18)−∇2
Xk=1

nk↑Jjk −

+

∞

∞

2

+ vext(r)(cid:19) ϕj(r)
√nk↑
2√nj↑

Kjk.

We also emphasize that the degeneracy holds only if
the two sets of orbitals are identical. Since the two states
(9) and (11) are connected by ˆS±, which only acts on the
spin degrees of freedom, this is satisﬁed. However, if one
determines the orbitals from an energy minimization it

(A5)

can happen that one ﬁnds diﬀerent minima for the or-
bitals in the two cases resulting in a broken degeneracy.
In the systems that we have tested we found that the de-
generacy is satisﬁed with an accuracy of 6 decimal digits
which corresponds to the convergence of the overall cal-
culation.

As we have seen, for the M¨uller functional the sums are
the same because all the terms in the sums are identical.
For the other functionals considered here, there might be
speciﬁc cases of sets of occupation numbers that triplet
states are degenerate, i.e. the sums are equal, however
this degeneracy does not hold in general.

11

[1] T. L. Gilbert, Phys. Rev. B 12, 2111 (1975).
[2] N. N. Lathiotakis, N. Helbig, and E. K. U. Gross, Phys.

[23] V. Rassolov, J. Comp. Phys. 117, 5978 (2002).
[24] V. A. Rassolov and F. Xu, J. Comp. Phys. 127, 044104

Rev. A 72, 030501 (2005).

(2007).

[3] M. Piris, J. M. Matxain, X. Lopez, and J. M. Ugalde,

[25] N. N. Lathiotakis, N. Helbig, A. Rubio, and N. I. Gi-

The Journal of Chemical Physics 131, 021102 (2009).

dopoulos, Phys. Rev. A 90, 032511 (2014).

[4] D. R. Rohr and K. Pernal, The Journal of Chemical

[26] J. M. Matxain, M. Piris, F. Ruiperez, X. Lopez, and J. M.

Physics 135, 074104 (2011).

Ugalde, Phys. Chem. Chem. Phys. 13, 20129 (2011).

[5] P. Hohenberg and W. Kohn, Phys. Rev. 136, B864

[27] N. Helbig, N. N. Lathiotakis, M. Albrecht, and E. K. U.

(1964).

[6] K. Pernal and K. J. H. Giesbertz, in Density-Functional
Methods for Excited States, edited by N. Ferr´e, M. Fila-
tov, and M. Huix-Rotllant (Springer International Pub-
lishing, Cham, 2016), pp. 125–183, ISBN 978-3-319-
22081-9.

[7] A. M. K. M¨uller, Phys. Lett. A 105, 446 (1984).
[8] S. Goedecker and C. J. Umrigar, Phys. Rev. Lett. 81,

866 (1998).

[9] M. A. Buijse and E. J. Baerends, Mol. Phys. 100, 401

(2002).

Gross, EPL (Europhysics Letters) 77, 67003 (2007).

[28] N. N. Lathiotakis, S. Sharma, N. Helbig, J. Dewhurst,
M. Marques, T. Baldsiefen, A. Zacarias, and E. Gross,
Zeitscrift f¨ur Physikalische Chemie 224, 467 (2010).

[29] A. Putaja and E. R¨as¨anen, Phys. Rev. B 84,
035104 (2011), URL http://link.aps.org/doi/10.
1103/PhysRevB.84.035104.

[30] A. J. Coleman, Rev. Mod. Phys. 35, 668 (1963).
[31] D. W. Smith, Phys. Rev. 147, 896 (1966).
[32] M. Altunbulak, Ph.D. thesis, Bilkent University (2008).
[33] M. Altunbulak and A. Klyachko, Communications in

[10] O. Gritsenko, K. Pernal, and E. J. Baerends, J. Chem.

Mathematical Physics 282, 287 (2008).

Phys. 122, 204102 (2005).

[11] N. N. Lathiotakis, N. Helbig, A. Zacarias, and E. K. U.
Gross, The Journal of Chemical Physics 130, 064109
(2009).

[12] M. Piris, J. Comp. Phys. 141, 044107 (2014).
[13] K. Pernal, J. Chem. Theory Comput. 10, 4332 (2014).
[14] D. R. Rohr, K. Pernal, O. V. Gritsenko, and E. J.

Baerends, J. Comp. Phys. 129, 164105 (2008).

[15] M. A. L. Marques and N. N. Lathiotakis, Phys. Rev. A

77, 032509 (2008).

[16] S. Sharma, J. K. Dewhurst, N. N. Lathiotakis, and

E. K. U. Gross, Phys. Rev. B 78, 201103 (2008).

[17] Y. Shinohara, S. Sharma, S. Shallcross, N. N. Lathio-
takis, and E. K. U. Gross, Journal of Chemical Theory
and Computation 11, 4895 (2015).

[34] R. E. Borland and K. Dennis, Journal of Physics B:

Atomic and Molecular Physics 5, 7 (1972).

[35] C. L. Benavides-Riveros, J. M. Gracia-Bond´ıa, and

M. Springborg, Phys. Rev. A 88, 022508 (2013).

[36] C. L. Benavides-Riveros and M. Springborg, Phys. Rev.

A 92, 012512 (2015).

[37] I. Theophilou, N. N. Lathiotakis, M. A. L. Marques, and
N. Helbig, The Journal of Chemical Physics 142, 154108
(2015).

[38] P.-O. L¨owdin, Phys. Rev. 97, 1474 (1955).
[39] D. R. Alcoba and C. Valdemoro, International Journal of
Quantum Chemistry 102, 629 (2005), ISSN 1097-461X.
[40] E. Ramos-Cordoba, P. Salvador, M. Piris, and E. Matito,

The Journal of Chemical Physics 141, 234101 (2014).

[41] A. J. Cohen, D. J. Tozer, and N. C. Handy, The Journal

[18] N. Lathiotakis, S. Sharma, J. Dewhurst, F. Eich, M. Mar-

of Chemical Physics 126, 214104 (2007).

ques, and E. Gross, Phys. Rev. A 79, 040501 (2009).

[19] M. Piris, Int. J. Quant. Chem. 106, 1093 (2006).
[20] M. Piris, J. M. Matxain, X. Lopez, and J. M. Ugalde, J.

[42] C. R. Jacob and M. Reiher, International Journal of
Quantum Chemistry 112, 3661 (2012), ISSN 1097-461X.
[43] J. Wang, A. D. Becke, and V. H. Smith, The Journal of

Comp. Phys. 132, 031103 (2010).

Chemical Physics 102, 3477 (1995).

[21] M. Piris, X. Lopez, F. Ruiperez, J. M. Matxain, and J. M.

Ugalde, J. Comp. Phys. 134, 164102 (2011).

[44] P.-O. L¨owdin and H. Shull, Phys. Rev. 101, 1730 (1956).
[45] P. Atkin and J. Paula, Physical Chemistry (Oxford Uni-

[22] P. R. Surj´an, in Correlation and Localization, edited by
P. R. Surj´an, R. J. Bartlett, F. Bog´ar, D. L. Cooper,
B. Kirtman, W. Klopper, W. Kutzelnigg, N. H. March,
P. G. Mezey, H. M¨uller, et al. (Springer Berlin Heidel-
berg, 1999), vol. 203 of Topics in Current Chemistry, pp.
63–88, ISBN 978-3-540-65754-5.

versity Press, 2014).

[46] M. W. Schmidt, K. K. Baldridge, J. A. Boatz, S. T. El-
bert, M. S. Gordon, J. J. Jensen, S. Koseki, N. Mat-
sunaga, K. A. Nguyen, S. Su, et al., J. Comput. Chem.
14, 1347 (1993).

[47] HIPPO computer program, info: lathiot@eie.gr.

