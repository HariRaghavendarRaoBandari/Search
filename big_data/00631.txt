NORM-VARIATION OF ERGODIC AVERAGES WITH RESPECT TO

TWO COMMUTING TRANSFORMATIONS

POLONA DURCIK, VJEKOSLAV KOVA ˇC, KRISTINA ANA ˇSKREB, AND CHRISTOPH THIELE

6
1
0
2

 
r
a

M
2

 

Abstract. In this paper we study double ergodic averages with respect to two general
commuting transformations and establish quantitative results on their convergence in the
norm. In particular we estimate the number of ε-ﬂuctuations in the L2 norm of the sequence
of ergodic averages by ε−α for α > 8. We approach the problem via real harmonic analysis,
using recently developed methods for bounding multilinear singular integrals with certain
entangled structure. A byproduct of our proof is a bound for a two-dimensional bilinear
square function related to the triangular Hilbert transform. Lp estimates for the triangular
Hilbert transform remain an open problem.

 
 
]
S
D
h
t
a
m

.

[
 
 

1
v
1
3
6
0
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

This paper, while self-contained, builds on a technique for bounding multi-linear and multi-
scale singular integral operators developed in [11],[12],[16],[17],[18],[19],[20]. We consider the
present application to quantitative norm convergence for double ergodic averages with two
commuting transformations a milestone in these eﬀorts.

The technique resembles energy methods in partial diﬀerential equations. The main in-
gredients are integration by parts, positivity arguments, and the Cauchy-Schwarz inequality.
The idea is to set up a partial integration scheme to produce positive terms, similar to ener-
gies, and then use upper bounds on a sum of positive terms to control each term individually.
Unlike for most energy arguments in partial diﬀerential equations, here the partial integration
happens in the scale parameter, which is typical for singular integral theory. The structural
complexity of the problem requires to iterate these steps, with the Cauchy-Schwarz inequality
used inbetween to reduce the complexity of the expressions.

Many problems in ergodic theory are related to the convergence of multiple averages as
in Tao [28] and in this paper we are concerned with the general bilinear case. Let (X,F, µ)
be a σ-ﬁnite measure space and let S, T : X → X be two commuting measure-preserving
transformations, i.e. for any E ∈ F we have S−1E, T −1E ∈ F and µ(S−1E) = µ(E) =
µ(T −1E). For any two real-valued measurable functions f, g on X and any positive integer n
we deﬁne the double ergodic average Mn(f, g) as a function on X given by

Mn(f, g)(x) :=

1
n

n−1Xi=0

f (Six)g(T ix)

(1.1)

for each x ∈ X. It is a classical result by Conze and Lesigne [7] that for any two functions
f, g ∈ L∞(X) on a probability space the sequence of averages (Mn(f, g))∞
n=1 converges in the
L2 norm. Standard density arguments combined with log-convexity of Lp norms extend this
result to functions f ∈ Lp1(X), g ∈ Lp2(X), with convergence in the Lp norm, as long as the
exponents satisfy p < ∞ and 1/p ≥ 1/p1 + 1/p2; see a similar argument in Section 7.
Almost everywhere convergence of averages (1.1) is a longstanding open problem. The task
simpliﬁes and enables the analytic approach if T is assumed to be a power of S, for instance

Date: March 3, 2016.
2010 Mathematics Subject Classiﬁcation. Primary 37A30; Secondary 42B15, 42B20.

1

2

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

S is invertible and T = S−1. In this particular case a.e. convergence of (Mn(f, g))∞
n=1 for a
general invertible measure-preserving S and for f, g ∈ L∞(X) was shown by Bourgain [6].
Subsequently, this result was made quantitative in the form of a pointwise variation estimate
by Do, Oberlin, and Palsson [9]. We avoid listing further partial progress on a.e. convergence
for general commuting transformations and only refer to the preprint by Donoso and Sun [10]
and references therein. In the paper by Donoso and Sun the a.e. convergence is veriﬁed under
the additional assumption that (X,F, µ, S, T ) forms a so-called distal system, i.e. a certain
iterated topological extension of the trivial system.
Our main result is a quantitative version of the norm convergence of the averages (1.1).
Let us recall that the number of ε-jumps or ε-ﬂuctuations of a sequence (an)∞
n=1 in a Banach
space (B,k · kB) is deﬁned as the largest nonnegative integer J for which there exist indices
(1.2)
such that kamj − anjkB ≥ ε for j = 1, 2, . . . , J. If there exist arbitrarily large such J, then
we regard the number of ε-jumps to be inﬁnite. In our current setting it is natural to take B
to be the Hilbert space L2(X).

m1 < n1 ≤ m2 < n2 ≤ ··· ≤ mJ < nJ

Theorem 1. For any α > 8 there is a ﬁnite constant Cα such that for all 0 < ε < 1 and
all systems (X,F, µ, S, T ) as above and all functions f, g ∈ L4(X) normalized by kfkL4(X) =
kgkL4(X) = 1 the number of ε-jumps of the averages (1.1) in the L2(X) norm is at most
Cαε−α.

In particular, the number of ε-jumps of the sequence (Mn(f, g))∞

n=1 in the L2 norm is ﬁnite
for each ε > 0, which implies its norm convergence, i.e. it reproves the result from Conze and
Lesigne [7].

Another consequence of Theorem 1 is that for any ε > 0 the sequence (Mn(f, g))∞

n=1 can
be covered by at most 1 + Cαε−α balls of radius ε in the Hilbert space L2(X). Such a result is
sometimes called a uniform bound for the metric entropy. Somewhat related to our topic, it
was shown by Bourgain [5] that a.e. convergence of certain sequences of functions (including
the single ergodic averages) necessarily implies the uniform bound on their metric entropy.
In that light Theorem 1 can be thought of as a partial progress towards the conjecture on
a.e. convergence of (Mn(f, g))∞
n=1, even though the bilinear analogue of [5] does not appear
in the literature.

Recall that for a nonempty U ⊆ R and for 1 ≤ ̺ < ∞ the ̺-variation of an indexed
collection (at)t∈U in a Banach space B (i.e. a function U → B given by t 7→ at) is the quantity

katkV ̺

t (U ,B) :=

sup

m∈N∪{0}

t0,t1,...,tm∈U
t0<t1<···<tm

(cid:16) mXj=1

katj − atj−1k̺

B(cid:17)1/̺

.

Usually U is the set of positive integers N, in which case (an)n∈U is a sequence, or U is an
interval, in which case (at)t∈U is a parametrized curve in B. We can also reformulate our
result into norm-variation estimates for (1.1), in analogy with the inequalities appearing in
[2],[14] and those that are implied by the stronger pointwise variation estimates in [9],[13].

Corollary 2.

(a) For any f, g ∈ L4(X) and ̺ > 8 we have

kMn(f, g)kV ̺

n (N,L2(X)) ≤ C̺ kfkL4(X)kgkL4(X)

for some ﬁnite constant C̺ depending on ̺ alone.

(b) If (X,F, µ) is a probability space, then for any f, g ∈ L∞(X), 1 ≤ p < ∞, and

̺ > max{4p, 8} we have

kMn(f, g)kV ̺

n (N,Lp(X)) ≤ Cp,̺ kfkL∞(X)kgkL∞(X)

NORM-VARIATION OF ERGODIC AVERAGES

3

for some ﬁnite constant Cp,̺ depending only on p and ̺.

Such estimates for multiple ergodic averages were stated as open problems by Avigad and
Rute in the closing section of [2]. A result analogous to Corollary 2 was previously established
by the second author [18], but only for a simpliﬁed model, where the actions of Z are replaced
by actions of inﬁnite powers Aω of a ﬁxed ﬁnite abelian group A, and which avoided many
technical complications we meet in this paper.

The techniques from this paper do not immediately generalize to the multiple variants of
(1.1), i.e. to the analogous ergodic averages with respect to several commuting transforma-
tions. However, such averages are also known to converge in the norm, as was ﬁrst shown by
Tao [28], with a diﬀerent proof given by Austin [1], and this fact was also generalized to the
case when the transformations generate a nilpotent group by Walsh [30].

Our approach uses techniques from real harmonic analysis, in particular techniques orig-
inating in [11] by the ﬁrst author in order to bound a certain quadrilinear singular integral
form. A notable diﬀerence from the almost everywhere result [9] is that we do not use wave
packet analysis or time-frequency analysis, these tools are not adapt for our problem.

For an integrable function ϕ on R, for two-dimensional functions F, G ∈ L4(R2), for t > 0,

and for (x, y) ∈ R2 we introduce smooth bilinear averages Aϕ

t (F, G) by

Aϕ

t (F, G)(x, y) :=ZR

F (x + s, y)G(x, y + s) t−1ϕ(t−1s) ds.

Theorem 1 will be a consequence of the following bilinear estimate.

Theorem 3. For each λ > 3 there exists a ﬁnite constant Cλ such that for any continuously
diﬀerentiable function ϕ satisfying

|ϕ(s)| + |sϕ′(s)| ≤ (1 + |s|)−λ

(1.3)

one has the estimate

for all s ∈ R and having its Fourier transform bϕ supported in [−1, 1] and for any F, G ∈ L4(R2)

t (F, G)kV 2

t ((0,∞),L2(R2)) ≤ Cλ kFkL4(R2)kGkL4(R2).

kAϕ

The normalization of the Fourier transform we are using in this text is stated in formula
(2.1) at the beginning of Section 2. Note that the hypotheses of Theorem 3 are not invariant
under L1 normalized dilations of ϕ, even though the concluding estimate is. This allows us
to dilate ϕ appropriately and we will use this observation several times throughout the text,
both in the proof and in the applications of the theorem.

In order to aid readability it is worth rewriting the above estimate using more explicit

notation as

mXj=1

kAϕ

tj (F, G) − Aϕ

tj−1 (F, G)k2

L2(R2) ≤ C 2

λ kFk2

L4(R2)kGk2

L4(R2)

(1.4)

for any choice of positive numbers t0 < t1 < ··· < tm. We emphasize that the constant in
(1.4) does not depend on F , G, or tj. It is not diﬃcult to observe that (1.4) remains to hold
for an arbitrary Schwartz function ϕ, but then the constant depends on a few Schwartz norms
of ϕ; see Remark 8 in Section 2.

Note that Theorem 3 is sharp regarding the exponent 2 in the norm-variation on the left
hand side. The quantitative loss in Corollary 2 is due to the approximation of the rough
cutoﬀs by the smooth ones, as elaborated in Section 6.

Proof of Theorem 3 is presented in Sections 2–4 and it begins by splitting the jumps into the
“large ones” (i.e. those corresponding to the scales tj that are dyadic numbers 2k, k ∈ Z) and
the “short ones” (i.e. those corresponding to tj from a ﬁxed interval [2k, 2k+1]), as is usually

4

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

done with the pointwise variational estimates; for instance see [9] or [15]. The somewhat
standard transition to Theorem 1 and Corollary 2 is given in Sections 6 and 7.

In order to emphasize that Theorem 3 is already interesting from the analytic viewpoint
we choose tj = 2j in (1.4) and denote ψ(s) := ϕ(s) − 2ϕ(2s). Since there is no dependence of
the constant Cλ on the number of scales, as an immediate consequence we get a bound for a
two-dimensional bilinear square function

S(F, G)(x, y) :=(cid:18)Xj∈Z(cid:12)(cid:12)(cid:12)ZR

2(cid:19)1/2
F (x + s, y) G(x, y + s) 2−jψ(2−j s) ds(cid:12)(cid:12)(cid:12)

.

Corollary 4. For any F, G ∈ L4(R2) we have

kS(F, G)kL2(R2) ≤ CψkFkL4(R2)kGkL4(R2),

with a ﬁnite constant Cψ depending on ψ alone.

One only needs to observe that the integral in the deﬁnition of S(F, G)(x, y) equals

Aϕ
2j (F, G)(x, y) − Aϕ

2j−1(F, G)(x, y)

and apply the inequality (1.4).
Indeed, Proposition 7 stated in Section 2 will deal more
directly with this type of estimate, with an additional ﬂexibility that ψ(s) need not be of the
form ϕ(s)− 2ϕ(2s) for some ϕ. With a bit more eﬀort one can verify that Corollary 4 remains
true for an arbitrary mean zero Schwartz function ψ, but we do not strive for that kind of
generality here.

Corollary 4 is in a sharp contrast with the fact that no bounds are known for the corre-

sponding bilinear singular integral

T (F, G)(x, y) := p.v.ZR

F (x + s, y) G(x, y + s)

ds
s

,

which was introduced in [8] and later named the triangular Hilbert transform. Only par-
tial results in this direction exist; see [21] for a particular case when one of the functions
takes a special form, and the paper by Zorin-Kranich [31], where a nontrivial growth rate of
truncations of this singular integral and its higher-dimensional generalizations is obtained.

Moreover, for given f, g ∈ L4(R) let us take

F (x, y) := f (x − y)R−1/4ϑ(R−1y), G(x, y) := g(x − y)R−1/4ϑ(R−1x),

where R > 0 and ϑ is a smooth compactly supported nonnegative function on R that is
constantly 1 on the interval [−2, 2]. By substituting z = x − y, observing
dxdy

2

applying Corollary 4, and letting R → ∞ we recover the L4(R) × L4(R) → L2(R) estimate
for the one-dimensional bilinear square function

ZR2(cid:12)(cid:12)(cid:12)ZR
F (x + s, y) G(x, y + s) 2−jψ(2−j s) ds(cid:12)(cid:12)(cid:12)
≥Z R
−R(cid:12)(cid:12)(cid:12)ZR
f (z + s) g(z − s) 2−jψ(2−j s) ds(cid:12)(cid:12)(cid:12)
eS(f, g)(x) :=(cid:18)Xj∈Z(cid:12)(cid:12)(cid:12)ZR

f (x + s) g(x − s) 2−jψ(2−js) ds(cid:12)(cid:12)(cid:12)

dz,

2

2(cid:19)1/2

.

The only previously known proof of an Lp bound for eS employs wave-packet analysis, i.e. it

uses Khintchine’s inequality to reduce to an average of a family of bilinear singular integrals
parametrized by random signs and then recognizes these operators in the proof of boundedness
of the bilinear Hilbert transform [23],[24].

NORM-VARIATION OF ERGODIC AVERAGES

5

Somewhat related, there is an open problem stated in the introductory section of the paper

by Bernicot [3] to show Lp bounds for the bilinear square function

SΩ(f, g)(x) :=(cid:18)Xω∈Ω(cid:12)(cid:12)(cid:12)ZR

f (x + s) g(x − s) q

2(cid:19)1/2

1ω(s) ds(cid:12)(cid:12)(cid:12)

for an arbitrary collection of disjoint intervals Ω, which would be a bilinear variant of the
well-known result by Rubio de Francia [27]. Here 1ω denotes the characteristic function of the
interval ω and q
1ω is its inverse Fourier transform. Bernicot [3] has veriﬁed this conjecture for
a particular case of equidistant intervals of the same length, such as Ω = {[j, j + 1) : j ∈ Z}.
The problem becomes simpler if we replace 1ω with a smooth bump function adapted to ω,
as was already observed by Lacey [22] in the case of the intervals [j, j + 1), but the question
still remains open for arbitrary disjoint intervals. Several authors [4],[25],[26] have gradually
simpliﬁed the proof from [22] for the smooth truncations of [j, j + 1), also extending the range
of the exponents and removing the need for the wave packet decompositions for a certain

subrange of estimates. Let us observe that the above bilinear square function eS, bounded
as a byproduct of our considerations, can be thought of as being associated with smooth
truncations of the intervals Ω = {[2j , 2j+1) : j ∈ Z}. Also, the square function S from
Corollary 4 is its natural two-dimensional generalization. Therefore, one can hope that our
approach can also shed a new light on boundedness of various bilinear square functions, such
as those mentioned above.

2. Smooth averages, Long and short variations

In this section we split Theorem 3 into long and short variation estimates and show how

to deduce these from Propositions 5, 6, and 7 below.

For two non-negative quantities A and B we write A . B if there exists a constant C > 0
such that A ≤ CB. When we want to emphasize dependence of the constant on some
parameters p, q, . . ., we denote them in the subscript, i.e. we write .p,q,.... Occasionally we
may omit writing down parameters that are understood. We write A ∼ B if both A . B and
B . A are satisﬁed.
1 . By
S(Rd) we denote the class of all real-valued Schwartz functions on Rd. The Fourier transform
of an integrable function ϕ is deﬁned as

For a function ϕ on Rd and t > 0 we set ϕt(x) := t−dϕ(t−1x). Consequently, Aϕ

t = Aϕt

(2.1)

so the Fourier inversion formula takes form

ϕ(x)e−2πix·ξdx,

bϕ(ξ) :=ZRd
ϕ(x) =ZRd bϕ(ξ)e2πix·ξdξ

whenever ϕ,bϕ ∈ L1(R). Derivatives of a single-variable function ϕ will be denoted ϕ′, ϕ′′,

and generally Dnϕ, while will prefer ∂nϕ for the partial derivatives. Let us remark that we
reserve the notation ϕ(j), ϕ(j,k), etc. for the upper indices.

Density arguments reduce Theorem 3 (i.e. estimate (1.4) for a ﬁxed choice of tj) to the case
of Schwartz functions F and G, and ϕ. Moreover, by splitting into real and imaginary parts
and using Minkowski’s inequality, we may assume that F , G, and ϕ take only real values. By
homogeneity we may also normalize

kFkL4(R2) = kGkL4(R2) = 1.

(2.2)

We are going to show that if F , G, and ϕ are real-valued Schwartz functions respectively

satisfying (2.2) and (1.3) with some λ > 2, if bϕ is supported in [−1, 1], and if additionally bϕ

6

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

is constant on [−2−2, 2−2], then we have

kAϕ

2k (F, G)kV 2

k (Z,L2(R2)) .λ 1

and

NXi=−N

kAϕ

t (F, G)k2

t ([2i,2i+1],L2(R2)) .λ 1
V 2

for each N ∈ N, with a constant independent of N . By the standard separation into long and
near the origin. The general case will be deduced from this particular one, although then the
threshold λ > 2 rises to λ > 3.

short jumps (see [15]) these estimates imply Theorem 3 in the special case when bϕ is constant

The estimates (2.3) and (2.4) will be derived from the following three propositions.

Proposition 5. Let λ > 1 and let ϑ, ϕ ∈ S(R) be such that

|ϑ(s)| ≤ (1 + |s|)−λ,

|ϕ(s)| ≤ (1 + |s|)−λ

for all s ∈ R. Moreover, assume that bϑ is supported in [−2−4, 2−4], while bϕ is supported in

[−1, 1] and constant on [−2−2, 2−2]. Then for any m ∈ N, k0, . . . , km ∈ Z, and F, G ∈ S(R2)
normalized as in (2.2) we have

(2.3)

(2.4)

(2.5)

mXj=1ZR4

(cid:12)(cid:12)(cid:12)(cid:12)

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

ϑ2kj (u)(ϕ2kj − ϕ2kj−1 )(v) dxdydudv(cid:12)(cid:12)(cid:12)(cid:12) .λ 1.

Proposition 6. Let λ > 1 and let Φ be a Schwartz function on R2 such that

|Φ(u, v)| ≤ (1 + |u|)−λ(1 + |v|)−λ

NXj=−NZR4

Proposition 7. Let λ > 2 and let ψ ∈ S(R) be such that
|ψ(s)| ≤ (1 + |s|)−λ

for all (u, v) ∈ R2. Moreover, assume that 2−4 ≤ |ξ + η| ≤ 22 for all points (ξ, η) in the
support of bΦ. Then for any F, G ∈ S(R2) normalized as in (2.2) and for each N ∈ N we have
F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)Φ2j (u, v) dxdydudv(cid:12)(cid:12)(cid:12)(cid:12) .λ 1.
(cid:12)(cid:12)(cid:12)(cid:12)
for all s ∈ R. Moreover, assume that bψ is supported in [−2,−2−5] ∪ [2−5, 2]. Then for any
F, G ∈ S(R2) normalized as in (2.2) and for each N ∈ N we have
F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)ψ2j (u)ψ2j (v) dxdydudv(cid:12)(cid:12)(cid:12)(cid:12) .λ 1.
(cid:12)(cid:12)(cid:12)(cid:12)

Proposition 5 will treat the long jumps. Proposition 7 will handle the short jumps and also
some “badly” localized terms in the long variation estimate, while Proposition 6 will be a key
ingredient in its proof.

NXj=−NZR4

(2.6)

Note that the diﬀerence of ϕ’s in (2.5) does not satisfy any estimates of the type (2.6)
within an absolute constant since there is no control on kj − kj−1. However, the form in
Proposition 5 has better cancellation properties than the one in Proposition 7. The support
of its multiplier symbol does not intersect the antidiagonal η = −ξ, which is a property we
need in the proof. This is also the case in Proposition 6.

NORM-VARIATION OF ERGODIC AVERAGES

7

2.1. Deriving the estimate (2.3) from Propositions 5 and 7. Let λ, F , G, and ϕ be as
in the discussion preceding (2.3). Fix integers k0 < k1 < ··· < km and denote

V (F, G) :=

2kj (F, G) − Aϕ

mXj=1(cid:13)(cid:13)Aϕ

2kj−1 (F, G)(cid:13)(cid:13)2

L2(R2).

Expanding the L2 norm gives

V (F, G) =

mXj=1ZR4

We have the identity

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

(ϕ2kj − ϕ2kj−1 )(u)(ϕ2kj − ϕ2kj−1 )(v) dxdydudv.

(ϕ2kj − ϕ2kj−1 )(u)(ϕ2kj − ϕ2kj−1 )(v) = ϕ2kj−1 (u)ϕ2kj−1 (v) − ϕ2kj (u)ϕ2kj (v)

+ ϕ2kj (u)(ϕ2kj − ϕ2kj−1 )(v)
+ (ϕ2kj − ϕ2kj−1 )(u)ϕ2kj (v).

(2.7)

Summing (2.7) over j = 1, . . . , m, the ﬁrst term on the right hand-side telescopes into

ϕ2k0 (u)ϕ2k0 (v) − ϕ2km (u)ϕ2km (v).

Applying H¨older’s inequality in (x, y) for the exponents (4, 4, 4, 4) and using kϕkL1(R) .λ 1
we obtain

(cid:12)(cid:12)(cid:12)ZR4

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

(ϕ2k0 (u)ϕ2k0 (v) − ϕ2km (u)ϕ2km (v)) dxdydudv(cid:12)(cid:12)(cid:12) ≤ 2kFk2

By symmetry of the second and the third term on the right hand side of (2.7), it then suﬃces
to bound

L4(R2)kGk2

L4(R2)kϕk2

L1(R) .λ 1.

Λ(F, G) :=

mXj=1ZR4

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

ϕ2kj (u)(ϕ2kj − ϕ2kj−1 )(v) dxdydudv.

Now we localize the multiplier symbol associated with this form. Choose two smooth non-
negative even functions χ and ˜χ, supported in [−2−4, 2−4] and [−2,−2−5]∪[2−5, 2] respectively,
via their Fourier transforms by

such that χ + ˜χ = 1 on [−1, 1], and in particular also on the support of bϕ. Deﬁne ϑ and ˜ϑ

bϑ = bϕχ,

b˜ϑ = bϕ ˜χ

and write ϕ = ϑ + ˜ϑ. Using this decomposition we split Λ = Λϑ + Λ ˜ϑ, where

Λϑ(F, G) :=

mXj=1ZR4

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

ϑ2kj (u)(ϕ2kj − ϕ2kj−1 )(v) dxdydudv

and Λ ˜ϑ is deﬁned analogously. Since |ϑ(s)|,|ϕ(s)| . (1 + |s|)−λ, Proposition 5 gives

|Λϑ(F, G)| .λ 1.

(2.8)

Applying the Cauchy-Schwarz inequality in x, y, and j gives

where we have set

eΛ ˜ϑ(F, G) :=

=

mXj=1ZR2(cid:16)ZR
mXj=1ZR4

(2.9)

(2.10)

8

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

Rewrite Λ ˜ϑ by separating the functions in u and v as

Λ ˜ϑ(F, G) =

F (x + u, y)G(x, y + u) ˜ϑ2kj (u)du(cid:17)
F (x + v, y)G(x, y + v)(ϕ2kj − ϕ2kj−1 )(v)dv(cid:17) dxdy.

mXj=1ZR2(cid:16)ZR
(cid:16)ZR
|Λ ˜ϑ(F, G)| ≤eΛ ˜ϑ(F, G)1/2V (F, G)1/2,
F (x + u, y)G(x, y + u) ˜ϑ2kj (u) du(cid:17)2

dxdy

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v) ˜ϑ2kj (u) ˜ϑ2kj (v) dxdydudv.

Note that ˜ϑ is now separated from the diﬀerence ϕ2kj − ϕ2kj−1 of two functions at diﬀerent
scales. Moreover, up to increasing the quantity eΛ ˜ϑ(F, G) by adding nonnegative terms, we
may assume that kj = j and that the summation is taken over all integers j from a suﬃciently
large interval [−N, N ]. Since λ > 2 and | ˜ϑ(s)| . (1 + |s|)−λ, Proposition 7 implies

Inequalities (2.8), (2.9), and (2.10) together give a bootstrapping estimate

eΛ ˜ϑ(F, G) .λ 1.

V (F, G) .λ 1 + V (F, G)1/2.

This shows V (F, G) .λ 1 and hence establishes the bound (2.3).

ψ2i
t

ψ2i
t

(2.11)

kAϕ

tj−1(F, G)k2

kAϕ

t (F, G)k2

V 2

t ([2i,2i+1],L2(R2)) ≤Z 2

This inequality implies that the left hand-side of (2.4) can be estimated as

L2(R2) ≤ZR2(cid:16)Z 2
1 (cid:0)A
1 (cid:16) NXi=−NZR2(cid:0)A

2.2. Deriving the estimate (2.4) from Proposition 7. Let λ, F , G, and ϕ be as in the
discussion preceding (2.4). Deﬁne ψ(s) := (sϕ(s))′. We claim that whenever 2i ≤ t0 < ··· <
tm ≤ 2i+1, then one has
tj (F, G) − Aϕ

mXj=1
NXi=−N
NXi=−NZR4
Note that |ψ(s)| ≤ |ϕ(s)| + |sϕ′(s)| ≤ (1 + |s|)−λ. Since bψ(ξ) = −ξbϕ′(ξ) and bϕ is constant
on [−2−2, 2−2], we see that bψ vanishes outside [−1,−2−2] ∪ [2−2, 1]. Proposition 7 applied to

(F, G)(x, y)(cid:1)2dt(cid:17)dxdy.
(F, G)(x, y)(cid:1)2dxdy(cid:17)dt.

each ψt now implies boundedness of (2.12) uniformly in N ∈ N and t ∈ [1, 2], which in turn
establishes (2.4).
To prove the claim (2.11) it suﬃces to consider the particular case i = 0, since the left
hand-side is invariant under simultaneous replacements of tj by 2−itj and of ϕ by ϕ2i. Let

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v) ψ2it(u)ψ2it(v) dxdydudv.

Expanding the square on the right hand-side the integrand in t becomes

(2.12)

NORM-VARIATION OF ERGODIC AVERAGES

9

us denote Ij = [tj−1, tj) ⊆ [1, 2]. By the fundamental theorem of calculus in the t-variable we
have

ZR2(cid:0)Aϕ

tj (F, G)(x, y) − Aϕ

t (cid:17)2
t (F, G)(x, y)(cid:1) dt
By its deﬁnition, the function ψ satisﬁes t∂t(ϕt(s)) = −ψt(s) and hence t∂t(Aϕ
−Aψ
t2(cid:17) dxdy.

tj−1 (F, G)(x, y)(cid:1)2 dxdy =ZR2(cid:16)ZIj
dxdy ≤ZR2 |Ij|(cid:16)ZIj(cid:0)Aψ

t (F, G). Using the Cauchy-Schwarz inequality we bound the last display as

t (F, G)(x, y)(cid:1)2 dt

ZR2(cid:16)ZIj

t ∂t(cid:0)Aϕ

t (cid:17)2

dt

Aψ

t (F, G)(x, y)

dxdy.

t (F, G)) =

Summing over j = 1, . . . , m, using t ≥ 1, |Ij| ≤ 1, and disjointness of Ij, we obtain (2.11).
2.3. Deriving Theorem 3. In this subsection we deduce Theorem 3 from its special case

for all λ > 2.

when bϕ is constant on [−2−2, 2−2], which was established in the previous subsections, even
thatbθ is supported in [−1, 1], constantly equal to 1 on [−2−1, 2−1], and monotone on [2−1, 1).

Let ϕ ∈ S(R) be a function that satisﬁes the inequality (1.3) with some λ > 3 and has its
frequency support contained in [−1, 1]. Take an even real-valued Schwartz function θ such
Then

(2.13)

for each ξ 6= 0, so we can write (formally at ﬁrst)

Xk∈Z(cid:0)bθ(2kξ) −bθ(2k+1ξ)(cid:1) = 1
∞Xk=−1
where c0 := bϕ(0) =RR ϕ and ρ(k) ∈ S(R) are determined from

ϕ = c0θ + (ϕ − c0θ) = c0θ +

dρ(k)(ξ) =(cid:0)bϕ(ξ) − c0bθ(ξ)(cid:1)(cid:0)bθ(2kξ) −bθ(2k+1ξ)(cid:1).

ρ(k),

(2.14)

Observe that the summation is taken over k ≥ −1 only, since other summands would vanish
due to disjoint supports of the two factors above. By the Plancherel identity the series in
(2.14) converges in the L2(R) norm. By passing to a subsequence of partial sums, we can ﬁnd
positive integers K1 < K2 < ··· such that

ϕ(s) = c0θ(s) + lim
n→∞

ρ(k)(s)

(2.15)

KnXk=−1

holds at a.e. point s ∈ R.
We proceed by bounding norm-variation of bilinear averages corresponding to individual
terms in the expansion (2.15). For the part associated with c0θ boundedness follows from the
special case mentioned above; since |c0| .λ 1 gives

we have indeed

|c0θ(s)| + |sc0θ′(s)| .θ,λ (1 + |s|)−λ,

kAc0θ

t

(F, G)kV 2

t ((0,∞),L2(R2)) .θ,λ 1.

2−k in the variational estimate for Aρ(k)

For the part associated with ρ(k) observe that by the scaling invariance we may replace ρ(k)
with ρ(k)
2−k is supported
in [−1,−2−2] ∪ [2−2, 1], so in particular it is constant on [−2−2, 2−2]. Denote ψ := ϕ − c0θ,
ϑ := θ − θ2, and observe that ψ has integral zero and satisﬁes
|ψ(s)| + |sψ′(s)| .θ,λ (1 + |s|)−λ.

. The Fourier transform of ρ(k)

t

(2.16)

10

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

s ψ(u)du decays as

(2.17)

(2.18)
2−k = ψ2−k ∗ ϑ. Integrating

The primitive function of ψ deﬁned by Ψ(s) :=R s

|Ψ(s)| .θ,λ (1 + |s|)−λ+1.

−∞ ψ(u)du = −R ∞
2−k(cid:1)′(s)(cid:12)(cid:12) .θ,λ 2−k(1 + |s|)−λ+1.

We claim that

and

ρ(k)

2kψ(2ku)ϑ(s − u)du =ZR

We begin with the ﬁrst term on the left hand side. Note that ρ(k)
by parts we obtain

(cid:12)(cid:12)ρ(k)
2−k (s)(cid:12)(cid:12) +(cid:12)(cid:12)s(cid:0)ρ(k)
2−k (s) =ZR
2−k (s)(cid:12)(cid:12)
(1 + |s|)λ−1(cid:12)(cid:12)ρ(k)
.λZR |u|λ−1 |Ψ(2ku)||ϑ′(s − u)| du +ZR |Ψ(2ku)| (1 + |s − u|)λ−1 |ϑ′(s − u)| du.
2−(λ−1)kZR |2ku|λ−1 |Ψ(2ku)||ϑ′(s − u)| du .θ,λ 2−(λ−1)kkϑ′kL1(R) .θ 2−(λ−1)k,

The ﬁrst term in (2.19) can be estimated using (2.17) by

Ψ(2ku)ϑ′(s − u)du

while the second term is estimated using (2.17) again and λ > 2 by

(2.19)

2−kkΨkL1(R) max

s∈R (cid:0)(1 + |s|)λ−1|ϑ′(s)|(cid:1) .θ,λ 2−k.

This controls the ﬁrst term on the left hand side of (2.18). For the second term we note

2kψ(2ku)(s − u)ϑ′(s − u)du +ZR

2−k(cid:1)′(s) =ZR
s(cid:0)ρ(k)
Ψ(2ku)(cid:0)ϑ′(s − u) + (s − u)ϑ′′(s − u)(cid:1)du +ZReΨ(2ku)ϑ′(s − u)du.
=ZR

2ku ψ(2ku)ϑ′(s − u)du

Here we have set eΨ(s) := sψ(s) which has the analogous decay as Ψ:

(cid:12)(cid:12)eΨ(s)(cid:12)(cid:12) .θ,λ (1 + |s|)−λ+1.

The estimate of the second term on the left hand side of (2.18) then proceeds analogously to
the ﬁrst term, combining (2.20) with both (2.17) and (2.21).

From (2.18) and the established special case of the theorem (scaled by the factor 2−k and

(2.20)

(2.21)

(2.22)

with λ replaced by λ − 1) we get

Finally, we can combine (2.15), (2.16), (2.22), Minkowski’s inequality, and Fatou’s lemma to
obtain

t

(cid:13)(cid:13)Aρ(k)

(F, G)(cid:13)(cid:13)V 2

t ((0,∞),L2(R2)) .θ,λ 2−k.

kAϕ

t (F, G)kV 2

t ((0,∞),L2(R2)) .θ,λ 1 +

so it remains to sum a convergent geometric series.

Remark 8. The estimate

2−k,

∞Xk=−1

kAϕ

t (F, G)kV 2

t ((0,∞),L2(R2)) ≤ Cϕ kFkL4(R2)kGkL4(R2)

holds for an arbitrary Schwartz function ϕ, with a constant Cϕ depending on ϕ alone.

Remark 8 can be derived from Theorem 3 in an entirely standard way, by partitioning the

frequency support. Indeed, the constant Cϕ only depends on a few Schwartz norms of ϕ.

unity as in (2.13) and using the rapid decay of bϕ in order to reduce to the case of compact

NORM-VARIATION OF ERGODIC AVERAGES

11

3. Proof of Proposition 5

Let us rewrite the form (2.5) from Proposition 5 in a more convenient way. Denote ψ(x) =

ϕ(x) − 2−1ϕ(2−1x). Then we have the telescoping identity

ϕ2kj−1 − ϕ2kj =

We insert (3.1) into (2.5) and substitute

kj−1Xl=kj−1

ψ2l.

(3.1)

x′ = x + y + u,

y′ = x + y + v,

˜F (y, x′) := F (x′ − y, y),

˜G(x, x′) := G(x, x′ − x).

Note that we still have k ˜FkL4(R2) = k ˜GkL4(R2) = 1. Omitting the tildas for notational
simplicity, it then suﬃces to show the inequality

mXj=1

kj −1Xl=kj−1ZR4

(cid:12)(cid:12)(cid:12)(cid:12)

F (y, x′)G(x, x′)F (y, y′)G(x, y′)

ϑ2kj (x′ − x − y)ψ2l(y′ − x − y) dxdydx′dy′(cid:12)(cid:12)(cid:12)(cid:12) . 1.

First, we would like to rewrite the kernel as a superposition of elementary tensors in the

four variables x, y, x′, y′. Using the Fourier inversion formula we write

ϑ2kj (x′ − x − y)ψ2l(y′ − x − y) =ZR2bϑ(2kj ξ)bψ(2lη)e2πiξ(x′−x−y)e2πiη(y′ −x−y)dξdη.

Let θ be a function as in (2.13) and the discussion preceding it and also such that there

2l(ξ + η) = 2l−kj 2kj ξ + 2lη ∈ [−2,−2−4] ∪ [2−4, 2].

Since bϕ is supported in [−1, 1] and constant on [−2−2, 2−2], the function bψ is supported in
[−1,−2−3] ∪ [2−3, 1]. If 2kj ξ ∈ supp(bϑ) and 2lη ∈ supp(bψ), then
exists a smooth nonnegative even functionbω, being the Fourier transform of some ω ∈ S(R),
The functionbω is supported in [−23,−2−5]∪ [2−5, 23] and equal to 1 on [−22,−2−4]∪ [2−4, 22].
For each (ξ, η) ∈ R2 we have

bω(ξ)2 =bθ(2−3ξ) −bθ(24ξ).

satisfying

(3.2)

bϑ(2kj ξ)bψ(2lη) = bϑ(2kj ξ)bψ(2lη)bω(2l(ξ + η))2

ϑ2kj (x′ − x − y)ψ2l(y′ − x − y)

=ZR2bϑ(2kj ξ)e2πix′ξbψ(2lη)e2πiy′ηbω(2l(−ξ − η))e2πix(−ξ−η)bω(2l(−ξ − η))e2πiy(−ξ−η)dξdη.

The last expression can be viewed as the integral of the Fourier transform of the function

H(x1, x2, x3, x4) := ϑ2kj (x1 + x′)ψ2l(x2 + y′)ω2l(x3 + x)ω2l(x4 + y)

and hence

over the hyperplane

{(ξ, η,−ξ − η,−ξ − η) : ξ, η ∈ R}.

It equals the integral of H itself over the perpendicular hyperplane

{(p + q, p + q, p, q) : p, q ∈ R}.
Therefore, ϑ2kj (x′ − x − y)ψ2l(y′ − x − y) can be written as

ZR2

ϑ2kj (x′ − p − q)ψ2l(y′ − p − q)ω2l(x − p)ω2l(y − q) dpdq

12

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

and the object we need to bound is

kj −1Xl=kj−1ZR6

F (y, x′)G(x, x′)F (y, y′)G(x, y′)

mXj=1
ϑ2kj (x′ − p − q)ψ2l(y′ − p − q)ω2l(x − p)ω2l(y − q) dxdydx′dy′dpdq.

(3.3)

In order to estimate this form we adapt the arguments from [18] to the Euclidean setting.
First we apply the Cauchy-Schwarz inequality, which will reduce the complexity of the form.
To preserve the mean zero property of ω we rewrite (3.3) as

mXj=1

kj−1Xl=kj−1ZR4(cid:16)ZR

F (y, x′)F (y, y′)ω2l(y − q) dy(cid:17)(cid:16)ZR

G(x, x′)G(x, y′)ω2l(x − p) dx(cid:17)
ϑ2kj (x′ − p − q)ψ2l(y′ − p − q) dx′dy′dpdq.

Taking absolute values, using the triangle inequality, and applying the Cauchy-Schwarz in-
equality in the variables x′, y′, p, q, and t, we bound this expression by

Γ(F )1/2Γ(G)1/2,

(3.4)

where we have denoted

Γ(F ) :=

mXj=1

kj−1Xl=kj−1ZR4(cid:16)ZR

F (y, x′)F (y, y′)ω2l(y − q)dy(cid:17)2
|ϑ|2kj (x′ − p − q)|ψ|2l (y′ − p − q) dx′dy′dpdq.

The two appearances of the function ω have been separated, which allows us to change
variables p → p − q. Integrating in p, using l ≤ kj and the normalization of ϑ and ϕ, we get
(3.5)

ZR |ϑ|2kj (x′ − p)|ψ|2l (y′ − p)dp .λ 2−kj (1 + 2−kj|x′ − y′|)−λ.

This fact can be shown along the lines of [29, Lemma 2.1]. For completeness and to keep
track of the constants we now give a detailed proof.

If |x′ − y′| ≤ 2kj+1/(λ − 1), then we can bound the left hand-side of (3.5) by
kϑ2kjkL∞(R)kψ2lkL1(R) .λ kϑkL∞(R)kψkL1(R)2−kj (1 + 2−kj|x′ − y′|)−λ.
−∞ +R ∞
kϑkL1(R)2−l(1 + 2−l|y′ − c|)−λ + 2−kj (1 + 2−kj|x′ − c|)−λkψkL1(R).

If |x′ − y′| ≥ 2kj +1/(λ− 1), then let us denote by c the midpoint of x′ and y′. Without loss of
generality we may assume x′ < c < y′. We split the integral asRR =R c
and estimate
it by
Since |x′ − c| = |y′ − c| = |x′ − y′|/2, l ≤ kj,

(3.6)

c

2−l−1|x′ − y′| ≥ 2−kj−1|x′ − y′| ≥ (λ − 1)−1,

and the function s 7→ s(1 + s)−λ is decreasing on the interval [(λ − 1)−1,∞), the expression
(3.6) is at most

(kϑkL1(R) + kψkL1(R)) 2−kj (1 + 2−kj −1|x′ − y′|)−λ.

It remains to note kϑkL∞(R) ≤ 1, kϑkL1(R) .λ 1, and kψkL1(R) .λ 1, which shows the claim.
Our inequality did not preserve the tensor structure in the variables x′ and y′ which will
be needed later in (3.13). For that purpose we further estimate (3.5) by a superposition of
Gaussians as it was done in [11]. Denote

g(s) := e−πs2

gα(s)α−λdα,

(3.7)

and σ(s) :=Z ∞

1

NORM-VARIATION OF ERGODIC AVERAGES

13

where gα(s) = α−1g(α−1s), as before. Observe that σ(0) = (λ − 1)−1 and the change of
variables β = |s|/α gives

|s|→∞|s|λσ(s) =Z ∞

lim

βλ−1e−πβ2

dβ ∈ (0,∞),

0

so σ(s) is comparable to |s|−λ for large |s|. Therefore, using

(3.8)
we can dominate the right hand-side of (3.5) up to a positive constant by σ2kj (x′ − y′). This
in turn controls

(1 + |s|)−λ .λ σ(s)

Γ(F ) .λZ ∞

1 (cid:16) mXj=1

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

kj−1Xl=kj−1ZR5
gα2kj (x′ − y′)ω2l(x − q)ω2l(y − q) dxdydx′dy′dq(cid:17)α−λdα.

i=−3(cid:0)bθ(2iξ) −bθ(2i+1ξ)(cid:1) we obtain
Integrating in q, summing in l, and using bω(ξ)2 =P3
3Xi=−3

(θ2kj−1+i − θ2kj +i)(x − y).

ω2l(x − q)ω2l(y − q) dq =

Inserting this into (3.9), the integrand in α can be rewritten as

(3.9)

kj −1Xl=kj−1ZR
mXj=1ZR4
3Xi=−3

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

gα2kj (x′ − y′)(θ2kj−1+i − θ2kj +i)(x − y) dxdydx′dy′.

It suﬃces to prove an estimate uniform in α for each summand corresponding to a ﬁxed i and
then simply integrate in α and sum over −3 ≤ i ≤ 3. For two functions ˜ρ, ρ ∈ S(R) deﬁne

Θ˜ρ,ρ(F ) :=

mXj=1ZR4

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

˜ρ2kj (x′ − y′)(ρ2kj−1 − ρ2kj )(x − y) dxdydx′dy′.

The needed estimate is a direct consequence of the following lemma applied with ρ = θ2i.
Lemma 9. For any F ∈ S(R2) and ρ ∈ S(R) we have
Θgα,ρ(F ) .ρ kFk4

L4(R2),

(3.10)

where g(s) = e−πs2

.

Proof. Once again we normalize F as in (2.2). The ﬁrst step is an application of the telescoping
identity. If we denote

mXj=1ZR4

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

(˜ρ2kj −1 − ˜ρ2kj )(x′ − y′)ρ2kj−1 (x − y) dxdydx′dy′

and for t > 0 deﬁne the single-scale quantity

F (y, x′)F (x, x′)F (y, y′)F (x, y′)˜ρt(x′ − y′)ρt(x − y) dxdydx′dy′,

eΘ˜ρ,ρ(F ) :=
Ξ˜ρ,ρ,t(F ) :=ZR4

14

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

then we have

Θ˜ρ,ρ(F ) +eΘ˜ρ,ρ(F ) = Ξ˜ρ,ρ,2k0 (F ) − Ξ˜ρ,ρ,2km (F ),

Ξ˜ρ,ρ,t(F ) ≤ k˜ρkL1(R)kρkL1(R).

(3.11)

(3.12)

The identity (3.11) follows by a summation by parts: all intermediate terms cancel. To see
(3.12) we substitute u = x′ − y′, v = x − y, rewrite Ξ˜ρ,ρ,t(F ) as

ZR2(cid:16)ZR2

F (x − v, x′)F (x, x′)F (x − v, x′ − u)F (x, x′ − u) dxdx′(cid:17) ˜ρt(u)ρt(v) dudv,

and apply H¨older’s inequality in (x, x′) for the exponents (4, 4, 4, 4).

In order to show (3.10) we ﬁrst use (3.11), which gives

Θgα,ρ(F ) = Ξgα,ρ,2k0 (F ) − Ξgα,ρ,2km (F ) −eΘgα,ρ(F ),

and hence applying (3.12) we get

|Θgα,ρ(F )| ≤ |Ξgα,ρ,2k0 (F )| + |Ξgα,ρ,2km (F )| + |eΘgα,ρ(F )| .ρ 1 +(cid:12)(cid:12)eΘgα,ρ(F )(cid:12)(cid:12).

Therefore, it remains to estimate(cid:12)(cid:12)eΘgα,ρ(F )(cid:12)(cid:12).
By the fundamental theorem of calculus we rewrite eΘgα,ρ(F ) as

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

mXj=1Z 2kj

2kj−1ZR4

eΘgα,ρ(F ) =

(cid:0) − t∂t(gαt(x′ − y′))(cid:1)ρ2kj−1 (x − y) dxdydx′dy′ dt

t

.

For h(x) :=p2/πg′(√2x) we have −t∂t(cgαt(ξ)) = |chαt(ξ)|2 and hence
By this identity and the symmetry of eΘgα,ρ, which results from four repetitions of the function
F , we can express eΘgα,ρ(F ) as

− t∂t(gαt(x′ − y′)) =ZR

hαt(x′ − p)hαt(y′ − p)dp.

(3.13)

(3.14)

ρ2kj−1 (x − y) dxdydp

dt
t

.

mXj=1Z 2kj

2kj−1ZR3(cid:16)ZR

F (y, x′)F (x, x′)hαt(x′ − p)dx′(cid:17)2

Observe that the square in (3.14) is automatically non-negative, but the function ρ is not
non-negative in general. To obtain positivity and an elementary tensor structure in x and y
as in (3.13) we dominate |ρ| . σ by applying (3.8) as before, where σ is the superposition of
the Gaussians (3.7). This implies

We apply the telescoping identity (3.11) once more to get

(cid:12)(cid:12)eΘgα,ρ(F )(cid:12)(cid:12) .ρZ ∞

1

eΘgα,gβ (F )β−λdβ.

eΘgα,gβ (F ) = Ξgα,gβ,2k0 (F ) − Ξgα,gβ,2km (F ) − Θgα,gβ (F ).

Now that we have reduced to Gaussian functions only, we have non-negativity of both

Θgα,gβ (F ) and eΘgα,gβ (F ). This can be seen by the fundamental theorem of calculus and
the equality (3.13), which allow us to write Θgα,gβ (F ) and eΘgα,gβ (F ) in the same way as we

did with the form in (3.14). Therefore, by (3.12) once again,

This ﬁnishes the proof of Lemma 9.

eΘgα,gβ (F ) ≤ Ξgα,gβ,2k0 (F ) − Ξgα,gβ,2km (F ) ≤ 2kgk2

L1(R) . 1.

(cid:3)

NORM-VARIATION OF ERGODIC AVERAGES

15

4. Proof of Proposition 6

Our aim is to reduce the proposition to Lemma 9 from the previous section. Let θ and

ω be functions as in Section 3. Then bω equals 1 on {ξ + η : (ξ, η) ∈ supp(bΦ)}, so for each

(ξ, η) ∈ R2 we can write

similarly as in (3.2). Choosing the same substitution as in Section 3 and performing the
analogous steps from (3.2) to (3.4) with kj and l being replaced by j, it remains to estimate
an analogous quantity to Γ(F ),

bΦ(ξ, η) =bΦ(ξ, η)bω(ξ + η)2,

NXj=−NZR6

F (y, x′)F (x, x′)F (y, y′)F (x, y′)

|Φ|2j (x′ − p, y′ − p)ω2j (x − q)ω2j (y − q) dxdydx′dy′dpdq.

Using the decay assumption on Φ we obtain

ZR |Φ|(x′ − p, y′ − p) dp ≤ZR

(1 + |x′ − p|)−λ(1 + |y′ − p|)−λdp .λ (1 + |x′ − y′|)−λ,

where the second inequality follows as in (3.5). Estimating the right hand-side as in (3.8) by
the superposition σ deﬁned in (3.7) and proceeding as we did with (3.9), it then suﬃces to
bound

NXj=−NZR4

F (y, x′)F (x, x′)F (y, y′)F (x, y′)gα2j (x′ − y′)(θ2j+i − θ2j+i+1)(x − y) dxdydx′dy′

uniformly in α ∈ (0,∞) and for each ﬁxed i ∈ {−3, . . . , 3}. Such a bound follows from the
particular case of Lemma 9 when ˜ρ = gα, ρ = θ2i+1, and kj = j.

5. Proof of Proposition 7

We would like to decompose the kernel from Proposition 7 into elementary tensors anal-
ogous to Section 3. Then we can bound this form by the Cauchy-Schwarz inequality and
iterations of the telescoping identity and positivity arguments. However, the multiplier sup-
port now intersects the axis η = −ξ, so a desired decomposition is not readily available.
To overcome this issue, the idea is to transfer to the multiplier with the symbol (5.8) below,
which is homogeneous, i.e. constant on the rays through the origin, and even (i.e. symmetric)
with respect to the line η = −ξ. Since the form with a constant multiplier is bounded, we can
then subtract the constant on η = −ξ from the homogeneous multiplier. This leaves us with a
function vanishing of second order on that axis. By an angular lacunary decomposition with
respect to η = −ξ we reduce to consider a single angular region, to which the arguments from
Section 3 may be applied. Due to vanishing of second order along η = −ξ we recover enough
decay to be summable over all angles.

Deﬁne φ(ξ, η) := c(cid:0)bθ(|(ξ, η)|) −bθ(2|(ξ, η)|)(cid:1), where θ is as in (2.13) and the discussion

preceding it, while c > 0 is the normalization constant chosen such that

φ(t(ξ, η))

= 1

(5.1)

Z ∞

0

dt
t

for all (ξ, η) 6= (0, 0). Then we denote

M (ξ, η) :=

NXj=−N bψ(2jξ)bψ(2jη)

16

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

and for each t > 0 set M (t)(ξ, η) := M (t−1(ξ, η))φ(ξ, η), so that

M (ξ, η) =Z ∞

0

M (ξ, η)φ(t(ξ, η))

dt
t

M (t)(t(ξ, η))

dt
t

.

(5.2)

=Z ∞

0

Observe that the support of M (t)(ξ, η) lies in the intersection of the annulus 2−2 ≤ |(ξ, η)| ≤ 1
with the quadruple cone 2−6 ≤ |η/ξ| ≤ 26, which in turn is contained in the Cartesian product
(5.3)
Let bϑ be a real even function (the Fourier transform of some ϑ ∈ S(R)) supported in
[−2,−2−10] ∪ [2−10, 2] and such that bϑ ⊗ bϑ equals 1 on the set (5.3) and thus also on the

([−1,−2−9] ∪ [2−9, 1])2.

support of each M (t). Then

implies

M (t)(ξ, η) = M (t)(ξ, η)bϑ(ξ)bϑ(η)

~

M (t)(a, b)ϑ(u − a)ϑ(v − b) dadb,

~

M (t)(u, v) =ZR2

(5.4)

where qϕ denotes the inverse Fourier transform of ϕ. The form from Proposition 7 is associated
with the kernel |M . Using (5.2) and (5.4) it can be rewritten as

ZR2Z ∞

0

~

M (t)(a, b)ZR4

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

(Taϑ)t(u)(Tbϑ)t(v) dxdydudv

dt
t

dadb,

(5.5)

where we denote Taϑ(s) := ϑ(s − a). Observe that

~

M (t)(a, b) =Xj ZR2

ψ2j /t(a − x)ψ2j /t(b − y) qφ(x, y) dxdy

and that by the support conditions on bψ and φ the sum is taken only over −N ≤ j ≤ N
that also satisfy 2−4 < 2j/t < 25. We have 2i ≤ t < 2i+1 for some i ∈ Z and hence
2−4+i ≤ 2j < 26+i. So there are at most ten non-zero summands for each ﬁxed t. From the
assumption (2.6) it then follows that

M (t)(a, b)(cid:12)(cid:12) .λZR2
(cid:12)(cid:12)~
≤ZR2
.φ (1 + |a|)−λ(1 + |b|)−λ.
(1 + |a|)−λ(1 + |b|)−λZ ∞
0 ZR2
I(x, y, a, t) :=ZR

ZR2

Hence we can bound (5.5) by

where we have set

(1 + |a − x|)−λ(1 + |b − y|)−λ| qφ(x, y)| dxdy
(1 + |a|)−λ(1 + |b|)−λ(1 + |x|)λ(1 + |y|)λ| qφ(x, y)| dxdy

(5.6)

dt
t

dadb,

I(x, y, a, t)I(x, y, b, t) dxdy

F (x + s, y)G(x, y + s)(Taϑ)t(s)ds.

Now we apply the Cauchy-Schwarz inequality in x, y, t and observe that the integrals in a and
b separate, so (5.5) is controlled by

(cid:18)ZR

(1 + |a|)−λ(cid:16)Z ∞
0 ZR2

I(x, y, a, t)2 dxdy

dt

t (cid:17)1/2

da(cid:19)2

.

NORM-VARIATION OF ERGODIC AVERAGES

17

Write (1 +|a|)−λ = (1 +|a|)−(1+ν)/2(1 +|a|)−(3+3ν)/2, where ν = (λ − 2)/2 > 0 and apply the
Cauchy-Schwarz inequality in a. Since (1 + |a|)−(1+ν) is integrable, we are left to consider

ZR

(1 + |a|)−3(1+ν)Z ∞
0 ZR2

I(x, y, a, t)2 dxdy

da,

dt
t

which equals

ZR

(1 + |a|)−3(1+ν)Z ∞
0 ZR4

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)

(Taϑ)t(u)(Taϑ)t(v) dxdydudv

dt
t

da.

Observe that this form is associated with the multiplier symbol

(5.7)

(5.8)

M(ξ, η) :=Z ∞

0

bϑ(tξ)bϑ(tη)bρ(t(ξ + η))

dt
t

,

where we have denoted ρ(s) := (1 + |s|)−3(1+ν). The function M is even since bρ is even.

Moreover, M(ξ, η) = M(−η,−ξ) and M is constant on any line through the origin, i.e.
M(ξ, η) = M(1, η/ξ). In particular, M(ξ,−ξ) = M(1,−1) for any 0 6= ξ ∈ R.

Writing M0(ξ, η) := M(ξ, η) − M(1,−1) we have

M(ξ, η) = M0(ξ, η) + M(1,−1)

and we split the form (5.7) into the two corresponding parts. The part associated with the
constant multiplier yields M(1,−1) times

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v)δ(0,0)(u, v) dxdydudv

ZR4

=ZR4

F (x, y)2G(x, y)2 dxdy ≤ kFk2

L4(R2)kGk2

L4(R2) = 1,

where δ(0,0) denotes the Dirac measure concentrated at the origin. Thus, our remaining task
is to estimate the form associated with the symbol M0.
Since M0 is now supported on the whole R2, we split it into two parts: one supported
on a double cone around the η = ξ axis and one on a double cone around the η = −ξ axis.
Namely, for each (ξ, η) 6= (0, 0) we write

M0(ξ, η) =M0,+(ξ, η) + M0,−(ξ, η),

M0,+(ξ, η) :=M0(ξ, η)(cid:0)f1(η/ξ) + f2(ξ/η)(cid:1),

M0,−(ξ, η) :=M0(ξ, η)f3(η/ξ),

where f1, f2, f3 are smooth nonnegative functions with f1, f2 supported on [−2−2, 22], f3
supported on [−23,−2−3], and f3 ≡ 1 on [−22,−2−2]. Note that M0,+ and M0,− can be
extended smoothly across (ξ, 0) and (0, η) for ξ, η 6= 0.

To treat M0,+ we write it as

M0,+(ξ, η) =Xk∈Z

M(k)

0,+(2k(ξ, η)),

where M(k)

0,+(ξ, η) := M0,+(2−k(ξ, η)) c−1φ(ξ, η) and φ is as in (5.1). We claim that

­

M(k)
|

(5.9)
with the implicit constant independent of k ∈ Z. Let us write h(ξ, η) := f1(η/ξ) + f2(ξ/η)
and note that by homogeneity M(2−k(ξ, η)) = M(ξ, η). The estimate (5.9) is then shown by

0,+(u, v)| .ν,φ (1 + |u|)−1−ν (1 + |v|)−1−ν ,

18

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

bounding the inverse Fourier transform of

(cid:16)ZR

ρ(a)Z ∞

0

bϑ(tξ)e−2πitξabϑ(tη)e−2πitηa dt

t

via a calculation similar to (5.6), using

da − M(1,−1)(cid:17)h(η/ξ)φ(ξ, η)

|ϑ(u − a)| .ϑ (1 + |u|)−1−ν (1 + |a|)1+ν

and RR(1 + |a|)2+2ν ρ(a)da < ∞. Note that by the support localization of hφ we only need

to consider t in some bounded range. Boundedness of the form associated with M0,+ now
follows from Proposition 6.
The remaining issue is to deal with M0,−, which is supported on a double cone around the

antidiagonal η = −ξ. Recall that the multiplier now takes the form

If we set m(κ) := M0,−(1, κ), then by the homogeneity we have

M0,−(ξ, η) =(cid:16)Z ∞

0

dt

t − M(1,−1)(cid:17)f3(η/ξ).

bϑ(tξ)bϑ(tη)bρ(t(ξ + η))

M0,−(ξ, η) = m(η/ξ).

To avoid the problematic axis we perform a lacunary decomposition with respect to η = −ξ.
Due to homogeneity of the multiplier we chose to do this in the angular variable. Denote

ζ(κ) := (bθ(κ) −bθ(2κ))1(0,∞)(κ), with θ as before. For ξ, η 6= 0 write

m(η/ξ)ζ(2j (η/ξ + 1)) +

M0,−(ξ, η) =

∞Xj=0

∞Xj=0

m(η/ξ)ζ(2j (ξ/η + 1)).

(5.10)

By symmetry it suﬃces to consider the ﬁrst term only and we may also assume that ξ > 0 > η,
i.e. we work in the “upper half” of the fourth quadrant.

To be able to apply Proposition 6 we further decompose the summand corresponding to a
ﬁxed j in the direction ξ − η. This decomposition needs to be adapted to the width of the
cone to have good control over the derivatives. Fix a smooth increasing function γ such that
γ(κ) = 0 for κ ≤ 0 and γ(κ) = 1 for κ ≥ 1. Deﬁne ϑ(j) by

ϑ(j)(κ) := γ(2(2j − κ))1(0,∞)(κ).

The function ϑ(j) is supported in [0, 2j ], equal to 1 on [0, 2j − 2−1] and

Assuming ξ > η we decompose the ﬁrst term in (5.10) further as

2j −1Xl=0

ϑ(j)(2l2−j +kκ) − ϑ(j)(2(l+1)2−j +kκ) = 1(0,∞)(κ).

Xk∈Z
m(η/ξ)ζ(2j (η/ξ + 1))(cid:16)ϑ(j)(2l2−j +k(ξ − η)) − ϑ(j)(2(l+1)2−j +k(ξ − η))(cid:17).
(ξ − η))(cid:17).

2j −1Xl=0 Xk∈Z
∞Xj=0
m(j,l)(ξ, η) := m(η/ξ)ζ(2j (η/ξ + 1))(cid:16)ϑ(j)(2l2−j
2j −1Xl=0 Xk∈ZZR4
∞Xj=0

F (x + u, y)G(x, y + u)F (x + v, y)G(x, y + v) qm(j,l)

(ξ − η)) − ϑ(j)(2(l+1)2−j

2k (u, v) dxdydudv.

Let us denote the term for ﬁxed j, l and for k = 0 by

The object which we need to bound reads

We claim that for all (u, v) ∈ R2, j ≥ 0, and l = 0, . . . , 2j − 1 we have

(cid:12)(cid:12) qm(j,l)(u, v)(cid:12)(cid:12) .ν 2−2j(1 + |u|)−1−ν (1 + |v|)−1−ν ,

(5.11)

NORM-VARIATION OF ERGODIC AVERAGES

19

l=0 2−2j < ∞.

with the implicit constant independent of j and l. Once this is shown, the bound for a form
corresponding to a ﬁxed j and l follows by Proposition 6. In the end it remains to sum a

In order to verify the claim (5.11) assume that |u| ≥ |v| and write

j=0P2j −1
m(j,l)(ξ, η)e2πi(uξ+vη)dξdη = −(2πu)−2ZR2

geometric series,P∞
qm(j,l)(u, v) =ZR2
The second equality is obtained by integration by parts in the ξ-variable. By a change of
variables ξ → ξ − (2u)−1 and averaging two equal expressions we see that the last display
equals

∂2
ξ m(j,l)(ξ, η)e2πi(uξ+vη)dξdη.

−2−1(2πu)−2ZR2(cid:0)∂2

ξ m(j,l)(ξ, η) − ∂2

ξ m(j,l)(ξ − (2u)−1, η)(cid:1)e2πi(uξ+vη)dξdη.

The partial derivative ∂2

ξ m(j,l) satisﬁes the H¨older condition

ξ m(j,l)(ξ − (2u)−1, η)(cid:12)(cid:12) .ν 2−2j|u|−2ν ,

(5.12)

ξ m(j,l)(ξ, η) − ∂2

(cid:12)(cid:12)∂2

which can be seen using the following observations and this is where we use thatbρ′′ is H¨older

continuous with exponent 2ν. First, to compute ∂2
α = (α1, α2), a function g ∈ C |α|(R), τ ≥ 0, and s > 0 we have

ξ m(j,l) we observe that for a multi-index

∂α1
ξ ∂α2

η (cid:0)g(s(η/ξ + τ ))(cid:1) =

cl sl+α2 (Dl+α2g)(s(η/ξ + τ ))(η/ξ)l(1/ξ)|α|,

α1Xl=0

where Dng is the n-th derivative of g and cl are some non-negative constants. We apply this
to m and ζ. Next, we note that m(−1) = m′(−1) = 0. Since m ∈ C 2(R) and |m′′| .ν 1, this
implies

|m(κ)| .ν |κ + 1|2,

|m′(κ)| .ν |κ + 1|

whenever |κ + 1| ≤ 1. Furthermore, for (ξ, η) in the support of m(j,l) one has 2−j−2 ≤
|η/ξ +1| ≤ 2−j and 2j−2 ≤ ξ−η ≤ 2j, which together imply 2−4 ≤ ξ +η ≤ 1 and |ξ| ∼ |η| ∼ 2j.
Also, ξ − η lies in an interval of length at most 2. Consequently, |supp(m(j,l))| ∼ 1. Using
these facts we deduce the bound (5.12), which together with the bound for the size of the
support implies (5.11) in the view of |u| ≥ |v|. Analogously we show (5.11) if |u| ≤ |v|, which
ﬁnally establishes Proposition 7.

6. Ergodic averages, Deriving Theorem 1 from Theorem 3

Let 0 < ε < 1, α > 8, f , and g be as in Theorem 1. Introduce three parameters λ, δ, L,

which will appear in the proof and can be deﬁned explicitly as

λ := (α − 2)/2 > 3,

δ := ε/16, L := ⌊64/ε⌋ + 1.

Suppose that we have J pairs of indices (1.2) such that

kMmj (f, g) − Mnj (f, g)kL2(X) ≥ ε

(6.1)

(6.2)

for each 1 ≤ j ≤ J. Our goal is to show J .α ε−α. If J ≤ L . ε−1, we are done, so assume
J > L in all that follows. At least J ′ := J − L of the jumps (6.2) correspond to the indices
that are greater than L, i.e. L < mj < nj for j = L + 1, . . . , J.

20

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

In the ﬁrst step of the proof we introduce the bilinear averages with “rough” truncations,

namely

A′

t(F, G)(x, y) :=

=

1

tZ[0,t)
tZ[x+y,x+y+t)

1

F (x + s, y) G(x, y + s) ds

F (u − y, y) G(x, u − x) du

for any t > 0, for F, G ∈ L4(R2), and for (x, y) ∈ R2. We need to compare rough averages
t(F, G) with smooth averages Aϕ
A′
t (F, G) for an appropriate ϕ in order to use the variational
estimate available for the latter. Recall that Theorem 3 applies to functions ϕ satisfying

is invariant under L1 normalized scaling of ϕ, it also holds under the assumptions that

|ϕ(s)| + |sϕ′(s)| ≤ (1 + |s|)−λ and with bϕ supported in [−1, 1]. Since the variational estimate
and that bϕ is supported in [−δ−1, δ−1].
Let ϑ be any Schwartz function having integral 1 with bϑ supported in [−1, 1]. Set ϕ =

|ϕ(s)| + |sϕ′(s)| ≤ δ−1(1 + |δ−1s|)−λ

1[0,1) ∗ ϑδ, i.e.

(6.3)

ϑ(u)du,

ϕ(s) =Z δ−1s
so using |ϑ(u)| .ϑ (1 + |u|)−3 we can estimate
−∞ (1 + |u|)−3du
δ−1(s−1)(1 + |u|)−3du
+R ∞
δ−1s(cid:1)(1 + |u|)−3du when 0 < s < 1.

|ϕ(s)| .ϑR δ−1s
|ϕ(s)| .ϑR ∞
|ϕ(s) − 1| .ϑ(cid:0)R δ−1(s−1)

Integrating the tails and combining the three cases we obtain

when s ≤ 0,
when s ≥ 1,

δ−1(s−1)

−∞

(6.4)

|ϕ(s) − 1[0,1)(s)| .ϑ (1 + δ−1|s|)−2 + (1 + δ−1|s − 1|)−2

and hence by a further integration

kϕ − 1[0,1)kL1(R) .ϑ δ.

After scaling by any t > 0 we also get

so that Minkowski’s integral inequality and H¨older’s inequality give

ZR(cid:12)(cid:12)t−1ϕ(t−1s) − t−1

1[0,t)(s)(cid:12)(cid:12) ds .ϑ δ,

kAϕ

t (F, G) − A′

t(F, G)kL2(R2) .ϑ δ.

Moreover, bϕ is supported in [−δ−1, δ−1]. Let us bound ϕ using (6.4) and |ϑ(u)| .ϑ,λ

(1 + |u|)−λ as

|ϕ(s)| .ϑ,λZ δ−1s

δ−1(s−1)

(1 + |u|)−λdu.

For |s| ≥ 2 the last integrand is comparable with (1 + δ−1|s|)−λ, so the whole integral is
controlled by δ−1(1 + δ−1|s|)−λ, while for |s| < 2 we can estimate |ϕ(s)| simply by an integral
over the whole real line, so |ϕ(s)| .ϑ,λ 1. Combining the two we get

On the other hand, diﬀerentiation of (6.4) yields

|ϕ(s)| .ϑ,λ δ−λ(1 + δ−1|s|)−λ.

sϕ′(s) = δ−1s(cid:0)ϑ(δ−1s) − ϑ(δ−1(s − 1))(cid:1).

(6.5)

(6.6)

NORM-VARIATION OF ERGODIC AVERAGES

21

This time we control the expression for |s| ≥ 2 by (1 + δ−1|s|)−λ, while for |s| < 2 we simply
use |sϕ′(s)| . δ−1kϑkL∞ . That way we obtain

(6.7)
From (6.6) and (6.7) we see that ϕ multiplied by a constant times δλ satisﬁes estimates (6.3).
Applying Theorem 3 (i.e. estimate (1.4)) to arbitrary functions F and G normalized as in
(2.2) and to the scales t = mj and t = nj we obtain

|sϕ′(s)| .ϑ,λ δ−λ−1(1 + δ−1|s|)−λ.

(cid:16) JXj=L+1

kAϕ

mj (F, G) − Aϕ

nj (F, G)k2

L2(R2)(cid:17)1/2

≤ Cϑ,λδ−λ

for some ﬁnite constant Cϑ,λ. Combining (6.5) and (6.8) we get

(cid:16) JXj=L+1

kA′

mj (F, G) − A′

nj (F, G)k2

L2(R2)(cid:17)1/2

≤ Cϑ,λδ−λ + 2δJ ′1/2.

In the second step of the proof we transfer the obtained estimate from R2 to Z2, so for any

two double sequences ˜F , ˜G : Z2 → R we denote

(6.8)

(6.9)

(6.10)

(6.11)

Pick arbitrary ˜F , ˜G ∈ ℓ4(Z2) normalized by k ˜Fkℓ4(Z2) = k ˜Gkℓ4(Z2) = 1. Deﬁne functions
F, G : R2 → R as

˜An( ˜F , ˜G)(k, l) :=

=

˜F (k + i, l) ˜G(k, l + i)

1
n

n−1Xi=0
n Xi∈Z

1

k+l≤i≤k+l+n−1

˜F (i − l, l) ˜G(k, i − k).

F (x, y) := Xi,l∈Z
G(x, y) := Xi,k∈Z

˜F (i − l, l) 1[i,i+1)(x + y) 1[l,l+1)(y),
˜G(k, i − k) 1[k,k+1)(x) 1[i,i+1)(x + y).

Indeed, F and G are constant on certain skew parallelograms of area 1 and obviously kFkL4(R2) =
kGkL4(R2) = 1 as well. Splitting the integral into the pieces over i ≤ u < i + 1 we get

A′

n(F, G)(k + α, l + β) =

ai ˜F (i − l, l) ˜G(k, i − k),

(6.12)

1

nXi∈Z

for any k, l ∈ Z, α, β ∈ [0, 1), where we have denoted

Observe that

ai =(cid:12)(cid:12)[i, i + 1) ∩ [k + l + α + β, k + l + α + β + n)(cid:12)(cid:12).

ai = 1 when k + l + 2 ≤ i ≤ k + l + n − 1,
ai = 0 when i ≤ k + l − 1 or i ≥ k + l + n + 2,

ai ∈ [0, 1] otherwise.

Comparing (6.12) with (6.11) it immediately follows that

(cid:12)(cid:12)A′
n(F, G)(k + α, l + β) − ˜An( ˜F , ˜G)(k, l)(cid:12)(cid:12) ≤

1

n Xi∈{0,1,n,n+1}(cid:12)(cid:12) ˜F (k + i, l) ˜G(k, l + i)(cid:12)(cid:12),

so for any n ∈ N we get

(cid:13)(cid:13)A′
n(F, G)(k + α, l + β) − ˜An( ˜F , ˜G)(k, l)(cid:13)(cid:13)ℓ2

(k,l)(Z2) ≤

4
n

.

22

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

Observe that this estimate is uniform in α, β ∈ [0, 1). Consequently, for any two positive
integers m < n,

so, taking the L2([0, 1)2) norm in (α, β),

(k,l)(Z2)

n(F, G)(k + α, l + β)kℓ2

−k ˜Am( ˜F , ˜G) − ˜An( ˜F , ˜G)kℓ2(Z2)(cid:12)(cid:12)(cid:12) ≤
n(F, G)kL2(R2) − k ˜Am( ˜F , ˜G) − ˜An( ˜F , ˜G)kℓ2(Z2)(cid:12)(cid:12)(cid:12) ≤

8
m

,

8
m

.

m(F, G)(k + α, l + β) − A′

(cid:12)(cid:12)(cid:12)kA′
(cid:12)(cid:12)(cid:12)kA′
(cid:16) JXj=L+1(cid:13)(cid:13) ˜Amj ( ˜F , ˜G) − ˜Anj ( ˜F , ˜G)(cid:13)(cid:13)2

m(F, G) − A′

ℓ2(Z2)(cid:17)1/2

≤ Cϑ,λδ−λ +(cid:0)2δ + 8/L(cid:1)J ′1/2.

Applying this to m = mj, n = nj for j = L + 1, . . . , J, using mj > L, and combining with
(6.9) we conclude

If we multiply the right hand side by k ˜Fkℓ4(Z2)k ˜Gkℓ4(Z2), then the inequality holds for arbitrary
˜F and ˜G by homogeneity. Moreover, squaring and using (a+b)2 ≤ 2a2 +2b2 and 2ab ≤ a2 +b2
for a, b ≥ 0 we obtain a slightly more convenient estimate

JXj=L+1(cid:13)(cid:13) ˜Amj ( ˜F , ˜G) − ˜Anj ( ˜F , ˜G)(cid:13)(cid:13)2
≤(cid:0)C 2
ϑ,λδ−2λ + (2δ + 8/L)2J ′(cid:1)(cid:0)k ˜Fk4

ℓ2(Z2)

ℓ4(Z2) + k ˜Gk4

ℓ4(Z2)(cid:1).

(6.13)

In the third step of the proof we transfer to the measure-preserving system (X,F, µ, S, T ).
Take a point x ∈ X and ﬁx a positive integer N ≥ nJ . The function ˜Fx,N : Z2 → R deﬁned
by

˜Fx,N (k, l) :=(f (SkT lx)

0

if 0 ≤ k, l ≤ 2N − 1,
otherwise

and analogously deﬁned ˜Gx,N keep track of the values of f and g along the forward trajectory
of x. Observe that for integers 0 ≤ k, l < N and 0 < n ≤ N we have

where we used ST = T S and the deﬁnition (6.10). The fact that S and T are measure-
preserving enables us to write

Mn(f, g)(SkT lx) =

1
n

n−1Xi=0
f (Sk+iT lx)g(SkT l+ix) = ˜An(cid:0) ˜Fx,N , ˜Gx,N(cid:1)(k, l),
L2(X) =ZX(cid:12)(cid:12)Mmj (f, g)(x) − Mnj (f, g)(x)(cid:12)(cid:12)2dµ(x)

1

=

kMmj (f, g) − Mnj (f, g)k2
N 2ZX
N 2ZX(cid:13)(cid:13) ˜Amj ( ˜Fx,N , ˜Gx,N ) − ˜Anj ( ˜Fx,N , ˜Gx,N )(cid:13)(cid:13)2

N −1Xk,l=0(cid:12)(cid:12)Mmj (f, g)(SkT lx) − Mnj (f, g)(SkT lx)(cid:12)(cid:12)2dµ(x)

ℓ2(Z2)dµ(x)

≤

1

for each j. Similar computation as above gives

1 = kfk4

L4(X) =

1

4N 2ZX

2N −1Xk,l=0

|f (SkT lx)|4dµ(x) =

1

4N 2ZX k ˜Fx,Nk4

ℓ4(Z2)dµ(x).

NORM-VARIATION OF ERGODIC AVERAGES

23

Therefore, taking ˜F = ˜Fx,N , ˜G = ˜Gx,N , and integrating (6.13) in x over X yields

JXj=L+1

kMmj (f, g) − Mnj (f, g)k2

L2(X) ≤ 8C 2

ϑ,λδ−2λ + 8(2δ + 8/L)2J ′.

(6.14)

Combining (6.14) with (6.2) and the choice of δ and L from (6.1) we obtain a bootstrapping
estimate

ϑ,λδ−2λ + 8(2δ + 8/L)2(J − L)
ϑ,λ162λε−2λ + (ε2/2)(J − L),
i.e. J .λ ε−2λ−2 = ε−α, which completes the proof of Theorem 1.

ε2(J − L) ≤ 8C 2
≤ 8C 2

7. Deriving Corollary 2 from Theorem 1

For part (a) we actually need to show

mXj=1

kMnj (f, g) − Mnj−1(f, g)k̺

L2(X)

.̺ kfk̺

L4(X)kgk̺

L4(X)

(7.1)

for arbitrary positive integers n0 < n1 < ··· < nm, with the implicit constant depending only
on ̺. Using homogeneity of the estimate we can again normalize as in (2.2). Observe that
for any α > 8 and any integer k ≥ 0 the number of indices j such that
2−k < kMnj (f, g) − Mnj−1(f, g)kL2(X) ≤ 2−k+1

is at most Cα2αk by Theorem 1. Thus, the sum on the left hand side of (7.1) is bounded by

a constant timesP∞

k=0 2(α−̺)k, which is ﬁnite if we choose α such that 8 < α < ̺.

For the proof of part (b) we additionally have that µ(X) = 1 and the functions f and g
are taken from L∞(X), which is now contained in L4(X). For any positive integers m < n
by the monotonicity of Lp norms on a probability space in the case p < 2 we can use

kMm(f, g) − Mn(f, g)kLp(X) ≤ kMm(f, g) − Mn(f, g)kL2(X)

and by their log-convexity for p > 2 we have

kMm(f, g) − Mn(f, g)kLp(X) ≤ (2kfkL∞(X)kgkL∞(X))1−2/pkMm(f, g) − Mn(f, g)k2/p

L2(X)

.

It remains to apply the inequality from part (a). For that purpose in the case p > 2 we need
2̺/p > 8, which is satisﬁed because of the condition ̺ > 4p.

P. D. and C. T. are supported by the Hausdorﬀ Center for Mathematics. V. K. and K. A.

ˇS. are supported in part by the Croatian Science Foundation under the project 3526.

Acknowledgments

References

[1] T. Austin, On the norm convergence of non-conventional ergodic averages, Ergodic Theory Dynam. Sys-

tems 30 (2010), no. 2, 321–338.

[2] J. Avigad, J. Rute, Oscillation and the mean ergodic theorem for uniformly convex Banach spaces, Ergodic

Theory Dynam. Systems 35 (2015), no. 4, 1009–1027.

[3] F. Bernicot, Lp estimates for non smooth bilinear Littlewood-Paley square functions on R, Math. Ann.

351 (2011), no. 1, 1–49.

[4] F. Bernicot, S. Shrivastava, Boundedness of smooth bilinear square functions and applications to some

bilinear pseudo-diﬀerential operators, Indiana Univ. Math. J. 60 (2011), no. 1, 233–268.

[5] J. Bourgain, Almost sure convergence and bounded entropy, Israel J. Math. 63 (1988), no. 1, 79–97.
[6] J. Bourgain, Double recurrence and almost sure convergence, J. Reine Angew. Math. 404 (1990), 140–161.

24

P. DURCIK, V. KOVA ˇC, K. A. ˇSKREB, AND C. THIELE

[7] J.-P. Conze, E. Lesigne, Th´eor`emes ergodiques pour des mesures diagonales, Bull. Soc. Math. France 112

(1984), no. 2, 143–175.

[8] C. Demeter, C. Thiele, On the two-dimensional bilinear Hilbert transform, Amer. J. Math. 132 (2010),

no. 1, 201–256.

[9] Y. Do, R. Oberlin, E. A. Palsson, Variation-norm and ﬂuctuation estimates for ergodic bilinear averages

(2015), to appear in Indiana Univ. Math. J., available at arXiv:1504.07134.

[10] S. Donoso, W. Sun, Pointwise multiple averages for systems with two commuting transformations (2015),

preprint, available at arXiv:1509.09310.

[11] P. Durcik, An L4 estimate for a singular entangled quadrilinear form (2014), to appear in Math. Res.

Lett., available at arXiv:1412.2384.

[12] P. Durcik, Lp estimates for a singular entangled quadrilinear form (2015), to appear in Trans. Amer.

Math. Soc., available at arXiv:1506.08150.

[13] R. L. Jones, R. Kaufman, J. M. Rosenblatt, M. Wierdl, Oscillation in ergodic theory, Ergodic Theory

Dynam. Systems 18 (1998), no. 4, 889–935.

[14] R. L. Jones, I. V. Ostrovskii, J. M. Rosenblatt, Square functions in ergodic theory, Ergodic Theory Dynam.

Systems 16 (1996), no. 2, 267–305.

[15] R. L. Jones, A. Seeger, J. Wright, Strong variational and jump inequalities in harmonic analysis, Trans.

Amer. Math. Soc. 360 (2008), no. 12, 6711–6742.

[16] V. Kovaˇc, Bellman function technique for multilinear estimates and an application to generalized para-

products, Indiana Univ. Math. J. 60 (2011), no. 3, 813–846.

[17] V. Kovaˇc, Boundedness of the twisted paraproduct, Rev. Mat. Iberoam. 28 (2012), no. 4, 1143–1164.
[18] V. Kovaˇc, Quantitative norm convergence of double ergodic averages associated with two commuting group

actions (2014), to appear in Ergodic Theory Dynam. Systems, available at arXiv:1405.3499.

[19] V. Kovaˇc, K. A. ˇSkreb, One modiﬁcation of the martingale transform and its applications to paraproducts

and stochastic integrals, J. Math. Anal. Appl. 426 (2015), no. 2, 1143–1163.

[20] V. Kovaˇc, C. Thiele, A T(1) theorem for entangled multilinear dyadic Calder´on-Zygmund operators, Illinois

J. Math. 57 (2013), no. 3, 775–799.

[21] V. Kovaˇc, C. Thiele, P. Zorin-Kranich, Dyadic triangular Hilbert transform of two general and one not

too general function, Forum of Mathematics, Sigma 3 (2015), e25.

[22] M. Lacey, On bilinear Littlewood-Paley square functions Publ. Mat. 40 (1996), no. 2, 387–396.
[23] M. Lacey, C. Thiele, Lp estimates on the bilinear Hilbert transform for 2 < p < ∞, Ann. of Math. (2)

146 (1997), no. 3, 693–724.

[24] M. Lacey, C. Thiele, On Calder´on’s conjecture, Ann. of Math. (2) 149 (1999), no. 2, 475–496.
[25] P. Mohanty, S. Shrivastava, A note on the bilinear Littlewood-Paley square function, Proc. Amer. Math.

Soc. 138 (2010), no. 6, 2095–2098.

[26] P. K. Ratnakumar, S. Shrivastava, On bilinear Littlewood-Paley square functions, Proc. Amer. Math. Soc.

140 (2012), no. 12, 4285–4293.

[27] J. L. Rubio de Francia, A Littlewood-Paley inequality for arbitrary intervals Rev. Mat. Iber. 1 (1985), no.

2, 1–14.

[28] T. Tao, Norm convergence of multiple ergodic averages for commuting transformations, Ergodic Theory

Dynam. Systems 28 (2008), no. 2, 657–688.

[29] C. Thiele, Wave packet analysis, CBMS Reg. Conf. Ser. Math. 105, AMS, Providence, RI, 2006.
[30] M. N. Walsh, Norm convergence of nilpotent ergodic averages, Ann. of Math. (2) 175 (2012), no. 3,

1667–1688.

[31] P. Zorin-Kranich, Cancellation for the simplex Hilbert transform, preprint, available at arXiv:1507.02436.

NORM-VARIATION OF ERGODIC AVERAGES

25

Polona Durcik, Mathematisches Institut, Universit¨at Bonn, Endenicher Allee 60, 53115

Bonn, Germany

E-mail address: durcik@math.uni-bonn.de

Vjekoslav Kovaˇc, Department of Mathematics, Faculty of Science, University of Zagreb,

Bijeniˇcka cesta 30, 10000 Zagreb, Croatia

E-mail address: vjekovac@math.hr

Kristina Ana ˇSkreb, Faculty of Civil Engineering, University of Zagreb, Fra Andrije Kaˇci´ca

Mioˇsi´ca 26, 10000 Zagreb, Croatia

E-mail address: kskreb@grad.hr

Christoph Thiele, Mathematisches Institut, Universit¨at Bonn, Endenicher Allee 60, 53115

Bonn, Germany

E-mail address: thiele@math.uni-bonn.de

