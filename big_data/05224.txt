6
1
0
2

 
r
a

 

M
6
1

 
 
]
T
S
h
t
a
m

.

[
 
 

1
v
4
2
2
5
0

.

3
0
6
1
:
v
i
X
r
a

ConﬁdenceIntervalforCausalE↵ectswithPossiblyInvalidInstrumentsEvenAfterControllingforManyConfounders⇤ZijianGuo1,HyunseungKang2,T.TonyCai1andDylanS.Small11DepartmentofStatistics,TheWhartonSchool,UniversityofPennsylvania2Economics,StanfordGraduateSchoolofBusiness,StanfordUniversityMarch15,2016AbstractTheinstrumentalvariable(IV)methodisapopularmethodtoestimatecausale↵ectsofatreatmentonanoutcomebyusingvariablesknownasinstrumentstoex-tractunconfoundedvariationintreatment.Theseinstrumentsmustsatisfythecoreassumptions,including(A1)associationwiththetreatment,(A2)nodirecte↵ectontheoutcome,and(A3)ignorability.Theseassumptionsmaybemademoreplausi-blebyconditioningonmany,possiblyhigh-dimensionalcovariates,anopportunityincreasinglymadeavailablebythecompilationoflargedatasets.However,evenafterconditioningonalargenumberofcovariates,it’spossiblethattheputativeinstrumentsareinvalidduetotheirdirecte↵ectsontheoutcome(violating(A2))or⇤Addressforcorrespondence:ZijianGuo,DepartmentofStatistics,TheWhartonSchool,UniversityofPennsylvania,JonM.HuntsmanHall,Philadelphia,PA19104-6340,USA.Email:zijguo@wharon.upenn.edu.ZijianGuoisaPh.D.student(Email:zijguo@wharon.upenn.edu);HyunseungKangisaPostdoctoralRe-searchFellow(Email:hskang@stanford.edu);T.TonyCaiisDorothySilberbergProfessorofStatistics(E-mail:tcai@wharton.upenn.edu);DylanS.SmallisProfessor(Email:dsmall@wharton.upenn.edu).TheresearchofHyunseungKangwassupportedinpartbyNSFGrantDMS-1502437.TheresearchofT.TonyCaiwassupportedinpartbyNSFGrantsDMS-1208982andDMS-1403708,andNIHGrantR01CA127334.TheresearchofDylanS.SmallwassupportedinpartbyNSFGrantSES-1260782.1violationsofignorability(violating(A3))andtheresultinginferenceonthecausale↵ectmaybemisleading.WeproposeageneralinferenceprocedurethatprovideshonestinferenceinthepresenceofinvalidIVsevenaftercontrollingformany,possiblyhighdimensionalcovariates.Wedemonstrateourprocedureonsimulateddataandﬁndthatitout-performstraditionalmethods,especiallywhentheinstrumentsareinvalid.Wealsodemonstratetheusefulnessofourmethodbyanalyzingthecausale↵ectofeducationonearningsfromtheWisconsinLongitudinalStudy.Keywords:High-dimensionalcovariates;sparsity;de-biasingmethod;exclusionrestriction;treatmente↵ect.1Introduction1.1Motivation:CausalInferencewithLargeObservationalData,UnmeasuredConfounding,andInstrumentalVariablesInhealthandsocialsciences,thereisagrowingtrendtowardlargecollectionofdiversetypesofobservationaldatatostudycausale↵ects.Forexample,theAlzheimer’sDiseaseNeuroimagingInitiative(ADNI),startedin2004,isamulti-centere↵orttounderstandAlzheimer’sdiseasebycollectinglarge,oftenhigh-dimensional,anddi↵erenttypesofdata,includingclinical,imaging,genetic,andbiomarkerdata(Weineretal.,2015).Asanotherexample,theWisconsinLongitudinalStudy(WLS),startedin1957,isalongitudinalsurveyofhighschoolgraduatesfromWisconsinthatcontainsdemographic,socioeconomic,clinical,andmostrecently,largegeneticdata(Herdetal.,2014).Acentralprobleminanalyzingobservationaldataforcausalinferenceisdealingwithun-measuredconfounding,thatisdealingwithotherpotentialexplanationsforthetreatment’se↵ectontheoutcomethatweren’tmeasuredinthedata.Forexample,supposewewanttostudythecausale↵ectofyearsofeducationonearningsfromtheWLSdata;thisquestionisoflongstandinginterestineconomics(AngristandKrueger,1991;Card,1993,1999)andwewillrevisitthisquestioninSection6.Therearemanyconfoundersthatcanpotentially2a↵ectanindividual’syearsofeducationandearnings,includinginnateabilityandfamilybackground,andoften,it’simpracticaltomeasureandcontrolforallpossibleconfoundersforthee↵ectofeducationonearnings.Onepopularmethodtodeducecausale↵ectsinthepresenceofunmeasuredconfoundingisbyusinginstrumentalvariables(IV)analysis.AnIVanalysisrequiresvariablescalledinstrumentsthat(A1)arerelatedtotheexposure(A2)havenodirectpathwaytotheoutcomeand(A3)arenotrelatedtounmeasuredvariablesthata↵ecttheexposureandtheoutcome(seeSection2.2fordetails).Variablesthatsatisfytheseassumptionsarereferredtoasvalidinstruments.ThechallengeinIVanalysisistoﬁndvalidinstrumentsandinpractice,oneoftenhasahandfulofcandidateinstrumentswheresomeofthemareinvalid.Tosomedegree,thelargedatasetsbringsomehopeinﬁndingvalidinstruments,inparticularbecause(A3)maybemoreplausibleaftercontrollingformanycovariates(seeHern´anandRobins(2006)andBaiocchietal.(2014)fordiscussionoftheneedtocontrolforcovariatesforaninstrumenttobevalidinsomecircumstances).Forexample,instudyingthee↵ectofeducationonearningsinWLS,aperson’sproximitytoacollegewhengrowinguphasbeenusedasaninstrument(Card,1993,1999).However,proximitytoacollegewhengrowingupmayberelatedtoaperson’ssocioeconomicstatus,characteristicsofaperson’shighschoolandothercovariatesthatmaya↵ectaperson’searnings,andthusthesecovariatesneedtobecontrolledforinorderforproximitytocollegetobeavalidIV.1.2Problem:InvalidInstrumentsEvenAfterControllingforManyConfoundersDespitethepromisethatlargedatasetsmaybringintermsofﬁndingvalidinstrumentsbyconditioningonlargenumberofcovariates,someoftheIVsmaystillturnouttobeinvalidandsubsequentanalysisassumingthatalltheIVsarevalidafterconditioningcanbemisleading.Forexample,supposeforstudyingthecausale↵ectofeducationonearnings,weusedproximityasanIVandtomakesuretheIVsatisﬁes(A3),wecontrolforconfounderslikehighschooltestscoresofthestudent,highschoolsize,individual’sgeneticmakeup,familyeducation,andfamily’ssocioeconomicstatus.But,iflivingclosetocollegehadother3beneﬁtsbeyondgettingmoreeducation,saybybeingexposedtomanyprogramsavailabletohighschoolstudentsforjobpreparationandemployerswhocometotheareatodiscussemploymentopportunitiesforcollegestudents,thentheIV,proximitytocollege,candirectlya↵ectindividual’searningpotentialandviolate(A2)(Card,1999).Ourpaperattemptstotackletheproblemofcausale↵ectestimationunderthissetup.Speciﬁcally,motivatedbyavailabilityofdatasetswithmanycovariatesthatcanmakeplau-sibletheIVassumptions,butthefactthatinvalidinstrumentsmaystillbepresentevenaftercontrollingformanycovariates,weexploreinferringcausale↵ectsthatarerobusttoinvalidinstrumentsevenaftermany,possiblyhigh-dimensionalcontrolsintheformofconﬁdenceintervalestimation.1.3PriorworkandourcontributionsThereispriorworkinIVliteraturewithhighdimensionalcovariatesand/orinstruments(Bellonietal.,2012;Chernozhukovetal.,2015;FanandLiao,2014;GautierandTsybakov,2011).Unfortunately,allofthemassumethataftercontrollingforconfounders,alltheIVsarevalid.Recently,thereisworkonestimatingcausale↵ectsinthepresenceofinvalidinstrumentsKangetal.(2015);Koles´aretal.(2015),butthesemethodsdonotincorpo-ratecontrollingforhighdimensionalcovariates.Moreimportantly,Kangetal.(2015)onlyprovidesaconsistentestimateofthetreatmente↵ectandnotconﬁdenceintervals.Ourcontributionisauniﬁcationofbothlinesofwork,examininginvalidinstrumentsevenaftercontrollingforahighdimensionalnumberofcovariates.First,weproposeageneralconﬁdenceintervalestimatorthatprovideshonestcoverageofthecausale↵ectoftheexposureontheoutcomeinthepresenceofpossiblyinvalidinstrumentsevenaftercon-trollingforhighdimensionalcovariates.Second,weprovidetheoreticalguaranteesofourconﬁdenceinterval.Aninterestingfeatureofthetheoreticalanalysisisthatthepresenceofinvalidinstrumentsforcesustoconsiderassumptionsoninstrumentsgloballyandindi-vidually.Third,weconductasimulationstudytoassesstheperformanceofourconﬁdenceintervalundervarioussettings.Finally,weprovidearealdataanalysisusingourmethod,speciﬁcallyrevisitingthequestionaboutthecausale↵ectofyearsofschoolingonincome4usingdatafromtheWisconsinLongitudinalStudy.2Model2.1NotationTodeﬁnecausale↵ects,thepotentialoutcomeapproachNeyman(1923);Rubin(1974)forinstrumentslaidoutinHolland(1988)isused.Foreachindividuali2{1,...,n},letY(d,z)i2Rbethepotentialoutcomeiftheindividualweretohaveexposured2Randinstrumentsz2Rpz.LetD(z)i2Rbethepotentialexposureiftheindividualhadinstrumentsz2Rpz.Foreachindividual,onlyonepossiblerealizationofY(d,z)iandD(z)iisobserved,denotedasYiandDi,respectively,basedonhisobservedinstrumentvaluesZi.2RpzandexposureDi.Wealsodenotepre-instrumentcovariatesforeachindividualiasXi.2Rpx.Intotal,nsetsofoutcome,exposure,andinstruments,denotedas(Yi,Di,Zi.,Xi.),areobservedinani.i.d.fashion.WedenoteY=(Y1,...,Yn)tobeann-dimensionalvectorofobservedoutcomes,D=(D1,...,Dn)tobeann-dimensionalvectorofobservedexposures/treatment,ZtobeanbypzmatrixofinstrumentswhererowiconsistsofZi.,andXtobeannbypxmatrixofcovariateswhererowiconsistsofXi..LetWbeannbyp=pz+pxmatrixwhereWisaresultofconcatenatingthematricesZandX.Foranyvectorv2Rp,letvjdenotethejthelementofv.Letkvk1,kvk2,andkvk1denotetheusual1,2and1-norms,respectively.Letkvk0denotethenumberofnon-zeroelementsinvandsupp(v)✓{1,...,p},isdeﬁnedas{j:vj6=0}.ForanynbypmatrixM2Rn⇥p,wedenotethe(i,j)elementofmatrixMasMij,theithrowasMi.,andthejthcolumnasM.j.LetM|bethetransposeofMandkMk1representtheelement-wisematrixsupnormofmatrixM.ForasequenceofrandomvariablesXn,weuseXnp!XtorepresentthatXnconvergestoXinprobability.Finally,foranytwosequencesanandbn,wewillwritean bniflimsupbnan=0andwritean⌧bnifbn an.Also,forasetJ,|J|denotesitscardinality.52.2ModelandInstrumentalVariablesAssumptionsWeconsidertheAdditiveLInear,ConstantE↵ects(ALICE)modelofHolland(1988)andextendittoallowformultiplevalidandpossiblyinvalidinstrumentsasinSmall(2007)andKangetal.(2015).Fortwopossiblevaluesoftheexposured0,dandinstrumentsz0,z,weassumethefollowingpotentialoutcomesmodelY(d0,z0)i Y(d,z)i=(z0 z)|⇤+(d0 d) ⇤,E(Y(0,0)i|Zi.,Xi.)=Z|i.⌘⇤+X|i. ⇤(1)where⇤, ⇤,⌘⇤,and ⇤areunknownparameters.Theparameter ⇤representsthecausalparameterofinterest,thecausale↵ect(dividedbyd0 d)ofchangingtheexposurefromd0todontheoutcome.Theparameter ⇤representstheimpactofcovariatesonthebaselinepotentialoutcomeY(0,0)i.Theparameter⇤representsviolationof(A2),thedirecte↵ectoftheinstrumentsontheoutcome.If(A2)holds,then⇤=0.Theparameter⌘⇤representsviolationof(A3),thepresenceofunmeasuredconfoundingbetweentheinstrumentandtheoutcome.If(A3)holds,then⌘⇤=0.Let⇡⇤=⇤+⌘⇤and✏i1=Y(0,0)i E(Y(0,0)i|Zi.,Xi.).Whenwecombineequation(1)alongwiththedeﬁnitionof✏i1,theobserveddatamodelbecomesYi=Z|i.⇡⇤+Di ⇤+X|i. ⇤+✏i1,E(✏i1|Zi.,Xi.)=0.(2)Theobservedmodelisalsoknownastheunder-identiﬁedsingle-equationlinearmodelineconometrics(page83ofWooldridge(2010)).ThismodelisnotausualregressionmodelbecauseDimightbecorrelatedwith✏i1.Inparticular,theparameter ⇤measuresthecausale↵ectofchangingDonYratherthananassociation.Theparameter⇡⇤inmodel(2)combinesboththeviolationof(A2),representedby⇤,andtheviolationof(A3),representedby⌘⇤.Ifboth(A2)and(A3)aresatisﬁed,then⇤=⌘⇤=0and⇡⇤=0.Hence,⇡⇤capturestheviolationsof(A2)and(A3).Weformalizethisnotionwiththefollowingdeﬁnition.Deﬁnition1.Supposewehavepzcandidateinstrumentsalongwiththemodels(1)–(2).Wesaythatinstrumentj=1,...,pzsatisﬁes(A2) (A3)if⇡⇤j=0.Wealsoassumealinearassociation/observationalmodelbetweentheendogenousvariableDi,theinstrumentsZi.,andthecovariatesXi..Di=Z|i. ⇤+X|i. ⇤+✏i2,E(✏i2|Zi.,Xi.)=0(3)6Eachelement ⇤jisthepartialcorrelationbetweenthejthinstrumentandD.Theparameter ⇤representstheassociationbetweenthecovariatesandDi.Also,unlikethemodels(1)-(2),wedonotneedacausalmodelbetweenDi,Zi.,andXi.;onlytheassociationmodel(3)issu cientforourmethod.Finally,fornotation,weletsz2=k⇡⇤k0,sx2=k ⇤k0,sz1=k ⇤k0andsx1=k ⇤k0.Basedonmodel(3),wecandeﬁneasetofinstrumentsthatsatisfy(A1).Deﬁnition2.Supposewehavepzcandidateinstrumentsalongwiththemodel(3).Wesaythatinstrumentj=1,...,pzsatisﬁes(A1),orisanindividuallystrongIV,if ⇤j6=0anddenoteS⇤tobethesetoftheseinstruments.Typically,satisfying(A1)hasbeendeﬁnedinaglobalsensewhere(A1)issatisﬁedif ⇤6=0(Wooldridge,2010).However,thisglobaldeﬁnitioncanbemisleadinginthepresenceofmultiplecandidateinstruments.Forexample,it’spossiblethat ⇤1 0while ⇤j=0forallj6=1sothatonlytheﬁrstinstrumenthasane↵ectontheexposurewhiletherestdonot.Usingtheglobaldeﬁnitionwouldimplythatallthepzinstrumentssatisfy(A1)whileDeﬁnition2makesitexplicitand,perhapslessambiguous,thatit’sonlytheﬁrstinstrumentj=1thatsatisﬁes(A1).Nevertheless,boththetraditionalglobaldeﬁnitionandDeﬁnition2areequivalentif ⇤j6=0forallj,thatiswhereweonlyincluderelevantinstruments,whichistypicallythecaseinpracticeandisthescenariostudiedbyKangetal.(2015).Finally,whenthereisonlyonecandidateinstrumentsothatpz=1,bothdeﬁnitionsareequivalenttothedeﬁnitionpresentedinHolland(1988)andbothbecomeaspecialcaseofthedeﬁnitionpresentedinAngristetal.(1996)underanadditive,linear,constante↵ectsmodel.Inshort,Deﬁnition2agreeswithmostdeﬁnitionsofsatisfying(A1)intheliterature.Also,ineconomics,Deﬁnition2isthesameasthenotionofnon-redundantinstruments(ChengandLiao,2015).CombiningDeﬁnition2and1,wecanformallydeﬁneasetofvalidinstruments,i.e.thesetofinstrumentsthatsatisfyall(A1)-(A3),asfollows.Deﬁnition3.Supposewehavepzcandidateinstrumentsalongwiththemodels(1)–(3).Wesaythatinstrumentj=1,...,pzisvalid,i.e.satisﬁesall(A1) (A3),if⇡⇤j=0and ⇤j6=0.LetV⇤bethesetofvalidinstruments.7Whenthereisonlyoneinstrument,pz=1,Deﬁnition3ofavalidinstrumentisidenticaltothedeﬁnitionofavalidinstrumentinHolland(1988).Speciﬁcally,Deﬁnition2satisﬁesassumption(A1)thattheinstrumentisrelatedtotheexposure.Also,assumption(A2),theexclusionrestriction,whichmeansY(d,z)i=Y(d,z0)iforalld,z,z0,isequivalentto⇤=0andassumption(A3),nounmeasuredconfounding,whichmeansY(d,z)iandD(z)iareindependentofZi.foralldandz,isequivalentto⌘⇤=0,implying⇡⇤=⇤+⌘⇤=0.Deﬁnition3isalsoaspecialcaseofthedeﬁnitionofavalidinstrumentinAngristetal.(1996)wherehereweassumethemodelisadditive,linear,andhasaconstanttreatmente↵ect ⇤.Hence,whenmultipleinstruments,pz>1,arepresent,ourmodels(1)–(3)andDeﬁnition3canbeviewedasageneralizationofthedeﬁnitionofvalidinstrumentsinHolland(1988).Whilemodelspresentedabovemakestrongassumptions,speciﬁcallytheadditive,con-stant,lineare↵ects,wecanalsoextendthemodelin(2)toincludeheterogeneouscausale↵ectsandnon-lineare↵ects(Kangetal.,2015).Furthermore,boththeobservedmodelsin(2)and(3)areverypopularandstandardmodelstostudyinstrumentalvariablesinecono-metrics(Wooldridge,2010),withtheimportantexceptionthat(i)themodelin(2)allowsforpossiblyinvalidinstrumentsand(ii)weallowthenumberofcovariatespx(andeventhenumberofinstrumentspz)tobelargerthanthesamplesizen.Inshort,oursetupallowsustomodelmotivatingdatasetsdiscussedinSection1.1byallowingformanypre-instrumentcovariatesXi.(e.g.geneticdatafromanobservationaldata)tomaketheIVassumptions(A1)-(A3)moreplausible,butalsoleavesthepossibilitythattheinstrumentsmaystillbeinvalidevenaftercontrollingformanycovariates.3ConﬁdenceIntervalEstimation3.1EstimatingtheCenterandtheWidthoftheIntervalTherearetwoestimandsthatcompriseestimatingtheconﬁdenceintervalunderoursetting:thecenter,b ,andthewidthoftheinterval.Westartthediscussionwithestimatingthecenteroftheinterval.Forestimatingthecenterb ,it’sinstructivetosplittheestimationintotwoparts.The8ﬁrstpartinvolvesdealingwiththeproblemposedbythehigh-dimensionalnatureofourco-variates.Thesecondpartinvolvesdealingwiththeproblemposedbytheinvalidinstrumentsthatmaybepresentdespiteourbeste↵ortstoavoidthembyaddingmanycovariates.First,todealwiththehighdimensionalcovariatesXi.,weformulatetheobservedmodels(2)and(3)asreduced-formsmodelswherebothmodelsareonlyfunctionsofZi.andXi.Yi=Z|i. ⇤+X|i. ⇤+ei1(4)Di=Z|i. ⇤+X|i. ⇤+✏i2(5)where ⇤= ⇤ ⇤+⇡⇤and ⇤= ⇤+ ⇤ ⇤aretheparametersofthereduced-formmodelandei1= ⇤✏i2+✏i1isthereduced-formerrortermin(4).Theerrorsinthereduced-modelshavethepropertythatE(ei1|Zi.,Xi.)=0andE(✏i2|Zi.,Xi.)=0alongwiththecovariancematrix⇥⇤withelements⇥⇤11=Var(ei1|Zi.,Xi.),⇥⇤22=Var(✏i2|Zi.,Xi.),and⇥⇤12=Cov(ei1,✏i2|Zi.,Xi.).Thus,eachequationinthereduced-formmodelisausual(highdimensional)regressionmodelwith(highdimensional)covariatesZi.andXi.andoutcomesYiandDi,respectively.Therearemanymethodsintheliteraturetoestimatetheparametersofhighdimensionalregressionmodelslikethereduced-formmodelsin(4)and(5).OneapproachisthescaledLassoestimatorproposedbySunandZhang(2012),{b ,b ,b⇥11}=argmin 2Rpz, 2Rpx,⇥112R+kY Z  X k222np⇥11+p⇥112+ 0pn pzXj=1kZ.jk2| j|+pxXj=1kX.jk2| j|!(6)forthereducedmodelin(4)and{b ,b ,b⇥22}=argmin 2Rpz, 2Rpx,⇥222R+kD Z  X k222np⇥22+p⇥222+ 0pn pzXj=1kZ.jk2| j|+pxXj=1kX.jk2| j|!(7)forthereducedmodelin(5).Theterm 0inbothestimationproblems(6)and(7)repre-sentsthepenaltyterminthescaledLassoestimatorandwechoose 0=p2.05logp/n.Here,theconstant2.05ischosenoutofconvenienceandwillbefortheremainderofthetext.But,2.05canbeanyarbitrarynumbergreaterthan2andourresultswillhold.Also,wecanestimate⇥⇤12fromtheestimationproblems(6)and(7)byb⇥12=1/n⇣Y Zb  Xb ⌘|⇣D Zb  Xb ⌘.9Unfortunately,mostpenalizedestimatorsforhighdimensionalregressionproblemsarebiasedandthescaledLassoestimatorsarenoexception.Inourcase,usingtheestimates,sayb andb ,arebiasedfortheparametersthattheyestimate ⇤and ⇤.Thankfully,recentworksbyJavanmardandMontanari(2014);vandeGeeretal.(2014);ZhangandZhang(2014)andCaiandGuo(2016)allowustode-biasthesebiasedestimates.Speciﬁcally,letWbetheconcatenatedmatrixoftheinstrumentsZandthecovariatesX.Supposewesolvepzoptimizationproblemswherethesolutiontoeachpzoptimizationproblem,denotedasbu[j]2Rp,j=1,...,pz,isbu[j]=argminu2Rp1nkWuk22s.t.k1nW|Wu I.jk1 n.(8)Thetuningparameter nischosentobe12M21plogp/nwithM1deﬁnedasthelargesteigenvalueofthecovariancematrix⌃=Cov(Wi·).LetbUdenotetheconcatenationofthepzsolutionstotheoptimizationproblem,i.e.bU=(bu[1],...,bu[pz])|.Then,thedebiasedestimatesofb andb ,denotedase ande ,aree =b +1nbUW|⇣Y Zb  Xb ⌘,e =b +1nbUW|⇣D Zb  Xb ⌘.(9)Inshort,toovercomethehighdimensionalityofthecovariates,weusedscaledLassoalongwithde-biasingmethodsonthereduced-formmodelstoobtainde-biasedestimatese ande ofthereduced-formparameters.Thesecondstepinestimatingb ,thecenterofourconﬁdenceinterval,istodealwiththeproblemposedbyinvalidIVs.Speciﬁcally,weneedto(i)ﬁndIVsthatsatisfy(A1),thatisthesetS⇤inDeﬁnition2,and(ii)usethemtoﬁndvalidIVsthatsatisfy(A1)-(A3),thatisthesetV⇤inDeﬁnition3.First,anestimateofS⇤,denotedaseS,canbefoundbythresholdingthecoe cientsofthede-biasedestimatee eS=8<:j:|e j| qb⇥22kWbu[j]k2pnr2.05logpzn9=;.(10)Thethresholdisbasedonthenoiselevelofe jin(9)(representedbyqb⇥22kWbu[j]k2/n),adjustedbydimensionalityoftheinstrumentsize(representedbyp2.05logpz).10Next,weestimatethesetofvalidinstrumentsV⇤thatsatisfy(A1)-(A3)byestimating⇡⇤.Speciﬁcally,byDeﬁnition1,thesetofinstrumentswhere⇡⇤j=0satisfy(A2)and(A3)andconsequently,intersectingthissetwitheS,whichareestimatesofIVsthatsatisfy(A1),allowustoestimatethesetofvalidinstrumentsV⇤thatsatisfy(A1)-(A3).Toestimate⇡⇤,foreachstronginstrumentjineS,wedeﬁneb [j]tobetheestimateof ⇤fromusingthisstronginstrumentbydividingthereduced-formestimates,i.e.b [j]=e j/e j,andb⇡[j]tobetheestimateof⇡⇤usingthisjthinstrument’sestimateof ⇤,i.e.b⇡[j]=e  b [j]e .Foreachb⇡[j]inj2eS,wethresholdeachelementofb⇡[j]tocreatethethresholdedestimatee⇡[j],e⇡[j]k=b⇡[j]k1 k2eS\|b⇡[j]k| 2.05qb⇥11+(b [j])2b⇥22 2b [j]b⇥12kW(bu[k] e ke jbu[j])k2pnrlogpzn!(11)forall1kpz.Eachthresholdedestimatee⇡[j]isobtainedbylookingattheelementsoftheun-thresholdedestimate,b⇡[j],andexaminingwhethereachelementofitexceedsthenoisethreshold,similartothethresholdingstrategyin(10).Intheend,wehave|eS|estimatesofe⇡[j]basedoneachindividuallystronginstrumentineS,whereeache⇡[j]representsanestimateof⇡⇤.Theﬁnalestimateof ⇤isbypickingthee⇡[j]thathasthemostvalidinstruments,orequivalentlychoosinge⇡[j⇤],j⇤2eS,wherej⇤=argminjke⇡[j]k0;ifthereisanon-uniquesolution,wechoosee⇡[j]withthesmallest`1norm,theclosestconvexnormof`0.WeestimatethesetofvalidinstrumentseV✓{1,...,pz}asthoseelementsofe⇡[j⇤]thatarezero,eV=eS\supp e⇡[j⇤] wherej⇤=argminjke⇡[j]k0.(12)Then,usingtheestimatedeV,weobtainourestimateof ⇤andconsequently,thecenterofourconﬁdenceintervalasb =Pj2eVe je jPj2eVe 2j.(13)Notethatb in(13)hasthe“correct”forminthatif,bychance,wecorrectlyestimatedthesetofvalidinstrumentsV⇤andourdebiasedestimatesofthereduced-formparameters,e ande ,areperfectestimatesofthereduced-formparameters,ourestimateof ⇤in(13)wouldbecomeb =Pj2eVe je j/Pj2eVe 2j=Pj2V⇤ ⇤j2 ⇤/Pj2V⇤ ⇤j2= ⇤.Hence,ourestimatorin11(13)wouldidentify ⇤.Clearly,wewouldneverhaveaperfectestimateofthesetV⇤orthereduced-formparametersinﬁnitesampleandSection4describesthepropertiesofourestimateb undertheseuncertainties.Oncewefoundanestimateforthecenterofourconﬁdenceinterval,b ,weestimatethewidthoftheinterval.Inparticular,weestimatethestandarderrorofb byqbV/nwithbV=   Pj2eVe j1pnWbu[j]   22⇣Pj2eVe 2j⌘2⇣b⇥11+b 2b⇥22 2b b⇥12⌘.(14)Inequation(14),weseesomefamiliarvarianceexpressionsfromthetraditionalIVliterature.Forexample,theb⇥11+b 2b⇥22 2b b⇥12in(15)istheusualIVvarianceestimatoroftheerrorterminouroriginalmodel(2).But,ourvarianceestimatorisscaledbytermsthatdependontheestimatedsetofvalidinstrumentseV.Finally,havingboththeestimatesofthecenter,b andthestandarderrorofb ,ourrobustconﬁdenceintervaltakesontheusualform✓b  (1+⌘0)z1 ↵/2qbV/n,b +(1+⌘0)z1 ↵/2qbV/n◆,(15)wherez1 ↵/2isthe1 ↵/2quantileofthestandardnormaldistributionand⌘0isanypositiveconstant.Theconstant⌘0servestoimprovetheﬁnitesampleperformanceoftheconﬁdenceintervalandinpractice,wechoose⌘0=0.05.Forcompleteness,ourconﬁdenceintervalestimationprocedureisoutlinedinProcedure1.Wenowmakeafewcommentsaboutourconﬁdenceinterval.First,Procedure1providesageneralmethodtoconstructconﬁdenceintervalsinthepresenceofinvalidIVsandhighdimensionalcovariatesinthattheresultingoutputwillbevalidifany,orboth,ofthesetwoproblemsarepresent.Forexample,ifthedataislow-dimensional,butcontainsinvalidinstruments,onecanstillapplyProcedure1withoutanymodiﬁcationandstillobtainvalidconﬁdenceintervals.Ifthedataonlycontainsvalidinstruments,unrealisticinpractice,onecanstillapplyProcedure1,againwithoutanymodiﬁcationandstillobtainvalidconﬁdenceintervals.However,dependingonparticulardatasetsonemayhave,theprocedurecanbemodiﬁedforsimplicityandwediscussacoupleimportantcasesinSection3.2.Second,inKangetal.(2015),theauthorsprovidedanestimatorfor ⇤underaspecialcaseofoursetupwherealltheIVsarerelevant,i.e. ⇤j6=0forallj,butdidnotderive12Procedure1ConﬁdenceIntervalfor ⇤underInvalidIVswithHigh-DimensionalCon-foundersInput:OutcomeY,treatmentD,instrumentZ,covariatesX,signiﬁcancelevel↵STEP1:Estimatethecenter,b STEP1a:Computede-biasedscaledLassoestimatesofreduced-formparameters,e ande ,by(6)-(9)STEP1b:EstimatevalidIVs,eV,byestimatingeSande⇡[j]forj2eSin(10)-(12)STEP1c:CombineoutputsfromSTEP1aandSTEP1btoestimateb in(13)STEP2:Estimatethewidth(1+⌘0)z1 ↵/2qbV/nwithSTEP1a,STEP1b,and(14)STEP3:CombineSTEP1andSTEP2tocomputetheconﬁdenceintervalin(15)Output:1 ↵Conﬁdenceintervalfor ⇤conﬁdenceintervals.Weextendtheirworkbynotonlyprovidesanestimatorfor ⇤undermoregeneralsettings,butalsoprovidingrobustconﬁdenceintervalsunderthesegeneralsettings.3.2SpecialCasesWhileProcedure1providesageneralmethodtoconstructconﬁdenceintervalswithpossiblyinvalidIVsandmanycovariates,theprocedurecanbesimpliﬁeddependingonthedatasetsonemayhave.Wediscusstwospecialcasesinthissection;othercasesarealsodiscussedinSection1oftheSupplementaryMaterials.Theﬁrstcaseiswhenwehavelow-dimensionalcovariates(i.e.thesamplesizeexceedsthenumberofcovariates),butwedonotassumealltheIVsarevalid.Underthiscase,wecansimplyusetheordinaryleastsquare(OLS)estimatesforthereducedformsinsteadofthedebiasedscaledLassoestimatesinSTEP1aofProcedure1.Also,asaresultofusingOLSinSTEP1a,weneedtomodifySTEP1bslightlywherewereplacebu[j]from(8)withbu[j]=(W|W/n) 1j.,thejthrowoftheestimatedprecisionmatrixforW.STEP2willremainunchangedexceptforusingtheOLSestimatesofthenoisevariance.Finally,combiningSTEP1andSTEP2asbeforewouldresultinarobustconﬁdenceintervalfor ⇤.Thesecondcaseiswhenwehavehighdimensionalcovariates,butweassumeallthe13instrumentsarevalid.ThissetupwasconsideredinBellonietal.(2012);Chernozhukovetal.(2015);FanandLiao(2014);GautierandTsybakov(2011).Underthiscase,ourproceduredoesn’tchangeexceptinSTEP1bwhereeV=eSandtheresultingestimatorof ⇤isdenotedasb 0=Pj2eSe je jPj2eSe 2j.(16)Afterthismodiﬁcation,wecanproceedwithSTEP2andSTEP3toobtainanestimateoftheconﬁdenceintervalfor ⇤✓b 0 (1+⌘0)z1 ↵/2qbV0/n,b 0+(1+⌘0)z1 ↵/2qbV0/n◆.(17)Here,bV0isbVin(14)exceptwereplaceeV=eSandb withb 0.Insummary,themodiﬁcationscanbebroadlycategorizedintotwogeneralthemes,(i)thepresenceofallvalidinstrumentsand(ii)thepresenceoflowdimensionalcovariates.ThepresenceofallvalidinstrumentsreplacesSTEP1bbysettingeV=eS.Thepresenceoflow-dimensionalcovariatesswapsoutSTEP1awithOLSestimatesofthereducedformpa-rameters.Thesemodiﬁcationsstreamlineourprocedureforeasieruseinpractice.However,asmentionedbefore,onecansimplyusethegeneralProcedure1withoutanymodiﬁcationunderanyofthesecasestoobtainvalidconﬁdenceintervalsforthetreatmente↵ect.4TheoreticalResultsInthissection,weassessthepropertiesoftheconﬁdenceintervalproposedinProcedure1.Beforewebegin,weﬁrstmaketheusualregularityassumptionsinhighdimensionalinference(Bickeletal.,2009;B¨uhlmannandvandeGeer,2011;CaiandGuo,2016).(R1)(Sparsity):max{sz2,sz1,sx2,sx1}s.(R2)(Coherence):Wi.hasacovariancematrix⌃⇤where1/M1 min(⌃⇤) max(⌃⇤)M1forsomeconstantM1>1andhasboundedsub-Gaussiannorm.Assumption(R1)imposessparsityontheparameterssothatourproblemistractableinhighdimensions.Assumption(R2)placesaconditiononthespectrumofthedesignmatrix14WandthetaildistributionofWi,·,whichisrelatedtorestrictedeigenvalueconditioninBickeletal.(2009).Forsimplicity,wealsoassumethatthesub-GaussiannormofWi·isupperboundedbyM1,thatis,supv2Sp 1supq 1(E|v|Wi·|q/q)1qM1whereSp 1istheunitsphereinRp;seeVershynin(2012)fordetailsonsub-Gaussianrandomvariablesandbounds.Next,wemaketheusualregularityassumptionsthatareencounteredininstrumentalvariablesliteratureadjustedtodealwiththehighdimensionalityoftheproblem.(R3)(Exogeneity):Wi·isindependentoftheerrortermsin(4)and(5).(R4)(Normality):Theerrortermsin(4)and(5)followabivariatenormaldistribution.(R5)(GlobalIVStrength):TheIVsaregloballystrongwithk ⇤V⇤k2=qPj2V⇤ 2j   sz1logp/pn,whereV⇤isthesetofvalidinstrumentsdeﬁnedinDeﬁnition3.Assumption(R3)istheusualinstrumentalvariablesassumptionwhereweassumethatthecovariatesandtheIVsareexogenous(Wooldridge,2010).Assumption(R4)statesthattheerrorterms(ei1,✏i2),arebivariatenormals.Here,wetakethenormalerrorsassumptionasasimple,ﬁrst-stepapproachtoanalyzingthebehaviorsofourprocedure.Finally,Assumption(R5)isessentiallyamorepointedstatementaboutIVassumption(A1)wheretheglobalstrengthofinstruments,measuredbythe`2normof ⇤amongvalidIVsV⇤,isboundedawayfromzero;ifalltheIVsarevalid,thenk ⇤V⇤k2=k ⇤k2.Thisassumptionissatisﬁedby“stronginstrumentasymptotics”or“traditionalasymptotics”ininstrumentalvariables(Stocketal.,2002;Wooldridge,2010)whereweﬁxthenumberofinstrumentsandletngotoinﬁnity.ThisassumptionisalsosatisﬁedsolongasthereisatleastoneIVthathasaconstantnon-zeroe↵ectonthetreatment,oranon-zeroe↵ectthatdoesn’tdiminishwithsamplesize,whichwillholdinmostempiricalapplications.Overall,theregularityassumptions(R1)-(R5)arestandardintheusualhighdimensionalandtheinstrumentalvariablesliterature.Consequently,ifweonlyhavevalidinstrumentsanduseb 0in(16)fromourprocedure,onlyassumptions(R1)-(R5)areneededfortheconsistencyandasymptoticnormalityofb 0.ThisisformallystatedinTheorem1.15Theorem1.SupposewehavevalidIVs,thatis⇡⇤=0in(2),andtheassumptions(R1) (R5)hold.Thefollowingpropertyholdsfortheestimatorb 0,pn⇣b 0  ⇤⌘=T ⇤+  ⇤,(18)whereT ⇤|W⇠N(0,V0),V0=1/k ⇤k42⇥   Pj2S⇤ ⇤j1pnWbu[j]   22(⇥⇤11+( ⇤)2⇥⇤22 2 ⇤⇥⇤12)and  ⇤/pV0p!0aspsz1slogp/pn!0.Theorem1statesthat,whenweonlyhavevalidIVs,b 0deﬁnedin(16)isaconsistentestimatorofthetreatmente↵ectandthedominatingpartofthescaleddi↵erencepn(b 0  )isasymptoticallynormal.Basedontheasymptoticnormalityestablishedin(18),thefollowingtheoremjustiﬁesthecoveragepropertyoftheconﬁdenceintervalproposedin(17)undertheassumptionthatallinstrumentsarevalid.Theorem2.SupposewehavevalidIVs,thatis⇡⇤=0in(2)andtheassumptions(R1) (R5)hold.Assumingpsz1slogp/pn!0,theconﬁdenceintervalgivenin(17)hasasymptoticallycoverageprobability1 ↵,i.e.,P⇢ 2✓b 0 (1+⌘0)z1 ↵/2qbV0/n,b 0+(1+⌘0)z1 ↵/2qbV0/n◆ !1 ↵,(19)foranygivenpositiveconstant⌘0>0.Theorem2issimilartoaresultgiveninChernozhukovetal.(2015),whostudiedIVestimatorsinhighdimensionalregimewherealltheinstrumentsarevalid.However,therearesomenotabledi↵erencesbetweenourresultsandthoseinChernozhukovetal.(2015)wheredi↵erentsparsityandinstrument-covariatemodelingassumptionsarerequired.AsimulationstudyiscarriedoutinSection5tocompareourproceduretothatoftheoracle.Toanalyzeourprocedureinthecaseofinvalidinstruments,wemakethreeadditionalassumptionsthatarenotpartoftheusualinstrumentalvariablesliteratureandmaybeofinterestforfuturetheoreticalwork.Welabeltheseassumptionsas“IN”todenotethattheyarespeciﬁctothecaseofinvalidIVs.(IN1)(50%Rule)ThenumberofvalidIVsismorethanhalfofthenumberofindividuallystrongIVs,thatis|V⇤|>12|S⇤|.16(IN2)(IndividualIVStrength)AmongIVsinS⇤,wehaveminj2S⇤   ⇤j    min plogp/n.(IN3)(Strongviolation)AmongIVsinthesetS⇤\V⇤,wehaveminj2S⇤\V⇤    ⇡⇤j ⇤j     12(1+| ⇤|) minsM1logpzn min(⇥⇤).(20)Assumption(IN1)isthegeneralizationofthe50%ruleinKangetal.(2015)andHan(2008)todealwithhighdimensionalandredundantIVs.Inanutshell,(IN1)statesthatthenumberofinvalidinstrumentsisnottoolargesothatwecandetecttheinvalidIVsfromvalidIVs,withoutknowingaprioriwhichIVsarevalidorinvalid;seeKangetal.(2015)fordetails.Assumption(IN2)requiresindividualIVstrengthtobeboundedawayfromzeroby minsothatalltheIVsselectedineSarestrong.ThiscontrastswiththevalidIVcase,speciﬁcallyAssumption(R5),where(R5)onlyrequiredtheglobalIVstrengthtobeboundedawayfromzero.Finally,(IN3)requiresIVsthatviolateIVAssumptions(A2)and/or(A3),speciﬁcally⇡⇤j/ ⇤j,tobelargesothatwecancorrectlyidentifyIVsthatviolate(A2)and(A3).Overall,thecollectionofassumptions(IN1)-(IN3)allowsdetectionofeachvalidIVsbeyondthenoiselevelofthedata.Inparticular,(IN1)-(IN3)assuresthatSTEP1bofProcedure1hasahighprobabilityofcorrectlyselectingthevalidinstruments.Ifalltheinstrumentsarevalid,weavoidtheSTEP1bofProcedure1andthus,wedonotneedAssumptions(IN1),(IN2)and(IN3).Withtheaboveassumptions,Theorem3statesthatourgeneralProcedure1producesaconsistentandasymptoticnormalestimateof ⇤.Theorem3.Supposetheassumptions(R1) (R5)and(IN1) (IN2)hold.Aspsz1slogp/pn!0,withprobabilitylargerthan1 c(p c+exp( cn)),   b   ⇤   C1 minrlogpzn,(21)wherec,C>0areconstantsindependentofnandp.Inaddition,if(IN3)hold,wehavepn⇣b   ⇤⌘=T ⇤+  ⇤(22)whereT ⇤|W⇠N(0,V),V=1/k ⇤k42⇥   Pj2V⇤ ⇤j1pnWbu[j]   22(⇥⇤11+( ⇤)2⇥⇤22 2 ⇤⇥⇤12),and  ⇤/pVp!0aspsz1slogp/pn!0.17Theorem3showsthattheproposedestimatorb isaconsistentestimatorofthetreatmente↵ectandtheasymptoticnormalityholdsinthepresenceofinvalidinstruments.Theconsis-tencyofourestimator,speciﬁcally(21)inTheorem3,isestablishedunderrelativelyweakerassumptions.Forasymptoticnormality,Theorem3requiresAssumption(IN3),whichrulesoutinstrumentsthatweaklyviolateIVassumptions(A2)and(A3).InSection3.2oftheSup-plementaryMaterials,weexplorethenatureof(IN3),speciﬁcallywhether(IN3)isnecessaryforhonestcoverage,byvaryingthedegreeofinstrumentsthatviolatetheIVassumptions(A2)and(A3),someofwhichviolate(IN3).Also,theasymptoticnormalityfromTheorem3allowsustoshowthatourconﬁdenceinterval(15)hascorrectcoverageevenwithinvalidinstrumentsandhighdimensionalcovariates.Theorem4.Supposetheassumptions(R1) (R5)and(IN1) (IN3)hold.Aspsz1slogp/pn!0,theconﬁdenceintervalgivenin(15)hasasymptoticallycoverageprobability1 ↵,i.e.,P⇢ ⇤2✓b  (1+⌘0)z1 ↵/2qbV/n,b +(1+⌘0)z1 ↵/2qbV/n◆ !1 ↵,(23)foranygivenpositiveconstant⌘0>0.Wenotethatourconﬁdenceintervalfromthegeneralprocedureworkswellevenifalltheinstrumentsturnouttobevalid,butwedonotapriorimakethisassumption.Speciﬁcally,inSection5,weﬁndthattheconﬁdenceintervalproposedin(15)hasthecorrectcoverageandsimilaraveragelengthtotheoracleevenwhentheinstrumentsturnouttobevalid.5Simulation5.1SetupInadditiontothetheoreticalanalysisofourmethodinSection4,wealsoconductasim-ulationstudytoinvestigatetheperformanceofourmethodandothercomparators.Thedatageneratingprocessforthesimulationfollowsthemodels(2)and(3)inSection2.2withpz=100instrumentsandpx=150covariateswhereWi.isamultivariatenormalwithmeanzeroandcovariance⌃⇤ij=0.5|i j|for1i,j250.Theparametersforthemodelsare: ⇤=1, ⇤=(0.6,0.7,0.8,···,1.5,0,0,···,0)2R150sothatsx1=10,18 ⇤=(1.1,1.2,1.3,···,2.0,0,0,···,0)2R150sothatsx2=10,andvariance-covarianceoftheerrortermsareVar(✏i1)=Var(✏i2)=1.5,andCov(✏i1,✏i2)=0.75.InstrumentsthatsatisfyAssumption(A1)areS⇤={1,...,7}andinstrumentsthatsatisfyallthreeIVas-sumptions(A1)-(A3)areV⇤={1,2,3,4,5};thusinstruments6and7onlysatisfy(A1),butdonotsatisfy(A2)and(A3).Weﬁxthesevaluesthroughouttheentiresimulationstudy.Theparameterswevaryinthesimulationstudyare:thesamplesizen,thestrengthofIVsvia ⇤,andviolationsof(A2)and(A3)via⇡⇤.Forsamplesize,weletn=(100,200,300,1000,3000).ForIVstrength,weset ⇤V⇤=K(1,1,1,1,⇢1)and ⇤S⇤\V⇤=K(1,1)and (S⇤)C=0,wherewevaryK(tobediscussedlater)and⇢1=(0,0.1,0.2)acrosssimulations.ThevalueKcontrolstheglobalstrengthofinstruments,withhigher|K|in-dicatingstronginstrumentsinaglobalsense.Thevalue⇢1controlstherelativeindividualstrengthofinstrument,speciﬁcallybetweentheﬁrstfourinstrumentsinV⇤andtheﬁfthinstrument.Forexample,⇢1=0.2impliesthattheﬁfthIV’sindividualstrengthisonly20%oftheotherfourvalidinstruments,i.eIVs1to4.TospecifyKacrosssimulations,weintroduceaquantitywecalltheoracleconcentrationparameter(OCP)denotedasC( ,V⇤,n).C( ⇤,V⇤,n)=n ⇤|V⇤⇣⌃⇤V⇤V⇤ ⌃⇤V⇤(V⇤)C⌃⇤ 1(V⇤)C(V⇤)C⌃⇤(V⇤)CV⇤⌘ ⇤V⇤|V⇤|⇥⇤22,(24)where⌃⇤I,Jdenotesthesubmatrixcontaining⌃⇤ijfori2Iandj2Jand ⇤V⇤denotesthesubvectorcontaining ⇤jforj2V⇤.InSection3.1oftheSupplementaryMaterials,wediscusstheOCPanditsrelationtotheusualconcentrationparameterintheIVliteratureStockandWright(2000).Inshort,wedeﬁnetheOCPbecausetheusualconcentrationparametercanbemisleadingwhenthereareunknowninvalidinstrumentsandtheOCPservesasaproxyfortheusualconcentrationparameter.HavingdeﬁnedtheOCP,wecanspecifyKasafunctionofnandC( ⇤,V⇤,n).Speciﬁ-cally,ifnissetatabaselineof100andthesimulationparametersV⇤,⇢1,⌃⇤and⇥⇤22arespec-iﬁedasabove,wecanﬁndKforaparticularvalueoftheexpectedoracleconcentrationpa-rameterC( ⇤,V⇤,100).Thus,byvaryingC( ⇤,V⇤,100)=(50,100,150,200,250,500,1000),wevaryK.Finally,wevary⇡⇤,whichcontrolsthevalidityoftheIVsbydeﬁning⇡⇤j=⇢2 ⇤jfor19j=6,7and⇡⇤j=0forallotherjsothat⇢2controlsthemagnitudeoftheviolationofIVassumptions(A2)and(A3)fromthe6thand7thinstruments.Intheidealcase,wewouldhave⇢2=0sothatS⇤=V⇤={1,2,3,4,5,6,7}.But,⇢26=0impliesthatthelasttwoinstrumentsdonotsatisfy(A2)and(A3).Assuch,wevary⇡⇤byvarying⇢2=(0,1,2).Insummary,wevaryn,thestrengthofIVsvia ⇤,andviolationsof(A2)and(A3)via⇡⇤inoursimulationstudyandoursimulationarerepeated500times.Forhighdimensionalsimulationsettingsn⌧p,wecompareourproceduretob 0,whichassumesIVsarevalid.Forlowdimensionalsettingswheren p,weaddtwoadditionalcomparators,thetwo-stageleastsquares(2SLS)andOLS.2SLSisthemostpopularIVmethodwhereoneregressesDonZandX,andusesthepredictedvalueofDintheregressionofYonXandD.Notethatthewayweimplement2SLSmimicsmostpractitioners’useof2SLSbysimplyassumingalltheinstrumentsZarevalid.OLSisdeﬁnedaswhereoneregressesYonDandX.OLSwillbebiasedbecauseofconfoundingonD.Finally,forbothlowandhighdimensionalsettings,wehavetheoracle2SLSwhereanoracleprovidesuswiththetruesetofvalidIVs,whichwillnotoccurinpractice.5.2ResultsWepresentthemostrepresentativeresultsfromoursimulationstudy;allthesimulationsareinSection3.2oftheSupplementaryMaterials.First,Figure1considersthehighdimensionalsettingwithn=200andthreecomparators,ourprocedureb that’srobusttoinvalidIVs,ourprocedureb 0thatassumesallvalidIVs,andtheoracle2SLS.Columns“Weak”and“Strong”intheﬁgurerepresentcaseswhere⇢1=0.2and⇢1=0,respectively.Columns“Valid”and“Invalid”representcaseswhere⇢2=0and⇢2=2,respectively.Therow“MAE”intheﬁgurerepresentsthemedianabsoluteerroroftheestimators,whichmeasurestheperformanceofthepointestimators.Therow“Coverage”representsthecoverageperformanceoftheconﬁdenceintervals.Finally,therow“Length”representstheaveragelengthofconﬁdenceintervalsacrosssimulations.Bothestimatorsb andb 0performwellintermsofestimationaccuracy,coverageandlengthofconﬁdenceintervalsandhavesimilarperformancetothebenchmark,b oraclewhen20alltheinstrumentsarevalid(i.e.ﬁrstandsecondcolumnsofFigure1).Forexample,intheMAEandlengthplots,thesolidlines,whichrepresentourestimator,thedashedlines,whichrepresenttheourestimatorassumingallvalidIVs,andthedottedlines,whichrepresenttheoracle,overlapwitheachother.However,iftheinstrumentsareinvalid(i.e.thethirdandfourthcolumnsofFigure1),b 0isnotconsistentandlosescoverage,whichmakessensesinceb 0assumesalltheIVsarevalid.However,ourproposedestimatorb allowsforpossiblyinvalidinstrumentsandperformsaswellastheoracleintermsofestimationaccuracyandcoverage.Theaveragelengthofourrobustconﬁdenceintervalisonlyslightlylargerthanthatoftheoracle.Figure2representsthesamesettingasFigure1exceptwenowconsiderthelowdimen-sionalsettingwithn=1000.Asexpected,theestimatorsb andb 0alongwiththetraditional2SLSestimatorperformsimilarlytotheoraclebenchmarkintermsofestimationaccuracy,coverageandthelengthofconﬁdenceintervalswhenalltheinstrumentsareactuallyvalid.Forexample,intheMAEplotofFigure2,thesolid,dashed,greenanddottedlines,rep-resentingb ,b 0,2SLSandtheoracle,respectively,overlapwitheachother.NotethatOLScannotdealwithconfoundingandhence,producesabiasedestimate.However,whentheinstrumentsareinvalid,thetraditional2SLSestimatorandb 0arebiasedandfailtohavethecorrectcoverage.Incontrast,theproposedestimatorb performsaswellastheoracleestimatorintermsofestimationaccuracyandcoverage,withthelengthoftheproposedes-timatorbeingslightlylongerthanthatfortheoracle.Weshouldalsostressthatthroughoutbothﬁgures,ourproposedestimatorb performssimilarlyforindividuallyweakandstrongIVs(i.e.fordi↵erent⇢1s).Thisprovidesempiricalsupportthattheproposedestimatorisnottoosensitivetotheindividualinstrumentstrengthassumption(IN2)requiredinthetheoreticalanalysis.6DataAnalysisTodemonstrateourprocedure1inrealsettings,weanalyzethecausale↵ectofyearsofeducationonyearlyearnings,whichhasbeenstudiedextensivelyineconomicsusingIVmethods(AngristandKrueger,1991;Card,1993,1999).ThedatacomesfromtheWis-210.000.140.280.420.560.70MAEValid & WeakProposed(β^)Proposed.Valid(β^0)Oracle0.00.20.40.60.81.0Coverage20040060080010000.000.060.120.180.240.30LengthValid & Strong2004006008001000ConcentrationInvalid & Weak2004006008001000 ParameterInvalid & Strong2004006008001000Figure1:Comparisonofdi↵erentmethodswhenn=200.Thex-axisrepresentstheconcentrationparameter.Onthey-axis,MAErepresentsMedianAbsoluteErroroftheestimators,Coveragerep-resentscoverageoftheconﬁdenceintervalsandLengthrepresentstheaveragelengthofconﬁdenceintervals.ProposedisourmethodallowingforinvalidIVsandisrepresentedbythesolidline.Proposed.validisourmethodthatassumesalltheIVsarevalidandisrepresentedbythedashedline.Oracleisthemethodthatknowsexactlywhichinstrumentsarevalidandisrepresentedbythedottedline.ThecolumnlabeledwithValid&Weakrepresentsthecase⇢1=0.2and⇢2=0.ThecolumnlabeledwithValid&Strongrepresentsthecase⇢1=0and⇢2=0.ThecolumnlabeledwithInvalid&Weakrepresentsthecase⇢1=0.2and⇢2=2.Finally,thecolumnlabeledwithInvalid&Strongrepresentsthecase⇢1=0and⇢2=2.22MAE0.000.140.280.420.560.70MAEValid & WeakProposed(β^)Proposed.Valid(β^0)OracleOLS2SLS0.00.20.40.60.81.0Coverage20040060080010000.000.060.120.180.240.30LengthMAEValid & Strong2004006008001000ConcentrationMAEInvalid & Weak2004006008001000 ParameterMAEInvalid & Strong2004006008001000Figure2:Comparisonofdi↵erentmethodswhenn=1000.Thex-axisrepresentstheconcentrationparameter.Onthey-axis,MAErepresentsMedianAbsoluteErroroftheestimators,CoveragerepresentscoverageofconﬁdenceintervalsandLengthrepresentstheaveragelengthofconﬁdenceintervals.ProposedisourmethodallowingforinvalidIVsandisrepresentedbythesolidline.Proposed.validisourmethodthatassumesalltheIVsarevalidandisrepresentedbythedashedline.Oracleisthemethodthatknowsexactlywhichinstrumentsarevalidandisrepresentedbythedottedline.ThecolumnlabeledwithValid&Weakrepresentsthecase⇢1=0.2and⇢2=0.ThecolumnlabeledwithValid&Strongrepresentsthecase⇢1=0and⇢2=0.ThecolumnlabeledwithInvalid&Weakrepresentsthecase⇢1=0.2and⇢2=2.Finally,thecolumnlabeledwithInvalid&Strongrepresentsthecase⇢1=0and⇢2=2.23consinLongitudinalStudy(WLS),alongitudinalstudythathaskepttrackofAmericanhighschoolgraduatesfromWisconsinsince1957,andweexaminetherelationshipbetweengraduates’earningsandeducationfromthe1974surveyHauser(2005),roughly20yearsaftertheygraduatedfromhighschool.OuranalysisincludesN=3772individuals,1784malesand1988females.Forouroutcome,weuseimputedlogtotalyearlyearningsandforthetreatment,weusethetotalyearsofeducation,allfromthe1974survey.Themediantotalearningsis$9,200witha25%quartileof$1,000anda75%quartileof$15,320in1974dollars.Themeanyearsoftotaleducationis13.7yearswithastandarddeviationof2.3years.Weincorporatemanycovariates,includingsex,graduate’shometownpopulation,educa-tionalattainmentofgraduates’parents,graduates’familyincome,relativeincomeingradu-ates’hometown,graduates’highschooldenomination,highschoolclasssize,allmeasuredin1957whentheparticipantswerehighschoolseniors.Wealsoinclude81geneticcovariates,speciﬁcallysinglenucleotidepolymorphisms(SNPs),thatwerepartofWLStofurthercon-trolforpotentialvariationsbetweengraduates;seeSection2inSupplementaryMaterialsfordetailsonthenon-geneticandgeneticcovariates.Insummary,ourdataanalysisincludes7non-geneticcovariatesand81geneticcovariates.Weusedﬁveinstrumentsinouranalysis,allderivedfrompaststudiesofeducationonearnings(Blundelletal.,2005;Card,1993;Gary-Boboetal.,2006).Theyare(i)totalnumberofsisters,(ii)totalnumberofbrothers,(iii)individual’sbirthorderinthefamily,allfromGary-Boboetal.(2006),(iv)proximitytocollegefromCard(1993),and(v)teacher’sinterestinindividual’scollegeeducationfromBlundelletal.(2005),allmeasuredin1957.AlthoughalltheseIVshavebeensuggestedtobevalidwithvaryingexplanationsastowhytheysatisfy(A2)and(A3)aftercontrollingfortheaforementionedcovariates,inpractice,wearealwaysuncertainduetothelackofcompletesocioeconomicknowledgeaboutthee↵ectoftheseIVs.OurmethodshouldprovidesomeprotectionagainstthisuncertaintycomparedtotraditionalmethodswheretheysimplyassumethatallﬁveIVsarevalid.Also,theﬁrst-stageF-testproducesanF-statisticof90.3withap-valuelessthan10 16,whichindicatesverystrongsetofinstruments.Formoredetailsontheinstruments,seeSection2oftheSupplementaryMaterials.24Table1summarizestheresultsofourdataanalysis.OLSreferstorunningaregressionofthetreatmentandthecovariatesontheoutcomeandlookingattheslopecoe cientofthetreatmentvariable.2SLSreferstorunningtwo-stageleastsquaresasdescribedinSection5undertheoperatingassumptionthatalltheﬁveinstrumentsarevalid;thisistheusualandmostpopularanalysisintheIVliterature.Finally,werunthePocedure1.MethodPointEstimate95%ConﬁdenceIntervalOLS0.097(0.051,0.143)2SLS0.169(0.029,0.301)OurMethod0.062(0.046,0.077)Table1:EstimatesoftheE↵ectofYearsofEducationonLogEarnings.OLSisordinaryleastsquares,2SLSistwo-stageleastsquares,andourmethodisProcedure1.TheOLSestimatesuggestsapositiveassociationbetweeneducationandearnings,withstatisticallysigniﬁcantresultat↵=0.05level.ThisagreeswithpreviousliteraturewhichsuggestsastatisticallysigniﬁcantpositiveassociationbetweenyearsofeducationandlogearningsCard(1999).However,OLSdoesnotcompletelycontrolforconfoundingevenaftercontrollingforcovariates.2SLSprovidesanalternativemethodofcontrollingforconfoundingbyusinginstrumentssolongasalltheinstrumentssatisfythethreecoreassumptionsandtheinclusionofcovariateshelpsmaketheseassumptionsmoreplausible.Unfortunately,wenoticethatthe2SLSestimateinTable1isinconsistentwithpreviousstudies’estimatesamongindividualsfromtheU.S.between1950sto1970s,whichrangefrom0.06to0.13(seeTable4inCard(1999)).Ourmethod,whichaddressestheconcernforinvalidinstrumentswith2SLS,providesanestimateof0.062,whichismoreconsistentwithpreviousstudies’estimatesofthee↵ectofyearsofeducationonearnings.ThedataanalysissuggeststhatourmethodcanbeausefultoolinIVanalysiswhenthereisconcernforinvalidinstruments,evenafterattemptingtomitigatethisproblemviacovariates.Ourmethodprovidesmuchmoreaccurateestimatesofthereturnsoneducationthan2SLS,whichnaivelyassumesalltheinstrumentsarevalid.257DiscussionInspiredbylargeobservationaldata,wepresentamethodtoestimatethee↵ectofthetreatmentontheoutcomeusinginstrumentalvariableswherewedonotmaketheassumptionthatalltheinstrumentsarevalid.Ourapproachdi↵ersfrommanyinstrumentalvariablesapproachesinthatitallowsforpossiblyinvalidinstrumentsevenafterconditioningonmany,possiblyhighdimensional,covariates.OurapproachprovidesrobustconﬁdenceintervalsinthepresenceofinvalidIVsevenaftercontrollingformanycovariates.Insimulationandinrealdatasettings,ourapproachprovidesamorerobustanalysisthanthetraditionalIVapproaches,mostnotably2SLS,byprovidingsomeprotectionagainstpossiblyinvalidinstruments.SUPPLEMENTARYMATERIALTitle:Supplementto“ConﬁdenceIntervalforCausalE↵ectswithPossiblyInvalidInstru-mentsEvenAfterControllingforManyConfounders”.(.pdfﬁle)ReferencesJoshuaDAngristandAlanBKrueger.Doescompulsoryschoolattendancea↵ectschoolingandearnings?QuarterlyJournalofEconomics,106(4):979–1014,1991.JoshuaD.Angrist,GuidoW.Imbens,andDonaldB.Rubin.Identiﬁcationofcausale↵ectsusinginstrumentalvariables.JournaloftheAmericanStatisticalAssociation,91(434):444–455,1996.MichaelBaiocchi,JingCheng,andDylanS.Small.Instrumentalvariablemethodsforcausalinference.StatisticsinMedicine,33(13):2297–2340,2014.A.Belloni,D.Chen,V.Chernozhukov,andC.Hansen.Sparsemodelsandmethodsforoptimalinstrumentswithanapplicationtoeminentdomain.Econometrica,80(6):2369–2429,2012.26PeterJBickel,Ya’acovRitov,andAlexandreBTsybakov.Simultaneousanalysisoflassoanddantzigselector.TheAnnalsofStatistics,37(4):1705–1732,2009.RichardBlundell,LorraineDearden,andBarbaraSianesi.Evaluatingthee↵ectofeducationonearnings:models,methodsandresultsfromthenationalchilddevelopmentsurvey.JournaloftheRoyalStatisticalSociety:SeriesA(StatisticsinSociety),168(3):473–512,2005.PeterB¨uhlmannandSaravandeGeer.Statisticsforhigh-dimensionaldata:methods,theoryandapplications.Springer,2011.TTonyCaiandZijianGuo.Conﬁdenceintervalsforhigh-dimensionallinearregression:Minimaxratesandadaptivity.TheAnnalsofstatistics,Toappear,2016.DavidCard.Usinggeographicvariationincollegeproximitytoestimatethereturntoschooling.WorkingPaper4483,NationalBureauofEconomicResearch,October1993.DavidCard.Chapter30-thecausale↵ectofeducationonearnings.InOrleyC.AshenfelterandDavidCard,editors,HandbookofLaborEconomics,volume3,PartA,pages1801–1863.Elsevier,1999.XuChengandZhipengLiao.Selectthevalidandrelevantmoments:Aninformation-basedlassoforgmmwithmanymoments.JournalofEconometrics,186(2):443–464,2015.VictorChernozhukov,ChristianHansen,andMartinSpindler.Post-selectionandpost-regularizationinferenceinlinearmodelswithmanycontrolsandinstruments.2015.JianqingFanandYuanLiao.Endogeneityinhighdimensions.Annalsofstatistics,42(3):872,2014.RobertGary-Bobo,NathaliePicard,andAnaPrieto.Birthorderandsibshipsexcompositionasinstrumentsinthestudyofeducationandearnings.CEPRDiscussionPapers5514,C.E.P.R.DiscussionPapers,2006.EricGautierandAlexandreB.Tsybakov.High-dimensionalinstrumentalvariablesregressionandconﬁdencesets.arXivpreprintarXiv:1105.2454,2011.27ChirokHan.Detectinginvalidinstrumentsusingl1-gmm.EconomicsLetters,101(3):285–287,2008.RobertM.Hauser.Surveyresponseinthelongrun:Thewisconsinlongitudinalstudy.FieldMethods,17(1):3–29,2005.PamelaHerd,DeborahCarr,andCarolRoan.Cohortproﬁle:Wisconsinlongitudinalstudy(wls).InternationalJournalofEpidemiology,43(1):34–41,2014.MiguelA.Hern´anandJamesM.Robins.Instrumentsforcausalinference:Anepidemiolo-gist’sdream?Epidemiology,17(4):360–372,2006.PaulW.Holland.Causalinference,pathanalysis,andrecursivestructuralequationsmodels.SociologicalMethodology,18(1):449–484,1988.AdelJavanmardandAndreaMontanari.Conﬁdenceintervalsandhypothesistestingforhigh-dimensionalregression.TheJournalofMachineLearningResearch,15(1):2869–2909,2014.HyunseungKang,AnruZhang,TTonyCai,andDylanSSmall.Instrumentalvariablesestimationwithsomeinvalidinstrumentsanditsapplicationtomendelianrandomization.JournaloftheAmericanStatisticalAssociation,Toappear,2015.MichalKoles´ar,RajChetty,JohnN.Friedman,EdwardL.Glaeser,andGuidoW.Im-bens.Identiﬁcationandinferencewithmanyinvalidinstruments.JournalofBusiness&EconomicStatistics,33(4):474–484,2015.JerzyNeyman.Ontheapplicationofprobabilitytheorytoagriculturalexperiments.essayonprinciples.section9.StatisticalScience,5(4):465–472,1923.DonaldB.Rubin.Estimatingcausale↵ectsoftreatmentsinrandomizedandnonrandomizedstudies.JournalofEducationalPsychology,66(5):688,1974.DylanS.Small.Sensitivityanalysisforinstrumentalvariablesregressionwithoveridentifyingrestrictions.JournaloftheAmericanStatisticalAssociation,102(479):1049–1058,2007.28JamesHStockandJonathanHWright.Gmmwithweakidentiﬁcation.Econometrica,pages1055–1096,2000.JamesH.Stock,JonathanH.Wright,andMotohiroYogo.Asurveyofweakinstrumentsandweakidentiﬁcationingeneralizedmethodofmoments.JournalofBusiness&EconomicStatistics,20(4),2002.TingniSunandCun-HuiZhang.Scaledsparselinearregression.Biometrika,101(2):269–284,2012.SaravandeGeer,PeterB¨uhlmann,YaacovRitov,andRubenDezeure.Onasymptoticallyoptimalconﬁdenceregionsandtestsforhigh-dimensionalmodels.TheAnnalsofStatistics,42(3):1166–1202,2014.RomanVershynin.Introductiontothenon-asymptoticanalysisofrandommatrices.InYoninaEldarandGittaKutyniok,editors,CompressedSensing:TheoryandApplications,pages210–268.CambridgeUniversityPress,2012.MichaelW.Weiner,DallasP.Veitch,PaulS.Aisen,LaurelA.Beckett,NigelJ.Cairns,JesseCedarbaum,MichaelC.Donohue,RobertC.Green,DanielleHarvey,Cli↵ordR.JackJr.,WilliamJagust,JohnC.Morris,RonaldC.Petersen,AndrewJ.Saykin,LeslieShaw,PaulM.Thompson,ArthurW.Toga,andJohnQ.Trojanowski.Impactofthealzheimer’sdiseaseneuroimaginginitiative,2004to2014.Alzheimer’s&Dementia,11(7):865–884,2015.ISSN1552-5260.Je↵reyM.Wooldridge.EconometricAnalysisofCrossSectionandPanelData.MITpress,2nded.edition,2010.Cun-HuiZhangandStephanieSZhang.Conﬁdenceintervalsforlowdimensionalparametersinhighdimensionallinearmodels.JournaloftheRoyalStatisticalSociety:SeriesB(StatisticalMethodology),76(1):217–242,2014.29