Draft version March 18, 2016
Preprint typeset using LATEX style emulateapj v. 5/2/11

6
1
0
2

 
r
a

M
9

 

.

 
 
]
E
H
h
p
-
o
r
t
s
a
[
 
 

1
v
8
0
5
5
0

.

3
0
6
1
:
v
i
X
r
a

LOCAL SIMULATIONS OF INSTABILITIES DRIVEN BY COMPOSITION GRADIENTS IN THE ICM

Niels Bohr International Academy, Niels Bohr Institute, Blegdamsvej 17, DK-2100 Copenhagen Ø, Denmark; berlok@nbi.dk,mpessah@nbi.dk

Thomas Berlok and Martin E. Pessah

Draft version March 18, 2016

ABSTRACT

The distribution of Helium in the intracluster medium (ICM) permeating galaxy clusters is not well con-
strained due to the very high plasma temperature. Therefore, the plasma is often assumed to be homogeneous.
A non-uniform Helium distribution can however lead to biases when measuring key cluster parameters. This
has motivated one-dimensional models that evolve the ICM composition assuming that the eﬀects of magnetic
ﬁelds can be parameterized or ignored. Such models for non-isothermal clusters show that Helium can sediment
in the cluster core leading to a peak in concentration oﬀset from the cluster center. The resulting proﬁles have
recently been shown to be linearly unstable when the weakly-collisional character of the magnetized plasma is
considered. In this paper, we present a modiﬁed version of the MHD code Athena, which makes it possible to
evolve a weakly-collisional plasma subject to a gravitational ﬁeld and stratiﬁed in both temperature and com-
position. We thoroughly test our implementation and conﬁrm excellent agreement against several analytical
results. In order to isolate the eﬀects of composition, in this initial study we focus our attention on isothermal
plasmas. We show that plasma instabilities, feeding oﬀ gradients in composition, can induce turbulent mixing
and saturate by re-arranging magnetic ﬁeld lines and alleviating the composition gradient. Composition proﬁles
that increase with radius lead to instabilities that saturate by driving the average magnetic ﬁeld inclination to
roughly 45◦. We speculate that this eﬀect may alleviate the core insulation observed in homogeneous settings,
with potential consequences for the associated cooling ﬂow problem.
Subject headings: galaxies: clusters: intracluster medium — instabilities — magnetohydrodynamics — diﬀu-

sion

1. INTRODUCTION

Atmospheres comprised of a plasma that is weakly col-
lisional and weakly magnetized have stability properties
that diﬀer qualitatively from collisional atmospheres.
In-
stabilities such as the magneto-thermal instability (MTI,
Balbus 2000, 2001) and the Heat-Flux-driven Buoyancy
Instability (HBI, Quataert 2008) can arise when there is a
gradient in the temperature either parallel or anti-parallel to
the gravitational ﬁeld. These instabilities, that feed oﬀ a gra-
dient in temperature, have been extensively studied (Balbus
2000, 2001; Quataert 2008; Kunz 2011; Latter & Kunz
2012; Parrish & Stone 2005, 2007; Parrish & Quataert
2008; Parrish et al. 2008, 2009; Bogdanovi´c et al. 2009;
Parrish et al. 2010; Ruszkowski & Oh 2010; McCourt et al.
2011, 2012; Kunz et al. 2012; Parrish et al. 2012a,b) and
they are believed to be important for the understanding of
the dynamical evolution of the intracluster medium (ICM) of
galaxy clusters.

These studies assumed that the composition of the plasma
is uniform, an assumption which might not be appropriate if
heavier elements are able to sediment towards the core of the
cluster (Fabian & Pringle 1977). In parallel and complemen-
tary studies, the long-term evolution of the radial distribution
of elements has been studied using one-dimensional
1977; Gilfanov & Syunyaev
models
1984; Chuzhoy & Nusser 2003; Chuzhoy & Loeb 2004;
Peng & Nagai 2009; Shtykovskiy & Gilfanov 2010). The en-
suing non-uniform composition has been argued to introduce
biases in cluster properties as inferred from observations
(Markevitch 2007; Peng & Nagai 2009).

(Fabian & Pringle

While the studies of the MTI and HBI assumed a uni-
form plasma the sedimentation models have yet to include
magnetic ﬁelds.
In an attempt to bridge the gap between

the diﬀerent approaches, and with the goal of understand-
ing the long-term evolution of the composition of the ICM,
Pessah & Chakraborty (2013) studied the stability properties
of weakly collisional atmospheres with gradients in both
temperature and composition. They found that gradients in
composition, either parallel or anti-parallel to the gravita-
tional ﬁeld, can trigger instabilities. In a subsequent study,
Berlok & Pessah (2015) carried out a comprehensive study
using linear mode analysis and showed that these instabilities
are expected to render the composition proﬁles obtained with
current sedimentation models unstable, as they illustrated us-
ing the model of Peng & Nagai (2009).

In this paper, we present the ﬁrst nonlinear numerical sim-
ulations of the instabilities that feed oﬀ a gradient in com-
position using a modiﬁed version of the MHD code Athena
(Stone et al. 2008). The instabilities considered are i) the
Magneto-Thermo-Compositional Instability (MTCI) which is
maximally unstable when the magnetic ﬁeld is perpendic-
ular to gravity ii) the Heat- and Particle-ﬂux-driven Buoy-
ancy Instability (HPBI) which is maximally unstable when
the magnetic ﬁeld is parallel to gravity and iii) the diﬀu-
sion modes which are maximally unstable when the mag-
netic ﬁeld is parallel to gravity. The MTCI and HPBI will
be present in isothermal atmospheres in which the compo-
sition increases with height while diﬀusion modes can be
present regardless of the direction of the gradient in composi-
tion (Pessah & Chakraborty 2013). The linear dispersion rela-
tion presented in Berlok & Pessah (2015) is used to compare
with the linear evolution of the simulations. We ﬁnd good
agreement thereby conﬁrming both the linear theory and our
numerical method. For the nonlinear evolution of the instabil-
ities we ﬁnd that the magnetic ﬁeld inclination goes to roughly
45◦ independently of whether the magnetic ﬁeld is initially
horizontal (MTCI) or vertical (HPBI). This is contrary to the

2

Berlok & Pessah

instabilities driven by temperature gradients where the aver-
age magnetic ﬁeld becomes almost vertical (horizontal) for an
initially horizontal (vertical) magnetic ﬁeld (Parrish & Stone
2005; Parrish & Quataert 2008). The simple explanation is
that the MTCI and HPBI, both of which grow when the the
composition increases with height, can operate simultane-
ously. They are therefore driving the average angle in op-
posite directions, compromising at roughly 45◦. The MTI and
HBI, being dependent on temperature gradients in opposite
directions, cannot grow at the same time and so they grow un-
abated by their counterpart. We also ﬁnd that both types of
instabilities cause turbulent mixing of the Helium concentra-
tion. We conclude that, in the idealized numerical settings that
we employ, instabilities driven by the free energy supplied by
a gradient in composition saturate by alleviating the gradient
and thereby removing the source of free energy.

The rest of the paper is organized as follows: We start
out by introducing the equations of kinetic MHD in Sec-
tion 2 and how they can be solved numerically in Section 3.
In section 4 we demonstrate that the simulations agree with
the linear theory for isothermal atmospheres and we illustrate
how the growth rates depend on some of the key parameters
of the problem. We also use atmospheres with gradients in
both temperature and composition, motivated by the model
of Peng & Nagai (2009) and discussed in Berlok & Pessah
(2015), to show that the theory and simulations also agree
with both gradients present.
In Section 5, we consider the
nonlinear evolution of the MTCI and HPBI in isothermal at-
mospheres in order to determine how they saturate. We sum-
marize and outline future work in Section 6.

2. KINETIC MHD FOR A BINARY MIXTURE

We consider a fully ionized, weakly magnetized, and
weakly collisional plasma consisting of a mixture of Hydro-
gen and Helium. We model such a plasma using the set of
equations introduced in Pessah & Chakraborty (2013)1

∂ρ
∂t

+ ∇·(ρu) = 0 ,
B2
4π

(1)

∂ (ρu)

∂t

+ ∇· ρuu + PTI −

∂E
∂t

+ ∇·"(E + PT) u −

B (B · u)

4π

ˆbˆb! =−∇·Π + ρg,
# =−∇·Qs − ∇· (Π·u) + ρg · u ,

(2)

∂B
∂t

=∇ × (u × B) ,

+ ∇·(cρu) =−∇·Qc .

∂ (cρ)

∂t

(3)

(4)

(5)

In these equations ρ is the mass density, u is the ﬂuid velocity,
B is the magnetic ﬁeld with direction ˆb = (bx, 0, bz), g =
(0, 0, −g) is the gravitational acceleration and I is the identity
matrix. The total pressure is PT = P + B2/8π where P is the
thermal pressure and the total energy density, E, is

E =

1
2

ρv2 +

B2
8π

+

P
γ − 1

where γ = 5/3 is the adiabatic index.

,

(6)

1 For further details on the kinetic MHD approximation and its limitations
see the relevant discussions in Kunz et al. (2012); Schekochihin et al. (2005);
Pessah & Chakraborty (2013) and references therein.

The composition of the plasma, c, is deﬁned to be the ratio

of the Helium density to the total gas density

c ≡

ρHe

ρH + ρHe

=

ρHe
ρ

,

and the associated mean molecular weight, µ, is given by

(7)

(8)

µ =

4

,

8 − 5c

for a completely ionized plasma consisting of Helium and Hy-
drogen. The mean molecular weight can modify the dynamics
of the plasma through the equation of state

P =

ρkBT
µmH

,

(9)

where kB is Boltzmann’s constant, T is the temperature and
mH is the proton mass.

We consider the plasma to be inﬂuenced by three dif-
ferent non-ideal eﬀects: Braginskii viscosity, which arises
due to diﬀerences in pressure parallel (p
) and perpendicular
) to the magnetic ﬁeld, described by the viscosity tensor
(p
(Braginskii 1965)

⊥

k

Π = −3ρνk  ˆbˆb −

1
3

I!  ˆbˆb −

1
3

I! :∇u ,

(10)

anisotropic heat conduction described by the heat ﬂux (Spitzer
1962; Braginskii 1965)

Qs = −χk

ˆbˆb · ∇T,
(11)
and anisotropic diﬀusion of composition described by the
composition ﬂux (Bahcall & Loeb 1990)
Qc = −Dˆb ˆb · ∇c .

(12)
), heat
The transport coeﬃcients for Braginskii viscosity (νk
) and diﬀusion of composition (D) de-
conductivity (χk
pend on the temperature, density and composition of the
plasma. The dependences are given by Equations (B6)-(B8)
in Berlok & Pessah (2015). Finally, we deﬁne the thermal ve-

2v2

locity, vth = pP/ρ and the plasma-β given by β = 8πP/B2 =
th/v2

A, where vA = B/p4πρ is the Alfv´en velocity2.

3. NUMERICAL METHOD AND INITIAL CONDITIONS

The equations of kinetic MHD, Equation (1)-(5), are solved
using a modiﬁed version of the conservative MHD code
Athena (Stone et al. 2008). The algorithms used in Athena
are described in Gardiner & Stone (2005); Stone & Gardiner
(2009) and a description of the implementation of anisotropic
thermal conduction and Braginskii viscosity can be found
in Parrish & Stone (2005) and Parrish et al. (2012a), respec-
tively.

In order to carry out the numerical simulations of inter-
est, we have modiﬁed Athena to include a spatially varying
mean molecular weight, µ. This is done by using the in-
built method for adding a passive scalar, deﬁned by a spa-
tially varying concentration, c, and then making it active by
using the value of c when calculating the temperature used in
the heat conduction module. Furthermore, we implemented a
module which takes account of diﬀusion of Helium by using
operator splitting. This module has been built by following

2 Note that this deﬁnition of β diﬀers from the one in Berlok & Pessah

(2015) by a factor of 2.

Local Simulations of Instabilities Driven by Composition Gradients in the ICM

3

the same approach employed in the heat conduction module
that is already present in the current publicly available version
of Athena (Parrish & Stone 2005; Sharma & Hammett 2007).
Our implementation allows for non-constant values of the pa-
, and D through user-deﬁned functions This
rameters νk
feature is, however, not used in this work, as we employ a
local approximation and thus treat these parameters as con-
stants. The time-step constraint on viscosity, thermal conduc-
tion, and diﬀusion of Helium can be very restrictive. In order
to circumvent this we use subcycling, which we limit to a
maximum of ten steps per MHD step (Kunz et al. 2012).

, χk

3.1. Plane-parallel atmosphere with gradients in

temperature and composition

In this section, we introduce the two diﬀerent atmospheres
used as initial conditions in the simulations. The atmospheres
considered are plane-parallel, i.e., all quantities are constant
along a horizontal slice, perpendicular to gravity. The atmo-
sphere is assumed to be composed of an ideal gas, charac-
terized by the equation of state given by Equation (9), and is
assumed to be in hydrostatic equilibrium, i.e.,3

Both conditions are trivially satisﬁed if bz = 0 and D = 0. If,
however, bz , 0 and D , 0, these requirements can still be
met by simple atmospheric models if χk
and D do not depend
on z. Such an assumption is reasonable for the local simula-
tions that we will consider, where the height of the box, Lz,
satisﬁes the criterion Lz ≪ H0. When there is both a gradient
in temperature T and mean molecular weight µ, the require-
ments that ∇·Qs = 0 and ∇·Qc = 0 can be integrated to yield
(19)
(20)
where sT = (TZ−T0)/LZ and sc = (cZ−c0)/Lz are the constant
slopes in temperature and composition. Here, T0 (TZ) is the
temperature at the bottom (top) of the box and c0 (cZ) is the
Helium mass concentration at the bottom (top) of the box.

T (z) = T0 + sTz ,
c(z) = c0 + scz ,

The pressure is found by solving Equation (13), leading to

P(z) = P0  T (z)µ(z)

T0µ0

!α

,

(21)

where µ(z) is related to c(z) by Equation (8) and the constant
α is given by

∂P
∂z

= −gρ .

(13)

α = −

T0
H0

4

4sT + 5µ0T0sc

.

(22)

3.1.1. Isothermal Atmosphere with a Composition Gradient in the

Absence of Particle Diﬀusion

The simplest atmosphere we use is inspired by the origi-
nal numerical work on the MTI (Parrish & Stone 2005). We
consider an isothermal atmosphere with T = T0 and

P = P0 1 −
µ = µ0 1 −

z

3H0!3
3H0!−1

z

,

.

(14)

(15)

where P0, T0, and µ0 are the values of the pressure, tempera-
ture, and mean molecular weight at z = 0, and H0 is the scale
height

H0 =

kBT0
µ0mHg

.

(16)

The density can be determined using Equation (9).

This isothermal atmosphere is used for simulations of the
linear regime of the MTCI in Section 4.1 and the linear regime
of the HPBI in Section 4.2. It is also used for simulations of
the nonlinear regime of the MTCI and HPBI in Section 5. The
magnetic ﬁeld can have any orientation as long as D = 0. The
structure of this atmosphere is however not in equilibrium if
D , 0 and bz , 0. In that case, we will have to use a more
sophisticated atmosphere which we introduce next.

3.1.2. Atmosphere with Thermal and Composition Gradients

Steady state requires that the divergence of the heat and par-

ticle ﬂuxes vanish, i.e.,

∇·Qs = 0 ,
∇·Qc = 0 ,

(17)
(18)

3 We consider high-β plasmas and do not include the magnetic pressure in

the derivations of the equilibria.

This solution for the pressure proﬁle of the atmosphere
is replaced with a simple exponential atmosphere, P(z) =
P0 exp(−z/H0), with scale height H0 if sT = sc = 0.
We use this model atmosphere to perform simulations of
modes driven by diﬀusion in Section 4.3. These modes are
unstable when there is a vertical gradient in composition, a
non-zero vertical component of the magnetic ﬁeld, bz , 0,
and anisotropic diﬀusion of Helium, D , 0. We also use this
atmosphere in Section 4.4 for simulations of the linear regime
of the MTCI and the HBPI with gradients in both temperature
and composition.

3.2. Boundary conditions

Periodic boundary conditions are used in the horizontal di-
rection in all simulations. In the vertical direction we have
implemented two diﬀerent sets of boundary conditions i) the
conventional reﬂective boundary conditions and ii) a set of
boundary conditions that we will call quasi-periodic boundary
conditions. Both sets of boundary conditions are explained in
detail in Appendix B. Here, we give a brief account of the mo-
tivation for using these two sets of boundary conditions and
their key diﬀerences.

The quasi-periodic boundary conditions are periodic in the
relative changes in the physical quantities. We have found
that these boundary conditions are a necessity in order for
the simulations to reproduce the growth rates predicted by
the local linear mode analysis. We believe that this is due to
the assumption of periodicity in the perturbed quantities that
is made when the dispersion relation is derived. This prob-
lem has also been encountered in previous studies of the MTI
(Rasera & Chandran 2008). These boundary conditions are
used in all simulations presented in Section 4.

The reﬂective boundary conditions maintain hydrostatic
equilibrium by extrapolating pressure and density into the
ghost zones at the top and bottom of the computational do-
main. The values of temperature and composition are held
ﬁxed at their initial values in the ghost-zones. The veloc-
ity z-component is reﬂected symmetrically around the bound-
aries. If the magnetic ﬁeld is initially vertical (horizontal) it is

4

Berlok & Pessah

forced to remain vertical (horizontal) at the boundaries. These
boundary conditions are used in the simulations presented in
Section 5.

4. SIMULATIONS OF THE LINEAR REGIME

The equations are made dimensionless by scaling the den-
sity with ρ0, distances with H0, and velocities with the thermal
velocity vth, 0. The magnetic ﬁeld strength B0 is found from the
dimensionless parameter β0. Here, the subscript ”0” denotes
the value at the bottom of the computational domain, z = 0.
With this convention, the unit of time is H0/vth, 0, temperature
is scaled with T0, µ is scaled with µ0, pressure, as well as en-
ergy density, is scaled with P0 = ρ0v2
th,0, and the value of g is
unity.

We begin by comparing the simulations with the linear the-
ory. In order to do so, we use the quasi-periodic boundary
conditions described in the previous section and in Appendix
B. A Cartesian box of size [0, Lx] × [0, Lz] with Lx = Lz = 0.1
and a resolution of 64 × 64 is used in all simulations unless
otherwise noted. An overview of the simulations of the linear
regime can be found in Table 1.

The instabilities are excited by seeding a given mode,
with components (δvx, δvz, δBx, δBz, δρ/ρ, δT /T , δµ/µ), as
derived by solving the eigenvalue associated with the dis-
persion relation introduced in Pessah & Chakraborty (2013);
Berlok & Pessah (2015). We set the overall mode amplitude
by enforcing δρ/ρ = 10−4, so that the velocity perturbation is
subsonic (Parrish & Stone 2005). The amplitudes of the other
components are ﬁxed by the solution to the linear eigenvalue
problem, which predicts that unstable modes grow exponen-
tially as exp(σt) while the ratio of their components remains
constant in time.

We begin by considering D = 0 and the hydrostatic atmo-
sphere given in Section 3.1.1, that has d ln µ/d ln P = −1/3
and d ln T /d ln P = 0. This atmosphere is unstable regardless
of whether the magnetic ﬁeld is oriented horizontally (MTCI)
or vertically (HPBI), as described in Berlok & Pessah (2015).

4.1. The Magneto-Thermo-Compositional Instability

When the magnetic ﬁeld is perpendicular to gravity the
general dispersion relation, Equation (13) in Berlok & Pessah
(2015), reduces to

σ2 ≈ −g

d ln (T /µ)

dz

x + k2
k2
k2

y

,

(23)

in the limit of fast heat conduction and weak magnetic ﬁeld.
When µ increases with height and the atmosphere is isother-
mal we have σ > 0. This is the instability known as the
MTCI (Pessah & Chakraborty 2013). In order to excite a sin-
gle MTCI mode, we use a perturbation of the form4 kz = 0
and kx = 2π/Lx. We are interested in a direct visual com-
parison of the spatial dependence of the perturbations in the
simulations and the one expected from the linear theory. In
order to illustrate this, we consider a setting with χk = 3· 10−4
and B0 = 10−4. In Figure 1, we show the values of the pertur-
bations (green crosses) δvx, δvz, δBz and δµ/µ as a function of
the x-coordinate. The data slices are drawn at a ﬁxed height,
z = Lz/2 at the time t = 5 in dimensionless units. The numer-
ical results show good agreement with the analytical results
shown with blue solid lines.

4 We note that ky = 0 in all the simulations presented in this paper.

1

0

-1

1

0

-1

δvz

δBz /B

δµ/µ

0

0.05
x

0.1

0

0.05
x

δT/T

0.1

Figure 1. Four of the components of the perturbation at z = Lz/2 for a mode
with kx = 2π/Lx at time t = 5 in a simulation with resolution 32 × 32. The
simulation (green crosses) matches the theory (blue lines). The magnetic
ﬁeld is π/2 out of phase with the velocity perturbation, as expected for a
purely growing mode.

100

10-1

10-2

10-3

10-4

10-5

0

δBz /B
δvz

δµ/µ

δT/T

δρ/ρ

1

2

3

4

5

t

Figure 2. Evolution of box-averaged quantities. The perturbed quantities
grow exponentially with a growth rate σ = 0.40.

In order to calculate the growth rate of the mode, we per-
form an exponential ﬁt to the time evolution of the box aver-
age of the absolute value of any of the perturbed quantities,
which are shown in Figure 2. As expected from the local lin-
ear mode analysis, the amplitudes of the various components
of the perturbation grow exponentially at the same rate.

The growth rate of the MTCI depends on, among other
things, the value of the heat conductivity, χk
, and the initial
magnetic ﬁeld strength, B0. In order to illustrate this depen-
dence, and at the same time test our modiﬁcation to the code,
we perform a parameter study. In the left panel of Figure 3, we

Local Simulations of Instabilities Driven by Composition Gradients in the ICM

5

Simulations of the linear regime using quasi-periodic boundary conditions. Each row represents a

series of simulations where the ellipses denote that the associated parameter is being varied.

Table 1

Simulation

(nx, nz)

MTCI chi
MTCI B
HPBI nu
HPBI n
D-mode D
D-mode nu
MTCI ICMa
HPBI ICMa

(1, 0)
(1, 0)
(1, 1)
. . .
(1, 1)
(1, 1)
(. . . , 0)
(. . . , . . . )

θ

0◦
0◦
90◦
90◦
90◦
90◦
0◦
90◦

β0
2 · 108
. . .
2 · 108
2 · 106
2 · 108
2 · 108
2 · 106
2 · 106

χk

. . .
10−4
10−4
10−4
10−4
10−3
1.4 · 10−2
2.7 · 10−4

νk

0
0
. . .
0
0
. . .
4.0 · 10−4
4.5 · 10−6

D

0
0
0
0
. . .
10−3
0
0

Resolution
64 × 64
64 × 64
64 × 64
256 × 256
256 × 256
64 × 64
256 × 32
256 × 256

Figure

3.a
3.b
4.a
4.b
5.a
5.b
6.a
6.b

a Using gradients in both temperature and composition.

show how the growth rate increases with the value of the heat
. This is to be expected because the MTCI is
conductivity, χk
driven by heat transfer along magnetic ﬁeld lines. In the right
panel of Figure 3, we show how the growth rate decreases
with the value of the initial magnetic ﬁeld strength, B0. The
explanation for this behavior is that magnetic tension tends to
stabilize the MTCI (Berlok & Pessah 2015). These examples
were generated by running 10 simulations at a modest reso-
lution (64 × 64). At this resolution the growth rates match to
within a percent of the values expected from linear theory.

4.2. The Heat and Particle-ﬂux-driven Buoyancy Instability

When the magnetic ﬁeld is parallel to gravity, the general

dispersion relation reduces to

σ2 ≈ g

d ln (T µ)

dz

x + k2
k2
k2

y

,

(24)

in the limit of fast heat conduction and weak magnetic ﬁeld.
The isothermal atmosphere where µ increases with height,
that we considered in the previous section, is therefore also
unstable when the magnetic ﬁeld is vertical. In this case, the
instability has been termed the HPBI (Pessah & Chakraborty
2013).

In this example, we include Braginskii viscosity which in-
hibits the growth rate by damping perturbations perpendicular
to the magnetic ﬁeld. Braginskii viscosity can be important
for the HPBI (Berlok & Pessah 2015). The mechanism is sim-
ilar to the mechanism described by Kunz (2011) for the HBI.
In order to excite a single mode of the HPBI, we use a per-
turbation with wavenumbers kx = 2πnx/Lx and kz = 2πnz/Lz,
where n = nx = nz is the mode number. We show the growth
rate as a function of the Braginskii viscosity coeﬃcient, νk
in
the left panel of Figure 4. These simulations used a ﬁxed value
of χk = 0.001, n = 1 and a numerical resolution of 64 × 64.
As expected, the growth rate indeed decreases with increasing
value of viscosity νk
The second dependence we study for the HPBI is the one
on the mode number, n. High wavenumbers require higher
numerical resolution in order to be resolved and we use a res-
olution of 256 × 256 for these simulations. For the sake of
simplicity, Braginskii viscosity is not included in these simu-
lations. The result is shown in the right panel of Figure 4. The
growth rate increases for increasing wave number because
small wavelength perturbations have a shorter time scale for
heat conduction. When the wavelength is too short magnetic
ﬁeld tension renders the modes stable. Using such simula-
tions we can directly see the cutoﬀ in unstable wave numbers
resulting from magnetic ﬁeld tension (as in this case) or vis-

.

σ

0.45

0.40

0.35

0.30

0.25

0.20

0

1

2
χ ∥

3

1e−4

0

1

2

3
B

4

5

1e−3

Figure 3. Growth rates for the MTCI. Left: The growth rate increases with
the value of χk. Right: The growth rate decreases with increasing initial
magnetic ﬁeld strength. The solid blue lines represent the theoretical values
evaluated at z = Lz/2. The green crosses are growth rates obtained from the
simulations.

σ

0.35

0.30

0.25

0.20

0.15

0.10

0.0

0.5
ν ∥

1.0
1e−4

0

1 2 3 4

5 6

n

Figure 4. Growth rates for the local HPBI. Left: The growth rate decreases
with the value of νk. Right: The growth rate as a function of the mode number,
n = nx = nz. The solid blue lines represent the theoretical values evaluated at
z = Lz/2. The green crosses are growth rates obtained from the simulations.

cosity (not shown here).

4.3. Modes Driven by Diﬀusion

One of the interesting ﬁndings of Pessah & Chakraborty
(2013) is that there are instabilities that are driven by particle
diﬀusion. This means that even though the equilibrium is sta-
ble according to Equation (24), the fact that D , 0 makes the
equilibrium unstable. In order to study these unstable modes,
we assume, for simplicity, an isothermal atmosphere with an
initial vertical magnetic ﬁeld.

In this case, as explained in Section 3.1, an equilibrium con-
ﬁguration needs to fulﬁll ∇ · Qc = 0 and so we consider the
atmosphere given in Section 3.1.2 as initial condition. Ac-
cording to Equation (24), this conﬁguration is unstable to the

6

0.35

0.30

σ

0.25

0.20

0.15

0.0

0.5

1.0

0.0 0.2 0.4 0.6 0.8 1.0
1e−4
Figure 5. Growth rate as a function of D (left) and νk for ﬁxed values of
χk = D = 10−3 (right). The solid blue line represents the theoretical values
evaluated at z = Lz/2 and the green crosses are growth rates obtained from
the simulations.

1e−3

ν ∥

D

HPBI for an isothermal atmosphere when the Helium con-
centration increases vertically. If instead the Helium concen-
tration decreases with height, the atmosphere is stable in the
absence of anisotropic particle diﬀusion. Choosing the slope
in composition to be sc = −0.01, we do not observe any insta-
bilities in the simulation when D = 0. The situation changes
dramatically, turning unstable when D , 0. The growth rates
found in such simulations are compared with the predictions
from the linear theory in Figure 5. Since the modes are driven
by diﬀusion of Helium, we expect the growth rate to increase
with the value of D (left panel). The modes have a damped
growth rate when Braginskii viscosity is included. We ob-
, in
serve a decrease in the growth rate with increasing νk
agreement with the solution to the dispersion relation (right
panel).

4.4. Gradients in temperature and composition

Having tested the case of isothermal atmospheres, we now
consider a more general situation where both dT /dz , 0 and
dµ/dz , 0. In order to work with sensible values for these
gradients, we consider the models in Peng & Nagai (2009),
who analyzed the long-term evolution of the concentration of
Helium in a one-dimensional setting by solving a coupled set
of Burgers’ equations for a multicomponent plasma in the ab-
sence of a magnetic ﬁeld. Berlok & Pessah (2015) analyzed
the stability of the Peng & Nagai (2009) model by focusing
on local regions, characterized by ﬁxed temperature and com-
positions gradients, and modeling these as a plane parallel at-
mosphere.

In this section, we present local simulations with gradients
in temperature and composition estimated at r/r500 = 0.02
and r/r500 = 0.5 with r500 = 1.63 Mpc in the Peng & Nagai
(2009) model. These are the locations that were analyzed
in Section 6.6 and 6.4 in Berlok & Pessah (2015), indicated
with a C and an A in Figure 8 in that paper. These two
locations correspond to the inner region where the tempera-
ture and composition increase with radius and the outer re-
gion where the temperature and composition decrease with
radius. At these radii, the values for the logarithmic gradi-
ents are d ln T /d ln P = −0.4 and d ln µ/d ln P = −0.13 at
r/r500 = 0.02 and d ln T /d ln P = 0.16 and d ln µ/d ln P =
0.05 at r/r500 = 0.5.

We use the equilibrium derived in Section 3.1.2 with T0 =
6.6 keV (T0 = 9.5 keV) and c0 = 0.56 (c0 = 0.29) for the
inner (outer) region. The computational domain is Lx = Lz =
H0/10 where H0 = 50 kpc for the inner region and Lx =
10Lz = H0 where H0 = 0.35 Mpc for the outer region. The
gradients in composition and temperature are given by sc =

Berlok & Pessah

σ

0.40
0.35
0.30
0.25
0.20
0.15
0.10
0.05

0.0

r/r500 =0.02

r/r500 =0.5

1.0

0.5
k/2π [kpc−1 ]

1.5

0.0 0.5 1.0 1.5 2.0 2.5
1e2

k/2π [Mpc−1 ]

Figure 6. Left: Growth rates in the inner region as a function of k = kx = kz.
Right: Growth rates in the outer region as a function of kx for kz = 0. The
solid blue line represents the theoretical values evaluated at z = Lz/2 and the
green crosses are growth rates obtained from the simulations.

Overview of the simulations of the nonlinear regime using the reﬂective

Table 2

boundary conditions.

Simulation

MTCI256
HPBI128
HPBI256
HPBI512

θ

0◦
90◦
90◦
90◦

β0
2 · 108
2 · 108
2 · 108
2 · 108

χk
10−4
10−4
10−4
10−4

νk D Resolution
256 × 256
0
128 × 128
0
0
256 × 256
512 × 512
0

0
0
0
0

Figure

7.a, 8, 10
9
9
7.b, 9, 10

, χk

2.9 Mpc−1 (sc = −0.19 Mpc−1) and sT = 0.058 keV kpc−1
(sT = −4.3 keV Mpc−1) for the inner (outer) region.
, and D are calculated from the model
The values for νk
of Peng & Nagai (2009) as explained in the Appendix of
Berlok & Pessah (2015). The dimensionless values are so
large that high resolution numerical simulations become very
computationally expensive. As this is a test, we have arbitrar-
ily reduced the values by a factor of 100 in the simulations.
We use a value of β = 2 · 106 for both sets of simulations and
adopt a resolution of 32 × 256 (MTCI) and 256 × 256 (HPBI).
Some of the details of the simulations are listed in Table 1
with the names HPBI ICM and MTCI ICM. The growth rates
also depend on the wavenumbers, kx and kz. For the HPBI (in
the inner region) we take k = kx = kz and investigate growth
rate as a function of k. For the MTCI (in the outer region) we
take kz = 0 and investigate the growth rate as a function of
kx. The results are shown in Figure 6 with the growth rates of
the HPBI in the left panel and the growth rates of the MTCI
in the right panel. The growth rates are in units of 50 and 280
Myr, respectively. Therefore, in physical units, the maximum
growth rates in these simulations are σmax = 6.4 Gyr−1 for the
HBPI and σmax = 1.2 Gyr−1 for the MTCI.

5. SIMULATIONS OF THE NONLINEAR REGIME

In order to study the nonlinear evolution of the MTCI and
the HPBI we use the reﬂective boundaries described in Ap-
pendix B. We use the isothermal atmospheres presented in
Section 3.1.1 and seed both velocity components with Gaus-
sian noise with a standard deviation of 10−4. The simulations
are run without Braginskii viscosity or anisotropic diﬀusion
of Helium but anisotropic heat conduction is accounted for
with a value of χk = 5 · 10−4. We use a value of 2 · 108 for
the plasma-β. An overview of the simulations of the nonlinear
regime can be found in Table 2.

We start out by studying the evolution of the MTCI, i.e.,
we consider an atmosphere threaded by a horizontal magnetic

Local Simulations of Instabilities Driven by Composition Gradients in the ICM

7

t = 5.0

t = 10.0

t = 15.0

t = 20.0

t = 30.0

I

C
T
M

I

B
P
H

        µ

0.516
0.514
0.512
0.510
0.508
0.506
0.504
0.502

Figure 7. Evolution of instabilities in an isothermal atmosphere with d ln µ/d ln P = −1/3. The magnetic ﬁeld lines are shown as solid black lines. The
composition of the plasma is shown with green representing a high concentration and purple representing a low concentration. The MTCI (upper panel) and
the HPBI (lower panel) both give rise to turbulent mixing of the Helium content. The motions generated by the instabilities can be hinted at by comparing
neighboring snapshots but are best understood from the animated version of this ﬁgure (which can be found here).

zi larger than hB2

ﬁeld. The subsequent evolution of the magnetic ﬁeld and the
plasma composition is illustrated in the upper panel of Figure
7. In this ﬁgure, it is evident that the MTCI is able to mix
the Helium content and to completely rearrange the initially
ordered magnetic ﬁeld. The resulting growths in kinetic and
magnetic energy densities are shown, respectively, in the left
and right panels of Figure 8. The kinetic energies associated
with the two velocity components are roughly in equiparti-
xi ≈ hρv2
tion throughout the simulation, i.e., hρv2
zi with hρv2
zi
always larger but never exceeding hρv2
xi by more than an or-
der of magnitude. The exponential phase of the instability
ends at t ≈ 30. After this point in time, both the kinetic and
magnetic energies saturate with the former exceeding the lat-
ter by two orders of magnitude. In spite of the fact that hB2
zi
vanishes initially, by the end of the simulation the energies as-
sociated with the two magnetic ﬁeld components are roughly
in equipartition with hB2
xi by a factor of ≈ 2,
with hB2
xi having grown by a factor of ≈ 8 with respect to its
initial value.
We now consider the evolution of the HPBI. The setup is
essentially the same but the initial magnetic ﬁeld is now ver-
tical.5 The evolution of the HPBI is illustrated in the lower
panel of Figure 7 with a resolution of 512 × 512. The initial
vertical magnetic ﬁeld is rearranged by the HPBI, and, as for
the MTCI, the Helium content is mixed by the action of the
instability. The HPBI leads to growth in the magnetic and ki-
netic energy densities. In order to asses whether this growth is
numerically converged, we have also run simulations at res-
olutions of 128 × 128 and 256 × 256. We show the evolu-
tion of hB2
zi/8π for the three diﬀerent numerical
resolutions in Figure 9. We observe that the instability leads
to exponential growth followed by saturation in both hB2
xi/8π
and hB2
zi/8π. While the growth rate increases with increasing
resolution the values in the saturated state agree quite well.
It is also of interest to understand how the magnetic ﬁeld
changes from being initially vertical to having a large paral-
lel component. The reason being the consequences for heat

xi/8π and hB2

5 The boundary conditions on the magnetic ﬁeld are also slightly diﬀerent,

see Appendix B.

transport along the vertical direction of the box. Such stud-
ies have been done for both the MTI (Parrish & Stone 2005,
2007) and the HBI (Parrish & Quataert 2008). These stud-
ies were motivated by a need to understand the cooling ﬂow
problem of galaxy clusters (Fabian 1994), and whether mag-
netic ﬁelds could alleviate this problem. While the MTI could
potentially increase heat transport towards the core by mak-
ing the magnetic ﬁeld be preferentially in the radial direc-
tion (Parrish et al. 2008), the HBI has been shown to lead
to core insulation by driving the magnetic ﬁeld to be per-
pendicular to the radial direction (Parrish & Quataert 2008;
Bogdanovi´c et al. 2009; Parrish et al. 2009), which would ex-
acerbate the cooling ﬂow problem.

In Figure 10, we show average magnetic ﬁeld inclination
as a function of time for the simulations of the MTCI and
the HPBI. The average inclination saturates to a value of ap-
proximately θ ≈ 45◦ for both the simulations. This behavior
is qualitatively diﬀerent from the behavior of the magnetic
ﬁeld inclination for the MTI and the HBI. The diﬀerence can
be explained in the following way. The MTI, which is maxi-
mally unstable when the magnetic ﬁeld is horizontal, has been
found to drive the saturated magnetic ﬁeld to be roughly ver-
tical (Parrish & Stone 2007). The HBI, which is maximally
unstable when the magnetic ﬁeld is vertical, drives the mag-
netic ﬁeld to be roughly horizontal (Parrish & Quataert 2008).
These instabilities depend on gradients in temperature that
have opposite directions and so they cannot be present at the
same time. On the other hand, both the MTCI and the HPBI
require a mean molecular weight that increases with height,
and so they can both be present at the same time. This feature
of the MTCI and the HPBI was discussed in Berlok & Pessah
(2015), see especially Figure 4 in that paper. The interpreta-
tion of the left panel of Figure 10 is therefore that the MTCI
aims at driving the magnetic ﬁeld angle towards 90◦ while the
HPBI aims at driving the magnetic ﬁeld angle towards 0◦. In
the end, they reach a compromise at roughly 45◦.

The Helium mass concentration, c, dramatically changes
and the initial gradient is diminished by the instability as time
progresses. This is illustrated in the lower panel of Figure
10 for both the MTCI and the HPBI. As explained in the in-
troduction, gradients in composition can introduce biases in

8

10-5

10-7

10-9

10-11

10-13

10-15

x(cid:0)/2
(cid:1)ρv2
z(cid:0)/2
(cid:1)ρv2

0 10 20 30 40 50 60

x(cid:0)/8π
(cid:1)B 2
z(cid:0)/8π
(cid:1)B 2

0 10 20 30 40 50 60

t

t

Figure 8. Evolution of kinetic (left panel) and magnetic (right panel) ener-
gies for the MTCI. After the initial phase of exponential growth, the instabil-
ity saturates with energies that are roughly in equipartition.

10-5
10-6
10-7
10-8
10-9
10-10
10-11

x(cid:0)/8π
(cid:1)B 2

z(cid:0)/8π
(cid:1)B 2

128
256
512

128
256
512

0

10 20 30 40 50

0

10 20 30 40 50

t

t

Figure 9. Convergence of hB2
zi/8π as a function of resolution.
The highest resolution is much more expensive to run because of the pro-
hibitive time step constraint due to heat conduction, see Appendix A.

xi/8π and hB2

key cluster parameters. We are therefore interested in under-
standing whether such gradients, if initially present, will be
robust. The simulations presented here are heavily idealized,
among many reasons because the gas is assumed to be ini-
tially isothermal and the simulations are local. Nevertheless,
these simulations serve as a proof-of-principle that gradients
in composition can indeed be altered by turbulent mixing in-
duced by plasma instabilities. Future work, using realistic
gradients for temperature and composition as well as trans-
port coeﬃcients should allow us to understand whether such
mixing can occur on timescales relevant for galaxy clusters.

6. SUMMARY AND DISCUSSION

In this paper we have introduced a modiﬁed version of
Athena (Stone et al. 2008) for performing kinetic MHD simu-
lations of weakly collisional plasmas with non-uniform com-
position. We have employed this modiﬁed code to perform the
ﬁrst simulations of the MTCI, HPBI and the diﬀusion modes
introduced in Pessah & Chakraborty (2013). The set of simu-
lations aimed at investigating the linear evolution of these in-
stabilities served as a test for both the modiﬁcation to Athena
and the local linear mode analysis in Pessah & Chakraborty
(2013) and Berlok & Pessah (2015).

The simulations of weakly collisional, isothermal atmo-
spheres with a gradient in Helium presented in Section 5
showed that the plasma instabilities, feeding oﬀ gradients in
composition, can induce turbulent mixing of the Helium con-
tent. This conclusion is valid for compositions that increase in
the direction anti-parallel to gravity, regardless of whether the
initial magnetic ﬁeld is parallel or perpendicular to the direc-
tion of gravity. In the saturated state, the magnetic ﬁeld com-
ponents in the x and z directions have roughly the same aver-

Berlok & Pessah

80

60
(cid:0)
40
(cid:1)

θ

20

0

0

0.06

0.05

0.04

(cid:0)

(cid:1)

c

0.03

MTCI
HPBI

10

20

30

40

50

t

t =0.0
MTCI, t =30.0
HPBI, t =30.0

0.02

0.01

0.00

0.00

0.02

0.04

0.06

0.08

0.10

z

Figure 10. Upper panel: Evolution of the average inclination of the mag-
netic ﬁeld for the MTCI and the HPBI. Both instabilities seem to drive the
average inclination towards 45◦. Lower panel: The average along x of c for
the MTCI (blue) and the HPBI (green) at the end of the exponential phase
of the simulations (t = 30). The initial gradient in c (dashed black line) is
diminished by the instabilities.

age energy but the energies are a factor of 10 higher for the
HPBI than for the MTCI. The kinetic energy components are
also roughly in equipartition. In both cases, the instabilities
saturate by driving the average magnetic ﬁeld inclination to
roughly 45◦. This eﬀect seems to open the possibility of alle-
viating the core insulation observed in previous homogeneous
simulations of the HBI. This is provided that the global cluster
dynamics were to allow for an increase in the mean molecular
weight with radius in the inner region, as envisioned by cur-
rent (one-dimensional, unmagnetized) Helium sedimentation
models (Peng & Nagai 2009).

The simulations of the nonlinear regime of the MTCI and
the HBPI presented in this paper considered an isothermal at-
mosphere as the equilibrium background. It would be an im-
provement to use the model of Peng & Nagai (2009) to de-
termine the gradients in both temperature and composition.
This would provide insight into the saturation of instabilities
in potentially more realistic scenarios where the dynamical
evolution is determined by the simultaneous eﬀects of both
gradients. Before proceeding with this endeavor there are,
however, a few issues that would be desirable to address, as
we detail below.

regions of

in the inner

It was found in Berlok & Pessah (2015) that the HPBI,
if present
the ICM model of
Peng & Nagai (2009), will have its fastest growth rates at
wavelengths that are longer than the scale height of the at-
mosphere. This conclusion is similar to what was found for
the HBI in Kunz (2011). Neither local linear theory nor local
simulations will therefore capture the physics of the HPBI in
the inner region of the ICM. This implies that both a quasi-
global theory and simulations are needed in order to study the
inﬂuence of the possible gradient in composition on the dy-
namics of the inner region of the ICM.

Local simulations of the MTI have been shown to underes-
timate the turbulence (McCourt et al. 2011) and boundary ef-

Local Simulations of Instabilities Driven by Composition Gradients in the ICM

9

fects can also modify the conclusions from local simulations.
The solution to this problem for the MTI has been to sandwich
the unstable region between stable layers, thereby isolating it
from the boundaries (Parrish & Stone 2005, 2007; Kunz et al.
2012). A similar approach seems reasonable for the MTCI.

k − p

Other complications stem from the fact

that pressure
anisotropies, shown to be important for the evolution of the
MTI and HBI (Kunz 2011; Kunz et al. 2012), can give rise
to microscale instabilities such as the ﬁrehose and mirror in-
stability (Schekochihin & Cowley 2006; Schekochihin et al.
2010). These small-scale instabilities are only excited once
⊥|/P & β−1.
the pressure anisotropy grows beyond |p
They do not appear in the tests of the linear regime of the
MTCI, HPBI and the diﬀusion modes presented in Section
4 because we terminate the simulations before the stability
criterion is violated. They are not present in the simulations
of the nonlinear regime in Section 5 because we take the
pressure to be isotropic in these simulations (no Braginskii
viscosity). The problem with microscale instabilities is that
they are not correctly described by the framework of kinetic
MHD (Schekochihin et al. 2005), an issue that will need to
be addressed for simulations of the nonlinear evolution of the
MTCI and the HPBI when Braginskii viscosity is included
(see Kunz et al. 2012 for a discussion of these issues in the
context of the MTI and the HBI).

All this being said, our study suggests that, at least in the
idealized settings that we considered here, gradients in com-
position are able to drive turbulent mixing of the composi-
tion in weakly collisional, magnetized plasmas. This moti-
vates future work on the generation and sustainment of both
temperature and composition gradients in galaxy clusters and
their potential inﬂuence on the global dynamics of the ICM.
We envision that the modiﬁed version of Athena that we de-
veloped will be a useful asset in this context.
In order to
model more realistically the physics of the ICM, future im-
provements could include extending the simulations to three
dimensions and adding optically thin cooling in order to study
the cooling ﬂow problem. Furthermore, the equations of ki-
netic MHD, as embodied in Equation (1)-(5), cannot account
for the slow sedimentation of Helium that is the core feature
in the model of Peng & Nagai (2009). An extension of the
framework of kinetic MHD to include this eﬀect would al-
low us to self-consistently include sedimentation in the sim-
ulations (Bahcall & Loeb 1990; Berlok & Pessah 2015) and
study the eﬀects of the instabilities described in this paper in
a dynamic, slowly varying background.

We acknowledge useful discussions with Daisuke Nagai,
Matthew Kunz, Prateek Sharma, Ellen Zweibel, and Ian Par-
rish during the 3rd ICM Theory and Computation Workshop
held at the Niels Bohr Institute in 2014. We also thank Sagar
Chakraborty and Henrik Latter for valuable discussions and
comments. We are grateful to Oliver Gressel for suggest-
ing using the quasi-periodic boundary conditions for testing
the linear theory and to Tobias Heinemann for aid in ren-
dering magnetic ﬁeld lines. The research leading to these
results has received funding from the European Research
Council under the European Union’s Seventh Framework Pro-
gramme (FP/2007-2013) under ERC grant agreement 306614.
T. B. also acknowledges support provided by a Lørup Scholar
Stipend and M. E. P. also acknowledges support from the

Young Investigator Programme of the Villum Foundation.

APPENDIX

In this appendix, we describe the numerical methods used
in this paper. We use the publicly available MHD code
Athena which solves the conservative form of the MHD equa-
tions. The algorithms used are described in Gardiner & Stone
(2005); Stone & Gardiner (2009) and the implementation of
Athena along with tests is described in detail in Stone et al.
(2008). Athena is a ﬁnite volume code, which uses the Go-
dunov method. We use the directionally unsplit corner trans-
port upwind method along with constrained transport (CTU +
CT) which is the recommended setting. We furthermore use
the anisotropic heat conduction module that was implemented
in Athena by Parrish & Stone (2005) using operator splitting.
Appendix A explains the implementation of a spatially
varying mean molecular weight, µ, the anisotropic diﬀusion
of Helium and tests cases, in Athena. In Appendix B we dis-
cuss in detail the boundary conditions used in the simulations.
A. IMPLEMENTATION OF ANISOTROPIC DIFFUSION

OF COMPOSITION IN ATHENA

Let us consider the equation describing the evolution of the

Helium mass concentration, c = ρHe/ρ, given by6

∂c
∂t

+ (u·∇) c = −∇·Qc .

(A1)

Athena has an option for adding passive scalars which we use
for adding the Helium mass concentration. This option turns
on an extra equation

∂ (ρcn)

∂t

+ ∇· (ρcnu) = 0 ,

(A2)

where ρ is the total density and cn is the mass concentration of
the nth scalar. We only add a single scalar, namely the Helium
mass concentration, c. This built-in function takes care of the
Lagrangian part of Equation (A1). The diﬀusion term is then
solved using a ﬁnite diﬀerence scheme and operator splitting.
Anisotropic diﬀusion of Helium is described by the RHS of

Equation (A1), which, when u = 0, reduces to

∂c
∂t

= −∇·Qc = D∇·(cid:16) ˆb ˆb·∇c(cid:17) .

(A3)

The composition ﬂux for anisotropic Helium diﬀusion has
the same form as the heat ﬂux for anisotropic heat conduc-
tion, as seen by comparing Equations (12) and (11), respec-
tively. We can therefore use the same method to calculate
the two physically diﬀerent anisotropic ﬂuxes. The original
implementation of anisotropic heat conduction was done by
Parrish & Stone (2005) using an asymmetric ﬁnite diﬀerence
scheme (Sharma & Hammett 2007; van Es et al. 2014).

Non-ideal eﬀects are computationally expensive because
they are generally described by parabolic operators which
cannot be added to the hyperbolic ﬂuxes used in the Godunov
scheme. The parabolic operators can be shown to have a very
prohibitive time step constraint (Durran 2010) for heat con-
duction and concentration diﬀusion as given by, respectively,

∆tχk

<

b
κk

(∆x)2
γ − 1

,

(A4)

6 We do not consider the eﬀects of thermo-diﬀusion and baro-diﬀusion
which makes our current model unable to describe the slow sedimentation of
Helium (Bahcall & Loeb 1990) that can give rise to a composition gradient.

10

Berlok & Pessah

∆tD < b

(∆x)2

D

.

(A5)

T /P is the heat diﬀusivity, the parameter b is b =
Here, κk = χk
1/2, 1/4, 1/6 in one, two and three dimensions, respectively,
and ∆x is the grid size.

The Courant number, C, is deﬁned to be the ratio of the
applied time step to the allowed time step. We use C = 0.4
in all our simulations. Because ∆tMHD ∝ ∆x, the very pro-
hibitive constraints on the time step for the parabolic opera-
tors will generally lead to ∆tMHD ≫ ∆tχ ∼ ∆tD. In order to
partially circumvent this problem we use subcycling, taking
up to ten diﬀusion steps for each MHD step, as suggested in
(Kunz et al. 2012).

Sharma & Hammett (2007) found that the ﬁnite diﬀerence
approximation can lead to unphysical behavior with diﬀusion
in the wrong direction. In the context of heat diﬀusion this
problem can lead to negative temperatures and therefore an
imaginary sound speed. The same problem arises when con-
sidering Helium diﬀusion and we use Van Leer limiters on the
derivatives to circumvent it (Sharma & Hammett 2007).

, and heat diﬀusivity, κk = χk

The publicly available version of Athena works with con-
T /P. How-
stant viscosity, νk
ever, these coeﬃcients, as well as the diﬀusion coeﬃcient
D, do in general depend on temperature, density and com-
position, see for instance, the discussion in the Appendix of
Berlok & Pessah (2015). Accounting for this dependence is
not crucial in local simulations but it becomes essential in
global simulations. We have modiﬁed Athena to use spatially
varying coeﬃcients by using a harmonic average of the coef-
ﬁcients (Sharma & Hammett 2007). This makes the time step
computed from Equations (A4) and (A5) spatially dependent.
We therefore calculate the time step at each cell and use the
minimum value. This implementation will be useful in future
global studies.

A.1. Tests of the implementation of anisotropic diﬀusion

In order to verify the implementation of anisotropic diﬀu-
sion of Helium, we performed three diﬀerent test problems
with a known analytical solution. These tests were carried out
with the MHD solver turned oﬀ.

A.1.1. One-dimensional diﬀusion

We consider

the diﬀusion of a step function as in
Rasera & Chandran (2008) using a one-dimensional grid with
100 cells on the domain x = [0, 1] with D = 1 and run the
simulation up to t = 0.0028. The analytical solution to the
diﬀusion of a step function is

c(x, t) = c0 +

∆c
2

erf ±

x − x0
√4Dt! ,

(A6)

where c0 = 3/2 and ∆c = 1. The ” + ” sign is used with x0 =
0.25 for x < 0.5 and the ” − ” sign is used with x0 = 0.75 for
x > 0.5. The numerical result matches the analytical solution,
as seen in Figure A1, implying that the method works well in
one dimension.

A.1.2. Diﬀusion of a two-dimensional Gaussian

A more challenging test can be posed by considering the
magnetic ﬁeld to be inclined at an angle, θ, with respect to
the grid. We consider an initially isotropic, two dimensional

2.2

2.0

1.8

c

1.6

1.4

1.2

1.0

0.0

0.2

0.4

0.6

0.8

1.0

x

Figure A1. Diﬀusion of a step function. The initial condition is shown with
a dashed line. The green crosses correspond to data from the simulation and
the solid blue line is the analytical solution at t = 0.0028.

2
L

10-1

10-2

10-3

10-4

10-5

10-6

0

20 40 60 80

10-3

θ

10-2
∆x

10-1

Figure A2. Left: L2 error as a function of magnetic ﬁeld inclination. Res-
olutions of N × N with N = 32, 64, 128, 256, 512 and 1024 was used with
monotonically decreasing L2 at all angles. As expected, the asymmetric ﬁ-
nite diﬀerence scheme gives the best result when the magnetic ﬁeld is aligned
with the grid. Right: Convergence to the exact solution with decreasing ∆x
for a magnetic ﬁeld inclined at 40◦ from the x-axis.

Gaussian distribution of Helium diﬀusing out along an in-
clined magnetic ﬁeld. The analytical solution is7

(x cos θ + y sin θ)2

2a (t)2

(y cos θ − x sin θ)2

2a2
0

)


,

c (x, y, t) =

1

2πa (t) a0

exp(−
× exp

−

(A7)
0 + 2Dt and a0 it the initial standard deviation

where a(t)2 = a2
of the Gaussian.
The computational domain is a [−1, 1] × [−1, 1] Cartesian
box. We use a0 = 1/8 and D = 0.001. The errors at t = 4
are compared to the analytical solution in Figure A2. In the
left panel the L2 errors are shown as a function of the mag-
netic ﬁeld inclination and resolution. These errors are small-
est when θ = 0 or θ = π/2, corresponding to the grid and
the magnetic ﬁeld being aligned. In the right panel we show
that the solution for θ = 40◦ converges as L2 ∝ (∆x)m , where
∆x is the (uniform) grid spacing and m = 1.9 is the order of
convergence.

7 This result can be derived by solving the one-dimensional diﬀusion equa-
tion for a Gaussian initial distribution followed by a rotation of the coordinate
system. The one-dimensional problem is solved by using a Fourier transform
in space and a Laplace transform in time.

Local Simulations of Instabilities Driven by Composition Gradients in the ICM

11

dicular diﬀusion provided that χ⊥/χk < 10−3. The fact that
we ﬁnd the correct analytical growth rates for all simulations
discussed in Section 4 shows that the numerical perpendicular
diﬀusion is not a problem for our present purposes.

B. BOUNDARY CONDITIONS

In the horizontal direction we use the periodic boundary
conditions that Athena provides as a standard option. In the
vertical direction, boundary conditions that maintain hydro-
static equilibrium are required. In this section we describe
the conventional, reﬂective boundary conditions as well as the
quasi-periodic boundary conditions alluded to in Section 3.2.

B.1. Reﬂective boundary conditions

Our implementation of reﬂective boundary conditions fol-
lows the description in Zingale et al. (2002). Hydrostatic
equilibrium requires that Equation (13) is satisﬁed. This re-
quirement can be approximated by

Pi − Pi+1 =

ag ∆z

12

(5ρi+1 + 8ρi − 2ρi−1) ,

(B1)

where a = 1 (a = −1 ) at the top (bottom) of the domain. In
this notation, i refers to cell i and i +1 refers to one cell further
up (down) when a = 1 (a = −1). This equation is then solved
for ρi+1 using that

Pi+1 =

ρi+1Ti+1

µi+1

,

(B2)

along with an assumption on µi+1 and Ti+1. One can either
assume µi = µi+1 and Ti = Ti+1 or one can prescribe the val-
ues at the boundaries to be equal to their initial values, i.e.,
µi+1 = µ0 and Ti+1 = T0. In the case where the mean molec-
ular weight µ is not included, Parrish & Stone (2005) refer
to these boundary conditions as adiabatic and conductive, re-
spectively. A combination of these two boundary conditions
is also possible (i.e., ﬁxing µ and varying T or vice versa). We
have implemented all four combinations but will only discuss
the conducting boundary conditions (µi+1 = µ0 and Ti+1 = T0)
in the following, since these are the boundary conditions used
in Section 5.

Solving Equations (B1) and (B2) for ρi+1 and Pi+1 we ﬁnd

ρi+1 =

Pi + α (8ρi − ρi−1)

T0/µ0 − 5α

and Pi+1 = ρi+1T0/µ0, where

,

(B3)

α =

a∆z g

12

.

(B4)

These relations are used to calculate the density and pressure
of the four ghost cells at the top and bottom of the computa-
tional domain. At the same time, velocity is reﬂected sym-
metrically around z = 0 and z = Lz. The magnetic ﬁeld
components are also mirrored. In the case of initially vertical
magnetic ﬁeld, we let the Bx component change sign, whereas
in the case of initially horizontal magnetic ﬁeld, we let the Bz
component change sign. This forces the ﬁeld to remain verti-
cal (horizontal) at the boundary in the case of initially vertical
(horizontal) ﬁeld.

Athena uses the Godunov scheme which is known not to be
optimal at maintaining hydrostatic equilibrium (Zingale et al.
2002). The reason is that the pressure term in the momen-
tum equation is not solved simultaneously with the gravity

Figure A3. The patch with a high concentration of c diﬀuses out along the
circular magnetic ﬁeld. Snap shots at t = 0, 25, 75 and 200. The color scale
is from 10 to 10.2 and the perpendicular diﬀusion is small. The resolution in
this numerical experiment is 400 × 400.

A.1.3. Diﬀusion of a High-concentration Patch in a Circular

Magnetic Field

10

otherwise .

The ﬁnal and most challenging test that we carry out
for anisotropic transport was introduced in Parrish & Stone
(2005). We consider a Cartesian box of size [−1, 1] × [−1, 1]
with a patch with higher concentration c, speciﬁcally8
c = (cid:26)12

if 0.5 < r < 0.7 and − π/12 < θ < π/12 ,

(A8)
The density is uniform with ρ = 1 and the magnetic ﬁeld is
circular. In order to ensure ∇·B = 0, the magnetic ﬁeld was
initialized with a vector potential satisfying ∇ × A = B.
We considered the value D = 0.01 and run the simu-
lation until t = 200. The over concentration diﬀuses out
along the magnetic ﬁeld lines, as observed in Figure A3.
We have run this test problem with the same resolutions as
Sharma & Hammett (2007) and obtain the exact same values
quoted there for the error norms associated with the resolu-
tions 200 × 200 and 400 × 400. For instance, for a resolu-
tion of 200 × 200, we obtain L1 = 0.0264, L2 = 0.0407,
∞ = 0.0928, cmin = 10 and cmax = 10.1016 at t = 200 as
L
stated in Sharma & Hammett (2007).
is evident from Figure A3 that, even though only
It
anisotropic diﬀusion is explicitly turned on, there is still a
small amount of numerical, perpendicular diﬀusion. This is
undesired in simulations of instabilities because isotropic dif-
fusion will lower the growth rates or even quench the insta-
bilities. This was investigated by Parrish & Stone (2005) for
the MTI who found that it is, however, insensitive to perpen-

8 This test was constructed for the anisotropic heat conduction. We are
using the same initial values (10 and 12) as in the literature, making it easier
to compare the results. These values are of course not meaningful values for
c but it still serves as a test of the implementation of anisotropic diﬀusion.
The same considerations apply to the step function test.

12

Berlok & Pessah

magnetic ﬁeld and velocity do not have a gradient and so their
boundary conditions are simply periodic, i.e. ug = ui and Bg =
Bi. These are the boundary conditions we used in Section 4.

REFERENCES

term. There are ways to modify a Godunov scheme such that
this problem is circumvented, see for instance Zingale et al.
(2002); R. K¨appeli and S. Mishra (2014). We use a high nu-
merical resolution and a low Courant number (C = 0.4) in
order to maintain hydrostatic equilibrium as well as possible.
The minimum amplitude we can use for perturbations in u is,
however, limited by the numerical noise caused by the inabil-
ity of the code to perfectly maintain hydrostatic equilibrium,
in agreement with the ﬁndings of Parrish et al. (2012a).

B.2. Quasi-periodic boundary conditions

A key assumption in standard local linear mode anal-
ysis, such as presented in Pessah & Chakraborty (2013);
Berlok & Pessah (2015), is that the perturbations have the
spatial dependence exp(ik · x). This assumption is not ful-
ﬁlled for the reﬂective boundary conditions and it is thus im-
possible to cleanly excite a single eigenmode. The problem
being that the boundary conditions excite other modes in an
uncontrolled way. We originally realized this problem when
we studied the HBI but it persists in the case of the HPBI and
its diﬀusive variant. The problem is not present for the MTI
and the MTCI in the case kz = 0 because the boundaries are
periodic in x.

We have developed special boundary conditions that are
consistent with the assumptions used in the local mode anal-
ysis. One of the key assumptions here is that the perturbed
quantities δvx, δvz, δBx, δBz, δρ/ρ, δµ/µ and δT /T are peri-
odic. In the following, the values outside the computational
domain (the ghostzones) are denoted by a subscript g and the
values on the inside are denoted by a subscript i. The sub-
script ”eq” refers to the value of the equilibrium background
(as given in Section 3.1.1 or Section 3.1.2). The mapping
from interior to ghost zones (i → g) is the same as for pe-
riodic boundary conditions. Instead of directly mapping the
interior values to the ghostzones, we let the ghostzones de-
pend on the change in the interior values with respect to the
equilibrium background. The quasi-periodic boundary condi-
tions are then deﬁned as

ρg = ρg,eq 1 +
Tg = Tg,eq 1 +
µg = µg,eq 1 +

ρi − ρi,eq

! ,
ρi,eq
Ti − Ti,eq
! ,
! ,

Ti,eq
µi − µi,eq

µi,eq

(B5)

(B6)

(B7)

with the pressure given by Pg = ρgTg/µg. The equilibrium

704, 211

205, 509

137

417, 602

1295

3319

704

Bahcall, J. N., & Loeb, A. 1990, ApJ, 360, 267
Balbus, S. A. 2000, ApJ, 534, 420
—. 2001, ApJ, 562, 909
Berlok, T., & Pessah, M. E. 2015, ApJ, 813, 22
Bogdanovi´c, T., Reynolds, C. S., Balbus, S. A., & Parrish, I. J. 2009, ApJ,

Braginskii, S. 1965, Review of Plasma Physics
Chuzhoy, L., & Loeb, A. 2004, MNRAS, 349, L13
Chuzhoy, L., & Nusser, A. 2003, MNRAS, 342, L5
Durran, D. R. 2010, Numerical Methods for Fluid Dynamics (Springer)
Fabian, A. C. 1994, ARA&A, 32, 277
Fabian, A. C., & Pringle, J. E. 1977, MNRAS, 181, 5P
Gardiner, T. A., & Stone, J. M. 2005, Journal of Computational Physics,

Gilfanov, M. R., & Syunyaev, R. A. 1984, Soviet Astronomy Letters, 10,

Kunz, M. W. 2011, Monthly Notices of the Royal Astronomical Society,

Kunz, M. W., Bogdanovi´c, T., Reynolds, C. S., & Stone, J. M. 2012, The

Astrophysical Journal, 754, 122

Latter, H. N., & Kunz, M. W. 2012, MNRAS, 423, 1964
Markevitch, M. 2007, ArXiv e-prints, arXiv:0705.3289
McCourt, M., Parrish, I. J., Sharma, P., & Quataert, E. 2011, MNRAS, 413,

McCourt, M., Sharma, P., Quataert, E., & Parrish, I. J. 2012, MNRAS, 419,

Parrish, I. J., McCourt, M., Quataert, E., & Sharma, P. 2012a, MNRAS, 422,

—. 2012b, MNRAS, 419, L29
Parrish, I. J., & Quataert, E. 2008, ApJL, 677, L9
Parrish, I. J., Quataert, E., & Sharma, P. 2009, ApJ, 703, 96
—. 2010, ApjL, 712, L194
Parrish, I. J., & Stone, J. M. 2005, The Astrophysical Journal, 633, 334
—. 2007, The Astrophysical Journal, 664, 135
Parrish, I. J., Stone, J. M., & Lemaster, N. 2008, ApJ, 688, 905
Peng, F., & Nagai, D. 2009, The Astrophysical Journal, 693, 839
Pessah, M. E., & Chakraborty, S. 2013, ApJ, 764, 13
Quataert, E. 2008, The Astrophysical Journal, 673, 758
R. K¨appeli and S. Mishra. 2014, Journal of Computational Physics, 259, 199
Rasera, Y., & Chandran, B. 2008, The Astrophysical Journal, 685, 105
Ruszkowski, M., & Oh, S. P. 2010, ApJ, 713, 1332
Schekochihin, A. A., & Cowley, S. C. 2006, Astronomische Nachrichten,

327, 599, arXiv: astro-ph/0508535

Schekochihin, A. A., Cowley, S. C., Kulsrud, R. M., Hammett, G. W., &

Sharma, P. 2005, The Astrophysical Journal, 629, 139

Schekochihin, A. A., Cowley, S. C., Rincon, F., & Rosin, M. S. 2010,

MNRAS, 405, 291

Sharma, P., & Hammett, G. W. 2007, Journal of Computational Physics,

227, 123, arXiv:0707.2616 [astro-ph, physics:physics]

Shtykovskiy, P., & Gilfanov, M. 2010, MNRAS, 401, 1360
Spitzer, L. 1962, Physics of Fully Ionized Gases
Stone, J. M., & Gardiner, T. 2009, New Astronomy, 14, 139
Stone, J. M., Gardiner, T. A., Teuben, P., Hawley, J. F., & Simon, J. B. 2008,

The Astrophysical Journal Supplement Series, 178, 137

van Es, B., Koren, B., & de Blank, H. J. 2014, Journal of Computational

Zingale, M., Dursi, L. J., ZuHone, J., et al. 2002, The Astrophysical Journal

Physics, 272, 526

Supplement Series, 143, 539

