HALL POLYNOMIALS, INVERSE KOSTKA POLYNOMIALS AND PUZZLES

M. WHEELER AND P. ZINN-JUSTIN

Abstract. We study two diﬀerent one-parameter generalizations of Littlewood–Richardson coeﬃcients,
namely Hall polynomials and generalized inverse Kostka polynomials, and derive new combinatorial formulae
for them. Our combinatorial expressions are closely related to puzzles, originally introduced by Knutson
and Tao in their work on the equivariant cohomology of the Grassmannian.

1. Introduction

1.1. Background. Littlewood–Richardson coeﬃcients, cλ
tion of Schur functions:

µν, are the structure constants for the multiplica-

sµsν =Xλ

cλ
µνsλ.

6
1
0
2

 
r
a

M
6

 

 
 
]
h
p
-
h
t
a
m

[
 
 

1
v
5
1
8
1
0

.

3
0
6
1
:
v
i
X
r
a

(1)

(2)

where λ, µ, ν are three partitions. They are also structure constants of the Grothendieck ring of polynomial
representations of GL(n) (ignoring all partitions with more than n rows); if we discard as well partitions whose
ﬁrst part is greater than m, we obtain the structure constants of the cohomology ring of the Grassmannian
Gr(n, m + n). The computation of cλ
µν has a long history, starting with the original work of Littlewood
and Richardson [25] providing a rule for computing them, which was only rigorously proved some forty
years later by Thomas [30] and Sch¨utzenberger [29]; since then, many alternative formulations have been
given, including the puzzle rule of Knutson and Tao [19] used in their proof of the saturation conjecture
[18]. The puzzle formulation is important for our purposes because it displays most explicitly the underlying
integrability of the cλ

µν [34].

1.2. Description of the paper. Schur functions are specializations of a diverse range of symmetric func-
tions1. These include Hall–Littlewood, q–Whittaker and Jack polynomials as one-parameter generalizations,
and Macdonald polynomials with two extra parameters. It is natural to ask whether the puzzle approach
of [19, 20] can be applied to these other families, leading to new combinatorial expressions for the relevant
structure constants. In this paper, we focus on the Hall–Littlewood polynomials. There are various moti-
vations for introducing them: 1. They interpolate between Schur polynomials (at the value t = 0 of the
parameter), Schur Q-polynomials (at t = −1) and monomial symmetric polynomials (at t = 1); 2. On the
geometric/representation-theoretic side, they occur when lifting the Borel–Weil construction to the cotan-
gent bundle of the ﬂag variety [6, 7], and (up to a plethystic substitution) in relation to the cohomology of
the Springer ﬁber [14]; 3. Their structure constants, the Hall polynomials, count short exact sequences of
ﬁnite abelian p-groups for t = p [13].

We will study here two diﬀerent generalizations of cλ

µν. The ﬁrst are the Hall polynomials f λ

µν(t), mentioned

just above, which arise in the multiplication of Hall–Littlewood polynomials [27]:

PµPν =Xλ

f λ
µν (t)Pλ.

µν (x; t) in an integrable lattice model. More speciﬁcally, F λ

Our ﬁrst key result is Theorem 1, which expresses f λ
µν (t) via the action of divided-diﬀerence operators on a
partition function F λ
µν(x; t) is a non-symmetric
homogeneous polynomial of degree d in a set of variables x. By acting with a product of d divided-diﬀerence
operators on F λ
It is by no means unusual
that divided-diﬀerence operators should be used in such a context. Indeed, Schubert polynomials can be
[23], and the
Schubert structure constants can themselves be obtained via the action of skew divided-diﬀerence operators

deﬁned via the action of divided-diﬀerence operators on a staircase monomial Qn

µν (t), up to known multiplicative factors.

µν (x; t) we recover f λ

i=1 xn−i

i

1In a diﬀerent direction, and one that preserves links with enumerative geometry, they are also special cases of Schubert

polynomials (see, for example, the reviews [26] and [17]).

1

2

M. WHEELER AND P. ZINN-JUSTIN

on Schubert polynomials [26, 15]. By evaluating the action of these operators on the partition function
F λ

µν (x; t) we obtain Theorem 2, a combinatorial formula for f λ
The second generalization pertains to an intermediate situation, namely the product of a Schur and

µν(t) in terms of lattice tilings.

Hall–Littlewood polynomial expanded in the Schur basis:

sµPν =Xλ

¯K λ

µν (t)sλ.

The structure constants ¯K λ
µν(t) are clear generalizations of the inverse Kostka polynomials [27] (the latter are
recovered by setting µ = 0), but to our best knowledge they are unstudied in the literature. In Theorem 3,
we express ¯K λ
µν (x; t) in another
integrable lattice model, diﬀerent from that of Theorem 1. Evaluating the action of these operators on the
partition function Kλ
µν(t) in terms of lattice
tilings analogous to those used in Theorem 2.

µν(t) via the action of divided-diﬀerence operators on a partition function Kλ

µν (x; t), we arrive at Theorem 4, a combinatorial formula for ¯K λ

It is important to note that, while the tiling formulae in Theorems 2 and 4 are conceptually analogous
to the puzzles of [19, 20], they do not reduce to the latter at t = 0. This raises the question of where the
Knutson–Tao puzzles sit in the landscape of this paper. It turns out that they can be recovered from the
same model (at t = 0) as that used to study ¯K λ
µν(t), but using a diﬀerent partition function, which we denote
Cλ
µν (x). This is the content of Theorem 5. From there we are able to express cλ
µν in terms of similar lattice
tilings to those used to evaluate f λ
µν(t), before stating that these tilings are in bijection with the
puzzles of [19, 20].

µν (t) and ¯K λ

1.3. General approach. Since the same basic method will be applied in each of the cases (1)–(3), it is
worthwhile to give a uniﬁed description here. First, we remark that each product rule has a corresponding
coproduct version which arises from duality arguments. The coproduct versions of (1)–(3) are, respectively,

(3)

(4)

sλ/µ =Xν

cλ

µν sν, Qλ/µ =Xν

f λ

µν(t)Qν , Sλ/µ =Xν

¯K λ

µν(t)Qν ,

where the left hand side of each identity is a certain symmetric polynomial assigned to a skew Young diagram
(see [27] and the rest of this paper for further details). It is these identities which will be our focus.

In the initial step of our approach, we write the left hand side of each coproduct identity (4) as an
expectation value of monodromy matrix operators in a suitable integrable lattice model. In the case of skew
Hall–Littlewood Qλ/µ and Schur polynomials sλ/µ, it is well-known that this can be done using a model of
t-deformed bosons (and its t = 0 specialization) [31, 22, 4, 5, 32, 1]. In the case of the skew polynomials
Sλ/µ (which are the skew version of the “t-Schur” polynomials2 deﬁned in Section 4, Chapter III of [27]) a
similar construction is possible, using a free-fermionic six-vertex model. All such expectation values can be
interpreted schematically as lattice partition functions of the form

λ

µ

in which the partitions λ, µ are encoded as particle states at the top and bottom of the lattice (and the left
and right edges have appropriate, uniform boundary conditions). A rapidity variable xi is assigned to the
i-th row of the lattice for all i, and the uniformity of the side boundary conditions ensures that the partition
function is symmetric in its rapidities.

In the second step, it is necessary to ﬁnd a higher-rank version of the models discussed above. The ﬁrst of
these is a model containing two commuting copies of the t-boson algebra, and accordingly we refer to it as a
“boson-boson” model. The entries of its L-matrix act in a tensor product B ⊗ B of two bosonic Fock spaces,
meaning that states in the Hilbert space H are now indexed by a pair of partitions. The second model is

2Macdonald gave no name to Sλ(x; t) in [27], but they are sometimes termed “big” Schur functions in the literature.

a “fermion-boson” model, and the entries of its L-matrix act in a tensor product F ⊗ B of a fermionic and
bosonic Fock space. In both models, we are then interested in partition functions of the type

3

(5)

( , ν)

(λ, 0)

(µ, )

where (λ, 0) denotes the state |λi ⊗ |0i (i.e. the state in H indexed by the pair of partitions λ and 0) and
(µ, ) denotes the state hµ| ⊗ h | (i.e. the state in H ∗ indexed by µ and the empty, or trivial, partition3).
The boundary conditions at the left edge of the lattice, denoted ( , ν), are no longer uniform; they now
encode a third partition ν. As before, each row of the lattice has a corresponding rapidity variable, but the
non-uniformity of the left boundary means that the resulting partition function is no longer symmetric in
its x variables.

This partition function can then be directly related to the structure constants under consideration. They
are either recovered under the action of divided-diﬀerence operators (acting on the rapidity variables), as
is the case for f λ
µν (t), or else can be read oﬀ as the coeﬃcient of a single monomial in x,
which is the case for cλ
µν . The layout of the partition function (5), which is framed by three non-trivial
partitions, resembles closely the puzzles introduced in [19, 20]. In the case of cλ
µν, we are able to make this
correspondence precise.

µν(t) and ¯K λ

1.4. Notation and conventions. A partition λ = (λ1, . . . , λℓ) is a ﬁnite, weakly-decreasing sequence of
non-negative integers: λ1 > · · · > λℓ > 0. The part-multiplicities mi(λ) of a partition λ indicate the number
of repetitions of each part:

and we take the length of λ to be the sum of all multiplicities, ℓ(λ) =Pi>0 mi(λ). Note that we include

parts of size zero in our deﬁnition of the length, which is non-standard. The complement of a partition by
L, denoted ¯λ when the value of L is clear from context, is the partition with parts

λ = 0m01m12m2 . . . ,

¯λi = L − λℓ−i+1,

1 6 i 6 ℓ,

ℓ ≡ ℓ(λ).

We use the notation λ/µ ∈ h to indicate that the skew diagram λ − µ forms a horizontal strip, and
λ/µ ∈ hk to specify that the horizontal strip contains k boxes. Similar conventions apply to λ/µ ∈ v and
λ/µ ∈ vk, which indicate vertical strips.

Divided-diﬀerence operators are denoted ∆i,j, and deﬁned as

∆i,j =

1

xi − xj

(σi,j − 1),

where σi,j transposes xi and xj, namely σi,j(g(. . . , xi, . . . , xj, . . . )) = g(. . . , xj, . . . , xi, . . . ) for any function
g. We will only consider the case where j = i + 1, when it is convenient to write ∆i,i+1 ≡ ∆i.

To improve clarity of presentation, we will distinguish bosonic and fermionic operators by colour-coding.
Bosonic operators, vector spaces and corresponding basis elements will be coloured green (or black), while
those of fermions will be coloured red.

2. Hall–Littlewood polynomials from a rank-one model of bosons

2.1. Bosonic Fock space B. Consider a semi-inﬁnite one-dimensional lattice, with sites labelled by non-
negative integers. In a ﬁnite conﬁguration of this lattice each site i > 0 is occupied by mi > 0 particles, and
there exists M ∈ N such that mk = 0 for all k > M . The bosonic Fock space B is obtained by taking linear
combinations of all possible ﬁnite conﬁgurations:

(6)

B = Span {|m0i0 ⊗ |m1i1 ⊗ |m2i2 ⊗ · · · } ,

mi > 0, ∀ i > 0.

3In this work, we distinguish between zero partitions (0, . . . , 0) containing a certain number of repetitions of 0, and the

empty partition.

4

M. WHEELER AND P. ZINN-JUSTIN

The Fock space B will be the physical space for the model that we are about to study. It has a natural dual
vector space

B∗ = Span {hm0|0 ⊗ hm1|1 ⊗ hm2|2 ⊗ · · · } ,

mi > 0, ∀ i > 0,

whose action on B is deduced by linearity and the relation

hm|ni =

∞Yi=0

δmi,ni ,

∀ hm| =

hmk|k,

|ni =

∞Ok=0

|nkik.

∞Ok=0

2.2. Mapping partitions to states in B. There is a simple mapping between partitions and the basis
vectors of B. Given a partition λ = 0m01m12m2 . . . , associate the following state | λ−→i ∈ B:

| λ−→i =

∞Ok=0

|mkik.

Whenever we wish to display the partition λ = (λ1, . . . , λℓ) explicitly we will write | λ−→i = |(λℓ, . . . , λ1)i,
with parts increasing from left to right. We will use | i to denote the completely empty state; the state for
which all occupation numbers mi are zero.

Example 1. Consider the partition λ = (5, 3, 3, 1, 0), for which m0(λ) = 1, m1(λ) = 1, m3(λ) = 2,
m5(λ) = 1, and all other mk(λ) = 0. Then

| λ−→i = |1i0 ⊗ |1i1 ⊗ |0i2 ⊗ |2i3 ⊗ |0i4 ⊗ |1i5 ⊗ |0i6 ⊗ · · · .

This mapping admits a simple pictorial interpretation. Starting from the Young diagram of λ (in its tradi-
tional orientation), we assign particles to each upward edge at the boundary of λ. These particles are then
projected down onto the integer lattice, whereby some sites become multiply-occupied:

m0 m1 m2 m3 m4 m5 m6 · · ·

The corresponding basis vector | λ−→i ∈ B is then obtained by reading the occupation numbers along the
integer lattice.

2.3. Reverse partition states. Let λ = 0m01m12m2 . . . be a partition and L = λ1 its largest part. The
reverse partition state | λ←−i ∈ B is deﬁned as

| λ←−i =

∞Ok=0

|mkik,

mk = mL−k, ∀ 0 6 k 6 L,

mk = 0, ∀ k > L.

Reverse partition states can also be written as | λ←−i = |(λ1, . . . , λℓ)i, with parts decreasing from left to right.

Example 2. Let µ = (5, 4, 2, 2, 0), for which m0(µ) = 1, m2(µ) = 2, m4(µ) = 1, m5(µ) = 1, and all other
mk(µ) = 0. This yields m5(µ) = 1, m3(µ) = 2, m1(µ) = 1, m0(µ) = 1, and all other mk(µ) = 0. Then

µ
|
←−i = |1i0 ⊗ |1i1 ⊗ |0i2 ⊗ |2i3 ⊗ |0i4 ⊗ |1i5 ⊗ |0i6 ⊗ · · · ,

which is the same state as in Example 1. Graphically, the reverse partition state can be obtained by ﬁrst
rotating the Young diagram of µ by 180◦, then performing the same projection procedure as above:

5

m0 m1 m2 m3 m4 m5 m6 · · ·

From this picture the relationship with Example 1 is explained: the chosen partitions λ and µ are related
under complementation (λ is indicated using darkly shaded boxes) This leads us to the following result,
directly relating reverse partition states with the complementation of partitions.

Proposition 1. Let λ be a partition with largest part L, and ¯λ the complement of λ by L. Then | λ←−i = |

¯λ−→i.

2.4. A rank-one model of bosons. Introduce bosonic creation and annihilation operators φ† and φ, and
the particle-number operator N , which satisfy the bilinear relations

(7)

φφ† − tφ†φ = 1 − t,

[N , φ] = −1,

[N , φ†] = 1.

Let b denote the algebra generated by {φ, φ†, N} modulo the relations (7). We shall use the standard Fock
representation of b on a single site of B:

φ†|mi = (1 − tm+1)|m + 1i, φ|mi = |m − 1i, N |mi = m|mi,

where it is assumed that φ|0i = 0. The L-matrix4

(8)

L∗

a(x|b) =(cid:18) 1

xφ

φ†

x(cid:19)a

satisﬁes the intertwining equation

=

a

Rab(y/x)L∗

a(x|b)L∗

b (y|b) = L∗

b (y|b)L∗

a(x|b)Rab(y/x),

with R-matrix given by

(9)

Rab(z) =

1 − tz

0

0

0
0
0

t(1 − z)

(1 − t)z

1 − t

0

1 − z

0

0
0
0

1 − tz

ab

.

It is very useful to adopt a graphical representation for the entries of the L-matrix, as shown on the right of
(8). We refer to these as tiles. Expectation values of an entry of the L-matrix are then indicated by placing
occupation numbers at the top and bottom edges of its corresponding tile. For example,

h3|φ†|2i ≡

2

3

= (1 − t3),

h0|xφ|1i ≡

= x.

1

An alternative notation is to indicate an occupation number, n, by n lines that propagate vertically through
a tile (see, for example, [5]), but we will mostly avoid this convention in the present work.

The preceding construction gives the t-boson model [2, 3, 32], and the R-matrix (9) is that of the six-
vertex model. We construct a monodromy matrix by taking a product of L-matrices over all non-negative
sites i of the integer lattice:

T ∗
a (x) = L∗

a(x|b0)L∗

a(x|b1) · · · =

L∗

a(x|bi) :=(cid:18)A(x) B(x)
C(x) D(x)(cid:19)a

,

∞Yi=0

4We denote the L-matrix (8) by L∗ for consistency with our notation in [32].

6

M. WHEELER AND P. ZINN-JUSTIN

where the L-matrix at each site depends on its own copy of the algebra b, and diﬀerent copies are assumed to
be commuting. In our subsequent constructions we mainly consider A(x) ∈ End(B), which can be regarded

as the sum of all possible (semi-inﬁnite) rows of the tiles (8), whose left-most tile is

or

and such that

suﬃciently far to the right only
from the intertwining equation once it is applied to two monodromy matrices T ∗

occurs. One has [A(x), A(y)] = 0 for all x, y, which follows immediately

a (x), T ∗

b (y).

2.5. Skew Hall–Littlewood polynomials Pλ/µ(x; t). We survey some basic facts about Hall–Littlewood
polynomials. For more details on the theory, we refer the reader to [27]. Hall–Littlewood polynomials are a
t-deformation of the Schur polynomials, which are given explicitly by

Pλ(x1, . . . , xn; t) = Xσ∈Sn

nYi=1

xλi

i Y16i<j6n

σ

xi − txj

xi − xj  .

They are orthogonal with respect to the Hall inner product:

bλ(t) =Yi>1

mi(λ)Yj=1

(1 − tj).

(10)

hQλ, Pµi = δλ,µ,

Qλ(x1, . . . , xn; t) = bλ(t)Pλ(x1, . . . , xn; t),

This orthogonality relation can be used to deﬁne skew Hall–Littlewood polynomials Pλ/µ(x; t):

(11)

hQλ, PµPν i := hQλ/µ, Pν i,

Qλ/µ(x1, . . . , xn; t) =

bλ(t)
bµ(t)

Pλ/µ(x1, . . . , xn; t).

From the point of view of integrable lattice models, the most important property of the Hall–Littlewood
polynomials is their branching rule:

Pλ(x1, . . . , xn, y1, . . . , ym; t) =Xµ

Pλ/µ(x1, . . . , xn; t)Pµ(y1, . . . , ym; t),

valid for any partition λ and any two sets of variables (x1, . . . , xn), (y1, . . . , ym), and where the sum on the
right hand side is taken over all partitions µ. This allows Pλ/µ(x1, . . . , xn; t) to be constructed recursively,
provided that the skew Hall–Littlewood polynomial in one variable is known. In fact, the latter has a very
simple form:

Pλ/µ(z; t) =

ψλ/µ(t)z|λ−µ|,

λ/µ ∈ h,

0,

otherwise,

ψλ/µ(t) =

Y

i>1:mi(µ)=mi(λ)+1

(1 − tmi(µ)).

In view of (13) and the branching rule (12), skew Hall–Littlewood polynomials can then be expressed as a
sum over sequences of interlacing partitions (equivalently, in terms of semi-standard Young tableaux):

(14)

Pλ/µ(x1, . . . , xn; t) =

Xµ≡ν(0)≺···≺ν(n)≡λ

nYi=1

ψν(i)/ν(i−1) (t) x|ν(i)−ν(i−1)|

i

,

where we write ν(i−1) ≺ ν(i) to indicate that ν(i)/ν(i−1) ∈ h.

2.6. Lattice expression for Pλ/µ(x; t). Next, we review the well-known construction of Hall–Littlewood
polynomials as expectation values in the t-boson model [31, 22].

Lemma 1. Skew Hall–Littlewood polynomials are given by the following expectation value:

(12)

(13)

(15)

Proof. By inserting a complete set of states in the expectation value on the right hand side of (15), we have

j=1

Pλ/µ(x1, . . . , xn; t) = Qm0(λ)
Qm0(µ)
−→|A(x1) . . . A(xn)| λ−→i =Xν

j=1

µ

h

(1 − tj)

(1 − tj)

µ

−→|A(x1) . . . A(xn)| λ−→i.
h

µ

−→|A(x1) . . . A(xn−1)| ν−→ih ν−→|A(xn)| λ−→i.
h

Owing to the branching rule (12), to complete the proof it suﬃces to show that

(16)

j=1

Pλ/ν (z; t) = Qm0(λ)
Qm0(ν)

j=1

(1 − tj)

(1 − tj)

h ν−→|A(z)| λ−→i

for any two partitions λ and ν, which is simply the one-variable case of (15). We must show that the right
hand side of (16) matches that of (13). By studying the lattice representation of h ν−→|A(z)| λ−→i, for example

h(0, 0, 1, 3, 4)|A(z)|(0, 1, 3, 3, 5)i =

m0(λ) m1(λ) m2(λ) m3(λ) m4(λ) m5(λ)

· · ·

1

2

1

1

1

2

1

1

m0(ν) m1(ν) m2(ν) m3(ν) m4(ν) m5(ν)

· · ·

= z4(1 − t2)(1 − t),

7

it is immediately apparent that h ν−→|A(z)| λ−→i = 0 if λ/ν 6∈ h (since there is no way to connect the two states
using only the tiles in the L-matrix (8)). If λ/ν ∈ h, we acquire a weight of z for every horizontal unit step
taken by the green line, which gives the correct factor z|λ−ν|. Also, in the transition from λ to ν, every time
the number of particles at a lattice site increases from m − 1 to m we acquire a factor of 1 − tm. This gives

rise to the total factor ψλ/ν (t)Qm0(ν)

i=1

(1 − ti)/Qm0(λ)

i=1

(1 − ti).

(cid:3)

Example 3. Let λ = (3, 1, 1) and µ = (0, 0, 0). Then Pλ/µ(x1, x2, x3; t) = Pλ(x1, x2, x3; t) can be expressed
as

(1 − ti)Pλ(x1, x2, x3; t) =

m0(µ)Yi=1

+

+

1

1

1

1

1

+

2

1

2

1

1

1

2

3

1

2

3

1

2

3

1

2

3

2

1

2

1

1

1

1

2

1

1

2

2

1

1

1

1

+

+

1

2

3

1

2

3

1

1

1

x3

x2

x1

x3

x2

x1

in which all possible lattice conﬁgurations are summed over. Calculating the Boltzmann weight of each
conﬁguration, we obtain the explicit sum

(1 − ti)Pλ(x1, x2, x3; t) =

m0(µ)Yi=1
(1 − t)(1 − t2)(1 − t3)(cid:16)x3
The common factorQm0(µ)

same across all conﬁgurations.

i=1

3(cid:17).

1x2x3 + (1 − t)x2

1x2

2x3 + x1x3

2x3 + (1 − t)x1x2

2x2

3 + x1x2x3

3 + (1 − t)x2

1x2x2

(1 − ti) = (1 − t)(1 − t2)(1 − t3) originates from the zeroth column, which is the

The expression (15) depends on the partitions λ and µ only via the boundary conditions. Naturally, there

is the option to evaluate the partition function under 180◦ rotation, which leads to

Lemma 2. Skew Hall–Littlewood polynomials are given alternatively by the following expectation value:

Qλ/µ(x1, . . . , xn; t) = h λ←−|A(x1) . . . A(xn)|

µ
←−i = h

¯λ−→|A(x1) . . . A(xn)|

¯µ
−→i,

where ¯λ and ¯µ denote the complements of λ and µ by L, the largest part of λ.

Proof. By rearranging factors, equation (15) can be written as

Qλ/µ(x1, . . . , xn; t) =

Bλ(t)
Bµ(t)

µ

−→|A(x1) . . . A(xn)| λ−→i,
h

Bλ(t) :=

(1 − ti)bλ(t).

m0(λ)Yi=1

8

M. WHEELER AND P. ZINN-JUSTIN

−→|A(x1) . . . A(xn)| λ−→i, and consider rotating the associated partition
Now take the lattice representation of h
function by 180◦. From the form of the L-matrix (8), it is easy to deduce that it remains invariant under
this rotation, up to the factor Bµ(t)/Bλ(t), which cancels the factor already present. Hence,

µ

Qλ/µ(x1, . . . , xn; t) = h λ←−|A(xn) . . . A(x1)|

µ
←−i,

and we are done in view of the commutativity of the A(xi) operators.

(cid:3)

3. Hall polynomials from a rank-two model of bosons

3.1. Model with two bosons. We now consider a higher-rank version of the model in Section 2.4. This
model has also appeared recently in [8], where it is the second in a series of higher-rank bosonic models,
used in an integrable construction of Macdonald polynomials. The entries of its L-matrix act in B ⊗ B, the
tensor product of two bosonic spaces, and are given by

(17)

La(x|b ⊗ b) =



x[1 ⊗ 1] x[1 ⊗ φ†] x[φ† ⊗ 1]

tN ⊗ φ

tN ⊗ 1

0

φ ⊗ 1

φ ⊗ φ†

1 ⊗ 1

a

=



0

.

a

By considering only the entries (1,1), (1,3), (3,1) and (3,3) of the L-matrix (17) it reduces to the model (8),
up to inversion of and multiplication by x. The L-matrix satisﬁes the intertwining equation

(18)

Rab(x/y)La(x|b ⊗ b)Lb(y|b ⊗ b) = Lb(y|b ⊗ b)La(x|b ⊗ b)Rab(x/y)

with respect to the R-matrix

Rab(z) =



1 − tz

0

0
0
0
0
0
0
0
0

t(1 − z)

0

1 − t

0
0
0
0
0

0
0

t(1 − z)

0
0
0

1 − t

0
0

0

(1 − t)z

0

1 − z

0
0
0
0

1 − tz

0
0
0
0
0

0
0
0
0
0

0
0
0
0

t(1 − z)

0

1 − t

0

0
0

(1 − t)z

0
0
0

1 − z

0
0

0
0
0
0
0

(1 − t)z

0

1 − z

0

0
0
0
0
0
0
0
0

1 − tz

ab

.

We construct a monodromy matrix using the L matrix, namely

(19)

Ta(x) = La(x|b0 ⊗ b0)La(x|b1 ⊗ b1) · · · =

La(x|bi ⊗ bi).

∞Yi=0

Since La(x|b ⊗ b) is a 3 × 3 matrix, the result of the matrix multiplication (19) is also a 3 × 3 matrix:

Ta(x) =

T (x)
T (x)
T (x)

⋆ ⋆
⋆ ⋆

⋆ ⋆a

,

where T (x), T (x), T (x) are operators acting in B ⊗ B. We suppress the matrix entries in the remaining two
columns, since they are never used in our calculations. Two commutation relations will be important in our
later calculations:

(y − x)T (x)T (y) + (1 − t)yT (x)T (y) = (y − tx)T (y)T (x),

T (x)T (y) = T (y)T (x).

3.2. Deﬁnition of the Hall polynomials. Hall polynomials f λ
µν (t) are the structure constants of the Hall
algebra, originally studied in [13]. Equivalently, they are the expansion coeﬃcients in the product of two
Hall–Littlewood polynomials:

9

Pµ(x; t)Pν (x; t) =Xλ

f λ
µν(t)Pλ(x; t).

It is a non-trivial fact that f λ
µν (t) ∈ Z[t], justifying the nomenclature “polynomial”. However, unlike the
Kostka polynomials (to be discussed later on), f λ
µν (t) are polynomials in t with integer coeﬃcients (rather
than natural number coeﬃcients). A priori, this rules out hope of a positive combinatorial formula for
f λ
µν (t). In addition to their polynomiality they satisfy a number of properties [27]:

1. If the Littlewood–Richardson coeﬃcient cλ

µν = 0, then f λ
µν(t) is non-zero only if |λ| = |µ| + |ν| and µ, ν ⊆ λ.

that f λ

µν(t) = 0 identically. This implies, in particular,

2. For all λ, µ, ν, one has the symmetry f λ
3. The quasi-symmetry f λ

µν(t) = f ¯µ
µ, L being the largest part of λ.

µν (t) = f λ

νµ(t).

¯λν (t)B¯λ(t)/B¯µ(t) holds, where ¯λ and ¯µ are the L-complements of λ and

Due to the deﬁnition (11), the Hall polynomials can also be considered as the expansion coeﬃcients of a

skew Hall–Littlewood polynomial:

Qλ/µ(x; t) =Xν

f λ
µν(t)Qν (x; t),

and it is this latter point of view which is the most convenient for our purposes. Our aim in this work is to
obtain a new combinatorial formula for f λ

µν(t), using the integrable model introduced above.

3.3. Hall polynomials as constant terms. Here we derive a useful identity expressing the Hall polynomial
f λ
µν (t) as the coeﬃcient of a particular monomial in a certain formal power series (which we refer to as a
constant term identity).

Lemma 3. Let λ, µ, ν be three partitions, and suppose ℓ(ν) = n. The (renormalized) Hall polynomial
µν (t)bν(t) is given by the coeﬃcient of zν1
f λ

n in the expression

1 . . . zνn

Y16i<j6n(cid:18) 1 − zj/zi

1 − tzj/zi(cid:19) Qλ/µ(z1, . . . , zn; t),

interpreted as a formal power series in z1, . . . , zn (or by assuming |zj/zi| are small for all 1 6 i < j 6 n.)

Proof. Following Section 2, Chapter III of [27], the Hall–Littlewood polynomial Qλ(x1, . . . , xm; t) is given
by the coeﬃcient of zλ1

n in the expression

1 . . . zλn

1 − tzj/zi(cid:19) mYi=1

nYj=1(cid:18) 1 − txizj
1 − xizj (cid:19) .

Qµ(x1, . . . , xm; t)Pµ(z1, . . . , zn; t),

Combining this with the Cauchy identity

mYi=1

nYj=1(cid:18) 1 − txizj

Y16i<j6n(cid:18) 1 − zj/zi
1 − xizj (cid:19) =Xµ
Qµ(x1, . . . , xm; t) × Coeﬀ Y16i<j6n(cid:18) 1 − zj/zi
Coeﬀ Y16i<j6n(cid:18) 1 − zj/zi

we ﬁnd that

Xµ

By the linear independence of the {Qµ}, this means that

1 − tzj/zi(cid:19) Pµ(z1, . . . , zn; t), zλ1

1 − tzj/zi(cid:19) Pµ(z1, . . . , zn; t), zλ1

1 . . . zλn

1 . . . zλn

n  = Qλ(x1, . . . , xn; t).
n  = δλ,µ.

10

M. WHEELER AND P. ZINN-JUSTIN

Hence if we expand any symmetric polynomial G(x1, . . . , xn) in terms of Hall–Littlewood polynomials,

G(x1, . . . , xn) =Pλ gλ(t)Pλ(x1, . . . , xn; t), the expansion coeﬃcients are given by
n  = gλ(t).
n  = f λ

Coeﬀ Y16i<j6n(cid:18) 1 − zj/zi
Coeﬀ Y16i<j6n(cid:18) 1 − zj/zi

1 − tzj/zi(cid:19) Qλ/µ(z1, . . . , zn; t), zν1

1 − tzj/zi(cid:19) G(z1, . . . , zn), zλ1

1 . . . zλn

(20)

In particular, choosing G(x1, . . . , xn) = Qλ/µ(x1, . . . , xn; t), we recover the Hall polynomials:

1 . . . zνn

µν(t)bν(t).

3.4. Hall polynomials from action of divided-diﬀerence operators.

Deﬁnition 1. Let ν = (ν1, . . . , νn) be a partition. Associate a set k(ν) = {k1, . . . , kn} to ν, where

(cid:3)

ki = i +

nXj=n−i+1

νj.

We call k(ν) the shifted partial sums of ν. One simple interpretation of k(ν) comes from arranging the boxes
of a Young diagram ν along the integer lattice. For example,

ν = (3, 1, 1, 0) ↔

↔ k(ν) = {1, 3, 5, 9}.

1

3

5

9

Theorem 1. Let λ, µ, ν be three partitions with respective lengths ℓ, m, n such that ℓ = m, and largest
parts L, M, N such that M > L and M > N . Let ¯λ, ¯µ, ¯ν denote the partitions obtained by complementing
each part of λ, µ, ν by M , and assume that |¯λ| = |¯µ| + |¯ν|. Then

(21)

F λ

µν(x; t) := h

µ
←−| ⊗ h |

n+|ν|Yi=1 (cid:26) T (xi),

T (xi),

i ∈ k(ν)

i 6∈ k(ν) (cid:27) | λ←−i ⊗ | 0←−i

is a homogeneous polynomial in {x1, . . . , xn+|ν|} of total degree n + |ν|, and the Hall polynomial f ¯λ
given by the repeated action of divided-diﬀerence operators on this partition function:

¯µ¯ν(t) is

(22)

¯λ
¯µ¯ν(t) = t−(m+1)|ν| ×

f

B¯λ(t)

B¯µ(t)b¯ν(t)

× Yj6∈k(ν)

∆j Yi∈k(ν)

¯xi F λ

µν(x; t),

where the product of divided-diﬀerence operators is ordered from left to right, starting at j = 1 and ﬁnishing
at j = n + |ν|, and omitting j ∈ k(ν).

The rest of the section will be devoted to the proof of Theorem 1. Before proceeding to the proof, we give

an example which better illustrates the meaning of (21).

Example 4. Fix three partitions λ = (2, 1, 0, 0), µ = (3, 3, 1, 1), ν = (2, 1, 1). Then M = 3 and the
complement partitions are given by ¯λ = (3, 3, 2, 1), ¯µ = (2, 2, 0, 0), ¯ν = (2, 2, 1), so that |¯λ| = |¯µ| + |¯ν|. We
have

F λ

µν(x; t) = h

µ

←−| ⊗ h |T (x1)T (x2)T (x3)T (x4)T (x5)T (x6)T (x7)| λ←−i ⊗ | 0←−i

which has the graphical representation

λ

m3(λ)

m2(λ)

m1(λ)

m0(λ)

1

1

2

4

11

k(ν)

x7

x6

x5

x4

x3

x2

x1

2

m3(µ)

m2(µ)

2

m1(µ)
µ

m0(µ)

The corresponding Hall polynomial is given by

¯λ
¯µ¯ν(t) =

f

∆1∆3∆5∆6 ¯x2 ¯x4 ¯x7F λ
t16(1 − t)(1 − t2)2

µν (x; t)

.

3.4.1. Proof of homogeneity and degree. Since the L matrices (17) are used in the construction of the partition
function F λ
µν(x; t), we obtain an x weight every time the left edge of a lightly-shaded tile is vacant. Conversely,
there is no x weight when such an edge is occupied. Let us abbreviate these by VLEs and OLEs (vacant
and occupied left edges).

In any legal lattice conﬁguration, the green particles give rise to |µ| − |λ| = |¯ν| = M n − |ν| OLEs, while
the black particles give rise to (M + 1)|ν|. This is a combined M (n + |ν|) OLEs, meaning that in any legal
conﬁguration there are exactly (M + 1)(n + |ν|) − M (n + |ν|) = n + |ν| VLEs, each with an associated x
weight. The homogeneity and degree of the polynomial follow immediately. Furthermore since there is a
trivial VLE in the ki-th row, for all 1 6 i 6 n, F λ
µν(x; t) has an obvious common factor of xk1 . . . xkn . This

common factor is divided away byQi∈k(ν) ¯xi.

3.4.2. Multiple sum expression for F λ
sum. To do that, we recall the commutation relations

µν(x; t). The ﬁrst step is to calculate F λ

µν(x; t) explicitly as a repeated

(23)

(24)

T (x)T (y) =

y − tx
y − x

T (y)T (x) +

(1 − t)y

x − y

T (x)T (y),

T (x)T (y) = T (y)T (x).

Lemma 4. By virtue of the commutation relations (23) and (24), one can derive the following relation:

(25)

µ
h
←−| ⊗ h |T (x1) . . . T (xk−1)T (xk) =

µ
←−| ⊗ h |T (xk)T (x1) . . . T (xk−1)

+ xk

k−1Xi=1

valid for any k > 1.

k−1Yj=1(cid:18) xk − txj
xk − xj (cid:19) h
 (1 − t)
k−1Yj6=i(cid:18) xi − txj
xi − xj (cid:19) h

xi − xk

µ

←−| ⊗ h |T (xi)T (x1) . . . bT (xi) . . . T (xk) ,

Proof. This is a well-known equation in models solvable by the algebraic Bethe Ansatz [10, 21]. The leading
term on the right hand side of (25) comes from applying k − 1 times the commutation relation (23), and
retaining only the term (xk − txj )/(xk − xj)T (xk)T (xj) at each step (since this is the only way to produce
terms proportional to h

µ
←−| ⊗ h |T (xk)T (x1) . . . T (xk−1), as we desire).

12

M. WHEELER AND P. ZINN-JUSTIN

Now isolate the i = k − 1 term from the sum on the right hand side of (25). This comes from applying the
commutation relation (23) once and retaining the term (1 − t)xk/(xk−1 − xk)T (xk−1)T (xk), then applying
(23) a further k − 2 times and retaining only the term (xk−1 − txj)/(xk−1 − xj )T (xk−1)T (xj ) at each step
µ
(again, this is the only way to produce terms proportional to h
←−| ⊗ h |T (xk−1)T (x1) . . . T (xk−2)T (xk),
which is our current focus).

The other terms in the sum can be deduced by symmetrizing the i = k − 1 term, since the left hand side
(cid:3)

of equation (25) is symmetric in {x1, . . . , xk−1}.

Next, we notice that (25) can be written more succinctly as a single sum:

(26)

¯xk × h

µ
←−| ⊗ h |T (x1) . . . T (xk−1)T (xk) =

Repeatedly iterating (26), it is then straightforward to show that

kXi=1

¯xiQk−1
Qk

j=1 (xi − txj )
j6=i(xi − xj )

µ

h

←−| ⊗ h |T (xi)T (x1) . . . bT (xi) . . . T (xk).

· · · X16in6kn

in6=i1,...,in−1

(¯xi1 · · · ¯xin )×

(27)

¯xkj × F λ

nYj=1
Qk1−1
Qk1

j1

j16=i1

µν(x; t) = X16i16k1
· · ·Qkn−1
Qkn

(xi1 − txj1 )
(xi1 − xj1 )

jn6=i1,...,in−1

(xin − txjn )

jn6=i1,...,in

(xin − xjn )

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )T (xˆı1 ) . . . T (xˆı|ν|)| λ←−i ⊗ | 0←−i
h

where the summation is over distinct integers {i1, . . . , in} such that ij 6 kj for all 1 6 j 6 n, and where
{ˆı1, . . . , ˆı|ν|} denotes the complement of {i1, . . . , in} in {1, . . . , n + |ν|}.

3.4.3. Trivial action. Here we present a lemma which enables us to proceed further in the calculation of
F λ
µν (x; t). It is a simple result but an important one, since it allows us to eliminate the T (x) operators from
(27), eﬀectively converting it to an expectation value in the rank-one model (8).

Lemma 5. Let | λ←−i be an arbitrary length-ℓ partition state in B, and | 0←−i the length-N zero partition
(0, . . . , 0) in B (N repetitions of 0). Then

(28)

T (y1) . . . T (yN )| λ←−i ⊗ | 0←−i = tℓN | λ←−i ⊗ | i.

Proof. Consider the action of a single operator T (y) on | λ←−i ⊗ | 0←−i, for example when | λ←−i = |(2, 1, 0, 0)i
and | 0←−i = |(0, 0, 0, 0)i, for which ℓ = N = 4. Writing T (y)| λ←−i ⊗ | 0←−i in graphical form, it is clear that the
black particle exiting on the left edge of the lattice must have come from the reservoir of particles at the top
edge:

T (y)| λ←−i ⊗ | 0←−i =

λ

1

1

1

1

2

2

4

3

Hence all internal vertical edges in this row are occupied by black particles, meaning that the green particles
are forced to propagate in straight lines. The Boltzmann weight of the resulting conﬁguration is t4 = tℓ.
Since this action reduces the number of black particles by one, by iterating it N times all black particles are
eliminated from the lattice, and we recover precisely (28).
(cid:3)

3.4.4. Multiple integral expression for F λ
giving

µν(x; t). Returning to (27), we immediately apply the relation (28),

13

(29)

nYj=1

¯xkj × F λ

µν(x; t) = tm|ν| X16i16k1

(¯xi1 · · · ¯xin )×

in6=i1,...,in−1

· · · X16in 6kn
· · ·Qkn−1
Qkn

j1

Qk1−1
Qk1

(xi1 − txj1 )

jn6=i1,...,in−1

(xin − txjn )

(xi1 − xj1 )

j16=i1

jn6=i1,...,in

(xin − xjn )

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )| λ←−i ⊗ | i,
h

since ℓ = m. It is clear that the ﬁnal expectation value has no dependence on the black bosons (all operators
contained within act only in B). Hence we can calculate it using the results of Section 2.4. Recalling that
the spectral parameter in the model (17) is the reciprocal of that used in (8), we ﬁnd that

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )| λ←−i ⊗ | i =
h

xM+1
ij

Qµ/λ(¯xi1 , . . . , ¯xin ; t) =

nYj=1

B¯µ(t)
B¯λ(t)

nYj=1

xM+1
ij

Q¯λ/¯µ(¯xi1 , . . . , ¯xin ; t).

We can then convert the sum (29) into a multiple integral whose integrand contains a skew Hall–Littlewood
polynomial:

(30)

nYj=1

¯xkj × F λ

µν(x; t) = tm|ν| ×

B¯µ(t)
B¯λ(t)

×

Iw1

· · ·Iwn Y16i<j6n

(wj − wi)
(wj − twi)

j=1 (wi − txj)
j=1(wi − xj )

nYi=1Qki−1
Qki

wM

i Q¯λ/¯µ( ¯w1, . . . , ¯wn; t).

nYi=1

where each contour of integration is identical, and can be taken to be a circle centred on the origin and
surrounding the points (x1, . . . , xn+|ν|), which are the only poles of the integrand.

At this stage, it would be ideal to take some limit of the parameters x1, . . . , xn+|ν|, with the aim of recov-
ering the constant term expression (20) for the Hall polynomial. We were unable to ﬁnd any specialization
of x1, . . . , xn+|ν| that achieves this. The most obvious try, x1, . . . , xn+|ν| → 0, fails trivially (since the right
hand side of (30) is necessarily still a homogeneous polynomial of degree |ν| in these variables). This suggests
that the correct approach is to lower the degree of (30) by acting with appropriate degree-lowering operators.

3.4.5. Acting with divided-diﬀerence operators. Consider the following simple relation involving the divided-
diﬀerence operator ∆k−1 ≡ ∆k−1,k, where g(x) is any symmetric function in (x1, . . . , xk):

(31)

∆k−1(cid:18) w − tx1

w − x1

· · ·

w − txk−1
w − xk−1

g(x)

w − xk(cid:19) =

1

xk−1 − xk

(σk−1,k − 1)(cid:18) w − tx1

w − x1

· · ·

w − txk−1
w − xk−1

g(x)

g(x)

w − xk(cid:19)

w − tx1
w − x1

· · ·

w − txk−2
w − xk−2

(w − xk−1)(w − xk)

.

Using this equation repeatedly, we easily ﬁnd that

= t ×

 Yj6∈k(ν)

∆j Yi∈k(ν)

¯xi F λ
Iw1

µν(x; t) = t(m+1)|ν| ×

B¯µ(t)
B¯λ(t)

×

· · ·Iwn Y16i<j6n

(wj − wi)
(wj − twi)

nYi=1Q16j6ki−1
Q16j6ki

(wi − txj)
(wi − xj )

wM

i Q¯λ/¯µ( ¯w1, . . . , ¯wn; t).

nYi=1

where we have deﬁned k0 = 0. Since we have acted |ν| times with divided-diﬀerence operators on a polynomial
of total degree |ν|, it follows that the above expression is in fact constant with respect to x1, . . . , xn+|ν| (which
is by no means apparent from the integral, taken at face value). We are therefore at liberty to take any limit
of the variables that we choose, since our expression is independent of them.

14

M. WHEELER AND P. ZINN-JUSTIN

3.4.6. Homogeneous limit. Taking the limit xi → 0 for all 1 6 i 6 n + |ν|, we obtain

t−(m+1)|ν| ×

B¯λ(t)
B¯µ(t)

× lim

µν(x; t)

¯xi F λ
nYi=1

(wj − wi)
(wj − twi)

∆j Yi∈k(ν)
x→0 Yj6∈k(ν)
· · ·Iwn Y16i<j6n
=Iw1
= Coeﬀ Y16i<j6n
= Coeﬀ Y16i<j6n

(zi − zj)
(zi − tzj)

(wj − wi)
(wj − twi)

wM+ki−1−ki

i

Q¯λ/¯µ( ¯w1, . . . , ¯wn; t)

Q¯λ/¯µ( ¯w1, . . . , ¯wn; t),

wki−ki−1−M−1

i

Q¯λ/¯µ(z1, . . . , zn; t),

zM+1+ki−1−ki
i

nYi=1
nYi=1



 .

It remains only to observe that M + 1 + ki−1 − ki = M − νn−i+1 ≡ ¯νi for all 1 6 i 6 n, which recovers the
constant term expression (20) for b¯ν(t)f ¯λ

¯µ¯ν(t). This completes the proof of equation (22), and Theorem 1.

3.5. Combinatorial interpretation of equation (22). Equation (22) is an explicit formula for the Hall
polynomials, although it is complicated by the presence of divided-diﬀerence operators. Our aim in this
section is to ﬁnd a true combinatorial formula, that does not depend on auxiliary variables and operators
which act on them. We begin by remarking that the partition function F λ
µν (x; t) is easily decomposed into
i ] for any set of exponents {p1, . . . , pn+|ν|},
its monomials.
one sums over all conﬁgurations in F λ
µν (x; t) which have exactly pi vacant left edges in the i-th row for
all 1 6 i 6 n + |ν|. Hence the combinatorial implication of (22) will become apparent by studying which
monomials in (x1, . . . , xn+|ν|) survive under the action of the divided-diﬀerence operators.

µν(x; t),Qn+|ν|

Indeed, to calculate Coeﬀ[F λ

i=1 xpi

Before giving our combinatorial expression for the Hall polynomials, we require a number of simple

deﬁnitions.

. A dipole tiling of G is
Deﬁnition 2. Consider a rectangular grid G of light and dark squares,
a placement of horizontal dipoles + − and + − of any length on G, such that green (black) dipoles
begin and end on light (dark) squares, and dipoles cannot overlap.

and

Deﬁnition 3. Fix a non-negative integer N > 0. An N –puzzle is a dipole tiling of the grid

N(

+

+

+

in which the left column is frozen as indicated: its top square must be unoccupied,
, and the remaining
N squares are required to be of the form + . Numbering the rows from top to bottom by {0, 1, . . . , N }, let
or + in the i-th row. Then we require that (r1, . . . , rN )
ri denote the total number of tiles of the form
i=0 ri = N + 1. The length of the N –puzzle is the total number of rows i for which

is a partition and PN

ri > 0.

Deﬁnition 4. Let λ, µ, ν be three partitions. A ν–puzzle with frame (µ, λ) is a dipole tiling of the form

mM (λ)

· · ·

m1(λ)

m0(λ)

15

ν1 (

+

+

+

+

νn ( +

...

...

mM (µ)

· · ·

m1(µ)

m0(µ)

obtained by vertically concatenating νi–puzzles for 1 6 i 6 n, such that the total charge of the j-th light
column from the right is mj(µ) − mj(λ), and all internal dark columns have total charge 0. Necessarily, the
left and rightmost dark columns will have total charge |ν| and −|ν|, respectively. The length of the ν–puzzle
is the sum of the lengths of its constituent νi–puzzles.

An example of a (2,1,1)–puzzle with frame ((3, 3, 1, 1), (2, 1, 0, 0)) is given below:

0

1

1

+

− +

− +

−

+

2

−

0

+

+

+

+

+

+

2

2

−

−

0

−

−

−

−

We let Pν(µ, λ) denote the set of all ν–puzzles with frame (µ, λ).

Deﬁnition 5. The cumulative charge of a tile is the sum (reading from top downward) of all charges in
its column, up to and including the tile itself, plus the occupation number at the top of the column. For
example, in the previous puzzle, the tile bordered in red has cumulative charge 1 + 1 − 1 + 1 = 2.

Deﬁnition 6. The Boltzmann weight of a puzzle P , denoted W (P ), is the product of local weights assigned
to each tile in the lattice, excluding those in the trivial left column (which receive no weight). We indicate
the weight of each tile below:

+

1

1−tc

1

−

1

+

1

tc

1−tc

1

−

1

1

where c denotes the cumulative charge of the tile. An immediate consequence of these weights is that if the
cumulative charge of any tile is negative, the Boltzmann weight of the whole puzzle is necessarily zero. We
can therefore assume that the cumulative charge of any tile is non-negative.
Theorem 2. Let λ, µ, ν be three partitions with the same deﬁnitions as in Theorem 1, and ¯λ, ¯µ, ¯ν their
complements. Then the Hall polynomial f ¯λ
¯µ¯ν (t) is obtained by summing over all ν–puzzles with frame (µ, λ):

(32)

¯λ
¯µ¯ν(t) = t−(m+1)|ν| ×

f

where L(P ) denotes the length of P .

B¯λ(t)

B¯µ(t)b¯ν(t)

× XP ∈Pν (µ,λ)

(−1)L(P )W (P ),

16

M. WHEELER AND P. ZINN-JUSTIN

Proof. The proof is not diﬃcult, so we only sketch its key points. We start from equation (22), and analyse
the action of the divided-diﬀerence operators on F λ
µν(t). For any four partitions α, β, γ, δ and integer N > 0,
deﬁne

(33)

ρ(N )
α/γ,β/δ(t) = lim

x→0(cid:16)∆1 . . . ∆N ¯xN +1h α←−| ⊗ h

β
←−|T (x1) . . . T (xN )T (xN +1)|

γ

←−i ⊗ | δ←−i(cid:17) ,

|

|ν|

{z

}

where all x variables are sent to zero, after having acted with the divided-diﬀerence operators ∆1 . . . ∆N . It
follows that

(34)

¯λ
¯µ¯ν (t) = t−(m+1)|ν| ×

f

B¯λ(t)

B¯µ(t)b¯ν (t)

×Xαλ,µXβν

nYi=1

ρ(νi)
αi/αi−1,βi/βi−1

(t),

where the sum is taken over all possible sequences of partitions

αλ,µ := {λ ≡ α0 ⊆ α1 ⊆ · · · ⊆ αn ≡ µ},

βν := {(0, . . . , 0)

≡ β0, β1, . . . , βn ≡ ∅}

such that ℓ (αi−1) = ℓ (αi) and ℓ (βi−1) = ℓ (βi) + νi for all 1 6 i 6 n.

Equation (34) is, in some sense, a “double-tableau” formula for the Hall polynomials, just as (14) expresses
skew Hall–Littlewood polynomials as a sum over semi-standard Young tableaux. To translate it into the
formula (32), we only need to ﬁnd the combinatorial interpretation of (33), which are the building blocks.
Recalling the lattice representation of F λ
+ − between lattice paths and dipoles. One readily ﬁnds that

µν (t), we make the trivial bijection

↔ + − and

↔

(35)

ρ(N )

α/γ,β/δ(t) =XP

(−1)L(P )W (P ),

P =

N(

+

+

+

· · ·

m1(δ)

m0(δ)

· · ·

m1(γ)

m0(γ)

· · ·

m1(α) m0(α)

· · ·

m1(β)

m0(β)

where the sum is over all N –puzzles as shown on the right, with bottom and top boundaries corresponding
γ
to the partition states h α←−| ⊗ h
←−i ⊗ | δ←−i, and where the Boltzmann weights are given by Deﬁnition
6. The main subtlety in going from (33) to (35) is to calculate the action of the divided-diﬀerence operators
γ
←−i ⊗ | δ←−i. It is not hard to show that it gives rise
∆1 . . . ∆N on ¯xN +1h α←−| ⊗ h
to the partition constraint described in Deﬁnition 3, while any minus signs acquired from the action are
maintained through the factor (−1)L(P ).

β
←−|T (x1) . . . T (xN )T (xN +1)|

β
←−| and |

Finally, (34) calls for the concatenation of νi–puzzles for all 1 6 i 6 n, and (32) follows immediately.

(cid:3)

Remark 1. In the case where ν consists of just one part, N > 0, the sum (32) factorizes5. This is necessarily
the case, because of the Pieri rule

(1 − t)PµPN = Xλ:λ/µ∈hN

ϕλ/µ(t)Pλ,

ϕλ/µ(t) =

bλ(t)
bµ(t)

ψλ/µ(t),

from which we conclude that f λ
µN (t) = 0 otherwise. However as one
progresses to examples where ν consists of two parts, and beyond, such factorization does not occur in any
systematic way.

µN (t) = ϕλ/µ(t)/(1 − t) if λ/µ ∈ hN , f λ

In Appendix A, we give two explicit examples of the combinatorial rule (32). The ﬁrst is an example
where ν consists of one part, and gives rise to a factorized answer; the second is a more complicated example
in which ν has two parts.

5In saying that a polynomial “factorizes” we mean that all its non-zero roots are roots of unity.

4. t-Schur polynomials from a rank-one model of fermions

4.1. Fermionic Fock space F . Consider a semi-inﬁnite one-dimensional lattice, with sites labelled by
non-negative integers. In a ﬁnite conﬁguration of this lattice, each site i > 0 is either occupied by a particle
(occupation number ai = 1) or unoccupied (ai = 0), and there exists M ∈ N such that ak = 0 for all k > M .
Such conﬁgurations are equivalent to Maya diagrams6. The Fermionic Fock space F is obtained by taking
linear combinations of all possible Maya diagrams:

17

F = Span {|a0i0 ⊗ |a1i1 ⊗ · · · } ,

0 6 ai 6 1, ∀ i > 0.

The dual vector space is deﬁned as

F ∗ = Span {ha0|0 ⊗ ha1|1 ⊗ · · · } ,

0 6 ai 6 1, ∀ i > 0,

with its action on F given by

ha|bi =

∞Yi=0

δai,bi,

∀ ha| =

hak|k,

∞Ok=0

|bi =

|bkik.

∞Ok=0

4.2. Mapping partitions to states in F . Now we consider the well-known mapping between partitions
and Maya diagrams. Given a partition λ = (λ1, . . . , λℓ), we deﬁne the shifted (strict) partition ˜λ with parts
˜λi = λi + ℓ − i. We associate a corresponding state | λ−→i in F :

(36)

| λ−→i =

∞Ok=0

|ak(λ)ik,

ak(λ) =

1, k ∈ ˜λ,

0, otherwise.

Example 5. Let λ = (5, 3, 3, 1, 0). Then ˜λ = (9, 6, 5, 2, 0), and we ﬁnd that

| λ−→i = |1i0 ⊗ |0i1 ⊗ |1i2 ⊗ |0i3 ⊗ |0i4 ⊗ |1i5 ⊗ |1i6 ⊗ |0i7 ⊗ |0i8 ⊗ |1i9 ⊗ |0i10 ⊗ · · · .

This mapping has a simple pictorial explanation. Starting from the Young diagram of λ rotated clockwise
by 45◦, we assign particles to every edge with positive slope, and holes to every edge with negative slope.
The resulting array of particles/holes can then be projected onto the the integer lattice:

0

1

2

3

4

5

6

7

8

9

10

From here the Maya diagram | λ−→i is obtained by reading oﬀ the resulting binary string, where we make the
identiﬁcations ≡ 1 and ≡ 0.

4.3. Reverse Maya diagrams. Let | λ−→i be the Maya diagram as deﬁned by (36), corresponding with the
length-ℓ partition λ, whose largest part is L. The reverse Maya diagram | λ←−i ∈ F is deﬁned as

| λ←−i =

∞Ok=0

|¯ak(λ)ik,

¯ak(λ) = aℓ+L−1−k(λ), ∀ 0 6 k 6 ℓ + L − 1,

¯ak(λ) = 0, otherwise.

The pictorial interpretation of a reverse Maya diagram is shown below. In analogy with Section 2.3, one
ﬁrst rotates the Young diagram anti-clockwise by 135◦, before projecting onto the integer lattice:

6Conventionally, Maya diagrams are inﬁnite in both directions, with a particle or hole at every site of the integer lattice.
They satisfy the ﬁniteness condition that suﬃciently far to the left/right only particles/holes occur. In this work we label our
integer lattice in such a way that all negative sites are occupied by a particle, so we shall suppress the negative half of our Maya
diagrams, since it contains no information.

18

M. WHEELER AND P. ZINN-JUSTIN

It is also clear from this picture that in general | λ←−i = |

¯λ−→i, precisely as we saw in Proposition 1.

0

1

2

3

4

5

6

7

8

9

10

4.4. A rank-one model of fermions. Introduce fermionic creation and annihilation operators ψ† and ψ,
and the particle-number operator N , which are given explicitly by 2 × 2 matrices:

0(cid:19) , N =(cid:18)0 0
0 1(cid:19) ,
single site of a Maya diagram, obtained by making the identiﬁcations |0i =(cid:18)1

0(cid:19) , ψ =(cid:18)0

ψ† =(cid:18) 0

1 − t

0

1

0

we have

and let f denote the algebra generated by these and the identity matrix. They have a natural action on a

0(cid:19) and |1i =(cid:18)0

1(cid:19). Namely,

ψ†|0i = (1 − t)|1i, ψ†|1i = 0, ψ|0i = 0, ψ|1i = |0i, N |0i = 0, N |1i = |1i.

The L-matrix

(37)

L∗

a(x|f) =(cid:18)1

ψ x(−t)N(cid:19)a

xψ†

satisﬁes the intertwining relation

=

a

Rab(y/x)L∗

a(x|f)L∗

b (y|f) = L∗

b (y|f)L∗

a(x|f)Rab(y/x),

with R-matrix given by

(38)

Rab(z) =

1 − tz

0

0
0
0

t(1 − z)
(1 − t)z

0

.

0

0

0
0
0

1 − t
1 − z

ab
a(x|fi) :=(cid:18)A(x) B(x)
C(x) D(x)(cid:19)a

z − t

.

∞Yi=0

T ∗
a (x) = L∗

a(x|f0)L∗

a(x|f1) · · · =

L∗

We construct a monodromy matrix by taking a product of L-matrices over all sites i > 0 of the lattice:

Once again, we will be subsequently interested in the operator A(x) ∈ End(F ), which can be interpreted as
the sum of all possible (semi-inﬁnite) rows of the tiles (37), whose left-most tile is
and such that

or

suﬃciently far to the right only

occurs. These operators commute: [A(x), A(y)] = 0 for all x, y.

We point out that the R-matrix (38) can be obtained from the Felderhof model (introduced in [11], but
see also equation (3.1) of [9]) by a particular choice of the external ﬁelds. The model deﬁned by the L-matrix
(37) is therefore inherently free-fermionic. Indeed, by writing the entries of (37) explicitly, the L-matrix is
manifestly a free-fermionic six-vertex model:

L∗

a(x|fi) =

1
0
0
0

0

0
1 (1 − t)x
1
0

x
0

0
0
0

−tx

ai

.

4.5. t-Schur polynomials Sλ(x; t). Macdonald deﬁned a t-generalization of Schur polynomials, which we
call t-Schur polynomials, denoted Sλ(x; t) [27]. They can be expressed in Jacobi–Trudi form:

19

where the matrix entries are polynomials given by the generating series

Sλ(x; t) = det

16i,j6ℓ(cid:16)qλi−i+j (x; t)(cid:17),
1 − xiy(cid:19) .
qk(x; t)yk =Yi (cid:18) 1 − txiy

Xk

(39)

(41)

The t-Schur polynomials Sλ(x; t) degenerate to Schur polynomials sλ(x) at t = 0, which is easily from the
Jacobi–Trudi formula for the latter and the fact that qk(x; 0) = hk(x), the k-th complete symmetric function.
Furthermore they satisfy the Cauchy identity

(40)

Xλ

Sλ(x; t)sλ(y) =Yi,j (cid:18) 1 − txiyj
1 − xiyj (cid:19)

which in turn leads to the duality relation hSλ, sµi = δλ,µ with respect to the Hall inner product [27]. Since
we wish to construct them via a transfer matrix approach, it is convenient to derive a branching rule for the
t-Schur polynomials.

Lemma 6. Let x denote a set of variables (x1, . . . , xn), and z a single variable. The t-Schur polynomials
satisfy the relation

Sλ(x, z; t) = Xµ:λ/µ∈v Xν:µ/ν∈h

(−t)|λ−µ|z|λ−ν|Sν(x; t).

In terms of Young diagrams, we note that the conditions µ/ν ∈ h and λ/µ ∈ v imply that the skew diagram
λ/ν forms a border strip.

Proof. Using the Cauchy identity (40), and the generating series expressions of the complete symmetric and
elementary symmetric polynomials, we can write

Yi

1 − tyiz

1 − yiz Yi,j

1 − txiyj
1 − xiyj

=Xk,l

(−t)lzk+lhk(y)el(y)Xν

Sν(x; t)sν (y).

Thanks to the horizontal and vertical strip Pieri identities for the Schur polynomials, the previous equation
becomes

Yi

1 − tyiz

1 − yiz Yi,j

1 − txiyj
1 − xiyj

=Xk,l
=Xλ

(−t)lzk+l Xµ:µ/ν∈hk Xλ:λ/µ∈vl
sλ(y) Xµ:λ/µ∈v Xν:µ/ν∈h

Sν(x; t)sλ(y)

z|λ−ν|(−t)|λ−µ|Sν(x; t).

Finally, we note that the starting product itself is equal toPλ Sλ(x, z; t)sλ(y), again by the Cauchy identity

(40). Comparing coeﬃcients sλ(y) on both sides of the resulting equation, we obtain (41).

(cid:3)

4.6. Skew t-Schur polynomials Sλ/µ(x; t). Next, we deﬁne a skew version of the t-Schur polynomial. One
natural way to do this7 is via the expansion of Sλ(x, y; t) over the basis Sµ(y; t):

(42)

Sλ/µ(x1, . . . , xn; t)Sµ(y1, . . . , ym; t)

Sλ(x1, . . . , xn, y1, . . . , ym; t) :=Xµ

for any partition λ and any two sets of variables (x1, . . . , xn), (y1, . . . , ym), and where the sum on the right
hand side is taken over all partitions µ. This allows Sλ/µ(x1, . . . , xn; t) to be built up recursively, once given
Sλ/µ(z; t) in a single variable z. Comparing with (41), we see that

(43)

Sλ/ν(z; t) = z|λ−ν| Xµ:µ/ν∈h,λ/µ∈v

(−t)|λ−µ|.

7Generally speaking, a skew polynomial is normally deﬁned via an orthogonality relation of the form (10). Later on, we will

see that the deﬁnition (42) is equivalent to the orthogonality relation hSλ, sµPν i = hSλ/µ, Pν i.

20

M. WHEELER AND P. ZINN-JUSTIN

4.7. Lattice expression for Sλ/µ(x; t).

Lemma 7. The skew t-Schur polynomial Sλ/µ is given by the following expectation value:

(44)

Sλ/µ(x1, . . . , xn; t) = h

µ

−→|A(x1) . . . A(xn)| λ−→i.

Proof. Inserting a complete set of states in the right hand side of (44), we have

h

µ

−→|A(x1) . . . A(xn)| λ−→i =Xν

To complete the proof, it is suﬃcient to show that

µ

−→|A(x1) . . . A(xn−1)| ν−→ih ν−→|A(xn)| λ−→i.
h

(45)

h ν−→|A(z)| λ−→i = Sλ/ν(z; t).

We will illustrate this on the example λ = (4, 2, 2, 0), ν = (3, 1, 0, 0), for which we have

a0(λ) a1(λ) a2(λ) a3(λ) a4(λ) a5(λ) a6(λ) a7(λ)

· · ·

h(0, 0, 1, 3)|A(z)|(0, 2, 2, 4)i =

= −z4t(1 − t)2.

We ﬁnd that we can replace the unique conﬁguration of our single row with multiple conﬁgurations of a
double row lattice, as shown below:

a0(ν) a1(ν) a2(ν) a3(ν) a4(ν) a5(ν) a6(ν) a7(ν)

· · ·

h(0, 0, 1, 3)|A(z)|(0, 2, 2, 4)i =

+

−z4t

z4t2

+

+

z4t2

−z4t3

The rules of this transformation are as follows: 1. The lattice paths in the bottom row must form horizontal
strips, while those in the top row form vertical strips; 2. Each right step in the bottom row comes with a
weight of z, those in the top row come with a weight of −tz. The sum (43) is recovered immediately. It is
straightforward to extend this argument and show that (45) holds for arbitrary partitions.

(cid:3)

Example 6. We give an independent proof of (45) when ν = 0. A quick manual calculation shows that

h 0−→|A(z)| λ−→i = z|λ| ×

1,

λ = 0,

(1 − t)(−t)m,

0,

λ = (p, 1, . . . , 1

), p > 1,

otherwise.

| {z }m

This can be compared directly with the determinant formula (39). The case λ = 0 is obvious, and when
λ = (p, 1, . . . , 1

) with p > 1 we obtain the determinant



=

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

| {z }m

Sλ(z; t) =

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

qp
q0
0
...
0

qp+1
q1
q0
. . .
· · ·

· · ·
· · ·
q1
. . .
0

· · ·
· · ·
· · ·
. . .
q0

qp+m
qm
qm−1

...
q1

(1 − t)zp
1
0
...
0

(1 − t)zp+1
(1 − t)z
1
. . .
· · ·

· · ·
· · ·
(1 − t)z
. . .
0

· · ·
· · ·
· · ·
. . .
1

(1 − t)zp+m
(1 − t)zm
(1 − t)zm−1
...
(1 − t)z

which factorizes as zp+m(1 − t)(−t)m, after basic row operations which put it in upper-triangular form.
Finally, in the case where λ does not form a border strip, the ﬁrst two parts of λ will be greater than 1. This
leads to the ﬁrst two rows of the determinant (39) being proportional, and it vanishes.

,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Example 7. Consider λ = (2, 1), and compute Sλ(x1, x2; t) using equation (44). We ﬁnd that

Sλ(x1, x2; t) =

+

+

+

+

21

x2

x1

where we have truncated the inﬁnite lattice to show just the non-trivial part of the partition function. The
ﬁve terms sum to give

Sλ(x1, x2; t) = −t(1 − t)x3

1 + (1 − t)2x2

1x2 − t(1 − t)2x2

1x2 + (1 − t)3x1x2

2 − t(1 − t)x3
2

This agrees with the determinant calculation

= (1 − t)(cid:16) − tx3
Sλ(x1, x2; t) =(cid:12)(cid:12)(cid:12)(cid:12)

q2
q0

1 + (1 − t)2x2

1x2 + (1 − t)2x1x2

2 − tx3

2(cid:17).

q3

q1 (cid:12)(cid:12)(cid:12)(cid:12) = q2(x1, x2; t)q1(x1, x2; t) − q3(x1, x2; t).

5. Inverse Kostka polynomials from a rank-two fermion-boson model

5.1. Model with one fermion and one boson. We now consider a model consisting of one fermion and
one boson. The entries of the L-matrix act in F ⊗ B, the tensor product of a fermionic and bosonic space,
and are given by

x[1 ⊗ 1]

1 ⊗ φ†

ψ† ⊗ 1

x[tN ⊗ φ]

tN ⊗ 1

0

x[ψ ⊗ 1] ψ ⊗ φ†

(−t)N ⊗ 1

a

=



0

The L-matrix satisﬁes the intertwining equation

(47)

Rab(x/y)La(x|f ⊗ b)Lb(y|f ⊗ b) = Lb(y|f ⊗ b)La(x|f ⊗ b)Rab(x/y)

with respect to the R-matrix

a
ab

.

(46)

La(x|f ⊗ b) =


0
0
0
0
0
0
0
0

1 − tz

Rab(z) =

0

t(1 − z)

0
0

0

1 − t

0

t(1 − z)

0

(1 − t)z

0
0
0
0
0

0
0
0

(1 − t)z

0
0

1 − z

0
0
0
0
0

0
0
0
0

1 − tz

0
0
0
0
0

0
0
0
0

t(1 − z)

0

1 − t

0

0
0

1 − t

0
0
0

1 − z

0
0

0
0
0
0
0

(1 − t)z

0

1 − z

0

0
0
0
0
0
0
0
0

z − t

By considering only the entries (1,1), (1,3), (3,1) and (3,3) of the L-matrix (46), it reduces to the model
(37). We construct a monodromy matrix in the same way as in Section 4.4, namely

(48)

Ta(x) = La(x|f0 ⊗ b0)La(x|f1 ⊗ b1) · · · =

∞Yi=0

La(x|fi ⊗ bi) :=

T (x)
T (x)
T (x)

⋆ ⋆
⋆ ⋆

⋆ ⋆a

,

where we only indicate the operators in the ﬁrst column of the monodromy matrix, since these are the only
one we need subsequently. From (47), we see that they generate a sub-algebra of the Yang–Baxter algebra,
whose relations include

(49)

(50)

(51)

(y − x)T (x)T (y) + (1 − t)xT (x)T (y) = (y − tx)T (y)T (x),

(y − x)T (x)T (y) + (1 − t)xT (x)T (y) = (y − tx)T (y)T (x),

T (x)T (y) = T (y)T (x),

(x − ty)T (x)T (y) = (y − tx)T (y)T (x).

22

M. WHEELER AND P. ZINN-JUSTIN

5.2. Deﬁnition of Kostka polynomials and their inverses. The Kostka polynomials express Schur
polynomials in the Hall–Littlewood basis of the ring of symmetric functions:

sλ(x) =Xν

K λ

ν (t)Pν (x; t).

While it is not obvious from their deﬁnition, K λ
ν (t) ∈ N[t] for all λ, ν. Exploiting this positivity, there are
many combinatorial formulae for K λ
ν (t), of which the most well-known are due to Lascoux and Sch¨utzenberger
[24] and Kirillov and Reshetikhin [16]. In the present work we will not have more to say about the Kostka
polynomials, but will consider rather their inverses:

(52)

Pν (x; t) =Xλ

¯K λ

ν (t)sλ(x).

Here it is clear that ¯K λ
ν (t) ∈ Z[t], since Pν (x; t) ∈ Z[x, t] and the Schur polynomials form a Z-basis for the
ring of symmetric functions, but the coeﬃcients of ¯K λ
ν (t) are no longer positive. Nevertheless, the second
main goal of this paper is to derive a combinatorial expression for these polynomials. Before proceeding to
this result, we ﬁrst generalize them.

5.3. Generalized inverse Kostka polynomials. We start from the branching formula (42) for the t-Schur
polynomials:

Sλ(x, y; t) =Xµ

Sλ/µ(x; t)Sµ(y; t).

Multiplying both sides by sλ(z) and summing over λ, from (40) we ﬁnd that

or alternatively, re-expanding the left hand side in a diﬀerent way,

1 − txizj

1 − tyizj
1 − yizj

1 − xizj Yi,j
=Xλ,µ
Yi,j
Xµ,ν
Qν(x; t)Pν (z; t)Sµ(y; t)sµ(z) =Xλ,µ

Sλ/µ(x; t)Sµ(y; t)sλ(z),

Sλ/µ(x; t)Sµ(y; t)sλ(z).

Since the t-Schur polynomials are a Z-basis for the ring of symmetric functions [27], we can extract coeﬃcients
of Sµ(y; t) from both sides, giving

(53)

Xν

Qν(x; t)Pν (z; t)sµ(z) =Xλ

Sλ/µ(x; t)sλ(z).

Now deﬁne ¯K λ
over the Schur basis:

µν(t) as the expansion coeﬃcients of the product of a Schur and Hall–Littlewood polynomial,

sµ(z)Pν (z; t) :=Xλ

¯K λ

µν(t)sλ(z),

which clearly generalizes (52) to include a third non-trivial partition. Substituting this into (53) and com-
paring coeﬃcients of sλ(z) on both sides, one ﬁnds that

Sλ/µ(x; t) =Xν

¯K λ

µν(t)Qν(x; t).

Hence to calculate ¯K λ
µν (t) we need to expand a skew t-Schur polynomial in the Hall–Littlewood basis.
Applying the results of Section 3.3, we can write the generalized inverse Kostka polynomials as a constant
term expression:

(54)

Coeﬀ Y16i<j6n(cid:18) 1 − zj/zi

1 − tzj/zi(cid:19) Sλ/µ(z1, . . . , zn; t), zν1

n  = ¯K λ

1 . . . zνn

µν (t)bν(t).

5.4. Inverse Kostka polynomials from action of divided-diﬀerence operators.

Theorem 3. Let λ, µ, ν be three partitions with respective lengths ℓ, m, n such that ℓ = m, and largest
parts L, M, N such that M > L and m + M > N . Let ¯λ, ¯µ denote the partitions obtained by complementing
each part of λ, µ by M , ¯ν the partition obtained by complementing each part of ν by m + M − 1, and assume
that |¯λ| = |¯µ| + |¯ν|. Then

23

(55)

Kλ

µν (x; t) = h

µ
←−| ⊗ h |

n+|ν|Yi=1 (cid:26) T (xi),

T (xi),

i ∈ k(ν)

i 6∈ k(ν) (cid:27) | λ←−i ⊗ | 0←−i

is a homogeneous polynomial in {x1, . . . , xn+|ν|} of total degree n + 2|ν|, and the generalized inverse Kostka
polynomial ¯K ¯λ
¯µ¯ν(t) is given by the repeated action of divided-diﬀerence operators on this partition function:

(56)

¯K

¯λ
¯µ¯ν(t) =

t−(m+1)|ν|

b¯ν(t)

× Yj6∈k(ν)

∆j

n+|ν|Yi=1

¯xi Kλ

µν (x; t),

where the product of divided-diﬀerence operators is ordered from left to right, starting at i = 1 and ﬁnishing
at i = n + |ν|, and omitting i ∈ k(ν).

The proof of Theorem 3 is very similar to that of Theorem 1. To limit direct repetition of ideas, we give

this proof in Appendix B.

5.5. Combinatorial interpretation of equation (56). In order to make a precise statement of Theorem
4, we begin by adapting each of the Deﬁnitions 2–6 to ﬁt the fermion-boson model that we are currently
considering. The proof of Theorem 4 is omitted, since it follows by direct analogy with the proof of Theorem
2.

Deﬁnition 2′. Consider a rectangular grid G of light and dark squares,
. A dipole tiling of G
is a placement of horizontal dipoles + − and + − of any length on G, such that red (black) dipoles
begin and end on light (dark) squares, and dipoles cannot overlap.

and

Deﬁnition 3′. Fix a non-negative integer N > 0. An N –puzzle is a dipole tiling of the grid

N(

+

+

+

in which the left column is frozen as indicated: its top square must be unoccupied,
, and the remaining
N squares are required to be of the form + . Numbering the rows from top to bottom by {0, 1, . . . , N }, let
or − in the i-th row. Then we require that (r1, . . . , rN )
ri denote the total number of tiles of the form
i=0 ri = 2N + 2. The length of the N –puzzle is the total number of rows i for which

is a partition and PN

ri > 1.

24

M. WHEELER AND P. ZINN-JUSTIN

Deﬁnition 4′. Let λ, µ, ν be three partitions. A ν–puzzle with frame (µ, λ) is a dipole tiling of the form

λ

am+M −1(λ)

· · ·

a1(λ)

a0(λ)

ν1 (

+

+

+

+

νn ( +

...

...

am+M −1(µ)

· · ·

µ

a1(µ)

a0(µ)

obtained by vertically concatenating νi–puzzles for 1 6 i 6 n, such that the total charge of the j-th light
column from the right is aj(µ) − aj(λ), and all internal dark columns have total charge 0. Necessarily, the
left and rightmost dark columns will have total charge |ν| and −|ν|, respectively. The length of the ν–puzzle
is the sum of the lengths of its constituent νi–puzzles.
Deﬁnition 5′. The cumulative charge of a tile is the sum (reading from top downward) of all charges in its
column, up to and including the tile itself, plus the occupation number at the top of the column.

Deﬁnition 6′. The Boltzmann weight of a puzzle P , denoted W (P ), is the product of local weights assigned
to each tile in the lattice (again, excluding the tiles in the trivial left column). We indicate the weight of
each tile below:

+

1

δc,1(1−t)

(−t)c

−

1

1

tc

+

1−tc

1

−

1

1

where c denotes the cumulative charge of the tile. From these weights, we see that the cumulative charge of
any light tile is forced to be either 0 or 1, while the cumulative charge of any dark tile must be non-negative.

Theorem 4. Let λ, µ, ν be three partitions with the same deﬁnitions as in Theorem 3, and ¯λ, ¯µ, ¯ν their
complements. Then the generalized inverse Kostka polynomial ¯K ¯λ
¯µ¯ν(t) is obtained by summing over all
ν–puzzles with frame (µ, λ):

(57)

K

¯λ
¯µ¯ν (t) =

t−(m+1)|ν|

b¯ν(t)

× XP ∈Pν (µ,λ)

(−1)L(P )W (P ),

where L(P ) denotes the length of P . An example of (57) is given in Appendix C.

6. Knutson–Tao puzzles from integrability

In this section we calculate a certain partition function in the model (46) at t = 0, and prove that it is
µν . We then give a simple bijection between lattice

proportional to the Littlewood–Richardson coeﬃcient cλ
conﬁgurations in the model under consideration, and Knutson–Tao puzzles [19, 20].

6.1. Fermion-boson model at t = 0. We begin by taking the limit t → 0 of the model (46). The operators
of the model acquire the simpliﬁed actions

φ†|mi = |m + 1i, φ|mi = (1 − δm,0)|m − 1i on B,
ψ†|0i = |1i, ψ†|1i = 0, ψ|0i = 0, ψ|1i = |0i, N |0i = 0, N |1i = |1i on F .

In particular, we notice that (±t)N 7→ π = |0ih0| when t = 0, the projector onto the vacuum. Finally,
inverting the spectral parameter in (46) (this is purely a convenience) we ﬁnd that

25

(58)

L∗

a(x|f ⊗ b) =



1 ⊗ 1

x[1 ⊗ φ†] x[ψ† ⊗ 1]

π ⊗ φ

x[π ⊗ 1]

0

ψ ⊗ 1 x[ψ ⊗ φ†]

x[π ⊗ 1]

a

=



0

when t = 0.

a

Because of the projectors which are now present in the L-matrix, this model is combinatorially much simpler
than those considered earlier in the paper. In particular, the following expectation value vanishes:

(59)

h1|π|1i =

=

= 0,

meaning that the two tiles shown above are forbidden in lattice conﬁgurations of the model.

We construct a monodromy matrix in the standard way:

T ∗
a (x) = L∗

a(x|f0 ⊗ b0)L∗

a(x|f1 ⊗ b1) · · · =

T ∗(x)
T ∗(x)
T ∗(x)

⋆ ⋆
⋆ ⋆

⋆ ⋆a

.

The commutation relations that we shall require are

(60)

(61)

T ∗(x)T ∗(y) =

¯y

¯y − ¯x

T ∗(y)T ∗(x) +

¯x

¯x − ¯y

T ∗(x)T ∗(y),

¯xT ∗(x)T ∗(y) = ¯yT ∗(y)T ∗(x),

which (up to inversion of the spectral parameters) are the t = 0 specialization of (50) and (51).

6.2. Littlewood–Richardson coeﬃcients from a partition function.

Theorem 5. Let λ be a partition of length ℓ with largest part L. Fix two other partitions µ, ν, also both
of length ℓ, which satisfy |λ| = |µ| + |ν|. Let ¯ν denote the complement of ν by L + 1, and deﬁne the set
κ(¯ν) = {κ1, . . . , κℓ} where κi = i + ¯νℓ−i+1 = i + L + 1 − νi. Deﬁne the partition function

(62)

Cλ
µν(x) = h | ⊗ h

µ
−→|

ℓ+L+1Yi=1 (cid:26) T ∗(xi),

T ∗(xi),

i ∈ κ(¯ν)

i 6∈ κ(¯ν) (cid:27) | i ⊗ | λ−→i,

where | λ−→i and |
in F . Then Cλ
pi = #{j > i|j 6∈ κ(¯ν)}. The Littlewood–Richardson coeﬃcient cλ
monomial:

µ
−→i are partition states in B, while | i and | i denote completely occupied and empty states
xpi
i , where
µν is the coeﬃcient (possibly, zero) of that

µν(x) is a polynomial in x1, . . . , xℓ+L+1 consisting of a single monomial, Qℓ+L+1

i=1

(63)

cλ

µν = ℓ+L+1Yi=1

i ! Cλ

¯xpi

µν(x).

The rest of this section will be devoted to the proof.

It proceeds along similar lines to the proofs of
Theorems 1 and 3, apart from some key diﬀerences which make it worthwhile to sketch this proof in its own
right.

Example 8. Let λ = (4, 4, 2, 1), µ = (3, 3, 1, 0), ν = (2, 1, 1, 0). Then ℓ = 4, L = 4, ¯ν = (5, 4, 4, 3) and

Cλ
µν (x) = h | ⊗ h

µ

−→|T ∗(x1)T ∗(x2)T ∗(x3)T ∗(x4)T ∗(x5)T ∗(x6)T ∗(x7)T ∗(x8)T ∗(x9)| i ⊗ | λ−→i,

26

M. WHEELER AND P. ZINN-JUSTIN

which is graphically represented as

λ

m0(λ)

m1(λ)

m2(λ)

m3(λ)

m4(λ)

1

1

2

x9

x8

x7

x6

x5

x4

x3

x2

x1

κ(¯ν)

1

1

m0(µ)

m1(µ)

m2(µ)
µ

2

m3(µ)

m4(µ)

6.2.1. Degree counting. Writing the L-matrix (58) in its graphical representation, we clearly obtain an x
weight for every occupied right edge (ORE). Studying the lattice representation of Cλ
µν (x), in every legal
conﬁguration the black (bosonic) lines give rise to |λ| − |µ| = |ν| OREs, while the red (fermionic) lines
produce a total of 0 + 1 + · · · + L = L(L + 1)/2 OREs. This is a total of |ν| + L(L + 1)/2 OREs, meaning
that Cλ

µν (x) is a homogeneous polynomial of degree |ν| + L(L + 1)/2.

On the other hand, it is immediate that the sum of the exponents pi givesPℓ+L+1

Hence to establish the ﬁrst claim of the theorem (that Cλ
we need to show that the limits

i=1

pi = |ν| + L(L + 1)/2.
xpi
i ),

µν(x) consists of the single monomialQℓ+L+1
i ! Cλ

µν(x)

i=1

¯xpi

xj→∞ ℓ+L+1Yi=1

lim

exist for all 1 6 j 6 ℓ + L + 1. This ensures that Cλ

µν (x) contains no other degree |ν| + L(L + 1)/2 monomials.

6.2.2. Multiple sum expression for Cλ
µν(x). By repeated use of the commutation relations (60) and (61), one
can completely order the operators appearing in (62) (so that all T ∗ operators are on the left). The result
of the computation is given below:

(64)

ℓ+L+1Yi=1

¯xpi
i × Cλ

µν(x) = X16i16κ1

×

ℓYa=1

¯xL+1
ia

×

· · · X16iℓ6κℓ
L+1Yb=1

¯xL+1−b
ˆıb

iℓ6=i1,...,iℓ−1

κ1Yj16=i1

1

(¯xi1 − ¯xj1 )

· · ·

κℓYjℓ6=i1,...,iℓ

1

(¯xiℓ − ¯xjℓ )

× h | ⊗ h

µ

−→|T ∗(xi1 ) . . . T ∗(xiℓ )T ∗(xˆı1 ) . . . T ∗(xˆıL+1)| i ⊗ | λ−→i

where the summation is over distinct integers {i1, . . . , iℓ} such that ij 6 κj for all 1 6 j 6 ℓ, and where
{ˆı1, . . . , ˆıL+1} denotes the complement of {i1, . . . , iℓ} in {1, . . . , ℓ + L + 1}.

6.2.3. Trivial action.

Lemma 8. Let | λ−→i be an arbitrary partition state in B with largest part L, and | i/| i the completely
occupied/unoccupied state in F . Then

(65)

T ∗(y1) . . . T ∗(yL+1)| i ⊗ | λ−→i =

yL+1−i
i

| i ⊗ | λ−→i.

L+1Yi=1

Proof. We study the lattice representation of the left hand side of (65), shown here for the example λ =
(4, 4, 2, 1):

27

λ

1

1

1

1

1

1

1

1

1

1

1

1

2

2

2

2

2

2

y5

y4

y3

y2

y1

Because the conﬁgurations (59) are disallowed, it immediately follows that the lattice is frozen, with black
particles propagating in straight lines. The red line in the i-th row gives rise to L + 1 − i OREs, and hence
produces the factor yL+1−i
, for all 1 6 i 6 L + 1. All red particles exit from the left edge of the lattice,
meaning that the outgoing state is constrained to be | i ⊗ | λ−→i.

i

(cid:3)

6.2.4. Multiple integral expression for Cλ
multiple sum (64) can be simpliﬁed to

µν(x). Because of the trivial action (65) of the T ∗ operators, the

ℓ+L+1Yi=1

¯xpi
i × Cλ

µν (x) = X16i16κ1

· · · X16iℓ6κℓ

iℓ6=i1,...,iℓ−1

κ1Yj16=i1

1

(¯xi1 − ¯xj1 )

· · ·

κℓYjℓ6=i1,...,iℓ

1

(¯xiℓ − ¯xjℓ )

−→|T ∗(xi1 ) . . . T ∗(xiℓ )| i ⊗ | λ−→i, has no further dependence on red
The expectation value that remains, h | ⊗ h
particles and is therefore purely bosonic. In fact, by taking the t = 0 specialization of (15), it is simply a
skew Schur polynomial:

µ

×

ℓYa=1

¯xL+1
ia

× h | ⊗ h

µ

−→|T ∗(xi1 ) . . . T ∗(xiℓ )| i ⊗ | λ−→i.

h | ⊗ h

µ

−→|T ∗(xi1 ) . . . T ∗(xiℓ )| i ⊗ | λ−→i = sλ/µ(xi1 , . . . , xiℓ ).

Substituting this result into the above sum, we then convert it into a multiple integral:

(66)

ℓ+L+1Yi=1

¯xpi
i × Cλ

µν(x) =Iw1

wL+1

i

sλ/µ( ¯w1, . . . , ¯wℓ),

ℓYi=1

· · ·Iwℓ Q16i<j6ℓ(wj − wi)

j=1(wi − ¯xj )

Qℓ
i=1Qκi

where each contour of integration is a circle centred on the origin and surrounding the points (¯x1, . . . , ¯xℓ+L+1),
which are the only poles of the integrand.

6.2.5. Homogeneous limit. Now we consider the limits xj → ∞ of (66). This causes poles to coalesce
at the origin, but since the origin is contained within the contours of integration, these limits are clearly
non-singular. Together with the arguments of Section 6.2.1, this proves that Cλ
µν(x) is proportional to the

28

M. WHEELER AND P. ZINN-JUSTIN

monomialQℓ+L+1

i=1

take all such limits xj → ∞:

xpi
i , and accordingly the right hand side of (66) is in fact a constant. To evaluate it, we

lim
x→∞

ℓ+L+1Yi=1

¯xpi
i × Cλ

· · ·Iwℓ Y16i<j6ℓ
µν(x) =Iw1
= Coeﬀ Y16i<j6ℓ
= Coeﬀ Y16i<j6ℓ
µν(x) = Coeﬀ Y16i<j6ℓ

(wj − wi)

ℓYi=1

wL+1−κi

i

sλ/µ( ¯w1, . . . , ¯wℓ)

(wj − wi)sλ/µ( ¯w1, . . . , ¯wℓ),

wκi−L−2

i

(zi − zj)sλ/µ(z1, . . . , zℓ),

zℓ+L+1−κi
i

ℓYi=1
ℓYi=1


 .
 = cλ

Finally, recalling that L + 1 − κi = νi − i for all 1 6 i 6 ℓ, we obtain

lim
x→∞

ℓ+L+1Yi=1

¯xpi
i × Cλ

(zi − zj)sλ/µ(z1, . . . , zℓ),

µν ,

zℓ+νi−i
i

ℓYi=1

with the ﬁnal equality being simply the t = 0 specialization of (20).

6.3. Right-triangle puzzles. We now analyse the combinatorial implication of Theorem 5. This is a much
simpler task than in previous sections, since (63) contains no divided-diﬀerence operators and is manifestly
positive. The partition function (62) consists of exactly cλ
µν conﬁgurations. For instance, returning to
Example 8, one ﬁnds that only two lattice conﬁgurations are possible:

(67)

1

1

2

1

1

2

1

1

2

1

1

2

µν = 2 in this case. The fact that the lattice conﬁgurations of Cλ

and accordingly cλ
µν (x) enumerate Littlewood–
Richardson coeﬃcients suggests that the former can be put in one-to-one correspondence with Knutson–Tao
puzzles. To demonstrate that this is indeed the case, we ﬁrst deﬁne an intermediate class of combinatorial
objects, which we call right-triangle puzzles.

Deﬁnition 7. Consider tilings of the square lattice by the following set of tiles:

(68)

Let λ, µ, ν be three partitions as deﬁned in Theorem 5. A right-triangle puzzle with frame (λ, µ, ν) is a tiling
of an (ℓ + L + 1) × (ℓ + L + 1) lattice by the tiles (68), where the boundary conditions are ﬁxed as follows:

29

ν( , )

λ( , )

µ( , )

In other words, the top, bottom and left boundaries are truncated Maya diagrams formed by the two types
of particles in parentheses, representing the partition indicated. These puzzles take their name from the
fact that, when studying conﬁgurations of the lattice above, only the region below the NW–SE diagonal is
non-trivial (the region above this diagonal is necessarily frozen).

Proposition 2. The Littlewood–Richardson coeﬃcient cλ
with frame (λ, µ, ν).

µν is equal to the number of right-triangle puzzles

Proof. There is a simple bijection between the lattice conﬁgurations encoded by (62) and right-triangle
puzzles. We will sketch the general idea here, but avoid a rigorous proof, since this would require a long
detour.

We begin by noting that, for the two classes of objects, the underlying lattice has a diﬀerent size. The
lattice conﬁgurations of Cλ
µν (x) are (ℓ+L+1)×(2L+2), while right-triangle puzzles are (ℓ+L+1)×(ℓ+L+1).
Both objects have the same number of rows, but conﬁgurations of Cλ
µν (x) may contain more or less columns
than their counterpart right-triangle puzzle. The bijection that we seek should therefore be viewed as
contraction or expansion in the horizontal dimension, while no transformation takes place in the vertical
dimension.

To go from lattice conﬁgurations in Cλ

µν(x), for example those of (67), to right-triangle puzzles, we allow
all vertical line segments the freedom to be translated left or right by moves. The horizontal line segments
are free to contract or expand during this process, such that the connectivity between vertical line segments
is preserved. A move of a vertical line segment is permitted only if it does not introduce new crossings
between lattice lines, or undo a crossing already present. Using these moves, given a conﬁguration in Cλ
µν(x)
there is a unique way to reposition vertical line segments within an (ℓ + L + 1) × (ℓ + L + 1) grid, such that
only the tiles (68) are used. When this procedure is applied to the conﬁgurations in (67), the result is

which are the corresponding right-triangle puzzles. The non-trivial region of each puzzle is indicated by the
blue triangle; outside of this triangle, the lattice paths are frozen.

It is straightforward to proceed in the opposite sense, from right-triangle puzzles to conﬁgurations of
Cλ
µν (x), subject to the same rules of movement. Given any right-triangle puzzle, there is again a unique way
to perform these moves, such that a conﬁguration of Cλ
µν (x) on a (ℓ + L + 1) × (2L + 2) grid is obtained. (cid:3)

30

M. WHEELER AND P. ZINN-JUSTIN

6.4. Knutson–Tao puzzles. Finally, we give the trivial correspondence between right-triangle puzzles and
the ones introduced in [19, 20]. One extracts the non-trivial region of a right-triangle puzzle and shears it so
that it takes the shape of an equilateral triangle. This shearing, when applied to the right-triangle puzzles
above, produces

ν( , )

λ( , )

ν( , )

λ( , )

µ( , )

µ( , )

which are essentially of the same form as the puzzles in [34], except that our tiles are decorated in a diﬀerent
way. Right-triangle puzzles are thus equivalent to tilings of an equilateral triangle by the tiles

(69)

where we divide each rhombus into its constituent equilateral triangles. Since the internal decoration of each
tile is irrelevant, we may suppress it and instead label the edge states of the tiles by +, 0, − (as long as this
is done in a self-consistent way). Doing so, we obtain the tiles

(70)

−

0

0

−

+

+

−

−

+

+ −

0

−

− −

+

+ −

+

− −

−

− 0

−

+ +

+

0 +

0

+ +

0

0 +

+

−

0

−

+

+

−

+

−

By studying the possible connectivities of the tiles above (and ensuring that 0 states are made internal), we
ﬁnd that this is equivalent to a tiling by only seven tiles:

++

+

−−

−

+

++

−

−−

−

+

+

−

(71)

which recovers the result of [19, 20].

+

−

+−

+

−

−

+

7. Discussion

We conclude with a number of comments and open questions.

1. In this paper we have restricted our attention to the coproduct rules (4) as a means of calculating
various structure constants. It would be even more satisfying to have a direct proof of the product rules
(2) and (3) themselves, using nothing more than the rank-two integrable models in Sections 3.1 and 5.1 and
repeated use of the associated intertwining equations (18) and (47). Such a goal was already achieved in [34]
for the Schur product rule (1), allowing it to be generalized to factorial Schur polynomials, and thus leading
to a solution of the Molev–Sagan problem [28].

2. The connection between the Bethe Ansatz and expansion coeﬃcients of symmetric functions is certainly
not an original one. In the case of the Kostka polynomials, such an idea dates back to [16]. More conceptually
related to the present work, Korﬀ has used the t-boson model to obtain both the Kostka polynomials and
their inverses as expectation values of non-commutative symmetric functions [22]. Our work also appears
closely related with the recent preprint of Borodin and Petrov [5], in which appear a host of multiple integrals
of very similar type to those in the present paper; it would be very rewarding to connect the two works.

3. It is mysterious that the natural t-generalization of Cλ

µν(x), obtained by simply retaining a non-zero t
parameter in the fermion-boson model, does not seem to admit any clear interpretation. It is tempting to
speculate, however, that it should be related to the last of the possible product rules between Hall–Littlewood
and Schur polynomials:

31

(72)

Pµsν =Xλ

K λ

µν(t)Pλ.

We base this speculation on the fact that a) The coproduct version of (72) is Qλ/µ =Pν K λ

µν(t)Sν (this
can be derived from similar reasoning as in Section 5.3). Hence K λ
µν(t) can be calculated by expanding a
skew Hall–Littlewood polynomial in the t-Schur basis; b) Lifting the partition function (62) to generic t, it
clearly has the correct structure to perform such an expansion. The bosonic (black) particles will give rise
to Qλ/µ, while the fermionic (red) particles should in turn allow the expansion in terms of Sν.

4. It would be very desirable to extend our results to the level of Macdonald polynomials, and calculate

(for example) the expansion coeﬃcients in the equations

Pµ(x; q, t)Pν (x; q, t) =Xλ

f λ
µν(q, t)Pλ(x; q, t),

cν(q, t)Pν (x; q, t) =Xλ

K λ

ν (q, t)Sλ(x; t).

Finding a combinatorial rule for f λ
ν (q, t) ∈ N[q, t] were celebrated problems in
Macdonald theory, which were ultimately resolved in [33] and [12]. Can the methods of integrable models
and the Bethe Ansatz be applied to these problems? For the moment, this remains a formidable challenge,
considering that even the Macdonald polynomials themselves are diﬃcult to construct within the framework
of quantum integrability, although recently progress has been made in this direction [8].

µν (q, t) and proving that K λ

5. Because of the Macdonald involution, it can be shown that the structure constants f λ

µν(q, t) possess

the following symmetry (see Equation (7.3) in Section 7, Chapter VI of [27]):

where λ′, µ′, ν′ denote the conjugate of the original partitions. By taking q → 0, this reduces to

µν(q, t) = f λ′
f λ

µ′ν′ (t, q)

bλ(q, t)

bµ(q, t)bν(q, t)

,

µν(t) = f λ′
f λ

µ′ν′ (t, 0)

bλ(t)

bµ(t)bν(t)

,

directly relating the Hall polynomials and the structure constants of the t–Whittaker polynomials. In view
of this, (22) can be dually interpreted as a formula for f λ′

µ′ν′ (t, 0).

Acknowledgments

MW is supported by the ARC grant DE160100958 and the ARC Centre of Excellence for Mathematical and
Statistical Frontiers (ACEMS). MW would like to thank Eric Ragoucy for kind hospitality and stimulating
discussions at the Laboratoire d’Annecy-le-Vieux de Physique Th´eorique (LAPTh), while this manuscript
was in preparation. PZJ is supported by ERC grant “LIC” 278124 and ARC grant DP140102201.

Appendix A. Examples of Theorem 2

A.1. The case ¯λ = (4, 1, 1, 1), ¯µ = (3, 1, 1, 0), ¯ν = (2). The partitions ¯λ, ¯µ, ¯ν are the complements of λ =
(3, 3, 3, 0), µ = (4, 3, 3, 1), ν = (2) by 4. The playing ﬁeld is thus

0

3

0

0

1

+
+

1

2

0

1

0

32

M. WHEELER AND P. ZINN-JUSTIN

One ﬁnds a total of 4 dipole puzzles in Pν(µ, λ), giving rise to the sum

XP ∈Pν (µ,λ)

(−1)L(P )W (P ) =

+
+

0

+

3

−

0

0

+

1

−

0

+

3

−

−
−

−

+
+

0

0

1

+
− +

−

−

−

1

2

0

1

0

1

2

0

1

0

t8(1 − t)2

3

0

0

1

− +
−

+

−

0

+

−

−

+

+
+

0

+

−

+
+

t8(1 − t)3

3

0

0

1

− +
−

+
− +

−
−

−

0

1

2

0

1

0

1

2

0

1

t8(1 − t)3

t8(1 − t)4

Summing the resulting Boltzmann weights, we ﬁnd thatPP ∈Pν (µ,λ)(−1)L(P )W (P ) = t10(1 − t)2. The Hall

polynomial is obtained by normalizing this sum:

¯λ
¯µ¯ν(t) = t−(m+1)|ν| ×

f

B¯λ(t)

B¯µ(t)b¯ν(t)

× XP ∈Pν (µ,λ)

(−1)L(P )W (P )

=

t−10(1 − t)2(1 − t2)(1 − t3)

(1 − t)3(1 − t2)(1 − t)

× t10(1 − t)2 = 1 − t3.

A.2. The case ¯λ = (3, 2, 1), ¯µ = (2, 1, 0), ¯ν = (2, 1). The partitions ¯λ, ¯µ, ¯ν are the complements of λ =
(2, 1, 0), µ = (3, 2, 1), ν = (2, 1) by 3. The relevant puzzles hence have the frame

0

1

1

1

+
+

+

1

1

1

0

In this case there are a total of 28 dipole puzzles in Pν(µ, λ), giving rise to the sum

0

1

+

1
+

−

1

1

t9(1 − t)(1 − t2)

1

0

1

1

+
− +

+

−

1
−

0

1
+

1
−

1

+

−
−

−

0

1

−

−

−

−

−

+
+

+

+
+

+

+

−

+

−

+

−
−

−

1

1
0
t9(1 − t)2(1 − t2)

1

0

1
+

1

−

1
− +
−

+

−

+

−

−

−

−

0
+

1

0
+

+
+

+

+
+

+

+
+

+

+
+

+

−

1

1
0
t9(1 − t)2(1 − t2)

1

1

1
0
t9(1 − t)3(1 − t2)

1

1

1

1
t9(1 − t)3

1

1

1
−

+

1

1
t9(1 − t)2

1

+
−

1
−

+

−
−

−

−

−

−

−

0

1

−

0

1
− +
−

+

−

0

1

−

0

1

−

0

1

1
t9(1 − t)3

1

1
− +
−

+

+
−

1

1
t9(1 − t)4

1

1
−

+
− +

1

1
t9(1 − t)3

−

+

−

+

+

−

+
+

+

+
+

+

+
+

+

+
+

+

+
+

+

+
+

+

0

1

1

1

0

1

1

1

+
−

+

+

−

−

−

−

−

−

+
+

+

+
− +

+

−

−

+

−

−

−

−

−

1

1
0
t9(1 − t)2(1 − t2)

1

1

1
0
t9(1 − t)3(1 − t2)

1

0

1

1

1

0

1

1

1

+
−

+

+
− +
−

−

−
−

−

+

1

1
0
t9(1 − t)3(1 − t2)

1

0

1

1
+

1
−

+

− +
−

−
−
−

−

+
+

+

+
+

+

+
− +

− +
−

+

−

+

−

1

1
0
t9(1 − t)4(1 − t2)

1

0

1
+

1
−

1

+

− +

− +

−

1

1
0
t9(1 − t)2(1 − t2)

1

1

1
0
t9(1 − t)3(1 − t2)

1

0

1

1

1

0

+
− +

−

+

− +
−

−

−
−

+

+
+

+

1

1
0
t9(1 − t)3(1 − t2)

1

1
+

1

1
− +
−

+

− +

− +

−

1

1
0
t9(1 − t)4(1 − t2)

1

0

1

1

1

0

1

1

1

+
−

+

+

−

− +
−

−

−
−

+

+
+

+

+
− +

−

+

− +

− +

−

1

1
0
t9(1 − t)3(1 − t2)

1

1

1
0
t9(1 − t)4(1 − t2)

1

0

1

1

1

0

1

1

1

+
−

+

+
− +

−

− +
−

−
−

−

−

+
+

+

+
− +

− +
−

+

− +

− +

−

1

1
0
t9(1 − t)4(1 − t2)

1

1

1
0
t9(1 − t)5(1 − t2)

1

−
−

−

+

−
−
−

−

−

−
−

−

−
−

−
−

−

+

+

−

+
+

+

+
+

+

+
+

+

+
+

+

+
+

+

+
+

+

0
+

1

0
+

1

0
+

1

0
+

1

0
+

1

0
+

1
−

1

1

+
−

+
− +

1

1
t9(1 − t)4

−

0

1

1

1
− +
−

+
− +

1

1
t9(1 − t)4

−

0

1

1

1
− +
−

+
−

−

0

+
− +

1

1

1
t9(1 − t)5

33

1

1

−

−

−

−
−

−

0

1

1

1

−
−
−

−

−

−
−

−

−
−

−
−

−

+

+

−

+
+

+

+
+

+

+
+

+

+
+

+

+

1

0

+

1

0

+

1

0

+

+

−

1

1

t10(1 − t)2

1

1

+
−

+

−

1

1

t10(1 − t)3

1

1

+
−

+

−

1

1

t10(1 − t)3

1

1

+
−

+
−

+

−

−
−
−

−
−
−

−
−
−

−
−
−

−

0

1

−

0

1

−

0

1

−

1

1

1

0

t10(1 − t)4

Although this is a large sum, we have arranged the puzzles so that terms in each column combine in a
neat way. In fact, one can see that the puzzles in the ﬁrst three columns are “factorized” with respect to

34

M. WHEELER AND P. ZINN-JUSTIN

conﬁgurations that occur in their ﬁrst three and last two rows (i.e. there are 4 possible conﬁgurations of
their top three rows, and 2 of their last two rows, for a total of 8 overall conﬁgurations). For this reason,
each of these columns sum to produce a single factorized expression. The fourth column contains examples
of puzzles which are not factorized in this way (i.e. the conﬁgurations of the top three rows and the last
two rows are not independent of each other). In general, we cannot expect such puzzles to combine nicely
(although they do in this particular case).

Summing the Boltzmann weights in each column, we ﬁnd that

XP ∈Pν (µ,λ)

(−1)L(P )W (P ) = t12(1 − t)(1 − t2) + t12(1 − t)2(1 − t2) + t12(1 − t)2 − t12(1 − t)2

= t12(2 − t)(1 − t)(1 − t2).

Finally, taking care of the normalization for this example, we obtain

¯λ
¯µ¯ν(t) = t−(m+1)|ν| ×

f

B¯λ(t)

B¯µ(t)b¯ν(t)

× XP ∈Pν (µ,λ)

(−1)L(P )W (P )

=

t−12(1 − t)3
(1 − t)3(1 − t)2 × t12(2 − t)(1 − t)(1 − t2) = (2 − t)(1 + t).

Appendix B. Proof of Theorem 3

B.1. Proof of homogeneity and degree. The L matrix (46) is used in the construction of Kλ
µν (x; t),
which gives rise to an x weight every time the right edge of a darkly-shaded tile is vacant. No x weight
is produced when such an edge is occupied. We abbreviate these edges by VREs and OREs (vacant and
occupied right edges).

In any legal lattice conﬁguration, the red particles give rise to |µ| − |λ| = |¯ν| = (m + M − 1)n − |ν| OREs,
while the black particles give rise to (m + M − 1)|ν|. This is a combined (m + M − 1)(n + |ν|) − |ν| OREs, so
in any lattice conﬁguration there are exactly (m + M )(n + |ν|) − (m + M − 1)(n + |ν|) + |ν| = n + 2|ν| VREs,
each with an associated x weight. This establishes the homogeneity and degree of Kλ
µν (x; t). Considering
that the entire right edge of the lattice is unoccupied, this produces n + |ν| trivial VREs, meaning that
Kλ

µν (x; t) has an obvious common factor ofQn+|ν|

B.2. Multiple sum expression for Kλ

i=1 xi.

µν (x; t). Recall the commutation relations
y − tx
y − x

T (y)T (x) +

T (x)T (y),

(1 − t)x

x − y

T (x)T (y) =

T (x)T (y) = T (y)T (x),

(73)

(74)

from Section 5.1.

Lemma 9. By virtue of the commutation relations (73) and (74), one can derive the following equation:

(75)

µ
←−| ⊗ h |T (x1) . . . T (xk−1)T (xk) =
h

µ
←−| ⊗ h |T (xk)T (x1) . . . T (xk−1)

k−1Yj=1(cid:18) xk − txj
xk − xj (cid:19) h
k−1Yj6=i(cid:18) xi − txj
xi − xj (cid:19) h

 (1 − t)xi

xi − xk

µ

←−| ⊗ h |T (xi)T (x1) . . . bT (xi) . . . T (xk) ,

+

k−1Xi=1

valid for any k > 1.

Proof. The proof is almost identical to that of Lemma 4, except that the commutation relation (73) diﬀers
from (23), leading to a slightly diﬀerent ﬁnal expression.
(cid:3)

Next, we notice that (75) can be written more succinctly as a single sum:

(76)

µ
←−| ⊗ h |T (x1) . . . T (xk−1)T (xk) =
h

j=1 (xi − txj )
j6=i(xi − xj)

kXi=1Qk−1
Qk

µ

h

←−| ⊗ h |T (xi)T (x1) . . . bT (xi) . . . T (xk).

Repeatedly iterating (76), it is then straightforward to show that

35

(77) Kλ

µν (x; t) = X16i16k1

(xi1 − txj1 )
(xi1 − xj1 )

j1

Qk1−1
Qk1

j16=i1

in6=i1,...,in−1

· · · X16in6kn
· · ·Qkn−1
Qkn

jn6=i1,...,in

jn6=i1,...,in−1

(xin − txjn )

(xin − xjn )

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )T (xˆı1 ) . . . T (xˆı|ν|)| λ←−i ⊗ | 0←−i,
h

where the summation is over distinct integers {i1, . . . , in} such that ij 6 kj for all 1 6 j 6 n, and where
{ˆı1, . . . , ˆı|ν|} denotes the complement of {i1, . . . , in} in {1, . . . , n + |ν|}.

B.3. Trivial action. The following lemma is the direct analogue of Lemma 5, and can be proved in the
very same way.

Lemma 10. Let | λ←−i be an arbitrary length-ℓ partition state in F , and | 0←−i the length-N zero partition
(0, . . . , 0) in B (N repetitions of 0). Then

(78)

T (y1) . . . T (yN )| λ←−i ⊗ | 0←−i = tℓN

yi| λ←−i ⊗ | i.

NYi=1

B.4. Multiple integral expression for Kλ
in order to eliminate all T operators, giving

µν (x; t). Returning to the sum (77), we apply the relation (78)

(79)

n+|ν|Yi=1

¯xi × Kλ

µν (x; t) = tm|ν| X16i16k1

(¯xi1 . . . ¯xin )×

in6=i1,...,in−1

· · · X16in6kn
· · ·Qkn−1
Qkn

j1

Qk1−1
Qk1

j16=i1

By virtue of the fact that

(xi1 − txj1 )

(xi1 − xj1 )

jn6=i1,...,in−1

(xin − txjn )

jn6=i1,...,in

(xin − xjn )

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )| λ←−i ⊗ | i.
h

µ

←−| ⊗ h |T (xi1 ) . . . T (xin )| λ←−i ⊗ | i =
h

xm+M
ij

Sµ/λ(¯xi1 , . . . , ¯xin ; t) =

nYj=1

xm+M
ij

S¯λ/¯µ(¯xi1 , . . . , ¯xin ; t),

nYj=1

we can then convert the sum (79) into a multiple integral whose integrand contains a skew t-Schur polynomial:

n+|ν|Yi=1

¯xi × Kλ

µν (x; t) = tm|ν|×

Iw1

· · ·Iwn Y16i<j6n

(wj − wi)
(wj − twi)

j=1 (wi − txj)
j=1(wi − xj)

nYi=1Qki−1
Qki

nYi=1

wm+M−1

i

S¯λ/¯µ( ¯w1, . . . , ¯wn; t).

B.5. Acting with divided-diﬀerence operators. Recalling the action (31) of the divided-diﬀerence op-
erators, we ﬁnd that

µν (x; t) = t(m+1)|ν|×

 Yj6∈k(ν)

¯xi Kλ
∆j
n+|ν|Yi=1
· · ·Iwn Y16i<j6n
Iw1

where we have deﬁned k0 = 0.

(wj − wi)
(wj − twi)

nYi=1Q16j6ki−1
Q16j6ki

(wi − txj)
(wi − xj )

nYi=1

wm+M−1

i

S¯λ/¯µ( ¯w1, . . . , ¯wn; t),

36

M. WHEELER AND P. ZINN-JUSTIN

B.6. Homogeneous limit. Taking the limit xi → 0 for all 1 6 i 6 n + |ν|, we obtain

t−(m+1)|ν| × lim

µν (x; t)

n+|ν|Yi=1

¯xi Kλ
nYi=1

(wj − wi)
(wj − twi)

∆j
x→0 Yj6∈k(ν)
· · ·Iwn Y16i<j6n
=Iw1
= Coeﬀ Y16i<j6n
= Coeﬀ Y16i<j6n

(wj − wi)
(wj − twi)

(zi − zj)
(zi − tzj)

wm+M−1+ki−1−ki

i

S¯λ/¯µ( ¯w1, . . . , ¯wn; t)

S¯λ/¯µ( ¯w1, . . . , ¯wn; t),

wki−ki−1−m−M

i

S¯λ/¯µ(z1, . . . , zn; t),

zm+M+ki−1−ki
i

nYi=1
nYi=1



 .

Finally, since m + M + ki−1 − ki = m + M − 1 − νn−i+1 = ¯νi, the ﬁnal expression is equal to b¯ν(t) ¯K ¯λ

¯µ¯ν(t).

Appendix C. Example of Theorem 4

Fix three partitions ¯λ = (1, 1, 1), ¯µ = (0, 0, 0), ¯ν = (2, 1). ¯λ, ¯µ are the complements of λ = (0, 0, 0), µ =
(1, 1, 1) by 1, while ¯ν is the complement of ν = (2, 1) by 3 (see the statement of Theorem 3 for the details
on taking complements). Our puzzles therefore have the frame

0

1

1

1

+
+

+

1

1

1

0

A total of 12 conﬁgurations are possible, leading to the following sum:

1

1

1

1

0

1

1

1

0
+

+
+

+

1
−

+

1

1

1

−t10(1 − t)2

1

+
−

0
+

−

+
+

+

1
−

+

−

−
−

−

−

−

0

1

−

+

−

−

+
+

+

+
+

+

0
+

1
−

+
− +

1

1

1

−t10(1 − t)3

0
+

1
−

1

1

+
−

+
− +

−
−
−

−

−

0

−

−
−

+

−

0

+

−

1

1

t12(1 − t)2

1

1

+
−

+

−

−
−
−

−
−
−

−

0

1

−

+
+

+

+
+

+

+

1

0

+

1

1

1

0

t12(1 − t)3

1

1

1

0

1

1

1

−t10(1 − t)3

−t10(1 − t)4

1

1

0

1

1

1

37

−

−
−

−
−

−

+

−

+
+

+

+
+

+

+

1

0

+

+
−

+

−

1

1

t12(1 − t)3

1

1

+
−

+
−

+

−

−
−
−

−
−
−

−

0

1

−

1

1

1

0

t12(1 − t)4

−

0

−

0

1

1

0
+

1
− +
−

+

1

1

1

−t10(1 − t)3

0
+

1

1
− +
−

+
−

+

−

−

+

−

0

1

−

−

−
−

−

−

+
+

+

+
+

+

−

+

+
+

+

+
+

+

0
+

1
− +
−

+
− +

1

1

1

−t10(1 − t)4

0
+

1
− +
−

1

1

+
−

+
− +

1

1

1

0

1

1

1

−t10(1 − t)4

−t10(1 − t)5

Summing the resulting Boltzmann weights, we ﬁnd that PP ∈Pν (µ,λ)(−1)L(P )W (P ) = −t13(1 − t)2(1 + t).

The inverse Kostka polynomial is obtained by normalizing this sum:

¯K

¯λ
¯µ¯ν (t) ≡ ¯K

¯λ
¯ν (t) =

t−(m+1)|ν|

b¯ν(t)

× XP ∈Pν (µ,λ)

(−1)L(P )W (P )

=

t−12
(1 − t)2 × −t13(1 − t)2(1 + t) = −t(1 + t).

References

[1] N. M. Bogoliubov. Boxed plane partitions as an exactly solvable boson model. Journal of Physics A: Mathematical and

General, 38(43):9415, 2005.

[2] N. M. Bogoliubov and R. K. Bullough. A q-deformed completely integrable bose gas model. Journal of Physics A: Math-

ematical and General, 25(14):4057, 1992.

[3] N. M. Bogoliubov, A. G. Izergin, and N. A. Kitanine. Correlation functions for a strongly correlated boson system. Nuclear

Physics B, 516(3):501–528, 1998.

[4] A. Borodin. On a family of symmetric rational functions. arXiv:1410.0976, 2014.
[5] A. Borodin and L. Petrov. Higher spin six vertex model and symmetric rational functions. arXiv:1601.05770, 2016.
[6] B. Broer. Line bundles on the cotangent bundle of the ﬂag variety. Inventiones Mathematicae, 113(1):1–20, 1993.
[7] R. K. Brylinski. Twisted ideals of the nullcone. In Operator algebras, unitary representations, enveloping algebras, and

invariant theory (Paris, 1989), volume 92 of Progr. Math., pages 289–316. Birkh¨auser Boston, Boston, MA, 1990.

[8] L. Cantini, J. de Gier, and M. Wheeler. Matrix product formula for Macdonald polynomials. Journal of Physics A:

Mathematical and Theoretical, 48(38):384001, 2015.

[9] T. Deguchi and Y. Akutsu. A new hierarchy of colored vertex models. Journal of the Physical Society of Japan, 60(12):4051–

4059, 1991.

[10] L. D. Faddeev. How algebraic Bethe Ansatz works for integrable model. In Sym´etries quantiques (Les Houches). Citeseer,

1996.

[11] B. U. Felderhof. Direct diagonalization of the transfer matrix of the zero-ﬁeld free-fermion model. Physica, 65(3):421–451,

1973.

[12] M. Haiman. Hilbert schemes, polygraphs and the Macdonald positivity conjecture. Journal of the American Mathematical

Society, 14(4):941–1006, 2001.

[13] P. Hall. The algebra of partitions. In Proc. 4th Canadian Math. Congress, pages 147–159, 1959.
[14] R. Hotta and T. A. Springer. A specialization theorem for certain Weyl group representations and an application to the

Green polynomials of unitary groups. Invent. Math., 41(2):113–127, 1977.

[15] A. N. Kirillov. Skew divided diﬀerence operators and Schubert polynomials. Symmetry, Integrability and Geometry: Meth-

ods and Applications, 3(0):72–14, 2007.

[16] A. N. Kirillov and N. Y. Reshetikhin. Bethe ansatz and combinatorics of Young tableaux. Zapiski Nauchnykh Seminarov

POMI, 155:65–115, 1986.

[17] A. Knutson. Schubert polynomials and symmetric functions. Notes from Lisbon Combinatorics Summer School, 2012.
[18] A. Knutson and T. Tao. The honeycomb model of GLn(C) tensor products I: Proof of the saturation conjecture. Journal

of the American Mathematical Society, 12(4):1055–1090, 1999.

[19] A. Knutson and T. Tao. Puzzles and (equivariant) cohomology of Grassmannians. Duke Mathematical Journal, 119(2):221–

260, 2003.

38

M. WHEELER AND P. ZINN-JUSTIN

[20] A. Knutson, T. Tao, and C. Woodward. The honeycomb model of GLn(C) tensor products II: Puzzles determine facets of

the Littlewood–Richardson cone. Journal of the American Mathematical Society, 17(1):19–48, 2004.

[21] V. E. Korepin, N. M. Bogoliubov, and A. G. Izergin. Quantum inverse scattering method and correlation functions.

Cambridge University Press, 1997.

[22] C. Korﬀ. Cylindric versions of specialised Macdonald functions and a deformed Verlinde algebra. Communications in

Mathematical Physics, 318(1):173–246, 2013.

[23] A. Lascoux and M.-P. Sch¨utzenberger. Polynˆomes de Schubert. Comptes Rendus de l’Academie des Sciences S´erie I,

294(13):447–450, 1978.

[24] A. Lascoux and M.-P. Sch¨utzenberger. Sur une conjecture de H. O. Foulkes. Comptes Rendus de l’Academie des Sciences

S´erie A, 286(7):323–324, 1978.

[25] D. E. Littlewood and A. R. Richardson. Group characters and algebra. Philosophical Transactions of the Royal Society of

London. Series A, Containing Papers of a Mathematical or Physical Character, pages 99–141, 1934.

[26] I. G. Macdonald. Notes on Schubert polynomials, volume 6. Montr´eal: D´ep. de math´ematique et d’informatique, Universit´e

du Qu´ebec `a Montr´eal, 1991.

[27] I. G. Macdonald. Symmetric functions and Hall polynomials. Oxford Mathematical Monographs. The Clarendon Press
Oxford University Press, New York, second edition, 1995. With contributions by A. Zelevinsky, Oxford Science Publications.
[28] A. Molev and B. Sagan. A Littlewood–Richardson rule for factorial Schur functions. Transactions of the American Math-

ematical Society, 351(11):4429–4443, 1999.

[29] M.-P. Sch¨utzenberger. La correspondance de Robinson. Springer, 1977.
[30] G. P. Thomas. Baxter algebras and Schur functions. PhD thesis, University College of Swansea, 1975.
[31] N. V. Tsilevich. The quantum inverse scattering problem method for the q-boson model, and symmetric functions. Func-

tional Analysis and Its Applications, 40(3):53–65, 96, 2006.

[32] M. Wheeler and P. Zinn-Justin. Reﬁned Cauchy/Littlewood identities and six-vertex model partition functions: III. De-

formed bosons. arXiv:1508.02236, 2015.

[33] M. Yip. A Littlewood–Richardson rule for Macdonald polynomials. Mathematische Zeitschrift, 272(3-4):1259–1290, 2012.
[34] P. Zinn-Justin. Littlewood–Richardson coeﬃcients and integrable tilings. The Electronic Journal of Combinatorics,

16(1):R12, 2009.

Michael Wheeler, School of Mathematics and Statistics, University of Melbourne, Parkville, Victoria 3010,

Australia

E-mail address: mwheeler@ms.unimelb.edu.au

Paul Zinn-Justin, Laboratoire de Physique Th´eorique et Hautes ´Energies, CNRS UMR 7589 and Universit´e

Pierre et Marie Curie (Paris 6), 4 place Jussieu, 75252 Paris cedex 05, France

E-mail address: pzinn@lpthe.jussieu.fr

