6
1
0
2

 
r
p
A
6

 

 
 
]

V
C
.
s
c
[
 
 

3
v
8
5
9
3
0

.

3
0
6
1
:
v
i
X
r
a

Template Adaptation for Face Veriﬁcation and Identiﬁcation

Nate Crosswhite, Jeffrey Byrne

Systems & Technology Research (STR)

{nate.crosswhite, jeffrey.byrne}@stresearch.com

Chris Stauffer

Visionary Systems and Research (VSR)

stauffer@vsandr.com

Omkar M. Parkhi, Qiong Cao, Andrew Zisserman

University of Oxford

{omkar, qiong, az}@robots.ox.ac.uk

Abstract

Face recognition performance evaluation has tradition-
ally focused on one-to-one veriﬁcation, popularized by the
Labeled Faces in the Wild dataset [1] for imagery and the
YouTubeFaces dataset [2] for videos. In contrast, the newly
released IJB-A face recognition dataset [3] uniﬁes evalua-
tion of one-to-many face identiﬁcation with one-to-one face
veriﬁcation over templates, or sets of imagery and videos
for a subject. In this paper, we study the problem of template
adaptation, a form of transfer learning to the set of media
in a template. Extensive performance evaluations on IJB-A
show a surprising result, that perhaps the simplest method
of template adaptation, combining deep convolutional net-
work features with template speciﬁc linear SVMs, outper-
forms the state-of-the-art by a wide margin. We study the
effects of template size, negative set construction and clas-
siﬁer fusion on performance, then compare template adap-
tation to convolutional networks with metric learning, 2D
and 3D alignment. Our unexpected conclusion is that these
other methods, when combined with template adaptation,
all achieve nearly the same top performance on IJB-A for
template-based face veriﬁcation and identiﬁcation.

1. Introduction

Face recognition performance using deep learning has
seen dramatic improvements in recent years. Convolutional
networks trained with large datasets of millions of images
of thousands of subjects have shown remarkable capability
of learning facial representations that are invariant to age,
pose, illumination and expression (A-PIE) [4, 5, 6, 7, 8, 9].
These representations have shown strong performance for
recognition of imagery and video in-the-wild in uncon-
strained datasets, with recent approaches demonstrating
capabilities that exceed human performance on the well
known Labeled Faces in the Wild dataset [1].

The problem of face recognition may be described in
terms of face veriﬁcation and face identiﬁcation. Face veri-
ﬁcation involves computing a one-to-one similarity between
a probe image and a reference image, to determine if two
image observations are of the same subject.
In contrast,
face identiﬁcation involves computing a one-to-many sim-
ilarity between a probe media and a gallery of known sub-
jects in order to determine a probe identity. Face veriﬁcation
is important for access control or re-identiﬁcation tasks, and
face identiﬁcation is important for watch-list surveillance or
forensic search tasks.

Face recognition performance evaluations have tradition-
ally focused on the problem of face veriﬁcation. Over the
past ﬁfteen years, face datasets have steadily increased in
size in terms of number of subjects and images, as well as
complexity in terms controlled vs. uncontrolled collection
and amount of A-PIE variability [10]. The Labeled Faces
in the Wild dataset [1] contains 13233 images of 1680 sub-
jects, and compares speciﬁc pairs of images of subjects to
characterize 1:1 veriﬁcation performance. Similarly, the
YouTubeFaces dataset [2] contains 3425 videos of 1595
subjects, and compares pairs of videos of subjects for veriﬁ-
cation. These datasets have set the established standard for
face recognition research, with steadily increasing perfor-
mance [11, 5, 6, 4]. Recently, protocols for face identiﬁca-
tion have been introduced for LFW [12] to address the per-
formance evaluation for identiﬁcation on a common dataset.
However, the imagery in LFW was constructed with a well
known near-frontal selection bias, which means evaluations
are not predictive of performance for large in-the-wild pose
variation. In fact, recent studies have shown that while al-
gorithm performance for near frontal recognition is equal to
or better than humans, performance of automated systems at
the extremes of illumination and pose are still well behind
human performance [13].

The IJB-A dataset [3] was created to provide the newest
and most challenging dataset for both veriﬁcation and iden-

1

tiﬁcation. This dataset includes both imagery and video of
subjects manually annotated with facial bounding boxes to
avoid the near frontal bias, along with protocols for evalu-
ation of both veriﬁcation and identiﬁcation. Furthermore,
this dataset performs evaluations over templates [14] as the
smallest unit of representation, instead of image-to-image
or video-to-video. A template is a set of all media (im-
ages and/or videos) of a subject that are to be combined
into a single representation suitable for matching. Template
based representations are important for many face recog-
nition tasks, which take advantage of an historical record
of observations to further improve performance. For exam-
ple, a template provides a useful abstraction to capture the
mugshot history of a criminal for forensic search in law en-
forcement, or lifetime enrollment images for visa or driver’s
licenses in civil identity credentialing for improved access
control. Biometric templates have been studied for face
recognition, where performance on older algorithms have
increased given an historical set of images [14]. The IJB-A
dataset is the only public dataset that enables a controlled
evaluation of template-based veriﬁcation and identiﬁcation
at the extremes of pose, illumination and expression.

In this paper, we study the problem of template adapta-
tion. Template adaptation is an example of transfer learning,
where the target domain is deﬁned by the set of media of a
subject in a template. In general, transfer learning includes
a source domain for feature encoding of subjects trained of-
ﬂine, and a speciﬁc target domain with limited available ob-
servations of new subjects. In the case of template adapta-
tion, the source domain may be a deep convolutional net-
work trained ofﬂine to predict subject identity, and the tar-
get domain is the set of media in templates of never before
seen subjects. In this paper, we study perhaps the simplest
form of template adaptation based on deep convolutional
networks and one-vs-rest linear SVMs. We combine deep
CNN features trained ofﬂine to predict subject identity, with
a simple linear SVM classiﬁer trained at test time using all
media in a template as positive features to classify each new
subject.

Extensive evaluation of template adaptation on the IJB-
A dataset has generated surprising results. First, template
adaptation outperforms all top performing techniques in the
literature: convolutional networks combined with triplet
loss similarity [6, 4, 15], joint Bayesian metric learning
[16], pose specialized networks [17], 2D alignment [4], 3D
frontalization [5] and novel convolutional network archi-
tectures [18]. Second, template adaptation when combined
with these other techniques results in nearly equivalent per-
formance. Third, we show a clear tradeoff between the size
of a template (e.g. the number of unique media in the tem-
plate) and performance, which leads to the conclusion that if
the average largest template size is big enough, then a sim-
ple template adaptation strategy is the best choice for both

veriﬁcation and identiﬁcation on template based datasets.

2. Related Work

The top performing approaches for face veriﬁcation on
Labeled Faces in the Wild [1] and YouTubeFaces [2] are all
based on convolutional networks. VGG-Face is the applica-
tion of the VGG-16 convolutional network architecture [19]
trained on a newly curated dataset of 2.6M images of 2622
subjects. This representation includes triplet loss embed-
ding and 2D alignment for normalization to provide state
of the art performance. FaceNet [6] applied the inception
CNN architecture [20] to the problem of face veriﬁcation.
This approach included metric learning to train a triplet
loss embedding to learn a 128 dimensional embedding op-
timized for veriﬁcation and clustering. This network was
trained using a private dataset of over 200M subjects. Deep-
Face [5][7] uses a deep network coupled with 3D alignment,
to normalize facial pose by warping facial landmarks to a
canonical position prior to encoding. DeepID2+ [9] and
DeepID3 [8] extended the inception architecture to include
joint Bayesian metric learning [21] and multi-task learning
for both identiﬁcation and veriﬁcation.

These top performing convolutional network architec-
tures have interesting common properties. First, they all
exhibit deep convolutional network structure, often with
parallel specialized sub-networks. However, Parkhi et. al
[4] showed that a the VGG-16 very deep architecture [19],
when trained with a broad and deep dataset containing
one thousand examples of 2622 subjects, outperformed net-
works with specialized networks [6] and ensembles [8] on
YouTubeFaces. Second, many top performing approaches
use some form of pose normalization such as 2D/3D align-
ment [5, 4, 17] to warp the facial landmarks into a canonical
frontal pose. Finally, many approaches use metric learning
in the form of triplet loss similarity or joint Bayesian metric
learning for the ﬁnal loss to learn an optimal embedding for
veriﬁcation [6, 4, 16]. An recent independent study reached
a similar conclusion that multiple networks combined in an
ensemble and metric learning are crucial for strong perfor-
mance on LFW [22].

Recent evaluations on IJB-A [3] are also based on convo-
lutional networks and mirror the top performing approaches
on LFW and YouTubeFaces. Recent approaches include
deep networks using triplet loss similarity[15][23] and joint
Bayesian metric learning [16], and ﬁve pose specialized
sub-networks with 3D pose rendering [17]. Face-BCNN
[18] applies the bilinear CNN architecture to face identi-
ﬁcation, publishing the earliest results on IJB-A.

Transfer learning has been well studied in the literature,
and we refer to a comprehensive survey on the topic [24].
Transfer learning and domain adaptation for convolutional
networks is typically performed by pretraining the network
on a labeled source domain, replacing the ﬁnal loss layer for

2

Figure 1. Template Adaptation Overview. (left) Without template adaptation, the probe template is about equally similar as shown by the
dotted lines to the mated and non-mated templates. (middle) With probe adaptation, a max-margin classiﬁer separates the probe template
features from a large negative feature set, which increases the mated template similarity and decreases the non-mated. (right) With gallery
adaptation, a max-margin classiﬁer separates each gallery template features from all other gallery templates, which results in desired
decrease in similarity between the probe and non-mated template.

a new task, then ﬁne-tuning the network on this new objec-
tive using data from the target domain [25]. Prior work has
shown that freezing the network, then replacing a softmax
loss layer with a linear SVM loss can result in improved per-
formance for classiﬁcation tasks [26, 27]. These approaches
can be further improved by jointly training the SVM loss
and the CNN parameters, so that the lower level features
are ﬁne-tuned with respect to the SVM objective [26]. How-
ever, such retraining requires a large target domain training
set to ﬁne tune all parameters in the deep network. In this
paper, we focus on updating the linear SVM only, as this
classiﬁer has a regularization structure that has been shown
to perform well for unbalanced training sets with few pos-
itive examples (e.g. from media in a template) and many
negative examples [28][29].

Finally, we note that the approach of deﬁning a similar-
ity function for face veriﬁcation using linear SVMs trained
on a large negative set was originally proposed as one-shot
similarity (OSS) [30][31]. We study the more general form
of this original idea, by considering templates of images and
videos of varying size, alternative fusion strategies, and the
impact of gallery negative sets for identiﬁcation.

3. Template Adaptation

Template adaptation is a form of transfer learning, com-
bining deep convolutional network features trained on a
source domain of many labeled faces, with template speciﬁc
linear SVMs trained on a target domain using the media in
a template. Template adaptation can be further decomposed
into probe adaptation for face veriﬁcation and gallery adap-
tation for face identiﬁcation. In this section, we describe
these approaches.

First, we provide preliminary deﬁnitions. A media ob-
servation x is either a color image of a subject, or a
set of m video frames of a subject. An image encod-
ing z = f (x) is a mapping f (x) ∈ Rd from an im-
age x to an encoding z with dimensionality d (e.g.
fea-

3

(cid:80)

tures from a deep CNN). An average encoding ¯z =
x f (x) is the average of image/frame encodings in a
1
m
media observation, such as the encodings for all frames
in a video. A template X is a set of encoded media ob-
servations X = {f (x1), f (x2), . . . , f (xk)} of one sub-
ject. The size of a template |X| is deﬁned as the num-
ber of unique media used for encoding. Finally, a gallery
G = {(X1, y1), (X2, y2), . . . , (Xm, ym)} is a set of tuples
of templates X and associated subject identiﬁcation label y.
Figure 1 shows an overview of this concept. Each col-
ored shape corresponds to a feature encoding of image or
a video feature for the media in a template, such as gener-
ated from a convolutional network trained ofﬂine. The gray
squares correspond to encodings of a large set of media of
unique subjects that are very likely to be disjoint from any
template. The centroid of the colored shapes corresponds
to the average encoding for this template. Probe adapta-
tion is the problem of max-margin classiﬁcation of the pos-
itive features from a template to the large negative feature
set. The similarity between the blue probe template and
the mated (genuine subject) green template is the margin
(dotted lines) of the green feature encodings to the deci-
sion surface. Observe that this margin is positive, whereas
the margin for the red classiﬁer is negative, so that the
blue/green similarity is much larger than blue/red as de-
sired. Gallery adaptation is the problem of max-margin
classiﬁcation where the negative feature set for the gallery
templates are deﬁned by the other gallery templates. Ob-
serve that adding the magenta subject causes the decision
surface for the red and green classiﬁers to shift, improving
the margin score for the probe.

More formally, probe adaptation is the training of a sim-
ilarity function s(P, Q) for a probe template P and refer-
ence template Q. Train a linear SVM for P , using unit nor-
malized average encodings of media in P as positive fea-
tures and a large feature set as negatives. The large neg-
ative set contains one feature encoding for many subject

identities, so this set is very likely to be disjoint with the
probe template. Similarly, train a linear SVM for Q, us-
ing the unit normalized average encodings for media in Q
as positive features and a large feature set as negatives. Fi-
nally, let P (q) be notation for evaluating the SVM func-
tional margin (e.g. wT x) trained on P , and evaluated using
the unit normalized average media encoding q in template
Q. The ﬁnal similarity score for probe adaptation is the fu-
sion of the two classiﬁer margins using a linear combination
2 Q(p). For implementation details, see
s(P, Q) = 1
section 4.1.

2 P (q)+ 1

Gallery adaptation is the training of a similarity function
s(P, G) from a probe template P to gallery G. A gallery
contains templates G = {X1, X2, . . . , Xm}, and gallery
adaptation trains a linear SVM for all pairs s(P, Xi) fol-
lowing the approach for probe adaptation. Gallery adapta-
tion differs from probe adaptation in that the large negative
set for a template Xi is all unit normalized media encod-
ings from all other templates in G not including Xi.
In
other words, the other non-mated subjects in the gallery are
used to construct negative features for Xi, whereas the large
negative set is used for P . The ﬁnal similarity score for
gallery adaptation is the fusion of the probe classiﬁer and
the gallery classiﬁer for each X ∈ G using the linear com-
bination s(P, X) = 1

2 P (x) + 1

2 X(p).

4. Results

The proposed approach in section 3 introduces a number

of research questions to study.

How does this compare to the state of the art? In sec-
tion 4.2, we compare the template adaptation approach to
all published results and show that the proposed approach
exceeds the state of the art by a wide margin. Furthermore,
in section 4.3 we perform an analysis of alternatives to com-
bine the state of the art techniques with template adaptation
and show that when combined, these alternative approaches
all result in nearly the same performance.
How should the negative set be formed? Template adap-
tation requires training linear SVMs, which require a la-
beled set of positive and negative feature encodings. In sec-
tion 4.4, we perform a study to evaluate different strategies
of constructing this negative set including using a holdout
set, external negative set and combinations. Results show
that the gallery based negative set is best for gallery adapta-
tion, and a holdout set derived from the same dataset as the
templates is best for veriﬁcation.
How large do the templates need to be? In section 4.5,
we study the effect of template size, or total number of me-
dia in a template, on veriﬁcation performance to identify the
minimum template size necessary, to help guide future tem-
plate based dataset construction. We show that a minimum

of three unique media per template results in diminishing
returns for template adaptation.
How should template classiﬁer scores be fused? In sec-
tion 4.6, we study the effect of different strategies for com-
bination of two classiﬁers, based on winner take all and
weighted combinations of on template size. We conclude
that an average combination is best with winner take all a
close second.
What are the error modes of the template adaptation?
In section 4.7, we visualize the best and worst templates
pairs in IJB-A for veriﬁcation (identiﬁcation errors are
shown in the supplementary material), and we show that
template size (e.g. number of media in a template) has the
largest effect on performance.

4.1. Experimental System

We use the VGG-Face deep convolutional neural net-
work [4], using the penultimate layer output as the feature
encoding f. For computing the average encoding across
frames of video, we use face tracks which compute the
mean encoding of all frames in a video followed by unit
normalization. This approach was shown to be effective for
Fisher vector encoding [33] and deep CNN encoding [4].

Media encoding is preprocessed according to the follow-
ing pipeline. For each media, we crop each face using the
ground truth or detected facial bounding box dilated by a
factor of 1.1. Then, we anisotropically rescale this face crop
to 224x224x3, such that the aspect ratio is not preserved.
This is the assumed input size for the CNN. Next, we en-
code this face crop for each image or frame in the template
using the VGG-face network, and compute average video
encodings for each video. Next, we unit normalize each me-
dia feature, and train the weights and bias for a linear SVM
for each template. We use the LIBLINEAR library with L2-
regularized L2-loss primal SVM with class weighted hinge
loss objective [34].

Np(cid:88)
Nn(cid:88)

i=1

Cn

min

w

1
2

wT w + Cp

max[0, 1 − yiwT xi]2+

max[0, 1 − yjwT xj]2

(1)

j=1

The loss in (1) includes terms for both positive and nega-
tive features, such that Cp is the regularization constant for
Np positive observations (yi = +1) and Cn for negative
observations (yi = −1). This formulation of the loss en-
ables data rebalancing for cases where Np << Nn. The
positive features in Np are the average media encodings
in the template. The negative features are derived from a
large negative feature set in Nn (either from a large nega-
tive set for probe adaptation, or other non-mated templates
for gallery adaptation). The parameters Cp = C Np+Nn
2Np

4

Figure 2. IJB-A Evaluation. (top) 1:1 DET for veriﬁcation, 1:N DET for identiﬁcation and CMC for identiﬁcation shown for template
adaptation and VGG-face [4]. (bottom) Performance at operating points as compared to published results sorted by rank-1 recall (true
positive identiﬁcation rate or TPIR) for VGG-face [4], Bilinear-CNN [18], Joint Bayesian [15], Triplet Similarity [16], Face-Search [32]
and Deep Multipose [17]. Results show that Template Adaptation sets a new state-of-the-art by a wide margin.

and Cn = C Np+Nn
adjust the regularization constants to
2Nn
be proportional to the inverse class frequency. The param-
eter C = 10 in the SVM, trading-off regularizer and loss,
was determined using an held-off validation subset of the
data. Finally, the learned weights w include a bias term by
augmenting x with a constant dimension of one.

At test time, we evaluate the linear SVMs as described
in section 3. We compute the average media encodings
for each media in a template, then compute the mean of
the media encodings, then unit normalize forming a tem-
plate encoding. This constructs a single feature for each
template. Given two templates P and Q, let the nota-
tion P (q) be the evaluation of the functional SVM mar-
gin (e.g. P (x) = wT x) for the trained linear SVM for P ,
given the template encoding q for Q. Finally, the similar-
ity s(P, Q) = 1
2 Q(p) is a weighted combination
of the functional margins for the SVM for P evaluated on
template encoding q and Q evaluated on p.

2 P (q) + 1

For baseline comparison, we use the VGG-face network
with the output of the 4096d features from the penulti-
mate fully connected layer layer. Media encodings are con-
structed by averaging features across a video [33, 4], and
template encodings are constructed by averaging media en-
codings over a template, then unit normalizing. Template
similarity is equivalent to negative L2 distance over unit
normalized template encodings. We also compare results
with 2D alignment, triplet similarity embedding and joint
Bayesian triplet similarity embedding. For the triplet loss

and joint Bayesian metric learning, we use hyperparame-
ter settings such that minibatch = 1800, 1M semi-hard [6]
negative triplets per minibatch, dropconnect regularization
[35], 3 epochs of Parallel SGD [36], ﬁxed learning rate
ν = 0.25. For 2D alignment, we use ground truth facial
bounding boxes and facial landmark regression [37], fol-
lowed by a robust least squares similarity transform estima-
tion to a reference box to best center the nose.

For all research studies in sections 4.3 - 4.7, we report 1:1
veriﬁcation ROC curve for all probe and gallery template
pairs in IJB-A split 1 and CMC for identiﬁcation on IJB-A
split 1 (see section 4.2 for deﬁnitions). This is equivalent
to IARPA Janus Challenge Set 2 (CS2) evaluation protocol,
which is also reported in the literature.

4.2. IJB-A Evaluation

In this section, we describe the results for evaluation of
the experimental system on the IJB-A veriﬁcation and iden-
tiﬁcation protocols [3].
IJB-A contains 5712 images and
2085 videos of 500 subjects, for an average of 11.4 im-
ages and 4.2 videos per subject. This dataset was manually
curated using Mechanical Turk from media-in-the-wild to
annotate the facial bounding box and eyes and nose facial
landmarks, and this manual annotation avoids the Viola-
Jones near-frontal bias. Furthermore, this dataset was cu-
rated to control for ethnicity, country of origin and pose bi-
ases.

Metrics for 1:1 veriﬁcation are evaluated using a decision

5

error tradeoff (DET) curve. The 1:1 DET curve is equiv-
alent to a receiver operating characteristics (ROC) curve,
where the true accept rate is one minus the false negative
match rate. This evaluation plots the false negative match
rate vs.
the false match rate as a function of similarity
threshold for a given set of pairs of templates for veriﬁca-
tion.

Metrics for 1:N identiﬁcation are the Decision Error
Tradeoff (DET) curve and the Cumulative Match Charac-
teristic (CMC) curve. The 1:N DET curve plots the false
negative identiﬁcation rate vs. the false positive identiﬁca-
tion rate as a function of similarity threshold for a search
of L=20 candidate identities in a gallery. The 1:N CMC
curve is an information retrieval metric that captures the re-
call of a speciﬁc probe identify within the top-K most sim-
ilar candidates when searching the gallery. This DET curve
is appropriate for limiting the workload for an analyst by
allowing for a similarity threshold to be applied to reject
false matches even if in the top-K. For detailed description
of these metrics, refer to [3, 14].

Performance evaluation for IJB-A requires evaluation of
ten random splits of the dataset into training and testing
(gallery and probe) sets. The evaluation protocol for 1:1
veriﬁcation considers speciﬁc pairs of mated (genuine) and
non-mated (imposter) subjects. The non-mated pairs were
chosen to control for gender and skin tone to make the veri-
ﬁcation problem more challenging. Performance is reported
for operating points on each of the curves: 1:1 DET reports
false negative match rate at a false match rate of 1e-2, 1:N
DET report true positive identiﬁcation rate (e.g. 1-false neg-
ative identiﬁcation rate) at false positive identiﬁcation rate
of 1e-2, and CMC report true positive identiﬁcation rate (re-
call or correct retrieval rate) at rank-one and rank-ten. The
10 splits are used to compute standard deviations for each
of these operating points, to characterize statistical signiﬁ-
cance of the results.

Figure 2 shows the overall evaluation results on IJB-A.
This evaluation compares the baseline approach of VGG-
Face only [4] with the proposed approach of VGG-Face en-
coding with probe and gallery template adaptation. These
results show that identiﬁcation performance is slightly im-
proved for rank 1 and rank 10 retrieval, however there are
large performance improvements for the 1:N DET for iden-
tiﬁcation and the 1:1 DET for veriﬁcation. The table in
ﬁgure 2 shows performance at speciﬁc operating points for
veriﬁcation and identiﬁcation, and compares to published
results in the literature for joint Bayesian metric learning
[16], triplet similarity embedding [15], multi-pose learn-
ing [17], bilinear CNNs [18] and very deep CNNs [4, 32].
These results show that the proposed template adaptation,
while conceptually simple, exhibits state-of-the-art perfor-
mance by a wide margin on this dataset.

6

4.3. Analysis of Alternatives

Figure 4 shows an analysis of alternatives study. The
state of the art approaches on LFW and YouTubeFaces of-
ten augment a very deep CNN encoding with metric learn-
ing [6, 4] for improved veriﬁcation scores or 2D alignment
[5, 4] to better align facial bounding boxes. In this study, we
implement triplet loss similarity embedding, joint Bayesian
similarity embedding and 2D alignment, and use these al-
ternative feature encodings as input to template adaptation.
In this study, we seek to answer whether these alternative
strategies will provide improved performance over using
CNN encoding only or CNN encoding with template adap-
tation.

We report 1:1 DET for all probe and gallery template
pairs in IJB-A split 1 and CMC for identiﬁcation on IJB-
A split 1. This study shows that template adaptation on
the CNN output provides nearly the same result as template
adaptation with metric learning or 2D alignment based fea-
tures. This implies that the additional training and computa-
tional requirements for these approaches are not necessary
for template based datasets. Furthermore, this study shows
that 2D alignment does not provide much beneﬁt on IJB-
A, in contrast with reported performance on near frontal
datasets [4, 5]. One hypothesis is that this is due to the
fact that this dataset has many proﬁle faces for which facial
landmark alignment is inaccurate or fails altogether.
4.4. Negative Set Study

Figure 3 shows a negative set study. We study the effect
of different combinations of negative feature sets on over-
all veriﬁcation performance. Recall that probe and gallery
template adaptation require the use of a large negative set
for training each linear SVM. This study compares using
combinations of features drawn from the non-mated sub-
jects in the gallery (neg) and features drawn from an inde-
pendent subject disjoint training set (trn). This training set
is drawn from the same dataset distribution as the gallery,
but is subject disjoint.

The results in ﬁgure 3 show that using the gallery set
as negative feature set provides the best performance for
gallery adaptation. Using the disjoint training set for probe
adaptation is the best for veriﬁcation. This is the ﬁnal strat-
egy used for evaluation in ﬁgure 2. This conclusion is some-
what surprising that the probe adaptation was worse when
constructing a negative set combining neg+trn, as a larger
negative set typically results in better generalization perfor-
mance for related approaches such as exemplar-SVM [28].
However, a larger negative set would dilute the effect of the
discriminating between gallery subjects, which is the pri-
mary goal of the evaluation, so a focused negative set would
be appropriate.

Next, we experimented with the CASIA Web-Face
dataset [38]. The best negative set for probe adaptation is

Figure 3. Negative Set Analysis. We compare the effect of different negative sets for template adaptation. (top) The best choice is using
the other non-mated gallery templates to deﬁne the negative set. (bottom) Experiments with a large unrelated negative set based on CASIA
WebFaces results in slightly lowered performance.

a set drawn from the same distribution as the templates.
However, in many operatational conditions, this dataset will
not be available. To study these effects, we constructed
a dataset by sampling 70K images from CASIA balanced
over classes, and pre-encoding these images for template
adaptation training. Figure 3 (bottom) shows that this re-
sults in slightly reduced veriﬁcation performance. One hy-
pothesis is that this imagery exhibits an unmodeled dataset
bias for IJB-A faces, or that CASIA is image only, while
IJB-A is imagery and videos.

4.5. Template Size Study

Figure 5 shows an analysis of performance as a function
of template size. For this study, we consider pairs of tem-
plates (P, Q) and compute the maximum template size as
max(|P|,|Q|). Next, we consider max template sizes in the
range (1, 2), (2, 4), (4, 8), (8, 16), (16, 32)and(32, 64), and
compute a veriﬁcation ROC curve for only those template

pairs with sizes within the range. For each, we report a sin-
gle point on the ROC curve at a false alarm rate of 1e-2 or
1e-3. Results from section 4.2 show that the largest beneﬁt
for template adaptation is on veriﬁcation performance, so
we analyze the effect of the template sizes on this metric.

Figure 5 (left) shows mean similarity score for templates
of mated subjects only within a given template size range.
This shows that as the template size increases the mated
similarity score also increases. This is perhaps not surpris-
ing, as the more observations of media that are available in
a template, the better the subject representation and the bet-
ter the similarity score. The largest uncertainty as shown by
the error bars is when the maximum template size is one,
which is also not too surprising. Interestingly, the variance
on the similarity scores does not decrease as template sizes
increase, rather they stay largely the same even as the mean
similarity increases.

Figure 5 (right) shows the effect of template size on ver-

7

Figure 4. Analysis of Alternatives. We show veriﬁcation ROC curves (left) and identiﬁcation CMC curves (right) for IJB-A split-1.
(top) Template adaptation compared with CNN encoding with metric learning using triplet similarity embedding [4, 6] or Joint Bayesian
embedding [21, 23].
In both cases, template
adaptation outperforms all methods, and when combined with metric learning or 2D alignment, generates nearly equivalent performance.

(bottom) Template adaptation compared with CNN encoding and 2D alignment [5, 4].

iﬁcation performance. For each point on this curve, we split
the dataset into templates that contained sizes within the
range shown. Then, we computed a ROC curve and report
the true match rate at a false alarm rate of 1e-3 and 1e-2, an
operating point on the veriﬁcation ROC curve. This result
shows that the rate of increase in performance is largest for
few media, and performance saturates at about 3 media per
template. Furthermore, as the number of media per tem-
plate increases, the veriﬁcation score at 1e-2 increases by
about 19% from one media per template to sixty four. This
also shows that the largest beneﬁt for template adaptation is
when there are at least three media per template.

4.6. Fusion Study

Figure 6 shows a study for comparing three alternatives
for fusion of classiﬁers. Recall from section 4.1 that a ﬁnal
similarity score is computed as a linear combination of the

classiﬁers trained for templates P and Q. In this section,
we study different strategies for setting this weighting.

In general, the template classiﬁer fusion from section
3 is a linear combination of SVM functional margins,
s(P, Q) = αP (q) + (1 − α)Q(p). We explore strategies
based on winner take all (α ∈ {0, 1}), template weighted
fusion (α = |P|/(|P| + |Q|) and an experiment using the
SVM geometric margin (e.g. P (x) = wT x/|w|), as sug-
gested in [29]. The default strategy is average fusion such
that α = 0.5. Results show that the strategy of comput-
ing a weighted average with α = 0.5 of probe and gallery
templates is the best strategy. We also performed a hyper-
parameter search over α, which conﬁrmed this selection.

Finally, we also note that we ran experiments computing
average media encodings, computing the margins for each
encoding, then averaging the margins. This strategy per-
formed consistently worse than computing average feature

8

Figure 5. Template size analysis. (left) Similarity score increases as a function of maximum number of media, where the standard deviation
is largest when template size is one. (right) True match rate as a function of maximum number of unique images or videos in a template
pair, which shows that veriﬁcation performance levels off at a maximum of three unique media per template.

encodings.

4.7. Error Analysis

Finally, we visualized identiﬁcation and veriﬁcation er-
rors in different performance domains, in order to gain in-
sight into template-based facial recognition. This analysis
provides a better understanding of the error modes to bet-
ter inform future template-based facial recognition. More
detailed ﬁgures and additional discussion, including identi-
ﬁcation analysis, are available in supplemental material.

Figure 7 shows four columns of veriﬁcation probe and
gallery pairs for: the best scoring mated pairs; worst scor-
ing mated pairs; best scoring non-mated pairs; and worst
scoring non-mated pairs. After computing the similarity for
all pairs of probe and gallery templates, we sort the resulting
list. Each row represents a probe and gallery template pair.
The templates contain from one to dozens of media. Up to
eight individual media are shown with the last space show-
ing a mosaic of the remaining media in the template. Be-
tween the templates are the IJB-A Template IDs for probe
and gallery as well as the best mated and best non-mated
scores.

Figure 7 (far left) shows the highest mated similarities.
In the thirty highest scoring correct matches, we immedi-
ately note that every gallery template contains dozens of
media. The probe templates either contain dozens of media
or one media that matches well. Figure 7 (center left) shows
the lowest mated template pairs, representing failed identi-
ﬁcation. The thirty lowest mated similarities result from
single-media probe templates that are low contrast, low res-
olution, extremely non-frontal, or not oriented upwards.

Figure 7 (center right) showing the worst non-mated

pairs highlights very understandable errors involving
single-media probe templates representing impostors in
challenging orientations. Figure 7 (far right) showing the
best non-mated similarities shows the most certain non-
mates, again often involving large templates.

5. Conclusions

In this paper, we have introduced template adaptation,
a simple and surprisingly effective strategy for face veriﬁ-
cation and identiﬁcation that achieves state of the art per-
formance on the IJB-A dataset. Furthermore, we showed
that this strategy can be applied to existing networks to im-
prove performance. Futhermore, our evaluation provides
compelling evidence that there are many face recognition
tasks that can beneﬁt from a historical record of media to
aid in matching, and that this is an important problem to
further evaluate with new template-based face datasets.

Our analysis shows that performance is highly dependent
on the number of media available in a template. This strat-
egy results in performance that results in 19% decrease in
veriﬁcation scores when a template contains a single media,
such as comparing image to image or video to video, as in
LFW or YouTubeFaces style evaluations. However, when
probe or gallery templates are rich and at least one template
contains greater than three media, performance quickly sat-
urates and dominates the state of the art.

Finally, it remains to be seen if the conclusions hold for
other datasets. The IJB-A dataset is currently the only pub-
lic dataset with a template based evaluation protocol, and it
may be that our performance claims are due to dataset bias,
even though the composition of this dataset was engineered
to avoid systemic bias [3]. Finally, the gallery size for this

9

Figure 6. Classiﬁer fusion study. We compare strategies for linear weighted fusion of classiﬁers, and results show that an average fusion
used by the default template adaptation is best.

dataset is limited to 500 subjects, and it remains to be seen
if the performance claims scale as the number of subjects
increase.
Acknowledgment. This research is based upon work sup-
ported by the Ofﬁce of the Director of National Intelligence
(ODNI), Intelligence Advanced Research Projects Activity
(IARPA) under contract number 2014-14071600010. The
views and conclusions contained herein are those of the
authors and should not be interpreted as necessarily rep-
resenting the ofﬁcial policies or endorsements, either ex-
pressed or implied, of ODNI, IARPA, or the U.S. Govern-
ment. The U.S. Government is authorized to reproduce and
distribute reprints for Governmental purpose notwithstand-
ing any copyright annotation thereon.

References

[1] Huang, G., Ramesh, M., Berg, T., Learned-Miller, E.: La-
beled faces in the wild: A database for studying face recog-
nition in unconstrained environments. In: University of Mas-
sachusetts, Amherst, Technical Report 07-49. (2007) 1, 2

[2] Wolf, L., Hassner, T., Maoz, I.: Face recognition in un-
constrained videos with matched background similarity. In:
CVPR. (2011) 1, 2

[3] Klare, B., Klein, B., Taborsky, E., Blanton, A., Cheney, J.,
Allen, K., Grother, P., Mah, A., Jain, A.: Pushing the fron-
tiers of unconstrained face detection and recognition: IARPA
Janus benchmark A. In: CVPR. (2015) 1, 2, 5, 6, 10

[4] Parkhi, O., Vedaldi, A., Zisserman, A.: Deep face recogni-

tion. In: BMVC. (2015) 1, 2, 4, 5, 6, 8

[5] Taigman, Y., Yang, M., Ranzato, M., Wolf, L.: DeepFace:
Closing the gap to human-level performance in face veriﬁca-
tion. In: CVPR. (2014) 1, 2, 6, 8

[6] Schroff, F., Kalenichenko, D., Philbin, J.:

uniﬁed embedding for face recognition and clustering.
CVPR. (2015) 1, 2, 5, 6, 8

FaceNet: A
In:

[7] Y. Taigman, M. Yang, M.R., Wolf, L.: Web-scale training

for face identiﬁcation. In: CVPR. (2015) 1, 2
[8] Sun, Y., Liang, D., Wang, X., Tang., X.:

Face recognition with very deep neural networks.
arXiv:1502.00873. (2014) 1, 2

DeepID3:
In:

[9] Sun, Y., Wang, X., Tang., X.: Deeply learned face represen-
tations are sparse, selective, and robust. In: CVPR. (2015)
1, 2

[10] Learned-Miller, E., Huang, G., RoyChowdhury, A., Li, H.,
Hua, G.:
In:
Advances in Face Detection and Facial Image Analysis.
Springer (2015) 1

Labeled Faces in the Wild: A Survey.

[11] Lu, C., Tang, X.: Surpassing human-level face veriﬁcation
performance on LFW with GaussianFace. In: AAAI. (2015)
1

[12] Best-Rowden, L., Han, H., Otto, C., Klare, B., Jain, A.K.:
Unconstrained face recognition: Identifying a person of in-
terest from a media collection. IEEE Transactions on Infor-
mation Forensics and Security 9(12) (2014) 2144–2157 1

[13] Phillips, J., Hill, M., Swindle, J., O’Toole, A.: Human and
algorithm performance on the pasc face recognition chal-
lenge. In: BTAS. (2015) 1

[14] Grother, P., Ngan, M.: Face recognition vendor test (frvt):
Performance of face identiﬁcation algorithms. In: NIST In-
teragency Report 8009. (2014) 2, 6

[15] Sankaranarayanan, S., Alavi, A., Chellappa, R.: Triplet simi-
larity embedding for face veriﬁcation. In: arXiv:1602.03418.
(2016) 2, 5, 6

[16] J. Chen, V.P., Chellappa, R.: Unconstrained face veriﬁcation

using deep CNN features. In: WACV. (2016) 2, 5, 6

10

Figure 7. Veriﬁcation error analysis. (far left, blue) The best mated veriﬁcation template pairs, (center left, blue) The worst mated veriﬁca-
tion template pairs, (center right, green) The worst non-mated veriﬁcation template pairs (far right, green) The best non-mated veriﬁcation
template pairs.

[17] AbdAlmageed, W., Wu, Y., Rawls, S., Harel, S., Hassner, T.,
Masi, I., Choi, J., Lekust, J., Kim, J., Natarajan, P., Nevatia,
R., Medioni, G.: Face recognition using deep multi-pose
representations. In: WACV. (2016) 2, 5, 6

[18] RoyChowdry, A., Lin, T., Maji, S., Learned-Miller, E.: One-
to-many face recognition with bilinear CNNs. In: WACV.
(2016) 2, 5, 6

[19] Simonyan, K., Zisserman, A.: Very deep convolutional net-
works for large-scale image recognition. In: ICLR. (2015)
2

[20] Szegedy, C., Liu, W., Jia, Y., Sermanet, P., Reed, S.,
Anguelov, D., Erhan, D., Vanhoucke, V., Rabinovich, A.:
Going deeper with convolutions. In: CVPR. (2015) 2

[21] Chen, D., Cao, X., Wang, L., Wen, F., Sun, J.: Bayesian face

revisited: A joint formulation. In: ECCV. (2012) 2, 8

[22] Hu, G., Yang, Y., Yi, D., Kittler, J., Christmas, W., Li, S.Z.,
Hospedales, T.: When face recognition meets with deep
learning: an evaluation of convolutional neural networks for
face recognition. In: ICCV workshop on ChaLearn Looking
at People. (2015) 2

[23] Chen, J., Ranjan, R., Kumar, A., Chen, C., Patel, V., Chel-
lappa, R.: An end-to-end system for unconstrained face ver-
iﬁcation with deep convolutional neural networks. In: ICCV
workshop on ChaLearn Looking at People. (2015) 2, 8

[25] Razavian, A.S., Azizpour, H., Sullivan, J., Carlsson, S.: Cnn
features off-the-shelf: An astounding baseline for recogni-
tion. In: CVPR Workshop on DeepVision. (2014) 3

[26] Tang, Y.: Deep learning with linear support vector machines.
In: ICML Workshop on Representational Learning. (2013) 3

[27] Huang, F., LeCun, Y.: Large-scale learning with svm and
convolutional for generic object categorization. In: CVPR.
(2006) 3

[28] Malisiewicz, T., Gupta, A., Efros, A.:

Ensemble of
exemplar-svms for object detection and beyond. In: ICCV.
(2011) 3, 6

[29] Kobayashi, T.: Three viewpoints toward exemplar svm. In:

CVPR. (2015) 3, 8

[30] Wolf, L., Hassner, T., Taigman, Y.: The one-shot similarity

kernel. In: ICCV. (2009) 3

[31] Wolf, L., Hassner, T., Taigman, Y.:

Effective uncon-
strained face recognition by combining multiple descriptors
and learned background statistics. PAMI 33(10) (2011) 3

[32] Wang, D., Otto, C., Jain, A.: Face search at scale: 80 million

gallery. In: arXiv:1507.07242. (2015) 5, 6

[33] Parkhi, O.M., Simonyan, K., Vedaldi, A., Zisserman, A.: A
compact and discriminative face track descriptor. In: CVPR.
(2014) 4, 5

[24] Pan, S.J., Yang, Q.: A survey on transfer learning. Knowl-
edge and Data Engineering, IEEE Transactions on 22(10)
(2010) 1345–1359 2

[34] Fan, R., Chang, K., Hsieh, C., Wang, X., Lin, C.: Liblinear:
A library for large linear classiﬁcation. Journal of Machine
Learning Research 9 (2008) 1871–1874 4

11

[35] Wan, L., Zeiler, M., Zhang, S., LeCun, Y., Fergus, R.: Reg-
ularization of neural network using dropconnect. In: ICML.
(2013) 5

[36] Zinkevich, M., et al: Parallelized stochastic gradient descent.

In: NIPS. (2011) 5

[37] Kazemi, V., Sullivan, J.: One millisecond face alignment

with an ensemble of regression trees. In: CVPR. (2014) 5

[38] Yi, D., Lei, Z., Liao, S., Li, S.: Learning face representation

from scratch. In: arXiv:1411.7923. (2014) 6

12

