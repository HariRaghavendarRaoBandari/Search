6
1
0
2

 
r
a

M
6

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
8
2
8
1
0

.

3
0
6
1
:
v
i
X
r
a

Counting rational points of an algebraic

variety over ﬁnite ﬁelds ∗

Shuangnian Hua,b, Shaofang Honga and Xiaoer Qinc

a Mathematical College, Sichuan University, Chengdu 610064, P.R. China
b School of Mathematics and Statistics, Nanyang Institute of Technology,

c College of Mathematics and Statistics, Yangtze Normal University,

Nanyang 473004, P.R. China

Chongqing 408100, P.R. China

E-mails: hushuangnian@163.com (S. Hu); sfhong@scu.edu.cn,

s-f.hong@tom.com, hongsf02@yahoo.com (S. Hong); qincn328@sina.com (X. Qin)

Abstract. Let Fq denote the ﬁnite ﬁeld of odd characteristic p with q
elements (q = pn, n ∈ N) and F∗
In
this paper, by using the Smith normal form we give an explicit formula for
the number of rational points of the algebraic variety deﬁned by the following
system of equations over Fq:

q represent the nonzero elements of Fq.



(1)
i1

e
i=1 a1ix
1
e(2)
j1
j=1 a2j x
1

...x

e
...x

Pr1
Pr3

(1)
i1

e
i=r1+1 a1ix
1
e(2)
j1
j=r3+1 a2j x
1

...x

e(1)
i,n2
n2 − b1 = 0,
(2)
e
j,n4
n4 − b2 = 0,
...x

(2)
j,n3

e(1)
i,n1

n1 +Pr2
n3 +Pr4

where the integers 1 ≤ r1 < r2, 1 ≤ r3 < r4, 1 ≤ n1 < n2, 1 ≤ n3 < n4, n1 ≤ n3,
b1, b2 ∈ Fq, a1i ∈ F∗
q(1 ≤ j ≤ r4) and the exponent of
each variable is positive integer. An example is also presented to demonstrate
the validity of the main result.

q(1 ≤ i ≤ r2), a2j ∈ F∗

Keywords and phrases: Finite ﬁeld, algebraic variety, rational point, Smith

normal form, exponent matrix.

AMS Subject Classiﬁcation: 11T06, 11T71

1 Introduction

Let Fq denote the ﬁnite ﬁeld of q elements with odd characteristic p (q = pn, n ∈
N (the set of positive integers)) and F∗
q = Fq \ {0}. Let m be a positive integer,
fi(x1, ..., xn)(i = 1, ...m) be some polynomial with n variables over Fq and V

∗S. Hong is the corresponding author and was supported partially by National Science
Foundation of China Grant #11371260. X. Qin was supported partially by the Science and
Technology Research Projects of Chongqing Education Committee Grant #KJ15012004.

1

f1(x1, ..., xn) = 0,

......

fm(x1, ..., xn) = 0.



By Nq(V ) we denote the number of Fq-rational points on the algebraic variety
V in Fn

q . That is,

Nq(V ) := #{(x1, ..., xn) ∈ Fn

q |fi(x1, ..., xn) = 0, i = 1, ..., m}.

Particularly, if m = 1, then we use Nq(f ) to stand for Nq(V ).

Studying the exact value of Nq(V ) is one of the main topics in ﬁnite ﬁelds.
The degrees deg(fi) play an important role in the estimate of Nq(V ). Let ⌈x⌉
denote the least integer ≥ x and ordq denote the additive valuation such that
ordqq = 1.
In 1964, Ax [3] generalized the Chevalley-Warning theroem by
showing that

denote the algebraic variety deﬁned by the following system of equations over
Fq:

ordqNq(V ) ≥l n −Pm
Pm

i=1 degfi

i=1 degfi

m.

Later on, further works were done by Katz [20], Adolphson-Sperber [1]-[2],
Moreno-Moreno [22] and Wan [29]-[31].

It is diﬃcult to give an explicit formula for Nq(V ) in general. Finding explicit
formula for Nq(f ) under certain conditions has attracted many authors for many
years (see, for instance, [18] et al). It is well known that there exists an explicit
formula for Nq(f ) with deg(f ) ≤ 2 in Fq (see, for example, [19] and [21]). One
ﬁrst considered the diagonal hypersurface:

a1xe1

1 + ... + anxen

n − b = 0, 1 ≤ i ≤ n, ai ∈ F∗

q , b ∈ Fq, ei > 0,

(1.1)

and much work has been done to seek for the number of rational points of the hy-
persurface (1.1)(see, for instance, [26] and [34]-[35]). Carlitz [6], Cohen [12] and
Hodges [13] counted the rational points on the following k-linear hypersurface

a1x11...x1k + a2x21...x2k + ... + anxn1...xnk − b = 0,

(1.2)

with ai ∈ F∗
rational points on the following more general diagonal hypersurface

q(1 ≤ i ≤ n), b ∈ Fq. Cao [9], Cao and Sun [10] [11] studied the

a1xe11

11 ...x

e1n1
1n1 + a2xe21

21 ...x

e2n2
2n2 + ... + arxer1

r1 ...x

ernr
rnr = 0,

with 1 ≤ i ≤ r, 1 ≤ j ≤ ni, eij ∈ N, ai ∈ F∗
q. Clearly, this extends (1.1) and
(1.2) when b = 0. On the other hand, Baoulina [4] [5], Pan, Zhao and Cao [23]
considered the hypersurface of the form (a1xm1
n = 0
which extended the results of Carlitz in [7] and [8].

1 + ... + anxmn

n )λ − bxk1

1 ...xkn

1 ...xe1n

If f = a1xe11

q for
1 ≤ i ≤ s and 1 ≤ j ≤ n, b ∈ Fq, then a formula for Nq(f ) was given by Sun
[27]. Moreover, if s = n and gcd(det(eij ), q − 1) = 1 (det(eij) represents the

n − b with eij > 0 and ai ∈ F∗

n + ... + asxes1

1 ...xesn

2

determinant of the n × n matrix(cid:0)eij(cid:1), then Sun [27] gave the explicit formula

for the number of rational points as follows:

N (f ) =( qn − (q − 1)n + (q−1)n+(−1)n(q−1)

(q−1)n−(−1)n

q

q

,

,

if b = 0,
if b 6= 0.

Wang and Sun [32] gave the formula for the number of rational points of the
following hypersurface

a1xe11

1 + a2xe11

1 xe22

2 + ... + anxen1

1 xen2

2

...xenn

n − b = 0,

with eij ≥ 0, ai ∈ F∗
q, b ∈ Fq. In 2005, Wang and Sun [33] extended the results
of [27] and [32]. Recently, Hu, Hong and Zhao [16] generalized Wang and Sun’s
results. In fact, they used the Smith normal form to present a formula for Nq(f )
with f being given by:

f =

t−1Xj=0

rj+1−rjXi=1

erj +i,1
arj +ix
1

...x

erj +i,nj+1
nj+1

− b,

(1.3)

where the integers t > 0, r0 = 0 < r1 < r2 < ... < rt, 1 ≤ n1 < n2 < ... < nt,
b ∈ Fq, ai ∈ F∗
q (1 ≤ i ≤ rt) and the exponents eij of each variable are positive
integers. On the other hand, Yang [36] followed Sun’s method and gave a
formula for the rational points Nq(V ) on the following algebraic variety V over
Fq:

e(1)
11
a11x
1

...x

e(1)
e(1)
n + ... + a1sx
1n
s1
1

...x

e(1)
n − b1 = 0,
sn

(m)
11

e
am1x
1

(m)
1n

e
e
n + ... + amsx
...x
1

(m)
s1

......

...x

e(m)
n − bm = 0.
sn

Song and Chen [25] continued to make use of Sun’s method and obtained a
formula for Nq(V ) with V being the algebraic variety over Fq deﬁned by:





(1)
j1

e
a1j x
1

s1Xj=1

e(m)
j1
amj x
1

e(m)
j,n1
n1 +

...x

s1Xj=1

s2Xj=s1+1
s2Xj=s1+1

e(1)
j,n1
n1 +

...x

(1)
j1

e
a1j x
1

e(1)
j,n2
n2 − b1 = 0,

...x

......

e(m)
j,n2
n2 − bm = 0.

...x

e(m)
j1
amj x
1

Meanwhile, they proposed an interesting question which was recently answerd
by Hu and Hong [15]. A more general question was suggested by Hu, Hong and
Zhao in [16] that can be stated as follows.

Problem 1.1.

[16] Let m ≥ 1 be an integer and t1, ..., tm be positive
integers. Find an explicit formula for the number of rational points on the
following algebraic variety over Fq:

tk−1Xj=0

rk,j+1−rkjXi=1

e(k)
rkj +i,1

arkj +ix
1

e(k)
rkj +i,nk,j+1
nk,j+1

...x

− bk = 0, k = 1, ..., m,

3

with 0 = rk0 < rk1 < rk2 < ... < rk,tk , 1 ≤ nk1 < nk2 < ... < nk,tk and
e(k)
rkj+i,j > 0 being integers, bk ∈ Fq, arkj +i ∈ F∗
q for 1 ≤ k ≤ m, 1 ≤ i ≤ rk,tk
and 1 ≤ j ≤ tk.

If m = 1, then the main result in [16] answers Problem 1.1. But it is kept
open when m ≥ 2. Clearly, Yang [36], Song and Chen [25] and Hu and Hong
[15] gave a partial answer to Problem 1.1 when m ≥ 2.

In what follows, we always let ri, ni(i = 1, ..., 4) be positive integers such
that 1 ≤ r1 < r2, 1 ≤ r3 < r4, 1 ≤ n1 < n2, 1 ≤ n3 < n4, n1 ≤ n3, b1, b2 ∈ Fq,
a1i ∈ F∗
q(1 ≤ j ≤ r4). Let n = max{n2, n4}, k = 1, 2
and fk(x) := fk(x1, ..., xn) ∈ Fq[x1, ..., xn] be deﬁned by

q(1 ≤ i ≤ r2) and a2j ∈ F∗

f1(x) := f1(x1, ..., xn) =

and

f2(x) := f2(x1, ..., xn) =

a1ixE

(1)

i − b1

r2Xi=1
r4Xj=1

a2jxE

(2)

j − b2.

(1.3)

with E(1)
integer components of dimension n deﬁned as follows:

(1 ≤ i ≤ r2) and E(2)

j

i

(1 ≤ j ≤ r4) being the vectors of non-negative

E(1)
1 = (e(1)
............

11 , ..., e(1)
1n1

, 0, ..., 0), xE

e(1)
(1)
1 = x
11
1

(1)
1n1

e
...x
n1

,

r1 = (e(1)
E(1)
E(1)
r1+1 = (e(1)
............

r1,n1

r1,1, ..., e(1)
r1+1,1, ..., e(1)

, 0, ..., 0), xE(1)

e
r1 = x
1

(1)
r1 ,1

e(1)
r1 ,n1
n1

...x

,

, 0, ..., 0), xE

e(1)
(1)
r1 +1,1
r1+1 = x
1

e(1)
r1 +1,n2
n2

...x

,

r1+1,n2

r2,n2

r2 = (e(1)
E(1)
1 = (e(2)
E(2)
............

r2,1, ..., e(1)
11 , ..., e(2)

1n3

, 0, ..., 0), xE(1)

e(1)
r2 ,1
r2 = x
1

e(1)
r2 ,n2
n2

...x

,

, 0, ..., 0), xE(2)

e
1 = x
1

(2)
11

e(2)
1n3
n3

...x

,

r3 = (e(2)
E(2)
E(2)
r3+1 = (e(2)
............

r3,n3

r3,1, ..., e(2)
r3+1,1, ..., e(2)

, 0, ..., 0), xE(2)

e(2)
r3 ,1
r3 = x
1

e(2)
r3 ,n3
n3

...x

,

, 0, ..., 0), xE(2)

e
r3+1 = x
1

(2)
r3 +1,1

(2)
r3 +1,n4

e
...x
n4

,

r3+1,n4

r4 = (e(2)
E(2)

r4,1, ..., e(2)

r4,n4

, 0, ..., 0), xE(2)

e
r4 = x
1

(2)
r4 ,1

e(2)
r4 ,n4
n4

...x

.



Then a special case of Problem 1.1 is the following question.

Problem 1.2. Let f1(x) and f2(x) be given as in (1.3). What is the formula
for the number of rational points on the algebraic variety deﬁned by the following
system of equations over Fq:

4

( f1(x) = 0,

f2(x) = 0?

(1.4)

When n1 = n3 and n2 = n4, this question was answered by Song and Chen
[25]. However, if n1 6= n3 or n2 6= n4, then Problem 1.2 has not been solved yet.
In this paper, our main goal is to investigate Problem 1.2. We will follow
and develop the method of [16] to study Problem 1.2. To state the main result,
we ﬁrst need to introduce some related concept and notation. Throughout this
paper, we let

E11 :=
E21 :=

1

E(1)
...
E(1)
r1

1

E(2)
...
E(2)
r3

r1×m
r3×m

, E12 :=
and E22 :=

r1+1

E(1)
...
E(1)
r2

r3+1

E(2)
...
E(2)
r4

,

(r2−r1)×m
(r4−r3)×m

.

For any integer l with 1 ≤ l ≤ 4, we let E(nl) denote the remaining of the
exponent matrix of (1.4) which deletes the items containing the variable xnl+1.
In fact, one has

E11
E21
E22

E(n1) := E11 if n1 < n3, and (cid:18) E11
E21 (cid:19) if n3 < n2, and 
E(n3) :=(cid:18) E11
 if n4 < n2, and 
E(n4) :=
 if n2 < n4, and 
E(n2) :=
E(n2) :=(cid:18) E11
E12 (cid:19) .

E11
E12
E21

E11
E12
E21

E21 (cid:19) if n1 = n3,
 otherwise,
 otherwise.
 otherwise,

E11
E12
E21
E22

E11
E12
E21
E22

If n3 ≤ n2, then

and if n3 > n2, then

5

Then the Smith normal form (see [24], [17] or Section 2 below) guarantees the
existences of unimodular matrices U (nl) and V (nl) such that

U (nl)E(nl)V (nl) =(cid:18) D(nl)

0

0

0 (cid:19) ,

1 , ..., d(l)
1 , ..., d(l)
where D(nl) := diag(d(l)
sl being
positive integers such that d(l)
q to be a ﬁxed
primitive element of Fq. For any β ∈ F∗
q, there exists exactly an integer r ∈
[1, q − 1] such that β = αr. Such an integer r is called index of β with respect
to the primitive element α, and is denoted by indα(β) := r.

sl ) with all the diagonal elements d(l)
1 |...|d(l)
sl . Throughout, pick α ∈ F∗

For l = 1, ..., 4, we let SE(nl) denote the system (1.4) which deletes the items
containing the variable xnl+1. Clearly the exponent matrix of SE(nl) is E(nl).
For example, if l = 1 and n1 < n3, then SE(n1) becomes the following system
of equations over Fq:

(1)
i1

e
a1ix
1

e(1)
i,n1
n1 − b1 = 0,

...x

r1Xi=1

b2 = 0,



where a1i, b1, b2 and e(1)

ij are given in (1.4) for all integers i and j with 1 ≤ i ≤ r1

(1)
e(1)
e
i,n1
n1 = u1i for any integer i with 1 ≤ i ≤ r1. If
and 1 ≤ j ≤ n1. Let x
i1
...x
1
b2 6= 0, then it is obvious that SE(n1) has no solution. If b2 = 0, then SE(n1)
becomes

a1iu1i − b1 = 0.

(SE

(n1)

)

r1Xi=1

Lemma 2.4 tells us the formula for the number of the solution (u11, ..., u1r1) ∈
(F∗
). Now we use H1 to denote the number of the solutions
(u11, ..., u1r1) ∈ (F∗
q)r1 of (SE

) under the following extra conditions:

q)r1 of (SE

(n1)

(n1)

(cid:26) gcd(q − 1, d(1)

)|h′
i
(q − 1)|h′
i

i

for i = 1, ..., s1,
for i = s1 + 1, ..., r1,

(n1)

)

(gSE

1, ..., h′

r1)T = U (n1)(indα(u11), ..., indα(u1r1))T . Similarly, for l = 2, 3, 4,
where (h′
we can get the system of equations SE(nl) and use Hl to denote the number
of the solutions of (SE
). One knows
that Hl (see [15]) is independent of the choice of the primitive element α. In
what follows, we let N stand for the number of rational points on the algebraic
variety deﬁned by (1.4).

) under the extra conditions (gSE

(nl)

(nl)

Now let

N0 := qmax{n2,n4}−n1(qn1 − (q − 1)n1 ) if b1 = b2 = 0, and 0 otherwise,

6

qmax{n2,n4}−min{n2,n3}(qmin{n2,n3}−n1 −(q − 1)min{n2,n3}−n1 )L1,

N1 :=

qmax{n2,n4}−min{n2,n4}(qmin{n2,n4}−n1 −(q − 1)min{n2,n4}−n1 )L1,

if n1 < n3 and b2 = 0,

if n1 = n3 and b2 = 0,

0, otherwise,


N3 :=

N2 := qmax{n2,n4}−min{n2,n4}(qmin{n2,n4}−n3 − (q − 1)min{n2,n4}−n3)L3

if n3 < n2, and 0 otherwise,

(cid:0)qn4−n2 − (q − 1)n4−n2(cid:1)L2,
(cid:0)qn4−n3 − (q − 1)n4−n3(cid:1)L3,

if n1 ≤ n3 < n2 < n4,
if n3 ≥ n2,
0, otherwise,

N4 := L4 if n4 ≥ n2, and L2 otherwise, N5 := (cid:0)qn2−n4 − (q − 1)n2−n4(cid:1)L4 if

n2 > n4, and 0 otherwise, N6 := qn4−n3(qn3−n2 − (q − 1)n3−n2 )L2 if n3 > n2,
and b2 = 0, and 0 otherwise, where for 1 ≤ i ≤ 4,

Li := Hi(q − 1)ni−si

gcd(q − 1, d(i)

j ).

siYj=1

We can now state the main result of this paper which answers Problem 1.2

completely.

Theorem 1.3. Let N denote the number of rational points on the algebraic

variety (1.4). Then

N =



i6=1

i6=2

4Pi=0
4Pi=0
4Pi=0
4Pi=0
4Pi=0
5Pi=0
5Pi=0
6Pi=0

i6=3

i6=1,3

i6=2,5

i6=3

i6=1,3

Ni,

if n1 < n3 < n2 < n4,

Ni,

if n2 = n3,

Ni,

if n1 = n3, n2 < n4,

Ni,

if n1 < n3, n2 = n4,

Ni,

if n1 = n3, n2 = n4,

Ni,

if n1 < n3, n2 > n4,

Ni,

if n1 = n3, n2 > n4,

Ni,

if n3 > n2.

7

with Ni(0 ≤ i ≤ 6) being deﬁned as above.

We organize this paper as follows.

In Section 2, we present some useful
lemmas which will be needed later. In fact, we will ﬁrst recall some basic facts
on the Smith normal form of an integer matrix. Then we can use them to
give a formula for the number of the system of linear congruences with the
same modulo. Consequently, in Section 3, we ﬁrst show a key lemma and then
use it to prove Theorem 1.3.
In the ﬁnal section, we provide an example to
demonstrate the validity of Theorem 1.3.

Throughout this paper, gcd(a, m) will denote the greatest common divisor

of any positive integers a and m.

2 Preliminary lemmas

In this section, we present some useful lemmas that are needed in Section 3. We
ﬁrst recall two well-known deﬁnitions.

Deﬁnition 2.1. [17] Let M be a square integer matrix. If the determinant

of M is ±1, then M is called an unimodular matrix.

Deﬁnition 2.2. [17] For given any positive integers m and n, let P and Q
be two m × n integer matrices. Suppose that there are two modular matrices U
of order m and V of order n such that P = U QV . Then we say that P and Q
are equivalent and we write P ∼ Q.

Clearly equivalence has the three properties of being reﬂexive, symmetric

and transitive.

Lemma 2.1. [17] [24] Let P be a nonzero m × n integer matrix. Then P is

equivalent to a block matrix of the following form

(cid:18) D 0
0 (cid:19) ,

0

(2.1)

where D = diag(d1, ..., dr) with all the diagonal elements di being positive inte-
gers and satisfying that di|di+1 (1 ≤ i < r). In other words, there are unimod-
ular matrices U of order m and V of order n such that

U P V =(cid:18) diag(d1, ..., dr) 0
0 (cid:19) .

0

We call the diagonal matrix in (2.1) the Smith normal form of the matrix P .
Usually, one writes the Smith normal form of P as SNF(P ). The elements di
are unique up to multiplication by a unit and are called the elementary divisors,
invariants, or invariant factors.

For any system of linear congruences



j=1 h1j yj ≡ b1
............
j=1 hsj yj ≡ bs

Pn
Pn

(mod m),

(mod m),

8

(2.2)

let Y = (y1, ..., yn)T be the column of indeterminates y1, ..., yn, B = (b1, ..., bs)T
and H = (hij) be the matrix of its coeﬃcient. Then one can write (2.2) as

HY ≡ B (mod m).

(2.3)

By Lemma 2.1, there are unimodular matrices U of order s and V of order n
satisfying that

U HV = SNF(H) =(cid:18) diag(d1, ..., dr) 0
0 (cid:19) .

0

Finally, we present the following two known lemmas.
Lemma 2.2. [16] Let B′ = (b′

linear congruences is solvable if and only if gcd(m, di)|b′
1 ≤ i ≤ r and m|b′

s)T = U B. Then the system (2.3) of
i for all integers i with
i for all integers i with r + 1 ≤ i ≤ s. Further, the number of

1, ..., b′

solutions of (2.3) is equal to mn−rQr

Lemma 2.3. [27] Let c1, ..., ck ∈ F∗

number of rational points (x1, ..., xk) ∈ (F∗
ckxk = c. Then

i=1 gcd(m, di).

q and c ∈ Fq, and let N (c) denote the
q)k on the hypersurface c1x1 + ... +

N (c) =( (q−1)k+(−1)k(q−1)

(q−1)k−(−1)k

q

q

,

if c = 0,

, otherwise.

Lemma 2.4. Let cij ∈ F∗

q for all integers i and j with 1 ≤ i ≤ m and
1 ≤ j ≤ k and c1, ..., cm ∈ Fq. Let N (c1, ..., cm) denote the number of rational
points (x11, ..., x1k, ..., xm1, ..., xmk) ∈ (F∗

q)mk on the following variety



Then

c11x11 + ... + c1kx1k = c1,
......
cm1xm1 + ... + cmkxmk = cm.

(2.4)

N (c1, ..., cm) =

(q − 1)r

qm ((q − 1)k−1 + (−1)k)r((q − 1)k − (−1)k)m−r,

where r := #{1 ≤ i ≤ m|ci = 0}.

Proof. For 1 ≤ i ≤ m, let N (ci) denote the number of rational points
q)k on the hypersurface ci1xi1 + ... + cikxik = ci. Since for any
q)mk on the variety (2.4), the
q)k(1 ≤ i ≤ m) are independent,

(xi1, ..., xik) ∈ (F∗
rational points (x11, ..., x1k, ..., xm1, ..., xmk) ∈ (F∗
diﬀerent part of coordinates (xi1, ..., xik) ∈ (F∗
one has

N (c1, ..., cm) =

N (ci).

So Lemma 2.3 applied to N (ci) gives us the required result. Hence Lemma 2.4
is proved.
✷

mYi=1

9

3 Proof of Theorem 1.3

In this section, we show Theorem 1.3. First, we provide some notation and two
lemmas. For any given (u11, ..., u1r2 , ..., u21, ..., u2r4) ∈ Fr2+r4

, we use

q

N (xE(1)

i = u1i(i = 1, 2, ..., r2), xE

(2)

j = u2j(j = 1, 2, ..., r4).)

to denote the number of rational points (x1, ..., xmax{n2,n4}) ∈ F
the following algebraic variety over Fq:

max{n2,n4}
q

of

1 = u11,

(1)

xE
............
xE(1)
xE(2)
............
xE(2)

r2 = u1r2 ,

1 = u21,

r4 = u2r4 .



(3.1)

It follows that

N =

X

(u11,...,u1r2 ,u21,...,u2r4 )∈Fr2+r4
a11u11+...+a1r2 u1r2 =b1,
a21u21+...+a2r4 u2r4 =b2.

q

N(cid:16)

,

xE(1)
xE(2)

i = u1i(i = 1, 2, ..., r2),

j = u2j(j = 1, 2, ..., r4).(cid:17).

Deﬁne

T := {(u11, ..., u1r2 , u21, ..., u2r4) ∈ Fr2+r4

q

: a11u11+...+a1r2 u1r2 =b1,
a21u21+...+a2r4 u2r4 =b2.},

with b1, b2, a1i (1 6 i 6 r2) and a2j(1 6 j 6 r4) being given as in (1.4). Then

N =

X

(u11,...,u1r2 ,u21,...,u2r4 )∈T

xE

xE

(1)

i = u1i(i = 1, 2, ..., r2),

j = u2j(j = 1, 2, ..., r4).(cid:17).

(2)

(3.2)

Let (u11, ..., u1r2, u21, ..., u2r4) ∈ T . We consider the algebraic variety of (3.1).
For integer i, j with 1 ≤ i < r2 and 1 ≤ j < r4, one can easily deduce that

N(cid:16)

u1,i+1 = 0 if u1i = 0, and u2,j+1 = 0 if u2j = 0.

(3.3)

Deﬁne

V1 := {(u11, ..., u1r1 , 0, ..., 0) ∈ Fr2+r4

q

: u1i ∈ F∗

q, 1 ≤ i ≤ r1},

V2 := {(u11, ..., u1r1 , 0, ..., 0

, u21, ..., u2r3 , 0, ..., 0) ∈ Fr2+r4

q

: u1i, u2j ∈ F∗

q , 1 ≤ i ≤ r1, 1 ≤ j ≤ r3},

r2−r1

| {z }

10

V3 := {(u11, ..., u1r2 , u21, ..., u2r3 , 0, ..., 0) ∈ Fr2+r4
V4 := {(u11, ..., u1r2 , u21, ..., u2r4) ∈ Fr2+r4
V5 := {(u11, ..., u1r1 , 0, ..., 0, u21, ..., u2r4) ∈ Fr2+r4
and

q

q

q

: u1i, u2j ∈ F∗

q , 1 ≤ i ≤ r2, 1 ≤ j ≤ r3},

: u1i, u2j ∈ F∗

q , 1 ≤ i ≤ r2, 1 ≤ j ≤ r4},

: u1i, u2j ∈ F∗

q , 1 ≤ i ≤ r1, 1 ≤ j ≤ r4},

V6 := {(u11, ..., u1r2 , 0, ..., 0) ∈ Fr2+r4

q

: u1i ∈ F∗

q, 1 ≤ i ≤ r2}.

Let T (V0) consist of zero vector of dimension r2 + r4 and T (Vi) (0 ≤ i ≤ 6)
denote the set of the vectors v such that v ∈ T and v ∈ Vi. For any integer i
with 0 ≤ i ≤ 6, deﬁne

Mi :=

X

(u11,...,u1r2 ,u21,...,u2r4 )∈T (Vi)

xE

xE

(1)

i = u1i(i = 1, 2, ..., r2),

j = u2j(j = 1, 2, ..., r4).(cid:17).

(2)

(3.4)

N(cid:16)

Then we have the following key lemma.

Lemma 3.1. One has that Mi = Ni f or all 0 ≤ i ≤ 6.
Proof. First we show that M0 = N0. For any given integer i with i = 1, 2, if

there exists bi 6= 0, then the algebraic variety

(cid:26) a11u11 + ... + a1r2 u1r2 − b1 = 0,

a21u21 + ... + a2r4 u2r4 − b2 = 0,

has no zero solutions (u11, ..., u1r2 , u21, ..., u2r4) ∈ Fr2+r4
. So T (V0) is empty. It
follows that M0 = 0 = N0. If b1 = b2 = 0, then T (V0) consists of zero vector of
dimension r2 + r4. Then

q

M0 = N(cid:16)

= N (xE

xE

(1)

xE

(1)

i = u1i(i = 1, ..., r2)

j = u2j(j = 1, ..., r4)(cid:17)

(2)

1 = 0) (since n1 ≤ n3)

e(1)
= N (x
11
1

(1)
e
1n1
n1 = 0)
...x

= qmax{n2,n4}−n1

n1Xj=1(cid:18)n1

j(cid:19)(q − 1)n1−j

= qmax{n2,n4}−n1(qn1 − (q − 1)n1 ) = N0.

This completes the proof of the ﬁrst part of the Lemma 3.1.

We can now turn our attention to prove that M1 = N1. First we we consider
the case n1 < n3 < n2. Since n1 < n3, it follows from (3.4) and the deﬁnition
of T (V1) that

M1 =

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1 and 0=b2.

q )r1 ,

N(cid:16)

11

xE(1)

i = u1i, 1 ≤ i ≤ r1,

(1)

xE
xE(2)

j = 0, r1 + 1 ≤ j ≤ r2,

k = 0, 1 ≤ k ≤ r4.

(cid:17). (3.5)

From (3.5), we deduce that if b2 6= 0, then M1 = 0 = N1. That is,

M1 = N1 if n1 < n3 < n2 and b2 6= 0.

Now we let b2 = 0. Notice that n3 < n2, then the deﬁnitions of xE(1)

j

k

tell us that the fact that xE(1)

xE(2)
1 ≤ k ≤ r4 is reduced to saying that xE(2)

j = 0 and xE(2)

and
k = 0 with r1 + 1 ≤ j ≤ r2,
1 = 0. It then follows from (3.5) that

M1 =

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1.

q )r1 ,

N(cid:16)xE(1)

i = u1i, 1 ≤ i ≤ r1 and xE(2)

1 = 0(cid:17). (3.6)

It is easy to see that xE(2)

e(1)
r1 ,1
and u1r1 = x
1
xn1+1...xn3 = 0. Then by (3.6), one gets that

e(1)
r1 ,n1
n1

...x

1 = 0 is equivalent to x1...xn3 = 0. Since u1r1 6= 0
, one has x1...xn1 6= 0. So xE(2)

1 = 0 is equivalent to

M1 =

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1.

q)r1 ,

N(cid:16)xE(1)

For any given (u11, ..., u1r1) ∈ (F∗

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0(cid:17). (3.7)
q)r1 withPr1

i=1 a1iu1i = b1, one has

(1)

N (xE

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0)
= #{(x1, ..., xmax{n2,n4}) ∈ (Fq)max{n2,n4} : xE

(1)

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0}.

Since each of the components xn3+1, ..., xmax{n2,n4} can run over the whole ﬁnite
ﬁeld Fq independently, it then follows that

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0)

(1)

N (xE
= qmax{n2,n4}−n3×
#{(x1, ..., xn3 ) ∈ (Fq)n3 : xE(1)

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0}.

(3.8)

Notice that the choice of (x1, ..., xn1 ) ∈ (F∗
i = u1i (i =
1, ..., r1) is independent of the choice of (xn1+1, ..., xn3 ) ∈ (Fq)n3−n1 satisfying
that xn1+1...xn3 = 0. We then derive that

q )n1 satisfying that xE(1)

#{(x1, ..., xn3 ) ∈ (Fq)n3 : xE(1)
q)n1 : xE(1)

=#{(x1, ..., xn1 ) ∈ (F∗

i = u1i, 1 ≤ i ≤ r1}×
#{(xn1+1, ..., xn3 ) ∈ (Fq)n3−n1 : xn1+1...xn3 = 0}.

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0}

On the other hand, we can easily compute that

#{(xn1+1, ..., xn3 ) ∈ (Fq)n3−n1 : xn1+1...xn3 = 0}

=

n3−n1Xi=1 (cid:18)n3 − n1

i

(cid:19)(q − 1)n3−n1−i = qn3−n1 − (q − 1)n3−n1 .

12

(3.9)

(3.10)

(3.11)

(3.12)

(3.13)

So by (3.8) to (3.10), one obtains that

(1)

i = u1i, 1 ≤ i ≤ r1 and xn1+1...xn3 = 0)

N (xE
= qmax{n2,n4}−n3(qn3−n1 − (q − 1)n3−n1)

× #{(x1, ..., xn1 ) ∈ (F∗
= qmax{n2,n4}−n3(qn3−n1 − (q − 1)n3−n1)N (xE(1)

i = u1i, 1 ≤ i ≤ r1}

q)n1 : xE

(1)

i = u1i, 1 ≤ i ≤ r1).

Then by (3.7) together with (3.11), we have

M1 =qmax{n2,n4}−n3 (qn3−n1 − (q − 1)n3−n1)×

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1.

q )r1 ,

N(cid:0)xE

(1)

i = u1i, 1 ≤ i ≤ r1(cid:1).

Now we treat with the sum

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1.

q )r1 ,

N(cid:0)xE

(1)

i = u1i, 1 ≤ i ≤ r1(cid:1).
q)r1 withPr1
i = u1i, 1 ≤ i ≤ r1(cid:1)

N(cid:0)xE(1)

For any given (u11, ..., u1r1) ∈ (F∗

i=1 a1iu1i = b1, one has that

equals the number of the solutions (x1, ..., xn1 ) ∈ (F∗
of equations:

q)n1 of the following system

e(1)
11
x
1

(1)
e
1n1
n1 = u11,
...x

............

(1)
r1 ,1

e
x
1

e(1)
r1 ,n1
n1

...x

= u1r1 .

(3.14)



Since u1i 6= 0 (1 ≤ i ≤ r1), we can deduce that the number of the solutions
(x1, ..., xn1 ) ∈ (F∗
q)n1 of (3.14) is equal to the number of nonnegative integral
solutions (indα(x1), ..., indα(xn1 )) ∈ Nn1 of the following system of congruences

e(1)
1i indα(xi) ≡ indα(u11)

(mod q − 1),

............

(3.15)

e(1)
r1,iindα(xi) ≡ indα(u1r1 )

(mod q − 1).

n1Xi=1
n1Xi=1



But Lemma 2.2 tells us that (3.15) has solutions (indα(x1), ..., indα(xn1 )) ∈ Nn1
) hold. Further, Lemma 2.2 gives us

(n1)

if and only if the extra conditions (gSE

13

the number of solutions (indα(x1), ..., indα(xn1 )) ∈ Nn1 of (3.15) which is equal
to

(q − 1)n1−s1

gcd(q − 1, d(1)

i

).

s1Yi=1

Hence

Since

N(cid:0)xE(1)

i = u1i, 1 ≤ i ≤ r1(cid:1) = (q − 1)n1−s1

H1 =

it then follows from (3.16) that

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1
and (gSE

) holds.

q )r1 ,

(n1 )

gcd(q − 1, d(1)

i

).

(3.16)

s1Yi=1

1,

X
X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1.

q )r1 ,

=

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1
and (gSE

) holds.

q )r1 ,

(n1)

N(cid:0)xE

(1)

i = u1i, 1 ≤ i ≤ r1(cid:1)

(q − 1)n1−s1

s1Yi=1

gcd(q − 1, d(1)

i

)

= (q − 1)n1−s1

gcd(q − 1, d(1)

i

)

s1Yi=1

X

(u11,...,u1r1 )∈(F∗
a11u11+...+a1r1 u1r1 =b1
and (gSE

) holds.

q )r1 ,

(n1 )

1

s1Yi=1

= H1(q − 1)n1−s1

gcd(q − 1, d(1)

i

).

(3.17)

Thus by (3.6), (3.12) and (3.17), we obtain that M1 = N1 if n1 < n3 < n2 and
b2 = 0.

By the same argument, one can deduce that either n3 > n2 or n1 = n3 we

have M1 = N1. This ends the second part of the Lemma 3.1.

Now we treat the third part of the Lemma 3.1. From (3.3) and the deﬁnition
of T (V2), we know that for any vector v ∈ T (V2) if and only if n3 < n2. Thus
by the deﬁnition of N2 and (3.4), we get that M2 = N2 = 0 if n3 ≥ n2.

Let n3 < n2.

If n1 < n3 < n2 < n4, it then follows from (3.4) and the

deﬁnition of T (V2) that

M2 =

X

(u11,...,u1r1 ,u21,...,u2r3 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r3 u2r3 =b2.

q )r1+r3 ,

N(cid:16)



14

xE(1)
xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r1,

j = 0, r1 + 1 ≤ j ≤ r2,

i = u2i, 1 ≤ i ≤ r3,

xE

(2)

k = 0, r3 + 1 ≤ k ≤ r4.

(cid:17). (3.18)

The deﬁnitions of xE
xE(2)
xE(1)

j = 0 and
k = 0 with r1 + 1 ≤ j ≤ r2, r3 + 1 ≤ k ≤ r4 is reduced to saying that
r1+1 = 0. It then follows from (3.18) that

tell us that the fact that xE

and xE(2)

k

(1)
j

(1)

M2 =

X

(u11,...,u1r1 ,u21,...,u2r3 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r3 u2r3 =b2.

q )r1+r3 ,

N(cid:16)

xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3,

xE

(1)

r1+1 = 0.

(cid:17). (3.19)

It is easy to see that xE(1)

r1+1 = 0 is equivalent to x1...xn2 = 0. Since n3 < n2,

e(2)
r3 ,1
u2r3 6= 0 and u2r3 = x
1
equivalent to xn3+1...xn2 = 0. Then by (3.19), one gets that

, one has x1...xn3 6= 0. So xE

e(2)
r3 ,n3
n3

...x

(1)

r1+1 = 0 is

For any given (u11, ..., u1r1 , u21, ..., u2r3) ∈ (F∗

i=1 a1iu1i = b1

j = u2j , 1 ≤ j ≤ r3,

i = u1i, 1 ≤ i ≤ r1,

xE(1)
xE(2)
xn3+1...xn2 = 0.

N(cid:16)
(cid:17) = #{(x1, ..., xn4 ) ∈ (Fq)n4 :

q)r1+r3 with Pr1

(cid:17).

(3.20)

i = u1i, 1 ≤ i ≤ r1,

xE(1)
xE(2)
xn3+1...xn2 = 0.

j = u2j , 1 ≤ j ≤ r3,

}.

X

(u11,...,u1r1 ,u21,...,u2r3 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r3 u2r3 =b2.

q )r1+r3 ,

M2 =

andPr3

j=1 a2j u2j = b2, one has

(1)

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3,

xE(1)
xE(2)
xn3+1...xn2 = 0.

N(cid:16)
N(cid:16)
= qn4−n2 × #{(x1, ..., xn2 ) ∈ (Fq)n2 :

xE
xE(2)
xn3+1...xn2 = 0.

j = u2j, 1 ≤ j ≤ r3,

i = u1i, 1 ≤ i ≤ r1,

(cid:17)

15

Since each of the components xn2+1, ..., xn4 can run over the whole ﬁnite ﬁeld
Fq independently, it then follows that

i = u1i, 1 ≤ i ≤ r1,

(1)

xE
xE(2)
xn3+1...xn2 = 0.

j = u2j, 1 ≤ j ≤ r3,

}.

(3.21)

Notice that the choice of (x1, ..., xn3 ) ∈ (F∗
(i = 1, ..., r1) and xE
j = u2j (j = 1, ..., r3) is independent of the choice of
(xn3+1, ..., xn2 ) ∈ (Fq)n2−n3 satisfying that xn3+1...xn2 = 0. We then derive

q)n3 satisfying that xE

i = u1i

(2)

(1)

that

xE(1)

(2)

#{(x1, ..., xn2 ) ∈ (Fq)n2 :
= #{(x1, ..., xn3 ) ∈ (Fq)n3 :

i = u1i, 1 ≤ i ≤ r1,

j = u2j , 1 ≤ j ≤ r3,

xE
xn3+1...xn2 = 0.

}

xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r1,

j = u2j , 1 ≤ j ≤ r3.

#{(xn3+1, ..., xn2 ) ∈ (Fq)n2−n3 : xn3+1...xn2 = 0.}.

}×

(3.22)

On the other hand, we can easily compute that

#{(xn3+1, ..., xn2 ) ∈ (Fq)n2−n3 : xn3+1...xn2 = 0} = qn2−n3 − (q − 1)n2−n3 .

(3.23)

So by (3.21) to (3.23), one obtains that

(1)

(2)

(cid:17)

xE

xE

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3,

= qn4−n2(qn2−n3 − (q − 1)n2−n3 )×

xE(1)
xE(2)
xn3+1...xn2 = 0.

N(cid:16)
#{(x1, ..., xn3 ) ∈ (Fq)n3 :
= qn4−n2(qn2−n3 − (q − 1)n2−n3 )N(cid:16)
N(cid:16)

(u11,...,u1r1 ,u21,...,u2r3 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r3 u2r3 =b2.

M2 = qn4−n2(qn2−n3 − (q − 1)n2−n3)×

X

q )r1+r3 ,

Then by (3.20) together with (3.24), we have

i = u1i, 1 ≤ i ≤ r1,

}

j = u2j, 1 ≤ j ≤ r3.

xE

xE

(1)

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3.(cid:17).

(2)

xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3.(cid:17).

Now the argument for (3.13) applied to the sum

X

(u11,...,u1r1 ,u21,...,u2r3 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r3 u2r3 =b2.

q )r1+r3 ,

gives us that

xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r1,

j = u2j, 1 ≤ j ≤ r3.(cid:17)

N(cid:16)

16

(3.24)

(3.25)

M2 = qn4−n2(qn2−n3 − (q − 1)n2−n3)H3(q − 1)n3−s3

gcd(q − 1, d(3)

i

) = N2.

s3Yi=1

This concludes the proof of the third part of the Lemma 3.1.
Next we prove the fourth part of Lemma 3.1. The deﬁnition of T (V3) together
with (3.3) give us that for any vector v ∈ T (V3) if and only if n1 ≤ n3 < n2 < n4
or n2 ≤ n3. Using the same argument of the third part of Lemma 3.1, one can
get that either n1 ≤ n3 < n2 < n4 or n2 ≤ n3, M3 = N3. For the other case,
one has M3 = N3 = 0.

Now we deal with the ﬁfth part of Lemma 3.1.

It follows (3.4) and the

deﬁnition of T (V4) that

M4 =

X

(u11,...,u1r2 ,u21,...,u2r4 )∈(F∗
a11u11+...+a1r1 u1r2 =b1,
a21u21+...+a2r3 u2r4 =b2.

q )r2+r4 ,

xE(1)
xE(2)

i = u1i, 1 ≤ i ≤ r2,

j = u2i, 1 ≤ i ≤ r4.(cid:17).

(3.26)

If n2 ≤ n4, the argument of (3.13) applied to (3.26) tells us that

N(cid:16)
s4Yj=1

M4 = H4(q − 1)n4−s4

gcd(q − 1, d(4)

j ) = N4.

Similarly, if n2 > n4, we can get that

M4 = H2(q − 1)n2−s2

gcd(q − 1, d(2)

j ) = N4.

s2Yj=1

Next we prove the sixth part of Lemma 3.1. The deﬁnition of T (V5) and
(3.3) give us that the vector v ∈ T (V5) if and only if n2 > n4. If n2 ≤ n4, by the
deﬁnition of M5, one can easily deduce that M5 = N5 = 0. Now we let n2 > n4.
It follows from (3.4) and the deﬁnition of T (V5) that

M5 =

X

(u11,...,u1r1 ,u21,...,u2r4 )∈(F∗
a11u11+...+a1r1 u1r1 =b1,
a21u21+...+a2r4 u2r4 =b2.

q )r1+r4 ,

i = u1i, 1 ≤ i ≤ r1,

j = 0, r1 + 1 ≤ j ≤ r2,

xE

(2)

k = u2k, 1 ≤ k ≤ r4.

(cid:17). (3.27)

xE(1)
xE(1)

N(cid:16)

Using the same argument of (3.19), we obtain that

M5 =(cid:0)qn2−n4 − (q − 1)n2−n4(cid:1)H4(q − 1)n4−s4

s4Yj=1

gcd(q − 1, d(4)

j ) = N5.

In the rest, we prove M6 = N6. From the deﬁnition of T (V6) and (3.3),
we konw that the vector v ∈ T (V6) if and only if n3 > n2. Thus one has

17

M6 = N6 = 0, if n3 ≤ n2. Now we let n3 > n2. Then (3.4) and the deﬁnition of
T (V6) tell us that

M6 =

X

(u11,...,u1r2 )∈(F∗
a11u11+...+a1r2 u1r2 =b1 and b2=0.

q )r2 ,

(1)

xE
xE(2)

i = u1i, 1 ≤ i ≤ r2,

j = 0, 1 ≤ j ≤ r4. (cid:17). (3.28)

N(cid:16)

Using the same argument of (3.5), we get that

qn4−n3(qn3−n2 − (q − 1)n3−n2 )H2(q − 1)n2−s2

gcd(q − 1, d(2)

j ),

s2Qj=1

if n3 > n2 and b2 = 0,

0, otherwise,

as desired. This completes the proof of the Lemma 3.1.

✷
We can now use Lemma 3.1 to prove Theorem 1.3 as the conclusion of this

Proof of Theorem 1.3. We divide the proof into the following eight cases.
Case 1. n1 < n3 < n2 < n4. From (3.3) we can obtain that if the vectors
v ∈ T have nonzero components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T ,
then we must have v ∈ v1, or v ∈ v2, or v ∈ v3, or v ∈ v4. Then we have

T =

T (Vi).

It follows from (3.2) and (3.4) that N =

Mi. So by the

Lemma 3.1, we have N =

Ni as desired.

Case 2. n2 = n3. Since (3.3) tells us that if the vectors v ∈ T have nonzero
components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T , then we must have

v ∈ v1, or v ∈ v3, or v ∈ v4. Then T =

T (vi). Thus by (3.2), (3.4) and the

4Pi=0

4Pi=0

M6 =

section.

4Si=0

Lemma 3.1, the desired result N =

Ni follows.

Case 3. n1 = n3, n2 < n4. Similarly (3.3) tells us that if the vectors v ∈ T
have nonzero components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T , then we

must have v ∈ v2, or v ∈ v3, or v ∈ v4. Thus T =

T (vi). It follows from

(3.2), (3.4) and the Lemma 3.1 that N =

Ni.

Case 4. n1 < n3, n2 = n4. It follows from (3.3) and the vectors v ∈ T have
nonzero components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T that v ∈ v1,

or v ∈ v2, or v ∈ v4. So T =

one gets that N =

Ni.

4Pi=0

i6=3

4Si=0

i6=3

T (vi). Then by (3.2), (3.4) and the Lemma 3.1,

18

4Si=0

i6=2

4Pi=0

i6=2

4Si=0

i6=1

4Pi=0

i6=1

Case 5. n1 = n3, n2 = n4. By the same argument, we know that if the

nonzero vectors v ∈ T , then v ∈ v2, or v ∈ v4. It infers that T =

T (vi).

4Pi=0

i6=1,3

4Si=0

i6=1,3

5Si=0

i6=3

Using (3.2), (3.4) and the Lemma 3.1, we deduce that N =

Ni.

Case 6. n1 < n3, n2 > n4. Similarly, from (3.3) we deduce that if the vectors
v ∈ T have nonzero components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T ,

then we obtain v ∈ v1, or v ∈ v2, or v ∈ v4, or v ∈ v5. Thus T =

T (vi).

From (3.2), (3.4) and the Lemma 3.1, the desired result N =

immediately.

5Pi=0

i6=3

Ni follows

Case 7. n1 = n3, n2 > n4. It’s easy to deduce that if the vectors v ∈ T have
nonzero components of the vectors (u11, ..., u1r2 , u21, ..., u2r4) ∈ T , then v ∈ v2,

or v ∈ v4, or v ∈ v5. Then T =

T (vi). Using (3.2), (3.4) and the Lemma

5Si=0

i6=1,3

3.1, we have N =

Ni as desired.

5Pi=0

i6=1,3

6Si=0

i6=2,5

6Pi=0

i6=2,5

Case 8. n3 > n2. From (3.3), one knows that if the nonzero vectors v ∈ T ,

then v ∈ v1, or v ∈ v3, or v ∈ v4, or v ∈ v6. So T =

T (vi). Then by (3.2),

(3.4) and the Lemma 3.1, the desired result N =

Ni follows.

Therefore Theorem 1.3 follows immediately. This ends the proof of Theorem
✷

1.3.

4 An example

In this section, we supply an example to illustrate the validity of our main
result.
Example 4.1. We use Theorem 1.3 to compute the number N of rational
points on the following variety over F7:
1x3
3 + x2

4 − 2 = 0,
2x3

4x5x6 − 4 = 0.

2x3x4
1x4

3x5

x1x4
x1x5

2 + x1x5
2x3

3 + x1x3

2 + x2
2x2

(cid:26)

Obviously, we have n1 = 2, n2 = 4, n3 = 3, n4 = 6,

E(1) =(cid:18) 1

1

4

5 (cid:19) , E(2) =

19

1 4
1 5
2 3
1 5
1 3

0 0
0 0
1 4
3 0
2 0

,



1
1
1
1

E(3) =

0
0
0
0
0
1
It then follows from the assumption n1 < n3 < n2 < n4, 2, 4 ∈ F ∗
1.3 that

4 0
5 0
3 1
5 3
3 2
4 3

0 0
0 0
4 0
0 0
0 0
5 1

1
1
2
1
1
2

.



7 and Theorem

(4.1)

We ﬁrst calculate N2. Using elementary transformations, One can easily



Ni.

N =

4 0
5 0
5 3
3 2

 and E(4) =
4Xi=2
 and V (3) =
U (3)E(3)V (3) = SNF(E(3)) =
(cid:26) u11 + u12 = 2

0
1
−1
1
2 −2
−6

0
0
0
0
1 −1
3

u21 + u22 = 4

5 −2

1
0
0
0

1 −4 0
0
0
0

1
0

1 

0 0
1 0
0 1
0 0

 .

deduce that

U (3) =

such that

1 = d(3)

Thus d(3)
number of the vectors (u11, u12, u21, u22) ∈ (F∗

2 = d(3)

3 = 1 and s3 = 3. But Lemma 2.4 tells us that the

7)4 satisfying that

is 25. For example, the vector

(u11, u12, u21, u22) = (3, 6, 1, 3)

is one of the solutions. Choose the primitive element 3 of F∗

7. Then

(h′

1, h′

2, h′

3, h′

4)T = U (3)(ind33, ind36, ind31, ind33)T

= U (3)(1, 3, 6, 1)T ≡ (1, 2, 1, 0)T

(mod 6).

We deduce that the condition (gSE

using Matlab we compute that H3 = 4. So

(3)

) that 1|1, 1|2 and 6|0 holds. Similarly,

N2 = qmax{n2,n4}−min{n2,n4}(qmin{n2,n4}−n3 − (q − 1)min{n2,n4}−n3 )L3

= q2(q − (q − 1))H3(q − 1)n3−s3

gcd(q − 1, d(3)

j ) = 196.

s3Yj=1

20

Consequently, we turn our attention to the computation of N3. Using the

elementary transformations, one gets that

U (2) =

such that

0
0
0

1
0
−1 1
−7 5
−9 7
−6 5

0
0
0
0
1
0
1 −1 1
0 −2 3



and V (2) =
U (2)E(2)V (2) = SNF(E(2)) =

1 0
0 1
0 0
0 0
0 0

1 −4
0
1
0
0
0
0

0
0
0
0
1 −4
0
1



0 0
0 0
1 0
0 4
0 0

.



1 = d(2)

Thus d(2)
the number of the vectors (u11, u12, u13, u21, u22) ∈ (F∗

3 = 1, d(2)

2 = d(2)

4 = 4 and s2 = 4. One can easily deduce that

7)5 such that

(cid:26) u11 + u12 + u13 = 2

u21 + u22 = 4

is 155. Choose the primitive element 3 of F∗
and using Matlab we compute that H2 = 9. Hence

7. The argument for calculating H3

N3 =(cid:0)qn4−n2 − (q − 1)n4−n2(cid:1)L2
=(cid:0)qn4−n2 − (q − 1)n4−n2(cid:1)H2(q − 1)n2−s2
= 18(cid:0)q2 − (q − 1)2(cid:1) = 234.

gcd(q − 1, d(2)
j )

s2Yj=1

Let us now calculate N4. Using the elementary transformations, we obtain

that

and

U (4) =

V (4) =




0
1
5

0
1
0
−1
1
−7
15 −11 −3
−9
−6

0
0
0
0
1 −1
0 −2

7
5

0 0
0 0
0 0
0 1
1 0
3 0

0
0
1 −4 0 0
0
0 0
0
0
0
1 0 −4
0
0
0
0 0
1
7 −1
0 1
0
0
0 0
0
1

1
0
0
0
0

21




such that

U (4)E(4)V (4) = SNF(E(4)) =

1
0
0
0
0
0

0 0
1 0
0 1
0 0
0 0
0 0

0 0
0 0
0 0
1 0
0 4
0 0

0
0
0
0
0
0



.



1 = d(4)

Thus d(4)
that the number of the vectors (u11, u12, u13, u21, u22, u23) ∈ (F∗

4 = 1, d(4)

2 = d(4)

3 = d(4)

5 = 4 and s4 = 5. So Lemma 2.4 gives us

7)6 such that

(cid:26) u11 + u12 + u13 = 2

u21 + u22 + u23 = 4

is equal to 961. Choose the primitive element 3 of F∗
calculating H3 and using Matlab, we compute that H4 = 84. Thus one has

7. By the argument for

N4 = l4 = H4(q − 1)n4−s4

= 84 × 6 × 2 = 1008.

gcd(q − 1, d(4)
j )

s4Yj=1

Finally, by (4.1), we have

N =

4Xi=2

Ni = 196 + 234 + 1008 = 1438.

References

[1] A. Adolphson and S. Sperber, p-Adic estimates for exponential sums
and the theorem of Chevalley-Warning, Ann. Sci. `Ecole Norm. Sup. 20
(1987), 545-556.

[2] A. Adolphson and S. Sperber, p-Adic estimates for exponential sums,
p-Adic analysis (Trento, 1989), 11-22, Lecture Notes in Math., 1454,
Springer, Berlin, 1990.

[3] J. Ax, Zeros of polynomials over ﬁnite ﬁelds, Amer. J. Math. 86 (1964),

255-261.

[4] I. Baoulina, On the equation (xm1

1 + ... + xmn

n )k = ax1...xn over a ﬁnite

ﬁeld, Int. J. Number Theory 2 (2006), 351-363.

[5] I. Baoulina, On the Carlitz problem on the number of solutions to
some special equations over ﬁnite ﬁelds, J. Th`eor. Nombres Bordeaux
23 (2011), 1-20.

22

[6] L. Carlitz, Pairs of quadratic equations in a ﬁnite ﬁeld, Amer. J. Math.

76 (1954), 137-154.

[7] L. Carlitz, The number of solutions of some equations in a ﬁnite ﬁeld,

Portug. Math. 13 (1954), 25-31.

[8] L. Carlitz, Certain special equations in a ﬁnite ﬁeld, Monatsh. Math.

58 (1954), 5-12.

[9] W. Cao, A special degree reduction of polynomials over ﬁnite ﬁelds

with applications, Int. J. Number Theory 7 (2011), 1093-1102.

[10] W. Cao and Q. Sun, A reduction for counting the number of zeros
of general diagonal equation over ﬁnite ﬁelds, Finite Fields Appl. 12
(2006), 681-692.

[11] W. Cao and Q. Sun, On a class of equations with special degrees over

ﬁnite ﬁelds, Acta Arith. 130 (2007), 195-202.

[12] E. Cohen, Congruence representations in algebraic number ﬁeld, Trans.

Amer. Math. Soc. 75 (1953), 444-470.

[13] J.H. Hodges, Representations by bilinear forms in a ﬁnite ﬁeld, Duke

Math. J. 22 (1955), 497-509.

[14] X.D. Hou, A note on the proof of a theorem of Katz, Finite Fields

Appl. 11 (2005), 316-319.

[15] S. Hu and S. Hong, The number of rational points on a family of vari-

eties over ﬁnite ﬁelds, arXiv:1603.00760.

[16] S. Hu, S. Hong and W. Zhao, The number of rational points of a family
of hypersurfaces over ﬁnite ﬁelds, J. Number Theory 156 (2015), 135-
153.

[17] L.-K. Hua, Introduction to number theory, Springer-Verlag, Berlin Hei-

delberg, 1982.

[18] L.-K. Hua and H.S. Vandiver, Characters over certain types of rings
with applications to the theory of equations in a ﬁnite ﬁeld, Proc. Nat.
Acad. Sci. 35 (1949), 94-99.

[19] K. Ireland and M. Rosen, A classical introduction to modern number

theory, 2nd ed., GTM 84, Springer-Verlag, New York, 1990.

[20] N.M. Katz, On a theorem of Ax, Amer. J. Math. 93 (1971), 485-499.

[21] R. Lidl and H. Niederreiter, Finite ﬁelds, second edition, Encyclopedia
of Mathematics and its Applications, vol. 20, Cambridge University
Press, Cambridge, 1997.

23

[22] O. Moreno and C.J. Moreno, Improvement of Chevalley-Warning and

the Ax-Katz theorem, Amer. J. Math. 117 (1995), 241-244.

[23] X. Pan and W. Cao, A problem of Carlitz and its generalizations, Arch.

Math. (Basel) 102 (2014), 337-343.

[24] H.J.S. Smith, On systems of linear indeterminate equations and con-

gruences, Philos. Trans. Royal Soc. London 151 (1861), 293-326.

[25] J. Song and Y. Chen, The number of solutions of some special systems

of equations over ﬁnite ﬁelds (in Chinese), Sci. Sin. Math., in press.

[26] Q. Sun, On diagonal equations over ﬁnite ﬁelds, Finite Fields Appls. 3

(1997), 175-179,

[27] Q. Sun, On the formula of the number of solutions of some equations
over ﬁnite ﬁelds (in Chinese), Chin. Ann. Math. 18A (1997), 403-408.

[28] Q. Sun and D. Wan, On the diophantine equation

Proc. Amer. Math. Soc. 112 (1991), 25-29.

≡ 0 (mod 1),

xi
di

nPi=1

[29] D. Wan, An elementary proof of a theorem of Katz, Amer. J. Math.

111 (1989), 1-8.

[30] D. Wan, A Chevalley-Warning proof of the Ax-Katz theorem and char-

acter sums, Proc. Amer. Math. Soc. 123 (1995), 1681-1686.

[31] D. Wan, Modular counting of rational points over ﬁnite ﬁelds, Found.

Comput. Math. 8 (2008), 597-605.

[32] W. Wang and Q. Sun, The number of solutions of certain equations

over a ﬁnite ﬁeld, Finite Fields Appl. 11 (2005), 182-192.

[33] W. Wang and Q. Sun, An explicit formula of solution of some special
equations over a ﬁnite ﬁeld (in Chinese), Chin. Ann. Math. 26A (2005),
391-396.

[34] J. Wolfmann, The number of solutions of certain diagonal equations

over ﬁnite ﬁelds, J. Number Theory 42 (1992), 247-257.

[35] J. Wolfmann, New results on diagonal equations over ﬁnite ﬁelds from
cyclic codes, Finite ﬁelds: theory, applications, and algorithms (Las
Vegas, NV, 1993), 387-395, Contemp. Math., 168, Amer. Math. Soc.,
Providence, RI, 1994.

[36] J. Yang, A class of systems of equations over a ﬁnite ﬁeld (in Chinese),

Academic Forum of Nan Du (Natu. Sci. Ed.) 20 (2000), 7-12.

24

