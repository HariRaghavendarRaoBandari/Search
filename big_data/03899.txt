6
1
0
2

 
r
a

 

M
2
1
 
 
]
h
p
-
h
t
a
m

[
 
 

1
v
9
9
8
3
0

.

3
0
6
1
:
v
i
X
r
a

FR´ECHET DIFFERENTIABILITY OF MOLECULAR

DISTRIBUTION FUNCTIONS I. L∞ ANALYSIS

MARTIN HANKE∗

Abstract. For a grand canonical ensemble of classical point-like particles at equilibrium in
continuous space we investigate the functional relationship between a stable and regular pair potential
describing the interaction of the particles and the corresponding molecular distribution functions.
For certain admissible perturbations of the pair potential and suﬃciently small activity we rigorously
establish Frechet diﬀerentiability with respect to the supremum norm in the image space – both for
bounded domains and in the thermodynamical limit.

Key words.

Statistical mechanics, molecular distribution function, Fr´echet derivative,

Kirkwood-Salsburg equations

AMS subject classiﬁcations. 82B21, 82B80

Last modiﬁed. March 15, 2016

1. Introduction. We consider the grand canonical description of a continu-
ous system of identical classical particles in thermodynamical equilibrium; cf., e.g.,
Hansen and McDonald [4]. It is assumed that the potential energy of the system is
determined by a pair potential which only depends on the distance of the interacting
particles. Under certain additional assumptions on the potential (known as stability
and regularity) it has been rigorously proved in the 60’s of the previous century (see
the monograph by Ruelle [9]) that the corresponding molecular distribution functions
of the particles have a well-deﬁned thermodynamical limit for a small enough activ-
ity coeﬃcient. For example, the limiting singlet distribution function determines the
(constant) number density of the particles; the corresponding pair distribution func-
tion which provides the probability density of observing two particles in prescribed
coordinates at the same time only depends on the distance between the given coor-
dinates and gives rise to a so-called radial distribution function. The inverse problem
whether a given radial distribution function can be obtained as the thermodynamical
limit of an equilibrium distribution for a certain pair potential is an open problem;
there are only few partial results, for example by Henderson [5] on uniqueness and by
Koralov [6] on existence of corresponding solutions.

This inverse problem is fundamental for the development of eﬃcient multiscale
algorithms for the numerical simulation of complex soft matter phenomena, compare,
for example, R¨uhle et al [8]. Many of these algorithms employ methods for coarse-
graining complex molecules and need to derive eﬀective potentials for the coarse-
grained beads from measured data such as the radial distribution function.

One of the algorithms for solving this inverse problem is the so-called Inverse
Monte-Carlo method by Lyubartsev and Laaksonen [7], which utilizes the well-known
Newton method for the numerical solution of nonlinear equations. As such, this
method requires the derivative of the radial distribution function with respect to the
pair potential, and a formal discretized computation of this derivative for a canonical
ensemble is given in loc. cit.

Apparently a rigorous justiﬁcation of this formula is yet lacking. This is the pur-
pose of this present work, which is the ﬁrst part of two consecutive papers. A crucial

∗Institut f¨ur Mathematik, Johannes Gutenberg-Universit¨at Mainz, 55099 Mainz, Germany
(hanke@math.uni-mainz.de). The research leading to this work has been done within the Collabo-
rative Research Center TRR 146; corresponding funding by the DFG is gratefully acknowledged.

1

2

M. HANKE

ingredient is the choice of a proper (and natural) topology for suitable perturbations
of a given potential (see Proposition 2.1 below). The topology that we suggest allows
to exploit the well-known Kirkwood-Salsburg system of equations and the correspond-
ing theory in [9] to rigorously determine the derivative of all molecular distribution
functions (and their thermodynamical limit) with respect to the underlying potential
in the L∞ norm of the corresponding distribution functions. We refer to Section 2 for
a precise statement of our results.

As far as the radial distribution function is concerned it is also natural to inves-
tigate the diﬀerentiability of the so-called Ursell function (sometimes also referred to
as pair correlation function [4]). In the thermodynamical limit the Ursell function is
known to belong to L1(R3) as a function of the distance between its two input particle
positions, cf. [9] again. We can prove that the diﬀerentiability of the Ursell function
extends to this topology, either. Since the proof requires a completely diﬀerent set of
tools we postpone this and related results to the follow-up paper [3].

The outline of this ﬁrst part is as follows. In the following section the setting and
basic assumptions of this work will be speciﬁed. There we also formulate the two main
results, Theorem 1 on the diﬀerentiability of the molecular distribution functions, and
Theorem 2 on the thermodynamical limit of these derivatives. Section 3 is devoted
to a proof of Theorem 1 and Section 4 provides the proof of Theorem 2.
In the
ﬁnal Section 5 we reconsider the explicit formula from [7] for the derivative of the
pair distribution function in a bounded domain, and also provide a formula for the
derivative of the singlet distribution function.

2. Problem setting. In the sequel we present our basic assumptions on the
system under consideration and review some basic facts; most of them are well known,
and unless stated otherwise, we refer to [9] as a standard reference.

We consider a grand canonical ensemble of identical classical point-like particles
in a box Λ ⊂ R3 in thermodynamical equilibrium with deﬁned positive inverse tem-
perature β and activity z. Throughout this work we assume that the box Λ is a cube
centered at the origin. The interaction of the particles is given by a pair potential
u : R+ → R, which only depends on the distance between the corresponding particles.
Such a pair potential is called stable, if there exists a constant B > 0 such that

X1≤i<j≤N

u(|Ri − Rj|) ≥ −BN

for all conﬁgurations of N labeled particles (and all N ∈ N), where RN =
(R1, . . . , RN ) ∈ (R3)N is the N -tupel with the particle coordinates. A stable pair
potential u is called regular, if the associated Mayer function

f (R) = e−βu(|R|) − 1

(2.1)

belongs to L1(R3), i.e., if

Z ∞

0

|e−βu(r) − 1| r2 dr < ∞ .

In order to investigate diﬀerentiability with respect to u we need to allow some
variability of the potential without disturbing the above two properties. Therefore we
will stipulate a slightly more restrictive but much more handy assumption on u.

Assumption A. There exists s > 0 and positive decreasing functions u∗, u∗ :

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

3

R+ → R with

Z s

0

u∗(r) r2 dr = ∞

and

Z ∞

s

u∗(r) r2 dr < ∞ ,

such that u satisﬁes

u(r) ≥ u∗(r) , r ≤ s ,

and

|u(r)| ≤ u∗(r) , r ≥ s .

An example of a pair potential that satisﬁes Assumption A is the familiar Lennard-

Jones potential

with parameters ε, σ > 0.

uLJ(r) = 4ε(cid:16)(cid:0) σ
r(cid:1)12

r(cid:1)6(cid:17)
−(cid:0) σ

Given that the pair potential u satisﬁes Assumption A we introduce the space Vu
of perturbations v : R+ → R for which |v|/u is bounded in (0, s) and |v|/u∗ is bounded
in (s, ∞); Vu is a Banach space when equipped with the norm

kvkVu = max{ kv/uk(0,s), kv/u∗k(s,∞) } .

(2.2)

Here, and throughout, the notation k · kΩ refers to the supremum norm of a function
acting from some interval Ω ⊂ Rd into a given Banach space. As we see next, the
topology of Vu deﬁnes an open neighborhood of stable and regular pair potentials
around the given u.

Proposition 2.1. Let u satisfy Assumption A, Vu be the Banach space with
norm (2.2), and 0 < t0 < 1 be given. Then there are constants B ≥ 0 and cβ > 0

such that the potential eu = u + v satisﬁes

for every RN ∈ (R3)N and

X1≤i<j≤Neu(|Ri − Rj|) ≥ −BN
4πZ ∞

|e−βeu(r) − 1| r2 dr ≤ cβ

0

(2.3)

(2.4)

(2.5)

N ≥ 2 and all RN ∈ (R3)N there exists j∗ = j∗(RN ) such that

for every v ∈ Vu with kvkVu ≤ t0, i.e., eu is stable and regular. Moreover, for all

NXi=1
i6=j∗ eu(|Ri − Rj∗ |) ≥ −2B

for every eu = u + v with kvkVu ≤ t0; in particular, eu is bounded by −2B from below.

Proof. The crucial observation is, that for a given t0 ∈ (0, 1), every 0 < r ≤ s,

and every v ∈ Vu with kvkVu ≤ t0 there holds

with q = 1 − t0 > 0; at the same time we have

eu(r) ≥ u(r) − |v(r)| ≥ (1 − t0)u(r) ≥ qu∗(r)
|eu(r)| ≤ |u(r)| + |v(r)| ≤ (1 + t0)u∗(r) ≤ (2 − q)u∗(r)

4

M. HANKE

for every r ≥ s. From this we conclude that under the given assumptions on u and
v the regularity condition (2.4) does hold true for some constant cβ > 0 and all v

with kvkVu ≤ t0. Concerning the stability of the pair potential eu we refer to the

argument utilized by Fisher and Ruelle in [2]: Their construction provides a universal
even minorant u : R → R of positive type such that

for all v ∈ Vu with kvkVu ≤ t0. Inequalities (2.3) and (2.5) then follow with B =
u(0)/2.

r > 0 ,

eu(r) ≥ u(r) ,

Writing

UN (R1, . . . , RN ) = X1≤i<j≤N

u(|Ri − Rj|)

(2.6)

for the conﬁgurational Hamiltonian of the system, the molecular distribution function
ρ(m)
Λ

for m particles, m ∈ N, being distributed in Λ is deﬁned to be

ρ(m)
Λ (Rm) =

1
ΞΛ

∞XN =m

zN

(N − m)!ZΛN −m

e−βUN (RN ) dRm,N ,

(2.7)

where Rm ∈ Λm, Rm,N denotes the (N − m)-tupel (Rm+1, . . . , RN ) ⊂ ΛN −m with
the coordinates of additional N − m particles, and

ΞΛ =

zN

N !ZΛN

∞XN =0

e−βUN (RN ) dRN

(2.8)

is the grand canonical partition function for a given inverse temperature β and activity
z. The formulations in (2.7) and (2.8) obey the usual convention that the integral of
the constant one over Λ0 is considered to be one.

It has been shown in [9] that under the given assumptions on u and for an inverse

temperature β and activity z satisfying

0 < z <

1

cβe2βB+1

(2.9)

Λ

the distribution function ρ(m)
is bounded in Λm, its bound being independent of
the size of Λ, and in the thermodynamical limit |Λ| → ∞ the distribution functions
converge compactly, i.e., uniformly on every compact subset of (R3)m; we denote by
ρ(m) : (R3)m → R+
0 the corresponding limit function. When m = 1 the resulting
limit is the constant counting density ρ0 of the system; when m = 2 the limit ρ(2) is
invariant under translations and rotations and one can deﬁne the radial distribution
function g : R+ → R+

0 by

g(r) =

1
ρ2
0

ρ(2)(R1, R2) ,

r = |R1 − R2| .

In this work we investigate the dependence of the molecular distribution functions

on u and we are going to prove the following two results.

Theorem 1. Let u satisfy Assumption A and z and β be constrained by (2.9).
Then for every m ∈ N and every box Λ ⊂ R3 the molecular distribution function ρ(m)

Λ

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

5

has a well-deﬁned Fr´echet derivative ∂ρ(m)

ρ(m) has a Fr´echet derivative ∂ρ(m) ∈ L(cid:0)Vu, L∞((R3)m)(cid:1).

Theorem 2. Under the assumptions of Theorem 1 the derivative operator ∂ρ(m)
converges to ∂ρ(m) in the thermodynamical limit |Λ| → ∞ in the following sense: For
any ﬁxed bounded box Λ′ ⊂ R3 and any m ∈ N there holds

Λ ∈ L(cid:0)Vu, L∞(Λm)(cid:1) with respect to u, and

Λ

k(∂ρ(m)

Λ )v − (∂ρ(m))vkΛ′m → 0 ,

uniformly for v ∈ Vu with kvkVu ≤ 1.

The proofs of these two theorems utilize the Kirkwood-Salsburg equations. As
such, the Fr´echet derivatives are only given implicitly as the solution of a semi-inﬁnite
linear system. For a bounded box Λ ⊂ R3 and associated molecular distribution
functions ρ(m)
Λ more explicit formulae can be derived directly from (2.7), and we will
do so for m = 1 and m = 2 in Section 5; we mention, though, that it is much
more diﬃcult to investigate the thermodynamical limit of the latter and to prove
diﬀerentiability of ρ(m) by this approach.

3. Proof of Theorem 1. In the sequel we consider a generic box Λ ⊂ R3
centered at the origin, and, by some abuse of notation, we will even allow Λ to be the
entire space.

To begin with we recall the deﬁnition (2.5) of j∗(Rm) for a given Rm ∈ Λm, and
associated with it we introduce the (nonlinear) projection Πm : (R3)m → (R3)m−1
via

Πm : Rm 7→ (Rj∗−1, Rj∗,m) .

(3.1)

We also need to deﬁne the following two function sequences dm : (R3)m → R, m ∈ N,
and kn : R3 × (R3)n → R, n ∈ N, given by

dm(Rm) =

mYi=1

i6=j∗

e−βu(|Ri−Rj∗ |) ,

m ∈ N ,

(3.2)

and

kn(R; R′

n) =

f (R′

i − R) ,

nYi=1

(3.3)

where f is the Mayer function (2.1). The latter are utilized as kernel functions for
the integral operators

kn(Rj∗ ; R′

n)ϕm+n−1(cid:0)Πm(Rm), R′

n(cid:1) dR′

n

(3.4)

(cid:0)Kmn,Λϕm+n−1(cid:1)(Rm) =

1

n!ZΛn

for m, n ∈ N, and ϕm+n−1 : Λm+n−1 → R. Finally, we need the extension operators

for m ∈ N \ {1} and ϕm−1 : Λm−1 → R.

(Im,Λϕm−1)(Rm) = ϕm−1(cid:0)Πm(Rm)(cid:1)

(3.5)

Following Ruelle [9] we introduce the Banach space XΛ of sequences ϕ = (ϕm)m

of bounded functions ϕm : Λm → R, for which the norm

(cid:13)(cid:13)ϕ(cid:13)(cid:13)XΛ

= sup
m∈N

cm
β kϕmkΛm

6

M. HANKE

with cβ of (2.4) is ﬁnite. On XΛ a diagonal multiplication operator

d1

d2

. . .



DΛ = 


0
...

and a semi-inﬁnite block integral operator

K11,Λ K12,Λ K13,Λ . . .

KΛ =

I2,Λ K21,Λ K22,Λ

I3,Λ K31,Λ
. . .
. . .

. . .
. . .

(3.6)

(3.7)



are deﬁned by utilizing the functions dm of (3.2) and the operators Kmn,Λ and Im,Λ
of (3.4) and (3.5), respectively. It has been shown in [9] that DΛ and KΛ belong to
L (XΛ) with

kDΛkL (XΛ) ≤ e2βB ,

kKΛkL (XΛ) ≤ cβe .

(3.8)

These operators can now be used to formulate the celebrated Kirkwood-Salsburg
equations:

(I − zAΛ)ρΛ = ze1 ,

AΛ = DΛKΛ ,

(3.9)

where

ρΛ = (ρ(m)

Λ )m

and

e1 = (δ1m)m ,

with δ1m being the Kronecker symbol and z being the activity. By virtue of (2.9) the
linear system (3.9) is uniquely solvable for ρΛ.

To compute the derivative of the molecular distribution functions we need to
determine the derivatives of the functions d, f , and k in appropriate topologies. This
is the purpose of the following three auxiliary results.

Lemma 3.1. Let u satisfy Assumption A. Then the Mayer f -function has a

Fr´echet derivative ∂f ∈ L(cid:0)Vu, L1(R3)(cid:1) with respect to u given by

(∂f )v = −βe−βuv ,

v ∈ Vu ,

i.e., there exists Cβ > 0 such that

k(∂f )vkL1(R3) ≤ CβkvkVu ,

(3.10a)

and for kvkVu ≤ t0 and ef the Mayer function associated with eu = u + v there holds

(3.10b)

kef − f kL1(R3) ≤ CβkvkVu ,
kef − f − (∂f )vkL1(R3) ≤ Cβkvk2

Vu .

(3.10c)

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

7

Proof. For v ∈ Vu Taylor’s theorem yields

kef − f − (∂f )vkL1(R3) = 4πZ ∞
= 4πZ ∞
≤ 2πZ ∞

0

0

0

(cid:12)(cid:12)e−βeu(r) − e−βu(r) + βe−βu(r)v(r)(cid:12)(cid:12) r2 dr
e−βu(r)(cid:12)(cid:12)e−βv(r) − 1 + βv(r)(cid:12)(cid:12) r2 dr

e−β(u(r)−|v(r)|)|βv(r)|2r2 dr .

(3.11)

When kvkVu ≤ t0 then it follows from Proposition 2.1 that

e−β(u(r)−|v(r)|)|βv(r)|2r2 ≤ β2e2βBkvk2

Vuu∗(s) u∗(r)r2

for r > s, while for 0 < r ≤ s we have

e−β(u(r)−|v(r)|)|βv(r)|2r2 ≤ β2kvk2
4s2

Vue−β(1−t0)u(r)u2(r)s2

≤

e2(1 − t0)2 kvk2

Vu .

Inserting these estimates into (3.11) we readily arrive at (3.10c).

In much the same way we can estimate

e−βu(r)|βv(r)|r2 ≤ (βe2βBkvkVu u∗(r)r2 ,

(s2/e)kvkVu ,

r ≥ s ,
0 < r ≤ r0 ,

(3.12)

to deduce (3.10a). Take note that (3.12) holds true for every v ∈ Vu.

When u is replaced by u − |v| with kvkVu ≤ t0 in (3.12) then the upper bound on
the right-hand side increases by at most 1/(1 − t0), and hence, (3.12) also provides a
convergent majorant to estimate

e−βu(r)(cid:12)(cid:12)e−βv(r) −1(cid:12)(cid:12) r2 dr ≤ 4πZ ∞

0

e−β(u(r)−|v(r)|)|βv(r)| r2 dr

0

for kvkVu ≤ t0, cf. (3.10b).

kef −f kL1(R3) = 4πZ ∞
L(cid:0)Vu, L∞(R3)(cid:1) given by

Lemma 3.2. Let u satisfy Assumption A. Then the functions dm of (3.2)
are Fr´echet diﬀerentiable with respect to the pair potential with derivative ∂dm ∈

(cid:0)(∂dm)v(cid:1)(Rm) = −βdm(Rm)

v(|Ri − Rj∗ |)

mXi=1

i6=j∗

for v ∈ Vu and Rm ∈ (R3)m. There holds

k(∂dm)vk(R3)m ≤

e2βB

t0

kvkVu

and, if kvkVu ≤ t0/2 then

kedm − dmk(R3)m ≤
kedm − dm − (∂dm)vk(R3)m ≤

2e2βB

t0

4e2βB

t2
0

kvkVu ,

kvk2

Vu ,

(3.13a)

(3.13b)

(3.13c)

8

M. HANKE

1

For v ∈ Vu and ﬁxed Rm ∈ (R3)m we use Taylor’s theorem to estimate

Proof. For the proof of this result it is essential that the index j∗ = j∗(Rm) of

where all sums extend over every i = 1, . . . , m with i 6= j∗, the respective arguments
being given by |Ri − Rj∗ |. For every γ > 0 there holds

where edm denotes the function dm associated with the pair potential u + v.
(2.5) is independent of the particular pair potential eu = u + v as long as kvkVu ≤ t0.
(cid:12)(cid:12)edm − dm − (∂dm)v(cid:12)(cid:12) = (cid:12)(cid:12)dm(e−β P v − 1 + βX v)(cid:12)(cid:12) ≤
2(cid:12)(cid:12)e−β P u(βX v)2eβ P |v|(cid:12)(cid:12) ,
(βX v)2 ≤ γ2 1
γX |v|(cid:1)2
2(cid:0) β
(cid:12)(cid:12)edm − dm − (∂dm)v(cid:12)(cid:12) ≤ γ2e−β P(u−|v|−|v|/γ) .

For γ = 2kvkVu/t0 the assertion (3.13c) now follows from (2.5) witheu = u − |v|− |v|/γ

provided that kvkVu ≤ t0/2. This proves the diﬀerentiability of dm. The proof of the
two estimates (3.13a) and (3.13b) follows along the same lines and is left to the reader.

≤ γ2eβ P |v|/γ ,

and hence

1
2

To formulate the following result we introduce the formal derivative of kn of (3.3)

with respect to u in direction v, i.e.,

n(R; R′
k′

n) =

nXi=1(cid:0)(∂f )v(cid:1)(|R′

i − R|)

nYj=1

j6=i

f (R′

j − R)

(3.14)

for R ∈ R3 and R′

N ∈ (R3)n.

Proposition 3.3. Under the assumptions of Theorem 1 the operator KΛ is

Fr´echet diﬀerentiable with respect to u in L(cid:0)Vu, L (XΛ)(cid:1), and its derivative ∂KΛ is

given by

,

(3.15)

(∂KΛ)v =

where

(K ′

mn,Λϕm+n−1)(Rm) =

K ′

11,Λ K ′
K ′

13,Λ . . .

12,Λ K ′
21,Λ K ′
K ′
. . .

0

22,Λ

31,Λ



. . .
. . .



0
...
...

1

n!ZΛn

n(Rj∗ ; R′
k′

n)ϕm+n−1(cid:0)Πm(Rm), R′

n(cid:1) dR′

n

for m ∈ N, with ϕm+n−1 : Λm+n−1 → R, Πm of (3.1), and k′

n of (3.14).

Proof. Let Yn be the Banach space of functions k : R3 × (R3)n → R with norm

kkkYn = sup
R∈R3

kk(R; · )kL1((R3)n) .

We prove that kn of (3.3) is diﬀerentiable with respect to u in L (Vu, Yn), and that its
derivative (∂kn)v in direction v is given by k′
n of (3.14). From Lemma 3.1 we readily
conclude that k′

n ∈ Yn with

kk′

nkYn ≤ nCβcn−1

β

kvkVu .

(3.16)

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

9

We now assume that kvkVu ≤ t0 and introduce short-hand notationsekn for the
kernel kn associated with the pair potential eu = u + v, and let
efi(R) = e−βeu(|R′

for every appropriate value of i; in the sequel we also omit the obvious arguments R′
i
and R, respectively. Then we prove by induction on n ∈ N that

fi(R) = e−βu(|R′

i−R|) − 1

i−R|) − 1

and

kekn − knkYn ≤ nCβcn−1

β

kvkVu ,

n ∈ N ,

(3.17)

n ∈ N ,

(3.18)

which is obviously true because of (3.10b) when n = 1, because ek1 − k1 = ef1 − f1.

The inductive step is then based on

ekn+1 − kn+1 = eknefn+1 − knfn+1 = ekn(efn+1 − fn+1) + (ekn − kn)fn+1

the induction hypothesis, and on the estimates (3.10b) and (2.4).

Still assuming that kvkVu ≤ t0 we now proceed to establish the inequality

= ef1 · · ·efn(efn+1 − fn+1) + (ekn − kn)fn+1 ,
kekn − kn − k′

nkYn ≤ n2C′

βcn−1

kvk2

Vu ,

β

β = max{Cβ, C2

for C′
β/(2cβ)}, which proves the asserted diﬀerentiability of kn. For
n = 1 inequality (3.18) has been established in the proof of Lemma 3.1, cf. (3.10c).
For the induction step we write

ekn+1 − kn+1 − k′

n+1 = eknefn+1 − knfn+1 − kn(∂fn+1)vn+1 − k′

nfn+1

= (ekn − kn − k′

n)fn+1 + (ekn − kn)(efn+1 − fn+1)

+ f1 · · · fn(efn+1 − fn+1 − (∂fn+1)vn+1) ,

where we have set

vn+1 = v(|R′

n+1 − R|) .

Then it follows from the induction hypothesis (3.18), and from (2.4), (3.17), (3.10b),
and (3.10c) that

kekn+1 − kn+1 − k′

Inserting the deﬁnition of C′
satisﬁes

n+1kYn+1 ≤ (cid:0)n2C′

βcn

β + nC2

βcn−1

β + cn

βCβ(cid:1)kvk2

Vu .

β we further conclude that the above right-hand side

β + 2n

(cid:0)n2C′

C2
β
2cβ

+ Cβ(cid:1)cn

hence the induction step is complete.

βkvk2

Vu ≤ (n + 1)2C′

βcn

βkvk2

Vu ,

Having established (3.18) we can now argue as in [9] to show that

keKΛ − KΛ − (∂KΛ)vkL (XΛ) ≤ 2eC′

βkvk2

Vu ,

where eKΛ denotes the block integral operator (3.7) associated with eu, (∂KΛ)v is

deﬁned in (3.15), and kvkVu ≤ t0. This shows that ∂KΛ of (3.15) is the Fr´echet
derivative of KΛ when considered a function of the pair potential.

10

M. HANKE

Now we can establish Theorem 1.
Proof of Theorem 1. From Lemma 3.2 it follows readily that DΛ is also Fr´echet
diﬀerentiable as a function of u, and so is AΛ = DΛKΛ, and the derivative ∂AΛ of AΛ
is given by

(∂AΛ)v = ((∂DΛ)v)KΛ + DΛ(∂KΛ)v

for v ∈ Vu. Denote by eDΛ and eKΛ the operators (3.6) and (3.7) associated with the
pair potential eu = u + v, and set eAΛ = eDΛeKΛ. Moreover, let eρΛ be the respective

sequence of molecular distribution functions. Then, for kvkVu ≤ t0 there holds

eρΛ − ρΛ = (cid:0)(I − zeAΛ)−1 − (I − zAΛ)−1(cid:1)ze1

= z(cid:0)I − zeAΛ)−1(eAΛ − AΛ)(I − zAΛ)−1ze1
= z(I − zAΛ)−1(cid:0)(∂AΛ)v(cid:1)(I − zAΛ)−1ze1 + O(kvk2

Vu )

in XΛ. Accordingly, ρΛ is Fr´echet diﬀerentiable, and its Fr´echet derivative ∂ρΛ ∈
L (Vu, XΛ) satisﬁes

(∂ρΛ)v = z(I − zAΛ)−1(cid:0)(∂AΛ)v(cid:1)(I − zAΛ)−1ze1 = z(I − zAΛ)−1(cid:0)(∂AΛ)v(cid:1)ρΛ .

This implies the statement of Theorem 1.

4. Proof of Theorem 2. In this section we investigate the thermodynami-
cal limit of the sequence ρΛ = (ρ(m)
Λ )m ∈ XΛ of molecular distribution functions;
throughout this section Λ ⊂ R3 always denotes a ﬁnite size box. Take note that when
Λ′ ⊂ Λ then any sequence ϕΛ = (ϕ(m)
Λ )m ∈ XΛ also belongs to XΛ′ . We will make
repeated use of this property without further mentioning by taking the corresponding
norm kϕΛkX
Λ′ of ϕΛ. Often, however, it will be convenient to make this imbedding
more explicit. To this end we introduce the corresponding imbedding operator

PΛ′

: XΛ → XΛ′ ,

(4.1)

PΛ′ ϕΛ =(cid:0)ϕ(m)

Λ (cid:12)(cid:12)(Λ′)m(cid:1)m .

To simplify matters, though, we will not specify explicitly the domain XΛ of PΛ′ in
this notation; this domain may diﬀer depending on the context.

In the previous section we have shown that ρΛ as well as its thermodynamical

limit ρ are diﬀerentiable with respect to u, their derivative(s) being given by

(∂ρΛ)v = z(I − zAΛ)−1A′
(∂ρ)v = z(I − zA)−1A′ρ ,

ΛρΛ ,

(4.2)

respectively. In (4.2) we have used short-hand notations A′ and A′
Λ for (∂A)v and
(∂AΛ)v, respectively. We will continue to do so and similarly for the operators D, K,
DΛ, and KΛ throughout the remainder of this section as long as v ∈ Vu is ﬁxed.

The proof of Theorem 2 will proceed in three steps: First, in Lemma 4.1, we will

show that for two boxes Λ′′ ⊂ Λ with Λ′′ being kept ﬁxed we have convergence

kA′

ΛρΛ − A′ρkX

Λ′′ → 0

as |Λ| → ∞ .

(4.3)

Then, in a second step we ﬁx another box Λ′ ⊂ Λ, and we argue that

k(I − zAΛ)−1PΛA′ρ − (I − zA)−1A′ρkX

Λ′ → 0

as |Λ| → ∞ .

(4.4)

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

11

Third, we apply (4.3) in a setting with three boxes Λ′ ⊂ Λ′′ ⊂ Λ to show that

k(I − zAΛ)−1PΛ(A′ρ − A′

ΛρΛ)kX

Λ′ → 0

as |Λ| → ∞ ,

(4.5)

provided that Λ′ is kept ﬁxed. A combination of (4.4) and (4.5) then readily yields
the desired convergence

k(∂ρΛ)v − (∂ρ)vkX

Λ′ → 0

as |Λ| → ∞, which completes the proof of Theorem 2.

Lemma 4.1. Let u satisfy the assumptions of Theorem 1 and let A′

Λ and A′ be
deﬁned as above for a given v ∈ Vu. Then, for a ﬁxed box Λ′′ ⊂ R3 and for Λ′′ ⊂ Λ ⊂
R3 the convergence (4.3) holds true uniformly for all v ∈ Vu with kvkVu ≤ 1.

Proof. Let ε > 0, d > s, and a certain box Λ′′ ⊂ R3 be given. We choose a
second box Λ∗ ⊃ Λ′′ in such a way that |R′′ − R| > d for every R′′ ∈ Λ′′ and every
R ∈ R3 \ Λ∗. According to [9] there holds

provided that Λ ⊃ Λ∗ is suﬃciently large; moreover,

kρΛ − ρkXΛ∗ ≤ ε ,

kρkX

R3 , kρΛkXΛ ≤ C∗

for some C∗ > 0, independent of the size of Λ. Then, for any Rm ∈ (Λ′′)m and any
n ∈ N we can estimate

Λ

1

=

ZΛn

(cid:12)(cid:12)(cid:0)Kmn,Λρ(m+n−1)
n!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
n!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Z(Λ∗)n

=

1

≤

c1−m−n
β

n!

kn(Rj∗ ; R′

n)ρ(m+n−1)

(cid:1)(Rm) − (cid:0)Kmnρm+n−1(cid:1)(Rm)(cid:12)(cid:12)
− Z(R3)n

(Πm(Rm), R′

kn(Rj∗ ; R′

Λ

n) dR′
n

n)ρ(m+n−1)(Πm(Rm), R′

n) dR′

n(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

kn(Rj∗ ; R′

(Πm(Rm), R′

n) − ρ(m+n−1)(Πm(Rm), R′

n)(cid:0)ρ(m+n−1)

Λ

+ ZΛn\(Λ∗)n
− Z(R3)n\(Λ∗)n
(cid:16)εZ(R3)n(cid:12)(cid:12)kn(Rj∗ ; R′

kn(Rj∗ ; R′

n)ρ(m+n−1)

Λ

(Πm(Rm), R′

n) dR′
n

kn(Rj∗ ; R′

n)ρ(m+n−1)(Πm(Rm), R′

n) dR′

n)(cid:12)(cid:12) dR′

n + 2C∗Z(R3)n\(Λ∗)n(cid:12)(cid:12)kn(Rj∗ ; R′

n)(cid:1) dR′

n

n(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
n(cid:17) .
n)(cid:12)(cid:12) dR′

(4.6)

The ﬁrst integral in (4.6) is bounded by cn
ncn−1

cβ,d, where

β

β, the second integral can be estimated by

cβ,d = 4πZ ∞

d

|e−βeu(r) − 1| r2 dr ,

(4.7)

12

M. HANKE

compare the proof of [9, Theorem 4.2.3]. We thus have

β kKmn,Λρ(m+n−1)
cm

Λ

− Kmnρ(m+n−1)k(Λ′′)m ≤

cβ
n!

ε +

2C∗

(n − 1)!

cβ,d ,

which readily yields

kKΛρΛ − KρkX

Λ′′ ≤ e(cβε + 2C∗cβ,d) .

Since we can let d be arbitrarily large and ε > 0 be arbitrarily small by choosing |Λ∗|
and |Λ| suﬃciently big, it follows that

kKΛρΛ − KρkX

Λ′′ → 0

as |Λ| → ∞ ,

and hence, cf. (3.13a),

kD′

ΛKΛρΛ − D′KρkX

Λ′′ = kD′

Λ′′ PΛ′′ (KΛρΛ − Kρ)kX

Λ′′

≤ kD′

Λ′′ kX

Λ′′ kKΛρΛ − KρkX

Λ′′ ≤

e2βB

t0

kKΛρΛ − KρkX

Λ′′ kvkVu → 0

as |Λ| → ∞, uniformly for all v ∈ Vu with kvkVu ≤ 1.

In a similar way we can estimate

kDΛK ′

ΛρΛ − DK ′ρkX

Λ′′ ,

the main diﬀerence for this estimate being that kn in (4.6) has to be replaced by k′
n
of (3.14), i.e.,

(cid:12)(cid:12)(cid:0)K ′

≤

Λ

mn,Λρ(m+n−1)
c1−m−n
β

(cid:1)(Rm) − (cid:0)K ′
(cid:16)εZ(R3)n(cid:12)(cid:12)k′

n(Rj∗ ; R′

mnρm+n−1(cid:1)(Rm)(cid:12)(cid:12)
n)(cid:12)(cid:12) dR′

n + 2C∗Z(R3)n\(Λ∗)n(cid:12)(cid:12)k′

n!

n(Rj∗ ; R′

n(cid:17) (4.8)

n)(cid:12)(cid:12) dR′

for Rm ∈ (Λ′′)m. Here we can use the bound (3.16) for the ﬁrst integral, but the
second integral requires a diﬀerent estimate. Following the line of argument employed
previously, we obtain from (3.14) the inequality

n

n

≤

≤

n(Rj∗ ; R′

j − Rj∗ |)(cid:12)(cid:12) dR′

i − Rj∗ |)(cid:12)(cid:12)Yj6=i(cid:12)(cid:12)f (|R′

Z(R3)n\(Λ∗)n(cid:12)(cid:12)k′
n)(cid:12)(cid:12) dR′
nXi=1Z(R3)n\(Λ∗)n(cid:12)(cid:12)(cid:0)(∂f )v(cid:1)(|R′
nXi=1 (n − 1)ZR3(cid:12)(cid:12)(cid:0)(∂f )v(cid:1)(|R|)(cid:12)(cid:12) dR(cid:16)ZR3(cid:12)(cid:12)f (|R|)(cid:12)(cid:12) dR(cid:17)n−2ZR3\Λ∗(cid:12)(cid:12)f (|R − Rj∗ |)(cid:12)(cid:12) dR
+ ZR3\Λ∗(cid:12)(cid:12)(cid:0)(∂f )v(cid:1)(|R − Rj∗ |)(cid:12)(cid:12) dR(cid:16)ZR3(cid:12)(cid:12)f (|R|)(cid:12)(cid:12) dR(cid:17)n−1! .
Z(R3)n\(Λ∗)n(cid:12)(cid:12)k′

n)(cid:12)(cid:12) dR′

n(Rj∗ ; R′

Using (2.4), (4.7), and (3.10a) this yields

≤ n(n − 1)cn−2

cβ,dCβkvkVu + ncn−1

β

n

β Z|R|>d(cid:12)(cid:12)(cid:0)(∂f )v(cid:1)(|R|)(cid:12)(cid:12) dR .

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

13

Since d > s the remaining integral can be estimated by means of (3.12), and hence,

Z|R|>d(cid:12)(cid:12)(cid:0)(∂f )v(cid:1)(|R|)(cid:12)(cid:12) dR = 4πZ ∞

d

βe−βu(r)(cid:12)(cid:12)v(r)(cid:12)(cid:12) r2 dr

≤ 4πβe2βBkvkVuZ ∞

d

u∗(r) r2 dr =: c∗

β,dkvkVu .

Take note that c∗

β,d → 0 for d → ∞. We thus conclude from (4.8) that

mn,Λρ(m+n−1)

cm

Λ

β (cid:13)(cid:13)(cid:0)K ′
≤ (cid:16) Cβ

(n − 1)!

ε +

(cid:1)(Rm) − (cid:0)K ′

2C∗Cβ

mnρm+n−1(cid:1)(Rm)(cid:13)(cid:13)(Λ′′)m

2C∗

n − 1

cβ,d +

cβ

(n − 1)!

(n − 1)!

c∗

β,d(cid:17)kvkVu .

In view of (3.8) it follows that

kDΛK ′

ΛρΛ − DK ′ρkX

Λ′′ = kDΛ′′PΛ′′ (K ′

ΛρΛ − K ′ρ)kX

Λ′′

≤ kDΛ′′ kX

Λ′′ kK ′

ΛρΛ − K ′ρkX

Λ′′ ≤ e2βB+1(cid:16)Cβε +

2C∗Cβ

cβ

cβ,d + 2C∗c∗

β,d(cid:17)kvkVu ,

which can be made arbitrarily small by choosing |Λ∗| and |Λ| suﬃciently big, uniformly
for all v ∈ Vu with kvkVu ≤ 1.

Since

A′

ΛρΛ − A′ρ = (D′

ΛKΛρΛ − D′Kρ) + (DΛK ′

ΛρΛ − DK ′ρ)

we thus have established the assertion.

As mentioned before another ingredient to the proof of Theorem 2 is the state-

ment (4.4), which we reformulate here in a slightly more precise way.

Lemma 4.2. Let u satisfy the assumptions of Theorem 1 and let A′ be deﬁned as
above for a given v ∈ Vu. Then, for a ﬁxed box Λ′ ⊂ R3 and for Λ′ ⊂ Λ ⊂ R3 the
convergence

k(I − zAΛ)−1PΛA′ρ − (I − zA)−1A′ρkX

Λ′ → 0

as |Λ| → ∞

holds true uniformly for all v ∈ Vu with kvkVu ≤ 1.

Note that if one replaces A′ρ by e1 in (4.4) then the resulting assertion is that
ρΛ converges uniformly to ρ in the given box Λ′ as |Λ| → ∞, cf. (3.9).
In fact,
one can reuse the corresponding proof of Ruelle [9, Theorem 4.2.3] with α = A′ρ
instead of α = e1 throughout to verify (4.4). The proof of Lemma 4.2 is then an easy
consequence because the rate of convergence only depends on the norm of α, and

kA′ρkX

R3 ≤ k∂AkL (Vu,L (X

R3 ))kvkVukρkX

R3

(4.9)

is uniformly bounded for kvkVu ≤ 1; take note that an upper bound for (4.9) can be
chosen in a way to be also an appropriate bound for kA′

ΛρΛkXΛ.

Proof of Theorem 2. We now turn to a proof of (4.5). To this end we consider a

ﬁnite number of nested boxes

Λ′ = Λk0 ⊂ Λk0−1 ⊂ · · · ⊂ Λ1 ⊂ Λ ,

(4.10)

14

M. HANKE

each of them centered at the origin, and Λk having sides of length

ℓk = ℓ0 + 2(k0 − k)d ,

k = 1, . . . , k0 ,

where ℓ0 is the length of the sides of the given box Λ′. The particular number k0
will be chosen later; see (4.12) below. With each box Λk we associate the Banach
space Xk = XΛk , the corresponding projector Pk = PΛk of (4.1), and the operator
Ak = AΛk ∈ L (Xk). As before we refer to A = AR3 for the operator corresponding
to the full space.

At this stage we quote another auxiliary result, cf. [9, (2.41) in Chapter 4], namely

that

kPk+1Ak

1P1 − Pk+1Ak

ΛkL (XΛ,Xk+1) ≤ 2ke2βB+1kAΛkk−1

L (XΛ)cβ,d

≤ 2kck−1

β

ek(2βB+1)cβ,d

(4.11)

for k = 0, 1, . . . , k0 − 1. In [9] this result was proved with AΛ replaced by A (and in
L (XR3 , Xk+1)), however, the argument given there does not need any modiﬁcation
to establish (4.11) as it stands. From (4.11) it follows that

kAk

ΛPΛ(A′ρ − A′

ΛρΛ)kXk+1

≤ k(Ak

1P1 − Ak

Λ)PΛ(A′ρ − A′

ΛρΛ)kXk+1 + kAk

1P1(A′ρ − A′

ΛρΛ)kXk+1

≤ 2kck−1

β

ek(2βB+1)cβ,dkA′ρ − A′

ΛρΛkXΛ + ck

βek(2βB+1)kA′ρ − A′

ΛρΛkX1 ,

and hence, the representation

(I − zAΛ)−1PΛ(A′ρ − A′

ΛρΛ)

=

k0−1Xk=0

zkAk

ΛPΛ(A′ρ − A′

ΛρΛ) +

∞Xk=k0

leads to the upper bound

k(I − zAΛ)−1PΛ(A′ρ − A′

ΛρΛ)kX

Λ′

zkAk

ΛPΛ(A′ρ − A′

ΛρΛ)

zkkAk

ΛPΛ(A′ρ − A′

ΛρΛ)kXk+1 +

zkkAΛkk

XΛkA′ρ − A′

ΛρΛkXΛ

∞Xk=k0

2kck−1

β

(ze2βB+1)kcβ,d kA′ρ − A′

ΛρΛkXΛ

≤

≤

k0−1Xk=0
k0−1Xk=0
k0−1Xk=0

+

(zcβe2βB+1)kkA′ρ − A′

ΛρΛkX1 +

(zcβe2βB+1)kkA′ρ − A′

ΛρΛkXΛ .

∞Xk=k0

By virtue of (4.9) kA′ρkX
a constant c > 0 (depending only on z and β) with

R3 and kA′

ΛρΛkXΛ are uniformly bounded, hence there exists

k(I − zAΛ)−1PΛ(A′ρ − A′

ΛρΛ)kX

Λ′

≤ c(cid:0)cβ,d + kA′ρ − A′

ΛρΛkX1 + (zcβe2βB+1)k0(cid:1) ,

(4.12)

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

15

provided that kvkVu ≤ 1 and z and β satisfy (2.9).

Now let ε > 0 be given. By virtue of (2.9) and (4.7) we can choose d and k0
so large that the ﬁrst and third summand on the right-hand side of (4.12) are both
smaller than ε/(3c). A corresponding choice of nested boxes Λk of (4.10) is possible
provided that Λ is suﬃciently big. In fact, making |Λ| even larger the second term on
the right-hand side of (4.12) will also become less than ε/(3c) by virtue of Lemma 4.1,
uniformly for v ∈ Vu with kvkVu ≤ 1. Accordingly, there holds

k(I − zAΛ)−1PΛ(A′ρ − A′

ΛρΛ)kX

Λ′ ≤ ε

for |Λ| suﬃciently large, which yields (4.5). Again we emphasize that the size of |Λ|
to achieve a given bound ε > 0 does not depend on v as long as kvkVu ≤ 1.

As mentioned before, a combination of (4.5) and (4.4), cf. Lemma 4.2, implies

that

k(∂ρΛ)v − (∂ρ)vkX

Λ′ → 0

as |Λ| → ∞ ,

uniformly for all v ∈ Vu with kvkVu ≤ 1.

5. Explicit computation of the derivatives of the singlet and pair dis-
tribution functions. In the sequel we are going to determine more suitable and
implementable formulae for the derivatives of the ﬁrst two molecular distribution
functions in a ﬁnite size box Λ ⊂ R3.

For a given v ∈ Vu with kvkVu ≤ t0 we write

VN (RN ) = X1≤i<j≤N

v(|Ri − Rj|)

(5.1)

in analogy to (2.6). Then, to begin with, a straightforward formal computation pro-
vides the derivative ∂ ΞΛ of the grand canonical partition function (2.8):

(∂ ΞΛ)v = −β

zN

N !ZΛN

∞XN =2

VN (RN )e−βUN (RN ) dRN .

That ∂ ΞΛ is a Fr´echet derivative in L (Vu, R) can readily be checked by following
the line of argument of the proof of Lemma 3.2. Since VN is deﬁned by a pairwise
interaction of identical particles we can rewrite this derivative in the simpler form
(cf., e.g., Ben-Naim [1, Sect. 3.1], or the arguments employed below),

(∂ ΞΛ)v = −

β

2ZΛZΛ

v(|R − R′|)ρ(2)

Λ (R, R′) dR dR′ ,

which is amenable to numerical computations.

The argument of Lemma 3.2 can also be used to determine the Fr´echet derivatives
Λ ∈ L (Vu, L∞(Λm)) of the numerators

∂Z (m)

Z (m)

Λ (Rm) =

∞XN =m

zN

(N − m)!ZΛN −m

e−βUN (RN ) dRm,N

of the molecular distribution functions ρ(m)

Λ , namely

(cid:0)(∂Z (m)

Λ )v(cid:1)(Rm) = −β

∞XN =m

zN

(N − m)!ZΛN −m

VN (RN )e−βUN (RN ) dRm,N .

16

M. HANKE

For m = 1 we can utilize (5.1) and the fact that individual particles are indistinguish-
able to reformulate

v(|Ri − Rj|) e−βUN (RN ) dR1,N

e−βUN (RN ) dR2,N dR2

v(|Ri − Rj|)e−βUN (RN ) dR1,N!

e−βUN (RN ) dR2,N dR2

(cid:0)(∂Z (1)

Λ )v(cid:1)(R1) = −β

∞XN =2

zN

(N − 1)!ZΛN −1 X1≤i<j≤N

= −β

∞XN =2

zN

(N − 1)! (N − 1)ZΛ

v(|R1 − R2|)ZΛN −2

+ X2≤i<j≤NZΛN −1
v(|R1 − R2|)ZΛN −2
v(|R2 − R3|)ZΛN −3
2ZΛZΛ

Λ (R2) dR2 −

β

zN

= −β

(N − 2)!ZΛ
∞XN =2
(N − 3)!ZΛZΛ
∞XN =3
= −βZΛ

v(|R1 − R2|)Z (2)

β
2

zN

−

e−βUN (RN ) dR3,N dR3 dR2

v(|R2 − R3|)Z (3)

Λ (R3) dR3 dR2 .

Likewise we obtain

(cid:0)(∂Z (2)

Λ )v(cid:1)(R1, R2) = −β

= −β

zN

zN

∞XN =2

(N − 2)!ZΛN −2
(N − 2)! v(|R1 − R2|)ZΛN −2
v(|R1 − R3|)ZΛN −3
v(|R2 − R3|)ZΛN −3

∞XN =2
+ (N − 2)ZΛ
+ (N − 2)ZΛ

VN (RN )e−βUN (RN ) dR2,N

e−βUN (RN ) dR2,N

e−βUN (RN ) dR3,N dR3

e−βUN (RN ) dR3,N dR3

+

(N − 2)(N − 3)

2

which can be rewritten as

ZΛZΛ

v(|R3 − R4|)ZΛN −4

e−βUN (RN ) dR4,N dR4 dR3! ,

(cid:0)(∂Z (2)

Λ (R2)

v(|R1 − R3|)Z (3)

Λ )v(cid:1)(R1, R2) = −β v(|R1 − R2|)Z (2)
Λ (R3) dR3 − βZΛ
− βZΛ
2ZΛZΛ

v(|R3 − R4|)Z (4)

Λ (R4) dR4 dR3 .

−

β

v(|R2 − R3|)Z (3)

Λ (R3) dR3

FRECHET DIFFERENTIABILITY OF MOLECULAR DISTRIBUTION FUNCTIONS

17

After these preparations we can employ the quotient rule to obtain

(cid:0)(∂ρ(1)

Λ )v(cid:1)(R1) =

Λ )v(cid:1)(R1) − ρ(1)

Λ (R1)

(∂ ΞΛ)v

ΞΛ

v(|R1 − R′|)ρ(2)

Λ (R1, R′) dR′

v(|R′

1 − R′

2|)ρ(3)

Λ (R1, R′

1, R′

2) dR′

2 dR′
1

v(|R′

1 − R′

2|)ρ(1)

Λ (R1)ρ(2)

Λ (R′

1, R′

2) dR′

2 dR′
1

and

(cid:0)(∂ρ(2)

1

ΞΛ(cid:0)(∂Z (2)

Λ )v(cid:1)(R1, R2) − ρ(2)

Λ (R1, R2)

(∂ ΞΛ)v

ΞΛ

= −β v(|R1 − R2|)ρ(2)

Λ (R1, R2)

(5.2)

(5.3a)

(5.3b)

(5.3c)

1

ΞΛ(cid:0)(∂Z (1)
= −βZΛ
2ZΛZΛ
2ZΛZΛ

−

+

β

β

Λ )v(cid:1)(R1, R2) =
− βZΛ
− βZΛ
− βZΛZΛ
2ZΛZΛ

+

β

1
2

v(|R1 − R′|)ρ(3)

Λ (R1, R2, R′) dR′

v(|R2 − R′|)ρ(3)

Λ (R1, R2, R′) dR′

v(|R′

1 − R′

2|)ρ(4)

Λ (R1, R2, R′

1, R′

2) dR′

1 dR′
2

v(|R′

1 − R′

2|)ρ(2)

Λ (R1, R2)ρ(2)

Λ (R′

1, R′

2) dR′

2 dR′
1 .

Remark 5.1. To illustrate (5.3) imagine the situation of a ﬁxed pair of coor-
dinates R1, R2 ∈ Λ with R1 6= R2, when v = v(r) is a delta distribution located in
r′ > 0. Then the three integrals in (5.3a)–(5.3c) provide the expected number of
events – up to a factor 4πr′2 due to the polar coordinate transformation – of en-
countering at the same time a pair of particles at R1 and R2 and a diﬀerent pair of
particles with distance r′. The three individual terms account for events where
(5.3a): R1 is one of the two members of the second pair of particles,
(5.3b): R2 is one of the two members of the second pair of particles,
(5.3c): all four particles involved are diﬀerent; during integration every second pair

of particles is counted twice, hence the extra factor 1/2.

This agrees with the formula provided in [7].

Finally we mention that neither of the two representations of (∂ρ(1)

⋄
Λ )v
has a straightforward extension to the thermodynamical limit. To extend these for-
mulae to the thermodynamical limit the double integrals need to be recombined. This
will be reconsidered in part II of this work [3].

Λ )v and (∂ρ(2)

6. Conclusions. We have shown that for a grand canonical ensemble of iden-
tial point-like particles in thermodynamical equilibrium the molecular distribution
functions ρ(m)
and their thermodynamical limits ρ(m) are diﬀerentiable with respect
to the underlying pair potential and the L∞ norm of the distribution functions. To
do so we have considered pair potentials that satisfy Assumption A which is slightly

Λ

18

M. HANKE

stronger than just being stable and regular; for these potentials we can treat the entire
regime of small activities z > 0 for which the thermodynamical limit of the molecular
distribution functions is known to be well-deﬁned. In physical terms these activities
correspond to a region without phase transitions, i.e., the gas phase of this molecular
ﬂuid, cf. [9].

Assumption A comes with a natural topology to study perturbations v of u: On
the one hand perturbations must not be too strong to violate the repulsive nature of
the potential when particles get close, hence, |v| must be bounded by u near the origin;
on the other hand, perturbations must be suﬃciently small for distant particles to
maintain regularity. We mention, though, that the choice of u∗ allows rather general
decay rates of the underlying potential u and its perturbations v; as a consequence
the latter can by far dominate the underlying potential near inﬁnity.

We have also proved that the derivative of ρ(m)

Λ converges compactly to the deriva-
tive of ρ(m) as |Λ| → ∞. This justiﬁes the approximate computation of, say, the
derivative of the radial distribution function (an often-used structural quantity in
chemical physics) by numerical particle simulations in a ﬁnite size box, as suggested
in [7].

In a subsequent paper [3] we will reconsider the pair distribution function ρ(2)
Λ
and the corresponding radial distribution function g = g(r) because they call for the
investigation of diﬀerentiability in another function space that reﬂects the property
that g(r) → 1 as r → ∞ for potentials u that satisfy Assumption A. The methods that
come to use in [3] employ cluster expansions and are of completely diﬀerent nature
than the ones that have been utilized here.

REFERENCES

1. A. Ben-Naim, Molecular Theory of Solutions, Oxford University Press, New York (2006).
2. M.E. Fisher and D. Ruelle, The stability of many-particle systems, J. Math. Phys. 7, 260–270

(1966).

3. M. Hanke, Fr´echet diﬀerentiability of molecular distribution functions II. The Ursell function,

manuscript, 2016.

4. J.-P. Hansen and I.R. McDonald, Theory of Simple Liquids, Academic Press, Oxford, Fourth

ed. (2013).

5. R.L. Henderson, A uniqueness theorem for ﬂuid pair correlation functions, Phys. Lett. A 49,

197–198 (1974).

6. L. Koralov, An inverse problem for Gibbs ﬁelds with hard core potential, J. Math. Phys. 48

053301 (2007).

7. A.P. Lyubartsev and A. Laaksonen, Calculation of eﬀective interaction potentials from radial
distribution functions: A reverse Monte Carlo approach, Phys. Rev. E 52, 3730–3737 (1995).
8. V. R¨uhle, C. Junghans, A. Lukyanov, K. Kremer, and D. Andrienko, Versatile object-
oriented toolkit for coarse-graining applications, J. Chem. Theory Comput. 5, 3211-3223
(2009).

9. D. Ruelle, Statistical Mechanics: Rigorous Results, W.A. Benjamin Publ., New York (1969).

