6
1
0
2

 
r
a

M
3

 

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
7
6
1
1
0

.

3
0
6
1
:
v
i
X
r
a

On Composite Discontinuous Galerkin Method

for simulations of electric properties of

semiconductor devices

Konrad Sakowski∗ 1,3, Leszek Marcinkowski3, Pawel Strak1, Pawel

Kempisty1, and Stanislaw Krukowski1,2

1Institute of High Pressure Physics, Polish Academy of Sciences,

ul. Sokolowska 29/37, 01-142 Warsaw, Poland

2Interdisciplinary Centre for Materials Modeling, Warsaw
University, ul. Pawińskiego 5a, 02-106 Warsaw, Poland

3Department of Mathematics, Computer Science and Mechanics,

Warsaw University, ul. Banacha 2, 02-097 Warsaw, Poland

March 4, 2016

Abstract

In this paper two variants of discretization of the van Roosbroeck’s
equations in equilibrium state with the Composite Discontinuous Galerkin
Method for rectangular domain are discussed. They base on Weakly
Over-Penalized Symmertic Interior Penalty (WOPSIP) method and on
Symmetric Interior Penalty Galerkin (SIPG) method.
It is shown that
the discrete problems are well-deﬁned and that their solutions are unique.
Error estimates are derived. Finally numerical simulations of gallium ni-
tride semiconductor devices are presented.

1

Introduction

Numerical simulations are the important tool in development of semiconductor
devices. Since our contemporary electronics relies on the semiconductors, there
is strong demand on the progress in this domain. Examples of such devices
are light emitting diodes, lasers, transistors, detectors, and many others. There
are various approaches in simulations of such devices, depending on precision,
eﬃciency and size of a simulated fragment. On the one hand there are so-called
ab initio methods, which are used to investigate properties of elements com-
posed of hundreds of thousands of atoms. These methods use fundamental laws
of physics and they need days or weeks to to perform a single simulation on
a computational cluster. On the other hand there is a drift-diﬀusion theory.

∗konrad@unipress.waw.pl

1

In this case the model is much simpler and it allows to simulate whole semi-
conductor device on a standard desktop computer. This model describes two
kinds of carriers, electrons and holes, which move in the electric ﬁeld present
in semiconductor devices. From the mathematical point of view, it consists of
a system of three nonlinear elliptic diﬀerential equations, which are called van
Roosbroeck equations [14].

Numerical modelling of semiconductor devices with the drift-diﬀusion model
are performed since 1964, when Gummel [8] proposed a numerical algorithm
based on the simple iteration method. Various methods were used for discretiza-
tion of the van Roosbroeck equations, for example Finite Diﬀerence Method
[17], Box method [1], Finite Element Method (FEM) [6]. Special variants of
discretizations optimized for the so-called continuity equations were developed
[11].

In our study, we are interested in laser and electroluminescent diodes based
on gallium nitride. These devices have particular structure. They are composed
of layers deposited one on another. These layers vary in material composition,
doping level, dopant type or length, and they form a natural partition of a
device. They are usually cuboids (see ﬁgure 1). In general, in these devices there
are three important parts: two contacts and the active region. A potential can
be applied to the contacts and then some current will ﬂow through the device.
Then, in the active region, the recombination occurs and fotons are generated.
Due to such a structure, it is often suﬃcient to use one-dimensional model for
simulations of the laser diodes and the electroluminescent diodes, because unless
a device has some special design, the current ﬂows more or less in the straight
line between the contacts. However, to take into account more sophisticated
designs, more spatial domensions have to be used.

Motivated by this problem, in this paper we study the Composite Discon-
tinuous Galerkin Method discretizations. In these methods, ﬁrst we pick some
partition {Ωi}N
i=1 of a domain Ω. Then on every element Ωi we introduce some
triangulation and a Finite Element space Xhi(Ωi). These triangulations may be
independent of each other, i.e. they do not need to agree on interfaces ∂Ωi ∩∂Ωj.
Finally we search for a discrete solution, which is in the space Xhi(Ωi) on every
Ωi. On the interfaces we use a variant of the Discontinuous Galerkin Method
(DGM) to “glue” functions from the diﬀerent partition elements together.

Our interest in application of these methods to modelling of the semiconduc-
tor luminescent devices is caused by the following reasons. First, the natural
division of these devices described above is a good candidate for a partition of a
computational domain Ω. It is so because the discontinuities of the coeﬃcients
are often on interfaces between layers due to variations of material parame-
ters. Also it is often the case that one could easily predict on which layers the
variations of the unknown functions are more frequent than on the others, due
to physical properties of the device. Therefore it convenient to use separate
meshes, as there is no problem in mesh reﬁnement in arbitrary layers.

We start with introduction of the diﬀerential problem in section 2. We
propose two variants of Composite DGM discretization of this problem in section
3. Then we show existence and uniqueness of the introduced discrete problems
in sections 4, 5. In section 6 we discuss interpolation properties of the discrete
space. Then we pass to the error estimates in section 7. Finally we present
results of numerical simulations in section 8 and we conclude in section 9.

2

p-Al GaN

0.3

(10 nm)

In GaN

10%

/In GaN:Mg
(45 Å / 80 Å) * 5 MQW

4%

p-GaN (50 nm)

p-GaN/p-Al GaN
(26 Å / 26 Å) * 80 SL

0.16

p-GaN (70 nm)

In GaN:Si

0.04

(8 nm)

n-GaN (140 nm)

n-GaN/Al GaN
0.16
)*110 SL
(
29 Å / 29Å

GaN:Si (530 nm)

bulk  n-GaN

Figure 1: Example of a gallium nitride semiconductor laser structure.

2 Diﬀerential problem

The drift-diﬀusion model describes relationship between the electrostatic poten-
tial and the charge carrier concentrations: electrons and holes [19, 18]. Physical
derivation of this model is beyond the scope of this work, therefore we will focus
on the mathematical standpoint.

We start with the domain Ω of our problem. Luminescent semiconductor
devices are generally made of planar layers deposited one on another, which
vary in composition of a semiconductor material or number of impurities (see
ﬁgure 1). At opposite ends metal contacts are attached, where the current can
be applied. If this is the case, it ﬂows through the device perpendicular to the
deposited layers. We assume that Ω is a rectangle.

In this paper we deal with so-called equilibrium state. It is a physical state
of a semiconductor device, where the device is disconnected from power sources,
so the current does not ﬂow through it. Then only the Poisson equation needs
to be solved and the system reduce to the following problem: ﬁnd u∗ ∈ H 1(Ω),
such that

−∇(cid:16)ε(x)∇u∗(cid:17) + eu∗−ˆv − e ˆw−u∗

= k1,

u∗ = ˆu on ΣD,
∇u∗ · ν = 0 on ΣN .

(1)

where ˆv = ˆw ≡ const. Since some results of this paper may be also applied to
non-equilibrium case, we consider more general assumption that ˆv, ˆw ∈ L∞(Ω).
Also we assume that ε, ˆu ∈ H 1(Ω) ∩ L∞(Ω) and 0 < εm ≤ ε ≤ εM , εm, εM ∈ R.

3

7

8

1

2

9

3

10

11

12

4

5

6

Figure 2: An example of two-dimensional coarse grid of Ω.

The following lemma is essential for the results presented in this paper. Its

proof may be found in [9].

Lemma 2.1. Solution u∗ of problem (1) is bounded.

A weak formulation of the diﬀerential problem (1) is as follows. Find u∗ ∈

ˆu + H 1(Ω), such that

a(u∗, ϕ) + b(u∗, ϕ) = f (ϕ) ∀ϕ ∈ H 1

0,ΣD (Ω),

where

ε(x)∇u(x) · ∇ϕ(x) dx

a(u, ϕ) :=ZΩ
b(u, ϕ) :=ZΩ(cid:16)eu(x)−ˆv(x) − e ˆw(x)−u(x)(cid:17)ϕ(x) dx.
f (ϕ) :=ZΩ

k1(x)ϕ(x) dx.

We use the following notation:

C∞

0,ΣD (Ω) := {f ∈ C∞(Ω) : f |ΣD ≡ 0},

H 1

0,ΣD (Ω) := clH 1(Ω)(cid:16)C∞

0,ΣD (Ω)(cid:17).

(2)

(3)

(4)

3 Discretization

3.1 Discrete space

Let Ω ⊂ R2 be a rectangle, divided to disjoint subrectangles {Ωi}N
i=1 =: E in
such a manner that E is a triangulation of Ω (ﬁgure 2). We will call this division
a coarse grid and we assume that each edge of any Ωi is contained either in ΣD
or in ΣN .

Let us deﬁne triangulations Thi := Ti,hi (Ωi), where hi := max{diam(τ ) : τ ∈
Thi }. By Nhi we denote the nodes of the triangulation Thi . We assume that
{Ti,hi(Ω)}hi is a regular uniform family of triangulations [5]. We will deﬁne

4

i=1 Thi. For s > 0, we deﬁne the broken Sobolev spaces H s(E) and

Th := SN

H s(Th) as

H s(E) := {v ∈ L2(Ω) : ∀i ∈ {1, . . . , N } vi := v|Ωi ∈ H s(Ωi)} ⊂ L2(Ω),
H s(Th) := {v ∈ L2(Ω) : ∀τ ∈ Th v|τ ∈ H s(τ )} ⊂ L2(Ω).

(5)

Then on every Ωi we deﬁne a discrete space Xhi(Ωi) of piecewise linear functions
on the triangulation Thi:

Finally we deﬁne Xh(Ω) as

Xhi := Xhi(Ωi) :=nuh,i ∈ C(Ωi) : ∀τ ∈ Thi uh,i(cid:12)(cid:12)τ ∈ P1(τ )o
Xh(Ω) =n(uh,1, . . . , uh,N ) : uh,i ∈ Xhi(Ωi), i ∈ {1, . . . , N }o ⊂ L2(Ω).

(6)

(7)

Note that Xh(Ω) 6⊂ H 1(Ω) and Xh(Ω) 6⊂ H 2(E), but Xh(Ω) ⊂ H 1(E), H 1(Ω) ⊂
H 1(E) and Xh(Ω) ⊂ H 2(Th).

By Γ we denote a set of all internal and boundary edges of E. Then Γ is a

sum of disjoint sets ΓD, ΓN and ΓI , where

ΓD := {e ∈ Γ : e ⊂ ΣD},
ΓN := {e ∈ Γ : e ⊂ ΣN },
ΓI := {e ∈ Γ : e ⊂ int(Ω)}.

(8)

Therefore ΓD (resp. ΓN ) contains edges lying on the boundary where Dirichlet
(resp. Neumann) boundary conditions are imposed and in ΓI there are all
internal edges, which we call interfaces, as they frequently correspond to the
physical interfaces between diﬀerent semiconductor materials. We also deﬁne

ΓDI := ΓD ∪ ΓI , Γi := {e ∈ Γ : e ⊂ ∂Ωi}.

(9)

Let e ∈ Γ. Then two cases are possible. Either e ∈ ΓD ∪ ΓN , so there is an
unique Ωi such that e is an edge of Ωi, or e ∈ ΓI and there are exactly two sets
Ωi, Ωj ∈ E such that e is their common edge. We will often refer to these two
cases. Also we deﬁne nb(Ωi) := {Ωk ∈ E : Γi ∩ Γk 6= ∅}.

For s > 1/2 we deﬁne operators [·] := [·]e : H s(E) → L2(e), {·} := {·}e :

H s(E) → L2(e) as

ui

[u] :=(ui − uj
{u} :=( 1

2(cid:0)ui + uj(cid:1)

ui

if e ⊂ ΓI , e = ∂Ωi ∩ ∂Ωj,
if e ⊂ ΓD ∪ ΓN , e = ∂Ωi ∩ ∂Ω,

if e ⊂ ΓI , e = ∂Ωi ∩ ∂Ωj,
if e ⊂ ΓD ∪ ΓN , e = ∂Ωi ∩ ∂Ω.

(10)

For convenience, we will also use this notion for triangulation parameters, i.e.

{h−s} :=n 1

hso :=


hs
i

1

2(cid:16) 1

1
hs
i

+ 1
hs

j(cid:17)

if e = ∂Ωi ∩ ∂Ωj,

if e = ∂Ωi ∩ ∂Ω.

(11)

5

For further analysis, we introduce so-called “broken” norm k · kh,σr in Xh(Ω)

with

kuhk2

h,σr :=

N

Xi=1ZΩi

ε(cid:16)∇uh,i(cid:17)2

dx + Xe∈ΓDI

ηr,eZe

[uh]2 ds.

(12)

Here ηr,e is a penalty coeﬃcient for e. It depends on the triangulation parame-
ters and penalty parameters σe > 0:

(13)

ηr,e := 2σe{h−r} =(2σeh−r
σe(cid:16)h−r

i
i + h−r

e ∈ ΓD, e ⊂ Ωi,

j (cid:17) e ∈ ΓI , e ⊂ Ωi ∩ Ωj.

Depending on the method, we will use r = 1 or r = 2.

To simplify the analysis, we assume that 0 < σ0 ≤ σe for all e ∈ ΓDI . Also
we assume that 0 < hi < h0 ≤ 1 for all i ∈ {1, . . . , N }. The choice of σ0 and h0
will be discussed later in lemmata 3.2, 3.3 and 7.2.

Lemma 3.1. For any uh ∈ Xh(Ω), Ωi ∈ E and e ∈ Γi, the following estimates
hold

kuh,ikL2(e) ≤ Ch−1/2
k∇uh,i · νkL2(e) ≤ Ch−1/2

i

i

kuhkL2(Ωi),

|uh|H 1(Ωi).

(14)

(15)

Constant C does not depend on hi.

Proof. These estimates are a consequence of the trace theorem applied to each
edge of ﬁne elements in Ωi coincident with e followed by a scalling argument.

3.2 Composite Discontinuous Galerkin variants

We propose two variants of the Composite Discontinuous Galerkin discretiza-
tion. First one is based on Weakly Over-Penalized Symmetric Interior Penalty
(WOPSIP) method (cf.
[3] or [2]). Second formulation is derived from Sym-
metric Interior Penalty Galerkin (SIPG) method (cf. [13] or [12]). In each case
we use the composite formulation (cf.
inside every Ωi we use the Fi-
nite Element Method on the triangulation Thi, while on boundaries e ∈ ΓDI we
use the respective variant of the Discontinuous Galerkin Method. Thus we call
these methods Composite Weakly Over-Penalized Symmetric Interior Penalty
(CWOPSIP) method and Composite Symmetric Interior Penalty Galerkin (CSIPG)
method, respectively.

[7]), i.e.

3.2.1 Composite Weakly Over-Penalized Symmetric Interior Penalty

(CWOPSIP)

This discretization has a simpler formulation from the two methods we intro-
duce. The discrete problem is deﬁned as follows. Find u∗
h ∈ Xh(Ω) such that

a2,h(u∗

h, ϕh) + b(u∗

h, ϕh) = f2,h(ϕh),

∀ϕh ∈ Xh(Ω),

(16)

6

where

a2,h(uh, ϕh) =

N

ε∇u∗

Xi=1ZΩi
k1ϕh dx + Xe∈ΓD

f2,h(ϕh) =ZΩ

h,i · ∇ϕh,i dx + Xe∈ΓDI

η2,eZe

[uh] · [ϕh] ds,

(17)

η2,eZe

[ˆu] · [ϕh] ds,

and b is deﬁned as in (3).

3.2.2 Composite Symmetric Interior Penalty Galerkin (CSIPG)

This problem is deﬁned as follows. Find u∗

h ∈ Xh(Ω) such that

a1,h(u∗

h, ϕh) + b(u∗

h, ϕh) = f1,h(u∗

h, ϕh),

∀ϕh ∈ Xh(Ω),

(18)

where

a1,h(uh, ϕh) =

h,i · ∇ϕh,i dx − Xe∈ΓDIZe
{ε∇ϕh · ν}[uh] ds + Xe∈ΓDI

N

ε∇u∗

Xi=1ZΩi
− Xe∈ΓDIZe
k1ϕh dx − Xe∈ΓDIZe
+ Xe∈ΓD

η1,eZe

[ˆu][ϕh] ds,

{ε∇ϕh · ν}[ˆu] ds

f1,h(ϕh) =ZΩ

{ε∇uh · ν}[ϕh] ds

η1,eZe

[uh] · [ϕh] ds,

(19)

and b is deﬁned as in (3).

Lemma 3.2. For any α ∈ (0, 1) there exist σ0 > 0, such that for every σe ≥ σ0
and uh ∈ Xh(Ω)

2 Xe∈ΓDI(cid:12)(cid:12)(cid:12)Ze

{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)

≤ αkuhk2

h,σ1 ,

(20)

Proof. Let us take any e = Ωj ∩ Ωk. By the Schwarz inequality and a triangle
inequality

2Ze
(cid:12)(cid:12)(cid:12)

{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)

≤(cid:16)(cid:13)(cid:13)ε|Ωj ∇uh,j · ν(cid:13)(cid:13)L2(e)
+(cid:13)(cid:13)ε|Ωk ∇uh,k · ν(cid:13)(cid:13)L2(e)(cid:17)(cid:13)(cid:13)[uh](cid:13)(cid:13)L2(e)

Taking Ωi ∈ {Ωj, Ωk}, we use the Cauchy’s ǫ-inequality and lemma 3.1

(21)

(cid:13)(cid:13)ε|Ωi∇uh,i · ν(cid:13)(cid:13)L2(e)(cid:13)(cid:13)[uh](cid:13)(cid:13)L2(e)
≤ ǫεM hi(cid:13)(cid:13)∇uh,E(cid:13)(cid:13)
≤ ǫεM(cid:13)(cid:13)∇uh(cid:13)(cid:13)

2
L2(e) +
1
4ǫ

2
L2(Ωi) +

1
4ǫ

εM

7

2
L2(e)

(22)

1

εM

1

hi(cid:13)(cid:13)[uh](cid:13)(cid:13)
hi(cid:13)(cid:13)[uh](cid:13)(cid:13)

2
L2(e).

2
L2(Ωj ) + εM

1
2ǫ

≤ 2εM ǫ(cid:13)(cid:13)∇uh(cid:13)(cid:13)

2
L2(e).

(23)

{h−1}(cid:13)(cid:13)[uh](cid:13)(cid:13)

On the other hand, if e ∈ ΓD then e ∈ ∂Ωi ∩ ∂Ω and by similar arguments we
have

Therefore we get

(cid:12)(cid:12)(cid:12)

2Ze

{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)
2Ze

(cid:12)(cid:12)(cid:12)

Summing these results up we get

{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)
2 Xe∈ΓDI(cid:12)(cid:12)(cid:12)Ze

≤ 2εM ǫ(cid:13)(cid:13)∇uh(cid:13)(cid:13)
{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)

2
L2(Ωi) + εM

1
ǫ

2
L2(e)

{h−1}(cid:13)(cid:13)[uh](cid:13)(cid:13)

≤ ǫC

k∇uhk2

L2(Ωi)

N

Xi=1
ǫ Xe∈ΓDI

C

+

2
L2(e),

{h−1}(cid:13)(cid:13)[uh](cid:13)(cid:13)

(24)

(25)

where C depends on εM and the maximal number of edges of elements in coarse
grid E. Finally for any α ∈ (0, 1) if we take ǫ := αεm/C and then taking
σ0(α) := C2/α2εm we have

2 Xe∈ΓDI(cid:12)(cid:12)(cid:12)Ze

{ε∇uh · ν}[uh] ds(cid:12)(cid:12)(cid:12)

εmk∇uhk2

L2(Ωi)

N

≤ α

Xi=1
+ α Xe∈ΓDI

≤ αkuhk2

h,σ1.

C2

εmα2 {h−1}(cid:13)(cid:13)[uh](cid:13)(cid:13)

2
L2(e)

(26)

Lemma 3.3. There exist σ0 > 0 and c > 0, such that for every σe ≥ σ0 and
uh ∈ Xh(Ω)

ckuhk2

h ≤ ah,1(uh, uh).

(27)

Proof. Due to deﬁnition of broken norm, we have

ah,1(uh, uh) = kuhk2

h,σ1 − 2 Xe∈ΓDIZe

{ε∇uh · ν}[uh]ds.

(28)

Let us take α := 1/2 in lemma 3.2. Then we have

ah,1(uh, uh) = kuhk2

{ε∇uh · ν}[uh]ds

h,σ1 − 2 Xe∈ΓDIZe

≥ kuhk2

h,σ1 −

kuhk2

h,σ1 ≥

(29)

1
2

kuhk2

h,σ1.

1
2

8

4 Existence

Let us denote the nodal base of Xh by {ϕ(j)}J
X ∗

h(Ω) as

We would like to use the following theorem [10]:

P (uh)ϕh := ar,h(cid:0)uh, ϕh(cid:1) + b(cid:0)uh, ϕh(cid:1) − fr,h(cid:0)ϕh(cid:1).

i=1. Then we deﬁne P : Xh(Ω) →

(30)

Theorem 4.1. (Brouwer) Let P : X → X ∗ be a continuous function on a
ﬁnite-dimensional normed real vector space X, such that for suitable ρ > 0 we
have

Then there exists x ∈ X, kxk ≤ ρ such that

P (x)x ≥ 0 ∀kxk ≥ ρ,

P (x) = 0.

4.1 Case of CWOPSIP

By deﬁnition (30)

P (uh)uh := a2,h(cid:0)uh, uh(cid:1) + b(cid:0)uh, uh(cid:1) − f2,h(cid:0)uh(cid:1),

Then we have that

On the other hand, by Schwarz inequality

a2,h(cid:0)uh, uh(cid:1) = kuhk2

h,σ2.

Then let C := max{kˆvkL∞(Ω), k ˆwkL∞(Ω)}. Then we may decompose Φ2 as

−f2,h(cid:0)uh(cid:1) ≥ −c(ˆu, k1)kuhkL2(Ω) ≥ −c(ˆu, k1, h)kuhkh,σ2
b(cid:0)uh, uh(cid:1) =ZΩ(cid:16)euh−ˆv − e ˆw−uh(cid:17)uhdx

=ZΩ(cid:16)euh−ˆv − e ˆw−uh(cid:17)uhχ{x∈Ω:|uh(x)|>C}dx
+ZΩ(cid:16)euh−ˆv − e ˆw−uh(cid:17)uhχ{x∈Ω:|uh(x)|≤C}dx

(31)

(32)

(33)

(34)

(35)

(36)

The ﬁrst integral is non-negative, and the latter we can estimate from below

ZΩ(cid:16)euh(x)−ˆv(x) − e ˆw(x)−uh(x)(cid:17)uh(x)χ{x∈Ω:|uh(x)|≤C}(x)dx ≥ −|Ω|2e2CC. (37)

In conclusion, we may use these estimations to obtain

P (uh)uh ≥ kuhk2

h,σ2 − c1kuhkh,σ2 − c2

(38)

Note that constants ci in this inequality depend on h.

It is therefore clear that for kuhkh,σ2 large enough, we have that P (uh)uh ≥
h) = 0.

0. Then by theorem 4.1 we have that there exists some u∗

h, such that P (u∗

9

4.2 Case of CSIPG

We proceed analogously to the CWOPSIP case. For b(uh, uh) the argumentation
is exactly the same. Then f1,h(uh) has one additional term, which may be
estimated using lemma 3.1 ant the trace inequality

(cid:12)(cid:12)(cid:12) Xe∈ΓDZe

{ε∇uh · ν}[ˆu] ds(cid:12)(cid:12)(cid:12)

k∇uhkL2(e)kˆukL2(e)

h−1/2
i

k∇uhkL2(Ωi)k[ˆu]kL2(Ωi)

(39)

≤ εM Xe∈ΓD
Xi=1

≤ cεM

N

≤ Ckuhkh,σ1kˆukL2(Ω),

where C depends on εM and h. Then estimating a1,h(uh, uh) by lemma (3.3),
we have

P (uh)uh ≥ c1kuhk2

h,σ1 − c2kuhkh,σ1 − c3

(40)

The existence of u∗

h is now proven.

5 Uniqueness

The uniqueness can be shown by contradiction for both cases. Here we present
the CWOPSIP case, for CSIPG the proof is similar.

Assume that there exist two solutions uh, vh ∈ Xh(Ω) of equation (18). Then
by taking ϕh := uh − vh in (18) and subtracting these equations for uh and vh
we obtain

a2,h(uh − vh, uh − vh) =

+

N

Xi=1ZΩi
Xi=1ZΩi

N

e−ˆv(cid:16)evh − euh(cid:17)(cid:16)uh − vh(cid:17) dx
e ˆw(cid:16)e−uh − e−vh(cid:17)(cid:16)uh − vh(cid:17) dx.

(41)

By monotonicity of the exponential function, the right hand side is nonpositive.
On the other hand

0 < kuh − vhk2

h,σ2 = a2,h(uh − vh, uh − vh).

(42)

Thus 0 < kuh − vhk2

h,σ2 ≤ 0 since uh 6= vh, and we have a contradiction.

6

Interpolation operator

First let us take any Ωi ∈ E and let us deﬁne interpolation operator Πhi
H 2(Ωi) → Xhi ⊂ C0(Ωi) as follows

:

∀x ∈ Nhi

Πhi u(x) = u(x).

(43)

Note that for s > 0 we have H 1+s(Ω) ⊂ C0(Ω) (see [13]), so this deﬁnition is
well-posed. Then we deﬁne Πh : H 2(E) → Xh by

∀Ωi ∈ E (cid:16)Πhu(cid:17)i

:= Πhiui.

10

(44)

On any Ωi, we can use standard interpolation estimate for FEM [5]

kui − Πhi uikL2(Ωi) + hikui − Πhi uikH 1(Ωi) ≤ Ch2

i |ui|H 2(Ωi).

(45)

We remind that coarse grid E is independent of h. Thus

ku − Πhuk2

H 1(Ω) =

N

Xi=1

kui − Πhi uik2

H 1(Ωi) ≤ C XΩi∈E

h2
i |ui|2

H 2(Ωi).

(46)

Let further uI := Πhu.

Lemma 6.1. Let u ∈ H 2(E), uI := Πhu. For any Ωi ∈ E and for any e ∈ Γi

(cid:13)(cid:13)ui − uI,i(cid:13)(cid:13)L2(e) ≤ Ch3/2
(cid:12)(cid:12)ui − uI,i(cid:12)(cid:12)H 1(e) ≤ Ch1/2

i

i

|ui|H 2(Ωi),

|ui|H 2(Ωi).

(47)

(48)

Proof. For ﬁxed e and Ωi, we have kui −uI,ik2
L2(e∩τ ).
Note that on a single triangulation element τ we have that ui − uI,i ∈ H 2(τ ),
so using the trace inequality (see [13]) for H 2(τ ) functions we have

L2(e) =Pτ ∈Thi,e

kui −uI,ik2

kui − uI,ikL2(e∩τ ) = C(cid:16)h−1/2

i

Then by (45) it follows that

kui − uI,ikL2(e) ≤ Ch−1/2
≤ Ch3/2

i

i

i

kui − uI,ikL2(τ ) + h1/2

(cid:12)(cid:12)ui − uI,i(cid:12)(cid:12)H1(τ )(cid:17).
(cid:16)kui − uI,ikL2(Ωi) + hi(cid:13)(cid:13)ui − uI,i(cid:13)(cid:13)H 1(Ωi)(cid:17)

|ui|H 2(Ωi).

(49)

(50)

Proof of the latter estimate is analogous.

Let us take any e ∈ ΓDI . For e ∈ ΓI we assume that e = Ωj ∩ Ωk for some

Ωj, Ωk ∈ E and by a triangle inequality we have

[u − uI]2 ds = k[u − uI]k2

L2(e) ≤ 2

Ze

2

Xi∈{j,k}

kui − uI,ik2

L2(e),

(51)

while for e ∈ ΓD we have e ∈ Γi for some Ωi ∈ E and simply

Ze

[u − uI]2 ds =Ze(cid:16)ui − uI,i(cid:17)2

ds = kui − uI,ik2

L2(e)

(52)

Therefore it is suﬃcient to estimate kui − uI,ik2
as in lemma 6.1

L2(e), for any e ∈ ΓDI , e ⊂ ∂Ωi,

To proceed further, we need to take into account ηr,e. Therefore we will

distinguish few cases.

11

CSIPG In this case η1,e = σe{h−1}. Let e ∈ ΓD. By (50) we have

η1,eZe(cid:16)ui − uI,i(cid:17)2

ds = σeh−1

i kui − uI,ik2

L2(e)

≤ Cσeh−1

i h3

i |ui|2

H 2(Ωi) = Cσeh2

i |ui|2

H 2(Ωi).

On the other hand, if e ∈ ΓI then

η1,eZe(cid:16)uj − uI,j(cid:17)2

ds = 0.5σe(h−1

j + h−1

k )kuj − uI,jk2

L2(e)

≤ Cσe(cid:16)h2

j +

h3
j

hk(cid:17)|uj|2

H 2(Ωj ).

Then if we sum up over e ∈ ΓDI

Xe∈ΓDI

η1,eZe(cid:16)[u − uI ](cid:17)2

ds ≤

N

Xi=1

C h2

i + XΩk∈nb(Ωi)

Thus taking into account this estimate and (46)

h3
i

hk!|ui|2

H 2(Ωi).

ku − uIk2

h,σ1 ≤ C

N

Xi=1 h2

i + XΩk∈nb(Ωi)

h3
i

hk!|ui|2

H 2(Ωi).

(53)

(54)

(55)

(56)

If we increase destiny poportionally, i.e. hi := cih, the result can be improved
to

ku − uI k2

h,σ1 ≤ Ch2

|ui|2

H 2(Ωi).

N

Xi=1

(57)

CWOPSIP - general case Here we have η2,e = σe{h−2}. Proceeding as in
previous case, we get for e ∈ ΓD

η2,eZe(cid:16)ui − uI,i(cid:17)2

ds ≤ Cσehi|ui|2

H 2(Ωi),

and for e ∈ ΓI

η2,eZe(cid:16)uj − uI,j(cid:17)2

ds ≤ Cσe(cid:16)hj +

So taking into account (46)

h3
j
h2

k(cid:17)|uj|2

H 2(Ωj ).

ku − uI k2

h,σ2 ≤ C

N

Xi=1 hi + XΩk∈nb(Ωi)

Again assuming hi := cih we obtain

h3
i
h2

k!|ui|2

H 2(Ωi).

ku − uIk2

h,σ2 ≤ Ch

|ui|2

H 2(Ωi).

N

Xi=1

(58)

(59)

(60)

(61)

We must note that this estimate is generally worse than for CSIPG method.

12

Figure 3: An example of a mesh of Vh(Ω) space. Fine grid (mesh of Xh(Ω))
lines are in light gray, coarse grid (E) lines are in dark gray and the black color
is used for mesh of Vh(Ω). Three levels of reﬁnement are presented.

CWOPSIP - special case Imposing some restrictions on the mesh and
boundary conditions, we can improve the interpolation error estimate. Assume
that for every space Xh(Ω) there is some continuous FEM space Vh(Ω) ⊂ C(Ω),
such that Vh(Ω) ⊂ Xh(Ω). An example is presented on ﬁgure 3.

Under such assumptions, we deﬁne the projection operator Πh : H 2(E) →
Vh(Ω) ⊂ Xh(Ω) to satisfy Πhu(x) = u(x) for all nodal points of discretization
Vh. Then Πhu = uI is continuous and [uI ]|e ≡ 0 for every e ∈ ΓI . Also we have
[u]|e ≡ 0 in this case as u ∈ H 1(Ω) and

Xe∈ΓDI

η2,eZe(cid:16)[u − uI ](cid:17)2

ds = Xe∈ΓD

η2,eZe(cid:16)[ˆu − ˆuI ](cid:17)2

ds.

(62)

This integral do not vanish in general. However we additionally assume that ˆu|e
is constant on any e ∈ ΓD. In this paper, we deal with electrostatic potential,
which do not vary within a given contact of a device. Thus by choosing the
division in such a manner that boundary edges e ∈ ΓD do not cross the contact
boundaries, we can satisfy this assumption. Then ˆu|e = uI|e and simply by (46)

ku − uI k2

h,σ2 =

N

≤ Ch2

N

εi∇(cid:16)u − uI(cid:17)2
Xi=1ZΩi
Xi=1

|ui|H 2(Ωi).

dx ≤ C

N

Xi=1

h2
i |ui|H 2(Ωi)

(63)

7 Error estimates

7.1 Deﬁnitions and additional assumptions

We start with auxiliary lemma.

Lemma 7.1. Let u ∈ H s(E), s ≥ 1. Then

kuk2

L2(Ω) ≤ Ch

N

Xi=1ZΩi(cid:0)∇u(cid:1)2

dx + Xe∈ΓI

|e|−1Ze

[u]2 ds + Xe∈ΓDZe

u2 dsi.

(64)

13

Proof of lemma 7.1 may be found in [4].
Then we would like to have an analogue of a Poincare inequality for the

H 1(E) space.

Lemma 7.2. Let u ∈ H s(E), s ≥ 1, r ∈ {1, 2}. Then there exists some h0 > 0,
such that kukL2(Ω) ≤ ckukh,σr for 0 < h ≤ h0, where c is independent of h.

Proof. By deﬁnition of the broken norm (12), we have

kuk2

h,σr :=

N

Xi=1ZΩi

εi(cid:16)∇u(cid:17)2

dx + Xe∈ΓDI

ηr,eZe

[u]2 ds.

(65)

Note that |e| do not depend on h and ηr,e → ∞ as h → 0. Thus we can ﬁnd
h0 > 0, such that ηr,e ≥ |e|−1 and ηr,e ≥ 1 for any 0 < h < h0 and then by
lemma 7.1

kuk2

L2(Ω) ≤ Ch

N

Xi=1ZΩi(cid:0)∇u(cid:1)2
Xi=1ZΩi

dx + Xe∈ΓI
εi(cid:0)∇u(cid:1)2

N

dx + Xe∈ΓDI

≤ Chε−1

m

≤ C1kuk2

h,σr.

|e|−1k[u]k2

L2(e) + Xe∈ΓD
ηr,eZe
[u]2 dsi

ku]k2

L2(e)i

(66)

To prove error estimates of the proposed discretizaion, we would like to

introduce the following assumptions:

u∗ ∈ H 1(Ω) ∩ H 2(E),

7.2 Consistency

ε ∈(cid:8)v ∈ L∞(Ω) : ∀i ∈ {1, . . . , n} v|Ωi ∈ C1(Ω)(cid:9) . (67)

We start with an abstract result. Let u ∈ H 1(Ω), f ∈ L2(Ω). We pose two
problems. The ﬁrst is the following: ﬁnd u ∈ H 1(Ω) such that

ZΩ

ε∇u · ∇ϕ dx =ZΩ

u = ˆu on ΣD.

f ϕ dx ∀ϕ ∈ H 1

0,ΣD (Ω),

(68)

Second problem is posed in “broken” Sobolev space: ﬁnd u ∈ H 1(E), such that
∀ϕ ∈ H 1(E) ∩ H 2(Th)

N

Xi=1ZΩi

ε∇u · ∇ϕ dx − Xe∈ΓDIZenε∇u · νo[ϕ] ds
+ ξ Xe∈ΓDIZenε∇ϕ · νo[u] ds + Xe∈ΓDI
Xi=1ZΩi

f ϕ dx + ξ Xe∈ΓDZenε∇ϕ · νo[ˆu] ds + Xe∈ΓD

ηr,eZe

[u][ϕ] ds

=

N

ηr,eZe

[ˆu][ϕ] ds.

(69)

14

We consider ξ ∈ {0, −1}, which will be used in CWOPSIP and CSIPG, respec-
tively.

We would like to prove the following result.

Theorem 7.3. Assume that the solution u of problem (68) belongs to H 1(Ω) ∩
H 2(E) and ε∇u ∈ H 1(E). Then u satisﬁes (69). Conversely, if u ∈ H 2(E) ∩
H 1(Ω) is a solution of (69) and ε∇u ∈ H 1(E), then it is also a solution of (68).

The proof is based on the standard approach in Discontinuous Galerkin

Method [13].

Lemma 7.4. Let u ∈ H 1(Ω) ∩ H 2(E), ε∇u ∈(cid:0)H 1(E)(cid:1)2

f ∈ L2(Ω). The following statements are equivalent:

• u satisfy:

, 0 < εm ≤ ε ≤ εM and

ZΩ

ε∇u · ∇ϕ =ZΩ

f ϕ,

∀ϕ ∈ H 1

0,ΣD (Ω)

(70)

• u satisfy:

−

N

Xi=1ZΩi

∀ϕ ∈ L2(Ω)

f ϕ,

∇(cid:16)εi∇ui(cid:17)ϕi =ZΩ
hε∇u · νi = 0 on ΣI ,

∇u · ν = 0 on ΣN .

(71)

Proof. (71) ⇒ (70) follows simply from the Green formula. To prove (70) ⇒
(71), take any ϕ ∈ C∞

(Ω), then by (70) we have

0 (Ω). Since C∞

0 (Ω) ⊂ H 1

0,ΣD

ZΩ

ε∇u · ∇ϕ =ZΩ

f ϕ.

By the Green formula

f ϕ dx =

ZΩ

ε∇u · ∇ϕ dx

N

Xi=1ZΩi
Xi=1ZΩi

N

= −

∇(cid:16)ε∇u(cid:17)ϕ dx +Xe∈ΓZe

[ε∇u · ν]ϕ ds

(72)

(73)

Since ϕ is zero on ∂Ω, we may rewrite last sum

f ϕ = −

ZΩ

N

Xi=1ZΩi

∇(cid:16)ε∇u(cid:17)ϕ dx + Xe∈ΓIZe

[ε∇u · ν]ϕ ds.

(74)

Then, as a simple consequence of the Green formula, for every e ∈ ΓI ∪ ΓN we

have hε∇u · νi = 0, so

−

N

Xi=1ZΩi

f ϕ.

∇(cid:16)ε∇u(cid:17)ϕ dx =ZΩ
0 (Ω). Since ∇(cid:16)ε∇u(cid:17) ∈ L2(Ω) it is also true

(75)

This statement is true for ϕ ∈ C∞
for any ϕ ∈ L2(Ω) and ﬁrst statement of (71) is shown.

15

Proof. (Theorem 7.3)

First we prove (68) ⇒ (69). Assume that u is a solution of (68) and that it

belongs to H 1(Ω) ∩ H 2(E). We have by deﬁnition

ZΩ

ε∇u · ∇φ dx =ZΩ

f φ dx ∀φ ∈ H 1

0,ΣD (Ω).

We use lemma 7.4 and we obtain that for any φ ∈ L2(Ω)

−ZΩ

∇ ·(cid:16)ε∇u(cid:17)φ dx =ZΩ

f φ dx.

(76)

(77)

Let us take any ϕ ∈ H 1(E) ∩ H 2(Th) and substitute φ := ϕ. We may split

integrals to

−

By the Green theorem, we have

N

Xi=1ZΩi

∇ ·(cid:16)ε∇u(cid:17)ϕ dx =

N

Xi=1ZΩi

f ϕ dx.

(78)

ZΩi

∇ ·(cid:16)ε∇u(cid:17)ϕ dx =ZΩi

ε∇u · ∇ϕ dx −Z∂Ωi

ε∇u · νϕ dx.

(79)

Summing up these results in Ωi, we get

N

Xi=1ZΩi

ε∇u · ∇ϕ dx −

N

Xi=1Z∂Ωi

ε∇u · νϕ dx =

N

Xi=1ZΩi

f ϕ dx.

(80)

By lemma 7.4, we have that [ε∇u] = 0 on ΣI , thus {ε∇u · ν} = ε∇u · ν on any
∂Ωi and we have

N

Xi=1ZΩi

ε∇u · ∇ϕ dx −Xe∈ΓZenε∇u · νo[ϕ] dx =

N

Xi=1ZΩi

f ϕ dx.

(81)

By homogeneous Neumann boundary condition (lemma 7.4) on e ∈ ΓN we have
{ε∇u · ν} = 0 and

N

Xi=1ZΩi

ε∇u · ∇ϕ dx − Xe∈ΓDIZenε∇u · νo[ϕ] dx =

N

Xi=1ZΩi

f ϕ dx.

(82)

Since u ∈ H 1(Ω), then [u] = 0 for any e ∈ ΓI and by assumption on e ∈ ΓD we
have u = ˆu so we have for any ϕ ∈ H 1(E)(Ω)

Xe∈ΓDI

ηr,eZe

[u][ϕ] ds + ξ Xe∈ΓDIZenε∇ϕ · νo[u] ds

= Xe∈ΓD

ηr,eZe

[ˆu][ϕ] ds + ξ Xe∈ΓDZenε∇ϕ · νo[ˆu] ds.

(83)

By adding this result side-by-side to (82) we obtain (69).

16

∇ϕǫ · ν(cid:12)(cid:12)(cid:12)∂Ωi
ε∇u·ν ¯ϕ ds+ηr,eZe

We proceed to (69) ⇒ (68). Assume (69) is true. First we recover the
Dirichlet boundary conditions. Take any e ∈ ΓD, such that e ∈ ∂Ωi, and
¯ϕ ∈ C∞

0 (e). Then let {ϕǫ}ǫ be a sequence of functions, such that

ϕǫ ∈ C∞(Ω),

ϕǫ|e = ¯ϕ,

supp(ϕǫ) ⊂ Ωi ∪ e,

ϕǫ|∂Ωi\e ≡ 0,

= 0,

kϕǫkL2(Ω) −−−→
ǫ→0

0.

Then ϕ ∈ H 1(E) ∩ H 2(Th) and (69) becomes

ZΩi

ε∇u·∇ϕǫ dx−Ze

u ¯ϕ ds =ZΩi

f ϕǫ dx+ηr,eZe

ˆu ¯ϕ ds. (84)

By the Green theorem

ZΩi

∇(cid:16)ε∇u(cid:17)ϕǫ dx + ηr,eZe

u ¯ϕ ds =ZΩi

f ϕǫ dx + ηr,eZe

ˆu ¯ϕ ds.

(85)

Passing to the limit ǫ → 0

ηr,eZe

u ¯ϕ ds = ηr,eZe

ˆu ¯ϕ ds.

Since ¯ϕ ∈ C∞

0 (e) and e ∈ ΓD are arbitrary, we get

u|ΣD = ˆu|ΣD ,

and the Dirichlet boundary conditions are satisﬁed.

Then take any ϕ ∈ C∞

0,ΣD

(Ω). Thus

(86)

(87)

Xe∈ΓDI

ηr,eZe

[u][ϕ] ds = Xe∈ΓD

ηr,eZe

[ˆu][ϕ] ds = 0.

(88)

as [ϕ] = 0 for any e ∈ ΓI since ϕ ∈ C∞
Analogously we see that

0,ΣD

(Ω) and on e ∈ ΓD we have [ϕ] = ϕ ≡ 0.

− Xe∈ΓDIZenε∇uo[ϕ] ds = 0.

(89)

By assumptions of the theorem u ∈ H 1(Ω), so [u] = 0 for any e ∈ ΓI while as
we have already been shown u = ˆu for e ∈ ΓD, so

ξ Xe∈ΓDIZenε∇ϕ · νo[u] ds = ξ Xe∈ΓDZenε∇ϕ · νo[ˆu] ds.

Thus we obtain

N

Xi=1ZΩi

ε∇u · ∇ϕ dx =ZΩ

f ϕ dx.

(90)

(91)

Since this statement is true for any ϕ ∈ C∞
ϕ ∈ H 1

(Ω), so we regain the ﬁrst statement of (68).

0,ΣD

0,ΣD

(Ω), then it is valid also for any

17

7.3 Auxiliary estimates

We deﬁne the following operators

A(u, ϕ) :=

B(u, ϕ) :=

C(ϕ) :=

N

N

ε∇u · ∇ϕ dx,

Xi=1ZΩi
Xi=1ZΩi(cid:0)eu−ˆv − e ˆw−u(cid:1)ϕ dx,
Xi=1ZΩi

k1ϕ dx,

N

∂u

∂νo[ϕ] ds,
∂νo[u] ds,

∂ϕ

{ε∇ϕ · n}[ˆu] ds,

D(u, ϕ) := − Xe∈ΓDIZenε
E(u, ϕ) := − Xe∈ΓDIZenε
F (ϕ) := − Xe∈ΓDZe
ηr,eZe
Ir(ϕ) := Xe∈ΓD
ηr,eZe
Jr(u, ϕ) := Xe∈ΓDI

[ˆu] · [ϕ] ds,

[u] · [ϕ] ds.

Lemma 7.5. Let uh ∈ Xh(Ω) and ξ ∈ {0, −1}. Then

A(uh, uh) + J(uh, uh)

+ ξD(uh, uh) + ξE(uh, uh) ≥ ckuhkh.

Proof. If ξ = 0, then simply

A(uh, uh) + J(uh, uh) = kuhk2
h.

Otherwise it is a simple consequence of lemma 3.3.

Lemma 7.6. Let u, v ∈ L2(Ω). Then B(u, u − v) − B(v, u − v) ≥ 0.

Proof. Since the exponential function is monotone

B(u, u − v) − B(v, u − v) =ZΩ
+ZΩ

e−ˆv(cid:0)eu − ev(cid:1)(u − v) dx
e ˆw(cid:0)e−v − e−u(cid:1)(u − v) dx ≥ 0.

Lemma 7.7. Let u, ϕ ∈ H 1(E), r ∈ {1, 2}. Then

(92)

(93)

(94)

(95)

≤ Ckukh,σrkϕkh,σr .

(96)

(cid:12)(cid:12)(cid:12)
A(u, ϕ) + Jr(u, ϕ)(cid:12)(cid:12)(cid:12)

18

Proof. This is a simple consequence of the Schwarz inequality.

Lemma 7.8. Let u, v, ϕ ∈ H 1(E), r ∈ {1, 2} and α ≤ u, v ≤ β for some
α, β ∈ R. Then

≤ Cku − vkh,σr kϕkh,σr ,

(97)

(cid:12)(cid:12)(cid:12)

B(u, ϕ) − B(v, ϕ)(cid:12)(cid:12)(cid:12)

where C is a constant dependent on α, β, kˆvkL∞(Ω) and k ˆwkL∞(Ω).

Proof. Note that the exponential function is locally Lipschitz-continuous, so
since u, v are bounded

keu − evkL2(Ω) ≤ Cku − vkL2(Ω).

(98)

The same is true for e−v − e−u. Thus using the Schwarz inequality and Poincare
inequality for the “broken” norm (lemma 7.2)

(cid:12)(cid:12)(cid:12)
B(u, ϕ) − B(v, ϕ)(cid:12)(cid:12)(cid:12)

=(cid:12)(cid:12)(cid:12)ZΩ

e−ˆv(cid:0)eu − ev(cid:1)ϕ dx +ZΩ

e ˆw(cid:0)e−v − e−u(cid:1)ϕ dx(cid:12)(cid:12)(cid:12)

≤ Cku − vkL2(Ω)kϕkL2(Ω) ≤ Cku − vkh,σr kϕkh,σr .

(99)

Lemma 7.9. Let u ∈ H 2(E) and ϕh ∈ Xh(Ω). Then

|D(u, ϕh)| ≤ Ch|u|H 1(Ω)kϕhkh,σ2.

(100)

Constant C depends on εM and σ0.

Proof. Using the Schwarz inequality

(cid:12)(cid:12)(cid:12)

D(u,ϕh)(cid:12)(cid:12)(cid:12)

|{ε∇u · ν} [ϕh]|

≤ Xe∈ΓDIZe
≤" Xe∈ΓDIZe
≤" N
Xi=1
≤ Ch" Xe∈ΓDI

h2

η−1

2,e {ε∇u · ν}2#1/2" Xe∈ΓDIZe
e {ε∇u · ν}2#
i Xe∈ΓDI ∩ΓiZe

σ−1

1/2

σ−1

e {ε∇u · ν}2#1/2

kϕhkh,σ2

η2,e[ϕh]2#1/2

kϕhkh,σ2

(101)

≤ Ch|u|H 1(Ω)kϕhkh,σ2,

where the last inequality follows from the trace theorem. Constant C depends on
εM , σ0 and the maximal number of edges of elements of the coarse triangulation
E.

Lemma 7.10. Let u ∈ H 2(E), uI := Πhu (see section 6) and ϕh ∈ Xh(Ω).
Then

|D(u − uI , ϕh)| ≤ Ch(cid:16)

N

Xi=1

|ui|2

H 2(Ωi)(cid:17)1/2

kϕhkh,σ1.

(102)

Constant C depends on εM and σ0.

19

Proof. We have

D(u − uI , ϕh) = − Xe∈ΓDIZenε∇(u − uI) · νo[ϕh] ds

(103)

Let us take any e ∈ ΓI , e ∈ ∂Ωj ∩ ∂Ωk. Then the Schwarz inequality yields that

Zenε∇(u − uI) · νo[ϕh] ds ≤ εM k{∇(u − uI ) · ν}kL2(e)k[ϕh]kL2(e)

Then by lemma 6.1

k{∇(u − uI ) · ν}kL2(e) ≤ (h1/2

j

|uj|H 2(Ωj ) + h1/2

k |uk|H 2(Ωk))

≤ (hj + hk)1/2(|uj|H 2(Ωj ) + |uk|H 2(Ωk)).

Therefore

η−1
1,ek{∇(u − uI)}k2

L2(e) ≤ Cσ−1

e hjhk(|uj|H 2(Ωj ) + |uk|H 2(Ωk))2

≤ Ch2(|uj|H 2(Ωj ) + |uk|H 2(Ωk))2

If e ∈ ΓD, e ∈ ∂Ωi, then analogously

η−1
1,ek{∇(u − uI) · ν}k2

L2(e) ≤ Cσ−1

e h2

i |ui|2

H 2(Ωi) ≤ Ch2|ui|2

H 2(Ωi)

(104)

(105)

(106)

(107)

Therefore by Schwarz inequality and the inequalities derived above

Xe∈ΓDIZenε∇(u − uI) · νo[ϕh] ds
≤ C(cid:16) Xe∈ΓDI
≤ Ch(cid:16)
Xi=1

H 2(Ωi)(cid:17)1/2

η−1
1,ek{∇(u − uI ) · ν}k2

kϕhkh,σ1.

|ui|2

N

L2(e)(cid:17)1/2(cid:16) Xe∈ΓDI

η1,ek[ϕh]k2

L2(e)(cid:17)1/2

(108)

Constant C is independent of h. It depends on σ0, εM and on the number of
elements of ΓDI .

Lemma 7.11. Let u ∈ H 2(E), uI := Πhu (see section 6) and ϕh ∈ Xh(Ω).
Then

|E(u − uI , ϕh)| ≤ Ckϕhkh,σ1" N

Xi=1(cid:16)h2

i + XΩk∈nb(Ωi)

Proof. By the Schwarz inequality

h3
i

hk(cid:17)|ui|2

H 2(Ωi)#1/2

.

(109)

|E(u − uI , ϕh)| ≤ Xe∈ΓDIZe(cid:12)(cid:12)(cid:12)nε∇ϕh · νo(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

[u − uI](cid:12)(cid:12)(cid:12)

ds,

(110)

≤ εM Xe∈ΓDI

k{∇ϕh · ν}kL2(e)k[u − uI ]kL2(e)

20

Splitting this sum up

Then using lemma 3.1

2

∇ϕh · ν(cid:12)(cid:12)(cid:12)Ωj(cid:13)(cid:13)(cid:13)L2(e)

k{∇ϕh · ν}kL2(e) ≤(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)
∇ϕh · ν(cid:12)(cid:12)(cid:12)Ωi(cid:13)(cid:13)(cid:13)
k[u − uI ]kL2(e) ≤ ku − uI(cid:12)(cid:12)Ωj

≤ Ch−1

i k∇ϕhk2

L2(e)

On the other hand

+(cid:13)(cid:13)(cid:13)
∇ϕh · ν(cid:12)(cid:12)(cid:12)Ωk(cid:13)(cid:13)(cid:13)L2(e)

.

L2(Ωi) ≤ Ch−1

i kϕhk2

h,σ1.

(111)

(112)

(114)

(115)

By lemma 6.1 we have ku − uI(cid:12)(cid:12)Ωi
|E(u − uI, ϕh)| ≤ Ckϕhkh,σ1" N

kL2(e) + ku − uI(cid:12)(cid:12)Ωk

H 2(Ωi), so

i |u|2

k2
L2(e) ≤ Ch3

kL2(e).

(113)

Xi=1(cid:16)h2

i + XΩk∈nb(Ωi)

h3
i

hk(cid:17)|ui|2

H 2(Ωi)#1/2

The diﬀerential problem (69) satisﬁes:

A(u∗, ϕ) + B(u∗, ϕ) + D(u∗, ϕ) + ξE(u∗, ϕ) + Jr(u∗, ϕ)

= C(ϕ) + ξF (ϕ) + Ir(ϕ)

∀ϕ ∈ H 1(E) ∩ H 2(Th).

On the other hand, the family of discrete problems depending on parameter h
is deﬁned as

A(u∗

h, ϕh) + B(u∗

h, ϕh) + ξD(u∗

h, ϕh) + ξE(u∗

h, ϕh) + Jr(u∗

h, ϕh)

= C(ϕh) + ξF (ϕh) + Ir(ϕh)

∀ϕh ∈ Xh.

(116)

Here we use ξ = 0 for CWOPSIP (16) and ξ = 1 for CSIPG (18).

We subtract these equations from each other with ϕ := ϕh and we obtain

A(u∗ − u∗

h, ϕh) + B(u∗, ϕh) − B(u∗

h, ϕh) + D(u∗ − ξu∗

h, ϕh)

+ ξE(u∗ − u∗

h, ϕh) + Jr(u∗ − u∗

h, ϕh) = 0.

This is equivalent to LHS = RHS, where

LHS := A(u∗
+ ξE(u∗

I − u∗
I − u∗

h, ϕh) + B(u∗
h, ϕh) + Jr(u∗

I , ϕh) − B(u∗
I − u∗
h, ϕh),

h, ϕh) + ξD(u∗

I − u∗

h, ϕh)

and

RHS := A(u∗
+ ξE(u∗

I − u∗, ϕh) + B(u∗
I − u∗, ϕh) + Jr(u∗

I , ϕh) − B(u∗, ϕh) + D(ξu∗
I − u∗, ϕh).

I − u∗, ϕh)

21

(117)

(118)

(119)

7.4 Error estimate for CWOPSIP

In this case

RHS := A(u∗

I − u∗, ϕh) + B(u∗

I , ϕh) − B(u∗, ϕh) − D(u∗, ϕh) + J2(u∗

I − u∗, ϕh).
(120)

We take ϕh := u∗
cku∗
by the same constants, what allows us to use lemma 7.6.

h. By lemma 7.5 and lemma 7.6 we have that LHS ≥
I is also bounded

hkh,σ2. Note that u∗ is bounded (lemma 2.1), thus u∗

I − u∗

I − u∗

On the other hand, we may estimate RHS with lemmata 7.7, 7.8 and 7.9

RHS ≤Cku∗

I − u∗

hkh,σ2(cid:16)ku∗ − u∗

Therefore using LHS = RHS we obtain

ku∗

I − u∗

hk2

h,σ2 ≤Cku∗

I − u∗

hkh,σ2(cid:16)ku∗ − u∗

Then diving both sides of this inequality by ku∗

I kh,σ2 + h|u∗|H 1(Ω)(cid:1)(cid:17).
I kh,σ2 + h|u∗|H 1(Ω)(cid:1)(cid:17).

I − u∗

hkh,σ2 > 0

(121)

(122)

(123)

ku∗

I − u∗

hkh,σ2 ≤C(cid:16)ku∗ − u∗

I kh,σ2 + h|u∗|H 1(Ω)(cid:1)(cid:17).

Thus by the triangle inequality and interpolation error estimate (60) we have

ku∗ − u∗

hkh,σ2 ≤ku∗ − u∗

I kh,σ2 + ku∗

I − u∗

hkh,σ2

≤C  N

Xi=1(cid:16)hi + XΩk∈nb(Ωi)

H 2(Ωi)!1/2

i |2

h3
i
h2

k(cid:17)|u∗

+ Ch|u∗|H 1(Ω).

(124)

With the additional assumption hi := cih for every Ωi ∈ E we can simplify this
expression to

ku∗ − u∗

hkh,σ2 ≤ Ch1/2(cid:16)|u∗|2

H 1(Ω) +

N

Xi=1

|u∗

i |2

H 2(Ωi)(cid:17)1/2

.

(125)

If we use particular grids and Dirichlet boundary conditions are piecewise linear,
as explained in section 6, we could get a better estimate

ku∗ − u∗

hkh,σ2 ≤ Ch(cid:16)|u∗|2

H 1(Ω) +

N

Xi=1

|u∗

i |2

H 2(Ωi)(cid:17)1/2

.

(126)

7.5 Error estimate for CSIPG

As for CWOPSIP, by lemma 7.5 and lemma 7.6 imply LHS ≥ cku∗
Then we have

I − u∗

hkh,σ1.

RHS := A(u∗
+ E(u∗

I − u∗, ϕh) + B(u∗
I − u∗, ϕh) + J1(u∗

I , ϕh) − B(u∗, ϕh) + D(u∗
I − u∗, ϕh).

I − u∗, ϕh)

(127)

22

p-GaN
100 nm

n-GaN
100 nm

Figure 4: Schema of the n-p diode used in numerical simulations.

This time we may estimate RHS with lemmata 7.7, 7.8, 7.10 and 7.11

RHS ≤ Cku∗

I − u∗

hkh,σ1 ku∗

I − u∗kh,σ1 +" N

Xi=1(cid:16)h2

i + XΩk∈nb(Ωi)

H 2(Ωi)#1/2!.

i |2

h3
i

hk(cid:17)|u∗

(128)

Thus estimating LHS = RHS from below and above and dividing by ku∗
u∗kh,σ1 > 0 we obtain

I −

ku∗

I − u∗

hkh,σ1 ≤ ku∗

I − u∗kh,σ1 +" N

Xi=1(cid:16)h2

i + XΩk∈nb(Ωi)

H 2(Ωi)#1/2!.

i |2

h3
i

hk(cid:17)|u∗

(129)

Thus by the triangle inequality and interpolation error estimate (56) we have

ku∗ − u∗

hkh,σ1 ≤ku∗ − u∗

I kh,σ1 + ku∗

I − u∗

hkh,σ1

≤C  N

Xi=1(cid:16)h2

i + XΩk∈nb(Ωi)

H 2(Ωi)!1/2

i |2

h3
i

hk(cid:17)|u∗

(130)

.

If hi := cih for every Ωi ∈ E this estimate simpliﬁes to

ku∗ − u∗

hkh,σ1 ≤Ch(cid:16)

N

Xi=1

8 Numerical experiments

|u∗

i |2

H 2(Ωi)(cid:17)1/2

.

(131)

We performed numerical simulations of a p-n junction (ﬁgure 4) to verify whether
the theoretical estimates hold in practice. This device consists of two layers
composed of the same material, but with diﬀerent doping. We use homoge-
neous mesh inside layers of the device, which is nonmatching on the interface of
the layers. It is formed by division of the layers to K parts in the longitude and
then by dividing the ﬁrst layer into 3K parts and dividing the second part into
2K parts in the perpendicular direction. We start with initial grid for K = 2,
presented in ﬁgure 5.

23

Figure 5: Initial grid used in numerical simulations of pn junction.

p-GaN
110 nm

In0.1Ga0.9N
3 nm

n-GaN
120 nm

Figure 6: Schema of the quantum well structure used in numerical simulations.

Figure 7: Initial grid used in numerical simulations of the quantum well. To
improve the convergence, p-GaN and n-GaN were splitted into two layers to
thicken the grid near the quantum well.

24

Table 1: Relative errors of the potential u∗. Simulation were performed for the
pn junction in the equilibrium state.

CSIPG

CWOPSIP

L2(Ω)

H 1(Ω)

L2(Ω)

H 1(Ω)

1.8e-01
4.5e-02
2.3e-02
9.7e-03
2.8e-03
6.1e-04
1.5e-04
3.5e-05

(4.0)
(1.9)
(2.4)
(3.4)
(4.6)
(4.2)
(4.2)

6.9e-01
4.2e-01
3.0e-01
2.1e-01
1.2e-01
5.7e-02
2.9e-02
1.4e-02

(1.6)
(1.4)
(1.4)
(1.8)
(2.0)
(2.0)
(2.0)

2.3e-01
1.2e-01
3.8e-02
7.7e-03
1.5e-03
4.8e-04
1.3e-04
3.3e-05

(1.9)
(3.1)
(4.9)
(5.1)
(3.1)
(3.8)
(3.9)

9.8e-01
5.9e-01
3.2e-01
2.1e-01
1.2e-01
5.7e-02
2.9e-02
1.4e-02

(1.7)
(1.9)
(1.5)
(1.8)
(2.0)
(2.0)
(2.0)

K
2
4
8
16
32
64
128
256

In numerical simulations, we use the Poisson equation scaled in SI units.
Thus it is more elaborated than equation (1), as then physical constants and
material parameters are present. Also it takes into account physical parameters
and incomplete ionization of acceptors and donors, so k1 is actually a function
of u. More details on the drift-diﬀusion equations, used by us in the simulations
of realistic devices may be found in [16], while details of the linearization of the
underlying discrete system may be found in [15]. Since the exact solution is
not known, as a reference we use the result of one-dimensional simulation for
K = 1024. For every function fK taken into account, we compute the relative
errors deﬁned as

errorK,L2(Ω) :=

kfK − frefkL2(Ω)

kfrefkL2(Ω)

,

errorK,H 1(Ω) :=

kfK − frefkH 1(Ω)

kfrefkH 1(Ω)

,

(132)

where fref is a numerical solution computed on a ﬁne grid, as mentioned before.
Errors are presented in function of K. Note that h = c/K for some constant c.
Having in mind estimates of section 7, we expect errorK,H 1(Ω) / error2K,H 1(Ω) ≈
2.

Results of these simulations are presented in table 1. Both methods start
slowly, for K ≤ 32 error ratio is < 2. From K = 64 we observe error ratio ≈ 2.
The error norms for CSIPG and CWOPSIP are similar.

Then we repeated our simulations for a single quantum well structure (ﬁgure
6). It is similar to the p-n junction, but it has a narrow layer between n region
and p region, called the quantum well. In this case, we introduce ﬁve layers in
our mesh, while two additional layers are used to improve the grid in n region
and p region near the quantum well layer (ﬁgure 7). Results of this simulation
is presented in table 2 and they generally agree with our previous simulation.
Note that the slow start is absent in this case. This is due to additional layers
introduced near the quantum well, where the function ﬂuctuations are crucial.

9 Conclusions

We have presented two methods of composite Discontinuous Galerkin discretiza-
tion of the drift-diﬀusion equations in the equilibrium state. These methods
were derived from Symmetric Interior Penalty Galerkin method [13] and Weakly
Over-Penalized Symmeric Interior Penalty method [3].

25

Table 2: Relative errors of the potential u∗. Simulation were performed for the
single quantum well in the equilibrium state.

CSIPG

CWOPSIP

L2(Ω)

H 1(Ω)

L2(Ω)

H 1(Ω)

5.2e-02
2.0e-02
5.2e-03
1.3e-03
3.4e-04
8.5e-05

(2.6)
(3.8)
(3.9)
(4.0)
(4.0)

3.8e-01
2.3e-01
1.1e-01
5.8e-02
2.9e-02
1.5e-02

(1.7)
(2.0)
(1.9)
(2.0)
(2.0)

7.5e-02
2.4e-02
7.3e-03
1.8e-03
4.5e-04
1.1e-04

(3.1)
(3.3)
(4.0)
(4.0)
(4.0)

4.6e-01
2.6e-01
1.2e-01
5.9e-02
3.0e-02
1.5e-02

(1.8)
(2.2)
(2.0)
(2.0)
(2.0)

K
2
4
8
16
32
64

Both discretizations are shown to be well-deﬁned and the error is estimated.
In case of uniform increase of grid density, the H 1-norm of error of Compos-
ite Symmetric Interior Penalty Galerkin (CSIPG) method error is estimated by
O(h), while for Composite Weakly Over-Penalized Symmeric Interior Penalty
(WOPSIP) method we obtain only O(h1/2) estimate.
In the latter case, the
estimate may be improved to O(h) under additional assumptions on a mesh se-
quance and boundary conditions. In simulations of seminconductor luminescent
devices, these assumptions are not excessively restrictive, as these structures’
design is often based on simple geometric shapes.

Numerical simulations presented in this paper stay in a good agreement with

these estimates.

References

[1] Randolph E. Bank and Donald J. Rose. Some Error Estimates for the Box

Method. SIAM Journal of Numerical Analysis, 24:777–787, 1987.

[2] A. T. Barker, S. C. Brenner, E.-H. Park, and L.-Y. Sung. Two-Level
Additive Schwarz Preconditioners for a Weakly Over-Penalized Symmetric
Interior Penalty Method. Journal of Scientiﬁc Computing, 47(1):27, 2011.

[3] S. C. Brenner, L. Owens, and L.-Y. Sung. A weakly over-penalized symmet-
ric interior penalty method. Electronic Transactions on Numerical Analy-
sis, 30:107–127, 2008.

[4] Susanne C. Brenner. Poincare-Friedrichs Inequalities for Piecewise H1

Functions. SIAM Journal on Numerical Analysis, 41:306–324, 2004.

[5] Susanne C. Brenner and L. Ridgway Scott. The Mathematical Theory of

Finite Element Methods. Springer, New York, 2008.

[6] R. K. Coomer and I. G. Graham. Massively Parallel Methods for Semicon-

ductor Device Modelling. Computing, 56:1–27, 1996.

[7] Maksymilian Dryja. On Discontinuous Galerkin Methods for Elliptic Prob-
lems with Discontinuous Coeﬃcients. Computational Methods in Applied
Mathematics, 3(1):76–85, 2003.

[8] H. K. Gummel. A self-consistent iterative scheme for one-dimensional
steady state transistor calculations. IEEE Trans. Elect. Dev., 11:455–464,
1964.

26

[9] Joseph W. Jerome. Consistency of Semiconductor Modeling: An Exis-
tence/Stability Analysis for the Stationary van Roosbroeck System. SIAM
Journal of Applied Mathematics, 45(4):565–590, 1985.

[10] J. L. Lions. Quelques m´ethodes de r´esolution des probl`emes aux limites non

lin´eaires. Dunod/Gauthier-Villars, Paris, 1969.

[11] J. J. H. Miller, W. H. A. Schilders, and S. Wang. Application of ﬁnite
element methods to the simulation of semiconductor devices. Rep. Prog.
Phys., 62:277–353, 1999.

[12] Daniele A. Di Pietro and Alexandre Ern. Mathematical aspects of Discon-

tinuous Galerkin Methods. Springer, Berlin, 2012.

[13] Beatrice Riviere. Discontinuous Galerkin methods for solving elliptic and
parabolic equations: theory and implementation. Society for Industrial and
Applied Mathematics, Philadelphia, 2008.

[14] W. V. Van Roosbroeck. Theory of Flow of Electrons and Holes in Ger-
manium and Other Semiconductors. The Bell System Technical Journal,
29:560–607, 1950.

[15] Konrad Sakowski, Leszek Marcinkowski, and Stanislaw Krukowski. Mod-
iﬁcation of the Newton’s method for the simulations of gallium nitride
semiconductor devices. Lecture Notes in Computer Science, 8385:551–560,
2014.

[16] Konrad Sakowski, Leszek Marcinkowski, Stanislaw Krukowski, Szymon
Grzanka, and Elzbieta Litwin-Staszewska. Simulation of trap-assisted tun-
neling eﬀect on characteristics of gallium nitride diodes. Journal of Applied
Physics, 111(12):123115, 2012.

[17] Siegfried Selberherr. Analysis and Simulation of Semiconductor Devices.

Springer-Verlag, Wien, 1984.

[18] S.M. Sze and K.K. Ng. Physics of Semiconductor Devices. Wiley-

Interscience, Berlin, 2006.

[19] Peter Wilkes. Solid State Theory in Metallurgy. Cambridge University

Press, Cambridge, 1973.

27

