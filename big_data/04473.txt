Distance distribution in conﬁguration model networks

Mor Nitzan,1, 2 Eytan Katzav,1 Reimer K¨uhn,3 and Ofer Biham1

1Racah Institute of Physics, The Hebrew University, Jerusalem 91904, Israel

2Department of Microbiology and Molecular Genetics,

Faculty of Medicine, The Hebrew University, Jerusalem 91120, Israel

3Department of Mathematics, King’s College London, Strand, London WC2R 2LS, UK

Abstract

We present analytical results for the distribution of shortest path lengths between random pairs

of nodes in conﬁguration model networks. The results, which are based on recursion equations,

are shown to be in good agreement with numerical simulations for networks with degenerate,

binomial and power-law degree distributions. The mean, mode and variance of the distribution of

shortest path lengths are also evaluated. These results provide expressions for central measures

and dispersion measures of the distribution of shortest path lengths in terms of moments of the

degree distribution, illuminating the connection between the two distributions.

6
1
0
2

 
r
a

 

M
4
1

 
 
]
n
n
-
s
i
d
.
t
a
m
-
d
n
o
c
[
 
 

1
v
3
7
4
4
0

.

3
0
6
1
:
v
i
X
r
a

1

I.

INTRODUCTION

The study of complex networks has attracted much attention in recent years.

It was

found that network models provide a useful description of a large number of processes which

involve interacting objects [1–5].

In these models, the objects are represented by nodes

and the interactions are expressed by edges. Pairs of adjacent nodes can aﬀect each other

directly. However, the interactions between most pairs of nodes are indirect, mediated by

intermediate nodes and edges.

A pair of nodes, i and j, may be connected by a large number of paths. The short-

est among these paths are of particular importance because they are likely to provide the

fastest and strongest interaction. Therefore, it is of interest to study the distribution of

shortest path lengths (DSPL) between pairs of nodes in diﬀerent types of networks. Such

distributions, which are also referred to as distance distributions, are expected to depend

on the network structure and size. They are of great importance for the temporal evolution

of dynamical processes on networks, such as signal propagation [6], navigation [7–9] and

epidemic spreading [10, 11]. Central measures of the DSPL such as the average distance

between pairs of nodes, and extremal measures such as the diameter were studied [12–14].

However, apart from a few studies [15–20], the entire DSPL has attracted little attention.

Recently, an analytical approach was developed for calculating the DSPL [21] in the

Erd˝os-R´enyi (ER) network, which is the simplest mathematical model of a random network

[22–24]. Using recursion equations, analytical results for the DSPL were obtained in diﬀerent

regimes, including sparse and dense networks of small as well as asymptotically large sizes.

The resulting distributions were found to be in good agreement with numerical simulations.

ER networks are random graphs in which the degrees follow a Poisson distribution and

there are no degree-degree correlations between connected pairs of nodes.

In fact, ER

networks can be considered as a maximum entropy ensemble under the constraint that the

mean degree is ﬁxed. Moreover, there is a much broader class of networks, named the

conﬁguration model, which generates maximum entropy ensembles when the entire degree

distribution is constrained [4, 14, 15, 25]. The ER ensemble is equivalent to a conﬁguration

model in which the degree distribution is constrained to be a Poisson distribution. For any

given degree distribution, one can produce an ensemble of conﬁguration model networks and

perform a statistical analysis of its properties. Therefore, the conﬁguration model provides

2

a general and highly powerful platform for the analysis of networks.

In this paper we develop a theoretical framework, based on the cavity approach [26–29],

for the calculation of the DSPL in networks which belong to the conﬁguration model class.

Using this framework we derive recursion equations for the calculation of the DSPL in con-

ﬁguration model networks. We apply these equations to networks with degenerate, binomial

and power-law degree distributions, and show that the results are in good agreement with

numerical simulations. Using the tail-sum formula we calculate the mean and the variance

of the DSPL. Evaluating the discrete derivative of the tail distribution, we also obtain the

mode of the DSPL. These results provide closed form expressions for the central measures

and dispersion measures of the DSPL in terms of the moments of the degree distribution

and the size of the network, illuminating the connection between the two distributions.

The paper is organized as follows. In Sec. II we present the class of conﬁguration model

networks.

In Sec.

III we use the cavity approach to derive the recursion equations for

the calculation of the DSPL in these networks. In Sec. IV we consider properties of the

DSPL such as the mean, mode and variance. In Sec. V we present the results obtained

from the recursion equations for diﬀerent network models and compare them to numerical

simulations. In Sec. VI we present a summary of the results.

II. THE CONFIGURATION MODEL

The conﬁguration model is a maximum entropy ensemble of networks under the condi-

tion that the degree distribution is imposed [4, 15]. Here we focus on the case of undi-

rected networks, in which all the edges are bidirectional. To construct such a network of

N nodes, one can draw the degrees of all nodes from a desired degree distribution p(k),

k = 0, 1, . . . , N − 1, producing the degree sequence ki, i = 1, . . . , N (where P ki must be
even). The degree distribution p(k) satisﬁesPk p(k) = 1. The mean degree over the ensem-
ble of networks is c = hki =Pk kp(k), while the average degree for a single instance of the
network is ¯k = Pi ki/N. Here we consider networks which do not include isolated nodes,

namely p(0) = 0. This does not aﬀect the applicability of the results, since the distribution

of shortest path lengths is evaluated only for pairs of nodes which reside on the same clus-

ter, for which the distance is ﬁnite. Actually, if a network includes isolated nodes, one can

discard them by considering a renormalized degree distribution of the form p(k)/[1 − p(0)],

3

for k = 1, . . . , N − 1.

A convenient way to construct a conﬁguration model network is to prepare the N nodes

such that each node, i, is connected to ki half edges [4]. Pairs of half edges from diﬀerent

nodes are then chosen randomly and are connected to each other in order to form the

network. The result is a network with the desired degree sequence but no correlations. Note

that towards the end of the construction the process may get stuck. This may happen in

case that the only remaining pairs of half edges are in the same node or in nodes which are

already connected to each other. In such cases one may perform some random reconnections

in order to enable completion of the construction.

III. DERIVATION OF THE RECURSION EQUATIONS

Consider a random pair of nodes, i and j, in a network of N nodes. Assuming that the

two nodes reside on the same connected cluster, they are likely to be connected by a large

number of paths. Here we focus on the shortest among these paths (possibly more than

one). More speciﬁcally, we derive recursion equations for the length distribution of these

shortest paths. To this end we introduce the indicator function

where dij is the length of the shortest path between nodes i and j, and ℓ is an integer. We

χN (dij > ℓ) =


1 dij > ℓ

0 dij ≤ ℓ,

(1)

also introduce the conditional indicator function

χN (dij > ℓ|dij > ℓ − 1) =

χN (dij > ℓ ∩ dij > ℓ − 1)

χN (dij > ℓ − 1)

.

(2)

Under the condition that the length dij is larger than ℓ − 1, this function indicates whether

dij is also larger than ℓ. If it is, the conditional indicator function χ = 1, otherwise (namely

if dij = ℓ) χ = 0.

In case the condition dij > ℓ − 1 is not satisﬁed, the value of the

conditional indicator function is undetermined. In order to extend this deﬁnition we adopt

the convention that in case the condition is not satisﬁed the conditional indicator function

takes the value χN (dij > ℓ|dij > ℓ − 1) = 1. We note that all the subsequent results are

independent of the value adopted here. The indicator function χN (dij > ℓ) can be expressed

as a product of the conditional indicator functions in the form

4

χN (dij > ℓ) = χN (dij > 0)

χN (dij > ℓ′|dij > ℓ′ − 1),

(3)

ℓ

Yℓ′=1

where χN (dij > 0) = 1, since i and j are assumed to be two diﬀerent nodes.

In the analysis below we calculate the mean of the indicator function over an ensemble

of networks to obtain the distribution of shortest path lengths PN (d > ℓ). To this end

we deﬁne the mean conditional indicator function mi(ℓ) ∈ [0, 1], obtained by averaging the

conditional indicator function χN (dij > ℓ|dij > ℓ − 1) over all suitable choices of the ﬁnal

node, j:

mi(ℓ) = hχN (dij > ℓ|dij > ℓ − 1)ij.

(4)

The averaging is done only over nodes j which reside on the same cluster as node i and for

which the condition dij > ℓ − 1 is satisﬁed.

A path of length ℓ from node i to node j can be decomposed into a single edge connecting

node i and node r ∈ ∂i (where ∂i is the set of all nodes directly connected to i), and a shorter

path of length ℓ − 1 connecting r and j (following the old Chinese quote that even a journey

of a thousand miles begins by taking the initial step [30]). Thus, the existence of a path of

length ℓ between nodes i and j can be ruled out if there is no path of length ℓ − 1 between

any of the nodes r ∈ ∂i, and j (Fig. 1). The conditional indicator functions for these paths
of length ℓ − 1 are χ(i)

N −1(drj > ℓ − 1|drj > ℓ − 2), since they are embedded in a smaller
network of N − 1 nodes, which does not include node i. The superscript (i) stands for the

fact that the node r is reached by a link from node i. This is often referred to as the cavity

indicator function [26–29]. Similarly, we deﬁne the mean cavity indicator function as

m(i)

r (ℓ) = hχ(i)

N (drj > ℓ|drj > ℓ − 1)ij.

(5)

This reasoning enables us to express the conditional indicator function χN (dij > ℓ|dij > ℓ−1)

as a product of conditional indicator functions for shorter paths between nodes r ∈ ∂i and j

χN (dij > ℓ|dij > ℓ − 1) = Yr∈∂i\{j}

χ(i)
N −1(drj > ℓ − 1|drj > ℓ − 2).

(6)

Under the assumption that the local structure of the network is tree-like, one can approxi-

mate the average of the product in Eq. (6) by the product of the averages. This assumption

5

is fulﬁlled in the limit of large networks. In the analysis below we assume that N → ∞ and

thus obtain recursion equations of the form

The mean cavity indicator function m(i)

r (ℓ) obeys a similar equation of the form

mi(ℓ) = Yr∈∂i\{j}

m(i)

r (ℓ − 1).

m(i)

r (ℓ) = Ys∈∂r\{i,j}

m(r)

s (ℓ − 1).

(7)

(8)

The number of neighbors r ∈ ∂i is given by the degree, ki, of node i, while the number of

neighbors s ∈ ∂r is given by the degree, kr, of node r. Node i is a randomly chosen node

and thus its degree, ki, is drawn from p(k). Node r is an intermediate node along the path

and its probability to be encountered is proportional to its degree. Thus, its degree, kr, is

drawn from the distribution (k/c)p(k), where c takes care of the normalization.

Considering an ensemble of networks, the variables mi(ℓ) and m(i)

r (ℓ), which were deﬁned

for a speciﬁc node, i, on a given instance of the network, turn into the random variables

m(ℓ) and ˜m(ℓ), respectively. These random variables are drawn from suitable probability

distributions, which respect the recursion equations (7) and (8). We denote these distribu-

tions by πℓ(m) = P r[m(ℓ) = m] and ˜πℓ(m) = P r[ ˜m(ℓ) = m]. These distributions obey the

equations

and

πℓ(m) =

∞

Xk=1

p(k)Z 1
0 Z 1

0

. . .Z 1

0

˜πℓ−1(mν)dmνδ m −

mν!

k

Yν=1

˜πℓ(m) =

∞

Xk=1

k
c

p(k)Z 1
0 Z 1

0

. . .Z 1

0

˜πℓ−1(mν)dmνδ m −

mν! .

k−1

Yν=1

Eq. (9) refers to the random node, i, thus its degree is drawn from p(k). Eq. (10) refers

to intermediate nodes along the path, thus the degrees are drawn from the distribution

(k/c)p(k). An additional feature of the intermediate nodes is that one of their edges is

consumed by the incoming link, leaving only k − 1 links for the outgoing paths.

The expectation values of m(ℓ) and ˜m(ℓ) over the graph ensemble yield the conditional

probabilities

6

k

Yν=1

k−1

Yν=1

(9)

(10)

mℓ = P (d > ℓ|d > ℓ − 1) =Z 1

0

mπℓ(m)dm

and

˜mℓ = ˜P (d > ℓ|d > ℓ − 1) =Z 1

0

m˜πℓ(m)dm.

Plugging Eqs. (9) and (10) into Eqs. (11) and (12), respectively, we obtain the recursion

(11)

(12)

(13)

(14)

(15)

(16)

(17)

(18)

which are valid for ℓ ≥ 2. Recalling that p(0) = 0, Eqs. (13) and (14) can be written using

equations

and

mℓ =

∞

Xk=1

p(k)( ˜mℓ−1)k

˜mℓ =

∞

Xk=1

k
c

p(k)( ˜mℓ−1)k−1,

the degree generating functions [15]

and

where

and

mℓ = G0 ( ˜mℓ−1)

˜mℓ = G1 ( ˜mℓ−1) ,

G0(x) =

p(k)xk

∞

Xk=0

G1(x) =

k
c

p(k)xk−1.

∞

Xk=0

Eq. (13) can be understood intuitively as follows. Consider the simpliﬁed scenario in which

node i is known to have a degree k. In this case, excluding a path of length ℓ from i to

j is equivalent to excluding a path of length ℓ − 1 from all k neighbors of i to j, namely

mℓ = ( ˜mℓ−1)k. Such reasoning was applied in Ref.

[21], to obtain the DSPL from a node

7

with a given degree to all other nodes in the network. In practice, the degree of a random

node is unknown, and is distributed according to p(k). Therefore, Eq. (13) averages over all

possible degrees with suitable weights, provided by p(k). Eq. (14) can be understood using

a similar reasoning.

In the case of ﬁnite networks, we obtain

and

mN,ℓ =

N −2

Xk=1

p(k)( ˜mN −1,ℓ−1)k

˜mN,ℓ =

k
c

p(k)( ˜mN −1,ℓ−1)k−1,

N −2

Xk=1

for ℓ ≥ 2. For ℓ = 1 we can directly obtain the results

mN,1 =

N −1

Xk=1

p(k)(cid:18)1 −

1

N − 1(cid:19)k

and

(19)

(20)

(21)

(22)

˜mN,1 =

N −1

Xk=1

k
c

p(k)(cid:18)1 −

1

N − 1(cid:19)k−1

.

The tail distribution of the shortest path lengths can be expressed as a product of the form

Yℓ′=1

Yℓ′=1

PN (d > ℓ) = PN (d > 0)

PN (d > ℓ′|d > ℓ′ − 1) ≡ PN (d > 0)

mN,ℓ′.

(23)

ℓ

ℓ

Actually, since we choose two diﬀerent nodes as the initial and ﬁnal nodes, PN (d > 0) = 1,

which further simpliﬁes Eq. (23).

In Fig. 2 we illustrate the way the recursion equations are iterated ℓ′ − 1 times along the

diagonal in order to obtain mN,ℓ′. Starting from ˜mN −ℓ′,1 (squares), Eq. (20) is iterated ℓ′ − 2

times (empty circles), followed by a single iteration (full circles) of Eq. (19). The desired

value of PN (d > ℓ) is obtained from Eq. (23). This product runs from bottom to top along

the rightmost column of Fig. 2.

The probability distribution function, namely, the probability PN (ℓ) = PN (d = ℓ) that

the shortest path length between a random pair of nodes is equal to ℓ can be obtained from

the tail distribution by

8

PN (ℓ) = PN (d > ℓ − 1) − PN (d > ℓ),

(24)

for ℓ = 1, 2, . . . , N − 1.

It should be noted that Eqs. (9) and (10), presenting the distributions πℓ(m) and ˜πℓ(m)

enable the analysis of ﬂuctuations of the conditional probabilities within an ensemble of

networks with a given degree distribution in the large N limit.

IV. PROPERTIES OF THE DSPL

The distribution of shortest path lengths, PN (ℓ), can be characterized by its moments.

The nth moment, hℓni, can be obtained using the tail-sum formula [31]

N −2

hℓni =

[(ℓ + 1)n − ℓn]PN (d > ℓ).

(25)

Xℓ=0

Note that the sum in Eq. (25) does not extend to ∞ because the longest possible shortest

path in a network of size N is N − 1. The average distance between pairs of nodes in the

network is given by the ﬁrst moment

N −2

hℓi =

PN (d > ℓ).

(26)

The average distance between nodes in conﬁguration model networks has been studied ex-

tensively [15, 18, 20, 32–36]. It was found that

hℓi ≃

+ O(1).

(27)

Xℓ=0

ln N

ln(cid:16) hk2i−hki
hki (cid:17)

N −2

Xℓ=0

The width of the distribution can be characterized by the variance σ2

ℓ = hℓ2i − hℓi2, where

hℓ2i =

(2ℓ + 1)PN (d > ℓ).

(28)

In addition to the average distance hℓi, another common measure of the typical distance

between nodes in the network is the mode. Here we present a way to extract the mode

of PN (ℓ) directly from the recursion equations, in the limit of a large network. It is based

on the following observations: (a) The tail-distribution, PN (d > ℓ), is a sigmoid function,

9

i.e.

it starts at 1 at the origin and drops to 0 at inﬁnity. The transition between the two

levels occurs over a relatively narrow interval; (b) Actually, PN (d > ℓ) can be expressed

as a product of conditional probabilities of the form mN,ℓ′, where each term has the form

of a sigmoid function [Eq. (23)]. Therefore, the product becomes an even sharper sigmoid

function, and to a good approximation its maximal slope is determined by the the last term

in the product. Therefore, in the analysis below we focus on the conditional probability

mN,ℓ.

Considering the large N limit we can use the recursion equations (15) and (16). The

generating functions satisfy G0(1) = G1(1) = 1, thus both equations exhibit a (repelling)

ﬁxed point at mℓ = ˜mℓ = 1. Note that in this formulation, the network size N does not

appear explicitly in the recursion equations, but only enters through the initial conditions,

given by Eqs. (21) and (22). For simplicity, we approximate Eqs. (21) and (22) by

and

m1 ≃ 1 −

c

N − 1

+ O(cid:18) 1

N 2(cid:19) ,

(29)

(30)

˜m1 ≃ 1 −

hk2i − hki
hki(N − 1)

+ O(cid:18) 1

N 2(cid:19) ,

respectively. For networks which are not too dense, these values are only slightly smaller

than 1. Therefore, the linearized versions of Eqs. (15) and (16) hold as long as mℓ and ˜mℓ

are suﬃciently close to 1. Note that these expressions require that the second moment hk2i

would be ﬁnite. This condition may limit the validity of the derivation presented below to

networks for which hk2i is bounded. Thus, networks for which hk2i diverges require special

attention.

The location of the maximum value of the probability distribution function (namely the

mode) is obtained at the point where the tail distribution falls most sharply. Up to that

point the linear approximation holds quite well. This motivates us to perform the analysis

in terms of the deviations

and

ǫℓ = 1 − mℓ,

(31)

10

Linearizing Eqs. (15) and (16) in terms of ǫℓ and ˜ǫℓ, respectively, we obtain

˜ǫℓ = 1 − ˜mℓ.

and

ǫℓ = hki˜ǫℓ−1,

(32)

(33)

(34)

˜ǫℓ =(cid:20) hk2i − hki

hki

(cid:21)ℓ−1

˜ǫ1,

for any ℓ ≥ 2, where ˜ǫ1 = (hk2i − hki)/[hki(N − 1)]. Our aim is to determine the value of ℓ

at which the reduction in mℓ is maximal. We denote the discrete derivative

Using the recursion equations (15) and (16), we can express this as

∆P = mℓ−1 − mℓ.

∆P = G0( ˜mℓ−2) − G0[G1( ˜mℓ−2)],

(35)

(36)

and are therefore interested in the value of x, denoted by xmax, at which the function

∆P (x) = G0(x)−G0[G1(x)] is maximal. This is determined by the solution of the extremum

condition

d∆P
dx

= G′

0(x) − G′

0[G1(x)]G′

1(x) = 0.

(37)

As long as xmax is close to 1 we can use the linear approximation leading to Eq. (34), in

which case we can equate ˜ǫℓmode−2+O(1) = 1 − xmax, where the O(1) term comes from the

fact that we are using a linearized equation while potentially higher order corrections should

have been considered. This term is small and could be omitted when xmax is close to 1,

which is the situation in various known cases. Combining this result with Eq. (34) we obtain

ln [(N − 1)(1 − xmax)]

ℓmode =

+ 2 + O(1).

(38)

ln(cid:16) hk2i−hki
hki (cid:17)

It is interesting to note that the mode exhibits the same scaling with the network size as

the average distance shown in Eq. (27). This analysis is in the spirit of the renormalization

11

group approach, where the ﬂow of an initial small deviation from the critical temperature

(here from the ﬁxed point m = 1), under the linearized renormalization transformation

determines the scaling behaviour of the system.

V. ANALYSIS OF NETWORK MODELS

To examine the recursion equations we apply them to the calculation of the DSPL in

conﬁguration model networks with diﬀerent choices of the degree distribution. The results

are compared to numerical simulations. In these simulations we generate instances of the

conﬁguration model networks with the required degree distribution. We then calculate the

distances between all pairs of nodes in each network and generate a histogram. The process

is repeated over a large number network instances. In case that the network includes more

than one connected cluster we take into account only the distances between pairs of nodes

which reside on the same cluster. The DSPL obtained from the numerical simulations is

normalized accordingly.

To cover a broad class of networks, we consider conﬁguration models which exhibit narrow

as well as broad degree distributions. For networks with narrow degree distributions we study

the the regular network (degenerate distribution) and networks with a binomial distribution.

For networks with broad degree distributions we study conﬁguration models with power-law

degree distributions (scale-free networks). A detailed analysis of the distributions of shortest

path lengths in these conﬁguration models is presented below.

A. Regular Networks

The simplest case of the conﬁguration model is the regular graph, in which the degree

distribution is p(k) = δk,c, namely all N nodes have the same degree, (where c ≥ 2 and Nc

is even). For c = 2 the network consists only of loops, while for c ≥ 3 more complex network

structures appear. The random regular graph ensemble has been studied extensively and

enjoys many analytical results [37]. In particular, there is an interesting phase transition

at c = 3 above which the network becomes connected with probability 1 in the asymptotic

limit.

In case of the regular graph the recursion equations (19) and (21) take the form

12

and

mN,ℓ = ( ˜mN −1,ℓ−1)c

respectively. The subsequent equations, derived from Eqs. (20) and (22) take the form

mN,1 =(cid:18)1 −

1

N − 1(cid:19)c

,

and

˜mN,ℓ = ( ˜mN −1,ℓ−1)c−1

(39)

(40)

(41)

(42)

The iteration of these equations gives rise to a closed form equation for the conditional

˜mN,1 =(cid:18)1 −

1

N − 1(cid:19)c−1

.

probabilities

PN(cid:0)d > ℓ|d > ℓ − 1) = mN,ℓ =(cid:18)1 −

1

N − ℓ(cid:19)c(c−1)(ℓ−1)

.

(43)

Inserting the conditional probabilities into Eq. (23), and using the approximation N −ℓ ≃ N,

we obtain the tail distribution

in agreement with Eq. (1.10) in Ref. [34].

PN(cid:0)d > ℓ) = exp(cid:20)−

c(c − 1)ℓ

N(c − 2)(cid:21) ,

(44)

Actually, in this case, Eqs. (9) and (10), describing the ﬂuctuations in the ensemble in

the large N limit, can be solved analytically yielding

πℓ(m) = δ"m −(cid:18)1 −

1

N(cid:19)c(c−1)(ℓ−1)# .

(45)

This means that in regular networks, for suﬃciently large N, the ﬂuctuations are negligible.

The mean distance, hℓi, for the regular graph thus takes the form

It is useful to deﬁne

hℓi =

e−

N −2

Xℓ=0

13

ℓ

c(c−1)

N(c−2) .

(46)

s =(cid:22) ln N

ln(c − 1)(cid:23) ,

(47)

where ⌊x⌋ is the integer part of x. It is easy to see that for ℓ = 0, 1, . . . , s, the exponents

on the right hand side of Eq. (46) are very close to 1, while for ℓ > s these exponents are

quickly reduced. Therefore, to a very good approximation hℓi = ln N/ ln(c − 1). In order to

obtain a more systematic approximation of hℓi we take into account explicitly a few terms

around ℓ = s in Eq. (46). For example, taking three terms explicitly we obtain

hℓi = (s − 1) +

ℓ

c(c−1)

N(c−2) .

e−

(48)

One can easily improve the approximation by including additional explicit terms to the right

and left of ℓ = s. Higher order moments can be evaluated in a similar fashion, yielding

s+1

Xℓ=s−1

s+r

Xℓ=s−r

hℓni = (s − r)n +

[(ℓ + 1)n − ℓn]e−

ℓ

c(c−1)

N(c−2) ,

(49)

where r is the number of terms taken into account explicitly on the right and on the left.

The variance of PN (ℓ) is thus

r

(2ℓ′ + 2r + 1)e−

σ2
ℓ =

Xℓ′=−r

c(c−1)s+ℓ′

N(c−2) −" r
Xℓ′=−r

e−

c(c−1)s+ℓ′

N(c−2) #2

.

(50)

In Fig. 3 we present the DSPL for regular networks of N = 1000 nodes, with c = 5, 20 and

50, obtained from Eq. (44). The tail distribution P (d > ℓ) is shown in Fig. 3(a) and the

probability distribution function P (d = ℓ) is shown in Fig. 3(b). The results are compared

with computer simulations showing excellent agreement.

In Fig. 4 we present the mean distance in regular graphs of N = 1000 nodes vs. the

degree c, obtained from the recursion equations (⋄). The results are in excellent agreement

with numerical simulations (+). As expected, the average distance decreases logarithmically

as c is increased, in very good agreement with the exact result hℓi = ln N/ ln(c − 1).

For the regular graph, hki = c and hk2i = c2. Plugging the degenerate degree distribution

p(k) = δk,c into Eqs. (17) and (18) we obtain that for the regular network G0(x) = xc and
G1(x) = xc−1. Since the distribution PN (ℓ) for the regular network is narrow, one expects

the mode ℓmode of this distribution to follow closely the mean value hℓi and to increase

14

logarithmically as a function of N. Here we evaluate ℓmode using Eq.
xmax = (c − 1)−1/(c−1) into Eq. (38) we obtain

(38).

Inserting

ℓmode =

ln N

ln(c − 1)

+ O(1).

(51)

Unlike hℓi the mode takes only integer values. Therefore, it must take the form of a step

function vs. N. In Fig. 5 we present ℓmax vs. N on a semi-logarithmic scale. The general

trend indeed satisﬁes ℓmax ∼ ln N, but the graph is decorated by steps at integer values of

ℓmax.

B. Networks with Binomial Degree Distributions

To further examine the recursion equations, we extend the analysis to networks which

exhibit a narrow or bounded degree distribution, with an average hki = c and variance σ2
k.

Since the degree distribution, p(k), is a discrete distribution, the binomial distribution

p(k) =(cid:18)n

k(cid:19)pk(1 − p)n−k,

where n is an integer and 0 < p < 1, is particularly convenient. Its mean is given by hki = np
k = np(1 − p). In order to obtain desired values of hki and σ2
k,

and its variance is given by σ2

(52)

(53)

(54)

we choose the parameters n and p according to

where Round(x) is the nearest integer to x, and

n = Round(cid:18) hki2

hki − σ2

k(cid:19) ,

p =

hki − σ2
k

hki

.

It is important to note that the parameter, n, is not related to the network size, N, and can

be either larger or smaller than N. However, one should choose a combination of n and p

for which the probability, p(k), for k > N − 1 is vanishingly small, otherwise a truncation

will be needed, which will deform the distribution. In Fig. 6(a) we present the binomial

degree distributions of three ensembles of networks of N = 1000 nodes, c = 5 (+), 20 (×)

and 50 (∗) and σk = 4. In Fig. 6(b) we present the tail distributions P (d > ℓ) for these

three network ensembles, obtained from the recursion equations for c = 5 (⋄), 20 ((cid:3)) and

15

50 (◦). The results are found to be in very good agreement with numerical simulations, (+,

× and ∗, respectively).

Plugging the binomial degree distribution of Eq. (52) into Eqs. (17) and (18) we obtain

that G0(x) = [1 − p(1 − x)]n and G1(x) = [1 − p(1 − x)]n−1. In the asymptotic limit, where
n ≫ 1, this expression converges to G0(x) ≃ G1(x) ≃ e−c(1−x).

Here we evaluate ℓmode for a network with a binomial degree distribution using Eq. (38).

For such networks xmax = 1 − ln c/c. Inserting the results above into Eq. (38) we obtain

ℓmode =

ln N
ln c

+ O(1).

(55)

Note that Eqs. (51) and (55) diﬀer in their denominators, where the former is ln(c − 1)

while the latter is ln c. The reason for this diﬀerence comes from the fact that in the regular

network each node has exactly c neighbours, and so only c − 1 of them actually connect

inner to outer shells. However, in the binomial case (as in the ER case), each neighbour of

the initial node has on average an extra edge, and thus c edges connect an inner shell to an

outer shell.

C. Networks with Power-Law Degree Distributions

Studies of empirical networks revealed that many of them exhibit power-law degree dis-

tributions of the form p(k) ∼ k−γ, where 2 < γ < 3. This is the range of values of γ for

which the average degree is bounded but its variance diverges in the inﬁnite system limit.

To construct a conﬁguration model network with a power-law distribution p(k), we ﬁrst

choose a lower cutoﬀ kmin ≥ 1 and an upper cutoﬀ kmax ≤ N − 1. We then draw the degree

sequence ki, i = 1, . . . , N from the distribution

where the normalization coeﬃcient is

p(k) = Ak−γ,

A = [ζ(γ, kmin) − ζ(γ, kmax + 1)]−1,

(56)

(57)

and ζ(s, a) is the Hurwitz zeta function [38]. In the analytical calculations we insert p(k)

from Eq. (56) into the recursion equations in order to obtain the distribution of shortest

16

path lengths for the ensemble of networks produced using this degree distribution. In the

numerical simulation we repeatedly draw degree sequences from this distribution, produce

instances of conﬁguration model networks, calculate the distribution of shortest path lengths

in these networks and average over a large number of instances.

In Fig. 7(a) we present the degree distributions of three scale-free network ensembles

with N = 1000 nodes and γ = 2.5. The lower cutoﬀs of the degree distributions of these

networks are given by kmin = 2, 5 and 8, respectively. In each one of these three ensembles,

the upper cutoﬀ, kmax was chosen such that p(kmax) ≃ 0.01, which means that in a network

of 1000 nodes there will be on average about 10 nodes with degree kmax. In Fig. 7(b) we

present the tail distribution P (d > ℓ) for a scale free network with the degree distributions

shown in Fig. 7(a). The analytical results are in very good agreement with the numerical

simulations.

In the asymptotic limit, where kmax → ∞, the power-law distribution satisﬁes hki =
ζ(γ − 1, kmin)/ζ(γ, kmin) and hk2i = ζ(γ − 2, kmin)/ζ(γ, kmin). Plugging the power-law

degree distribution (56) into Eqs. (17) and (18) we obtain that

and

G0(x) =

Φ(x, γ, kmin)

ζ(γ, kmin)

xkmin

G1(x) =

Φ(x, γ − 1, kmin)

ζ(γ − 1, kmin)

xkmin−1,

(58)

(59)

where Φ(x, γ, k) is the Lerch transcendent [39]. Evaluating ℓmode for a network with a

power-law degree distribution using Eq. (38) we obtain

ℓmode =

+ O(1).

(60)

ln N

hki (cid:17)
ln(cid:16) hk2i−hki

Note that in scale free networks characterized by 2 < γ < 3, the value of the second moment

hk2i is dominated by the upper cutoﬀ, kmax. As long as kmax is kept ﬁnite, ℓmode will depend

on this upper cutoﬀ. On the other hand, in case that kmax = N −1, then for γ = 3 one obtains
that (hk2i − hki)/hki diverges logarithmically with N. As a result, ℓmode ∼ ln N/ ln ln N for
large N. For 2 < γ < 3 one obtains that (hk2i − hki)/hki ∼ (N − 1)3−γ, entailing that

ℓmode = O(1).

17

VI. SUMMARY

We presented a theoretical framework for the calculation of the distributions of shortest

path lengths between random pairs of nodes in conﬁguration model networks. This frame-

work, which is based on recursion equations derived using the cavity approach, provides

analytical results for the distribution of shortest path lengths. We used the recursion equa-

tions to study a broad class of conﬁguration model networks, with degree distributions that

follow the degenerate, binomial and power-law distributions. The results were shown to be

in good agreement with numerical simulations. The mean, mode and variance of the distri-

bution of shortest path lengths were also evaluated and expressed in terms of moments of the

degree distribution, illuminating the important connection between the two distributions.

18

[1] R. Albert and A.L. Barab´asi, Rev. Mod. Phys. 74, 47 (2002).

[2] G. Caldarelli, Scale free networks: complex webs in nature and technology (Oxford University

Press, Oxford, 2007).

[3] S. Havlin and R. Cohen, Complex Networks: Structure, Robustness and Function (Cambridge

University Press, New York, 2010).

[4] M.E.J. Newman, Networks: an Introduction (Oxford University Press, Oxford, 2010).

[5] E. Estrada, The structure of complex networks: Theory and applications (Oxford University

Press, Oxford, 2011).

[6] A. Ma´ayan, S.L. Jenkins, S. Neves, A. Hasseldine, E. Grace, B. Dubin-Thaler, N.J. Eung-

damrong, G. Weng, P.T. Ram, J.J. Rice, A. Kershenbaum, G.A. Stolovitzky, R.D. Blitzer, R.

Iyengar1, Science 309, 1078 (2005).

[7] E.W. Dijkstra, Numerische Mathematik l, 269 (1959).

[8] D. Delling, P. Sanders, D. Schultes and D. Wagner, Engineering Route Planning Algorithms,

in Algorithmics of Large and Complex Networks: Design, Analysis, and Simulation, J. Lerner,

D. Wagner, and K.A. Zweig (Eds.), p. 117 (2009).

[9] I. Abraham, D. Delling, A.V. Goldberg and R.F. Werneck, J. Experimental Algorithmics 18,

Article 1.3 (2013).

[10] R. Pastor-Satorras and A. Vespignani, Phys. Rev. Lett. 86, 3200 (2001).

[11] R. Pastor-Satorras, C. Castellano, P. Van Mieghem and A. Vespignani, Rev. Mod. Phys. 87,

925 (2015).

[12] B. Bollobas, Random Graphs, Second Edition (Academic Press, London, 2001).

[13] D.J. Watts and S.H. Strogatz, Nature 393, 440 (1998).

[14] A. Fronczak, P. Fronczak, and J.A. Holyst, Phys. Rev. E 70, 056110 (2004).

[15] M.E.J. Newman, S.H. Strogatz, and D.J. Watts, Phys. Rev. E 64, 026118 (2001).

[16] V.D. Blondel, J.-L. Guillaume, J.M. Hendrickx and R.M. Jungers, Phys. Rev. E 76, 066101

(2007).

[17] S.N. Dorogotsev, J.F.F. Mendes and A.N. Samukhin, Nuclear Physics B 653, 307 (2003).

[18] R. van der Hofstad, G. Hooghiemstra and D. Znamenski, Electronic Journal of Probability 12,

703 (2007).

19

[19] R. van der Hofstad and G. Hooghiemstra, J. Math. Phys. 49, 125209 (2008).

[20] H. van der Esker, R. van der Hofstad and G. Hooghiemstra, J. Stat. Phys. 133, 169 (2008).

[21] E. Katzav, M. Nitzan, D. ben-Avraham, P.L. Krapivsky, R. K¨uhn, N. Ross and O. Biham,

EPL 111, 26006 (2015).

[22] P. Erd˝os and R´enyi, Publ. Math. 6, 290 (1959).

[23] P. Erd˝os and R´enyi, Publ. Math. Inst. Hung. Acad. Sci. 5, 17 (1960).

[24] P. Erd˝os and R´enyi, Bull. Inst. Int. Stat. 38, 343 (1961).

[25] M. Molloy and B. Reed, Random Struct. Algorithms 6, 161 (1995).

[26] M. M´ezard, G. Parisi and M.A. Virasoro, J. Physique Lett. 46, L217 (1985).

[27] M. M´ezard and G. Parisi, J. Stat. Phys. 111, 1 (2003).

[28] M. M´ezard and A. Montanari, Information, Physics and Computation (Oxford University

Press, 2009).

[29] G. Del Ferraro, C. Wang, D. Mart´ı and M. M´ezard, Cavity Method - Message Passing from

a Physics Perspective, Statistical Physics, Optimization, Inference and Message-Passing Al-

gorithms, Lecture Notes of the Les Houches School of Physics, Eds. F. Krzakala, F. Ricci-

Tersenghi, L. Zdeborova, R. Zecchina, E.W. Tramel, and L.F. Cugliandolo (Oxford University

Press, 2015).

[30] Lao Tzu, Tao Te Ching (Harper Perennial, 1992).

[31] J. Pitman, Probability (Springer, New York, 1993).

[32] F. Chung and L. Lu, Proc. Nat. Acad. Sci. USA 99, 15879 (2002)

[33] F. Chung and L. Lu, Internet Mathematics 1, 91 (2003).

[34] R. van der Hofstad, G. Hooghiemstra and P. Van Mieghem, Random Structures Algorithms

27, 76 (2005).

[35] H. van den Esker, R. van der Hofstad, G. Hooghiemstra and D. Znamenski, Extremes 8, 111

(2006).

[36] B. Bollobas, S. Janson and O. Riordan, Random Structures and Algorithms 31, 3 (2007).

[37] N.C. Wormald, Models of random regular graphs, in LMS Lecture Note Series, Surveys in

Combinatorics Eds. J.D. Lamb and D.A. Preece, pages 239-298 (Cambridge University Press,

1999).

[38] F.W.J. Olver, D.M. Lozier, R.F. Boisvert and C.W. Clark, NIST Handbook of Mathematical

Functions (Cambridge University Press, 2010).

20

[39] I.S. Gradshteyn and I.M. Ryzhik, Tables of Integrals, Series, and Products, 6th edition (Aca-

demic Press, San Diego, 2000).

21

(cid:1840)(cid:3398) 1

2

(cid:1840)(cid:3398) 2

(cid:1840)
r(cid:2869) r(cid:2870)
r(cid:3038)

1

(cid:1861)

(cid:1862)

(cid:954)

FIG. 1:

(Color online) Illustration of the possible paths of length ℓ between two random nodes, i

and j, in a network of N nodes. The ﬁrst edge of such a path connects node i to some other node,

r, which may be any one of the k neighbors of node i. The rest of the path, from node r to node j

is of length ℓ − 1 and it resides on a smaller network of N − 1 nodes, from which node i is excluded.

(cid:1840)(cid:3398)(cid:954)

network

size

(cid:1840)

distance

(cid:1856) =(cid:954)
(cid:1856) = 1

FIG. 2:

(Color online) Illustration of the iteration process of the recursion equations (19), and

(20), which carry over along the diagonals (empty circles). Starting from ˜mN −ℓ′,1 (squares), given

by Eq. (22), the iteration gives rise to mN,ℓ′ (full circles). Eventually, PN (d > ℓ) is obtained as a

product of the results in the right-most column [Eq. (23)].

22

1

0.8

0.6

0.4

0.2

)
ℓ
=
d
(
P

0

0

2

1

0.8

0.6

0.4

0.2

)
ℓ
>
d
(
P

0

0

1

2

3

4
ℓ

4
ℓ

(a)

6

8

(b)

5

6

7

8

FIG. 3:

(Color online) Distribution of shortest path lengths in a regular graph. The results of the

recursion equations for P (ℓ) (a) and P (d > ℓ) (b), for c = 5, 20 and 50 (♦, (cid:3) and (cid:13) , respectively),

ﬁt well the numerical results (+, × and ∗, respectively). The numerical results were averaged over

50 graph instances in a graph of size N = 1000.

23

5

4

3

2

1

i
ℓ
h

0

0

10

20
c

30

40

FIG. 4:

(Color online) Mean shortest path length, hℓi, vs. the degree, c, in a regular graph of

size N = 1000. The results of the recursion equations (♦) are in very good agreement with the

numerical results (+). The numerical results were averaged over 50 graph instances.

12

10

e
d
o
m

ℓ

8

6

4

102

103

N

FIG. 5:

(Color online) The mode of the distribution PN (ℓ) as a function of the network size, N ,

for a regular network of degree c = 3. Overall, the mode scales logarithmically with the network

size. However, on a ﬁner scale it forms steps due to the discreteness of the distance ℓ.

24

(a)

20

40

60

0.3

0.25

0.2

0.15

0.1

0.05

)
k
(
p

0

0

1

0.8

0.6

0.4

0.2

)
ℓ
>
d
(
P

k

4
ℓ

(b)

5

6

7

8

0

0

1

2

3

FIG. 6:

(Color online) (a) The degree distributions of three networks of size N = 1000, where p(k)

was drawn from binomial distributions with means c = 5 , 20 and 50 (+, × and ∗, respectively),

for which the standard deviation is σk = 4. The results were obtained from numerical simulations,

averaging over 50 graph instances. These results verify the construction of the conﬁguration model

network. (b) The tail distribution P (d > ℓ), obtained from the recursion equations (♦, (cid:3) and (cid:13),

respectively), and from numerical simulations (+, × and ∗ , respectively), for the three networks

described above. It is observed that as the mean degree is increased, the average distance decreases.

25

(a)

102

(b)

101

k

100

10-1

)
k
(
p

10-2

1

0.8

0.6

0.4

0.2

)
ℓ
>
d
(
P

0

0

1

2

3

5

6

7

8

4
ℓ

FIG. 7:

(Color online) (a) The degree distributions of three networks of size N = 1000, where

p(k) was drawn from power-law distributions with γ = 2.5 and lower cutoﬀs at kmin = 2, 5 and

8 (+, × and ∗, respectively). The upper cutoﬀs, kmax were set such that p(kmax) = 10/N . The

results were obtained from numerical simulations, averaging over 50 graph instances. (b) The tail

distributions P (d > ℓ), obtained from the recursion equations (♦, (cid:3) and (cid:13), respectively), and

from numerical simulations (+, × and ∗, respectively), for the three networks described above. It

is observed that as the lower cutoﬀ, kmin, is increased, the mean distance decreases.

26

