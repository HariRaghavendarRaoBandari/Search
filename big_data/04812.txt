User Selection and Minimum Probability of

Error Multiuser Transmit Beamforming

1

Majid Bavand, Student Member, IEEE, Steven D. Blostein, Senior Member, IEEE

6
1
0
2

 
r
a

 

M
5
1

 
 
]
T
I
.
s
c
[
 
 

1
v
2
1
8
4
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

Motivated by the challenges to the existing multiuser transmission methods in a low signal to noise
ratio (SNR) regime, in this paper we show that it is beneﬁcial in this regime to incorporate knowledge of
modulation type in the design of the multiuser transmit beamformer. We propose a transmit beamforming
method by utilizing the concept of minimum probability of error (MPE). In a multiuser scenario, an
objective function is designed based on the weighted sum of error probabilities of each user. We take a
convex optimization approach to transform and solve this ill-behaved nonconvex optimization problem. It
is shown that by minimizing this objective function, the performance of the system could be dramatically
improved. We then develop a user selection algorithm compatible with MPE beamforming that selects
the maximum number of users with their error probabilities approaching zero. Based on line packing
principles in Grassmannian manifolds, it is shown that the number of selected users could potentially
be more than the number of transmit antennas.

Index Terms

Broadcast channels, convex optimization, Grassmannian manifolds, line packing, minimum proba-

bility of error, scheduling, transmit beamforming.

I. INTRODUCTION

Wireless multiple input multiple output (MIMO) channels have been attracting a great deal
of interest in the last decades [1]–[4]. MIMO technologies are already at the core of several
wireless standards, since they provide improvements in terms of spectral efﬁciency and reliability
compared to single input single output (SISO) channels. Hence, the design of MIMO systems has
been usually posed under two different perspectives: either the increase of the data transmission
rate through spatial multiplexing or the improvement of the system reliability through the
increased antenna diversity. Spatial multiplexing is a simple MIMO transmit technique in that

2

it does not require channel state information (CSI) at the transmitter and allows a high spectral
efﬁciency by splitting the incoming data into multiple independent substreams and transmitting
each substream on a different antenna as in V-BLAST [1]. When CSI is available at the
transmitter, channel-dependent linear precoding (transmit beamforming) of the data substreams
can further improve the performance by adapting the transmitted signal to the instantaneous
channel state. In this case, employing multiuser MIMO techniques allows for gain in sum capacity
obtained by channel reuse [2]–[5].

Although channel reuse for multiple users is advantageous in terms of throughput, when
multiple uncoordinated links share a common communication medium, e.g., in a broadcast
system, cochannel interference caused by the transmission of multiple users’ data on the same
carrier frequency could limit channel reuse [6]. Most wireless systems deal with interference
by orthogonalizing the communication links in time or frequency, so that they do not interfere
with one another. It is clear that this approach could be suboptimal since it entails a priori
loss of degrees of freedom in both links independent of the amount of interference. Power
control, beamforming, and scheduling techniques, with capability of reducing interference, are
conventional solutions to the cochannel interference problem [4]. From a practical point of view,
using multiple antennas to communicate with many users simultaneously is especially appealing
in wireless local area network (WLAN) environments, WiMAX, and other time-division duplex
(TDD) systems where channel conditions can readily be learned by all parties [3].

Classically, a beamformer controls the pattern of the antenna array by setting the antenna
array weights to satisfy a certain optimization criterion. Many beamforming methods aim at
maximizing throughput. However, the problem with this criterion is that it implicitly presumes
that an unrealizable ideal continuous Gaussian code is used instead of a signal constellation
[7]. On the other hand, whenever the transmitter sends a modulated signal the throughput is
determined largely by the order of modulation. Signal to noise ratio (SNR), signal to interference
plus noise ratio (SINR), mean square error (MSE) between the desired signal and the array output,
and signal to leakage ratio (SLR) are other common criteria in formulating the beamforming
optimization problem [2], [3], [5]. However, for a communication system, probability of error
or the achievable bit error rate (BER) is a more direct system performance metric [8]–[12].
Therefore, the performance of a system could be improved if the beamformer is designed in a
way to directly minimize the error probability.

3

The error probability of each user in a multiuser downlink system depends on the modulation
type. Therefore, to design a beamformer that minimizes the error probability, one ought to
account for the modulation type which is not considered in classical beamforming methods such
as minimum mean square error (MMSE), maximum signal to leakage plus noise ratio (MSLNR),
and block diagonalization (BD) [13]. In this paper, it is established that by considering the
modulation type in the design of beamforming weights the performance of the system could be
signiﬁcantly improved.

As mentioned earlier, selecting a subset of users for transmission in MIMO broadcast channel,
is another conventional solution to to the cochannel interference problem for increasing the
system throughput and reliability. The gain in throughput and reliability is obtained by multiuser
diversity presented by user selection when the number of users is large. Although the optimal
user subset can be found by brute-force search over all possible combinations of user subsets,
its computational complexity is prohibitive. Hence, low complexity scheduling algorithms are
desired in practice [4], [14]–[17]. For example in [4], [14], low complexity algorithms based
on semi-orthogonal user selection are presented are based on zero forcing beamforming and
achieve the same asymptotic (high SNR) sum rate as dirty paper coding for broadcast channels.
In [15], a greedy based user selection is proposed based on BD beamforming and increases
the total throughput of the users. In this paper, we propose a user selection algorithm for MPE
beamforming that semi-greedily selects the set of users by a geometric approach such that the
number of selected users is made as large as possible. It is shown that for a one-dimensional
modulation such as binary phase-shift keying (BPSK), it is possible to utilise the extra dimensions
provided by the complex channel and transmit information at the same time and frequency to
more users than the number of antennas of the transmitter.

The rest of the paper is organized as follows: in Section II, the system model is introduced.
In Section III, the error probability of a user in the downlink of a multiuser system is calculated
assuming the transmitter is using BPSK modulation and linear beamforming for transmission.
Section IV presents the minimum probability of error (MPE) transmit beamforming considering
two different scenarios. First, it is assumed that the receiver uses a single-user maximum
likelihood detector. Second, it is assumed that the transmit beamforming weights and the receive
ﬁlter coefﬁcients are calculated jointly at the transmitter. In both scenarios we try to transform the
beamforming optimization problem to convex optimization subproblems and present algorithms

4

Fig. 1. System model.

for ﬁnding the beamforming vectors of users. In Section V, by taking a geometric approach, a
user selection algorithm compatible with MPE beamforming is presented. Numerical results are
demonstrated in Section VI. Finally, conclusions are drawn in Section VII.

II. SYSTEM MODEL

We consider a broadcast system with one transmitter and K receivers (users) which are
preselected out of KT total users as in Fig. 1. It is assumed that the transmitter consists of
an array of antennas with with M elements and each receiver j, 1 ≤ j ≤ K, has one antenna in
its array. It is also assumed that the transmitter has one symbol encoded in sj for each receiver
j, 1 ≤ j ≤ K to be transmitted in the same time and frequency slots. The transmitter uses an
M × 1 precoding vector uj to encode the transmitted symbols intended for receiver j. Ignoring
the noise at the transmitter’s output, and assuming that the transmitter has information symbols
for all of the K preselected receivers we can model the M × 1 transmitted signal vector as

K(cid:88)

x =

ulsl = Us,

l=1

··· , uK] and s = [s1, . . . , sK]T . The channel matrix between M antennas
where U = [u1,
of the transmitter and the single antenna of receiver j can be represented by the 1 × M
vector hj with entries following an independent identically distributed (i.i.d.) circularly complex
Gaussian distribution with zero mean and variance 1. This channel model is valid for narrow-band
(frequency non-selective) systems if the transmit and receive antennas are in non line-of-sight
rich-scattering environments with sufﬁcient antenna spacing [14], [18]. At receiver j the received

5

signal can be modeled as

rj = hjx + zj =

K(cid:88)

l=1

hjulsl + zj = ¯rj + zj,

1 ≤ j ≤ K,

z.
where zj is modeled as circularly complex Gaussian noise with zero mean and variance σ2

At receiver j the received signal is processed by a ﬁlter. Therefore the output at the receiver

j can be written as

yj = yj(wj, U) = wjrj =

K(cid:88)

l=1

wjhjulsl + wjzj = ¯yj + z(cid:48)
j,

1 ≤ j ≤ K,

where wj is the complex-valued ﬁlter coefﬁcient at receiver j and z(cid:48)
noise with variance σ2
dependence on these parameters.

j = wjzj is circularly Gaussian
j . We also express yj as a function of wj and U to emphasize its

z wjwH

III. ERROR PROBABILITY

To calculate the error probability of each user in a broadcast channel one needs to know the
estimation technique that the receiver is using in addition to the modulation type. Motivated by
the facts that a low dimensional modulation like BPSK is employed in wireless systems such
as IEEE 802.11a,n,ac, and it is often selected in systems with adaptive modulation when SNR
is low, we assume BPSK modulation for all users [19], [20]. It is also assumed that the system
operates with the following decision rule for estimating the transmitted symbols of user j when
the output noise is additive white Gaussian:

ˆsj = sign(yR

j ),

where the superscript R denotes taking the real part operation, i.e., xR = Re{x}.

Here, the error probability of each user j, 1 ≤ j ≤ K, is calculated as a function of its
receive ﬁlter coefﬁcient and its transmit beamforming weight vector as well as the transmit
beamforming weight vectors of all other users (Pej (wj; U), 1 ≤ j ≤ K). Later in Section IV,
we use this probability of error to calculate beamforming weights for two different scenarios,
namely, a scenario in which each receiver estimates the transmitted signal according to a classical
single-user maximum likelihood scheme without relying on knowledge of other channels, and

6

a joint transmit-receive (Tx-Rx) beamforming scenario in which both the receive and transmit
beamforming weights are calculated at the transmitter and then the calculated receive ﬁlter
coefﬁcient of each user is provided to its receiver via the forward channel.

The error probability at the output of receiver j is expressed as

Pej = Pej (yj; wj, U) = P (ˆsj (cid:54)= sj)

= P0P (ˆsj = 1|sj = −1) + P1P (ˆsj = −1|sj = 1)
= P (ˆsj = −1|sj = 1) = P (yR

j < 0|sj = 1),

where P0 = P (sj = −1), P1 = P (sj = +1), and P (.) is the probability of an event. It is
assumed that P0 = P1 = 1/2, i.e., the transmitted BPSK modulated signal sj takes its elements
from the set {±1} with equal probability, which could be the result of source compression and
hard decision. It should be remarked that, using uniform rather than Gaussian distribution over
signal sets causes an asymptotic loss in throughput which could be compensated to some extent
by using constellation shaping techniques [20]. The symmetry in the estimation of +1 and −1
j |sj = −1) and
for user j is also considered, which is the result of the symmetry between p(yR
j |sj = +1), where p is the probability density function (pdf), and consequently results in
p(yR
P (ˆsj = −1|sj = +1) = P (ˆsj = +1|sj = −1). More generally, let us denote the number of
constellation points in the modulation by L, e.g., L = 2 for BPSK. Therefore, Nb = LK is
the number of possible symbol sequences for all K users in one transmission, i.e., there could
be LK different possible sets of K-tuple symbols sb, 1 ≤ b ≤ Nb, for K users. Assuming
BPSK transmission, we denote Npb = 2K−1 as the number of possible symbol sequences for
transmission if the transmitted symbol of user j is already known to be either +1 or −1.

Using the total probability theorem, equal probability for transmission of BPSK constellation

points, and Gaussian output noise Re{z(cid:48)

j}, we have
(cid:88)

l∈{1,...,K}
sl∈{±1}

l(cid:54)=j

p(yR

1
Npb

j |sj = +1) =
1(cid:113)

Npb(cid:88)

1
Npb

=

b=1
sj(cid:54)=−1

πσ2

z wH

j wj

p(yR

j |sj = +1,{sl})

exp−(yR

j − ¯yR
j,b(wj, U))2
z|wj|2
σ2

,

where ¯yR

j,b(wj, U) is Re{¯yj} when sb is transmitted, i.e.,
j,b(wj, U) = Re{wjhjUsb},
¯yR
(cid:90) 0

Therefore, the probability of error can be calculated as

1 ≤ b ≤ Nb.

Pej =

p(yR

−∞

j |sj = +1)dyR
j =
(cid:32)

sb,jRe{wjhj
σz√
2

Q

Nb(cid:88)

b=1

=

1
Nb

Npb(cid:88)

 ¯yR
j,b(cid:113) σ2
(cid:33)

z|wj|2
2

1
Npb

Q
(cid:80)K
b=1
sj(cid:54)=−1
l=1 ulsb,l}
(cid:82) ∞
x e− u2

1√
2π

,

|wj|



7

(1)

where sb,j is the jth symbol of sb and Q(x) is deﬁned as
2 du. It should be mentioned
that the above system model and error probability calculation could be easily extended to the
multiple receive antenna scenario.

IV. MINIMUM PROBABILITY OF ERROR BEAMFORMING

In this section, our objective is to minimize the weighted sum of error probabilities for two

different scenarios:

1) First scenario- the receiver only needs its own channel information to calculate its ﬁlter
coefﬁcient and there is no need for extra feedback. It is assumed that the receivers use ML
detection. We try to minimize the weighted sum of error probabilities only over transmit
beamforming weights since each receive ﬁlter coefﬁcient could be expressed as a function
of transmit beamforming weights. This method, while yielding suboptimal performance
as compared with joint transmit-receive beamforming is nevertheless easier to practically
realize.

2) Second scenario- we assume joint transmit-receive beamforming in which we minimize the
error sum over both transmit-receive beamforming weights. This approach could be consid-
ered as the optimal method for communication in our broadcast system when considering
the error probability as the measure of quality.

If one wants to minimize error probabilities of all users, it means that several objective functions
have to be minimized which are all interdependent by the common transmit beamforming matrix.
A standard approach to this multiple-objective optimization problem is to combine the individual
objective functions into a single composite function [21], [22]. Similar to [7], we use the weighted

8

(cid:80)K

1(cid:80)K

j=1 αjPej. If αj = 1 for all users, i.e., all users
average error probability of users Pe =
have the same priority, the weighted average turns to a simple average of the error probability
of users in (1) as

j=1 αj

Pe =

1
K

K(cid:88)
K(cid:88)

j=1

Pej

1

=

KNb

j=1

b=1

Nb(cid:88)

(cid:32)

Q

(cid:80)K
l=1 ulsb,l}

sb,jRe{wjhj
σz√
2

|wj|

(cid:33)

,

(2)

which is considerd as the system performance criterion hereafter. The parameters w = [w1, . . . , wK]
and U have a bilinear dependence in each Q-function argument of (2). Now, we state the
following constraints that are required in both forthcoming scenarios.

Lemma 1: For the jth user not to have an error ﬂoor (a lower bound on error probability with

a rough value of 1/Nb), it is necessary for wj to comply with the following constraints:

sb,jRe

wj

hjulsb,l

≥ 0,

1 ≤ b ≤ Nb.

(3)

(cid:80)K
Proof: Assume that there exists a b = b1 such that for a given wj and U, sb1,jRe{wj
l=1 hjulsb1,l} < 0. Therefore,

(cid:41)

(cid:40)

K(cid:88)

l=1

Hence,

Q

.

(4)

Moreover, if there exists a b1 such that (4) is true, then there also exists a b2 where each bit in
sb1 is inverted. For b = b2 we also have Q

2, and therefore,

> 1

(cid:80)K
l=1 hj ulsb2,l}
|wj|

sb1,jRe{wj
σz√
2
(cid:32)

sb1,jRe{wj
σz√
2

(cid:80)K
l=1 hjulsb1,l}
|wj|
(cid:80)K
l=1 hjulsb1,l}
|wj|
(cid:16) sb2,j Re{wj
(cid:32)

σz√
2

sb,jRe{wj
σz√
2

< 0.

(cid:33)

>

1
2

(cid:17)

Pej >

1
Nb

+

1
Nb

Nb(cid:88)

Q
b=1
b(cid:54)=b1,b2

(cid:80)K
l=1 hjulsb,l}
|wj|

(cid:33)

.

In other words, there always exists an error ﬂoor of 1/Nb.

9

A. Transmit beamforming with ML receiver

For the ﬁrst scenario, it is assumed that the receivers use single-user maximum likelihood
detection similar to [5]. Additionally, for the transmit beamforming design the receive beam-
forming weights are assumed to be available at the transmitter, because they could be calculated
in closedform at the transmitter. For ML detection the receive ﬁlter coefﬁcient of a user can be
expressed as a function of its transmit weight and channel as [5]

wj =

uH
j hH
j
|hjuj|2 ,

1 ≤ j ≤ K.

Consequently, the error probability of a user in (1) will be only a function of U and so will be
the average error probability of users in (2):

(cid:32)(cid:80)K

K(cid:88)

Nb(cid:88)

j=1

b=1

Q

l=1 Re{uH
σz√
2

j hH
|hjuj|

(cid:33)
j hjulsb,lsb,j}

.

P ML
e

(U) =

1

KNb

(5)

Now, we try to minimize the average error probability P ML
(U) by constraining the total trans-
mit power. Based on Lemma 1, without loss of generality the arguments of Q-functions are
constrained to be nonnegative. Thus, the transmit beamforming optimization problem is stated
as

e

P ML
e

U

min
subject to Tr(UUH) ≤ Ptot,

K(cid:88)

Re{uH

j hjulsb,lsb,j} ≥ 0, 1 ≤ j ≤ K, 1 ≤ b ≤ Nb.

j hH

l=1

Now, let us restate the transmit beamforming weight uj of each user as

uj = aj ¯uj,

1 ≤ j ≤ K,

where aj = uj(cid:107)uj(cid:107)2
the following upper bound on (5) is obtained:

is the amplitude of uj and (cid:107)¯uj(cid:107)2 = 1. By using the Cauchy-Schwarz inequality

K(cid:88)

Nb(cid:88)

j=1

b=1

Q(

(cid:80)K
l=1 Re{¯uH
j hH
σz√
2

j hj ¯ulsb,lsb,jal}
(cid:107)hj(cid:107)

P ML-U
e

=

1

KNb

).

(6)

10

Now, we minimize (6) as follows:

P ML-U
e

min
¯U,a

subject to

K(cid:88)
K(cid:88)

j=1

j ≤ Ptot,
a2

|hj ¯uj|2aj+

Re{¯uH

j hH

l=1
l(cid:54)=j
1 ≤ j ≤ K,

(cid:107)¯uj(cid:107) = 1,

j hj ¯ulsb,lsb,jal}≥ 0, 1≤ j≤ K,
1≤ b≤ Nb,

(7a)

(7b)

(7c)

(7d)

where ¯U = [¯u1,··· , ¯uK] and a = [a1,··· , aK].

We propose the alternating minimization algorithm of Table I which minimizes P ML-U

over
¯U and a in alternation to solve (7). In Minimization 1 of the proposed algorithm, when (7a) is
minimized over ¯U, constraint (7b) does not depend on the minimization parameter and can be
removed. Similarly, in Minimization 2, when (7a) is minimize over a, constraints in (7d) are not
included since they are independent of the optimization parameters. Now, we observe that the
alternating minimization algorithm has the following properties:

e

Property 1: Minimization 2 in Table I is a convex optimization problem.

Proof: Assuming α ∈ R, we deﬁne a0 as

a0 = αa1 + (1 − α)a2.

We also deﬁne the function g(a) to denote the argument of the Q-function in (6). Therefore,

(cid:80)K

l=1
l(cid:54)=j

g(a0) =

(cid:107)hj(cid:107)a0j

σz√
2

+

Re{¯uH

j hj ¯ulsb,lsb,j(a0l)}
j hH
(cid:107)hj(cid:107)
σz√
2

= αg(a1) + (1 − α)g(a2),

which means that the argument of each Q-function in (6) is afﬁne with respect to a. Now,
considering the fact that Q-function is convex over positive arguments and that afﬁne mapping
does not change the convexity it becomes clear that Q(g(a)) is a convex function [23]. Taking
into account that the sum of two convex functions is a convex function it could be inferred that
(6), i.e., the objective function of (7) is convex with respect to a.

ALTERNATING MINIMIZATION ALGORITHM FOR SOLVING (7)

TABLE I

11

Initialization:
¯U0 ← random complex M × K matrix such that each column is
normalized.

a0 ← random real positive 1 × K vector such that(cid:80)K

2 ≤

j=1 a0

j

Ptot.
Initialize P 1
loop, e.g. P 1
while P 1

e and P 2
e < P 1
e = 1 and P 2
e > P threshold

e

e with proper values to start the while
e = 0.5.

do

e − P 2
e ← P 2
e .
P 1
Minimization 1:
Minimize (7) over ¯U assuming that a = a0, and using the
initial value of ¯U0 for ¯U.
¯U0 ← ¯Uopt.
Minimization 2:
Minimize (7) over a assuming ¯U = ¯U0, by using a numerical
convex optimization method and the initial value of a0 for a.
a0 ← aopt.
e ← P ML-U
P 2

( ¯U0, a0).

e

end while
U = ¯U0diag(a) is the transmit beamforming matrix.

It is obvious that the constraint (7b) is a convex set with respect to a since it represents
the volume inside of a K-dimensional sphere. By using the deﬁnition of a convex set [23],
it could be shown that the constraints in (7c) are also convex sets with respect to a. Also as
mentioned earlier, the constraints deﬁned in (7d) are not included in Minimization 2. Therefore,
Minimization 2 of Table I is a convex optimization problem with a convex objective function
and closed convex constraints.

Theorem 1: The algorithm presented in Table I converges to a local minimum of (7).

Proof: The objective function P ML-U

( ¯U, a) is minimized in Minimization 1 of Table I
over ¯U while keeping a ﬁxed at the values obtained in Minimization 2 of the previous iteration.
Therefore, at each iteration of the algorithm the value of the objective function after Minimization
1 is non-increasing compared to the value of the objective function after Minimization 2 of the

e

12

e

( ¯U, a) is minimized over a while keeping
previous iteration. In Minimization 2 of Table I, P ML-U
¯U at the values obtained in Minimization 1. Therefore, the value of P ML-U
does not increase
compared to the result of Minimization 1 of the same iteration. Therefore, each iteration of
the algorithm causes P ML-U
is
≤ 1, guarantees that the algorithm converges to a stationary
always nonnegative, 0 ≤ P ML-U
(minimum) point.

to be non-increasing. Moreover, considering the fact that P ML-U

e

e

e

e

B. Joint transmit-receive beamforming

For the second scenario, it is assumed that the receive ﬁlter coefﬁcients are calculated by
the transmitter in conjunction with the transmit beamforming weights, and each receiver is
provided with its receive ﬁlter coefﬁcient. In this scenario, the transmitter ﬁnds the transmit
beamforming weights and receive ﬁlter coefﬁcients that minimize the average error probability
of users. Therefore, we may formulate the problem as

Pe

min
w,U
subject to Tr(UUH) ≤ Ptot,

(8)

where Pe is the average error probability of (2). It should be noted that the error probability
of user j, Pej in (1), depends on its receive ﬁlter coefﬁcient wj, and the transmit beamforming
matrix of all users U, but it does not depend on the receive ﬁlter coefﬁcients of other users.
Based on this observation we strive to develop an alternating minimization algorithm to solve
(8). Before designing the optimization algorithm, we determine key properties of (1), (2), and
(8) that will be utilized.

Property 2: The error probability in (1) and therefore the average error probability (2) are

invariant to the scaling of wj by a positive constant.
Based on this property, one can set |wj| = 1 in the error probability of (1) and (2) and add
|wj| = 1, 1 ≤ j ≤ K, as additional constraints to (8).

Property 3: For a ﬁxed U that satisﬁes Tr(UUH) ≤ Ptot we have arg min

Pe = [arg min

Pe1,

wK

PeK ]. In other words, arg min

. . . , arg min
This is obvious since each Pej depends only on wj but not on wl, l (cid:54)= j. Therefore, minimizing
(2) over all wjs could be partitioned into K decoupled minimizations of Pej over wjs, 1 ≤ j ≤ K.

Pe = arg min

Pej.

wj

wj

w

w1

13

If one wants to solve (8) over w for a given U, it is clear from Properties 2 and 3 and Lemma
1 that when there exists no error ﬂoor, without loss of generality, the constraints |wj| = 1 and
(3), for 1 ≤ j ≤ K, could be added to the optimization problem. Therefore, for a given U, the
K optimization problems arising from (8) could be rewritten as follows:

K(cid:88)

sb,jRe{wj

hjulsb,l}

(cid:33)

(cid:32)√

Nb(cid:88)

Q

min
wj

1
Nb

2
σz
subject to |wj| = 1,

b=1

(cid:40)

K(cid:88)

l=1

(cid:41)

hjulsb,l

≥ 0,

1 ≤ b ≤ Nb,

(9)

sb,jRe

wj

for 1 ≤ j ≤ K. Now, we have the following proposition:

l=1

Proposition 1: If the constraints in the minimization problem (9) are satisﬁed, any local
minimizer of error probability function Pej, the objective function of the optimization problem
(9), is also a global minimizer. Moreover, the global minimizer is unique.

Proof: See Appendix A.

Property 4: min
wj

Pej, where Pej

is calculated as in (1), could be transformed to a convex

optimization problem with a unique global minimizer.

Proof: Properties 2 and 3, Lemma 1, and Proposition 1 show that without loss of generality
Pej could be stated as (9) which does not have any local minimizer and has only one global
min
wj
minimizer. Problem (9) could be equivalently rewritten in the form of convex optimization
problem as

(cid:32)√

Nb(cid:88)

Q

min
wj

1
Nb

2
σz
subject to |wj| ≤ 1,

b=1

(cid:40)

K(cid:88)

sb,jRe{wj

hjulsb,l}

(cid:33)

K(cid:88)

l=1

(cid:41)

sb,jRe
since |wj| ≤ 1 is an active constraint.
Hence, based on Properties 2-4, (8) could be written as

hjulsb,l

wj

l=1

(cid:32)√

K(cid:88)

Nb(cid:88)

j=1

b=1

min
w,U

1

KNb

Q

sb,jRe{wj

2
σz

subject to Tr(UUH) ≤ Ptot,

≥ 0,

1 ≤ b ≤ Nb,

(10)

(cid:33)

hjulsb,l}

K(cid:88)

l=1

(11a)

(11b)

14

sb,jRe{wj

K(cid:88)

|wj| ≤ 1,

1 ≤ j ≤ K,

hjulsb,l} ≥ 0, 1 ≤ j ≤ K, 1 ≤ b ≤ Nb.

(11c)

(11d)

Property 5: Optimization problem (11) is a convex optimization problem with respect to U.

l=1

Proof: See Appendix B.

Using Properties 4 and 5, we propose the alternating minimization algorithm of Table II for
problem (8). It should be noted that in this algorithm in Minimization 1 when (11a) is minimized
over U, constraints in (11c) do not depend on the optimization parameter and therefore are not
included. It is easily shown that the algorithm in Table II converges to a local minimum.

Theorem 2: The algorithm in Table II converges to a local minimum of (8).

Proof: Since the objective function Pe(U, w) is minimized at both Minimization 1 and 2,
each iteration causes Pe to be non-increasing. Moreover, considering the fact that Pe is always
nonnegative, 0 ≤ Pe ≤ 1, it guarantees that the algorithm converges to a stationary (minimum)
point.

V. USER SELECTION

In this section, we develop a user selection algorithm by taking into account that MPE transmit
beamforming is utilized at the transmitter. It is assumed that in total KT users are in the system
such that KT (cid:29) M and the set of all users is given by A = {1,··· , KT}. The transmitter
selects a subset, S, of K users out of KT users, S ⊆ A, for transmission. The users should
be selected in such a way that certain criteria are met. We are interested in maximizing the
number of selected users and minimizing the error probabilities at the same time. Due to MPE
beamforming, all users receive BPSK signals, so maximizing the number of users may increase
the throughput. Hence, ideally we would like to solve the following multiobjective optimization
problem which only has an extra objective function compared with (11):
hjulsb,l}

sb,jRe{wj

(cid:32)√

(cid:88)

(cid:88)

Nb(cid:88)

(cid:33)

1

min

w,U,S⊆A

KNb

j∈A

b=1

Q

2
σz

l∈A

max
w,U,S⊆A K
subject to Tr(UUH) ≤ Ptot,

|wj| ≤ 1,

j ∈ S,

ALTERNATING MINIMIZATION ALGORITHM FOR SOLVING (8)

TABLE II

15

Ptot.

Initialization:
U0 ← random complex M × K matrix.
U0 ← U0
(cid:107)U0(cid:107)F
w0 ← normalized random complex number.
w0 ← [w0]1×K.
e1 ,··· , P 1
Initialize P1
(cid:80)K
to start the while loop, e.g. P1
j=1 P 1
while
> P threshold
ej
K
e ← P2
e.
P1
Minimization 1:

eK ] and P2

e = [P 1

−P 2
ej

e

do

e≺ P1

e with proper values

e = [1]1×K and P2

e = [0.5]1×K.

Minimize (11) over U assuming that w = w0 by using a
numerical convex optimization method and the initial value of
U0 for U.
U0 ← Uopt.
Minimization 2:
for j = 1 : K do

Minimize (10) over wj assuming U = U0 by using a
numerical convex optimization method and the initial value
of w0j for wj .
w0j ← wopt
j .
ej ← Pej (U0, w0j).
P 2
end for
end while
U0 and w0 are the transmit beamforming weights and receive
ﬁlter coefﬁcients, respectively.

(cid:88)

l∈S

sb,jRe{wj

hjulsb,l} ≥ 0, j ∈ S, 1 ≤ b ≤ Nb,

(12)

where K is the cardinality of the set of selected users, |S|. In the majority of existing user
selection algorithms, e.g. [4], [14], the number of selected users K should be less than or equal
to the degrees of freedom (DoF) of the system, which in this case is equal to M. However, the
number of selected users could possibly be more than the DoF of the system, in the user selection
method that is proposed in this section as will be conﬁrmed in the numerical results. This is
because of the fact that in the proposed user selection method the constraints of the optimization

16

(12) originate from the MPE beamforming problem which in turn considers a one-dimensional
discrete modulation rather than a continuous Gaussian input distribution.

From the viewpoint of system design, it is more practical to solve the user selection and
beamforming problems separately. Although suboptimal, (12) is separated into a minimization
over U and w and a maximization over S. Since the beamforming problem has been addressed
in Section IV, user selection will be the focus in this section. Therefore, instead of (12) we solve

maxS⊆A |S|
subject to Tr(UUH) =

(cid:88)

j∈S

(cid:107)uj(cid:107)2 ≤ Ptot,

|wj| ≤ 1,
hjulsb,l} ≥ 0, j ∈ S, 1 ≤ b ≤ Nb.

j ∈ S,

sb,jRe{wj

(cid:88)

l∈S

(13a)

(13b)

(13c)

(13d)

In other words, (13) maximizes the cardinality of the set of selected users such that none
of the selected users experience error ﬂoors (Lemma 1) and the transmit power constraint is
met, i.e., the number of selected users is maximized subject to the constraint set of the MPE
beamforming problem. This means that we try to ﬁnd the maximum number of users such that
the feasible region of the MPE beamforming problem is not an empty set. This combinatorial
optimization problem has very high computational complexity. Therefore, we try to ﬁnd a
suboptimal algorithm for ﬁnding a good set of selected users.

For a tractable solution, we are interested in user selection as a separate entity from beam-
forming. Therefore, we try to remove the dependence of the optimization problem (13) from the
transmit and receive beamforming weights. But before doing this, we ﬁrst simplify the problem
by ﬁnding a lower bound for the left side of the inequality of the constraint (13d) as

hjulsb,l}≥ Re{wjhjuj} −(cid:88)

(cid:88)

l∈S

sb,jRe{wj

|Re{wjhjul}|.

l∈S
l(cid:54)=j

This lower bound is obtained by using the fact sb,jsbl = ±1 and x ≥ −|x|. Since this lower
bound is independent of b, all Nb constraints for a ﬁxed j in (13d) are replaced with the single
constraint:

|Re{wjhjul}| ≥ 0, j ∈ S.

(14)

Re{wjhjuj} −(cid:88)

l∈S
l(cid:54)=j

17

Replacing (13d) with (14) reduces the size of the feasible region in the optimization problem (13).
Now, if we further assume that the receivers use ML detection with normalized ﬁlter coefﬁcients
j | and therefore (13c) could be removed from (13). The modiﬁed constraint
we have wj =
of (13d), i.e. (14) is then substituted with the following bound
j hjul}| ≤ |hjuj|2.

|Re{uH

(cid:88)

uH
j hH
j
|uH
j hH

j hH

l∈S
l(cid:54)=j

Now, to remove the dependence of the user selection problem on transmit beamforming
vectors ujs, normalized maximum ratio transmission (conjugate beamforming) is assumed for
l∈S |hl|2 [24], [25]. Consequently, this removes (13b) and
transmission such that uj = hH
j
simpliﬁes (13d) further to

(cid:113) PT(cid:80)
(cid:88)

l∈S
l(cid:54)=j

|Re{hjhH

l }| ≤ |hj|2.

Therefore, the user selection optimization problem has been simpliﬁed to

subject to (cid:88)
maxS⊆A |S|

l∈S
l(cid:54)=j

|Re{hjhH

l }| ≤ |hj|2, ∀j ∈ S.

(15a)

(15b)

maximum number of elements with the following properties:(cid:80)

This problem could be interpreted as follows: There is an M dimensional vector space on the
complex ﬁeld C, i.e., CM, in which there are KT (cid:29) M given elements. We want to choose the
l }| ≤ |hj|2, ∀j ∈ S.
Again we try to simplify the problem by reducing the feasible region. A sufﬁcient condition

|Re{hjhH

l∈S
l(cid:54)=j

for (15b) to hold is that

|Re{hjhH

l }| ≤ min(|hj|2,|hl|2)

|S| − 1

, ∀j, l ∈ S.

Substituting (15b) with the above sufﬁcient condition gives us

maxS⊆A |S|
subject to

|Re{hjhH
l }|
min(|hj|2,|hl|2)

≤

1

|S| − 1

, ∀j, l ∈ S.

(16)

From a geometric point of view, problem (16) is similar to packing lines in a Grassmannian
manifold of dimension M, i.e., G(1, M ) [26]–[29]. Namely, problem (16) is to pack the M-
complex space with the maximum number of lines passing through the origin such that real

18

TABLE III

GEOMETRIC USER SELECTION ALGORITHM

Initialization:
iter = 0.
K iter+1 = M + 1.
loop

iter ← iter + 1.
i = 1.
S iter = ∅.
Aiter
i = {1,··· , KT}.
Citer
i = Aiter
Main Body of Algorithm:
while i ≤ K iter and Ci (cid:54)= ∅ do

.

i

i

|hj|.
πiter
i = argmax
j∈Citer
}.
S iter = S iter ∪ {πiter
\ {πiter
Aiter
} .
i ← Aiter
\{∀j ∈ Aiter
i+1 = Aiter
Aiter

i

i

i

i

i

|dRC(hj, hπiter

i

) >

Kiter−1}.

1

i+1|dRC(hj, hπiter

) >

Kiter−1}.

α

i

Citer
i+1 = {∀j ∈ Aiter
i+1 = ∅ then
if Citer
Citer
i+1 = Aiter
i+1 .
end if
i ← i + 1.

end while
Decision for Next Iteration:

end loop

correlation distance between any two lines is less than some value, where we deﬁne the real
correlation distance between two lines as

dRC(hi, hj) (cid:44) |Re{hjhH
l }|
min(|hj|2,|hl|2)

.

It should be remarked that dRC is not actually a distance or metric but only possess some
properties of a metric. To solve (16) we propose the geometric user selection (GUS) algorithm
of Table III.

This suboptimum low-complexity algorithm semi-greedily selects users based on both their
channel strength and their real correlation distance. In the Main Body of Algorithm in Table III,

19

1

ﬁrst the user with the strongest channel in the set of candidate users, C, is opted for the set of
selected users S. Then, any user from the set of available users, A, with real correlation distance
K−1 from the previously selected user, πi, is removed for the next set of available
of more than
users. To make the packing tighter, the algorithm selects users from a set of candidate users
rather than from all available users. A user is considered for the next set of candidate users if
K−1. The parameter α
its distance from the last selected user, πi, is close to the upper bound
determines how close the distance of the next candidate users from the last selected user should
be to the upper bound. The Main Body of Algorithm iterates until either K users are selected
or the set of candidate users is empty. It should be remarked that the cardinality of the selected
set in this algorithm is upper bounded by the initial guess for the number of users K.

1

In Decision for Next Iteration in Table III, it is decided whether the set of selected users
could be improved either in the sense of size or the distance among users. If iter = 1, then
depending on whether the cardinality of the selected set is equal to K iter or less than K iter, K
is incremented or decremented respectively, i.e., K iter+1 = K iter + 1 or K iter+1 = K iter − 1.
As a result the number of iterations is always greater than one. If iter (cid:54)= 1 then one of four
different scenarios may occur:

1) If K iter > K iter−1 and the size of the current selected set is larger than or equal to the
size of the previous selected set ( |S iter| ≥ |S iter−1|), then the algorithm gets greedy and
prepares to check if the size of the selected set could be further improved by incrementing
K for the next iteration, i.e., K iter+1 = K iter + 1.

2) If K iter > K iter−1 and |S iter| < |S iter−1| then the previous selected set is considered as the

selected set (S = S iter−1) and the algorithm breaks from the loop.

3) If K iter < K iter−1 and |S iter| ≥ K iter − 1 then the current selected set is chosen as the

selected set (S = S iter) and the algorithm breaks from the loop.

4) Otherwise, K iter+1 = K iter − 1.

Remarks on initialization: Now, we justify the choice of K = M + 1 as the initial value
for K in GUS algorithm. In the context of packing, geodesic distance and chordal distance are
more common distance metrics with existing bounds for packing problems. Therefore, to ﬁnd
an approximate value for the maximum number of users K, the size of the feasible region in

20

(16) is reduced, again by replacing the constraint of (16) with a sufﬁcient condition as

maxS⊆A |S|
subject to

|hjhH
l |

min (|hj|2,|hl|2)

≤

1

|S| − 1

, ∀j, l ∈ S,

(17a)

(17b)

allowing us to utilize existing bounds from differential geometry.

Next, we ﬁnd an approximation for the maximum number of lines that could ﬁll the M space
such that (17b) is satisﬁed. In G(1, M ), the principal angle between lines hj and hl is deﬁned
as [30]

θj,l = arccos

|(cid:104)hj, hl(cid:105)|
|hj||hl|

(cid:115)
and the chordal distance between two lines is deﬁned as [26], [27]
1 − |hjhH
l |2
|hj|2|hl|2 .

dc(hj, hl) = | sin(θj,l)| =

Similar to the Rankin bound for spherical codes, there exists the following upper bound on the
chordal distance between any two lines in the Grassmannian manifolds for packing K lines [26],
[27]:

(18)

(19)

 (M−1)K

M (K−1)
(M−1)

M

c ≤
d2

l |2
l |2
|hj hH

 |hj hH
 1 − (M−1)K

1 − (M−1)

M (K−1) ≤ 1
(K−1)2
M ≤ 1
(K−1)2

2

2

if K ≤(cid:0)M +1
(cid:1)
if K >(cid:0)M +1
(cid:1).
if K ≤(cid:0)M +1
(cid:1)
if K >(cid:0)M +1
(cid:1),
if K ≤(cid:0)M +1
(cid:1)
if K >(cid:0)M +1
(cid:1).

M

2

2

2

2

Using (18) and (19) we have

l |2
min (|hj|4,|hl|4) ≥ |hj hH
l |2
min (|hj|4,|hl|4) ≥ |hj hH
and by taking (17b) into account, we have

|hj|2|hl|2 ≥ 1− (M−1)K
M (K−1)
|hj|2|hl|2 ≥ 1− (M−1)

This is equivalent to the following sufﬁcient (but not necessary) condition:

K ≤ M + 1,

which serves as an approximation to the number of selected users in the GUS algorithm.

21

VI. NUMERICAL RESULTS

A. MPE beamforming methods

In this section, we ﬁrst consider a broadcast channel with a 3-antenna transmitter sending
information to 3 users each equipped with 1 antenna. It is assume that the transmitter has one
information symbol for each receiver in the same time and frequency slots. The channel gains
are assumed to be quasi static and follow a Rayleigh distribution. Since our focus is on various
beamforming methods rather than on the effect of channel estimation, we assume that perfect
CSI of all channels is available at the transmitter and each receiver only has perfect knowledge
of its own channels [3], [5]. At the receivers, white Gaussian noise is added to the received
signal.

Fig. 2 compares the bit error rates of MSLNR, ZF, MMSE, MPE-ML (from Section IV-A), and
joint Tx-Rx MPE (from Section IV-B) beamforming methods. For all of these methods, maximum
likelihood is used at the receiver except for joint Tx-Rx MPE beamforming in which each receive
ﬁlter coefﬁcient is calculated by the transmitter jointly with the transmit beamforming weights
and is provided to the corresponding receiver. As can be seen, MPE transmit beamforming
methods substantially improve the performance of all users. For example, at BER of 10−2 both
MPE beamforming methods show a gain of about 6.5dB compared with MMSE beamforming
and much more gain compared with ZF and MSLNR. It should be mentioned that in Fig.
2, theoretical BER curves of MPE-ML and Tx-Rx MPE beamforming methods are obtained
by substituting the calculated beamforming weights for each channel realization into the error
probability expressions of (6) and (11a) respectively. All other curves in Fig. 2 are the result of
Monte Carlo simulations. As can be seen in Fig. 2 the simulations conﬁrm the theoretical results.
It is interesting to observe that the performance of MPE-ML beamforming closely follows that
of the joint Tx-Rx MPE beamforming up to a certain SNR. At higher SNRs, although still
outperforming classical beamforming methods, MPE-ML beamforming shows a large gap in
performance compared with Tx-Rx MPE beamforming. The reason that MPE-ML beamforming
cannot follow the performance of Tx-Rx MPE beamforming is that in Minimization 1 of Table
I the optimization problem is not convex. Therefore, the solver of the optimization might get
stuck in a local minimizer instead of the global minimizer of (7).

In Fig. 3 we show the average number of iterations needed for the convergence of the

22

Fig. 2. Bit error rate of users using MSLNR, ZF, MMSE, MPE-ML, and Joint Tx-Rx MPE beamforming for M = 3 antenna
transmitter and K = 3 users with BPSK modulation and without user selection.

algorithms in Table I and II. In both algorithms the average number of iterations is less than 20.
It is very interesting to observe that as SNR increases the number of iterations needed for the
is set ﬁxed at 10−8
convergence of the algorithm in Table II decreases. This is because P threshold
for all SNRs while the error probability decreases from about 10−1 to 10−5. If it is assumed
that the error probability is known in advance, it would be better to change P threshold
to a small
fraction of the error probability to have a faster convergence with the same reliability.

e

e

Although in principle MPE beamforming may be extended to higher-order modulations,
its main advantage lies in lower-order modulations. If a higher-order modulation is used the
optimizations contain more terms and become more computationally complex.

B. User selection

First, the proposed GUS algorithm is compared with semi-orthogonal user selection (SUS)
algorithm of [4]. Fig. 4 shows the average number of selected users over 1000 different channel
realizations versus the total number of available users for three different cases: when the number
of transmit antennas is 2, 4, and 6. We observe that for SUS it is possible to have at most as
many users as the number of transmit antennas, as it is obvious by its algorithm in [4], while

−15−10−5051010−610−510−410−310−210−1100SNR (dB)Average bit error rate  Tx−Rx MPE Theoretical BERTx−Rx MPEMPE−ML Theoretical BERMPE−MLMMSEZFMSLNR23

Fig. 3. Average number of iterations for convergence of algorithms of Table I and II when M = 3 antennas and K = 3 users
without user selection.

GUS may select more users. For example, when there are KT = 10000 users available1, GUS
can select 6 users with only 4 antennas compared to the 4 selected users of the SUS algorithm.
When the transmitter has 2 antennas and there are only 10 users available, GUS can select 2.48
users on average which is still more than the number of transmit antennas) while SUS selects
1.92 users on average.

As expected, it can also be seen that until saturation, the number of selected users for both
GUS and SUS increases as the total number of available users increases. Each user corresponds
to a line passing through the origin of the complex M dimensional hypersphere. Hence, when
the number of users increases, the density of possible lines to choose from increases. This makes
it more likely to pack the space with more lines obeying the speciﬁc distance.

Now, we study the effect of user selection in conjunction with beamforming. Consider a
system with a 2-antenna transmitter that ﬁrst selects a set of users out of KT = 50 users
by using either GUS or SUS, and then sends information to the selected users using various
beamforming methods. Fig. 5 shows the error probabilities of different combinations of user
selection and beamforming methods. As can be seen, the lowest error probabilities are achieved

1Of course it is not practical to service 10000 users with one transmitter. This large number of users is just for illustration

purposes to gain insight into the system.

SNR (dB)-15-10-50510Average No. Iterations246810121416182022TX-RX MPEMPE-ML24

Fig. 4. Average number of selected users vs. total number of available users for M = 2, 4, 6 antennas.

by SUS rather than GUS, and by a small margin, MPE beamforming outperforms all other
beamforming methods used for SUS. However, it could not be simply concluded that SUS
algorithm outperforms GUS since the average number of selected users over all SNRs is 2 for
SUS while it is 3.19 for GUS. In other words, although GUS selects more users, they achieve
higher error probabilities in comparison with the selected users of SUS, as expected. It could also
be noticed that for the proposed geometric user selection algorithm, ZF and MMSE beamforming
are absent in Fig. 5. Owing to the fact that the number of selected users by GUS is more than
the number of transmit antennas, GUS is not suitable for ZF and MMSE beamforming.

As observed in Fig. 5, since the error probability alone is not a good indicator of the
performance when there are different numbers of users in the system, Figs. 6 and 7 are provided
to give more insight into the GUS and SUS performances. In Fig. 6 the throughput is shown for
different combinations of user selection and beamforming. Similar to [19], we use the notion of
expected throughput for frame-based transmission as E[Thr] = (1 − Pe)(cid:96)Kavg bits per channel
use, where (cid:96) is the frame size and Kavg is the average number of selected users. We consider
two different frame sizes: 100 and 500 bits. No channel coding is assumed, and a transmission
is considered to be successful if the entire frame is decoded error-free. It can be seen in Fig.
6 that as SNR increases the achievable expected throughput approaches limits determined by
the average numbers of selected users by SUS and GUS. For this example, at higher SNRs

101102103104123456789Total Number of Available UsersAverage Number of Selected Users  GUS, M = 2GUS, M = 4GUS, M = 6SUS, M = 2SUS, M = 4SUS, M = 625

Fig. 5. Average bit error rate of users when M = 2 antennas and KT = 50 users. In this scenario, the average number of
selected users over all SNRs is 2 for SUS while it is 3.19 for GUS.

Fig. 6. Average frame-wise rate when M = 2, KT = 50, and frame size equals 100 and 500.

the achievable throughput by GUS and MPE beamforming is about 160% of the achievable
throughput by SUS and any of the other beamforming methods. Moreover, Fig. 5 shows that as
the frame size increases the throughput decreases. However, for all frame sizes the throughput
eventually approaches the upper limit of the throughput dictated by the average number of
selected users.

−15−10−50510−610−510−410−310−210−1100SNR (dB)Average bit error rate  GUS Tx−Rx MPE Theoretical BERGUS Tx−Rx MPEGUS MSLNRSUS Tx−Rx MPE Theoretical BERSUS Tx−Rx MPESUS MMSESUS ZFSUS MSLNR−8−6−4−20246800.511.522.533.5SNR (dB)Uncoded throughput (bits/channel use)  GUS Joint Tx−Rx MPE (500b)GUS MSLNR (500b)SUS Joint Tx−Rx MPE (500b)SUS MMSE (500b)SUS MSLNR (500b)GUS Joint Tx−Rx MPE (100b)GUS MSLNR (100b)SUS Joint Tx−Rx MPE (100b)SUS MMSE (100b)SUS MSLNR (100b)26

Fig. 7. Average bit error rate of users when M = 4 antennas and KT = 50 users while GUS is forced to select K = 4 users.

In Fig. 7, the error probabilities of different combinations of user selection and beamforming
methods are shown when the transmitter has 4 antennas. We modiﬁed our GUS algorithm to only
select at most M users so that the number of selected users would be the same as that of SUS
algorithm. Since GUS design is speciﬁc to MPE beamforming, it is only for MPE beamforming
that it performs comparably with SUS. Nevertheless, for the other beamforming methods GUS
shows reasonably good results but SUS outperforms as expected. In short, the major advantages
of GUS to SUS lie in its ability to select more users than the number of transmit antennas
for MPE beamforming, resulting in higher throughput for MPE beamforming, in addition to its
lower complexity.

VII. CONCLUSION

In this paper, it has been demonstrated that by exploiting the type of modulation, transmit
beamforming can be designed by directly minimizing the average error probability of multiple
users. Two algorithms were developed based on the concepts of alternating minimization and
convex optimization for two different cases: 1- when the receivers use single-user maximum
likelihood detection, 2- when the transmitter optimizes the transmit beamforming weights and
the receive ﬁlter coefﬁcients jointly. It has been shown that minimum probability of error
beamforming dramatically outperforms conventional transmit beamforming methods such as ZF,

−15−10−50510−610−510−410−310−210−1100SNR (dB)Average bit error rate  GUS Tx−Rx MPE Theoretical BERGUS Tx−Rx MPEGUS MSLNRSUS Tx−Rx MPE Theoretical BERSUS Tx−Rx MPESUS MMSESUS ZFSUS MSLNRMMSE, and MSLNR. Moreover, a geometric user selection (GUS) algorithm was developed that
selects as many users as possible, assuming that the transmitter employs MPE beamforming.
It has been shown that the number of selected users by the proposed GUS algorithm could
potentially be greater than the number of transmit antennas.

27

APPENDIX A

PROOF OF PROPOSITION 1

The minimization problem is considered over the following set:

K(cid:88)

Wj ={wj :|wj| = 1, sb,jRe{wj

hjulsb,l}≥ 0, 1≤ b≤ Nb}.

(20)

Assume that wj1 ∈ Wj is a global minimizer of the optimization problem (9), and wj2 ∈ Wj is
a local minimizer of the problem such that

l=1

Pej (wj1) < Pej (wj2).

(21)

Assuming 0 < α < 1, we deﬁne wj0 as

wj0 =

αwj1 + (1 − α)wj2
(cid:107)αwj1 + (1 − α)wj2(cid:107).

Therefore, we have (cid:107)wj0(cid:107) = 1, and for 1 ≤ b ≤ Nb, we have sb,jRe
Hence, it can be inferred that wj0 ∈ Wj. It is also obvious that

(cid:110)

wj0

(cid:80)K

l=1 hjulsb,l

(cid:111) ≥ 0.

Consequently,

(cid:107)αwj1 + (1 − α)wj2(cid:107) ≤ α(cid:107)wj1(cid:107) + (1 − α)(cid:107)wj2(cid:107) = 1.
(cid:40)
(cid:41)

(cid:40)

(cid:41)

sb,jRe

wj0

hjulsb,l

wj1

hjulsb,l

+

K(cid:88)

l=1

K(cid:88)
(cid:40)

l=1

≥ αsb,jRe

(cid:41)

K(cid:88)

l=1

(1 − α)sb,jRe

wj2

hjulsb,l

,

(22)

28

for 1 ≤ b ≤ Nb. Therefore,

(cid:32)√

hjulsb,l}+(1 − α)sb,jRe{wj2

(cid:33)

≤

hjulsb,l}

z
2

(cid:113) σ2
K(cid:88)
K(cid:88)

l=1

l=1

hjulsb,l}

(cid:33)

+

(cid:33)

K(cid:88)

Q

Q(

l=1

l=1

sb,jRe{wj0
K(cid:80)

2
σz
αsb,jRe{wj1
(cid:32)√
sb,jRe{wj1
(cid:32)√

2
σz

≤ αQ

(1 − α)Q

sb,jRe{wj2

2
σz

hjulsb,l}

K(cid:80)

l=1

hjulsb,l}
)

(23)

where the ﬁrst inequality is the result of (22) and due to the fact that Q(x) is a decreasing
function for x ≥ 0, and the second inequality stands because Q(x) is a convex function for
x ≥ 0.

From (1) and (23), it can be inferred that

(cid:33)

≤

hjulsb,l}

K(cid:88)
(cid:33)

l=1

2

Q

b=1

1
Nb

Pej (wj0) =

(cid:32) √
σz|wj0|sb,jRe{wj0
hjulsb,l}

Nb(cid:88)
(cid:32) √
Nb(cid:88)
σz|wj1| sb,jRe{wj1
(cid:32) √
Nb(cid:88)
σz|wj2| sb,jRe{wj2

K(cid:88)
α
K(cid:88)
Nb
1 − α
Nb
αPej (wj1) + (1 − α)Pej (wj2) < Pej (wj2),

b=1

b=1

Q

Q

l=1

l=1

2

2

+

(cid:33)

hjulsb,l}

=

∀α ∈ (0, 1),

where the last inequality is due to the fact that wj1 is the global minimizer of Pej (wj). Now,
let α → 0, wj0 → wj2. Hence, in a small neighborhood of wj2, there always exists a wj0,
so that Pej (wj0) < Pej (wj2), i.e., wj2 is not a local minimizer. In other words, there does not
exist any local minimizer such that (21) holds. Therefore, it can be concluded that either there
is no local minimizer at all which proves the proposition, or there exists a local minimizer
such that Pej (wj1) ≥ Pej (wj2). However, since wj1 is a global minimizer of Pej (wj), we have
Pej (wj1) ≤ Pej (wj2). Therefore, it can be concluded that Pej (wj1) = Pej (wj2), i.e., the local
minimizer (if exists) is also a global minimizer.

29

To show the uniqueness of the global minimizer, ﬁrst the following set is considered:

W 0

j ={wj : |wj| = 1, Re

wj

hjul

= 0, 1 ≤ b ≤ Nb}.

(cid:41)

(cid:40)

K(cid:88)

l=1

It is obvious that each point in this set is a global maximizer of error probability function in (1)
constrained by the set deﬁned in (20), because of the fact that the arguments in all Q-functions
in error probability will be zero. Therefore, to solve the minimization problem it is sufﬁcient
to solve the problem over the set W 1
k, because
Q(x) is strictly convex for x > 0. Assume that wj1 (cid:54)= wj2 are two global minimizers of the
optimization problem (9). We deﬁne wj0 as follows:
αwj1 + (1 − α)wj2
(cid:107)αwj1 + (1 − α)wj2(cid:107),

j . Pej (wj) is strictly convex on W 1

j = Wj − W 0

∀α ∈ (0, 1).

wj0 =

Since wj1 is a global minimizer, it is obvious that

Pej (wj0) ≥ Pej (wj1).

On the other hand, we have

Pej (wj0) < αPej (wj1) + (1 − α)Pej (wj2) = Pej (wj1),

(24)

(25)

because Pej (wj) is strictly convex on W 1
global minimizer is unique.

j . Since (25) contradicts (24), it can be inferred that the

APPENDIX B

PROOF OF PROPERTY 5

Before stating the proof it should be noted that the Re{.} operator is not a linear function.

Assuming α ∈ R, we deﬁne U0 as

U0 = αU1 + (1 − α)U2.

We also deﬁne the function g(U) to denote the argument of the Q-function in (11). Therefore,

√
2
σz

K(cid:88)

l=1

g(U0) =

sb,jRe{wj

hj(αu1l + (1 − α)u2l)sb,l}

= αg(U1) + (1 − α)g(U2),

which means that the argument of each Q-function in (11a) is afﬁne with respect to U. Now,
considering the fact that the Q-function is convex for positive arguments and that afﬁne mapping

30

does not change the convexity, Q(g(U)) is a convex function [23]. Since the sum of two convex
functions is a convex function it becomes clear that the objective function in (11), Pe(U), is
convex with respect to U.

It is obvious that the constraint (11b) is a convex set with respect to U since Tr(UUH) =
(cid:107)U(cid:107)2
F and every norm is a convex function. The second constraint is not deﬁned over U and the
third constraint could be shown to be a convex set by using the deﬁnition. Therefore, problem
(11) is a convex optimization problem over U with a convex objective function and closed
convex constraints.

REFERENCES

[1] P. W. Wolniansky, G. J. Foschini, G. D. Golden, and R. A. Valenzuela, “V-blast: An architecture for realizing very high
data rates over the rich-scattering wireless channel,” in Proc. URSI Int. Symp. Signals Sys. Elec (ISSSE), Oct. 1998, pp.
295–300.

[2] M. Schubert and H. Boche, “Solution of the multiuser downlink beamforming problem with individual SINR constraints,”

IEEE Trans. Veh. Technol., vol. 53, no. 1, pp. 18–28, Jan. 2004.

[3] C. B. Peel, B. M. Hochwald, and A. L. Swindlehurst, “A vector-perturbation technique for near-capacity multiantenna
multiuser communicationâ ˘AˇTpart I: Channel inversion and regularization,” IEEE Trans. Commun., vol. 53, no. 1, pp. 195–
202, Jan. 2005.

[4] T. Yoo and A. Goldsmith, “On the optimality of multiantenna broadcast scheduling using zero-forcing beamforming,” IEEE

J. Sel. Areas Commun., vol. 24, no. 3, pp. 528–541, Mar. 2006.

[5] M. Sadek, A. Tarighat, and A. H. Sayed, “A leakage-based precoding scheme for downlink multi-user MIMO channels,”

IEEE Trans. Wireless Commun., vol. 6, no. 5, pp. 1711–1721, May 2007.

[6] R. H. Etkin, D. N. C. Tse, and H. Wang, “Gaussian interference channel capacity to within one bit,” IEEE Trans. Inf.

Theory, vol. 54, no. 12, pp. 5534–5562, Dec. 2008.

[7] D. P. Palomar, J. M. Ciofﬁ, and M. A. Lagunas, “Joint Tx-Rx beamforming design for multicarrier MIMO channels: A

uniﬁed framework for convex optimization,” IEEE Trans. Signal Process., vol. 51, no. 9, pp. 2381–2401, Sep. 2003.

[8] M. Bavand, P. Azmi, and S. D. Blostein, “Convex optimization based minimum probability of error beamforming in the

uplink of a multiuser system,” in Proc. IEEE 27th Biennial Symp. Commun. (QBSC), Jun. 2014, pp. 28–32.

[9] Q. Z. Ahmed, M.-S. Alouini, and S. Aissa, “Bit error-rate minimizing detector for amplify-and-forward relaying systems

using generalized Gaussian kernel,” IEEE Signal Process. Lett., vol. 20, no. 1, pp. 55–58, Jan. 2013.

[10] S. Chen, N. N. Ahmad, and L. Hanzo, “Adaptive minimum bit error rate beamforming,” IEEE Trans. Wireless Commun.,

vol. 4, no. 2, pp. 341–348, Mar. 2005.

[11] N. Wang and S. D. Blostein, “Minimum BER transmit power allocation and beamforming for two-inputâ ˘A¸Smultiple-output

spatial multiplexing systems,” IEEE Trans. Veh. Technol., vol. 56, no. 2, pp. 704–709, Mar. 2007.

[12] X. Wang, W.-S. Lu, and A. Antoniou, “Constrained minimum-BER multiuser detection,” IEEE Trans. Signal Process.,

vol. 48, no. 10, pp. 2903–2909, Oct. 2000.

[13] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero-forcing methods for downlink spatial multiplexing in multiuser

MIMO channels,” IEEE Trans. Signal Process., vol. 52, no. 2, pp. 461–471, Feb. 2004.

31

[14] J. Mao, J. Gao, Y. Liu, and G. Xie, “Simpliﬁed semi-orthogonal user selection for MU-MIMO systems with ZFBF,” IEEE

Trans. Wireless Commun. Lett., vol. 1, no. 1, pp. 42–45, Feb. 2012.

[15] Z. Shen, R. Chen, J. G. Andrews, R. W. Heath Jr., and B. L. Evans, “Low complexity user selection algorithms for
multiuser MIMO systems with block diagonalization,” IEEE Trans. Signal Process., vol. 54, no. 9, pp. 3658–3663, Sep.
2006.

[16] A. Rajanna, , and N. Jindal, “Multiuser diversity in downlink channels: When does the feedback cost outweigh the spectral

efﬁciency beneﬁt?” IEEE Trans. Wireless Commun., vol. 11, no. 1, pp. 408–418, Jan. 2012.

[17] A. Zafar, M. Shaqfeh, M.-S. Alouini, and H. Alnuweiri, “A suboptimal scheme for multi-user scheduling in Gaussian

broadcast channels,” IEEE Trans. Signal Process., vol. 22, no. 2, pp. 136–140, Feb. 2015.

[18] A. Paulraj, R. Nabar, and D. Gore, Introduction to Space-Time Wireless Communications. Cambridge University Press,

2003.

[19] S. Abdallah and S. D. Blostein, “Rate adaptation using long range channel prediction based on discrete prolate spheroidal
sequences,” in Proc. IEEE 15th Int. Workshop Signal. Process. Adv. Wireless Commun. (SPAWC), Jun. 2014, pp. 479–483.
[20] G. D. Forney Jr. and G. Ungerboeck, “Modulation and coding for linear gaussian channels,” IEEE Trans. Inf. Theory,

vol. 44, no. 6, pp. 2384–2415, Oct. 1998.

[21] A. Konaka, D. W. Coitb, and A. E. Smith, “Multi-objective optimization using genetic algorithms: A tutorial,” Reliability

Engineering & System Safety, vol. 91, no. 9, pp. 992–1007, Sep. 2006.

[22] E. Björnson, E. Jorswieck, M. Debbah, and B. Ottersten, “Multiobjective signal processing optimization: The way to

balance conﬂicting metrics in 5G systems,” IEEE Signal Process. Mag., vol. 31, no. 6, pp. 14–23, Nov. 2014.

[23] S. Boyd, Convex Optimization. Cambridge University Press, 2004.
[24] H. Q. Ngo and E. G. Larsson, “Blind estimation of effective downlink channel gains in massive MIMO,” in Proc. IEEE

Int. Conf. Acoust., Speech, Signal Process. (ICASSP), Apr. 2015, pp. 2919–2923.

[25] H. Q. Ngo, A. Ashikhmin, H. Yang, E. G. Larsson, and T. L. Marzetta, “Cell-free massive MIMO: Uniformly great service
for everyone,” in Proc. IEEE 16th Int. Workshop Signal. Process. Adv. Wireless Commun. (SPAWC), Jun. 2015, pp. 201–205.
[26] D. J. Love, R. W. Heath Jr., and T. Strohmer, “Grassmannian beamforming for multiple-input multiple-output wireless

systems,” IEEE Trans. Inf. Theory, vol. 49, no. 10, pp. 2735–2747, Oct. 2003.

[27] J. H. Conway, R. H. Hardin, and N. A. Sloane, “Packing lines, planes, etc.: Packings in Grassmannian spaces,” Exper.

Math., vol. 5, no. 2, pp. 139–159, 1996.

[28] L. Zheng and D. N. C. Tse, “Communication on the Grassmann manifold: A geometric approach to the noncoherent

multiple-antenna channel,” IEEE Trans. Inf. Theory, vol. 48, no. 2, pp. 359–383, Feb. 2002.

[29] R.-A. Pitaval, O. Tirkkonen, and S. D. Blostein, “Density and bounds for Grassmannian codes with chordal distance,” in

Proc. IEEE Int. Symp. Info. Theory (ISIT), Aug. 2011, pp. 2298–2302.

[30] A. Barg and D. Y. Nogin, “Bounds on packings of spheres in the Grassmann manifold,” IEEE Trans. Inf. Theory, vol. 48,

no. 9, pp. 2450–2454, Sep. 2002.

