6
1
0
2

 
r
a

 

M
6
1

 
 
]
S
D
h
t
a
m

.

[
 
 

1
v
3
1
0
5
0

.

3
0
6
1
:
v
i
X
r
a

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY

REALIZATION PROBLEM

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

Abstract. We initiate the study of weak containment and weak equivalence for µ-stationary actions
for a given countable group G endowed with a generating probability measure µ. We show that Fursten-
berg entropy is a stable weak equivalence invariant, and furthermore is a continuous aﬃne map on the
space of stable weak equivalence classes. We prove the same for the associated stationary random
subgroup (SRS). Applying these results to the entropy realization problem for ergodic stationary ac-
tions, we show that the set of values of the Furstenberg entropy of boundary actions is closed. This is
obtained as an application of the omitting types theorem in ﬁrst-order logic for metric structures.

1. Introduction

Suppose that G is a countable discrete group, and µ is a generating probability measure on G. That
is, the support of µ generates G as a semigroup. A µ-stationary action a of G on a probability space
(X, ν) is a group homomorphism g 7→ ga from G to the group Aut (X, ν)∗ of nonsingular transforma-
tions of (X, ν), with the property that ν = Pg∈G µ(g)gaν. Here gaν denotes the pushforward of ν

by the nonsingular transformation ga. It is clear that any measure-preserving action is, in particular,
µ-stationary. The notion of stationary dynamical system has received considerable interest in the last
few years [8–11, 15, 23, 26, 32, 33].

Stationary actions of G arise naturally from the study of random walks of G with law µ. Indeed
suppose that (Xn) is a sequence of independent identically distributed random variables on G with
law µ, representing the steps of a random walk. One can then let Zn := X1X2 · · · Xn be the random
variables representing the locations of a random walk on G. The law P of the random variable (Zn)n∈N
is a probability distribution on GN deﬁned on its Borel σ-algebra B. The space (cid:0)GN, B, P(cid:1) can be

thought as the space of paths of the random walk, and an element of GN as a random path.

In the study of random walks, tail events play a particularly important role. Brieﬂy, tail events are
the events that only depend on the asymptotic behavior of the random walk. Formally, these are the
Borel subsets of GN that are invariant under the shift map σ : GN → GN deﬁned by σ (g1, g2, . . . , ) =
(g2, g3, . . .). Tail events form a σ-algebra T called tail σ-algebra or shift-invariant σ-algebra. The

group G admits a natural action π on the space (cid:0)GN, T , P(cid:1) deﬁned by letting πh for h ∈ G be the
nonsingular transformation (g1, g2, . . .) 7→ (hg1, hg2, . . .). Intuitively, πh maps a random path of the
random walk starting at the identity, to a random path of the random walk starting at h. It is not
diﬃcult to verify that such an action of G is indeed µ-stationary. While the σ-algebra T does not
separate the points of GN—since it does not separate any two sequences that diﬀer only on a ﬁnite
initial segment—it follows from the Mackey point realization theorem [30, 35] that one can ﬁnd a
countably generated probability G-space (Π, A, η) endowed with a σ-algebra that separates points

that is G-equivariantly isomorphic to (cid:0)GN, T , P(cid:1). Such a space is called the Poisson boundary of

(G, µ).

The Poisson boundary is an important example of a class of µ-stationary actions known as bound-
aries [22], also called µ-proximal in [23]. Suppose that g is a µ-stationary action of G on a countably
separated probability space (X, B, ν). We can assume without loss of generality that B is the Borel
σ-algebra of a compact metrizable topology on X. Convergence theorems for martingales show that

2000 Mathematics Subject Classiﬁcation. Primary 37A40, 37A35; Secondary 03C98.
Key words and phrases. Stationary action, boundary action, Furstenberg entropy, weak equivalence, logic for metric

structures, omitting types theorem.

1

2

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

for P -almost every path ω ∈ GN of a random walk on G, the sequence (ωa
nν) of probability measures
on X has a w*-limit νω. The measures νω are called conditional measures of the action a, and satisfy
ν = R νωdP (ω). The action a is a boundary action if for ν-a.e. ω ∈ GN the corresponding conditional

probability νω is a point mass. Intuitively this means that almost every µ-random walk on G converges
to a point in X.

The related notion of strongly approximately transitive (SAT) action was introduced by Jaworski
in [27]. A µ-stationary action a of G on (X, B, ν) is SAT if and only if for any nonnull p ∈ B and
every ε > 0 there exists g ∈ G such that ν (gp) > 1 − ε. It follows from [27, Proposition 2.2] that a
µ-stationary action is SAT if and only if it is boundary. Such a characterization of boundary actions
makes it apparent that any boundary action is, a fortiori, ergodic. The boundary actions are precisely
the µ-stationary actions that are factors of the Poisson boundary. The factor map is given P -a.e. by
the assignment ω 7→ νω mapping a path of a random walk to the corresponding conditional probability,
which in the case of a boundary action is a point mass for P -a.e. ω.

The Poisson boundary is tightly connected with bounded µ-harmonic functions on G. Recall that

a real-valued function f on G is µ-harmonic if f (h) = Pg∈G f (gh) µ (g) for any h ∈ G. Indeed the
essentially bounded real-valued random variables on (cid:0)GN, T , P(cid:1) are in 1:1 G-equivariant correspon-
random variable Y the bounded real-valued function g 7→ R Y dgP . Particularly, one can assert that

dence with bounded µ-harmonic functions on G. Such correspondence is obtained by assigning to a

the Poisson boundary of (G, µ) is trivial if and only if the only bounded µ-harmonic functions are the
constant functions. (Recall that we are assuming that the measure µ is generating.)

Many geometric and combinatorial properties of a group G can be characterized in terms of µ-
harmonic functions. For instance, a group G is amenable if and only if for some symmetric generating
probability measure µ on G any bounded µ-harmonic functions is constant [28, 36] or, equivalently,
the Poisson boundary of (G, µ) is trivial. Such a characterization of amenability motivated the study
of a strengthening of amenability known as the Liouville property. Such a property asks that for any
(not necessarily generating) symmetric ﬁnitely supported probability measure on G, the corresponding
Poisson boundary is trivial. This is equivalent to the assertion that any bounded µ-harmonic on G is
constant on the subgroup of G generated by the support of µ.

It is therefore of interest to determine when the Poisson boundary is a trivial space. It turns out
that this happens if and only if the Poisson boundary action is measure-preserving [23, Proposition
1.2]. This motivated the study of the Furstenberg entropy hµ (a) of a µ-stationary action a. The
Furstenberg entropy is an invariant measuring how much the action a fails to be measure-preserving

[21, 32]. Formally, hµ (a) is deﬁned as Pg∈G µ (g)R (− log(dν/dgν)) dgν. The quantity dν/dgν is
the Radon-Nikodym derivative of ν with respect to gν, while R (− log(dν/dgν)) dgν is the relative

entropy or Kullback-Leibler divergence of ν with respect to gν. By Jensen’s inequality, the Furstenberg
entropy of a µ-stationary action is zero if and only if the action is measure-preserving [23, Theorem
1.3]. The largest value of the Furstenberg entropy of a µ-stationary action is the entropy hΠ of the
Poisson boundary (Π, η) of (G, µ) [28]. A boundary µ-stationary action is G-isomorphic to the Poisson
boundary if and only if its Furstenberg entropy is equal to hΠ [23, Theorem 1.3].

These results initiated the study of the Furstenberg entropy of µ-stationary actions, and raised the
so called entropy realization problem. Such a problem asks, broadly speaking, which are the possible
values of the Furstenberg entropy of ergodic or boundary µ-stationary actions. In relation with this
problem, it was proved by Bowen that when G is a nonabelian free group and µ is the uniform measure
on the canonical generators, then all the values of entropy between 0 and hΠ are attained [10]. It has
also been shown by Nevo that for a property (T) group the Furstenberg entropy has a gap around
0 [31], and in fact this holds for general measure class preserving actions. The existence of a gap for
measure class preserving actions is in fact also suﬃcient for a group to have property (T), as was later
shown in [12]; see also [16].

It is currently an open problem to determine whether the set of values of the Furstenberg entropy of
ergodic µ-stationary actions is a compact subset of R. In this paper we answer a related problem, and
show that the set of values of the Furstenberg entropy of boundary µ-stationary actions is compact.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

3

We also show that, assuming that the Poisson boundary action is free, then the set of possible values
of the Furstenberg entropy of free boundary µ-stationary actions is compact.

We prove these results as an application of the theory of weak containment and weak equivalence for
µ-stationary actions. The notion of weak containment and weak equivalence for measure-preserving
actions has been initially introduced by Kechris in [29], inspired by the notion of weak containment
in the sense of Zimmer for unitary representations [4]. Weak containment of unitary representations
correspond to stable weak containment and stable weak equivalence of measure preserving actions
as deﬁned in [37]. The theory of weak containment for measure-preserving actions has attracted
considerable interest in the last few years. Particularly it has been shown by Bowen and Tucker-Drob
that the space of stable weak equivalence classes of measure-preserving actions form a metrizable
Choquet simplex [13]. The extreme points of such a simplex are precisely the classes of ergodic
actions, as proved by Burton [14] and, independently, by Bowen and Tucker-Drob [13]. The theory
of stable weak equivalence of measure-preserving actions has a tight connection with the study of
invariant random subgroups (IRS) of groups. Indeed, the IRS associated with a measure-preserving
actions can be seen as a continuous aﬃne function on the space of stable weak equivalence classes,
which is 1:1 when the group is amenable [37, §7].

In this paper we generalize the theory of (stable) weak containment and (stable) weak equivalence
to the more general setting of µ-stationary actions. Furthermore we observe that weak equivalence
can be seen as the ﬁrst-order theory of the given µ-stationary actions, when regarded as structures
in ﬁrst-order logic for metric structures. A good introduction to the logic for metric structures, also
called continuous logic, can be found in [5]. We identify a µ-stationary action with the corresponding
action on the measure algebra. This allows one to regard a µ-stationary action as a structure in
the signature consisting of function symbols for the Boolean algebra operations, a unary function
symbol for every element of the group, and a relation symbol for the probability measure on the
space. In this signature, µ-stationary actions form an axiomatizable class. Two actions are weakly
equivalent if and only if they have the same universal theory, which is the portion of the ﬁrst-order
theory where only universal formulas are considered. Using this perspective, we show that the space of
stable weak equivalence classes of µ-stationary actions is a metrizable compact convex set. The space
of stable weak equivalence classes of measure-preserving actions is a closed face of such a compact
convex set. Furthermore, we consider the natural µ-stationary analog of the IRS associated with a
measure-preserving action, which we call µ-stationary random subgroup (µ-SRS). This can be seen as
a particular case of a nonsingular random subgroup (NSRS) in the sense of [24]. We prove that the
µ-SRS of a µ-stationary action can be seen as a continuous aﬃne map on the space of stable weak
equivalence classes. The same result is proved for the Furstenberg entropy of a stationary action.
The fact that the values of Furstenberg entropy on boundary µ-stationary actions form a compact
set is obtained as a consequence with the latter result, together with the omitting types theorem in
ﬁrst-order logic for metric structures [6, 18, 20].

The rest of the present paper is divided into three sections. In Section 2 we introduce the notion of
weak equivalence for stationary actions, deﬁne the topology on the space of weak equivalence classes,
and characterize the continuous real-valued functions on such a space. In Section 3 we consider the
related notion of stable weak equivalence, and prove that the space of stable weak equivalence classes
is a metrizable compact convex set. Finally in Section 4 we prove that the Furstenberg entropy can
be seen as a continuous aﬃne function on the space of stable weak equivalence classes. We deduce
from this together with the omitting types theorem that the set of values of the Furstenberg entropy
on boundary actions is compact.

Acknowledgments. We would like to thank Lewis Bowen for his comments and remarks on a pre-
liminary draft of the present paper.

2. Weak equivalence of stationary actions

2.1. Weak equivalence. In the rest of the paper we suppose that G is a countable discrete group
endowed with a probability measure µ with the property that the support of µ generates G as a

4

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

semigroup. An action a of G on a probability space (X, µ) is a map G×X → X, denote by (g, x) 7→ gax.

An action a of G on a probability space (X, B, µ) is called ν-stationary if it satisﬁes ν = Pg∈G µ (g) gaν.

Here gaν denotes the push-forward of ν under the map x 7→ gax.

Deﬁnition 2.1. If a, b are two µ-stationary actions of G on probability spaces (Xa, Ba, νa) and
(Xb, Bb, νb), then we say that a is weakly contained in b—in formulas a ≺ b—if for any n ∈ N,
p1, . . . , pn ∈ Ba, g1, . . . , gn ∈ G (not necessarily distinct) and ε > 0, there exist q1, . . . , qn ∈ Bb such
that for any function σ : {1, 2, . . . , n} → {1, 2, . . . , n}, one has that

We say that a is weakly equivalent to b—in formulas a ∼ b—if a is weakly contained in b and vice
versa.

(cid:12)(cid:12)νa(cid:0)gσ(1)p1 ∩ · · · ∩ gσ(n)pn(cid:1) − νb(cid:0)gσ(1)q1 ∩ · · · ∩ gσ(n)qn(cid:1)(cid:12)(cid:12) < ε.

It is clear that such a deﬁnition coincides with the usual deﬁnition of weak containment for measure
preserving actions when a and b are measure preserving.
It is also clear that if p1, . . . , pn form a
partition of Xa, then it is not restrictive to require that q1, . . . , qn form a partition of Xb. As in the
measure-preserving case, we will denote by [a]∼ the weak equivalence class of a. We will observe
below (Proposition 2.5) that Deﬁnition 2.1 is equivalent to the seemingly weaker condition where only
pairwise intersections are considered.

We will also considering the strengthening of this notion called elementary equivalence (which
coincides with the usual notion of elementary equivalence in model theory, as observed below). This
is deﬁned similarly as weak equivalence in terms of a game that is called Ehrenfeucht–Fra¨ıss´e game
in model theory and pebble game in computer science. Such a game is played between two players:
the Spoiler and the Duplicator. It has two parameters: the number of rounds k, the tolerance ε, and
of the group g1, . . . , gkn ∈ G (not necessarily distinct). At each round the Spoiler picks one between
the actions a and b—say, a—and an n-tuple of elements pnk+1, . . . , pnk+n of Ba. The Duplicator has
to respond with an n-tuple of elements qnk+1, . . . , qnk+n of Bb. If, instead, the Spoiler chooses b and
an n-tuple of elements qnk+1, . . . , qnk+n of Bb, then the Duplicator has to answer with an n-tuple of
elements pnk+1, . . . , pnk+n of Ba. The game ends after k rounds. The Duplicator wins the game if,
considering all the elements pi of Ba and qi of Bb for i = 1, 2, . . . , kn chosen during the game, one has
that

for any function σ : {1, 2, . . . , kn} → {1, 2, . . . , kn}.

(cid:12)(cid:12)νa(cid:0)gσ(1)p1 ∩ · · · ∩ gσ(kn)pkn(cid:1) − νb(cid:0)gσ(1)q1 ∩ · · · ∩ gσ(kn)qkn(cid:1)(cid:12)(cid:12) < ε

Deﬁnition 2.2. If a, b are two µ-stationary actions of G on probability spaces (Xa, Ba, νa) and
(Xb, Bb, νb), then we say that a is k-elementary equivalent to b if the Duplicator has a winning strategy
for the Ehrenfeucht–Fra¨ıss´e game for a and b. We say that a and b are elementarily equivalent if a
and b are k-elementarily equivalent for any k ∈ N. In this case we write a ≈ b.

It is clear that weak equivalence in the sense of Deﬁnition 2.1 coincides with 1-elementary equivalence
in the sense of Deﬁnition 2.2, and hence elementary equivalence implies weak equivalence. We denote
by [a]≈ the elementary equivalence class of a.

Example 2.3. It follows from the Rokhlin lemma for amenable groups [34] that any two free measure-
preserving actions of an amenable group G are elementarily equivalent. This was observed in [7] in
the case of Z-actions.

As in the measure-preserving case, one can characterize weak equivalence and elementary equiv-
alence in terms of ultrapowers. Suppose that I is an index set and U is an ultraﬁlter on I. The

ultrapower QU ai of an I-sequence (ai) of µ-stationary actions on probability spaces (Xai, Bai , νai)

can be deﬁned analogously as in the measure-preserving case. It is not diﬃcult to verify that such
an ultraproduct is again a µ-stationary action. When (ai) is the I-sequence constantly equal to I,
the corresponding ultraproduct is called the ultrapower of a with respect to U and denoted by aU .
One then has that a is weakly contained in b if and only if a is a factor of some (equivalently, any)
ultrapower of b with respect to a nonprincipal ultraﬁlter U over N.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

5

A result in model theory known as the Keisler-Shelah theorem [5, Theorem 5.7] provides the fol-
lowing characterization of elementary equivalence: a and b are elementarily equivalent if and only if
they have isomorphic ultrapowers. It follows from the Lowenheim-Skolem theorem [5, Proposition 7.3]
that any action is elementarily equivalent to some action on a countably generated probability space.
Therefore in the following we will assume, without loss of generality, that all probability spaces are
countably generated.

In the following, if λ, ν are Borel measure on a Borel space (X, B), and λ is absolutely continuous
with respect to ν, then we denote by dλ/dν the Radon-Nikodym derivative of λ with respect to
ν [17, Theorem 5.5.4]. Suppose that g ∈ G and a is a µ-stationary action. Then we have 1 =

(dgaν/dgaν) = Ph∈G µ (h) (dgahaν/dgaν) and, in particular, µ (h) (dgahaν/dgaν) ≤ 1 for any h ∈ G.
Taking g = 1 one obtains that µ (h) (dgahaν/dν) ≤ 1 and by taking g = h−1 one obtains that
µ(g−1)(dν/dgaν) ≤ 1. Therefore µ(g−1) ≤ dgaν/dν ≤ µ (g)−1 whenever g belongs to the support of
µ; see also [28]. Since we are assuming that the support of µ generates G as a semigroup, we can
conclude that for any g there exists a constant Mg such that dgaν/dν ≤ Mg and dν/dgaν ≤ Mg for
any µ-stationary action a.

Remark 2.4. One can deﬁne the notion of weak containment, weak equivalence, and elementary
equivalence for arbitrary nonsingular actions. All the results of this paper go through with no change
where one considers, for some ﬁxed constants Mg > 0 for g ∈ G, the class of nonsingular actions a of
G on probability spaces with the property that dgν/dν ≤ Mg for every g ∈ G. As remarked above,
such a class of actions includes the class of µ-stationary actions for a suitable choice of constants Mg.

2.2. Binary intersections. In this section we remark that the notion of weak containment for µ-
stationary actions as formulated in Deﬁnition 2.1 is equivalent to the apparently weaker deﬁnition
where only pairwise intersections are considered.

Proposition 2.5. Suppose that a, b are two µ-stationary actions of G on probability spaces (Xa, Ba, νa)
and (Xb, Bb, νb). The following assertions are equivalent:

(1) a is weakly contained b;
(2) For any ﬁnite subset F of G, ε > 0, and p1, . . . , pn ∈ Ba, there exist q1, . . . , qn ∈ Bb such that

(3) For any ﬁnite subset F of G, ε > 0, and p1, . . . , pn ∈ Ba, there exist q1, . . . , qn ∈ Bb such that

(cid:12)(cid:12)νa(gaqi ∩ haqj) − νb(gbqi ∩ hbqj)(cid:12)(cid:12) < ε for any g, h ∈ F and i, j ∈ {1, 2, . . . , n}.
(cid:12)(cid:12)νa(gaqi ∩ qj) − νb(gbqi ∩ qj)(cid:12)(cid:12) < ε for any g ∈ F and i, j ∈ {1, 2, . . . , n}.

Proof. One can prove that (2)⇒(1) by induction on the number of k of k-wise intersections. It remains
to prove (3)⇒(1). Suppose that F = {g0, . . . , gm} is a ﬁnite subset of G, n ∈ N, and p0, . . . , pn ∈ Ba.
Without loss of generality, we can assume that n = m, g0 is the identity of the group G, and p0 = Xa.
Fix ε > 0 and set δ := ε/7. Set pij = gjpi for i, j ≤ n. In particular we have pi0 = pi and pij = gjpi0
for i, j ≤ n. By assumption there exist qij ∈ Bb such that |νb (qij ∩ gmqℓk) − νa (pij ∩ gmpℓk)| < δ for
any i, j, k, ℓ, m ≤ n. Since p00 = p0 = Xa and g0 is the identity, we have that νb (q00) > 1 − δ. It
follows that |νb(gb

ℓ pij)| < 2δ for i, j, ℓ ≤ n. Therefore

ℓ qij) − νa(ga

νb(gb

kqi0 △ qij) = νb(gb

kqi0) + νb(qij) − 2νb(gkqi0 ∩ qik)

In conclusion

≤ 6δ + νa(ga
= 6δ + νa(ga

k pi0) + νa(qij) − 2νa(gkpi0 ∩ pik)
k pi0 △ pik) = 6δ.

νa(ga

k pi ∩ ga

ℓ pj) − νb(gb

kqi0 ∩ gb

νa(pik ∩ pjℓ) − νb(gb

(cid:12)(cid:12)(cid:12)

ℓ qj0)(cid:12)(cid:12)(cid:12)

≤ (cid:12)(cid:12)(cid:12)

kqi0 ∩ qjℓ)(cid:12)(cid:12)(cid:12)

+ 6δ ≤ 7δ ≤ ε.

for every i, j, k, ℓ ≤ n. This proves that q00, . . . , qn0 witness the fact that a is weakly contained in
b.
(cid:3)

2.3. Stationary actions as structures. In the following, we will identify an action of G on a
countably saturated probability space with the induced action on the associated measure algebra.
More generally one can consider µ-stationary actions of G on (not necessarily separable) probability

6

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

algebras. A probability algebra is a Boolean algebra A with maximum element 1 and minimum
element 0, endowed with a probability measure ν : A → [0, 1]. A probability algebra is endowed
with a canonical metric deﬁned by d (A, B) = ν (A △ B). An action of G on (A, ν) is stationary if

ν (x) = Pg∈G µ (g) ν (cid:0)(g−1)ax(cid:1). This implies that the functions x 7→ gax are Lipschitz with constant
µ(cid:0)g−1(cid:1)−1 for every g in the support of µ. Since, by assumption the support of µ generates G as
Lg equal to the inﬁmum of µ(cid:0)g−1
1 (cid:1)

a semigroup, we can conclude that for any g ∈ G the function x 7→ gax is Lipschitz with constant
where k ∈ N and g1 · · · gk = g. In particular, Lg

depends only from g and µ and not from the given µ-stationary action a.

−1

−1

· · · µ(cid:0)g−1
k (cid:1)

It is a well-known fact that when A is the measure algebra of a countably generated probabil-
ity space, any such an action has a point realization as a µ-stationary action on the corresponding
probability space [35, Theorem 3.3]; see also [30].

We will regard probability algebras and µ-stationary actions of G on probability algebras as struc-
tures in the logic for metric structures. A standard reference for this subject is [5]. The language for
µ-stationary actions of G on probability algebras includes function symbols for the Boolean algebra
operations and for the elements of the group, constant symbols for the maximum and the minimum
element of the Boolean algebra, and a relation symbol ν for the measure on the space.
It is not
diﬃcult to verify that the class of µ-stationary actions of G on probability algebras form a universally
axiomatizable class. Furthermore the other Boolean algebras operations are deﬁnable in terms of the
meet operation.

In this context, an atomic formula with free variables x1, . . . , xn is (equivalent to) and expres-
sion ϕ (x1, . . . , xn) of the form ν (g1x1 ∧ · · · ∧ gnxn) where n ∈ N, g1, . . . , gn ∈ G, and x1, . . . , xn
are variables. A quantiﬁer-free formula with free variables x1, . . . , xn is an expression of the form
f (ϕ1, . . . , ϕk) where ϕ1, . . . , ϕk are atomic formulas with free variables x1, . . . , xn and f : Rk → R
is a continuous function. Without loss of generality, one can assume that f belongs to some ﬁxed
countable dense set of functions that is dense in the compact-open topology. A universal formula
ψ (x1, . . . , xn) with free variables x1, . . . , xn is an expression supy1 · · · supyk ψ (x1, . . . , xn, y1, . . . , yk)
where ψ (x1, . . . , xn, y1, . . . , yk) is a quantiﬁer-free formula with free variables x1, . . . , xn, y1, . . . , yk. A
existential formula is deﬁned similarly as a universal formula, where suprema are replaced with inﬁma.
Finally, a formula is deﬁned as a universal or existential formula, where both suprema and inﬁma are
allowed. A formula is called a sentence when it has no free variables.

1 x1 ∧ · · · ∧ ga

If a is a µ-stationary action of G on a probability algebra A and ϕ is a sentence, then one can
deﬁne in the obvious way the interpretation of ϕ in a. This is the real number ϕa obtained by letting
the suprema and inﬁma in ϕ range among the element of ϕ, and the interpreting ν (g1x1 ∧ · · · ∧ gnxn)
for some x1, . . . , xn ∈ A as ν (ga
nxn). More generally, one can deﬁne the interpretation
in a of a formula ϕ (x1, . . . , xn) with free variables x1, . . . , xn. This will be a uniformly continuous
function ϕa : An → R. We say that a collection F of formulas is uniformly equicontinuous if the
collection of functions ϕa where ϕ varies in F and a varies among the µ-stationary actions of G, is
uniformly equicontinuous. It is not diﬃcult to see that a single formula is uniformly continuous. The
universal theory T h∀ (a) of an action a is the function ϕ 7→ ϕa that assigns to a universal sentence
ϕ its interpretation in a. The theory T h (a) of a is deﬁned similarly, where arbitrary sentences are
considered. One can thus identify the weak equivalence class [a]∼ of a with the universal theory
T h∀ (a) of a, and the elementary equivalence class [a]≈ with the theory T h (a) of a.

Remark 2.6. One could also deﬁne the interpretation of a formula by letting the variables range
among the L∞-functions of norm at most 1. It is not diﬃcult to see that doing so does not change
the notion of axiomatizable class, omitting type class, elementary equivalence invariant, and weak
equivalence invariant deﬁned below.

2.4. The space of weak equivalence classes. Suppose that S is a class of µ-stationary actions on
countably separated probability spaces.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

7

Deﬁnition 2.7. The logic topology on S is the weakest topology that makes the functions a 7→ ϕa
continuous for any sentence ϕ. The weak logic topology on S is the weakest topology that makes the
function a 7→ ϕa continuous for any universal sentence ϕ.

Clearly, the weak logic topology is weaker than the logic topology. In general the logic topology is
not separated. By deﬁnition, two actions are not separated in the logic topology if and only if they
are elementarily equivalent. Similarly, two actions are not separated in the weak logic topology if and
only if they are weakly equivalent. The observation that one can restrict, without loss of generality,
to a countable collection of formulas shows that the logic topology and the weak logic topology on
S admit a countable basis. The weak logic topology on S is induced by a countable collection of
canonical pseudometrics dn,F for n ∈ N and F ⊂ N ﬁnite deﬁned as follows. For a µ-stationary action
a on (X, B, ν), let C (a) be the closed subset of [0, 1]k×k×F consisting of those elements of the form
(ν (pi ∩ gpj))(i,j,g)∈k×k×F for some partition p0, . . . , pk−1 ∈ B. Then dn,F (a, b) is the Hausdorﬀ distance
between C (a) and C (b). It is clear from Proposition 2.5 that such a collection of pseudometrics is
indeed compatible with the weak logic topology.

Let S∼ be the collection of weak equivalence classes of actions from S. As remarked above, we
can identify S∼ with the space of universal theories of actions from S. The weak logic topology on
S induces a metrizable topology on S∼, which is compact whenever S is compact in the weak logic
topology.

2.5. Combinatorially rigid actions. The notions of rule and combinatorial rigid action have been
considered in [1]. A (k, F )-rule for k ∈ N and a ﬁnite subset F of G is a subset L ⊆ {1, . . . , k}F .
An action a of G on a probability space (X, B, ν) almost satisﬁes L if for any ε > 0 there exists
p1, . . . , pk ∈ B forming a partition of X such that the set

qL (p1, . . . , pk) = [σ∈L \g∈F

g−1pσ(g)

has ν-measure at least 1 − ε. The action a properly satisﬁes L if one can ﬁnd a partition p1, . . . , pk ∈ B
of X such that qL (p1, . . . , pk) = X. An action a is combinatorially rigid if whenever it almost satisﬁes
a (k, F )-rule L for k ∈ N and F ⊂ G ﬁnite, then it properly satisﬁes it.

Consider for L ⊂ {1, 2, . . . , k}F the existential sentence

ϕL ≡ inf
x1

· · · inf
xn

max {ν (xi ∩ xj) , 1 − ν (x1 ∪ · · · ∪ xn) , 1 − ν (qL (p1, . . . , pk))}

where qL (p1, . . . , pk) is deﬁned as above. It is clear that a µ-stationary action a almost satisﬁes L if
and only if the evaluation of ϕL at a is equal to 0. Similarly a µ-stationary action a properly satisﬁes
L when the evaluation of ϕL at a is zero and moreover the value zero is attained by some choice of
elements x1, . . . , xn.

It follows from countable saturation of ultrapowers [5, Proposition 7.6] that whenever U is a nonprin-
cipal ultraﬁlter over N, then the ultrapower aU is combinatorially rigid. Furthermore the downward
Lowenheim-Skolem theorem can be applied to ﬁnd a combinatorially rigid factor of aU acting on a
countably separated probability space that is elementarily equivalent to aU and therefore to a. This
gives a proof of the following proposition, that recovers [1, Theorem 2] in the measure-preserving case.

Proposition 2.8. Any µ-stationary action is elementarily equivalent to a combinatorially rigid action.

2.6. Weak equivalence and orbits. In this section we consider the class of µ-stationary actions of
G on the standard probability space (X, B, ν). Following [11], we denote such a class by Aµ (G, X, ν).
There are two natural topologies that one can put on the space Aµ (G, X, ν). These are described
in [11, §6.1.1] and [11, §6.1.2], and called the weak topology and the very weak topology. Suppose that
(an) is a sequence in Aµ (G, X, ν). Then (an) converges to a in the very weak topology if, for any p ∈ B
and g ∈ G, ganp → gap for n → +∞ in the measure algebra B endowed with its canonical metric.
The sequence (an) converges to a in the weak topology if it converges in the very weak topology and
furthermore for any g ∈ G, dgan ν/dν → dgaν/dν for n → +∞ in L1 (ν). Clearly, these two topologies
agree for measure-preserving actions. The very weak topology on Aµ (G, X, ν) coincides with the

8

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

topology of pointwise convergence with respect to the 2-norm on L∞ (ν), so it is natural to consider
it in this setting.

We denote by Aut (X, ν) the group of ν-preserving Borel automorphisms γ of X. The weak topology
on Aut (X, ν) is deﬁned as above, by letting γn → γ if and only if γn (p) → γ (p) in the measure
algebra for any p ∈ B. This makes Aut (X, ν) a Polish group. There is a natural continuous action
of Aut (X, ν) on Aµ (G, X, ν) by conjugation. The corresponding orbit equivalence relation is the
relation of (measurable) conjugacy of µ-stationary actions. We remark here that weak containment
can be naturally described in terms of such an action. This recovers a well known fact in the measure-
preserving case and can be proved in a similar way; see [29, Proposition 10.1].

Proposition 2.9. Suppose that a, b ∈ Aµ (G, X, ν). The following assertions are equivalent:

(1) a is weakly contained in b;
(2) there exists a sequence (γn) in Aut (X, ν) such that γnbγ−1

n → a in the very weak topology.

2.7. Weak equivalence invariants. Suppose that S is the class of all µ-stationary actions on count-
ably separated probability spaces.

Deﬁnition 2.10. The function f : S → R is a continuous weak equivalence invariant if f (a) = f (b)
whenever a ∼ b and f is continuous when S is endowed with the weak logic topology. A continuous
weak equivalence invariant f : S → R is nondecreasing if f (a) ≤ f (b) whenever a is weakly contained
in b, and nonincreasing if f (a) ≥ f (b) whenever a is weakly contained in b for i = 1, 2, . . . , d.

Similarly one can deﬁne continuous elementary equivalence invariants by considering the logic topol-
ogy instead of the weak logic topology. The following syntactic characterization of elementary equiv-
alence and weak equivalence invariants is a well know model-theoretic fact. We present a sketch of
the proof for convenience of the reader.
If F is a class of sentences, we say that a function f is
F-approximable if for any ε > 0 there exists a sentence ϕ in F such that |ϕa − f (a)| < ε for any
a ∈ S.

Proposition 2.11. Fix a function f : S → R.

(1) f is a continuous elementary equivalence invariant if and only if f is F -approximable, where

F is the class of all sentences.

(2) f is a continuous weak equivalence invariant if and only if f is F -approximable, where F is

the class of sentences of the form ϕ − ψ, where ϕ, ψ are universal sentences.

(3) f is a nondecreasing continuous weak equivalence invariant if and only if f is F -approximable,

where F is the class of universal sentences.

(4) f is a nonincreasing continuous weak equivalence invariant if and only if f is F -approximable,

where F is the class of existential sentences.

Proof. For (1), necessity is obvious, while suﬃciency can be seen by applying the Stone-Weierstrass
theorem. The same argument gives (2). Finally, (3) can be proved similarly as [19, Proposition 2.4.6],
and (4) follows by applying (3) to −f .
(cid:3)

The continuous elementary equivalence invariants are also called deﬁnable predicates in the model

theory literature [5, §9].

Deﬁnition 2.12. A collection S of µ-stationary actions on countably separated probability spaces is
an axiomatizable class if there exists a collection F of continuous elementary equivalence invariants
such that, given a µ-stationary action a on a countably separated probability space, one has that a
belongs to S if and only if ϕa = 0 for any ϕ ∈ F. We say that S is universally axiomatizable if one
can take F to be a collection of nondecreasing continuous weak equivalence invariants.

For instance, the collection of measure-preserving actions is an axiomatizable class. Similarly, the
collection of µ-stationary actions on the standard probability space is axiomatizable. Clearly, the
intersection of a collection of axiomatizable classes is still axiomatizable. It follows from Proposition
2.11 that, whenever S is an axiomatizable class, then the logic topology and the weak logic topology
on S are compact.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

9

3. Stable weak equivalence and convexity

3.1. Stable weak equivalence. In parallel with the corresponding notion in the measure-preserving
case, we consider now stable weak equivalence of µ-stationary actions. Recall that we only consider
µ-stationary actions on countably separated probability spaces. We denote such a class by S. Let ι
the trivial action of G on the standard (atomless) probability space.

Deﬁnition 3.1. Suppose that a, b are µ-stationary actions. We say that a is stably weakly contained
in b if a × ι is weakly contained in b × ι. Similarly, a is stably weakly equivalent to b if a × ι is weakly
equivalent to b × ι.

One can also think about stable weak containment as the restriction of weak containment to the
class of stable actions. We say that a µ-stationary action a of G is stable if it weakly equivalent to
a × ι. This implies that a is an action on the standard probability space.

Given actions a, b are µ-stationary actions on the standard probability space and t ∈ [0, 1] one can
deﬁne their convex combination ta + (1 − t) b similarly as in the measure-preserving case. One can
think about a as acting on [0, t] and b acting on (t, 1], and then let ta + (1 − t) b be the action on [0, 1]
that agrees with a on [0, t] and with b on (t, 1]. The deﬁnition in the general case is analogous.

2 a+ 1

Observe that, when a, b are stable, then ta+(1 − t) b is stable as well. It is easy to see that an action
a is stable if and only if it is weakly equivalent to 1
2 a. One can then deduce from this that the class
of stable µ-stationary actions of G is axiomatizable. We denote such a class by S st. It then follows from
the remarks from §2.4 that the space S st
∼ of weak equivalence classes of stable µ-stationary actions of
G is a compact metrizable space. The space S st
∼ can be equivalently identiﬁed with the space of stable
weak equivalence classes of arbitrary µ-stationary actions on countably separated probability spaces.
The notion of convex combination of actions deﬁnes above induces a convex structure on S st
∼ , obtained
by setting t [a]∼ + (1 − t) [b]∼ = [ta + (1 − t) b]∼ for a, b ∈ S st. The fact that convex combinations
commute with ultrapowers, together with the ultrapower characterization of weak equivalence, shows
that such a notion of convex combination is well deﬁned. This can also be seen directly from the
deﬁnition of weak equivalence.

Deﬁnition 3.2. An aﬃne continuous weak equivalence invariant is a continuous weak equivalence
invariant f : S → R such that f (ta + (1 − t) b) = tf (a) + (1 − t) f (b) for any stable action a, b and
t ∈ [0, 1].

Observe that, if f is an aﬃne continuous weak equivalence invariant, then f (a) = f (b) whenever a
and b are stably weakly equivalent. Thus it induces a continuous aﬃne map from the space of stable
weak equivalence classes to R.

We say that a quantiﬁer free formula f (ψ1, . . . , ψn), where ψ1, . . . , ψn are atomic formulas, is aﬃne
if f : Rn → R is an aﬃne map. An aﬃne universal sentence is a universal sentence of the form
supx ϕ (x), where ϕ (x) is an aﬃne quantiﬁer-free formula.

Proposition 3.3. For a function f : S → R, the following statements are equivalent:

(1) f is an aﬃne continuous weak equivalence invariant;
(2) f is F -approximable, where F is the class of sentences of the form ϕ − ψ, where ϕ, ψ are aﬃne

universal sentences.

We now present the proof of Proposition 3.3.

functions on the compact space S st
This makes V a (real) function system with order unit 1.

If supx ϕ (x) is an aﬃne universal sentence and
λ is a positive real number, then we identify λ supx ϕ (x) with supx λϕ (x) and − supx ϕ (x) with
inf x(−ϕ (x)). Similar conventions will apply to an existential sentence. In this way we can regard the
space F of sentences of the form ϕ − ψ, where ϕ and ψ are universal sentences, as a vector space. We
consider a seminorm on F deﬁned by kϕ − ψkS st = supa |ϕa − ψa| where a varies among all the stable
µ-stationary actions on the standard probability space. We let V be the completion of F with respect
to such a norm. We can canonically identify V with a subspace of the space C (cid:0)S st

∼ . Furthermore, it contains the function 1 constantly equal to 1.

∼(cid:1) of continuous

10

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

The state space S (V ) of V is the space of linear functionals of norm 1 that are unital, in the sense
that map the order unit to 1. The state space S (V ) is a compact convex set when endowed with the
w*-topology. Kadison’s representation theorem for function systems [2, Theorem II.8.1] shows that
the canonical map from V to the space of continuous aﬃne functions on S (V ) is a surjective linear
isometry.

We now observe that S (V ) is aﬃnely homeomorphic to S st

∼ . Indeed any a ∈ S st induces a state
sa on V that extend the linear map ϕ 7→ ϕa deﬁned on F. By deﬁnition of weak equivalence, such
a linear functional only depends from the weak equivalence class of a, and thus it induces a function
from S st
∼ , aﬃne since we
are only considering aﬃne formulas, and onto since the range separates the points of V . It remains
to prove that such a maps is injective. This will be a consequence of the following:

∼ to S (V ). Such a function is continuous by deﬁnition of the topology on S st

Lemma 3.4. Suppose that a, b are stable µ-stationary actions on the standard probability space.
Then a is weakly contained in b if and only if ϕa ≤ ϕb for any aﬃne universal sentence.
Proof. We have already observed that if a is weakly contained in b, then ϕa ≤ ϕb for any universal
sentence. Conversely, suppose that a is not weakly contained in b. Then there exist d ∈ N and δ > 0
and a ﬁnite subset F of G such that, letting A be the (ﬁnite) set of atomic formulas ψ (x1, . . . , xd)
in d free variables only involving group elements from F , the following holds. Let C (a) be the set
of elements of [0, 1]A of the form ψ 7→ ψa (p1, . . . , pd) for p1, . . . , pd ∈ B, and similarly deﬁne C (b).
Then C (a) is not contained in C (β). Since a and b are stable actions, C (a) and C (b) are compact
convex sets. Therefore by the geometric form of the Hahn-Banach theorem, there exist ε > 0 and an
aﬃne function f : RA → R such that f |C(α) ≥ ε and f |C(β) ≤ 0. Thus one can deﬁne the universal
aﬃne sentence ϕ = supx f ((ψ)ψ∈A). By construction we have ϕa ≥ ε and ϕβ ≤ 0. This concludes the
proof.
(cid:3)

The above discussion shows that the canonical map from V to the space A(cid:0)S st

aﬃne functions on S st
∼ is a surjective isometric isomorphism. In particular this provides a proof of
Proposition 3.3. We deﬁne a class S of µ-stationary stable actions to be convex axiomatizable if
there exists a collection F of continuous aﬃne weak equivalence invariants such that a stable action
a belongs to S if and only if f (a) ≥ 0 for any f ∈ F. This is equivalent to the assertion that S∼ is a
compact convex subset of S st
∼ . In this case, A (S∼) can be canonically identiﬁed with the quotient of

∼(cid:1) of continuous

∼(cid:1) with respect to the subspace (cid:8)f ∈ A(cid:0)S st

A(cid:0)S st
For instance the class S pmp of stable measure-preserving actions is convex axiomatizable by the
universal aﬃne sentences supx (µ (x) − µ (gx)) for g ∈ G. As a consequence, we obtain that S pmp
is a
metrizable compact convex set, and A (S pmp
∼ ) is isometrically isomorphic to the completion of the space
of diﬀerences of aﬃne universal formulas with respect to the seminorm kϕ − ψkS pmp = sup |ϕa − ψa|
where a ranges among all the measure preserving stable actions of G. This recovers the result from
[13,14] that S pmp
is aﬃnely homeomorphic to a metrizable compact convex subset of a Banach space.

∼(cid:1) : f |S∼ ≡ 0(cid:9).

∼

∼

3.2. The stationary random subgroup of a stationary action. Let S (G) be the space of sub-
groups of G endowed with the Fell topology [24].

Deﬁnition 3.5. A µ-stationary random subgroup or µ-SRS is a Borel measure ν on S (G) such that
the action of G on (S (G) , ν) by conjugation is µ-stationary.

Suppose that a is a µ-stationary action of G on (Xa, Ba, νa). There is a Borel map from Xa to S (G)
mapping x to its stabilizer subgroup sta (x). In analogy with the measure-preserving case, we deﬁne
the µ-stationary random subgroup SRS (a) associated with a to be the push-forward measure of νa
under the map x 7→ sta (x). It is not diﬃcult to verify that this is indeed a µ-SRS. When a is measure-
preserving, then SRS (a) is in fact an invariant random subgroup. For nonsingular automorphisms
α1, . . . , αn of (X, ν), we let Fix (α1, . . . , αn) be the set of common ﬁxed points of α1, . . . , αn, and
Free (α1, . . . , αn) be the set of x ∈ X such that αix 6= x for every i = 1, 2, . . . , n. Suppose that
g1, . . . , gn, h1, . . . , hm ∈ G. Let A (g1, . . . , gn, h1, . . . , hm) be the set

{H ∈ S (G) : g1, . . . , gn ∈ H, h1, . . . , hm /∈ H} .

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

11

The measure of A (g1, . . . , gn, h1, . . . , hm) according to SRS (a) is νa (Fix (ga

1, . . . , ha
Proposition 3.6. The function a 7→ SRS (a) (A (g1, . . . , gn, h1, . . . , hm)) is an aﬃne continuous weak
equivalence invariant.

n) ∩ Free (ha

1 , . . . , ga

m)).

Proof. Suppose that g ∈ G and p ∈ Ba. Fix a constant Mg such that dgaν/dν ≤ Mg and dν/dgaν ≤ Mg
for any µ-stationary action a. Observe that νa (p \ Fix (ga)) > t if and only if there exists q ⊂ p such
that νa(cid:0)(q ∪ gaq ∪ (ga)−1q) ∩ p(cid:1) > t+3Mgνa (gq ∩ q). It follows that νa (p \ Fix (ga)) is the supremum
of νa(cid:0)(q ∪ gaq ∪ (ga)−1q) ∩ p(cid:1) − 3Mgνa (gq ∩ q) where q ranges among the subsets of p. Furthermore
we have that νa (p △ Fix (ga)) = 1 + 2ν (p \ Fix (g)) − ν (p) − ν (Xa \ Fix (g)). Deﬁne ψg (x) to be the
formula

sup

y (cid:0)ν((cid:0)(y1 ∩ x) ∪ (gy1 ∩ x) ∪ (g−1y1 ∩ x)(cid:1) ∩ x) − 3Mgν(g(x ∩ y) ∩ (x ∩ y)(cid:1)

and ϕg (x) to be the formula 2ϕg (x) − ν (x) + 1 − ψg (1). Then in view of the discussion above we
have that ϕa

g (p) = νa (p △ Fix (ga)). Finally consider the sentence θ deﬁned by

sup

sup

ν (x1 ∩ · · · ∩ xn ∩ (1 − y1) ∩ · · · ∩ (1 − ym))−(ϕg1 (x1)+· · ·+ϕgn(xn)+ϕh1(y1)+· · ·+ϕhm(xm)).

y1,...,ym

x1,...,xn
Observe that θa = νa (Fix (ga
In view of
Proposition 2.11., this concludes the proof that the a 7→ SRS (a) ((A (g1, . . . , gn, h1, . . . , hm))) is a
continuous weak equivalence invariant. It is immediate to verify that such an invariant is aﬃne. (cid:3)

m)) for any µ-stationary action.

n) ∩ Free (ha

1, . . . , ha

1 , . . . , ga

Corollary 3.7. The µ-stationary random subgroup associated with a µ-stationary action a depends
only on the stable weak equivalence class of a. Furthermore the map [a × ι]∼ 7→ SRS (a) is a continuous
aﬃne map from the space of stable weak equivalence classes of µ-stationary actions onto the space of
µ-stationary random subgroups of G.

3.3. Weak containment and µ-stationary factors. Suppose that W is a compact metrizable space

of µ-stationary Borel probability measures on W G. These are the Borel probability measures on W G

and W G is the corresponding topological Bernoulli shift. Following [11], we let Pµ(cid:0)W G(cid:1) be the space
that make the Bernoulli action µ-stationary. The space Pµ(cid:0)W G(cid:1) is a Choquet simplex, whose extreme
E (a, W ) be the subspace of Pµ(cid:0)W G(cid:1) consisting of measures of the form φ∗νa, where φ : Xa → W G is

points are the ergodic µ-stationary measures [3]. Given a µ-stationary action a on (Xa, Ba, νa), we let

a G-invariant Borel map. The same argument as for measure-preserving actions—see [37, §3]—shows
that a µ-stationary action a is weakly contained in b iﬀ E (a, W ) is contained in the closure of E (b, W )
for some (equivalently, every) nontrivial compact metrizable space W . Similarly, a is stably weakly
contained in b iﬀ E (a, W ) is contained in the closed convex hull of E (b, W ) for some (equivalently,
every) nontrivial compact metrizable space W . Therefore one can reformulate [11, Theorem 4.1] as
follows:

Theorem 3.8. Any µ-stationary action is weakly contained in any essentially free extension of the
Poisson boundary of (G, µ).

4. Furstenberg entropy and boundary actions

4.1. Furstenberg entropy as a weak equivalence invariant. The Furstenberg entropy hµ (a) of
µ-stationary action a on (Xa, Ba, νa) is given by

hµ (a) = Xg∈G

µ (g)ZXa

− log (dν/dgaν) (x) dgaν (x) .

The goal of this section is to prove that the distribution of the Radon-Nikodym derivatives dgaν/dν
and the Furstenberg entropy hµ (a) are continuous weak-equivalence invariants.

Theorem 4.1. For µ-stationary action a of G, let (Xa, Ba, νa) be the space on which a acts. The
function a 7→ νa{x ∈ Xa : (dgaν/dν) (x) > c} is an aﬃne continuous weak equivalence invariant for
µ-stationary actions.

12

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

Proof. Let M be a positive constant such that dgaν/dν ≤ M and dν/dgaν ≤ M for any µ-stationary
action a. Suppose that (an) is a sequence of µ-stationary actions and a is a µ-stationary action such
that the sequence (an) converges in the weak logic topology to a. For simplicity we will assume that
an and a are actions on the standard probability space X = [0, 1] endowed with the Borel σ-algebra
and the Lebesgue measure ν. Let ω = dgaν/dν, ωn = dgan ν/dν for n ∈ N, C = {x ∈ X : ω (x) > c},
and Cn = {x ∈ X : ωn (x) > c}. We will prove that ν (C) ≤ lim inf n ν (Cn). The proof that ν (C) ≥
lim supn ν (Cn) is analogous. Suppose by contradiction ν (C) > lim inf n ν (Cn). Thus, after passing to
a subsequence, we can assume that there is δ > 0 such that ν (Cn) ≤ ν (C) − δ for every n ∈ N. Deﬁne
the Borel linear order ≺ on X by letting t ≺ s iﬀ ω (t) < ω (s) or ω (t) = ω (s) and t < s. Similarly
deﬁne ≺n in terms of ωn. Note that if D is a terminal segment of ≺ then we have ν(gaD) ≥ ν(gaE) for
any E with ν(E) = ν(D). For n ∈ N write Dn for the terminal segment of ≺ such that ν(Dn) = νn(Cn)
and write En for the terminal segment of ≺n such that µ(C) = µn(En). Let also Fn be the terminal
segment of ≺ such that ν(Fn) = ν(Cn) + δ and let Kn be the terminal segment of ≺n such that
µn(Kn) = µ(Cn) + δ. Clearly Dn ⊆ Fn ⊆ C and Cn ⊆ Kn ⊆ En. We have

µ(Fn \ Dn) = µ(Fn) − µ(Dn) = δ = µn(Kn) − µn(Cn) = µn(Kn \ Cn)

and similarly

µ(C \ Fn) = µn(En \ Kn).

Note that since ω(x) > c ≥ ωn(y) if x ∈ C but y ∈ X \ Cn, (2) implies

µ (ga(C \ Fn)) ≥ µn (gan(En \ Kn)) .

(1)

(2)

(3)

Let H be the terminal segment of ≺ such that µ(H) = µ(C) − δ so that by (1) we have δ = µ(C \ H) =
µ(Fn \ Dn). Since Fn \ Dn ⊆ C and C \ H has the lowest Radon-Nikodym derivative of any subset of
C with measure δ this implies

For n ∈ N from (1), (3) and (4) we have

ν (ga(C \ H)) ≤ ν (ga(Fn \ Dn)) .

ν (ga(C \ Dn)) − ν (gan(En \ Cn))
= ν (ga(C \ Fn)) + µ (ga(Fn \ Dn)) − ν (gan (En \ Kn)) − ν (gan(Kn \ Cn))
≥ ν (ga(Fn \ Dn)) − ν (gan (Kn \ Cn)) ≥ ν (ga(Fn \ Dn)) − c · ν (Kn \ Cn)
= ν (ga(Fn \ Dn)) − cδ ≥ ν (ga(C \ H)) − cδ.

For x ∈ C we have ω(x) > c so the last quantity is strictly positive. Choose

0 < ε <

1

2(4 + M )

· (ν (ga(C \ H)) − cδ) .

(4)

(5)

(6)

Since by assumption ϕa ≤ lim inf n ϕan for any universal sentence ϕ, there exists n ∈ N with the
following property: for every Borel partition A1, . . . , Ak of X there is a partition B1, . . . , Bk of X such
that |ν(Ai) − ν(Bi)| < ε and |ν(gaAi ∩ Aj) − ν(ganBi ∩ Bj)| < ε for all i, j ∈ {1, . . . , k}. Fixing n,
write C ′ = Cn, D = Dn, E = En and <′= <n. Note that from (5) and (6) we have

Let A1 = X \ C and A2 = C. Find B1, B2 ⊆ X such that |ν(Ai) − ν(Bi)| < ε and

2(4 + M )ε < ν (ga(C \ D)) − ν (cid:0)gan (E \ C ′)(cid:1) .

(7)

for each i, j ∈ {1, 2}. Note that

|ν(gaAi ∩ Aj) − ν(gan Bi ∩ Bj)| < ε

ν (X \ (B1 ∪ B2)) ≤ 2ε.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

13

We have

Note that

ν(gaA1) = ν(gaA1 ∩ A1) + ν(gaA1 ∩ A2)

≥ ν(gan B1 ∩ B1) + ν(gan B1 ∩ B2) − 2ε
≥ ν(gan B1 ∩ B1) + ν(gan B1 ∩ B2) + ν (gan B1 \ (B1 ∪ B2)) − 4ε
≥ ν(gan B1) − 4ε.

(8)

Write L for the initial segment of <′ such that ν(L) = ν(X \ C) − ε. Note that ν(X \ E) = ν(X \ C)
and so ν (X \ (E ∪ L)) = ε. We have

ν(B1) ≥ ν(A1) − ε = ν(X \ C) − ε.

ν (gan (X \ E)) = ν(gan L) + ν (gan (X \ (E ∪ L)))

and therefore

ν(gan L) ≥ ν (gan (X \ E)) − M ε.

Since ν(B1) ≥ ν(L) and ν(gan L) ≤ ν(gan J) for any J ⊆ X with ν(J) ≥ ν(L) from (9) we see

ν(ganB1) ≥ ν (gan(X \ E)) − M ε.

From (8) we have

ν (ga(X \ C)) ≥ ν (gan (X \ E)) − (4 + M )ε.

Now write A1 = C ′ and A2 = X \ C ′. Find B1, B2 ⊆ X such that
|ν(Ai ∩ Aj) − ν(Bi ∩ Bj)| < ε

(9)

(10)

and

for each i, j ∈ {1, 2}. Arguing as before we have ν(gan A1) ≤ ν(gaB1)+4ε and ν(gaB1) ≤ ν(gaD)+M ε
so that

|ν(gan Ai ∩ Aj) − ν(gaBi ∩ Bj)| < ε

From (10) and (11) we have

ν(gan C ′) ≤ ν(gaD) + (4 + M )ε.

Note that

and

ν (ga(X \ C) ∪ D)) ≥ ν (cid:0)gan (cid:0)(X \ E) ∪ C ′(cid:1)(cid:1) − 2(4 + M )ε.

D ⊔ (C \ D) ⊔ (X \ C) = X

C ′ ⊔ (E \ C ′) ⊔ (X \ E) = X.

Thus from (7) and (12) we have

1 = ν (ga (D ∪ (X \ C))) + ν (ga(C \ D))
≥ ν (cid:0)gan (cid:0)C ′ ∪ (X \ E)(cid:1)(cid:1) − 2(4 + M )ε + ν (ga(C \ D))
> ν (cid:0)gan (cid:0)C ′ ∪ (X \ E)(cid:1)(cid:1) + ν (cid:0)gan (E \ C ′)(cid:1) = 1

which is the desired contradiction. This concludes the proof.

Theorem 4.1 implies the following:

(11)

(12)

(cid:3)

Corollary 4.2. The Furstenberg entropy of a µ-stationary action is an aﬃne continuous weak equiv-
alence invariant.

Corollary 4.2 implies, for instance, that any nontrivial boundary action is not weakly equivalent to

a measure-preserving action.

Corollary 4.3. Suppose that G has property (T). Then the set of stable weak equivalence classes of
ergodic µ-stationary actions is not dense in the compact convex set of stable weak equivalence classes
of µ-stationary actions of G.

14

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

Proof. As recalled in the introduction, it is proved in [31] that whenever G has property (T), the set of
values of the Furstenberg entropy of ergodic µ-stationary actions has a gap around 0. The conclusion
then follows from Corollary 4.2.
(cid:3)

The same conclusions of Corollary 4.3 hold more generally for any group with entropy gap, as it
is clear from the proof. Such a class of groups strictly contains the class of property (T) groups, as
remarked in [11, Proposition 7.5].

Remark 4.4. The same proof as above shows that Theorem 4.1 and Corollary 4.2 hold more generally
for any class of nonsingular actions a with the property that the Radon-Nikodym derivatives dgaν/dν
are uniformly bounded by a constant Mg depending only on g and not on a; see also Remark 2.4.

It is proved in [37, Theorem 1.8] that, in the measure preserving case, the weak equivalence class
of an action of an amenable group G is completely determined by its associated invariant random
subgroup.
In other words, the map a 7→ IRS (a) that assigns to a measure preserving action it
associated invariant random subgroup induces an aﬃne homemorphism from the compact convex set
of stable weak equivalence classes of measure preserving actions of G onto the simplex of invariant
random subgroups of G.

This is no longer true in the stationary case, since by Theorem 4.1 the distributions of the Radon-
Nikodym derivatives dgν/dν provide a stable weak equivalence invariant. It is natural to conjecture
that, for amenable groups, this is the only new piece of information needed, together with the asso-
ciated stationary random subgroup, to completely determine the stable weak equivalence class of a
given stationary action.

Problem 4.5. Suppose that G is amenable group and a, b are two µ-stationary actions of G. Assume
that SRS (a) = SRS (b) and, for any g ∈ G and c ∈ R,

µ{x : (dgaν/dν)(x) > c} = µ{x : (dgbν/dν)(x) > c}.

Does it follow that a and b are stably weakly equivalent?

4.2. Furstenberg entropy of boundary actions. A µ-stationary action of G on a probability space
(X, B, ν) is strongly approximately transitive (SAT) as deﬁned in [27] if and only if for any nonnull
p ∈ B and ε > 0 there exists g ∈ G such that ν (gp) > 1 − ε. As remarked in the introduction, it is a
consequence of [27, Proposition 2.2] together with the description of the Poisson boundary in terms of
µ-harmonic functions that a µ-stationary action of G on a probability space (X, B, ν) is a boundary
if and only if it is SAT.

In this section we use this fact to address the entropy realization problem for boundary actions.

Theorem 4.6. The set of values of the Furstenberg entropy of boundary µ-stationary actions is a
compact subset of R.

We will prove Theorem 4.6 as an application of the omitting types theorem for the logic for metric
structures, as stated in [20, Theorem 4.3]; see also [5, 18, 25]. We will ﬁrst recall some notions from
ﬁrst order logic. Fix k ∈ N and suppose that ϕi,k (x1, . . . , xk) for i ∈ N are uniformly equicontinuous
formulas. Let for every n, k ∈ N, tn,k be the set of conditions {ϕi,k (x1, . . . , xk) ≥ 2−n : i ∈ N}. Such a
set of conditions is a k-type in model-theoretic jargon, and the sequence (tn,k)n∈N is a uniform sequence
of k-types in the terminology of [20, §4]. Suppose that a is a µ-stationary action of G on (Xa, Ba, νa).
i,k (p1, . . . , pk) ≥ 2−n for
A k-tuple (p1, . . . , pk) is a realization in a of the type tn,k deﬁned above if ϕa
every i ∈ N. The action a omits the type tn,k if it contains no realization of tn,k.

Deﬁnition 4.7. A class S of µ-stationary actions of G is an omitting types class if there exist formulas
ϕi,k (x1, . . . , xk) for i, k ∈ N such that, letting tn,k = {ϕi,k (x1, . . . , xk) ≥ 2−n : i ∈ N} for every n, k ∈
N, one has that a µ-stationary action belongs to S if and only it omits the type tn,k for any n, k ∈ N.

For instance, the class of µ-stationary boundary actions is an omitting types class. Indeed ﬁx an
enumeration {gi : i ∈ N} of G. Consider the formulas ϕi (x1, . . . , xk) := max {ν (x1) , 1 − ν (gix1)} for

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

15

i, k ∈ N. It is clear that a µ-stationary action is SAT if and only if it omits the types

for every n, k ∈ N. This shows that the class of µ-stationary boundary actions is an omitting types
class.

(cid:8)ϕi,k (x1, . . . , xk) ≥ 2−n : i ∈ N(cid:9)

We now recall the statement of the omitting types theorem for uniform sequences of types from [20,
§4] in the particular case of µ-stationary actions; see also [6, 18, 25]. A theory T is a set of conditions
of the form f = r where f is a continuous weak equivalence invariant and r ∈ R. An action a satisﬁes
a condition f = r if f (a) = r, and it is satisﬁes T if it satisﬁes every condition in T .

Theorem 4.8 (Omitting types). Suppose that T is a theory and for every k ∈ N, (tn,k)n∈N is a
uniform sequence of k-ary types associated with the formulas ϕi,k (x1, . . . , xk) for i ∈ N. Suppose that
for every δ, ε > 0, ﬁnite subset F of N, and formulas ψk (x1, . . . , xℓ) for k ∈ F the following holds:
if for any µ-stationary action b of G on (Xb, Bb, νb) that satisﬁes T there exist p1, . . . , pℓ ∈ Bb such
that ψk (p1, . . . , pℓ) < ε for some k ∈ F , then there exists a µ-stationary action b of G on (Xb, Bb, νb)
that satisﬁes T and such that, for some k ∈ F and i ∈ N, there exist p1, . . . , pℓ ∈ Bb such that
ψk (p1, . . . , pℓ) < ε and ϕi,k (p1, . . . , pℓ) < δ. Then one can conclude that there exists a µ-stationary
action a on G that satisﬁes T and omits all the types tn,k for k, n ∈ N.

We now present a proof of Theorem 4.6 using the omitting types theorem as stated above. Suppose
that (an) is a sequence of µ-stationary actions. Let hµ (an) = vn, and suppose that the sequence (vn)
converges to v. Without loss of generality we can assume that v is diﬀerent from zero and from the
Furstenberg entropy of the Poisson boundary hΠ. We can also assume, after passing to a subsequence,
that the sequence (vn) is monotone. Our goal is to prove that there exists a µ-stationary boundary
action b such that hµ (b) = v.

By compactness, we can assume that the sequence (an) converges in the logic topology to a µ-
stationary action a. We also let π be the Poisson boundary action, and ι be the trivial action on the
standard probability space.

Recall that from Corollary 4.2 the Furstenberg entropy is an aﬃne continuous weak equivalence
invariant. Consider now the theory T consisting of the single condition hµ = v. We let also
ϕi,k (x1, . . . , xk) for i, k ∈ N be the formulas described above witnessing that the class of bound-
ary actions is an omitting types class. It remains to prove that the assumptions of Theorem 4.8 are
satisﬁed.

Suppose that F ⊂ N is a ﬁnite subset, ε, δ > 0, and ψm (x1, . . . , xℓ) for m ∈ F are formulas such
that for any µ-stationary action b with Furstenberg entropy v one has that there exist p1, . . . , pℓ ∈ Bb
such that ψk (p1, . . . , pℓ) < ε for some k ∈ F . We consider ﬁrst the case when the sequence (vn)
is decreasing. Set tn = 1 − v
, and bn = (1 − tn)an + tnι. Observe that hµ (bn) = v for every
vn
n ∈ N and tn → 0. Since an is a boundary action for every n ∈ N, it follow from our assumption
about the formulas ψk (p1, . . . , pℓ) that, for n ∈ N large enough, one has that the action bn has the
property that for some k ∈ F and some i ∈ N, there exist p1, . . . , pℓ ∈ Bb such that ψk (p1, . . . , pℓ) < ε
and ϕi,k (p1, . . . , pℓ) < δ. One can obtain a similar conclusion in the case when the sequence (vn)
is increasing by letting tn be v−vn
and bn = (1 − tn)an + tnπ. In either case this shows that the
hΠ−vn
assumptions of Theorem 4.8 are satisﬁed. Henceforth there exists a µ-stationary action of G with
Furstenberg entropy v.

The same argument as the one above with the extra ingredient of Corollary 3.7 proves the following

fact:

Theorem 4.9. Suppose that the Poisson boundary action of (G, µ) is free. Then the set of values of
the Furstenberg entropy on free boundary µ-stationary actions is a compact subset of R.

1. Miklos Abert and Gabor Elek, The space of actions, partition metric and combinatorial rigidity, arXiv:1108.2147

(2011).

2. Erik M. Alfsen, Compact convex sets and boundary integrals, Springer-Verlag, New York-Heidelberg, 1971.

References

16

PETER BURTON, MARTINO LUPINI, AND OMER TAMUZ

3. Uri Bader and Yehuda Shalom, Factor and normal subgroup theorems for lattices in products of groups, Inventiones

Mathematicae 163 (2006), no. 2, 415–454.

4. Bachir Bekka, Pierre de la Harpe, and Alain Valette, Kazhdan’s property (T), New Mathematical Monographs,

vol. 11, Cambridge University Press, Cambridge, 2008.

5. Ita¨ı Ben Yaacov, Alexander Berenstein, C. Ward Henson, and Alexander Usvyatsov, Model theory for metric struc-
tures, Model theory with applications to algebra and analysis. Vol. 2, London Mathematical Society Lecture Note
Series, vol. 350, Cambridge University Press, 2008, pp. 315–427.

6. Ita¨ı Ben Yaacov and Jos´e Iovino, Model theoretic forcing in analysis, Annals of Pure and Applied Logic 158 (2009),

no. 3, 163–174.

7. Alexander Berenstein and C. Ward Henson, Model

theory of probability spaces with an automorphism,

arXiv:math/0405360 (2004).

8. Jean Bourgain, Alex Furman, Elon Lindenstrauss, and Shahar Mozes, Invariant measures and stiﬀness for non-

abelian groups of toral automorphisms, Comptes Rendus Mathematique 344 (2007), no. 12, 737–742.

9.

, Stationary measures and equidistribution for orbits of nonabelian semigroups on the torus, Journal of the

American Mathematical Society 24 (2011), no. 1, 231–280.

10. Lewis Bowen, Random walks on random coset spaces with applications to Furstenberg entropy, Inventiones Mathe-

maticae 196 (2014), no. 2, 485–510.

11. Lewis Bowen, Yair Hartman, and Omer Tamuz, Generic stationary measures and actions, Transactions of the

American Mathematical Society, to appear.

12.

, Property (T) and the Furstenberg entropy of nonsingular actions, Proceedings of the American Mathematical

Society 144 (2016), no. 1, 31–39.

13. Lewis Bowen and Robin D. Tucker-Drob, The space of stable weak equivalence classes of measure-preserving actions,

preprint.

14. Peter Burton, Topology and convexity in the space of actions modulo weak equivalence, Ergodic theory and dynamical

systems, to appear.

15. Clinton T. Conley, Alexander S. Kechris, and Benjamin D. Miller, Stationary probability measures and topological

realizations, Israel Journal of Mathematics 198 (2013), no. 1, 333–345.

16. Alexandre I. Danilenko, Furstenberg entropy values for nonsingular actions of groups without property (T),

arXiv:1512.05139 (2015).

17. Richard M. Dudley, Real analysis and probability, Cambridge Studies in Advanced Mathematics, vol. 74, Cambridge

University Press, Cambridge, 2002.

18. Christopher J. Eagle, Omitting types for inﬁnitary [0, 1]-valued logic, Annals of Pure and Applied Logic 165 (2014),

no. 3, 913–932.

19. Ilijas Farah, Bradd Hart, Martino Lupini, Leonel Robert, Aaron Tikuisis, Alessandro Vignati, and Winter Winter,

The Model Theory of Nuclear C∗-algebras, arXiv:1602.08072 (2016).

20. Ilijas Farah and Menachem Magidor, Omitting types in logic of metric structures, arXiv:1411.2987 (2014).
21. Harry Furstenberg, Noncommuting random products, Transactions of the American Mathematical Society 108 (1963),

377–428.

22.

, Random walks and discrete subgroups of Lie groups, Advances in Probability and Related Topics, Vol. 1,

Dekker, New York, 1971, pp. 1–63.

23. Hillel Furstenberg and Eli Glasner, Stationary dynamical systems, Dynamical numbersinterplay between dynamical

systems and number theory, Contemp. Math., vol. 532, Amer. Math. Soc., Providence, RI, 2010, pp. 1–28.

24. Eli Glasner and Benjamin Weiss, Uniformly recurrent subgroups, Recent trends in ergodic theory and dynamical

systems, Contemp. Math., vol. 631, Amer. Math. Soc., Providence, RI, 2015, pp. 63–75.

25. Isaac Goldbring and Thomas Sinclair, On Kirchberg’s embedding problem, Journal of Functional Analysis 269 (2015),

no. 1, 155–198.

26. Yair Hartman and Omer Tamuz, Furstenberg entropy realizations for virtually free groups and lamplighter groups,

Journal d’Analyse Mathmatique 126 (2015), no. 1, 227–257.

27. Wojciech Jaworski, Strongly approximately transitive group actions, the Choquet-Deny theorem, and polynomial

growth, Paciﬁc Journal of Mathematics 165 (1994), no. 1, 115–129.

28. Vadim A. Kaimanovich and Anatoly M. Vershik, Random walks on discrete groups: boundary and entropy, Ann.

Probab. 11 (1983), no. 3, 457–490.

29. Alexander S. Kechris, Global aspects of ergodic group actions, Mathematical Surveys and Monographs, vol. 160,

American Mathematical Society, Providence, RI, 2010.

30. George W. Mackey, Point realizations of transformation groups, Illinois Journal of Mathematics 6 (1962), no. 2,

327–335.

31. Amos Nevo, The spectral theory of amenable actions and invariants of discrete groups, Geometriae Dedicata 100

(2003), 187–218.

32. Amos Nevo and Robert J. Zimmer, Rigidity of Furstenberg entropy for semisimple Lie group actions, Annales

Scientiﬁques de l’´Ecole Normale Sup´erieure. Quatri`eme S´erie 33 (2000), no. 3, 321–343.

WEAK EQUIVALENCE OF STATIONARY ACTIONS AND THE ENTROPY REALIZATION PROBLEM

17

33.

, A structure theorem for actions of semisimple Lie groups, Annals of Mathematics. Second Series 156 (2002),

no. 2, 565–594.

34. Donald S. Ornstein and Benjamin Weiss, Ergodic theory of amenable group actions. I. The Rohlin lemma, American

Mathematical Society. Bulletin. New Series 2 (1980), no. 1, 161–164.

35. Arlan Ramsay, Virtual groups and group actions, Advances in Mathematics 6 (1971), no. 3, 253–322.
36. Joseph Rosenblatt, Ergodic and mixing random walks on locally compact groups, Mathematische Annalen 257 (1981),

no. 1, 31–42.

37. Robin D. Tucker-Drob, Weak equivalence and non-classiﬁability of measure preserving actions, Ergodic Theory and

Dynamical Systems 35 (2015), no. 1, 293–336.

Mathematics Department, California Institute of Technology, 1200 E. California Blvd, MC 253-37,

Pasadena, CA 91125

E-mail address: pjburton@caltech.edu
URL: http://math.caltech.edu/~pjburton/index1.html

Mathematics Department, California Institute of Technology, 1200 E. California Blvd, MC 253-37,

Pasadena, CA 91125

E-mail address: lupini@caltech.edu
URL: http://www.lupini.org/

Economics and Mathematics Departments, California Institute of Technology, 1200 E. California

Blvd, MC 253-37, Pasadena, CA 91125

E-mail address: omertamuz@gmail.com
URL: http://people.hss.caltech.edu/~tamuz/

