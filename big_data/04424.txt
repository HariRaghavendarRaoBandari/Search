Fast and High-Fidelity Entangling Gate through Parametrically Modulated

Longitudinal Coupling

Baptiste Royer,1 Arne L. Grimsmo,1 Nicolas Didier,2 and Alexandre Blais1, 3

1Institut quantique and D´epartment de Physique, Universit´e de Sherbrooke,

2500 boulevard de l’Universit´e, Sherbrooke, Qu´ebec J1K 2R1, Canada

2Centre de Recherche Inria de Paris, 2 rue Simone Iﬀ, 75012 Paris, France

3Canadian Institute for Advanced Research, Toronto, Canada

6
1
0
2

 
r
a

 

M
4
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
4
2
4
4
0

.

3
0
6
1
:
v
i
X
r
a

We present an approach to universal quantum computation based on the modulation of a longi-
tudinal qubit-oscillator coupling. We show how to realize a controlled-phase gate by simultaneously
modulating the coupling of two qubits to a common oscillator mode. In contrast to the situation
with the more familiar transversal qubit-oscillator coupling, the magnitude of the eﬀective qubit-
qubit interaction here does not rely on a small perturbative parameter. As a result, this eﬀective
interaction strength can be made large, leading to short gate times and high gate ﬁdelities. We
moreover show how the gate ﬁdelity can be exponentially improved with single-mode squeezing and
how the entangling gate can be generalized to qubits coupled to separate oscillators.

Introduction.—A widespread strategy for quantum in-
formation processing is to couple the dipole moment of
multiple qubits to common oscillator modes, the lat-
ter being used to measure the qubits and to mediate
long-range qubit-qubit interactions. Realizations of this
idea are found in Rydberg atoms [1], superconducting
qubits [2] and quantum dots [3] amongst others. With the
dipole moment operator being oﬀ-diagonal in the qubit
logical basis, this type of transversal qubit-oscillator cou-
pling leads to hybridization of the qubit and oscillator
degrees of freedom. In turn, this results in qubit Purcell
decay [4] and to qubit readout that is not truly quantum
nondemolition (QND) [5]. To minimize these problems,
the qubits can be operated at frequency detunings from
the oscillator that are large with respect to the transverse
coupling strength gx. This interaction then only acts per-
turbatively, taking a dispersive character [1]. While it
has advantages, this perturbative character also results
in slow oscillator-mediated qubit entangling gates [6, 7].
Rather than relying on the standard transversal cou-
pling, Hx = gx(ˆa† + ˆa)ˆσx, an alternative approach is to
use a longitudinal interaction, Hz = gz(ˆa† + ˆa)ˆσz [8–13].
Since Hz commutes with the qubit’s bare Hamiltonian
the qubit is not dressed by the oscillator. Purcell decay
is therefore absent [9, 10] and qubit readout is truly quan-
tum non-demolition (QND) [12]. The absence of qubit
dressing also allows for scaling up to a lattice of arbitrary
size with strictly local interactions [10].

By itself, longitudinal interaction however only leads to
a vanishingly small qubit state-dependent displacement
of the oscillator ﬁeld of amplitude gz/ωr (cid:28) 1 with ωr
the oscillator frequency. In Ref. [12], it was shown that
modulating gz at the oscillator frequency ωr activates
this interaction leading to a large qubit state-dependent
oscillator displacement and to fast QND qubit readout.
In this Letter, we show how the same approach can be
used for universal quantum computing by introducing a
fast and high-ﬁdelity controlled-phase gate based on lon-
gitudinal coupling. This logical operation relies on para-

metric modulation of the longitudinal qubit-oscillator
coupling, inducing an eﬀective ˆσz ˆσz interaction between
qubits coupled to the same mode.
In contrast to two-
qubit gates based on the transversal interaction [6, 7],
this proposal does not rely on strong qubit-oscillator de-
tuning and is not based on a perturbative argument. As
a result, the longitudinally mediated ˆσz ˆσz interaction is
valid for all qubit, oscillator and modulation parameters
and does not result in unwanted residual terms in the
Hamiltonian. For this reason, there are no fundamen-
tal bound on gate inﬁdelity or gate time and both can,
in principle, be made arbitrarily small simultaneously.
This is veriﬁed with numerical calculations.

Similarly to other oscillator-mediated gates, photon
loss from the oscillator during the gate however leads
to gate inﬁdelity. This can be minimized by working
with high-Q oscillators. This, however, is in contradic-
tion with the requirements for fast qubit readout [2]. We
solve this dilemma by exploiting quantum bath engineer-
ing, using broadband single-mode squeezing at the oscil-
lator output. By appropriately choosing the squeezed
quadrature, we show how ‘which-qubit-state’ informa-
tion carried by the photons leaving the oscillator can be
erased. This leads to exponential improvement in gate
ﬁdelity with squeezing strength.

While this scheme is very general, we focus here on
a possible realization using superconducting transmon
qubits [14] longitudinally coupled to a common LC os-
cillator. Inspired by recent work [10, 13] we also consider
the situation where the qubits are coupled to distinct,
but interacting, oscillators. Advantages of the latter im-
plementation for scaling up are discussed.

Oscillator mediated qubit-qubit interaction.—Following
Ref. [12], we consider two qubits coupled to a single har-
monic oscillator mode via their ˆσz degree of freedom.
Allowing for time dependence of the coupling, the Hamil-

tonian reads ( = 1)

2

ˆH(t) = ωrˆa†ˆa + 1

2 ωa1 ˆσz1 + 1

2 ωa2 ˆσz2

+ g1(t)ˆσz1 (ˆa† + ˆa) + g2(t)ˆσz2 (ˆa† + ˆa).

(1)

In this expression, ωr and ωai are the frequencies of the
oscillator and of the ith qubit, respectively, while gi(t)
are the corresponding longitudinal coupling strengths.

In the absence of external drives or of modulation of
the coupling, the longitudinal interaction only leads to a
vanishingly small displacement of the oscillator ﬁeld and
can safely be dropped. This interaction can be rendered
resonant by modulating gi(t) at the oscillator frequency
leading to a large qubit-state dependent displacement of
the oscillator state. Measurement of the oscillator state
by homodyne detection can then be used for fast QND
qubit readout [12]. Consequently, modulating the cou-
pling at the oscillator frequency rapidly dephases the
qubits. To keep dephasing to a minimum, we instead
use an oﬀ-resonant modulation of gi(t) at a frequency
ωm detuned from ωr by many oscillator linewidths κ:
g1(t) = g1 cos(ωmt), g2(t) = g2 cos(ωmt + φ) where g1,2
are constant real amplitudes.

How the oscillator mediates a qubit-qubit interaction
can be made more apparent by moving to a rotating
frame and applying the polaron transformation ˆU (t) =

exp[(cid:80)i=1,2 αi(t)ˆσziˆa† − H.c.] with an appropriate choice

of αi(t) [15]. Doing this, we ﬁnd the simple eﬀective
Hamiltonian

ˆHpol = δˆa†ˆa + Jz(t)ˆσz1 ˆσz2,

(2)

with δ ≡ ωr − ωm and where the ˆσz ˆσz-coupling strength
is given by

Jz(t) =

g1g2

2 (cid:20) 1

δ

+

1

ωr + ωm(cid:21) [cos φ+ cos(2ωmt−φ)] . (3)

The above expressions are exact. Assuming that
the modulation frequency is chosen to be suﬃciently
large, we can however safely neglect the fast-rotating
cosine term. To simplify the discussion, we therefore
drop the time-dependence in Jz(t). By turning on the
coupling modulation for a time tg = θ/4|Jz|, evolu-
tion under Eq. (2) followed by single qubit Z-rotations
leads to the entangling controlled-phase gate UCP (θ) =
diag[1, 1, 1, eiθ]. Since UCP (π) together with single qubit
rotations forms a universal set [16], we consider this gate
from now on.

The above situation superﬁcially looks similar to pro-
posals for controlled-phase gates based on transversal
coupling and strong oscillator driving [6, 17, 18]. There
are however several key diﬀerences. With transversal
coupling, the ˆσz ˆσz interaction is the result of a fourth
order process and the gate is correspondingly slow. More-
over, this interaction is derived using perturbation theory
and is only approximately valid for small gx/{∆, δd} with

FIG. 1. (a) Schematic illustration of the qubit-state depen-
dent oscillator state in phase space for g1 = g2 and φ = 0. (b)
Single-mode squeezing can help in erasing the which-qubit-
state information.

∆ the qubit-oscillator detuning and δd the oscillator-drive
detuning. For the same reason, it is also only valid for
small photon numbers n (cid:28) ncrit = ∆2/4g2
x. As a re-
sult, decreasing the detunings or increasing the oscillator
drive amplitude in an attempt to speed up the gate leads
to low gate ﬁdelities [7]. In contrast, with longitudinal
coupling, the ˆσz ˆσz interaction is interestingly the result
of a process that is only second-order. In addition, since
Eq. (2) is obtained after exact transformations on the
system Hamiltonian, it is valid for any value of g1,2/δ
and is independent of the oscillator photon number and
qubit frequencies. As will become clear later, this im-
plies that the gate time and inﬁdelity can be decreased
simultaneously.

Oscillator-induced qubit dephasing.—Fig. 1 illustrates,
for g1 = g2, the mechanism responsible for the qubit-
qubit interaction. Under longitudinal coupling, the oscil-
lator state is displaced in a qubit-state dependent direc-
tion. This conditional displacement leads to a non-trivial
phase accumulation on the qubits. The schematic illus-
tration of Fig. 1 also emphasizes the main cause of gate
inﬁdelity for this type of controlled-phase gate, irrespec-
tive of its longitudinal or transversal nature: Photons
leaking out from the oscillator during the gate carry in-
formation about the qubit state, leading to qubit dephas-
ing.

A quantitative understanding of the gate inﬁdelity un-
der photon loss can be obtained by deriving a master
equation for the joint qubit-oscillator system. While gen-
eral expressions are given in Ref. [15], to simplify the dis-
cussion we assume here that g1 = g2 ≡ g. Following the
standard approach [19], the Lindblad master equation in
the rotating polaron frame reads [15]:

˙ρ(t) = − i[ ˆHpol, ρ(t)] + κrD[ˆa]ρ(t)

2δ(cid:17)2
+ κm(cid:16) g

D[ˆσz1 + eiφ ˆσz2]ρ(t),

(4)

where κr = κ(ωr) and κm = κ(ωm) are the dissipa-
tion rates of the oscillator evaluated at frequencies ωr
and ωm, respectively. D[x] denotes the usual dissipa-
tion super-operator D[x]• = x • x† − 1
2{x†x,•}. The
term proportional to κr in Eq. (4) corresponds to loss
of oscillator photons and contributes to gate inﬁdelity if

3

on detuning δ and coupling strength g as obtained from
numerical
integration of a master equation with the
Hamiltonian of Eq. (1) under rotating-wave approxima-
tion (RWA) and oscillator damping [15]. Both the ex-
pected increase in ﬁdelity (full lines) and the longer gate
times (dashed lines) with increasing detuning δ are ap-
parent in panel (a). In addition, panel (b) conﬁrms that,
to a very good approximation, the ﬁdelity is independent
of g (full lines) while the gate time decreases as tg ∼ 1/g2
(dashed lines).
The parametric modulation, detuned by δ from the
oscillator frequency, results in a small oscillator popula-
tion whose amplitude is oscillating at frequency δ. To
maximize the gate ﬁdelity, we have chosen in the above
numerical simulations the gate time tg such that the os-
cillator is empty and unentangled with the qubits after
tg. One strategy to achieve this is to perform the gate
adiabatically. A more advantageous strategy is however
to choose tg and the modulation frequency ωm such that
tgδ = 2πn, with n a non-zero integer. This corresponds
to an integer number of oscillations in tg, leaving the os-
cillator in its initial unentangled state at the end of the
gate (chosen to be the vacuum state in our simulations).
While this proposal applies to a wide range of physical
implementations, here and below we focus on a realiza-
tion with superconducting qubits. The parameters used
in Fig. 2 have been chosen accordingly.
In particular
taking κ/2π = 0.01 MHz [22], g/2π = 60 MHz [12] and
δ/2π = 537 MHz results in a very short gate time of tg =
37 ns with an average gate inﬁdelity as small as 2 ×10−5.
Taking into account ﬁnite qubit lifetimes T1 = 40 µs and
T2 = 20 µs [23], we ﬁnd that the inﬁdelity is increased to
∼ 10−3 [15]. In other words, the gate ﬁdelity is limited
by the qubit’s natural decoherence channels with these
parameters.

Improved ﬁdelity with single-mode squeezing—As dis-
cussed above, for ﬁxed g and δ the ﬁdelity increases with
decreasing κr,m. A small oscillator decay rate κr how-
ever comes at the price of longer measurement time if the
same oscillator is used to mediate gates and for longitu-
dinal parametric readout [12]. As we now show, by ﬁlter-
ing and by exploiting a broadband source of single-mode
squeezed radiation these contradictory requirements can
be reconciled and the gate performance improved with-
out reducing κr.

First, the dephasing rate Γm ∝ κm can be reduced by
placing a ﬁlter at the modulation frequency at the output
port of the oscillator. This lowers the density of modes
at that frequency and hence reduce κm. Filters of this
type are routinely used experimentally to reduce Purcell
decay of superconducting qubits [24, 25].

This approach however cannot be exploited to reduce
Γr ∝ κr if the oscillator is also used for qubit readout.
This problem can be solved by sending squeezed radia-
tion to the oscillator’s readout port. As schematically
illustrated in Fig. 1, by orienting the squeezing axis with

FIG. 2. Average gate inﬁdelity 1 − F (full line) and gate
time (dashed lines) of UCP (π) as a function of (a) detuning,
(b) coupling strength and (c) squeezing power. In panel (a)
−3 is ﬁxed at 2 (blue), 3 (green), 4 (orange). Note that
g/κ×10
the corresponding three inﬁdelity curves are indistinguishable
−5 is ﬁxed at 0.75 (blue), 1
on this scale. In panel (b) δ/κ× 10
(green), 1.25 (orange). We use κr = κm ≡ κ for simplicity. In
panel (c) parameters are δ/2π = 0.6 GHz, g/2π = 60 MHz,
tg = 42.7 ns, κr/2π = 1 MHz. In orange, broadband single
mode squeezing at ωr and ωm. In green, squeezing at ωr and
κm = 0, simulating a ﬁlter reducing the density of modes to
zero at ωm. In blue, squeezing at ωr and κm/2π = 1 MHz.

the state of the oscillator is entangled with the qubits.
Although ˆHpol does not lead to qubit-oscillator entan-
glement, it is important to realize that an unentangled
qubit-oscillator state in the laboratory frame is entan-
gled in the polaron frame with a reduced oscillator state
taking the form depicted in Fig. 1.
In this situation,
photon loss causes qubit dephasing at a rate that is in-
creasing with the distance between the qubit-dependent
coherent states of the oscillator. More precisely, with the
amplitude of the oscillator displacement being g/2δ, the
eﬀective dephasing rate is Γr ∼ κr(g/2δ)2. Note that
this dephasing rate remains unchanged if the oscillator
is initially in a coherent state. As a result, there is no
need for the oscillator to be empty at the start of the
gate. Similarly, the term in Eq. (4) proportional to κm
describes loss of photons at the modulation frequency
ωm and constitutes another dephasing channel with the
associated rate Γm = κm(g/2δ)2.

Based on these two rates and on the gate time tg, a
simple estimate for the scaling of the gate inﬁdelity is
1 − F ∼ Γ × tg ∼ (κr + κm)/δ, where Γ = Γr + Γm is
the total dephasing rate [20]. A key observation is that
this gate error is independent of g, while the gate time
scales as tg ∼ δ/g2. Both the gate time and the error can
therefore, in principle, be made arbitrarily small simul-
taneously. This scaling of the gate error and gate time is
conﬁrmed by numerical simulations below.

Fig. 2 shows the dependence of the gate inﬁdelity [21]

0.81.21.622.42.80.81.2(1−F)×105δ/κ×10−5(a)23450.0000.0050.0100.0150.020κtgg/κ×10−3(b)10−610−410−20510151−FSqueezingPower[dB](c)the direction of the qubit-dependent displacement of the
oscillator state, the information carried by the photons
leaving the oscillator can be erased. For this to be possi-
ble, the phase diﬀerence φ between the qubit’s parametric
modulations must be φ = {0, π}, such that the possible
oscillator states are aligned. These two phases leave the
possibility to choose between ferromagnetic and antifer-
romagnetic qubit-qubit coupling. By using a broadband
source of single-mode squeezing covering both ωr and ωm,
or alternatively two sources respectively centered at ωr
and ωm, we ﬁnd that the total dephasing rate is expo-
nentially reduced [15]

Γ(r) ∼ e−2rΓ(0),

(5)

with r the squeezing parameter. This reduction in de-
phasing rate leads to the exponential improvement in
gate ﬁdelity with squeezing power illustrated by the or-
ange line in Fig. 2(c). Adding a ﬁlter at ωm leads to a
small additional improvement (green line) while narrow-
band squeezing at ωr only leads to minor increase of the
ﬁdelity as discussed above (blue line).

Interestingly, rotating the squeezing axis by π/2 helps
in distinguishing the diﬀerent oscillator states and has
been shown to lead to an exponential increase in the
signal-to-noise ratio for qubit readout [12]. In practice,
the diﬀerence between performing a two-qubit gate and
a measurement is thus the parametric modulation fre-
quency (oﬀ-resonant for the gate and on resonance for
measurement) and the choice of squeezing axis.

The use of squeezing to improve two-qubit gate ﬁdeli-
ties has recently been proposed in the context of transver-
sal coupling [18]. In this situation, however, transversal
coupling leads to a complex path of the oscillator states
in phase space, something that limits the possible ﬁdelity
improvement. The simplicity of the qubit-oscillator dy-
namics under longitudinal coupling is therefore an impor-
tant advantage, leading to both exponential improvement
in readout SNR [12] and in gate ﬁdelity.

Circuit QED implementation.—Although this pro-
posal is applicable to a wide variety of physical systems,
we consider as a concrete example the circuit illustrated
in Fig. 3. This circuit QED realization with transmon
qubits [14] is an extension to two-qubits of the circuit in-
troduced in [12]. Following closely Ref. [12], modulation
of the ﬂuxes Φ1,2 leads to the desired modulation of the
longitudinal coupling in addition to a small renormaliza-
tion of the qubits frequencies [15]. Independent control
of the couplings can be used for individual qubit readout
while single-qubit rotations can be realized by driving
a weakly coupled voltage gate (not shown). A detailed
derivation of the Hamiltonian of this circuit can be found
in Ref. [15].

So far we have focused on two qubits coupled to a single
common oscillator. As shown by Billangeon et al. [10],
longitudinal coupling of several qubits to separate oscil-
lators that are themselves coupled transversely has very

4

FIG. 3. Circuit QED implementation of longitudinal interac-
tion with two qubits coupled to a common LC oscillator. The
oscillator is shown in blue and the qubits in green and brown.
Further details on the mapping of this circuit to Eq. (1) can
be found in Ref. [15].

favorable scaling properties. This idea was further devel-
oped by Richer et al. [13], where circuits implementing
this idea were proposed.
Interestingly, the gate intro-
duced in this Letter can also be implemented in such
an architecture. Consider two qubits interacting with
distinct, but coupled, oscillators with the corresponding
Hamiltonian [10]

ˆHab = ωaˆa†ˆa + ωbˆb†ˆb + 1

2 ωa1 ˆσz1 + 1

2 ωa2 ˆσz2

+ g1(t)ˆσz1 (ˆa† + ˆa) + g2(t)ˆσz2 (ˆb† + ˆb)
− gab(ˆa† − ˆa)(ˆb† − ˆb).

(6)

In this expression, ˆa, ˆb label the mode of each oscillator
of respective frequencies ωa,b, and gab is the oscillator-
oscillator coupling. As above, g1,2(t) are modulated at
the same frequency ωm, corresponding to the detunings
δa ≡ ωa − ωm and δb ≡ ωb − ωm. Following the same
procedure as before but performing a RWA for simplicity,
we ﬁnd a Hamiltonian in a rotating polaron frame of the
same form as Eq. (2), but now with a modiﬁed ˆσz ˆσz-
interaction strength [15]

Jz =

1
2

g1g2gab

¯δ2 − g2

ab(1 + ζ 2)

cos φ,

(7)

where ¯δ = (δa + δb)/2 and ζ = (ωb − ωa)/(2gab). For
oscillators of equal frequencies, this reduces to Jz =
g1g2gab cos(φ)/2(δ2 − g2
ab). This variation allows for a
modular architecture, where each unit cell is composed
of a qubit and coupling oscillators, used for both read-
out and entangling gates. This type of modular ap-
proaches relaxes design constraints and avoids spurious
interactions while maintaining minimal circuit complex-
ity [10, 13, 26].

Conclusion.—We have proposed a controlled-phase
gate based on longitudinal coupling of two qubits to

5

2000).

[17] A. W. Cross and J. M. Gambetta, Phys. Rev. A 91,

032325 (2015).

[18] S. Puri and A. Blais, arXiv:1601.03275.
[19] C. Gardiner and P. Zoller, Quantum Noise: A Handbook
of Markovian and Non-Markovian Quantum Stochastic
Methods with Applications to Quantum Optics, Springer
Series in Synergetics (Springer, 2004).

decay, excluding the qubits natural T1 and T2 times.

[20] Note that 1 − F refers only to the error due to photon
[21] M. A. Nielsen, Physics Letters A 303, 249 (2002).
[22] A. Bruno, G. de Lange, S. Asaad, K. L. van der Enden,
N. K. Langford, and L. DiCarlo, Applied Physics Letters
106, 182601 (2015).

[23] R. Barends,

J. Kelly, A. Megrant, A. Veitia,
D. Sank, E. Jeﬀrey, T. C. White, J. Mutus, A. G.
Fowler, B. Campbell, Y. Chen, Z. Chen, B. Chiaro,
A. Dunsworth, C. Neill, P. O’Malley, P. Roushan,
A. Vainsencher, J. Wenner, A. N. Korotkov, A. N. Cle-
land, and J. M. Martinis, Nature 508, 500 (2014).

[24] M. D. Reed, B. R. Johnson, A. A. Houck, L. DiCarlo,
and R. J.
J. M. Chow, D. I. Schuster, L. Frunzio,
Schoelkopf, Applied Physics Letters 96, 203110 (2010).
[25] N. T. Bronn, Y. Liu, J. B. Hertzberg, A. D. C´orcoles,
A. A. Houck, J. M. Gambetta, and J. M. Chow, Appl.
Phys. Lett. 107 (2015).

[26] T. Brecht, W. Pfaﬀ, C. Wang, Y. Chu, L. Frunzio, M. H.
Devoret, and R. J. Schoelkopf, Npj Quantum Informa-
tion 2, 16002 EP (2016).

[27] P. Billangeon and Y. Nakamura, In preparation.
[28] M. H. Devoret, Quantum ﬂuctuations in electrical cir-
cuits, Les Houches Session LXIII, Quantum Fluctuations
p. 351-386 (1995).

[29] C. J. Wood, J. D. Biamonte, and D. G. Cory, Quantum

Information & Computation 15 (2015).

[30] J. Johansson, P. Nation, and F. Nori, Computer Physics

Communications 184, 1234 (2013).

a common oscillator mode. The key to activating the
qubit-qubit interaction is a parametric modulation of the
qubit-oscillator coupling at a frequency far detuned from
the oscillator. The gate inﬁdelity and gate time can
be made arbitrarily small simultaneously, in stark con-
trast to the situation with transversal coupling. We have
also shown how the gate ﬁdelity can be exponentially in-
creased using single-mode squeezing. Together with the
fast, QND and high-ﬁdelity measurement scheme pre-
sented in Ref. [12], these results show that it is possible
to realize universal quantum computation with paramet-
ric modulation of longitudinal coupling between qubits
and oscillators.

Note added. After completing this work, we became
aware of similar results by P. Billangeon and Y. Naka-
mura [27].

Acknowledgements.—We thank J. Bourassa and S.
Puri for useful discussions. This work was supported by
the Army Research Oﬃce under Grant No. W911NF-14-
1-0078 and NSERC.

[1] S. Haroche and J.-M. Raimond, Exploring the Quantum:
Atoms, Cavities, and Photons (Oxford University Press,
Oxford, 2006).

[2] A. Blais, R.-S. Huang, A. Wallraﬀ, S. M. Girvin, and

R. J. Schoelkopf, Phys. Rev. A 69, 062320 (2004).

[3] A. Imamoglu, D. D. Awschalom, G. Burkard, D. P. Di-
Vincenzo, D. Loss, M. Sherwin, and A. Small, Phys.
Rev. Lett. 83, 4204 (1999).

[4] A. A. Houck, J. A. Schreier, B. R. Johnson, J. M. Chow,
J. Koch, J. M. Gambetta, D. I. Schuster, L. Frunzio,
M. H. Devoret, S. M. Girvin, and R. J. Schoelkopf, Phys.
Rev. Lett. 101, 080502 (2008).

[5] M. Boissonneault, J. M. Gambetta, and A. Blais, Phys.

Rev. A 79, 013819 (2009).

[6] A. Blais, J. Gambetta, A. Wallraﬀ, D. I. Schuster, S. M.
Girvin, M. H. Devoret, and R. J. Schoelkopf, Phys. Rev.
A 75, 032329 (2007).

[7] J. M. Chow, J. M. Gambetta, A. W. Cross, S. T. Merkel,
C. Rigetti, and M. Steﬀen, New Journal of Physics 15,
115012 (2013).

[8] A. J. Kerman and W. D. Oliver, Phys. Rev. Lett. 101,

070501 (2008).

[9] A. J. Kerman, New Journal of Physics 15, 123011 (2013).
[10] P.-M. Billangeon, J. S. Tsai, and Y. Nakamura, Phys.

Rev. B 91, 094517 (2015).

[11] P.-M. Billangeon, J. S. Tsai, and Y. Nakamura, Phys.

Rev. B 92, 020509 (2015).

[12] N. Didier, J. Bourassa, and A. Blais, Phys. Rev. Lett.

115, 203601 (2015).

[13] S. Richer and D. DiVincenzo, arXiv:1511.06138.
[14] J. Koch, T. M. Yu, J. Gambetta, A. A. Houck, D. I.
Schuster, J. Majer, A. Blais, M. H. Devoret, S. M. Girvin,
and R. J. Schoelkopf, Phys. Rev. A 76, 042319 (2007).

[15] See Supplemental Material, which includes [28–30].
[16] M. Nielsen and I. Chuang, Quantum Computation and
Quantum Information, Cambridge Series on Information
and the Natural Sciences (Cambridge University Press,

SupplementalMaterialfor“FastandHigh-FidelityEntanglingGatethroughParametricallyModulatedLongitudinalCoupling”BaptisteRoyer,1ArneL.Grimsmo,1NicolasDidier,2andAlexandreBlais1,31D´epartmentdePhysique,Universit´edeSherbrooke,2500boulevarddel’Universit´e,Sherbrooke,Qu´ebecJ1K2R1,Canada2CentredeRechercheInriadeParis,2rueSimoneIﬀ,75012Paris,France3CanadianInstituteforAdvancedResearch,Toronto,Canada(Dated:March14,2016)Thissupplementalmaterialisorganizedasfollows:InSect.Iwederivethegeneralmasterequationfortwoqubitscoupledtoasingleoscillatorthatisitselfcoupledtoanexternalbath.Wethenusethisresulttostudythreeinterestingcases:astandardbathatzerotemperature,abaththatissqueezedatthemodulationfrequencyandabaththatissqueezedattheresonatorfrequency.InSect.IIwegivedetailsforapossiblecircuitQEDrealizationofthescheme.InSect.IIIweshowhowthegatecanberealizedforqubitsthatareinseparate,butcoupled,oscillators.Finally,inSect.IVwegivemoredetailsaboutthenumericalsimulations.I.DERIVATIONOFTHEMASTEREQUATIONInthissection,wefollowtheprocedureoutlinedinthemainLetter,takingdampingoftheresonatorintoaccount.WestartwiththefullHamiltonianwithtwoqubits,aresonatorandabathcoupledtotheresonator(=1),ˆH=ˆH0+ˆHqr+ˆHrf,(S1)ˆH0=ωrˆa†ˆa+12ωa1ˆσz1+12ωa2ω(2)qˆσz2+Z∞0dωωˆb†ωˆbω,(S2)ˆHqr=g1(t)ˆσz1(ˆa†+ˆa)+g2(t)ˆσz2(ˆa†+ˆa),(S3)ˆHrf=Z∞0dω√2πpκ(ω)(ˆa+ˆa†)(ˆbω+ˆb†ω),(S4)whereˆHqristhequbit-resonatorcouplingHamiltonianandˆHrfistheresonator-bathcouplingHamiltonian.ˆbω(ˆb†ω)isabathmodeannihilation(creation)operator,satisfyingthecommutationrelation[ˆbω,ˆb†ω0]=δ(ω−ω0),andκ(ω)isthedampingrateoftheresonatoratfrequencyω.FollowingtheapproachoutlinedintheLetter,weﬁrstgotoaframerotatingatωmfortheresonator,ωaifortherespectivequbitsandωforthebathoperators.ThisisdonebyapplyingtheunitarytransformationˆUR=exp(cid:26)−it(cid:20)12ωa1ˆσz1+12ωa2ˆσz2+ωmˆa†ˆa+Z∞0dωωˆb†ωˆbω(cid:21)(cid:27).(S5)Assumingtheformg1(t)=g1cos(ωmt),g2(t)=g2cos(ωmt+φ)forthequbit-resonatorcouplingsleadstoˆHR=δˆa†ˆa+12(g1ˆσz1+g2eiφˆσz2)ˆa†+12(g1ˆσz1+g2e−iφˆσz2)ˆa+e2iωmt2(g1ˆσz1+g2e−iφˆσz2)ˆa†+e−2iωmt2(g1ˆσz1+g2eiφˆσz2)ˆa+Z∞0dω√2πpκ(ω)(ˆae−iωmt+ˆa†eiωmt)(ˆbωe−iωt+ˆb†ωeiωt),(S6)withthedetuningδ=ωr−ωm.WenextperformthepolarontransformationdeﬁnedbyˆU(t)=exp(cid:2)(α1ˆσz1+α2ˆσz2)ˆa†−(α∗1ˆσz1+α∗2ˆσz2)ˆa(cid:3),(S7)withα1(t)=−g1δ−g1e2iωmtωr+ωm,(S8)α2(t)=−g2eiφδ−g2e−iφ+2iωmtωr+ωm,(S9)2FIG.S1.Phasespaceillustrationofthequbit-dependentresonatorstate.(a)φ=0.(b)φ=π/2.Inthatcasethereisnoˆσzˆσz-couplingbecausealltheblobshavethesamenumberofphotons.(c)φ=0butg16=g2.Equalcouplingforthetwoqubitsisnotarequirement,becauseforallg1,g2valuesthedisplacementofthe|01i(|00i)statehasthesameamplitudeasthedisplacementofthe|10i(|11i)state(d)Squeezingerasesthephaseinformationofthequbitsintheresonatorforasqueezingangleθ=π/2.(e)Dephasingismaximalforθ=0becauseitiseasierfortheenvironmenttodistinguishbetweenthestates.leadingtothetransformedHamiltonianˆHpol=ˆU†ˆHRˆU−iˆU†˙ˆU=δˆa†ˆa+Jz(t)ˆσz1ˆσz2+Z∞0dω√2πpκ(ω)(ˆae−iωmt+ˆa†eiωmt)(ˆbωe−iωt+ˆb†ωeiωt)+Z∞0dω√2πpκ(ω)(ˆOe−iωmt+ˆO†eiωmt)(ˆbωe−iωt+ˆb†ωeiωt).(S10)Tosimplifyexpressions,wehavedeﬁnedthecouplingoperatorˆO≡12δ(g1ˆσz1+g2e−iφˆσz2)andthequbit-qubitcouplingstrengthJz(t)=g1g22(cid:18)1δ+1ωr+ωm(cid:19)[cosφ+cos(2ωmt−φ)].(S11)Itisimportanttonotethat,uptothispoint,alltransformationshavebeenperformedexactly.TosimplifythediscussionwenowneglectthefastrotatingcosinetermintheaboveexpressionwhichwethereforeapproximatetoJz=g1g22(cid:18)1δ+1ωr+ωm(cid:19)cosφ.(S12)Inpractice,theneglectedcosinetermisverysmallathighmodulationfrequencies.Innumericalsimulations,weﬁndthatitissafetodropthistermwhentargetingagateinﬁdelityof∼10−5withtypicalparametersforcouplingstrengthsg1,2/2πofafewtensofMHzandamodulationfrequencyofseveralGHz.ToderivetheLindbladMasterequation,weﬁrsttransformtotheinteractionpicturewiththeunitarytransformationˆUI=exp(cid:8)−it(cid:2)δa†a+Jzˆσz1ˆσz2(cid:3)(cid:9),(S13)leadingtoˆHIpol=Z∞0dω√2πpκ(ω)(ˆae−iωrt+ˆa†eiωrt)(ˆbωe−iωt+ˆb†ωeiωt)+Z∞0dω√2πpκ(ω)(ˆOe−iωmt+ˆO†eiωmt)(ˆbωe−iωt+ˆb†ωeiωt).(S14)ThisexpressioncanbesimpliﬁedbydeﬁningˆB(t)≡R∞0dω(ˆbωe−iωt+ˆb†ωeiωt)andassumingthatκ(ω)isindependentoffrequencyaroundωmandωr.Deﬁningκ(ωm)≡κmandκ(ωr)≡κr,wethenﬁndˆHIpol=rκr2π(ˆae−iωrt+ˆa†eiωrt)ˆB(t)+rκm2π(ˆOe−iωmt+ˆO†eiωmt)ˆB(t)(S15)=Xnrκn2π(ˆCne−iωnt+ˆC†neiωnt)ˆB(t),(S16)3wheren=r,mandˆCr≡a,ˆCm≡ˆO.Usingthisresultandfollowingthestandardapproach[S1],wehave˙ρ(t)=−Z∞0dτTrf{[ˆHIpol(t),[ˆHIpol(t−τ),ρ(t)⊗ρf]]},(S17)whereρ(t)isthedensitymatrixofthequbits-resonatorsystemandρfthedensitymatrixoftheresonator’sbath.UsingEq.(S15)anddeﬁningS(t,ω)≡R∞0dτhˆB(t−τ)ˆB(t)ie−iωτ,S∗(t,ω)≡R∞0dτhˆB(t)ˆB(t−τ)ieiωτresultsin˙ρ(t)=Xn,n0−i[∆(ωn,ωn0,t)ˆCnˆCn0,ρ(t)]+Γ(ωn,ωn0,t)D[ˆCn,ˆCn0]ρ(t)−i[∆(−ωn,−ωn0,t)ˆC†nˆC†n0,ρ(t)]+Γ(−ωn,−ωn0,t)D[ˆC†n,ˆC†n0]ρ(t)−i[∆(−ωn,ωn0,t)ˆC†nˆCn0,ρ(t)]+Γ(−ωn,ωn0,t)D[ˆC†n,ˆCn0]ρ(t)−i[∆(ωn,−ωn0,t)ˆCnˆC†n0,ρ(t)]+Γ(ωn,−ωn0,t)D[ˆCn,ˆC†n0]ρ(t),(S18)whereD[ˆx,ˆy]•=ˆx•ˆy−12{ˆyˆx,•},(S19)Γ(ωn,ωn0,t)=√κnκn02π[S(t,−ωn0)+S∗(t,ωn)]e−i(ωn+ωn0)t,(S20)∆(ωn,ωn0,t)=i2√κnκn02π[S(t,−ωn0)−S∗(t,ωn)]e−i(ωn+ωn0)t.(S21)ThelasttwoequationscorrespondtothedissipationratesΓandthelambshifts∆.TogetanexplicitformforS(t,ω),weconsiderasqueezedbathatthefrequencyωp[S1],hˆbω1ˆbω2i=M(ω1)δ(ω1+ω2−2ωp),(S22)hˆb†ω1ˆb†ω2i=M∗(ω1)δ(ω1+ω2−2ωp),(S23)hˆb†ω1ˆbω2i=N(ω1)δ(ω1−ω2),(S24)hˆbω1ˆb†ω2i=[N(ω1)+1]δ(ω1−ω2).(S25)UsingtheseexpressionsinS(t,ω),wegettwodiﬀerentexpressionsforω>0andω<0S(t,ω>0)=π(cid:2)M(ω)e−i2ωpt+N(ω)+1(cid:3),(S26)S(t,ω<0)=π(cid:2)M∗(−ω)ei2ωpt+N(−ω)(cid:3).(S27)Againneglectingfastrotatingterms(butkeeptermsrotatingatδ),thedissipationratesthentaketheformΓ(ωn,ωn0,t)=√κnκn02[M∗(ωn)+M∗(ωn0)]e−i(ωn0+ωn−2ωp)t,(S28)Γ(−ωn,−ωn0,t)=√κnκn02[M(ωn)+M(ωn0)]ei(ωn0+ωn−2ωp)t,(S29)Γ(−ωn,ωn0,t)=√κnκn02[N(ωn0)+N(ωn)]e−i(ωn0−ωn)t,(S30)Γ(ωn,−ωn0,t)=√κnκn02[N(ωn0)+N(ωn)+2]ei(ωn0−ωn)t,(S31)andthelambshifts∆(ωn,ωn0,t)=i√κnκn04[M∗(ωn)−M∗(ωn0)]e−i(ωn0+ωn−2ωp)t,(S32)∆(−ωn,−ωn0,t)=i√κnκn04[M(ωn)−M(ωn0)]ei(ωn0+ωn−2ωp)t,(S33)∆(−ωn,ωn0,t)=i√κnκn04[N(ωn0)−N(ωn)]e−i(ωn0−ωn)t,(S34)∆(ωn,−ωn0,t)=i√κnκn04[N(ωn0)−N(ωn)]ei(ωn0−ωn)t.(S35)Inthenextsectionsweconsiderthreerelevantcases:A)Nosqueezing:N(ω)=M(ω)=0,B)squeezingatωm:N(ωm),M(ωm)6=0,andC)squeezingatωr:N(ωr),M(ωr)6=0.4A.NosqueezingTheﬁrstcaseisabathatzerotemperature,correspondingtoM(ω)=N(ω)=0.ThegeneralizationtoaﬁnitetemperaturebathissimplyobtainedbysettingN(ω)6=0.ThemasterequationEq.(S18)thenreducesto˙ρ(t)=κrD[ˆa]ρ(t)+κmD[ˆO]ρ(t)+√κmκreiδtD[ˆa,ˆO†]ρ(t)+√κmκre−iδtD[ˆO,ˆa†]ρ(t),(S36)whereD[ˆx]•=ˆx•ˆx†−12{ˆx†ˆx,•}=D[ˆx,ˆx†]•istheusualdissipationsuperoperator.Thesecondlinehasanegligibleeﬀectintherelevantcasewhereδ(cid:29)κr,m.Movingoutoftheinteractionpictureandwithg1=g2≡gforsimplicity,werecoverEq.(4)ofthemainLetter.B.SqueezingatthemodulationfrequencyThesecondcaseisabathsqueezedatthemodulationfrequency,ωp=ωm.Ifweassumethatthesqueezingspectrumislargerthanκ,butmuchsmallerthanδ,thenwecansetN(ωr)=M(ωr)=0anddeﬁneM≡M(ωm)andN≡N(ωm)toﬁnd˙ρ(t)=κrD[ˆa]ρ(t)+κm(N+1)D[ˆO]ρ(t)+κmND[ˆO†]ρ(t)+κmMS[ˆO†]ρ(t)+κmM∗S[ˆO]ρ(t)+√κmκr2M∗e−iδtD[ˆa,ˆO]ρ(t)+√κmκr2MeiδtD[ˆa†,ˆO†]ρ(t)+√κmκr2NeiδtD[ˆa†,ˆO]ρ(t)+√κmκr2(N+2)e−iδtD[ˆa,ˆO†]ρ(t)+√κmκr2M∗e−iδtD[ˆO,ˆa]ρ(t)+√κmκr2MeiδtD[ˆO†,ˆa†]ρ(t)+√κmκr2Ne−iδtD[ˆO†,ˆa]ρ(t)+√κmκr2(N+2)eiδtD[ˆO,ˆa†]ρ(t).(S37)Inthisexpression,S[ˆx]•=ˆx•ˆx−12{ˆxˆx,•}=D[ˆx,ˆx]•istheusualsqueezingsuperoperator.Takingadvantageinthefactthatweareonlyinterestedinthesituationwhereφ={0,π},wecansimplifythisexpressionbynotingthatˆO=(g1ˆσ(1)z±g2ˆσ(2)z)/2δ=ˆO†.AsillustratedinFig.S1(a,b),thischoiceofphasediﬀerenceisthemostinterestingfortworeasons:First,thesearetheanglesthatmaximizetheˆσzˆσz-interaction.Notethattheinteractionamplitudecanstillbecontrolledbychangingthemodulationamplitudeg1org2.Second,thesearetheangleswherealltheoscillatorstatesarealignedinphasespace,whichmeansthatthesearetheangleswheredephasingisleastharmfulandwheresqueezingwillhelpthemost.SinceˆO=ˆO†,weusethefactthatD[ˆO]=D[ˆO†]=S[ˆO]=S[ˆO†]towrite˙ρ(t)=κrD[ˆa]ρ(t)+κm(2N+1+M+M∗)D[ˆO]ρ(t)+√κmκr2(N+2+M∗)e−iδtD[ˆa,ˆO]ρ(t)+√κmκr2(N+M)eiδtD[ˆa†,ˆO]ρ(t)+√κmκr2(N+M∗)e−iδtD[ˆO,ˆa]ρ(t)+√κmκr2(N+2+M)eiδtD[ˆO,ˆa†]ρ(t).(S38)ThetwolastlinesofthisequationrepresentanothersmalldephasingchannelnotdiscussedinthemainLetter.However,theyareincludedinthenumericalsimulationsshowninFig.2oftheLetter,andtheircontributionisnegligiblesincewelookatcaseswhereδ(cid:29)κr,m.Wealsoseethatthedephasingtermontheﬁrstlinecanbereducedifthesqueezingangleischosenappropriately.Inthelimitofperfectsqueezing,wecanwriteM=pN(N+1)e2iθwithθthesqueezingangleandN=sinh2rwithrthesqueezingparameter.AsillustratedinFig.S1(d,e)andexplainedinthemaintext,theconditiononθisthattheanti-squeezedquadratureisalignedwiththedisplacementdirection.Notethatherewesetthedisplacementdirectionbyﬁxingthephasereferenceoftheﬁrstqubitmodulationdrive,sothatθisalsoreferencedtothemodulation.Ifθ=π/2,then˙ρ(t)=κrD[ˆa]ρ(t)+κme−2rD[ˆO]ρ(t)+14√κmκr(3+e−2r)e−iδtD[ˆa,ˆO]ρ(t)−14√κmκr(1−e−2r)eiδtD[ˆa†,ˆO]ρ(t)−14√κmκr(1−e−2r)e−iδtD[ˆO,ˆa]ρ(t)+14√κmκr(3+e−2r)eiδtD[ˆO†,ˆa†]ρ(t).(S39)5TheﬁrstlineofthisequationshowsthatthedephasingrateisexponentiallyreducedfortheappropriatesqueezingangleΓm=κm(cid:16)g2δ(cid:17)2e−2r,(S40)forg1=g2≡g.Wealsoseethattheadditionaldephasingtermsstayapproximatelyconstantathighsqueezingpower,whichmeansthattheycanalwaysbeneglectedifδ(cid:29)κr,m.C.SqueezingattheresonatorfrequencyThethirdcaseisabathsqueezedatthemodulationfrequency,ωp=ωr.Similartotheabovecase,wesetN(ωm)=M(ωm)=0anddeﬁneM≡M(ωr),N≡N(ωr).Wealsoassumethatwehaveφ={0,π}sothatˆO=ˆO†leadingto˙ρ(t)=κmD[ˆO]ρ(t)+κr(N+1)D[ˆa]ρ(t)+κrNˆD[ˆa†]ρ(t)+κrMS[ˆa†]ρ(t)+κrM∗S[ˆa]ρ(t)+√κmκr2(N+2+M∗)e−iδtD[ˆa,ˆO]ρ(t)+√κmκr2(N+M)eiδtD[ˆa†,ˆO]ρ(t)+√κmκr2(N+M∗)e−iδtD[ˆO,ˆa]ρ(t)+√κmκr2(N+2+M)eiδtD[ˆO,ˆa†]ρ(t).(S41)Attheappropriatesqueezingangle,thetwolastlinesofEq.(S41)canbeneglected.WecanalsosimplifythesecondlinebydoingaBogoliubovtransformationˆd=coshrˆa+e2iθsinhrˆa†.Inthatframe,themasterequationreducesto˙ρ(t)=κmD[ˆO]ρ(t)+κrD[ˆd]ρ(t)(S42)ThegaininﬁdelityappearsclearlywhenwewritethedisplacementtransformationintermsoftheBogoliubovoperatorsˆd,ˆd†.Ifφ={0,π}andθ=π/2,thenˆD=exp(cid:26)e−r2δ(g1ˆσz1±g2ˆσz2)(ˆd†−ˆd)(cid:27).(S43)ThedisplacementamplitudeisthusexponentiallysuppressedwithrinthephasespaceoftheBogoliubovmode.ThedephasingrateisthenexponentiallyreducedΓr∼κr(cid:16)g2δ(cid:17)2e−2r,(S44)forg1=g2≡g.Phaseinformationiscompletelyhiddenforlargesqueezing.Inthecaseofbroadbandsqueezingatbothωmandωrwesimplyaddthetwocontributionsdescribedabove,leadingtoanexponentialsuppressionoftheoveralldephasingrateasshowninFig.2oftheLetter.II.CIRCUITQEDREALIZATIONFig.S2illustratestwopossiblelumpedelementimplementationofthescheme,wheretwotransmon-typequbitsarecoupledtoacommonLCresonatorviatheirˆσzdegreeoffreedom.Thetwocircuitdesignsdiﬀerintermsofthemaximalattainablelongitudinalcouplingstrength,butareotherwisesimilar.TheschemedepictedinFig.S2(a)allowsforlargercouplingstrengthbecausethequbitscoupletothephasebiasacrosstheentireresonator.Incontrast,theschemedepictedinFig.S2(b)hasareducedparticipationratioη,deﬁnedastheinductanceacrossonequbitdividedbythetotalinductanceoftheLC,reducingtheattainablelongitudinalcouplingstrengthbyonehalf.InthissectionwefocusonthecircuitofFig.S2(a)andshowhowitrealizesEq.(1)ofthemainLetter.ThederivationforthealternativeschemeinFig.S2(b)followsthesamesteps.6FIG.S2.Twopossiblelumpedelementimplementationofthepresentedscheme.Theresonatorpartisshowninblueandthegreen(brown)partrepresentstheﬁrst(second)qubit.(a)ThetwoqubitsareplacedinparallelacrosstheLCresonator.ThisconﬁgurationgivesmaximalcouplingstrengthbecausethequbitscoupletothephasebiasacrosstheentireLCresonator.(b)Analternativeconﬁgurationwiththequbitsinseries.Thisreducestheobtainablecouplingstrengthbyonehalfduetoreducedinductiveparticipationratioforeachqubitη=(L/2)/L=1/2.ThecircuitLagrangianwrittenintermsofthenodeﬂuxesindicatedinFig.S2reads[S2]ˆL=C2(˙ˆφa−˙ˆφb)2−12L(ˆφa−ˆφb)2+Xi(cid:26)CSi2(˙ˆφa−˙ˆφi−˙Φxi/2)2+CSi2(˙ˆφb−˙ˆφi+˙Φxi/2)2+EJicos(cid:20)2πΦ0(cid:16)ˆφa−ˆφi−Φxi/2(cid:17)(cid:21)+EJicos(cid:20)2πΦ0(cid:16)ˆφb−ˆφi+Φxi/2(cid:17)(cid:21)+Cgi2(cid:16)˙ˆφi+˙Φxi/2(cid:17)2(cid:27).(S45)Wenextidentifyresonatorandqubitdegreesoffreedom,ˆφr=ˆφa−ˆφbˆθi=(ˆφa+ˆφb−2ˆφi)/2(resonator),(qubiti),(S46)suchthattheLagrangiancanbewrittenasˆL=C2˙ˆφ2r−12Lˆφ2r+Xi(cid:26)CSi2 ˙ˆθi+˙ˆφr−˙Φxi2!2+CSi2 ˙ˆθi−˙ˆφr−˙Φxi2!2+EJicos"2πΦ0 ˆθi+ˆφr−Φxi2!#+EJicos"2πΦ0 ˆθi−ˆφr−Φxi2!#+Cgi2(cid:16)˙ˆφi+˙Φxi/2(cid:17)2(cid:27).(S47)Notethatthevariableˆφidecouplesfromthequbitandresonatordegreesoffreedom.Forthisreason,wecanthereforedropthelastlineofEq.(S47).Moreover,thecapacitivecrosstermsbetweenthequbitdegreesoffreedom,ˆθi,andthedisplacedresonatorvariable,ˆφr−Φxi,inthesecondlineofEq.(S47)vanishes.Thisisaresultofthesymmetrybetweeneach“arm”oftheindividualqubits.Anyassymetrywouldnecessarilyleadtoanunwantedtransversalcouplingbetweenthequbitsandtheresonatormode,asisdiscussedindetailsinRef.[S3].Asmalltransversalcouplingcan,however,bemade7harmlessbyworkingwithaqubitthatisfardetunedfromtheresonatorfrequency.TheLagrangianthussimpliﬁestoˆL=C2˙ˆφ2r−12Lˆφ2r+Xi(cid:26)CSi˙ˆθ2i+CSi4(cid:16)˙ˆφr−˙Φxi(cid:17)2+EJicos"2πΦ0 ˆθi+ˆφr−Φxi2!#+EJicos"2πΦ0 ˆθi−ˆφr−Φxi2!#(cid:27).(S48)ThisLagrangiancanbesplitintoaresonatorLagrangian,aqubitLagrangianforeachqubit,andqubit-resonatorcouplingLagrangians,ˆL=ˆLr+XinˆLqi+ˆLrqio,(S49)whereusingstandardtrigonometricidentitiesandtoﬁrstorderinˆφrandsecondorderinˆθiwehaveˆLr=Cr2˙ˆφ2r−12Lˆφ2r−12(cid:16)CS1˙Φx1+CS2˙Φx2(cid:17)˙φr,(S50)ˆLqi=CSi˙ˆθ2i+2EJicos(cid:18)πΦ0Φxi(cid:19)cos(cid:18)2πΦ0ˆθi(cid:19)(S51)ˆLrqi=−2EJiπΦ0ˆφrsin(cid:18)πΦ0Φxi(cid:19)+EJiπΦ0ˆφrsin(cid:18)πΦ0Φxi(cid:19)(cid:18)2πΦ0ˆθi(cid:19)2,(S52)withCr=C+CS1+CS22.(S53)Identifyingconjugatevariablesˆqr=∂ˆL∂˙ˆφr=Cr˙ˆφr−12(cid:16)CS1˙Φx1+CS2˙Φx2(cid:17),(S54)ˆqθi=∂ˆL∂˙ˆθi=2CSi˙θi,(S55)thecorrespondingHamiltoniancansimilarlybewrittenasˆH=ˆHr+XinˆHqi+ˆHrqi+ˆHgqio,(S56)whereˆHr=12Crˆq2r+12Lˆφ2r+12CrXiCSi˙Φxiˆqr+XiEJi2πΦ0sin(cid:18)πΦ0Φxi(cid:19)ˆφr,(S57)ˆHqi=1CSiˆq2θi−2EJicos(cid:18)πΦ0Φxi(cid:19)cos(cid:18)2πΦ0ˆθi(cid:19),(S58)ˆHrqi=−12EJi(cid:18)2πΦ0(cid:19)3sin(cid:18)πΦ0Φxi(cid:19)ˆφrˆθ2i.(S59)WerecognizetheHamiltonianˆHrastheHamiltonianofa(driven)resonatorwithfrequencyωr=1/√LCrandcharacteristicimpedanceZ0=rLCr=sLC+(CS1+CS2)/2,(S60)8whiletheHamiltonianˆHqicorrespondstothatofaﬂux-tunabletransmon[S4].FollowingtheapproachofRef.[S4],weintroduceannihilation(creation)operatorsˆa(ˆa†),ˆbi(ˆb†i)fortheresonatorandqubiti,respectively,ˆφr=rZ02(ˆa+ˆa†),(S61)ˆqr=−ir2Z0(ˆa−ˆa†),(S62)ˆθi=r12(cid:18)2e(cid:19)(cid:18)2ECiEJi(Φxi)(cid:19)1/4(ˆbi+ˆb†i),(S63)whereEJi(Φxi)=EJicos(πΦxi/Φ0).Inthetwo-levelapproximationforthequbitsthisleadstoˆθ2i=12(cid:18)2e(cid:19)2s2ECiEJi(Φxi)(ˆbi+ˆb†i)2’12(cid:18)2e(cid:19)2s2ECiEJi(Φxi)ˆσ(i)z+const..(S64)ThisallowsustowritetheHamiltonianasˆHr=ωrˆa†ˆa−i1(ˆa−ˆa†)+2(a+a†),(S65)ˆHqi=ω(i)q2ˆσ(i)z,(S66)ˆHrqi=giˆσ(i)z(ˆa+ˆa†)(S67)wherethecouplingstrengthisgivenbygi=−12EJirπZ0RKs2ECiEJi(Φxi)sin(cid:20)2πΦ0Φxi2(cid:21),(S68)withRK=2π/e2.TheHamiltonianˆHroftheresonatoralsoincludestwoﬂux-induceddriveterms,1=r2Z012CrXiCSi˙Φxi,(S69)2=rZ02XiEJi2πΦ0sin(cid:18)πΦ0Φxi(cid:19).(S70)AsdiscussedinthemainLetter,adisplacementoftheresonatorﬁelddoesnot,however,inﬂuencetheperformanceofthegate.Ifdesired,thisdisplacementcouldbecancelledwithanappropriateexternalmicrowavedrive.III.COUPLEDRESONATORSInthissectionwederivetheeﬀectiveˆσzˆσz-couplinginducedwhenthetwoqubitsareindiﬀerentbutcoupledresonators.Similartothesingleresonatorcase,bothcouplingaremodulatedatthesamefrequencyωm.TheHamiltoniancorrespondingtothissituationwithcapacitivelycoupledresonatorsisˆH=ωaˆa†ˆa+ωbˆb†ˆb+12ωa1ˆσz1+12ωa2ˆσz2+g1(t)ˆσz1(ˆa†+ˆa)+g2(t)ˆσz2(ˆb†+ˆb)−gab(ˆa†−ˆa)(ˆb†−ˆb).(S71)Followingthesameapproachasinthesingleresonatorcase,weﬁrstmovetoaframerotatingatωmforbothresonatorsandωaifortherespectivequbits.Tosimplifythediscussion,wealsoperformarotatingwaveapproximationandneglectfast-rotatingtermsleadingtoˆHR=δaˆa†ˆa+δbˆb†ˆb+g12ˆσz1(ˆa†+ˆa)+g22ˆσz2(ˆb†eiφ+ˆbe−iφ)+gab(ˆa†ˆb+ˆaˆb†).(S72)ThesecondstepistodiagonalizetheresonatorpartoftheHamiltonianˆHr=δaˆa†ˆa+δbˆb†ˆb+gab(ˆa†ˆb+ˆaˆb†)andtoexpressthelongitudinalcouplingintermsoftheresultinghybridizedmodes.Forthispurpose,wedeﬁnetheeigenmodeoperatorsˆc=cosξˆa+sinξˆb,(S73)ˆd=−sinξˆa+cosξˆb,(S74)9wheretan2ξ=2gab/(ωa−ωb).ExpressingtheHamiltonianEq.(S72)intermsoftheseeigenmodesyieldsˆHR=δcˆc†ˆc+δdˆd†ˆd+(cid:26)12(cid:2)g1cosξˆσz1+g2eiφsinξˆσz2(cid:3)ˆc†+12(cid:2)−g1sinξˆσz1+g2eiφcosξˆσz2(cid:3)ˆd†+H.c.(cid:27),(S75)wherethedetuningsareδc=δa+δb2+gabsin2ξ,δd=δa+δb2−gabsin2ξ.(S76)FollowingthesameapproachasinSect.IweﬁnallyapplytheunitarytransformationˆUD=eˆOcˆc†−ˆO†cˆceˆOdˆd†−ˆO†dˆd≡ˆUcˆUd,withˆOc=(g1cosξˆσz1+g2eiφsinξˆσz2)/2δcandˆOd=(−g1sinξˆσz1+g2eiφcosξˆσz2)/2δd.Because[ˆUc,ˆUd]=0,thetransformationdoesnotgenerateacouplingbetweentheeigenmodes.TheresultingHamiltonianisthenˆHpol=δcˆc†ˆc+δdˆd†ˆd+Jzˆσz1ˆσz2,(S77)withtheˆσzˆσz-couplingstrengthJz=δc−δdδcδdg1g24sin2ξcosφ.(S78)Deﬁning¯δ=(δa+δb)/2andζ=1/tan2ξ,wecanwritethisasJz=12g1g2gabcos(φ)¯δ2−g2ab(1+ζ2)(S79)correspondingtotheresultstatedinthemainLetter.IV.DETAILSONTHESIMULATIONSTocalculatetheaveragegateﬁdelity,wecomparefullmasterequationsimulationstotheidealchannelUCZ•=ˆUCZ•ˆU†CZwithˆUCZ=diag[1,1,1,−1]=ˆUCP(π).Themasterequationisdeﬁnedoverthesystemresonator-qubitsandwethereforeeliminatetheresonatordegreeoffreedom.Tothisend,wedeﬁnethechannelEq1q2actingonthequbitsasEq1q2(•)=TrU†DeLtUD(|0ih0|r⊗•),(S80)wherethesuperoperatorTr•≡Trr(•)isthetraceovertheresonatordegreeoffreedomandthesuperoperatorsUD•≡ˆD•ˆD†,U†D•≡ˆD†•ˆDaretheunitarydisplacementtransformationsdeﬁnedinEq.(S7).ThisprocedureisillustratedintermsoftensordiagramsinFig.S3[S5].HereLdenotesthesystemLiouvillian˙ρ(t)=Lρ(t)derivedinSect.I.Forexample,theLiouvillianincludingqubitT1,T2andnosqueezingcanbeobtainedeasilyfromEq.(S36)andtakestheform˙ρ(t)=−i[ˆHpol,ρ(t)]+κrD[ˆa]ρ(t)+κm1(2δ)2D[g1ˆσz1+g2eiφˆσz2]ρ(t)+√κmκrD[ˆa,ˆO†]ρ(t)+√κmκrD[ˆO,ˆa†]ρ(t)+Xiγ(i)1D[ˆσ−i]+γ(i)φD[ˆσzi],(S81)whereˆHpol=δˆa†ˆa+Jzˆσz1ˆσz2andthedecayratesaregivenbyγ(i)1=1/T(i)1,1/T(i)2=γ(i)φ+γ(i)1/2.NotethatthetwoﬁrsttermsonthesecondlinedonotrotatelikeinEq.(S36)becauseweareinaframerotatingatωmfortheresonatorratherthanatωr.Althoughwetaketheresonatortoinitiallybeinthevacuumstateinournumericalcalculations,westressthatanycoherentstatecouldhavebeenchosenwithoutchangetotheresultingﬁdelity.Inthecasewherethereissqueezingatωr,weassumedtheresonatorinitiallytobeinasteadystatesqueezed.ThiscorrespondstothevacuumstateintermsoftheBogoliubovoperatorsd,d†.Knowingtheeﬀectivechannelovertwoqubits,theaveragegateﬁdelityFisobtainedbyaveragingoverallinitialstatesaccordingtotheuniform(Haar)measure[S6]F=Zdψhψ|U†CZEq1q2(|ψihψ|)UCZ|ψi.(S82)10FIG.S3.TensorrepresentationoftheCZgatesupermatrix[S5].Herethebluelinesrepresenttheresonatordegreeoffreedomandthegreen(brown)linesrepresenttheﬁrst(second)qubit.(a)Idealcontrolled-Zchannel.(b)Simulatedquantumchannelovertwoqubits.Weprojectontoaninitialvacuumstateoftheresonatoratthebeginning(right)andtraceovertheresonatordegreeoffreedomattheend(left).ThesimulationsweredoneusingQuTiP[S7].[S1]C.GardinerandP.Zoller,QuantumNoise:AHandbookofMarkovianandNon-MarkovianQuantumStochasticMethodswithApplicationstoQuantumOptics,SpringerSeriesinSynergetics(Springer,2004).[S2]M.H.Devoret,LesHouchesLectureNotes(1995).[S3]N.Didier,J.Bourassa,andA.Blais,Phys.Rev.Lett.115,203601(2015).[S4]J.Koch,T.M.Yu,J.Gambetta,A.A.Houck,D.I.Schuster,J.Majer,A.Blais,M.H.Devoret,S.M.Girvin,andR.J.Schoelkopf,Phys.Rev.A76,042319(2007).[S5]C.J.Wood,J.D.Biamonte,andD.G.Cory,QuantumInformation&Computation15(2015).[S6]M.A.Nielsen,PhysicsLettersA303,249(2002).[S7]J.Johansson,P.Nation,andF.Nori,ComputerPhysicsCommunications184,1234(2013).