6
1
0
2

 
r
a

M
8

 

 
 
]

.

R
S
h
p
-
o
r
t
s
a
[
 
 

1
v
5
0
4
2
0

.

3
0
6
1
:
v
i
X
r
a

MNRAS 000, 1–18 (2016)

Preprint 9 March 2016

Compiled using MNRAS LATEX style ﬁle v3.0

Space reconstruction of the morphology and kinematics of
axisymmetric radio sources

P.N. Diep⋆, N.T. Phuong, D.T. Hoai, P.T. Nhung, N.T. Thao, P. Tuan-Anh and
P. Darriulat
Department of Astrophysics, Vietnam National Satellite Center (VNSC), Vietnam Academy of Science and Technology (VAST),
18 Hoang Quoc Viet, Ha Noi, Viet Nam

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT
The unprecedented quality of the observations available from the Atacama Large
Millimetre/sub-millimetre Array (ALMA) calls for analysis methods making the best
of them. Reconstructing in space the morphology and kinematics of radio sources is
an underdetermined problem that requires imposing additional constraints for its so-
lution. The hypothesis of rotational invariance about a well-deﬁned star axis, which
is a good approximation to the description of the gas envelopes of many evolved stars
and protostars, is particularly eﬃcient in this role. In the ﬁrst part of the article,
a systematic use of simulated observations allows for identifying the main problems
and for constructing quantities aimed at solving them. In particular the evaluation
of the orientation of the star axis in space and the diﬀerentiation between expansion
along the star axis and rotation about it are given special attention. The use of polar
rather than Cartesian sky coordinates is shown to better match the morphology and
kinematics of actual stars. The radial dependence of the gas density and temperature
and the possible presence of velocity gradients are brieﬂy considered. In the second
part, the results obtained in the ﬁrst part are applied to a few stars taken as examples
with the aim of evaluating their usefulness when applied to concrete cases. A third
part takes stock of what precedes and formulates some guidelines for modelling the
radio emission of axisymmetric radio sources, limited however to the mathematics and
geometry of the problem, physics considerations being ignored.

Key words: stars: late-type – stars: AGB and post-AGB – stars: circumstellar matter
– stars: kinematics and dynamics – stars: winds, outﬂows – stars: protostars – radio
lines: stars

1 INTRODUCTION

From the end of their lifetime on the Main Sequence to their
death as White Dwarfs, most stars evolve from a perfectly
spherically symmetric morphology to the often very irregular
shapes of Planetary Nebulae dissolving into the Interstellar
Medium (ISM). The transition, with Red Giant and Asymp-
totic Giant Branch (AGB) as main intermediate states, is
the object of intense study. The ﬁrst departure from spher-
ical symmetry is often observed to be the appearance of a
bipolar outﬂow, axisymmetry replacing spherical symmetry.
Many observations, whether of the dust from infrared, mid-
infrared and far-infrared or of the gas from atomic radio
or molecular millimetre/sub-millimetre emission, in partic-
ular from carbon monoxide, are interpreted in terms of such

⋆ E-mail: pndiep@mail.vnsc.org.vn

c(cid:13) 2016 The Authors

symmetry. Namely they aim at giving a model of the circum-
stellar envelope (CSE) displaying invariance with respect to
rotation about a well-deﬁned star axis, averaging over devia-
tions from it, assumed to be small. The physics mechanisms
at play in such symmetry breaking are not well understood
and many observations aim at their clariﬁcation. The pres-
ence of a companion accreting gas from the dying star is
very often invoked, but the roles of rotation and of mag-
netic ﬁeld – how the angular momentum and magnetic ﬂux
of the original star are distributed between the degenerate
core and the CSE – are still unclear.

The study of protostars displays striking similarities
with the study of evolved stars. The CSE is now in-falling
rather than expanding but axisymmetry is again found to be
a good working approximation in many cases and the mech-
anisms that govern the transition from gravitational in-fall
to formation of a rotating disk, accretion by the protostar
and emission of a bipolar outﬂow are still unclear.

2

P.N. Diep et al.

In the present article, we focus on the millimetre/sub-
millimetre observation of the expanding CSE, typically from
carbon monoxide emission, but many developments apply as
well to the in-falling CSEs of protostars.

The data are in the form of ﬂux densities f , measured
in Jansky/beam in bins (pixels) of sky coordinates (y to the
east and z to the north) and of frequency, the latter be-
ing expressed in terms of the Doppler velocity Vx measured
along the line of sight taken as x axis. Making a model of
the star from such observations can be conceptually sepa-
rated in two steps, even if, in practice, they are generally
mixed: the reconstruction in space of the gas properties, a
purely mathematical problem, and the conception of a phys-
ical model accounting for the distribution in space of the gas
density, temperature and velocity.

The former, the mathematical problem, is what is ad-
dressed here. It aims at measuring, at each point of space
coordinates (x, y, z), the temperature T , density d and veloc-
ity vector (Vx,Vy,Vz) of the gas. This means, for each (y, z)
pixel, to calculate the values taken by T , d and the three ve-
locity components as a function of x. While the assumption
of rotational invariance about the star axis brings a help-
ful constraint, the problem is obviously unsolvable without
making additional hypotheses (six unknowns in each pixel,
x, T , d and the components of the velocity vector, for only
two input data: the measured ﬂux density f (y, z,Vx) and the
Doppler velocity Vx). From the beginning, we simplify the
density and temperature side of the problem by introducing
an eﬀective density r , deﬁned as r (x, y, z) = f (y, z,Vx)dVx/dx,
implying R f (y, z,Vx)dVx =R r (x, y, z)dx = F(y, z). The eﬀective

density is therefore a function of the gas density, the abun-
dance of the emitting gas, the population of the emitting
quantum state and the probabilities of emission and absorp-
tion of the detected radiation. In general, we measure all dis-
tances as angular distances, including along the line of sight:
an angular distance of 1′′ means a distance of 1 AU times the
distance of the star from the Earth measured in parsec, the
eﬀective density being measured in Jy km s −1 arcsec−1. Also
from the beginning, we often restrict our considerations to
centrally symmetric star morphologies and kinematics, im-
plying f (y, z,Vx) = f (−y,−z,−Vx).
The problem of reconstructing CSE properties in space
from radio observations is not new and has been addressed
for decades by radio astronomers. What is new, however,
is the availability of observations of unprecedented spatial
and spectral resolution in the millimetre and sub-millimetre
ranges, with the recent operation of the ALMA interferom-
eter. It opens a new era in millimetre and sub-millimetre
radio astronomy and requires analysis methods that make
the best of the excellent quality of the data that it provides,
namely allowing for more quantitative conclusions to be reli-
ably drawn from observations than was previously possible.
Indeed, the sensitivity and spatial resolution that could be
reached before ALMA were such that one had often to be
satisﬁed with qualitative statements obtained from the vi-
sual inspection of channel maps, spectral maps and position-
velocity (P-V) diagrams. In particular, the reliability and
uniqueness of the proposed models could rarely be quanti-
tatively discussed.

The paper is organized as follows: in a ﬁrst part, we ex-
plore the more important features of the problem of space re-
construction using simulated observations; in a second part,

Figure 1. Coordinate transformations.

we apply the information obtained in the ﬁrst part to a few
actual stars; the third part summarizes the two preceding
chapters and makes some statements aimed at helping and
guiding future analyses of millimetre/sub-millimetre obser-
vations of the CSEs of axisymmetric radio sources.

For an easier reading, we have collected in an appendix
many developments, which, although important for an in-
depth understanding, are not essential for grasping the main
message.

2 AN EXPLORATION OF THE MAIN

FEATURES USING SIMULATED
OBSERVATIONS

2.1 Transformation relations between space and

star coordinates

We deﬁne (Figure 1) two orthonormal coordinate systems,
(x, y, z) and (x ,h ,z ); (x, y, z) with x along the line of sight (pos-
itive away from the observer), y pointing east and z pointing
north; (x ,h ,z ) with x along the star axis obtained from
(x, y, z) by a ﬁrst rotation of angle y about x and a second
rotation of angle q about y′, the transformed of y in the ﬁrst
rotation. Transformation relations between the two systems
are spelled out in Appendix A1. We also use polar coordi-
nates (R,j ) in the plane of the sky: y = R cosj , z = R sinj
and we deﬁne r =px2 + y2 + z2.

2.2 Eﬀective density, wind velocity and their

symmetries

The ﬂux densities, f (y, z,Vx) or f (R,j ,Vx), available to analy-
sis are three-dimensional objects, which makes their visual-
ization diﬃcult. Traditionally, one uses channel-maps (z vs
y distributions in each Vx bin or group of neighbour bins)
or spectral maps (Vx distributions in each pixel or group of
neighbour pixels). However, when the number of velocity
bins and of pixels is large, it is necessary to group many
of these together, thereby loosing much of the spatial and
spectral resolution of modern instruments such as ALMA. It
is therefore convenient to reduce the problem to two dimen-
sions by introducing moments of order k obtained by inte-
grating the measured ﬂux densities over one of the variables

MNRAS 000, 1–18 (2016)

3

velocity on the sky plane is not suﬃcient to ﬁnd the projec-
tion of the star axis. Expansion and rotation combine with
diﬀerent symmetry properties, resulting in an apparent ro-
tation of the projection of the star axis on the sky plane, by
an unknown amount. It is only in the cases of pure rotation
and pure expansion that the axis of the star is an axis of
symmetry of the sky map. However, in such cases, this axis
of symmetry is the projection of the star axis in the case
of pure expansion, but is perpendicular to it in the case of
pure rotation. It is therefore necessary, in order to evaluate
the value of y , to exploit the information contained in the
velocity spectra rather than integrating over velocities.

We illustrate this point with a series of simulations, the
results of which are displayed in Figure 3. In this ﬁgure,
the angle j
is the position angle of the pixel on the sky
map. The positive y axis has j = 0, the positive z axis has
j = p /2, etc. The Doppler velocity Vx is measured positive
when red shifted. Figure 3 includes six diﬀerent sets, each
associated with a particular orientation q of the star axis.
The position angle of the projection of the star axis on the
sky plane is always y = 0, meaning south-north. Changing
its value results simply in a rotation of the sky map about
the origin, meaning a simple translation of the j vs Vx P-V
diagrams along the j axis. The inclination of the star axis
with respect to the line of sight (x axis) is measured by the
angle q
indicated on the ﬁgure, between 15◦ and 90◦ in steps
of 15◦. For q = 0 the star is seen pole on; for q = p /2 the
observer is in the equatorial plane of the star.

Simulations are made for three cases, each correspond-
ing to a column: pure expansion on the left, a combination
of expansion and rotation in the middle and pure rotation
on the right. The star properties are supposed to be invari-
ant under rotation about the star axis. The eﬀective density
is taken isotropic with dependence in r−2 on the distance r
from the star. Two diﬀerent forms, A and B, are used to de-
ﬁne the dependence of the gas velocity on the star latitude,
each corresponding to a row in the ﬁgure. The velocities are
otherwise supposed to be independent of the star longitude
(imposed by rotational invariance) and of the distance r to
the star (the absence of velocity gradients is a simpliﬁcation
expected not to have important consequences on the quali-
tative comments made here). Moreover, they are supposed
to be symmetric with respect to the equatorial plane, im-
plying central symmetry when combined with rotational in-
variance, meaning that changing (x, y, z) in (−x,−y,−z) leaves
the eﬀective density invariant and changes the sign of the gas
velocity. This corresponds to adding p to j and its eﬀect is
immediately visible in Figure 3. The expansion velocity Vrad
is taken purely radial and the rotation velocity Vrot is taken
perpendicular to the star axis. In both cases A and B, rota-
tion is enhanced near the equator and expansion is enhanced
near the poles. For each value of q the upper row is for case
A, Vrad = V0 sin2 a and Vrot = V0 cos2 a ; in the lower row, case
B, Vrad is set to 0 and Vrot to V0 for a < p /4 while Vrot is set to
zero and Vrad to V0 for a > p /4 (Figure 4). Each simulation
is illustrated by two panels. The upper panel is the P-V di-
agram, j vs Vx, with the abscissa running from −10 km s −1
to 10 km s −1 and the ordinate from 0 to 2p ; the lower panel
is the projection of the diagram on the velocity axis.

In order to construct an axially symmetric model of
the CSE of the star, one needs to ﬁnd the position of the
star axis in space, namely the values of q and y , before

Figure 2. Wind velocity components.

after having multiplied them by that variable raised to power
k. In practice, only a few of these moments are commonly
used, usually under other names. Integrating over Vx maps
the ﬂux F(R,j ) = R +¥
f (R,j ,Vx)dVx. As r (x, y, z) decreases
−¥
usually rapidly with r, typically as r−2, mapping the quan-
tity R +¥
−¥ R f (R,j ,Vx)dVx is better suited for revealing ﬁner
pixel, < Vx >= R +¥
Similarly, < |Vx| > and < V 2

details of the ﬂux map. The ﬁrst order moment divided by
the integrated ﬂux gives the mean Doppler velocity in each
−¥ Vx f (y, z,Vx)dVx/F(y, z), which is a useful
indicator of a possible asymmetry of the wind velocities.
x > provide useful information.

quantities such as R +¥

Fixing a sky coordinate, y or z, or integrating over it
corresponds to the P-V diagrams commonly used in radio
astronomy analyses. As the dependence on j of the ﬂux
densities is often only weakly coupled to its dependence on R
(to the extent that the dependence on stellar latitude of the
star properties is only weakly coupled to its dependence on
r) polar coordinates are better suited to such analyses, using
0 R f (R,j ,Vx)dR.
It is convenient to express the components of the wind
velocities in the star frame (Figure 2). Their symmetry prop-
erties are detailed in Appendix A2. Precisely, we deﬁne a
radial component Vrad , an axial component Vax along the
star axis and a rotation component about the star axis, Vrot.
In terms of the stellar latitude a and stellar longitude w ,
the (x ,h ,z ) components of the wind velocity are therefore
(x ,h ,z )Vrad ; (1,0,0)Vax; and (0,−sinw ,cos w )Vrot respectively

0

f (R,j ,Vx)dR and R +¥

and the Doppler velocity reads:

Vx =

x
r

Vrad + cosq Vax −

R cos(j − y )sinq

r cosa

Vrot

(1)

2.3 Velocity spectra and P-V diagrams

For stars that have lived long enough on the AGB for the
morphology of their gas envelope to be signiﬁcantly altered,
the sky map of the measured ﬂux, F(y, z), directly reveals
the projection of the star axis on the sky plane. However,
this is often not the case for AGB stars having mass loss
rate at the scale of 10−7 M⊙ yr−1, and axial symmetry, if
present, can only be revealed from the velocity distribution
of the wind.

However, mapping the mean value < Vx > of the gas

MNRAS 000, 1–18 (2016)

4

P.N. Diep et al.

evaluating the values of the eﬀective density and gas velocity
as a function of the star latitude a and the distance r to the
star. Once y
is known, one can rotate the data on the sky
map in order to have y = 0, namely the projection of the star
axis pointing north. Then the star properties display simple
symmetries with respect to S1, changing x, y, z in −x, y,−z
and S2, changing x, y, z in x,−y, z; the Doppler velocity is even
under S1 and odd under S2 for pure rotation and even under
S2 and odd under S1 for pure expansion. These symmetries
are clearly seen in Figure 3 in the cases of pure expansion
(left columns) or pure rotation (right columns). However, if
one does know the value of y
(and one has no reason to know
it a priori), the symmetry obeyed by the Doppler velocity
as a function of j does not tell the value of y : the values
associated with pure expansion and pure rotation diﬀer by
p /2. It is then essential to make a distinction between the
eﬀects of expansion and rotation on the Doppler velocity
and the P-V diagrams before having a chance to measure y .
Assuming that we know q and y , and given the dependence
on r and a of the eﬀective density and of the gas velocity,
one can calculate, for each panel of Figure 3, the ﬂux density
f (y, z,Vx) = r (x, y, z)dx/dVx for each pixel (y, z), or equivalently
(R,j ). Further details are given in Appendix A3.

2.3.1 The case q = 0◦
In this case, the ﬂux density is independent of j : the whole
information is contained in the projections on the Vx axis
of the P-V diagrams. Moreover, the rotation velocity being
perpendicular to the line of sight does not contribute to the
Doppler velocity: for pure rotation, Vx identically cancels. A
consequence is that the mixed case is identical to the pure
expansion case.

When attempting to construct a model, there exists no
constraint imposed on the forms chosen for Vrad (r,a ) and
Vax(r,a ) (not to mention Vrot, which can take any value!). In
particular, the hypothesis of rotational invariance is of no
use in this case: all it says is that the measured ﬂux density
f (R,j ,Vx) must be independent of j . Either it is, in which
case the data are consistent with the hypothesis, or it is not,
in which case they are not.

In summary, when q = 0◦, one cannot learn anything
about rotation and one may choose as one wishes the de-
pendence of the expansion velocity on the star latitude and
the distance from the star. Having done so, one can then
reconstruct the values of the eﬀective density and expan-
sion velocity at any point in space. If one assumes that r ,
Vrad and Vax depend only on r the integral equation is easily
solved to give r (r) for any r value. Then, assuming partic-
ular forms for the r dependence of Vrad (r) and Vax(r), one
can also calculate them for any r value. In such a case, one
obtains a spherical model of the CSE.

2.3.2 The case q = 90◦
In this case, as R < r, the angle j measures the maximal value
taken by a
in a given pixel (for x = 0): r sina = z = R sinj .
In the case of pure expansion, as Vx = (x/r)Vrad , the
Doppler velocity tends to Vrad when x is large. Near the y
axis, j = 0◦, one is probing low latitudes where Vrad cancels.
On the contrary, near the z axis, j = p /2, one is probing large

r cosa Vrot and + R

In the case of pure rotation, as Vx = − R cosj

latitudes where Vrad takes its maximal values. The maximal
values of Vx are therefore reached around j = p /2 and the
minimal values around j = 0. The precise value taken by Vx
at maximum depends on the dependence of Vrad over a , the
larger the more concentrated near the poles are high Vrad
values.
r cosa Vrot , the cosj
term modulates the maximal value of Vx as a function of j :
r cosa Vrot when j goes
it oscillates between − R
from 0 to p , cancelling at j = p /2. When q = 90◦, contrary
to the previous case (q = 0◦), rotational invariance cannot
be veriﬁed but, if it is assumed to be obeyed, it strongly
constrains the data. It implies that for a given value of z,
the eﬀective density is a function of only r and sina = z/r,
namely of r alone. Therefore, for each value of z, one can
write F(y, z) = R r (r, z)dx = R r (r, z)r(r2 − R2)−1/2dr, an inte-

gral equation easily solvable by iteration. Rotational invari-
ance constrains the dependence of F(y, z) on y for each value
of z. Similarly, for each value of z, Vrad and Vrot depend only
on r, so does therefore dx/dVx. Assuming particular forms
for the r-dependence of Vrad and Vrot, one can then evalu-
ate their values at each point in space. More precisely, for
each value of z, as long as the forms chosen for Vrad and Vrot
depend on a small enough number of parameters compared
with the number of pixels, one can calculate the values taken
by these parameters and obtain Vrad and Vrot as functions of
r and z = r sina , namely as functions of r and a .
In summary, when q = 90◦, one cannot verify the valid-
ity of the hypothesis of rotational invariance. But, assuming
it, one can evaluate the eﬀective density at any point in
space. One can also evaluate the values taken by Vrad and
Vrot at any point in space once arbitrary forms have been
adopted for their r-dependence, but Vax can take any arbi-
trary value.

2.3.3 Pure rotation and pure expansion

In a given pixel, both pure rotation and pure expansion
typically generate double-horned spectral distributions. In-
deed, if Vmax is the maximal value taken by |Vx| in this pixel,
dN/dVx = dN
is inﬁnite at Vx = Vmax where dVx/dx = 0. A
dx
simple illustration is obtained using Vrot = V0 cosa and Vrad =
V0. The corresponding spectral distributions are respectively
proportional to (V 2
x )−3/2. The lim-
its of the spectrum are ±Vmax , with Vmax = V0 cosj sinq
for
pure rotation and Vmax = V0 for pure expansion. In both
cases, the spectrum grows from its value at Vx = 0 to inﬁnity
at the limits. Details are given in Appendix A4.

x )−1/2 and (V 2

max−V 2

dx
dVx

max−V 2

2.3.4 Mixing rotation and expansion

The simplest case is case B: x probes either inside the cone
where it sees only expansion or outside where it sees only
rotation. Hence, the middle columns of Figure 3 are simply
the superposition of the left and right columns. This remains
qualitatively true when the regions probed by x are domi-
nated by a single regime, rotation or expansion, respectively
near the equator or near the poles. However, in general, for
a given pixel, Vx receives signiﬁcant contributions from both
rotation and expansion. As a result, when mapping < Vx >,
one sees a symmetry that reﬂects both the value of y and

MNRAS 000, 1–18 (2016)

5

Figure 3. P-V diagrams. The spikes observed at Vx = 0 in the pure expansion and pure rotation cases correspond to the contributions
of respectively Vrot = 0 and Vrad = 0.

MNRAS 000, 1–18 (2016)

6

P.N. Diep et al.

Figure 4. Dependence of gas velocity (rotation in blue, expansion
in red) on star latitude in cases A and B used in the simulation.

Figure 5. Sky map of < Vx > in case A for q = 45◦, y = 0 and
mixed expansion and rotation (middle column of the set of P-V
diagrams in Figure 3).

the relative importance of rotation and expansion: Figure 5
illustrates the diﬃculty of ﬁnding the axis of the star when
nothing is known a priori about their relative contributions.

2.4 Telling rotation from expansion
Having found the value of y
is not suﬃcient to tell expan-
sion from rotation. Even in a pure case, rotation around the
y axis and expansion along the z axis will both produce P-V
diagrams odd under S1 and even under S2. A discriminator
between rotation and expansion would therefore be a useful
tool. After rotation of the data on the sky plane making y
to
cancel, in the case of pure radial expansion xVx = (x2/r)Vrad is
positive and in the case of pure rotation yVx = − y2 sinq
r cosa Vrot has
the sign of −Vrot. Appendix A6 makes use of this property
to construct a function of j , A(j ), as a possible discrimina-
tor between rotation and expansion. The values of A(j ) at
j = 0◦ and j = 90◦ or its integral over j are generally good
indicators of the relative importance of rotation over expan-
sion. However, when dealing with a small perturbation to a
global isotropic expansion, it is diﬃcult to assert its precise
nature, rotation or bipolar expansion.

2.5 Inclination q of the star axis with respect to

the line of sight

Having evaluated the value of y and assuming for simplicity
that y = 0, one needs to evaluate the value of the inclination
q of the star axis with respect to the line of sight. For the
star axis to be well deﬁned, there must be a large enough
asymmetry of the eﬀective density and/or the wind velocity:
spherical distributions prevent the deﬁnition of such an axis.
As a result, what can be generally measured is the product of
a measure of the inclination, typically sinq , by a measure of
the elongation of the eﬀective density and/or velocities along
the star axis. As detailed in Appendix A7, this implies strong
correlations relating the inclination angle to the elongation
of the outﬂow on the star axis, namely the ratio of polar to
equatorial wind velocities.

2.6 Radial dependence of the CSE properties

2.3.5 Evaluating the value of y
When y = 0, in the vicinity of the y axis, changing z in −z

leaves the velocity spectrum unchanged in the case of pure
rotation but reﬂects it about the origin in the case of pure
expansion. Similarly, in the vicinity of the z axis, changing y
in −y leaves the velocity spectrum unchanged in the case of
pure expansion but reﬂects it about the origin in the case of
pure rotation. Appendix A5 introduces a function c 2y of the
position angle constructed on this remark, which is meant
to reach its minimum at y .

Figure 6 displays the dependence of c 2y on y

for each of
the 36 P-V diagrams of Figure 3. In general, a clear minimum
is found at the value y = 0 as expected. However, when
q
is suﬃciently diﬀerent from 0 and 90◦, and when both
expansion and rotation contribute signiﬁcantly to Vx, c 2y
is
found to be less dependent on y and the identiﬁcation of
the minimum is diﬃcult. It is interesting to remark that
a clear minimum is always found in case B. In this case,
one is probing either the interior of the cone and sees only
expansion, or the exterior of the cone, and sees only rotation:
rotation and expansion never compete at a same point in
space.

One expects the R-dependence of the integrated ﬂux to carry
much information about the r-dependence of the eﬀective
density. Indeed, from pure dimensional considerations, one
would expect a r−n dependence of the eﬀective density to
produce a R−(n−1) dependence of its integral on the sky map.
As detailed in Appendix A8, this is generally the case. Sim-
ilarly, the sky map of the mean of the absolute value of the
Doppler velocity is found to reveal directly the presence of
velocity gradients.
These results

the advantage of
analysing the measured ﬂux densities in terms of polar
rather than Cartesian coordinates on the sky plane. Their
dependence on R is related simply to the dependence on r
of the eﬀective density and wind velocity, while their de-
pendence on j
is related to the dependence of the eﬀective
density and wind velocity on the orientation of the star axis
and on star latitude. Without having recourse to a model,
much information about the morphology and kinematics of
the CSE can be obtained from simple quantities constructed
directly from the expression of the ﬂux densities in polar co-
ordinates.

illustrate further

However, the interpretation of such results requires ac-
counting for the fact that the eﬀective density diﬀers from
the actual gas density and a temperature gradient is likely

MNRAS 000, 1–18 (2016)

7

Figure 6. Distributions of c 2y as a function of y . The panels are arranged as in Figure 3: left column for pure expansion, middle column
for mixed expansion and rotation, right column for pure rotation; upper row for case A and lower row for case B. In each panel, simulations
corresponding to q = 15◦, 30◦, 45◦, 60◦, 75◦ and 90◦ are displayed. The projection of the star axis on the sky plane is at y = 0.

to produce eﬀects that mimic a velocity gradient on the sky
map. An illustrative example is given in the next section
when we study the case of AGB star RS Cnc.

3 APPLICATION TO REAL OBSERVATIONS

3.1 A typical AGB star: RS Cnc

As a ﬁrst application of the results of the preceding sec-
tions, we consider a typical AGB star, RS Cnc that has
been studied in some detail, in particular from observations
of CO(1-0) emission using the Plateau de Bure Interferom-
eter (Hoai et al. 2014; Nhung et al. 2015).

Figure 7 displays the dependence on R and j of the
measured ﬂux multiplied by R. The R-dependence is well
described by a power law of the form R−0.63 implying a
r-dependence of the eﬀective density of the approximate
form r−1.6. The j -dependence is very uniform, with excur-
sions from the mean not exceeding ∼ 6%; Figure 7 displays
also the dependence on R and j of the mean Doppler veloc-
ity, which reveals a very clear north-south asymmetry.

The R-dependence suggests the presence of a signiﬁcant
negative velocity gradient, at variance with the results of the
best ﬁts published earlier (Nhung et al. 2015), which imply
a positive velocity gradient both at the equator and near the
poles. This is a good illustration of a general situation and
deserves therefore a detailed analysis. In a stationary regime,
a radial wind velocity decreasing with r implies a product dr2
(d is the gas density) increasing with r at the same rate. How-
ever, the dependence on r of the eﬀective density includes a
temperature factor that accounts for the population of the
emitting quantum state and the probability of emission, nor-
mally decreasing with r. Depending on its value, the prod-
uct r r2 (r
is the eﬀective density) may therefore increase
less steeply with r than dr2 does, or even decrease with r.

MNRAS 000, 1–18 (2016)

The published analysis uses a temperature dependence ad-
justed to best ﬁt the CO(1-0) and CO(2-1) observations si-
multaneously and assumes stationarity. The dependence on
R of < |Vx| > as given by the model receives three contribu-
tions: from the r-dependence of the temperature, from the
r-dependence of the UV dissociation factor and from the ve-
locity gradients. The former two contribute to the decrease
of < |Vx| > with R (by respectively 1.86 and 3.44%/arcsec-
ond, totalling 5.3%/arcsecond). As the data display a de-
crease of only 3.48% rather than 5.3%/arcsecond, a positive
velocity gradient is required to make up for the diﬀerence.
The question then arises of the validity of the assumption
of stationarity used in the model: the radial scale spanned
by Figure 7 means some 105 years, the wind velocity might
have increased somewhat over such a long period, implying
higher gas densities at large distances from the star and vi-
olating the stationarity hypothesis. To anser the question
we compare the quality of two ﬁts: one assuming station-
arity and allowing for gradients on the velocities, the other
assuming instead r-independent velocities but allowing for
gradients on the ﬂuxes of matter. The best ﬁt is obtained
for the scenario that assumes stationarity, but the other ﬁt
gives a value of c 2 that is only 12% larger. The gradients are
1.4%/arcsecond and 8.2%/arcsecond in the stationary case,
2.0%/arcsecond and −8.3%/arcsecond in the other, the ﬁrst
value being for the polar regions and the second value for
the equatorial region. This result illustrates the diﬃculty
to ascertain the validity of the stationarity hypothesis with
conﬁdence from the presently available observations.

RS Cnc is also a good test case to illustrate the problems
associated with the measurement of the orientation of the
star axis and the relative importance of expansion and rota-
tion. Figure 8 displays the dependences on y of c 2y and on q
of the best ﬁt c 2, both angles being measured with an uncer-
tainty of ∼ ±25◦ and the values of the parameters associated
with the elongation of the wind velocity along the star axis

8

P.N. Diep et al.

Figure 7. Measured CO(1-0) ﬂux of RS Cnc. Left: R-dependence of RF(y,z) averaged over j ; the ﬁt (in red) is a power law of index −0.63.
Central left: j -dependence of RF(y,z) averaged over R; the ﬁt (in red) is a sine wave of amplitude 1.3% of the mean value. Centre right:
R-dependence of < |Vx| > averaged over j ; the ﬁt (in red, excluding the ﬁrst bin) is linear, with a slope of −0.12 km s−1 per arcsecond.
Right: j -dependence of < Vx > averaged over R; the ﬁt (in red) is a sine wave of amplitude 0.92 km s−1 and phase of 6◦.

Figure 8. RS Cnc. From left to right: dependence on y of the quantity c 2y deﬁned in Section 2.3.5; the ﬁt is a 4th degree polynomial;
dependence on q of the best ﬁt c 2 normalized to its minimal value; P-V diagram, j vs Vx; dependence of the best ﬁt c 2 (in percent excess
with respect to its minimal value) on the rotation velocity.

are strongly correlated with q . The P-V diagram displayed
in Figure 8, j vs Vx, shows arcs near Vx = 0 and at |Vx| > 4
km s−1 in phase opposition at a same value of j , namely
populating both positive and negative Doppler velocity in-
tervals, showing that one is dealing with expansion rather
than with rotation. Moreover, the absence of signiﬁcant fea-
tures in quadrature, i.e. shifted in phase by ±90◦ with re-
spect to these arcs, indicate that a possible contribution of
rotation, if present, must be quite small. The asymmetry pa-
rameter A(j ), also shown in Figure 8, reaches minimal val-
ues at the 10% level around j = 0◦ and j = 180◦ where the
contribution of pure expansion cancels. To better quantify a
possible contribution of rotation, we use the model described
in Hoai et al. (2014) and Nhung et al. (2015). We allow for
a rotation velocity having a Gaussian dependence on sina ,
the sine of stellar latitude, and decreasing with distance as
a power of r. Calling Vrot the equatorial rotation velocity at
r = 1′′, s rot the s of the Gaussian and nrot the power in-
dex, we obtain a best ﬁt for Vrot = 0.4 km s−1, s rot = 0.3′′
and nrot = −1.0. The only other parameters allowed to vary
in the ﬁt are the values of the radial expansion velocities.
Then, ﬁxing s rot and nrot at their best ﬁt values, we obtain
the dependence of the best ﬁt c 2 on Vrot displayed in Fig-
ure 8, suggesting that a rotation velocity of up to ∼1 km s−1
at r = 1′′ could be accommodated by the data.

3.2 The q = 0 case: EP Aquarii

EP Aqr is a textbook case of an AGB star having its axis
nearly parallel to the line of sight. Its CO(1-0) and CO(2-1)
emissions have been previously analysed both in terms
of spherical winds and of bipolar outﬂows (Winters et al.
2007; Nhung et al. 2015). We refer the reader to the re-
spective analyses and, as in the case of RS Cnc, we limit
the present discussion to issues that are of direct relevance
to the considerations developed in the previous sections, in
particular aiming at a uniﬁed picture of the former very dif-
ferent analyses. Figure 9 shows the CO(2-1) P-V diagram
in the j vs Vx plane and its projection on the Doppler ve-
locity axis. As expected, it is typical of a star having its
axis parallel to the line of sight. The dependence on both
R and j
of the measured ﬂux multiplied by R is domi-
nated by important inhomogeneities that extend up to large
radii. The R-dependence is steeper for CO(2-1) than for
CO(1-0) as expected, with respective power indices −1.2
and −0.9. The sky maps of the mean Doppler velocity dis-
play a small north-west/south-east asymmetry, interpreted
by Nhung et al. (2015) as resulting from the small inclina-
tion of the star axis on the line of sight.

In the q = 0 approximation the stellar longitude w

is
equal to the sky position angle j of the pixel and the stel-
lar latitude a
is related to x by the relation x = R tana .
The relation f (R,j ,Vx)dVx = r (r,a ,w )dx can then be dealt
with in each j = w
interval separately. As rotation cannot

MNRAS 000, 1–18 (2016)

9

Figure 9. EP Aqr, from left to right: P-V diagrams in the j vs Vx plane of the CO(2-1) data; its projection of the Vx axis; dependence
on j of r ∗0 (centre right) and n∗ (right) for CO(1-0) (red) and CO(2-1) (blue) observations.

be detected, we assume a radial wind of velocity Vrad . Us-
ing the relations Vx = Vrad sina , x = r sina and R = r cosa ,
one can associate in each pixel a value of x to each value
of Vx if we know Vrad: x is solution of the equation rVx =
√x2 + R2Vx = xVrad , namely x =
Vx√V 2
R; knowing x one also
knows r = √x2 + R2 and sina = x/r.

rad−V 2

x

An estimate of the eﬀective density averaged over stel-
lar latitude (corresponding to spherical symmetry of the ef-
fective density), r ∗(r), can be obtained from the ﬂux mea-
sured in each pixel, F(y, z) = R r (r,a ,w )dx. In each j = w
interval, one obtains r ∗(r) by solving the integral equation
F(R) = R r ∗(r)dx = 2R r ∗(r)r(r2 − R2)−1/2dr, where the sec-
ond integral runs from R to 13′′, the mean distance at which
CO molecules are UV-dissociated. Assuming in each j bin
a form r ∗(r) = r ∗0 r−n∗ , good ﬁts are obtained and the de-
pendence on j of r ∗0 and n∗ is displayed in the right pan-
els of Figure 9. The r-dependence of the eﬀective density is
steeper for CO(2-1) than for CO(1-0) and its slope reaches
a maximum in the north direction for both lines. The re-
lation f (R,j ,Vx)D Vx = r (r,a ,w )D x where D x is the x interval
spanned by a velocity bin D Vx can then be used in each (R,j )
bin to evaluate the radial expansion velocity, Vrad , as a func-
tion of x in the approximation where the eﬀective density
is taken in each j bin equal to r ∗0 r−n∗ as evaluated in the
previous paragraph. For the purpose of illustration, we do
so over the whole j range but it can as well be done in each
j bin separately when the data are of suﬃcient quality. In
order to exclude the equatorial region, where the evaluation
of Vrad is less reliable, we limit the stellar latitude to the
range |sina | > 0.3 (|a | > 17.5◦), with the eﬀect of exclud-
ing low values of r (typically smaller than 0.8′′). Figure 10
shows the resulting distribution of Vrad , averaged over j , in
the stellar meridian plane. It gives evidence for a strong po-
lar enhancement, at variance with a weak radial dependence
up to r ∼ 8′′. It provides a uniﬁed picture of the two models
that have been proposed earlier, the model of Winters et al.
(2007) corresponding to Vrad dependent on r but independent
on a , that of Nhung et al. (2015) corresponding to Vrad de-
pendent on a but independent on r. The projections of the
Vrad distributions on the sina and log10(2r) axes illustrate
the preference for the latter over the former.

MNRAS 000, 1–18 (2016)

3.3 The radial expansion representation

x(V 2

rad−V 2
x )
r2Vx

rad−V 2

The analysis presented in the preceding section can be
it is always possible to cal-
applied to any observation:
culate, given a value of Vrad,
for each pixel and each
Doppler velocity, the quantity x =
R and ob-

Vx√V 2
x
tain this way a 3-D representation of
the observa-
tion, with each point (x, y, z) given an eﬀective density
r (x, y, z) = f (y, z,Vx)dVx/dx =
f (y, z,Vx). Such a rep-
resentation will have something to do with reality if the
kinematics is indeed dominated by a radial expansion with
constant velocity Vrad . In practical cases, this may often be
approximately the case, at least locally in some domain of
the (y, z,Vx) space. In such cases, it is usually possible to
have an estimate of the range in which Vrad may reasonably
fall (clearly, Vrad must exceed |Vx|). It is then useful to have
some idea of the distortion implied by the adopted repre-
sentation. When Vx approaches Vrad , x goes to inﬁnity and
r (x, y, z)r2, and a fortiori r (x, y, z), cancel. The representation
becomes meaningless in this case: obviously, if there is no ex-
pansion to start with, there is no chance to learn about the
morphology. However, when Vrad exceeds |Vx| signiﬁcantly,
the representation is well behaved and the topology is con-
served: a detached shell remains a detached shell, an iso-
lated clump remains an isolated clump, a cavity remains
a cavity. While such a representation must be interpreted
with care, remembering that it is ill-behaved when |Vx| ap-
proaches Vrad , and keeping in mind the possible presence of
important distortions, it provides a convenient 3-D visualiza-
tion of the morphology, particularly useful in complex cases.
Such an example is illustrated in Figure 11, displaying maps
of the eﬀective density of Mira Ceti in (x , z) planes, with
x = px2 + y2, for various values of the angle w between the

plane and the y axis. It shows clearly the presence of arcs of
detached shells.

3.4 The q = 90◦ case: the Red Rectangle
The Red Rectangle is a post-AGB star that has been ex-
tensively studied at optical, infrared and far infrared wave-
lengths. Its CO emission has been recently analysed along
the lines presented in the present paper using ALMA data
(Tuan-Anh et al. 2015). It has its axis nearly parallel to
the sky plane and displays density and velocity conﬁgu-
rations similar to case B considered in the preceding sec-

10

P.N. Diep et al.

Figure 10. EP Aqr. Distribution of the radial expansion velocity Vrad, averaged over j . Left: in the (log10(2r),sina ) plane for CO(1-0)
and CO(2-1); the vertical log scale spans from r = 0.5′′ to r = 15.8′′. Right: as a function of sina
(centre right) and log10(2r) (extreme
right) for CO(1-0) (red) and CO(2-1) (blue).

Figure 11. Western (left) and eastern (right) outﬂows of the central part of the CSE of Mira Ceti: maps of the eﬀective density
reconstructed in space under the assumption of a pure radial expansion at constant velocity of 7 km s−1. The ordinate is z and the
abscissa is x =px2 + y2. Each panel is for a 10◦ wide interval of w measured clockwise from the y axis. The label in each panel gives the
value of w at the centre of the interval.

tions: two distinct regions with a rather sharp separation
between them, a conical bipolar outﬂow and a rotating
equatorial volume. We refer the reader to Tuan-Anh et al.
(2015) for details and limit our comments to a brief sum-
mary of the main results. In the q = 90◦ approximation, the
is related to z by the relation z = r sina
stellar latitude a
and the stellar longitude w
is related to y by the rela-
tion y = r cosa cosw . Rather than dealing with independent
j = w
intervals as in the preceding section, we deal in-
stead with independent z intervals. Namely, in each pixel,
once we know x we know sina = z/√x2 + R2 and tanw = x/y.
The measured ﬂux is F(y, z) = R r (x, y, z)dx: the eﬀective den-
sity expressed as a function of r and sina can be obtained
from this integral equation if we assume that it is invari-
ant under rotation about the star axis. Then, one can write

F(y, z) =R r (r,sina )dx = 2R r (r, z/r)r(r2−R2)−1/2dr and solve

the integral equation. As two diﬀerent CO lines have been
observed, CO(6-5) and CO(3-2), it is possible to disentan-
gle the eﬀects of temperature and density as shown in Fig-
ure 12, which displays also the result of an analysis of the
wind kinematics, using a model inspired from the observed
morphology.

3.5 Protostar L1527 IRS

Many considerations developed in the present article may
in fact have applications in a much broader context. We
illustrate this point in the present sub-section with the
example of a young protostar, L1527 IRS. It is in its
earliest stages of star formation, with a CSE of about one
solar mass, and has been recently observed by Tobin et al.
(2012) in the continuum (1.3 and 3.4 mm wavelength)
and on the 13CO(2-1) line at the Submillimeter Array
(SMA) and the Combined Array for Research in Millimeter
Astronomy (CARMA). Observations of the 18CO(2-1) line
made at ALMA have been reported by Ohashi et al. (2014).
All above observations have established the presence of
in-falling gas onto a rotating disk surrounding the protostar
and having its axis close to the y axis. Here, we use ALMA
observations (2012.1.00647.S) of the 18CO(2-1) line having
a slightly better spatial resolution than those used by
Ohashi et al. (2014). As the axis of the rotating disk is very
close to the y axis, we redeﬁne f (y, z,Vx) as east-west sym-
metrized ﬂux densities, 1
2 [ f (y, z,Vx) + f (−y, z,Vx)]. Figure 13
displays maps of the integrated ﬂux F, redeﬁned this way,

MNRAS 000, 1–18 (2016)

β =3.5

β =2.5

β =0.8

β =0.3

2.0

1.5

1.0

0.5

0.0

−0.5

−1.0

−1.5

)
c
e
s
c
r
a
(
 
z

0.0

0.5

1.0

1.5

2.0

ξ (arcsec)

280

240

200

160

120

80

40

0

2.0

1.5

1.0

0.5

0.0

−0.5

−1.0

−1.5

)
c
e
s
c
r
a
(
 
z

0.0

0.5

1.0

1.5

2.0

ξ (arcsec)

30

24

18

12

6

0

Vout

z

z

ξ =z2 /β

ξ

11

y

Vrot

ω

x

ξ

Vrad

η

Figure 12. Red Rectangle. Left panels: maps in the half-meridian plane of the star of temperatures (extreme left) and CO density
(centre left, in molecules per cm3) multiplied by r2 (in arcsecond2). Right panels: wind velocity projected on the meridian plane (centre
right) and the equatorial plane (extreme right). In the polar region the gas velocity Vout is conﬁned to meridian planes and tangent to
parabolas of equation z2 = bx
. Right: In the equatorial region the gas velocity is conﬁned to planes parallel to the equatorial plane and
tangent to hyperbolic spirals with a constant radial component Vrad and a rotation velocity Vrot having a power law dependence on r.

Figure 13. Protostar L1527: Sky maps of F (extreme left panel), of < Vx > (centre left panel), of Frot (centre right panel) and Ff all
(extreme right panel).

and of the mean Doppler velocity < Vx >. They are domi-
nated by rotation, red-shifted north and blue-shifted south.
In the case of pure rotation about the y axis, we expect
f (y, z,Vx) = f (y,−z,−Vx) to cancel for zVx < 0. As a result,
frot(y, z,Vx) = | f (y, z,Vx)− f (y,−z,Vx)| is equal to f (y, z,Vx).
On the contrary, in the case of pure in-fall, frot(y, z,Vx) = 0.
We may then deﬁne f f all (y, z,Vx) = f (y, z,Vx)− frot(y, z,Vx) as
a measure of the amount of ﬂux density associated with
in-fall. Maps of Frot and Ff all are displayed in Figure 13.
The map of Frot reveals the shape of the rotating CSE in
the northern and southern hemispheres and Ff all, much
smaller than Frot, displays a clear enhancement of the
in-falling ﬂux along the diagonals of the map, in conformity
with what is expected from accretion onto a ﬂared disk.
When swapping the y and z axes, the present situation is
reminiscent of the Red Rectangle, the diﬀerence being that
here rotation and in-fall combine everywhere while in the
Red Rectangle case rotation and expansion are conﬁned
to diﬀerent stellar latitudes. As in the Red Rectangle
case, the eﬀective density can be calculated in space by
solving the relevant integral equation and the kinematics
can be estimated assuming power law dependences of the
rotation and in-fall velocities on r. A signiﬁcant diﬀerence
between protostars and evolved stars is that the former are

MNRAS 000, 1–18 (2016)

embedded from the beginning into dense clouds from which
they build their CSE, while the latter build their CSE
from their own atmosphere; as a result the observation of
protostar CSEs is subject to absorption complications that
are absent from the observations of the CSEs of evolved
stars. This is the case here where the Doppler velocities
nearing the star systemic velocity are completely obscured.
A detailed analysis of the consequences is beyond the scope
of the present sub-section, the only purpose of which is to
illustrate the very strong similarities between the studies
of expanding CSEs of evolved stars and in-falling CSEs of
protostars.

3.6 Multi-line observations

Many observations are not limited to a single molecular line,
but often include ﬂux densities associated with two or more
diﬀerent lines of a same molecule, for example two rotation
lines of carbon dioxide. In such cases, very precious infor-
mation is carried by the ratio of the measured ﬂux densities.
In making such a ratio, the gas density drops out and the
emission probabilities are well known: if absorption can be
neglected, the ratio of the ﬂux densities is a direct measure
of the relative population of the emitting quantum states,

12

P.N. Diep et al.

namely a direct measure of temperature. In many cases, the
distance from the star is large enough for absorption to be
small, but in any case the study of the line ratio provides
very important information: it measures the temperature
when absorption can be neglected and when the gas is in
thermal equilibrium and has been in such a state for a long
time, but if such hypotheses are not valid, it carries infor-
mation about the importance and nature of their violation.
Making good use of multi-line observations should not be
limited to mapping the ﬂux ratio measured in each pixel:
in principle, the comparison between the observed lines can
– and should – be extended to any other quantity that has
been used in the analysis.

3.7 Asymmetries

In practice, real stars are often very far from obeying the ax-
ial symmetry assumed in the present article. A much more
lumpy landscape is often to be expected. As a result, two
diﬀerent issues need to be considered: one is to which extent
does this impact on the value and interest of a description
that assumes axial symmetry; the other is to which extent
deviations from the model can be used to describe real-
ity. While the answer to such questions is bound to carry
some subjectivity, an essential preliminary consideration is
to evaluate quantitatively the importance of the observed
deviations.

any
can

model,
directly

be

Independently

from
symmetry

deviations
from central
evalu-
ated from the asymmetry parameter Acntr(y, z,Vx) =
[ f (y, z,Vx)− f (−y,−z,−Vx)]/[ f (y, z,Vx) + f (−y,−z,−Vx)]. Sky
maps and P-V diagrams of this quantity tell both the
importance and the nature of the observed deviations: they
may be distributed more or less randomly in y, z and Vx
or be concentrated in well-deﬁned lumps. A systematic
study of this asymmetry is an important complement to
the studies described in the previous sections.

Revealing deviations from rotation invariance about the
star axis cannot be done so directly. Partial information is
contained in the symmetry – or lack of – about the z axis
(or z′ axis if y diﬀers from 0) but extracting the full infor-
mation requires a detailed analysis of the dependence of c 2
on the star longitude (which is known in the model but un-
known in the data). The outstanding quality of ALMA data
allows for evaluating such a c 2 much more reliably than was
previously possible. Ideally, if the quality of the data would
allow for a reliable evaluation of measurement uncertainties
one could work in the uv plane and evaluate the degree of
conﬁdence attached to the ﬁts and the uncertainties and cor-
relation coeﬃcients attached to each of the model parame-
ters in units of standard deviations. In general, however, one
is far from such a situation. Even under ideal conditions, a
signiﬁcant lumpiness of the observed ﬂuxes usually prevents
a very faithful description, the model being at best a crude
approximation of reality. As a result, the best ﬁt values of c 2
signiﬁcantly exceed the number of degrees of freedom and
one must rely on subjective arguments to obtain a sensible
evaluation of the uncertainties attached to each of the model
parameters.

4 SUMMARY AND CONCLUSION

The aim of the present work is to help constructing 3-D
models of the CSE of axisymmetric radio sources, essentially
evolved stars or protostars. It does not have the pretension
to give recipes, not even strict guidelines. Each star is a
particular case: before starting modelling its CSE, one must
ﬁrst take into account the information available, optical, in-
frared or radio, and the physics considerations that are of
relevance. In the present section, we summarize the results
obtained in the preceding sections.

A number of preliminary points should be systemati-
cally examined before undertaking any modelling: they im-
ply having a ﬁrst close look at the data without requiring
the help of a model. In particular the sky maps of RF(y, z), of
< Vx > and of < |Vx| > and their projections on the R and j
axes provide essential information. In addition to obtaining
a global evaluation of the steepness of the decrease with r of
the eﬀective density, one learns from them to which extent
central symmetry is obeyed; whether there is any evidence
for the eﬀective density to depart from spherical symme-
try; whether axial symmetry is revealed on the < Vx > map;
whether there is evidence for signiﬁcant velocity gradients.
In a spirit of minimizing qualitative arguments and
quantifying as much as possible the results of the analy-
sis, use should be made of simple quantities that carry im-
portant information. Examples have been given, such as c 2y
and A(j ), which help the evaluations of the orientation of
the star axis in space and of the relative contributions of
expansion along the star axis and rotation about it. They
are not unique, other indicators and discriminators may be
found better adapted to such and such a particular case.

Particular attention must be given to correlations be-
tween model parameters, such as between the inclination of
the star axis on the line of sight, q , and the elongation of the
eﬀective density and/or the wind velocity distribution along
the star axis. If a c 2 minimization method is used to adjust
the model parameters, one should look at the dependence of
c 2 on q , leaving all other parameters free to vary.

As well known from the practice of such studies, P-V
diagrams carry very precious information. However, we have
argued that using polar rather than Cartesian coordinates
in the sky plane is often better suited to making the best
of them. In particular, the j vs Vx diagrams have the ad-
vantage of being simply translated along the j axis when y
is varied, a useful feature when y
is not known with preci-
sion, and their symmetry properties tell about the relative
purity – or lack of – of expansion vs rotation. One must
keep in mind that when expansion and rotation contribute
signiﬁcantly to the wind velocity in a same region of space,
causing spiralling, the determination of the star axis is diﬃ-
cult, the apparent star axis being biased toward the normal
to the spiral trajectories. However, when expansion and ro-
tation contribute signiﬁcantly in diﬀerent regions of space,
this comment does not apply and their contributions to the
P-V diagrams are simply superimposed.

The above arguments, as important as they may be, are
not suﬃcient to construct a model. Physics considerations
must also be taken in due account. While a precise hydro-
dynamic description is well beyond the scope of the present
considerations, some of its most obvious features must be
kept in mind when deciding on the form given to the eﬀec-

MNRAS 000, 1–18 (2016)

tive density and velocities. In particular the validity of the
stationarity hypothesis needs to be critically discussed.

The concrete examples that have been given as illus-
trations of the above arguments have contributed new re-
sults to earlier analyses of the CO emission of the CSE of
AGB stars. The study of RS Cnc has given an opportunity
to comment on the hypothesis of stationarity of the wind
regime and on a possible rotation of the equatorial volume
about the star axis. In both cases, limits have been given
to their possible contributions. In the case of EP Aqr, a
picture has been drawn that uniﬁes two models proposed
earlier, one with isotropic but r-dependent winds, the other
with a bipolar outﬂow. Evidence has been given in favour
of the latter. Results obtained in the case of the post-AGB
Red Rectangle have been brieﬂy recalled. Using Mira Cetti
as an example, we have commented about the value of con-
structing, at least locally, a 3-D representation under the
hypothesis of radial expension at constant velocity. Such a
representation is particularly useful to visualise the topology
of the eﬀective density and reveal the presence of possible
detached arcs, cavities, or isolated lumps. Finally, the exam-
ple of a protostar, L1527, has been used to underline very
strong similarities between the expanding CSEs of evolved
stars and the in-falling CSEs of protostars.

ACKNOWLEDGEMENTS

We are indebted and very grateful to the ALMA part-
nership, who are making their data available to the pub-
lic after a one year period of exclusive property, an ini-
tiative that means invaluable support and encouragement
for Vietnamese astrophysics. We particularly acknowledge
friendly and patient support from the staﬀ of the ALMA
Helpdesk. This paper makes use of the following ALMA
data: ADS/JAO.ALMA# 2011.0.00223.S, 2012.1.00524.S,
2013.1.00047.S, 2012.1.00647.S. ALMA is a partnership of
ESO (representing its member states), NSF (USA) and
NINS (Japan), together with NRC (Canada), NSC and
ASIAA (Taiwan), and KASI (Republic of Korea), in cooper-
ation with the Republic of Chile. The Joint ALMA Observa-
tory is operated by ESO, AUI/NRAO and NAOJ. The paper
makes also use of observations carried out with the IRAM
Plateau de Bure Interferometer and the IRAM 30-m tele-
scope. IRAM is supported by INSU/CNRS (France), MPG
(Germany) and IGN (Spain). We express our deepest grat-
itude to Professors Anne Dutrey, Stephane Guilloteau and
Thibaut Le Bertre for the support, the interest in our work,
and for very useful comments on the present manuscript.
Financial support is acknowledged from VNSC/VAST, the
NAFOSTED funding agency, the World Laboratory, the
Odon Vallet Foundation and the Rencontres du Viet Nam.

REFERENCES

Hoai, D. T., et al. 2014, A&A, 565, A54
Nhung, P. T., et al. 2015a, RAA, 15, 5
Nhung, P. T., et al. 2015b, A&A, 583, A64
Ohashi, N., et al., 2014, ApJ, 796, 131
Tobin, J.J., et al. 2012, Nature, 492/7427, 83
Tuan-Anh, P., et al. 2015, RAA, Vol.15, No.12, 2213
Winters, J. M., et al. 2007, A&A, 475, 559

MNRAS 000, 1–18 (2016)

13

APPENDIX A:

A1 Transformation relations between space and

star coordinates

The star axis projects on z′, the transformed of z, on the sky
(y, z) plane. In (x, y, z) coordinates, the star axis is a vector
(cosq ,sinq siny ,sinq cosy ). For y = 0, the star axis projects
on z on the sky plane, for q = 0 it is along x. The (x, y, z) to
(x ,h ,z ) transformation relations read:

(A1)

x = x cosq + zsinq cosy − ysinq siny
h = zsiny + ycos y
z = −x sinq + zcosq cosy − ycos q siny
r = px2 + y2 + z2

We deﬁne

and R = py2 + z2,
¶ r/¶ x = x/r and write y = R cosj and z = R sinj . A point in
the star frame having latitude a (positive along x ) and longi-
is deﬁned as (x ,h ,z ) = r(sina ,cos a cosw ,cos a sinw )
tude w
with −p /2 < a < p /2 and −p < w < p . On the equator
(w = 0) the zero of longitude is along h = y′.
Hence the transformation relations between (x, y, z) and
(r,a ,w ) read:

x
R

(A2)

x = r(sina cosq − cos a sinw sinq )
R cos(j − y ) = r cosa cosw
R sin(j − y ) = r(sina sinq + cos a sinw cosq )
sinq + sin(j − y )cos q ,cos(j − y )]
w = atan[−
a = asin{[x cosq + R sin(j − y )sinq ]/px2 + R2}
r = pR2 + x2
Setting y = 0, a point (x ,h ,z ) = (b, a× cosw , a× sinw ),
with a and b constant, projects on (y, z) in the sky plane.
In the meridian plane of the star, it is a ﬁxed point at
(a = r cosa , b = r sina ). In the sky plane, ( y
and a2 − ( z−bsinq
cosq

a×cosq )2 = 1
)2 = y2. Namely pixel (y, z) spans an hyper-
bola in the meridian plane of the star, while the point (a, b)
spans an ellipse in the sky plane (Figure A1).

a )2 +( z−bsinq

A2 Eﬀective density, wind velocity and their

symmetries

Under the hypothesis of rotation invariance about the star
axis, Vrad, Vax and Vrot are functions of r and sina exclusively,
independent of w . Moreover, under the additional hypothesis
of central symmetry, or equivalently of reﬂexion symmetry
about the equatorial plane, Vrad and Vrot are even functions
and Vax an odd function of sina . It is useful to deﬁne two
symmetry operations: S1 changing x in −x and z in −z but
leaving y invariant and S2 changing y in −y but leaving x
and z invariant. Table A1 summarizes symmetry properties
of several quantities assuming rotational invariance about
the star axis, central symmetry (or equivalently north-south
symmetry with respect to the equator of the star) and y = 0.
One may then rewrite the Doppler velocity as the sum of an
expansion and a rotation components: Vx = Vx1 + Vx2 with
Vx1 = (x/r)Vrad + cosq Vax and Vx2 = −
Vrot. One
sees from Table A1 that, for y = 0, Vx1 is odd under S1 and
even under S2 while Vx2 is even under S1 and odd under S2.

R cos(j −y )sinq

r cosa

14

P.N. Diep et al.

Figure A1. Left: Ellipse spanned in the sky plane by a ﬁxed point (a,b) in the meridian plane. Right: hyperbola spanned in the meridian
plane by a ﬁxed point (y,z) in the sky plane.

Table A1. Symmetry properties of several quantities under
transformations S1 and S2 for y = 0 under the hypothesis of rota-
tional invariance and central symmetry in the star frame.

S1
−x
y
−z
r
R

−j
−a
r
Vrad
-Vax
Vrot
−Vx1
Vx2

S2

x
−y
z
r
R

p − j
a
r

Vrad
Vax
Vrot
Vx1
−Vx2

S1 × S2
−x
−y
−z
r
R
p + j
−a
Vrad
-Vax
Vrot
−Vx1
−Vx2

r

x
y
z
r
R
j
a
r
Vrad
Vax
Vrot
Vx1
Vx2

However, when the value of y diﬀers from zero, this is no
longer true and maps of < Vx >, < V 2
x > or, for that matter,
any other moment, do not reveal the position of the star
axis: their symmetry properties depend on both the value of
y and the relative importance of rotation and expansion.

A3 P-V diagrams
Setting y = 0, from the coordinate transformation relations
between the star frame and the sky frame we obtain an im-
portant relation (Figure A2) between the star latitude a and
x,
r sina = x cosq + zsinq

(A3)

For a given pixel, once we know x, we also know
r = √x2 + R2 and a
from the above relation: we can calcu-
late the eﬀective density and the gas velocity, and there-
fore the ﬂux density f (y, z,Vx) = r (x, y, z)dx/dVx. The depen-
dence of the Doppler velocity on x is given by the relation
rVx = xVrad − ysinq

cosa Vrot where Vax has been set to zero.

A4 Velocity spectra

In the case of pure rotation,
the
form that

setting Vrot = V0 cosa ,
spectral distribution takes a particularly simple
illustrates well what happens: dN/dVx =
r2R−1r (r)[(cosj sinq V0)2−V 2
x ]−1/2. Namely, the spectral dis-
increases from its value at Vx = 0 to
tribution dN/dVx
inﬁnity at the value Vmax = cosj sinq V0, with dN/dVx ∼
x )−1/2 ∼ (2Vmax)−1/2(Vmax −Vx)−1/2. For case A, the
max −V 2
(V 2
same qualitative behaviour is obtained: the main diﬀerence
is that Vrot being now smaller in the equatorial region, the
amplitude of the j oscillations is also smaller. Finally, in
case B, one is either inside the cone, in which case Vrot = 0,
or outside, in which case Vrot = V0 and Vx = − R cosj sinq
V0.
Outside the cone, |Vx| reaches its maximal values V0 for
|y|sinq = r cosa and, as cosa > 1/√2, R|cosj |sinq /r > 1/√2,
namely r = R (x = 0) and cos2 j sin2 q > 1/2. Indeed, for pure
rotation in case B, the j oscillation of the extreme Vx val-
ues stays ﬂat at maximum as long as cosj > 1/(√2 sinq ). In
particular, at q = 90◦, this happens over ±45◦ around j = 0
(mod p ). A ﬂat can only be seen if sin2 q > 1/2, meaning
q > 45◦.
In the case of pure expansion, when the bipolar out-
ﬂow is conﬁned inside a cone of latitude a 0, nothing changes
inside the cone but the gas velocity, and therefore Vx, can-
cel outside the cone. The cone splits space in two regions,
its interior and its exterior. On the sky plane, the limit is

r cosa

given by the relation cosj lim = tanb 0/tanq with b 0 = p /2−a 0
measuring the aperture of the cone. Note that any value of
j can be associated with a point outside the cone while only
values of j > j lim can be associated with regions inside the
cone. For j > j lim one has therefore Vx = 0. This happens
only if cosj lim < 1, namely q > b 0. For smaller values of q
the interior of the cone covers the full sky plane. In general
(Figure A3) the spectrum retains therefore the general form
(V 2
x )−3/2 but is conﬁned to an interval smaller than the
0 −V 2
maximum interval [−V0,V0].

A5 Evaluating the value of y
We deﬁne a quantity c 2y as c 2y = c 2y exp + c 2y rot where

MNRAS 000, 1–18 (2016)

15

for sinj < 0 are obtained by symmetry about the origin. When x → −¥

Figure A2. Distributions of sina = (ucos q + sinj sinq )/√1 + u2 vs u = x/R. Each panel is for a ﬁxed value of q and in each panel, from
down to up, j varies as 0◦, 30◦, 45◦, 60◦ and 90◦. The last panel also includes the case q = 0◦ for which sina
is independent from j . Values
of sina
, sina → −cosq ; then, for sinj > 0, when x increases, so does
tanq . Then, it keeps increasing and crosses the value cosq when u = (cos2q + sin2 q cos2 j )/(sin 2q sinj ).
sina until it reaches 0 for u = −sinj
For u = sinj /tan q , it reaches its maximum, sinj /p1− cos2 q cos2 j . In particular, when sinj = ±1 (z axis) it reaches the poles (sina = ±1)
, sina → cosq . For q = 0, sina = u/√1 + u2 is independent of j . For q = p /2,
at u = ±1/tan q . It then decreases slowly and for x → +¥
sina = sinj /√1 + u2. For q = p /4, sina = (u + sinj )/p2(1 + u2). For u = 0, sina = sinj sinq . For sinj = 0, sina = ucosq /√1 + u2 and for
sinj = ±1, sina = (ucosq ± sinq )/√1 + u2.

Figure A3. Conical bipolar outﬂow projected on the (x,z) plane (left) and the sky plane (right).

c 2y exp = (cid:229)

exp{[ f (y, z,Vx)− f (y,0,Vx)]

− [ f (y,−z,−Vx)− f (y,0,−Vx)]}2/D 2

c 2y rot = (cid:229)

rot{[ f (y, z,Vx)− f (0, z,Vx)]

The sum (cid:229)

− [ f (−y, z,−Vx)− f (0, z,−Vx)]}2/D 2.
exp runs over pixels (y, z) located just a bit
north of the y axis (z > 0 and small) and the sum (cid:229)
rot over
pixels (y, z) located just a bit east of the z axis (y > 0 and
small). In addition, both sums run over the whole veloc-
ity spectrum. In each square bracket, the subtraction of the
ﬂux density measured on the axis, rotation on the y axis
and expansion on the z axis, leaves us with the contribution
that changes sign under reﬂection about the axis, expansion
about the y axis and rotation about the z axis. Therefore, if
the z axis is the projection on the sky plane of the star axis,
c 2y nearly cancels when subtracting the two square brackets

MNRAS 000, 1–18 (2016)

from each other. The value of y associated with the star
axis is therefore expected to be that for which the quantity
c 2y , calculated for ﬂux densities rotated by y about the ori-
gin on the sky map, reaches a minimum. The quantities D
stand for the uncertainties attached to the measured ﬂux
densities. Figure 6 uses for D
the square root of the sum of
the four ﬂux densities appearing in the two square brack-
ets of the relevant sum (which would be proper for purely
statistical uncertainties). Figure A4 illustrates further the
diﬃculty of evaluating the proper value of y
in the mixed
case. It is drawn for q = 45◦ and for Vrad = V0 cos q sin2 a
and Vrot = V0 sin q cos2 a
for diﬀerent values of q, namely of
the relative importance of rotation vs expansion. The mini-
mum is generally very shallow and in one case, q = 20◦, it is
oﬀ by ∼ 5◦. Better indicators than c 2y may possibly be con-
ceived, but they will always reveal the diﬃculty of measur-
ing y when rotation and expansion compete for inclinations
around q = 45◦.

16

P.N. Diep et al.

Figure A4. Distributions of c 2y as a function of y
for case A and q = 45◦. The left panel is for pure expansion (q = 0, red) or pure
rotation (q = 90◦, blue). The middle and right panels are for mixed expansion and rotation, their relative importance being measured by
the angle q (see text) with values of 20◦ (red), 30◦ (blue) and 40◦ (black) in the middle panel, 50◦ (red), 60◦ (blue) and 70◦ (black) in
the right panel. The projection of the star axis on the sky plane is at y = 0.

A6 Telling rotation from expansion

Hence, writing Aas = S+−S−
S++S−

Assuming −Vrot > 0 and writing S±(y, z) = (cid:229)
±|Vx| f (y, z,Vx)
where the sum extends over ±Vx > 0, we have for pure rota-
tion
S+(y,±z) = S0; S−(y,±z) = 0; S+(−y,±z) = 0; S−(−y,±z) = S0;
and for pure radial expansion
S+(±y, z) = S1; S−(±y, z) = S2; S+(±y,−z) = S2; S−(±y,−z) = S1;
, |Aas(y,±z)| = 1 for pure ro-
tation while for pure radial expansion |Aas(±y, z)| = |S1−S2|
.
Averaging over R, A(j ) =< |Aas(R,j )| >= 1 for pure rotation
and A(j ) =< |S1−S2|
> for pure expansion, which cancels for
S1+S2
both q = 90◦ and q = 0◦ and is always smaller than unity. In
the case of pure rotation, A(j ) = 1 independently from both
j and q . The value of A(j ) at j = 0◦, j = 90◦ or its integral
over j
should therefore be good indicators of the relative
importance of rotation over expansion. However, as soon as
rotation is mixed with some expansion, even when the lat-
ter is isotropic, A(j ) starts departing from unity. Indeed,
in the present article, for example in Figure 3, we usually
considered expansion cancelling on the star equator. In re-
ality, even in the presence of a clear bipolar outﬂow, some
expansion may take place in the equatorial region. More-
over, the CSE may start its evolution with a small bipolar
outﬂow and no global expansion or, on the contrary, with
a small isotropic expansion. In the latter case, when the
bipolar outﬂow starts to emerge, it is but a small pertur-
bation to the isotropic expansion. We take this in consider-
ation by writing Vrad = V0(1 + l sin2 a ) and Vrot = m V0 cos2 a
(Vrot must cancel at the poles) and use an isotropic eﬀec-
tive density r = r 0/r2. The parameters l and m measure
the amount of respectively polar expansion and equatorial
rotation that add to the isotropic expansion. We ﬁnd that,

to a good approximation, A(90◦) = A(270◦) ∼ A90 sin 2q and
A(0◦) = A(180◦) ∼ A0 sinq with A90 independent of m
(the
cosj
factor in the contribution of rotation to Vx is the cause)
and A0 independent of l . Both A90 and A0 increase with re-
spectively l and m as shown in Figure A5.

S1+S2

Figure A5. Dependence of A0 on m (red) and of A90 on l (blue)
for y = 0 (left panel) and y = 45◦ (right panel).

of q . We choose q = 45◦ in order to maximize the eﬀect of
expansion and adjust m and l to have similar values of A(j ).
The associated P-V diagrams, shown in Figure A6, display
small but signiﬁcant diﬀerences. If, on the contrary, we ad-
just m and l to have similar eﬀects on the P-V diagrams, we
obtain much larger values of A(j ) in the l = 0 case (rota-
tion) than in the m = 0 case (expansion). Figure A7 displays
the Doppler velocity distributions obtained in this case on
the positive y and z axes. The small diﬀerences illustrate the
diﬃculty of telling expansion from rotation when they are
small perturbations to a global isotropic expansion.

A7 Inclination q of the star axis with respect to

the line of sight

We ﬁrst consider the dependence on q of the integrated ﬂux
F. Its partial derivative with respect to j , F′j (R,j ), is ex-
pected to be an indicator of q . Indeed, writing r (r,sina ) the
eﬀective density and using ¶ (sina )/¶j = (R/r)cosj sinq , we
obtain

F′j (R,j ) = R cosj sinq Z r ′sina (r,sina )

1
r

dx,

namely

The above considerations suggest comparing the P-V
diagrams of a l = 0 case with a m = 0 case for a same value

sinq = F′j (R,j )[R cosj Z r ′sina (r,sina )

1
r

dx]−1

MNRAS 000, 1–18 (2016)

17

Figure A6. Comparison of the eﬀect of a small rotation about the y axis (case 1, m = 0.25) with that of a bipolar expansion along the z
axis producing the same value of A(j ) (case 2, l = 0.6). Left panel: distributions of A(j ) for case 1 (blue) and case 2 (red). Middle and
right panels: P-V diagrams for cases 1 and 2 respectively.

Figure A7. Comparison of the eﬀect of a rotation about the y axis (case 1, m = 1) with that of a bipolar expansion along the z axis (case
2, l = 0.3) producing similar eﬀects on the P-V diagram. Left panel: distributions of A(j ). Middle and right panels: Doppler velocity
distributions obtained at j = 0 (y axis) and j = 90◦ (z axis) respectively. Black is for l = m = 0, blue for case 1 and red for case 2.

The dependence of F on j

is indeed an indicator of
sinq , however it requires the preliminary knowledge of the
dependence of the eﬀective density on the star latitude,
measured by r ′sina (r,sina ). It is not possible to evaluate q
independently from the elongation of the eﬀective density
along the star axis. Indeed, modelling the eﬀective density
as r = r 0(1 + l r sin2 a )r−2, gives:

F′j (R,j ) = R cosj sinq Z 2r 0l r sina 1

r

dx

= 2Rr 0l r cosj sinq Z (x cosq + zsinq )

1
r4 dx

The x term in the parenthesis does not contribute to

the integral and, writing u = dx/R,

F′j (R,j ) = 2yzr 0 l r sin2 q Z pu2 + 1du

= p yzr 0 l r sin2 q

Namely the dependence of the integrated ﬂux on j mea-
sures the product l r sin2 q : the inclination angle q of the star
axis on the line of sight cannot be measured from the map
of integrated ﬂuxes independently from the elongation l r of
the eﬀective density along the star axis. Qualitatively, this
result is expected to be always true. In the case of a spheri-
cally symmetric eﬀective density but axially symmetric wind

MNRAS 000, 1–18 (2016)

velocity, a similar result applies. It is best seen in the case B
of Section 2.3, which is particularly simple in this context.
As seen in Figure A3, changing q does not change the limits
on the sky plane of the expansion cone as long as the ra-
tio tanb 0/tanq
is kept constant. Using this prescription, one
may then readjust the values taken by the expansion and
rotation velocities in order to minimize the changes experi-
enced by the measured ﬂux densities. On the axis of the cone,
projected on the sky plane as the z axis, Vx = V0 cosq : keep-
ing this product constant will limit the eﬀect of changing
q to small variations of the limits of the velocity spectrum.
Similarly, outside the cone, the Doppler velocity varies be-
tween 0 on the z axis (y = 0) to V0 sinq : again, keeping this
product constant will limit the eﬀect of changing q to small
variations of the limits of the velocity spectrum.

In summary, when modelling the star with case B us-
ing ﬁve parameters y , q , b , Vexp and Vrot (Vexp inside the
cone and Vrot outside), very strong correlations aﬀect the
last four parameters leaving much arbitrariness in the value
of q . What we eﬀectively measure are the ratio tanb 0/tanq
and the products Vexp cosq and Vrot sinq . Qualitatively, as for
the eﬀective density, we measure the product of the inclina-
tion of the star axis on the line of sight by the elongation
of the expansion cone. Another evidence for this ambigu-
ity between inclination and elongation was obtained in Ap-
pendix A6 where A(j ) was found to include a factor l sinq .

18

P.N. Diep et al.

r nr−n,

A8 Radial dependence of the CSE properties
For y = 0,
we may write r (r,sina ) = (cid:229)
(cid:229) Fn(R,j ) with Fn(R,j ) = r nR (x2 + R2)− n
In = 2R (1 + u2)− n
and for n = 2, I2 = p .

in the case of a spherical eﬀective density,
implying F(R,j ) =
2 dx = r nR1−nIn and
2 du; here, the integral runs from 0 to +¥
Hence F′R(R,j ) = (cid:229) (1− n)R−nr nIn: the R-dependence of
the integrated ﬂux is simply related to the r-dependence of
the eﬀective density. In particular, in case of a pure power
law, r (r,sina ) = r nr−n, Rn−1F(R,j ) is a constant over the
sky plane.

If central symmetry is obeyed, the mean value of Vx
cancels. However, velocity gradients can be expected to show
up on the expression of the square or absolute value of Vx.
In the case of radial expansion and assuming a pure power
law dependence of the eﬀective density on r,

In < |Vx| > = Rn−1Z |x|Vradr−n−1dx

= 2Z uVrad (1 + u2)− 1
= Z Vradv− 1
2 (n+1)dv.

2 (n+1)du

In the absence of gradient, In < |Vx| >= 1

2 (n− 1)Vrad is
independent of R. In general, developing Vrad in powers of
r, the R-dependence of < |Vx| > depends simply on the r-
dependence of the expansion velocity.
r cosa Vrot and writing
Vrot = V0 cosa r−k, a form making the enhancement of rota-
tion in the equatorial region explicit, we obtain

In the case of pure rotation, Vx = ysinq

In < |Vx| > = ysinq Rn−1Z

1
cosa Vrotr−n−1dx

= ysinq V0Rn−1Z r−n−k−1dx
= cosj sinq V0R−k.

The R-dependence of < |Vx| > is the same as the r-

dependence of Vrot.

This paper has been typeset from a TEX/LATEX ﬁle prepared by
the author.

MNRAS 000, 1–18 (2016)

