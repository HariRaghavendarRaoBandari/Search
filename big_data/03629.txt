6
1
0
2

 
r
a

 

M
1
1

 
 
]
L
M

.
t
a
t
s
[
 
 

1
v
9
2
6
3
0

.

3
0
6
1
:
v
i
X
r
a

Square Root Graphical Models: Multivariate Generalizations of

Univariate Exponential Families that Permit Positive Dependencies

David I. Inouye, Pradeep Ravikumar, Inderjit S. Dhillon

University of Texas at Austin

{dinouye,pradeepr,inderjit}@cs.utexas.edu

Abstract

We develop a novel class of parametric graphical models, called Square Root Graphical Models (SQR), that pro-
vides multivariate generalizations of univariate exponential family distributions—e.g. discrete, Gaussian, exponential
and Poisson distributions. Previous multivariate graphical models (Yang et al., 2015) did not allow positive depen-
dencies for the exponential and Poisson generalizations. However, in many real-world datasets, variables clearly have
positive dependencies. For example, the airport delay time in New York—modeled as an exponential distribution—is
positively related to the delay time in Boston. With this motivation, we give an example of our model class de-
rived from the univariate exponential distribution that allows for almost arbitrary positive and negative dependencies
with only a mild condition on the parameter matrix—a condition akin to the positive deﬁniteness of the Gaussian
covariance matrix. Our Poisson generalization allows for both positive and negative dependencies without any con-
straints on the parameter values. We also develop parameter estimation methods using node-wise regressions with
(cid:96)1 regularization and likelihood approximation methods using sampling. Finally, we demonstrate our exponential
generalization on a dataset of airport delay times.

1 Introduction

Gaussian, binary and discrete undirected graphical models—or Markov Random Fields (MRF)—have become popular
for compactly modeling and studying the structural dependencies between high-dimensional continuous, binary and
categorical data respectively (Friedman et al., 2008; Hsieh et al., 2014; Banerjee et al., 2008; Ravikumar et al., 2010;
Jalali et al., 2010). However, real-world data does not often ﬁt the assumption that variables come from Gaussian
or discrete distributions. For example, word counts in documents are nonnegative integers with many zero values
and hence are more appropriately modeled by the Poisson distribution. Yet, an independent Poisson distribution
would be insufﬁcient because words are often either positively or negatively related to other words—e.g. the words
“machine” and “learning” would often co-occur together in ICML papers (positive dependency) whereas the words
“deep” and “kernel” would rarely co-occur since they usually refer to different topics (negative dependency). Thus,
a Poisson-like model that allows for dependencies between words is desirable. As another example, the delay times
at airports are nonnegative continuous values that are more closely modeled by an exponential distribution than a
Gaussian distribution but an independent exponential distribution is insufﬁcient because delays at different airports
are often related (and sometimes causally related)—e.g. if a ﬂight from Los Angeles, CA (LAX) to San Francisco,
CA (SFO) is delayed then it is likely that the return ﬂight of the same airplane will also be delayed. Other examples
of non-Gaussian and non-discrete data include high-throughput gene sequencing count data, crime statistics, website
visits, survival times, call times and delay times.

Though univariate distributions for these types of data have been studied quite extensively, multivariate general-
izations have only been given limited attention. One basic approach to forming dependent multivariate distributions
is to assume that the marginal distributions are exponentially distributed (Marshall & Olkin, 1967; Embrechts et al.,
2003) or Poisson distributed (Karlis, 2003). This idea is related to copula-based models (Bickel et al., 2009) in which
a probability distribution is decomposed into the univariate marginal distributions and a copula distribution on the unit
hypercube that models the dependency between variables. However, the exponential model in (Marshall & Olkin,

1

1967; Embrechts et al., 2003) gives rise to a distribution that is composed of a continuous distribution and a singular
distribution, which seems unusual and unlikely for general real-world situations. The multivariate Poisson distribution
(Karlis, 2003) is based on the sum of independent Poisson variables and can only model positive dependencies. The
copula versions of the multivariate Poisson distribution have signiﬁcant issues related to non-identiﬁability because
the Poisson distribution has a discrete domain (Genest & Neslehova, 2007). There has also been some recent work on
semi-parametric graphical models (Liu et al., 2009) that use Gaussian copulas to relax the assumption of Gaussianity
but these models are not parametric and only consider continuous real-valued data.

Another line of work assumes that the node conditional distributions—i.e. one variable given the values of all the
other variables—are univariate exponential families1 and determines under what conditions a joint distribution exists
that is consistent with these node conditional distributions. Besag (1974) developed this multivariate distribution for
pairwise dependencies and Yang et al. (2015) extended this model to n-wise dependencies. Yang et al. (2015) also
developed and analyzed an M-estimator based on (cid:96)1 regularized node-wise regressions to recover the graphical model
structure with high probability. Unfortunately, these models only allowed negative dependencies in the case of the
exponential and Poisson distributions. Yang et al. (2013) proposed three modiﬁcations to the original Poisson model
to allow positive dependencies but these modiﬁcations alter the Poisson base distribution or require the speciﬁcation of
unintuitive hyperparameters. Allen & Liu (2013) allowed positive dependencies by only requiring the Local Markov
property rather than a consistent joint distribution that would have Global Markov properties. In a different approach,
Inouye et al. (2015) altered the Poisson generalization by assuming the length of the vector is ﬁxed or known similar to
the multinomial distribution in which the number of trials is known. This allows a joint distribution that is decomposed
into the marginal distribution of vector length and the distribution of the vector direction given the length. While the
model in (Inouye et al., 2015) allowed for both positive and negative dependencies, the joint distribution needed to be
modiﬁed by an ad hoc scalar weighting function to avoid very low likelihood values for vectors of long length—i.e.
documents with many words.

Therefore, we develop a novel parametric generalization of univariate exponential family distributions with non-
negative sufﬁcient statistics—e.g. Gaussian, Poisson and exponential—that allows for both positive and negative
dependencies. We call this novel class of multivariate distributions Square Root Graphical Models (SQR) because
the square root function is fundamentally important as will be described in future sections. SQR models have a
simple parametric form without needing to specify any hyperparameters and can be ﬁt using (cid:96)1-regularized node-
wise regressions similar to previous work (Yang et al., 2015). The independent model—e.g. independent Poisson or
exponential—is merely a special case of this class unlike in (Yang et al., 2013). We show that the normalizability of
the distribution puts little to no restriction on the values of the parameters, and thus SQR models give a very ﬂexible
multivariate generalization of well-known univariate distributions.

Notation Let p and n denote the number of dimensions and number data instances respectively. We will generally
use uppercase letters for matrices (e.g. Φ, X), boldface lowercase letters for vectors (i.e x, φ) and lowercase letters
for scalar values (i.e. x, φ). Let R+ denote the set of nonnegative real numbers and Z+ denote the set of nonnegative
integers.

2 Background

To motivate the form of our model class, we present a brief background on the graphical model class as in (Besag, 1974;
Yang et al., 2015, 2013). Let T(x) and B(x) be the sufﬁcient statistics and log base measure respectively of the base
+ be the domain of the random vector. We will denote T(x) : Rp → Rp
univariate exponential family and let D ⊆ Rp
to be the entry-wise application of the sufﬁcient statistic function to each entry in the vector x. With this notation, this

1See (Wainwright & Jordan, 2008) for an introduction to exponential families.

2

previous class of graphical models can be deﬁned as:
Pr(x|θ, Φ) = exp

(cid:16)
(cid:16)

+(cid:80)p
+(cid:80)p

D exp

θT T(x) + T(x)T ΦT(x)

s=1 B(xs)

dµ(x) ,

(cid:17)

θT T(x) + T(x)T ΦT(x)

s=1 B(xs) − A(θ, Φ)

A(θ, Φ) =(cid:82)

(cid:17)

(1)

(2)

We will review the exponential graphical model under this formulation in which the domain D ∈ Rp

where A(θ, Φ) is the log partition function (i.e. log normalization constant) which is required for probability normal-
ization, Φ ∈ Rp×p is symmetric with zeros along the diagonal and µ is either the standard Lebesgue measure or the
counting measure depending on whether the domain D is continuous or discrete. The only difference from a fully
independent model is the quadratic interaction term T(x)T ΦT(x)—i.e. O(T(x)2)—which is why the exponential and
Poisson cases do not admit positive dependencies as will be described in later sections.
+, T(x) = x
and B(x) = 0. Suppose there is even one positive entry in Φ denoted φst. Then as x → ∞, the positive quadratic
term xsφstxt will dominate the linear term θT x and thus the log partition function will diverge (i.e. A(θ, Φ) → ∞).
Thus, Φst ≤ 0 is required for a consistent joint distribution. Similarly, in the case of the Poisson distribution where
the domain D ∈ Zp
+, T(x) = x and B(x) = −ln(x!), suppose there is even one positive entry φst. The quadratic
term xsφstxt will dominate the linear term and the log base measure term which is O(xln(x)); thus, Φst ≤ 0 is also
a requirement for the Poisson distribution.

In an attempt to allow positive dependencies for the Poisson distribution, Yang et al. (2013) developed three
variants of the Poisson graphical model deﬁned above. First, they developed a Truncated Poisson Graphical Model
(TPGM) that kept the same parametric form but merely truncated the usual inﬁnite domain to the ﬁnite domain
DTPGM = {x ∈ Zp
+ : xs ≤ R}. However, a user must a priori specify the truncation value R and thus TPGM is
unnatural for normal count data that could be inﬁnite. In addition, because of the quadratic term, even though the
domain is ﬁnite, the quadratic term can dominate and push most of the mass near the boundary of the domain (Yang
et al., 2013). The second proposal is to change the base measure from ln(x!) to x2. This proposal, however, gives
the distribution Gaussian-like quadratic tails rather than the thicker tails of the Poisson distribution. Finally, the last
proposal modiﬁes the sufﬁcient statistic T(x) to decrease from linear to constant as x increases. Similar to TPGM, this
third proposal requires the a priori speciﬁcation of two cutoff parameters (R1, R2) and behaves similarly to TPGM
after the second cutoff point because the base measure of −ln(x!) will quickly make the probability approach 0 once
the sufﬁcient statistics become constant.
In a somewhat different direction, Inouye et al. (2015) proposed a variant called Fixed-Length Poisson MRF
(LPMRF) that modiﬁes the domain of the distribution assuming the length of the vector L = (cid:107)x(cid:107)1 is ﬁxed, i.e.
D = {x ∈ Zp
+ : (cid:107)x(cid:107)1 = L}. Because the domain is ﬁnite as in TPGM, the distribution is normalizable even with
positive dependencies. However, as with TPGM, the quadratic term in the parametric form dominates the distribution
if L is large and thus Inouye et al. (2015) modify the distribution by introducing a weighting function that decreases the
quadratic term as L increases. All of these variants of the Poisson graphical model attempt to deal with the quadratic
interaction term in different ways but all of them signiﬁcantly change the distribution/domain and often require the
speciﬁcation of new unintuitive hyperparameters to allow for positive dependencies. Also, according to the author’s
best knowledge, no variants of the exponential graphical model have been proposed to allow for positive dependencies.
Therefore, we propose a novel graphical model class that directly alleviates the problem with the quadratic interaction
term and provides both exponential and Poisson graphical models that allow positive and negative dependencies.

3 Square Root Graphical Model

The amazingly simple yet helpful change from the previous graphical model class in Eqn. 1 is that we take the square
root of the sufﬁcient statistics in the interaction term. Essentially, this makes the interaction term linear in the sufﬁcient
statistics O(T(x)) rather than quadratic O(T(x)2) as in Eqn. 1. This change avoids the problem of the quadratic
term overcoming the other terms while allowing both positive and negative dependencies. More formally, given any

3

Pr(x| θ, Φ) = exp

A(θ, Φ) =(cid:82)

D exp

(cid:16)
θT(cid:112)T(x) +(cid:112)T(x)
+(cid:80)
(cid:16)
θT(cid:112)T(x)+(cid:112)T(x)
(cid:17)
+(cid:80)

T

T

Φ(cid:112)T(x)
(cid:17)
Φ(cid:112)T(x)

sB(xs) − A(Φ)

(3)

(4)

Figure 1: These examples of 2D exponential and Poisson SQR distributions with no dependency (i.e. independent),
positive dependency and negative dependency show the amazing ﬂexibility of the SQR model class that can intuitively
model positive and negative dependencies while having a simple parametric form. The approximate 1D marginals are
also shown along the edges of the plots.

univariate exponential family with nonnegative sufﬁcient statistics T(x) ≥ 0, we can deﬁne the Square Root Graphical
Model (SQR) class as follows:

where(cid:112)T(x) is an entry-wise square root except when T(x) = x2 in which case(cid:112)T(x) ≡ x.2 Figure 1 shows

sB(xs)

dµ(x) ,

examples of the exponential and Poisson SQR distributions for no dependency, positive dependency and negative
dependency. If θ = 0 and Φ is a diagonal matrix, then we recover an independent joint distribution so, like the previous
graphical models, the SQR class of models can be seen as a direct relaxation of the independence assumption. In the
next sections, we analyze some of the properties of SQR models including their conditional distributions.

3.1 SQR Conditional Distributions
We analyze two types of univariate conditional distributions of the SQR graphical models. The ﬁrst is the standard
node conditional distribution, i.e. the conditional distribution of one variable given the values for all other variables
(see Fig. 2). The second is what we will call the radial conditional distribution in which the unit direction is ﬁxed but

2This nuance is important for the Gaussian SQR in Sec. 4.

4

00.100.20.10.2Independent Exponentials0.30.300.100.20.10.2Positive Exp. SQR0.30.300.100.20.10.2Negative Exp. SQR0.30.3the length of the vector is unknown (see Fig. 2). The node conditional distribution is helpful for parameter estimation
as described more fully in Sec. 3.3. The radial conditional distribution is important for understanding the form of the
SQR distribution as well as providing a means to succinctly prove that the SQR parametric distribution is valid—i.e.
that the normalization constant is ﬁnite—as described in Sec. 3.2.

Figure 2: Node conditional distributions (left) are univariate probability distributions of one variable assuming the
other variables are given while radial conditional distributions are univariate probability distributions of vector scaling
assuming the vector direction is given. Both conditional distributions are helpful in understanding SQR graphical
models.

Node Conditional Distribution The probability distribution of one variable xs given all other variables x−s =
[x1, x2, . . . , xs−1, xs+1, . . . , xp] is as follows:

Pr(xs | x−s, θ, Φ) ∝ exp

θs +2φT−s

(cid:110)(cid:16)

(cid:112)T(x−s)

(cid:17)(cid:112)T(xs)
(cid:111)

+φssT(xs) + B(xs)

,

(5)

(6)

(7)

where φ−s ∈ Rp−1 is the s-th column of Φ with the s-th entry removed. This conditional distribution can be refor-
mulated as a new two parameter exponential family:

(cid:16)

Pr(xs | x−s, θ, Φ) = exp

Anode(η1, η2) =(cid:82)

D exp

(cid:16)

η1 ˜T1(xs) + η2 ˜T2(xs)
+B(xs) − A(η1, η2)

(cid:17)

(cid:17)

η1 ˜T1(xs) + η2 ˜T2(xs)
+B(xs)

dµ(xs) ,

(cid:112)T(x−s), η2 = φss, ˜T1(x) = (cid:112)T(x), and ˜T2(x) = T(x). Note that this reduces to the

where η1 = θs + 2φT−s
base exponential family only if η1 = 0 unlike the model in Eqn. 1-2 which, by construction, has node conditionals
in the base exponential family. Examples of node conditional distributions for the exponential and Poisson SQR can
be seen in Fig. 3. While these node conditionals are different then the base exponential family and hence slightly
more difﬁcult to use for parameter estimation as described later in Sec. 3.3, the beneﬁt of almost arbitrary positive and
negative dependencies signiﬁcantly outweighs the cost of using SQR over previous graphical models.

5

Node Conditional DistributionsRadial Conditional DistributionsFigure 3: Examples of the node conditional distributions of exponential (left) and Poisson (right) SQR models for
η2 = 0, η2 > 0 and η2 < 0.

Radial Conditional Distribution For simplicity, let us assume w.l.o.g. that T(x) = x.3 Suppose we condition on
of the sufﬁcient statistics but the scaling of this unit direction z = (cid:107)x(cid:107)1 is unknown. We
the unit direction v = x(cid:107)x(cid:107)1
call this the radial conditional distribution:

The radial conditional distribution can be rewritten as a univariate exponential family:
−Arad(η)

Pr(z | v, θ, Φ) = exp

z + η2z

√

(cid:16)
(cid:16)

Pr(x = zv | v, θ, Φ)
√
∝ exp
zv +
√
∝ exp

θT√
(θT√

v)

(cid:17)

s B(zvs)

s B(zvs)

(cid:17)

.

zvT Φ

z +(cid:0)√
(cid:16)
(cid:124)

η1

√

vT Φ

(cid:123)(cid:122)

O(z)

√

zv +(cid:80)
v(cid:1)z +(cid:80)
(cid:125)
(cid:124)(cid:123)(cid:122)(cid:125)
(cid:17)
(cid:124)(cid:123)(cid:122)(cid:125)

+ ˜Bv(z)
O(B(z))

+ ˜Bv(z)
O(B(z))

(cid:125)

√

(cid:16)

(cid:90)
(cid:123)(cid:122)
v and ˜Bv(z) = (cid:80)

(cid:124)

exp

O(z)

η1

D

Arad(η) =

z + η2z

dµ(z) ,

(cid:17)

(8)

(9)

√

√

vT Φ

v, η2 =

where η1 = θT√
s B(zvs). Note that if the log base measure of the base
exponential family is zero B(x) = 0, then the radial conditional is the same as the node conditional distribution
because the modiﬁed base measure is also zero ˜Bv(z) = 0. If both θ = 0 and B(x) = 0, this actually reduces to the
base exponential family. For example, the exponential distribution has B(x) = 0 and thus if we set θ = 0, the radial
conditional of an exponential SQR is merely the exponential distribution. Other examples with a log base measure
of zero include the Beta distribution and the gamma distribution with a known shape distributions. For distributions
in which the log base measure is not zero, the distribution will deviate from the node conditional distribution based
on the relative difference between B(x) and ˜Bv(x). However, the important point even for distributions with non-
zero log base measures is that the terms in the exponent grow at the same rate as the base exponential family—i.e.
O(z) + O(B(z)). This helps to ensure that the radial conditional distribution is normalizable even as z → ∞ since
the base exponential family was normalizable. As an example, the Poisson distribution has the log base measure
B(x) = −ln(x!) and thus ˜Bv(x) is O(−xlnx) whereas the other terms η1
z + ηz are only O(z). This provides the
intuition of why the Poisson SQR radial distribution is normalizable as will be explained in Sec. 4.2.

√

3If T is not linear than we can merely reparameterize the distribution so that this is the case.

6

012300.511.5222=0.00Positive 22Negative 22051000.050.10.150.20.250.30.350.422=0.00Positive 22Negative 223.2 Normalization
Normalization of the distribution was the reason for the negative-only parameter restrictions for the exponential and
Poisson distributions in the previous graphical models (Besag, 1974; Yang et al., 2015) as deﬁned in Eqn. 1. However,
we show that in the case of SQR models, normalization is much simpler to achieve and generally puts little to no
restriction on the value of the parameters—thus allowing both positive and negative dependencies. For our derivations,
+} be the set of unit vectors in the positive orthant. The SQR log partition function
let V = {v : (cid:107)v(cid:107)1 = 1, v ∈ Rp
A(Φ) can be decomposed into nested integrals over the unit direction and the one dimensional integral over scaling z:

(cid:90)

(cid:90)

Z(v)

+

(cid:16)
θT√
(cid:88)

(cid:17)

exp

zv +

√

√

zv

T

zv

Φ

A(θ, Φ) = ln
V

(cid:90)

(cid:90)

= ln
V

B(zvs)

dµ(z) dv

(cid:88)

s

√

exp(η1(v)

z + η2(v)z +

Z(v)

s

B(zvs))dµ(z) dv ,

(10)

(11)

where Z(v) = {z ∈ R+ : zv ∈ D}, and µ and D are deﬁned as in Eqn. 2. Because V is bounded, we merely need
that the radial conditional distribution is normalizable (i.e. Arad(η1, η2) < ∞ from Eqn. 9) for the joint distribution to
be normalizable. As suggested in Sec. 3.1, the radial conditional distribution is similar to the base exponential family
and thus likely only has similar restrictions on parameter values of the base exponential family. In Sec. 4.1 and 4.2,
we give examples for the exponential and Poisson distributions showing that this condition can be achieved with little
or no restriction on the parameter values.

(cid:80)

(cid:80)

(cid:16)

3.3 Parameter Estimation
For estimating the parameters Φ and θ, we follow the basic approach of (Ravikumar et al., 2010; Yang et al., 2015,
2013) and ﬁt p (cid:96)1-regularized node-wise regressions using the node conditional distributions described in Sec. 3.1.
Thus, given a data matrix X ∈ Rp×n we attempt to optimize the following convex function:

√

Φ

n

− 1
+B(xsi) − Anode(η1si, η2si)

η1si

s

i

arg min

xsi + η2sixsi

+ λ(cid:107)Φ(cid:107)1,off ,

(cid:112)T(x−si), (cid:107)Φ(cid:107)1,off =(cid:80)

(cid:17)
s(cid:54)=t |φst| is the (cid:96)1-norm on the off diagonal elements
where η1si = Φs,s, η2si = θ + 2φT−s
and λ is a regularization parameter. Note that this can be trivially parallelized into p independent sub problems which
allows for signiﬁcantly faster computation as in (Inouye et al., 2015). Unlike previous graphical models (Yang et al.,
2015) that were known to have a closed form conditional log partition function, the main difﬁculty for SQR graphical
models is that the node conditional log partition function Anode(η1, η2) is not known to have a closed form—though
closed form solutions or bounds may exist and investigating this possibility is an excellent area of future work. How-
ever, Anode can be easily numerically approximated because it is merely an integral or summation over one dimension.
In addition, the log partition function is only a function of the two parameters η1 and η2 so numerical 2D function
approximations could be used. Similarly, the gradient ∇Anode can be numerically approximated. For simplicity in our
implementation, we optimize Eqn. 12 using proximal gradient descent where we numerically approximate Anode ≈ ˆA
using the quadgk numerical integration function of MATLAB and numerically approximate the gradient by:

(12)

∇Anode = 1



(cid:104)(cid:0) ˆA(η1 + , η2) − ˆA(η1, η2)(cid:1),
(cid:0) ˆA(η1, η2 + ) − ˆA(η1, η2)(cid:1)(cid:105)

,

(13)

where  = 0.001. Notice that to compute the function value and the gradient, only three 1D numerical integrations are
needed. Another signiﬁcant speedup that could be explored in future work would be to use a Newton-like method as in

7

(Hsieh et al., 2014; Inouye et al., 2015), which optimize a quadratic approximation around the current iterate. Because
these Newton-like methods only need a small number of Newton iterations to converge, the number of numerical
integrations could be reduced signiﬁcantly. In another direction, it may be possible to provide closed-form upper
bounds for certain SQR models that could be used instead of numerical approximations but we do not explore this
possibility in this paper.

3.4 Likelihood Approximation
We use Annealed Importance Sampling (AIS) (Neal, 2001) similar to the sampling used in (Inouye et al., 2015)
for likelihood approximation. In particular, we need to approximate the SQR log partition function A(θ, Φ) as in
Eqn. 4. First, we develop a simple Metropolis Hastings rejection sampler for SQR models by making the proposal
distribution simply the independent exponential family distribution with a mean centered at the current iterate. Then,
we derive an annealed importance sampler (Neal, 2001) using the Metropolis Hastings sampler as the intermediate
sampler by linearly combining the off-diagonal part of the parameter matrix Φoff with the diagonal part Φdiag—i.e.
˜Φ = γΦoff + Φdiag. We also modify ˜θ = γθ similarly. For each successive distribution, we linearly change γ from 0 to
1. Thus, we start by sampling from the base exponential family independent distribution Pr(x| η1s = 0, η2s = Φss)∀s
and slowly move towards the ﬁnal SQR distribution Pr(x| θ, Φ). We maintain the sample weights as deﬁned in (Neal,
2001) and from these weights, we can compute an approximation to the log partition function (Neal, 2001).

4 Examples from Various Exponential Families

We give several examples of SQR graphical models in the following sections though it should be noted that we have
been developing a class of graphical models for any univariate exponential family with nonnegative sufﬁcient statistics.
The main analysis for each case is determining what conditions on the parameter matrix Φ allow the joint distribution
to be normalized. As described in Sec. 3.2, for SQR models, this merely reduces to determining when the radial
conditional distribution is normalizable. We analyze the exponential and Poisson cases in later sections but ﬁrst we
give examples of the discrete and Gaussian SQR graphical models.
The discrete SQR graphical model—including the binary Ising model—is equivalent to the standard discrete graph-
ical model because the sufﬁcient statistics are indicator functions Ts(x) = 1(x == s),∀s (cid:54)= p and the square root of
an indicator function is merely the indicator function. Thus, in discrete case, the discrete graphical model in (Raviku-
mar et al., 2010; Yang et al., 2015) is equivalent to the discrete SQR graphical model. For the Gaussian distribution, we
can use the nonnegative Gaussian sufﬁcient statistic T(x) = x2. Thus, the Gaussian SQR graphical model is merely
Pr(x|Φ) ∝ exp(θT x + xT Φx), which by inspection is clearly the standard Gaussian distribution where θ = Σ−1µ
and Φ = − 1
2 Σ−1 is required to be negative deﬁnite.4 Thus, the Gaussian graphical model can be seen as a special
case of SQR graphical models.

4.1 Exponential Graphical Model
We consider what are the required conditions on the parameters θ and Φ for the exponential SQR graphical model. If
η2 is positive, the log partition function will diverge because even the end point limz→∞ exp(η2z) → ∞. On the other
hand, if η2 is negative, then the radial conditional distribution is similar in form to the exponential distribution and
thus the log partition function will be ﬁnite because the negative linear term η2z dominates in the exponent as z → ∞.
If η2 = 0, then the log partition function will diverge if η1 ≥ 0 and will converge if η1 < 0 by simple arguments. See
√
appendix for proof. Thus, θ can have arbitrary values if
√

v < 0. Thus, the basic condition for on Φ is:

√

√

vT Φ
v < 0,∀v ∈ V} .

{Φ :

T

v

Φ

(14)

The normalizability condition when η2 = 0 could slightly loosen the condition on Φ in Eqn. 14 but we did not include
this loosening for simplicity. Note that this allows both positive and negative dependencies. A sufﬁcient condition

4This is by the slightly nuanced deﬁnition of the square root operator in Eqn. 3 and 4 such that

8

√

x2 ≡ x rather than |x|.

is that Φ being negative deﬁnite—as is the case for Gaussian graphical models. However, negative deﬁniteness is far
from necessary because we only need negativity of the interaction term for vectors in the positive orthant. It may even
be possible for Φ to positive deﬁnite but Eqn. 14 be satisﬁed; however, we have not explored this idea.

√

z + η2z −(cid:80)

4.2 Poisson Graphical Model
The normalization analysis for Poisson SQR graphical model is also relatively simple but requires a more careful
analysis than the exponential SQR graphical model. Let us consider the form of the Poisson radial conditional:
+},
Prrad(z | v) ∝ exp(η1
is discrete. We can simplify the analysis by taking a larger domain ˜Dz = {z ∈ Z+} of all non-negative integers and
s ln(Γ(zvs + 1)). Thus, the radial

changing the log factorial to the smooth gamma function, i.e.(cid:80)
s ln((zvs)!)) →(cid:80)
(cid:16)
(cid:124)

s ln((zvs)!)). Note that the domain of z, denoted Dz = {z ∈ Z+ : zv ∈ Zp

conditional log partition function is upper bounded by:

z + η2z

(cid:125)

exp

√

η1

Arad(η1, η2) ≤ (cid:88)
−(cid:80)
(cid:124)

z∈Z+

(cid:123)(cid:122)
(cid:17)
(cid:125)

O(z)

sln(Γ(zvs + 1))

(cid:123)(cid:122)

O(zlnz)

< ∞.

(15)

The basic intuition is that the exponent has a linear O(z) term minus an O(zlnz) term, which will eventually overcome
the linear term and hence the summation will converge. Note that we did not assume any restrictions on Φ except that
all the entries are ﬁnite. Thus, for the Poisson distribution Φ can have arbitrary positive and negative dependencies. A
formal proof for Eqn. 15 is given in the appendix.

5 Experiments and Results

In order to demonstrate that the SQR graphical model class is more suitable for real-world data than the graphical
models in (Yang et al., 2015) (which can only model negative dependencies), we ﬁt an exponential SQR model to a
dataset of airport delay times at the top 30 commercial USA airports—also known as Large Hub airports. We gathered
ﬂight data from the US Department of Transportation public “On-Time: On-Time Performance” database5 for the year
2014. We calculated the average delay time per day at each of the top 30 airports (excluding cancellations).

For our implementation, we automatically selected the regularization parameter λ in Eqn. 12 using the log likeli-
hood of a held-out dataset composed of 10% of the training data and then reﬁt the exponential SQR model with all
of the training data. For the ﬁnal training, we ran our proximal gradient descent algorithm for a maximum of 1000
iterations. Though we could not fully check the condition on Φ deﬁned in Eqn. 14, we generated 10 million random
positive vectors and found that the empirical maximum for
v was signiﬁcantly less than 0—thereby satisfying
Eqn. 14. For approximating the log partition function using the AIS sampling deﬁned in Sec. 3.4, we sampled 1000
AIS samples with 100 annealing distributions—i.e. γ took 100 values between 0 and 1—and 10 Metropolis Hastings
steps per annealed distribution.

vT Φ

√

√

The negative log likelihood values for both an independent exponential model and the exponential SQR graphical
model can be seen in Fig. 4 (lower negative log likelihood is better). Clearly, the exponential SQR model provides a
major improvement in likelihood over the independent model suggesting that the delay times of airports are clearly
related to one another. In Fig. 5, we visualize the top 50 edges—i.e. the top 50 non-zeros of Φ which correspond to
the edges in the graphical model—to show that our model is capturing intuitive dependencies signiﬁcantly better than
previous models.

First, it should be noted that 46 out of 50 of the dependencies are positive yet positive dependencies were not
allowed by previous graphical models (Yang et al., 2015)! Second, the positive dependencies seem strongly correlated
to geographic location even though no location data was given to the algorithm. This suggests that the exponential
SQR model is able to capture the idea of a latent location factor that intuitively seems obvious—i.e. airports that

5http://www.transtats.bts.gov/DL SelectFields.asp?Table ID =236&DB Short Name=On-Time

9

Figure 4: The ﬁtted exponential SQR model provides much better negative log likelihood values than an independent
exponential model on the airport delays dataset suggesting that a model with dependencies can give a much better
probability model.

are geographically closer are more likely to have related delay times. Some of these underlying dependencies may
be due to weather conditions as seems obvious for the northern airports where snowstorms can create signiﬁcant
delays. However, it seems that in other areas such as California where weather delays are not nearly as common, the
geographically-local dependencies may be due to cascading runway trafﬁc delays caused by peak travel times. Another
interesting factor is that the busiest airport in Atlanta, GA (ATL) is not strongly dependent on other airports. This seems
reasonable since Atlanta rarely has snow and there are few major airports geographically close to Atlanta. The largest
negative edge between Las Vegas, NV (LAS) and Honolulu, HI (HNL)—seen in red in Fig. 5—may seem initially
counterintuitive because one might suppose that LAS is at most independent of HNL since HNL is geographically
very far away from LAS. However, the edges in a graphical model as shown in Fig. 5 do not correspond to marginal
correlations between variables but rather deﬁne a speciﬁc set of conditional independence assumptions6. Thus, the
marginal correlation between LAS and HNL is probably nonnegative but given LAS’s strong positive dependencies
with nearby airports, the conditional distribution of LAS may be negatively dependent on the delays at HNL. On a
higher level, it seems reasonable that HNL is the most likely to have a negative edge because its weather and reasons
for delay is far removed from other airports. Overall, the qualitative analysis of the model shows that the exponential
SQR model can clearly capture interesting and intuitive dependencies.

6 Discussion

As full probability models, SQR graphical models could be used in any situation where a multivariate distribution is
required. For example, SQR models could be used in Bayesian classiﬁcation by modeling the probability of each class
distribution instead of the classical Naive Bayes assumption of independence. As another example, SQR models could
be used as the base distribution in mixtures or admixture composite distributions as in (Inouye et al., 2014a,b)—similar
to multivariate Gaussian mixture models. Another extension would be to consider mixed SQR graphical models in
which the joint distribution has variables using different exponential families as base distributions as explored for
previous graphical models in (Yang et al., 2014; Tansey et al., 2015).

6See (Wainwright & Jordan, 2008) for an introduction to graphical models.

10

Ind. Exp.Exp. SQR01234Negative log likelihood#104Negative Log Likelihoodfor Airport DelaysFigure 5: Visualizing the top 50 edges between airports shows the expected relationships with physical locality even
though the algorithm was not provided any location data. Thus, this demonstrates that the distribution and estimation
procedure for the exponential SQR model appropriately ﬁnds important dependencies between variables. (Width of
lines is proportional to the absolute value of the edge weight, positive weights are in blue, negative weights are in red
and size of airport abbreviation is proportional to the number of passengers.)

7 Conclusion
We introduce a novel class of graphical models that creates multivariate generalizations for any univariate exponential
family with nonnegative sufﬁcient statistics—including Gaussian, discrete, exponential and Poisson distributions. We
show that the SQR graphical models generally have few restrictions on the parameters and thus can model both pos-
itive and negative dependencies unlike previous generalized graphical models as represented by (Yang et al., 2015).
In particular, for the exponential distribution the parameter matrix Φ can have both positive and negative dependen-
cies and is only constrained by a mild condition—akin to the positive-deﬁniteness condition on Gaussian covariance
matrices. For the Poisson distribution, there are no restrictions on the parameter values and thus the Poisson SQR
distribution can model arbitrary positive and negative dependencies. We develop parameter estimation and likelihood
approximation methods and demonstrate that the SQR model indeed captures interesting and intuitive dependencies by
modeling airport delays. The general SQR class of distributions opens the way for graphical models to be effectively
used with non-Gaussian and non-discrete data without the unintuitive restriction to negative dependencies.

Acknowledgements

This work was supported by NSF (DGE-1110007, IIS-1149803, IIS-1447574, DMS-1264033, CCF-1320746) and
ARO (W911NF-12-1-0390).

11

References
Allen, G. I. and Liu, Z. A local poisson graphical model for inferring networks from sequencing data. IEEE Trans. on

Nanobioscience, 12(3):189–198, 2013.

Banerjee, O., El Ghaoui, L., and D’Aspremont, A. Model selection through sparse maximum likelihood estimation

for multivariate gaussian or binary data. JMLR, 9:485–516, 2008.

Besag, J. Spatial interaction and the statistical analysis of lattice systems. Journal of the Royal Statistical Society.

Series B (Methodological), 36(2):192–236, 1974.

Bickel, P., Diggle, P., Fienberg, S., Gather, U., and Olkin, I. Copula Theory and Its Applications. Springer, 2009.

Embrechts, P., Lindskog, F., and Mcneil, A. Modelling dependence with copulas and applications to risk management.

In Handbook of Heavy Tailed Distributions in Finance, pp. 329–384. Elsevier, 2003.

Friedman, J., Hastie, T., and Tibshirani, R. Sparse inverse covariance estimation with the graphical lasso. Biostatistics,

9(3):432–441, 7 2008.

Genest, C. and Neslehova, J. A primer on copulas for count data. ASTIN Bulletin, 37(2):475–515, 2007.

Hsieh, C-J., Sustik, M. A., Dhillon, I. S., and Ravikumar, P. Quic: Quadratic approximation for sparse inverse

covariance estimation. JMLR, 15:2911–2947, 2014.

Inouye, D. I., Ravikumar, P., and Dhillon, I. S. Admixture of poisson mrfs: A topic model with word dependencies.

In ICML, 2014a.

Inouye, D. I., Ravikumar, P., and Dhillon, I. S. Capturing semantically meaningful word dependencies with an admix-

ture of {poisson mrf}s. In NIPS, pp. 3158–3166, 2014b.

Inouye, D. I., Ravikumar, P., and Dhillon, I. S. Fixed-length poisson mrf: Adding dependencies to the multinomial.

In NIPS, pp. 3195–3203, 2015.

Jalali, A., Ravikumar, P., Vasuki, V., and Sanghavi, S. On learning discrete graphical models using group-sparse

regularization. In AISTATS, pp. 378–387, 2010.

Karlis, D. An em algorithm for multivariate poisson distribution and related models. Journal of Applied Statistics, 30

(1):63–77, 2003.

Liu, H., Lafferty, J., and Wasserman, L. The nonparanormal: Semiparametric estimation of high dimensional undi-

rected graphs. JMLR, 10:2295–2328, 2009.

Marshall, A. W. and Olkin, I. A multivariate exponential distribution. Journal of the American Statistical Association,

62(317):30–44, 1967.

Neal, R. M. Annealed importance sampling. Statistics and Computing, 11(2):125–139, 2001.

Ravikumar, P., Wainwright, M., and Lafferty, J. High-dimensional ising model selection using l1-regularized logistic

regression. The Annals of Statistics, 38(3):1287–1319, 6 2010.

Tansey, W., Padilla, O. H. M., Suggala, A. S., and Ravikumar, P. Vector-space markov random ﬁelds via exponential

families. In ICML, 2015.

Wainwright, M. J. and Jordan, M. I. Graphical models, exponential families, and variational inference. Foundations

and Trends in Machine Learning, 1(12):1–305, 2008.

Yang, E., Ravikumar, P., Allen, G. I., and Liu, Z. On poisson graphical models. In NIPS, pp. 17181726, 2013.

12

Yang, E., Baker, Y., Ravikumar, P., Allen, G. I., and Liu, Z. Mixed graphical models via exponential families. In

AISTATS, number 2012, pp. 1042–1050, 2014.

Yang, E., Ravikumar, P., Allen, G. I., and Liu, Z. On graphical models via univariate exponential family distributions.

JMLR, 16:3813–3847, 2015.

13

A Proof of Exponential SQR Normalization

The basic intuition is clear by looking at the asymptotic growth of each term. However, we speciﬁcally outline the
possibilities:

1. η2 > 0: A(η1, η2) → ∞.
2. η2 < 0: A(η1, η2) < ∞.
3. η2 = 0: if η1 < 0, then A(η1, η2) < ∞, otherwise A(η1, η2) → ∞.

In summary, we need that η2 < 0 or (η2 = 0 and η1 < 0).

Case 1: η2 > 0 Let ˆη2 = η2/2. First, we seek an exponential lower bound on the partition function. In particular,
we want to ﬁnd an ¯z such that for all z > ¯z, exp(ˆη2z) ≤ exp(η1
z + η2z). Taking the log of both sides and solving,
we ﬁnd that the critical points of the above inequality are at 0 and (−2 η1
)2. We take the non-trivial solution of
¯z = (−2 η1
)2. Now we need to check if the region to the right of ¯z is possible by plugging into the original equation.
Let us try a point ˜z = a¯z where a > 1:

√

η2

η2

exp(ˆη2 ˜z)
⇒ ˆη2 ˜z
⇒ (η2/2 − η2)˜z

(cid:19)2

(cid:18)

?≤ exp(η1
?≤ η1
?≤ η1

√
√

(cid:115)(cid:18)

˜z

√

˜z + η2 ˜z)

˜z + η2 ˜z

(cid:19)2

η1
η2

⇒ − η2
2

−2a

⇒ a

?≤ η1
η1
η2
?≤ √
−2η2
⇒ a ≥ √
η2

1

a

a ,

−2a
−2η2
η2

1

(16)

(17)

(18)

(19)

(20)

(21)

where the last line is because we assumed a > 1 and η2 > 0. Thus, we can lower bound the log partition function as
follows:

A(η1, η2) =

≥

(cid:90) ¯z
(cid:90) ¯z

0

0

= ∞ .

exp(η1

√

(cid:90) ∞

z + η2z)dz
√

exp(η1

z + η2z)dz

+
√

exp(η1

¯z

z + η2z)dz +

(cid:90) ∞
(cid:124)

(cid:123)(cid:122)

exp(ˆη2z)dz

¯z
→∞, since ˆη2>0

(cid:125)

Therefore, if η2 > 0, the log partition function diverges and hence the joint distribution is not consistent.

Case 2: η2 < 0 Now we will ﬁnd an exponential upper bound and show that this upper bound converges—and hence
the log partition function converges. In a similar manner to case 1, let ˆη2 = η2/2. We want to ﬁnd an ¯z such that for
all z > ¯z, exp(ˆη2z) ≥ exp(η1
z + η2z)—the only difference from case 1 is the direction of the inequality. Thus,
using the same reasoning as case 1, we have that ¯z = (−2 η1
)2. Similarly, we need to check if the region to the right
of ¯z is possible by plugging into the original equation. In a analogous derivation, we arrive at the same equation as

√

η2

14

Eqn. 20 except with the inequality is ﬂipped:

⇒ a

1

?≥ √
−2η2
⇒ a ≥ √
η2

−2η2
η2

1

a

a ,

(22)

(23)

where the last step is because we assumed η2 < 0 and a > 1—note that we do not ﬂip the inequality because −2η2
overall a positive number. Thus, this is an upper bound on the interval [¯z,∞]:

η2

1

is

A(η1, η2) =

≤

≤

0

(cid:90) ¯z
(cid:90) ¯z
(cid:90) ¯z
(cid:124)

0

0

< ∞,

exp(η1

√

(cid:90) ∞

z + η2z)dz
√

exp(η1

z + η2z)dz

+
√

exp(η1

¯z

z + η2z)dz +

¯z

(cid:90) ∞
(cid:124)
(cid:90) ∞
(cid:124)

0

(cid:123)(cid:122)
(cid:123)(cid:122)

exp(ˆη2z)dz

Upper bound

(cid:125)
(cid:125)

Exp. log partition

exp(η1

z + η2z)dz

+

exp(ˆη2z)dz

√

(cid:123)(cid:122)

<∞

(cid:90) ∞

0

(cid:125)

√

where the last step is based on the fact that a bounded integral of a ﬁnite smooth function is bounded away from ∞
and the second term is merely the log partition function of a standard exponential distribution.

Case 3: η2 = 0 This gives the log partition function simply as:

which has the closed form solution:

A(η1, η2) =

exp(η1

z)dz,

√
A(η1, η2) = 2η−2
1 (η1
√
z→∞ 2η−2
1 (η1
= lim
z→∞ 2η−2
= 2η−2
1 + lim

√
z − 1) exp(η1
√
z − 1) exp(η1
1 (η1

√

z − 1) exp(η1

(cid:12)(cid:12)(cid:12)∞
z) −(cid:0)−2η−2

z)

0

1

√

(cid:1)

(24)

(25)

(26)
The convergence critically depends on the limit in Eqn. 26. This limit diverges to ∞ if η1 ≥ 0 but converges to 0 if
η1 < 0. Thus, if η2 = 0, then η1 < 0 for the log partition function to be ﬁnite.

z) .

B Proof of Poisson SQR Normalization (Eqn. 15)

First, we take an upper bound by absorbing the

z term:

√

A(η1, η2) ≤ (cid:88)

z∈Z+

exp

z + η2z

(cid:125)
(cid:123)(cid:122)

η1

O(z)

√

(cid:123)(cid:122)

(cid:16)
(cid:124)
−(cid:88)
(cid:124)
(cid:16)
ηz −(cid:88)

s

s

15

≤ (cid:88)

z∈Z+

exp

(cid:17)

(cid:125)

(27)

(28)

(29)

(cid:17)

,

ln(Γ(zvs + 1))

O(zlnz)

ln(Γ(zvs + 1))

where η = η2 + |η1|. We continue the bound as follows:

(cid:16)

(cid:17)

ηz − max

s

ln(Γ(zvs + 1))

exp

exp (ηz − ln(Γ(z/p + 1))) ,

A(η1, η2) ≤ (cid:88)
≤ (cid:88)

z∈Z+

z∈Z+

where Eqn. 31 comes from the fact that arg maxvs ln(Γ(zvs + 1)) ≥ 1/p (simple proof by contradiction).

Now let us use the ratio test for convergent series where az = exp

η(v)z − ln(Γ( z

p + 1))

(cid:16)

(cid:17)

:

lim
z→∞

|az+1|
|az| = exp(η(z + 1) − ln(Γ((z + 1)/p + 1))
− [ηz − ln(Γ(z/p + 1))])

(cid:18) Γ(z/p + 1))

(cid:19)(cid:19)

(cid:18)

= lim

z→∞ exp

η + ln

Γ((z + 1)/p + 1))

= exp(η) lim
z→∞

Γ(z/p + 1))

Γ((z/p + 1 + 1/p))

(z/p + 1)1/p
(z/p + 1)1/p

= exp(η) lim
z→∞

1

(z/p + 1)1/p
× lim
z→∞
1

(z/p + 1)1/p

= exp(η) lim
z→∞

(1)

= exp(η)(0)(1) = 0 < 1,

Γ(z/p + 1))(z/p + 1)1/p

Γ((z/p + 1 + 1/p))

(30)

(31)

(32)

(33)

(34)

(35)

(36)

(37)

where Eqn. 35 is by the product of limits rule and Eqn. 36 is by the well-known asymptotic properties of gamma
functions. Therefore, by the ratio test, the radial conditional log partition function is bounded for any η1 < ∞ and
η2 < ∞.

16

