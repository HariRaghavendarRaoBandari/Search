Data-Driven Robust Taxi Dispatch under Demand Uncertainties
Fei Miao, Shuo Han, Shan Lin, Qian Wang, John Stankovic, Abdeltawab Hendawi, Desheng Zhang, Tian He,

George J. Pappas

1

6
1
0
2

 
r
a

 

M
0
2

 
 
]

Y
S
.
s
c
[
 
 

1
v
3
6
2
6
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—In modern taxi networks,

large amounts of taxi
occupancy status and location data are collected from networked
in-vehicle sensors in real-time. They provide knowledge of system
models on passenger demand and mobility patterns for efﬁcient
taxi dispatch and coordination strategies. Such approaches face
a new challenge: how to deal with uncertainties of predicted
customer demand while fulﬁlling the system’s performance re-
quirements, including minimizing taxis’ total idle mileage and
maintaining service fairness across the whole city. To address
this problem, we develop a data-driven robust taxi dispatch
framework to consider spatial-temporally correlated demand
uncertainties. The robust optimization problem is concave in
the uncertain demand and convex in the decision variables.
Uncertainty sets of random demand vectors are constructed from
data based on theories in hypothesis testing, and provide a desired
probabilistic guarantee level
for the performance of robust
taxi dispatch solutions. We prove equivalent computationally
tractable forms of the robust dispatch problem using the minimax
theorem and strong duality. Evaluations on four years of taxi trip
data for New York City show that by selecting a probabilistic
guarantee level at 75%, the average demand-supply ratio error is
reduced by 31.7%, and the average total idle driving distance is
reduced by 10.13% or about 20 million miles annually, compared
with non-robust dispatch solutions.

I. INTRODUCTION

Modern transportation systems are equipped with various
sensing technologies for passenger and vehicle tracking, such
as radio-frequency identiﬁcation (RFID), global positioning
system (GPS), and occupancy status sensing systems. Sens-
ing data collected from transportation systems provides us
opportunities for understanding spatial-temporal patterns of
passenger demand. Methods of predicting taxi-passenger de-
mand [24], [30],
time [3], [18], [29] and traveling
speed [2] according to trafﬁc monitoring data have been devel-
oped. Simple travel time predictors were demonstrated to come
close to fundamental error bounds in delay prediction [16].

travel

This work was supported by NSF CPS-1239152, Project Title: CPS:
Synergy: Collaborative Research: Multiple-Level Predictive Control of Mobile
Cyber Physical Systems with Correlated Context. Shuo Han was supported
in part by the NSF (CNS-1239224) and TerraSwarm, one of six centers
of STARnet, a Semiconductor Research Corporation program sponsored by
MARCO and DARPA. Part of the results of this work appeared at
the
54th IEEE Conference on Decision and Control, Osaka, Japan, December
2015 [22].

F. Miao, S. Han and G. J. Pappas are with the Department of Electrical
and Systems Engineering, University of Pennsylvania, Philadelphia, PA, USA
19014. Email:{miaofei, hanshuo, pappasg}@seas.upenn.edu. S. Lin is with
Department of Electrical and Computer Engineering, Stony Brook University,
Long Island, NY, USA 11794. Email: shan.x.lin@stonybrook.edu. Q. Wang
is with China Chengxin Credit Information Co., Beijing, China, 100033.
Email:qianwangchina@gmail.com. J. Stankovic and A. Hendawi are with
the Department of Computer Science, University of Virginia, Charlottesville,
VA, USA, 22904. Email: {stankovic, hendawi}@virginia.edu. D. Zhang
and T. He are with Department of Computer Science and Engineering,
University of Minnesota, Minneapolis, MN 55455, USA. Email:{tianhe,
zhang}@cs.umn.edu.

Based on such rich spatial-temporal

information about
passenger mobility patterns and demand, many control and
coordination solutions have been designed for intelligent trans-
portation systems. Coverage control algorithms to allocate
groups of vehicles [12], robotic load re-balancing policies that
minimize the number of re-balancing trips for mobility-on-
demand systems [26], [32], and smart parking systems that
allocates resource based on a driver’s cost function [17] have
been proposed. Dispatch algorithms that aim to minimize cus-
tomers’ waiting time [20], [28] or to reduce cruising mile [31]
have been developed. Miao et. al design a Receding Horizon
Control (RHC) framework of dispatching taxis towards both
current and predicted future demand, balancing taxi supply
throughout the city and reducing idle cruising distance [23].
Strategies for resource allocation depend on the model of
demand in general, and the knowledge and assumptions about
the demand affect the performance of the supply-providing
approaches [11], [25]. These works heavily rely on precise
passenger-demand models to make dispatch decisions.

However, passenger-demand models have their intrinsic
model uncertainties that result from many factors, such as
weather, passenger working schedule, and city events etc.
Algorithms that do not consider these uncertainties can lead
to inefﬁcient dispatch services, resulting in long waiting
times of under-served passengers, imbalanced workloads, and
increased taxi idle mileage. Meanwhile, considering future
demand when making the current dispatch decisions helps
to reduce resource re-allocating costs [32] and taxis’ total
idle distance [23], and a robust allocation scheme shows its
advantage in worst-case scenarios compared with non-robust
approaches [1]. While robust optimization aims to minimize
the worst-case cost under all possible random parameters, it
sacriﬁces average system performances. For a taxi dispatch
system, it is essential to address the trade-off between worst-
case system performance guarantee and the average dispatch
cost under uncertain demand. A promising yet challenging
approach is a robust dispatch framework with an uncertain
demand model, called an uncertainty set, that captures spatial-
temporal correlations of demand uncertainties and provides a
probabilistic guarantee (as deﬁned in problem (12)). Solving
the robust dispatch problem with the constructed uncertainty
set allows us to guarantee that the probability of having an
actual dispatch cost under the true demand that smaller than
the optimal cost of the robust dispatch solution is greater than
a desired value.

In this work, we consider two aspects of a robust taxi
dispatch framework given a taxi-operational records dataset:
(1) how to formulate a robust resource allocation problem
that dispatches vacant taxis towards predicted uncertain de-
mand, and (2) how to construct spatial-temporally correlated

2

uncertain demand sets for this robust resource allocation
problem without sacriﬁcing too much average performance of
the system. We have the freedom to specify a lower bound
value for the probability that an actual dispatch cost under
the true demand vector being smaller than the optimal cost of
the robust dispatch solutions. The data-driven robust dispatch
model we design allows us to ﬁnd a better solution for
considering the trade-off between the average dispatch cost
and the minimum cost under the worst-case scenario than
previous methods that do not provide any guarantees.

We ﬁrst develop the objective and constraints of a multi-
stage robust dispatch problem considering spatial-temporally
correlated demand uncertainties. The objective of a system-
level optimal dispatch solution is balancing workload of taxis
in each region of the entire city with minimum total current
and expected future idle cruising distance. We then design a
data-driven algorithm for constructing uncertainty demand sets
without assumptions about the true distribution of the demand
vector. The constructing algorithm is based on theories proved
for independent and identically distributed (i.i.d.) sampled ran-
dom vectors in the robust optimization literature [8] [14] [27].
However, how to apply these theories for spatial-temporal
data and a robust resource allocation form of taxi dispatch
problem based on the constructed spatial-temporally correlated
uncertainty sets have not been explored before. To the best
of our knowledge, this is the ﬁrst work to design a robust
taxi dispatch framework that provides a desired probabilistic
guarantee using predictable and realistic demand uncertainty
sets.

With two types of uncertainty sets — one box type and one
second-order-cone (SOC) type, we prove equivalent convex
optimization forms of the robust dispatch problem via the
minimax theorem and the strong duality theorem. The robust
dispatch problem formulated in this work is convex over the
decision variables and concave over the constructed uncertain
sets with decision variables on the denominators. This form is
not the standard form (i.e., linear programming (LP) or semi-
deﬁnite programming (SDP) problems) that has already been
covered by previous work [5], [8], [13]. With proofs shown
in this work, both system performance and computational
tractability are guaranteed under spatial-temporal demand un-
certainties. Based on four years of taxi trip data in New York
City, we evaluate factors that affect the accuracy of the un-
certainty sets, properties of each type of uncertainty sets, and
trade- off between the probabilistic guarantee levels and the
average dispatch costs of robust dispatch solutions. uncertainty
sets, and trade-off between the probabilistic guarantee levels
and the average dispatch costs of robust solutions are evaluated
based on four years of taxi trip data in New York City.

The contributions of this work are:
• We develop a multi-stage robust optimization model for
taxi dispatch systems under spatial temporal uncertainties
of predicted demand, with the objective of balancing
vacant taxi supply with least total idle driving distance.
• We design a data-driven algorithm to construct uncer-
tainty sets that provide a desired level of probabilistic
guarantee for the robust taxi dispatch solutions. We show
that the second-order-cone type of uncertain set provides

a smaller average dispatch cost than the box type via
evaluations.

• We prove that there exists an equivalent computationally
tractable convex optimization form for the robust dispatch
problem with each type of constructed uncertainty set.

• Evaluations on four years of taxi trip data in New York
City show that the average demand-supply ratio mismatch
is reduced by 31.7%, and the average total idle distance
is reduced by 10.13% or about 20 million miles annually
with robust dispatch solutions.

The rest of the paper is organized as follows. The taxi
dispatch problem is described and formulated as a robust op-
timization problem given a closed and convex uncertainty set
in Section II. The requirement of modeling uncertain demand
sets are described in Section III, followed by the algorithm
for constructing uncertain demand sets based on taxi opera-
tional records data in Section IV. Equivalent computationally
tractable forms of the robust
taxi dispatch problem given
different forms of uncertainty sets are proved in Section V.
Evaluation results based on a real data set are shown in
Section VI. Concluding remarks are provided in Section VII.

NOTATIONS

For any vector x, we denote by xT the transpose of x, and
xi as the i-th component of x. We denote 1n ∈ Rn as a vector
of all ones.

II. PROBLEM FORMULATION

The goal of taxi dispatch is to direct vacant taxis towards
current and future passengers with minimum total idle mileage.
There are two objectives. One is sending more taxis for more
requests to reduce mismatch between supply and demand
across all regions in the city. The other is to reduce the total
idle driving distance for picking up expected passengers in
order to save cost. Involving predicted customer demand of the
future when making current decisions beneﬁts to increasing
total proﬁts, since drivers are able to travel to regions with
better chances to pick up future passengers. In this section,
we formulate a taxi dispatch problem with uncertainties in
the predicted spatial-temporal patterns of passenger demand.
A typical monitoring and dispatch infrastructure is shown in
Figure 1. The dispatch center periodically collects and stores
real-time information such as GPS location, occupancy status
and road conditions; dispatch solutions are sent to each taxi via
cellular radio. An RHC framework that cooperates predicted
demand model and real-time sensing data is designed in [23],
where either a deterministic model or an uncertain demand
model is applied to calculate a dispatch solution at each step
of sliding the time window and updating the latest sensing
information. However, the robust dispatch problem formulated
in [23] does not provide any probabilistic guarantee as the
model we design in this work. We deﬁne the problem of
ﬁnding a robust dispatch in the rest of this section, which
is compatible with the RHC framework of [23].

Parameters of (11)

n
τ

rk ∈ ∆k
W ∈ Rn×n
P k ∈ [0, 1]n×n
L1 ∈ Nn
m ∈ R+
α ∈ R+
β ∈ R+
ij ∈ R+
X k
Lk ∈ Rn
rc ∈ ∆

Variables of (11)

+

˜rc(dl, t, Ip)

U
αh

Parameters of Algorithm 1

3

Description

the number of regions

model predicting time horizon

the uncertain total number of requests at each region during time k

weight matrix, Wij is the distance from region i to region j

probability matrix that describes taxi mobility patterns during one time slot

the initial number of vacant taxis at each region provided by GPS and occupancy status data

the upper bound of distance each taxi can drive idly for picking up a passenger

the power on the denominator of the cost function

the weight factor of the objective function

the number of taxis dispatched from region i to region j during time k

the number of vacant taxis at each region before dispatching at the beginning of time k

the uncertain concatenated demand vector of τ consecutive time slots
one sample of rc(t) according to sub-dataset Ip, records of date dl

the uncertainty set that provides 1 −  probabilistic guarantee level for problem (11)

signiﬁcance level of a hypothesis testing

PARAMETERS AND VARIABLES OF TAXI DISPATCH PROBLEM (11) AND ALGORITHM 1.

Table I

A. Problem description

We discretize time and space in problem formulation for
computational efﬁciency. We assume that the entire city is
divided into n regions, and discrete time slots are indexed
by k = 1, 2, . . . , τ. Typically,
to predict a
deterministic value of passenger demand of a region during
speciﬁc time. With prior knowledge and data sets, we assume
that
is described by uncer-
tainty vectors belonging to closed and convex sets deﬁned as

the passenger demand model

is difﬁcult

it

rk ∈ ∆k ⊂ Rn
+,

k = 1, . . . , τ,

is the number of total requests within region j
where rk
j
during time k, and τ is the model predicting time horizon.
j ∈ N to positive,
Here we relax the integer constraint of rk
since constructing an uncertainty set for a continuous vector
is more convenient and this relaxation provides an accurate
enough demand model. The total number of requests at region
j may have similar patterns as its neighbors, for instance,
during busy hours, several regions locate in downtown area
may all have peak demand. This type of spatial correlations
of demand across each region during the same time slot k is
reﬂected by the correlation of each element of rk. Meanwhile,
demand can also be temporal correlated, that demand during
several consecutive time slots rk, k = 1, . . . , τ may show
similar characteristics like busy hours. Hence, it is possible to
describe both spatial and temporal correlations by one set ∆
for uncertain demand vectors rk, k = 1, . . . , τ. We deﬁne the
concatenation of sequences (r1 ∈ Rn, . . . , rτ ∈ Rn) as

rc =(cid:2)(r1)T , (r2)T ,··· , (rτ )T(cid:3)T ∈ ∆ ⊂ Rτ n,

Figure 1. A prototype of the taxi dispatch system

and each closed, convex set ∆k is a projection of ∆

∆k := {rk |∃r1, . . . , rk−1, rk+1, . . . , rτ , s.t. rc ∈ ∆}.

The closed and convex form of ∆ depends on the method and
theory applied to construct the uncertainty set, which we will
describe in Section III.

Considered as one type of resource allocation problem, the
basic idea of a robust dispatch model that balances taxis’
supply in a network ﬂow model is described in Figure 2.
The dispatch framework decides the amount of vacant taxis
that should traverse between each node pair according to the
demand at each node according to control requirements and
practical constraints. The edge weight of the graph represents
the distance between two regions. Speciﬁcally, each region has
an initial number of vacant taxis provided by real-time sensing
information and an uncertain predicted demand.
We deﬁne a non-negative decision variable matrix X k ∈
Rn×n
+ , X k
ij is the number of taxis (amount of
resource) dispatched from region i to region j. We relax the in-
ij ∈ N to a non-negative constraint, since
teger constraint of X k
mixed integer programming is not computational efﬁcient for
a large-scale robust optimization problem. In this work we
consider the following robust resource allocation problem

ij ≥ 0, where X k

min
X 2

max
r2∈∆2

. . . min
X τ

max
rτ∈∆τ

(JD(X k) + βJE(X k, rk))

(1)

min.
X 1

max
r1∈∆1

τ(cid:88)

J =
s.t. X k ∈ Dc,

k=1

where JD is a convex cost function for allocating or re-
allocating resources, JE is a function concave in rk and
convex in X k that measures the service fairness of the
resource allocating strategy, and Dc is a convex domain of the
decision variables that describes the constraints of the resource
allocating strategies. We deﬁne speciﬁc formulations of the
objective and constraint functions for a robust taxi dispatch
problem in the rest of this section.

B. Robust taxi dispatch problem formulation

Estimated cross-region idle-driving distance: When
traversing from region i to region j, taxi drivers take the cost

Dispatch	  Controller(cid:1)Taxi	  Network(cid:1)Taxi	  Passengers(cid:1)Spa8otemporal	  Demand	  Model(cid:1)Demand	  Uncertainty(cid:1)Real-­‐8me	  	  Pick-­‐up	  Events,	  occupancy	  status	  and	  GPS	  readings(cid:1)4

number of vacant taxis at region i during time k satisﬁes that

n X k·i − X k
1T

i·1n + Lk
i

(cid:62) 1,

i = 1, . . . , n,

(4)

Figure 2. A network ﬂow model of the robust taxi dispatch problem. A
circle represents a region with region ID 1, 2, 3, 4. We omit the superscript
of time k since every parameter is for one time slot only. Uncertain demand
is denoted by ri, Li is the original number of vacant taxis before dispatch
at region i, and Xij is a dispatch solution that sending the number of vacant
taxis from region i to region j with the distance Wij.
of cruising on the road without picking up a passenger till the
target region. Hence, we consider to minimize this kind of idle
driving distance while dispatching taxis. We deﬁne the weight
matrix of the network in Fig. 2 as W ∈ Rn×n, where Wij is
the distance between region i and region j. The across-region
idle driving cost according to X k is

JD(X k) =

X k

ijWij.

(2)

(cid:88)

(cid:88)

i

j

We assume that the region division method is time-invariant
in this work, and W is a constant matrix for the optimization
problem formulation – for instance, the value of Wij repre-
sents the length of shortest path on streets from the center of
region i to the center of region j 1.
The distance every taxi can drive should be bounded
by a threshold parameter m ∈ R+ during limited time

X k
which is equivalent to

ij = 0 if Wij > m,

X k
ij

(cid:62) 0, X k

ijWij ≤ mX k
ij,

∀i, j ∈ {1, . . . , n}.

(3)

ijWij > mX k

ij > 0, we have X k

To explain this, assume the constraint (3) holds. If Wij > m
and X k
ij, which contradicts
to (3). The threshold m is related to the length of time slot and
trafﬁc conditions on streets. For instance, with an estimated
average speed of cars in one city during time k = 1, . . . , τ,
and idle driving time to reach a dispatched region is required
to be less than 10 minutes, then the value of m should be the
distance one taxi can drive during 10 minutes with the current
average speed on road (m can also be dependent on k, denoted
as mk if a different average speed during each time slot k can
be monitored or predicted).

Metric of serving quality: We design the metric of service
quality as a function JE(X k, rk) concave in rk and convex
in X k in this work for computational efﬁciency [5]. Besides
vacant taxis traverse to region j according to matrix X k, we
j ∈ R+ as the number of vacant taxis at region j
deﬁne Lk
before dispatching at the beginning of time k, and Lk ∈ Rn
+,
and L1 ∈ Rn
+ is provided by real-time sensing information.
We assume that the total number of vacant taxis is greater than
the number of regions, i.e., N (cid:62) n, and each region should
have at least one vacant taxi after dispatch. Then the total

where X k·i is the i-th column of X k and X k
i· is the i-th row
of X k. Dispatch is an action of re-allocating resources among
regions and does not change the total number of vacant taxis
N before the taxis pick up new passengers during time k

n X k·i − X k

(1T

i·1n + Lk

i ) =

i

i

Lk

i = N.

(5)

(cid:88)

(cid:88)

One service metric is fairness over all regions, or that
the demand-supply ratio of each region equals to that of
the whole city. A balanced distribution of vacant taxis is an
indication of good system performance from the perspective
that a customer’s expected waiting time is short as shown by
a queuing theoretic model in [32]. Meanwhile, a balanced
demand-supply ratio means that regions with less demand
will also get less resources, and idle driving distance will
also be reduced in regions with more supply than demand if
we pre-allocate possible redundant supply to those regions in
need. We deﬁne the objective of minimizing demand-supply
ratio mismatch between each region and the whole city as
minimizing the following function

JE(X k, rk) =

rk
i
n X k·i − X k
i·1n + Lk
(1T

i )α , α → 0.

(6)

This is because by minimizing (6) under the constraints (4)
and (5), we get the same optimal solution of minimizing
the following demand-supply ratio mismatch function under
constraints (4) and (5).

(cid:88)

i

(cid:12)(cid:12)(cid:12)(cid:12)

τ(cid:88)

n(cid:88)

k=1

i=1

(cid:12)(cid:12)(cid:12)(cid:12) .

rk
i
n X k·i − X k
1T

i·1n + Lk
i

n rk
− 1T
N

(7)

(cid:88)

i

It is worth noting that the function JE(X k, rk) deﬁned as (6)
is afﬁne in rk for any X k, and convex in X k for any rk, while
the mismatch function (7) is not concave in rk for any X k.
To explain how (6) approximates (7) under constraints (4)

and (5), consider the following problem

ai
bα
i

,

c is a constant.

(8)

minimize
i bi=c

b>0,(cid:80)
derivatives of (cid:80)

i

ai
bα
i

Substitute bn = c − b1 ··· − bn−1 into (8), and take partial
over bi, i = 1, . . . , n − 1. When the
minimum of (6) is achieved, each partial derivative should
be 0, namely
ai
bα+1
i

(c − b1 ··· − bn−1)α+1 = 0,

− α(−1)

−α

an

which is equivalent to

a1
bα+1
1

= ··· =

an−1
bα+1
n−1

=

an
bα+1
n

.

Hence, when α → 0, α + 1 → 1, the optimal solution of
minimizing JE over X k satisﬁes

1For control algorithms with a dynamic region division method, the distance

matrix can be generalized to a time dependent matrix W k as well.

rj
n X k·j − X k
1T

j·1n + Lk
j

=

1T
n rk
N

.

1 r1 L1 4 r4 L4   3 r3 L3   2 r2 L2  X23 X13 X24 W12=W21  W34=W43  W23=W32  W24=W42  W13=W31  W14=W41  Therefore, with function (6), we map the objective of balanc-
ing supply according to demand across every region in the
city to a computationally tractable function that concave in
the uncertain parameters and convex in the decision variables
for a robust optimization problem.

j

The number of initial vacant taxis Lk+1

depends on the
number of vacant taxis at each region after dispatch during
time k and the mobility patterns of passengers during time k,
while we do not directly control the latter. We deﬁne P k
ij as
the probability that a taxi traverses from region i to region j
and turns vacant again (after one or several drop off events)
around the beginning of time k +1, provided it is vacant at the
beginning of time k. Examples of getting P k
ij based on data
include but not limited to methods of describing trip patterns of
taxis [23] and autonomous mobility on demand systems [32].
Then the number of vacant taxis within region j by the end

n X k − (X k1n)T + (Lk)T(cid:1) P k·j, where P k·j is

of time k is (cid:0)1T

the j-th column of P k, and

(Lk+1)T = (1T

n X k − (X k1n)T + (Lk)T )P k.

(9)

Weighted-sum objective function: Since there exists a
trade-off between two objectives, we deﬁne a weight parameter
β of two objectives JD(X k) in (2) and JE(X k, rk) in (6).
Without considering model uncertainties corresponding to rk,
a convex optimization form of taxi dispatch problem is

J =

(JD(X k) + βJE(X k, rk))

(10)

τ(cid:88)

min.
X k,Lk
s.t

k=1
(3), (4), (9).

Robust taxi dispatch problem formulation: We aim to ﬁnd
out a dispatch solution robust to an uncertain demand model
in this work. For time k = 1, . . . , τ, uncertain demand rk only
affects the dispatch solutions of k + 1, . . . , τ, similar to the
multi-stage robust optimization problem in [9]. Hence, with a
list of parameters and variables shown in Table I, considering
effects of current decisions to estimated future costs, a multi-
stage robust taxi dispatch problem is deﬁned as following



min.
X 1

max
r1∈∆1

min
X 2,L2

max
r2∈∆2

. . . min
X τ ,Lτ

max
rτ∈∆τ

(JD(X k) + βJE(X k, rk))

τ(cid:88)
τ(cid:88)

k=1

(cid:88)

(cid:88)

J =

=

s.t.

βrk
i
X k
n X k·i − X k
ijWij +
i·1n + Lk
(1T
n X k − (X k1n)T + (Lk)T )P k,

i )α

i

j

k=1
(Lk+1)T = (1T
n X k − (X k1n)T + (Lk)T (cid:62) 1,
1T
ijWij ≤ mX k
X k
ij,
ij ≥ 0,
X k

i, j ∈ {1, 2, . . . , n}.

(11)
After getting an optimal solution X 1∗ of (11), we adjust the
solution by rounding methods to get an integer number of
taxis to be dispatched towards corresponding regions. It does
not affect the optimality of the result much in practice, since
the objective function is related to the demand-supply ratio of

5

each region. A feasible integer solution of (11) always exists,
since X k

ij = 0, ∀i, j, k is feasible.

III. CONSTRUCTING UNCERTAINTY SETS

With many factors affecting taxi demand during different
time within different areas of a city, explicitly describing the
model is a strict requirement and errors of the model will
affect the performance of dispatch frameworks. Considering
future demand uncertainties beneﬁts for minimizing worst-
case demand-supply ratio mismatch error and idle distance
described as shown in [22], [23]. However, the uncertainty set
constructed by only using a standard deviation range [22], [23]
cannot tell how possible the true real-world cost is smaller
than the optimal cost. Hence, with a large amount of taxi
operational records data, it is essential to construct a model
that captures the spatial-temporal demand uncertainties and
provides a probabilistic guarantee about
the true possible
values of costs by solving robust dispatch problem (11).

A. Samples of concatenated demand vector

Informally, we consider the concatenated demand vector rc
as a random variable. It is worth noting that we do not have
additional assumptions about either the form of ∆ besides
closeness and convexity, or the form of marginal distribution
of each element of vector rc, or the true distribution of P∗(rc).
Methods of constructing uncertainty sets in robust optimiza-
tion literature is typically designed for i.i.d. sampled random
vectors that utilize information from a dataset of samples to
provide theoretic guarantee for the performance of robust opti-
mization problems [8], [7], [10]. We transform the knowledge
of previous work to construct an uncertainty set ∆ for the
random vector rc that contains spatial-temporal relations of
the demand model. We assume that one day is discretized as
K time slots in total, and the demand of each region during
one time slot is described as rk, k = 1, . . . , K. Then every τ
discretized time slots of rk, k = t, . . . , t + τ are concatenated
to a vector rc(t) to represent the possible temporal correlations
among consecutive time slots. We deﬁne one sample of vector
rc(t) of date dl as ˜rc(dl, t), a vector calculated via aggregating
total number of pick up events of all taxis at each region for
time slots t, t + 1, . . . , t + τ. For instance, for consecutive
time slots (1, . . . , τ ), (2, . . . , τ + 1), . . . , the sampled vectors
on date d for time index t = 1, 2, . . . are denoted as

˜r1(d)

˜r2(d)
...

 ,

˜rτ (d)

 ˜r2(d)

˜r3(d)
...

 , . . . .

˜rτ +1(d)

˜rc(d, 1) =

˜rc(d, 2) =

independent

the
We consider demand vectors of different dates for
same time slot as
i.e., demand
˜rc(d1, t), ˜rc(d2, t), . . . , ˜rc(dN , t) sampled from N days for
time index t are independent with each other for every time
index t. For convenience, we omit the time index t of rc(t)
in later discussions when there is no confusion.

samples,

There are two advantages to building uncertain sets for the
concatenated demand model rc. The ﬁrst one is that theories
and results proposed for i.i.d. sampled dataset is applicable
to design uncertainty sets based on a spatial-temporal dataset.

6

The second one is computational efﬁciency, that we are able
to construct an uncertain set with spatial-temporal properties
for all regions during several consecutive predicting time slots
by calculating a hypothesis testing one time. It is worth noting
that the objective function of problem (11), a function concave
of rk, k = 1, . . . , τ is still concave of the uncertain parameter
rc with the uncertainty sets constructed in this section. This
property guarantees that uncertainty sets constructed in this
work can be directly applied for the robust optimization
problem (11) with rk, k = 1, . . . , τ as parameters.

B. An uncertainty set with probabilistic guarantee

For convenience, we concisely denote all the variables of
the taxi dispatch problem as x. Assume that we do not
the true distribution P∗(rc) of the
have knowledge about
random demand vector rc. When the uncertainty parameter
is included in the objective function J(rc, x) of problem (11),
the probabilistic guarantee for the event that the true dispatch
cost being smaller than the optimal dispatch cost is described
by the following chance constrained problem

x

M

min.
s.t Prc∼P∗(rc)(f (rc, x) = J(rc, x) − M (cid:54) 0) (cid:62) 1 − .
(12)
Here x ∈ Rn is the optimization variable, and rc ∈ Rτ n
is an uncertain parameter. The constraint f and objective
function J are concave in rc for any x, and convex in x
for any rc. Without loss of generality about the objective and
constraint functions, equivalently we aim to ﬁnd solutions of
the following form of chance constrained problem

min.

x

J(x)

(13)

subject to Prc∼P∗(rc)(f (rc, x) (cid:54) 0) (cid:62) 1 − .

When it is difﬁcult to explicitly estimate P∗(rc), given con-
straints f (rc, x) that concave in rc for any x, we solve the
following robust optimization problem such that optimal solu-
tions of (14) satisfy the probabilistic guarantee of constraints
for problem (13)

min.

x

max
rc∼∆

J(x),

subject to f (rc, x) (cid:54) 0,

(14)

Then rc of problem (14) can be any vector in the uncertainty
set ∆ instead of a random vector in problem (13), and we
require that by solving an optimization problem with this
constrained uncertain set performance of optimal solutions is
guaranteed for rc ∼ P∗. Another requirement is that the robust
optimization problem is computationally tractable problem
with this uncertainty set. To emphasize the probability of
holding the constraint of (13) with the uncertainty set ∆
of the robust dispatch problem, we denote the uncertainty
set as U for the the process of constructing a computation-
ally tractable uncertainty set. Hence, for a general form of
constraint function f (rc, x) appeared in robust taxi dispatch
problem, the uncertainty set construction problem is deﬁned
as the following:
Problem 1: Construct an uncertainty set U, given  and a

data set of random vectors rc, such that

(P1). The robust constraint (14) is computationally tractable.
(P2). The set U implies a probabilistic guarantee for the
true distribution P∗(rc) of a random vector rc at level , that
is, for any optimal solution x∗ ∈ Rk and for any function
f (rc, x) concave in rc, we have the implication:

∗
If f (rc, x
then P∗

) ≤ 0,

for ∀rc ∈ U,

∗
rc∼P∗(rc)(f (rc, x

) (cid:54) 0) ≥ 1 − .

(15)

The given probabilistic guarantee level  is related to the
degree of conservativeness of the robust optimization problem.
The trade-off between the average cost of robust optimal
solutions and the probabilistic level is shown by evaluations in
Section VI. It is worth noting that a conﬁdence region Uc, of
the random vector that satisﬁes P(rc ∈ Uc,) (cid:62) 1−  does not
need to be the same with the uncertainty set U satisﬁes (15)
in general [4]. Instead of purely building a conﬁdence region
Uc,, we focus on the performance of the robust solutions based
on the data-driven uncertainty sets.

The probabilistic guarantee considered in robust optimiza-
tion literature is stronger than what we require in this work,
that the above implication (15) should be satisﬁed for any
feasible solution x of the robust optimization problem [8], [7].
In practice, we will apply the optimal solution of the robust
dispatch problems as suggestions for taxi drivers, hence only
the optimal solution will affect the performance of the dispatch
framework, and we require implication and empirical
test
of (15) for optimal solutions only in this work.

C. Uncertainty Modeling

In this section, we brieﬂy review the theories related to
constructing uncertainty demand models based on a spatial-
temporal dataset considered in this work. Since we do not
assume that the marginal distribution for every element of
vector rc is independent with each other, we select
two
approaches without any assumptions about the true distribution
P∗(rc) in the literature [8] [14] [27]. The basic idea is to
ﬁnd a threshold for a hypothesis testing that is acceptable
with respect to the given dataset and a required probabilistic
guarantee level, and then construct an uncertainty set based
on the hypothesis testing. We brieﬂy review the process of a
hypothesis testing and the formulations of the uncertainty sets.
Hypothesis testing is a widely applied technique to examine
the property of a data set [21]. A hypothesis testing starts
from a given null-hypothesis H0 that makes a claim about an
unknown distribution P∗, and we need to decide whether to
accept H0 or reject it, based on a data set S drawn from P∗.
The fact that a null-hypothesis is false means there is no sufﬁ-
cient evidence to determine its validity. A typical test designs
a statistic T ≡ T (S, H0), and a threshold Γ ≡ Γ(αh,S, H0),
where αh is a given signiﬁcance level for data S on hypothesis
H0. If T > Γ, we reject H0. T is also random since it depends
on the randomly sampled data S. The threshold Γ is the value
that with a probability at most αh, H0 will be incorrectly
rejected with respect to samples S.

1) Uncertainty demand sets built from marginal samples:
One intuitive description about a random vector is to deﬁne a
range for each element.

For instance, David and Nagaraja [14] considered the
following multivariate hypothesis with given thresholds
¯qi,0, qi,0

i = 1, 2, . . . , τ n

∈ R,

H0,i :inf{t : P(rc,i (cid:54) t) (cid:62) 1 − 
τ n
inf{t : P(−rc,i (cid:54) t) (cid:62) 1 − 
τ n

} (cid:62) ¯qi,0
} (cid:62) −qi,0.

(16)

This hypothesis is related to the bound of the 
τ n probability
value on the random vector, and we divide  by τ n because
rc is a multivariate random vector that we need the hypoth-
esis testing for each component rc,i holds simultaneously to
provides the probabilistic guarantee described as (15).
for each
component rc,i of rc, ordered in increasing value as
c,i , r(2)
r(1)
c,i no matter the original sample order. Then
this order is also the order of the estimated value ˆrc,i, i.e.,
ˆr(1)
c,i = r(1)

Assume that we have N random samples

c,i . We deﬁne the index s by

c,i , . . . , r(N )

(cid:18) N

(cid:19)(cid:16) 

(cid:17)N−j(cid:16)

j

τ n

1 − 
τ n

(cid:17)j (cid:54) αh

2τ n

 ,

c,i , . . . , ˆr(N )
N(cid:88)

k ∈ N :

j=k

s = min

c,i

(cid:62) −qi,0,

(17)
and let s = N + 1 if the corresponding set is empty. The test
H0 is rejected if
ˆr(s)
c,i

(cid:62) ¯qi,0 or − ˆr(N−s+1)

c,i and ˆr(N−s+1)

To construct an uncertainty set, we need an accepted hypoth-
c,i and qi,0 = ˆr(N−s+1)
esis test. Hence, we set ¯qi,0 = ˆr(s)
with ˆr(s)
from the sampled dataset, then H0,i is
always accepted. The following uncertainty set is then applied
in this work based on the range hypothesis testing (16).
Proposition 1 ( [8], [14]): If s deﬁned by equation (17)
satisﬁes that N − s + 1 < s, then, with probability at least
1 − αh over the sample, the set

c,i

c,i

(cid:110)
rc ∈ Rτ n : ˆr(N−s+1)

c,i

(cid:54) rc,i (cid:54) ˆr(s)

c,i

(18)

U M
 (rc) =

(cid:111)

implies a probabilistic guarantee for P∗(rc) at level .

c,i

The hypothesis (16) is tested for each component rc,i
separately, and the uncertainty demand model also describes
the range of rc,i, i = 1, 2, . . . , τ n separately provided by
Proposition 1. We do not assume that the marginal distribu-
tions of P∗ are independent, their correlations are reﬂected in
the box uncertainty set in the sense that changing the value
of n and τ result in a different index value s (17), and the
order statistics ˆr(N−s+1)
c,i will be different. However,
the model of the box type of uncertainty set formula does
not directly describe the spatial-temporal correlations among
components of rc.

and ˆr(s)

2) Uncertainty set motivated by moment hypothesis testing:
Though the box type of uncertainty set reﬂects the spatial-
temporal correlations by varying range values with different
dimensions of rc,
is not easy to tell directly from the
uncertainty set (18) when the range of one component changes
how will others be affected. To construct an uncertainty set that
directly shows the spatial-temporal correlations of the demand
model, we consider to apply hypothesis testing related to the
ﬁrst and second moments of the random vector. The following
null assumptions are about the mean and covariance of the true
distribution P∗(rc) of random vector rc [27]

it

7

[rcrT

c ] − EP∗

[rc] = r0 and EP∗

H0 : EP∗
c ] = Σ0,
with test statistics T deﬁned as (cid:107)ˆrc−r0(cid:107) and (cid:107) ˆΣ−Σ0(cid:107). Given
thresholds ΓB
2 , H0 is rejected when the difference
among the estimation of mean or covariance according to
multiple times of samples is greater than the threshold, i.e.,

1 and ΓB

[rc]EP∗

[rT

c ] − EP

[˜rc] − ˆrc(cid:107)2 > ΓB
1 or
c ] − ˆΣ(cid:107)F > ΓB
[˜rc]EP
[˜rT
[˜rc˜rT
2 ,

(cid:107)EP
(cid:107)EP
where EP
[˜r] is the estimated mean value of one experiment, ˆrc
and ˆΣ are the estimated mean and covariance of multiple times
of experiments. The remaining problem is then to select the
thresholds such that the above hypothesis testing holds given
the dataset. In the following Section IV, the detailed steps of
calculating the thresholds ΓB
2 at a desired signiﬁcance
value αh and probabilistic guarantee level  based on the given
dataset is described2.

1 and ΓB

testing is deﬁned in the following proposition.

The uncertainty set derived based on the moment hypothesis
Proposition 2 ( [8], [27]): With probability at least 1− αh
with respect to the sampling, the following uncertainty set
U CS
(rc) implies a probabilistic guarantee level of  for P∗(rc)
U CS
(rc) ={rc (cid:62) 0, ˆrc + y + C T w : ∃y, w ∈ Rnτ s.t.





(cid:107)y(cid:107)2 (cid:54) ΓB

1 ,(cid:107)w(cid:107)2 (cid:54)

1 − 


},

(19)

(cid:114)

where C T C = ˆΣ + ΓB

2 I is a Cholesky decomposition.

By testing the properties of both ﬁrst and second moments
of the dataset, the uncertainty set (19) reﬂects the spatial-
temporal correlations of the demand model directly compared
with the box type (18). When one component of rc increases or
decreases, we have an intuition how it affects the value of other
components of rc by the expression (19). More properties of
each type of uncertainty set and application level problems,
such as how to choose the number of samples N for the
hypothesis testing with high dimensional rc will be discussed
in evaluations of Section VI.

IV. ALGORITHM FOR CONSTRUCTING UNCERTAIN

DEMAND SETS

Given a dataset, the algorithm for constructing uncertainty
sets includes three main steps—getting a sample set of rc from
the original dataset and partition the sample set, bootstrapping
a threshold for the test statistics according to the requirement
of the probability guarantee, and calculating the model of
uncertainty sets based on the thresholds. In this section, we
explain each step, summarize the process in Algorithm 1, and
discuss factors to consider for choosing parameters of the
algorithm. Numerical examples are shown in Section VI.

A. Aggregating demand and partition the sample set

The ﬁrst step is to transform the original dataset of taxi
operational records to a dataset of sampled vector ˜rc(d, t)

2Bootstrapped thresholds and theoretic bounds proposed by work [21] are
compared in [8]. The bootstrapped thresholds result in a smaller uncertainty
set in general, hence reduces the ambiguity in P∗. In this work, we apply the
bootstrapped thresholds ΓB

2 based on the dataset.

1 and ΓB

8

Figure 3.
Intuition for partitioning the whole dataset. When the data set
includes data from three distributions P1, P2, P3, without prior knowledge,
we can build a larger uncertainty set that describes the range of all samples
in the dataset. The problem is that the uncertainty set is not accurate enough.

of different dates for each index t. For instance, assume we
choose the length of each time slot as one hour, and the
dataset records all trip information of taxis during each day.
According to the start time and GPS coordinate of the pick-up
position of each trip, we aggregate the total number of pick
up events during one hour at each region to get samples of
rk, k ∈ {1, 2, . . . , τ} and the concatenated demand vector rc.
It is computationally efﬁcient to process the original data for
obtaining a sample set of rc in general, though the amount
of available taxi trips or trajectory information is large – the
time complexity is O(Nrecord) of the number of total records
Nrecord. By only passing through the raw data once, we are
able to group each pick up and drop off events to a speciﬁc
discretized time slot and region.

We assume that the dataset contains independent samples
of the random vector rc, and we do not impose any prior
knowledge of the true distribution P∗(rc). It is always possible
to describe the support of the distribution of the entire dataset,
even when all samples contained in the dataset do not follow
the same distribution, as explained in Figure 3. When there
is prior knowledge or categorical information such that the
dataset can be partitioned into several subsets according to
some feature space, we get a more accurate uncertainty set
according to each sub-dataset to provide the same probabilistic
guarantee level compared with the uncertainty set from the
entire dataset.

Clustering algorithms with categorical information [19] is
applicable for dataset partition when information besides pick
up events is available in the dataset, such as weather or trafﬁc
conditions. It is worth noting that if the uncertainty sets are
information set I = {I1,I2, . . .},
built for a categorical
then for the robust dispatch problems, we require the same
set of categories is available in real-time, hence we apply
the uncertainty set built for I1 to ﬁnd solutions when the
current situation is considered as I1. For instance, when there
is additional information like weather or trafﬁc condition for
each trip provided by the taxi operational records, these types
of information can be used as categorical information for
clustering. The dataset applied in the evaluations of Section VI
does not have additional categorical information of trips that
available for a clustering algorithm such as [19], hence, we
partition the dataset as demand during weekdays and demand
during weekends. Even with this simple and intuitive partition
process, we shrink the area of an uncertainty for the same
probabilistic guarantee level. Then during weekdays (week-
ends) we use uncertainty sets built from weekdays (weekends)

data to calculate robust dispatch solutions.

B. Algorithm

The uncertainty sets designed in this work require an
accepted null hypothesis testing. Given original operational
records data, the null hypothesis H0, αh, and the test statistics
T , we need to ﬁnd a threshold that accepts H0 at signiﬁcance
value α for each subset of sampled demand vectors. With a
threshold of the test statistics calculated via the given dataset,
we then apply the formula (18) for constructing a box type
of uncertainty set, and the formula (19) for an SOC type
of uncertainty set, respectively. The following Algorithm 1
describes the complete process for constructing uncertain
demand sets based on the original dataset.

Algorithm 1 Algorithm for constructing uncertain demand
sets
Input: A dataset of taxi operational records
1. Demand aggregating and sample set partition
Aggregate demand to get a sample set S of the random demand
vector rc from the original dataset. Partition the sample set S
and denote a subset S(Ip) ⊂ S, p = 1, . . . , P as the subset
partitioned according to either prior knowledge or categorical
information Ip. Denote the partitioned sample subset for each
time index t as S(t, Ip).
2. Bootstrapping thresholds for test statistics
for each subset S(t, Ip) do
Initialization: Testing statistics T , a null-hypothesis H0, the
probabilistic guarantee level , a signiﬁcance level 0 < αh <
1, the number of bootstrap time NB ∈ Z+.
Estimate the mean ˆrc(t, Ip) and covariance ˆΣ(t, Ip) for
vector rc based on subset S(t, Ip).
for j = 1, . . . , NB do
(1). Re-sample S j(t, Ip) = {˜rc(d1, t, Ip), . . . , ˜rc(dN , t, Ip)}
data points from S(t, Ip) with replacement for each t.
(2). Get the value of the test statistics based on S j(t, Ip).
end for
(3). Get the thresholds of the α signiﬁcance level for H0.
end for
3. Calculate the model of uncertainty sets
Get
the box type and the SOC type of uncertainty sets
according to (18) and (19), respectively, for each t and Ip.
Output: Uncertainty sets for problem (11)

We do not restrict the method of estimating mean ˆrc(t, Ip)
and covariance ˆΣ(t, Ip) matrices of a subset S(t, Ip) in step
2, and bootstrap is one method for this step. The estimations
of this step are considered as the true mean and covariance for
2 in the following repeated sampling pro-
calculating ΓB
cess. For step 2.(2), the process for the box type of uncertainty
sets is: calculate index s that satisﬁes (17) with the given ,
sort each component of sampled vectors rc(dl, t, Ip), and get
the order statistics r(N−s+1)
c,i (j, t, Ip) of the j-th
sample set S j(t, Ip). For the SOC type, we calculate the mean
and covariance of the samples of the vector according to the
subset S j(t, Ip) as ˆrc(j, t, Ip) and ˆΣ(j, t, Ip), respectively.
In step 2.(3), the αh level thresholds for the box type of
uncertainty sets are the (cid:100)NB(1 − αh)(cid:101)-th largest value of the

(j, t, Ip), r(s)

1 and ΓB

c,i

P2PP1P3c,i

c,i (j, t, Ip) and the (cid:100)NBαh(cid:101)-th largest value
upper bound r(s)
of the lower bound r(N−s+1)
(j, t, Ip) for the i-th component
of each t and Ip. For the SOC type of uncertainty sets, we
calculate the mean and covariance of rc(t, Ip) for the NB
times bootstrap as ˆrc(t, Ip) and ˆΣ(t, Ip), and get
Γ1(j, t, Ip) = (cid:107)ˆrc(j, t, Ip) − ˆrc(t, Ip)(cid:107)2,
Γ2(j, t, Ip) = (cid:107) ˆΣ(j, t, Ip) − ˆΣ(t, Ip)(cid:107)2.

Denote the (cid:100)NB(1 − αh)(cid:101)-th largest value of Γ1(j, t, Ip) and
Γ2(j, t, Ip)as ΓB

2 (t, Ip), respectively.

1 (t, Ip) and ΓB

Remark 1: The process of constructing uncertainty sets
only requires that the hypothesis test is accepted for i.i.d.
samples of the random vector. We accept the hypothesis test
when there is not enough evidence to reject it, which does
not mean the claim of H0 is true. This property is very
important for constructing the uncertainty demand set of the
robust dispatch problem, since the true distribution function of
a demand model can be complex and we only have datasets
of taxi operational records instead of ground truth knowledge
of the distribution function. Hence, even without enough
knowledge of the true, high-dimensional demand model, based
on the dataset and an accepted hypothesis test, we are able to
construct an uncertainty set with probabilistic guarantee for
the robust taxi dispatch problem.

It is worth noting that the above Algorithm 1 provides a
valid estimation of uncertain sets based on hypothesis testing
and bootstrapped thresholds for the robust resource allocation
problem when the sampled data set is consistent with the real
world scenario. For demand missed in the dataset, for instance,
some customer might leave the request queue after waiting
for a long time and the operational records did not show the
event of picking up the customer, we are not able to get the
exact rate of missed customers. However, missed requests are
only part of the historical requests, and this type of events is
also random – for instance, even for the same time length of
waiting, some customers were more patient and ﬁnally got a
taxi. By constructing an uncertainty set to describe the demand
model based on occurred records of the original dataset, we
involve the effect of random missing events better than only
applying a deterministic model from this perspective.

In summary, to construct a spatial-temporal uncertain de-
mand model for the robust taxi dispatch (11), in this section,
we consider the taxi operational record of each day as one
independent and identically distributed (i.i.d.) sample for the
concatenated demand vector rc. By partitioning the entire
dataset to several subsets according to categorical informa-
tion such as weekdays and weekends, we are able to build
uncertainty sets for each subset of data without additional
assumptions about the true distribution of the spatial-temporal
demand proﬁle. Then we apply theories proved for i.i.d.
samples of random vectors in the literature [8] [14] [27] to
construct a box type and an SOC type of uncertainty sets.
The key advantage of the data-driven approach we propose is
that we do not rely on prior knowledge of the true distribution
of the random demand vector to provide a desired probabilistic
guarantee of robust solutions. Furthermore, theories proved for
i.i.d. datasets are applicable to construct uncertainty sets that
reﬂect the spatial-temporal correlations of the demand model.

9

V. COMPUTATIONALLY TRACTABLE FORMULATIONS

tractability of a robust

We build equivalent computationally tractable formulations
of problem (11) with different deﬁnitions of uncertain sets
built in Section III in this section, and show that the robust
taxi dispatch problem in this work can be solved efﬁciently.
Computational
linear programming
problem for ellipsoid uncertainties are discussed in [5]. The
process is to reformulate constraints of the original problem
to equivalent convex constraints that must hold given the
uncertainty set. The objective function of problem (11) is
concave of the uncertain parameters rk, convex of the decision
variables X k, Lk with the decision variables on the denomi-
nators, hence, not standard forms of linear programming (LP)
or semi-deﬁnite programming (SDP) problems that already
covered by previous work [5], [8]. Hence, we prove one
equivalent computationally tractable form of problem (11) for
each uncertainty set constructed in Section III.

Only the JE components of objective functions in (11)
include uncertain parameters, and the decision variables of
the function are in the denominator of the function JE. The
box type uncertainty set deﬁned as (18) is a special form
of polytope, hence, we ﬁrst prove an equivalent standard
form of convex optimization problem for (11) for a polytope
uncertainty set as the following.

Theorem 1: (Next step dispatch) If the uncertainty set of
problem (11) when τ = 1 is deﬁned as the following polytope

∆ := {r ≥ 0, Ar ≤ b},

and we omit the superscripts k for variables and parameters
without confusion. Then problem (11) with τ = 1 is equivalent
to the following convex optimization problem

minimize
X≥0,λ≥0

XijWij + bT λ

(cid:88)

(cid:88)

i

j



subject to AT λ − β

 ≥ 0,

(20)

n X·1−X1·1n+L1)α

(1T

1

...

1

n X·n−Xn·1n+Ln)α

(1T

n X − X1n + LT (cid:62) 1,
1T
XijWij ≤ mXij,
Xij ≥ 0,

∀i, j ∈ {1, . . . , n}.

Proof: See Appendix VIII-A.

For the multi-stage robust optimization problem (11), we
prove that the order of minimize and maximum is exchange-
able in the following theorem, and equivalent computationally
tractable forms are proved based on this theorem.

Lemma 1: (Exchange the order of minimize and maximum)
Assume that the deﬁnition of the uncertainty set ∆ satisﬁes
that the domain of each rk is a compact set, then the multi-
stage robust dispatch problem deﬁned as (11) is equivalent to
the following robust dispatch problem

min.
X k,Lk

max
rk∈∆k
s.t.

J =

(JD(X k) + βJE(X k, rk))

k=1

constraints of (11), k = 1, . . . , τ.

(21)

τ(cid:88)

10

Here L1 is the initial number of vacant taxis within each region
before dispatch provided by sensor information, not a decision
variable, and we omit the time index of Lk, k = 2, . . . , τ in
minimization for notation convenience.

Proof: See Appendix VIII-B.

For the multi-stage robust optimization problem (11), the
computationally tractable convex form depends on the deﬁni-
tion of uncertainty sets. For a multi-stage robust optimization
problem that minimax theorem does not hold, an approximated
semideﬁnite programming form for calculating time depen-
dent control input of linear dynamical systems affected by
uncertainty is proposed in [9]. When conditions of Lemma 1
hold, equivalent convex optimization forms of problem (11)
are derived based on problem (21).

The box type uncertainty set (18) is a special form of
polytope, that the uncertain demand model during different
time of a day is described separately. The process of converting
problem (11) to an equivalent computationally tractable con-
vex form is similar to that of the one-stage robust optimization
problem. The result is described as the following lemma.

Lemma 2: If the uncertain set for rk, k = 1, . . . , τ describes
each demand vector rk separately as a polytope with the form

∆k := {rk ≥ 0, Akrk ≤ bk},

k = 1, . . . , τ,

(22)

problem (11) is equivalent to the following convex optimiza-
tion problem

τ(cid:88)

(
k=1

(cid:88)

i

(cid:88)


j

min.

X k,λk,Lk≥0

subject to AT

k λk − β

X k

ijWij + bT

k λk)

1 )α

(1T

1
n X k·1−X k
1·1n+Lk
...
1
n X k·n−X k
n·1n+Lk

(1T

n)α

 ≥ 0,

(23)

other constraints of (11), k = 1, . . . , τ.

Proof: See Appendix VIII-C1.
For a more general case that

the uncertainty sets for
r1, . . . , rτ are temporally correlated, the following theorem
and proof describe the equivalent computationally tractable
convex form of (11).

Theorem 2: When ∆ is deﬁned as the following polytope
∆ := {(∆1, . . . , ∆τ )|A1r1 + ··· + Aτ rτ ≤ b, rk ≥ 0},

(24)
problem (11) is equivalent to the following convex optimiza-
tion problem

τ(cid:88)

(cid:88)

(

k=1

i

(cid:88)


j

min.

X k,Lk,λ≥0

X k

ijWij) + bT λ

subject to AT

k λ − β

(1T

1 )α

1
n X k·1−X k
1·1n+Lk
...
1
n X k·n−X k
n·1n+Lk
k = 1, . . . , τ.

n)α

(1T

constraints of (11),

 ≥ 0,

(25)

Proof: See Appendix VIII-C2.

With an uncertain demand model deﬁned as (19) for
the following theorem derive the

concatenated r1, . . . , rτ ,
equivalent computationally tractable form of problem (11).
Theorem 3: When the uncertainty set for r1, . . . , rτ

is
deﬁned as the SOC form of (19), problem (11) is equivalent
to the following convex optimization problem (26).

τ(cid:88)

k=1

(cid:88)
(cid:32)

i

(cid:88)

j

min.
X k,Lk,z

+ β

ˆrT
c z + ΓB
subject to cl(X) (cid:54) z,

X k

ijWij

1 (cid:107)z(cid:107)2 +

(cid:114)

− 1(cid:107)Cz(cid:107)2

1


(cid:33)

(26)

constraints of (11),

k = 1, . . . , τ,

where cl(X) ∈ Rτ n is the concatenation of c(X 1), . . . , c(X τ ).

Proof: See Appendix VIII-D.

It is worth noting that any optimal solution for problem (10)
has a special form between any pair of regions (i, q).
Proposition 3: Assume X 1∗, . . . , X τ∗ is an optimal solu-
tion of (10), then any X k∗ satisﬁes that for any pair of (p, q),
at least one value of the two elements X k∗

qi and X k∗

Proof: We prove by contradiction. Assume that one opti-
iq > 0.
iq, and let

mal solution has the form X k such that X k
Without loss of generality, we assume that X k

qi > 0 and X k

qi ≥ X k

iq is 0.

X k∗
qi = X k

qi − X k

iq, X k∗

iq = 0,

other elements of X k∗ equal to X k. Then

n X k·i − X k
1T

i·1n + Lk

i = 1T

n X k∗

because(cid:88)

ji −(cid:88)
(cid:88)

l

X k

j

=X k∗

qi + 0 +

X k

iq +

il = X k

ij −(cid:88)

qi − X k
X k∗
qi =

X k∗

j(cid:54)=q

l(cid:54)=q

i· 1n + Lk
i ,

·i − X k∗
(cid:88)
(cid:88)

j(cid:54)=q

X k

X k∗

ij −(cid:88)
ji −(cid:88)

l(cid:54)=q

j

l

X k
qi

X k∗
il .

Hence, we have JE(X k, rk) = JE(X k∗, rk). All constraints
are satisﬁed and X k∗ is also a feasible solution for (11).
Next, we compare JD(X k) and JD(X k∗). With X k
iq > 0, and X k∗
X k
qi > X k∗
X k
qi , X k

iq ≥ 0, we have
iqWiq > X k∗

qi − X k
qiWqi + X k

qi Wqi + X k∗

qi = X k

iq Wiq.

qi >

Thus the partial cost JD(X k) > JD(X k∗), which contradicts
with the assumption that X k is an optimal solution. To
summarize, we show that an optimal solution cannot have
iq > 0 at the same time, and at least one of X k∗
X k
qi > 0, X k
and X k∗

iq should be 0.

With equivalent convex optimization forms under different
uncertainty sets, robust taxi dispatch problem (11) is compu-
tationally tractable and solved efﬁciently.

qi

VI. DATA-DRIVEN EVALUATIONS

We conduct data-driven evaluations based on four years of
taxi trip data of New York City [15]. A summary of this data
set is shown in Table II. In this data set, every record represents
an individual taxi trip, which includes the GPS coordinators

of pick up and drop off locations, and the date and time (with
precision of seconds) of pick-up and drop-off locations. One
region partition example according to the map of Manhattan
of New York City is shown in Figure 4 where we visualize the
density of taxi passenger demand with the data we used for
our large-scale data-driven evaluation. The lighter the region,
the higher the daily demand density. As we can see in the
ﬁgure, the middle regions typically have higher density than
the uptown and downtown regions in Manhattan. We construct
uncertainty sets according to Algorithm 1, discuss factors that
affect modeling of the uncertainty set, and compare optimal
costs of the robust dispatch formulation (11) and the non-
robust optimization form (10) in this section.

How vacant taxis are balanced across regions with
different α values: Figure 5 shows mismatch between supply
and demand deﬁned as (7) for different optimal solutions of
minimizing JE deﬁned in (6) for α ∈ (0, 1]. With α closer to
0, the optimal value of (7) is smaller. We choose α = 0.1 for
calculating optimal solutions of (11) and (10) in this section.

A. Box type of uncertainty set

For all box type of uncertainty sets shown in this subsection
with the model described in Subsection III-C1, we set the
conﬁdence level of hypothesis testings as αh = 10%, bootstrap
time as Nb = 1000, number of randomly sampled data (with
replacement) for each time of bootstrap as N = 10000.

Partitioned dataset compared with non-partitioned
dataset: We show the effects of partitioning the trip record
dataset by weekdays and weekends in Figure 6 and 7. The
whole city is partitioned into 50 regions and the prediction
time horizon τ = 4,  = 0.3, and every rc ∈ R200×1. Figures 6
and 7 show the lower and upper bounds of each region
during one time slot of (18). By applying data of weekdays

Figure 4. Map of Manhattan area in New York City.

Figure 5. Comparison of demand and supply mismatch values deﬁned as (7)
with different solutions for minimizing JE deﬁned in (6) with α in range
(0, 1]. The value of function (7) under an optimal solution of JE is smaller
with an α closer to 0, which means the dispatch solution tends to be more
balanced throughout the entire city.

11

Figure 6. Comparison of box type of uncertainty sets constructed from all
data and those constructed only based on trip records of weekdays. When
keeping all parameters the same, by applying data of weekdays, the range of
uncertainty set for each rc,i is smaller than that based on the whole dataset.

Figure 7. Comparison of box type of uncertainty sets constructed from all
data and uncertainty sets constructed only based on trip records of weekends.

and weekends separately, the range [ˆr(s)
] of each
component is reduced. To get a measurement of the uncertainty
level, we deﬁned the sum of range of every component for ˆrc
as the following

c,i

c,i , ˆr(N−s+1)

U (ˆrc) =

c,i − ˆr(N−s+1)
(ˆr(s)

c,i

).

τ n(cid:80)

i=1

For the box type of uncertainty sets, when values of the
dimension of rc, i.e., τ n, αh and  are ﬁxed, a smaller U (ˆrc)
means a smaller area of the uncertainty set, or a more accurate
model. We denote U (ˆrc) calculated via records of weekdays
and weekends as Uwd(ˆrc) and Uwn(ˆrc) respectively, compared
with U (ˆrc) constructed from the complete dataset, we have

U (ˆrc) − Uwd(ˆrc)

U (ˆrc)

= 52%,

U (ˆrc) − Uwn(ˆrc)

U (ˆrc)

= 28%.

This result shows that when by constructing an uncertainty
set for each subset of partitioned data, we reduce the range
of uncertainty sets to provide the same level of probabilistic
guarantee for the robust dispatch problem. This is because
samples contained in each subset of data do not follow the
same distribution and can be categorized as two clusters.

Choose an appropriate N for high-dimensional rc: It is
worth noting that the index s affects the range selection for
every component rc,i, hence, for different values of αh, , τ, n,
we should adjust the number of samples N to get an accurate
estimation of the marginal range. As shown in Table V, N
need to be large enough for a large τ n value, or s is too
close to N and the upper and lower bounds ˆr(N−s+1)
, ˆr(s)
c,i
cover almost the whole range of samples. Hence, the box type
uncertainty set is not a good choice for large τ n value, though
the computational cost of solving problem (25) is smaller than
that of (26) with the same size of τ n.

c,i

00.10.20.30.40.50.60.70.80.91110152025αmismatch value DemandandsupplymismatchvaluechangewithαAll dataWeekdayAll dataWeekend12

Collection Period

01/01/2010-12/31/2013

Taxi Trip Data set
Data Size
100GB

Record Number
about 7 million

ID
Date

Trip Time

Start and end time

Format

Trip Location

GPS coordinates of start and end

NEW YORK CITY DATA IN THE EVALUATION SECTION.

Table II

N

10000
10000
10000
10000
10000

αh
0.1
0.1
0.3
0.1
0.1


0.2
0.5
0.2
0.2
0.5

n
50
50
50

1000
1000

τ
2
2
2
2
2

s

9992
9970
9991
9999
9999

n = 50, τ = 1
n = 50, τ = 3
n = 50, τ = 6
n = 10, τ = 3

n = 1000, τ = 3

ΓB
1
42.37
52.68
107.35
71.35
10.53

ΓB
2

1.52 × 105
4.29 × 104
8.23 × 105
3.56 × 105
2576.94

Table III

VALUE OF INDEX s FOR THE BOX TYPE UNCERTAINTY SET (17). FOR
LARGE τ n, N NEED TO BE LARGE, OR s IS TOO CLOSE TO N THAT THE

RANGE COVERS VALUES OF ALMOST ALL SAMPLES.

Data type Weekdays Weekends

Non partitioned

ΓB
1
ΓB
2

10.53
2576.94

13.84
2923.35

17.96
3864.47

Table IV

COMPARING THRESHOLDS WITH AND WITHOUT DISCRIMINATING

2 IS SMALLER, THE
WEEKDAYS AND WEEKENDS DATA. WHEN ΓB
VOLUME OF THE UNCERTAINTY SET IS SMALLER. HERE n = 1000, τ = 3,

1 OR ΓB

N = 1000,  = 0.3, αh = 0.2.

B. SOC type of uncertainty set



1 and ΓB

2 , the demand model U CS

The SOC type of uncertainty set is a high-dimensional
convex set that is not able to be plotted. The bootstrapped
thresholds for the hypothesis testing to construct the SOC
uncertainty sets based on partitioned and non-partitioned data
are summarized in Table IV. Similarly as the box type of
uncertainty sets, when we separate the dataset and construct
an uncertainty demand model for weekdays and weekends
respectively, the sets are smaller compared to the uncertain
demand model for all dates. When α and  values are ﬁxed,
is more
with smaller ΓB
accurate to guarantee that with at least probability 1 − ,
the constraints of the robust dispatch problems are satisﬁed.
Numerical results of this conclusion are shown in Table IV.
How n and τ affect the accuracy of uncertainty sets:
For a box type of uncertainty set, when τ n is a large value,
the bootstrap sample number N should be large enough such
that index s is not too close to N. Without a large enough
sample set, we choose to construct an SOC type of uncertainty
set (such as τ n = 1000, N = 10000 in Table V). Since
SOC captures more information about the second moment
properties of the random vector compared with the box type
uncertainty set, some uncorrelated components of rc will be
reﬂected by the estimated covariance matrix, and the volume
of the uncertainty set will be reduced. We show the value of
2 with different dimensions of rc or τ n values in
1 and ΓB
ΓB
1 and
table V. When increasing the value of τ n, values of ΓB
2 are reduced, which means the uncertainty set is smaller.
ΓB
However, it is not helpful to reduce the granularity of region
partition to a smaller than street level, since we construct the
model for a robust dispatch framework and a too large n is
not computationally efﬁcient for the dispatch algorithm.

C. Compare robust solutions with non-robust solutions

For testing the quality of the uncertainty sets applied in
the robust dispatch problems, we use the idea of cross-

COMPARING THRESHOLDS OF SOC UNCERTAINTY SETS FOR DIFFERENT
DIMENSIONS rc, BY CHANGING EITHER THE REGION PARTITION NUMBER

n OR THE PREDICTION TIME HORIZON τ .

Table V

validation from machine learning. The dataset is separated
as a training set for building the uncertain demand model,
and a testing set for comparing the results of the dispatch
solutions. The customer demand models applied in the robust
and non-robust optimization problems are different. For the
non-robust dispatch problem, the demand prediction rk is a
deterministic value. For instance, in this work we use the
average or mean of the bootstrapped value of the training
dataset. In the experiments, the idle geographical distance of
one taxi between a drop-off event of one passenger and the
following pick-up event is approximately as the one norm
distance between the 2D geographical coordinates (provided
as longitude and latitude values of GPS data in the trip dataset)
of the two points. Then the corresponding idle miles on ground
is converted from the geographical distance according to the
geographical coordinates of New York City.

In the robust dispatch problem, the part that directly includes
the uncertain demand rk is the penalty function for violating
a balanced demand-supply ratio requirement. For each testing
data rk, we denote the demand-supply ratio mismatch error of
a dispatch solution as (7). We then compare the value of (7)
of robust dispatch solutions with the SOC type of uncertainty
set constructed in this work with the value of (7) of non-
robust solutions of testing samples. The distribution of values
are shown in Figure 8. The average demand-supply ratio error
is reduced by 31.7% with robust solutions. We compare the
cost distribution of total idle distance in Figure 9. It shows
the average total idle distance is reduced by 10.13%. For all
testing, the robust dispatch solutions result in no idle distance
greater than 0.8 × 105, and non-robust solutions has 48% of
samples with idle distance greater than 0.8× 105. The cost of
robust dispatch (11) is a weighted sum of both the demand-
supply ratio error and estimated total idle driving distance, and
the average cost is reduced by 11.8% with robust solutions.
It means that the performance of the system is improved
when the true demand deviates from the average historical
value considering model uncertainty information in the robust
dispatch process. It is worth noting that the number of total
idle distance shown in this ﬁgure is the direct calculation result
of the robust dispatch problem. When we convert the number
to an estimated value of corresponding miles in one year, the
result is a total reduction of 20 million miles in NYC.

Check whether the probabilistic level  is guaranteed:

13

Figure 8. Demand-supply ratio error distribution of the robust optimization
solutions with the SOC type of uncertain demand set ( = 0.25, or
probabilistic guarantee level 75%) and non-robust optimization solutions. The
demand-supply ratio error of robust solutions is smaller than that of the non-
robust solutions, that the average demand-supply ratio error is reduced by
31.7%.

Figure 10. The percentage of tests that have a smaller true dispatch cost than
the optimal cost of the robust dispatch problem with the box type uncertainty
set constructed from data. When 1 −  decreases, the percentage value also
decreases, but always greater than 1 − .

Figure 9.
Total idle distance comparison of robust optimization solutions
with the SOC type of uncertain demand set ( = 0.25, or probabilistic
guarantee level 75%) and non-robust optimization solutions. The average
total idle distance is reduced by 10.13%. For all samples used in testing,
the robust dispatch solutions result in no idle distance greater than 0.8× 105,
and non-robust solutions has 48% of samples with idle distance greater than
0.8× 105. The number of total idle distance shown in this ﬁgure is the direct
calculation result of the robust dispatch problem, and we convert the number
to an estimated value of corresponding miles in one year, the result is a total
reduction of 20 million miles in NYC.

Theoretically,
the optimal solution of the robust dispatch
problems with the uncertainty set should guarantee that with
at least the probability (1 − ), when the system applies the
robust dispatch solutions, the actual dispatch cost under a
true demand is smaller than the optimal cost of the robust
dispatch problem. Figures 10 and 11 show the cross-validation
testing result that the probabilistic guarantee level is reached
for both box type and SOC type of uncertainty sets via
solving (25) and (26), respectively. Comparing these two
ﬁgures, one key insight is that the robust dispatch solution
with an SOC type uncertainty set provides a tighter bound on
the probabilistic guarantee level that can be reached under the
true random demand compared with solutions of the box type
uncertainty set. It shows the advantage of considering second
order moment information of the random vector, though the
computational cost is higher to solve problem (26) than to
solve problem (25).

How probabilistic guarantee level affects the average
cost: There exists a trade-off between the probabilistic guar-
antee level and the average cost with respect to a random
vector rc. Selecting a value for  is case by case, depending on
whether a performance guarantee for the worst case scenario
is more important or whether the average cost performance is
more important. For a high probabilistic guarantee level or a
large 1 −  value, the average cost may not be good enough
since we minimize a worst case that rarely happens in the real

Figure 11.
The percentage of tests that have a smaller true dispatch cost
than the optimal cost of the robust dispatch problem with the SOC type of
uncertainty set. When 1 −  decreases, the percentage value also decreases,
but always greater than 1− . The true percentage value is closer to the value
of 1 −  compared with the solution given a box type uncertainty set.

Figure 12. Comparison of the optimal cost of the robust dispatch problem
with box type of uncertainty set and the average cost when applying the robust
solutions for the test subset of sampled rc. When  = 0.3 the average cost
is the smallest.

Figure 13. Comparison of the optimal cost of the robust dispatch problem
with SOC type of uncertainty set and the average cost when applying the
robust solutions for the test subset of sampled rc. When  = 0.25 the average
cost is the smallest.
world. When the 1− value is relatively small, the average cost
can also be large since many possible values of the random
vector are not considered.

We compare the optimal cost of robust solutions and average
cost of empirical tests for two types of uncertainty sets via
solving (25) and (26) in Figure 12 and 13, respectively. The

060120180240020%40%60%Demand supply ratio error rangePercentageDemand supply ratio error comparison  Robust solutionsNon−robust solutions0.70.80.911.11.21.3x 105025%50%75%Total idle distance rangePercentageTotal idle distance comparison   Robust solutionsNon−robust solutions00.10.20.30.40.50.60.70.80.91020%40%60%80%100%ϵPercentage value Percentage of experiments with satisfied constraints  Experiments1−ε00.10.20.30.40.50.60.70.80.911020%40%60%80%100%ϵPercentage valuePercentage of satisfied constraints for SOC model  Experiments1−ε00.10.20.30.40.50.60.70.80.910.75  1x 105costOptimal and average cost of robust dispatchBox uncertainty setRobust solutionsOptimal cost of (11) Non-robust solutions1.2500.10.20.30.40.50.60.70.80.9110.751x1051.25SOC uncertainty set costRobust solutions Non-robust solutions14

optimal cost of the robust dispatch framework shows that
the result of minimized worst case scenario for all possible
rc included in the uncertainty set, and the average cost of
empirical tests show the real world scenario when we applying
the optimal solution to dispatch taxis under random demand
rc. The horizontal line shows the average cost of non-robust
solutions since this cost is not related to . The  values that
provide the best average costs are not exactly the same for
different types of uncertainty sets according to the experi-
ments. For the box type of uncertainty set shown in Figure 12,
 = 0.3 provides the smallest average experimental cost, and
for SOC type of uncertainty set shown in Figure 13,  = 0.25
provides the smallest average experimental cost. The minimum
average cost of an SOC robust dispatch solution is smaller than
that of a box type. It indicates that the second order moment
information of the random variable should be included for
modeling the uncertainty set and calculating robust dispatch
solutions for the dataset we use in this section, though its
computational cost is higher.

VII. CONCLUSION

In this paper, we develop a multi-stage robust optimiza-
tion model considering demand model uncertainties in taxi
dispatch problems. We model spatial-temporal correlations of
the uncertainty demand by partitioning the entire data set
according to categorical information, and applying theories
without assumptions on the true distribution of the random
demand vector. We prove that an equivalent computationally
tractable form exist with the constructed polytope and SOC
types of uncertainty sets, and the robust taxi dispatch solutions
are applicable for a large-scale transportation system. A robust
dispatch formulation that purely minimizes the worst-case
cost under all possible demand usually sacriﬁces the average
system performance. The robust dispatch method we design
allows any probabilistic guarantee level for a minimum cost
solution, considering the trade-off between the worst-case cost
and the average performance. Evaluations show that under the
robust dispatch framework we design, the average demand-
supply ratio mismatch error is reduced by 31.7%, and the
average total idle driving distance is reduced by 10.13% or
about 20 million miles in total in one year. In the future, we
will enhance problem formulation considering more uncertain
characteristics of taxi network model, like trafﬁc conditions.

REFERENCES

[1] S. Ali, A. Maciejewski, H. Siegel, and J.-K. Kim. Measuring the
robustness of a resource allocation. IEEE Transactions on Parallel and
Distributed Systems, 15(7):630–641, July 2004.

[2] M. Asif, J. Dauwels, C. Goh, A. Oran, E. Fathi, M. Xu, M. Dhanya,
N. Mitrovic, and P. Jaillet.
Spatiotemporal patterns in large-scale
trafﬁc speed prediction. IEEE Transactions on Intelligent Transportation
Systems, 15(2):797–804, 2014.

[3] R. K. Balan, K. X. Nguyen, and L. Jiang.

In Proceedings of the 9th
International Conference on Mobile Systems, Applications, and Services,
pages 99–112.

[4] A. Ben-Tal, L. E. Ghaoui, and A. Nemirovski. Robust optimization.

Princeton University Press, 2009.

[5] A. Ben-Tal and A. Nemirovski. Robust convex optimization. Mathe-

matics of Operations Research, 23(4):769–805, 1998.

[6] D. Bertsekas, A. Nedi, A. Ozdaglar, et al. Convex Analysis and

Optimization. Athena Scientiﬁc, 2003.

[7] D. Bertsimas and D. B. Brown. Constructing uncertainty sets for robust

linear optimization. Oper. Res., 57(6):1483–1495, 2009.

[8] D. Bertsimas, V. Bupta, and N. Kallus. Data-driven robust optimization.

Operations Research, (arXiv: 1401.0212), 2015.

[9] D. Bertsimas, D. Iancu, and P. Parrilo. A hierarchy of near-optimal
IEEE Transactions on

policies for multistage adaptive optimization.
Automatic Control, 56(12):2809–2824, Dec 2011.

[10] G. C. Calaﬁore and L. E. Ghaoui. On distributionally robust chance-
Journal of Optimization Theory and

constrained linear programs.
Applications, 130(1):1–22, 2006.

[11] G. Chasparis, M. Maggio, E. Bini, and K.-E.

˚Arz´en. Design and
implementation of distributed resource management for time sensitive
applications. Automatica, 2015. Accepted for publication.

[12] J. Cortes, S. Martinez, T. Karatas, and F. Bullo. Coverage control
IEEE Transactions on Robotics and

for mobile sensing networks.
Automation, 20(2):243–255, 2004.

[13] F. A. Cuzzola, J. C. Geromel, and M. Morari. An improved approach for
constrained robust model predictive control. Automatica, 38(7):1183–
1189, 2002.

[14] H. David and H. Nagaraja. Order statistics. Wiley Online Library, 1970.
[15] B. Donovan and D. B. Work. Using coarse gps data to quantify city-
scale transportation system resilience to extreme events. In presented at
the 2015 Transportation Research Board Annual Meeting, July 2015.

[16] R. Ganti, M. Srivatsa, and T. Abdelzaher. On limits of travel time
predictions: Insights from a new york city case study. In 2014 IEEE 34th
International Conference on Distributed Computing Systems (ICDCS),
pages 166–175, June 2014.

[17] Y. Geng and C. Cassandras. New ”smart parking” system based on
resource allocation and reservations. IEEE Transactions on Intelligent
Transportation Systems, 14(3):1129–1139, 2014.

[18] J. Herrera, D. Work, R. Herring, X. Ban, Q. Jacobson, and A. Bayen.
Evaluation of trafﬁc data obtained via GPS-enabled mobile phones:
The Mobile Century ﬁeld experiment. Transportation Research Part
C, 18(4):568–583, 2010.

[19] Z. Huang. Extensions to the k-means algorithm for clustering large data
sets with categorical values. Data Mining and Knowledge Discovery,
2(3):283–304, Sept. 1998.

[20] D.-H. Lee, R. Cheu, and S. Teo. Taxi dispatch system based on current
Transportation Research
demands and real-time trafﬁc conditions.
Record:Journal of the Transportation Research Board, 8(1882):193–
200, 2004.

[21] E. Lehmann and J. Romano. Testing statistical hypotheses. Springer

Texts in Statistics, 2010.

[22] F. Miao, S. Han, S. Lin, and G. J. Pappas. Robust taxi dispatch under
model uncertainties. In 54th IEEE Conference on Decision and Control
(CDC), pages 2816–2821, Dec 2015.

[23] F. Miao, S. Lin, S. Munir, J. A. Stankovic, H. Huang, D. Zhang, T. He,
and P. G. J. Taxi dispatch with real-time sensing data in metropolitan
In 6th International
areas — a receding horizon control approach.
Conference of Cyber-Physical Systems, 2015.

[24] L. Moreira-Matias, J. Gama, M. Ferreira, J. Mendes-Moreira, and
L. Damas. Predicting taxi-passenger demand using streaming data. IEEE
Transactions on Intelligent Transportation Systems, 14(3):1393–1402,
Sept 2013.

[25] A. Pantoja and N. Quijano. A population dynamics approach for the
IEEE Transactions on Industrial

dispatch of distributed generators.
Electronics, 58(10):4559–4567, Oct 2011.

[26] M. Pavone, S. L. Smith, E. Frazzoli, and D. Rus. Robotic load balancing
for mobility-on-demand systems. Int. J. Rob. Res., 31(7):839–854, June
2012.

[27] J. Shawe-Taylor and N. Cristianini. Estimating the moments of a
random estimating the moments of a random vector with applications.
In GRETSI Conference, pages 47–52, 2003.

[28] K. I. Wong and M. G. H. Bell. The optimal dispatching of taxis
under congestion: A rolling horizon approach. Journal of Advanced
Transportation, 40:203–220, 2006.

[29] D. Work, S. Blandin, O. Tossavainen, B. Piccoli, and A. Bayen. A trafﬁc
model for velocity data assimilation. Applied Research Mathematics
eXpress (ARMX), pages 1–35, 2010.

[30] D. Zhang, T. He, S. Lin, S. Munir, and J. Stankovic. Dmodel: Online
taxicab demand model from big sensor data in a roving sensor network.
In 2014 IEEE International Congress on Big Data (BigData Congress),
pages 152–159, June 2014.

[31] D. Zhang, T. He, S. Lin, S. Munir, and J. Stankovic. Online cruising
mile reduction in large-scale taxicab networks. IEEE Transactions on
Parallel and Distributed Systems, 26(11):3122–3135, Nov 2015.

[32] R. Zhang and M. Pavone. Control of robotic mobility-on-demand
systems: a queueing-theoretical perspective. In Proceedings of Robotics:
Science and Systems, July 2014.

VIII. APPENDIX

A. Proof of Theorem 1

Proof: For any ﬁxed X, the maximum part of the objec-

tive function is equivalent to

max
r∈∆

JD(X) + βJE (X, r) = JD(X) + cT (X)r

[c(X)]i =β

1

n X·i − Xi·1n + Li)α

(1T

, JD(X) =

(cid:88)

(cid:88)

(27)

Xij Wij .

i

j

15

C. Proof of Lemma 2 and Theorem 2

1) Proof of Lemma 2:

Proof: With the polytope form
of uncertainty set (22), the domain of each rk is closed and
convex, i.e., is compact, and Lemma 1 holds. Considering the
maximizing part of problem (21)

max
rk∈∆k

J,

s.t.

constraints of (11),

(30)

the Lagrangian of (30) with multipliers λk ≥ 0, vk ≥ 0 is

L(X k, rk, λk, vk)

τ(cid:88)

The Lagrangian of problem (27) with the Lagrangian multi-
pliers λ ≥ 0, v ≥ 0 is

=

(JD(X k) + bT

k λk − (AT

k λk − c(X k) − vk)T rk),

(31)

L(X, r, λ, v) = JD(X) + bT λ − (AT λ − c(X) − v)T r,

where (AT λ − c(X) − v)T r is a linear function of r, and the
upper bound exists only when AT λ − c(X) − v = 0. The
objective function of the dual problem is

(cid:40)

L(X, r, λ, v)

g(X, λ, v) = sup
r∈∆
JD(X) + bT λ if AT λ − c(X) − v = 0.
∞ otherwise

=

With v ≥ 0, the constraint AT λ − c(X) − v = 0 is equivalent
to AT λ− c(X) ≥ 0. Strong duality holds for problem of (27)
since it is convex, and its dual problem is

λ≥0

JD(X) + bT λ

minimize
subject to AT λ − c(X) ≥ 0.

(28)

k=1

Hence, based on the proof of Theorem 1, we take partial
derivative of the Lagrangian (31) for every rk ∈ ∆k. Since
strong duality holds for problem (30), an equivalent form
of (11) under uncertainty set (22) is deﬁned as (23).

2) Proof of Theorem 2:

Proof: With uncertain set
deﬁned as (24),
the domain of each rk is compact and
Lemma 1 holds. We consider the equivalent problem (21) of
problem (11), and ﬁrst derive the Lagrangian of the maximum
part of the objective function (21) with constraint λ ≥ 0, vk ≥
0

L(X k, rk, λ, vk)

=bT λ − τ(cid:88)

((AT

k λ − c(X k) − vk)T rk − JD(X k)),

(32)

k=1

Hence, problem (11) with τ = 1 can be solved as the convex

optimization problem deﬁned in (20).

Similarly as the proof of Theorem 1, we take the partial
derivative of (32) over each rk, the objective function of the
dual problem is

τ(cid:88)

B. Proof of Lemma 1

Proof: Now consider the minimax problem over stage

k + 1 and k, 1 (cid:54) k (cid:54) τ − 1 of problem (11)

max
rk∈∆k

min

X k+1,Lk+1

J =

(JD(X k) + βJE(X k, rk))

(29)

k=1
constraints of (11).

s.t.

The domain of problem (29) satisﬁes that X k+1, Lk+1, λ is
compact, and the domain of rk is compact. The objective
function is a closed function convex over X k+1, Lk+1 and
concave over rk. According to Proposition 2.6.9 with condi-
tion (1) of [6], when the objective and constraint functions
are convex of the decision variables, concave of the uncertain
parameters, and the domain of decision variables and uncertain
parameters are compact, the set of saddle points of (29) is
nonempty. It means there exists an optimal minimax solution
that is also optimal for the maximin problem, and we can
exchange the order of max and min without changing such an
optimal solution, i.e.,

max
rk∈∆k

min

J = min

X k+1,Lk+1

X k+1,Lk+1

max
rk∈∆k

J.

L(X k, rk, λ, vk)
g(X k, Lk, λ, rk) = sup
rk∈∆k
k λ − c(X k) − vk (cid:54)= 0,

∞ if ∃k s.t. AT
τ(cid:80)

JD(X k) + bT λ o.w.

k=1

=

Since strong duality holds, problem (25) is a equivalent to the
computationally tractable convex optimization form (11) under
uncertain set (24).

D. Proof of Theorem 3

Proof: Under the deﬁnition of uncertainty set (19) for
concatenated rk,
the domain of each rk is compact, and
problem (11) is equivalent to (21). We now consider the dual
form for the objective function
JE(X k, rk) that relates to

τ(cid:80)

rk. By the deﬁnition of inner product, we have

k=1

cT (X k)rk = cT

l (X)rc, cl(X) = [cT (X 1) . . . cT (X τ )]T .

τ(cid:88)

k=1

16

cT

When the uncertainty set of rc is an SOC deﬁned as (19),
problem (21) is equivalent to



τ(cid:88)

(cid:88)
(cid:88)
(cid:114)

j

1


X k

ijWij

− 1,

(33)

min.
X k,Lk

max
rc(cid:62)0

l (X)rc +

k=1

i
subject to rc = ˆrc + y + C T w,
1 ,(cid:107)w(cid:107)2 (cid:54)
(cid:107)y(cid:107)2 (cid:54) ΓB
constraints of (11).

We ﬁrst consider the following minimax problem related to

the uncertainty set
max
rc(cid:62)0

cT
l (X)rc

subject to rc = ˆrc + y + C T w,
1 ,(cid:107)w(cid:107)2 (cid:54)

(cid:107)y(cid:107)2 (cid:54) ΓB

(cid:114)

− 1.

1


(34)

To get the dual form of problem (34), we start from the

following Lagrangian with v (cid:62) 0

L(X, rc, z, v) = cT

l (X)rc + zT (ˆrc + y + CT w − rc) + vT rc.

By taking the partial derivative of the above Lagrangian over
rc, we get the supreme value of the Lagrangian as

L(X, rc, z, v) =

sup
rc

zT (ˆrc + y + C T w)
∞ o.w.

if cl(X) (cid:54) z

(cid:40)

Then with the norm bound of y and w, we have

(zT (ˆrc + y + C T w))

(cid:107)y(cid:107)2(cid:54)ΓB

=ˆrT

c z + ΓB

sup

1 ,(cid:107)w(cid:107)2(cid:54)√
1 (cid:107)z(cid:107)2 +

1

(cid:114)

 −1
1


− 1(cid:107)Cz(cid:107)2.

Hence, the objective function of the dual problem for (34) is

(cid:40)

g(X, rc, z) = sup
rc∈U CS
1 (cid:107)z(cid:107)2 +



ˆrT
c z + ΓB
∞ o.w..

=

(cid:113) 1
L(X, rc, z)
 − 1(cid:107)Cz(cid:107)2,

if cl(X) (cid:54) z

Together with the objective function JD(X k) and other con-
straints that do not directly involve rc, an equivalent convex
form of (11) given the uncertainty set (19) is shown as (26).

