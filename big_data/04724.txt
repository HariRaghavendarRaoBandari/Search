6
1
0
2

 
r
a

 

M
5
1
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
4
2
7
4
0

.

3
0
6
1
:
v
i
X
r
a

ON THE DECOMPOSITION THRESHOLD OF A GIVEN GRAPH

STEFAN GLOCK, DANIELA K ¨UHN, ALLAN LO, RICHARD MONTGOMERY AND DERYK OSTHUS

Abstract. We study the F -decomposition threshold δF for a given graph F . Here an F -
decomposition of a graph G is a collection of edge-disjoint copies of F in G which together
cover every edge of G. (Such an F -decomposition can only exist if G is F -divisible, i.e. if
e(F ) | e(G) and each vertex degree of G can be expressed as a linear combination of the
vertex degrees of F .)

The F -decomposition threshold δF is the smallest value ensuring that an F -divisible

graph G on n vertices with δ(G) ≥ (δF + o(1))n has an F -decomposition.
Our main results imply the following for a given graph F , where δ∗

F is the fractional

version of δF and χ := χ(F ):

F , 1 − 1/(χ + 1)};

F , 1 − 1/χ, 1 − 1/(χ + 1)};

(i) δF ≤ max{δ∗
(ii) if χ ≥ 5, then δF ∈ {δ∗
(iii) we determine δF if F is bipartite.
In particular, (i) implies that δKr = δ∗
Kr by
Barber, K¨uhn, Lo, Montgomery and Osthus, (i) gives the best explicit bound on δF which
holds for arbitrary graphs F . Our proof involves further developments of the recent ‘iter-
ative’ absorbing approach.

Kr . Moreover, combined with bounds on δ∗

1. Introduction

Let F be a ﬁxed graph. A fundamental theorem of Wilson [20] states that for all suﬃ-
ciently large n, the complete graph Kn has an F -decomposition (subject to the divisibility
conditions discussed below). Here, an F -decomposition of a graph G is a collection of edge-
disjoint copies of F in G which together cover every edge of G. The case when F is a triangle
is known as Kirkman’s theorem [13].

The problem of determining whether an arbitrary graph G has an F -decomposition is
much more diﬃcult (in fact, the corresponding decision problem is NP-complete (see [5])).
Recently there has been some signiﬁcant progress in extending Wilson’s theorem to dense
graphs, i.e. graphs of large minimum degree — the current paper will build on this.

A clearly necessary condition for the existence of an F -decomposition is that e(F ) | e(G).
If this is satisﬁed, then we say that G is F -edge-divisible. Moreover, for r ∈ N, we call G
r-divisible, if r | dG(x) for all x ∈ V (G). We say that G is F -degree-divisible if it is gcd(F )-
divisible, where gcd(F ) := gcd{dF (v) :
v ∈ V (F )} (this is another trivially necessary
condition for the existence of an F -decomposition). If a graph G is both F -edge-divisible
and F -degree-divisible, then we simply say that G is F -divisible.

For a ﬁxed graph F , let δF be the minimum of the set of all non-negative real numbers
for all µ > 0 there exists an n0 ∈ N such that whenever
δ with the following property:
G is an F -divisible graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n, then G has an F -
decomposition. Clearly, the minimum exists. Note that isolated vertices in F are irrelevant
and the F -decomposition problem is trivial if F has only one edge. Thus in all our statements
concerning a given graph F , we will assume that F has no isolated vertices and e(F ) ≥ 2
without mentioning this explicitly.

Date: 16th March 2016.
The research leading to these results was partially supported by the EPSRC, grant no. EP/M009408/1
(D. K¨uhn and D. Osthus), by the Royal Society and the Wolfson Foundation (D. K¨uhn) as well as by the
European Research Council under the European Union’s Seventh Framework Programme (FP/2007–2013)
/ ERC Grant Agreements no. 258345 (D. K¨uhn, R. Montgomery) and 306349 (S. Glock and D. Osthus).

1

2

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

The purpose of this paper is to investigate the above F -decomposition threshold δF . In
particular, we determine δF for all bipartite graphs, improve existing bounds for general F
and prove a ‘discretisation’ result for the possible values of δF .

F , the fractional decomposition threshold δ∗

1.1. Bounding the decomposition threshold for arbitrary graphs. Our ﬁrst main
result (Theorem 1.1) bounds the decomposition threshold δF in terms of the approximate
decomposition threshold δ0+
F , and the threshold
δe
F for covering a given edge. We now introduce these formally.
Let F be a ﬁxed graph. For η ≥ 0, an η-approximate F -decomposition of an n-vertex
graph G is a collection of edge-disjoint copies of F contained in G which together cover all
but at most ηn2 edges of G. Let δη
F be the smallest δ ≥ 0 such that for all µ > 0 there
exists an n0 ∈ N such that whenever G is a graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n,
then G has an η-approximate F -decomposition. Clearly, δη′
F whenever η′ ≤ η. We let
F := supη>0 δη
δ0+
F .
Let GF be the set of copies of F in G. A fractional F -decomposition of G is a function

F ≥ δη

ω : GF → [0, 1] such that, for each e ∈ E(G),
XF ′∈GF : e∈E(F ′)
(1.1)

ω(F ′) = 1.

Let δ∗

Note that every F -decomposition is a fractional F -decomposition where ω(F ) ∈ {0, 1}.
F be the smallest δ ≥ 0 such that for all µ > 0 there exists an n0 ∈ N such that
whenever G is an F -divisible graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n, then G has a
fractional F -decomposition. Usually the deﬁnition considers all graphs G (and not only those
which are F -divisible) but it is convenient for us to make this additional restriction here as
δ∗
F is exactly the relevant parameter when investigating δF (in particular, we trivially have
δ∗
F ≤ δF ). Haxell and R¨odl [10] used Szemer´edi’s regularity lemma to show that a fractional
F -decomposition of a graph G can be turned into an approximate F -decomposition of G
(see Theorem 11.3). This implies δ0+

F (see Corollary 11.4).

Our ﬁrst result bounds δF in terms of the approximate decomposition threshold δ0+

F be the smallest δ such that for all µ > 0 there exists an n0 ∈ N such that whenever
G is a graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n, and e′ is an edge in G, then G
contains a copy of F which contains e′.
F and
the chromatic number of F . Parts (ii) and (iii) give much more precise information if χ ≥ 5.
We obtain a ‘discretisation result’ in terms of the parameters introduced above. We do not
believe that this result extends to χ = 3, 4 (see Section 15 for a further discussion). On the
other hand, we do have δF ∈ {0, 1/2, 2/3} if χ(F ) = 2 (see Section 1.3). We also believe
that none of the terms in the discretisation statement can be omitted.

F ≤ δ∗

Let δe

Theorem 1.1. Let F be a graph with χ := χ(F ).

F , 1 − 1/(χ + 1)}.

(i) Then δF ≤ max{δ0+
(ii) If χ ≥ 5, then δF ∈ {max{δ0+
(iii) If χ ≥ 5, then δF ∈ {δ∗
Theorem 1.1(i) improves a bound of δF ≤ max{δ0+
Since it is known that δ0+

F , 1 − 1/χ, 1 − 1/(χ + 1)}.

F , δe

F}, 1 − 1/χ, 1 − 1/(χ + 1)}.

graphs F . Also, the cases where F = K3 or C4 of (i) were already proved in [2].

F , 1 − 1/3r} proved in [2] for r-regular
Kr ≥ 1 − 1/(r + 1) (see e.g. [22]), Theorem 1.1 implies that the

decomposition threshold for cliques equals its fractional relaxation.
Corollary 1.2. For all r ≥ 3, δKr = δ∗
1.2. Explicit bounds. Theorem 1.1 involves several ‘auxiliary thresholds’ and parameters
that play a role in the construction of an F -decomposition. Bounds on these of course lead
to better ‘explicit’ bounds on δF which we now discuss.

Kr = δ0+
Kr

.

The central conjecture in the area is due to Nash-Williams [17] (for the triangle case) and

Gustavsson [9] (for the general case).

Conjecture 1.3 (Gustavsson [9], Nash-Williams [17]). For every r ≥ 3, there exists an n0 =
n0(r) such that every Kr-divisible graph G on n ≥ n0 vertices with δ(G) ≥ (1 − 1/(r + 1))n
has a Kr-decomposition.

3

For general F , the following conjecture provides a natural upper bound for δF which
It is not clear to us what a formula for

would be best possible for the case of cliques.
general F might look like.
Conjecture 1.4. For all graphs F , δF ≤ 1 − 1/(χ(F ) + 1).

Note that by Theorem 1.1 in order to prove Conjecture 1.4 it suﬃces to show δ0+

F ≤
1 − 1/(χ(F ) + 1). This in turn implies that Conjecture 1.4 is actually a special case of
Conjecture 1.3.
Indeed, it follows from a result of Yuster [23] that for every graph F ,
F ≤ δ0+
δ0+
F ≤ δ∗
In view of this, bounds on δ∗
best bound for general r (see [1]) and triangles (see [6]).

Kχ(F ) ≤ δKχ(F ).
Kr are of considerable interest. The following result gives the

, and thus δ0+

Kχ(F )

Theorem 1.5 ([1], [6]).

(i) For every r ≥ 3, we have δ∗
(ii) δ∗

K3 ≤ 9/10.

Kr ≤ 1 − 10−4r−3/2.

This improved earlier bounds by Yuster [22] and Dukes [7]. Together with the results in [2],
part (ii) implies δK3 ≤ 9/10. More generally, combining Theorem 1.5 and Theorem 1.1(i)
F ≤ δ0+
with the fact that δ0+
, one obtains the following explicit upper bound on
the decomposition threshold.

Kχ(F ) ≤ δ∗

Kχ(F )

Corollary 1.6.

(i) For every graph F , δF ≤ 1 − 10−4χ(F )−3/2.
(ii) If χ(F ) = 3, then δF ≤ 9/10.
Here, (i) improves a bound of 1 − 1/ max{104χ(F )3/2, 6e(F )} obtained by combining
the results of [1] and [2] (see [1]). It also improves earlier bounds by Gustavsson [9] and
Yuster [22, 24]. A bound of 1 − ε also follows from the results of Keevash [12].
In the r-partite setting an analogue of Corollary 1.2 was proved in [3], an analogue of
Theorem 1.5(i) (with weaker bounds) in [16] and an analogue of Theorem 1.5(ii) (again with
weaker bounds) in [8]. These bounds can be combined to give results on the completion of
(mutually orthogonal) partially ﬁlled in Latin squares. Moreover, it turns out that if δF > δ∗
F
(in the non-partite setting), then there exist extremal graphs that are extremely close to
large complete partite graphs, which adds further relevance to results on the r-partite setting
(see Section 15).

1.3. Decompositions into bipartite graphs. Let F be a bipartite graph. Yuster [21]
showed that δF = 1/2 if F is connected and contains a vertex of degree one. Moreover,
Barber, K¨uhn, Lo and Osthus [2] showed that δC4 = 2/3 and δCℓ = 1/2 for all even ℓ ≥ 6
(which improved a bound of δC4 ≤ 31/32 by Bryant and Cavenagh [4]). Here we generalise
these results to arbitrary bipartite graphs.
F = 0, as one can trivially obtain
an approximate decomposition via repeated applications of the Erd˝os-Stone theorem. This
allows us to determine δF for any bipartite graph F . To state the result, we need the
following deﬁnitions. A set X ⊆ V (F ) is called C4-supporting in F if there exist distinct
a, b ∈ X and c, d ∈ V (F ) \ X such that ac, bd, cd ∈ E(F ). We deﬁne

Note that if F is bipartite, it is easy to see that δ0+

τ (F ) := gcd{e(F [X]) : X ⊆ V (F ) is not C4-supporting in F},
˜τ (F ) := gcd{e(C) : C is a component of F}.

So for example τ (F ) = 1 if there exists an edge in F that is not contained in any cycle
of length 4, and ˜τ (F ) > 1 if F is connected (and e(F ) ≥ 2). The deﬁnition of τ can

4

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

be motivated by considering the following graph G: Let A, B, C be sets of size n/3 with
G[A], G[C] complete, B independent and G[A, B] and G[B, C] complete bipartite. Note that
δ(G) ∼ 2n/3. It turns out that the extremal examples which we construct showing δF ≥
2/3 for certain bipartite graphs F are all similar to G (see Proposition 13.11). Moreover,
τ (F ) = 1 if for any large c there is a set of copies of F in G whose number of edges in G[A]
add up to c.

We note that τ (F ) | gcd(F ) and gcd(F ) | ˜τ (F ) (see Fact 13.2). The following theorem

determines δF for every bipartite graph F .

Theorem 1.7. Let F be a bipartite graph. Then

2/3
0
1/2

if τ (F ) > 1;
if ˜τ (F ) = 1 and F has a bridge;
otherwise.

δF =


We will prove Theorem 1.7 in Section 13. The next corollary translates Theorem 1.7 into

explicit results for important classes of bipartite graphs.

Corollary 1.8. The following hold.

otherwise.

(i) Let s, t ∈ N with s + t > 2. Then δKs,t = 1/2 if s and t are coprime and δKs,t = 2/3
(ii) If gcd(F ) = 1 and F is connected, then δF = 1/2.
(iii) If F is connected and has an edge that is not contained in any cycle of length 4, then

δF = 1/2.

(For (ii) and (iii) recall that we always assume e(F ) ≥ 2.) Note that τ (Ks,t) = gcd(s, t).

Then (i)–(iii) follow from the deﬁnitions of τ and ˜τ .

1.4. Near-optimal decompositions. Along the way to proving Theorem 1.1 we obtain
the following bound guaranteeing a ‘near-optimal’ decomposition. For this, let δvx
F be the
smallest δ ≥ 0 such that for all µ > 0 there exists an n0 ∈ N such that whenever G is a graph
on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n, and x is a vertex of G with gcd(F ) | dG(x), then
G contains a collection F of edge-disjoint copies of F such that {xy : y ∈ NG(x)} ⊆ SF.
Loosely speaking, δvx
F is the threshold that allows us to cover all edges at one vertex. For
example, if F is a triangle, then δvx
F is essentially the threshold that NG(x) contains a perfect
matching whenever dG(x) is even. Note that δvx

The following theorem roughly says that if we do not require to cover all edges of G
with edge-disjoint copies of F , but accept a bounded number of uncovered edges, then the
minimum degree required can be less than if we need to cover all edges.

F ≥ δe
F .

Theorem 1.9. For any graph F and µ > 0 there exists a constant C = C(F, µ) such that
whenever G is an F -degree-divisible graph on n vertices satisfying

δ(G) ≥ (max{δ0+

F , δvx

F } + µ)n

Here, δvx

then G contains a collection of edge-disjoint copies of F covering all but at most C edges.
F ≤ 1− 1/χ(F ) (see Corollary 14.13). For many bipartite graphs F , e.g. trees and
F } < δF . It seems
F } <
F do not suﬃce to verify this. The proof of The-

complete balanced bipartite graphs, our results imply that max{δ0+
plausible to believe that there also exist graphs F with χ(F ) ≥ 3 such that max{δ0+
δF . However, the current bounds on δ0+
orem 1.9 can be found in Section 5.

F , δvx

F , δvx

2. Overview of the proofs and organisation of the paper

One key ingredient in the proofs of Theorems 1.1, 1.7 and 1.9 is an iterative absorption
method. Very roughly, this means that we build our decomposition of a given graph G in

5

many iterations, where in each iteration we add copies of F to our current partial decom-
position. In the current proof, we can carry out this iteration until we have a ‘near-optimal
decomposition’ which covers all but a bounded number of edges of G. Let H be the graph
consisting of the leftover (i.e. uncovered) edges. This leftover graph H can then be absorbed
into a graph A which we set aside at the beginning (i.e. H ∪ A has an F -decomposition).
Altogether this yields an F -decomposition of the original graph G.
More precisely, to obtain the near-optimal decomposition we proceed as follows. At the
beginning of the proof we will ﬁx a suitable nested sequence of vertex sets V (G) = U0 ⊇
U1 ⊇ ··· ⊇ Uℓ, which will be called a vortex in G. After the ith iteration we can ensure that
the uncovered edges all lie in Ui, which is much smaller than Ui−1. We can also preserve the
relative density of the leftover graph Gi after the ith iteration, i.e. δ(Gi[Ui])/|Ui| ∼ δ, where
δ := δ(G)/|G|. We will show that this can be achieved provided that δ ≥ δ0+
F and δ ≥ δvx
F .
These iterative steps are carried out in Section 5. In particular, we obtain Theorem 1.9 as
a byproduct of this iterative absorption argument.

We now turn to the absorption step itself. The ﬁnal set Uℓ in the iteration will have
bounded size. This immediately implies that the ﬁnal leftover graph H ⊆ G[Uℓ] will also
have a bounded number of edges. In particular, there are only a bounded number H1, . . . , Hs
of possibilities for H. The graph A will be constructed as the edge-disjoint union of absorbers
A1, . . . , As, where each Ai is tailored towards Hi. More precisely, the crucial property is
that both Ai and Ai ∪ Hi have an F -decomposition for each i ∈ [s]. With this property, it
is clear that A has the required absorbing property, i.e. A ∪ Hi has an F -decomposition for
any of the permissible leftovers Hi.
The absorbers will be constructed in several steps: rather than constructing Ai directly,
we will obtain it as the ‘concatenation’ (equivalent to the edge-disjoint union) of several
‘transformers’ T . The role of T is to transform Hi into a suitable diﬀerent graph H ′
i (more
precisely, both H ′
i∪T and T∪Hi have an F -decomposition). We can then concatenate several
such transformers to transform Hi into a disjoint union of copies of F , which trivially has
an F -decomposition.

This reduces the absorption problem to that of constructing transformers. Surprisingly,
the main hurdle for the latter is the ability to construct a transformer T which simply moves
Hi to a diﬀerent position, i.e. transforms Hi into an isomorphic copy H ′
i of Hi in G, with
a diﬀerent vertex set. Once this is achieved, we can obtain more general transformers by
simple modiﬁcations.

Yet again, we do not construct these transformers directly, but construct them from
building blocks called ‘switchers’. These switchers are transformers with more limited
capabilities. The most important switchers are C6-switchers and K2,r-switchers. A C6-
switcher S transforms the perfect matching E+ := {u1u2, u3u4, u5u6} into its ‘complement’
E− := {u2u3, u4u5, u6u1} along a 6-cycle. (The formal requirement is that both S ∪ E+ and
S ∪ E− have an F -decomposition.) A K2,r-switcher transforms a star with r leaves centred
at x into a star with the same leaves centred at x′. Surprisingly, it turns out that these
building blocks suﬃce to build the desired transformers (see Lemma 9.1).

Occasionally, we build the above switchers from even more ‘basic’ ones. For example, in
Section 10 we will build a C6-switcher by combining C4-switchers in a suitable way. Apart
from proving the existence of switchers, we also need to be able to ﬁnd them in G. This is
where we may need the condition that δ(G) ≥ (1− 1/(χ + 1) + o(1))|G|. To achieve this, we
will apply Szemer´edi’s regularity lemma to G to obtain its reduced graph R. We will then
ﬁnd a ‘compressed’ version (i.e. a suitable homomorphism) of the switcher in R. This then
translates to the existence of the desired switcher in G via standard regularity techniques.
The switchers are also key to our discretisation results in Theorem 1.1(ii) and (iii). We
show that if δF < 1− 1/(χ + 1), then to ﬁnd the relevant switchers (and hence, as described
above, the relevant absorbers) we need the graph G only to have minimum degree (1 −
1/χ + o(1))|G|. Similarly, if δF < 1 − 1/χ, the minimum degree we require is only (1 −

6

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

F , δvx

1/(χ − 1) + o(1))|G|. As discussed earlier we require the minimum degree to be at least
(max{δ0+
F } + o(1))|G| in order to iteratively cover all but a constant number of edges
in G (see Theorem 1.9). This may not be suﬃciently high to construct our absorbers, but
this discretisation argument will allow us to conclude that if δF exceeds max{δ0+
F , δvx
F } then
it can take at most two other values, 1 − 1/(χ + 1) or 1 − 1/χ (see Theorem 12.4).
Most of the above steps are common to the proof of Theorems 1.1 and 1.7, i.e. we can
prove them in a uniﬁed way. The key additional diﬃculty in the bipartite case is proving
the existence of a C6-switcher for those F with δF = 1/2.

The iterative absorption approach was initially introduced in [14] and was further de-
veloped in the present context of F -decompositions in [2]. The present iteration procedure
is much simpler than the one in [2]. The concept of transformers also originates in [2], but
the approach via switchers is a new feature which allows us to go signiﬁcantly beyond the
results in [2].

This paper is organised as follows. The following section contains the basic notation
that we use. Sections 4 and 5 deal with the ‘near-optimal decomposition’. More precisely,
Section 4 introduces the concept of vortices, and in Section 5 we perform the iteration based
on these vortices, leading to the proof of Theorem 1.9.

Sections 6–10 and 12 are devoted to absorbers, which are constructed in several steps
as described above. Section 6 recalls well-known results on ε-regularity and introduces the
setting of an (α, ε, k)-partition in which we intend to ﬁnd absorbers. In Section 7, we combine
the ‘near-optimal decomposition’ with the concept of absorbing in order to prove a general
decomposition theorem. In order to apply this theorem, we need to be able to ﬁnd absorbers
in a graph with an (α, ε, k)-partition. In Section 8, we introduce the concepts that allow
us to achieve this. In Section 9 we will construct transformers out of switchers. Section 10
deals with the construction of switchers. Finally, in Section 12 we use transformers to
build absorbers, which we can then use to obtain upper bounds on δF using the general
decomposition theorem. In addition, in Section 11, we prove some relations between the
auxiliary thresholds which we need for our discretisation result.

In Section 13, we determine δF for all bipartite graphs F . Finally, in Section 14 we will

investigate δvx

F and then combine all our results to prove Theorem 1.1.

3. Notation and tools

For a graph G, we let |G| denote the number of vertices of G, e(G) the number of
edges of G, and G the complement of G. For a vertex v ∈ V (G), we write NG(v) for the
neighbourhood of v and dG(v) for its degree. More generally, for vertex subsets S, V ⊆ V (G),
we let NG(S, V ) := V ∩Tv∈S NG(v) denote the set of vertices in V that are adjacent to
all vertices in S, where NG(∅, V ) := V . We then deﬁne dG(S, V ) := |NG(S, V )| and write
dG(x, V ) if S = {x}.
A set of edge-disjoint copies of F in a graph G is called an F -collection. Thus an F -
decomposition of G is an F -collection that covers every edge of G.
If G and H are two
edge-disjoint graphs, we write G ·∪ H for the union of G and H.
Let G be a graph and let V1, . . . , Vk be disjoint subsets of V (G). We write G[V1] for the
subgraph of G induced by V1. Moreover, if k ≥ 2, then G[V1, . . . , Vk] denotes the k-partite
subgraph of G induced by V1, . . . , Vk. If V1, . . . , Vk form a partition P of V (G), we write
G[P] instead of G[V1, . . . , Vk].
If G is a graph and H is a subgraph of G, then G − H denotes the graph with vertex set
V (G) and edge set E(G) \ E(H). Moreover, if X ⊆ V (G), then G − X := G[V (G) \ X].
For a graph K and t ∈ N, we let K(t) denote the graph obtained by replacing each vertex
of K with t vertices and each edge of K with a copy of Kt,t. A homomorphism φ : H → G
from a graph H to a graph G is a map φ : V (H) → V (G) such that φ(x)φ(y) ∈ E(G)
whenever xy ∈ E(H). We let φ(H) denote the subgraph of G with vertex set φ(V (H)) and
edge set {φ(x)φ(y) : xy ∈ E(H)}. We say that φ is edge-bijective if e(G) = e(φ(H)) = e(H).

7

We will sometimes identify a graph with its edge set if this enhances readability and does
not aﬀect the argument.

For n ∈ N and distinct i1, . . . , ik ∈ [n], we let (i1, . . . , ik) denote the permutation π : [n] →
[n] deﬁned as π(ij) := ij+1 for all j ∈ [k − 1], π(ik) := i1 and π(i) := i for all i ∈
[n] \ {i1, . . . , ik}. We write 2U for the power set of U .
We write x ≪ y to mean that for any y ∈ (0, 1] there exists an x0 ∈ (0, 1) such that for
all x ≤ x0 the subsequent statement holds. Hierarchies with more constants are deﬁned in
a similar way and are to be read from the right to the left. The expression a = b ± c means
that a ∈ [b − c, b + c].
Let m, n, N ∈ N with max{m, n} < N . Recall that a random variable X has hypergeo-
metric distribution with parameters N, n, m if X := |S ∩ [m]|, where S is a random subset
of [N ] of size n. We write X ∼ B(n, p) if X has binomial distribution with parameters n, p.
We will often use the following Chernoﬀ-type bound.
Lemma 3.1 (see [11, Remark 2.5 and Theorem 2.10]). Let X ∼ B(n, p) or let X have a
hypergeometric distribution with parameters N, n, m. Then

P(|X − E(X)| ≥ t) ≤ 2e−2t2/n.

4. Vortices

As explained earlier, our proof method involves an ‘iterative’ absorption process, where in
each iteration, we ensure that the leftover edges are all contained in some set Ui where Ui is
much smaller than Ui−1. The underlying structure is that of a ‘vortex’ which we introduce
now.
Deﬁnition 4.1. Let G be a graph on n vertices and W ⊆ V (G). A (δ, µ, m)-vortex in G
surrounding W is a sequence U0 ⊇ U1 ⊇ ··· ⊇ Uℓ such that
(V1) U0 = V (G);
(V2) |Ui| = ⌊µ|Ui−1|⌋ for all i ∈ [ℓ];
(V3) |Uℓ| = m and W ⊆ Uℓ;
(V4) dG(x, Ui) ≥ δ|Ui| for all i ∈ [ℓ], x ∈ Ui−1.
Often W plays no role and we just refer to a (δ, µ, m)-vortex in G in this case.
Our aim is to show that every large graph of high minimum degree contains a vortex
such that the ﬁnal set Uℓ has constant size. We can also guarantee that a small given set
W is contained in this ﬁnal set (i.e. the vortex surrounds W ). This will only be relevant
In the main application, we will have W = ∅. The next
in Section 14 (with |W| = 1).
proposition follows easily from Lemma 3.1.
Proposition 4.2. Let δ ∈ [0, 1] and 1/n ≪ µ. Suppose that G is a graph on n vertices with
δ(G) ≥ δn and W ⊆ V (G) with |W| ≤ 1/µ. Then V (G) contains a subset U of size ⌊µn⌋
such that dG(x, U ) ≥ (δ − 2n−1/3)|U| for every x ∈ V (G) and W ⊆ U .

We now iterate the above proposition in order to obtain a vortex for a given graph G

such that the ﬁnal set has constant size.
Lemma 4.3. Let δ ∈ [0, 1] and 1/m′ ≪ µ < 1. Suppose that G is a graph on n ≥ m′
vertices with δ(G) ≥ δn and W ⊆ V (G) with |W| ≤ 1/µ. Then G has a (δ − µ, µ, m)-vortex
surrounding W for some ⌊µm′⌋ ≤ m ≤ m′.
Proof. Recursively deﬁne n0 := n and ni := ⌊µni−1⌋. Observe that µin ≥ ni ≥ µin−1/(1−
µ). Further, for i ∈ N, let ai := n−1/3Pj∈[i] µ−(j−1)/3, with a0 := 0. Let ℓ := 1 + max{i ≥
0 : ni ≥ m′} and let m := nℓ. Note that ⌊µm′⌋ ≤ m ≤ m′. Now, suppose that for some
i ∈ [ℓ], we have already found a (δ − 3ai−1, µ, ni−1)-vortex U0, . . . , Ui−1 in G surrounding
W . In particular, δ(G[Ui−1]) ≥ (δ− 3ai−1)ni−1. By Proposition 4.2, there exists a subset Ui
of Ui−1 of size ni such that dG(x, Ui) ≥ (δ − 3ai−1 − 2n−1/3
i−1 )ni for all x ∈ Ui−1 and W ⊆ Ui.

8

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Thus, U0, . . . , Ui is a (δ − 3ai, µ, ni)-vortex in G surrounding W . Finally, U0, . . . , Uℓ is a
(δ − 3aℓ, µ, m)-vortex in G surrounding W . Observe that
1 − µ1/3 ≤

aℓ = n−1/3 µ−ℓ/3 − 1
µ−1/3 − 1 ≤

1 − µ1/3 ≤ µ/3

(µℓ−1n)−1/3

m′−1/3

since µℓ−1n ≥ nℓ−1 ≥ m′, and so the lemma follows.

(cid:3)

5. Near-optimal decomposition

The goal of this section is to prove the following lemma. Given a vortex, it ﬁnds a ‘near-
optimal’ decomposition in a graph of suﬃciently large minimum degree. The proof proceeds
using an ‘iterative’ absorption approach.
Lemma 5.1. Let δ := max{δ0+
F }. Assume that 1/m ≪ µ, 1/|F|. Let G be an F -degree-
divisible graph with δ(G) ≥ (δ + 3µ)|G| and let U0 ⊇ U1 ⊇ ··· ⊇ Uℓ be a (δ + 4µ, µ, m)-vortex
in G. Then there exists a subgraph Hℓ of G[Uℓ] such that G − Hℓ is F -decomposable.

F , δvx

The proof of Lemma 5.1 relies on a number of further tools. Before we start proving

Lemma 5.1, we show how it implies Theorem 1.9.

F , δvx

Proof of Theorem 1.9.

Let F and µ be given and choose m′ suﬃciently large. Let
δ := max{δ0+
F }. Now, let G be any F -degree-divisible graph with δ(G) ≥ (δ + 5µ)n. If
n ≤ m′, then e(G) ≤ m′2. If n ≥ m′, then by Lemma 4.3, G contains a (δ + 4µ, µ, m)-vortex
U0 ⊇ U1 ⊇ ··· ⊇ Uℓ for some ⌊µm′⌋ ≤ m ≤ m′. Then, by Lemma 5.1, there exists an F -
collection that covers all edges of G except some edges of G[Uℓ], that is, at most m2 ≤ m′2
edges.

(cid:3)

5.1. Bounded covering of edges around a vertex. Many times in the proof of Lemma 5.1,
we will wish to ﬁnd copies of F which cover all the edges around some vertex, x say. To
do so, we will use the deﬁnition of δvx
F , but we will often further wish to ensure that no
vertex lies in many of these copies of F (except, of course, x). This motivates the following
deﬁnition and lemma.

Let δvx,bd

F

be the smallest δ ≥ 0 such that for all µ > 0 there exists an n0 ∈ N such that
whenever G is a graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n, and x is a vertex of G
with gcd(F ) | dG(x), then G contains a collection F of edge-disjoint copies of F such that
{xy : y ∈ NG(x)} ⊆ E(F) and ∆(SF − x) ≤ n0.

F . Maybe surprisingly, the following is true.

Clearly, δvx,bd

≥ δvx

F

Lemma 5.2. For all graphs F , we have δvx,bd

F

= δvx
F .

To prove Lemma 5.2, we need the following deﬁnition. Given a graph G and a vertex
x ∈ V (G) with r | dG(x), we call a partition V1, . . . , Vk of V (G) \ {x} a (δ, m, r)-splitting
with respect to x, if for all i ∈ [k]:

• r | dG(x, Vi);
• δ(G[Vi ∪ {x}]) ≥ δ|Vi|;
• m/3 ≤ |Vi| ≤ 2m.

We shall consider (δ, m, r)-splittings where m is bounded and k is comparatively large.
Their existence will follow from the next proposition and the subsequent lemma, which are
similar to Proposition 4.2 and Lemma 4.3 in their interplay.
Proposition 5.3. Let δ ∈ [0, 1] and 1/n ≪ 1/r. Suppose that G is a graph on n + 1 vertices
with δ(G) ≥ δn and x is a vertex of V (G) such that r | dG(x). Then V (G) \ {x} can be
partitioned into two sets V1, V2 such that r | dG(x, Vi) and dG(v, Vi) ≥ (δ − 2n−1/3)|Vi| for
every v ∈ V (G) and i ∈ {1, 2}, and |V1| ≤ |V2| ≤ |V1| + 2r.
Proof. Let V ′
2 be a partition of V (G) \ {x} such that

1, V ′

9

(1) |V ′
1| ≤ |V ′
(2) dG(v, V ′

2| ≤ |V ′
i ) ≥ (δ − n−1/3)|V ′

1| + 1;

i | for all v ∈ V (G) and i ∈ [2].

That such a partition exists can be seen by choosing V ′
of size ⌊n/2⌋. Applying Lemma 3.1 shows that with probability at least 3/4, V ′
V (G) \ ({x} ∪ V ′
of x from V ′
2, we can obtain the desired partition V1, V2.

1 as a random subset of V (G) \ {x}
2 :=
1) have the desired properties. Then by removing at most r − 1 neighbours
(cid:3)

1 and adding them to V ′

1 and V ′

j

:= n2−j + 4r(1 − 2−j) and n−

Lemma 5.4. Let δ ∈ [0, 1] and 1/m ≪ µ, 1/r. Suppose that G is a graph on n + 1 ≥ m + 4r
vertices with δ(G) ≥ δn and x is a vertex of G with r | dG(x). Then G has a (δ − µ, m, r)-
splitting with respect to x.
Proof. Deﬁne n+
j

:= n2−j − 4r(1 − 2−j), which need
not be integers. Further, for j ∈ N, let aj := n−1/3Pj′∈[j] 2(j′−1)/3, with a0 := 0. Let
ℓ := 1 + max{j ≥ 0 : n+
Now, suppose that for some j ∈ [ℓ], we have already found a partition Pj−1 of V (G)\{x}
such that for all V ∈ Pj−1
(i)j−1 n−
j−1 ≤ |V | ≤ n+
j−1;
(ii)j−1 r | dG(x, V );
(iii)j−1 δ(G[V ∪ {x}]) ≥ (δ − 3aj−1)|V |.

j ≥ m + 4r}.

that (i)j –(iii)j hold.

(Note that we can take P0 := {V (G) \ {x}}.) We now ﬁnd a reﬁnement Pj of Pj−1 such
Consider V ∈ P and let G′ := G[V ∪ {x}]. Since |V | ≥ n−
ℓ−1 − 8r ≥ m − 4r,
we can apply Proposition 5.3 to obtain a partition of V into V1, V2 such that r | dG′(x, Vi)
and dG′(v, Vi) ≥ (δ − 3aj−1 − 2|V |−1/3)|Vi| for every v ∈ V ∪ {x} and i ∈ {1, 2}, and
|V1| ≤ |V2| ≤ |V1| + 2r. It is easy to check that (i)j –(iii)j hold for V1 and V2. Hence, reﬁning
every V ∈ Pj−1 in this way yields a partition Pj such that (i)j –(iii)j hold.

ℓ−1 ≥ n+

Observe that

aℓ = n−1/3 2ℓ/3 − 1
21/3 − 1 ≤

(n2−(ℓ−1))−1/3

m−1/3

1 − 2−1/3

≤

1 − 2−1/3 ≤ µ/3

since n2−(ℓ−1) ≥ n+

ℓ−1 − 4r ≥ m. Thus Pℓ is the desired splitting as m/3 ≤ n−

ℓ ≤ n+

ℓ ≤ 2m.
(cid:3)

F

≤ δvx

It is suﬃcient to show δvx,bd

Let r := gcd(F ).

F . Let
Proof of Lemma 5.2.
µ > 0. Let n′ = n′(µ/4, F ) be such that whenever G′ is a graph on at least n′ vertices with
F + µ/4)|G′| and x′ is a vertex of G′ with gcd(F ) | dG′(x′), then G′ contains an
δ(G′) ≥ (δvx
F -collection such that every edge at x′ is covered. Let 1/n0 ≪ 1/n′, 1/r, µ. Let G be any
graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n and let x ∈ V (G) with r | dG(x). We have
to ﬁnd an F -collection F such that F covers all edges at x and ∆(SF − x) ≤ n0.
By Lemma 5.4, there exists a (δ + µ/2, n0/2, r)-splitting V1, . . . , Vk with respect to x. For
each i ∈ [k], let Gi := G[Vi ∪ {x}]. Thus, |Gi| ≥ |Vi| ≥ n0/6 ≥ n′, δ(Gi) ≥ (δ + µ/2)|Vi| ≥
(δ + µ/4)|Gi| and r | dGi(x). Hence, by our choice of n′, Gi contains an F -collection Fi
such that every edge at x is covered. Let F := F1 ∪ ··· ∪ Fk. Then, ∆(SF − x) ≤
max{|V1|, . . . ,|Vk|} ≤ n0.
5.2. Bounded approximate decompositions. For γ ≥ 0, a γ-bounded approximate F -
decomposition of an n-vertex graph G is a collection F of edge-disjoint copies of F contained
in G such that ∆(G−S F) ≤ γn. Let δγ,bd
be the smallest δ ≥ 0 such that for all µ > 0 there
exists an n0 ∈ N such that whenever G is a graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n,
then G has a γ-bounded approximate F -decomposition.

(cid:3)

F

10

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

F

F ≥ δγ/2

Trivially, for all γ > 0 we have δγ,bd

F , the threshold for a γ-approximate decom-
position. Here, we will build to giving an upper bound for δγ,bd
in Lemma 5.7. To ﬁnd a
bounded γ-approximate F -decomposition of a graph G with large minimum degree, we will
start by breaking G into a large (but constant) number of edge-disjoint subgraphs which
each have a high minimum degree but much fewer vertices than G. We then iteratively ﬁnd
approximate decompositions of these subgraphs. In doing so, we track vertices which have
high minimum degree in the remainder of some previous approximate decomposition, and
ensure these vertices always have small degree in the remainder of the later approximate
decompositions. We will use the following lemma to ﬁnd approximate decompositions where
vertices in a speciﬁed subset X have low degree in the remainder.
Lemma 5.5. Let 1/n ≪ η ≪ µ, 1/|F|. Let δ := max{δη
F }. Suppose that G is a graph
on n vertices with δ(G) ≥ (δ + µ)n and that X is a subset of V (G) of size at most η1/3n.
Then there exists a subgraph H of G such that G − H is F -decomposable and Y := {x ∈
V (G) : dH(x) > √ηn} has size at most 4√ηn and does not contain any vertex from X.

F , δvx

Proof. By Lemma 5.2, we may assume that the following holds:

(∗) Whenever G′ is a graph on at least n/2 vertices with δ(G′) ≥ (δ + µ/2)|G′| and
x ∈ V (G′) with gcd(F ) | dG′(x), then G′ contains a collection F of edge-disjoint
copies of F such that all edges at x are covered and ∆(SF − x) ≤ η−1/4.

Let x1, . . . , xℓ be an enumeration of X. For i ∈ [ℓ], let 0 ≤ ri < gcd(F ) be such that
dG(xi) ≡ ri mod gcd(F ). Let Ai be a set of ri vertices in NG(xi) \ X. Let G0 be the
graph obtained from G by deleting all edges from xi to Ai, so gcd(F ) | dG0(xi) for all i ∈ [ℓ]
and δ(G0) ≥ (δ + 3µ/4)n. We will now successively ﬁnd F -collections Fi such that Fi is a
collection of edge-disjoint copies of F in Gi covering all edges at xi and ∆(SFi−xi) ≤ η−1/4,
where Gi := (G0 −Sj∈[i−1]SFj) \ {x1, . . . , xi−1}. Suppose that for some i ∈ [ℓ], we have
already found F1, . . . ,Fi−1. Note that gcd(F ) | dGi(xi). Moreover, δ(Gi) ≥ (δ + 3µ/4)n −
η−1/4(i − 1) ≥ (δ + µ/2)n. Therefore, by (∗), there exists a collection Fi of edge-disjoint
copies of F in Gi such that all edges at xi are covered and ∆(SFi − xi) ≤ η−1/4.
Let F ′ := Si∈[ℓ] Fi and Gℓ+1 := (G −SF ′) \ {x1, . . . , xℓ}. So δ(Gℓ+1) ≥ (δ + µ/2)n.
Let F ′′ be an η-approximate F -decomposition of Gℓ+1. Let H := G −SF ′ −SF ′′ and
Y := {x ∈ V (G) : dH(x) > √ηn}. Since dH (x) < gcd(F ) for all x ∈ X, we have Y ∩ X = ∅.
Finally, e(H) ≤ ηn2 + |X|gcd(F ) ≤ 2ηn2 and 2e(H) ≥ |Y |√ηn. Hence, |Y | ≤ 4√ηn.
In order to obtain an upper bound for δγ,bd

, we need a Kt-decomposition of Ks for some
large t and some even larger s. We could apply Wilson’s theorem, but we don’t need
such heavy machinery here, only the following simple proposition. We include a proof for
completeness.

(cid:3)

F

Proposition 5.6. Let p be a prime. Then for every k ∈ N, Kpk has a Kp-decomposition.
Proof. First, we prove that Kp(p) is Kp-decomposable. Let V1, . . . , Vp be the partition of
the vertex set into independent sets of size p and let vi1, . . . , vip be an enumeration of Vi.
We deﬁne a set F of Kp’s as follows. The p-tuple (v1i1 , . . . , vpip) is the vertex set of a copy
of Kp in F if and only if there exists an r ∈ {0, 1, . . . , p − 1} such that ij+1 − ij ≡ r mod p
for all j ∈ [p], where ip+1 := i1. It is easy to see that F is a Kp-decomposition, as p is prime.
We now prove the statement by induction on k. For k = 1, there is nothing to show.
For k > 1, do the following. Partition the vertices of Kpk into pk−1 clusters of size p. The
edges inside each cluster form a copy of Kp, so we can remove them. Consider the complete
reduced graph where the clusters are vertices. By induction, this reduced graph has a Kp-
decomposition. Every copy of Kp in this decomposition corresponds to a copy of Kp(p) in
the original graph, which is Kp-decomposable by the above.
(cid:3)

11

Lemma 5.7. For every γ > 0, δγ,bd
Proof. Let 1/n ≪ η ≪ 1/s ≪ 1/t ≪ µ, γ, 1/|F| and assume that t is prime and s is a
power of t. Thus, by Proposition 5.6, Ks has a Kt-decomposition. Let δ := max{δη
F , δvx
F }
and suppose that G is a graph on n vertices with δ(G) ≥ (δ + µ)n. We have to show that
G has a γ-bounded-approximate F -decomposition.

F ≤ max{δ0+

F , δvx

F }.

Let P = {V1, . . . , Vs} be a partition of V (G) with the following properties:
(i) |Vi| = (1 ± η)n/s;
(ii) dG(x, Vi) ≥ (δ + 2µ/3)|Vi| for all x ∈ V (G), i ∈ [s].

To see that such a partition exists, independently for every vertex x ∈ V (G), choose an
index i ∈ [s] uniformly at random and put x into Vi. Apply Lemma 3.1 to see that such a
random partition satisﬁes (i) and (ii) with probability at least 3/4.
Note that ∆(G − G[P]) ≤ (1 + η)n/s ≤ γn/2. Thus it is enough to show that G[P] has
Let {T1, . . . , Tℓ} be a Kt-decomposition of Ks (where we assume that V (Ks) = [s]).
Clearly, ℓ ≤ s2. For i ∈ [ℓ], deﬁne Gi :=Sjk∈E(Ti) G[Vj, Vk]. So the Gi form a decomposition
of G[P]. Moreover, using (i) and (ii), we deduce

a γ/2-bounded-approximate F -decomposition.

δ(Gi) ≥ (δ + 2µ/3)(1 − η)(t − 1)n/s ≥ (δ + µ/2)(1 + η)tn/s ≥ (δ + µ/2)|Gi|.

Start with BAD := ∅. For i = 1, . . . , ℓ, do the following: Apply Lemma 5.5 with Gi,
µ/2 and BAD ∩ V (Gi) playing the roles of G, µ and X to obtain a subgraph Hi of Gi such
that Gi − Hi is F -decomposable, dHi(x) ≤ √η|Gi| for all x ∈ BAD and dHi(x) > √η|Gi|
for at most 4√η|Gi| vertices x ∈ V (Gi). Add all the vertices x with dHi(x) > √η|Gi| to
BAD. Since |BAD| ≤ s24√η(1 + η)tn/s ≤ η1/3(1 − η)tn/s at any time, the conditions
of Lemma 5.5 are satisﬁed each time. Let H := Si∈[ℓ] Hi and let x be any vertex of G.
Crucially, dHi(x) > √η(1 + η)tn/s for at most one i ∈ [ℓ]. Therefore,

dH(x) ≤ ℓ√η(1 + η)tn/s + (1 + η)tn/s ≤ 2s√ηtn + 2tn/s ≤ γn/2,

as required.

(cid:3)

5.3. Covering a pseudorandom remainder. In proving the main lemma in this section,
we will have the following situation. Given a small set U in our graph G, we will have found
copies of F which cover all the edges in G − U and most of the edges between V (G) \ U
and U . We will wish to ﬁnd copies of F which cover the remaining edges between V (G)\ U
and U (while necessarily using some edges in G[U ]). The following lemma tells us this is
possible if our remaining edges satisfy certain pseudorandom conditions.

Lemma 5.8. Let 1/n ≪ ρ ≪ µ, 1/|F|. Let G be a graph on n vertices and let U be a subset
of V (G) of size at least µn. Let W := V (G) \ U and let w1, . . . , wp be an enumeration of
W . Suppose there are sets U1, . . . , Up ⊆ U with the following properties:

(i) gcd(F ) | dG(wi) for all i ∈ [p];
(ii) NG(wi) ⊆ Ui for all i ∈ [p];
(iii) dG(x, Ui) ≥ (δvx
(iv) |Ui| ≥ ρ|U|/2;
(v) |Ui ∩ Uj| ≤ 2ρ2|U| for all 1 ≤ i < j ≤ p;
(vi) every x ∈ U is contained in at most 2ρn Ui’s.

F + µ)|Ui| for all x ∈ Ui ∪ {wi};

Then there exists a subgraph GU of G[U ] such that GU ∪ G[U, W ] is F -decomposable and
∆(GU ) ≤ µ2|U|.

The proof of Lemma 5.8 is quite similar to that of Lemma 10.7 in [2], we include it for

completeness. The proof will make use of the following result.

12

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Proposition 5.9 (Jain, see [18, Lemma 8]). Let X1, . . . , Xn be Bernoulli random variables
such that, for any i ∈ [n] and any x1, . . . , xi−1 ∈ {0, 1},

P(Xi = 1 | X1 = x1, . . . , Xi−1 = xi−1) ≤ p.

Let B ∼ B(n, p) and X := X1 + ··· + Xn. Then P(X ≥ a) ≤ P(B ≥ a) for any a ≥ 0.
Proof of Lemma 5.8. Let ∆ := ρ−1/4. By Lemma 5.2, we may assume that the following
holds.

(∗) Whenever G′ is a graph on at least ρ|U|/2 vertices with δ(G′) ≥ (δvx

F + µ/2)|G′| and
x is a vertex in G′ with gcd(F ) | dG′(x), then G′ contains a collection F of edge-
disjoint copies of F such that all edges at x are covered and ∆(SF − x) ≤ ∆. (In
other words, there is a spanning subgraph A of G′ − x such that A ∪ G′[V (A),{x}]
is F -decomposable and ∆(A) ≤ ∆.)
We want to ﬁnd edge-disjoint subgraphs T1, . . . , Tp in G[U ] such that V (Ti) = Ui, Ti ∪
G[Ui,{wi}] is F -decomposable and ∆(Ti) ≤ ∆. Then, GU := T1 ∪ ··· ∪ Tp is the desired
subgraph, since GU∪G[U, W ] =Si∈[p](Ti∪G[Ui,{wi}]) by (ii) and ∆(GU ) ≤ ∆·2ρn ≤ µ2|U|,
using (vi).
We ﬁnd T1, . . . , Tp in turn using a randomised algorithm. Let t := ⌈8ρ3/2|U|⌉ and deﬁne
Gj := G[Uj] for all j ∈ [p]. Suppose that we have already found T1, . . . , Ts−1 for some
s ∈ [p]. We now deﬁne Ts as follows. Let Hs−1 := Ss−1
s := (G − Hs−1)[Us].
If ∆(Hs−1[Us]) > ∆ρ3/2n, then let A1, . . . , At be empty graphs on Us. If ∆(Hs−1[Us]) ≤
∆ρ3/2n, then
s) ≥ δ(G[Us]) − ∆(Hs−1[Us]) ≥ (δvx
F + µ/2)(|Us| + 1) + (t − 1)∆,

F + µ)|Us| − ∆ρ3/2n

i=1 Ti and let G′

≥ (δvx

δ(G′

by (iii) and (iv). Thus, by (∗), we can ﬁnd t edge-disjoint subgraphs A1, . . . , At of G′
are all suitable candidates for Ti.

s which

In either case, we have found edge-disjoint subgraphs A1, . . . , At of G′

s. Pick i ∈ [t]
uniformly at random and set Ts := Ai. The lemma follows if the following holds with
positive probability:

(5.1)

∆(Hp[Uj]) ≤ ∆ρ3/2n for all j ∈ [p].

s

s=1 Y j,u

To analyse this, for s, j ∈ [p] and u ∈ Uj, let Y j,u
be the indicator function of the event
{dTs (u, Uj) ≥ 1}. Let X j,u := Pp
s ∆, so dHp(u, Uj) ≤
∆X j,u. Therefore to prove (5.1) it suﬃces to show that with positive probability, X j,u ≤
ρ3/2n for all j ∈ [p] and u ∈ Uj.
Fix j ∈ [p] and u ∈ Uj. Let Sj,u be the set of indices s 6= j such that u ∈ Us. By (vi),
|Sj,u| ≤ 2ρn. Note that Y j,u
(5.2)

s = 0 for all s /∈ Sj,u ∪ {j}. So
Y j,u
.
s

. Note that dTs(u, Uj) ≤ Y j,u

s

X j,u ≤ 1 + Xs∈Sj,u

Let s1, . . . , s|Sj,u| be the enumeration of Sj,u such that sb < sb+1 for all b ∈ [|Sj,u| − 1].
(u, Uj) ≤ |Uj ∩ Usb| ≤ 2ρ2|U| by (v). So at most 2ρ2|U| of the subgraphs
Note that dGsb
Ai that we picked in G′
sb contain an edge incident to u in Gj. This implies that for all
y1, . . . , yb−1 ∈ {0, 1} and all b ∈ [|Sj,u|],

P(Y j,u

sb = 1 | Y j,u

s1 = y1, . . . , Y j,u

sb−1 = yb−1) ≤

2ρ2|U|

t

≤

ρ1/2
4

.

Let B ∼ B(|Sj,u|, ρ1/2/4). By (5.2), Proposition 5.9 and the fact that |Sj,u| ≤ 2ρn we have
that

13

P(X j,u > ρ3/2n) ≤ P( Xs∈Sj,u

Y j,u
s > 3ρ3/2n/4) ≤ P(B > 3ρ3/2n/4)

≤ P(|B − E(B)| > ρ3/2n/4) ≤ 2e−ρ2n/16,

where the last inequality holds by Lemma 3.1. Since there are at most n2 pairs (j, u), there
is a choice of T1, . . . , Tp such that X j,u ≤ ρ3/2n for all j ∈ [p] and all u ∈ Uj, proving the
claim.

(cid:3)

5.4. Proof of Lemma 5.1. Before proving the main tool of this section (from which
Lemma 5.1 will follow simply by induction), we need one ﬁnal proposition. Given a subset
R of a graph G with certain properties, and any sparse subgraph H of G − R, it allows
copies of F to be found in G which cover the edges of H without covering any other edges
in G − R.
Proposition 5.10. Let 1/n ≪ γ ≪ µ, 1/|F|. Let G be a graph on n vertices and let
V (G) = L ·∪ R such that |R| ≥ µn and dG(x, R) ≥ (δe
F + µ)|R| for all x ∈ V (G). Let H be
any subgraph of G[L] such that ∆(H) ≤ γn. Then there exists a subgraph A of G such that
A[L] is empty, A ∪ H is F -decomposable and ∆(A) ≤ µ2|R|.
Proof. Let e1, . . . , em be an enumeration of E(H). We will ﬁnd edge-disjoint copies
F1, . . . , Fm in G such that Fi contains ei and V (Fi) ∩ L = V (ei). Suppose we have
already found F1, . . . , Fj−1 for some j ∈ [m]. Let Gj−1 := F1 ∪ ··· ∪ Fj−1 and suppose
that ∆(Gj−1) ≤ √γn + |F|. Let BAD := {x ∈ V (G) : dGj−1(x) > √γn}. Note that for all
x ∈ L, dGj−1(x) ≤ |F|∆(H) ≤ √γn, so BAD ∩ L = ∅. We have

e(Gj−1) ≤ e(F )e(H) ≤ |F|2∆(H)n ≤ |F|2γn2.

On the other hand, 2e(Gj−1) ≥ |BAD|√γn. Thus, |BAD| ≤ 2|F|2√γn ≤ µ|R|/2. Let
G′ := (G − Gj−1)[(R \ BAD)∪ V (ej )]. Observe that δ(G′) ≥ (δe
F + µ/4)|G′|, so there exists
a copy Fj of F in G′ that contains ej. Moreover, since Fj does not contain any vertex of
BAD, we have ensured ∆(Gj) ≤ √γn + |F| for the next step. Finally, A :=Si∈[m](Fi − ei)

is the desired subgraph.

(cid:3)

We are now ready to prove the main tool that will enable us to prove Lemma 5.1 by

F , δvx

induction.
Lemma 5.11. Let δ := max{δ0+
F } and 1/n ≪ µ, 1/|F|. Let G be a graph on n vertices
and U ⊆ V (G) with |U| = ⌊µn⌋. Suppose that δ(G) ≥ (δ + 2µ)n and for all x ∈ V (G),
dG(x, U ) ≥ (δ + µ)|U|. Then, if gcd(F ) | dG(x) for all x ∈ V (G) \ U , there exists an
F -collection F in G such that every edge in G− G[U ] is covered, and ∆(SF[U ]) ≤ µ2|U|/4.
Our strategy is as follows. Since U is relatively small, we know that G − G[U ] still has
high minimum degree. Therefore, we can obtain an approximate decomposition that uses
no edges inside U , but covers almost all edges outside U . Before doing this, we set aside
two sparse subgraphs R′ and R′′ of G[U, V (G) \ U ] with pseudorandom properties. Letting
H be the leftover of the approximate decomposition, we use R′ and some edges of G[U ] to
cover all edges in H[V (G) \ U ] using Proposition 5.10. Finally, we combine H[U, V (G) \ U ]
and the leftover of R′ with R′′. Since R′′ is relatively dense (compared to R′ and H) and
has pseudorandom properties, we can cover all these edges using Lemma 5.8.
Proof of Lemma 5.11. Choose new constants γ, ξ, ρ > 0 such that 1/n ≪ γ ≪ ξ ≪ ρ ≪
µ, 1/|F|. Let W := V (G) \ U . We will ﬁrst choose suitable graphs R′ and R′′ which we will
put aside for later use. Let k := ⌈ξ−1⌉ and K :=(cid:0)k+1
2 (cid:1).

14

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Let V1, . . . , VK be a partition of U with the following properties:

(5.3)

dG(x, Vi) ≥ (δ + µ/2)|Vi|
|U|/2K ≤ |Vi| ≤ 2|U|/K.

for all x ∈ V (G) and i ∈ [K];

W , . . . , GK

Split W arbitrarily into k sets W1, . . . , Wk as evenly as possible and let G1

(5.4)
To see that such a partition exists, independently for every vertex u ∈ U , choose an index
i ∈ [K] uniformly at random and put u into Vi. Apply Lemma 3.1 to see that such a random
partition has the desired properties with probability at least 3/4.
W be
W

an enumeration of the K graphs of the form G[Wi] or G[Wi, Wj]. Thus, G[W ] =Si∈[K] Gi
and |Gi
W )]. Let R′ := R1 ∪ ··· ∪ RK . Note that dR′ (u) ≤
For every i ∈ [K], let Ri := G[Vi, V (Gi
|V (Gi
∆(R′) ≤ 4ξn.
(5.5)

W| ≤ 2(|W|/k + 1) ≤ 2ξn for all i ∈ [K].
W )| ≤ 2ξn for all u ∈ U and dR′(w) ≤ k · 2|U|/K ≤ 4ξn for all w ∈ W , so

p be subsets of U with the following properties:

Let G′ := G − R′. So dG′(x, U ) ≥ (δ + 3µ/4)|U| for all x ∈ V (G). Let p := |W| and let
1, . . . , U ′
U ′
(a) dG′(x, U ′
(b) ρ|U|/2 ≤ |U ′
(c) |U ′
(d) each u ∈ U is contained in at most 3ρp/2 of the U ′
i .

i ) ≥ (δ + µ/2)|U ′
j| ≤ 3ρ2|U|/2 for all 1 ≤ i < j ≤ p;

i| for all x ∈ V (G) and i ∈ [p];

i| ≤ 2ρ|U| for all i ∈ [p];

That these subsets exist can again be seen by a probabilistic argument. Indeed, for every
pair (u, i) ∈ U × [p], include u in U ′
i with probability ρ independently of all other pairs.
Applying Lemma 3.1 shows that the random sets U ′
p satisfy the desired properties
with probability at least 3/4.

1, . . . , U ′

i ∩ U ′

W , . . . , GK

Next, we want to cover the edges of HW using R′. Recall that G1

Let w1, . . . , wp be an enumeration of W and let R′′ :=Si∈[p] G′[U ′
i,{wi}]. By (b) and (d),
∆(R′′) ≤ max{2ρ|U|, 3ρp/2} ≤ 2ρn.
Let G′′ := G−G[U ]−R′−R′′. Observe that δ(G′′) ≥ (δ+µ/2)n. We now apply Lemma 5.7
to ﬁnd an approximate decomposition of G′′. More precisely, by Lemma 5.7, there exists
a subgraph H of G′′ such that G′′ − H has an F -decomposition F1 and ∆(H) ≤ γn. Let
HW := H[W ] and HU W := H[U, W ].
W is a decom-
position of G[W ]. For all i ∈ [K], let Hi := HW ∩ Gi
W and Gi := G[Vi] ∪ Ri ∪ Hi. So the
W ) and thus µξ2n/10 ≤ |Vi| ≤ |Gi| ≤ 3ξn,
Hi decompose HW . Note that V (Gi) = Vi ∪ V (Gi
implying that |Vi| ≥ ξ2|Gi|. Moreover, dGi(x, Vi) ≥ (δ + ξ2)|Vi| for all x ∈ V (Gi) by (5.3)
F and ∆(Hi) ≤ γn ≤ √γ|Gi|, we can apply Pro-
and our choice of Ri. Since δ ≥ δvx
position 5.10 with ξ2 and √γ playing the roles of µ and γ to obtain a subgraph Ai of Gi
such that Ai ∪ Hi is F -decomposable, Ai[V (Gi) \ Vi] is empty and ∆(Ai) ≤ ξ4|Vi|. Let
A := A1 ∪ ··· ∪ AK. So A ∪ HW has an F -decomposition F2 and ∆(A) ≤ ξn.
We now want to cover the remaining edges of HU W ∪ R′ using R′′. Let G′′′ := G −
SF1 −SF2. Note that G′′′[W ] is empty. For every i ∈ [p], let U ′′
i. Hence,
i | ≤ ∆(HU W ) + ∆(R′) ≤ (γ + 4ξ)n. Let Ui := U ′
|U ′′
i . We want to check the conditions
of Lemma 5.8 for G′′′ and U1, . . . , Up, with µ/4 playing the role of µ. Conditions (i), (ii) and
(iv) clearly hold. To see that (iii) holds, let i ∈ [p] be arbitrary and consider ﬁrst u ∈ Ui.
Since G′′′[U ] = G −SF2, we have
dG′′′(u, Ui) ≥ dG(u, U ′

(a)
≥ (δ + µ/2)|U ′

i| − ξn ≥ (δ + µ/4)|Ui|.

:= NG′′′(wi)\ U ′

i ) − ∆(A)

F ≥ δe

i ∪ U ′′

i

Secondly, dG′′′(wi, Ui) ≥ dR′′ (wi, Ui) = dG′(wi, U ′
i )

For (v), observe that

(a)
≥ (δ + µ/2)|U ′

i| ≥ (δ + µ/4)|Ui|.

|Ui ∩ Uj|

(c)
≤ 3ρ2|U|/2 + 2(γ + 4ξ)n ≤ 2ρ2|U|

15

for all 1 ≤ i < j ≤ p.
Finally, note that every u ∈ U is contained in at most ∆(HU W ) + ∆(R′) ≤ (γ + 4ξ)n
of the sets U ′′
i . Combining this with (d), we conclude that u is contained in at most
3ρp/2 + (γ + 4ξ)n ≤ 2ρn of the Ui’s, establishing (vi). Thus, by applying Lemma 5.8, we
obtain a subgraph GU of G′′′[U ] such that GU ∪ G′′′[U, W ] has an F -decomposition F3 and
∆(GU ) ≤ (µ/4)2|U|.
Let F := F1∪F2∪F3. By construction, F covers every edge of G− G[U ], and ∆(F[U ]) ≤
∆(A) + ∆(GU ) ≤ µ2|U|/4.
(cid:3)

We can ﬁnally deduce Lemma 5.1 by inductively applying Lemma 5.11.

Proof of Lemma 5.1.
We prove the following stronger statement by induction on ℓ.

If ℓ = 0, then we can put Hℓ := G. Therefore, let us assume ℓ ≥ 1.

Let G be an F -degree-divisible graph with δ(G) ≥ (δ+3µ)|G| and let U1 be a subset of V (G)
of size ⌊µ|G|⌋ such that dG(x, U1) ≥ (δ+7µ/2)|U1| for all x ∈ V (G). Let U1 ⊇ U2 ⊇ ··· ⊇ Uℓ
be a (δ+4µ, µ, m)-vortex in G[U1]. Then there exists a subgraph Hℓ of G[Uℓ] such that G−Hℓ
is F -decomposable.

If ℓ = 1, then Lemma 5.11 applied to G and U1 yields a subgraph H1 of G[U1] such
that G − H1 is F -decomposable. So let us assume that ℓ ≥ 2 and that the claim holds
for ℓ − 1. Let G′ := G − G[U2]. Note that δ(G′) ≥ (δ + 2µ)|G′| and dG′(x, U1) ≥ (δ +
µ)|U1|. Furthermore, dG′(x) = dG(x) and thus gcd(F ) | dG′(x) for all x ∈ V (G′) \ U1.
By Lemma 5.11, there exists an F -collection F in G′ that covers all edges outside G′[U1]
and satisﬁes ∆(SF[U1]) ≤ µ2|U1|/4. Let G′′ := G[U1] −SF. So G′′ is F -degree-divisible
and δ(G′′) ≥ (δ + 3µ)|G′′|. Moreover, U2 is a subset of V (G′′) of size ⌊µ|G′′|⌋ such that
dG′′(x, U2) ≥ (δ + 4µ)|U2| − ∆(SF[U1]) ≥ (δ + 7µ/2)|U2| for all x ∈ V (G′′). Finally,
U2 ⊇ ··· ⊇ Uℓ is a (δ + 4µ, µ, m)-vortex in G′′[U2], since G′′[U2] = G[U2]. By induction,
there exists a subgraph Hℓ of G′′[Uℓ] such that G′′ − Hℓ has an F -decomposition F ′. But
now, F ∪ F ′ is an F -decomposition of G − Hℓ, completing the proof.

(cid:3)

6. Regularity

In this section, we state Szemer´edi’s regularity lemma and related tools. Let G be a graph
with two disjoint sets of vertices A, B ⊆ V (G). The density of G[A, B] is then deﬁned as
αG(A, B) := eG(A, B)/(|A||B|). Given ε > 0, we call G[A, B] ε-regular if for all sets X ⊆ A
and Y ⊆ B with |X| ≥ ε|A| and |Y | ≥ ε|B|, we have |αG(X, Y ) − αG(A, B)| < ε.
Fact 6.1. Let G[A, B] be ε-regular with density α and let Y ⊆ B with |Y | ≥ ε|B|. Then all
but at most ε|A| vertices of A have at least (α − ε)|Y | neighbours in Y .
Fact 6.2. Let G[A, B] be ε-regular with density α and for some c > ε, let A′ ⊆ A and
B′ ⊆ B with |A′| ≥ c|A| and |B′| ≥ c|B|. Then G[A′, B′] is 2ε/c-regular with density α ± ε.
Lemma 6.3 (Regularity lemma). For all ε > 0 and k0 ∈ N, there exists a k′
0 = k′
0(ε, k0)
such that for all α ∈ [0, 1] the following holds. Let G be a graph on n ≥ k′
0 vertices and
W1, . . . , Wℓ a partition of V (G) with ℓ ≤ k0. Then there exist a partition V0, V1, . . . , Vk of
V (G) and a spanning subgraph G′ of G satisfying the following:
(R1) k0 ≤ k ≤ k′
0;
(R2) |V0| ≤ εn;
(R3) |V1| = ··· = |Vk|;
(R4) dG′(x) ≥ dG(x) − (α + ε)n for all x ∈ V (G);
(R5) G′[Vi] is empty for all i ∈ [k];
(R6) for all 1 ≤ i < j ≤ k, G′[Vi, Vj] is either ε-regular with density at least α or empty;
(R7) for all i ∈ [k] and j ∈ [ℓ], Vi ∩ Wj = ∅ or Vi ⊆ Wj.

16

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Given a graph G and a partition V1, . . . , Vk of V (G), we associate a so-called reduced graph
R with this partition, where R has vertex set [k] and ij ∈ E(R) if and only if G[Vi, Vj] is
non-empty. We refer to the function σ : V (G) → V (R) such that x ∈ Vσ(x) for all x ∈ V (G)
as the cluster function. In the setting of Lemma 6.3, we slightly abuse notation and say that
R is the reduced graph of V1, . . . , Vk if R is the reduced graph of V1, . . . , Vk with respect to
G′[V (G) \ V0].
Proposition 6.4. Suppose that G is a graph on n vertices with δ(G) ≥ δn and that G′ and
V0, . . . , Vk satisfy (R1)–(R6). Then δ(R) ≥ (δ − α − 2ε)k, where R is the reduced graph of
V1, . . . , Vk.

We will often use the following embedding lemma which is straightforward to prove and

has become known as the ‘key lemma’.
Lemma 6.5 (Key lemma). Let 1/n ≪ ε ≪ α ≪ 1/m. Let G be a graph such that

• V (G) = V1 ·∪ . . . ·∪ Vk;
• for all i ∈ [k], |Vi| = n and G[Vi] is empty;
• for all 1 ≤ i < j ≤ k, G[Vi, Vj] is either ε-regular with density at least α or empty.
Let R be the reduced graph of V1, . . . , Vk. Let H be a graph of order at most m and suppose
that ψ : H → R is a homomorphism. Moreover, let (Cx)x∈V (H) be candidate sets such that
Cx ⊆ Vψ(x) and |Cx| ≥ αn for all x ∈ V (H). Then there exists an embedding φ : H → G
such that φ(x) ∈ Cx for all x ∈ V (H).

The following deﬁnition will be crucial for our embeddings.
We call G[A, B] weakly-(α, ε)-super-regular if

• G[A, B] is ε-regular with density at least α;
• for all a ∈ A, dG(a, B) ≥ α|B| or dG(a, B) = 0;
• for all b ∈ B, dG(b, A) ≥ α|A| or dG(b, A) = 0.

The next proposition implies that we can turn any ε-regular pair into a weakly-super-
regular pair by deleting a small number of edges. This will allow us to simultaneously turn
all regular pairs of a regularity partition obtained by the regularity lemma into weakly-
super-regular pairs (which is impossible for the more standard notion of super-regularity as
one needs to delete vertices in that case).
Proposition 6.6. Let G[A, B] be ε-regular with density at least α and assume that |A| =
|B| =: m. Then G[A, B] can be made weakly-(α − 2√ε, 4√ε)-super-regular by deleting at
most (α − ε)m edges at every vertex.

Many of our constructions will be carried out in a graph where we have found a regularity
partition and ‘cleaned’ the edges between classes using Proposition 6.6. In order to describe
such graphs, we use the following deﬁnition. Given a graph G, we call a partition V1, . . . , Vk
of V (G) an (α, ε, k)-partition of G, if

(P1) |Vi| = (1 ± ε)|G|/k;
(P2) G[Vi] is empty for every i ∈ [k];
(P3) for all 1 ≤ i < j ≤ k, G[Vi, Vj] is either weakly-(α, ε)-super-regular or empty.
We will often use the fact that if V1, . . . , Vk is an (α, ε, k)-partition of G and G′ is a
spanning subgraph of G such that dG′(x, Vi) ≥ dG(x, Vi) − ε2|Vi| for all x ∈ V (G) and
i ∈ [k], then V1, . . . , Vk is an (α − 2ε, 3ε, k)-partition of G′.
k is
an (α − ε, 3ε, k)-partition of G[V ′

i | ≤ ε2|Vi| for all i ∈ [k], then V ′

1 ∪ ··· ∪ V ′
k].

Similarly, if ε ≤ 1/2 and V ′

i ⊆ Vi with |Vi \ V ′

1, . . . , V ′

7. The general decomposition theorem

In Section 5 we saw how to ﬁnd a near-optimal F -decomposition of a given graph G
which covers all but a bounded number of edges of G. As mentioned in Section 2, our goal

17

is to deal with the leftover edges using absorbers. Given graphs F and H, an F -absorber
for H is a graph A such that V (H) ⊆ V (A) is independent in A and both A and A ∪ H
have F -decompositions. For H to have an F -absorber it is clearly necessary that H is at
least F -divisible. Clearly, if G was F -divisible in the beginning, then the leftover graph H
obtained from a near-optimal F -decomposition of G is still F -divisible. The strategy is thus
to ﬁnd an F -absorber A for every possible leftover graph H and remove all these absorbers
before covering almost all edges of G. The union of these absorbers will then allow us to deal
with any leftover from the near-optimal decomposition. In this section, we prove a general
decomposition result, that is, G has an F -decomposition whenever the minimum degree of
G is large enough to guarantee (i) an approximate decomposition, (ii) a covering of all edges
at one vertex, (iii) an absorber for any bounded size subgraph (see Theorem 7.1).

In order to minimise the minimum degree we require to ﬁnd absorbers, we will make
sure that the possible leftover graphs respect an (α, ε, k)-partition. We will achieve this by
applying the regularity lemma to G ﬁrst and then ‘cleaning’ G with respect to the obtained
partition. Call F δ-absorbing if the following is true:

Let 1/n ≪ 1/k′
0, ε ≪ α, 1/b ≪ 1/m, µ, 1/|F| and suppose that G is a graph on n
vertices with δ(G) ≥ (δ + µ)n which has an (α, ε, k)-partition for some k ≤ k′
0, and
that H is any F -divisible subgraph of G of order at most m. Then G contains an
F -absorber for H of order at most b.

The focus of Sections 8, 9, 10 and 12 will be to ﬁnd for a given graph F the minimal δ

such that F is δ-absorbing.
Theorem 7.1. Let F be a graph. Let δ ≥ max{δ0+
F }, and assume that F is δ-absorbing.
Then δF ≤ δ.
0 ≪ ε ≪ 1/k0, α, 1/b ≪ 1/m′ ≪ µ, 1/|F|. Let G be an F -
Proof. Let 1/n ≪ 1/k′
divisible graph on n vertices with δ(G) ≥ (δ + 10µ)n. We need to show that G has an
F -decomposition.
Set U0 := V (G). Using Lemma 3.1, it is easy to see that there exists a subset U1 of size

F , δvx

⌊µn⌋ such that for all x ∈ V (G),
(7.1)

(7.2)

dG(x, U1) ≥ (δ + 9µ)|U1|,

dG(x, U0 \ U1) ≥ (δ + 9µ)|U0 \ U1|.

Apply the regularity lemma (Lemma 6.3) to G[U1] to obtain a partition of U1 into sets

V0, V1, . . . , Vk and a spanning subgraph G′ of G[U1] such that
(R1) k0 ≤ k ≤ k′
0;
(R2) |V0| ≤ ε|U1|;
(R3) |V1| = ··· = |Vk|;
(R4) dG′(x) ≥ dG[U1](x) − (α + ε)|U1| for all x ∈ U1;
(R5) G′[Vi] is empty for all i ∈ [k];
(R6) for all 1 ≤ i < j ≤ k, G′[Vi, Vj] is either ε-regular with density at least α or empty.
Applying Proposition 6.6 to every pair G′[Vi, Vj] of density at least α yields a spanning
subgraph Gcl of G′ such that
(R1′) dGcl(x) ≥ dG[U1](x) − 2α|U1| for all x ∈ U1;
(R2′) Gcl[Vi] is empty for all i ∈ [k];
(R3′) for all 1 ≤ i < j ≤ k, Gcl[Vi, Vj] is either weakly-(α − 2√ε, 4√ε)-super-regular or
Let H := G[U1] − Gcl. Note that ∆(H) ≤ 2α|U1| ≤ 2αn and δ ≥ δvx
F . So by (7.2)
and Proposition 5.10, we can obtain a subgraph A of G such that A[U1] is empty, A ∪ H is
F -decomposable and ∆(A) ≤ µ4n.

F ≥ δe

empty.

By (7.1) and (R1′),

(7.3)

δ(Gcl) ≥ (δ + 8µ)|U1|.

18

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Let U2 be a subset of U1 \ V0 of size ⌊µ|U1|⌋ satisfying the following properties (consider

a random choice of U2 and apply Lemma 3.1):
(i) dGcl(x, U2) ≥ (δ + 7µ)|U2| for all x ∈ U1;
(ii) |Vi \ U2| = (1 − µ ± ε)|Vi| for all i ∈ [k];
(iii) dGcl(x, Vi \ U2) ≥ (1 − 2µ)dGcl(x, Vi) for all x ∈ U1, i ∈ [k].

Finally, let U2 ⊇ U3 ⊇ ··· ⊇ Uℓ be a (δ + 6µ, µ, m)-vortex in Gcl[U2] for some ⌊µm′⌋ ≤
m ≤ m′, which exists by Lemma 4.3. We want to ﬁnd an absorber for every F -divisible
subgraph of Gcl[Uℓ]. We will ﬁnd these in the following graph Gabs: For every i ∈ [k], let
V ′
i := (Vi \ U2) ∪ (Vi ∩ Uℓ), and let

Note that, since Uℓ ⊆ U2 ⊆ U1 \ V0, we have that Uℓ ⊆ V (Gabs). We claim that

Gabs := Gcl[V ′

1 ∪ ··· ∪ V ′
k].
k is an (α/2, 10√ε, k)-partition of Gabs;

1, . . . , V ′

1 ∪ ··· ∪ V ′

In order to establish condition (P3), consider 1 ≤ i < j ≤ k.

(iv) V ′
(v) δ(Gabs) ≥ (δ + 6µ)|Gabs|.
To verify (v), recall (7.3) and note that |U1 \ (V ′
Now, we check (iv). Gabs[V ′
satisﬁed. By (ii), we have |V ′
4ε|U1|/k for all 1 ≤ i < j ≤ k and hence |V ′
then Gabs[V ′
super-regular. We need to show that Gabs[V ′
Fact 6.2, Gabs[V ′
suppose that dGabs(x, V ′
that

i ] is clearly empty for every i ∈ [k], so condition (P2) is
i | = (1 − µ ± 2ε)|Vi|. Now, (R3) implies that ||V ′
j|| ≤
If Gcl[Vi, Vj] is empty,
j ] is also empty. So let us assume that Gcl[Vi, Vj] is weakly-(α − 2√ε, 4√ε)-
j ] is weakly-(α/2, 10√ε)-super-regular. By
i , V ′
i and
j ) > 0. Then, dGcl(x, Vj) ≥ (α − 2√ε)|Vj|. Using (iii), we can check
j |/2.

j ) ≥ dGcl(x, Vj \ U2) ≥ (1 − 2µ)dGcl(x, Vj) ≥ (1 − 2µ)(α − 2√ε)|Vj| ≥ α|V ′

j ] is 10√ε-regular with density at least α − 6√ε ≥ α/2. Let x ∈ V ′

k)| ≤ |U2| + |V0| ≤ 2µ|U1|.
i | − |V ′

i | = (1 ± 5ε)|Gabs|/k, so (P1) is satisﬁed.

i , V ′

i , V ′

dGabs(x, V ′

This proves (iv).

We will now ﬁnd absorbers for all possible leftover graphs inside Uℓ. Let therefore
H1, . . . , Hs be an enumeration of all F -divisible spanning subgraphs of Gcl[Uℓ]. We want
to ﬁnd edge-disjoint subgraphs A1, . . . , As in Gabs such that for all i ∈ [s], Ai[Uℓ] is empty
and Ai is an F -absorber for Hi of order at most b. Suppose that for some j ∈ [s], we
have already chosen A1, . . . , Aj−1. Let ˜Gj be the graph obtained from Gabs by deleting all
edges inside Uℓ except those of Hj, and all edges of A1, . . . , Aj−1. Since we deleted at most
m + sb ≤ m + 2(m
2 )b edges at every vertex, (v) implies that δ( ˜Gj ) ≥ (δ + 5µ)| ˜Gj|. Also,
k is an (α/4, 30√ε, k)-partition of ˜Gj. Since F is δ-absorbing, ˜Gj
1, . . . , V ′
(iv) implies that V ′
contains an F -absorber Aj for Hj of order at most b and so that Aj[Uℓ] is empty.

Let A∗ := A1 ∪ ··· ∪ As. Let Gapp := G − (A ∪ H) − A∗. Observe that

(7.4)

Gapp[U2] = (G − H)[U2] = Gcl[U2].

We want to apply Lemma 5.1 to Gapp. Note that

∆(A∗ ∪ A ∪ H) ≤ 2µ4n ≤ µ|U2|.

(7.5)
Clearly, Gapp is F -divisible and δ(Gapp) ≥ (δ + 8µ)n by (7.5). We claim that U0 ⊇ U1 ⊇
··· ⊇ Uℓ is a (δ + 4µ, µ, m)-vortex in Gapp. Conditions (V1)–(V3) hold by construction.
Moreover, for i ≥ 3, we have dGapp(x, Ui) ≥ (δ + 6µ)|Ui| for all x ∈ Ui−1 by (7.4). So let
i ∈ {1, 2}. For all x ∈ Ui−1, we get

(7.5)

dGapp(x, Ui)

≥ dG(x, Ui) − µ|U2| ≥ (δ + 7µ)|Ui| − µ|U2| ≥ (δ + 6µ)|Ui|,

where we use (7.1) if i = 1 and (i) if i = 2. Thus, by Lemma 5.1, there exists a subgraph
H ∗
ℓ of Gapp[Uℓ] such that Gapp − H ∗
ℓ is F -divisible.
ℓ = Hs′ for some s′ ∈ [s]. Since As′ ∪ Hs′ has an
Crucially, by (7.4), Gapp[Uℓ] = Gcl[Uℓ], so H ∗

ℓ is F -decomposable. In particular, H ∗

F -decomposition and Ai has an F -decomposition for every i ∈ [s] \ {s′}, we conclude that
A∗ ∪ H ∗

ℓ is F -decomposable. Therefore,

G = (A ∪ H) ∪ A∗ ∪ (Gapp − H ∗

ℓ ) ∪ H ∗

ℓ

has an F -decomposition.

19

(cid:3)

8. Models and compressions

In order to prove an upper bound on δF using Theorem 7.1, we must be able to ﬁnd F -
absorbers for rather arbitrary subgraphs of a large graph G. Suppose that G′ is a subgraph
of G and we know that H is an F -absorber for G′. The Erd˝os–Stone theorem tells us
that δ(G) ≥ (1 − 1/(χ(H) − 1) + µ)|G| guarantees a copy of H in G. However, for H to
fulﬁll its purpose, we need it to be rooted at V (G′), which is more diﬃcult to achieve. In
the following, we will introduce the concepts that enable us to embed rooted graphs in an
eﬃcient way.

8.1. Models and labellings. We deﬁne a model to be a pair (H, U ) where H is a graph
and U is an independent set in H. The vertices of U are called roots. Generally speaking,
we want to embed H into a large graph G in such a way that the roots are mapped to
a prescribed destination. More formally, given a model (H, U ), a graph G and a map
Λ : U → 2V (G), an embedding of (H, U ) into G respecting Λ is an injective homomorphism
φ : H → G such that φ(u) ∈ Λ(u) for all u ∈ U . Clearly, a necessary condition for the
existence of an embedding respecting Λ is that there exist distinct (vu)u∈U ∈ V (G) with
vu ∈ Λ(u). If this is satisﬁed, then we call Λ a G-labelling of U . All our labellings will be of
the following form. There will be a set U1 ⊆ U such that |Λ(u)| = 1 for all u ∈ U1 (and thus
Λ(u) 6= Λ(u′) for all distinct u, u′ ∈ U1). The labels of the elements of U \ U1 will be large
subsets of clusters of a regularity partition. Furthermore, most often we will have U1 = U .
Call a model (H, U ) δ-embeddable, if for all µ > 0, there exists an n0 ∈ N such that
whenever G is a graph on n ≥ n0 vertices with δ(G) ≥ (δ + µ)n and Λ is any G-labelling of
U , there exists an embedding of H into G respecting Λ. As described below, the degeneracy
of H rooted at U can be used to give a simple bound on the values of δ for which (H, U )
is δ-embeddable. Here, for a graph K, the degeneracy of K rooted at X ⊆ V (K) is the
smallest d ∈ N ∪ {0} such that there exists an ordering v1, . . . , v|K|−|X| of the vertices of
V (K) \ X such that for all i ∈ [|K| − |X|],

dK (vi, X ∪ {vj : 1 ≤ j < i}) ≤ d.

Observe that if H has degeneracy at most d rooted at U for some d ∈ N, then (H, U ) is
(1 − 1/d)-embeddable. Indeed, if G is a graph with δ(G) ≥ (1 − 1/d + µ)|G|, then every
set of d vertices has many common neighbours. Hence, any set of |U| vertices in G can be
extended to a copy of H by embedding the vertices of V (H) \ U one by one.
As we shall discuss in the next subsection, this simple bound is usually not suﬃcient for
our purposes. Before that, we will prove the following lemma which is used in Sections 11
and 14. It says that if the minimum degree of G is suﬃciently large to embed a copy of (H, U )
according to any given labelling, then we can in fact embed many copies edge-disjointly into
G, provided that the respective labellings are not overly restrictive.
Lemma 8.1. Let (H, U ) be a δ-embeddable model for some δ ∈ [0, 1]. Let 1/n ≪ µ ≪ 1/|H|
and let G be a graph on n vertices with δ(G) ≥ (δ + µ)n. Suppose that Λ1, . . . , Λm are G-
labellings of U such that m ≤ µ4n2 and for all v ∈ V (G), |{j ∈ [m] : v ∈S Im(Λj)}| ≤ µ2n.
Then there exist embeddings φ1, . . . , φm of H into G such that φj respects Λj for all j ∈ [m],
φ1(H), . . . , φm(H) are edge-disjoint, and ∆(Sj∈[m] φj(H)) ≤ µn.
Proof. We may assume that |Λj(u)| = 1 for all j ∈ [m] and u ∈ U . Let Rj :=Su∈U Λj(u).
We will ﬁnd φ1, . . . , φm one by one. For j ∈ [m] and v ∈ V (G), deﬁne root(v, j) := |{j′ ∈

20

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

[j] : v ∈ Rj′}|. Suppose that for some j ∈ [m], we have already deﬁned φ1, . . . , φj−1 such
that

(8.1)

dGj−1(v) ≤ µ2n + (root(v, j − 1) + 1)|H|

for all v ∈ V (G), where Gj−1 := Sj′∈[j−1] φj′(H). We now want to deﬁne φj such that
dGj−1(v) > µ2n}.
(8.1) holds with j replaced by j + 1. Let BAD := {v ∈ V (G) :
Note that 2e(Gj−1) ≥ |BAD|µ2n and e(Gj−1) ≤ me(H) ≤ µ4e(H)n2. Thus, |BAD| ≤
2µ2e(H)n ≤ µn/4. Let BAD′ := BAD \ Rj and deﬁne G′ := (G − Gj−1)[V (G) \ BAD′].
Since ∆(Gj−1) ≤ µn/4, we have δ(G′) ≥ (δ + µ/2)n. Note that Λ is a G′-labelling of (H, U ).
Since (H, U ) is δ-embeddable, there exists an embedding φj of H into G′ respecting Λj. It
remains to show that (8.1) holds with j replaced by j + 1. Let v ∈ V (G). If v /∈ BAD,
then dGj (v) ≤ dGj−1 (v) + |H| ≤ µ2n + |H|, so assume that v ∈ BAD.
If v ∈ BAD′,
then dφj(H)(v) = 0 and hence dGj (v) ≤ dGj−1(v). Finally, if v ∈ BAD \ BAD′, then
v ∈ Rj, implying that root(v, j) = root(v, j − 1) + 1. Thus, dGj (v) ≤ dGj−1(v) + |H| ≤
µ2n + (root(v, j) + 1)|H|.
(cid:3)

8.2. Compressions. As observed in the previous section, the rooted degeneracy of a model
(H, U ) translates into a bound on the minimum degree of a graph G which ensures the
embeddability of (H, U ). However, this bound is usually too large for our purposes. We
will improve on this by considering the above degeneracy approach in the reduced graph
setting. This involves the notion of compressions which we now discuss informally.

Let (H, U ) be a model. Let G be a graph and Λ a G-labelling of U , and as an example
assume that U = {u1, u2} and Λ(ui) = {vi}. Suppose that R is the reduced graph of some
regularity partition of G with cluster function σ. The key lemma tells us that if there
exists a homomorphism H → R, then H can be embedded into G, but the corresponding
embedding does not necessarily respect the given labelling Λ. It will be useful to have an
embedding φ of H such that, though φ might not respect Λ, it is close to respecting Λ (in
the sense that at least every vertex is embedded in the correct cluster). More precisely,
2 ∈ V (R) be such that σ(vi) = x′
i, we require σ(φ(ui)) = x′
i. Now, if ψ′ : H → R
letting x′
was a homomorphism such that ψ′(ui) = x′
i, then the key lemma again would give us such
an embedding.

1, x′

In order to investigate the embedding properties of (H, U ) without referring to the host
graph and labelling, we consider the following intermediate graph: By considering only
(H, U ), we ﬁnd a graph K such that ψ : H → K is a homomorphism, {x1, x2} is independent
in K and K has low degeneracy rooted at {x1, x2}, where xi := ψ(ui) are distinct. Then,
coming back to the above situation, we can use a degeneracy argument to ﬁnd a copy of K in
R rooted at {x′
i. We can then
take ψ′ := ψ′′◦ψ to ﬁnd a homomorphism from H into R. In ﬁnding this homomorphism, we
have used the degeneracy of K, not H. We can easily pick such a graph K with degeneracy
at most χ(H) + |U| − 1, and sometimes even lower. In many cases this is much lower than
the degeneracy of H, reducing the minimum degree required. Loosely speaking, our gain
has come from the fact that we ‘compressed’ the original embedding problem to the reduced
graph level.

2}, i.e., a homomorphism ψ′′ : K → R such that ψ′′(xi) = x′

1, x′

Note that we assumed {x1, x2} is independent. If x′

2 ∈ E(R), then we could allow K
to contain the edge x1x2, possibly allowing a graph K with lower degeneracy to be used.
Similarly, if x′
2, we can construct K with x1 = x2, which may allow us to use a graph
K with lower degeneracy.

1 = x′

1x′

The following deﬁnitions formalise the above discussion. Given a set U , a pair (J, f )
is called a root-compression of U , if J is a graph and f : U → V (J) is a surjective map.
Further, (J, f, K, ψ) is called a compression of (H, U ) if

(C1) K is a graph and J is an induced subgraph of K;
(C2) (J, f ) is a root-compression of U ;

21

(C3) ψ : H → K is a homomorphism such that ψ↾U = f .
We say that (J, f, K, ψ) is a d-compression if K has degeneracy at most d rooted at V (J).
For our purposes, J will be a rather simple graph, e.g. a short cycle or path, whereas K
may have a more complex structure. It is thus often convenient to ignore K itself and only
record its degeneracy. Accordingly, (H, U ) is called d-compressible with respect to (J, f ), if
there exist K and ψ such that (J, f, K, ψ) is a d-compression of (H, U ). When referring
to a compression (J, f, K, ψ), J and f are technically redundant since J = K[ψ(U )] and
f = ψ↾U . However, as indicated above, the root-compression (J, f ) is often the essential
part of (J, f, K, ψ) and we want to be able to refer to it directly.

Our embedding approach is roughly as follows (this is formalised in Lemma 8.4). Assume
that (H, U ) is d-compressible with respect to (J, f ). Let G be a graph with δ(G) ≥ (1 −
1/d + µ)|G| and let R be the reduced graph of some regularity partition of G. Instead of
seeking an embedding approach which works for all possible G-labellings Λ of U , we limit
ourselves to ‘admissible’ labellings. Informally, this means that J is a subgraph of R such
that every label Λ(u) is contained in the cluster of f (u). By deﬁnition, there exist K and ψ
such that (J, f, K, ψ) is a d-compression of (H, U ). As R inherits the minimum degree ratio
of G and since K has degeneracy at most d rooted at V (J), we can extend J to a copy of
K in R. Then, using the key lemma, we can embed H into G such that u ∈ U is mapped
into the cluster of f (u). This embedding is close to what we desire in the sense that the
image of u and the label of u are already in the same cluster. Finally, we will modify this
embedding to an embedding respecting Λ. It remains to make more precise when a labelling
is admissible. We can then prove our embedding lemma.

For this, we say that a G-labelling Λ of U respects the root-compression (J, f ), if Λ(u) =
Λ(u′) for all u, u′ ∈ U with f (u) = f (u′). In this case, the function ΛJ : V (J) → 2V (G),
where ΛJ (x) := Λ(u) for any u ∈ f −1(x), is well-deﬁned.
The following deﬁnition collects a set of restrictions that we put on a G-labelling Λ. They
will later enable us to ﬁnd an embedding of a given model (H, U ) into G respecting Λ. Note
that the conditions do not involve H, but depend on the chosen root-compression (J, f ) of
U .

Deﬁnition 8.2. Let U be a set with root-compression (J, f ), G a graph and Λ a G-labelling
of U . Let U1 := {u ∈ U :
|Λ(u)| = 1} and U2 := U \ U1. Moreover, let J1 := f (U1)
and J2 := V (J) \ J1. We call Λ (α, ε, k)-admissible, if Λ respects (J, f ) and G has an
(α, ε, k)-partition V1, . . . , Vk with reduced graph R such that the following hold:
(D1) there exists a homomorphism j : J → R such that ΛJ (x) ⊆ Vj(x) for all x ∈ V (J);
(D2) |ΛJ (x)| ≥ α|Vj(x)| for all x ∈ J2;
(D3) for every x ∈ V (J), dG(Wx, Vj(x)) ≥ α|Vj(x)|, where Wx :=Sy∈NJ (x,J1) ΛJ (y);
(D4) ΛJ (x) ⊆ NG(Wx, Vj(x)) for all x ∈ J2.
In order to prove the main lemma of this section (i.e. Lemma 8.4), we need the following

simple result.
Proposition 8.3. Let α ∈ (0, 1). Let G be a graph and let V1, . . . , Vk be a partition of V (G)
such that |Vi| ≥ 1/α for all i ∈ [k]. Let W ⊆ V (G). Then there exists a spanning subgraph G′
of G such that dG′(x) ≥ dG(x)− α22|W |+1|G| for every x ∈ V (G) and dG′(W ′, Vi) /∈ (0, α|Vi|)
for every subset W ′ ⊆ W and every i ∈ [k].
Proof. Let n := |G| and let W1, . . . , Ws be an enumeration of the subsets of W . For each
j ∈ [s], let βj := 2s−j, γj := β1 + ··· + βj and γ0 := 0. Suppose that for some j ∈ [s], we
have found a subgraph Gj−1 by deleting at most γj−1αn edges at every vertex such that
dGj−1 (Wℓ, Vi) /∈ (0, βj−1α|Vi|) for every i ∈ [k] and ℓ ∈ [j − 1]. Consider Wj and ﬁx some
w ∈ Wj. Let I ⊆ [k] contain the indices i for which dGj−1 (Wj, Vi) < βjα|Vi|. Let Gj be
obtained from Gj−1 by deleting for every i ∈ I the edges from w to NGj−1(Wj, Vi). Clearly,
for all i ∈ [k], dGj (Wj, Vi) /∈ (0, βj α|Vi|), and Gj is obtained from Gj−1 by deleting at most

22

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

βjαn edges at every vertex. It remains to show that for all ℓ ∈ [j − 1] and i ∈ [k], we have
dGj (Wℓ, Vi) /∈ (0, βj α|Vi|). Suppose that ℓ ∈ [j − 1], i ∈ [k] and dGj (Wℓ, Vi) > 0. If w ∈ Wℓ,
then dGj (Wℓ, Vi) ≥ dGj−1(Wℓ, Vi) − βjα|Vi| ≥ (βj−1 − βj)α|Vi| = βjα|Vi|. If w /∈ Wℓ, then
we have dGj (Wℓ, Vi) ≥ dGj−1(Wℓ, Vi) − 1 ≥ (βj−1 − βj)α|Vi| = βjα|Vi| as well.
(cid:3)

Let G′ := Gs. Note that βs = 1 and γs ≤ 2s+1.

0. Then there exists an embedding of (H, U ) into G respecting Λ.

Lemma 8.4. Let 1/n ≪ 1/k′
0, ε ≪ α ≪ 1/t, µ. Let (H, U ) be a d-compressible model with
respect to the root-compression (J, f ) such that |H| ≤ t. Suppose that G is a graph on n
vertices with δ(G) ≥ (1 − 1/d + µ)n and Λ is an (α, ε, k)-admissible G-labelling of U for
some k ≤ k′
Proof. Let U1, U2, J1, J2, V1, . . . , Vk, R, j, (Wx)x∈V (J) be as in Deﬁnition 8.2. Let σ : V (G) →
V (R) be the cluster function of V1, . . . , Vk. Let K and ψ be such that (J, f, K, ψ) is a d-
compression of (H, U ). We may assume that |K| ≤ t. We deﬁne Wx also for x ∈ V (K)\V (J),
that is, Wx :=Sy∈NK (x,J1) ΛJ (y).
Λ(u) and apply Proposition 8.3 to obtain a spanning subgraph G′ of G
Let W :=Su∈U1
such that δ(G′) ≥ (1 − 1/d + µ/2)n and dG′(W ′, Vi) /∈ (0, α|Vi|) for every subset W ′ ⊆ W
and every i ∈ [k]. For every x ∈ J1, let vx ∈ V (G) be such that ΛJ (x) = {vx}. So
W = {vx : x ∈ J1}. For every x ∈ J2, pick any vertex vx ∈ Vj(x).

We are going to deﬁne a homomorphism ˆξ : K → R such that ˆξ↾V (J) = j and NG(Wx, V ˆξ(x)) 6=

K (xi)| ≤ d, where N <

∅ for all x ∈ V (K)\ V (J). First we deﬁne a homomorphism ξ : (K − J) → G′ as follows. For
every x ∈ V (J), let ξ(x) := vx. Let x1, . . . , xℓ be an ordering of the vertices of V (K)\ V (J)
such that for every i ∈ [ℓ], we have |N <
K (xi) := NK(xi) ∩ (V (J) ∪ {xj :
j < i}). We deﬁne ξ(xi) one by one. Suppose that for some i ∈ [ℓ], we have already deﬁned
ξ(x1), . . . , ξ(xi−1). Since δ(G′) ≥ (1 − 1/d + µ/2)n, we know that NG′(ξ(N <
K (xi))) 6= ∅, so
we can pick ξ(xi) from this set. Note that for all i ∈ [ℓ], we have Wxi ⊆ ξ(N <
K (xi)) and thus
(8.2)
We now obtain a homomorphism ˆξ : K → R, where we let ˆξ(x) := σ(ξ(x)) for all x ∈ V (K).
Note that ˆξ(x) = j(x) for all x ∈ V (J), therefore, ˆξ is indeed a homomorphism.
For every vertex x ∈ V (K), we will construct a set Zx ⊆ V (G) such that (Z1)–(Z5) below
hold. These sets Zx will then be suitable for an application of the key lemma.

ξ(xi) ∈ NG′(Wxi).

x for every x ∈ V (K) such that

x| ≥ α|V ˆξ(x)| for all x ∈ V (K);
x = ΛJ (x);

(Z1) The Zx’s are pairwise disjoint and disjoint from W ;
(Z2) |Zx| ≥ αn/2kt for all x ∈ V (K);
(Z3) if xy ∈ E(K), then G[Zx, Zy] is √ε-regular with density at least α/2;
(Z4) for all x ∈ J2, Zx ⊆ ΛJ (x);
(Z5) for all xy ∈ E(K) with x ∈ J1, Zy ⊆ NG(vx).
In order to achieve this, we ﬁrst deﬁne a set Z ′
x ⊆ V ˆξ(x) and |Z ′
(Z1′) Z ′
(Z2′) for all x ∈ J2, Z ′
(Z3′) for all xy ∈ E(K) with x ∈ J1, Z ′
For x ∈ J2, we let Z ′
(Z2′) holds by deﬁnition.
We now check (Z1′). Recall that ˆξ(x) = j(x) for all x ∈ V (J), so we clearly have
x ⊆ V ˆξ(x) for all x ∈ V (K). Now, if x ∈ J1, then |Z ′
Z ′
If
x ∈ J2, then it holds by (D2). So let x ∈ V (K) \ V (J). Since Wx ⊆ W , we have that
dG′(Wx, V ˆξ(x)) /∈ (0, α|V ˆξ(x)|). But ξ(x) ∈ NG′(Wx) by (8.2) and ξ(x) ∈ V ˆξ(x) by deﬁnition of
ˆξ. Thus NG′(Wx, V ˆξ(x)) is non-empty and we deduce that |Z ′
x| = dG(Wx, V ˆξ(x)) ≥ α|V ˆξ(x)|.

x := ΛJ (x). For x ∈ V (K) \ J2, we let Z ′

x| ≥ α|V ˆξ(x)| holds by (D3).

x := NG(Wx, V ˆξ(x)). Thus,

y ⊆ NG(vx).

23

y if y /∈ J2, and from (D4) if y ∈ J2. So Z ′

It is now relatively easy to obtain Zx from Z ′

y ⊆ NG(vx) follows from that.

by deﬁnition of Wy. Moreover, note that Z ′
deﬁnition of Z ′

We continue with checking (Z3′). Let xy ∈ E(K) and x ∈ J1. Note that vx ∈ Wy
y ⊆ NG(Wy), which follows directly from the
x. Since there are |K| ≤ t sets and |W| ≤ t,
we can choose a subset Zx ⊆ Z ′
x for every x ∈ V (K) such that they satisfy (Z1) and
x|/t − 1 ≥ 2α|V ˆξ(x)|/3t. So (Z2), (Z4) and (Z5) are also satisﬁed. Finally, since ˆξ
|Zx| ≥ |Z ′
is a homomorphism, (V ˆξ(x), V ˆξ(y)) is ε-regular with density at least α whenever xy ∈ E(K).
Fact 6.2 then implies (Z3).
Since ψ : H → K is a homomorphism by (C3), we can apply the key lemma (Lemma 6.5)
to obtain an injective homomorphism φ′ : H → G such that φ′(h) ∈ Zψ(h) for all h ∈ V (H).
Note that φ′(u) ∈ Vj(f (u)) for every u ∈ U . We deﬁne φ : H → G by taking φ(u) := vf (u)
for all u ∈ U1 and φ(h) := φ′(h) for all h ∈ V (H) \ U1. We claim that φ is an embedding
of H into G respecting Λ. The map φ is injective because of (Z1). For u ∈ U1, we have
φ(u) ∈ Λ(u) by deﬁnition. For u ∈ U2, we have φ(u) = φ′(u) ∈ Zψ(u) = Zf (u) ⊆ Λ(u) by
(Z4). Finally, let uh ∈ E(H) with u ∈ U1 and h /∈ U1. Then Zψ(h) ⊆ NG(vf (u)) by (Z5) and
φ(h) = φ′(h) ∈ Zψ(h). Hence, φ(u)φ(h) ∈ E(G), completing the proof.
(cid:3)

8.3. Attaching models. The previous lemma provides us with a tool to embed models
respecting given labellings. In general, we are interested in the minimum degree threshold
at which this is possible. Note that the condition on δ(G) in Lemma 8.4 is governed by the
degeneracy of the model (H, U ) with respect to (J, f ). Later on, we will try to ﬁnd models
with good, that is, low-degenerate, compressions.

We conclude this section by collecting some tools that will enable us to build those models

in a modular way.
Fact 8.5. Let (H, U ) be d-compressible with respect to (J, f ) and let β : J → J ′ be a
surjective homomorphism. Then (H, U ) is d-compressible with respect to (J ′, f ′), where
f ′(u) := β(f (u)) for all u ∈ U .
Proof. Since β is surjective, (J ′, f ′) is a valid root-compression of U . Let (J, f, K, ψ) be a
d-compression of (H, U ). We may assume that J ′ and K are vertex-disjoint. Let K ′ be the
graph obtained from the union of J ′ and K \ V (J) by adding an edge between x′ ∈ V (J ′)
and y ∈ V (K) \ V (J) if there exists x ∈ V (J) such that β(x) = x′ and xy ∈ E(K). Clearly,
J ′ is an induced subgraph of K ′. Moreover, the degeneracy of K ′ rooted at J ′ is at most
d since K ′ \ V (J ′) = K \ V (J) and dK ′(y, V (J ′)) ≤ dK (y, V (J)) for all y ∈ V (K) \ V (J),
so we can take the same order of the vertices. Deﬁne ψ′ : V (H) → V (K ′) as follows.
If
ψ(v) /∈ V (J), let ψ′(v) := ψ(v). If ψ(v) ∈ V (J), let ψ′(v) := β(ψ(v)). Clearly, ψ′(u) = f ′(u)
for all u ∈ U and ψ is a homomorphism.

(cid:3)

Note that whenever (H, U ) and (S, W ) are models such that V (H) ∩ V (S) = W , then

(H ∪ S, U ) is a model too.
Proposition 8.6. Let (H, U ) and (S, W ) be models such that V (H) ∩ V (S) = W . Assume
that (J, f, K, ψ) is a d-compression of (H, U ) and that (S, W ) is d-compressible with respect
to (JS , fS). Suppose that β : JS → K is a homomorphism that satisﬁes β(fS(w)) = ψ(w) for
all w ∈ W . Then there exists a d-compression (J, f, K ′, ψ′) of (H ∪ S, U ) such that K ⊆ K ′
and ψ′↾V (H) = ψ.
Proof. By Fact 8.5, we can assume that JS is a subgraph of K satisfying fS(w) = ψ(w)
for all w ∈ W , that is, β is the identity. (Indeed, deﬁne J ′ := β(JS) and f ′(w) := β(fS(w))
for all w ∈ W . Then J ′ is a subgraph of K and f ′(w) = β(fS(w)) = ψ(w), and (S, W ) is
d-compressible with respect to (J ′, f ′) by Fact 8.5.)
So let (JS , fS, KS, ψS) be a d-compression of (S, W ) and assume that V (KS) ∩ V (K) =
V (JS ). We can then take K ′ := K ∪ KS. So J is an induced subgraph of K ′ and K ′ has

24

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

degeneracy at most d rooted at V (J). Since ψS(w) = fS(w) = ψ(w) for all w ∈ W , we
can deﬁne ψ′(x) := ψ(x) for all x ∈ V (H) and ψ′(x) := ψS(x) for all x ∈ V (S) in order to
obtain a homomorphism ψ′ : H ∪ S → K ′.
(cid:3)

The fact that K ⊆ K ′ and ψ′↾V (H) = ψ in Proposition 8.6 allows us to attach several

models to a given initial model without interference.

Corollary 8.7. Let (H, U ) be a model with d-compression (J, f, K, ψ) and let (S1, W1), . . . , (St, Wt)
be models such that V (Si)∩ V (Sj) = Wi∩ Wj for all 1 ≤ i < j ≤ t. For every i ∈ [t], suppose
that

(i) V (H) ∩ V (Si) = Wi;
(ii) (Si, Wi) is d-compressible with respect to (Ji, fi);
(iii) βi : Ji → K is a homomorphism satisfying βi(fi(w)) = ψ(w) for all w ∈ Wi.

Then there exists a d-compression (J, f, K ′, ψ′) of (H ∪ S1 ∪ ··· ∪ St, U ) such that K ⊆ K ′
and ψ′↾V (H) = ψ.

9. Transformers

Given two vertex-disjoint graphs H and H ′, a graph T is called an (H, H ′)F -transformer
if both H ∪ T and H ′ ∪ T have F -decompositions and V (H)∪ V (H ′) ⊆ V (T ) is independent
in T . Transformers in this sense were introduced in [2] as building blocks for absorbers. For
two graphs H and H ′, write H   H ′ if there exists an edge-bijective homomorphism from
H to H ′. When constructing good F -absorbers, a crucial step is to have a good (H, H ′)F -
transformer whenever H   H ′. In terms of how to build absorbers out of such transformers,
the main ideas in [2] are essentially suﬃcient for our purposes. We will discuss this as brieﬂy
as possible in Section 12. However, in order to achieve our goals, we need more sophisticated
transformers. This will be our focus in this and the next section.

We call a graph F δ-transforming if the following holds:

Let 1/n ≪ 1/k′
0, ε ≪ α, 1/b ≪ 1/m, µ, 1/|F| and suppose that G is a graph on
n vertices with δ(G) ≥ (δ + µ)n which has an (α, ε, k)-partition for some k ≤ k′
0,
and suppose that H and H ′ are vertex-disjoint subgraphs of G of order at most m,
where H is gcd(F )-regular and H   H ′. Then G contains an (H, H ′)F -transformer
of order at most b.

In Section 12, we will see that F being δ-transforming implies that F is δ-absorbing (see
Lemma 12.1). We will build transformers out of so-called switchers. Let S be a graph and
U an independent set in S. Let E1, E2 be two disjoint sets of edges on U . We call S an
(E1, E2)F -switcher if both S ∪ E1 and S ∪ E2 are F -decomposable. We will mostly use
‘cycle switchers’ and ‘double-star switchers’. In the ﬁrst case, E1 and E2 are the two perfect
matchings forming an even cycle. In the second case, E1 and E2 are two stars with the same
leaves, but distinct centers.

We now brieﬂy sketch how to build transformers out of these switchers (details are given
in Lemma 9.1). For the sake of simplicity, suppose that H ′ is a vertex-disjoint copy of H
and that H is r-regular, where r := gcd(F ). For any x ∈ V (H), let x′ denote its copy in
H ′. We will build the desired (H, H ′)F -transformer by introducing r new vertices for every
x ∈ V (H) and joining them to x and x′. We can then pair up these ‘middle’ vertices with
the r neighbours of x in H. A number of C6-switchers will now allow us to translate the
transforming task between H and H ′ into a switching task between two stars with r common
leaves. For example, let xy ∈ E(H) and assume that zx,y is the middle vertex between x
and x′ associated with y. Similarly, assume that zy,x is the middle vertex between y and
y′ associated with x. Then let EH := {xy, zx,yx′, zy,xy′} and EH ′ := {x′y′, zx,yx, zy,xy}. A
C6-switcher will now allow us to either cover EH or EH ′ with edge-disjoint copies of F .
Doing this simultaneously for all edges of H, we can either cover (i) E(H) together with all
edges of the form zx,yx′ or (ii) E(H ′) together with all edges of the form zx,yx (see Figure 1).

For every x ∈ V (H), a K2,r-switcher will then enable us to cover all edges of the form zx,yx

25

x′

zx,w

zx,y

zy,x

y′

y

w

x

H

H ′

Figure 1. Sketch of a (C5, C5)F -transformer built from ﬁve C6-switchers and ﬁve K2,2-switchers.

in case of (i), or all edges of the form zx,yx′ in case of (ii).

In order to ﬁnd the desired switchers in a graph G, we will use Lemma 8.4 and therefore
have to equip switchers with compressions. Since compressions involve a fair amount of
notation, we introduce the following conventions. When mentioning the cycle Cℓ, we usually
assume that V (Cℓ) = {c1, . . . , cℓ} and E(Cℓ) = {cici+1 :
i ∈ [ℓ − 1]} ∪ {c1cℓ}. Similarly,
{p1, . . . , pℓ+1} denotes the vertex set of the path Pℓ with edge set E(Pℓ) = {p1p2, . . . , pℓpℓ+1}.
Very often, we want to switch between the two perfect matchings of an even cycle. For
the sake of readability, S is called a (u1, . . . , u2ℓ)F -switcher if S is an (E1, E2)F -switcher,
where

E1 := {u1u2, u3u4, . . . , u2ℓ−1u2ℓ} and E2 := {u2u3, . . . , u2ℓ−2u2ℓ−1, u2ℓu1}.

Let ℓ ≥ 2, d ≥ 0 and suppose that Aug ⊆ E(C2ℓ). A d-compressible (C2ℓ)F -switcher
with augmentation Aug is a model (S,{u1, . . . , u2ℓ}) satisfying the following properties (see
Figure 2):

• it is d-compressible with respect to the root-compression (C2ℓ ∪ Aug, f ), where
• f (ui) := ci for all i ∈ [2ℓ];
• S is a (u1, . . . , u2ℓ)F -switcher.

The set Aug may be viewed as unwanted, and we will omit saying ‘with augmentation ∅’.
When using switchers to build transformers, we must in fact have Aug = ∅ (see Lemma 9.1).
However, when constructing switchers in Section 10, we will ﬁrst obtain compressions where
Aug 6= ∅ and then perform reductions to achieve that Aug = ∅.
Similarly, let r ≥ 1, d ≥ 0 and suppose that Aug ⊆ E(P2). A d-compressible (K2,r)F -
switcher with augmentation Aug is a model (S,{u1, . . . , ur+2}) satisfying the following prop-
erties (see Figure 2):

• it is d-compressible with respect to the root-compression (P2 ∪ Aug, f ), where
• f (ui) := p2 for all i ∈ [r], f (ur+1) := p1 and f (ur+2) := p3;
• S is a ({ur+1ui : i ∈ [r]},{ur+2ui : i ∈ [r]})F -switcher.

Note that the existence of a (K2,r)F -switcher implies that gcd(F ) | r. Also note that though
as graphs C4 and K2,2 are isomorphic, a (C4)F -switcher and a (K2,2)F -switcher are two
diﬀerent concepts according to the above deﬁnitions.

26

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

p1

u4

u5

p3

p2

u1u2u3

a

c1

u1

u4

c4

a

c2

u2

u3

c3

Figure 2. A 3-compressible (K2,3)F -switcher with augmentation {p1p3} and a 4-
compressible (C4)F -switcher with augmentation ∅. The shaded areas indicate where the
edges of the switchers may lie.

Lemma 9.1. Let F be any graph and r := gcd(F ). Let d ≥ 2 and assume that there
exists a d-compressible (C6)F -switcher and a d-compressible (K2,r)F -switcher. Then F is
(1 − 1/d)-transforming.
r+2} and U ◦ = {u◦
Proof. Let U ⋆ = {u⋆
f ⋆ : U ⋆ → V (P2) by f ⋆(u⋆
Moreover, let f ◦ : U ◦ → V (C6) be deﬁned as f ◦(u◦
i ) := ci for all i ∈ [6].
such that (S⋆, U ⋆) is a d-compressible model with respect to (P2, f ⋆).

6} be sets. Deﬁne the function
i ) := p2 for all i ∈ [r].
: i ∈ [r]})F -switcher S⋆
: i ∈ [r]},{u⋆
6)F -switcher S◦ such that (S◦, U ◦) is a d-

By our assumption, there exists a ({u⋆
Moreover, there exists a (u◦
3, u◦

r+2) := p3 and f ⋆(u⋆

r+1) := p1, f ⋆(u⋆

1, . . . , u◦

1, . . . , u⋆

4, u◦
compressible model with respect to (C6, f ◦).

2, u◦

1, u◦

5, u◦

r+1u⋆
i

r+2u⋆
i

Let t := max{|S⋆|,|S◦|}. Let 1/n ≪ 1/k′

0, ε ≪ α, 1/b ≪ 1/m, µ, 1/|F|. So we may
assume α, 1/b ≪ 1/t since t only depends on F . Suppose that G is any graph on n vertices
with δ(G) ≥ (1 − 1/d + µ)n which has an (α, ε, k)-partition V1, . . . , Vk for some k ≤ k′
0, and
suppose that H and H ′ are vertex-disjoint subgraphs of G of order at most m, where H is
r-regular and φ is an edge-bijective homomorphism from H to H ′. For a vertex x ∈ V (H),
to enhance readability, we will sometimes write x′ for φ(x). We need to show that G contains
an (H, H ′)F -transformer of order at most b.

Step 1: Setup

Let R be the reduced graph of V1, . . . , Vk and σ : V (G) → V (R) the associated cluster
function. Consider any vertex x ∈ V (H). Note that |NG(x) ∩ NG(x′)| ≥ 2µn. Hence, there
exists an index τ (x) ∈ [k] such that

|NG(x) ∩ NG(x′) ∩ Vτ (x)| ≥ 2µ|Vτ (x)|.

Let ˆVτ (x) := NG(x)∩ NG(x′)∩ Vτ (x). Let y be a neighbour of x in H. Since xy, x′y′ ∈ E(G),
the pairs (Vσ(x), Vσ(y)) and (Vσ(x′), Vσ(y′)) must be weakly-(α, ε)-super-regular. Moreover,
Dx,y := NG(y) ∩ Vσ(x) has size at least α|Vσ(x)| and D′
x,y := NG(y′) ∩ Vσ(x′) has size at least
α|Vσ(x′)|.
Our goal in this step is to ﬁnd for every x ∈ V (H) a set Λx ⊆ V (G) with the following
properties:
(L1) Λx ⊆ ˆVτ (x);
(L2) |Λx| ≥ µ|Vτ (x)|;
(L3) for all z ∈ Λx and y ∈ NH (x), dG(z, Dx,y) ≥ α2|Vσ(x)|/2 and dG(z, D′

x,y) ≥

α2|Vσ(x′)|/2.

27

Consider x ∈ V (H). By the deﬁnition of τ (x), the pairs (Vσ(x), Vτ (x)) and (Vσ(x′), Vτ (x)) are
weakly-(α, ε)-super-regular. Since | ˆVτ (x)| ≥ 2µ|Vτ (x)|, we deduce that the pairs (Vσ(x), ˆVτ (x))
and (Vσ(x′), ˆVτ (x)) are ε/µ-regular with density at least α − ε. By Fact 6.1, we know that
there is a set Λx ⊆ ˆVτ (x) containing all but at most 2rε| ˆVτ (x)|/µ vertices of ˆVτ (x) such that
every z ∈ Λx has at least (α−ε−ε/µ)|Dx,y| neighbours in Dx,y and at least (α−ε−ε/µ)|D′
x,y|
x,y for every y ∈ NH(x). Checking that |Λx| ≥ (1 − 2rε/µ)| ˆVτ (x)| ≥ µ|Vτ (x)|
neighbours in D′
x,y) ≥ α2|Vσ(x′)|/2
and dG(z, Dx,y) ≥ (α − ε − ε/µ)|Dx,y| ≥ α2|Vσ(x)|/2 and equally dG(z, D′
for all z ∈ Λx and y ∈ NH(x) conﬁrms that Λx satisﬁes (L1)–(L3).
Step 2: Finding switchers

We ﬁrst ﬁnd the double-star switchers. This means that for every x ∈ V (H), we want to

x of G and a set Zx ⊆ V (G) such that

ﬁnd a subgraph S⋆
(S1⋆) |Zx| = r and Zx ⊆ Λx;
x ∪ E−
(S2⋆) (S⋆
{xz : z ∈ Zx} and E−
x| ≤ t;
x is an (E+

x)x∈V (H), (E+

x , E−

x )F -switcher.

x )x∈V (H) and G[V (H)∪ V (H ′)] are edge-disjoint, where E+
x := {x′z : z ∈ Zx};

x :=

Deﬁne a G′-labelling Λ of U ⋆ as follows: Λ(u⋆

r+1) := {x}, Λ(u⋆

r+2) := {x′}, Λ(u⋆

y and Zy for all y ∈ Y and now want to deﬁne S⋆
y )y∈Y , (E+

(S3⋆) |S⋆
(S4⋆) S⋆
We can ﬁnd them one by one using Lemma 8.4. Suppose that for some subset Y ⊆ V (H),
we have already found S⋆
x and Zx for
x ∈ V (H) \ Y . Let G0 be the subgraph consisting of all edges of (S⋆
y ∪ E−
y )y∈Y
and G[V (H)∪V (H ′)]. Let G′ := G−G0. Note that since ∆(G0) ≤ tm+rm+2m, V1, . . . , Vk
is an (α/2, 3ε, k)-partition for G′.
i ) := Λx for
all i ∈ [r]. It remains to check that Λ is (α/2, 3ε, k)-admissible. Clearly, Λ respects (P2, f ⋆).
Let j(p1) := σ(x), j(p2) := τ (x) and j(p3) := σ(x′). Then (D1) holds. (D2) holds because
|ΛP2(p2)| = |Λx| ≥ µ|Vτ (x)| ≥ α|Vj(p2)|/2 by (L2), where ΛP2 is as in Deﬁnition 8.2. For
(D3), note that Wp1 = Wp3 = ∅, where Wpi is as in Deﬁnition 8.2, so (D3) holds trivially in
this case. Moreover, NG(Wp2, Vj(p2)) = NG({x, x′}, Vτ (x)) = ˆVτ (x) and so dG(Wp2, Vj(p2)) ≥
µ|Vj(p2)|. (D4) holds by (L1).
Hence, by Lemma 8.4, there exists an embedding ρ of (S⋆, U ⋆) into G′ respecting Λ. Let
x := ρ(S⋆) and Zx := ρ({u⋆
S⋆
We now ﬁnd the cycle switchers. For this, we associate the vertices of Zx with the
neighbours of x in H, that is, we assume Zx = {zx,y :
y ∈ NH(x)}. For every edge
xy ∈ E(H), we want to ﬁnd a subgraph S◦
xy of G such that
(S1◦) (S◦
x ∪ E−
x )x∈V (H) and G[V (H)∪ V (H ′)] are edge-disjoint;
(S2◦) |S◦
(S3◦) S◦
Again, we ﬁnd them one by one using Lemma 8.4. Suppose that for some subset Y ⊆
xy for
x)x∈V (H),
x )x∈V (H) and G[V (H) ∪ V (H ′)] and let G′ := G − G0. Since ∆(G0) ≤ trm/2 +
3) := {zy,x},
Λ(u◦
6) := {zx,y}. Trivially, Λ respects (C6, f ◦). Deﬁne
j(c1) := σ(x), j(c2) := σ(y), j(c3) := τ (y), j(c4) := σ(y′), j(c5) := σ(x′) and j(c6) := τ (x).
Then (D1) holds. Moreover, (D2) and (D4) hold trivially since |Λ(u◦
i )| = 1 for all i ∈ [6].
We will now check that (D3) holds. Note that Wc1 = {zx,y, y} and so

E(H), we have already found S⋆
xy ∈ E(H) \ Y . Let G0 be the subgraph consisting of all edges of (S◦
(E+
tm + rm + 2m, we have that V1, . . . , Vk is an (α/2, 3ε, k)-partition for G′.

xy)xy∈V (H), (S⋆
xy| ≤ t;
xy is an (x, y, zy,x, y′, x′, zx,y)-switcher.

x ∪ E−
Deﬁne a G′-labelling Λ of U ◦ as follows: Λ(u◦
4) := {y′}, Λ(u◦

5) := {x′}, Λ(u◦

e for all e ∈ Y , and that we now want to deﬁne S⋆

1) := {x}, Λ(u◦

2) := {y}, Λ(u◦

x)x∈V (H), (E+

i

: i ∈ [r]}). Then S⋆

x and Zx satisfy (S1⋆)–(S4⋆).

e )e∈Y , (S⋆

dG(Wc1, Vj(c1)) = dG({zx,y, y}, Vσ(x)) = dG(zx,y, Dx,y) ≥ α2|Vσ(x)|/2

28

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

by (S1⋆) and (L3). The same applies to ci with i ∈ {2, 4, 5}. Note that Wc3 = {y, y′} and so

dG(Wc1, Vj(c3)) = dG({y, y′}, Vτ (y)) = | ˆVτ (y)| ≥ 2µ|Vτ (y)|

by deﬁnition of τ (y). The same applies to c6. Thus, Λ is (α2/2, 3ε, k)-admissible.

Hence, by Lemma 8.4, there exists an embedding ρ of (S◦, U ◦) into G′ respecting Λ. Let
xy := ρ(S◦). Then (S1◦)–(S3◦) are satisﬁed.
S◦
Step 3: Transforming

We can now deﬁne the desired (H, H ′)F -transformer. Observe that (S2⋆) implies that

(9.1)

(9.2)

Let

E−

E+

[x∈V (H)
[x∈V (H)
T := [xy∈E(H)

x = [xy∈E(H)
x = [xy∈E(H)
xy ∪ [x∈V (H)

S◦

{xzx,y, yzy,x},

{x′zx,y, y′zy,x}.

(S⋆

x ∪ E+

x ∪ E−
x ).

We claim that T is the desired (H, H ′)F -transformer. By construction, T has order at most
trm/2 + mt ≤ b and T [V (H) ∪ V (H ′)] is empty. Finally and most importantly,

T ∪ H

(9.2)

= [xy∈E(H)

(S◦

xy ∪ {xy, x′zx,y, y′zy,x}) ∪ [x∈V (H)

(S⋆

x ∪ E+
x )

is F -decomposable by (S3◦) and (S4⋆). Similarly,

T ∪ H ′ (9.1)

= [xy∈E(H)

(S◦

xy ∪ {x′y′, xzx,y, yzy,x}) ∪ [x∈V (H)

(S⋆

x ∪ E−
x )

is F -decomposable.

(cid:3)

10. Constructing switchers

In the previous section, we saw how the problem of ﬁnding an (H, H ′)F -transformer
for two rather arbitrary graphs H, H ′ can be reduced to the problem of constructing well-
compressible switchers. We will now describe such switchers. The following ‘discretisation
lemma’ is key to narrowing the value of δF down for Theorem 1.1(ii)–(iii).

The main idea of the lemma is as follows. Suppose that d ∈ N and δF = 1 − 1/d − µ
for some µ > 0 and we aim to construct a (d − 1)-compressible (E1, E2)F -switcher S. We
therefore have to show that both S ∪ E1 and S ∪ E2 are F -decomposable. We will achieve
this by simply using the deﬁnition of δF . More precisely, we will consider an arbitrary
large graph S such that both S ∪ E1 and S ∪ E2 are F -divisible and δ(S) ≥ (δF + µ/2)|S|.
Then, both S ∪ E1 and S ∪ E2 must be F -decomposable. Moreover, we can also ensure
that S is d-partite. The location of a vertex in one of the d classes then naturally deﬁnes a
homomorphism ψ : S → Kd, which will ensure that the switcher S is (d − 1)-compressible.
Lemma 10.1 (Discretisation lemma). Let F be any graph and let r := gcd(F ) and d ∈ N.
Suppose that δF < 1 − 1/d. Then the following assertions hold.

(i) There exists a (d − 1)-compressible (C4)F -switcher with augmentation {c1c3, c2c4}.
(ii) There exists a (d − 1)-compressible (K2,r)F -switcher with augmentation {p1p3}.

Proof. Let µ := 1 − 1/d − δF , d◦ := max{d, 4} and d⋆ := max{d, 3}. By deﬁnition of
δF , there exists n0 ∈ N such that whenever G is an F -divisible graph on n ≥ n0 vertices
with δ(G) ≥ (δF + µ/2)n, then G is F -decomposable. Let s ∈ N be such that 1/s ≪
1/n0, 1/|F|, 1/d, µ and such that s is divisible by e(F ) and gcd(F ).

29

To prove (i), let K ◦ be the complete graph on {c1, . . . , cd◦}. Clearly, K ◦ has degeneracy
at most d − 1 rooted at {c1, . . . , c4}. Let G◦ be a complete d◦-partite graph with vertex
classes V1, . . . , Vd◦ of size s each. Then, G◦ is F -divisible and |G◦| ≥ n0. For all i ∈ [4],
pick some ui ∈ Vi and deﬁne f ◦(ui) := ci. Note that χ(F ) ≤ d ≤ d◦ since trivially δF ≥
1−1/(χ(F )−1). Since s is suﬃciently large, we can easily ﬁnd edge-disjoint copies F1, . . . , F4
of F in G◦ such that u1u3 ∈ E(F1), u1u4 ∈ E(F2), u2u3 ∈ E(F3) and u2u4 ∈ E(F4), but
u1u2, u3u4 /∈ E(F1 ∪ ··· ∪ F4). Deﬁne S◦ := G◦ − {u1u2, u3u4} − (F1 ∪ ··· ∪ F4). Let
ψ◦ : S◦ → K ◦ be such that ψ◦(x) = ci if and only if x ∈ Vi. Hence, ψ◦ is a homomorphism.
Moreover, {u1, . . . , u4} is independent in S◦, so (K ◦[{c1, . . . , c4}], f ◦, K ◦, ψ◦) is a (d − 1)-
compression of (S◦,{u1, . . . , u4}). It remains to show that S◦ is a (u1, u2, u3, u4)F -switcher.
But S◦ ∪ {u1u2, u3u4} = G◦ − (F1 ∪ ··· ∪ F4) is F -divisible and thus S◦ ∪ {u2u3, u4u1} is
F -divisible as well. Finally,

δ(S◦ ∪ {u1u2, u3u4}) ≥ (d◦ − 1)s − 4|F| ≥ (1 − 1/d◦ − µ/2)sd◦ ≥ (δF + µ/2)|S◦|

and δ(S◦ ∪ {u2u3, u4u1}) = δ(S◦ ∪ {u1u2, u3u4}). So since |S◦| = |G◦| ≥ n0, both S◦ ∪
{u1u2, u3u4} and S◦ ∪ {u2u3, u4u1} are F -decomposable.
To prove (ii), let K ⋆ be the complete graph on {p1, . . . , pd⋆}. Clearly, K ⋆ has degeneracy
at most d−1 rooted at {p1, p2, p3}. Let G⋆ be a complete d⋆-partite graph with vertex classes
V1, . . . , Vd⋆ of size s each. Then, G⋆ is F -divisible and |G⋆| ≥ n0. Let ur+1 ∈ V1, u1, . . . , ur ∈
V2 and ur+2 ∈ V3. Deﬁne f ⋆(ui) := p2 for all i ∈ [r], f ⋆(ur+1) := p1, and f ⋆(ur+2) := p3. Let
E+ := {ur+1ui : i ∈ [r]} and E− := {ur+2ui : i ∈ [r]}. Let F1, . . . , Fr+1 be edge-disjoint
copies of F in G⋆ such that ur+2ui ∈ E(Fi) for all i ∈ [r +1] and E+∩E(F1∪···∪Fr+1) = ∅.
Deﬁne S⋆ := G⋆ − E+ − (F1 ∪ ··· ∪ Fr+1). Let ψ⋆ : S⋆ → K ⋆ be such that ψ⋆(x) = pi if
and only if x ∈ Vi. Hence, ψ⋆ is a homomorphism. Moreover, {u1, . . . , ur+2} is independent
in S⋆, so (K ⋆[{p1, p2, p3}], f ⋆, K ⋆, ψ⋆) is a (d − 1)-compression of (S⋆,{u1, . . . , ur+2}).
It
remains to show that S⋆ is an (E+, E−)F -switcher. But S⋆ ∪ E+ = G⋆ − (F1 ∪ ··· ∪ Fr+1)
is F -divisible and thus S⋆ ∪ E− is F -divisible as well. Finally,

δ(S⋆ ∪ E+) ≥ (d⋆ − 1)s − (r + 1)|F| ≥ (1 − 1/d⋆ − µ/2)sd⋆ ≥ (δF + µ/2)|S⋆|,

and similarly, δ(S⋆ ∪ E−) ≥ (δF + µ/2)|S⋆|. Therefore, both S⋆ ∪ E+ and S⋆ ∪ E− are
F -decomposable.

(cid:3)

Recall that in order to apply Lemma 9.1, we require a (C6)F -switcher and a (K2,gcd(F ))F -
switcher with no augmentations, whilst the above lemma outputs switchers with augment-
ations. In the following, we will carry out a sequence of reductions which will provide us
with the switchers required for Lemma 9.1. Roughly speaking, in each reduction, we assume
that we have a d-compressible switcher S′ with some augmentation(s). We then construct a
d-compressible switcher S by combining several copies of S′ in such a way that S has fewer
augmentations than S′.
In order to ensure that S is still d-compressible, we will appeal
to Corollary 8.7. Under rather natural assumptions, it allows us to attach d-compressible
models to an existing model without increasing degeneracy.

Lemma 10.2. Let F be any graph, d ≥ 3 and r ∈ N. Assume that there exists a
d-compressible (K2,r)F -switcher with augmentation {p1p3}. Then there also exists a d-
compressible (K2,r)F -switcher (with augmentation ∅).

We prove the lemma as follows. First we add a new vertex a connected to p1, p2 and
p3. We then obtain the desired switcher by combining two switchers with the underlying
augmented paths p1p2a and ap2p3.
Proof. Let U = {u1, . . . , ur+2} and let S′ be the graph on U ∪ {w} with edge set Ew :=
{wui
i ∈ [r]}. Deﬁne f : U → V (P2) as f (ui) := p2 for all i ∈ [r], f (ur+1) := p1 and
f (ur+2) := p3. Moreover, deﬁne ψ such that ψ↾U = f and ψ(w) := a, where a is a new
vertex. Let K be the graph with V (K) = V (P2) ∪ {a} and E(K) = E(P2)∪ {ap1, ap2, ap3}.

:

30

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

:

Clearly, (P2, f, K, ψ) is a 3-compression of (S′, U ). Set E+ := {ur+1ui
i ∈ [r]} and
E− := {ur+2ui : i ∈ [r]}.
Deﬁne f + : (U \ {ur+2}) ∪ {w} → V (P2) as f +(ui) := p2 for all i ∈ [r], f +(ur+1) := p1
and f +(w) := p3. Since there exists a d-compressible (K2,r)F -switcher with augmentation
{p1p3}, there exists an (E+, Ew)F -switcher S+ such that (S+, (U \ {ur+2}) ∪ {w}) is d-
compressible with respect to (P2 ∪ {p1p3}, f +).
Similarly, there exists an (E−, Ew)F -switcher S− such that (S−, (U \{ur+1})∪{w}) is d-
compressible with respect to (P2∪{p1p3}, f −), where f −(ui) := p2 for all i ∈ [r], f −(ur+2) :=
p1 and f −(w) := p3. We can also assume that V (S+) ∩ V (S′) = (U \ {ur+2}) ∪ {w},
V (S−) ∩ V (S′) = (U \ {ur+1}) ∪ {w} and V (S+) ∩ V (S−) = {w, u1, . . . , ur}.
Now deﬁne β+ : P2 ∪ {p1p3} → K as β+(p1) := p1, β+(p2) := p2 and β+(p3) := a.
Analogously, β− : P2∪{p1p3} → K is deﬁned as β−(p1) := p3, β−(p2) := p2 and β−(p3) := a.
Then, β+(f +(v)) = ψ(v) for all v ∈ (U \ {ur+2}) ∪ {w} and β−(f −(v)) = ψ(v) for all
v ∈ (U \ {ur+1}) ∪ {w}. Let S := S′ ∪ S+ ∪ S−. Hence, by Corollary 8.7, (S, U ) is d-
compressible with respect to (P2, f ). Finally, since S ∪ E+ = (S− ∪ Ew) ∪ (S+ ∪ E+) and
S ∪ E− = (S+ ∪ Ew) ∪ (S− ∪ E−), (S, U ) is an (E+, E−)F -switcher.

(cid:3)

Since the deﬁnitions of the homomorphisms β and functions f are usually natural and
clear from the context, we will often omit the corresponding details in future applications
of Corollary 8.7. We can now combine several (C4)F -switchers into a (C6)F -switcher.
Lemma 10.3. Let F be any graph and d ≥ 3. Assume that there exists a d-compressible
(C4)F -switcher. Then there also exists a d-compressible (C6)F -switcher.
Proof. Let U = {u1, . . . , u6} and let S′ be the graph on U ∪ {w1, w2} with edge set
{u1w1, u5w1, u2w2, u4w2, w1w2}. Deﬁne f : U → V (C6) by f (ui) := ci for i ∈ [6]. Moreover,
let ψ be deﬁned such that ψ↾U = f , ψ(w1) := a1, and ψ(w2) := a2, where a1, a2 are new verti-
ces. Let K be the graph on V (C6)∪{a1, a2} with edge set E(C6)∪{c1a1, c5a1, c2a2, c4a2, a1a2}.
Observe that (C6, f, K, ψ) is a 3-compression of (S′, U ).

By Corollary 8.7 and our assumption, we can attach graphs S1, . . . , S4 to S′ such that

• S1 is a (u1, w1, u5, u6)F -switcher;
• S2 is a (w2, u2, u3, u4)F -switcher;
• S3 is a (u1, u2, w2, w1)F -switcher;
• S4 is a (w2, u4, u5, w1)F -switcher;
• (S′ ∪ S1 ∪ ··· ∪ S4, U ) is d-compressible with respect to (C6, f ).

Let S := S′ ∪ S1 ∪ ··· ∪ S4.
It is easy to check that S is a (u1, . . . , u6)F -switcher. For
example, S∪{u1u2, u3u4, u5u6} can be decomposed into S1∪{u1w1, u5u6}, S2∪{u2w2, u3u4},
S3 ∪ {u1u2, w1w2} and S4 ∪ {u4w2, u5w1}, which are all F -decomposable.
(cid:3)

Lemma 10.4. Let F be any graph and d ≥ 4. Assume that there exists a d-compressible
(C4)F -switcher with augmentation {c1c3, c2c4}. Then there also exists a d-compressible
(C4)F -switcher (with augmentation ∅).
Proof. Let U = {u1, . . . , u4} and deﬁne f : U → V (C4) as f (ui) := ci for i ∈ [4]. Let
w be a new vertex and let ˆS be the graph on U ∪ {w} with edge set {u1w, wu3}. Deﬁne
ψ(ui) := f (ui) for i ∈ [4] and ψ(w) := a, where a is a new vertex.
We will ﬁrst show that there exists a d-compressible (C4)F -switcher with augmentation
{c1c3}. To this end, let K be the graph on V (C4)∪{a} with edge set E(C4)∪{c1c3}∪{cia :
i ∈ [4]}. Note that (C4 ∪ {c1c3}, f, K, ψ) is a 4-compression of ( ˆS, U ). By Corollary 8.7 and
our assumption, we can attach graphs S1, S2 to ˆS such that

• S1 is a (u1, u2, u3, w)F -switcher;
• S2 is a (u1, w, u3, u4)F -switcher;
• (S, U ) is d-compressible with respect to (C4 ∪ {c1c3}, f ), where S := ˆS ∪ S1 ∪ S2.

Clearly, S is a (u1, u2, u3, u4)F -switcher.

31

We now conclude that there exists a d-compressible (C4)F -switcher without augmentation.
Let K ′ be the graph on V (C4) ∪ {a} with edge set E(C4) ∪ {cia :
i ∈ [4]}. Note that
(C4, f, K ′, ψ) is a 4-compression of ( ˆS, U ). By the above and Corollary 8.7, we can attach
S′
1, S′

2 to ˆS such that
• S′
• S′
• (S′, U ) is d-compressible with respect to (C4, f ), where S′ := ˆS ∪ S′

1 is a (u1, u2, u3, w)F -switcher;
2 is a (u1, w, u3, u4)F -switcher;

1 ∪ S′
2.

Then, S′ is a (u1, u2, u3, u4)F -switcher.

(cid:3)

We will now gather the remaining building blocks to show that every graph F is (1 −
1/(χ(F ) + 1))-absorbing. Recall from Lemmas 9.1 and 10.3 that in order to do this we
have to construct a (χ(F ) + 1)-compressible (C4)F -switcher and a (χ(F ) + 1)-compressible
(K2,gcd(F ))F -switcher. In fact, we will only describe a (C4)F -switcher and then derive the
(K2,gcd(F ))F -switcher via a further reduction.

Lemma 10.5. Let F be any graph and χ := χ(F ). There exists a (χ + 1)-compressible
(C4)F -switcher.
Proof. Let ℓ := |F| − 1 and suppose that V (F ) = {f0, . . . , fℓ} and f0fℓ ∈ E(F ). Let F ′ :=
F − fℓ. Let z0,0, . . . , zℓ−1,ℓ−1 be ℓ2 new vertices. We deﬁne copies of F ′ on them as follows:
For every i ∈ {0, . . . , ℓ − 1}, let F +
i be a copy of F ′ on {zi,0, . . . , zi,ℓ−1} such that zi,j plays
the role of fi⊕j for all j ∈ {0, . . . , ℓ−1}, where i⊕j denotes addition modulo ℓ. Similarly, for
every j ∈ {0, . . . , ℓ − 1}, let F −
j be a copy of F ′ on {z0,j, . . . , zℓ−1,j} such that zi,j plays the
role of fi⊕j for all i ∈ {0, . . . , ℓ − 1}. Note that the graphs F +
ℓ−1 are
all edge-disjoint. Let S′ be the graph obtained from the union of all these graphs by adding
two new vertices u1, u3 and joining both of them to every zi,j with fi⊕j ∈ NF (fℓ). We claim
that S′ has two natural F -decompositions F1,F2. To see this, for k ∈ {1, 3}, deﬁne

0 , . . . , F +

0 , . . . , F −

ℓ−1, F −

E+
i (uk) := {ukzi,j : fi⊕j ∈ NF (fℓ), j ∈ {0, . . . , ℓ − 1}}

for all i ∈ {0, . . . , ℓ − 1} and

E−
j (uk) := {ukzi,j : fi⊕j ∈ NF (fℓ), i ∈ {0, . . . , ℓ − 1}}

for all j ∈ {0, . . . , ℓ − 1}. Note that, for each k ∈ {1, 3}, Sℓ−1

consists of all edges at uk in S′. Thus,

i=0 E+

j=0 E−

j (uk)

i (uk) = Sℓ−1
i ∪ E−
i ∪ E−

i (u1)).

ℓ−1

[i=0

(F +

i ∪ E+
i ∪ E+

i (u3)) ∪ (F −
i (uk) and F −

S′ =

(F +

i ∪ E+

i (u1)) ∪ (F −

i ∪ E−

i (u3)) =

ℓ−1

[i=0

a copy of F , this shows that S′ has two (natural) F -decompositions.

Since for all k ∈ {1, 3} and i ∈ {0, . . . , ℓ − 1}, both F +
In order to obtain the desired switcher, we make some minor modiﬁcations to S′. Note
that the vertex z0,0 is contained in the copies F +
0 , and u1z0,0, u3z0,0 ∈ E(S′)
because f0fℓ ∈ E(F ). Let S be the graph obtained from S′ − z0,0 as follows: Add new
(z0,0).
vertices u2, u4 and add all edges from u2 to NF +
We claim that S is a (u1, u2, u3, u4)F -switcher. Clearly, {u1, . . . , u4} is independent in S.
Let ˜F +

(z0,0) and all edges from u4 to NF −

0 and F −

i (uk) form

0 := S[{u2, z0,1, . . . , z0,ℓ−1}] and ˜F −

0 := S[{u4, z1,0, . . . , zℓ−1,0}]. Further, let

0

0

˜E+
˜E−
˜E+
˜E−

0 (u1) := E+
0 (u1) := E−
0 (u3) := E+
0 (u3) := E−

0 (u1) \ {u1z0,0};
0 (u1) \ {u1z0,0};
0 (u3) \ {u3z0,0};
0 (u3) \ {u3z0,0}.

32

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

0 (u3) ∪ {u3u4}, ˜F +

0 ∪ ˜E+

0 (u3) ∪ {u2u3} and ˜F −
0 ∪

S = ( ˜F +

0 ∪ ˜E+

0 ∪ ˜E−

0 (u1) ∪ {u1u2}, ˜F −

Crucially, ˜F +
˜E−
0 (u1) ∪ {u1u4} are all copies of F . Moreover,
[i=1
[i=1

0 (u3)) ∪ ( ˜F −

0 (u1)) ∪ ( ˜F −

0 (u1)) ∪

0 (u3)) ∪

0 ∪ ˜E−

0 ∪ ˜E−

0 ∪ ˜E+

0 ∪ ˜E+

= ( ˜F +

ℓ−1

ℓ−1

[(F +

i ∪ E+

i (u1)) ∪ (F −

i ∪ E−

i (u3))]

[(F +

i ∪ E+

i (u3)) ∪ (F −

i ∪ E−

i (u1))].

With the above, it follows immediately that S is a (u1, u2, u3, u4)F -switcher.

Let g : {u1, . . . , u4} → V (C4) deﬁned by g(ui) := ci for i ∈ [4]. It remains to show that
the model (S,{u1, . . . , u4}) with root-compression (C4, g) is (χ + 1)-compressible. Let K
be the graph obtained from C4 by adding a complete graph on new vertices c5, . . . , cχ+2
and all edges between {c1, . . . , c4} and {c5, . . . , cχ+2}. This way, C4 is an induced subgraph
of K and K has degeneracy at most χ + 1 rooted at V (C4). Let c be a colouring of F
with colour set {c1, c2} ∪ {c5 . . . , cχ+2} such that c(fℓ) = c1 and c(f0) = c2. We deﬁne
ψ : V (S) → V (K) as follows: Take ψ(ui) := ci for all i ∈ [4]. For every vertex zi,j ∈ V (S),
It is easy to see that ψ is a homomorphism. For example, if
we let ψ(zi,j) := c(fi⊕j).
zi,jzi′,j′ ∈ E(S), then we must either have i = i′ and zi,jzi′,j′ ∈ E(F +
i ) or j = j′ and
zi,jzi′,j′ ∈ E(F −
j ). In both cases, fi⊕jfi′⊕j′ ∈ E(F ), implying c(fi⊕j) 6= c(fi′⊕j′). Hence,
ψ(zi,j) 6= ψ(zi′,j′) and thus ψ(zi,j)ψ(zi′,j′) ∈ E(K). If u1zi,j ∈ E(S), then fi⊕j ∈ NF (fℓ)
and so ψ(u1) = c1 = c(fℓ) 6= c(fi⊕j) = ψ(zi,j). If u2zi,j ∈ E(S), then i = 0 and fj ∈ NF (f0)
and so ψ(u2) = c2 = c(f0) 6= c(fi⊕j) = ψ(zi,j ). Together with a similar argument for u3 and
u4, this completes the proof.
(cid:3)

Using the (C4)F -switcher constructed above, we are able to construct a (K2,dF (v))F -
switcher for every v ∈ V (F ) (see Lemma 10.7). The following lemma implies that this
suﬃces to obtain the desired (K2,r)F -switcher.
Lemma 10.6. Let F be any graph, d ≥ 0 and r ∈ N such that gcd(F ) | r. Suppose that for
all v ∈ V (F ), there exists a d-compressible (K2,dF (v))F -switcher. Then there also exists a
d-compressible (K2,r)F -switcher.

Proof. Let V1 and V2 be multisubsets of V (F ) such that r + n1 = n2, where n1 :=

dF (v).

Let E+ := {ur+1ui

dF (v) and n2 :=Pv∈V2

Pv∈V1
Let U = {u1, . . . , ur+2} and let W be a set of n1 new vertices. Deﬁne f (ui) := p2 for
all i ∈ [r], f (ur+1) := p1 and f (ur+2) := p3. Let S′ be the graph on U ∪ W with edge set
{ur+1w, ur+2w : w ∈ W}. Deﬁne ψ such that ψ↾U = f and ψ(w) := p2 for all w ∈ W . So
(P2, f, P2, ψ) is a 0-compression of (S′, U ).
In order to obtain an
(E+, E−)F -switcher, we partition W into subsets (Uv)v∈V1 and partition W ∪ {u1, . . . , ur}
into subsets (Uv)v∈V2 such that |Uv| = dF (v) for all v ∈ V1 ∪ V2.
By Corollary 8.7 and our assumption, we can attach graphs (Sv)v∈V1∪V2 to S′ such that
Sv is a ({ur+1z : z ∈ Uv},{ur+2z : z ∈ Uv})F -switcher and (S, U ) is d-compressible with
respect to (P2, f ), where S := S′ ∪Sv∈V1∪V2

i ∈ [r]} and E− := {ur+2ui

Sv. Finally, observe that

i ∈ [r]}.

:

:

S ∪ E+ = [v∈V2

(Sv ∪ {ur+1z : z ∈ Uv}) ∪ [v∈V1

(Sv ∪ {ur+2z : z ∈ Uv})

is F -decomposable, and by symmetry, S ∪ E− is also F -decomposable.

(cid:3)

Lemma 10.7. Let F be a graph, let r := gcd(F ) and χ := χ(F ). There exists a (χ + 1)-
compressible (K2,r)F -switcher.

33

Proof. By the previous lemma, we can assume that r = dF (v) for some v ∈ V (F ). So let
w1, . . . , wr be an enumeration of NF (v). Moreover, ﬁx a colouring c of F with colour set [χ]
and c(v) = 1.

Let U = {u1, . . . , ur+2} be a set of new vertices and let S′ be the graph on U∪V (F−v) with
E(S′) := D+∪D−∪E(F−v), where D+ := {ur+1wi : i ∈ [r]} and D− := {ur+2wi : i ∈ [r]}.
Deﬁne f : U → V (P2) as f (ui) := p2 for all i ∈ [r], f (ur+1) := p1 and f (ur+2) := p3. Deﬁne
ψ such that ψ↾U = f and ψ(x) := ac(x) for all x ∈ V (F − v), where a1, . . . , aχ are new
vertices.
Let K be the graph obtained from P2 by adding a clique on a1, . . . , aχ and all edges
between {p1, p3} and {a2, . . . , aχ}. So P2 is an induced subgraph of K and K has degeneracy
at most χ rooted at V (P2). Thus, (P2, f, K, ψ) is a χ-compression of (S′, U ).
For every i ∈ [r], we have that ψ(ur+1) = p1, ψ(wi) = ac(wi), ψ(ur+2) = p3 and ψ(ui) = p2.
By Lemma 10.5, there exists a (χ+1)-compressible (C4)F -switcher. Hence, by Corollary 8.7,
we can attach graphs S1, . . . , Sr to S′ such that

• Si is a (ur+1, wi, ur+2, ui)F -switcher;
• (S, U ) is (χ + 1)-compressible with respect to (P2, f ), where S := S′ ∪ S1 ∪ ··· ∪ Sr.
We claim that S is an (E+, E−)F -switcher, where E+ := {ur+1ui
i ∈ [r]} and E− :=
{ur+2ui : i ∈ [r]}. To this end, observe that S1∪···∪Sr is an (E+∪D−, E−∪D+)F -switcher.
Hence,

:

and

S ∪ E+ = ((F − v) ∪ D+) ∪ (S1 ∪ ··· ∪ Sr ∪ E+ ∪ D−)
S ∪ E− = ((F − v) ∪ D−) ∪ (S1 ∪ ··· ∪ Sr ∪ E− ∪ D+)

are both F -decomposable.

(cid:3)

11. Divisibility and threshold relations

F , δ0+

F , δ∗

F , δvx

In this section, we make some observations regarding the relationship between the ‘aux-
iliary thresholds’ δe
F and δF . For this (and for later use when constructing
extremal examples), we ﬁrst gather some tools that allow us to remove a sparse subgraph
of a given graph G in order to make G divisible.
Lemma 11.1. Let 1/n ≪ µ, 1/r. Let G be a graph on n vertices with δ(G) ≥ (1/2+µ)n and
let ξ : V (G) → {0, . . . , r − 1} be any function satisfying r |Px∈V (G) ξ(x). Then, there exists
a subgraph H of G such that ∆(H) ≤ µn and dG−H(x) ≡ ξ(x) mod r for all x ∈ V (G).
Proof. We will ﬁnd H as a union of many small subgraphs which shift excess degree
from one vertex to the next one. Let wv ∈ E(Kr,r) and let u be a new vertex. Let
Q := (Kr,r − {wv}) ∪ {uw}. Let Q′ be the graph obtained from Kr,r by subdividing one
edge with a new vertex z. Note that dQ(u) = 1, dQ(v) ≡ −1 mod r, dQ′(z) = 2, while all
other vertices of Q and Q′ have degree r.
Claim 1: (Q,{u, v}) is 1/2-embeddable.

It is suﬃcient to show that if x, x′ ∈ V (G) are distinct, then G contains a copy of Q with
x, x′ playing the roles of u, v. So suppose that x and x′ are distinct vertices in G. Let y be
a neighbour of x in G. Let Y be a subset of NG(y) of size µn/2 disjoint from {x, x′}. For
every y′ ∈ Y , y′ has at least µn neighbours in X := NG(x′)\ (Y ∪{x, y}). Let H := G[X, Y ].
Then, e(H) ≥ |Y |µn ≥ µ2|H|2/2. Hence, Kr−1,r−1 must be a subgraph of H. Together
with x, x′, y, this yields the desired copy of Q.
Claim 2: (Q′,{z}) is 1/2-embeddable.

Let x be any vertex in G. It is easy to see that δ(G[NG(x)]) ≥ 2µn. Thus, Kr,r must be
a subgraph of G[NG(x)], which together with x contains a copy of Q′ with x playing the
role of z.

34

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Now, let x1, . . . , xn be an enumeration of V (G), and for each i ∈ [n−1], let ai ∈ {0, . . . , r−
1} be such that ai ≡ Pj∈[i](dG(xj) − ξ(xj)) mod r. Let an ∈ {0, . . . , r − 1} be such that
an ≡ e(G) mod r. Moreover, set a0 := 0.
For every i ∈ [n − 1], we want to ﬁnd ai edge-disjoint copies of Q in G′ such that xi, xi+1
play the roles of u, v. To this end, for every i ∈ [n − 1] and j ∈ [ai], let Λi,j : {u, v} → V (G)
be a G-labelling deﬁned as Λi,j(u) := {xi} and Λi,j(v) := {xi+1}. Note that there are at
most rn labellings and every vertex of G is the image of a root at most 2r times. We can
thus apply Lemma 8.1 to ﬁnd edge-disjoint embeddings (φi,j)i∈[n−1],j∈[ai] of Q such that φi,j

respects Λi,j and ∆(H ′) ≤ µn/2, where H ′ :=Si∈[n−1],j∈[ai] φi,j(Q).
Note that δ(G − H ′) ≥ (1/2 + µ/2)n. Thus, we can greedily ﬁnd an edge-disjoint copies
of Q′ in G− H ′ with xn playing the role of z. Then, let H be the union of H ′ and the copies
of Q′. Clearly, ∆(H) ≤ µn.
Moreover, we have dH (xi) ≡ ai − ai−1 ≡ dG(xi) − ξ(xi) mod r for every i ∈ [n − 1].
Finally,
dH (xn) ≡ 2an − an−1 ≡ 2e(G) − Xj∈[n−1]

(dG(xj) − ξ(xj)) ≡ dG(xn) − ξ(xn) mod r.

Hence, we have dG−H (x) ≡ ξ(x) mod r for all x ∈ V (G).

(cid:3)

Roughly speaking, the above lemma allows us to make a graph F -degree-divisible. The
following proposition allows us to make a graph F -edge-divisible, without destroying degree-
divisibility. We will also use it in Section 13 to construct extremal examples.
Proposition 11.2. Let F be a graph and r := gcd(F ). Let n ∈ N and suppose that G is a
graph on n vertices with δ(G) ≥ n/2+2e(F )(r+1). Then, for any number e with r | 2e, there
exists an r-divisible subgraph H of G such that e(H) ≡ e mod e(F ) and ∆(H) ≤ 2e(F )r.
Proof. Let V ′ ⊆ V (G) be such that gcd{|V ′|, e(F )} = 1 and |V \ V ′| < e(F ). Let
G′ := G[V ′]. Clearly, r | 2e(F ). Let a := r if r is odd and a := r/2 if r is even. So a | e and
a | e(F ). Let 0 ≤ t < e(F )/a be an integer such that e ≡ ta mod e(F ). Let α, β ∈ Z be
such that αe(F ) + β|V ′| = t. We can assume that 0 ≤ β < e(F ).
Observe that δ(G′) ≥ |G′|/2 + 2(βa − 1). Hence, by Dirac’s theorem, we can take H to
be the union of βa edge-disjoint Hamilton cycles in G′. We then have e(H) = |V ′|βa =
a(t − αe(F )) ≡ e mod e(F ). Moreover, H is r-divisible and ∆(H) ≤ 2e(F )r.

(cid:3)

In order to show that δ0+

F ≤ δ∗

F , we use the following result.

F , δe

F ≤ δF .

Firstly, we show δvx

Theorem 11.3 (Haxell and R¨odl [10]). Let F be a graph and η > 0. There exists n0 ∈ N
such that whenever G is a graph on n ≥ n0 vertices that has a fractional F -decomposition,
then all but at most ηn2 edges of G can be covered with edge-disjoint copies of F .
Corollary 11.4. Let F be any graph with χ(F ) ≥ 3. Then max{δ0+
F} ≤ δ∗
δvx
F ≤ δF .
Proof. Let r := gcd(F ). Clearly, 1/2 ≤ δ∗
F ≤ δF . Let 1/n ≪ µ, 1/|F| and let G be a graph on n vertices
with δ(G) ≥ (δF + µ)n. Suppose that x∗ ∈ V (G) with r | dG(x∗). Let G′ := G − x∗
and deﬁne ξ(x) := r − 1 for all x ∈ NG(x∗) and ξ(x) := 0 for all x ∈ V (G′) \ NG(x∗).
Apply Lemma 11.1 to obtain a subgraph H of G′ such that dG′−H(x) ≡ ξ(x) mod r for all
x ∈ V (G′) and ∆(H) ≤ µn/2. Let G′′ := G − H. Hence, G′′ is r-divisible and δ(G′′) ≥
(δF + µ/2)n. Apply Proposition 11.2 to G′′ − x∗ with e(G′′) playing the role of e in order
to obtain an r-divisible subgraph H ′ of G′′ − x∗ such that e(H ′) ≡ e(G′′) mod e(F ) and
∆(H ′) ≤ 2e(F )r. Let G′′′ := G′′− H ′. Observe that G′′′ is F -divisible, δ(G′′′) ≥ (δF + µ/4)n
and NG′′′(x∗) = NG(x∗). Now, G′′′ has an F -decomposition. In particular, all edges at x
are covered.

F ≤ δF and

35

F ≤ δ∗

We continue by showing δe

F . Let 1/n ≪ µ, 1/|F| and let G be a graph on n vertices
with δ(G) ≥ (δ∗
F +µ)n. Suppose that e′ = x′y′ ∈ E(G). We need to show that e′ is contained
in a copy of F . Using Lemma 11.1 and Proposition 11.2 in the same way as above, it is easy
to ﬁnd a spanning subgraph G′′′ of G such that G′′′ is F -divisible, δ(G′′′) ≥ (δ∗
F + µ/4)n
and e′ ∈ E(G′′′). Now, G′′′ has a fractional F -decomposition, which is only possible if every
edge of G′′′ is contained in a copy of F . In particular, e′ is contained in a copy of F .
F for all η > 0, implying that δ0+
F ≤ δ∗
F . Let η > 0. Let
1/n ≪ µ, 1/|F| and let G be a graph on n vertices with δ(G) ≥ (δ∗
F + µ)n. We may assume
that µ ≪ η. Using Lemma 11.1 and Proposition 11.2, it is easy to ﬁnd a subgraph H of G
such that G′ := G − H is F -divisible, δ(G′) ≥ (δ∗
F + µ/4)n and e(H) ≤ µn2. So G′ has a
fractional F -decomposition. Thus, by Theorem 11.3, all but at most µn2 edges of G′ can be
covered by edge-disjoint copies of F , giving an η-approximate F -decomposition of G.
(cid:3)

Lastly, we show that δη

F ≤ δ∗

The aim of this section is to prove the following lemma. Having done this, we can then

12. Absorbers

bound δF in terms of δ0+, δvx
Lemma 12.1. Let F be any graph and let δ ≥ 1/2.
δ-absorbing.

F and χ(F ) (see Theorem 12.4).

If F is δ-transforming, then F is

Roughly speaking, we obtain the desired absorber by concatenating several suitable trans-
In particular, as intermediate steps, we ‘transform’ a given graph into certain

formers.
special graphs which we now deﬁne.

For a graph F , e ∈ E(F ) and h ∈ N, let L(h; F, e) be the graph obtained from h vertex-
disjoint copies of F by subdividing all copies of e with one new vertex and identifying the
new vertices. Note that χ(L(h; F, e)) ≤ max{χ(F ), 3}.
graph obtained from H by adding d+
ˆH
the copies of v with x.

For a graph F , v ∈ V (F ), a graph H and an orientation ˆH of H, let H att( ˆH ;F,v) be the
(x) copies of F for every x ∈ V (H) and identifying
(Recall that we write H   H ′ if there is an

We need the following result from [2].

edge-bijective homomorphism from H to H ′.)
Lemma 12.2 (see [2, Lemma 8.7]). Let F be a graph, uv ∈ E(F ) and r := gcd(F ). Then
for every F -degree-divisible graph H and any orientation ˆH of H, there exists an r-regular
graph H0 such that |H0| ≤ 4e(H)e(F ), H0   H att( ˆH ;F,v) and H0   L(e(H); F, uv).

The statement here is slightly more general than that in [2], as we do not require F to

be r-regular here, but the same proof goes through.

Let F be a graph, χ := χ(F ), r := gcd(F ), δ ≥ 1/2 and
Proof of Lemma 12.1.
assume that F is δ-transforming. Note that this implies that δ ≥ 1 − 1/(χ − 1). Let
1/n ≪ 1/k′
0, ε ≪ α, 1/b ≪ 1/m, µ, 1/|F| and suppose that G is a graph on n vertices with
δ(G) ≥ (δ + µ)n which has an (α, ε, k)-partition V1, . . . , Vk for some k ≤ k′
0, and H is any F -
divisible subgraph of G of order at most m. We need to show that G contains an F -absorber
for H of order at most b. Let ˆH be any orientation of H. Moreover, ﬁx uv ∈ E(F ).
ei = #     ‰xiyi. We want to ﬁnd copies F1, . . . , Ft of F in G such that

We ﬁrst extend H to H att( ˆH ;F,v) in G. Let e1, . . . , et be an enumeration of E( ˆH) and

(i) V (Fi) ∩ V (H) = {xi} for all i ∈ [t], where xi plays the role of v in Fi;
(ii) V (Fi − xi) ∩ V (Fj − xj) = ∅ for all 1 ≤ i < j ≤ t.

Suppose that for some s ∈ [t], we have already found F1, . . . , Fs−1. Let X := V (H)∪V (F1)∪
1 ∪ ··· ∪ V ′
··· ∪ V (Fs−1). For every i ∈ [k], let V ′
k].
1, . . . , V ′
Since |X| ≤ m + m2|F|, we have |Vi \ V ′
k is
an (α/2, 3ε, k)-partition of G′. We now view (F,{v}) as a model. Let J be a graph of

:= Vi \ (X \ {xs}), and let G′ := G[V ′
i | ≤ ε2|Vi| for all i ∈ [k], and thus V ′

i

36

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

order one, say, with vertex j1, and let f map v to j1. Label v with {xs} and observe that
this is an (α/2, 3ε, k)-admissible G′-labelling. Since (F,{v}) is (χ − 1)-compressible and
δ(G′) ≥ (1− 1/(χ − 1) + µ/2)|G′|, Lemma 8.4 implies that there exists a copy Fs of F in G′
with xs playing the role of v. Then (i) and (ii) hold with t replaced by s.
Let Hatt := H ∪Sj∈[t] Fj. So Hatt is isomorphic to H att( ˆH ;F,v). Let L := L(e(H); F, uv).

Let pF be the vertex-disjoint union of p copies of F , where p := e(H)/e(F ), and let pFatt :=
(pF )att(p ˆF ;F,v), where p ˆF is some orientation of pF . By Lemma 12.2, there exist r-regular
graphs H0 and pF0 of order at most 2m2e(F ) such that H0   Hatt, H0   L, pF0   pFatt
and pF0   L. Recall that χ(L) ≤ max{χ, 3}. Since H0   L, we have χ(H0) ≤ χ(L).
Similarly, χ(pF0) ≤ χ(pFatt) = χ. Since δ ≥ 1/2, we have that δ ≥ 1 − 1/(χ(H ∗) − 1) for
all H ∗ ∈ {H0, L, pFatt, pF0}. Therefore, we can ﬁnd copies of these graphs in G, and we
may assume that these copies, which we call again H0, L, pFatt, pF0, are vertex-disjoint and
vertex-disjoint from Hatt.

Since F is δ-transforming, G contains subgraphs T1, . . . , T4 of order at most b/4 such
that T1 is an (H0, Hatt)F -transformer, T2 is an (H0, L)F -transformer, T3 is a (pF0, pFatt)F -
transformer and T4 is a (pF0, L)F -transformer, and we may assume that T1, . . . , T4 are
vertex-disjoint and vertex-disjoint from Hatt, H0, L, pFatt, pF0 except for the obviously ne-
cessary intersections required by the deﬁnition of transformers, that is, e.g., V (T1)∩V (T2) =
V (H0) and V (T4)∩ V (L) = V (L). In particular, Hatt − H, H0, L, pFatt, pF0, T1, . . . , T4 are
edge-disjoint and contain no edge of G[V (H)]. Let

A := (Hatt − H) ∪ T1 ∪ H0 ∪ T2 ∪ L ∪ T4 ∪ pF0 ∪ T3 ∪ pFatt.

We claim that A is an F -absorber for H. Indeed, A has an F -decomposition since each of
Hatt − H, T1 ∪ H0, T2 ∪ L, T4 ∪ pF0, T3 ∪ pFatt have F -decompositions. Secondly, A∪ H has
an F -decomposition as Hatt∪ T1, H0∪ T2, L∪ T4, pF0∪ T3 and pFatt are all F -decomposable.
Moreover, |A| ≤ b since V (A) ⊆ V (T1 ∪ ··· ∪ T4).
(cid:3)

Corollary 12.3. Let F be any graph and χ := χ(F ). Then the following are true:

(i) F is (1 − 1/(χ + 1))-absorbing;
(ii) if δF < 1 − 1/(χ + 1) and χ ≥ 4, then F is (1 − 1/χ)-absorbing;
(iii) if δF < 1 − 1/χ and χ ≥ 5, then F is (1 − 1/(χ − 1))-absorbing.

Proof. Let r := gcd(F ). (i) By Lemma 12.1, it is enough to show that F is (1− 1/(χ + 1))-
transforming. By Lemmas 10.3 and 10.5, there exists a (χ + 1)-compressible (C6)F -switcher.
By Lemma 10.7, there exists a (χ + 1)-compressible (K2,r)F -switcher. Therefore, Lemma 9.1
implies that F is (1 − 1/(χ + 1))-transforming.
(ii) By Lemma 10.1, there exist a χ-compressible (C4)F -switcher with augmentation
{c1c3, c2c4} and a χ-compressible (K2,r)F -switcher with augmentation {p1p3}. Since χ ≥ 4,
Lemmas 10.2, 10.3 and 10.4 imply that there exist a χ-compressible (C6)F -switcher and
a χ-compressible (K2,r)F -switcher without augmentations. Therefore, Lemma 9.1 implies
that F is (1− 1/χ)-transforming. Lemma 12.1 ﬁnally implies that F is (1− 1/χ)-absorbing.
(cid:3)

(iii) follows in the same way since χ − 1 ≥ 4.
We are now able to deduce the following theorem, which is already close to Theorem 1.1.

Theorem 12.4. Let F be a graph with χ := χ(F ).

(i) Then δF ≤ max{δ0+
(ii) If χ ≥ 5, then δF ∈ {max{δ0+

F , δvx

F }, 1 − 1/χ, 1 − 1/(χ + 1)}.
Proof. Firstly, (i) follows from Theorem 7.1 and Corollary 12.3(i).

F , 1 − 1/(χ + 1)}.

F , δvx

To prove (ii), suppose that χ ≥ 5. By Corollary 11.4, δF ≥ max{δ0+
F ≥ 1 − 1/(χ − 1), Theorem 7.1 and Corollary 12.3 imply that δF ∈ {max{δ0+
δ0+
1/χ, 1 − 1/(χ + 1)}.

F }. Hence, since
F }, 1 −
(cid:3)

F , δvx

F , δvx

37

13. The decomposition threshold of bipartite graphs

In this section, we will determine δF for every bipartite graph. We ﬁrst make some
preliminary observations. We then consider the case ˜τ (F ) = 1 of coprime component sizes,
where δF ∈ {0, 1/2}. The main part of the section is devoted to the case τ (F ) = 1. Finally,
we consider extremal examples.

13.1. Preliminary observations. Whilst not much is known about the value of δ0+
F
general, we can use the following observation in the bipartite case.
Fact 13.1. If F is bipartite, then δ0+

F = 0.

in

Proof. The Erd˝os–Stone theorem tells us that the Tur´an density of F is 0. Hence, for all
η > 0, there exists an n0 such that from every graph G with n ≥ n0 vertices, we can greedily
remove copies of F until at most ηn2 edges remain.
(cid:3)

In order to achieve upper bounds on δF using Theorem 7.1, we will investigate the absorb-
ing behaviour of a given bipartite graph F . To this end, we recall the deﬁnitions of τ (F ) and
˜τ (F ) (see Theorem 1.7). Let F be a bipartite graph. A set X ⊆ V (F ) is called C4-supporting
in F if there exist distinct a, b ∈ X and c, d ∈ V (F ) \ X such that ac, bd, cd ∈ E(F ). We
deﬁned

τ (F ) := gcd{e(F [X]) : X ⊆ V (F ) is not C4-supporting in F},
˜τ (F ) := gcd{e(C) : C is a component of F}.

Fact 13.2. Let F be bipartite. Then τ (F ) | gcd(F ) and gcd(F ) | ˜τ (F ).
Proof. For the ﬁrst assertion, note that for every vertex v ∈ V (F ), X := NF (v) ∪ {v} is
not C4-supporting and e(F [X]) = dF (v). Secondly, for every component C of F , we have
gcd(C) | e(C), since the edges in C can be counted by summing the degrees of the vertices
in one colour class of C, and clearly gcd(F ) | gcd(C).
(cid:3)

Recall that we deﬁned (C2ℓ)F -switchers and (K2,r)F -switchers as special models in Sec-

tion 9.
Proposition 13.3. Let F be a bipartite graph and r ∈ N with gcd(F ) | r. There exists a
0-compressible (K2,r)F -switcher.
Proof. By Lemma 10.6, we can assume that r = dF (v) for some v ∈ V (F ). Let c be
a {1, 2}-colouring of F with c(v) = 1. Let S be the graph obtained from F by deleting
all edges at v and adding a new vertex v′. Since F is bipartite, U := {v, v′} ∪ NF (v) is
independent in S. Let E+ := {vu : u ∈ NF (v)} and E− := {v′u : u ∈ NF (v)}. Clearly, S
is an (E+, E−)F -switcher. Deﬁne f (u) := p2 for all u ∈ NF (v), f (v) := p1 and f (v′) := p3.
Moreover, deﬁne ψ(x) := pc(x) for all x ∈ V (F ) and ψ(v′) := p3. Then, (P2, f, P2, ψ) is a
0-compression of (S, U ).

(cid:3)

Let F be a graph and d ≥ 0. Let (T,{u1, . . . , u4}) be a model such that T is a
({u1u2},{u3u4})F -switcher. Note that a necessary condition for this to exist is that gcd(F ) =
1.
If (T,{u1, . . . , u4}) is d-compressible with respect to the root-compression (P1, f ), where
f (u1) = f (u3) = p1 and f (u2) = f (u4) = p2, then we call (T,{u1, . . . , u4}) a d-compressible
internal (P1)F -teleporter.
1p′
2} and E(2P1) = {p1p2, p′
If
(T,{u1, . . . , u4}) is d-compressible with respect to the root-compression (2P1, f ′), where
f ′(u1) = p1, f ′(u2) = p2, f ′(u3) = p′
2, then we call (T,{u1, . . . , u4}) a
d-compressible external (P1)F -teleporter.

Let 2P1 be the graph with V (2P1) = {p1, p2, p′

2}.

1, p′

1 and f ′(u4) = p′

Note that by Fact 8.5, every d-compressible external (P1)F -teleporter is also a d-compressible

internal (P1)F -teleporter. Loosely speaking, when considering an (α, ε, k)-partition of a

38

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

graph G, then an internal (P1)F -teleporter allows us to switch between two edges lying in
the same regular pair of clusters, whereas an external (P1)F -teleporter would allow us to
switch between two edges that may belong to diﬀerent regular pairs.

The following proposition gives an easy way of constructing an internal (P1)-teleporter.

We will use it as a tool in the proof of Lemmas 13.5 and 13.9.

Proposition 13.4. Let F be a bipartite graph with gcd(F ) = 1. Then there exists a 0-
compressible internal (P1)F -teleporter (T,{u1, . . . , u4}).

Note that in this case, T itself has a homomorphism onto P1 and is thus bipartite.

Proof. Let T ′ be the graph with vertex set {u1, . . . , u4, w} and edge set {u2w, wu4}. Con-
sider the model (T ′,{u1, . . . , u4}) with compression (P1, f, P1, ψ), where ψ(ui) := f (ui) := p1
for i ∈ {1, 3}, ψ(ui) := f (ui) := p2 for i ∈ {2, 4}, and ψ(w) := p1. By Proposition 13.3,
there exists a 0-compressible (K2,1)F -switcher. So by Corollary 8.7, we can attach graphs
S1, S2, S3 to T ′ such that

• S1 is a ({u1u2},{wu2})F -switcher;
• S2 is a ({u2w},{u4w})F -switcher;
• S3 is a ({wu4},{u3u4})F -switcher;
• (T,{u1, . . . , u4}) is 0-compressible with respect to (P1, f ), where T := T ′∪S1∪S2∪S3.

(cid:3)

Then, T is clearly a ({u1u2},{u3u4})F -switcher.

13.2. Coprime component sizes. We ﬁrst analyse the case when ˜τ (F ) = 1. In the proof
of the following lemma, we construct an external (P1)F -teleporter, which we will use in the
proof of Lemma 13.6 to show that F is 0-absorbing.

Lemma 13.5. Let F be a bipartite graph with ˜τ (F ) = 1. Then there exists a 0-compressible
external (P1)F -teleporter.

Proof. Let M1, M2 be disjoint multisets containing components of F such that 1 +
e(C). Let U = {u1, . . . , u4} and deﬁne f ′ : U → V (2P1) as f ′(u1) :=
We want to construct a 0-compressible model (T, U ) with respect to (2P1, f ′) such that

1 and f ′(u4) := p′
2.

p1, f ′(u2) := p2, f ′(u3) := p′

e(C) =PC∈M2

PC∈M1
T is a ({u1u2},{u3u4})F -switcher.
that c(v) = 1 and c(w) = 2.

Let E⊙
i

C and F −

C ∪ F −
F +

C ∪ F 0
C.

C∗ be a copy of C ∗ − vw such that u1, u2 play the roles of v, w. Likewise, let F −

Fix some component C ∗ ∈ M2 and let vw ∈ E(C ∗). Let c be a {1, 2}-colouring of F such
Let F +
C∗ be
C∗ be a copy of F − V (C ∗).
C be two copies of C
C be a copy of F − V (C). We may assume that all these copies are vertex-disjoint.

a copy of C ∗ − vw such that u3, u4 play the roles of v, w. Let F 0
Moreover, for each component C ∈ M1 ∪ (M2 \ {C ∗}), let F +
and let F 0
Let T ′ :=SC∈M1∪M2
For all x ∈ V (T ′) that belong to some F 0
C , deﬁne ψ(x) := pc(z), where z is the vertex
of F whose role x is playing. Likewise, for all x ∈ V (T ′) that belong to some F −
C , deﬁne
c(z), where z is the vertex of F whose role x is playing. Observe that ψ : T ′ → 2P1 is
ψ(x) := p′
a homomorphism such that ψ↾U = f ′. Hence, (2P1, f ′, 2P1, ψ) is a 0-compression of (T ′, U ).
F ⊙
:= E(SC∈Mi
C ) for i ∈ {1, 2} and ⊙ ∈ {+,−}. By the deﬁnitions of M1, M2
and C ∗, we have |E+
2 | and |E−
1 | = |E+
2 be
arbitrary bijections. For every edge e ∈ E+
1 , we have e = xy and φ+(e) = x′y′ for suitable
distinct x, y, x′, y′ such that ψ(x) = ψ(x′) = p1 and ψ(y) = ψ(y′) = p2. Similarly, for every
edge e ∈ E−
1 , we have e = xy and φ−(e) = x′y′ for suitable distinct x, y, x′, y′ such that
ψ(x) = ψ(x′) = p′
2. By Fact 13.2 and Proposition 13.4, there exists
a 0-compressible internal (P1)F -teleporter. We can therefore use Corollary 8.7 to attach
graphs (Te)e∈E+

1 and ψ(y) = ψ(y′) = p′

2 |. Let φ+ : E+

2 and φ− : E−

1 | = |E−

to T ′ such that

1 ∪E−

1

1 → E+

1 → E−

C or F +

39

• Te is an ({e},{φ+(e)})F -switcher for every e ∈ E+
1 ;
• Te is an ({e},{φ−(e)})F -switcher for every e ∈ E−
1 ;
• (T, U ) is 0-compressible with respect to (2P1, f ′), where T := T ′ ∪ S+ ∪ S−, S+ :=
Se∈E+

It remains to show that T is a ({u1u2},{u3u4})F -switcher. Note that S+ is an (E+
switcher and S− is an (E−

Te and S− :=Se∈E−

1 , E+

2 )F -

Te.

1

1

1 , E−
T ∪ {u1u2} = (F 0
∪ [C∈M1
T ∪ {u3u4} = (F 0
∪ [C∈M1

C∗ ∪ F −

(F 0

2 )F -switcher. Thus,
C∗ ∪ F +

(F 0

(F 0

C ) ∪ [C∈M2\{C∗}

C∗ ∪ {u1u2}) ∪ (S+ ∪ E+
C ∪ F −
C∗ ∪ {u3u4}) ∪ (S+ ∪ E+
C ∪ F +

1 ) ∪ (S− ∪ E−
2 )
C ∪ F +
C ),
2 ) ∪ (S− ∪ E−
1 )
C ∪ F −
C ),

(F 0

C ) ∪ [C∈M2\{C∗}

are both F -decomposable.

(cid:3)

Lemma 13.6. Let F be bipartite and ˜τ (F ) = 1. Then F is 0-absorbing.

Using Lemma 13.5, we will be able to transform any given leftover into a union of copies

Let t := |T| and assume that 1/n ≪ 1/k′

of F resulting in the desired absorber.
Proof. By Lemma 13.5, there exists a 0-compressible external (P1)F -teleporter (T,{u1, . . . , u4}),
say, that is, T is a ({u1u2},{u3u4})F -switcher and (T,{u1, . . . , u4}) is 0-compressible with
respect to (2P2, f ′), where f ′(u1) = p1, f ′(u2) = p2, f ′(u3) = p′
0, ε ≪ α, 1/b ≪ 1/m, µ, 1/|F|. Since t only
depends on F this implies that α, 1/b ≪ 1/t. Suppose that G is a graph on n vertices with
δ(G) ≥ µn that has an (α, ε, k)-partition V1, . . . , Vk for some k ≤ k′
0. Suppose also that H
is any F -divisible subgraph of G of order at most m. We are to show that G contains an
F -absorber for H of order at most b. Let p := e(H)/e(F ) and let pF be the vertex-disjoint
union of p copies of F . Clearly, we can ﬁnd a copy H ′ of pF as a subgraph in G such that
H ′ is vertex-disjoint from H. Let e1, . . . , eh be an enumeration of the edges of H and let
1, . . . , e′
e′
i})F -
switcher for all i ∈ [h]. More precisely, we want to ﬁnd edge-disjoint copies T1, . . . , Th of T
in G such that

h be an enumeration of the edges of H ′. We now want to ﬁnd an ({ei},{e′

1 and f ′(u4) = p′
2.

(i) Ti is an ({ei},{e′
(ii) Ti[V (H)] and Ti[V (H ′)] are empty.

i})F -switcher;

1, . . . , V ′

1, . . . , V ′

k is an (α/2, 3ε, k)-partition of G′ := G[V ′

Once again, we ﬁnd them one by one using Lemma 8.4. Suppose that for some s ∈ [h],
s = x′y′ ∈ E(H ′). Let
we have already found T1, . . . , Ts−1. Write es = xy ∈ E(H) and e′
X := V (H)∪V (H ′)∪V (T1)∪···∪V (Ts−1). For every i ∈ [k], let V ′
i := Vi\(X\{x, y, x′, y′}).
k] and δ(G′) ≥ µ|G′|/2.
1 ∪ ··· ∪ V ′
Then, V ′
Let Λ : {u1, . . . , u4} → V (G′) be deﬁned as Λ(u1) := {x}, Λ(u2) := {y}, Λ(u3) := {x′} and
Λ(u4) := {y′}. We claim that Λ is (α/2, 3ε, k)-admissible. Clearly, Λ respects (2P2, f ′). Let
k (with respect to G′) and σ : V (G′) → R the cluster
R be the reduced graph of V ′
1) := σ(x′) and
function. Deﬁne j : V (2P1) → V (R) by j(p1) := σ(x), j(p2) := σ(y), j(p′
2) := σ(y′). Since xy, x′y′ ∈ E(G′), we have σ(x)σ(y), σ(x′)σ(y′) ∈ E(R), so (D1) holds.
j(p′
Observe that Wp1 = {y}. Since dG′(y, Vσ(x)) > 0, we have dG′(Wp1, Vj(p1)) ≥ α|Vj(p1)|/2.
The same applies to p2, p′
2, so (D3) holds as well. (D2) and (D4) hold trivially. Thus,
Lemma 8.4 implies that there exists an embedding ρ of (T,{u1, . . . , u4}) into G′ respecting
Λ. Take Ts := ρ(T ).
Let A := H ′ ∪ T1 ∪ ··· ∪ Th. Then |A| ≤ e(H)|F| + e(H)t ≤ b and A[V (H)] is empty.
Since A = Si∈[h](Ti ∪ {e′
i}) is F -decomposable and A ∪ H = H ′ ∪Si∈[h](Ti ∪ {ei}) is F -

decomposable too, A is an F -absorber for H in G of order at most b.

1, p′

(cid:3)

40

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

13.3. Coprime non-C4-supporting sets. Here we show that τ (F ) = 1 implies that F is
1/2-absorbing (see Corollary 13.10). The remaining step towards this goal is to show that
there exists a 2-compressible (C6)F -switcher.
In fact, we will construct a 0-compressible
(C6)F -switcher. For this we need to construct a model (S,{u1, . . . , u6}) and a homomorph-
ism ψ : S → C6 such that ψ(ui) = ci for all i ∈ [6] and such that both S ∪{u1u2, u3u4, u5u6}
and S ∪ {u2u3, u4u5, u6u1} are F -decomposable.
Fact 13.7. Let F be bipartite. Then

τ (F ) = gcd{e(F [X]) : X ⊆ V (F ) is not C4-supporting and F [X] is connected}.

It is suﬃcient to show that for any X ⊆ V (F ) that is not C4-supporting, we
Proof.
have that gcd{e(F [Y ]) : Y ⊆ V (F ) is not C4-supporting and F [Y ] is connected} divides
e(F [X]). Therefore, suppose that X ⊆ V (F ) is not C4-supporting. There is a partition
X = Y1 ∪ ··· ∪ Yt such that F [Y1], . . . , F [Yt] are the components of F [X]. Then, e(F [X]) =
e(F [Y1]) + ··· + e(F [Yt]) and every Yi itself is not C4-supporting.
(cid:3)

For graphs H and J, a homomorphism ψ : H → J, and vertices j1, . . . , jk ∈ V (J), we
slightly abuse notation for the sake of readability and write H[ψ−1(j1 . . . jk)] instead of
H[ψ−1({j1, . . . , jk})].
switcher.

The following lemma is the key building block for the construction of the desired C6-

Lemma 13.8. Let F be bipartite and τ (F ) = 1. Then there exist F -decomposable graphs
G+, G−, an edge e0 ∈ E(G+) and a homomorphism ρ : G+∪G− → C6 such that ρ(e0) = c1c2
and G−[ρ−1(c1c2)] = G+[ρ−1(c1c2)] − {e0}.

Note that the condition τ (F ) = 1 is crucial here. Indeed, if ρ′ : F → C6 is a homomorph-
ism, then the number of edges mapped to c1c2 is divisible by τ (F ) as ρ′−1({c1, c2}) is not
C4-supporting. Hence, τ (F ) must divide both e(G+[ρ−1(c1c2)]) and e(G−[ρ−1(c1c2)]).

Proof. Let

C := {F [X] : X ⊆ V (F ) is not C4-supporting and F [X] is connected}.

A graph G is called C-decomposable if G can be decomposed into copies of elements of C. It is
suﬃcient to show that there exist a graph G0, a homomorphism ρ0 : G0 → C6[{c1, c2}] ≃ P1
and an edge e0 ∈ E(G0) such that both G0 and G0 − {e0} are C-decomposable. Indeed, if
F [X] ∈ C appears in the decomposition of G0 (or G0 − {e0}), then one can extend F [X] to
a copy of F and extend ρ0 appropriately without mapping new edges to c1c2. Clearly, all
these extensions can be carried out edge-disjointly.

e(C) =PC∈M+

We now construct G0. By assumption and Fact 13.7, gcd({e(C) : C ∈ C}) = 1.
Thus, there exist disjoint sets M+, M− containing copies of elements of C such that 1 +
PC∈M−
e(C). We may assume that all the elements of M+∪M− are vertex-
disjoint. Let G′ :=S M+ ∪S M−. Clearly, G′ is bipartite, i.e. there exists a homomorphism
ρ′ : G′ → P1. Let E⊙ := E(S M⊙) for ⊙ ∈ {+,−}. Hence, |E+| = |E−| + 1. Let e0 be
any edge in E+. Let ˜F be the disjoint union of all elements of C. We want to construct
an (E+ \ {e0}, E−) ˜F -switcher S. To this end, let φ be an arbitrary bijection from E− to
E+ \ {e0}, and for every e ∈ E−, let Ve be the set of vertices incident to e or φ(e).
Clearly, ˜τ ( ˜F ) = 1. By Fact 13.2, it follows that gcd( ˜F ) = 1. Thus, Proposition 13.4
implies that there exists a 0-compressible internal (P1) ˜F -teleporter. Therefore, there exist
graphs (Te)e∈E− such that

• Te is an ({e},{φ(e)}) ˜F -switcher for each e ∈ E−;
• V (G′) ∩ V (Te) = Ve for each e ∈ E−;
• V (Te) ∩ V (Te′) = Ve ∩ Ve′ for all distinct e, e′ ∈ E−;
• there exists a homomorphism ρe : Te → P1 with ρe(x) = ρ′(x) for all x ∈ Ve.

41

decomposable.

Te and G0 := G′ ∪ S. Clearly, S is an (E+ \ {e0}, E−) ˜F -switcher and
Let S := Se∈E−
ρe is a homomorphism G0 → P1.
ρ0 := ρ′ ∪Se∈E−
In particular, both S ∪ (E+ \ {e0}) and S ∪ E− are C-decomposable. Thus, G0 = (S ∪
E−) ∪S M+ is C-decomposable. Similarly, G0 − {e0} = (S ∪ (E+ \ {e0})) ∪S M− is C-
We will now construct the desired C6-switcher. We will ﬁrst translate the structure
obtained from Lemma 13.8 into a ‘pseudo’-({u1u2},{u1u6, u2u3})F -switcher in the sense
that there are some additional unwanted switchings (see Figure 3). Here u1u2 plays the role
of the edge e0 from Lemma 13.8. We will then mirror this structure so that the mirror image
of u1u2 is u5u4 and u3, u6 are ﬁxed points. The original structure together with its mirror
image form a ‘pseudo’-(u1, . . . , u6)F -switcher.
In fact, some of the unwanted switchings
will cancel out (see Figure 4). By the inherent symmetry, we can pair up the unwanted
switchings and decompose them in a number of ‘double-stars’, which we can incorporate by
adding suitable ‘double-star-switchers’.

(cid:3)

Lemma 13.9. Let F be bipartite and τ (F ) = 1. Then there exists a 0-compressible (C6)F -
switcher.

Proof. Let J be a copy of C6 with vertices c1, c2, c3, a2, a1, c6 appearing in this order on the
cycle.

Step 1

Let G+, G− be F -decomposable graphs, u1u2 ∈ E(G+) and let ρ : G+ ∪ G− → J be a
homomorphism such that ρ(ui) = ci for i ∈ {1, 2} and G−[ρ−1(c1c2)] = G+[ρ−1(c1c2)] −
{u1u2}, which exist by Lemma 13.8. We may assume that G+ and G− are otherwise edge-
disjoint.
Let H := (G+ ∪ G−) − {u1u2}. For ⊙ ∈ {+,−}, deﬁne H⊙ := G⊙[ρ−1(c6a1a2c3)],
H1,⊙ := G⊙[ρ−1(c1c6)] and H2,⊙ := G⊙[ρ−1(c2c3)]. Thereby, we have the following:
(H1) {u1, u2} ⊆ V (H) is independent in H and ρ(ui) = ci for i ∈ {1, 2};
(H2) H = H0 ·∪ H+ ·∪ H− ·∪ H1,+ ·∪ H1,− ·∪ H2,+ ·∪ H2,−, where

(H3′) ˜H0 ∪{u1u2}∪ ˜H+ and ˜H0 ∪{u1u6, u2u3}∪ ˜H− ∪ ˜H1 ∪ ˜H2 are both F -decomposable.
To this end, let u3, u6 be new vertices (i.e. vertices not in H). Pick vw ∈ E(F ) and let F1 be
a copy of F − vw such that u1, u6 play the roles of v, w, and let F2 be a copy of F − vw such
that u2, u3 play the roles of v, w, and all other vertices are new vertices. Clearly, there exists
a homomorphism ρ1 : F1 → J[{c1, c6}] such that ρ1(u1) = c1 and ρ1(u6) = c6. Similarly, let
ρ2 : F2 → J[{c2, c3}] be a homomorphism such that ρ2(u2) = c2 and ρ2(u3) = c3.
For every e ∈ E(H1,+ ∪ H2,+), let Fe be a copy of F that contains e and consists of
new vertices apart from the endpoints of e. For e ∈ E(H1,+), let ρe : Fe → J[{c1, c6}] be

(H3) H0∪{u1u2}∪H+∪H1,+∪H2,+ and H0∪H−∪H1,−∪H2,− are both F -decomposable.
We now want to extend H to ˜H and ρ to ˜ρ such that the following hold (see Figure 3):
(H1′) {u1, u2, u3, u6} ⊆ V ( ˜H) is independent in ˜H and ˜ρ(ui) = ci for i ∈ {1, 2, 3, 6};
(H2′) ˜H = ˜H0 ·∪ ˜H+ ·∪ ˜H− ·∪ ˜H1 ·∪ ˜H2, where

• H0 := H[ρ−1(c1c2)],
• H+ ·∪ H− = H[ρ−1(c6a1a2c3)],
• H1,+ ·∪ H1,− = H[ρ−1(c1c6)], and
• H2,+ ·∪ H2,− = H[ρ−1(c2c3)];

• ˜H+ ·∪ ˜H− = ˜H[˜ρ−1(c6a1a2c3)],
• ˜H1,0 ·∪ ˜H1 = ˜H[˜ρ−1(c1c6)],
• ˜H2,0 ·∪ ˜H2 = ˜H[˜ρ−1(c2c3)], and
• ˜H0 := ˜H[˜ρ−1(c1c2)] ∪ ˜H1,0 ∪ ˜H2,0;

42

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

c1

u1

c6

u6

u2

c2

u3

c3

a1

a2

˜H0

˜H+

˜H− ∪ ˜H1 ∪ ˜H2

Figure 3. The structure to be constructed in Step 1.

a homomorphism such that ρe(x) = ρ(x) for x ∈ V (e). For e ∈ E(H2,+), let ρe : Fe →
J[{c2, c3}] be a homomorphism such that ρe(x) = ρ(x) for x ∈ V (e).

Let

˜H := H ∪ F1 ∪ F2 ∪

[e∈E(H1,+∪H2,+)

Fe

and deﬁne ˜ρ := ρ ∪ ρ1 ∪ ρ2 ∪Se∈E(H1,+∪H2,+) ρe. Then, (H1′) holds. Let ˜H⊙ := H⊙ for
⊙ ∈ {+,−} and ˜Hi,0 := Hi,+ for i ∈ {1, 2}. Note that ˜H[˜ρ−1(c1c2)] = H[ρ−1(c1c2)] = H0.
Therefore, deﬁning ˜H0 := ˜H[˜ρ−1(c1c2)] ∪ ˜H1,0 ∪ ˜H2,0 yields ˜H0 = H0 ∪ H1,+ ∪ H2,+. Finally,
for i ∈ {1, 2}, let

˜Hi := Hi,− ∪ Fi ∪ [e∈E(Hi,+)

(Fe − e).

This way, (H2′) holds. Now, ˜H0 ∪ {u1u2} ∪ ˜H+ is F -decomposable by (H3). Moreover,
˜H0∪{u1u6, u2u3}∪ ˜H−∪ ˜H1∪ ˜H2 can be decomposed into H0∪H−∪H1,−∪H2,−, F1∪{u1u6},
F2 ∪ {u2u3} and H1,+ ∪ H2,+ ∪Se∈E(H1,+∪H2,+)(Fe − e). The former is F -decomposable by
(H3) and the others are all trivially F -decomposable, so (H3′) holds.

Step 2

is, add new vertices c5, c4 to J together with the edges c6c5, c5c4 and c4c3.

Let J ∗ be the graph obtained from J by mirroring J with ﬁxed points {c6, a1, a2, c3}, that
Alternatively, J ∗ can be viewed as the graph obtained from C6 (with vertices c1, . . . , c6

in the usual order) by adding two new vertices a1, a2 and the edges c6a1, a1a2, a2c3.

For every vertex x ∈ ˜ρ−1(c1c2), let x′ be a new vertex. Let ˜H ′ be the copy of ˜H ob-
2 be the subgraphs of ˜H ′

tained by replacing every x ∈ ˜ρ−1(c1c2) with x′, and let ˜H ′
corresponding to ˜H0, ˜H1, ˜H2. So ˜H ′ = ˜H ′
0 ·∪ ˜H+ ·∪ ˜H− ·∪ ˜H ′

1, ˜H ′
2. Let

0, ˜H ′
1 ·∪ ˜H ′

S∗ := ˜H ∪ ˜H ′.

We can extend ˜ρ to a homomorphism ψ : S∗ → J ∗ by deﬁning ψ(x′) := c5 for every
x ∈ ˜ρ−1(c1) and ψ(x′) := c4 for every x ∈ ˜ρ−1(c2).
We let u5 := u′
2, thus u5u4 is the mirror image of u1u2. Note that U :=
{u1, . . . , u6} is independent in S∗. Let f be deﬁned as f (ui) := ci for all i ∈ [6]. Therefore,
(J ∗, f, J ∗, ψ) is a 0-compression of (S∗, U ).

1 and u4 := u′

Note that by symmetry and (H3′),
(H4′) ˜H ′
Let

0 ∪{u4u5}∪ ˜H+ and ˜H ′

0 ∪{u5u6, u3u4}∪ ˜H− ∪ ˜H ′

1 ∪ ˜H ′

2 are both F -decomposable.

S∗∗ := ˜H0 ∪ ˜H+ ∪ ˜H− ∪ ˜H ′
(13.1)
Combining (H3′) and (H4′), we conclude that
(H5′) S∗∗ ∪ {u1u2, u3u4, u5u6} ∪ ˜H ′

1 ∪ ˜H ′

F -decomposable (see Figure 4).

0 = S∗ − ( ˜H ′

1 ∪ ˜H ′

2 ∪ ˜H1 ∪ ˜H2).

2 and S∗∗ ∪ {u2u3, u4u5, u6u1} ∪ ˜H1 ∪ ˜H2 are both

43

c1

u1

c6

u6

c5

u5

˜H1

˜H ′
1

a1

a2

˜H2

˜H ′
2

u2

c2

u3

c3

u4

c4

Figure 4. By mirroring the structure obtained in Step 1 (see Figure 3), we obtain the
desired (u1, . . . , u6)F -switching, plus some unwanted (but symmetric) switchings. The
subgraphs ˜H+ and ˜H− are contained in both F -decompositions.

(x′) since N ˜H1

1

(x). Moreover, N ˜H1

(x) = N ˜H ′

(x), implying
(x) ⊆ ˜ρ−1(c6). The same applies
2. Hence, by Corollary 8.7 and Proposition 13.3, we can attach

Consider x ∈ ˜ρ−1(c1). Note that by (H2′), x is not incident with any edge from ˜H+, ˜H−, ˜H2,{u2u3}.
Let r := gcd(F ). By (H3′), we have r | d ˜H0∪{u1u2}(x) and r | d ˜H0∪{u1u6}∪ ˜H1
that r | d ˜H1
to x ∈ ˜ρ−1(c2) with ˜H2, ˜H ′
graphs (Sx)x∈˜ρ−1(c1c2) to S∗ such that
• Sx is an ( ˜Hi[x, N ˜Hi
• (S, U ) is 0-compressible with respect to (J ∗, f ), where S := S∗ ∪ S1 ∪ S2 and Si :=
Sx∈˜ρ−1(ci) Sx for i ∈ {1, 2}.

(x′)])F -switcher for all i ∈ {1, 2}, x ∈ ˜ρ−1(ci);

Clearly, S1 is an ( ˜H1, ˜H ′
(13.1) and (H5′), it follows that S is a (u1, . . . , u6)F -switcher.

1)F -switcher and S2 is an ( ˜H2, ˜H ′

2)F -switcher. Thus, together with

(x)], ˜H ′

i[x′, N ˜H ′

i

By identifying a1 with c1 and a2 with c2, we can see that (S, U ) is 0-compressible with
(cid:3)

respect to (C6, f ) by Fact 8.5.

Corollary 13.10. Let F be bipartite and τ (F ) = 1. Then F is 1/2-absorbing.

Proof. This follows from Lemma 13.9, Proposition 13.3, Lemma 9.1 and Lemma 12.1.

(cid:3)

13.4. Lower bounds. The remaining steps towards the proof of Theorem 1.7 are extremal
examples giving lower bounds on δF .
Proposition 13.11. Let F be bipartite. If τ (F ) > 1, then δF ≥ 2/3.
Proof. Let r := gcd(F ). By Fact 13.2, τ (F ) | r. We show that there are F -divisible
graphs G of arbitrarily large order which are not F -decomposable, while δ(G) ≥ ⌊2|G|/3⌋−
2r(e(F ) + 1). Let m be suﬃciently large.

Case 1: τ (F ) is odd.

Let V1, V2, V3 be disjoint sets with |V1| = 2rm + τ (F ) − 1, |V2| = 2rm − τ (F ) + 2,
|V3| = 2rm − τ (F ) + 1. Let G be the graph on vertex set V1 ∪ V2 ∪ V3 consisting of two
cliques on V1 and V3 and a complete bipartite graph with vertex classes V1 ∪ V3 and V2.
Hence, G has 6rm − τ (F ) + 2 vertices. Moreover, dG(v) = 4rm for all v ∈ V1 ∪ V2 and
dG(v) = 4rm − 2τ (F ) + 2 for all v ∈ V3.
Let G′ be the graph obtained from G by removing the edges of r + 1− τ (F ) edge-disjoint
Hamilton cycles in G[V3]. Hence, G′ is r-divisible and thus r | 2e(G′). Apply Proposition 11.2
to G′[V3] with e(G′) playing the role of e to obtain an r-divisible subgraph H of G′[V3] such

44

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

that e(G′) ≡ e(H) mod e(F ) and ∆(H) ≤ 2e(F )r. Let G′′ := G′ − H. Hence, G′′ is
F -divisible and

δ(G′′) ≥ 4rm − 2τ (F ) + 2 − 2(r + 1 − τ (F )) − 2e(F )r ≥ ⌊2|G′′|/3⌋ − 2r(e(F ) + 1).
We will now see that G′′ is not F -decomposable. Let F ′ be any copy of F in G′′. Note that
V (F ′) ∩ V1 is not C4-supporting in F ′, hence τ (F ) | e(F ′[V1]). So a necessary condition for
G′′ having an F -decomposition is that e(G′′[V1]) is divisible by τ (F ). However, e(G′′[V1]) =
(rm + (τ (F ) − 1)/2)(2rm + τ (F ) − 2). Recall that τ (F ) | r. Hence, the ﬁrst factor is not
divisible by τ (F ) since τ (F ) > 1 and the second factor is coprime to τ (F ) as τ (F ) is odd.

Case 2: τ (F ) is even.

Deﬁne G as before, but this time the sizes of V1, V2, V3 satisfy |V1| = 2rm + τ (F ), |V2| =
2rm − τ (F ) + 1, |V3| = 2rm − τ (F ). Hence, G has 6rm − τ (F ) + 1 vertices. Moreover,
dG(v) = 4rm for all v ∈ V1 ∪ V2 and dG(v) = 4rm − 2τ (F ) for all v ∈ V3.
Let G′ be the graph obtained from G by removing the edges of r − τ (F ) edge-disjoint
Hamilton cycles in G[V3]. Hence, G′ is r-divisible and thus r | 2e(G′). Apply Proposition 11.2
to G′[V3] with e(G′) playing the role of e to obtain an r-divisible subgraph H of G′[V3] such
that e(G′) ≡ e(H) mod e(F ) and ∆(H) ≤ 2e(F )r. Let G′′ := G′ − H. Hence, G′′ is
F -divisible and

δ(G′′) ≥ 4rm − 2τ (F ) − 2(r − τ (F )) − 2e(F )r ≥ ⌊2|G′′|/3⌋ − 2r(e(F ) + 1).

As before, a necessary condition for G′′ having an F -decomposition is that e(G′′[V1]) is
divisible by τ (F ). However, e(G′′[V1]) = (rm + τ (F )/2)(2rm + τ (F ) − 1), where the ﬁrst
factor is not divisible by τ (F ) and the second factor is coprime to τ (F ), so e(G′′[V1]) is not
divisible by τ (F ).
(cid:3)

Proposition 13.12. Let F be bipartite. If ˜τ (F ) > 1 or every edge of F is contained in a
cycle, then δF ≥ 1/2.
Proof. Let r := gcd(F ). Suppose that ˜τ (F ) = 1. By Fact 13.2, r = 1. Moreover, our
assumption implies that every edge of F is contained in a cycle. For any m ∈ N, the graph
G obtained from two disjoint cliques of order me(F ) each by deleting one edge and adding
a bridge between the two components is F -divisible and satisﬁes δ(G) ≥ |G|/2 − 2, but is
not F -decomposable.

We can therefore assume that ˜τ (F ) > 1.

Case 1: r is even or ˜τ (F ) > r.

Let a := r if r is odd and a := r/2 if r is even. Note that a < ˜τ (F ) since r | ˜τ (F ).
For any m ∈ N, let V1, V2 be disjoint sets of size 2me(F )˜τ (F ) + 1 each and let G be the
graph consisting of two cliques on V1 and V2. Clearly, G is F -divisible. Let G′ be the graph
obtained from G by removing the edges of a edge-disjoint Hamilton cycles from G[V1] and
(e(F ) − 1)a edge-disjoint Hamilton cycles from G[V2]. Observe that G′ is still F -divisible
and δ(G′) ≥ 2me(F )˜τ (F ) − 2e(F )r = |G′|/2 − 1 − 2e(F )r.
However, e(G′[V1]) ≡ −|V1|a mod ˜τ (F ). Since a < ˜τ (F ) and gcd{|V1|, ˜τ (F )} = 1, we
deduce that e(G′[V1]) is not divisible by ˜τ (F ), implying that G′ cannot be F -decomposable.
Case 2: r is odd and ˜τ (F ) = r.

Since ˜τ (F ) > 1, we have r > 1. We ﬁrst claim that every edge of F is contained in a cycle.
Suppose that xy is not contained in a cycle. Then there exists a partition of V (F ) into sets
A1, A2, B1, B2 such that x ∈ A1, y ∈ B2 and E(F ) = E(F [A1, B1]) ∪ E(F [A2, B2]) ∪ {xy}.
Hence,

e(F ) = e(F [A1, B1]) + e(F [A2, B2]) + 1 = Xv∈B1

which contradicts r | e(F ) and r > 1.

dF (v) + Xv∈A2

dF (v) + 1 ≡ 1 mod r,

45

Let Q be a graph with one vertex q of degree 1 and all other vertices of degree r. (To
construct such a Q, start with Kr,r and remove the edges of a matching of size (r − 1)/2.
Add a new vertex q′ and join q′ to all vertices that were incident with an edge from the
matching. Add q and join q to q′.)

Now, for any suﬃciently large m ∈ N, let V1, V2 be disjoint sets of size rm + 1 each and
let G be the graph consisting of two cliques on V1 and V2. Clearly, G is r-divisible. Fix
v1 ∈ V1 and v2 ∈ V2. For i ∈ {1, 2}, let Qi be a copy of Q in G[Vi] such that vi plays the role
of q. Let G′ := (G ∪ {v1v2}) − Q1 − Q2. Clearly, G′ is r-divisible. In particular, r | 2e(G′).
Apply Proposition 11.2 to G′[V1] with e(G′) playing the role of e in order to obtain an r-
divisible subgraph H of G′[V1] such that e(H) ≡ e(G′) mod e(F ) and ∆(H) ≤ 2e(F )r. Let
G′′ := G′−H. Thus, G′′ is F -divisible and δ(G′′) ≥ rm−r−2e(F )r = |G′′|/2−1−r−2e(F )r.
However, G′′ is not F -decomposable because v1v2 cannot be covered.

(cid:3)

Let F be a bipartite graph.

bridge and δvx
Theorem 1.7.

F = 0 if F contains a
F = 1/2 otherwise (see Corollary 14.13(ii)). Using this, we can now prove

In Section 14 we will see that δvx

Note that δvx

F ≤ 1/2 by Corollary 14.13(ii) and δ0+

F = 0 by
Proof of Theorem 1.7.
Fact 13.1. By Corollary 12.3, F is 2/3-absorbing. Hence, by Theorem 7.1, δF ≤ 2/3. Now,
if τ (F ) > 1, then Proposition 13.11 implies that δF = 2/3. On the other hand, if τ (F ) = 1,
then we can deduce from Corollary 13.10 and Theorem 7.1 that δF ≤ 1/2. If ˜τ (F ) > 1 or
every edge is contained in a cycle, we deduce δF = 1/2 with Proposition 13.12. So assume
that ˜τ (F ) = 1 and that F contains a bridge. Then δvx
F = 0 by Corollary 14.13(ii) and F is
0-absorbing by Lemma 13.6. Hence, Theorem 7.1 implies that δF = 0.
(cid:3)

14. Covering the edges at a vertex

In this section, we investigate δvx

F , i.e. the threshold at which we can cover all edges at a
vertex. In particular, we will determine δvx
F for all bipartite graphs. In the general case, we
determine δvx
F , that is, we reduce the problem of covering all edges at
one vertex to the problem of covering one edge. We will use an iterative absorbing approach
which has many parallels to the main proof.

F as a function of δe

In Section 14.1, we will show how to obtain an approximate cover at some vertex x. In
Section 14.2, we will show how to turn an approximate cover into a near-optimal cover.
Roughly speaking, the neighbourhood of x will be partitioned into sets N1, . . . , Nℓ of suc-
cessively smaller size, where Nℓ has constant size. Using the result of Section 14.1, we can
cover all but a small fraction of the edges from x to N1. By assuming that the minimum
degree is above δe
F , we can cover the leftover edges one by one by using some edges from
x to N2. We then cover all but a small fraction of the remaining edges from x to N2 and
continue as above until all edges at x are covered except some from x to Nℓ. In Section 14.3,
we will see how these remaining edges can be absorbed.

14.1. Approximate cover. In order to determine the threshold which guarantees an ap-
proximate cover with copies of F at a vertex, we will use a result of Koml´os [15]. He showed
that the minimum degree threshold that guarantees the existence of vertex-disjoint copies
of a given graph F covering almost all vertices of the host graph is governed by the so-called
critical chromatic number of F . We will apply his result to a reduced graph.

For a graph F , let Col(F ) denote the set of all [χ(F )]-colourings of F and let σ(F ) :=

minc∈Col(F ) |c−1(1)|. The critical chromatic number of F is deﬁned as

where we set χcr(F ) := 0 if χ(F ) = 1.

χcr(F ) := (χ(F ) − 1)

|F|

|F| − σ(F )

,

46

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Theorem 14.1 (Koml´os [15]). For every graph H and µ > 0 there exists an n0 = n0(µ, H)
such that every graph G on n ≥ n0 vertices with δ(G) ≥ (1 − 1/χcr(H))n contains vertex-
disjoint copies of H covering all but at most µn vertices of G.

(Theorem 14.1 was further improved by Shokoufandeh and Zhao [19] who replaced the
µn term with a constant depending only on H. However, the result of Koml´os is suﬃcient
for our purposes.) We will apply Theorem 14.1 to an appropriate subgraph of the reduced
graph.

We now deﬁne the graph parameter χvx that governs the existence of an approximate

cover at one vertex, which turns out to be closely related to χcr.

For a graph F with χ := χ(F ) and a vertex v ∈ V (F ), let Col(F, v) := {c ∈ Col(F ) :

c(v) = χ} and deﬁne

σ(F, v) := min

c∈Col(F,v)|NF (v) ∩ c−1(1)|.

So if F can be coloured in a way such that NF (v) requires fewer than χ − 1 colours, then
σ(F, v) = 0. Note that if F is bipartite, then σ(F, v) = dF (v) for all v ∈ V (F ). But if χ ≥ 3,
then σ(F, v) < dF (v) for all v ∈ V (F ). Thus, if χ ≥ 3, then
dF (v)

χvx(F ) := (χ − 2) min

v∈V (F )

dF (v) − σ(F, v)

is well-deﬁned. Note that for all v ∈ V (F ),
(14.1)

σ(F, v) ≥ dF (v)(1 − (χ − 2)/χvx(F )).

Moreover, we set χvx(F ) := 0 if F is bipartite. Clearly,

(14.2)
Proposition 14.2. For all graphs F , min{δvx

χ − 2 ≤ χvx(F ) ≤ χ − 1.

F , δ0+

F } ≥ 1 − 1/(χvx(F ) + 1).

F , δ0+

We will see that δvx

F can be strictly larger than 1 − 1/(χvx(F ) + 1). Roughly speaking,
1−1/(χvx(F )+1) represents only a ‘space’ barrier, whereas δvx
F is also subject to other kinds
of barriers. The reason why we also show that δ0+
F ≥ 1 − 1/(χvx(F ) + 1) is that because
of this inequality, we can omit the term 1 − 1/(χvx(F ) + 1) in the discretisation given in
Theorem 1.1.
Proof. Let χ := χ(F ), χvx := χvx(F ) and δ := min{δvx
F }. Clearly, δ ≥ 1 − 1/(χ − 1).
We may therefore assume that χvx > χ−2. In particular, χ ≥ 3. Let µ := 1−1/(χvx +1)−δ
and suppose, for a contradiction, that µ > 0. We will construct graphs G of arbitrarily large
order with δ(G) ≥ (δ + µ/2)|G| such that any F -collection in G fails to cover Ω(|G|2) edges
and that there is a vertex x ∈ V (G) with gcd(F ) | dG(x) such that the edges at x cannot
be covered with edge-disjoint copies of F , contradicting the deﬁnition of δ.
More precisely, choose ν > 0 small enough such that 1 − 1/(χvx + 1 − ν) ≥ 1 − 1/(χvx +
1) − µ/2 and α := χvx − (χ − 2) − ν > 0. Let m ∈ N be suﬃciently large. We may assume
that (χ − 2)m + αm is an integer and divisible by gcd(F ). Let G be the complete χ-partite
graph with vertex classes V1, . . . , Vχ such that |Vi| = m for i ∈ [χ− 1] and |Vχ| = αm. Thus,
|G| = (χ − 1 + α)m and dG(x) ≥ (χ − 2 + α)m for all x ∈ V (G) since α < 1. By our choice
of ν, it follows that δ(G) ≥ (δ + µ/2)|G|.
η := 1 −

Observe that

> 0.

α

α + ν χ−2
χvx

Let x be any vertex in V (G) \ Vχ. By our assumption, gcd(F ) | dG(x). We will now
see that any F -collection in G fails to cover at least ηdG(x) edges at x. Let F1, . . . , Ft be
edge-disjoint copies of F in G, all containing x, and let ˜d :=Pt
j=1 dFj (x) denote the number
of edges covered at x. For j ∈ [t], let vj be the vertex of F whose role x is playing in Fj.
Thus, for all j ∈ [t], dFj (x, Vχ) ≥ σ(F, vj ). Hence, σ(F, v1) +··· + σ(F, vt) ≤ αm, and (14.1)

thus implies that ˜d · (1 − (χ − 2)/χvx) ≤ αm. Since dG(x) = (χ − 2 + α)m = (χvx − ν)m,
we deduce that

˜d

dG(x) ≤

αm

(1 − χ−2

χvx )(χvx − ν)m

=

α

α + ν χ−2
χvx

= 1 − η,

proving the claim.

47

x cannot be covered with edge-disjoint copies of F , implying that δvx > δ.

In particular, there exists a vertex x ∈ V (G) with gcd(F ) | dG(x) such that the edges at
Moreover, let F be any F -collection in G and let H be the subgraph of G consisting
of the edges that are not covered by F. By the above, we have dH (x) ≥ ηdG(x) for all
x ∈ V (G) \ Vχ. Thus, 2e(H) ≥ η(χ − 2 + α)m · (χ − 1)m ≥ η(χ − 2)2m2. Since |G| ≤ χm,
we deduce that e(H) ≥ η(1− 2/χ)2|G|2/2 ≥ η|G|2/18. Thus, δ0+
F > δ, contradicting
the deﬁnition of δ.
(cid:3)

F ≥ δη/18

We will now show how to obtain an approximate cover of the edges at a speciﬁed vertex x.
The following lemma is an easy application of the key lemma. It describes a structure within
which we can cover almost all edges at x with copies of F .
Lemma 14.3. Let F be a χ-chromatic graph and u ∈ V (F ). Let c ∈ Col(F, u) be such that
a1, . . . , as ≥ 1 and as+1, . . . , aχ−1 = 0 for some s ∈ [χ − 1], where ai := |NF (u) ∩ c−1(i)| for
i ∈ [χ − 1].

Let 1/n ≪ ε ≪ α, 1/|F| and suppose that G is a graph with
(i) V (G) = {x} ·∪ V1 ·∪ ··· ·∪ Vχ;
(ii) NG(x) = V1 ∪ ··· ∪ Vs;
(iii) G[Vi, Vj] is ε-regular with density at least α for all 1 ≤ i < j ≤ χ;
(iv) |Vi| = ain for all i ∈ [s];
(v) |Vi| = n for all s < i ≤ χ.

Then there exists an F -collection covering all but at most √εdG(x) edges at x.
Proof. Let t := ⌈(1−√ε)dG(x)/dF (u)⌉. Note that dG(x) = (a1 +··· + as)n = dF (u)n. We
will greedily ﬁnd injective homomorphisms φ1, . . . , φt from F into G such that φ1(F ), . . . , φt(F )
are edge-disjoint, φj(u) = x for all j ∈ [t] and φj(v) ∈ Vc(v) for all j ∈ [t] and v ∈ V (F )\{u}.
Suppose that for some j ∈ [t], we have already found φ1, . . . , φj−1. We now want to ﬁnd φj.
Let H := G − φ1(F ) − ··· − φj−1(F ). Note that for every i ∈ [s], we have

dH (x, Vi) = |Vi| − (j − 1)ai ≥ |Vi| − (1 − √ε)aidG(x)/dF (u) = √ε|Vi| ≥ √εn.

Hence, for every i ∈ [s], we can pick a set V ′
s < i ≤ χ, we can pick a set V ′
know that H[V ′
the key lemma (Lemma 6.5) implies that there exists an embedding φ′
that φ′
v ∈ V (F ) \ {u} yields the desired embedding φj.

i ⊆ NH(x, Vi) of size √εn. Furthermore, for every
i ⊆ Vi of size √εn. By Fact 6.2 and since e(G−H) ≤ ne(F ), we
j ] is ε1/3-regular with density at least α/2 for all 1 ≤ i < j ≤ χ. Therefore,
j : (F − u) → H such
j(v) for all
(cid:3)

c(v) for all v ∈ V (F ) \ {u}. Deﬁning φj(u) := x and φj(v) := φ′

j(v) ∈ V ′

i , V ′

Lemma 14.4. Let F be a graph and 1/n ≪ µ, 1/|F|. Let G be a graph on n vertices with
δ(G) ≥ (1− 1/(χvx(F ) + 1) + µ)n and x ∈ V (G). Then there exists an F -collection covering
all but at most µn edges at x.

To prove Lemma 14.4, we will apply the regularity lemma and consider the corresponding
reduced graph to ﬁnd the structures described in Lemma 14.3. Applying Lemma 14.3 will
then give the desired F -collection.
Proof. Let u be a vertex of F such that χvx := χvx(F ) = (χ − 2)dF (u)/(dF (u) − σ(F, u)).
By deﬁnition, there exists c ∈ Col(F, u) such that σ(F, u) = aχ−1 and a1, . . . , as > 0 and
as+1, . . . , aχ−1 = 0 for some s ∈ [χ − 1], where ai := |NF (u) ∩ c−1(i)| for i ∈ [χ − 1].

48

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

Let H be the complete s-partite graph with class sizes a1, . . . , as and observe that

(14.3)

χcr(H) ≤ χvx.

Choose new constants k0, k′

0 ∈ N and ε, α > 0 such that 1/n ≪ 1/k′

Let A :=Qi∈[s] ai.
0 ≪ ε ≪ α, 1/k0 ≪
µ, 1/|F|. (Then also α, 1/k0 ≪ 1/A.) Suppose that G, n, x are as in the hypothesis. Apply
the regularity lemma (Lemma 6.3) to obtain a partition V0, V1, . . . , Vk of V (G) − x and a
spanning subgraph G′ of G − x satisfying the following:
(R1) k0 ≤ k ≤ k′
0;
(R2) |V0| ≤ εn;
(R3) |V1| = ··· = |Vk| =: L;
(R4) dG′(z) ≥ dG(z) − (α + ε)n for all z ∈ V (G) \ {x};
(R5) G′[Vy] is empty for all y ∈ [k];
(R6) for all 1 ≤ y < y′ ≤ k, G′[Vy, Vy′] is either ε-regular with density at least α or empty;
(R7) for all y ∈ [k], Vy ⊆ NG(x) or Vy ∩ NG(x) = ∅.
By adding some vertices of V (G′) \ V0 to V0 if necessary, we can assume that L is divisible
by A. Let X ⊆ [k] be the set of indices y for which Vy ⊆ NG(x). Let R be the reduced
graph of V1, . . . , Vk with respect to G′, and let Rx := R[X]. By Proposition 6.4, δ(R) ≥
(1− 1/(χvx + 1) + µ/2)k. Firstly, this implies δ(R) ≥ (1− 1/(χ− 1) + µ/2)k. Secondly, since
|X|L ≥ dG(x)−εn and thus |X| ≥ (1−1/(χvx +1))k, we have that δ(Rx) ≥ (1−1/χvx)|X| ≥
(1 − 1/χcr(H))|Rx| by (14.3). Hence, by Theorem 14.1, there exist vertex-disjoint copies
H1, . . . , Ht of H in Rx covering all but at most µ|Rx|/2 vertices.
Ideally we would now like to extend each Hi to a copy of F − u in R so that these copies
are edge-disjoint, and then try to apply the key lemma to the corresponding subgraphs of
G. However, the number of vertices in H is too large for this to work in general. Instead,
we will extend every s-clique in Hi into a χ-clique and then construct (in G) structures
appropriate for Lemma 14.3.

For each j ∈ [t], let Hj,1, . . . , Hj,s be the vertex classes of Hj with |Hj,i| = ai for all i ∈ [s].

Let

A := {ξ = (y1, . . . , ys) : ∃j ∈ [t] so that yi ∈ Hj,i for all i ∈ [s]}.

from Sj∈[t] Hj.

If ξ = (y1, . . . , ys), we write ξ∗ for {y1, . . . , ys}. So for every ξ ∈ A, R[ξ∗] is a clique. We
want to extend each such clique to a clique on χ vertices by attaching additional vertices.
Moreover, we want that all attachments are edge-disjoint. More precisely, for every ξ ∈ A,
we want to ﬁnd a set att(ξ) of χ − s vertices in R such that
(A1) R[ξ∗ ∪ att(ξ)] is a clique on χ vertices;
(A2) the graphs R[att(ξ)] ∪ R[att(ξ), ξ∗] are all pairwise edge-disjoint and edge-disjoint
We will achieve this using Lemma 8.1. First, let R∗ := R−Sj∈[t] Hj and note that δ(R∗) ≥
(1 − 1/(χ − 1) + µ/4)k. Moreover, let K ∗ := Kχ − Kχ[S], where S ⊆ V (Kχ) is of size s.
Clearly, (K ∗, S) is a model and K ∗ has degeneracy at most χ − 1 rooted at S. For every
ξ ∈ A, let Λξ be any bijection from S to {{y} : y ∈ ξ∗}. Hence, Λξ is an R∗-labelling of S.
Now, since |A| ≤ At ≤ Ak and for every y ∈ V (R), |{ξ ∈ A : y ∈ ξ∗}| ≤ A, we can apply
Lemma 8.1 in order to obtain edge-disjoint embeddings (φξ)ξ∈A of K ∗ into R∗ such that φξ
respects Λξ. Thus, we can take att(ξ) := φξ(V (Kχ) \ S). This satisﬁes (A1) and (A2).
We note that we will only need some of the sets att(ξ). For reasons that will become clear
later, we partition Vy for every y ∈ V (R) arbitrarily into A equal-sized parts Vy,1, . . . , Vy,A.
Fix j ∈ [t]. For each i ∈ [s] and y ∈ Hj,i, we can cut Vy into A/ai equal-sized parts in
order to obtain a partition of Sy∈Hj,i
Vy into A parts Wj,i,1, . . . , Wj,i,A of size Lai/A each.
Fix ℓ ∈ [A]. For i ∈ [s], let yj,i,ℓ be the vertex of Hj,i such that Wj,i,ℓ is contained in Vyj,i,ℓ.
We have ξj,ℓ := (yj,1,ℓ, . . . , yj,s,ℓ) ∈ A. Let yj,s+1,ℓ, . . . , yj,χ,ℓ be the elements of att(ξj,ℓ) and

49

then deﬁne Wj,i,ℓ := Vy,ℓ with y = yj,i,ℓ for each s < i ≤ χ. Observe that by (A2), for all
ℓ, ℓ′ ∈ [A],
(A3) R[ξ∗

j′,ℓ′ ∪ att(ξj′,ℓ′)] are edge-disjoint if j 6= j′.

j,ℓ ∪ att(ξj,ℓ)] and R[ξ∗

(But it may happen that ξ∗

j,ℓ ∪ att(ξj,ℓ) = ξ∗

j,ℓ′ ∪ att(ξj,ℓ′) even if ℓ 6= ℓ′.)

Now, for every (j, ℓ) ∈ [t] × [A], let Gj,ℓ be the graph obtained from G′[Si∈[χ] Wj,i,ℓ] by
adding x and all edges from x to Si∈[s] Wj,i,ℓ. As we shall see, the graph Gj,ℓ is the desired

structure to which we can apply Lemma 14.3.

We claim the following:

1 ≤ i < i′ ≤ χ;

(i) (Gj,ℓ)j∈[t],ℓ∈[A] is a family of edge-disjoint subgraphs of G;
(ii) the graphs Gj,ℓ cover all but at most (ε + µ/2)n edges at x in G;
(iii) Gj,ℓ[Wj,i,ℓ, Wj,i′,ℓ] is 2Aε-regular with density at least α/2 for all (j, ℓ) ∈ [t]× [A] and
(iv) |Wj,i,ℓ| = Lai/A for all (j, i, ℓ) ∈ [t] × [s] × [A];
(v) |Wj,i,ℓ| = L/A for all (j, ℓ) ∈ [t] × [A] and s < i ≤ χ.
Firstly, whenever (j, i, ℓ), (j′, i′, ℓ′) ∈ [t] × [s] × [A] are distinct, then Wj,i,ℓ ∩ Wj′,i′,ℓ′ = ∅.
Hence, every edge at x is contained in at most one of the Gj,ℓ. Moreover, xz is covered
whenever z ∈ Vy with y ∈Sj∈[t] V (Hj), implying (ii).
We continue with proving (i). If j 6= j′, then Gj,ℓ and Gj′,ℓ′ are edge-disjoint by (A3). It
remains to check that Gj,ℓ and Gj,ℓ′ are edge-disjoint for ﬁxed j ∈ [t] and distinct ℓ, ℓ′ ∈ [A].
In fact, they are vertex-disjoint (except for x of course). Clearly, Wj,i,ℓ∩Wj,i′,ℓ′ = ∅ whenever
i, i′ ∈ [s]. Moreover, yj,i,ℓ /∈ V (Hj) for i > s since R[att(ξj,ℓ), ξ∗
j,ℓ] is complete bipartite but
also edge-disjoint from Hj. Hence, Wj,i,ℓ ∩ Wj,i′,ℓ′ = ∅ whenever i /∈ [s] and i′ ∈ [s] (and vice
versa). Finally, for i, i′ /∈ [s], Wj,i,ℓ ∩ Wj,i′,ℓ′ = ∅ by our partition of each Vy into A parts.
The size conditions (iv) and (v) follow directly from the deﬁnitions. Moreover, (iii) holds
by (A1) and by Fact 6.2.

Hence, we can apply Lemma 14.3 to each Gj,ℓ in order to ﬁnd edge-disjoint copies of F
covering all but at most √2AεdGj,ℓ(x) edges at x in Gj,ℓ. Thus, by (ii), all but at most
(ε + µ/2 + √2Aε)n ≤ µn edges at x are covered, as desired.

(cid:3)

14.2. Covering all edges. The following lemma is an analogue to Lemma 5.1. It guaran-
tees a ‘near-optimal’ cover of the edges at x.
Lemma 14.5. Let F be a graph and δ := max{1 − 1/(χvx(F ) + 1), δe
F }. Assume that
1/m ≪ µ, 1/|F|. Let G be a graph with δ(G) ≥ (δ + 2µ)|G| and let U1 ⊆ V (G) be such that
|U1| = ⌊µ|G|⌋ and dG(y, U1) ≥ (δ + 3µ)|U1| for all y ∈ V (G). Suppose that U1 ⊇ U2 ⊇ ··· ⊇
Uℓ is a (δ + 4µ, µ, m)-vortex in G[U1] and x ∈ Uℓ. Then there exist edge-disjoint copies of
F covering all edges at x except possibly some edges from x to Uℓ.
Proof. Let γ > 0 be such that 1/m ≪ γ ≪ µ, 1/|F|. We proceed by induction on ℓ. For
ℓ = 0, there is nothing to prove. So assume that ℓ > 0 and that the statement is true for
ℓ − 1.
Let R := U1 \{x}, L := (V (G)\ U1)∪{x} and G′ := G[L]. Note that δ(G′) ≥ (δ + γ)|G′|.
By Lemma 14.4, there exists an F -collection F1 in G′ covering all but at most γ|G′| edges
at x.
Let H be the subgraph of G consisting of all those edges from x to V (G) \ U1 which are
not covered by F1. Let G′′ := G − G[U2] if ℓ ≥ 2 and G′′ := G otherwise. So ∆(H) =
dH (x) ≤ γ|G′| ≤ γ|G′′|. Since dG′′(y, R) ≥ (δ + µ/2)|R| for every y ∈ V (G′′), we can
apply Proposition 5.10 in order to obtain a subgraph A of G′′ such that A[L] is empty,
H ∪ A has an F -decomposition F2 and ∆(A[R]) ≤ µ2|R|/4. By deleting copies of F from
F2 which do not contain any edge of H, we can assume that dA(x) ≤ |F|γ|G|. Hence,
∆(A[U1]) ≤ max{|F|γ|G|, µ2|R|/4 + 1} ≤ µ2|U1|/2.

50

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

If ℓ = 1, this completes the proof.

Note thatSF1 andSF2 are edge-disjoint and together cover all edges from x to V (G)\U1.
If ℓ ≥ 2, then let G′′′ := G[U1] −SF1 −SF2 = G[U1] − A[U1]. Clearly, G′′′[U2] = G[U2],
and so U2 ⊇ U3 ⊇ ··· ⊇ Uℓ is a (δ + 4µ, µ, m)-vortex in G′′′[U2]. Let y ∈ U1. Then dG′′′(y) ≥
dG(y, U1) − µ2|U1|/2 ≥ (δ + 2µ)|U1| and dG′′′(y, U2) ≥ dG(y, U2) − µ2|U1|/2 ≥ (δ + 3µ)|U2|.
By induction, there exists an F -collection F3 covering all edges at x in G′′′ except possibly
some edges from x to Uℓ. Finally, F1 ∪ F2 ∪ F3 covers all edges at x in G except possibly
some edges from x to Uℓ.
(cid:3)

We will now prove an analogue of Theorem 7.1, that is, assuming that we are able to
absorb a small number of leftover edges, we can cover all edges at one vertex. We use the
concept of absorption in the following form.

Given a graph F , a vertex x and a vertex set W , an F -neighbourhood-absorber for (x, W )

is a graph A such that

• W ∪ {x} is an independent set in A;
• A contains an F -collection covering all edges at x;
• A + xW contains an F -collection covering all edges at x, where A + xW is obtained

from A by adding all edges between x and W .

Call F δ-neighbourhood-absorbing if the following is true:

Let 1/n ≪ 1/b ≪ µ, 1/|F| and suppose that G is a graph on n vertices with δ(G) ≥
(δ + µ)n. Let x ∈ V (G) and W ⊆ V (G) \ {x} with |W| = gcd(F ). Then G contains
an F -neighbourhood-absorber for (x, W ) of order at most b.

The following result states that if the minimum degree is suﬃciently large to ensure an
approximate cover of the edges at x, a copy of F covering any edge, and the existence of an
F -neighbourhood-absorber, then we can cover all edges at x by edge-disjoint copies of F .

F}. Then δvx ≤ δ.

Lemma 14.6. Let F be a δ-neighbourhood-absorbing graph and suppose that δ ≥ max{1 −
1/(χvx(F ) + 1), δe
Proof. Let r := gcd(F ) and let 1/n ≪ 1/b ≪ 1/m′ ≪ µ, 1/|F|. Suppose that G is a
graph on n vertices with δ(G) ≥ (δ + 5µ)n and x ∈ V (G) with r | dG(x). We have to
show that there exists an F -collection covering all edges at x. By Lemma 4.3, there exists
a (δ + 4µ, µ, m)-vortex U0 ⊇ U1 ⊇ ··· ⊇ Uℓ in G such that x ∈ Uℓ and ⌊µm′⌋ ≤ m ≤ m′.
neighbourhood-absorber for each (x, Wi).

Let W1, . . . , Ws be an enumeration of all r-subsets of Uℓ \ {x}. We aim to ﬁnd an F -
For this, let G′ := G[(U0 \ U1) ∪ Uℓ] − G[Uℓ] and observe that δ(G′) ≥ (δ + 4µ)|G′|. We
want to ﬁnd edge-disjoint subgraphs A1, . . . , As in G′ such that Ai is an F -neighbourhood-
absorber for (x, Wi) of order at most b. Suppose that for some j ∈ [s], we have already
found A1, . . . , Aj−1. Let Gj := G′ − (A1 ∪ ··· ∪ Aj−1). Clearly, δ(Gj ) ≥ (δ + 3µ)|Gj|. Since
F is δ-neighbourhood-absorbing, Gj contains an F -neighbourhood-absorber for (x, Wj) of
order at most b.

Let Gapp := G − (A1 ∪ ··· ∪ As). Hence, δ(Gapp) ≥ (δ + 2µ)n. Moreover, Gapp[U1] =
G[U1] and so U1 ⊇ U2 ⊇ ··· ⊇ Uℓ is a (δ + 4µ, µ, m)-vortex in Gapp[U1]. Finally, since
∆(A1 ∪ ··· ∪ As) ≤ µ|U1|, we have dGapp(y, U1) ≥ (δ + 3µ)|U1| for all y ∈ V (Gapp). Thus,
by Lemma 14.5, there exists an F -collection F covering all edges x in Gapp except possibly
some going to Uℓ. Let W ⊆ Uℓ be the set of neighbours of x in Gapp −SF. Since r | dG(x)
and r | dAi(x) for all i ∈ [s], we have r | |W|. Hence, there exists a set I ⊆ [s] such that
{Wi : i ∈ I} is a partition of W . For all i ∈ I, let Fi be an F -collection covering all edges
at x in Ai + xWi. For all i ∈ [s] \ I, let Fi be an F -collection covering all edges at x in Ai.
Then, F ∪ F1 ∪ ··· ∪ Fs is an F -collection in G covering all edges at x.
(cid:3)

51

14.3. Absorbing. It remains to investigate the absorbing properties of a given graph F .
In addition to the space barrier for δvx
F given by 1− 1/(χvx(F ) + 1), the following deﬁnition
gives rise to a divisibility-type barrier.

For a graph F with χ(F ) ≥ 3, we deﬁne

(14.4)

θ(F ) := gcd{dF (v, c−1(1)) − dF (v, c−1(2)) : v ∈ V (F ), c ∈ Col(F, v)},

F ≥ 1 − 1/χ.

In Corollary 14.13, we will see that δvx

where we set gcd{0} := 2 for technical reasons only.
Proposition 14.7. If θ(F ) > 1 and χ := χ(F ) ≥ 4, then δvx
Proof. Let r := gcd(F ), m ∈ N and let G be the complete χ-partite graph with vertex
classes V1, . . . , Vχ such that |V1| = rm + 1, |V2| = rm − 1 and |Vi| = rm for all 3 ≤ i ≤ χ.
Let x be a vertex in Vχ. Hence, r | dG(x). Clearly, δ(G) = (1 − 1/χ)|G| − 1.
Suppose that F1, . . . , Ft are edge-disjoint copies of F covering all edges at x. Let aj :=
dFj (x, V1) and let bj := dFj (x, V3). So Pj∈[t] aj = |V1| and Pj∈[t] bj = |V3| and therefore
Pj∈[t](aj − bj) = 1. However, θ(F ) | (aj − bj) for all j ∈ [t], which gives a contradiction.
F ≤ 1− 1/χ(F ) for all graphs F . Hence, if θ(F ) > 1,
then this settles the problem of determining δvx
F for all graphs F that are at least 4-chromatic.
The next proposition will exploit the structural information of graphs F for which θ(F ) = 1.
Let s ∈ N and let F be a graph. Deﬁne CNs(F ) to be the set of all (s − 1)-tuples
(a1, . . . , as−1) such that there exists an [s]-colouring c of F and a vertex v ∈ V (F ) such that
c(v) = s and dF (v, c−1(i)) = ai for all i ∈ [s − 1].
Suppose we are given some graph F with v ∈ V (F ) and an [s]-colouring c of F with
c(v) = s. We say that F ′, v′, c′ are obtained from F by rotating c around v if F ′ is obtained
from s − 1 vertex-disjoint copies F1, . . . , Fs−1 of F by identifying the copies of v into a new
vertex v′, and c′ is deﬁned as follows: Let c′(v′) := s. For every w′ ∈ V (F ′)\{v′}, there is a
unique i ∈ [s − 1] with w′ ∈ V (Fi). Let w ∈ V (F ) be the vertex whose role w′ is playing in
Fi. Deﬁne c′(w′) := ((1, 2, . . . , s− 1)i ◦ c)(w). In other words, we permute the colours of the
colour classes c−1(1), . . . , c−1(s − 1) cyclically amongst the Fi’s such that ultimately every
w ∈ V (F ) \ c−1(s) has exactly one copy in each of the colours 1, . . . , s − 1.

(cid:3)

Clearly, c′ is an [s]-colouring of F ′. Moreover, for each i ∈ [s − 1], we have
dF ′(v′, c′−1(i)) = dF (v, c−1(1)) + ··· + dF (v, c−1(s − 1)) = dF (v).

(14.5)

Proposition 14.8. Let F be a graph and let χ := χ(F ). Then there exists an F -decomposable
graph F ′ and m ∈ N such that (m − 1, m + 1, m, . . . , m), (m, . . . , m) ∈ CNs(F ′), with
s = χ + 1. Moreover, if χ ≥ 3 and θ(F ) = 1, then we can assume that s = χ.
Proof. First, suppose that s = χ + 1. Fix some v ∈ V (F ) and let c be an [s]-colouring of
F with c(v) = s, with c−1(1) ∩ NF (v) 6= ∅ and c−1(2) = ∅. Let m = dF (v) and let F ′, v′, c1
be obtained from F by rotating c around v. Hence, dF ′(v′, c−1
1 (i)) = m for all i ∈ [s − 1] by
(14.5). Note that there is a component of F ′ − v′ in which colour 2 does not appear and at
least one neighbour of v′ is coloured 1. Changing the colour of one of those neighbours to 2
thus gives an [s]-colouring c2 such that dF ′(v′, c−1
2 (2)) = m + 1 and
dF ′(v′, c−1

2 (1)) = m − 1, dF ′(v′, c−1

2 (i)) = m for all i ∈ {3, . . . , s − 1}.

Now, assume that s = χ ≥ 3 and θ(F ) = 1. By the deﬁnition of θ(F ), there exist (not

necessarily distinct) v1, . . . , vt ∈ V (F ) and ci ∈ Col(F, vi) for i ∈ [t] such that

t

(dF (vi, c−1

i

Xi=1

(1)) − dF (vi, c−1

i

(2))) = 1.

52

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

This implies that there are vertex-disjoint copies F1, . . . , Ft of F , vi ∈ V (Fi) and ci ∈
Col(Fi, vi) for i ∈ [t] such that
Xi=1

dFi(vi, c−1

dFi(vi, c−1

(1)) = 1 +

(2)).

t

Xi=1

t

i

i

into a new vertex v′′. Clearly, F ′′

Let F ′′ be obtained by identifying v1, . . . , vt
decomposable. Moreover, c1, . . . , ct induce a colouring c′′ ∈ Col(F ′′, v′′) with d1 := dF ′′(v′′, c′′−1(1)) =
dF ′′(v′′, c′′−1(2)) + 1. Let m := dF ′′(v′′) and let F ′, v′, c1 be obtained from F ′′ by rotating
c′′ around v′′. Hence, dF ′(v′, c−1
1 (i)) = m for all i ∈ [s − 1] by (14.5). Note that there is
a collection of components of F ′ − v′ such that d1 neighbours of v′ are coloured 1 in the
union of these components and d1 − 1 neighbours of v′ are coloured 2 in the union of these
components. Hence, exchanging the colours 1 and 2 among all the vertices in those com-
ponents gives an [s]-colouring c2 such that dF ′(v′, c−1
2 (2)) = m + 1
and dF ′(v′, c−1
(cid:3)

2 (1)) = m − 1, dF ′(v′, c−1

is F -

2 (i)) = m for all i ∈ {3, . . . , s − 1}.

The following proposition gives a construction of a neighbourhood-absorber for (x, W )

where W is a subset of a single class in an s-partite graph.

Proposition 14.9. Let F be a graph with r := gcd(F ) and assume that there exists an F -
decomposable graph F ′ and m, s ∈ N with s ≥ 3 such that (m−1, m+1, m, . . . , m), (m, . . . , m) ∈
CNs(F ′). Then, for every b ∈ N, there exists a graph T and an [s]-colouring c of T such
that T is an F -neighbourhood-absorber for (x, W ), where W ⊆ c−1(1) is of size br and
x ∈ c−1(s).
Proof. Let F1, . . . , Ft be vertex-disjoint copies of F and vi ∈ V (Fi) such thatPt
i=1 dFi(vi) ≡
br mod (s − 1)m. Let F ′′ be obtained by identifying v1, . . . , vt into a new vertex x. Let c′′
be an [s]-colouring of F ′′ such that c′′(x) = s. We may assume that dF ′′(x, c′′−1(1)) ≥ br.
Let W ⊆ NF ′′(x, c′′−1(1)) be of size br and let F ′′′ be obtained from F ′′ by deleting the
edges from x to W . So F ′′ = F ′′′ + xW .
For i ∈ [s − 1],
i=1 ai. Let ¯a :=
(Ps−1
i=1 ai)/(s − 1), let I + := {i ∈ [s − 1] : ai > ¯a} and I − := {j ∈ [s − 1] : aj < ¯a}. Deﬁne

:= dF ′′′(x, c′′−1(i)). Hence, (s − 1)m | Ps−1
p := Xi∈I +

(ai − ¯a) = Xj∈I −

(¯a − aj).

let ai

It is easy to see that there exist non-negative integers (bi,j)i∈I +,j∈I − such that

(i) for each i ∈ I +, Pj∈I − bi,j = ai − ¯a;
(ii) for each j ∈ I −, Pi∈I + bi,j = ¯a − aj.
X(i,j)∈I +×I −

Note that

(14.6)

bi,j = p.

Since (m − 1, m + 1, m, . . . , m) ∈ CNs(F ′), there exists an [s]-colouring c∗ of F ′ and
u ∈ V (F ′) such that c∗(u) = s, dF ′(u, c∗−1(1)) = m − 1, dF ′(u, c∗−1(2)) = m + 1 and
1 , . . . , F i,j
dF ′(u, c∗−1(i)) = m for all i ∈ {3, . . . , s − 1}. For every (i, j) ∈ I + × I −, let F i,j
bi,j
be disjoint copies of F ′ with new vertices. Let T ′ be the graph obtained from F ′′′ and
(F i,j

k )i∈I +,j∈I −,k∈[bi,j] by identifying the copy of u in each F i,j
We now deﬁne a colouring c′ of T ′. For every v ∈ V (F ′′′), let c′(v) := c′′(v). For every
v ∈ V (T ′) \ V (F ′′′), there are unique i ∈ I +, j ∈ I −, k ∈ [bi,j] such that v ∈ V (F i,j
k ). Let
w be the vertex of F ′ whose role v is playing in F i,j
k . Let φ be a permutation on [s] such
that φ(1) = i, φ(2) = j and φ(s) = s. Deﬁne c′(v) := (φ ◦ c∗)(w). So c′ colours V (F i,j
k )
such that m − 1 neighbours of x are coloured i, m + 1 neighbours of x are coloured j, and

k with x ∈ V (F ′′′).

m neighbours of x are coloured ℓ for each ℓ ∈ [s − 1] \ {i, j}. Clearly, c′ is an [s]-colouring
of T ′ with c′(x) = s. Moreover, for every i ∈ I +, we have
= ai + pm + Xj∈I − −bi,j

dT ′(x, c′−1(i))

(i)
= pm + ¯a

(14.6)

53

by the choice of bi,j. Similarly, for all j ∈ I −,

dT ′(x, c′−1(j))

(14.6)

= aj + pm + Xi∈I +

(ii)
= pm + ¯a.

bi,j

Finally, if i /∈ I + ∪ I −, then ai = ¯a and thus dT ′(x, c′−1(i)) = pm + ¯a as well.
Note that m | ¯a and let q := p + ¯a/m. For every i ∈ [s − 1], let Vi,1, . . . , Vi,q be a
partition of NT ′(x, c′−1(i)) into parts of size m. For j ∈ [q], let Uj := V1,j ∪ ··· ∪ Vs−1,j and
let ˆFj be a copy of F ′ and cj an [s]-colouring of ˆFj such that V ( ˆFj) ∩ V (T ′) = {x} ∪ Uj,
(x) = Uj and such that cj agrees with c′ on {x} ∪ Uj. This is possible since
such that N ˆFj
(m, . . . , m) ∈ CNs(F ′). We may assume that the ˆFj’s only intersect in x.
Let T := T ′ ∪ ˆF1 ∪···∪ ˆFq. Hence, c := c′ ∪ c1 ∪···∪ cq is an [s]-colouring of T . Moreover,
ˆF1, . . . , ˆFq cover all edges at x in T , and F ′′, (F i,j
k )i∈I +,j∈I −,k∈[bi,j] cover all edges at x in
T + xW .
(cid:3)

Lemma 14.10. Let F be a graph and assume that there exists an F -decomposable graph F ′
and m, s ∈ N such that (m− 1, m + 1, m, . . . , m), (m, . . . , m) ∈ CNs(F ′), where s ≥ 4. Then
F is max{δe

F , 1 − 1/(s − 1)}-neighbourhood-absorbing.

The idea to prove Lemma 14.10 is as follows. If δ(G) ≥ (1− 1/(s− 1) + µ)|G|, then we can
ﬁnd a complete s-partite graph H B with vertex classes B1, . . . , Bs such that x ∈ Bs. Now,
if we had W ⊆ B1, then Proposition 14.9 would allow us to ﬁnd the desired neighbourhood-
absorber as a subgraph of H B. Suppose now that W is not contained in H B. So our aim is
to ‘move’ W to B1. To achieve this, we will use the colouring properties of F ′. (We have seen
in Proposition 14.8 that such graphs F ′ exist.) Suppose for example that A, B, D3, . . . , Ds
are disjoint sets of vertices and w ∈ W , bw ∈ B such that G[A ∪ {w}, B, D3, . . . , Ds−1, Ds]
is a complete s-partite graph and x has m neighbours in each of A, B, D3, . . . , Ds−1. We
can then ‘move’ w to bw as follows: If we do not need to cover xw, we can embed a copy
of F ′ such that all edges from x to A, B, D3, . . . , Ds−1 are covered, thereby covering bw.
If we intend to cover xw, then we can embed a copy F ′
w of F ′ containing x such that
w (x, B) = m − 1, leaving the edge xbw uncovered. In order
dF ′
to ﬁnd these ‘movers’, we will use the regularity lemma. However, for this to work, we
would need that w is a ‘typical’ vertex, which we cannot assume. We will therefore use the
deﬁnition of δe

w (x, A ∪ {w}) = m + 1 and dF ′

F to ‘move’ each w ∈ W to some ‘typical’ vertex ﬁrst.

Let δ := max{δe

F , 1 − 1/(s − 1)} and r := gcd(F ). By
Proof of Lemma 14.10.
Proposition 14.9, there exist graphs T1, . . . , T|F | such that Tt admits an [s]-colouring ct and
is an F -neighbourhood-absorber for (zt, Wt), where Wt ⊆ c−1
t (s).
Let M := r|F ′|2 + max{|T1|, . . . ,|T|F ||}.
0 ≪ ε ≪ α, 1/k0, 1/b ≪ µ, 1/|F|. Since M only depends on F we
may also assume that α, 1/k0, 1/b ≪ 1/M . Suppose that G is a graph on n vertices with
δ(G) ≥ (δ + µ)n. Let x ∈ V (G) and W = {w1, . . . , wr} ⊆ V (G) \ {x}. We will ﬁnd an
F -neighbourhood-absorber for (x, W ) in G of order at most b.
Apply the regularity lemma (Lemma 6.3) to obtain a partition V0, V1, . . . , Vk of V (G) and

t (1) is of size tr and zt ∈ c−1

Let 1/n ≪ 1/k′

a spanning subgraph G′ of G satisfying the following:
(R1) k0 ≤ k ≤ k′
0;
(R2) |V0| ≤ εn;
(R3) |V1| = ··· = |Vk| =: L;

54

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

1, . . . , y∗

s}] is a copy of Ks.

(R4) dG′(z) ≥ dG(z) − (α + ε)n for all z ∈ V (G);
(R5) G′[Vy] is empty for all y ∈ [k]
(R6) for all 1 ≤ y < y′ ≤ k, G′[Vy, Vy′] is either ε-regular with density at least α or empty.
(R7) for all y ∈ [k], Vy ⊆ NG(x) or Vy ∩ NG(x) = ∅.
Let R be the reduced graph of V1, . . . , Vk and let σ be the corresponding cluster function.
By Proposition 6.4, δ(R) ≥ (δ + µ/4)k ≥ (1 − 1/(s − 1) + µ/4)k.
Let X ⊆ [k] be the set of indices y for which Vy ⊆ NG(x) and let Rx := R[X]. Since
|X|L ≥ dG(x) − εn and thus |X| ≥ (1 − 1/(s − 1))k, we have that δ(Rx) ≥ (1 − 1/(s −
s ∈ [k] such that Y ∗ :=
2) + µ/4)|Rx|. Therefore, there exist y∗
R[{y∗
1, . . . , y∗
Let G′′ be obtained from G′ by removing, for every i ∈ [r], all edges from wi to all clusters
Vj with dG′(wi, Vj) < αL. Then we still have δ(G′′) ≥ (δ + µ/2)n. Using the deﬁnition of
δe
F , it is straightforward to ﬁnd copies F1, . . . , Fr of F with the following properties:
(F1) V (Fi) \ {x, wi} ⊆ V (G) \ V0 and xwi ∈ E(Fi) and E(Fi) \ {xwi} ⊆ E(G′′);
(F2) F1, . . . , Fr intersect only in x.
Let U := (V (F1) ∪ ··· ∪ V (Fr)) \ ({x} ∪ W ) and Nx := (NF1(x) ∪ ··· ∪ NFr (x)) \ W . Let
t := |Nx|/r and note that t ≤ |F|. Clearly, σ(u) is deﬁned for every u ∈ U , and if u ∈ Nx,
then σ(u) ∈ X. Consider any u ∈ Nx. In Rx, every s− 2 vertices have a common neighbour.
Since s ≥ 4, there exists a common neighbour uC of σ(u) and y∗
1 in Rx. Moreover, there exist
u+
3 , u−
s }] and
s }] are s-cliques. By the deﬁnition of G′′, if u ∈ NFi(wi) \ {x},
Y −
u := R[{uC, y∗
then

s−1 ∈ X and u+
3 , . . . , u−

u := R[{σ(u), uC , u+

s ∈ [k] such that Y +

s−1 ∈ X and y∗

s−1, u−
1, u−

3 , . . . , u+

3 , . . . , u+

s , u−

(14.7)

dG(wi, Vσ(u)) ≥ dG′′(wi, Vσ(u)) ≥ αL/2.

Hence, by applying the key lemma (Lemma 6.5) with suitable candidate sets, we can
ﬁnd a subgraph H in G′′ whose vertex set can be partitioned into sets (Au)u∈U , B1, . . . , Bs,
(Cu)u∈Nx, (D+
u,j)u∈Nx,j∈{3,...,s} which satisfy the following (see Fig-
ure 5):
(H1) for all u ∈ U , Au ⊆ Vσ(u), for all j ∈ [s], Bj ⊆ Vy∗

, for all u ∈ Nx and j ∈ {3, . . . , s},

u,j)u∈Nx,j∈{3,...,s} and (D−

j

Cu ⊆ VuC , D+

u,j ⊆ Vu+

j

, D−

u,j ⊆ Vu−

j

;

(H2) all those sets are independent in H and V (H) ∩ ({x} ∪ W ) = ∅;
(H3) H[Au, Au′] is complete bipartite whenever u, u′ ∈ U with uu′ ∈ E(Fi) for some
(H4) H +
u,s] are complete

u := H[B1, Cu, D−

u,s] and H −

u,3, . . . , D−

u,3, . . . , D+

i ∈ [r];
u := H[Au, Cu, D+
s-partite for every u ∈ Nx;

(H5) H B := H[B1, . . . , Bs] is complete s-partite;
(H6) Au ⊆ NG(wi) if u ∈ NFi(wi) \ {x};
(H7) |Au| = 1 for all u ∈ U \ Nx;
(H8) all sets (Au)u∈Nx, Cu, D+
(H9) |Bj| = M for j ∈ [s].
So H +
to ensure (H6) we use (14.7). Also, we do not require that u ∈ Au.
and W in a suitable way. Note that (H1) implies that
(H10) (Bj)j∈[s−1], (Au)u∈Nx, (Cu)u∈Nx, (D+

u,j have cardinality |F ′|;
u arises from Y −

u arises from the clique Y +

u,j, D−

u , H −

u , and H B arises from Y ∗. Note that

We now describe how to construct a neighbourhood-absorber A from H by attaching x

u,j)u∈Nx,j∈{3,...,s−1}, (D−

u,j)u∈Nx,j∈{3,...,s−1} are

contained in NG(x).

For every u ∈ Nx and j ∈ {3, . . . , s − 1}, let A′
be such that |A′
element of A′
be disjoint subsets of B1 of size m + 1 and ﬁx some bu ∈ B′

u,j ⊆ D−
u| = 2m. Moreover, let au be some
u)u∈Nx
u for each u ∈ Nx. Deﬁne

u. For every u ∈ U \ Nx, let au be the unique element of Au. Let (B′

u,j| = m and |C ′

u ⊆ Cu, D+′

u,j| = |D−′

u ⊆ Au, C ′

u| = |D+′

u,j ⊆ D+

u,j, D−′

u,j

55

F1

w1

w2

F2

u1

Au1

x

u2

Au2

D+

u1 ,3

D+

u1 ,4

D+

u2 ,3

D+

u2 ,4

Cu1

Cu2

D−

u1 ,3

D−

u2 ,3

D−

u1 ,4

B1

B2

D−

u2 ,4

B3

B4

Figure 5. An example illustrating the construction of H for F = C5, r = 2, s = 4. Note
that Nx = {u1, u2}. The four singleton sets Au for u ∈ U \ Nx are not shown in the ﬁgure.

W ′ := {bu : u ∈ Nx}. So |W ′| = |Nx| = tr. Let T ′′ be a subgraph of H B and z ∈ Bs such
that T ′′ is an F -neighbourhood-absorber for (z, W ′) and NT ′′(z) ∩ B′
u = ∅ for all u ∈ Nx.
(So we might choose T ′′ to be a copy of the graph Tt deﬁned at the beginning of the proof.)
Let A be the graph obtained from H by adding x and W and the following edges: For
every i ∈ [r], add the edge from wi to au for all u ∈ NFi(wi) \ {x}. For every u ∈ Nx and
j ∈ {3, . . . , s − 1}, add all edges from x to A′
u. Moreover, add all edges
from x to NT ′′(z). By (H10) and (H6), A is a subgraph of G. Moreover, A has order at
most b and {x} ∪ W is independent in A. Let T ′ be obtained from T ′′ by replacing z with
x. So T ′ is an F -neighbourhood-absorber for (x, W ′).
u,1, C ′
u,2 be a partition
u into two sets of sizes

We claim that A is an F -neighbourhood-absorber for (x, W ). Let C ′
u,− be a partition of C ′

u into two sets of size m and let C ′

u,j, D−′

u,+, C ′

u, D+′

u,j, B′

u, C ′

u,3 ∪ ··· ∪ D+′

u,s−1 for some v ∈ D+′

of C ′
m + 1, m − 1.
The edges at x in A can be covered by edge-disjoint copies of F as follows: Let u ∈ Nx.
Since (m, . . . , m) ∈ CNs(F ′), there exists a copy F ′
(v) =
u,s. Exchanging v with x yields a copy of F ′
A′
u ∪ C ′
u . Similarly,
that covers all edges from x to NF ′
u,2 ∪ D−′
there exists a copy F ′
u,3 ∪
··· ∪ D−′
u . This can be done for all u ∈ Nx
without interference. This way, all edges at x in A are covered except the ones that have
an endpoint in NT ′(x) ∪Su∈Nx{bu} = NT ′(x) ∪ W ′. Finally, these edges can be covered by
V (Fi)\{x, wi}. Then F ′

The edges at x in A+xW can be covered by edge-disjoint copies of F as follows: Let Ui :=
1, . . . , F ′
r

(v) and otherwise uses only edges inside H +
u \ {bu}) ∪ C ′

edge-disjoint copies of F since T ′ is an F -neighbourhood-absorber for (x, W ′).

i := A[{x, wi}∪Su∈Ui{au}]+xwi is a copy of F . Moreover, F ′

u,s−1 and otherwise uses only edges inside H −

u,− of F ′ that covers all edges from x to (B′

u,1 ∪ D+′

u,+ of F ′ in H +

u such that NF ′

u,+

u,+

56

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

are edge-disjoint subgraphs of A + xW and cover the edges from x to W ∪Su∈Nx{au}. Let
u ∈ Nx. Since (m − 1, m + 1, m, . . . , m) ∈ CNs(F ′), there exists a copy of F ′ that covers
all edges from x to (A′
u,s−1 and otherwise uses only edges
u,3 ∪ ··· ∪ D−′
inside H +
and otherwise uses only edges inside H −
can be covered by edge-disjoint copies of F .

u,s−1
u . Finally, by deﬁnition of T ′, the edges at x in T ′
(cid:3)

u , and a copy of F ′ that covers all edges from x to C ′

u,3 ∪ ··· ∪ D+′

u \ {au}) ∪ C ′

u,+ ∪ D+′

u,− ∪ B′

u ∪ D−′

The next lemma analyses the bipartite case. We want to establish that δvx

F = 0 if F
contains a bridge, and δvx
F = 1/2 otherwise. The results leading to the near-optimal cover
include the bipartite case. It only remains to determine the absorbing properties of a given
bipartite graph F .

Lemma 14.11. Let F be bipartite and r := gcd(F ). Then F is 1/2-neighbourhood-absorbing.
Moreover, if F contains a bridge, then F is 0-neighbourhood-absorbing.
Proof. Let uz ∈ E(F ) and assume that this edge is a bridge if one exists. Let d∗ :=
dF (u). There exist (not necessarily distinct) vertices v1, . . . , vt ∈ V (F ) such that D :=
Pt
i=1 dF (vi) ≡ −r mod d∗. We may assume that D ≥ r(d∗ − 1). Moreover, let δ := 1/2 if
F contains no bridge and δ := 0 otherwise.
Let 1/n ≪ 1/b ≪ µ, 1/|F|. Since D only depends on F , this means that 1/b ≪ 1/D.
Suppose that G is a graph on n vertices with δ(G) ≥ (δ + µ)n. Let x ∈ V (G) and W =
{w1, . . . , wr} ⊆ V (G) \ {x}. We will ﬁnd an F -neighbourhood-absorber for (x, W ) in G of
order at most b.
Suppose that δ = 1/2. We can use the regularity lemma to ﬁnd disjoint sets B1, . . . , Br, Bx
of size (D +r)|F| each in V (G)\({x} ∪ W ) such that Bx ⊆ NG(x) and G[Bi, Bx] is complete
bipartite and Bi ⊆ NG(wi) for all i ∈ [r].
Let A be the graph obtained from Sr
i=1 G[Bi, Bx] by adding {x} ∪ W , all edges from wi
to Bi for all i ∈ [r], and exactly D edges from x to Bx. Clearly, {x} ∪ W is independent in
A and A has order at most r + 1 + (r + 1)(D + r)|F| ≤ b.
Moreover, the edges at x in A can be covered by edge-disjoint copies of F . Indeed, since
dA(x) = D =Pt
i=1 dF (vi), we can let x play the roles of v1, . . . , vt and use edges of A[Bx, B1]
In order to see that all edges at x in A + xW can be covered, partition NA(x) into sets
N1, . . . , Nr+1, where |Ni| = d∗ − 1 for all i ∈ [r]. It follows that d∗ | |Nr+1|. Now, for every
i ∈ [r], we can cover the edge xwi with a copy Fi of F such that x, wi play the roles of u, z
and NFi(x) = Ni ∪ {wi}. The edges from x to Nr+1 can also be covered by letting x play
the role of u in every copy, and using edges of A[Bx, B1] otherwise.
The case δ = 0 is very similar. Using the Erd˝os-Stone theorem, we can ﬁnd disjoint
sets B1, . . . , Br, Bx and B′
x of size (D + r)|F| each in V (G) \ ({x} ∪ W ) such
that Bi ⊆ NG(wi) and G[Bi, B′
i] is complete bipartite for each i ∈ [r], and Bx ⊆ NG(x) and
i=1 G[Bi, B′
G[Bx, B′
i]
by adding {x}∪ W , all edges from wi to Bi for all i ∈ [r], and exactly D edges from x to Bx.
That A is the desired neighbourhood-absorber follows analogously to the above case.
(cid:3)

x] is complete bipartite. Let A be the graph obtained from G[Bx, B′

x]∪Sr

1, . . . , B′

otherwise.

r, B′

We can now combine our previous results. We make use of the following simple bounds

on δe
F .

Fact 14.12. Let F be a graph. Then

(i) δe
(ii) δe

F ≤ 1 − 1/χ(F );
F = 0 if F is bipartite and contains a bridge.

Indeed (i) and (ii) follow easily using the regularity lemma and the key lemma. In general,
F . This also seems an interesting

it seems very diﬃcult to give an explicit formula for δe
problem in its own right. Recall that θ(F ) was deﬁned in (14.4).

Corollary 14.13. Let F be a graph with χ := χ(F ) and χvx := χvx(F ).

57

(i) δvx

F ≤ 1 − 1/χ;

(ii) if F is bipartite, then δvx

F =(0
F =(1 − 1/χ

1/2

if F contains a bridge;
otherwise;

(iii) if χ ≥ 4, then δvx

max{1 − 1/(χvx + 1), δe
F }

if θ(F ) > 1;
if θ(F ) = 1.
Proof. By Proposition 14.8 and Lemmas 14.10 and 14.11, F is max{δe
absorbing. Then, Lemma 14.6 implies that δvx
Fact 14.12(i) and (14.2), the general upper bound for δvx

F stated in (i) follows.
Moreover, if every edge of F is contained in a cycle, it is easy to see that δvx

F}. By
F ≥ 1/2,
where an extremal example consists of two disjoint cliques with one edge joining the cliques.
Hence, if F is bipartite, then δvx
F = 1/2 if F contains no bridge. Otherwise, by Lemma 14.11,
Lemma 14.6 and Fact 14.12(ii), δvx

F ≤ max{1 − 1/χ, 1 − 1/(χvx + 1), δe
F ≥ δe

F = 0.
Now, if χ ≥ 4 and θ(F ) > 1, then δvx

that θ(F ) = 1. Then, by Proposition 14.8 and Lemma 14.10, F is max{δe
neighbourhood-absorbing. Lemma 14.6 thus implies that

F = 1 − 1/χ by Proposition 14.7 and (i), so suppose
F , 1 − 1/(χ − 1)}-

F , 1−1/χ}-neighbourhood-

δvx
F ≤ max{δe

F , 1 − 1/(χ − 1), 1 − 1/(χvx + 1)}
F = max{δe

Hence, by Proposition 14.2, we have δvx

(14.2)

= max{δe

F , 1 − 1/(χvx + 1)}.

F , 1 − 1/(χvx + 1)}.

(cid:3)

We are now ready to prove Theorem 1.1.

Proof of Theorem 1.1.
lary 14.13(i).

Firstly, note that (i) follows from Theorem 12.4 and Corol-

To prove (ii), suppose that χ ≥ 5. By Theorem 12.4, we have δF ∈ {max{δ0+
F ∈ {1− 1/(χvx(F ) + 1), δe

1/χ, 1− 1/(χ + 1)}. By Corollary 14.13(iii), we have δvx
Since δ0+
max{δ0+
F}, 1 − 1/χ}, implying (ii).

F ≥ 1 − 1/(χvx(F ) + 1) by Proposition 14.2 and since δvx
F , δvx

F } ∈ {max{δ0+

F ≥ δe

F , δvx
F }, 1 −
F , 1− 1/χ}.
F , it follows that

F , δe

Finally, (iii) follows from (ii) Corollary 11.4.

(cid:3)

15. Concluding remarks

We conclude this paper with some ﬁnal remarks.

In the light of Theorem 1.1, for all
graphs F with χ(F ) ≥ 3 the limiting factor in giving good explicit bounds on δF are now
the bounds available in the literature for δ∗
F . The original aim of this project was to be
able to determine from the value of δ∗
F the value of δF . This we come close to achieving
when χ(F ) ≥ 5, showing that δF is either δ∗
F or one of only two other values. We note
that, in order to determine which of these values δF takes, it is left only to determine
the minimum d for which there exists an augmented d-compressible (C4)F -switcher and an
augmented d-compressible (K2,gcd(F ))F -switcher (see Section 10). Furthermore, in the light
of the proof of Lemma 10.1, it is suﬃcient to ask what the minimum d is such that the
following holds: There exists some n0 such that any F -divisible balanced d-partite graph
with at least dn0 vertices and which is missing at most e(F )2 edges (say) between vertex
classes is F -decomposable. In other words, if δF is not equal to δ∗
F , then there will exist
extremal graphs which are extremely close to large complete χ(F )-partite or (χ(F ) + 1)-
partite graphs.

Finally, we brieﬂy consider the case when χ := χ(F ) ∈ {3, 4}. When χ ≥ 5, we re-
duced ﬁnding an F -decomposition to constructing two diﬀerent augmented switchers, be-
fore showing that the smallest minimum degree ratio above which we can construct these
switchers takes one of three values: 1 − 1/(χ − 1), 1 − 1/χ or 1 − 1/(χ + 1) (see Sec-
tion 10). This result concerning augmented switchers also holds when χ ∈ {3, 4}, but

58

S. GLOCK, D. K ¨UHN, A. LO, R. MONTGOMERY AND D. OSTHUS

δF may not be large enough to perform the reductions from augmented switchers to un-
augmented switchers. We have no version of the ‘discretisation lemma’ (Lemma 10.1) for
unaugmented switchers, and therefore get no ‘discretisation result’ for δF here, only an
upper bound (Theorem 1.1(i)). Furthermore, it seems likely that the smallest minimum de-
gree ratio above which these unaugmented switchers appear can take many diﬀerent values
outside of {1 − 1/(χ − 1), 1 − 1/χ, 1 − 1/(χ + 1)}, and therefore we do not expect a simple
‘discretisation lemma’ to hold in this case. Due to this, we suspect that there exist graphs
F with χ(F ) = 3 and graphs F with χ(F ) = 4 for which Theorem 1.1(ii) and (iii) do not
hold, but to show this there remains much work to do in giving good bounds on δ∗
F .

References

[1] B. Barber, D. K¨uhn, A. Lo, R. Montgomery and D. Osthus, Fractional clique decompositions of dense

graphs and hypergraphs, arXiv:1507.04985, 2015.

[2] B. Barber, D. K¨uhn, A. Lo and D. Osthus, Edge-decompositions of graphs with high minimum degree,

Adv. Math. 288 (2016), 337–385.

[3] B. Barber, D. K¨uhn, A. Lo, D. Osthus and A. Taylor, Clique decompositions of multipartite graphs and

completion of Latin squares, arXiv:1603.01043, 2016.

[4] D. Bryant and N.J. Cavenagh, Decomposing graphs of high minimum degree into 4-cycles, J. Graph

Theory 79 (2015), 167–177.

[5] D. Dor and M. Tarsi, Graph decomposition is NPC - a complete proof of Holyer’s conjecture, In STOC
’92 Proceedings of the twenty-fourth annual ACM symposium on Theory of computing, pages 252–263,
1992.

[6] F. Dross, Fractional triangle decompositions in graphs with large minimum degree, SIAM J. Discrete

Math. 30 (2016), 36–42.

[7] P. Dukes, Rational decomposition of dense hypergraphs and some related eigenvalue estimates, Linear

Algebra Appl. 436 (2012) 3736–3746. [Corrigendum: Linear Algebra Appl. 467 (2015) 267–269.]
[8] P. Dukes, Fractional triangle decompositions of dense 3-partite graphs, arXiv:1510.08998, 2015.
[9] T. Gustavsson. Decompositions of large graphs and digraphs with high minimum degree, PhD thesis,

Univ. of Stockholm, 1991.

[10] P.E. Haxell and V. R¨odl, Integer and fractional packings in dense graphs, Combinatorica 21 (2001),

13–38.

[11] S. Janson, T.  Luczak, and A. Ruci´nski, Random graphs, Wiley-Interscience Series in Discrete Mathem-

atics and Optimization. Wiley-Interscience, New York, 2000.
[12] P. Keevash, The existence of designs, arXiv:1401.3665, 2014.
[13] T.P. Kirkman, On a problem in combinatorics, Cambridge Dublin Math. J. 2 (1847), 191–204.
[14] F. Knox, D. K¨uhn and D. Osthus, Edge-disjoint Hamilton cycles in random graphs, Random Structures

Algorithms 46 (2015), 397–445.

[15] J. Koml´os, Tiling Tur´an problems, Combinatorica 20 (2000), 203–218.
[16] R. Montgomery, Fractional clique decompositions of dense partite graphs, arXiv:1603.01039, 2016.
[17] C.St.J.A. Nash-Williams, An unsolved problem concerning decomposition of graphs into triangles, In

Combinatorial Theory and its Applications III, pages 1179–183, North Holland, 1970.

[18] R. Raman. The power of collision: randomized parallel algorithms for chaining and integer sorting, In
Foundations of software technology and theoretical computer science (Bangalore, 1990), volume 472 of
Lecture Notes in Comput. Sci., pages 161–175. Springer, Berlin, 1990.

[19] A. Shokoufandeh and Y. Zhao, Proof of a tiling conjecture of Koml´os, Random Structures Algorithms 23

(2003), 180–205.

[20] R.M. Wilson, Decompositions of complete graphs into subgraphs isomorphic to a given graph, In Pro-
ceedings of the Fifth British Combinatorial Conference (Univ. Aberdeen, Aberdeen, 1975), pages 647–659,
Congressus Numerantium, No. XV, Utilitas Math., Winnipeg, Man., 1976.

[21] R. Yuster, The decomposition threshold for bipartite graphs with minimum degree one, Random Struc-

tures Algorithms 21 (2002), 121–134.

[22] R. Yuster, Asymptotically optimal Kk-packings of dense graphs via fractional Kk-decompositions, J.

Combin. Theory Ser. B 95 (2005), 1–11.

[23] R. Yuster, H-packing of k-chromatic graphs, Mosc. J. Comb. Number Theory 2 (2012), 73–88.
[24] R. Yuster, Edge-disjoint cliques in graphs with high minimum degree, SIAM J. Discrete Math. 28 (2014),

893–910.

Stefan Glock†, Daniela K¨uhn†, Allan Lo†, Richard Montgomery∗, Deryk Osthus†

59

†School of Mathematics
University of Birmingham
Edgbaston
Birmingham
B15 2TT
UK

∗Trinity College
Cambridge
CB2 1TQ
UK

E-mail addresses: [sxg426,d.kuhn,s.a.lo,d.osthus]@bham.ac.uk,
r.h.montgomery@dpmms.cam.ac.uk

