6
1
0
2

 
r
a

M
8

 

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
5
5
3
2
0

.

3
0
6
1
:
v
i
X
r
a

Arithmetic Central Extensions

and

Reciprocity Laws for Arithmetic Surface

K. Sugahara and L. Weng

Abstract

Three types of reciprocity laws for arithmetic surfaces are estab-
lished. For these around a point or along a vertical curve, we ﬁrst
construct K2 type central extensions, then introduce reciprocity sym-
bols, and ﬁnally prove the law as an application of Parshin-Beilinson’s
theory of adelic complex. For reciprocity law along a horizontal curve,
we ﬁrst introduce a new type of arithmetic central extensions, then
apply our arithmetic adelic cohomology theory and arithmetic inter-
section theory to prove the related reciprocity law.

All this can be interpreted within the framework of arithmetic cen-
tral extensions. We add an appendix to deal with some basic structures
of such extensions.

Contents

1 Introduction

2 Reciprocity Laws in Dimension Two

2.1 Arithmetic Adelic Complex . . . . . . . . . . . . . . . . . . .
2.2 Numerations in terms of Arakelov intersection . . . . . . . . .
2.2.1 Case I . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.2 Case II
. . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Numerations in terms of arithmetic adelic cohomology . . . .
2.3.1 Case I . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . .
2.3.2 Case II
. . . . . . . . . . . .

2.4 Arithmetic Central Extension k(X)∗

W ar
OX

2.5 Splitness . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.6 Reciprocity Symbols from Points and Curves
. . . . . . . . .
2.7 Proof of Reciprocity Laws . . . . . . . . . . . . . . . . . . . .
2.8 End of Proof
. . . . . . . . . . . . . . . . . . . . . . . . . . .

2

5
5
6
6
8
11
11
13
15

17
18
19
20

1

1

Introduction

About 50 years ago, Tate [13] developed a theory of residues for curves us-
ing traces and adelic cohomologies. Tate’s work was integrated with the K2
central extensions by Arbarello-De Concini-Kac [1]. Reciprocity laws for al-
gebraic surfaces were established by Parshin in [10]. Later, these reciprocity
laws were reproved by Osipov [6], based on Kapranov’s dimension theory [5].
Osipov constructs dimension two central extensions and hence establishes
the reciprocity law for algebraic surfaces using Parshin’s adelic theory [9].
More recently, a categorical proof of Parshin’s reciprocity law was found by
Osipov-Zhu [8]. In essence, Osipov’s construction may be viewed as K2 type
theory of central extensions developed by Brylinski-Deligne [3].

However, to establish reciprocity laws for arithmetic surfaces, algebraic
K2 theory of central extensions is not suﬃcient: while it works for reciprocity
laws around points and along vertical curves, it fails when we treat horizontal
curves. To remedy this, instead, we ﬁrst develop a new theory of arithmetic
central extensions, based on the fact that for exact sequence of metrized
R-vector saces of ﬁnite dimensional

V ∗ :

0 → V 1 → V 2 → V 3 → 0,

there is a volume discrepancy γ(V ∗). Accordingly, for an R-vector space V ,
not necessary to be ﬁnite dimensional, a subspace A, and commensurable
subspaces B, C, following [1], we have the group

GL(V, A)(V, A) := {g ∈ Aut(V ) : A ∼ gA},

the R-line

(A|B) := λ(A/A ∩ B)∗ ⊗ λ(B/A ∩ B),

and the natural contraction isomorphism

α := αA,B,C : (A|B) ⊗ (B|C) ≃ (A|C).

Note that A/A ∩ B and B/A ∩ B are ﬁnite dimensional R-spaces, we hence
can introduce metrics on them and hence obtaining the metrized R-line
(A|B).
In general, the contraction map αA,B,C of (4.3) of [1] does not
give an isometry. We denote the corresponding discrepancy by γ(αA,B,C)
and hence the isometry αA,B,C := αA,B,C · γ(αA,B,C ) so that we obtain a
canonical isometry

α := αA,B,C : (A|B) ⊗ (B|C) ∼= (A|C).

In parallel, for a pair of commensurable (metrized) subspaces A, B and
A′, B′, the natural isomorphism β introduced in ’4.4) of [1] induced a canon-
ical isometry

βA,B;A′,B′ : (A|B) ⊗ (A′|B′) −→ (A ∩ A′|B ∩ B′) ⊗ (A + A′|B + B′).

2

The up-shot of this consideration then leads to the following construction of
ar
arithmetic central extension \GL(V, A)

of GL(V, A) is given by

ar
\GL(V, A)

:=n(g, a) : g ∈ GL(V, A), a ∈ (A|gA), a 6= 0o

together with the multiplication

(g, a) ◦ (g′, a′) := (gg′, a ◦ g(a′))

where

ab := a ◦ b := αA,B,C(a ⊗ b) ∈ (A|C)

∀a ∈ (A|B), b ∈ (B|C).

Our ﬁrst result is the following analogue of

Proposition A.

(1) (cid:0) \GL(V, A)

ar

, ◦, (e, 1)(cid:1) forms a group;

(2) There is a canonical central extension of groups

1 → R∗

ar
ι−→ \GL(V, A)

π−→ GL(V, A) → e.

ar
Consequently, for elements (g, a), (h, b) ∈ \GL(V, A)

, their commutator

is given by

[(g, a), (h, b)] =(cid:0)[g, h], a ◦ g(b) ◦ (ghg−1)(a−1) ◦ [g, h](b−1).

In particular, from Theorem A(2), we have, if g and h commute,

hg, hi := hg, hiA := a ◦ g(b) ◦ ghg−1(a−1) ◦ [g, h](b−1) ∈ R∗.

We will show that hg, hi is well-deﬁned. Moreover, we have the following

Proposition B. (Arithmetic Reciprocity Law) Let A, B be two sub-
spaces of V . For g, h ∈ GL(V, A) ∩ GL(V, B), we have

β(cid:0)hg, hiA ⊗ hg, hiB(cid:1) = hg, hiA∩B ⊗ hg, hiA+B .

In particular, if g and g commutes, we have

hg, hiAhg, hiB = hg, hiA∩Bhg, hiA+B .

As a special case, if we assume that the metric system is rigid, that is to

say, as to be deﬁned in §?, we then recover the constructions of [1].

To go further, we consider the local ﬁeld R((t)) of Laurent series with
R coeﬃcients. For each ﬁnite dimensional sub-quotient space of R((t)), we
i=m Rti for suitable integer

may identify it with a standard form Vm,n :=Pn

3

νL : K2(L) → Z,

(f, g) 7→(cid:12)(cid:12)(cid:12)(cid:12)

ν1(f ) ν1(g)

ν2(f ) ν2(g)(cid:12)(cid:12)(cid:12)(cid:12) .

m, n ∈ Z. We assign a metric on Vm,n based on the standard Eulidean metric
of R with (ti, tj) = δij, ∀m ≤ i, j ≤ n. Then, for any f (t), g(t) ∈ R((t)), if

we write f (t) = tνt(f )f0(t), g(t) = tνt(g)g0(t), then (cid:0)f (t) R[[t]](cid:12)(cid:12) g(t) R[[t]](cid:1)

can be explicitly calculated. As a direct consequence, we have

νR((t))(f, g) := loghf, giR[[t] = log

|f0(0)νt(g)|
|g0(0)νt(f )|

.

The pairing hf, giR[[t] is in fact the reciprocity symbol along horizontal
curve at inﬁnity. To introduce reciprocity symbol at ﬁnite places, we start
with corresponding 2 dimensional local ﬁelds L, kL((u)), kL{{u}} with kL
ﬁnite extensions of QP . On L, there exists a discrete valuation of rank 2:
(ν1, ν2) : L∗ → Z ⊕ Z. With the help of this, then we can deﬁne a reciprocity
symbol

With all this, we are now ready to state our reciprocity laws. Let π :
X → SpecOF be a regular arithmetic surface deﬁned over a number ﬁeld F
with generic ﬁber XF . Let C be an irreducible curve on X and x a closed
point of X. As usual, see e.g., [10], we obtain an Artinian ring KC,x which is
a ﬁnite direct sum of two dimensional local ﬁelds Li. Accordingly, we deﬁne

νC,x := ⊕i[ki : Fq] · νLi.

Our main theorem of this paper is the following

Main Theorem. ( Reciprocity Law for Arithmetic Surfaces)

(1) For a ﬁxed point x ∈ X,

XC: x∈C

νC,x(f, g) = 0,

∀f, g ∈ k(X)∗,

where C run over all irreducible curves on X which pass through x;

(2) For a ﬁxed vertical prime divisor V on X,

Xx: x∈V

νV,x(f, g) = 0,

∀f, g ∈ k(X)∗,

where x run over all closed points of X which lie on V ;

(3) For a ﬁxed Horizontal prime divisor EP on X corresponding an alge-
braic point P on XF . For each inﬁnite place σ of F , denote by Pσ,j
be corresponding closed points on XFσ . Then

Xx: x∈EP

νEP ,x(f, g)·log qx+Xσ Xj

Nσ·νPσ,j (f, g) = 0,

∀f, g ∈ k(X)∗.

4

Our proof of this theorem is as follows:

for the ﬁrst two, similar as
in [6], we ﬁrst construct a K2-central extension of k(X)∗ with the help of
Kapranov’s dimension theory, then we interpret νC,x as a commutator of
lifting of elements in some K2 central extension of the group K(X)∗, and
ﬁnally use the splitting of the central extension of adeles.

During this process, we discover that the fundamental reason for our
reciprocity law along a vertical curve is the Riemann-Roch in dimension one
and the intersection in dimension two. With the help of this, with a bit
struggle, we ﬁnally can establish the reciprocity law for horizontal curves
with a new construction of arithmetic central extension, arithmetic inter-
section in dimension two and a reﬁned arithmetic Riemann-Roch theorem
for arithmetic curves under the frame work of our arithmetic adelic theory
built up in [11].

2 Reciprocity Laws in Dimension Two

2.1 Arithmetic Adelic Complex

Let P be an algebraic point of XF . Denote by EP the corresponding prime
horizontal divisor of X, IEP the ideal sheaf of EP ⊂ X, and EP its arith-
metic compactiﬁcation. Let F be a coherent sheaf on X. We introduce an
arithmetic adelic complex Aar

(F) by

EP ,∗

Aar

EP ,∗(F) := lim
−→
n

lim
←−

m: m≥n

Aar

X,∗(F ⊗ I n

EP(cid:14)I m

EP ),

where Aar
Since Aar

X,∗ denotes the arithmetic adelic functor introduced in §1.2.3 of [11].
(F) is deﬁned over an inﬁnitesimal neighborhood of horizontal

EP ,∗

curve EP in X, the complex consists of three terms. For example, when L
is an invertible sheaf, a direct calculation implies that Aar
(L) is given by

EP ,∗

[k(X)EP

×(cid:16) Yx∈EP(cid:0)Bx ⊗ bOX,x

L(cid:1) ×(cid:0)BP ⊗ bOX,x
where Bx := OEP ,x((u)), BP = OXF(cid:12)(cid:12)P ((u)) and Aar

That is, its elements are given by a = (ax)x∈EP
isfying that, for any ﬁxed i, (aix)x∈EP
curve EP . In particular, Aar

(OX ) is given by

EP

Lb⊗QR(cid:1)(cid:17) −→ Aar
:=Q′
\k(EP )x((u)).
, where ax = Pi ai,xui sat-

x∈EP

EP

is an usual adele of the arithmetic

EP ,∗

[k(X)EP

×(cid:0) Yx∈EP

OEP ,x((u)) × OXF(cid:12)(cid:12)P ((u))b⊗QR(cid:1) −→Y′

x∈EP

\k(EP )x((u)).

Consequently, if we ﬁx a non-zero rational section s of L such that s does

not vanish on EP , we may write L|EP as OEP (Px nx[x]) and write LF :=

5

mQ[Q] = div(s|XF ). Accordingly, we obtain a complex

mQ[Q]). Here Px nx[x] = div(s|EP ) and

L|XF as LF = OXF (PQ∈XF
PQ∈XF
[k(X)EP

m

×(cid:16) Yx∈EP

−nx

EP ,x((u)) × YQ∈XF

OXF (Q)⊗mQ(cid:12)(cid:12)P ((u))b⊗QR(cid:17)

−→Y′

x∈EP

\k(EP )x((u)).

Similarly, for a diﬀerent non-zero section s′ of L such that s does not vanish
Q[Q]).

m′

on EP , we may write L|EP = OEP (Px n′
Hence, we have the corresponding complex
EP ,x((u)) × YQ∈XF
[k(X)EP

×(cid:16) Yx∈EP

−n′
x

m

x[x]) and LF = OXF (PQ∈XF
Q(cid:12)(cid:12)P ((u))b⊗QR(cid:17)
OXF (Q)⊗m′
−→Y′

x∈EP

\k(EP )x((u)).

2.2 Numerations in terms of Arakelov intersection

2.2.1 Case I

To count it, for the non-zero rational section s of L as above, we set

For a metrized line bundle L on X, set

W ar

Bx ⊗ bOX,x

L :=(cid:16) Yx∈EP
EP ,x((u))(cid:17) ×(cid:16) YQ∈XF

−nx

m

W ar

L,s :=(cid:16) Yx∈EP

Similarly, for the section s′ as above, we get

W ar

L,s′ :=(cid:16) Yx∈EP

m

−n′
x

EP ,x((u))(cid:17) ×(cid:16) YQ∈XF

L(cid:17) ×(cid:16)BP ⊗ bOX,x
Lb⊗QR(cid:17).
OXF (Q)⊗mQ(cid:12)(cid:12)P ((u))b⊗QR(cid:17)
× e(cid:16)ZX∞
Q(cid:12)(cid:12)P ((u))b⊗QR(cid:17)
× e(cid:16)ZX∞

OXF (Q)⊗m′

− log kskdµ(cid:17).

− log ks′kdµ(cid:17).

In particular, for a metrized line bundle L1 satisfying L1 ֒→ L with a non-
zero rational section s1 of L1 which does not vanish along EP , we have

W ar

L,s(cid:14)W ar

L1,s1

=(cid:16) Yx∈EP

m

−nx+n1,x
EP ,x

×(cid:16) YQ∈XF

((u))(cid:17)
OXF (Q)⊗mQ−m1Q(cid:12)(cid:12)P ((u))b⊗QR(cid:17)

× e(cid:16)ZX∞

− log

ksk
ks1k1

dµ(cid:17).

6

To numerate them, we use Arakelov intersection [4]. Let g(P, Q) be the
Rrakelov-Green function and G(P, Q) = eg(P.Q). Then we introduce the
following

Deﬁnition 1.

(1) num0(cid:0)mEP ,x(cid:1) := − log qx;

(2) num0(cid:0)OXF (Q)|P(cid:1) := g(Q, P );
(3) num0(cid:0)OEP ,x[[u]](cid:14)unOEP ,x[[u]] := n;
(4) num0(cid:0)OXF ,P [[u]](cid:14)umOXF ,P [[u]] := m.

Proposition 1. Let L1, resp. L, be a motorized line bundle on X satisfying
1, resp. s and s′, be two non-zero rational sections
L ֒→ L1. And let s1 and s′
of L1, resp. of L, which do not vanish along EP . There exist canonical
isometries of metrized R-torsors

Num(cid:0)W ar
L1,s1(cid:14)W ar

L,s(cid:1) ∼= Num(cid:0)W ar
L,s′(cid:1),
L,s(cid:1) ∼= Num(cid:0)W ar

L1,s′

Num(cid:0)W ar

L,s′(cid:1).
1(cid:14)W ar

Proof. With the construction above, our proof for two isometries are similar.
We here only give the details for the ﬁrst one. Clearly, the numerations for
the Laurent series parts of both sides are the same, we only need to deal
with the coeﬃcient part of both side. Hence, it suﬃces to show that

m

−nx

num0(cid:16)(cid:16) Yx∈EP
= num0(cid:16)(cid:16) Yx∈EP

EP ,x(cid:17) ×(cid:16) YQ∈XF
EP ,x(cid:17) ×(cid:16) YQ∈XF

−n′
x

m

OXF (Q)⊗mQ(cid:12)(cid:12)P b⊗QR(cid:17) × e(cid:16)ZX∞
Q(cid:12)(cid:12)P b⊗QR(cid:17) × e(cid:16)ZX∞

OXF (Q)⊗m′

− log kskdµ(cid:17)(cid:17)
− log ks′kdµ(cid:17)(cid:17).

By deﬁnition, the left hand side is equal to the logarithm of

Yx∈EP

qnx

x YQ∈XF

G∞(P, div(sF )) · e(cid:16)ZX∞

− log kskdµ(cid:17),

which, by the Arakelov intersection theory [4], is simply equal to degar(L|EP
c1,ar(L) · EP . Similarly, the right hand side is equal to the logarithm of

) =

Yx∈EP

qn′

x

x YQ∈XF

G∞(P, div(s′

F )) · e(cid:16)ZX∞

− log ks′kdµ(cid:17),

which is also equal to degar(L|EP

).

Deﬁnition 2. For metrized line bundles Li with non-zero rational sections
si, s′
i (i=1, 2), which do not vanish along EP , we deﬁne a metrized R-torsor

L1,s1(cid:12)(cid:12)W ar
(cid:2)W ar
L1,s1(cid:12)(cid:12)W ar
(cid:2)W ar

L2,s2(cid:3)2 by
L2 ,s2(cid:3)2 := lim←−

(L,s)

L֒→L1,L2

HomR(cid:16)Num(cid:0)W ar

L1,s1(cid:14)W ar

L,s(cid:1), Num(cid:0)W ar

L1,s2(cid:14)W ar

L,s(cid:1)(cid:17).

7

Proposition 2. With the same notation as above, we have a natural isom-
etry of metrized R-torsors

L1,s1(cid:12)(cid:12)W ar
1(cid:12)(cid:12)W ar
(cid:2)W ar
L2,s2(cid:3)2 =(cid:2)W ar
L1(cid:12)(cid:12)W ar
In particular, the space (cid:2)W ar
L2(cid:3)2 is well-deﬁned.

L1,s′

L2,s′

Proof. This is a direct consequence of the following calculation

2(cid:3)2.

L1,s1(cid:12)(cid:12)W ar
(cid:2)W ar

L2,s2(cid:3)2

= lim
←−
(L,s)

L֒→L1,L2

∼= lim
←−
′
,s′)

(L

HomR(cid:16)Num(cid:0)W ar
HomR(cid:16)Num(cid:0)W ar

L1,s1(cid:14)W ar
1(cid:14)W ar

L,s(cid:1), Num(cid:0)W ar
,s′(cid:1), Num(cid:0)W ar

L,s(cid:1)(cid:17)
L1,s1(cid:14)W ar
,s′(cid:1)(cid:17)
2(cid:14)W ar

L1,s′

L2,s′

′
L

′
L

( by the second isometry of Prop. 1 above)

L′֒→L1,L2

=(cid:2)W ar

L1,s′

1(cid:12)(cid:12)W ar

L2,s′

2(cid:3)2

2.2.2 Case II

Next, more generally, we deal with arbitrary non-zero rational sections s of
L, which may vanish along EP .

Let f0 be a non-zero rational function such that = s·f −1

s does not vanish

along EP . In particular, it makes sense for us to talk about W ar

.

L,s0

To construct W ar
L,s

, write s = s0 · uνEP (s) · f0 with f0 a rational function
and s0 a section of the line bundle L0 := L(−νEP (s)·EP ). There is a natural
metric on L0 obtained as the tensor of L and the νEP (s)-th tensor power of
OX (EP ), namely, L1 := L(−νEP (s)EP ). Our idea of constructing W ar
is
L,s
to use the ‘existence’ of a natural decomposition

W ar

L,s = W ar

L0,s0

⊗ W

⊗νEP (s)
OX (EP ),u

⊗ WOX ,f0

.

Since s0 and f0 do not vanish along EP , the spaces W ar
make sense. Therefore, to construct W ar
L,s
it suﬃces to deﬁne WOX (EP ),u which we write simply as WEP ,u.

and WOX ,f0
for a general non-zero section s,

L0,s0

With the discussion of Case I above in mind, in particular, the role
of Arakelov intersection, to construct WEP ,u, we ﬁrst recall the Arakelov
adjunction formula. Let Kπ be the canonical divisor of arithmetic surface
π : X → Y := Spac OF . Set EP = SpecA. Then, see e.g., Cor. 5.5 at p.99
of [4], we have, globally,

Kπ · EP + E

2
P = dEP /Y + dλ(EP ).

8

Here

(a) dλ(EP ) =Pσ∈S∞ Nσdg,σ(EP ) with dg,σ(EP ) :=Pi≤j g(Pi, Pj) where

{Pi} are the collection of conjugating points on the Riemann surface
Xσ corresponding to the algebraic point P of XF ; and

(b) dEP /Y = − log (WEP /Y : OF ), where WEP /R is the dualizing module

of EP over Y , deﬁned by the fractional ideal of F (P )

WEP /Y := {b ∈ F (P ) : Tr(bA) ⊂ OF }.

For later use, we write WEP /Y :=Qx∈EP

m

bx
EP ,x.

Moreover, by reside theorem, i.e., Theorem 4.1 of Chapter IV in [4], we

know that the natural residue map induces a canonical isomorphism

res : Kπ(EP )|EP ≃ W e

EP /Y ,

EP /Y denotes the sheaf on aﬃne curve EP associated to the A-

where W e
module WEP /Y .

I above, W ar

EP ,u

Now we are ready o deﬁne W ar

. As in the deﬁnition of WL,s in Case

admits a natural decomposition:

EP ,u

W ar

EP ,u = W ﬁn

EP ,u × W ∞

EP ,u · e(cid:16)cEP(cid:17).

It is too naive to set

W ﬁn

EP ,u = Yx∈EP

u · OEP ,x((u)) × YQ∈XF

uνP (f )OXF |P ((u)).

A bit thought in terms of Arakelov intersection, in particular, the adjunction
formula and the associated residue theorem, leads to the use of the formula

W ar

EP ,u ⊗ WKπ,ω0

= W ar

Kπ(EP ).

Here ω0 is a certain non-zero rational section of Kπ which does not vanish
along EP . Since, by the residue theorem recalled above, Kπ(EP )|EP =
W e

EP /Y , accordingly, we deﬁne

W ﬁn

W ∞

EP ,u := Yx∈EP
EP ,u := YQ∈XF
:=ZX∞

cEP

u · m

bx−νx(ω0|EP )
EP ,x

((u)),

u · OXF(cid:0)Q(cid:1)⊗−νQ(ω0|XF )(cid:12)(cid:12)P ((u))b⊗QR,

log kω0kdµ − dλ(EP ).

9

Such deﬁned, using the adjunction formula and the residue theorem again,
we have

num0(cid:16) Yx∈EP

m

× YQ∈XF

bx−νx(ω0|EP )
EP ,x

·OXF(cid:0)Q(cid:1)⊗−νQ(ω0|XF )(cid:12)(cid:12)Pb⊗QR
· e(cid:0)ZX∞
log kω0kdµ − dλ(EP )(cid:1)(cid:17)
= − dEP /Y + Kπ · EP − dλ(EP ) = Kπ · EP −(cid:0)Kπ + EP(cid:1) · EP

=EP · EP .

All in all, we are ready to introduce the following

Deﬁnition 3. Let L be a motorized line bundle on X with s a non-zero
rational section. With respect to a decompose s = s0 · uνEP (s) · f0, we deﬁne

EP ,u(cid:1)⊗νP (fs) ⊗ W ar

L⊗E

⊗−νP (fs)
P

,f0s0

.

W ar

L,s :=(cid:0)W ar
(cid:16)νP (fs) EP + c1,ar(cid:0)L ⊗ E

Then the numeration of the coeﬃcient part is equal to

⊗−νP (fs)
P

(cid:1) + c1,ar(OX )(cid:17) · EP = c1,ar(L) · EP .

Hence we have proved the following

Theorem 3. For any non-zero rational sections s and s′ of L, we have

Num(cid:0)W ar

L,s(cid:1) ∼= Num(cid:0)W ar
L,s′(cid:1).

In particular, we may write Num(cid:0)W ar

L,s(cid:1) simply as Num(cid:0)W ar
L (cid:1).

Consequently, we may introduce the following

Deﬁnition 4. For metrized line bundles Li with non-zero rational sections
si, s′

i of Li (i=1, 2), we deﬁne a metrized R-torsor (cid:2)W ar
L1,s1(cid:12)(cid:12)W ar
L1,s1(cid:14)W ar
(cid:2)W ar

HomR(cid:16)Num(cid:0)W ar

L2,s2(cid:3)2 := lim

L1,s1(cid:12)(cid:12)W ar
L,s(cid:1), Num(cid:0)W ar

L2,s2(cid:3)2 by
L1,s2(cid:14)W ar

←−
(L,s)

L,s(cid:1)(cid:17).

L֒→L1,L2

With the same proof as that for Proposition 2 in §2.2.1, we have proved

the following

Theorem 4. With the same notation as above, we have a natural isometry
of metrized R-torsors

L1,s1(cid:12)(cid:12)W ar
1(cid:12)(cid:12)W ar
L2,s2(cid:3)2 =(cid:2)W ar
(cid:2)W ar
L1(cid:12)(cid:12)W ar
L2(cid:3)2 is well-deﬁned.
In particular, the space (cid:2)W ar

L1,s′

L2,s′

2(cid:3)2.

10

2.3 Numerations in terms of arithmetic adelic cohomology

2.3.1 Case I

With the numeration in terms of intersection developed, next we introduce
a numeration in terms of one dimensional cohomology theory. As we will
see later reciprocity laws for arithmetic surfaces then can be proved using
our reﬁned arithmetic Riemann-Roch theorem [11] or better [12].

Proposition 5. Let L be a metrized invertible sheaf on X and s is a non-
zero rational section of L. Assume that s does not vanish along EP , then
the cohomology groups of the complex Aar

(L, s) is given by

EP ,∗

H 0(cid:0)Aar
H 1(cid:0)Aar

EP ,∗(L, s)(cid:1) =H 0
EP ,∗(L, s)(cid:1) =H 1

ar(cid:0)EP , L|EP(cid:1)((u)),
ar(cid:0)EP , L|EP(cid:1)((u)).

Proof. This is a direct consequence of arithmetic adelic cohomology theory
developed in [11]. Indeed, for the invertible sheaf L, by the deﬁnition of the
complex Aar

(L, s), its cohomology is given by

EP ,∗

lim
−→
n

lim
←−

m: m≥n

H i

ar(EP , L ⊗ I n

i = 0, 1.

This then already implies H 0(cid:0)Aar
H 1(cid:0)Aar

ar(cid:0)EP , L|EP(cid:1)((u)). To prove
ar(cid:0)EP , L|EP(cid:1)((u)), we use the fact that, for horizontal

(L)(cid:1) = H 1

EP ,∗

EP ,∗

curve EP , the maps

EP ),

EP(cid:14)I m
(L)(cid:1) = H 0

ϕl,n;m : H 1

ar(EP , L ⊗ I n

EP ) −→ H 1

ar(EP , L ⊗ I l

EP(cid:14)I m

EP(cid:14)I m

EP )

are all injective, since Parshin-Beilinson’s H 0(EP , ·) is exact. (In fact, since
EP is aﬃne, Parshin-Beilinson’s H 1(EP , ·) is always 0.)

Accordingly, we obtain two metrized R-torsors

Num(cid:0)H 0(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1)

and

Num(cid:0)H 1(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1).

Deﬁnition 5. For metrized line bundle L on X and a non-zero rational
section s of L which does not vanish along EP , we deﬁne a metrized R-

EP ,∗

(L, s)(cid:1) by setting
torsor Num(cid:0)Aar
Num(cid:0)Aar
:=HomR(cid:16)Num(cid:0)H 1(cid:0)Aar

EP ,∗(L, s)(cid:1)

To go further, we need the following

11

EP ,∗(L, s)(cid:1)(cid:1), Num(cid:0)H 0(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1)(cid:17).

Deﬁnition 6. We introduce a canonical numeration num0 by

ar(cid:0)EP , L|EP(cid:1)(cid:1) := h0
ar(cid:0)EP , L|EP(cid:1)(cid:1) := h1

(1) num0(cid:0)H 0
(2) num0(cid:0)H 1
(3) num0(cid:0)A[[u]](cid:14)unA[[u]] := n · num0(A) for any numerable locally com-

ar(cid:0)EP , L|EP(cid:1);
ar(cid:0)EP , L|EP(cid:1);

pact space A

With all this, we are now ready to prove the following

Theorem 6. Let Li be metrized line bundle on X and si be a non-zero
rational section of Li which does not vanish along EP (i=1,2). There is a
canonical isometry of metrized R-torsors

L1,s1(cid:12)(cid:12)W ar
(cid:2)W ar

L2,s2(cid:3)2

∼= HomR(cid:16)Num(cid:0)Aar

EP ,∗(L1, s1)(cid:1), Num(cid:0)Aar

EP ,∗(L2, s2)(cid:1)(cid:17).

Proof. It suﬃces to identify special numerations in both sides canonically.
Note that, for them, the Laurent series parts work in the same way, it suﬃces
to treat their coeﬃcient parts. From Prop ???, we know that num0 for the
left hand side gives

degar(cid:0)(L1 − L2)|EP(cid:1).

(∗)

To complete the proof, it suﬃces to notice that num0 for the coeﬃcient part

of Num(cid:0)Aar

EP ,∗

(L1, s1)(cid:1) equals
ar(cid:0)EP , L1|EP(cid:1) − h0

h1

ar(cid:0)EP , L1|EP(cid:1)
) = − degar(cid:0)(L1)|EP(cid:1) −
Similarly, num0 for the coeﬃcient part of Num(cid:0)Aar

= − χar(EP , L1|EP

EP ,∗

h1

ar(cid:0)EP , L2|EP(cid:1) − h0

= − χar(EP , L2|EP

ar(cid:0)EP , L2|EP(cid:1)
) = − degar(cid:0)(L2)|EP(cid:1) −

1
2

log |∆k(P )|.

(L2, s2)(cid:1) equals

1
2

log |∆k(P )|.

Therefore, the num0 for the coeﬃcient part of the right hand gives

−(cid:16) − degar(cid:0)(L1)|EP(cid:1) −

1
2

log |∆k(P )|(cid:17) +(cid:16) − degar(cid:0)(L2)|EP(cid:1) −

1
2

log |∆k(P )|(cid:17)

= degar(cid:0)(L1 − L2)|EP(cid:1).
L1,s1(cid:12)(cid:12)W ar

(∗∗)
This coincides with the canonical numeration num0 for the coeﬃcient of

L2,s2(cid:3)2 obtained using Arakelov intersection given in

the space (cid:2)W ar

(∗).

12

2.3.2 Case II

With above discussion on special rational sections, next we treat arbitrary
non-zero rational sections. Let then s be a non-zero rational section of L
and write s = s0uνP (fs)f0 with s0 a rational section of L(−νP (fs)EP ), f0 a
rational function on X which does not vanish along EP . Then, by deﬁnition,

W ar

L,s =(cid:0)W ar
EP ,u(cid:1)⊗νP (fs) ⊗ W ar
ar(cid:0)Aar

EP ,∗

(L, s)(cid:1)(cid:1), i = 0, 1, we use the complex

⊗−νP (fs)
P

,s0

⊗ W ar

OX ,f0

.

L⊗E

And to calculate H i

k(X)∗ × W ar
L,s

ϕ
−→ Aar
EP

.

Here, if we write div(s0f0|EP ) = Px n0,x[x], div(s0f0|XF ) = PQ m0,Q[Q],

by deﬁnition,

W ar

Consequently, H 0

H 0

ar(cid:0)Aar

EP ,∗

m

((u))

uνP (s) · m

νP (s)(bx−νx(ω0|EP ))−n0,x
EP ,x

uνP (s) · OXF(cid:0)Q(cid:1)−νP (s)νQ(ω0|XF )+m0,Q(cid:12)(cid:12)P ((u))

L,s = Yx∈EP
× YQ∈XF
· e(cid:16)ZX∞(cid:0)νP (s) log kω0k − log ks0f0k(cid:1)dµ + νP (s)dλ(EP )(cid:17).
ar(cid:0)Aar
(L, s)(cid:1)(cid:1) = Ker(ϕ) which can be described as
EP ,∗(L, s)(cid:1)(cid:1)
=uνP (s) Yx∈EP
× YQ∈XF
· e(cid:16)ZX∞(cid:0)νP (s) log kω0k − log ks0f0k(cid:1)dµ + νP (s)dλ(EP )(cid:17)((u)),
(L, s)(cid:1)(cid:1) = Coker(ϕ), whose
(L, s)(cid:1)(cid:1), i = 0, 1 are ind-pro topology spaces induced

G(cid:0)Q, P(cid:1)−νP (s)νQ(ω0|XF )+m0,Q

νP (s)(bx−νx(ω0|EP ))−n0,x
EP ,x

ar(cid:0)Aar

ar(cid:0)Aar

EP ,∗

and the corresponding quotient space H 1
explicit description we leave to the reader. (See e.g. §1.2.4 of [11].)

EP ,∗

from Laurent series with coeﬃcients numerable locally compact spaces, con-
sequently, we obtain two metrized R-torsors

Num(cid:0)H 0(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1)

and

Num(cid:0)H 1(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1).

As it stands, unlike in Def. 5, it is not easy to describe the numerations
for the coeﬃcient parts of them separately under num0. However, their
diﬀerence can be treated well. For this we introduce the following

13

Since H i

Deﬁnition 7. For metrized line bundle L on X and a non-zero rational

section s of L, we deﬁne a metrized R-torsor Num(cid:0)Aar

EP ,∗

EP ,∗(L, s)(cid:1)

Num(cid:0)Aar
:=HomR(cid:16)Num(cid:0)H 1(cid:0)Aar

EP ,∗(L, s)(cid:1)(cid:1), Num(cid:0)H 0(cid:0)Aar

(L, s)(cid:1) by setting
EP ,∗(L, s)(cid:1)(cid:1)(cid:17).

Lemma 7. With the same notation as above, the canonical numeration
).

num0 for the coeﬃcient part of Num(cid:0)Aar

(L, s)(cid:1) is simply −χar(cid:0)EP , L|EP

EP ,∗

Proof. Indeed, by deﬁnition, the quantity we seek is equal to the negative
of

m

νP (s)(bx−νx(ω0|EP ))−n0,x
EP ,x

χar(cid:16)EP , Yx∈EP
× YQ∈XF
· e(cid:16)ZX∞(cid:0)νP (s) log kω0k − log ks0f0k(cid:1)dµ + νP (s)dλ(EP )(cid:17)(cid:17).

G(cid:0)Q, P(cid:1)−νP (s)νQ(ω0|XF )+m0,Q

That is,

−(cid:16)νP (s)dEP /Y − νP (s) · c1,ar(Kπ) · EP + νP (s)dλEP

+(cid:0)c1,ar(L) − νP EP(cid:1) · EP(cid:17) +
= −(cid:16)νP (s)(cid:0)c1,ar(Kπ) + EP(cid:1) · EP − νP (s) · c1,ar(Kπ) · EP
+(cid:0)c1,ar(L) − νP EP(cid:1) · EP(cid:17) +

(by the residue theorem and deﬁnition)

1
2

log |∆k(P )|

1
2

log |∆k(P )|

(by the adjunction formula)

1
2

log |∆k(P )|

= − c1,ar(L) · EP +

= − χar(cid:0)EP , L|EP

)

(by the Riemann-Roch formula).

With all this, we are now ready to prove the following

Theorem 8. Let Li be metrized line bundle on X and si be a non-zero
rational section of Li
(i=1,2). There is a canonical isometry of metrized
R-torsors

L1,s1(cid:12)(cid:12)W ar
(cid:2)W ar

L2,s2(cid:3)2

∼= HomR(cid:16)Num(cid:0)Aar

EP ,∗(L1, s1)(cid:1), Num(cid:0)Aar

EP ,∗(L2, s2)(cid:1)(cid:17).

14

Proof. It suﬃces to identify special numerations in both sides canonically.
Note that, for both sides, the Laurent series parts work in the same way, it
suﬃces to treat their coeﬃcient parts. From our proof of Prop 3. and Thm.
4, we know that num0 for the left hand side gives

degar(cid:0)(L1 − L2)|EP(cid:1).
(L1, s1)(cid:1) gives −χar(EP , L1|EP

To complete the proof, it suﬃces to notice that num0 for the coeﬃcient part
). Indeed, similarly, num0 for
). There-

(∗)

EP ,∗

of Num(cid:0)Aar
the coeﬃcient part of Num(cid:0)Aar
−(cid:16) − degar(cid:0)(L1)|EP(cid:1) +

1
2

EP ,∗

(L2, s2)(cid:1) gives −χar(EP , L2|EP
log |∆k(P )|(cid:17) +(cid:16) − degar(cid:0)(L2)|EP(cid:1) +

1
2

fore, the num0 for the coeﬃcient part of the right hand gives

log |∆k(P )|(cid:17)

= degar(cid:0)(L1 − L2)|EP(cid:1).
L1,s1(cid:12)(cid:12)W ar

(∗∗)
This coincides with the canonical numeration num0 for the coeﬃcient of

L2,s2(cid:3)2 obtained using Arakelov intersection given in

the space (cid:2)W ar

(∗).

2.4 Arithmetic Central Extension k(X)∗

W ar
OX

To deﬁne arithmetic central extension k(X)∗
of f ∈ k(X)∗ on W ar
OX

. Assume for the time being that f does not vanish

along EP . Set div(f |EP ) =Px nx[x], div(f |XF ) =PQ mQ[Q]. In terms of

pure algebraic structures involved,

, we ﬁrst consider the action

W ar
OX

W ar

OX = Yx∈EP

OEP ,x((u)) × YQ∈XF

OXF ,Q|P ((u)).

Thus, algebraically,

f · W ar

OX = Yx∈EP

m

−nx

EP ,x((u)) × YQ∈XF

OXF (Q)mQ |P ((u)).

Accordingly, arithmetically, we deﬁne the action of f on W ar
OX

by

f W ar
OX

:= Yx∈EP

m

−nx

EP ,x((u)) × YQ∈XF

OXF (Q)mQ|P ((u)) · e(cid:16)ZX∞

− log kf kdµ(cid:17)

=W ar

OX (divar(f )), f .

Here divar(f ) denotes the Arakelov divisor associated to the rational func-
tion f , and we use OX(divar(f )) to denote the metrized line bundle associ-
ated to the Arakelov divisor divar(f ).

15

Motivated by the above discussion, for an arbitrary non-zero rational

function f , let the action of f on W ar

OX ,1

by

f · W ar

OX ,1 = W ar

OX (divar(f )), f .

Then we have the following

Proposition 9. For f, g ∈ k(X)∗, we have natural isometry

[W ar
OX

: f W ar
OX

]2 ⊗ [f W ar
OX

: f gW ar
OX

]2 ∼= [W ar
OX

: f gW ar
OX

]2.

Proof. Essentially, this is because arithmetic intersection works well. Indeed,
by our deﬁnition, f W ar
OX (divar(f )). Hence, it suﬃces to prove that
OX
there is an isometry

= W ar

[W ar
OX

: W ar

OX (divar(f ))]2 ⊗ [W ar

OX (divar(f )) : W ar

OX (divar(f g))]2 ∼= [W ar

OX

: W ar

OX (divar(f g))]2.

But, similarly, as in the proof of Prop. 2, this is clear by the deﬁnition of
num0 in terms of intersections, due to the following trivial cancelation

divar(f ) +(cid:16) − (divar(f )) + (divar(f g))(cid:17) = (divar(f g)).

That is,

[W ar
OX

: W ar

OX (divar(f ))]2 ⊗ [W ar

OX (divar(f g))]2

HomR(cid:16)Num(cid:0)W ar

OX (divar(f )) : W ar
OX ,1(cid:14)W ar
HomR(cid:16)Num(cid:0)W ar

L,s(cid:1), Num(cid:0)W ar
OX (divar(f )),f(cid:14)W ar

lim←−

(L,s), L֒→OX

L֒→OX (divar(f ))

lim←−

(L,s) L֒→OX (divar(f ))

L֒→OX (divar(f g))

lim←−

(L,s) L֒→OX ,OX (divar(f ))

L֒→OX (divar(f g))

(cid:16)HomR(cid:16)Num(cid:0)W ar

OX ,1(cid:14)W ar
OX (divar(f )),f(cid:14)W ar
OX ,1(cid:14)W ar

L,s(cid:1), Num(cid:0)W ar

⊗ HomR(cid:16)Num(cid:0)W ar
HomR(cid:16)Num(cid:0)W ar

lim←−
(L,s)

L֒→OX ,OX (divar(f g))

=

⊗

∼=

∼=

L,s(cid:1)(cid:17)
OX (divar(f )),f(cid:14)W ar
L,s(cid:1)(cid:17)
OX (divar(f g)),f g(cid:14)W ar
L,s(cid:1), Num(cid:0)W ar
L,s(cid:1)(cid:17)
OX (divar(f )),f(cid:14)W ar
L,s(cid:1)(cid:17)(cid:17)
OX (divar(f g)),f g(cid:14)W ar
L,s(cid:1)(cid:17)
OX (divar(f g)),f g(cid:14)W ar

L,s(cid:1), Num(cid:0)W ar
L,s(cid:1), Num(cid:0)W ar

=[W ar
OX

: W ar

OX (divar(f g))]2.

Consequently, we may make the following

Deﬁnition 8. We deﬁne an arithmetic central extension group k(X)∗

W ar
OX

by the following data:

(a) As a set, its elements are given by pairs (f, α) with f ∈ k(X)∗, α ∈

[W ar
OX

: f W ar
OX

]2;

16

(b) For the group law, its multiplication is deﬁned by

(f, α) ◦ (g, β) := (f g, α ◦ f (β),

where

α ◦ f (β) := α ⊗ f (β).

Indeed, since α ∈ [W ar
OX

: f W ar
OX

]2, β ∈ [W ar
OX

: gW ar
OX

]2, we have

f (β) ∈ [f W ar
OX

: f gW ar
OX

]2,

and

α ◦ f (β) ∈ [W ar
OX

: f gW ar
OX

]2.

So (b) is well-deﬁned.

2.5 Splitness

Concerning the group k(X)∗

W ar
OX

, we have the following

Proposition 10. We have

(1) The group k(X)∗

is a central extension of k(X)∗ by R. In partic-

ular, we have an exact sequence

W ar
OX

0 → R −→ k(X)∗

W ar
OX

−→ k(X)∗ → 1.

(2) The short exact sequence (1) splits.

Proof. (1) follows directly from the deﬁnition. As for (2), we introduce one
more central extension k(X)∗′

of the group k(X)∗ by R as follows:

W ar
OX

(a) As a set, its elements are given by pairs (f, α′), where f ∈ k(X)∗ and

α′ ∈ HomR(cid:0)Num(Aar

(OX ), Num(Aar

EP ,∗

EP ,∗

(f OX))(cid:1);

(b) For the group law, its multiplication is deﬁned by

(f, α′) ◦ (g, β′) := (f g, α′ ◦ f (β′).

Now it is suﬃcient to use Theorem 8. Indeed, by Theorem 8, we obtain a
natural isomorphism k(X)∗
. On the other hand, the central
extension k(X)∗′

splits, since it admits the following natural section: an

≃ k(X)∗′

W ar
OX

W ar
OX

W ar
OX

element h ∈ k(X)∗ takes Num(Aar

That is, h ∈ HomR(cid:0)Num(Aar

implies that the central extension k(X)∗′

EP ,∗

(OX)) to Num(Aar

EP ,∗
(OX)), Num(Aar

(OX(divar(h)))).

EP ,∗

(OX (divar(h))))(cid:1). This

EP ,∗
splits.

W ar
OX

17

2.6 Reciprocity Symbols from Points and Curves

Let π : X −→ Spec OF be a regular arithmetic surface deﬁned over number
ﬁeld F . Let C be a complete irreducible vertical curve or an irreducible

horizontal curve, and x a closed point of C. Set H := Frac(cid:0)bOX,x(cid:1)∗. Then

with respect to the curve C at x, resp. the closed point x along C, there
exists a natural central extension

resp.

deﬁned as follows:

0 → R −→ bHBx −→ H → 1
0 → R −→ bHOKC,x

−→ H → 1

(A)

(B)

(a) As a set, its elements are given by pairs (f, α), resp. by pairs (g, β),
with f ∈ H and α ∈ [Bx|f Bx]2, resp. g ∈ H and β ∈ [OKC,x |gOKC,x ]2;

(b) For the group law, its multiplication is deﬁned by

(f1, α1)◦(f2, α2) = (f1f2, α1f1(α2)), resp. (g1, β1)◦(g2, β2) = (g1g2, β1f1(β2)).

Deﬁnition 9. For f1, f2 ∈ H, deﬁne a reciprocity symbol [f1, f2]x,C, resp.
[f1, fs]C,x, by

[f1, f2]x,C := [f ′

1, f ′

2]A,

resp.

[f1, f2]C,x := [f ′′

1 , f ′′

2 ]B,

where f ′

1, f ′

2, resp. f ′′

1 , f ′′

denotes the commutative of elements f ′

(A) to bHBx, resp. via extension (B) to bHOKC,x
bHOKC,x

1, f ′

We have the following

.

2 , are the lifts of elements f1, f2 of H via extension
2 ]B,
in

, and [f ′
2, resp. f ′′

2]A, resp. [f ′′

1, f ′
1 , f ′′

1 , f ′′

2 , in bHBx, resp.

Proposition 11. For f1, f2 ∈ H,

[f1, f2]x,C · [f1, f2]C,x = 1.

Proof. For vertical curves, this proposition is simply Prop 13 of [6]. For
horizontal curves, the same proof works.
Indeed, similarly, for any two
invertible sheaves L, L′ satisfying L ⊂ L′, there exists a natural isomorphism

[Bx ⊗ bOX,x

L(cid:12)(cid:12)Bx ⊗ bOX,x

L′]2 ⊗R [OKC,x ⊗ bOX,x

L(cid:12)(cid:12)OKC,x ⊗ bOX,x

L′]2

−→ HomR(cid:0)Num(AC,x(L)), Num(AC,x(L′))(cid:1).

Consequently, if we introduce a third central extension bHBx,OKC,x

of H by:

18

(a) As a set, its elements are given by pairs (f, γ) with f ∈ H and γ ∈

[Bx|f Bx]2 ⊗R [OKC,x|gOKC,x ]2;

(b) For the group law, its multiplication is deﬁned by

(f1, γ1) ◦ (f2, γ2) = (f1f2, γ1f1(γ2)).

Then bHBx,OKC,x

splits.

2.7 Proof of Reciprocity Laws

We may use same proofs as in Theorem 2, resp. Theorem 3 of [6] to prove our
reciprocity law around a point, resp. along an irreducible complete curve,
for arithmetic surfaces, [6] works on algebraic surfaces over ﬁnite ﬁelds. This
is because in this two cases above, only ﬁnite part of arithmetic surface is
involved.

Thus, it suﬃces for us to prove reciprocity laws along horizontal curves

for arithmetic surfaces.

For this purpose, we set

M ar
EP

:= Yx∈EP

KEP ,x × YQ∈XF

KXF ,Q(cid:12)(cid:12)Pb⊗QR.

Then for f, g ∈ k(X)∗, set SEP to be the collection of places x of F such that
x is in the union of the support of div(f |EP ) and the support of div(g|EP ),
and let SXF to be the collection of points Q of XF such that Q is in the
union of the support of div(f |XF ) and the support of div(g|XF ). Let

M ar

f,g := Yx∈SEP

KEP ,x × YQ∈SXF

KXF ,Q(cid:12)(cid:12)Pb⊗QR

be a combination of factors of M ar
EP
M ar
EP

so that we have

, and deﬁne M −

f,g to be its cofactor in

M ar
EP

= M ar

f,g × M f,g
ar .

To go further, we use the central extension k(X)∗

of k(X)∗ with

. By its splitness proved in Prop. 10 of §2.5, we have
vanishes. Similarly, we can also

respect to W ar
OX
the associated reciprocity symbol [∗, ∗]W ar
OX
introduce the central extension of k(X)∗ with respect to M ar
ﬁrst the groups k(X)∗
and [∗, ∗]M f,g
symbols [∗, ∗]M ar
ar
it is rather direct to show that

and k(X)∗

ar to get
and hence the associated reciprocity

f,g and M f,g

. Based on the techniques developed in §2.2,

M f,g
ar

M ar
f,g

f,g

W ar
OX

[∗, ∗]W ar
OX

= [∗, ∗]M ar

f,g

+ [∗, ∗]M f,g

ar

.

(∗3)

19

Moreover, since f, g keep M f,g

ar unchanged, we have

[f, g]M f,g

ar

= 0

∀f, g ∈ k(X)∗.

Therefore, we have

0 = [f, g]W ar
OX

= [f, g]M ar

f,g

+ [f, g]M f,g

ar

= [f, g]M ar

f,g

.

Indeed, for any factor subspace M of W ar
, we can construct its associated
OX
central extension k(X)∗
M and hence obtaining the reciprocity pairing [∗, ∗]M
such that [∗, ∗] is additive, and, if f, g ∈ k(X)∗ keep M stable, then, with
the proof of Prop 4(4) of [6], we have [f, g]M = 0. Consequently, by (∗3),

0 = Xx∈EP

[f, g]Bx + XQ∈XF

[f, g]OXF (Q).

This is the abstract reciprocity law.

By Prop. 6 of §3.6, we have [f, g]Bx = [f, g]C,x = νC,x(f, g) log qx. Hence,

to complete the proof, it suﬃces to show that

[f, g]OXF (Q) = log

|f0(P )νP (g)|
|g0(P )νP (f )|

.

2.8 End of Proof

This now becomes very simple. Without loss of generality, we assume that

of C((u)). Then we are led to the central extension C((u))∗

there is only one place, a complex one, and we view k(XF )b⊗QR as a subspace
of elements (f, α) where f ∈ C[[u]] and α ∈ [ C[[u]](cid:12)(cid:12) f C[[u]] ]. Construct a

natural metric on C((u)) using the standard metric on C and (ui, uj) = δij.
Accordingly, by the detailed calculations carried out in §A.2.6, with the
trivial metrics on C((u)) and hence over various spaces used, we have

C[[u]], consisting

[f |g]C[[u]] = − log

|f0(P )|νP (g)
|g0(P )|νP (f )

.

This then ends our proof.

Remark. Note that the appearances of − log |f (P )| is not surprising. Indeed,
when we numerate spaces W ar
L

, we use the spaces W ar
L,s

deﬁned by

W ar

m

−nx

EP ,x((u))(cid:17) ×(cid:16) YQ∈XF
L,s = (cid:16) Yx∈EP
It is the additional factor e(cid:16)RX∞

OXF (Q)⊗mQ(cid:12)(cid:12)P ((u))b⊗QR(cid:17) × e(cid:16)ZX∞
− log kskdµ(cid:17).
− log kskdµ(cid:17) which makes the whole in-

tersection theory and hence our construction work well. For example, the

20

canonical numeration num0 for the space W ar
L,s

is given by

− log kskdµ(cid:17)(cid:17)

−nx

m

OXF (Q)⊗mQ(cid:12)(cid:12)P b⊗QR(cid:17) × e(cid:16)ZX∞

EP ,x(cid:17) ×(cid:16) YQ∈XF
G∞(P, div(sF )) · e(cid:16)ZX∞

num0(cid:16)(cid:16) Yx∈EP
− log kskdµ(cid:17).
x YQ∈XF
= Yx∈EP
In particular, when L = OX(divar(f )), then num0(cid:0)W ar

qnx

ovOX (divar(f )),f(cid:1) = 0 by

the product formula. Consequently, for diﬀerent choices of rational sections
s and s′ of L, we have canonical isometry

Num(cid:0)W ar

L,s′(cid:1).
L,s(cid:1) ∼= Num(cid:0)W ar

In particular, it makes sense to introduce the space W ar
. As a direct con-
L
sequence, for rational function f ∈ k(XF )∗, we obtain this crucial term

−Pσ|∞ log |fσ|σ and hence the reciprocity symbol at inﬁnite.

References

[1] E. Arbarello, C. De Concini, and V.G. Kac, The inﬁnite wedge repre-
sentation and the reciprocity law for algebraic curves, Proc. of Symp in
Pure Math, Vol. 49 (1989), Part I, 171-190

[2] A.A. Beilinson, Residues and adeles, Funct. Anal. Pril., 14 (1980), no.
1, 44-45; English transl. in Func. Anal. Appl., 14, no. 1 (1980), 34-35.

[3] J.-L. Brylinski and P. Deligne, Central extensions of reductive groups

by K2, Publ. Math. Inst. Hautes Etudes Sci. No. 94 (2001), 5-85.

[4] S. Lang, Introduction to Arakelov Theory, Springer (1988)

[5] M. Kapranov, Semi-inﬁnite symmetric powers, math.QA/0107089

[6] D. V. Osipov, Central extensions and reciprocity laws on algebraic sur-
faces, Mat. Sb. 196 (2005), no. 10, 111-136; translation in Sb. Math.
196 (2005), no. 9-10, 1503-1527, arXiv:math/0501155

[7] D. V. Osipov, Unramiﬁed two-dimensional Langlands correspondence,
Izv. Ross. Akad. Nauk Ser. Mat. 77 (2013), no. 4, 73–102; translation
in Izv. Math. 77 (2013), no. 4, 714-741, arXiv:1210.3780

[8] D. V. Osipov and X. W. Zhu, A categorical proof of the Parshin reci-
procity laws on algebraic surfaces, Algebra Number Theory 5 (2011),
no. 3, 289-337

21

[9] A.N. Parshin, On the arithmetic of two-dimensional schemes. I. Distri-
butions and residues. Izv. Akad. Nauk SSSR Ser. Mat. 40 (1976), no.
4, 736-773

[10] A.N. Parshin, Chern classes, adeles and L-functions. J. Reine Angew.

Math. 341 (1983), 174-192.

[11] K. Sugahara and L. Weng, Arithmetic cohomology groups, arXiv:

1507.06074 (2013)

[12] L. Weng, Geometry of numbers, arXiv:1102.1302

[13] J. Tate, Residues of diﬀerential forms on curves, Ann. Sci. Eco. Norm,

Sup., 4 serie, t. 1, 1968, 149-159

K. Sugahara & L. Weng
Graduate School of Mathematics,
Kyushu University,
Fukuoka, 819-0395,
Japan
E-mails: k-sugahara@math.kyushu-u.ac.jp,

weng@math.kyushu-u.ac.jp

22

