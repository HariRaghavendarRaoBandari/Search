6
1
0
2

 
r
a

M
1

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
7
0
2
0
0

.

3
0
6
1
:
v
i
X
r
a

SETS OF BOUNDED REMAINDER FOR THE

CONTINUOUS IRRATIONAL ROTATION ON [0, 1]2

SIGRID GREPSTAD AND GERHARD LARCHER

Abstract. We study sets of bounded remainder for the two-
dimensional continuous irrational rotation ({x1 + t},{x2 + tα})t>0
in the unit square. In particular, we show that for almost all α
and every starting point (x1, x2), every polygon S with no edge of
slope α is a set of bounded remainder. Moreover, every convex set
S whose boundary is twice continuously diﬀerentiable with posi-
tive curvature at every point is a bounded remainder set for almost
all α and every starting point (x1, x2). Finally we show that these
assertions are, in some sense, best possible.

1. Introduction

In this paper we will be concerned with bounded remainder sets for
the two-dimensional irrational rotation on the unit square I 2 = [0, 1)2.
Deﬁnition 1.1. Let x = (x1, x2) ∈ I 2, and let α ∈ R\ Q. We say that
the function X : [0,∞) 7→ I 2 deﬁned by

X(t) = ({x1 + t},{x2 + αt})

is the two-dimensional continuous irrational rotation with slope α and
starting point x.
Deﬁnition 1.2. Let S ⊂ I 2 be an arbitrary measurable subset of the
unit square with Lebesgue measure λ(S). We say that S is a bounded
remainder set for the continuous irrational rotation with slope α > 0
and starting point x = (x1, x2) ∈ I 2 if the distributional error
(1.1)

χS ({x1 + t},{x2 + αt}) dt − T λ(S)

∆T (S, α, x) =Z T

0

is uniformly bounded for all T > 0. Here, χS denotes the characteristic
function for the set S.

Date: February 29, 2016.
2010 Mathematics Subject Classiﬁcation. 11K38, 11J71.
Key words and phrases. Bounded remainder set, discrepancy, continuous irra-

tional rotation.

The authors are supported by the Austrian Science Fund (FWF): Projects
F5505-N26 and F5507-N26, which are both part of the Special Research Program
“Quasi-Monte Carlo Methods: Theory and Applications”.

1

2

SIGRID GREPSTAD AND GERHARD LARCHER

Bounded remainder sets have been extensively studied for the dis-
crete analogue of continuous irrational rotation, that is, for Kronecker
sequences ({nα1},{nα2}, . . . ,{nαs})n=1,2,... in [0, 1)s, where α1, . . . , αs
are given reals. In this context, a bounded remainder set S ⊆ [0, 1)s is
a measurable set for which the diﬀerence

N

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xn=1

χS({x1 + nα1}, . . . ,{xs + nαs}) − Nλ(S)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

is uniformly bounded for all integers N > 1 and almost every point
(x1, . . . , xs) ∈ [0, 1)s. In the simplest case when s = 1 and S is just an
interval, bounded remainder sets for the Kronecker sequences were ex-
plicitly characterized by Hecke [8], Ostrowski [13, 14] and Kesten [10].
In the general multi-dimensional case, a characterization of bounded re-
mainder sets in terms of equidecomposability to certain parallelepipeds
was recently given in [7].

Without going into further detail on the known results for the Kro-
necker sequences, let us simply emphasize that in the discrete case, a
given set S ⊂ [0, 1)s is a bounded remainder set for only “very few”
choices of (α1, . . . , αs). Likewise, given a vector (α1, . . . , αs), the class
of sets S which are of bounded remainder with respect to this vector
is, in some sense, small. Once we consider bounded remainder sets for
the continuous irrational rotation, the situation turns out to be quite
diﬀerent. In light of recent work by J´oszef Beck, this is not entirely
unexpected. Beck studied distributional properties of the continuous
irrational rotation in [1, 2, 3], and showed in particular that:
Theorem (Beck [3, Theorem 1]). Let S ⊆ I 2 be an arbitrary Lebesgue
measurable set in the unit square with positive measure. Then for every
ε > 0, almost all α > 0 and every starting point x = (x1, x2) ∈ I 2, we
have

Z T

0

χS ({x1 + t},{x2 + αt}) dt − T λ(S) = o(cid:0)(log T )3+ε(cid:1) .

As pointed out by Beck, the polylogarithmic error term is shockingly
small compared to the linear term T λ(S). Moreover, it holds for all
measurable sets S. It is thus natural to ask if imposing certain reg-
ularity conditions on S could give an even lower bound on the error
term.

The aim of this paper is to show that the estimate of Beck can be

signiﬁcantly improved for a large collection of sets S. We show that:
Theorem 1.3. For almost all α > 0 and every x ∈ I 2, every polygon
S ⊂ I 2 with no edge of slope α is a bounded remainder set for the
continuous irrational rotation with slope α and starting point x.
Theorem 1.4. For almost all α > 0 and every x ∈ I 2, every convex
set S ⊂ I 2 whose boundary ∂S is a twice continuously diﬀerentiable

SETS OF BOUNDED REMAINDER

3

curve with positive curvature at every point is a bounded remainder set
for the continuous irrational rotation with slope α and starting point
x.

We will see from the proofs that Theorems 1.3 and 1.4 hold for all α

whose continued fraction expansion α = [a0; a1, a2,· · · ] satisﬁes

s

Xl=0

al+1
q1/2
l

l+1

Xk=1

ak < C,

where C is a constant independent of s. Here, (ql)l>0 is the sequence
of best approximation denominators for α.

The following results are immediate consequences of Theorems 1.3

and 1.4.

Corollary 1.5. Let S be a polygon in I 2. Then S is a bounded remain-
der set with respect to continuous irrational rotation for almost every
α > 0 and every starting point x ∈ I 2.
Corollary 1.6. Let S be a convex set in I 2 whose boundary ∂S is a
twice continuously diﬀerentiable curve with positive curvature at every
point. Then S is a bounded remainder set with respect to continuous
irrational rotation for almost every α > 0 and every starting point
x ∈ I 2.

In light of Corollaries 1.5 and 1.6, it is tempting to raise the question
of whether every convex set S ⊂ I 2 is a bounded remainder set with
respect to continuous irrational rotation for almost every slope α > 0
and every starting point x ∈ I 2. We leave this question open.
Theorems 1.3 and 1.4 above are, in a certain sense, optimal. First
of all, the slope condition in Theorem 1.3 on the edges of the polygon
S cannot be omitted. To see this, ﬁx some α > 0, and let S be the
parallelogram shown in Figure 1 with p /∈ Zα(mod 1) and λ(S) = p. It
is not diﬃcult to show that for such a set S, with two edges of slope
α, we have

We recall from the discrete setting that if p /∈ Zα(mod 1), then the
diﬀerence

is unbounded as T → ∞ [10], and accordingly so is

6 1.

0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z T

⌊T ⌋

⌊T ⌋

Xn=1

χS ({t},{αt}) dt −

χ[0,p)({nα})(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
χ[0,p)({nα}) − p⌊T⌋(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xn=1
Z T
|∆T (S, α, 0)| =(cid:12)(cid:12)(cid:12)(cid:12)

χS ({t},{αt}) − pT(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

0

.

4

SIGRID GREPSTAD AND GERHARD LARCHER

1

p

S

α

1

Figure 1. The parallelogram S with two edges of slope
α.

Thus, the set S in Figure 1 is not of bounded remainder for the con-
tinuous irrational rotation with slope α starting at the origin. By an
equivalent argument, all sets S′ similar to the examples shown in Figure
2 with p /∈ Zα(mod 1) are not bounded remainder sets.

1

S′

S′

p

α

1

Figure 2. Sets S′ which are not of bounded remainder
for the continuous irrational rotation with slope α (given
p /∈ Zα(mod 1)).

Secondly, in neither Theorem 1.3 nor 1.4 can we replace “for almost

all α” by “for all irrational α”. This is clariﬁed by the following:

Theorem 1.7.

(a) For uncountably many α > 0 there exist triangles in I 2 with
no edge of slope α which are not bounded remainder sets for
the continuous irrational rotation with slope α and arbitrary
starting point.

SETS OF BOUNDED REMAINDER

5

(b) For uncountably many α > 0 there exist discs in I 2 which are
not bounded remainder sets for the continuous irrational rota-
tion with slope α and arbitrary starting point.

(c) The triangle with vertices (0, 0), (1, 0) and (0, 1) is a bounded
remainder set for every slope α > 0 and every starting point
x ∈ I 2.

Theorem 1.7 (c) illustrates that for very special polygons S, Theorem
1.3 does actually hold for all irrational α. Other trivial examples of such
special sets are rectangles of the form [0, γ) × [0, 1) (or [0, 1) × [0, γ)),
where 0 < γ 6 1.
Finally, let us point out that Theorems 1.3 and 1.4, and their proofs,
give information on the behavior of discrepancies of the continuous
irrational rotation on the unit square. Let B denote a certain class of
measurable subsets of I 2. Then by the discrepancy D(B)
T of a continuous
irrational rotation with slope α > 0 and starting point x ∈ I 2 with
respect to B we mean

D(B)

T

:= sup
S∈B

∆T (S, α, x),

with ∆T (S, α, x) deﬁned in (1.1). The most extensively studied case in
the classical theory of irregular distribution is that when B is the class
of axis-parallel rectangles. Theorem 1.3 tells us that in this case, we
have

∆T (S, α, x) = O(1)

for all x, almost all α and all S ∈ B. Moreover, by a careful con-
sideration of the constants involved in the proof of Theorem 1.3, one
can verify that the O-constant will depend only on α, and not on the
choice of rectangle S. As a consequence, we obtain the following result,
previously shown by Drmota [4] (see also [5]).

Corollary 1.8. The discrepancy D(B)
of the continuous irrational ro-
tation with slope α and starting point x with respect to the class B of
axis-parallel rectangles in I 2 is

T

D(B)

T = O(1)

for all x ∈ I 2 and almost all α > 0.

As clariﬁed by the example in Figure 1, an analogous result does
not hold if B is the class of all rectangles. It follows that the isotropic
discrepancy, i.e. the discrepancy with respect to the class of all convex
sets, cannot be bounded. However, if we let B be the class D of all discs
in I 2, then we can attain a result analogous to Corollary 1.8. Theorem
1.4 tells us that for all S ∈ D, we have

∆T (S, α, x) = O(1)

6

SIGRID GREPSTAD AND GERHARD LARCHER

for all x and almost all α, and from the proof of Theorem 1.4 it is not
diﬃcult to see that the O-constant can be made independent of the
size and position of the disc S. We thus get:
Corollary 1.9. The discrepancy D(D)
of the continuous irrational ro-
tation with slope α and starting point x with respect to the class D of
discs in I 2 is

T

D(D)
for all x ∈ I 2 and almost all α > 0.

T = O(1)

The rest of the paper is organized as follows. In Section 2 we present
necessary preliminary material, and give the proofs of Theorems 1.3
and 1.4. Section 3 is devoted to the proof of Theorem 1.7.

2. Preliminaries and proofs of Theorems 1.3 and 1.4

2.1. Continued fractions. We begin by brieﬂy reviewing some well-
known facts about continued fractions. For an irrational α ∈ (0, 1),
let

[0; a1, a2, a3, . . .]

be its continued fraction expansion, and denote by pn/qn its nth con-
vergent. The numerators pn and denominators qn are given recursively
by

q0 = 1,
p0 = 0,

q1 = a1,
p1 = 1,

qn+1 = an+1qn + qn−1,
pn+1 = an+1pn + pn−1.

It follows readily from these recurrences that

(2.1)

pnqn+1 − pn+1qn = (−1)n+1.

The nth convergent pn/qn is greater than α for every odd value of n,
and smaller than α for every even value of n. It is easy to see that
limn→∞ pn/qn = α, and moreover we have the error bounds

(2.2)

1

(an+1 + 2)q2
n

6

1

an+1q2
n

.

α −

6(cid:12)(cid:12)(cid:12)(cid:12)

pn

qn(cid:12)(cid:12)(cid:12)(cid:12)

Every non-negative integer N has a unique expansion

N =

biqi, with bs > 0;

0 6 bi 6 ai+1,

0 6 i 6 s.

s

Xi=0

We will refer to this as the Ostrowski expansion of N to base α.

Finally, we will need the following result, which follows from well-

known facts in metric theory for continued fractions (see e.g. [11]).
Lemma 2.1. For almost every irrational α ∈ (0, 1) and every m > 0,
the sum

is uniformly bounded in s.

Xl=0

s

al+1
q1/m
l

l+1

ak

Xk=1

SETS OF BOUNDED REMAINDER

7

2.2. Functions of bounded remainder. It is not diﬃcult to show
that the question of whether S ⊂ I 2 is a bounded remainder set for
the continuous two-dimensional irrational rotation is essentially a one-
dimensional problem. By making an appropriate projection, the ques-
tion can be restated as that of whether a certain associated function is
of bounded remainder.

Deﬁnition 2.2. Let f : R 7→ C be a 1-periodic function which is
integrable over [0, 1]. We say that f is a bounded remainder function
with respect to α ∈ R \ Q if there is a constant C = C(f, α) such that

N −1

Xk=0

for all integers N > 0.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

f (kα) − NZ 1

0

6 C

f (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Bounded remainder functions have been studied by several authors,

see e.g. [9], or [15] and the references therein.

We will consider two special classes of functions: hat functions and

dome functions.

Deﬁnition 2.3. We say that T : R 7→ [0,∞) is a hat function if T is
supported on the interval [0, b], with b > 0, and

(2.3)

T (x) =( H
a x ,
0 6 x 6 a ;
− H
b−a (x − b) , a < x 6 b ,
for some 0 < a < b and H > 0.

Deﬁnition 2.4. We say that a continuous function T : R 7→ [0,∞)
supported on [0, B], with B > 0, is a dome function if it satisﬁes the
following two conditions:

(1) T is concave and twice diﬀerentiable on the open interval (0, B).
(2) There exist ε > 0, m > 0 and c > 0 such that

(2.4)

|T (x)| 6 c · x1/m
|T (B − x)| 6 c · x1/m

for all 0 6 x < ε;

for all 0 6 x < ε.

We will establish and prove the following two results, which will be

crucial for the proofs of Theorems 1.3 and 1.4 later on.

Proposition 2.5. Let τ (x) =Pm∈Z T (x + m), where T is a hat func-
tion. Then τ is a bounded remainder function with respect to almost
every α ∈ R \ Q.
Proposition 2.6. Let τ (x) =Pm∈Z T (x+m), where T is a dome func-
tion. Then τ is a bounded remainder function with respect to almost
every α ∈ R \ Q.

8

SIGRID GREPSTAD AND GERHARD LARCHER

Remark 2.7. For suﬃciently regular functions, including periodiza-
tions of hat and dome functions, the bounded remainder property is
not aﬀected by shifting the function (see [15, p. 128–129]). It thus fol-
lows from Propositions 2.5 and 2.6 that for almost every α ∈ R \ Q,
we have

τ (kα + x0) − NZ 1

0

N −1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

6 C

τ (x)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

for all N > 0 and every x0 ∈ R whenever τ is the periodization of a
hat or dome function. The constant C may depend on τ and α, but
not on N or x0.

Later on we explain how Theorems 1.3 and 1.4 follow from the results

above.

For the proof of Proposition 2.5, we will need the following lemma.
Lemma 2.8. Let f : R 7→ R be a 1-periodic function, α be irrational
and N be a nonnegative integer with Ostrowski expansion

N = bsqs + . . . + b0q0

to base α. We then have

N −1

s

bl−1

ql−1

(2.5)

f (kα) =

Xk=0

Xk=0
Xb=0
for some ρk,l satisfying −1 < ρk,l < 2.
Proof. Let n(0) = 0 and n(l) = bl−1ql−1 + . . . + b0q0 for 1 6 l 6 s. It is
straightforward to show that

Xl=0

+

f(cid:18) k

ql

ρk,l

ql (cid:19) ,

N −1

s

bl−1

ql−1

(2.6)

f (kα) =

Xk=0

Xl=0

Xb=0

f (kα + (n(l) + bql)α).

Xk=0

We deﬁne θl from the equation
θl

= α −

pl
ql

,

al+1q2
l

and observe that by (2.2) we have 1/3 6 |θl| 6 1. Moreover, we ﬁnd
xl ∈ [0, 1) and ml ∈ {0, . . . , ql − 1}, ml = ml(b, x, α), such that

{(n(l) + bql)α} =

ml
ql

+

xl
ql

.

We can then rewrite the summand on the right hand side in (2.6) as

(2.7)

f (kα + (n(l) + bql)α) = f(cid:18)kpl + ml

ql

+

kθl

al+1q2
l

+

xl

ql(cid:19) .

Using the substitution kpl + ml = t (mod ql), which by (2.1) gives

k = (t − ml)ql−1(−1)l−1 (mod ql),

SETS OF BOUNDED REMAINDER

9

we get

(2.8)

where

(2.9)

(cid:26)kpl + ml

ql

+

kθl

al+1q2
l

+

xl

ql(cid:27) =(cid:26) t

ql

+

ρt,l

ql (cid:27) ,

ρt,l :=(cid:26)(t − ml)(−1)l−1 ql−1

ql (cid:27) θl

al+1

+ xl.

With this deﬁnition we have
1

−

al+1

< ρt,l <

1

al+1

+ 1,

and hence −1 < ρt,l < 2. Combining (2.6), (2.7) and (2.8), we thus
arrive at (2.5).

(cid:3)

Proof of Proposition 2.5. It will be suﬃcient to prove Proposition 2.5
for the case when b 6 1 in Deﬁnition 2.3. To see this, observe that
any general hat function T can be written as a sum of shifted hat
functions Ti with support [0, b], b 6 1. Since any ﬁnite sum of bounded
remainder functions is again a bounded remainder function, the general

case follows from the special case τ (x) =Pm∈Z Ti(x + m).
Our goal is to show that for almost every α ∈ R \ Q, we can ﬁnd a

constant C = C(α, τ ) such that

(2.10)

τ (kα) − NZ 1

0

N −1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

6 C

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

for every integer N > 0. It will be enough to verify this for α ∈ (0, 1),
as the sum in (2.10) depends only on the fractional part of α. By
Lemma 2.8 we may rewrite this sum as

s

bl−1

ql−1

Xl=0

Xb=0

Xk=0

τ(cid:18) k

ql

+

ρk,l

ql (cid:19) ,

where N = bsqs + · · · + b0q0 is the Ostrowski expansion of N to base α
and −1 < ρk,l < 2. We verify (2.10) in two steps: First we show that

for almost every irrational α ∈ (0, 1). We then show that

6 C, N = 1, 2, . . . ,

6 C,

s = 1, 2, . . . ,

(2.11)

(2.12)

s

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0

s

bl−1

ql−1

Xb=0

Xk=0

ql(cid:19) − NZ 1
τ(cid:18) k

bl−1

Xb=0

ql−1

Xk=0(cid:18)τ(cid:18) k

ql

ρk,l

+

0

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql(cid:19)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql (cid:19) − τ(cid:18) k

for almost every irrational α ∈ (0, 1). Combining (2.11) and (2.12), we
immediately obtain (2.10).

10

SIGRID GREPSTAD AND GERHARD LARCHER

Let us ﬁrst verify that (2.11) holds. On the interval I, the function τ
is of the form (2.3) with b 6 1, so we can ﬁnd ul, vl ∈ {0, 1, . . . , ql − 1}
and ξl, ηl ∈ (0, 1] such that
(2.13)

ul + ξl

vl + ηl

and

a =

b =

.

ql

ql

For suﬃciently large l > l0 (where l0 = l0(τ ) depends only on τ ), we
have ul < vl, and a straightforward calculation gives

Hb
2

ql +

Haηl(1 − ηl) − Hbξl(1 − ξl)

2a(b − a)ql

.

ql(cid:19) − qlZ 1
τ(cid:18) k

0

6 C

1
ql

,

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ql−1

Xk=0

Thus we have

ql−1

τ(cid:18) k
ql(cid:19) =
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xb=0

Xk=0

Xk=0

ql−1

bl−1

s

Xl=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

where C = C(τ ) (this is trivially true also when l 6 l0), and it follows
that

ql(cid:19) − NZ 1
τ(cid:18) k

0

6 C

bl
ql

.

s

Xl=0

Since bl < al+1, it follows from Lemma 2.1 that the right hand side
above is uniformly bounded in s for almost every α ∈ (0, 1). This
conﬁrms (2.11).
We go on to verify (2.12). We will assume below that b < 1 in (2.3);
the proof when b = 1 is slightly simpler, but essentially the same. Let
Ql = {0, 1, . . . , ql − 1}, and deﬁne ul, vl ∈ Ql as in (2.13). Denote by E
a set of “exceptional” indices

E = {0, ul − 1, ul, ul + 1, vl − 1, vl, vl + 1, ql − 1}
(for suﬃciently large l > l0, these are all distinct). We have

(2.14)

ql−1

Xk=0

τ(cid:18) k

ql

+

ρk,l

ql (cid:19) = Xk∈Ql\E

τ(cid:18) k

ql

+

ρk,l

ql (cid:19) +Xk∈E

τ(cid:18) k

ql

+

ρk,l

ql (cid:19) ,

and since τ is everywhere linear (with bounded slope) it is clear that

(2.15)

τ(cid:18) k

ql

Xk∈E

+

ρk,l

ql (cid:19) =Xk∈E

τ(cid:18) k

ql(cid:19) + O(cid:18) 1
ql(cid:19) .

The second sum on the right hand side in (2.14) can be rewritten using
the speciﬁc form (2.3) of τ on I. We get

(2.16)

Xk∈Ql\E

τ(cid:18) k

ql

+

ρk,l

ql (cid:19) = Xk∈Ql\E

τ(cid:18) k

ql(cid:19) + Σ1,

SETS OF BOUNDED REMAINDER

11

where

Σ1 :=

1

ql   H

a

ul−2

Xk=1

ρk,l −

H
b − a

vl−2

Xk=ul+2

ρk,l! ,

and ρk,l is deﬁned in (2.9). To verify (2.12), we will need to ﬁnd an
appropriate bound on Σ1.

i=1 ai/ql). By deﬁning αl and γl as

We now show that Σ1 = O(Pl

(2.17)

αl := (−1)l−1 ql−1
γl := −ml(−1)l−1 ql−1

ql

ql

,

,

we can rewrite ρk,l in (2.9) as

ρk,l = ωk,l ·

θl
al+1

+ xl,

where ωk,l := {kαl + γl}. Using (2.13) and the fact that xl ∈ [0, 1), it
is an easy task to show that

ul−2

H
a

θl

Xk=1
qlal+1   H
qlal+1   1

Hθl

a

a

We thus have

(2.18)

Σ1 =

=

xl −

H
b − a

vl−2

Xk=ul+2

xl = O(1).

ul−2

ul−1

ωk,l −

Xk=1
Xk=0
ωk,l −

vl−2

ωk,l! + O(cid:18) 1
ql(cid:19)
H
Xk=ul+2
b − a
ωk,l! + O(cid:18) 1
ql(cid:19) ,
1
Xk=ul
b − a

vl−1

where the last equality follows from boundedness of the terms ωk,l.

To further approximate Σ1, we employ Koksma’s inequality for the
k=0 and the linear function f (x) = {x} (see [12, Theo-

sequence {ωk,l}ql−1
rem 5.1]). For 1 6 N 6 ql, we have
ωk,l − NZ 1

N −1

N −1

0

Xk=0

Xk=0

x dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

N

2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

where VI(f ) = 1 is the total variation of f over I, and D∗
the star-discrepancy of the point set {ωk,l}N −1
ancy DN of {ωk,l}N −1
k=0 equals that of {kαl}N −1
has continued fraction expansion

N (ωk,l) denotes
k=0 . The extreme discrep-
k=0 . Note that |αl| = ql−1/ql

ωk,l −

6 ND∗

N (ωk,l)VI(f ),

It thus follows that

|αl| = [0; al, al−1, . . . a1] .

(2.19)

ND∗

N (ωk,l) 6 NDN (ωk,l) = NDN (kαl) 6 1 + 2

ai

l

Xi=1

12

SIGRID GREPSTAD AND GERHARD LARCHER

for 1 6 N 6 ql (see [12, p. 126] for the last inequality). Hence, we have

and from this and (2.18) it follows that

1

N

N −1

ωk,l −

2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xk=0
b − a(cid:19) ul−1
Xk=0
ul
2 −
b − a ·
(qla − ξl) −

1

ωk,l −

+

b

b

Σ1 =

a

=

Hθl

Hθl

qlal+1  (cid:18) 1
qlal+1 (cid:18)
2qlal+1 (cid:18)
= O Pl

Hθl

=

a(b − a) ·

a(b − a)
ql ! .

i=1 ai

6 1 + 2

ai,

l

Xi=1

vl−1

1
Xk=0
b − a
2(cid:19) + O Pl

ωk,l! + O(cid:18) 1
ql(cid:19)
ql !

i=1 ai

vl

1
b − a

(qlb − ηl)(cid:19) + O Pl

i=1 ai

ql !

Let us ﬁnally see that this bound on Σ1 implies (2.12).

Inserting

(2.15) and (2.16) in (2.14), we get

for l > l0 = l0(τ ) and some constant C which depends only on τ and
α (this bound holds trivially also when l < l0). We thus have

6

C
ql

ai,

l

Xi=1

ql

ql−1

Xk=0

τ(cid:18) k

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xk=0(cid:18)τ(cid:18) k

ql−1

ql

+

+

ρk,l

ql−1

ql (cid:19) −

ql(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
τ(cid:18) k
Xk=0
ql(cid:19)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql (cid:19) − τ(cid:18) k

ρk,l

bl−1

Xb=0

s

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0

6 C ′a1 + C

6 C

al+1
ql

s

Xl=0

bl
ql

ai

l

Xi=1

ai.

s

l+1

Xl=1
Xi=1

By Lemma 2.1, the sum on the right hand side above is bounded uni-
formly in s for almost every irrational α ∈ (0, 1). This veriﬁes (2.12),
and completes the proof of Proposition 2.5.

(cid:3)

Before we embark on the proof of Proposition 2.6, we establish the

following preliminary result.
Lemma 2.9. Suppose f : R 7→ R is a dome function as given in
Deﬁnition 2.4, and let q > 2/B. Denote by f ′

q the function

(2.20)

f ′

q(x) =(f ′(x)

0

1/q 6 x 6 B − 1/q,
otherwise.

Then for q > 1/ε, with ε as in (2.4), the total variation VI(f ′
over I satisﬁes

q) of f ′
q

VI(f ′

q) 6 Cq1−1/m,

SETS OF BOUNDED REMAINDER

13

where C = C(c) with c as in (2.4).

Proof. The function f is concave and twice diﬀerentiable on (0, B),
from which it follows that f ′ is monotonically nonincreasing and

VI(f ′

q) = 2(cid:18)f ′(cid:18) 1

q(cid:19) − f ′(cid:18)B −

1

q(cid:19)(cid:19) .

Moreover, we have that

and likewise

f ′(cid:18)1
q(cid:19) 6
f ′(cid:18)B −

f (1/q) − f (0)

1/q

1

q(cid:19) > −qf(cid:18)B −

q(cid:19) ,
= qf(cid:18)1
q(cid:19) .

1

τ (kα) − NZ 1

0

N −1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

s

Xl=0

bl−1

Xb=0

ql−1

Xk=0

τ(cid:18) k

ql

6 C

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql (cid:19) ,

ρk,l

+

By the conditions (2.4) on f it thus follows that

VI(f ′

q) 6 4cq1−1/m

for all q >

1
ε

.

(cid:3)

Proof of Proposition 2.6. It will be suﬃcient to prove Proposition 2.6
for the case when B 6 1 in Deﬁnition 2.4. To see this, observe that
any general dome function T can be written as a sum of shifted hat
functions, and shifted dome functions with support in I. This is illus-
trated for the case 1 < B 6 2 in Figure 3; we may write the function
T as

T = T1 + T2 + T3,

where T1 is the hat function in (2.3) with a = 1, b = B and H =
T (1), and T2 and T3 are the dome functions T2 = χ[0,1] · (T − T1)
and T3 = χ[1,B] · (T − T1). As the sum of ﬁnitely many bounded
remainder functions is again a bounded remainder function, the general
case follows from the special case T = T3 and Proposition 2.5. In other
words, it is suﬃcient to consider the case when, restricted to the unit
interval, τ is simply a dome function with support [0, B], B 6 1.

Let τ be such a function. We want to show that for almost every

α ∈ R \ Q, we can ﬁnd a constant C = C(c, m, α) such that

(2.21)

for every integer N > 0. Again it will be enough to verify this for
α ∈ (0, 1), as the sum in (2.21) depends only on the fractional part of
α. By Lemma 2.8, we may rewrite this sum as

14

SIGRID GREPSTAD AND GERHARD LARCHER

T

T1

T2

T3

1

2

Figure 3. The dome function T decomposed as the sum
of a hat function T1, and two dome functions T2 and T3
supported on intervals of length at most one.

where N = bsqs + · · · + b0q0 is the Ostrowski expansion of N to base α
and −1 < ρk,l < 2. We verify (2.21) in two steps: First we show that

for almost every irrational α ∈ (0, 1). We then show that

6 C, N = 1, 2, . . . ,

6 C,

s = 1, 2, . . . ,

(2.22)

(2.23)

s

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0

s

bl−1

ql−1

Xb=0

Xk=0

ql(cid:19) − NZ 1
τ(cid:18) k

bl−1

Xb=0

ql−1

Xk=0(cid:18)τ(cid:18) k

ql

ρk,l

+

0

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql(cid:19)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql (cid:19) − τ(cid:18) k

for almost every irrational α ∈ (0, 1). Combining (2.22) and (2.23), we
immediately obtain (2.21).
Let us ﬁrst see that (2.22) holds. On the interval I, the function τ is
supported on [0, B] with 0 < B 6 1, so we can ﬁnd ul ∈ {0, 1, . . . , ql−1}
and ξl ∈ (0, 1] such that
(2.24)

ul + ξl

B =

.

ql
We begin by considering the inner sum

ql−1

Xk=0

τ(cid:18) k

ql(cid:19) =

ul−1

Xk=1

τ(cid:18) k

ql(cid:19) + τ(cid:18)ul
ql(cid:19) .

It is not diﬃcult to show, for instance using integration by parts, that

ul−1

Xk=1

ql(cid:19) = qlZ (ul−1)/ql
τ(cid:18) k
+Z (ul−1)/ql

1/ql

1/ql

(cid:18){qlx} −

τ (x) dx +

1

2(cid:18)τ(cid:18) 1
2(cid:19) τ ′(x) dx,

1

ql(cid:19) + τ(cid:18)ul − 1

ql (cid:19)(cid:19)

SETS OF BOUNDED REMAINDER

15

and hence

ql−1

Xk=0

ql(cid:19) − qlZ 1
τ(cid:18) k

0

1

ql(cid:19) +
τ (x) dx = τ(cid:18) ul
− ql Z 1/ql
+Z (ul−1)/ql

2(cid:18)τ(cid:18) 1
τ (x) dx +Z B
(cid:18){qlx} −

1/ql

1

0

ql(cid:19) + τ(cid:18) ul − 1

ql (cid:19)(cid:19)
τ (x) dx!

(ul−1)/ql

2(cid:19) τ ′(x) dx.

Now let l > l0 = l0(τ ) be suﬃciently large for ql > 2/ε.
It is then
clear from the conditions (2.4) on τ that all but the last term on the
right hand side above are bounded by Cq−1/m
in absolute value (where
C = C(c, m)). In fact, the same bound holds also for the last term, as

l

1

6

1/ql

ul−2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z (ul−1)/ql
(cid:18){qlx} −
Xi=1 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z (i+1)/ql
Xi=1 (cid:12)(cid:12)(cid:12)

2(cid:19) τ ′(x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
2(cid:19) τ ′(x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:18){qlx} −
τ ′(x)(cid:12)(cid:12)(cid:12)Z (i+1)/ql
τ ′(x) − min

max
, i+1
x∈[ i
ql
ql

x∈[ i
ql

, i+1
ql

ul−2

i/ql

6

1

]

]

6

VI(τ ′

ql),

1
8ql

(2i+1)/2ql(cid:18){qlx} −

1

2(cid:19) dx

with τ ′
that

ql deﬁned as in (2.20). Since ql > 2/ε, it follows from Lemma 2.9

1
8ql

VI(τ ′

ql) 6 Cq−1/m

l

,

where C = C(c), and hence we get

for some constant C(c, m) and l > l0 (and this bound holds trivially
also when l 6 l0). It follows that

ql−1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xb=0

bl−1

ql−1

Xk=0

0

ql(cid:19) − qlZ 1
τ(cid:18) k

τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
τ (x) dx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql(cid:19) − NZ 1
τ(cid:18) k

0

s

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0

6 Cq−1/m

,

l

6 C

s

Xl=0

bl
q1/m
l

,

and by Lemma 2.1 the latter sum is uniformly bounded in s for almost
every irrational α ∈ (0, 1). This conﬁrms (2.22).
We now show that (2.23) holds. We assume below that B < 1; the
proof when B = 1 is slightly simpler, but essentially the same. Again

16

SIGRID GREPSTAD AND GERHARD LARCHER

we begin by treating the inner sum

ql−1

Xk=0(cid:18)τ(cid:18) k

ql

+

ρk,l

ql (cid:19) − τ(cid:18) k

ql(cid:19)(cid:19) ,

which we will show is bounded in absolute value by

l

Xi=1

l + C2q−1/m

l

ai(cid:16)C1q−1

(cid:17) ,

for constants C1 = C1(m, c, α) and C2 = C2(m, c, α).

Let ul be deﬁned as in (2.24), and denote by E a set of “exceptional”

indices

E = {0, 1, ul − 2, ul − 1, ul, ul + 1, ql − 1}

(for suﬃciently large l, these are all distinct). We split the sum (2.25)
into two parts

(2.25)

(2.26)

and

ql

Σ1 :=Xk∈E(cid:18)τ(cid:18) k
Xk=2(cid:18)τ(cid:18) k

ul−3

ql

Σ2 :=

+

+

ρk,l

ql (cid:19) − τ(cid:18) k

ql(cid:19)(cid:19)

ρk,l

ql (cid:19) − τ(cid:18) k

ql(cid:19)(cid:19) .

Now let l > l1 be suﬃciently large for ql > 4/ε. Since −1 < ρk,l < 2, it
follows from the conditions (2.4) on τ that
|Σ1| 6 Cq−1/m

(2.27)

,

l

where C = C(c). To ﬁnd a bound on Σ2, we ﬁrst rewrite the sum using
the mean value theorem. We have that

Σ2 =

τ ′(rk)

ρk,l
ql

,

ul−3

Xk=2

where rk ∈ (k/ql, (k + ρk,l)/ql) if ρk,l > 0 and rk ∈ ((k + ρk,l)/ql, k/ql)
if ρk,l < 0. It follows that

Σ2 −

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ul−3

Xk=2

τ ′(cid:18) k

ql (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql(cid:19) ρk,l

(2.28)

=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

6

ql (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql(cid:19)(cid:19) ρk,l

ql i|τ ′(x) − τ ′(y)|

ul−3

Xk=2(cid:18)τ ′(rk) − τ ′(cid:18) k
Xk=2

max
x,y∈h k−1
ql

, k+2

ul−3

2
ql

VI(τ ′

ql) 6 Cq−1/m

l

,

6

6
ql

where C = C(c), and for the last inequality we have used Lemma 2.9.

SETS OF BOUNDED REMAINDER

17

Finally, we need to ﬁnd a bound on

ul−3

Xk=2

τ ′(cid:18) k

ql(cid:19) ρk,l

ql

.

Recall from the proof of Proposition 2.5 that we may write ρk,l as

ρk,l = ωk,l

θl
al+1

+ xl,

where ωk,l = {kαl + γl}, and αl and γl are given in (2.17). Let us deﬁne
the two-dimensional sequence ω := (ω1(k), ω2(k))ql−1

k=0 , where

ω1(k) =

k
ql

, ω2(k) = ωk,l.

Moreover, let G : I 2 7→ R be the function given by

G(x, y) := χ[2/ql,(ul−3)/ql](x)τ ′(x) · h(y),

where h : I 7→ R is the linear function
θl
al+1

h(y) :=

y + xl.

We then have

ul−3

(2.29)

τ ′(cid:18) k

ql(cid:19) ρk,l

ql

=

1
ql

Xk=2

ql−1

Xk=0

G (ω1(k), ω2(k)) .

From the two-dimensional Koksma-Hlawka inequality [12, p. 151, p.
100] we get

(2.30)

(2.31)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

1
ql
6 D∗
6 D∗

0

ql−1

ql(ω2)VI(h) + D∗

ql(ω1)VI(χ[2/ql,(ul−3)/ql]τ ′) + D∗

G(x, y) dxdy(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
G(w1(k), w2(k)) −Z 1
0 Z 1
Xk=0
ql(ω)(cid:0)VI(χ[2/ql,(ul−3)/ql]τ ′) + VI(h) + VI 2(G)(cid:1) .
ai! ,

ql(ω2) 6 2 1 + 2

ql(ω) 6 2qlD∗

qlD∗

l

Xi=1

We now use this inequality to ﬁnd a bound on the sum (2.29). It is not
diﬃcult (see e.g. [12, p. 106]) to show that

ql(ω)VI 2(G)

where for the second inequality we have used (2.19). Moreover, we have

(2.32)

VI(h) = |θl|
al+1

6 1,

and using monotonicity of τ ′ and Lemma 2.9 we get

(2.33)

VI(χ[2/ql,(ul−3)/ql]τ ′) 6 VI(τ ′

l
where C = C(c) with c as in (2.4). It follows that

ql) 6 Cq1−1/m

,

(2.34)

VI 2(G) 6 VI(χ[2/ql,(ul−3)/ql]τ ′) · VI(h) 6 Cq1−1/m

l

.

18

SIGRID GREPSTAD AND GERHARD LARCHER

Lastly, we have that

ql (cid:19) − τ(cid:18) 2

ql(cid:19)(cid:19) ·(cid:18) θl

which by (2.4) is bounded by Cq−1/m
Inserting (2.31) – (2.34) and this integral estimate in (2.30), we get

, C = C(c, m), when l > l1.

l

Z 1
0 Z 1
(cid:12)(cid:12)(cid:12)(cid:12)

0

1
ql

ql−1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

=(cid:12)(cid:12)(cid:12)(cid:12)
G(x, y) dxdy(cid:12)(cid:12)(cid:12)(cid:12)
(cid:18)τ(cid:18) ul − 3
G (ω1(k), ω2(k))(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

6 Cq−1/m

+

6

l

l

2

ql(cid:16)1 + 2

l

Xi=1

l + C2q−1/m

l

Xi=1

ai(cid:16)C1q−1

,

2al+1

+ xl(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)
ai(cid:17)(cid:16)1 + 2Cq1−1/m
(cid:17) ,

l

(cid:17)

where the constants C1 and C2 depend only on c and m in (2.4). It
thus follows from (2.29) and (2.28) that |Σ2| satisﬁes the bound (2.26)
for l > l1. The same is true for |Σ1| by (2.27), and hence Σ1 + Σ2 in
(2.25) obeys the bound (2.26) as well. We get

bl−1

Xb=0

s

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xl=0

6 C ′a1 + C1

ql−1

ql

s

Xk=0(cid:18)τ(cid:18) k
Xl=1
Xi=1

al+1
ql

bl
ql

l+1

+

l

Xi=1

ρk,l

l

s

ai + C2

ql(cid:19)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ql (cid:19) − τ(cid:18) k
Xl=1
Xi=1
Xi=1

bl
q1/m
l
l+1

al+1
q1/m
l

Xl=0

ai,

s

s

Xl=0

6 C1

ai + C2

ai

and from Lemma 2.1 it follows that the latter expression is bounded
uniformly in s for almost every irrational α ∈ (0, 1). This veriﬁes
(2.23), and completes the proof of Proposition 2.6.

(cid:3)

2.3. Proof of Theorems 1.3 and 1.4. We now turn to the proofs
of Theorems 1.3 and 1.4. We will begin by proving a lemma showing
that the question of whether S ⊂ I 2 is a bounded remainder set can be
restated as a question of whether an associated function is of bounded
remainder.

Let S ⊂ I 2 be either a polygon or a set satisfying the conditions in
Theorem 1.4. We can then associate to S a function τS : [0, 1) 7→ [0,∞)
deﬁned as

(2.35)

τS(x) :=Z 1

0

χS(t,{tα + x}) dt.

A geometric interpretation of τS is illustrated in Figure 4. It is easy to
show that

Moreover, we have the following:

Z 1

0

τS(x) dx = λ(S).

SETS OF BOUNDED REMAINDER

19

1

y

S

α

1

τS(y)

Figure 4. Geometric interpretation of the function τS
associated to the set S.

Lemma 2.10. The set S ⊂ I 2 is a bounded remainder set for the
irrational rotation with slope α > 0 and starting point x = (x1, x2) ∈ I 2
if and only if τS is a bounded remainder function with respect to α.

Proof. By Remark 2.7, it will be suﬃcient to show that S ⊂ I 2 is a
bounded remainder set if and only if τS(x + x0) is a bounded remainder
function for some shift x0 ∈ I. We will verify this for x0 = {x2 − x1α}.
Recall from Deﬁnition 1.2 that S is a bounded remainder set if the
diﬀerence

∆T (S, α, x) =Z T

0

χS ({x1 + t},{x2 + tα}) dt − T λ(S)

is uniformly bounded in T . For a given T > 0 we let N = ⌊T⌋, and
denote by SN (α, x0) the diﬀerence

SN (α, x0) =

N −1

Xk=0

τS ({kα + x0}) − Nλ(S).

By Deﬁnition 2.2, the function τS(x + x0) is of bounded remainder if
SN (α, x0) is bounded uniformly in N. Thus, to prove Lemma 2.10 it is
suﬃcient to show that

(2.36)

|SN (α, x0) − ∆T (S, α, x)| 6 C,

where C is a constant independent of T (or equivalently, of N).

20

SIGRID GREPSTAD AND GERHARD LARCHER

To verify (2.36), we observe that

SN (α, x0) =

χS (t,{(t + k)α + x0}) dt − Nλ(S)

0

χS ({t},{tα + x0}) dt − Nλ(S)

0

N −1

−x1

Xk=0Z 1
=Z N
=Z ⌊T ⌋−x1
Z 0
(cid:12)(cid:12)(cid:12)(cid:12)
χS ({x1 + t},{x2 + tα}) dt(cid:12)(cid:12)(cid:12)(cid:12)
Z T
(cid:12)(cid:12)(cid:12)(cid:12)
χS ({x1 + t},{x2 + tα}) dt(cid:12)(cid:12)(cid:12)(cid:12)

⌊T ⌋−x1

−x1

+

χS ({x1 + t},{x2 + tα}) dt − ⌊T⌋λ(S).

It is now easy to see that the diﬀerence in (2.36) must be bounded by

+ {T}λ(S) 6 4,
thus verifying (2.36) and completing the proof of Lemma 2.10.

(cid:3)

With Lemma 2.10 established, we are equipped to prove Theorem

1.3.

Proof of Theorem 1.3. It will be suﬃcient to consider the special case
when S is a triangle. This is easy to see when S is a convex poly-
gon; S can then be partitioned into ﬁnitely many triangles which are
disjoint (up to boundaries), and which all have the property that no
edge has slope α. Finally, since any union of ﬁnitely many disjoint
bounded remainder sets is again a bounded remainder set for the irra-
tional rotation with slope α, the result follows. A similar, but slightly
more involved argument can be given to show that also the case when
S is non-convex follows from the triangle case. We thus aim to prove
that for almost all α > 0 and every x ∈ I 2, every triangle S with no
edge of slope α is a bounded remainder set for the continuous irrational
rotation with slope α and starting point x.

Fix some α, and let S be a triangle with no edge of slope α. Denote
by l(y) the intersection in the plane of S and the straight line with slope
α through the point (0, y), and let TS : R 7→ [0,∞) be the function

TS(y) = |l(y)|
√1 + α2

.

Then TS is a (possibly shifted) hat function as deﬁned in (2.3) and τS
in (2.35) is given by

τS(x) = Xm∈Z

TS(x + m).

Let x ∈ I 2 be any given starting point for the irrational rotation. By
Lemma 2.10, the triangle S is a bounded remainder set if and only if
τS is a bounded remainder function with respect to α. By Proposition

SETS OF BOUNDED REMAINDER

21

2.5, this is indeed the case for every irrational α > 0 whose continued
fraction expansion satisﬁes

(2.37)

s

Xl=0

al+1
q1/2
l

l+1

Xk=1

ak 6 C

for some constant C independent of s, i.e. a set of full measure. This
completes the proof of Theorem 1.3.
(cid:3)

We complete this section with the proof of Theorem 1.4. Recall
that this result says that for every x ∈ I 2 and almost all α > 0,
every convex set S whose boundary is a twice diﬀerentiable curve with
positive curvature at every point is a bounded remainder set for the
continuous irrational rotation with slope α and starting point x.

Proof of Theorem 1.4. We have seen in Lemma 2.10 that the set S
is of bounded remainder for the irrational rotation with slope α and
starting point x ∈ I 2 if and only if the associated function τS in (2.35)
is of bounded remainder with respect to α. Suppose that τS is of the
form

(2.38)

τS(x) = Xm∈Z

TS(x + m),

where TS is the shift of a dome function as given in Deﬁnition 2.4.
Then this would be an immediate consequence of Proposition 2.6 and
Remark 2.7 for every x ∈ I 2 and every irrational α > 0 satisfying
(2.37). Our proof is thus complete if we can show that τS is of the form
(2.38) for some shifted dome function TS.

As in the proof of Theorem 1.3, we let l(y) be the intersection in the
plane of the set S and the straight line with slope α through the point
(0, y), and we let TS : R 7→ [0,∞) be the function

TS(y) = |l(y)|
√1 + α2

.

Then τS is given in (2.38). It is clear that TS is a continuous function
supported on some interval [B1, B2], and that an appropriate shift of
TS would satisfy condition (1) in Deﬁnition 2.4. We will show that also
condition (2) is satisﬁed for this shift of TS; that is, we can ﬁnd c > 0,
m > 0 and ε > 0 such that

TS(B1 + x) 6 cx1/m,

and

whenever 0 6 x < ε. We verify only the latter inequality (the argument
for the former is equivalent).

TS(B2 − x) 6 cx1/m,

Let C = (C1(s), C2(s)) denote the boundary of S parametrized by
arc length, and denote by L its total length. We then have |C ′(s)| = 1
and C ′(s) ⊥ C ′′(s) for all s ∈ [0, L]. The curvature κ(s) at the point

22

SIGRID GREPSTAD AND GERHARD LARCHER

p

C

y

B2

x

Figure 5. The curve C and the new coordinate axes x
and y.

C(s) is given by κ(s) = |C ′′(s)|, and assumed positive for all s ∈ [0, L].
We let

(2.39)

k := min
s∈[0,L]

κ(s).

The line with slope α through the point (0, B2) in the plane will
intersect the curve C at a single point p. We let this line be the x-axis in
a new coordinate system (x, y) where p is the origin (see Figure 5), and
view C as a curve in these coordinates with C(0) = (C1(0), C2(0)) =
(0, 0). We may then think of a section of C around p as the graph of
the function H : (−δ, δ) 7→ [0,∞) given by
H(x) = C2(cid:0)C −1
1 (x)(cid:1) .

1(0) = 1, and since C1 and C2 are both twice

2(0) = 0 and C ′

We have C ′
continuously diﬀerentiable it follows that
2(C −1
1(C −1

H ′(x) =

C ′
C ′

1 (x))
1 (x))

and

H ′′(x) =

C ′′

2 (s)C ′

2(s)C ′′

1 (s)

1(s) − C ′
1(s))3
(C ′

,

s = C −1

1 (x),

are both well-deﬁned and continuous on some interval (−δ, δ). By
choosing δ suﬃciently small we can ensure that

1
2

1(C −1

(cid:12)(cid:12)C ′
1 (x) and recalling that C ′(s) ⊥ C ′′(s)) in turn implies

x ∈ (−δ, δ),

,

1 (x))(cid:12)(cid:12) >
|H ′′(x)| = |C ′′(s)| · |C ′(s)|
|C ′

1(s)|3

,

x ∈ (−δ, δ),

>

k
8

which (for s = C −1

(2.40)

with k given in (2.39).

SETS OF BOUNDED REMAINDER

23

p

l

y

B2

B2 − z

Figure 6. The intersection l of S and the line of slope
α through the point (0, B2 − z).

We now use this lower bound on |H ′′(x)| to ﬁnd an upper bound on

TS(B2 − z) for suﬃciently small z > 0. We have
|l|√1 + α2
(2.41)
,

TS(B2 − z) =

where l is the intersection of S with the line of slope α through the point
(0, B2 − z), illustrated in Figure 6. The line segment l is at height y =
z/√1 + α2 above the point p (see Figure 6). If y < min{H(δ), H(−δ)},
then we may denote by x1, x2 the two values of x ∈ (−δ, δ) satisfying
H(x) = y, and

(2.42)

|l| 6 2 max{|x1|,|x2|} .

By Taylor’s theorem we have

y = H(xi) = H(0) +

H ′(0)

1!

xi +

H ′′(ri)

2!

x2
i =

H ′′(ri)

2!

x2
i ,

for i = 1, 2 and some ri ∈ (−δ, δ), and from (2.40) it thus follows that

|xi| =(cid:18) 2y

H ′′(ri)(cid:19)1/2

6

4
√k · y1/2,

i = 1, 2.

Hence, from (2.42) we get

(2.43)

|l| 6

8
√k · y1/2 6

8
√k · z1/2,

and by (2.41) and (2.43) we have

TS(B2 − z) 6

8

pk(1 + α2) · z1/2.

This veriﬁes that a shift of the function TS satisﬁes the growth condition

(2) in Deﬁnition 2.4 with c = 8/pk(1 + α2), m = 2 and some ε > 0
(for instance, ε = min{H(δ), H(−δ)} will suﬃce). The function τS is

24

SIGRID GREPSTAD AND GERHARD LARCHER

thus of the form (2.38), where TS is the shift of a dome function, and
this completes the proof of Theorem 1.4.
(cid:3)

3. Proof of Theorem 1.7

In this section we present the proof of Theorem 1.7. For the proof
of part (a) we simply give an outline, as this proof largely follows the
proof given above for Proposition 2.5. Part (b), on the other hand, is
proven in full detail. Lastly, we present the proof of part (c).

Proof of Theorem 1.7 a. Fix an irrational α > 0 with continued frac-
tion expansion α = [0; a1, a2, a3,· · · ] satisfying a1 = 1 and al+1 > q7
l .
One can show that there are uncountably many such irrationals.
Let S be the triangle with vertices (0, 0), (0, 1) and (K, 1) for some
0 < K < 1 to be determined. We will assume that 1−Kα > 0. Denote
by τS the function in (2.35) associated to S; this is a hat function as
deﬁned in (2.3), with a = 1 − Kα and b = 1. By Lemma 2.10, the
triangle S is a bounded remainder set for the continuous irrational
rotation with slope α and some arbitrary starting point x ∈ I 2 if and
only if τS is a bounded remainder function with respect to α. In what
follows we show that the latter is not the case, and accordingly S is
not a bounded remainder set.

l=0 blql, one can show by calculations analogous to those

in the proof of Proposition 2.5 that

N −1

For N =Ps
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xk=0

(3.1)

τS({kα}) −

NK

2 (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

= C

s

Xl=0

ξl(1 − ξl)

bl
ql

+ O(1),

where C depends only on K and α, and ξl = {qla} = {ql(1 − Kα)}.
For x ∈ R, let kxk denote the minimal distance from x to an integer,
and note that

ξl(1 − ξl) >

1
2 kqlak .

It is a well-known fact (see e.g. [11, p. 69]) that for almost all a ∈ (0, 1)
one can ﬁnd a positive constant c such that

kn · ak >

c
n2

for all n > 2. Thus, one can indeed ﬁnd K ∈ (0, 1) such that a =
1 − Kα > 0, and moreover

s

C

Xl=0

ξl(1 − ξl)

bl
ql

> C

kqlak

bl
ql

> C

s

Xl=0

s

Xl=0

bl
q3
l

.

Now let bl := q4

bounded from below by CPs

l . Then the sum on the right hand side in (3.1) is
l=0 ql, which tends to inﬁnity as s → ∞.

SETS OF BOUNDED REMAINDER

25

For the sequence of integers Ns =Ps

Ns−1

l=0 q5

l , we thus have

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

τS({kα}) − Nsλ(S)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

→ ∞

as s → ∞. This shows that τS is not a bounded remainder function
with respect to α, and completes the proof of Theorem 1.7 a.

(cid:3)

l

Proof of Theorem 1.7 b. Fix an irrational α ∈ (1/4, 1/2) with contin-
ued fraction expansion α = [0; a1, a2, . . .] satisfying al+1 > q100
and
pl even for an inﬁnite number of odd indices l, say for the sequence
l1 < l2 < l3 . . .. One can show that there are uncountably many such
irrationals.
Let S be the disc with diameter d := α/√1 + α2 illustrated in Figure
7. By Lemma 2.10, the set S is of bounded remainder for the continuous
irrational rotation with slope α and arbitrary starting point x ∈ I 2 if
and only if the associated function τS in (2.35) is a bounded remainder
function with respect to α. In what follows, we will show that there
exists an x ∈ I and a sequence of integers N1 < N2 < N3 . . . such that

Ni−1

Xk=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

τS ({kα + x}) − Niλ(S)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

→ ∞

as i → ∞. By Remark 2.7, this proves τS is not a bounded remainder
function, and accordingly S is not a bounded remainder set.

1

α

S

α

1

Figure 7. The disc S with diameter d = α/√1 + α2.

The function τS associated to S is given explicitly by

τS(y) =( α

0 ,

1+α2p1 − (1 − 2y/α)2 , 0 6 y 6 α ;

α < y 6 1 ,

26

SIGRID GREPSTAD AND GERHARD LARCHER

and we note that

(3.2)

π
4 ·
We introduce the notation SN (x) for the sum

λ(S) =Z 1

τS(y) dy =

0

α2

1 + α2 .

SN (x) :=

τS ({kα + x}) .

N −1

Xk=0

Let us now ﬁx some i (and thereby an odd index li), put

p := pli = 2m (m ∈ N),

q := qli,

and evaluate the sum SN (x) for N := q11 and some x ∈ [0, 1/q]. We
then have

(3.3)

SN (x) =

Recall from (2.2) that

Using this fact, we get

q10−1

q−1

Xk=0
Xj=0
q(cid:12)(cid:12)(cid:12)(cid:12)

6

p

α −

(cid:12)(cid:12)(cid:12)(cid:12)

τS ({(jq + k)α + x}) .

1

q2ali+1

6

1
q102 .

kjqαk < j kqαk 6

j
q101 <

1
q91 ,

where kxk denotes the minimal distance from x ∈ R to an integer. It
follows that

and hence

(3.4)

p

q(cid:13)(cid:13)(cid:13)(cid:13)

α −
1
q90 ,

(cid:12)(cid:12)(cid:12)(cid:12)

<

p
q

1
q91 +

q
q102 <

(cid:13)(cid:13)(cid:13)(cid:13)
6 kjqαk + k(cid:13)(cid:13)(cid:13)(cid:13)
+ x(cid:27)(cid:13)(cid:13)(cid:13)(cid:13)
{(jq + k)α + x} −(cid:26)k ·
6(cid:12)(cid:12)(cid:12)(cid:12)
q90(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)
+ x(cid:27)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)
τS(cid:18) 1
τS ({(jq + k)α + x}) − τS(cid:18)(cid:26)k ·
+ x(cid:27)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
1+α2p1 − (1 − 2qy/p)2 ,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
σ(y) :=( α

0 6 y 6 p/q ;
p/q < y 6 1 .

τS(cid:18)(cid:26)k ·

SN (x) − q10

1
q44 =

< q11 ·

Xk=0

p
q

p
q

0 ,

q−1

In light of (3.4), we introduce the function

Combining this bound with (3.3), we get

<

1
q44 .

1
q33 .

SETS OF BOUNDED REMAINDER

27

Since the index li is odd, we have α < p/q and σ(y) = τS(αqy/p) for
all y ∈ [0, 1). From
αq

p

Combining this bound with (3.4), we get

it thus follows that

q

=

p(cid:12)(cid:12)(cid:12)(cid:12)
τS(cid:18) αp

q

(cid:12)(cid:12)(cid:12)(cid:12)

p − 1(cid:12)(cid:12)(cid:12)(cid:12)
|σ(y) − τS(y)| =(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Xk=0

SN (x) − q10

q−1

(3.5)

q−1

Xk=0

σ(cid:18)(cid:26)k ·

p
q

+ x(cid:27)(cid:19) =

(3.6)

where

Gm(x) :=

1
2m

Note that some of the above estimates hold only for q greater than
some lower threshold q > q0.

Let us now have a closer look at the sum over σ in (3.5). We have

<

<

p−1

p
q

α −

1
α ·

1
q101

1
q33 +

1
q102 <

q(cid:12)(cid:12)(cid:12)(cid:12)
<(cid:12)(cid:12)(cid:12)(cid:12)
y(cid:19) − τS(y)(cid:12)(cid:12)(cid:12)(cid:12)
q101(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)
τS(cid:18) 1
+ x(cid:27)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
σ(cid:18)(cid:26)k ·
σ(cid:18)k
+ x(cid:19)
Xk=0s1 −(cid:18)1 −
Xk=0 s1 −(cid:18)1 −
x(cid:17) ,
, x ∈(cid:20)0,

1 + α2 · 2mGm(cid:16) q
m − x(cid:19)2

Xk=0

1 + α2

1 + α2

2m−1

m

p−1

=

=

=

α

α

α

q

<

1
q50 .

q11
q50 <

1
q32 .

2k
p −

2q
p

k
m −

q
m

x(cid:19)2
x(cid:19)2

1

m(cid:19) .

2m−1

Xk=0 s1 −(cid:18)1 −

k

The function Gm is illustrated in Figure 8. It is clear that Gm(x) =
Gm(1/m − x), and by elementary analysis one can show that Gm in-
creases on [0, 1/(2m)) in such a way that

Gm(cid:18) 1

3m(cid:19) > Gm(cid:18) 1

6m(cid:19) +

2c
m3/2

for some c > 0. From this inequality one can deduce that there exists a
subinterval Λ ⊂ [0, 1/(2m)] of length at least 1/(6m) such that either
(3.7)

Gm(x) >

+

c

c
m3/2 =

π
4

m3/2

or

(3.8)

Gm(x) <

1

2Z 2
0 p1 − (1 − y)2 dy +
2Z 2
0 p1 − (1 − y)2 dy −

1

c
m3/2 =

π
4 −

c

m3/2

28

SIGRID GREPSTAD AND GERHARD LARCHER

Gm(x)

1/2m

x

1/m

Figure 8. The function Gm(x).

for all x ∈ Λ. We assume in what follows that (3.7) holds for all x ∈ Λ
(the case when (3.8) holds is treated similarly). Then for ˜x ∈ ˜Λ, where

˜Λ := (m/q)Λ ⊂ [0, 1/(2q)),

we have q˜x/m ∈ Λ, and from (3.6) and (3.7) it follows that
m3/2(cid:17) .

1 + α2 · 2m(cid:16)π

+ ˜x(cid:27)(cid:19) >

σ(cid:18)(cid:26)k ·

(3.9)

p
q

+

q−1

Xk=0

α

4

c

In the following we let c1, c2, . . . denote positive absolute constants.
From (3.9) and (3.5) we get

SN (˜x) > q10

q−1

Xk=0
> q10 · 2m ·
> N ·

p
q ·

p
q

σ(cid:18)(cid:26)k ·
1 + α2 (cid:16) π

πα

α

4(1 + α2)
πα2

> N ·

4(1 + α2)

+ ˜x(cid:27)(cid:19) −

1
q32

c

m3/2(cid:17) −

1
q32

+

4
+ c1q9

+ c1q9 = Nλ(S) + c1q9,

where we recall from (3.2) that λ(S) is the integral over τS and the
measure of the disc S in Figure 7. Thus, we have shown that

(3.10)

SN (˜x) − Nλ(S) > c1q9 ,

˜x ∈ ˜Λ.

Finally, we deﬁne the set ¯Λ ⊂ I by

˜Λ(j) := ˜Λ +

j
q

,

¯Λ :=

˜Λ(j).

q−1

[j=0

SETS OF BOUNDED REMAINDER

29

Since λ(˜Λ) > 1/(6q), we have λ(¯Λ) > 1/6. Choose some x ∈ ¯Λ, and
ﬁnd j ∈ {0, 1, . . . , q − 1} such that
j
x = ˜x +
q

˜x ∈ ˜Λ.

,

Furthermore, choose kj ∈ {0, 1, . . . , q−1} such that kjp ≡ q−j(mod q),
and note that

(cid:13)(cid:13)(cid:13)(cid:13)

kjα +

kjα −

=(cid:13)(cid:13)(cid:13)(cid:13)

From this and the fact that |τS| 6 1, it follows that

<

1
q101 .

p

q(cid:13)(cid:13)(cid:13)(cid:13)

α −

kjp

N −1

6 kj(cid:13)(cid:13)(cid:13)(cid:13)
q (cid:13)(cid:13)(cid:13)(cid:13)
Xk=0
q(cid:27)(cid:19) − c2q

τS ({kα + x}) +
τS(cid:18)(cid:26)kα + x −
τS ({kα + ˜x}) − c2q = SN (˜x) − c2q,

j

j

kj

q(cid:13)(cid:13)(cid:13)(cid:13)
Xk=0
Xk=0
Xk=0

N −1

N −1

τS ({kα + kjα + x}) − q

SN (x) >

>

=

and from (3.10) we thus get

SN (x) − Nλ(S) > c3q9

(3.11)
for all x ∈ ¯Λ.
The above analysis can be carried out for each li (given that qli is
above the threshold qli > q0). That is, for each i, we ﬁnd ¯Λi ⊂ I of
measure λ(¯Λi) > 1/6 such that (3.11) holds for all x ∈ ¯Λi with q = qli
and N = q11. Now ﬁx x ∈ I such that x ∈ ¯Λi for inﬁnitely many i, and
for each such i let qi = qli and Ni = q11
. Then for these Ni, we have
i

|SNi(x) − Niλ(S)| =(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Ni−1

Xk=0

τS ({kα + x}) − Niλ(S)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

as i → ∞. This veriﬁes that τS is not a bounded remainder function
with respect to α, and completes the proof of Theorem 1.7 b.

(cid:3)

→ ∞

Proof of Theorem 1.7 c. Let S be the triangle with vertices (0, 0), (0, 1)
and (1, 0). Fix some slope α > 0 and starting point x ∈ I 2. For
simplicity we assume that α < 1 (the proof is similar when α > 1).
By Lemma 2.10, the set S is of bounded remainder for the continuous
irrational rotation with slope α and starting point x if and only if the
associated function τS in (2.35) is of bounded remainder with respect
to α. For the speciﬁc triangle S, we have

(3.12)

τS(x) =( 1−x

1+α ,
1−x
1+α + 2−x

1+α − 1−x
α ,

0 6 x 6 1 − α ;
1 − α < x 6 1 .

30

SIGRID GREPSTAD AND GERHARD LARCHER

It is a well-known fact that a 1-periodic function f which is integrable
over the unit interval I is a bounded remainder function with respect
to α if and only if there exists a bounded and measurable 1-periodic
function g satisfying the equation

f (x) −Z 1

0

f (t) dt = g(x) − g(x + α)

for almost every x. This is known as the cohomological equation for f .
By a classical result of Gottschalk and Hedlund [6, Theorem 14.11], the
function g can be chosen to be continuous whenever f is continuous.
Thus, our proof is complete if we can ﬁnd a continuous 1-periodic
function g such that

(3.13)

τS(x) −Z 1

0
where τS is given in (3.12).

τS(t) dt = g(x) − g(x + α),

Let g be the continuous 1-periodic function deﬁned on I by

g(x) =

x(x − 1)
2α(1 + α)

.

It is straightforward to check that this function satisﬁes (3.13). This
conﬁrms that τS is a bounded remainder function with respect to α,
and completes the proof of Theorem 1.7 c.
(cid:3)

References

[1] J. Beck, Super-uniformity of the Typical Billiard Path, Bolyai Society Math-
ematical Studies 21, An Irregular Mind (Szemer´edi is 70), 39–129, Springer,
2010.

[2] J. Beck, Strong uniformity, Radon Series on Computational and Applied Math-
ematics 15, Uniform Distribution and Quasi-Monte Carlo Methods, 17–44, De
Gruyter, Berlin, 2014.

[3] J. Beck, From Khinchin’s conjecture on strong uniformity to superuniform mo-

tions., Mathematika 61 (2015), 591–707.

[4] M. Drmota, Irregularities of continuous distributions, Ann. Inst. Fourier 39

(1989), 501–527.

[5] M. Drmota and R. Tichy, Sequences, Discrepancies and Applications, Springer

Lecture Notes in Mathematics 1651, Springer, 1997.

[6] W. H. Gottschalk and G. A. Hedlund, Topological dynamics, (Colloquium Pub-
lications of the American Mathematical Society (AMS). Vol. 36) Providence,
R.I.: American Mathematical Society (AMS). VIII, 1955.

[7] S. Grepstad and N. Lev, Sets of bounded discrepancy for multi-dimensional

irrational rotation, Geom. Funct. Anal. 25 (2015), 87–133.

[8] E. Hecke, ¨Uber analytische Funktionen und die Verteilung von Zahlen mod.

eins, Abh. Math. Semin. Univ. Hamb. 1 (1921), 54–76. (German).

[9] P. Hellekalek and G. Larcher, On functions with bounded remainder, Ann. Inst.

Fourier 39 (1989), 17–26.

[10] H. Kesten, On a conjecture of Erd˝os and Sz¨usz related to uniform distribution

mod 1, Acta Arith. 12 (1966), 193–212.

[11] A. Khinchin, Continued fractions, The University of Chicago Press, 1964.

SETS OF BOUNDED REMAINDER

31

[12] L. Kuipers and H. Niederreiter, Uniform distribution of sequences, Wiley, New

York, 1974.

[13] A. Ostrowski, Mathematische Miszellen IX: Notiz zur Theorie der Diophan-
tischen Approximationen, Jahresber. Dtsch. Math.-Ver. 36 (1927), 178–180
(German).

[14]

, Mathematische Miszellen. XVI: Zur Theorie der linearen diophantis-
chen Approximationen, Jahresber. Dtsch. Math.-Ver. 39 (1930), 34–46 (Ger-
man).

[15] J. Schoissengeier, Regularity of distribution of (nα)-sequences, Acta Arith. 133

(2008), no. 2, 127–157.

Institute of Financial Mathematics and Applied Number Theory, Jo-
hannes Kepler University Linz, Altenbergerstr. 69, A-4040 Linz, Aus-
tria.

E-mail address: sigrid.grepstad@jku.at

Institute of Financial Mathematics and Applied Number Theory, Jo-
hannes Kepler University Linz, Altenbergerstr. 69, A-4040 Linz, Aus-
tria.

E-mail address: gerhard.larcher@jku.at

