6
1
0
2

 
r
a

 

M
2
1

 
 
]

.

R
P
n
i
f
-
q
[
 
 

1
v
4
7
8
3
0

.

3
0
6
1
:
v
i
X
r
a

Analysis of the nonlinear option pricing model under

variable transaction costs

Daniel ˇSevˇcoviˇc ∗

Magdal´ena ˇZitˇnansk´a †

Abstract

In this paper we analyze a nonlinear Black–Scholes model for option pricing
under variable transaction costs. The diﬀusion coeﬃcient of the nonlinear parabolic
equation for the price V is assumed to be a function of the underlying asset price and
the Gamma of the option. We show that the generalizations of the classical Black–
Scholes model can be analyzed by means of transformation of the fully nonlinear
parabolic equation into a quasilinear parabolic equation for the second derivative of
the option price. We show existence of a classical smooth solution and prove useful
bounds on the option prices. Furthermore, we construct an eﬀective numerical
scheme for approximation of the solution. The solutions are obtained by means
of the eﬃcient numerical discretization scheme of the Gamma equation. Several
computational examples are presented.

Key words. Black–Scholes equation with nonlinear volatility, quasilinear parabolic equa-
tion, variable transaction costs

2000 Mathematical Subject Classiﬁcations. 35K15 35K55 90A09 91B28

1

Introduction

The classical linear Black–Scholes option pricing model with a constant historical volatility
was proposed in [7]. The model was derived under several restrictive assumptions, such
as assumption on market completeness, continuous trading and zero transaction costs.
According to this option pricing theory the price V (S, t) of a contingent claim written
on the underlying asset S > 0 at the time t ∈ [0, T ] is a solution to the linear parabolic
equation

∂tV +

1
2

σ2S2∂2

SV + rS∂SV − rV = 0,

(1)

∗Department of Applied Mathematics and Statistics, Comenius University, 842 48 Bratislava, Slovakia,
†Department of Mathematics and Actuarial Science, University of Economics in Bratislava, 852 35

sevcovic@fmph.uniba.sk

Bratislava, Slovakia, magdalena.zitnanska@euba.sk
The research was supported by FP7-PEOPLE-2012-ITN project # 304617 STRIKE and APVV–SK-PT-
0009-12 grants.

1

where r > 0 is the risk-free interest rate of a zero-coupon bond and σ is the histori-
cal volatility of the underlying asset which is assumed to follow a stochastic diﬀerential
equation of the geometric Brownian motion, i.e.

dS = ρS dt + σS dW,

(2)

with a drift ρ (cf. Kwok [24], Wilmott et al. [31, 32]).

However, practical analysis of market data shows the need for more realistic models
taking into account the aforementioned drawbacks of the classical Black–Scholes theory. It
stimulated development of various nonlinear option pricing models in which the volatility
function is no longer constant, but is a function of the solution V itself. We focus on the
case where the volatility depends on the second derivative ∂2
SV of the option price with
respect to the underlying asset price S.

∂tV +

1
2

ˆσ(S∂2

SV )2S2∂2

SV + rS∂SV − rV = 0,

(3)

where ˆσ(S∂2
(Gamma is the second derivative of V with respect to S).

SV ) is a function of the product of the asset price and Gamma of the option

Motivation for studying the nonlinear extensions of the classical Black-Scholes equa-
tion (3) with a volatility depending on S∂2
SV arises from classical option pricing models
taking into account non–trivial transaction costs due to buying and selling assets (cf.
Leland [26]), market feedbacks eﬀects due to large traders choosing given stock–trading
strategies (cf. Frey et al.
[12, 13], Sch¨onbucher and Wilmott [30]), risk from a volatile
and unprotected portfolio (see Jandaˇcka and ˇSevˇcoviˇc [19]) or investors preferences (cf.
Barles and Soner [6]).

One of the ﬁrst nonlinear models taking into account transaction costs is the Leland
model [26] for pricing the call and put options. This model was further extended by
Hoggard, Whalley and Wilmott [16] for general type of derivatives. Qualitative and
numerical properties of this model were analyzed by Grandits and Schachinger [14], Imai
et al. [17], Ishimura [18], Grossinho and Morais [15] and others.

SV(cid:1)(cid:1) =

(cid:26) σ2(1 − Le),

σ2(1 + Le),

if ∂2
if ∂2

SV > 0,
SV < 0,

(4)

In this model the variance ˆσ2 is given by

ˆσ(S∂2

SV )2 = σ2(cid:0)1 − Le sgn(cid:0)S∂2
(cid:113) 2

√
C0

σ

π

∆t

is the so-called Leland number, σ is a constant historical volatility,
where Le =
C0 > 0 is a constant transaction costs per unit dollar of transaction in the underlying asset
market and ∆t is the time–lag between consecutive portfolio adjustments. The nonlinear
model (3) with the volatility function given as in (4) can be also viewed as a jumping
volatility model investigated by Avellaneda and Paras [3].

The important contribution in this direction has been presented in the paper [1] by
Amster, Averbuj, Mariani and Rial, where the transaction costs are assumed to be a
nonincreasing linear function of the form C(ξ) = C0 − κξ, (C0, κ > 0), depending on the
volume of trading stock ξ ≥ 0 needed to hedge the replicating portfolio. A disadvantage
of such a transaction costs function is the fact that it may attain negative values when
the amount of transactions exceeds the critical value ξ = C0/κ. In the model studied

2

by Amster et al. [1] (see also Averbuj [4], Mariani et al. [28]) volatility function has the
following form:

In [5] Bakstein and Howison investigated a parametrized model for liquidity eﬀects
In their model ˆσ is a quadratic function of the term

arising from the asset trading.
H = S∂2

SV :

(5)

(6)

ˆσ(S∂2

SV )2 = σ2(cid:0)1 − Le sgn(cid:0)S∂2
(cid:32)
(cid:114) 2

1 + ¯γ2(1 − α)2 + 2λS∂2

¯γ sgn(cid:0)S∂2

SV(cid:1) + 2

+ 2

π

ˆσ(S∂2

SV )2 =σ2

SV(cid:1) + κS∂2
SV(cid:1) .

SV + λ2(1 − α)2(cid:0)S∂2
SV(cid:1)2
SV(cid:12)(cid:12)(cid:33)
(cid:114) 2
λ(1 − α)2¯γ(cid:12)(cid:12)S∂2

.

π

it is related to the Leland number through relation 2¯γ(cid:112)2/π = Le. Finally, α transforms

it scales the slope of the
The parameter λ corresponds to a market depth measure, i.e.
average transaction price. Next, the parameter ¯γ models the relative bid–ask spreads and
the average transaction price into the next quoted price, 0 ≤ α ≤ 1.

The risk adjusted pricing methodology (RAPM) model takes into account risk from
the unprotected portfolio was proposed by Kratka [22]. It was generalized and analyzed
by Jandaˇcka and ˇSevˇcoviˇc in [19]. In this model the volatility function has the form:

SV )2 = σ2(cid:16)

1 − µ(cid:0)S∂2
SV(cid:1) 1

3

(cid:17)

ˆσ(S∂2

,

(7)

0 R/2π) 1
where σ > 0 is a constant historical volatility of the asset price return and µ = 3(C 2
3 ,
where C0, R ≥ 0 are non–negative constants representing cost measure and the risk pre-
mium measure, respectively.

The structure of the paper is as follows. In the next section we present a nonlinear
option pricing model under variable transaction cost. It turns out that the volatility func-
tion depends on S∂2
SV . In particular case of constant or linearly decreasing transaction
costs it is a generalization of the Leland [26] and Amster et al. model [1], respectively.
Section 3 is devoted to transformation of the fully nonlinear option pricing equation into
a quasilinear Gamma equation. We prove existence of classical H¨older smooth solutions
and we derive useful bounds on the solution. In section 4 we propose a numerical scheme
for solving the Gamma equation based on ﬁnite volume method. We also present several
numerical examples of computation of option prices based on a solution to the nonlinear
Black–Scholes equation under variable transaction costs.

2 Option pricing model under variable transaction

costs

One of the key assumptions of the classical Black–Scholes theory is the possibility of
continuous adjustment (or hedging) of the portfolio consisting of options and underlying
assets. In the context of transaction costs needed for buying and selling the underlying
asset, continuous hedging leads to an inﬁnite number of transactions and the unbounded

3

total transaction costs. The Leland model [26] (see also Hoggard, Whalley and Wilmott
[16]) is based on a simple, but very important modiﬁcation of the Black–Scholes model,
which includes transaction costs and possibility of rearranging the portfolio at discrete
times. Since the portfolio is maintained at regular intervals, it means that the total
transaction costs are limited.

Our derivation of the variable transaction costs option pricing model follows ideas
proposed by Leland in [26]. Therefore we recall crucial steps of derivation of Leland’s
approach for modeling transaction costs. We assume that the cost C0 per one transaction
is constant, i.e. it does not depend on the volume of transactions. The underlying asset
is purchased at a higher ask price Sask and it is sold for a lower bid price Sbid. The price
of S is then computed as an average of ask and bid prices, i.e., S = (Sask + Sbid)/2. Then
C0 ≥ 0 represents a constant percentage of the cost of the sale and purchase of a share
relative to the price S, i.e.

C0 =

Sask − Sbid

S

Sask − Sbid
Sask + Sbid

.

= 2

(8)

The value Π = V + δS of the synthesized portfolio consisting of one option in a long
position at the price V and δ underlying assets at the price S changes over the time
interval [t, t + ∆t] by selling ∆δ < 0 or buying ∆δ > 0 short positioned assets. It means
that the purchase or selling ∆δ assets at a price of S yields the additional cost ∆T C for
the option holder

C0|∆δ|.
Consequently, the value of the portfolio changes to:

∆T C =

S
2

(9)

(10)

∆Π = ∆(V + δS) − ∆T C

during the time interval [t, t+∆t]. The key step in derivation of the Leland model consists
in approximation of the change ∆T C of transaction costs by its expected value E[∆T C],
i.e. ∆T C ≈ rT CS∆t, where the transaction costs measure rT C is deﬁned as the expected
value of the change of the transaction costs per unit time interval ∆t and price S:

rT C =

E[∆T C]

S∆t

.

Hence equation (10) describing the change in the portfolio has the form:

∆Π = ∆(V + δS) − rT CS∆t.

Since the underlying asset follows the geometric Brownian motion we have

(11)

(12)

∆S = ρS∆t + σS∆W,

(13)
where ∆W = Wt+∆t − Wt is the increment of the Wiener process. Now, assuming the
change ∆Π in the portfolio is balanced by a bond with the risk-free rate r ≥ 0, i.e.
∆Π = rΠ∆, using It¯o’s lemma for ∆V and applying the delta hedging strategy δ = −∂SV
we obtain generalization of the Black–Scholes equation

∂tV +

1
2

σ2S2∂2

SV + rS∂SV − rV − rT CS = 0.

(14)

4

Furthermore, applying It¯o’s formula for the function δ = −∂SV we obtain

plus higher order terms in
Hence, in the lowest order O(

√
SV Φ

SV ∆W = −σS∂2

∆δ = −σS∂2
√
∆t. Here Φ ∼ N (0, 1) a normally distributed random variable.
√
∆t) we have that

∆t

|∆δ| = α|Φ|, where α := σS(cid:12)(cid:12)∂2

SV(cid:12)(cid:12)√

(15)
For the case of constant transaction costs given by (9), using the fact that E[|Φ|] =

∆t.

E[∆T C]

=

1
2

C0S

E[|∆δ|]

∆t

=

1
2

S2

C0√
∆t

σ|∂2

SV | =

1
2

σ2S2Le|∂2

SV |,

π

(cid:114) 2

(cid:112)2/π we obtain
(cid:113) 2

rT CS =

∆t

√
C0

where Le =
the Leland equation (3) with the volatility function given by (4).

is the Leland number. Inserting the term rT CS into (14) we obtain

∆t

π

σ

Following derivation of the Leland model we present our approach on modeling vari-
able transaction costs. Large investors can expect a discount due to large amount of
transactions. The more they purchase the less they will pay per one traded underlying
asset. In general, we will assume that the cost C per one transaction is a nonincreasing
function of the amount of transactions, |∆δ|, per unit of time ∆t, i.e.

C = C(|∆δ|).

(16)

It means that the purchase of ∆δ > 0 or sales of ∆δ < 0 shares at a price of S, we
calculate the additional transaction costs ∆T C per unit of time ∆t:

∆T C =

C(|∆δ|)|∆δ|.

S
2

Hence the transaction costs measure rT C can be expressed as
E[C(|∆δ|)|∆δ|]

E[∆T C]

rT C =

S∆t

=

1
2

∆t

(17)

(18)

,

where C is the transaction costs function and ∆δ is the number of purchased ∆δ > 0 or
sold ∆δ < 0 shares per unit of time ∆t.

In order to simplify notation we introduce the so-called mean value modiﬁcation of

the transaction costs function ˜C(α) deﬁned as follows:
Deﬁnition 2.1 Let C = C(ξ), C : R+
transformation ˜C : R+

0 → R of the function C deﬁned as follows:

0 → R, be a transaction costs function. The integral

˜C(ξ) =

E[C(ξ|Φ|)|Φ|] =

C(ξx)x e−x2/2dx,

(19)

(cid:114) π

2

(cid:90) ∞

0

is called the mean value modiﬁcation of the transaction costs function. Here Φ is the
random variable with a standardized normal distribution, i.e., Φ ∼ N (0, 1).

5

Applying deﬁnition (19) to equation (18) we obtain the following expression for the

transaction costs measure:

rT C =

1
2

(cid:114) 2

˜C(α)α

π

∆t

, where α = σS(cid:12)(cid:12)∂2

SV(cid:12)(cid:12)√

∆t.

(20)

Inserting the transaction costs measure rT C into (14) we obtain generalization of the

Leland model for the case of arbitrary transaction costs function C(ξ).
0 → R be a measurable and bounded transaction costs func-
Proposition 2.1 Let C : R+
tion. Then the nonlinear Black–Scholes equation for pricing option under variable trans-
action costs is given by the nonlinear parabolic equation

∂tV +

1
2

ˆσ(S∂2

SV )2S2∂2

SV + rS∂SV − rV = 0,

where

ˆσ(S∂2

SV )2 = σ2

1 −

˜C(σS|∂2

√
SV |

∆t)

√

sgn(S∂2
SV )
∆t

σ

(cid:32)

(cid:114) 2

π

(cid:33)

.

(21)

(22)

In the next two propositions we summarize several useful properties of the mean value

modiﬁcation of a transaction costs function.

Proposition 2.2 Let C(ξ) be a measurable bounded transaction costs function such that
C 0 ≤ C(ξ) ≤ C0 for all ξ ≥ 0. Then its mean value modiﬁcation ˜C(ξ) is a C∞ smooth
function for ξ > 0. Furthermore, it has the following properties:

1. ˜C(0) = C(0);
2. if C(+∞) = limξ→∞ C(ξ) then ˜C(+∞) = C(+∞);
3. C 0 ≤ ˜C(ξ) ≤ C0 for all ξ ≥ 0;
4. if C is nonincreasing (nondecreasing) then ˜C is a non- increasing (nondecreasing)

function as well;

5. if C is a (non-constant) convex function then ˜C is a (strictly) convex function.

Proposition 2.3 Let C(ξ) be a measurable and bounded transaction costs function which
is nonincreasing for ξ ≥ 0.

• If C(0) > 0 then the function ξ (cid:55)→ ˜C(ξ)
• If C 0 ≤ C(ξ) ≤ C0 for all ξ ≥ 0 then

ξ

is strictly convex for ξ > 0.

˜C(ξ) + ξ ˜C(cid:48)(ξ) ≥ 2C 0 − C0.

6

P r o o f. a) Since ˜C(ξ) =
√
f (x) = e−x2/2/
y = ξx, we obtain the following identity:

0 C(y)yf (y/ξ)dy where
2π and f(cid:48)(x) = −xf (x), f(cid:48)(cid:48)(x) = (x2 − 1)f (x) then, by using substitution

0 C(ξx)xf (x)dx =

√

2π(cid:82) ∞
(cid:18)12

2πξ−2(cid:82) ∞

√

(cid:19)

(cid:32) ˜C(ξ)

(cid:33)

ξ

d2
dξ2

√
2π
√

(cid:90) ∞
(cid:90) ∞
(cid:90) ∞

0

0

2π
√
ξ3
2π
ξ3
2C(+∞)

0

ξ3

=

=

=

=

y2

3y

C(y)y

ξ5 f (y/ξ) +

ξ7 f(cid:48)(cid:48)(y/ξ)
ξ6 f(cid:48)(y/ξ) +
C(ξx)x(cid:0)12f (x) + 8xf(cid:48)(x) + x2f(cid:48)(cid:48)(x)(cid:1) dx
(cid:90) ∞
C(ξx)x(cid:0)x4 − 9x2 + 12(cid:1) f (x)dx =

√

dy

C(ξx)h(cid:48)(x)dx

2π
ξ3

0

(cid:90) ∞

0

√

−

2π
ξ2

C(cid:48)(ξx)h(x)dx > 0

because C(+∞) ≥ 0, C(cid:48)(x) ≤ 0 (if C(+∞) = 0 then C(cid:48)
where

(cid:54)≡ 0) and h(x) > 0 for x > 0

t(t4 − 9t2 + 12)f (t)dt =

− (2 − 5x2 + x4)f (x)

(cid:114) 2

π

is a strictly positive function for x > 0 depicted in Figure 2. It has a unique positive
minimum at x∗ =

(9 +

(cid:90) x

0

h(x) =

(cid:113)

0 C(y)yf (y/ξ)dy, we obtain
C(y)y2f(cid:48)(y/ξ)dy = −2 ˜C(ξ) −

√
2π

C(ξx)x2f(cid:48)(x)dx

(cid:90) ∞

0

33)/2 (cid:39) 2.715.
√

√
b) Again, as ˜C(ξ) = ξ−2
√

ξ ˜C(cid:48)(ξ) = −2 ˜C(ξ) − ξ−3
√

= −2 ˜C(ξ) +

2π

2π(cid:82) ∞
(cid:90) ∞
(cid:90) ∞

2π

0

0

Since C(ξx) ≥ C 0, ˜C(ξ) ≤ C0 and
−C0 + 2C 0, as claimed.

√

C(ξx)x3f (x)dx.

2π(cid:82) ∞

0 x3f (x)dx = 2 we obtain ˜C(ξ) + ξ ˜C(cid:48)(ξ) ≥
♦

2.1 Piecewise linear nonincreasing transaction costs function

We present an example of a realistic transaction costs function which is nonincreasing
with respect to the amount of transactions as in model studied by Amster et al.
[1],
Averbuj [4] Mariani et al. [28]. The beneﬁt is the elimination of the problem of negative
values of the linear decreasing costs function. We deﬁne the following piecewise linear
function.

Deﬁnition 2.2 We deﬁne a piecewise linear nonincreasing transaction costs function as
follows:

 C0,

C(ξ) =

C0 − κ(ξ − ξ−),
C 0,

if
if
if

0 ≤ ξ ≤ ξ−,
ξ− ≤ ξ ≤ ξ+,
ξ ≥ ξ+,

where we assume C0, κ > 0, and 0 ≤ ξ− < ξ+ ≤ ∞ are given constants and C 0 =
C0 − κ(ξ+ − ξ−) > 0.

(23)

7

This is a realistic transaction costs function. Indeed, for a small volume of traded assets
the transaction costs rate equals C0. When the volume is large enough then a discount is
applied with a lower transaction costs rate C 0 < C0.

Notice that this function also covers several special cases studied before. Namely,
the constant transaction costs function studied by Leland [26], Hoggard, Whalley and
Wilmott [16] (κ = ξ− = 0, ξ+ = ∞) as well as linearly decreasing transaction costs
investigated by Amster et al. in [1] (κ > 0, ξ− = 0, ξ+ = ∞).
Taking into account the fact that C(cid:48)(ξ) = −κ for ξ ∈ (ξ−, ξ+) and C(cid:48)(ξ) = 0, otherwise,
and using integration by parts we can easily derive that the mean value modiﬁcation of a
piecewise transaction costs function (23) is given by:

˜C(ξ) = C0 − κξ

e−x2/2dx,

for ξ ≥ 0.

(24)

(cid:90) ξ+

ξ

ξ−
ξ

2.2 Exponentially decreasing transaction costs function

As an another example of a transaction costs function one can consider the following
exponential function of the form

C(ξ) = C0 exp(−κξ),

for ξ ≥ 0,

(25)

where C0 > 0 and κ > 0 are given constants.
derived by expanding the function ξ (cid:55)→ C(ξ|Φ|)ξ into power series:

Its mean value modiﬁcation ˜C can be

˜C(ξ) =

C(ξx)x e−x2/2dx = C0

e−κξxx e−x2/2dx

E[C(ξ|Φ|)|Φ|] =

(cid:114) π
(cid:90) ∞
(cid:18)(cid:104)−e−κξxe−x2/2(cid:105)∞
(cid:90) ∞
(cid:18)

(cid:90) ∞

−

2

0

0

0

(cid:0)e−κξx(cid:1)(cid:48)
(cid:19)
(cid:18)

(cid:90) ∞
(cid:19)
(cid:90) ∞

0

(−e−x2/2)dx

e−κξx−x2/2dx

1 − κξ
√
2κξ), where φ(x) = 1 + xe

= C0

0

1 − κξeκ2ξ2/2

κξ

x2
4 (erf(x/2) + 1)

(cid:19)

e−t2/2dt
√

π
2

,

= C0

= C0

= C0φ(−

(cid:82) x/2

0

and erf(x/2) = 2√

π

e−s2ds is the error function.

3 Transformation of the fully nonlinear Black–Scholes

equation to the quasilinear Gamma equation

The goal of this section is to study transformation of the nonlinear Black–Scholes equation
into a quasilinear parabolic equation - the so-called Gamma introduced and investigated
by Jandaˇcka and ˇSevˇcoviˇc in [19] (see also ˇSevˇcoviˇc, Stehl´ıkov´a and Mikula [29, Chap-
ter 11]).

In what follows, we will use the notation

β(H) =

ˆσ(H)2H,

1
2

8

(26)

a)

b)

Figure 1: Various types of transaction costs functions C(ξ) (solid line) and their mean
value modiﬁcation ˜C(ξ) (dashed line). a) Piecewise linear transaction costs function with
C0 = 0.02, κ = 1, ξ− = 0.01, ξ+ = 0.02; b) Exponentially decreasing transaction costs
function with C0 = 0.02, κ = 100.

Figure 2: Plot of the auxiliary function h(x).

9

0.000.010.020.030.040.050.0000.0050.0100.0150.020ΞCΞ,CŽΞ0.000.010.020.030.040.050.0000.0050.0100.0150.020ΞCΞ,CŽΞ01234560.00.20.40.60.81.01.21.4xhxwhere ˆσ is the volatility function depending on the term H = S∂2
SV . Let E > 0 be a
numeraire for the underlying asset price, e.g. E is the expiration price for a call or put
option.

Proposition 3.1 Assume the function V = V (S, t) is a solution to the nonlinear Black-
Scholes equation

∂tV + Sβ(S∂2

SV ) + rS∂SV − rV = 0, S > 0, t ∈ (0, T ).

(27)
SV (S, t), where x = ln(S/E), τ = T − t

Then the transformed function H = H(x, τ ) = S∂2
is a solution to the quasilinear parabolic (Gamma) equation

(28)
On the other hand, if H is a solution to (28) such that H(−∞, τ ) = ∂xH(−∞, τ ) = 0
and β(cid:48)(0) is ﬁnite then the function

xβ(H) + ∂xβ(H) + r∂xH.

∂τ H = ∂2

V (S, t) = aS + be−r(T−t) +

(S − Eex)+H(x, T − t)dx,

(29)

(cid:90) ∞

−∞

is a solution to the nonlinear Black–Scholes equation (27) for any a, b ∈ R.
P r o o f. The ﬁrst part of the statement can be shown directly by taking the second
derivative of (27) with respect to S. Indeed, as ∂x = S∂S we have

S∂2

S(Sβ) = S∂S(β +S∂Sβ) = ∂x(∂xβ +β), S∂2

Applying the operator S∂2
that H is the solution to equation (28) (see also [19] and [29, Chapter 11]).

On the other hand, if V (S, t) is given by (29) then S∂2

S(S∂SV ) = S∂S(∂SV +S∂2

SV ) = H +∂xH.
S to equation (27) and taking into account ∂t = −∂τ we conclude
(cid:90) ln(S/E)
(cid:90) ln(S/E)

(S − Eex)(cid:2)e−x∂x(ex∂xβ(H(x, τ ))) + r∂xH(x, τ )(cid:3) dx

(S − Eex)∂τ H(x, τ )dx

SV (S, t) = H(x, τ ). Moreover,

−∞

if H is a solution to (28) then
∂tV (S, t) = rbe−r(T−t) −

= rbe−r(T−t) −
= rbe−r(T−t) − [(S − Eex)(∂xβ(H(x, τ )) + r∂xH(x, τ )]x=ln(S/E)

−∞

x=−∞

(cid:90) ln(S/E)

−∞

−S

∂xβ(H(x, τ ))dx − rE

= rbe−r(T−t) − Sβ(S∂2

SV (S, t)) − rE

(cid:90) ln(S/E)
(cid:90) ln(S/E)

−∞

−∞

exH(x, τ )dx

exH(x, τ )dx.

Here we have used the fact that H(−∞, τ ) = ∂xH(−∞, τ ) = 0 and β(cid:48)(0±) is ﬁnite. Since

(S − Eex)H(x, τ )dx = aS + S

H(x, τ )dx

(cid:90) ln(S/E)

−∞

S∂SV (S, t) = aS + S∂S

we ﬁnally obtain

(cid:90) ln(S/E)

−∞

(cid:90) ln(S/E)

−∞

(S − Eex)H(x, τ )dx = rV.
♦

∂tV + Sβ(S∂2

SV ) + rS∂SV = r(aS + be−r(T−t)) + r

Therefore V (S, t) solves the nonlinear Black–Scholes equation (27), as claimed.

10

Figure 3: Plots of the initial approximation of the function H(x, 0) for τ∗ suﬃciently
small (left) and the solution proﬁle H(x, T ) at τ = T (right).

Remark 3.1 If the initial condition H(x, 0) = δ(x) is the Dirac δ-function then for the
terminal pay-oﬀ diagram V (S, T ) given by (29) we obtain
1. V (S, T ) = (S − E)+ (call option) when a = b = 0,
2. V (S, T ) = (E − S)+ (put option) when a = −1, b = E.

Remark 3.2 The initial Dirac δ-function can be approximated as follows:

√
τ∗),

H(x, 0) ≈ f (d)/(ˆσ
√

2π and d = (x + (r − σ2/2)τ∗) /σ

where τ∗ > 0 is suﬃciently small, f (d) is the PDF function of the normal distribution,
√
f (d) = e−d2/2/
τ∗ where σ = ˆσ(0). The idea behind
such an approximation follows from observation that for a solution of the linear Black–
Scholes equation with a constant volatility σ > 0 at the time T − τ∗ close to expiry T the
√
SV (S, T −τ∗) is given by H(x, τ∗) = f (d)/(ˆσ
value H(x, τ∗) = S∂2
τ∗). An approximation
of the initial condition for 0 < τ∗ (cid:28) 1 is shown in Figure 3 (left).

3.1 Existence of classical solutions, comparison principle

The aim of this subsection is to analyze classical smooth solutions to the Cauchy problem
for the quasilinear parabolic equation (28). Following the methodology based on the
[25]), we shall prove
so-called Schauder’s type of estimates (cf. Ladyzhenskaya et al.
existence and uniqueness of classical solutions to (28).
We proceed with a deﬁnition of function spaces we will work with. Let Ω = (xL, xR) ⊂
R be a bounded interval. We denote QT = Ω × (0, T ) the space-time cylinder. Let
0 < λ < 1. By Hλ(Ω) we denote the Banach space consisting of all continuous functions
H deﬁned on ¯Ω which are λ-H¨older continuous. It means that their H¨older semi-norm
(cid:104)H(cid:105)(λ) = supx,y∈Ω,x(cid:54)=y |H(x) − H(y)|/|x − y|λ is ﬁnite. The norm in the space Hλ(Ω) is
then the sum of the maximum norm of H and the semi-norm (cid:104)H(cid:105)(λ). The space H2+λ(Ω)
consists of all twice continuously diﬀerentiable functions H in ¯Ω whose second derivative
xH belongs to Hλ(Ω). The space H2+λ(R) consists of all functions H : R → R such that
∂2
H ∈ H2+λ(Ω) for any bounded domain Ω ⊂ R.

11

-1.0-0.50.00.51.0051015xH-1.0-0.50.00.51.00.00.20.40.60.81.01.2xHThe parabolic H¨older space Hλ,λ/2(QT ) of functions deﬁned on a bounded cylinder QT
consists of all continuous functions H(x, τ ) in ¯QT such that H is λ-H¨older continuous in
the x-variable and λ/2-H¨older continuous in the t-variable. The norm is deﬁned as the sum
of the maximum norm and corresponding H¨older semi-norms. The space H2+λ,1+λ/2(QT )
xH ∈ Hλ,λ/2(QT ). Finally,
consists of all continuous functions on ¯QT such that ∂τ H, ∂2
the space H2+λ,1+λ/2(R × [0, T ]) consists of all functions H : R × [0, T ] → R such that
H ∈ H2+λ,1+λ/2(QT ) for any bounded cylinder QT (cf. [25, Chapter I]).

We ﬁrst derive useful lower and upper bounds of a solution H to the Cauchy problem
(28). The idea of proving upper and lower estimates for H(x, τ ) is based on construction
of suitable sub- and super-solutions to the parabolic equation (28) (cf. [25]).
Lemma 3.1 Suppose that the initial condition H(., 0) ∈ Hλ(R) is non-negative and uni-
formly bounded from above, i.e., H = supx∈R H(x, 0) < ∞. Assume β(H) is a C 1,ε smooth
function for H ≥ 0 and satisfying the following strong parabolic inequalities:

λ− ≤ β(cid:48)(H) ≤ λ+

for any H ≥ 0 where λ± > 0 are constants.
If the bounded solution H(x, τ ) to the
quasilinear parabolic equation (28) belongs to the function space H2+λ,1+λ/2(R × [0, T ]) ∩
L∞(R × (0, T )), for some 0 < λ < 1, then it satisﬁes the following inequalities:

0 ≤ H(x, τ ) ≤ H,

for any τ ∈ [0, T ) and x ∈ R.

P r o o f. The quasilinear parabolic equation (28) can be rewritten in the form:

∂τ H = ∂x(β(cid:48)(H)∂xH) + β(cid:48)(H)∂xH + r∂xH.

(30)
Notice that the right-hand side of (30) is a strictly parabolic operator because 0 < λ− ≤
β(cid:48)(H) ≤ λ+. Since the constant functions H ≡ 0 and H are solutions to (30) then the
statement is a consequence of the parabolic comparison principle for strongly parabolic
♦
equations (see e.g. [25, Chapter V, (8.2)]).
In the next Proposition we show that the diﬀusion function β(H) corresponding to
the nonlinear Black–Scholes equation for pricing options under the variable transaction
costs satisﬁes the strong parabolicity assumption.

Proposition 3.2 Let C(ξ) be a measurable bounded transaction costs function which is
nonincreasing and such that C 0 ≤ C(ξ) ≤ C0 for all ξ ≥ 0. Let

(cid:32)

(cid:114) 2

π

√
∆t|H|)
√
∆t

˜C(σ
σ

(cid:33)

sgn(H)

.

ˆσ(H)2 =

σ2
2

1 −

Then for the diﬀusion function β(H) = ˆσ(H)2H the following inequalities hold:

σ2
2
for all H ≥ 0, where Le =

(cid:113) 2

(1 − Le) ≤ β(cid:48)(H) ≤ σ2
2

(1 − 2Le + Le)

(cid:113) 2

√
C0

∆t

.

π

σ

π

σ

√
C0

∆t

and Le =

12

P r o o f. For H ≥ 0 we have

2

σ2 β(cid:48)(H) = 1 −

(cid:114) 2

π

σ

(cid:16) ˜C(ξ) + ξ ˜C(cid:48)(ξ)

(cid:17)

√
1
∆t

, where ξ ≡ σ

√

∆tH.

Since C is a nonincreasing function then ˜C(cid:48)(ξ) ≤ 0 and ˜C(ξ) ≤ C0 (see Proposition 2.2)
2 (1 − Le) ≤ β(cid:48)(H) easily follows. According to Proposition 2.3 we
then the inequality σ2
2 (1 − 2Le + Le) and the proof of the
have ˜C(ξ) + ξ ˜C(cid:48)(ξ) ≥ 2C 0 − C0 and so β(cid:48)(H) ≤ σ2
♦
statement follows.
Theorem 3.1 Suppose that the initial condition H(., 0) ≥ 0 belongs to the H¨older space
H2+λ(R) for some 0 < λ < min(1/2, ε) and H = supx∈R H(x, 0) < ∞. Assume that
β ∈ C 1,ε satisﬁes λ− ≤ β(cid:48)(H) ≤ λ+ for any 0 ≤ H ≤ H where λ± > 0 are constants.
Then there exists a unique classical solution H(x, τ ) to the quasilinear parabolic equa-
tion (28) satisfying the initial condition H(x, 0). The function τ (cid:55)→ ∂τ H(x, τ ) is λ/2-
H¨older continuous for all x ∈ R whereas x (cid:55)→ ∂xH(x, τ ) is Lipschitz continuous for all
τ ∈ [0, T ]. Moreover, β(H(., .)) ∈ H2+λ,1+λ/2(R × [0, T ]) and 0 < H(x, τ ) ≤ H for all
(x, τ ) ∈ R × [0, T ).

P r o o f. The proof is based on the so-called Schauder’s theory on existence and unique-
ness of classical H¨older smooth solutions to a quasi-linear parabolic equation of the form
(28). It follows the same ideas as the proof of [20, Theorem 5.3] where Kilianov´a and
ˇSevˇcoviˇc investigated a similar quasilinear parabolic equation obtained from a nonlinear
Hamilton-Jacobi-Bellman equation in which a stronger assumption β ∈ C 1,1 is assumed.
Nevertheless, we sketch the key steps of the proof.

(δ)

(δ)(H δ)∂xH δ) = ∂xf (H δ, β(δ)(H δ)), H δ(x, 0) = H(x, 0),

The Schauder theory requires that the diﬀusion coeﬃcient of a quasi-linear parabolic
equation is suﬃciently smooth. Therefore the function β has to be regularized by a
δ-parameterized family of smooth molliﬁer functions β(δ)(H) such that β(δ) ⇒ β, and
⇒ β(cid:48) locally uniformly as δ → 0. For any δ > 0, the existence of the unique classical
β(cid:48)
bounded solution H δ ∈ H2+λ,1+λ/2(R × [0, T ]) ∩ L∞(R × (0, T )) to the Cauchy problem:
x ∈ R, t ∈ [0, T ),
∂τ H δ − ∂x(β(cid:48)
follows from [25, Theor. 8.1 and Rem. 8.2, Ch. V, pp. 495–496]. Here f (H, β(H)) :=
β(H) + rH.
By virtue of Lemma 3.1, H δ, 0 < δ (cid:28) 1, is uniformly bounded in the space L∞(QT )
for any bounded cylinder QT . Using the inequality [25, Chapter I, (6.6)] we can prove
that H δ, 0 < δ (cid:28) 1, is also uniformly bounded in the Sobolev space W 1
2 (QT ). It means
that there exists a subsequence H δk (cid:42) H weakly converging to a function H ∈ W 1
2 (QT )
as δk → 0. As a consequence of the Rellich-Kondrashov compactness embedding theorem
2 (QT ) (cid:44)→ L2(QT ) (cf. [25, Chapter II, Theorem 2.1]) the limiting function H ∈ W 1
W 1
2 (QT )
is a weak solution to the quasi-linear parabolic equation (28). Since H, f ∈ W 1
2 (QT ) we
xβ(H) ∈ L2(QT ). Furthermore, ∂τ β(H) ∈ L2(QT ) because λ− < β(cid:48)(H) < λ+.
obtain ∂2
Hence, β(H) belongs to the parabolic Sobolev space W 2,1
2 (QT ) which is continuously
embedded into the H¨older space Hλ,λ/2(QT ) for any 0 < λ < min(1/2, ε).

Finally, the transformed function z(x, τ ) := β(H(x, τ )) is a solution to the quasi-linear

parabolic equation in the non-divergent form:

∂τ z = ζ(z)(cid:2)∂2

xz + ∂xf (α(z), z)(cid:3) = 0,

z(x, 0) = β(H(x, 0)),

13

where ζ(z) = β(cid:48)(α(z)) and z (cid:55)→ α(z) is the inverse function to the increasing function
H (cid:55)→ β(H). The function z (cid:55)→ β(cid:48)(z) is ε-H¨older continuous. Thus z (cid:55)→ ζ(z) is ε−
H¨older continuous as well. Now, we can apply a simple boot-strap argument to show that
z = z(x, τ ) is suﬃciently smooth. Clearly, it is a solution to the linear parabolic equation
in non-divergence form

∂τ z = a(x, τ )∂2

xz + b(x, τ )∂xz,

z(x, 0) = β(H(x, 0)),

where a(x, τ ) := ζ(z(x, τ )), b(x, τ ) = ζ(z(x, τ )) (1 + rα(cid:48)(z(x, τ ))). The functions a and
b belong to the H¨older space H λ,λ/2(QT ) because z ∈ H λ,λ/2(QT ). With regard to [25,
Theorem 12.2, Chapter III] we have z = β(H) ∈ H 2+λ,1+λ/2(QT ) and the proof now
follows because the domain QT ⊂ R × (0, T ) was arbitrary.
♦

4 Numerical full space-time discretization scheme for

solving the Gamma equation

The purpose of this section is to derive an eﬃcient numerical scheme for solving the
Gamma equation. The construction of numerical approximation of a solution H to (28)
is based on a derivation of a system of diﬀerence equations corresponding to (28) to be
solved at every discrete time step. We make use of the numerical scheme adopted from
the paper by Jandaˇcka and ˇSevˇcoviˇc [19] in order to solve the Gamma equation (28)
for a general function β = β(H) including, in particular, the case of the model with
variable transaction costs. The eﬃcient numerical discretization is based on the ﬁnite
volume approximation of the partial derivatives entering (28). The resulting scheme is
semi–implicit in a ﬁnite–time diﬀerence approximation scheme.

Other ﬁnite diﬀerence numerical approximation schemes are based on discretization of
the original fully nonlinear Black–Scholes equation in non-divergence form (3). We refer
the reader to recent publications by Ankudinova and Ehrhardt [2], Company et al. [9],
D¨uring et al. [11], Liao and Khaliq [27], Zhou et al. [33]. Recently, a quasilinearization
technique for solving the fully nonlinear parabolic equation (3) was proposed and ana-
lyzed by Koleva and Vulkov [21]. Our approach is based on a solution to the quasilinear
Gamma equation written in the divergence form, so we can use existing ﬁnite volume
based numerical scheme to solve the problem eﬃciently (cf. Jandaˇcka and ˇSevˇcoviˇc [19],
K´utik and Mikula [23]).
For numerical reasons we restrict the spatial interval to x ∈ (−L, L) where L > 0
is suﬃciently large. Since S = Eex ∈ (Ee−L, EeL) it is suﬃcient to take L ≈ 2 in
order to include the important range of values of S. For the purpose of construction
of a numerical scheme, the time interval [0, T ] is uniformly divided with a time step
k = T /m into discrete points τj = jk, where j = 0, 1,··· , m. We consider the spatial
interval [−L, L] with uniform division with a step h = L/n, into discrete points xi = ih,
where i = −n,··· , n.

The proposed numerical scheme is semi–implicit in time. Notice that the term ∂2

xβ,
xβ = ∂x (β(cid:48)(H)∂xH), where β(cid:48) is the derivative of β(H)
can be expressed in the form ∂2
with respect to H. In the discretization scheme, the nonlinear terms β(cid:48)(H) are evaluated
from the previous time step τj−1 whereas linear terms are solved at the current time level.

14

Such a discretization scheme leads to a solution of a tridiagonal system of linear
equations at every discrete time level. First, we replace the time derivative by the time
diﬀerence, approximate H in nodal points by the average value of neighboring segments,
then we collect all linear terms at the new time level τj and by taking all the remaining
terms from the previous time level τj−1. We obtain a tridiagonal system for the solution
vector H j = (H j−n+1,··· , H j
i−1 + bj

(31)
where i = −n + 1,··· , n − 1 and j = 1,··· , m. The coeﬃcients of the tridiagonal matrix
are given by

n−1)T ∈ R2n−1:
i H j
i H j

i , H j−n = 0, H j

i+1 = dj

i + cj

n = 0 ,

aj
i H j

i = − k
h2 β(cid:48)
aj

H(H j−1

i−1 ) +

H(H j−1

r

k
2h
i = H j−1
dj

i = − k
h2 β(cid:48)
(cid:16)
cj
β(H j−1

i +

i

i

) − k
2h
) − β(H j−1
i−1 )

(cid:17)

r ,

i = 1 − (aj
bj

i + cj

i ) ,

.

k
h

It means that the vector H j at the time level τj is a solution to the system of linear
equations A(j) H j = dj, where the (2n − 1) × (2n − 1) matrix A(j) = tridiag(aj, bj, cj).
In order to solve the tridiagonal system in every time step in a fast and eﬀective way, we
can use the eﬃcient Thomas algorithm.
Finally, with regard to Proposition 3.1 and Remark 3.1 the option price V (S, T − τj)
i by means of a simple integration scheme:

can be constructed from the discrete solution H j

(call option)

V (S, T − τj) = h

(put option)

V (S, T − τj) = h

(S − Eexi)+H j
i ,

(Eexi − S)+H j
i ,

j = 1,··· , m,

j = 1,··· , m.

n(cid:88)
n(cid:88)

i=−n

i=−n

4.1 Numerical results for the nonlinear model with variable

transaction costs

In this section we present the numerical results for computation of the option price. As
an example for numerical approximation of a solution we consider the nonlinear Black–
Scholes equation for pricing options under variable transaction costs described by the
piecewise linear nonincreasing function, depicted in Figure 1. The function β(H) corre-
sponding to the variable transaction costs function C(ξ) has the form

(cid:18)

β(H) =

σ2
2

√
1 − ˜C(σ|H|

∆t)

√
sgn(H)
∆t
σ

(cid:19)

H,

where ˜C is the modiﬁed transaction costs function. We assume that the hedging time ∆t
is such that Le < 1.

In our computations we chose the following model parameters describing the piecewise
transaction costs function: C0 = 0.02, κ = 0.3, ξ− = 0.05, ξ+ = 0.1. The length of the time
interval between two consecutive portfolio rearrangements: ∆t = 1/261. The maturity
time T = 1, historical volatility σ = 0.3 and the risk-free interest rate r = 0.011. As

15

Figure 4: A graph of the function β(H) corresponding to the nonlinear model with a
piecewise linear variable transaction costs function.

Table 1: Call option values computed by means of the numerical solution of nonlin-
ear Black–Scholes model in comparison to solutions Vσmax, Vσmin computed by the linear
Black–Scholes equation with constant volatility σ = σmax and σ = σmin.

S
20
23
25
28
30

Vσmax(S, 0) Vvtc(S, 0) Vσmin(S, 0)

0.709
1.752
2.768
4.723
6.256

0.127
0.844
1.748
3.695
5.321

0.029
0.421
1.258
3.474
5.327

min = σ2(cid:16)

1 − C0

√
1
∆t

π

σ

(cid:113) 2

(cid:17)

.

for the numerical parameters we chose L = 2.5, n = 250, m = 200, and the parameter
τ∗ = 0.005 for approximation of the initial Dirac δ–function. The parameters C0, σ, κ, ξ±
and ∆t correspond to the Leland numbers Le = 0.85935 and Le = 0.21484. In Table 1 we
present option values Vvtc(S, 0) for diﬀerent prices of the underlying asset achieved by a
numerical solution. In Figure 5 we plot the solution Vvtc(S, t) and the option price delta
factor ∆(S, t) = ∂SV (S, t), for various times t ∈ {0, T /3, 2T /3}. The upper dashed line
(cid:17)
corresponds to the solution of the linear Black–Scholes equation with the higher volatility
, where C 0 = C0 − κ(ξ+ − ξ−) > 0, whereas the lower dashed
ˆσ2

max = σ2(cid:16)

(cid:113) 2

1 − C 0

√
1
∆t

π

σ

line corresponds to the solution with a lower volatility ˆσ2

The empirically observed fact (see Table 1) that

Vσmin(S, t) ≤ Vvtc(S, t) ≤ Vσmax(S, t)

for all S > 0, t ∈ [0, T ],

can be proved analytically. It is a consequence of the parabolic comparison principle (cf.
[25, Chapter V, (8.2)]). Indeed, the fully nonlinear Black–Scholes equation (27) can be
considered as a nonlinear strongly parabolic equation
∂τ V = F(S, V, ∂SV, ∂2

(32)

SV ),

16

0123450.000.020.040.060.080.100.120.14HΒHfor the option price V = V (S, T − τ ), where

F(S, V, ∂SV, ∂2

SV ) =

1
2

σ2

1 −

˜C(σS|∂2

√
SV |

∆t)

sgn(S∂2
√
SV )
∆t

σ

(cid:32)

(cid:114) 2

π

(cid:33)

S2∂2

SV + rS∂SV − rV.

Recall that 0 < λ− ≤ ∂QF(S, V, P, Q) ≤ λ+ for all S, V, P and Q ≥ 0 and so equation
(32) is indeed a strongly parabolic equation. For the solution Vσmin(S, t) of the linear
Black–Scholes equation with the constant volatility σ2

min = σ2(1 − Le) we have
SVσmin + rS∂SVσmin − rVσmin ≤ F(S, Vσmin, ∂SVσmin, ∂2

SVσmin),

1
2

σ2(1 − Le)S2∂2

∂τ Vσmin =
because ˜C(ξ) ≤ C0 and so

(cid:114) 2

π

˜C(σS|∂2

√
SVσmin|

∆t)

√
1
∆t

σ

≤

(cid:114) 2

π

C0

√
1
∆t

σ

= Le.

Hence Vσmin is a sub-solution to the strongly parabolic equation (32). Therefore, by
the parabolic comparison principle, Vσmin(S, t) ≤ Vvtc(S, t) for all S > 0 and t ∈ [0, T ].
Analogously, the inequality Vvtc(S, t) ≤ Vσmax(S, t) follows from the parabolic comparison
principle because ˜C(ξ) ≥ C 0.
The dependence of the call option price on time t ∈ [0, T ] for S ∈ {20, 23, 25} with
E = 25 is shown in Figure 6. We can also see that the price converges to zero at expiration
for S ≤ E.

4.2 Some practical implications in ﬁnancial portfolio manage-

ment

Numerical results obtained in the previous subsection can be interpreted from the ﬁnancial
portfolio management point of view. For example, temporal behavior of the call option
price shown in Fig. 6 for the underlying asset price S = E indicates that the option price
given by the solution Vvtc(S, t) of the nonlinear variable transaction cost model is closer
to the lower bound Vσmin(S, t) for initial times t ≈ 0. But in later times when t → T the
price Vvtc(S, t) is closer to the upper bound Vσmax(S, t). It can be interpreted as follows:
at the beginning of the contract the portfolio manager need not perform many transaction
in order to hedge the portfolio. The transaction costs per one transaction is equal to C0.
On the other hand, when the time t approaches expiration T then it is necessary to make
frequent rearrangements of the portfolio and so the traded volume of assets increases.
Hence the investor pays discounted lower transaction costs value C 0 per one transaction
of the short positioned underlying asset. Consequently, the option price is higher.
The comparison principle Vσmin(S, t) ≤ Vvtc(S, t) ≤ Vσmax(S, t) (see also Table 1) has
if the transaction cost C(ξ) per unit share depends
the following practical implication:
on the volume of traded shares ξ and it belongs to the interval [C0 ≤ C ≤ C0] the option
price Vvtc can be estimated from above (below) by the option price corresponding to the
constant transaction costs C0 (C0).

17

t = 0

t = T /3

t = 2T /3

Figure 5: The call option price V (S, t) as a function of S for t ∈ {0, T /3, 2T /3} (left)
and its delta ∆(S, t) = ∂SV (S, t).

18

2022242628300123456SVS,t10203040500.00.20.40.60.81.0SDS,t2022242628300123456SVS,t10203040500.00.20.40.60.81.0SDS,t202224262830012345SVS,t10203040500.00.20.40.60.81.0SDS,tS = 20

S = 23

Figure 6: The call option price V (S, t) as a function of time t ∈ [0, T ] for S ∈ {20, 23, 25}.

S = 25 ≡ E

19

0.00.20.40.60.81.00.00.10.20.30.40.50.60.7tVS,t0.00.20.40.60.81.00.00.51.01.5tVS,t0.00.20.40.60.81.00.00.51.01.52.02.5tVS,tConclusions

In this paper we have analyzed a nonlinear generalization of the Black–Scholes equa-
tions arising when options are priced under variable transaction costs for buying and
selling underlying assets. The mathematical model is represented by the fully nonlinear
parabolic equation with the diﬀusion coeﬃcient depending on the second derivative of the
option price. We have investigated properties of various realistic variable transaction costs
functions. Furthermore, for a general class of nonlinear Black–Scholes equation we have
developed a transformation technique, by means of which the fully nonlinear equation
can be transformed into a quasilinear parabolic equation. We have proved existence and
uniqueness of classical solutions to the transformed equation. Finally, we have presented a
numerical approximation scheme and we computed option prices for pricing model under
variable transaction costs.

References

[1] Amster, P., Averbuj, C. G., Mariani, M. C., Rial, D. (2005): A Black–Scholes option

pricing model with transaction costs. J. Math. Anal. Appl., 303, 688–695.

[2] Ankudinova J., Ehrhardt, M. (2008): On the numerical solution of nonlinear Black–

Scholes equations. Computers and Mathematics with Applications, 56, 799–812.

[3] Avellaneda, M., Levy, A., Paras, A. (1995): Pricing and hedging derivative securities

in markets with uncertain volatilities. Applied Mathematical Finance, 2, 73–88.

[4] Averbuj, C. G. (2012): Nonlinear Integral-diﬀerential evolution equation arising in
option pricing when including transaction costs: A viscosity solution approach. Re-
vista Brasileira de Economia de Empresas, 12(1), 81–90.

[5] Bakstein, D., Howison, S. (2004): A non–arbitrage liquidity model with observable

parameters. Working paper, http://eprints.maths.ox.ac.uk/53/

[6] Barles, G., Soner, H. M. (1998): Option Pricing with transaction costs and a non-

linear Black–Scholes equation. Finance and Stochastics, 2, 369-397.

[7] Black, F., Scholes, M. (1973): The pricing of options and corporate liabilities. J.

Political Economy 81, 637–654.

[8] Casab´an, M. C., Company, R., J´odar, L., Pintos, J. R. (2011): Numerical analysis
and computing of a non–arbitrage liquidity model with observable parameters for
derivatives. Computers and Mathematics with Applications, 61, 1951–1956.

[9] Company R., Navarro E., Pintos J.R. and Ponsoda E. (2008): Numerical solution of
linear and nonlinear Black-Scholes option pricing equations. Computers an Mathe-
matics with Applications, 56, 813-821.

[10] Dremkova, E., Ehrhardt, M. (2011): High-order compact method for nonlinear
Black–Scholes option pricing equations of American options. International Journal
of Computer Mathematics, 88, 2782–2797.

20

[11] During, B., Fournier, M., Jungel, A. (2003): High order compact ﬁnite diﬀerence
schemes for a nonlinear Black–Scholes equation. Int. J. Appl. Theor. Finance, 7,
767–789.

[12] Frey, R., Patie, P. (2002): Risk Management for Derivatives in Illiquid Markets: A
Simulation Study. In: Advances in Finance and Stochastics, Springer, Berlin, 137–
159.

[13] Frey, R., Stremme, A. (1997): Market Volatility and Feedback Eﬀects from Dynamic

Hedging. Mathematical Finance, 4, 351–374.

[14] Grandits, P., Schachinger, W. (2001): Leland’s approach to option pricing: the

evolution of a discontinuity. Mathematical Finance, 11, 347–355.

[15] Grossinho, M.R., Morais, E. (2009): A note on a stationary problem for a Black-
Scholes equation with transaction costs. International Journal of Pure and Applied
Mathematics, 51, 557–565.

[16] Hoggard, T., Whalley, A. E., Wilmott, P. (1994): Hedging option portfolios in the
presence of transaction costs. Advances in Futures and Options Research, 7, 21–35.

[17] Imai, H., Ishimura, N., Mottate, I., Nakamura, M. (2007): On the Hoggard–Whalley–
Wilmott Equation for the Pricing of Options with Transaction Costs Asia-Paciﬁc
Financial Markets, 13, 315-326.

[18] Ishimura, N. (2010): Remarks on the Nonlinear Black-Scholes Equations with the

Eﬀect of Transaction Costs. Asia-Paciﬁc Financial Markets, 17, 241–259.

[19] Jandaˇcka, M., ˇSevˇcoviˇc, D. (2005): On the risk adjusted pricing methodology based
valuation of vanilla options and explanation of the volatility smile. Journal of Applied
Mathematics, 3, 235–258.

[20] Kilianov´a, S., ˇSevˇcoviˇc, D. (2013): A Transformation Method for Solving the
Hamilton-Jacobi-Bellman Equation for a Constrained Dynamic Stochastic Optimal
Allocation Problem. ANZIAM Journal, 55, 14–38.

[21] Koleva, M.N., L. G. Vulkov, L.G. (2013): Quasilinearization numerical scheme for
fully nonlinear parabolic problems with applications in models of mathematical ﬁ-
nance. Mathematical and Computer Modelling, 57, 2564–2575.

[22] Kratka, M. (1998): No Mystery Behind the Smile. Risk, 9, 67–71.

[23] K´utik P., Mikula K. (2011): Finite Volume Schemes for Solving Nonlinear Partial
Diﬀerential Equations in Financial Mathematics, in Proceedings of the Sixth Inter-
national Conference on Finite Volumes in Complex Applications, Prague, June 6-10,
2011, Springer Proceedings in Mathematics, Volume 4, 2011, Eds: J.Foˇrt, J. F¨urst,
J.Halama, R. Herbin and F.Hubert, 643-561,

[24] Kwok, Y. K. (1998): Mathematical Models of Financial Derivatives. Springer-Verlag.

21

[25] Ladyˇzenskaja, O. A., Solonnikov, V. A., and Ural’ceva, N. N. Linear and quasilinear
equations of parabolic type. Translated from the Russian by S. Smith. Translations
of Mathematical Monographs, Vol. 23 (American Mathematical Society, Providence,
R.I., 1968).

[26] Leland, H. E. (1985): Option pricing and replication with transaction costs. Journal

of Finance, 40, 1283–1301.

[27] Liao W., Khaliq A. Q. M. (2009): High-order compact scheme for solving nonlinear
Black–Scholes equation with transaction costs. International Journal of Computer
Mathematics, 86, 1009–1023.

[28] Mariani, M.C., Ncheuguim, E., Sengupta, I. (2011): Solution to a nonlinear Black-

Scholes equation. Electronic Journal of Diﬀ. Equations 2011(158), 1–10.

[29] ˇSevˇcoviˇc, D., Stehl´ıkov´a, B., Mikula, K. (2011): Analytical and numerical methods
for pricing ﬁnancial derivatives. Nova Science Publishers, Inc., Hauppauge, 309 pp.

[30] Sch¨onbucher, P., Wilmott, P. (2000): The feedback-eﬀect of hedging in illiquid mar-

kets. SIAM Journal of Applied Mathematics, 61, 232–272.

[31] Wilmott, P., Dewynne, J., Howison, S.D. (1995): Option Pricing: Mathematical

Models and Computation. UK: Oxford Financial Press.

[32] Wilmott, P., Howison, S., Dewynne, J. (1995): The Mathematics of Financial Deriva-

tives. USA: Press Syndicate of the University of Cambridge.

[33] Zhou, S., Han, L., Li, W., Zhang, Y., Han, M. (2015): A positivity-preserving nu-
merical scheme for option pricing model with transaction costs under jump-diﬀusion
process. Computational and Applied Mathematics, 34, 881–900.

22

