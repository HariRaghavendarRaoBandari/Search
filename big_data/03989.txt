6
1
0
2

 
r
a

 

M
3
1

.

 
 
]
E
H
h
p
-
o
r
t
s
a
[
 
 

1
v
9
8
9
3
0

.

3
0
6
1
:
v
i
X
r
a

High energy electromagnetic cascades in extragalactic space: physics and features

V. Berezinsky1 and O. Kalashev2

1INFN, Gran Sasso Science Institute viale F.Crispi 7, 67100 L’Aquila,

Italy and Laboratori Nazionali del Gran Sasso, Assergi (AQ), 67010, Italy

2Institute for Nuclear Research of the Russian Academy of Sciences, Moscow 117312, Russia

(Dated: March 15, 2016)

Using the analytic modeling of the electromagnetic cascades compared with more precise numer-
ical simulations we describe the physical properties of electromagnetic cascades developing in the
universe on CMB and EBL background radiations. A cascade is initiated by very high energy pho-
ton or electron and the remnant photons at large distance have two-component energy spectrum,
∝ E−2 (∝ E−1.9 in numerical simulations) produced at cascade multiplication stage, and ∝ E−3/2
from Inverse Compton electron cooling at low energies. The most noticeable property of the cascade
spectrum in analytic modeling is ’strong universality’, which includes the standard energy spectrum
and the energy density of the cascade ωcas as its only numerical parameter. Using numerical sim-
ulations of the cascade spectrum and comparing it with recent Fermi LAT spectrum we obtained
the upper limit on ωcas stronger than in previous works. The new feature of the analysis is ”Emax
rule”. We investigate the dependence of ωcas on the distribution of sources, distinguishing two cases
of universality: the strong and weak ones.

PACS numbers: 98.70.Sa, 95.85.Pw,95.85.Ry

I.

INTRODUCTION

density of the cascade radiation is found [8]

Very high energy extragalactic electron or photon col-
liding with low-energy background photons γt (CMB
and EBL) produces electromagnetic cascade due to re-
actions γ + γt → e− + e+ (pair production, PP) and
e + γt → γ ′ + e (Inverse Compton scattering, IC). Part
of the cascade energy can be taken away by synchrotron
radiation if magnetic ﬁeld is strong enough. Existence
of such cascading was understood soon after discovery
of Cosmic Microwave Background (CMB) radiation [1]
and of Greisen-Zatsepin-Kuzmin cutoﬀ [2] (oral remark
by I.L. Rozental at Soviet-Union Cosmic Ray Confer-
ence, by personal recollection of one of us, VB, and in-
dependently by S. Hayakawa according to recollection of
K. Sato). Since that time e-m cascading in extragalactic
space received many various applications.

One of the earliest applications was rigorous upper
limit on cosmogenic neutrino ﬂux, which was proposed
by Berezinsky and Zatsepin in 1969 [3]. The upper limit
on this ﬂux as was ﬁrst obtained in [4] follows from ob-
servation that production of neutrinos and initial cas-
cading particles (e and γ) takes place from decay of the
same particle, ∆+ resonance, produced in pγcmb interac-
tion, and thus energy density of produced neutrinos and
cascade particles are characterised by ratio 1/3. A re-
markable byproduct of this work was a good agreement
of analytically calculated cascade spectrum with diﬀuse
extragalactic gamma-ray spectrum as presented ﬁnally
by EGRET collaboration in 1998 [5] in the range from
30 MeV to 130 GeV. The exponent of EGRET spectrum
α = 2.1 ± 0.03 agrees quite well with predicted in [4]
as α = 2.0. The diﬀuse gamma-ray spectrum measured
recently by Fermi-LAT [6, 7] showed much worse agree-
ment with predicted cascade spectrum, in particular the
spectrum exponent is found α = 2.3. The allowed energy

ωcas = 5.8 × 10−7 eV/cm3,

(1)

and it puts the severe limit on allowed ﬂux of cosmogenic
neutrinos and extragalactic protons in Ultra High Energy
Cosmic Rays (UHECR) [8],[9],[10].

The new Fermi data [6] probably contradict also the
more general early hypothesis that extragalactic back-
ground gamma-ray ﬂux observed by EGRET [5] and
Fermi-LAT [6] is fully produced in pγ interaction of extra-
galactic CRs followed by e-m cascading. This hypothesis,
put forward in early 70s e.g. in [11] and [12], had the im-
pact especially on interpretation of the EGRET data, but
more complicated Fermi-LAT spectrum and in particu-
lar discovery of discrete sources in the early background
spectrum seriously questioned this interpretation.

Electromagnetic cascading strongly aﬀected gamma-
astronomy of discrete sources. The ﬁrst work in this ﬁeld
was calculation by Gould and Schreder [13] of absorption
of gamma-rays with energies above 100 TeV on CMB ra-
diation in the Universe. Cascading of the absorbed pho-
tons was understood soon and in 1970 the absorption
of UHE photons on optical, radio-radiation and in mag-
netic ﬁelds were included in the calculations, together
with similar calculations for electrons [14].

The new step was done in the work by Aharanian,
Coppi and V¨olk 1994 [15]. Before this work magnetic
ﬁeld in cascading process was taken into account for en-
ergy losses of electrons and for absorption of photons in
very strong magnetic ﬁeld. In the work [15] the authors
noticed importance of deﬂection of the cascade electrons
in magnetic ﬁelds.
In absence of magnetic ﬁeld cas-
cade particles propagate from a source in the same di-
rection as parent photon. If extragalactic magnetic ﬁeld
nearby the source is large enough, the low-energy cas-
cade e+e−-particles can be deﬂected from the direction

of initial cascading photon and produce (by IC radiation)
isotropic low-energy Eγ < 1 TeV component named by
the authors the “halo component”. As the sources the
AGN and in particular blazars are considered. In terms
of presently estimated EBL radiation [16], [17] the con-
sidered model looks as follows. An initial photon with
energy Eγ0 ∼ 10 TeV is absorbed on EBL with the
mean absorption length ℓγ ∼ 100 Mpc, producing elec-
tron and positron with energy Ee ∼ 5 TeV each. Elec-
tron/positron is deﬂected in extragalactic magnetic ﬁeld
producing then in IC scattering on a CMB photon the
recoil photon with energy
EIC
γ ∼ (4/3)γ2

e εcmb ∼ 100 GeV

(2)

where γe = Ee/me is the Lorentz-factor of electron. Thus
a typical energy of halo radiation is E ∼ 100 GeV and
the size of halo is rh ∼ a few Mpc.
A very exiting application of cascading was started by
the work of Neronov and Semikoz [18] who indicated a
possibility to search for very weak seeds of magnetic ﬁelds
in the Universe.

Creation of the seeds with extremely weak magnetic
ﬁelds is a necessary part of explanation of observed mag-
netic ﬁelds which can reach the tremendous values up to
1013 G deduced for pulsars. The strong magnetic ﬁelds
can be produced very fast due to collapse of the objects
with weak magnetic ﬁeld and fast increasing of magnetic
ﬁelds due to dynamo mechanism. The problem is how the
objects with very weak magnetic ﬁelds, the seeds, were
produced. Two kind of the seeds are in principle known:
the cosmological and astrophysical ones (for the reviews
see e.g. [19], [20], [21] and latest review with many refer-
ences [22]. Magnetic seeds of astrophysical origin include
historically the ﬁrst model “Biermann battery” [23], [24]
and recently many models based on plasma instabilities
e.g. [25] and also on diﬀerent models for Population III
stars, e.g. [26].

To measure magnetic ﬁelds in seeds Neronov and
Semikoz [18] suggested to observe cascading propaga-
tion of TeV gamma-rays from a source through a void
with very weak magnetic ﬁelds. Secondary positrons
and electrons are weakly deﬂected in magnetic ﬁelds pro-
ducing thus extended emission of IC gamma-rays, i.e.
gamma-ray halo described above. Decrease of the size
of this halo with energy of emitted gamma-rays allows
to measure the strength of magnetic ﬁeld B in a range
10−16 G <

At present from observation of cascading radiation of
TeV gamma-ray sources (blazars) it became possible to
put the lower limit on extragalactic magnetic ﬁeld [28],
for the review and other references see [22].

∼ B <

∼ 10−12 G [27].

Following the references cited above and observational
data of spectra of TeV blazars obtained by Fermi, one
may explain an appearance of lower limit on extragalactic
magnetic ﬁeld in the following way.

Consider ﬁrst the case B = 0 and gamma-radiation
from a blazar with primary energies higher than 1 TeV
directed along the jet to an observer. These photons

2

are absorbed leaving behind the cascade radiation with
low-energy spectra ∝ E−2 below cutoﬀ and E−1.5 at
smaller energies (see [4] and section II). These predicted
low-energy spectra exceed the Fermi observation at E ∼
1− 100 GeV and most natural assumption is suppression
of these ﬂuxes due to magnetic ﬁeld, which deﬂects e+e−
pairs from direction to an observer. The MC simulations
from [28, 29] and other calculations cited in [22] result
in the lower bound B > 10−17 G for extragalactic mag-
netic ﬁelds in voids. All these limits depend on size of
coherence length of magnetic ﬁeld λ.

Apart from lower limits obtained using cascading from
diﬀerent blazars there is one case of the positively mea-
sured magnetic ﬁeld applying quite diﬀerent method sug-
gested by T. Vachaspati and his collaborators [30],[31]
and references therein. This case is relevant for cascad-
ing in helical magnetic ﬁeld. Such ﬁeld scatters e+e−
and provides non-zero correlator between positions of
three cascading gamma-quanta produced by IC radia-
tion of electrons and positrons. The data of Fermi from
blazars are used for the analysis. The helical magnetic
ﬁeld B ∼ 10−14 G is found on 10 Mpc scale. This heli-
cal magnetic ﬁeld can be produced in early universe at
t ∼ 1 ns.
Extragalactic magnetic ﬁelds in other structures, like
ﬁlaments and galaxy clusters are larger by many orders
of magnitudes reaching µG level in clusters. A reader can
ﬁnd more wider and detailed discussion of extragalactic
magnetic ﬁelds in the review [22]. Above we limited our-
selves by several issues connected with cascading.

This paper is organized in the following way. In the
section II “Cascade physics and analytic calculations”
we describe the cascade physics and obtain analytical
solutions of cascade equations.

Our basic model in the section II is a static universe
ﬁlled by background radiations with dichromatic spec-
trum of photons with energy ǫcmb = 6.3 × 10−4 eV for
CMB and ǫebl = 0.68 eV for EBL radiation, the only
free parameter in this model. Cascade is initiated by
very high energy electron or photon with energy Es and
develops due to pair-production γ + γt → e+ + e− and
and inverse-compton (IC) e + γt → e′ + γ ′ scattering
on background target photons γt. At large enough time
the spectrum of remnant photons obtains universal form
(independent from initial energy Es assuming Es is high
enough), which has universal characteristic energies: en-
ergy of the spectrum cutoﬀ

E ebl
γ =

m2
e
ǫebl

= 3.9 × 1011 eV,

and energy of spectrum steepening

EX =

1
3E ebl

γ

ǫcmb
ǫebl

= 1.2 × 108 eV

The spectrum of remnant photons is given by nγ(E) ∝
E−3/2 at E ≤ EX , nγ(E) ∝ E−2 at EX ≤ E ≤ Eγ,
nγ(E) = 0 at E ≥ Eγ,

The spectrum nγ(E) ∝ E−3/2 at E ≤ EX is robust.
The spectrum at EX ≤ E ≤ Eγ is approximate: numerical
simulation give the exponent γ = 1.9 instead of 2.0. The
cutoﬀ is given in rough approximation.

In subsection II A we demonstrate that the spectra ob-
tained in static universe using the analytic dichromatic
model have the property of universality, which we will
later call the strong universality. The main feature of uni-
versal spectrum is its ﬁxed shape, independent of initial
energy Es and distance to the source. The universality
is broken for nearby sources.

In subsection II B the analytic universal spectrum is
compared with numerical simulations for the cascades
initiated at red-shift z. For z = 0.15 (r=626 Mpc) agree-
ment for dichromatic model with ǫebl = 0.68 eV is good,
as it is good for larger z but with choice of diﬀerent val-
ues of ǫebl. The case of small distance (low z) needs the
diﬀerent treatment.

In subsection II D we consider physically and tech-
nically interesting cases of CMB-only radiation. This
case is important at large z when density of CMB pho-
tons strongly dominates, and for nearby sources when
absorption on EBL is small or absent. Technically the
case of CMB-only is interesting because it automatically
produces dichromatic eﬀect: the role of EBL photons is
played by the photons with energy ˜εcmb from high-energy
tail of Planckian distribution whose density is enough to
absorb HE cascade photon with energy E of interest at
considered distance r.

In this approximation we calculated the cascade spec-
trum from nearby sources r= 1 Mpc, 8.5 Mpc, 85 Mpc
and 200 Mpc and compared them with numerical simu-
lations also in assumption of CMB-only background ra-
diation. The most noticeable diﬀerence with numerical
simulation is observed at smallest distance r= 1 Mpc be-
cause in realistic calculations the cascades arrive to an
observer as under-developed with spectrum ∝ E−1.47.
The calculated parameters of the cascades are shown in
Table I of subsection II E. The new element of calcula-
tions is low-energy suppression of the spectrum shown by
E γ
lec in Table I.
In the section III we discuss the two numerical sim-
ulation techniques for calculation of cascade spectrum,
namely solution of one-dimension transport equation and
Monte Carlo simulation. The former method is much
faster and allows precise calculation of propagated spec-
tra in the case when cascade deﬂections are not im-
portant, while the latter method is good for investiga-
tion of the eﬀects of magnetic ﬁeld, e.g.
in a prob-
lem of isotropization of the cascades emitted by point
sources. We compare our numerically-calculation spec-
tra obtained with two techniques with each other and
with independent numerical simulations.

In the section IV the cases of strong and weak uni-
versality are introduced and discussed. In section V the
corresponding spectra are calculated and compared with
that measured by Fermi LAT. This comparison allows to
obtain upper limits on energy density of the cascade ra-

3

diation ωcas, shown in Fig. 11 as function of production
redshift. The limits are stronger for generations of the
cascades at small redshifts.

In section VI we give a summary of the paper with the
main conclusions. This section is written in autonomous
way and is destined for a reader who is interested in the
main results and wants to bypass the technical details.

We use in the paper the following abbreviations:
UHECR for Ultra High Energy Cosmic Rays, CMB
EBL for Extra-
for Cosmic Microwave Background,
EGB for Extragalactic
galactic Background Light,
Gamma-Ray Background from Fermi-LAT data,
IGRB
for Isotropic Gamma Ray Background from Fermi-LAT
IC for Inverse Compton, PP for Pair Produc-
data,
tion, MC for Monte Carlo,
IGMF for Inter Galac-
tic Magnetic Field,
MAGIC for Major Atmospheric
Gamma Imaging Cherenkov Telescope, H.E.S.S for High
Energy Stereoscopic System,

II. CASCADE PHYSICS AND ANALYTIC

CALCULATIONS

∼ 1015 eV or

We develop here a simpliﬁed model for the cascade
which allows us to obtain an approximate spectrum of
sterile (remnant) photons left behind the cascade mul-
tiplication. We perform the approximate calculations
of e-m cascade from a burst of radiation in a form of
very high energy electrons or photons at very large dis-
tance from an observer. One may think of a single elec-
tron or photon with very high energy Es >
a number of such particles. We use the dichromatic
spectrum of background radiation which consists of pho-
tons with energy ǫcmb and ǫebl, analogues of cosmic mi-
crowave radiation (CMB) and extragalactic background
light (EBL) with ﬁxed energies of order of 6.3 × 10−4 eV
and ∼ 1 eV, respectively. We assume ǫebl >> ǫcmb for
energies and ncmb >> nebl for space densities. A cascade
is initiated by a single electron or photon with very high
energy Es and proceeds through pair-production (PP),
γ + γbckgr → e− + e+, and inverse compton (IC) scatter-
ing, e + γbckgr → e′ + γ ′, on low-energy background pho-
tons (CMB or EBL). We assume low magnetic ﬁeld which
does not inﬂuence the cascade development due to syn-
chrotron radiation, and our calculations will be mostly
concerned with the mean diﬀuse photon ﬂux which is
not aﬀected by deﬂections of the cascade electrons and
positrons in the magnetic ﬁeld.

We consider ﬁrst the ﬂat static universe and calculate
the cascade spectrum from a point-like burst of radia-
tion at a large distance from an observer. The remnant
cascade photons at large distances become the cascade-
sterile and we refer to spectrum of these photons as uni-
versal.

To compare the calculated spectrum with numerical
simulations we consider further expanding universe and
a burst of high energy radiation at a point with redshift
z. In this case the spectrum of sterile photons remaining

from e-m cascade undergoes the redshift.

A. Universal spectrum in analytic calculations

In this subsection we consider the ﬂat static universe
and e-m cascade from a point-like burst of very high en-
ergy photons or electrons at distances from an observer
to be large enough for remnant photons to become sterile.
The criterion of high energy (HE) and low energy (LE)
for a cascade particle with energy E is given with help
dimensionless parameter xt

xt = Eεt/m2
e,

(3)

where εt is energy of a target photon (t=cmb or ebl).
xt ≫ 1 and xt ≪ 1 characterizes HE and LE regimes, re-
spectively. In HE regime, for both PP and IC, a cascade
particle propagates as a leading particle γ → e → γ → e
(see Fig. 1, leading-particle regime) loosing in each colli-
sion (PP and IC) fraction of energy [32]:

f ≈ 1/[ln(2Eε/m2

e)].

(4)

The turning point occurs when a leading particle ap-

proaches x >
Fig. 1.

∼ 1 , and enters multiplication regime II in

In case of expanding universe we assume that devel-
opment of the cascade occurs during time τcas(E) much
shorter than the Hubble time H −1(zb), where τcas(E) ∼
1/(σ(E)cnbckgr) and σ(E) is cross-section for HE photon
or electron. The cascade development continues until the
cascade photons reach, due to multiplication, the thresh-
old of pair-production in the process γ + γebl → e+ + e−.
After this moment the remnant cascade photons loose
energy only by redshift.

Because of inequality ncmb ≫ nebl the cascade de-
velopment proceeds in two stages. At the ﬁrst one a
cascade develops in collisions with CMB photons only:
γ +γcmb → e− +e+ and e+γcmb → e′ +γ ′. At the second
stage the remnant photons from HE part of the distribu-
tion are absorbed on EBL radiation γ + γebl → e− + e+,
and then the produced e+ and e− are scattered on more
numerous CMB photons: e + γcmb → e′ + γ ′. Because
of this, calculations of the cascade on CMB background
only, has the physical importance. This stage becomes
particularly signiﬁcant at zb ≫ 1 when the EBL radia-
tion is absent and a cascade develops only on CMB. At
smaller readshifts EBL radiation appears, and the cas-
cade enters its second stage.

γ

The remnant photon spectrum is characterized by the
following benchmark energies: the minimum energy of
absorbed photon E min
, to which we refer to as min-
photon, the minimum energy of absorbed photons for
CMB background only E cmb
, minimum energy of the cas-
cade electron/positron Ee = E min
/2 (min-electron) and
the energy EX of photon (X-photon) produced in IC by
min-electron. These energies are listed below in Eq.(5)

γ

γ

together with their numerical values estimated for values
ǫcmb = 6.3 × 10−4 eV and ǫebl = 0.68 eV (see discussion
below).

4

γ =

γ = E ebl
E min
E cmb
γ =
Ee =
1
3E min

m2
e
= 3.9 × 1011 eV
ǫebl
m2
e
= 4.1 × 1014 eV
ǫcmb
1
2E min
γ = 1.95 × 1011 eV
ǫcmb
= 1.2 × 108 eV
ǫebl

EX =

γ

(5)

These energies appear in the cascade development illus-
trated by Fig. 1.

At highest energies x ≫ 1 the cascade develops in
leading particle regime I, γ → e → γ → e, with a
small fraction of energy (4) lost in every collision. The
non-leading (nl) particle in this process is always elec-
tron (or positron). However, as long as Enl
e ≫ 1
non-leading electron propagates as a leading particle and
transfers its energy to cascade multiplication regime II
(see Fig. 1, leading-particle regime I). As numerical cal-
culations show, the total energy injected into regime II
approximately equals to initial energy Es, mainly be-
cause the non-leading electrons can enter the multipli-
cation regime (see Fig. 1).

e ε/m2

γ

The leading-particle regime ﬁnishes at E cmb

, when
e+e− pairs are not produced on CMB photons and ap-
proximately at this energy cascade multiplication regime
II starts. Pair-production there occurs on EBL radia-
tion while IC proceeds mainly on more numerous CMB
photons. The minimum energy E min
γ = 3.9 × 1011 eV of
photons, which are able to produce e+e− pairs on high-
energy EBL target photons, mark the end of the cas-
cade multiplication and beginning of low-energy region
III where IC on CMB photons, e + γcmb → e′ + γ ′, dom-
inates. The produced photons are cascade-sterile and, in
consideration of this subsection, propagate not loosing
the energy adiabatically.

The energy spectrum of these photons is easy to cal-
culate from two relations: dnγ = dEe/Eγ and Eγ ≈
(Ee/me)2ǫcmb, valid for low-energy regime III. One ob-
tains:

dnγ/dEγ ∝ E−3/2

γ

(6)

Eq. (6) gives the robust prediction for low-energy asymp-
totics of the cascade spectrum.

There is one feature common for all stages of the cas-
cade I - III: due to strong dominance of density of CMB
photons, ncmb ≫ nebl, IC scattering is alsways domi-
nated by CMB photons.
For this regime in region III and most part of region

II the relation given by equation (7) below is valid:

E ′

γ =

4
3

γ2
e ǫcmb,

(7)

5

leading particle

E0

n

o

n

−

l

e

a

d

i

n

g

e

γmin

sterile γ

sterile γ

high E

leading − particle regime

cascade
multiplication

I

I I

low − energy
regime

I I I

E cmb

γ

E min

γ

Ee

low E

FIG. 1: Qualitative picture of the cascade development in static universe for mono-energetic energies of background
photons ǫcmb and ǫebl with assumption ǫebl ≫ ǫcmb and ncmb ≫ nebl. The energies of cascade particles E cmb
, E min
and Ee mark three regions of the cascade development: (I) HE leading-particle regime when a leading particle losses
very small energy in a collision with background photons, (II) fast cascade multiplication, with comparable fraction

γ

γ

of energy obtained by each of two produced particles and (III) regime of production of sterile photons by the

electrons with energy E ≤ Ee (see text for the details.)

)

V
e

/
γ

E
(
g
o
L

 16

 14

 12

 10

 8

 6

 4

 2

 0

III

II

I

 6

 8

 10

 12
Log(Ee/eV)

 14

 16

FIG. 2: Comparison of the exact calculation of mean
energy of the recoil CMB photon E ′
γ in IC scattering
(shown by red curve) and its asymptotic dependence

according to Eq. (7) (black dotted line).

γ ∼ γ2

The essential feature of Eq.(7), E ′

where γe = Ee/me is the electron Lorentz-factor and E ′
γ
is the average energy of cmb photon after scattering oﬀ
the electron. This equation was obtained in [33] and [32]
and it is valid at energy of target photons εr ≪ me in
the system where the electron is at rest.
e ǫcmb can be
easily obtained from the Lorentz transformations.
In-
deed, consider an electron with Lorentz factor γe collid-
ing with CMB photon ǫcmb. The energy of this target
photon in the system of electron at rest, ǫr ∼ γeǫcmb
is assumed to be much smaller than me. After scatter-
ing such photon does not change its energy ǫ′
r = ǫr, and
in laboratory system it is typically boosted by another
Lorentz factor γe: ǫ′ ∼ γeǫ′
In Fig. 2 we
compare E ′
γ from Eq. (7) (black dotted line) with exact
calculation (red line) both given as a function of electron
energy Ee plotted at abscissa. One may see that maxi-
mum energy E ′
γ from Eq. (7) is valid up to 3 × 1013 eV.
In fact in all cases of applications below the maximum
energy of photon spectra is provided by absorption on
EBL radiation and thus maximum energy is given by
γ = m2
E ebl
= 3.9 × 1011 eV, much below 3 × 1013 eV al-
lowed by exact calculations. The only almost exceptional
case EX = 2.0 × 1013 eV is given by nearby sources (see
TableI in Section II E). Probably too ﬂat ∝ E−1.7 part of
the spectrum between EX and Eγ is a reﬂection of more
ﬂat red curve in Fig. 2 above E ′
It is important to note that instead of following the
time-dependent cascade development, we consider a his-
tory of a cascade in terms of particle generations. Parti-
cles, electrons and photons, can reach given generation ν
at diﬀerent times. The total number of particles in one
generation is Ntot = 2ν and relation between number
of electrons Ne and photons Nγ in the same generation
with large ν is approximately Ne ≈ 2Nγ (in case a cas-

γ = 3 × 1013 eV.

r ∼ γ2

e ǫcmb.

e
ǫebl

6

cade starts by electron this relation is given by Ne =
2Nγ + (−1)ν and in case by photon Ne = 2Nγ − 2(−1)ν).
For calculation of the cascade energy spectrum we in-
troduce the quantity q(E), as a number of cascade par-
ticles passing through energy E during the whole time
of cascade propagation. For electrons and photons we
use notation qe(E) and qγ(E), respectively. Assuming
that total energy in the cascade is conserved, one can
use the equality of primary-particle energy Es and the
total energy E × q(E) which ﬂows through energy E
during all cascade history. Taking into account that
Ne ≈ 2Nγ in each generation of the cascade in the mul-
tiplication region II, one obtains qe(E) = (2/3)Es/E
and qγ(E) = (1/3)Es/E (for diﬀerent way to prove
q(E) ∝ (1/E) see [4] and [34]). For low-energy regime III
we have qe(E) = const for electrons and qγ(E) increasing
with energy due to low-energy tail of photons produced
by electrons.

The basic equation for the number of the cascade pho-

tons nγ(E) reads

dnγ(Eγ) = qe(Ee)dEe/Eγ.

(8)

−3/2
γ

In low-energy regime III we can use additionally to
Eq. (8) qe(Ee) = q0 at Ee ≤ Ee, and Eγ ∝ E2
e for
It results in
IC photon production on CMB photons.
dnγ/dEγ ∝ E
at Eγ ≤ EX in agreement with Eq. (6).
In multiplication regime II we use additionally to basic
equation (8), qe(Ee) ∝ 1/Ee and Eγ ∝ E2
e We obtain
thus dnγ/dEγ ∝ E−2
γ , valid in the interval EX ≤ Eγ ≤
E min
. At Eγ ≥ E min
all remnant photons are absorbed
γ
γ
and dnγ/dEγ = 0.

Thus we ﬁnally obtain for the spectrum of remnant

photons in terms of the total number of particles nγ:

γ

eV,

(K/EX )(Eγ/EX )−3/2 at Eγ ≤ EX
(K/EX )(Eγ/EX )−2
at EX ≤ Eγ ≤ Eγ
at Eγ > Eγ
0
= m2

nγ(Eγ) =

(9)
where absorption energy Eγ = E min
e/εebl =
3.9 × 1011
is minimum energy of absorbed
photon (min-photon), and transition energy EX =
(4/3)(Ee/me)2εcmb = 1.2 × 108 eV is the energy of IC
photon radiated by min-electron produced in absorption
of min-photon. Everywhere below we use Eγ and EX as
generic notation for cutoﬀ energy and energy of transi-
tion between E−3/2 and E−2 regimes, respectively. The
background radiation (cmb or ebl) can be indicated as
indices, when it is needed. The normalizing coeﬃcient K
can be found from conservation of energy in the cascade,
with the total energy equals to energy Es of primary
electron or photon.

K =

Es

EX (2 + ln Eγ/EX )

.

(10)

We will refer to spectrum (9) with normalization (10) as
universal spectrum:
its shape is ﬁxed independently on
initial energy Es or even injection spectrum Q(Es), if

γ

from Eq. (5).

initial energy is suﬃciently high, larger than scale energy
E0, which can be taken as E cmb
The initial energy Es (or energy density ωcas for diﬀuse
ﬂux) changes only total normalization coeﬃcient K from
Eq. (10). Thus the shape of the cascade spectrum does
not depend on the injection spectrum and propagation
time (spectrum is frozen at the remnant-photons stage
and forgets about its production stage). This universality
will be referred to as ’strong universality’.

−3/2
γ

The universal spectrum given by Eq. (9) with nor-
malization (10) has been obtained above in the simple
model for static ﬂat universe, but in fact it is valid for a
wide class of diﬀerent models, e.g. for realistic expand-
ing universe at ﬁxed redshift, if cascade develops at time
τ shorter than the Hubble time H −1(z). In many cases
below, Eqs (9) and (10) are valid, though with numerical
values of Eγ, EX and K diﬀerent from that given above.
The universal spectrum of remnant photons left be-
hind cascading of particles on dichromatic background
photons with energies εcmb = 6.3 × 10−4 eV and εebl =
0.68 eV in ﬂat universe at large distance from an ob-
server is characterized by the following spectral features:
it has a ﬂat energy spectrum ∝ E
from the lowest
energies and up to EX = 1.2 × 108 eV; it becomes more
steep ∝ E−2 at higher energies, followed by a sharp cut-
oﬀ at Eγ = m2
e/εebl = 3.9 × 1011 eV due to absorption
on EBL photons. The most reliable predictions of this
simple model are low energy spectral shape ∝ E−3/2 (ro-
bust) and cascade-multiplication one ∝ E−2 (probably
approximate), while prediction of sharp cutoﬀ at Eγ is
caused by assumption of large distance to the source and
monochromatic spectrum of EBL. The sharpness of the
spectral feature at EX with its numerical value is artifact
In fact
of dichromatic model of background radiation.
at both energies EX and Eγ there must be the transition
regions.
The low-energy component of spectrum (9) ∝ E−1.5
is a signature of low-energy IC scattering (7), while the
component ∝ E−2 is a signature of the cascade mul-
tiplication (region II in Fig. 1 up to cutoﬀ at energy
E ebl
γ = 3.9 × 1011 eV ).
Eq. (9) gives the total number of photons from a point-
like source.
In particular in case of one primary UHE
photon/electron nγ(Eγ)dEγ gives the total number of the
cascade photons with energy Eγ observed at any large
distance r from a source. Since the both characteris-
tic energies Eγ and EX do not depend on distance and
energy Es, Eq. (9) presents the same universal spectrum
nγ(Eγ ) for any initial energy Es being larger than energy
Eγ. Eq. (9) gives also diﬀuse ﬂux with normalization Es
substituted by the energy density of the cascade radia-
tion ωcas. Since the cascade spectra nγ(Eγ) are the same
far all Es (apart from the total normalization) the spec-
tra are the same for any generation spectrum Qg(Es).
In other words the resultant universal spectrum forgets
about its parent generation spectrum.

The diﬀuse ﬂux of the cascade radiation is described
by the space density of the cascade photons nγ(Eγ) with

7

normalization given by Eq. (10) where Es is substituted
by the energy density ωcas. The problem here is an addi-
tional component at Eγ > Eγ due to nearby sources (see
subsecton II E).
In conclusion, the universality of spectrum (9) for both
remote point-like sources and diﬀuse radiation implies
that all characteristics of the spectrum do not depend on
the primary energy Es and distance r (for a point-like
source). The universal spectrum, obtained above in a
static universe, describes in fact rather wide class of re-
mote gamma-ray sources in the universe and also diﬀuse
gamma-ray radiation. In the next subsections II B, II C
and II E we will present the relevant comparison with
numerical simulations for point-like sources and discuss
the phenomena which limit the validity of the universal
spectrum.

B. Comparison of universal spectrum with

numerical simulations

In this subsection we compare the universal spectrum,
obtained within our simpliﬁed model, with realistic nu-
merical simulation. Universal spectrum (9) is not valid
for sources at too small and too large redshifts z. At small
redshifts (nearby sources) absorption on EBL, which is
essential feature of our model, may not occur because
of small distance and low space density of EBL photons.
Cascades may not be produced at all if a primary photon
has energy Es less than threshold of pair production on
EBL, Eγ.
Note that in our calculations we did not include at all
the density of target photons. Instead we just assumed
that distance to a source is large enough for photon ab-
sorption at E > Eγ.
For nearby sources this assumption fails. In case of low
density nebl of EBL photons, σpairneblrsource ≪ 1, cas-
cade may still develop on CMB only; and this case will be
considered below. Even if a photon is absorbed, cascade
still may not develop. It happens when characteristic IC
radiation length for secondary electron/ positron exceeds
the distance to the observer.

At the large redshits z comparison with numerical sim-
ulations may fail, because in analytic calculations we ne-
glect eﬀects of the universe expansion and energy red-
shift. We will include these eﬀects in the next subsec-
tion and thus extend our consideration to larger red-
shifts. The ﬁrst comparison of analytic calculations
[36] (similar to our static-universe model) with MC sim-
ulation for sources with ﬁxed redshift z was done in
[35] and presented in the upper panel of Fig. 3. We
can compare now the predicted spectrum (9) shown by
thick black line, with MC spectrum from [35]. For
z = 0.15 (r = 626 Mpc) we see the good agreement
with the model where energy of EBL photons are ﬁxed
as εebl = 0.676 eV. The low-energy spectrum ∝ E−1.5
is reliably conﬁrmed. The cascade multiplication spec-
trum (∝ E−2) is seen as E−1.9. Values of EX and Eγ

ε
x↓

E-1.9

E-1.5

εγ
↓

z=0.02

1

0.1

)

E
(
J
 

2
E

0.01

0.001

10-4

106

107

108

109

z=0.15

1011

1012

1013

1014

1010
E/eV

Ex(0)

E−1.5

E−1.9

Eγ(0)

Eγ(0) =

m2
e
εz
ebl

1

1 + z

,

EX (0) =

m2
3(εz

eεcmb
ebl)2 .

(11)

C. Expanding universe and comparison for z > 0.3

8

1

For large redshifts z > 0.3 we assume that cascades
have enough time to be developed during the Hubble
time H −1(z) to the spectrum given by Eq. (9). The en-
ergies of background photons at epoch z are assumed
to be εcmb(z) = (1 + z)εcmb for CMB and εz
ebl >
εebl for EBL. Accordingly, the characteristic energies
at redshift z become Eγ(z) = m2
ebl and EX (z) =
3 (Eγ(z)/me)2εcmb(z). Spectrum of remnant photons at
epoch z, nγ(Eγ, z), is given by Eq. (9) with EX ≡ EX (z)
and Eγ ≡ Eγ(z). At propagation of this spectrum to
z = 0, the energies of photons Eγ and characteristic en-
ergies Eγ(z) and EX (z) are redshifted by factor (1 + z),
but Eq. (9) remains the same with invariant value of K
provided by conservation of number of particles during
the redshift process, nγ(Eγ, z)dEγ = nγ(E, 0)dE. Red-
shifted characteristic energies are given by

e/εz

From the second relation in Eq. (11) one ﬁnds the energy
of EBL photon εz

ebl at epoch z as

εz

ebl =(cid:18) m2

eεcmb

3EX(0)(cid:19)1/2

.

(12)

Now the procedure of comparing of analytic solution with
numerical simulation consists of the the following four
operations illustrated by Fig. 4:

ebl using Eq. (12).

(i) Normalization of E−1.5 part of analytic solution by
E−1.5 part of the simulation.
(ii) Finding EX (0) as intersection of E−1.5 and E−1.9
parts of the spectrum (see Fig. 4). In this operation we
neglect the diﬀerence between E−1.9 and E−2.
(iii) Calculation of εz
(iv) Calculation of cutoﬀ energy Eγ(0) from Eq. (11).
Comparison of analytic solutions with numerical sim-
ulation is presented in Fig. 4 for
redshifts z =
0.32, 0.4, 0.64, 1.0. The analytic solution predicts that
cascade spectrum consists of two power-law components
E−1.5 and E−2, with intersection at EX . The numeri-
cal simulations conﬁrm this prediction with component
E−1.9 instead of E−2. The only free parameter in ana-
lytic calculations is energy of EBL photons for each red-
shift, which means the value of εebl ≈ 0.68 at z = 0 and
evolution εz
ebl deter-
mines two characteristic energies EX and Eγ.
In contrast to the sharp spectral features in analytic
calculations , the numerical simulations predict a smooth
transition regimes centered by these features.

ebl/εebl = f (z). Free parameter εz

The evolution of EBL energy εz

ebl/εebl with z in dichro-
matic model must correspond, to some extent, to the
evolution of the mean EBL energy ¯εebl(z) with redshift.
The numerical simulations show an interesting feature
of merging the spectrum nγ(E, z) to E−1.9 at increasing
z, which coincides within accuracy of calculations with

)
E
(
γ
n
2
E

10000

1000

100

10

1

0.1

z = 0.2:
Eγ(0) = 0.25 T eV
Ex(0) = 74 M eV

z = 0.25:
Eγ(0) = 0.24 T eV
Ex(0) = 74 M eV

0.2

0.25

107

108

109

1010

1011

1012

E/eV

FIG. 3: Comparison of analytic calculations (black

thick line) with numerical simulation (red and blue lines

for z = 0.15 and z = 0.02 correspondingly from the

work by Kachelrieß et al [35] (upper panel) and from the

present work (lower panel) for redshifts z = 0.2 (red

line) and 0.25 (green line). Analytic calculations in the
lower panel are presented by blue broken lines. For the
both panels the line ∝ E−1.5 is shown for comparison;
the characteristic energies in analytic calculations EX

and Eγ are shown by arrows (see the text).

agree well with MC simulation. The MC simulation gives
a smooth transition between diﬀerent regimes, while in
analytic calculations it is sharp because of dichromatic
spectrum of background.

For z = 0.02 (r = 83.4 M pc) agreement is bad and it

has to be interpreted as small distance to the source.

In the lower panel of Fig. 3 the analytic spectrum (9) is
compared with our numerical simulations with the same
conclusions (see subsection III).

The success of static model is provided by large, but
not too large value of z. For larger redshifts we have
to generalize our analytic calculations for expanding uni-
verse.

9

)
E
(
γ
n
2
E

)
E
(
γ
n
2
E

10000

1000

100

10

1

0.1

10000

1000

100

10

1

0.1

E−1.5

Ex(0)

E−1.9

Eγ(0)

z = 0.32
Eγ(0) = 0.17 T eV
Ex(0) = 42 MeV

107

108

109
E/eV

1010

1011

E−1.5

Ex(0)

E−1.9

Eγ(0)

z = 0.64
Eγ(0) = 97 GeV
Ex(0) = 20 MeV

107

108

109
E/eV

1010

1011

)
E
(
γ
n
2
E

)
E
(
γ
n
2
E

10000

1000

100

10

1

0.1

10000

1000

100

10

1

0.1

E−1.5

Ex(0)

E−1.9

Eγ(0)

z = 0.4
Eγ(0) = 0.15 T eV
Ex(0) = 33 MeV

107

108

109
E/eV

1010

1011

Ex(0)

E−1.5

E−1.9

Eγ(0)

z = 1
Eγ(0) = 64 GeV
Ex(0) = 13 MeV

107

108

109
E/eV

1010

1011

FIG. 4: Comparison of analytic calculations with numerical simulations from this work for large redshifts z > 0.3.
Four panels show the comparison for redshifts 0.32, 0.4, 0.64, and 1.0 with the same notation as in Fig. 3 (see the

text for details).

fundamental spectrum of the cascade multiplication E−2
in analytic calculations (see Fig. 5).

E-1.5

E-1.9

0.5

0.16
0.04
0.02

 1000

 100

 10

 1

5
.
1
E

j

0.002

 0.1

0.00025

107

108

109

1010
E [eV]

1011

1012

1013

1014

and

10

For redshift z there are two spectra of interest: the
equilibrium spectrum at epoch z, nγ(Eγ, z), and this
spectrum redshifted to epoch z = 0, nγ(E, 0) .

Consider ﬁrst the former. It is given by Eq. (9) with
εz
cmb = εcmb(1+z) and by characteristic energies at epoch
z as

Eγ(z) = m2

e/εz

cmb,

EX (z) = (1/3)Eγ(z).
given by Eq.

(15)

The normalization is
Eγ(z)/EX(z) = 3.
The spectrum redshifted to z = 0 may be also of in-
terest for applications.
It is given by redshifted char-
acteristic energies Eγ(0) = Eγ(z)/(1 + z) and EX (0) =
EX (z)/(1 + z):

(10) with

m2
e

Eγ(0) =

εcmb(1 + z)2

(16)

(17)

FIG. 5: Merging at increasing z of

numerically-simulated spectra to the universal E−1.9

spectrum, which within accuracy of calculations
coincides with fundamental cascade-multiplication

spectrum ∝ E−2 in analytic calculations.

D. Cascading only on CMB

This section has a technical character. Study of the
cascade development only on CMB is important at least
in two cases discussed in this paper:

(i) In the case of nearby sources when absorption of

photons on EBL is absent.

(ii) In expanding universe at large redshifts, when due
to high space density of CMB photons a cascade is de-
veloping very fast with cutoﬀ at E cmb
cmb. Only
later the HE tail of the cascade photon distribution is
slowly absorbed on EBL, followed by IC of produced elec-
trons and positrons on CMB photons.

γ = m2

e/εz

Consider ﬁrst cascading on monochromatic CMB at
z = 0. The energy spectrum of cascade is given again by
Eq. (9) with

EX (0) = (1/3)Eγ(0) = (1/3)

m2
e

εcmb(1 + z)2

The redshift leaves constant K in normalization (10) in-
variant.

In fact, the monochromatic CMB model considered
above is unrealistic and introduction of dichromatic
model is necessary in most applications.
It can be ex-
plained for example by cascading on CMB at z = 0
at distance r from an observer.
IC scattering occurs
on all CMB photons which energy can be assumed as
εcmb = 6.3 × 10−4 eV. However, absorption of photons
occurs on CMB photons from high energy tail of Planck-
ian distribution and minimum energy of absorbed pho-
tons Emin is determined by much higher energies of CMB
photons ˜εcmb ≫ εcmb as

˜Emin = ˜E cmb

min = m2

e/˜εcmb.

(18)

Energy ˜εcmb coincides with minimum energy in HE tail
of CMB photons for given Eγ because with increasing of
ε the number density of CMB photons exponentialy falls
down.

Therefore, we come back to the standard spectrum
given by Eq (9) distorted at the highest energies due to
distortion of relation Eγ = 4
e εcmb and with εebl substi-
tuted everywhere by ˜εcmb.

3 γ2

Eγ = E cmb

γ = m2

e/εcmb ≈ 4.1 × 1014 eV

(13)

E. Cascades from nearby sources

and

EX = (4/3)(Ee/me)2εcmb = (1/3)E cmb

γ

(14)

The normalization is given by the same equation (10)
with Eγ/EX = 3 as follows from Eq. (14).
The remarkable feature of this calculation is prediction
of very narrow cascade-multiplication energy width given
by ratio Eγ/EX = 3, to be compared with 3× 103 for uni-
versal spectrum (9). This is the direct consequence of
monochromatic CMB model accepted here (see discus-
sion in the end of this subsection).

In this section we calculate the cascade spectrum tak-
ing into account only CMB radiation and compare them
with numerical calculations at the same assumptions.
This procedure clariﬁes the interesting physical details.
As argued above the cascade spectrum on CMB-only
must be calculated using the dichromatic model of back-
ground radiation with εcmb = 6.3 × 10−4 eV, which pro-
vides IC scattering, and higher energy ˜εcmb, which pro-
vides absorption of cascade photons with minimum en-
ergy ˜Emin given by Eq. (18). As physics is concerned

11

10

1

0.1

0.01

10

1

0.1

0.01

r=8.5Mpc, CMB only
Eγ = 118 T eV
Ex = 11 T eV
Elec = 6 MeV

E−1.5

Elec

E−1.78

Ex

Eγ

107

108

109

1010

1011

1012

1013

1014

1015

E, eV

r=200Mpc, CMB only
Eγ = 86 T eV
Ex = 7.6 T eV

E−1.78

Ex

E−1.5

Eγ

107

108

109

1010

1011

1012

1013

1014

1015

)
E
(
b

c

m
γ
Q

5
.
1
E

)
E
(
b

c

m
γ
Q

5
.
1
E

10

1

0.1

0.01

10

1

0.1

0.01

r=1Mpc, CMB only
Eγ = 158 T eV
Ex = 20.5 T eV
Elec = 434 MeV

E−1.5

Elec

E−1.78

E−1.47

Ex

Eγ

107

108

109

1010

1011

1012

1013

1014

1015

E, eV

r=85Mpc, CMB only
Eγ = 92 T eV
Ex = 7 T eV
Elec = 0.06 MeV

E−1.5

E−1.78

Ex

Eγ

)
E
(
b

c

m
γ
Q

5
.
1
E

)
E
(
b

c

m
γ
Q

5
.
1
E

107

108

109

1010

1011

1012

1013

1014

1015

E, eV

E, eV

FIG. 6: Comparison of analytic calculations with numerical simulations for CMB radiation only for nearby sources

at distances 1.0 Mpc, 8.5 Mpc, 85 Mpc and 200 Mpc.

˜εcmb is minimal energy in HE Planckian tail of pho-
ton distribution where number density of photons is
big enough enough for absorption of photons with en-
ergy ˜Emin. The energy εmin for ˜Emin can be calculated
from kinematic relation for arbitrary Eγ and ε given by
Eγε(1 + cos φ) = 2ε2
cm, where φ is an angle between pho-
tons Eγ and ε in laboratory system and εcm is energy of
each photon in cm-system. Finding the value ε from this
relation for Eγ = ˜Emin and minimizing it with the choice
e/ ˜Emin as
cos φ = 1 and εcm = me, we arrive at εmin = m2
in Eq. (18).
We can discuss now the spectra and basic features pre-
dicted for the cascades on CMB from nearby sources, as-
suming tentatively, as the ﬁrst step, εcmb ∼ 6 × 10−4 eV
and ˜εcmb ∼ 2× 10−3 eV (these values will be determined
more precisely after comparison with numerical simula-
tions.)

e

The minimum absorption energy (on CMB photons)
abs ( ˜Emin) = r, where
can be estimated from equation ℓcmb
ℓcmb
It
abs (Eγ) is absorption length in CMB background.
results in well known value ˜Emin ∼ 1 × 1014 eV and it is
given precisely, as ˜Eγ, for diﬀerent distances r in Table
I. Using Eq. (18) we ﬁnd then ˜εcmb ∼ 2 × 10−3 eV. The
transition energy is given by EX = (1/3)( ˜Emin/me)2εcmb
which approximately equals to 7 × 1012 eV. We cannot
expect in this picture the standard spectra ∝ E−1.5 and
∝ E−2, especially the latter one. First of all the spectrum
can be ﬂatter than ∝ E−2 due to ﬂattening of Eγ ∝ E−2
regime in the end of the IC spectrum (see Fig. 2).
Another plausible reason is the width of the cascade-
multiplication part of the spectrum, i.e. one with con-
ventional E−2 spectrum, but with ratio Eγ/EX ≈ 14 to
be compared with 3 × 103 for the case of (εcmb, εebl)
background. The relatively small ratio Eγ/EX ≈ 14
is the reminiscent of the ratio 3 for CMB monochro-
matic background model (see Eq. (14)). Since the real-
istic simulations show a smooth transition between en-
ergies EX and Eγ, one may expect non-power-law of
cascade-multiplication spectrum,
in disagreement with
the dichromatic model. As for low-energy asymptotic
spectrum E−1.5, it also should be distorted, because ab-
sorption on ˜εcmb photons occurs at distances of order
of distance to the source r and thus a cascade is un-
derdeveloped. Now we will compare the analytic esti-
mates with accurate numerical simulations for cascades
on CMB radiation, and obtain more precisely parame-
ters of our dichromatic model for diﬀerent distances r to
the source. We will change the notation as ˜Emin ≡ ˜Eγ to
emphasize that this is the value of spectrum cutoﬀ.
abs ( ˜Eγ) = r,
where ℓcmb
abs (Eγ) is absorption length in CMB background.
The values of ˜Eγ are shown in Table I for distances 1.0 ,
8.5 , 85 , and 200 Mpc.
Next we calculate ˜εcmb using Eq. (18) and values of

As the ﬁrst step we ﬁnd ˜Eγ from equation ℓcmb

˜Emin ≡ ˜Eγ from the Table I (third row).
The values of EX in the fourth row are obtained from
comparison with numerical simulations (see Fig. 6 ) as in-

12

tersection of the power-law approximation of the cascade-
multiplication spectrum (∝ E−1.8 in the Fig. 6) with low-
energy asymptotic.
The energies of CMB photons εcmb (ﬁfth row) are cal-

culated using the equation EX = (1/3)(Eγ/me)2εcmb.
In the last row of Table I we put the low-energy cutoﬀ
E γ
lec of the cascade spectrum estimated in the following
way.

The low-energy cascade electrons with energy below
some critical energy Ecr
e (r) have a time of IC pho-
ton emission larger than time-of-ﬂight r/c. Therefore
radiation of IC photons with energies below E γ
lec =
(4/3)(Ecr

e /me)2εcmb is suppressed.

The critical energy of electron Ecr

e can be found from
e ) = c/r, where τe(E) is the electron lifetime rel-

(Ecr

τ −1
e
ative to IC energy loss:

τ −1
e

(Ee) =(cid:18) 1

Ee

dEe

dt (cid:19)IC

=

4
3

σT cγe

ρcmb
me

,

(19)

where σT is the Thompson cross-section, γe = Ee/me
is the electron Lorentz-factor and ρcmb = εcmbncmb is
energy density of CMB radiation. Eq. (19) can be rear-
ranged as

τ −1
e

(Ee) =

4
3

σT cncmb

Ee
E cmb

γ

(20)

e/εcmb.

where E cmb
Using τ −1
electron Ecr

γ = m2
(Ecr
e and low-energy cutoﬀ E γ

e

e ) = c/r one ﬁnds the critical energy of

lec as

Ecr

e =

3/4

σT ncmbrE cmb

γ

; E γ

lec =

3

4(cid:18)

1

σT ncmbr(cid:19)2

E cmb

γ

(21)

From Table I one can see that for nearby sources at dis-
tance 1 - 85 Mpc the dichromatic model is characterized
by almost equal energies εcmb ≈ 6×10−4 eV and by sim-
ilar values of ˜εcmb ≈ (2−3)×10−3 eV. For 200 Mpc these
values diﬀer more considerably. The low-energy cutoﬀ is
observable only for very close sources E γ
lec ∼ 400 MeV for
r = 1 Mpc; for r = 8.5 Mpc it starts at 6 MeV.

Finally we calculate the cascade-photon spectrum tak-
ing the characteristic energy features from Table I and
compare this spectrum with precise numerical simulation
on CMB radiation only. One may expect that canon-
ical low-energy part of spectrum ∝ E−1.5 will survive
for long-distance sources and may fail for short-distance
ones, being underdeveloped. The Fig. 6 conﬁrms this
expectation: for distance r = 200 Mpc the spectrum co-
incides well with E−1.5 shape, and weakly distorted at
smaller distances. For high-energy part of the spectrum
(EX − Eγ) the energy interval is very short and spectrum
is ∝ E−1.78 ﬂatter than canonical 2.0 .

TABLE I: Parameters of analytic model for nearby

A. Generalities

sources (CMB only).

13

distance r

1 Mpc

85 Mpc

8.5 Mpc

200 Mpc
˜Eγ eV 1.58 × 1014 1.18 × 1014 9.24 × 1013 8.6 × 1013
˜εcmb eV 1.65 × 10−3 2.21 × 10−3 2.83 × 10−3 3.04 × 10−3
EX eV 2.05 × 1013 1.11 × 1013 7.0 × 1012
7.6 × 1012
εcmb eV 6.42 × 10−4 6.24 × 10−4 6.43 × 10−4 8.0 × 10−4
E γ
1.09 × 104
lec eV 4.34 × 108

6.01 × 106

6.01 × 104

 10000

 1000

 100

]
c
p
M

[

 10

 1

 0.1

 0.01

 0.001

 0.0001

H-1

Le,att

Lγ,int

10-9G

δ=10°

10-17G

Le,int

10-15G

10-13G

10-11G

10-9G

108

109

1010 1011 1012

1013 1014 1015 1016 1017

E [eV]

FIG. 7: Shown are: pair production interaction length

(see Eq. 22) calculated assuming EBL models of

Ref. [16] (shown by solid blue line), of Ref. [17] (dashed

blue line) and of Ref. [37] (doted blue line); electron

attenuation length (see Eq. 23) due to inverse Compton

scattering (red line) and interaction length of this

process (green line); 10◦ deﬂection length for electrons

(shown by black dotted lines) for given values of
constant transverse component of magnetic ﬁeld;

synchrotron energy loss length (see Eq. 28) of electrons
in B⊥ = 10−9G (shown by pink dashed line); adiabatic
energy loss length (shown by horizontal solid black line).

III. NUMERICAL SIMULATIONS OF

ELECTROMAGNETIC CASCADE

PROPAGATION

The results presented in this work have been obtained
with two independent numerical techniques, the Monte
Carlo simulation and the code [38, 39] based on solu-
tion of Boltzmann kinetic equations for cascade particles
propagation in one dimension. The latter method doesn’t
take into account deﬂections of cascade particles by mag-
netic ﬁeld and therefore is valid only for calculations with
averaged angles and time or for diﬀuse ﬂuxes. In Fig. 7
interaction and energy loss lengths are shown for elec-
trons and photons. The lengths are deﬁned as follows:

L−1

i,int =Z dǫ n(ǫ)Z dµ

Le,att = Le,intEe/ ¯Eγ,

1 − βiµ

2

σi

(22)

(23)

where i = e, γ; σe = σIC ; σγ = σPP and ¯Eγ is the
mean energy of the recoil photon in IC. A number of ki-
netic equation-based codes has been developed at present
(see e.g.
[38, 40, 41]). For precise calculation of γ-
ray ﬂuxes from individual sources in presence of non-
negligible magnetic ﬁelds, full 3D Monte Carlo simula-
tion is needed. Such calculations as a rule require exces-
sive computing time since number of secondary particles
grows exponentially in the cascade. In the Monte Carlo
code used in this work to speed up computations we uti-
lize, following Ref. [35], the weighted sampling of the
cascade development. It allows us reduce the number of
secondary particles.

While IC scattering occurs mostly on CMB, the e+e−
pair production, when it is below threshold on CMB,
takes place on infra-red and optical components of EBL
which is not precisely known. A number of diﬀerent
models have been proposed for EBL [16, 17, 37, 42–45].
There are some upper bounds on EBL in the literature
that were based on observations of distant blazars. These
limits are derived without taking into account the con-
tribution of cosmic rays and therefore these bounds can
be relaxed [46], and only limits based on GRBs [47] re-
main unaﬀected. The model of Ref. [44] is disfavoured
by Fermi LAT observation of the photons from GRB
090902B and GRB 080916C. To obtain the range of ωcas
in this work we use the baseline model from the recent
work [37] which includes estimates of EBL for redshifts
z ≤ 10. In addition we use for comparison the ”best ﬁt”
and ”lower-limit” models of Refs. [16, 17], providing es-
timates of EBL for z ≤ 5. The EBL model of Ref. [43]
for z ≤ 2 is used only for comparison of our numerical
calculations with work [29].

In this section we will discuss the basics of numerical
simulations, universality of em-cascade spectra in the nu-
merical simulations, the calculated cascade energy spec-
tra and upper limits on cascade energy density ωcas ob-
tained from comparison of the calculated spectra with
observations of Fermi LAT.

Another poorly known factor which is crucial for con-
sideration of the electromagnetic cascades from individ-
ual sources is intergalactic magnetic ﬁeld (IGMF). Even
in presence of relatively weak IGMF the angular size of
sources can increase due to deﬂection of electrons and
positrons moving along the curved trajectories with cur-

vature radius Rc

14

Rc =

Ee

eB ≃ 1.1(cid:18) Ee

1 TeV(cid:19)(cid:18) B⊥

10−15 G(cid:19)−1

Mpc .

(24)

E-1.5

After traversing distance L the misalignment of the elec-
tron direction with the primary γ-ray direction is given
by angle δ:

)

E

(
j

2
E

 1

E-1.9

,

L
Rc
√LλB
Rc

L ≪ λB

, L ≫ λB .

(25)

 0.1

106

δ ≃


this work kinetic
this work MC
Taylor et al. 2011
analytic

107

108

109

1010

1011

1012

1013

E, eV

where λB is IGMF correlation length. In the second case
above, many stochastic deﬂections were taken into ac-
count. The deﬂections in the cascade can not be ne-
glected as soon as electron energy-loss length becomes
comparable with defocusing length i.e. the travel path at
which electrons are deﬂected by maximal angle δ. The
deﬁnition of δ varies for diﬀerent problems. It may be re-
lated to experimental angular resolution or average angu-
lar distance between the sources. The defocusing lengths
for δ = 10◦ and a range of IGMF strengths (assuming
λB ≫ L) are shown in Fig. 7 (black dashed lines) to-
gether with the energy-loss length (red curve) for com-
parison. As example in case B = 10−15G and δ = 10◦
one can infer that deﬂections become important for elec-
tron energy Ee <
coil photon energy of 3GeV. Below this energy γ-ray ﬂux
is essentially isotropized.

∼ 1TeV which corresponds to typical re-

Current theoretical and observational constraints on
the IGMF mean value and correlation length are sum-
marized in the review [22] as

10−17G <

∼ 10−9G,

∼ B <
λB >
∼ 1pc;

(26)
(27)

where the obtained lower limit on IGMF is based
on the simultaneous observation of GeV and TeV
gamma-radiation from the hard-spectrum blazars RGB
J0710+591,
and 1ES 1218+304
(Fermi/LAT-observations in GeV, and Veritas, MAGIC
and HESS observations in TeV) [29].

1ES 0229+200,

In the special case of IGMF being close to it’s up-
per limit B ≃ 10−9 and for the sources emitting ultra-
high energy photons or electrons with E >
∼ 1019eV, the
electron synchrotron losses should be taken into account.
Pink line on Fig. 7 represents energy loss-length for this
process given by [48].

L−1

syn =

1
Ee

dEe
dt

4
3

= −

σT

B2
8π

Ee
m2
e

(28)

where σT is the Thomson cross section, and me is the
electron mass. In this paper we disregard the synchrotron
energy losses if not otherwise stated.

FIG. 8: Average cascade spectrum obtained using
kinetic equation code (solid curve) and Monte Carlo

code (dashed curve) compared with analytic calculation

and with results of Monte Carlo simulation [29]

(dot-dashed curve), all for injection of 1014 eV photons

at z = 0.13.

B. Comparison

In this section we compare the cascade spectra ob-
tained using the kinetic equation and Monte Carlo codes
from the present work with other numerical simulations
and with analytic calculations. Fig. 8 demonstrates level
of agreement between our numerical calculations, sim-
ulation [29], and analytic calculation for a source at
z = 0.13 injecting 1014eV photons and using EBL model
of Ref. [43] for photon absorption. One may see in this
ﬁgure the familiar two cascade energy spectra ∝ E−1.5
and ∝ E−1.9 and also the steeper high energy feature in
a good agreement in all three numerical simulations. As
will be demonstrated below this feature plays an impor-
tant role in determination of the cascade energy density
ωcas.

The diﬀuse gamma-ray spectrum as presented by
Fermi LAT in 2015 [7] shows the steepening which starts
at 1 × 1011 eV and continues as more sharp cutoﬀ at
ǫ = 2.5× 1011 eV. The both high energy features in theo-
retical spectra in Fig. 8, ∝ E−1.9 and more steep feature
above it, are more ﬂat than that observed by Fermi LAT
and it results in the upper limit on ωcas. The reason may
be easily understood from Fig. 8.

For given large enough ωcas the realistic, numerically
calculated, spectra from Fig. 8 can intersect the Fermi
high energy tail at some energy. It means that at energy
above the crossing the calculated cascade ﬂux is larger
than the measured Fermi ﬂux. To eliminate this contra-
diction one must lower the calculated cascade ﬂux, i.e.
ωcas. This procedure results in the upper limit on ωcas.
The case of analytic spectrum in Fig. 8 is quite diﬀer-
ent. It has a sharp cutoﬀ at ǫγ ≈ 400 GeV close to Fermi

cutoﬀ energy ǫ ≈ 250 GeV and thus quite larger ωcas is
allowed.
All eﬀects which make lower the high-energy cutoﬀ in
the calculated cascade spectrum, e.g. high red-shift of
production, increase the upper limit on ωmax.

IV. UNIVERSALITY OF THE CASCADE
SPECTRA IN NUMERICAL SIMULATIONS

∼ m2

Universality of the cascade energy spectrum was dis-
covered ﬁrst in analytic calculations [34], and we will
start our discussion from analytic dichromatic model of
section II A. This universality is clearly seen from Eq. (9),
where two joint energy spectra ∝ E−3/2 and ∝ E−2
appear, divided by two boundary energies EX and Eγ,
built from basic parameters of dichromatic model εcmb
and εebl. The main features of this universal spectrum
include:
(i) The same energy shape of the spectrum
produced by initial photon/electron if its primary en-
ergy is suﬃciently high. Ultimately the scale can be as
high as E0 >
e/εcmb ∼ 0.4 PeV and it is the basic
one in analytic calculations. The lower universality scale
E0 ∼ 100 TeV is found in numerical simulations and this
result is very natural and may be expected apriori. In
analytic approach the cutoﬀ energy E cmb
= 0.4 PeV is
consequence of monochromatic spectrum of CMB pho-
tons ǫcmb = 6.3 × 10−4 eV. In numerical simulations
absorption occurs on high-energy tail of Planckian dis-
tribution of CMB photons and absorption produced at
E cmb
γ ≈ 100 TeV when ℓabs reaches c/H0. (ii) The cas-
cade energy spectrum is the same for any injection spec-
trum Q(Es) at Es >
∼ E0 (in other words cascade spec-
trum forgets what injection spectrum produced it). (iii)
The cascade spectrum does not depend on distance to the
point where cascade started, and (iv) Energy density of
the cascade ωcas is the only cascade characteristic which
determines the spectrum.

γ

These properties of ’analytic’ cascades will be referred

to as strong universality.

For realistic cascades in the expanding universe the
strong universality, as it is formulated above,
is not
valid. The cascade spectrum observed at z = 0 de-
pends on redshift of production zs, e.g. due to depen-
dence EX and Eγ on zs and simply due to redshift of
the spectrum. Consider for example the generation rate
of photons/electrons in expanding universe in the form
Q(Es, zs) = φ(Es)R(zs) with Es above the universality
scale E0. All cascades produced at ﬁxed redshift zs have
the same cascade spectrum qcas(E) at z = 0. However,
cascades originated at diﬀerent zs have the diﬀerent cas-
cade spectra at z = 0, and integration over zs results in
cascade spectra, which depend on distribution of produc-
tion rate Q(Es, zs) over zs. Predicted cascade spectrum
is determined not only by ωcas but e.g. by parameters of
cosmological evolution of the sources. Universality of the
cascade spectra remains only for a subclass of the sources
with approximately equal redshifts.
In summary, the

]

1
-

r
s
 

1
-

s
 

2
-
m
c
 
V
e

[
 

2
E
E

)

(
j

]

1
-

r
s
 

1
-

s
 

2
-
m
c
 
V
e

[
 

2
E
E

)

(
j

]

1
-

r
s
 

1
-

s
 

2
-
m
c
 
V
e
[
 

2
E
E

)

(
j

15

 1000

 100

 10

 1
106

107

108

109 1010 1011 1012 1013 1014

E [eV]

(a) zs = 0.01

 1000

 100

 10

 1
106

107

108

109

1010

1011

1012

1013

E [eV]

(b) zs = 0.1

 1000

 100

 10

 1
106

1 TeV
10 TeV
≥100 TeV

107

108

109

1010

1011

1012

1013

E [eV]

(c) zs = 1

FIG. 9: Diﬀuse cascade spectrum from sources injecting
photons with energy Es = 1 TeV (red curves), 10 TeV
(green curves) and Es ≥ 100 TeV (black thick curves)
at redshifts z = 0.01, z = 0.1, z = 1. Photon ﬂuxes are
limited from above by the Fermi EGB ﬂux, shown by

black errorbars, with foreground model B [7]. The

curves obtained for initial photon energies greater than
100 TeV coincide in all ﬁgures. In calculations the EBL

ﬂux from Ref. [37] is used.

sources in expanding universe with the generation rate
Q(Es, z), with Es above the universality scale E0 and
with arbitrary dependence on z (e.g. evolution (1 + z)m
up to zmax) have the following properties of universality:
(i) energy shape of em-cascade at z = 0 is independent
from Es or from injection spectrum φ(Es), i.e. for ﬁxed
zs the shape is the same for diﬀerent Es, or for diﬀer-
ent spectra φ(Es), (ii) cascade spectrum at z = 0 is not
uniquely determined by ωcas, but depends also on evolu-
tion of Q(E, z) with z, e.g. through parameters m and
zmax, (iii) a subclass of the sources with the same (or
almost the same) redshift zs has the identical cascade
spectrum at z = 0, which is characterized by the single
parameter ωcas.

This case can be referred to as weak universality.

Class of sources with the ﬁxed redshift of production
zs, i.e with production rate Q(Es, z) = φ(Es)δ(z−zs) has
all properties of strong universality, except (iii), and can
be attributed to strong universality for arbitrary gener-
ation spectrum φ(Es) with Es above the universal scale
E0. The corresponding cascade spectrum is characterized
by a single parameter ωcas for any ﬁxed zs.

Consider z-ﬁxed sources in some details, starting from
low initial energy Es < E0. At increasing Es the z = 0
cascade spectrum must evolve to strongly-universal spec-
trum and reaching it at scale E0 stay unchanged. Fig. 9
illustrates this statement. The ﬁgure presents the diﬀuse
ﬂuxes generated by the population of sources with the
ﬁxed energy of injected photon Es and with ﬁxed red-
shift zs. The diﬀuse spectrum shape at z = 0 doesn’t
depend on Es as long as Es >
. In fact, for remote
enough sources at z >
scale E0 >
EBL models used in this work.

∼ 0.1, universality is reached at the
∼ 100 TeV. This observation was tested for all

∼ E cmb

γ

The numerically calculated diﬀuse cascade spectra
from the sources with ﬁxed redshift zs and energy Es
are shown in Figs 9a - 9c. The spectra are expected to
be strongly universal when energy Es exceeds the largest
scale E0 = E cmb
γ = 0.4 PeV. All three ﬁgures (a), (b) and
(c) demonstrate that the spectra are universal at E ≥ E0,
where E0 = 100 TeV. This energy can be considered
as energy scale of universality in numerical simulations
(see discussion above). Apart from identical spectra they
have at large zs ≥ 0.1 the predicted standard spectrum
∝ E−3/2 at low energy, ∝ E−1.9, at intermediate energies
with highest energy feature in the end of the spectrum
(cf with Fig. 8). The spectra with Es = 100 TeV (black
thick curves) and with all energies Es >
∼ 100 TeV are in-
distinguishable in Figs 9.

The cascade universality makes it hard to extract the
injection spectrum from the diﬀuse spectrum observed
at z = 0. On the other hand the comparison of the
calculated and observed spectra allows us to estimate the
upper limit on the main characteristic of the universal
cascade spectrum, the cascade energy density ωcas at z =
0. This problem will be considered in the next section.

16

V. UPPER LIMIT ON ωcas FROM FERMI LAT

DATA

The upper limit on the cascade energy density given
by Eq. (1) as 5.8× 10−7 eV/cm3 has been derived in [36]
from the ﬁrst-year Fermi data [6]. Here we obtain this
limit from 50 months Fermi LAT observations [7] using
somewhat diﬀerent approach.

Fermi LAT [6] presents two kinds of extragalactic
gamma-ray ﬂuxes in energy range 100 MeV - 820 GeV:
EGB (Extragalactic γ-ray Background) and IGRB
(Isotropic diﬀuse γ-ray Background), EGB presents the
total extragalactic gamma-ray ﬂux, from which about
half is given by the resolved individual sources. In the
cascade calculations we use these ﬂuxes to normalize the
upper limits on the cascade energy density ωcas. The
highest and most conservative upper limit on theoreti-
cal energy density ωcas is imposed by Fermi EGB ﬂux
and is marked as ωtot
In isotropic case the estimate
cas.
of ωiso
cas can be obtained from Fermi IGRB ﬂux [7] as-
suming additionally highly homogeneous distribution of
gamma-ray sources or astrophysical γ-ray generation sce-
narios where Intergalactic Magnetic Field (IGMF) must
be high enough to isotropise the cascade electrons and
positrons (or their parent particles) in the space.

EGB ﬂux is higher than IGRB, and the two calculated
values of ωcas follow this hierarchy. Both ﬂuxes are de-
scribed by power-law spectrum with index γ ≈ 2.3 and
with more steep highest energy tail starting at Ecut =
ǫ ≈ 250 GeV (beginning of the steepening). The nature
of gamma-ray ﬂux above Ecut is not well known, but we
consider it as diﬀuse ﬂux. This high-energy steep com-
ponent (tail) is responsible for stronger upper limit on
ωcas in comparison with earlier paper [8]. The realistic,
numerically calculated, spectra in Fig. 8 are ﬂatter than
the highest-energy Fermi tail and can intersect it at some
energy (see section III B).

A. Upper limit on ωcas in analytic calculations

To illustrate our method of calculating ωcas we will
consider ﬁrst a simple example of analytic model followed
then by the accurate numerical calculations.

Consider the energy of Fermi IGRB spectrum cut-
oﬀ ǫ = 2.5 × 105 MeV, where the measured ﬂux is
γ = 4.80 × 10−16cm−2s−1sr−1M eV −1. We use here
J igrb
the analytic dichromatic model with εcmb = 6.3×10−4 eV
and εebl ≈ 1 eV, which provides the high-energy cutoﬀ in
the cascade spectrum Eγ = m2
e/εebl = 2.61 × 105 MeV,
practically the same as observed in Fermi IGRB spec-
trum ǫ = Ecut. We take the cascade spectrum as
Jcas(E) ∝ E−1.9 at EX ≤ E ≤ Eγ and E ∝ E−1.5 at
E ≤ EX . Then the cascade energy density can be calcu-

lated using the cascade ﬂux Jcas(E) as

4π

ωcas =

c  Z EX

0

dEEJcas(E) +Z Eγ

EX

dEEJcas(E)!

(29)
The most restrictive relation we use in calculation of
Eq. (29) is given by the cascade ﬂux in energy interval
EX ≤ E ≤ Eγ

Jcas(E) = Jigrb(ǫ)(E/ǫ)−1.9,

(30)

which includes normalization of the cascade ﬂux by Fermi
IGRB ﬂux Jigrb at energy ǫ = Ecut. This particular
condition provides the low upper limit on ωcas in this
estimate.

For interval E ≤ EX we use

Jcas(E) = Jigrb(ǫ)(EX /ǫ)−1.9(E/EX )−1.5

(31)

As a result we obtain the upper limit on energy density
of cascade radiation

E < ǫγ, and normalization by the observed Fermi LAT
spectrum allows us to obtain the values of ωcas, the ﬁnal
aim of our research in this paper.

17

cas and ωiso

Below we calculate ωtot

cas for two cases: (i)
the redshift-ﬁxed photon-electron sources with very high
energy Es and (ii) redshift-distributed sources with in-
jection rate of photons/electrons Q(Es, z) smoothly de-
pendent on z. The case (i) results in strong universal-
ity and (ii) for general case of z dependence, in weak
universality. The scale of very high energy is given by
Es >
as argued above and as Figs 9a - 9c show, the universal
shape of the spectra is reached already at energy scale
Es ∼ 100 TeV.
Let us now come over to numerical calculation of the
cascade spectra and to evaluation of ωcas. We consider
two cases:

∼ 0.4 PeV for analytic calculations, though

γ >

∼ E cmb

(i) The redshift-ﬁxed and energy-ﬁxed sources with

injection rate

ωcas ≤ 6.6

4π
c

ǫ2Jigrb(ǫ) = 8.3 × 10−8 eV/cm3,

(32)

and

Q(E, z) ∝ δ(z − zs)δ(E − Es),

(33)

to be compared with much larger cascade upper limit
cas = 5.8 × 10−7 eV/cm3 obtained in [8] and used in
ωmax
[9]. The reason is that for normalization of calculated ﬂux
we used the measured ﬂux at energy ǫ = 2.5 × 105 MeV,
which is located below the Fermi E−2.3 approximation of
the ﬂux. However, this argument implies the further de-
crease of ωmax
cas . In more realistic numerical simulations
there is the high-energy tail (see Fig. 8) and intersec-
tion of this tail with steep high-energy Fermi IGRB tail
demands lowering the calculated ﬂux, i.e.
further sup-
pression of ωcas. Another reason of modiﬁcation of cal-
culated spectrum is connected with interpretation of two
highest energy points in the Fermi LAT spectrum above
2.5 × 105 MeV. If these points belong to isotropic diﬀuse
radiation the high-energy theoretical tail must be shifted
downward and it results in lowering of ωcas. However, in
case the weak universality ωcas is not the only parameter
which inﬂuence the ﬂux, it could be that other parame-
ters, e.g. the cosmological evolution of the sources, can
shift the ﬂux upward at the same ωcas.

The stronger upper limit on ωiso

cas obtained here put the
stronger upper limit on the ﬂux of UHE extragalactic
protons and cosmogenic neutrinos, in comparison with
[8–10]. The eﬀect of increasing the fraction of resolved
sources [52] diminishes further Jcas(E) and ωcas given
above.

B. Upper limit on ωcas in numerical simulations

Now we will proceed to consideration of ωcas using the
calculation of the cascade spectra in numerical simula-
tions, kinetic equations and Monte Carlo. These calcula-
tions provide us with the shape of the cascade spectra at

(ii) Redshift-distributed sources with injection rate

Q(E, z) = (1 + z)3+mδ(E − Es), at z < zmax,

(34)

with 1 < zmax < 5 and 0 < m < 5 (the case m = 0 cor-
responds to constant source density in comoving frame).
keep

for both cases we will

In calculations

Es ≥ 100 TeV to provide universality.

The calculated spectra will be normalized by Fermi
LAT spectra, EGB and IGRB. The highest and most con-
servative upper limit on energy density ωcas is imposed
directly by EGB ﬂux, which includes also the ﬂux of re-
solved extragalactic discrete sources. To be even more
conservative we take the ﬂuxes of EGB (and IGRB too)
as maximal one allowed by systematic uncertainties. Us-
ing these two ﬂuxes we obtain the upper limits on ωigrb
cas
and ωegb
cas , the latter will be considered as maximally al-
lowed ωmax.

In case (i) the spectra are shown for three values of zs
in Figs. 9a - 9c. At energies Es higher than 100 TeV all
spectra are the same. Fig. 10 presents the cascade spectra
for continuous source distribution (34), which illustrates
the dependence of the cascade spectra on evolution pa-
rameters m and zmax.

From Fig. 10 one may observe that spectra with low
zmax = 1 have large cutoﬀ-energy Emax and to avoid the
contradiction with Fermi data one must shift the calcu-
lated spectrum downwards, diminishing thus ωcas.

Spectra with large zmax = 5 have lower Emax due to
redshift factor (1 + z) and respectively larger ωcas. De-
pendence on m works in the similar way. Fig. 10 allows
us to calculate ωcas using the corresponding curves. As a
result the constraints on energy density of cascades with
large m and zmax are relaxed.

 1000

 100

 10

 1

]

1
-

r
s

1
-

s

2
-
m
s
 
V
e

[
 

2
E
E

)

(
j

 0.1

E-3/2

E-1.9

]
 

3
m
c
/
V
e

 

7
-

0
1

m=0, Zmax=1
m=2.5, Zmax=1
m=5, Zmax=1
m=0, Zmax=5
m=2.5, Zmax=5
m=5, Zmax=5

[
 

s
a
c

ω

 10

 1

ω

tot
cas

ω

iso
cas

 0.1

 0.01

18

Inoue ’baseline’
Kneiske ’minimal’
Kneiske ’best-fit’

 0.1

 1

 10

zs

(a) sources at ﬁxed z

106 107 108 109 1010 1011 1012 1013 1014 1015

E [eV]

FIG. 10: Cascade spectra for source distribution (34),
with Es = 1 PeV, with various m and zmax, and with
EBL model of Ref. [16]. The spectra are normalized by

Fermi LAT EGB ﬂux (with foreground model B) [7]

]

 10

ω

tot
cas

shown by black errorbars.

We already have seen such eﬀect in section II B for the
case of analytic solution with the sharp high-energy cut-
oﬀ, which starts at low energy (see Fig. 8) Now we can
generalize the both cases formulating what will be called
“Emax rule” used here and below. It reads: Increasing
Emax in the calculated cascade spectrum suppresses ωcas.
Indeed, Fig. 10 shows that increasing Emax needs lower-
ing the total curve J(E) to avoid the excess of predicted
ﬂux J(E) over the observed Fermi ﬂux. For changing
Emax one may use, for example, the cosmological evolu-
tion: increasing zmax results in decreasing Emax at z = 0
by factor (1 + z).

Another feature observed in Fig. 10 is the standard en-
ergy spectra ∝ E−1.5 transforming to ∝ E−1.9 at higher
energy (see these curves in the ﬁgure).
In Fig. 11 we present the maximum cascade energy
cas consistent with Fermi IGRB ﬂux and ωtot
density ωiso
cas
consistent with Fermi EGB ﬂux [7] for two cases of source
distribution (33) and (34). To obtain these quantities we
normalize the cascade spectrum calculated in numerical
simulations by IGRB or EGB ﬂuxes [7].

In the panel (a) we show the energy density ωtot
cas and
ωiso
cas calculated in the model with ﬁxed redshift of the
source zs and with ﬁxed energy Es of primary pho-
ton/electron. This is the case of strong universality, when
the cascade spectrum is determined by single parameter
ωcas. Uncertainties, caused by diﬀerent EBL models are
not large, and values of ωtot
cas, as ex-
pected. The values of ωcas(z) at large z exceeds that at
small z according to Emax rule: large z gives small Emax,
small Emax results in large ﬂux, and hence in large ωcas.
One can see this eﬀect in Fig. 11a.

cas are larger than ωiso

In Fig. 11b the case of more realistic continuous z-
distribution, as given by Eq.(34), is presented. It is de-

3
m
c
/
V
e

7
-

0
1

[
 

s
a
c

ω

 1

 0.1

ω

iso
cas

 1

 2

 3

zmax

m=0
m=2.5
m=5

 4

 5

(b) sources distributed in z

FIG. 11: Upper limits on the cascade energy density
ωcas obtained for source distribution with ﬁxed zs,

Eq. (33 (panel a), and with continuous zs distribution,

Eq. 34 (panel b). The total upper limits ωtot
cas are
obtained using Fermi EGB ﬂux (dashed lines) and

isotropic upper limits ωiso
cas - using Fermi IGRB ﬂux (full
lines). The various EBL models are used in simulations
shown in panel (a): Ref. [37] (red lines), Ref. [16] (blue
lines), and Ref. [17] (green lines). In the lower panel (b)

EBL model of Ref. [37] is used.

scribed by weak universality, when cascade spectrum de-
pends. apart from ωcas, on other parameters, in particu-
lar on parameters of cosmological evolution m and zmax.
The low z and large z regimes exist here, too, being pro-
vided by Emax rule.

The lowest ωiso

cas = 4 × 10−8 eV/cm3, is obtained for
zmax <
∼ 1 and for absence of evolution m = 0. It is an or-
der of magnitude lower than the limit 5.8×10−7 eV/cm3
found in [8] for the secondary photons produced during
propagation of UHECR. The limit appears very restric-
tive for ﬂuxes of protons in UHECR and cosmogenic neu-

trinos produced at zmax <
m = 0.

∼ 1 and in absence of evolution
Non-evolutionary models with m=0 and zmax >
∼ 2 have
ωiso
cas ≤ 8 × 10−8 eV/cm3 (see Fig. 11 panel b) which al-
lows some of non-evolutionary UHECR proton models
from Table 1 of [36]. The models with strong evolution
m = 5 and zmax >
cas ≈ 8× 10−7 eV/cm3
favourable for UHECR proton models with strong evolu-
tion and large zmax.

∼ 2 allows large ωiso

The smallness of ωcas produced in cosmic ray models
in comparison with ωiso
cas measured by Fermi LAT is not
the only criterion for successful cosmic ray model.
It
must satisfy another more sensitive criterion: not to ex-
ceed the Fermi IGRB ﬂux in the highest-energy bin (in
fact this criterion enters the comparison of energy densi-
ties as integral characteristic). Unfortunately the IGRB
ﬂux estimate in the highest energy bin is strongly model
dependent and suﬀers from low statistics. We have con-
sidered problem of survival of UHECR proton models in
details in the separate work with emphasizing the role
of the highest energy bin (in preparation). This problem
was already studied in the works [8–10] and most recently
in diﬀerent approach in Ref. [49].

The above analysis is based on EGB and IGRB ﬂuxes
derived using 50 months of Fermi-LAT observation [7].
The two recent catalogs of observations which appear
later [50] and [51] probably will change further our re-
sults. These catalogs are based on the new program of
analysis, Pass 8, with the improved reconstruction and
classiﬁcation of events, and with the time of observation
increased to 6 years. The analysis of the work [52] shows
that the considerable fraction of high energy events above
50 GeV can be attributed to unresolved sources most of
which are blazars. For EGB ﬂux, contribution of blazars
according to this work reaches 86+16
−14%. This implies a
stronger bound on the true isotropic ﬂux. This eﬀect can
be roughly described by inequality

ω′iso
cas <

∼ 0.28ωtot

cas

(35)

VI. SUMMARY

Using both analytic approach and numerical simu-
lations we have described the development of electro-
magnetic cascades in the universe in presence of CMB
and EBL background radiations. The cascades develop
due to IC scattering on most numerous CMB photons
e + γcmb → e′ + γ ′ and pair-production on less numerous
EBL photons γ + γebl → e−e+. A primary particle below
is called photon, though electron is implied under this
name, too.

For analytic calculations we use dichromatic model
with ﬁxed energy of CMB photons εcmb = 6.3 × 10−4 eV
and EBL photons with εebl = 0.68 eV. In the cascade
photon spectrum there are two characteristic energies:
absorption energy E ebl
e/εebl and Inverse Compton
energy of a photon EX = (1/3)(Eγ/me)2εcmb, produced

γ ∼ m2

by a born electron/positron in γ + γebl collision. Thus in
analytic dichromatic model we have:

19

E ebl
γ =
1
3E ebl

γ

EX =

m2
e
εebl
ǫcmb
ǫebl

= 3.9 × 1011 eV
= 1.2 × 108 eV.

(36)

γ

∼ E <

The cascade initiated at large distance by very high en-
ergy photon/electron has spectrum given by Eq. (9),
which is ∝ E−3/2 in low-energy regime E <
∼ EX , with
∝ E−2 at intermediate energies EX <
∼ Eγ, and with
a high energy cutoﬀ at Eγ, where Eγ numerically can dif-
fer from E ebl
in Eq. (36) due to diﬀerent values of ǫebl.
The numerical simulations conﬁrm the analytic spec-
trum with index γ1 = 3/2 being exact, γ2 = 2 being ap-
proximate (γ2 ≈ 1.9 in numerical simulations) and with
a sharp high-energy cutoﬀ for a source at very large dis-
tance. The artiﬁcially sharp energy transitions in ana-
lytic spectrum at E = EX and E = Eγ. appear in numer-
ical simulations as continuous transition features. This is
most important diﬀerence between analytic solution and
more precise numerical simulation.

γ

The remarkable feature found in both analytic and nu-
merical solutions is universality of the cascade spectrum.
In analytic solution the strong universality is seen explic-
itly from the spectrum given by Eq.(9), where the shape
of the spectrum does not depend on initial energy of the
primary photon at Es > E0, and on distance to observer
r, unless it is too small. The energy scale of universality
is E0 = E cmb
= 0.4 PeV. The energy EX which sepa-
rates two regimes, ∝ E−3/2 and ∝ E−2, and energy of
spectrum cutoﬀ Eγ are build from the main physical con-
stants of the model (see Eq. (5)) and the cascade energy
spectrum does not depend on variables of the model, in
particular on initial energy Es and distance to the source
r. The main features of this universality, speciﬁc for an-
alytic model developed in section II A, are: (i) the same
energy shape of the cascades produced by primary pho-
ton/electron if its energy Es is larger than universality
scale E0, (ii) the same cascade energy spectrum for any
injection spectrum Q(E) at E ≥ E0 (in other words cas-
cade spectrum forgets what injection spectrum produced
it), (iii) indepedence of spectrum shape from distance to
the point where cascade started, and (iv) energy density
of the cascade ωcas as the only cascade parameter which
determines the spectrum shape.

These properties of ’analytic’ cascades are referred to

as strong universality.

For realistic cascades in the expanding universe, prop-
erty (i) is modiﬁed as follows: cascades initiated at the
ﬁxed redshift z by photon/electron with suﬃciently high
energy Es > E0 turn at z = 0 into cascades with spec-
trum independent of Es but dependent on z. These spec-
tra are calculated by numerical simulation. Property (ii)
remains almost the same: cascade spectra initiated at
the same z with diﬀerent injection spectra Q(E) are al-
most identical. However, if injection spectrum Q(E, z)

smoothly changes with z the total diﬀuse spectrum ob-
tained by integration over z is not universal; the spectra
are diﬀerent for diﬀerent dependence of Q(E, z) on z.
The diﬀuse spectra for various Q(E, z) are determined in
this case not only by ωcas but also by other parameters
from Q(E, z) distribution.

We refer to the case described above as weak universal-
ity. Some of the described properties of these cascades,
studied in numerical simulations are shown in Fig. 9.

The main aim of this paper is to obtain the upper
limit on the cascade energy density ωcas using the Fermi
LAT ﬂux of gamma radiation.
In the analytic model
with strong universality, there is the direct and trans-
parent method which allows us to obtain strong enough
upper limit on the cascade energy density. This up-
per limit follows from Eq. (29) and results in ωcas ≤
8.3 × 10−8eV /cm3. The speciﬁc property of this limit is
the high-energy cutoﬀ, i.e. Emax, given by Eγ = m2
e/εebl,
which at εebl ∼ 1 eV coincides with cutoﬀ energy in
Fermi IGRB spectrum. The limit is stronger if the model-
dependent Emax = Eγ is higher.
Even more stronger upper limit is obtained comparing
the numerical calculations of the cascade energy shape
with the Fermi measured spectrum, due to its high-
energy tail. If the calculated spectrum crosses the steep
high-energy Fermi tail at Ecross, the calculated ﬂux above
Ecross exceeds the observations. To eliminate this con-
tradiction one must lower the total calculated spectrum
decreasing ωcas, and thus we arrive at “Emax-rule” for-
mulated in subsection V B as: “Increasing Emax in the
calculated spectrum suppresses further ωcas.”

In particular, Emax-rule works eﬃciently in evolution-
ary (1 + z)m models with large m and large zmax. Since
the ﬂux in these models is dominated by production
at zmax, the maximum energy Emax at z = 0 becomes
(1 + zmax) times less and respectively ωcas is allowed to
be higher, as one observes in Fig. 11b.

We describe now the obtained limits on ωcas in some

details.

Fermi LAT presented two kinds of measured ex-
tragalactic ﬂuxes: the total Extragalactic Background
ﬂux (EGB) and Isotropic Gamma Ray Background ﬂux
(IGRB). The corresponding energy densities obtained,
using EGB and IGRB as the upper limits, are ωtot
cas and
ωiso
cas, respectively, the former being always larger. Both
ﬂuxes, EGR and IGRB, have systematic and statistical
uncertainties, and are to some extent model dependent
(e.g.
foreground models). To be conservative we use
maximal ﬂuxes allowed within these uncertainties.

The both spectra, EGR and IGRB, have steepening,
which starts at Ecut = 250 GeV and at higher energies
become steeper. The method of ωcas calculation is mainly

20

based on this steep high energy feature.

The shape of the cascade spectrum is accurately cal-
culated using kinetic equations and MC methods. As
these calculations show, Emax in the cascade spectrum
at z = 0 becomes smaller at larger zs of cascade produc-
tion. Since ﬂux of EGR/IGRB is J(E) ∝ E−3.2, small
Emax results in larger ﬂux J(Emax), i.e.
in larger ωcas.
In other words ωcas is rising with increasing zs as we see
indeed in Fig.11a.

Fig. 11a show the case of ﬁxed zs, when strong uni-
versality holds and thus ωcas value is unique for each
zs. As expected ωtot
cas. For small dis-
tances zs < 0.1 cascades are underdeveloped and ωcas are
∼ (2 − 3) × 10−8eV /cm3. At large zs >
∼ 1
small:
∼ (5 − 8) × 10−7eV /cm3.
energy density is larger: ωiso
These results depend weakly on models of EBL.

cas is larger than ωiso

cas <
ωiso

cas >

The strong dependence of ωcas on redshift zs in Fig. 11a
implies dependence of energy density on source distribu-
tion over z, seen in Fig. 11b. One may observe there an
increase of ωcas with zmax up to zmax ∼ 1, with the con-
stant value at larger zmax. This constant value depends
on cosmological evolution (1 + z)m. One may summa-
rize the values of ωiso
cas as 5 × 10−8eV /cm3 in the case
of absence of cosmological evolution m = 0 and up to
9 × 10−7eV /cm3 in case of strong cosmological evolution
m = 5.

The large ωmax

cas allowed in case of strong evolution with
large zmax is explained by diminishing of Emax by factor
(1 + z) in the cascade spectrum at z = 0.

The ﬁrst results of Fermi LAT [6] demonstrated [8–10]
that cascade energy density ωcas ≈ 5.8× 10−7eV /cm3 ex-
cludes some proton models of UHECR and cosmogenic
neutrinos. However, some models survived. The new
data of Fermi LAT [7] discovered the steep energy fea-
ture in the end of the spectrum which further constraints
the cascade energy density. The new limit is model-
dependent. For models with strong universality of cas-
cade spectrum the limits on ωcas became stronger and
restrictions on UHECR became more severe. However,
for the models with weak universality the restrictions re-
laxed. In particular, the evolutionary models with strong
evolution and large zmax the energy density can be larger
than 6 × 10−7 eV /cm3 , i.e. larger than previous limit.
Acknowledgments—Numerical calculations have been
performed at the computer cluster of the Theoretical
Physics Division of the Institute for Nuclear Research of
the Russian Academy of Sciences with support by the
Russian Science Foundation, grant 14-12-01340. OK is
grateful to GSSI and LNGS for hospitality.

[1] A. A. Penzias, R. W. Wilson Ap. J. 142, 419 (1965).
[2] K. Greisen, Phys. Rev. Lett. 16, 748 (1966); G. T. Zat-

sepin and V. A. Kuzmin, XCyJETP Lett. 4, 78 (1966)
[Pisma Zh. Eksp. Teor. Fiz. 4, 114 (1966)].

[3] V. S. Beresinsky and G. T. Zatsepin, Phys. Lett. B 28,

Not. R. Astro. Soc. 445, L41 (2014).

423 (1969); Sov. J. Nucl. Phys. 11, 111 (1970).

[31] W. Chen, B. D. Chowdhury, F. Ferrer, H. Tashiro,

[4] V. S. Berezinsky and A. Yu. Smirnov, Astrophys. Sp. Sci.

T. Vachaspati, arXiv:1412.3171 [astro-ph.CO].

21

32 461 (1975).

[5] P. Sreekumar et al., Ap. J.,494, 523 (1998).
[6] A.A.Abdo et al Fermi-LAT Collaboration, Phys Rev

Lett. 104. 101101 (2010).

[7] M. Ackermann et al. [Fermi-LAT Collaboration], Astro-
phys. J. 799, no. 1, 86 (2015) [arXiv:1410.3696 [astro-
ph.HE]].

[8] V.

Berezinsky,

S. Ostapchenko, Phys. Lett. B 695,
arXiv:1003.1496 .

A. Gazizov, M. Kachelrieß,
13 (2011),

[9] M. Ahlers, L.A. Anchordoqui, M.C. Gonzalez-Garcia,
F. Halzen, S. Sarkar. Astropart. Phys. 34, 106 (2010),
arXiv:1005.2620

[10] G.B. Gelmini, O. Kalashev, D.V. Semikoz, JCAP 1201,

044 (2012), arXiv:1107.1672

[11] O. F. Prilutsky, PhD thesis from Moscow Engineering

Institute, 1972.

[32] V. Berezinsky, Yad. Fiz. 11, 399 (1970).
[33] G. R. Blumenthal and R. J. Gould, Reviews of Modern

Physics 41, 237 (1970).

[34] V. S. Berezinsky, S. V. Bulanov, V. A . Dogiel,
V. L. Ginzburg and V. S. Ptuskin, Astrophysics of
Cosmic Rays (Elsevier, Amsterdam (1990), originally in
Russian, Nauka (1984).

[35] M. Kachelriess, S. Ostapchenko and R. Tomas, Com-
put. Phys. Commun. 183, 1036 (2012) [arXiv:1106.5508
[astro-ph.HE]].

[36] V.

Berezinsky,

A. Gazizov, M. Kachelrieß,

S. Ostapchenko, Phys. Lett. B 695, 13 (2011).

[37] Y. Inoue et al., arXiv:1212.1683.
[38] O. K. Kalashev, PhD thesis, Institute for Nuclear Re-

search RAS, Moscow 2003.
O. E. Kalashev and E. Kido, arXiv:1406.0735 [astro-
ph.HE].

[12] A. W. Strong, A. W. Wolfendale, J. Wdowczyk, Nature

[39] G. B. Gelmini, O. Kalashev and D. V. Semikoz, JCAP

241, 109 (1973).

1201, 044 (2012).

[13] R. J. Gould and D. Schreder, Phys. ReV. Lett. 16, 252

[40] S.

Lee,

Phys. Rev. D 58,

043004

(1998)

(1966).

[14] V. S. Berezinsky, Soviet Physics: Nuclear Physics 11,
399 (1970) (preprint P.N. Lebedev Institute of Physics,
May 1969).

[15] F. A. Aharonian, P. S. Copi, H. J. V¨olk, Ap. J. Lett 423,

L5 (1994).

[16] T. M. Kneiske et al., Astron. Astrophys. 386(2002) 1;

ibid., 413 (2004) 807.

[17] T. M. Kneiske and H. Dole, arXiv:1001.2132 [astro-

ph.CO].

[18] A. Neronov, D. V. Semikoz, JETP Letters 85, 579 (2007),

arXiv:astro-ph/0604607.

[19] P. P. Kronberg, Reports Progress Physics 57, 325 (1994).
[20] D. Grasso, H. R. Rubinstein, Phys. Rep. 348, 163,

(2001).

[21] R. M. Kulsrud, E. G. Zweibel, Reports in Progress of

Physics 71(4) 046,901 (2008). 0707.2783

[22] R. Durrer and A. Neronov, Astron. Astrophys. Rev. 21,

62 (2013) [arXiv:1303.7121 [astro-ph.CO]].
[23] L. Biermann, Z.Naturforsch. 5a, 65 (1950)
[24] L. Mestel, D. ,L. Moss,
[25] M. V. Medvedev, A. Loeb, Ap.J. 526, 697 (1999).
[26] F. Miniati, A. R. Bell, Ap.J. 729, 73 (2011).
V.
[27] A.

Neronov,

Elyiv,

D.

A.

Semikoz.

arXiv:0903.3649[astro-ph.CO]

[28] A. Neronov, L. Vovk. Science, 328, 73 - 75 (2010),

arXiv:1006.3504 [astro-phHE].

[29] A. M. Taylor, I. Vovk and A. Neronov, Astron. Astro-
phys. 529, A144 (2011) [arXiv:1101.0932 [astro-ph.HE]].
[30] H. Tashiro, W. Chen, F. Ferrer, T. Vachaspati, Month.

[astro-ph/9604098].

[41] S. Yoshida, G. Sigl and S. -j. Lee, Phys. Rev. Lett. 81,

5505 (1998) [hep-ph/9808324].

[42] J. R. Primack, R. C. Gilmore and R. S. Somerville, AIP
Conf. Proc. 1085, 71 (2009); J. D. Finke, S. Razzaque
and C. D. Dermer, Astrophys. J. 712, 238 (2010).

[43] A. Franceschini, G. Rodighiero and M. Vaccari, Astron.
Astrophys. 487, 837 (2008) [arXiv:0805.1841 [astro-ph]].
[44] F. W. Stecker, M. A. Malkan and S. T. Scully, Astrophys.

J. 648, 774 (2006).

[45] F. W. Stecker, M. A. Malkan and S. T. Scully, Astro-
phys. J. 761, 128 (2012). S. T. Scully, M. A. Malkan and
F. W. Stecker, arXiv:1401.4435 [astro-ph.HE].

[46] W. Essey, O. Kalashev, A. Kusenko and J. F. Beacom,

Astrophys. J. 731, 51 (2011).

[47] A. A. Abdo et al. Astrophys. J. 723, 1082 (2010).
[48] For a standard textbook discussion, see J. D. Jackson,
Classical Electrodynamics, 2nd Ed. (John Wiley & Sons,
New York, 1975).

[49] R. Y. Liu, A. M. Taylor, X. Y. Wang and F. A. Aharo-

nian, arXiv:1603.03223 [astro-ph.HE].
[Fermi-LAT

Acero

al.

et

[50] F.

Collaboration],

arXiv:1501.02003 [astro-ph.HE].

[51] M. Ackermann et al. [Fermi-LAT Collaboration], Astro-
phys. J. Suppl. 222, no. 1, 5 (2016) doi:10.3847/0067-
0049/222/1/5 [arXiv:1508.04449 [astro-ph.HE]].

[52] M.

Di

Mauro

[Fermi-LAT

Collaboration],

arXiv:1601.04323 [astro-ph.HE].

