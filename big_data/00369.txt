6
1
0
2

 
r
a

M
1

 

 
 
]
S
D
h
t
a
m

.

[
 
 

1
v
9
6
3
0
0

.

3
0
6
1
:
v
i
X
r
a

REALIZING NONHOLONOMIC DYNAMICS

AS LIMIT OF FRICTION FORCES

JAAP ELDERING

Abstract. The classical question whether nonholonomic dynamics is realized as limit
of friction forces was ﬁrst posed by Carath´eodory. It is known that, indeed, when friction
forces are scaled to inﬁnity, then nonholonomic dynamics is obtained as a singular limit.
Our results are twofold. First, we formulate the problem in a diﬀerential geomet-
ric context. Using modern geometric singular perturbation theory in our proof, we
then obtain a sharp statement on the convergence of solutions on inﬁnite time intervals.
Secondly, we set up an explicit scheme to approximate systems with large friction by a
perturbation of the nonholonomic dynamics. The theory is illustrated in detail by study-
ing analytically and numerically the Chaplygin sleigh as example. This approximation
scheme oﬀers a reduction in dimension and has potential use in applications.

1. Introduction

Nonholonomic dynamics is a classical subject in mechanics that has seen an increase
of activity in the last decades with people studying conserved quantities, symmetries and
integrability, numerical integrators, as well as various toy problems with intricate behavior
— the rattleback and tippe top being the most famous ones — and has many applications
in engineering sciences such as robotics, see e.g. [dL12, Blo03].

We consider the fundamental question whether nonholonomic dynamics is realized as
the idealization, or limit, of large friction forces. Our main results are twofold. First, we
reprove previous results by Brendelev [Bre81] and Karapetian [Kar81] that answer the
question in the aﬃrmative, but we treat the problem in a diﬀerential geometric setting,
see Theorem 3. Our use of geometric singular perturbation theory provides an improved
statement on the convergence of solution curves on inﬁnite time intervals. The examples
in Section 3 show that our result in general is sharp. Secondly, we obtain an approxima-
tion scheme for the large friction dynamics by an expansion in the singular perturbation
parameter. This allows modeling this non-ideal, large friction dynamics on the reduced
nonholonomic phase space with a modiﬁcation term added to the nonholonomic system.
This has potential applications for simpliﬁed modeling of systems where some slippage
occurs, e.g. in explaining tippe top inversion [BRMR08] as well as in engineering sciences,
such as control of robots or submerged vehicles where slipping/drift may become impor-
tant, see e.g. [SS08, FGN10]. As an example, we apply this approximation scheme to the
Chaplygin sleigh, see Section 7.1 and Figures 7 and 8.

1.1. Realizing constraints as idealizations. Constraints in mechanical dynamical sys-
tems should often be seen as simplifying idealizations of more intricate underlying models.
Examples are ubiquitous. A pendulum can be modeled as a point mass moving on a circle
— or a sphere in 3D — under gravity, but in physical reality, the constraint of staying on
the circle is only approximately realized by a very stiﬀ rod that connects the mass to the
point of suspension. A rigid body can be considered an approximation of a large number
of atoms, or as a continuous medium with a strong interaction potential that keeps the

Date: March 2, 2016.

1

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

2

body rigid. Finally, a smooth, convex body rolling on a surface without slipping, or a ﬁg-
ure skater sliding without sideways movement are examples of the idealization of friction
forces, and modeled by nonholonomic mechanics.

The examples above show how both holonomically and nonholonomically constrained
systems can be considered idealizations of larger, unconstrained systems under strong
potentials or friction forces. On the other hand, the dynamics for constrained systems is
conventionally postulated to be given by Lagrange’s variational principle (which is equiv-
alent to Newton’s laws in the unconstrained case) together with d’Alembert’s principle
that reaction forces do no work along virtual displacements that satisfy the constraints.
Thus, a natural question is whether these two diﬀerent viewpoints yield corresponding
and experimentally correct equations of motion for a given system.

In this paper we revisit the question whether friction forces can realize nonholonomi-
cally1 constrained systems. That is, when we consider a mechanical system with friction
forces acting in only some of the directions and then scale this friction to inﬁnity, do we
recover nonholonomic dynamics in an appropriate limiting sense? This question dates
back at least to Carath´eodory, who considered it for the Chaplygin sleigh [Car33], see
Section 1.2 below for a brief history.

A second, related question is whether indeed the Lagrange–d’Alembert principle for
nonholonomic dynamics is ‘correct’. The relevance of this question is indicated by the
confusion in the late 19th century about the correct formulation of nonholonomic dy-
namics, see [CD´S10, p. 46–47] and [Mar98, Sec. 3.2.3] for a discussion. An alternative
method to obtain equations of motion for nonholonomically constrained systems, called
‘vakonomic mechanics’, was proposed by Kozlov [Koz83]. This method produces diﬀerent
dynamics2, hence raises the question which method is ‘correct’. The quotes are used since
such questions ultimately have to be decided by physical experiment, and the answer
may depend on the kind of system studied. For rolling mechanical systems the general
consensus seems to be that the d’Alembert principle is correct. Indeed, Lewis and Murray
veriﬁed experimentally that for a ball rolling on a turntable, nonholonomic dynamics gives
a better description than vakonomic mechanics [LM95]. On the other hand vakonomic
dynamics, satisfying a variational principle, is applicable in control theory and the mo-
tion of rigid bodies in ﬂuids [Koz82a, Koz82b] as cited in [FGN10]. Alternative methods
to realize nonholonomic dynamics besides friction have been proposed too. Bloch and
Rojo [BR08] (see also [Blo10]) used coupling to an external ﬁeld to obtain nonholonomic
dynamics3, while Ruina [Rui98] shows that mechanical systems with intermittent contact,
i.e. with piecewise holonomic constraints, can be viewed as nonholonomic systems in the
limit as the contact switches more frequently.

Although these ‘correctness’ questions should be decided by experiment, the idea of
trying to realize constraint dynamics from the unconstrained system using an underlying
principle can oﬀer theoretical insights. For example, whereas nonholonomic dynamics
based on d’Alembert’s principle can be viewed as a limit of friction forces, vakonomic
mechanics can be viewed as letting the mass in the mechanical metric go to inﬁnity along
constrained directions [Koz83]. See also [Koz92] for a discussion of various methods to

1The realization of holonomic constraints by strong potentials has been studied in [RU57, Tak80, KN90]
and other papers. In that case the limit is somewhat subtle, and depends on the energy in oscillatory
modes normal to the constrained manifold.

2Vershik and Gershkovich showed that in a generic system with nonholonomic constraints the vako-

nomic and Lagrange–d’Alembert solutions are incompatible [VG88, Sec. 4.3].

3Although the nonholonomic system appears as a slow manifold of this inﬁnite-dimensional coupled
system, the third line in [BR08, Eq. (9)] seem to indicate that the fast dynamics of θ around α(x, t) is
oscillatory, i.e. the normal directions are elliptic. Thus, convergence of the limit dynamics is not clear to
me.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

3

realize constraints in dynamics and [BKM+15, Sec. 0.3] for a review of the applicability
of nonholonomic dynamics to sliding and rolling bodies.

Showing that a fundamental principle such as friction — or large mass terms in the
vakonomic principle — can realize the constrained system provides a fundamental jus-
tiﬁcation for the constrained equations of motion as an idealized limit. But conversely,
given constrained equations of motion it also allows one to study under precisely which
conditions the underlying principle leads to this realization. For example, in case of
friction realizing nonholonomic dynamics:
instead of linear (viscous) friction forces, do
Coulomb-like forces also realize nonholonomic dynamics? In [Koz10] this is considered
for the speciﬁc case of a homogeneous rolling ball. Finally, when the limit is suﬃciently
well-behaved, e.g. in case of linear friction, one can moreover calculate correction terms
to the idealized dynamics. For the friction limit, these represent the eﬀect of large, but
ﬁnite friction forces, see Section 7.

1.2. A brief historic overview. To our knowledge, Carath´eodory [Car33] ﬁrst explic-
itly addressed the question whether friction forces can realize nonholonomic dynamics,
although his starting sentence that “nonholonomic motion in mechanics is known to be
caused by friction forces” indicates that the idea is older. His study of the Chaplygin sleigh
(without attributing it to Chaplygin [Cha11]) includes a complete solution in quadratures
and ﬁnally addresses whether the dynamics can be realized by a viscous friction force.
Carath´eodory’s conclusion is negative, but this is due to an error in his reasoning as dis-
cussed thoroughly in [NF72, p. 233–237]. That is, Carath´eodory ﬁxes initial conditions
for the velocity perpendicular to the skate blade, but these are not on the slow manifold
associated to the nonholonomic dynamics. See also the exposition in Section 4, but note
that compared to [Car33, NF72] we retain v, the velocity perpendicular to the sleigh’s
skate blade, instead of rewriting it into a second-order equation for ω, the angular velocity
of the sleigh.

The realization of nonholonomic constraints by friction forces was independently shown
by Brendelev [Bre81] and Karapetian [Kar81]. They proved that indeed an unconstrained
system with viscous friction forces added to it will in the limit converge to the nonholo-
nomic system whose constraint distribution is deﬁned by the friction forces being zero on
it. The limit is understood to be in the sense that solution curves of the unconstrained
system converge to solutions of the nonholonomically constrained system, uniformly on
each bounded time interval [t0, T ] with 0 < t0 < T , as the friction is scaled to inﬁnity.
Both authors used Tikhonov’s theorem [Tih52] for singularly perturbed systems to obtain
this result in a local coordinate setting. Kozlov combined this friction limit into a larger
framework including both friction and inertial terms, obtaining both nonholonomic and
vakonomic dynamics as limits in special cases [Koz92].

1.3. Outline and contributions of the paper. After the introduction, we ﬁrst brieﬂy
review nonholonomic dynamics according to the Lagrange–d’Alembert principle. In Sec-
tion 3 we show how diﬀerent approaches of using potentials or friction to realize the
same constrained system, yield qualitatively diﬀerent solutions, arbitrarily close to their
respective limits. Then we start with the main part of the paper and present how friction
forces realize nonholonomic dynamics. First with the Chaplygin sleigh as example. In
Section 4 we derive its equations of motion as a nonholonomic system and in Section 5 as
an unconstrained system, but with friction added. Secondly we treat the general theory
in Section 6. We show how the Lagrange–d’Alembert equations are recovered as a limit,
using modern geometric singular perturbation theory. In keeping the exposition clear, we
shall not try to attain the utmost generality. That is, we restrict to Lagrangian systems
of mechanical type and consider only time-independent, linear friction forces. This means

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

4

that we only recover linear nonholonomic constraints4. Instead, we shall present various
simple examples to illustrate some of the issues discussed above.

The ﬁrst aim of this paper is to provide an accessible exposition of the problem of
realizing nonholonomically constrained systems as a limit of inﬁnite friction forces, using
the Chaplygin sleigh as a canonical example. Secondly, we present the problem in a more
geometric setting than [Bre81, Kar81]. That is, we express the problem in a diﬀerential
geometric formulation and use geometric singular perturbation theory, as developed by
Fenichel [Fen79] and based on the theory of normally hyperbolic invariant manifolds
(abbreviated as nhim), see e.g. [Fen72, HPS77, Eld13]. This allows us to phrase the results
independent from coordinate charts and provide improvements on the results obtained
in [Bre81, Kar81]; in particular, we can describe more precisely in what sense the solutions
curves converge on positively unbounded time intervals. Moreover, persistence of the nhim
allows us to rigorously study a perturbation expansion of the nonholonomic system away
from the inﬁnite friction limit and obtain corrections to the nonholonomic dynamics as
an expansion for small ε > 0, where 1/ε is the scale-factor multiplying the friction forces.
This can be used to describe systems with large, but ﬁnite friction forces as nonholonomic
systems with small correction terms. We derive general formulas for this expansion and
illustrate their use with an analytical and numerical study of the approximation of the
Chaplygin sleigh with large friction in Section 7.1. Eﬀorts towards obtaining such a
general expansion were made in [WH96], which studies ‘creep dynamics’ for a few example
systems. For the Chaplygin sleigh they ﬁnd the same ﬁrst order correction term (our h(1))
to the invariant manifold Dε, but their modiﬁed equations of motion are not speciﬁed.

2. Nonholonomic dynamics

Let us here brieﬂy recall the Lagrange–d’Alembert formalism for nonholonomic dy-
namics and establish notation. A Lagrangian system is given by a Lagrangian function
L : TQ → R, where Q is an n-dimensional smooth manifold. We shall assume that the
Lagrangian is of mechanical type, i.e. of the form
κq( ˙q, ˙q) − V (q),

(q, ˙q) ∈ TQ,

L(q, ˙q) =

(1)

1
2

where 1
2κq( ˙q, ˙q) is the kinetic energy, which is given by a Riemannian metric κ on Q,
and V : Q → R is the potential energy. This implies that L is hyperregular and that the
Euler–Lagrange equations of motion have unique solutions. Let q be local coordinates on
Q and let (q, ˙q) denote induced coordinates on TQ. Then the Euler–Lagrange equations
are given by5

(2)

[L]i :=

d
dt

∂L

∂ ˙qi − ∂L

∂qi = 0.

A linear nonholonomic constraint is imposed on this system by specifying a regular
distribution, i.e. a smooth, constant rank k vector subbundle, D ⊂ TQ. Kinematically,
this constraint speciﬁes the allowed velocities of the system, that is, a velocity vector
˙q ∈ TqQ is allowed precisely if ˙q ∈ Dq.

To specify the nonholonomic dynamics with this constraint, an extra principle has to
be imposed, as solutions of (2) would generally violate the kinematic constraint imposed
by D. To guarantee that the solutions satisfy the constraint, we add a constraint reaction
4Aﬃne constraints do appear naturally, for example, for a ball rolling on a turntable. However,
fully nonlinear constraints in mechanical systems seem scarce: according to [NF72, p. 213,223–233] all
known examples are variations of the one due to Appell [App11]. See also [Mar98] for a discussion of
nonholonomic constraint principles, including nonlinear constraints.
jets of curves in Q, to T∗Q, covering the identity map on Q.

5Note that [L] := [L]i dqi can intrinsically be viewed as a map from J 2

0 (R; Q), the space of second-order

[L](cid:0)¨c(t)(cid:1) ∈ D0

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

5

force Fc to the right-hand side of (2) according to d’Alembert’s principle, see e.g. [CD´S10,
p. 4–6].

Hypothesis 1 (d’Alembert’s principle). The constraint forces Fc do no work along move-
ments that are compatible with the constraints. That is, for any (q, ˙q) ∈ D we have that
Fc(q, ˙q) · ˙q = 0.

From now on we shall implicitly assume this principle for nonholonomically constrained
systems. This leads to the Lagrange–d’Alembert equations, which again have unique
solutions. Abstractly, these state that a smooth curve c : (t0, t1) → Q is a solution of the
equations if for all t ∈ (t0, t1)

˙c(t) ∈ D.

(3)
Here D0 ⊂ T∗Q denotes the annihilator of D, that is, all covectors α ∈ T∗Q such that
α( ˙q) = 0 for any ˙q ∈ Dπ(α).
i.e. D = {(q, ˙q) ∈ TQ | ∀a ∈ [1, n− k] : ζ a
equations in local coordinates are of the form

Let D locally be given by a set of n−k independent constraint one-forms ζ a = C a

i (q) dqi,
q ( ˙q) = 0}. Then the Lagrange–d’Alembert

and

d
dt

∂L

∂ ˙qi − ∂L

∂qi = λa C a

i (q)

and

ζ a
q ( ˙q) = 0,

(4)

where λa are Lagrange multipliers that have to be solved for, and the constraint force is
given by Fc = λa ζ a.

3. An example of different constraint realizations

The following toy example illustrates how diﬀerent choices for realizing the same con-
strained system lead to qualitatively diﬀerent dynamics close to the limit. These quali-
tative diﬀerences are essentially due to the fact that the limits of sending time to inﬁnity
or a singular perturbation parameter to zero do not commute. A nice illustration of this
simple fact is given by Arnold [Arn78, p. 65]. Consider a bucket of water with a hole of
size ε in the bottom. After any ﬁxed, ﬁnite time t the water level remains unchanged as
ε → 0, but for any ε > 0 the bucket becomes empty as t → ∞.

We consider the mathematical pendulum in the vertical plane. We view it as a system
constrained to the circle in a holonomic, nonholonomic and vakonomic sense. That is, we
view the constraint as generated by a strong potential, strong friction forces and large
inertia, and compare the dynamics when the respective constraining terms are large but
ﬁnite.

The unconstrained system is given by the Lagrangian

L(x, y, ˙x, ˙y) =

( ˙x2 + ˙y2) − g y

(5)

1
2

(cid:112)

on TR2, where g is the gravitational acceleration and a unit mass has been chosen.

Viewing the pendulum as a mass attached to the origin by a perfectly stiﬀ rod, we can

choose as constraining potential

1
2ε

x2 + y2 − 1)2,

(

Vε(x, y) =

(6)
that is, the square distance from the constrained submanifold S1 ⊂ R2, modeling a
perfectly stiﬀ rod as ε → 0. We can now easily apply the results from [Tak80] as S1 is a
codimension one manifold and the constraining potential has constant second derivative
in the normal direction. It follows that the limit motion is precisely given by the standard
pendulum on S1. Energy conservation also makes it immediately clear that for small ε,
solutions stay close to the constraint manifold S1. See the top image in Figure 1.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

6

Secondly, the constrained system can be obtained from a ‘nonholonomic’ limit of adding
friction forces in the radial direction. This can be thought of as a model for a leaf falling
or ‘swirling down’ under gravity where the leaf surface is tangential to circles around the
origin and there is a large air resistance against perpendicular movement. We model this
air resistance by the friction force deﬁned by the Rayleigh function

(cid:16) x ˙x + y ˙y
(cid:112)x2 + y2

(cid:17)2

Rε(x, y, ˙x, ˙y) =

1
2ε

,

(7)

or Rε = ˙r2/(2ε) in polar coordinates. The friction force is given by F = − ∂R
∂ ˙q . In the
limit of ε → 0 this gives rise to a nonholonomic system whose constraint distribution is
actually integrable; the associated foliation consists of concentric circles. Although the
limit dynamics is the same as with the constraining potential, the dynamics for any ﬁnite
ε > 0 is qualitatively diﬀerent: the leaf will not stay close to the original submanifold S1,
but slowly drift down. This can most easily be seen for a leaf with initial conditions x =
˙x = 0. Under the combined forces of gravity and friction, it will settle to a vertical speed
of ˙y = −ε g. Hence, over long times the constraint manifold S1 is not even approximately
preserved. See the middle image in Figure 1.

Finally, we consider the system as a limit of adding a large inertia term in the radial

(cid:112)x2 + y2

,

direction. That is, we add to the Lagrangian a term
x ˙x + y ˙y

I =

1
(8)
2ε
In the limit of ε → 0 this realizes vakonomic
or in polar coordinates I = ˙r2/(2ε).
dynamics, see [Koz83]. Since the constraint distribution is integrable, the resulting limit
dynamics is equal to the nonholonomic limit with friction and the holonomic limit with
potential forces on S1. The dynamics for ﬁnite ε resembles most closely that of the friction
model, but there is a diﬀerence that can most clearly be observed by considering again
the initial conditions x = ˙x = 0. In this case the equation for y takes the form

(1 +

)¨y = −g.

1
ε

Thus, instead of settling on a slow descend, the particle accelerates downward, but with
a slowed acceleration due to the added inertial term. See the bottom image in Figure 1.
The conclusion is that even though for all three constraint realization methods, solutions
converge on a ﬁxed time interval to the solutions of the constraint system — which in
this case is identical for the three methods — this does not hold true on unbounded time
intervals. Indeed, for these three diﬀerent methods, we see three diﬀerent behaviors when
t → ∞ for ﬁxed ε > 0. With the constraining potential the system stays uniformly6 close
to the initial leaf S1 of the constraint distribution D = { ˙r = 0}. With the friction force,
this is not true anymore, but the solution does stay close to D as a submanifold of TR2.
This is intuitively clear in the current example as friction prevents ˙r from growing large,
and can be proven in general under reasonable conditions, see Section 6. Finally, with the
inertial term, the pendulum example shows that solutions can even diverge arbitrarily far
from D.

6However, solutions do not uniformly in time converge to the constrained solutions. Consider as a
counterexample the pendulum without gravity and an initial velocity along S1:
in the case of a ﬁnite
potential, the particle will oscillate slightly away from S1, hence trade some of its kinetic for potential
energy and thus have on average a lower angular velocity than the perfectly constrained particle. This
builds up over time to arbitrary large errors in position.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

7

Figure 1. Top to bottom: numerical simulations of potential, frictional
and inertial constraint approximations. The particle initially starts on S1
at 45◦ angle and with zero velocity. Its trajectory is shown for 10 seconds
with g = 9.81 and values ε = 0.01 in blue and ε = 0.001 in red.

1.00.50.00.51.01.21.00.80.60.41.00.50.00.51.01.61.41.21.00.80.60.40.21.00.50.00.51.02.01.81.61.41.21.00.80.60.40.2REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

8

4. The Chaplygin sleigh

The Chaplygin sleigh [Cha11] (see [Cha08] for a translation into English) is a simple,
yet interesting example of a mechanical nonholonomic system. The sleigh is a body that
can move on the plane, but one of its contact points is a skate, see Figure 2. Alternatively,
one can think of the contact point as a wheel that is ﬁxed to the body. The contact point
can only move in the direction along the skate blade/wheel, not in the perpendicular
direction. The other two ground contacts can move freely without constraint. The center
of mass is located a distance a away from the skate contact point along the line of the
blade7.

z

y

a

ϕ

x

Figure 2. A Chaplygin sleigh: the left red dot
is the point of contact of the skate, the right red
dot is the center of mass.

An interesting feature of this nonholonomic system is that it exhibits stable and un-
stable relative equilibria, something that cannot occur in purely Hamiltonian systems,
where eigenvalues must always occur in pairs or quadruples symmetric about the real and
imaginary axes.

We shall explicitly recover the equations of motion for this system in the Lagrangian
setting8 and then illustrate in detail its realization through friction.
We describe the system with coordinates (x, y) ∈ R2 for the skate contact point and
ϕ ∈ S1 for the angle of the skate blade with the x axis. Assume that the sleigh has total
mass m and moment of inertia I about the center of mass. To construct the Lagrangian,
we ﬁrst express the center of mass point as

(xc, yc) = (x, y) + a(cid:0)cos(ϕ), sin(ϕ)(cid:1).
(cid:1) +
m(cid:0) ˙x2
m(cid:0) ˙x2 + ˙y2(cid:1) +

(cid:0)I + ma2(cid:1) ˙ϕ2 + ma ˙ϕ(cid:0)− ˙x sin(ϕ) + ˙y cos(ϕ)(cid:1).

c + ˙y2
c

I ˙ϕ2

(9)

Then the Lagrangian is given by

L =

=

1
2
1
2

1
2
1
2

We now switch to moving frame coordinates (u, v, ω), where u and v are the velocities
parallel and perpendicular to the skate, respectively, and ω is the angular velocity. They

7An oﬀset of the center of mass perpendicular to the skate blade does not intrinsically change the
system, since a shift of the contact point perpendicular to the skate blade does not alter the constraint.
8See [CD´S10, Chap. 5] for a thorough account how to derive the equations in various diﬀerent settings,

and the end of the chapter for some interesting notes.

This moving frame is aligned with the constraint distribution D in the sense that the
constraint is described by the function

ζq( ˙q) := v = − ˙x sin(ϕ) + ˙y cos(ϕ),

i.e. the constraint v = 0 precisely expresses that the skate cannot move sideways.

It is now a straightforward exercise to calculate the Lagrange–d’Alembert equations (4).

We ﬁnd for each of the coordinates x, y, ϕ and their associated velocities:

d
dt
d
dt

∂L
∂ ˙x
∂L
∂ ˙y

d
dt

∂L
∂ ˙ϕ

− ∂L
∂x
− ∂L
∂y
− ∂L
∂ϕ

= m¨x + ma(cid:0)− ¨ϕ sin(ϕ) − ˙ϕ2 cos(ϕ)(cid:1) = −λ sin(ϕ),
= m¨y + ma(cid:0) ¨ϕ cos(ϕ) − ˙ϕ2 sin(ϕ)(cid:1) = λ cos(ϕ),
(cid:105)
(cid:104)− ˙x sin(ϕ) + ˙y cos(ϕ)
+ ma ˙ϕ(cid:0) ˙x cos(ϕ) + ˙y sin(ϕ)(cid:1) = 0.

= (I + ma2) ¨ϕ + ma

d
dt

Next, we switch to moving frame coordinates by substituting in (10) and taking linear
combinations of the ﬁrst two equations with factors cos(ϕ) and sin(ϕ). This yields

m( ˙u − vω − aω2) = 0,
m( ˙v + uω + a ˙ω) = λ,
(I + ma2) ˙ω + ma( ˙v + uω) = 0.

(10)

(11)

(12)

(13)

(14)

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

9

are given by

u = ˙x cos(ϕ) + ˙y sin(ϕ),
v = − ˙x sin(ϕ) + ˙y cos(ϕ),
ω = ˙ϕ.

Finally, we use the constraint v = 0, which implies that ˙v = 0. Inserting this, we obtain
the usual Chaplygin sleigh equations

with Lagrange multiplier λ = m(uω + a ˙ω) giving rise to the constraint force

˙u = aω2,

Fc = m(uω + a ˙ω)

˙ω = − mauω
I + ma2 ,

(cid:18)− sin(ϕ)

(cid:19)

cos(ϕ)

.

These equations give rise to the phase plot in Figure 3. A typical trajectory of the
skate point of contact is shown in Figure 4. We see that the solutions are half-ellipsoids
in the (u, ω)-plane starting from the negative u axis and converging onto the positive u
axis. When u is positive and ω = 0 then the sleigh is moving in a straight line with
the center of mass forward of the skate. This turns out to be the stable solution, while
the opposite direction is unstable. This cannot happen in holonomic Lagrangian systems,
since the eigenvalues of the linearization about a ﬁxed point must always appear in pairs
or quadruples that are symmetric about the real and imaginary axis. Here, the ﬁxed
points on the u axis have one zero eigenvalue and one negative or positive eigenvalue
when u < 0 or u > 0, respectively.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

10

Figure 3. Phase plot of the (u, ω)
coordinates with m = I = 1 and
a = 1/5.

Figure 4. Trajectory plot associ-
ated to the orbit in Figure 3. The
sleigh approaches from the right.

5. The sleigh with sliding friction

Now we shall obtain the Chaplygin sleigh equations (13) in a diﬀerent way. Instead of
enforcing the no-slip constraint v = 0 with the constraint reaction force Fc, we consider the
same Lagrangian without constraint, but now we add a friction force Ff . Then we scale
the friction force to inﬁnity and obtain the nonholonomic Chaplygin sleigh equations in
the limit. Note that the friction force Ff is deﬁned also outside the constraint distribution
D — and actually zero on it — while the reaction force Fc is only deﬁned on D!

This idea can be physically motivated in the following way. A nonholonomic system
with a no-slip constraint is a mathematical idealization of a physical system where there
is a (very) strong force that prevents the system from going into slip. In this case, we
assume that a strong friction force prevents the skate from slipping sideways. By showing
that scaling the friction force to inﬁnity leads to nonholonomic dynamics, we provide a
fundamental physics argument for the d’Alembert principle of nonholonomic dynamics.
We shall ﬁrst argue heuristically how this limit is obtained, and then make it rigorous using
geometric singular perturbation theory. Secondly we can consider what happens when the
skate is turning too quickly at high speed and the friction may not be able to generate the
force necessary to (nearly) keep the sleigh from slipping. Singular perturbation theory also
provides us with modiﬁcations to the nonholonomic dynamics through a series expansion
in the scaling parameter.

We start with the same Lagrangian (9), but now insert a friction force Ff on the right-
hand side. The friction force is supposed to suppress sideways sliding of the skate blade,
which is given by the velocity v = − ˙x sin(ϕ) + ˙y cos(ϕ). We take the friction force linear
in this slipping velocity and pointing in the opposite direction to dampen it. Thus we

Ω(cid:45)2(cid:45)1012(cid:45)2(cid:45)1012u(cid:45)4(cid:45)224x(cid:45)2246yREALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

have9

Ff = −v

(cid:18)− sin(ϕ)

(cid:19)

cos(ϕ)

.

11

(15)

Note that this force acts at the point of contact of the skate, so there is no associated
torque around that point, i.e. the ω-component of the force is zero. Secondly, Ff is zero
when v = 0 (as opposed to Fc), so this ﬁnite force does not enforce the nonholonomic
constraint. We insert Ff /ε into the right-hand side of (11), so that we can scale the
friction force to inﬁnity by taking the limit ε → 0. This yields

m¨x + ma(cid:0)− ¨ϕ sin(ϕ) − ˙ϕ2 cos(ϕ)(cid:1) =
m¨y + ma(cid:0) ¨ϕ cos(ϕ) − ˙ϕ2 sin(ϕ)(cid:1) = −v
(cid:105)
(cid:104)− ˙x sin(ϕ) + ˙y cos(ϕ)
+ ma ˙ϕ(cid:0) ˙x cos(ϕ) + ˙y sin(ϕ)(cid:1) = 0.

d
dt

v
ε

ε

sin(ϕ),

cos(ϕ),

(I + ma2) ¨ϕ + ma

As in the previous section, we transform these equations to moving frame coordinates,
cf. (12), and obtain

˙u − vω − aω2 = 0,
˙v + uω + a ˙ω = − v
mε

,

(I + ma2) ˙ω + ma( ˙v + uω) = 0,

(16)

but now we cannot insert the constraint condition v = 0. Instead, we shall analyze the
dynamics and see that when ε > 0 is small, then v(t) will quickly converge to near zero.
This will imply that the other two equations eﬀectively behave as if the constraint v = 0
is active. In other words, there is a slow manifold described by the variables (u, ω) and
on that manifold the fast variable v is small and slaved to (u, ω). Secondly, the friction
force naturally takes values in D0, the annihilator of D. This is preserved in the limit
to realize a constraint reaction force according to d’Alembert’s principle 1. All of this
indicates that we can expect to recover nonholonomic dynamics.

To obtain a diﬀerential equation for ˙v, we subtract

the second to make the term with ˙ω cancel. This gives

a

I+ma2 times the third equation from

I

I + ma2 ( ˙v + uω) = − v

mε

.

(17)

When ε is small, this gives fast exponential decay of v. We shall now assume that the
typical rate at which v(t) changes is much faster than that of u(t) and ω(t). That is, we
consider v as fast variable and u, ω as slow variables. Further conclusions based on this can
be made rigorous using singular perturbation theory, but we postpone these arguments
to the general theory in Section 6 and focus on obtaining the result.

Thus we assume in (17) that u, ω are approximately constant and obtain as solution

v(t) =

v(0) +

uω
ρ

e−ρt − uω
ρ

with ρ =

I + ma2

Imε

.

(18)

(cid:16)

(cid:17)

9We could have obtained this friction force more geometrically from a Rayleigh dissipation function
2 νq( ˙q, ˙q), where ν is a family of quadratic forms on TQ with kernel D. Then Ff is given by minus
∂ ˙q : TQ/D → D0 ⊂ T∗Q. Using the moving frame coordinate v
2 ¯ν(q) v2. In our example we choose the friction coeﬃcient ¯ν(q) = 1.

R(q, ˙q) = 1
the ﬁber derivative of R, that is, Ff = − ∂R
to coordinatize TQ/D, we ﬁnd R = 1

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

12

This quickly settles to v = − uω
which gives

ρ , so for the slow dynamics of u, ω we insert this relation,

(cid:2)uω(cid:3).

˙u = aω2 + ε

Im

I + ma2 uω2,

˙ω = − mauω

I + ma2 + εIm2a

d
dt

(19)

In these diﬀerential equations ε only appears in the numerator and the ε multiplying the
time derivative of (uω) does not lead to singular equations, so we can sensibly take the
limit: we simply insert ε = 0 to arrive at the original equations (13) for the nonholo-
nomically constrained Chaplygin sleigh. This is also conﬁrmed by numerical integration
of this system: with decreasing values of ε, the trajectories converge to the trajectory of
the nonholonomic system, see Figure 5. It is clearly visible though that the convergence
is not uniform in time, as already illustrated in Section 3. In Section 7.1 we will analyze
the perturbation to the slow system in more detail.

Figure 5. The red orbits are trajectories of the sleigh with friction with
indicated parameter values ε. These clearly converge to the nonholonomic
trajectory in blue.

6. The general theory

We shall ﬁnally prove the statement that linear friction forces realize nonholonomic
dynamics in a more general setting. This rephrases the results in [Bre81, Kar81] in a
more geometric formulation, and speciﬁes in what sense the solution curves converge, also
on positively unbounded time intervals.

Recall that we consider Lagrangian systems of mechanical type,
(q, ˙q) ∈ TQ.

κq( ˙q, ˙q) − V (q),

L(q, ˙q) =

1
2

(1)

Furthermore, to state our result, we need the concept of a pseudo solution (or pseudo
orbit) of a dynamical system.

Ε(cid:61)0.2Ε(cid:61)0.1Ε(cid:61)0.05Ε(cid:61)0.02(cid:45)6(cid:45)4(cid:45)22x(cid:45)2246yREALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

13

Deﬁnition 2 (Pseudo solution). Let (M, g) be a smooth Riemannian manifold and let
X ∈ X(M ) be a C 1 vector ﬁeld on it. We say that a C 1 curve x(t) ∈ M is a δ-pseudo
solution of X when

(cid:107) ˙x(t) − X(x(t))(cid:107) ≤ δ

for all t.

(20)

Furthermore, we consider linear friction forces F that are speciﬁed by a Rayleigh
function R. That is, given a smooth family of positive semi-deﬁnite bilinear forms
νq : TqQ × TqQ → R, we deﬁne the Rayleigh function R(q, ˙q) = 1
2νq( ˙q, ˙q) and the friction
force as its negative ﬁber derivative,

F : TQ → T∗Q, F (q, ˙q) = −∂R
∂ ˙q

(q, ˙q) = −ν(cid:91)

q( ˙q).

(21)

Then we have the following result10

Theorem 3. Let Q be a compact manifold, let L be a Lagrangian of mechanical type (1),
and let F be a linear friction force with kernel ker(F ) = D a regular distribution. Let
Xε ∈ X(TQ) denote the vector ﬁeld of the Lagrangian system with Rayleigh friction force
F/ε as above, and let XNH ∈ X(D) denote the vector ﬁeld of the Lagrange–d’Alembert
nonholonomic system (Q, L,D).
Then solution curves of Xε converge to solutions of XNH as ε → 0 in the following sense.
For any ﬁxed energy level E0 > inf V , for all ε > 0 suﬃciently small, all solution curves
x(t) of Xε whose initial condition x(0) ∈ TQ have energy less than E0, converge at a
uniform exponential rate to an invariant manifold11 Dε that is C 1-close and diﬀeomorphic
to D. The manifold Dε depends smoothly on ε near zero, with D0 = D.
Finally, on any interval [t0,∞) with t0 > 0 ﬁxed, the solution curves xε(t) converge
uniformly to curves ¯xε(t) ∈ D that are uniformly O(ε)-pseudo solution curves of XNH.

The compactness condition of Q can be replaced by uniformity assumptions on all of
Q, L, F,D. One crucial assumption that has to be added is that V is bounded from below.
Alternatively, one can restrict to convergence of solution curves only on ﬁnite time inter-
vals, which eﬀectively allows one to restrict to a compact set covering the nonholonomic
solution curve. This is essentially the setting of the results in [Bre81, Kar81], which are
given in local coordinates. It does not automatically yield uniformity of convergence of
solution curves (even on ﬁnite time intervals) when Q is noncompact though, as illustrated
by the following example.
potential V (x, y) = −x2. Let the constraint distribution be

Let Q = R2 with the Euclidean metric and consider a particle of unit mass under the

D = span χ(x − y)∂x +(cid:0)1 − χ(x − y)(cid:1)∂y,

where χ ∈ C∞(R; [0, 1]) such that χ(x) = 0 for x ≤ 0 and χ(x) = 1 for x ≥ 1. Finally, let
the friction force F be arbitrary, but with kernel D and uniformly bounded. Now consider
the unconstrained system with friction and initial conditions x(0) > 0 small, y(0) ≥ 1
arbitrary large and ˙x(0) = ˙y(0) = 0. Then the particle will ﬁrst accelerate in the positive
x direction due to the potential; once it hits the line x = y, the friction force kicks in to
make the particle follow the changing constraint direction of D. However, for any ﬁxed
ε > 0, the particle’s velocity component ˙x will overshoot the constraint D = span ∂y in
the region x ≥ y + 1 by an arbitrary amount as the initial condition y(0) is made large,

10We shall assume that everything has suﬃcient smoothness, say, C r for a large r. Note that the
perturbed manifolds Dε will generally only have ﬁnite degree of smoothness, see e.g. [Eld13, Sect. 1.2.1].
11The manifold Dε is unique up to the choice of a cut oﬀ function at the boundary of the energy E0
in TQ. Diﬀerent choices lead to diﬀerences of order ε that decay exponentially away from the boundary.
However, the limit to the reduced vector ﬁeld XNH will not depend on this choice.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

14

since ˙x then is arbitrary large at ‘impact’ with the changing constraint. Even worse, since
the potential force increases with x, even in the region x ≥ y + 1, the velocity component
˙x will diverge away from zero, that is, from D.
Proof of Theorem 3. The system with friction described by Xε is given by the second
order equations

κ(cid:91)(∇ ˙q ˙q) = −dV (q) +
or, in explicit local coordinates it is expressed as

1
ε

˙qi = vi,

˙vi = −Γi

F (q, ˙q),

jkvjvk + κij(cid:16)− ∂V

∂qj +

(cid:17)

.

1
ε

Fj

(22)

(23)

The limit of the vector ﬁeld Xε is singular, so we switch to a rescaled version Yε = ε Xε.
This can be viewed as changing to a fast time variable τ = t/ε (whose derivative we
denote by a prime) for any ε > 0, but the vector ﬁeld Y0 is also well-deﬁned and given in
local coordinates as
(24)
Both κij and νjk are (semi-)positive deﬁnite matrices with ker(νq) = Dq. This shows that
the smooth manifold D ⊂ TQ is the ﬁxed point set of Y0 and that Y0 is linear in the
normal direction, and the linear term given by

v(cid:48)i = κijFj = −κij νjk vk.

q(cid:48)i = 0,

−κ(cid:93) ◦ ν(cid:91)(cid:12)(cid:12)TQ/D

has strictly negative eigenvalues when we identify TQ/D ∼= D⊥. Thus, D is a normally
hyperbolic invariant manifold (nhim) for Y0 and it is globally exponentially attractive.

We now restrict attention to the compact subset

E = {(q, v) ∈ TQ | E(q, v) ≤ E0}

below the energy level E0, which is nonempty when E0 > inf V . The dynamics of Xε
(and thus also of Yε) is dissipative, hence leaves E forward invariant. This implies that
we can use a cut oﬀ argument12 outside E which will not aﬀect forward solutions with
initial conditions inside E. Using persistence of nhims (see [Fen72, HPS77, Eld13]) we
ﬁnd that for ε > 0 suﬃciently small, there is a unique perturbed manifold Dε that is
C 1-close and diﬀeomorphic to D and invariant under Yε. Moreover, Dε depends smoothly
In particular, Dε is locally
on ε and is a nhim again with perturbed stable ﬁbration.
exponentially attractive, while the exponential attraction globally inside E follows from
uniform smooth dependence of ﬂows on parameters over compact domains and time inter-
vals, see e.g. [Eld13, Thm. A.6]. Hence solution curves ˜xε(τ ) of Yε converge at a uniform
exponential rate to Dε, and thus the solution curves xε(t) = ˜xε(t/ε) of Xε do so too, and
at increasing rates as ε → 0. This proves the ﬁrst part of the claims.
invariant manifold Dε. Let us denote by

To prove the remaining claims, we need to analyze the dynamics of Yε restricted to the

pr : TQ → D

(25)
the projection along D⊥, that is, orthogonal according to the kinetic energy metric κ. Note
that (25) can be viewed as a vector bundle where we forget about the linear structure on
D. The Lagrange–d’Alembert equations (3) can then be expressed as

components span D and the remaining n−k span D⊥. Let ω ∈ Ω1(cid:0)Q; End(Rn)(cid:1) denote the

Furthermore, let f : U ×Rn → TQ be a frame on an open set U ⊂ Q, such that the ﬁrst k

pr ◦ [L](¨q(t)) = 0

with ˙q(t) ∈ D.

12Without going in full details: we modify Yε at the boundary of E such that D ∩ E is overﬂowing

invariant (see [Fen72]) for the modiﬁed vector ﬁeld.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

15

connection one-form with respect to the frame f and let (ξ, η) ∈ Rn denote coordinates
associated to this frame, where ξ ∈ Rk and η ∈ Rn−k respectively coordinatize the ﬁbers
of D and D⊥. In these frame coordinates, the projection pr simply maps (ξ, η) to (ξ, 0).
Let prξ : Rn → Rk denote this projection, prη : Rn → Rn−k its complementary projection.
See Appendix A for a brief overview of using a connection one-form to express equations
of motion in a moving frame and its relation to using structure functions.

In frame coordinates the Lagrange–d’Alembert equations are then

(cid:40) ˙q = fq · (ξ, 0),

(cid:104)−ω( ˙q) · (ξ, 0) − f−1

(cid:105)

XNH ⇐⇒

,
since ˙q ∈ Dq is equivalent to η = 0. This is the vector ﬁeld XNH on D.

q

˙ξ = prξ

· κ(cid:93)

q · dV

Next, we show that there is a well-deﬁned limit of the family of vector ﬁelds

Xε|Dε ∈ X(Dε)

(26)

and that the limit is precisely XNH. To make sense of this limit, however, we ﬁrst have
to re-express these vector ﬁelds on a ﬁxed manifold, D. This we do using the projection
pr : TQ → D. The invariant manifolds are C 1-close and diﬀeomorphic to D, so they can
be written as the graphs of functions hε : D → D⊥ covering the identity in Q, or in other
words as graphs of sections hε ∈ Γ(pr : TQ → D). That is, in frame coordinates we have
(27)
Since Dε depends smoothly on ε, we can consider a Taylor expansion of hε. This we
denote as

D = { η = hε(q, ξ)}.

r(cid:88)
cf. (22) and (26). Let us denote by (cid:0)κ(cid:93)

(28)
Note that h(0)(q, ξ) = h0(q, ξ) = 0 since D0 = D. We now consider Yε in frame coordinates,
q with

h(i)(q, ξ) + O(εr+1).

f the linear operator κ(cid:93)

q : D⊥

q → D⊥

hε(q, ξ) =

q ν(cid:91)
q

q ν(cid:91)

εi
i!

(cid:1)

i=0

respect to the frame f , then

q(cid:48) = ε fq · (ξ, η),
ξ(cid:48) = ε prξ
η(cid:48) = ε prη

(cid:104)−ω(cid:0)fq · (ξ, η)(cid:1) · (ξ, η) − f−1
(cid:104)−ω(cid:0)fq · (ξ, η)(cid:1) · (ξ, η) − f−1

q

q

· κ(cid:93)
q · dV
· κ(cid:93)
q · dV

(cid:105)
(cid:105) −(cid:0)κ(cid:93)

,

(cid:1)
f · η.

q ν(cid:91)
q

(29)



Yε ⇐⇒

(cid:105)

· κ(cid:93)

q · dV

(30)

Note that ω(fq· ) are the connection coeﬃcients as deﬁned in Appendix A, but written
without indices. Since Yε leaves Dε invariant, we can consider the restriction Yε|Dε. Sec-
ondly, pr : Dε → D is a diﬀeomorphism (its inverse is the map IdD + hε), so we can push
forward the vector ﬁeld Yε|Dε along pr to

(cid:1) ∈ X(D).

˜Yε := pr∗(cid:0)Yε|Dε
 q(cid:48) = ε fq · (ξ, hε(q, ξ))
(cid:104)−ω(cid:0)fq · (ξ, η)(cid:1) · (ξ, hε(q, ξ)) − f−1

ξ(cid:48) = ε prξ

q

˜Yε ⇐⇒

In frame coordinates this amounts to projecting the vector ﬁeld onto the coordinates
(q, ξ), while inserting η = hε(q, ξ), see Figure 6. That is, in frame coordinates we have

,
and η implicitly deﬁned through hε parametrizing the invariant manifold Dε.

Now we note that ˜Yε is of order ε, so this vector ﬁeld can be rescaled back to the original

slow time t = ε τ , which we denote as ˜Xε = 1

ε

˜Yε. Then we can consider its limit
˜Xε ∈ X(D)

(31)

˜X0 := lim
ε→0

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

16

η

Y0

TQ

pr

Yε|Dε

(q, ξ) ∈ D
Dε

Figure 6. The invariant manifolds Dε and vector ﬁelds living on them in
frame coordinates (q, ξ, η). The dashed lines indicate stable ﬁbers.

and we ﬁnd ˜X0 = XNH, that is, the Lagrange–d’Alembert equations: we have hε(q, ξ) =
ε h(1)(q, ξ) + O(ε2), so after dividing (30) by ε and inserting η = hε(q, ξ), the only terms
remaining in the limit are those with η = 0. This yields exactly the nonholonomic vector
ﬁeld XNH as in (26).
Using this limit, we can ﬁnally prove the last dynamical statement that solution curves
xε(t) of Xε converge to curves ¯xε(t) ∈ D that are uniformly O(ε)-pseudo solutions of
XNH. Using persistence of normal hyperbolicity we already proved that xε(t) converges
uniformly to the invariant manifold Dε. Moreover, Dε has a stable ﬁbration whose projec-
tion commutes with the ﬂow of Xε. Hence, xε(t) projects to a solution curve ˜xε(t) ∈ Dε.
Now deﬁne ¯xε(t) := pr(˜xε(t)) ∈ D, which is by construction a solution of ˜Xε. Since
˜Xε − XNH ∈ O(ε) uniformly on the compact set E, it follows that ¯xε(t) is a uniform
O(ε)-pseudo solution of XNH.
(cid:3)

7. Beyond the limit of nonholonomic dynamics

The Lagrange–d’Alembert equations were obtained as zeroth order term in the expan-
sion of ˜Xε in ε. However, one can continue and inductively ﬁnd higher order terms in the
expansion of ˜Xε. These terms correspond to eﬀects of large, but ﬁnite friction forces, and
will for example contribute to drift normal to the nonholonomic constraint and energy
dissipation. The advantage of studying large, but ﬁnite friction in this context is that ˜Xε
is still a vector ﬁeld on the lower-dimensional nonholonomic phase space D as compared
to the full Euler–Lagrange equations on TQ, while normal hyperbolicity guarantees that
this is a proper Taylor expansion of a truly invariant and attractive subsystem. We shall
here show how these higher terms can be obtained and calculate the ﬁrst order correction
term.
The ‘master equation’ for obtaining the expansion is derived from the coordinate ex-
pression for the invariant manifold Dε, given by η = h(q, x). Let fε(q, ξ, η) denote the
‘horizontal’ components of Yε for (q(cid:48), ξ(cid:48)) and let gε(q, ξ, η) describe the ‘vertical’ com-
ponent for η(cid:48). Taking a fast-time-τ derivative of the invariant manifold equations, we
ﬁnd

η(cid:48) = Dhε(q, ξ) · (q(cid:48), ξ(cid:48))

⇐⇒ gε(q, ξ, hε(q, ξ)) = Dhε(q, ξ) · fε(q, ξ, hε(q, ξ)).

(32)

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

17

This equation we can now expand in powers of ε to obtain inductively the functions
h(i)(q, ξ). Before starting this, let us note the following: using the same expansion as
in (28) for fε and gε we have for all (q, ξ, η) that

f (0)(q, ξ, η) = 0,
g(0)(q, ξ, 0) = 0,

D3g(0)(q, ξ, 0) = −(cid:0)κ(cid:93)

h(0)(q, ξ) = 0,

(cid:1)

q ν(cid:91)
q

f

and D3g(0)(q, ξ, 0) is invertible as a linear map on Rn−k. Expanding (32) up to ﬁrst order
in ε then leads to

g(0)(q, ξ, h(0)(q, ξ)) = Dh(0)(q, ξ) · f (0)(q, ξ, h(0)(q, ξ))

at zeroth order, and is trivially satisﬁed as it reduces to 0 = 0. At ﬁrst order we ﬁnd
g(1)(q, ξ, h(0)(q, ξ)) + D3g(0)(q, ξ, h(0)(q, ξ)) · h(1)(q, ξ)

+ Dh(0)(q, ξ) ·(cid:104)

= Dh(1)(q, ξ) · f (0)(q, ξ, h(0)(q, ξ))

f (1)(q, ξ, h(0)(q, ξ)) + D3f (0)(q, ξ, h(0)(q, ξ)) · h(1)(q, ξ)

(cid:105)

which greatly simpliﬁes to

g(1)(q, ξ, 0) + D3g(0)(q, ξ, 0) · h(1)(q, ξ) = 0.
Using invertibility of D3g(0), this can be solved for h(1) and gives

h(1)(q, ξ) = −(cid:2)D3g(0)(q, ξ, 0)(cid:3)−1 · g(1)(q, ξ, 0)
q)f · prη ·(cid:2)−ω(fq · ξ) · ξ − f−1

where we consider ν restricted to D. The term g(1)(q, ξ, 0) = prη·(cid:2)−ω(fq·ξ)·ξ−f−1

can be identiﬁed as minus the reaction force Fr : D → D0 in the nonholonomic constraint
picture, while η = h(1)(q, ξ) is the drift velocity violating the nonholonomic constraint
that is necessary to generate the same force as Fr, but now due to the linear friction Ff
and up to order ε.

· κq · dV(cid:3),

= (ν(cid:93)

(33)

·κq·dV(cid:3)

q κ(cid:91)

To ﬁnally obtain the ﬁrst order expansion of ˜Xε, we have to expand fε(q, ξ, hε(q, ξ)) up

q

q

to order two. Here we ﬁnd

(cid:18) d

dε

(cid:19)2(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)ε=0

1
2

fε(q, ξ, hε(q, ξ)) =

1
2

f (2)(q, ξ, 0) + D3f (1)(q, ξ, 0) · h(1)(q, ξ)
1
2

D3f (0)(q, ξ, 0) · h(2)(q, ξ) +

1
2

+

= D3f (1)(q, ξ, 0) · h(1)(q, ξ),

3f (0)(q, ξ, 0) · h(1)(q, ξ)2
D2

noting that also f (2) ≡ 0. From (30) we read oﬀ that

D3f (1)(q, ξ, 0) · η =

(cid:16)
fq · η , −prξ
 ˙q = fq · h(1)(q, ξ)
(cid:104)

˙ξ = −prξ

˜X (1) ⇐⇒

Putting everything together, we obtain ˜Xε = XNH + ε ˜X (1) + O(ε2) with

ω(fq · h(1)(q, ξ)) · ξ + ω(fq · ξ) · h(1)(q, ξ)

Note that with this correction term, ˜Xε is not a second order vector ﬁeld on D anymore
since the drift velocity h(1)(q, ξ) violates the nonholonomic constraint D.

(cid:2)ω(fq · η) · ξ + ω(fq · ξ) · η(cid:3)(cid:17)

.

(34)

(35)

(cid:105)

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

18

7.1. The Chaplygin sleigh. We shall now follow this recipe to obtain a ﬁrst order
perturbation for the nonholonomic dynamics of the Chaplygin sleigh, based on the friction
model used in Section 5. We cannot apply the theory right away since the coordinates
u, v, ω do not correspond to an orthogonal frame. This can be seen from the Lagrangian

L =

1
2

m(u2 + v2) +

1
2

(I + ma2)ω2 + maωv

(36)

with respect to these coordinates: it is purely kinetic, but the metric is not diagonal with
respect to u, v, ω. We replace ω by a new coordinate ψ = ω + ma
I+ma2 v which diagonalizes
the metric. That is, the coordinates u, v, ψ correspond to an orthogonal frame and we
have

L =

mu2 +

1
2

1
2

Im

I + ma2 v2 +

1
2

(I + ma2)ψ2.

(37)

With respect to these coordinates the equations of motion (16) become

ma2 − I
I + ma2 vψ +

˙u +

maI

(I + ma2)2 v2 − aψ2 = 0,
˙v + uψ − ma
I + ma2 uψ − m2a2

I + ma2 uv = −I + ma2
(I + ma2)2 uv = 0.

εmI

ma

˙ψ +

v,

(38)

Note that the terms without time derivatives on the left-hand side are exactly those arising
from the connection coeﬃcients, see Appendix A. The friction force only appears in the
equation for v since the frame component associated to v spans D⊥, while Ff takes values
in D0 and hence the term κ(cid:93) · Ff , see (23), takes values in D⊥.
To obtain the ﬁrst order vector ﬁeld (35), we ﬁrst have to recover h(1)(x, y, ϕ, u, ψ) =
h(1)(u, ψ) from (33). We note that ξ = (u, 0, ψ), η = (0, v, 0), V ≡ 0, that ω(fq · ) are
precisely the connection coeﬃcients, and ﬁnally that (ν(cid:93)

q)f acting on η is given by

q k(cid:91)

(ν(cid:93)

q k(cid:91)

q)f = 1 ·

Im

I + ma2 .

This yields

h(1)(u, ψ) = − Im

I + ma2 uψ

since uψ is the only term in the v-component of the connection one-form in (38) that
survives when we insert ξ, i.e. v = 0. Then we recover for ˜X (1):

( ˙x, ˙y) = − Im

I + ma2 uψ(− sin(ϕ), cos(ϕ)),
Im(ma2 − I)
(I + ma2)2 u ψ2,
Here we used that ˙ϕ = ω = ψ − ma

˙u =

I+ma2 v and that ψ = ω on D.

˙ϕ = − Im2a

(I + ma2)2 uψ,

˙ψ = − Im3a2

(I + ma2)3 u2 ψ.

Now we can numerically integrate the vector ﬁeld XNH + ε ˜X (1). This should, on D,
be a ﬁrst order approximation of the singularly perturbed vector ﬁeld Xε with friction.
Indeed, the phase and trajectory plots in Figures 7 and 8 clearly show that the green
curves of the ﬁrst order expansion XNH + ε ˜X (1) converge more than linearly in ε to the
red curves of the singularly perturbed system Xε.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

19

Figure 7. Phase plot of the (u, ω) coor-
dinates with the nonholonomic system in
blue, the system with friction in red and
the ﬁrst order approximation in green.

Figure 8. Trajectory plots associated to
the orbits in Figure 7.

Acknowledgments

This topic was initially suggested to me by Hans Duistermaat as PhD research project.
Although my PhD research ﬁnally went another direction, Hans’ insights have been in-
valuable. Since then, this topic has been in the back of my mind and during my stay
at PUC-Rio I started actively working on it again and gave a couple of lectures. This
paper grew out of the accompanying lecture notes; I like to thank Alex Castro for his
suggestion to do so. I want to thank Paula Balseiro and Luis Garc´ıa Naranjo for stimu-
lating discussions and helpful remarks and Jair Koiller and the people at the mathematics
department at PUC-Rio for their hospitality. This research was supported by the Capes
grant PVE11-2012.

Appendix A. Connection form vs. structure functions

In this appendix we brieﬂy recall the connection one-form as a method to express
(geodesic) equations of motion with respect to a moving frame. We also relate this to
the formulation using the structure functions associated to the frame in terms of the Lie
brackets of the vector ﬁelds spanning the moving frame. The latter formulation is more
common in nonholonomic dynamics and known as Hamel’s formalism, see e.g. [BMZ09].
Let f : Q×Rn → TQ be a (local) moving frame, where fα ∈ X(Q) denote the individual
vector ﬁelds spanning the frame and fα = f i
α ∂i their decomposition with respect to a basis
induced by local coordinates qi. Let λ : TQ → Q × Rn denote the inverse of f , that is, a
(local) trivialization of TQ. Roman indices are used for induced coordinates; Greek ones
to index moving frame coordinates. Now a connection ∇ on Q can be expressed with
respect to the frame f as

where ω ∈ Ω1(Q; End(Rn)) is the connection one-form and ωα
the other hand, the structure function C α

(39)
βγ are its coeﬃcients. On
βγ encode the Lie brackets relative to a frame as

∇fγ fβ = ω(fγ)α

β fα = ωα
βγ,

Ω(cid:45)2(cid:45)1012(cid:45)2(cid:45)1012uΕ(cid:61)0.2Ε(cid:61)0.1Ε(cid:61)0.05Ε(cid:61)0.02(cid:45)6(cid:45)4(cid:45)22x(cid:45)2246yREALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

20

follows:

(40)
Let ∇ be the Levi-Civita connection associated to a metric κ on Q. According to [KN63,

βγ fα.

[fβ, fγ] = C α

Prop. 2.3] we have

2κ(∇XY, Z) = X · κ(Y, Z) + Y · κ(X, Z) − Z · κ(X, Y )

+ κ([X, Y ], Z) + κ([Z, X], Y ) + κ([Z, Y ], X)

for any vector ﬁelds X, Y, Z ∈ X(Q). When we decompose the vector ﬁelds with respect to
the frame f , i.e. write X = X αfα, this yields the following relation between the connection
coeﬃcients, the metric, and the structure functions:

κηβ(cid:0)fδ(κγβ) + fγ(κδβ) − fβ(κδγ)(cid:1) +

(cid:0)C η

1
2

ωη

γδ =

1
2

δγ + καγκηβC α

βδ − καδκηβC α

βγ

(41)

(cid:1).

Note that when f is a holonomic, coordinate-induced frame, then the structure constants
are zero and the ﬁrst terms reduce to the usual Christoﬀel symbols. Conversely, the
torsion-freeness of ∇, i.e. [X, Y ] = ∇XY − ∇Y X for any X, Y ∈ X(Q), implies that

C α

βγ = ωα

γβ − ωα
βγ.

We return to the formulation of Lagrangian mechanics. For simplicity we consider
a purely kinetic13 Lagrangian L(q, ˙q) = 1
2κq( ˙q, ˙q), so its Euler–Lagrange equations corre-
spond to the geodesic equations ∇ ˙q ˙q = 0, or in induced coordinates, ¨qi = −Γi
jk ˙qj ˙qk, where
Γ are the Christoﬀel symbols of the metric κ. Denoting frame coordinates by vα (these
are also called quasi-velocities), then we have
˙vα = −ωα

(42)

βγvβvγ.

The coeﬃcients ωα
to the moving frame f . They are related through

βγ play the same role as the Christoﬀel symbols Γi

jk, but with respect

ωα
βγ = λα

i Γi

jkf j

βf k

γ + λα

i (∂kf i

β)f k
γ

(43)

since Γ represents the connection with respect to the local coordinate frame and (43)
expresses the change to the frame f .

On the other hand, the Euler–Lagrange equations with respect to a moving frame are

given by, see e.g. [CD´S10, Prop. 1.4.6], [BMZ09, Eq. (2.5)],

∂vα − ∂L
∂L
∂qi f i

α − ∂L

d
dt

∂vγ C γ

βαvβ = 0

with L = L ◦ f : Q × Rn → R the Lagrangian with respect to the frame. In our case this
boils down to

∂vγ C γ

α − ∂L
fα · κβγ vβvγ − κδγC δ

βαvβ

0 =

d
dt
d
dt

∂L
∂vα − ∂L
καβvβ(cid:105) − 1
(cid:104)
∂qi f i
⇔ ˙vα = −καδ(cid:2)fγ · κδβ − 1

=
= καβ ˙vβ + fγ · καβ vβvγ − 1
2

fδ · κβγ + κηγC η

2

βα

βαvβvγ

(cid:3)vβvγ.

2

fα · κβγ vβvγ − κδγC δ

βαvβvγ

(44)

Note that by equating (42) and (44) we also ﬁnd an explicit relation between the connec-
tion one-form ω, the metric κ and the structure functions C. It diﬀers from (41) only by

13A potential term would add a force ﬁeld that transforms covariantly, hence is trivial to add afterwards.

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

21

terms that are anti-symmetric in the two lower indices, since these cancel in the geodesic
equation.

References

[Arn78]

[App11] M. Paul Appell, Exemple de mouvement d’un point assujetti ´e une liaison exprim´ee par une
relation non lin´eaire entre les composantes de la vitesse, Rend. Circ. Mat. Palermo 32 (1911),
no. 1, 48–50.
V. I. Arnol(cid:48)d, Ordinary diﬀerential equations, MIT Press, Cambridge, Mass.-London, 1978,
Translated from the Russian and edited by Richard A. Silverman. MR 0508209 (58 #22707)
[BKM+15] Alexey V. Borisov, Yury L. Karavaev, Ivan S. Mamaev, Nadezhda N. Erdakova, Tatyana B.
Ivanova, and Valery V. Tarasov, Experimental investigation of the motion of a body with an
axisymmetric base sliding on a rough plane, Regul. Chaotic Dyn. 20 (2015), no. 5, 518–541.
A. M. Bloch, Nonholonomic mechanics and control, Interdisciplinary Applied Mathematics,
vol. 24, Springer-Verlag, New York, 2003, With the collaboration of J. Baillieul, P. Crouch
and J. Marsden, With scientiﬁc input from P. S. Krishnaprasad, R. M. Murray and D. Zenkov,
Systems and Control. MR MR1978379 (2004e:37099)
Anthony M. Bloch, Nonholonomic mechanics, dissipation and quantization, Advances in the
theory of control, signals and systems with physical modeling, Lecture Notes in Control and
Inform. Sci., vol. 407, Springer, Berlin, 2010, pp. 141–152. MR 2765956 (2012c:70020)

[Blo03]

[Blo10]

[BMZ09] Anthony M. Bloch, Jerrold E. Marsden, and Dmitry V. Zenkov, Quasivelocities and sym-
metries in non-holonomic systems, Dyn. Syst. 24 (2009), no. 2, 187–222. MR 2542960
(2011b:70020)
Anthony M. Bloch and Alberto G. Rojo, Quantization of a nonholonomic system, Phys. Rev.
Lett. 101 (2008), no. 3, 030402, 4. MR 2430224 (2009j:81071)
V. N. Brendelev, On the realization of constraints in nonholonomic mechanics, J. Appl. Math.
Mech. 45 (1981), no. 3, 481–487. MR MR661547 (83k:70018)

[Bre81]

[BR08]

[Car33]
[CD´S10]

[BRMR08] Nawaf M. Bou-Rabee, Jerrold E. Marsden, and Louis A. Romero, Dissipation-induced hete-
roclinic orbits in tippe tops, SIAM Rev. 50 (2008), no. 2, 325–344, Revised reprint of SIAM
J. Appl. Dyn. Syst. 3 (2004), no. 3, 352–357 [MR2114737]. MR 2403054
C. Carath´eodory, Der schlitten, Z. Angew. Math. Mech. 13 (1933), no. 2, 71–76.
edrzej ´Sniatycki, Geometry of nonholonomically
Richard Cushman, Hans Duistermaat, and J
‘
constrained systems, Advanced Series in Nonlinear Dynamics, vol. 26, World Scientiﬁc Pub-
lishing Co. Pte. Ltd., Hackensack, NJ, 2010. MR 2590472 (2011f:37113)
S. A. Chaplygin, On the theory of motion of nonholonomic systems. The reducing-multiplier
theorem, Mat. sb. 28 (1911), no. 1, 303–314, In Russian.

[Cha11]

[Cha08]

[dL12]

[Eld13]

[Fen72]

[Fen79]

, On the theory of motion of nonholonomic systems. The reducing-multiplier theorem,
Regul. Chaotic Dyn. 13 (2008), no. 4, 369–376, Translated from ıt Matematicheski˘ı sbornik
(Russian) 28 (1911), no. 1 by A. V. Getling. MR 2456929 (2010a:70017)
Manuel de Le´on, A historical review on nonholomic mechanics, Rev. R. Acad. Cienc. Exactas
F´ıs. Nat. Ser. A Math. RACSAM 106 (2012), no. 1, 191–224. MR 2892144
Jaap Eldering, Normally hyperbolic invariant manifolds — the noncompact case, Atlantis
Series in Dynamical Systems, vol. 2, Atlantis Press, Paris, September 2013. MR 3098498
Neil Fenichel, Persistence and smoothness of invariant manifolds for ﬂows, Indiana Univ.
Math. J. 21 (1971/1972), 193–226. MR MR0287106 (44 #4313)

, Geometric singular perturbation theory for ordinary diﬀerential equations, J. Diﬀer-

ential Equations 31 (1979), no. 1, 53–98. MR MR524817 (80m:58032)

[FGN10] Yuri N. Fedorov and Luis C. Garc´ıa-Naranjo, The hydrodynamic Chaplygin sleigh, J. Phys.

A 43 (2010), no. 43, 434013, 18. MR 2727787 (2011j:74042)

[HPS77] M. W. Hirsch, C. C. Pugh, and M. Shub, Invariant manifolds, Lecture Notes in Mathematics,

[Kar81]

[KN63]

[KN90]

vol. 583, Springer-Verlag, Berlin, 1977. MR MR0501173 (58 #18595)
A. V. Karapetian, On realizing nonholonomic constraints by viscous friction forces and Celtic
stones stability, J. Appl. Math. Mech. 45 (1981), no. 1, 42–51. MR MR654774 (83f:70013)
Shoshichi Kobayashi and Katsumi Nomizu, Foundations of diﬀerential geometry. Vol I, Inter-
science Publishers, a division of John Wiley & Sons, New York-London, 1963. MR 0152974
(27 #2945)
V. V. Kozlov and A. I. Ne˘ıshtadt, Realization of holonomic constraints, Prikl. Mat. Mekh.
54 (1990), no. 5, 858–861. MR 1088212 (92b:70014)

REALIZING NONHOLONOMIC DYNAMICS AS LIMIT OF FRICTION FORCES

22

[Koz82a] V. V. Kozlov, The dynamics of systems with nonintegrable constraints. I, Vestnik Moskov.

Univ. Ser. I Mat. Mekh. (1982), no. 3, 92–100, 112. MR 671067 (84i:70024a)

[Koz82b]

, The dynamics of systems with nonintegrable constraints. II, Vestnik Moskov. Univ.

[Koz83]

[Koz92]

[Koz10]

[LM95]

[Mar98]

[NF72]

[RU57]

[Rui98]

[SS08]

[Tak80]

[Tih52]

[VG88]

[WH96]

Ser. I Mat. Mekh. (1982), no. 4, 70–76, 86. MR 671890 (84i:70024b)

, Realization of nonintegrable constraints in classical mechanics, Dokl. Akad. Nauk

SSSR 272 (1983), no. 3, 550–554. MR 723778 (84m:70024)

, On the realization of constraints in dynamics, Prikl. Mat. Mekh. 56 (1992), no. 4,

692–698. MR MR1191861 (93m:70015)

, Note on dry friction and non-holonomic constraints, Nelim. Dinam. 6 (2010), no. 4,

903–906, In Russian.
Andrew D. Lewis and Richard M. Murray, Variational principles for constrained systems: the-
ory and experiment, Internat. J. Non-Linear Mech. 30 (1995), no. 6, 793–815. MR MR1365861
(96j:70017)
Charles-Michel Marle, Various approaches to conservative and nonconservative nonholonomic
systems, Rep. Math. Phys. 42 (1998), no. 1-2, 211–229, Paciﬁc Institute of Mathematical Sci-
ences Workshop on Nonholonomic Constraints in Dynamics (Calgary, AB, 1997). MR 1656282
(2000a:70021)
Yu. I. Ne˘ımark and N. A. Fufaev, Dynamics of nonholonomic systems, Translations of math-
ematical monographs, vol. 33, American Mathematical Society, Providence, RI, 1972.
Hanan Rubin and Peter Ungar, Motion under a strong constraining force, Comm. Pure Appl.
Math. 10 (1957), 65–87. MR 0088162 (19,477c)
Andy Ruina, Nonholonomic stability aspects of piecewise holonomic systems, Rep. Math.
Phys. 42 (1998), no. 1-2, 91–100, Paciﬁc Institute of Mathematical Sciences Workshop on
Nonholonomic Constraints in Dynamics (Calgary, AB, 1997). MR 1656277 (99k:70017)
N. Sidek and N. Sarkar, Dynamic modeling and control of nonholonomic mobile robot with
lateral slip, ICONS ’08. Third International Conference on Systems, April 2008, pp. 35–40.
Floris Takens, Motion under the inﬂuence of a strong constraining force, Global theory of
dynamical systems (Proc. Internat. Conf., Northwestern Univ., Evanston, Ill., 1979), Lecture
Notes in Math., vol. 819, Springer, Berlin, 1980, pp. 425–445. MR 591202 (82g:34060)
A. N. Tihonov, Systems of diﬀerential equations containing small parameters in the deriva-
tives, Mat. Sbornik N. S. 31(73) (1952), 575–586. MR 0055515 (14,1085d)
A. M. Vershik and V. Ya. Gershkovich, Nonholonomic problems and the theory of distributions,
Acta Appl. Math. 12 (1988), no. 2, 181–209. MR 966452 (90d:58010)
Jiunn-Cherng Wang and Han-Pang Huang, Creep dynamics of nonholonomic systems, Pro-
ceedings of the 1996 IEEE International Conference on Robotics and Automation, vol. 4,
1996, pp. 3452–3457.

E-mail address: jaap@jaapeldering.nl

Instituto de Ciˆencias Matem´aticas e de Computac¸˜ao - USP, Avenida Trabalhador S˜ao-

carlense 400, CEP 13566-590, S˜ao Carlos, SP, Brazil

