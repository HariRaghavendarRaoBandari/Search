6
1
0
2

 
r
a

 

M
2
2

 
 
]

.

R
P
h
t
a
m

[
 
 

2
v
2
6
3
3
0

.

3
0
6
1
:
v
i
X
r
a

ON BOUNDED-TYPE THIN LOCAL SETS OF THE TWO-DIMENSIONAL

GAUSSIAN FREE FIELD

JUHAN ARU, AVELIO SEPÚLVEDA, WENDELIN WERNER

Abstract. We study a certain class of local sets of the two-dimensional Gaussian free ﬁeld (GFF)
in a simply-connected domain, and their relation to the conformal loop ensemble CLE4 and its
variants. More speciﬁcally, we consider bounded type thin local sets (BTLS), where thin means
that the local set is small in size, and bounded-type means that the harmonic function describing
the mean value of the ﬁeld away from the local set is bounded by some deterministic constant.
We show that a local set is a BTLS if and only if it is contained in some nested version of the
CLE4 carpet, and prove that all BTLS are necessarily connected to the boundary of the domain.
We also construct all possible BTLS for which the corresponding harmonic function takes only two
prescribed values and show that all these sets are in fact measurable functions of the GFF.

1. Introduction

1.1. General introduction. Thanks to the recent works of Schramm, Sheﬃeld, Dubédat, Miller
(see [26, 5, 30, 12, 13, 14, 15] and the references therein), we know that many structures built using
Schramm’s SLE curves can be naturally coupled with the planar Gaussian Free Field (GFF). For
instance, even though the GFF is not a continuous function, SLE4 and the conformal loop ensemble
CLE4 can be viewed as “level lines” of the GFF. In these couplings, the notion of local sets of
the GFF and their properties turn out to be instrumental. This general abstract concept appears
already in the study of Markov random ﬁeld in the 70s and 80s (see in particular [23]) and can be
viewed as the natural generalization of stopping times for multidimensional time. More precisely, a
random set A coupled with a (zero-boundary) GFF in a planar domain D is said to be a local set
for this GFF, if the conditional distribution of the GFF in D \ A given A has the law of the sum
of a (conditionally) independent GFF ΓA in D \ A with a random harmonic function hA deﬁned in
D \ A. This harmonic function can be interpreted as the harmonic extension to D \ A of the values
of the GFF on ∂A.
In the present paper, we are interested in a special type of local sets that we call bounded type
thin local sets (or BTLS). Our deﬁnition of BTLS imposes three type of conditions, on top of being
local sets:

((cid:82)

(1) There exists a constant K such that almost surely, |hA| ≤ K in the complement of A.
(2) The set A is a thin local set in the sense deﬁned in [28, 33]. This means that the harmonic
function hA carries itself also all the information about the GFF also on A, in the sense
that for any smooth test function f, the random variable (Γ, f ) is almost surely equal to
D\A hA(x)f (x)dx) + ΓA(f ).
hood that does intersect no other connected component of A.

(3) Almost surely, each connected component of A that does not intersect ∂D has a neighbor-

If the set A is a BTLS with the constant K in the ﬁrst condition, we say that it is a K-BTLS.

The ﬁrst two conditions are the most important ones. The ﬁrst condition is of course highly
non-trivial. Notice that a deterministic non-polar set is not a BTLS because the corresponding
harmonic function is not bounded, so that a non-empty BTLS is necessarily random. As we shall
see, the second condition can be understood as a condition on the size of the set A (it can not be

1

too large) and can be compared in the previous analogy between local sets and stopping times to
requiring stopping times to be uniformly integrable.

The third condition implies in particular that A has only countably many connected components
that do not intersect ∂D. This is somewhat restrictive as there exist totally disconnected sets
Cantor sets A that are non-polar for the Brownian motion (for instance a Cantor set with Hausdorﬀ
dimension in (0, 1)), and can therefore have a non-negligible boundary eﬀect for the GFF. We
however believe that this third condition is not essential and could be disposed of (ie. all statements
would still hold without this condition), and we comment on this at the end of the paper.

We remark that the precise choice of deﬁnitions is not that important here. We see, in fact, that
the combination of these three conditions implies stronger statements. For instance, the (upper)
Minkowski dimension of such a K-BTLS A is necessarily bounded by some constant d(K) that is
smaller than 2 (and this implies the second condition), and that ∂D ∪ A has almost surely only one
connected component (which implies the third condition).
Non-trivial BTLS do exist, and the main examples are provided by SLE4, CLE4 and their variants
(for their natural coupling with the GFF) as shown in [5, 11, 26].
In this paper, among other
things, we prove that any BTLS A is contained in a nested version of CLE4 and that A ∪ ∂D is
necessarily connected. From our proofs it also follows that the CLE4 and its various generalizations
are deterministic functions of the GFF. Keeping the stopping time analogy in mind, one can compare
these results with the following feature of one-dimensional Brownian motion B started from the
origin: if T is a stopping time with respect to the ﬁltration of B such |BT| ≤ K almost surely, then
either T ≤ inf{t > 0 :
|BT| = K} almost surely, or T is not uniformly integrable. In other words,
the CLE4 and its nested versions and variants are the ﬁeld analogues of one-dimensional exit times
of intervals.

One important general property of local sets, shown in [26] and used extensively in [12], is that
when A and B are two local sets coupled with the same GFF, in such a way that A and B are
conditionally independent given the GFF, then their union A ∪ B is also a local set. It seems quite
natural to expect that it should be possible to describe the harmonic function hA∪B simply in terms
of hA and hB, but deriving a general result in this direction appears to be, somewhat surprisingly,
tricky. The present approach provides a way to obtain results in this direction in the case of BTLS:
we shall see that the union of two BTLSs is always a BTLS.

We plan to generalize in [3] some features of our approach to the imaginary geometry setting,
and hope that this might be of some help to enlighten some of the technical issues dealt with in
[12, 13, 14].

1.2. An overview of results. We now state more precisely some of the results that we shall derive.
All of the results we state in this section hold for a simply connected domain D.

Let us ﬁrst brieﬂy recall some features of the coupling between CLE4 and GFF in such a domain.
Using a branching-tree variant of SLE4 introduced by Sheﬃeld in [29], it is possible to deﬁne a
certain random conformally invariant family of marked open sets (Oj, j), where the Oj’s form a
disjoint family of open subsets of the upper half-plane, and the marks j belong to {−1, 1}. The
complement A of ∪jOj is called a CLE4 carpet (see Figure 1) and its Minkowski dimension is in
fact almost surely equal to 15/8 (see [19, 27]). As pointed out by Miller and Sheﬃeld [11], the set
A can be coupled with the GFF as a BTLS in a way that hA is constant and equal to 2λj in each
Oj.
By the property of local sets, conditionally on A, the ﬁeld Γ−hA consists of independent Gaussian
free ﬁelds Γj inside each Oj. We can then iterate the same construction independently for each of
these GFFs Γj, using a CLE4 in each Oj. In this way, for each given z ∈ H, if we deﬁne O1(z) to be
the open set Oj that contains z (for each ﬁxed z, this set almost surely exists) and set 1(z) = j, we
then get a second set O2(z) ⊂ O1(z) corresponding to the nested CLE4 in O1(z) and a new mark

2

Figure 1. The set in black represents the CLE4 carpet and the white holes are
the open sets Oj.

Simulation by David B. Wilson.

m=1 m(z) is a simple random walk.

each z ∈ D, the sequence Υn(z) =(cid:80)n

2(z). Iterating the procedure, we obtain for each given z, an almost surely decreasing sequence of
open sets On(z) and a sequence of marks n(z) in {−1, +1}. When z(cid:48) ∈ On(z), then On(z(cid:48)) = On(z)
and n(z(cid:48)) = n(z), so that n(·) can be viewed as a constant function in On(z). Furthermore, for
For each n, the complement An of the union of all On(z) with z ∈ Q2 ∩ D is then a BTLS and
the corresponding harmonic function hn is just 2λΥn(·). The set An is called the nested CLE4 of
level n (we refer to it as CLE4,n in the sequel). It is in fact easy to see that one can recover the
GFF Γ from the knowledge of all these (An, hn) for n ≥ 1 (because for each smooth test function
f, the sequence (Γ − hn)(f ) converges to 0 in L2).
For each integer M ≥ 1, one can then deﬁne for each z in H, the random variable M (z) to
be the smallest m at which |Υm(z)| = M. As for each ﬁxed z, the sequence (Υn(z)) is just a
simple random walk, M (z) is almost surely ﬁnite. The complement AM of the union of all these
OM (z)(z) for z with rational coordinates deﬁnes a 2λM-BTLS: Indeed, the corresponding harmonic
function is then constant in each connected component OM (z)(z) and takes values in {2M λ,−2M λ},
and we explain in Section 4) that the Minkowski dimension of AM is almost surely bounded by
d = 2 − (1/(8M 2)) < 2 which imply the thinness. We refer to this set AM as a CLEM
(mind that
4
M is in superscript, as opposed to CLE4,m, where we just iterated m times the CLE4).

A special case of our results is that this CLEM
4

is the only BTLS with harmonic function taking

its values in {−2M λ, 2M λ}. More precisely:
Proposition 1. Suppose that A is a BTLS coupled to the same GFF as a CLEM
4 , and such that
the corresponding harmonic function hA takes values in {−2M λ, 2M λ}. Then, A is almost surely
equal to the CLEM
4 .
In particular, for M = 1 and taking A to be another CLE4 coupled with the same GFF, this
means that any two CLE4 that are coupled with the same GFF as local sets are almost surely
identical. This BTLS approach therefore provides a rather short proof of the fact the ﬁrst layer

3

CLE4 and all nested CLE4,m are deterministic functions of the GFF (hence, that the information
provided by the collection of nested labelled CLE4,m’s is equivalent to the information provided by
the GFF itself). This fact is not new and is due to Miller and Sheﬃeld [11], who have outlined
the proof in private discussions, presentations and talks (and a paper in preparation). Our proof
follows a slightly diﬀerent strategy than the one proposed by Miller and Sheﬃeld, with a diﬀerent
angle, although the basic ingredients are very similar (absolute continuity properties of the GFF,
basic properties of local sets and the fact that SLE4 itself is a deterministic function of the GFF).
Let us stress that here and in subsequent propositions, the condition of being thin is necessary.
Indeed, if we consider the union of a CLE4 with, say, the component of its complement that contains
the the origin, we still obtain a local set for which the corresponding harmonic function is in
{−2M λ, 2M λ}, yet it is almost surely clearly not contained in any of the CLEM
4 .
prescribed values, and study their properties:
Proposition 2. Let us consider −a < 0 < b.

We also characterize all possible BTLS such that the harmonic function can take only two possible

way that hA ∈ {−a, b}. Moreover, the sets A−a,b are

(1) When a + b < 2λ, it is not possible to construct a BTLS A with hA ∈ {−a, b}.
(2) When a + b ≥ 2λ, it is possible to construct a BTLS A−a,b coupled with a GFF Γ in such a
• Unique in the sense that if A(cid:48) is another BTLS coupled with the same Γ, such that for
all z ∈ D, hA(cid:48)(z) ∈ {−a, b} almost surely, then A(cid:48) = A−a,b almost surely.
• Measurable functions of the GFF Γ that they are coupled with.
• Monotonic in the following sense: if [a, b] ⊂ [a(cid:48), b(cid:48)] and −a < 0 < b with b + a ≥ 2λ,
then almost surely, A−a,b ⊂ A−a(cid:48),b(cid:48).

as well as some generalizations are discussed in Section 6.

Further information about the sets A−a,b and their properties (detailed construction, dimensions)
Another type of result that we derive using similar ideas as in the proof of Proposition 1 goes as

follows:
Proposition 3. If A is a (2M λ)-BTLS associated to the GFF Γ, A is almost surely a subset of the
CLEM +1

associated to Γ.

4

4

Notice that one would expect to conclude that A ⊆ CLEM

in the proposition (and this would
mean that CLEM
4 is maximal among all 2λM-BTLS), but this seems to require some more technical
work that we do not discuss in the present paper. As an immediate consequence, we see that the
ﬁnite union of BTLS is almost surely contained in some CLEM
for some given M, and that it is
4
again a BTLS. This type of facts helps to derive the above-mentioned fact:
Proposition 4. If A is a BTLS, then A ∪ ∂D is connected.

The structure of the paper is the following: We ﬁrst recall some basic features about BTLS. Then,
we consider generalized level lines of the GFF and discuss a useful result about their boundary
hitting behaviour. Thereafter, we recall features of the construction of the coupling of the GFF
with CLEM
4 . We then ﬁnally
4 . This sets the stage for the proofs of the propositions involving CLEM
turn to Proposition 2 and the discussion about the dimension of the sets A−a,b.

2. Local sets and BTLS

In this section, we quickly browse through basic deﬁnitions and properties of the GFF and of
bounded-type local sets. We only discuss items that are directly used in the current paper. For a
more general discussion of local sets, thin local sets (not necessarily of bounded type), we refer to
[28, 33].

4

Throughout this paper, the set D denotes an open planar domain with a non-empty and non-
polar boundary. By conformal invariance, we can always assume that D is a subset of the unit disc
D. The most general case that we work with are domains D such that the complement of D has at
most countably many connected components with only ﬁnitely many components in each compact
set and no complement being a singleton (this is a non-trivial condition as it excludes for instance
sets like D \ K, where K ⊂ [0, 1] is the middle Cantor set). Recall that by a theorem of He and
Schramm [9], such domains D are known to be conformally equivalent to a circle domain (i.e. to
D \ K, where K is a union of closed disjoint discs).
Recall that the (zero boundary) Gaussian Free Field (GFF) in a domain D can be viewed as a
centered Gaussian process Γ (we also sometimes write ΓD when we the domain needs to be speciﬁed)
indexed by the set of continuous functions with compact support in D, with covariance given by

E[(Γ, f )(Γ, g)] =

f (x)GD(x, y)g(y)dxdy

(cid:90)(cid:90)

D×D

(cid:112)

λ =

π/8.

where GD is the Green’s function (with Dirichlet boundary conditions) in D, normalized such that
GD(x, y) ∼ (2π)−1 log(1/|x − y|) as x → y. For this choice of normalization of G (and therefore of
the GFF), we set

random variable Γ(µ) for any ﬁxed Borel measure µ, provided the energy(cid:82) µ(dx)µ(dy)GD(x, y) is
Sometimes, other normalizations are used in the literature: If GD(x, y) ∼ c log(1/|x− y|) as x → y,
then λ should be taken to be (π/2) × √c. Note that it is in fact possible and useful to deﬁne the
ﬁnite.

Similarly to Brownian motion, the GFF can be also viewed as the Gaussian measure associated
0, which is the closure of the set of smooth functions of compact support

to the Dirichlet space H1
in D with respect to the Dirichlet norm

(cid:90)(cid:90)

(f, f )∇ =

D×D ∇f (x)∇f (y)dxdy.

The Dirichlet space is also the Cameron-Martin space for the GFF; in particular the law of Γ + F
is absolutely continuous with respect to the law of Γ whenever F ∈ H1
0, and the Radon-Nikodym
derivative is given by a constant multiple of exp((Γ, F )∇), see e.g. [5, 30].
The covariance kernel of the GFF blows up on the diagonal, which makes it impossible to view
Γ as a random function. It can, however, be shown that the GFF has a version that lives in some
space of generalized functions, what justiﬁes the notation (Γ, f ) for Γ acting on functions f (see for
example [5]). However, it is not possible to make sense of (Γ, f ) when f = 1A is a the indicator
function of an arbitrary random set A. Local sets form a class of random sets where this is (in a
sense) possible:
Deﬁnition 5 (Local sets). Consider a random triple (Γ, A, ΓA), where Γ is a GFF in D, A is a
random relatively closed subset of D (i.e. D \ A is open) and ΓA a random distribution that can
be viewed as a harmonic function when restricted to D \ A. We say that A is a local set for Γ if
conditionally on A, Γ − ΓA is a GFF in D \ A.

Notice that being a local set can also be seen as a property of the law of the couple (A, Γ), as

one can recover ΓA as the conditional expectation of Γ given A.

Let us list a few properties of local sets (see for instance [26] for derivations and further properties):

Lemma 6.

(1) Any local set can be coupled in a unique way with a given GFF: if two random triples
(Γ, A, ΓA) and (Γ, A, Γ(cid:48)A) are both local couplings, then ΓA and Γ(cid:48)A are almost surely identical.

5

(2) When A and B are local sets coupled with the same GFF Γ, and that (A, ΓA) and (B, ΓB)

are conditionally independent given Γ, then A ∪ B is also a local set coupled with Γ.

We now deﬁne local sets of bounded type:

Deﬁnition 7 (BTLS). Consider a random relatively closed subset A of D (i.e. so that D \ A is
open) and Γ a GFF deﬁned on the same probability space. Let K ∈ R+, we say that A is a K-BTLS
if the following four conditions are satisﬁed:

(1) A is a local set of Γ.
(2) Almost surely, |hA| ≤ K in D \ A.
(3) Almost surely, each connected component of A that does not intersect ∂D has a neighborhood

that does intersect no other connected component of A.

the random variable (Γ, f ) is almost surely equal to ((cid:82)

(4) A is a thin local set in the sense deﬁned in [28, 33]: for any smooth test function f ∈ C∞0 ,

D\A hA(x)f (x)dx) + ΓA(f ).

If A is a K-BTLS for some K, we say that it is a BTLS.

Note also that it is in fact possible to remove all isolated points from a BTLS (of which there
are at most countably many because of the third property) without changing the property of being
BTLS. Indeed, the bounded harmonic function hA can be extended to those points and a GFF does
not see polar sets. We therefore replace the third property by:

(3’): Almost surely, A contains no isolated points and each connected component of A that
does not intersect ∂D has a neighborhood that does intersect no other connected component
of A.

This reformulation will be handy to keep our statements simple.

It is not hard to see that in the case where the harmonic function is bounded, the condition
of being thin given above is equivalent to saying that for the upper dyadic approximation [A]n
of A, and for any smooth test function f, the sequence of random variables (Γ, f 1[A]n) converges
in probability to 0. From a Borel-Cantelli argument, one can moreover see that this equivalent
condition is implied by (see [28, 33]):

(∗): The expected volume of the -neighborhood of A decays like o(1/ log(1/)) as  → 0.

Note that if A and B are two BTLS that are coupled with the same GFF Γ, and that are
conditionally independent given Γ, then we know by Lemma 6 that A ∪ B is a local set. Hence, in
order to check that A ∪ B is a BTLS, we need to show it is thin and give an upper bound for the
harmonic function hA∪B.

It is not hard to derive the following related fact:

Lemma 8. Let A be a thin local set that satisﬁes the condition (3’) of Deﬁnition 7, and let A(cid:48) be
a K-BTLS coupled with the same GFF in such a way that A ⊆ A(cid:48) almost surely. Then A is a
K-BTLS.
Proof. One just has to check that |hA| ≤ K. For any smooth ρ with compact support have that
E[(Γ, ρ)|A, ΓA] = ΓA(ρ) and E[(Γ, ρ)|A, A(cid:48), ΓA(cid:48)] = ΓA(cid:48)(ρ) almost surely. Now as ΓA is harmonic in
D\ A, we have that for any z ∈ D\ A and any radially symmetric ρz of unit mass and with support
inside D \ A, ΓA(z) = ΓA(ρz). The claim now follows from Jensen’s inequality for conditional
(cid:3)
expectations.

After showing that any BTLS is contained in some CLEM

4 and checked that CLEM

4

satisﬁes

indeed (∗), this lemma is used to show the union of any two BTLS is a again a BTLS.
CLEM
4 :

The following lemma is very useful in our proof of the fact that any BTLS is contained in some

6

E

hA∪B(1O)2 +

O×O

GD\(A∪B)(x, y)dxdy

1{O⊂A+}

.

Lemma 9. Let A and B are two BTLS coupled to the same GFF and suppose that almost surely,
A satisﬁes condition (∗). Then, if almost surely, for all z /∈ A ∪ B, |hA(z)| ≥ |hA∪B(z)|, we have
that almost surely B ⊆ A.
Proof of Lemma 9: First, let us brieﬂy explain why the conditions on A and B imply that A ∪ B
is a thin local set. We know that A ∪ B is local. To show that A ∪ B is thin, we use the equivalent
condition mentioned above. Indeed, note that (Γ, f 1[A∪B]n) can be written as the sum of (Γ, f 1[B]n)
and (Γ, f 1[A]n\[B]n). The ﬁrst term converges to 0 thanks to the deﬁnition and the second one thanks
to condition (∗). We refer to [28] for a more detailed discussion.
Now we know that Γ = hA + ΓA = hA∪B + ΓA∪B, and we know the conditional distribution of ΓA
(resp. ΓA∪B) given the σ-ﬁeld A generated by (A, hA) (resp. the σ-ﬁeld B = σ(B, A, hA, hB, hA∪B)
– the fact that one can use this larger σ-ﬁeld instead of σ(A ∪ B, hA∪B) follows directly from the
) the set of points in D \ A
proof of the fact that A ∪ B is local). We also denote by A+ (resp. A−
(cid:3)
(cid:3) = E(cid:2)E(cid:2)(hA(1O) + ΓA(1O))2|A(cid:3) 1{O⊂A+}
where hA is non-negative (resp. non-positive). Then, for any open set O,
(cid:19)
(cid:21)

E(cid:2)(Γ, 1O)21{O⊂A+}
(cid:20)(cid:18)

Similarly, by conditioning on B, one gets that this same quantity is equal also to

GD\A(x, y)dxdy

(cid:20)(cid:18)
(cid:90)

1{O⊂A+}

hA(1O)2 +

(cid:21)

.

= E

(cid:19)

(cid:90)

O×O

But by deﬁnition, when O ⊂ A+, hA(1O) ≥ |hA∪B(O)| (because hA(x) ≥ |hA∪B(x)| for all x ∈ A+).
Hence, using the fact that GD\(A∪B) ≤ GD\A, we conclude that for every open set, almost surely
instead of
on the event O ⊂ A+, GD\(A∪B) = GD\A on O × O. The same statement holds for A−
(cid:3)
A+. Therefore B \ A is polar in D \ A and condition (3’) allows us to conclude.

3. GFF, level lines and absolute continuity

3.1. SLE4 background. Let us ﬁrst recall some well-known features of the Schramm-Sheﬃeld
coupling of SLE4 with the GFF in the upper half-plane H.
Consider the bounded harmonic function F0(z) in the upper-half plane with boundary values −λ
and +λ on R+. Suppose that (η(t), t ∈ [0, τ )) is a random simple curve deﬁned in the closed
on R
−
upper half-plane, such that η(0) = 0, η(0, τ ) ⊂ H and the time τ is the (possibly inﬁnite) smallest
positive time t at which lim inf s→t− d(ηs, R) = 0. Then, there exists a unique way to couple η with
a GFF Γ in such a way that the following property holds (we state it in a somewhat strange way
that will be easier to generalize):

−

(∗∗): For all t, the set η[0, min(t, τ )] is a BTLS of the GFF Γ, with harmonic function ht
deﬁned as follows: ht + F0 is the unique bounded harmonic function in H \ η[0, min(t, τ )]
with boundary values −λ on the left-hand side of η, +λ on the right side of η, and with the
same boundary values as F0 on R
Furthermore, this curve is then a SLE4 (and τ = ∞ almost surely), and when one couples SLE4
with a GFF Γ in this way, then the SLE4 process is in fact a measurable function of the GFF (see
[5, 12, 26, 30, 33] for all these facts).

and R+.

This statement can be generalized to more general harmonic functions F , which gives rise to

SLE4(ρ)-type processes. See for instance [22].
3.2. GFF absolute continuity. Let D = H \ K, where K is a countable union of closed discs
such that in any compact set there are only ﬁnitely many of them. Consider a ﬁnite union S of
closed dyadic squares in D with I := ∂S ∩ R (cid:54)= ∅, and a harmonic function H in D such that H

7

extends continuously to an open neighborhood I(cid:48) of I in R in such a way that H = 0 on I(cid:48) (we then
say that the boundary value of H on I is zero).

Using absolute continuity properties of the GFF, it is not hard to see that the GFF Γ and Γ + H
are mutually absolutely continuous, when restricted to S (the proof of the following lemma can be
found for example in [5, 30]):
Lemma 10. Let Γ be a (zero boundary) GFF in D and denote its law restricted to S by P. Let also
˜P be the law of Γ + H, restricted to S. Then P and ˜P are mutually absolutely continuous with respect
to each other. Moreover, the Radon-Nikodym derivative d˜P/dP is a multiple of exp(( ˜H, Γ)∇) where
˜H is the bounded harmonic function in D\∂S that is equal to H on the boundary of S and to zero
on the boundary of D.
Furthermore, if D(cid:48) is another domain as above, Γ(cid:48) is a GFF in D(cid:48) and S ⊆ D ∩ D(cid:48) is at positive
distance of ∂D(cid:52)∂D(cid:48), then the laws of Γ and Γ(cid:48) restricted to S are mutually absolutely continuous.
This absolute continuity property allows to change boundary conditions for local couplings away

from the local sets:
Proposition 11. Under the previous conditions, suppose that A is a BTLS for Γ an D-GFF such
that A ⊂ S ⊂ D almost surely. Deﬁne ˜P := Z exp(( ˜H, Γ)∇)dP. Then A is coupled as a local set
with ˜Γ := Γ− ˜H (that is a ˜P zero-boundary GFF). The corresponding harmonic function ˜hA is equal
to the unique bounded harmonic function on D \ A such that ˜hA + H − hA goes to 0 on ∂A∪ I, and
that ˜hA goes to 0 on ∂D \ I.
Proof. Notice that by the Cameron-Martin Theorem for the GFF (see Section 2), the law of Γ under
˜P is that of ˜Γ + ˜H, where ˜Γ is a ˜P GFF. Now we have to verify that with this change of variables
A is still a local set. Note that conditioned to (A, hA) we can write Γ = hA + ΓA, where ΓA is a
P-GFF on D\ A. We have to show that under ˜P, we can write ΓA = ˜ΓA + ˜H + ˜hA − hA, where ˜ΓA is
a ˜P-GFF on D\ A and ˜hA is the unique bounded harmonic function on H\ A such that ˜hA + H − hA
goes to 0 on ∂A ∪ I, and that ˜hA goes to 0 on ∂D \ I. Let M be a measurable function of the ﬁeld
ΓA, then

(cid:17)

(cid:105)

M (ΓA) exp

M (ΓA) exp

M (ΓA) exp

(cid:17)

(cid:105)
( ˜H, Γ)∇
| A, ΓA
( ˜H, ΓA)∇
| A, ΓA
( ˜H + ˜hA − hA, ΓA)∇

(cid:17)

(cid:105)

,

| A, ΓA

˜E(cid:2)M (ΓA) | A, hA

(cid:3) = ZAE(cid:104)
= ¯ZAE(cid:104)
= ¯ZAE(cid:104)

(cid:16)
(cid:16)
(cid:16)

where in the last equality we use that ΓA is a GFF and that ˜hA − hA is harmonic in D \ A.
But, we know that (under P), conditionally on (A, ΓA), ΓA is just a GFF. Thus using again the
(cid:3)
Cameron-Martin Theorem and Lemma 6-(i), we can conclude.
Corollary 12. Let D(cid:48) ⊆ D be another domain with the same properties. Under the previous
conditions, suppose that A is a BTLS for a GFF in D such that A ⊂ S ⊂ D(cid:48) almost surely. Then,
there exist an absolutely continuous probability measure ˜P under which A is coupled as a local set
with a ˜P zero-boundary GFF in D(cid:48) and the corresponding harmonic function ˜hA is equal to the
unique bounded harmonic function in D(cid:48) such that ˜hA + H − hA goes to 0 on ∂A ∪ I, and that ˜hA
goes to 0 on ∂D(cid:48) \ I.
Proof. It can be shown that A is a local set for ΓD\D(cid:48) such that its harmonic function (hD\D(cid:48)
goes to 0 on ∂D \ I and (hD\D(cid:48)
We conclude using the fact that hD\D(cid:48) is independent of hD\D(cid:48) and Proposition 11.

)A
)A − hA + hK goes to 0 on ∂A ∪ I (see Lemma 3.9-1 of [26], or [33]).
(cid:3)

8

3.3. SLE/GFF absolute continuity. Let D be as above and let H be a harmonic function on
D with zero boundary conditions on some real neighbourhood I of the origin. Then we can deﬁne
the generalized level line for the GFF in D with boundary conditions F0 + H up to the ﬁrst time it
hits the boundary:
Lemma 13 (Generalized level line). There exists a unique and measurable simple curve η coupled
with the GFF in such a way that (∗∗) holds when one replaces F0 by F0 + H and considers D instead
of H. We call η the generalized level line of Γ + F0 + H in D.
Proof. Let S denote the collection of regions S such that S is a ﬁnite union of closed dyadic squares
in D with 0 ∈ ∂S ∩ ∂D ⊂ I and with S simply connected. Note that is enough to show that for all
S ∈ S there is at most one curve satisfying (∗∗), when one replaces F0 by F0 + H, until the time it
exits S. Indeed, suppose by contradiction that η1 and η2 are two diﬀerent curves with this property
and that with positive probability they do not agree. Thanks to Corollary 12, we can construct
two local sets ˜η1 and ˜η2 coupled with the same GFF in a simply connected domain D(cid:48) ⊆ D such
that when we apply φ, the conformal transformation from D(cid:48) to H, (∗∗) holds for φ(˜η1) and φ(˜η2)
until the time they exit H. The fact that they are diﬀerent with positive probability contradicts the
uniqueness of the Schramm-Sheﬃeld coupling proved in citeDub,SchSh2.

It remains to show the existence of this curve. Take Sn an increasing sequence of elements in
S such that their union is D. We can deﬁne η until the time it exits Sn, by using the Schramm-
Sheﬃeld coupling and Proposition 12. The above argument shows that they are compatible and so
we can deﬁne η until the ﬁrst time it touches ∂D. The measurability is just a consequence of the
(cid:3)
existence and uniqueness.
In [22] Lemma 3.1, the authors show that a generalized level line in H corresponding to F0 + H0
with H0 zero in a neighbourhood of the origin, F0 + H0 ≥ −λ on (−c, 0) and F0 + H0 ≥ λ elsewhere
cannot touch R \ [−c, 0] in ﬁnite time. Combined with our previous considerations, we extend this
to:
Lemma 14 (Boundary hitting of generalized level lines). Let η be a generalized level line of Γ +
F0 + H in D such that H is harmonic in D and has zero boundary values in a neighbourhood I of
zero. Suppose F0 + H ≥ λ in some neighbourhood J of x ∈ ∂D. Let τ denote the ﬁrst time at which
inf{d(ηs, J), s < t} = 0. Then the probability that τ < ∞ and that η(t) converges to a point in J as
t → τ− is equal to 0. This also holds if F0 + H ≤ −λ in (x − , x + ) and more generally for any
open neighbourhood of x on ∂D with similar conditions.
Proof. Let S be a ﬁnite union of closed dyadic squares in the upper half-plane with 0 ∈ ∂S, x ∈ ∂S,
∂S ∩ ∂D ⊂ I ∪ J and S ∩ K = ∅. From Lemma 13 we know that for any such S, a generalized
level line η is measurable up to leaving S w.r.t. the GFF restricted to S. We ﬁrst consider the case
x ∈ R and suppose x < 0.
Deﬁne a harmonic function H0 on H such that H0 = H on (x − , x + ), H0 = 0 on [x + ,∞)
and H0 = 2λ on (−∞, x− ]. Then GFFs Γ + F0 + H0 and Γ + F0 + H restricted to S are absolutely
continuous by Lemma 10. Also, both of these generalized level lines are measurable w.r.t. the GFF
until they exit S. Now F0 + H0 satisﬁes the conditioned mentioned above and hence almost surely
the generalized level line of Γ + F0 + H0 does not exit from S on S ∩ (x − , x + ) in ﬁnite time.
By absolute continuity and measurability of both generalized level lines, the result follows.
The case x > 0 is treated similarly. To treat the case where x is on the boundary of some
component D1 of K, notice that it suﬃces to consider S that do not surround D1 and that for any
such S we can connect D1 to R using some curve γ such that H \ (D1 ∪ γ) is simply connected and
contains S. The previous argument and Corollary 12 show that η cannot leave S through S ∩ J in
(cid:3)
ﬁnite time.

9

Figure 2. Deﬁning generalized level lines by absolute continuity.

4. A construction of CLEM
4

and its coupling with the GFF

In this section, we review the coupling of the GFF with the nested CLE4 using Sheﬃeld’s SLE4
exploration trees (i.e. the branching SLE4(−2) process). As this section does not contain really
new results, we try to be rather brief, and refer to [29, 33] for details. Note that we also provide an
alternative construction of CLE4 and its coupling to the GFF in Section 6.

0 cot(Bs)ds.

4.1. Radial symmetric SLE4(−2). Let us ﬁrst recall the deﬁnition of the radial (symmetric)
It is the radial Loewner
SLE4(−2) process targeted at 0 (for non-symmetric variants see [29]).
chain (Kt)t≥0 in the unit disc, with driving function ξt deﬁned as follows:

viewed as an usual absolutely converging integral. Yet, one can for instance deﬁne ﬁrst U 
integral of 1{d(Bs,πZ)≥} cot(Bs) and show that these approximating processes U 
a continuous processes Ut. See e.g. [34] for a discussion of the chordal analogue.

• Start with a standard real-valued Brownian motion (Bt, t ≥ 0) with B0 = 0.
• Finally, set Wt = 2Bt + Ut and ξt := exp(iWt).

• Then, deﬁne the continuous process Ut :=(cid:82) t
Notice that as the integral(cid:82) t
We set Dt = D \ Kt, and denote by ft to be the conformal maps from Dt onto D normalized at the
origin.
0 | cot(Bs)|ds is almost surely inﬁnite, the deﬁnition of Ut can not be
t as the
t converge in L2 to
We now describe some properties of the hulls generated by the radial SLE4(−2). For more details,
(1) The process Ot := exp(iUt) describes the evolution of the marked point in the SLEκ(ρ)
In particular, SLE coordinate change considerations (see [4, 27]) show that
framework.
during the time-intervals during which Bt is not in πZ, the process behaves exactly like a
chordal SLE4 targeting the boundary prime end f−1
(2) It is therefore clear that during the open time-intervals at which B is not in πZ, the Loewner
chain is generated by a simple continuous curve. These excursions of B away from πZ
correspond to the intervals during which the SLE4(−2) traces “quasi-loops”: If (t0, t(cid:48)0) is
an excursion interval away from πZ, then γ(t0, t(cid:48)0) is the image of a loop from ξt0 to itself
in D via f−1
, then this quasi-loop does not surround the origin, when
= Bt0 ± π, it surrounds the origin clockwise or anti-clockwise. We stress that during
Bt(cid:48)
the time-interval corresponding to excursions of B away from πZ the tip of the Loewner
chain does not touch its past boundary and at the end of the excursion it accumulates at
the prime end corresponding to the starting point.

. When Bt0 = Bt(cid:48)

0

t0

(Ot) in the domain Dt.

t

see [29, 32, 34]:

0

10

0λ−λ−λλ−λ−λλλ−λλ0λ−λ−λ−λλλ−λλ−λ+Hλ+HF0+HF0+HF0+HF0+HF0+HFigure 3. Sketch of Dt0, the stretch γ(t0, t]. The harmonic measure from 0 of the
“top part” of γ[t0, t] corresponds to Bt. This loop corresponds to an excursion away
from πZ by each of B, Bz and Bz(cid:48). It corresponds to an increase of π for B and for
Bz, but not for Bz(cid:48). The end-time of this loop is σ(z, z(cid:48)).

(3) It is also possible to see (via the loop-soup construction of CLE4, see [31]) that these quasi-
loops are in fact proper loops (i.e. that f−1
t0 (ξt0) is a proper boundary point), but we do
not, in fact, need this fact in the present paper. In fact, it can be shown that the whole
SLE4(−2) is generated by a two-dimensional curve, see [16].
For any other z ∈ D, one can deﬁne the radial SLE4(−2) from 1 to z in D to be the conformal
image of the radial SLE4(−2) targeting the origin, by the Moebius transformation of the unit disc
that maps 0 to z, and 1 onto itself. This is now a Loewner chain growing towards z, and it is
naturally parametrized using the log-conformal radius seen from z.

Moreover the radial SLE4(−2) processes for diﬀerent target points can be coupled together in
a nice way. This target-invariance feature was ﬁrst observed in [4, 27], and is closely related to
the decompositions of SLE4(−2) into SLE4 “excursions” mentioned in (1). It says that for any z
and z(cid:48), the SLE4(−2) targeting z and z(cid:48) can be coupled in such a way that they coincide until
the ﬁrst time σ(z, z(cid:48)) at which z(cid:48) gets disconnected from z for the chain targeting z and evolve
independently after that time. Note that in this coupling, the natural time-parametrizations of
these two processes do not coincide. However, using the previous observation about the relation
between the excursions of B and the intervals during which the SLE4(−2) traces a simple curve,
we see that up to time σ(z, z(cid:48)) the excursion intervals away from πZ by the Brownian motions used
to generate the SLE4(−2) processes targeting z and z(cid:48) correspond to each other. The time-change
between the two Brownian motions can be calculated explicitly. For instance, if we deﬁne Bz
t to be
the process obtained by time-changing the Brownian motion used in the construction that targets
z via the log-conformal radius of Dt seen from 0 (instead of z), then as long as t < σ(z, 0),

where by P z we denote the Poisson kernel in D seen from z and targeted at ξt (it follows from the
Hadamard formula given below).

11

dBz

t := 2πP ft(z)dBt

ozz0γtDt04.2. SLE4(−2) branching tree and CLE4. The target-invariance property of SLE4(−2) leads to
the construction of the radial SLE4(−2) branching-tree. We next summarize its deﬁnition and its
main properties:
• For a given countable dense collection Z of points in D, it is possible to deﬁne on the same
probability space a collection of radial SLE4(−2) processes in such a way that for any z and
z(cid:48), they coincide (modulo time-change) up to the ﬁrst time at which z and z(cid:48) get disconnected
from each other, and behave independently thereafter.
• For any z consider the ﬁrst time τz at which the underlying driving function driving function
exits the interval (−π, π) and deﬁne O(z) to be the complement of Kt at that time containing
z. Deﬁne O(z(cid:48)) similarly. The previous property shows that z(cid:48) ∈ O(z) if and only if
z ∈ O(z(cid:48)).
• The CLE4 carpet is then deﬁned to be the complement of ∪z∈ZO(z). In the sequel, we just
write CLE4 to denote this set (i.e. we call CLEs to be the random fractal sets, not the
collection of loops).

Notice that from the construction, it is not obvious that the law of the obtained CLE4 (and its
nested versions) does not depend on the choice of the starting point (here 1) on ∂D (ie. of the
root of the exploration tree). However, Propositions 1 and 2 provide one possible proof of the fact
that this choice of starting point does not matter (this is also explained in [34], using the loop-soup
construction of [31]). This justify a posteriori that when one iterates the CLE4 in order to construct
the nested versions, one does in fact not need to specify where to continue the exploration.

On the other hand, from this construction it is easy to estimate the expected area of the -
neighborhood of CLE4 and to see that the upper Minkowski dimension of CLE4 is almost surely
not greater than 15/8 = 2 − 1/8. This follow from arguments in [27]: One wants to estimate the
probability that d(z, CLE4) < r. By conformal invariance it is enough to treat the case where z is
the origin in the unit dicc. But we can note that the conformal radius of Dt (in the SLE4(−2)) is
comparable to d(0, ∂Dt) by Koebe’s 1/4-Theorem, and that the log-conformal radius of D \ CLE4
from the origin is just minus the exit time of (−π, π) by the Brownian motion B which is a well-
understood random variable (see [21] for instance). Hence, the asymptotic behavior as r → 0 of the
probability that d(0, CLE4) < r can be estimated precisely.
One can also prove the somewhat stronger statement that the Hausdorﬀ dimension CLE4 is in
fact equal to 15/8, by using second moment bounds (ie. bounds on the probability that two points
z and z(cid:48) are close to CLE4), see [19].

The nested CLE4,m and CLEM

4 can then be deﬁned by appropriately iterating independent CLE4
carpets in the respective domains O(z) (starting the explorations in the nested domains at the point
where one did just close the loops). The deﬁnition of CLEM
is almost word for word the same, just
4
replacing τ (z) by τM (z) which is the ﬁrst time at which the underlying Brownian motion B exits
the interval (−M π, M π). A similar argument then shows that the upper Minkowski dimension of
CLEM
is not greater than 2 − (1/(8M 2)) (the M 2 term is then just due to Brownian scaling – the
4
exit time of (−M π, M π) by Brownian motion is equal in distribution to M 2 times the exit time of
(−π, π)).
4.3. Coupling with the GFF. To explain the coupling CLE4 with the GFF, we can ﬁrst describe
the coupling of a single radial SLE4(−2) process with a GFF. The whole coupling then follows
iteratively from the strong Markov property and from the branching tree procedure. The proof of
the coupling of the radial SLE4(−2) follows the steps of the coupling of the usual SLE4 with the
GFF, as explained for instance in [26, 30]. It is based on the following observations:
(1) The Hadamard formula (see for instance [10]) gives the time-evolution of the Green’s function
under Loewner ﬂow: for any two points x and y in D, the Green’s function GDt(x, y) evolves

12

until min(σ(z, 0), σ(w, 0) according to

dGDt(z, w) = −2πP ft(z)P ft(w)dt,

where by P z we denote the Poisson kernel in D seen from z and targeted at ξt as before.
(2) The cross-variation d(cid:104)Bz, Bw(cid:105)t between the two local martingales Bz and Bw is equal to

4π2P ft(z)P ft(w)dt, so that

dGDt(z, w) = −

1
2π

d(cid:104)Bz, Bw(cid:105)t.

(3) We can interpret |Bz

boundary arc between the tip of the curve and the force point Ut (the sign of Bz
which of the two arcs one considers).

t |/π (up to τ (z)) as the harmonic measure in Dt seen from z, of the
t describes

One can the ﬁrst couple the GFF with the radial SLE4(−2) up to the ﬁrst time at which it surrounds
the origin, exactly following the arguments of [30]. This deﬁnes a BTLS with harmonic function in
{−2λ, 0, 2λ}. For those domains where the harmonic functions are zero, one can then continue the
SLE4(−2) iteration targeting another well-chosen point in that domain and proceed.
This radial construction is arguably also the easiest one to explain that in fact, conditionally on
the CLE4, the labels j are i.i.d. This is then just a consequence of the time-reversal of SLE4, so
that changing the orientation of the quasi-loop that traces the boundary of Oj corresponds to a
measure-preserving transformation of the driving Brownian motion (see for instance [34]). We come
back to this in Paragraph 6.2.3.

5. Comparisons of BTLS with CLEM
4

We now derive Proposition 3, Proposition 1 and Proposition 4. In some sense, this section is the

core of the present paper.

Here D always denote a simply connected planar domain with non-empty boundary (so that the

previous deﬁnition of CLE4 makes sense).
5.1. Proof of Proposition 3. Let us ﬁx a point z, and consider the radial SLE4(−2) process
targeted at z that is coupled with the ﬁeld (and with the CLEM +1
) as described before. If O(z) (cid:54)⊂
OM +1(z), then at some rational time (for the radial SLE’s parametrization), this radial SLE is
drawing some piece of ∂OM +1(z) within O(z).

We therefore consider a ﬁxed rational time q, and consider the event Eq that the radial SLE4(−2)

process targeting z, stopped at τM +1(z), has the following properties:

4

• It is tracing a loop.
• Its tip is in O(z).
• Its boundary values are either 2λM or 2λ(M + 1)

boundary.

Let U denote the connected component of the complement of O(z) \ Kq that has ηq on its
Then, conditionally on Eq, A and (Ks, s ≤ q), the evolution of η after q is that of a generalized
level line in U that traces a 2λM versus 2λ(M + 1) interface for the GFF with boundary values
depicted in Figure 4, until the ﬁrst time at which this level-line hits the boundary of U again. From
Lemma 14, it then follows that it can not exit U through some point of (∂O(z))\ Kq because of the
boundary values of the ﬁeld there. Hence, the domain that this generalized level line after closing
itself is almost surely included inside O(z). In particular, if it happens that this domain contains z,
that contains z has ∂OM +1(z)
then the connected component of the complement of A ∪ CLEM +1
as its outer boundary, and maybe some inner boundaries (that are part of ∂O(z) – this can happen
only if O(z) is not simply connected). Importantly, the intersection of ∂OM +1(z) and ∂O(z) is at
most two points. As the maximum value of the -circle average of the GFF is of the order log(1/),

4

13

these two intersection points cannot inﬂuence the value of the harmonic function (see [2] for the
precise statement and proof) and thus, almost surely, the absolute value of the harmonic function
corresponding to A ∪ CLEM +1
is bounded by 2λ(M + 1). A similar analysis can be applied to the
case where Bq ∈ (−2(M + 1)λ,−2M λ).
Note that if for all rational q, the stopped radial SLE4(−2) is either not in O(z) or not in the
process of tracing the loop that constitute the outer boundary of OM +1(z), then it means that
is
O(z) ⊂ OM +1(z), so that in this case too, the harmonic function corresponding to A ∪ CLEM +1
necessarily bounded, in absolute value, by 2λ(M + 1).

4

4

is also a 2λ(M + 1)-BTLS. But by Lemma 9 (recall

and proves Proposition 3.

We can therefore conclude that A∪ CLEM +1

4

satisﬁes (∗)), this implies that A ⊆ CLEM +1

4

that CLEM +1

4

Figure 4. Sketch of the proof: ∂O(z) in plain; in dashed, the past of the radial
exploration within O(z). One discovers the dash-dotted interface as part of a loop
along the radial SLE4(−2) exploration: It cannot hit the dashed part without com-
pleting a CLE loop at that time or before that time because of the properties of
SLE4(−2). And it cannot touch the parts of ∂O(z) that are away from the dashed
part before completing the loop, because the GFF boundary values are too small

5.2. Proof of Proposition 1. The proof of Proposition 1 follows along the same lines as that
of Proposition 3. The diﬀerence lies in the fact that this time we are exploring one CLEM
4 using
another CLEM
4 and thus the boundary conditions on ∂O(z) \ Kq are exactly ±2M λ. As above, we
conclude from Lemma 14 that the part of the radial SLE4(−2) drawing 2λ(M − 1) versus 2λM
level-line loop cannot exit O(z) before completing that loop (one has to modify Figure 4, so that
the dash-dotted interface η is now a 2M λ vs. 2(M − 1)λ interface, and the continuous boundary
data is ±2M λ).

14

2(M+1)λ2MλzHence, it ﬁrst follows as before that |hA∪CLEM

4 | has to be bounded by 2λM, and then using

Lemma 9 that A ⊆ CLEM

4 almost surely. But this means that for all z,

|hA∪CLEM
Again, using Lemma 9 we see that CLEM

4 (z)| = 2λM = |hA(z)|
4 ⊆ A almost surely.

a.s.

5.3. Proof of Proposition 4. Suppose now that A is a K-BTLS such that with positive proba-
bility, there exists a connected component of A that is disconnected from ∂D. We choose some M
such that 2λ(M − 1) ≥ K. We have just shown that almost surely, A ⊆ CLEM
4 .
On the other hand, with positive probability, D \ A contains an annular open region that dis-
connects this connected component of A from ∂D. Hence, there exists a deterministic such annular
region O such that with positive probability, O is in D \ A and disconnects a connected component
of A from ∂D (we call this event E = EO).
Given A and hA, the conditional distribution of ΓA is a GFF. It follow from Lemma 10 that on
the event EO, the conditional distribution of ΓA restricted to O is mutually absolutely continuous
with respect to the conditional distribution of Γ itself restricted to O. It is possible to show, using
Corollary 12 and the fact that with positive probability the radial SLE4(−2) makes a loop inside
O, that with positive probability the CLEM
4 does not intersect the interior part of the complement
of O. But this contradicts the fact that A ⊆ CLEM
4 .

6. BTLS with two prescribed boundary values

In this section, we describe the class of BTLS such that the harmonic function can only take two
prescribed possible values. In particular, we construct a collection of BTLS that are smaller than
CLE4 and determine for which values such BTLSs exist.

Some aspects of the following discussion are strongly related to the κ = 4 case of boundary
conformal loop ensembles (and their nesting) introduced and studied in [16] (that was written up
in parallel to the present paper) for general κ.

6.1. A ﬁrst example. Let us ﬁrst describe in some detail one speciﬁc example. Consider a GFF
in the unit disc and ﬁx two boundary points, say −i and i. Consider the zero-level line of this
GFF. This is an SLE4(−1;−1) from −i to i that is coupled with the GFF as a BTLS [12]. It is
known that this is a simple path η from −i to i in the closed disc, and it is easy to see that its
Minkowski dimension is almost surely smaller than some d < 2. Moreover, it is also known that the
SLE4(−1;−1) is a deterministic function of the GFF [12].
The harmonic function hη associated to this curve is described as follows: D \ η is the union of
j )j∈J, and a component lies either to the right or to the
countably many connected components (D1
j , the harmonic
left of the curve (if one views the curve as going from −i to i). In each component D1
j ∩ ∂D and on ∂D1
function has boundary conditions 0 on ∂D1
j ∩ η, the boundary condition is λ or
j is on the left or on the right of η.
−λ depending on whether D1
j have independent GFF-s with boundary conditions, we can iterate:
As inside each component D1
Suppose for example that the D1
j is divided into to arcs, one of
which is an excursion of η away from the ∂D, and the other one is a counter-clockwise arc from xj
to yj of ∂D. We now deﬁne a SLE4(0;−1) process from xj to yj. This is again a simple curve, and
can be coupled with the GFF with boundary conditions hA in D1
j in such a way that the boundary
conditions on its left are −λ and on its right are λ. We proceed in a symmetric way in the connected
components that lie above η. In this way, we obtain a new BTLS (by ﬁrst sampling η, and then
j ), and harmonic functions deﬁned via the boundary conditions
one SLE4(0;−1) process in each D1
as indicated in Figure 5.

j lies to the right of η, then, ∂D1

15

The iteration then further proceeds by deﬁning SLE4(0;−1) processes in each of the remaining
connected components which have part of ∂D on their boundary. One then deﬁnes a second layer
of loops and one proceeds iteratively. We then consider the closure A−λ,λ of the union of all the
traced level lines.
Clearly, after any ﬁnite number of iterations in the previous construction, one has a λ-BTLS, and
therefore a subset of the CLE2
4 and
therefore a BTLS. It is also easy to see that a given point z ∈ D is almost surely contained in a
loop cut out after ﬁnitely many iterations, so that the harmonic function associated to A takes its
values in {−λ, λ}.

4 by our previous results. Hence, A is itself a subset of the CLE2

Figure 5. First iterations: The SLE4(−1;−1) and its boundary conditions on the
left. The SLE4(0;−1) in the second layer on the right picture that creates loops with
±λ boundary conditions.

We can make the following observations about this set A−λ,λ:

• As opposed to the CLE4, the set A−λ,λ is fairly skinny. Indeed, it is just made out of the
union of all SLE4 type of paths. For instance, each excursion of η away from ∂D is on the
boundary between two connected components of A−λ,λ (one +λ loop to its right and one
−λ loop to its left). This indicates that the Minkowski dimension of A−λ,λ should be 3/2
(we will come back to this later).
• The set A−λ,λ is the only BTLS with boundary values in {−λ, λ}. In fact, suppose that
˜A is another BTLS coupled with the same GFF as A−λ,λ, such that h ˜A takes its values in
{−λ, λ} and such that conditionally on Γ, A−λ,λ and ˜A are independent. Then, one can
loosely follow the strategy of the proof of Proposition 1 to conclude that ˜A = A−λ,λ almost
surely. More precisely, consider again some z /∈ ˜A and denote by O(z) the component of z
in D \ ˜A. Now, notice that almost surely no level line in the construction of the component
of z in D \ A−λ,λ can make an excursion inside of O(z): Indeed, consider for contradiction
the ﬁrst level line in the construction that enters O(z). Then one the one hand this level
line cannot exit O(z) on the boundary of ˜A. On the other hand it is also almost surely a
simple path. Thus, it cannot exit O(z) at all and we obtain a contradiction. As this holds
for a countable dense family of z, we can again conclude from Lemma 9 that A−λ,λ is the

16

λλλλλ−λλλλ−λ−λ−λ−λ−λ−λλλλλλλλ−λ−λ−λ−λ−λλλλλλλ−λ−λ−λ−λ−λλλλλλ−λλλλ−λ−λ−λ−λ−λ−λλonly λ-BTLS with these properties. In particular its law does not depend on the arbitrary
choice of the points x and y in the previous layered construction.

Furthermore, we note that, similarly to the construction of CLEM

4 , we can iterate the construction
of the set A−λ,λ to construct a BTLS with harmonic function that takes its values in {−2λ, 2λ}:
indeed, we pick a countable number of dense z ∈ D and iterate the construction in the component
containing z until the boundary values are in {−2λ, 2λ}. At each step in the construction, one has a
2λ−BTLS, and therefore in the limit, one still has a BTLS contained in CLE2
4. But from Proposition
1 it now follows that the obtained set is exactly the CLE4. This therefore provides an alternative
construction of CLE4 (and of its iterated nested versions CLE4,m and CLEM
4 ) that builds only on
the coupling of the chordal SLE4(−1;−1) and SLE4(0;−1) process with the GFF. Notice that in
this case the measurability of the CLE4 just follows from that of the respective SLE4(−1;−1) and
SLE4(0;−1) processes plus general properties of the local set and level lines.
As we point out in Section 6.3, there is also a direct way to see that this set A−λ,λ and its iterates
are thin (without using the relation to CLEM
4 as we just did). Hence, we indeed obtain a stand-alone
construction of CLE4 and of its properties. Interestingly, we cannot show that this construction
gives the same law as CLE4 without using the coupling with the GFF.
6.2. General sets A−a,b and proof of Proposition 2. We ﬁrst describe for any −a ≤ 0 ≤ b
with b + a ≥ 2λ, the construction of a BTLS A−a,b such that the corresponding harmonic function
takes its values in {−a, b}. This generalizes our previous constructions of A−λ,λ and CLEM
4 , that
corresponds to A−2M λ,2M λ. We then prove that there are no such BTLS when b + a < 2λ (unless
a or b are equal to 0, in which case one can take the empty set), and discuss the labels assigning to
each component of D \ A−a,b its expected value.
6.2.1. Construction of A−a;b.

• a = 0 or b = 0: We set A−a,b = ∅ and the corresponding harmonic function takes the value
0 everywhere.
• a = −n1λ and b = n2λ, where n1 and n2 are positive integers: We can just suitably iterate
independent copies of the previous set Aλ,−λ. We choose a countable dense set of z ∈ D and
iterate in the component containing z as long as the boundary values are in {−n1λ, n2λ}.
• a + b = 2λ: Set c := (b − a)/2 ∈ (−λ, λ) and repeat exactly the same construction as
above, except that one now traces c-level lines ie. c− λ vs c + λ interfaces iteratively instead
of −λ vs. λ interfaces. Exactly the same construction and the same arguments lead to
the construction of a BTLS Ac−λ,c+λ such that the corresponding harmonic function takes
its values in {c − λ, c + λ}. These sets are called the boundary conformal loop ensembles
for κ = 4 in [16]. Notice that in these sets each interior boundary arc is shared by two
components of the complement.
• a + b = nλ where n ≥ 3 is an integer: Deﬁne c ∈ (−λ, λ) such that there exists two non-
negative integers n1, n2 with a = c − n1λ and b = c + n2λ. Starting from Ac−λ,c+λ we now
iterate copies of A−(n1−1)λ,n2λ (resp. of A−n1λ,(n2−1)λ) in the connected components of the
complement of Ac−λ,c+λ depending on the value of the harmonic function.
• General case with b + a > 2λ: by symmetry, we can suppose that a > λ. Deﬁne c ∈ [0, λ)
and n1, n2 ≥ 0 such that b = c + n1λ and b − n2λ ∈ [−a,−a + λ). Note that b − n2λ < 0
and that n2 ≥ 2. Now consider a sample of Ab−n2λ,b. In the connected components where
the harmonic function is b, we stop. In those components where the harmonic function is
b − n2λ, we iterate copies of A−d,−d+n2λ where d = (a + b) − n2λ ∈ [0, λ). In this way, we
obtain on the one hand connected components where the harmonic function is −a (and we
stop), and on the other hand, components where the harmonic function is b − d. In the
latter, we iterate independent copies of Ad−n2λ,d, and we continue in this way. At each step

17

for a ﬁxed M. If we
of the iteration, one has a BTLS that is contained in a given CLEM
4
continue the iteration around every point z until the iteration stops, we deﬁne a BTLS A−a,b
such that the corresponding harmonic function takes values in {−a, b}.
Conformal invariance of the GFF implies the conformal invariance of A−a,b and thus we see that
P(hA−a,b(z) = −a) does not depend on z ∈ D. Using the fact that E((Γ, 1)) = 0, we therefore see
that for all z ∈ D,

and P(hA−a,b(z) = b) =

a

,

a + b

P(hA−a,b(z) = −a) =

b

a + b

as one might have expected.

−b,b(cid:48)

To see that A−a,b are the unique BTLS B with hB ∈ {−a, b}, one can adapt the arguments that
we used in the last subsection in the case where a = b = λ. Thus, in order to complete the proof of
part (2) of Proposition 2, it remains to explain the monotonicity statement:

Suppose [−a, b] ⊂ [−a(cid:48), b(cid:48)] and −a < 0 < b with b + a > 2λ. Starting with A−a,b, and then
sampling independent copies Aa−a(cid:48),a+b(cid:48) in all the connected components of its complement where
the GFF-boundary values are a and independent copies of A−a(cid:48)
−b in the others, we obtain a
BTLS with boundary values in {−a(cid:48), b(cid:48)}. By uniqueness it follows that the obtained set is indeed
A−a(cid:48),b(cid:48) and by construction it contains A−a,b.
6.2.2. There are no two-valued BTLS A−a,b with a + b < 2λ. Let us now explain the proof of
Proposition 2-(1): First, one can discard the case where −a and b have the same sign because the
mean value of the ﬁeld has to remain 0. When −a < 0 < b and b + a < 2λ, suppose for contradiction
that A−a,b exists. Sample A−a−b,−a−b+2λ in those connected components of the complement of A−a,b
to see that A−a,b ⊂ A−a,−a+2λ where the harmonic function is equal to b. In particular, note that
a connected component of D \ A where the corresponding harmonic function hA−a,b is −a remains
a connected component of D \ A−a,−a+2λ. Such a connected component has boundary value −a,
but has no boundary arc that is shared with a component of D \ A−a,−a+2λ where the harmonic
function is −a + 2λ. This leads to a contradiction with an observation made above: we know from
the construction of A−a,−a+2λ that all interior boundary arcs are shared by two components of the
complement.

6.2.3. Labels of A−a,b. We conclude this subsection with a small discussion about signs of the
harmonic functions assigned to each (Oj) of CLE4. As mentioned in Section 4, by combining the
radial SLE4(−2) construction and the reversibility of SLE4 one can show that it is possible to ﬁrst
sample the family (Oj), and then the labels j using independent fair coins. The idea is that one
can deﬁne the symmetric radial SLE4(−2) using a Poisson point process of SLE4 bubbles, which is
invariant under resampling of the orientations of the bubbles, see e.g. [34]).
This conditional independence between the heights in diﬀerent domains feature is speciﬁc to
4 the existence of a correlation between the heights in diﬀerent domains
CLE4. For instance, for CLEM
is clear from the construction. For A−λ,λ, the situation is actually quite reversed: conditioned on
A−λ,λ, one fair coin toss that decides the sign of the harmonic function at the origin is enough to
determine the harmonic function in all the other connected components of the complement of A−λ,λ.
This follows from the fact that any two neighbouring components have diﬀerent heights. In the case
of Ac−λ,c+λ for c (cid:54)= 0, one does not even need to toss a coin, as the asymmetry (and conformal
invariance) makes it in fact possible to detect almost surely the sign of the harmonic function at
the origin. From this point of view, it is even quite intriguing that by iterating A−λ,λ, one obtains
a CLE4 where the signs of the heights are independent in the diﬀerent components.

6.3. Dimension of A−a,b. The goal of the present paragraph is to derive the following fact:

18

Proposition 15. For each given z, the random variable log(crad(z, D)) − log(crad(z, D \ A−a,b))
is distributed like a constant times the exit time from (−aπ/(2λ), bπ/(2λ)) by a one-dimensional
Brownian motion B started from 0.
In particular, for each given z, the probability that d(z, A−a,b) < r is (up to constants) comparable
to rs for s = s−a,b := λ2/(2(b + a)2) as r → 0.
Proof. Let us ﬁrst focus on the case of the set A = A−λ,λ. Fix a point z ∈ D and note that the
construction of the set A is obtained via a continuously increasing family of sets (At, t ≥ 0) that
correspond to the concatenation of the various chordal SLE4(−1; 1) and SLE4(0;−1) processes that
one iterates. All these sets At are clearly local sets, and the value of the corresponding harmonic
function ht(z) at z is always in [−λ, λ] (as its boundary values are in {0, λ,−λ}). Furthermore, by
deﬁnition it is a local martingale, and therefore a martingale. We know that it converges to either
+λ or −λ as t → ∞.
On the other hand, we know (see eg. [12]) that when Rt is a continuously increasing family of local
sets then hRt(z) evolves like a constant times Brownian motion when parametrized by the decrease
of the log-conformal radius of D \ Rt seen from z. This therefore implies that log(crad(z, D)) −
log(crad(z, D\ A)) is distributed like a constant times the exit time of (−π, π) by a one-dimensional
Brownian motion.
Exactly the same argument can be applied to all A−a,b’s that we have constructed – one just
needs to note that in our iterative procedure, all the iterations are independent and the harmonic
(cid:3)
functions ht always remain in [−a, b].
Note that this argument can be used to see that A−λ,λ is indeed a BTLS with upper Minkowski
dimension almost surely not larger than 3/2 and that CLE4 obtained by iterations of A−λ,λ is indeed
a BTLS (as it satisﬁes (3)).
Acknowledgements. This work was supported by the SNF grant #155922. The authors are
part of the NCCR Swissmap. The authors would like to thank the Isaac Newton Institute for
Mathematical Sciences, Cambridge, as well as the Clay foundation, for hospitality and support
during the program Random Geometry where a part of this work was undertaken.

References

[1] J. Aru. The geometry of the Gaussian free ﬁeld combined with SLE processes and the KPZ relation, PhD thesis,

[2] J. Aru, A. Sepúlveda. Survey in preparation.
[3] J. Aru, A. Sepúlveda, W. Werner. On imaginary BTLS of the GFF, in preparation
[4] J. Dubédat. Commutation relations for Schramm-Loewner evolutions. Communication in Pure and Applied

[5] J. Dubédat. SLE and the free ﬁeld: partition functions and couplings. Journal of the American Mathematical

Mathematics 60, 1792–1847, 2007.

Society 22, 995–1054, 2009.

[6] B. Duplantier and S. Sheﬃeld. Liouville quantum gravity and KPZ. Inventiones Mathematicae 185, 333–393,

[7] H. Föllmer, Calcul d’Itô sans Probabilités. Sém. Probabilités Strasbourg XV, Lecture Notes in Mathematics 850,

[8] J.B. Garnett and D.E. Marshall. Harmonic Measure Cambridge University Press, 2005,
[9] Z.-X. He, O. Schramm. Fixed points, Koebe uniformization and circle packings, Annals of Mathematics 137,

Springer, 143-150, 1981.

369-406, 1995.

Related Fields 155, 35–69, 2013.

2015

2011.

appear.

[10] K. Izyurov and K. Kytola. Hadamard’s formula and couplings of SLEs with free ﬁeld. Probability Theory

[11] J.P. Miller and S. Sheﬃeld. The GFF and CLE(4), slides of 2011 talks and private communications.
[12] J.P. Miller and S. Sheﬃeld. Imaginary Geometry I. Interacting SLEs, Probability Theory and related Fields, to

[13] J.P. Miller and S. Sheﬃeld. Imaginary Geometry II. Reversibility of SLEκ(ρ1; ρ2) for κ ∈ (0, 4), Annals of

Probability, to appear.

19

[14] J.P. Miller and S. Sheﬃeld. Imaginary Geometry III. Reversibility of SLEκ for κ ∈ (4, 8), Annals of Mathematics,
[15] J.P. Miller and S. Sheﬃeld. Imaginary Geometry IV: interior rays, whole-plane reversibility, and space-ﬁlling

to appear.

[16] J.P. Miller, S. Sheﬃeld and W. Werner. CLE percolations, preprint 2016.
[17] J.P. Miller, S.S. Watson and D.B. Wilson. Extreme nesting in the conformal loop ensemble, Annals of Probability,

[18] J. Miller, H. Wu. Intersections of SLE paths: the double and cut point dimension of SLE, Probability Theory

[19] Ş. Nacu and W. Werner. Random soups, carpets and fractal dimensions. Journal of the London Mathematical

trees, preprint

to appear.

and related Fields, to appear.

Society 83, 789–809, 2011.

[20] E. Nelson. Construction of quantum ﬁelds from Markoﬀ ﬁelds, Journal of Functional Analysis 12, 97-112, 1973.
[21] S.C. Port and C.J. Stone, Brownian motion and classical potential theory, Academic Press, 1978.
[22] E. Powell and H. Wu Level lines of the Gaussian Free Field with general boundary data , preprint
[23] Yu. A. Rozanov. Markov Random Fields. Springer-Verlag 1982.
[24] M. Yor and D. Revuz. Continuous Martingales and Brownian Motion. Springer-Verlag 1999.
[25] O. Schramm. Scaling limits of loop-erased random walks and uniform spanning trees. Israel Journal of Mathe-

[26] O. Schramm and S. Sheﬃeld. A contour line of the continuum Gaussian free ﬁeld. Probability Theory Related

matics 118, 221–288, 2000.

Fields 157, 47–80, 2013.

[27] O. Schramm, S. Sheﬃeld, and D. B. Wilson. Conformal radii for conformal loop ensembles. Communications in

Mathematical Physics 288, 43–53, 2009.

[28] A. Sepúlveda. On thin local sets of the GFF, preprint, 2016.
[29] S. Sheﬃeld. Exploration trees and conformal loop ensembles. Duke Mathematical Journal 147, 79–129, 2009.
[30] S. Sheﬃeld. Conformal weldings of random surfaces: SLE and the quantum gravity zipper, Annals of Probability,

[31] S. Sheﬃeld and W. Werner. Conformal Loop Ensembles: The Markovian characterization and the loop-soup

construction. Annals of Mathematics 176, 1827–1917, 2012.

[32] W. Werner. Some recent aspects of random conformally invariant systems. Ecole d’été de physique des Houches

[33] W. Werner. Topics on the GFF and CLE(4), Lecture Notes, 2016.
[34] W. Werner and H. Wu. On conformally invariant CLE explorations. Communications in Mathematical Physics

to appear.

LXXXIII, 57–99, 2006.

320, 637–661, 2013.

Department of Mathematics, ETH Zürich, Rämistr. 101, 8092 Zürich, Switzerland
E-mail address: juhan.aru@math.ethz.ch
E-mail address: leonardo.sepulveda@math.ethz.ch
E-mail address: wendelin.werner@math.ethz.ch

20

