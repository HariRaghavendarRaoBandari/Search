6
1
0
2

 
r
a

M
4

 

 
 
]

.

A
Q
h
t
a
m

[
 
 

1
v
6
4
3
1
0

.

3
0
6
1
:
v
i
X
r
a

NEWTON-OKOUNKOV CONVEX BODIES OF SCHUBERT VARIETIES

AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

NAOKI FUJITA AND SATOSHI NAITO

Abstract. A Newton-Okounkov convex body is a convex body constructed from a projective vari-
ety with a valuation on its homogeneous coordinate ring; this is deeply connected with representa-
tion theory. For instance, the Littelmann string polytopes and the Feigin-Fourier-Littelmann-Vinberg
polytopes are examples of Newton-Okounkov convex bodies. In this paper, we prove that the Newton-
Okounkov convex body of a Schubert variety with respect to a speciﬁc valuation is identical to the
Nakashima-Zelevinsky polyhedral realization of a Demazure crystal. As an application of this result, we
show that Kashiwara’s involution (∗-operation) corresponds to a change of valuations on the rational
function ﬁeld.

Contents

Introduction

1.
2. Polyhedral realizations of crystal bases
2.1. Abstract crystals
2.2. Crystal bases and global bases
2.3. Polyhedral realizations of Demazure crystals
3. Newton-Okounkov convex bodies of Schubert varieties
3.1. Newton-Okounkov convex bodies
3.2. Highest term valuations
4. Main result
4.1. Statement of the main result
4.2. Proof of Theorem 4.1
5. Applications
5.1. Explicit forms of Newton-Okounkov convex bodies
5.2. Relation with Kashiwara’s involution
References

1
3
3
4
6
9
9
12
13
13
13
16
16
18
21

1. Introduction

The study of Newton-Okounkov convex bodies is started by Okounkov in order to study multiplicity
functions for representations of a reductive group ([O1], [O2]), and afterward developed independently by
Kaveh-Khovanskii ([KK1]) and by Lazarsfeld-Mustata ([LM]). These convex bodies generalize Newton
polytopes for toric varieties to arbitrary projective varieties, and have various kinds of information
about corresponding projective varieties; for instance, we can systematically construct a series of toric
degenerations (see [HK, Corollary 3.14] and [A, Theorem 1]). Hence it is important to describe the
explicit form of a Newton-Okounkov convex body. As an application of our main result below, we
obtain a series of examples, in which a Newton-Okounkov convex body is given by a system of explicit
aﬃne inequalities.

A remarkable fact is that the theory of Newton-Okounkov convex bodies of Schubert varieties and
Bott-Samelson varieties is deeply connected with representation theory. For instance, Kaveh ([Kav])
proved that the Newton-Okounkov convex body of a Schubert variety with respect to a speciﬁc valuation
is identical to the Littelmann string polytope constructed from the string parameterization for a De-
mazure crystal. Furthermore, one of the authors ([F]) extended this result of Kaveh to Bott-Samelson
varieties. Also, the Feigin-Fourier-Littelmann-Vinberg polytopes are examples of Newton-Okounkov
convex bodies (see [FFL] and [Kir]). The purpose of this paper is to realize the Newton-Okounkov

2010 Mathematics Subject Classiﬁcation. Primary 17B37; Secondary 05E10, 14M15, 14M25.
Key words and phrases. Newton-Okounkov bodies, Schubert varieties, Nakashima-Zelevinsky polyhedral realizations,

Kashiwara’s involution.

1

2

N. FUJITA AND S. NAITO

convex body of a Schubert variety with respect to a speciﬁc valuation as the Nakashima-Zelevinsky
polyhedral realization of a Demazure crystal.

To be more precise, let G be a connected, simply-connected semisimple algebraic group over C, g its
Lie algebra, W the Weyl group, and Ei, Fi, hi ∈ g, i ∈ I, the Chevalley generators, where I denotes
an index set for the vertices of the Dynkin diagram. Choose a Borel subgroup B ⊂ G, and denote
by X(w) ⊂ G/B the Schubert variety corresponding to w ∈ W . A dominant integral weight λ gives
a line bundle Lλ on G/B; by restricting this bundle, we obtain a line bundle on X(w), which we
denote by the same symbol Lλ. From the Borel-Weil theorem, we know that the space H 0(X(w), Lλ) of
global sections is a B-module isomorphic to the dual module Vw(λ)∗; here, Vw(λ) denotes the Demazure
module corresponding to w. We take a valuation v on the function ﬁeld C(X(w)) with values in Zr, where
r := ℓ(w), the length of w, and ﬁx a nonzero section τ ∈ H 0(X(w), Lλ); in addition, we assume that
v has one-dimensional leaves (see §§3.1 for the deﬁnition). From these data, we construct a semigroup
S(X(w), Lλ, v, τ ) ⊂ Z>0 × Zr (see Deﬁnition 3.6).
If we denote by C(X(w), Lλ, v, τ ) ⊂ R≥0 × Rr
the smallest real closed cone containing S(X(w), Lλ, v, τ ), then the Newton-Okounkov convex body
∆(X(w), Lλ, v, τ ) ⊂ Rr is deﬁned to be the intersection of C(X(w), Lλ, v, τ ) and {1} × Rr. Now we
restrict ourselves to a speciﬁc valuation. Let us take a reduced word i = (ir, . . . , i1) for w. By using the
birational morphism

Cr → X(w), (tr, . . . , t1) 7→ exp(trFir ) exp(tr−1Fir−1 ) · · · exp(t1Fi1 ) mod B,

we identify the function ﬁeld C(X(w)) with the rational function ﬁeld C(tr, . . . , t1). Deﬁne a valuation
vi on C(X(w)) to be the highest term valuation on C(tr, . . . , t1) with respect to the lexicographic order
t1 > · · · > tr (see Example 3.3). For a dominant integral weight λ, let τλ ∈ H 0(G/B, Lλ) denote the
lowest weight vector; by restricting this section, we obtain a section in H 0(X(w), Lλ), which we denote
by the same symbol τλ. In this setting, we study the Newton-Okounkov convex body ∆(X(w), Lλ, vi, τλ).
Let Uq(g) be the quantized enveloping algebra, and B(∞) the crystal basis of the negative part
Uq(u−). Denote by B(λ) the crystal basis of the irreducible highest weight Uq(g)-module Vq(λ) with
highest weight λ, and by Bw(λ) ⊂ B(λ) the Demazure crystal corresponding to w ∈ W . In the theory
of crystal bases, it is important to give their concrete realizations. Until now, many useful realizations
have been discovered; the theory of Nakashima-Zelevinsky polyhedral realizations is one of them. Take
an inﬁnite sequence of indices ˜i = (. . . , ik, . . . , i2, i1) such that ik 6= ik+1 for all k ≥ 1, and such that
the cardinality of {k ≥ 1 | ik = i} is ∞ for each i ∈ I. Then, we can associate to ˜i a crystal structure
on Z∞ := {(. . . , ak, . . . , a2, a1) | ak ∈ Z and ak = 0 for k ≫ 0}, and obtain an embedding of crystals
Ψ˜i : B(∞) ֒→ Z∞, called the Kashiwara embedding with respect to ˜i (see §§2.3). Nakashima-Zelevinsky
([NZ]) described explicitly the image of B(∞) under a certain positivity assumption on ˜i. Afterward,
Nakashima ([N1], [N2]) gave a similar description of the Demazure crystal Bw(λ) under the assump-
tion that (˜i, λ) is ample (see Deﬁnition 5.1). These descriptions of crystal bases are called polyhedral
realizations. Let i = (ir, . . . , i1) be a reduced word for w ∈ W , and extend it to a reduced word
ˆi = (iN , . . . , ir+1, ir, . . . , i1) for the longest element w0 ∈ W . We consider the Kashiwara embedding
Ψ˜i with respect to an extension ˜i = (. . . , ik, . . . , iN +1, iN , . . . , i2, i1) of ˆi.
In this case, the image of
B(∞) (resp., Bw(λ)) can be regarded as a subset of ZN (resp., Zr) (see Remark 2.12 and Deﬁnition
2.14); we denote by Ψi : B(∞) ֒→ ZN and Ψ(λ,w)
: Bw(λ) ֒→ Zr the corresponding embeddings. From
the embedding Ψ(λ,w)
, we obtain a subset S(λ,w)
⊂ Z>0 × Zr (see Deﬁnition 2.15). Let us denote by
C(λ,w)
⊂ Rr the intersection
of C(λ,w)
and {1} × Rr. By using the theory of generalized string polytopes (see [F] for the deﬁnition),
we deduce that ∆(λ,w)
(Bw(λ)) (see Corollary 2.20); here, we do not necessarily assume
that (˜i, λ) is ample.

⊂ R≥0 × Rr the smallest real closed cone containing S(λ,w)

, and by ∆(λ,w)

∩ Zr = Ψ(λ,w)

i

i

i

i

i

i

i

i

i

In order to relate the Newton-Okounkov convex body ∆(X(w), Lλ, vi, τλ) with the polyhedral real-
λ (b) | b ∈ Bw(λ)} ⊂ Vw(λ) the
λ,w(b) | b ∈ Bw(λ)} ⊂ H 0(X(w), Lλ) = Vw(λ)∗

ization ∆(λ,w)
specialization of the lower global basis at q = 1, and by {Gup
the dual basis (see §§4.1). The following is the main result of this paper.

, we make use of global crystal bases. Let us denote by {Glow

i

Theorem. Let i be a reduced word for w ∈ W , and λ a dominant integral weight.

(1) The Kashiwara embedding Ψ(λ,w)
(2) The polyhedral realization ∆(λ,w)

i

i

(b) is equal to −vi(Gup
is identical to −∆(X(w), Lλ, vi, τλ).

λ,w(b)/τλ) for all b ∈ Bw(λ).

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

3

i

under the assumption that (˜i, λ) is ample, Nakashima’s description of Ψ(λ,w)
of explicit aﬃne inequalities deﬁning the Newton-Okounkov convex body ∆(λ,w)

§§5.1 is devoted to the study of explicit forms of Newton-Okounkov convex bodies. To be more precise,
(Bw(λ)) also gives a system
= −∆(X(w), Lλ, vi, τλ).
In §§5.2, we compare our result with the result of [Kav]. To be more precise, let us deﬁne a valuation
˜vi on C(X(w)) to be the highest term valuation on C(tr, . . . , t1) with respect to the lexicographic order
tr ≻ · · · ≻ t1 (see Example 3.3). Kaveh ([Kav]) proved that the value −˜vi(Gup
λ,w(b)/τλ) for b ∈ Bw(λ)
is equal to the string parameterization of b with respect to i, and that the Newton-Okounkov convex
. Let us consider the
case that w = w0. In this case, the Schubert variety X(w0) is just the full ﬂag variety G/B, and the
Demazure crystal Bw0(λ) is just the crystal basis B(λ). We denote the section Gup
(b) ∈ H 0(G/B, Lλ)
for b ∈ B(λ) simply by Gup
λ (b). For a reduced word i = (iN , . . . , i1) for w0, our result combined with the
result of Kaveh above implies that Kashiwara’s involution ∗ : B(∞) → B(∞) corresponds to the change
of valuations from vi to ˜viop , which gives a geometric interpretation of ∗; here we write iop := (i1, . . . , iN ).
More precisely, we obtain the following.

body −∆(X(w), Lλ, ˜vi, τλ) is identical to the Littelmann string polytope e∆(λ,w)

λ,w0

i

i

Corollary. Let i be a reduced word for w0, and N := ℓ(w0). Then, there exists a piecewise-linear map
ηi : RN → RN satisfying the following conditions:

(i) The map ηi corresponds to Kashiwara’s involution ∗ through the Kashiwara embedding Ψi:

for all b ∈ B(∞).

(ii) The map ηi corresponds to the change of valuations from vi to ˜viop :

b∗ = Ψ−1

i

◦ ηi ◦ Ψi(b)

for every dominant integral weight λ and b ∈ B(λ).

ηi(−vi(Gup

λ (b)/τλ)) = −˜viop (Gup

λ (b)/τλ)

(iii) The map ηi induces a bijective piecewise-linear map from the polyhedral realization ∆(λ,w0)

=
= −∆(G/B, Lλ, ˜viop , τλ) for every domi-

i

−∆(G/B, Lλ, vi, τλ) onto the string polytope e∆(λ,w0)

nant integral weight λ.

iop

2. Polyhedral realizations of crystal bases

2.1. Abstract crystals. First of all, we recall the deﬁnition of abstract crystals introduced in [Kas4].
Let G be a connected, simply-connected semisimple algebraic group over C of rank n, g its Lie algebra,
and W the Weyl group. Choose a Borel subgroup B ⊂ G and a maximal torus T ⊂ B. Denote by t the
Lie algebra of T , by t∗ := HomC(t, C) its dual space, and by h·, ·i : t∗ × t → C the canonical pairing. Let
{αi | i ∈ I} ⊂ t∗ be the set of simple roots, {hi | i ∈ I} ⊂ t the set of simple coroots, and P ⊂ t∗ the
weight lattice, where I := {1, 2, . . . , n}, an index set for the vertices of the Dynkin diagram.

Deﬁnition 2.1. A crystal B is a set equipped with the maps

wt : B → P ,
εi : B → Z ∪ {−∞}, ϕi : B → Z ∪ {−∞} for i ∈ I, and
˜ei : B → B ∪ {0}, ˜fi : B → B ∪ {0} for i ∈ I,

satisfying the following conditions:

(i) ϕi(b) = εi(b) + hwt(b), hii for i ∈ I,
(ii) wt(˜eib) = wt(b) + αi, εi(˜eib) = εi(b) − 1, and ϕi(˜eib) = ϕi(b) + 1 for i ∈ I and b ∈ B such that

(iii) wt( ˜fib) = wt(b) − αi, εi( ˜fib) = εi(b) + 1, and ϕi( ˜fib) = ϕi(b) − 1 for i ∈ I and b ∈ B such that

˜eib ∈ B,

˜fib ∈ B,

(iv) b′ = ˜eib if and only if b = ˜fib′ for i ∈ I and b, b′ ∈ B,
(v) ˜eib = ˜fib = 0 for i ∈ I and b ∈ B such that ϕi(b) = −∞.

Here, −∞ and 0 are additional elements that are not contained in Z and B, respectively.

Deﬁnition 2.2. Let B1, B2 be two crystals. A map

ψ : B1 ∪ {0} → B2 ∪ {0}

is called a strict morphism of crystals from B1 to B2 if it satisﬁes the following conditions:

(i) ψ(0) = 0,

4

N. FUJITA AND S. NAITO

(ii) wt(ψ(b)) = wt(b), εi(ψ(b)) = εi(b), and ϕi(ψ(b)) = ϕi(b) for i ∈ I and b ∈ B1 such that

ψ(b) ∈ B2,

(iii) ˜eiψ(b) = ψ(˜eib) and ˜fiψ(b) = ψ( ˜fib) for i ∈ I and b ∈ B1;

here, if ψ(b) = 0, then we set ˜eiψ(b) = ˜fiψ(b) = 0. An injective strict morphism is called a strict
embedding of crystals.

Consider the total order < on Z ∪ {−∞} given by the usual order on Z, and by −∞ < s for all s ∈ Z.

For two crystals B1, B2, we can deﬁne another crystal B1 ⊗ B2 (called the tensor product) as follows:

B1 ⊗ B2 := {b1 ⊗ b2 | b1 ∈ B1, b2 ∈ B2},
wt(b1 ⊗ b2) := wt(b1) + wt(b2),
εi(b1 ⊗ b2) := max{εi(b1), εi(b2) − hwt(b1), hii},
ϕi(b1 ⊗ b2) := max{ϕi(b2), ϕi(b1) + hwt(b2), hii},

˜ei(b1 ⊗ b2) :=(˜eib1 ⊗ b2
˜fi(b1 ⊗ b2) :=( ˜fib1 ⊗ b2

b1 ⊗ ˜fib2

b1 ⊗ ˜eib2

if ϕi(b1) ≥ εi(b2),
if ϕi(b1) < εi(b2),

if ϕi(b1) > εi(b2),
if ϕi(b1) ≤ εi(b2).

Here, b1 ⊗ b2 stands for an ordered pair (b1, b2), and we set b1 ⊗ 0 = 0 ⊗ b2 = 0.

Example 2.3. For λ ∈ P , let Rλ = {rλ} be the crystal consisting of only one element given by:
wt(rλ) = λ, εi(rλ) = −hλ, hii, ϕi(rλ) = 0, and ˜eirλ = ˜firλ = 0.

2.2. Crystal bases and global bases. Here we recall some basic facts about crystal bases and
global bases (following [Kas2], [Kas3], and [Kas4]). Deﬁne a symmetric bilinear form (·, ·) on t∗ by
2(αj, αi)/(αi, αi) = hαj, hii for all i, j ∈ I, and by (αi, αi) = 2 for all short simple roots αi. We set
(ci,j )i,j∈I := (hαj , hii)i,j∈I , the Cartan matrix of g, and also set

qi := q(αi,αi)/2 for i ∈ I,

[s]i :=

i − q−s
qs
qi − q−1

i

i

for i ∈ I, s ∈ Z,

[s]i! := [s]i[s − 1]i · · · [1]i for i ∈ I, s ∈ Z≥0,

[s]i[s − 1]i · · · [s − k + 1]i

[k]i[k − 1]i · · · [1]i

for i ∈ I, s, k ∈ Z≥0 such that k ≤ s,

(cid:20)s
k(cid:21)i
where [0]i! := 1 and(cid:2)s

:=

0(cid:3)i := 1.

Deﬁnition 2.4. For a ﬁnite-dimensional semisimple Lie algebra g, the quantized enveloping algebra
Uq(g) is the unital associative Q(q)-algebra with generators ei, fi, ti, t−1

, i ∈ I, and relations:

i

(i) tit−1
(ii) tiejt−1
(iii) eifj − fjei = δi,j(ti − t−1

i = 1 and titj = tjti for i, j ∈ I,
i = q−ci,j
)/(qi − q−1

ej and tifjt−1

i = qci,j

i

i

i

(−1)se(s)

i eje(1−ci,j −s)

i

(iv) P1−ci,j

s=0

Here, δi,j denotes the Kronecker delta, and e(s)

fj for i, j ∈ I,
) for i, j ∈ I,
(−1)sf (s)
:= es

i

=P1−ci,j

s=0

i

i fjf (1−ci,j −s)
:= f s

i /[s]i!, f (s)

i

i

= 0 for i, j ∈ I such that i 6= j.

i /[s]i! for i ∈ I, s ∈ Z≥0.

Let us denote by Uq(u) (resp., Uq(u−)) the Q(q)-subalgebra of Uq(g) generated by {ei | i ∈ I} (resp.,

{fi | i ∈ I}). Deﬁne a Q-algebra involution − and a Q(q)-algebra anti-involution ∗ on Uq(g) by

ei = ei, f i = fi, ti = t−1
i = t−1
i = ei, f ∗
e∗

i = fi, t∗

i

i

;

, q = q−1, and

the involution − (resp., ∗) is called the bar involution (resp., Kashiwara’s involution). Note that these
preserve Uq(u) and Uq(u−); also, we have ∗ ◦ − = − ◦ ∗. Denote by A ⊂ Q(q) the Q-subalgebra of Q(q)
consisting of rational functions regular at q = 0. Let us take a free A-submodule L(∞) ⊂ Uq(u−), a
Q-basis B(∞) ⊂ L(∞)/qL(∞), and deﬁne operators ˜ei, ˜fi, i ∈ I, on Uq(u−) as in [Kas2, §§3.5] (note
that we use the notation B(∞) instead of B(∞)). The operators ˜ei, ˜fi, i ∈ I, are called the Kashiwara
operators.

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

5

Proposition 2.5 (see [Kas2, Theorem 4]). The following hold.

(1) ˜eiL(∞) ⊂ L(∞) and ˜fiL(∞) ⊂ L(∞) for all i ∈ I; hence ˜ei, ˜fi, i ∈ I, act on L(∞)/qL(∞).
(2) ˜eiB(∞) ⊂ B(∞) ∪ {0} and ˜fiB(∞) ⊂ B(∞) for all i ∈ I.
(3) Deﬁne maps εi, ϕi : B(∞) → Z ∪ {−∞} for i ∈ I by

εi(b) := max{k ∈ Z≥0 | ˜ek

i b 6= 0}, and ϕi(b) := εi(b) + hwt(b), hii.

Then, the maps wt, εi, ϕi, ˜ei, and ˜fi, i ∈ I, provide a crystal structure on B(∞).

The pair (L(∞), B(∞)) is called the lower crystal basis of Uq(u−). We see from [Kas2, Proposition

5.2.4] that L(∞)∗ = L(∞), and from [Kas4, Theorem 2.1.1] that B(∞)∗ = B(∞). Hence the maps

wt, ε∗

i := εi ◦ ∗, ϕ∗

i := ϕi ◦ ∗, ˜e∗

i := ∗ ◦ ˜ei ◦ ∗, and ˜f ∗

i := ∗ ◦ ˜fi ◦ ∗, i ∈ I,

provide another crystal structure on B(∞). For a dominant integral weight λ, let Vq(λ) denote the
irreducible highest weight Uq(g)-module with highest weight λ over Q(q), and vq,λ ∈ Vq(λ) the highest
weight vector. We take a free A-submodule L(λ) ⊂ Vq(λ), a Q-basis B(λ) ⊂ L(λ)/qL(λ), and operators
˜ei, ˜fi, i ∈ I, on Vq(λ) as in [Kas2, Section 2] (note that we use the notation B(λ) instead of B(λ)); the
operators ˜ei, ˜fi, i ∈ I, are also called the Kashiwara operators.

Proposition 2.6 (see [Kas2, Theorem 2]). For a dominant integral weight λ, the following hold.

(1) ˜eiL(λ) ⊂ L(λ) and ˜fiL(λ) ⊂ L(λ) for all i ∈ I; hence ˜ei, ˜fi, i ∈ I, act on L(λ)/qL(λ).
(2) ˜eiB(λ) ⊂ B(λ) ∪ {0} and ˜fiB(λ) ⊂ B(λ) ∪ {0} for all i ∈ I.
(3) Deﬁne maps εi, ϕi : B(λ) → Z ∪ {−∞} for i ∈ I by

εi(b) := max{k ∈ Z≥0 | ˜ek

i b 6= 0}.
Then, the maps wt, εi, ϕi, ˜ei, and ˜fi, i ∈ I, provide a crystal structure on B(λ).

i b 6= 0}, and ϕi(b) := max{k ∈ Z≥0 | ˜f k

The pair (L(λ), B(λ)) is called the lower crystal basis of Vq(λ). The crystals B(∞) and B(λ) are

related as follows.

Proposition 2.7 ([Kas2, Theorem 5]). For a dominant integral weight λ, let πλ : Uq(u−) ։ Vq(λ)
denote the surjective Uq(u−)-module homomorphism given by u 7→ u · vq,λ.

(1) The equality πλ(L(∞)) = L(λ) holds; hence πλ induces a surjective Q-linear map L(∞)/qL(∞) ։

L(λ)/qL(λ) (denoted also by πλ).

∼
−→ B(λ), where

(3) ˜fiπλ(b) = πλ( ˜fib) for all i ∈ I, b ∈ B(∞).

(2) The Q-linear map πλ induces a bijective map πλ : eB(λ)
(4) ˜eiπλ(b) = πλ(˜eib) for all i ∈ I, b ∈ eB(λ).
hλ, hii for all b ∈ eB(λ).

eB(λ) := {b ∈ B(∞) | πλ(b) 6= 0}.

Now we denote by U Q
q (λ) := πλ(U Q

and set V Q
ei, fi, and (ti−t−1
for u ∈ Uq(g). Then, the natural maps

)/(qi−q−1

i

i

It follows easily from Proposition 2.7 (3), (4) that εi(πλ(b)) = εi(b), and that ϕi(πλ(b)) = ϕi(b) +

q (u−) the Q[q, q−1]-subalgebra of Uq(u−) generated by {f (k)
q (u−)); note that the U Q

| i ∈ I, k ∈ Z≥0},
q (λ) is invariant under the action of
) for all i ∈ I. Also, we deﬁne a Q-involution − on Vq(λ) by u · vq,λ := u·vq,λ

q (u−)-submodule V Q

i

L(∞) ∩ L(∞) ∩ U Q

L(λ) ∩ L(λ) ∩ V Q

q (u−) → L(∞)/qL(∞) and
q (λ) → L(λ)/qL(λ)

are isomorphisms of Q-vector spaces ([Kas2, Theorem 6]).
q (u−) and Glow
L(∞)∩L(∞)∩U Q
respectively, then the set {Glow
U Q
Vq(λ)). The following is a fundamental property of these bases.

: L(∞)/qL(∞) →
q (λ) the inverses of these isomorphisms,
q,λ (b) | b ∈ B(λ)}) forms a Q[q, q−1]-basis of
q (λ)); this is called the lower global basis of Uq(u−) (resp., the lower global basis of

q,λ : L(λ)/qL(λ) → L(λ)∩L(λ)∩V Q
q

(b) | b ∈ B(∞)} (resp., {Glow

q (u−) (resp., V Q

If we denote by Glow

q

Proposition 2.8. For a dominant integral weight λ, the following hold.

(b)∗ = Glow

q

(1) Glow
(2) πλ(Glow

q

q

(b)) = Glow

(b∗) for all b ∈ B(∞).
q,λ (πλ(b)) for all b ∈ B(∞).

6

N. FUJITA AND S. NAITO

(3) For all i ∈ I, b ∈ B(λ), and k ∈ Z≥0,

e(k)
i

f (k)
i

· Glow

k

q,λ (b) ∈(cid:20)ϕi(b) + k
(cid:21)i
q,λ (b) ∈(cid:20)εi(b) + k
(cid:21)i

k

· Glow

Glow

q,λ (˜ek

i b) +

Glow

q,λ ( ˜f k

i b) +

(4) For all i ∈ I, b ∈ B(∞), and k ∈ Z≥0,

X
X

b′∈B(λ); wt(b′)=wt(˜ek

i b),

ϕi(b′)>ϕi(˜ek

i b)

b′∈B(λ); wt(b′)=wt( ˜f k

i b),

εi(b′)>εi( ˜f k

i b)

Z[q, q−1]Glow

q,λ (b′), and

Z[q, q−1]Glow

q,λ (b′).

Z[q, q−1]Glow

q

(b′), and

Z[q, q−1]Glow

q

(b′).

X

b′∈B(∞); wt(b′)=wt( ˜f k

i b),

εi(b′)>εi( ˜f k

i b)

X

b′∈B(∞); wt(b′)=wt(( ˜f ∗
i )kb)

ε∗
i (b′)>ε∗

i (( ˜f ∗

i )kb),

f (k)
i

· Glow

q

Glow

q

( ˜f k

i b) +

k

(b) ∈(cid:20)εi(b) + k
i ∈(cid:20)ε∗

i (b) + k

(cid:21)i
(cid:21)i

k

Glow

q

(b) · f (k)

Glow

q

(( ˜f ∗

i )kb) +

q (u−) are invariant
Proof. It follows from the equality ∗◦− = −◦∗ that L(∞) and hence L(∞)∩L(∞)∩U Q
under Kashiwara’s involution ∗, which implies part (1). Part (2) (resp., part (3)) is an immediate
consequence of [Kas2, Lemma 7.3.2] (resp., [Kas4, equation (3.1.2)]). Now we deduce the ﬁrst assertion
of part (4) from part (2) and part (3) (here we take a dominant integral weight λ such that hλ, hii,
i ∈ I, are suﬃciently large for each b ∈ B(∞)). Finally, the second assertion of part (4) follows from
the ﬁrst assertion of part (4) and from the equalities

(Glow

q

(b) · f (k)

i

)∗ = (f (k)
i
= f (k)

i

)∗ · Glow

(b)∗

q
(b∗)

· Glow

q

(since ∗ is a Q(q)-algebra anti-involution)

(by part (1)).

(cid:3)

Deﬁnition 2.9. For w ∈ W and a dominant integral weight λ, let vq,wλ ∈ Vq(λ) denote the (extremal)
weight vector of weight wλ. Then, the Uq(u)-submodule Vq,w(λ) := Uq(u) · vq,wλ ⊂ Vq(λ) is called the
Demazure module corresponding to w.

Denote by b∞ ∈ B(∞) the element corresponding to 1 ∈ Uq(u−), and by bλ ∈ B(λ) the highest weight

element.

Proposition 2.10 (see [Kas4, Propositions 3.2.3, 3.2.5]). Let i = (ir, . . . , i1) be a reduced word for
w ∈ W (notice the ordering of indices), and λ a dominant integral weight.

(1) The subset

Bw(∞) := { ˜f ar
ir

· · · ˜f a1

i1 b∞ | a1, . . . , ar ∈ Z≥0} ⊂ B(∞)

is independent of the choice of a reduced word i, and ˜eiBw(∞) ⊂ Bw(∞) ∪ {0} for all i ∈ I.

(2) The subset

Bw(λ) := { ˜f ar
ir

· · · ˜f a1

i1 bλ | a1, . . . , ar ∈ Z≥0} \ {0} ⊂ B(λ)

is independent of the choice of a reduced word i, and ˜eiBw(λ) ⊂ Bw(λ) ∪ {0} for all i ∈ I.

(3) The equality πλ(Bw(∞)) = Bw(λ) ∪ {0} holds; hence πλ induces a bijective map πλ : eBw(λ)
Bw(λ), where eBw(λ) := Bw(∞) ∩ eB(λ).

q,λ (b) | b ∈ Bw(λ)} forms a Q(q)-basis of Vq,w(λ).

(4) The set {Glow

∼
−→

The subsets Bw(∞), Bw(λ) are called Demazure crystals.

2.3. Polyhedral realizations of Demazure crystals. In this subsection, we recall some fundamental
properties of Nakashima-Zelevinsky polyhedral realizations of crystal bases (following [NZ], [N1], and
[N2]). Fix a reduced word i = (iN , . . . , i1) for the longest element w0 ∈ W , and consider an extension
˜i = (. . . , ik, . . . , iN +1, iN , . . . , i1) of i such that ik 6= ik+1 for all k ≥ 1, and such that the cardinality of
{k ≥ 1 | ik = i} is ∞ for each i ∈ I. Following [Kas4] and [NZ], we associate to ˜i a crystal structure

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

7

on Z∞ := {(. . . , ak, . . . , a2, a1) | ak ∈ Z and ak = 0 for k ≫ 0} as follows. For k ≥ 1, i ∈ I, and
a = (. . . , aj, . . . , a2, a1) ∈ Z∞, we set

σk(a) := ak +Xj>k

hαij , hik iaj ∈ Z,

σ(i)(a) := max{σk(a) | k ≥ 1, ik = i} ∈ Z, and
M (i)(a) := {k ≥ 1 | ik = i, σk(a) = σ(i)(a)}.

Since aj = 0 for j ≫ 0, the integers σk(a), σ(i)(a) are well-deﬁned; also, we have σ(i)(a) ≥ 0. Moreover,
M (i)(a) is a ﬁnite set if and only if σ(i)(a) > 0. Deﬁne a crystal structure on Z∞ by

wt(a) := −

ajαij , εi(a) := σ(i)(a), ϕi(a) := εi(a) + hwt(a), hii, and

∞Xj=1

˜eia :=((ak − δk,max M (i)(a))k≥1

0

if σ(i)(a) > 0,
otherwise,

˜fia := (ak + δk,min M (i)(a))k≥1

for i ∈ I and a = (. . . , ak, . . . , a2, a1) ∈ Z∞; we denote this crystal by Z∞
˜i

.

Proposition 2.11 (see [NZ, §§2.4]). The following hold.

(1) There exists a unique strict embedding of crystals Ψ˜i

: B(∞) ֒→ Z∞
˜i

such that Ψ˜i(b∞) =

(. . . , 0, . . . , 0, 0).

(2) For b ∈ B(∞), write Ψ˜i(b) = (. . . , ak, . . . , a2, a1). Then,

b∗ = ˜f a1
i1

˜f a2
i2 · · · b∞, and ˜eik−1

˜f ak
ik

˜f ak+1
ik+1

· · · b∞ = 0 for all k > 1;

namely, the sequence (ak)k≥1 is identical to the string parameterization of b∗ with respect to the
sequence (i1, i2, . . . , ik, . . .).

The embedding Ψ˜i (resp., the image Ψ˜i(B(∞))) is called the Kashiwara embedding (resp., the

Nakashima-Zelevinsky polyhedral realization of B(∞)) with respect to ˜i.

Remark 2.12. By [Kas4, Proposition 3.2.5 (ii)], it follows that ˜fiBw0(∞) ⊂ Bw0(∞) for all i ∈ I,
and hence that Bw0(∞) = B(∞). Since i = (iN , . . . , i1) is a reduced word for w0, we deduce that
Ψ˜i(B(∞)) ⊂ {(. . . , ak, . . . , a2, a1) ∈ Z∞
| ak = 0 for all k > N }; hence the image Ψ˜i(B(∞)) can be
˜i
regarded as a subset of ZN by

Ψ˜i(B(∞)) ֒→ ZN , (. . . , 0, 0, aN , . . . , a2, a1) 7→ (a1, a2, . . . , aN );

Ψ˜i−→ Ψ˜i(B(∞)) ֒→ ZN
note that the ordering of entries is reversed. Since the composite map B(∞)
is independent of the choice of an extension ˜i by Proposition 2.11 (2), we denote this map simply
by Ψi; this is also called the Kashiwara embedding with respect to i. Here we should mention that
Nakashima-Zelevinsky ([NZ]) called an explicit description Σ˜i of Ψ˜i(B(∞)) a polyhedral realization (see
[NZ, Theorem 3.1]); our terminology is slightly diﬀerent from the original one.

Let us write Z∞
˜i

[λ] := Z∞

˜i ⊗Rλ, and identify Z∞
˜i

[λ] with Z∞

˜i as a set; note that their crystal structures

are diﬀerent. By [N1, Theorem 3.1], there exists a unique strict embedding of crystals

Ωλ : B(λ) ֒→ B(∞) ⊗ Rλ

such that Ωλ(bλ) = b∞ ⊗ rλ. Remark that Ωλ(B(λ)) = {b ⊗ rλ | b ∈ eB(λ)}, and that Ωλ(πλ(b)) = b ⊗ rλ
for all b ∈ eB(λ), where πλ : eB(λ) ∼−→ B(λ) denotes the bijective map given in Proposition 2.7 (2).

Next we consider an arbitrary element w ∈ W . Let i = (ir, . . . , i1) be a reduced word for w, and
extend it to a reduced word ˆi = (iN , . . . , ir+1, ir, . . . , i1) for w0.
In addition, we take an extension
˜i = (. . . , ik, . . . , iN +1, iN , . . . , i1) of ˆi as above.

Proposition 2.13 ([N1, Theorem 3.2] and [N2, Propositions 3.1, 3.3 (i)]). For a dominant integral
weight λ, the following hold.

8

N. FUJITA AND S. NAITO

(1) There exists a unique strict embedding of crystals

Ψ(λ)

˜i

: B(λ) ֒

Ωλ−−→ B(∞) ⊗ Rλ ֒

Ψ˜i⊗id
−−−−→ Z∞

˜i ⊗ Rλ = Z∞
˜i

[λ]

such that Ψ(λ)

˜i

(bλ) = (. . . , 0, . . . , 0, 0) ⊗ rλ.

(2) There hold the equalities

Ψ˜i(Bw(∞)) = {(. . . , ak, . . . , a2, a1) ∈ Ψ˜i(B(∞)) | ak = 0 for all k > r},
Ψ(λ)

(Bw(λ)) = {(. . . , ak, . . . , a2, a1) ⊗ rλ ∈ Ψ(λ)

(B(λ)) | ak = 0 for all k > r}.

˜i

˜i

We call Ψ(λ)

˜i

(Bw(λ)) the polyhedral realization of Bw(λ) with respect to ˜i.

Deﬁnition 2.14. The sets Ψ˜i(Bw(∞)) and Ψ(λ)

˜i

(Bw(λ)) can be regarded as subsets of Zr by

Ψ˜i(Bw(∞)) ֒→ Zr, (. . . , 0, 0, ar, . . . , a2, a1) 7→ (a1, a2, . . . , ar), and
Ψ(λ)
(Bw(λ)) ֒→ Zr, (. . . , 0, 0, ar, . . . , a2, a1) ⊗ rλ 7→ (a1, a2, . . . , ar).

˜i

Since the composite maps Bw(∞)
independent of the choices of ˆi and ˜i, we denote these maps simply by Ψ(w)
these are also called the Kashiwara embeddings with respect to i.

Ψ˜i−→ Ψ˜i(Bw(∞)) ֒→ Zr and Bw(λ)

i

Ψ(λ)
˜i−−−→ Ψ(λ)

˜i

(Bw(λ)) ֒→ Zr are
, respectively;

and Ψ(λ,w)

i

Deﬁnition 2.15. Deﬁne a subset S(λ,w)

i

⊂ Z>0 × Zr by
{(k, Ψ(kλ,w)

i

(b)) | b ∈ Bw(kλ)},

S(λ,w)

i

:= [k>0

and denote by C(λ,w)

i

⊂ R≥0 × Rr the smallest real closed cone containing S(λ,w)

i

, that is,

C(λ,w)

i

:= {c · (k, a) | c ∈ R>0 and (k, a) ∈ S(λ,w)

i

},

where H means the closure of H ⊂ R≥0 × Rr with respect to the Euclidean topology. Now let us deﬁne
a subset ∆(λ,w)

⊂ Rr by

i

The set ∆(λ,w)

i

is also called the polyhedral realization of Bw(λ) with respect to i.

∆(λ,w)

i

:= {a ∈ Rr | (1, a) ∈ C(λ,w)

i

}.

We will prove that the set S(λ,w)

i

the polyhedral realization Ψ(λ,w)
We need the following lemma.

i

is identical to the set of all integral points in C(λ,w)

\ {0}, and that
(Bw(λ)) of Bw(λ) is identical to the set of all integral points in ∆(λ,w)
.

i

i

eB(λ) = {b ∈ B(∞) | ε∗

Lemma 2.16 (see [N1, Theorem 3.1]). For the subset eB(λ) of B(∞) deﬁned in Proposition 2.7 (2),

there holds the equality

i (b) ≤ hλ, hii for all i ∈ I}.

For iop := (i1, . . . , ir), which is a reduced word for w−1, let Φiop : Bw−1(∞) ֒→ Zr denote the
corresponding string parameterization; namely, if we write Φiop (b) = (a1, . . . , ar) for b ∈ Bw−1(∞), then
we have

˜f ak
ik

˜f ak+1
ik+1

· · · ˜f ar
ir

b = ˜f a1
i1

˜f a2
i2 · · · ˜f ar

ir

i

b∞ = 0 for 1 < k ≤ r.

b∞, and ˜eik−1
It follows from Proposition 2.11 (2) that Ψ(w)
i = Φiop ◦ ∗ on Bw(∞); here we note that Bw(∞)∗ =
Bw−1(∞) by [Kas4, Proposition 3.3.1]. Therefore, if we denote by Ci ⊂ Rr the smallest real closed cone
containing Ψ(w)
(Bw(∞)), then Ci is identical to the string cone associated to iop (see [BZ, §§3.2]), and
the equality Ψ(w)
(Bw(∞)) = Ci ∩ Zr holds (see [Lit, Section 1] and [BZ, Proposition 3.5]). Note that a
system of explicit linear inequalities deﬁning Ci is given in [BZ, Theorem 3.10]. In particular, the real
closed cone Ci is a rational convex polyhedral cone, that is, there exists a ﬁnite number of rational points
a1, . . . , al ∈ Qr such that Ci = R≥0a1 + · · · + R≥0al. Now for (a1, . . . , ar) ∈ Ψ(w)
(Bw(∞)), Proposition
2.7 (3) implies that πλ( ˜f a1
bλ. Therefore, if we take a dominant integral weight
λ such that ˜f a1

bλ 6= 0, then we deduce from the remark following Proposition 2.7 that

i1 · · · ˜f ar

i1 · · · ˜f ar

b∞) = ˜f a1

ir

ir

i

i

i1 · · · ˜f ar

ir

εi( ˜f a1

i1 · · · ˜f ar

ir

b∞) = εi( ˜f a1

i1 · · · ˜f ar

ir

bλ)

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

9

for all i ∈ I. Using this observation, we obtain the following.

Proposition 2.17 (see [F, Remark 5.4 and Corollary 5.20]). There exists a piecewise-linear function ψ(i)
of a1, . . . , ar for i ∈ I such that εi( ˜f a1
(Bw(∞)).

i (a1, . . . , ar) for all (a1, . . . , ar) ∈ Ψ(w)

b∞) = ψ(i)

i

i

i1 · · · ˜f ar

ir

Corollary 2.18. The following hold.

(1) The set S(λ,w)

i

is identical to the set of (k, a1, . . . , ar) ∈ Z>0 × Zr such that (a1, . . . , ar) ∈ Ci,
i (a1, . . . , ar) ≤ hkλ, hii for all i ∈ I. In particular, the real closed cone C(λ,w)
i (a1, . . . , ar) ≤ hkλ, hii for all

and such that ψ(i)
is identical to the set of (k, a1, . . . , ar) ∈ R≥0 × Ci such that ψ(i)
i ∈ I.

i

(2) The real closed cone C(λ,w)

i

is a ﬁnite union of rational convex polyhedral cones, and the equality

S(λ,w)

i

= C(λ,w)

i

∩ (Z>0 × Zr) holds.

Proof. Part (2) is an immediate consequence of part (1); hence it is suﬃcient to prove part (1). By
Proposition 2.10 (3) and Lemma 2.16, we deduce that

Ψ(kλ,w)

i

(Bw(kλ)) = {(a1, . . . , ar) ∈ Ψ(w)

i

(Bw(∞)) | εi( ˜f a1

i1 · · · ˜f ar

ir

b∞) ≤ hkλ, hii for all i ∈ I}

= {(a1, . . . , ar) ∈ Ci ∩ Zr | ψ(i)
(by Proposition 2.17 since Ψ(w)

i

(Bw(∞)) = Ci ∩ Zr)

i (a1, . . . , ar) ≤ hkλ, hii for all i ∈ I}

for all k ∈ Z>0. This implies the ﬁrst assertion of part (1). Then, since ψ(i)
second assertion of part (1) follows immediately. This proves the corollary.

i

is piecewise-linear, the
(cid:3)

By the deﬁnition of ∆(λ,w)

i

, we obtain the following from Corollary 2.18 (1).

Corollary 2.19. The polyhedral realization ∆(λ,w)
ψ(i)

i (a1, . . . , ar) ≤ hλ, hii for all i ∈ I.

i

is identical to the set of (a1, . . . , ar) ∈ Ci such that

i

i

i

∩ Zr = Ψ(λ,w)

is a ﬁnite union of rational convex polytopes, and the
(Bw(λ)) holds; here, a subset ∆ ⊂ Rr is called a rational convex polytope

Corollary 2.20. The polyhedral realization ∆(λ,w)
equality ∆(λ,w)
if it is a convex hull of a ﬁnite number of rational points.
Proof. By Lemma 2.16, we deduce that 0 ≤ ak ≤ hλ, hik i, 1 ≤ k ≤ r, for all (a1, . . . , ar) ∈ ∆(λ,w)
;
therefore, the polyhedral realization ∆(λ,w)
is bounded, and hence compact. Also, by Corollary 2.19,
the polyhedral realization ∆(λ,w)
is given by a ﬁnite number of piecewise-linear inequalities. These imply
the ﬁrst assertion of the corollary. Now the second assertion is an immediate consequence of Corollary
2.18 (2). This proves the corollary.
(cid:3)

i

i

i

In Section 4, we will prove that the polyhedral realization ∆(λ,w)

is identical to the Newton-Okounkov
convex body of a Schubert variety with respect to a speciﬁc valuation, and that these are indeed rational
convex polytopes. Note that we do not necessarily assume that (˜i, λ) is ample (see Deﬁnition 5.1); when
it is ample, we obtain a system of explicit aﬃne inequalities deﬁning the polyhedral realization ∆(λ,w)
(see Corollary 5.3).

i

i

3. Newton-Okounkov convex bodies of Schubert varieties

3.1. Newton-Okounkov convex bodies. Here we review the deﬁnition of Newton-Okounkov convex
bodies (following [HK], [Kav], [KK1], and [KK2]). Let R be a C-algebra without nonzero zero-divisors,
and ﬁx a total order < on Zr, r ≥ 1, respecting the addition.

Deﬁnition 3.1. A map v : R \ {0} → Zr is called a valuation on R if the following hold: for every
σ, τ ∈ R \ {0} and c ∈ C \ {0},
(i) v(σ · τ ) = v(σ) + v(τ ),
(ii) v(c · σ) = v(σ),
(iii) v(σ + τ ) ≥ min{v(σ), v(τ )} unless σ + τ = 0.

Note that we need to ﬁx a total order on Zr whenever we consider a valuation. The following is a

fundamental property of valuations.

10

N. FUJITA AND S. NAITO

Proposition 3.2 (see, for instance, [Kav, Proposition 1.8]). Let v be a valuation on R. Assume that
σ1, . . . , σs ∈ R \ {0}, and that v(σ1), . . . , v(σs) are all distinct.

(1) The elements σ1, . . . , σs are linearly independent over C.
(2) For c1, . . . , cs ∈ C such that σ := c1σ1 + · · · + csσs 6= 0,

v(σ) = min{v(σt) | 1 ≤ t ≤ s, ct 6= 0}.

For a ∈ Zr and a valuation v on R with values in Zr, we set Ra := {σ ∈ R | σ = 0 or v(σ) ≥ a}; this

1, . . . , a′
k (resp., ar = a′

is a C-subspace of R. The leaf above a ∈ Zr is deﬁned to be the quotient space bRa := Ra/Sa<b Rb. A
valuation v is said to have one-dimensional leaves if dim(bRa) = 0 or 1 for all a ∈ Zr.

r)) if and only if there exists 1 ≤ k ≤ r such that a1 = a′
r, . . . , ak+1 = a′

Example 3.3. Deﬁne two lexicographic orders < and ≺ on Zr by (a1, . . . , ar) < (a′
r) (resp.,
(a1, . . . , ar) ≺ (a′
k−1,
ak < a′
k). Let C(tr, . . . , t1) denote the rational function
ﬁeld in r variables. The lexicographic order < (resp., ≺) on Zr induces a total order (denoted by
the same symbol < (resp., ≺)) on the set of all monomials in the polynomial ring C[tr, . . . , t1] as
1 < ta′
follows: tar
(resp., tar
1, . . . , a′
r)
r)). First we consider the case that the ﬁxed total order on Zr is the
(resp., (a1, . . . , ar) ≺ (a′
lexicographic order <. Let us deﬁne a map v : C(tr, . . . , t1) \ {0} → Zr by v(f /g) := v(f ) − v(g) for
f, g ∈ C[tr, . . . , t1] \ {0}, and by

1 ) if and only if (a1, . . . , ar) < (a′

1, . . . , ak−1 = a′

r · · · ta1

1 ≺ ta′

r · · · ta′

r

k+1, ak < a′

r · · · ta′

r

1

1

r · · · ta1

1, . . . , a′

1, . . . , a′

1

v(f ) := −(a1, . . . , ar) for f = ctar

r · · · ta1

1 + (lower terms) ∈ C[tr, . . . , t1] \ {0},

where c ∈ C \ {0}, and by “lower terms” we mean a linear combination of monomials smaller than
r · · · ta1
tar
in the total order <. It is obvious that v is a valuation with one-dimensional leaves. Since
1
the induced order < on the set of all monomials satisﬁes t1 > · · · > tr, we call the valuation v on
C(tr, . . . , t1) the highest term valuation with respect to the lexicographic order t1 > · · · > tr. Similarly,
the highest term valuation ˜v with respect to the lexicographic order tr ≻ · · · ≻ t1 is deﬁned to be the
valuation on C(tr, . . . , t1) given by

˜v(f ) := −(ar, . . . , a1) for f = ctar

r · · · ta1

1 + (lower terms) ∈ C[tr, . . . , t1] \ {0},

where c ∈ C \ {0}, and by “lower terms” we mean a linear combination of monomials smaller than
r · · · ta1
tar
in the total order ≺; note that the induced order ≺ on the set of all monomials satisﬁes tr ≻
1
· · · ≻ t1. If r = 3 and f = t1t2 + t2
3 ∈ C[t3, t2, t1], then we have v(f ) = −(1, 1, 0) and ˜v(f ) = −(2, 0, 0).

Let V (λ) be the irreducible highest weight G-module with highest weight λ, and vλ ∈ V (λ) the

highest weight vector. Given a dominant integral weight λ, we deﬁne a line bundle Lλ on G/B by

where B acts on G × C on the right as follows:

Lλ := (G × C)/B,

(g, c) · b = (gb, λ(b)c)

for g ∈ G, c ∈ C, and b ∈ B. If we deﬁne a morphism ρλ : G/B → P(V (λ)) by

g mod B 7→ Cg · vλ,

then we obtain ρ∗
ρλ induces a C-linear map

λ(O(1)) = Lλ, where O(1) denotes the twisting sheaf of Serre. Hence the morphism

λ : H 0(P(V (λ)), O(1)) → H 0(G/B, Lλ).
ρ∗

From the Borel-Weil theorem, we know that this is an isomorphism of G-modules. Here we recall that
for an arbitrary ﬁnite-dimensional G-module V over C, the space H 0(P(V ), O(1)) of global sections is
identiﬁed with the dual G-module V ∗ := HomC(V, C). Hence the isomorphism ρ∗
λ is regarded as an
isomorphism of G-modules from V (λ)∗ to H 0(G/B, Lλ).

Deﬁnition 3.4. For w ∈ W , let us denote by X(w) the Zariski closure of BewB/B in G/B, where
ew ∈ G denotes a lift for w; note that the closed subvariety X(w) is independent of the choice of ew. The

X(w) is called the Schubert variety corresponding to w ∈ W .

It is well-known that X(w) is a normal projective variety of complex dimension ℓ(w); here, ℓ(w)
denotes the length of w. Now the line bundle Lλ on G/B induces a line bundle on X(w), which we
denote by the same symbol Lλ.

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

11

Deﬁnition 3.5. For w ∈ W and a dominant integral weight λ, let vwλ ∈ V (λ) denote the (extremal)
weight vector of weight wλ. Deﬁne a B-submodule Vw(λ) ⊂ V (λ) by

this is called the Demazure module corresponding to w ∈ W .

Vw(λ) :=Xb∈B

Cbvwλ;

From the Borel-Weil theorem, we know that the space H 0(X(w), Lλ) of global sections is a B-module
isomorphic to the dual module Vw(λ)∗. The ring of sections R(Lλ) is the Z≥0-graded C-algebra obtained
from Lλ by

R(Lλ) :=Mk≥0

H 0(X(w), L⊗k

λ ).

If we take a section τ ∈ H 0(X(w), Lλ) \ {0}, then the C-vector space R(Lλ)k := H 0(X(w), L⊗k
regarded as a ﬁnite-dimensional subspace of C(X(w)) as follows:

λ ) can be

Hence a valuation on C(X(w)) induces a map from R(Lλ)k \ {0}.

R(Lλ)k ֒→ C(X(w)), σ 7→ σ/τ k.

Deﬁnition 3.6. For w ∈ W and a dominant integral weight λ, let v : C(X(w)) \ {0} → Zr be a
valuation with one-dimensional leaves with r := ℓ(w), and τ ∈ H 0(X(w), Lλ) \ {0}. Deﬁne a subset
S(X(w), Lλ, v, τ ) ⊂ Z>0 × Zr by

S(X(w), Lλ, v, τ ) := [k>0

{(k, v(σ/τ k)) | σ ∈ R(Lλ)k \ {0}},

and denote by C(X(w), Lλ, v, τ ) ⊂ R≥0 × Rr the smallest real closed cone containing S(X(w), Lλ, v, τ ).
Let us deﬁne a subset ∆(X(w), Lλ, v, τ ) ⊂ Rr by

∆(X(w), Lλ, v, τ ) := {a ∈ Rr | (1, a) ∈ C(X(w), Lλ, v, τ )};

this is called the Newton-Okounkov convex body of X(w) associated to Lλ, v, and τ .

From the deﬁnition of valuations, it is obvious that the set S(X(w), Lλ, v, τ ) is a semigroup. There-
fore, we deduce that the real closed cone C(X(w), Lλ, v, τ ) is a closed convex cone, and that the set
∆(X(w), Lλ, v, τ ) is a convex set. Moreover, it follows from [KK2, Theorem 2.30] that ∆(X(w), Lλ, v, τ )
is a convex body, i.e., a compact convex set. It is well-known that Lλ is very ample if and only if λ is
a regular dominant integral weight, i.e., hλ, hii ∈ Z>0 for all i ∈ I. In this case, the real dimension of
∆(X(w), Lλ, v, τ ) is equal to r (= ℓ(w)) by [KK2, Corollary 3.2]; this is not necessarily the case if λ is
not regular.

Remark 3.7. If Lλ is a very ample line bundle, then we can take a closed immersion X(w) ֒→
P(H 0(X(w), Lλ)∗) such that Lλ is the pullback of the twisting sheaf O(1) of Serre. Denote by R =

Lk≥0 Rk the corresponding homogeneous coordinate ring. In many literatures including [HK], Newton-

Okounkov convex bodies are deﬁned by using R instead of R(Lλ). However, since the Schubert variety
X(w) is normal, we deduce from [Hart, Chap. II, Ex. 5.14] that Rk = R(Lλ)k for all k ≫ 0. In addition,
since S(X(w), Lλ, v, τ ) is a semigroup, the real closed cone C(X(w), Lλ, v, τ ) is identical to the smallest
real closed cone containing

{(k, v(σ/τ k)) | σ ∈ R(Lλ)k \ {0}}

[k>k′

for k′ ≫ 0. Therefore, R and R(Lλ) are interchangeable in the deﬁnition of Newton-Okounkov convex
bodies.

Remark 3.8. If we take another section τ ′ ∈ H 0(X(w), Lλ) \ {0}, then S(X(w), Lλ, v, τ ′) is the shift of
S(X(w), Lλ, v, τ ) by kv(τ /τ ′) in {k}×Zr. Hence it follows that ∆(X(w), Lλ, v, τ ′) = ∆(X(w), Lλ, v, τ )+
v(τ /τ ′). Thus, the Newton-Okounkov convex body ∆(X(w), Lλ, v, τ ) does not essentially depend on
the choice of τ ∈ H 0(X(w), Lλ) \ {0}.

12

N. FUJITA AND S. NAITO

3.2. Highest term valuations. In this subsection, we introduce a speciﬁc valuation on C(X(w)),
which we mainly use. Let Pi (resp., U −
i ) denote the minimal parabolic subgroup (resp., the opposite root
subgroup) corresponding to an index i ∈ I, and set u−
i ). For a reduced word i = (ir, . . . , i1)
i
for w ∈ W , deﬁne the Bott-Samelson variety Zi by

:= Lie(U −

where Br acts on Pir × · · · × Pi1 on the right by

Zi := Pir × · · · × Pi1 /Br,

(pr, . . . , p1) · (br, . . . , b1) := (prbr, b−1

r pr−1br−1, . . . , b−1

2 p1b1)

for pr ∈ Pir , . . . , p1 ∈ Pi1 , and br, . . . , b1 ∈ B. It is well-known that the product map

(1)

Zi → G/B, (pr, . . . , p1) mod Br 7→ pr · · · p1 mod B,

induces a birational morphism onto the Schubert variety X(w) ⊂ G/B; hence a valuation on C(X(w))
can be identiﬁed with a valuation on C(Zi). For the identity element e ∈ G, regard U −
i1 as
ir
an aﬃne open neighborhood of (e, . . . , e) mod Br in Zi by:

× · · · × U −

U −
ir

× · · · × U −
i1

֒→ Zi, (ur, . . . , u1) 7→ (ur, . . . , u1) mod Br.

(2)
By using the isomorphism of varieties Cr ∼−→ U −
i1 , (tr, . . . , t1) 7→ (exp(trFir ), . . . , exp(t1Fi1 )),
ir
we identify the function ﬁeld C(Zi) = C(U −
× · · · × U −
i1 ) with the rational function ﬁeld C(tr, . . . , t1).
ir
Now we deﬁne a valuation vi on C(X(w)) to be the highest term valuation on C(tr, . . . , t1) with respect
to the lexicographic order t1 > · · · > tr (see Example 3.3). In the following of this section, we describe
vi in terms of the Chevalley generators. If we set w≥k := sir sir−1 · · · sik for 1 ≤ k ≤ r, then we obtain
a sequence of subvarieties

× · · · × U −

X(w≥r) ⊂ X(w≥r−1) ⊂ · · · ⊂ X(w≥1) = X(w).

Note that the product map (1) induces a surjective birational morphism Z(ir ,...,ik) ։ X(w≥k), and
that the open immersion (2) induces an open immersion U −
֒→ Z(ir,...,ik), where Z(ir ,...,ik)
ir
denotes the Bott-Samelson variety corresponding to the reduced word (ir, . . . , ik); hence the function
ﬁeld C(X(w≥k)) is identiﬁed with the rational function ﬁeld C(tr, . . . , tk). Consider the right action of
U −
, . . . , ur ∈ U −
;
ik
ir
this induces right actions of U −
ik

given by (ur, . . . , uk)·u = (ur, . . . , uku) for u, uk ∈ U −
ik
× · · · × U −
ik

, uk+1 ∈ U −
], which are given by:

on C[tr, . . . , tk] = C[U −
ir

× · · · × U −
ik

×· · ·×U −
ik

and u−
ik

on U −
ir

ik+1

f (tr, . . . , tk) · exp(sFik ) = f (tr, . . . , tk+1, tk − s), and hence

(3)

f (tr, . . . , tk) · Fik = −

for s ∈ C and f (tr, . . . , tk) ∈ C[tr, . . . , tk].

∂
∂tk

f (tr, . . . , tk)

Proposition 3.9. For f (tr, . . . , t1) ∈ C[tr, . . . , t1], write vi(f (tr, . . . , t1)) = −(a1, . . . , ar). Then, there
hold the equalities

a1 = max{a ∈ Z≥0 | f (tr, . . . , t1) · F a
a2 = max{a ∈ Z≥0 | (f (tr, . . . , t1) · F a1
...
ar = max{a ∈ Z≥0 | (· · · ((f (tr, . . . , t1) · F a1

i1 6= 0},
i1 )|X(w≥2) · F a

i2 6= 0},

i1 )|X(w≥2) · F a2

i2 ) · · · )|X(w≥r ) · F a

ir 6= 0}.

Proof. It follows from the deﬁnition of vi that a1 is equal to the degree of f (tr, . . . , t1) with respect to
the variable t1. Therefore, we deduce that

a1 = max{a ∈ Z≥0 |

∂a
∂ta
1

f (tr, . . . , t1) 6= 0}

= max{a ∈ Z≥0 | f (tr, . . . , t1) · F a

i1 6= 0}

(by equation (3)).

We remark that since the polynomial f (tr, . . . , t1) · F a1
i1 does not contain the variable t1, the restriction
(f (tr, . . . , t1)·F a1
i1 )|X(w≥2) is identical to f (tr, . . . , t1)·F a1
i1 ∈ C[tr, . . . , t2] as a polynomial in the variables
tr, . . . , t2; here the restriction map C(X(w)) → C(X(w≥2)) is given by t1 7→ 0. Hence we see from the
deﬁnition of vi that v(ir ,...,i2)((f (tr, . . . , t1) · F a1
i1 )|X(w≥2)) = −(a2, . . . , ar), where v(ir ,...,i2) denotes the
valuation on C(X(w≥2)) deﬁned to be the highest term valuation on C(tr, . . . , t2) (= C(U −
i2 ))
ir
with respect to the lexicographic order t2 > · · · > tr. By induction on r = ℓ(w), the assertion of the
proposition follows.
(cid:3)

× · · · × U −

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

13

4.1. Statement of the main result. If we regard C as a Q[q, q−1]-module by the natural Q-algebra
homomorphism Q[q, q−1] → C, q 7→ 1, then the C-vector space V Q
q (λ) ⊗Q[q,q−1] C has a g-module
structure given by

4. Main result

Ei(v ⊗ c) := (eiv) ⊗ c, Fi(v ⊗ c) := (fiv) ⊗ c, hi(v ⊗ c) :=(cid:18) ti − t−1

qi − q−1

i

i

v(cid:19) ⊗ c

λ (b) ∈ V (λ) the specialization of Glow

for i ∈ I, v ∈ V Q
q (λ), and c ∈ C; this g-module is isomorphic to V (λ) (see, for instance, [J2, Lemma
5.14]). We denote by Glow
q,λ (b) ⊗ 1 ∈
q (λ) ⊗Q[q,q−1] C ≃ V (λ). Then, Proposition 2.10 (4) implies that the set {Glow
V Q
λ (b) | b ∈ Bw(λ)} forms
a C-basis of the Demazure module Vw(λ). Also, we denote by {Gup
λ,w(b) | b ∈ Bw(λ)} ⊂ Vw(λ)∗ =
H 0(X(w), Lλ) the dual basis, and by τλ ∈ V (λ)∗ = H 0(G/B, Lλ) the lowest weight vector such that
τλ(vλ) = 1; by restricting the section τλ, we obtain a section in H 0(X(w), Lλ), which we denote by the
same symbol τλ. The following is the main result of this paper.

q,λ (b) at q = 1, i.e., Glow

λ (b) := Glow

Theorem 4.1. Let i ∈ I r be a reduced word for w ∈ W , and λ a dominant integral weight. Then,
Ψ(λ,w)

(b) = −vi(Gup

λ,w(b)/τλ) for all b ∈ Bw(λ).

i

We give a proof of this theorem in the next subsection.

Corollary 4.2. Let ω : R × Rr ∼−→ R × Rr be the linear automorphism given by ω(k, a) = (k, −a). Then,
S(λ,w)

= ω(C(X(w), Lλ, vi, τλ)), and ∆(λ,w)

= ω(S(X(w), Lλ, vi, τλ)), C(λ,w)

= −∆(X(w), Lλ, vi, τλ).

i

i

i

Proof. Since L⊗k

λ = Lkλ and τ k

λ = τkλ in H 0(X(w), Lkλ) for all k ∈ Z>0, it follows that

S(X(w), Lλ, vi, τλ) = [k>0

{(k, vi(σ/τkλ)) | σ ∈ H 0(X(w), Lkλ) \ {0}}.

Also, since Ψ(kλ,w)
4.1 that

i

(b), b ∈ Bw(kλ), are all distinct, we deduce from Proposition 3.2 (2) and Theorem

{Ψ(kλ,w)

i

(b) | b ∈ Bw(kλ)} = {−vi(σ/τkλ) | σ ∈ H 0(X(w), Lkλ) \ {0}}

for all k ∈ Z>0, which implies that S(λ,w)
assertions follow immediately by the deﬁnitions.

i

= ω(S(X(w), Lλ, vi, τλ)). From this equality, the other
(cid:3)

Corollary 4.3. Let i ∈ I r be a reduced word for w ∈ W , and λ a dominant integral weight.

(1) The sets S(λ,w)
(2) The real closed cones C(λ,w)

i

i

and S(X(w), Lλ, vi, τλ) are both ﬁnitely generated semigroups.

and C(X(w), Lλ, vi, τλ) are both rational convex polyhedral cones,

and the equality S(X(w), Lλ, vi, τλ) = C(X(w), Lλ, vi, τλ) ∩ (Z>0 × Zr) holds.

(3) The compact sets ∆(λ,w)

i

and ∆(X(w), Lλ, vi, τλ) are both rational convex polytopes, and the

equality Ψ(λ,w)

i

(Bw(λ)) = −∆(X(w), Lλ, vi, τλ) ∩ Zr holds.

Proof. Part (2) follows from Corollary 2.18 (2) and from the fact that C(X(w), Lλ, vi, τλ) is convex.
Then, part (3) is an immediate consequence of part (2) and Corollary 2.20. Finally, part (1) follows
from part (2) and from Gordan’s lemma (see, for instance, [CLS, Proposition 1.2.17]).
(cid:3)

4.2. Proof of Theorem 4.1. We make use of the lower global basis of Uq(u−). Let U − ⊂ G be
the unipotent radical of the opposite Borel subgroup, u− ⊂ g the Lie algebra of U −, and U (u−) the
q (u−) ⊗Q[q,q−1] C by identifying
universal enveloping algebra of u−; this C-algebra is isomorphic to U Q
Fi with fi ⊗ 1. For b ∈ B(∞), denote by Glow(b) ∈ U (u−) the specialization of Glow
(b) at q = 1, i.e.,
Glow(b) := Glow
q (u−) ⊗Q[q,q−1] C ≃ U (u−). The algebra U (u−) has a Hopf algebra structure
given by the following coproduct ∆, counit ε, and antipode S:

(b) ⊗ 1 ∈ U Q

q

q

for i ∈ I. Also, we can regard U (u−) as a multigraded C-algebra:

∆(Fi) = Fi ⊗ 1 + 1 ⊗ Fi, ε(Fi) = 0, and S(Fi) = −Fi

U (u−) = Md∈ZI

≥0

U (u−)d,

14

N. FUJITA AND S. NAITO

where the homogeneous component U (u−)d for d = (di)i∈I ∈ ZI
≥0 is deﬁned to be the C-subspace of
U (u−) spanned by elements Fj1 · · · Fj|d| for which the cardinality of {1 ≤ l ≤ |d| | jl = i} is equal to di

for all i ∈ I; here we set |d| :=Pi∈I di. Let

U (u−)∗

gr := Md∈ZI

≥0

U (u−)∗

d

be the graded dual of U (u−) endowed with the dual Hopf algebra structure, and {Gup(b) | b ∈ B(∞)} ⊂
gr the dual basis of {Glow(b) | b ∈ B(∞)} ⊂ U (u−). Proposition 2.8 (2) implies that πλ(Glow(b)) =
U (u−)∗
Glow
we denote by πλ : U (u−) ։ V (λ) the surjective U (u−)-module homomorphism given by πλ(u) = u · vλ
for u ∈ U (u−). Hence we obtain π∗
λ : V (λ)∗ ֒→ U (u−)∗
gr
denotes the dual of πλ. Note that the coordinate ring C[U −] has a Hopf algebra structure given by the
following coproduct ∆, counit ε, and antipode S:

λ (πλ(b)) for all b ∈ eB(λ), and that πλ(Glow(b)) = 0 for all b ∈ B(∞)\eB(λ), where by abuse of notation,

λ (πλ(b))) = Gup(b) for all b ∈ eB(λ), where π∗

λ(Gup

∆(f )(u1 ⊗ u2) = f (u1u2), ε(f ) = f (1), and S(f )(u) = f (u−1)

for f ∈ C[U −] and u, u1, u2 ∈ U −. It is well-known that this Hopf algebra is isomorphic to the dual
Hopf algebra U (u−)∗

gr as follows.

Lemma 4.4 (see, for instance, [GLS, Proposition 5.1]). Deﬁne a map Υ : U (u−)∗

gr → C[U −] by
gr and x ∈ u−; here, exp(x) ∈ U − and xl ∈ U (u−) for all

Υ(ρ)(exp(x)) =Pl≥0 ρ(xl)/l! for ρ ∈ U (u−)∗

l ∈ Z≥0. Then, the map Υ is an isomorphism of Hopf algebras.

Using the isomorphism Υ, we identify U (u−)∗

sections can be regarded as a C-subspace of C[U −] by: H 0(G/B, Lλ) = V (λ)∗ ֒
Also, we can regard U − as an aﬃne open subset of G/B by:

gr with C[U −]. Then, the space H 0(G/B, Lλ) of global
gr = C[U −].

π∗
λ−−→ U (u−)∗

hence we obtain an isomorphism

U − ֒→ G/B, u 7→ u mod B;

C(G/B) ∼−→ C(U −), f 7→ f |U −.

Lemma 4.5. The equality (τ /τλ)|U − = (Υ ◦ π∗
particular, the restriction of Gup

Proof. Because exp(x) · vλ ∈ vλ + x · V (λ) and τλ(x · V (λ)) = {0} for x ∈ u−, we have τλ(exp(x) · vλ) = 1.
Therefore, as an element of H 0(G/B, Lλ), the section τλ does not vanish on U − (֒→ G/B); in particular,
(τ /τλ)|U − ∈ C[U −]. Furthermore, we see that

λ (πλ(b))/τλ to U − is identical to Υ(Gup(b)) ∈ C[U −] for all b ∈ eB(λ).

λ)(τ ) holds in C[U −] for all τ ∈ H 0(G/B, Lλ).

In

(τ /τλ)(exp(x)) = τ (exp(x) · vλ)/τλ(exp(x) · vλ)

(by the deﬁnition of the isomorphism ρ∗
= τ (exp(x) · vλ)

(since τλ(exp(x) · vλ) = 1).

λ : V (λ)∗ ∼−→ H 0(G/B, Lλ) in §§3.1)

Also, we have

(Υ ◦ π∗

λ)(τ )(exp(x)) =Xl≥0
=Xl≥0

= τ (exp(x) · vλ).

(π∗

λ(τ ))(xl)/l!

(by the deﬁnition of Υ)

τ (xl · vλ)/l!

(since πλ(xl) = xl · vλ)

From these, the assertion of the lemma follows immediately.

(cid:3)

Let h·, ·i : U (u−)∗

gr × U (u−) → C denote the canonical pairing. Deﬁne a U (u−)-bimodule structure

on U (u−)∗

gr by

hx · ρ, yi := −hρ, x · yi, and

hρ · x, yi := −hρ, y · xi

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

15

for x ∈ u−, ρ ∈ U (u−)∗
structure, which is given by

gr, and y ∈ U (u−). Also, the coordinate ring C[U −] has a natural U −-bimodule

(u1 · f )(u2) := f (u−1
(f · u1)(u2) := f (u2u−1
1 )

1 u2), and

for u1, u2 ∈ U − and f ∈ C[U −]. This induces a U (u−)-bimodule structure on C[U −]. Note that Υ is an
isomorphism of U (u−)-bimodules.

Lemma 4.6. For k ≥ 0, i ∈ I, and b ∈ B(∞),

F (k)
i

Gup(b) · F (k)

i b) +

X

b′∈B(∞); wt(b′)=wt(˜ek

ZGup(b′), and

· Gup(b) ∈ (−1)k(cid:18)εi(b)
i ∈ (−1)k(cid:18)ε∗
k (cid:1), (cid:0)ε∗

i /k!, and (cid:0)εi(b)

k (cid:19)Gup(˜ek
k (cid:19)Gup((˜e∗
k (cid:1) are usual binomial coeﬃcients. In particular, there hold the

b′∈B(∞); wt(b′)=wt((˜e∗
i )kb)

X

ZGup(b′).

i )kb) +

εi(b′)<εi(˜ek

i (b′)<ε∗
ε∗

i (b)

i )kb),

i ((˜e∗

i (b)

i b),

i b)

Here, F (k)
i
equalities

:= F k

εi(b) = max{k ∈ Z≥0 | F (k)
i (b) = max{k ∈ Z≥0 | Gup(b) · F (k)
ε∗

i

i

· Gup(b) 6= 0}, F (εi(b))

i

6= 0}, Gup(b) · F (ε∗

· Gup(b) = (−1)εi(b)Gup(˜eεi(b)
i )ε∗

i (b)Gup((˜e∗

= (−1)ε∗

i (b))

i

i

b), and

i (b)b).

Proof. We prove only the assertion for Gup(b)·F (k)
For b′ ∈ B(∞), the coeﬃcient of Gup(b′) in Gup(b) · F (k)

i

is equal to

i

; the proof of the assertion for F (k)

·Gup(b) is similar.

i

hGup(b) · F (k)

i

, Glow(b′)i = (−1)khGup(b), Glow(b′) · F (k)

i

i.

If hGup(b), Glow(b′) · F (k)
deﬁnition of the graded dual U (u−)∗
i )kb′), i.e., b′ = (˜e∗
or ε∗

i (b) > ε∗

i (( ˜f ∗

i

i 6= 0, then we see that wt(b) = wt(( ˜f ∗

i )kb′), i.e., wt(b′) = wt((˜e∗

gr. Moreover, in this case, Proposition 2.8 (4) implies that b = ( ˜f ∗
i )kb or ε∗
i ∈ CGup((˜e∗

i )kb). Therefore, we deduce that

i (b′) < ε∗
i )kb) +

CGup(b′).

i ((˜e∗

i )kb) by the
i )kb′

Gup(b) · F (k)

X

b′∈B(∞); wt(b′)=wt((˜e∗
i )kb)

i (b′)<ε∗
ε∗

i ((˜e∗

i )kb),

The claim for the coeﬃcients also follows from the same proposition.

(cid:3)

Note that in Lemma 4.6, F (k)
6= 0) since F (k)

(resp., Gup(b) · F k
i

i

i = F k

i /k!.

· Gup(b) 6= 0 (resp., Gup(b) · F (k)

6= 0) if and only if F k
i

· Gup(b) 6= 0

i

If w0 ∈ W is the longest element, then the Schubert variety X(w0) is just the full ﬂag variety G/B.
For a reduced word i = (iN , . . . , i1) for w0, we deduce from the argument in §§3.2 that the product map

U −
iN

× · · · × U −

i1 → U −, (uN , . . . , u1) 7→ uN · · · u1,

is birational, and hence that the coordinate ring C[U −] can be regarded as a C-subalgebra of C[U −
iN
· · · × U −
polynomial in the variables tN , . . . , t1.

×
gr = C[U −] for b ∈ B(∞) as a

In this way, we think of Gup(b) ∈ U (u−)∗

i1 ] = C[tN , . . . , t1].

Proposition 4.7. For a reduced word i = (iN , . . . , i1) for w0 and b ∈ B(∞), the Kashiwara embedding
Ψi(b) is equal to −vi(Gup(b)).

Proof. First, observe that the right action of Fi1 on C[U −] (֒→ C[U −
× · · · × U −
i1 ]), which is induced
iN
by the right U (u−)-module structure on C[U −], is identical to that of Fi1 on C[U −
i1 ], which
iN
is deﬁned in §§3.2. Therefore, if we write Ψi(b) = (a1, . . . , aN ) and vi(Gup(b)) = −(a′
N ) for
b ∈ B(∞), then we deduce that

× · · · × U −

1, . . . , a′

1 = max{a ∈ Z≥0 | Gup(b) · F a
a′

i1 6= 0} (by Proposition 3.9)

= max{a ∈ Z≥0 | (˜e∗
= a1

(by Proposition 2.11 (2)).

i1 )ab 6= 0} (by the assertion of Lemma 4.6 for ε∗

i (b))

16

N. FUJITA AND S. NAITO

Repeating this argument, with b and U − replaced by (˜e∗
obtain (a′

N ) = (a1, . . . , aN ); here we use the equality
i1 = (−1)a1Gup((˜e∗

i1 )a1 b)

Gup(b) · F (a1)

1, . . . , a′

(by the assertion of Lemma 4.6 for Gup(b) · F (ε∗

i (b))

)

i

i1 )a1 b and U −
iN

· · · U −

i2 (⊂ U −), respectively, we

and the fact that the restriction of Gup(b)·F (a1)
i1 ∈ C[tN , . . . , t2]
as a polynomial in the variables tN , . . . , t2 (see also the proof of Proposition 3.9). This proves the
proposition.
(cid:3)

i2 is identical to Gup(b)·F (a1)

to U −
iN

· · · U −

i1

Since Ψi(b), b ∈ B(∞), are all distinct, we obtain the following from Proposition 3.2 (2).

Corollary 4.8. The polyhedral realization Ψi(B(∞)) is identical to −vi(C[U −] \ {0}).

Recall that the map Ψ(λ,w0)

i

(see Deﬁnition 2.14) gives an embedding of B(λ) into ZN , which we denote

simply by Ψ(λ)
we obtain the following by Lemma 4.5.

. It follows from the deﬁnition of Ψ(λ,w0)

i

i

that Ψ(λ)

i

(πλ(b)) = Ψi(b) for all b ∈ eB(λ). Hence

Corollary 4.9. The Kashiwara embedding Ψ(λ)

i

(b) is equal to −vi(Gup

λ (b)/τλ) for all b ∈ B(λ).

We remark that this corollary is precisely the assertion of Theorem 4.1 in the case w = w0. In the
rest of this subsection, we give a proof of Theorem 4.1 for an arbitrary w ∈ W . Let i = (ir, . . . , i1)
be a reduced word for w, and extend it to a reduced word ˆi = (iN , . . . , ir+1, ir, . . . , i1) for w0. By the
same argument as the one preceding Proposition 4.7, the reduced word ˆi gives an injective C-algebra
homomorphism C[U −] ֒→ C[tN , . . . , t1]. Moreover, the coordinate ring C[X(w) ∩ U −] can be identiﬁed
with a C-subalgebra of C[tr, . . . , t1] (⊂ C[tN , . . . , t1]) by using the birational morphism

U −
ir

× · · · × U −

i1 → X(w) ∩ U −, (ur, . . . , u1) 7→ ur · · · u1 mod B;

note that the restriction map C[U −] ։ C[X(w) ∩ U −] is given by

tk 7→(tk

0

if 1 ≤ k ≤ r,
if r + 1 ≤ k ≤ N.

Also, recall that the highest term valuation vˆi (resp., vi) is a valuation on C(tN , . . . , t1) (resp., C(tr, . . . , t1)).
For b ∈ Bw(λ), we have

−vˆi(Gup

λ (b)/τλ) = Ψ(λ)

ˆi

(b)
= (Ψ(λ,w)

i

(by Corollary 4.9)

(b), 0, . . . , 0

)

(by Deﬁnition 2.14).

N −r

| {z }

Therefore, the highest term of Gup
· · · > tN does not contain the variables tk for r + 1 ≤ k ≤ N , which implies that

λ (b)/τλ ∈ C[tN , . . . , t1] with respect to the lexicographic order t1 >

−vi((Gup

λ (b)/τλ)|X(w)∩U − ) = Ψ(λ,w)

i

(b).

Now we remark that the restriction map V (λ)∗ = H 0(G/B, Lλ) → H 0(X(w), Lλ) = Vw(λ)∗ is identical
to the dual of the inclusion map Vw(λ) ֒→ V (λ). This implies that Gup
λ,w(b), and hence
that (Gup
λ,w(b)/τλ; here recall that the section τλ ∈ H 0(X(w), Lλ) is deﬁned to
be the restriction of the section τλ ∈ H 0(G/B, Lλ). Thus, we obtain −vi(Gup
(b). This
completes the proof of Theorem 4.1.

λ (b)/τλ)|X(w)∩U − = Gup

λ,w(b)/τλ) = Ψ(λ,w)

λ (b)|X(w) = Gup

i

5. Applications

5.1. Explicit forms of Newton-Okounkov convex bodies. Under the assumption that (˜i, λ) is
ample (see Deﬁnition 5.1 below), the polyhedral realization Ψ(λ)
(Bw(λ)) in §§2.3 is given by a system
of explicit aﬃne inequalities. In order to obtain explicit forms of Newton-Okounkov convex bodies, we
recall the description of Ψ(λ)
(Bw(λ)), following [N1] and [N2]. Consider the inﬁnite-dimensional vector
space

˜i

˜i

Q∞ := {a = (. . . , ak, . . . , a2, a1) | ak ∈ Q and ak = 0 for k ≫ 0},

and write an aﬃne function ψ on Q∞ as ψ(a) = ψ0 +Pk≥1 ψkak, with ψ0, ψ1, . . . ∈ Q. Recall that

i = (ir, . . . , i1) is a reduced word for w ∈ W , and that ˜i = (. . . , ik, . . . , ir+1, ir, . . . , i1) is an extension of

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

17

i such that ik 6= ik+1 for all k ≥ 1, and such that the cardinality of {k ≥ 1 | ik = i} is ∞ for each i ∈ I.
For k ≥ 1, we set

k(+) := min{l > k | il = ik}, and

k(−) :=(max{l < k | il = ik}

0

if it exists,
otherwise.

For k ≥ 1 and i ∈ I, let β(±)

k

(a), λ(i)(a) denote the aﬃne functions given by

β(+)
k

hαij , hik iaj + ak(+) ,

(a) := ak + Xk<j<k(+)
(a) :=(ak(−) +Pk(−)<j<khαij , hik iaj + ak
−hλ, hik i +P1≤j<khαij , hik iaj + ak
λ(i)(a) := hλ, hii − X1≤j<˜i(i)

hαij , hiiaj − a˜i(i) ,

β(−)
k

if k(−) > 0,
if k(−) = 0,

where we write ˜i(i) := min{k ≥ 1 | ik = i}. Deﬁne operators bSk, k ≥ 1, for aﬃne functions on Q∞ by

bSk(ψ) :=(ψ − ψkβ(+)

ψ − ψkβ(−)

k

k

if ψk > 0,
if ψk ≤ 0,

and let Ξ˜i[λ] denote the set of all aﬃne functions generated by bSk, k ≥ 1, from the functions aj, j ≥ 1,

and λ(i)(a), i ∈ I; namely,

Ξ˜i[λ] := {bSjk · · ·bSj1 aj0 | k ≥ 0 and j0, . . . , jk ≥ 1}

∪ {bSjk · · ·bSj1 λ(i)(a) | k ≥ 0, i ∈ I, and j1, . . . , jk ≥ 1}.

Deﬁnition 5.1. Set

Σ˜i[λ] := {a ∈ Z∞
˜i

[λ] ⊂ Q∞ | ψ(a) ≥ 0 for all ψ ∈ Ξ˜i[λ]};

a pair (˜i, λ) is called ample if (. . . , 0, . . . , 0, 0) ∈ Σ˜i[λ].

Proposition 5.2 (see [N1, Theorem 4.1] and [N2, Proposition 3.1]). Assume that (˜i, λ) is ample. Then,
the image Ψ(λ)

(Bw(λ)) is identical to the set

˜i

{(. . . , ak, . . . , a2, a1) ∈ Σ˜i[λ] | ak = 0 for all k > r}.

For all ψ ∈ Ξ˜i[λ], the constant term ψ(. . . , 0, . . . , 0, 0) is regarded as a linear function of λ by the
deﬁnition of Ξ˜i[λ]; hence, for a ﬁxed dominant integral weight λ, we can regard an element of Ξ˜i[kλ] as
a linear function of k and aj, j ≥ 1. Therefore, we obtain the following from Deﬁnitions 2.14, 2.15 and
Corollary 4.2.

Corollary 5.3. Assume that (˜i, λ) is ample. Then,

S(λ,w)

i

C(λ,w)

i

∆(λ,w)

i

= ω(S(X(w), Lλ, vi, τλ))
= {(k, a1, . . . , ar) ∈ Z>0 × Zr | ψ(. . . , 0, 0, ar, . . . , a1) ≥ 0 for all ψ ∈ Ξ˜i[kλ]},

= ω(C(X(w), Lλ, vi, τλ))
= {(k, a1, . . . , ar) ∈ R≥0 × Rr | ψ(. . . , 0, 0, ar, . . . , a1) ≥ 0 for all ψ ∈ Ξ˜i[kλ]}, and

= −∆(X(w), Lλ, vi, τλ)
= {(a1, . . . , ar) ∈ Rr | ψ(. . . , 0, 0, ar, . . . , a1) ≥ 0 for all ψ ∈ Ξ˜i[λ]}.

18

N. FUJITA AND S. NAITO

5.2. Relation with Kashiwara’s involution. This subsection is devoted to describing Kashiwara’s
involution ∗ in terms of valuations on the rational function ﬁeld. We ﬁrst recall the main result of [Kav].
Let i = (ir, . . . , i1) be a reduced word for w ∈ W , and Φi : Bw(∞) ֒→ Zr the corresponding string
parameterization (see §§2.3). We set

; here we write eBw(kλ) :=

:= [k>0

i

eS(λ,w)

{(k, Φi(b)) | b ∈ eBw(kλ)} ⊂ Z>0 × Zr,
⊂ R≥0×Rr the smallest real closed cone containing eS(λ,w)

i

i

and denote by eC(λ,w)
Bw(∞) ∩ eB(kλ).
and λ a dominant integral weight. Deﬁne a subset e∆(λ,w)

i

this is called the string polytope associated to λ, w, and i.

i

e∆(λ,w)

:= {a ∈ Rr | (1, a) ∈ eC(λ,w)

i

};

⊂ Rr by

Deﬁnition 5.4 (see [Lit, Section 1] and [Kav, Deﬁnition 3.5]). Let i ∈ I r be a reduced word for w ∈ W ,

, there hold the inequalities

is bounded, and hence compact.

0 ≤ ar ≤ hλ, hir i, 0 ≤ ar−1 ≤ hλ − arαir , hir−1 i, . . . , 0 ≤ a1 ≤ hλ − arαir − · · · − a2αi2 , hi1 i.

i

i

Lemma 5.5 (see [Lit, Section 1]). For (a1, . . . , ar) ∈ e∆(λ,w)
In particular, the string polytope e∆(λ,w)
a dominant integral weight. Then, the real closed cone eC(λ,w)
the equality eS(λ,w)
convex polytope, and the equality Φi(eBw(λ)) = e∆(λ,w)

= eC(λ,w)

i

i

Proposition 5.6 (see [BZ, §§3.2 and Theorem 3.10]). Let i ∈ I r be a reduced word for w ∈ W , and λ
is a rational convex polyhedral cone, and
is a rational

i

∩ (Z>0 × Zr) holds. In particular, the string polytope e∆(λ,w)

∩ Zr holds.

i

i

We identify the function ﬁeld C(X(w)) with the rational function ﬁeld C(tr, . . . , t1) as in §§3.2, and
deﬁne a valuation ˜vi on C(X(w)) to be the highest term valuation on C(tr, . . . , t1) with respect to the
lexicographic order tr ≻ · · · ≻ t1 (see Example 3.3). The following is the main result of [Kav].

Proposition 5.7 (see [Kav, Theorem 4.1, Corollary 4.2, and Remark 4.6]). Let i ∈ I r be a reduced
word for w ∈ W , and λ a dominant integral weight.

(1) The string parameterization Φi(b) is equal to −˜vi(Gup

λ,w(πλ(b))/τλ) for all b ∈ eBw(λ).

(2) Deﬁne the linear automorphism ω : R × Rr ∼−→ R × Rr by ω(k, a) = (k, −a). Then, eS(λ,w)
ω(S(X(w), Lλ, ˜vi, τλ)), eC(λ,w)

= ω(C(X(w), Lλ, ˜vi, τλ)), and e∆(λ,w)

In the rest of this subsection, we consider the case that w = w0. For a reduced word i = (iN , . . . , i1)

= −∆(X(w), Lλ, ˜vi, τλ).

=

i

i

i

for w0, Lemma 4.5 and Proposition 5.7 (1) imply that

Φi(b) = −˜vi(Gup(b))

for all b ∈ B(∞), where we identify Gup(b) ∈ U (u−)∗
Φi(b), b ∈ B(∞), are all distinct, we deduce from Proposition 3.2 (2) that

gr with Υ(Gup(b)) ∈ C[U −] (⊂ C[tN , . . . , t1]). Since

Φi(B(∞)) = −˜vi(C[U −] \ {0}).

Now the equality Φi = Ψiop ◦ ∗ (by Proposition 2.11 (2)) implies that this set is also identical to the set

Ψiop (B(∞)) = −viop(C[U −] \ {0})

(by Corollary 4.8),

where iop := (i1, . . . , iN ), which is a reduced word for w−1
0 = w0. Let ηi : Ψi(B(∞)) → Φiop (B(∞))
(= Ψi(B(∞))) be the transition map given by ηi(Ψi(b)) = Φiop (b) for b ∈ B(∞). Then, we see that
Kashiwara’s involution ∗ corresponds to the map ηi through the Kashiwara embedding Ψi:

b∗ = Ψ−1

i

◦ ηi ◦ Ψi(b)

for all b ∈ B(∞). Take an extension ˜i = (. . . , ik, . . . , iN +1, iN , . . . , i1) of i as in §§2.3. It follows from
the deﬁnition of the crystal Z∞
˜i

that

˜emax
i

a =(cid:0)ak − δi,ik(cid:0)ak − ϕi(a≥k+1)(cid:1)(cid:1)k≥1
=(cid:0)(1 − δi,ik )ak + δi,ik(cid:0)σ(i)(a≥k+1) + hwt(a≥k+1), hii(cid:1)(cid:1)k≥1

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

19

for i ∈ I and a = (. . . , ak, . . . , a2, a1) ∈ Z∞
˜i
a := ˜eεi(a)
and ˜emax
then we deduce that

i

i

a. Also, if we set a′ := (. . . , 0, 0, aN , . . . , a1) ∈ Z∞
˜i

, where we set a≥k := (. . . , ak+1, ak) ∈ Z∞

(...,ik+1,ik) for k ≥ 1,
for (a1, . . . , aN ) ∈ Ψi(B(∞)),

ηi((a1, . . . , aN )) = Φiop (Ψ−1

˜i

(a′))

iN −1 · · · ˜emax

i1 Ψ−1
˜i

(a′)))

˜i

i1 Ψ−1
˜i

(a′)), . . . , εiN (˜emax

(by Remark 2.12)
= (εi1 (Ψ−1
(a′)), εi2 (˜emax
(by the deﬁnition of Φiop )
= (εi1 (a′), εi2 (˜emax
i1
(since Ψ˜i is a strict embedding of crystals)
iN −1 · · · ˜emax
= (σ(i1)(a′), σ(i2)(˜emax
i1
(by the deﬁnition of the crystal structure on Z∞
˜i ).

a′), . . . , σ(iN )(˜emax

a′), . . . , εiN (˜emax

iN −1 · · · ˜emax

a′))

i1

i1

a′))

From these, it follows that the map ηi : Ψi(B(∞)) → Ψi(B(∞)) is naturally extended to a piecewise-
linear map from the string cone Ci (see §§2.3 for the deﬁnition) to itself, which is also denoted by ηi; we
see from the equality Ci ∩ ZN = Ψi(B(∞)) that such an extension is unique. Since ∗2 = idB(∞), we see
that (ηi|Ψi(B(∞)))2 = idΨi(B(∞)), and hence that η2

i = idCi. Thus, we obtain the following.

Corollary 5.8. Let i be a reduced word for w0, and ηi : Ci → Ci a unique piecewise-linear map such
that b∗ = Ψ−1

◦ ηi ◦ Ψi(b) for all b ∈ B(∞).

i

(1) The map ηi corresponds to the change of valuations from vi to ˜viop :

ηi(−vi(Gup(b))) = −˜viop(Gup(b)) for all b ∈ B(∞).

(2) The equality η2
(3) The map ηi induces a bijective piecewise-linear map from the polyhedral realization ∆(λ,w0)

i = idCi holds.

=
= −∆(G/B, Lλ, ˜viop , τλ) for each dominant

i

−∆(G/B, Lλ, vi, τλ) onto the string polytope e∆(λ,w0)

integral weight λ.

iop

Example 5.9. If G = SL3(C) (of type A2) and i = (1, 2, 1), a reduced word for w0, then we deduce
from [NZ, Theorem 3.1] that the polyhedral realization Ψi(B(∞)) is identical to the semigroup

{(a1, a2, a3) ∈ Z3

≥0 | a2 ≥ a3}.

Recall that the coordinate ring C[U −] is regarded as a C-subalgebra of the polynomial ring C[t3, t2, t1]
by using the birational morphism

C3 → U −, (t3, t2, t1) 7→ exp(t3F1) exp(t2F2) exp(t1F1),

where we set

Since we have

0
0
0

0
0

0
0
0

0
1
0

F1 :=
0 , F2 :=
exp(t3F1) exp(t2F2) exp(t1F1) =

0 0
0 0

1 0 .

1

t1 + t3

t2t3

0
1
t2

0
0

1 ,

the coordinate ring C[U −] is identical to the C-subalgebra C[t1 + t3, t2, t2t3] (⊂ C[t3, t2, t1]); hence we
see from the deﬁnition of vi that

which is indeed identical to Ψi(B(∞)). Now it follows from the deﬁnition of the crystal Z∞
˜i

that

−vi(C[U −] \ {0}) = {(a1, a2, a3) ∈ Z3

≥0 | a2 ≥ a3},

ε1(a) = max{a3, a1 − a2 + 2a3}, ˜emax
ε2(˜emax
ε1(˜emax

a) = a2, ˜emax
˜emax
1

a) = min{a1, a2 − a3}

˜emax
1

1

1

2

2

a = (min{a1, a2 − a3}, a2, 0),

a = (min{a1, a2 − a3}, 0, 0), and

for a = (a1, a2, a3) ∈ Ψi(B(∞)). Therefore, we obtain

ηi(a) = (max{a3, a1 − a2 + 2a3}, a2, min{a1, a2 − a3}).

20

N. FUJITA AND S. NAITO

This piecewise-linear map induces a bijection from the polyhedral realization ∆(λ,w0)

i

onto the string

polytope e∆(λ,w0)

iop

i

i

= e∆(λ,w0)

∆(λ,w0)

. Indeed, by using Corollary 5.3, we deduce that

= {(a1, a2, a3) ∈ R3 | 0 ≤ a1 ≤ λ1, 0 ≤ a3 ≤ λ2, a3 ≤ a2 ≤ a1 + λ2},

where λi := hλ, hii for i = 1, 2. In particular, if λ = α1 + α2, then we have

∆(α1+α2,w0)

i

= {(a1, a2, a3) ∈ R3 | 0 ≤ a1 ≤ 1, 0 ≤ a3 ≤ 1, a3 ≤ a2 ≤ a1 + 1};

see the ﬁgure below.

Also, we deduce from [Lit, Section 1] or [BZ, Theorem 3.10] that

= {(a1, a2, a3) ∈ R3 | 0 ≤ a3 ≤ λ1, a3 ≤ a2 ≤ a3 + λ2, 0 ≤ a1 ≤ a2 − 2a3 + λ1}.

= {(a1, a2, a3) ∈ R3 | 0 ≤ a3 ≤ 1, a3 ≤ a2 ≤ a3 + 1, 0 ≤ a1 ≤ a2 − 2a3 + 1};

In particular, if λ = α1 + α2, then we have

i

e∆(λ,w0)
e∆(α1+α2,w0)

i

see the ﬁgure below.

Example 5.10. Let G = Sp4(C) (of type C2), i.e., hα2, h1i = −2 and hα1, h2i = −1. For a reduced
word i = (1, 2, 1, 2) for w0, we deduce from [NZ, Theorem 3.1] that the polyhedral realization Ψi(B(∞))
is identical to the semigroup

Now, by the same argument as in Example 5.9, ηi(a) is given by

{(a1, a2, a3, a4) ∈ Z4

≥0 | 2a2 ≥ a3, a3 ≥ 2a4}.

(max{a4, a2 − a3 + 2a4}, max{a3, a1 − 2a2 + 2a3, a1 + 2a4}, min{a2, a3 − a4}, min{a1, 2a2 − a3, a3 − 2a4}).
This piecewise-linear map induces a bijection from the polyhedral realization ∆(λ,w0)

i

. Indeed, by using Corollary 5.3, we deduce that the polyhedral realization ∆(λ,w0)

onto the string
is

i

identical to the set of (a1, . . . , a4) ∈ R4 satisfying the following conditions:

polytope e∆(λ,w0)

iop

0 ≤ a1 ≤ λ1, 0 ≤ a2 ≤ a1 + λ2, 0 ≤ a3 ≤ min{a2 + λ2, 2a2}, 0 ≤ 2a4 ≤ min{2λ2, a3},

where λi := hλ, hii for i = 1, 2. In particular, if we deﬁne ρ ∈ t∗ by hρ, h1i = hρ, h2i = 1, then the
polyhedral realization ∆(ρ,w0)

is given by the inequalities:

i

0 ≤ a1 ≤ 1, 0 ≤ a2 ≤ a1 + 1, 0 ≤ a3 ≤ min{a2 + 1, 2a2}, 0 ≤ 2a4 ≤ min{2, a3}.

0 ≤ a4 ≤ λ1, a4 ≤ a3 ≤ a4 + λ2, a3 ≤ a2 ≤ 2a3 − 2a4 + λ1, 0 ≤ a1 ≤ a2 − 2a3 + a4 + λ2.

to the set of (a1, . . . , a4) ∈ R4 satisfying the following conditions:

Also, we deduce from [Lit, Section 1] or [BZ, Theorem 3.10] that the string polytope e∆(λ,w0)
In particular, if λ = ρ, then the string polytope e∆(ρ,w0)

0 ≤ a4 ≤ 1, a4 ≤ a3 ≤ a4 + 1, a3 ≤ a2 ≤ 2a3 − 2a4 + 1, 0 ≤ a1 ≤ a2 − 2a3 + a4 + 1.

is given by the inequalities:

iop

iop

is identical

NEWTON-OKOUNKOV CONVEX BODIES AND POLYHEDRAL REALIZATIONS OF CRYSTAL BASES

21

References

[A] D. Anderson, Okounkov bodies and toric degenerations, Math. Ann. 356 (2013), 1183-1202.
[BZ] A. Berenstein and A. Zelevinsky, Tensor product multiplicities, canonical bases and totally positive varieties, Invent.

Math. 143 (2001), 77-128.

[CLS] D. Cox, J. Little, and H. Schenck, Toric Varieties, Graduate Studies in Mathematics Vol. 124, Amer. Math. Soc.,

Providence, RI, 2011.

[F] N. Fujita, Newton-Okounkov bodies for Bott-Samelson varieties and string polytopes for generalized Demazure mod-

ules, preprint 2015, arXiv:1503.08916.

[FFL] E. Feigin, G. Fourier, and P. Littelmann, Favourable modules: Filtrations, polytopes, Newton-Okounkov bodies

and ﬂat degenerations, preprint 2013, arXiv:1306.1292.

[GLS] C. Geiss, B. Leclerc, and J. Schr¨oer, Preprojective algebras and cluster algebras, in Trends in Representation

Theory of Algebras and Related Topics, EMS Ser. Congr. Rep., Eur. Math. Soc., Z¨urich (2008), 253-283.

[HK] M. Harada and K. Kaveh, Integrable systems, toric degenerations, and Okounkov bodies, Invent. Math. 202 (2015),

927-985.

[HY] M. Harada and J. J. Yang, Newton-Okounkov bodies of Bott-Samelson varieties and Grossberg-Karshon twisted

cubes, preprint 2015, arXiv:1504.00982.

[Hart] R. Hartshorne, Algebraic Geometry, Graduate Texts in Mathematics Vol. 52, Springer, New York, 1977.
[J1] J. C. Jantzen, Representations of Algebraic Groups, Academic Press, Orlando, 1987; 2nd ed., Math. Surveys Mono-

graphs Vol. 107, Amer. Math. Soc., Providence, RI, 2003.

[J2] J. C. Jantzen, Lectures on Quantum Groups, Graduate Studies in Mathematics Vol. 6, Amer. Math. Soc., Providence,

RI, 1996.

[Kas1] M. Kashiwara, Crystalizing the q-analogue of universal enveloping algebras, Comm. Math. Phys. 133 (1990),

249-260.

[Kas2] M. Kashiwara, On crystal bases of the q-analogue of universal enveloping algebras, Duke Math. J. 63 (1991),

465-516.

[Kas3] M. Kashiwara, Global crystal bases of quantum groups, Duke Math. J. 69 (1993), 455-485.
[Kas4] M. Kashiwara, The crystal base and Littelmann’s reﬁned Demazure character formula, Duke Math. J. 71 (1993),

839-858.

[Kav] K. Kaveh, Crystal bases and Newton-Okounkov bodies, Duke Math. J. 164 (2015), 2461-2506.
[Kir] V. Kiritchenko, Newton-Okounkov polytopes of ﬂag varieties, preprint 2015, arXiv:1506.00362.
[KK1] K. Kaveh and A. G. Khovanskii, Convex bodies and algebraic equations on aﬃne varieties, preprint 2008,
arXiv:0804.4095; a short version with title Algebraic equations and convex bodies appeared in Perspectives in Analysis,
Geometry, and Topology, Progr. Math. Vol. 296, Birkh¨auser, 2012, 263-282.

[KK2] K. Kaveh and A. G. Khovanskii, Newton-Okounkov bodies, semigroups of integral points, graded algebras and

intersection theory, Ann. of Math. 176 (2012), 925-978.

[LM] R. Lazarsfeld and M. Mustata, Convex bodies associated to linear series, Ann. Sci. de I’ENS 42 (2009), 783-835.
[Lus] G. Lusztig, Introduction to Quantum Groups, Progr. Math. Vol. 110, Birkh¨auser, 1993.
[Lit] P. Littelmann, Cones, crystals, and patterns, Transform. Groups 3 (1998), 145-179.
[N1] T. Nakashima, Polyhedrai realizations of crystal bases for integrable highest weight modules, J. Algebra 219 (1999),

571-597.

[N2] T. Nakashima, Polytopes for crystallized Demazure modules and extremal vectors, Comm. Algebra, 30 (2002),

1349-1367.

[NZ] T. Nakashima and A. Zelevinsky, Polyhedral realizations of crystal bases for quantized Kac-Moody algebras, Adv.

Math. 131 (1997), 253-278.

[O1] A. Okounkov, Brunn-Minkowski inequality for multiplicities, Invent. Math. 125 (1996), 405-411.
[O2] A. Okounkov, Why would multiplicities be log-concave?, in The Orbit Method in Geometry and Physics, Progr.

Math. Vol. 213, Birkh¨auser, 2003, 329-347.

[SS] D. Schmitz and H. Sepp¨anen, Global Okounkov bodies for Bott-Samelson varieties, preprint 2014, arXiv:1409.1857.

(N. Fujita) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku,

Tokyo 152-8551, Japan

E-mail address: fujita.n.ac@m.titech.ac.jp

(S. Naito) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku,

Tokyo 152-8551, Japan

E-mail address: naito@math.titech.ac.jp

