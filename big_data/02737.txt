6
1
0
2

 
r
a

M
8

 

 
 
]

.

A
Q
h
t
a
m

[
 
 

1
v
7
3
7
2
0

.

3
0
6
1
:
v
i
X
r
a

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE

BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS OF

TYPE A(2)

6

2n−1, D(2)

n , E(2)

MICHAEL PENN AND CHRISTOPHER SADOWSKI

Abstract. We obtain a presentation of principal subspaces of the basic modules for the twisted
(2)
6 . Using this presentation, we construct
aﬃne Kac-Moody Lie algebras of type A
exact sequences among these principal subspaces, and use these exact sequences to obtain recursions
satisﬁed by graded dimensions of the principal subspaces. Solving these recursions, we obtain the
graded dimensions of the principal subspaces.

(2)
n and E

(2)
2n−1, D

1. Introduction

Principal subspaces of standard modules for untwisted aﬃne Lie algebras were introduced and
studied by Feigin and Stoyanovsky in [FS1]–[FS2]. Motivateded by work of Lepowsky and Primc
[LP], Feigin and Stoyanovsky noticed diﬀerence-two type partition conditions in these structures. In
particular, Feigin and Stoynovsky showed that the multigraded dimensions of the principal subspace of
the basic modules for A(1)
1 are the sum-sides of the Rogers-Ramanujan identities, and more generally,
the multigraded dimensions of the principal subspaces of the higher level standard modules for A(1)
1
are the sum-sides of the Andrews-Gordon identities.

In [CLM1]–[CLM2], Capparelli, Lepowsky, and Milas, studied the principal subspaces of the stan-
dard modules for A(1)
1 using the theory of vertex operator algebras and intertwining operators. Un-
der certain assumptions (namely, presentations of principal subspaces using generators and relations
used in [FS1]–[FS2]), they constructed exact sequences among these principal subspaces. They used
these exact sequences to show that the multigraded dimensions of the principal spaces satisfy the
Rogers-Ramanujan and Rogers-Selberg recursions. From these recursions, they recovered the graded
dimensions found in [FS1]–[FS2]. In [CalLM1]–[CalLM2], Calinescu, Lepowsky, and Milas, again us-
ing the theory of vertex operator algebras and intertwining operators, proved the presentations used
in [FS1]–[FS2] and [CLM1]–[CLM2]. In [CalLM3], they extended their work to study the principal
subspaces of basic modules for untwisted aﬃne Lie algebras of type A, D, E. They also constructed
exact sequences among the principal subspaces, found the recursions that the multigraded dimensions
satisfy, and solved those recursions to ﬁnd the multigraded dimensions of the principal subspaces.

Principal subspaces have been studied from a vertex-algebraic point of view in many other works.
We give a brief overview of recent work in this area. In [C1] and [S1], principal subspaces of higher
level standard A(1)
2 -modules have been studied in a spirit similar to [CLM1]–[CLM2] and [CalLM1]–
[CalLM2]. These principal subspaces were also student in [AKS], [FFJMM], and in other works
by these authors. Georgiev used the theory of vertex operator algebras and intertwining operators
to construct combinatorial bases for principal subspaces of certain higher level standard modules
for untwisted aﬃne Lie algebras of type A, D, E in [G], and this work has since been extended to
untwisted aﬃne Lie algebras of type B, C by Butorac in [Bu1]–[Bu2] and to the quantum group case
by Koˇzi´c in [Ko]. Principal subspaces of standard modules for more general lattice vertex operator
algebras have been studied in [MPe], [P], and [Ka1]–[Ka2]. Certain commutative variants of principal

1

2

MICHAEL PENN AND CHRISTOPHER SADOWSKI

subspaces, called Feigin-Stoyanovsky type subspaces, have been studied in [Ba], [J1]–[J2], [JP], and
[T1]–[T3]. The multigraded dimensions of principal subspaces are Nahm sums (cf.
[Za]) or closely
resemble Nahm sums, and modularity properties of these sums have been studied in [BCFK] for the
untwisted aﬃne Lie algebras of type A and in [CalMPe] for the twisted aﬃne Lie algebra A(2)
4 .

The present work is an extension of the work on principal subspaces of basic modules for twisted
aﬃne Lie algebras intiated in [CalLM4] and continued in [CalMPe] and [PS]. We study the principal
subspaces of the basic modules for twisted aﬃne Lie algebras of type A(2)
n for n ≥ 4,
and E(2)
6 . We prove a presentation of these principal subspaces and use this presentation to ﬁnd their
multigraded dimensions. It is important to note that the ideas involved in this work and in [CalLM4],
[CalMPe], and [PS] all require slightly diﬀerent constructions and technical lemmas, and thus have
been studied on a case-by-case basis in these works. To date, there is no known way to handle all
the cases simultaneously. We also note here that in this paper, as well as in [PS], the multigraded
dimensions of the principal subspaces closely resemble Nahm sums, but are not Nahm sums themselves
due to the form that the denominator of the summands (namely, the appearance of terms of the form
(q2; q2)n in the denominators).

2n11 for n ≥ 2, D(2)

We now give a brief outline of this paper. In Section 2 of, we follow [L1] and [CalLM4] and give the
2n−1, D(2)
L for the twisted aﬃne Lie algebras A(2)
vertex-algebraic construction of the basic modules V T
n ,
6 , viewed as twisted modules for the lattice vertex operator algebras VL of type A(1)
2n−1, D(1)
and E(2)
n ,
and E(1)
6 . This construction uses the Dynkin diagram automorphisms for the ﬁnite dimensional Lie
algebras of type A, D, E, which we denote ν. In Section 3, we recall the notion of principal subspace
(cf.
[FS1]–[FS2], [CLM1]–[CLM2], [CalLM1]–[CalLM4], and many others) and deﬁne the principal
subspaces W T
L of the basic modules constructed in Section 2. We also deﬁne certain natural operators
which annihilate the highest weight vectors of the basic modules, as well as left ideals generated by
these operators. In Section 4, we deﬁne certain natural “shifting” maps among these ideals, and prove
various containment properties of these maps. In Section 5, we use these maps to show that the left
ideals deﬁned in Section 3 give presentations of our principal subspaces. We use these presentations to
construct exact sequences among our principal subspaces, ﬁnd recursions satisﬁed by their multigraded
dimensions:
(1.1)
χ′(x; q) = χ′(x1, . . . , xi−1, q2xi, xi+1, . . . , xk; q) + xiq2χ′(q2h(αi1 )(0)(αi)(0)ix1, . . . , q2h(αik )(0)(αi)(0)ixk; q)
if ναi = αi and
(1.2)
χ′(x; q) = χ′(x1, . . . , xi−1, qxi, xi+1, . . . , xk; q) + xiqχ′(q2h(αi1 )(0)(αi)(0)ix1, . . . , q2h(αik )(0)(αi)(0)ixk; q)
if ναi 6= αi. Here, in each case, we denote the simple roots by αi, and denote by (αi)(0) the projection
of the root αi onto the 0 eigenspace of ν extended to the Cartan subalgebra of the underlying ﬁnite
dimensional Lie algebra. Consequently, solving these recursions, we obtain the multigraded dimensions
of the principal subspaces:

(1.3)

′

χ

(x; q) = Xm∈(Zk

≥0)

q mtAm

2

(qa1 ; qa1 )m1 ··· (qak ; qak )mk

xm1
1

··· xmk

k

where aj = 2 if ναij = αij , aj = 1 if ναij
Sections 3, 4, and 5 are natural analogues of ideas used in [CalLM1]–[CalLM4] and [PS] to prove
similar presentations, adapted to the setting of this paper.

6= αij and A = 2(cid:0)(cid:10)(αij )(0), (αik )(0)(cid:11)(cid:1). The ideas in

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

Let

2. The Setting

(2.1)
be an integral lattice with associated symmetric non-degenerate bilinear form h·,·i : L × L → Z such
that hα, αi ∈ 2Z for all α ∈ L. In this setting we often say L is an even lattice. We also assume that
L admits an isometry ν : L → L such that
(2.2)

L = Zα1 ⊕ ··· Zαl

νk = 1

and

k

(2.3)

2 α, αE ∈ 2Z for all α ∈ L

if k is even. In the language of [L1],[CalLM4] and others, we take k = 2, and in addition assume that

Dν
for all α ∈ L we have (cid:10)νk/2α, α(cid:11) ∈ 2Z.
Remark 2.1. The root lattices of the Lie algebras A2n−1, Dn, E6 are special cases of this general
set-up. We will exploit this to analyze the principal subspaces of the level one standard modules of
2n−1, D(2)
A(2)
2n case was examined in [CalMPe], and required k = 4 as the period of
ν (which had order 2), doubling the order of the Dynkin diagram automorphism for the Lie algebra
A2n.

n and E(2)

6 . The A(2)

Following Section 2 of [CalLM4] (also [L1]) while specializing to our setting, we ﬁx η = −1, the
primitive second root of unity, and set η0 = (−1)2η = −1. Deﬁne the functions C0 : L × L → C× and
C : L × L → C× by
(2.4)

C0(α, β) = (−1)hα,βi

and

(2.5)

Here we have C = C0.

C(α, β) =

1

(−(−1)j)hνj α,βi = (−1)hα,βi.
Yj=0

We deﬁne the central extension ˆL of L by h−1i using the commutator map C0 (= C). In other

words, we have an exact sequence

(2.6)
so that aba−1b−1 = C0(a, b) for a, b ∈ ˆL.
Remark 2.2. In previous related work ([CalLM4], [CalMPe], and [PS]), C0 and C were inequivalent
maps and thus determined two inequivalent central extensions ˆL and ˆLν, respectively.

1 −→ h−1i −→ ˆL −→ L −→ 1

After [L1] and [CalLM4], we let

be a normalized section of ˆL so that

(2.7)

and

(2.8)

e : L → ˆL
α 7→ eα

e0 = 1

eα = α for all α ∈ L.

4

MICHAEL PENN AND CHRISTOPHER SADOWSKI

We deﬁne ǫC0 : L × L → h−1i by the condition
(2.9)

eαeβ = ǫC0(α, β)eα+β for all α, β ∈ L.

With this set-up ǫC0(= ǫC ) is a normalized 2-cocycle associated to the commutator map C0(= C).

In other words,

and

(2.10)

ǫC0(α, β)ǫC0 (α + β, γ) = ǫC0(β, γ)ǫC0(α, β + γ)

ǫC0(0, 0) = 1

ǫC0(α, β)
ǫC0(β, α)

= C0(α, β).

We choose our 2-cocycle to be the Z-bilinear map determined by
for i ≤ j
for i ≥ j.

ǫC0(αi, αj) =(cid:26) 1

(−1)hαi,αji

(2.11)

As in [L1] and [CalLM4], we lift the isometry ν of L to an automorphism ˆν of ˆL such that

(2.12)

ˆνa = νa

for

a ∈ ˆL.

and choose ˆν so that

(2.13)
and thus ˆν2 = 1. Set

(2.14)
where ψ : L → h−1i is deﬁned by

ˆνa = a

if

νa = a,

ˆνeα = ψ(α)eνα

(2.15)

ψ(α) =


ǫC0(α, α)
1
(−1)r3r6ǫC0(α, α)

if L is type A2n−1
if L is type Dn

if L is type E6 and α =P6

i=1 riαi.

Checking that ˆν(eαeβ) = ˆνeα ˆνeβ is clear given that

(2.16) ǫC0(να, νβ) =
ǫC0(β, α)
ǫC0(α, β)
(−1)r6s3+r3s6 ǫC0(β, α)


Observe that this choice of lifting satisﬁes (2.12), (2.13), and

if L is type A2n−1
if L is type Dn

if L is type E6, α =P6

i=1 riαi, and β =P6

i=1 siαi.

(2.17)

where αi is a simple root.

ˆνeαi = eναi,

Now we recall the construction of the vertex operator algebra VL while lifting ˆν to an automorphism
of VL which we also denote by ˆν, and use the space ˆLν to construct ˆν-twisted modules of VL. This
closely follows [L1] and [FLM2]. We begin by setting

(2.18)

h = C ⊗Z L

and extend the bilinear form on L to a C-bilinear form on h. We view h as an abelian Lie algebra and
consider its aﬃnization

(2.19)

ˆh = h ⊗ C[t, t−1] ⊕ Ck

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

where

[α ⊗ tr, β ⊗ ts] = hα, βi rδr+s,0k

(2.20)
for α, β ∈ h and r, s ∈ Z, where k is central. We also endow ˆh with a natural Z-grading given by
wt(α ⊗ tm) = −m and wt(k) = 0 for α ∈ h and m ∈ Z. Now form the module
(2.21)
where ˆh− = h ⊗ t−1C[t−1]. Observe that M (1) inherits the Z-grading from ˆh.

M (1) = U (ˆh) ⊗U(h⊗C[t]⊕Ck) C ∼= S(ˆh−) linearly

Next we form the ˆL-module

(2.22)
Using the inclusion ι : ˆL → C{L} we write ι(a) = a ⊗ 1. This module is C-graded so that
(2.23)

C{L} = C[ ˆL] ⊗C[h−1i] C ∼= C[L] (linearly).

wt(ι(1)) = 0

and

(2.24)

for α ∈ L. We set

(2.25)

wt(eα) =

1
2 hα, αi ,

VL = M (1) ⊗ C{L}
= S(cid:16)ˆh−(cid:17) ⊗ C[L] (linearly)

which is naturally acted upon by ˆL, ˆhZ, h, and xh (h ∈ h) as described in previous work ([CalLM4],[L1],[FLM2]).

For v = h1(−m1)··· hr(−mr) ⊗ ι(a) ∈ VL with hi ∈ h, mi ∈ N, and a ∈ ˆL we set

(2.26)

Y (v, x) = ◦

◦

1

(m1 − 1)!(cid:18) d

dx(cid:19)m1−1

h1(x)···

1

(mr − 1)!(cid:18) d

dx(cid:19)mr−1

hr(x)Y (ι(a), x)◦

◦

with hi(x) =Pm∈Z hi(m)x−m−1 where we have associated hi ⊗ tm = hi(m). We also have

Y (ι(a), x) = E−(−a, x)E+(−a, x)axa

(2.27)

where

(2.28)

E±(α, x) = exp

α(m)

m

x−m

 Xm∈±Z+

 ∈ (End VL)[[x, x−1]]

for α ∈ h. By Theorem 6.5.3 of [LL], (VL, Y, 1, ω) is a simple vertex algebra of central charge d =
rank L = dimh with 1 = 1 ⊗ 1 and

(2.29)

ω =

1
2

hi(−1)hi(−1)1

d

Xi=1

where {h1,··· , hd} forms an orthonormal basis of h. We also extend the automorphism ˆν of ˆL to an
automorphism (which we also denote by ˆν) of VL. Using the tensor product construction of VL (2.25)
we take this extension to be ν ⊗ ˆν. We refer the reader to Section 2 of [CalLM4] ([L1]) for the details
showing that this indeed deﬁnes an automorphism of VL.
Our next objective is to construct a ˆν-twisted VL-module in the spirit of [CalLM4] and [L1]. We

skip many details an focus on how this construction specializes to our case.

Set

(2.30)

h(m) = {h ∈ h|ˆνh = (−1)mh}

6

MICHAEL PENN AND CHRISTOPHER SADOWSKI

for m ∈ Z, identify h(m) = h(m mod 2), and write
(2.31)

h = h(0) ⊕ h(1).

Observe that

(2.32)

and

h(0) = {α + να|α ∈ h}

(2.33)
Let P0 and P1 be the projections of h onto h(0) and h(1) respectively. For h ∈ h and m ∈ Z/2Z we set
h(m) = Pmh. Thus, we may write

h(1) = {α − να|α ∈ h}.

(2.34)

h(m) =

1
2

(h + (−1)mνh).

We form the ν-twisted aﬃne Lie algebra associated to h:
ˆh[ν] = h(0) ⊗ C[t, t−1] ⊕ h(1) ⊗ t

1

(2.35)

2 C[t, t−1] ⊕ Ck

where k is central and

(2.36)
for r, s ∈ 1
(2.37)

[α ⊗ tr, β ⊗ ts] = hα, βi rδr+s,0k

2 Z, α ∈ h(2r), and β ∈ h(2s). We have that ˆh[ν] is 1

2 Z-graded by weights such that

wt(α ⊗ tm) = −m

and

wt(k) = 0.

We set

(2.38)

and observe that in our setting we have

N = (1 − P0)h ∩ L

l

(2.39)

N =

Z(αi − ναi).

ai=1

Using Proposition 6.2 of [L1], let Cτ denote the one dimensional ˆN -module C with character τ and
write

(2.40)

T = Cτ .

Now consider the induced ˆLν-module

(2.41)
which is graded by weights and on which ˆLν, h(0), and xh for h ∈ h(0) all naturally act. Set
(2.42)

UT = C[ ˆLν] ⊗C[ ˆN] T ∼= C[L/N ],

V T

L = S[ν] ⊗ UT ∼= S(cid:16)ˆh[ν]−(cid:17) ⊗ C[L/N ],

Z, h(0), and xh for h ∈ h.

2

which is naturally acted upon by ˆLν, ˆh 1

For each α ∈ h and m ∈ 1

2 Z deﬁne the operators on V T

L

(2.43)

and set

(2.44)

α(2m) ⊗ tm 7→ αˆν(m)

αˆν (x) = Xm∈ 1

2

Z

αˆν (m)x−m−1.

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

Of most importance will be the ˆν-twisted vertex operators acting on V T

L for each eα ∈ ˆL

Y ˆν(ι(eα), x)2− hα,αi

2 E−(−α, x)E+(−α, x)eαxα(0)+hα(0) ,α(0)i

2

− hα,αi

2

.

(2.45)

as deﬁned in [L1], where

(2.46)

for α ∈ h. For m ∈ 1
(2.47)

2 and α ∈ L deﬁne the component operators xˆν
α (m) x−m− hα,αi
xˆν

2

.

−α(2n)(n)

n

Z+

x−n
 ,

α (m) by

E±(−α, x) = exp

 Xn∈± 1
Y ˆν(ι(eα), x) = Xm∈ 1

Z

3

2

Our construction to this point has been fairly general, apart from the restrictions given by (2.2) and
(2.3). From now on we will assume that L is a root lattice of type A2n−1, Dn, or E6. In the case that
we have a root lattice of type A or D we make the standard choice of simple roots, which we now
recall. In the case of A2n−1, we let
(2.48)
where {εi} is the standard basis of R2n. This corresponds to the following standard labeling of the
Dynkin diagram.

L = Zα1 ⊕ ··· ⊕ Zα2n−1 with αi = εi − εi−1

. . .

α1

α2

αn−1 αn

αn+1

α2n−2α2n−1

. . .

In this case, our isometry ν corresponds to the Dynkin diagram folding and is deﬁned on the simple
roots by

and extended Z-linearly. Observe that αn is ﬁxed under ν. Moreover, the corresponding set of roots
is given by

ναi = α2n−i for 1 ≤ i ≤ 2n − 1,

(2.49)

(2.50)

where we choose the following subset of positive roots

∆ = {εi − εj|1 ≤ i 6= j ≤ 2n},

(2.51)

so that we have

∆+ = {εi − εj|1 ≤ i < j ≤ 2n}

(2.52)
For 1 ≤ i < j ≤ 2n we may write ±(εi − εj) = ±(αi + αi+1 + ··· + αj−1) from which we have
(2.53)

∆ = ∆+ ∪ (−∆+).

ν(±(εi − εj)) = ±(ε2n−j+1 − ε2n−i+1).

In the case of Dn, we have

(2.54)

L = Zα1 ⊕ ··· ⊕ Zαn with αi = εi − εi+1 for 1 ≤ i < n

and αn = εn−1 + εn,

where {εi} is the standard basis of Rn. This corresponds to the following standard labeling of the
Dynkin diagram

. . .

α1

α2

αn

αn−2 αn−1

8

MICHAEL PENN AND CHRISTOPHER SADOWSKI

In this case, ν is deﬁned by

(2.55)

ναi = αi for 1 ≤ i ≤ n − 2
ναn−1 = αn
ναn = αn−1,

and extended Z-linearly. Moreover, the corresponding set of roots is given by

(2.56)

∆ = {εi ± εj|1 ≤ i 6= j ≤ n},

where we choose the following subset of positive roots

(2.57)

so that we have

(2.58)

∆+ = {εi ± εj|1 ≤ i < j ≤ n}

∆ = ∆+ ∪ (−∆+).

We follow a procedure similar to that above to determine that the action of ν on any root is

ν(±(εi ± εj)) = ±(εi ± (−1)δj,n εj),

In the case of E6, we ﬁrst consider the standard basis for the root system with simple roots given

(2.59)
for 1 ≤ i < j ≤ n.
by

(2.60)

α1 = ε1 − ε2
α2 = ε2 − ε3
α3 = ε3 − ε4
α4 = ε4 + ε5

(ε1 + ε2 + ε3 + ε4 + ε5) +

1
2

α5 = −
α6 = ε4 − ε5,

√3
2

ε6

where {ε1, . . . , ε6} is the standard basis of R6. We now consider the invertible change of basis matrix

(2.61)

P =

1
3

1
3

− 1
6 − 1
− 1
6 − 1
6 − 1
− 1
− 1
6 − 1

6

6 − 1
6 − 1
6 − 1
6 − 1
3 − 2

1
3
1

1
3

3 − 2
− 2

1
3

3

3

1
3
1
3

1
3

1
3
1
3
1





1

6

2

1
2

1
2

1√3
0
0
2 − 1
1
2 − 1
2√3
2 − 1
2√3
1
2√3
1
2√3
− 1√3
0
0
0

6 − 1
2 − 1
6 − 1
2
0
0
0
0
0
0
0
0

3





and observe that for all v, w ∈ ∆E6 , where ∆E6 is the set of roots of E6, we have
(2.62)

hP v, P wi = hv, wi ,

where on the left we take the standard inner product on R9 and on the right the standard inner
product on R6. The result is that a copy of the E6 root system may be embedded into R9. Now we
make the identiﬁcation R9 = R3 × R3 × R3 and observe that result is a root system made up of nine
dimensional vectors of the form (v1, v2, v3) ∈ R3 × R3 × R3. The positive roots are of two main types,
either one of vk = εi − εj with 1 ≤ i < j ≤ 3 while the other two are the zero vector, or one of the

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

3 ε1 + 1
27 combinations where each vi is taken from {− 2
With this identiﬁcation we relabel the simple roots to be

3 ε2 + 1

3 ε3, 1

3 ε1 − 2

3 ε2 + 1

3 ε3, 1

3 ε1 + 1

3 ε2 − 2

3 ε3}.

(2.63)

2
3

1
3

ε1 −

α1 = (0, 0, ε2 − ε3)
α2 = (0, 0, ε1 − ε2)
ε2 +
α3 = (
α4 = (0, ε1 − ε2, 0)
α5 = (0, ε2 − ε3, 0)
α6 = (ε2 − ε3, 0, 0).

1
3

ε3,−

2
3

ε1 +

1
3

ε2 +

1
3

ε3,−

2
3

ε1 +

1
3

ε2 +

1
3

ε3)

This corresponds to the following labeling of the Dynkin diagram.

Here we have

(2.64)

α6

α1

α2

α3

α4

α5

να1 = α5
να2 = α4
να3 = α3
να6 = α6.

Using this choice for the root vectors the action of ν is given by

(2.65)
In each of these cases, we take h·,·i : L × L → Z to be the bilinear form given by
(2.66)

ν(v1, v2, v3) = (v1, v3, v2).

,

hα, βi = 2

(β, α)
(β, β)

where (·,·) is the standard Euclidean inner product given by (εi, εj) = δi,j. Recall from (2.17), in each
of these cases the isometry ν lifts to an automorphism ˆν of VL where

(2.67)

ˆνeαi = eναi.

Now we focus on the construction of the Lie algebras of type A2n−1, Dn, and E6, as well as their
aﬃne twisted counterparts from the appropriate root lattice and isometry ν. Each of these cases
will be handled simultaneously and we step back to point out signiﬁcant diﬀerences when needed.
Consider the vector space deﬁned by

(2.68)

g = h ⊕ aα∈∆

xα,

where h is deﬁned as in (2.18) and {xα} is a set of symbols, where ∆ is the set of roots corresponding
to L.

We endow g with the structure of a Lie algebra via the bracket deﬁned

(2.69)
where h ∈ h and α ∈ ∆ and

(2.70)

[h, xα] = hh, αi xα, [h, h] = 0

ǫC0(α,−α)α
ǫC0(α, β)xα+β
0

if α + β = 0
if α + β ∈ ∆
otherwise

[xα, xβ ] =


10

MICHAEL PENN AND CHRISTOPHER SADOWSKI

Observe that g is a Lie algebra isomorphic to one of type A2n−1, Dn, or E6 depending on the choice
of L. We extend the bilinear form h·,·i to g by
(2.71)

hh, xαi = hxα, hi = 0

hxα, xβi =(cid:26) ǫC0(α,−α)

0

if α + β = 0
if α + β 6= 0

Following [L1] and [CalLM4], we use our extension of ν : L → L to ˆν : ˆL → ˆL to lift the

automorphism ν : h → h to an automorphism ˆν : g → g by setting
(2.73)
for all α ∈ ∆, where ψ is deﬁned in (2.15). Here, we are using our particular choices of ˆν (extended
to C{L}) and our section e.

ˆνxα = ψ(α)xνα

For m ∈ Z set

(2.74)

Now we decompose g into eigenspaces of ˆν as follows

g(m) = {x ∈ g|ˆν(x) = (−1)mx}.

and

(2.72)

(2.75)

and

(2.76)

(2.77)

with

(2.78)

and

Form the ˆν-twisted aﬃne Lie algebra associated to g and ˆν:

l

g(0) =

ai=1

C(αi + ναi) ⊕ aα∈∆

C(xα + xνα)

l

g(1) =

ˆg[ˆν] = an∈Z

C(αi − ναi) ⊕ aα∈∆
ai=1
g(n) ⊗ tn/2 ⊕ Ck = an∈ 1

2

Z

C(xα − xνα)

g(2n) ⊗ tn ⊕ Ck

[x ⊗ tm, y ⊗ tn] = [x, y] ⊗ tm+n + hx, yi mδm+n,0k

[k, ˆg[ˆν]] = 0,

(2.79)
for m, n ∈ 1
(2.80)

with

2 Z, x ∈ g(2m), and y ∈ g(2n) Set

˜g[ˆν] = ˆg[ˆν] ⊕ Cd,

[d, x ⊗ tn] = nx ⊗ tn,

(2.81)
for x ∈ g(2n), n ∈ 1
depending on the choice of L, and is 1

2 Z-graded.

2 Z and [d, k] = 0. The Lie algebra ˜g[ˆν] is isomorphic to A(2)

2n−1, D(2)

n , or E(2)

6

We now recall the following result that gives V T

L the structure of a ˆg[ˆν]-module:

Theorem 2.1. (Theorem 3.1 [CalLM4], Theorem 9.1 [L1], Theorem 3 [FLM2]) The representation
of ˆh[ν] on V T

L extends uniquely to a Lie algebra representation of ˆg[ˆν] on V T

L such that

for all m ∈ 1

2 Z and α ∈ L. Moreover V T

(xα)(2n) ⊗ tn 7→ xˆν
L is irreducible as a ˆg[ˆν]-module.

α (n)

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

As in Section 2 of [CalLM4] (also Section 6 of [L1]) we have a tensor product grading on V T

L given

by the action of Lˆν(0) with

(2.82)

Where

(2.83)

We will write wt(1) =

dim h(1)

16

(2.84)

Lˆν(0)1 =

=

j(2 − j)dim h(j)1

1

1
16

Xj=1
16(cid:0)dim h(1)(cid:1) ,

1

Y ˆν(ω, x) = Xm∈Z

Lν(m)x−n−2.

. For a homogeneous element v ∈ V T
16 (cid:19) v.

ˆLˆν(0)v =(cid:18)wt(v) +

dim h(1)

L we have

For each of our special cases we have

(2.85)

wt(1) =

wt(1) =

wt(1) =

, for A2n−1

n − 1
16
1
16
1
8

, for Dn

, for E6,

which carries over to the weight of any homogeneous element in (2.84).

By Proposition 6.3 of [DL1] we have that

(2.86)

[Y ˆν (ω, x1), Y ˆν(ι(eα), x2)]

= x−1

2

d
dx2

Y ˆν (ι(eα), x2)δ(x1/x2) −

1
2hα, αix−1

2 Y ˆν(ι(eα), x2)

d
dx1

δ(x1/x2),

where δ(x) =Pn∈Z xn. Taking Resx2Resx1 of x1xm

(2.87)

2 times of both sides of (2.86) immediately gives

[Lˆν(0), xˆν

α (m)] =(cid:18)−m − 1 +

1

2 hα, αi(cid:19) xˆν

α (m)

and thus

(2.88)

Let

wt(xˆν

α (m)) = −m − 1 +

1
2 hα, αi .

B⋆ = {λi ∈ Q ⊗Z L|1 ≤ i ≤ l and hλi, αji = δi,j}

(2.89)
be the basis of the lattice dual to L with respect to the basis B = {αi|1 ≤ i ≤ l}. The λi are in the
rational span of B and so using (2.32) we have
(λi)(0) =
(2.90)

(λi + νλi).

1
2

We now use the eigenvalues of the operators (λi)(0)(0) to construct a new charge grading as follows.
Let

(2.91)

oi = {λ ∈ B⋆|λ = νmλi for some m ∈ N},

12

MICHAEL PENN AND CHRISTOPHER SADOWSKI

that is, oi is the orbit of λi under the action of ν. Observe that the distinct oi form a partition of B⋆.
Now deﬁne

(2.92)

λ(i) = Xλ∈oi

(λ)(0).

Finally, we deﬁne our charge grading to be a tuple built from the eigenvalues of λ(i)(0) as i runs over
all distinct orbits oi. That is

ch(xˆν

α (m)) =(cid:16)Dα, λ(i1)E ,Dα, λ(i2)E , . . . ,Dα, λ(ik )E(cid:17) ,

where the sets oij are all distinct (and disjoint), with i1 < i2 < ··· < ik. It is easy to see that
(2.94)
where dij = |oij|. Further if ch(v) = (m1, . . . , mk) then we say the total charge of v is m1 + m2 +
··· + mk.

α (m)) =(cid:0)di1(cid:10)α, (λi1 )(0)(cid:11) , di2(cid:10)α, (λi2 )(0)(cid:11) , dik(cid:10)α, (λik )(0)(cid:11)(cid:1) ,

ch(xˆν

In this case of A2n−1 the amounts to the n-tuple given by

(2.93)

(2.95)

(2.96)

In the case of Dn we have

Finally in the E6 case we have

(2.97)

ch(xˆν

ch(xˆν

ch(xˆν

α (m)) =(cid:10)2(cid:10)α, (λ1)(0)(cid:11) , . . . , 2(cid:10)α, (λn−1)(0)(cid:11) ,(cid:10)α, (λn)(0)(cid:11)(cid:1) .
α (m)) =(cid:10)(cid:10)α, (λ1)(0)(cid:11) , . . . ,(cid:10)α, (λn−2)(0)(cid:11) , 2(cid:10)α, (λn−1)(0)(cid:11)(cid:1) .
α (m)) =(cid:0)2(cid:10)α, (λ1)(0)(cid:11) , 2(cid:10)α, (λ2)(0)(cid:11) ,(cid:10)α, (λ3)(0)(cid:11) ,(cid:10)α, (λ6)(0)(cid:11)(cid:1) .

Consider the following ν-stable Lie subalgebra of g:

(2.98)

and its ˆν-twisted aﬃnization

n = aα∈∆+

Cxα.

(2.99)

ˆn[ˆν] = am∈Z

n(m) ⊗ tm/2 ⊕ Ck = am∈ 1

2

Z

n(2m) ⊗ tm ⊕ Ck,

where n(m) is the (−1)m-eigenspace of ˆν in n. As in [CalLM4], [CalMPe], and [PS], we take

(2.100)

Z

2

n[ˆν] = am∈ 1
n[ˆν]+ = am∈ 1
n[ˆν]− = am∈ 1

2

Z≥0

Z<0

2

n(2m) ⊗ tm

n(2m) ⊗ tm

n(2m) ⊗ tm

Now we will investigate the properties of operators from ˆn[ˆν] acting on V T

L by investigating the

vertex operators (2.47) and their modes. Using equation (2.93) of [CalLM4], we have that

(2.101)

Y ˆν (ˆνv, x) =

x

1

lim

2 →(−1)x

Y ˆν (v, x).

1
2

In our setting (ADE), we have two cases to consider: when α is ﬁxed under ν or when α is not ﬁxed
under ν, with ν2α = α. In the case that α is ﬁxed we have

(2.102)

Y ˆν(ι(eα), x) =

x

1

lim

2 →(−1)x

Y ˆν (ι(eα), x),

1
2

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

and thus

(2.103)

Y ˆν(ι(eα), x) ∈ (End V T

L )[[x, x−1]].

In terms of component operators this implies that

(2.104)

In the other case we have that

xˆν
α (m) = 0 for all m ∈

1
2

+ Z.

(2.105)

and thus

(2.106)

Y ˆν (ι(eνα), x) =

x

1

lim

2 →(−1)x

Y ˆν(ι(eα), x),

1
2

xˆν
να(m) = xˆν
xˆν
να(m) = −xˆν

α (m) for m ∈ Z
α (m) for m ∈

1
2

+ Z.

In our setting, the commutator formula among twisted vertex operators becomes

(2.107)

[Y ˆν(u, x1), Y ˆν(v, x2)] =

(cid:19)Y ˆν(Y (ˆνju, x0)v, x2)(cid:19).
As a consequence, using the fact that hα, βi ≥ −1 for all α, β ∈ ∆+ we have the following commutator
formula for twisted vertex operators

2 Resx0(cid:18) Xj∈Z/2Z

δ(cid:18)(−1)j (x1 − x0)1/2

x1/2
2

x−1

1
2

(2.108)

(cid:2)Y ˆν (ι(eα), x1), Y ˆν(ι(eβ ), x2)(cid:3) = x−1

2

leading to the following lemma:
Lemma 2.1. For hα, βi ∈ ∆+ we have
(2.109)

1

2 Xj∈Z/2Z

δ (−1)j x

x

1
2
1
1
2

2 ! Y ˆν (xνj α(0)ι(eβ), x2) ,

(2.110)

(cid:2)Y ˆν(ι(eα), x1), Y ˆν(ι(eβ ), x2)(cid:3) = 0 when (cid:10)νjα, β(cid:11) ≥ 0 for 0 ≤ j ≤ 1
2 ! Y ˆν(ι(eα+β ), x2)
(cid:2)Y ˆν(ι(eα), x1), Y ˆν(ι(eβ ), x2)(cid:3) = x−1

ǫC0(α, β)δ  x

1
2
1
1
2

1
2

x

2

when hα, βi = −1 and hνα, βi ≥ 0

(2.111)

(cid:2)Y ˆν(ι(eα), x1), Y ˆν(ι(eβ ), x2)(cid:3) = x−1

2

1
2

1

Xj=0

ǫC0(νj α, β)δ (−1)j x

x

1
2
1
1
2

2 ! Y ˆν(cid:0)ι(eνj α+β), x2(cid:1)

when hα, βi = hνα, βi = −1.

Proof. This follows from the standard vertex algebra fact that xα (− hα, βi − 1) eβ = ǫC0(α, β)eα+β.

(cid:3)

We can use Lemma 2.1 to make the following statement regarding component operators.

Corollary 2.1. For α, β ∈ ∆+ and r, s ∈ 1
nonzero (see (2.104)), we have

2 Z chosen from a suitable subset so that the operators are

(2.112)

(2.113)

[xˆν

α (r) , xˆν

[xˆν

α (r) , xˆν

β (s)] =

β (s)] = 0 when hα, βi ≥ 0 and hνα, βi ≥ 0,
1
2

ǫC0(α, β)xˆν

α+β (r + s) when hα, βi = −1 and hνα, βi ≥ 0,

α = εi − εj with 1 ≤ i < j ≤ 2n

β = εk − εl with 1 ≤ k < l ≤ 2n.

The isometry ν acts as follows on the roots written in this form
να = ε2n+1−j − ε2n+1−i.

(2.117)

of A2n−1 we may write
(2.115)

and

(2.116)

Observe that we have

(2.118)

14

MICHAEL PENN AND CHRISTOPHER SADOWSKI

and
(2.114)
[xˆν

α (r) , xˆν

β (s)] =

1
2

ǫC0(α, β)xˆν

α+β (r+s)+(−1)2r 1

2

ǫC0(να, β)xˆν

να+β (r+s) when hα, βi = −1 and hνα, βi = −1.

We now present two technical Lemmas that will be of use in the simpliﬁcation of (2.114).

Lemma 2.2. Suppose that α, β ∈ ∆+ such that hα, βi = hνα, βi = −1. Then either να = α or
νβ = β.

Proof. We separate our argument into cases depending on type. First considering the A2n−1 case.

Suppose α, β ∈ ∆+ are such that hα, βi = hνα, βi = −1. Since we are dealing with positive roots

We claim that only one of δj,k, δi,l is nonzero. Indeed, otherwise we have

− 1 = hα, βi = δi,k + δj,l − δj,k − δi,l.

(2.119)
Thus we have i 6= k, j 6= l, and either j = k or i = l (but not both). Without loss of generality we
take j = k, and thus i 6= l. Now considering an expansion of hνα, βi similar to (2.118) we have
(2.120)

β = εk − εl = εj − εi = α /∈ ∆+.

2n + 1 − i = j

or

(2.121)
If (2.120) holds we have α = εi − ε2n+1−i which is ﬁxed under ν, while if (2.121) holds we have
β = εj − ε2n+1−j with is also ﬁxed under ν.

2n + 1 − j = l.

Now we consider the Dn case, here we may write positive roots in the form

(2.122)

and

α = εi + (−1)aεj with 1 ≤ i < j ≤ n

(2.123)
where a, b ∈ {0, 1}. In this setting we have
(2.124)

β = εk + (−1)bεl with 1 ≤ k < l ≤ n,

να = εi + (−1)a+δj,n εj.

We may also write

(2.125)

and

− 1 = hα, βi = δi,k + (−1)aδj,k + (−1)bδi,l + (−1)a+bδj,l

(2.126)
Using this to expand hα, βi − hνα, βi = 0 we have
(2.127)

− 1 = hνα, βi = δi,k + (−1)a+δj,n δj,k + (−1)bδi,l + (−1)a+b+δj,n δj,l.
(cid:0)(−1)a − (−1)a+δj,n(cid:1) δj,k −(cid:0)(−1)a+b − (−1)a+b+δj,n(cid:1) δj,l = 0.

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

We now claim that we cannot have both j = k and j = l, otherwise we would have β = 2ǫj /∈ ∆+.
This leaves us with the following
Case 1: j 6= k and j 6= l and thus at least one of j or l is not n and the corresponding root is ﬁxed
Case 2: j = k and j 6= l and thus (−1)a = (−1)a+δj,n which implies j 6= n and α is ﬁxed.
Case 3: j 6= k and j = l and thus (−1)a+b = (−1)a+b+δj,n which implies j 6= n and α is ﬁxed.

under ν.

Now we consider the E6 case. Here we use a symmetric version of the root system as described
above. We take the root system to be made up of nine dimensional vectors which we consider of the
form (v1, v2, v3) ∈ R3 × R3 × R3. The positive roots are of two main types, either one of vi = εi − εj
with 1 ≤ i < j ≤ 3 while the other two are the zero vector, or one of the 27 combinations where each
vi is taken from {− 2
3 ε3}. In this setting we take the
roots to be

3 ε2 − 2

3 ε1 − 2

3 ε2 + 1

3 ε1 + 1

3 ε1 + 1

3 ε3, 1

3 ε2 + 1

3 ε3, 1

1
3

ε1 +

α1 = (0, 0, ε2 − ε3)
α2 = (0, 0, ε1 − ε2)
α3 = (−
ε2 −
α4 = (0, ε1 − ε2, 0)
α5 = (0, ε2 − ε3, 0)
α6 = (ε2 − ε3, 0, 0).

2
3

1
3

ε3,−

2
3

ε1 +

1
3

ε2 +

1
3

ε3,−

2
3

ε1 +

1
3

ε2 +

1
3

ε3)

ν(v1, v2, v3) = (v1, v3, v2).

(2.128)

We have that

(2.129)

Finally, we let α = (v1, v2, v3) and β = (w1, w2, w3) and expand the inner product

(2.130)

hα, βi = hv1, w1i + hv2, w2i + hv3, w3i

and notice that the equation hα, βi − hνα, βi = 0 implies that
hv2 − v3, w2 − w3i = 0.
(2.131)

Now we make the observation that

(2.132)

v2 − v3, w2 − w3 ∈ {εi − εj|1 ≤ i, j ≤ 3}.

It is clear that all choices of vi and wj that make α, β ∈ ∆+, none of them allow for (2.131) to

hold unless v2 − v3 = 0 (and thus α is ﬁxed) or w2 − w3 = 0 (and thus β is ﬁxed).

(cid:3)

In view of Lemma 2.2, if hα, βi = −1 and hνα, βi = −1, then we can write (2.114) as

(2.133)

[xˆν

α (r) , xˆν

β (s)] =(cid:18) 1

2

ǫC0(α, β) + (−1)2r 1

2

ǫC0(α, β)(cid:19) xˆν

α+β (r + s) = ǫC0(α, β)xˆν

α+β (r + s)

if να = α (which also implies r ∈ Z). Finally, if να 6= α (in which case νβ = β and s ∈ Z) we have

[xˆν

α (r) , xˆν

β (s)] = −[xˆν

β (s) , xˆν
= −ǫC0(β, α)xˆν

α (r)]
α+β (r + s).

16

MICHAEL PENN AND CHRISTOPHER SADOWSKI

3. Principal subspaces

Following [CalLM4] and [CalMPe] (cf. [CalLM1]-[CalLM3], [FS1] - [FS2], and other works involving

principal subspaces) we deﬁne the principal subspace of a highest weight ˜g[ˆν]-module:

Deﬁnition 3.1. For any standard ˜g[ˆν]-module V with highest weight vector v, deﬁne its principal
subspace W to be

Denote by W T

L the principal subspace of the standard ˜g[ˆν]-module V T
L ,

W = U (n[ˆν]) · v.

(3.1)

W T

L = U (n[ˆν]) · vΛ,

where Λ ∈ (cid:0)h(0) ⊕ Ck ⊕ Cd(cid:1)∗ is the fundamental weight of ˜g[ˆν] deﬁned by hΛ, ki = 1, (cid:10)Λ, h(0)(cid:11) = 0,
and hΛ, di = 0, and vΛ is a highest weight vector of V T
(3.2)
We take vΛ = 1 = 1 ⊗ 1 ∈ V T

W T
L (∼= S[ν] ⊗ UT ).

L = U (n[ˆν]−) · vΛ.

L . We have

Consider the surjection

(3.3)

and its restriction

(3.4)

FΛ : U (ˆg[ˆν]) → V T

L

a 7→ a · vΛ

fΛ : U (n[ˆν]) → W T
a 7→ a · vΛ

L

As in previous work ([CalLM1]-[CalLM4], [CalMPe],and others), our main goal is to describe the
kernel of fΛ, giving us a presentation of W T
L .

Following [CalLM4](cf. [CalLM1]-[CalLM3]) we set

(3.5)

N T
L = U (ˆg[ˆν]) ⊗U(ˆg[ˆν])≥0

CvN
Λ ,

i.e. the generalized Verma module where,

We also use the principal subspaces of the generalized Verma module

ˆg[ˆν]≥0 = an≥0

g(n) ⊗ tn/2 ⊕ Ck.

W T,N
L = U (n[ˆν]) · vN

Λ ⊂ N T
L .

(3.6)

(3.7)

Now we deﬁne the following related surjections

(3.8)

as well as

(3.9)

Λ : U (ˆg[ˆν]) → N T
F N

L

Λ

a 7→ a · vN
Λ : U (n[ˆν]) → W T,N
f N
a 7→ a · vN

L

Λ

L

L → V T
Π : N T
a · vN
Λ 7→ a · vΛ
π : W T,N
L → W T
a · vN
Λ 7→ a · vΛ.

L

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

We now look at some results involving the vertex operators Y ˆν(eα, x). These will be the source of

our description of Ker(fΛ). Using the fact

(3.10)

E+(α, x1)E−(β, x2) = Yp∈Z/2Z 1 − (−1)p x

x

1
2
2
1
2

1 !hνpα,βi

E−(β, x2)E+(α, x1),

(cf. [L1], [CalLM4]) we have the following results:
Proposition 3.1. For α, β ∈ ∆+ we have
(3.11)

Y ˆν(ι(eα), x)Y ˆν(ι(eβ), x) = 0, when (cid:10)νjα, β(cid:11) ≥ 0 for 0 ≤ j ≤ 2

1
2

1
2

1
2

lim
2 →x
lim
1
2
2 →x
lim
1
2
2 →x

x

x

x

1
2

1
2

1
2

1 + x

1 − x

1 (cid:16)x
2(cid:17) Y ˆν(ι(eα), x1)Y ˆν(ι(eβ), x2) = 0, when hα, βi = −1 and hνα, βi ≥ 0
2(cid:17) Y ˆν(ι(eα), x1)Y ˆν(ι(eβ), x2) = 0, when hα, βi ≥ 0 and hνα, βi = −1
1 (cid:16)x
(x1 − x2) Y ˆν(ι(eα), x1)Y ˆν(ι(eβ ), x2) = 0, when (cid:10)νjα, β(cid:11) = −1 for 0 ≤ j ≤ 1.

1
2
1

1
2

By taking appropriate coeﬃcients of the formal variables in the expressions from Proposition 3.1

we have the following sums which, when applied to any vector v ∈ V T
Corollary 3.1. We have

L , yield zero.

(3.12)

(3.13)

(3.14)

(3.15)

(3.16)

(3.17)

and

(3.18)

R(α, β|t) = Xm1,m2∈ 1

2

Z

m1+m2=−t

xˆν
α (m1) xˆν

β (m2) when (cid:10)νjα, β(cid:11) ≥ 0 for j = 0, 1,
β(cid:18)m2 +
2(cid:19)(cid:19)

2(cid:19) xˆν

α (m1) xˆν

1

1

R(α, β|t) = Xm1,m2∈ 1

2
m1+m2+ 1

Z

2 =−t

R(α, β|t) = Xm1,m2∈ 1

2
m1+m2+ 1

Z

2 =−t

β (m2) − xˆν

α(cid:18)m1 +
(cid:18)xˆν
when hα, βi = −1 and hνα, βi ≥ 0,
α(cid:18)m1 +
(cid:18)xˆν
when hα, βi ≥ 0 and hνα, βi = −1,

2(cid:19) xˆν

β (m2) + xˆν

1

α (m1) xˆν

β(cid:18)m2 +

1

2(cid:19)(cid:19)

R(α, β|t) = Xm1,m2∈ 1

m1+m2+1=−t(cid:0)xˆν

Z

2

α (m1 + 1) xˆν

β (m2) − xˆν

α (m1) xˆν

β (m2 + 1)(cid:1)

when (cid:10)νjα, β(cid:11) = −1 for j = 0, 1,

when applied to any v ∈ V T

L yield zero.

We deﬁne the following truncated ﬁnite sums

(3.19)

R0(α, β|t) = Xm1,m2∈ 1

Z<0
m1+m2=−t

2

α (m1) xˆν
xˆν

β (m2) when (cid:10)νj α, β(cid:11) ≥ 0 for j = 0, 1,

18

MICHAEL PENN AND CHRISTOPHER SADOWSKI

R0(α, β|t) = Xm1,m2∈ 1

2
m1+m2+ 1

Z<0
2 =−t

R0(α, β|t) = Xm1,m2∈ 1

2
m1+m2+ 1

Z<0
2 =−t

1

2(cid:19) xˆν

β (m2) − xˆν

α(cid:18)m1 +
(cid:18)xˆν
when hα, βi = −1 and hνα, βi ≥ 0,

α (m1) xˆν

β(cid:18)m2 +

1

β (m2) + xˆν

2(cid:19) xˆν

α(cid:18)m1 +
(cid:18)xˆν
when hνα, βi ≥ 0 and hνα, βi = −1,

α (m1) xˆν

β(cid:18)m2 +

1

2(cid:19)(cid:19)

1

2(cid:19)(cid:19)

(3.20)

(3.21)

and

(3.22)

R0(α, β|t) = Xm1,m2∈ 1

m1+m2+1=−t(cid:0)xˆν

Z<0

2

α (m1 + 1) xˆν

β (m2) − xˆν

α (m1) xˆν

β (m2 + 1)(cid:1)

when (cid:10)νj α, β(cid:11) = −1 for j = 0, 1,

For the following proposition, we require a certain completion of U (n[ˆν]) n[ˆν]+, which we call
^U (n[ˆν]) n[ˆν]+. We refer the reader to [LW] and [S2] for details of the construction of this completion.

Proposition 3.2. For α, β ∈ ∆+ and R(α, β|t) described above we may write

(3.23)

R(α, β|t) = R0(α, β|t) + a

where R0(α, β|t) is as above and a ∈ ^U (n[ˆν]) n[ˆν]+.

Proof. It is clear we can rewrite the inﬁnite sums (3.15) in this form because in this case the operators
xˆν
α (m) and xˆν
β (n) commute, so we any term that contains a positive mode can easily be written as
an element of ^U (n[ˆν]) n[ˆν]+.

We now focus on expressions of the form (3.16); the arguments involving (3.17) and (3.18) will be

similar. We ﬁrst decompose

1

α(cid:18)m1 +

R(α, β|t) = Xm1≥0,m2<0(cid:18)xˆν

2(cid:19) xˆν
β (m2) − xˆν
α(cid:18)m1 +
+R0(α, β|t) + Xm1<0,m2≥0(cid:18)xˆν
2(cid:19) xˆν

1

α (m1) xˆν

β(cid:18)m2 +

β (m2) − xˆν

α (m1) xˆν

1

2(cid:19)(cid:19)
β(cid:18)m2 +

1

2(cid:19)(cid:19) .

The third summand is clearly a member of ^U (n[ˆν]) n[ˆν]+ so we will focus on the ﬁrst. Using Corollary
2.1 we write

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

Xm1≥0,m2<0(cid:18)xˆν
= Xm1≥0,m2<0(cid:18)xˆν
β(cid:18)m2 +
−xˆν
= Xm1≥0,m2<0(cid:18)xˆν

α(cid:18)m1 +

β (m2) xˆν

1

2(cid:19) xˆν
α(cid:18)m1 +

β (m2) − xˆν
2(cid:19) −

1

1

2(cid:19) xˆν

α (m1) +

ǫC0(α, β)xˆν

1
2
1

α (m1) xˆν

β(cid:18)m2 +

1

2(cid:19)(cid:19)

1
2

ǫC0(α, β)xˆν

α+β(cid:18)m1 + m2 +
2(cid:19)(cid:19)

α+β(cid:18)m1 + m2 +

1

1

2(cid:19)

β (m2) xˆν

α(cid:18)m1 +

2(cid:19) − xˆν

β(cid:18)m2 +

1

2(cid:19) xˆν

α (m1)(cid:19) ∈ ^U (n[ˆν]) n[ˆν]+

Deﬁne the following left ideals of U (n[ˆν]):

(3.24)

as well as

J = Xt∈Z>0

,ναi=αi

U (n[ˆν]) R0(αi, αi|t) + Xt∈ 1

2

Z>0
ναi6=αi

(cid:3)

U (n[ˆν]) R0(αi, αi|t)

IΛ = J + U (n[ˆν]) n[ˆν]+.

(3.25)
For A2n−1, we let i = 1, . . . , n. For Dn, we let i = 1, . . . , n − 1, and for E6 we let i = 1, 2, 3, 6.
Remark 3.1. The ideal IΛ is deﬁned analogously to the ideals found in [CalLM1]-[CalLM4], [CalMPe],
and [PS]. In the following sections, we investigate the properties of IΛ, and, as in [CalLM1]-[CalLM4],
[CalMPe], and [PS], show that it gives the desired presentation of the principal subspace.

Following [CalLM4], [CalMPe], and [PS], we make use of certain shift automorphisms of U (n[ˆν]).

4. Important Mappings

For γ ∈ h(0) and a character of the root lattice θ : L → C consider the linear map

(4.1)

(4.2)

τγ,θ : n[ˆν] → n[ˆν]

xˆν
α (m) 7→ θ(α)xˆν

α(cid:0)m +(cid:10)α(0), γ(cid:11)(cid:1) .

For suitably chosen γ and θ, this is a Lie algebra automorphism that extends to an automorphism of
U (n[ˆν]) which we also denote by τγ,θ deﬁned by

τγ,θ(cid:16)xˆν

βir

βi1

(mr)··· xˆν

(m1)(cid:17)
βir (cid:0)mr +(cid:10)(βir )(0), γ(cid:11)(cid:1)··· xˆν
= θ(βi1 + ··· + βir )xˆν

βi1 (cid:0)m1 +(cid:10)(βi1 )(0), γ(cid:11)(cid:1) ,

where βij ∈ ∆+. As in [CalLM4], [CalMPe], and [PS], we use automorphisms associated to the
elements of h(0) associated to the duals of the simple roots

(4.3)

γi = (λi)(0) =

1
2

(λi + νλi)

where, for A2n−1, we let i = 1, . . . , n, for Dn, we let i = 1, . . . , n − 1, and for E6 we let i = 1, 2, 3, 6.
as well as the characters θi deﬁned by

(4.4)
In particular, if L is of type A2n−1, we have:

θi(αj) = (−1)hλ(i),αji.

20

(4.5)

(4.6)

MICHAEL PENN AND CHRISTOPHER SADOWSKI

θi(αi) = −1

θi(αj) = 1 if i 6= j and j ∈ {1, . . . , 2n − 1}

for i ∈ {1, . . . , n − 1} and we have
(4.7)

If L is of type Dn, we have:

θn(αj ) = 1 if j ∈ {1, . . . , 2n − 1}

(4.8)

(4.9)

and deﬁne

(4.10)

for i ∈ {1, . . . , n − 1}.
If L is of type E6, we have:

(4.11)

(4.12)

for i ∈ {1, 2} and we have
(4.13)

θn−1(αn−1) = −1

θn−1(αj) = 1 if j ∈ {1, 2, . . . , n − 2, n}

θi(αj) = 1 if j ∈ {1, . . . , n}

θi(αi) = −1

θi(αj ) = 1 if i 6= j and j ∈ {1, . . . , 6}

θi(αj) = 1 if j ∈ {1, . . . , 2n − 1} and i ∈ {3, 6}.

The maps τγi,θi have inverses given by τ
action of the maps τγi,θi:

−γi,θ−1

i

. The following Lemma follows immediately from the

Lemma 4.1. We have that

(4.14)

if ναi = αi and

(4.15)

τγi,θi(cid:0)U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν
τγi,θi(cid:18)U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν

αi (−1)(cid:1) ⊂ U (n[ˆν]) n[ˆν]+
2(cid:19)(cid:19) ⊂ U (n[ˆν]) n[ˆν]+
αi(cid:18)−

1

if ναi 6= αi.
Proof. This immediately follows from the fact that hγi, β(0)i ≥ 0 for each β ∈ ∆+, and the fact that
(4.16)

τγi,θi(cid:0)xˆν
τγi,θi(cid:18)xˆν

αi (−1)(cid:1) = θi(αi)xˆν
αi(cid:18)−
2(cid:19)(cid:19) = θi(αi)xˆν

1

αi (0) ∈ U (n[ˆν]) n[ˆν]+

αi (0) ∈ U (n[ˆν]) n[ˆν]+

if ναi = αi and

(4.17)

if ναi 6= αi.

We now present three Lemmas that are essential in determining KerfΛ. The lemmas and their

proofs largely mirror similar lemmas in [CalMPe] and [PS].

(cid:3)

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

Lemma 4.2. We have

(4.18)

if ναi = αi and

(4.19)

if ναi 6= αi.
Proof. We ﬁrst show that

(4.20)

if ναi = αi and

(4.21)

τγi,θi(cid:0)IΛ + U (n[ˆν]) xˆν
τγi,θi(cid:18)IΛ + U (n[ˆν]) xˆν

αi (−1)(cid:1) = IΛ
2(cid:19)(cid:19) = IΛ
αi(cid:18)−

1

τγi,θi(cid:0)IΛ + U (n[ˆν]) xˆν
τγi,θi(cid:18)IΛ + U (n[ˆν]) xˆν

αi (−1)(cid:1) ⊂ IΛ,
αi(cid:18)−
2(cid:19)(cid:19) ⊂ IΛ.

1

if ναi 6= αi In view of Lemma 4.1, it is suﬃcient to show that τγi,θi(R0(αj, αj|t)) ∈ IΛ. If i 6= j, we
have that

(4.22)

If ναi = αi, we have that

τγi,θi(R0(αj, αj|t)) = R0(αj , αj|t) ∈ IΛ.

τγi,θi(R0(αi, αi|t)) = τγi,θi
= θi(2αi)

m1+m2=−t

 Xm1,m2∈Z<0
 Xm1,m2∈Z<0

m1+m2=−t

αi (m1) xˆν
xˆν

αi (m1 + 1) xˆν
xˆν

αi (m2)

αi (m2 + 1)

αi (0)(cid:1)

α1 (−t + 2) xˆν

= θi(2αi)(cid:0)R0(αi, αi|t − 2) + 2xˆν
∈ J + U (n[ˆν]) n[ˆν]+ = IΛ.

If ναi 6= αi, we have

(4.23)

τγi,θi(cid:0)R0(αi, αi|t)(cid:1) = τγi,θi
= θi(2αi)

αi (m1) xˆν
xˆν

2

Z<0
m1+m2=−t

 Xm1,m2∈ 1
 Xm1,m2∈ 1

2

xˆν

αi(cid:18)m1 +
= θi(2αi)(cid:0)R0 (αi, αi|t − 1) + 2xˆν
∈ IΛ

Z<0
m1+m2=−t

αi (m2)

2(cid:19)
α2(cid:18)m2 +
2(cid:19) xˆν

αi (0)(cid:1) .

αi (−t + 1) xˆν

1

1

(4.20) and (4.21).

Since J is the left ideal generated by the R0(αi, αi|t), we have that τγi,θi(J) ⊂ IΛ, establishing
For the other containment, we will prove equivalent statements

(4.24)

τ
−γi,θ−1

i

(IΛ) ⊂ IΛ + U (n[ˆν]) xˆν

αi (−1) .

22

MICHAEL PENN AND CHRISTOPHER SADOWSKI

if ναi = αi and

(4.25)

if ναi 6= αi

Using

(4.26)

if ναi = αi and

(4.27)

if ναi 6= αi, it is clear that
(4.28)

τ
−γi,θ−1

i

if ναi = αi and

(4.29)

τ
−γi,θ−1

i

τ
−γi,θ−1

i

(IΛ) ⊂ IΛ + U (n[ˆν]) xˆν

αi(cid:18)−

1

2(cid:19) .

τ
−γi,θ−1

i

(xˆν

αj (m)) = θ−1

1 (αi)xˆν

αj (m − δi,j)

i

(xˆν

τ
−γi,θ−1

1 (αi)xˆν

αj (m)) = θ−1

δi,j(cid:19)
(U (n[ˆν]) n[ˆν]+) ⊂ U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν

αj (cid:18)m −

1
2

(U (n[ˆν]) n[ˆν]+) ⊂ U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν

αi (−1)

αi(cid:18)−

1

2(cid:19)

if ναi 6= αi. Furthermore, if i 6= j we have that
(4.30)

τ
−γi,θ−1

i

(R(αj, αj|t)) = R(αj, αj|t) ∈ IΛ.

Now we investigate the action of τ

−γi,θ−1

i

τ
−γi,θ−1

i

(4.31)

If ναi 6= αi, we have

τ
−γi,θ−1

i

(4.32)

(R0(αi, αi|t)) = τ

−γi,θ−1

i

m1+m2=−t

αi (m1) xˆν
xˆν

on R0(αi, αi|t). If ναi = αi, we have

αi (m2)
 Xm1,m2∈Z<0

αi (m2 − 1)
 Xm1,m2∈Z<0

αi (−1)(cid:1)

αi (m1 − 1) xˆν
xˆν

αi (−t − 1) xˆν

m1+m2=−t

= θ−1(2αi)(cid:0)R0(αi, αi|t + 2) − 2xˆν
∈ IΛ + U (n[ˆν]) xˆν

αi (−1) .

= θ−1(2αi)

(R0(αi, αi|t)) = τ

−γi,θ−1

i

αi (m1) xˆν
xˆν

Z<0
m1+m2=−t

2


 Xm1,m2∈ 1
 Xm1,m2∈ 1
αi(cid:18)−

2

= θ−1(2αi)

xˆν

Z<0
m1+m2=−t

αi(cid:18)m1 −
= θ−1(2αi)(cid:18)R0(αi, αi|t + 1) − 2xˆν
∈ IΛ + U (n[ˆν]) xˆν

1

2(cid:19) .

αi (m2)

2(cid:19)
αi(cid:18)m2 −
2(cid:19) xˆν

αi(cid:18)−
2(cid:19) xˆν
2(cid:19)(cid:19)
αi(cid:18)−t −

1

1

1

1

(4.35)

if ναi = αi and

(4.36)

if ναi 6= αi.
result.

ψγi,θi : U (n[ˆν]) → U (n[ˆν])
−αi,θ−1

a 7→ τ

i

(a)xˆν

αi (−1) ,

ψγi,θi : U (n[ˆν]) → U (n[ˆν])

a 7→ τ

−αi,θ−1

i

(a)xˆν

αi(cid:18)−

1

2(cid:19) ,

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

Since J is the left ideal generated by the R(αi, αi|t), we have that
(4.33)

(J) ⊂ IΛ + U (n[ˆν]) xˆν

αi (−1) .

τ
−γi,θ−1

i

if ναi = αi and

(4.34)

αi(cid:18)−
if ναi 6= αi, thus completing the proof of the reverse containment.

(J) ⊂ IΛ + U (n[ˆν]) xˆν

τ
−γi,θ−1

i

1

2(cid:19) .

(cid:3)

As in [CalLM4], [CalMPe], and [PS] deﬁne linear maps ψγi,θi for 1 ≤ i ≤ l on U (n[ˆν]) by:

In the spirit of Lemma 2.2, we present another technical lemma that will be of use for the next

Lemma 4.3. Suppose αi is a simple root and α ∈ ∆+ such that hαi, αi = 2. Then α = αi.
Proof. We begin with the A2n−1 setting, where αi = εi − εi+1 and α = εk − εl for 1 ≤ i ≤ 2n and
1 ≤ k < l ≤ 2n + 1. We now observe that
(4.37)

hαi, αi = hεi − εi+1, εk − εli = δi,k + δi+1,l − δi+1,k − δi,l = 2.

This implies that i = k and i + 1 = l and thus α = αi.

Moving on to the Dn setting we will explicitly check the cases that are not covered by (4.37). We

hαi, αi = hεi − εi+1, εk + εli = δi,k + δi,l − δi+1,k − δi+1,l

Finally we explore the E6 setting, again using the symmetric basis as described in (2.63). This

begin with αi = εi − εi+1 for 1 ≤ i ≤ n − 1 and α = εk + εl for 1 ≤ k < l ≤ n. We see that
(4.38)
which implies that k = i = l and thus α = 2εk /∈ ∆+. The remaining Dn cases are similar.
setting separates into a four cases.
Case 1: αi 6= α3 and α = (v1, v2, v3) where one of the vi is εk − εl for 1 ≤ k < l ≤ 3. The calculations
Case 2: αi 6= α3 and α = (v1, v2, v3) is so that the vi ∈ {− 2
3 ε1 +
3 ε3}. It is clear that no combination of αi and v1, v2, v3 will produce hαi, αi = 2 in
Case 3: We have the simple root α3 and α = (v1, v2, v3) where one of the vi is εk−εl for 1 ≤ k < l ≤ 3.
Case 4: We have the simple root α3 and α = (v1, v2, v3) is so that the vi ∈ {− 2
3 ε1 −
3 ε2 +
3 if and only if u = v, otherwise

for this case are is similar to that of type A2n−1 as described above andf will be omitted.
3 ε3, 1
3 ε2 − 2
this case.

3 ε3}. We ﬁrst observe that for all vectors u, v ∈ {− 2

3 ε2 − 2
3 ε3, 1

3 ε1 + 1
3 ε2 + 1
3 ε3} we have hu, vi = 2
3 . The result follows immediately from this fact.

3 ε2 − 2

This case is essentially the same as case 2.

3 ε3, 1
3 ε1 + 1

3 ε1 − 2

3 ε2 + 1

3 ε3, 1

3 ε1 + 1

3 ε2 + 1

3 ε1 + 1

3 ε1 + 1

3 ε2 + 1

2

1

3 ε3, 1
3 ε2 + 1
3 ε3, 1
3 ε1 − 2
hu, vi = − 1

1

(cid:3)

The following lemmas will be useful in the next section when determining KerfΛ:

24

MICHAEL PENN AND CHRISTOPHER SADOWSKI

Lemma 4.4. We have that

(4.39)

if ναi = αi and

(4.40)

ψγi,θiτγi,θi(cid:0)U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν
ψγi,θiτγi,θi(cid:18)U (n[ˆν]) n[ˆν]+ + U (n[ˆν]) xˆν

αi (−1)(cid:1) ⊂ IΛ
αi(cid:18)−
2(cid:19)(cid:19) ⊂ IΛ

1

α (m)) = xˆν

ψγi,θiτγi,θi(xˆν

if ναi 6= αi.
Proof. We begin with the case that αi is ﬁxed under the action of ν. We begin by by examining
ψγi,θiτγi,θi on the elements of n[ˆν]+. Assume that m ≥ 0 and we now consider
α(cid:0)m +(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11)(cid:1) xˆν
αi (−1) ,
(4.41)
where α ∈ ∆+. In this case we have γi = λi and make use of the isometry to write
(4.42)
Observe that hα, αii ∈ {−1, 0, 1, 2}. We use this fact to decompose this argument into a few cases.
hα, λii = 1. Observe that
(4.43)
Now if m ≥ 1 we have
(4.44)

We begin with the case that hα, αii = 2 which by Lemma 4.3 we have that α = αi and thus

(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11) = hα, λii − hα, αii .

αi (−1) = R0(αi, αi|2) ∈ IΛ.

αi (−1) xˆν

ψγi,θiτγi,θi(xˆν

ψγi,θiτγi,θi(xˆν

αi (0)) = xˆν

αi (−1)

αi (m)) = xˆν
= xˆν

αi (m − 1) xˆν
αi (−1) xˆν

αi (m − 1) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ.

We now move on to the case when hα, αii = 1 and thus hα, λii ≥ 1. In this case, we have that

hα, λii = 1 or hα, λii = 2, and so
(4.45)
ψγi,θiτγi,θi(xˆν

α (m)) = xˆν

α (m − 1 + hα, λii) xˆν

αi (−1) = xˆν

αi (−1) xˆν

α (m − 1 + hα, λii) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ.

(4.46)

When hα, αii = 0, we have that hα, λii ≥ 0. In this case, we have
ψγi,θiτγi,θi(xˆν
α (m + hα, λii) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ.
Finally, we examine the case when hα, αii = −1. In this case, we have that hα, λii = 0 or hα, λii = 1.

α (m + hα, λii) xˆν

αi (−1) = xˆν

αi (−1) xˆν

α (m)) = xˆν

In this case, we have
(4.47)

ψγi,θiτγi,θi(xˆν

α (m)) = xˆν
= xˆν

α (m + 1 + hα, λii) xˆν
αi (−1) xˆν

α (m + 1 + hα, λii) + cxˆν

αi (−1)

where c is a nonzero constant given by Corollary 2.1. Finally, we have that

α+αi (m + hα, λii) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ,

ψγi,θiτγi,θi(xˆν

αi (−1)) = xˆν

αi (−2) xˆν

αi (−1)

= 2R0(αi, αi|3),

so that ψγi,θiτγi,θi(U (n[ˆν]) xˆν

αi (−1)) ⊂ IΛ.

Now, we examine the case where αi is not ﬁxed by ν. Throughout our calculations for this case we

make use of the fact that by use of the isometry ν we may write
1
2

(hα, λii − hα, αii) +

(4.48)

1
2

(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11) =

(hνα, λii − hνα, αii)

Following our previous argument we use the fact hα, αii ,hνα, αii ∈ {−1, 0, 1, 2} to decompose into a
few subcases. Those subcases without explicit calculations follow by use of the isometry ν.

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

First, if hα, αii = 2 by Lemma 4.3 we have α = αi and thus hα, λii = 1, hνα, αii = 0, and

hνα, λii = 0. So we have
(4.49)

ψγi,θiτγi,θi(xˆν

αi (0)) = xˆν

Further if m ≥ 1

2 we see that

αi(cid:18) 1

2(cid:19) xˆν

αi(cid:18) 1

2(cid:19) = R0(αi, αi|1) ∈ J ⊂ IΛ.

(4.50)

ψγi,θiτγi,θi(xˆν

αi (m)) = xˆν

1

αi(cid:18)m +
αi(cid:18) 1
2(cid:19) xˆν

αi(cid:18) 1
2(cid:19)
2(cid:19) xˆν
αi(cid:18)m +
2(cid:19) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ

1

= xˆν

Now we consider the case when hα, αii ,hνα, αii ∈ {0, 1} thus hα, λii ≥ hα, αii and hνα, λii ≥

hνα, αii. So using (4.48) we have
(4.51)
and thus for all m ≥ 0

ψγi,θiτγi,θi(xˆν

α (m)) = xˆν

(4.52)

(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11) ≥ 0
α(cid:0)m +(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11)(cid:1) xˆν
αi(cid:18) 1

2(cid:19) xˆν

= xˆν

αi(cid:18) 1
2(cid:19)

α(cid:0)m +(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11)(cid:1) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ

Now we move on to the subcase where hα, αii ∈ {0, 1} (thus hα, λii ≥ hα, αii) and hνα, αii = −1

with a ∈ 1

(thus hνα, λii ∈ {0, 1}). Observe that in this setting we may write
+ a
(4.53)

1
(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11) =
2
2 Z≥0. Using Corollary 2.1 we may write, for m ≥ 0,
2(cid:19)
ψγi,θiτγi,θi(xˆν
+ a(cid:19) + cxˆν

+ a(cid:19) xˆν
α(cid:18)m +

α(cid:18)m +
αi(cid:18)−

αi(cid:18)−

2(cid:19) xˆν

α (m)) = xˆν

(4.54)

= xˆν

1
2

1
2

1

1

where c is a nonzero constant.

αi+να (m + a) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ,

After combining cases by use of the isometry ν we are left with the ﬁnal case of hα, αii = hνα, αii =

−1, which by Lemma 2.2 we have να = α and thus hα, λii = hνα, λii ≥ 0. This implies
(cid:10)α(0), γi(cid:11) −(cid:10)α(0), αi(cid:11) = 1 + a
(4.55)
where a ∈ Z≥0. Finally using Corollary 2.1, for m ≥ 0 we have
(4.56)

ψγi,θiτγi,θi(xˆν

α (m)) = xˆν

α (m + 1 + a) xˆν

αi(cid:18)−

1

2(cid:19)

= xˆν

αi(cid:18)−

1

2(cid:19) xˆν

α (m + 1 + a) + cxˆν

αi+να(cid:18)m +

1
2

+ a(cid:19) ∈ U (n[ˆν]) n[ˆν]+ ⊂ IΛ,

where c is a nonzero constant. Finally, we have that

ψγi,θiτγi,θi(xˆν

αi(cid:18)−

1

2(cid:19)) = xˆν

αi(cid:18)−

1

2(cid:19)

αi (−1) xˆν
= 2R0(αi, αi|

3
2

),

26

MICHAEL PENN AND CHRISTOPHER SADOWSKI

so that ψγi,θiτγi,θi(U (n[ˆν]) xˆν

αi(cid:0)− 1

2(cid:1)) ⊂ IΛ.

(cid:3)

Lemma 4.5. We have

(4.57)

ψγi,θiτγi,θi(IΛ + U (n[ˆν]) xˆν

αi (−1)) ⊂ IΛ,

if ναi = αi and

(4.58)

if ναi 6= αi.

ψγi,θiτγi,θi(IΛ + U (n[ˆν]) xˆν

αi(cid:18)−

1

2(cid:19)) ⊂ IΛ,

Proof. In view of Lemma 4.4, it suﬃces to show that

(4.59)

ψγi,θiτγi,θi(J) ⊂ IΛ.

As with Lemma 4.1, we begin with the case that ναi = αi. First, applying ψγi,θiτγi,θi to R(αi, αi|t),
we have that:

ψγi,θiτγi,θi(R0(αi, αi|t)) = ψγi,θiτγi,θi
= Xm1,m2∈Z<0

 Xm1,m2∈Z<0

m1+m2=−t
αi (m1 − 1) xˆν
xˆν

αi (m1) xˆν
xˆν

αi (m2)


αi (m2 − 1) xˆν

αi (−1)

= xˆν

m1+m2=−t
αi (−1) R0(αi, αi|t + 2) + aR0(αi, αi|2) ∈ IΛ

for some a ∈ U (n[ˆν]). Now, we apply ψγi,θiτγi,θi to R(αj, αj|t), where i 6= j. If hαi, αji = 0, we have
that

(4.60)

ψγi,θiτγi,θi(R0(αj , αj|t)) = xˆν

αi (−1) R0(αj , αj|t) ∈ IΛ.

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

If hαi, αji = −1, we have two cases to consider: the case where ναj = αj and the case where ναj 6= αj.
If ναj = αj , we have

ψγi,θiτγi,θi(R0(αj , αj|t)) = ψγi,θiτγi,θi

αj (m1 + 1) xˆν
xˆν

αi+αj (m1) xˆν
xˆν

αi+αj (m2)

αj (m2 + 1)


ǫC0(αj, αi)

ǫC0(αj, αi)

= xˆν

αi (−1) R0(αj , αj|t) + [R0(αj, αj|t − 1), xˆν

αi (0)] + b ∈ IΛ

αj (m1) xˆν
xˆν

 Xm1,m2∈Z<0

m1+m2=−t

αj (m2)


αj (m1 + 1) xˆν
xˆν

xˆν
αi (−1)

αj (m2 + 1)

αj (m2 + 1)


αj (m1 + 1) xˆν
xˆν

 Xm1,m2∈Z<0

m1+m2=−t

= xˆν

m1+m2=−t

= 
 Xm1,m2∈Z<0
αi (−1)
+
 Xm1,m2∈Z<0
+
 Xm1,m2∈Z<0

m1+m2=−t

m1+m2=−t

28

MICHAEL PENN AND CHRISTOPHER SADOWSKI

for some b ∈ U (n[ˆν]) n[ˆν]+. If ναj 6= αj, we have

(4.61)

(4.62)

(4.63)

(4.64)

(4.65)

(4.66)

(4.67)

(4.68)

ψγi,θiτγi,θi(R0(αj, αj|t)) = ψγi,θiτγi,θi

αj (m1) xˆν
xˆν

 Xm1,m2∈ 1

Z<0
m1+m2=−t

2

αj (m2)


αj (m1 + 1) xˆν
xˆν

αj (m1 + 1) xˆν
xˆν

2

2

2

= xˆν

Z<0
m1+m2=−t

Z<0
m1+m2=−t

Z<0
m1+m2=−t

= 
 Xm1,m2∈ 1
αi (−1)
 Xm1,m2∈ 1
−ǫC0(αj, αi)
 Xm1,m2∈ 1
−ǫC0(αj, αi)
 Xm1,m2∈ 1
Z<0
m1+m2=−t
αi (−1) R0(αj, αj|t − 2)
−ǫC0(αj, αi)
−ǫC0(αj, αi)

 Xm1,m2∈ 1
 Xm1,m2∈ 1

Z<0
m1+m2=−t

Z<0
m1+m2=−t

= xˆν

2

2

2

αj (m1 + 1) xˆν
xˆν

xˆν
αi (−1)

αj (m2 + 1)

αj (m2 + 1)

αi+αj (m2)

αj (m2 + 1)

αi+αj (m2)

αj (m2 + 1)


αj (m1 + 1) xˆν
xˆν

αi+αj (m1) xˆν
xˆν

αi+αj (m1) xˆν
xˆν

where c ∈ C. We now analyze the last two sums (4.67) and (4.68). First, for (4.67), we have

 Xm1,m2∈ 1

αi+αj (m2)


αi+αj (m2)


Z<0
m1+m2=−t+1

Z<0
m1+m2=−t

αj (m1) xˆν
xˆν

αj (m1) xˆν
xˆν

2

2

= 
 Xm1,m2∈ 1
αj(cid:18) 1
2(cid:19) xˆν

+xˆν

αi+αj(cid:18)−t +

1

2(cid:19) + xˆν

αj (0) xˆν

αi+αj (−t + 1)

Notice that if hναj , αi + αji ≥ 0, we have
αj (cid:18) 1

αi+αj (cid:18)−t +

2(cid:19) + xˆν

2(cid:19) xˆν

αj (0) xˆν

xˆν

1

αi+αj (−t + 1) = xˆν

αi+αj(cid:18)−t +
∈ U (n[ˆν]) n[ˆν]+

1

2(cid:19) xˆν

αj(cid:18) 1

2(cid:19) + xˆν

αi+αj (−t + 1) xˆν

αj (0)

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

if hναj , αi + αji = −1, we have

xˆν

1

2(cid:19) + xˆν
αi+αj(cid:18)−t +

αi+αj(cid:18)−t +
ναj (cid:18) 1
2(cid:19) xˆν

2(cid:19) xˆν
αj(cid:18) 1
= −xˆν
= −ǫC0(ναj , αi + αj)xˆν
+ǫC0(ναj , αi + αj)xˆν

αj (0) xˆν

αi+αj (−t + 1)

1

2(cid:19) + xˆν

ναj (0)xˆν

ναj +αi+αj (−t + 1) + xˆν
ναj +αi+αj (−t + 1) + xˆν

αi+αj (−t + 1)
2(cid:19) xˆν
αi+αj(cid:18)−t +
αi+αj (−t + 1) xˆν

1

ναj(cid:18) 1
2(cid:19)

ναj (0)

∈ U (n[ˆν]) n[ˆν]+

so that (4.67) can be expressed as

(4.69)

αj (m1 + 1) xˆν
xˆν

+ b

ǫC0(αj , αi)

 Xm1,m2∈ 1

Z<0
m1+m2=−t+1

2

αi+αj (m2)


for some b ∈ U (n[ˆν]) n[ˆν]+. For the second sum (4.68), we have
Xm1,m2∈ 1

αi+αj (m1) xˆν
xˆν

αj (m2 + 1)

Z<0
m1+m2=−t

2

αi+αj (m1) xˆν
xˆν

αj (m2) + xˆν

αi+αj (−t + 1) xˆν

αj (0) + xˆν

αi+αj(cid:18)−t +

1

2(cid:19) xˆν

αj (cid:18) 1
2(cid:19)

αi+αj (m1) xˆν
xˆν

αj (m2) + b

=

=

Z<0
m1+m2=−t+1

2

Xm1,m2∈ 1
Xm1,m2∈ 1

Z<0
m1+m2=−t+1

2

for some b ∈ U (n[ˆν]) n[ˆν]+. Putting these results together, we see that the sums (4.67) and (4.68) can
be combined and written as

(4.70)
for some b ∈ U (n[ˆν]) n[ˆν]+, and so we have
(4.71)

[R(αj, αj|t − 1), xˆν

αi (0)] + b

ψγi,θiτγi,θi(R0(αj, αj|t)) ∈ IΛ

as desired.

We now examine the case when ναi 6= αi. Applying ψγi,θiτγi,θi to R(αi, αi|t), we have that:

ψγi,θiτγi,θi(R0(αi, αi|t)) = ψγi,θiτγi,θi

2

αi (m1) xˆν
xˆν

Z<0
m1+m2=−t
1

 Xm1,m2∈ 1
αi(cid:18)m1 −

αi (m2)

αi(cid:18)−
2(cid:19) xˆν
2(cid:19) R0(αi, αi|t + 1) + aR0(αi, αi|1) ∈ IΛ

αi(cid:18)m2 −

2(cid:19) xˆν

xˆν

1

1

1

2(cid:19)

Z<0
m1+m2=−t

2

= Xm1,m2∈ 1
αi(cid:18)−

= xˆν

30

MICHAEL PENN AND CHRISTOPHER SADOWSKI

for some a ∈ U (n[ˆν]). Now, we apply ψγi,θiτγi,θi to R(αj, αj|t), where i 6= j. If hαi, αji = 0, we have
that

ψγi,θiτγi,θi(R0(αj, αj|t)) = xˆν

αi(cid:18)−

1

2(cid:19) R0(αj , αj|t) ∈ IΛ

if hαi, ναji ≥ 0 and

ψγi,θiτγi,θi(R0(αj, αj|t)) = ψγi,θiτγi,θi

αj (m1) xˆν
xˆν

1

2(cid:19) xˆν

αj (cid:18)m2 +

αj (cid:18)m1 +

1

2(cid:19) xˆν

αj(cid:18)m2 +

2

Z<0
m1+m2=−t

 Xm1,m2∈ 1
αj(cid:18)m1 +

xˆν

2

2

1

xˆν

= −xˆν

Z<0
m1+m2=−t

Z<0
m1+m2=−t

=
 Xm1,m2∈ 1
= −
 Xm1,m2∈ 1
2(cid:19)
ναi(cid:18)−
 Xm1,m2∈ 1
ǫC0(αj, ναi)
 Xm1,m2∈ 1
 Xm1,m2∈ 1

ǫC0(αj, ναi)

1
2

1
2

2

+

+

Z<0
m1+m2=−t

2

Z<0
m1+m2=−t

2

Z<0
m1+m2=−t

1

1

1

xˆν

2(cid:19)

αj (m2)

2(cid:19)
αi(cid:18)−

2(cid:19)
ναi(cid:18)−
2(cid:19)

2(cid:19)
αj (cid:18)m2 +

αj +ναi (m2)


2(cid:19) xˆν

xˆν

1

1

1

1

2(cid:19) xˆν
αj (m2)


)xˆν

1
2

xˆν

αj (cid:18)m1 +

xˆν

αj (cid:18)m1 +

xˆν
ναi (m1 +

= −xˆν

ναi(cid:18) 1

2(cid:19) R0(αj, αj|t − 1) + [R0(αj, αj|t −

1
2

), xˆν

ναi (0)] + b ∈ IΛ

for some b ∈ U (n[ˆν]) n[ˆν]+ if hαi, ναji = −1 (or equivalently hναi, αji = −1).

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

As before, if hαi, αji = −1, we have two cases to consider: the case where ναj = αj and the case

where ναj 6= αj. If ναj = αj, we have

ψγi,θiτγi,θi(R0(αj, αj|t)) = ψγi,θiτγi,θi

αj (m1) xˆν
xˆν

 Xm1,m2∈Z<0

m1+m2=−t

1

xˆν

αj (m2)

αj (m2 + 1)
2(cid:19)
αi(cid:18)−

αj (m2 + 1)

αi+αj(cid:18)m2 +

αj (m1 + 1) xˆν
xˆν

αj (m1 + 1) xˆν
xˆν

xˆν

αi+αj(cid:18)m1 +

1

2(cid:19)

αj (m2 + 1)

2(cid:19)] + b ∈ IΛ

1

2(cid:19) xˆν
αi(cid:18) 1

αj (m1 + 1) xˆν
xˆν

1

= xˆν

m1+m2=−t

= 
 Xm1,m2∈Z<0
2(cid:19)
αi(cid:18)−
 Xm1,m2∈Z<0
+ǫC0(αj, αi)
 Xm1,m2∈Z<0
 Xm1,m2∈Z<0

+ǫC0(αj, αi)

m1+m2=−t

m1+m2=−t

m1+m2=−t

= xˆν

αi (−1) R0(αj, αj|t) + [R0(αj, αj|t − 1), xˆν

for some b ∈ U (n[ˆν]) n[ˆν]+.

32

MICHAEL PENN AND CHRISTOPHER SADOWSKI

If ναj 6= αj , we have examine two cases: when hναi, αji = 0 and when hναi, αji = −1.

hναi, αji = 0, we have

If

ψγi,θiτγi,θi(R0(αj, αj|t)) = ψγi,θiτγi,θi

αj (m1) xˆν
xˆν

xˆν

αj (cid:18)m1 +

1

2(cid:19) xˆν

αi+αj (m1) xˆν
xˆν

αj (cid:18)m2 +

= xˆν

αi(cid:18)−

1

2(cid:19) R0(αj , αj|t) + [R0(αj , αj|t −

1
2

), xˆν

αi (0)] + b ∈ IΛ

2

Z<0
m1+m2=−t

 Xm1,m2∈ 1
αj (cid:18)m1 +

2

1

xˆν

= xˆν

Z<0
m1+m2=−t

= 
 Xm1,m2∈ 1
2(cid:19)
αi(cid:18)−
 Xm1,m2∈ 1
ǫC0(αj , αi)
 Xm1,m2∈ 1
 Xm1,m2∈ 1

ǫC0(αj , αi)

Z<0
m1+m2=−t

1
2

1
2

+

+

2

2

Z<0
m1+m2=−t

2

Z<0
m1+m2=−t

αj (m2)

2(cid:19)

αj (cid:18)m2 +

2(cid:19) xˆν

1

1

1

2(cid:19) xˆν

αj (cid:18)m2 +

xˆν

αj (cid:18)m1 +

1

1

xˆν

αi(cid:18)−
2(cid:19)
2(cid:19)

αi+αj (m2)

2(cid:19)


1

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

for some b ∈ U (n[ˆν]) n[ˆν]+. If hναi, αji = −1, we have

ψγi,θiτγi,θi(R0(αj, αj|t)) = ψγi,θiτγi,θi

αj (m1) xˆν
xˆν

1

xˆν

αj (m2)

αj (m2 + 1)
2(cid:19)
αi(cid:18)−

αj (m2 + 1)

αi+αj(cid:18)m2 +

αj (m1 + 1) xˆν
xˆν

αj (m1 + 1) xˆν
xˆν

 Xm1,m2∈ 1

Z<0
m1+m2=−t

2

αj (m1 + 1) xˆν
xˆν

2

1

= xˆν

Z<0
m1+m2=−t

= 
 Xm1,m2∈ 1
2(cid:19)
αi(cid:18)−
 Xm1,m2∈ 1
+ǫC0(αj, αi)
 Xm1,m2∈ 1
 Xm1,m2∈ 1

+ǫC0(αj, αi)

2

2

Z<0
m1+m2=−t

Z<0
m1+m2=−t

= xˆν

αi(cid:18)−

1

2(cid:19)

αj (m2 + 1)


), xˆν

αi (0)] + b ∈ IΛ

xˆν

αi+αj(cid:18)m1 +
2(cid:19) R0(αj, αj|t) + [R0(αj , αj|t −

Z<0
m1+m2=−t

1

2

3
2

1

2(cid:19) xˆν

for some b ∈ U (n[ˆν]) n[ˆν]+, completing our proof.

(cid:3)

Consider the maps

(4.72)

eαi : V T

L

L → V T
L ⊂ V T

and their restriction to the principal subspace W T

L where

(4.73)

and

eαi · 1 =

eαi · 1 =

2

σ(αi)

2

σ(αi)

xˆν
αi (−1) · 1 if ναi = αi
2(cid:19) · 1 if ναi 6= αi,
αi(cid:18)−

xˆν

1

Recall that we have a basis dual to the Z-basis with respect to h·,·i, of L given by {λi|1 ≤ i ≤ l}

(4.74)

eαixˆν

β (n) = C(αi, β)xˆν

β(cid:0)n −(cid:10)β(0), αi(cid:11)(cid:1) eαi.
as described in (2.89). For λ ∈ {λi|1 ≤ i ≤ l}, we now introduce the map
(4.75)

∆T (λ,−x) = (−1)νλxλ(0) E+(−λ, x).

This is a twisted version of the ∆-map in [Li2]. Recently such twisted maps have been exploited
in [CalLM4], [CalMPe], and [PS]. We will make use the constant term of ∆T (λ,−x) denoted by

34

MICHAEL PENN AND CHRISTOPHER SADOWSKI

∆T
c (λ,−x). Let us explore the action of ∆T
calculation will be made in two parts, the ﬁrst being when ναi = αi and thus νλi = λi:

c (λ,−x) on the operators xˆν

β (m) where β ∈ ∆+. This

∆T
c (λi,−x)(xˆν

β (m) · 1) = Coeﬀx0x−m−1

1

(cid:0)∆T (λi,−x)Y ˆν (eβ, x1)(cid:1)

Y ˆν(eβ, x1)

= θi(β)Coeﬀ

xhλi ,βi−m−1

1

(4.76)

where we have used the fact that

= θi(β)xˆν
= τγi,θi(xˆν

x1

β (m + hλi, βi) · 1
β (m)) · 1,
x (cid:17)hλi,βi E−(−β, x1)E+(−λi, x).
(cid:0)∆T (λi,−x)Y ˆν(eβ, x1)(cid:1)
(hλi, βi + hνλi, βi))(cid:19) · 1

2 (hλi ,βi+hνλi ,βi)−m−1

Y ˆν(eβ, x1)

x

1

1

= θi(β)Coeﬀ

= θi(β)xˆν

= τγi,θi(xˆν

β(cid:18)m +
1
2
β (m)) · 1,
2!hλi,βi 1 +

1
x
2
1
x 1

1
x
2
1
x 1

2!hνλi,βi

E−(−β, x1)E+(−λi, x).

(4.77)

E+(−λi, x)E−(−β, x1) =(cid:16)1 −
Now for the case when νλi 6= λi:
∆T
c (λi,−x)(xˆν

β (m) · 1) = Coeﬀx0x−m−1

1

(4.78)

where we have used

(4.79)

E+(−λi, x)E−(−β, x1) = 1 −

It follows that we have linear maps

(4.80)

where a ∈ U (n[ˆν]).

Theorem 5.1. We have

(5.1)

or equivalently

(5.2)

Proof. The inclusion

∆T
c (λi,−x) : W T

L → W T

L

a · 1 7→ τγi,θi(a) · 1,

5. The Main Results

Ker fΛ = IΛ,

Ker πΛ = IΛ · vN
Λ .

IΛ · vN

(5.3)
is trivial. The remainder of the proof will be for the reverse inclusion. Suppose that a ∈ ker πΛ\IΛ·vN
Λ .
We may assume that a is homogeneous with respect to all gradings and is a nonzero such element
with smallest possible total charge. (Consequently, a has a nonzero charge for some (λ(i))(0).) Among
all elements of smallest possible total charge, we may assume that a is also of smallest Lˆν(0)-weight.
We ﬁrst show that either

Λ ⊂ Ker πΛ

(5.4)

a ∈ IΛ + U (n[ˆν]) xˆν

αi (−1)

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

where ναi = αi, or

(5.5)

2(cid:19) ,
where ναi 6= αi. Suppose not. Then by Lemma 4.2 we have that
(5.6)

a ∈ IΛ + U (n[ˆν]) xˆν

αi(cid:18)−
Λ /∈ IΛ · vN
Λ .

τγi,θi(a) · vN

1

We also have that

(5.7)

and so using (4.80), we have

(5.8)

But, since

a · 1 = πΛ(a · vN

Λ ) = 0,

πΛ(τγi,θi(a) · vN

Λ ) = τγi,θi(a) · 1 = 0.

wt(τγi,θi(a)) < wt(a)

(5.9)
we have τγi,θi(a) ∈ IΛ, contradicting the minimality of a, and so
a ∈ IΛ + U (n[ˆν]) xˆν
(5.10)
αi (−1)
2(cid:19) ,
αi(cid:18)−

a ∈ IΛ + U (n[ˆν]) xˆν

in the case that ναi = αi or

(5.11)

1

if ναi 6= αi. First, we suppose that αi is ﬁxed under ν and a ∈ IΛ + U (n[ˆν]) xˆν

αi (−1), so that

a = b + cxˆν

αi (−1)

for some b ∈ IΛ and c ∈ U (n[ˆν]). Notice that b and cxˆν
total charge as a. We have that

αi (−1) are of the same total Lˆν(0) weight and

so that cxˆν

αi (−1) · vn

Λ ∈ ker πΛ \ IΛ · vN

(5.12)

cxˆν

αi (−1) · 1 = (a − b) · 1 = 0,
Λ . We also have that

cxˆν

αi (−1) · 1 = eαi(ταi,θi(c) · 1) = 0

so that, by the injectivity of eαi, we have that
(5.13)

ταi,θi(c) · 1 = 0.
Since ταi,θi(c) has lower total charge than a, we have that
ταi,θi(c) ∈ IΛ.
(5.14)

In view of Lemma 4.2, we have that

(5.15)

τ
−γi,θ−1

i

(ταi,θi(c)) ∈ IΛ + U (n[ˆν]) xˆν

αi (−1) .

Finally, applying Lemma 4.5 immediately gives

ψγi,τiτγi,θiτ

−γi,θ−1

i

(ταi,θi(c)) = cxˆν

αi (−1) ∈ IΛ.

(5.16)

Thus, we have that

(5.17)

(5.18)

which is a contradiction. A similar proof shows that if αi is not ﬁxed under ν

a = b + cxˆν

αi (−1) ∈ IΛ,
2(cid:19)
αi(cid:18)−

1

a = b + cxˆν

for some b ∈ IΛ and c ∈ U (n[ˆν]), then a ∈ IΛ, thus giving a contradiction.

(cid:3)

36

MICHAEL PENN AND CHRISTOPHER SADOWSKI

Theorem 5.2. For i chosen from a subset of {1, 2, 3,··· , l} so that (αi)(0) creates a complete and
non-repeating list, we have the following short exact sequences

L → 0
c (λi,−x) is surjective. Now we take

∆T

L

L

(5.19)

eαi−−→ W T

0 → W T

c (λi,−x)
−−−−−−−→ W T
Proof. It is clear that for all chosen i eαi, is injective and ∆T
w = a · 1 ∈ ker ∆T
(5.20)
and thus τγi,θi(a) ∈ IΛ by Theorem 5.1. This implies that
a ∈ IΛ + U (n[ˆν]) xˆν
(5.21)

c (λi,−x) for a ∈ U (n[ˆν]). So we have

c (λi,−x)w = τγ1,θ1(a) · 1,

0 = ∆T

if ναi = αi and

(5.22)

a ∈ IΛ + U (n[ˆν]) xˆν

αi (−1) ,
αi(cid:18)−
2(cid:19) ,
αi (−1) ( or IΛ + U (n[ˆν]) xˆν

1

′

2(cid:1) as appropriate).
∈ U (n[ˆν]) if ναi 6= αi and thus a · 1 = bxˆν
if ναi = αi or w = b
IΛ + U (n[ˆν]) xˆν
the condition that w = a · 1 ∈ Imeαi is equivalent to the condition that a ∈ IΛ + U (n[ˆν]) xˆν
IΛ + U (n[ˆν]) xˆν

if ναi 6= αi, by Lemma 4.2. So we have the condition that w = a · 1 ∈ ker ∆T
the condition that a ∈ IΛ + U (n[ˆν]) xˆν
Now suppose w = a · 1 ∈ Im eαi for a ∈ U (n[ˆν]). So we can write w = bxˆν
2(cid:1) · 1 for b
αi(cid:0)− 1
2(cid:1) as appropriate). So we have
w = a · 1 ∈ ker ∆T

2(cid:1)· 1 ∈ IΛ + U (n[ˆν]) xˆν
c (λi,−x) if and only if w = a · 1 ∈ Im eαi,

c (λi,−x) is equivalent to
αi(cid:0)− 1
αi (−1) · 1 for b ∈ U (n[ˆν])
αi (−1) · 1 ∈
2(cid:1) as appropriate. This implies that
αi (−1) (or

αi(cid:0)− 1
αi (−1) a· 1 = b
αi(cid:0)− 1

α1(cid:0)− 1

(5.23)

xˆν

xˆν

′

′

and thus

(5.24)

ker ∆T

c (λi,−x) = Im eαi .

(cid:3)

We use the multi-grading described earlier, and deﬁne the multigraded dimension of W T

L by:

(5.25)

χ(x; q) = tr|W T

L

(λ(i1 ))(0)
x
1

(λ(ik ))(0)
k

··· x

q2 ˆL ˆν (0) ∈ q

dim(h(1) )

16

C[[x, q]],

where the λ(ij ) are described in (2.91-2.92). We use the modiﬁcation

dimh(1)

χ′(x; q) = q−

(5.26)
Corollary 5.1. Let {αi1, . . . , αik} be a complete set of representatives from the equivalence classes of
the simple roots {α1, . . . , αl} formed by orbits under ν, m = (m1, m2, . . . , mk). We have the following
short exact sequences
(5.27)

16 χ(x; q) ∈ C[[x, q]].

0 →(cid:0)W T

L(cid:1)(m−εi,n−Pk

if ναi = αi and
(5.28)

j=1 2h(αij )(0),(αi)(0)imj +2)

0 →(cid:0)W T

L(cid:1)(m−εi,n−Pk

j=1 2h(αij )(0),(αi)(0)imj +1)

eαi−−→(cid:0)W T
eαi−−→(cid:0)W T

L(cid:1)(m,n)

∆T

c (λi,−x)

−−−−−−−→(cid:0)W T

L(cid:1)(m,n−2mi) → 0,

L(cid:1)(m,n)

∆T

c (λi,−x)

−−−−−−−→(cid:0)W T

L(cid:1)(m,n−mi) → 0,

if ναi 6= αi. Moreover, we have
(5.29)
χ′(x; q) = χ′(x1, . . . , xi−1, q2xi, xi+1, . . . , xk; q) + xiq2χ′(q2h(αi1 )(0)(αi)(0)ix1, . . . , q2h(αik )(0)(αi)(0)ixk; q)

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

if ναi = αi and
(5.30)
χ′(x; q) = χ′(x1, . . . , xi−1, qxi, xi+1, . . . , xk; q) + xiqχ′(q2h(αi1 )(0)(αi)(0)ix1, . . . , q2h(αik )(0)(αi)(0)ixk; q)
if ναi 6= αi.

Solving this recursion (cf. [A]) and using the notation (a; q)n = (1−a)(1−aq)(1−aq2) . . . (1−aqn−1),

we have:

Corollary 5.2. We have

mtAm

2

q

′

χ

k

≥0)

xm1
1

(5.31)

Explicitly,we have:

(x; q) = Xm∈(Zk

(qa1 ; qa1 )m1 ··· (qak ; qak )mk

··· xmk
where aj = 2 if ναij = αij , aj = 1 if ναij 6= αij and A = 2(cid:0)(cid:10)(αij )(0), (αik )(0)(cid:11)(cid:1).
For g = A2n−1, we have the n × n matrix
2 −1
0
0
2 −1
−1
0
2 −1
0 −1
...
...
...
. . .
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...

0
0
0
...
. . .
...
... −1
...

. . .
. . .
2 −1

2 −2
4

0
0
0
...
...
0

. . .
. . .
. . .

. . .
. . .
. . .





A =

. . .

. . .

0 −2

Note: This is a symmetrized Cartan matrix for the Lie algebra Cn with the last row multiplied by 2.
For g = Dn, we have the (n − 1) × (n − 1) matrix
0
4 −2
0
4 −2
−2
0
4 −2
0 −2
...
...
...
. . .
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...
...

0
0
0
...
. . .
...
... −2
...

4 −2
2

4 −2

0
0
0
...
...
0

. . .
. . .
. . .

. . .
. . .
. . .

A =

. . .

. . .

. . .

. . .

Note: This is a symmetrized Cartan matrix for the Lie algebra Bn−1 with the ﬁrst n−2 rows multiplied
by 2.
For g = E6, we have

0 −2

A =
2 −1
−1

0 −2
0

0
2 −2
0 −2

0
0
4 −2
4














38

MICHAEL PENN AND CHRISTOPHER SADOWSKI

Note: This is a symmetrized Cartan matrix for the Lie algebra F4 with the last 2 rows multiplied by 2.

Although there is a unique level one standard module for the algebras A(2)

6 as well
as associated twisted VL modules, we will also consider certain shifted principal subspaces and their
characters, in parallel with [CalLM3], [CalMPe], and [PS]. We will only include the general outline
of the construction of the shifted subspaces along with their characters. For a detailed treatment see
[PS].

2n−1, D(2)

n , and E(2)

For γ ∈ Q ⊗Z L, we form an isomorphic shifted copy of ˆg[ˆν] denoted by

(5.32)

ˆg[ˆνγ].

Further, we have a representation of ˆg[ˆνγ] on a shifted version of V T
operators given by

L denoted by V T,γ

L , with vertex

(5.33)
whose highest weight vector is we denote by vγ

Y ˆν,γ(ι(eα), x) = Y ˆν (ι(eα), x)xhα(0),γi,

Λ. Finally, we deﬁne the γ-shifted principal subspace

(5.34)

where n[ˆνγ] is a shifted version of n[ˆν].

W T,γ
L = U (n[ˆνγ]) · vγ

Λ

Now we move to our particular set up. Recall γi = (λi)(0) and let γi1 , . . . , γik be a complete list
j(x; q)

of such elements. For each j ∈ {i1, . . . , ik} we consider the subspace W γi
deﬁned in parallel with (5.25) and (5.26). These shifted characters are related to χ

L with its character χ

(x; q) by

′

′

(5.35)

χ

′

j(x; q) = χ

′

(x1, . . . , qaxj, . . . , xk; q)

where a = 2 if ναij = αij and a = 1 otherwise. This implies that

(5.36)

χ

′

j(x; q) = Xm∈(Zk

≥0)

mtAm

2 +amj

q

(qa1 ; qa1 )m1 ··· (qak ; qak )mk

xm1
1

··· xmk

k

where ar = 2 if ναir = αir , ar = 1 if ναij 6= αij , a = 2 if ναij = αij , a = 1 if ναij 6= αij , and
A = 2(cid:0)(cid:10)(αij )(0), (αik )(0)(cid:11)(cid:1).

References

[A]

[AKS]

[Ba]

[BHL]

[B]

[Bu1]

[Bu2]

G. Andrews, The Theory of Partitions, Encyclopedia of Mathematics and Its Applications, Vol. 2, Addison-
Wesley, 1976.
E. Ardonne, R. Kedem, and M. Stone, Fermionic characters and arbitrary highest-weight integrable bslr+1-
modules, Comm. Math. Phys. 264 (2006) 427-464.
I. Baranovi´c, Combinatorial bases of Feigin-Stoyanovsky’s type subspaces of level 2 standard modules for

(1)
4 , Comm. Algebra 39 (2011), 1007–1051.

D
K. Barron, Y.-Z. Huang and J. Lepowsky, An equivalence of two constructions of permutation-twisted modules
for lattice vertex operator algebras, J. Pure Appl. Algebra, 210 (2007), 797–826.
R. E. Borcherds, Vertex algebras, Kac-Moody algebras, and the Monster, Proc. Natl. Acad. Sci. USA 83
(1986), 3068–3071.
M. Butorac, Combinatorial bases of principal subspaces for aﬃne Lie algebra of type B
Algebra 218 (2014) 424-447.
(1)
M. Butorac, Quasi-particle bases of principal subspaces for the aﬃne Lie algebras of types B
l
Glas. Mat., to appear; arXiv:math.QA/1505.00450.

(1)
2 , J. Pure Appl.

(1)
and C
l

,

[BCFK] K. Bringmann, C. Calinescu, A. Folsom and S. Kimport, Graded dimensions of principal subspaces and

[C1]

modular Andrews-Gordon-type series, Comm. in Contemp. Math. 16 (2014).
C. Calinescu, Principal subspaces of higher-level standard d
559-575.

sl(3)-modules, J. Pure Appl. Algebra 210 (2007),

VERTEX-ALGEBRAIC STRUCTURE OF PRINCIPAL SUBSPACES OF THE BASIC MODULES FOR TWISTED AFFINE KAC-MOODY LIE ALGEBRAS

[CalLM1] C. Calinescu, J. Lepowsky and A. Milas, Vertex-algebraic structure of the principal subspaces of certain

A

(1)
1 -modules, I: level one case, Internat. J. Math. 19 (2008), 71–92.

[CalLM2] C. Calinescu, J. Lepowsky and A. Milas, Vertex-algebraic structure of the principal subspaces of certain

A

(1)
1 -modules, II: higher level case, J. Pure Appl. Algebra 212 (2008), 1928–1950.

[CalLM3] C. Calinescu, J. Lepowsky and A. Milas, Vertex-algebraic structure of the principal subspaces of level one

modules for the untwisted aﬃne Lie algebras of types A, D, E, J. Algebra 323 (2010), 167–192.

[CalLM4] C. Calinescu, J. Lepowsky and A. Milas, Vertex-algebraic structure of principal subspaces of standard A

modules, I, Internat. J. Math. 25 (2014).

(2)
2 -

[CalMPe] C. Calinescu, A. Milas, and M. Penn, Vertex-Algebraic Structure of Principal Subspaces of Basic A

(2)
2n -

[CLM1]

[CLM2]

[DL1]

[DL2]

[DLM]

[FS1]

[FS2]

[FHL]

[FK]

[FLM1]

[FLM2]

[FLM3]

[G]

[J1]

[J2]

[JP]

[K]
[Ka1]

[Ka2]

[Ko]

[L1]

Modules, J. Pure Appl. Algebra 220 (2016) 1752-1784.
S. Capparelli, J. Lepowsky and A. Milas, The Rogers-Ramanujan recursion and intertwining operators,
Comm. in Contemp. Math. 5 (2003), 947–966.
S. Capparelli, J. Lepowsky and A. Milas, The Rogers-Selberg recursions, the Gordon-Andrews identities and
intertwining operators, The Ramanujan Journal 12 (2006), 379–397.
C. Dong and J. Lepowsky, The algebraic structure of relative twisted vertex operators, J. Pure Appl. Algebra
110 (1996), 259–295.
C. Dong and J. Lepowsky, Generalized Vertex Algebras and Relative Vertex Operators, Progress in Mathe-
matics, Vol. 112, 1993.
C. Dong, H. Li and G. Mason, Simple currents and extensions of vertex operator algebras, Comm. in Math.
Phys. 180 1996, 671–707.

[DLeM] B. Doyon, J. Lepowsky and A. Milas, Twisted vertex operators and Bernoulli polynomials, Comm. in Con-

temp. Math. 8 (2006), 247–307.

[FFJMM] B. Feigin, E. Feigin, M. Jimbo, T. Miwa, and E. Mukhin, Principal csl3 subspaces and quantum Toda

Hamiltonian, Advanced Studies in Pure Math. 54 (2009), 109-166.
B. Feigin and A. Stoyanovsky, Quasi-particles models for the representations of Lie algebras and geometry
of ﬂag manifold; arXiv:hep-th/9308079.
B. Feigin and A. Stoyanovsky, Functional models for representations of current algebras and semi-inﬁnite
Schubert cells (Russian), Funktsional Anal. i Prilozhen. 28 (1994), 68–90; translation in: Funct. Anal. Appl.
28 (1994), 55–72.
I. Frenkel, Y.-Z. Huang and J. Lepowsky, On axiomatic approaches to vertex operator algebras and modules,
Memoirs American Math. Soc. 104, 1993.
I. Frenkel and V. Kac, Basic representations of aﬃne Lie algebras and dual resonance models, Invent. Math.
62 (1980), 23–66.
I. Frenkel, J. Lepowsky and A. Meurman, A natural representation of the Fischer-Griess Monster with the
modular function J as character, Proc. Natl. Acad. Sci. USA 81 (1984), 3256–3260.
I. Frenkel, J. Lepowsky and A. Meurman, Vertex operator calculus, in: Mathematical Aspects of String
Theory, Proc. 1986 Conference, San Diego, ed. by S.-T. Yau, World Scientiﬁc, Singapore, 1987, 150–188.
I. Frenkel, J. Lepowsky and A. Meurman, Vertex Operator Algebras and the Monster, Pure and Applied
Math., Vol. 134, Academic Press, 1988.
G. Georgiev, Combinatorial constructions of modules for inﬁnite-dimensional Lie algebras, I. Principal sub-
space, J. Pure Appl. Algebra 112 (1996), 247–286.
M. Jerkovi´c, Recurrence relations for characters of aﬃne Lie algebra A
913–926.
M. Jerkovi´c, Character formulas for Feigin-Stoyanovsky’s type subspaces of standard esl(3, C)-modules, Ra-
manujan J. 27 (2012), 357–376.
M. Jerkovi´c, M. Primc, Quasi-particle fermionic formulas for (k, 3)-admissible conﬁgurations, Cent. Eur. J.
Math. 10 (2012), 703–721.
V. Kac, Inﬁnite Dimensional Lie Algebras, 3rd edition, Cambridge University Press, 1990.
K. Kawasetsu, The
arXiv:math.QA/1305.6463.
K. Kawasetsu, The Free Generalized Vertex Algebras
arXiv:math.QA/1502.06985.
S. Koˇzi´c, Principal subspaces for quantum aﬃne algebra Uq(A
2148.
J. Lepowsky, Calculus of twisted vertex operators, Proc. Nat. Acad. Sci. USA 82 (1985), 8295–8299.

(1)
n ), J. Pure Appl. Algebra 218 (2014), 2119–

and Generalized Principal Subspaces,

, J. Pure Appl. Algebra 213 (2009),

intermediate

vertex

subalgebras

vertex

operator

algebras,

of

the

lattice

(1)
l

MICHAEL PENN AND CHRISTOPHER SADOWSKI

40

[L2]

[LL]

[LP]

[LW]

[Li1]

[Li2]

[MPe]

[P]

[PS]

[S1]

[S2]

[Za]

[T1]

[T2]

[T3]

(1)
1 , Contemp.

(1)
1 , Comm. Math. Phys. 62, (1978)

J. Lepowsky, Perspectives on vertex operators and the Monster, in: Proc. 1987 Symposium on the Mathe-
matical Heritage of Hermann Weyl, Duke Univ., Proc. Symp. Pure Math., American Math. Soc. 48 (1988),
181–197.
J. Lepowsky and H. Li, Introduction to Vertex Operator Algebras and Their Representations, Progress in
Mathematics, Vol. 227, Birkh¨auser, Boston, 2003.
J. Lepowsky and M. Primc, Structure of the standard modules for the aﬃnene Lie algebra A
Math. 46, American Mathematical Society, Providence, 1985.
J. Lepowsky and R. L. Wilson, Construction of the aﬃne Lie algebra A
43-53.
H.-S. Li, Local systems of twisted vertex operators, vertex superalgebras and twisted modules, Contemp.
Math. 193 (1996), 203–236.
H.-S. Li, The physics superselection principle in vertex operator algebra theory, J. Algebra 196 (1997),
436–457.
A. Milas and M. Penn, Lattice vertex algebras and combinatorial bases: general case and W-algebras, New
York J. Math. 18 (2012), 621–650.
M. Penn, Lattice Vertex Superalgebras I: Presentation of the Principal Subspace, Communications in Alge-
bra.Volume 42, Issue 3 (2014), 933-961.
M. Penn and C. Sadowski, Vertex-algebraic structure of principal subspaces of basic D
C. Sadowski, Presentations of the principal subspaces of the higher-level standard d
Appl. Algebra 219 (2015) 2300-2345.
C. Sadowski, Principal subspaces of higher-level standard [
ics, Vol. 26, No. 08, 1550063 (2015).
D. Zagier, The dilogarithm function, in Frontiers in Number Theory, Physics, and Geometry II, Springer
(2007), 3-65.
G. Trupˇcevi´c, Combinatorial bases of Feigin-Stoyanovsky’s type subspaces of level 1 standard modules for
esl(l + 1, C ), Comm. Algebra 38 (2010), 3913–3940.
G. Trupˇcevi´c, Combinatorial bases of Feigin-Stoyanovsky’s type subspaces of higher-level standard esl(l+1, C )-
modules, J. Algebra 322 (2009), 3744–3774.
G. Trupˇcevi´c, Characters of Feigin-Stoyanovsky’s type subspaces of level one modules for aﬃne Lie algebras
of types A

(3)
4 -modules, to appear.
sl(3)-modules, J. Pure

sl(n)-modules, International Journal of Mathemat-

(1)
l

and D

(1)
4 , Glas. Mat. Ser. III 46, 66 (2011), 49–70.

Department of Mathematics and Computer Science, Colorado College, Colorado Springs, CO
80903
E–mail address: michael.penn@coloradocollege.edu

Department of Mathematics and Computer Science, Ursinus College, Collegeville, PA 19426
E–mail address: csadowski@ursinus.edu

