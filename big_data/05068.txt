6
1
0
2

 
r
a

 

M
6
1

 
 
]
E
M

.
t
a
t
s
[
 
 

1
v
8
6
0
5
0

.

3
0
6
1
:
v
i
X
r
a

Nonparametric imputation method for nonresponse in surveys

Caren Hasler∗ and Radu V. Craiu†

March 17, 2016

Abstract

Many imputation methods are based on statistical models that assume that the variable of

interest is a noisy observation of a function of the auxiliary variables or covariates. Misspeci-

ﬁcation of this model may lead to severe errors in estimates and to misleading conclusions. A

new imputation method for item nonresponse in surveys is proposed based on a nonparametric

estimation of the functional dependence between the variable of interest and the auxiliary vari-

ables. We consider the use of smoothing spline estimation within an additive model framework

to ﬂexibly build an imputation model in the case of multiple auxiliary variables. The perfor-

mance of our method is assessed via a simulation study, suggesting that our method performs

better than the other competing imputation methods.

Keywords: Additive Models, Data Imputation, Sample Survey, Smoothing Spline.

1 Introduction

Nonresponse in surveys is a commonly encountered problem that, when ignored, can aﬀect the

performance of the statistical estimators for the quantities of interest. Two general adjustment

techniques that have been developed to alleviate the eﬀects of nonresponse are reweighting and

imputation. Reweighting procedures consist of increasing the initial weights of respondents in order

to compensate for nonrespondents and are commonly used to treat unit nonresponse. Imputation

procedures consist of ﬁlling in the missing values in the data with imputed values and are commonly

∗
†

Institute of Statistics, University of Neuchˆatel, Av. de Bellevaux 51, 2000 Neuchˆatel, Switzerland
Department of Statistical Sciences, University of Toronto, 100 St. Georges Street, Toronto, Ontario, M5S 3G3,

Canada

1

used to treat item nonresponse. When dealing with nonresponse, both reweighting and imputation

may rely on a statistical model. Imputation for the variable of interest can be more eﬃcient if it

is based on information contained in a number of auxiliary variables, speciﬁcally, through a model

that estimates a functional link between the latter and the variable of interest. However, the validity

of the model will have a direct eﬀect on the accuracy of the estimated quantities. It is therefore

crucial to be able to build ﬂexible models that can capture a large spectrum of patterns and make

only weak assumptions about the true underlying mechanism generating the data. Given these

constraints, it is not surprising that nonparametric models have been used to handle nonresponse

in surveys.

Giommi (1987) focused on unit nonresponse and proposed two nonparametric reweighting pro-

cedures based on kernel density estimators to estimate response probabilities. Later, Niyonsenga

(1994, 1997) used the nonparametric estimation of Giommi (1987) to handle nonresponse when

unit nonresponse and item nonresponse occur together. Finally, Da Silva and Opsomer (2006) and

Da Silva and Opsomer (2009) applied, respectively, kernel regression and local polynomial regres-

sion to estimate the response probabilities and derived asymptotic properties of the propensity

score adjusted estimator for these approaches. These techniques are suitable when the number of

auxiliary variables is relatively low. We propose here an imputation method for item nonresponse in

surveys when the variable of interest is a noisy observation of a function of many auxiliary variables.

We consider smoothing spline models within an additive regression framework which allows us to

handle a large number of auxiliary variables. This improvement signiﬁcantly expands the range of

nonparametric methods for handling nonresponse. Moreover, the model considered is adaptable

to a wide variety of functional patterns thus providing protection against model misspeciﬁcation.

Results of a simulation study conﬁrm the performance of our method and highlight its capacity to

adapt to many diﬀerent situations.

The paper is organized as follows: Section 2 establishes the framework and introduces notation;

Section 3 provides a motivation for the new imputation method; two nonparametric tools used in

the new imputation method are reviewed in Section 4; Section 5 presents the new method as well as

bootstrap procedures to estimate the variance of the total. The performance of the new method is

compared to that of other imputation methods through a simulation study presented in Section 6.

We close with concluding remarks and a discussion of future work.

2

2 Framework

Consider a ﬁnite population U = {1, 2, . . . , N} of possibly unknown size N . Suppose that the
parameter of interest is the population total

(cid:88)

i∈U

Y =

yi,

for some unknown variable of interest y. A sample S of size n is selected from U according to a
probabilistic sampling design p(·) with the aim of observing yi for i ∈ S. Consider

πi = Pr(i ∈ S) =

p (s) ,

(cid:88)

s⊂U ;s(cid:51)i

the ﬁrst-order inclusion probability of unit i and suppose that πi > 0 for all i ∈ U . Let di = 1/πi
represent the design weight of unit i ∈ U . In this paper we consider two widely used sampling
designs, simple random sampling without replacement (SRSWOR) and stratiﬁed sampling (SS).

Under SRSWOR, each sample of (ﬁxed) size n has the same probability of being selected and
πi = n/N for all i ∈ U . Under SS, the population U is partitioned into H strata U1, . . . , UH of
respective sizes N1, . . . , NH and SRSWOR is applied independently in each stratum h. A sample
Sh of size nh is hence selected in each stratum Uh, h = 1, . . . , H and πi = nh/Nh for all i ∈ Uh.

Once a sample S is selected, each unit i ∈ S is classiﬁed as either respondent or nonrespondent,
depending on whether yi is observed or missing. Consider the response indicator vector (ri|i ∈ S)(cid:62)
where ri takes value 1 if yi is observed and 0 if it is missing. This results in the set of respondents
Sr = {i ∈ S|ri = 1} and in the set of nonrespondents Sm = {i ∈ S|ri = 0}.

Under complete response, the Horvitz-Thompson estimator

is a design unbiased estimator for Y , i.e. Ep((cid:98)Y ) = Y . In the case of a survey with nonresponse,

i∈S

however, the estimator (1) cannot be computed since some of the yi’s, i ∈ S are missing. One
remedy is to impute each missing value yi, i ∈ Sm with an imputed value y∗i . The population total
Y can then be estimated through the imputed estimator

(cid:98)YI =

(cid:88)

i∈S

1
πi

[yiri + y∗i (1 − ri)] =

1
πi

yi +

1
πi

y∗i =

(cid:88)

i∈Sm

(cid:88)

i∈S

(cid:101)yi,

1
πi

(cid:88)

(cid:98)Y =

1
πi

yi,

(cid:88)

i∈Sr

3

(1)

(2)

where

 yi

y∗i

(cid:101)yi =

if i ∈ Sr;
if i ∈ Sm.

(cid:98)YI is a design unbiased estimator for the population total Y . Hence, an imputation method that
If the imputation process exactly reconstructs the missing values, that is if y∗i = yi for i ∈ Sm, then

reconstructs the missing data well can provide protection against nonresponse bias. Design weights

can optionally be taken into account when constructing the imputed values, the resulting method

being referred to as survey weighted imputation.

Consider a vector xi = (xi1, xi2, . . . , xiq)(cid:62) of values taken by q auxiliary variables x1, x2, . . .,
xq and known for all i ∈ U or at least for all i ∈ S. Auxiliary information can be used at diﬀerent
stages of the survey, namely in establishing the sampling design, for estimation, and handling of

nonresponse. Reliable auxiliary information can explain the variation in the variable of interest

and/or in the response probabilities and helps reduce error due to sampling and nonresponse.

3 Motivation

We consider a variable of interest, y, that is measured along with q auxiliary variables, x1, . . . , xq.

In situations in which the variable of interest is not recorded for some sampled units, one may rely

on the auxiliary variables to impute the missing values if there is a way to connect these variables

via an imputation model (S¨arndal, 1992). For instance, consider a general model of the type

yi = f (xi1, xi2, . . . , xiq) + εi,

(3)

where f is a function from Rq to R, and εi are zero-mean independent errors with variance σ2. A

deterministic imputation method estimates ﬁrst the function f based on those individuals/items
i ∈ Sr for which (yi, xi) = (yi, xi1, . . . , xiq) are fully observed, and then imputes values for i ∈ Sm
using the estimated function and the observed xi. The challenging issue of estimating f naturally

arises because the choice of the imputation model crucially impacts the accuracy of the imputed

values. A misspeciﬁed model may result in highly biased estimates for the parameters of interest.

Without prior knowledge on the form of f in (3), it is natural to use a nonparametric regression
model since the resulting estimate ˆf is known to adapt to the shape of f based on the information

provided by the data. When handling survey data, however, several auxiliary variables are often

4

q(cid:88)

available and one needs to include most of them in the model. Unfortunately, a few nonparametric

smoothers such as kernel-based ones tend to break down in high dimension, unless the sample size

is very large. This phenomenon is known as the curse of dimensionality (Bellman, 1961; Stones,

1985) and can be alleviated if an additive model (AM, Hastie and Tibshirani, 1986) is used. Such

a model is additive in the predictor variables and takes the form

yi = a0 +

aj(xij) + εi,

(4)

j=1

where (yi, xi) = (yi, xi1, . . . , xiq), i = 1, . . . , N , are observations, a0 is a constant, aj, j = 1, . . . , q,

are univariate smooth functions, and εi are zero-mean independent errors with common variance

σ2. The functions aj, j = 1, . . . , q, are each individually estimated by univariate smoothers so the
curse of dimensionality is avoided because the original problem of nonparametric estimation in Rq
has been replaced by q estimation problems in R. Without loss of generality, henceforth we suppose
that the xi, i = 1, . . . , N , lie in the interval [0, 1]q.

We propose an imputation method for nonresponse in survey based on AM. The new method is

based on imputation model (4). The nonparametric tools used to estimate the regression function

are presented in Section 4 and the new method is presented in Section 5.

4 Nonparametric tools

This section introduces two nonparametric tools used in the new imputation method, smoothing

spline regression and additive models. The main idea of smoothing spline regression is to ﬁt a

data set with a curve that maximizes a measure of goodness-of-ﬁt while achieving a ﬁxed degree of

smoothness. There is an extensive literature devoted to spline regression and we refer the reader

to Green and Silverman (1994), Eubank (1999), and Wang (2011). Smoothing spline regression

(SSR) assumes model (4) with a unique predictor variable, that is

yi = a(xi) + εi, 1 ≤ i ≤ N

where εi are zero-mean independent errors with common variance σ2, and a is a smooth function
(cid:26)
in the sense that a ∈ W m

2 [0, 1] is the Sobolev space

2 [0, 1] where W m

(cid:90) 1

W m

2 [0, 1] =

g : g, g(cid:48), . . . , g(m−1) are absolutely continuous,

(cid:27)
g(m)(t)2 < +∞

.

0

5

We consider a basis of functions bk, k ∈ 1, . . . K, called spline basis functions, for W m
The resulting smoothing spline estimator (cid:98)a is the minimizer of the following penalized least square
yields the best approximation of function a in W m

2 [0, 1] while controlling the degree of smoothness.

2 [0, 1]. The SSR

(PLS) criterion

1
N

N(cid:88)

i=1

(yi − g(xi))2 + λ

g(m)(t)2dt,

(5)

over all functions in W m

2 [0, 1]. The parameter λ is the smoothing parameter and its size decides

the balance between goodness-of-ﬁt, as measured by the mean squared residual, and smoothness,

as measured by the integral. There exist diﬀerent basis of functions, each of which can produce a

diﬀerent smoothing spline estimator. In what follows, we will consider the thin plate spline basis (see

Wood, 2003) and the smoothing parameter λ will be selected by generalized cross validation.

With survey data, it is often desirable to consider design weights when estimating parameters

of interest. Indeed, a design weight di = 1/πi can be interpreted as the number of population units

that sampled unit i represents. Hence, when units are selected with unequal inclusion probabilities

it might be unreasonable to assume that each sampled unit has the same inﬂuence on the parameters

of interest. A weighted version of the smoothing spline estimator was proposed by Zhang et al.

(2013) who suggested adding design weights in the general PLS criterion in equation (5). Hence,

they consider the smoothing spline estimator adapted for survey data which is the minimizer over

(cid:90) 1

0

(cid:90) 1

0

g of

where (cid:98)N = (cid:80)

(cid:88)

i∈S

1(cid:98)N

di (yi − g(xi))2 + λ

g(m)(t)2dt,

(6)

i∈S di is the estimated population size. Note that Zhang et al. (2013) restrict

themselves to the case m = 2.

A ﬂexible way to combine the contributions of each auxiliary variable to the variable of interest

is provided by the additive model paradigm. A class of generalized additive models was proposed

by Hastie and Tibshirani (1986) and was discussed in depth in the book Hastie and Tibshirani

(1990). We focus here on the additive regression model (AM), which assumes

q(cid:88)

yi = a0 +

aj(xij) + εi,

where a0 is a constant, aj, j = 1, . . . , q, are smooth functions, and εi are zero-mean independent

errors with common variance σ2. SSR is used to estimate each function aj, j = 1, . . . , q. A

j=1

6

backﬁtting algorithm (Hastie and Tibshirani, 1986) or a direct ﬁtting approach (Wood, 2008) can

be considered.

When appropriate, an additive model allows us to handle multiple predictor variables in a

reasonable computation time and avoids the curse of dimensionality problem as it breaks a high-

dimensional nonparametric estimation problem into a number of one-dimensional ones.

5 The method

In this section, we propose a nonparametric model-based imputation method for nonresponse in

surveys and discuss bootstrap procedures to estimate the resulting variance of the total estimator

for the population U .

5.1 Estimation and imputation

Assume that the sample S contains respondents Sr for which the values of the variable of interest
{yi : i ∈ Sr} are observed and nonrespondents for which these values {yi : i ∈ Sm} are missing.
For each unit i ∈ S we have available auxiliary variables values xi = {xi1, . . . , xiq}. We consider
the following additive imputation model

q(cid:88)

yi = a0 +

aj(xij) + εi,

(7)

j=1

where a0 is a constant, aj, j = 1, . . . , q, are univariate functions in the functional space deﬁned in

Section 4, and εi are zero-mean independent errors with common variance σ2. Smoothing spline

estimates(cid:98)aj, j = 1, . . . , q, of functions aj, j = 1, . . . , q, and an estimate(cid:98)a0 of a0 are obtained using

the complete data (yi, xi), i ∈ Sr. Two diﬀerent smoothing splines estimators can be obtained
based on expression (5) (unweighted imputation) or expression (6) (survey weighted imputation),
respectively. Finally, missing values yi, i ∈ Sm, are imputed with predictions based on imputation
model (7) as follows

It is sometimes desirable to apply hot-deck imputation methods, i.e. to impute values that

are possible (e.g. integers) or have been already observed. The new method based on AM mostly

j=1

7

(8)

y∗i =(cid:98)a0 +

q(cid:88)

(cid:98)aj(xij).

imputes values that do not match observed values. The simple extension presented here leads to

a hot-deck imputation method and is built on the idea of predictive mean matching (Little, 1988).

The idea is to replace each imputed value with the closest observed value. Consider the observed
yi, i ∈ Sr, and the imputed values y∗i , i ∈ Sm, obtained via expression (8). To obtain a hot-deck
imputation method, imputed observed values y∗∗i

, i ∈ Sm, are obtained as follows

y∗∗i = yj(i) where

(cid:12)(cid:12)y∗i − yj(i)

(cid:12)(cid:12) = min
j∈S|rj =1|y∗i − yj| .

Alternative implementations are possible. For instance, if each value of the variable of interest is
restricted to be an integer, one can choose y∗∗i = int(y∗i ) where int(·) is the integer part function.
With this choice, the imputed values are possible but may not have been already observed in the

sample.

5.2 Variance estimation for the imputed total

A valid method for estimating the variance of the estimator of the population total must account

for the extra variability due to imputing the missing values. In turn, this variability is due to the

variance of predicted values y∗i produced via the additive model. Since an analytical expression for

the asymptotic error of AM predictive value is not available, we pursue a bootstrap-based approach.

Bootstrap procedures to estimate the variance of parameters of interest are available for diﬀerent

imputation methods and sampling designs. In this Section, we follow Shao and Sitter (1996) to

devise bootstrap procedures to estimate the variance of the total under AM imputation for simple

random sampling without replacement (SRSWOR) and stratiﬁed sampling (SS). The bootstrap

proposed in Shao and Sitter (1996) is asymptotically valid irrespective of the sampling design, or

the imputation method.

We follow Shao and Sitter (1996) and apply the without-replacement bootstrap (BWO) pro-

posed by Gross (1980) to estimate the variance of the total under AM imputation for SRSWOR.

Procedure 1 presents the applied procedure which proceeds as follows. Given a sample of size n

from a population of size N , we set k = N/n and assume k is an integer (otherwise we round it

oﬀ). In step 1 we construct a pseudopopulation of size N by replicating the sample k times. In

step 2, a simple random sample of size n is selected from the pseudopopulation. Because the pseu-

dopopulation consists of sampled units, the bootstrap sample is very likely to contain both units

with missing yi and units with observed yi. In step 3, AM imputation is applied to the bootstrap

8

sample. Steps 2 and 3 are repeated to obtain B analogs of the imputed total estimator. In step 5,

the bootstrap variance of the imputed total is obtained using the standard bootstrap formulae.

Procedure 1 Variance of the imputed total estimator under SRSWOR.

Step 1: Suppose N = kn for an integer k.

Construct a pseudopopulation by replicating the sample k times.

Step 2: Draw a SRSWOR of size n from the pseudopopulation of step 1.

Step 3: Apply AM imputation to impute the missing yi’s of the sample selected in step 2.

, . . . ,(cid:98)Y (B)

I

where (cid:98)Y (b)

I

is the

I

Step 4: Repeat steps 2 and 3 a large number of times B to obtain (cid:98)Y (1)
analog of (cid:98)YI for the b-th bootstrap sample.
Step 5: Obtain the bootstrap variance of (cid:98)YI by
B(cid:88)
Vboot((cid:98)YI ) =
is the mean bootstrap analog of (cid:98)YI
B(cid:88)

(cid:16)(cid:98)Y (b)
I −(cid:98)Y (.)

where (cid:98)Y (.)

(cid:17)2

1
B

b=1

,

I

I

(cid:98)Y (.)

I =

(cid:98)Y (b)

I

.

1
B

b=1

For SS, we also follow Shao and Sitter (1996) and apply the mirror-match bootstrap (MMB)

proposed by Sitter (1992) to estimate the variance of the total under AM imputation. Procedure 2

presents the applied procedure. In steps 1 and 2, the procedure mimics the stratiﬁed sampling by
selecting several times SRSWOR of size n(cid:48)h in stratum h. If n(cid:48)h is such that n(cid:48)h = fhnh, then the
size of the bootstrap sample S∗h is the same as that of Sh, i.e. n∗h = nh. This procedure is repeated
independently in each stratum h times to obtain a bootstrap sample S∗. Because the bootstrap

sample consists of sampled units, it is very likely to contain both units with missing yi and units

with observed yi. Hence, in step 4, AM imputation is applied to the bootstrap sample S∗ and the

of the imputed total estimator (cid:98)YI is obtained. Depending on the choice of

bootstrap analog (cid:98)Y (b)

I

n(cid:48)h and on whether randomization is applied to round n(cid:48)h and/or kh, the bootstrap procedure might
mimic a stratiﬁed sampling in a population whose size diﬀers from N . Fraction N/n∗ appears

9

in the computation of the bootstrap analog of the imputed total estimator (cid:98)YI to take this into

account. Steps 1 to 4 are repeated to obtain B analogs of the imputed total estimator. In step 6,

the bootstrap variance of the imputed total is obtained using the standard bootstrap formulae.

Procedure 2 Variance of the imputed total estimator under SS.

Step 1: Choose 1 ≤ n(cid:48)h < nh and select a SRSWOR of size n(cid:48)h without replacement from Sh.

If n(cid:48)h is not integer, apply a randomization (see Sitter, 1992).

Step 2: Repeat step 1 kh = nh(1 − f∗h)/(n(cid:48)h(1 − fh)) times independently to obtain a sample

S∗h = {hi : i = 1, . . . , n∗h} of size n∗h = n(cid:48)hkh, where fh = nh/Nh and f∗h = n(cid:48)h/nh.
If kh is not integer, apply a randomization (see Sitter, 1992)

Step 3: Repeat steps 1 and 2 independently for each stratum h to obtain a bootstrap sample

S∗ = {S∗1 , . . . , S∗H} = {hi : h = 1, . . . , H; i = 1, . . . , n∗h} of size n∗ =(cid:80)H
of the imputed total estimator (cid:98)YI by
(cid:88)

(cid:88)

H(cid:88)

(cid:98)Y (b)

I =

(cid:101)y(∗)

hi ,

(cid:101)y(∗)

hi
f∗h

N
n∗

hi∈S∗

=

N
n∗

nh
n(cid:48)h

h=1

hi∈S∗

h

h=1 n∗h.

Step 4: Apply AM imputation to impute the bootstrap sample S∗ and obtain the bootstrap analog

where (cid:101)y(∗)

hi

is the value of the variable of interest of unit hi if this one is observed and the

, . . . ,(cid:98)Y (B)

I

where (cid:98)Y (b)

I

is the

I

imputed value otherwise.

Step 5: Repeat steps 1 to 4 a large number of times B to obtain (cid:98)Y (1)
analog of (cid:98)YI for the b-th bootstrap sample.
Step 6: Obtain the bootstrap variance of (cid:98)YI by
B(cid:88)
Vboot((cid:98)YI ) =
is the mean bootstrap analog of (cid:98)YI
B(cid:88)

(cid:16)(cid:98)Y (b)
I −(cid:98)Y (.)

where (cid:98)Y (.)

(cid:17)2

1
B

b=1

,

I

I

(cid:98)Y (.)

I =

(cid:98)Y (b)

I

.

1
B

b=1

10

The computational time involved in the bootstrap evaluation of variance can be shortened if

multiple processors are available. The embarrassing parallel structure of the procedure implies

that the sample-speciﬁc calculation can be performed on a separate processor and the merging of

simulated values is needed only in Step 5 (for Procedure 1) and in Step 6 (for Procedure 2).

6 Simulations

A simulation study was conducted to test the performance of the proposed imputation method.

Simulated data and real data were considered. In Sections 6.1 and 6.2, the simulation settings for

the simulated data and for the real data are respectively presented. Measures used to compare

the new imputation method with existing imputation methods and to test the accuracy of the

bootstrap procedures for the variance estimation are described in Section 6.3. Finally, the results

of the simulations in each setting are displayed and commented in Sections 6.4 and 6.5 respectively.

6.1 Setting 1: simulated data

Populations of size N = 10000 were considered. Four auxiliary variables x1, x2, x3, and x4 were

generated. The values xi1, xi2, and xi3, i = 1, . . . , N, are independent draws from a Uniform[0, 1]

random variable and xi4, i = 1, . . . , N, are independent draws of a gamma density with shape

and scale parameters, respectively, 3 and 1/6 that were mapped into the [0, 1] interval via the
transformation xi4 → (xi4 − min(x4)) / (max(x4) − min(x4)).

Five populations were then generated as follows:

y(1)
i = 1 + 5xi1 + xi2 + xi3 + xi4 + εi,
y(2)
i = 2 + cos(πxi1 + π) + sin(4πxi2) + exp(−(xi3 − 0.5)2) + (xi4 − 0.5)2 + εi,
y(3)
i = 1 + cos(2πxi1) + xi1xi2 + x2
y(4)
i = 2 + cos(π(xi1 + xi2)) sin(π(xi3 + xi4)) + εi,
y(5)
i = 1 + εi,

i3xi4 + εi,

where i = 1, . . . , N , and where εi are N independent draws of a normal random variable with mean

0 and standard deviation 0.1. In the ﬁrst four populations, the variable of interest is linked to the

auxiliary variables. In the ﬁrst two populations the link is correctly speciﬁed by an AM, even a

11

linear model in population 1. In populations 3 and 4 the AM is not a valid representation of the

truth, while in the last population there is no link between the variable of interest and the auxiliary

variables.

Two diﬀerent sampling designs were used for the selection of samples: simple random sampling

without replacement (SRSWOR) and stratiﬁed sampling (SS). For simple random sampling, a

sampling rate of f = 0.2 was considered. For stratiﬁed sampling, strata were created as follows.

First, units were classiﬁed into two groups, depending whether their value xi1 is larger than the

median of x1 or not. In each group created, units were then subdivided into two other groups,

depending on whether their value xi2 is larger than the median of x2 in each group or not. The

procedure was repeated for variables x3 and x4. This resulted in creating 16 strata of size 625 that

are somewhat homogeneous with respect to the auxiliary variables. Then, SRSWOR was applied

within strata with a sampling rate of f = 0.2 in each stratum.

The response probabilities were obtained from

pi =

exp (b0 + b1xi1)

1 + exp (b0 + b1xi1)

,

where b0 and b1 were set to obtain an overall mean response rate which is approximately 75%.

Ten thousand simulations were then conducted as follow. For each simulation, a sample S was

selected according to either SRSWOR or SS. For each sample S selected, a respondents set Sr and
a nonrespondents set Sm were then created by generating a response indicator vector (ri|i ∈ S)(cid:62),
where ri, i ∈ S, was generated from a Bernoulli distribution with parameter pi. Then, for each set
of respondents and of nonrespondents obtained, the missing yi, i ∈ Sm, were replaced with imputed
y∗i using the four following imputation methods:

• Regression imputation: Imputed values y∗i , i ∈ Sm, are obtained by
where (cid:98)β = ((cid:98)β0,(cid:98)β1, . . . ,(cid:98)βq)(cid:62) is deﬁned by

y∗i = (cid:98)β0 +

j=1

q(cid:88)
(cid:98)βjxij,
−1(cid:88)

(cid:88)

(cid:98)β =

dj(1, xj)(cid:62)(1, xj)

di(1, xi)(cid:62)yi.

j∈Sr

i∈Sr

Regression imputation is based on imputation model model 3 with f (xi1, xi2, . . . , xiq) = β0 +

(cid:80)q

j=1 βjxij.

12

• Mean imputation: The missing yi, i ∈ Sm, are replaced by the respondents’ mean value,

(cid:88)
that is the imputed values y∗i , i ∈ Sm, are obtained by

1(cid:80)

y∗i =

dkyk.

j∈Sr dj

k∈Sr

Mean imputation is a particular case of regression imputation where only a constant covariate

is considered. It is based on imputation model 3 with f (xi1, xi2, . . . , xiq) = β0.

• Nearest neighbor imputation: The missing yi, i ∈ Sm, are replaced by their respective
nearest neighbor in the complete data. The proximity is quantiﬁed through the auxiliary
variables. Imputed values y∗i , i ∈ Sm, are obtained by

y∗i = yj(i) where d(xi, xj(i)) = min

j∈S|rj =1

d(xi, xj),

where d(·,·) is the Euclidean distance.

• AM imputation: An AM was ﬁtted using the complete data (yi, xi), i ∈ Sr, and imputed
values y∗i , i ∈ Sm, were obtained through predictions with this model, as explained in Sec-
tion 5. Survey weights were considered in the smoothing spline estimator computation of each

term, as in the PLS equation of expression (6). The model was ﬁtted using function gam of R

package mgcv (Wood, 2014). Function gam uses m = 2 and thin plate splines basis by default.

The model is ﬁtted by penalized likelihood maximization and the smoothing parameter is

selected by generalized cross validation.

The imputed total estimator (cid:98)YI was computed for each method and each simulation. Note that

all the considered imputation methods use auxiliary information when computing imputed values,

except mean imputation.

Moreover, ten thousand simulations were conducted to test the accuracy of the bootstrap pro-

cedures presented in Section 5.2 to estimate the variance of the total. SRSWOR and SS were

considered. For each simulation, a sample S, a set of respondents Sr and of nonrespondents Sm

were created as described above. The missing values were replaced with imputed values using AM

imputation. The imputed total estimator (cid:98)YI and its bootstrap variance Vboot((cid:98)YI ) were computed

for each simulation. For the bootstrap variance under SRSWOR, procedure 1 was applied where, in

step 1, the sample was replicated k = 1/f = 5 times to create a pseudopopulation of size 10000 and

13

B = 100 bootstrap replicates were generated. For the bootstrap variance under SS, procedure 2 was
applied where, in step 1, a sample of size 125 was selected in each stratum, that is n(cid:48)h = f · nh = 125
for each stratum h. This results in integer n(cid:48)h and kh for each stratum h.

6.2 Setting 2: real data

We consider the data from the 1992 family expenditure survey (FES), see Central Statistical Oﬃce

(1993). The data is made available by the UK data archive at the University of Essex. To test our

method, we considered that the households having a non-missing and larger than zero disposable

income (disposable income and self-supply and in kind) of the 1992 FES form the population of

interest. The size of this population is N = 7409. The variable disposable income was modiﬁed

as follows. First, it was divided by its mean value. Because income distributions are often right

skewed, the natural logarithm of the obtained value plus one was computed. One was added before

computing the logarithm to avoid negative values. We suppose that the aim of the survey is to

estimate the population total of the modiﬁed disposable income. The population was stratiﬁed

into 12 regions and simple random sampling with a sampling rate of f = 0.2 was applied within

each region (stratum). The sample size was randomly rounded for 8 strata for which this sampling

rate led to a non-integer sample size. For each sampled household, we supposed that the following

characteristics were observed:

xi1: number of adults in household i,

xi2: number of children in household i,

xi3: number of persons economically active in household i,

xi4: age of the head of household i,

xi5: age of the chief economic supporter of household i.

Such variables could for instance come from a register. It was supposed that the willingness of

a household to respond depends on the number of adults in this household and that the households

respond independently from each other. Hence, the response probabilities were obtained from

pi =

exp (b0 + b1xi1)

1 + exp (b0 + b1xi1)

,

14

where b0 and b1 were set to obtain an overall mean response rate which is approximately 70%. Then,

for each sampled household, a response indicator was generated from a Bernoulli distribution with

parameter pi. The modiﬁed disposable income was then recorded for respondents and erased for

nonrespondents. Ten thousand simulations were conducted. The same imputation methods as in

Section 6.1 were considered.

Moreover, ten thousand simulations were conducted to test the accuracy of the bootstrap pro-

cedures presented in section 5.2 to estimate the variance of the total. For each simulation, a sample

and a set of respondents and of nonrespondents were created as described above. The missing val-

ues were replaced with imputed values using AM imputation. The imputed total estimator (cid:98)YI and
its bootstrap variance Vboot((cid:98)YI ) were computed for each simulation. For the bootstrap variance,
procedure 2 was applied with B = 100 bootstrap replicates. We set n(cid:48)h = f ·nh and a randomization
was applied to round the non-integer n(cid:48)h and the non-integer kh (see Sitter, 1992).

6.3 Measures of comparison

For each simulation and each imputation method of both settings, the population total for the

variable of interest was estimated through the imputed estimator of expression (2). To compare

the performance of the methods, four comparison measures were recorded. First, to quantify the

accuracy of imputed values, the Monte Carlo mean relative prediction error was computed, which

is deﬁned as

MRPE =

1
L

where S((cid:96))
is the imputed value obtained for i ∈ S((cid:96))

L(cid:88)

(cid:96)=1

1
n((cid:96))
m

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) y∗i

(cid:88)

i∈S((cid:96))

m

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ,

((cid:96)) − yi
yi

m is the nonrespondents set obtained at the (cid:96)-th simulation, n((cid:96))

m is the size of S((cid:96))

m , y∗i

((cid:96))

m at the (cid:96)-th simulation, and L represents the number

of simulations. Then, for each imputation method, the performance of the imputed estimator of

expression (2) was studied through three comparison measures, namely

• the Monte Carlo relative bias (RB) deﬁned as
RB =

B
Y

,

where B = (cid:98)Y (·)

I − Y , (cid:98)Y (·)

I

represents the mean imputed estimator over the L simulations

(cid:98)Y (·)

I =

L(cid:88)

(cid:96)=1

1
L

(cid:98)Y ((cid:96))

I

,

15

and (cid:98)Y ((cid:96))

I

is the imputed estimator (cid:98)YI obtained at the (cid:96)-th simulation,

• the Monte Carlo relative root variance (or relative standard deviation) deﬁned as

RRVAR =

(VAR)1/2

Y

,

where

VAR =

1

L − 1

• the Monte Carlo relative root mean square error deﬁned as

(cid:17)2

,

L(cid:88)

(cid:16)(cid:98)Y ((cid:96))
I −(cid:98)Y (·)
(cid:0)B2 + VAR(cid:1)1/2

(cid:96)=1

I

.

Y

(cid:17)2

,

L(cid:88)

(cid:96)=1

I

(cid:16)(cid:98)Y ((cid:96))
I −(cid:98)Y (·)
L(cid:88)

boot((cid:98)YI ),

V((cid:96))

1
L

RRMSE =

VAR =

1

L − 1

For AM imputation, the following measures were computed to test the accuracy of the bootstrap

variance estimator:

• The Monte Carlo variance of the total estimator:

• The Monte Carlo expectation of the bootstrap variance estimator:

boot((cid:98)YI ) is the bootstrap variance Vboot((cid:98)YI ) obtained at the (cid:96)-th simulation,

(cid:96)=1

where V((cid:96))

VARboot =

• The coverage rate CR: the proportion of times the true total Y falls into the 95% conﬁdence

interval

(cid:98)YI ± 1.96

6.4 Results of setting 1

(cid:113)
Vboot((cid:98)YI ).

Figure 1, Figure 2, and Table 2 display the results of Setting 1. Table 1 reports the average ranks

over the populations of each imputation method for each measure of comparison. The absolute

value of RB was considered.

16

Figure 1: Comparison measures of four imputation methods in ﬁve populations under SRSWOR.

Figure 2: Comparison measures of four imputation methods in ﬁve populations under SS.

17

Pop1Pop2Pop3Pop4Pop500.10.20.30.4MRPERegressionMeanNearestneighborAMPop1Pop2Pop3Pop4Pop502·10−24·10−26·10−28·10−20.1AbsolutevalueofRBPop1Pop2Pop3Pop4Pop50.511.5·10−2RRVARPop1Pop2Pop3Pop4Pop502·10−24·10−26·10−28·10−20.1RRMSEPop1Pop2Pop3Pop4Pop500.10.20.30.4MRPERegressionMeanNearestneighborAMPop1Pop2Pop3Pop4Pop502·10−24·10−26·10−28·10−20.1AbsolutevalueofRBPop1Pop2Pop3Pop4Pop50.511.5·10−2RRVARPop1Pop2Pop3Pop4Pop502·10−24·10−26·10−28·10−20.1RRMSETable 1: Average ranks over ﬁve populations of each imputation method for each measure of

comparison (in absolute value).

Imputation method MRPE RB RRVAR

RRMSE

Simple random sampling (SRSWOR)

Regression

Mean

Nearest Neighbor

AM

Regression

Mean

Nearest Neighbor

AM

2.4

3.4

2.4

1.8

2.4

3.4

2.4

1.8

2.6

3.6

2.6

1.2

2.8

2.8

2.4

2.0

3.0

3.0

2.4

1.6

Stratiﬁed sampling (SS)

3.0

3.6

2.4

1.0

2.8

2.8

2.4

2.0

3.0

3.0

2.4

1.6

We ﬁrst comment the results shown in Figures 1 and 2. When functional dependence between

the variable of interest and the auxiliary variables is additive (populations 1 and 2), AM imputa-

tion provides the best results. If, moreover, this dependence functional is linear (population 1),

regression imputation performs as well as AM imputation. When there is no dependence between

the variable of interest and the auxiliary variables (population 5), all four methods perform fairly

similarly. Because the functional dependence between the variable of interest and the auxiliary

variables is not additive in populations 3 and 4, the results for these two populations allow us

to study the performance of AM imputation under model misspeciﬁcation. We can see that AM

imputation still performs the best in population 3. The reason for this is that, even though the

functional dependence is not additive, it can be well approximated by an additive function. In pop-

ulation 4, the situation is less obvious and it is diﬃcult to rank the imputation methods. Indeed,

in this population, nearest neighbor performs better than the other methods in terms of MRPE,

RRVAR, and RMSE, and AM performs better in terms of RB. In order to produce a global index of

18

Table 2: Monte Carlo variance of the total, Monte carlo expectation of the bootstrap variance

and coverage rate associated with AM imputation for two diﬀerent sampling designs and ﬁve

populations.

VAR

VARboot

CR

Simple random sampling (SRSWOR)

Population 1

91424.08

90745.57

Population 2

39926.89

40811.53

Population 3

23726.96

22933.32

Population 4

16351.94

14464.70

Population 5

625.62

590.12

0.94

0.95

0.94

0.93

0.94

Stratiﬁed sampling (SS)

Population 1

22958.24

22836.67

Population 2

24436.15

24189.18

Population 3

21844.84

21267.10

Population 4

12414.24

10894.36

Population 5

641.01

589.73

0.95

0.95

0.94

0.93

0.94

performance we ranked the imputing methods for each population and each performance criterion.

The results, reported in Table 1 show that, globally, AM imputation performs better than the other

imputation methods considered here.

The performance of the bootstrap-based estimators of variance is assessed in Table 2. Whether

the functional dependence between the variable of interest and the auxiliary variables is additive

(populations 1 and 2) or not (populations 3, 4, 5), the bootstrap variance is very close to the

variance obtained by simulation. Also, it leads to very good coverage rates (between 93% and 95%)

across all ﬁve populations considered.

19

6.5 Results of setting 2

Table 3 and Table 4 display the results of our analysis performed under setting 2. The numbers in

brackets in Table 3 report the ranks of each imputation method for each measure of comparison.

Table 3: Comparison measures for four imputation methods for FES data.

Imputation method MRPE
×101
3.24(3)

Regression

RB

×10−2

RRVAR RRMSE

×10−2

×10−2

0.75(2)

1.41(2)

1.60(2)

Mean

4.49(4)

5.52(4)

1.52(3)

5.73(4)

Nearest Neighbor

3.21(2)

0.79(3)

1.52(3)

1.72(3)

AM

2.88(1)

0.03(1)

1.39(1)

1.39(1)

Table 4: Monte Carlo variance of the total, Monte carlo expectation of the bootstrap variance

and coverage rate associated with AM imputation for FES data.

VAR

VARboot CR

4198.03

4031.72

0.94

We can see that AM imputation clearly outperforms the computing imputation methods in

terms of MRPE and in terms of RB and performs slightly better than the other methods in terms

of RRVAR. With this data, the bootstrap variance yields a coverage rate of 94% that is close to

the theoretically stated value of 95%.

7 Conclusion

A new imputation method for nonresponse in surveys based on spline smoothing within the additive

model paradigm was proposed. The simulations indicate that the new method is very ﬂexible and

can capture a large spectrum of functional dependencies between the variable of interest and the

auxiliary variables. Since the model requires only weak assumptions, it is less susceptible to model

20

misspeciﬁcation than other models such as parametric ones. Most importantly, the AM formulation

makes it possible to consider several auxiliary variables in the imputation process without running

into the curse of dimensionality phenomenon. A bootstrap procedure to estimate the variance of

the total under SRSWOR and SS was suggested.

Through a simulation study, the new imputation method was conﬁrmed to perform well in

many diﬀerent situations. The main conclusions of the simulation study are the following. AM

imputation performs better than the other imputation methods considered when the functional

dependence between the variable of interest and the auxiliary variables is additive or when this

dependence can be well approximated by an additive function. When this dependence is not

well approximated by an additive function or when there is no dependence between the variable

of interest and the auxiliary variables, AM imputation shows a performance similar to that of

the other imputation methods considered. In all the cases studied, the proposed bootstrap-based

variance estimates were close to the true Monte Carlo variance and produced very good coverage

rates.

Future work include extending the current method to situations in which the samples are de-

pendent and improving the computational speed of the variance via parallel processing.

Acknowledgements

The authors thank Yves Till´e for his constructive suggestions. This research was supported by the

Swiss National Science Foundation, project number P1NEP2 151904 (CH) and the Natural Science

and Engineering Research Council of Canada (RVC).

21

References

Bellman, R. (1961). Adaptive control processes: A guided tour. Princeton University Press.

Central Statistical Oﬃce (1993). Family expenditure survey, 1992 [computer ﬁle]. Technical report,

Colchester, Essex: UK Data Archive [distributor]. SN: 3064, http://dx.doi.org/10.5255/UKDA-

SN-3064-1.

Da Silva, D. N. and Opsomer, J. D. (2006). A kernel smoothing method of adjusting for unit

non-response in sample surveys. The Canadian Journal of Statistics, 34(4):563–579.

Da Silva, D. N. and Opsomer, J. D. (2009). Nonparametric propensity weighting for survey nonre-

sponse through local polynomial regression. Survey Methodology, 35(2):165–176.

Eubank, R. L. (1999). Nonparametric regression and spline smoothing (Second Edition). Marcel

Dekker.

Giommi, A. (1987). Nonparametric methods for estimating individual response probabilities. Survey

Methodology, 13(2):127–134.

Green, P. J. and Silverman, B. W. (1994). Nonparametric regression and generalized linear models.

Chapman & Hall/CRC.

Gross, S. T. (1980). Mean estimation in sample surveys. In Proceedings of the Survey Research

Methods Section, pages 181–184. American Statistical Association.

Hastie, T. J. and Tibshirani, R. J. (1986). Generalized additive models. Statistical Science,

1(3):297–318.

Hastie, T. J. and Tibshirani, R. J. (1990). Generalized additive Models. Chapman and Hall.

Little, R. J. A. (1988). Missing-data adjustments in large surveys. Journal of Business and Eco-

nomic Statistics, 6:287–296.

Niyonsenga, T. (1994). Nonparametric estimation of response probabilities in sampling theory.

Survey Methodology, 20(2):177–184.

22

Niyonsenga, T. (1997). Response probability estimation. Journal of Statistical Planning and In-

ference, 59:111–126.

S¨arndal, C.-E. (1992). Methods for estimating the precision of survey estimates when imputation

has been used. Survey Methodology, 18(2):241–252.

Shao, J. and Sitter, R. R. (1996). Bootstrap for imputed survey data. Journal of the American

Statistical Association, 91:1278–1288.

Sitter, R. R. (1992). A resampling procedure for complex survey data. Journal of the American

Statistical Association, 87(416):755–765.

Stones, C. J. (1985). Additive regression and other nonparametric models. The Annals of Statistics,

13(2):689–705.

Wang, Y. (2011). Smoothing splines: methods and applications. Chapman & Hall/CRC.

Wood, S. (2003). Thin plate regression splines. Journal of the Royal Statistical Society. Serie B

(Statistical Methodology), 65(1):95–114.

Wood, S. (2008). Fast stable direct ﬁtting and smoothness selection for generalized additive models.

Journal of the Royal Statistical Society. Serie B (Statistical Methodology), 70(3):495–518.

Wood, S. (2014). mgcv: Mixed GAM Computation Vehicle with GCV/AIC/REML smoothness

estimation. R package version 1.7-28, http://CRAN.R-project.org/package=mgcv.

Zhang, G., Christensen, F., and Zheng, W. (2013). Nonparametric regression estimators in complex

surveys. Journal of Statistical Computation and Simulation.

23

