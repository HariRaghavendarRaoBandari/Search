6
1
0
2

 
r
a

M
5

 

 
 
]
l
l
a
h
-
s
e
m

.
t
a
m
-
d
n
o
c
[
 
 

1
v
1
0
7
1
0

.

3
0
6
1
:
v
i
X
r
a

Optimization of STIRAP-based state transfer under dissipation

Ying-Dan Wang,1, ∗ Xiao-Bo Yan,1 and Stefano Chesi2, †

1Institute of Theoretical Physics, Chinese Academy of Sciences, Beijing 100190, China

2Beijing Computational Science Research Center, Beijing 100084, China

(Dated: March 8, 2016)

Using a perturbative treatment, we quantify the inﬂuence of non-adiabatic leakage and system
dissipation on the transfer ﬁdelity of a stimulated Raman adiabatic passage (STIRAP) process. We
ﬁnd that, optimizing transfer time rather than coupling proﬁles, leads to a signiﬁcant improvement
of the transfer ﬁdelity. The upper bound of the ﬁdelity has been found as a simple analytical
function of system cooperativities. We also provide a systematic approach to reach this upper
bound eﬃciently.

Introduction.- State transfer, where an arbitrary quan-
tum state is transmitted from a source to a target sys-
tem, is a fundamental task in quantum state engineering.
While sometimes it is possible to directly couple quan-
tum systems (even of diﬀerent nature), in many circum-
stances the transfer must be mediated by a third party
(a quantum bus), whose coherence properties play a cru-
cial role for the transfer process. To mitigate the eﬀect
of coupler decoherence, a particularly interesting class of
indirect transfer protocols is based on the idea of stim-
ulated Raman adiabatic passage (STIRAP), as it allows
to perform the state transfer with negligible excitation
on the quantum bus.

STIRAP was developed more than 2 decades ago for
population transfer in Λ-type atoms [1]. Due to the ad-
vantages of being robust, simple, and eﬃcient, this ap-
proach, as well as its theoretical extensitons [2–8], have
found application in a variety of physical systems and
for many diﬀerent tasks (see, e.g., Refs. [9–28]). One of
the most relevant applications of STIRAP is when a dis-
crete bosonic mode (e.g., of a micromechanical resonator,
microwave cavity, or optical cavity) mediates the state
transfer between two qubits (either of diﬀerent types such
as the hybrid systems of superconducting qubits and NV
centers, or distant qubits of the same type). Further-
more, one or both of the qubits can be replaced by a
cavity mode (see, e.g., [29, 30]).

While the optimization of STIRAP for atomic popula-
tion transfer was performed in a decoherence-free subsys-
tem [31], with the objective of reducing the non-adiabatic
leakage and of minimizing the pulse area or duration, the
interplay between decoherence and non-adiabatic transi-
tions is a crucial aspect for many current applications.
Diﬀerent from atomic systems, most solid-state quan-
tum devices suﬀer signiﬁcant dissipation. Hence, the pro-
longed operation time of STIRAP (required by adiabatic-
ity) becomes a severe drawback: even if the source and
target are relatively weakly coupled to the environment,
the accumulation of errors over a long transfer time could
still signiﬁcantly degrade the transfer ﬁdelity. Thus, in
the presence of dissipation, optimization of the coupling
proﬁles is essential to reach a trade-oﬀ between the non-

adiabatic leakage and system dissipation, and to guaran-
tee a high-ﬁdelity state transfer.

To the best of our knowledge, a general understand-
ing of this trade-oﬀ, as well as the resulting fundamental
limitations, is missing in the literature. Some previous
works considering the eﬀect of dissipation on STIRAP
have only included the decoherence of the intermediate
level [32–34], often with a phenomenological approach
[32, 35]. In other studies, the dissipation is numerically
simulated (see, e.g., [28, 36–38]).
In order to provide
physical insight and determine the power of STIRAP in
the most realistic scenario - and especially to clarify the
crucial interplay by the two types of dissipation mech-
anisms - we pursue here an analytical treatment, with
full consideration of the system dissipation. We solve the
master equation with a perturbative approach which is
accurate in the desired high-ﬁdelity regime. Although it
is usually believed that the coupling proﬁles play an im-
portant role in optimizing the protocol, we quantify their
inﬂuence and ﬁnd it is relatively minor. Instead, the up-
per bound of the STIRAP ﬁdelity critically depends on
the transfer time and it is decided by a simple function
of the cooperativities. We also provide a systematic opti-
mization procedure to reach this upper bound eﬃciently.
Our results can be applied to a variety of physical im-
plementations such as optomechanics, circuit QED, and
hybrid systems [39, 40].

(cid:16)

(cid:17)

i=1,2 Gi (t)

a†σ(i)− + aσ(i)

+

teraction picture is H I =(cid:80)

System and dynamics.- We consider the setup schemat-
ically illustrated in Fig. 1(a), where two qubits interact
resonantly with a common bosonic mode. Using the ro-
tating wave approximation, the Hamiltonian in the in-
,
with Gi(t) the tunable coupling strengths, a the bosonic
annihilation operator of the bus, and σ± = σx ± iσy.
Such a Jaynes-Cummings Hamiltonian has been real-
ized in cavity QED and various circuit QED architec-
tures. Considering dissipation, the bus and qubits de-
cay to their ground states with rates γ and κi, respec-
tively. The system dynamics is described by the mas-
ter equation dρI/dt = −i[H I, ρI] + LρI, with L = Lm +
q =

(cid:80)
i L(i)
κiD[σ(i)− ], with D[A]ρ = AρA† − 1

q and Lindblad dissipators Lm = γD[a] and L(i)

(cid:8)A†A, ρ(cid:9). Our dis-

2

2 γ(i)

ϕ D[σ(i)

cussion can also be easily extended by including pure de-
phasing terms 1
z ] [41]. This description of the
dynamics is commonly adopted in cavity QED, super-
conducting qubits, optomechanical systems, and might
capture the main features of other types of qubits as well,
although their decoherence dynamics in some cases can
be more complex (see, e.g., [42]).
The general goal is to transfer an arbitrary state |ψ(cid:105) =
cg |g(cid:105) + ce |e(cid:105) from qubit 1 to qubit 2. Considering a suﬃ-
ciently low environmental temperature (to allow at most
one excitation), the state transfer protocol is conﬁned in

a 4-level subspace formed by |1(cid:105) = (cid:12)(cid:12)e(1), 0, g(2)(cid:11), |2(cid:105) =
(cid:12)(cid:12)g(1), 1, g(2)(cid:11), |3(cid:105) = (cid:12)(cid:12)g(1), 0, e(2)(cid:11), |4(cid:105) = (cid:12)(cid:12)g(1), 0, g(2)(cid:11). It

is clear that in this low-excitation limit, each party can
be either a qubit or a bosonic mode, i.e., the discussion
below is also applicable to the case of two qubits cou-
pled through a third qubit [13, 43] or a solid-state qubit
coupled to an optical cavity through a mechanical oscil-
lator [44, 45] (as illustrated in Fig. 1(b)).
An ideal transfer corresponds to cg |4(cid:105) + ce |1(cid:105) →
cg |4(cid:105) + ce |3(cid:105). At zero temperature, state |4(cid:105) is stable
and all the loss of ﬁdelity is due to the transfer of the ex-
cited state. Hence in the following we only discuss cg = 0,
which is the most demanding case and it is equivalent to
a pure STIRAP process (marked by the blue shadow in
Fig. 1(c)). The idea of STIRAP is to adiabatically tune
G1(t) from zero to a ﬁnite value, while G2(t) is tuned
from a ﬁnite value to zero such that the system evolves
from |1(cid:105) to |3(cid:105). In the whole process, the system adiabat-
ically follows the instantaneous eigenstate (dark state):

(cid:12)(cid:12)˜2(t)(cid:11) = − cos θ(t)|1(cid:105) + sin θ(t)|3(cid:105) ,

with tan θ(t) = G1(t)/G2(t) and

θ(0) = 0,

θ(tf ) = π/2,

(1)

(2)

where tf is the ﬁnal operation time and it determines the
(cid:80)
overall speed of the transfer.
The density matrix ˜ρ = U† (t) ρI U (t) (where U (t) =
k |˜k (t)(cid:105)(cid:104)k| and {|˜k(t)(cid:105)} are the instantaneous eigen-

states of H I [41]) satisﬁes:

˙θ(t)√
2

d˜ρ(t)

dt

= −i[ ˜H(t), ˜ρ(t)] +

[µ, ˜ρ(t)] + ˜L˜ρ(t),

(3)

where ˜H(t) = G(t)(|1(cid:105)(cid:104)1| − |3(cid:105)(cid:104)3|), µ = (|2(cid:105)(cid:104)1| + |3(cid:105)(cid:104)2| −
2 (t). The transformed
dissipator is deﬁned by ˜L˜ρ = U†L(U ˜ρU†)U and its ma-
trix form can be found in a straightforward way [41]. The
last two terms in Eq. (3) corrupt the desired transfer pro-
cess: the ﬁrst one represents the non-adiabatic leakage

h.c.), and G (t) = (cid:112)G2
out of(cid:12)(cid:12)˜2(t)(cid:11), which dominates for a fast-changing pulse;

1 (t) + G2

while the second term, i.e., the environment dissipation,
dominates for a slow-changing pulse. How to reach an
optimal trade-oﬀ between the two eﬀects will be the cen-
tral issue in the following sections. Before moving to

2

(a) The schematics of transfer setup between two
FIG. 1.
qubits coupled via a common quantum bus. (b) The schemat-
ics of transfer setup between a qubit and cavity. We assume
the higher energy levels (grey) are not populated. (c) The en-
ergy diagram of the STIRAP based state transfer. The part
in shadow corresponds to a Λ atom in the original STIRAP
protocol. The green arrow indicates the desired transfer of
the excited state of a qubit and this is realized by tuning cou-
pling G1(t) and G2(t) as STIRAP. The dissipation brings all
the excited states to the ground state. (d) The unitary time
evolution of the STIRAP can be represented by the rotation
of a spin-1 vector.

that discussion, it is worth mentioning that the unitary
part of Eq. (3) describes a fast spin precession around
(cid:126)M (t) = G(t)ˆez + ˙θ(t)ˆey, using a spin-1 language [41]. A
perfect STIRAP state transfer can be realized when G,
˙θ are constant and the transfer time is a multiple of the
precession period (see Fig. 1(d)). In the absence of dis-
sipation, there are also various other strategies to realize
a perfect state transfer [41].

the transfer ﬁdelity F =(cid:80)∞

Perturbative treatment.- A successful transfer requires
that the adiabatic dynamics plays a dominant role.
Hence the eﬀect of the non-adiabatic leakage and dissipa-
tion in Eq. (3) can be treated perturbatively. To do this,
the density matrix is expanded as ˜ρ(t) = ˜ρ(0)(t)+ ˜ρ(1)(t)+
˜ρ(2)(t) + ··· , which yields a corresponding expansion for
22 (tf ) (us-
ing the boundary condition Eq. (2)). The lowest-order
result is F (0) = 1 and the higher-order contributions are
obtained by iterative solution of the equation for ˜ρ(k)(t).
Calculation details and the expressions including dephas-
ing can be found in Ref. [41] and we report here only the
simpliﬁed ﬁnal results without dephasing. The ﬁrst-order
correction reads:

k=0 F (k) =(cid:80)∞

k=0 ˜ρ(k)

(cid:0)κ1 cos2 θ(τ ) + κ2 sin2 θ(τ )(cid:1) dτ,

(4)

F (1)= −

(cid:90) tf

0

which describes the loss of ﬁdelity via qubit decay. The
integrands has a rather transparent physical meaning:
it simply reﬂects the decay of the time-dependent dark

Cavity(a)(b)z(d)(c)Qubit 1BusQubit 2QubitBus3

dτ G(τ ),

(cid:90) tf

state Eq. (1). The next order contribution is:
F (2) (cid:39) − ˙θ(0)2

G(0)2 − ˙θ(tf)2

2 ˙θ(0) ˙θ(tf)
G(0)G(tf)

G(tf)2 +

cos

0

(5)
which is due to the non-adiabatic correction (i.e., the
leakage out of the instantaneous eigenstate |˜2 (t)(cid:105)).
It
vanishes when the system approaches the deep adiabatic
limit ˙θ(t) (cid:28) G(t). The last term has an oscillating de-
pendence with respect to tf due to the spin-1 precession
mentioned earlier. Finally, the dissipation of the quan-
tum bus only enters the 3rd order contribution

(cid:90) tf

0

(cid:90) tf

0

F (3) (cid:39) −γ

dτ

˙θ(τ )2
G(τ )2−γtf

˙θ(0) ˙θ(tf)
2G(0)G(tf)

cos

dτ G(τ ),

(6)
as the quantum bus can only be populated through
second-order non-adiabatic leakage [see Fig. 1(c)]. This
dissipation eﬀect can be suppressed by long operation
time and, not surprisingly, shows the same type of oscil-
lating behavior of the non-adiabatic correction.

Optimizing the STIRAP operation.- Based on the per-
turbative treatment, we investigate the upper bound of
the transfer ﬁdelity and the best optimization strategy.
We start with a special choice of the coupling proﬁles
known as parallel adiabatic passage (PAP) [46], where
G1(t) = G0 sin θ(t) and G2 (t) = G0 cos θ(t). PAP is
characterized by a constant energy splitting G(t) = G0
and is commonly adopted by STIRAP protocols, as it
allows one to suppress leakage errors by avoiding anti-
crossing points (see, for example, Refs. [31, 47]). Due to
the equal maximum couplings, PAP is a natural choice in
the case of identical or similar qubits, which motivates us
to take κ1 = κ2 = κ. The extension to the asymmetric
case will be discussed later.
For PAP, F (1) = −κtf and the dependence on θ(t)
˙θ(t) is the only function to optimize and it can

vanishes.
be written as a Fourier series:

˙θ (t) = α0 +

αn cos (nπt/tf ) ,

(7)

(cid:88)

n>0

where α0 = π/(2tf ) is ﬁxed by the boundary condition
Eq. (2) and αn (n > 0) represent a set of optimization
parameters. At a certain transfer time tf , optimizing ˙θ(t)
requires ∂F/∂αn = 0, which can be easily solved since
the ﬁdelity is a quadratic form of the αn. The solution
is:

αopt

n =

−π/2tf
4+(γtf−4) cos G0tf

γtf

Neven +

0

for n even,

for n odd,

(8)



i.e., to obtain the optimal ﬁdelity, the coeﬃcients of the
even terms are all equal; while the odd-n Fourier com-
ponents vanish, which is a consequence of the symmetric
setup (κ1 = κ2). In Eq. (8), Neven is the total number

FIG. 2. Parallel adiabatic passage. (a) The optimized ˙θ(t) for
Neven = 0, 1, 4 (line style from thick to thin). (b) The compar-
ison of numerically optimized ﬁdelity (data points) with the
analytical result (solid lines). The numerical optimization is
carried over tf and α1,2,3,4 (Neven = 2) while the analytical

result is ∆F = 2π(cid:112)ξ(2)/C. The agreement is excellent, ex-

cept small deviations at the larger values of κ (as expected,
due to the perturbative treatment). The three lines from bot-
tom to top corresponds to γ/G0 = 0.025, 0.1, 1. (c) Fidelity
vs. transfer time, obtained by numerical optimization over
αn (cf. Eq. (7)). Solid curves are for Neven = 0, 1, 4 (bottom
to top, also thick to thin). The horizontal dashed line indi-
cates the maximum ﬁdelity extrapolated for Neven → ∞ (see
inset). Inset: Each blue dot are numerically optimized max-
imum ﬁdelity for diﬀerent Neven and the red dot marks the
extrapolation to Neven → ∞. We have used κ/G0 = 2.5×10−3
and γ/G0 = 0.1. The improvement from a larger Neven is less
signiﬁcant than optimizing over tf .

of even-n (n > 0) Fourier terms. Some examples of the
resulting form of ˙θ(t) are shown in Fig. 2(a).
Including more optimization parameters yields a
n∈even (cid:39)
higher ﬁdelity. In the limit Neven → ∞, we get αopt
−π/ (2tf Neven) and the optimized ﬁdelity over coupling

proﬁles is F opt(tf ) = 1− κtf − π2γ/(cid:0)4G2

(cid:1), which shows

0tf

the competition between qubit decay and non-adiabatic
transition with respect to the transfer time. If we further
optimize over tf , the maximum transfer ﬁdelity is:

√
F max = 1 − 2π/

C,

(9)

f

C), and C = 4G2

√
with the corresponding optimal transfer time topt
=
0/γκ is the system cooperativity.
π/(κ
This expression provides the largest attainable ﬁdelity
when an arbitrary state is transferred with a STIRAP-
like pulse in a symmetric conﬁguration and for a given
set of parameters G0, κ and γ. Deﬁning the loss of ﬁ-
delity ∆F = 1 − F , we show in Fig. 2(b) that Eq. (9)
is in excellent agreement with the numerically optimized
ﬁdelity, even with γ ∼ G0. Thus, Eq. (9) shows that the
ultimate power of STIRAP is limited by the cooperativity
whereas the transfer by sequential swapping requires the
strong coupling condition (the ﬁdelity to swap |1(cid:105) → |2(cid:105)
followed by |2(cid:105) → |3(cid:105) is F ∼ 1− (κ + γ)/G0, thus requires
γ, κ (cid:28) G0).

0.00.20.40.60.9460.9480.9500.9521/Nevenπ/4π/2000.20.40.60.81t/tf0.840.880.920.9601020304050G00.0010.050.10.50.01ΔFdθκ/G0dtFidelity F    10-510-410-310-2(c)(a)(b)tfFmaxThe maximum ﬁdelity for a ﬁnite number of optimiza-
tion parameters can also be found as F max (Neven) = 1−

2π(cid:112)ξ (Neven) /C with ξ(Neven) ≡ (Neven +3/2)/(Neven +

4

f

√
(0) ≈ 1.22π/(κ

1) [41]. Thus, for a given setup, the goal of the ﬁdelity
(i.e., the acceptable deviation form the upper bound) de-
termines Neven, which subsequently determines the cou-
pling proﬁles and operation time. Systematic improve-
ments of the pulse shape can be gained by progressively
increasing the number Neven of optimization parameters.
It is interesting to notice that, even taking Neven = 0,
√
i.e., adopting the simple dependence θ(t) = πt/(2tf ), the
transfer ﬁdelity is F max (Neven = 0) ≈ 1 − 1.22(2π/
C)
at topt
C), which is just sightly smaller
than F max.
for a
STIRAP-based state transfer under dissipation, optimiz-
ing the operation time (i.e., the operation speed) is far
more eﬃcient than introducing a complicated pulse. This
is demonstrated in Fig. 2(c), where the maximum ﬁdelity
grows quickly with Neven and moderate values are suﬃ-
cient to achieve a small deviation from the upper bound.
We now go beyond PAP by considering generic cou-
pling proﬁles. Notice that (see Eq. (5-6)) the key vari-
able in F (2) and F (3) is ˙θ(t)/G(t), which can be similarly
decomposed in a Fourier series:

This observation suggests that,

˙θ(t)/G(t) = β0 +

βn cos (nπt/tf ) .

(10)

f

The main diﬀerence is that β0 = t−1
0 dτ ˙θ(τ )/G(τ )
cannot be ﬁxed by the boundary condition, but it is con-
strained by the maximum coupling strengths G1,max and
G2,max [41], so we can still perform the minimization with
respect to βn. The procedure closely patterns the PAP
case, for example, βopt
n∈even is given by an expression sim-
ilar to Eq. (8) except that the pre-factor π/(2tf ) is re-
0 G(τ )dτ ). The op-
timization over the pulse shape yields (Neven → ∞) [41]:

placed by β0, and cos G0tf by cos((cid:82) tf

(cid:33)

(cid:88)

n>0

(cid:32)

(cid:82) tf

FIG. 3. Transfer beyond PAP. The markers are obtained
from numerical optimizations, based on the coupling pro-
ﬁles Gi(t) = Gi,max cos[θi(t) − (2 − i)π/2], with i = 1, 2.
θi(t) is determined by optimization parameters α(i)
1,2,3,4, as
deﬁned in Eq. (7). (a) Fidelity vs. G2,max while G1,max =
G2
0/G2,max and κ1 = κ2 = κ. The three series of data are for
(γ/G0, κ/G0) = (0.2, 0.025), (0.1, 0.025), and (0.1, 0.001) (top
to bottom). The solid lines are from Eq. (12). (b) Asymmet-
ric decay rates, satisfying κ1κ2 = κ2, with (γ, κ) as in panel
(a) and G1,max = G2,max = G0. The solid lines are from
Eq. (13).

Finally, we consider a large diﬀerence in the qubit co-
herence (e.g., κ1 (cid:29) κ2). Since F (1) also depends on
θ(t) (see Eq. (4)), the previous analytic approach is not
easily applicable. Still, one can understand the general
parametric dependence by replacing the second term in
Eq. (11) with F (1) ∼ −(κ1 + κ2)tf /2. Note that large de-
viations from this estimate occur when θ(t) spends a sig-
niﬁcant fraction of the transfer time close to the initial or
ﬁnal angles θ = 0, π/2. However, this situation is essen-
tially equivalent to a shorter tf . The argument indicates
that the relevant ﬁgure of merit is the smallest coopera-
tivity Cmin =
min, where κmax = max[κ1, κ2]
and Gmin = min[G1,max, G2,max]. We ﬁnd that this con-
clusion is generally in agreement with the numerics. For
example, Fig. 3(a) shows that when G1,max = G2,max,
the maximum ﬁdelity is well approximated by:

γκmax/G2

√

,

for G1,max = G2,max,

(13)
which is in agreement with Eq. (12) when C1 = C2.
When C1 is very diﬀerent from C2, Eqs. (12) and (13)
√
diﬀer in the numerical prefactors but conﬁrm the general
argument that ∆F ∼ 1/
Cmin, for an optimized transfer
time topt

f ∼ 1/(κmax

Cmin).

√

Conclusion and Remarks.- We have analyzed the
STIRAP-based state transfer between two qubits inter-
acting with a common harmonic mode. The trade-oﬀ be-
tween the non-adiabatic transitions and dissipation needs
careful optimization of the time-dependent couplings. In-
stead of a numerical approach, we have developed an an-
alytical treatment on the general parameter dependence,
which has allowed us to reach a physical understanding
of the optimal transfer time and the upper bound of the

(cid:18)(cid:114) 2

(cid:114) 2

(cid:19)

+

C1

C2

F opt(tf ) = 1 − κtf − γ
tf

1

G2

1,max

+

1

G2

2,max

. (11)

F max (cid:39) 1 − 2

Further optimizing over tf leads to:

(cid:114) 1

F max = 1 − 4

+

1
C2

,

for κ1 = κ2,

(12)

C1

√

where we indicate with Ci = 4G2
i,max/γκi the coopera-
tivity of side i = 1, 2. In the limit C1 = C2 = C, this
result allows for a slightly larger ﬁdelity than Eq. (9)
2/(2π) (cid:39) 0.9). This can be attributed to the fact
(4
that here G(t) is not kept constant. Equation (12) also
shows that in the limit when C1 and C2 are very diﬀer-
ent, the less coherent system (with lower Ci) dominates
the ﬁdelity loss.
In Fig. 3(a) we compare our analytic
expression to the numerical optimization, and show that
Eq. (12) is indeed an accurate characterization of the
maximum ﬁdelity.

ﬁdelity. We also showed how to reach this bound eﬃ-
ciently. Our results provide a useful guideline for im-
plementations of such protocol in a variety of physical
systems, as well as generalizations to alternative setups
and more complicated adiabatic transfer schemes.

YDW and SC acknowledge the support from Chinese
Youth 1000 Talents Program. YDW also acknowledges
the NSFC grants (No. 11574330 and No. 11434011). SC
acknowledges the NSFC grant (No. 11574025). XBY
is supported by China Postdoctoral Science Foundation
(Grant No. 2015M571136). YDW also thank A. A. Clerk
and H. Ribeiro for discussions at the early stage of this
work.

∗ yingdan.wang@itp.ac.cn
† stefano.chesi@csrc.ac.cn
[1] U. Gaubatz, P. Rudecki,

S. Schiemann,
K. Bergmann, J. Chem. Phys. 92, 5363 (1990).

and

[2] K. Bergmann, H. Theuer, and B. W. Shore, Rev. Mod.

Phys. 70, 1003 (1998).

5

(2008).

[21] D. Møller, L. B. Madsen, and K. Mølmer, Phys. Rev.

Lett. 100, 170504 (2008).

[22] Y.-D. Wang and A. A. Clerk, Phys. Rev. Lett. 108,

153603 (2012).

[23] Y.-D. Wang and A. A. Clerk, New J. Phys. 14, 405010

(2012).

[24] S. C. Webster, S. Weidt, K. Lake, J. J. McLoughlin, and
W. K. Hensinger, Phys. Rev. Lett. 111, 140501 (2013).
[25] T. S. Koh, S. N. Coppersmith, and F. Mark, PNAS 110,

19695 (2013).

[26] D. A. Golter and H. Wang, Phys. Rev. Lett. 112, 116403

(2014).

[27] N. Trautmann, G. Alber, G. S. Agarwal, and G. Leuchs,

Phys. Rev. Lett. 114, 173601 (2015).

[28] M. Dupont-Nivet, M. Casiulis, T. Laudat, C. I. West-
brook, and S. Schwartz, Phys. Rev. A 91, 053420 (2015).
[29] R. Andrews, R. W. Peterson, T. P. Purdy, K. Cicak,
R. W. Simmonds, C. A. Regal, and K. W. Lehnert, Nat
Phys , DOI:10.1038/nphys2911 (2014).

[30] Y. Tabuchi, S. Ishino, A. Noguchi, T. Ishikawa, R. Ya-
mazaki, K. Usami, and Y. Nakamura, Science 349, 405
(2006).

[31] G. S. Vasilev, A. Kuhn, and N. V. Vitanov, Phys. Rev.

A 80, 013417 (2009).

[3] N. V. Vitanov, B. W. S. T. Halfmann, and K. Bergmann,

[32] P. A. Ivanov, N. V. Vitanov, and K. Bergmann, Phys.

Annu. Rev. Phys. Chem. 52, 763 (2001).

Rev. A 72, 053412 (2005).

[4] P. Kr´al, I. Thanopulos, and M. Shapiro, Rev. Mod. Phys.

[33] H. Yuan, C. P. Koch, P. Salamon, and D. J. Tannor,

79, 53 (2007).

Phys. Rev. A 85, 033417 (2012).

[5] I. R. Sol´a, V. S. Malinovsky, and D. J. Tannor, Phys.

[34] M. Scala, B. Militello, A. Messina, and N. V. Vitanov,

Rev. A 60, 3081 (1999).

[6] G. G. Grigoryan, G. V. Nikoghosyan, T. Halfmann, Y. T.
Pashayan-Leroy, C. Leroy, and S. Gu´erin, Phys. Rev. A
80, 033402 (2009).

[7] B. T. Torosov and N. V. Vitanov, Phys. Rev. A 87,

043418 (2013).

Phys. Rev. A 81, 053847 (2010).

[35] H. Goto and K. Ichimura, Phys. Rev. A 77, 013816

(2008).

[36] A. D. Greentree, J. H. Cole, A. R. Hamilton, and L. C. L.

Hollenberg, Phys. Rev. B 70, 235317 (2004).

[37] N. Vogt, J. H. Cole, M. Marthaler, and G. Sch¨on, Phys.

[8] P. G. Di Stefano, E. Paladino, A. D’Arrigo, and G. Falci,

Rev. B 85, 174515 (2012).

Phys. Rev. B 91, 224506 (2015).

[38] Q. Z. Hou, W. L. Yang, M. Feng, and C.-Y. Chen, Phys.

[9] M. Weitz, B. C. Young, and S. Chu, Phys. Rev. Lett.

Rev. A 88, 013807 (2013).

73, 2563 (1994).

[10] S. Kulin, B. Saubamea, E. Peik, J. Lawall, T. W. Hij-
mans, M. Leduc, and C. Cohen-Tannoudji, Phys. Rev.
Lett. 78, 4185 (1997).

[11] L.-M. Duan, J. I. Cirac, and P. Zoller, Science 292, 1695

(2001).

[12] A. Kuhn, M. Hennrich, and G. Rempe, Phys. Rev. Lett.

89, 067901 (2002).

[39] M. Aspelmeyer, T. J. Kippenberg, and F. Marquardt,

Rev. Mod. Phys. 86, 1391 (2014).

[40] Z.-L. Xiang, S. Ashhab, J. Q. You, and F. Nori, Rev.

Mod. Phys. 85, 623 (2013).

[41] See the Supplemental Information for details on an ex-
act solution of the unitary dynamics, the perturbative
treatment, and the upper bound with unequal couplings.
[42] S. Chesi, L.-P. Yang, and D. Loss, Phys. Rev. Lett. 116,

[13] S. Oh, Y.-P. Shim, J. Fei, M. Friesen, and X. Hu, Phys.

066806 (2016).

Rev. A 87, 022332 (2013).

[14] M. M¨ucke, J. Bochmann, C. Hahn, A. Neuzner,
C. N¨olleke, A. Reiserer, G. Rempe, and S. Ritter, Phys.
Rev. A 87, 063805 (2013).

[15] D. Petrosyan and K. Mølmer, Phys. Rev. A 87, 033416

(2013).

[43] F. R. Braakman, P. Barthelemy, C. Reichl, W. Wegschei-
der, and L. M. K. Vandersypen, Nature Nano. 8 (2013).
[44] K. Stannigel, P. Rabl, A. S. Sørensen, P. Zoller, and

M. D. Lukin, Phys. Rev. Lett. 105, 220501 (2010).

[45] K. Stannigel, P. Rabl, A. S. Sørensen, M. D. Lukin, and

P. Zoller, Phys. Rev. A 84, 042341 (2011).

[16] P. D. Drummond, K. V. Kheruntsyan, D. J. Heinzen,

[46] G. Dridi, S. Gu´erin, V. Hakobyan, H. R. Jauslin, and

and R. H. Wynar, Phys. Rev. A 65, 063619 (2002).

H. Eleuch, Phys. Rev. A 80, 043408 (2009).

[17] H. Y. Ling, H. Pu, and B. Seaman, Phys. Rev. Lett. 93,

[47] S. Gu´erin, S. Thomas, and H. R. Jauslin, Phys. Rev. A

250403 (2004).

65, 023409 (2002).

[18] C. P. Sun, Y. Li, and X. F. Liu, Phys. Rev. Lett. 91,

147903 (2003).

[19] J. Klein, F. Beil, and T. Halfmann, Phys. Rev. Lett. 99,

113003 (2007).

[20] F. Lang, K. Winkler, C. Strauss, R. Grimm,

and
J. Hecker Denschlag, Phys. Rev. Lett. 101, 133005

Supplemental material for “Optimization of STIRAP-based state transfer under

dissipation”

1

UNITARY DYNAMICS AND TRANSFER FIDELITY

We discuss brieﬂy here a simple optimization of the ﬁdelity based on an exact solution of the unitary dynamics,

and compare the STIRAP scheme with other types of state-transfer protocols.

First we consider Eq. (3) of the main text and note that the ﬁrst two terms on the right side yield an eﬀective

Hamiltonian

˜H + i

˙θ(t)√
2

µ = G(t)Jz + ˙θ(t)Jy ≡ (cid:126)M (t) · (cid:126)J,

(S1)

where we map |˜1(cid:105),|˜2(cid:105),|˜3(cid:105) to the spin-1 angular momentum states (| + 1(cid:105),|0(cid:105),| − 1(cid:105), respectively). As seen, the time
evoultion is equivalent to the rotation of a spin in a time-dependent magnetic ﬁeld (see Fig. 1(d) in the main text).
For a coupling proﬁle of the simple sin-cos form:

G1(t) = G0 sin(πt/2tf ), G2(t) = G0 cos(πt/2tf ),

(S2)

the magnetic ﬁeld is constant and tilted from the z direction by an angle φ = arctan[π/(2G0tf )]. Since the initial
state is an eigenstate of Jz (i.e., is not aligned to (cid:126)M ), an oscillatory dynamics follows, with angular frequency given

by | (cid:126)M| =(cid:112)G2

0 + (π/2tf )2. The exact solution for the ﬁdelity is:

(cid:32)

(G0tf )2 + (π/2)2 cos(cid:112)(G0tf )2 + (π/2)2

(cid:33)2

.

F =

(S3)

(G0tf )2 + (π/2)2

tf ∼ 1/G0, a perfect transfer is possible at the discrete values G0tf = 2π(cid:112)n2 − (1/4)2 (n = 1, 2, . . .). Such a condition

Besides recovering F → 1 in the adiabatic limit tf (cid:29) 1/G0, we also notice that, even for a much shorter operation time

can be matched by tuning the transfer time tf or the coupling strength G0. Physically, these times correspond to the
periodic return of the state to the z direction.

It is certainly not surprising that an ideal state transfer can be realized in the absence of dissipation. In fact, more
eﬃcient and natural ways exist. Among these, we would like to mention the well-known sequential swapping, where a
constant value of G1 (with G2 = 0) transfers |1(cid:105) → |2(cid:105) and then a second swap leads to |2(cid:105) → |3(cid:105). The total transfer
time is π/G0 (if both coupling strengths are equal: G1 = G2 = G0), which is slightly shorter than the minimum

transfer time 2π(cid:112)1 − (π/4)2/G0 (cid:39) 1.2π/G0 implied by Eq. (S3). Another way which is operationally simplest is

√
to set both couplings to a constant G0 and let the system evolve for a time π/
corresponds to a π-rotation around the x axis.

2G0, which in the spin-1 language

Nevertheless, the choice Eq. (S2) is interesting in the context of the present discussion. On one hand, it shows that a
STIRAP-like time-dependence of the couplings still allows for a perfect state transfer deep in the non-adiabatic regime
(i.e., with tf ∼ 1/G0). On the other hand, this exact solution can serve as a useful reference for our discussion of the
general case, including dissipation and more complicated choice for θ(t). In fact, we can use the solution Eq. (S3)
to estimate the ﬁdelity loss due to the decay of the intermediate system: Without dissipation, the population of the
excited quantum bus due to the unitary time evolution is:

(cid:104)2|ρI (t)|2(cid:105) =

(cid:16)

t(cid:112)G2

1 − cos

0 + (π/2tf )2

(G0tf )2 + (π/2)2

(cid:17)

2

 πG0tf
(cid:90) tf

2

γ

0

(cid:104)2|ρI|2(cid:105)dt (cid:39) 3π2γ
8G2
0tf

.

The population loss through the bus is approximately:

.

(S4)

(S5)

As discussed in the main text, this result is in agreement with the perturbative calculation. Combining this result
with the cavity damping κtf , one can optimize the transfer time and ﬁnd the ﬁdelity F max(Neven = 0) = 1 − 1.22 2π√
.
C
Thus, this simple example allows one to understand the relevant physics and typical time scales characterizing the
state transfer process, while further optimization of θ(t) leads to a modest improvement of the ﬁdelity.

2

(cid:110)|˜k(t)(cid:105)(cid:111)

PERTURBATIVE SOLUTION OF THE MASTER EQUATION

We present here the details of the perturbative treatment, which are too cumbersome to include in the main text.
, which is
The perturbative expansion is most conveniently carried out in the instantaneous eigenbasis

related to the time-independent basis {|k(t)(cid:105)} as follows:

(sin θ(t)|1(cid:105) + |2(cid:105) + cos θ(t)|3(cid:105)) ,

1√
2

(cid:12)(cid:12)˜1(t)(cid:11) =
(cid:12)(cid:12)˜2(t)(cid:11) = − cos θ(t)|1(cid:105) + sin θ(t)|3(cid:105) ,
(cid:12)(cid:12)˜3(t)(cid:11) =
(cid:110)|˜k(t)(cid:105)(cid:111)

1√
2

while |˜4(t)(cid:105) = |4(cid:105). As deﬁned in the main text, the original 4-level subspace is |1(cid:105) =(cid:12)(cid:12)e(1), 0, 0(2)(cid:11), |2(cid:105) =(cid:12)(cid:12)g(1), 1, 0(2)(cid:11),
|3(cid:105) =(cid:12)(cid:12)g(1), 0, 1(2)(cid:11), |4(cid:105) =(cid:12)(cid:12)g(1), 0, 0(2)(cid:11), while the angle θ(t) is given by tan θ(t) = G1(t)/G2(t).

(− sin θ(t)|1(cid:105) + |2(cid:105) − cos θ(t)|3(cid:105)) ,

(S6)

In the reference frame deﬁned by

, we write the density matrix as ˜ρ(t) = ˜ρ(0)(t) + ˜ρ(1)(t) + ˜ρ(2)(t) + ··· ,

where the lowest-order satisﬁes:

˜ρ(0)(t) = −i

d
dt

(cid:104) ˜H(t), ˜ρ(0)(t)

(cid:105)

.

(S7)

The solution is simply ˜ρ(0)
satisfy:

ab (t) = δa,2δb,2, if the qubit 1 is initially in the excited state. The higher-order contributions

(cid:104) ˜H(t), ˜ρ(k)(t)
(cid:105)

(cid:104)

+

˙θ(t)√
2

d˜ρ(k)(t)

dt

= −i

(cid:105)

µ, ˜ρ(k−1)(t)

+ ˜L˜ρ(k−1)(t),

(S8)

where the non-adiabatic term in matrix form is (for simplicity, we omit the explicit time dependence, i.e. ˜ρ = ˜ρ(t))

(S9)

(S10)

(S11)

The full expression of the dissipator is too cumbersome to present here. We only show the contribution from the
quantum bus:

˙θ√
2

[µ, ˜ρ] = ˙θ

√
2Re˜ρ12
˜ρ22− ˜ρ11+ ˜ρ31
√

2

˜ρ32− ˜ρ21√

2
0


 ˜ρ11+Re ˜ρ13

˜ρ21+ ˜ρ23

2

4

4
0

˜ρ11+ ˜ρ33+2 ˜ρ31

˜Lm ˜ρ = −γ

√

2

√

˜ρ23− ˜ρ12√
˜ρ22− ˜ρ11+ ˜ρ13
2Re (˜ρ23 − ˜ρ12) ˜ρ33− ˜ρ22− ˜ρ13
−√
˜ρ33− ˜ρ22− ˜ρ31

2

2

√

0
0
2Re˜ρ23 0
0
0

√
2
0

 .

˜ρ12+ ˜ρ32

˜ρ11+ ˜ρ33+2 ˜ρ13

4
0

˜ρ12+ ˜ρ32

4
0

4

˜ρ21+ ˜ρ23

4

˜ρ33+Re ˜ρ13

2
0

0
0
0
− ˜ρ11+ ˜ρ33

2

− Re˜ρ13

 ,
(cid:16) ˜L˜ρ
(cid:17)

which is independent on ˜ρ22. Since at zero order ˜ρ(0)
proportional to γ. To evaluate the ﬁrst-order correction to the ﬁdelity, the full expression of

ij = δi,2δj,2, Eq. (S10) shows that ˜ρ(1)(t) has no contribution

is necessary:

22

(cid:16) ˜L˜ρ
(cid:17)

22

= −(cid:0)κ1 cos2 θ + κ2 sin2 θ + ¯γϕ sin2 2θ(cid:1) ˜ρ22 +
(cid:17)

(˜ρ12 − ˜ρ23 + c.c.) sin 4θ +

√
− ¯γϕ
2

¯γϕ
2

2

(cid:16)

γ(1)
ϕ + γ(2)
ϕ

where ¯γϕ =

/2.

κ1 − κ2
2
4

√

(˜ρ12 − ˜ρ23 + c.c.) sin 2θ

(˜ρ11 + ˜ρ33 − ˜ρ13 − ˜ρ31) sin2 2θ,

Equation (S8) can be solved iteratively, to yield the perturbative expansion of the transfer ﬁdelity F = ˜ρ22(tf ). In

particular, integrating Eq. (S8) gives:

dτ e−i(cid:82) t

τ ∆Eab(t(cid:48))dt(cid:48)

˜ρ(k)
ab (t) =

(cid:90) t

0

(cid:32) ˙θ(t)√

2

(cid:33)

ξ(k−1)

ab

(τ ) + L(k−1)

ab

(τ )

,

(S12)

where ξ(k−1)(τ ) ≡ [µ,˜ρ(k−1)(τ )], L(k−1)
δa,3). Equation (S12), together with Eq. (S11), yields the 1st order correction:

ab

3
(τ ) ≡ ( ˜L˜ρ(k−1)(τ ))ab, and ∆Eab(t) = Ea(t) − Eb(t), with Ea(t) = G(t)(δa,1 −

(cid:90) tf

0

F (1)= −

(cid:0)κ1 cos2 θ(t(cid:48)) + κ2 sin2 θ(t(cid:48)) + ¯γϕ sin2 2θ(t(cid:48))(cid:1) dt(cid:48).

(S13)

This represents a generalization of Eq. (4) of the main text (where we assumed ¯γϕ = 0).
At 2nd-order the disspation of the bus does not contribute to the ﬁdelity either, because [ ˜Lm ˜ρ]22 is identically zero
[see Eq. (S10)]. This observation, together with the independence of ˜Lm ˜ρ on ˜ρ22, reﬂects the fact that |˜2(cid:105) does not
involve excitations of the bus (it is a dark state). Thus, the population ˜ρ22 is not directly aﬀected by a ﬁnite γ and
˜ρ22 has no inﬂuence on ˜Lm ˜ρ. The second order correction can be written as:

(cid:90) tf

(cid:90) t(cid:48)

F (2) (cid:39) −2

dt(cid:48) ˙θ(t(cid:48))

dt(cid:48)(cid:48) ˙θ(t(cid:48)(cid:48)) cos

0

0

(cid:35)

(cid:34)(cid:90) t(cid:48)

t(cid:48)(cid:48)

dτ G(τ )

,

(S14)

which takes into account the corruption of ﬁdelity due to purely non-adiabatic leakage. While a full calculation of the
2nd-order result should take into account the qubits dissipation, these corrections are neglected here. This is due to
the fact that the qubit dissipation already enters the 1st-order result and higher order terms involving κi, γ(i)
ϕ should
be much smaller.

We then consider the 3rd order correction, which ﬁnally yields a contribution proportional to γ. As illustrated
schematically by Fig. 1(c) of the main text, the loss of ﬁdelity via the mechanical damping is through the non-adiabatic
leakage. This is also clear from Eqs. (S9) and (S10). Consider, for example, that at 1st order the non-adiabatic leakage
12 ∝ ˙θ. At 2nd order, this correction gives a contribution to ˜ρ(2)
12 ∝ ˙θγ (cf. Eq. (S10)). Finally,
leads to a ﬁnite value ˜ρ(1)
(cid:18)(cid:90) t2
the non-adiabatic terms leads to a correction to ˜ρ22 from ˜ρ(2)

22 ∝ ˙θ2γ. The full expression reads:

12 (cf. Eq. (S9)) ˜ρ(3)

(cid:90) t1

(cid:90) tf

(cid:19)

dt2 sin

dτ G(τ )

dt3

˙θ(t3) sin

dτ G(τ )

.

(S15)

F (3) (cid:39) −γ

dt1

˙θ(t1)

0

0

t3

are given by integrals of the form (cid:82) t
(cid:104)±i(cid:82) t(cid:48)

(cid:105)

The above formulas for F (2) and F (3) can be simpliﬁed in the relevant case of a suﬃciently large G(τ ). In fact, they
, where f (t(cid:48)) is a relatively smooth function while

0 dt(cid:48)f (t(cid:48)) exp

0 dτ G(τ )

0 dτ G(τ )

exp
is a fast oscillating factor. By performing multiple integrations by parts, a systematic expansion
of such integrals in powers of G(t)−1 can be derived. A straightforward but tedious calculation yields the leading-order
results, cited in Eqs. (5) and (6) of the main text.

(cid:18)(cid:90) t1
(cid:104)±i(cid:82) t(cid:48)

t2

(cid:19)(cid:90) t2
(cid:105)

0

MAXIMUM FIDELITY WITH UNEQUAL COUPLINGS

In the PAP case, the discussion is based on equal maximum couplings and equal damping rates for both qubits.

Here we relax the constrain of equal maximum couplings and investigate again the upper bound of the ﬁdelity.

is that not only ˙θ(t)/G(t), but also cos(cid:82) tf
not immediately clear how the condition G(t) ≤ Gmax(θ(t)) (together with the old one, (cid:82) tf
βn>0 and cos(cid:82) tf

To do this, we write ˙θ(t)/G(t) into a Fourier expansions with βn the new set of optimization parameters (see Eq. (10)
in the main text). This makes the optimization very similar to the PAP case, except two diﬃculties. The ﬁrst one
0 G(τ )dτ is aﬀected by the coupling proﬁles (while in the PAP case this
gives a simple constant, cos G0tf ). The second complication is that ˙θ(t)/G(t) must satisfy more involved constrains
than ˙θ(t). In fact, at each value of θ(t) the coupling G has a maximum value Gmax(θ) [see Eq. (S23) below]. It is
˙θ(τ )dτ = π/2) can be
simply written in terms of the βn. To avoid these diﬃculties, we ﬁrst perform the maximization by considering the
0 G(τ )dτ as arbitrary parameters. This approach is useful because removing these constrains gives an
upper bound to the ﬁdelity, at ﬁxed β0. Furthermore, in performing the calculation, we will also see how the above
two points can be resolved.

0

F can be written as a quadratic form of the βn since

˙θ(0)
G(0)

= β0 +

βn,

˙θ(tf )
G(tf )

= β0 +

(−1)nβn,

and

n>0

0

dτ

˙θ(τ )2
G(τ )2 = β2

0 tf +

tf
2

β2
n.

(S16)

(cid:88)

n>0

(cid:88)

(cid:90) tf

(cid:88)

n>0

4

(S17)

− γtf βn = 0,

n=2,4... βn = Nevenβopt

even. Thus the

(cid:21)
(cid:90) tf
even and (cid:80)

G(τ )dτ

0

.

(S18)

0 G(τ )dτ

odd = 0. The ﬁdelity optimized over the coupling proﬁles reads:

4Neven + γtf + Neven(γtf − 4) cos(cid:82) tf

γtf

0 G(τ )dτ

(cid:19)

.

(S19)

For even n > 0, the maximization gives:

(cid:32)

(cid:88)

(cid:33)(cid:20)

1 −

(cid:18)

βn

(cid:19)

cos

1 − γtf
4

n=2,4...

= −4

∂F
∂βn

β0 +

0 G(τ )dτ

4 + (γtf − 4) cos(cid:82) tf

showing that the optimized value of βn is independent of n: βn = βopt
analog of Eq. (8) of the main text can be obtained easily

even = −β0
βopt

Fopt(β0, tf ) ≤ 1 − κtf − β2

In a similar way, one can show that βopt

(4Neven + γtf ) + Neven(γtf − 4) cos(cid:82) tf
(cid:18)
Neven → ∞. In this case, the factor cos(cid:82) tf
Thus, the speciﬁc value of cos(cid:82) tf

Fopt(β0, tf ) ≤ 1 − κtf − β2

2Neven + 1 −

2Neven

0 γtf .

γtf

0

the limit Neven → ∞, we also have βopt

even (cid:39) −β0/Neven and
˙θ(t)
G(t)

(cid:32)
1 − Neven(cid:88)

(cid:39) β0

m=1

cos (2mπt/tf )

Neven

(cid:33)

Since Fopt(tf ) is (as expected) a monotonic function of Neven, the largest value is obtained by taking the limit

0 G(τ )dτ drops out of the ﬁnal expressions:

0 G(τ )dτ is not important for the upper bound and the ﬁrst diﬃculty is resolved. In

(S20)

≡ β0f (t).

(S21)

To take into account the constrain on G(t) and further optimize the ﬁdelity, we ﬁnd now the lower bound of β0.
Since ˙θ(t) = β0G(t)f (t), with G(t) and f (t) both positive, ˙θ(t) has a well-deﬁned sign (i.e., the same sign of β0). We
take ˙θ(t) > 0 and use the deﬁnition of β0:

(cid:90) tf

0

(cid:90) tf

β0 =

1
tf

˙θ(τ )
G(τ )

dτ ≥ 1
tf

˙θ(τ )

Gmax(θ(τ ))

0

dτ,

(S22)

where Gmax(θ) is the maximum achievable coupling at a given value of the angle θ = arctan(G1/G2). If ¯θ is the angle
with both couplings maximized (i.e., ¯θ = arctan(G1,max/G2,max)), Gmax(θ) is given by:

 G2,max

G1,max

cos θ

sin θ

if 0 ≤ θ ≤ ¯θ,
if ¯θ < θ ≤ π
2 ,

Gmax(θ) =

which allows us to rewrite Eq. (S22) as:

β0 ≥ 1
tf

(cid:90) ¯t

0

cos θ(τ ) ˙θ(τ )

G2,max

dτ +

1
tf

sin θ(τ ) ˙θ(τ )

¯t

G1,max

(S23)

dτ.

(S24)

We supposed here that there is a single solution of θ(¯t) = ¯θ, but the argument is easily adapted to multiple solutions.
The integration of Eq. (S24) is immediate and, using the boundary conditions θ(0) = 0, θ(tf ) = π/2, as well as
elementary trigonometric relations to express sin ¯θ, cos ¯θ in terms of the Gi,max, we get:

(cid:90) tf

(cid:115)

β0 ≥ sin ¯θ
tf G2,max

+

cos ¯θ

tf G1,max

Using this inequality in Eq. (S20) gives:

Fopt(tf ) ≤ 1 − κtf − γ
tf

=

(cid:32)

1
tf

1

G2

1,max

+

1

G2

2,max

.

(cid:33)

,

1

G2

1,max

+

1

G2

2,max

(S25)

(S26)

5

which is the Eq. (11) of the main text (taking the equality sign).

It is also interesting to consider in more detail the properties of ˙θ(t)/G(t), which allows one to understand better
how the minimization is achieved, and leads to a slightly diﬀerent (and perhaps more transparent) derivation of
Eq. (S26). First we notice, using Eq. (S21):

˙θ(0)
G(0)

=

˙θ(tf )
G(tf )

(cid:39) β0

(cid:32)
1 − Neven(cid:88)

m=1

(cid:33)

1

Neven

= 0,

(S27)

showing that F (2) (the non-adiabetic contribution) vanishes for the optimal coupling proﬁles (see Eq. (5) of the main
text). By taking ˙θ(0) = ˙θ(tf ) = 0, the general formula for F is simpliﬁed to:

F| ˙θ(0)= ˙θ(tf )=0 = 1 − κtf − γ

dτ

˙θ(τ )2
G(τ )2 .

(S28)

If we consider intermediate times ∆t < t < tf − ∆t (with ∆t ∼ tf /Neven), it is easy to see that the summation in
Eq. (S21) gives a small value and ˙θ(t)/G(t) (cid:39) β0. Using this constant in the integral of Eq. (S28), Fopt(β0, tf ) of
Eq. (S20) is immediately recovered.

This analysis arrives at a simple charactrerization of the optimum pulse: we should choose θ(t) to satisfy ˙θ(0) =
˙θ(tf ) = 0 and, for intermediate times, try to minimize the integral in Eq. (S28). Thus, we can rederive Eq. (S26) by
relying directly on the minimizion of Eq. (S28), and without using the Fourier decompostion. Clearly, we have

(cid:90) tf

0

(cid:90) tf

0

dτ

(cid:90) tf
(cid:18) d sin θ(τ )

˙θ(τ )2
G(τ )2 ≥
(cid:19)2

0

dτ +

dτ

˙θ(τ )2

Gmax(θ(τ ))2 ,

(S29)

(cid:90) tf

(cid:18) d cos θ(τ )

(cid:19)2

1

G2

1,max

¯t

dτ

dτ.

(S30)

which, using Eq. (S23) is written:

1

(cid:90) ¯t

G2

2,max

0

dτ

The two integrals are minimized when their integrands are constant, i.e., we can set d sin θ(τ )/dτ = (sin ¯θ)/¯t and
d cos θ(τ )/dτ = (cos ¯θ)/(¯t − tf ). We conclude that Eq. (S30) is larger or equal to:

(cid:18) sin ¯θ

(cid:19)2

G2,max

1
¯t

+

1
tf − ¯t

(cid:18) cos ¯θ

G1,max

(cid:19)2 ≥ 1

tf

(cid:32)

(cid:33)

1

G2

1,max

+

1

G2

2,max

,

(S31)

where in the last step we used the deﬁnition of ¯θ and performed the minimization with respect to ¯t, giving ¯t = tf (sin ¯θ)2.
Equation (S31) is the desired result, in agreement with Eq. (S26). This derivation also shows explicitly that it is
possible to ﬁnd a suitable time-dependence of ˙θ(t)/G(t) approaching the equality sign in Eq. (S26).

