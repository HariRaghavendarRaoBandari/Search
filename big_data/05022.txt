6
1
0
2

 
r
a

 

M
6
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
2
2
0
5
0

.

3
0
6
1
:
v
i
X
r
a

Reliability of the time splitting Fourier method

for singular solutions in quantum ﬂuids

M. Caliaria,∗, S. Zucchera

aDepartment of Computer Science, University of Verona, Strada Le Grazie 15,

37134 Verona, Italy

Abstract

We extensively study the numerical accuracy of the well-known time splitting
Fourier spectral method for the approximation of singular solutions of the Gross–
Pitaevskii equation.
In particular, we explore its capability of preserving a
steady-state vortex solution, whose density proﬁle is approximated by a very
accurate diagonal Pad´e expansion of order 8, here explicitly derived for the ﬁrst
time. Although the Fourier spectral method turns out to be only slightly more
accurate than a time splitting ﬁnite diﬀerence scheme, the former is reliable and
eﬃcient. Moreover, at a post-processing stage, it allows an accurate evaluation
of the solution outside grid points, thus becoming particularly appealing when
high resolution is needed, such as in the study of quantum vortex interactions.

Keywords: Quantum ﬂuids, nonuniform ﬁnite diﬀerences, time splitting,
Fourier spectral method

1. Introduction

Quantum turbulence [1–3], as well as classical turbulence [4, 5], is domi-
nated by reconnection of vortical structures which is much simpler to treat in
the framework of quantum ﬂuids rather than in viscous ﬂuids [6], while lead-
ing to similar features such as time asymmetry [7]. Despite the fundamental
diﬀerences between the two forms of turbulence, there are reasons to believe
that the understanding of quantum turbulence might shed new light on the
understanding of its classical counterpart [3].

Quantum ﬂuids dynamics is properly described by the Gross–Pitaevskii

equation (GPE) [8, 9]

∂ψ
∂t

=

i
2∇2ψ +

i

2 (cid:16)1 − |ψ|2(cid:17) ψ,

(1)

where ψ is the complex wave function. Through the Madelung transformation
ψ = √ρ exp(iθ), equation (1) can be viewed in classical ﬂuid dynamical terms

∗Corresponding author

Preprint submitted to Elsevier

March 17, 2016

as

∂ρ
∂t

+

= 0,

∂p
∂xi

+

∂τij
∂xj

,

(2)

(3)

∂(ρuj)

∂xj
∂ui

ρ(cid:18) ∂ui

∂t

+ uj

∂uj(cid:19) = −

where ρ = |ψ|2 denotes density, u = ∇θ velocity, p = ρ2
4 pressure, and
τij = 1
the so-called quantum stress (i, j = 1, 2, 3). Defects in the
wave function ψ are interpreted as inﬁnitesimally thin vortices of constant cir-

4 ρ ∂ 2 ln ρ

∂xi∂xj

culation Γ = H u · ds = 2π, with healing length ξ = 1. GPE conserves the mass

and the energy

E =

1

2 Z |∇ψ|2 dx +

1

4 Z (1 − |ψ|2)2 dx.

(4)

The main reason for preferring the GPE approach to others for the study
of quantum turbulence is that it guarantees a natural dynamics of interacting
vortices [10] while resolving ﬁne scales up to the vortex core [3, 11]. On the
contrary, methods based on the inviscid Euler equations (either their direct
numerical simulation [12] or vortex ﬁlament methods [13]) are unable to auto-
matically perform vortex reconnections, being forbidden by Euler dynamics.

The numerical solution of the GPE (1) is normally carried out by employing
time splitting Fourier methods [7, 10, 14, 15] and by imposing vortices in the
form of singular phase defects in a unitary background density, i.e. ρ(x) =
|ψ(x)|2 → 1 when |x| → ∞. However, these methods assume periodic boundary
conditions. Solutions which are not periodic must be mirrored in the directions
lacking periodicity [14], thus imposing doubling of the degrees of freedom in
each of those directions and a consequent increase of the computational eﬀort.
Recent developments [10, 16] have shown that reconnections in quantum
ﬂuids are strictly related to topological features characterizing the interacting
vortex tubes such as writhe, total torsion and intrinsic twist. These quantities
depend on the ﬁne details of the curve that describes the vortex centerline (its
third derivative with respect to the curvilinear abscissa is required for comput-
ing torsion) and on the phase of the wavefunction ψ in the neighborhood of the
vortex centerline. Therefore it is paramount to resort to high resolution numer-
ical simulations of equation (1), especially in the proximity of the reconnection
event.

With the goal of assessing the goodness of time-splitting Fourier methods
for singular solutions on uniform grids versus time-splitting ﬁnite diﬀerences on
nonuniform grids, we ﬁrst derive an analytic approximation of a two-dimensional
steady state vortex that nulliﬁes the right-hand-side of (1). Then we perform a
systematic comparison between the two approaches by measuring the deviation
of the numerical solution from the initial condition (being steady the initial
condition should remain preserved). Finally, we explore the possibility to eval-
uate the solution obtained by time-splitting Fourier methods on nonuniform

2

grids designed to guarantee higher spatial resolution in the proximity of vortex
singularities.

2. Accurate Pad´e approximation of a 2d vortex

1 + x2

We seek a two-dimensional, steady-state solution of equation (1) that rep-
resents a straight vortex centered at the origin.
It is well-known that the
classical two-dimensional Euler vortex of circulation Γ has azimuthal veloc-
ity uθ = Γ/(2πr) where r = px2
2 is the radius and θ = atan2(x2, x1) =
arg(x1 +ix2) ∈ (−π, π] is the azimuthal angle. The Cartesian components of the
velocity are thus u1 = −uθ sin θ = −Γx2/(2πr2) and u2 = uθ cos θ = Γx1/r2.
Therefore u = (u1, u2) = (Γ/(2π))∇θ. This shows that the velocity ﬁeld is
solenoidal (∇ · u = 0), that the quantum mechanical phase, S, is simply the
azimuthal angle θ, and that the quantum of circulation, in our dimensionless
units, is equal to 2π. In steady conditions, the continuity equation ensures that
∇ · (ρu) = 0, hence u · ∇ρ = 0, which means that ∇ρ · ∇θ = 0. The solution
ρ = ¯ρ = const leads to ψ = √¯ρeiθ, which has inﬁnite energy (4) and must
be rejected. The other possibility is that ∇ρ ⊥ ∇θ. Since ∇θ = ˆθ/r, then
∇ρ is parallel to ˆr and thus ρ = ρ(r), ˆr and ˆθ being the unitary vectors in
two-dimensional polar coordinates.

In a two-dimensional domain we set ψ(x1, x2) = ρ(px2
1 + x2

2)1/2eiθ(x1,x2) =
2) = f (r) is a function to be deter-
mined. By imposing that ψ is the steady solution of equation (1), we ﬁnd that
f satisﬁes the equation

2)eiθ(x1,x2), where f (px2

f (px2

1 + x2

1 + x2

f ′
r

1

f ′′ +

+ f (cid:18)1 − f 2 −
with boundary conditions f (0) = 0, f (∞) = 1.
Equation (5) could be integrated numerically as it is, by artiﬁcially bounding
the inﬁnite domain. To avoid this problem, we resort to the change of variables
s = r/(1 + r), g(s) = f (r), which yields the equation for g(s)

r2(cid:19) = 0,

(5)

(s − 1)4g′′ + 2(s − 1)3g′ −

(s − 1)3

s

g′ −

(s − 1)2

s2

g + (1 − g2)g = 0,

(6)

deﬁned in the ﬁnite domain s ∈ (0, 1], with boundary conditions g(0) = 0
and g(1) = 1. We solve equation (6) by central second order ﬁnite diﬀerences
with equally spaced discretization points si = i/N , i = 1, 2, . . . , N . Given the
numerical solution ˜g of (6), the numerical approximation of the density is

ρnum(ri) = (cid:20)˜g(cid:18) ri

1 + ri(cid:19)(cid:21)2

(7)

where ri = si/(1− si), i = 1, 2, . . . , N − 1. This rescaling provides denser points
ri in the neighborhood of the origin, where they are mostly needed (more than

3

95% of the points ri are in the interval 0 ≤ r ≤ 20). Nevertheless, the com-
putation of the initial solution for (1) on a two-dimensional grid, for instance,
requires ρnum to be interpolated.

It would be therefore useful to have an analytic approximation of f (r). How-
ever, since it is more convenient [17] to ﬁnd a Pad´e approximation directly for
ρ(r) = [f (r)]2 rather than for f (r), we rewrite equation (5) in terms of ρ(r) as

ρ′′ +

ρ′
r −

(ρ′)2
2ρ −

2ρ
r2 + 2(1 − ρ)ρ = 0,

(8)

with boundary conditions ρ(0) = 0, ρ(∞) = 1.
at both the numerator and denominator, that is

It is known [17, 18] that Pad´e approximations of ρ(r) retain only even degrees

ρ(r) ≈ Pp
1 +Pq

j=0 ajr2j
k=1 bkr2k =

a0 + a1r2 + a2r4 + ··· + apr2p
1 + b1r2 + b2r4 + ··· + bqr2q .

(9)

In order for this approximation to satisfy the boundary conditions, it must be

ρ(0) = 0 =⇒ a0 = 0
ρ(∞) = 1 =⇒ p = q,

bq = ap.

Given these simpliﬁcations, the diagonal Pad´e approximation, with 2q − 1 coef-
ﬁcients and both numerator and denominator of degree r2q, is

ρq(r) =

a1r2 + a2r4 + a3r6 + ··· + aqr2q
1 + b1r2 + b2r4 + b3r6 + ··· + aqr2q .

(10)

In literature this approximation is normally limited to q = 2 [17], that is

ρ2(r) =

a1r2 + a2r4

1 + b1r2 + a2r4

with

a1 =

11
32

,

b1 =

5 − 32a1
48 − 192a1

,

a2 = a1(cid:18)b1 −

1

4(cid:19) .

Despite its widespread usage, this approximation is qualitatively wrong (see,
e.g., [19]), because it reaches an unphysical maximum, above ρ(∞) = 1, at
r0 = 2q6(cid:0)4 + 3√2(cid:1) ≈ 14.065, unique positive solution of r4 − 192r2 − 1152
obtained by imposing ρ′
reach the limit value ρ(∞) = 1 monotonically, without overshooting.
creasing, Pad´e expansions, namely

Due to these limitations, we seek higher-order (q > 2), monotonically in-

2(r) = 0. The physical solution of equation (8) must

ρ3(r) =

a1r2 + a2r4 + a3r6

1 + b1r2 + b2r4 + a3r6

and ρ4(r) =

a1r2 + a2r4 + a3r6 + a4r8
1 + b1r2 + b2r4 + b3r6 + a4r8 .

4

In order to determine the coeﬃcients of a certain approximation ρq(r), we
q (r) and substitute them in

q(r) and ρ′′

compute the analytic expressions ρq(r), ρ′
equation (8) obtaining the form

ρ′′
q +

ρ′
q
r −

q)2
(ρ′
2ρq −

2ρq
r2 + 2(1 − ρq)ρq = 0 ⇐⇒

Nq(r)
Dq(r)

= 0.

(11)

The numerator Nq(r) is made of terms r2k, which are in a number much larger
than the 2q − 1 degrees of freedom of the Pad´e expansion. For this reason
equation (8) cannot be satisﬁed exactly. However, we can nullify the coeﬃ-
cients of 2q − 1 terms r2k. We can choose to start from higher- or lower-order
coeﬃcients in Nq(r). We prefer to operate on lower-order powers of r2k, i.e.
k = 1, . . . , 2q− 1, because we need a good approximation of ρq(r) in a neighbor-
hood of the origin. Interestingly enough, we observe a posteriori that canceling
the lower-order coeﬃcients of r2k results in very small values of the coeﬃcients
of larger powers of r. The step-by-step derivation of ρq(r) for q = 2, 3, 4 is
reported in Appendix A, whereas tables A.1 and A.2 summarize all coeﬃcients
for the expansions ρq, q = 2, 3, 4.

1

0.8

0.6

0.4

0.2

ρ

1

0.998

0.996

0.994

0.992

0.99

10

15

20

25

30

Pad´e, q = 2
Pad´e, q = 3
Pad´e, q = 4
FD, N = 5000

15

20

0

0

5

10
r

Figure 1: Comparison between h˜g(cid:16) r

1+r(cid:17)i2

order ﬁnite diﬀerences on 5000 equispaced points, and diﬀerent Pad´e approximations ρq(r).

, numerical solution of (6) obtained by second-

In Figure 1 we show the comparison between the numerical solution of (6) by
employing second-order central ﬁnite diﬀerences with 5000 points and diﬀerent

5

Pad´e approximations ρq(r) for q = 2, 3, 4. Visual inspection conﬁrms that q = 2
is a poor representation of the solution of equation (8), especially for 4 < r < 20.

1e-1

1e-2

1e-3

1e-4

1e-5

1e-6

1e-7

1e-8

1e-9

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-10

0

5

10
r

Pad´e, q = 2
Pad´e, q = 3
Pad´e, q = 4

15

20

Figure 2: Relative error between diﬀerent Pad´e approximations ρq(r) and the numerical
solution of (6) with (equally spaced grid, second-order ﬁnite diﬀerences, 5000 points).

To appreciate quantitatively the error with respect to the numerical solution,
Interestingly, the
in Figure 2 we report the relative error in a semilog plot.
relative error does not reach its maximum close to the origin, meaning that any
Pad´e approximation reproduces quite well the behavior of the vortex for r → 0.
On the other hand, the maximum relative error is always reached for r < 10,
i.e. in a region of interest for the numerical simulations that we will perform.

3. Time splitting methods

Widely used schemes for the numerical simulation of the dynamics of (1) are
the so-called time-splitting methods and the ﬁnite diﬀerence time domain meth-
ods (see [20] for a review). If we restrict the options to second-order accurate
schemes in time, Time Splitting pseudoSPectral (TSSP) methods, Time Split-
ting Finite Diﬀerence (TSFD) methods and Crank–Nicolson Finite Diﬀerence
(CNFD) method conserve the mass at the discretized level. However, CNFD is
implicit and requires the solution of a coupled nonlinear system at each time
step. For this reason we resorted to time splitting methods. We refer the reader
to [21] for higher-order time splitting methods.

6

In [20, Example 4.1] TSSP is suggested when the solution is smooth and
TSFD otherwise, although the hint comes from a one-dimensional numerical
experiment. In what follows, we analyze two approaches: a classical time split-
ting Fourier method and a time splitting nonuniform ﬁnite diﬀerence method.
In any case, equation (1) is split into two parts

∂u
∂t
∂v
∂t

(t, x) =

(t, x) =

i
2∇2u(t, x)
i
2 (cid:16)1 − |v(t, x)|2(cid:17) v(t, x)

(12a)

(12b)

where x = (x1, . . . , xd) ∈ Rd. The solution of the ﬁrst equation depends on
the space chosen for the discretization and will be described in the next two
sections. The second equation can be solved exactly, taking into account that
|v| is preserved by the equation. Therefore

v(τ, x) = exp(cid:18) τ i

2 (cid:16)1 − |v(0, x)|2(cid:17)(cid:19) v(0, x)

(13)

for any x in the spatial domain. If we denote by eτ Aun(x) and eτ B(vn(x))vn(x)
the two partial numerical solutions, the approximation ψn+1(x) of ψ(tn+1, x),
where tn+1 = (n + 1)τ , can be recovered by the so-called Strang splitting

ψn+1/2(x) = eτ Ae

τ

2 B(ψn(x))ψn(x)

ψn+1(x) = e

τ

2 B(ψn+1/2(x))ψn+1/2(x).

3.1. Time splitting Fourier method

Equation (12a) can be solved exactly in time within the Fourier spectral
space. A part from the error at machine-precision level coming from the neces-
sary direct and inverse Fast Fourier Transforms (FFTs), the only possible con-
siderable error might arise from an insuﬃcient number of Fourier modes. This
is usually not a big deal when approximating smooth solutions fastly decaying
to zero, since spectral order of convergence takes place. For this to happen, the
unbounded domain has to be truncated to a computational bounded domain
Ω large enough to support the most of a periodic approximation of the solu-
tion. However, when simulating the dynamics of vortex solutions not decaying
to zero, as in our case where lim|x|→∞ |ψ(t, x)| = 1, there are some issues to
take into account: the low regularity of the solution at the origin, due both to
ρ(t, 0) and to θ(t, 0), and lack of periodicity at the boundaries, also considering
the usual extension of the computational domain and reﬂection of the solution
(see [14]). In fact, after such a mirroring, the solution takes the same values at
opposite boundaries, but its derivatives do not.

In order to investigate the accuracy of Fourier approximation for vortex
solutions, we consider the Fourier series expansion of the function obtained by
mirroring

7

ψ0(r, θ) = (1 − (1 − ρq/2

4

(r))e−r2/ℓ2

)eciθe−r2/ℓ2

, ψ0 : [−L, L)2 → C

(14)

with respect to the axis x = L and y = L. The ﬁnal computational domain
is therefore Ω = [−L, 3L)2, with L = 20, for which ρ4(L, L) ≈ 0.99875. The
choice of the parameters q = 1, ℓ → ∞ and c = 1 corresponds to a two-
dimensional straight vortex as described above. Diﬀerent choices provide more
regular functions or functions fastly decaying to zero, for which the derivatives
at the boundaries are almost periodic. We compute a reference approximation
by an expansion into a series with 20482 Fourier modes and compare it with
expansions ranging between M = m2 = 162 and M = m2 = 5122 modes, in the
L2 norm. For a quite regular and periodic function, corresponding to q = 10,

r
o
r
r
e

2
L

1e+2

1e+0

1e-2

1e-4

1e-6

1e-8

1e-10

q = 10, ℓ = 5, c = 1
q = 1, ℓ = 5, c = 0
q = 1, ℓ =→ ∞, c = 1
q = 10, ℓ → ∞, c = 0
q = 10, ℓ = 5, c = 0

162

322

642

1282

2562

5122

M

Figure 3: Error behavior of the Fourier approximation of function (14) (extended to [−L, 3L)2
by mirroring) for diﬀerent choices of the parameters. Only the case of a regular and fast
decaying to zero function (q = 10, ℓ = 5 and c = 0, green, upward triangles) shows the typical
spectral rate of convergence.

ℓ = 5 and c = 0 we observe in Figure 3 a typical spectral rate of convergence. For
any other choice of the parameters, which aﬀects the regularity of the density
(q = 1, ℓ = 5, c = 0), or the fast decay to zero of the function and its derivatives
(q = 10, ℓ → ∞, c = 0) or the regularity of the phase (q = 10, ℓ = 5, c = 1) we
observe a strong order reduction. The same reduction occurs for the straight
vortex (q = 1, ℓ → ∞, c = 0).

8

Increasing the number of Fourier coeﬃcients so as to gain accuracy is often
not an option. In fact, due to the necessary mirroring, this corresponds to a
huge growth of the degrees of freedom. Moreover, the use of hyperbolic sparse
grids (see [22], for instance) is not possible, since the possibility of discarding
coeﬃcients and grid points is given only for highly regular solutions.

The low regularity of the solutions to be approximated and the needed dupli-
cation along axes in order to satisfy at least the periodicity of the values of the
solutions suggest to explore the alternative of a ﬁnite diﬀerence discretization
in space.

3.2. Time splitting ﬁnite diﬀerence method

The main advantage of a ﬁnite diﬀerence approach is that the mirroring of
the solution is not required, being the extension of the bounded domain replaced
by the imposition of homogeneous Neumann boundary conditions.

Given the low regularity of vortex solutions, we use centered second order
ﬁnite diﬀerences. With the aim of increasing the spatial resolution around the
vortex cores and keeping a reasonable degree of freedom, we employ a set of
nonuniform grid points (see [23], for instance, for locally adaptive ﬁnite element
discretizations).

The discretization of the Laplace operator in one dimension with nonuniform

ﬁnite diﬀerences on m points provides the nonsymmetric matrix

A1 =





− 2

h2
1

2
h2
1

h1h2

h1(h1+h2) − 2
. . .
. . .

0

2

0

0

2

h2(h1+h2)

. . .

2

hm−2(hm−2+hm−1) −

. . .
. . .
. . .

2

0

0

0

2

hm−2hm−1

hm−1(hm−2+hm−1)

0

. . .

0

2

h2

m−1

− 2

h2

m−1





where hi = xi+1 − xi, x1 = −L, xm = L. This is not exactly a second order
approximation, although a discretization in which hi+1 = (1 + δ)hi and a re-
ﬁnement with hj+1 = (1 + δ)1/2hj yields a ﬁrst order term in the error decaying
faster than the second order term (see [24, § 3.3.4]). The approximation for
the two-dimensional and the three-dimensional cases can be simply obtained by
Kronecker products with the identity matrix. If we call A the corresponding
matrix, equation (12a) is transformed into the system of ordinary diﬀerential
equations

y′(t) =

Ay(t),

y(t) ∈ CM×1.

(15)

i
2

Given the importance of the mass preservation, we investigate this issue
for the numerical solution of system (15). A quadrature formula with positive
weights for the computation of the mass writes

ZΩ |ψ(t, x)|2 dx ≈ wT |y(t)|2 , w ∈ RM×1

+

.

9

It can be written as

y(t)∗W y(t)

where y(t)∗ ∈ C1×M denotes the transposed conjugate vector of y(t) and W the
matrix with diagonal w. We deﬁne z(t) = W 1/2y(t) such that

z′(t) =

i
2

Awz(t)

(16)

with Aw = W 1/2AW −1/2.
exp(τ i/2Aw) is an orthogonal matrix and

If Aw is symmetric, then the solution z(τ ) =

z(τ )∗z(τ ) = z∗(0)z(0).

This means that

y(τ )∗W y(τ ) = (W 1/2y(τ ))∗(W 1/2y(τ )) = z(τ )∗z(τ ) = z(0)∗z(0) =

= (W 1/2y(0))∗(W 1/2y(0)) = y(0)∗W y(0)

and therefore system (15) preserves the mass at the discrete level if W makes
Aw symmetric. From the structure of the matrix A1, it is clear that the vector
of trapezoidal weights wT = [h1, h1 + h2, h2 + h3, . . . , hm−1] gives a matrix W1
such that W1A1 is symmetric. The extension to W in the two-dimensional and
three-dimensional cases is trivial and this is enough to get Aw symmetric as
well, in fact AT W = W A ⇐⇒ W −1/2AT W = W 1/2A ⇐⇒ W −1/2AT W 1/2 =
w = W 1/2AW −1/2 = Aw. We conclude that equation (15) preserves the mass
AT
at the discrete level whenever the trapezoidal rule is used as quadrature formula
and this is easily extended to any space dimension.

System (16) could be solved, for instance, by the Crank–Nicolson scheme

zn+1 = zn +

ki
4

Awzn +

ki
4

Awzn+1,

which preserves the discrete mass being Aw symmetric (see [20]). This scheme
is second order accurate in time, therefore the size of the time step k has to be
chosen such that the error is smaller than the time splitting error. Moreover,
Crank–Nicolson scheme requires the solution of a linear system of equations
with matrix (I − kiAw/4) at each time step k. Although this is not a big deal
in one space dimension, since the matrix is tridiagonal, in higher dimensions
the discretization yields a large, sparse, complex symmetric matrix. This im-
plies the use of preconditioned Krylov solvers for general matrices such as GM-
RES or BiCGStab or minimal residual methods for complex symmetric systems
(see [25]). Iterative methods converge to the solution up to a speciﬁed tolerance
which therefore inﬂuences the mass conservation and the whole accuracy of the
result. Given these complications, we prefer to consider a direct approximation
of the exact solution

zn+1 = exp(τ i/2Aw)zn.

Nowadays there are several options for the computation of the action of the
matrix exponential to a vector. We refer to [26] for a review of polynomial

10

methods which do not require the solution of linear systems. In this way, the
kinetic linear part (12a) is solved exactly in time, as in the Fourier spectral
method.

4. Numerical experiments

In Section 2 we have derived various approximations of ρ(r) for a straight,
two-dimensional vortex, whose wavefunction is ψ(r, θ) = √ρeiθ.
In order to
quantitatively compare the two methods introduced in Section 3, we measure
the preservation of such a steady solution by reporting the relative error

max

0<|r|≤R

|ψn(r, θ) − ψ0(r, θ)|

|ψ0(r, θ)|

, n = 1, 2, . . . , T /τ

(17)

with ψ0(r, θ) = |ψ0(r)| eiθ, where |ψ0(r)| is either pρq(r) or pρnum(r), the

latter evaluated at any required r by linear interpolation of (7). The origin is
excluded since ψ0 is zero therein. The time step τ is chosen such that T /τ is
an integer, where T is the ﬁnal simulation time.
In all our experiments, we
selected T = 10, a reasonable value in quantum ﬂuids simulations [7, 10, 15].
The maximum over the continuum set {0 < |r| ≤ R} in the error above is
approximated by the maximum over a discrete set which will be speciﬁed later.
Although the preservation of the initial state may seem a trivial test, it is
in fact a reliable and necessary experiment in order to validate the eﬀectiveness
of the proposed numerical methods. Thanks to the reliability of the analytic
solution, this test can show the inﬂuence of both the spatial approximation and
the time splitting error in the numerical discretization of the PDE (1).

In what follows we will employ either TSSP (Fourier) or TSFD. For a com-
putational grid with m× m grid points in the physical domain of interest, TSSP
requires a total of M = 2m × 2m = 4m2 degrees of freedom due to mirroring,
whereas TSFD requires only M = m2 degrees of freedom thanks to homoge-
neous Neumann boundary conditions.

4.1. Comparison between diﬀerent approximations of the initial condition

We preliminary test the reliability of the three Pad´e approximations ρq, q =
2, 3, 4 and the numerical solution of equation (6) obtained by central second or-
der ﬁnite diﬀerences with N = 5000 uniformly distributed discretization points.
For the solution of the GPE (1) we employ TSSP with Fourier basis functions on
a uniform two-dimensional computational grid. For this reason, the numerical
solution ˜g(s) of equation (6) must be interpolated.

Results are reported in Figure 4, where the relative error deﬁned by (17) is
plotted versus time for diﬀerent disks. The number of Fourier modes is ﬁxed
to m = 2 · 200, i.e. M = 1.6 × 105 degrees of freedom. We compare the
solution at each time step with the initial condition on the grid nodes within
the considered disk. The worst approximation of the steady-state solution is

the commonly used ρ2 Pad´e approximation, whereas ψ0(r, θ) = pρ4(r)eiθ turns

out to be as accurate as the numerical solution. For this reason, in the following

11

1e+0

1
≤
r

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-1

1e-2

1e-3

1e-4

1e-5

1e-6

1e-7

1e-8

0

1e+0

0
1
≤
r

1e-1

1e-2

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-3

1e-4

1e-5

1e-6

1e-7

1e-8

0

1e+0

5
≤
r

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-1

1e-2

1e-3

1e-4

1e-5

1e-6

1e-7

1e-8

0

1e+0

1e-1

1e-2

1e-3

1e-4

1e-5

1e-6

1e-7

1e-8

0

n
i
a
m
o
d

l
l

u
f

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

2

4

6

8

10

t

2

4

6

8

10

t

2

4

6

8

10

t

Pad´e, q = 2
Pad´e, q = 3
Pad´e, q = 4
FD, N = 5000

2

4

6

8

10

t

Figure 4: Comparison of the relative error as deﬁned by (17) for diﬀerent choices of the initial
condition, Fourier approach.

experiments we will consider only ψ0(r, θ) = pρ4(r)eiθ. All curves collapse on

each other in the case of the largest disk, meaning that the maximum error
occurs at the boundaries, mainly due to the non-periodicity of the solution.

4.2. Uniform vs. nonuniform ﬁnite diﬀerences

We compare the performance of the ﬁnite diﬀerence approximation on a
uniform versus nonuniform grid. The uniform grid has the same step-size h
as the grid employed for the Fourier approach and reported in Figure 4. The
nonuniform grid is generated by taking into account diﬀerent constraints. Given
the smallest step-size hmin = h1 = 0.05 at the origin (in the vortex core), we
linearly increase the step-size according to hi+1 = (1 + δ)hi in both x and y
and in both positive and negative directions. We choose δ so as to reach the
boundaries exactly, and in order to keep the ratio K = hmax/h1 ≈ 10, where
hmax = max hi. The number of points of the nonuniform grid is chosen such
that the mean value of {hi} equals the step-size of the uniform grid. These
constraints guarantee a reasonable nonuniform grid.
The comparison between the uniform and nonuniform grids is shown in Fig-

ure 5. In all cases the initial condition is ψ0(r, θ) = pρ4(r)eiθ, thus the error

for the uniform grid can be compared directly with that in Figure 4 for the case
of Pad´e approximation with q = 4 (red squares in both Figures).

12

1e+0

1
≤
r

1e-1

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-2

1e-3

1e-4

1e-5

0

1e+0

0
1
≤
r

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-1

1e-2

1e-3

1e-4

2

4

6

8

10

t

1e-5

0

2

4

6

8

10

t

1e+0

5
≤
r

1e-1

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

n
i
a
m
o
d

l
l

u
f

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-2

1e-3

1e-4

1e-5

0

1e+0

1e-1

1e-2

1e-3

1e-4

1e-5

0

2

4

6

8

10

t

UFD, m = 201, L = 20
NFD, m = 201, L = 20
NFD, m = 101, L = 10
NFD, m = 301, L = 30

2

4

6

8

10

t

Figure 5: Comparison of the relative error as deﬁned by (17) for central ﬁnite diﬀerences on
uniform (UFD) and nonuniform (NFD) grids.

We ﬁrst focus on the results with the same number of points and the same
boundaries, i.e. red squares and blue circles in Figure 5. The discrete mass
variation along time integration is comparable and of order 10−13. This conﬁrms
the conservation of mass also for the case of nonuniform grid, as discussed in
Section 3.2. In the nonuniform case the error is roughly one order of magnitude
smaller than in the uniform case on small disks and for t not too large, whereas
the curve of the nonuniform case tends to jump onto the uniform one after a
certain time as the radius of the disk of interest increases. This suggests the
idea that the error arises at the boundaries, where ψ0(r, θ) does not exactly
fulﬁll Neumann boundary conditions.

Motivated by this, we have changed the boundaries from L = 20 to L = 30
and L = 10 to check the dependency of the error on the choice of the truncated
domain. In doing so, we have preserved the constraints on the nonuniform grids
discussed above, obtaining M = 1012 degrees of freedom for L = 10 (upward
green triangles) and M = 3012 degrees of freedom for L = 30 (downward black
triangles). With reference to Figure 5, the domain bounded at L = 10 is clearly
too small and the error is always very large compared to all the other cases.
On the other hand, the curves for L = 20 (blue circles) and L = 30 (downward
black triangles) behave roughly in the same way up to a certain value of t, after

13

which the case L = 20 consistently show larger errors than the case L = 30.
This reinforces the claim that the error arises from the borders.

4.3. Comparison between Fourier spectral method and nonuniform ﬁnite diﬀer-

ences

Now we concentrate on our main goal, which is the comparison between
TSSP with Fourier basis function on uniform grids and TSFD on a nonuniform
grid that we ﬁx to hmin = 0.05, L = 20, m = 201. In order to compare the error
deﬁned by (17) for the two methods, we always evaluate the TSSP solution on
the nonuniform grid points (spectral solutions can be evaluated everywhere).
This set of points has the advantage of being denser in the vortex core, where
higher spatial resolution is desirable. Results are reported in Figure 6, where
SP stands for spectral and NFD for nonuniform ﬁnite diﬀerences.

1e-2

1
≤
r

1e-3

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-4

1e-5

1e-6

0

1e-2

0
1
≤
r

1e-3

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-4

1e-5

1e-6

0

NFD, m = 201
SP, m = 2 · 200
SP, m = 2 · 100
SP, m = 2 · 50

2

4

6

8

10

t

2

4

6

8

10

t

Figure 6: Comparison of the relative error as deﬁned by (17) between nonuniform ﬁnite
diﬀerences (NFD) and spectral Fourier (SP) for diﬀerent numbers of Fourier modes.

Keeping in mind that the spectral Fourier approach needs mirroring, i.e. the
number of modes in each direction must be doubled, we ﬁrst choose a number
of Fourier modes m = 2 · 200 in each direction to make it equal to the number
of points of the reference case for nonuniform ﬁnite diﬀerences (m = 201) in
the physical (un-mirrored) domain. The overall behavior of the error for these
two cases is comparable: TSSP (red squares) performs better than TSFD (blue
circles) for small values of t, whereas the opposite happens for intermediate
values of t. For large t the two curves collapse on each other.

Due to the fact that TSSP needs mirroring, i.e. MTSSP = 4MTSFD, in
Figure 6 we explore also the cases with less Fourier modes, namely m = 2 · 100
(upward green triangles) and m = 2·50 (downward black triangles). As observed
for the case m = 2 · 200, in the long term all curves seem to provide similar
errors, regardless of the disk radius. On the other hand, for small values of t,
the number of degrees of freedom plays a rˆole in that a larger number of Fourier
modes ensures smaller errors.

It is important to keep in mind that, for what seen in Figure 3, the TSSP
Fourier approach does not retain the spectral accuracy because of the singular
nature of the solution at the origin and the lack of periodicity at the boundaries.

14

As a ﬁnal remark, we observe that the error of the Fourier solution computed
on its own uniform grid, reported in Figure 4 with red squares, is smaller than
the error of the Fourier solution evaluated on the nonuniform grid, reported in
Figure 6 with red squares.

4.4. Maximum resolution of Fourier spectral method

As expected, from Figure 6 we have seen that the smaller the number of
Fourier modes, the larger the relative error with respect to the initial condition.

1e-2

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1
≤
r

1e-3

1e-4

1e-5

1e-6

0

2

4

6

8

10

t

1e-2

0
1
≤
r

1e-3

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-4

1e-5

1e-6

0

SP, m = 2 · 100
SP, m = 2 · 200
SP, m = 2 · 300
SP, m = 2 · 400

2

4

6

8

10

t

Figure 7: Comparison of the relative error as deﬁned by (17) for increasing number of Fourier
modes.

We wish to check if there exists an upper limit to the maximum resolution of
Fourier spectral method. For doing so, we increase the number of Fourier modes
and, proportionally, the number of time steps as suggested in [27]. Results are
shown in Figure 7. We observe high accuracy in the core (see smaller disk,
left plot) for small values of t, immediately followed by saturation. In a larger
disk (right plot), saturation kicks in almost immediately. The errors reported
in Figure 7 suggest that m = 2 · 200 is a reasonable value of Fourier modes for
the preservation of a two-dimensional quantum vortex.

4.5. Fourier evaluation on nonuniform grids

As explained in the Introduction, our motivation to explore the nonuniform
ﬁnite diﬀerence approach is based on the need, for the study of vortex recon-
nections [10], of high local spatial resolution and, possibly, accuracy.

Instead of increasing the number of Fourier modes so as to reach higher
global spatial resolution, one can resort to a TSSP method with a reasonable
number of modes (considering that mirroring is needed) and then evaluate the
TSSP solution on a nonuniform grid, with denser points where they are needed.
In Figure 8 we compare the reasonable case m = 2 · 100, for which the number
of modes is relatively small, but not too small, with diﬀerent nonuniform grids.
We notice that the numerical integration itself is carried out only once and the
Fourier coeﬃcients of the solution are stored at each time step. The evaluation
at the grid points is performed afterward, in the post-processing stage, as many

15

1e-2

1
≤
r

1e-3

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-4

1e-5

1e-6

1e-7

0

1e-2

0
1
≤
r

1e-3

k
s
i
d

e
h
t

n

i

r
o
r
r
e

e
v
i
t
a
l
e
r

1e-4

1e-5

1e-6

1e-7

0

hmin = 0.1
hmin = 0.05
hmin = 0.025
h = 0.4

2

4

6

8

10

t

2

4

6

8

10

t

Figure 8: Comparison of the relative error as deﬁned by (17) for diﬀerent evaluations of the
Fourier solution (m = 2 · 100) at nonuniform grids.

times as desired. Moreover, tools like the Nonuniform Fast Fourier Transform
(NFFT, see [28]) can be employed for the fast evaluation of trigonometric poly-
nomials at arbitrary point sets. The constant spatial step-size of the TSSP
method is h = 0.4, whereas hmin stands for the minimum value of the step-size,
in the proximity of the origin, for the nonuniform grids. As seen before, there
is a substantial diﬀerence in the error only for t < 2, whereas for larger values
of t evaluating the Fourier solution on a nonuniform grid does not worsen the
solution. It is important to note that vortex reconnections, usually, require a
dynamics that takes a time of at least t = 10. Evaluating a TSSP solution on a
locally reﬁned grid is, thus, a very promising approach to study quantum vortex
reconnections.

5. Conclusions

After deriving a new accurate Pad´e approximation for the density distri-
bution of a two-dimensional steady-state vortex, we have used it as the ini-
tial condition for the Gross–Pitaevskii equation to test the performance of the
time-splitting Fourier method. Although it cannot retain its classical spectral
accuracy in space, being as accurate as low-order ﬁnite diﬀerence on nonuni-
form grids, it preserves quite well the steady-state solution, especially in the
neighborhood of the singularity. The advantage of a post-processing evaluation
on arbitrary points makes this approach suited for applications where local high
resolution is required.

References

References

[1] W. F. Vinen, An introduction to quantum turbulence, Phil. Trans. R. Soc.

A 366 (1877) (2008) 2925–2933.

16

[2] M. S. Paoletti, D. P. Lathrop, Quantum turbulence, Ann. Rev. Cond. Mat.

Phys. 2 (2011) 213–234.

[3] C. F. Barenghi, L. Skrbek, K. R. Sreenivasan, Introduction to quantum

turbulence, Proc. Natl. Acad. Sci. USA 111 (1) (2014) 4647–4652.

[4] U. Frisch, Turbulence, Cambridge University Press, Cambridge, England,

1995.

[5] S. B. Pope, Turbulent Flows, Cambridge University Press, Cambridge, Eng-

land, 200.

[6] F. Hussain, K. Duraisamy, Mechanics of viscous vortex reconnection, Phys.

Fluids 23 (2011) 021701(4).

[7] S. Zuccher, M. Caliari, A. W. Baggaley, C. F. Barenghi, Quantum vortex

reconnections, Phys. Fluids 24 (125108) (2012) 1–21.

[8] L. P. Pitaevskii, Vortex lines in an imperfect Bose gas, Sov. Phys. JETP

13 (1961) 451–54.

[9] E. P. Gross, Hydrodynamics of a superﬂuid condensate, J. Math. Phys. 4

(1963) 195–207.

[10] S. Zuccher, R. L. Ricca, Helicity conservation under quantum reconnection

of vortex rings, Phys. Rev. E 92 (6) (2015) 061001.

[11] L. Kondaurova, V. L’vov, A. Pomyalov, I. Procaccia, Structure of a quan-
tum vortex tangle in 4He counterﬂow turbulence, Phys. Rev. B 89 (2014)
014502.

[12] M. D. Bustamante, R. M. Kerr, 3D Euler about a 2D symmetry plane,

Physica D 237 (2008) 1912–1920.

[13] R. H¨anninen, A. W. Baggaley, Vortex ﬁlament method as a tool for compu-
tational visualization of quantum turbulence, Proc. Natl. Acad. Sci. USA
111 (1) (2014) 4667–4674.

[14] J. Koplik, H. Levine, Vortex Reconnection in Superﬂuid Helium, Phys.

Rev. Lett. 71 (9) (1993) 1375–1379.

[15] A. J. Allen, S. Zuccher, M. Caliari, N. Proukakis, N. G. Parker, C. F.
Barenghi, Vortex reconnections in atomic condensates at ﬁnite tempera-
ture, Phis. Rev. A 90 (2014) 013601.

[16] M. W. Scheeler, D. Kleckner, D. Proment, G. L. Kindlmann, W. T. M.
Irvine, Helicity conservation by ﬂow across scales in reconnecting vortex
links and knots, Proc. Natl. Acad. Sci. USA 111 (43) (2014) 15350–15355.

[17] N. G. Berloﬀ, Pad´e approximations of solitary wave solutions of the Gross–

Pitaevskii equation, J. Phys. A: Math. Gen. 37 (2004) 1617–1632.

17

[18] S. Nazarenko, R. West, Analytical solution for nonlinear Schr¨odinger vortex

reconnection, J. Low Temp. Phys. 132 (1) (2003) 1–10.

[19] D. P. Meichle, C. Rorai, M. E. Fisher, D. P. Lathrop, Quantized vortex
reconnection: Fixed points and initial conditions, Phys. Rev. B 86 (1)
(2012) 014509.

[20] W. Bao, Y. Cai, Mathematical theory and numerical methods for Bose–

Einstein condensation, Kinet. Relat. Models 6 (1) (2013) 1–135.

[21] M. Thalhammer, M. Caliari, C. Neuhauser, High-order time-splitting Her-
mite and Fourier spectral methods, J. Comput. Phys. 228 (3) (2009) 822–
832.

[22] V. Gradinaru, Strang splitting for the time-dependent Schr¨odinger equation

on sparse grids, SIAM J. Numer. Anal. 46 (1) (2007) 103–123.

[23] M. Thalhammer, J. Abhau, A numerical study of adaptive space and time
discretisations for Gross–Pitaevskii equations, J. Comput. Physics 231 (20)
(2012) 6665–6681.

[24] J. H. Ferziger, M. Peri´c, Computational Methods for Fluid Dynamics, 3rd

Edition, Springer, 2002.

[25] S.-C. T. Choi, Minimal residual methods for complex symmetric, skew sym-
metric, and skew hermitian systems, Tech. Rep. ANL/MCS-P3028-0812,
Computation Institute, University of Chicago, Chicago, Illinois (2013).

[26] M. Caliari, P. Kandolf, A. Ostermann, S. Rainer, Comparison of software
for computing the action of the matrix exponential, BIT 54 (1) (2014)
113–128.

[27] W. Bao, S. Jin, P. A. Markowich, On time-splitting spectral approximations
for the Schr¨odinger equation in the semiclassical regime, J. Comput. Phys.
175 (2) (2002) 487–524.

[28] J. Keiner, S. Kunis, D. Potts, Using NFFT 3—A Software Library for Var-
ious Nonequispaced Fast Fourier Transforms, ACM Trans. Math. Software
36 (4) (2009) 19:1–19:30.

Appendix A. Detailed derivation of Pad´e approximations

The case q = 2. The coeﬃcients of this expansion are already known, how-
ever it is instructive to proceed with their derivation in order to understand how
it works. We have to compute 3 coeﬃcients, a1, b1 and a2, therefore we can
use only 3 equations. These equations are obtained by nullifying, respectively,
the coeﬃcients of the terms r2, r4 and r6 in the numerator N2(r) (lower-order
powers of r2k). By nullifying the coeﬃcient of r2, we get

−4a2

1b1 + 4a1a2 + a2

1 = 0,

18

q = 2

11
32

5 − 32a1

48 − 192a1

a1 (cid:18)b1 −

1

4(cid:19)

a1

b1

a2

b2

a3

q = 3

0.34003812123694735361

2304a3

1 + 656a2

1 − 421a1 − 28

7680a2

1 − 1680a1 − 330

a1 (cid:18)b1 −

1

4(cid:19)

768a1b1 − 120b1 − 384a2
4608a1 − 1152

1 + 8a1 + 7

a1(192b2 − 48b1 + 16a1 + 5)

192

Table A.1: Coeﬃcients of Pad´e approximations ρ2 and ρ3.

from which a2 = a1(cid:0)b1 − 1

a2 with the expression above, we get

4(cid:1). By nullifying the coeﬃcient of r4, and replacing

a2
1(192a1b1 − 48b1 − 32a1 + 5) = 0,

which gives b1 = 5−32a1
48−192a1
with a1(cid:0)b1 − 1

4(cid:1) and b1 with 5−32a1

48−192a1

a2
1(8a1 + 1)(32a1 − 11) = 0.

. If we now nullify the coeﬃcient of r6 and replace a2

, we get the following equation

Clearly, a1 = 0 is not acceptable, nor is a1 = − 1
8 . The only acceptable value
is a1 = 11
32 . As we mentioned before, equation (8) cannot be satisﬁed exactly,
however, an a posteriori evaluation reveals that the remaining coeﬃcients of r2k
are smaller than 1.5 × 10−4 and monotonically decreasing with k.
The case q = 3. Since we have to compute 5 coeﬃcients we need 5 equations,
which are obtained by imposing that the coeﬃcients of the terms r2, r4, r6, r8
and r10 must be zero. By nullifying the coeﬃcient of r2 we still get the same
1 = 0, from which a2 = a1(cid:0)b1 − 1
equation as for q = 2, −4a2
4(cid:1).
By nullifying the coeﬃcient of r4, and replacing a2 with the expression above,
we get

1b1 + 4a1a2 + a2

192a1b2 − 48a1b1 − 192a3 + 16a2

1 + 5a1 = 0,

which is easy to solve for a3 leading to

a3 =

a1(192b2 − 48b1 + 16a1 + 5)

192

.

Now we collect terms in r6 and impose its coeﬃcient to be zero. In this equation
we replace a2 and a3 with the expressions derived above and get the equation

4608a1b2 − 1152b2 − 768a1b1 + 120b1 + 384a2

1 − 8a1 − 7 = 0,

19

q = 4

0.34010790700196714760

2304a3

1 + 656a2

1 − 421a1 − 28

7680a2

1 − 1680a1 − 330

a1 (cid:0)b1 −

1

4(cid:1)

(737280a3

1 + 209920a2

1 − 134720a1 − 8960)b1 − 364544a3

1 + 70144a2

1 + 18256a1 + 393

2457600a2

1 − 537600a1 − 105600

a1(192b2 − 48b1 + 16a1 + 5)

192

(61440a1 − 9600)b2 + (−30720a2

1 + 640a1 + 560)b1 + 8448a2

1 − 1056a1 − 21

368640a1 − 92160

4608a1 b3 − 1152a1b2 + (384a2
4608

1 + 120a1)b1 − 128a2

1 − 7a1

a1

b1

a2

b2

a3

b3

a4

Table A.2: Coeﬃcients of Pad´e approximation ρ4.

which we solve for b2:

b2 =

768a1b1 − 120b1 − 384a2
4608a1 − 1152

1 + 8a1 + 7

.

Then we nullify the coeﬃcient of r8, substitute all previously found a2, a3 and
b2, getting the equation

7680a2

1b1 − 1680a1b1 − 330b1 − 2304a3

1 − 656a2

1 + 421a1 + 28 = 0,

which gives

b1 =

2304a3

1 + 656a2

1 − 421a1 − 28

.

7680a2

1 − 1680a1 − 330

Finally, we nullify the coeﬃcient of r10, substitute a2, a3, b2 and b1, and get the
equation for a1

a2

1 − 9732096a4

1 − 62464a3

1 + 137856a2

1(cid:0)21233664a5

1 + 62772a1 − 1247(cid:1) = 0.
This equation must be solved numerically and leads to many real solutions.
However the only value that reproduces a physical behavior of ρ3(r) for r → 0
is a1 = 0.34003812123694735361. It is possible to compute the ﬁrst derivative
and verify that ρ′
In other words, ρ3 is a physical,
monotonically increasing, approximation of the density due to a two-dimensional
quantum vortex. Again, the coeﬃcients of r2k that are not zero are, indeed,
smaller than 4.0 × 10−4 and monotonically decreasing with k.
The case q = 4. Now we have 7 coeﬃcients to compute, therefore we need
7 equations, i.e. we need to nullify the coeﬃcients of r2k for k = 1, . . . , 7.

3(r) > 0 for all r > 0.

20

By canceling the term r2 and solving for a2 we get the usual expression a2 =

a1(cid:0)b1 − 1
4(cid:1). By nullifying the term r4, substituting a2 and solving for a3 we get
a3 = a1(192b2−48b1+16a1+5)
, which is the same expression obtained for ρ3. By
canceling the term r6, substituting a2 and a3 as found, and solving for a4 we
get

192

a4 =

4608a1b3 − 1152a1b2 + (384a2
4608

1 + 120a1)b1 − 128a2

1 − 7a1

.

By canceling the term r8, substituting a2, a3, a4 and solving for b3 we get

b3 =

(61440a1 − 9600)b2 + (−30720a2

1 + 640a1 + 560)b1 + 8448a2

1 − 1056a1 − 21

368640a1 − 92160

.

By canceling the term r10, substituting a2, a3, a4 and b3, and solving for b2 we
get

b2 =

(737280a3

1 + 209920a2

1 − 134720a1 − 8960)b1 − 364544a3

1 + 70144a2

1 + 18256a1 + 393

2457600a2

1 − 537600a1 − 105600

.

By canceling the term r12, substituting all known aj, b3, b2, and solving for b1
we get

b1 =

722731008a5
2972712960a5

1 − 326467584a4
1 − 1362493440a4

1 − 13427712a3
1 − 8744960a3

1 + 11551104a2
1 + 19299840a2

1 + 834006a1 − 12183
1 + 8788080a1 − 174580

Finally by canceling the term r14, substituting all aj, bk previously found, we
get an equation for a1

1292033536819200a8
642522859438080a5
248539665024a2

1 − 2530164294549504a7
1 + 107808283328512a4

1 + 1853440540016640a6
1−

1 − 8028170208256a3
1+

1 + 1297120628a1 + 9325957 = 0.

This equation has many real solutions, which can be determined numerically.
However, the only value that leads to a physically acceptable ρ4(r) for r → 0 is
a1 = 0.34010790700196714760. After computing all other coeﬃcients and the
ﬁrst derivative, it is straighforward to verify that ρ′
4(r) > 0 for all r > 0, i.e.
ρ4 is a physical, monotonically increasing, approximation of the density for a
two-dimensional quantum vortex. As observed before, the coeﬃcients of r2k
that are not zero are smaller than 1.9 × 10−11 and monotonically decreasing
with k.

21

