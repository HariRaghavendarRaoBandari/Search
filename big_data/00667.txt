6
1
0
2

 
r
a

M
2

 

 
 
]

.

D
C
n
i
l
n
[
 
 

1
v
7
6
6
0
0

.

3
0
6
1
:
v
i
X
r
a

How sticky is the chaos/order boundary?

Carl P. Dettmann

Abstract. In dynamical systems with divided phase space, the vicinity of
the boundary between regular and chaotic regions is often “sticky,” that is,
trapping orbits from the chaotic region for long times. Here, we investigate
the stickiness in the simplest mushroom billiard, which has a smooth such
boundary, but surprisingly subtle behaviour. As a measure of stickiness, we
investigate P (t), the probability of remaining in the mushroom cap for at
least time t given uniform initial conditions in the chaotic part of the cap.
The stickiness is sensitively dependent on the radius of the stem r via the
Diophantine properties of ρ = (2/π) arccos r. Almost all ρ give rise to families
of marginally unstable periodic orbits (MUPOs) where P (t) ∼ C/t, dominating
the stickiness of the boundary. Here we consider the case where ρ is MUPO-free
and has continued fraction expansion with bounded partial quotients. We show
that t2P (t) is bounded, varying inﬁnitely often between values whose ratio is at
least 32/27. When ρ has an eventually periodic continued fraction expansion,
that is, a quadratic irrational, t2P (t) converges to a log-periodic function. In
general, we expect less regular behaviour, with upper and lower exponents lying
between 1 and 2. The results may shed light on the parameter dependence of
boundary stickiness in annular billiards and generic area preserving maps.

1. Introduction

Understanding Hamiltonian dynamics with mixed regular and chaotic phase
space remains one of the most important and intractable problems in dynamical
systems, with many open questions. Much of the diﬃculty of such systems is that
often (and probably “typically” in many senses) the boundary between regular
and chaotic regions (however deﬁned) is fractal. This is true even for well studied
and visualised classes of systems such as two dimensional billiards, in which a
point particle (of unit mass and speed, without loss of generality) moves uniformly,
making mirror-like reﬂections with the boundary of a domain D ⊂ R2 [10, 21].
Dynamics in any billiard has one natural, “equilibrium” invariant measure: For the
ﬂow (continuous time) dynamics it is uniform (that is, proportional to Lebesgue)
in position in the domain and in the direction of motion. For the map (from one
collision to the next) it is uniform in arc length and the tangential component of
velocity.

Mushroom billiards were introduced by Bunimovich, as the ﬁrst examples of
billiards with sharply divided regular and chaotic phase space [7]. The simplest
mushroom consists of a semicircular cap (of unit radius, without loss of generality)

2010 Mathematics Subject Classiﬁcation. 37J99, 11J70.

1

2

CARL P. DETTMANN

Figure 1. (a) The mushroom geometry; the radius of the cap is
1 and that of the stem is r ∈ (0, 1). (b) Reduction of dynamics in
the cap to a circular billiard, by reﬂecting across the x-axis. The
stem becomes a slit-like hole of size 2r in the interior. An orbit
with rotation number close to 1/3 is shown in each case.

and rectangular or triangular symmetrically placed stem of radius r ∈ (0, 1); see
Fig. 1. Orbits with angular momentum (that is, distance of closest approach to the
centre) l > r in the cap cannot reach the stem, and so form a regular component
with rotation number λ/2 where

(1.1)

λ =

2
π

arccos l

due to the integrability of the circle. This region corresponds to λ < ρ where

(1.2)

ρ =

2
π

arccos r

The factor 2 in these deﬁnitions is needed to simplify the Diophantine approxima-
tion conditions; see Ref. [14] and below. The set of orbits that enter the stem forms
the chaotic component, by an application of the defocusing mechanism originally
proposed for stadium geometries. More complicated mushrooms may involve semi-
ellipses and/or be constructed to have an arbitrary number of regular and chaotic
components [7, 9].

Later, it was observed that even in mushroom billiards, the simple structure
of the phase space may be complicated by the presence of marginally unstable
periodic orbits (MUPOs) embedded in the chaotic region [2]. As is common in the
literature, we use the term MUPO to denote the whole continuous family of periodic
orbits with a given rational rotation number. These are any periodic orbit (λ ∈ Q)
restricted to cap of the mushroom (hence their marginal, ie parabolic nature) but

(a)(b)HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

3

have λ ≥ ρ (hence located in the chaotic region or its boundary). When λ is
perturbed, the orbit precesses for a long time but eventually falls into the stem
and into the main body of the chaotic region. MUPOs are thus responsible for
the phenomenon of stickiness, the phenomenon in which chaotic orbits spend long
periods in quasi-regular behaviour. If the mushroom stem has no periodic orbits
entirely contained within it, such as the triangular stem in Fig. 1, any MUPOs in
the cap are the main source of stickiness.

Note that there are a great variety of examples of stickiness in billiards, as
discussed recently [9]. “Internal” stickiness is where there is no island of stability,
such as the original stadium billiard, or where stickiness is due to MUPOs com-
pletely contained in the chaotic sea, such as the mushroom MUPOs above.
In
contrast, “external” stickiness is related to the boundary between chaotic and reg-
ular regions. Ref. [9] gives a number of examples of external stickiness, arguing
that where the orbits in the regular region are parabolic (as in mushrooms with
circular caps) the island is typically not sticky, and giving as a counterexample the
case where the boundary corresponds to rational rotation number (ie a MUPO).
While MUPOs lead to stickiness located in the chaotic sea (internal stickiness), the
nature of mixed phase space also requires an understanding of the stickiness of the
boundary between the regular and chaotic regions (external stickiness).

Here we characterise stickiness in terms of an open billiard. If initial conditions
are distributed with respect to the equilibrium invariant measure of the ﬂow, re-
stricted to the cap of a mushroom and to the chaotic region λ > ρ, and the stem is
replaced by a hole, we can consider the survival probability P (t), that the particle
has not escaped by time t. A MUPO leads to a contribution to P (t) proportional to
1/t as t → ∞ [14]. That work also gave a number of results (discussed below) about
MUPOs in mushrooms, including characterising the set of r for which there are no
MUPOs, including an explicit example, namely r = cos

(cid:17) ≈ 0.640134.

(cid:16) 5+

√
23 π

2

This paper is concerned with the stickiness of the boundary, which is weaker
than stickiness due to MUPOs. It was conjectured in Ref. [14] that when there are
no MUPOs the boundary would contribute C/t2. Subsequently Alastair Robert-
son’s undergraduate project [17] with more careful numerics for the above explicit
r, suggested this form of decay, but with C bounded but not convergent. This
calculation is replicated with a larger sample size of 1011 in Fig.2.

Here we ﬁnd that not only the existence of MUPOs has an intricate parameter
dependence, but also the boundary stickiness. In particular, the stickiness depends
sensitively on the Diophantine properties of ρ. In this paper we give results when
the partial quotients an in the continued fraction expansion are bounded:

Theorem 1.1. Mushrooms with bounded partial quotients. Consider a MUPO-

free mushroom for which ρ has bounded partial quotients. Then

(1.3)
as t → ∞, and in particular both limits are positive and ﬁnite.

≈ 1.185 . . .

lim sup t2P (t)
lim inf t2P (t)

≥ 32
27

Theorem 1.2. Mushrooms with eventually periodic partial quotients. Consider
a MUPO-free mushroom for which ρ has eventually periodic partial quotients. Then
there is a constant β > 1 so that the limit taken over integers m,

(1.4)

m→∞ β2mt2P (βmt)
lim

4

CARL P. DETTMANN

Figure 2. In the MUPO-free case r = cos
the survival probability limits to a log-periodic function divided by
t2, as shown by Thm. 1.2.

2

(cid:17) ≈ 0.640134

(cid:16) 5+

√
23 π

converges for all t > 0.

The even partial quotients of ρ must be bounded for the mushroom to be
MUPO-free, from previous studies (see Sec. 2 below). However there is no such
constraint on the odd partial quotients; typical MUPO-free mushrooms (if a mea-
sure on the set of MUPO-free ρ can be naturally deﬁned) would be expected to
have unbounded odd an, and indeed these values could grow rapidly.
It would
be interesting to extend the methods developed here to these cases. For now, we
present only the example in Fig. 3, also with a sample size of 1011.

It appears that such behaviour may be arbitrarily close to that of MUPOs (see

also Thm 1 in Ref. [13] for a similar result in open chaotic maps):

Conjecture 1.3. Liouville mushrooms. For suﬃciently well-approximable

MUPO-free ρ,

(1.5)

− ln P (t)

ln t

= 1

lim sup
t→∞

There are some other systems to which the present results could apply. Mush-
rooms are of particular interest in quantum mechanics, in which the classical dy-
namics approximates the small wavelength limit of the Schr¨odinger equation with

 0.6 0.8 1 1.2 1.4 1.6 1.8 2 1 10 100 1000t2 P(t)tHOW STICKY IS THE CHAOS/ORDER BOUNDARY?

5

Figure 3. A MUPO-free example constructed from the well-
approximable ρ = [0; 1, 3, 10, 1, 100, 1, 1000, . . .] which gives
r ≈ 0.374600.
An exponent for the survival probability
− limt→∞ ln P (t)

ln t does not appear to exist.

(typically) Dirichlet conditions on the boundary. Here, wave functions correspond-
ing to diﬀerent components of phase space, and tunnelling rates between these
components, can be observed numerically and experimentally [5, 6, 15, 16, 24].
Thus, it would be of interest to know in what way the amount of classical stickiness
aﬀects the quantum mechanical properties such as the energy level spacing.

A closely related class of billiards, also used in experiments, is that of the
annulus, a circle with a circular scatterer [12]. In this case orbits with suﬃciently
large angular momentum cannot reach the scatterer and form a regular component
of phase space. Orbits reaching an oﬀ-centre scatterer may be chaotic or belong
to elliptic islands.
It would be interesting to study boundary stickiness in both
classical and quantum annuli.

Finally, we return to generic area preserving maps. Given the subtleties for
the case of sharply divided phase space, it is unsurprising that the generic mixed
boundary has eluded detailed understanding for so long. There are similarities
between the mushroom and generic cases, for example the importance of one-sided
Diophantine approximation; see Ref. [4] for a recent study focusing on the H´enon
map, and references. There also, the rotation number of the invariant boundary
circle depends intricately on the control parameter. This suggests that there may be

 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 1 10 100 1000 10000t1.5 P(t)t6

CARL P. DETTMANN

an exceptional set of parameters in which the non-integer universal decay exponent
as conjectured in Ref. [11] does not hold.

The outline of this paper is as follows: Section 2 summarises relevant previous
results, section 3 develops the theory, culminating in proofs of the two theorems
in section 4, with more technical lemmas and their proofs relegated to section 5.
Sec. 3.3 demonstrates the possibility of an incipient MUPO not leading to stickiness,
but contains a further conjecture that they are not found in otherwise MUPO-free
mushrooms.

Acknowledgements

This paper is dedicated to the memory of Nikolai Chernov, whose life con-
tinues to inspire and enlighten all who play mathematical billiards. Thanks to
the organisers of his memorial conference in Birmingham AL, May 2015 for their
kind hospitality. The author is grateful to Alastair Robertson, whose undergradu-
ate project report [17] included an early version of Fig. 2, providing the impetus
for this work; also to Leonid Bunimovich and Orestis Georgiou for helpful dis-
cussions and to user O.L. on math.stackexchange.org for assistance with the ﬁnal
integral in Eq. (3.15). This work was supported by the EPSRC [grant number
EP/N002458/1]. Data underlying this work will be available from the University
of Bristol data repository.

2. Previous results

This section gives a brief summary of previous results on MUPOs in mushrooms,
or lack thereof. In mushrooms with circular caps, each MUPO (deﬁned by coprime
integers 1 ≤ A < B) exists for a ﬁxed interval of stem radii [2, 14]

(cid:19)

(cid:18) π

A
B

2

cos(cid:0) π
cos(cid:0) π

2

2

(cid:1)
(cid:1)

A
B
1
B

≤ r <

(2.1)

cos

For a ﬁxed mushroom, the amount and type of stickiness depends on what MUPOs
exist. This investigation was initiated by Altmann and coauthors [1, 2, 3], who
showed that for both mushroom and annular billiards, the MUPOs are related to
the Diophantine properties of the relevant parameter, here ρ. MUPOs appear when
there is suﬃciently good one-sided approximation of the component boundary by
orbits with rational rotation numbers, for example corresponding to unbounded
even partial quotients in the continued fraction expansion of ρ. Such behaviour is
typical, so that a full measure of parameters have inﬁnitely many MUPOs. Ratio-
nal ρ yield a positive ﬁnite number of MUPOs, including the one exactly on the
boundary. Tsugawa and Aizawa have recently studied the Fibonacci case, that is,
the most extreme badly approximable ρ [22].

Further results were provided by Dettmann and Georgiou [14], who showed
that there were parameter values with no MUPOs, gave a method for ﬁnding them,
and the explicit example r = cos

(cid:17) ≈ 0.640134. The idea here is that

(cid:16) 5+

√
23 π

2

quadratic irrationals have periodic (and in particular bounded) continued fraction
expansions; a ﬁnite number of other conditions needed to be checked. Periodicity is
not necessary; any value with bounded even partial quotients and suﬃciently small

HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

7

stem, speciﬁcally amax = sup a2n and

(2.2)

r <

(cid:112)π2(amax + 2)2 + 1

1

will have ﬁnitely many MUPOs, and usually zero (can be proved for speciﬁc r by
checking a ﬁnite number of conditions) as in the example in Fig. 3.
≈ 0.707107,
Ref. [14] also showed that the supremum of MUPO-free radii is 1√
2
and that the supremum of ﬁnitely many MUPOs for irrational rotation number is
16+π2 ≈ 0.786439. Bunimovich has recently provided an alternative characterisa-
4√
tion of the MUPO-free parameter set, including a number of theorems, bounds on
MUPO numbers and method for ﬁnding MUPO-free mushrooms [8].

3. Development of the theory

3.1. From the mushroom to circle rotations. The mushroom geometry
we consider is shown on the left in Fig. 1. The cap has radius 1 while the stem
has radius r ∈ (0, 1) and has a polygonal geometry that contains no periodic orbits
entirely within it. An example with periodic orbits would be a rectangle, with
horizontal period two orbits. Any such periodic orbits would be MUPOs and lead to
stickiness in the chaotic region, since all orbits of polygonal billiards are parabolic.
Apart from the no-MUPO constraint, the stem geometry is arbitrary, and not
relevant to the analysis below. Note that many other mushroom geometries can be
constructed with diﬀerent and interesting properties [9].

Using the usual reﬂection trick, any orbit which hits only the cap is equivalent
to an orbit in the circle obtained by reﬂecting the cap in its straight sides (right
of Fig. 1). The stem then becomes a slit in the interior of the circle. A MUPO
is any periodic orbit which remains in the cap, but which intersects the circle of
radius r shown on the left of Fig. 1. A MUPO orbit may be rotated around the
circle (showing that these come in continuous families of orbits), however a small
perturbation which changes its rotation number causes it to precess, and eventually
reach the stem, as demonstrated for the orbit shown, which is near a period three
MUPO.

We then use the 2-fold rotational symmetry of the circle and hole, and identify

opposite points. The collision map then corresponds to a circle rotation

Φ(x) = {x + λ}

(3.1)
where πx is arc length and {} denotes fractional part (ie mod 1). The slit cor-
responds to a hole (single due to the symmetry reduction) in the x dynamics of
size

tan

πρ
2

(λ − ρ)1/2 + O(λ − ρ)3/2

π

(3.2)

h =

2
π

arccos

l
r

=

where (recalling Eqs. 1.1, 1.2)

(3.3)

(3.4)

(cid:114) 4

l = cos

r = cos

πλ
2
πρ
2

8

CARL P. DETTMANN

We consider only the chaotic part of the mushroom cap ρ < λ < 1. In continuous
time, the collisions occur at intervals

(3.5)

(cid:112)

τλ = 2

1 − l2 = 2 sin

πλ
2

Here, we are interested in mushrooms without MUPOs. As shown in Refs. [1,
14, 8] this corresponds to a set of r with zero Lebesgue measure with a supremum
at r = 1/

2, described using the Diophantine properties of ρ.

√

3.2. Continued fractions and the three gap theorem. Dynamics in a cir-
cle is described by the three gap theorem [19, 20, 23]; that is, the set {Φi(x)}i=0...N−1
has gaps between adjacent points on the circle of at most three diﬀerent sizes, which
are determined by N and the continued fraction expansion of λ. We follow the ﬁrst
chapter of Ref. [18], extending the notation to the “semiconvergents”: Given a
standard continued fraction for 0 < λ = a0 + 1/(a1 + 1/(a2 + . . .)) = [a0; a1a2 . . .]
containing partial quotients aj ∈ Z, with a0 ≥ 0 (here a0 = 0) and all other aj ≥ 1
we deﬁne B−1 = 0, A−1 = B0 = 1, A0 = a0, Ak = Ak,ak and Bk = Bk,ak with

(3.6)

Ak,i = iAk−1 + Ak−2
Bk,i = iBk−1 + Bk−2

(3.7)
for k ≥ 1 and 1 ≤ i ≤ ak. Then Ak/Bk are the convergents (closest approximants)
to λ and Ak,i/Bk,i = [a0; a1a2 . . . ak−1i] are semiconvergents. The complete quo-
tients are deﬁned as ζk = [ak; ak+1ak+2 . . .] and hence lie between ak and ak + 1.
In terms of these we have for any k ≥ 0,

(3.8)

λ =

Akζk+1 + Ak−1
Bkζk+1 + Bk−1

The diﬀerences are Dk = Dk,ak with

(3.9)

Dk,i = Bk,iλ − Ak,i

= iDk−1 + Dk−2
= (−1)k (ak − i)ζk+1 + 1
Bkζk+1 + Bk−1

using the relation AkBk−1 − Ak−1Bk = (−1)k+1. Thus we can determine the sign
and bound the magnitude of the diﬀerences.

These diﬀerences are plotted in Fig. 4, a union of straight line segments labelled
by coprime postive integers (A, B). Each has x-intercept A/B and gradient B.
The ﬁnal partial quotient of a continued fraction expansion of A/B is ak = i.
Each straight line segment corresponds to two (k, i), even k for D > 0, odd k for
D < 0, and i = 1 for the larger k, corresponding to the two continued fraction
representations of the rational A/B. Each segment extends to values of λ equal to
the truncated continued fractions (Stern-Brocot parents) of A/B.
In our notation, the three gap theorem says that we need to ﬁnd the largest
Bk,i ≤ N . Then there are N − Bk−1 gaps of size |Dk−1|, N − Bk,i gaps of size
|Dk,i| and the remaining Bk−1 + Bk,i − N (possibly zero) gaps are the sum of the
previous two sizes, which comes to |Dk,i−1| (= |Dk−2| if i = 1).

HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

9

Figure 4. The diﬀerences Dk,i as a function of λ.

3.3. Variation of λ. The three gap theorem describes the gaps at ﬁxed λ,
while the initial conditions for the survival probability are at all λ > ρ. So, we
need to describe how the variation in λ aﬀects the relevant part of the continued
fraction expansion, and the length of the relevant part, namely the (k, i) that we
need to consider.

Consider the dynamics at ﬁxed λ. Initially, all gaps are larger than h. Best
approximation is found for the full convergents, so the ﬁrst diﬀerence to decrease
below h must be from a convergent, say |Dk−1| with k now determined by h. The
second will be in the next sequence of semiconvergents, |Dk,i|, possibly the next
convergent (if i = ak). Now, only the largest of the three gaps, namely |Dk,i−1|
remains greater than h. Finally, the next diﬀerence, which is the diﬀerence of these
two, |Dk,i+1| or |Dk+1,1| will also fall below h, leading to complete escape. Thus
we have deﬁned a speciﬁc (k, i) for each λ in a given mushroom (parametrised by
ρ).
Now, the condition for a MUPO can be expressed simply in terms of these
quantities: If there is a λ = A/B such that 0 ≤ h < 1/B the orbit is periodic and
can avoid the hole, so we have a MUPO. In this case, all the diﬀerences Dk,i are
multiples of 1/B and so greater than h. Conversely, if there is at least one nonzero
diﬀerence less than h at all λ ≥ ρ, then no MUPO exists. See Fig. 5.

-1-0.5 0 0.5 1 0 0.2 0.4 0.6 0.8 1Dk,iλ10

CARL P. DETTMANN

(cid:16) 5+

(cid:17)

Figure 5. Close-ups of Fig. 4 showing ±h (the hole size) for
as the parabola-
the known MUPO-free case r = cos
like curve. Note that this value of r barely avoids a MUPO at
λ = 4/7 = 0.571 . . ., since h is only slightly greater than 1/7 at
that point. Also, due to the periodicity of the continued fraction
expansion, the behaviour near the intersection with the x-axis is
self-similar.

√
2
23 π

Transitions in the continued fraction expansion itself take place at rational
λ. However, there is at least one non-zero diﬀerence less than h, which we can
identify as Dk−1. The next to fall below h, Dk,i is a negative multiple of this at
the rational point, so also non-zero. Thus none of the quantities needed to deﬁne
these diﬀerences, k, i or ak−1 have changed across the transition. Furthermore, as
shown in Lemma 5.1 the value of k can only decrease as λ increases. Together, these
show that variations in the continued fraction expansion in λ are never relevant;
the survival probability P (t) may be calculated using the (ﬁxed) expansion of ρ.
|Dk,i| = h and/or |Dk−1| = h. Note that
• Dk,i and h increase with λ.
• Dk,i is linear and h concave in λ.
• Dk,i > 0 iﬀ k is even (see Eq. 3.9).

Transitions in (k, i) as λ varies must therefore correspond only to cases where

-0.2-0.15-0.1-0.05 0 0.05 0.1 0.15 0.2 0.555 0.56 0.565 0.57 0.575Dk,iλ-0.03-0.02-0.01 0 0.01 0.02 0.03 0.5577 0.5578 0.5579 0.558 0.5581 0.5582Dk,iλHOW STICKY IS THE CHAOS/ORDER BOUNDARY?

11

The second point shows that |Dk,i| = h can have at most two solutions. Ac-
tually, as shown in Lemma 5.1, only the solution where h is increasing faster than
Dk,i is relevant, since the other possibility leads to the existence of a MUPO.

Definition 3.1. Incipient MUPO. Transition of both types occurring simulta-

neously, that is, |Dk,i| = |Dk−1| = h.

At the relevant λ, the hole size is exactly the same size as both relevant dif-
ferences. Increasing ρ by an arbitrarily small amount leads to a MUPO, hence the
terminology. At the transition point itself, all orbits at and near this value of λ
escape in ﬁnite time, so there is no eﬀect on the long time survival probability. In
order to satisfy the equation at some rational rotation number A/B , we have

(3.10)

r =

cos π
2
cos π
2

A
B
1
B

Conjecture 3.2. No incipient MUPOs without MUPOs. The above equation

for r is never satisﬁed without the existence of another (real) MUPO.

The equation for an incipient MUPO has a countable number of solutions,
while the condition for the non-existence of a MUPO has (from previous studies) a
zero measure set of solutions. Thus, a probabilistic argument suggests there is no
overlap. In particular, there is no reason to expect the continued fraction expansion
of 2
π arccos r to have bounded even partial quotients, which is a necessary condition
for being MUPO-free. A numerical search does not ﬁnd any solutions, although
there are examples for which the smallest MUPO is rather long. One of the simplest
2 − 1. In this case, the
is λ = 3
shortest MUPO has A/B = 1181/1622.

4 , l = cos 3π

4 , h = 1

2−√

2

8 =

√

, r =

l

cos(π/8) =

2

√

3.4. Survival probability at ﬁxed λ. Now let us calculate the survival
probability, that is, the measure of surviving orbits in the presence of the hole of
size h. For now, the initial conditions have ﬁxed l and hence λ and h but are
otherwise uniformly distributed round the circle. Recall that the condition for a
MUPO is that there is a λ = A/B for which h < 1/B.

Putting the above pieces together, we ﬁnd the survival probability as a function

of collisions:

(3.11) Pλ(N ) =



1 − N h

0

1 − Bk−1h − (N − Bk−1)|Dk−1|
(Bk−1 + Bk,i − N )(|Dk,i−1| − h) Bk,i < N ≤ Bk−1 + Bk,i

Bk−1 < N ≤ Bk,i

N > Bk−1 + Bk,i

N ≤ Bk−1

Note that for moderate h, it is quite possible for the most of the particles to remain
for a long time if ak is large and hence i and Bk,i can be large.

3.5. Integrating over λ. We place initial conditions uniformly in the semi-
circular cap of the mushroom with uniform directions; this corresponds to the equi-
librium invariant measure of the billiard ﬂow: See for example Ref. [10]. Integrating

12

CARL P. DETTMANN

over an arbitrary function of λ, we have

(cid:90)

(3.12)

dφ
2π

(cid:90) 1
(cid:90) 2π
(cid:90) π
(cid:90) 1
f (λ)2 sin2(cid:16) π
(cid:17)
(cid:90)

dθ
π

λ

2

0

0

0

0

f (λ)dµλ

2rdrf

dλ

f (λ)dµ =

=

=

(cid:19)

arccos|r sin(θ − φ)|

(cid:18) 2

π

giving explicitly the associated measure dµλ for λ ∈ (0, 1) ⊂ R. Here, r is radial
distance, θ gives the angular position, φ gives the direction of the particle, hence
the angular momentum is l = |r sin(θ − φ)|.

We further restrict to the chaotic region, l < r or equivalently λ > ρ, which

requires normalisation by a further constant

(cid:90) 1

ρ

2 sin2(cid:16) π

(cid:17)

λ

2

(3.13)

cρ =

Thus, the full survival probability is

(3.14)

P (t) = c−1

ρ

Pλ

dλ = 1 − ρ +

2
π

sin

πρ
2

cos

πρ
2

(cid:90)

(cid:18)

(cid:19)

(cid:99)

(cid:98) t
τλ

dµλ

(cid:90)

(cid:90)

(cid:112)
(cid:90) (cid:18) 2
(cid:104)
(cid:16)

which in principle can be evaluated exactly at ﬁxed t, splitting λ into regions with
diﬀering N = (cid:98)t/τλ(cid:99) (if applicable), and into the diﬀerent regimes of Eq. (3.11),
and noting the integrals
dµλ = λ − 2
π
hdµλ = −
2
π2
− π2
4
+(1 − r2) ln

(cid:19)
r−1e−iπ(λ+h)/2(cid:17)
(cid:16)
(cid:17)
1 − l2(cid:112)

1 − l2
r2 − l2

(cid:112)
(cid:112)

arccos

1 − l2 + C

(cid:19)(cid:18) 4
(cid:112)
r−1eiπ(λ+h)/2(cid:17)
(cid:16)(cid:112)

Li2
(h2 − 2h − 2λ) − πlh
1 − l2 +

r2 − l2

1 − l2

(cid:112)

(3.15)

+ Li2

(cid:105)

+ C

l
r

dl

+

l

π

=

π

where Li2 is the dilogarithm and h and l are the usual functions of λ. We do not
need the explicit form of P (t) for any of our results, however.

4. Proofs of the theorems

Sec. 4.1 shows that the positive ﬁnite limits in Thm. 1.1. Sec. 4.2 uses the
almost piecewise linearity of P (t) to get the explicit bound, completing the proof
of Thm. 1.1. Sec. 4.3 contains the proof of Thm. 1.2.

4.1. Bounds on the survival probability. From this point we assume that
in addition to the MUPO-free condition, the partial quotients of ρ are bounded.
Possible eﬀects of violating this condition were discussed brieﬂy in the introduction.
We have Lemma 5.2 which considers the interval of relevant λ for large t.
In
particular, there is a function λmax(t) satisfying

(4.1)

λmax(t) = ρ + O(t−2)

(cid:16)(cid:98) t

τλ

(cid:99)(cid:17)

HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

13

at large t so that Pλ

= 0 for λ > λmax(t).

The integral for P (t) directly gives an upper bound

(4.2)

To get the equivalent lower bound

P (t) <

Cmax

t2

(4.3)
at suﬃciently large t we note that Pλ(N ) ≥ 1 − N h for all N and integrate until
this vanishes, a region of order t−2. This completes the proof of positive and ﬁnite
limits in Theorem 1.1.

P (t) >

t2

Cmin

4.2. Approximate piecewise linearity. We see from Eq. 3.11 that Pλ(N )
is a piecewise linear function of N . We would like to see whether this applies also
to P (t), which we now approximate. It is easy to see that Eq. 4.1 implies

(4.4)

t
τρ

− t

τλmax

= O(t−1)

that is, there are at most two relevant values of N at suﬃciently long times. From
Eq. 3.11, 0 < Pλ(N ) < 1 and Pλ(N + 1) − Pλ(N ) ≤ h, where h = O(t−1). Putting
this together we see that

(4.5)

where the approximated integral

(4.6)

˜P (t) = c−1

ρ

|P (t) − ˜P (t)| = O(t−3)

(cid:90)

(cid:18)

(cid:19)

Pρ

(cid:99)

(cid:98) t
τρ

dµλ

is piecewise linear with transitions at τρBk,i. This is observed numerically in Fig. 6.
Furthermore, inﬁnitely many transition points are spaced with ratios greater
than the golden ratio, as shown in Lemma 5.3, and a piecewise linear function such
as ˜P (t) with asymptotic form t−2 and transition points with such spacing must have
27 as shown in Lemma 5.4. From above, | ˜P (t) − P (t)| is
a limiting ratio of at least 32
at most of order t−3 and so negligible in the limit, so the result holds for P (t) as
well. This complete the proof of Theorem 1.1.

4.3. Eventually periodic continued fractions. In this ﬁnal section we
prove Theorem 1.2, for which the continued fraction of ρ is eventually periodic.
As shown in standard texts including Ref. [18], this condition is exactly that ρ is a
quadratic irrational.

We can write the recurrence relation Eq. 3.7 as

(4.7)

with

(4.8)

vk =

vk = Akvk−1

(cid:19)
(cid:19)

(cid:18) Bk
(cid:18) ak

Bk−1
1
0

1

(4.9)
so that det Ak = −1. Also, any product of A matrices has only positive entries,
so by the Perron-Frobenius theorem it has a simple positive eigenvalue of strictly
maximal magnitude. Let p be the period of the continued fraction expansion of

Ak =

14

CARL P. DETTMANN

Figure 6. The survival probability is approximately piecewise lin-
ear, with pieces deﬁned by τρBk,i, here represented on the axis by
the nearest integer. As above, we choose r = cos

2

.

√
23 π

(cid:16) 5+

(cid:17)

ρ. All products of 2p consecutive A matrices in the periodic part of the expansion
have unit determinant. They are also cyclic permutations and hence have the same
eigenvalues β > β−1 > 0. Since β and β−1 are the roots of a monic quadratic
polynomial with integer coeﬃcients they are conjugate quadratic irrationals.

Now let k be in the periodic part of the expansion (that is, suﬃciently large,

and ﬁxed). We have

(4.10)

Bk = Ckβ

k

2p + O(β

− k

2p )

where Ck+2p = Ck. Noting Eq. 3.9 and the periodicity of ζk, we ﬁnd

Dk = ˜Ckβ

2p + O(β
− k

−3 k

2p )

(4.11)
where ˜Ck+2p = ˜Ck, and equations with related periodic constants for Bk,i and Dk,i.
This self-similarity of the diﬀerences can be observed in Fig. 5 above.
We now deﬁne t(cid:48) = βmt for some large integer m and large t, and want to
compare ˜P (t(cid:48)) with ˜P (t). We see that the various quantities scale: N(cid:48) = t(cid:48)/τρ =
βmN . For most t, we have (k(cid:48), i(cid:48)) = (k + 2mp, i), so we consider Dk+2pm,i =
β−mDk,i(1 + O(β
p )), equating this with h to ﬁnd the transitions in λ, we have,

− k

 0 0.2 0.4 0.6 0.8 1 80 146 226 306 386 466 85110n P(t)tn=3n=4n=5HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

15

using Eq. 3.2, λ(cid:48)− ρ = β−2m(λ− ρ)(1 +O(β

− k
p )). Thus when (k(cid:48), i(cid:48)) = (k + 2mp, i),

|β2mt2 ˜P (βmt) − t2 ˜P (t)| = O(β

− 2k
p )

(4.12)
The nonsmooth points of ˜P (t) do not exactly scale: From above we have τρBk+2mp,i =
βmτρBk,i(1 + O(β
p )). This means that for t close to a transition point, it is pos-
sible that (k(cid:48), i(cid:48)) (cid:54)= (k + 2mp, i). In this case we consider a value ˜t close to t but
across the transition. We have |˜t − t| = O(β
2p ). Also, t2 ˜P (t) has positive upper
and lower bounds and ˜P (t) is convex, implying that the variation satisﬁes

− k

− k

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ˜P (˜t) − ˜P (t)

˜t − t

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) <

C

min(˜t, t)3

(4.13)

so that Eq. 4.12 is still satisﬁed. Finally we use ˜P (t) to approximate P (t) and take
m → ∞ then k → ∞ to obtain the result of Theorem 1.2.

5. Lemmas and their proofs

Lemma 5.1. Monotonicity of transitions. A diﬀerence becomes relevant only as
λ increases. Precisely, for a MUPO-free r, if there is some (k, i) and λ for which
f (λ) = h − |Dk,i| = 0, then f(cid:48)(λ) > 0 at that point.

Proof. If k is odd, then Dk,i < 0, so both terms in f(cid:48)(λ) are positive and we

are ﬁnished.

In the case k is even, assume that the assertion is false. Then Dk,i continues to
higher λ until it terminates at λ = Ak−1/Bk−1 at which it is equal to 1/Bk−1 using
the equations in Sec. 3.2. Since Dk,i is a linear function of λ and h is concave, f(cid:48)(λ)
remains negative, hence f (Ak−1/Bk−1) < 0. This means that 0 < h < 1/Bk−1
at this point, which would imply that there is a MUPO with rotation number
(cid:3)
Ak−1/Bk−1, a contradiction.

Lemma 5.2. Size of λ interval. For MUPO-free ρ with bounded partial quo-

(cid:16)(cid:98) t

τλ

(cid:99)(cid:17)

tients, Pλ

(5.1)
as t → ∞.

= 0 for λ > λmax(t) where

λmax(t) = ρ + O(t−2)

Proof. Fix a time t > 0 and constant 0 < C1 < t2(1 − ρ). If

(5.2)

we have

(5.3)

λ > ρ +

C1
t2

h >

C2
t

using the expansion of h, Eq. 3.2. Here, C2 is a constant proportional to C1. The
value of k is determined so that |Dk−1| is the ﬁrst diﬀerence to fall below h. In
particular

(5.4)

Equation 1.4.5 of Ref [18] gives

(5.5)

|Dk−2| > h

|Dk−2| ≤ 1
Bk−1

16

CARL P. DETTMANN

Thus we have

(5.6)

Bk−1 <

t
C2

Using the recurrence relation for the Bk, the boundedness of the ak (because there
are no MUPOs we may use the continued fraction expansion of ρ rather than λ)
we have

(5.7)

Bk−1 + Bk,i <

t
C3

with a constant C3 proportional to C2. We also have
t
3

N = (cid:98) t
τλ

− 1 >

(cid:99) >

(5.8)

t
2

since τλ < 2 for all λ and t can be chosen arbitrarily large. If we choose t large
enough, we can choose a large enough C1 < t2(1 − ρ) so that C3 > 3 and we ﬁnd
(cid:3)
from Eq. (3.11) that Pλ(N ) = 0 as required.
Lemma 5.3. Ratio of semiconvergent denominators. For any λ (cid:54)∈ Q, its (in-
ﬁnite) sequence of semiconvergent denominators Bk,i has ratio of successive terms
at least g = 1+
2

inﬁnitely often.

√

5

Proof. We have

Bk,1
Bk−1

=

Bk−1 + Bk−2

Bk−1

= 1 +

Bk−2
Bk−1

= [1; ak−1, . . . , a1]

If λ ∼ g, that is, the ak have a tail consisting only of 1s, we have Bk−2/Bk−1 →

where the ﬁnal equality comes from Ref. [18], section 1.6.
g−1 alternating above and below this value, and we are ﬁnished.

If there are are inﬁnitely many 1s in the partial quotients, any k for which
ak−1 = 1 and ak−2 > 1 will have [1; ak−1, ak−2 . . . , a1] > 5/3 > g and we are
likewise ﬁnished.

If all but a ﬁnite number of partial quotients are greater than 1, instead consider

(for both ak > 1 and ak−1 > 1)

Bk,2
Bk,1

=

2Bk−1 + Bk−2
Bk−1 + Bk+2

= 1 +

1

1 + Bk−2
Bk−1

= [1; 1, ak−1, ak−2, . . . a1] >

5
3

> g

(cid:3)
Lemma 5.4. Minimum variation of piecewise linear functions. Let f : R+ →
R+ be piecewise linear with consecutive transition points ti having ratio at least the
golden ratio inﬁnitely often. If the limits are positive and ﬁnite as t → ∞ then

lim sup t2f (t)
lim inf t2f (t)

≥ 32
27

≈ 1.185 . . .

Proof. According to the assumptions we can ﬁnd inﬁnitely many consecutive
transition points (two of which denoted t1, t2) such that t2/t1 ≥ g. Within such an
interval, writing t2/t1 = G,

t2f (t) = t2 [β − γ(t − t1)]

where

β = f (t1) > 0,

γ = − f (Gt1) − f (t1)
(G − 1)t1

> 0

HOW STICKY IS THE CHAOS/ORDER BOUNDARY?

17

are constant. Possible supremum/inﬁmum points consist of the left and right end-
points, and a turning point:

L = t2

T = t2

1f (t1) = βt2
1
cf (tc) = βt2
1

R = t2

2f (t2) = βt2

(1 + z)3,

(cid:20)
1 − G − 1

4
27z
1G2

z

(cid:21)

if tc = t1

(1 + z) ∈ (t1, Gt1)

2
3

where z = β/(γt1). The turning point is relevant if
− 1

< z <

1
2

3G
2

First we turn to cases where it is not relevant. For z < 1/2 we ﬁnd, using G ≥ g,
that R < 0, which is impossible. For z > 3G/2 − 1 we compute

(cid:20)
1 − G − 1

(cid:21)

z

(cid:20)
1 − G − 1
3G/2 − 1

(cid:21)

> G2

R
L

= G2

=

G3

3G − 2

The derivative of the right hand side is positive for G ≥ g. Thus we conclude

R
L

≥ g3

3g − 2

>

32
27

When the turning point is relevant, we have two cases. When z ≥ G2

as required. This completes the cases where the turning point is not relevant.
R ≥ L, and so the relevant ratio is

G+1 we have

T
L

=

4
27

(1 + z)3

z

≥ 32
27

since we know that z ≥ G2
ratio is

G+1 ≥ g2

g+1 = 1. Conversely, when z ≤ G2

G+1 , the relevant

Diﬀerentiating (and keeping G constant) we have

T
R

=

4
27

(1 + z)3

G2(z + 1 − G)

(cid:18)

(cid:19)2

d
dz

T
R

=

z + 1

G(z + 1 − G)

(2(z + 1) − 3G) < 0

since z < 3G/2− 1 in order for T to be relevant, as above. Thus its minimum value
is obtained at z = G2

G+1 :

4
27
This function is increasing for G ≥ g, thus we ﬁnd

(1 + G2
G+1 + 1 − G)

≥ 4
27

G2( G2

G+1 )3

T
R

=

(G2 + G + 1)3

G2(G + 1)2

T
R

≥ (g2 + g + 1)3

g2(g + 1)2 =

32
27

as required.

(cid:3)

18

CARL P. DETTMANN

References

1. E G Altmann, Intermittent chaos in Hamiltonian dynamical systems, Ph.D. thesis, Wupper-

tal, 2007.

2. Eduardo G Altmann, Adilson E Motter, and Holger Kantz, Stickiness in mushroom billiards,

Chaos 15 (2005), no. 3, 033105.

3. Eduardo Goldani Altmann, T Friedrich, AE Motter, H Kantz, and A Richter, Prevalence of
marginally unstable periodic orbits in chaotic billiards, Phys. Rev. E 77 (2008), no. 1, 016205.
4. Or Alus, Shmuel Fishman, and James D. Meiss, Probing the statistics of transport in the

H´enon map, arxiv:1512.04723 (2015).

5. A B¨acker, R Ketzmerick, S L¨ock, Marko Robnik, Gregor Vidmar, Ruven H¨ohmann, Ulrich
Kuhl, and H-J St¨ockmann, Dynamical tunneling in mushroom billiards, Phys. Rev. Lett. 100
(2008), no. 17, 174103.

6. Alex H Barnett and Timo Betcke, Quantum mushroom billiards, Chaos 17 (2007), no. 4,

043125.

7. Leonid A Bunimovich, Mushrooms and other billiards with divided phase space, Chaos 11

(2001), no. 4, 802–808.

8.

, Fine structure of sticky sets in mushroom billiards, J. Stat. Phys. 154 (2014), no. 1-2,

421–431.

9. Leonid A Bunimovich and Luz V Vela-Arevalo, Many faces of stickiness in Hamiltonian

systems, Chaos 22 (2012), no. 2, 026103.

10. N. I. Chernov and R Markarian, Chaotic billiards, Amer. Math. Soc., Providence, 2006.
11. Giampaolo Cristadoro and Roland Ketzmerick, Universality of algebraic decays in Hamilton-

ian systems, Phys. Rev. Lett. 100 (2008), no. 18, 184101.

12. C Dembowski, H-D Gr¨af, A Heine, R Hoﬀerbert, H Rehfeld, and A Richter, First experimental
evidence for chaos-assisted tunneling in a microwave annular billiard, Phys. Rev. Lett. 84
(2000), no. 5, 867.

13. Carl Dettmann, Open circle maps: small hole asymptotics, Nonlinearity 26 (2013), no. 1,

307.

14. Carl P Dettmann and Orestis Georgiou, Open mushrooms: stickiness revisited, J. Phys. A 44

(2011), no. 19, 195102.

15. Barbara Dietz, T Friedrich, M Miski-Oglu, A Richter, and F Sch¨afer, Spectral properties of

Bunimovich mushroom billiards, Phys. Rev. E 75 (2007), no. 3, 035203.

16. Sean Gomes, Percival’s conjecture for the Bunimovich mushroom billiard, arXiv:1504.07332

(2015).

17. Alastair Robertson, Stickiness in MUPO-free mushroom billiards, Undergraduate project,

University of Bristol (2013).

18. Andrew M Rockett and Peter Sz¨usz, Continued fractions, vol. 47, World Scientiﬁc, 1992.
19. Noel B Slater, Gaps and steps for the sequence nθ mod 1, Mathematical Proceedings of the

Cambridge Philosophical Society, vol. 63, Cambridge Univ Press, 1967, pp. 1115–1123.

20. Vera T S´os, On the distribution mod 1 of the sequence nα, Ann. Univ. Sci. Budapest, E¨otv¨os

Sect. Math 1 (1958), 127–134.

21. Sergei Tabachnikov, Geometry and billiards, Amer. Math. Soc., Providence, 2005.
22. Satoru Tsugawa and Yoji Aizawa, Stagnant motion in Hamiltonian dynamics — Mushroom
billiard case with smooth outermost KAM tori —, J. Phys. Soc. Japan 83 (2014), no. 2,
024002.

23. Tony Van Ravenstein, The three gap theorem (Steinhaus conjecture), J. Austral. Math.

Soc.(Series A) 45 (1988), 360–370.

24. Lei Ying, Guanglei Wang, Liang Huang, and Ying-Cheng Lai, Quantum chaotic tunneling in
graphene systems with electron-electron interactions, Phys. Rev. B 90 (2014), no. 22, 224301.

School of Mathematics, University of Bristol, Bristol BS8 1TW, UK
E-mail address: Carl.Dettmann@bristol.ac.uk

