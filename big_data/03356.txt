A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD

FOR THE RADIATIVE TRANSFER EQUATION

CHENG WANG†, QIWEI SHENG‡, AND WEIMIN HAN§

6
1
0
2

 
r
a

M
 
0
1

 
 
]

Abstract. The radiative transfer equation (RTE) arises in many different areas of science and engineering. In

this paper, we propose and investigate a discrete-ordinate discontinuous-streamline diffusion (DODSD) method

for solving the RTE, which is a combination of the discrete-ordinate technique and the discontinuous-streamline

diffusion method. Different from the discrete-ordinate discontinuous Galerkin (DODG) method for the RTE,

an artificial diffusion parameter is added to the test functions in the spatial discretization. Stability and error

estimates in certain norms are proved. Numerical results show that the proposed method can lead to a more

accurate approximation in comparison with the DODG method.

Key words. radiative transfer equation, discrete-ordinate method, discontinuous-streamline diffusion method,

.

A
N
h
t
a
m

[
 
 

stability, error estimation

AMS subject classifications. 65N30, 65R20

1. Introduction

1
v
6
5
3
3
0

.

3
0
6
1
:
v
i
X
r
a

The radiative transfer equation, which describes the scattering and absorbing of radiation through a

medium, plays an important role in a wide range of applications such as astrophysics, atmosphere and ocean,

heat transfer, neutron transport and nuclear physics, and so on. Today, research on the RTE remains to be

very active and important, especially in the biomedical optics fields, see e.g. [2, 6, 14, 26, 28].

The RTE can be viewed as a hyperbolic type integro-differential equation. Due to the involvement of

both integration and differentiation in the equation, as well as the high dimension of the problem, it is

challenging to develop effective numerical methods for solving the RTE. The numerical methods can be

basically divided into two categories: statistical schemes and deterministic schemes. The interested readers

are referred to [11, 12, 13, 15, 17, 19, 24, 25, 27].

The discrete-ordinate (DO) method [8,22,23], also called the SN method, is the most popular deterministic

method for the RTE, owing to the good compromise among accuracy, flexibility, and moderate computational

requirements. This method solves the radiative transfer equation along a discrete set of angular directions,

which are the nodal points of a numerical quadrature approximating the integral term on the unit sphere,

thus reducing the RTE to a semi-discretized first-order hyperbolic system. To solve the semi-discretized

† Department of Mathematics, Tongji University, Shanghai 200092, China (wangcheng@tongji.edu.cn).
‡ Computational and Applied Mathematics Group, Oak Ridge National Laboratory, Oak Ridge, TN 37831 (shengq@ornl.gov).
§ Department of Mathematics, University of Iowa, Iowa City, IA 52242 (weimin-han@uiowa.edu).

1

2

C. WANG, Q. SHENG, W. HAN

hyperbolic system, it is natural to use the discontinuous Galerkin (DG) discretization, leading to the so-called

discrete-ordinate discontinuous Galerkin method. In [16], a DODG method was proposed for the RTE, and

error estimates in certain discrete norms were obtained.

The object of this paper is to propose and investigate a discrete-ordinate discontinuous-streamline diffusion

method for solving the RTE. Such a method is a combination of the discrete-ordinate technique and the

discontinuous-streamline diffusion (DSD) method. The streamline diffusion (SD) finite element method was

proposed by Hughes et al. [20] and Johnson et al. [21] in order to cope with the usual instabilities caused by

the convection term for the convection–dominated problem. In [3, 4], the streamline diffusion finite element

method was analyzed for the multi-dimensional Vlasov-FokkerPlanck system and Fermi pencil beam equation.

The DSD method keeps the fundamental structure of the DG method while replacing the Galerkin elements

by the SD framework in the upwind iteration procedure. In [9], the DSD method was employed successfully

in solving first order hyperbolic problems, where such a modification preserves the advantages of both the

upwind approach and the DG method, and also further improves the stability. In this contribution, we seek

to improve the DG method for RTE by employing the DSD scheme and derive error estimates of the DODSD

method in a norm including the directional gradient. While the DSD approach has been developed and

applied to hyperbolic systems or convection–dominated problems, this paper represents the first attempt,

to our knowledge, to construct DSD schemes for the RTE. Our numerical results show that the DODSD

method can lead to a more accurate solution in comparison with the DODG method.

The rest of this paper is organized as follows. In Section 2, we introduce the RTE and recall a few basic

related results. In Section 3, we derive the discrete-ordinate discontinuous-streamline diffusion method, and

in Section 4 we present a stability and convergence analysis for the proposed method. Numerical examples

are presented in Section 5, illustrating the performance of the numerical method and providing numerical

evidence of the theoretical error estimates. Finally, a few concluding remarks are given in Section 6.

Throughout this paper, standard notation is used for Sobolev spaces, and the corresponding semi-norms

and norms [10]. Moreover, the letter C denotes a generic positive constant whose value may be different at

different occurrences.

2. Radiative transfer equation

Let X be a bounded domain in Rd (d = 2, 3) with a smooth boundary ∂X. Denote by n(x) the unit
outward normal for x ∈ ∂X. Let Ω be the angular space, i.e., the unit circle in R2, or the unit sphere in R3.
For each fixed direction ω ∈ Ω, we introduce the following subsets of ∂X:

∂Xω,− = {x ∈ ∂X : ω · n(x) < 0},

∂Xω,+ = {x ∈ ∂X : ω · n(x) ≥ 0}.

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

3

Then, we define

Γ− = {(x, ω) : x ∈ ∂Xω,−, ω ∈ Ω}, Γ+ = {(x, ω) : x ∈ ∂Xω,+, ω ∈ Ω}

as the incoming and outgoing boundaries.

We define the integral operator S by

(Su)(x, ω) =

(cid:90)

Ω

g(x, ω · ˆω)u(x, ˆω)dσ( ˆω),

where g is a nonnegative normalized phase function satisfying

(cid:90)

(2.1)

g(x, ω · ˆω)dσ( ˆω) = 1 ∀ x ∈ X, ω ∈ Ω.

In most applications, the function g is independent of x. As an example, a commonly used phase function is

Ω

the following Henyey-Greenstein (H-G) function:

(2.2)

g(t) =



1−η2
1−η2

2π(1+η2−2ηt)
4π(1+η2−2ηt)3/2

d = 2,

d = 3,

where the parameter η ∈ (−1, 1) is the anisotropy factor of the scattering medium. Note that η = 0 for
isotropic scattering, η > 0 for forward scattering, and η < 0 for backward scattering.

With the above notation, a boundary value problem of the radiative transfer equation (RTE) reads

(2.3)

(2.4)

ω · ∇u(x, ω) + σt(x)u(x, ω) = σs(x)(Su)(x, ω) + f (x, ω),

u(x, ω) = 0,

(x, ω) ∈ X × Ω,
(x, ω) ∈ Γ−.

Here σt = σa + σs, σa is the macroscopic absorption cross section, σs is the macroscopic scattering cross

section, and f is a source function. We assume these given functions have the properties that

(2.5)

(2.6)

σt, σs ∈ L∞(X), σs ≥ 0 a.e. in X, and σt − σs ≥ c0 in X for a constant c0 > 0,
f (x, ω) ∈ L2(X × Ω) and is a continuous function with respect to ω ∈ Ω.

It is shown in [1] that the problem (2.3)–(2.4) has a unique solution u ∈ H 1

2 (X × Ω), where

2 (X × Ω) := {v ∈ L2(X × Ω) : ω · ∇v ∈ L2(X × Ω)}
H 1

with ω · ∇v denoting the generalized directional derivative of v in the direction ω.

4

C. WANG, Q. SHENG, W. HAN

3. A discrete-ordinate discontinuous-streamline diffusion method

In this section, a discrete-ordinate discontinuous-streamline diffusion method is presented for solving

the radiative transfer problem (2.3)–(2.4). The numerical scheme is formed in two steps: First, we use

the discrete-ordinate method to approximate the integral term in the RTE, resulting in a system of linear

hyperbolic partial differential equations. Then these coupled linear hyperbolic equations are further discretized

by the discontinuous-streamline diffusion method.

3.1. Angular discretization. To approximate the integration term Su, we employ a numerical quadrature

of the form

(3.1)

(cid:90)

F (ω)dσ(ω) ≈ L(cid:88)

wlF (ωl), wl > 0, ωl ∈ Ω, 0 ≤ l ≤ L,

Ω

l=0

where F is a continuous function over the unit sphere Ω.

3.1.1. Quadrature scheme in the two-dimensional (2D) domain. Introduce the spherical coordinate system

(3.2)

ω = (cos θ, sin θ)T ,

0 ≤ θ ≤ 2π.

Noting that dσ(ω) = dθ holds for the coordinate system (3.2), we have

(cid:90) 2π

F (ω)dσ(ω) =

Ω

0

¯F (θ) dθ,

(cid:90)

(cid:32)

(cid:32)

L−1(cid:88)

L−1(cid:88)

i=1

where ¯F stands for the representation of F in the spherical coordinates.

One possible quadrature scheme for the above integral is the composite trapezoidal formula

¯F (θ) dθ ≈ hθ
2

¯F (θ0) +

2 ¯F (θi) + ¯F (θL)

:=

wi ¯F (θi),

i=1

i=0

where {θi} are evenly spaced on [0, 2π] with a spacing hθ = 2π/L, i.e., θi = ihθ, w0 = wL = hθ
for 1 ≤ i ≤ L − 1. It is known that (see, e.g. [5])

2 , and wi = hθ

(cid:33)

L(cid:88)

(cid:33)

(cid:90) 2π

0

(cid:90) 2π

0

(3.3)

(3.4)

¯F (θ) dθ − hθ
2

¯F (θ0) +

2 ¯F (θi) + ¯F (θL)

= − πh2
6

θ

¯F (cid:48)(cid:48)(θ).

3.1.2. Quadrature scheme in the three-dimensional (3D) domain. Introduce the spherical coordinate system

(3.5)

ω = (sin θ cos ψ, sin θ sin ψ, cos θ)T ,

0 ≤ θ ≤ π, 0 ≤ ψ ≤ 2π.

Then we have dσ(ω) = sin θdθdψ. By using the spherical coordinate system (3.5), we obtain

(cid:90)

(cid:90) 2π
(cid:90) π

F (ω) dσ(ω) =

Ω

0

0

¯F (θ, ψ) sin θdθdψ.

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

5

One family of quadratures for the above integral is given by the product numerical integration formulas.

For example,

(3.6)

(cid:90)

Ω

F (ω)dσ(ω) ≈ π
m

2m(cid:88)

m(cid:88)

j=1

i=1

wi ¯F (θi, ψj),

where {θi} are chosen so that {cos θi} and {wi} are the Gauss-Legendre nodes and weights on [−1, 1]. The
points {φj} are evenly spaced on [0, 2π] with a spacing of π/m. Regarding the accuracy of the quadrature
(3.6), we have (see, e.g. [18])

(cid:90)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

F (ω) dσ(ω) − L(cid:88)

Ω

l=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ csn−s(cid:107)F(cid:107)s,Ω ∀ F ∈ H s(Ω), s > 1,

wlF (ωl)

(3.7)

where cs is a positive constant depending only on s, and n denotes the degree of precision of the quadrature.

3.1.3. Discrete-ordinate method. Based on the numerical quadrature (3.1), the integral operator S is approx-

imated by a discretized operator Sd given by

(3.8)

Sdu(x, ω) =

L(cid:88)

i=0

wig(x, ω · ωi)u(x, ωi).

For later analysis, we define

(3.9)

L(cid:88)

i=0

m(x) = max
0≤l≤L

wig(x, ωl · ωi).

In the 2D case, if g(x, t) is continuous in x ∈ X and twice continuously differentiable with respect to
t ∈ [−1, 1], then we get from (3.4) and (2.1) that

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)1 − L(cid:88)

i=0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ O(h2

θ).

wig(x, ωl · ωi)

(3.10)

This implies

(3.11)
Therefore, for hθ sufficiently small, there exists a positive constant c(cid:48)
θ)σs ≥ c0 − O(h2

σt − m(x)σs ≥ σt − σs − O(h2

(3.12)

(cid:107)m(x)(cid:107)0,∞,X ≤ 1 + O(h2
θ).

0 satisfying

θ)σs ≥ c(cid:48)

0 ∀ x ∈ X.

In the 3D case, if g(x, ωl·) is an H s(Ω) (s > 1) function for any fixed x ∈ X and ωl ∈ Ω, then we get

from (3.7) and (2.1) that

(3.13)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)1 − L(cid:88)

i=1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ csn−s(cid:107)g(ωl·)(cid:107)s,Ω.

wlg(ωl · ωi)

This also implies that (cid:107)m(x)(cid:107)0,∞,X ≈ 1 and (3.12) holds in the 3D case when a high-order quadrature rule
is used.

6

C. WANG, Q. SHENG, W. HAN

Remark 3.1. Numerical tests are provided in [16] to demonstrate that (3.13) holds for the Henyey-Greenstein

phase function (2.2).

Using the operator Sd, we can discretize the radiative transfer equation (2.3)–(2.4) in each angular direction

ωl to get

(3.14)

ωl · ∇ul + σtul = σs

L(cid:88)

i=0

wig(·, ωl · ωi)ui + fl

in X,

ul = 0 on ∂l−X,

0 ≤ l ≤ L,

where fl = f (x, ωl) and ul = ul(x) is an approximation of u(x, ωl). Here and below, we use the simplified
notation ∂l±X := ∂Xωl,±.

Remark 3.2. Note that the Henyey-Greenstein function (2.2) is smooth for η < 1. Formally, η = 1

corresponds to the case where there is no scattering among different directions and (Su)(x, ω) = u(x, ω). As

a result, the system (3.14) is reduced to a set of uncoupled first order transfer equations, which can be solved

easily, and the analysis is the same as that for a single transfer equation.

3.2. Spatial discretization. After the angular discretization, the RTE is reduced to a system of first-order

hyperbolic partial differential equations in space. Now we discretize (3.14) by the discontinuous-streamline

diffusion method.

Let {Th}h be a regular family of finite element partitions of X, h being the mesh size parameter. Denote
by nK the unit outward normal to ∂K for K ∈ Th. Let Ei
h be the set of all interior boundaries (faces for
d = 3 or edges for d = 2) of Th. For any positive integer k, let Pk(K) be the set of all polynomials on K of a

total degree no more than k.

For a fixed direction ωl, we define the incoming and outgoing boundaries of K ∈ Th by

∂l−K = {x ∈ ∂K : ωl · n(x) < 0},

+K = {x ∈ ∂K : ωl · n(x) ≥ 0}.
∂l

We remark that each edge of an element K ∈ Th is either an incoming boundary or an outgoing boundary.
e pointing from

h, where the normal direction nl

Let Kl
Kl− to Kl

+ and Kl− be two adjacent elements sharing e ∈ Ei
+ satisfies ω · nl

e ≥ 0 (cf. Figure 1). For a scalar-valued function v, we define

+ = v|Kl
vl

+

,

vl− = v|Kl−, and [vl] = vl

+ − vl− on e.

For any domain D ⊆ X with boundary ∂D (resp. ∂l±D) , let (·,·)D and (cid:104)·,·(cid:105)∂D (resp. (cid:104)·,·(cid:105)∂l±D) be the L2
inner product on D and on ∂D (resp. ∂l±D).

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

7

e

K l
+

K l−

nl
e

ωl

Figure 1. An example of Kl−, Kl

+, and nl

e in 2D

Using the above notation, the DODG method, which has been developed in [16], is to find ul

h ∈ Pk(K)

such that for any K ∈ Th, 0 ≤ l ≤ L,

(cid:16)

ωl · ∇ul

h + σtul

(cid:32)

h, vl
h

L(cid:88)

(cid:17)

(cid:68)

+

K

[ul

h], vl

+|ωl · n|(cid:69)

(cid:33)

∂l−K

=

σs

wig(·, ωl · ωi)ui

h + fl, vl
h

∀ vl

h ∈ Pk(K)

i=0

K

ul− = 0

on ∂l−K ⊂ ∂l−X.

(3.15)

with

(3.16)

(3.17)

with

(3.18)

We now replace the Galerkin elements in the above DODG formulation (3.15) by the SD framework, and

add an artificial diffusion term in the test function. Then the discrete-ordinate discontinuous-streamline
h ∈ Pk(K) such that for any K ∈ Th,

diffusion (DODSD) method can be described as follows: to find ul
0 ≤ l ≤ L,

(cid:16)

ωl · ∇ul

h + σtul

(cid:32)

h, vl

h + δ ωl · ∇vl
L(cid:88)

wig(·, ωl · ωi)ui

h

=

σs

(cid:17)

(cid:68)

+

K

[ul

h], vl

+|ωl · n|(cid:69)

(cid:33)

∂l−K

h + fl, vl

h + δ ωl · ∇vl

h

∀ vl

h ∈ Pk(K)

i=0

K

ul− = 0

on ∂l−K ⊂ ∂l−X.

Here δ = ¯c h is an artificial diffusion parameter with some ¯c > 0 and vl± := (vl

h)±.

Obviously, the DODG method is the special case of the DODSD method with δ = 0. The effect of adding

the diffusion parameter will be analyzed in the next section, and illustrated by some numerical results in

Section 5.2.

8

C. WANG, Q. SHENG, W. HAN

4. Error analysis

In order to analyze the proposed DODSD method, we first present the global formulation of the discrete

method (3.17)–(3.16). Associated with a direction ωl, we define

(4.1)

h = {v ∈ L2(X) : v|K ∈ Pk(K) ∀ K ∈ Th},
V l
W l

h =(cid:8)w ∈ L2(X) : w|K ∈ C(K) ∩ H 1(K) ∀ K ∈ Th

(cid:9) .

(4.2)

Letting Vh =(cid:0)V l

(cid:1)L+1 and Wh :=(cid:0)W l

(cid:1)L+1, we have Vh ⊂ Wh. A generic element in Vh will be denoted by

The global formulation of the DODSD method (3.17)–(3.16) is then expressed as: Find {ul

h} ∈ Vh such

h + σtul

h, vl

h + δ ωl · ∇vl

h

+|ωl · n|(cid:69)

[ul

h], vl

∂l−K

(cid:17)

K

L(cid:88)

(cid:88)

+

wl

l=0

K∈Th
h + δ ωl · ∇vl

h

(cid:68)
(cid:33)

=

wl

σs

wig(·, ωl · ωi)ui

h + fl, vl

∀{vl

h} ∈ Vh

h

h}.

h

l=0 or simply vh := {vl
h}L
L(cid:88)

(cid:16)

ωl · ∇ul

wl

l=0

(cid:32)

(cid:88)

K∈Th

L(cid:88)

i=0

(cid:88)
L(cid:88)

K∈Th

l=0

vh := {vl

that

(4.3)

with

(4.4)

We define a bilinear form ah : Wh × Wh → R as

ah(uh, vh) =

K

(cid:17)

K

wl

ωl · ∇ul

ul− = 0 on ∂l−K ⊂ ∂l−X, 0 ≤ l ≤ L.
(cid:16)
(cid:88)
L(cid:88)
(cid:88)
L(cid:88)
(cid:88)
− L(cid:88)

+|ωl · n|(cid:69)
L(cid:88)

wig(·, ωl · ωi)ui

(cid:68)
(cid:32)

h + σtul

K∈Th

[ul

h], vl

K∈Th

h, vl

∂l−K

wl

wl

σs

l=0

l=0

+

h, vl

h + δωl · ∇vl

h

K∈Th

L(cid:88)

l=0

wl

i=0

(cid:88)

(cid:16)

K∈Th

fl, vl

h + δ ωl · ∇vl

h

h

h + δ ωl · ∇vl
(cid:17)

.

K

(cid:33)

K

and a linear form f : Wh → R by

l=0

f (vh) =

Then we rewrite the DODSD method for the problem (2.3)–(2.4): Find uh ∈ Vh such that

(4.5)

with

(4.6)

ah(uh, vh) = f (vh) ∀ vh ∈ Vh,

[ul

h] = ul

+ on ∂l−K ⊂ ∂l−X, 0 ≤ l ≤ L.

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

9

4.1. Stability and unique solvability. We begin with a useful lemma.

Lemma 4.1. For any vh = {vl

h} ∈(cid:0)L2(Ω)(cid:1)L+1, we have

L(cid:88)

l=0

(cid:32)
h}, wh = {wl
L(cid:88)
(cid:34) L(cid:88)

(cid:16)

σs

i=0

wl

≤

wl

mσsvl

h, vl
h

l=0

wig(·, ωl · ωi)vi

h, wl
h

(cid:17)

(cid:35) 1

2

.

X

mσswl

h, wl
h

I :=

wl

wig(·, ωl · ωi)vi

h, wl
h

σswlg(·, ωl · ωi)vi

h, wl
h

.

X

Proof. Interchanging the order of summation, we have

L(cid:88)

l=0

(cid:32)

σs

L(cid:88)
(cid:34) L(cid:88)

i=0

I ≤ L(cid:88)

wi

i=0

l=0

Using the Cauchy-Schwarz inequality, we get

(4.7)

It follows from the definition (3.9) that

l=0

h, vi
h

(cid:1)
(cid:0)σswlg(·, ωl · ωi)vi
L(cid:88)
(cid:0)σswlg(·, ωl · ωi)vi
(cid:34) L(cid:88)
(cid:16)
(cid:3) 1
(cid:2)(cid:0)mσsvi
(cid:35) 1
2(cid:34) L(cid:88)
(cid:0)mσsvi
2(cid:34) L(cid:88)
(cid:35) 1
(cid:16)

(cid:1)
(cid:1)
(cid:17)

h, vi
h

h, vi
h

i=0

l=0

X

X

2

wi

i=0

I ≤ L(cid:88)
(cid:34) L(cid:88)
(cid:34) L(cid:88)

≤

i=0

≤

wi

(cid:17)
(cid:35) 1

2

(cid:17)

σswlg(·, ωl · ωi)wl

h, wl
h

.

X

(cid:1)

X .

h, vi
h

(cid:35) 1

2

(cid:17)

X

(cid:35) 1

2

(cid:17)

X

σswlg(·, ωl · ωi)wl

h, wl
h

(cid:16)

L(cid:88)
(cid:16)

l=0

wi

σswlg(·, ωl · ωi)wl

h, wl
h

(cid:35) 1

2

(cid:17)

(cid:17)
(cid:33)

X

X

l=0

wl

(cid:16)

(cid:16)

L(cid:88)

(cid:33)
(cid:35) 1
2(cid:34) L(cid:88)
L(cid:88)
(cid:35) 1
2(cid:34) L(cid:88)
(cid:1)
X ≤(cid:0)mσsvi

(cid:16)

wi

i=0

l=0

l=0

=

X

X

h, vi
h

Therefore, a combination of the inequality (4.7) and the Cauchy-Schwarz inequality leads to

wi

mσsvi

h, vl
h

wl

mσswi

h, wl
h

X

l=0

,

X

(cid:3)

which completes the proof of the lemma.

i=0

For any vh ∈ Wh, we define a norm ||| · ||| by

|||vh|||2 =

(cid:88)

K∈Th

L(cid:88)

l=0

+ δ

wl

L(cid:88)

l=0

0(cid:107)vl
c(cid:48)
(cid:88)

wl

K∈Th

L(cid:88)

l=0

wl

h(cid:107)2

0,K +

(cid:107)ωl · ∇vl

h(cid:107)2

0,K +

(cid:88)
L(cid:88)

wl

(cid:68)
(cid:69)
vl−, vl−ωl · n
h]|ωl · n|(cid:69)
(cid:68)
(cid:88)

h], [vl

∂l
+K

[vl

+K⊂∂l
∂l

+X

l=0

K∈Th

.

∂l−K

We remark that [vl

h] = vl

+ on ∂l−K ⊂ ∂l−X, l = 0,··· , L.

Then we prove a stability estimate for the method (4.5)–(4.6).

10

C. WANG, Q. SHENG, W. HAN

Lemma 4.2. For sufficiently small h, we have

|||vh|||2 ≤ 3ah(vh, vh) ∀ vh ∈ Wh.

Proof. Noting that ωl is a constant vector, we get from the Green formula that

(ωl · ∇vh, vh)K = − (vh, ωl · ∇vh)K + (cid:104)vh, vhωl · n(cid:105)∂K =

1
2

(cid:104)vh, vhωl · n(cid:105)∂K .
(cid:17)

σtvl

h, vl
h

K

+ I1 + I2 + I3 + I4,

(cid:88)

(cid:16)

K∈Th

wl

By the Cauchy-Schwarz inequality, we get

(4.8)

Thus,

where

L(cid:88)

wl

ah(vh, vh) =

(cid:88)

l=0

K∈Th

l=0

l=0

l=0

l=0

wl

wl

wl

wl

I1 =

I2 =

L(cid:88)
L(cid:88)
I3 = − L(cid:88)
I4 = − L(cid:88)
 L(cid:88)
(cid:16)
(cid:88)
(cid:88)
L(cid:88)
(cid:18)
(cid:18)
(cid:88)
(cid:18) 1

(cid:68)
(cid:68)

− 1
2

− 1
2

K∈Th

K∈Th

(cid:68)

(cid:68)

1
2

+X

wl

wl

+K⊂∂l
∂l

l=0

l=0

δ

vl
+, vl

vl
+, vl

[vl

h], [vl

≤ 1
2

(cid:88)
(cid:88)

K∈Th

K∈Th

wl

(cid:88)

K∈Th

2

|I1| ≤

wl

l=0

L(cid:88)
L(cid:88)
L(cid:88)
L(cid:88)

l=0

l=0

+

wl

wl

l=0

I2 =

=

=

A simple calculation yields

h

l=0

h(cid:107)2

0,K +

h, ωl · ∇vl

L(cid:88)
(cid:17)
(cid:69)
hωl · n
L(cid:88)
L(cid:88)

i=0

h, vl
vl

δ (cid:107)ωl · ∇vl

δ σtvl

K∈Th

(cid:16)
(cid:88)
(cid:18) 1
(cid:68)
(cid:88)
(cid:32)
(cid:88)
(cid:32)
(cid:88)

K∈Th

2

K∈Th

σs

σs

K∈Th

i=0

wig(·, ωl · ωi)vi

h, vl
h

wig(·, ωl · ωi)vi

,

K

∂K

(cid:68)

+

(cid:19)

,

∂l−K

+|ωl · n|(cid:69)
(cid:33)

[vl

h], vl

,

K

(cid:33)

.

K

h

h, δωl · ∇vl
(cid:16)
(cid:16)

(cid:88)
(cid:88)

K∈Th

δ ωl · ∇vl

δ ωl · ∇vl

h, ωl · ∇vl

(cid:17)
(cid:17)

K

K

 1
2 L(cid:88)
L(cid:88)

l=0

+

1
2

l=0

wl

wl

K∈Th

(cid:68)
(cid:69)
vl−, vl−ωl · n
(cid:68)
vl−, vl− |ωl · n|(cid:69)

+

+

1
2

1
2

+

∂l
+K

2

.

h

h

K

 1

(cid:17)
(cid:17)
+|ω · n|(cid:69)
+|ω · n|(cid:69)

K

h, ωl · ∇vl
(cid:68)

[vl

h], vl

(cid:68)

(cid:19)

(cid:19)

∂l−K

∂l−K

+

∂l−K

[vl

h], vl

∂l
+K

(cid:19)

+

∂l−K

L(cid:88)

l=0

wl

(cid:88)

+K⊂∂l
∂l

+X

(cid:68)

vl−, vl− |ωl · n|(cid:69)

1
2

,

∂l
+K

δ σtvl

h, σtvl
h

σtvl

h, σtvl
h

(cid:16)
+ |ωl · n|(cid:69)
+ |ωl · n|(cid:69)
vl−, vl− |ωl · n|(cid:69)
h]|ωl · n|(cid:69)

∂l−K

∂l−K

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

11

Using Lemma 4.1, we get

where the condition that vl− = 0 on ∂l−K ⊂ ∂l−X is used.
(cid:16)
|I3| ≤ L(cid:88)
(cid:88)
2 L(cid:88)
 1
(cid:17)
(cid:17)

 L(cid:88)
L(cid:88)

|I4| ≤

mσsvl

K∈Th

h, vl
h

and

wl

wl

wl

l=0

l=0

l=0

K

mσsvl

h, vl
h

+

4
3

δ

1
2

≤ 1
2

2
3

δ

l=0

Combining the above inequalities, we have

wl

(cid:16)

K∈Th

K∈Th

(cid:16)
(cid:88)
(cid:88)
(cid:18) 1
(cid:16)
(cid:88)
(cid:18)(cid:18)
(cid:88)
(cid:18) 1
(cid:88)

K∈Th

2

δ

K∈Th

2

K∈Th

wl

wl

ah(vh, vh) ≥ L(cid:88)
L(cid:88)
L(cid:88)

l=0

l=0

+

+

wl

l=0

K

(cid:17)

1 − δ

1

3 mσs

ωl · ∇vl

σt − 1
2

(cid:68)

δ σ2

t − (1 + δ

h]|ωl · n|(cid:69)

[vl

h], [vl

(cid:17)

K

mσsvl

h, vl
h

(cid:88)
L(cid:88)

K∈Th

wl

l=0

(cid:16)

(cid:16)
(cid:88)
(cid:19)

K∈Th

K

(cid:19)

h

h, ωl · ∇vl
(cid:19)
L(cid:88)

(cid:19)

3 )mσs

2

+

∂l−K

vl
h, vl
h

wl

l=0

(cid:17)

K

2

 1
(cid:17)

mσsδ2ωl · ∇vl

h, ωl · ∇vl

h

mσsωl · ∇vl

h, ωl · ∇vl

h

.

K

K

(cid:88)

+K∈∂l
∂l

+X

(cid:68)
vl−, vl− |ωl · n|(cid:69)

1
2

.

∂l
+K

(cid:3)

Then the lemma can be obtained by taking a sufficiently small h.

The unique solvability of the method (4.5)–(4.6) is a direct consequence of the above lemma.

Theorem 4.3. For sufficiently small h, the DODSD method (4.3) has a unique solution.

4.2. Error estimate. For any K ∈ Th, let PK be the orthogonal projection operator from L2(K) onto
Pk(K). Then by the scaling argument and the trace theorem we can easily obtain the following result (cf. [7]).
Lemma 4.4. For all v ∈ H 1+r(K) with r > 0 and K ∈ Th, we have

(cid:107)v − PKv(cid:107)0,K + hK(cid:107)v − PKv(cid:107)1,K + h

1
2

K(cid:107)v − PKv(cid:107)0,∂K ≤ Ch1+min{r,k}

K

(cid:107)v(cid:107)r+1,K.

For later analysis, we make a regularity assumption:

(4.9)

for some r > 0, ul ∈ H 1+r(X) ∩ C(X), 0 ≤ l ≤ L.

Theorem 4.5. Let {ul} and uh be the solutions of (3.14) and (4.5)–(4.6), respectively. Under assumptions
(2.5) and (4.9), we have, for all sufficiently small h,

(4.10)

|||{ul} − uh||| ≤ C1hmin{r,k}+ 1

2

(cid:107)ul(cid:107)r+1,X

.

(cid:33) 1

2

(cid:32) L(cid:88)

l=0

12

C. WANG, Q. SHENG, W. HAN

Proof. By the regularity assumption (4.9), we have

(4.11)

= 0 ∀{vl

h} ∈ Vh.

Subtracting the above equality from (4.5), we obtain the Galerkin orthogonality

(4.12)

ah

= 0 ∀{vl

h} ∈ Vh.

ah

(cid:16){ul},{vl
h}(cid:17)
(cid:16){ul} − uh,{vl
h}(cid:17)

Let Ph denote the L2-orthogonal operator onto V l

h, 0 ≤ l ≤ L, in an elementwise way, i.e., for v ∈ L2(X),

let

Set

Phv|K := PKv ∀ K ∈ Th.

ηl = ul − Phul,
Note that el−|∂l−K = 0 for each ∂l−K ⊂ ∂l−X.

ξl = Phul − ul

h, and el = ul − ul
h.

From Lemma 4.2 and the Galerkin orthogonality (4.12), we have

(4.13)

|||{el}|||2 ≤ 3ah

(cid:16){el},{el}(cid:17)

(cid:16){el},{ηl}(cid:17)

.

= 3ah

On the other hand, by the definition of the bilinear form ah(·,·), we have

ah

= I1 + I2 + I3 + I4 + I5,

(4.14)

where

I1 =

I2 =

I3 =

I4 =

I5 =

l=0

l=0

L(cid:88)
L(cid:88)
L(cid:88)
L(cid:88)
L(cid:88)

l=0

l=0

l=0

wl

wl

wl

wl

wl

,

K

(cid:16){el},{ηl}(cid:17)
ωl · ∇el, ηl(cid:17)
(cid:16)
(cid:88)
(cid:16)
ωl · ∇el, ωl · ∇ηl(cid:17)
(cid:88)
(cid:16)
σtel, ηl + δ ωl · ∇ηl(cid:17)
(cid:88)
(cid:32)
L(cid:88)
(cid:88)
+|ωl · n|(cid:69)
(cid:68)
(cid:88)

[el], ηl

σs

i=0

δ

.

K∈Th

K∈Th

K∈Th

K∈Th

∂l−K

K∈Th

,

K

K

wig(x, ωl · ωi)ei, ηl + δ ωl · ∇ηl

(cid:33)

,

K

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

13

By using the Cauchy-Schwarz inequality, Young’s inequality, and Lemma 4.4, we get

(4.15)

(4.16)

(4.17)

(4.18)

and

(4.19)

wl

wl

wl

l=0

l=0

l=0

l=0

|I1| ≤ L(cid:88)
≤ L(cid:88)
≤ L(cid:88)
|I2| ≤ L(cid:88)
≤ L(cid:88)
≤ L(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)

K∈Th

K∈Th

K∈Th

wl

l=0

l=0

K∈Th

l=0

l=0

l=0

wl

wl

|I3| ≤ L(cid:88)
≤ L(cid:88)
≤ L(cid:88)
 L(cid:88)
(cid:88)
≤ L(cid:88)
(cid:88)
≤ L(cid:88)
|I5| ≤ L(cid:88)
≤ L(cid:88)

K∈Th

K∈Th

wl

wl

wl

l=0

l=0

l=0

l=0

l=0

(cid:19)

,

δ−1(cid:107)ul(cid:107)2

r+1,K

(cid:107)ωl · ∇el(cid:107)0,K(cid:107)ul(cid:107)r+1,K

K

0,K + Ch2+2 min{r,k}
(cid:17)

δ (cid:107)ωl · ∇el(cid:107)0,K(cid:107)ωl · ∇ηl(cid:107)0,K

(cid:107)ωl · ∇el(cid:107)0,K(cid:107)ul(cid:107)r+1,K

K

6

wl

K∈Th

K∈Th

K∈Th

K∈Th

δ (cid:107)ωl · ∇el(cid:107)2

Ch1+min{r,k}

(cid:107)ωl · ∇el(cid:107)0,K(cid:107)ηl(cid:107)0,K

(cid:88)
(cid:88)
(cid:18) 1
(cid:88)
(cid:16)
(cid:88)
(cid:88)
(cid:88)
(cid:16)(cid:107)σtel(cid:107)0,K(cid:107)ηl + δ ωl · ∇ηl(cid:107)0,K
(cid:18) 1
(cid:18) 1

(cid:16)(cid:107)ηl(cid:107)2
(cid:16)

δ (cid:107)ωl · ∇el(cid:107)2

δ hmin{r,k}

0(cid:107)el(cid:107)2
c(cid:48)

(cid:18) 1

0,K + C

K∈Th

K∈Th

wl

wl

6

6

K

0(cid:107)el(cid:107)2
c(cid:48)

0,K + C

6

(cid:17)

0,K + δ (cid:107)ωl · ∇ηl(cid:107)2

0,K

0,K + Ch2 min{r,k}

K

δ (cid:107)ul(cid:107)2

r+1,K

(cid:19)

,

h2+2 min{r,k}

K

(cid:107)ul(cid:107)2

r+1,K + δ h2 min{r,k}

K

(cid:17)(cid:19)

,

(cid:107)ul(cid:107)2

r+1,K

(cid:17)(cid:19)

 1

2

(cid:17)

|I4| ≤ C

(cid:107)el(cid:107)2

0,K

(cid:107)ηl + δ ωl · ∇ηl(cid:107)2

0,K

0(cid:107)el(cid:107)2
c(cid:48)

0,K + C

0,K + δ (cid:107)ωl · ∇ηl(cid:107)2

0,K

0,K + C

h2+2 min{r,k}

(cid:107)ul(cid:107)2

r+1,K + δ h2 min{r,k}

K

(cid:17)

(cid:107)ul(cid:107)2

r+1,K

l=0

l=0

wl

wl

K∈Th

K∈Th

 1
2 L(cid:88)
(cid:88)
(cid:16)(cid:107)ηl(cid:107)2
(cid:88)
L(cid:88)
(cid:16)
(cid:88)
L(cid:88)
(cid:68)
[el], [el]|ωl · n|(cid:69)
(cid:68)
[el], [el]|ωl · n|(cid:69)

K∈Th

∂l−K

wl

l=0

K

∂l−K

1
6

1
6

0(cid:107)el(cid:107)2
c(cid:48)
(cid:88)
(cid:88)

K∈Th

(cid:18) 1
(cid:18) 1

6

K∈Th

6

wl

wl

(cid:68)

+|ωl · n|(cid:69)

ηl
+, ηl

∂l−K

+ C

+ Ch1+2 min{r,k}

(cid:107)ul(cid:107)2

K

r+1,K

.

(cid:19)
(cid:19)

14

C. WANG, Q. SHENG, W. HAN

Combining (4.13)–(4.19), we obtain

(4.20)

|||{el}|||2 ≤ 1
2

|||{el}|||2 + Ch1+2 min{r,k}

K

L(cid:88)

l=0

wl

(cid:88)

K∈Th

(cid:107)ul(cid:107)2

r+1,K,

where δ = ¯c h is used. Thus we complete the proof of this theorem.
Remark 4.6. Note that (cid:107)ωl · ∇(ul − ul
gives a stability estimate for (cid:107)ωl · ∇(ul − ul
not established for the DODG approximation solution of the RTE, cf. Theorem 4.6 in [16].

(cid:3)
h)(cid:107)0,K is included in the norm |||{ul} − uh|||, therefore (4.10) also
h)(cid:107)0,K in terms of (cid:107)ul(cid:107)r+1,X . We remark that this estimate was

Error estimates between the solution u to the RTE and the solution {ul} to the semi-discretized equation

(3.14) have been proved in [16].
Theorem 4.7. Let {ul} and u be the solutions of (3.14) and (2.3)–(2.4), respectively. In 3D, if the regularity
assumption (4.9) holds, then we have

 l(cid:88)

l=0

(cid:88)

K∈Th

wl

(cid:13)(cid:13)(cid:13)ul(·) − u(·, ωl)

(cid:13)(cid:13)(cid:13)2

0,K

 1

2

(cid:18)(cid:90)

X

≤ C2n−r−1

(cid:107)u(·,·)(cid:107)2

r+1,Ωdx

,

(cid:19) 1

2

(4.21)

where C1 is positive constant depending on r and the phase function g.

Similarly, we can obtain the following theorem.

Theorem 4.8. Let {ul} and u be the solutions of (3.14) and (2.3)–(2.4), respectively. In 2D, if the solution
u to RTE (2.3)–(2.4) is in L2(X, C2(Ω)) and there exists a positive constant C such that

(4.22)

where g(cid:48)(cid:48)(x, t) = ∂2g(x,t)

∂t2

(4.23)

(cid:107)g(cid:48)(cid:48)(x, ω·)(cid:107)0,∞,Ω ≤ C,

sup

x∈X, ω∈Ω

, then we have

 l(cid:88)

wl

(cid:13)(cid:13)(cid:13)ul(·) − u(·, ωl)
(cid:13)(cid:13)(cid:13)2

0,K

(cid:88)

K∈Th

 1

2

= O(h2

θ),

when hθ is sufficiently small.

l=0

Combining the above three theorems, we obtain the following results.

Theorem 4.9. Let uh and u be the solutions of (4.5)–(4.6) and (2.3)–(2.4), respectively. Under the

assumption of Theorem 4.7, we have

 l(cid:88)

l=0

(cid:13)(cid:13)(cid:13)ul

(cid:88)

K∈Th

wl

(4.24)

h(·) − u(·, ωl)

≤ C1hmin{r,k}+ 1

2

 1

2

(cid:13)(cid:13)(cid:13)2

0,K

 L(cid:88)

l=0

(cid:88)

K∈Th

wl

 1

2

(cid:107)ul(cid:107)2

r+1,K

(cid:19) 1

2

(cid:18)(cid:90)

X

+ C2n−r−1

(cid:107)u(·,·)(cid:107)2

r+1,Ωdx

,

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

15

when h is sufficiently small.

Theorem 4.10. Let uh and u be the solutions of (4.5)–(4.6) and (2.3)–(2.4), respectively. Under the

assumption of Theorem 4.8, we have

(4.25)

wl

h(·) − u(·, ωl)

≤ C1hmin{r,k}+ 1

2

 l(cid:88)

l=0

(cid:13)(cid:13)(cid:13)ul

(cid:88)

K∈Th

 1

2

(cid:13)(cid:13)(cid:13)2

0,K

 L(cid:88)

l=0

(cid:88)

K∈Th

wl

(cid:107)ul(cid:107)2

r+1,K

 1

2

+ O(h2

θ),

when h is sufficiently small.

5. Numerical experiments

In this section, we present some numerical examples of the discrete-ordinate discontinuous-streamline

diffusion method for the radiative transfer equation (2.3)–(2.4) in the 2D case. The main purpose is to

illustrate the convergence performance of the proposed DODSD method and the effect of the added diffusion

parameter.

5.1. Implementation. First, we briefly describe the implementation of the DODSD method. For a mesh

shown in Figure 2, the DODSD method can be carried out for one direction ω in the following order:

Figure 2. A example of Th in 2D

Step 1. Denote by T (1)
h = {Ki : i = 2, 3}. We first compute ul
T (1)
Step 2. For Th\T (1)

h

h for K ∈ T (1)
h .

h , let ∂l,1− X = {e ⊂ ∂l−K : K ∈ Th\T (1)

h , and ul

the elements for which all incoming boundary ∂l−K ⊂ ∂l−X.

In Figure 2,

+|e has been computed or given}
and

denote its incoming edge. In Figure 2, ∂l,1− is the broken line ACDEF . Similarly, we define the set T (2)
compute ul

h = {Ki : i = 9, 10}.

h . In Figure 2, T (2)

h for K ∈ T (2)

h

Step 3. Repeating step 2, we obtain the non-ovrelapping decomposition Th = T (1)

computation should follow this sequence; that is, start the computation with the elements in T (1)
with the elements in T (s)
h .

h

h ∪ T (2)

h ∪···∪ T (s)

h . The
and end

ωACDEBF16

C. WANG, Q. SHENG, W. HAN

In the above procedure, the unknown function ul

iteration scheme of (3.17), that is, with an initial guess ul,0
h ∈ Pk(K), 0 ≤ l ≤ L, such that
ul,j
L(cid:88)

h + δ ωl · ∇vl,j

ωl · ∇ul,j

h + σtul,j

h , vl

(cid:32)

(cid:16)

(5.1)

+

K

h

+|ωl · n|(cid:69)
(cid:33)

[ul,j

h ], vl

=

σs

wig(·, ωl · ωi)ui,j−1

h

+ fl, vl

h + δ ωl · ∇vl

h

with

i=0

K

h on each element K is computed by following the source
h ∈ Pk(K), 0 ≤ l ≤ L, for j = 1, 2,··· , we seek
(cid:68)

(cid:17)

∂l−K
∀ vl

h ∈ Pk(K)

(5.2)
For any K ∈ Th and vh ∈ Pk(K), it is easy to prove that there exists a positive constant CK satisfying

ul,j− |∂l−K = 0,

∂l−K ⊂ ∂l−X.
(cid:68)

vl−, vl− |ωl · n|(cid:69)

(cid:19)
+|ωl · n|(cid:69)

∂l
+K

∂l−K

0,K + δ (cid:107)ωl · ∇vh(cid:107)2

(cid:107)vh(cid:107)2
≤ (ωl · ∇vh + σtvh, vh + δ ωl · ∇vh)K +

0,K +

1
2

(cid:68)

vl
+, vl

(cid:18)

CK

when h is sufficiently small. Then the unique solvability of (5.1)–(5.2) can be obtained by the above inequality

and the Lax-Milgram lemma (see e.g. [10]).

We perform the above procedure for all directions in one iteration step, and stop the iteration if some

stopping condition is met, and take {ul,j

h } as {ul

h}.

5.2. Numerical experiments. Let X = (0, 1) × (0, 1). We consider the following four examples of the
radiative transfer equation (2.3)–(2.4):

Example 1. the H-G phase function with η = 0.2.

Example 2. the H-G phase function with η = 0.5.

Example 3. the H-G phase function with η = 0.9.

Example 4. the phase function

g(x, t) =

1
2π

(cid:18)

1 +

(cid:19)

.

t
2

For Example 1 - Example 3, the true solution is

u(x, ω) = sin(πx1) sin(πx2).

And for Example 4, the true solution is

u(x, ω) = e−ax1−bx2 (1 + c cos θ) ,

with a = b = σa

3 and c = σa

σa+6σs

equation.

. We set the right hand function f (x, ω) to satisfy the radiative transfer

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

17

Let T0 = Th0 be an initial triangulation of X with a mesh size h0 ≈ 0.1. Then we recursively generate a
sequence of nested triangulations Tl = Thl, l = 1, 2, 3, by dividing each triangle in the previous mesh Tl−1 into
four sub-triangles by connecting the midpoints of the edges; hl = 2−lh0. Based on these meshes, the linear
finite element spaces are constructed and used in the spatial discretization. For the angular discretization,

we employ the composite trapezoidal rule (3.3) with hθ = π/10, π/20, π/30 and π/10 for the above four

examples respectively.

We shall use the DODSD method with δ = hl to solve these examples. To measure the difference between

the true solution and its approximate solution, we define the quantity |||u−uh|||h :=
with

(cid:18) L(cid:88)
(cid:18) L(cid:88)

l=0

(cid:88)
(cid:88)

K∈Th

wl

l=0

K∈Th

(cid:19) 1

2

,

(cid:19) 1

2

,

|||v|||(1) =

wl

(cid:107)vl(cid:107)2

0,K

|||v|||(2) =

|||v|||(3) =

hK(cid:107)ωl · ∇vl(cid:107)2

0,K

|||v|||(4) =

2

i=1

(cid:16)(cid:80)4

(cid:0)|||u − uh|||(i)(cid:1)2(cid:17) 1
(cid:69)
(cid:68)
vl−, vl−ωl · n
[vl], [vl]|ωl · n|(cid:69)

(cid:19) 1
(cid:19) 1

∂l
+K

.

,

2

2

(cid:68)

∂l−K

(cid:18) L(cid:88)
(cid:18) L(cid:88)

l=0

wl

(cid:88)
(cid:88)

+K⊂∂l
∂l

+X

wl

l=0

K∈Th

5.2.1. Numerical convergence rates. In this subsection, we take σt = 10, σs = 0.1. Errors for these

four examples are reported in Table 1–Table 4 and Figure 3–Figure 6. For all these examples, we can
see that |||u − uh|||(i), i = 1, 2, 3, are approximately O(h2), and that |||u − uh|||(4) ≈ O(h1.5). Since
|||u − uh||| ≈ |||u − uh|||h, we can conclude that |||u − uh||| = O(h1.5) for all these examples, which agrees
with our theoretical error estimates.

Table 1. Error for Example 1

l

0

1

2

3

|||u − uh|||(1)

|||u − uh|||(2)

|||u − uh|||(3)

|||u − uh|||(4)

|||u − uh|||h

5.3989e-3

6.1012e-3

7.6011e-2

3.3398e-2

8.3424e-2

1.3923e-3

1.6388e-3

2.6936e-2

1.2970e-2

2.9973e-2

3.5459e-4

4.3395e-4

9.5335e-3

4.8451e-3

1.0709e-2

8.9879e-5

1.1300e-4

3.3722e-3

1.7661e-3

3.8094e-3

5.2.2. Comparison with the DODG method. In order to show the effects of adding the artificial diffusion
term, we report the error of the DODG method in norm ||| · |||h for the four examples in Table 5. The
comparisons of the DODSD method and the DODG method are also shown in Figure 7. We observe that:

1) both the DODSD method and the DODG method have the similar convergence rates; 2) the DODSD
method can lead to some improvement of the accuracy in norm ||| · |||h compared to the DODG method.

18

C. WANG, Q. SHENG, W. HAN

10−1

10−2

10−3

10−4

r
o
r
r
e

1.5
2.0

1
1

|||u − uh|||(1)
|||u − uh|||(2)
|||u − uh|||(3)
|||u − uh|||(4)

10−1.8 10−1.6 10−1.4 10−1.2 10−1

h

Figure 3. Loglog convergence plot of |||u − uh|||(i) (i = 1, 2, 3, 4) vs. h for Example 1

Table 2. Error for Example 2

|||u − uh|||(1)

|||u − uh|||(2)

|||u − uh|||(3)

|||u − uh|||(4)

|||u − uh|||h

5.3951e-3

6.1766e-3

7.6014e-2

3.3452e-2

8.3453e-2

1.3904e-3

1.6591e-3

2.6937e-2

1.2994e-2

2.9985e-2

3.5412e-4

4.4085e-4

9.5337e-3

4.8564e-3

1.0714e-2

8.9791e-5

1.1504e-4

3.3723e-3

1.7711e-3

3.8119e-3

Table 3. Error for Example 3

|||u − uh|||(1)

|||u − uh|||(2)

|||u − uh|||(3)

|||u − uh|||(4)

|||u − uh|||h

5.3969e-3

6.1958e-3

7.6013e-2

3.3459e-2

8.3456e-2

1.3910e-3

1.6639e-3

2.6936e-2

1.2996e-2

2.9986e-2

3.5655e-4

4.4334e-4

9.5332e-3

4.8567e-3

1.0714e-2

9.9651e-5

1.1797e-4

3.3719e-3

1.7711e-3

3.8118e-3

Tl

0

1

2

3

l

0

1

2

3

6. Conclusion

In this paper, we present a discrete-ordinate discontinuous-streamline diffusion method for solving the

radiative transfer equation. This method applies the discrete ordinate technique to deal with the integration

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

19

1.5
2.0

1
1

|||u − uh|||(1)
|||u − uh|||(2)
|||u − uh|||(3)
|||u − uh|||(4)

10−1

10−2

10−3

10−4

r
o
r
r
e

10−1.8 10−1.6 10−1.4 10−1.2 10−1

h

Figure 4. Loglog convergence plot of |||u − uh|||(i) (i = 1, 2, 3, 4) vs. h for Example 2

1.5
2.0

1
1

|||u − uh|||(1)
|||u − uh|||(2)
|||u − uh|||(3)
|||u − uh|||(4)

10−1

10−2

10−3

10−4

r
o
r
r
e

10−1.8 10−1.6 10−1.4 10−1.2 10−1

h

Figure 5. Loglog convergence plot of |||u − uh|||(i) (i = 1, 2, 3, 4) vs. h for Example 3

term of the radiative transfer equation in the angular discretization, and employs the discontinuous-streamline

diffusion method for the spatial discretization. The stability property and unique solvability of the discrete

system are proved. Under suitable solution regularity assumptions, error estimates for the numerical solutions

are derived in a norm including the directional gradient. Numerical results confirm the convergence behavior

of the proposed method.

The main difference between the DODSD method and the DODG method is in the additional artificial

diffusion term. Our numerical experiments show that such a modification can improve the accuracy of
numerical solutions in term of ||| · |||h norm in comparison with the DODG method. As for the effect of the
artificial diffusion parameter δ, we remark that it may reduce the error |||u − uh|||(3) and |||u − uh|||(4) while

20

C. WANG, Q. SHENG, W. HAN

Table 4. Error for Example 4

|||u − uh|||(1)

|||u − uh|||(2)

|||u − uh|||(3)

|||u − uh|||(4)

|||u − uh|||h

3.6110e-3

2.6820e-3

3.1865e-2

1.2766e-2

3.4620e-2

9.1999e-4

7.8409e-4

1.1233e-2

5.1355e-3

1.2410e-2

2.3272e-4

2.1117e-4

3.9834e-3

1.9544e-3

4.4481e-3

5.8632e-5

5.5119e-5

1.4122e-3

7.1893e-4

1.5867e-3

1.5
2.0

1
1

l

0

1

2

3

|||u − uh|||(1)
|||u − uh|||(2)
|||u − uh|||(3)
|||u − uh|||(4)

10−2

r
o
r
r
e

10−3

10−4

10−1.8 10−1.6 10−1.4 10−1.2 10−1

h

Figure 6. Loglog convergence plot of |||u − uh|||(i) (i = 1, 2, 3, 4) vs. h for Example 4

Table 5. Results of the DODG method

l Example 1 Example 2 Example 3 Example 4

0

1

2

3

9.6214e-2

9.6254e-2

9.6265e-2

3.8551e-2

3.5124e-2

3.5140e-2

3.5141e-2

1.4422e-2

1.2668e-2

1.2674e-2

1.2673e-2

5.2930e-3

4.5303e-3

4.5324e-3

4.5316e-3

1.9121e-3

increase the error |||u − uh|||(1) and |||u − uh|||(2). Since |||u − uh|||(1) and |||u − uh|||(2) converge faster than
|||u − uh|||(3) and |||u − uh|||(4), the DODSD method with an appropriate δ is expected to be more accurate
in ||| · ||| norm in comparison with the DODG method.

A DISCRETE-ORDINATE DISCONTINUOUS-STREAMLINE DIFFUSION METHOD FOR RTE

1.5

1

Example 1

Example 2

10−1

r
o
r
r
e

10−2

10−1

r
o
r
r
e

10−2

10−1

10−1.5
h

Example 3

10−1

r
o
r
r
e

10−2

10−2

r
o
r
r
e

10−1

1.5
10−1.5
1
h

Example 4

1.5

1

21

1.5

1

10−1.5
h

10−1

10−1.5
h

10−1

Figure 7. Loglog convergence plot of |||u − uh|||h vs. h (red line: DODG method; blue line:
DODSD method)

References

[1] V. Agoshkov. Boundary Value Problems for Transport Equations. Modeling and Simulation in Science, Engineering and

Technology. Birkh¨auser Boston, 1998.

[2] S. R. Arridge and J. C. Schotland. Optical tomography: forward and inverse problems. Inverse Problems, 25(12):123010,

2009.

[3] M. Asadzadeh and E. Kazemi. On convergence of the streamline diffusion and discontinuous galerkin methods for the

multi-dimensional fermi pencil beam equation. Int. J. Numer. Anal. Mod., 10(4):860–875, 2013.

[4] M. Asadzadeh and P. Kowalczyk. Convergence analysis of the streamline diffusion and discontinuous galerkin methods for

the vlasov-fokker-planck system. Numerical Methods for Partial Differential Equations, 21(3):472–495, 2005.

[5] K. Atkinson. An Introduction to Numerical Analysis, 2nd ed. John Wiley & Sons, 1989.

[6] G. Bal. Inverse transport theory and applications. Inverse Problems, 25(5):053001, 2009.

[7] S. Brenner and R. Scott. The Mathematical Theory of Finite Element Methods, volume 15 of Texts in Applied Mathematics.

Springer, 3rd edition, 2008.

[8] B. G. Carlson. Solution of the transport equation by the Sn method. Los Alamos National Laboratory, 1955.

[9] K. W. Che Sun, Huaimin Tan. The discontinuous-streamline diffusion method for first-order hyperbolic equation. Mathematica

Numerica Sinica, 20(1):35–44, Feb. 1998.

[10] P. Ciarlet. The Finite Element Method for Elliptic Problems. Society for Industrial and Applied Mathematics, 2002.

22

C. WANG, Q. SHENG, W. HAN

[11] H. Egger and M. Schlottbom. A mixed variational framework for the radiative transfer equation. Mathematical Models and

Methods in Applied Sciences, 22(03):1150014, 2012.

[12] J. A. Fleck Jr. and J. D. Cummings Jr. An implicit Monte Carlo scheme for calculating time and frequency dependent

nonlinear radiation transport. Journal of Computational Physics, 8(3):313–342, 1971.

[13] H. Gao and H. Zhao. Analysis of a numerical solver for radiative transport equation. Mathematics of Computation,

82(281):153–172, 2013.

[14] W. Han, J. Eichholz, X. Cheng, and G. Wang. A theoretical framework of X-ray dark-field tomography. SIAM Journal on

Applied Mathematics, 71(5):1557–1577, 2011.

[15] W. Han, J. Eichholz, and Q. Sheng. Theory of differential approximations of radiative transfer equation. In Advances in

Applied Mathematics and Approximation Theory, pages 121–148. Springer, 2013.

[16] W. Han, J. Huang, and J. Eichholz. Discrete-ordinate discontinuous Galerkin methods for solving the radiative transfer

equation. SIAM Journal on Scientific Computing, 32(2):477–497, 2010.

[17] W. Han, Y. Li, Q. Sheng, and J. Tang. A numerical method for generalized Fokker-Planck equations. Recent Advances in

Scientific Computing and Applications, 586:171, 2013.

[18] K. Hesse and I. H. Sloan. Cubature over the sphere S2 in Sobolev spaces of arbitrary order. J. Approx. Theory, 141:118–133,

2006.

[19] J. R. Howell. The Monte Carlo method in radiative heat transfer. Journal of Heat Transfer, 120(3):547–560, 1998.

[20] T. J. Hughes, M. Mallet, and M. Akira. A new finite element formulation for computational fluid dynamics: Ii. beyond

{SUPG}. Computer Methods in Applied Mechanics and Engineering, 54(3):341–355, 1986.

[21] C. Johnson and U. N¨avert. An analysis of some finite element methods for advection-diffusion problems. In O. Axelsson,

L. Frank, and A. V. D. Sluis, editors, Analytical and Numerical Approaches to Asymptotic Problems in Analysis Proceedings

ofthe Conference on Analytical and Numerical Approachesto Asymptotic Problems, volume 47 of North-Holland Mathematics

Studies, pages 99–116. North-Holland, 1981.

[22] R. Koch, W. Krebs, S. Wittig, and R. Viskanta. The discrete ordinate quadrature schemes for multidimensional radiative

transfer. Journal of Quantitative Spectroscopy and Radiative Transfer, 53, 1995.

[23] E. W. Larsen and J. E. Morel. Advances in discrete-ordinates methodology. In Nuclear Computational Science, pages 1–84.

Springer Netherlands, 2010.

[24] I. Lux and K. L. Monte Carlo Particle Transport Methods: Neutron and Photon Calculations. CRC Press, 1991.

[25] R. G. McClarren and C. D. Hauck. Simulating radiative transfer with filtered spherical harmonics. Physics Letters A,

374(22):2290–2296, 2010.

[26] K. Ren. Recent developments in numerical techniques for transport-based medical imaging methods. Communications in

Computational Physics, 8:1–50, 2010.

[27] J. Spanier and E. Gelbard. Monte Carlo Principles and Neutron Transport Problems. Dover, New York, 2008.

[28] J. Tang, W. Han, and B. Han. A theoretical study for RTE-based parameter identification problems. Inverse Problems,

29(9):095002, 2013.

