6
1
0
2

 
r
a

M
8

 

 
 
]
L
M

.
t
a
t
s
[
 
 

1
v
0
4
7
2
0

.

3
0
6
1
:
v
i
X
r
a

Pairwise Choice Markov Chains

Stephen Ragain, Johan Ugander
{sragain,jugander}@stanford.edu

Management Science & Engineering, Stanford University

Abstract

As datasets capturing human choices grow in richness and scale, particularly
in online domains, there is an increasing need for choice models that explain and
predict complex empirical choices that violate traditional choice-theoretic assump-
tions such as regularity, stochastic transitivity, or Luce’s choice axiom. In this work
we introduce a Pairwise Choice Markov Chain (PCMC) model of discrete choice
that is free of all those assumptions while still satisfying the attractive founda-
tional axiom of uniform expansion. Uniform expansion is known to imply Luce’s
choice axiom in the context of independent random utility models (RUMs), but
the PCMC model is not a RUM (let alone an independent RUM). Inference for the
PCMC model is straight-forward, and we thus introduce it as the ﬁrst inferentially
tractable model of discrete choice known to satisfy uniform expansion without the
choice axiom, regularity, or strict stochastic transitivity. It is thus more ﬂexible
than even Tversky’s Elimination By Aspects model, which assumes regularity and
is also known to be inferentially intractable. We show that our model learns and
predicts synthetic non-transitive data well. Our analysis also synthesizes several
recent observations connecting the Multinomial Logit (MNL) model and Markov
chains; the PCMC model retains the Multinomial Logit model as a special case.

1

Introduction

Early work on probabilistic theories of pairwise choice yielded simple and widely
adopted models such as Thurstone’s Case V model [28] and the Bradley-Terry-Luce
(BTL) model [8]. Both of these models make strong assumptions, the most obvious
being that they both assume strict stochastic transitivity between alternatives: if pxy is
the probability of choosing x over y among pairs {x, y} in a universe U, then pab ≥ 0.5
and pbc ≥ 0.5 imply pac ≥ max(pab, pbc). Strict stochastic transitivity thus implies a
total ordering on U, a strong statement about choice preferences.

The most storied assumption in choice theory, however, is arguably Luce’s choice
axiom [17], popularly known as the independence of irrelevant alternatives (IIA). The
axiom consists of two statements: (i) if a, b ∈ S and pab = 0, then it follows that
Pr(a chosen from S) = 0 for all S containing b, and (ii) the probability that a is chosen
from U conditioned on the chosen item lying in S ⊆ U is precisely the probability that
a is chosen from S [18]. The Bradley-Terry-Luce model for pairwise choice, where
pij = γi/(γi + γj) for latent quality parameters γi ≥ 0, became popular after the
introduction of the choice axiom:
it satisﬁes the axiom, while Thurstone’s Case V
model does not [1] even though it is transitive.

1

Generalizing discrete choice from pairs to larger sets, the Bradley-Terry-Luce model
was soon extended; the pairwise binomial logit in the model was generalized to a multi-
nomial logit [4]. The resulting Multinomal Logit (MNL) model again has quality pa-
rameters γi ≥ 0 for each i ∈ U, and deﬁnes piS, the probability of choosing i from
S ⊆ U, as piS ∝ γi for all i ∈ S. The MNL model, sometimes also called the
Plackett-Luce model, continues to satisfy Luce’s choice axiom.

Luce and others have noted that the choice axiom and stochastic transitivity are
strong assumptions that do not hold for empirical choice data [10, 13, 26, 14, 29].
Meanwhile, the success of the MNL model of discrete choice under the choice axiom
can be understood as a shining example of Box’s mantra “all models are wrong but
some are useful” [6]. A proliferation of discrete choice models striving to escape the
conﬁnes of the choice axiom have emerged over the years. The most popular of these
models have been the Elimination by Aspects [30], mixed MNL [7], and nested
MNL models [22]. All of these models, however, exhibit some shortcoming in their
rigidity or inferential tractability: Elimination by aspects and mixed MNL both exhibit
the property of regularity, deﬁned below, while inference is difﬁcult in all three cases
[23, 16].

With this proliferation of models came an important categorization, the random
utility model (RUM) framework [4, 20]. A model is a RUM if there exist real-valued
random variables Xa, for all a ∈ U, such that Pr(a chosen from S) = Pr(Xa ≥
Xb,∀b ∈ S), for all S ⊆ U. A model is an independent RUM if there exist Xa
that are all independent. RUMs in general assume regularity but do not necessarily
assume the choice axiom or assume stochastic transitivity (consider distributions such
as those for non-transitive dice [25, 27]). Thurstone’s Case V model and the BTL
model are both independent RUMs, the mixed MNL model and the Elimination by
Aspects model are both RUMs, while the nested MNL model is not a RUM. A major
result by McFadden and Train showed that for any RUM there exists a mixed MNL
model that can approximate the choice probabilities of that RUM to within an arbitrary
error [23], a strong result about the generality of mixed MNL models.
When considering models circumventing the choice axiom, a weaker property called
regularity often holds: for any choice sets A, C where A ⊆ C, Pr(x chosen from A) ≥
Pr(x chosen from C). For example, all RUMs exhibit regularity, even if they don’t
exhibit the choice axiom. Regularity, though intuitively pleasing, has its drawbacks
empirically: it does not describe contexts that features framing effects [13] such as
asymmetric dominance. Framing effects and other observations from modern behavior
economics motivate us to contribute a new model of discrete choice that escapes histor-
ically common assumptions while still furnishing enough structure to be inferentially
tractable.

The present work.
In this work we introduce a simple, inferentially tractable model
of discrete choice that we call the Pairwise Choice Markov Chain (PCMC) model. The
PCMC model is based on an underlying continuous time Markov chain over a uni-
verse U that transitions between alternatives with rates that are determined by pairwise
choice probabilities. The model views a selection probability piS as the probability
mass on alternative i ∈ S of the stationary distribution of a continuous time Markov

2

chain on the set of alternatives S with transition rates parameterized by a matrix P.

We show in this work that the parameter matrix P is interpretable as the matrix
of pairwise selection probabilities, and as such the PCMC model can be thought of as
deﬁning set-wise selection probabilities strictly in terms of pairwise selection probabil-
ities. One of the strengths of the PCMC model is that this matrix can be parameterized
further by arbitrary models of pairwise choice. Indeed, we show that when the matrix
P is parameterized as the pairwise selection probabilities of a BTL pairwise model, the
PCMC model reduces to an MNL model. We also study a parameterization in terms of
the recently introduced Blade-Chest models of intransitive pairwise choices [9]. The
Blade-Chest models parameterize arbitrary non-transitive pairwise choice probabilities
in terms of “blades” and “chests,” motivated by a sword dueling metaphor. By parame-
terizing P in terms of the Blade-Chest model parameters, we achieve a reduction from

(cid:0)n
(cid:1) parameters to 2dn parameters, where d is the dimension of the blade and chest

2
embeddings.

The PCMC model can be thought of as building upon the observation underlying
the recently introduced Iterative Luce Spectral Ranking (I-LSR) procedure for efﬁ-
ciently ﬁnding the maximum likelihood estimate for parameters of MNL models [21].
The analysis of I-LSR is precisely analyzing a PCMC model in the special case where
the matrix P has been parameterized by BTL. In that case the stationary distribution of
the chain is found to match the stationary conditions of the MNL likelihood function,
establishing a deep connection between MNL models and Markov chains. The PCMC
model generalizes that connection.

The analysis of I-LSR is one of several recent works to realize connections between
the MNL model and Markov chains. Other recent connections have been made by
the work on RankCentrality [24], which employs a discrete time Markov chain for
inference in the place of I-LSR’s continuous time chain. Separate work by Blanchet
et al., also based on discrete time Markov chains, contributes a Markov chain-based
choice model that is capable of approximating any RUM [3].

The PCMC model is not a RUM, and in general does not exhibit stochastic transitiv-
ity, regularity, or obey the choice axiom. We ﬁnd that the PCMC model does, however,
obey the lesser known but fundamental axiom of uniform expansion. The axiom of
uniform expansion was proposed by Yellott as a weakened version of Luce’s choice
axiom that implies the choice axiom within the context of independent RUMs [31]. In
this work we deﬁne a convenient structural property termed contractibility, for which
uniform expansion is a special case, and we show that the PCMC model exhibits con-
tractibility. Of the above mentioned models, Elimination by Aspects is the only other
model that is not an independent RUM but obeys uniform expansion. Meanwhile, re-
call that Elimination by Aspects obeys regularity, which the PCMC model does not:
as such, the PCMC model we introduce is uniquely positioned in the literature of ax-
iomatic models of discrete choice, minimally satisfying uniform expansion without the
other aforementioned axioms.

Lastly, after presenting the model and its properties, in Section 4 we evaluate our
inference performance on several synthetic datasets, under several parameterizations
of the pairwise matrix P .

3

2 The PCMC model

A Pairwise Choice Markov Chain (PCMC) models the selection probability piS, the
probability of choosing i from S ⊆ U, as the probability mass on alternative i ∈ S
of the stationary distribution of a continuous time Markov chain (CTMC) on the set
of alternatives S. The transition rates of the chain are given as a simple function of a
parameter matrix P that is interpretable as a matrix of pairwise selection probabilities.

Formally, given S ⊆ U we construct rate matrix QS = {qij}i,j∈S as follows:

qij = pji,

qii = −(cid:88)

j(cid:54)=i

i (cid:54)= j,

qij.

when the intention is clear.

piS := πS(i), and also occasionally abuse notation to write πS(A) = (cid:80)

Let πS be the stationary distribution of the corresponding CTMC on S. We deﬁne
x∈A πS(x)
In a ﬁnal additional abuse of notation, when |S| = 2 we write pij instead of piS
or pi{i,j}. This abuse is motivated in the next section, where we show that the matrix
of parameters P are indeed the selection probabilities for pair sets under the PCMC
model as deﬁned above.

We now show that the PCMC model is well deﬁned.

Claim 1. The choice probabilities piS are well deﬁned for all i in any subset S ⊆ U
of a ﬁnite U.

Proof. We will show that there exists a single closed communicating class which im-
plies a unique stationary distribution. A closed communicating class C is a subset of S
such that the chain will never leave C once entering it, and each state in C is reachable
from every other state in C.
Because S is ﬁnite, there must be at least one closed communicating class. Suppose
the chain had more than one closed communicating class and that i ∈ S and j ∈ S
were in different closed communicating classes. But pij + pji = 1, so at least one of
qji and qij is strictly positive. But then the chain can switch communicating classes
through the positive edge, a contradiction.

Note that the support of πS is the closed communicating class, but S may have

transient states corresponding to alternatives with a selection probability of zero.

In the subsections that follow, we show that pairwise choice probabilities under
the PCMC model are precisely the entries of the parameter matrix P . We also show
and that a PCMC model does not exhibit regularity in general, nor is it a random util-
ity model. We then show that a PCMC model with pairwise probabilities originating
from a Bradley-Terry-Luce (BTL) pairwise model is equivalent to a Multinomial Logit
(MNL) set-wise model, and that the PCMC model can be used as a wrapper around
more ﬂexible models of pairwise choice, such as non-transitive Blade-Chest models.

4

2.1 Preservation of pairwise probabilities
The PCMC model can be generically thought of as being parameterized by a matrix P
constrained such that pij + pji = 1 and pij ≥ 0,∀i, j, but the following brief analysis
motivates our decision to call the parameter pij the pairwise probability of choosing i
over j.
Consider a pair set S = {i, j}. When pij ∈ (0, 1), then the unique stationary
distribution πS satisfying πSQS = 0 subject to ||πS||1 = 1 will have

πS(j)qji = πS(i)qij,
πS(i) + πS(j) = 1.

These equations yield πS(i) = pij, πS(j) = pji. The corner cases where pij = 0 or 1
have the dominating state as absorbing, also yielding agreement with π.

We conclude that the PCMC model is consistent with input pairwise probabilities
when asked to output probabilities on sets of size two. For sets of size greater than
two, we can think of the PCMC model as parameterizing choice probabilities on a set
S entirely in terms of the pairwise probabilities between pairs of alternatives within S.

2.2 Regularity and the RUM property
The regularity property, described by Luce as a precursor to the choice axiom, requires
that the probability of choosing a ∈ S does not decrease when removing elements from
S. Formally, paS(cid:48) ≥ paS for S(cid:48) ⊆ S. We will now show that the PCMC model is not
constrained to exhibit regularity, nor is it a random utility model (RUM) in general.
Consider U = {r, p, s} corresponding to a rock-paper-scissors-like game, in the

sense that

 0

α
1 − α

P =



1 − α

0
α

α
1 − α

0

3 , 1].

for some α ∈ [0, 1], where the rows of P are indexed by r, p, and s respectively. For
any pair set we have pij = α if i beats j in rock paper scissors. Meanwhile, the choices
on the full triplet U gives π = ( 1
3 ), regardless of α. Thus, regularity does not
hold for α ∈ [0, 1

3 , 1

3 , 1

3 ) or α ∈ ( 2

This example further illustrates why the PCMC model is not a RUM. By setting
α = 1, there can not exist real-valued random variables X1, X2, X3 such that Pr(X1 >
X2) = 1, Pr(X2 > X3) = 1, and Pr(X3 > X1) > 0.

By a theorem describing non-transitive dice [27], it is also clear that many more
PCMC models can not be independent RUMs: the Steinhaus-Trybula theorem says that
for any real-valued independent random variables X1, X2, X3, it must be the case that
mini,j Pr(Xi > Xj) ≤ 2
3. As a result, a necessary condition for a rock-paper-scissors
instance to be an independent RUM is that α ∈ [ 1
3 ], agreeing with the condition
above for regularity.

3 , 2

Deriving necessary and sufﬁcient conditions on P for a PCMC model to be a RUM,
analogous to known characterization theorems for RUMs [11] and known sufﬁcient

5

conditions for nested MNL models to be RUMs [5], is an interesting open research
challenge.

The PCMC model’s lack of regularity is a positive trait in the sense that empirical
choice phenomena such as framing effects and asymmetric dominance violate regular-
ity [13], and the PCMC model is rare in its ability to model such choices.

2.3 Multinomial Logit from Bradley-Terry-Luce
We now observe that the Multinomial Logit Model (MNL), also called the Plackett-
Luce model, is precisely a PCMC model with a matrix P consisting of pairwise BTL
probabilities.
Recall that the BTL model assumes the existence of γ : U → R≥0 with pxy =
γx/(γx + γy),∀x, y ∈ U and that the MNL generalization assumes piS ∝ γi,∀i ∈
S,∀S ⊆ U.
Claim 2. If the pairwise probabilities P are generated from a BTL model with param-
eters γ, then for each S ⊆ U, the PCMC probabilities piS are consistent with an MNL
model on S with parameters γ.

Proof. Let the PCMC rate matrix QS be constructed from a matrix of pairwise prob-
abilities P generated from a BTL model with parameters γ. We aim to show that
πS = γ||γ||1

is a stationary distribution of the PCMC chain: πT

S QS = 0. We have:

(cid:88)
(cid:88)

j(cid:54)=i

j(cid:54)=i

(πT

S QS)i =

1
||γ||1

=

γi
||γ||1



(cid:88)
−(cid:88)

j(cid:54)=i

j(cid:54)=i

γjpij − γi(

pij)

γj

γi + γj

γj

γi + γj

 = 0,∀i.

Thus πS is always the stationary distribution of the chain, and we know by Claim 1
that it is unique. It follows that piS ∝ γi for all i ∈ S, as desired.

The observation in this subsection also explains why the recently introduced It-
erative Luce Spectral Ranking (I-LSR) procedure succeeds in inferring the parame-
ters of an MNL model from the stationary distribution of an appropriately constructed
continuous-time Markov chain. If the choice data being subjected to inference is pair-
wise, the chain that the I-LSR procedure constructs is precisely a PCMC chain with P
parameterized by iteratively inferred BTL pairwise choice probabilities.

2.4 Parametrization with Blade-Chest
We now show how a PCMC model can be used to extend the richness of a non-transitive
pairwise model, speciﬁcally a Blade-Chest model, to choices over sets in a principled
way (obeying uniform expansion).
Blade-Chest models are based on geometric d-dimensional embeddings of alter-
natives, where each alternative i is parameterized with a blade vector bi ∈ Rd and a

6

chest vector ci ∈ Rd, in addition to a BTL-like quality parameter γi ∈ R≥0. The
Blade-Chest model comes in two variations: the Blade-Chest distance model, where

pij(b, c, γ) = S(||bi − cj||2

2 − ||bj − ci||2

2 + γi − γj),

where S(x) = (1 + exp(−x))−1 is the sigmoid/logistic function, and the Blade-Chest
inner product model, where

pij(b, c, γ) = S(bi · cj − bj · ci + γi − γj).

The quality parameters γi serve to connect the models to the BTL model, but do not
meaningfully increase their expressiveness, so we disregard them in our use of the
Blade-Chest distance model in this work. Thus, these two Blade-Chest models provide
useful parameterizations of non-transitive pairwise probability matrices, P (Θ), with
Θ = {b, c} consisting of the 2dn parameters of the blade and chest embeddings.

Another technique for parametrizing P involves representing pij as a function of
features of i and j, i.e. pij = f (Xi, Xj; Θ) where Xi gives the salient features of i,
and Θ represents parameters that, for instance, give weights to these features. We can
also formulate such analysis as a factoring P = W T F where W is a weight matrix and
F a feature matrix. We do not explore such parameterizations in this work, but merely
highlight the potential to employ latent features of objects, an approach closely related
to conjoint analysis [12], in a straight-forward manner.

3 Properties

While we have demonstrated already that the PCMC model avoids several restrictive
properties that are often inconsistent with empirical choice data, we demonstrate in this
section that the PCMC model exhibits deep structure in the form of uniform expansion.
Inspired by thought experiments which were posed as early challenges to the choice
axiom, we deﬁne the property of contractibility to handle notions of similarity between
elements. We demonstrate that the PCMC model has contractibility, and gracefully
handles these thought experiments.

3.1 Uniform expansion
Yellott [31] introduced uniform expansion as a weaker condition than Luce’s choice
axiom, but one that implies the choice axiom in the context of any independent random
utility model. Consider a choice between n elements in a set S, and another choice
from a set containing k identical copies of each of the n elements. The axiom of
invariance with uniform expansion states that the probability of choosing each object
from the set S are the same as the probability of choosing some copy of each object
type from the uniformly expanded set.

Yellott demonstrated that for any independent random utility model, the double-
exponential distribution family is the only family of independent distributions that ex-
hibit uniform expansion, and that Thurstone’s model in particular does not exhibit uni-
form expansion. We now also give a formal deﬁnition.

7

Deﬁnition 1. For x, y in S ⊆ U, we say that x and y are copies if for all z ∈ S−x−y,
pxz = pyz
Deﬁnition 2. Consider X ⊆ U and Sk = {k · x}x∈X containing k copies of each
element of X, where for each xi we denote x1
i as the copies. We say that a
model satisﬁes uniform expansion if for all X and all k ≥ 1:

i , . . . , xk

k(cid:88)

j=1

pxiX =

pxj

i Sk

,

so that the probability of choosing a copy of x from S is the same as the probability of
choosing x from X.

To build intuition: consider offering a person 100 identical coffees, 100 identical
teas, and 100 identical glasses of milk. Uniform expansion contends that the propor-
tional selection probabilities of each type of drink should be the same as if they were
offered just one drink of each type.

While the axiom feels natural as a model for discrete choice, it should be regarded
with some skepticism in applications that model competitions. For example, in sports
matches or races, the winner of the competition can be modeled as the competitor with
highest skill on that day; competitions are often modeled using random utility models.
If we have a competitor with a skill distribution whose wins come from occasional
“good days” — their skill distribution has a heavy upper tail — then uniform expansion
should not hold, and is not a desirable axiom. This example relates to recent work on
team performance and selection [15], where non-invariance under uniform expansion
plays a key role.

We now show that the PCMC model exhibits uniform expansion.

Claim 3. The PCMC model exhibits uniform expansion for all matrices P .
Proof. Let πX be the stationary distribution corresponding to the PCMC model on X.
Then we can index the matrix QS so that it is a k × k grid of copies of QX:

 .



QS =

QX QX . . . QX
QX QX . . . QX
...
...
QX QX . . . QX

...

...

For πS similarly indexed with k copies of πX, i.e.:

πT
S = [πT

X πT

X . . . πT

X ],

we have that πS is the stationary distribution of QS. Because πX is the stationary
distribution of QX:

k(cid:88)

(πT

S QS)i =

πT
X QX = 0.

It follows that πS||πS|| = πS
gives the desired result for any xi ∈ X.

k gives pxj

i S = 1

k pxiX for each xi, for all j. Summing over j

j=1

8

Tversky’s Elimination by Aspects model [30] is typically deﬁned for choice sets
consisting of distinct elements, but can easily be modiﬁed to handle copies of ele-
ments. it is clear to see that any reasonable way to handle copies in Tversky’s model
would satisfy uniform expansion. Thus the PCMC model is not unique in being a non-
independent RUM that satisﬁes uniform expansion, although Elimination by Aspects
comes with the added structure of regularity.

3.2 Contractibility
An important thought experiment due to Debreau [10] concerns a choice between three
musical recordings: one of Beethoven’s eighth symphony conducted by A, another of
Beethoven’s eighth symphony conducted by B, and one of Debussy quartet conducted
by C. We will call these options B1, B2, and D respectively. When compared to D,
Debreau argues that B1 and B2 are indistinguishable in the sense that pDB1 = pDB2.
However, an agent can reasonably prefer B1 over B2 in the sense that pB1B2 > 0.5.

Debreu’s thought experiment appeared in the context of a book review of Luce’s
ﬁrst monograph on the choice axiom, and the thought experiment is intended to show a
weakness of the BTL model: pDB1 = pDB2 implies that γB1 = γB2, in turn implying
that pB1B2 = 0.5, so the above choice can not be encoded by any model that employs
Luce’s axiom. Debreu’s construction is also closely related to the “Paris and Rome”
thought experiment we dissect in Section 3.3.

We introduce a notion of contractable partitions that addresses a generalization of

the above thought experiments involving choices between near-copies.
Deﬁnition 3. A partition A1, . . . , Ak of U is a contractible partition if |Ai| ≥ 1,∀i
and paiaj = λij for all ai ∈ Ai, aj ∈ Aj for some Λ = {λij} for i, j ∈ {1, . . . , k}.

We will now show that when a PCMC model contains a contractible partition, the
relative probabilities of selecting from those partitions, π(Ai), are indifferent to the
pairwise probabilities within any partition, and depend only on the inter-partition prob-
abilities Λ. Thus, our contractable partition deﬁnition can be viewed as akin to (but
distinct from) nests in nested MNL models [22].

Claim 4. For a given Λ, let A1, . . . , Ak on U be a contractible partition for two PCMC
models represented by P, P (cid:48) with stationary distributions π, π(cid:48). Then for any Ai:

(cid:88)

j∈Ai

(cid:88)

j∈Ai

pjU =

p(cid:48)
jU ,

(1)

or equivalently, π(Ai) = π(cid:48)(Ai).
Proof. Suppose P has contractible partition A1, . . . , Ak with respect to Λ. Then πT QU =
0 gives for x ∈ A1 WLOG,

π(x)

qxy +

qxai

π(y)qyx +

π(ai)qaix. (2)

 (cid:88)

y∈A1\x

k(cid:88)

(cid:88)

i=2

ai∈Ai

 =

(cid:88)

y∈A1\x

9

k(cid:88)

(cid:88)

i=2

ai∈Ai

Noting that for ai ∈ Ai and aj ∈ Aj, qaiaj = paj ai = λji, and (2) can be rewritten:

π(x)

qxy

π(y)qyx +

π(Ai)λ1i.

Summing over x ∈ A1 then gives

 (cid:88)

y∈A1\x

i=2

 + π(x)
k(cid:88)
 (cid:88)
(cid:88)
(cid:88)

π(x)

y∈A1\x

x∈A1

y∈A1\x

(cid:88)

x∈A1

qxy

y∈A1\x

|Ai|λi1 =

(cid:88)
 + π(A1)
k(cid:88)
π(y)qyx + |A1| k(cid:88)
|A1|(cid:80)k
(cid:80)
i=2 π(Ai)λ1i
i=2 |Ai|λi1

i=2

i=2

k(cid:88)

i=2

|Ai|λi1 =

π(Ai)λ1i.

,

The leftmost term of each side is equal, so we have

π(A1) =

which makes π(A1) the solution to global balance equations for a chain on k states
(with states representing A1, . . . Ak) with transition rates γij = |Aj|λji. Since the
partition contains no empty sets, we can use λij + λji = 1 to show that the induced
chain has a unique closed communicating class (as in the proof of Claim 1). We con-
clude that {π(Ai)} are all ﬁxed if A1, ..., Ak is a contractible partition, regardless of
any differences between P and P (cid:48) on matrix elements within partitions.

We say that a choice model exhibits contractibility if, for any two sets of pairwise
choice probabilities P and P (cid:48) such that A1, . . . , Ak is a contractible partition with
respect to the same Λ for both P and P (cid:48), then equation (1) holds.
Note that every PCMC model on n elements contains a trivial contractible partition
A1 = {x1}, ..., An = {xn}, but it is an interesting open question wether one could
parameterize P directly in terms of contractible partitions. Note that the fact that any
PCMC model exhibits uniform expansion is a simple corollary of contractibility.

3.3 Paris and Rome
In an inﬂuential thought experiment posed in an early critique [30] of Luce’s initial
work axiomatizing choice theory [19], a subject is offered a choice between a trip to
Paris and trip to Rome, or either trip with the addition of a dollar, denoted by Paris*
and Rome* respectively. The idea is that the choice between Paris and Paris* should
clearly be Paris*, but Paris and Paris* should individually compare to Rome the same.
We can represent the thought experiment in the PCMC model via:

 0

1

0
0

10

P =

1 − α 1 − α 0
1 − α 1 − α 1

 ,

α α
α α
0
0

where the columns are indexed by Paris, Paris*, Rome, and Rome* respectively.

We consider the contractible partition A1 = {Paris, Paris*}, A2 = {Rome, Rome*}

to obtain:

π(A1) =

|A1|π(A2)α
|A2|(1 − α)

.

Solving this yields that π(A1), the probability of choosing some trip to Paris, must be
α.

This thought experiment provides a great example of the utility of contractibility:
even in the absence of uniform expansion, the notion that any variant on a trip to Paris
should compare the same as any variant on a trip to Rome is enough to preserve the
probability of choosing Paris over Rome when offered any of the variants of each. This
analysis holds regardless of the probabilities with which Paris beats Paris*, Rome beats
Rome*, or Paris beats Rome, and clearly generalizes to similar constructions with more
variants and for more cities.

For α = 0.5, the corresponding PCMC choice probabilities are π = ( 1

8 ).
8 , 3
These probabilities indeed capture the dominance of Paris* and Rome* over their coun-
terparts, but do not preclude Paris or Rome from selection. However, as α (cid:38) 0, π →
(0, 0, 0, 1) and as α (cid:37) 1, π → (0, 1, 0, 0), so complete dominance is captured in the
extreme choices of α.

8 , 1

8 , 3

The ﬂexibility here also illustrates the PCMC model’s ability to exhibit an im-
portant empirical phenomena known as asymmetric dominance [13]. Employing the
PCMC model in prediction problems can therefore faithfully learn and reproduce many
difﬁcult to capture empirical phenomena, motivating us to turn to inference.

4

Inference

Our goal in formulating this model is ultimately to use past choices from diverse sub-
sets S ⊆ U to predict future choices. In this section we ﬁrst give the log-likelihood
function log L(P ; C) of the PCMC matrix P given choice data C. We then allow for
parameterizations of P , P (Θ), such as the BTL or Blade-Chest parameterizations.

To demonstrate the PCMC model’s ability to represent broader data than MNL
models, and thus its ability to model choices that do not satisfy the choice axiom’s
independence of irrelevant alternatives, we evaluate the ability of our inference scheme
to predict choices on synthetic data, where the choice data is generated from several
different PCMC models.

4.1 Maximum Likelihood
Let CiS denote the number of times in the data that i was chosen out of set S for each
S ⊆ U. For each S ⊆ U, i ∈ S, recall that piS(P ) is the probability that i is selected
from set S under Θ. After dropping all constants, the log-likelihood of P given the
data C, derived from the probability mass function of the multinomial distribution, is:

log L(P ; C) =

CiS log(piS(P )).

(cid:88)

(cid:88)

S⊆U

i∈S

11

by solving πSQS(P ) = 0 subject to the constraint(cid:80)

Recall that for the PCMC model, piS(P ) = πS, where πS is the stationary distribu-
tion for a PCMC chain with rate matrix QS(P ). That stationary distribution is obtained
i∈S πS(i) = 1. Thus, piS(P ) is
an implicit function of those elements pij of P where i, j ∈ S, but the deﬁnition in
terms of the stationary distribution means that there is no clean closed form expres-
sion for piS(P ), let alone piS(P (Θ)) when P is parameterized further. The implicit
deﬁnition also makes it difﬁcult to derive gradients for log L with respect to e.g. pij.
As a result, we employ scipy’s implementation of BFGS to maximize log L(P ) or
log L(P (Θ)) for appropriate parameterizations, and leave gradient methods as future
work.

When the pairwise probability matrix P is parameterized by the Bradley-Terry
model, P (γ) with pij = γi
, we have shown earlier that our PCMC model is equiv-
alent to MNL, and equivalently the likelihood function reduces to that of MNL. In
these cases one can use Iterative Luce Spectral Ranking (I-LSR), a recent efﬁcient al-
gorithm for inferring MNL parameters γ, which has been shown to be much faster than
traditional MM or Newton methods for inferring MNL parameters [21].

γi+γj

4.2 Results
We now evaluate our inference procedure’s performance in three synthetic data regimes:
(i) choice data generated from a PCMC model with an “arbitrary” P (pij ∼ UNIF[0, 1]
i.i.d. for i > j, pji = 1− pij), (ii) choice data generated for a simple MNL model with
qualities γi ∼ UNIF[0, 1], and (iii) choice data generated from a PCMC model with a
pairwise matrix P parameterized by a two-dimensional Blade-Chest distance model.
In order to create a strongly non-transitive instance of the Blade-Chest distance model,
we draw the blades bi and chests ci uniformly at i.i.d. points along the two-dimensional
unit circle, naturally producing many triadic impasses.

(cid:1) parameters in general. When P is param-

The PCMC model’s P matrix has(cid:0)n

2

eterized according to BTL we have just n parameters, and when it is parameterized
according to a Blade-Chest distance model in d dimensions, we have 2dn parameters.
We evaluate each parameterization (arbitrary, MNL, Blade-Chest distance) for each
synthetic regime. We employ the Iterative Luce Spectral Ranking (I-LSR) algorithm
to learn the model under the BTL parameterization of P , where the PCMC model
is equivalent to an MNL model. When the data is generated by MNL, we expect I-
LSR (learning the BTL parameterization) to outperform inference under the general
parameterization. When the data is generated by a non-MNL PCMC model, we expect
I-LSR to exhibit restricted performance compared to a general parameterization, since
the data is not generated by a model that I-LSR can learn.

Training data Ctrain and evaluation data Ceval are generated according to each of the
three PCMC models, and then learned for each of the three parameterizations. For each
model we draw a stream of triplets S uniformly at random from U. We then infer each
model, and examine the evaluation data using the error metric
(ˆpiS − ˜piS)2,

Error(Ceval) =

(cid:88)

(cid:88)

S∈Ceval

i∈S

12

Figure 1: Learning error for the direct MLE, I-LSR, and Blade-Chest MLE on data
generated from (i) Arbitrary P , (ii) MNL, and (iii) Blade-Chest models. Dashed lines
represent 25/75 empirical point-wise quantiles, y-axes are log scale.

where ˜piS is the estimation according to the model, and ˆpiS is the empirical probability
in the evaluation data.

Figure 1 shows our error performance as the data grows, averaged across 20 in-
stances, for each data generating process and each inference parameterization. First
each model is trained on an “episode” of 100 samples, and error is measured on pre-
dictions for the next episode of 100 samples. These new samples are then added to the
training data, and error is again measured on a new episode of 100 samples, for each
inference scheme.

20 parameters, the PCMC model with arbitrary P has(cid:0)20

(cid:1) = 190 parameters, and

The inference is applied to a set U with n = 20 objects, meaning that MNL has

2

the PCMC model with the Blade-Chest distance parameterization uses 2dn = 80 pa-
rameters. Although these models seem modest in size, we examine 9 data–model pairs,
trained sequentially in 20 episodes, averaged across 20 instances. As a result, the ﬁgure
represents 3600 trained models. Training a PCMC model with an arbitrary P matrix
on n = 20 objects with 190 parameters takes us roughly 10 seconds using python in a
single thread.

While I-LSR does an excellent job with the MNL data, we see that the more general
inference of an arbitrary PCMC model shows better predictive power in both regimes
that do not assume the choice axiom. As a consequence, we expect PCMC to have
better predictive power in empirical contexts exhibiting violations of the choice axiom,
which are abundant [13].

5 Conclusions

In this work, we introduced a Pairwise Choice Markov Chain (PCMC) model of dis-
crete choice, a novel model for extending pairwise probabilities to larger sets. PCMC
uses the stationary distribution of a continuous time Markov chain on the candidate
choices to deﬁne selection probabilities, where the transition rates come from the pair-
wise selection probabilities.

The PCMC model is well deﬁned for any pairwise probabilities, is not a random
utility model for general pairwise probabilities, and maintains maximum ﬂexibility by
eschewing the implications of Luce’s choice axiom, transitivity, and regularity. Despite

13

this ﬂexibility, we demonstrate that the PCMC model exhibits desirable structure by
fulﬁlling uniform expansion, a property previously found only in the rigid Multinomial
Logit (MNL) model and inferentially intractable Elimination by Aspects model.

We also introduced the notion of contractibility, a nuanced property underlying
important thought experiments instrumental in moving choice theory beyond the choice
axiom, and showed that the PCMC model exhibits contractibility.

After examining how the PCMC model deftly handles these thought experiments,
we showed that the PCMC model offers straightforward inference through maximum
likelihood estimation that competes well with the I-LSR algorithm on MNL data, yet
demonstrates that it can also learn models which lie outside the realm of the choice
axiom, where I-LSR fails. Furthermore, we demonstrate that this inference extends
intuitively to parameterizations of the pairwise probabilities, allowing us to wrap our
inference around modern models designed to capture intransitivity such as the Blade-
Chest distance model.

Given the ﬂexibility and tractability of the PCMC model, it opens up many com-
pelling research directions. First, we wonder what conditions on the matrix P guaran-
tee that a PCMC model is a RUM. Next, the efﬁcacy of the PCMC model suggests
exploring other effective parameterizations for P , including developing algorithms
for inferring contractible partitions. There are also computational questions, such as
streamlining the likelihood maximization using gradients of the implicit deﬁnitions.
Very recently, learning results for nested MNL models have shown favorable query
complexity under an oracle model, while also demonstrating good performance from
greedy inference heuristics [2], and a comparison of our PCMC model with these ap-
proaches to learning nested MNL models should be considered important future work.
Lastly, a key next step will be evaluating the performance of the PCMC model when
applying our inferences and predictions to empirical choice data.

Acknowledgements. This work was supported in part by a David Morgenthaler II
Faculty Fellowship and a Dantzig–Lieberman Operations Research Fellowship.

References

[1] Ernest Adams and Samuel Messick. An axiomatic formulation and generalization

of successive intervals scaling. Psychometrika, 23(4):355–368, 1958.

[2] Austin R. Benson, Ravi Kumar, and Andrew Tomkins. On the relevance of irrel-

evant alternatives. In Proceedings of WWW, 2016.

[3] Jose Blanchet, Guillermo Gallego, and Vineet Goyal. A markov chain approxi-

mation to choice modeling. In Proceedings of EC, pages 103–104, 2013.

[4] Henry David Block, Jacob Marschak, et al. Random orderings and stochastic the-
ories of responses. Contributions to Probability and Statistics, 2:97–132, 1960.

[5] Axel B¨orsch-Supan. On the compatibility of nested logit models with utility

maximization. Journal of Econometrics, 43(3):373–388, 1990.

14

[6] George EP Box. Science and statistics. Journal of the American Statistical Asso-

ciation, 71(356):791–799, 1976.

[7] J Hayden Boyd and Robert E Mellman. The effect of fuel economy standards on
the us automotive market: an hedonic demand analysis. Transportation Research
Part A: General, 14(5-6):367–378, 1980.

[8] Ralph Allan Bradley and Milton E Terry. Rank analysis of incomplete block
designs the method of paired comparisons. Biometrika, 39(3-4):324–345, 1952.

[9] Shou Chen and Thorsten Joachims. Modeling intransitivity in matchup and com-

parison data. In Proceedings of WSDM, 2016.

[10] Gerard Debreu. Review of individual choice behavior: A theoretical analysis.

The American Economic Review, 1960.

[11] Jean-Claude Falmagne. A representation theorem for ﬁnite random scale systems.

Journal of Mathematical Psychology, 18(1):52–72, 1978.

[12] Paul E Green, Abba M Krieger, and Yoram Wind. Thirty years of conjoint anal-

ysis: Reﬂections and prospects. Interfaces, 31(3 supplement):S56–S73, 2001.

[13] Joel Huber, John W Payne, and Christopher Puto. Adding asymmetrically domi-
nated alternatives: Violations of regularity and the similarity hypothesis. Journal
of Consumer Research, pages 90–98, 1982.

[14] Samuel Ieong, Nina Mishra, and Or Sheffet. Predicting preference ﬂips in com-

merce search. In ICML, 2012.

[15] Jon Kleinberg and Maithra Raghu. Team performance with test scores. In Pro-

ceedings of EC, pages 511–528, 2015.

[16] Rajeev Kohli and Kamel Jedidi. Error theory for elimination by aspects. Opera-

tions Research, 63(3):512–526, 2015.

[17] R. Duncan Luce. Individual Choice Behavior: A Theoretical Analysis. Wiley,

1959.

[18] R Duncan Luce. The choice axiom after twenty years. Journal of Mathematical

Psychology, 15(3):215–233, 1977.

[19] R. Duncan Luce and Howard Raiffa. Games and Decisions: Introduction and

Critical Survey. Courier Corporation, 1957.

[20] Charles F Manski. The structure of random utility models. Theory and Decision,

8(3):229–254, 1977.

[21] Lucas Maystre and Matthias Grossglauser.

Fast and accurate inference of

plackett–luce models. In Proceedings of NIPS, pages 172–180, 2015.

[22] Daniel McFadden. Econometric models for probabilistic choice among products.

Journal of Business, pages S13–S29, 1980.

15

[23] Daniel McFadden, Kenneth Train, et al. Mixed mnl models for discrete response.

Journal of Applied Econometrics, 15(5):447–470, 2000.

[24] Sahand Negahban, Sewoong Oh, and Devavrat Shah. Rank centrality: Ranking

from pair-wise comparisons. arXiv preprint arXiv:1209.1688v4, 2015.

[25] Richard P Savage. The paradox of nontransitive dice. American Mathematical

Monthly, pages 429–436, 1994.

[26] Itamar Simonson and Amos Tversky. Choice in context: Tradeoff contrast and

extremeness aversion. Journal of Marketing Research, 29(3):281, 1992.

[27] Hugo Steinhaus and S Trybula. On a paradox in applied probabilities. Bull. Acad.

Polon. Sci, 7(67-69):108, 1959.

[28] Louis L Thurstone. A law of comparative judgment. Psychological Review,

34(4):273, 1927.

[29] Jennifer S Trueblood, Scott D Brown, Andrew Heathcote, and Jerome R Buse-
meyer. Not just for consumers context effects are fundamental to decision mak-
ing. Psychological Science, 24(6):901–908, 2013.

[30] Amos Tversky. Elimination by aspects: A theory of choice. Psychological Re-

view, 79(4):281, 1972.

[31] John I Yellott. The relationship between luce’s choice axiom, thurstone’s theory
of comparative judgment, and the double exponential distribution. Journal of
Mathematical Psychology, 15(2):109–144, 1977.

16

