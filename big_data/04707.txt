Estimating the Probability of Wind Ramping

Events: A Data-driven Approach

Cheng Wang, Wei Wei, Member, IEEE, Jianhui Wang, Senior Member, IEEE, Feng Qiu, Member, IEEE

1

6
1
0
2

 
r
a

 

M
1
2
 
 
]

.

C
O
h
t
a
m

[
 
 

2
v
7
0
7
4
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—This letter proposes a data-driven method for esti-
mating the probability of wind ramping events without exploiting
the exact probability distribution function (PDF) of wind power.
Actual wind data validates the proposed method.

Index Terms—data-driven, probability, ramping events, wind

power, Wasserstein metric

I. INTRODUCTION

L ARGE variations of wind power, called ramping events,

make it challenging to balance the load and generation in
real time. A survey on the deﬁnition of a ramping event can
be found in [1]. With the point forecast results, the operator
can easily identify the movement of wind power output in
two successive periods that exceeds a certain threshold, i.e.,
a ramping event, and then schedule adequate reserve capacity
so as to mitigate its impact on system frequency. However,
point wind power prediction still suffers from inaccuracy as
the leading time goes longer [2]. Recent study proposes to
forecast the conﬁdence interval of wind power [3]. However,
the operator can hardly determine the exact movement from
the conﬁdence intervals, see Fig. 1, where the wind farm is
expected to produce more power in period 1. Suppose the
2 of point forecast constitutes a ramping
movement we
2 is certainty a more severe
event, the movement wu
2 may even not
ramping, nevertheless, the movement wl
be a ramping. Moreover, the probability distribution of wind
ramping capacity w1 − w2 is still unclear.

1 − wl

1 − we

1 − wu

uw
1
ew
1
lw
1

r
e
w
o
P
d
n
i
W

 

uw
2

ew
2

lw
2

Low ramp

Ramp

High ramp

Fig. 1.

Illustration of ramping events.

Time

In this letter, we propose a data-driven method that can
provide quantitative measure on the likelihood of ramping
events given their ramping capacity, without requiring the PDF
of wind power. This analysis offers statistical insights on the

This work is supported in part by the Foundation for Innovative Research

Groups of the National Natural Science Foundation of China (51321005).

C. Wang and W. Wei are with the Department of Electrical En-
(Email: wei-

gineering, Tsinghua University, 100084, Beijing, China.
wei04@mails.tsinghua.edu.cn).

J. Wang and F. Qiu are with the Argonne National Laboratory, Argonne,

IL 60439, USA (e-mail: jianhui.wang@anl.gov; fqiu@anl.gov).

frequency of their occurrence and can help the operator make
better generation scheduling decisions.

1 and we

The exact problem studied in this letter is stated below.
We have the point forecast we
2 of wind power in two
future periods, and a series of neighbouring historical data
i,2), i ∈ I = {1, . . . , I}, in which we
pair (we
i,1 ≈ we
1
and we
2 are met. We aim to determine the probability
Pr[w1−w2 ≥ RD] and Pr[w2−w1 ≥ RU ], where RD and RU
are thresholds for ramp-down event and ramp-up event, which
are determined by the system operator or related standards.

i,1, we
i,2 ≈ we

II. PROPOSED METHOD

Suppose the PDF f (∆w) of actual wind power forecast er-
ror ∆w = [∆w1, ∆w2] is an ambiguous multivariate function,
it certainty belongs to the following functional set

f (∆w)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

f (∆w) ≥ 0, ∀∆w ∈ R2
ZR2

Ω0(R2) = 

The constraints in Ω0 constitute basic requirements of a PDF.
Let ˆf (∆w) = 1
I PI
i=1(wi,1, wi,2) be the empirical distribution
generated by the historical data, the Wasserstein ambiguity set
is deﬁned as follows

f (∆w)dw = 1




(1)

ΩC = (cid:8)f (∆w) ∈ Ω0(R2)(cid:12)(cid:12)dw

p (P1, P2) ≤ r(cid:9)

where the Wasserstein metric dw
p (P1, P2) of two probability
distributions P1 (described by f (∆w)) and P2 (described by
ˆf (∆w)) with order p ≥ 1 is deﬁned by [4]

(2)

dw
p (P1, P2) = inf

P∈Ω0(R4)

EP[kz1 − z2kp]

s.t. P[z1 ∈ B] = P1[z1 ∈ B], ∀B ∈ B(R2)
P[z2 ∈ B] = P2[z2 ∈ B], ∀B ∈ B(R2)

where B(R2) stands for all Borel sets in R2. r is a measure
on the distance between P1 and P2 in functional space. As
r tends to 0, Wasserstein ambiguity set ΩC converges to the
empirical distribution recovered from historical data.

Take the downward ramping event for example, it leads to
estimate the probability F (rD) = Pr[∆w1 − ∆w2 ≥ rD],
where rD = RD − we
2. As the PDF f (∆w) is not known
exactly, it is prudent to investigate the worst outcome, resulting
in the following optimization problem with f (∆w) being the
decision variable

1 + we

F (rD) =

f (∆w)∈ΩC Z∆w∈SD(rD)

inf

f (∆w)dw

(3)

where SD(rD) = {∆w|∆w1 − ∆w2 ≤ rD}. By changing the
value of rD, the function F (rD) provides a quasi distribution

of the wind ramping capacity. It should be pointed out that for
each rD, the worst-case PDF f (∆w) may not be the same.

According to Example 7 in [4], problem (2) leads to the

following convex optimization problem

F (rD) = sup

1
I

I

Xi=1

βi − γr

s.t. β ∈ RI , γ ∈ R+, τ ∈ RI
+

βi ≤ 1, k τis kq≤ γ, ∀i = 1, . . . , I
βi + τi∆wh
i ≤ τirD, ∀i = 1, . . . , I

(4)

i = ∆wi,1 − ∆wi,2, ∆wi,1 and
where s = [1, −1]T , ∆wh
∆wi,2 are the historical forecast errors, q is deﬁned through
1/p + 1/q = 1. Some additional remarks are given.

1. Problem (3) reduces to different forms with different
choice of p. For instance, a linear program (LP) for p ∈
{1, ∞}, or a second order cone program (SOCP) for p = 2.
2. The size of ΩC can be controlled through adjusting the

parameter r. According to [5], if r is selected as

2

 ORP down
 ERP down
 β=90% down
 β=99% down
 β=99.9% down
 ORP up
 ERP up
 β=90% up
 β=99% up
 β=99.9% up

0.010

0.008

0.006

0.004

0.002

0.000

330

340

350

360

370

 

y
t
i
s
n
e
D
y
t
i
l
i
b
a
b
o
r
P

0.20

0.15

0.10

0.05

0.00

100

200

300

400

500

600

Ramp (MW)

Fig. 2. Quasi-PDF of ramp event when I = 400.

TABLE I

PROBABILITY OF RAMPING EVENT

r = − log(α)/I

(5)

I = 200

where I is the number of sampled data, then the following
inequality holds

Pr[f (∆w) ∈ ΩC ] > 1 − α

(6)

where α is the conﬁdence level. Equation (5) will be the main
principle on the choice of r in practical usage.

3. By replacing SD(rD) in problem (3) with SU (rU ) =
{∆w|∆w1 − ∆w2 ≤ rD}, the convex formulation of F (rU )
is similar to problem (4), except for ∆wh
i = ∆wi,2 − ∆wi,1
and s = [−1, 1]T .

4. The proposed method can be extended to incorporating
spatial and temporal correlations, as long as there is enough
historical data that produces a good reference distribution.

I = 300

I = 400

RD (MW )

200
300
400

RU (MW )

200
300
400

RD (MW )

200
300
400

RU (MW )

200
300
400

RD (MW )

200
300
400

RU (MW )

200
300
400

ORP
0.0493
0.0117
0.0047
ORP
0.0141
0.0023

0

ORP
0.0493
0.0117
0.0047
ORP
0.0141
0.0023

0

ORP
0.0493
0.0117
0.0047
ORP
0.0141
0.0023

0

ERP
0.055
0.02
0.01
ERP
0.015
0.005

0

ERP
0.0467
0.0133
0.0067
ERP
0.0133
0.0033

0

ERP
0.0475
0.01
0.005
ERP
0.0125
0.0025

0

α = 90%

α = 99%

α = 99.9%

0.0572
0.0205
0.0102

0.0593
0.0210
0.0104

0.0603
0.0215
0.0106

α = 90%

α = 99%

α = 99.9%

0.0152
0.0052
1.48e-4

0.0155
0.0054
2.97e-4

0.0157
0.0056
4.45e-4

α = 90%

α = 99%

α = 99.9%

0.0481
0.0137
0.0068

0.0496
0.014
0.0069

0.0502
0.0144
0.007

α = 90%

α = 99%

α = 99.9%

0.0135
0.0035
9.89e-5

0.0137
0.0036
1.98e-4

0.0138
0.0037
2.97e-4

α = 90%

α = 99%

α = 99.9%

0.0486
0.0103
0.005

0.0497
0.0105
0.0051

0.0502
0.0108
0.0051

α = 90%

α = 99%

α = 99.9%

0.0126
0.0026
7.42e-5

0.0127
0.0027
1.48e-4

0.0129
0.0028
2.22e-4

III. CASE STUDIES

Wind data of more than 1,000 wind power plants from
Jan. 1st 2004 to Jan. 2nd 2007, including the point forecasts
and observed outputs, are collected from the Eastern Wind
Dataset released by NREL [6]. In this study, we select the
neighbour time periods whose forecast output rests in the
interval [1060 MW,1070MW], then we recover 426 data pairs.
By this treatment, we have rD ≈ RD and rU ≈ RU .

In the proposed method, we choose p = 1 such that problem
(3) gives rise to an LP. We select the ﬁrst 200, 300, 400 data
pairs out of the 426 data pairs as samples to estimate the
probability, respectively, while the empirical ramp probability
(ERP) and observed ramp probability (ORP) are simulated
by the known data pairs and all the data pairs, respectively.
The estimated probability of downward and upward ramping
event under different RD, RU and α are listed in Table I, from
which we can see, the probability offered by the proposed
method are quite close to the real ORP and always larger than
ERP. Moreover, the conservativeness can be reduced with the
number of samples increasing. The quasi-PDF of ramp event
when I = 400 is shown in Fig. 2, from which we see that the
ORP, ERP and estimated probability are quite close to each
other. Meanwhile, the average computation time is less than
0.05 second.

IV. CONCLUSIONS

A fully data-driven approach for estimating the probability
of wind ramping event is proposed. Possible PDFs of the wind
power forecast error are restricted in the functional Wasserstein
ambiguity set. The mathematical formulation of probability
estimation comes down to convex programs which are readily
solvable. Case study shows that our method gives monotoni-
cally better estimation when more samples are provided.

REFERENCES

[1] C. Ferreira, L. J. Gama, A. Botterud, and J. Wang, “A survey on wind
power ramp forecasting,” Technical Report, Argonne National Laboratory
(ANL), 2011.

[2] A. M. Foley, P. G. Leahy, A. Marvuglia, and E. J. McKeogh, “Current
methods and advances in forecasting of wind power generation,” Renew.
Energy, vol. 37, no. 1, pp. 1–8, Jan. 2012.

[3] P. Pinson and G. Kariniotakis, “Conditional prediction intervals of wind
power generation,” IEEE Trans. Power Syst., vol. 25, no. 4, pp. 1845–
1856, Nov. 2010.

[4] G. A. Hanasusanto, V. Roitch, D. Kuhn, and W. Wiesemann, “A dis-
tributionally robust perspective on uncertainty quantiﬁcation and chance
constrained programming,” Math. Program., Mar. 2015.

[5] N. Fournier and A. Guillin, “On the rate of the convergence in Wasserstein
distance of the empirical measure,” Probab. Theory Relat. Fields, 2015.
[6] N. R. E. L. (NREL). (2012) Eastern wind dataset. [Online]. Available:
http://www.nrel.gov/electricity/transmission/easternwindmethodology.html

