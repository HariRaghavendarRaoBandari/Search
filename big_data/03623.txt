Measurement-device-independent quantum key distribution with

nitrogen vacancy centers in diamond

Nicoló Lo Piparo,1 Mohsen Razavi,1 and William J. Munro2, 3

1School of Electronic and Electrical Engineering, University of Leeds, Leeds, UK

2NTT Basic Research Laboratories,

NTT Corporation, 3-1 Morinosato-Wakamiya,

Atsugi, Kanagawa, 243-0198, Japan.

3National Institute of Informatics, 2-1-2 Hitotsubashi, Chiyoda, Tokyo 101-0003, Japan.

Abstract

Memory-assisted measurement-device-independent quantum key distribution (MA-MDI-QKD)

has recently been proposed as a possible intermediate step towards the realization of quantum

repeaters. Despite its relaxing some of the requirements on quantum memories, the choice of

memory in relation to the layout of the setup and the protocol has a stark eﬀect on our ability to

beat existing no-memory systems. Here, a variant of MA-MDI-QKD that relies on nitrogen vacancy

(NV) centers as its quantum memories is proposed. We particularly focus on the cavity-enhanced

NV centers and show that, in terms of the secret key rate per transmitted pulse, we can beat the

existing no-memory QKD systems by up to three orders of magnitude. Using system parameters

achievable by the today’s state of the art, we then anticipate some total key rate advantage in

the distance range between 300 km and 500 km. Our analysis accounts for major sources of error

including the dark current, the channel loss, and the decoherence of the quantum memories.

6
1
0
2

 
r
a

 

M
1
1

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
3
2
6
3
0

.

3
0
6
1
:
v
i
X
r
a

1

I.

INTRODUCTION

Long-distance quantum key distribution (QKD) should ideally enable the exchange of
secret data without the need to trust intermediate nodes. Quantum repeaters are often
considered to be the main means to achieve this goal, but they are facing numerous tech-
nological challenges, e.g., the development of reliable quantum memory (QM) units, along
their way of implementation. A potentially feasible approach to increase the quantum com-
munication range has been proposed in [1, 2], where the authors introduce memory-assisted
measurement-device-independent QKD (MA-MDI-QKD) schemes. Their protocols resemble
a single-node quantum repeater link with QMs in the middle but only sources at the users’
ends. The performance of these memory-assisted schemes much relies on their employed
QMs. Initially, ensemble-based memories were considered as suitable candidates for such
systems because of their short sub-nanosecond writing times [3]. It turned out, however,
that, within the proposed schemes in [1], the multiple-excitation eﬀect in such QMs would
prevent the MA-MDI-QKD protocol to beat the no-memory QKD schemes [4]. To avoid
such problems, in this paper, we consider MA-MDI-QKD schemes that rely on nitrogen
vacancy (NV) centers in diamonds as quantum memories and we show that it is possible to
beat the existing no-memory schemes, in terms of rate versus distance, in certain regimes of
interest.

The MA-MDI-QKD schemes oﬀer the same advantages as in MDI-QKD [5], and aim to
improve its performance. They are resilient to side-channel attacks on the measurement de-
vices. In addition, they can improve the rate versus distance behavior as compared to single
no-QM QKD links. This can be achieved without necessarily requiring the same demanding
speciﬁcations on the QMs as often needed in quantum repeaters. More speciﬁcally, in [1], it
has been shown that it would be possible to beat existing no-memory QKD systems if one
uses fast memories with large storage-bandwidth products. Among diﬀerent technologies for
QMs, ensemble-based memories can potentially satisfy both required conditions. However,
this type of memory suﬀers from multiple-excitation eﬀects, which introduce some errors in
the QKD setups relying on these QMs. In [4], authors show that, within the setups proposed
in [1], such eﬀects are so detrimental that the ensemble-based MA-MDI-QKD scheme cannot
outperform the no-memory schemes in practical regimes of interest.

One possible solution to avoid the multiple-excitation eﬀect is to use quasi-single-atom

2

QMs in the MA-MDI-QKD setup. Among various QMs in this category, quantum dots and
NV centers in diamond have received particular attention in the past few years. The former
though have very short spin coherence time, T2, ranging from 2 ns to over 200 ns [6, 7], which
could prove too short to be eﬀective in the MA-MDI-QKD setup. NV centers, instead, have
coherence times up to milliseconds, which can be extended to seconds when their electron
spin state is transferred to nuclear spins [8, 9]. NV centers, nevertheless, must be embedded
into cavities if eﬃcient coupling with photons is required [10].

NV centers can be entangled with photonic states [11, 12]. This is one of the require-
ments in key protocols proposed in [1]. In order to achieve a high key generation rate, this
entangling procedure must have a reasonably high rate of success on the order of 0.1 − 1.
In [12], however, the probability of creating a QM-photon entangled state is on the order
of 10−7 to 10−6, which is extremely low for the application we have in mind. The achieved
ﬁdelity is also rather low at around 70% [12]. There are other experiments [13], in which two
NV centers are entangled via their interaction with photons. The rate of success is again low
considering that in neither experiment the NV centers are embedded within a cavity. In [11],
the authors propose an alternative scheme for cavity−enhanced NV centers that can po-
tentially create memory-photon entangled states with an extremely high ﬁdelity (F > 0.99)
and high entangling rates at around 6%, with a possibility of further enhancement. There,
the authors use two NV centers in diamond, each inside a cavity, to create a spin entangled
pair. The essence of this method is based on how the NV center state aﬀects the reﬂectivity
of the cavity system.

In this paper, we consider two scenarios for MDI-QKD with NV centers. The ﬁrst setup
is based on the experimental demonstration in [12]. Although we do not expect that this
method oﬀers any advantages over no-QM systems, we can ﬁnd out how much cavity en-
hancement is needed in order to outperform the no-QM QKD setups. Our key solutions
are then based on cavity-enhanced NV centers using the techniques proposed in [11]. We
propose and analyze a diﬀerent setup, based on polarization encoding, which can, also, be
extended to a phase-encoding scheme. In this setup, we entangle a polarized photon with the
spin state of an NV center. This scheme has the advantage of using only one QM per user
but polarization stability must be maintained. For all proposed MA-MDI-QKD schemes,
we calculate the secret key generation rate as the main ﬁgure of merit and compare it with
that of the no-memory system. In our analysis we account for major sources of imperfection

3

Figure 1. Diﬀerent setups for memory-assisted MDI-QKD as proposed in [1]: (a) MDI-QKD with

directly heralding quantum memories and (b) MDI-QKD with indirectly heralding quantum mem-

ories.

such as dark current in detectors and path loss as well as the decoherence of the QMs.

The paper is structured as follows. In Sec. II, we review the MA-MDI-QKD schemes
proposed in [1], highlighting, and, updating, their measurement procedures. In Sec. III, we
describe the entanglement generation protocols reported in [11, 12] and we propose memory-
assisted schemes with NV centers as memories. In Sec. IV, we describe our methodology for
calculating the secret key generation rate for the proposed protocols, assuming that perfect
single-photon sources are used at the users’ ends. This is not an essential assumption; it
just provides a convenient approach to compare memory-assisted schemes with their no-QM
counterparts. In practice, one can use decoy-state techniques, for which similar margins of
improvement over decoy-state no-QM systems are expected. We continue by providing some
numerical results before we draw our conclusions in Sec. V.

II. MEMORY-ASSISTED MDI-QKD

In this section, we describe the memory-assisted MDI-QKD schemes presented in [1]. We

also introduce new methods of measurement when QMs are involved.

MA-MDI-QKD inherits all the positive features of MDI-QKD, and can potentially im-
prove them in some aspects. MDI-QKD relies on the time-reversed entanglement idea [14],
in which Alice and Bob will send BB84-encoded states to a middle station at which entan-
glement swapping will take place. By relying on entanglement for its secret key sharing, the
devices used in the middle station do not need to be trusted. The same feature holds for
MA-MDI-QKD, shown in Fig. 1(a), where, now, the middle station includes supplementary

4

QMs. In MDI-QKD, in order to perform the entanglement swapping operation, both users’
photons must survive the path loss and reach the middle station. In order to improve the
rate-versus-distance behavior, in MA-MDI-QKD, we ﬁrst store the transmitted photons in
their respective QMs and entanglement swapping operation is only carried out when both
QMs are known to be loaded with their corresponding photon; that is, the state of the
photon has been, in a directly or indirectly heralding way, transferred to the corresponding
QM. This way, in a symmetric setup, the key rate would scale with the loss in half of the
channel, rather than its entire length.

There are two generic approaches to loading QMs. If we have memories for which we
can non-destructively verify if the loading has been successful, then we can use the setup in
Fig. 1(a). The QMs, e.g. single atoms/ions, that can directly herald the storage of photons
are, however, limited and their heralding mechanism is often too slow for our MA-MDI-
QKD application. The second approach is based on the teleportation idea as shown in Fig.
1(b). Here, we ﬁrst entangle a photon with the QM state, and then teleport the state of
the photon sent by the user, using an additional Bell-state measurement (BSM) on the side
onto the QM. The side BSMs as well as the middle BSM will all be carried out by the party
in the middle. This solution allows us to use a larger group of QMs within our setup. Once
a memory is loaded, we wait until the other memory is loaded too before performing the
middle BSM.

The middle BSM in Fig. 1(b) can be carried out in diﬀerent ways. In [1], the authors
assume that the states of the QMs can be transferred back to photons (the QMs carry no
information from that point on), and then we can use the type of linear optical modules
shown in Figs. 2(a) and (b) to perform a partial BSM. In this paper, we refer to this scheme
by the reading protocol. An alternative approach is to again entangle a photon with each
QM and do the partial BSM on these photons. This is known as the double-encoding scheme
[15]. If the BSM is successful, a further X-basis measurement needs to be done on the QMs
to enable an indirect BSM on the memories’ states. Finally, one can potentially use a direct
BSM on QMs without any interaction with photons. The suitable type of measurement is
determined by the QM in use. In the key scheme proposed here, the double-encoding scheme
is the most practical option for the middle BSM. Side BSMs are performed on two optical
modes, for which we use the linear optical module in Fig. 2(a), for polarization encoding,
and the one in Fig. 2(b) for phase encoding systems.

5

Figure 2. Bell-state measurement modules for (a) polarization and (b) phase-encoded states. (c)

The common building block in (a) and (b), and its simpliﬁed version (on the right), when the

setup’s ineﬃciencies are considered. In (c), ηr, ηD, and ηch, respectively, represent the reading,
detector, and channel eﬃciencies, and ηa = ηDηch and ηb = ηDηr .

The MA-MDI-QKD, while improving the key rate versus distance behavior and making
the system more resilient to detector errors, may suﬀer from the errors that QMs generate.
In fact, given that the outcome of the middle BSM mainly depends on the states of QMs
at the time of measurement, any QM error directly impacts the total quantum bit error
rate (QBER). For instance, the decoherence eﬀect can have a detrimental eﬀect on the
performance. This eﬀect has been studied in [1], and it turned out that our employed QMs
should have a long coherence time as compared to the repetition period of the protocol.
Given that the latter is a function of the access time of the QMs, e.g., for writing into and
reading QMs, one key requirement for the QM in the setup of Fig. 1(b) is to have a large
storage-bandwidth product. Nevertheless, the requirement on the coherence time could be
a mild one if we have a fast memory. These two characteristics, i.e., being fast and having a
large storage-bandwidth product, to some extent can be attributed to atomic-ensemble QMs.
The application of such QMs in the setup of Fig. 1(b) has been studied in [4]. The results,
however, indicate that the multiple-excitation eﬀect in such memories can be a detrimental
source of error for such systems. In [4], authors suggest the use of nearly ideal entangled
photon sources as a solution. Here, we take another approach and use NV centers, i.e., an
in-principle single-atom-like QM, in Fig. 1(b), to avoid multiple-excitation eﬀects. This will
be described in the following section.

6

III. MEMORY-ASSISTED MDI-QKD WITH NV CENTERS

In this section we introduce two memory-assisted MDI-QKD schemes with NV centers as
QMs. The ﬁrst scheme is based on recent experimental trial of entangling photons with NV
centers [12]. The very low coupling eﬃciency in this experiment would make this scheme
less of a competitor with no-memory systems. In order to improve the coupling eﬃciency,
we then use the cavity-enhanced NV center proposed in [11], and propose an alternative
setup with polarization encoding for NV-center-based MA-MDI-QKD.

We use NV centers as QMs in the indirectly-heralding MA-MDI-QKD setup of Fig. 1(b)
with a polarization encoding scheme. In this case, the BSM module shown in Fig. 2(a) is
used. The BSM is successful if exactly two detectors, one H-labeled and one V -labeled, click.
Depending on the click pattern, Alice and Bob can ideally infer which bit they share [16].
One can alternatively use the phase-encoding scheme, for which the corresponding BSM
module, in the case of a dual-rail qubit representation, is shown in Fig. 2(b). This structure
can easily be converted to the one used for time-bin encoding for practical purposes. In Fig.
2(b), the BSM is successful if one, and only one, of the upper detectors and one, and only
one, of the lower detectors click. Again, Alice and Bob can identify which bit they share
depending on the click pattern [4].

Below we present in more detail the procedure to entangle a photon with the QM by
examining the existing experimental setup in [12] and, then, by looking at other schemes in
which the NV centers are embedded into optical cavities.

A. Scheme I: MDI-QKD with non-cavity NV centers

Our ﬁrst proposed MA-MDI-QKD system is based on the setup in Fig. 1(b), where NV
centers are used as QMs. We follow the scheme presented in [12] to entangle a single photon
with the electronic spin of an NV center. As shown in Fig. 3, the NV center is prepared in
a speciﬁc excited state |A2 (cid:105) that decays with equal probability into two diﬀerent long lived
spin states, namely, |s±1 (cid:105), representing the ±1 electron spin states. Such a transition would
correspondingly result in emitting orthogonal circularly polarized photons, |σ+ (cid:105) and |σ− (cid:105),
in the following entangled state with the QM [12]

7

|Ψ1 (cid:105) =

1√
2

(|σ− (cid:105)|s+1 (cid:105) + |σ+ (cid:105)|s−1 (cid:105) ) .

(1)

There are several practical issues with the above entangling procedure. First, there is
the issue of eﬃciency. In this setup, a combination of poor collection eﬃciency and weak
NV-center-photon coupling results in a very low success rate on the order of 10−6 [12]. This
problem, to some extent, can be alleviated by introducing cavities around the NV centers.
Nevertheless, the resulting ﬁdelity for the entangled states can still be an issue with the
experiment only demonstrating F ≥ 0.69. Finally, once both QMs in Fig. 1(b) are loaded,
we need to somehow perform the central BSM operation on these QMs. This is, however,
a challenging task within this setup, as neither the reading nor the double-encoding scheme
can easily be implemented in this setup.

In our analysis, we assume that the entangled state in Eq.

Considering the above issues the experimental method in [12] has little chance to beat
no-QM systems. We, nevertheless, consider this case as a reference point by making some
assumptions.
(1) is always
generated but because of the collection eﬃciency, the generated photon is directed to the
side BSM with probability pc. This way we ignore some of the other non-idealities that bring
the ﬁdelity down. The resulting density matrix for the NV center (NV) and the collected
photon (P) is then given by

ρNV−P = pc|Ψ1 (cid:105)(cid:104)Ψ1| + (1 − pc)|0(cid:105)PP(cid:104)0| ⊗ INV

(2)
where INV = |s+1 (cid:105)(cid:104)s+1| + |s−1 (cid:105)(cid:104)s−1| and |0(cid:105)P represents the vacuum state for the collected
photonic mode. The rest of the protocol is as in Fig. 1(b), that is, in each round, we generate
the entangled state in Eq. (2) on each side, and interfere the photonic part, at the side-BSM,
with the user’s photon. If successful, we consider the corresponding QM loaded, and wait
for the loading of the other QM, before proceeding to the middle BSM.
Next, we consider MA-MDI-QKD with cavity-enhanced NV centers.

B. Scheme II: MDI-QKD with cavity-enhanced NV centers

In this section, we propose an MA-MDI-QKD scheme that relies on cavity-enhanced NV
centers as QMs. The key building block is an NV center whose internal state aﬀects the
eﬀective reﬂectivity of the embedding cavity, as proposed in [11]. Figure 4 shows the relevant

8

Figure 3. The Λ−level structure for the NV center used in [12].

Figure 4. Relevant energy level structure for the cavity-enhanced NV center.

energy level-structure for the NV center. Here, |s0 (cid:105) and |s+1 (cid:105) represent the same electron
spin states as in Fig. 3, and |s0 (cid:105)E and |s+1 (cid:105)E are, respectively, their corresponding excited
states. The resonant frequencies for |s0 (cid:105) → |s0 (cid:105)E and |s+1 (cid:105) → |s+1 (cid:105)E transitions are,
respectively, denoted by ω0 and ω1 = ω0 + δ . In [11], authors assume that the NV center
is embedded in a double-sided cavity with resonance frequency ωC and reﬂectivities r1 and
r2 for, respectively, input and output mirrors, and that the cavity is on resonance with
|s0 (cid:105) → |s0 (cid:105)E transition. They use this feature to perform conditional operations depending
on the state of the NV center. We use the same idea but in the special case of a one-sided
cavity.

In general, as shown in [11], the interaction of a single photon with the composite NV
center-cavity system can be modeled by calculating the reﬂection amplitude, Ar, oﬀ the
cavity, and transmission amplitude, At, through the cavity. For an impinging photon with
frequency ωP , a cavity with resonance frequency ωC, and a two-level system embedded into
the cavity with resonance frequency ωi, these amplitudes are given by [11]

Ar = 1 −
At =

1−A

(1−i∆C )−2C/(1−i∆E ) ,

√

1−A2

(1−i∆C )−2C/(1−i∆E ) ,

(3)

where ∆C = (ωP − ωC) /κ, with κ being the cavity decay rate, ∆E = (ωP − ωi) /γ, with γ
being the spontaneous decay rate to modes other than the cavity mode, and the cooperativity
C = g2
κγ , with g being the coupling rate between the two-level system and the cavity mode. In

9

Figure 5. Entangling a polarized photon with an NV center in a cavity.

Eq. (3), A = r1−r2
is the amplitude of the reﬂected light for an empty cavity on resonance.
1−r1r2
In the following, by considering special cases for the above parameters, we come up with a
new encoding technique for NV-center-based MA-MDI-QKD. We assume ∆C = 0 and that
C (cid:29) 1 for the |s0 (cid:105) → |s0 (cid:105)E transition.

1. Scheme II with polarization encoding

Here we describe the key idea behind our polarization encoding MA-MDI-QKD scheme.
In this scheme, the users employ the typical setting for the eﬃcient BB84 encoders [17]
by sending H, V, or ±45◦ polarized single photons. In this paper, we assume ideal single-
photon sources are employed by the users. This is just for analytical convenience. Similar
performance is expected to be achieved if one uses the decoy-state technique with coherent
sources, and similar conclusions can be drawn about the eﬀectiveness of MA-MDI-QKD as
compared to existing no-QM counterparts.

For the middle station in Fig. 1(b), we consider NV centers embedded into one-sided

cavities, i.e., r2 = 1: Under this condition and ∆C = 0, Eq. (3) reduces to

Ar = 1 −

2

1−2C/(1−i∆E ) ,

At = 0.

(4)

In Eq. (4), if we assume ω0 = ωP , for an NV center in the state |s0 (cid:105), ∆E = 0, hence
Ar = 1. When the NV center is in the state |s+1 (cid:105), ∆E = −δ/γ. Assuming that δ (cid:29) γC, we
end up with Ar = −1. This implies that in both cases the photon will get reﬂected but it
will acquire diﬀerent phase shifts depending on the state of the NV center.

Using the above conditional phase gate, Fig. 5 depicts an entangling module, between a
photon and the NV center, for each leg of Fig. 1(b). Here, the NV center is initialized in

10

(cid:11)= (|s0 (cid:105) + |s+1 (cid:105)) /

√

a superposition state |Ψin
2 . This process is done by optical pumping
of the NV center to the |s0 (cid:105) state using a laser and a subsequent π/2 microwave pulse
[11, 18]. This procedure roughly takes 1 to 5 ns [11]. Then, a +45◦-polarized single photon
with frequency ω is sent to a polarizing beam splitter (PBS), which splits the signal into its
orthogonal H and V components. The |H (cid:105) component will be sent to the r mode and the
|V (cid:105) component to the s mode, where the latter will interact with the NV center resulting in
√
the joint state |V (cid:105)s (|s0 (cid:105) − |s+1 (cid:105)) /
2. The photonic modes r and s are then recombined
at a second PBS, which will ideally result in the following output state

(|D (cid:105) |s0 (cid:105) + |A(cid:105) |s+1 (cid:105)) → |Ψ2 (cid:105) =

1√
2

1√
2

(|H (cid:105) |s0 (cid:105) + |V (cid:105) |s+1 (cid:105)) ,

(5)

where |D (cid:105) and |A(cid:105) respectively, represent +45◦ and −45◦-polarized single photon states. In
Eq. (5), we assume that, using a proper waveplate, |D (cid:105) and |A(cid:105) are, respectively, mapped
to |H (cid:105) and |V (cid:105). In practice, this may not be necessary if one uses rotated frames.

The rest of the MA-MDI-QKD protocol will be as follows. The output photon from the
module in Fig. 5 will then interfere with the signal sent by the user in the side-BSM of
Fig. 1(b). If this BSM is successful, the memory is assumed to be loaded, up to a known
rotation once the side-BSM results are exchanged, with the state sent by the user. Once
both memories are loaded, they are double-encoded by sending again +45◦-polarized single
photons to the module in Fig. 5. This would map the QM state |s0 (cid:105) to |s0 (cid:105)|H (cid:105),
|s+1 (cid:105) to
|s+1 (cid:105)|V (cid:105), and |s0 (cid:105)±|s+1 (cid:105) to |s0 (cid:105)|H (cid:105)±|s+1 (cid:105)|V (cid:105). The resulting photons from the two QMs
will then undergo a ﬁnal partial BSM at the middle station, whose results will also be shared
with the users. Finally, we perform an X-basis measurement, in the |s0 (cid:105) ± |s+1 (cid:105) basis, on
the NV centers and will send its results to the end users. The latter electron spin read-out
can be done by sending coherent pulses and it typically takes 20 to 30 ns [11]. At the sifting
stage, once the users exchange the basis information, they use measurement information
exchanged with the middle station to infer whether they share identical or opposite bits.

One practical point to consider here is that the two arms in the module of Fig. 5 may
be imbalanced due to ineﬃciencies in the reﬂection process. To make the two arms equally
lossy, we have then included a beam splitter with transmissivity η in the r branch. The
value of η will be chosen according to the amount of loss in the s branch. By accounting
for loss in the two arms of this module, the output state will no longer be a pure state as
in Eq. (5), and, instead, the joint state of the NV center and the released photon in Fig. 5

11

will be given by

(cid:48)

(cid:48)
NV,

ρNV−P = η2|Ψ2 (cid:105) (cid:104) Ψ2| + (1 − η2)|0(cid:105)PP(cid:104) 0| ⊗ I

(6)
NV = |s0 (cid:105)(cid:104)s0| + |s+1 (cid:105)(cid:104)s+1|. This is similar to Eq. (2), with the diﬀerence that now η
where I
can be several orders of magnitude larger than pc. With the above state, we expect that the
user’s state will be properly teleported to the QM in majority of cases where the side-BSM
has been successful, i.e., two detectors have clicked. The vacuum state in Eq. (6) ideally
should not result in a successful side-BSM. But, with a rate proportional to the detector’s
dark count rate, we may still get erroneous side-BSM results that may induce errors in the
end. Although small, we consider this eﬀect in our key rate calculations in Sec. IV.

There are several requirements for the above setup to work properly. First, we assume
that strong coupling between the NV center and a microcavity can be established. Second,
this setup requires nearly on-demand single-photon sources (SPSs) at the middle station.
Here, we assume that the employed SPSs may be probabilistic, but they generate true single
photons. The latter assumption is crucial as, otherwise, the multi-photon errors at the
middle station can be detrimental to the key objective behind MA-MDI-QKD [4]. Finally,
we need to maintain polarization across the channel, which can be challenging over long
distances. This condition can be alleviated by using an equivalent phase-encoding scheme
[16].

In the next section we analytically calculate the secret key rate of the proposed protocols

and we compare them with existing no-memory QKD schemes.

IV. KEY RATE ANALYSIS

In this section the secret key generation rate of the proposed setups in Sec. III is obtained
under the normal operation condition when no eavesdropper is present. In [1], the total secret
key generation rate, using the eﬃcient QKD protocol when ideal single photon sources are
used by the users and the Z basis is more often used than the X basis, is lower bounded by
the following expression

RQM =

RS

NL (PA, PB) + Nr

Y QM
11

(1 − h(eQM

11;X) − f h(eQM

11;Z)),

(7)

where PA and PB represent the probability of a successful side-BSM on, respectively, Alice
and Bob’s side; Y QM
is the probability that the middle BSM is successful assuming that

11

12

Figure 6. Secret key generation rates per transmitted pulse versus distance for the proposed MA-

MDI-QKD schemes in comparison with the upper bound obtained in [19]. Nominal values are used

as in Table I.

11;X and eQM

both memories are loaded (in the Z basis); eQM
11;Z are, respectively, the quantum bit
error rate (QBER) between Alice and Bob in the X and Z basis when single photons are
sent by the users; f is the ineﬃciency of error correction; h(q) = −q log2 q−(1−q) log2(1−q)
is the binary entropy function; RS = 1/T is the repetition rate; NL is the average number of
trials to load both memories, which is approximated by 3/(2PA) when PA = PB (cid:28) 1; and,

(cid:3) − 1 is the number of rounds that we lose from the time that both memories

Nr =(cid:2) τw+τr

T

are loaded until we learn the result of the ﬁnal BSM operation. Here, τw = τinit + τent is the
writing/loading time, where τinit is the time that it takes to initialize the QMs and τent is the
time elapsed on the photon-QM entangling procedure. In practice, the fastest rate that we
can repeat our MA-MDI-QKD protocol is upper bounded by 1/τw. In above, τr = τDE + τPM
is the reading time, where τDE is the corresponding time to the double-encoding procedure
and τPM is the time that it takes to do the follow-up measurements. In Scheme II, τPM = τX
is the time it takes to perform an X-basis measurement on an NV center.

We have used the machinery developed in [1] and [4] to ﬁnd the key parameters in Eq.

13

010020030040050060070080010−1510−1010−5100Distance, L (km)Secret ket rate (b/pulse)  Scheme IIPirandola et al. boundScheme IT2 = ∞T/T2 =10−5T/T2 =10−7pc= 10−6pc= 10−3Quantum eﬃciency, ηD

Source eﬃciency, ηs

Dark count per pulse, dc
Attenuation length, Latt
Attenuation eﬃciency, η

Initializing time, τinit
Entangling time, τent

0.93

0.72
10−9
25 km

0.9

5 ns

negligible

Double-encoding procedure time, τDE

5 ns

X-measurement time, τPM

30 ns

Table I. Nominal values used in our numerical results. The initializing time, τinit, is the time
required to initialize the NV center in the state (|s0 (cid:105) + |s+1 (cid:105) ) /
2. The entangling time is the
time to perform a side-BSM.

√

(7) the details of which appear in Appendix A. The derivations are cumbersome and have
mostly been done by the symbolic software Maple. In short, for each scheme, we ﬁrst obtain
the state of the QMs once the user’s state is loaded to them. Our calculation includes all
loss elements, dark count, and all the nonidealities we modeled in the entangling procedures
in Sec. III. At this stage, we also ﬁnd PA and PB. We then model memory decoherence
using a depolarizing channel, with a time constant T2, and perform the ﬁnal BSM on the
decohered states of the QMs, taking into account the statistics of loading. As a result, we
can calculate the remaining term in Eq. (7), i.e., Y QM

, eQM

11

11;X, and eQM
11;Z.

Figure 6 shows the secret key generation rate per transmitted pulse for the two proposed
schemes in Sec. III, as well as the capacity bound for a QKD system in a lossy channel
[19], versus distance. The latter provides an upper bound on all hitherto implemented
QKD systems. We have used a nominal set of values, as listed in Table I, for all relevant
parameters. These values correspond to the state-of-the-art devices or experiments. For
instance, a superconducting photodetector with 93% eﬃciency and a dark count rate of 1/s
is reported in [20]. Quantum dot sources with eﬃciencies in the range of 70% have also been
reported in [21]. The corresponding time parameters are also taken from existing literature
on NV centers [11, 22].

All the curves in Fig. 6 have been obtained at RS = 1/s and τw = τr ≈ 0. It can be seen

14

Figure 7. Comparison of the total secret key generation rate, in bit per second, versus distance for

the MA-MDI-QKD scheme II and the no-memory MDI-QKD system.

that in all memory-based schemes the slope of the curves is half of that of no-QM system,
which is an indication of the repeater nature of MA-MDI-QKD schemes. Despite of that,
Scheme I with a nominal value of pc = 10−6 has no chance to beat the no-QM systems. This
is because the rate of entanglement generation in this scheme is so low that before its curve
gets to surpass the no-QM curve [19], the rate goes down because of other sources of error
such as dark count. Under nearly ideal conditions, pc should be increased by three order of
magnitudes to make the two systems comparable. This shows the necessity of using cavity-
enhanced NV centers in MA-MDI-QKD. For the cavity-enhanced scheme II the coherence
time could be the limiting factor. The ﬁgure shows that in order that the cavity-enhanced
schemes outperform no-QM systems, a rather large ratio between T2 and T is required. This
necessitates using the shortest possible T , which is given by the true writing time into the
QMs, as we see next.

Figure 7 shows the total secret key generation rate, in bit per second, versus distance for
the proposed setups as well as the MDI-QKD scheme proposed in [5] with no memory. The
total rate is a good measure to assess, if, in practice, we can improve the rate-versus-distance
behavior by using QMs. Here, RS for the no-QM system is assumed to be 1 GHz, whereas

15

010020030040050060070080010−5100105Distance, L (km)Secret key rate (b/s)  MDI−QKDScheme IIT2 = ∞T2 = 10 msit is given by 1/τw for the MA-MDI-QKD schemes. It can be seen that for coherence times
on the order of 10 ms, there is a window between 300 km and 500 km, in which the MA-
MDI-QKD systems outperform the no-QM one. This is an achievable range of coherence
times using existing technologies. For instance, in [23], authors ﬁnd an optimized protocol
for preserving a general NV ensemble state at 77 K and they show that they can reach spin
coherence times up to approximately 30 ms. It is also possible to transfer the electron-spin
state to the nuclear-spin state.
In this case the coherence time would increase to up to
seconds. This is a promising result showing the potential of cavity-enhanced NV centers in
future long-distance QKD networks.

Note that, while MA-MDI-QKD is capable of beating existing no-QM systems over a
range of distances, for a no-limit trust-free long-distance QKD one eventually needs to use
quantum repeater structures [24]. MA-MDI-QKD, nevertheless, provides an intermediary
solution compatible with the state of the art, and it can pave the way for future generations
of quantum networks.

V. CONCLUSIONS AND DISCUSSIONS

In this paper, we proposed two MA-MDI-QKD schemes using NV centers as QMs. We
ﬁrst considered the scheme in [12] where a polarized photon was entangled with an NV
center. We used this scheme in an MA-MDI-QKD protocol with polarization encoding.
However, the low probability associated to the creation of the entangled states would not
allow this system to outperform the no-memory QKD systems. We then looked at the
cavity-enhanced QMs in [11], which could oﬀer much higher entangling probabilities with
high ﬁdelities. Using such QMs, we proposed a memory-assisted MDI-QKD scheme with
NV centers in diamond embedded into cavities. We showed that the performance of this
setup in terms of the key rate per pulse could be higher than the conventional no-memory
QKD for a distance L ≥ 200 km. The total key rate for our MA-MDI-QKD scheme could
also beat the no-QM counterpart over a window of 300 km≤ L ≤ 500 km.

In analyzing our system, we have made certain assumptions which will have certain
implications in practice. Firstly, our scheme is based on an NV center embedded within a
microcavity. Such a device needs to be fabricated but progress is being made by several
groups worldwide. It is, however, challenging as we need to work in the high cooperativity

16

limit but also have the cavity operating in a polarization-degenerate fashion. Secondly,
we require a near deterministic high repetition single photon source matched to our NV
center. Here, we are fortunate as the NV centers embedded within the microcavity can
also act as a single photon source, their multi-photon rate is extremely small. The progress
with the similar technology of quantum-dot sources is in fact quite promising, and has
resulted in sources with high eﬃciencies (70%) and low g(2) (0) values (< 0.01) [25]. Once
we have proper sources that can interact with our QMs, one should also consider the use of
frequency converters to enable the interaction between a QM-driven photon and the telecom
photon sent by the user. This could reduce the total eﬃciency of our BSM operations. In
[26], authors demonstrate upconversion-assisted single-photon detection for the 1.55-µm
telecommunications band based on a periodically poled lithium niobate (PPLN) waveguide
pumped by a monolithic PPLN optical parametric oscillator. They obtain very low values
for the noise in the quantum frequency regime [26]. In a more recent work, an upconversion
eﬃciency of 16% has been reported [27].

Overall, while one needs to put together the best of the best from available technologies
to demonstrate the advantages of our proposed scheme, this is a path worth taking as it is
a precursor to eventual long-distance quantum communications. Note that in special cases,
where the total loss per unit length is higher than that of the ﬁber loss, e.g. in passive optical
networks with high splitting losses, MA-MDI-QKD oﬀers rate advantage even over a short
range of distances [28]. This could perhaps be the ﬁrst realistic scenarios in which quantum
memories, with all their known practical limitations, can be used to oﬀer a tangible beneﬁt.

Appendix A: MDI-QKD with imperfect memories

In this Appendix we explain the general procedure to derive the terms in Eq. (7) for
the proposed setups in Sec. III. We consider path loss, given by e−L/Latt for a distance L
and a channel attenuation length Latt, quantum eﬃciency ηD, and dark count per pulse
dc, assuming that no eavesdropper is present. We also account for memory decoherence,
modeled by a depolarizing channel, which maps an initial state ρQM (0) to

ρQM (t) = pρQM (0) + (1 − p) I/dim (ρQM (0)) ,

(A1)

17

after a t-long period of decoherence, where I is the identity operator, p = e−t/T2 , and T2 is
the coherence time of the NV center. This model properly captures the decoherence eﬀect
in an NV center [29].

We ﬁrst calculate PA and PB by ﬁnding the probability of a successful side-BSM when
Alice and Bob use the Z basis for encoding their bits. This can be done by modeling all the
lossy elements in each leg of Fig. 1(b) by beam splitters and then simplifying the model by
techniques shown in Fig. 2(c). The resulting butterﬂy module has been analyzed for relevant
input states in Appendices A and B of [4]. Here, we avoid duplicating the same results and
simply use them to ﬁnd the success probabilities PA and PB as well as the resulting state
for Alice and Bob’s QMs after a successful side-BSM.

The second step in our key rate analysis is to derive the error and yield terms correspond-
ing to the middle BSM. For this, we need to account for the decoherence in one memory
while it waits for the other memory to be loaded. The decoherence eﬀect can be modeled
by using Eq. (A1) at p = exp (−|NA − NB|T /T2), where NA and NB represent the round
at which Alice and Bob’s QMs are, respectively, loaded. NA and NB follow a geometric
distribution with success probabilities PA and PB, respectively. The derivation of yield and
QBER terms have been fully detailed for a dephasing channel in [1]. Here, we modify the
analysis in Appendix D of [1] to replace the dephasing channel with the depolarizing channel
used here, and carry out the same calculations as required by Eqs. (3.3) and (3.7) in [1].
The derivations are cumbersome, but with a combination of results in [4] and [1], one can
ﬁnd all relevant terms in Eq. (7) as a function of the system parameters. For brevity, the
full derivation is left to the reader.

[1] C. Panayi, M. Razavi, X. Ma, and N. Lütkenhaus, New. J. Phys. 16, 043005 (2013).

[2] S. Abruzzo, H. Kampermann, and D. Bruss, Phys. Rev. A 54, 012301 (2014).

[3] K. F. Reim, P. Michelberger, K. C. Lee, J. Nunn, N. K. Langford, and I. A. Walmsley, Phys.

Rev. Lett. 107, 053603 (2011).

[4] N. Lo Piparo, M. Razavi, and C. Panayi, IEEE Journal of selected topics in quantum elec-

tronics 21, 6601010 (2015).

[5] H.-K. Lo, M. Curty, and B. Qi, Phys. Rev. Lett. 108, 130503 (2012).

18

[6] D. Brunner, B. Gerardot, P. Dalgarno, G. Wuest, K. Karrai, N. Stoltz, P. Petroﬀ,

and

R. Warburton, Science 325, 70 (2009).

[7] K. De Greve, P. L. McMahon, D. Press, T. Ladd, D. Bisping, C. Schneider, M. Kamp,

L. Worschech, S. Hoﬂing, A. Forche, and Y. Yamamoto, Nature Phys. 7, 872 (2011).

[8] T. Ishikawa, K.-M. C. Fu, C. Santori, V. M. Acosta, R. G. Beausoleil, H. Watanabe, S. Shikata,

and K. M. Itoh, Nano Letters 12, 2083 (2012).

[9] N. Bar-Gill, L. M. Pham, A. Jarmola, D. Budker, and R. L. Walsworth, Nature Communica-

tions 4, 1743 (2013).

[10] W. B. Gao, A. Imamoglu, H. Bernien, and R. Hanson, Nature photonics 9, 363 (2015).

[11] K. Nemoto, M. Trupke, S. J. Devitt, A. M. Stephens, B. Scharfenberger, K. Buczak,

T. Nöbauer, M. S. Everitt, J. Schmiedmayer, and W. J. Munro, Phys. Rev. X 4, 031022

(2014).

[12] E. Togan, Y. Chu, A. S. Trifonov, L. Jiang, J. Maze, L. Childress, M. V. Dutt, A. S. Sorensen,

P. R. Hemmer, A. S. Zibrov, and M. D. Lukin, Nature Letters 466, 730 (2010).

[13] H. Bernien, B. Hensen, W. Pfaﬀ, G. Koolstra, M. S. Blok, L. Robledo, T. H. Taminiau,

M. Markham, D. J. Twitchen, L. Childress, and R. Hanson, Nature 497, 86 (2013).

[14] E. Biham, B. Huttner, and T. Mor, Phys. Rev. A 54, 2651 (1996).

[15] D. E. Bruschi, T. M. Barlow, M. Razavi, and A. Beige, Phys. Rev. A 90, 032306 (2014).

[16] X. Ma and M. Razavi, Phys. Tev. A 86, :062319 (2012).

[17] H.-K. Lo, H. F. Chau, and M. Ardehali, Journal of Cryptology 18, 133 (2005).

[18] J. Cai, A. Retzker, F. Jelezko, and M. B. Plenio, Nat. Physics 9, 168 (2013).

[19] S. Pirandola, R. Laurenza, C. Ottaviani, and L. Banchi, arXiv:1510.08863 (2015).

[20] F. Marsili, V. B. Verma, J. A. Stern, S. Harrington, A. E. Lita, T. Gerrits, I. Vayshenker,

B. Baek, M. D. Shaw, R. P. Mirin, and S. W. Nam, Nat. Photon. 7, 210 (2013).

[21] J. Caudon and et al., Nat. Photon. 4, 174 (2010).

[22] M. S. Everitt, S. Devitt, W. J. Munro, and N. K, Phys. Rev. A 98, 052317 (2014).

[23] D. Farfurnik, A. Jarmola, L. M. Pham, Z.-H. Wang, V. V. Dobrovitski, R. L. Walsworth,

D. Budker, and N. Bar-Gill, arXiv:1505.00636 (2015).

[24] N. Lo Piparo and M. Razavi, IEEE Journal of selected topics in quantum electronics 21,

6600508 (2015).

[25] J. Claudon, J. Bleuse, N. S. Malik, M. Bazin, P. Jaﬀrennou, N. Gregersen, C. Sauvan,

19

P. Lalanne, and J. M. Gerard, Nature photonics 4, 174 (2010).

[26] J. S. Pelc, L. Ma, C. Phillips, Q. Zhang, C. Langcrock, O. Slattery, X. Tang, and M. M. Fejer,

Optics Express 19, 21445 (2011).

[27] J. Wang, T. Ming, Z. Jin, J. Wang, L.-D. Sun, and C.-H. Yan, Nature Comm. 5, 5669 (2014).

[28] D. Luong, L. Jiang, J. Kim, and N. Lütkenhaus, arXiv:1508.02811v1 (2015).

[29] T. Ishikawa, K.-M. C. Fu, C. Santori, V. M. Acosta, R. G. Beausoleil, H. Watanabe, S. Shikata,

and K. M. Itoh, Nano Letters 12, 2083 (2012).

20

