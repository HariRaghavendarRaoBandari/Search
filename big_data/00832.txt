Robust Defense Strategy for Gas-Electric Systems

Against Malicious Attacks

Cheng Wang, Wei Wei, Member, IEEE, Jianhui Wang, Senior Member, IEEE, Feng Liu, Member, IEEE,
Feng Qiu, Member, IEEE, Carlos M. Correa-Posada, Student Member, IEEE, Shengwei Mei, Fellow, IEEE

1

6
1
0
2

 
r
a

 

M
3
2
 
 
]

.

C
O
h
t
a
m

[
 
 

2
v
2
3
8
0
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—This paper proposes a methodology to identify and
protect vulnerable components of connected gas and electric
infrastructures from malicious attacks, and to guarantee a
resilient operation by deploying valid corrective actions (while
accounting for the interdependency of gas pipeline network
and power transmission network). The proposed mathematical
formulation reduces to a tri-level optimization problem, where the
lower level is a multiperiod economic dispatch of the gas-electric
system, the middle level distinguishes the most threatening attack
on the coupled physical
infrastructures, and the upper level
provides optimal preventive decisions to reinforce the vulnerable
components and increase the system resilience. By reformulating
the lower level problem as a mixed integer linear programming
(MILP), a nested column-and-constraint generation (C&CG)
algorithm is developed to solve the min-max-min model. Case
studies on two test systems demonstrate the effectiveness and
efﬁciency of the proposed methodology.

Index Terms—natural gas system, power system, interdepen-

dency, tri-level optimization, vulnerability.

NOMENCLATURE

Most of the symbols and notations used throughout this
paper are deﬁned below for quick reference. Others are deﬁned
following their ﬁrst appearances, as needed.

A. Sets and Indices

Time periods

t ∈ T
g ∈ G Traditional units
n ∈ N Gas-ﬁred units
Power grid nodes
i ∈ I
Power grid lines
l ∈ L
d ∈ D Power grid loads
w ∈ W Gas wells
s ∈ S
c ∈ C
j ∈ J
y ∈ Y
e ∈ E Gas loads

Gas storage tanks
Gas compressors
Gas network nodes
Gas network lines

This work is supported by the National Natural Science Foundation of
China (51321005). The work of J. Wang and F. Qiu is sponsored by the U.
S. Department of Energy. (Correspond to: Wei Wei)

C. Wang, W. Wei, F. Liu, and S. Mei are with Department of
Electrical Engineering, Tsinghua University, 100084 Beijing, China. (c-
w12@mails.tsinghua.edu.cn; wei-wei04@mails.tsinghua.edu.cn).

J. Wang and F. Qiu are with Argonne National Laboratory, Argonne, IL

60439, USA (jianhui.wang@anl.gov; fqiu@anl.gov).

C. M. Correa-Posada is with the Colombian System Operator XM, Medelln,

Colombia (cmcorrea@xm.com.co).

B. Parameters

g

/P max
/P max

g

n

+/Rg
−
+/Rn
−

X
A
P min
P min
n
Rg
Rn
Fl
pdt
πl
fg(·)
Qd
ugt, unt
τ u
j , τ l
j
s,max, qout
qin
ru
s , rl
s
βn
γc
φy
Qw, Qe, Qs
qet
T emp
Zy
Liney
Ry
ρ0
µ
Fy
λ

s,max Maximum gas storage in/out range

Defense budget
Attack budget
Output range of traditional units
Output range of gas-ﬁred units
Ramp up/down limits of traditional units
Ramp up/down limits of gas-ﬁred units
Power transmission line capacity
Power load demand
Reactance of transmission line
Generation cost of traditional units
Not-served load cost coefﬁcient
Generator status
Gas pressure range

Maximum/minimum gas storage level
Gas-electric conversion factor
Compression factor of the compressor
Weymouth equation coefﬁcient
Gas production/not-served/storage cost
Gas load
Temperature
Compression factor of the pipeline
Length of the pipeline
Diameter
Gas density in standard condition
Speciﬁc gas constant
Pipeline friction coefﬁcient
Unit transformation constant

C. Variables

Defend resources of power transmission line

Attack resources of power transmission line

xl
xy, xn, xc Defend resources of pipeline/con-line/com-line
al
ay, an, ac Attack resources of pipeline/con-line/com-line
zgt/znt
pgt, pnt
∆pdt
θ
pflt
qwt
qin
st /qout
st
rst
qyt, qct
vjt
∆qet

Generator cut-out/connection decision
Generation output
Not-served power load
Phase angle
Power ﬂow
Gas well output
Gas storage in/out rate
Stored gas amount
Gas ﬂow
Gas pressure square
Not-served gas

I. INTRODUCTION

O VER the past decade, technology breakthroughs in hori-

zontal drilling and hydraulic fracturing have fostered the
production of natural gas trapped within shale rock formations,
and natural gas prices have dropped sharply, creating a grow-
ing demand for this energy resource from the electric power
industry. However, the growing interdependency between the
pipeline network for natural gas and power systems through
gas-ﬁred power plants also imposes remarkable challenges
for the coordinated planning and operation of both physical
systems [1], which has been well studied in [2]–[4].

Due to its fast response, gas-ﬁred units are usually man-
aged to compensate, in real-time, the discrepancy between
generation and load, especially in the presence of a high
penetration of renewable energies. Recently, many interesting
and inspiring works have been found. A method for stochastic
unit commitment
is proposed in [5] for jointly operating
natural gas and power systems to mitigate the variability of
wind generation. A look-ahead robust scheduling model of a
gas-electric system, which takes the natural gas congestion into
account, is investigated in [6]. The importance of modeling the
infrastructure for gas delivery in a power system operation
with high wind power penetrations is studied in [7]. To
absorb excessive wind power, power-to-gas (P2G) technology
is comprehensively discussed in [8] and [9], which allows
a bi-directional interchange of energy, and further enhances
the interdependency between natural gas systems and power
systems.

Outside the normal operating condition,

there could be
deliberate sabotage against these critical infrastructures, which
might cause catastrophic contingencies such as line tripping
and generator outage. The vulnerability assessment for power
systems alone is extensively studied in [10]–[14]. The re-
silience of natural gas networks during conﬂicts, crises, and
disruptions were studied in [15]. In [16], a bilevel linear
programming model is proposed to assess the vulnerability
of microgrids with multiple energy carriers and then deploy
redispatch after deliberate interdictions. In [13], a tri-level
programming model is devised to determine the optimal defen-
sive strategy for protecting critical power system components
before an attack. A column-and-constraint generation (C&CG)
method is suggested to solve the tri-level optimization model.
It becomes apparent that deploying preventive defenses could
be one of the most effective ways to enhance system reliability.
In fact, from a robust optimization perspective, both nodal
power injection uncertainty and unexpected equipment failure
can be regarded and modeled as some kind of attack, yielding
a min-max-min problem, such as the robust unit commitment
problem considered in [17]. This paper proposes a systematic
methodology to identify the most threatening attacks against
the gas-electric system while taking both preventive and cor-
rective actions into account. The contributions are twofold:

1) A defender-attacker-defender (D-A-D) formulation for
protecting critical components of the interconnected gas-
electric system. The decision variables of the upper level and
lower level are the preventive and corrective actions of the
defender, say, the system operator. They strive to minimize the

2

total operation cost in the worst-case disruption, including the
penalty of not-served power and gas. The decision variables
of the middle level are controlled by a virtual attacker, who
seeks the most disruptive sabotage against the system. Our
formulation is different from existing ones in the following
ways. Compared with [16], we incorporate the model of
reinforcing system components before the attack, which is
important for enhancing system resilience. In other words, the
formulation in [16] yields an attacker-defender (A-D) model
with a bilevel structure. Compared with [13], we model the
operation of a natural gas system, which gives rise to a nonlin-
ear and non-convex optimization problem due to the presence
of Weymouth equation. Moreover, we consider a multiperiod
economic dispatch in the lower level, which captures the
subsequent effects of the attack over time; we allow the
generators to cut in and out and prohibit over generation after
the attack occurs, providing additional ﬂexibility for corrective
control. However, this introduces binary variables in the lower
level, making the problem much more challenging to solve.
This leads to the second contribution.

2) A nested C&CG algorithm for solving the D-A-D model.
The linear min-max-min program in [13] can be solved by
the C&CG algorithm proposed in [18]. However, the non-
convexity introduced by the gas pressure equation and the
discontinuity brought by committing generation units prevents
dualizing the lower level problem and complicates the com-
putation. The method in [16] ignores the discontinuity from
committing generators and uses a linear approximation of
the Weymouth equation, so as to build a linear lower level
problem. In the proposed method, the Weymouth equation
is ﬁrst replaced by its piecewise linear approximation with
mixed integer linear form [19], yielding a mixed integer linear
programming (MILP) lower level,
then the nested C&CG
algorithm proposed in [20] is applied to solve the D-A-D
model with discrete recourse decisions. Due to the modeling
capacity of MILP, our method is versatile enough to take into
account a broader class of corrective actions in response to
the attack.

Although the proposed model currently does not consider
the uncertainty of renewable generation, there is no practical
difﬁculty in accounting for it by using a method similar to
[17]. Speciﬁcally, one can derive the identical compact model
to Section II.C if a polyhedral uncertainty set is adopted. The
remaining part of the paper is organized as follows. Section II
presents the mathematical formulation. Section III derives the
solution methodology. Section IV provides numerical results
on two test systems to validate the proposed model and
algorithm. Finally, Section V presents the conclusion.

II. PROBLEM FORMULATION

A. Defender-Attacker-Defender Formulation

To evaluate vulnerable components of a networked system,
it is natural to introduce a virtual attacker who seeks the most
serious disruption to a series of system components, while the
defender can take measures before and after the attack that
enhance the vulnerable equipment or respond to an attack by
redispatching available resources, leading to a tri-level D-A-
D model. Before the mathematical formulation is presented,

some prerequisite assumptions and simpliﬁcations to facilitate
model formulation are stated as follows:

1) For modeling the gas system, we assume: i. the gas
system operates in steady-state, which means the line pack
(and thus the pressure dynamics of gas ﬂow) are ignored. For
the dynamic gas system modeling, refer to [19]; ii. the valve
of the pipeline stays open unless it is attacked; iii. we adopt
the simpliﬁed compressor model in [21], for detailed modeling
of the compressor, please refer to [2].

2) For modeling the commitment of generators, we assume
all generators are fast-response units, and that the cut-out/
connection process is instantly completed without delay. This
assumption is usually valid for gas-ﬁred units. However, our
modeling paradigm has no difﬁculty in modeling units that
are not fast-response, as the minimal on-off time requirements
can be formulated as mixed integer linear constraints.

3) For the rules of the defense and attack, we assume: i.
one component fails completely if it is not defended and is
attacked; ii. the component will be fully functional if it is
defended, regardless of being attacked or not.

In the D-A-D model, the defender must ﬁnd and deploy the
optimal protection strategy in the ﬁrst stage (upper level); then
the attacker calculates the optimal attack strategy according to
the deployment of defense resources and attacks the system
in the second stage (middle level); after that, the defender
responds to the attack to minimize the cost and damage,
leading to the following tri-level formulation

Objupper = min
Φup
xy + X

xl + X

s.t. X

FOC

xn + X

xc ≤ X

l

y

n

c

xl, xy, xn, xc ∈ {0, 1}

Objmiddle = max
Φmid
ay + X

al + X

FOC

an + X

ac ≤ A

s.t. X

l

y

n

c

al, ay, an, ac ∈ {0, 1}

Objlower = min
Φlow

FOC

s.t. b{·} = 1 − a{·} + a{·}x{·},

{·} = {l, n, y, c}

zgtugtP g
zntbnuntP n

min ≤ pgt ≤ zgtugtP g
min ≤ pnt ≤ zntbnuntP n

max

max

pg,t+1 − pgt ≤ zgtugtRg

+ + (1 − zg,t+1ug,t+1)P g

max

pgt − pg,t+1 ≤ zg,t+1ug,t+1Rg

− + (1 − zgtugt)P g

max

(1)

(2)

(3)
(4)

(5)

(6)
(7)

(8)

(9)
(10)

(11)

(12)

pn,t+1 − pnt ≤ zntuntRn

+ + (1 − zn,t+1un,t+1)P n

max (13)

pnt − pn,t+1 ≤ zn,t+1un,t+1Rn

− + (1 − zntunt)P n

0 ≤ ∆pdt ≤ pdt

− π ≤ θit ≤ π

max (14)
(15)
(16)

X

p{·}t + X

pflt − X

pflt − · · ·

{·}∈φ{·}(i)
− X
d∈φd(i)

l∈φO2 (i)

l∈φO1 (i)

(17)

(pdt − ∆pdt) = 0, {·} = {g, n}

− Fl ≤ pflt ≤ Fl

πlpflt = bl(θi1t − θi2t),

i1 ∈ O1(l), i2 ∈ O2(l)

ql
w ≤ qwt ≤ qu

w

st − qout

st ≤ ru

s

0 ≤ qin

rl
s ≤ rst = rs,t−1 + qin
st ≤ qin
st ≤ qout
j )2 ≤ vjt ≤ (τ u

0 ≤ qout

(τ l

s,max

s,max

j )2

X
s∈φs (j)
+ X

w∈φw(j)
X

(qout

st − qin

st ) − X
e∈φe(j)

(qet − ∆qet)+

qwt − X
n∈φn (j)

pnt/βn = X

q{·}t−

{·}∈φ{·}1 (j)

q{·}t, {·} = {c, y}

{·}∈φ{·}2 (j)

0 ≤ ∆qet ≤ qet

qyt|qyt| = φyby(vj1 t − vj2t)

φy =

π2λ2R5
y

16LineyFyµT empZyρ2
0

vj2 ≤ γ2

c bcvj1 + (1 − bc)(τ u

j2 )2,

j1, j2 ∈ φ(c)

0 ≤ qct ≤ bigMgf bc

FOC = X

(X

fg(pgt) + X

Qwqwt + X

Qsqst+

t

g

w

s

X

Qd∆pdt + X

Qe∆qet)

d

e

Φup = {xl, xn, xy, xc}

Φmid = {al, an, ay, ac}

Φlow ={zgt, znt, pgt, pnt, θit, pflt, pmt, ∆pdt,

qwt, qin

st , qout

st , rst, qyt, qct, vjt, ∆qet}

3

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

(26)

(27)

(28)

(29)

(30)

(31)

(32)

(33)

(34)

In this formulation, the upper level defense problem consists
of (1)-(3). The objective function (1) is to minimize FOC . (2)
is the defense budget constraint where X is a positive integer
and (3) restricts the decision variables to binary. The middle
level attack problem consists of (4)-(6). The objective function
(4) is to maximize FOC . Similarly, (5) is the constraint of the
attack budget where A is a positive integer and (6) imposes
binary restriction on the attack variables. The lower level
problem consists of (7)-(30). The objective function (7) is
to minimize FOC. (8) represents the operating availability
of components after attack, one for normal and zero for
failure. (9)-(29) constitute the operating constraints of the
gas-electric system. For the electricity network, (9) and (10)
enforce the generation capacity of traditional units and gas-
ﬁred units, respectively. (11)-(14) are the ramping rate limits
of traditional units and gas-ﬁred units, respectively. (15) sets
the boundary of not-served load. (16) describes the upper and
lower phase angle limits of the power grid. (17) depicts the
power balancing condition. (18) is the ﬂow limit for network
power. (19) describes the relationship between power ﬂow

and phase angle. For gas systems, (20) limits the production
capacity of gas wells. (21) depicts the capacity for gas storage.
(22) and (23) impose the range of in and out rate of gas
storage, respectively. (24) is the pressure limit of each node.
(25) is the gas balance requirement. (26) declares the boundary
of the not-served gas load. (27) is the Weymouth equation and
it characterizes the relationship between gas ﬂow in a passive
pipeline and node pressure. (28) deﬁnes the coefﬁcient βy in
the Weymouth equation. (29) implies the pressure relationship
between the initial and terminal node of an active pipeline.
(30) states the boundary of gas ﬂow in the active pipeline, in
which bigMgf is a large enough positive number. In practice,
bigMgf can be chosen as the upper bound of the production
capacity of the largest gas well. Particularly, the pipelines with
and without compressors are referred to as active and passive
pipelines, respectively. (31) gives the expression of FOC, in
which the ﬁrst two terms represent the production cost of
power and gas, the third term represents the cost of storing gas,
the last two terms represent the penalty of not-served power
and gas. In (31), fg(·) might be quadratic and can be further
linearized by using the piecewise linear (PWL) approximation
method [22]. (32)-(34) deﬁne the sets of decision variables for
upper, middle and lower level problems, respectively.

Compared with the existing models in [12] and [13] which
minimize the sum of not-served power load in a single period,
our work reveals the vulnerability information from both
economic and security perspectives. To see this, consider the
situation that the system is highly ﬂexible or the attack budget
is limited, such that there is no load shedding at all. Then no
vulnerable components are detected by the existing methods.
However, such a ﬂexible response may involve dispatching
costly resources in real time. In this regard, we incorporate the
production cost of the gas and power load, the operating cost
of storage, and the cost of load shedding into the objective
function, which allows the operator to protect vulnerable
facilities before an attack occurs in a more economical manner.
Another important distinction is considering over-generation
of units after the attack, which is neglected in the literature
[12], [13], [16]. According to the attacker, a direct attack is
to destroy the lines that connect the load with the network.
However, an indirect attack, which destroys some lines to
cause operation infeasibility even if the generators’ output
reaches the minimum value in the recourse stage (that is,
the recourse action leads generators to an infeasible operating
point P min
/2), may cause more catastrophic consequences as
some generators have to be cut out, leading to a blackout of the
system. From the analysis above, we can see, the unmodeled
feature will cause conﬂict between generator capacity con-
straint (9)-(10) and nodal power balance constraint (17), lead-
ing to a suboptimal attack strategy. Physically, over-generation
may trigger a self-protection module and cause a generator
outage, leading to an even more catastrophic consequence
than the attack itself. To address this issue, the commitment
strategy of generators is considered and is controlled by binary
variables zgt, znt in (9)-(14). Its signiﬁcance is demonstrated
in Section IV.C.

g

B. Linearizing the Weymouth Equation

Clearly, each term in the proposed tri-level formulation is
linear except for the gas ﬂow square with sign function in the

Weymouth equation (27), which can be linearized by PWL
approximation as follows [19].

4

ψ(qyt) ≈ ψ(∆y1) + X
k∈K
qyt = ∆y1 + X
k∈K

(ψ(∆y,k+1) − ψ(∆yk))̺ytk

(∆y,k+1 − ∆y,k)̺ytk

(35)

(36)

0 ≤ ̺ytk ≤ 1, ∀k ∈ K

̺yt,k+1 ≤ ζytk ≤ ̺ytk, ∀k ∈ K − 1

(37)
(38)
Where ∆yk is the piecewise segment for each passive pipeline
and k is the corresponding index; ̺ytk and ζytk are the aux-
iliary continuous and binary variable, respectively; ψ depicts
the relationship between the nonlinear term and gas ﬂow. You
can control the error gap of PWL approximation (35)-(38) by
choosing the size of K [23].

C. The Compact Model

For ease of analysis, the tri-level D-A-D model in previous

subsections can be written in a compact form as follows:

Objupper = min

x

hT y

s.t. Ax ≤ b

Objmiddle = max

a

hT y

s.t. Ca ≤ d

Objlower = min
y,z

hT y

s.t. E(x, a)y + F (x, a)z ≤ g

(39)

(40)

(41)

(42)

(43)

(44)

Where x, a, z are binary variable vectors, y is a continuous
variable vector, and A, C, b, d, g, and h are constant coefﬁ-
cient matrices which can be derived from (2), (5), and (9)-
(30). Speciﬁcally, E(x, a) and F (x, a) are variable coefﬁ-
cient matrices and can be derived from (9)-(30). It is worth
mentioning that in its current formulation, we consider only
the redispatch cost hT y in the objective function, however,
there is no difﬁculty if one prefers to use a more general cost
function in the form of hT

1 x + hT

2 z + hT

3 y.

III. SOLUTION METHODOLOGY

In general, several decomposition methods are available
to solve a linear min-max-min model such as Benders de-
composition [24], [25] and column and constraint generation
(C&CG) [18]. However, the presence of binary variables
prevents directly dualizing the lower level problem. We adopt
a nested C&CG method in [20] to solve the D-A-D problem
(39)-(44). The application of the nested C&CG method has
been found in the robust unit commitment with quick-start
units [17], which shows its potential for the proposed formu-
lation.

A. Inner C&CG for Middle Lower-Level Problem

With ﬁxed defense strategy x∗ and lower-level binary

variable z∗, (44) yields the following inequality

(45)
Then the linear program consisting of (43) and (45) with

E(x∗, a)y ≤ g − F (x∗, a)z∗

z = z∗ can be replaced by its dual form as follows

hT y

min
y,z

s.t. E(x∗, a∗)y + F (x∗, a∗)z ≤ g

(48)

C. Linearization of Bilinear Terms

5

Step 4: If U B − LB ≤ ǫouter, terminate and return the
optimal solution x∗, a∗, y∗, z∗. Otherwise, update w = w+1,
W = W ∪ w, aw∗ = a∗, create new variables (yw, zw) with
the following constraints, and go to Step 2.

ϕ ≤ hT yw

(57)

E(x, aw∗)yw + F (x, aw∗)zw ≤ g

(58)
Similarly, there are bilinear terms in (56) which can be
further linearized, and the next subsection discusses them.
Then the problem in Step 2 can be transformed into a MILP.

The bilinear terms in Algoinner and Algoouter include
binary production and binary-continuous production. The cor-
responding linearization methods are shown below.

1) Binary production: The binary production terms exist in
(10), namely F (x, a∗)zr of (56). Take δ = κλ for example,
where κ and λ are binary, and their multiplication δ is another
binary variable. It is easy to verify that above equality is
equivalent to the following linear constraints

κ + λ − δ − 1 ≤ 0

δ − κ ≤ 0
δ − λ ≤ 0

(59)
(60)
(61)

2) Binary-continuous production: The binary-continuous
production terms exist in (19), (27), (29), namely E(x, a∗)yr
of (56). Again, take δ = κλ for example, where κ is binary
and λ is continuous. Their multiplication δ is a continuous
variable. It is easy to verify that above equality is equivalent
to the following linear constraints

λminκ ≤ δ ≤ λmaxκ

λmin(1 − κ) ≤ λ − δ ≤ λmax(1 − κ)

(62)
(63)

where λmin and λmax are the lower bound and upper bound
of λ, respectively. If they are not known precisely, we can use
a large constant BigMcon instead. In practice, choosing the
value of BigMcon can be tricky: if BigMcon is too large, the
continuous relaxation of the MILP will be rather weak, this
will cause unnecessary computational burden in the branch
and bound procedure; on the other hand, if BigMcon is too
small, there will be a duality gap between problem (46)-(47)
and its primal problem, and the reformulation will be incorrect.
Due to the physical operating constraints, the bounds of primal
variables (say the gas pressure and the power transmission line
capacity) are easy to retrieve, and the bounds of dual variables
are not instantly apparent.

To reduce the proper value of BigMcon,

the objective
function (31) is divided by an auxiliary parameter BigMobj. A
heuristic choice of BigMobj may be the objective value when
all loads are not-served. To see this, consider the following
primal-dual pair of LPs:

P: min {cT x | Ax ≤ b}

D: max {bT y | AT y = c, y <= 0}

Due to physical operation constraints, the feasible region of
problem P is a bounded polytope, and a ﬁnite optimal value
cT x∗ can be found at one of its extreme points x∗. According

(g − F (x∗, a)z∗)T µ

max

µ

(46)

s.t. E(x∗, a)T µ = h, µ ≤ 0

(47)
Where µ is the dual variable. The middle lower-level problem
(41)-(44) can be solved by the C&CG algorithm described
below, denoted as Algoinner.

Step 1: Select an arbitrary feasible attack strategy a∗, and

solve the following problem:

Denote the optimal solution by y∗, z∗, set LB = hT y∗,
U B = +∞, o = 1, z1∗ = z∗, O = {1}, Z = {z1∗}.

Step 2: Solve the following problem

Objmiddle = max
θ,a,µ

θ

(49)

s.t. θ ≤ (g − F (x∗, a)zr∗)T µr, ∀r ∈ O, zr∗ ∈ Z (50)

Ca ≤ d, E(x∗, a)T µr ≤ hT , µr ≤ 0, ∀r ∈ O

(51)

Extract the optimal solution a∗ and θ∗, and update U B = θ∗.
Step 3: Solve (48) with a∗, obtain the optimal solution

(z∗, y∗) and update LB = max{LB, hT y∗}.

Step 4:

If U B − LB ≤ ǫ,

terminate and, return the
middle. Otherwise,
attack strategy a∗ and the optimal value Obj∗
update o = o + 1, O = O ∪ o + 1, zo∗ = z∗, Z = Z ∪ zo∗,
create new variables µo with the following constraints,

θ ≤ (g − F (x∗, a)zo∗)T µo

E(x∗, a)T µo ≤ hT , µo ≤ 0

(52)

(53)

and go to Step 2.

Note that there are bilinear terms in (50) and (51) which
can be further linearized, and Section III.C discusses them.
Then problem (49)-(51) can be reformulated as a MILP,
which is readily solvable by commercial software. By calling
Algoinner, the optimal attack strategy a∗ under ﬁxed defense
strategy x∗ can be obtained.

B. Outer C&CG for Upper Level Problem

The outer C&CG algorithm for the upper level problem,
denoted as Algoouter, identiﬁes the optimal defense strategy
under all possible attacks, which proceeds as follows.

Step 1: Set LB = −∞, U B = +∞, a1∗ = 0, w = 1,

W = {w}, and select a convergence tolerant ǫouter.

Step 2: Solve the following problem:

Objupper = min
x,y,z

ϕ

s.t. Ax ≤ b, ϕ ≤ hT yf , ∀f ∈ W

E(x, af ∗)yf + F (x, af ∗)zf ≤ g, ∀f ∈ W

(54)

(55)
(56)

Let the optimal solution be x∗, the optimal value ϕ∗, and
update LB = min(U B, ϕ∗).

Step 3: Call Algoinner, obtain the optimal solution a∗ and
middle).

middle, update U B = min(U B, Obj∗

optimal value Obj∗

6

to the duality theory of LP, problem D must have a ﬁnite
optimal value bT y∗ = cT x∗ with bounded y∗, although the
feasible region of D may be unbounded. In transformation (62)
and (63), the BigMcon parameter of the dual variable should
satisfy −BigMcon ≤ y∗ such that the optimal solution is not
inﬂuenced. The difﬁculty lies in the fact that y∗ is not known in
advance, so we have to use a large enough value, which might
be overly pessimistic. However, if the objective of P becomes
cT x/BigMobj, the optimal solution x∗ of problem P remains
the same, and it is easy to verify that y = y∗/BigMobj is an
optimal solution of problem D. This indicates that the bound
parameter BigMcon imposed on the dual variables can be
reduced. Section IV.D shows the numeric results.

G1

G2

1

PLine2

4

2
PLine1

PLine3

5

PLine6

PLine5

6

PLine4

PL2

CLine1

PL3

CLine2

GS1

C1

1

GLine1

2

GLine2

GL1

4

GLine5

7

GL2

3

GLine4

5

GLine3

6

GW2

GL3

PL1

3

PLine7

G3

GW1

IV. ILLUSTRATIVE EXAMPLE

Fig. 1. Topology of the hybrid test system.

In this section, we present numerical experiments on two
test systems to show the effectiveness of the proposed model
and algorithm. The experiments are performed on a laptop with
Intel(R) Core(TM) 2 Duo 2.2 GHz CPU and 4 GB memory.
The proposed algorithms are implemented on MATLAB with
YALMIP toolbox. MILP is solved by Gurobi 6.5, the optimal-
ity gap is set as 0.1% without particular mention.

A. 6-Bus Power System with 7-Node Gas System

Fig. 1 depicts the topology of the connected infrastructure.
It has 2 gas-ﬁred units, 1 traditional unit, 2 gas wells, 1
compressor, 1 gas storage tank, 3 power loads and 3 gas
loads. The targets of the attacker are the 7 power transmission
lines, 5 passive pipelines, 1 active pipeline and 2 connection
lines. Here the connection lines represent the gas pipelines
that transport gas to gas-ﬁred units. The parameters of the
system and the scheduled unit commitment can be found in
[26]. In the following cases, we consider the problem with
T = 4 periods. The power and gas demand proﬁles are shown
in Fig. 2, in which four typical time slots are selected. Details
of these time slots are shown in Table I. We set K = 8 in (35)-
(38), which means that an eight-segment linear approximation
replaces the nonlinear Weymouth equation.

TABLE I

DETAILS OF THE SELECTED TIME SLOTS

Case

Periods

1
2
3
4

2-5
9-12
14-17
19-22

Power
low
mid
high
mid

Gas
low
mid
mid
high

B. Computational Results

In this subsection, X = 3 and A = 3 are selected as
the benchmark and the corresponding results are summarized
in Table II, where Def, Atk, OC, NP, NG are short for De-
fend Resource, Attack Resource, Operational Cost, Not-served
Power and Not-served Gas, respectively. As the gas system
is radial and the power system is meshed in topology, the
production resources of the gas system are more centralized
than the power system and more vulnerable to attacks. Thus
the defense resources are spent mainly on the gas system.

 Power Load

 Gas Load

7

)

3

m
S
(
 
d
a
o
L
 
s
a
G

6

5

3.0

)

W
M

(
 
d
a
o
L
 
r
e
w
o
P

2.5

2.0

1.5

4

8

12

T (h)

16

20

24

Fig. 2. Power and gas demand.

Similar circumstance occurs in the attacker’s strategy. The
attack priority is the gas system unless the gas load is in low
level, that is, case 1. The average power and gas loss rates of
the four time plots under the optimal attack strategy are 48.6%
and 6.55%, respectively, assuming the optimal deployment
of defense resources. This difference reveals that the failure
of the gas system will have a larger impact on the coupled
physical system, as the energy from gas system to power
system is a one-way ﬂow. Also, we consider both the defense
and attack budget variables, whose range varies in the intervals
[1, N +L+C +Y −1] and [1, N +L+C +Y −A], respectively.
Various tests are carried out under different defense budgets,
attack budgets, and time slots. Fig. 3 shows the results. Here
we deﬁne the defense rate of a component as the number of
instances in which it is protected divided by the total number
of defense and attack budget combinations, for example,
GLine5 is defended in 99 out of 105 defense and attack budget
combinations in case 3, thus its defense rate is 94.26%, as
shown in Fig. 3. The importance of each component is seen by
the relative value of the defense rate in Fig. 3, from which we
can observe GLine5 is always the most important component,
as its defense rate is the highest in all cases. Also, the defense
rate of a speciﬁc component varies from case to case, which
reveals that the defense strategy depends on the load level.

To demonstrate the beneﬁt of prior protection, the opera-
tion cost under different combinations of defense and attack
budget are shown in Fig. 4. from which we can see, with
defense budget increasing, the average operation cost under

)

%

(
 
e
t
a
R
 
e
s
n
e
f
e
D

100

80

60

40

20

0

 Case 1
 Case 2
 Case 3
 Case 4

P Line 1

P Line 2

P Line 3

P Line 4

P Line 5

P Line 6

P Line 7

C Line 1

C Line 2

G Line 1

G Line 2

G Line 3

G Line 4

G Line 5

C

1

Fig. 3. Defense rate of components under 4 cases.

Fig. 4. Operational cost under different budgets.

different attack budgets decreases. However, the decrement of
operational cost also decreases. Speciﬁcally, when the defense
budget is 8 or larger, the attack budget has little impact on
the operation cost. Moreover, if the attack budget is limited,
the operation cost can be well-controlled through a limited
defense budget, say X = 4 in this case, which may provide
guidance for defense budgeting.

COMPUTATIONAL RESULTS UNDER THE BENCHMARK

TABLE II

Case

Def

Atk

OC($)

NP

NG

(M W h)

(Sm3)

1

2

3

4

GLine2
GLine3
GLine5

C1

GLine3
GLine5

C1

GLine5
P Line5

C1

GLine3
GLine5

GLine1
GLine4
P Line5
P Line2
P Line3
P Line4
CLine1
P Line1
P Line2
P Line2
P Line3
P Line4

6.713× 105

664

0

7.529× 105

310

2261

8.615× 105

0

3900

7

strategy is smaller than the attack budget in cases 1-4 if
over-generation is not considered, which indicates that any
additional attack will cause over-generation and will not be
allowed. Further, the optimal defense strategy with or without
over-generation attack (OGA) is also quite different, which
conﬁrms the need to consider over-generation when deploying
corrective actions.

COMPUTATIONAL RESULT WITHOUT OVER-GENERATION ATTACK

TABLE III

Case

Def

Atk

OC($)

NP

(M W h)

1

2

3

4

OGA P Line5
P Line7
no
P Line3
OGA
P Line4
OGA P Line1
P Line2
no
P Line2
OGA
P Line4
OGA P Line2
P Line3
no
P Line3
OGA
P Line4
OGA P Line2
P Line6
no
P Line2
OGA
P Line4

P Line1
P Line3

2.764× 105

56.1

P Line1

2.201× 105

0

P Line4
P Line5

3.469× 105

49.6

P Line1

2.969× 105

0

P Line5
P Line6

4.405× 105

432

P Line1

2.827× 105

55.8

P Line3
P Line4

4.027× 105

394

P Line1

2.194× 105

7.25

D. Impact of BigMobj

As mentioned in section III.C,

the value of BigMcon
for unbounded dual variables will signiﬁcantly impact the
computational efﬁciency. Different from [12] and [13], Fig.
5 shows the active lower bound of BigMcon as well as
computational time along with the variation of BigMobj. This
shows, the active lower bound of the magnitude of BigMcon
keeps decreasing as BigMobj decreases, which conﬁrms the
analysis in section III.C. However, the computational time is
non-monotonic with respect to BigMobj. The reason may be
that, at the very beginning, as BigMobj decreases, the range of
BigMcon shrinks, which would lead to a stronger MILP for-
mulation and thus reduce the computational burden; however,
as BigMobj keeps decreasing, the range of BigMcon may
become too small and step out of the numerical stability range,
leading in turn to an ill-conditioned problem. Nevertheless,
BigMobj has a relatively wide ideal range from the aspect
of computational efﬁciency, which is [104, 106] in this case,
as Fig. 5 indicates, demonstrating the promising prospect of
practical application for the proposed method.

In this subsection, we apply the proposed model and algo-
rithm to a larger test system, which comprises the IEEE 39-bus
system and a modiﬁed version of the Belgian high-caloriﬁc
20-node gas network. It has 3 gas-ﬁred units, 7 traditional
units, 2 gas wells, 3 compressors, 4 gas storage tanks, 19
power loads and 9 gas loads. Similar to the settings in section
IV. A, all the system branches are the targets of the attacker,
including 46 power transmission lines, 21 passive pipelines,
3 active pipelines and 3 connection lines. Refer to [26] for

8.047× 105

795

0

E. 39-Bus Power System with 20-Node Gas Network

C. Signiﬁcance of Considering Over-generation

This subsection discussed the signiﬁcance of incorporating
over-generation. To make the result clear, we assume only
power transmission lines can be attacked in the tests. We set
X = 2 and A = 2, and list the corresponding results in
Table III. These results shown that, the sum of the attack

n
o
c

M
g
i
B

 
f
o
 
s
e
d
u
t
i
n
g
a
M

 
f
o
 
r
e
d
r
O

1011
1010
109
108
107
106
105
104
103
102
101
100
10-1
10-2

 Order of Magnitude of  BigMcon
  Computation Time               

600

500

400

300

200

100

i

)
s
(
 
e
m
T
 
n
o
i
t
a
t
u
p
m
o
C

10-1

100

101

102

104

103
Value of  BigMobj

105

106

107

108

0
109

Fig. 5. Value of BigM and computation time.

the topology, parameters, and unit commitment of the test
system as well as the power and gas demand. We consider
T = 2 periods and K = 4 for the Weymouth equation
approximation and a 1% optimality gap as a trade-off between
solution accuracy and computational burden. We select period
2 to 3, 9 to 10, 14 to 15 and 19 to 20, as four target time
slots. Table IV summarizes the average computation time
under different combinations of defense and attack budget.
The results show that the computation time increases rapidly
as the defense and attack budget increase. However, when the
defense and attack budget are limited, the computation time
is acceptable, demonstrating the scalability of the proposed
model and algorithm to moderately sized systems.

COMPUTATION TIME (S) UNDER DIFFERENT BUDGETS

TABLE IV

P

P

Def

PP

Atk

P

P

1
2
3
4
5

1

65
155
317
663
922

2

77
172
477
927
1477

3

93
312
699
1401
1902

4

111
551
831
2022
2638

5

140
673
1145
2712
3531

V. CONCLUSION

The proposed methodology addresses the vulnerability of
coupled gas-electric networks against malicious line interdic-
tions. It provides the optimal strategies for preventive rein-
forcement, and increases the resilience of the energy supply,
and decreases the operational cost of the interdependent energy
systems. The mixed integer linear representation of the over-
generation issue and the gas system constraints entails binary
variables in the lower level problem, and prevents a traditional
C&CG algorithm being applied. A nested C&CG algorithm
is adopted and the corresponding computational burden is
reduced by choosing the proper value of BigMcon, which
enhances the applicability of the proposed method. Simulation
results corroborate the effectiveness of the proposed method,
and suggest giving higher priority to protecting systems with
radial topology.

REFERENCES

[1] M. Shahidehpour, Y. Fu, and T. Wiedman, “Impact of natural gas
infrastructure on electric power systems,” Proc. of the IEEE, vol. 93,
no. 5, pp. 1042–1056, May 2005.

8

[2] C. Liu, M. Shahidehpour, Y. Fu, and Z. Li, “Security-constrained unit
commitment with natural gas transmission constraints,” IEEE Trans.
Power Syst., vol. 24, no. 3, pp. 1523–1536, Aug. 2009.

[3] X. Zhang, M. Shahidehpour, A. S. Alabdulwahab, and A. Abusorrah,
“Security-constrained co-optimization planning of electricity and natural
gas transportation infrastructures,” IEEE Trans. Power Syst., vol. 30,
no. 6, pp. 2984–2993, Nov. 2015.

[4] C. M. Correa-Posada and P. S´anchez-Martın, “Security-constrained
optimal power and natural-gas ﬂow,” IEEE Trans. Power Syst., vol. 29,
no. 4, pp. 1780–1787, Jul. 2014.

[5] A. Alabdulwahab, A. Abusorrah, X. Zhang, and M. Shahidehpour,
“Coordination of interdependent natural gas and electricity infrastruc-
tures for ﬁrming the variability of wind energy in stochastic day-ahead
scheduling,” IEEE Trans. Sustain Energy, vol. 6, no. 2, pp. 606–615,
Apr. 2015.

[6] C. Liu, C. Lee, and M. Shahidehpour, “Look ahead robust scheduling
of wind-thermal system with considering natural gas congestion,” IEEE
Trans. Power Syst., vol. 30, no. 1, pp. 544–545, Jan. 2015.

[7] J. Devlin, K. Li, P. Higgins, and A. Foley, “The importance of gas
infrastructure in power systems with high wind power penetrations,”
Appl. Energy, vol. PP, no. 99, pp. 1–11.

[8] M. Bailera, P. Lisb, L. M. Romeo, and S. Espatolero, “Power to gas-
biomass oxycombustion hybrid system: energy integration and potential
applications,” Appl. Energy, vol. PP, no. 99, pp. 1–9.

[9] M. Qadrdan, M. Abeysekera, M. Chaudry, J. Wu, and N. Jenkins, “Role
of power-to-gas in an integrated gas and electricity system in Great
Britain,” Int. J. Hydrogen Energy, vol. 50, no. 17, pp. 5763–5775, 2015.
[10] J. Salmeron, K. Wood, and R. Baldick, “Analysis of electric grid security
under terrorist threat,” IEEE Trans. Power Syst., vol. 19, no. 2, pp. 905–
912, May 2004.

[11] ——, “Worst-case interdiction analysis of large-scale electric power
grids,” IEEE Trans. Power Syst., vol. 24, no. 1, pp. 96–104, Feb. 2009.
[12] J. M. Arroyo, “Bilevel programming applied to power system vulnerabil-
ity analysis under multiple contingencies,” IET Gener. Transm. Distrib.,
vol. 4, no. 2, pp. 178–190, Feb. 2010.

[13] Y. Wei, L. Zhao, and B. Zeng, “Optimal power grid protection through
a defender-attacker-defender model,” Reliab. Eng. Syst. Safe., vol. 121,
pp. 83–89, Jan. 2014.

[14] N. Alguacil, A. Delgadillo, and J. Arroyo, “A trilevel programming
approach for electric grid defense planning,” Comp. & Oper. Res.,
vol. 41, pp. 282–290, Jan. 2014.

[15] R. Carvalho, L. Buzna, F. Bono, M. Masera, D. Arrowsmith, and
D. Helbing, “Resilience of natural gas networks during conﬂicts, crises
and disruptions,” PLoS One, vol. 9, no. 3, pp. 1–9, Mar. 2014.

[16] S. Manshadi and M. Khodayar, “Resilient operation of multiple energy
carrier microgrids,” IEEE Trans. Smart Grid, vol. 6, no. 5, pp. 2283–
2292, Sep. 2015.

[17] B. Hu and L. Wu., “Robust SCUC considering continuous/discrete
uncertainties and quick-start units: A two-stage robust optimization with
mixed-integer recourse,” IEEE Trans. Power Syst., vol. 31, no. 2, pp.
1407–1419, Mar. 2016.

[18] B. Zeng and L. Zhao, “Solving two-stage robust optimization using
a column-and-constraint generation method,” Oper. Res. Lett., vol. 41,
no. 5, pp. 457–461, Sep. 2013.

[19] C. Correa-Posada and P. Sanchez-Martin, “Integrated power and natural
gas model for energy adequacy in short-term operation,” IEEE Trans.
Power Syst., vol. 30, no. 6, pp. 3347–3355, Nov. 2015.

[20] L. Zhao and B. Zeng. (2012) An exact algorithm for two-stage robust
optimization with mixed integer recourse problems. [Online]. Available:
http://www.optimization-online.org/DB FILE/2012/01/3310.pdf

[21] D. Wolf and Y. Smeers, “The gas transmission problem solved by an
extension of the simplex algorithm,” Manage. Sci., vol. 46, no. 11, pp.
1454–1465, Nov. 2000.

[22] M. Carrion and J. M. Arroyo, “A computationally efﬁcient mixed-integer
linear formulation for the thermal unit commitment problem,” IEEE
Trans. Power Syst., vol. 21, no. 3, pp. 1371–1378, Aug. 2006.

[23] C. Correa-Posada and P. Sanchez-Martion. (2014) Gas network opti-
mization: A comparison of piecewise linear models. [Online]. Available:
http://www.optimization-online.org/DB FILE/2014/10/4580.pdf

[24] A. Geoffrion, “Generalized benders decomposition,” J. Optim. Theory

Appl., vol. 10, no. 4, pp. 237–260, Oct. 1972.

[25] D. Bertsimas, E. Litvinov, X. A. Sun, J. Zhao, and T. Zheng, “Adaptive
robust optimization for the security constrained unit commitment prob-
lem,” IEEE Trans. Power Syst., vol. 28, no. 1, pp. 52–63, Feb. 2013.

[26] [Online]. Available: https://sites.google.com/site/chengwang0617/home/data-sheet

