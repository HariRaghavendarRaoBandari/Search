Shape-Driven Colloidal Crystal–Crystal Transitions

Xiyu Du,1 Greg van Anders,2 Richmond S. Newman,2 and Sharon C. Glotzer1, 2, 3, 4

1Department of Physics, University of Michigan, Ann Arbor, MI 48109-1040, USA

2Department of Chemical Engineering, University of Michigan, Ann Arbor, MI 48109-2136, USA

3Department of Materials Science and Engineering, University of Michigan, Ann Arbor, MI 48109-2136, USA

4Biointerfaces Institute, University of Michigan, Ann Arbor, MI 48109-2800, USA

(Dated: March 3, 2016)

6
1
0
2

 
r
a

M
2

 

 
 
]
t
f
o
s
.
t
a
m
-
d
n
o
c
[
 
 

1
v
7
2
7
0
0

.

3
0
6
1
:
v
i
X
r
a

Mimicking nature’s ability to control energy and information in next-generation reconﬁgurable synthetic
materials is a key challenge. Meeting this challenge with colloidal materials is promising because of recent
developments in building block synthesis and the understanding of bulk assembly mechanisms. However, it
is not understood, generally, how to drive bulk reconﬁguration with building block reconﬁguration, such as
shape change. Here, we study the thermodynamics of shape-change-driven bulk colloidal crystal–crystal phase
transitions. We ﬁnd, depending on the local environment of the building block self-assembled structures and the
difference between the two crystal structures, that a shape driven reconﬁguration between crystal structures can
be a ﬁrst-order transition, or can occur without any thermodynamic phase transition whatsoever.

Biological systems derive the ability to control energy and
information from complex, reconﬁgurable structures. These
structures, which can change from one phase to the other,
are challenging to reproduce synthetically.
In synthesizing
new functional materials, a key challenge is to mimic biolog-
ical mechanisms or structures while giving target materials
their desired functionality by re-engineering them with dif-
ferent building blocks, or at different scales. At the scale of
optical wavelengths, colloidal matter [1] with entropy-driven
behavior provides ideal candidate systems for developing re-
conﬁgurable materials for four reasons: (i) colloidal systems
have interparticle forces that are typically on the order of the
thermal energy in the system (kBT ) which suggests recon-
ﬁguration could be driven by thermal ﬂuctuations; (ii) col-
loids exhibit a broad range of complex emergent behaviors [2]
and structures such as liquid crystals, plastic crystals, crys-
tals with scores of particles in a unit cell, and quasicrystals
[3–13]; (iii) colloids can be reliably synthesized in a variety
of shapes and morphologies [14–20], e.g. with entropic [21]
patches; and (iv) colloid properties can be modiﬁed dynami-
cally [19, 22–24]. These facts suggest that it could be possible
to use building-block shape change and thermal ﬂuctuations to
reconﬁgure bulk colloidal structures.

However, investigating how to obtain bulk reconﬁguration
from building-block shape change requires addressing several
open questions. Among them: (i) Is crystal–crystal structural
reconﬁguration always accompanied by a ﬁrst-order thermo-
dynamic phase transition? (ii) Does crystal–crystal reconﬁg-
uration need to go through an intermediate ﬂuid state [25–
27]?
(iii) Intuition suggests that reconﬁguration between
bulk structures related by simple mathematical transforma-
tions would be easy to effect, but are geometrically similar
reconﬁgurations necessarily thermodynamically similar? (iv)
Are some combinations of building blocks and structures eas-
ier to effect bulk reconﬁguration in? (v) For example, are
building block families with many different bulk structural be-
haviors good candidates for developing reconﬁgurable mate-
rials or bad candidates? Here, we addressed these questions
systematically with hard colloidal polyhedra that assemble
into different crystal structures depending on particle shape.

Whereas pressure- and temperature-induced solid–solid

FIG. 1.
Small shape differences affect the bulk self-assembly of
hard polyhedra. Here, spheric-triangle group symmetric polyhedra of
shape (αa, αc) = (0.4, 0.16) (blue particle inset, a) self-assemble a
bcc lattice (bond-order diagram inset, a) whereas polyhedra of shape
(αa, αc) = (0.4, 0.215) (red particle inset, b) self-assemble an fcc
lattice (bond-order diagram inset, b).
phase transitions are fundamentally important and widely
studied in, e.g. metallurgy [28], here, we investigate the ther-
modynamic nature of crystal–crystal transitions in hard poly-
hedra systems not as a function of pressure or temperature,
but as a function of particle shape; that is, in “shape space”
[21, 29]. We treat particle shape thermodynamically using a
recently-developed digital alchemy framework [29]. Whereas
previously this framework was used to ﬁnd optimal particle at-
tributes for candidate structures [29], here we investigate the
behavior of model systems of spheric-triangle group invari-
ant polyhedra [30] at the boundaries of regions of bulk phase
stability[31]. Our main results are: (i) We ﬁnd examples of
crystal–crystal reconﬁguration that occur with a discontinuous
(ﬁrst-order) phase transition, and examples that are accom-
panied by no thermodynamic phase transition. (ii) We give
concrete demonstrations of shape-driven macroscopic recon-
ﬁguration in model systems. More generally, (iii) our results
suggest, surprisingly, that having a greater diversity of struc-
tures from changes in building block shape can make tran-
sition between particular structures of interest more difﬁcult.

(a)(b)However, our results also suggest (iv) that for well-chosen pat-
terns of building block reconﬁguration and crystal structure,
structural transformation can be achieved without a thermo-
dynamic penalty, which suggests that shape change is a viable
mechanism for crystal–crystal reconﬁguration.

Our model systems come from the spheric-triangle invari-
ant 323-family of hard polyhedra [30]. This two parameter
family of shapes formed by subjecting cubes to two distinct
sets of tetrahedral truncations includes the cube, tetrahedron,
and octahedron. These shapes, as well as intermediate shapes
in our family of interest, have been synthesized at the colloidal
scale in a number of experiments [9, 11, 22, 32]. Modeling
of hard colloidal polyhedra in the 323-family [30] has shown
them to have rich self-assembly behavior (see Fig. 1 for two
examples) with both wide and narrow regions of stability for
a number of different bulk structures [31]. We denote shapes
according to the conventions (αa, αc) where 0 ≤ αa,c ≤ 1
deﬁnes the boundaries of shape space in this shape family.
In these conventions (0, 0) is an octahedron, (0, 1) and (1, 0)
are tetrahedra, and (1, 1) is a cube. Shapes with (α, α) are
self-dual. Here, we study fcc↔bcc and bcc↔sc transitions,
because these all occur between neighboring regions of shape
space.

We investigate shape change induced structural reconﬁgu-
ration in our model systems by (i) using Monte Carlo (MC)
simulations to locate the phase boundary between initial and
ﬁnal structures, and (ii) using umbrella sampling to determine
the thermodynamic nature of the phase change that accom-
panies structural reconﬁguration. To facilitate direct com-
parison all calculations were performed at a packing fraction
η = 0.55, which is sufﬁciently dense to observe the sponta-
neous assembly of each of the target phases [31] and sufﬁ-
ciently dilute so as to avoid the complicated inﬁnite pressure
behavior of this family of shapes [30]. All simulations were
performed with HOOMD-Blue [33] using the HPMC-plugin
[34], and we use units in which kBT = 1.

To precisely locate the phase boundary, we use the no-
tion of generalized “alchemical” structure–property relation-
ships proposed in Ref. [29] to compute the constitutive rela-
tion P (αa, αc) noting that at phase boundaries the pressures
in competing phases must be equal. We initialize systems with
different building blocks (examples in Figs. 2a, 3a) in either
perfect bcc (N = 2000), fcc (N = 2048), or sc (N = 2197)
structures, and compute the pressure P (αa, αc) (Figs. 2b, 3b)
using standard techniques [35].

We determined the thermodynamic character of the struc-
tural reconﬁguration using umbrella sampling [36], using a
neighbor-averaged [37] version of the standard Ql spherical-
harmonic order parameters [38]. To achieve good order-
parametric separation of our crystal phases of interest we used
the second neighbor averaged l = 4 parameter ¯Q4, which
distinguished bcc from fcc, sc, and hcp phases in our sys-
tems (Figs. 2c, 3c). Umbrella sampling calculations used
5 × 104 samples in 32 equally-spaced windows in ¯Q4 across
each transition with a harmonic constraint of spring constant
k = 3.5 × 104 [39]. To investigate the structural reconﬁgu-
ration in different regions of shape space we studied fcc↔bcc
transitions with four groups each of six different polyhedra

2

Shape-induced structural fcc↔bcc reconﬁguration is
FIG. 2.
accompanied by a ﬁrst-order thermodynamic phase transition in
spheric-triangle invariant hard polyhedra. Panel a: shapes used
in umbrella sampling calculations. Panel b: for ﬁxed αa = 0.4
the pressure–shape constitutive relationship P (αa, αc) shows the
fcc↔bcc transition occurs near αc = 0.54. Panel c: second-
neighbor averaged l = 4 spherical harmonic order parameter ¯Q4
distinguishes bcc, fcc, and hcp crystal phases in thermal systems
of spheric-triangle invariant polyhedra. Panel d: above the transi-
tion (αc > α∗
c) a metastable fcc free energy basin develops near
αc = 0.58. Panel e: below the transition (αc < α∗
c) the fcc free
energy basin becomes dominant (αc = 0.55) and well above the
transition (αc = 0.54), the bcc free energy basin becomes unstable,
and a second metastable hcp basin appears.

(a)(b)(c)(d)(e)BCCHCPFCCFCC-LikeBCC-Like3

shape constitutive relation P (αa, αc), plotted in Fig. 2b. Sys-
tems were initialized in either bcc (triangles) or fcc (discs)
structures, and then equilibrated for 1.5× 107 MC sweeps, af-
ter which the pressure and ¯Q4 were measured; pressure mea-
surements are indicated in Fig. 2b with colors that correspond
to measured average ¯Q4. Pressure measurements suggest a
sharp bcc↔fcc crossover near α∗
c = 0.54. We conﬁrm this
directly using umbrella sampling. Thermal averages of the
order parameter ¯Q4 computed in bcc, hcp, and fcc crystals
shows that bcc crystals have a peak near 0.06, hcp has one
peak near 0.09 and a second smaller peak around 0.13 due
mixed hcp-fcc stacking, and fcc has a peak near 0.17 (Fig. 2c).
Umbrella sampling calculations at αc > α∗
c, i.e. above the
fcc↔bcc transition (Fig. 2d), show that sufﬁciently far into the
bcc phase there is no metastable fcc free energy basin; how-
ever, as αc approaches α∗
c, a metastable fcc basin appears. At
αc < α∗
c (Fig. 2e) umbrella sampling calculations show that
fcc becomes the stable free energy basin and the bcc basin
becomes metastable. Well below the transition the bcc basin
disappears, but a metastable basin develops that corresponds
to mixed fcc and hcp stacking. Together, our results demon-
strate that shape-driven fcc↔bcc structural reconﬁguration in
this family of shapes is accompanied by a ﬁrst-order thermo-
dynamic phase transition.

How does the existence of the ﬁrst-order thermodynamic
phase transition affect dynamic building-block shape change
driven crystal–crystal transformation? We tested this us-
ing MC simulations by initializing polyhedra into metastable
structures, and ran the simulation for 1.5 × 107 MC sweeps.
On these simulation timescales, which are much longer than
needed for reconﬁguration outside the metastable region, we
did not observe structural transformation for any metastable
system. However, we did observe spontaneous structural
transformation when systems were initialized with shapes be-
yond the metastable region, in which case we observed struc-
tural reconﬁguration with no discernible intermediate ﬂuid
phase.
We investigated the bcc↔sc reconﬁguration in two regions,
and in both cases we ﬁnd that building-block shape change
induced structural reconﬁguration occurs without a thermo-
dynamic phase transition. In Fig. 3 we show a detailed in-
vestigation of a representative region near the boundary for
αa = αc (see appendix for other region). Fig. 3a depicts the
range of shapes studied; particles are colored from blue (bcc)
to red (sc) according to the value of the order parameter ¯Q4 of
the structures they form. For this series of shapes, we investi-
gate the pressure–shape constitutive relation P (αa, αc) (Fig.
3b), which suggests that structural rearrangement occurs over
a range of shape parameters between 0.6 ≤ αa = αc ≤ 0.7,
and there is no sharp crossover. Computed thermal averages
of the order parameter ¯Q4 in bcc and sc crystals show that bcc
crystals have a peak near 0.08, and sc has a peak near 0.17
(Fig. 3c); however our calculations also suggest the existence
of structures with intermediate ¯Q4 for intermediate particle
shapes. This is conﬁrmed by umbrella sampling (Fig. 3d) with
a range of shapes intermediate between a clear bcc-former,
(αa, αc) = (0.6, 0.6), and a clear sc-former, (0.725, 0.725),
showing thermodynamically stable structures that are inter-

Shape-induced structural bcc↔sc reconﬁguration occurs
FIG. 3.
continuously in spheric-triangle invariant hard polyhedra. Panel a:
shapes used in umbrella sampling calculation. Panel b: for αa =
αc the pressure-shape constitutive relationship P (αa, αc) shows the
bcc↔sc transition starts at αa,c = 0.6. Panel c: second-neighbor
average l = 4 spherical harmonic order parameter ¯Q4 shows a series
of structures between bcc and sc. Panel d: umbrella sampling shows
no evidence of a thermodynamic phase transition.
using systems of N = 500 particles(Fig. 2a). For the bcc↔sc
reconﬁguration we used two groups of six different polyhedra
using systems of N = 432 particles (Fig. 3a). Free-energy
curves were reconstructed from the umbrella samples using
the weighted histogram analysis method (WHAM) [40], and
errors were estimated using jackknife resampling [41]. Fur-
ther methodological details are in appendix.
We investigated the phase boundary of the fcc↔bcc region
at four points and found that, in all cases, bcc↔fcc struc-
tural reconﬁguration occurs via a ﬁrst-order thermodynamic
phase transition. In Fig. 2 we show a detailed investigation of
a representative region near the boundary at ﬁxed αa = 0.4
(see appendix for other regions). Fig. 2a depicts the range of
shapes that we study; particles are colored from blue (bcc) to
red (fcc) according to the structures they form. Shapes colored
green exhibit an almost equal probability to form either bcc or
fcc. For this series of shapes, we investigate the pressure–

(a)(b)(c)(d)BCC-LikeSC-LikeBCCSCIntermediatestructuresmediate between bcc and sc, with no evidence of secondary
bcc or sc minima. Together, our results show that the bcc↔sc
reconﬁguration driven by building block shape change in the
323-family of triangle group invariant shapes occurs unac-
companied by a thermodynamic phase transition.
We performed MC simulations in which sc-forming parti-
cles were initialized into bcc and vice versa. Over 1.5 × 107
MC sweeps we observed particles spontaneously rearrange
into their preferred structure.

Experiments have demonstrated systems with changeable
building block shape, either directly [42–45] or effectively
with depletion [46]. Here, within a two parameter model fam-
ily of highly symmetric hard colloidal polyhedra, we found
examples of building-block shape change driven structural re-
conﬁguration that were accompanied by ﬁrst-order phase tran-
sitions, and those that were not accompanied by any thermo-
dynamic phase transition. This disparity in behavior is sur-
prising not only because it occurs within a single family of
model colloids, but also because of the way bcc and fcc, and
bcc and sc, are related. Whereas the mathematical transforma-
tion relating bcc and fcc is simply elongation in one direction
[47], bcc and sc are related by a transformation that involves
shearing particles within the unit cell [48]. Our results show
that the transformation between structures that is mathemat-
ically simpler to deﬁne is more difﬁcult to achieve thermo-
dynamically. Hence thermodynamically accessible crystal–
crystal reconﬁguration need not have a simple mathematical
deﬁnition, nor, vice versa, does mathematical simplicity mean
the reconﬁguration pathway is easier. Surprisingly, we also
ﬁnd that in contrast to what happens for hard spheres conﬁned
between parallel plates, crystal–crystal reconﬁguration need
not go though an intermediate ﬂuid state [25–27].

Our investigation also shows that the role of colloid shape
is more subtle than simple consideration of a particle’s point
group symmetry because we see different thermodynamic be-
havior for different structural reconﬁguration even though all
particles share the same point group symmetry. We also note
that particles that are self-dual (i.e. those for which αa = αc)
show the same pattern of behavior as particles that are not
self dual (see appendix for complete analysis). Our results
suggesting that the role of colloid shape is more subtle than
simple symmetry considerations accord well with prior work
showing that bulk structure depends on not just the symmetry
of shape features, but also on feature size and system density
[2, 21, 29].

Our results suggest that using shape to reconﬁgure between
two structures is viable, but that reconﬁguration among more
than two structures would be difﬁcult. First, for reconﬁgura-
tion between two structures, our results suggest that, for well-
chosen building blocks and bulk structures, crystal–crystal re-
conﬁguration can occur without a thermodynamic phase tran-
sition (see Fig. 3). The absence of a thermodynamic phase
transition suggests that thermal ﬂuctuations could drive recon-
ﬁguring building blocks to transition between structures dy-
namically, and we observed this dynamical transition in sim-
ulation. It is unlikely that our example of bcc↔sc reconﬁg-
uration is the only case of structural reconﬁguration that oc-
curs without a thermodynamic phase transition, so our results

4

suggest that further investigation should search for other such
examples.

Second, our ﬁndings suggest two types of possible limi-
tations on reconﬁguring between more than two structures.
(i) Our results on bcc↔sc reconﬁguration show that struc-
tural reconﬁguration occurs without a thermodynamic phase
transition over a range of building block shapes associated
with intermediate structures, rather than as a sharp crossover.
This means that signiﬁcant building block shape change is re-
quired to achieve a complete structural reconﬁguration from
one phase to the other if there is no sharp transition. If this
ﬁnding is generic, it suggests that reconﬁguration without a
phase transition between more than two structures is limited
because structural crossovers would be widely separated in
the space of building block shapes. (ii) In contrast, though we
found a sharp crossover for the ﬁrst-order bcc↔fcc transition,
our P (αa, αc) and umbrella sampling results show that even
in the event of a sharp crossover, metastable phases persist
deep into regions of parameter space in which other phases
are dominant (see Fig. 2). This means that even when struc-
tural reconﬁguration is accompanied by a sharp thermody-
namic transition, signiﬁcant building block reconﬁguration is
required to achieve structural reconﬁguration dynamically. If
this result is generic, it suggests that structural reconﬁgura-
tion would be difﬁcult to achieve in systems that have para-
metrically nearby sharp transitions because intermediate bulk
structures might be kinetically inaccessible.

Finally, the physics of crystral–crystal phase transitions in
metals, e.g. between γ-Fe (fcc) and α-Fe (bcc) [47], is of long-
standing interest. Though the present work was motivated
by the development of functional soft materials, recent work
[49–51] has shown that colloidal systems allow unprecedent-
edly detailed investigations of the basic physics of crystal–
crystal reconﬁguration. Our example systems of shape-driven
crystal–crystal reconﬁguration provide particularly clean ex-
amples of colloidal systems that reconﬁgure without the need
for external ﬁelds, and have the potential to further the under-
standing of structural transitions in metals, where transitions
can be insensitive to atomic details [52].

We thank K. Ahmed, J. Anderson, J. Dshemuchadse, O.
Gang, and E. Irrgang for helpful discussions and encourage-
ment. We thank D. Klotsa for sharing with us an early ver-
sion of Ref. [31]. This material is based upon work supported
by, or in part by, the U.S. Army Research Ofﬁce under Grant
Award No. W911NF-10-1-0518, the DOD/ASD(R&E) under
Award No. N00244-09-1-0062, and the Department of Energy
under Grant No. DE-FG02-02ER46000. X.D. and G.v.A. con-
tributed equally to this work.

Appendix A: Averaged Bond Order Parameter

The averaged bond order parameter [38] associates a set of
spherical harmonics with every ﬁctitious bond connecting one
particle to its near neighbors. Here a “bond” refers to a vector
from a particle to a neighboring particle. The mathematical
formalism of this parameter is as follows.

5

FIG. 4. Panel a: the spheric-triangle invariant 323-family of hard polyhedra reproduced from Ref. [30] (axes are not shown in Ref. [30] but
are linear in αa and αc). Panel b: the 323-family densest packing landscape. Lines indicating the studied shape change region are shown on
top of the ﬁgure reproduced from Ref. [30] (again, axes are αa and αc). Results of region 1 (Fig. 2 (main text)) and 2 (Fig. 3 (main text)) are
shown in the paper, and the remaining results are shown in the appendix Figs. 7, 8, 9, 10.

FIG. 5. The complete landscape of the bcc↔fcc pressure–shape constitutive relationship for ﬁxed αa = 0.4. The pressure–shape constitutive
relationship P (αa, αc) shows the bcc↔fcc transition occurs near αc = (0.2, 0.54). For detailed free energy analysis see S. 7 (αc = 0.2) and
Fig. 2 (main text) (αc = 0.54).

Following Ref. [38], we denote

Qlm((cid:126)r) ≡ Ylm(θ((cid:126)r), φ((cid:126)r))

(A1)

where (cid:126)r is the vector that indicates the bond and Ylm(θ, φ) are
spherical harmonics. To determine the local environment, we
consider the average
¯Qlm ≡ (cid:104)Qlm((cid:126)r)(cid:105)

(nearest neighbor average)

(A2)

over all near neighbors within some rcut, which is often the
cutoff radius of the ﬁrst neighbor shell. Since ¯Qlm for a given
l can change drastically when changing the orientation, one
should use the rotationally invariant combination, which is

Ql ≡

4π

2l + 1

m=−l

| ¯Qlm|2

.

(A3)

(cid:34)

l(cid:88)

(cid:35)1/2

❇  ❈✁✂  ✂  ❈✁❇  ❇  ❈✁✄ ❋☎☎✆✝✞☎☎✞☎☎✆✝❋☎☎✞☎☎✆✝✟☎✶✷✸✹✻✺(a)(b)✶✷✸✹✻✺6

FIG. 6. The complete landscape of the bcc↔fcc pressure–shape constitutive relationship for αa = αc. The pressure-shape constitutive
relationship P (αa, αc) shows the bcc-fccc transition occurs near αa,c = (0.28, 0.48). For detailed free energy analysis see Fig. 8 (αa,c=0.28)
and Fig. 9 (αa,c=0.48).

Ql has been shown to be a useful order parameter for describ-
ing certain crystal structures [38]. However, for the structures
of interest in this study, bcc, fcc, hcp, and sc have similar Ql
values, so it is problematic to use this deﬁnition of Ql as the
order parameter in umbrella sampling simulation.

Lechner and Dellago [37] have introduced a second neigh-
bor averaged Ql that reduces noise, and is a suitable order pa-
rameter for our investigation. In modiﬁed version, after ¯Qlm
is calculated, the values are again averaged over with all par-
ticles and their neigbors, which gives

Ave ¯Qlm ≡ (cid:104) ¯Qlm((cid:126)r)(cid:105).

(nearest neighbor+1 average)

The ﬁnal average Ql is in the form

(cid:34)

l(cid:88)

¯Ql ≡

4π

|Ave ¯Qlm|2

2l + 1

m=−l

(A4)

(cid:35)1/2

puted the biased energy for the target state point every 50
unbiased MC sweeps and apply a Metropolis criterion to de-
cide whether to accept or reject the series of moves. After
the system is equilibrated at the target state point, we sample
the biased distribution. Using the biased distribution with the
known bias, we can recover the unbiased free energy. Below
we discuss how to apply the formalism of umbrella sampling
(following Ref. [53]) to recover the free energy in the case of
shape-change driven structural reconﬁguration.

In the following derivation, superscript “b” denotes biased
quantities, while superscript “u” denotes unbiased quantities,
and wi( ¯Q4) is the bias potential of window i, which depends
solely on ¯Q4 in our case. The total energy of the system in
window i will then be

.

(A5)

Eb(r) = Eu(r) + wi( ¯Q4) = wi( ¯Q4).

(B1)

After comparing different l values, we found ¯Q4 with
a next-to-nearest-neighbor average gave the best order-
parametric separation of our structures of interest. We chose a
cutoff based on the number of nearest neighbors, rather than a
cutoff distance, because we found ¯Q4 for different cutoff dis-
tances was highly sensitive to the thermal noise, inherent in
our systems.

Appendix B: Umbrella Sampling

The basic idea of umbrella sampling [36] is to divide the
order parameter space (here, ¯Q4) into different state points
(windows) and apply a biased potential to the system that fa-
vors the target state point. To sample the system we com-

Since our system only contains hard particles, the unbiased
total energy of the system is 0.

To obtain the unbiased free energy Ai( ¯Q4), we need the

unbiased distribution, which is

(cid:82) exp[−βE(r)]δ[ ¯Q(cid:48)
(cid:82) δ[ ¯Q(cid:48)

(cid:82) exp[−βE(r)]dN r
(cid:82) dN r

4(r) − ¯Q4]dN r

.

4(r) − ¯Q4]dN r

i ( ¯Q4) =
P u

=

(B2)

During the umbrella sampling simulation, we can get the bi-
i along the order parameter ¯Q4. Assuming
ased distribution P b

7

Shape-change driven fcc↔bcc reconﬁguration is accom-
FIG. 7.
panied by ﬁrst-order thermodynamic phase transition in spheric-
triangle invariant hard polyhedra. Panel a: shapes used in umbrella
sampling calculation. Panel b: for ﬁxed αa = 0.4 the pressure–
shape constitutive relationship P (αa, αc) shows the bcc↔fcc tran-
sition occurs near αc = 0.2. Panel c: second-neighbor averaged
l = 4 spherical harmonic order parameter ¯Q4 distinguishes bcc, fcc,
and hcp crystal phases in thermal systems of spheric-triangle invari-
ant polyhedra. Panel d: below the transition (αc < α∗
c) a metastable
fcc free energy basin develops below αc = 0.185. Panel e: above
the transition (αc > α∗
c) the fcc free energy basin becomes dominant
above (αc = 0.190) and that well above the transition (αc = 0.215)
the bcc free energy basin becomes unstable, but there is a second
metastable hcp basin.

Shape-change driven fcc↔bcc reconﬁguration is accom-
FIG. 8.
panied by ﬁrst-order thermodynamic phase transition in spheric-
triangle invariant hard polyhedra. Panel a: shapes used in umbrella
sampling calculation. Panel b: for αa = αc the pressure–shape con-
stitutive relationship P (αa, αc) shows the bcc↔fcc transition occurs
near αa,c = 0.28. Panel c: second-neighbor averaged l = 4 spher-
ical harmonic order parameter ¯Q4 distinguishes bcc, fcc, and hcp
crystal phases in thermal systems of spheric-triangle invariant poly-
hedra. Panel d: below the transition (αc < α∗
c) a metastable fcc free
energy basin develops at αa,c = 0.25. Panel e: above the transi-
tion (αc > α∗
c) the fcc free energy basin becomes dominant above
(αa,c = 0.265) and that well above the transition (αc = 0.280)
the bcc free energy basin becomes unstable, but there is a second
metastable hcp basin.

(a)(b)(c)(d)(e)BCCHCPFCCBCC-LikeFCC-Like(a)(b)(c)(d)(e)BCC-LikeFCC-LikeBCCHCPFCC8

Shape-change driven bcc↔sc reconﬁguration occurs
FIG. 10.
continuously in spheric-triangle invariant hard polyhedra. Panel a:
shapes used in umbrella sampling calculation. Panel b: for ﬁxed
αa = 0.5 the pressure-shape constitutive relationship P (αa, αc)
shows the bcc-sc transition starts at αc = 0.7. Panel c: second-
neighbor average l = 4 spherical harmonic order parameter ¯Q4 in-
dicates a series of structures intermediate between bcc and sc. Panel
d: umbrella sampling shows no evidence of a thermodynamic phase
transition.

the system is ergodic, we have

4(r)(cid:1)]}δ[ ¯Q(cid:48)
(cid:0) ¯Q(cid:48)
(cid:82) exp{−β[E(r) + wi
4(r)(cid:1)]}dN r
(cid:0) ¯Q(cid:48)
(cid:82) exp{−β[E(r) + wi
4(r)(cid:1)]}δ[ ¯Q(cid:48)
(cid:0) ¯Q(cid:48)
(cid:82) exp{−β[wi
4(r)(cid:1)]}dN r
(cid:0) ¯Q(cid:48)
(cid:82) exp{−β[wi

4(r) − ¯Q4]dN r

4(r) − ¯Q4]dN r

.

(B3)

i ( ¯Q4) =
P b

=

Since the bias potential only depends on ¯Q4 and the integra-
tion in the numerator is over all degrees of freedom but ¯Q4,

Shape-change driven fcc↔bcc reconﬁguration is accom-
FIG. 9.
panied by ﬁrst-order thermodynamic phase transition in spheric-
triangle invariant hard polyhedra. Panel a: shapes used in umbrella
sampling calculation. Panel b: for αa = αc the pressure–shape con-
stitutive relationship P (αa, αc) shows the bcc↔fcc transition occurs
near αa,c = 0.48. Panel c: second-neighbor averaged l = 4 spher-
ical harmonic order parameter ¯Q4 distinguishes bcc, fcc, and hcp
crystal phases in thermal systems of spheric-triangle invariant poly-
hedra. Panel d: above the transition (αc > α∗
c) a metastable fcc free
energy basin develops at αa,c = 0.505. Panel e: below the transi-
tion (αc < α∗
c) the fcc free energy basin becomes dominant above
(αa,c = 0.495) and that well above the transition (αc = 0.475)
the bcc free energy basin becomes unstable, but there is a second
metastable hcp basin.

(a)(b)(c)(d)(e)FCC-LikeBCC-LikeBCCHCPFCC(a)(b)(c)(d)BCC-LikeSC-Likewe have
i ( ¯Q4) = exp[−βwi( ¯Q4)]
P b

×

(cid:82) exp[−βE(r)]δ[ ¯Q(cid:48)
(cid:0) ¯Q(cid:48)
4(r)(cid:1)]}dN r
(cid:82) exp{−β[E(r) + wi
(cid:82) δ[ ¯Q(cid:48)
4(r)(cid:1)]}dN r
(cid:0) ¯Q(cid:48)
(cid:82) exp{−β[wi

4(r) − ¯Q4]dN r

4(r) − ¯Q4]dN r

= exp[−βwi( ¯Q4)] ×

(B4)

Combining Eq. B2 and Eq. B4, we get

i ( ¯Q4) = P b
P u

i ( ¯Q4) exp[βwi( ¯Q4)](cid:104)exp[−βwi( ¯Q4)(cid:105)

(B5)

Using the deﬁnition of free energy, we obtain

Ai( ¯Q4) = −

Fi = −

ln P b

i ( ¯Q4) − wi( ¯Q4) + Fi

ln(cid:104)exp[−βwi( ¯Q4)](cid:105)

(B6)

(B7)

(cid:19)
(cid:19)

(cid:18) 1
(cid:18) 1

β

β

This result is exact up to numerical sampling errors, which
depends on the choice of the bias potential wi( ¯Q4). Here, we
chose a standard harmonic potential to be

wi( ¯Q4) =

(B8)
In all cases we used the range ¯Q4 ∈ [0.055, 0.179] evenly
divided into 32 windows.

4)2

k( ¯Q4 − ¯Qi

1
2

Appendix C: Pressure P (αa, αc) Plots

Six different groups of polyhedra were used in umbrella
sampling and were chosen from three different slices of the
323-family [30]. Fig. 4 shows the locations of the polyhedra
used in their shape family and Figs. 5 and 6 show the complete
pressure P (αa, αc) plots of two of the three slices that have
more than one phase boundary.

Appendix D: Free Energy Plots

Similar to Fig. 2 and Fig. 3 in the main text, which show
the free energy calculation for two groups of polyhedra, Figs.
7, 8, 9, and 10 show the free energy calculation of the re-
maining four groups. The ﬁgures follow the same style, with
panel a indicating the polyhedra used, panel b showing the
pressure-shape constitutive relationship, and the rest of the
panels showing the free energy calculation.

Appendix E: Error Analysis

All the error bars in the free energy plots are generated us-
ing jackknife resampling. We selected ten different subsets of
all the replica-runs data and stitched the resulting free energy

9

curves from the subsets. The error from WHAM is negligible.
However, jackknife resampling can only compute the statisti-
cal error; due to the large sample size (50000 × 5 = 250000),
the statistical error is still small. The largest and most difﬁcult
error to calculate is the systematic error of umbrella sampling.
This systematic error can come from multiple sources. First,
due to the equilibration routine of the umbrella sampling sim-
ulation, for each individual window, the ﬁnal distribution can
be shifted slightly to the left or right of the target ¯Q4 value
for each independent run. Second, the initial state of the sys-
tem can also affect the end result slightly. Because of this,
we conducted simulations from the two extreme cases, initial-
izing the system with the two solid phases we wish to study,
and compared the free energy of the end result. In Figs. 11,
and 12, we can see that the free energy curves shifted slightly
with different initialization, but the macroscopic behavior of
the phase transition, or lack thereof, stayed the same.

Appendix F: Comparison of Landau and Ehrenfest Approaches

The identiﬁcation of thermodynamic phase transitions can
be done using either the Ehrenfest (constitutive relation) or
Landau (free energy) approaches. Here, we have chosen to
compute Landau free energies using umbrella sampling as de-
scribed above; however, we would like to contrast our ap-
proach with an Ehrenfest approach, e.g. computing pressure
as a function of shape space.

As a shorthand, we will refer to the constitutive relation-
ship µ(α), deﬁned and computed in [29], as the “equation of
shape” because like P (V ) it relates state variables of stress
and strain, but in the alchemical space of shapes. Usually ther-
modynamic phase transitions in systems of hard colloids are
considered as a function of packing fraction [54] so that the
equation of state is the quantity of interest. Here, we are inter-
ested in phase transitions at ﬁxed packing fraction that occur
as a function of shape, meaning that the equation of shape is
the quantity of interest. In order to identify and classify “al-
chemical” phase transitions using the Ehrenfest approach one
must compute high precision equations of shape near the crit-
ical α = α∗. To get a high precision equation of shape in
this region would be difﬁcult, particularly if the transition is
ﬁrst order. If the transition is ﬁrst order, the equation of shape
is multivalued near α∗. For α < α∗, µ receives two contri-
butions, one from the metastable structure, and one from the
stable structure, with the ﬁnal value of µ arising as a weighted
sum of the contributions from the two structures. Determin-
ing the relative weight of the various contributions would re-
quire lattice switch [55] or other advanced sampling methods.
However, for ﬁnite sized systems near α∗ the difference in free
energy between competing phases would become vanishingly
small, making the computation expensive.
In passing, however, we note that the lattice switch method
[55] could be used to obtain high precision estimates of α∗
that do not suffer from the systematic errors arising in um-
brella sampling that are described in Sec. E above.
In the
present study, we were principally interested in determining
the thermodynamic nature of shape-driven phase transitions,
rather than precisely locating the critical shapes.

10

FIG. 11. Shape-change driven fcc↔bcc reconﬁguration is accompanied by ﬁrst-order thermodynamic phase transition in spheric-triangle
invariant hard polyhedra, shown here with both bcc (solid line) and fcc (dashed line) initialization. Differences between curves indicate
systematic errors in the computing the location of the transition, but indicate the thermodynamic nature of the transition is robust. Panel a: free
energy curves of hard polyhedra as Fig. 7. Panel b: free energy curves of hard polyhedra as Fig. 8 (discontinuity in red dotted line indicates
insufﬁcient statistics in one umbrella sampling window). Panel c: free energy curves of hard polyhedra as Fig 9. Panel d: free energy curves
of hard polyhedra as Fig. 2 (main text).

FIG. 12. Shape-change driven bcc↔sc reconﬁguration occurs continuously by continuous transition in spheric-triangle invariant hard polyhe-
dra, shown here with both bcc (solid line) and sc (dashed line) system initialization. Differences between curves indicate systematic errors in
the computing the location of the transition, but indicate the thermodynamic is robust. Panel a: free energy curves of hard polyhedra as Fig. 3
(main text). Panel b: free energy curves of hard polyhedra as Fig. 10.

(a)(b)(c)(d)(a)(b)11

[1] V. N. Manoharan, Science 349, 942 (2015)
[2] G. van Anders, D. Klotsa, N. K. Ahmed, M. Engel,

and
S. C. Glotzer, Proc. Natl. Acad. Sci. U.S.A. 111, E4812 (2014),
arXiv:1309.1187 [cond-mat.soft]

[3] D. Frenkel, J. Phys. Chem. 91, 4912 (1987)
[4] A. Haji-Akbari, M. Engel, A. S. Keys, X. Zheng, R. G.
Petschek, P. Palffy-Muhoray, and S. C. Glotzer, Nature 462,
773 (2009), arXiv:1012.5138 [cond-mat.soft]

[5] J. de Graaf, R. van Roij, and M. Dijkstra, Phys. Rev. Lett. 107,

155501 (2011), arXiv:1107.0603 [cond-mat.soft]

[6] P. F. Damasceno, M. Engel, and S. C. Glotzer, ACS Nano 6,

609 (2012), arXiv:1109.1323 [cond-mat.soft]

[7] R. Ni, A. P. Gantapara, J. de Graaf, R. van Roij, and M. Di-
jkstra, Soft Matter 8, 8826 (2012), arXiv:1111.4357 [cond-
mat.soft]

[8] U. Agarwal and F. A. Escobedo, Nat. Mater. 10, 230 (2011)
[9] L. Rossi, S. Sacanna, W. T. M. Irvine, P. M. Chaikin, D. J. Pine,

and A. P. Philipse, Soft Matter 7, 4139 (2011)

[10] P. F. Damasceno, M. Engel, and S. C. Glotzer, Science 337,

453 (2012), arXiv:1202.2177 [cond-mat.soft]

[11] J. Henzie, M. Grünwald, A. Widmer-Cooper, P. L. Geissler, and

P. Yang, Nat. Mater. 11, 131 (2012)

[12] U. Agarwal and F. A. Escobedo, J. Chem. Phys. 137, 024905

(2012)

[13] A. P. Gantapara, J. de Graaf, R. van Roij, and M. Dijkstra,

Phys. Rev. Lett. 111, 015501 (2013)

[14] S. C. Glotzer and M. J. Solomon, Nat. Mater. 6, 557 (2007)
[15] A. R. Tao, S. Habas, and P. Yang, Small 4, 310 (2008)
[16] A. Stein, F. Li, and Z. Wang, J. Mater. Chem. 19, 2102 (2009)
[17] L. Cademartiri, K. J. M. Bishop, P. W. Snyder, and G. A. Ozin,

Philos. Trans. R. Soc., A 370, 2824 (2012)

[18] A. B. Pawar and I. Kretzschmar, Macromol. Rapid Commun.

[19] S. Sacanna and D. J. Pine, Curr. Opin. Colloid Interface Sci. 16,

[20] Y. Xia, X. Xia, Y. Wang, and S. Xie, MRS Bulletin 38, 335

31, 150 (2010)

96 (2011)

(2013)

[21] G. van Anders, N. K. Ahmed, R. Smith, M. Engel, and S. C.
Glotzer, ACS Nano 8, 931 (2014), arXiv:1304.7545 [cond-
mat.soft]

[22] Y. Zhang, F. Lu, D. van der Lelie, and O. Gang, Phys. Rev.

Lett. 107, 135701 (2011)

S. C. Glotzer, Phys. Rev. X 4, 011024 (2014), arXiv:1309.2662
[cond-mat.soft]

[31] D. Klotsa, E. R. Chen, M. Engel, P. F. Damasceno, and S. C.

Glotzer, In preparation (2016)

[32] K. L. Young, M. L. Personick, M. Engel, P. F. Damasceno, S. N.
Barnaby, R. Bleher, T. Li, S. C. Glotzer, B. Lee, and C. A.
Mirkin, Angew. Chem., Int. Ed. 52, 13980 (2013)

[33] J. A. Anderson and S. C. Glotzer,

(2013), http://
codeblue.umich.edu/hoomd-blue, arXiv:1308.5587
[physics.comp-ph]

[34] J. A. Anderson, M. E. Irrgang, and S. C. Glotzer,

(2015),

arXiv:1509.04692 [cond-mat.soft]

[35] R. Eppenga and D. Frenkel, Molecular Physics 52, 1303 (1984)
[36] G. Torrie and J. Valleau, J. Comp. Phys. 23, 187 (1977)
[37] W. Lechner and C. Dellago, J. Chem. Phys. 129, 114707 (2008),

10.1063/1.2977970

28, 784 (1983)

[38] P. J. Steinhardt, D. R. Nelson, and M. Ronchetti, Phys. Rev. B

[39] k is parametrically large because it scales like the inverse square
of the resolution of the order parameter, δ ¯Ql. For our crystals
of interest, ¯Ql falls in the range of 0.05 to 0.2, so that we need
to be able to resolve order parameter intervals of δ ¯Ql ≈ 0.005.
The value k = 3.5×104 we found to be consistent with efﬁcient
sampling is consistent with a naive estimate k ≈ (δ ¯Ql)−2.

[40] S. Kumar, J. M. Rosenberg, D. Bouzida, R. H. Swendsen, and

P. A. Kollman, J. Comput. Chem. 13, 1011 (1992)

[41] B. Efron, Biometrika 68, 589 (1981)
[42] O. Gang and Y. Zhang, ACS Nano 5, 8459 (2011)
[43] K. J. Lee, J. Yoon, S. Rahmani, S. Hwang, S. Bhaskar, S. Mi-
tragotri, and J. Lahann, Proc. Natl. Acad. Sci. U.S.A. 109,
16057 (2012)

[44] S. Saha, D. Copic, S. Bhaskar, N. Clay, A. Donini, A. J. Hart,

and J. Lahann, Angew. Chem., Int. Ed. 51, 660 (2012)

[45] J. Zhou, S. A. Turner, S. M. Brosnan, Q. Li, J.-M. Y. Carrillo,
D. Nykypanchuk, O. Gang, V. S. Ashby, A. V. Dobrynin, and
S. S. Sheiko, Macromolecules 47, 1768 (2014)

[46] L. Rossi, V. Soni, D. J. Ashton, D. J. Pine, A. P. Philipse, P. M.
Chaikin, M. Dijkstra, S. Sacanna, and W. T. M. Irvine, Proc.
Natl. Acad. Sci. U.S.A. 112, 5286 (2015)

[47] E. C. Bain and N. Y. Dunkirk, Trans. AIME 70, 25 (1924)
[48] R. Li, K. Bian, Y. Wang, H. Xu, J. A. Hollingsworth, T. Han-

rath, J. Fang, and Z. Wang, Nano Letters 15, 6254 (2015)
[49] T. D. Nguyen and S. C. Glotzer, ACS Nano 4, 2585 (2010)
[50] T. D. Nguyen, E. Jankowski, and S. C. Glotzer, ACS Nano 5,

[23] M. M. Maye, M. T. Kumara, D. Nykypanchuk, W. B. Sherman,

and O. Gang, Nat. Nano. 5, 116 (2010)

[24] Y. Kim, R. J. Macfarlane, M. R. Jones, and C. A. Mirkin, Sci-

8892 (2011)

ence 351, 579 (2016)

[51] P. S. Mohanty, P. Bagheri, S. Nöjd, A. Yethiraj, and P. Schurten-

[25] Y. Peng, F. Wang, Z. Wang, A. M. Alsayed, Z. Zhang, A. G.

berger, Phys. Rev. X 5, 011030 (2015)

Yodh, and Y. Han, Nat Mater 14, 101 (2015)

[26] E. Sanz and C. Valeriani, Nat Mater 14, 15 (2015)
[27] W. Qi, Y. Peng, Y. Han, R. K. Bowles, and M. Dijkstra, Phys.

[52] J. Duncan, A. Harjunmaa, R. Terrell, R. Drautz, G. Henkelman,

and J. Rogal, Phys. Rev. Lett. 116, 035701 (2016)

[53] J. Kästner, Wiley Interdisciplinary Reviews: Computational

[28] D. A. Porter, Phase Transformations in Metals and Alloys, 3rd

Rev. Lett. 115, 185701 (2015)

ed. (CRC Press, Florida, 2009)

[29] G. van Anders, D. Klotsa, A. S. Karas, P. M. Dodd, and S. C.
Glotzer, ACS Nano 9, 9542 (2015), arXiv:1507.04960 [cond-
mat.soft]

[30] E. R. Chen, D. Klotsa, M. Engel, P. F. Damasceno,

and

Molecular Science 1, 932 (2011)

[54] M. Engel, J. A. Anderson, S. C. Glotzer, M. Isobe, E. P.

Bernard, and W. Krauth, Phys. Rev. E 87, 042134 (2013)

[55] A. D. Bruce, N. B. Wilding, and G. J. Ackland, Phys. Rev. Lett.

79, 3002 (1997), arXiv:cond-mat/9706154

