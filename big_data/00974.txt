6
1
0
2

 
r
a

M
3

 

 
 
]
P
A

.
t
a
t
s
[
 
 

1
v
4
7
9
0
0

.

3
0
6
1
:
v
i
X
r
a

Regression Analysis for Microbiome Compositional Data1

Pixu Shi, Anru Zhang and Hongzhe Li

Abstract

One important problem in microbiome analysis is to identify the bacterial taxa that are

associated with a response, where the microbiome data are summarized as the composition of

the bacterial taxa at diﬀerent taxonomic levels. This paper considers regression analysis with

such compositional data as covariates. In order to satisfy the subcompositional coherence of the

results, linear models with a set of linear constraints on the regression coeﬃcients are introduced.

Such models allow regression analysis for subcompositions and include the log-contrast model

for compositional covariates as a special case. A penalized estimation procedure for estimating

the regression coeﬃcients and for selecting variables under the linear constraints is developed.

A method is also proposed to obtain de-biased estimates of the regression coeﬃcients that are

asymptotically unbiased and have a joint asymptotic multivariate normal distribution. This

provides valid conﬁdence intervals of the regression coeﬃcients and can be used to obtain the

p-values. Simulation results show the validity of the conﬁdence intervals and smaller variances

of the de-biased estimates when the linear constraints are imposed. The proposed methods are

applied to a gut microbiome data set and identify four bacterial genera that are associated with

the body mass index after adjusting for the total fat and caloric intakes.

Keywords: Compositional coherence; Coordinate descent method of multipliers; High di-

mension; Log-contrast model; Model selection; Regularization;

1Pixu Shi is with Department of Biostatistics and Epidemiology, University of Pennsylvania; Anru Zhang is

with Department of Statistics, University of Wisconsin-Madison; Hongzhe Li is with Department of Biostatis-

tics and Epidemiology, University of Pennsylvania. This research was supported by NIH grants CA127334

and GM097505.

1

1

Introduction

The human microbiome includes all microorganisms in and on the human body. These mi-

crobes play important roles in human metabolism, nutrient intake and energy generation and

thus are essential in human health. The gut microbiome has been shown to be associated with

many human diseases such as obesity, diabetes and inﬂammatory bowel disease (Turnbaugh

et al., 2006; Qin et al., 2012; Manichanh et al., 2012). Next generation sequencing technolo-

gies make it possible to study the microbial compositions without the need for culturing the

bacterial species. There are, in general, two approaches to quantify the relative abundances

of bacteria in a community. One approach is based on sequencing the 16S ribosomal RNA

(rRNA) gene, which is ubiquitous in all bacterial genomes. The resulting sequencing reads

provide information about the bacterial taxonomic composition. Another approach is based

on shotgun metagenomic sequencing, which sequences all the microbial genomes presented in

the sample, rather than just one marker gene. Both 16S rRNA and shotgun sequencing ap-

proaches provide bacterial taxonomic composition information and have been widely applied

to human microbiome studies, including the Human Microbiome Project (HMP) (Turnbaugh

et al., 2007) and the Metagenomics of the Human Intestinal Tract (MetaHIT) project (Qin

et al., 2010).

Several methods are available for quantifying the microbial relative abundances based

on the sequencing data, which typically involve aligning the reads to some known database

(Segata et al., 2012). Since the DNA yielding materials are diﬀerent across diﬀerent samples,

the resulting numbers of sequencing reads vary greatly from sample to sample. In order to

make the microbial abundance comparable across samples, the abundances in read counts are

usually normalized to the relative abundances of all bacteria observed. This results in high-

dimensional compositional data with a unit sum. Some of the most widely used metagenomic

processing softwares such as MEGAN (Huson et al., 2007) and MetaPhlAn (Segata et al.,

2012) only output the relative abundances of the bacterial taxa at diﬀerent taxonomic levels.

This paper considers regression analysis of microbiome compositional data, where the goal

2

is to identify the bacterial taxa that are associated with a continuous response such as the

body mass index (bmi). Compositional data are strictly positive and multivariate that are

constrained to have a unit sum. Such data are also referred to as mixture data (Aitchison

and Bacon-Shone, 1984; Snee, 1973; Cornell, 2002). Regression analysis with compositional

covariates needs to account for the intrinsic multivariate nature and the inherent interrelated

structure of such data. For compositional data, it is impossible to alter one proportion with-

out altering at least one of the other proportions. Linear log-contrast model (Aitchison and

Bacon-Shone, 1984) has been proposed for compositional data regression where logarithmic-

transformed proportions are treated as covariates in a linear regression model with the con-

straint of the sum of the regression coeﬃcients being zero. Lin et al. (2014) proposed a variable

selection procedure for such models in high-dimensional settings and derived the weak oracle

property of the resulting estimates. In analysis of microbiome data, it is also of biological

interest to study the subcompositions of bacteria taxa within higher taxonomic levels, such

as subcompositions of species under a given genus or phylum, or subcompositions of genera

within a phylum. In subcompositional data, the proportions of species have been calculated

relative to total proportions of the species under a given genus; that is, the values in the sub-

composition have been re-closed to add up to 1. Regression analysis of such subcompositional

data is also considered in this paper.

One of the founding principles of compositional data analysis is that of subcompositional

coherence (Aitchison, 1982): any compositional data analysis should be done in a way that

we obtain the same results in a subcomposition, regardless of whether we analyze only that

subcomposition or a larger composition containing other parts. This is especially relevant in

high-dimensional regression analysis with compositional covariates, where the goal is to select

the bacteria whose compositions are associated with the response. Once such bacteria are

identiﬁed, it is desirable to recalculate the subcomposition only within those identiﬁed. How-

ever, these subcompositions have diﬀerent values from those calculated based on a larger set

of bacterial taxa. The log-contrast model of Aitchison and Bacon-Shone (1984) and Lin et al.

3

(2014) satisﬁes this principal by imposing a linear constraint on the regression coeﬃcients.

This paper extends this model for analysis of microbiome subcompositions, where multiple

linear constraints are imposed in order to achieve the subcompositional coherence.

Penalized and constrained regression, including constrained Lasso regression, has been

studied by James et al. (2015), where the regression coeﬃcients are subject to a set of lin-

ear constraints. A computational algorithm through reformulating the problem as an uncon-

strained optimization problem was proposed and non-asymptotic error bounds of the estimates

were derived. Diﬀerent from James et al. (2015), this paper presents an eﬃcient computational

algorithm based on the coordinate descent method of multipliers and augmented Lagrange of

optimization problem. Since the resulting estimates are often biased due to (cid:96)1 penalty imposed

on the coeﬃcients, variance estimation and statistical inference of the resulting estimates are

diﬃcult to derive. In order to make the statistical inference on the regression coeﬃcients and

to obtain the conﬁdence intervals, asymptoticly unbiased estimates of the regression coeﬃ-

cients are ﬁrst obtained through a de-biased procedure and their joint asymptotic distribution

is derived. The proposed de-biased procedure extends that of Javanmard and Montanari

(2014) to take into account the linear constraints on regression coeﬃcients. However, due to

the linear constraints on the regression coeﬃcients, the theoretical developments are diﬀerent

from Javanmard and Montanari (2014).

Section 2 presents linear regression models with linear constraints for compositional covari-

ates. Section 3 presents an eﬃcient coordinate descent method of multipliers to implement the

penalized estimation of the regression coeﬃcients under linear constraints. Section 4 provides

an algorithm to obtain de-biased estimates of the coeﬃcients and derives their joint asymp-

totic distribution. Section 5 presents results from an analysis of gut microbiome data set in

order to identify the bacterial genera that are associated with bmi. Methods are evaluated in

Section 6 through simulations.

4

2 Regression Models for Compositional Data

2.1 Linear log-contrast model

Linear log-contrast model (Aitchison and Bacon-Shone, 1984) has been proposed for compo-
sitional data regression. Speciﬁcally, suppose an n × p matrix X consists of n samples of the

composition of mixture with p components, and suppose Y is a response variable depending
on X. The nature of composition makes each row of X lie in a (p − 1)-dimensional positive
j=1 xj = 1}. Based on this nature,

simplex Sp−1 = {(x1, . . . , xp) : xj > 0, j = 1, . . . , p and (cid:80)p

Aitchison and Bacon-Shone (1984) introduced a linear log-contrast model as follows:

Y = Zpβ\p + ,

(1)

where Zp = {log(xij/xip)} is n × (p − 1) log-ratio matrix with the pth component as the
reference component, β\p = (β1, . . . , βp−1) is the regression coeﬃcient vector, and noise  is

independently distributed as N (0, σ2). An intercept term is not included in the model, since

it can be eliminated by centering the response and predictor variables.

The selection of reference component is crucial to analysis, especially in high-dimensional

settings. To avoid choosing an arbitrary reference component, Lin et al. (2014) reformulated

(1) as a regression problem with a linear constraint on the coeﬃcients by letting

model

βp = −(cid:80)p−1

j=1 βj,

where 1p = (1, . . . , 1)(cid:62) ∈ Rp, Z = (z1, . . . , zp) = (log xij) ∈ Rn×p, and β = (β1, . . . , βp)(cid:62).

Y = Zβ + ,

1(cid:62)
p β = 0,

(2)

2.2 Subcompositional regression model

In analysis of microbiome data, the relative abundances of taxa are often obtained at diﬀerent

taxonomic ranks, including species, genus, family, class and phylum. It is of interest to study

whether the composition of taxa that belong to a given taxon at a higher rank is associated

5

with the response, in which case subcompositions of taxa (e.g., all the genera that belong to

a given phylum) are calculated. Suppose r taxa at a given rank are considered with mg taxa

at the lower rank that belong to taxon g. Let Xgs be the relative abundance of the sth taxon
that belong to the gth taxon at a higher rank, for g = 1,··· , r, s = 1,··· , mg such that

mg(cid:88)

s=1

Xgs = 1, for g = 1,··· , r.

Let n × mg matrix Xg represents n samples of the subcomposition of mg taxa. The following
model can be used to link the subcompositions to a response Y ,

Y =

Zgβg + ,

(3)

where Zg = (Zg1, . . . , Zgmg ) = (log Xg1, . . . , log Xgmg ) ∈ Rn×mg , and βg = (βg1,··· , βgmg )(cid:62).
To make the model subcompositional coherence, the following r linear constraints are imposed,

This set of linear constraints can be written as C(cid:62)β = 0, where β = (β(cid:62)

1 ,··· , β(cid:62)

r )(cid:62), and

r(cid:88)

g=1

mg(cid:88)

s=1

1(cid:62)
mg βg =

βgs = 0 for g = 1··· , r.



C(cid:62) =

1 ··· 1 0 ··· 0 0 ··· 0
0 ··· 0 1 ··· 1 0 ··· 0
...
...
0 ··· 0 0 ··· 0 1 ··· 1

···

...

...

...

...

...

...



r×p

Models (2) and (3) belong to a more general high-dimensional linear model with r linear

constraints on the coeﬃcients,

Y = Zβ + , C(cid:62)β = 0,

(4)

where the rows of Z ∈ Rp are independently and identically distributed with mean zero, C is a
p× r matrix of the constraint coeﬃcients, β = (β1, . . . , βp)(cid:62), and  ∼ Nn(0, σ2I). Without loss
of generality, C = (c1, . . . , cr) is assumed to be orthonormal. In high-dimensional settings, β
√
is assumed to be s-sparse, where s = #{i : βi (cid:54)= 0} and s = o(

n/ log p).

6

This paper considers estimation and inference of Model (4) under the general linear con-

straints. Lin et al. (2014) proposed a procedure for variable selection and estimation for

Model (2) and derived the weak oracle property of the resulting estimates. James et al.

(2015) considered a more general model and provided non-asymptotic bounds on estimation

errors. However, variances of the estimates and statistical inference are lacking. In this paper,

an algorithm to perform variable selection for Model (4) based on (cid:96)1 penalized estimation

is ﬁrst proposed based on coordinate descent method of multipliers. An inference procedure

for the penalized estimator of the regression coeﬃcients is then introduced. The proposed

approach parallels to that of Javanmard and Montanari (2014) by ﬁrst obtaining de-biased es-

timates of the coeﬃcients for high-dimensional linear model with linear constraints, ˆβu, which

are shown to be asymptotically Gaussian, with mean β and covariance σ2((cid:102)M(cid:98)Σ(cid:102)M)/n, where
(cid:98)Σ is the empirical covariance and (cid:102)M is determined by solving a convex program. Based on

this asymptotic result, the corresponding conﬁdence intervals and p-values are constructed

and used for statistical inference.

3 Penalized Estimation

In this following presentation, for a matrix Am×n, ||A||p is the (cid:96)p operator norm deﬁned as
||A||p = sup||x||p=1 ||Ax||p, where ||v||p is the standard (cid:96)p norm of a vector v. In particular,
||A||∞ = max1≤i≤m

(cid:80)n
j=1 |aij|. We also deﬁne |A|∞ = maxi,j |aij|.

Consider model (4). Deﬁne PC = CC(cid:62) as the projection onto the space spanned by the

columns of C. Two basic regularity conditions on C are assumed:

Condition 1 ||Ip − PC||∞ ≤ k0 for a constant k0 that is free of p.

Condition 2 The diagonal elements of Ip − PC are greater than zero.

Condition 1 is equivalent to that ||cj||1||cj||∞, j = 1, . . . , r are all bounded by a constant
that is free of p. Condition 2 means that the group of constraints do not indicate simple

7

constraint such as βj = 0. If (Ip − PC)j,j = 0, then the jth row and column of Ip − PC are
all zeros, and thus (Ip − PC)ej = 0, which means that ej lies in the space spanned by the
columns of C. It is easy to verify that the constraint matrix C in the log-contrast model (2)

or the subcompositional model (3) satisﬁes both conditions. For example, in the log-contrast

√
p since
model (2), k0 = 2 for C = 1p/

p(cid:88)

p(cid:88)

||(Ip − 1p1(cid:62)

p /p)a||∞ = ||a − 1
p

aj1||∞ ≤ ||a||∞ + | 1
p

Deﬁne (cid:101)Z = Z(Ip − PC). Since PCβ = 0, model (4) can be rewritten as

j=1

j=1

aj| ≤ 2||a||∞.

Y =(cid:101)Zβ + , C(cid:62)β = 0.

(5)

The regression coeﬃcients can be estimated using (cid:96)1 penalized estimation with linear con-

straints,

(cid:98)βn = argmin

β

(cid:18) 1

2n

||Y −(cid:101)Zβ||2

2 + λ||β||1

(cid:19)

subject to C(cid:62)β = 0,

(6)

where λ is a tuning parameter.

A coordinate descent method of multipliers can be used to implement the constrained opti-

mization problem (6). First, the augmented Lagrange of optimization problem (6) (Bertsekas,

1996) is formed as,

Lµ(β, η) =

1
2n

||y −(cid:101)Zβ||2

2 + λ||β||1 + η(cid:62)C(cid:62)β +

||C(cid:62)β||2
2,

µ
2

where η ∈ Rr is the Lagrange multiplier, and µ > 0 is a penalty parameter. Problem (6) can

be solved by iterations

βk+1 ← argmin

Lµ(β, ηk),

ηk+1 ← ηk + µC(cid:62)βk+1.

Deﬁne ξ = η/µ, the iterations become

β

(cid:26) 1

||y −(cid:101)Zβ||2

2 + λ||β||1 +

(cid:27)

,

||C(cid:62)β + ξk||2

2

µ
2

(7)

(8)

βk+1 ← argmin

β

2n
ξk+1 ← ξk + C(cid:62)βk+1.

8

The iteration of β can be further detailed as

(cid:34)

1
n

j (y −(cid:88)

˜z(cid:62)

(cid:88)

(cid:35)

j ←
βk+1

1
+ µ||Cj||2

Sλ

||˜zj||2
n

2

˜zi) − µ(

βk+1
i

i C(cid:62)
βk+1

i Cj + C(cid:62)

j ξk)

,

(9)

2

i(cid:54)=j

i(cid:54)=j

sgn(t)(|t| − λ)+. Combining (7)-(9) yields the following algorithm for solving problem (6).

where Ci, i = 1, . . . , p are the rows of C, ˜zi, i = 1, . . . , p are columns of (cid:101)Z, and Sλ(t) =
Input: Y , (cid:101)Z, and λ.
Output: (cid:98)βn

1: Initialize β0 with 0 or a warm start, ξ0 = 0, µ > 0 and k = 0.

2: For j = 1, . . . , p, 1, . . . , p, . . . , update βk+1

j

by (9) until convergence.

3: Update ξk+1 by (8).
4: k ← k + 1 and repeat the two steps above until convergence.

Algorithm 1: Coordinate descent method of multipliers for solving problem (6)

The penalty parameter µ that is needed to enforce the zero-sum constraints does not aﬀect

the convergence of Algorithm 1 as long as µ > 0. It can however aﬀect the convergence rate

of the algorithm. In this paper, µ = 1 is taken in all the computations.

4 A De-biased Estimator and Its Asymptotic Distribu-

tion

4.1 A De-biased estimator

The asymptotic distribution of (cid:96)1 regularized estimator (cid:98)βn is not manageable and (cid:98)βn is biased

due to regularization. Javanmard and Montanari (2014) proposed a procedure to construct

a de-biased version of the unconstrained lasso estimator that has a tractable asymptotic

distribution, which can be used to obtain the conﬁdence intervals of the regression coeﬃcients.

Similar de-biased procedures were also developed by Zhang and Zhang (2014) and B¨uhlmann

(2013).

9

Adapting the de-biased procedure of Javanmard and Montanari (2014), the following al-

gorithm can be used to obtain de-biased estimates of the regression coeﬃcients, (cid:98)βu.
Input: Y , Z, (cid:98)βn, and γ.
Output: (cid:98)βu
Let (cid:98)βn be the regularized estimator from optimization problem (6).
Set (cid:101)Z = Z(Ip − PC).
Set (cid:98)Σ ≡ ((cid:101)Z(cid:62)(cid:101)Z)/n.

for i = 1, 2, . . . , p do:

Let mi be a solution of the convex program:

minimize m(cid:62)(cid:98)Σm
subject to ||(cid:98)Σm − (Ip − PC)ei||∞ ≤ γ.

end for

Set M = (m1, . . . , mp)(cid:62), set (cid:102)M = (Ip − PC)M(Ip − PC).
Deﬁne the estimator (cid:98)βu as follows:(cid:98)βu = (cid:98)βn +

(cid:102)M(cid:101)Z(cid:62)(Y −(cid:101)Z(cid:98)βn).

1
n

(10)

(11)

(12)

To solve problem (10), Matlab package cvx is used for specifying and solving convex

Algorithm 2: Constructing a de-biased estimator

programs (Grant and Boyd, 2013). To brieﬂy explain the logic behind this algorithm, denote

Σ = E(cid:101)Z(cid:62)(cid:101)Z, and suppose that Σ = VΛV(cid:62) is the eigenvalue/eigenvector decomposition of Σ,

where Λ = diag(λ1, . . . , λp−r). Note that (V, C) is full rank and orthonormal, and

Σ = (V, C)

 Λ 0

 (V, C)(cid:62).

0

0

10

Deﬁne

then

 (V, C)(cid:62),

 Λ−1 0
 (V, C)(cid:62) = VV(cid:62) = Ip − PC,

0

0

Ω = (V, C)

 Ip−r 0

0

0

ΣΩ = (V, C)

where Ω is the inverse of Σ in the perpendicular space of the column space of C. The de-

biased algorithm ﬁrst ﬁnds an approximation of Ω by rows, denoted by(cid:102)M, and then corrects
the bias based on(cid:102)M. At the last step of this algorithm, (cid:98)βu is the de-biased version of (cid:98)βn. It
is easy to check that C(cid:62)(cid:98)βu = 0, which is guaranteed by (11).
sumptions on matrix (cid:101)Z = ((cid:101)Z1, . . . ,(cid:101)Zn)(cid:62):

The feasibility of the optimization (10) is presented in Lemma 1 under the following as-

Condition 3 There exist uniform constants Cmin, Cmax such that 0 < Cmin ≤ σmin(Σ) ≤
σmax(Σ) ≤ Cmax < ∞, where σmax(A)(σmin(A)) is the largest (smallest) non-zero eigenvalue
of matrix A.

Condition 4 There exists a uniform constant κ ∈ (0,∞) such that the rows of (cid:101)ZΩ1/2 are
sub-Gaussian with ||Ω1/2(cid:101)Z1||ψ2 ≤ κ, where the sub-Gaussian norm of a random vector Z ∈ Rn

is deﬁned as

||Z||ψ2 = sup{||Z(cid:62)x||ψ2 : x ∈ Rn,||x||2 = 1},

with ||X||ψ2 deﬁned as ||X||ψ2 = supq≥1 q−1/2(E|X|q)1/q for a random variable X.
These two conditions are imposed on (cid:101)Z = Z(Ip − PC), not on the original log-ratio matrix Z.
For the subcompositional model (3), it is easy to see that(cid:101)Z is the matrix of the centered log-

ratio (CLR) transformation of the original taxonomic composition (Aitchison, 1982), where

(cid:101)Zgs = log

mg(cid:112)(cid:81)mg

Xgs
s=1 Xgs

.

11

CLR has been shown to be eﬀective in transforming compositional data to approximately

multivariate normal in many real compositional and microbiome data (Aitchison, 1982; Kurtz

et al., 2015). Conditions 3 and 4 are therefore reasonable assumptions in our setting.

The following Lemma shows that if γ = c(cid:112)log p/n in Algorithm 2 is properly chosen, Ω
Lemma 1 Let (cid:98)Σ ≡ ((cid:101)Z(cid:62)(cid:101)Z)/n be the empirical covariance. For any constant c > 0, the

is in the feasible set of the optimization problem (10) with a large probability.

following holds true,

P

(cid:40)(cid:12)(cid:12)(cid:12)Ω(cid:98)Σ − (Ip − PC)

(cid:12)(cid:12)(cid:12)∞

≥ c

(cid:114)

(cid:41)

log p

n

≤ 2p−c(cid:48)(cid:48)

,

where c(cid:48)(cid:48) = (c2Cmin)/(24e2κ4Cmax) − 2.

4.2 Asymptotic distribution and inference

To obtain the asymptotic distribution of the de-biased estimator(cid:98)βu, an additional assumption
on (cid:101)Z is required.

Condition 5 The inequality (3τ−1)δ−
φ0 > 0, where for any matrix A ∈ Rn×m, δ+
k (A) and δ−
isometry property (RIP) constants of order k deﬁned as

n)−(τ +1)δ+

2s((cid:101)Z/

√
n) ≥ 4τ φ0 holds for a constant
k (A) are the upper and lower restricted

√

2s((cid:101)Z/
(cid:26)||Aα||2
(cid:26)||Aα||2

||α||2

2

2

2

||α||2

2

δ+
k (A) = sup

δ−
k (A) = inf
√

2s((cid:101)Z/

: α ∈ Rm is k-sparse vector

: α ∈ Rm is k-sparse vector

2s((cid:101)Z/

√

(cid:27)
(cid:27)

,

.

Condition 5 means that δ−

of the CLR transformed compositional data matrix (cid:101)Z/

n) and δ+

√

n) should be close, that is, any 2s columns

n should be close to orthonormal.

The following theorem gives the asymptotic distribution of the de-biased estimates of the

regression coeﬃcients.

12

as in equation (12) in Algorithm 2. Then,

Theorem 1 Consider the linear model (5) with β as an s-sparse vector, and let (cid:98)βu be deﬁned
n((cid:102)M(cid:98)Σ − (Ip − PC))(β −(cid:98)βn).
n((cid:98)βu − β) = B + ∆, B|Z ∼ N (0, σ2(cid:102)M(cid:98)Σ(cid:102)M(cid:62)), ∆ =
Further, assume the Conditions (1)-(5) hold. Then setting λ = r˜cσ(cid:112)(log p)/n in optimization
problem (6) and γ = c(cid:112)(log p)/n in Algorithm 2, the following holds true:

√

√

P

(cid:26)
(cid:27)
(cid:113)(cid:98)Σi,i and constants c(cid:48) and c(cid:48)(cid:48) are given by

· σs log p√
n

||∆||∞ >

c˜ck0(τ k0 + 1)

φ0

≤ 2p−c(cid:48)

+ 2p−c(cid:48)(cid:48)

,

where K = maxi

c(cid:48) =

˜c2

2K 2 − 1,

c(cid:48)(cid:48) =

c2Cmin

− 2.

Theorem 1 says that N (0, σ2(cid:102)M(cid:98)Σ(cid:102)M(cid:62)) can be used to approximate the distribution of
(cid:98)βu with proper choices of c and ˜c (or equivalently γ and λ). This leads to the following

24e2κ4Cmax

corollary that can be used to construct asymptotic conﬁdence intervals and p-values for β in

high-dimensional linear model with linear constraints (4).

Corollary 1 Let(cid:98)σ be a consistent estimator of σ.
1. Deﬁne δi(α, n) = Φ−1(1 − α/2)(cid:98)σn−1/2[(cid:102)M(cid:98)Σ(cid:102)M(cid:62)]1/2
Then Ii = [(cid:98)βu

i − δi(α, n),(cid:98)βu

i,i .

i + δi(α, n)] is an asymptotic two-sided level 1 − α conﬁdence

interval for βi.

2. For individual hypothesis H0,i : βi = 0 versus H0,i : βi (cid:54)= 0, an asymptotic p-value can be

constructed as follows:

(cid:34)

Pi = 2

1 − Φ

(cid:32)

n1/2|(cid:98)βu
(cid:98)σ[(cid:102)M(cid:98)Σ(cid:102)M(cid:62)]1/2
i |

i,i

(cid:33)(cid:35)

.

The following lemma shows that with Condition 2, the diagonal elements of (cid:102)M(cid:98)Σ(cid:102)M(cid:62) are

nonzero with a γ that is not too large.

13

Lemma 2 Let(cid:102)M be the matrix obtained by equation (11). Then for γ < (1− (PC)i,i)/k0 and

all i = 1, . . . , p,

[(cid:102)M(cid:98)Σ(cid:102)M(cid:62)]i,i ≥ (1 − (PC)i,i − k0γ)2

(cid:98)Σi,i

.

4.3 Selection of the tuning parameters

In real applications, the estimator (cid:98)βn, tuning parameter λ and estimation of noise level(cid:98)σ are

obtained through scaled lasso (Sun and Zhang, 2012). Speciﬁcally, the following two steps

are iterated until convergence:

(cid:110)||Y −(cid:101)Zβ||2

2 + 2nλ0(cid:98)σ||β||1

(cid:111)

,

(cid:98)βn ← argmin
(cid:98)σ2 ← ||Y −(cid:101)Z(cid:98)β||2

C(cid:62)β=0

2/n,

√

where λ0 =

2Ln(k/p), Ln(t) = n−1/2Φ−1(1 − t), Φ−1 is the quantile function for standard

1(k/p). Then (cid:98)λ = λ0(cid:98)σ, and γ = aˆλ/ˆσ are

normal and k is the solution of k = L4

1(k/p) + 2L2

used in Algorithm 2, where a = 1/3 is used in all simulations and real data analysis in this

paper.

5 Association Between Body Mass Index and Gut Mi-

crobiome

Gut microbiome plays an important role in food digestion and nutrition absorption. Wu et al.

(2011) reported a cross-sectional study to examine the relationship between micronutrients

and gut microbiome composition, where the fecal samples of 98 healthy volunteers from the

University of Pennsylvania were collected, together with demographic data such as body mass

index, age and sex. The DNAs from the fecal samples were analyzed by 454/Roche pyrose-

quencing of 16S rRNA gene segments of the V1-V2 region. After the pyrosequences were

denoised, a total of about 900,000 16S reads were obtained with an average of 9165 reads per

14

sample and 3068 operational taxonomic units (OTUs) were obtained. These OTUs were com-

bined into 87 genera that appeared in at least one sample. Out of these 87 genera, 42 genera

have zero counts in more than 90% of the samples and were removed from our analysis. The

remaining 45 relatively common genera belong to four phyla, Actinobacteria, Bacteroidetes,

Firmicutes and Proteobacteria. Since dysbiosis of gut microbiome has been shown to be asso-

ciated with obesity (Ley et al., 2005, 2006; Turnbaugh et al., 2006), it is interesting to identify

the bacterial genera that are associated with bmi after adjusting for total fat and caloric in-

takes. In the following analysis, zero count was replaced by the maximum rounding error of

0.5, commonly used in compositional and microbiome data analysis (Aitchison, 2003; Kurtz

et al., 2015). Since the number of reads is very large, replacing zero with other very small

counts does not aﬀect our results. These read counts are then converted into compositions of

the genera or subcompositions of the genera within phylum.

5.1 Analysis of the data at the genus-level

The proposed method was ﬁrst applied to perform regression analysis with bmi as the response

and the log-transformed compositions of the 45 genera as the covariates. In addition, total fat

intake and total caloric intake were also included as the covariates in the model. The model

was ﬁt with the constraint that the sum of the coeﬃcients corresponding to the 45 genera is

zero, assuming

where(cid:80)45

45(cid:88)

g=1

E(BMI) =

βg log(Xg) + γ1Fat + γ2Calorie,

g=1 βg = 0, and log(Xg) is the logarithm of the relative abundance of the gth genus.

The goal of this analysis is to identify the bacteria genera that are associated with bmi.

Figure 1 shows the estimated regression coeﬃcients from lasso with one constraint and

their de-biased estimates together with the 95% conﬁdence intervals of the regression coeﬃ-

cients. Four genera were statistically signiﬁcant with p-value of 0.0251 for Alistipes, 0.0031 for

Clostridium, 0.0031 for Acidaminococcus, and 0.0042 for Allisonella, respectively. These four

15

genera were exactly the same genera identiﬁed using stability selection by Lin et al. (2014).

They belong to two bacterial phyla, Bacteroidetes and Firmicutes. The results indicate that

Alistipes in the Bacteroidetes phylum is negatively associated with BMI, which is consistent

with previous ﬁndings that the gut microbiota in obese mice and humans tend to have a lower

proportion of Bacteroidetes (Ley et al., 2005, 2006; Turnbaugh et al., 2006). However, for

the Firmucutes phylum, both the positively associated (Acidaminococcus and Allisonella) and

negatively associated (Clostridium) genera were observed to be associated with bmi, suggest-

ing that obesity may be associated with changes in gut microbiome composition at a lower

taxonomic level than previously thought.

Figure 1: Analysis of gut microbiome data. Lasso estimates, de-biased estimates and 95%

conﬁdence intervals of the regression coeﬃcients in the model treating the composition of 45

genera as covariates together with total fat and caloric intakes. Dashed vertical lines separate

bacterial genus into diﬀerent phyla.

16

−4−3−2−1012345Parameter Estimates  AlistipesClostridiumAcidaminococcusAllisonellafatActinobacteriaBacteroidetesFirmicutesProteobacteriaIntakeDe−biasedLASSO4(cid:88)

mg(cid:88)

g=1

s=1

E(BMI) =

βgs log(Xgs) + γ1Fat + γ2Calorie,

5.2 Subcomposition analysis

The proposed method was then applied to subcomposition analysis, where the number of

sequencing reads were converted into compositions of genera within each phylum. This creates

four subcompositions of the genera within four phyla. This analysis aims to answer the

question whether the composition of genera within a given phylum is associated with bmi,

where the log-transformed genera subcompositions are treated as predictors, together with

total fat and caloric intakes as covariates in the following model,

where(cid:80)mg

s=1 βgs = 0 for g = 1,··· , 4, and log(Xgs) is the logarithm of the relative abundance

of the sth genus of the gth phylum.

Figure 2 shows the lasso estimates, de-biased estimates, and 95% conﬁdence interval of

the coeﬃcients of the 45 genera. Four genera were statistically signiﬁcant with p-value of

0.0036 for Clostridium, 0.0056 for Acidaminococcus, 0.0116 for Allisonella, and 0.0111 for Os-

cillibactor. All four genera belong to phylum Firmicutes, indicating that the subcomposition

of the bacterial genera within Firmicutes is associated with bmi. The genus Alistipes has a

p-value of 0.0523 in this analysis, which is marginally signiﬁcant. It is interesting that the

bacterial genus Oscillibactor was identiﬁed as one of the two bacterial genera that are nega-

tively associated with bmi. Oscillibacter was observed to be increased on the resistent starch

and reduced carbohydrate weight loss diets (Walker et al., 2011) in a strictly diet-controlled

experiments in obese men, which may explain its negative association with bmi. Recent study

also identiﬁed Oscillibacter-like organisms as a potentially important gut microbe that medi-

ates high fat diet-induced gut dysfunction (Lam et al., 2012). It is possible that Oscillibacter

directly regulates components involved in the maintenance of gut barrier integrity.

Figure 3 shows the predicted bmi using leave-one-out cross-validation (LOOCV). In each

round of LOOCV, the variables were selected based on the estimated 95% conﬁdence intervals

and the prediction was performed using reﬁtted coeﬃcients of the selected bacterial genera,

17

Figure 2: Analysis of gut microbiome data. Lasso estimates, de-biased estimates and 95%

conﬁdence intervals of the regression coeﬃcients in the model treating the subcompositions of

the genera in each phylum as covariates together with total fat and caloric intakes. Dashed

vertical lines separate bacterial genus into diﬀerent phyla.

together with calorie and fat intakes. An R2 = 0.1576 was obtained between the observed

and predicted values. As a comparison, ﬁtting the model with one linear constraint at the

genus-level resulted a R2 = 0.1361 based on LOOCV, indicating some gain in prediction by

the subcompositional analysis.

6 Simulation Evaluation and Comparisons

In order to simulate the compositional covariates, a n × p matrix W of taxon counts is ﬁrst

generated with each row of W being generated from a log-normal distribution lnN (ν, Σ),
where Σij = ζ|i−j| with ζ=0.2 or 0.5 is the covariance matrix to reﬂect diﬀerent levels of

correlation between the taxa counts. Parameters νj = p/2 for j = 1, . . . , 5 and νj = 1 for

j = 6, . . . , p are set to allow some taxa to be much more abundant than others, as often

18

−4−3−2−1012345Parameter Estimates  AlistipesClostridiumOscillibacterAcidaminococcusAllisonellafatActinobacteriaBacteroidetesFirmicutesProteobacteriaIntakeDe−biasedLASSOFigure 3: Analysis of gut microbiome data. Observed and predicted bmi using LOOCV

and variables selected based on 95% conﬁdence intervals, together with total fat and caloric

intakes.

observed in real microbiome compositional data. The compositional covariate matrix Z is

obtained by normalizing the simulated taxa counts as

(cid:19)

(cid:18) wij(cid:80)p

k=1 wik

zij = log

, i = 1,··· , n, j = 1, . . . , p

. Based on these compositional covariates, the response Y is generated through Model (2)

with

β = (1,−0.8, 0.4, 0, 0,−0.6, 0, 0, 0, 0,−1.5, 0, 1.2, 0, 0, 0.3, 0, . . . , 0)

and σ = 0.5. Diﬀerent dimension/sample size combinations (p, n)=(50,100), (50,200), (50,500),

(100,100), (100,200), (100,500) are considered and the simulations are repeated 100 times for

each setting. The tuning parameters are chosen using the method described in Section 4.3.

The regression coeﬃcient β used in the simulation satisﬁes the following 8 linear constraints

10(cid:88)
30(cid:88)

j=1

16(cid:88)
32(cid:88)

j=11

20(cid:88)
40(cid:88)

j=17

23(cid:88)
p(cid:88)

j=21

βj = 0,

βj = 0,

βj = 0,

βj = 0,

βj = 0,

βj = 0,

βj = 0,

βj = 0.

(13)

j=24

j=31

j=33

i=41

19

10152025303540451015202530354045R2=0.1576BMIFitted BMI6.1 Estimation of conﬁdence intervals

The model is ﬁrst ﬁtted under the correct constraints speciﬁed in (13) and the corresponding

conﬁdence intervals are obtained based on our asymptotic results. Figure 4 shows the coverage

probability for various models and samples sizes, indicating that the coverage probabilities of

the conﬁdence intervals are close to the nominal level of 0.95 when the sample size is large. For

small sample sizes, the empirical coverage probability is slightly greater than the nominal level

of 0.95, indicating some conservativeness. Figure 5 shows the lengths of conﬁdence intervals.

As expected, larger sample sizes result in shorter lengths and larger correlations among the

variables lead to increased length of the conﬁdence intervals.

As comparisons, the model is also ﬁtted under no constraint, one single constraint,(cid:80)p

j=1 βj =

0, and misspeciﬁed constraints,

βj = 0,

j=1

j=6

5(cid:88)

12(cid:88)

23(cid:88)

j=13

30(cid:88)

j=24

βj = 0,

p(cid:88)

j=31

βj = 0,

βj = 0,

βj = 0.

The coverage probabilities and the lengths of the conﬁdence intervals are given in Figure 4

and Figure 5, respectively. While the coverage probabilities are relatively less sensitive to

such misspeciﬁcation, the intervals estimated under the correct linear constraints are much

shorter than those obtained with one or none of the linear constraints, especially when sample

size is small. Using the wrong constraints results in much longer intervals with less accurate

coverage.

6.2 Variable selection based on the conﬁdence intervals

The conﬁdence intervals of the regression coeﬃcients can also be applied to choose the variables

of interest. For example, a variable can be selected if the nominal 95% conﬁdence interval of

the corresponding regression coeﬃcient includes zero. Table 1 shows the true positive rate and

false positive rate of the variables identiﬁed based on 95% conﬁdence intervals under multiple

constraints, one single constraint and no constraint. When the sample size is small, imposing

the correct linear constraints can lead to more true discoveries while the false positive rates

20

are still controlled under 5%. In contrast, the models with only one or no constraint lead to

much lower true positive rates and the standard lasso without any constraint gives the worst

variable selection results.

6.3 Prediction evaluation

Prediction performances are also evaluated and compared for models with or without linear
constraints. The prediction error ||Y − Z ˆβ||2
2/n is computed from an independent test sample
of size n. Table 2 shows the prediction errors of the lasso estimator, reﬁtted estimator

with variables selected by lasso, and reﬁtted estimator with variables selected by the 95%

conﬁdence intervals. For each of these three estimators, model ﬁtting and coeﬃcient reﬁtting

and prediction are performed with multiple, one and no linear constraints. Overall, ﬁtting

the models with correct multiple constraints substantially decreases the prediction error. The

lasso estimator has the worst prediction performance, while the two reﬁtted estimators have

comparable prediction errors.

6.4 Simulation based on real microbiome compositional data

Another set of simulations are conducted where the gut microbiome composition data ana-

lyzed in Section 5 are used to generate the covariates with p = 45 through resampling. The

many zeros in the compositional data matrix are replaced with pseudo-count of 0.05 and are

renormalized to have unit sum. For each simulation, we resample with replacement from

the rows of compositional data matrix to achieve the required sample size. The coeﬃcients

β and noise level σ are the same as in prevision section. The sample size is chosen to be

n = 50, 100, 200 and 500. Each setting is repeated 500 times. The coverage probability and

length of conﬁdence intervals are shown in Figure 6 for model with multiple, one and no

constraints on the coeﬃcients. Similar conclusions are observed. The coverage probabilities

are relatively less sensitive to misspeciﬁcation of linear constraints, however, the intervals es-

timated under the correct linear constraints are shorter than those obtained with one or none

21

of the linear constraints, especially when sample size is small. Using the wrong constraints

results in much longer intervals with a less accurate coverage.

7 Discussion

This paper has considered the problem of regression analysis for microbiome compositional

data obtained through 16S sequencing or metagenomic sequencing. The models and methods

in this paper can be applied to identify the microbial subcompositions that are associated

with a continuous response. The idea of imposing the constraints on regression coeﬃcients

was motivated by using the log-ratios as covariates. However, the method proposed does not

use the log-ratios as covariates, it treats the logarithm of the relative abundances as covariates

and allows the response to depend on the relative abundances of certain bacteria instead of

the ratios. Imposing linear constraints on coeﬃcients enhances the interpretability and also

guarantees the subcompositional coherence. Our method allows selecting taxa in diﬀerent

higher rank taxa. By applying our subcompositional analysis, Oscillibacter genus was found

to be associated with bmi, even after total fat and caloric intakes were adjusted, indicating

that gut microbiome may serve as independent predictor for complex phenotypes such as bmi.

Our simulation studies have demonstrated a clear gain in prediction performance when true

linear constraints are imposed. However, the small sample size of our data did not allow us

to extensively evaluate gain in bmi prediction by incorporating the gut microbiome data.

An estimation procedure through regularization under linear constraints has been de-

veloped.

In order to obtain the conﬁdence interval of the regression coeﬃcients, de-biased

estimates of the regression coeﬃcients are obtained, which are shown to be approximately

normally distributed. The p optimization problems in the de-biased algorithm can be solved

eﬃciently using convex programs. For one simulated data set in Section 6, Algorithm 2 took

about 36 seconds for p = 100 and 300 seconds for p = 200 on a PC with a core of Intel i7-3770

CPU3.40GHz. For large p, convex optimization problems can be carried out in parallel. In

22

typical microbiome studies, p is less than 1,000.

The general results presented in this paper can also be used for statistical inference for the

log-contrast model considered in Lin et al. (2014). This type of de-biased estimates were also

proposed in Zhang and Zhang (2014) and Van de Geer et al. (2014). Lee et al. (2016) proposed

an exact inference procedure for lasso by characterizing the distribution of a post-selection

estimator conditioned on the selection event. It is interesting to extend their approach to the

high-dimensional regression problems with constraints. Efron (2014) developed a bootstrap

smoothing procedure for computing the standard errors and conﬁdence intervals for predic-

tions, which is diﬀerent from what was considered in this paper. Efron’s procedure can be

applied directly to make inferences on predictions using the methods developed here.

Several extensions are worth considering. Model (4) can be extended to include the in-
teraction terms of the form λlk(log xil − log xik)2, where xil and xik are the proportion of the
lth and the kth component of subject i, λlk is the coeﬃcient that corresponds to the inter-

action between these two components (Aitchison and Bacon-Shone, 1984). Similar variable

selection and inference procedure can be developed. It is also interesting to develop methods

for generalized linear models with high-dimensional compositional data as covariates.

Acknowledgments

We are grateful to the editor, the associate editor, and three anonymous referees for their

helpful comments. We thank Drs. Gary Wu, James Lews and Rick Bushman for sharing the

data and Dr. Wei Lin for helpful discussions.

References

Aitchison, J. (1982). The statistical analysis of compositional data. Journal of the Royal

Statistical Society, Series B, 47:139–177.

23

Aitchison, J. (2003). The statistical analysis of compositional data. Blackburn Press.

Aitchison, J. and Bacon-Shone, J. (1984). Log contrast models for experiments with mixtures.

Biometrika, 71:323–330.

Bertsekas, D. P. (1996). Constrained optimization and Lagrange multiplier methods. Athena

Scientiﬁc, Belmont.

B¨uhlmann, P. (2013). Statistical signiﬁcance in high-dimensional linear models. Bernoulli,

19:1212–1242.

B¨uhlmann, P. and van de Geer, S. (2011). Statistics for high-dimensional data: methods,

theory and applications. Springer, Berlin.

Cai, T. T. and Zhang, A. (2005). Compressed sensing and aﬃne rank minimization under

restricted isometry. IEEE Trans. Signal Processing, 67:301–320.

Cornell, J. (2002). Experiments with mixtures: designs, models, and the analysis of mixture

data. Wiley.

Efron, B. (2014). Estimation and accuracy after model selection. Journal of the American

Statistical Association, 109:991–1007.

Grant, M. and Boyd, S. (2013). Cvx: Matlab software for disciplined convex programming,

version 2.0 beta. Technical report, http://cvxr.com/cvx, September 2013.

Huson, D., Auch, A., Qi, J., and Schuster, S. (2007). Megan analysis of metagenomic data.

Genome Research, 17:377–386.

James, G. M., Paulson, C., and Rusmevichientong, P. (2015). Penalized and constrained

regression.

Javanmard, A. and Montanari, A. (2014). Conﬁdence intervals and hypothesis testing for

high-dimensional regression. J. Mach. Learn. Res., 15(1):2869–2909.

24

Kang, H., Zhang, A., Cai, T. T., and Small, D. S. (2014).

Instrumental variables esti-

mation with some invalid instruments and its application to mendelian randomization.

arXiv:1401.5755.

Kurtz, Z., M¨uller, C., Miraldi, E., Littman, D., Blaser, M., and Bonneau, R. (2015). Sparse

and compositionally robust inference of microbial ecological networks. PLoS Computational

Biolology, 11:e1004226.

Lam, Y., Ha, C., Campbell, C., Mitchell, A., Dinudom, A., Oscarsson, J., Cook, D., Hunt,

N., Caterson, I., Holmes, A., and Storlien, L, H. (2012). Increased gut permeability and

microbiota change associate with mesenteric fat inﬂammation and metabolic dysfunction

in diet-induced obese mice. PLoS One, 7:e34233.

Lee, J. D., Sun, D. L., Y., S., and Taylor, J. (2016). Exact post-selection inference, with

application to the lasso. The Annals of Statistics, page in press.

Ley, R. E., B¨ackhed, F., Turnbaugh, P., Lozupone, C. A., Knight, R. D., and Gordon, J. I.

(2005). Obesity alters gut microbial ecology. Proc. Nat. Acad. Sci. U.S.A., 102:11070–11075.

Ley, R. E., Turnbaugh, P. J., Klein, S., and Gordon, J. I. (2006). Human gut microbes

associated with obesity. Nature, 444:1022–1023.

Lin, W., Shi, P., Feng, R., and Li, H. (2014). Variable selection in regression with composi-

tional covariates. Biometrika, 101:785–797.

Manichanh, C., Borruel, N., Casellas, F., and Guarner, F. (2012). The gut microbiota in ibd.

Nature Reviews Gastroenterology and Hepatology, 9(10):599–608.

Qin, J., Li, R., Raes, J., Arumugam, M., Burgdorf, K. S., Manichanh, C., Nielsen, T., Pons, N.,

Levenez, F., Yamada, T., et al. (2010). A human gut microbial gene catalogue established

by metagenomic sequencing. Nature, 464(7285):59–65.

25

Qin, J., Li, Y., Cai, Z., Li, S., Zhu, J., Zhang, F., Liang, S., Zhang, W., Guan, Y., Shen, D.,

et al. (2012). A metagenome-wide association study of gut microbiota in type 2 diabetes.

Nature, 490(7418):55–60.

Segata, N., Waldron, L., Ballarini, A., Narasimhan, V., Jousson, O., and Huttenhower, C.

(2012). Metagenomic microbial community proﬁling using unique clade-speciﬁc marker

genes. Nature Methods, 9(8):811–814.

Snee, R. (1973). Techniques for the analysis of mixture data. Technometrics, 15:517–528.

Sun, T. and Zhang, C.-h. (2012). Scaled sparse linear regression. Biometrika, 99:879–898.

Turnbaugh, P. J., Ley, R. E., Hamady, M., Fraser-Liggett, C. M., Knight, R., and Gordon,

J. I. (2007). The human microbiome project. Nature, 449(7164):804–810.

Turnbaugh, P. J., Ley, R. E., Mahowald, M. A., Magrini, V., Mardis, E. R., and Gordon, J. I.

(2006). An obesity-associated gut microbiome with increased capacity for energy harvest.

Nature, 444:1027–1031.

Van de Geer, S., B¨uhlmann, P., Ritov, Y. A., and Dezeure, R. (2014). On asymptotically

optimal conﬁdence regions and tests for high-dimensional models. The Annals of Statistics,

42:1166–1202.

Walker, A., Ince, J., Duncan, S., Webster, L., Holtrop, G., Ze, X., Brown, D., Stares, M.,

Scott, P., Bergerat, A., Louis, P., McIntosh, F., Johnstone, A., Lobley, G., Parkhill, J., and

Flint, H. (2011). Dominant and diet-responsive groups of bacteria within the human colonic

microbiota. ISME Journal, 5:220–230.

Wu, G. D., Chen, J., Hoﬀmann, C., Bittinger, K., Chen, Y.-Y., Keilbaugh, S. A., Bewtra,

M., Knights, D., Walters, W. A., Knight, R., Sinha, R., Gilroy, E., Gupta, K., Baldassano,

R., Nessel, L., Li, H., Bushman, F. D., and Lewis, J. D. (2011). Linking long-term dietary

patterns with gut microbial enterotypes. Science, 334:105–108.

26

Zhang, C. H. and Zhang, S. S. (2014). Conﬁdence intervals for low dimensional parameters in

high dimensional linear models. Journal of the Royal Statistical Society: Series B (Statistical

Methodology), 76:217–242.

Appendix

We collect the proofs of the main results in this Appendix.

Deﬁnition 1 For any matrix M , deﬁne the restricted orthogonal constant (ROC) of order k1

and k2 as below

θk1,k2(M ) = sup

(cid:110)|(cid:104)M α1, M α2(cid:105)|

||α1||2||α2||2

:α1 is k1-sparse vector, α2 is k2-sparse vector,

α1 and α2 have non-overlapping support

(cid:111)

Before proving Theorem 1, we need to present Lemma 3 and Theorem 2.

Lemma 3 Suppose ||Ip − PC||∞ ≤ k0, then for any matrix A, we have

|(Ip − PC)A|∞ ≤ k0|A|∞.

Proof of Lemma 3. By deﬁnition of || · ||∞ for matrices, for any vector a ∈ Rp,

||(Ip − PC)a||∞ ≤ k0||a||∞.

(cid:3)

Theorem 2 Let(cid:98)βn be the estimator obtained by solving optimization problem (6) for Model (5),
and ||(cid:101)Z(cid:62)||∞ ≤ nλ/τ , then,

n) ≥ 4τ φ0 for some constant φ0 > 0,

where β is s-sparse. If (3τ−1)δ−

√

2s((cid:101)Z/

√
n)−(τ +1)δ+

2s((cid:101)Z/
||(cid:98)βn − β||1 ≤ sλ(k0 + 1/τ )/φ0.

27

Proof. By the deﬁnition of (cid:98)βn, we have
Denote h = (cid:98)βn − β, and Sh be the set of index of the s largest absolute values of h.
Then by Y =(cid:101)Zβ + , we have

2 + λ||(cid:98)βn||1 ≤ 1

||y −(cid:101)Z(cid:98)βn||2

||y −(cid:101)Zβ||2

2 + λ||β||1.

1
2n

2n

Notice that

(|| −(cid:101)Zh||2

1
2n

2 − ||||2

||β||1 − ||(cid:98)βn||1 = ||βsupp(β)||1 − ||(cid:98)βn
≤ ||βsupp(β) −(cid:98)βn

2) ≤ λ(||β||1 − ||(cid:98)βn||1).
supp(β)||1 − ||(cid:98)βn
supp(β)||1 − ||hsupp(β)c||1

supp(β)c||1

h

||1.

≤ ||hsupp(β)||1 − ||hsupp(β)c||1
≤ ||hSh||1 − ||hSc
((cid:101)Zh)(cid:62)(2 −(cid:101)Zh) ≥ − 1
||(cid:101)Z(cid:62)||∞(||hSh||1 + ||hSc

n

||1).

h

h(cid:62)(cid:101)Z(cid:62) ≥ − 1

||(cid:101)Z(cid:62)||∞||h||1

n

Also,

1
2n

(|| −(cid:101)Zh||2

2 − ||||2

2) = − 1
2n
= − 1
n

Then, by ||(cid:101)Z(cid:62)||∞ ≤ nλ/τ and (14), we have
−(||hSh||1 + ||hSc

h

||1) ≤ τ (||hSh||1 − ||hSc

||1).

h

Therefore,

By the KKT condition of optimization problem (6), we have

h

||hSc

||1 ≤ τ + 1
τ − 1

||hSh||1.
||(cid:101)Z(cid:62)(y −(cid:101)Z(cid:98)βn) + Cµ||∞ ≤ nλ

for some µ ∈ Rr. Then by Lemma 3,

||(cid:101)Z(cid:62)(y −(cid:101)Z(cid:98)βn)||∞ = ||(Ip − PC)((cid:101)Z(cid:62)(y −(cid:101)Z(cid:98)βn) + Cµ)||∞
≤ k0||(cid:101)Z(cid:62)(y −(cid:101)Z(cid:98)βn) + Cµ||∞ ≤ k0nλ.

28

(14)

(15)

Then

||(cid:101)Z(cid:62)(cid:101)Zh||∞ ≤ ||(cid:101)Z(cid:62)(y −(cid:101)Z(cid:98)βn)||∞ + ||(cid:101)Z(cid:62)(y −(cid:101)Zβ)||∞ ≤ k0nλ + ||(cid:101)Z(cid:62)||∞.

Using Lemma 5.1 in Cai and Zhang (2005), we can get

|(cid:104)(cid:101)ZhSh,(cid:101)ZhSc

h

(cid:105)| ≤ θs,s((cid:101)Z)||hSh||2 · max(||hSc
sθs,s((cid:101)Z)||hSh||2 · τ + 1
≤ √
θs,s((cid:101)Z)||hSh||2
≤ τ + 1
τ − 1

τ − 1
2.

√
||1/s)

s

h

||∞,||hSc
||hSh||1/s

h

Then,

(k0nλ + ||(cid:101)Z(cid:62)||∞)||hSh||1 ≥ ||(cid:101)Z(cid:62)(cid:101)Zh||∞||hSh||1 ≥ (cid:104)(cid:101)Z(cid:62)(cid:101)Zh, hSh(cid:105)
= (cid:104)(cid:101)ZhSh,(cid:101)ZhSh(cid:105) + (cid:104)(cid:101)ZhSh,(cid:101)ZhSc
≥ ||(cid:101)ZhSh||2
θs,s((cid:101)Z)||hSh||2
2 − τ + 1
2s((cid:101)Z) − τ + 1
θs,s((cid:101)Z))||hSh||2
τ − 1
(cid:18) 3τ − 1
(cid:19)
τ − 1
2s((cid:101)Z)
2s((cid:101)Z) − τ + 1
δ−

≥ (δ−
≥

δ+

(cid:105)

2

2

h

2(τ − 1)

k1+k2

(δ+

(A) − δ−

2(τ − 1)
The last inequality comes from θk1,k2(A) ≤ 1
2
k0nλ + ||(cid:101)Z(cid:62)||∞
Lemma 1 of Kang et al. (2014). The inequality above gives us
2s((cid:101)Z/
Therefore, by ||(cid:101)Z(cid:62)||∞ ≤ nλ/τ and (15), we have
||(cid:98)βn − β||1 = ||hSh||1 + ||hSc

√
n) − (τ + 1)δ+

||hSh||1 ≤ s

2s((cid:101)Z/

(3τ − 1)δ−

2(τ − 1)

(cid:16)

n

||1 ≤ 2τ
τ − 1

h

||hSh||2

1/s.

(A)) for any matrix A from

k1+k2

(cid:17) = s

k0nλ + ||(cid:101)Z(cid:62)||∞

2nτ φ0/(τ − 1)

.

√

n)

||hSh||1 ≤ sλ(k0 + 1/τ )/φ0.

(cid:3)

Proof of Theorem 1.

(cid:98)βu − β = (cid:98)βn − β +

1
n

(cid:102)M(cid:101)Z(cid:62) +

(cid:102)M(cid:101)Z(cid:62)(cid:101)Z(β −(cid:98)βn)
(cid:102)M(cid:101)Z(cid:62) + ((cid:102)M(cid:98)Σ − Ip)(β −(cid:98)βn)
(cid:102)M(cid:101)Z(cid:62) + ((cid:102)M(cid:98)Σ − Ip + PC)(β −(cid:98)βn),

1
n

=

=

1
n
1
n

29

since C(cid:62)β = C(cid:62)(cid:98)βn = 0.

√

(cid:16)

Thus,

1√
n

B|Z ∼ N

n((cid:98)βu − β) = B + ∆ where B =

(cid:102)M(cid:101)Z(cid:62).
n(cid:102)M(cid:101)Z(cid:62) = 1√
n(cid:102)M(Ip − PC)Z(cid:62). Thus,
Notice that (Ip − PC)(cid:98)Σ(Ip − PC) =(cid:98)Σ, and B = 1√
0, σ2(cid:102)M(Ip − PC)(cid:98)Σ(Ip − PC)(cid:102)M(cid:62)(cid:17)
= N (0, σ2(cid:102)M(cid:98)Σ(cid:102)M(cid:62)).
(cid:12)(cid:12)(cid:12)∞
(cid:12)(cid:12)(cid:12)(cid:102)M(cid:98)Σ − (Ip − PC)
||β −(cid:98)βn||1
(cid:12)(cid:12)(cid:12)(Ip − PC)
(cid:17)(cid:12)(cid:12)(cid:12)∞
(cid:16)
M(cid:98)Σ − (Ip − PC)
(cid:12)(cid:12)(cid:12)M(cid:98)Σ − (Ip − PC)
(cid:12)(cid:12)(cid:12)∞
||β −(cid:98)βn||1.

||∆||∞ ≤ √
√

||β −(cid:98)βn||1

=
n
√
≤ k0

n

n

The last inequality is by Lemma 3.

By Lemma 1, when choosing γ = c(cid:112)(log p)/n, Ω is a feasible solution of the optimization
c(cid:112)(log p)/n with probability at least 1 − 2pc(cid:48)(cid:48)
By Theorem 2, take λ = τ ˜cσ(cid:112)(log p)/n,

problem (10) with probability at least 1 − 2p−c(cid:48)(cid:48)

(cid:12)(cid:12)(cid:12)M(cid:98)Σ − (Ip − PC)

. Therefore,

≤ γ =

(cid:12)(cid:12)(cid:12)∞

.

P(||(cid:98)βn − β||1 ≤ (k0 + 1/τ )λs/φ0) ≥ 1 − P(||(cid:101)Z(cid:62)||∞ > nλ/τ )
P(|((cid:101)Z(cid:62)ε)i| > nλ/τ )
(cid:27)
(cid:26)

≥ 1 − p(cid:88)

i=1

≥ 1 − 2p exp

−1
2

(nλ/τ )2
n(σK)2

= 1 − 2p1−˜c2/(2K2) = 1 − 2p−c(cid:48)

.

Altogether, we have

P

(cid:27)

c˜ck0(k0τ + 1)

||∆||∞ >

(cid:26)
≤ P(cid:110)||(cid:98)βn − β||1 ≤ sλ(k0 + 1/τ )/φ0 = ˜c(k0τ + 1)sσ(cid:112)(log p)/n/φ0
+ P(cid:110)(cid:12)(cid:12)(cid:12)M(cid:98)Σ − (Ip − PC)
(cid:12)(cid:12)(cid:12)∞

(cid:111)
≤ γ = c(cid:112)(log p)/n

sσ log p√
n

φ0

(cid:111)

≤ 2p−c(cid:48)

+ 2p−c(cid:48)(cid:48)

(cid:3)

.

30

Proof of Lemma 1. Note that Σ1/2Ω1/2(cid:101)Zl = (Ip − PC)(cid:101)Zl = (cid:101)Zl. Therefore,
(cid:111)
l Ω1/2Σ1/2 − (Ip − PC)

Ω(cid:101)Zl(cid:101)Z(cid:62)
Ω1/2Ω1/2(cid:101)Zl(cid:101)Z(cid:62)

(cid:111)
l − (Ip − PC)

Ω(cid:98)Σ − (Ip − PC) =

n(cid:88)
n(cid:88)

(cid:110)
(cid:110)

1
n

=

l=1

.

1
n

i,· Ω1/2(cid:101)Zl(cid:101)Z(cid:62)

l Ω1/2Σ1/2·,j − (Ip− PC)i,j. Since EΩ(cid:101)Zl(cid:101)Z(cid:62)

l=1

l = Ω1/2

Deﬁne v(ij)
Ev(ij)

l = 0. Then, by the proof of Lemma 6.2 in Javanmard and Montanari (2014),

l = ΩΣ = (Ip− PC), we have

||v(ij)

l

||ψ1 ≤ 2||Ω1/2
≤ 2||Ω1/2
≤ 2||Ω1/2

i,· Ω1/2(cid:101)Zl(cid:101)Z(cid:62)
i,· Ω1/2(cid:101)Zl||ψ2||Σ1/2
≤ 2(cid:112)σmax(Σ)σmax(Ω)κ2
i,· ||2||Σ1/2
≤ 2(cid:112)Cmax/Cminκ2 ≡ κ(cid:48),

l Ω1/2Σ1/2·,j ||ψ1
j,· Ω1/2(cid:101)Zl||ψ2
j,· ||2||Ω1/2(cid:101)Zl||ψ2||Ω1/2(cid:101)Zl||ψ2

where ||X||ψ1 is the sub-exponential norm of a random variable X and is deﬁned as

||X||ψ1 = sup
p≥1

p−1(E|X|p)1/p.

Applying Bernstein-type inequality for centered sub-exponential random variables (B¨uhlmann

and van de Geer, 2011), we get

(cid:104)−n
Take γ = c(cid:112)(log p)/n with c ≤ eκ(cid:48)(cid:112)n/ log p, we have

≤ 2 exp

v(ij)
l

1
n

P

6

(cid:16)

min

(

γ
eκ(cid:48) )2,

γ
eκ(cid:48)

(cid:17)(cid:105)

.

≤ 2p−c2/(6e2κ(cid:48)2) = 2p−(c2Cmin)/(24e2κ4Cmax).

≤ 2p−(c2Cmin)/(24e2κ4Cmax)+2.

(cid:114)

≥ c

(cid:41)

log p

n

31

(cid:40)

P

1
n

(cid:41)

(cid:41)

l=1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) n(cid:88)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≥ γ
(cid:40)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≥ c
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) n(cid:88)
(cid:114)
(cid:40)(cid:12)(cid:12)(cid:12)Ω(cid:98)Σ − (Ip − PC)

(cid:12)(cid:12)(cid:12)∞

v(ij)
l

log p

l=1

n

P

(cid:3)

Therefore, by union bounding over all pairs of i and j,

≤ k0

we have 1 − PCi,i − e(cid:62)

Proof of Lemma 2. Suppose(cid:102)M = ((cid:101)m1, . . . ,(cid:101)mp)(cid:62). Since
(cid:12)(cid:12)(cid:12)M(cid:98)Σ − (Ip − PC)
(cid:12)(cid:12)(cid:12)∞
(cid:12)(cid:12)(cid:12)max
(cid:12)(cid:12)(cid:12)(cid:102)M(cid:98)Σ − (Ip − PC)
i (cid:98)Σ(cid:101)mi ≤ k0γ. Therefore, for all L ≥ 0,
i (cid:98)Σ(cid:101)mi ≥ (cid:101)m(cid:62)
i (cid:98)Σ(cid:101)mi + L(1 − PCi,i − k0γ) − Le(cid:62)
i (cid:98)Σ(cid:101)mi
(cid:101)m(cid:62)
(cid:110)
m(cid:62)(cid:98)Σm + L(1 − PCi,i − k0γ) − Le(cid:62)
i (cid:98)Σm
(cid:26)

≥ min
= L(1 − PCi,i − k0γ) − L2
4
≥ min
L≥0
≥ (1 − PCi,i − k0γ)2

L(1 − PCi,i − k0γ) − L2
4

(The minimizer m = Lei/2)

(cid:27)

(cid:98)Σi,i
(take L = 2(1 − PCi,i − k0γ)/(cid:98)Σi,i).

(cid:98)Σi,i

≤ k0γ,

(cid:111)

m

(cid:98)Σi,i

(cid:3)

32

Figure 4: Coverage probabilities of conﬁdence intervals based on 100 replications. For each

model, minimum, median (in red line), mean (in red dot) and maximum of the coverage

probabilities over compositional covariates are shown. The boxes labeled with ’c’ are obtained

using the constraints, and the boxes labeled with ’u’ are obtained without using constraints.

33

0.70.80.91MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongCoverage Probabilityn=50n=100n=200n=500ζ=0.2, p=500.70.80.91MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongCoverage Probabilityn=50n=100n=200n=500ζ=0.2, p=1000.70.80.91MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongCoverage Probabilityn=50n=100n=200n=500ζ=0.5, p=500.70.80.91MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongCoverage Probabilityn=50n=100n=200n=500ζ=0.5, p=100Figure 5: Average lengths of conﬁdence intervals based on 100 replications. For each model,

minimum, median (in red line), mean (in red dot) and maximum of the lengths of the intervals

overall all compositional covariates are shown. The boxes labeled with ’c’ are obtained using

the constraints, and the boxes labeled with ’u’ are obtained without using constraints.

34

00.511.5MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongLength of CIn=50n=100n=200n=500ζ=0.2, p=5000.511.5MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongLength of CIn=50n=100n=200n=500ζ=0.2, p=10000.511.5MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongLength of CIn=50n=100n=200n=500ζ=0.5, p=5000.511.5MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongLength of CIn=50n=100n=200n=500ζ=0.5, p=100Table 1: True/False positive rates of the signiﬁcant variables selected based on 95% conﬁdence

intervals with multiple, one and no linear constraints. Variable correlations ζ, numbers of

variables p and sample sizes (n) are considered.

Conﬁguration

True Positive Rate

False Positive Rate

Constraints

Constraints

ζ

p

n Multi

One

No

Multi

One

No

50

0.9329

0.8514

0.7586

0.0121

0.0056

0.0051

0.2

50

100

1.0000

1.0000

0.9957

0.0330

0.0286

0.0267

200

1.0000

1.0000

1.0000

0.0386

0.0333

0.0328

500

1.0000

1.0000

1.0000

0.0498

0.0477

0.0470

50

0.8571

0.8071

0.7700

0.0131

0.0166

0.0139

0.2

100

100

1.0000

0.9857

0.9400

0.0265

0.0218

0.0173

200

1.0000

1.0000

1.0000

0.0374

0.0353

0.0333

500

1.0000

1.0000

1.0000

0.0441

0.0428

0.0406

50

0.8500

0.7486

0.6543

0.0095

0.0030

0.0019

0.5

50

100

0.9971

0.9900

0.9871

0.0281

0.0240

0.0223

200

1.0000

1.0000

1.0000

0.0351

0.0309

0.0305

500

1.0000

1.0000

1.0000

0.0474

0.0437

0.0412

50

0.7643

0.7157

0.6443

0.0168

0.0173

0.0118

0.5

100

100

0.9814

0.9300

0.8500

0.0227

0.0137

0.0145

200

1.0000

1.0000

1.0000

0.0359

0.0320

0.0319

500

1.0000

1.0000

1.0000

0.0444

0.0417

0.0409

35

Table 2: Testing set prediction error of the lasso estimator, reﬁtted estimator with variables

selected by by lasso, and reﬁtted estimator with variables selected based on 95% conﬁdence

intervals. For each estimator, model was ﬁt using multiple, one and no linear constraints.

Variable correlations ζ, numbers of variables p and sample sizes (n) are considered.

Conﬁguration

lasso Estimator

Selection by lasso Selection by 95% CI

Reﬁtted with

Reﬁtted with

Constraints

Constraints

Constraints

ζ

p

n Multi One

No Multi One

No Multi One

No

0.2

50

0.2 100

0.5

50

0.5 100

50

0.687 0.926 0.983 0.360 0.502 1.336 0.370 0.487 1.375

100 0.360 0.391 0.412 0.300 0.309 1.153 0.284 0.296 1.155

200 0.293 0.302 0.307 0.271 0.273 1.039 0.264 0.269 1.054

500 0.265 0.269 0.270 0.259 0.261 1.025 0.255 0.258 1.034

50

1.027 1.429 1.438 0.484 0.776 1.531 0.496 0.602 1.483

100 0.408 0.467 0.491 0.305 0.315 1.164 0.286 0.322 1.300

200 0.303 0.318 0.322 0.273 0.276 1.066 0.268 0.277 1.076

500 0.269 0.274 0.274 0.263 0.264 1.041 0.260 0.264 1.049

50

0.806 1.095 1.210 0.520 0.687 1.179 0.441 0.557 1.278

100 0.400 0.476 0.454 0.300 0.319 0.959 0.283 0.301 0.963

200 0.305 0.325 0.320 0.270 0.272 0.861 0.263 0.267 0.877

500 0.269 0.276 0.274 0.258 0.260 0.847 0.255 0.257 0.862

50

1.069 1.494 1.731 0.668 0.993 1.416 0.606 0.690 1.361

100 0.476 0.604 0.560 0.322 0.366 0.963 0.293 0.342 1.134

200 0.323 0.358 0.342 0.271 0.273 0.884 0.265 0.270 0.896

500 0.274 0.284 0.279 0.262 0.262 0.863 0.258 0.261 0.876

36

Figure 6: Coverage probabilities and length of conﬁdence intervals based on 500 replications.

Data are simulated by resampling the gut microbiome composition data in Section 5.

37

0.70.750.80.850.90.951MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongCoverage Probabilityn=50n=100n=200n=50000.511.5MultiOneNoWrongMultiOneNoWrongMultiOneNoWrongMultiOneNoWrongLength of CIn=50n=100n=200n=500