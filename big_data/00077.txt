6
1
0
2

 

 

b
e
F
9
2
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
7
7
0
0
0

.

3
0
6
1
:
v
i
X
r
a

TOPOLOGICALLY DISTINCT SETS OF NON-INTERSECTING

CIRCLES IN THE PLANE

RICHARD J. MATHAR

Abstract. Nested parentheses are forms in an algebra which deﬁne orders
of evaluations. A class of well-formed sets of associated opening and closing
parentheses is well studied in conjunction with Dyck paths and Catalan num-
bers. Nested parentheses also represent cuts through circles on a line. These
become topologies of non-intersecting circles in the plane if the underlying
algebra is commutative.

This paper generalizes the concept and answers quantitatively—as recur-
rences and generating functions of matching rooted forests—the questions:
how many diﬀerent topologies of nested circles exist in the plane if (i) pairs of
circles may intersect, or (ii) even triples of circles may intersect. That analysis
is driven by examining the symmetry properties of the inner regions of the
fundamental type(s) of the intersecting pairs and triples.

1. Paired Parentheses and Catalan Numbers

In a (non-commutative) algebra, opening and closing parentheses prescribe the

order of grouping and evaluating expressions.

Deﬁnition 1. A string of parentheses is well-formed if the total number of opening
parentheses equals the number of closing parentheses, and if the subtotal count of
opening parentheses is always larger than or equal to the subtotal count of closing
parentheses while parsing the string left-to-right.

Remark 1. Equivalently one may demand that the subtotal of closing parentheses
is always larger or equal to the subtotal of opening parentheses while parsing the
string right-to-left.

The well-formed nested parentheses form sets PN of expressions with N pairs of

parentheses.

Deﬁnition 2. PN is the set of all well-formed expressions with N pairs of paren-
theses.

There are expressions that can be factored —in the algebra—by cutting the string
at some places such that the left and right substrings are also well-formed. The
number f of their factors puts the elements of PN into disjoint subsets:

Deﬁnition 3. P(f )
theses and 1 ≤ f ≤ N factors.

N is the set of all well-formed expressions with N pairs of paren-

Date: March 2, 2016.
2010 Mathematics Subject Classiﬁcation. Primary 05A15, 05B40; Secondary 52C45.
Key words and phrases. Combinatorics, circles, parentheses, nesting, intersection, plane.

1

2

RICHARD J. MATHAR

2

5

6

3

4

7

8 9

N |PN |
1
1
2
2
5
3
14
4
42
5
132
6
7
429
8
1430
9
4862 1430 1430 1001 572 275 110 35 8 1

1
1
3
4
9
14
28
90
48
297 165

1
1
1
2
5
14
42
132
429

1
2
5
14
42
132
429

1
5
20
75

1
6
27

1
7

1

Table 1. Catalan triangle: The number of nested expressions
with N pairs of parentheses: the total count |P| and the number
of nested expressions with 1 ≤ f ≤ N factors, |P(f )|.

(1)

(2)

Example 1.

(3)

(4)

(5)

(6)

(7)

(8)

(9)

PN = [f

P(f )
N ;

|PN | =

N

Xf =1

|P(f )
N |.

P1 = P(1)
P(1)

= {(())};

2

1 = {()};

P(2)

2

P(1)

3

P(2)

3

P(3)

3

P(1)

4

= {()()};

= {((())), (()())};

= {(())(), ()(())};

= {()()()};

= {(((()))), ((()())), ((())()), (()(())), (()()())};

Remark 2. The opening and closing parentheses are the two letters in an alphabet
of words, with a grammar that recursively admits words

(1) that are the empty word,
(2) that are concatenations of two words,
(3) that are concatenations of the ﬁrst letter, a word, and the second letter.

If the opening parentheses are replaced by U and the closing parentheses replaced
by D an equivalence with Dyck paths arises; the number of returns to the horizontal
line in the paths is equivalent to the number of factors in the expression. This leads
immediately to the well-known Catalan triangle [11, A033184] of Table 1. The set
sizes |PN | are the Catalan numbers [3, §1.15][11, A000108][4].

Remark 3. Because an expression distributes N left parenthesis at 2N places, the

them must be placed at the leftmost place and none can be placed at the rightmost

set size is limited by |PN | < (cid:0)2N
place, which leaves 2N − 2 places to distribute N − 1 of them: |PN | < (cid:0)2N −2
N −1(cid:1).

N (cid:1), the central binomial coeﬃcients. Actually one of

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

3

Remark 4. A representation in numerical computations uses the two binary digits
1 and 0 to represent the opening and the closing parenthesis in the aforementioned
alphabet of two letters [11, A063171,A014486]. (Then the most-signiﬁcant bit is
always 1. The swapped mapping is less useful because it needs to deal with the
numerical representation of leading zeros in the binary number.) Because the right-
most part is absent for the unique case of missing parentheses, N = 0, or a closing
parenthesis, all these representations are even numbers. This representation by
non-negative integers induces a strict ordering in the set of nested parentheses [11,
A063171,A014486].

Example 2. () = 10 2; ()() = 1010 2; (()) = 1100 2; ()()() = 101010 2 ; ()(()) =
101100 2 ; (())() = 110010 2 ; (()()) = 110100 2 ; ((())) = 111000 2.

The number of expressions with one factor is given by observing that they are
constructed from any expression with one pair less by embracing the entire expres-
sion at the left and right end with a pair of matching parentheses:

(10)

|P(1)

N | = |PN −1|.

The number of expressions with f factors is given by considering any concate-

nated “word” of factorizations [6],

(11)

|P(f )

N | =

X

C(N ):N =N1+N2+···+Nf

|P(1)
N1

||P(1)
N2

| · · · |P(1)
Nf

|,

f ≥ 2,

where the sum is over all compositions (“ordered” partitions) of N into positive
parts Nj such that subexpressions do not factor any further.

A well-formed expression of parentheses represents a set of N nested circles if we
join the upper and lower end of each associated pair of parentheses. The radii of
the circles are growing functions of their spatial distance in the expressions; their
mid points are on a straight line, and no perimeters of any pair of circles intersect.
The string of opening and closing parentheses is a record of entering or leaving a
circle while poking from the outside along the line through all circles. For each pair
of circles (i) either the smaller one is entirely immersed in the larger one or (ii) they
have no common points.

2. Nonintersecting Circle Sets in the Plane

2.1. Nested Circle Sets. If the algebra of Section 1 is replaced by a commutative
algebra, some sets of nested parentheses are no longer considered distinct, because
the order of the factors does no longer matter.

Deﬁnition 4. CN is the set of well-formed expressions of N pairs of parentheses
where the order within factorizations does not matter.

Deﬁnition 5. C(f )
with f factors where the order within factorizations does not matter.

N is the set of well-formed expressions of N pairs of parentheses

Example 3. (()())() 7→

✬✩♠
♠ ♠✫✪

4

RICHARD J. MATHAR

The number of factors still is a unique parameter of each well-formed set of

expressions, so

(12)

(13)

CN = [f

C(f )
N ;

|CN | =

N

Xf =1

|C(f )
N |;

|C0| = 1.

We “lose” some of the sets of parenthesis relative to Section 1, because for example
now the expressions ()(()) and (())() are considered the same: |CN | ≤ |PN |. This
reduction in the admitted expressions applies recursively to all sub-expressions that
are obtained by “peeling” the surrounding pair of parentheses oﬀ expressions with
a single factor.

Remark 5. The reduction of equivalent expressions to a single representation re-
quires some convention of which ordering of the factors is the admitted one. One
convention is to map each factor to an integer with the representation of Remark
4, to put these factors into non-increasing or non-decreasing numerical order, and
to concatenate their binary representations left-to-right to form the single represen-
tative.

Example 4.

(14)

(15)

(16)

(17)

(18)

(19)

(20)

C1 = C(1)
C(1)

= {(())};

2

1 = {()};

C(2)

2

C(1)

3

= {()()};

= {((())), (()())};

C(2)

3
(3)
3
(1)
4

C

C

= {(())()};

= {()()()};

= {(((()))), ((()())), ((())()), (()()())};

The table of the C(f )
The consideration leading to Equation (10) leads also to

N and their sums |CN | is shown in Table 2.

(21)

|C(1)

N | = |CN −1|.

The decomposition of an expression with f factors needs to consider the number of
ways of distributing the N pairs of parentheses over elements that do not factorize
f } = Pf
further. We partition N as π(N ) : N = {N c1
j=1 cjNj mean-
ing that the expression contains c1 factors with elements of C(1)
1 , c2 factors with
elements of C(1)
2 , and so on. For each part Nj with repetition cj we compute the
number of lists of cj elements taken from a set of |C(1)
|, possibly selecting some
Nj
elements more than once or not at all. This is the number of weak compositions of
cj into C(1)
parts of non-negative integers. This equals the number of compositions
Nj

2 ; . . . N cf

1 ; N c2

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

5

10 11

5

6

7

4

3

2

8 9

1
1
1
2
4
9
20
48
115
286
719

N |CN |
1
1
1
2
2
1
4
3
3
9
4
6
20
5
16
48
6
37
115
7
8
1
96
286
1 1
239
9
719
3 1
1842
622
10
11
7 3
4766 1842 1607
12 12486 4766 4235 2095 858 327 127 47 19 7

1
1
1
1
1
3
1
3
7
3
7
18
7
19
44
19
46
117
299 124
47
793 320 126

1
1
1
1
3
3
7
19
7
47 19

1
1
3

Table 2. The counts |CN | and |C
circles [11, A033185,A000081].

1
1
(f )
N | of nested nonintersecting

1

of cj + |C(1)
Nj
(22)

| into |C(1)
Nj

| parts of positive integers, which is (cid:0)cj+|C(1)

Nj
cj

|−1

(cid:1) [12, §1.2].

|C(f )

N | =

X

π(N ):N ={N c1

1 ;N c2

2 ;...N

(cid:18)|C(1)

N1

cf
f }

c1

| + c1 − 1

(cid:19)(cid:18)|C(1)

N2

c2

| + c2 − 1

(cid:19) · · ·(cid:18)|C(1)

Nf

| + cf − 1

cf

(cid:19).

Table 2 shows the phenomenon that at large N the values at large f converge

to the sequence
|C(N −i)

(23)

N

| = 1, 1, 3, 7, 19, 47, 127, 330, 889, 2378, . . .,

i ≥ 0, N → ∞,

the envelope as Knopfmacher and Mays call it [7]. This is the Euler transform of
|CN | [1] and means that if the number of factors is large, most of the factors are
the element C1(1) = {()} and only few combinations remain to exhaust the others.
Returning to the interpretation of PN as non-intersecting circles on a line, consid-
ering the order of factorizations unimportant means that CN contains topologically
distinct sets of non-intersecting circles that are free to move away from the line—as
long as they stay within the boundaries of their surrounding circles. The two circles
inside the bigger circle in Example 3 are allowed to bump around within the bigger
circle, and the big and the outer small circle may also move to other places.

Remark 6. This is a planetary model of the circles in the sense that each circle
can “rotate” around the center of its surrounding circle, and all these geometries
are considered equivalent.

Deﬁnition 6. The generating function for the number of nested expressions in the
commutative algebra is

(24)

C(z) = XN ≥0

|CN |zN .

It satisﬁes [5, I.5.2][10, 2]

(25)

C(z) = exp
Xj≥1

zjC(zj)/j
 .

6

RICHARD J. MATHAR

|2CN |
2
7
26
107
458
2058
9498

1
2
4
14
52
214
916
4116

N
1
2
3
4
5
6
7
8
9

2

3

4

5

6

7

8

9

3
8
38
160
741
3416
44947 18996 16270
216598 89894 78408 34036 10576 2812 672 158 32 10

6
7
20
110
24
544 134

4
12
62
288
1408
6856

5
16
86
416
2110

8
28

9

Table 3. The counts |2CN | and |2C(f )
circles and squares [11, A000151,A038055].

N | of nested nonintersecting

2.2. Nested Sets of Circles and Squares. If the geometric ﬁgures have k types
of shapes— for example circles and squares with k = 2—the methods of circum-
scribing and placing side by side generalize the rules. There are k diﬀerent ways
of forming a single compound object from a set of objects with one element less
because there are k options for the outermost shape. An upper-left index k tells
how many shapes are available. (21) and (22) become

(26)

(27)

|kC(f )

N | =

|kC(1)

N | = k|kCN −1|,

X

π(N ):N ={N c1

1 ;N c2

2 ;...N

f

Yj=1

cf
f }

(cid:18)|kC(1)

Nj

| + cj − 1
cj

(cid:19).

The implicit equation of the generating function for the total number of topologies
in the plane is [8]

(28)

kC(z) = exp

kXj≥1

zj kC(zj)/j
 .

Example 5. For k = 2, |2C2| = 7 conﬁgurations exist: a circle inside a circle, a
circle inside a square, a square inside a circle, a square inside a square, two disjoint
circles, two disjoint squares, or a separated square and circle.

The case with k = 2 shapes is further illustrated in Table 3, the case with k = 3

shapes in Table 4. The values on the diagonals are

(29)

|kC(N −1)

N

| = (cid:18)N + k − 1
k − 1 (cid:19).

Row sums |kCN | are Euler transforms of the columns |kC(1)
N |.

3. Topologically Distinct Circle Sets, One Circle Marked

3.1. Base-4 Notation. In Section 2 the circles are moving without intersecting
and qualitatively equal. We move on to the combinatorics of circle sets where one
of them is marked (for example by a unique color, by morphing it into an ellipse or
replacing it by a square). The equivalent modiﬁcation in the commutative algebra is
to introduce another symbol, a pair of brackets [], to locate the modiﬁed evaluation

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

7

N
1
2
3
4
5
6
7
8
9

2

3

4

5

6

7

8

9

|3CN |
3
15
82
495
3144
20875
142773
1000131
7136812 3000393 2638332 1104702 309510 68400 12891 2205 324 55

1
3
9
45
246
1485
9432
62625
428319

6
27
180
1143
7704
52731
369969

10
54
405
2856
20682
150282

15
90
720
5385
40914

21
135
1125
8730

28
189
1620

36
252

45

Table 4. The counts |3CN | and |3C(f )
circles, squares and triangles [11, A006964,A038059].

N | of nested nonintersecting

of a subexpression. Factorization is deﬁned as before, and the marked circle is not
intersecting with any of the other circles as before.

Deﬁnition 7. M(f )
marked.

N is the set of N circles with f factors, one of these circles

(30)

(31)

Example 6.

MN =

|MN | =

N

[f =1

N

Xf =1

M(f )
N ;

|M(f )
N |;

|M0| = 1.

M1 = M(1)
M(1)

= {[()], ([])};

1 = {[]};

(32)

(33)

(34)

(35)

(36)

(37)

(38)

(39)

M(2)

2

2
(1)
3
(2)
3

M

M

M(3)

3

M(1)

4

M(2)

4

= {[]()};

= {(([])), ([()]), ([]()), [()()], [(())]};

= {([])(), [()](), [](())};

= {[]()()};

= {((())[]), ((([]))), (([()])), (([])()), (([]())), ([()()]),

([()]()), ([(())]), ([]()()), [()()()], [(())()], [(()())], [((()))]};

= {(()())[], ((()))[], (([]))(), ([()])(), ([])(()),

([]())(), [()()](), [()](()), [(())]()};

3.2. Recurrences. An overview of how many distinct arrangements exist is given
in Table 5. The set of M(1)
N is created by either (i) wrapping an expression without
a marked sphere into a bracket, or by (ii) wrapping an expression that already
contains a marked sphere into a pair of parentheses:

(40)

|M

(1)
N | = |CN −1| + |MN −1|.

8

RICHARD J. MATHAR

5

6

7

8

9 10 11

4

3

2

N |MN |
1
1
3
2
9
3
26
4
75
5
214
6
612
7
8
1747
1
9
4995
10 14294
3
11 40967 16136 14294 6737 2506 864 289 96 31 10

1
1
3
3
9
10
26
30
75
91
214
268
612
790
1747
4995 2308

1
1
3
3
10
10
31
31
95
96
284
848 288

1
1
3
1
10
3
3
31 10
96 31 10

1
1
2
5
13
35
95
262
727
2033
5714

1
3
Table 5. The number of nonintersecting circles with one of them
N | the entries with f
marked.
factors [11, A000243,A000107].

|MN | are the row sums and |M(f )

1

For expressions with f ≥ 2 factors we may always move the factor with the
bracket to some pivotal (say the leftmost) factor because the order of factors does
not matter in Sections 2 and 3. That pivotal factor needs, say, N ′ pairs of paren-
theses (including the marked), and all the other factors may be varied as a set of
the C type:

(41)

|M(f )

N | =

N −1

XN ′=1

|M(1)

N ′ | |C(f −1)

N −N ′|,

f ≥ 2.

Deﬁnition 8. The generating function of the topologies of non-intersecting circles
with one marked is

(42)

M (z) = XN ≥0

|MN |zN .

If we sum on both sides of (41) over f , insert (13) for the sum over the C and
N ′ on the right hand side, Jovovic’s relation shows up [11,

(40) to eliminate the M(1)
A000243]

(43)

M (z) = 1 +

zC2(z)

1 − zC(z)

.

For suﬃciently large N the count with N − 1 factors is |M(N −1)

| = 3 because the

N

set contains the expressions of the form [()]()() · · · , ([])()() · · · , and [](())()() · · · .

3.3. Inner Void Circle. There is a subset of expressions M(v)
N ⊆ MN —indicated
with an upper v like void —where the bracket does not contain any subexpression
with parentheses, i.e., where the marked circle does not circumscribe any other
circle.

Deﬁnition 9. M(f,v)
circles is marked and does not contain other circles.

N

is the set of N circles with f factors, where one of these

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

9

5

6

7

8

9

10 11

4

3

2

1
2
5
13
35
95
262
727

N |M(v)
N |
1
1
2
2
5
3
13
4
35
5
95
6
262
7
727
8
1
9
2033
10
2
5714
16136
11
6
45733 16136 16136 8344 3299 1184 415 143 50 17
12

1
1
2
2
6
6
16
17
46
49
128
139
364
2033 1029
401
5714 2930 1147

1
1
2
2
6
6
17
17
50
142
50
412 143

1
1
1
2
5
13
35
95
262
727
2033
5714

1
2
6
Table 6. The number of nonintersecting circles, one marked.
|M(v)

N | for N, f ≥ 1 [11, A000107].

N | and |M(f,v)

1
2
6
17
50

1
2
6
17

1
2

1

(44)

(45)

M(v)

N =

|M

(v)
N | =

N

[f =1

N

Xf =1

M(f,v)

N ⊆ M(f )
N ;

|M

(f,v)
N |.

Example 7. Removing in Example 6 the expressions where the bracket pair em-
braces other parentheses yields:

(46)

(47)

(48)

(49)

(50)

(51)

(52)

(53)

M(v)

1

= M(1,v)

1

= {[]};

M

M

(1,v)
2
(2,v)
2

M(1,v)

3

M(2,v)

3

M(3,v)

3

M(1,v)

4

M(2,v)

4

= {([])};

= {[]()};

= {(([])), ([]()), };

= {([])(), [](())};

= {[]()()};

= {((())[]), ((([]))), (([])()), (([]())), ([]()()), };

= {(()())[], ((()))[], (([]))(), ([])(()), ([]())()}.

The topologies with that scenario are counted in Table 6. With the same ar-
gument as in Equation (41), scenarios with an empty bracket need to locate the
bracket at some ﬁxed factor, and let the other factors generate all possible diagrams
with the remaining parentheses:

(54)

|M(f,v)

N | =

N −1

XN ′=1

|M(1,v)

N ′

| |C(f −1)

N −N ′|.

On the diagonals of Tables 5 and 6 we ﬁnd

(55)

|M

(N )
N | = |M

(N,v)
N

| = 1,

10

RICHARD J. MATHAR

because the only expressions with as many factors as circles is the product of
singletons, M(N )

= {[]()() · · · ()}.

N = M(N,v)

N

The number in column M(1)

N in Table 6 duplicates the total of the previous row:

(56)

|M(1,v)

N | = |M(v)

N −1|.

This is easily understood because each element of the set M(1)v
rounding the expression of an element of the set M(v)
parentheses, so the “void” within the bracket is conserved.

N is created by sur-
N −1 by a pair of (non-marked)

In a similar manner |M(1,v)

N | is understood by “peeling oﬀ” the outer-
most pair of parentheses of the element of M(1,v)
and placing it as an extra factor
() aside from the peeled expression. This association works because the outermost
pair of parentheses is never the bracket.

N | = |M(2,v)

N

In summary, all entries of Table 5 and 6 can be recursively generated from Table

2 with the aforementioned 4 formulas.

Remark 7. The serialized representation of the circle sets with two types of paren-
theses on a computer is possible by moving from the binary digit representation of
Sections 1 and 2 to a base-4 representation ) 7→ 0, (7→ 1, ] 7→ 2, [7→ 3. The mapping
is [[]] 7→ 33224, ([[()]]()) 7→ 13310221004, for example.

4. Circle Sets With One Pair intersecting

4.1. Serialized Notation. Another derivative of the non-intersecting circle sets
of Section 2 are circle sets where exactly one pair of circles intersects at two points
of their rims.

These two intersecting circles are a natural reference frame for the other N −2. In
the serialized notation we introduce the expression [[]] with two bracket pairs to in-
dicate crossing of the rims of the ﬁrst, then of the second circle, then leaving the ﬁrst
and ﬁnally leaving the second. The notation provides 5 regions that host the N − 2
remaining circles. The well-formed general expression is reg4 [reg3 [reg2 ]reg1 ]reg0 if
the regions are enumerated 0–4.

reg4

✬✩reg
✬✩reg
2✫✪
✫✪

reg

3

1

reg0

reg4[reg3[reg2]reg1]reg0 7→
The serialized notation is well-suited for computerized managing, but again has
the drawback that the freedom of moving circle sets around as long as no new inter-
sections are induced is not strictly enforced. We add the following constraints to the
serialized notation to avoid over-counting those circle sets with two intersections:
(1) The regions reg1, reg2 and reg3 host members of the CN collection. This
basically ensures that their circle sets do not introduce intersections by
peeking beyond the enclosures deﬁned by the bracket pair. Note that no
such rule is enforced on reg0 and reg4 because we allow the crossing circles
to be inside other circles; so an expression like ([[]]) is well-formed, although
the isolated left and right parentheses are not individually members of P.
(2) If the entire core region of the crossing circles is removed—leaving the
concatenated expression reg4 reg0 —this must be a well-formed P expression.
This ensures that circles that rotate in the space outside the crossing circles

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

11

are considered equivalent; eventually expressions like (()[[]]) and ([[]]()) for
example are counted only once.

(3) From the two expressions obtained by swapping reg1 and reg3 only one is
admitted. These are the regions inside one of the intersecting circles but
not in the intersection. The rule ensures that a sort of mirror operation
at the center of the intersection—which does not change the topology—is
admitted only once in the circle sets.

Deﬁnition 10. X(f )
secting in two points.

N is the set of N circles with f factors, two circle rims inter-

(57)

(58)

Example 8. ([[]])() 7→

[[]](()) 7→ ✒✑✓✏✒✑✓✏

Example 9.

XN =

X(f )
N ;

N

[f =1

N

|X(f )
N |;

|XN | =

Xf =1
✬✩♠
♠♠
✫✪
✛✘♠
✚✙

|X1| = 0.

✬✩❤
([[]()]) 7→ ✒✑✓✏✒✑✓✏
✫✪
✬✩
✬✩♠♠❥
[[()]()]() 7→ ✫✪
✫✪

(59)

(60)

(61)

(62)

(63)

(64)

(65)

(66)

(67)

X2 = X(1)
X(2)
= {};

2

2 = {[[]]};

X(1)

3

X(2)

3

X(3)

3
(1)
4

X

X(2)

4

X(3)

4

X(4)

4

= {([[]]), [[()]], [[]()]};

= {[[]]()};

= {};

= {(([[]])), ([[()]]), ([[]()]), ([[]]()),

[()[]()], [[()()]], [[()]()], [[(())]], [[]()()], [[](())]};

= {([[]])(), [[()]](), [[]()](), [[]](())};

= {[[]]()()};

= {};

4.2. Recurrences. Table 7 shows how many expressions are in the sets XN and
X(f )
N . The ﬁrst three values of |XN | are mentioned in the Encyclopedia of Integer
Sequences [11, A261070].

Obviously |X(N )

N | = 0 and |X(N −1)

| = 1 because we always spend two circles in
the bracket—which does not factorize—and the expression [[]]()()() · · · is the only
member of X

N

(N −1)
N

.

12

RICHARD J. MATHAR

3

4

5

6

7

8

N |XN |
2
1
4
3
15
4
50
5
162
6
506
7
0
1558
8
9
1
4727
4
10 14227
11 42521 19609 14227 5825 1970 622 191 56 16

2
0
0
1
1
4
4
15
16
50
55
162
185
506
1558
594
4727 1878

0
0
1
1
4
4
16
16
56
190
56
617 191

1
1
3
10
30
91
268
790
2308
6737

0
0
1
1
4
16
4
56 16

9 10

0
1
4

0
1 0

Table 7. Topologically distinct sets of N circles with one pair
intersecting, total (row sums) |XN | and |X(f )
N | classiﬁed according
to number of factors 1 ≤ f ≤ N .

For suﬃciently large N there are |X(N −2)

N

| = 4 expressions, namely [[()]]()() · · · ,

[[]()]()() · · · , [[]](())() · · · , and ([[]])()() · · · with N − 3 trailing isolated circles.

The argument of isolating the factor that contains the bracket pair that led to

Equation (41) remains valid, so

(68)

|X(f )

N | =

N −1

XN ′=1

|X(1)

N ′ | |C(f −1)

N −N ′|,

f ≥ 2.

The dismantling of the sole factor of an expression of X(1)

N that contains the two
brackets shows two variants: if the outer parentheses are the round parenthesis, the
expression has been formed by embracing any expression with N − 1 circles, which
contributes |XN −1|. If alternatively the expression is of the form stripped down to
where reg4 and reg0 are empty, we count the number of ways of construction reg3,
reg2 and reg1 with a total of N − 2 circles by a function Dn−2:

(69)

|X(1)

N | = |XN −1| + DN −2.

(70)

DN = 1, 2, 6, 15, 41, 106, 284, 750, 2010, 5382, 14523, 39290 . . .; N ≥ 0.

Example 10. The 6 expressions that contribute to D2 = 6 are [[]()()], [[](())],
[[()]()], [()[]()], [[(())]], and [[()()]].

The distribution of the N circles over reg3, reg2 and reg1 has no further re-
strictions to place any member of C into reg2, which reduces D by composition to
another function ˆD of the form

(71)

DN =

N

XN ′=0

|CN ′ | ˆDN −N ′.

ˆDN counts the number of ways of placing a total N circles into reg3 and reg1 such
that each expression is a member of C and such that the third rule of Section 4.1
of counting only the “ordered” pairs is obeyed. If N is odd, the expressions in two
regions necessarily diﬀer because they must have a diﬀerent number of circles, so
the rule may for example be implemented by putting always the expression with

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

13

the lower number into one region:

(72)

ˆDN,odd =

⌊N/2⌋

XN ′=0

|CN ′| |CN −N ′|.

If N is even, an additional format appears where the expressions in reg3 and reg1
have the same number of circles. Because these elements of |CN/2| may be put into
a strict order, the triangular number with that argument counts the “non-ordered”
pairs of these:

(73)

ˆDN,even =

N/2

XN ′=0

|CN ′| |CN −N ′| +

|CN/2|(|CN/2| + 1)

2

.

In terms of the generating functions (24), (42) and

(74)

ˆD(z) = XN ≥0

ˆDN zN , D(z) = XN ≥0

DN zN ,

this type of half convolution in the previous two equations may be summarized as

(75)

ˆD(z) =

1
2

[C(z)2 + C(z2)].

Remark 8. The symmetry enforced to the contents of reg1 and reg3 is the sym-
metry of the cyclic group C2. The cycle index for this group is (t2
1 + t2)/2 [5, I60].
Substitution of tj 7→ C(zj) gives the same result [3, p. 252].

(76)

ˆDN = 1, 1, 3, 6, 16, 37, 96, 239, 622, 1607, 4235, 11185, 29862 . . .; N ≥ 0.

(71) reads

(77)

D(z) = C(z) ˆD(z).

Example 11. ˆD1 = 1 is the size of the set {[[]()]}.

Example 12. ˆD2 = 3 is the size of the set {[()[]()], [[]()()], [[](())]}.

Example 13. ˆD3 = 6 is the size of the set {[[]()()()], [[](())()], [[]((()))], [[](()())],
[()[]()()], [()[](())]}.

Summation of (68) over f , and using (69) leads to

(78)

X(z) = 1 +

z2D(z)C(z)
1 − zC(z)

.

4.3. Pair of Touching Circles. If there are no further circles in the area of the
intersection, the two intersecting circles may be moved apart until they touch in
a single point. These borderline cases are destilled from the previous analysis by
counting expressions only where the two inner brackets appear side by side, i.e,
where reg2 is empty. We call these sets of conﬁgurations X(f,t)
N where the label t
indicates touching.

Deﬁnition 11. X(f,t)
at one point.

N

is the set of N circles with f factors, two circle rims touching

14

RICHARD J. MATHAR

3

4

5

6

7

8 9

10

2

N |X(t)
N |
1
0
1
0
0
1
1
2
1
2
3
3
3
6
10
4
10
16
30
5
30
46
91
6
91
128
268
7
0
268
790
8
364
1 0
790
2308 1029
9
10
3 1
6737 2930 2308
11 19609 8344 6737 2962 1055 348 113 35 11 3

0
0
1
1
3
3
11
11
35
35
112
344 113

0
0
1
1
3
3
11
35 11

0
1
3
11
34
108
327
992

0
1 0
Table 8. Topologically distinct sets of N circles with one pair
touching, total and classiﬁed according to number of factors 1 ≤
f ≤ N .

(79)

(80)

X(t)

N =

|X(t)

N | =

N

[f =1

N

Xf =1

X(f,t)

N ⊆ XN ;

|X(f,t)

N | ≤ |XN |;

Example 14. If we remove the expressions from Example 9 where other circles
appear within the innermost of the two square brackets, the following list emerges:

(81)

(82)

(83)

(84)

(85)

(86)

(87)

(88)

(89)

X(t)
2

X

X

(2,t)
2
(1,t)
3

X(2,t)

3

X(3,t)

3

X(1,t)

4

X(2,t)

4

X(3,t)

4
X(4)

4

= X(1,t)

2 = {[[]]};

= {};

= {([[]]), [[]()]};

= {[[]]()};

= {};

= {(([[]])), ([[]()]), ([[]]()), {[()[]()], [[]()()], [[](())]};

= {([[]])(), [[]()](), [[]](())};

= {[[]]()()};

= {};

Table 8 shows how many expressions are in the sets X
As before

(t)
N and X

(f )t
N .

(90)

|X(N,t)

N | = 0;

|X(N −1,t)

N

| = 1.

The strategy of isolating the factor with the brackets that lead to (69) remains
valid:

(91)

|X(f,t)

N | =

N −1

XN ′=1

|X(1,t)
N ′

| |C(f −1)

N −N ′|,

f ≥ 2.

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

15

The formula that distributed the N − 2 circles within the three regions in the
intersecting circles now needs to skip the cases where some of them are in reg2.
And instead of (69) we immediately skip to
N | = |X(t)
and replace (78) by the generating function

N −1| + ˆDN −2

|X(1,t)

(92)

(93)

X (t)(z) = XN ≥0

X (t)

N zN = 1 +

z2 ˆD(z)C(z)
1 − zC(z)

.

4.4. One or More Intersecting Pairs. The topologies of the members of the
sets XN are mapped onto rooted trees representing the dependence of “being a
circle inside another” as “being a branch of a node that represents the enclosing
circle.” The plane is the root of the tree. There is no limit of how many branches
a node can have. Moving around circle clusters freely means that the nodes are
counted without a notion of order. The sole exception—which distinguishes CN
from XN —is that the tree must have a single node representing the intersecting
circle pair which has up to three nodes (the three regions) that partially respect
order because the circle clusters in reg2 are topologically considered diﬀerent from
circle clusters in reg1 or reg3.

If one chops the node representing the plane oﬀ the tree, it becomes a rooted
forest, where the number of rooted trees is the factor f of the interpretation as
nested parentheses.

The natural extension of these rules is to symmetrize the rules for the branches
in that rooted forest, i.e., to allow circles and the three regions in the intersecting
circle pair to host any number of intersecting circle clusters or intersecting circle
pairs. The restriction that remains is that intersection of more than two circles are
still not considered.

Deﬁnition 12. 2XN is the set of topologies of N nested circles in the plane where
each circle intersects with at most one other circle. 2X(f )
N is the set of topologies of
N nested circles with f factors, i.e., with f of these objects that are not inside any
other of these objects.

Deﬁnition 13. The generating function is

(94)

2X(z) = XN ≥0

|2XN |zN .

✬✩
✬✩
♠♠❤✫✪
♠♠
✫✪

Example 15. This is a circle bundle in 2X
The outer pair of 2 intersecting circles contains another pair of 2 intersecting circles
(amongst others) in one of its three regions.

(1)
7 which is not in X7:

The grand book-keeping of placing these objects side by side works as before,

and the empty plane is the unique way of not having any circles:

(95)

2XN =

N

[f =1

2X(f )
N ;

|2XN | =

N

Xf =1

|2X(f )
N |;

|2X0| = 1.

16

RICHARD J. MATHAR

2

3

4

5

6

7

8

9

|2XN |
1
3
8
27
90
330
1225
4729
18554
74234

N
1
2
3
4
5
6
7
8
1
2
9
8
10
11 300828 164033 95618 30622 7954 1961 479 120 30

1
1
1
2
2
5
8
16
26
53
100
189
375
694
1473
2642
5823
10270
40747 23479

1
1
2
2
8
8
30
30
115
120
453
473
1827
7432 1936

1
2 1
8 2
Table 9. The number of topologies of nested N circles intersect-
ing at most as binaries, |2XN |, and the subcounts with f factors,
|2X(f )
N |, 1 ≤ f ≤ N . The row sums are the Euler transform of the
column f = 1.

1
1
2
2
8
8
30
30
120
479 120

1
2
8
30

1

(96)

|2X(f )

N | =

X

π(N ):N ={N c1

1 ;N c2

2 ;...N

f

Yj=1

cf
f }

(cid:18)|2X(1)

Nj

| + cj − 1
cj

(cid:19);

f ≥ 2.

The diﬀerence starts where the objects at f = 1 are dismantled. These are not the
two types considered in (40), (69) or (92) nor the k types as in (26). The compound
object is either a circle that hosts the same type of objects with one circle less, or
a pair of intersecting circles with other objects of the same type in their regions:

(97)
¯DN −2 is the number of ways of distributing objects of the 2X type with a total of
N − 2 circles into three regions with the symmetry rules of Section 4.2.

N | = |2XN −1| + ¯DN −2.

|2X(1)

With the splitting rule of Section 4.2 the overlapping reg2 may contain any
number of the elements of 2X and the other two regions share the remaining number
of circles as if the set was ordered. Copying from (71) and (75),

(98)

(99)

¯DN =

N

XN ′=0

|2XN ′| ˜DN −N ′;

˜D(z) = XN ≥0

˜DN zN =

1
2

[2X(z)2 + 2X(z2)].

(100)

¯DN = 1, 2, 8, 26, 99, 364, 1417, 5541, 22193, 89799, 368160, 1523020, . . ., N ≥ 0.
The number of ways of distributing N circles over reg1 and reg3 of two inter-

secting circles is
(101)
˜DN = 1, 1, 4, 11, 41, 141, 537, 2041, 8042, 32028, 129780, 531331, 2198502, . . .N ≥ 0.
Example 16. ˜D2 = 4 counts the three ways of Example 12 plus the one way of
putting two intersecting circles in one of the two regions.

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

17

Example 17. ˜D3 = 11 counts the six ways of Example 13 plus the following ﬁve
ways that are new in 2XN :

(1) putting [[]]() in one region,
(2) putting [[]] in one region and () in the other,
(3) putting ([[]]) in one region,
(4) putting [[]()] in one region,
(5) putting [[()]] in one region.

5. Outlook: 3-circle Intersections

5.1. 6 new topologies. Adding 3-circle intersections introduces 6 new topologies
beyond those of 2XN [11, A250001]:

2

✬✩
✬✩
✬✩✫✪
✫✪
(1) The “RGB spot diagram” 3,1X3: ✫✪

The 7 regions
inside the circles may be labeled by the circles that cover them: 1, 12, 2, 23,
3, 13, 123. The symmetry of the diagram is established by three mirror lines
that pass through 12, 23 and 13, and a symmetry for rotations by multiples
of 120◦ around the center. The symmetry group is the noncyclic group of
order 6. A permutation representation is (1)(23) for the ﬁrst generator and
(123) for the second [9]. The elements are

1

3

• the unit element (1)(2)(3) which contributes t3
• the ﬁrst generator which contributes t1t2,
• the second generator which contributes t3,
• the square of the second generator, (132), which contributes t3,
• the element (12) which contributes t1t2, and
• the element (13) which contributes t1t2.

1 to the cycle polynomial,

2

1 + 3t1t2 + 2t3)/6.

The cycle index is (t3

★✥
★✥
★✥✧✦
✧✦
(2) The torn version of this with an uncovered central area 3,2X3: ✧✦

The 7 regions inside the circles may be labeled by the circles that cover
them: 1, 12, 2, 23, 3, 13, /∈ 123. The symmetry is the same as for 3,1X3
above.

✬✩3
(3) A linear chain 3,3X3: ✫✪

✬✩2
✫✪

✬✩1
✫✪

The 5 regions inside the
circles may be labeled by the circles that cover them: 1, 12, 2, 23, 3. The
symmetry is the same left-right mirror symmetry as in Remark 8; the cycle
index is (t2

3

1

1 + t2)/2.

18

RICHARD J. MATHAR

✬✩
✬✩
✬✩1
✫✪
(4) The left-right compressed version of the previous diagram, 3,4X3: ✫✪
✫✪

The 7 regions inside the circles may be labeled by the circles that cover
them: 1, 12, 123, 23, 3, 2, 2, using overline and underline to register the
upper and lower regions of the pieces of circle 2. The appearance of the
regions 2 and 2 introduces an additional up-down mirror symmetry. The
symmetry group is the noncyclic group of order 4, which has the generators
(34) and (12) [9]. The elements are

3

2

• the unit element (1)(2)(3)(4) which contributes t4

1 to the cycle poly-

nomial,

• the ﬁrst generator which contributes t2
1t2,
• the second generator which contributes t2
1t2,
• the element (12)(34) which contributes t2
2.

1t2 + t2

1 + t2)/2 × (t′
1

1 + 2t2
The cycle index is (t4
2)/4. This is replaced by the direct product
2 + t′
(t2
2)/2 as we wish to represent the combined regions 1 ∪ 12
and 3 ∪ 23 that are related by one of the C2 symmetries diﬀerently from
the regions 2 and 2 by the other C2 symmetry.

✬✩♠
(5) The previous diagram with a shrunk center circle, 3,5X3: ✫✪

The 7 regions inside the circles may be labeled by the circles that cover
them: 1, 12, 123, 23, 3, 13, 13, using overline and underline to register the
upper and lower regions. The symmetry is the same as in the preceding
diagram 3,4X3.

✬✩
✬✩1
✗✔
✖✕
✫✪
(6) The asymmetric bundle 3,6X3: ✫✪

The 5 regions inside the
circles may be labeled by the circles that cover them: 1, 12, 123, 23, 2. The
cycle index is t1.

3

2

3

2

✬✩1
✫✪

Let 3XN ⊇ 2XN denote the arrangements of N nested circles which admit the
topologies of simple circles, the one topology of two-circle intersections and the ﬁve
topologies of three-circle intersections in the subregions.

Example 18. This is an element of 3X(2)

5.2. Recurrences.

✬✩
✬✩
♠♠♠ ✍✌✎☞❤
✗✔❥❤✫✪
✖✕
10 which is not in 2XN : ✫✪

Deﬁnition 14. Generating function of the topologies with up-to-three intersections:

(102)

|3XN |zN = 3X(z).

XN

TOPOLOGIES OF NON-INTERSECTING CIRCLES IN THE PLANE

19

The multiset interpretation as a forest of rooted trees with non-factoring elements
N in the roots holds again:

3X(1)

(103)

|3X(f )

N | =

X

π(N ):N ={N c1

1 ;N c2

2 ;...N

f

Yj=1

cf
f }

(cid:18)|3X(1)

Nj

| + cj − 1
cj

(cid:19).

There is one type of compound objects constructed by wrapping a circle around
others, one type of covering them with two intersecting circles, and six types of
covering them with three intersecting circles. Because the two types 3,1X and 3,2X
of the 3-circles have the same number of regions and the same symmetry, we count
the ﬁrst type twice and drop the second; because types 3,4X and and 3,5X have the
same number of regions and the same symmetry, we also count 3,4X twice and drop
3,5X. The upgrade of (97) is
(104) |3X(1)

N | = |3XN −1| + 2DN −2 + 2 3,1DN −3 + 3,3DN −3 + 2 3,4DN −3 + 3,6DN −3.
The generating functions are deﬁned in the obvious way preserving the upper left
...DN zN = ...D(z). They are all anchored at ...D0 = 1 and

type indices: PN ≥0

zero for negative N .

(1) The three regions in 2XN are populated as before, but now also accepting
elements of 3X in their subregions such that their values diﬀer from the
values of ¯DN of Equation (98):

(105)

2D(z) =

1
2

3X(z)[3X 2(z) + 3X(z2)].

(2) In 3,1XN region 123 is populated without restriction. The remaining 6
regions associated via symmetry are then incorporated with tj 7→ 3X 2(zj),
j ≥ 1, in the cycle index, so

(106)

3,1D(z) =

1
6

3X(z)[3X 6(z) + 3 3X 2(z) 3X 2(z2) + 2 3X 2(z3)].

(3) Region 2 in 3,3XN is populated without restrictions, which contributes a
factor 3X(z). The pair regions 1 and 12 are populated without restrictions
with is represented by f (z) = 3X 2(z). The regions 3 and 23 associated
to them via symmetry are then incorporated with tj 7→ f (zj) in the cycle
index, so

(107)

3,3D(z) =

1
2

3X(z)[3X 4(z) + 3X 2(z2)].

(4) In 3,4XN region 123 is populated without restriction which contributes a
factor 3X(z). Regions 1 and 12 are represented by f (z) and 2 is represented
by 3X(z). Substituting tj = f (zj), t′

j = 3X(z) in the cycle index yields

(108)

3,4D(z) =

1
4

3X(z)[3X 4(z) + 3X 2(z2)][3X 2(z) + 3X(z2)].

(5) The ﬁve regions in 3,6XN are populated without restrictions:

(109)

3,6D(z) = 3X 5(z).

The numerical evaluation of the recurrences leads to Table 10. The ﬁrst diﬀerence
in comparison to Table 9 is where the 6 additional topologies oﬀer new branches as
soon as at least 3 circles are involved: |3X

(1)
3 | = |2X

(1)
3 | + 6.

20

RICHARD J. MATHAR

1

3

4

5

6

7

8

9

2

|3XN |
1
1
3
2
14
14
61
66
252
323
1019
1431
4127
6320
17242
27420
74007
325615 157297 119821

N
1
2
3
4
5
6
7
8
1
9
2 1
10
11 1458604 701901 528557 176894 40549 8510 1745 361 70 14 2

1
1
2
2
14
14
70
70
361
361
1739
8455 1745

1
1
2
11
44
169
609
2253
8779
36319

1
2
14
70
356
1695
8081
37849

1
1
2
2
14
70 14

1
2
14
70
361

Table 10. The number of topologies of nested N circles intersect-
ing at most as triples, |3XN |, and the subcounts with f factors,
|3X(f )
N |, 1 ≤ f ≤ N . The row sums are the Euler transform of the
column f = 1.

In a wider context one would like to construct and count all circle sets of N
circles with an arbitrary number of intersections [11, A250001]. That is out of
reach of this paper; in Table 10 that analysis is only complete up to N = 3.

References

1. Ralph Palmer Agnew, Euler transformations, Am. J. Math. 66 (1944), no. 2, 313–338.
2. Arthur Cayley, XXVIII. on the theory of the analytical forms called trees, Philos. Mag. Ser.

4 13 (1857), no. 85, 172–176.

3. Louis Comtet, Advanced combinatorics, Springer, Berlin, Heidelberg, New York, 1974.
4. Robert Donaghey, Restricted plane tree representations of four Motzkin-Catalan equations,

J. Comb. Theory B 22 (1977), 114–121. MR 0432532

5. Philippe Flajolet and Robert Sedgewick, Analytic combinatorics, Cambridge University Press,

2009. MR 2483235

6. David Klarner, Correspondences between plane trees and binary sequences, J. Combin. Theory

9 (1970), 401–411. MR 0292690

7. J. Knopfmacher and M. E. Mays, Compositions with m distinct parts, Ars Combin. 53 (1999),

111–128. MR 1724493

8. Pierre Leroux and Brahim Miloudi, G´en´eralisations de al formule d’Otter, Ann. Sci. Math.

Qu´ebec 16 (1992), no. 1, 53–80.

9. Richard J. Mathar, Smallest symmetric supergroups of the abstract groups up to order 37,

vixra:1504.0032 (2015).

10. G. P´olya, Kombinatorische Anzahlbestimmungen f¨ur Gruppen, Graphen und chemische

Verbindungen, Acta Arith. 68 (1937), no. 1, 145–254. MR 1577579

11. Neil J. A. Sloane, The On-Line Encyclopedia Of Integer Sequences, Notices Am. Math. Soc.

50 (2003), no. 8, 912–915, http://oeis.org/. MR 1992789 (2004f:11151)

12. Richard P. Stanley, Enumerative combinatorics, 2 ed., vol. 1, Cambridge University Press,

2011. MR 1442260
URL: http://www.mpia.de/~mathar

Max-Planck Institute of Astronomy, K¨onigstuhl 17, 69117 Heidelberg, Germany

