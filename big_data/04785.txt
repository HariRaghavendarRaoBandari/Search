6
1
0
2

 
r
a

 

M
5
1

 
 
]

.

C
O
h
t
a
m

[
 
 

1
v
5
8
7
4
0

.

3
0
6
1
:
v
i
X
r
a

Traﬃc regulation via controlled speed limit∗

Maria Laura Delle Monache†

Benedetto Piccoli‡

Francesco Rossi§

Abstract

We study an optimal control problem for traﬃc regulation via variable
speed limit. The traﬃc ﬂow dynamics is described with the Lighthill-
Whitham-Richards (LWR) model with Newell-Daganzo ﬂux function. We
aim at minimizing the L2 quadratic error to a desired outﬂow, given an
inﬂow on a single road. We ﬁrst provide existence of a minimizer and com-
pute analytically the cost functional variations due to needle-like variation
in the control policy. Then, we compare three strategies: instantaneous
policy; random exploration of control space; steepest descent using nu-
merical expression of gradient. We show that the gradient technique is
able to achieve a cost within 10% of random exploration minimum with
better computational performances.
Keywords: Traﬃc problems, Optimal control problem, Variable speed
limit
AMS subject classiﬁcation:90B20, 35L65, 49J20

1

Introduction

In this paper, we study an optimal control problem for traﬃc ﬂow on a single
road using a variable speed limit. The ﬁrst traﬃc ﬂow models on a single road of
inﬁnite length using a non-linear scalar hyperbolic partial diﬀerential equation
(PDE) are due to Lighthill and Whitham [31] and, independently, Richards [33],
which in the 1950s proposed a ﬂuid dynamic model to describe traﬃc ﬂow. Later
on, the model was extended to networks [18] and started to be used to control
and optimize traﬃc ﬂow on roads. In the last decade, several authors studied
optimization and control of conservation laws and several papers proposed diﬀer-
ent approaches to optimization of hyperbolic PDEs, see [5, 17, 19, 22, 29, 34, 35]
and references therein. These techniques were then employed to optimize traﬃc
ﬂow through, for example, inﬂow regulation [11], ramp-metering [32] and vari-
able speed limit [20]. We focus on the last approach, where the control is given by
∗This research was supported by the NSF grant CNS #1446715 and by KI-Net ”Kinetic
description of emerging challenges in multiscale problems of natural sciences” - NSF grant #
1107444
†Department of Mathematical Sciences, Rutgers University - Camden, Camden, NJ, USA
‡Department of Mathematical Sciences and CCIB, Rutgers University - Camden, Camden,
§Aix Marseille Universit´e, CNRS, ENSAM, Universit´e de Toulon, LSIS UMR 7296,13397,

NJ USA (email: piccoli@camden.rutgers.edu).

(email: ml.dellemonache@rutgers.edu).

Marseille, France (email: francesco.rossi@lsis.org).

1

the maximal speed allowed on the road. Notice that also the engineering litera-
ture presents a wealth of approaches [1, 2, 9, 10, 12, 14, 23, 24, 25, 26, 27, 28, 36],
but mostly in the time discrete setting. In [1, 2] a dynamic feedback control
law is employed to compute variable speed limits using a discrete macroscopic
model. Instead, [23, 24, 25] use model predictive control (MPC) to optimally
coordinate variable speed limits for freeway traﬃc with the aim of suppressing
shock waves.
In this paper, we address the speed limit problem on a single road. The control
variable is the maximal allowed velocity, which may vary in time but we assume
to be of bounded total variation, and we aim at tracking a given target outgo-
ing ﬂow. More precisely, the main goal is to minimize the quadratic diﬀerence
between the achieved outﬂow and the given target outﬂow. Mathematically the
problem is very hard, because of the delays in the eﬀect of the control variable
(speed limit). In fact, the Link Entering Time (LET) τ (t), which represents the
entering time of the car exiting the road at time t see (7), depends on the given
inﬂow and the control policy on the whole time interval [τ (t), t]. Moreover, the
input-output map is deﬁned in terms of LET, thus the achieved outﬂow at time
t depends on the control variable on the whole interval [τ (t), t]. Due to the
complexity of the problem, in this article we restrict the problem to free ﬂow
conditions. Notice that this assumption is not too restrictive. Indeed, if the
road is initially in free ﬂow, then it will keep the free ﬂow condition due to
properties of the LWR model, see [8, Lemma 1].
After formulating the optimal control problem, we consider needle-like variations
for the control policy as used in the classical Pontryagin Maximum Principle
[7]. We are able to derive an analytical expression of the one-sided variation
of the cost, corresponding to needle-like variations of the control policy, using
ﬁne properties of functions with bounded variation. In particular the one-sided
variations depend on the sign of the control variation and involves integrals
w.r.t. to the distributional derivative of the solution as a measure, see (10).
This allows us to prove Lipschitz continuity of the cost functional in the space
of bounded variation function and prove existence of a solution.
Afterwards, we deﬁne three diﬀerent techniques to solve numerically this prob-
lem.

• Instantaneous Policy (IP). We design a closed-loop policy, which depends
only on the instantaneous density at road exit. More precisely, we choose
the speed limit which gives the nearest outﬂow to the desired one.

• Random Exploration (RE). It uses time discretization and random binary
tree search of the control space to ﬁnd the best maximal velocity proﬁle.
• Gradient Descent Method (GDM). It consists in approximating numeri-
cally the gradient of the cost functional using (10) combined with a steep-
est descent method.

We compare the three approaches on two test cases: constant desired outﬂow
and sinusoidal inﬂow; sinusoidal desired outﬂow and inﬂow. In both cases RE
provides the best control policy, however GDM performs within 10% of best
RE result with a computational cost of around 15% of RE. On the other side,
IP performs poorly with respect to the RE, but with a very low computational
cost. Notice that, in some cases, IP may be the only practical policy, while GDM

2

represents a valid approach also for real-time control, due to good performances
and reasonable computational costs. Moreover, control policies provided by RE
may have too large total variation to be of practical use.
The paper is organized as follows: section 2 gives the description of the traﬃc
ﬂow model and of the optimal control problem. Moreover, the existence of a
solution is proved. In section 3, the three diﬀerent approaches to ﬁnd control
policies are described. Then in section 4, these techniques are implemented on
two test cases. Final remarks and future work are discussed in section 5.

2 Mathematical model

In this section, we introduce a mathematical framework for the speed regula-
tion problem. The traﬃc dynamics is based on the classical Lighthil-Whitham-
Richards (LWR) model ([31, 33]), while the optimization problem will seek
minimizers of quadratic distance to an assigned outﬂow.

2.1 Traﬃc ﬂow modeling

We consider the LWR model on a single road of length L to describe the traﬃc
dynamics. The evolution in time of the car density ρ is described by a Cauchy
problem for scalar conservation law with time dependent maximal speed v(t):

(cid:26) ρt + f (ρ, v(t))x = 0,

ρ(0, x) = ρ0(x),

(t, x) ∈ R+ × [0, L],
x ∈ [0, L],

(1)

where ρ = ρ(t, x) ∈ [0, ρmax] with ρmax the maximal car density. In the trans-
portation literature the graph of the ﬂux function ρ → f (ρ) (in our case for a
ﬁxed v(t)) is commonly referred to as the fundamental diagram. Throughout
the paper, we focus on the Newell - Daganzo - type ([13]) fundamental diagrams,
see Figure 1b. The speed takes value on a bounded interval v(t) ∈ [vmin, vmax],
0 < vmin ≤ vmax, thus the ﬂux function f : [0, ρmax]× [vmin, vmax] → R+ is given
by

 ρv(t),

f (ρ, v(t)) =

v(t)ρcr
ρmax − ρcr

(ρmax − ρ),

if 0 ≤ ρ ≤ ρcr,
if ρcr < ρ ≤ ρmax,

(2)

with v(t) representing the maximal speed, see Figure 1a. Notice that the ﬂow is
increasing up to a critical density ρcr and then decreasing. The interval [0, ρcr] is
referred to as the free ﬂow zone, while [ρcr, ρmax] is referred to as the congested
ﬂow zone.

The problem we consider is the following. Given an inﬂow In(t), we want to
track a ﬁxed outﬂow Out(t) on a time horizon [0, T ], T > 0, by acting on the
time-dependent maximal velocity v(t). A maximal velocity function v : [0, T ] →
[vmin, vmax] is called a control policy.
It is easy to see that a road in free ﬂow can become congested only because
of the outﬂow regulation with shocks moving backward, see [8, Lemma 2.3].
Since we assume Neumann boundary conditions at the road exit, the traﬃc
will always remain in free ﬂow, i.e. ρ(t, x) ≤ ρcr for every (t, x) ∈ [0, T ] × [0, L].
Given the inﬂow function In(t), we consider the Initial Boundary Value Problem

3

v(ρ)

vmax

v(t)

vmin

f (ρ)

f (ρcr)

vmax

v(t)

vmin

ρcr

ρmax

ρ

ρcr

ρmax

ρ

(a) Velocity function.

(b) Newell-Daganzo fundamental diagram.

Figure 1: Velocity and ﬂow for diﬀerent speed limits.

with assigned ﬂow boundary condition fl on the left and Neumann boundary
condition (ﬂow fr) on the right:

ρt + f (ρ, v(t))x = 0,
ρ(0, x) = ρ0(x),
fl(t) = In(t),
fr(t) = ρ(t, L) v(t).

(t, x) ∈ R+ × [0, L],
x ∈ [0, L],

(3)



We denote by BV the space of scalar functions of bounded variations and by
TV the total variation, see [6] for details. For any scalar BV function h we
denote by ξ(x±) its right (respectively left) limit at x. We further assume the
following:

Hypothesis 1 There exists 0 < ρmin
that ρ0 ∈ BV([0, L], [ρmin
Under this assumption, we have:

, ρmax

0

0

0 ≤ ρmax

0 ≤ ρcr and 0 < fmin ≤ fmax such

]) and In ∈ BV([0, T ], [fmin, fmax]).

Proposition 1 Assume that hypothesis 1 holds and
v ∈ BV([0, T ], [vmin, vmax]).

Then, there exists a unique entropy solution ρ(t, x) to (3). Moreover, ρ(t, x) ≤
ρcr and, setting

we have that Out(.) ∈ BV([0, T ], R) and the following estimates hold

(cid:110)

min

ρmin
0

,

Out(t) = ρ(t, L)v(t),

(cid:110)
(cid:111) ≤ ρ(t) ≤ max
(cid:110)
(cid:111) ≤ Out(t) ≤ max

fmin
vmax

(cid:110)

(4)

(5)

(cid:111)

,

ρmax
0

,

fmax
vmin

(cid:111)

vmax
vmin

vmin
vmax

min

Proof.

vmin, fmin

ρmin
(6)
0
Let vn ∈ BV([0, T ], [vmin, vmax]) be a sequence of piecewise con-
stant functions converging to v in L1 and satisfying TV(vn) ≤ TV(v). For
each vn, by standard properties of Initial Boundary Value Problems for con-
servation laws [15], there exists a unique BV entropy solution ρn to (3) with

vmax, fmax

ρmax
0

.

4

ρn ∈ Lip([0, T ], L1). Notice that the left ﬂow condition is equivalent to the
boundary condition: ρl(t) =
. From [8, Lemma 2.3] and the Neumann
boundary condition on the right, we get that ρn(t, x) ≤ ρcr, thus by maximum
principle it holds:

In(t)
v(t)

(cid:104)

(cid:16)R,

(cid:110)

(cid:111)

(cid:110)

ρn(t,·) ∈ BV

min

ρmin
0

,

fmin
vmax

, max

ρmax
0

,

fmax
vmin

(cid:111)(cid:105)(cid:17)

.

Let us now estimate the total variation of the solution ρn. Since it solves a scalar
conservation laws, the total variation does not increase in time due to dynamics
on ]0, L[. Notice that changes in v(·) will not increase the total variation of ρn
inside the road (i.e. on ]0, L[). The total variation of ρn increases only because
of new waves generated by changes in the inﬂow. Using the boundary condition

ρl(t) =

In(t)
v(t)

, we can estimate the total variation in space of ρn caused by

time variation of In, respectively time variation of v, by

fmax TV(v)

v2
min

. Finally we get:

TV(In)

vmin

, respectively

TV(ρn(t,·)) ≤ TV(ρn(0,·) +

sup

t

TV(In)

vmin

+

fmax TV(v)

v2
min

.

[0, L]) to f (ρ∗(t, x), v(t)). Passing to the limit in the weak formulation(cid:82)

By Helly’s Theorem (see [6, Theorem 2.4]) there exists a subsequence converging
in L1([0, T ] × [0, L]) to a limit ρ∗. By Lipschitz continuity of the ﬂux and
dominated convergence we get that f (ρn(t, x), v(t)) converges in L1([0, T ] ×
Ω ρn ϕt+
f (ρn, w) ϕx dt dx = 0 (where Ω ⊂⊂ [0, T ] × [0, L] and ϕ ∈ C∞
0 ) we have that ρ∗
is a weak entropic solution. We can pass to the limit also in the left boundary

and v is bounded from
condition because this is equivalent to ρl(t) =
below. Finally ρ∗ is a solution to (3). The standard Kruˇzhkov entropy condition
[30] ensures uniqueness of the solution.
Since Out(t) = ρ(t, L)v(t), we have that Out(t) has bounded variation and
(cid:3) To simplify notation, we further make the following
satisﬁes (6).
assumptions:

In(t)
v(t)

Hypothesis 2 We assume Hypothesis 1 and the following:
0 ≥ fmax
ρmax
vmin

0 ≤ fmin
ρmin
vmax

and

.

Given a control policy v, we can deﬁne a Link Entering Time (LET) function
τ = τ (t, v) representing the entering time for a car exiting the road at time t.
The function depends on the control policy v, but for simplicity we will write
τ (t) when the policy is clear from the context. Notice that LET is deﬁned only
for time greater than a given t0 > 0, the exit time of the car entering the road
0 v(s)ds = L and, for each
t ≥ t0:

at time t = 0, see Figure 2. Note that t0 satisﬁes(cid:82) t0

v(s)ds = L.

(7)

(cid:90) t

τ (t)

5

τ (t)

t

t0

0

L

Figure 2: Graphical representation of the LET function τ = τ (t, v) deﬁned in
(7).

Such τ (t) is unique, due to the hypothesis v ≥ vmin > 0. From the identity

(cid:90) τ (t2)

(cid:90) t2

v(s)ds =

v(s)ds,

we get the following:

τ (t1)

t1

Lemma 1 Given a control policy v, the function τ is a Lipschitz continuous
function, with Lipschitz constant

.

vmax
vmin

Recalling the deﬁnition of outﬂow of the solution given in (4), we get:

Proposition 2 The input-output ﬂow map of the Initial Boundary Value Prob-
lem (brieﬂy IBVP) (3) is given by

Out(t) = In(τ (t))

v(t)

v(τ (t))

.

(8)

Proof. Thanks to Proposition 1, the solution ρ to the IBVP (3) satisﬁes ρ(t, x) ≤
ρcr, thus ρ solves a conservation law linear in ρ. Indeed the Newell-Daganzo
ﬂow is linear in the free ﬂow zone. Therefore, no shock is produced inside the
domain [0, L] and characteristics are deﬁned for all times. In particular the value
of ρ is constant along characteristics. The characteristic exiting the domain at
time t enters the domain from the boundary at time τ (t). Therefore we get
(cid:3)
ρ(t, L) = ρ(0, τ (t)) = In(τ (t))

v(τ (t)) . From (4) we get the desired conclusion.

Remark 1 This map is highly non-linear with respect to the control policy v due
to the deﬁnition of τ . Hence, the classical techniques of linear control cannot be
applied. Moreover, such formulation clearly shows how delays enter the input-
output ﬂow map. The eﬀect of the control v at time t on the outﬂow depends
on the choice of v on the time interval [τ (t), t], because of the presence of the
LET map in formula (8).

6

2.2 Optimal control problem

We are now ready to deﬁne formally the problem of outﬂow tracking.
Problem 1 Let Hypothesis 2 hold, ﬁx f∗ ∈ BV([0, T ], [fmin, fmax]) and K > 0.
Find the control policy v ∈ BV([0, T ], [vmin, vmax]), with TV(v) ≤ K, which
minimizes the functional J : BV([0, T ], [vmin, vmax]) → R deﬁned by

J(v) :=

(Out(t) − f∗(t))2dt

(9)

where Out(t) is given by (8).

0

We prove later on, in Proposition 4, that Problem 1 admits a solution.

Remark 2 We use the same positive extreme values fmin, fmax for both the
inﬂow In(.) and the target outﬂow f∗(.) for simplicity of notation only.

Remark 3 In the simple case where all the parameters are constant in time,
i.e. In, Out, f∗, ρ0 do not depend on time, the problem has a a trivial solution
which is v =

realizing J(v) = 0.

f∗
ρ0

2.3 Cost variation as function of control policy variation

In this section we estimate the variation of the cost J(v) with respect to the
perturbations of the control policy v. This computation will allow to prove
continuous dependence of the solution from the control policy.

We ﬁrst ﬁx the notation for integrals of BV function with respect to Radon

Deﬁnition 2.1 Let φ be a BV -function and µ a Radon measure. We deﬁne

(cid:90) T

(cid:90)

measures.

(cid:90)
where µ = µc +(cid:80)

Dirac parts.

(cid:88)

i

φ(x+) dµ(x) :=

φ(x) dµc(x) +

miφ(x+

i ),

i miδxi is the decomposition of µ into its continuous1 and

We now compute the variation in the cost J produced by needle-like variation
in the control policy v(·), i.e. variation of the value of v(·) on small intervals
of the type [t, t + ∆t] in the same spirit as the needle variations of Pontryagin
Maximum Principle [7].
Deﬁnition 2.2 Consider v ∈ BV([0, T ], [vmin, vmax]) and a time t such that
τ−1(0) = t0 ≤ t < τ (T ) and v(t+) < vmax. Let ∆v > 0, ∆t > 0 be suﬃciently
small such that t + ∆t ≤ τ (T ) and v(t+) + ∆v ≤ vmax. We deﬁne a needle-like
variation v(cid:48)(·) of v, corresponding to t, ∆t and ∆v by setting v(cid:48)(s) = v(s) + ∆v
if s ∈ [t, t + ∆t] and v(cid:48)(s) = v(s) otherwise, see Figure 3.

1We recall that any Radon measure on R can be decomposed into its continuous
(AC+Cantor) and Dirac parts, as a consequence of the Lebesgue decomposition Theorem,
see e.g. [16] .

7

v

v(cid:48) = v + ∆v

v

t

t + ∆t

t

Figure 3: Needle-like variation of the velocity v.

Lemma 2 Consider v ∈ BV([0, T ], [vmin, vmax]) and let v(cid:48) be a needle-like vari-
ation of v. Then it holds:
J(v(cid:48)) − J(v)

lim

∆v→0+

=

∆v

(cid:90) L

lim
∆t→0+
= 2ρ2(t−, L)v(t+) − 2ρ(t−, L)f∗(t+)+
−

(cid:90) L
x(t) + 2
f∗(t+) − v(τ−1(t(cid:48))−)

v2((t + s(x))+) dρ2

0+

In(t−)
v(t+)

+ 2

(cid:17)

0+

In(t−)

v(t+)

(cid:16)

f∗((t + s(x))+)v((t + s(x))+) dρx(t)+

,

(10)

where integrals are deﬁned according to Deﬁnition 2.1. For ∆v < 0, the limit
for ∆v → 0− satisﬁes the same formula with right limits replaced by left limits
in the two integral terms in (10).
Remark 4 Notice that the condition τ−1(0) = t0 < t implies that the outﬂow
Out(s) ∈ [t, t + ∆t], depends only on the inﬂow In(.) and not on the initial
density ρ0. If such condition is not satisﬁed, the perturbation given by ∆v has a
comparable eﬀect on Out(.), but it needs to be estimated in two parts: one with
respect to In([0, t + ∆t]) and one with respect to ρ0(0, L − l) with l being such
that

(cid:90) t

v(s)ds = l.

0

The condition t + ∆t ≤ τ (T ) means that the perturbation ∆v has inﬂuence on
the whole outﬂow Out(s) in the interval [t, τ−1(t + ∆t)]. If this is not satisﬁed,
then the inﬂuence of the perturbation is stopped at T < τ−1(t + ∆t), hence the
variation Out(s) is smaller.

Proof. Let τ (t) be deﬁned according to (7) and an outﬂow Out(t) according
to (8). For simplicity we assume that v(·) has a constant value ˆv := v(t+) on
[t, t + ∆t], the general case holding because of properties of BV functions.
We deﬁne t(cid:48) = t + ∆t and s(cid:48) to be the unique value satisfying

(cid:90) s(cid:48)

v(t(cid:48) + σ)dσ = L − (ˆv + ∆v)∆t,

0

8

s(cid:48)(cid:48) to be the unique value satisfying

(cid:90) s(cid:48)(cid:48)
and s(cid:48)(cid:48)(cid:48) = τ−1(t(cid:48)) − t(cid:48), hence(cid:82) s(cid:48)(cid:48)(cid:48)

0

0

We also deﬁne the function

(cid:90) s

v(t(cid:48) + σ)dσ = L − ˆv∆t,

v(t(cid:48) + σ)dσ = L. Notice that s(cid:48) < s(cid:48)(cid:48) < s(cid:48)(cid:48)(cid:48).

x(s) = L −

v(t(cid:48) + σ)dσ.

(11)

Remark that x(s) is a decreasing function, with x(0) = L , x(s(cid:48)) = (ˆv + ∆v)∆t,
x(s(cid:48)(cid:48)) = ˆv∆t and x(s(cid:48)(cid:48)(cid:48)) = 0. We denote with Out(cid:48)(s) the outﬂow, τ(cid:48)(s) the LET

0

t(cid:48) + s(cid:48)(cid:48)(cid:48)
t(cid:48) + s(cid:48)(cid:48)
t(cid:48) + s(cid:48)
t(cid:48) = t + ∆t

t

τ (t)

0

τ−1(t + ∆t) = τ−1(t(cid:48))

I4

I3

I2

I1

t

L

∆t

L − x(s(cid:48)) L − x(s(cid:48)(cid:48))

Figure 4: Graphical representation for the notation used in section 2.3

(see (7)) and ρ(cid:48)(s, x) the density for the policy v(cid:48). Clearly, we have Out(cid:48)(s) =
Out(s) for s ∈ [0, t] ∪ [τ−1(t(cid:48)), T ] and τ(cid:48)(s) = τ (s) for s ∈ [t0, t] ∪ [τ−1(t(cid:48)), T ].
To compute the variation, we distinguish four time intervals: I1 = (t, t(cid:48)),
I2 = (t(cid:48), t(cid:48) + s(cid:48)), I3 = (t(cid:48) + s(cid:48), t(cid:48) + s(cid:48)(cid:48)) and I4 = (t(cid:48) + s(cid:48)(cid:48), τ−1(t(cid:48))), see Fig-
ure 4. The variation of the cost in the ﬁrst interval can be directly computed as
function of the velocity variation, while in the other intervals the delays in the
outﬂow formula (8) will render the computation more involved. We denote with
J1, . . . , J4 the contributions to lim∆t→0+ (J(v(cid:48)) − J(v))/∆v in the four intervals
and estimate them separately.
CASE 1 : I1 = (t, t(cid:48)). Let s ∈ [0, t(cid:48)−t] = [0, ∆t], then Out(t+s) = ρ(t, L−sˆv)ˆv
and Out(cid:48)(t + s) = ρ(t, L − s(ˆv + ∆v))(ˆv + ∆v). We have:

(cid:104)(cid:90) ∆t

(cid:16)

0

1
∆t

(cid:104)(cid:90) ∆t

J1 = lim

∆t→0+

lim

∆t→0+

1
∆t

Out(cid:48)(t+s)−f∗(t+s)

ds−

Out(t+s)−f∗(t+s)

ds

=

(cid:17)2

(cid:16)

(cid:90) ∆t
(cid:16)

0

(cid:105)

(cid:17)2
(cid:105)

(12)

(cid:17)

Out(cid:48)2(t+s)−Out2(t+s)−2f∗(t+s)

Out(cid:48)(t+s)−Out(t+s)

ds

=

0

9

Substituting the expressions for the outﬂows we get

ρ2(t, L − s(ˆv + ∆v))(ˆv + ∆v)2 − ρ2(t, L − sˆv)ˆv2ds+

2f∗(t + s)

ρ(t, L − s(ˆv + ∆v))(ˆv + ∆v) − ρ(t, L − sˆv)ˆv

ds

=

(cid:17)

(cid:105)

Dividing the ﬁrst integral in two parts and making the change of variable σ =

(cid:104)(cid:90) ∆t

0

1
∆t

(cid:16)

∆t→0+

lim

(cid:90) ∆t

−

0

ˆv + ∆v

s

ˆv

1
∆t

∆t→0+

lim

(cid:90) ∆t

−

0

1
∆t

∆t→0+

lim

(cid:90) ∆t

−

0

0

ˆv )

(cid:104)(cid:90) ∆t(1+ ∆v
(cid:16)
(cid:104)(cid:90) ∆t(1+ ∆v
(cid:16)
(cid:104)(cid:90) ∆t
(cid:16)

0

(cid:90) ∆t

0

ˆv


ˆv + ∆v

dσ−

(cid:90) ∆t(1+ ∆v

ˆv )

∆t

(cid:90) ∆t(1+ ∆v

ˆv )

∆t

ρ2(t, L−σˆv)(ˆv+∆v)2

ρ2(t, L−sˆv)ˆv2ds+

(cid:17)

(cid:105)

2f∗(t+s)

ˆv(ρ(t, L−s(ˆv+∆v))−ρ(t, L−sˆv))+∆v(ρ(t, L−s(ˆv+∆v)))

ds

=

After simple algebraic manipulation we get:

ˆv )

ρ2(t, L − sˆv)∆vˆvds +

ρ2(t, L − sˆv)ˆv2ds+

(cid:17)

(cid:105)

(cid:17)

(cid:105)

2f∗(t+s)

ˆv(ρ(t, L−s(ˆv+∆v))−ρ(L−sˆv))+∆v(ρ(t, L−s(ˆv+∆v)))

ds

=

∆t→0+

lim

(cid:90) ∆t

1
∆t
2f∗(t+s)

0

−
Taking the limit as ∆t → 0+, we get:

0

ρ2(t, L − sˆv)∆vˆvds +

ρ2(t, L − sˆv)(ˆv2 + ∆vˆv)ds

ˆv(ρ(t, L−s(ˆv+∆v))−ρ(t, L−sˆv))+∆v(ρ(t, L−s(ˆv+∆v)))

ds

=

ρ2(t−, L)ˆv∆v + ρ2(t−, L)ˆv(ˆv + ∆v)

∆v
ˆv

+

−2f∗(t+)[ˆv(
ρ(t−, L))] − 2f∗(t+)∆vρ(t−, L) =
ρ2(t−, L)ˆv∆v + ρ2(t−, L)(ˆv + ∆v)∆v − 2f∗(t+)∆vρ(t−, L),

ρ(t−, L) − 

hence

thus

J1 = 2ρ2(t−, L)ˆv + ρ2(t−, L)∆v − 2f∗(t+)ρ(t−, L),

J1 = 2ρ2(t−, L)v(t+) − 2f∗(t+)ρ(t−, L).

lim

∆v→0+

CASE 2 : I2 = (t(cid:48), t(cid:48) + s(cid:48)). If s ∈ [0, s(cid:48)] then Out(t(cid:48) + s) = ρ(t(cid:48), x(s))v(t(cid:48) + s)
and Out(cid:48)(t(cid:48) + s) = ρ((t(cid:48), x(s) − ∆v∆t))v(t(cid:48) + s). After decomposing J2 as done
for J1 in (12) and plugging in the expression of the outﬂows, we have

J2 = lim

∆t→0+

v2(t(cid:48) + s)

ρ2(t(cid:48), x(s) − ∆v∆t) − ρ2(t(cid:48), x(s))

ds+

(cid:104)(cid:90) s(cid:48)
(cid:90) s(cid:48)

0

1
∆t
−

(cid:16)

(cid:16)

(cid:17)

(cid:17)

(cid:105)

ds

.

2f∗(t(cid:48) + s)v(t(cid:48) + s)

ρ(t(cid:48), x(s) − ∆v∆t) − ρ(t(cid:48), x(s))

0

(13)

10

Applying the change of variable s → x(s) (see (11)), it holds

v2(t(cid:48) + s(x))

ρ2(t(cid:48), x − ∆v∆t) − ρ2(t(cid:48), x)

dx+

(cid:104)(cid:90) L

0+

J2 = lim

∆t→0+

1
∆t

(cid:90) L

0+

−

2f∗(t(cid:48) + s(x))v(t(cid:48) + s(x))

ρ(t(cid:48), x − ∆v∆t) − ρ(t(cid:48), x)

dx

.

Notice that this change of variable is justiﬁed by Lemma 3 of the Appendix.
Using Lemma 4 of the Appendix, we get:

(cid:17)

(cid:17)

(cid:105)

(cid:16)
(cid:16)

(cid:90) L

0+

J2 = −

v2((t(cid:48) + s(x))+) dρ2

x(t(cid:48), x)

f∗((t(cid:48) + s(x))+)v((t(cid:48) + s(x))+) dρx(t(cid:48), x).

∆v→0+

lim

(cid:90) L

+2

0+

CASE 3 : I3 = (t(cid:48) +s(cid:48), t(cid:48) +s(cid:48)(cid:48)). If s ∈ [s(cid:48), s(cid:48)(cid:48)] then Out(t(cid:48) +s) = ρ(t(cid:48), x(s))v(t(cid:48) +
s) and

Out(cid:48)(t(cid:48) + s) = v(t(cid:48) + s)

g(s)

ˆv + ∆v

,

g(s) = In

t(cid:48) − x(s)
ˆv + ∆v

(cid:18)

(cid:19)

.

(cid:104)(cid:90) s(cid:48)(cid:48)
(cid:16)

s(cid:48)

After decomposing J3 as done for J1 in (12) and plugging in the expression of
the outﬂows, we get

g(s)

1
∆t

lim

∆t→0+

v(t(cid:48) + s)

v2(t(cid:48) + s)

g2(s)

(ˆv + ∆v)2 − ρ2(t(cid:48), x(s))v2(t(cid:48) + s)+

−2f∗(t(cid:48) + s)

(cid:17)(cid:105)
Observe that lim∆t→0+ s(cid:48) = lim∆t→0+ s(cid:48)(cid:48) = τ−1(t(cid:48))− − t(cid:48) and(cid:82) s(cid:48)(cid:48)
s(cid:48) v(t(cid:48) + σ)dσ =
(cid:17)2 −(cid:16) 1
(cid:17)2(cid:105)−
(cid:16)

− ρ(t(cid:48), x(s))v(t(cid:48) + s)

v2(τ−1(t(cid:48))−)In2(t(cid:48)−)

v(τ−1(t(cid:48))−)

∆v∆t, then

∆v J3 =

(cid:104)(cid:16)

ˆv + ∆v

ˆv + ∆v

ds =

(14)

∆v

∆v

ˆv
1

1

2f∗(τ−1(t(cid:48))−)v(τ−1(t(cid:48))−)In(t(cid:48)−)

(cid:17)(cid:105)

,

− 1
ˆv

ˆv + ∆v

v(τ−1(t(cid:48))−)

thus

CASE 4 : I4 = (t(cid:48) + s(cid:48)(cid:48), t(cid:48) + s(cid:48)(cid:48)(cid:48)). If s ∈ [s(cid:48)(cid:48), s(cid:48)(cid:48)(cid:48)] then we compute

lim

∆v→0+

J3 = 0.

Out(t(cid:48) + s) =

v(t(cid:48) + s)

h(s)

ˆv

h(s) = In

and

Out(cid:48)(t(cid:48) + s) = v(t(cid:48) + s)

g(s)

ˆv + ∆v

g(s) = In

11

(cid:18)
(cid:18)

(cid:19)

t(cid:48) − x(s)
ˆv

t(cid:48) − x(s)
ˆv + ∆v

(cid:19)

.

and use the equality(cid:82) s(cid:48)(cid:48)(cid:48)
We decompose J4 as done with J1 in (12), plug in the expression of the outﬂows,
s(cid:48)(cid:48) v(t(cid:48) + σ) dσ = ˆv. The, denoting ˜v = v(τ−1(t(cid:48))−), we
(cid:104)(cid:16)
(cid:105)(cid:105)

(cid:17)2(cid:105)−2f∗(τ−1(t(cid:48))−)˜vIn(t(cid:48)−)
(cid:104)

˜v2In2(t(cid:48)−)

have

1

∆vJ4 =

(cid:17)2−(cid:16) 1

ˆv

1

ˆv + ∆v

− 1
ˆv

.

(cid:104)

ˆv
˜v

ˆv + ∆v

By passing to the limit, we get

J4 = 2f∗(τ−1(t(cid:48))−)

lim

∆v→0+

In(t(cid:48)−)

ˆv

− 2

˜v

ˆv2 In(t(cid:48)−)2.

(cid:3)

Lemma 2 and Remark 4 allow us to prove the following:

Proposition 3 For every K > 0 and C > 0, the functional J is Lipschitz
continuous on Ω = {v ∈ BV : TV(v) ≤ K} ∩ {v ∈ L∞ : (cid:107)v(cid:107)∞ ≤ C} endowed
with the norm (cid:107)v(cid:107)L1.
Let v, ˜v ∈ Ω. Then v − v(cid:48) is in BV and can be approximated by
Proof.
piecewise constant functions. This means the v− v(cid:48) can be approximated in BV
by needle-like variations as in Lemma 2. The right-hand side of (10) is uniformly
bounded (since v ∈ Ω and ρ ∈ BV with uniformly bounded variation). Therefore
we conclude that |J(v) − J(v(cid:48))| ≤ C(cid:107)v − v(cid:48)(cid:107)L1 for some C > 0.
(cid:3)

This allows to prove the following existence result.

Proposition 4 Problem 1 admits a solution.
Proof. The space Ω = {v ∈ BV : TV(v) ≤ K} ∩ {v ∈ L∞ : (cid:107)v(cid:107)∞ ≤ C} is
compact in L1, see e.g. [4], and J is Lipschitz continuous on Ω, thus there exists
(cid:3)
a minimizer of Problem 1.

3 Control policies

In this section, we deﬁne three control policies for the time-dependent maximal
speed v. The ﬁrst, called the instantaneous policy (IP), is deﬁned by minimizing
the instantaneous contribution for the cost J(v) at each time. We will show that
such control policy does not provide a global minimizer, due to delays in the
control eﬀect on the cost for the Problem 1. In particular, due to the bound
v ∈ [vmin, vmax]) the instantaneous minimization may induce a larger cost at
subsequent times. Then, we introduce a second control policy, called random
exploration (RE) policy. Such policy uses a random path along a binary tree,
which correspond the upper and lower bounds for v, i.e. v = vmax and v = vmin.
Lastly, a third control policy is based on a gradient method descent (GDM) and
uses the expression given by Lemma 2 to numerically ﬁnd the gradient of the
cost.

3.1

Instantaneous policy

Deﬁnition 3.1 Consider Problem 1. Deﬁne the instantaneous policy as fol-
lows:

v(t) := P[vmin,vmax]

,

(15)

(cid:17)

f∗(t−) · v(τ (t)−)
In(τ (t)−)

(cid:16)

12

where the projection P[vmin,vmax] : R → R is the function

 a for x < a,

x for x ∈ [a, b],
b

for x > b.

P[a,b](x) :=

(16)

Notice that this would be the optimal choice if f∗ and In would be constant,
see Remark 3. The instantaneous policy can also be written directly in terms
of the input-output map deﬁned in Proposition 2. As we will show later, the
instantaneous policy is not optimal in general, i.e., it does not provide an optimal
solution v for Problem 1. Clearly, it provides the solution in the case of vmin
suﬃciently small and vmax suﬃciently big so that the projection operator reduces

(cid:16) f∗(t−)

(cid:17)

for all times. Indeed,
to the identity, i.e., v(t) = P[vmin,vmax]
in this case the output Out(t) coincides with f∗(t), hence the cost J(v) is zero.

ρ(L−)

=

f∗(t−)
ρ(L−)

3.2 Random exploration policy

The random exploration policy is deﬁned as follows:

Deﬁnition 3.2 Given the extreme values for the maximal speed, vmax and vmin,
and a time step ∆t, the random exploration policy draws sequences of ve-
locities from the set {vmax, vmin} corresponding to control policy values on the
intervals [i∆t, (i + 1)∆t].

Notice that maximal speeds according to this algorithm can be generated for
all times, independently of the corresponding solution, in contrast to the in-
stantaneous policy which is based on the maximal speed at previous times. We
will use numerical optimization to choose the best among the generated random
policies, showing in particular that the instantaneous policy is not optimal in
general.

3.3 Gradient method

We use needle-like variations and the analytical expression in (10) to numeri-
cally compute one-sided variations of the cost. We consider such variations as
estimates of the gradient of the cost in L1. More precisely, we give the following
deﬁnition.

Deﬁnition 3.3 The gradient policy is the result of a ﬁrst-order optimization
algorithm to ﬁnd a local minimum to Problem 1 using the Gradient Descent
Method and the expression in (10), stopping at a ﬁxed precision tolerance.

We will show that the gradient method gives very good results compared to the
other policies taking into account the computational complexity.

4 Numerical simulations

In this section we show the numerical results obtained by implementing the
policies described in section 3. The numerical algorithm for all the approaches
is composed of two steps:

13

1. Numerical scheme for the conservation law (1). The density values are

computed using the classical Godunov scheme, introduced in [21].

2. Numerical solution for the optimal control problem, i.e., computation of
the maximal speed using the instantaneous control, random exploration
policy and gradient descent.

= j∆x, the cell
Let ∆x and ∆t be the ﬁxed space and time steps, and set xj+ 1
interfaces such that the computational cell is given by Cj = [xj− 1
]. The
center of the cell is denoted by xj = (j − 1
)∆x for j ∈ Z at each time step
2
tn = n∆t for n ∈ N. We ﬁx J the number of space points and T the ﬁnite time
horizon. We now describe in detail the two steps.

, xj+ 2

2

2

2

4.1 Godunov scheme for hyperbolic PDEs

The Godunov scheme is a ﬁrst order scheme, based on exact solution to Riemann
problems. Given ρ(t, x), the cell average of ρ in the cell Cj at time tn is deﬁned
as

ρ(tn, x)dx.

(17)

(cid:90) xj+ 1

2

xj− 1
2

ρj =

1
∆x

Then, the Godunov scheme consists of two main steps:

1. Solve the Riemann problem at each cell interface xj+ 1

with initial data

2

(ρj, ρj+1).

2. Compute the cell averages at time tn+1 in each computational cell and

obtain ρj.

Remark 5 Waves in two neighboring cells do not intersect before ∆t if the
following CFL (Courant-Friedrichs-Lewy) condition holds:

min
j∈Z ∆x.

∆t max

2

j∈Z |f(cid:48)(ρj)| ≤ 1
(cid:16)

ρn+1
j = ρn

j − ∆t
∆x

F (ρn

j , ρn

j+1, vn) − F (ρn

j−1ρn

j , vn)

(cid:17)

(18)

(19)

The Godunov scheme can be expressed in conservative form as:

where vn is the maximal speed at time tn. Additionally, F (ρn
Godunov numerical ﬂux that in general has the following expression:

j , ρn

j+1, vn) is the

F (ρn

j , ρn

j+1, vn) =

j+1] f (z, vn)
f (z, vn)

j ,ρn
j+1,ρn
j

if ρn
if ρn

j ≤ ρn
j+1,
j+1 ≤ ρn
j .

(20)

(cid:26) minz∈[ρn

maxz∈ρn

For clarity, we included as an argument for the Godunov scheme the maximal
velocity so that the dependence of the scheme on the optimal control could be
explicit.

14

4.2 Velocity policies

The next step in the algorithm consists of computing a control policy v that
can be used in the Godunov scheme with the diﬀerent approaches introduced in
section 3. In particular, for the instantaneous policy approach we compute the
velocity at each time step using the instantaneous outgoing ﬂux. Instead, using
the other two approaches, the RE and the GDM, we compute beforehand the
value of the velocity at each time step and then use it to solve the conservation
law with the Godunov scheme.

4.2.1 Instantaneous policy

We follow the control policy described in section 3.1 for the instantaneous con-
trol. At each time step, the velocity vn+1 is computed using the following
formula:

vn+1 = v(tn+1) = P[vmin,vmax]

.

(21)

(cid:16) f∗(tn)

(cid:17)

ρnJ

4.2.2 Random exploration policy

To compute for each time step the value of the velocity, we use a randomized
path on a binary tree, see Figure 5. With such technique, we obtain several
sequences of possible velocities. For each sequence the velocities are used to
compute the ﬂuxes for the numerical simulations. We then choose the sequence
that minimizes the cost.

vmax

vmin

vmax

vmin

vmax

vmin

vmax

vmin

vmax

vmin

vmax

vmin

vmax

vmin

Figure 5: The ﬁrst branches of the binary tree used for sampling the velocity.

Remark 6 Notice that the control policy RE may have a very large variation,
not respecting the bounds given in Problem 1. Therefore the found control poli-
cies may not be feasible. However, we implement this technique for comparison
with the results and performances obtained by the GDM.

4.2.3 Gradient descent method

We ﬁrst numerically compute one-sided variations of the cost using (10). Then,
we use the classical gradient descent method [3] to ﬁnd the optimal control
strategy and to compute the optimal velocity that ﬁts the given outﬂow proﬁle,
as described in Algorithm 1.

15

Algorithm 1 Algorithm for the gradient descent and computation of the optimal
control

Input data: Initial and boundary condition for the PDE and initial velocity
Fix a step tolerance  and ﬁnd a suitable step size α
while |Ji+1 − Ji| ≤  do

Compute numerically cost variations ∇Ji
Update the optimal velocity vi+1 = vi − α∇Ji
Compute the new densities using Godunov scheme
Compute the new value of the cost functional

end while

4.3 Simulations
We set the following parameters: L = 1, J = 100, T = 15.0, ρcr = 0.5, ρmax =
1, vmin = 0.5, vmax = 1.0. Moreover, the input ﬂux at the boundary of the
domain is given by In = min (0.3 + 0.3 sin(2πtn), 0.5). We choose two diﬀerent
target ﬂuxes f∗ = 0.3 and f∗ = |(0.4 sin(tπ − 0.3))|. The initial condition is a
constant density ρ(0, x) = 0.4. We use oscillating inﬂows to represent variations
in typical inﬂow of urban or highway networks at the 24h time scale.

4.3.1 Test I: Constant Outﬂow

In Figure 6, we show the time-varying speed obtained by using the instanta-
neous policy (left) and by using the gradient descent method (right). In each
case, we notice that due to the oscillating input signal the control policy is
also oscillating. We are aware, however, that from a practical point of view,
the solution where the speed changes at each time step might be unfeasible.
Nonetheless, these policies can be seen as periodic change of maximal speed for
diﬀerent time frames during the day when the time horizon is scaled to the day
length.
In Table 1, we see the diﬀerent results obtained for the cost functional

Figure 6: Speed obtained by using the instantaneous policy (left) and the gra-
dient descent method (right) for a target ﬂux f∗ = 0.3.

computed at the ﬁnal time for the diﬀerent policies. For comparison, we also
put the results of the simulations with a constant speed equal to the minimum
and maximal velocity bounds. The instantaneous policy is outperformed by
the random exploration policy and by the gradient method. For the random
exploration policy, in the table we put the minimal value of the cost functional

16

Method

Cost Functional

Fixed speed v = vmax = 1.0
Fixed speed v = vmin = 0.5

Instantaneous policy

Minimum of random exploration policy

Gradient method

873.0786
785.2736
850.3704
723.6733
735.0565

Table 1: Value of the cost functional for the diﬀerent policies.

computed by the algorithm. In Figure 7 we can see the distribution of the dif-
ferent values of the cost functional over 1000 simulations. Moreover, in Figure
8, we can see the diﬀerences between the actual outﬂow obtained and the target
one for all methods. We also compared the CPU time for the diﬀerent simula-

Figure 7: Histogram of the distribution of the value of the cost functional for
the random exploration policy. We run 1000 diﬀerent simulations.

tions approaches (see Table 2). As expected, the random exploration policy is
the least performing while the instantaneous policy is the fastest one.In addi-
tion, we computed the TV(v) for each one of the policies obtaining the following
results:

• IP: TV(v) = 12.6904
• RE: TV(v) = 753.5
• GDM: TV(v) = 70.81333.

Method

CPU Time (s)

Instantaneous policy

Random exploration policy

Gradient method

32.756
7577.390
1034.567

Table 2: CPU Time for the simulations performed with the diﬀerent approaches.

17

Figure 8: Diﬀerence between the real outgoing ﬂux and the target constant ﬂux,
computed with the instantaneous policy (top, left), the gradient method (top,
right) and the random exploration policy (bottom).

4.3.2 Test II: Sinusoidal Outﬂow

In Figure 9, we show the optimal velocity obtained by using the instantaneous
policy and by using the gradient descent method with a sinusoidal outﬂow. We
show in Figure 10 the histogram of the cost functional obtained for the random
exploration policy and in Figure 11 we compare the real outgoing ﬂux with
the target one.
In Table 3, diﬀerent results obtained for the cost functional
computed at ﬁnal time for the diﬀerent policies are shown. Also in this case the
instantaneous policy is outperformed by the other two. The CPU times give
results similar to the previous test.

Method

Fixed speed v = vmax = 1.0
Fixed speed v = vmin = 0.5

Instantaneous policy

Minimum of random exploration policy

Gradient method

Cost Functional

1.3979e + 03

843.3395
458.8874
303.8327
307.6889

Table 3: Value of the cost functional for the diﬀerent policies.

18

Figure 9: Speed obtained by using the instantaneous policy (left) and the gra-
dient descent method (right) for a sinusoidal target ﬂux.

Figure 10: Histogram of the distribution of the value of the cost functional for
the random exploration policy. We run 1000 diﬀerent simulations.

5 Conclusions

In this work, we studied an optimal control problem for traﬃc regulation on a
single road via variable speed limit. The traﬃc ﬂow is described by the LWR
model equipped with the Newell-Daganzo ﬂux function. The optimal control
problem consists in tracking a given target outﬂow in free ﬂow conditions. We
proved tje existence of a solution for the optimal control problem and provided
explicit analytical formulas for cost variations corresponding to needle-like vari-
ations of the control policy. We proposed three diﬀerent control policies design:
instantaneous depending only on the instantaneous downstream density, random
simulations and gradient descent. The latter, based on numerical simulations
for the cost variation, represents the best compromise between performance,
computational cost and total variation of the control policy.
Future works will include the study of this problem in case of congestion and
the extension to second order traﬃc ﬂow models.

19

Figure 11: Diﬀerence between the real outgoing ﬂux and the target sinusoidal
ﬂux, computed with the instantaneous policy (top, left), the gradient method
(top,right) and the random exploration policy (bottom).

we get:

(cid:16)

ϕ2(s)

(cid:17)

(cid:105)

ds

=

0

0+

lim

∆t→0+

1
∆t

1
∆t

lim

∆t→0+

ψ(x(s) − β∆t) − ψ(x(s))

(cid:82) s
0 ϕ(σ)dσ and ¯t by(cid:82) ¯t

Appendix
Lemma 3 Let α, β > 0, ϕ, ψ ∈ BV([0, L], R), ϕ > 0, deﬁne x(s) = L −
0 ϕ(σ)dσ = L−α∆t. Using the change of variable s → x(s)
(cid:104)(cid:90) ¯t
(cid:104)(cid:90) L
(cid:104)(cid:90) ¯t
(cid:90) α∆t
(cid:90) L
(cid:90) α∆t

Proof. The change of variable s → x(s) inside the integral gives

ψ(x(s) − β∆t) − ψ(x(s))

ψ(x − β∆t) − ψ(x)

ψ(x − β∆t) − ψ(x)

ψ(x − β∆t) − ψ(x)

1
∆t
− 1
∆t

(cid:17)
(cid:17)

lim

∆t→0+

lim

∆t→0+

lim

∆t→0+

ϕ2(s(x))

(cid:16)

(cid:16)

ϕ(s(x))

(cid:17)

(cid:105)

dx

.

ds =

dx =

(cid:17)

dx−

ϕ(s(x))

(23)

(24)

ϕ2(s)

0

L

(cid:16)

(cid:16)

(cid:16)

(22)

0+

1
∆t

1
∆t

lim

∆t→0+

ϕ(s(x))

ψ(x(s) − β∆t) − ψ(x(s))

dx.

(cid:17)

0+

20

part. By integrating ψx, we write ψ = ˜ψ +(cid:80)
function, mi > 0, (cid:80)

Observe that we need to specify the 0+ extremum in the integral, since the limit
will provide Dirac terms inside the integral. We want now prove that the last
addendum tends to zero. Denote by ψx the distributional derivative of ψ, which
is a measure, and decompose it as in the continuous (AC+ Cantor) and Dirac
i miχ[xi,L], with ˜ψ a continuous
i mi < +∞ and xi ∈ [0, L] . Hence, by the mean value
(cid:90) α∆t
(cid:12)(cid:12)(cid:12) ˜ψ(˜x − β∆t) − ˜ψ(˜x)
(cid:12)(cid:12)(cid:12) = 0,

(cid:12)(cid:12)(cid:12) ˜ψ(x(s) − β∆t) − ˜ψ(x(s))

theorem applied to ˜ψ, we have

1
∆t
(cid:107)ϕ(cid:107)∞α

(cid:12)(cid:12)(cid:12)dx ≤

ϕ(s(x))

∆t→0+

(25)

lim

lim

0+

∆t→0+

where ˜x ∈ (0, α∆t) is a point (depending on ∆t) and the limit is zero as a
consequence of the continuity of ˜ψ. The remaining term in (24) is then

ψn(x − C∆t) − ψn(x)

dx =

(cid:17)

(cid:17)

ϕ(x)

ψn(x − C∆t) − ψn(x)

dx+

(cid:17)

+

ϕ(x)

ψn(x − C∆t) − ψn(x)

dx =

a

ϕ(x)

(cid:90) b
(cid:16)
(cid:90) xi+C∆t
(cid:16)

xi

1
∆t

N (n)(cid:88)
(cid:90)

i=1

lim

∆t→0+

lim

∆t→0+

1
∆t

(cid:16)

Ic

21

(cid:88)

(cid:90) α∆t
(cid:88)

0+

(cid:88)

mi.

xi∈(0,α∆t]

lim

∆t→0+

1
∆t

ϕ(s(x))

xi∈(0,α∆t]

mi(χ[xi−β∆t,L] − χ[xi,L]) dx =

1
∆t

lim

∆t→0+

Since ψ is in BV the quantity(cid:80)

xi∈(0,α∆t]

ϕ(s(xi)−)miβ∆t ≤ lim
∆t→0+

β(cid:107)ϕ(cid:107)∞

xi∈(0,α∆t] mi tends to zero as ∆t tends to zero,
(cid:3)

a

lim

ϕ(x)

(cid:17)

(cid:16)

1
∆t

∆t→0+

(cid:90) b

dx = −C

ϕ(x+)dψx(x),

ψ(x − C∆t) − ψ(x)

thus we conclude.
Lemma 4 Let ϕ, ψ ∈ BV([a − ε, b + ε], R), then

where the integral in the right hand side is deﬁned in Deﬁnition 2.1.

(cid:90) b
Proof. We decompose the measure ψx as ψx = (cid:96) dλ +(cid:80)
(cid:80)
i miδxi, where λ is the
Lebesgue measure, (cid:96) the Radon-Nikodym derivative of ψx w.r.t. λ, mi > 0 and
i mi < +∞. We approximate ψ by piecewise continuous functions ψn deﬁned
(cid:80)
i≤N (n) miδxi, where N (n) is chosen such that
that for x ∈ [xi, xi + C∆t] we have ψn(x − C∆t) − ψn(x) = −mi −(cid:82) x
while on Ic there are no jumps so ψn(x − C∆t) − ψn(x) = −(cid:82) x

i>N (n) mi < 1
n .
i=1 [xi, xi + C∆t] and by Ic its complement in [a, b]. Notice
x−C∆t (cid:96) dλ
x−C∆t (cid:96) dλ. We

x = (cid:96) dλ +(cid:80)

Deﬁne I(n) = ∪N (n)

as the integrals of ψn

(26)

a

thus can write:

(cid:90) xi+C∆t

xi

(−mi)

= lim

∆t→0+

Since ϕ is in BV we can write:

1
∆t

(cid:90) b

a

i=1

N (n)(cid:88)
(cid:16)
(cid:90) b

ϕ(x)dx − 1
∆t

(cid:17)

(cid:16) N (n)(cid:88)

= −

ϕ(x+)d

miδxi + (cid:96)λ

lim

∆t→0+

1
∆t

ϕ(x)

ψn(x− C∆t)− ψn(x)

dx = −

ψn(x − C∆t) − ψ(x − C∆t)

a

a

a

a

a

ϕ

=

∆t

∆t

ϕ(x)

(cid:17)

(cid:90) b

(cid:90) b

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1

dx − 1
∆t

dψx, which gives us

(cid:16)
(cid:90) b

(cid:16)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1

i=1
Now, the following estimates hold:
ψn(x − C∆t) − ψn(x)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1
We can write ψn(x − C∆t) = ψ(a) +(cid:82) x−C∆t
(cid:82) x−C∆t
(cid:16)(cid:90) x−C∆t
(cid:17)
(cid:16) −
(cid:90) x
The last inequality holds true because(cid:82) x
(cid:80)

(cid:90) b
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:90) b

ψn(x − C∆t) − ψn(x)

dx − 1
∆t

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1

(cid:90) x

(cid:90) b

i miχ[xi,xi+C∆t]. Thus we get:

x−C∆t

1
∆t

(cid:16)

ϕ(x)

ϕ(x)

ϕ(x)

≤

∆t

∆t

=

a

a

a

a

a

where rn = ψ − ψn. Taking the limit for ∆t → 0+:

∆t
(cid:107)ϕ(cid:107)∞
(cid:16)

ϕ

(cid:90) b

ψ(x − C∆t) − ψ(x)dx

lim

∆t→0+

1
∆t

a

(cid:90) b

. Let us now estimate the quantity

(cid:90) b
Recalling that ψn(x − C∆t) = ψ(a) +(cid:82) x−C∆t
(cid:82) x−C∆t

ϕ(x+)dψn

x −

a

a

a

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

miϕ(x+)−

ϕ(x)d((cid:96)λ)

dx

a

a

a

dx

dx

drn

dψn

ϕ(x)

ϕ(x)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:17)

(cid:17)

(cid:17)

(cid:17)

= −

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12),

drn −

ϕ(x+)dψn
x

ψn(x) − ψ(x)

ψ(x − C∆t) − ψ(x)

ψ(x − C∆t) − ψ(x)

(cid:17)
(cid:90) b
(cid:17) −(cid:16)
x and ψ(x − C∆t) = ψ(a) +
(cid:90) x
(cid:90) b
(cid:16)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤
(cid:17)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ (cid:107)ϕ(cid:107)∞
x−C∆t drn =(cid:80)
(cid:17)
= O(cid:16) 1
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12).
(cid:17)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ (cid:107)ϕ(cid:107)∞

x and ψ(x − C∆t) = ψ(a) +

(cid:82) x
(cid:90) b

x−C∆t dδxi =

ϕ(x+)dψn
x

ϕ(x+)dψx

x−C∆t

drndx

(cid:17)

i mi

dψn

drn

1
n

1
n

dx

+

n

miδxi

a

a

.

.

dx

(cid:16) (cid:88)

i≥N (n)

ϕ(x+)d

dψx we get(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:90) b

a

a

(cid:3)

ϕ(x)

(cid:96) dλ dx. (27)

(cid:90) x

x−C∆t

(cid:90) b

a

(cid:90) b
N (n)(cid:88)
(cid:90) b
(cid:16)

i=1

a

Passing to the limit in n we conclude.

22

References

[1] A. Alessandri, A. Di Febbraro, A. Ferrara, and E. Punta. Optimal control
of freeways via speed signalling and ramp metering. Control Engineering
Practice, 6:771–780, 1998.

[2] A. Alessandri, A. Di Febbraro, A. Ferrara, and E. Punta. Nonlinear opti-
mization for freeway control using variable-speed signaling. IEEE Trans-
actions on vehicular technology, 48(6):2042–2052, 1999.

[3] G. Allaire. Numerical analysis and optimization. Oxford university press,

2007.

[4] Luigi Ambrosio, Nicola Fusco, and Diego Pallara. Functions of bounded
variation and free discontinuity problems, volume 254. Clarendon Press
Oxford, 2000.

[5] M. K. Banda and M. Herty. Adjoint IMEX-based schemes for control
problems governed by hyperbolic conservation laws. Computational opti-
mization and applications, 51(2):909–930, 2010.

[6] A. Bressan. Hyperbolic systems of conservation laws: the one-dimensional

Cauchy problem. Oxford university press, 2000.

[7] A. Bressan and B. Piccoli. Introduction to the mathematical theory of con-
trol. American Institute of Mathematical Sciences (AIMS), Springﬁeld,
MO, 2007.

[8] G. Bretti, R. Natalini, and B. Piccoli. Fast algorithms for a traﬃc ﬂow
model on networks. Discrete and Continuous Dynamical Systems - Series
B, 6(3):427–448, 2006.

[9] C. Canudas De Wit. Best-eﬀort highway traﬃc congestion control via
variable speed limits. In 50th IEEE Conference on Decision and Control
and European Control Conference, 2011.

[10] R. C. Carlson, I. Papamichail, M. Papageorgiou, and A. Messmer. Opti-
mal motorway traﬃc ﬂow control involving variable speed limits and ramp
metering. Transportation Science, 44:238–253, 2010.

[11] R. M. Colombo and P. Goatin. A well posed conservation law with a
variable unilateral constraint. J. Diﬀerential Equations, 234(2):654–675,
2007.

[12] A. Csik´os, I. Varga, and K. Hangos. Freeway shockwave control using ramp
metering and variable speed limits. In 21st Mediterranean Conference on
Control & Automation, pages 1569–1574, 2013.

[13] C.F. Daganzo. The cell transmission model: A dynamic representation of
highway traﬃc consistent with the hydrodynamic theory. Transportation
Research Part B, 28:269–287, 1994.

[14] J. R. Dom´ıngeuz Frejo and E. F. Camacho. Global versus local MPC algo-
rithms in freeway traﬃc control with ramp metering and variable speed lim-
its. IEEE Transactions on intelligent transportation systems, 13(4):1556–
1565, 2012.

23

[15] C. Donadello and A. Marson. Stability of front tracking solutions to the ini-
tial and boundary value problem for systems of conservation laws. Nonlin-
ear Diﬀerential Equations and Applications NoDEA, 14(5):569–592, 2007.

[16] Lawrence C. Evans and Ronald F. Gariepy. Measure Theory and Fine

Properties of Functions. CRC, 1991.

[17] A. F¨ugenschuh, M. Herty, A. Klar, and A. Martin. Combinatorial and
continuous model for the optimization of traﬃc ﬂows on networks. SIAM
Journal on optimization, 16(4):1155–1176, 2006.

[18] M. Garavello and B. Piccoli. Traﬃc ﬂow on networks, volume 1 of AIMS
Series on Applied Mathematics. American Institute of Mathematical Sci-
ences (AIMS), Springﬁeld, MO, 2006. Conservation laws models.

[19] M. Giles and S. Ulbrich. Convergence of linearized and adjoint approxi-
mations for discontinuous solutions of conservation laws. Part 2: Adjoint
approximations and extensions. SIAM Journal on Numerical Analysis,
48(3):905–921, 2010.

[20] P. Goatin, S. G¨ottlich, and O. Kolb. Speed limit and ramp meter control

for traﬃc ﬂow networks. Engineering Optimization, 2015, to appear.

[21] S. K. Godunov. A ﬁnite diﬀerence method for the numerical computa-
tion of discontinuous solutions of the equations of ﬂuid dynamics. Mathe-
maticheckii Sbornik, 47:271–290, 1959.

[22] M. Gugat, M. Herty, A. Klar, and Leugering. Optimal control for traﬃc
ﬂow networks. Journal of optimization theory and applications, 126(3):589–
616, 2005.

[23] A. Hegyi, B. De Schutter, and J. Hellendoorn. Model predictive control for
optimal coordination of ramp metering and variable speed limits. Trans-
portation Research Part C, 13(3):185–209, 2005.

[24] A. Hegyi, B. De Schutter, and J. Hellendoorn. Optimal coordination of
variable speed limit to suppress shock waves. IEEE Transactions on intel-
ligent transportation systems, 6(1):102–112, 2005.

[25] A. Hegyi and S. P. Hoogendoorn. Dynamic speed limit control to resolve
shock waves on freeways - Field test results of the SPECIALIST algorithm.
In 13th International IEEE Annual conference on Intelligent Transporta-
tion Systems, pages 519–524, 2010.

[26] A. Hegyi, S. P. Hoogendoorn, M. Schreuder, and H. Stoelhorst. The ex-
pected eﬀectivity of the dynamic speed limit algorithm SPECIALIST - a
ﬁeld data evaluation method. In Proceedings of the European Control Con-
ference, pages 1770–1775, 2009.

[27] A. Hegyi, S. P. Hoogendoorn, M. Schreuder, H. Stoelhorst, and F. Viti.
SPECIALIST: A dynamic speed limit control algorithm based on shock
wave theory. In Proceedings of the 11th International IEEE Conference on
Intelligent Transportation Systems, pages 827 – 832, 2008.

24

[28] Z. Hou, J.-X. Xu, and H. Zhong. Freeway traﬃc control using iterative
learning control-based ramp metering and speed signaling. IEEE Transac-
tions on vehicular technology, 56(2):466–477, 2007.

[29] D. Jacquet, M. Krstic, and C. Canudas De Wit. Optimal control of scalar
one-dimensional conservation laws. In Proceedings of the 2006 American
Control Conference, pages 5213–5218, 2006.

[30] S. N. Kruˇzhkov. First order quasilinear equations with several independent

variables. Mathematicheckii Sbornik, 81(123):228–255, 1970.

[31] M. J. Lighthill and G. B. Whitham. On kinematic waves. II. A theory
of traﬃc ﬂow on long crowded roads. Proc. Roy. Soc. London Ser. A,
229:317–346, 1955.

[32] J. Reilly, W. Krichene, M. L. Delle Monache, S. Samaranayake, P. Goatin,
and A. M. Bayen. Adjoint-based optimization on a network of discretized
scalar conservation law PDEs with applications to coordinated ramp me-
tering. Journal of optimization theory and applications, 167(2):733–760,
2015.

[33] P. I. Richards. Shock waves on the highway. Operations Research, 4:42–51,

1956.

[34] S. Ulbrich. A sensitivity and adjoint calculus for discontinuous solutions of
hyperbolic conservation laws with source terms. SIAM Journal on control
and optimization, 41(3):740–797, 2002.

[35] S. Ulbrich. Adjoint-based derivative computations for the optimal control
of discontinuous solutions of hyperbolic conservations laws. Systems and
control letters, 48(3):313–328, 2003.

[36] X. Yang, Y. Lin, Y. Lu, and N. Zou. Optimal variable speed limit con-
trol for real-time freeway congestions. In Procedia Social and Behavioral
Sciences, editors, 13th COTA International Conference of Transportation
Professionals (CICTP 2013), volume 96, pages 2362–2372, 2013.

25

