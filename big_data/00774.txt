6
1
0
2

 
r
a

M
2

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
4
7
7
0
0

.

3
0
6
1
:
v
i
X
r
a

SPACES GENERATED BY PRODUCTS OF EISENSTEIN SERIES

MARTIN DICKSON AND MICHAEL NEURURER

Abstract. We show, for levels of the form N = paqbN ′ with N ′ squarefree, that in weights k ≥ 4
every cusp form f ∈ Sk(N ) is a linear combination of products of certain Eisenstein series of lower
weight. In weight k = 2 we show that the forms f which can be obtained in this way are precisely
those in the subspace generated by eigenforms g with L(g, 1) 6= 0.

1. Introduction

The space Mk(N, χ) of modular forms of level Γ0(N ), weight k and nebentypus χ splits into the
direct sum of the Eisenstein subspace Ek(N, χ) and the space of cusp forms Sk(N, χ). It is straight-
forward to compute Fourier expansions and Hecke eigenforms in the Eisenstein subspace, but the
space of cusp forms is far more mysterious, and any method of generating cusp forms is therefore
of great interest. In this article we examine one of the simplest methods of generating cusp forms:
What is the subspace of Sk(N, χ) generated by (the cuspidal projection of) products of Eisenstein
series of lower weight?

For N = 1 the answer to this question is very well-known: the graded ring1 ⊕k≥0Mk(1) is a poly-
nomial ring with two generators, one in degree four and one in degree six, corresponding to the
Eisenstein series E4 and E6. This means that every cusp form of level N = 1 is a linear combination
of products of Eisenstein series. However the number of products required to form the monomials
in E4 and E6 for these linear combinations grows linearly with the weight k, which means these
monomials are rather complicated.
It is therefore natural to ask whether one can have simpler
products at the expense of taking more Eisenstein series. Pushing this to the extreme we are led
to ask: What is the subspace of Sk(N, χ) generated by (the cuspidal projection of) products of two
Eisenstein series of lower weight?

Using the Rankin–Selberg method (as observed in [14] §5) one can show that, for k ≥ 8, Mk(1) can
be generated by the products ElEk−l for 4 ≤ l ≤ k − 4. Similar statements are known to hold for
Mk(p) for p prime and k ≥ 4 (see Imago¯glu–Kohnen [4] for p = 2, Kohnen–Martin [5] for p > 2).
Recently Raum [10] has proven a diﬀerent, rather general result: Let k ≥ 12 be an integer, let ρ
be a representation of SL2(Z) on a complex vector space V such that ker(ρ) contains a congruence
subgroup, and deﬁne Mk(ρ) to be the space of V -valued functions transforming as modular forms
for the automorphy factor γ 7→ (cz + d)−kρ(γ−1). Then

Mk(ρ) = Ek(ρ) + spanφ:ρM ⊗ρM ′ →ρ (TM El ⊗ TM ′Ek−l) ,

(1)

where 4 ≤ l ≤ k − 4, ρM is the permutation representation on Γ0(M )\ SL2(Z), the Ek are cor-
responding vector-valued Eisenstein series, and the TM are certain natural vector-valued Hecke
operators. Finally, let us mention the work of Borisov–Gunnells [3], which uses the theory of toric
varieties to deﬁne an interesting class of modular forms, called “toric modular forms”, which have
simple Fourier expansions and yet generate the full space Mk(N ) for any N . This space of toric

Date: Draft of March 3, 2016.
1When χ = 1N is the principal character modulo N we write Mk(N ) for Mk(N, 1N ).

1

modular forms contains certain (linear combinations of) Eisenstein series, and Borisov–Gunnells
show that all cusp forms of suﬃciently high weight are linear combinations of (the cuspidal projec-
tion of) products of two of these Eisenstein series, c.f. [3] Theorem 5.10.

In this paper we study a situation similar to Kohnen–Martin for higher level and non-trivial char-
acter. Thus we work with the space generated by products of the well-known Eisenstein series

σl−1,φ,ψ(n)qn ∈ Mk(M, φψ),

(2)

l

Eφ,ψ

(z) = eφ,ψ

l + 2Xn≥1
Pd|n φ(n/d)ψ(d)dl−1, and the constant term eφ,ψ

l

where φ (resp. ψ) is a primitive characters of level M1 (resp. M2), M1M2 = M | N , σl−1,φ,ψ(n) =
(either zero or a value of a Dirichlet L-function)

is uniquely determined by the modularity of Eφ,ψ
. We also use the images of these Eisenstein series
under the lifting operator Bd, which acts on modular forms of weight k by f |Bd(z) = d
2 f (dz). In
contrast to the set-ups of Raum and Borisov–Gunnells, our space of products is not a priori closed
under the action of good Hecke operators, which complicates the matter. On the other hand, there
are advantages to generating cusp forms directly from these standard Eisenstein series which we
brieﬂy discuss below.

k

l

In order to state our main result, when the character χ is trivial, let us ﬁrst deﬁne our space of
generating products more precisely. Let k ≥ 2 be even, and ﬁx a positive integer N . Let T be the

set of primes p such that vp(N ) = 1, and write NT =Qp∈T p. We then deﬁne Qk(N ) ⊂ Mk(N ) to

be the subspace generated by the products

Eφ,ψ

l

|Bd1Eφ,ψ

k−l|Bd2

for all all l ∈ {1, . . . , k − 1}, all primitive characters φ, ψ modulo all M1, M2, and all integers d1, d2
such that the following conditions are satisﬁed:

φψ(−1) = (−1)l,
(φ, ψ, l) 6= (1, 1, 2), (1, 1, k − 2),

d1M1d2M2 | N,
d1M1 | NT .

(3)

The ﬁrst three conditions are quite natural for deﬁning a subspace of Mk(N ). The fourth condition,
and the overall shape of our products, is due to the fact that Qk(N ) is closely related to a space
Pk(N ) (deﬁned in §4) formed by taking the image under the partial Atkin–Lehner operators of
products of Eisenstein series supported at ∞. Our main result is:
Theorem 1.1. Let k ≥ 4 be even. Let N = paqbN ′ where a, b ∈ Z≥0 and N ′ is squarefree, and let
Qk(N ) = ∪N0d|N Qk(N0)|Bd be the subspace of Mk(N ) generated by lifts of the spaces of products
deﬁned above. Then the restriction of the cuspidal projection to Qk(N ) is surjective, i.e.

Mk(N ) = Qk(N ) + Ek(N ).

The case of weight 2 is diﬀerent: Indeed, one sees immediately from the Rankin–Selberg method
that the products of Eisenstein series are orthogonal to every newform f with vanishing central
L-value, i.e. L(f, 1) = 0. Accordingly we deﬁne the space S2,rk=0(N ) to be generated by newforms
and lifts of newforms with non-zero central L-value. We obtain the analogue of Theorem 1.1 subject
to this constraint.

Theorem 1.2. Let N and Q2(N ) be as in Theorem 1.1. Then

S2,rk=0(N ) ⊕ E2(N ) = Q2(N ) + E2(N ).

2

This phenomenon of isolating S2,rk=0(N ) is also observed by Borisov–Gunnells [2].

We develop much of the theory to allow for more general level than N = paqbN ′ and will discuss
this restriction for the level N below. We also point out how similar results can be obtained when
the character χ is non-trivial by proving the analogue of Theorem 1.2 for S2(p, χ), see Theorem 4.5.
Before we give an idea for the proof of the theorems we give a few explicit examples, and highlight
some of the applications of such an expression for a newform:

(1) N = 1, k = 12: The most well-known example is of course the discriminant modular form,

which in our normalisation becomes

∆ =

50
3

E 1,1
4 E 1,1

8 −

147
4

(E 1,1

6

)2.

(2) N = 11, k = 2: Let φ be the character modulo 11 that maps 2 to ζ10 and ψ the character

that maps 2 to ζ 3

10. Let f ∈ S2(11) be the unique newform in this space, then

f =

1
5

(−2ζ 3

10 + 2ζ 2

10 −

1
4

)E 1,φ

1 E 1,φ

1 +

1
5

(2ζ 3

10 − 2ζ 2

10 −

9
4

)E 1,ψ

1 E 1,ψ

1

.

(3) N = 32, k = 2: Let χ4 be the primitive character modulo 4 and α the primitive character
modulo 32 that maps 31 to 1 and 5 to ζ8. Let f ∈ S2(32, χ4) be the unique newform in this
space, then
1
8

8 + ζ8 − 1)E 1,χ4α

8 )E 1,χ4α2

· E 1,χ4α2

8 + ζ 2

(ζ 3

8 − ζ 2

E 1,χ4α

|B2.

+

(ζ 3

1

1

1

1

f =

1
4

Once established, an expression of a modular form f as a sum of products of Eisenstein series
provides a way of calculating the Fourier expansion of f at ∞. Once such an expression for f
is obtained, O(n log(n)) operations are required to compute n Fourier coeﬃcients of f which is
theoretically best possible,2 and also appears to work well in practice.3 There is, however, a cost:
The most naive implementation involves computation the N th cyclotomic ﬁeld, but it is plausible
that computations in a much smaller ﬁeld are suﬃcient.

Moreover, as mentioned in [10], one can use such expressions to compute Fourier expansions at any
cusp of Γ0(N ). The advantage of working directly with the Eisenstein series in (2) is that their
Fourier expansions at cusps other than ∞ are comparatively easy to obtain and were explicitly
calculated by Weisinger [13]. This is in contrast to the set-up of Borisov–Gunnells, where it is not
straightforward to obtain the expansion at other cusps from the representation of f as a sum of
products (although we remark again that the generating “toric forms” of Borisov–Gunnells have a
remarkably simple expansion at the cusp ∞). When N is not squarefree the Fourier expansions at
certain cusps are somewhat mysterious and diﬃcult to access, yet carry important information. In
future work we hope to use this method study the Fourier expansions at cusps of p-power denomi-
nator explicitly and their relationship to the ﬁner arithmetic and representation-theoretic invariants
of f .

Similarly, [13] also describes the action of the Atkin–Lehner operators on Eisenstein series, so once
one has an explicit representation of a newform f as a linear combination of Eisenstein series it
is straightforward to compute the Atkin–Lehner eigenvalues and the root number of f . This fur-
nishes another example of an important datum which cannot immediately be read from the Fourier
expansion of f at ∞ when the level is not squarefree.

2We thank A. Booker for pointing this out.
3See http://mathoverflow.net/q/221781/ for an example computed by D. Loeﬄer

3

k

k

k

(N ) cuts out a proper subspace, we may pick f ∈ S new

Let us now give a sketch of the method to prove Theorem 1.1 (the proof of Theorem 1.2 requires
minor modiﬁcation). As hinted above, we argue for the most part with the space Pk(N ), and in §5
we show that Pk(N ) has the same projection to S new
(N ) as Qk(N ). If the projection of Pk(N ) to
S new
(N ) orthogonal to Pk(N ). A standard
k
application of the Rankin–Selberg method (§4) allows one to see that, if a newform f is orthogonal
to Pk(N ), then all the critical L-values L(fψ|W N M
, j) must vanish (except for some cases when
j = 2, k − 2, when the technical diﬃculties coming from weight two Eisenstein series enter). How-
ever, since our Pk(N ) (or Qk(N )) might not be closed under the good Hecke operators, an element
G of S new
(N ) orthogonal to Pk(N ) will in general be a sum of newforms. On the other hand, our
space Pk(N ) will, by ﬁat, be closed under the action of the partial Atkin–Lehner operators W N
for
ℓ
ℓ ∈ T (where T is the set of primes ℓ with vℓ(N ) = 1), and so we can at least assume that such a
G is an eigenfunction of all these operators. Moreover we can modify G so that the orthogonality
of G to Pk(N ) is equivalent to the vanishing of many twisted L-values of G. We prove a general
statement, possible of independent interest, that if G is a cusp form which is an eigenfunction
of certain Atkin–Lehner operators and for which suﬃciently many twisted L-values vanish, then
G = 0. The argument proceeds via modular symbols, and extends a result of Merel who proves a
similar vanishing criterion in the case when G is a newform.

S

S

The reason the assumption N = paqbN ′ enters is because we want to be in a situation where, if f is
a newform (or a sum of newforms with the same W N
ℓ -eigenvalue for all ℓ ∈ T ) and α is a primitive
character modulo M | N , then the W N M
(pseudo-)eigenvalues of fα for each set of prime divisors
of N/M are determined by those of f . With our methods, this conditon arises naturally in the
proof of Theorem 1.1, and our argument would extend immediately to any situation where it holds.
When N is squarefree this condition is automatic, since the twisting and Atkin–Lehner operators
must commute (c.f. Proposition 2.3). When N is not squarefree this is a much more diﬃcult ques-
tion, and it seems unlikely that a purely local argument will work. Indeed our extension to level
N = paqbN ′ stems from a rather diﬀerent argument using the modular symbols relations, which
allows us to to avoid this condition altogether when the number of prime factors of N is restricted
as above.

k

Let us ﬁnish by remarking that one can easily compute (see §4) a trivial upper bound P for the
dimension dim Qk(N ), the projection Qk(N ) of Qk(N ) to S new
(N ). We compare this to the dimen-
sion dim S new
(N ) in the “squarefree” and “prime-power” level aspects. In both cases the result is
that P grows quicker than dim Sk(N ), although not by much, particularly in the prime-power case.
When k = 2 the problem of reducing the number of products required to generate S new
(N ), or
improving the bound on the upper bound P for the dimension by quantifying the amount of linear
dependency amongst the products generating Qk(N ), is perhaps interesting because of potential
applications to the conjecture of Brumer on the number of newforms of level N for which L(f, 1) 6= 0.

k

k

Acknowledgements. We thank Andrew Booker for asking the oﬀ-the-cuﬀ question that led us to
study this problem, and for helpful remarks. We also thank Winfried Kohnen and Martin Raum
for their comments on an earlier version of this paper.

2. Preliminaries

Let N, k ∈ Z≥1 be a positive integers, and let χ be a Dirichlet character modulo N . We keep the
notations from the introduction for spaces of modular forms; we tacitly assume that χ(−1) = (−1)k

4

since otherwise these spaces are zero. Our normalisation of the slash operator is

(cid:18)f |k(cid:18)a b

c d(cid:19)(cid:19) (z) =

(ad − bc)k/2

(cz + d)k f(cid:18) az + b
cz + d(cid:19) ,

so that scalars act trivially. We write | for |k since the weight k will be clear from the context.

We write 1N for the principal character modulo N , which satisﬁes 1N (n) = 1 for (n, N ) = 1, and
1N (n) = 0 otherwise. We write 1 for the trivial character, which satisﬁes 1(n) = 1 for all n. If χ
is any character modulo N and S is a set of prime divisors of N , then we write χS for the S-part
of χ. For a set S of prime divisors of N and a divisor M of N , we write MS for the S-part of M ,

i.e. Qp∈S pvp(M ). We will also use the notation SM = {p ∈ S; p | M } and S = {p | N ; p prime} \ S

(we will clarify the dependence on N when confusion may arise).

When (p, N ) = 1, we write Tp for the Hecke operators on Mk(N, χ); these are extended multiplica-
tively to Tn for (n, N ) = 1. When q | N we write Uq for the Hecke operators extended from the
operators Up (where p is a prime divisor of N ); the normalisation is

For a set of prime divisors S of N we deﬁne the Atkin–Lehner involution

f |Up = pk/2−1

p−1

Xj=0

f |(cid:18)1 j
0 p(cid:19) .

W N

S =(cid:18)NSx

N z NSw(cid:19) ∈ M2(Z),

y

where y ≡ 1 (mod NS), x ≡ 1 (mod NS) and det W N
sometimes use the notation W N
The following properties of W N

M for W N
S are well-known (see for example [1]):

S with S = {p | M }. We simply write WN for W N

S = NS. If M is a divisor of N , then we

N =(cid:0) 0 1
−N 0(cid:1).

Proposition 2.1.

(i) Let S be a set of prime divisors of N . If

is any matrix with x′, y′, z′, w′ ∈ Z of determinant NS then

M =(cid:18)NSx′

N z′ NSw′(cid:19)

y′

f |M = χS(y′)χS(x′)f |W N
S .

In particular, W N

S does not depend on the choice of x, y, z, w.

(ii) Let f ∈ Mk(N, χ). Then

f |W N

S ∈ Mk(N, χSχS),

and W N

S preserves the subspace of cusp forms.

(iii) If S and S′ are disjoint sets of prime divisors of N , then

We also have

f |W N

S∪S ′ = χS ′(NS )(f |W N

S )|W N
S ′ .

f |W N

S |W N

S = χS(−1)χS(NS)f.

(iv) The adjoint of W N

S on Mk(N, χ) with respect to the Petersson inner product is given by

(v) Let p be a prime divisor of N with p /∈ S. Then

W N,∗

S = χS(−1)χS(NS)W N
S .

f |Up|W N

S = χS(p)f |W N

S |Up.

5

(4)

(5)

By a newform, we mean an element f ∈ Sk(N, χ) which is an eigenfunction of all Hecke operators,
normalised to have ﬁrst Fourier coeﬃcient equal to one. We write S new
(N, χ) for the subspace of
Sk(N, χ) generated by the newforms, so f ∈ S new
(N, χ) is a linear combination of newforms; we
refer to these as elements of the new subspace.

k

k

Let q be a prime divisor of N . On the new subspace there is a close connection between the Hecke
operator Uq and the Atkin-Lehner operator W N
q :

Proposition 2.2. Let χ be a Dirichlet character modulo N and suppose χq is principal. Let f be
a newform of Sk(N, χ) with q-th Fourier coeﬃcient aq and Atkin-Lehner eigenvalue λq(f ).

• If q2 | N then aq = 0.
• If q | N but q2 ∤ N then λq(f ) = −q1− k

2 aq and hence we have the equality of operators

on S new

k

(N, χ).

The third class of operators that play a major role for us are various twisting operators. Let

W N

q = −q− k

2 +1Uq.

f ∈ Sk(N, χ) with Fourier expansion f (z) = Pn≥1 ane(nz), let α be a Dirichlet character modulo

M , and deﬁne

With α, f as above, deﬁne also

fα(z) =Xn≥1

anα(n)e(nz).

Sα(f ) = Xa mod M

α(a)f |k(cid:18)1 a/M
1 (cid:19) .

0

Note that if α is primitive modulo M we have

Sα(f ) = G(α)fα.

(6)

and we see by Fourier inversion that

For any z ∈ H we can view the function n′ 7→(cid:16)f |k(cid:16) 1 n′/N ′
1 (cid:19) = Xα mod N ′

f |k(cid:18)1 n′/N ′

the sum being over all Dirichlet characters modulo N ′.

0

α(n′)
ϕ(N ′)

0

1 (cid:17)(cid:17) (z) as a function F : (Z/N ′Z)× → C×,

Sα(f ),

(7)

Finally we state some standard facts about the commutation relations for the above operators in
the cases we will need them. These can be proved by direct computation (see also [1] §3).

Proposition 2.3. Let N ∈ Z≥1, let f ∈ Mk(N, χ), let α be a Dirichlet character modulo N ′ | N .
Then

Let q be any divisor of N that is coprime to N ′, then

Sα(f ) ∈ Mk(N N ′, χα2).

Sα(f )|Uq = α(q)Sα(f |Uq).

Similarly, if S is a set of prime divisors of N such that NS and N ′ are coprime, then

Sα(f )|W N N ′

S

= α(NS)Sα(f |W N

S ).

6

3. A vanishing criterion for cusp forms

Before we prove the main theorem of this section we recall some facts from the theory of modular
symbols; for details see [7] or [12] §8. Let k be an integer ≥ 2. The space Mk(Γ1(N )) of modular
symbols is generated by the Manin symbols [P, g] where P is a homogeneous polynomial in C[X, Y ]
of degree k − 2, and g ∈ SL2(Z). In fact the Manin symbols [P, g] only depends on P and the coset
Γ1(N )g. By mapping a matrix g to its bottom row modulo N , the cosets of Γ1(N )\ SL2(Z) are in
bijection with the set

EN = {(u, v) ∈ (Z/N Z)2; gcd(u, v, N ) = 1};

see for example [12] Proposition 8.6. Note that gcd(u, v, N ) is well-deﬁned, i.e. does not depend
on the choice of representative of the residue classes u and v. We write [P, (u, v)] = [P, g] for any
g ∈ SL2(Z) with bottom row congruent to (u, v) modulo N . For f ∈ Sk(Γ1(N )) let ξf be the map

ξf ([P, g]) =Z g∞

g0

f (z)(gP )(z, 1)dz,

with g ∈ SL2(Z) acting on C[X, Y ] in the usual way.

Using the generators [X jY k−2−j, (u, v)], where 0 ≤ j ≤ k−2 and (u, v) ∈ EN , we deﬁne ξf (j; u, v) =
ξf ([X j Y k−2−j, (u, v)]). Using the modular symbol relations, we obtain the relations

ξf (j; u, v) + (−1)j ξf (k − 2 − j; v, −u) = 0,

k−2−j

ξf (j; u, v) +

(−1)k−2−i(cid:18)k − 2 − j
Xi=0
(−1)i(cid:18)
Xi=k−2−j

(cid:19)ξf (i; v, −u − v)
i − k + 2 + j(cid:19)ξf (i; −u − v, u) = 0,

k−2

j

i

+

ξf (j; u, v) − (−1)k−2ξf (j, −u, −v) = 0,

(8)

(9)

(10)

There is an involution ι of Mk(Γ1(N )), namely ι[X j Y k−2−j, (u, v)] = (−1)j+1[X jY k−2−j, (−u, v)].
Accordingly, we deﬁne

ξ±
f (j; u, v) :=

ξf (j; u, v) ± (−1)j+1ξf (j; −u, v)

2

.

The relations (8), (9), and (10) hold because of a relation on the underlying Manin symbols, see [12]
§8.2.1. One can apply ι to these relations for the Manin symbols to obtain another set of relations.
Applying ξf and adding or subtracting as appropriate, we see that (8), (9), and (10) hold for ξ
replaced by ξ±
f .

By [7] Proposition 8 the maps f 7→ ξ+
do. Note also that the ξf (j; u, v) are related to critical values of L-functions:

f are injective, so f vanishes if all ξ±

f and f 7→ ξ−

f (j; u, v)
Indeed, taking

g =(cid:0) a b

c d(cid:1) ∈ SL2(Z) with (c, v) ≡ (u, v) mod N we have

j!

ξf (j; u, v) =

(−2πi)j+1 L(f |g, j + 1).

(11)

The main goal of this section is to prove Theorem 3.2, which is a vanishing criterion for f in terms
of vanishing of certain twisted L-functions. The result is in the spirit of Corollaire 2 of [8], although
we require some modiﬁcations since we do not assume that f is a newform, or even an eigenfunction
of almost all Hecke operators. First we recall an identity from the proof of Proposition 6 in [8]:

7

Lemma 3.1. Let N ∈ Z≥1, let (u, v) ∈ EN , let S denote the set of prime divisors of N which
divide u, let S denote the remaining prime divisors of N , and let N ′ be the order of uv in Z/N Z.

Let g =(cid:0) a b

c d(cid:1) ∈ SL2(Z) be such that (c, d) ≡ (u, v) mod N . Then
1(cid:19)(cid:18)A B

NS(cid:19)−1
where n is chosen so that n ≡ uv mod NS and n ≡ −uv mod NS, and (cid:18)A B

Γ1(N )g = Γ1(N )(cid:18) 0 −1

C D(cid:19)(cid:18)N N ′

N 0 (cid:19)(cid:18)1

n
N

0

0

0

S

S, A ≡ uN ′

S mod NS, B ≡ v/NS mod NS, and NSN ′

S | A, NSN ′

,

AD − BC = NSN ′
NSN ′
S

| B.

C D(cid:19) ∈ Z2×2 has

S | D, N N ′ | C,

The existence of A, B, C, D follows from the Chinese Remainder Theorem. We omit the proof of
this identity, which is simply a matter of checking that the matrix on the right hand side is integral
with determinant one and with bottom row congruent to (u, v) modulo N (whence the conditions
on A, B, C, D).

Let N be a positive integer and let T be the set of prime divisors p of N with vp(N ) = 1, so

where the exponents vp(N ) for p ∈ T are all greater than 1.

N = Yp∈T

pYp∈T

pvp(N ),

Theorem 3.2. Let N ∈ Z≥1, k ≥ 2, and let f ∈ S new
(N ) be an eigenfunction of all partial
Atkin–Lehner operators W N
, j + 1) = 0 for
p
all characters α primitive modulo M | N , all j = 0, 1, ..., k − 2 such that α(−1) = (−1)j+1 (resp.
α(−1) = (−1)j), and all sets S ⊆ T of prime divisors p that divide N

for p ∈ T , with T as above. Assume that L(fα|W N M

S

k

M . Then f = 0.

Proof. We will present the argument for the case α(−1) = (−1)j+1, which uses the function ξ+. The
other case, using ξ−, is almost idential, the only diﬀerence being which characters cancel in (14).
We will show that the conditions in the theorem imply ξ+
(j; u, v) = 0 for all j = 0, 1, ..., k − 2
and (u, v) ∈ EN , which in turn imples f = 0. Let us therefore ﬁx (u, v) ∈ EN and consider
ξ+
(j; u, v). As in the statement of Lemma 3.1, let S be the set of those prime divisors of N that
f |WN
divide u and write N ′ for the order of uv in Z/N Z. Note that every prime in S divides N
N ′ . Choose

f |WN

g =(cid:0) a b

c d(cid:1) ∈ SL2(Z) such that (c, d) ≡ (u, v) mod N . By Lemma 3.1 we have
NS(cid:19)−1

Γ1(N )g = Γ1(N )(cid:18) 0 −1

C D(cid:19)(cid:18)N N ′

N 0 (cid:19)(cid:18)1

1(cid:19)(cid:18)A B

n
N

0

0

0

S

,

(12)

with A, B, C, D and n satisfying the conditions of the lemma. Since f |WN |WN = f , we have

f |WN |g = f |(cid:18)1

0

n
N

1(cid:19)(cid:18)A B

C D(cid:19)(cid:18)N N ′

0

S

0

NS(cid:19)−1

.

Now n ≡ uv mod NS and n ≡ −uv mod NS, so n also has order N ′ modulo N . Hence nN ′ = n′N
for some n′ which is coprime to N ′. Writing this as n/N = n′/N ′ and using (7) we get

f |WN |g = Xα mod N ′

α(n′)
φ(N ′)

Sα(f )|(cid:18)A B

C D(cid:19)(cid:18)N N ′

0

S

8

0

NS(cid:19)−1

,

where α varies over all Dirichlet characters modulo N ′. By Proposition 2.3 we have Sα(f ) ∈
S2(N N ′, α2), and the conditions of Lemma 3.1 together with Proposition 2.1 give

Sα(f )|(cid:18)A B

C D(cid:19) = α2

S(B)α2

S(cid:18) A

NSN ′

S(cid:19) Sα(f )|W N N ′

S

.

Hence, using (11),

ξf |WN (j; u, v)

=

=

j!

(−2πi)j+1φ(N ′)Xα
(−2πi)j+1φ(N ′) Xα

j!(NS /N ′
S)

k
2 −j−1

α(n′)α2

S(B)α2

α(n′)α2

S(B)α2

NSN ′

S(cid:18) A
S(cid:18) A

NSN ′

S(cid:19) L Sα(f )|W N N ′
S(cid:19) L(cid:16)Sα(f )|W N N ′

N N ′
S
0

|  1
, j + 1(cid:17) ,

S

S

where the sum is over all characters modulo N ′.

0
1

NS! , j + 1!

To compute ξf |WN (j; −u, v) we proceed analogously with ˜g = (cid:0) a −b

(−c, d) ≡ (−u, v) mod N . With A, B, C, D, n as in (12) we see that

−c d (cid:1), since this has bottom row

Γ1(N )˜g = Γ1(N )(cid:18) 0 −1

N 0 (cid:19)(cid:18)1 − n

1 (cid:19)(cid:18)−A B

C −D(cid:19)(cid:18)N N ′

0

0

N

S

0

NS(cid:19)−1

.

(13)

The argument is as above, with n′ replaced by −n′, and each individual summand in the ﬁnal
expression for ξf |WN (j; u, v) changes by a factor of α(−1)α2
(−1) = α(−1). From the deﬁnition of
S
ξ+
f |WN

we then see

ξ+
f |WN

(j; u, v) =

k
2 −j−1

j!(NS /N ′
S)

(−2πi)j+1φ(N ′) Xα

α(n′)α2

S(B)α2

S(cid:18) A

NSN ′

S(cid:19) L(cid:16)Sα(f )|W N N ′

S

, j + 1(cid:17) .

(14)

where the sum is over all characters α modulo N ′ with α(−1) = (−1)j+1.

The next step is to relate Sα(f ) to the twist by the primitive character underlying α. The key to
this is the following lemma, which is proved by direct computation:

Lemma 3.3. Let N and k be positive integers, let χ be a Dirichlet character modulo N , and let
f ∈ Sk(N, χ). Let N ′ ∈ Z≥1, let α be a character modulo N ′ with conductor M . Assume that
M < N ′, let p be any prime dividing N ′/M , and let β be the character modulo N ′/p inducing α.
Then

Sα(f ) = p1−k/2Sβ(f |Up)|(cid:18)p 0

0 1(cid:19) − β(p)Sβ(f ).

k

(N ) is an eigenfunction of each W N
p

In our case f ∈ S new
for p ∈ T , so by Proposition 2.2 it is
also an eigenfunction of Up for each p ∈ T . By the same proposition, if p ∈ T then Up is the
zero operator, so f is trivially an eigenfunction of Up in that case. In both cases we denote the
Up-eigenvalue of f by ap. Then Lemma 3.3 gives

and so

Sα(f ) = p1−k/2apSβ(f )|(cid:18)p 0

0 1(cid:19) − β(p)Sβ(f ),

L(Sα(f )|W N N ′

S

, j + 1) = (p−jap − β(p))L(Sβ(f )|W N N ′

S

, j + 1).

Applying this repeatedly we see that L(Sα(f )|W N N ′
where α0 is the the primitive character modulo M | N ′

, j + 1) is a multiple of L(Sα0(f )|W N N ′

, j + 1),
inducing α modulo N ′. Next note

S

S

9

that Sα0(f ) = G(α0)fα0 ∈ Sk(N M, α2
d = ( N ′
L(fα0|W N M

M )S. Thus L(Sα(f )|W N N ′

S

S

, j + 1) = 0 by the conditions we pose on f .

0). We then use Sα0(f )|W N N ′
S

, j + 1) is a multiple of L(fα0|W N M

S

= Sα0(f )|W N M
, j + 1).

|Bd, where
If S ⊆ T , then

S

Now suppose that there is a prime p ∈ S ∩T . Since vp(N ) = 1 and p divides u, we have gcd(p, N ′) =
gcd(p, M ) = 1. Write S = S′ ∪ {p} and α′ = (α0)S ′. By Propositions 2.1 and 2.3 we have

fα0|W N M

S = α′2(p)(fα0|W N M

p

)|W N M

S ′ = α′2(p)α0(p)((f |W N M

p

)α0)|W N M

S ′

.

Since we assume that f is an eigenfunction of W N
ple of L(fα0|W N M
L(fα|W N M
that is disjoint with T . Thus L(fα|W N M

, j + 1) is a multi-
, j + 1). Applying this procedure for every prime p ∈ S ∩ T we deduce that
, j + 1), where S′′ is a set of prime divisors of N/M

, j + 1) is a multiple of L(fα0|W N M

, j + 1) = 0 by the conditions we pose on f .

p we get that L(fα0|W N M

S ′′

S ′

S

S

S

Since ξ+
and hence f = 0.

f |WN

(j; u, v) is a sum of such L-values this shows that ξ+

f |WN

(j; u, v) = 0 for all (u, v) ∈ EN ,

(cid:3)

Theorem 3.2 is valid for all N ∈ Z≥1. Note that Atkin–Lehner operators are used in two diﬀerent
ways: ﬁrst at p ∈ T where we insist f is an eigenfunction, second at S ⊂ T where we insist the L-
values of Atkin–Lehner images of twists vanish. For our applications we will restrict to N = paqbN ′
with N ′ squarefree; a simple trick then allows us to do away with the latter use:

Theorem 3.4. Let N = paqbN ′ where p and q are distinct primes, a, b ∈ Z≥0 \ {1}, and N ′ is
squarefree and coprime to pq. Let k ≥ 2, and let f ∈ S new
(N ) be an eigenfunction of all partial
Atkin-Lehner operators W N
for primes ℓ|N ′. Assume that L(fα, j + 1) = 0 for all characters α
ℓ
primitive modulo M | N and all j = 0, ..., k − 2 with α(−1) = (−1)j+1 (resp. α(−1) = (−1)j).
Then f = 0.

k

Proof. We may assume that a > 1 or b > 1, in particular that the set T ⊆ {p, q} is non-empty,
since otherwise this is just the statement of Theorem 3.2. Let (u, v) ∈ EN .
If no prime of T
divides u then the proof of Theorem 3.2 shows that ξ+
(j; u, v) is a linear combination of the
L-values L(fα, j + 1) so our assumptions give ξ+
v then ξ+
ξ+
f |WN

(j; u, v) = 0. Similarly if no prime of T divides
(k − 2 − j; v, −u) = 0; we can then use the modular symbols relation (8) to see that

(j; u, v) = 0.

f |WN

f |WN

f |WN

Now suppose that both u and v are divisible by a prime in T . By the deﬁnition of EN , it cannot
be the case that the same prime divides both, so we are in the case when a > 1 and b > 1, and we
may assume that p divides u and q divides v. Then the residue class −u − v is divisible by neither
p nor q, so ξ+
f (i; −u − v, u) = 0 for all 0 ≤ i ≤ k − 2 by the above. Hence using
(9) we obtain ξf (j; u, v) = 0.
(cid:3)

f (i; v, −u − v) = ξ+

Remark 3.5. More generally, a similar argument to Theorem 3.4 shows that one can restrict the
sets S ⊂ T in Theorem 3.2 to avoid two prescribed elements of T .

A technical diﬃculty arises in our application of Theorem 3.2 when k ≥ 4 due to the fact that the
weight two Eisenstein series with trivial character is not holomorphic. To this end we prove a result
which states that the problematic cases are in fact already a consequence of the other assumptions:

Proposition 3.6. Let N ∈ Z≥1, k ≥ 4 be even and f ∈ S new
(N ). Assume that L(fα, j + 1) = 0
for all primitive characters α modulo M | N where M > 1, and all j = 0, . . . , k − 2 with α(−1) =

k

10

(−1)j+1. Assume moreover that L(f, j + 1) = 0 for all odd j 6= 1, k − 3. Then L(f, 2) = 0 and
L(f, k − 2) = 0 must hold as well.
Proof. As in the proof of Theorem 3.4 we see ξ+
(j; u, v) = 0 so long as j 6= 1, k − 3 and at
least one of gcd(u, N ) = 1 or gcd(v, N ) = 1 holds. First assume k ≥ 6. Applying (9) with j = 2,
(v, −u − v) = (0, 1), using some of the vanishing we just observed, we get

f |WN

Relation (8) with j = 1, (u, v) = (0, 1) gives

−(k − 4)ξ+

f |WN

(1; 0, 1) − 2ξ+

f |WN

(k − 3; 1, 0) = 0.

hence

ξ+
f |WN

(1; 0, 1) − ξ+

f |WN

(k − 3; 1, 0) = 0,

ξ+
f |WN

(1; 0, 1) = 0,

since k ≥ 6. Since ξ+
(1; 0, 1) = ξf |WN (1; 0, 1), (11) gives L(f |WN , 2) = 0, hence L(f, k − 2) = 0.
The other case follows a similar argument, applying (9) with j = 2 and (v, −u − v) = (1, 0) and (8)
with j = 1 and (u, v) = (1, 0) we get ξ+

(k − 3; 0, 1) = 0, hence L(f, 2) = 0.

f |WN

f |WN

For k = 4, apply (9) with j = 0, (v, −u − v) = (0, 1) to get

ξ+
f |WN

(1; 0, 1) =

1

(−2πi)2 L(f, 2) = 0.

4. Generating spaces of cusp forms by products of Eisenstein series

(cid:3)

We begin by recalling the theory of Eisenstein series as developed in [9] §7. Let N ∈ Z≥1, l ∈ Z≥1,
and let φ (resp. ψ) be Dirichlet characters modulo N1 (resp. N2) such that N1N2 = N . We assume

that φ(−1)ψ(−1) = (−1)l, and we extend φ to a character of Γ0(N ) as usual by φ(cid:0)(cid:0) a b

and similarly for ψ. Deﬁne the Eisenstein series

c d(cid:1)(cid:1) = φ(d),

Eφ,ψ

l

(z, s) =

(l − 1)!N l

(−2πi)lG(ψ0) X(c,d)∈Z2\{(0,0)}

φ(c)ψ(d)

(N cz + d)l|N cz + d|2s ,

which converges uniformly and absolutely for l + 2Re(s) ≥ 2 + ǫ, for any ǫ > 0. In the region of
absolute convergence this satisﬁes the transformation law

(δz, s) = φ(δ)ψ(δ)j(δ, z)l |j(δ, z)|2s Eφ,ψ

Eφ,ψ
l
for δ ∈ Γ0(N ). Since Eφ,ψ
Eφ,ψ
function of z, so (15) along with some growth estimates shows that in fact Eφ,ψ

(z, s) can be analytically continued in the s-variable, we can deﬁne
(z, 0). Moreover, unless l = 2 and ψ is principal, the value at s = 0 is a holomorphic

(z) = Eφ,ψ

∈ Ml(N, φψ).

(z, s)

(15)

l

l

l

l

l

If φ and ψ are primitive, the Fourier expansion of Eφ,ψ
and 7.2.13 of [9]:

l

can be deduced from Theorems 7.1.3, 7.2.12,

σl−1,φ,ψ(n)qn ∈ Mk(N, φψ)

(16)

Eφ,ψ

(z) = eφ,ψ

l + 2Xn≥1
where σl−1,φ,ψ(n) =Pd|n φ(n/d)ψ(d)dl−1 and

l

eφ,ψ

l =


L(ψ, 1 − l) N1 = 1,
L(φ, 0)
0

N2 = 1 and l = 1,
else.

11

In the special case φ = 1 the Eisenstein series E 1,ψ
Poincar´e series:

l

(z, s), appropriately normalised, is given by a

2(−2πi)lL(ψ, l + 2s)G(ψ0)

(l − 1)!N l

E 1,ψ

l

(z, s) = Xγ∈Γ∞\Γ0(N )

ψ(γ)

j(γ, z)l |j(γ, z)|2s .

(17)

Let k ∈ Z≥1, χ be a Dirichlet character modulo N with χ(−1) = (−1)k, and let f ∈ Sk(N, χ).
Given any g ∈ Ml(N, ψχ), we consider the inner product

hgE 1,ψ

k−l(·, s), f i =ZΓ0(N )\H

g(z)E 1,ψ

k−l(z, s)f (z)ys+kdµ(z).

Here dµ(z) = (dxdy)/y2 is the SL2(R)-invariant measure on the upper half plane. Note that
integrand is indeed Γ0(N )-invariant so the integral over this quotient makes sense, at least when it
converges. This is certainly the case if s has suﬃciently large real part, which we assume for the
following proposition:

Proposition 4.1. Let N, k, l ∈ Z≥1, χ be a Dirichlet character modulo N , and f be a newform
in Sk(N, χ), let φ, ψ be Dirichlet characters such that φψ = χ and φ(−1) = (−1)l. Let φ0 be the
primitive character modulo M = cond(φ) associated to φ. Exclude the two cases φ0 = 1 and l = 2,
and φ = χ and l = k − 2. Then

hE 1,φ0

l E 1,ψ

k−l(·, s), f i =

ik−lΓ(s + k − 1)(k − l − 1)!N k−l

22s+3k−l−2πs+2k−l−1L(ψ, k − l + 2s)2G(ψ0)

L(f c, s + k − 1)L((f c)φ0, s + k − l).

(18)

Proof. The Rankin-Selberg method (see [11]) shows

hgE 1,ψ

k−l(·, s), f i =

Γ(s + k − 1)(k − l − 1)!N k−l

2(4π)s+k−1(−2πi)k−lL(ψ, k − l + 2s)G(ψ0)Xn≥1

anbn
ns+k−1 ,

(19)

where an and bn are the Fourier coeﬃcients of f and g. Note that an are the Fourier coeﬃcients of
f c(z) = f (−z) ∈ Sk(N, χ). A standard computation (see e.g. [10] Proposition 4.14) gives

anσl−1,1,φ0(n)

ns+k−1

=

Xn≥1

L(f c, s + k − 1)L((f c)φ0, s + k − l)

L(χφ0, 2s + k − l)

.

So taking g = E 1,φ

l

in (19) and using (16) we obtain the result.

(cid:3)

Note that both sides of (18) have analytic continuation, so by the uniqueness of analytic continu-
ation the equality also holds at s = 0:

Corollary 4.2. Under the hypotheses of Proposition 4.1,

hE 1,φ0

l E 1,ψ

k−l, f i =

ik−l(k − l − 1)!(k − 2)!N k−l

23k−l−2π2k−l−1L(ψ, k − l)2G(ψ0)

L(f c, k − 1)L((f c)φ0, k − l).

We can now proceed to the ﬁrst result on generating cusp forms by products of Eisenstein series.

4Our divisor function is σl−1,φ,1 in Raum’s notation.

12

Deﬁnition 4.3. Let N = paqbN ′ be as in Theorem 3.4. For each M | N , write D(M ) for the set

of primitive Dirichlet characters modulo M . Let B(N ) ⊂ FM |N D(M ) × {1, ..., k − 1} consist of

the pairs (α, l) such that

α(−1) = (−1)l,
(α, l) 6= (1, 2), (1, k − 2).

Deﬁne Pk(N ) ⊂ Mk(N ) to be the space generated by the products

(E 1,α

l E 1,αN

k−l )|W N

S

for all (α, l) ∈ B(N ) and all sets S of prime divisors of N ′. Here αN denotes the extension of α to
a character modulo N .

Theorem 4.4. Let N = paqbN ′ be as in Theorem 3.4. For M ⊂ Mk(N ), write M for the
projection of M to S new

(N ). Then for k ≥ 4 even

k

Pk(N ) = S new

k

(N ).

In the case k = 2 we deﬁne S new
L(f, 1) 6= 0. Then

2,rk=0(N ) ⊂ S new

2

(N ) to be the subspace generated by newforms f with

P2(N ) = S new

2,rk=0(N ).

Proof. First assume k > 2. As in Section 3 denote the set of prime divisors of N ′ by T . Suppose
that the containment Pk(N ) ⊂ S new
(N ) is proper. Since Pk(N ) is closed under the action of the
Atkin-Lehner operators W N
(N ).
Therefore there exists a non-zero form g ∈ S new
(N ) that is orthogonal to Pk(N ) and an eigenform
of the W N

S for S ⊆ T , so is the orthogonal complement of Pk(N ) in S new

k

k

k

S . We can write

g =

βifi,

(20)

r

Xi=1

where f1, . . . , fr are the newforms in S new
Using Corollary 4.2 (note fi = f c

k

(N ) with the same W N

S -eigenvalues as g for all S ⊆ T .

i since the fi have trivial character) we get
(k − l − 1)!(k − 2)!N k−l

hE 1,α

l E 1,αN

k−l

, fii =

(−2πi)k−l(4π)k−1L(αN , k − l)L(α, k − l)G(α)

L(fi, k − 1)L((fi)α, k − l).

Since g is a W N
hE 1,α
|W N
is equivalent to

l E 1,αN

k−l

S -eigenform for S ⊆ T and the operators W N
S , gi = 0 if and only if hE 1,α

S are self-adjoint, for all S ⊂ T we have
, gi = 0. We see that orthogonality of g to Pk(N )

l E 1,αN

k−l

r

βiL(fi, k − 1)L((fi)α, k − l) = 0

(21)

Xi=1

for all (α, l) ∈ B(N ). Following an idea from the proof of Theorem 1 in [5], we deﬁne another form
in G ∈ S new

(N ) by

k

G =

βiL(fi, k − 1)fi.

r

Xi=1

Since the fi all have the same W N

S -eigenvalues as g for S ⊆ T , so does G. Then (21) translates to
(22)

L(Gα, k − l) = 0

for (α, l) ∈ B. Now applying Proposition 3.6 we see that L(G, 2) = 0 and L(G, k − 2) = 0. Thus G
satisﬁes the conditions of Theorem 3.4, so G = 0. Since k ≥ 4, L(fi, k − 1) 6= 0, so all βi must be

13

zero, and we arrive at the contradiction g = 0.

In the case where k = 2 the proof is similar. The containment P2(N ) ⊂ S new
2,rk=0(N ) comes from
Corollary 4.2, which shows that P2(N ) is orthogonal to every newform f with L(f, 1) = 0. The
rest of the argument works as above.
(cid:3)

When a = b = 0, so N = N ′ is squarefree, one easily sees that the set B(N ) in Deﬁnition 4.3
satisﬁes

so, writing P for the number of generators for Pk(N ), we have

#B(N ) ∼

(p − 1),

k − 1

2 Yp|N

P ∼

k − 1

2 Yp|N

2(p − 1).

This should be compared to

dim S new

k

(N ) ∼

k − 1

12 Yp|N

(p − 1)

(c.f. [6]). It is therefore an interesting question whether we can remove the Atkin–Lehner operators
appearing in the deﬁnition of Pk(N ) so to obtain a space Pk(N ) for which the number of generators
is of similar size to the dimension of the target space. When N = paqb we have

P ∼

k − 1

2

pa−1(p − 1)qb−1(q − 1),

while (with a, b ≥ 3 for simplicity),

dim S new

k

(N ) ∼

k − 1

12

pa−1(p − 1)(cid:18)1 −

1

p2(cid:19) qb−1(q − 1)(cid:18)1 −

1

q2(cid:19) .

In this case (as well as the case of N = N ′) it is also an interesting question whether one can quan-
tify the linear dependency among the products of Eisenstein series generating Pk(N ) (or Qk(N ),
deﬁned below). These questions may be asked for any k, but they are particularly pertinent when
k = 2, as any additional symmetry in this case which would allow one to lower the constant further
could have application to Brumer’s conjecture regarding the number of newforms f with L(f, 1) = 0.

Most of the methods we have developed also work for the spaces Mk(N, χ) where χ is a non-
principal character modulo N . However there are some complications, in particular because the
Atkin–Lehner operators W N
S are no longer endomorphisms of Mk(N, χ) (when χ is not quadratic)
which means that one should take Eisenstein coming from diﬀerent eigenspaces of the diamond
operators to generate Sk(N, χ). To minimise the technicalities we give an example of how the same
methods can be used to treat the case of prime level, where the Atkin–Lehner operators are not
necessary:

Theorem 4.5. Let p be prime and let χ a character modulo p. Let P2(p, χ) be the space generated
by

E 1,α
1 E 1,χα

1

,

for α varying over all (primitive) odd characters modulo p. Write P2(p, χ) for the projection of
P2(p, χ) to S2(p, χ). Let S new
2,rk=0(p, χ) ⊂ S2(p, χ) be the subspace generated by newforms f with
L(f, 1) 6= 0. Then

P2(p, χ) = S new

2,rk=0(p, χ)

14

Proof. As above, Corollary 4.2 shows that the products E 1,α
are orthogonal to any newform
f with L(f, 1) = 0 (since L(f, 1) = 0 implies L(f c, 1) = 0), hence P2(p, χ) ⊆ S new
2,rk=0(p, χ). Suppose
for a contradiction that the reverse inclusion does not hold. As above we take a non-zero g ∈
S new
2,rk=0(p, χ) that is orthogonal to P2(p, χ) and write

1 E 1,χα

1

r

where the fi are eigenforms that give a basis for S new
to

2,rk=0(p, χ). Orthogonality to P2(p, χ) translates

g =

βifi.

Xi=1

for all odd characters α modulo p; we again introduce

βiL(f c

i , 1)L((f c)α, 1) = 0,

(23)

r

Xi=1

G =

and note that (23) is equivalent to

r

Xi=1

βiL(f c

i , 1)f c

i ∈ S2(p, χ)

L(Gα, 1) = 0

for all odd characters α modulo p. We will show that this implies ξ+
(0; u, v) = 0 for all (u, v) ∈ Ep
If p | u, then we may take u = 0, thus ξ+
(0; u, v) = 1
2 (ξG|WN (0; 0, v) −
and hence G = 0.
ξG|WN (0; 0, v)) = 0, so we can assume that p does not divide u. Using (8) with ξ replaced by ξ+ we
get ξ+
(0; u, v) = 0 when p | v as well, so we may assume p divides neither u nor v. Repeating
the calculations in the proof of Theorem 3.2 in this case, so S = ∅ and N ′ = p, we obtain

G|WN

G|WN

G|Wp

ξ+
G|Wp

(0; u, v) =

1

(−2πi)Xα

χα2(u)
p − 1

L(Gα, 1)

(24)

where the sum is over all odd characters modulo p (c.f. (14)). We have L(Gα, 1) = 0 by orthogo-
nality of g, so G = 0. Since L(f c
i , 1) = L(fi, 1) 6= 0 we see that βi = 0 for all i = 1, . . . , r, hence the
contradiction g = 0.
(cid:3)

5. The new part of Pk(N )

In this section we will analyse the new parts of the generators of Pk(N ) for any N . We use this
to construct another space Qk(N ) with the same projection to the new space as Pk(N ) whose
generators do not involve partial Atkin–Lehner operators. While Pk(N ) was more useful for the
proof of Theorem 4.4, Qk(N ) is more explicit and easy to implement on a computer. The ﬁrst step
is to write E 1,αN
in terms of the Eisenstein series attached to the underlying primitive character:
k−l

Lemma 5.1. Let α be a primitive character modulo M with α(−1) = (−1)k. Writing N =

Q pvp(N ), let NM = Qp|M pvp(N ) be the M -part of N , so that M | NM and gcd(M, N/NM ) = 1.

Then

k
2 −l

E 1,αN

k−l =(cid:18) N
M(cid:19)

Xe|N/NM

µ(e)α(e)e− k

2 +lE 1,α

k−l|BN/M e

Proof. For Re(s) ≫ 0 we have

E 1,αN

k−l,N (z, s) =

(k − l − 1)!N k−l

(−2πi)k−lG(α) X(c,d)6=(0,0)

15

αN (d)

(cN z + d)k−l|cN z + d|2s .

Using the fact that Pd|n µ(d) is the indicator function for n = 1, we get
X(c,d)6=(0,0)

(cN z + d)k−l|cN z + d|2s = X(c,d)6=(0,0) Xe|gcd(d,N/NM )

αN (d)

µ(e)

α(d)

(cN z + d)k−l|cN z + d|2s

µ(e)α(e)

ek−l+2s X(c,d)6=(0,0)
= Xe|N/NM
(k − l − 1)!M k−l Xe|N/NM

(−2πi)k−lG(α)

=

α(d)

(cM ( N

M e )z + d)k−l|cM ( N

M e )z + d|2s

µ(e)α(e)e−k+l−2sE 1,α

k−l((N/M e)z, s).

We obtain an equality of functions of the variable s, which remains true for s = 0 by uniqueness of
analytic continuation.
(cid:3)

Thus the product E 1,α

l E 1,αN

k−l

is a linear combination of products of the form

for e | N/NM . If e 6= 1 these products clearly have level smaller than N , so are old forms. Hence
the projection of Pk(N ) to the new space Pk(N ) is generated by the projections of the products

E 1,α

l

·(cid:16)E 1,α

k−l|BN/M e(cid:17)

(cid:16)E 1,α

l

|W N

S (cid:17) ·(cid:16)E 1,α

k−l|BN/M |W N

S (cid:17) .

(25)

where S ⊆ T is a set of prime divisors of the squarefree part of N . Let us focus on the ﬁrst factor for
now. One easily sees that, as operators on Mk(M, α), we have the equality W N
|B(N/M )S ,
where SM is the set of primes in S that divide M .
Using Proposition 14 of [13] we see that the ﬁrst factor in (25) is a multiple of

S = W M
SM

αSM ,αSM
E
l

|B(N/M )S ,

where SM = {p | M } \ SM . To study the second factor in (25) we use an extension of Proposition
1.5 of [1] that allows us to swap the order of the lifting operator and the Atkin–Lehner operator
above:

Lemma 5.2. Let F ∈ Mk(M, χ), d ∈ Z≥1, and S be a set of primes dividing dM . Let S = {p |

dM } \ S, SM = S ∩ {p | M }, and deﬁne dS =Qp∈S pvp(d) and dS as usual. Then

S = χS(dS )χS(dS)F |W M

F |Bd|W M d

SM |BdS

Proof. Choose x, y, z, w ∈ Z as in the deﬁnition of W M d
(mod dSMS) and (MS dS)2xw − M dzy = MSdS. As operators on Mk(N, χ), we have

S , i.e. satisfying y ≡ 1 (mod dSMS), x ≡ 1

BdW M d

S =(cid:18)d 0
The determinant of (cid:16) MS dSx dS y

dSMSw(cid:19) =(cid:18)MSdSx

0 1(cid:19)(cid:18)dSMSx
M z MS w(cid:17) is MS, so by Proposition 2.1 and the fact that y ≡ 1 (mod MS)

M z MSw(cid:19)(cid:18)d

and x ≡ 1 (mod MS) it equals χS(dS)χS(dS )W M
SM

0 dS(cid:19) .

, whence the result.

M dz

dSy

(cid:3)

0

y

Applying Lemma 5.2 with d = N/M to E 1,α
that the second factor in (25) is a multiple of

k−l|BN/M |W N

S and using Proposition 14 of [13], we see

αSM ,αSM
k−l

E

|B( N

M )S

,

16

so the product in (25) is a multiple of

In order to unwind this, set

αSM ,αSM
l

(cid:18)E

|B( N

M )S(cid:19) ·(cid:18)E

αSM ,αSM
k−l

|B( N

M )S(cid:19) .

pvp(M ),

M1 = MS = Yp∈SM
d1 = (N/M )S = Yp∈S

pvp(N )−vp(M ),

pvp(M ),

M2 = MS = Yp∈SM
d2 = (N/M )S = Yp∈S

pvp(N )−vp(M ).

Note that SM = {p | M } \ SM ⊂ S. With these deﬁnitions, αSM (resp. αSM
) is a primitive
character modulo M1 (resp. M2), which we now relabel as φ (resp. ψ). Note that as α varies over
all primitive characters of parity ǫ modulo M , φ and ψ vary over all primitive characters modulo
M1 and M2 such that φψ has parity ǫ. Now ﬁx M |N and let S ⊆ T vary: we obtain all M1, M2
such that M1 | NT and M1M2 = M , and for given M1, M2 we obtain all d1, d2 such that d1M1 | NT
and d1M1d2M2 = N .
Deﬁnition 5.3. Let N ∈ Z≥1. Let T be the set of primes p such that vp(N ) = 1. Let B′(N ) consist
of all quintuples (φ, ψ, l, d1, d2), where φ varies over all primitive characters of level M1, with M1
varying over all divisors of NT , ψ varies over all primitive characters of level M2, with M2 varying
over all divisors of N , all l ∈ {1, . . . , k − 1}, and all d1, d2 ∈ Z≥1, such that 5

φψ(−1) = (−1)l,
(φ, ψ, l) 6= (1, 1, 2), (1, 1, k − 2),

d1M1 | NT ,
d1M1d2M2 = N.

We deﬁne Qk(N ) to be the vector space generated by
|Bd1 · Eφ,ψ

Eφ,ψ

l

k−l|Bd2.

(26)

for all (φ, ψ, l, d1, d2) ∈ B′(N ).

The above calculation shows that Qk(N ) and Pk(N ) have the same projection on to the new
subspace S new
(N ). Using the spaces Qk(N ) and their lifts we can extend Theorem 4.4 to the full
k
space Sk(N ):

Theorem 5.4. Let N be as in Theorem 4.4 and Qk(N ) = SN0d|N

Mk(N ) generated by the products

Qk(N0)|Bd be the subspace of

for (φ, ψ, l, d1, d2) ∈ B′(N0) (as in Deﬁnition 5.3). Then for k ≥ 4

Eφ,ψ

l

|Bd1d · Eφ,ψ

k−l|Bd2d

Mk(N ) = Qk(N ) + Ek(N ).

Proof. This follows from Theorem 4.4, the previous calculations, and an inductive argument using
the fact that

Sk(N ) = [N0|N [d|N/N0

S new
k

(N0)|Bd.

(cid:3)

5Of course the second condition is only relevant when M = M1 = M2 = 1.

17

To treat the case k = 2 we need one more result:

Proposition 5.5. Let f ∈ S new
such that dN0 | N . Then f |Bd is orthogonal to P2(N ).

2

(N0) be a newform of level N0 | N with L(f, 1) = 0, and let d be

Proof. It suﬃces to show that f |Bd is orthogonal to each of the generators of P2(N ), so we ﬁx a
product

(E 1,α

1 E 1,αN

1

)|W N
S

where α is a primitive odd character modulo M | N and S ⊂ T is a subset of the primes p with
vp(N ) = 1. Since W N

S is self-adjoint,
1 E 1,αN

h(E 1,α

1

)|W N

S , f |Bdi = hE 1,α

1 E 1,αN

1

Using Lemma 5.2 and the fact that f is an eigenfunction of all W M
of N0, we see that f |Bd|W N

S is a multiple of f |Bd′ for some d′|d. Arguing as in Proposition 4.1,

S ).

, f |Bd|W N
S ′ for sets S′ ⊆ T of prime divisors

hE 1,α

1 E 1,αN

1

(·, s), f |Bd′ i =

Γ(s + 1)

d′s+1(4π)s+1 Xn≥1

anσ1,1,α(d′n)

ns+1

,

where an are the Fourier coeﬃcients of f (note that f c = f in this case), and Re s ≫ 0. Let

d′ =Q pep. Then
Xn≥1

anσ1,1,α(d′n)

ns+1

= Xgcd(n,d′)=1

anσ1,1,α(n)

ns+1 Yp|d′  ∞
Xb=0

apbσ1,1,α(pb+ep)

(pb)s+1

!

(27)

The ﬁrst sum over n coprime to d′ is, up to the Euler factors corresponding to the prime divisors of
d′, given in the proof of Proposition 4.1. It has analytic continuation to s = 0 and vanishes there,
since L(f, 1) = 0. It remains to show that the sums
apbσ1,1,α(pb)

apbσ1,1,α(pb+ep)

apbα(pb)pb

∞

∞

∞

(α(p)p + . . . + α(pep)pep)

fp(s) =

Xb=0

(pb)s+1

=

Xb=0

(pb)s+1 +

(pb)s+1

Xb=0

can be analytically continued to s = 0 for all p dividing d′. The ﬁrst sum corresponds to the
Euler factors at p of the quotient of L-functions given in Proposition 4.1 and hence has analytic
continuation to s = 0. The second sum equals

(α(p)p + . . . + α(pep)pep)Lp(fα, s),

which can again be analytically continued to s = 0.

(cid:3)

We now deﬁne a space S2,rk=0(N ) that projects onto S new

2,rk=0(N ) from Theorem 4.4, by

S2,rk=0(N ) = [N0|N [d|N/N0

S new

2,rk=0(N0)|Bd.

By Proposition 5.5 P2(N ) is contained in S2,rk=0(N ) and by Theorem 5.4 the two spaces have the
same projection to the new space of S2(N ). This projection is equal to the projection of Q2(N )
and so we can again use induction to prove:

Theorem 5.6. Let N be as in Theorem 4.4 and let Q2(N ) = ∪N0d|N Q2(N0)|Bd be the subspace of
M2(N ) generated by the products

for all (φ, ψ, 1, d1, d2) ∈ B′(N0). Then

Eφ,ψ

1

|Bd1d · Eφ,ψ

1

|Bd2d

S2,rk=0(N ) + E2(N ) = Q2(N ) + E2(N ).

18

References

[1] A. O. L. Atkin and W. C. W. Li. Twists of newforms and pseudo-eigenvalues of W -operators. Invent. Math.,

48(3):221–243, 1978.

[2] L. Borisov and P. Gunnells. Toric modular forms and nonvanishing of L-functions. J. Reine Angew. Math.,

539:149–165, 2001.

[3] L. Borisov and P. Gunnells. Toric modular forms of higher weight. J. Reine Angew. Math., 560:43–64, 2003.
[4] ¨O. Imamo¯glu and W. Kohnen. Representations of integers as sums of an even number of squares. Math. Ann.,

333(4):815–829, 2005.

[5] W. Kohnen and Y. Martin. Products of two Eisenstein series and spaces of cusp forms of prime level. J. Ra-

manujan Math. Soc., 23(4):337–356, 2008.

[6] G. Martin. Dimensions of the spaces of cusp forms and newforms on Γ0(N ) and Γ1(N ). J. Number Theory,

112(2):298–331, 2005.

[7] L. Merel. Universal Fourier expansions of modular forms. In On Artin’s conjecture for odd 2-dimensional repre-

sentations, volume 1585 of Lecture Notes in Math., pages 59–94. Springer, Berlin, 1994.

[8] L. Merel. Symboles de Manin et valeurs de fonctions L. In Y. Tschinkel and Y. Zarhin, editors, Algebra, Arith-

metic, and Geometry. In honor of Yu. I. Manin, volume 3, 2009.

[9] T. Miyake. Modular forms. Springer, 2006. Translated from the Japanese by Y. Maede.

[10] M. Raum. Products of Vector Valued Eisenstein series. arXiv:1411.3877, 2014.
[11] G. Shimura. The special values of the zeta functions associated with cusp forms. Comm. Pure Appl. Math.,

29(6):783–804, 1976.

[12] W. Stein. Modular forms, a computational approach, volume 79 of Graduate Studies in Mathematics. American

Mathematical Society, 2007.

[13] J. Weisinger. Some results on classical Eisenstein series and modular forms over function ﬁelds. PhD thesis,

Harvard University, 1977.

[14] D. Zagier. Modular forms whose Fourier coeﬃcients involve zeta-functions of quadratic ﬁelds. In Modular func-
tions of one variable, VI (Proc. Second Internat. Conf., Univ. Bonn, Bonn, 1976), pages 105–169. Lecture Notes
in Math., Vol. 627. Springer, Berlin, 1977.

19

