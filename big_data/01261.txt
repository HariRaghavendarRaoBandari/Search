Deterministic and stochastic aspects of the stability in an inverted pendulum

under a generalized parametric excitation

Roberto da Silva, Sandra D. Prado, Debora E. Peretti

Institute of Physics, Federal University of Rio Grande do Sul, Av. Bento Gonc¸alves, 9500, Porto Alegre, 91501-970, RS, Brazil

E-mail:rdasilva@if.ufrgs.br

6
1
0
2

 
r
a

M
3

 

 
 
]
h
p
-
s
s
a
l
c
.
s
c
i
s
y
h
p
[
 
 

1
v
1
6
2
1
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

In this paper, we explore the stability of an inverted pendulum under a generalized parametric excitation
described by a superposition of N cosines with different amplitudes and frequencies, based on a simple sta-
bility condition that does not require any use of Lyapunov exponent, for example. Our analysis is separated
in 3 different cases: N = 1, N = 2, and N very large. Our results were obtained via numerical simulations by
fourth-order Runge Kutta integration of the non-linear equations. We also calculate the effective potential
also for N > 2. We show then that numerical integrations recover a wider region of stability that are not
captured by the (approximated) analytical method. We also analyze stochastic stabilization here: ﬁrstly, we
look the effects of external noise in the stability diagram by enlarging the variance, and secondly, when N is
large, we rescale the amplitude by showing that the diagrams for time survival of the inverted pendulum re-
sembles the exact case for N = 1. Finally, we ﬁnd numerically the optimal number of cosines corresponding
to the maximal survival probability of the pendulum.

1. Introduction

The inverted pendulum, more precisely its stabilization mechanisms deserve a lot of attention from

several correlated areas, including Physics, Mathematics, Biology, (see for example an interesting review

[1]). However, the applications goes beyond, including the study of excitation effects in Ocean Structures

[2], inverted pendulum robots [3] and many others.

Induced stability is a solved problem known since 1908 [4], but it was in the 1950s, with Kapiza [5],

that this kind of stability was studied for the inverted pendulum system. Experimental results were obtained

in the 1960s (see for example [6]) and even nowadays this problem still remains interesting [7]. The pos-

sible excitations/perturbations which may be capable of stabilizing an inverted pendulum, even for some

time, have a large number of details which are not completely understood yet. Therefore, this apparent

simple system, has a complexity that can be considered a challenging problem since some important sta-

bilization problems in Engineering, as for instance, the stability of robot arms, the stability of populations

in biology [1], or even the stabilization of photons deviation in Cosmology [8] require similar stabilization

mechanisms.

Preprint submitted to Elsevier

March 7, 2016

An inverted pendulum (showin in Fig. 1) free of external forces, is unstable and the punctual mass m
attached to the rigid massless rod will tend to oscillate around to the stable equilibrium position (θ = 1800),
which corresponds to the usual pendulum problem).

In order to keep the pendulum upright, cosθ > 0, the frictionless hinge that attaches the rod to the
suspension point point, must vertically accelerated. Let us denote such acceleration by a(t) = ¨z(t), where
z(t) is a time-dependent excitation that controls the height of the pendulum suspension point P.

Figure 1: Inverted pendulum under a support excitation z(t).

The Lagrangian of this problem can easily be written as:

L (θ , ˙θ ) =

1
2

ml2 ˙θ 2 − ml ˙z ˙θ sinθ − mgl cosθ − mgz(t).

It is worth emphasizing that all our results can be directly extended to an equivalent physical pendulum
making simple associations. If we additionally consider a external excitation φ (t) we can derive the motion
equation

1 +

¨z(t)

sinθ + φ (t)

(1)

¨θ (t) =

g
l

from the Lagrange equations.

(cid:18)

(cid:19)

1
g

Now, in order to generalize, we write z(t) = zdet(t) + zrand(t) and φ (t) = φdet(t) + φrand(t) where sub-

scripts “det” and “rand” denote the deterministic and stochastic time-dependent parts of the excitations/perturbations
respectively. In this work, we focus our analysis in two important situations: zrand(t) = 0 and zdet(t) =
∑n
j=1 A j cos(ω jt), i.e., parametric sinusoidal excitation in the basis and φdet(t) = 0 and φrand(t) = N(µ,σ )

2

that denotes an external gaussian noise with mean µ and standard deviation σ. The more appropriate choice
here is µ = 0, given that we are mainly interested in the parametric stabilization of the inverted pendulum
or in what we can call its survival time τ, which means the maximum time the pendulum remains upright
or, mathematically, the time up to condition cosθ < 0 is satisﬁed. The condition µ (cid:54)= 0 leads to a natural
biased motion, which is not interesting here. In this work we consider to analyze how the stability condition
is broken as function of the external noise dispersion σ.

Several authors [1, 9] have explored the case N = 1 using small angles approximation known as the
effective potential method. However, even the well known case for one cosine, N = 1, deserves, in our

opinion, some attention and alternative analysis. Therefore, ﬁrstly, we checked the literature based on

numerical integration methods in order to verify the validity of previous results in the small oscillations

regime and the initial conditions dependence, basically, the initial angle dependence. Particularly we also

use these numerical integrations to observe the breaking of the stability region predicted by perturbative
analysis and by parametric resonance (see Butikov [9]) when the external noise is turned on (i.e., φ (cid:54)= 0).
In this case we calculate the pendulum survival probability over different time evolutions (i.e, different
evolutions corresponding to different seeds). A detailed connection between N = 1 and N → ∞ is also
explored when the pendulum amplitude grows linearly with time and is also rescaled with the number of

cosines set in the parametric excitation.

In the second part of this work we analyze the superposition of two cosines, N = 2, which as far as

we are concerned has not been explored yet. This case is interesting since the period of the composition is

not always known so that the perturbative analysis is not able to describe the inverted pendulum stability

regions correctly. Given such a problem, we analyze numerically the interesting case where the amplitudes
are ﬁxed and the frequencies: ω1 and ω2 are varied. The analytical results obtained via the effective potential
method are compared with numerical simulations. We also analyze the effects of an analysis of the stability
breakdown considering different external noise dispersion σ in the numerical diagrams. Deviations from
small oscillations behavior were considered in our analysis.

Finally, for N > 2, we look for optimization problems on the stability probability considering an ensem-

ble of frequencies and amplitudes. The most remarkable detail in our analysis is the fact a simple choice
for the stability criterion as, cosθ > 0, overcomes more laborious methods such as Liapunov exponent or
other analysis to check stability conditions. So we organized our papers as it follows: in the next section we
describe key points for a perturbative analysis extending our formulation for arbitrary N, which is known in

literature as effective potential method. In section 3, we brieﬂy show our numerical simulations were devel-

3

oped. Our main results are presented in section 4. Some discussions and conclusions are ﬁnally presented

in section 5.

2. Perturbative Analysis

We start our perturbative analysis by chosing the perturbative function z(t) = ∑N

i=1 Ai cos(ωit), so that

the Eq. 1 becomes

d2θ
dt2 =

g
l

(cid:32)
1− 1
g

N

∑

i=1

(cid:33)

Aiω2

i cos(ωit)

where we set up φ (t) = 0 for all t.

The last equation can be written in a more elucidative form as

sinθ

(2)

(3)

··
θ = −∂U

∂θ + F(θ )
i=1 Aiω2

l cosθ and F(θ ) =

where U = g
i cos(ωit). The physical interpretation is straight-
forward here, given that U(θ ) is the gravitational potential, while F(θ ) is an external force due to vibrations
at the pendulum suspension point. In what follows from here, we will adapt the equations obtained by Lan-

l ∑N

l sinθ = − sinθ
..z(t)

dau and Lifchitz [11]. A similar analysis was developed by Kapitza (1951) [5].

We start assuming that the solution of Eq. 3 can be separated into two aditive components:

θ (t) = θ (t) + ξ (t).

(4)

We are considering that the pendulum motion is composed by a non-perturbated path θ plus a noise ξ
composed by multiple frequencies {ωi}N
i=1. Another way to think is that θ (t) has a
large amplitude but slow frequency while ξ (t) has small amplitude but fast frequency.

i=1and amplitudes {Ai}N

By the Taylor expansions of U(θ ) and F(θ ) around the slow path θ, we have:

Considering these approximations up to the ﬁrst order term, we can obtain from Eq. 3 that

∂U
∂θ

∂U
∂θ =
∂ F
∂θ = F(θ ) +

∂ 2U
∂θ 2

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

+

∂ F
∂θ

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ
(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

ξ 2 + ...

ξ +

∂ 2F
∂θ 2

∂ 3U
∂θ 3

1
2

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

ξ 2 + ...

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

ξ

ξ +

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ
(cid:12)(cid:12)(cid:12)(cid:12)θ =θ

4

··
θ +

··
ξ = − ∂U
∂θ

− ∂ 2U
∂θ 2

ξ + F(θ ) +

∂ F
∂θ

(5)

(6)

(cid:12)(cid:12)(cid:12)θ =θ

Now it is crucial to consider the nature of motion to distinguish the important terms in Eq. 6. The only
ξ , F(θ ),

candidates associated with the perturbative effects on the right side of this equation are − ∂ 2U
∂θ 2

(cid:12)(cid:12)(cid:12)θ =θ

and ∂ F
∂θ
F(θ ) we have

ξ . Therefore, given that the terms − ∂ 2U
∂θ 2

(cid:12)(cid:12)(cid:12)θ =θ

(cid:12)(cid:12)(cid:12)θ =θ

ξ and ∂ F
∂θ

ξ are small when compared with

··
ξ = F(θ ) = −sinθ
l

N

∑

i=1

Aiω2

i cos(ωit)

(7)

By integrating the equation 7 twice with respect to time we obtain

ξ (t) =

sinθ

l

N

∑

i=1

Ai cos(ωit) + c1t + c0

Here, c0 and c1 are arbitrary constants and must be assumed null given that we want ξ to be an oscillatory
term, so that it should not increase as a function of time. This is a constraint that can be imposed as initial
condition. For a set {ωi}N
i=1 Ai cos(ωit) does not necessarily results in a periodic
function. For this to occur, there must be a period T , such that: ωiT = 2niπ and ω jT = 2n jπ, for every pair
i (cid:54)= j = 1, ...,N, or simply

i=1 the superposition ∑N

ωi/ω j = ni/n j,

(8)

i.e., the ratio between frequencies must be a rational number where ni and n j are the smallest possible
integers, so that, ni/n j is an irreducible fraction.

Let us focus our analysis only in situations where this condition is satisﬁed. It is important to recall this

is a problem for which an analytical solution is not typically known. Therefore, our aim here is to derive

a stability criteria given our choices for the perturbative functions. In order to do that, we start taking a

time average of Eq. 6 and assuming that the unperturbed part are not signiﬁcantly altered in a ﬁrst order

approximation. Within these assumptions we ﬁnd:
··
θ ≈ − ∂U
∂θ

Where (cid:104)·(cid:105) denotes a time average that results in

= − sinθ cosθ

l2

∑N
i=1 A2

i ω2
i

(cid:68) ∂ F

∂θ

(cid:12)(cid:12)(cid:12)θ =θ

(cid:69)

ξ

(cid:29)

ξ

+

(cid:12)(cid:12)(cid:12)(cid:12)θ =θ
(cid:12)(cid:12)(cid:12)(cid:12)θ =θ
(cid:28) ∂ F
(cid:10)cos2(ωit)(cid:11) + ∑N

∂θ

i(cid:54)= j=1 AiA jω2
i

= − sin2θ
2l2

2 ∑N
1

i=1 A2

i ω2

i ( sin(2ωiT )
2Tωi

+ 1) + ∑N

i(cid:54)= j=1

AiA jω2
i

T

Now, given that

··
θ = − ∂Ue f f ective

∂θ

, where

Ue f f ective =

g
l

cosθ − cos2θ
4l2

1
2

N

∑

i=1

i ω2
A2
i (

sin (2ωiT )

2Tωi

+ 1) +

N

∑
i(cid:54)= j=1

AiA jω2
i

T

5

(cid:16)

(cid:18)

(cid:32)

(cid:10)cos(ωit)cos(ω jt)(cid:11)(cid:17)
(cid:20) sin(ωi−ω j)T

(ωi−ω j)

+

sin(ωi+ω j)T

(ωi+ω j)

(cid:21)(cid:19)

(cid:20)sin (ωi − ω j)T

(ωi − ω j)

+

sin (ωi + ω j)T

(ωi + ω j)

(cid:21)(cid:33)

(cid:32)

the stability criteria, ∂ 2

∂θ 2Ue f f ective > 0, leads to

1
2

N

∑

i=1

i ω2
A2
i (

sin (2ωiT )

2Tωi

+ 1) +

N

∑
i(cid:54)= j=1

AiA jω2
i

2T

(cid:20)sin (ωi − ω j)T

(ωi − ω j)

+

sin (ωi + ω j)T

(ωi + ω j)

(cid:21)(cid:33)

> gl

(9)

where without loss of generality, we have assumed θ = 0. Here it is important to separate our analysis in
three distinct parts: N = 1, N = 2 and for an arbitrary number of cosines N > 2.

2.1. N = 1;

This case has been widely studied under different analysis [1], [9]. When N = 1, the result from Eq. 9

is simply:

A2 > A2

min =

2gl
ω2

(10)

valid in the small oscillations regime. As we will show in section 4, this stability condition is not enough to
cover all of the stability regions in a diagram ω ×A. Unfortunately, it represents only one part of the history
since there is a upper bound for the amplitude that can be observed by numerical simulations.

2.2. N = 2;

This is the simplest case where the perturbative analysis cannot be rigorously applied to all possible
situations since the periodicity of the superposition A1 cos(ω1t) + A2 cos(ω2t) depends on certain restric-
tions. As it will be shown in section 4, this case becomes particularly interesting when the amplitudes are
set equal, that is, A1 = A2 = A. Then, we ﬁnd the condition:

ω2
1

sin (2ω1T )

2Tω1

+ ω2
2

sin (2ω2T )

2Tω2

+

2
T

+

sin (ω1 + ω2)T

(ω1 + ω2)

+

T
2

>

2gl
A2 .

(11)
If besides having equal amplitudes we also set ω1 ≈ ω2, then we get from Eq. 11 that the condition
min/4, certainly fulﬁlls the requirements for stabilization given a frequency ω. However, for certain

A2 > A2
ranges of frequencies, stabilization can be attained for amplitudes A that are slightly smaller.

(cid:18)

(cid:0)ω2

1 + ω2
2

(cid:1)(cid:20)sin (ω1 − ω2)T

(ω1 − ω2)

(cid:21)(cid:19)

2.3. N > 2;

For an important and trivial case is when the frequencies are close enough ω1 ≈ ω2 ≈ ... ≈ ωN ≈ 2π
T .
This leads to sin (ωi − ω j)T ≈ (ωi − ω j)T ≈ 0. Moreover, we also have sin2ωiT ≈ 0 for all i = 1, ...,N.
In this case we have a simpliﬁed condition: ∑N
i > 2gl. For N asymptotically large and for a set of
frequencies such that the {ωi}N
i=1 are equally distributed according to some probability density function
f (ω) we can replace: ∑N
0 cos(ωt) f (ω)dω denotes

i=1 Ai, where cos(ωt) =(cid:82) ∞

i=1 Ai cos(ωit) → cos(ωt)∑N

i=1 A2

i ω2

6

the ensemble average. A standard case, could be an uniform distribution for the frequencies choosen in an
interval [ωmin,ωmax], so that we can show that:

cos(ωt) =

sin(ωmaxt)− sin(ωmint)

t (ωmax − ωmin)

Here an interesting choice is to make Ai = A(t), which leads to ∑N

i=1 Ai = NA(t). So we have z(t) =

NA(t) sin(ωmaxt)−sin(ωmint)

t (ωmax−ωmin)

t sin(ωt) and so

. In this case if we denote f (t|ω) = A(t)

(cid:18)ω cosωt
d2 f
(cid:18)2sinωt
dt2 = ¨A(t)sinωt + 2 ˙A(t)
t3 − 2ω cosωt
t→∞→ 0. There is no parametric excitation and the pendulum is
If A(t) does not depend on time, then f (t|ω)
asymptotically unstable as t → ∞. An alternative is to consider a linear dependence as A(t) = Ct. In this
case, we have d2 f

− sinωt
t2
− ω2 sinωt

t ), and reescaling CN = aωmax:

A(t)

(cid:19)
(cid:19)

+

.

t

t2

t

dt2 = −CNω2 sinωt + O( 1
−a ω3
ωmax − ωmin

··
z(t) =

max

sin(ωmaxt) +

a ω2
min ωmax
ωmax − ωmin

sin(ωmint)

For the sake of the simplicity, let us consider ωmin = 0, so that

··
z(t) = −aω2

max sin(ωmaxt).

It is very surprising here that we recover the stability condition obtained for the case N = 1, by simply

replacing ω2 by ω2

max in eq. 10, that is:

a2 >

2gl
ω2

max

(12)

At this point, it is worth emphasizing that the time-dependent amplitude can start contributing positively
for stabilization by extending the length of time in which cosθ > 0. However this favorable effect soon
becomes undesirable since this monotonically increasing amplitude will dominates the scenario leading to

a loss of stability. Therefore, the real important question to be made here is whether the system is capable

of keeping the memory of stabilization according to eq. 12 under this amplitude normalization procedure.

We will show numerically in section 4 that such condition is preserved. However, to show that the condition

12 is held, we have to analyze the survival times instead of the survival probabilities.

7

3. Numerical Simulations

In this work, after a detailed observations in the numerical simulations, we deﬁned a simple stability

criterion deﬁnition:

Deﬁnition: Given a inverted pendulum governed by eq. 1 we say that this pendulum is stable during a
window of time up to time tmax if given an initial angle −π/2 < θ0 < π/2, all θt, t = 1,2, ...tmax, obtained
by integration of the motion equations via Runge-Kutta method of fourth order satisfy:

cosθt > 0

(13)

This simple stability criterion leads to algorithms that although relatively simple they can describe the

stability mapping in the inverted pendulum problem. Basically, we consider 4 procedures in our numerical

simulations. All of them are based on a main algorithm (see Table 1) which describes a generic Runge-Kutta

procedure for the inverted pendulum problem considering as input:

a) Parametric excitation: determined by N amplitudes: A[N] : (A1, ...,AN) and N frequencies ω[N] :

(ω1, ...,ωN);

b) Maximal number o iterations in the Rung Kutta procedure: Niter – This number can or cannot be

attained depending on stability condition given by eq. 13;

c) Time interval for Runge Kutta iteration: ∆t
d) Pendulum Characteristics: g – gravity acelaration, l – pendulum lengh. In this paper was considered

g = 9.81 m/s2 and l = 1.2 m, which corresponds to a standardized broomstick lenght.

e) Reescaling parameter: ν– If ν = 0, the amplitudes are rescaled as Ai → t Ai

N , elsewhere (ν = 1) they

remain unchanged.

f) External noise vector: A string with Niter random Gaussian variables with standard deviation σ and

mean zero.

g) Initial conditions: θ0 and

starts from rest.

·
θ 0– Without lost of generality we consider

·
θ 0 = 0, i.e., the pendulum

As output of this generic procedure we have:
a) Survival time: i – Time (integer number) for which the pendulum remains stable.
b) Final angle: θ –If cosθ > 0, so necessarily i = Niter, elsewhere the pendulum cannot be maintained

stable until the maximal time considered as stop criteria (Niter)

Now, we will present all procedures used in our work by reporting speciﬁcally each one of them showing

pseudo-codes.

8

A jω2
g cos(ωit)]sinθ1 + f (i)
j

Main Runge Kutta Routine(N,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0,i,θ)
input:N,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0
1
output:i,θ
2
Initilizations: θ = θ0; ˙θ = ˙θ0; i = 0;
3
4 While [(cos(θ ) > 0).or.(i < Niter)] do
5
6
For j = 1, ...,N
7
A j = (1− v)t A∗
8
Endfor
9
0 [1− ∑N
a1 = ω2
10
j=1
˙θ1∆t
θ2 := θ1 + 1
11
2
˙θ2 := ˙θ1 + 1
2a1∆t
12
0 [1− ∑N
a2 = ω2
13
j=1
˙θ2∆t
θ3 = θ1 + 1
14
2
˙θ3 = ˙θ1 + 1
2a2∆t
15
0 [1− ∑N
a3 = ω2
16
j=1
θ4 = θ1 + ˙θ3∆t
17
˙θ4 = ˙θ1 + a3∆t
18
0 [1− ∑N
a4 = ω2
19
θ = θ + ∆t
20
˙θ = ˙θ + ∆t
21
22 EndWhile
23 Return i, θ
24 End Main Runge Kutta Routine

6 ( ˙θ1 + 2( ˙θ2 + ˙θ3) + ˙θ4)
6 (a1 + 2(a2 + a3) + a4)

g cos(ωi ∗ (t + ∆t))]sinθ4 + f (i)
A jω2
j

A jω2
g cos(ωi(t + ∆t
j

2 ))]sinθ2 + f (i)

A jω2
g cos(ωi(t + ∆t
j

2 ))]sinθ3 + f (i)

i := i + 1; t := i∆t;
θ1 := θ; ˙θ1 = ˙θ

j/N + vA∗

j

j=1

Table 1: Main Procedure: performs the Runge Kutta interations for the problem considering the all possible ingredients: excitation
parameters and external noise

9

3.1. Procedure 1

For N = 1, we change A and ω in the respective ranges [Amin,Amax] and [ωmin,ωmax]. For σ = 0
we look for each pair (ω,A) if the pendulum stabilizes or not by calling the main procedure (sub routine):
Main Runge Kutta Routine. For σ (cid:54)= 0 we run Nrun times the program for different seeds and we calculate
the survival probability of pendulum, i.e., psurvival = nsurvival/Nrun, where nsurvival is the number of times
that system stabilizes. In our procedure 2 psurvival is denoted by probk,m since it is associated to pair (ω,A),
parametrized as ω = ωmin + k∆ω and A = Amin + m∆A, where k = 1, ...,N1 and m = 1, ...,N2 (see again the
pseudo-code– described in Table 2).

Here (and in the other procedures) H(θ ) is the Heaviside function in the cosine argument:

 1

0

H(θ ) =

if

if

cosθ > 0
cosθ ≤ 0

Similarly, iaverk,m corresponds to survival time average over Nrun repetitions, which is interesting only
when σ (cid:54)= 0.
It is important to notice that psurvival is either 0 or 1 when σ = 0 (in this case we make
nrun = 1 necessarily). Here idum is the seed of uniform random variables generator: rand[idum]. In this
paper we used the generator ran2 of numerical recipes [10] as well as gasdev(rand[idum]) that has as input
rand[idum]. This last routine is the Gaussian random numbers generator according to Box-Muller method

which also is described in [10].

3.2. Procedure 2

For N = 2, we ﬁx A1 = A2 = A and we pick up ω1 and ω2 by chance. When σ = 0, for each pair
(ω1,ω2) spanned in the invervals [ω (1)
max] respectively, we look whether the pendulum
stabilizes or not. For σ (cid:54)= 0 we run Nrun times the program for different seeds and we estimate the pendulum
survival probability, i.e., psurvival = nsurvival/Nrun, as shown in procedure 1. This procedure can be observed
in pseudo-code described in table 3.

max] and [ω (2)

min,ω (1)

min,ω (2)

3.3. Procedure 3

Here we analyze the problem with arbitrary N > 2. More precisely, we analyze the effects for N → ∞
by a amplitude renormalization such that A(t) → At
N . It is worth notice that in doing so, we realize this is
a similar problem to N = 1, as previously described in section 2. For each selected A which varies in the
range [Amin,Amax] according to lag ∆A, we attribute A1 = A2 = ... = AN = A and we choosen N random
uniform variables ω1, ω2, ...., ωN in the inverval [0,ωmax]. The value maximum frequency to be drawn
ωmax, assumes values in the interval [0,ωsup
max] varying according to a shift ∆ω. So this procedure calls the

10

Procedure 1 : Diagram N = 1
Input:Amin,Amax,l,g,ωmin,ωmax,σ,∆ω,∆A,∆t,Niter,idum,Nrun
Parameters: N = 1,ν = 1
· N1 = (ωmax − ωmin)/∆ω;
· N2 = (Amax − Amin)/∆A;
For irun = 1,Nrun

For ic = 1, ...,Niter

fic = σ· gasdev(rand[idum])

EndFor

For k = 1,N1
For m = 1,N2

ω1 = ωmin + k∆ω
A∗
1 = Amin + m∆A

iaverk,m = iaverk,m + i/Nrun
probk,m = probk,m + H(θ )/Nrun

Call Main Runge Kutta Routine(N = 1,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0,i,θ)

EndFor
EndFor
EndFor
For k = 1,N1
For m = 1,N2

EndFor
EndFor
End Procedure

f req = ωmin + k∆ω
Ampl = Amin + m∆A
Print f req,Ampl,iaverk,m, probk,m

Table 2: This procedure is used to build data for a diagram of survival probability for each pair (ω, A) considering the parametric
excitation (oscillation at the suspention) with um cossine (N = 1) and an additive (white) noise

11

min,σ,∆ω,∆t,Niter,idum,Nrun
2 = A;ν = 1

max,ω (2)

Procedure 2: Diagram N = 2
Input:A,l,g,ω (1)
min,ω (1)
min,ω (2)
Parameters: N = 2, A∗
1 = A; A∗
max − ω (1)
· N1 = (ω (1)
· N2 = (ω (2)
max − ω (2)
For irun = 1,Nrun

min)/∆ω;
min)/∆ω;

For ic = 1, ...,Niter

fic = σ·gasdev(rand[idum])

EndFor

For k = 1,N1
For m = 1,N2
ω1 = ω (1)
ω2 = ω (2)

min + k∆ω
min + m∆ω

Call Main Sub Routine(N,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0,i,θ)

iaverk,m = iaverk,m + i/Nrun
probk,m = probk,m + H(θ )/Nrun

EndFor
EndFor
EndFor
For k = 1,N1
For m = 1,N2

EndFor
EndFor
End Procedure

f req1 = ω (1)
f req2 = ω (2)
Print f req1, f req2,iaverk,m, probk,m

min + k∆ω
min + m∆ω

Table 3: This procedure produces data for the diagram of survival probability for each pair (ω1, ω2) considering the parametric
excitation (oscillation at the suspention) with a superposition of two cosines (N = 2) and an additive (white) noise. Here the
amplitudes are A1 = A2 = A, which is also a input of the algorithm

12

main sub-routine Table: 1 with ν = 0 (which makes the rescaling). Here N is an arbitrary input, since we
study the effects of N in the asymptotic limit N → ∞.

In this case, the algorithm with this rescaling, computes the survival time (the time up destabilization)
in order to compare with stabilization diagrams with N = 1. This procedure is summarized according to

pseudo-code described in table 4.

3.4. Procedure 4

Finally, we look for an optimum number of cosines N in the stabilization of the inverted pendulum.
For arbitrary N, we also perform an optimization algorithm. Given the frequencies ω1, ω2, ..., ωN and A1,
A2, ...., AN randomly chosen uniformily in the respective intervals [ωmin,ωmax] and [Amin,Amax], we search
for the number N that maximizes the stabilization probability. Therefore the algorithm run Nrun different
formulas with parametric excitation z(t) = ∑N
i=1 Ai cos(ωit) and call the main sub-routine that solves the
Runge-Kutta for each set: {(A1,ω1), ..., (AN,ωN)}. From that, we calculate the psurvival = nsurvival/Nrun.
The procedure also computes the average time survival for completeness, but it is not used in this work.

(cid:16)

(cid:17)

1− 1

gAω2 cos(ωt)

4. Results

First of all we start looking at the phase diagrams for N = 1, d2θ

sinθ + ξ (t),
in Fig. 2. Here we will show that our simple stability criteria cosθ (t) > 0 is in accordance with results
obtained from literature (see for example [1][9])) which are based on perturbative analysis as shown in

dt2 = g
l

section 2. Based on our stability criterium we initially integrate the equations according to algorithms

described in section 3, in order to check the main results and to verify some important points not explored
in literature yet. The results for N = 1 are also important to give insights to the other cases (N ≥ 2).

In Fig. 2 we show results of simulations starting from a small angle, θ0 = 0.018, and using frequency
ω = 15 rad/s and A = 0.17 m. In our simulations, l = 1.2 m and g = 9.81 m/s2which brings in our imagi-
nation the typical situation of a child trying to stabilize a broomstick on its hand. Other dimensions deserve
discussion for large N which will be considered in other contribution [14].

In all the following results, we have used tmax = 106 iterations and ε = ∆t = 10−5. These parameter
values were settled after the observation that for t ≥ tmax and ε(cid:48) < ε no signiﬁcant variations were detected.
Fig. (2 a) and (2 b) show the time evolution and the corresponding phase diagram respectively. In this
simulation ξ (t) = 0, so that there is not any stochastic noise. The corresponding plots to (2 a) and (2 b)
when we use the small angle approximation sinθ ≈ θ (known as Mathieu equation [15])

13

max ,∆ω,∆A,∆t,Niter,idum,Nrun

Procedure 3 : Reescaling
Input:Amin,Amax,N,l,g,ω (sup)
Parameters: ν = 0
· N2 = (Amax − Amin)/∆A;
· N1 = ω (sup)
max /∆ω
For irun = 1,Nrun
For k = 1,N1

End For
For m = 1,N2

Aux = Amin + m∆A

ωmax = k∆ω

For i = 1,N

ωi =rand[idum]· ωmax

For i = 1,N
A∗
i = Aux
EndFor
Call Main Sub Routine(N,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0,i,θ)

iaverk,m = iaverk,m + i/Nrun
probk,m = probk,m + H(θ )/Nrun
EndFor

EndFor
EndFor
For k = 1,N1
For m = 1,N2
f req = k∆ω
Ampl = Amin + m∆A
Print f req,Ampl,iaverk,m, probk,m

EndFor
EndFor
End Procedure

Table 4: Giving a superposition of N cosines exciting the basis of pendulum, this procedure calculate the average survival time of
pendulum calling the main subroutine when the amplitudes are rescaled. The plots must recover in some instance, the plots the
standard plots for N = 1

14

Procedure 4 : Optimization
Input:Amin,Amax,Nmax,l,g,ωmin,ωmax,∆ω,∆A,∆t,Niter,idum1,idum2,Nrun
Parameters: ν = 1
For N = 1,Nmax

For irun = 1,Nrun
For i = 1,N
ωi = ωmin+rand[idum1]· (ωmax − ωmin)
Ai = Amin+rand[idum2]· (Amax − Amin)
End For
Call Main Sub Routine(N,Niter,∆t,g,l,ω[N],A∗[N],ν, f [Niter],θ0, ˙θ0,i,θ)
iaverN = iaverN + i/Nrun
probN = probN + H(θ )/Nrun

EndFor

EndFor
For N = 1,Nmax

Print N,iaverN, probN

EndFor
End Procedure

Table 5: Procedure that determines the N that maximizes the probability of stabilization considering different ensemble of formulas

(cid:18)
1− 1
g

··
θ − g
l

(cid:19)

Aω2 cos(ωt)

θ = 0

(14)

are observed in (2 c) and (2 d) respectively.

The fact that this ﬁgure illustrates a case where the initial condition leads to a non-stable outcome is

not os relevant here, since they do not satisfy eq. 10. However what call ones attention is the fact that
small initial angle leads to a different different divergence for θ (t) for large times (instability) whether the
one replaces sinθ by θ or not. The plot (2 c) is in mono-log scale since there is a exponential divergence
(straight line in this scale) which is more pronounced than in (2 a). Such aspect although seems very simple

is simply discarded by some authors in literature. The very different phase diagrams (b) and (d) obtained

for these different regimes shows even more our thesis about this topic.

In the results shown in Fig. 2, we consider a larger amplitude A = 0.50 m. Now, that Eq. 10 is satisﬁed,
·
θ as function of time in Fig. (3 a) and now beautiful Lissajous

we can see a periodic behavior for θ and
plot in the phase space shown in Fig. (3 b).

Differently from the Fig. 2 the plots (3c) and (3d) corresponding to small oscillations regime are here

omitted since there is no signiﬁcant difference in the simulations.

In order to study initial angles’ effects, we analyze the phase diagram ω × A obtained via numerical

15

Figure 2: Results for time evolving and phase diagram considering θ0 = 0.018 rad, ω = 15 rad/s and A = 0.17 m. (a) Time evolving
·
θ × θ (c) The corresponding Fig. (a) in small oscillations approximation sinθ ≈ θ–
θ and
Mathieu equation. (d) Corresponding phase diagram in this approximation.

·
θ. (b) Corresponding phase diagram

simulations. The diagrams are shown in Fig. 4, and which they correspond to results from Procedure
1: Table 2 (in this case we make Nrun = 1). It is important to consider that Eq. 10 determines a lower
√
2gl
ω . On the other hand, when the amplitude A is increased beyond a certain
bound for amplitude: Amin =
critical value Amax, the pendulum loses its stability again [12, 13, 9] and its evolution cannot be described by
effective potential method (perturbative analysis). It is shown in Butikov [9], based in simulation (heuristic)

arguments, shows that the solution over the upper boundary of stability has a simple spectral decomposition
in only two frequencies: ω/2 and 3ω/2, such that θ (t) = A1 cos(ωt/2) + A3 cos(3ωt/2). By using this
hypotesis and substituting this solution in Eq. 14 (instead of the exact equation Eq. 1) we have:

117 + 232(ω0/ω)2 + 80(ω0/ω)4 − 9− 4(ω0/ω)2

(15)

(cid:21)

(cid:20)(cid:113)

A < Amax =

l
4

16

0204060801000200400-1000100200300400500-1001020010203040506070809010001x101052x101053x101054x101055x1010501x101062x10106  t  ddtradm, and rad/s(b)ddt  ddt(a)10181098   t  d/dtaproximation1058(d)(c)  aproximationFigure 3: Results for time evolving and phase diagram considering θ0 = 0.018 rad, ω = 15 rad/s and A = 0.50 m. (a) Time evolving
θ and

·
θ. (b) Corresponding phase diagram

·
θ × θ.

The solid and dashed black curves show respectively the lower (Eq. 10) and upper (Eq. 15) stability

domain boundaries. First, we see that the blue region is being destroyed as the initial angle increases, but we

need to pay attention to the way it happens. We can observe an interesting effect: there is a set of conditions

in the primary stability region that loses its stability so that the region becomes fragmented, while another

set above the upper limit becomes stable. The upper limit, established in [9], is really restricted to small

angles showing that is based in the approximated equation, which again indicates the importance of the

numerical work here. However the lower bound obtained by the effective potential is absolutely respected

(not invaded by stability region).

In Fig. 5 we show the effects of an additive random noise. We are interested in seeing how the stability

diagram is degraded according to the increase of noise variance. Each plot corresponds to a different
variance (σ 2). So, we run procedure I (see table 2) with Nrun = 50 times with different seeds and we

17

Figure 4: Initial angle effects on the diagram phases ω × A. The upper (solid) and lower (dashed) curves correspond respectively
to the limits established by Eqs. 10 and 15.

calculate the survival probability:

psurvival =

nsurvival
Nrun

where nsurvival is the number of times in which our pendulum stabilizes. The color scale are graduated
according to the psurvival-values that were obtained.

Now we focus our analysis in the case N = 2, where we make A1 = A2 = A according to Procedure II:
Table 3. The results show a rich structure as we can see in Fig 6. We illustrate two different initial angles
for A = 0.17 recalling that red stands for unstable regions, while blue denotes stabilization. Comparing the

ﬁgures on the left with the ones on the right (small angles approximation) we can see that it is important
to consider sinθ and not to make the approximation sinθ ≈ θ, even for very small angles θ0 = 0.018 rad
≈ 1o. We can observe a less restrictive condition ω2
A2 (a quarter circle, plotted in all ﬁgures),
which corresponds a condition that ω1 ≈ ω2 = ω. Exactly in diagonal the condition goes to ω2 ≤ gl
A2 ,

2 ≤ 2gl

1 + ω2

18

Figure 5: External (additive) stochastic noise effects on the diagram phases ω × A. The different plots correspond to different
standard deviations (σ) of noise φ (t).

which asserts the diagonal line penetrating the 1/4-circle. But, we have more stability regions inside this
semi-circle which depend on the proximity of the diagonal. However for θ0 = 0.518 the system recover the
restriction and all quarter of circle is completed but not for the small angles approximation.

However, even more interesting, one should note that it is not always the case that ω1 and ω2, both
large, will lead to stabilization. We see branches of unstable regions that remind us of Arnold tongues [16]

breaking the stability sea, specially around diagonal the diagonal. It is not our task in this paper to describe

the properties of these unstable branches, but they are certainly very rich sets of fractal dimensions [17].

This fractal structure set is deeply modiﬁed when θ0 = 0.518 but only when the numerical solution is

not performed in small angle approximations.

In the Fig. 7 we show the same simulation of Fig. 6 for a larger amplitude A = 0.34. Now we have a

larger instability region. Details of the complexity of unstable branches look less pronounced on the scale

19

Figure 6: Initiall angle effects N = 2. We used A = 0.17.

of this ﬁgure, but it does not mean that they are not there.

In Fig. 8 we also analyze the effect of noise on the stabilization diagram similar to the case shown in
Fig. 5 for N = 1. Again, Nrun = 50 and we observe only one case one case (σ = 6), since the behavior is
similar to the case N = 1, that is, the degraded region enlarges as σ enlarges. The case A = 0.34 m is less
sensitive to degradation than A = 0.17 m.

At this point it is important to analyse the results from the perspective of the effective potential method
according to Eq. 11. Recall that we are dealing with the case of N = 2 and equal amplitudes so that Eq. 11
depends on a variable T , which must be function of ω1 and ω2 not always easily determined. So, ﬁrst we
consider what we think that are reasonable choices of T as shown in Fig. 9.

It is clear from these results that the stability diagrams obtained from the effective potential approxima-
tion depends strongly on the choice of T . From all the numerical simulations, the best option is the choice
T = max(T1,T2). Another limitation of Eq. 11 is shown in Fig. 10. Here, for different amplitudes we

20

Figure 7: Initiall angle effects N = 2. We used A = 0.34. Similar to Fig. 6.

have the same stabilization pattern, except by the fact that the pattern is rescaled with A. On the contrary,
however, simulations show that A = 0.17 and A = 0.34 (please see again Figs. 6 and 7 have completely
different diagrams than ones which are shown in the Fig. 10. Just as in the case N = 1, we must also have
an upper limit for the amplitude A, however a formulas like Eq. 15 is beyond of our expectations.

(cid:16)

dt2 = g
l

1− A

g ∑ω2

(cid:17)

Now let us studying the stochastic stabilization considering N > 2. Dettman, keating and Prado [8]

dt2 =(cid:0)1− A∑N

i=1 sin(ωit + ϕi)(cid:1)θ

i cos(ωit)

studied this problem in the context of stochastic stabilization of chaos. And they showed not using our
pendulum inverted equation: d2θ
that θ pendulum should be stabilized. Indeed for this particular equation this indeed occurs. We tested this
equation with parameters used in this paper: A = 38, by changing sin by cos (to bring even more proximity
with our case) and moreover making ϕ1 = ϕ2 = ... = 0 which they did not used but which bring even more
to similarity with our case. So we also perform 100 frequencies chosen at random from [120, 600] and
we do stabilize. However this means to make g = l = 1 in our case which is not real parameters for our

sinθ but so d2θ

21

Figure 8: External Noise effects for effects N = 2. Comparison for A = 0.17 and A = 0.34 for σ = 6. We consider θ0 = 0.018.

problem. By making g = l = 1 we also numerically stabilize θ even considering ω2
i term in the sum which
does not appear in [8], but the same does not ocurrs with real values in our case (l = 1.2 m and g = 9.81
m/s2). The general arbitrary case ω2
i deserves an special attention and
the problem is being studied by the authors in another contribution (see [14])

0 = g/l with the presence of term ω2

This negative case leads to look the problem in a alternative point of view as we presented in section 2.
For that we consider the case for N large considering a normalization for amplitude: A(t) = Ct, with
CN = aωmax onde ω1, ω2,..., ωN are randomly chosen in interval [0,ωmax]. Such choice as previously
reported must captures the case N = 1 at least for survival time. So we perform simulations (Procedure III -
Table 4) that performs a random formula with N cosines. So we build diagrams a versus ωmax for survival
time (time that pendulum remains stable according the established condition) which can be observed in Fig.

11.

After this interesting phenomena that brings N large for N = 1, we concentrate our ideas for an inter-

22

010203040010203040010203040010203040A = 0.17, = 6   A = 0.34, = 6   Figure 9: Potential effective for N = 2 according to Eq. 11. We show some choices for T . The best one (that better ﬁts with
simulations is to consider the maximal between periods.

esting optimization process related to stability of pendulum. What the best N for a stabilization of inverted

pendulum. This question when performed so free seems to be no interesting. However, the question is, if
we would consider an ensemble of formulas by randomly chosen ω1, ...,ωN and A1, ...,AN in the intervals
[ωmin = 0,ωmax] and [Amin = 0,Amax] by repeating Nrun = 2000 different formulas and for each choise we
observe the stability or not of the pendulum by calculating with this sample a survival probability. We used

our Procedure 4: table 5 to calculate such probability. The Fig. 12 shows the survival probability in different

situations.

The upper plot in this ﬁgure by keeping Amax = 0.17m and we plot the probability for different values
of ωmax. The different frequencies does not change the Nmax(value that maximizes the survival probability).
However the midle ﬁgure, shows that keeping ωmax ﬁxed and by plotting the survival probabilities for
different values Amax. In this case we change the Nmax. But it is important to notice that different initial

23

Figure 10: Potential effective for N = 2 according to Eq. 11. We show that for different amplitudes we have the same behavior
which shows that effective potential as case N = 1 has a limitation since numerically we have very different diagrams considering
A = 0.17 and A = 0.34.

angles does not change Nmax as reported in the lower plot in same Fig. 12.

5. Conclusions

In this paper we have detailed the study of inverted pendulum under a parametric excitation in its basis
which is described by a superposition of N cosines. In case N = 1 we explore diagrams A × ω. We show
that depending of initial conditions the effective potential method diverges from the numerical simulations,
which also occurs in N = 2 that presents a interesting diagram where stability regions are alternated with no
stability ones in a fractal structure. The diagonal ω1 = ω2 = ω has a important hole in the stability due to
the known bating problem in waves. Although the effective potential method is extended for arbitrary N is

extended for arbitrary cases its usuality depends on choice of a common period existence and its utility has

several limitations by showing the necessity of Runge Kutta integrations of equations which in this paper is

24

Figure 11: Diagram a× ωmax. For each pair the point corresponds to survival time (necessary time for the pendulum loses its
stability). We can observe a better agreement with region determined by bounds as N enlarges which shows that case N = 1 has a
capture according to amplitude normalization.

separated in four procedures used in each part of our manuscript and showed in details.

For N > 2 we perform two kind of analysis: a) a discussion about stochastic stabilization and b) op-

timization of survival probability of pendulum. In this ﬁrst part (a), starting from hypothesis that inverted
pendulum with real parameters cannot be stabilized for N large (this not occurs with suitable choice of pa-
rameters) we show that problem for N large can be reduced for N = 1 if we look for survival time, i.e., the

properties of survival time diagram when via a suitable scale in the amplitude are preserved when compared
with regular, N = 1 diagram. In second part (b) we choose randomly choose amplitudes and frequencies
in ranges and we calculate the survival probability of pendulum in order to observe the optimal N that

maximizes such probability. We have two important three important conclusions here by observing our
numerical studies : a) By ﬁxing the upper limit of the frequencies chosen and changing the amplitude, Nopt
depends on amplitude b) By ﬁxing the upper limit of the amplitude and changing frequency, Nopt remains

25

the same. The initial angles seems to be does not change Nopt.

Acknowledgments – This research was partially supported by the Conselho Nacional de Desenvolvi-
mento Cientiﬁco e Tecnologico (CNPq), under the grant 11862/2012-8. The authors would like to thank

Prof. L.G. Brunet (IF-UFRGS) for kindly providing the computational resources from Clustered Computing

(ada.if.ufrgs.br) for this work.(2014)

References

[1] R. A. Ibrahim, J. Vib. Control 12(10), 1093-1170 (2006)
[2] R. A. Ibrahim, Stabilization and Stochastic Bifurcation with applications in ocean structures, chapter 1, page 1-52 in the

Collection: Stochastically Excited Nonlinear Ocean Structures edited by M. F. Shlesinger, T. Swean (1998)

[3] Y. Kim, S. H. Kim, Y. K. Kwak, Journal of Intelligent and Robotic Systems, 44(1), 25-46 (2005)
[4] A. Stephenson, The London, Edinburgh and Dublin Philosophical Magazine and Journal of Science 6(15), 233-237 (1908)
[5] P. L. Kapitza, Zhur. Eksp. i Teoret. Fiz., 21, 588 (1951)
[6] J. L. Bogdanoff, S. J. Citron, J. Acoust. Soc. Amer. 38, 447-452 (1965)
[7] R. Yang, Y. Peng, Y. Song, Nonlinear Dyn. 73, 737–749 (2013)
[8] C. P. Dettmann, J. P. Keating, S. D. Prado, Int. J. Mod. Phys. D. 13(7) 1-8 (2004)
[9] E. I. Butikov, Am. J. Phys. 69(6) 1-14(2001)
[10] W. H. Press, S. A. Teukolsky, W. T. Vetterling, B. P. Flannery, Numerical recipes in Fortran 77: the art of scientiﬁc computing,

Cambridge University Press, 1992

[11] L. D. Landau, E.M. Lifshitz, Mechanics ( Volume 1 of A Course of Theoretical Physics ) Pergamon Press,1969
[12] J. A. Blackburn, H. J. T. Smith, N. Groenbech-Jensen, Am. J. Phys. 60(10) 903-908 (1992)
[13] H. J. T. Smith, J. A. Blackburn, Am. J. Phys. 60(10) 909-911 (1992)
[14] R. da Silva, S. D. Prado, preprint (2016)
[15] N. W. McLachlan, Theory and Application of Mathiey Functions, Clarendon Press, Oxford (1947)
[16] V. I. Arnold, Mathematical Methods of Classical Mechanics, Springer New York (1978)
[17] E. Ott, Chaos in Dynamical Systems, Cambridge University Press (1993)

26

Figure 12: Survival probability according to Procedure IV.

27

02468101214160.00.10.20.30.40.50.60.70.8   max = 20 rad/s  max = 40 rad/s max = 80 rad/s  max = 160 rad/s m survival probabilityN02468101214161820220.000.150.300.450.60   Amax = 0.08 m  Amax = 0.17 m Amax = 0.34 m  Amax = 0.68 m survival probabilityNmax = 80 rad/s02468100.00.10.20.30.4    survival probabilityN