On Optimal Policies in Full-Duplex Wireless

Powered Communication Networks

Mohamed A. Abd-Elmagid∗, Alessandro Biason†, Tamer ElBatt∗‡, Karim G. Seddik§ and Michele Zorzi†

∗ Wireless Intelligent Networks Center (WINC), Nile University, Giza, Egypt

† Department of Information Engineering, University of Padova - via Gradenigo 6b, 35131 Padova, Italy

§ Electronics and Communications Engineering Department, American University in Cairo, AUC Avenue, New Cairo 11835, Egypt

‡ Dept. of EECE, Faculty of Engineering, Cairo University, Giza, Egypt

email: m.abdelaziz@nu.edu.eg, biasonal@dei.unipd.it, telbatt@ieee.org, kseddik@aucegypt.edu, zorzi@dei.unipd.it

6
1
0
2

 
r
a

 

M
6
1

 
 
]
T
I
.
s
c
[
 
 

1
v
2
3
1
5
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—The optimal resource allocation scheme in a full-
duplex Wireless Powered Communication Network (WPCN)
composed of one Access Point (AP) and two wireless devices
is analyzed and derived. AP operates in a full-duplex mode
and is able to broadcast wireless energy signals in downlink
and receive information data in uplink simultaneously. On the
other hand, each wireless device is assumed to be equipped
with Radio-Frequency (RF) energy harvesting circuitry which
gathers the energy sent by AP and stores it in a ﬁnite capacity
battery. The harvested energy is then used for performing uplink
data transmission tasks. In the literature, the main focus so
far has been on slot-oriented optimization. In this context, all
the harvested RF energy in a given slot is also consumed in
the same slot. However, this approach leads to sub-optimal
solutions because it does not take into account the Channel State
Information (CSI) variations over future slots. Differently from
most of the prior works, in this paper we focus on the long-
term weighted throughput maximization problem. This approach
signiﬁcantly increases the complexity of the optimization problem
since it requires to consider both CSI variations over future
slots and the evolution of
the batteries when deciding the
optimal resource allocation. We formulate the problem using
the Markov Decision Process (MDP) theory and show how to
solve it. Our numerical results emphasize the superiority of our
proposed full-duplex WPCN compared to the half-duplex WPCN
and reveal interesting insights about the effects of perfect as
well as imperfect self-interference cancellation techniques on the
network performance.

Index Terms—WPCN, energy transfer, RF energy, cellular
networks, green communications, energy harvesting, Markov
Decision Process, optimal policy.

I. INTRODUCTION

In the past few years, there has been an increasing research
interest
in developing new strategies and technologies for
improving the devices lifetime in mobile networks (e.g., Wire-
less Sensor Networks (WSNs)). Among the others, Energy
Harvesting (EH) has emerged as one of the most appealing
and consolidated solutions. With EH,
it becomes possible
to recharge the batteries of the devices using an external
ambient energy source (e.g., sunlight, wind, electromagnetic
radiation, vibrations, etc.). Nevertheless, ambient sources have
the drawback of being random, not controllable and, moreover,
they may not be always available depending on the time of the
day or the devices location. An interesting alternative is given

This work was supported in part by the Egyptian National Telecommuni-

cations Regulatory Authority (NTRA).

by the Wireless Energy Transfer (WET) paradigm, in which
an energy rich source, e.g., an access point, transfers energy
wirelessly to the devices only when necessary. In contrast with
classic solutions, when the devices are battery-powered the
transmission scheduling problem becomes more challenging
and a correct management of the available energy is required
in order to achieve high performance.

Energy transfer is a groundbreaking technology with several
signiﬁcant consequences in WSNs. First of all, plugs and
cables are no longer necessary, saving replacement times and
costs. Moreover, differently from the traditional ambient EH,
nodes do not need to generate energy locally but can be
supplied with energy efﬁciently generated elsewhere. Recently,
thanks to the development of WSNs and mobile battery-
powered devices, WET has experienced a renewed research
interest. A typical example where WET can be used is a
wireless body area network, in which on-body devices need to
communicate the gathered medical data to an external node. To
implement WET, three main techniques have been proposed in
the literature so far. Inductive coupling and strongly coupled
magnetic resonances [1] can be used with high efﬁciency at a
distance of few centimeters or meters, respectively. However,
since transmitter and receiver coils require to be aligned, these
technologies are more suitable for ﬁxed scenarios. Instead,
RF energy transfer, which is the focus of this paper, can
operate at larger distances and does not require a precise
alignment between devices, and thus is more versatile and
can be applied to a larger number of scenarios. Several
different aspects of WET have been studied by both industry
and academia, e.g., in terms of antenna design [2] but also
in terms of communication protocols. In this last area, the
main topics introduced so far are SWIPT, energy cooperation
and WPCNs. SWIPT (Simultaneous Wireless Information and
Power Transfer) aims to ﬁnd the tradeoffs between simulta-
neous energy transfer and information transmission [3]. Time
and power splitting approaches are considered for this problem
according to the current technology limitations [4]–[10]. A
different area analyzes the energy cooperation paradigm, in
which devices exchange their available energy to improve the
system performance and achieve fairness [11]–[13]. Finally,
WET allows the development of WPCNs, in which an energy
rich node feeds a communication network.

In a WPCN, the devices far away from the energy rich node
experience, on average, worse channels in both uplink and

it

downlink, leading to a doubly near-far effect (more energy is
required in both directions). A common approach to solve this
problem is to use a “harvest-then-transmit” scheme, in which
the downlink (energy transfer) and uplink (data transmission)
phases are temporally interleaved [14]. It is also possible to
exploit data cooperation to increase the throughput of the
system [15]. However, this approach is suitable only for a
smaller set of scenarios in which the terminal devices are
closely placed. Moreover,
induces higher computational
complexity to derive the scheduling policy. [16] described
a harvest-then-cooperate protocol, in which source and relay
work cooperatively in the uplink phase for the source’s in-
formation transmission. The authors also derived approximate
closed-form expressions for the average throughput of the
proposed protocol. [17] studied the case of devices with energy
and data queues and described a Lyapunov approach to derive
the stochastic optimal control algorithm which minimizes the
expected energy downlink power and stabilizes the queues.
The long-term performance of a single-user system for a
simple transmission scheme was presented in closed form
in [18]. [19] modeled a WPCN with a Decentralized Partially
Observable Markov Decision Process (Dec-POMDP) and min-
imized the total number of waiting packets in the network.
[20] showed that energy beamforming can be used to increase
the system performance. The concept was extended in [21]
for massive multiple-input-multiple-output
technologies. A
WPCN with heterogeneous nodes (nodes with and without RF
energy harvesting capabilities) was studied in [22] and it was
shown how the presence of non-harvesting nodes improves the
network performance compared to traditional WPCNs [14].
[23] introduced a generalized problem setting for WPCNs,
compared to prior work, e.g., [14], [22], in which all the nodes
are jointly equipped with batteries and RF energy harvesting
circuitry. This is an important step towards more realistic
future wireless networks as RF energy harvesting technology
gradually penetrates the wireless industry.

Most of previous works describe a half-duplex system in
which the uplink and downlink phases cannot be performed
simultaneously. Instead, in this work we focus on the full-
duplex case [24], [25]. [24] optimized the time allocations
for WET and data transmission for different users in order to
maximize the weighted sum throughput of the uplink transmis-
sions. The authors considered perfect as well as imperfect self-
interference cancellation at the access point and showed that,
when self-interference cancellation is performed effectively,
the performance of the full-duplex case outperforms that of
half-duplex. A survey of recent advances and future perspec-
tives in the WPCNs ﬁeld can be found in [26]. In this work we
study a pair of energy harvesting devices which gather energy
from a common access point in the downlink phase and use
it to upload data packets. The received energy and the uplink
data packets are transmitted in the same frequency, and are
both affected by ﬂat fading. AP is equipped with two antennas
and is able to perform self-interference cancellation in order
to receive data and transfer energy simultaneously, whereas
the two devices have only one antenna. Differently from
previous work [27], [28] where we analyzed the half-duplex
case, better performance can be achieved in the full-duplex

scenario. In particular, we numerically characterize how the
throughput region of the two devices expands. Moreover, we
compare the full-duplex and half-duplex cases as a function
of different design parameters. Our focus is on the long-term
throughput optimization problem and not on the classic slot-
oriented optimization [15], [20]. In this case, the batteries of
the two devices are not discharged in every slot, but energy
can be stored for future use (e.g., more energy will be used if
the channel conditions are good, and vice-versa).

The paper is organized as follows. Section II describes the
model of the system. The long-term optimization problem
is stated in Section III. We present our numerical results in
Section IV. Finally, Section V concludes the paper.

II. SYSTEM MODEL

We study a WPCN composed of one Access Point (AP)
and two wireless devices, namely, D1 and D2. AP is equipped
with a stable energy supply, whereas each terminal device Di,
i ∈ {1, 2}, is equipped with an RF energy harvesting circuitry
and no other energy sources. Di harvests the energy broadcast
by AP in the downlink phase and stores it in a battery with
capacity Bi,max joules. The stored energy is then used for
uplink data transmission. Each wireless device is assumed to
be equipped with only one antenna, thus, at a given time
instant, it can either harvest wireless energy in downlink or
transmit data in uplink. On the other hand, AP is equipped
with two antennas and can operate in a full-duplex mode: since
the WET and the data transmission are performed in the same
frequency band, one antenna is dedicated to WET and the
other to data reception. This, in turn, highlights the practical
issue, associated with full-duplex communication systems, of
self-interference at the AP side. Self-interference at AP arises
from the fact
the wireless energy signals transmitted
by AP in downlink are also received by the other AP’s
antenna and, hence, interfere with the uplink data transmission
signals. In practice, the self-interference power is signiﬁcantly
larger compared to the power of the desired data signals.
Therefore, self-interference cancellation techniques are a key
aspect in implementing full-duplex communication systems.
One of our objectives is to show the effect of perfect as well
as imperfect self-interference cancellation techniques on the
network performance.

that

The time horizon is divided into slots of length T and
slot k = 0, 1, . . . corresponds to the time duration [kT, (k +
1)). The complex random variables gi and hi represent the
downlink channel coefﬁcient from AP to Di and the uplink
channel coefﬁcient from Di to AP, respectively. The power
gains in downlink and uplink are obtained as gi = |gi|2
and hi = |hi|2. In addition, we denote the effectiveness
of self-interference cancellation techniques by a scalar gain
γ ∈ [0, 1] [24], [29]. More speciﬁcally, if γ = 1 no self-
interference cancellation is adopted, while if γ = 0 AP cancels
self-interference perfectly. The details of the methods used
for self-interference cancellation are beyond the scope of this
work (see [30]–[32] for further details). It is assumed that
all downlink and uplink channels are affected by quasi-static
ﬂat fading, i.e., all channels remain constant over a time slot

represents the uplink transmission power, where ρi,max de-
notes the maximum allowable uplink transmit power of Di.
The min-operation is used to consider the effects of the
devices’ ﬁnite capacity batteries. In addition, the arguments of
the min are always non-negative since Ei ≤ Bi. The battery
evolution depends on the choices of all parameters Pi, τi and
ρi, which are the objective of our optimization problem.

According to Shannon’s formula,

the achievable uplink

throughput of Di is given by

(cid:18)

(cid:19)

hiρi

σ2 + γPi

,

(4)

Figure 1: Slot time allocation.

R (τi, ρi, Pi, hi) = τi log

1 +

but change independently from one slot to another. Moreover,
it is assumed that AP has perfect knowledge of all channel
coefﬁcients at the beginning of each slot.
As shown in Figure 1, the slot duration is divided into three
portions of time denoted by τi, i ∈ {0, 1, 2}. AP keeps broad-
casting wireless energy signals over the entire slot duration.
Let Pi denote the average transmit power by AP within τi. It
is assumed that Pi ≤ Pmax, where Pmax < ∞ is a technology
parameter which denotes the maximum allowable power that
can be used by AP to transmit wireless energy signals. The
ﬁrst portion of time, τ0, is devoted to downlink wireless energy
transfer, so that each device could harvest a certain amount of
energy and charge its battery. The importance of devoting the
ﬁrst portion of the slot duration to wireless energy transfer
only is to address the scenario in which both batteries are
empty at the beginning of a given slot. Afterwards, during the
remaining time T − τ0, the portions of time denoted by τ1 and
τ2 are assigned to D1 and D2, respectively, for uplink data
transmission. Hence, the slot portions satisfy:

τ0 + τ1 + τ2 ≤ T.

(1)

It is assumed that Pi

is sufﬁciently large such that the
harvested energy at each device due to the uplink informa-
tion transmissions by the other and to the receiver noise is
negligible. Therefore, the amount of energy per slot harvested
by Di is given by

Ci = ηigi

τjPj,

(2)

j=0
j(cid:54)=i

where ηi denotes the efﬁciency of the energy harvesting
circuitry [33]. The value of ηi depends on the efﬁciency of
the harvesting antenna, the impedance matching circuit and
the voltage multipliers.

In order to characterize the maximum achievable throughput
by the system, we assume that the transmission data queues
are always non empty, i.e., D1 and D2 always have data to
transmit (this assumption can be extended as in [34]). Thus,
the energy level of Di is updated according to (the energy
gathered in a given slot can be exploited only in later time
slots)

Bi ← min{Bi,max, Bi − Ei + Ci},

(3)
where Ei = τiρi ∈ [0, Bi,max] is the amount of energy
consumed by Di for uplink data transmission and ρi ≤ ρi,max

2(cid:88)

where σ2 denotes the noise power at AP and γPi
is the
effective self-interference power after performing imperfect
self-interference cancellation techniques at AP.

In the literature on full-duplex WPCNs [24], [25],

the
optimal time and power allocations were chosen in order to
maximize the sum throughput of the slot-oriented case. Thus,
the total amount of harvested energy by each wireless device,
in a given slot, had to be consumed in the same slot for uplink
data transmission. This policy leads to sub-optimal solutions
since it determines the optimal resource allocation subject
only to the current CSI and does not take into account the
CSI variations over future slots. In this work, our objective is
to characterize the optimal policy to maximize the weighted
sum throughput. Towards this objective, we focus on the long-
term maximization. The MDP and the associated optimization
problem are presented in the next section.

III. OPTIMIZATION PROBLEM

In this section, we introduce the optimization problem and
describe how to solve it. The throughput of the system can be
deﬁned as the weighted sum-throughput of the two devices

Gµ = αG1,µ + (1 − α)G2,µ,

(5)

where α ∈ [0, 1]
is a constant which accounts for the
importance of D1 or D2 and µ is the policy, i.e., the strategy
which establishes the transmission parameters of both devices.
For different values of α, different operating points can be
found. For example, if α = 0 or α = 1, then only one device is
considered. Differently, α can be chosen in order to guarantee
G1,µ = G2,µ (fair-throughput) as in [27], or to maximize the
sum-throughput (α = 0.5). Our focus is on the long-term
undiscounted optimization, thus Gi,µ is deﬁned as

Gi,µ = lim inf
K→∞

1

K + 1

k=0

E[Rµ(τi,k,ρi,k,Pi,k,hi,k)|B(0)

1 ,B(0)
2 ],

(6)

2

where we explicitly stated the time dependencies k, B(0)
and
are the battery levels in slot 0, Rµ(·) is the reward deﬁned
B(0)
in Equation (4) obtained with a policy µ and the expectation
is taken with respect to the channel conditions and the policy.
Formally, our goal is to ﬁnd the Optimal Policy (OP) µ(cid:63)

1

such that

µ(cid:63) = arg max

µ

Gµ.

(7)

K(cid:88)

To ﬁnd OP, we adopt a dynamic programming approach and
model the system as a Markov Decision Process [35]. The state
of the system is given by (b1, b2, g1, g2, h1, h2), where bi is
the current battery level deﬁned in (3) expressed in energy
quanta and gi, hi are the channel gains deﬁned in Section II.
We use the notion of “energy quantum” to indicate the basic
amount of energy, deﬁned as the ratio Bi,max/bi,max, where
bi,max is the maximum amount of energy quanta storable
at device Di. For every state of the system, the policy µ
speciﬁes the transfer powers P0, P1, P2, the duration τ0, τ1,
τ2 and the uplink transmission powers ρ1, ρ2. µ is evaluated
ofﬂine according to the channel statistics and is known to AP
(centralized scenario). At the beginning of every time slot, AP
informs the nodes about the current policy. Also, in order to
derive an upper bound to the performance, we assume that
the state of the system is known to AP1. In summary, the
optimization problem can be formulated as follows

E[Rµ(τi,k,ρi,k,Pi,k,hi,k)|B(0)

1 , B(0)
2 ],

K(cid:88)

1

K + 1

k=0

max

µ

lim inf
K→∞

s.t.:

τi,kρi,k ≤ Bi,k = bi,k

Bi,max
bi,max

,

i ∈ {1, 2},

2(cid:88)

τi,k ≤ T,

i=0

τi,k ≥ 0, 0 ≤ Pi,k ≤ Pmax,
0 ≤ ρi,k ≤ ρi,max,

i ∈ {0, 1, 2},
i ∈ {1, 2}.

(8a)

(8b)

(8c)

(8d)
(8e)

A. Dynamic Programming Problem

We now describe the details of the MDP problem we set up.
We model the system with a discrete multidimensional Markov
Chain (MC). Every state of the system (b1, b2, g1, g2, h1, h2)
corresponds to a different MC state. In order to use standard
optimization techniques like the Value Iteration Algorithm
(VIA) or the Policy Iteration Algorithm (PIA), we discretize
the battery levels and the channel gains. Even if it may
be possible to minimize the discretization levels in order to
simplify the numerical evaluation, we adopt a simple approach
and divide the batteries uniformly in bi,max + 1 levels and the
channels in intervals with the same probability (according to
the fading pdfs).
of moving
(b1,b2,g1,g2,h1,h2) to s(cid:48) (cid:44) (b(cid:48)
1,b(cid:48)
certain policy µ is

(cid:44)
2) given a

from state
2,g(cid:48)
1,g(cid:48)
1,h(cid:48)

probability

2,h(cid:48)

The

s

Pµ
s→s(cid:48) =

1
nch

P (b(cid:48)

i = bi − τiρi + ci, i = {1, 2}|s, µ)

(9)

1This can be obtained by piggybacking the state of the batteries in the

uplink packets and estimating their evolution.

(8b) imposes that Di does not use more energy than its stored
amount. (8c) coincides with Constraint (1). (8d) and (8e)
deﬁne the upper and lower bounds for all the optimization
variables.

µ(b1,b2,g1,g2,h1,h2) =

P (b(cid:48)

1 = b1−τ1ρ1 +c1|s,µ) P (b(cid:48)

2 = b2−τ2ρ2 +c2|s,µ)

(cid:36)

=

ci (cid:44)

2(cid:88)

j=0
j(cid:54)=i

ηigibi,max

Bi,max

nch

(cid:37)

τjPj

,

(10)

(11)

1, h(cid:48)

2, h(cid:48)

where nch represents the total number of channel realiza-
tions and 1/nch is the probability of observing the pair
(g(cid:48)
1, g(cid:48)
2), which is independent of µ and thus can be
i = bi − τiρi + ci repre-
separated from the other terms. b(cid:48)
sents the discretized version of Equation (3) and the ﬂoor is
used because of the discrete number of energy levels. Note
i = bi − τiρi + ci, i = {1, 2}|s, µ)
that we decomposed P (b(cid:48)
in two separate probabilities because, given the policy µ, the
two batteries evolve independently.2 The probability can be
reduced to

Pµ
s→s(cid:48) =

1
nch

χ{b(cid:48)

i = bi − τiρi + ci, i = {1, 2}}

(13)

where χ{·} is the indicator function. Practically, the MC tran-
sition probabilities are deterministic because all the random
effects are already included in the MC state.

B. Cost-to-go Function

Problem (8) can be solved using dynamic programming
techniques. In this context, a policy µ can be interpreted
as a vector of functions of the state of the system µ =
µ(b1, b2, g1, g2, h1, h2), where the entries of µ are

 τi(b1,b2,g1,g2,h1,h2), i ={0,1,2}

ρi(b1,b2,g1,g2,h1,h2), i ={1,2}
Pi(b1,b2,g1,g2,h1,h2), i ={0,1,2}
(14)

,

where we explicitly wrote the dependencies of all the variables
on the state of the system. Using VIA, Problem (8) can be
solved using the cost-to-go function

J (I)
µ (s) = max
P0,P1,P2
τ0,τ1,τ2

ρ1,ρ2

αRµ(τ1, ρ1, P1, h1)

+ (1 − α)Rµ(τ2, ρ2, P2, h2)+

(15)

(cid:105)

s→s(cid:48)J (I−1)
Pµ

µ

(s(cid:48))

(cid:88)

s(cid:48)

where (I) represents the I-th iteration of VIA [36]. (15) can be
iteratively solved for every state of the system until conver-
gence. Every optimization step is subject to the constraints
of (8). From the last iteration of VIA, indicated with the
symbol “(inf)”, the objective function Gµ can be computed
as Gµ = J (inf)
(s0), where s0 is the initial state of the system.

µ

1 = b1,max, P(cid:0)b(cid:48)

2(10) holds when b(cid:48)

b(cid:48)

1 < b1,max and b(cid:48)

1 = b1−τ1ρ1 +c1|s,µ(cid:1) should be replaced with
1 ≥ b1,max−τ1ρ1 +c1|s,µ(cid:1)
P(cid:0)b(cid:48)

2 < b2,max. Otherwise, if for example

(12)

E(cid:104)

Figure 2: Throughput region.

Figure 3: Long-term reward vs. pathloss exponent.

IV. NUMERICAL RESULTS

In this section, we provide numerical results showing the
merits of the proposed full-duplex WPCNs and the asso-
ciated trade-offs. The channel power gains are modeled as
−β
gi = hi = 1.25 × 10−3ν2
for i ∈ {1, 2}, where di
i d
i
denotes the distance between Di and AP, and β is the pathloss
exponent. νi is the Rayleigh short term fading coefﬁcient, and
therefore ν2
is an exponentially distributed random variable
i
with unit mean. Furthermore, we use a unit slot duration
(T = 1). If not otherwise stated, we consider the following
parameters Pmax = 2 watts, d1 = 5 m, d2 = 10 m,
σ2 = −125 dBm/Hz, η1 = η2 = 0.8, ρi,max = Ei,max/T ,
β = 2, α = 0.5 and the bandwidth is set to 1 MHz. The battery
sizes have a signiﬁcant impact on the network performance.
In order not to use a large amount of discretization levels,
we consider battery sizes comparable with the amount of
harvested energy, which represents the most interesting case to
analyze (when larger batteries are considered, the performance
of the system saturates). In particular, since the amount of
harvested energy depends upon the path loss, the battery sizes
are modeled as Ei,max = 1.25 × 10−3d
ζi for i ∈ {1, 2},
where ζi is expressed in joules. If not otherwise stated, we
use ζ1 = 0.1 joules and ζ2 = 1 joules. Our objective is to
compare the performance of a full-duplex WPCN with perfect
and imperfect self-interference cancellation techniques with
the half-duplex case [27] in which AP broadcasts downlink
wireless energy signals only during τ0.

−β
i

In Figure 2, we compare the achievable throughput region of
a full-duplex WPCN with perfect self-interference cancellation
with that of a half-duplex WPCN. The achievable throughput
region is characterized by obtaining the optimal long-term
rewards of both D1 and D2 for different values of α ∈ [0, 1].
A number of observations can be made. First, the achievable
throughput region of the full-duplex WPCN is larger than that
of the half-duplex case since the latter can be obtained as a spe-
cial case of the full-duplex scenario by setting P1 = P2 = 0.
Second, the full-duplex WPCN outperforms the half-duplex
WPCN in terms of the maximum sum-throughput and the max-
min throughput. In particular, the maximum sum throughput

of full-duplex and half-duplex WPCNs are 0.66 Mbps and
0.59 Mbps, respectively. In addition, the max-min throughput
values of full-duplex and half-duplex WPCNs are 0.27 Mbps
and 0.25 Mbps, respectively. Note that the maximum sum-
throughput can be obtained by setting α = 0.5. On the other
hand, the max-min throughput is deﬁned as the maximum
common throughput that can be achieved by both devices
for enhanced fairness and its associated α can be obtained
via a bisection search [27]. Third, both full-duplex and half-
duplex WPCNs achieve the same long-term rewards for both
devices when α = 0 (neglect D1) or α = 1 (neglect D2).
In these two cases, represented in Figure 2 by the points
(0, 0.27) and (0.52, 0), no portions of the slot duration for
uplink data transmissions are allocated to the neglected device.
Therefore, the network behaves as if it only consisted of one
device, for which both full-duplex and half-duplex schemes
are the same (a device cannot harvest energy and transmit
data simultaneously).

In Figure 3, we compare the long-term reward of half-
duplex and full-duplex WPCNs as a function of the pathloss
exponent β. The full-duplex WPCN is plotted for different
values of the effectiveness of self-interference cancellation
techniques, γ (γ = 0, −110, −100 and −70 dB). The
battery sizes are chosen according to a reference β of 2, i.e.,
Ei,max = 1.25 × 10−3d−2
i ζi for i ∈ {1, 2}. It is observed
that the long-term reward of all studied systems monotonically
decreases as β increases. This happens because the channel
power gains become worse as β increases. Hence, the amount
of harvested energy by each device becomes lower and more
energy is required for uplink data packet transmissions. When
β < 3, it can be observed that the full-duplex WPCN with
perfect self-interference cancellation (γ = 0) achieves the
highest long-term reward, whereas both half-duplex and full-
duplex WPCNs with imperfect self-interference cancellation
(γ = −70 dB) achieve the lowest long-term reward. For
full-duplex WPCN with perfect self-interference cancellation,
the self-interference power at AP is zero. Therefore, AP can
broadcast energy with the maximum allowed power Pmax
without affecting the signal to interference plus noise (SINR)

00.10.20.30.40.50.60.700.050.10.150.20.250.30.35Long−term reward of D1 (Mbits/sec)Long−term reward of D2 (Mbits/sec)  Full−duplex WPCN (γ = 0)Half−duplex WPCNMax-minthroughputMaximumsum-throughput22.22.42.62.833.23.43.63.8400.050.10.150.20.250.30.35Pathloss exponentLong−term reward (Mbits/sec)  Full−duplex WPCN (γ = 0)Full−duplex WPCN (γ = −110 dB)Full−duplex WPCN (γ = −100 dB)Full−duplex WPCN (γ = −70 dB)Half−duplex WPCNFigure 4: Long-term reward vs. Pmax.

Figure 5: Long-term reward vs. d1.

ratio of Equation (4) and the highest long-term reward is
achieved. On the other hand, for larger values of γ (e.g.,
γ = −70 dB) the self-interference power at AP becomes
comparable to the power of the transmitted data signals, which
signiﬁcantly reduces the SINR. Differently from the perfect
self-interference cancellation case, increasing Pi reduces the
SINR and consequently reduces the long-term reward. There-
fore, the optimal downlink transmit powers by the AP are
i = 0 for i ∈ {1, 2} and the performance of the network
P ∗
approaches that of half-duplex WPCN. Finally, when β > 3,
it is observed that the performance of full-duplex WPCN for
all values of γ is exactly the same as that of half-duplex
WPCN. This happens since when β > 3, the small amounts of
harvested energy by wireless devices during τ1 and τ2 in full-
duplex WPCN are not enough for the network to outperform
the achievable long-term reward by half-duplex WPCN.

In Figure 4, the long-term reward is plotted for full-duplex
and half-duplex WPCNs as a function of Pmax. As expected,
the long-term reward of all studied systems increases with
Pmax. However, the long-term reward saturates when Pmax ≤
10 dBm or Pmax ≥ 35 dBm. For small values of Pmax, i.e.,
Pmax ≤ 10 dBm, the amount of energy harvested by both
devices is very low and the long-term throughput is almost
zero in all cases. On the other hand, for large values of Pmax,
i.e., Pmax ≥ 35 dBm, the performance saturates because AP
transfers enough energy to reﬁll the batteries in every slot.

Figure 5 shows the long-term reward of full-duplex and half-
duplex WPCNs for different values of the distance of D1 from
AP. The battery size of D1 is chosen according to a reference
distance of 5 m, i.e., E1,max = 1.25 × 10−3 × 5−βζ1. It is
observed that the long-term reward monotonically decreases as
d1 increases. This happens because, as d1 increases, D1 expe-
riences a worse channel in both uplink and downlink, and thus
receives less energy from AP and requires more energy for
uploading data packets. Furthermore, when d1 ≤ 2 m, the half-
duplex and full-duplex cases achieve the same performance.
In this region D1 experiences a much better channel than D2,
on average, thus almost all the resources are dedicated to D1.
As a consequence, the optimal policy allocates τ2 = 0, forcing

Figure 6: Long-term reward vs. ζ1.

the full-duplex scheme to degenerate in the half-duplex one.
However, for d1 > 2 m, the full-duplex WPCN outperforms
the half-duplex scenario.

In Figure 6, we change the battery size of D1 (by varying ζ1)
and compare the long-term rewards. It is observed that as ζ1
increases, the long-term reward of the full-duplex WPCN with
perfect self-interference cancellation becomes notably larger
than that of half-duplex WPCN. This, in turn, highlights the
great inﬂuence of battery sizes on the network performance,
as stated before, and the importance of the interference can-
cellation process. More speciﬁcally, the long-term reward of
D1 dominates the total long-term reward of the network (5)
since D1 is closer to AP and, hence, experiences a better
channel. Therefore, increasing the battery size of D1 would
signiﬁcantly enhance the network performance since it allows
D1 to store all the harvested energy.

In summary, our numerical results show the superiority
of our proposed full-duplex WPCN compared to the half-
duplex WPCN. They also describe the effects of both self-
interference cancellation techniques and battery sizes on the
network performance. If other parameters were considered,
the improvement experienced in the full-duplex case could be

05101520253035404500.050.10.150.20.250.30.35Pmax(dBm)Long−term reward (Mbits/sec)  Full−duplex WPCN (γ = 0)Full−duplex WPCN (γ = −110 dB)Full−duplex WPCN (γ = −100 dB)Full−duplex WPCN (γ = −70 dB)Half−duplex WPCN1234567891000.20.40.60.811.21.41.61.8Distance between AP and D1 (meters)Long−term reward (Mbits/sec)  Full−duplex WPCN (γ = 0)Full−duplex WPCN (γ = −110 dB)Full−duplex WPCN (γ = −100 dB)Full−duplex WPCN (γ = −70 dB)Half−duplex WPCN0.010.020.030.040.050.060.070.080.090.10.160.180.20.220.240.260.280.30.320.34ζ1 (joules)Long−term reward (Mbps)  Full−duplex WPCN (γ = 0)Full−duplex WPCN (γ = −110 dB)Full−duplex WPCN (γ = −100 dB)Full−duplex WPCN (γ = −70 dB)Half−duplex WPCNeven higher (e.g., for a lower noise power). A more detailed
performance analysis in various scenarios is left for future
study.

V. CONCLUSIONS

We studied a full-duplex wireless powered communication
network, where one AP is operating in a full-duplex mode,
broadcasting energy in downlink to two devices and receiving
data packets in uplink at the same time. D1 and D2 adopt a
time division multiple access scheme for sharing the uplink
channel. Our goal was to characterize the maximum long-
term weighted sum-throughput of the system. Towards this
objective, we cast the optimization problem as an MDP and
showed how to solve it. Our numerical results revealed that
the throughput region of the full duplex WPCN with perfect
self-interference cancellation is notably larger than that of the
the half-duplex WPCN. In addition, the full-duplex WPCN
with perfect self-interference cancellation outperforms the
half-duplex WPCN in terms of the maximum sum-throughput
and the max-min throughput. We also demonstrated that the
performance of half-duplex WPCN is a lower bound for
the performance of full-duplex WPCN with imperfect self
interference cancellation. Moreover, the results highlighted the
great inﬂuence of battery sizes on the achievable long-term
reward. As part of our future work, we would like to study the
long-term maximization for the case of a generic number of
wireless devices and to extend the current scenario to include
cooperation among terminal devices.

REFERENCES

[1] A. Kurs, A. Karalis, R. Moffatt, J. D. Joannopoulos, P. Fisher, and
M. Soljaˇci´c, “Wireless power transfer via strongly coupled magnetic
resonances,” Science, vol. 317, no. 5834, pp. 83–86, Jul. 2007.

[2] P. Nintanavongsa, U. Muncuk, D. R. Lewis, and K. R. Chowdhury,
“Design optimization and implementation for RF energy harvesting
circuits,” IEEE J. Emerging and Selected Topics in Circuits and Systems,
vol. 2, no. 1, pp. 24–33, Mar. 2012.

[3] P. Grover and A. Sahai, “Shannon meets Tesla: Wireless information
and power transfer.” in IEEE Int. Symposium on Information Theory
Proceedings (ISIT), Jun. 2010, pp. 2363–2367.

[4] R. Zhang and C. K. Ho, “MIMO broadcasting for simultaneous wire-
less information and power transfer,” IEEE Trans. Wireless Commun.,
vol. 12, no. 5, pp. 1989–2001, May 2013.

[5] L. Liu, R. Zhang, and K.-C. Chua, “Wireless information transfer
with opportunistic energy harvesting,” IEEE Trans. Wireless Commun.,
vol. 12, no. 1, pp. 288–300, Jan. 2013.

[6] I. Krikidis, S. Timotheou, and S. Sasaki, “RF energy transfer for coop-
erative networks: Data relaying or energy harvesting?” IEEE Commun.
Letters, vol. 16, no. 11, pp. 1772–1775, Nov. 2012.

[7] S. Timotheou, I. Krikidis, G. Zheng, and B. Ottersten, “Beamforming
for MISO interference channels with QoS and RF energy transfer,” IEEE
Trans. Wireless Commun., vol. 13, no. 5, pp. 2646–2658, May 2014.

[8] A. Nasir, X. Zhou, S. Durrani, R. Kennedy et al., “Relaying protocols
for wireless energy harvesting and information processing,” IEEE Trans.
Commun., vol. 12, no. 7, pp. 3622–3636, Jul. 2013.

[9] J. Park and B. Clerckx, “Joint wireless information and energy transfer
in a two-user MIMO interference channel,” IEEE Trans. Wireless
Commun., vol. 12, no. 8, pp. 4210–4221, Aug. 2013.

[10] Q. Shi, L. Liu, W. Xu, and R. Zhang, “Joint transmit beamforming
and receive power splitting for MISO SWIPT systems,” IEEE Trans.
Wireless Commun., vol. 13, no. 6, pp. 3269–3280, Jun. 2014.

[11] B. Gurakan, O. Ozel, J. Yang, and S. Ulukus, “Energy cooperation in
energy harvesting communications,” IEEE Trans. Commun., vol. 61,
no. 12, pp. 4884 – 4898, Dec. 2013.

[12] K. Tutuncuoglu and A. Yener, “Energy harvesting networks with energy
cooperation: Procrastinating policies,” IEEE Trans. Comm, vol. 63,
no. 11, pp. 4525–4538, Nov. 2015.

[13] A. Biason and M. Zorzi, “Joint transmission and energy transfer policies
for energy harvesting devices with ﬁnite batteries,” IEEE J. Selected
Areas in Commun., vol. 33, no. 12, pp. 2626–2640, Dec. 2015.

[14] H. Ju and R. Zhang, “Throughput maximization in wireless powered
communication networks,” IEEE Trans. Wireless Commun., vol. 13,
no. 1, pp. 418–428, Jan. 2014.

[15] ——, “User cooperation in wireless powered communication networks,”
in IEEE Global Communications Conference (GLOBECOM), Dec. 2014,
pp. 1430–1435.

[16] H. Chen, Y. Li, J. Luiz Rebelatto, B. F. Uchoa-Filho, and B. Vucetic,
“Harvest-then-cooperate: Wireless-powered cooperative communica-
tions,” IEEE Trans. Signal Processing, vol. 63, no. 7, pp. 1700–1711,
Apr. 2015.

[17] D. I. Kim and K. W. Choi, “Stochastic optimal control for wireless
powered communication networks,” IEEE Trans. Wireless Commun.,
vol. 15, no. 1, pp. 686–698, Jan. 2016.

[18] R. Morsi, D. S. Michalopoulos, and R. Schober, “Performance analysis
of wireless powered communication with ﬁnite/inﬁnite energy storage,”
arXiv:1410.1805, Oct. 2014.

[19] D. T. Hoang, D. Niyato, P. Wang, and D. I. Kim, “Optimal decentralized
control policy for wireless communication systems with wireless energy
transfer capability,” in Proc. IEEE Int. Conf. Commun. (ICC), Jun. 2014,
pp. 2835–2840.

[20] L. Liu, R. Zhang, and K.-C. Chua, “Multi-antenna wireless powered
communication with energy beamforming,” IEEE Trans. Commun.,
vol. 62, no. 12, pp. 4349–4361, Dec. 2014.

[21] G.-M. Yang, C.-C. Ho, R. Zhang, and Y. Guan, “Throughput optimiza-
tion for massive MIMO systems powered by wireless energy transfer,”
IEEE J. Selected Areas in Commun., vol. 33, no. 8, pp. 1640–1650, Aug.
2015.

[22] M. A. Abd-Elmagid, T. ElBatt, and K. G. Seddik, “Optimization of
wireless powered communication networks with heterogeneous nodes,”
in Proc. IEEE Global Communications Conference (GLOBECOM), Dec.
2015.

[23] ——, “A generalized optimization framework for wireless powered

communication networks,” in arXiv:1603.01115, Mar. 2016.

[24] H. Ju and R. Zhang, “Optimal resource allocation in full-duplex wireless-
powered communication network,” IEEE Trans. Commun., vol. 62,
no. 10, pp. 3528–3540, Oct. 2014.

[25] X. Kang, C. K. Ho, and S. Sun, “Full-duplex wireless-powered
communication network with energy causality,” arXiv preprint
arXiv:1404.0471, Apr. 2014.

[26] S. Bi, C. K. Ho, and R. Zhang, “Wireless powered communication:
opportunities and challenges,” IEEE Commun. Magazine, vol. 53, no. 4,
pp. 117–125, Apr. 2015.

[27] A. Biason and M. Zorzi, “Long-term throughput optimization in WPCN
with battery-powered devices,” in Proc. IEEE Wireless Communications
and Networking Conference (WCNC), Apr. 2016.

[28] ——, “Battery-powered devices in WPCNs,” in arXiv:1601.06847, Jan.

2016.

[29] N. Pappas, A. Ephremides, and A. Traganitis, “Stability and performance
issues of a relay assisted multiple access scheme with MPR capabilities,”
in Computer Communications, vol. 42, Apr. 2014, pp. 70–76.

[30] M. Duarte and A. Sabharwal, “Full-duplex wireless communications
using off-the-shelf radios: Feasibility and ﬁrst results,” in Proc. Asilomar
Conf. Signals, Systems and Computers (ASILOMAR), Sep. 2010.

[31] D. Bharadia, E. McMilin, and S. Katti, “Full duplex radios,” in ACM
SIGCOMM Computer Communication Review, vol. 43, no. 4, Aug. 2013,
pp. 375–386.

[32] J. I. Choi, M. Jain, K. Srinivasan, P. Levis, and S. Katti, “Achieving
single channel, full duplex wireless communication,” in Proc. ACM
Sixteenth Annual International Conference on Mobile Computing and
Networking (MobiCom), Sep. 2010.

[33] X. Lu, P. Wang, D. Niyato, D. I. Kim, and Z. Han, “Wireless networks
with RF energy harvesting: A contemporary survey,” IEEE Commun.
Surveys & Tutorials, vol. 17, no. 2, pp. 757–789, Nov. 2015.

[34] D. Del Testa, N. Michelusi, and M. Zorzi, “Optimal transmission policies
for two-user energy harvesting device networks with limited state-of-
charge knowledge,” IEEE Trans. Commun., to be published, 2016.

[35] M. L. Puterman, Markov decision processes: Discrete stochastic dy-
John Wilson and Sons Ed., 1995, vol. 46, no. 6.
Athena

[36] D. Bertsekas, Dynamic programming and optimal control.

namic programming.

Scientiﬁc, Belmont, Massachusetts, 2005.

