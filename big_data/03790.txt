6
1
0
2

 
r
a

 

M
1
1

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
0
9
7
3
0

.

3
0
6
1
:
v
i
X
r
a

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

KATY CRAIG, INWON KIM, AND YAO YAO

Abstract. We consider a congested aggregation model that describes the evolution of a den-
sity through the competing eﬀects of nonlocal Newtonian attraction and a hard height con-
straint. This provides a counterpoint to existing literature on repulsive-attractive nonlocal
interaction models, where the repulsive eﬀects instead arise from an interaction kernel or the
addition of diﬀusion. We formulate our model as the Wasserstein gradient ﬂow of an in-
teraction energy, with a penalization to enforce the constraint on the height of the density.
From this perspective, the problem can be seen as a singular limit of the Keller-Segel equation
with degenerate diﬀusion. Two key properties distinguish our problem from previous work on
height constrained equations: nonconvexity of the interaction kernel (which places the model
outside the scope of classical gradient ﬂow theory) and nonlocal dependence of the velocity
ﬁeld on the density (which causes the problem to lack a comparison principle). To overcome
these obstacles, we combine recent results on gradient ﬂows of nonconvex energies with viscos-
ity solution theory. We characterize the dynamics of patch solutions in terms of a Hele-Shaw
type free boundary problem and, using this characterization, show that in two dimensions
patch solutions converge to a characteristic function of a disk in the long-time limit, with
explicit rate of convergence. We believe that a key contribution of the present work is our
blended approach, combining energy methods with viscosity solution theory.

Contents

1.
2.

3.

4.

5.

Introduction
Convergence of gradient ﬂows: drift diﬀusion to height constrained interaction
2.1. Preliminary results
2.2. Deﬁnitions of energies and discrete time sequences
2.3. Distance between discrete time sequences of E∞, ˜E∞, and Em
Convergence of viscosity solutions: drift diﬀusion pressure to free boundary
problem
3.1. Basic properties of viscosity solutions of (P)m and (P)∞
3.2. Convergence of (P)m to (P)∞
Long time behavior of patch solutions in two dimensions
4.1. Evolution of the second moment
4.2. Some rearrangement inequalities
4.3. Convergence of energy functional as t → ∞
4.4. Convergence of ρ∞(t) as t → ∞
Appendix

2
8
8
12
17

23
24
28
37
38
40
43
46
48

Key words and phrases. Wasserstein metric, gradient ﬂow, discrete gradient ﬂow, JKO scheme, Keller-Segel

equation, aggregation equation, crowd motion, Hele-Shaw free boundary problem.

Katy Craig is supported by a UC President’s Postdoctoral Fellowship and by the NSF grant DMS-1401867.
Inwon Kim is supported by the NSF grant DMS-1300445.
Yao Yao is supported by the NSF grant DMS-1565480.

1

2

KATY CRAIG, INWON KIM, AND YAO YAO

5.1. Deﬁnition of viscosity solutions of (P)∞
5.2. Further properties of gradient ﬂows of E∞, ˜E∞, and Em

References

48
49
55

1. Introduction

In recent years, there has been signiﬁcant interest in physical and biological models with
nonlocal interactions. These models describe the pairwise interactions of a large number of
individual agents, for which, in the continuum limit, the nonnegative density ρ(x, t) satisﬁes
the aggregation equation with degenerate diﬀusion

(1.1)

ρt = ∇ · (ρ∇N ∗ ρ) + ∆ρm,

for an interaction kernel N : Rd → R and m ≥ 1. This equation is mass-preserving and,
provided that N (x) possesses suﬃcient convexity and regularity, it is a Wasserstein gradient
ﬂow of the energy

where the interaction energy W (ρ) and R´enyi entropy Sm(ρ) are given by

Em(ρ) = W (ρ) + Sm(ρ),

(cid:90)
for the case when(cid:82) ρ (cid:54)= 1.

W (ρ) =

1
2

(N ∗ ρ)(x)ρ(x)dx

and

Sm(ρ) :=

ρ(x)mdx.

See section 2.1 for further background on this gradient ﬂow structure, including Remark 2.9

Depending on the choice of interaction kernel and diﬀusion parameter, equations similar
to (1.1) arises in a range applications in physics and biology, including models of granular
media [6, 18], biological swarming [12, 52], robotic swarming [19, 45], molecular self-assembly
[21,47,55], and the evolution of vortex densities in superconductors [3,37,40,46]. Of particular
interest are kernels and diﬀusion parameters for which the model exhibits competing repulsive
and attractive eﬀects, causing solutions to blow up in ﬁnite time or form rich patterns in the
asymptotic limit (c.f. [4, 5, 7–9, 23–25, 50]). For example, with m ≥ 1 and the interaction is
given by the Newtonian interaction kernel

(cid:90)

1

m − 1

(cid:40) 1
2π log |x|
−1
d(d−2)αd|x|2−d

(1.2)

N (x) =

for d = 2,
for d (cid:54)= 2,

with αd the volume of the unit ball in Rd,

equation (1.1) corresponds to the Keller-Segel model for biological chemotaxis [10, 11, 29]

(1.3)

ρt = ∇ · (ρ∇(N ∗ ρ)) + ∆ρm.

In this case, the interaction kernel is purely attractive and competes with the repulsion induced
by the degenerate diﬀusion. If m > 2− 2/d, diﬀusion dominates at large density, and bounded
solutions exist globally in time [49]. Otherwise, depending on the choice of initial data, solutions
with bounded initial data may blow up in ﬁnite time.

In the present work, we consider a diﬀusion-aggregation model similar to the Keller-Segel
equation, but with the role of diﬀusion instead played by a hard height constraint on the

(cid:40)

(cid:40)

(1.4)

(1.6)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

3

density. Heuristically, the evolution of ρ(x, t) is given by the congested aggregation equation

where Nρ := N ∗ ρ denotes the Newtonian potential of ρ. Informally, solutions of 1.4 seek
to evolve according to the “desired velocity ﬁeld” ∇Nρ, subject to a hard height constraint.
More precisely, we deﬁne ρ(x, t) as the Wasserstein gradient ﬂow of the constrained interaction
energy

(1.5)

E∞(ρ) :=

ρt = ∇ · (ρ∇Nρ) if ρ(x, t) ≤ 1,
ρ(x, t) ≤ 1 always,

(cid:40) 1

2

(cid:82) Nρ(x)ρ(x)dx if (cid:107)ρ(cid:107)∞ ≤ 1,

otherwise.

+∞

Our choice of hard height constraint is inspired by the work of Maury, Roudneﬀ-Chupin,
Samtambrogio, and Venel [41,42], who introduced such a constraint in their model of pedestrian
crowd motion. They considered a congested drift equation

for a local drift V : Rd → R, where ∇V is the “desired velocity ﬁeld” of the density. As in the

present work, they rigorously deﬁned the evolution of the density as the Wasserstein gradient
ﬂow of the constrained potential energy

ρt = ∇ · (ρ∇V ) if ρ(x, t) ≤ 1,
ρ(x, t) ≤ 1 always,

(cid:40) 1

2

(cid:82) V (x)ρ(x)dx if (cid:107)ρ(cid:107)∞ ≤ 1,

otherwise.

+∞

V∞(ρ) :=

They then showed that this gradient ﬂow satisﬁes a formulation of the continuity equation,
where the velocity ﬁeld is given by the L2 projection of ∇V onto the set of admissible velocities
that do not increase the density in the saturated zone, {ρ = 1} [41]. Furthermore, when V (x)
is semiconvex (e.g. when ∇2V (x) is bounded below—see section 2.1) the energy V∞ is likewise
semiconvex and Wasserstein gradient ﬂow theory ensures that this evolution is unique.
Building upon this work, Alexander, Kim, and Yao [1] showed that solutions of the con-
gested drift equation could be approximated by solutions to a corresponding nonlinear diﬀusion
equation

(1.7)
as m → +∞, which are gradient ﬂows of the energy
V (x)ρ(x)dx +

ρt = ∇ · (ρ∇V ) + ∆ρm
(cid:90)

Vm(ρ) :=

(cid:90)

1

m − 1

ρ(x)mdx,

(Note that, for a ﬁxed ρ, V∞(ρ) is the limit of Vm(ρ) as m → ∞.) They then applied this result
to characterize the dynamics of the congested drift equation: given a velocity ﬁeld satisfying
∆V > 0 and initial data that is a characteristic function on a patch, ρ(x, 0) = χΩ0(x) for

(cid:40)

χΩ0(x) :=

1
0

if x ∈ Ω0,
otherwise,

the solution remains a characteristic function, and the evolution of the patch is given by a
Hele-Shaw type free boundary problem.

4

KATY CRAIG, INWON KIM, AND YAO YAO

In spite of the similarities between our congested aggregation equation (1.4) and the con-
gested drift equation (1.6), two key diﬀerences prevent its analysis by the same methods. First,
unlike V∞, the energy E∞ does not satisfy the semiconvexity assumptions of classical gradient
ﬂow theory that ensure uniqueness. This lack of convexity also makes the equation inaccessible
by classical approximation methods—speciﬁcally, quantitative approximation by the discrete
gradient ﬂow or JKO scheme for semiconvex energies—which was a key tool in Alexander, Kim,
and Yao’s result on the convergence of the nonlinear diﬀusion equation (1.7) as m → +∞ to
the congested drift equation. The second major diﬀerence between the congested aggregation
and congested drift equations is that the velocity ﬁeld of the former depends nonlocally on
the density. This prevents a direct adaptation of Maury, Roudneﬀ-Chupin, and Santambro-
gio’s characterization of solutions in terms of a continuity equation, since their argument relies
upon an Euler-Lagrange equation for the discrete gradient ﬂow sequence, the proof of which
strongly leverages the local nature of the drift. Finally, the nonlocal nature of the velocity
ﬁeld causes there to be no comparison principle, an important element in Alexander, Kim, and
Yao’s analysis of the patch dynamics.

To overcome these diﬃculties, we combine new results on the Wasserstein gradient ﬂow of
non-semiconvex energies with a reﬁned approximation of the congested aggregation equation
by nonlinear diﬀusion equations to characterize the dynamics of patch solutions and study
their asymptotic behavior. To address the lack of convexity, we appeal to recent work by
the ﬁrst author, inspired by the present problem, that proves well-posedness of Wasserstein
gradient ﬂows for energies that are merely ω-convex and provides quantitative estimates on
the convergence of the discrete gradient ﬂow. (See section 2.1). We apply these results to
conclude that if the initial data ρ0 satisﬁes (cid:107)ρ0(cid:107)∞ ≤ 1, then there exists a unique Wasserstein
gradient ﬂow ρ∞ of the constrained interaction energy E∞. However, due to the low regularity
of E∞, gradient ﬂow theory doesn’t provide a characterization of its evolution in terms of a
partial diﬀerential equation.

Our goal in this paper is to study the dynamics and asymptotic behavior of ρ∞. We focus
on the case when the initial data ρ0 is a patch, i.e. ρ0 = χΩ0, where Ω0 ⊆ Rd is a bounded

domain with Lipschitz boundary, and we seek to answer the following questions:

1. If ρ0 is a patch, does ρ∞(·, t) remain a patch χΩ(t) for all t ≥ 0?
2. If so, what partial diﬀerential equation determines the evolution of the set Ω(t)?
3. What is the asymptotic behavior of Ω(t) as t → ∞?

To answer these questions, we blend the gradient ﬂow approach with viscosity solution
theory. Due to the attractive nature of the Newtonian kernel (1.2), we show that the solution
of the congested aggregation equation ρ∞(x, t) indeed remains a patch: ρ∞(x, t) = χΩ(t)(x) for
a time dependent domain Ω(t). We then show that Ω(t) evolves with outward normal velocity
V = V (x, t) satisfying

V = −ν · (∇p + ∇Nρ∞)

at x ∈ ∂Ω(t),

where ν = ν(x, t) is the outward unit normal at x ∈ ∂Ω(t) and, for each t > 0, p = p(x, t)
solves

−∆p(·, t) = 1 in Ω(t),

p(·, t) = 0 outside of Ω(t).

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

5

Since, Ω(t) = {p(·, t) > 0}, this gives a Hele-Shaw type free boundary problem for the pressure
variable p,

(P)

 −∆p(·, t) = 1

V = −ν · (∇p + ∇Φ)
Φ = Nχ{p>0}.

in
on

{p > 0};
∂{p > 0};

Provided that p is suﬃciently regular (for example, p ∈ L1([0,∞); H 1(Rd)), this would imply

that the solution of the congested aggregation is a weak solution of the continuity equation

(1.8)
where ∇p is the pressure generated by the height constraint that modiﬁes the “desired velocity
ﬁeld” ∇Nρ. In terms of p, ν = −∇p/|∇p| and V = pt/|∇p|, so in the smooth setting the
second condition in (P) can be written as

ρt = ∇ · (ρ(∇Nρ + ∇p)),

pt = |∇p|2 + ∇p · ∇Φ on ∂{p > 0}.

Even if Ω0 has smooth boundary, the evolving set Ω(t) = {p(·, t) > 0} may undergo topo-
logical changes such as merging. Consequently, to describe the evolution of Ω(t), we require
a notion of weak solution for (P). While viscosity solutions are a natural choice, given their
utility in free boundary problems, because of the nonlocal dependence of the outward normal
velocity V on p itself, (P) lacks a comparison principle.
Instead, we consider an auxillary

problem for a ﬁxed, nonnegative function ρ(x, t) ∈ L∞(Rd × (0,∞)),
{p > 0};
(P)∞
∂{p > 0};

 −∆p(·, t) = 1

V = −ν · (∇p + ∇Φ)
Φ = Nρ.

in
on

We show that the comparison comparison principle holds for (P)∞, hence viscosity solution
theory applies. We then deﬁne p to be a solution of (P) if it is a weak viscosity solution of
(P)∞ with ρ = χ{p>0} almost everywhere.

We now state our ﬁrst main result, which follows from Theorems 3.8 and 3.14.

Theorem 1.1 (Characterization of dynamics of aggregation patches).

(a) Let Ω0 ⊆ Rd be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) ∈ L∞(Rn)
be the gradient ﬂow of E∞ with initial data χΩ0. Consider the free boundary problem
(P)∞ with ρ replaced by ρ∞, and the initial data p0 given by

(1.9)

− ∆p0(·, 0) = 1 in Ω0,

p0(·, 0) = 0 outside of Ω0.

Then there is a unique minimal viscosity solution p(x, t) of (P)∞ with initial data p0.

(b) Let Ω(t) = {p(·, t) > 0}. Then ρ∞(·, t) remains a patch for all times, and

(c) Therefore, p is a weak solution of (P) in the sense of Deﬁnition 3.2.

ρ∞(·, t) = χΩ(t) a.e. for all t ≥ 0.

Next, we consider the asymptotic behavior of patch solutions as t → +∞. For any given mass
and any dimension, the Riesz rearrangement inequality [35, Theorem 3.7] immediately gives
that the global minimizer of the constrained interaction energy (1.5) must be a characteristic
function of a ball. However, this does not guarantee that the gradient ﬂow ρ∞(t) of the
constrained interaction energy always converges to a translation of the global minimizer as
In particular, the main obstacle is to show the mass of ρ∞(t) cannot escape to
t → +∞.

6

KATY CRAIG, INWON KIM, AND YAO YAO

inﬁnity in the long time limit, which requires us to obtain some compactness estimates on
ρ∞(t) uniformly in time.

For the Keller-Segel equation (1.3) with subcritical power m > 2 − 2/d, the situation is
very similar. Again, there exists a unique (up to a translation) global minimizer of Em for
any given mass [36, 38], but it is unknown whether solutions converge to it as t → +∞. In
dimension two, convergence has been recently shown by Carrillo, Hittmeir, Volzone, and the
third author [16], where compactness is obtained via a uniform in time bound of the second
moment, though no explicit convergence rate towards the global minimizer is given. For d ≥ 3,
the only available convergence result towards the global minimizer is work by the second two
authors on radial solutions [31].

In our work, for dimension two, we not only prove convergence of solutions towards the global
minimizer of the constrained interaction energy (1.5), but also provide explicit estimates on the
rate of convergence. We accomplish this by again applying a blended approach, combining the
gradient ﬂow structure of the problem with viscosity solution theory and the characterization of
patch dynamics from Theorem 1.1. We begin by using a rearrangement inequality of Talenti [51]
to show that the second moment of ρ∞(t) is non-increasing in time and is strictly decreasing
at time t unless Ω(t) is a disk. Then, applying a quantitative version of the isoperimetric
inequality due to Fusco, Maggi, and Pratelli [26] and our characterization of patch dynamics,
Theorem 1.1, we provide explicit estimates on the rate that the second moment is decreasing,
in terms of the symmetric diﬀerence between Ω(t) and a disk. Finally, using the gradient ﬂow
structure of the problem, we show that as t → +∞, ρ∞(t) strongly converges to a characteristic
function of a disk in Lq for any 1 ≤ q < ∞, and its energy E∞(ρ∞) converges to its global
minimizer with an explicit rate. This gives our second main result, which combines Theorems
4.9 and 4.12.

Theorem 1.2 (Long time behavior in two dimensions). Assume d = 2. Let Ω0 ⊆ R2 be a
bounded domain with Lipschitz boundary, and let ρ∞ be the gradient ﬂow of E∞ with initial
data χΩ0. Then as t → +∞, ρ∞(·, t) converges to χB0 in Lq for any 1 ≤ q < ∞, where B0 is
the unique disk with the same area and center of mass as those of Ω0. Furthermore, we have
the following rate of convergence in terms of the free energy,

0 ≤ E∞(ρ∞(·, t)) − E∞(χB0) ≤ C(|Ω0|, M2[Ω0])t

−1/6.

Remark 1.3. Let us point out that our control for the second moment relies on the particular
structure for the 2D Newtonian kernel, and we are unable to obtain similar compactness
estimates for higher dimensions. For d ≥ 3, whether ρ∞(t) converges to a ball as t → ∞
remains an interesting open question.

We now describe the key ingredients in our characterization of the dynamics of the congested
aggregation equation. At the heart of our analysis is an approximation of this equation as the
singular limit of a sequence of nonlinear diﬀusion equations. This provides the bridge between
the gradient ﬂow and viscosity solution approach.
In particular, while the gradient ﬂow of
E∞ is merely a curve in the space of measures, approximating it by a sequence of solutions to
nonlinear diﬀusion equations allows us to bring to bear the tools of viscosity solution theory
in the limit.

Following the analogy with Alexander, Kim, and Yao’s previous work, one might hope to
approximate the congested aggregation equation by the Keller-Segel equation (1.3), which also

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

7

has a gradient ﬂow structure corresponding to the energy
1

ρ(x)mdx

EKS(ρ) =

ρ(x)Nρ(x)dx +

(1.10)
Note that for a ﬁxed ρ, E∞(ρ) is the limit of EKS(ρ) as m → ∞. However, EKS satisﬁes
neither the classical assumptions for semiconvexity nor the weaker assumptions for ω-convexity.
Consequently, we lack the quantitative estimates on the rate of convergence of the discrete
gradient ﬂow that are an essential element of our approach. Instead, we replace the nonlocal
potential Nρ in EKS with a local potential Φ1/m(x, t) that depends on time, the initial data
ρ(x, 0), and the diﬀusion parameter m ≥ 1. (See Deﬁnition 2.10 for a precise deﬁnition of this
potential.) This leads to the energy

m − 1

(cid:90)(cid:90)

(cid:90)

(cid:90)

(cid:90)

1

m − 1

Em,t(ρ) :=

ρ(x)Φ1/m(x, t)dx +

ρ(x)mdx,

which we can show is ω-convex. We then prove that the (time dependent) gradient ﬂow of this
energy, which corresponds to a solution of

(PME-D)m
converges as m → +∞ to a solution of the congested aggregation equation. (See section 2
for our construction of this time dependent gradient ﬂow.) Then, rewriting (PME-D)m in the
form

ρt = ∇ · (ρ∇Φ1/m) + ∆ρm,

(1.11)

ρt = ∇ · (ρ(∇Φ1/m + ∇pm)),

for pm =

m − 1
m

ρm−1,

we use viscosity solution theory to show that, as m → +∞, pm converges to a solution of the
free boundary problem (P). By uniqueness of the limit, we conclude the characterization of
dynamics of patch solutions of the congested aggregation equation, as stated in Theorem 1.1.
Our paper is organized as follows. In section 2, we prove that the solutions of the nonlinear
diﬀusion equations (PME-D)m converge as m → +∞ to the gradient ﬂow of E∞ with an
explicit rate depending on m. We also provide background on Wasserstein gradient ﬂow,
including recent results by the ﬁrst author on the gradient ﬂows of ω-convex energies.
In
section 3, we show that the pressure pm corresponding to the nonlinear diﬀusion equations,
given in equation (1.11), converges as m → +∞ to a solution of (P)∞. Combining these results,
we show that the gradient ﬂow of E∞ is a characteristic function of the evolving set Ω(t) and
that Ω(t) can be obtained from the viscosity solution of (P )∞. In section 4, we consider the
asymptotic behavior of ρ∞ in two dimensions, proving that it converges to a disk with explicit
rate. Let us remark that the characterization of ρ∞ by the pressure variable p plays a crucial
role in the proof of this asymptotic result. Finally, we conclude with an appendix section
5, which contains proofs of several lemmas from section 2, as well as deﬁnitions of viscosity
solutions for the limiting free boundary problem (P )∞.

There are several directions for future work. First, our analysis only addresses solutions that
are initially a patch. Results for more general initial data could leverage recent work by Kim
and Pozar [30] and Mellet, Perthame, and Quiros [44]. Second, in the light of work by Maury,
Roudneﬀ-Chupin, and Santambrogio [41], it would be interesting if one could characterize the
modiﬁed velocity ∇p + ∇Nρ in (1.8) as the projection of the original velocity ∇Nρ onto the
space of admissible velocities under the height constraint. At the moment, this appears to be
a diﬃcult question, due to the highly nonlinear nature of the projection and its dependence
on the solution. A third direction for future work would be to pursue to what extent our

8

KATY CRAIG, INWON KIM, AND YAO YAO

analysis extends to nonlocal velocity ﬁeld generated by kernels aside from the Newtonian N ,
which arise in a range of biological and physical applications. While our result on the singular
limit of the nonlinear diﬀusion equations extends to a range of kernels (see Remark 2.1), our
analysis of the free boundary problem strongly leverages the structure of the Newtonian kernel.
A ﬁnal direction for future work would be to make rigorous the link between the congested
aggregation equation and the Keller-Segel equation (1.3) as m → +∞, completing the analogy
with previous work by Alexander, Kim, and Yao that found that the hard height constraint
may be obtained as the limit of slow diﬀusion.

2. Convergence of gradient flows: drift diffusion to height constrained

interaction

In this section, we show that the gradient ﬂow of the height constrained interaction energy
E∞, deﬁned in equation (1.5), may be approximated by solutions of the nonlinear diﬀusions
equations (PME-D)m as m → +∞. This provides a link between the abstract Wasserstein
gradient ﬂow of E∞, which in general is merely a curve in the space of probability measures,
and solutions to partial diﬀerential equations.

Remark 2.1 (Choice of interaction kernel). For the sake of continuity with sections 3 and 4,
we assume that the interaction kernel N is Newtonian (1.2). However, our results in this
section may be extended to any kernels that satisfy [20, Assumption 4.1] and the estimates of
Proposition 2.3. In particular, this includes many repulsive-attractive potentials of interest in
the literature.

2.1. Preliminary results. We begin by collecting some results on the Wasserstein gradient
ﬂow of ω-convex energies that will be useful in what follows. For further background on the
Wasserstein metric and gradient ﬂows of semiconvex energies, we refer the reader to the books
by Ambrosio, Gigli, and Savar´e [2] and Villani [54]. For more details on gradient ﬂows of
ω-convex energies, see recent work by the ﬁrst author [20].

(cid:82)
Let P2(Rd) denote the set of probability measures on Rd with ﬁnite second moment, i.e.
|x|2dµ < +∞. If a measure µ ∈ P2(Rd) is absolutely continuous with respect to Lebesgue
measure (µ (cid:28) Ld), we will identify µ with its density, i.e. dµ(x) = µ(x)dx. In particular, we
(cid:82) f (t(x))dµ =(cid:82) f (y)dν for all f ∈ L1(dν). We then call ν the push-forward of µ under t and
write (cid:107)µ(cid:107)L∞ < +∞ if dµ(x) = µ(x)dx and µ(x) ∈ L∞(Rd).
Given µ, ν ∈ P2(Rd), a measurable function t : Rd → Rd transports µ onto ν in case

write ν = t#µ. If µ is absolutely continuous with respect to Lebesgue measure (as will be the
case for all the measures we consider), then the Wasserstein distance from µ to ν is given by

(cid:40)(cid:18)(cid:90)

(cid:19)1/2

(cid:41)

(2.1)

W2(µ, ν) = inf

|t − id|2dµ

: t#µ = ν

,

where id(x) = x. Furthermore, the inﬁmum is attained by an optimal transport map t = tν
µ,
which is unique µ-almost everywhere.
The metric space (P2(Rd), W2) is complete, and convergence can be characterized as

(cid:82) f dµ for all f ∈ C(Rd) such that

(cid:82) f dµn →

W2(µn, µ) → 0 ⇐⇒

∃C > 0, x0 ∈ Rd so that |f (x)| ≤ C(1 + |x − x0|2).

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

9

We will refer to such f as continuous functions with at most quadratic growth. Furthermore, for

integral of f against µ and the integral of f against ν using the following elementary lemma.

any f ∈ C1(Rd) with uniformly bounded gradient, we can quantify the diﬀerence between the
Lemma 2.2. For f ∈ C1(Rd) and µ, ν ∈ P2(Rd),

f dµ −

f dν

(cid:90)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)
(cid:90) (cid:12)(cid:12)f − f ◦ tν

µ

(cid:12)(cid:12)(cid:12)(cid:12) ≤

(cid:12)(cid:12) dµ ≤ (cid:107)∇f(cid:107)∞

(cid:12)(cid:12)(cid:12)(cid:12) ≤ (cid:107)∇f(cid:107)∞W2(µ, ν).
(cid:18)(cid:90)

(cid:19)1/2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)

(cid:90)

f dµ −

f dν

Proof. For simplicity, suppose that µ (cid:28) Ld, so there exists an optimal transport map tν
µ. (The
proof is identical in the general case, using optimal transport plans.) By Jensen’s inequality,

|tν
µ − id|2dµ

= (cid:107)∇f(cid:107)∞W2(µ, ν).

(cid:3)
Along with its metric structure, (P2(Rd), W2) is a geodesic space, since any two measures
µ0, µ1 ∈ P2(Rd) are connected by a geodesic µα ∈ P2(Rd), α ∈ [0, 1], satisfying

If µ0 (cid:28) Ld, then the geodesic from µ0 to any µ1 ∈ P2(Rd) is unique and of the form

W2(µα, µβ) = |β − α|W2(µ0, µ1) for all α, β ∈ [0, 1].

µα = ((1 − α)id + αtµ1

µ0)#µ0.

Unlike a square Hilbertian norm, the square Wasserstein distance is not convex along geodesics
(α (cid:55)→ W 2
2 (ν, µα) is not convex) [2, Example 9.1.5]. Consequently, Ambrosio, Gigli, and Savar´e
introduced an expanded class of curves known as generalized geodesics, so that, between any two
measures, there is always at least one curve along which the square distance is convex [2, Lemma

9.2.1, Deﬁnition 9.2.2]. Given µ0, µ1, ν ∈ P2(Rd) with ν (cid:28) Ld, the generalized geodesic from

µ0 to µ1 with base ν is

and along such a curve we have

µα = ((1 − α)tµ0

ν + αtµ1

ν )#ν,

W 2
2 (ν, µα) = (1 − α)W 2

2 (ν, µ0) + αW 2

2 (ν, µ1) − α(1 − α)(cid:107)tµ0

ν − tµ1
ν (cid:107)2

L2(dν).

An additional class of curves along which the square Wasserstein metric is convex are linear
interpolations of measures,

For any µ0, µ1, ν ∈ P2(Rd), we have

(2.2)

W 2
2 (ν, µα) ≤ (1 − α)W 2

2 (ν, µ0) + αW 2

2 (ν, µ1).

µα := (1 − α)µ0 + αµ1.

(See, for example, [48, Proposition 7.19].)

Due to the fact that (P2(Rd), W2) is a geodesic space, it induces a natural notion of con-
vexity on energy functionals E : P2(Rd) → R ∪ {+∞}, i.e. given a geodesic µα, the function
α (cid:55)→ E(µα) is convex. We recall both this standard notion of convexity, as well as two gener-
alizations: semiconvexity and ω-convexity.

(i) E is convex along µα if E(µα) ≤ (1 − α)E(µ0) + αE(µ1).
(ii) E is semiconvex along µα if there exists λ ∈ R so that
2 (µ0, µ1).

E(µα) ≤ (1 − α)E(µ0) + αE(µ1) − α(1 − α) λ

2 W 2

10

KATY CRAIG, INWON KIM, AND YAO YAO

2 [(1−α)ω(α2W 2

2 (µ0, µ1))+αω((1−α)W 2

one of the above inequalities, we say E is convex/semiconvex/ω-convex along geodesics. On

ω : [0, +∞) → [0, +∞), which vanishes only at x = 0, so that
E(µα) ≤ (1−α)E(µ0)+αE(µ1)− λω

(iii) E is ω-convex along µα if there exists λω ∈ R and a continuous, nondecreasing function
2 (µ0, µ1))].
If, for any µ0, µ1 ∈ P2(Rd), there exists a geodesic µα from µ0 to µ1 along which E satisﬁes
the other hand, if for any µ0, µ1, ν ∈ P2(Rd), there exists a generalized geodesic µα from µ0
to µ1 with base ν along which E satisﬁes one of the above inequalities (replacing W2(µ0, µ1)
on the right hand side with (cid:107)tµ0
L2(ν)), we say E is convex/semiconvex/ω-convex along
generalized geodesics. We will also say that E is proper if the domain of the energy D(E) =
{µ : E(µ) < +∞} is nonempty.
A key element of our analysis is that the height constrained interaction energy E∞ deﬁned
in equation (1.5) is ω-convex along generalized geodesics. This follows from the following
estimates on the Newtonian potential of a bounded, integrable function.

ν − tµ1
ν (cid:107)2

Proposition 2.3 (c.f. [39, Theorem 2.7]). Suppose ρ, µ, ν ∈ P2(Rd) with (cid:107)ρ(cid:107)∞,(cid:107)µ(cid:107)∞ ≤ 1.
Then there exists Cd ≥ 1, depending only on the dimension, so that

(cid:90)

(cid:107)∇Nρ(cid:107)∞ ≤ Cd, (cid:107)∆Nρ(cid:107)∞ ≤ 1,
|∇Nρ(x) − ∇Nρ(y)| ≤ Cdσ(|x − y|), and (cid:107)∇Nρ − ∇Nµ(cid:107)L2(Rd) ≤ W2(ρ, µ).

Nρdν ≥ −Cd,

(cid:40)2x| log x|
(cid:113)
x2 + 2(1 + √2)e−1−√

σ(x) :=

if 0 ≤ x ≤ e(−1−√
if x > e(−1−√

2)/2.

2)/2,

2

where

(2.3)

We defer the proof of this proposition to the appendix in Section 5.2.

By the above estimates and [20, Theorem 4.3, Proposition 4.4], E∞ is ω-convex along gen-

eralized geodesics with λω = −Cd and ω(x) a log-Lipschitz modulus of convexity

(cid:40)x| log x|
(cid:113)
x2 + 2(1 + √2)e−1−√

2x

if 0 ≤ x ≤ e−1−√
if x > e−1−√

2.

2,

(2.4)

ω(x) =

The ω-convexity of E∞ then leads to the following result on the well-posedness of the gradient

ﬂow:

Theorem 2.4 ( [20, Theorem 4.3, Proposition 4.4]). For any ρ0 ∈ D(E∞) (that is, ρ0 ∈ P2(Rd)
with (cid:107)ρ0(cid:107)∞ ≤ 1), the gradient ﬂow ρ∞(t) of E∞ with initial data ρ0 is well-posed. Speciﬁcally
ρ∞ : (0, +∞) → P2(Rd) is the unique curve that is locally absolutely continuous in time, with
ρ∞(t)

λω
2

(2.5)

2 (ρ∞(t), ν) +

2 (ρ∞(t), ν)) ≤ E(ν) − E(ρ∞(t)), ∀ν ∈ D(E∞), a.e. t > 0.
In order to provide a PDE characterization of ρ∞(x, t) in Section 3, we use the following

ω(W 2

higher regularity of ρ∞(x, t) and ∇Nρ∞(x, t), which we prove in appendix Section 5.2.
Proposition 2.5 (time regularity of the gradient ﬂow of E∞). Suppose ρ∞(x, t), with initial
data ρ∞(x, 0) ∈ D(E∞), is a gradient ﬂow of E∞. Then W2(ρ∞(t), ρ∞(s)) ≤ 2Cd|t− s|, where
Cd > 0 is as in Proposition 2.3.

t→0
−−→ ρ0 and
1
d
dt
2

W 2

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

11

Proposition 2.6. Suppose ρ∞(x, t), with initial data ρ∞(x, 0) ∈ D(E∞), is a gradient ﬂow
of E∞. Then ∇Nρ∞(x, t) is log-Lipschitz in space and 1/2d-H¨older continuous in time. In
particular, with Cd > 0 and σ(x) as in Proposition 2.3,

|∇Nρ∞(x, t) − ∇Nρ∞(y, t)| ≤ Cdσ(|x − y|)
|∇Nρ∞(x, t) − ∇Nρ∞(x, s)| ≤ 10Cd|t − s|1/2d for all 0 < |t − s| < e(−1−√

for all x, y ∈ Rd, t ≥ 0,

2)/2, x ∈ Rd.

An important tool in the analysis of Wasserstein gradient ﬂows is a discrete time approxi-
mation of gradient ﬂows known as the discrete gradient ﬂow or JKO scheme [27]. This scheme
is analogous to the implicit Euler method for approximation of ordinary diﬀerential equations
in Euclidean space. For any µ ∈ D(E∞) and time step τ > 0, the discrete gradient ﬂow of E∞
is given by

(cid:27)

ρn
τ ∈ argmin
ν∈P2(Rd)

2 (ρn−1
W 2

τ

, ν) + E∞(ν)

and ρ0

τ := ρ.

By [20, Theorem 4.3, Proposition 4.4], the discrete gradient ﬂow of E∞ exists for all ρ ∈ D(E∞)
and τ > 0, and if τ = t/n for any t ≥ 0, the discrete gradient ﬂow converges to the continuous
gradient ﬂow,

n→+∞ W2(ρn
lim

t/n, ρ∞(t)) = 0.

As demonstrated in previous work by the ﬁrst author [20], well-posedness of the gradient

ﬂows of ω-convex eneriges is closely related to the well-posedness of the ODE

(2.6)

dt Ft(x) = −Cdω(Ft(x)),
F0(x) = x.

2, and t ≥ 0, the solution is given by Ft(x) = xeCdt
In a similar way, analysis of the discrete gradient ﬂow of E∞ is closely related to a discrete

For ω(x) as in equation (2.4), 0 ≤ x ≤ e−1−√
Furthermore, for all x, t ≥ 0, Ft(x) is nondecreasing in space and nonincreasing in time.
(cid:40)
time approximation of (2.6). In particular, we deﬁne

.

(cid:26) 1

2τ

(cid:40) d

fτ (x) :=

x − Cdτ ω(x)
0

if x ≥ 0,
if x ≤ 0,

(m)
so that f
(x) is the mth step of the explicit Euler method with time step τ . In the following
τ
proposition, we recall some properties of the function fτ (x) that will be useful in our estimates
of the discrete time sequences.

Proposition 2.7 (properties of fτ (x)).

d c2
(i) If 0 ≤ x ≤ y ≤ r, there exists cr > 0 so that fτ (x) ≤ fτ (y) + C2
(ii) For all x, y ≥ 0, fτ (x + y) ≤ fτ (x) + y.
(iii) For all x, t ≥ 0, |Ft(x) − f

t/n(x)| ≤ Cdω(x)t/n.

(n)

rτ 2.

Proof. (i) and (ii) are consequences of [20, Lemma 2.25]. (iii) is a consequence of [20, Propo-
(cid:3)
sition 2.24] and the fact that Ft(x) is nonincreasing in time.

Finally, we recall a contraction inequality for the discrete gradient ﬂow of an ω-convex

energy, which we use to conclude stability of the discrete gradient ﬂow sequences.

(cid:26) 1

2τ

(cid:26) 1

2τ

12

KATY CRAIG, INWON KIM, AND YAO YAO

Proposition 2.8 (contraction inequality). Let E : P2(Rd) → R∪{+∞} be proper, lower semi-
continuous, bounded below, and ω-convex along generalized geodesics, for ω(x) as in equation
(2.4) and λω ≤ 0. Fix ρ, µ ∈ D(E) and, for τ > 0, choose ρτ and µτ satisfying

(cid:27)

(cid:27)

ρτ ∈ argmin
ν∈P2(Rd)

W 2

2 (ρ, ν) + E(ν)

and µτ ∈ argmin
ν∈P2(Rd)

W 2

2 (µ, ν) + E(ν)

.

Then there exist positive constants C and τ∗ depending on W2(ρ, µ), λω, E(µ), and E(ν) so
that for all 0 < τ < τ∗,

f (2)
τ

(W 2

2 (ρτ , µτ )) ≤ W 2

2 (ρ, µ) + |λω|τ ω(CW2(µ, µτ )) + 2τ (E(ρ) − E(ρτ )) + Cτ 2.

Proof. This is a particular case of [20, Theorem 3.2].

(cid:3)

Remark 2.9 (Wasserstein gradient ﬂow of measures with mass not equal to 1). We conclude
by observing that the gradient ﬂow theory can be easily extended to nonnegative measures

same A), we can then deﬁne W2(µ, ν) in the same way as in (2.1), and given initial data

whose integral is not equal to 1. For a ﬁxed A > 0, let P2,A(Rd) denote the set of non-negative
measures that integrate to A and have ﬁnite second moment. For µ, ν ∈ P2,A(Rd) (with the
ρ0 ∈ P2,A(Rd) with (cid:107)ρ0(cid:107)∞ ≤ 1, the same arguments lead to the well-posedness of a gradient
ﬂow ρ∞ : (0, +∞) → P2,A(Rd) of E∞. However, for the sake of simplicity, we will assume that

ρ0 is a probability measure for the remainder of this section.

2.2. Deﬁnitions of energies and discrete time sequences. We now turn to the deﬁnitions
of the energies and discrete time sequences that we will use to show that solutions of the
nonlinear diﬀusions equations (PME-D)m converge as m → +∞ to the the gradient ﬂow
of the height constrained interaction energy E∞. We begin by deﬁning the local potential
Φ1/m(x, t), which induces the drift in (PME-D)m. As described in the introduction, previous
work by Alexander, Kim, and Yao suggests that the gradient ﬂow of E∞ should be obtained
as the limit of the gradient ﬂows of the Keller-Segel energy EKS, deﬁned in equation (1.10).
However, we lack suﬃcient convexity of EKS to prove this rigorously.
Instead, we replace
the nonlocal potential Nρ in EKS with a local potential Φ1/m(x, t) that depends on time, the
initial data ρ0(x) of the gradient ﬂow of E∞, and the diﬀusion parameter m ≥ 1.
Deﬁnition 2.10 (local potential Φ1/m(x, t)). Given initial data ρ0, let ρ∞(x, t) be the gradient
ﬂow of the height constrained interaction energy E∞. Fix a molliﬁer ψ ∈ C∞
c (Rd) satisfying

ψ ≥ 0 and(cid:82) ψ = 1, and let ψ1/m(x) = mdψ(mx). Then, for any m > 1, deﬁne

(2.7)

Φ(x, t) = Nρ∞(x, t) and Φ1/m(x, t) = ψ1/m ∗ Nρ∞(x, t).

This deﬁnition is guided by the following intuition: given initial data ρ0, one heuristically
expects that the gradient ﬂow of EKS should converge to ρ∞. Consequently, if we replace Nρ
in the deﬁnition of EKS by Nρ∞, we expect that the gradient ﬂow of this new energy will still
converge to ρ∞ as m → +∞. We include the extra molliﬁcation on the potential to leverage
the existing theory on the porous medium equation with drift, which requires the potential to
be twice continuously diﬀerentiable in space. By Proposition 2.6, ∇Φ(x, t) is log-Lipschitz in
space, hence ∇Φ1/m = ψ1/m ∗ ∇Φ converges to ∇Φ uniformly on Rd × [0, +∞). Furthermore,
by Proposition 2.3,

(2.8)

(cid:107)∇Φ1/m(·, t)(cid:107)∞ ≤ Cd,

(cid:107)∆Φ1/m(·, t)(cid:107)∞ ≤ 1.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

13

With this precise deﬁnition of the drift arising in (PME-D)m in hand, we now turn to
the deﬁnitions of the the three energy functionals that we use in our analysis of the limit of
(PME-D)m as m → +∞.
Deﬁnition 2.11 (energy functionals). Fix ψ ∈ C∞
(cid:40) 1
(cid:82) Nρ(x)dρ(x)
with (cid:107)µ(cid:107)∞ ≤ 1. For any ρ ∈ P2(Rd), deﬁne
(cid:40)(cid:82) Nµ(x)dρ(x)
(cid:40) 1

c (Rd) as in Deﬁnition 2.10 and µ ∈ P2(Rd)

if (cid:107)ρ(cid:107)∞ ≤ 1,
otherwise;
if (cid:107)ρ(cid:107)∞ ≤ 1,
otherwise;

(cid:82) ρ(x)mdx +(cid:82) ψ1/m ∗ Nµ(x)dρ(x)

˜E∞(ρ; µ) :=

E∞(ρ) :=

Em(ρ; µ) :=

+∞

2

if ρ (cid:28) Ld,
otherwise.

+∞
m−1
+∞

As shown in previous work by the ﬁrst author, the gradient ﬂows of the above energies are
well-posed [20, Theorem 4.3, Proposition 4.4]. In particular, while these energies fall outside
the scope of the theory of gradients ﬂows of semiconvex energies, all three energies are instead
ω-convex along generalized geodesics for λω = −Cd, as in Proposition 2.3, and ω(x) a log-
Lipschitz modulus of convexity, as in equation (2.4). The third energy is also λ-convex along
generalized geodesics for λ = λ(m)

m→+∞
−−−−−→ −∞ [2, Proposition 9.3.2, Proposition 9.3.9].

Corresponding to these energies, we consider the following discrete time sequences.

Deﬁnition 2.12 (discrete time sequences). For a ﬁxed time step τ > 0 and ρ ∈ D(E∞), deﬁne

(i) discrete gradient ﬂow of E∞:

ρn
τ ∈ argmin
ν∈P2(Rd)

2 (ρn−1
W 2

τ

, ν) + E∞(ν)

and ρ0

τ := ρ.

(ii) time varying discrete gradient ﬂow of ˜E∞: for ρn

τ as in (i),

2 (˜ρn−1
W 2

τ

, ν) + ˜E∞(ν; ρn
τ )

and ˜ρ0

τ := ρ.

(iii) time varying discrete gradient ﬂow of Em: for ρn

τ as in (i) and m > 1,

2 (ρn−1
W 2

τ,m , ν) + Em(ν; ρn
τ )

and ρ0

τ,m := ρ.

The existence of the above sequences is guaranteed by [20, Theorem 4.3, Proposition 4.4].
However, they are not necessarily unique, and we use the notation ρn
τ,m to denote
any such sequence. Still, using Proposition 2.8, which provides a contraction inequality for
ω-convex functions, we can at least bound the Wasserstein distance between any two such
sequences—for example, see Proposition 5.5 in the appendix for such an estimate for ˜E∞.

τ , and ρn

If one takes τ = t/n for t ≥ 0, then as n → +∞ the discrete gradient ﬂow of E∞ converges to
the continuous gradient ﬂow of E∞ with initial data ρ∞(0) = ρ [20, Theorem 4.3, Proposition
4.4]. Likewise, ρn
t/n,m converges to a solution of the nonlinear diﬀusion equations (PME-D)m,
which we denote by ρm(x, t), with the same initial data (see Proposition 5.6) . We refer to ρn
τ,m

τ , ˜ρn

2τ

(cid:26) 1
(cid:26) 1
(cid:26) 1

2τ

2τ

˜ρn
τ ∈ argmin
ν∈P2(Rd)

ρn
τ,m ∈ argmin
ν∈P2(Rd)

(cid:27)
(cid:27)
(cid:27)

(cid:26) 1
(cid:26) 1

2τ

2τ

(cid:26) 1

(cid:27)

(cid:27)

14

KATY CRAIG, INWON KIM, AND YAO YAO

as the “time varying” discrete gradient ﬂow of Em since we change the second argument of
Em(·;·) at each step of the sequence to accommodate the time dependent drift in (PME-D)m.
The main goal of this section is to show that limm→+∞ W2(ρ∞(t), ρm(t)) = 0, which we
accomplish by showing that the distance between the sequences ρn
τ,m becomes arbitrarily
small as m → +∞. We use the sequence ˜ρn
τ , deﬁned in (ii) above, to serve as a bridge between
the two. In what follows, we will often use the crude estimate ω(x) ≤ √x, for x ≥ 0 suﬃciently
small. Consequently, the rate of convergence we obtain for ρm(t) → ρ∞(t) is certainly not
sharp, but the inequalities are much simpler.
We close this introductory section with a few elementary estimates on the above discrete
time sequences. In these estimates, as well as in what follows, it will be useful to consider one
step of the above sequences:

τ and ρn

Deﬁnition 2.13 (one step minimizers). For a ﬁxed time step τ > 0, we deﬁne

(cid:27)
(i) one step of discrete gradient ﬂow of E∞: given ρ ∈ P2(Rd),

ρτ ∈ argmin
ν∈P2(Rd)

W 2

2 (ρ, ν) + E∞(ν)

(ii) one step of discrete gradient ﬂow of ˜E∞(·; µ): given ρ ∈ P2(Rd) and µ ∈ P2(Rd) with

(cid:107)µ(cid:107)∞ ≤ 1,

˜ρτ ∈ argmin
ν∈P2(Rd)

W 2

2 (ρ, ν) + ˜E∞(ν; µ)

.

(iii) one step of discrete gradient ﬂow of Em(·; µ): given ρ ∈ P2(Rd), µ ∈ P2(Rd) with

(cid:107)µ(cid:107)∞ ≤ 1, and m > 1,

ρτ,m ∈ argmin
ν∈P2(Rd)

2τ

W 2

2 (ρ, ν) + Em(ν; µ)

.

As before, [20, Theorem 4.3, Proposition 4.4] ensures these minimization problems admit at
least one solution. Again, these minimizers are not necessarily unique, and we use the notation
ρτ , ˜ρτ , and ρτ,m to denote any such minimizer.

First, we estimate how the Wasserstein distance, energies, and Lm norms behave under one

step of the discrete gradient ﬂow.

Lemma 2.14. Fix ρ, µ ∈ P2(Rd) with (cid:107)µ(cid:107)∞ ≤ 1. Then for Cd > 0 as in Proposition 2.3 and
any τ > 0 and m ≥ 2,

(i) If (cid:107)ρ(cid:107)∞ ≤ 1, then W2(ρτ , ρ) ≤ 2Cdτ and E∞(ρ) ≤ E∞(ρτ ) + 2C2
d τ ;
(cid:113) 2τ
(ii) If (cid:107)ρ(cid:107)∞ ≤ 1, then W2(˜ρτ , ρ) ≤ 2Cdτ and ˜E∞(ρ; µ) ≤ ˜E∞(˜ρτ ; µ) + 2C2
d τ ;
(iii) For all ρ ∈ P2(Rd),
m ≤ 1

m−1(cid:107)ρτ,m(cid:107)m

1

m−1 ((cid:107)ρ(cid:107)m

m − (cid:107)ρτ,m(cid:107)m
m) + 2Cdτ ,
W2(ρτ,m, ρ) ≤
and Em(ρ; µ) ≤ Em(ρτ,m; µ) + ((cid:107)ρ(cid:107)m
m − (cid:107)ρτ,m(cid:107)m
(cid:16)

(cid:113) 2τ
(cid:17)
˜E∞(ρ; µ) − ˜E∞(˜ρτ ; µ)

m) + Cd

.

Proof. We begin with (ii). Taking ν = ρ in the deﬁnition of ˜ρτ and rearranging,

W 2

2 (˜ρτ , ρ) ≤ 2τ

m + τ

2 C2
d ,

m−1(cid:107)ρ(cid:107)m
d τ .

m + 2C2

m−1(cid:107)ρ(cid:107)m

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

15

(cid:90)

(cid:90)

(cid:90)

(cid:90)

Thus, applying Lemma 2.2, with f = Nµ, and Proposition 2.3

Nµdρ −
Combining the above two inequalities gives the results.

0 ≤ ˜E∞(ρ; µ) − ˜E∞(˜ρτ ; µ) =

Nµd˜ρτ ≤ CdW2(˜ρτ , ρ).

Next, we show (i). Again, taking ν = ρ in the deﬁnition of ρτ ,
W 2
2 (ρτ , ρ) ≤ 2τ (E∞(ρ) − E∞(ρτ )).

Thus, applying Lemma 2.2, with f = Nρ and f = Nρτ , along with Proposition 2.3,

(cid:90)

(cid:19)

0 ≤ E∞(ρ) − E∞(ρτ ) =
Combining the above two inequalities again give the results.

Nρdρ −

Nρdρτ +

Nρτ dρ −

Nρτ dρτ

≤ CdW2(ρτ , ρ).

It remains to show (iii). For simplicity of notation, let Φ1/m = ψ1/m ∗ Nµ. Taking ν = ρ in

the deﬁnition of ρτ,m,

(cid:18)(cid:90)

1
2

(2.9)

1
2τ

W 2

2 (ρ, ρτ,m) + Em(ρτ,m; µ) ≤ Em(ρ; µ).

By deﬁnition of Em, Lemma 2.2 with f = Φ1/m, and Proposition 2.3, this implies

(cid:18)(cid:90)

(cid:90)

(cid:19)

(cid:107)ρτ,m(cid:107)m

m/(m − 1) ≤ (cid:107)ρ(cid:107)m
≤ (cid:107)ρ(cid:107)m
= (cid:107)ρ(cid:107)m

Φ1/mρτ,m

Φ1/mρ −

− W 2
m/(m − 1) +
m/(m − 1) + CdW2(ρ, ρτ,m) − W 2
2 (ρ, ρτ,m)/(2τ )
m/(m − 1) − (W2(ρ, ρτ,m) − τ Cd)2 /(2τ ) + τ C2

d /2

Dropping the negative term shows the second inequality. Rearranging gives

2 (ρ, ρτ,m)/(2τ )

(W2(ρ, ρτ,m) − τ Cd)2 /(2τ ) ≤ (cid:107)ρ(cid:107)m

m/(m − 1) − (cid:107)ρτ,m(cid:107)m

which, by the subadditivity of √·, gives the ﬁrst inequality.

To show the third inequality, we combine (2.9) with Lemma 2.2 and use the previous estimate

d /2,

m/(m − 1) + τ C2
(cid:90)

m) +

Nµd(ρ − ρτ,m)

on the Wasserstein distance,

0 ≤ Em(ρ; µ) − Em(ρτ,m; µ) ≤
≤ ((cid:107)ρ(cid:107)m

m − (cid:107)ρτ,m(cid:107)m

m) + Cd

(cid:114)

1

((cid:107)ρ(cid:107)m
m − 1
2τ
m − 1(cid:107)ρ(cid:107)m

m − (cid:107)ρτ,m(cid:107)m
m + 2C2

d τ.

(cid:3)

Iterating the above lemma provides bounds on the Wasserstein distance between the discrete

time sequences of E∞, ˜E∞, and Em and their initial data.
Corollary 2.15. Under the assumptions in Lemma 2.14, given initial data ρ ∈ D(E∞),
d n2τ 2.

m + 8C2

(cid:113)

W2(ρn

τ , ρ) ≤ 2Cdnτ, and W2(ρn

τ , ρ) ≤ 2Cdnτ, W2(˜ρn

4nτ(cid:107)ρ(cid:107)m

m,τ , ρ) ≤

Proof. The ﬁrst two inequalities are a direct consequence of Lemma 2.14 and triangle inequality,
so it remains to show the third inequality. By Lemma 2.14 and (a + b)2 ≤ 2a2 + 2b2,

W 2

2 (ρi

τ,m, ρi−1

τ,m) ≤

4τ
m − 1

((cid:107)ρi−1

τ,m(cid:107)m

m − (cid:107)ρi

τ,m(cid:107)m

m) + 8C2

d τ 2.

16

KATY CRAIG, INWON KIM, AND YAO YAO

The result then follows by the triangle inequality, Cauchy’s inequality, and 1/(m − 1) ≤ 1,

(cid:32) n(cid:88)

i=1

(cid:33)2

n(cid:88)

i=1

≤ n

W 2

2 (ρn

τ,m, ρ) ≤

W2(ρi

τ,m, ρi−1
τ,m)

W 2

2 (ρi

τ,m, ρi−1

τ,m) ≤ 4nτ(cid:107)ρ(cid:107)m

m + 8C2

d n2τ 2.

(cid:3)

In the next three lemmas, we estimate the size of ρτ,m. These estimates are similar in
some respects to the corresponding results in previous work by Alexander with the second and
third authors [1]. However, the proofs must be adapted since the semiconvexity of the drift
potential ψ1/m ∗ Nµ in the energy Em(·; µ) deteriorates as m → +∞, and we must instead use
that Em(·; µ) is ω-convex uniformly in m.
τ,m(cid:107)∞ ≤ 1, in the next lemma, we show that the mass
Though we do not, in general, have (cid:107)ρ1
of ρτ,m above 1 becomes arbitrarily small as m → +∞.
Lemma 2.16. Fix ρ, µ ∈ P2(Rd) with both (cid:107)ρ(cid:107)∞,(cid:107)µ(cid:107)∞ ≤ 1 and consider ρτ,m as in Deﬁnition
2.13. Then for Cd > 0 as in Proposition 2.3 and 0 < τ < 1, m ≥ 2,

(cid:90)

(cid:113)

(ρτ,m(x) − 1)+dx ≤

(2 + C2

d )/m.

Proof. By the Cauchy-Schwarz inequality and the fact that |{ρτ,m ≥ 1}| ≤

(cid:18)(cid:90)

(cid:19)1/2

(cid:18)(cid:90)

(2.10)

Furthermore, for m ≥ 2, the convexity of f (s) = sm ensures sm > 1+m(s−1)+ m(m−1)
for all s > 1, which yields (s − 1)2

(s−1)2
m(m−1) sm for all s > 0. Consequently, (2.10) becomes

2

(ρτ,m − 1)+ ≤ |{ρτ,m ≥ 1}|1/2
(cid:18)

+ ≤

(cid:90)

2

+

(ρτ,m − 1)2
(cid:90)

2

≤

(ρτ,m − 1)2

+

.

(cid:19)1/2

(cid:82) ρτ,m = 1,
(cid:19)1/2

(ρτ,m − 1)+ ≤

Rd

ρm
τ,m

m(m − 1)

Rd

Since (cid:107)ρ(cid:107)∞ ≤ 1, m ≥ 2, and τ < 1, Lemma 2.14 (iii) ensures
Substituting this into the above inequality gives the result.

.

1

m−1(cid:107)ρτ,m(cid:107)m

m ≤ 1 + C2

d /2.
(cid:3)

(cid:90)

(cid:90)

Finally, we use the previous lemma to show that ρτ,m is always close to a measure ν that

satisﬁes (cid:107)ν(cid:107)∞ ≤ 1 and is almost a one step minimizer.
Lemma 2.17. Under the assumptions of Lemma 2.16, there exists ν ∈ P2(Rd) with (cid:107)ν(cid:107)∞ ≤ 1

and C > 0 depending only on the dimension, so that

Proof. Deﬁne a :=(cid:82) (ρτ,m− 1)+. Since ρτ,m is a probably measure, a < 1, and by Lemma 2.16,

and Em(ν; µ) ≤ Em(ρτ,m; µ) + Cm

W2(ρτ,m, ν) ≤ Cm

−1/2.

(2.11)

−1/4

(cid:113)

To construct ν, we decompose ρτ,m as ρτ,m = ρ1

τ,m + ρ2

τ,m, where ρ1

τ,m = min{ρτ,m, 1 − a}

we also have a ≤

(2 + C2

d )/m.

and ρ2

τ,m = (ρτ,m − (1 − a))+. First, note that
1 ≥

ρm ≥ (1 − a)|{ρm > 1 − a}| +

(cid:90)

(ρm − 1)+ = (1 − a)|{ρm > 1 − a}| + a,

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

17

(cid:90)

(cid:90)

so subtracting a from both sides and dividing by 1 − a ensures |{ρτ,m > 1 − a}| ≤ 1. Thus,
(2.12)

ρ2
τ,m ≤
Now, choose Rd so g := 1
Young’s inequality, the deﬁnition of ρ1

2 χBRd

(ρτ,m − 1)+ + a|{ρτ,m > 1 − a}| ≤ a + a · 1 = 2a.
τ,m + g ∗ ρ2

(0) ∈ P2(Rd) and deﬁne ν = ρ1

τ,m ∈ P2(Rd). By

τ,m, and inequality (2.12),

(cid:107)ν(cid:107)∞ ≤ (cid:107)ρ1

τ,m(cid:107)∞ + (cid:107)g(cid:107)∞(cid:107)ρ2

τ,m(cid:107)1 ≤ (1 − a) +

1
2 · 2a ≤ 1.

It remains to show that ν satisﬁes (2.11). To show the ﬁrst inequality, we construct a
τ,m at its original location
τ,m ≤ 2a, the total
d )/m)1/4.

transport plan between ρτ,m and ν as follows: keep all the mass of ρ1
and distribute the mass of ρ2
cost of this plan is bounded by 2aR2

τ,m(x) uniformly over the disk BRd(x). Since(cid:82) ρ2
(cid:90)

d, which gives W2(ρτ,m, ν) ≤ √2aRd ≤ Rd(4(2+C2
(cid:90)
To show the second inequality in (2.11), we abbreviate Φ1/m = ψ1/m ∗ Nµ. Then,
Em(ν; µ) − Em(ρτ,m; µ) =

Φ1/mdρτ,m

νm −

ρm
τ,m +

(cid:90)

1

1

(cid:90)
−1 + 2a(cid:107)g ∗ Φ1/m − Φ1/m(cid:107)∞

Φ1/mdν −

m − 1
τ,m ≤ (m − 1)

(cid:90)

m − 1
(cid:90)
(g ∗ Φ1/m − Φ1/m)ρ2

m/(m − 1) +
−1 + 2a ess supx
−1 + 2a(cid:107)∇Φ1/m(cid:107)∞Rd(cid:107)g(cid:107)1 ≤ 2m

y∈BRd

(x)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

≤ (cid:107)ν(cid:107)m

≤ 2m

≤ 2m

(Φ1/m(y) − Φ1/m(x))g(x − y)dy
(2 + Cd)2/m,

−1 + 2CdRd

(cid:112)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

where in the last inequality we use Proposition 2.3.

(cid:3)

2.3. Distance between discrete time sequences of E∞, ˜E∞, and Em. In this section,
we apply the previous results to show that as m → +∞, ρm(t) converges to ρ∞(t), with
quantitative rates of convergence on bounded time intervals. We accomplish this by ﬁrst
estimating the distance between the discrete time sequences of E∞ and ˜E∞ and then ˜E∞ and
Em. We begin by showing that one step of the discrete gradient ﬂow of E∞ is also one step of
the discrete time sequence corresponding to ˜E∞.
Lemma 2.18 (one-step comparison between ρτ and ˜ρτ ). Given τ > 0 and ρ ∈ P2(Rd), if ρτ
is a one step minimizer of E∞, then it is also a one step minimizer of ˜E∞(·, ρτ ).
Proof. Assume, for the sake of contradiction, that ρτ is not a one step minimizer of ˜E∞(·, ρτ ).
Then there exists ν ∈ P2(Rd) with (cid:107)ν(cid:107)∞ ≤ 1, such that
W 2

2 (ρ, ρτ ) + ˜E∞(ρτ ; ρτ ) >

2 (ρ, ν) + ˜E∞(ν; ρτ ).

(2.13)

W 2

Deﬁne ρε := (1 − ε)ρτ + εν ∈ P2(Rd), so (cid:107)ρε(cid:107)∞ ≤ 1. We will show that for ε > 0 small,

(2.14)

W 2

2 (ρ, ρτ ) + E∞(ρτ ) >

W 2

2 (ρ, ρε) + E∞(ρε),

1
2τ

1
2τ

1
2τ

1
2τ

which contradicts the fact that ρτ is a one step minimizer of E∞.

By inequality (2.2), W 2

(2.15)

2 (ρ, ρε) ≤ (1 − ε)W 2
W 2

2 is convex along linear interpolations of measures, hence
2 (ρ, ρτ ) − W 2

2 (ρ, ρτ ) + εW 2

2 (ρ, ν) = W 2

2 (ρ, ρτ ) − ε(cid:0)W 2

2 (ρ, ν)(cid:1) .

18

KATY CRAIG, INWON KIM, AND YAO YAO

Likewise, we use that 2E∞(ρτ ) = ˜E∞(ρτ ; ρτ ) to estimate the behavior of E∞ along ρε by

(cid:90)

(cid:18) 1

E∞(ρε) =

1
2

N ((1 − ε)ρτ + εν) d ((1 − ε)ρτ + εν)

(2.16)

= (1 − ε)2E∞(ρτ ) + ε(1 − ε) ˜E∞(ν; ρτ ) + ε2E∞(ν)
= E∞(ρτ ) − ε( ˜E∞(ρτ ; ρτ ) − ˜E∞(ν; ρτ )) + Dε2,

where D := E∞(ρτ ) + E∞(ν) − ˜E∞(ν, ρτ ) is a constant independent of ε. Multiplying (2.15)
by 1/(2τ ) and adding to (2.16) yields

W 2

2 (ρ, ρε) + E∞(ρε)

1
2τ
≤
By (2.13), the quantity within parentheses is strictly positive, hence we obtain (2.14) for ε
(cid:3)
small.

2 (ρ, ν)) + ˜E∞(ρτ ; ρτ ) − ˜E∞(ν; ρτ )

W 2
2 (ρ, ρτ ) + E∞(ρτ ) − ε

2 (ρ, ρτ ) − W 2

+ Dε2.

(W 2

1
2τ

2τ

(cid:19)

Using this lemma and Proposition 2.8, which proves a contraction inequality for one step
of the discrete gradient ﬂows of ω-convex energies, we can bound the distance between the
discrete gradient ﬂow of E∞ and the discrete time sequence corresponding to ˜E∞.

Proposition 2.19 (multi-step comparison between ρn
τ ). Given T > 0 and initial data
ρ ∈ D(E∞), there exist positive constants C and N depending on the dimension, T , and E∞(ρ)
so that for τ = t/n, 0 ≤ t ≤ T , and n > N ,

τ and ˜ρn

W2(ρn

τ , ˜ρn

τ ) ≤ C(n

−1/2)1/2e2CdT

,

τ is also a time varying discrete gradient ﬂow of ˜E∞, in the sense of
Proof. By Lemma 2.18, ρn
Deﬁnition 2.12 (ii). Hence, by Proposition 5.5, for any T > 0 there exist positive constants
C and N (which we allow to change from line to line), depending on the dimension, T , and
E∞(ρ) so that for τ = t/n, 0 ≤ t ≤ T , and n > N ,

f (2n)
τ

(W 2

2 (ρn

τ , ˜ρn

τ )) ≤ Cω(t/n) ≤ Cn

−1/2

Furthermore, combining Corollary 2.15 and the triangle inequality provides the following crude
bound for the distance between the two sequences:

W2(ρn

τ , ˜ρn

τ ) ≤ W2(ρn

τ , ρ) + W2(˜ρn

τ , ρ) ≤ 4CdT ≤ C.

Therefore, by Proposition 2.7 (iii) and the fact that Ft(x) is decreasing in time,
τ )) ≤ Cn

−1/2 + 2Cdω(C)T /n =⇒ F2T (W 2

F2nτ (W 2

2 (ρn

2 (ρn

τ , ˜ρn

τ , ˜ρn

−1/2

Since for 0 ≤ x ≤ e−1−√

τ )) ≤ Cn
2, Ft(x) = xeCdt

, for n suﬃciently large, we have

W2(ρn

τ , ˜ρn

τ ) ≤ C(n

−1/2)1/2e2CdT

,

(cid:3)

which gives the result.

Next, we bound the distance between one step of the discrete time sequences corresponding

to ˜E∞ and Em.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

19

Proposition 2.20 (one-step comparison between ˜ρτ and ρτ,m). Given ρ, µ ∈ P2(Rd) with
(cid:107)ρ(cid:107)∞,(cid:107)µ(cid:107)∞ ≤ 1 and Cd > 0 as in Proposition 2.3, there exists C > 0 depending only on the
dimension so that for all 0 < τ < 1/6Cd and m ≥ 2,

W2(ρτ,m, ˜ρτ ) ≤ Cm

−1/8 + 2e

−1/(4Cdτ ).

Proof. Let ν be as in Lemma 2.17 and deﬁne

(cid:18) 1

2

η :=

tν
ρ +

t˜ρτ
ρ

#ρ

1
2

(cid:19)

to be the midpoint on the generalized geodesic from ν to ˜ρτ with base ρ. Since the L∞ norm of
a generalized geodesic is bounded by the L∞ norm of its endpoints (c.f. [20, inequality (60)]),
we have (cid:107)ν(cid:107)∞ ≤ 1. Furthermore, by the optimality of ρτ,m and ˜ρτ ,

1
2τ
1
2τ

W 2

2 (ρ, η) + Em(η; µ) ≥
2 (ρ, η) + ˜E∞(η; µ) ≥
W 2

1
2τ
1
2τ

W 2

2 (ρ, ρτ,m) + Em(ρτ,m; µ),

W 2

2 (ρ, ˜ρτ ) + ˜E∞(˜ρτ ; µ).

Adding these inequalities together and collecting the distance and energy terms gives

(2.17)

for

TW + TE ≥ 0,

W 2

1
τ

1
2τ

W 2

2 (ρ, η) −

TW :=
TE := Em(η; µ) + ˜E∞(η; µ) − Em(ρτ,m; µ) − ˜E∞(˜ρτ ; µ).

2 (ρ, ρτ,m) −

2 (ρ, ˜ρτ ),

1
2τ

W 2

Next, we ﬁnd upper bounds on TW and TE. Deﬁne A := (cid:107)tν

2-convex along generalized geodesics with base ρ [2, Lemma 9.2.1],

ρ (cid:107)L2(ρ). Since W 2

2 (ρ,·) is

ρ − t˜ρτ
2 (ρ, ˜ρτ )/2 − A2/4.

2 (ρ, η) ≤ W 2
W 2
Substituting this in the deﬁnition of TW ,

2 (ρ, ν)/2 + W 2

TW ≤
≤

1
2τ
1
2τ

(W 2

2 (ρ, ν) − W 2

2 (ρ, ρτ,m)) −

A2
4τ ≤

1
2τ

W2(ρτ,m, ν)(W2(ρ, ν) + W2(ρ, ρτ,m)) −

A2
4τ

W2(ρτ,m, ν)(W2(ρτ,m, ν) + 2W2(ρ, ρτ,m) −

A2
4τ ≤

C
2τ

m

−1/4 −

A2
4τ

,

where in the last inequality we apply W2(ρτ,m, ν) ≤ Cm−1/4 from Lemma 2.17, W2(ρτ,m, ρ) ≤
√2τ + 2Cdτ from Lemma 2.14, and the facts that m ≥ 2 and τ < 1. We also allow C > 0,

depending only on the dimension, to change from line to line.

In order to bound TE from above, we ﬁrst estimate the diﬀerence between Em(˜µ, µ) and

˜E∞(˜µ, µ) for any ˜µ ∈ P2(Rd) with (cid:107)˜µ(cid:107)∞ ≤ 1. As usual, we abbreviate Φ := Nµ and Φ1/m :=
ψ1/m ∗ Nµ. Given Rψ > 0 so that supp ψ ⊆ BRψ (0), for any x ∈ Rd, Proposition 2.3 ensures

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)

|Φ1/m(x) − Φ(x)| =

Consequently,

(cid:12)(cid:12)(cid:12)Em(˜µ; µ) − ˜E∞(˜µ; µ)
(cid:12)(cid:12)(cid:12) ≤

(Φ(x − y) − Φ(x))ψ1/m(y)dy

Rd

(cid:90)

(cid:90) (cid:12)(cid:12)Φ1/m − Φ

1

m − 1

˜µm+

(cid:12)(cid:12)(cid:12)(cid:12) ≤ Rψ(cid:107)∇Φ(cid:107)∞m
(cid:12)(cid:12) d˜µ ≤ (m−1)

−1 ≤ Cdm

−1.

−1+(cid:107)Φ1/m−Φ(cid:107)∞ ≤ (2+Cd)m

−1.

20

KATY CRAIG, INWON KIM, AND YAO YAO

Therefore, ﬁrst applying Lemma 2.17 to the deﬁnition of TE and then using the above inequal-
ity,

(2.18)

TE ≤ Em(η; µ) + ˜E∞(η; µ) − Em(ν, µ) − ˜E∞(˜ρτ ; µ) + Cm

≤ 2 ˜E∞(η; µ) − ˜E∞(ν, µ) − ˜E∞(˜ρτ ; µ) + Cm

−1/2.

−1/2

Since ˜E∞(·, µ) is ω-convex along generalized geodesics and η is the midpoint along the gener-
alized geodesic from ν and ˜ρτ with base ρ,

(cid:18) A2

(cid:19)

.

4

Cd
2

ω

Substituting this into inequality (2.18) gives

Finally, combining our upper bounds on TW and TE with inequality (2.17), we obtain

2 ˜E∞(η; µ) − ˜E∞(ν; µ) − ˜E∞(˜ρτ ; µ) ≤

−1/2 + Cdω(cid:0)A2/4(cid:1) .
−1/4 + 4Cdτ ω(cid:0)A2/4(cid:1) .

TE ≤ Cm

A2 ≤ Cm

√2Cm

−1/8 + 2e

−1/(4Cdτ )

(2.19)

We now claim that

(2.20)

If A2/4 > e−1−√
A2 ≤ Cm

A ≤

−1/4 + 4τ Cdω(cid:0)A2/4(cid:1)

2, then combining inequality (2.19) and τ < 1/(6Cd) implies

≤ Cm

−1/4 + 3τ CdA2 =⇒ A ≤

√2Cm

−1/8,

hence (2.20) holds. Alternatively, if A2/4 ≤ e−1−√
−1/4 + 4τ Cdω(cid:0)A2/4(cid:1) = Cm
(2.21)
If (2.20) is violated, we have A > √2Cm−1/8 and A > 2e−1/(4Cdτ ), so Cm−1/4 < A2/2 and
−Cdτ A2 log(A2/4) < A2
2 . Adding these together would contradict (2.19), so again (2.20) holds.
˜ρτ #˜ρτ = ν, we have W2(ν, ˜ρτ ) ≤ A.

−1/4 − Cdτ A2 log(cid:0)A2/4(cid:1) .

˜ρτ −id(cid:107)L2(˜ρτ ) and tν

ρ (cid:107)L2(ρ) = (cid:107)tν

A2 ≤ Cm

Since A = (cid:107)tν

ρ−t˜ρτ

Therefore, using (2.20) and Lemma 2.17, we may conclude the result,

ρ◦tρ

2,

W2(ρτ,m, ˜ρτ ) ≤ W2(ρτ,m, ν) + W2(ν, ˜ρτ ) ≤ Cm

−1/4 + √2Cm

−1/8 + 2e

≤ Cm

−1/(4Cdτ ) ≤ Cm

−1/8 + 2e

−1/(4Cdτ ).

(cid:3)

ρ◦tρ
−1/4 + A

Proposition 2.21 (multi-step comparison between ˜ρn
τ,m). Given T > 0 and initial
data ρ ∈ D(E∞), there exist positive constants C, N , and M depending on the dimension, T ,
E∞(ρ), and ψ so that for τ = t/n, 0 ≤ t ≤ T , n > N , m > M , and n = o(m1/8),

τ and ρn

W2(ρn

−1/4 + nm

−1/8)1/2e2CdT

τ ) ≤ C(n

τ,m, ˜ρn
τ ) for any i = 1, . . . , n. Using Corollary 2.15 and (cid:107)ρ(cid:107)m

m ≤ 1, we

Proof. Deﬁne di := W2(ρi
have the crude bound

τ,m, ˜ρi

(2.22)

di ≤ W2(ρi

τ,m, ρ) + W2(˜ρi

τ , ρ) ≤

4T + 8CdT 2 + 2CdT.

(cid:112)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

21

Figure 1. An illustration of the tree structure used in the multi-step compar-
ison between ˜ρn

τ and ρn

τ,m

The one step estimates from Proposition 2.20 allow us to control the distance between

one-step minimizers of Em and ˜E∞ when they have the same initial data. In particular, for

(2.23)

δ := Cm

−1/8 + 2e

−1/(4Cdτ ),

we have d1 ≤ δ. In order to apply Proposition 2.20 to control di for i = 2, . . . , n, we use a
sequence of densities ηi to serve as a bridge between ρi
τ , following the tree structure
in Figure 1. Speciﬁcally, we choose ηi ∈ P2(Rd) so that, by Proposition 2.20,

τ,m and ˜ρi

(2.24)

ηi ∈ argmin
ν∈P2(Rd)

2 (˜ρi−1
W 2

τ

, ν) + Em(ν; ρi
τ )

=⇒ W2(˜ρi

τ , ηi) ≤ δ.

(cid:26) 1

2τ

(cid:27)

τ

and ρi−1

Since ηi and ρi

τ,m are one-step minimizers of the same energy Em(·, ρi
τ,m respectively), we may control their distance using Proposition 2.8.

First, we obtain a few elementary bounds on how the energy changes along the discrete time
τ,m as

data (˜ρi−1
sequence. Combining Lemma 2.2, Proposition 2.3, Lemma 2.14, and the deﬁnition of ρi−1
a minimizer,
Em(ρi−1

τ ) with diﬀerent initial

) + Em(ρi−1

τ,m; ρi

τ

τ ) = Em(ρi−1
= Em(ρi−1
≤ Em(ρi−2

τ,m; ρi−1
τ,m; ρi−1
τ,m; ρi−1

τ

τ

(cid:90)

) +

) + 2C2

τ

)

τ ) − Em(ρi−1
τ,md(ρi

τ,m; ρi
ψ1/m ∗ Nρi−1
d τ ≤ ··· ≤ Em(ρ; ρ1

τ,m; ρi−1
τ − ρi−1
τ ) + 2C2

τ

d T.

) ≤ Em(ρi−2

τ,m; ρi−1

τ

) + CdW2(ρi

τ , ρi−1

τ

)

ρ0˜ρ1τ˜ρ2τ˜ρ3τρ1τ,mρ2τ,mρ3τ,m≤δ≤δ≤δd2dnd1ρnτ,m˜ρnτd3η2η3EmEmEmEmEmEm˜E∞˜E∞˜E∞˜E∞(cid:90)

(cid:90)

Likewise, we may control the ﬁrst term on the right hand side of the last inequality by

Em(ρ; ρ1

τ ) = (cid:107)ρ(cid:107)m

m/(m − 1) +

ψ1/m ∗ Nρ1
Nρd(ψ1/m ∗ ρ1
τ dρ ≤ 1 + 2E∞(ρ) +
≤ 1 + 2E∞(ρ) + CdW2(ψ1/m ∗ ρ1
τ , ρ) ≤ 1 + 2E∞(ρ) + Cd(W2(ψ1/m ∗ ρ1
≤ 1 + 2E∞(ρ) + Cd((1/m)Mψ + 2Cdτ )
(cid:18)(cid:90)

(cid:19)1/2

where, in the last step, we apply [2, Lemma 7.1.10], which ensures

W2(µ ∗ ψ1/m, µ) ≤

1
m

|x|2ψ(x)dx

=:

Mψ.

1
m

(2.25)

τ − ρ)
τ , ρ1

τ ) + W2(ρ1

τ , ρ))

Combining the above two inequalities, we conclude that there exists constant C > 0 (which
we allow to change from line to line) depending on the dimension, T , E∞(ρ), and ψ so that

22

KATY CRAIG, INWON KIM, AND YAO YAO

Em(ρi−1

τ,m; ρi

τ ) ≤ C for all i = 1, . . . , n.

Furthermore, by Proposition 2.3, we also have that Em(·;·) is uniformly bounded below.
Using these estimates on the energy, we may now apply Proposition 2.8 to conclude that
there exist positive constants C and N depending on the dimension, T , E∞(ρ), and ψ, which
we allow to change from line to line, so that for τ = t/n, 0 ≤ t ≤ T , and n > N ,
f (2)
τ

τ )) + Cτ 2.
By Lemma 2.14 (iii), we have the following bounds for two quantities on the right hand side:

)) + 2τ (Em(ρi−1

τ ) − Em(ρi

τ,m)) ≤ d2

2 (ηi, ρi

τ,m; ρi

τ,m; ρi

(W 2

τ

τ

2τ

) ≤
τ ) ≤

τ ) − Em(ρi

W2(ηi, ˜ρi−1
τ,m; ρi

i−1 + Cdτ ω(CW2(ηi, ˜ρi−1
(cid:114)
(cid:0)
m − 1(cid:107)˜ρi−1
τ (cid:107)m
(cid:107)ρi−1
m − (cid:107)ρi
τ,m(cid:107)m
i−1 + 2τ(cid:0)
(cid:107)ρi−1
τ,m(cid:107)m
τ , ηi)(cid:1)2
τ,m, ˜ρi
≤ W 2
τ,m) ≤ W2(ηi, ˜ρi−1

τ,m)) ≤ d2

τ,m) + W2(˜ρi

W2(ηi, ρi

2 (ηi, ρi

τ

Em(ρi−1

τ,m; ρi

f (2)
τ

(W 2

(cid:0)W2(ηi, ρi

) + di−1 + δ ≤ C,

m

(cid:1) + C√τ .
m + 2Cdτ ≤ C√τ ,
τ,m(cid:107)m
(cid:1) + Cτ 5/4
τ,m) +(cid:0)2W2(ηi, ρi

τ,m(cid:107)m

m

m − (cid:107)ρi
τ ). By the triangle inequality and (2.24),
2 (ηi, ρi

τ,m) + δ(cid:1) δ

Therefore,

(2.26)

(2.27)

d2
i ≤

Furthermore, by Lemma 2.14 (iii), inequality (2.22), and equation (2.23)

We now use this estimate to bound di = W2(ρi

(2)
Thus, by Proposition 2.7, we may apply f
τ
(d2
i ) ≤ f (2)

f (2)
τ

(W 2

to both sides of the (2.27) to obtain

2 (ηi, ρi

τ,m)) + Cδ + Cτ 2.

Combining this with (2.26) gives, for all i = 1, . . . , n,
m − (cid:107)ρi

(d2
i ) ≤ d2

(2.28)

f (2)
τ

τ,m(cid:107)m

m

(cid:1) + Cτ 5/4 + Cδ.

We claim that the result will follow if we can show that, for all j = 1, . . . , n,
m) + 2Cτ 5/4j + Cδj.

(2.29)
In particular, if this holds, then taking j = n and using that e−1/4Cdτ = O(τ 5/4) gives

n) ≤ d2
(d2

m − (cid:107)ρn

τ,m(cid:107)m

f (2j)
τ

f (2n)
τ

n) ≤ 2τ(cid:107)ρ(cid:107)m
(d2

m + 2CT τ 1/4 + Cδn ≤ C(n

−1/4 + nm

−1/8).

τ

i−1 + 2τ(cid:0)
(cid:107)ρi−1
τ,m(cid:107)m
n−j + 2τ ((cid:107)ρn−j

τ,m (cid:107)m

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

23

By Proposition 2.7 (iii) and the fact that Ft(x) is decreasing in t,

F2nτ (d2

n) ≤ C(n
For 0 ≤ x ≤ e−1−√

−1/4 + nm
2, we have Ft(x) = xeCdt

−1/8) + 2Cdω(C)T /n =⇒ F2T (d2

n) ≤ C(n

. Thus, for n and m suﬃciently large, depending

−1/4 + nm

−1/8).

on the dimension, T , E∞(ρ), and ψ, and with n = o(m1/8), we have

−1/4 + nm

−1/8)1/2e2CdT

,

dn ≤ C(n

which gives the result.

It remains to show (2.29). We proceed by induction. The base case for j = 1 follows from

(2.28), so we assume the result holds for j − 1,
n−j+1 + 2τ ((cid:107)ρn−j+1
τ,m (cid:107)m

n) ≤ d2
(d2

f (2(j−1))

τ

m − (cid:107)ρn

τ,m(cid:107)m

m) + 2Cτ 5/4(j − 1) + Cδ(j − 1).

For any j = 1, . . . , n, the right hand side is bounded by a constant depending on the dimension,
(2)
T , E∞(ρ), and ψ. Thus, by Proposition 2.7, we may apply f
τ

to both sides to conclude

f (2j))
τ

n) ≤ f (2)
(d2
≤ d2

n−j+1) + 2τ ((cid:107)ρn−j+1
τ,m (cid:107)m
(d2
n−j + 2τ ((cid:107)ρn−j
m − (cid:107)ρn
τ,m(cid:107)m

τ,m (cid:107)m

τ

τ,m(cid:107)m

m − (cid:107)ρn
m) + 2Cτ 5/4j + Cδj

m) + 2Cτ 5/4(j − 1) + Cδ(j − 1) + C2τ 2

where, in the second inequality, we apply (2.28) and the fact that C2τ 2 ≤ Cτ√τ .

(cid:3)

Combining the previous propositions, we obtain our main result.

Theorem 2.22 (convergence of ρm(t) to ρ∞(t)). Given T > 0 and initial data ρ ∈ D(E∞),
there exist positive constants C and M depending on d, T , E∞(ρ), and ψ so that for all
0 ≤ t ≤ T and m ≥ M ,

W2(ρm(t), ρ∞(t)) ≤ Cm

−1/144e4CdT

.

Proof. Combining Proposition 2.19, Proposition 2.21, [20, Theorem 3.8], and Proposition 5.6,
there exist positive constants C and N depending on d, T, E∞(ρ), and ψ so that for τ = t/n
and all n ≥ N , m ≥ d + 1, 0 ≤ t ≤ T , and n = o(m1/8),

τ , ˜ρn

W2(ρn
τ ) ≤ Cn
τ , ρ∞(t)) ≤ Cn

W2(ρn

−1/4e2CdT
,
−1/16e2CdT

,

τ,m, ˜ρn

W2(ρn
τ ) ≤ C(n
t/n,m, ρm(t)) ≤ Cn

W2(ρn

−1/4 + nm
−1/16e4CdT
.

−1/8)1/2e2CdT

Hence,

W2(ρm(t), ρ∞(t)) ≤ C(n

Taking n = m1/9 gives the result.

−1/16e4CdT

+ n1/2e2CdT

−1/16e2CdT

m

)

(cid:3)

3. Convergence of viscosity solutions: drift diffusion pressure to free

boundary problem

In the previous section, we showed that the gradient ﬂow of the height constrained interaction
energy E∞, which is merely a curve in the space of measures, may be approximated by solutions
of the nonlinear diﬀusion equations (PME-D)m as m → +∞. This approximation provides
the bridge by which we are able to unite the energy methods approach with viscosity solution
approach. In the present section, we use this approximation to characterize the dynamics of
patch solutions in terms of a Hele-Shaw type free boundary problem. We accomplish this by

24

KATY CRAIG, INWON KIM, AND YAO YAO

considering the nonlinear diﬀusion equations in terms of their pressure variables: given ρm a
weak solution of (PME-D)m, the pressure variable pm := m

m−1 (ρm)m−1 uniquely solves

(pm)t − (m − 1)pm(∆pm + ∆Φ1/m) − ∇pm · (∇pm + ∇Φ1/m) = 0.

(P)m
For initial data given by (1.9), we show that as m → +∞ the half-relaxed limits of viscosity
solutions of (P)m satisfy sub- and supersolution properties of (P)∞. The comparison principle
of (P)∞ then yields that these half-relaxed limits are ordered with respect to the viscosity
solution p of (P)∞ with the same initial data. In terms of the density variable, we show that
ρm uniformly converges to χΩ(t) away from ∂Ω(t), where Ω(t) = {p(·, t) > 0}. It follows that
ρ∞ = χΩ(t) almost everywhere, and thus (P)∞ identiﬁes with (P). Due to the fact that the
link between (P )∞ and (P ) lacks a priori stability estimates as the initial data varies, we must
introduce additional perturbations and approximations into our proof of this ﬁnal result.

Remark 3.1. The lack of the comparison principle for the original problem (P) is not the main
reason we consider (PME-D)m. We could have considered the drift term given by Φ := N ∗ ρm,
and thus proved the convergence of the Keller-Segel equation to our problem, if we had known
that the corresponding solutions ρm converged to ρ∞ as m → +∞. Obtaining such convergence
seems to require a uniform L∞ bound on the gradient ﬂow solutions of (PME-D)m, which is
an open question at the moment.
3.1. Basic properties of viscosity solutions of (P)m and (P)∞. We refer the reader to
Alexander, Kim, and Yao [1, Section 3] and Kim and Lei [33, Section 2.1] for the deﬁnitions
of classical and viscosity solutions of (P)m, and we refer the reader to appendix section 5.1 for
the deﬁnition of viscosity solutions of (P)∞. To clarify our notion of weak solutions for the
original free boundary problem (P ), we make the following deﬁnition:
Deﬁnition 3.2. p is a weak solution of (P ) if it is a viscosity solution of (P )∞ with initial
data p0 and ρ∞ = χ{p>0} almost everywhere.

We now recall the several results on well-posedness of viscosity solutions of (P)m and the

L1 contraction of the corresponding density variable.

Lemma 3.3. Consider the porous medium equation with drift and source terms,

(3.1)
with f ∈ L1 and bounded initial data.

ρt = ∇ · (ρ∇Φ1/m) + ∆ρm + ρf,

(a) If ρ1 and ρ2 are weak solutions of (3.1) with source terms f1 and f2, then for all t ≥ 0,

(cid:90) t

(cid:90)

0

(cid:107)ρ1(·, t) − ρ2(·, t)(cid:107)L1(Rd) ≤ (cid:107)ρ1(·, 0) − ρ2(·, 0)(cid:107)L1(Rd) +
ρ0 and continuous function f . Then the pressure variable pm := m−1
solution to

(b) Let ρ be a weak solution of (3.1) for any continuous, compactly supported initial data
m ρm−1 is a viscosity

Rd |ρ1f1 − ρ2f2|.

(pm)t − (m − 1)pm(∆pm + ∆Φ1/m + f ) − ∇pm · (∇pm + ∇Φ1/m) = 0.
Proof. (a) is due to [53, Section 3.2.2], and (b) follows from [33, Corollary 2.11].

(cid:3)

We now turn to the following estimates on the size and support of solutions to (P)m, which
are uniform in m. The ﬁrst ensures that if the initial data is bounded uniformly in m, it

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

25

remains so on bounded time intervals. The second ensures that if the support of the initial
data is bounded uniformly in m, it likewise remains so on bounded time intervals.

Lemma 3.4 (Estimates on size and support of solutions to (P)m). Let pm be a viscosity
solution of (P)m with continuous, compactly supported initial data pm(·, 0). Suppose that there
exists R0 ≥ 1 suﬃciently large so that {pm(·, 0) > 0} ⊆ BR0/2(0) and pm(·, 0) ≤ R2
0/4d. Deﬁne
R(t) := (R0 + Cd

d , with Cd > 0 as in (2.8). Then,

d )et/d − Cd

(a) {pm(·, t) > 0} ⊆ BR(t)(0) for all t ∈ [0, T ];
(b) pm(x, t) ≤ R(t)2/2d for all t > 0.

Proof. We prove the result by comparison with a classical supersolution of (P)m. Deﬁne

(cid:40) 1−|x|2

h(x) =

2d

0

for |x| < 1,
for |x| ≥ 1,

so that h(x) satisﬁes −∆h = 1 in |x| < 1 and h = 0 in |x| ≥ 1. Let φ(x, t) := R(t)2h(x/R(t)),
where R(t) solves R(cid:48)(t) = R(t)
d + Cd with r(0) = R0, and Cd is the upper bound of (cid:107)∇Φ1/m(cid:107)∞
given by (2.8). We claim that such φ is a classical supersolution of (P)m for all m. To check
this, direct computation gives that in the support of φ,

(3.2)

φt(x, t) = 2R(t)R

(cid:48)

(t)

1 −

|x|2
R(t)2
2d

+ R(t)2

x

dR(t)

−

xR(cid:48)(t)
R(t)2

·

−

R(t)R(cid:48)(t)

d

.

=

(cid:19)

(cid:18)

(cid:19)

(cid:18)

and (cid:107)∇φ(·, t)(cid:107)∞ = R(t)(cid:107)∇h(cid:107)∞ = R(t)
d .
∆Φ1/m ≤ 1 for all m, we have
(cid:125)
(3.3)

(m − 1)φ (∆φ + ∆Φ1/m)

(cid:123)(cid:122)

(cid:124)

≤0

−∇φ · (∇φ + ∇Φ1/m) ≤

In addition, since ∆φ = −1 in its support and

(cid:18) R(t)

d

R(t)

d

(cid:19)

+ Cd

.

Comparing (3.2) with (3.3) gives that φ is a classical supersolution if R(cid:48)(t) = R(t)
d + Cd.
With R(0) = R0, we have pm(·, 0) ≤ φ(·, 0) for all m, so comparison principle yields that
(cid:3)
{pm(·, t) > 0} ⊆ BR(t)(0) for all t, and pm(x, t) ≤ R(t)2/2d for all x, t.
Remark 3.5. Lemma 3.4 (b) and the fact that ρm = ( m−1
m pm)1/(m−1) directly lead to the bound
for all t ≥ 0,
(3.4)

m→∞ (cid:107)ρm(·, t)(cid:107)∞ ≤ 1
lim sup

which we will make use of in what follows.

A key property of viscosity solutions of (P)m is that they satisfy a comparison principle,

which we now recall. We say two functions f, g : Rd → [0,∞) are strictly separated, denoted
by f ≺ g, if f < g in {f > 0}, and {f > 0} is a compact subset of {g > 0}.
Theorem 3.6 (comparison theorem for (P)m). Suppose u and v are viscosity sub- and super-
solutions of (P)m. If the initial data are strictly ordered, i.e.

u(·, 0) < v(·, 0) in {u(·, 0) > 0} and {u(·, 0) > 0} is a compact subset of {v(·, 0) > 0},

then u(·, t) ≺ v(·, t) for all t > 0.
Proof. The result follows from [33, Theorem 2.25].

(cid:3)

26

KATY CRAIG, INWON KIM, AND YAO YAO

We also have the following comparison theorem for solutions to (P)∞, which we prove at

the end of this section.
Theorem 3.7 (comparison theorem for (P)∞). Suppose (u, Σ) and v are respectively viscosity
sub- and supersolutions of (P)∞. If the initial data are strictly ordered, i.e.

u(·, 0) < v(·, 0) in Σ ∩ {t = 0} and Σ ∩ {t = 0} is a compact subset of {v(·, 0) > 0},

(3.5)
then u(·, t) ≺ v(·, t) and ¯Σ ∩ {t} ⊂ {v(·, t) > 0} for all t > 0.

While the above theorem almost provides uniqueness of (P)∞, the requirement that the
initial data be strictly ordered prevents us from concluding this result. However, combining
the comparison principle with Perron’s method yields the following:

Theorem 3.8. For any bounded open set Ω0 ⊆ Rd with Lipschitz boundary, there exists
minimal and maximal viscosity solutions of (P)∞.
(cid:3)

Proof. The result follows from [32].

We will use this comparison theorem, as well as the L1 contraction theorem for ρm, to obtain
our ﬁrst main result: we identify ρ∞ with the characteristic function on the support of the
minimal viscosity solution of (P)∞, when the initial data p0 is given by (1.9).
3.1.1. Comparison theorem for (P)∞. To conclude this section on basic properties of viscosity
solutions of (P)m and (P)∞, we sketch the proof of the comparison principle for (P)∞, Theorem
3.7. Our approach is to consider the ﬁrst contact time for regularizations of the sub- and
supersolutions, obtained by considering their sup and inf convolutions over space-time smooth
sets. Such regularizations are often used to prove comparison principles for free boundary
problems (c.f. [1, 13, 14, 32]), as they ensure that, when the free boundaries intersect for the
ﬁrst time, the free boundaries have both the interior and exterior ball property at the contact
point. This provides suﬃcient regularity to consider a ﬁrst-order asymptotic expansion of
the free boundary graph at the contact point.
In many ways, our proof parallels previous
work by Alexander, Kim, and Yao [1, Theorem 2.7], the main diﬀerences being that our
drift term ∇Φ1/m has less regularity uniformly in m. This makes (P)∞ more susceptible to
perturbations, so we must carefully choose our regularization procedure so that the regularized
solutions remain sub- and supersolutions of the original problem.

We now describe the details of these regularizations of the sub- and supersolutions. Fix

r0 ∈ [0, e(−1−√

(3.6)

2)/2). Let r(t) be the unique solution to

(cid:40)
r(cid:48)(t) = −2Cdσ(r(t)),

r(0) = r0,

with Cd and σ(x) as deﬁned in Proposition 2.6. Given (u, Σ) and v as in Theorem 3.7, deﬁne
the spatial sup and inf convolutions

(3.7)

ur(x, t) := sup

u(y, t),

vr(x, t) := inf

Br(t)(x)

Br(t)(x)

v(y, t), Σr := ∪t>0Ωr(t)(t) × {t},

where Ωr(t)(t) := {x : d(x, Ω(t)) ≤ r(t)}. Next we deﬁne the spacetime sup and inf convolutions
(3.8)

˜ur(x, t) := sup

Br∗ (x,t)

ur(y, s), ˜vr(x, t) := inf

Br∗ (x,t)

vr(y, s), ˜Σr := {(x, t) : d((x, t), Σr) < r

∗

}.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

27

for ﬁxed r∗ > 0.
Lemma 3.9. Let r∗ := [σ(r(T ))/11]2d. Then (˜ur, ˜Σr) and ˜vr are viscosity sub- and superso-
lutions of (P)∞ in Rn × (r0, T − r∗).
Proof. We will show that (˜ur, ˜Σr) is a subsolution of (P)∞ according to Deﬁnition 5.1. Parallel
arguments apply to prove that ˜vr is a supersolution.

We begin by showing that (ur, Σr) is a subsolution of (P)∞. It follows quickly from the
deﬁnition that ur is upper semicontinuous and (ur, Σr) satisﬁes (a), so we devote our attention
to (b).

Suppose ur − ϕ has a local maximum zero at (x0, t0) with respect to Σr ∩ {t ≤ t0}. In case
(i), if either x0 ∈ Ωr(t0) or ur(x0, t0) > 0, ﬁx y0 ∈ Br(t0)(x0) so that u(y0, t0) = ur(x0, t0) and
either y0 ∈ Ω(t0) or u(y0, t0) > 0. Let ˜ϕ(x, t) = ϕ(x+x0−y0, t), so u− ˜ϕ has a local max zero in
Σ ∩ {t ≤ t0} at (y0, t0). Since (u, Σ) is a subsolution, we have −∆ϕ(x0, t0) = −∆ ˜ϕ(y0, t0) ≤ 1.
Now consider case (ii), so ur(x0, t0) = 0, with (x0, t0) ∈ ∂Σr and |∇ϕ|(x0, t0) (cid:54)= 0. Choose
y0 ∈ ∂Br(t0)(x0) so that (y0, t0) ∈ ∂Σ and u(y0, t0) = 0. Since |∇ϕ|(x0, t0) (cid:54)= 0 and ur − ϕ has
a local maximum at (x0, t0), y0 − x0 is parallel to v := ∇ϕ/|∇ϕ|(x0, t0).
Deﬁne ˜ϕ(x, t) := ϕ(x − r(t)v, t). Then ˜ϕ(y0, t0) = ϕ(x0, t0) and u − ˜ϕ has a local maximum
zero at (y0, t0) with respect to {u > 0} ∩ {t ≤ t0}. Consequently,

min(−∆ ˜ϕ − 1, ˜ϕt − |∇ ˜ϕ|2 − ∇ ˜ϕ · ∇Φ)(y0, t0) ≤ 0.

By Proposition 2.6,

|∇Φ(y0, t0) − ∇Φ(x0, t0)| ≤ Cdσ(r(t0)).

Since ˜ϕt(y0, t0) = ϕt(x0, t0) − r(cid:48)(t0)|∇ϕ|(x0, t0), we have
Hence, since r(cid:48)(t) = −2Cdσ(r(t)),

min(−∆ϕ − 1, ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ − r

(cid:48)

|∇ϕ| − Cdσ(r)|∇ϕ|)(x0, t0) ≤ 0.

min(−∆ϕ − 1, ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ + Cdσ(r)|∇ϕ|)(x0, t0) ≤ 0,
(3.9)
which, in particular, implies (ii). Therefore, (ur, Σr) is a subsolution of (P)∞.

Now we use this fact to show that (˜ur, ˜Σr) is a subsolution of (P)∞. Again, ˜ur is upper
semicontinuous and (˜ur, ˜Σr) satisﬁes (a), so we devote our attention to (b). Property (i)
follows as above, so we only discuss (ii), the barrier property on the free boundary. Suppose
˜ur − ϕ has a local maximum zero in ˜Σr ∩ {t ≤ t0} at (x0, t0) ∈ ∂ ˜Σr with ˜ur(x0, t0) = 0 and
|∇ϕ|(x0, t0) (cid:54)= 0. Choose (y0, s0) ∈ ∂Br∗(x0, t0) so (y0, s0) ∈ ∂Σr and ur(y0, s0) = 0. Since
|∇ϕ|(x0, t0) (cid:54)= 0 and ˜ur − ϕ has a local maximum zero at (x0, t0), (y0 − x0, s0 − t0) is parallel
to w := ∇x,tϕ/|∇x,tϕ|(x0, t0).
Deﬁne ˜ϕ(x, t) := ϕ((x, t)− r∗w). Then ˜ϕ(y0, s0) = ϕ(x0, t0) and ur− ˜ϕ has a local maximum
zero at (y0, s0) with respect to {ur > 0} ∩ {t ≤ t0}. Consequently, by inequality (3.9) above,
For 0 ≤ x ≤ e(−1−√
2)/2, we have − log(x) ≤ x−1/2 ≤ x−1+1/2d, hence σ(x) ≤ x1/2d. Therefore,

min(−∆ ˜ϕ − 1, ˜ϕt − |∇ ˜ϕ|2 − ∇ ˜ϕ · ∇Φ + Cdσ(r)|∇ ˜ϕ|)(y0, s0) ≤ 0.

by Proposition 2.6,

|∇Φ(y0, s0) − ∇Φ(x0, t0)| ≤ 11Cd(r

and thus it follows that

∗

)1/2d = Cdσ(r(T )) ≤ Cdσ(r(s0)),

min(−∆ϕ − 1, ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ)(x0, t0) ≤ 0,

28

KATY CRAIG, INWON KIM, AND YAO YAO

which concludes the proof.

(cid:3)

The rest of the proof of Theorem 3.7 parallels [1, Theorem 2.7], so we omit the proof.

We begin with the following lemma which states that ρm converges to ρ∞ weakly even if ρm
m−1 p0)1/(m−1), instead of requiring the initial data of ρm to coincide with the

3.2. Convergence of (P)m to (P)∞. In this section, we show that, as m → +∞, viscosity
solutions pm of (P)m approach a solution p of (P)∞ and use this to show that patch solutions
to the congested aggregation equation satisfy ρ∞ = χΩ(t) almost everywhere, where Ω(t) =
{p(·, t) > 0}.
has initial data ( m
initial data of ρ∞, as proved in Theorem 2.22.
Lemma 3.10. Let Ω0 ⊆ Rd be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) be
the gradient ﬂow of E∞ with initial data ρ0 = χΩ0. Let ρm be the weak solution of (PME-
m−1 p0)1/(m−1), where p0 is as in (1.9). Then for any t ≥ 0 and any
D)m with initial data ( m
f ∈ C(Rd), we have
lim
m→∞

ρ∞(x, t)f (x)dx

ρm(x, t)f (x)dx =

(3.10)

(cid:90)

(cid:90)

for all t ≥ 0.

Rd

Rd

Proof. We will ﬁrst prove (3.10) for all f ∈ C(Rd) ∩ L∞(Rd), and at the end of the proof we

will extend it to all (possibly unbounded) continuous functions.

Let ˜ρm be the weak solution of (PME-D)m with initial data χΩ0. Theorem 2.22 then yields
that limm→∞ W2(˜ρm(t), ρ∞(t)) = 0 for any t > 0. By [2, Remark 7.1.11 and Remark 5.1.2],
convergence in W2 distance implies that

(cid:90)

(cid:90)

(3.11)

lim
m→∞

Rd

˜ρm(x, t)f (x)dx =

Rd

ρ∞(x, t)f (x)dx

To relate ˜ρm with ρm, note that they are both weak solutions to (PME-D)m, with diﬀerent

m−1 p0)1/(m−1) respectively. Since ( m

(Rd).

∞
for all f ∈ C(Rd) ∩ L
m−1 p0)1/(m−1) → χΩ0 pointwise as

initial data χΩ0 and ( m
m → +∞, we have

(cid:13)(cid:13)(cid:13)(cid:16) m

p0

m − 1

lim
m→∞

(cid:17)1/(m−1)
(cid:13)(cid:13)(cid:13)(cid:16) m

− χΩ0

= 0

(cid:13)(cid:13)(cid:13)L1(Rd)
(cid:17)1/(m−1)

(cid:13)(cid:13)(cid:13)L1(Rd)

.

− χΩ0

by dominated convergence theorem. Also, recall that for any m > 1 and t ≥ 0, the L1
contraction result in Lemma 3.4 gives

(cid:107)˜ρm(·, t) − ρm(·, t)(cid:107)L1(Rd) ≤

p0

m − 1

(cid:90)

Combining the above two equations yields limm→∞ (cid:107)˜ρm(·, t) − ρm(·, t)(cid:107)L1(Rd) = 0, hence
(3.12)

(Rd).

lim
m→∞

(˜ρm(x, t) − ρm(x, t))f (x)dx = 0

Rd

∞
for all f ∈ L

Putting (3.11) and (3.12) together gives us (3.10) for all f ∈ C(Rd) ∩ L∞(Rd). To remove
the requirement f ∈ L∞(Rd), recall that Lemma 3.4 gives that ˜ρm(·, t) is supported in some
bounded set B(0, R(t)) for all m, and as a result ρ∞(·, t) is supported in it too. If f ∈ C(Rd)
is unbounded, we can simply set ˜f = f η, where η is a smooth cut-oﬀ function that is 1 in
B(0, R(t)) and 0 outside of B(0, R(t) + 1). We then have (3.10) holds for ˜f . Since changing ˜f
(cid:3)
to f will not change the integrals in (3.10), we know (3.10) holds for f too.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

29

We begin our study of the limit of solutions of (P)m with the following result, which shows

that the half relaxed “limit inﬁmum” of solutions of (P)m is a supersolution of (P)∞.
Proposition 3.11. Suppose pm(x, t) is a viscosity solution of (P)m with initial data pm(·, 0) =
p0 as given in (1.9). Then the half relaxed limit

(3.13)

u2(x, t) := lim inf

∗

pm(x, t) = lim
n→+∞

inf
m>n

|(x,t)−(y,s)|<1/n

pm(y, s)

is a viscosity supersolution of (P)∞.
Proof. First, note that u2 is lower semicontinuous. Next, suppose that u2 − ϕ has a local
minimum zero at (x0, t0) with respect to Rd∩{t ≤ t0}. By subtracting δ(x−x0)2+δ(t0−t) from
ϕ with δ > 0 suﬃciently small, we may assume that u2−ϕ has a strict minimum at (x0, t0) with
respect to a parabolic neighborhood Q of (x0, t0). Deﬁne (xm, tm) := argminQ pm − ϕ, Cm :=
pm(xm, tm)− ϕ(xm, tm), and ϕm := ϕ + Cm, so pm − ϕm has a local minimum zero at (xm, tm).
As in [1, Theorem 3.4] (see paragraph A.2), up to a subsequence, we have (xm, tm) → (x0, t0),
limm→+∞ pm(xm, tm) = lim inf∗ pm(x0, t0) = u2(x0, t0), and (xm, tm) ∈ {pm > 0}. Since pm is
a viscosity supersolution of (P)m,

(3.14)

(ϕt − (m − 1)pm(∆ϕ + ∆Φ1/m) − ∇ϕ · (∇ϕ + ∇Φ1/m))(xm, tm) ≥ 0

for all m.

First, consider the case when u2(x0, t0) > 0, and assume −∆ϕ(x0, t0) < 1 for the sake of
contradiction. Since ϕ ∈ C2,1(Q), we have ϕt−∇ϕ·(∇ϕ+∇Φ1/m)|(xm,tm) is uniformly bounded
for all m. Hence if we can show that

m→∞ pm(xm, tm)(cid:0)∆ϕ(xm, tm) + ∆Φ1/m(xm, tm)(cid:1) > c > 0

lim sup

(3.15)

for some positive c, it would imply that the left hand side of (3.14) goes to −∞ along a
subsequence of m → ∞, contradicting (3.14). Let us take a subsequence of m → +∞ such
that (xm, tm) → (x0, t0) and pm(xm, tm) > 1
2 u2(x0, t0) > 0 for all terms in this subsequence.
(We still denote this subsequence by m for notational simplicity.) Since limm→∞ ∆ϕ(xm, tm) =
∆ϕ(x0, t0) > −1, to show (3.34), it suﬃces to show that ∆Φ1/m(xm, tm) = 1 for all suﬃciently
large m in this subsequence. Since (xm, tm) minimizes pm − ϕ in Q, combining this with
pm(xm, tm) > 1
4 u2(x0, t0) > 0 for all (x, t) ∈ Q∩ Br0(xm, tm),
where r0 > 0 is a suﬃciently small constant only depending on u2(x0, t0) and (cid:107)ϕ(cid:107)C1,1(Q). Also,
note that we have Br0/2(x0, t0) ⊆ Br0(xm, tm) for suﬃciently large m due to the fact that
(xm, tm) → (x0, t0). In other words, for all suﬃciently large m, we have

2 u2(x0, t0) yields that pm(x, t) > 1

ρm(x, t) =

pm(x, t)

1

m−1
=: c
2

for all (x, t) ∈ Q ∩ Br0/2(x0, t0).

(cid:19) 1

m−1

(cid:18) u2(x0, t0)

(cid:19) 1

m−1

≥

8

(cid:18) m

m − 1
m−1
2

1

Since limm→∞ c
= 1, combining the above inequality with the weak convergence of ρm
towards ρ∞ in Lemma 3.10 yields that ρ∞(x, t) ≥ 1 almost everywhere in Q ∩ Br0/2(x0, t0)
(indeed, we must have ρ∞ = 1 in this set since ρ∞ ≤ 1 by deﬁnition), hence

for all suﬃciently large m in this subsequence, which yields (3.34) and thus contradicts (3.14).

∆Φ1/m(xm, tm) = ψ1/m ∗ ρ∞(xm, tm) = 1

30

KATY CRAIG, INWON KIM, AND YAO YAO

Now, we consider the case when (x0, t0) ∈ ∂{u2 > 0}, u2(x0, t0) = 0 and ϕ satisﬁes (5.2).

For a given small a > 0, let us consider a (second-order) perturbed version of ϕ,
˜ϕ(x, t) := ϕ(x, t) − a(x − x0) · ν − aC((x − x0)T )2 + M ((x − x0) · ν)2.

Here ν = Dϕ(x0, t0) (cid:54)= 0, (x − x0)T = (x − x0) − [(x − x0) · ν]ν, C = max|D2ϕ|. We choose M
suﬃciently large so that

(3.16)

∆ ˜ϕ(x0, t0) > 0.

Note that in a small neighborhood of (x0, t0) that depends on a and M , ˜ϕ ≤ max[ϕ, 0]. Thus

˜ϕ still touches u2 from below at (x0, t0). We will show that, for any choice of a > 0,

( ˜ϕt − |∇ ˜ϕ|2 − ∇ ˜ϕ · ∇Φ)(x0, t0) ≥ 0,

which yields the desired conclusion for ϕ.

Assume, for the sake of contradiction, that there is c0 > 0 so

(3.17)

˜ϕt − |∇ ˜ϕ|2 − ∇ ˜ϕ · ∇Φ(x0, t0) < −c0 < 0.

Let (xm, tm) chosen as before but with ˜ϕ instead of ϕ. First, suppose pm(xm, tm) > 0 for

suﬃciently large m. Then (3.14) and (3.16)-(3.17) yields a contradiction.

Lastly suppose (xm, tm) (cid:54)∈ {pm > 0} for m suﬃciently large. Since (xm, tm) ∈ {pm > 0}, up
to a subsequence, we have (xm, tm) ∈ ∂{pm > 0}. This contradicts [1, Lemma 3.3]. (Though
the proof of this lemma in [1] only considers the time independent case, it continues to hold
in our setting.)
(cid:3)

Next we proceed to show that taking a “limit supremum” of pm yields a subsolution of (P).
Here we need to be a bit careful, due to the fact that subsolution property is based on maximum
points only in the support of the subsolution. (See Deﬁnition 5.1.) Indeed, due to the nature
of one-phase problem it is not possible to perturb a smooth test function ϕ to create a strict
maximum of u1 − ϕ without restricting the domain to {u1 > 0}. This can create technical
diﬃculties with arguments along the lines of above proof to ensure that the local maximum
points are stable under the limit m → ∞, especially when the support of pm degenerates as
m → ∞. To overcome this obstacle, we work with a modiﬁed notion of viscosity subsolutions,
which are comprised of a pair (u, Σ). This allows the set evolution Σ to be larger than the
support of u. (See Deﬁnition 5.1 for details.)

Proposition 3.12. Suppose pm(x, t) is a viscosity solution of (P)m. Deﬁne
S(t) := ∩M≥1(∪m>M{pm(·, t) > 0}), Σ1 := ∪t>0(˚S(t) × {t})

(3.18)

Then if u1 is the half-relaxed limit of pm,

∗

u1(x, t) :=

lim sup pm(x, t) = lim
n→+∞

sup
m>n

|(x,t)−(y,s)|<1/n

pm(y, s),

(u1, Σ1) is a viscosity subsolution of (P)∞.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

31

Proof. Since u1 is upper semicontinuous and ˚S(t) is open, it remains to check properties (a)-
(b) of Deﬁnition 5.1. By deﬁnition, S(t)c ⊆ {u1(·, t) = 0}, hence {u1(·, t) > 0}˚⊆ ˚S(t).
By [1, Theorem B.1], for all t0 > 0,

if (x0, t0) ∈ Σ1 then (x0, t0) ∈ (Σ1 ∩ {t ≥ t0})˚

(3.19)
In particular, we have, Σ ∩ {t ≤ t0} ⊆ Σ ∩ {t < t0} for all t0 > 0.
Now we turn to property (b). Let u−ϕ have a local maximum zero at (x0, t0) in Σ1∩{t ≤ t0}.
First we consider part (i), where either (x0, t0) ∈ Σ1 or u1(x0, t0) > 0. By adding δ(x − x0)2 +
δ(t0 − t) to ϕ with δ > 0 suﬃciently small, we may assume there is a parabolic neighborhood
Q of (x0, t0) so that u1 − ϕ has a strict maximum with respect to Q ∩ Σ1 ∩ {t ≤ t0} = Q ∩ Σ1.
First, note that if suﬃces to consider the case when u1(x0, t0) > 0. In particular, if (x0, t0) ∈
Σ1, then by (3.19), we may assume that Q is suﬃciently small so that Q ⊆ Σ1. This implies
u1(x0, t0) > 0, since otherwise ϕ(·, t0) has a local minimum zero at x0, contradicting the fact
that it is superharmonic. Likewise, we may assume that u1 − ϕ has a strict maximum zero at
c
(x0, t0) with respect to Q, since ϕ(x0, t0) = u1(x0, t0) > 0 and u1 = 0 in (Σ1)

.

We now show that

(3.20) − ∆ϕ(x0, t0) ≤ f (x0) for any f ∈ C(Rd) such that f ≥ ρ∞(·, t0) almost everywhere.
In particular, this implies that −∆ϕ(x0, t0) ≤ 1, which gives the result. Suppose for the sake
of contradiction that −∆ϕ(x0, t0) > f (x0) for some f .
Let (xm, tm) := argmaxQ pm − ˜ϕ, Cm := pm(xm, tm) − ˜ϕ(xm, tm), and ˜ϕm := ˜ϕ + Cm,
so pm − ˜ϕm has a maximum zero at (xm, tm) with respect to Q. As in [1, Theorem 3.4] (see
paragraph A.2), up to a subsequence, we have (xm, tm) → (x0, t0) ∈ Q, limm→+∞ pm(xm, tm) =
∗
lim sup

pm(x0, t0) = u1(x0, t0) > 0. Since pm is a viscosity subsolution of (P)m,
(ϕt − (m − 1)pm(∆ϕ + ∆Φ1/m) − ∇ϕ · (∇ϕ + ∇Φ1/m))(xm, tm) ≤ 0.

(3.21)
Because ∆Φ1/m = ψ1/m ∗ ρ∞ ≤ f + o(1) and −∆ϕ(x0, t0) > f (x0), we have

(∆ϕ + ∆Φ1/m)(xm, tm) < 0

for suﬃciently large m, which is a contradiction.

Now we consider part (ii), where (x0, t0) ∈ ∂Σ1, u1(x0, t0) = 0, and |∇ϕ|(x0, t0) (cid:54)= 0.

Suppose, for the sake of contradiction, that

(3.22)
We can now apply parallel argument as in the proof of Theorem 3.4 in [AKY] to conclude. (cid:3)

− ∆ϕ(x0, t0) > 1 and (ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ)(x0, t0) > 0.

We now show that the initial data of the half-relaxed limits coincides with the initial data
given in equation (1.9). Speciﬁcally, this ensures that the initial data of u1 and u2 coincides
with the initial data of the sequence pm, in spite of the time regularization inherent in the
deﬁnitions of these half-relaxed limits. In what follows, we make frequent use of the following
inner and outer approximations:

(3.23)

Ω

−r := {x : d(x, Ωc) > r} and Ωr := {x : d(x, Ω) < r}.

Lemma 3.13. Consider a bounded domain Ω0 ⊆ Rd with the“no-crack” property ˚Ω0 = Ω0.

Suppose pm are viscosity solutions of (P)m with initial data p0 as given in (1.9). Then, for the
half-relaxed limits u1 and u2, we have u1(x, 0) = u2(x, 0) = p0(x).

32

KATY CRAIG, INWON KIM, AND YAO YAO

Proof. 1. We begin by proving the following claim on the support of pm for given ε > 0:

There is Tε > 0 such that Ω

(3.24)
We begin by showing {pm(·, t) > 0} ⊆ Ωε
of m. Suppose x0 ∈ (Ωε

Let us deﬁne

(cid:16)

−ε
0 ⊆ {ui(·, t) > 0} ⊆ Ωε

0 for all t ∈ [0, Tε] and i = 1, 2.

0)c, so that pm = 0 in Bε(x0) for all m.

0 for 0 ≤ t ≤ tε for some tε ∈ (0, 1) that is independent

φ(x, t) =

N (x − x0) − |x − x0|2

2d

+ f (t)

,

+

(cid:17)

where f is an increasing function which we will determine momentarily. Let f (0) = −N (ε) +
C1 + 1, where C1 > 0 is such that pm(·, t) ≤ C1 for all m and t ∈ [0, 1], given by Lemma 3.4(b).
Such choice of f guarantees that φ(x, 0) ≥ C1 ≥ pm(x, 0) in {ε ≤ |x − x0| ≤ 1} (hence
φ(·, 0) ≥ pm(·, 0) in B1(x0)), and φ(x, t) ≥ C1 ≥ pm(x, t) on ∂B1(x0) for all t ∈ [0, 1].

We claim that if we let f (t) increase suﬃciently fast, φ would be a classical supersolution
of (P)m for all m in B1(x0) × [0, tε] for some tε > 0. Note that at time t, φ(·, t) has support
{r(t) ≤ |x − x0| ≤ 1}, where r(t) ∈ (0, 1) solves N (r(t)) − r(t)2
2d + f (t) = 0, hence it satisﬁes
−1 is the inverse function of N ). By deﬁnition, ∆φ = −1
r(t) > N
in its support. Thus in order to make φ a classical supersolution of (P)m, all we need is
φt ≥ |∇φ|(|∇φ| +|∇Φ1/m|) everywhere in its support. In the support of φ, we have φt = f(cid:48)(t),
and |∇φ| ≤ N

−1(−f (t) + 1)) + 1. Finally, let

−1(−f (t) + 1) > 0. (Here N

(cid:48)(r(t)) + 1 ≤ N
(cid:48)

−1(−f (t) + 1)) + 1 + Cd)2,

(N

(cid:48)(N
(t) = (N

(cid:48)

f

Similarly we show Ω

where Cd is the bound for |∇Φ1/m| as in (2.8). The standard ODE theory guarantees that
f is ﬁnite in some [0, tε] (where tε > 0 depends on ε, C1 and d), hence r(t) > 0 in [0, tε].
By comparing pm with φ in the domain B1(x0) × [0, tε] and using the deﬁnition of viscosity
solutions, we conclude that pm = 0 in Br(t)(x0) for t ∈ [0, tε]. In particular, x0 ∈ {pm(·, t) > 0}c
for all m and all t ∈ [0, tε], and since x0 ∈ (Ωε

0)c was arbitrary, this gives the result.

−ε
0 ⊆ {pm(·, t) > 0} for small times by constructing a classical subsolu-
tion of (P)m. Suppose y0 ∈ Ω
m in
Br(t)(y0), with hm(·, t) = 0 on ∂Br(t)(y0). Here r(t) := ε − M t, and M is a large constant to
be determined later. Note that hm takes the explicit expression hm(x, t) :=
,
thus |∇hm(·, t)| ≤ r(t)/dm in its support. So the following holds in the support of hm:

−ε
(cid:16) r(t)2−|x−y0|2
(cid:17)
0 , so that Bε(y0) ⊆ Ω0. Let hm(x, t) solve −∆hm(·, t) = 1
(cid:19)
(cid:18) r(t)
(cid:18) r(t)

(m − 1)hm(∆hm + ∆Φ1/m) + ∇hm · (∇hm + ∇Φ1/m) ≥ −

r(t)
dm

(cid:19)

+ Cd

dm

2dm

+

m − 1
m
r(t)2
2dm −

hm −
r(t)
dm

≥ −

+ Cd

,

dm

where Cd is the bound for (cid:107)∇Φ1/m(cid:107) by (2.8), and we also used ∆Φ1/m ≥ 0 in the ﬁrst inequality.
Since (hm)t = r(t)r(cid:48)(t)/dm in its support, in order for hm to be a classical subsolution of (P)m,
all we need is r(cid:48)
≤ −r/2−(r+(cid:107)∇Φ1/m(cid:107)∞), so we can simply let r(t) = ε−M t with M = 1+Cd.
Since pm(·, 0) ≥ hm(·, 0) for all m > 1, comparison principle yields that pm ≥ hm for 0 ≤
2M . It follows that pm ≥ hm ≥ ε2
t ≤ ε
2M ]. Even though this lower
bound of pm is not uniformly positive in m, we can still conclude that lim inf m→∞ ρm ≥ 1 in
m−1 pm)1/(m−1). Given the weak convergence of ρm to ρ∞ in Lemma
Σε by deﬁnition of ρm = ( m

16dm in Σε := Bε/4(y0) × [0, ε

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

33

3.10, we have that ρ∞ = 1 almost everywhere in Σε. This implies that ∆Φ1/m = ρ∞∗ ψ1/m ≡ 1
in Bε/8(y0) × [0, ε

2M ] for all suﬃciently large m (more precisely, for all m > 8/ε).

With this information on ∆Φ1/m, we can now deﬁne a new subsolution ϕ(x, t) that solves
−∆ϕ = 1 in B˜r(t)(y0), with ϕ(·, t) = 0 on ∂B˜r(t)(y0), where ˜r(t) = ε/8− M t, and M = 1 + Cd.
One can check that ϕ is a classical subsolution of (P)m, hence pm ≥ ϕ ≥ cε for some cε > 0
(that is independent of m) in Bε/32 × [0, Tε] for all suﬃciently large m, where Tε := ε
16M ,
yielding (3.24).

2. To show that u1(·, 0) = u2(·, 0) = p0, we construct our ﬁrst barrier as follows: suppose

hε(x) solves

By (3.24), S(t) ⊆ Ωε/2 for t ∈ [0, ˜Tε] for some ˜Tε > 0. Thus, u1 ≤ hε in S(t). Furthermore,
since u1 = 0 in (S(t))c, we conclude that

−∆hε = 1 + ε in Ωε,

hε = 0 on ∂Ωε.

Next, comparison of pm with the classical subsolution ϕ given above yields that

(3.25)

(3.26)

u1(·, t) ≤ hε in Ωε × [0, ˜Tε].
−ε × [0, Tε].
−ε,

pm ≥ cε in Ω

g = cε on ∂Ω

−ε.

−∆g = 1 − ε in Ω

Now we construct our second barrier using (3.26). Consider g(x) solving

Since u2 is a supersolution of (P)∞ and (3.24) ensures that Ω−ε ⊆ {u2 > 0} for t ∈ [0, Tε], we
have −∆u2 ≥ 1 in Ω−ε × [0, Tε]. Furthermore, (3.26) ensures that g ≤ u2 on ∂Ω−ε × [0, Tε].

Therefore,

(3.27)

g ≤ u2 in Ω

−ε × [0, Tε].

Combining inequalities (3.25) and (3.27) and sending ε → 0, we can conclude.
We now show our main convergence theorem.

(cid:3)

Theorem 3.14. Let Ω0 ⊆ Rd be a bounded domain with Lipschitz boundary, and let pm solve
(P)m with initial data p0 as given in (1.9). Let ρm be the density variable corresponding to
pm, and let U be the unique maximal solution of (P)∞ with initial data p0, i.e.

U (x, t) := (inf{w : w is a viscosity supersolution of (P)∞ with w(·, 0) ≥ p0})∗.

Then the following holds for each t > 0:
(a) ρ∞(·, t) = χ{u1(·,t)>0} = χ{u2(·,t)>0} = χ{U (·,t)>0} almost everywhere;
(b) Let Ω(t) := {u2(·, t) > 0}, and Ω1(t) := {u1(·, t) > 0}. Then for every t ≥ 0, Ω(t) is
an open set with |∂Ω(t)| = 0, and we also have |∂Ω1(t)| = 0;
(c) ρm converges to 1 uniformly in Ω(t) away from its boundary—that is, the conver-
gence is uniform in any compact set Q ⊆ {(x, t) : x ∈ Ω(t)}. Furthermore, we have
limm→∞ (cid:107)ρm(·, t) − χΩ(t)(cid:107)L1(Rd) = 0 for every t ≥ 0.

Remark 3.15. The fact that U is a solution of (P)∞ is a consequence of a standard Perron’s
method argument.

34

KATY CRAIG, INWON KIM, AND YAO YAO

0

1/n
0

Proof. 1. To begin with, let us deﬁne two families of functions that are approximations of
and
m be the
0
m the corresponding density

pm. For n ∈ N, let pn,−
Ω
viscosity solution to (P)m with initial data pn,−
function. We let pn,+

(x) be solutions to (1.9) with Ω0 replaced by Ω
. We then let pn,−

(as deﬁned in (3.23)) respectively. Note that pn,−

0 ≺ p0 ≺ pn,+
, and denote by ρn,−

(x) and pn,+

m solve a modiﬁed version of (P)m with an extra source term, namely
pt = (m − 1)p(∆p + ∆Φ1/m) + ∇p · (∇p + ∇Φ1/m) + pfn,

−1/n
0

0

0

where

fn := χΩn−Ω, Ω := {u2 > 0} and Ωn := {(x, t) : d((x, t), Ω) ≤
m the corresponding density function. Finally we let (un,−

and denote by ρn,+
denote the corresponding half-relaxed limits for pn,−

m and pn,+
m .

1

1
n},
, Sn,−(t)) and un,+

2

The motivation of these two family of functions is as follows: in step 2, we will show that

for any n ∈ N,

un,−
1 ≤ U ≤ u2 ≤ u1 ≤ un,+

2

(3.28)
and it turns out that in order to show the last inequality we have to let pn,+
m solve the equation
with the extra source term, rather than (P)m. In step 3, we will use L1 contraction result
between ρn,−
(3.29)

An(t) :=(cid:12)(cid:12)supp un,+

m to show that for any t ≥ 0,

(cid:12)(cid:12) → 0 as n → ∞,

(·, t) \ supp un,−

m and ρn,+

(·, t)

2

1

and by combining it with (3.28) we have that U , u1 and u2 are supported on the same set.

2. In this step we aim to prove (3.28). The second inequality is a direct consequence from
the minimality of U and the fact that u2 is supersolution of (P)∞ with initial data p0 (which
follows from Proposition 3.11 and Lemma 3.13). The third inequality immediately follows from
the deﬁnition of the half relaxed limits u2 and u1. As for the ﬁrst inequality, note that by
Proposition 3.12, (un,−
, Sn,−(t)) is a subsolution of (P)m. (Proposition 3.12 does not require
via the same
the initial data be the same as p0.)
argument as in Lemma 3.13. Since pn,−
1 with
Proposition 3.11 and the comparison principle in Theorem 3.7 yields

In addition, we have un,−
0 ≺ p0, combining the above discussion on un,−

(·, 0) = pn,−

1

0

1

(3.30)

un,−
1 ≺ u2 with Sn,−

1

(t) ⊆ {u2(·, t) > 0},

which gives us the ﬁrst inequality.

direct consequence of the comparison principle for (P)∞, since we do not know that un,+
supersolution of (P)∞ due to the fact that pn,+
the initial data must be the same as p0.)

The last inequality of (3.28) is more diﬃcult to obtain. We point out that this is not a
is a
m (·, 0) (cid:54)= p0. (In order to apply Proposition 3.11,
are sub- and supersolutions of
another free boundary problem, for which the comparison principle also holds. From the
proof (in particular (3.20)) of Proposition 3.12, it follows that in addition to (u1, S(t)) being a
viscosity subsolution of (P)∞, u1 satisﬁes

To overcome this diﬃculty, we will show that u1 and un,+

2

2

(3.31)

− ∆u1(·, t) ≤ ρ∞

in the integral sense. On the other hand, parallel arguments as in Proposition 3.11 yield
that un,+
satisﬁes supersolution properties of (P)∞(see Deﬁnition 5.2), but with the interior

2

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

35

operator −∆ − 1 replaced by −∆ − ρ∞. In particular we have
2 ≥ ρ∞ in {un,+
2 > 0}
(3.32)
in the integral sense. As a result, (u1, S(t)) and un,+
supersolutions of

− ∆un,+

2

 −∆p(·, t) = ρ∞

V = −ν · (Dp + DΨ)
Ψ = N ∗ ρ∞.

in
on

{p > 0};
∂{p > 0};

( ˜P )∞

(3.33)

are respectively viscosity sub- and

Using this fact, one can modify the proof of comparison principle for (P)∞ to show that, for
any n ∈ N,

u1 ≺ un,+

2 with S1(t) ⊆ {un,+

2

(·, t) > 0}.

The proof of (3.33) is parallel to that of Theorem 2.7 in [1] with the only diﬀerence lies
showing the second inequality in the interior operator which we discuss below. Let us give a
heuristic sketch of the proof under the assumption that S(t) and {un,+
(·, t) > 0} have smooth
boundaries: the actual proof is carried out with regularizations as given in (3.7)-(3.8) which
generate strict subsolution and supersolution of ( ˜P )∞. As usual in the proof of comparison
principle, we begin with the scenario that u1 crosses un,+
from below at some time and yield
a contradiction. More precisely we suppose that the ﬁrst crossing time is ﬁnite, i.e.
(·, t) > 0} for s ≤ t} < ∞.

t0 := sup{t : u1(·, s) ≺ un,+

(·, s) and S(t) ⊆ {un,+

Note that t0 > 0 since S(0) = Ω0 = {u1(·, 0) > 0} due to Lemma 3.13 and u1 ≺ un,+

at
t = 0 from the construction. Observe also that (3.31)-(3.32) rules out the possibility that the
crossing occurs at an interior point, i.e.,

2

2

2

2

2

2

u1(·, t) < un,+
2 > 0}.

(·, t) in {u1(·, t) > 0}

Hence this means that the set S(t) touches the boundary of {un,+

as long as {u1(·, t) > 0} ⊆ S(t) ⊆ {un,+
at some point (x0, t0). Then the normal velocity law for the sets S(t) and {un,+
well as the fact that u1(·, t0) ≤ un,+
than that of un,+
Based on this fact, the rest of the proof is the same as to that of Theorem 2.7 in [1].

(·, t) > 0} for the ﬁrst time
(·, t) > 0}, as
Note that (3.32) and the deﬁnition of Ωn ensures that the source term for u1 remains smaller
after the regularization process given in (3.7)-(3.8) if r(t) is suﬃciently small.

(·, t0) yields a contradiction.

2

2

2

2

3. Next we will show (3.29). First, note that ρn,−
ρn,+
m satisﬁes (3.1) with source term ρn,+
also ordered, comparison principle for (3.1) yields that ρn,−
m (x, t) − ρn,−
(ρn,+

m(t) :=

(cid:90)

An

m ≤ ρn,+
m (x, t))dx,

m satisﬁes (3.1) with no source term, while
m fn which is non-negative. Since their initial data is

m . We then deﬁne

which is nonnegative. We can apply the L1 contraction property of (3.1) in Lemma 3.3 to
conclude that, for any t > 0 and any m > 1,

(3.34)

An
m(t) ≤

m (x, s)fn(x, s)dxds + An
ρn,+

m(0).

(cid:90) t

(cid:90)

0

36

KATY CRAIG, INWON KIM, AND YAO YAO

By (3.30) and the deﬁnition of Sn,−
(3.35)

supp ρn,−

1

, for all t ≥ 0 and suﬃciently large m, we have

m (t) ⊆ supp u2(t) =: Ω(t).

Thus for all suﬃciently large m, the spatial integral in (3.34) can be controlled as

(cid:90)

m (t) = supp pn,−
(cid:90)

ρn,+
m (x, s)fn(x, s)dx =

Ωn(s)\Ω(s)

m(s),

m (x, s)dx ≤ An
ρn,+
(cid:82) t

where in the last step we used that ρn,−
from (3.35). Plugging this into (3.34) yields An
inequality immediately yields that An
|Ω

| ≤ C/n, which yields lim inf m→∞ An
m(t) ≥ |supp un,+

1/n
0
Next we claim

m (x, s) ≡ 0 in Ωn(s)\ Ω(s) for all large m, which follows
m(0), thus Gronwall’s
m(t) ≤ An
m(0) =

m(0)et. It is easy to check that limm→∞ An

m(t) ≤
m(t) ≤ Cet/n for all n ∈ N, t ≥ 0.
(·, t) \ supp un,−

m(s)ds + An

m→∞ An
lim inf

(·, t)|.

−1/n
0

0 An

\ Ω

2

1

To show this, it suﬃces to show that
(3.36)

(cid:90)

(cid:90)

lim inf
m→∞

m (x, t)dx ≥ |supp un,+
ρn,+

(·, t)|.
For the ﬁrst inequality, note that by deﬁnition of the half-relaxed limit, for any x ∈ supp un,+
we have lim inf m→∞ pn,+

m (x, t) > 0, thus lim inf m→∞ ρn,+

(·, t)| and lim sup
m→∞

m (x, t)dx ≤ |supp un,−
ρn,−

2

2

1

(·, t),

m (x, t) ≥ 1. Therefore

(cid:90)

m→∞ ρn,+
lim inf

m (x, t)dx ≥ |supp un,+

2

(·, t)|,

and applying Fatou’s lemma to it yields the ﬁrst inequality of (3.36). The second inequality fol-
lows from the deﬁnition of the half-relaxed limit un,−
m (cid:107)∞ ≤
1, which is due to (3.4).
We now combine the above claim with lim inf m→∞ An
m(t) ≤ Cet/n to conclude that the
An(t) deﬁned in (3.29) satisﬁes An(t) ≤ Cet/n for all n ∈ N, t ≥ 0, which yields (3.29).
Applying this to (3.28) then yields that χ{u1>0} = χ{u2>0} = χ{U >0} almost everywhere. So
the proof of part (a) would be ﬁnished if we can show ρ∞ is also equal to these functions almost
everywhere, which we postpone to step 4.

and the fact that lim supm→∞ (cid:107)ρn,−

1

At the end of step 3, let us point out part (b) can be easily proved using the above bound
on An(t): note that Ω(t) = {u2(·, t) > 0} is open due to the lower-semicontinuity of u2, hence

∂Ω(t) = Ω(t) \ Ω(t) ⊆ supp un,+

2

(·, t) \ supp un,−

1

(·, t),

where we used (3.28), (3.30) and (3.33) in the last inequality. The above bound on An(t) thus

gives |∂Ω(t)| ≤ An(t) ≤ Cet/n for all n ∈ N, t ≥ 0, and by sending n → ∞ we obtain part (b)
for Ω(t). In addition, the inequalities (3.28), (3.30) and (3.33) also lead to |∂Ω1(t)| ≤ An(t),
hence we also have |∂Ω1(t)| = 0.

4. To ﬁnish the proof of part (a), it suﬃces to relate u2 and ρ∞ and show that

(3.37)

ρ∞ = χ{u2>0} a.e.

The direction ρ∞ ≥ χ{u2>0} is easier: take any (x0, t0) such that a := u2(x0, t0) > 0.
By deﬁnition of the half-relaxed limit u2, there exists some positive r0 and N0, such that
pm(x, t0) ≥ a/2 > 0 for all x ∈ Br0(x0), m > N0. Hence ρm(x, t0) ≥ ( m−1
m a)1/(m−1) for x, m as
above. Combining this lower bound (which approaches 1 as m → ∞) with the weak convergence

(cid:90)

(cid:90)

(cid:90)

(cid:90)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

37

of ρm towards ρ∞ in Lemma 3.10, we have ρ∞(·, t0) ≥ 1 in Br0(x0). Since x0 ∈ {u2(·, t0) > 0}
is arbitrary, we have ρ∞ ≥ χ{u2>0}.
m . Using the deﬁnition of Sn,−(t) (see (3.18)) as well
as (3.28), we have

For the other direction, we will use pn,−

(3.38)

m→∞ χ{pn,−
lim sup

m (·,t)>0} = χSn,−(t) ≤ χ{u2(·,t)>0}

for any n ∈ N, t ≥ 0.

(3.39)

In addition, since lim supm→∞ (cid:107)ρn,−

lim sup

m→∞ ρn,−

m (·, t) ≤ lim sup

Finally we will relate ρ∞ with ρn,−

m (t)(cid:107)∞ ≤ lim supm→∞ (cid:107)ρm(t)(cid:107)∞ ≤ 1 by (3.4), it implies
m→∞ χ{ρn,−
m . Note that for any continuous, bounded f ≥ 0, we have

m (·,t)>0} = lim sup

m→∞ χ{pn,−

m (·,t)>0}.

the following (where we omit the x dependence in integrals due to space limitation):

(3.40)

ρ∞(t)f dx = lim
m→∞

ρm(t)f dx = lim

m→∞ lim
n→∞

ρn,−
m (t)f dx ≤

m,n→∞ ρn,−

lim sup

m (t)f dx,

ﬁnishes the proof of (3.37), thus yielding part (a).

where the ﬁrst equality follows from Lemma 3.10, the second one is due to the L1 contraction
property of Lemma 3.3(a) and the fact that ρn,−
m ≤ ρm, and the last inequality follows from
Fatou’s lemma. This implies that
ρ∞(·, t) ≤ lim supm,n→∞ ρn,−
m (·, t) a.e., and this with (3.38)-(3.39) implies ρ∞ ≤ χ{u2>0}, which
5. To prove part (c), take any compact set Q ⊆ {(x, t) : x ∈ Ω(t)}. By deﬁnition of the
half-relaxed limit u2, for each (x0, t0) ∈ Q there is some r0 > 0, such that pm ≥ u(x0, t0)/2
in Br0(x0, t0) for all suﬃciently large m, which yields that ρm uniformly approaches 1 in
Br0(x0, t0). The compactness of Q then allows us to ﬁnd a ﬁnite number of points (xi, ti) such
that Bri(xi, ti) covers Q, implying that ρm → 1 uniformly in Q.

Finally let us prove the L1 convergence result, where we use the elementary inequality

Let f = ρm(·, t), g = χΩ(t) = ρ∞(·, t). Since the mass of ρm(·, t) and ρ∞(·, t) are both preserved
in time, we have

(cid:90)
(cid:90)
(cid:12)(cid:12)(cid:12)(cid:12) ≤ (cid:107)ρm(·, 0) − χΩ0(cid:107)L1 =

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)
(cid:12)(cid:12)(cid:12)(cid:12) .
(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)
(cid:13)(cid:13)L1 → 0 as m → ∞.
To control(cid:82) (g − f )+dx, note that g = 0 a.e. in Ω(t)c, hence(cid:82) (g − f )+dx =(cid:82)
We can then apply the uniform convergence result of ρm in D to conclude that(cid:82) (g−f )+dx ≤ 2ε
for suﬃciently large m, and since ε > 0 is arbitrary we have limm→∞(cid:82) (g−f )+dx = 0. Plugging

Ω(t)(1 − ρm)+dx.
Since Ω(t) is open, for any ε > 0 we can ﬁnd a compact set D ⊆ Ω(t), such that |Ω(t)\ D| ≤ ε.

p0)1/(m−1) − χΩ0

(f − g)+dx ≤ 2

the above results into (3.41) yields the L1 convergence result.

(g − f )+dx +

(g − f )+dx +

(cid:107)f − g(cid:107)L1 =

m
m − 1

(f − g)dx

(f − g)dx

(cid:13)(cid:13)(

(3.41)

(cid:90)

(cid:3)

4. Long time behavior of patch solutions in two dimensions

In this section, we investigate the long-time behavior of a patch solution ρ∞ in two dimen-
sions, using the pressure variable characterization of the dynamics of ρ∞ obtained in section 3.
Throughout this section, we consider our spatial domain to be R2. By Theorem 3.14, we know
that ρ∞(·, t) = χΩ(t) for some Ω(t) ⊆ R2 for all t ≥ 0. Our goal is to show that, as t → ∞,

38

KATY CRAIG, INWON KIM, AND YAO YAO

Ω(t) converges to the unique disk B0 with the same mass and the center of mass as Ω0. (See
Theorem 4.12)

We proceed as follows: in sections 4.1 and 4.2, we show that the second moment of ρ∞(·, t) =
χΩ(t) decreases unless Ω(t) is a disk, from which we are able to conclude that Ω(t) cannot stay
uniformly away from a disk for all times, in terms of its Fraenkel asymmetry. In section 4.3,
we combine this with the gradient ﬂow structure of ρ∞ to show that as t → +∞ the energy
E∞(ρ∞(t)) approaches the minimum of E∞, with a quantitative estimate on the rate. Lastly,
in section 4.4, we show that ρ∞(·, t) converges to χB0 strongly in Lq for any 1 ≤ q < ∞.

4.1. Evolution of the second moment. Let M2[f ] := (cid:82)

R2 f (x)|x|2dx denote the second
moment of f .
In this subsection, we investigate the evolution of the second moment of
ρ∞(·, t) = χΩ(t). Before we present the rigorous derivation of the evolution of the second
moment, we begin with the following heuristic computation. As described in the introduction,
ρ∞(·, t) formally satisﬁes the transport equation

ρt = ∇ · (ρ(∇Nρ + ∇p)),

where p is a solution to (P). (See equation (1.8).) By deﬁnition, p(·, t) solves ∆p = −1 in Ω(t)
and p = 0 on ∂Ω(t). Hence, supposing that ∂Ω(t) is smooth, the evolution of M2[ρ∞(t)] is
given by

d
dt

(4.1)

(cid:90)
(cid:90)
(cid:90)

R2

= −

M2[ρ∞(t)] = −2
1
π
1
2π
1
2π|Ω(t)|2 + 4

= −

= −

R2

R2

R2

(cid:90)

(cid:90)
ρ∞∇Nρ∞ · xdx − 2
(cid:90)

ρ∞(x)ρ∞(y)

R2

R2

ρ∞∇p · xdx
(cid:90)
(x − y) · x
|x − y|2 dydx − 2

(cid:90)

Ω(t) ∇p · xdx

ρ∞(x)ρ∞(y)dydx + 4

p(x)dx

Ω(t)

p(x)dx = −

1
2π|Ω0|2 + 4

Ω(t)

(cid:90)

p(x)dx.

Ω(t)

(cid:90)

In the second equality, we use that, in two dimensions, Nρ∞ = N ∗ ρ∞ with N (x) = 1
2π log |x|.
In the third equality, we symmetrize x and y in the ﬁrst integral (hence the extra factor of 1
2 ),
and in the last equality, we use that ρ∞ preserves its mass (which is |Ω0|) for all time.
In the following proposition, we rigorously obtain the time evolution of M2[ρ∞(t)] by an-
alyzing the evolution of the second moments for each ρm and sending m → +∞, using our
convergence results from the previous sections. We show that the evolution of the second mo-
ment indeed satisﬁes a time-integral form of (4.1), with the exception that we must substitute
p(x) with u1(x), the half-relaxed limit of pm deﬁned in Lemma 3.12, to take into account the
fact that Ω(t) may not have smooth boundary for all time.

Proposition 4.1. Let Ω0 ⊆ R2 be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) =
χΩ(t) be the gradient ﬂow of E∞ with initial data ρ0 = χΩ0. Then for any T > 0,

(4.2)

M2[ρ∞(T )] − M2[ρ0] ≤ −

1
2π|Ω0|2T + 4

u1(x, t)dxdt,

0

Ω(t)

where u1 is the half-relaxed limit of pm, deﬁned in Lemma 3.12, and Ω(t) = {u2(·, t) > 0}, as
deﬁned in Theorem 3.14 (b).

(cid:90) T

(cid:90)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

39

m p0)1/(m−1),
m be the corresponding solution of (P)m.

(cid:90)
(cid:124)

Proof. For any m > 1, let ρm be the weak solution of (PME-D)m with initial data ( m−1
m−1 ρm−1
where p0 is given by equation (1.9). Let pm := m
Taking |x|2 as our test function, we have for any T > 0,
(cid:123)(cid:122)
(cid:125)
ρm(x, 0)|x|2dx
(4.3)
(cid:125)

(cid:125)
ρm(x, T )|x|2dx

ρm∇Φ1/m(x, t) · xdxdt

(cid:123)(cid:122)
(cid:90) T
(cid:124)

(cid:90) T
(cid:124)

ρm
m(x, t)dxdt

= −2

(cid:90)
(cid:124)

(cid:123)(cid:122)

(cid:123)(cid:122)

(cid:90)

(cid:90)

(cid:125)

−

+4

=:I1

=:I2

R2

0

R2

0

R2

R2

.

=:I4

(Since ρm has compact support in [0, T ], our test function is not required to have compact
support since we can always take a cut-oﬀ suﬃciently far away.) As m → +∞, Lemma 3.10
yields that I1 converges to M2[ρ∞(T )] and I2 converges to M2[ρ∞(0)].

To show the convergence of I3, we decompose the integral into two parts:

=:I3

(cid:90) T

(cid:90)

(cid:90) T

(cid:90)

(cid:90) T

|I32| ≤

0 (cid:107)ρm(·, t)|x|(cid:107)L2(cid:107)∇Φ1/m − ∇Φ(cid:107)L2(R2)dt → 0 as m → +∞,

where the fact that supt∈[0,T ] supm≥1 (cid:107)ρm(·, t)|x|(cid:107)L2 < +∞ is a consequence of Lemma 3.4,
which ensures ρm is uniformly bounded and compactly supported. Combining the estimates
on I31 and I32 yields that I3 → 1
4π|Ω0|2T as m → +∞.
(cid:90) T
(cid:90)
(cid:90) T

Finally, we consider I4. We will show that

(cid:90)

(4.5)

lim sup
m→∞

0

R2

ρm
m(x, t)dxdt ≤

u1(x, t)dxdt.

0

Ω(t)

The proof is then ﬁnished by taking lim supm→+∞ on both sides of (4.3).

To show (4.5), ﬁrst note that, since pm := m

m , we may write ρm

m = m−1

m ρmpm and

apply Remark 3.5 to obtain

(cid:90) T

(cid:90)

m−1 ρm−1
(cid:90) T

(cid:90)

(4.6)

lim sup
m→∞

0

R2

ρm
m(x, t)dxdt ≤ lim sup
m→∞

pm(x, t)dxdt.

0

R2

I3 =

0

R2

ρm∇Φ(x, t) · xdxdt +

0

R2

ρm∇(Φ1/m(x, t) − Φ(x, t)) · xdxdt =: I31 + I32.

Since ∇Φ(x, t) · x ∈ C(Rd) for any t, Lemma 3.10 again gives that
ρ∞dx

I31

ρ∞∇Φ(x, t) · xdxdt =

R2

m→+∞
−−−−−→

1
4π

R2

0

0

(cid:90) T

(cid:18)(cid:90)

(cid:90) T

(cid:90)

(cid:19)2

dt =

1
4π|Ω0|2T,

where the last two equalities are obtained by symmetrizing x and y in the integrand and using
conservation of mass, as in equation (4.1).

To control I32, we ﬁrst bound (cid:107)∇Φ1/m − ∇Φ(cid:107)L2(R2). By Proposition 2.3,

(4.4)

(cid:107)∇Φ1/m − ∇Φ(cid:107)L2(R2) ≤ W2(ρ∞ ∗ ψ1/m, ρ∞) ≤
where, in the last step, we apply [2, Lemma 7.1.10]. Hence

ψ(x)|x|2dx,

(cid:90)

1
m

Note that u1,n is decreasing in n and lim
have pm ≤ u1,n for all m > n, hence

(cid:90) T

(cid:90)

(cid:90) T

(cid:90)

n→∞ u1,n = u1 by deﬁnition of u1. For each n ∈ N, we

KATY CRAIG, INWON KIM, AND YAO YAO

40

It remains to show that

(4.7)

For any n ∈ N, deﬁne

(cid:90) T

(cid:90)

lim sup
m→∞

0

R2

pm(x, t)dxdt ≤

u1,n(x, t) :=

sup
m>n

|(x,t)−(y,s)|<1/n

(cid:90) T

(cid:90)

u1(x, t)dxdt.

0

R2

pm(y, s).

lim sup
m→∞

0

R2

pm(x, t)dxdt ≤

u1,n(x, t)dxdt

0

R2

for all n ∈ N.

(cid:90)

We can then take n → +∞ in the above inequality and apply the monotone convergence
theorem. By Theroem 3.14 (a), Ω(t) = {u1(·, t) > 0} almost everywhere. Thus, inequality
(cid:3)
(4.7) holds.

4.2. Some rearrangement inequalities. In this subsection, we digress a bit to obtain an
upper bound for the quantity

(4.8)

F (Ω) = −

1
2π|Ω|2 + 4

p(x)dx,

Ω

where Ω is a bounded set with smooth boundary and p : ¯Ω → R satisﬁes −∆p = 1 in Ω and
p = 0 on ∂Ω. This quantity appears in our heuristic computation for the evolution of the
second moment of ρ∞(t), where we show d
0 F (Ω(t))dt would
have appeared on the right hand side of our rigorous result, given in equation (4.2), if the
boundary of Ω(t) were smooth for all time. While in this subsection we only aim to control
F (Ω) for smooth domains, in the next subsection we discuss how to use this bound to control
the right hand side of (4.2), even when the boundary of Ω(t) is not smooth.

dt M2[ρ∞] ≤ F (Ω(t)). Likewise,(cid:82) T

The following result, due to Talenti [51], shows that F (Ω) ≤ 0, with equality if and only
In the subsequent

if Ω is a disk. We sketch the proof below for the sake of completeness.
proposition, we will modify the proof to get a stronger inequality.

Proposition 4.2 (c.f. [51, Theorem 1]). Let Ω ⊆ R2 be a bounded domain with smooth bound-

ary, and let F (Ω) be as in (4.8). Then we have

(4.9)

F (Ω) ≤ 0,
and the equality is achieved if and only if Ω is a disk.
Proof. First, note that maximum principle yields that p ≥ 0 in ¯Ω and p > 0 in Ω. For any
k ∈ [0, supΩ p), let us deﬁne

Note that g(0) = |Ω|. By deﬁnition of p and the divergence theorem, we have
(4.10)

g(k) =

Ωk := {x ∈ Ω : p(x) > k}

(cid:90)
Ωk −∆p(x)dx =
(cid:90) ∞

(cid:90)

(cid:90)
∂Ωk −n · ∇p dσ =
(cid:90)

and g(k) := |Ωk|.

(cid:90)
∂Ωk |∇p|dσ.

On the other hand, by the co-area formula (c.f. [22]),
(cid:48)

(4.11)

g(k) =

k

∂Ωs

dσds,

1
|∇p|

g

(k) = −

∂Ωk

dσ.

1
|∇p|

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

41

Combining (4.10) and (4.11) and applying the Cauchy-Schwarz inequality,

(cid:19)(cid:18)

(cid:90)

(cid:19)

−

∂Ωk

dσ

1
|∇p|

≤ −P (Ωk)2,

where P (Ωk) is the perimeter of Ωk. For any bounded domain E ⊆ R2, the isoperimetric

(4.12)

(cid:48)

g(k)g

(k) =

inequality yields

(4.13)

(cid:18)(cid:90)
∂Ωk |∇p|dσ
(cid:112)
(cid:16)

2√π

(k) ≤ −

|E| ≤ P (E).

(cid:112)

(cid:17)2
(cid:18)

(cid:90) ∞

= −4πg(k),

(cid:19)

Applying inequality (4.13) to Ωk in (4.12) gives
2√π

g(k)g

(cid:48)

g(k)

hence g(k) satisﬁes the diﬀerential inequality

(cid:90)

(cid:48)

g

(cid:90) supΩ p

(4.14)

(k) ≤ −4π for all k ∈

0, sup
Ω

g

.

Combining this with g(0) = |Ω| yields that g(k) ≤ (|Ω| − 4πk)+ for all k ≥ 0. Therefore,

p(x)dx =

Ω

0

g(k)dk ≤

0

(|Ω| − 4πk)+ dk =

1
8π|Ω|2,

which gives (4.9). In order to achieve equality, Ωk must be a disk for almost every k > 0, hence
(cid:3)
Ω must be a disk.

We now prove a stronger version of the above inequality by replacing the isoperimetric
inequality in the above argument (see (4.13)) by the following quantitative version due to
Fusco, Maggi, and Pratelli [26].

Lemma 4.3 (c.f. [26, Section 1.2]). Let E ⊆ R2 be a bounded domain. We deﬁne the Fraenkel
asymmetry A(E) ∈ [0, 1] as

(cid:26)

A(E) := inf

|E(cid:52)(x0 + rB)|

|E|

(cid:112)

P (E) ≥ 2√π

|E|

(cid:27)
: x0 ∈ R2, πr2 = |E|
(cid:0)1 + cA(E)2(cid:1) ,

,

where B is the unit disk. Then there is some constant c ∈ (0, 1), depending only on the
dimension, such that

where P (E) = H1(∂E) denotes the perimeter of E.

We begin with the following simple observation regarding the Fraenkel asymmetry.

Lemma 4.4. Let E ⊆ R2 be a bounded domain. For all U ⊆ E satisfying |U| ≥ |E|(1− A(E)

4

we have

),

Proof. Assume the statement is not true, so there exists some disk BU with the same area as
U so that

A(U ) ≥

A(E)

4

.

|U(cid:52)BU|

|U|

<

A(E)

4

.

42

KATY CRAIG, INWON KIM, AND YAO YAO

Since |U| = |BU|, we have |U(cid:52)BU| = 2(|U| − |U ∩ BU|). Hence the above inequality becomes

(cid:19)

A(E)

8

(cid:18)
(cid:19)(cid:18)

1 −

.

(cid:19)

|U ∩ BU| > |U|

(cid:18)

(cid:18)

(cid:19)

A(E)

4

A(E)

8

1 −

≥ |E|

1 −

3A(E)

8

Let BE be a disk with the same area as E that contains BU . Then since |U| ≥ |E|(1 − A(E)

4

),

|E ∩ BE| ≥ |U ∩ BU| > |E|

1 −

Therefore,

|E(cid:52)BE|

=

2(|E| − |E ∩ BE|)

<

3
4

A(E),

|E|

|E|

which contradicts the fact that A(E) ≤ |E(cid:52)BE|/|E|. This gives the result.

(cid:3)

With this lemma, we are now able to conclude a stronger upper bound on F (Ω) than provided

by Proposition 4.2.

Proposition 4.5. Under the same assumptions as Proposition 4.2, there exists a constant
c0 ∈ (0, 1), such that

F (Ω) ≤ −c0A(Ω)3|Ω|2.

Proof. We follow the proof of Proposition 4.2, with the following diﬀerence: instead of apply-
ing the isoperimetric inequality (4.13) to the set Ωk in inequality (4.12), we now apply the
quantitative version from Lemma 4.3 to obtain

(k) ≤ −4π(cid:0)1 + cA(Ωk)2(cid:1)2
(cid:18)

(cid:19)

≤ −4π(cid:0)1 + cA(Ωk)2(cid:1) .
(cid:18)

To relate A(Ωk) with A(Ω), we apply Lemma 4.4 to obtain that A(Ωk) ≥ A(Ω)
that g(k) ≥ |Ω|(1 − A(Ω)
(k) ≤ −4π

for all k such that g(k) ≥ |Ω|

). In other words, we have

cA(Ω)2

1 −

(4.15)

1 +

16

g

4

4

(cid:48)

for any k such

(cid:19)

.

A(Ω)

4

(cid:48)

g

We claim that this implies

(cid:18)

(cid:19)

(4.16)

g(k) ≤ |Ω| − 4π

1 +

cA(Ω)2

16

k

for all k ∈

0,

A(Ω)|Ω|

32π

4

4

To see this, note that for all k ∈ (0, A(Ω)|Ω|
32π ), the right hand side of (4.16) is greater than
) since 1+cA(Ω)2/16 ≤ 2. As a result, if (4.16) is violated at some k0 ∈ (0, A(Ω)|Ω|
|Ω|(1− A(Ω)
32π ),
then we must have g(k) ≥ |Ω|(1− A(Ω)
) for all k ∈ (0, k0), since g is a decreasing function. We
can then integrate (4.15) in (0, k0) to conclude that (4.16) actually holds at k0, a contradiction.
Let h(k) = (|Ω|−4πk)+. Inequality (4.16) implies that g(k) ≤ h(k)− cA(Ω)3|Ω|
at k = A(Ω)|Ω|
32π .
For k > A(Ω)|Ω|
32π , recall that by inequality (4.14), we have g(cid:48)(k) ≤ −4π for k ∈ (0, supΩ g), and
by deﬁnition of h, we have h(cid:48)(k) = −4π in (0,|Ω|/(4π)). This gives that g(k) ≤ h(k)− cA(Ω)3|Ω|
for A(Ω)|Ω|/32π ≤ k ≤ |Ω|/4π. Since A(Ω) ≤ 1 this range of k is larger than |Ω|/8π, and since
g(k) ≤ h(k) for all k, we have
g(k)dk ≤

cA(Ω)3|Ω|2

cA(Ω)3|Ω|2

h(k)dk −

(cid:90) ∞

(cid:90) ∞

= |Ω|2

8π −

2000

2000

128

128

.

0

0

(cid:18)

(cid:19)

.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

Finally, this gives

hence the result holds with c0 := c

0
2000 .

F (Ω) =

(cid:90) ∞

g(k) − |Ω|2
8π ≤

cA(Ω)3|Ω|2

2000

,

43

(cid:3)

4.3. Convergence of energy functional as t → ∞. In this section, we aim to show that,
along the solution ρ∞(·, t), the energy functional E∞ converges to its global minimizer as t →
+∞. We begin by estimating the rate of change of the second moment along ρ∞. Combining
Proposition 4.5 with our heuristic computation (4.1) suggests that

d
dt

M2[ρ∞(t)] ≤ −c0A(Ω(t))3|Ω0|2.

We now show that this inequality is indeed true in the time-integral sense, even if Ω(t) does
not have smooth boundary.

Proposition 4.6. Let Ω0 ⊆ R2 be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) =
χΩ(t) be the gradient ﬂow of E∞ with initial data ρ0 = χΩ0. Then we have

(cid:90) T

0

(4.17)

M2[ρ∞(T )] − M2[ρ0] ≤ −c0|Ω0|2

A(Ω(t))3dxdt,

(cid:90) T

0

(cid:90) T

(cid:90)

where c0 ∈ (0, 1) is the constant given in Proposition 4.5.
Proof. Since the evolution of the second moment is already given by Proposition 4.1, it remains
to show

(4.18)

u1(x, t)dxdt ≤ −c0|Ω0|2
where u1 is the half-relaxed limit of pm deﬁned in Lemma 3.12.

1
2π|Ω0|2T + 4

0

Ω(t)

−

A(Ω(t))3dt,

Let Ω1(t) = {u1(·, t) > 0}. By Theorem 3.14 (a) and (b), we have Ω1(t) = Ω(t) almost
everywhere, so A(Ω(t)) = A(Ω1(t)), and |∂Ω1(t)| = 0 for all t ∈ [0, T ]. Hence for any ε > 0
and t ∈ [0, T ], we can ﬁnd a set D(t) ⊆ R2 with smooth boundary such that Ω1(t) ⊆ D(t),
and |D(t) \ Ω1(t)| ≤ ε. For any t ≥ 0, we then have a classical solution p(·, t) such that
−∆p(·, t) = 1 in D(t), and p(·, t) = 0 on ∂D(t) and D(t)c. In addition, we may choose D(t)
so that ∂D(t) is continuous in time with respect of Hausdorﬀ distance of sets, which ensures
that p is continuous in time.
We ﬁrst aim to show that

u1(x, t) ≤ p(x, t).

(4.19)
It suﬃces to show that u1(x, t) ≤ ap(x, t) for any a > 1. Towards a contradiction, assume
that there exists some a > 0, such that supx∈R2,t∈[0,T ](u1 − ap) > 0. Since p is continuous in
both space and time, and u1 is upper semicontinuous by deﬁnition as the half-relaxed limit,
u1 − ap achieves a strictly positive maximum at some (x0, t0). Furthermore, since p ≥ 0,
we have u1(x0, t0) > 0. Again using that (u1, Σ1) is a subsolution of (P)∞, we have that
−a∆p(x0, t0) ≤ 1, which implies that −∆p(x0, t0) < 1. However, since x0 ∈ Ω1(t0) ⊆ D(t0),
we must have −∆p(x0, t0) = 1, which gives the contradiction.
We now show inequality (4.18). Since |D(t) \ Ω1(t)| ≤ ε, there exists C depending on
|Ω0| so that A(Ω1(t)) = A(Ω(t)) ≤ A(D(t)) + Cε. Combining this observation with (4.19)

44

KATY CRAIG, INWON KIM, AND YAO YAO

and Proposition 4.5, we obtain the following bound for the left hand side of (4.18), where C
depends on Ω0 and T :

(cid:32)

(cid:90) T

0

(cid:90)

−

1
(cid:90) T
2π|Ω0|2 +

(cid:33)

(cid:32)

(cid:90) T

(cid:90)

−

1
(cid:90) T
2π|D(t)|2 +

(cid:33)

u1(x, t)dx

dt ≤

0

Ω(t)

p(x, t)dx

dt + Cε

D(t)

log |x − y|dy

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) = π,
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)∞ ≤ π(cid:107)χΩ − χBΩ(cid:107)1.

≤ −c0

0

A(D(t))3|D(t)|2dt + Cε ≤ −c0|Ω0|2

0

A(Ω(t))3dt + Cε.

Sending ε → 0 gives the result.
Corollary 4.7. Under the assumptions of Proposition 4.6, for any T > 0, there exists some
t0 ∈ (0, T ), such that
(4.20)

where C(Ω0) :=(cid:0)M2[χΩ0]/c0|Ω0|2(cid:1)1/3, for c0 as in Proposition 4.5.

A(Ω(t0)) ≤ C(Ω0)T

By Proposition 4.6 and the deﬁnition of C(Ω0),

Proof. Fix T > 0. Towards a contradiction, assume A(Ω(t0)) > C(Ω0)T −1/3 for all t0 ∈ (0, T ).
−1/3)3 = 0,

A(Ω(t))3dxdt ≤ M2[ρ0] − c0|Ω0|2T (C(Ω0)T

M2[ρ∞(T )] ≤ M2[ρ0] − c0|Ω0|2

(cid:90) T

−1/3,

0

which contradicts with the fact that M2[ρ∞(t)] must be positive for all time.

(cid:3)

(cid:3)

The above corollary does not directly yield that limt→∞ A(Ω(t)) = 0. To show this and
conclude that Ω(t) converges to a disk, we will use the fact that the energy E∞ is decreasing
in time along ρ∞(·, t). In the next lemma, we show that if A(Ω) is small, then the energy is
close to its minimum.
Lemma 4.8. Let Ω ⊆ R2 be a bounded domain, and let BΩ ⊆ R2 be a disk with |BΩ| = |Ω|.

(cid:112)
0 ≤ E∞(χΩ) − E∞(χBΩ) ≤ 40|Ω|(1 + |Ω| + M2[χΩ])

Then,

A(Ω)

Proof. The ﬁrst inequality is a direct consequence of Riesz rearrangement inequality [35, The-
orem 3.7]. To prove the second one, let us ﬁrst rewrite E∞(χΩ) − E∞(χBΩ) as

(cid:90)(cid:90)

(χΩ(x) − χBΩ(x))(χΩ(y) + χBΩ(y)) log |x − y|dxdy

E∞(χΩ) − E∞(χBΩ) =

=:

1
2π
1
2π

R2×R2
1
2π

I1 +

I2,

where I1 and I2 denote the integral in the domains |x − y| ≤ 1 and |x − y| > 1, respectively.
(cid:90)
First, we consider I1. Note that for any x ∈ R2, we have

y∈B(x,1)

(χΩ(y) + χBΩ(y)) log |x − y|dy

|x−y|≤1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ 2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:90)

hence

I1 ≤ (cid:107)χΩ − χBΩ(cid:107)1

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
(cid:90)

y∈B(x,1)

(χΩ(y) + χBΩ(y)) log |x − y|dy

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

45

Now, we consider I2. For |x − y| > 1, log |x − y| ≤ |x − y| ≤ |x| + |y| ≤ (1 + |x|)(1 + |y|), so

(cid:19)(cid:18)(cid:90)

(cid:19)

(χΩ(y) + χBΩ(y))(1 + |y|)dy

(cid:18)(cid:90)

I2 ≤

R2 |χΩ(x) − χBΩ(x)|(1 + |x|)dx

(cid:18)(cid:90)
(cid:19)1/2
R2 |χΩ(x) − χBΩ(x)|(1 + |x|)2dx

(cid:18)(cid:90)
≤ (cid:107)χΩ − χΩB(cid:107)1/2
R2 |χΩ(y) + χBΩ(y)|(1 + |y|)2dy

R2

1

· (2|Ω|)1/2
≤ 2√2|Ω|1/2(cid:107)χΩ − χΩB(cid:107)1/2

1

(M2[χΩ] + M2[χBΩ] + 2|Ω|).

(cid:19)1/2

I1 +

1
2π

1
2π

I2 ≤ |Ω|1/2(cid:107)χΩ − χBΩ(cid:107)1/2

Combining the above estimates on I1 and I2 with the facts that (cid:107)χΩ − χBΩ(cid:107)1 ≤ 2|Ω| and
1/π ≤ 1, we have
(4.21)
E∞(χΩ) − E∞(χBΩ) ≤
The proof is then split into the following two cases: A(Ω) ≥ 1/2 and A(Ω) < 1/2.
Case 1: A(Ω) ≥ 1/2. In this case, we have (cid:107)χΩ − χBΩ(cid:107)1 ≤ 2|Ω| ≤ 4A(Ω)|Ω| for any disk BΩ
with the same measure as Ω. Since E∞ is invariant under translations, we can simply choose
(cid:112)
BΩ to be centered at 0. Such a choice directly yields M2[χBΩ] ≤ M2[χΩ], hence (4.21) becomes
E∞(χΩ)−E∞(χBΩ) ≤ |Ω|1/2(4A(Ω)|Ω|)1/2(1+2|Ω|+2M2[χΩ]) ≤ 4|Ω|(1+|Ω|+M2[χΩ])
A(Ω),
which gives the result.

(1 + M2[χΩ] + M2[χBΩ] + 2|Ω|).

1

Case 2: A(Ω) < 1/2. In this case, we choose BΩ to be the disk minimizing |Ω(cid:52)BΩ|, which

then gives

(4.22)

(cid:107)χΩ − χBΩ(cid:107)1 = A(Ω)|Ω|.

This choice of BΩ no longer directly gives us M2[χBΩ] ≤ M2[χΩ], but we claim that we still
have M2[χBΩ] ≤ 36M2[χΩ]. To see this, ﬁrst note that A(Ω) < 1/2 implies |BΩ \ Ω| < |BΩ|/2.
Also, a simple computation yields that for any x, y ∈ BΩ, we have |x|2 ≤ (|y| + |x − y|)2 ≤
2|y|2 + 2|x − y|2 ≤ 2|y|2 + 8|Ω|/π. Therefore,
(cid:19)
M2[χBΩ] =

(cid:90)
BΩ |x|2dx ≤ |BΩ| max

(cid:18)
(cid:90)
(cid:32)(cid:90) √|Ω|/π
2|y|2 +

x∈BΩ |x|2 ≤ 2|BΩ ∩ Ω| max

x∈BΩ |x|2 ≤ 2

8
π|Ω|

BΩ∩Ω

(cid:33)

(cid:19)

(cid:18)

dy

≤ 4M2[χΩ] +

16
π |Ω|2 ≤ 4M2[χΩ] + 32

|Ω|2
2π

≤ 4M2[χΩ] + 32

0

r2 · 2πrdr

Combining this and equation (4.22) with inequality (4.21) then yields

E∞(χΩ) − E∞(χBΩ) ≤ |Ω|(1 + 37M2[χΩ] + 2|Ω|)A(Ω)1/2,

which completes the proof.

Combining the above results, we are now able to show that, along the solution ρ∞(t), the

energy functional E∞ is converging towards its global minimizer with an explicit rate.

≤ 36M2[χΩ],

(cid:3)

46

KATY CRAIG, INWON KIM, AND YAO YAO

Theorem 4.9. Let Ω0 ⊆ R2 be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) =
χΩ(t) be the gradient ﬂow of E∞ with initial data ρ0 = χΩ0. Suppose B0 is a disk with the
same area as Ω0. Then, for any t > 0, we have

0 ≤ E∞(χΩ(t)) − E∞(χB0) ≤ C1(|Ω0|, M2[Ω0])t

−1/6,

where C1(|Ω0|, M2[Ω0]) = C2|Ω|2/3(|Ω0| + M2[Ω0])7/6 and C2 is a universal constant.
Proof. By Corollary 4.7, we have that, for any t > 0, there exists some t0 ∈ (0, t), so that

(cid:0)M2[χΩ0]/c0|Ω0|2(cid:1)1/3

−1/3.

t

(cid:112)
By deﬁnition of the discrete gradient ﬂow and the lower semicontinuity of E∞, E∞(ρ∞(t)) is
nonincreasing in time. Therefore, at time t, we may apply Lemma 4.8 to conclude
E∞(χΩ(t)) − E∞(χB0) ≤ E∞(χΩ(t0)) − E∞(χB0) ≤ 40|Ω(t0)|(1 + |Ω0| + M2[χΩ(t0)])

≤ 40|Ω0|(1 + |Ω0| + M2[χΩ0])(cid:0)M2[χΩ0]/c0|Ω0|2(cid:1)1/6

−1/6
t

A(Ω(t0))

A(Ω(t0)) ≤

≤ C2|Ω0|2/3(1 + |Ω0| + M2[Ω0])7/6t

−1/6.

(cid:3)

ε

Remark 4.10. While the rate in Theorem 4.9 is probably not optimal, the following example
shows that the optimal power cannot go beneath −1. For 0 < ε (cid:28) 1, let Ωε
0 = B(xε, ε) ∪
B(0, Rε), where xε := (ε−1, 0) ∈ R2, and Rε := √1 − ε2 is chosen such that |Ωε
0| = π. This
0] is uniformly bounded for all ε < 1. Since ∂r(N∗χB(0,1))(r) ∼ r−1
deﬁnition ensures that M2[Ωε
for r (cid:29) 1, the extra πε2 amount of mass will stay outside B(0, (2ε)−1) for all t ∈ [0, c1ε−2],
where c1 > 0 is independent of ε. During this time interval, the free energy is at least c2ε2| log ε|
greater than its global minimizer for some c2 > 0. Hence E∞(χΩε(Tε)) − E∞(χB(0,1)) (cid:38)
T −1
| log Tε| for Tε = c1ε−2, implying that the optimal power of t in Theorem 4.9 cannot
be less than −1.
4.4. Convergence of ρ∞(t) as t → ∞. We now conclude our study of asymptotic behavior
by showing that, as t → ∞, ρ∞(t) converges to χB0 in Lq for any 1 ≤ q < ∞, where B0 is the
disk with the same area and the center of mass as Ω0. We begin with the following lemma,
which ensures that the center of mass of ρ∞(t) is preserved for all time.
(cid:82)
R2 ρ∞(x, T )xdx =(cid:82)
Lemma 4.11. Let Ω0 ⊆ R2 be a bounded domain with Lipschitz boundary, and let ρ∞(·, t) =
χΩ(t) be the gradient ﬂow of E∞ with initial data ρ0 = χΩ0. Then for any T > 0, we have

R2 ρ∞(x, 0)xdx.

Proof. We proceed as in the proof of Proposition 4.1. For any m > 1, let ρm be the weak
solution of (PME-D)m with initial data ( m−1
m p0)1/(m−1), where p0 is as in equation 1.9. For
i = 1 or 2, we take our test function to be xi, the i-th component of x. Then, for any T > 0,

(cid:90)

R2

(cid:90)

(4.23)

(cid:90) T
(cid:90)
By Lemma 3.10, the left hand side of (4.23) converges to(cid:82)
(cid:90)(cid:90)

ρm(x, 0)xidx = −

ρm(x, T )xidx −

(cid:90)

(cid:90)

R2

0

lim
m→∞

R2

ρm∂iΦ1/m(x, t)dx =

R2

ρ∞∂iΦ(x, t)dx =

R2 ρ∞(x, 0)xidx
as m → ∞. The right hand side can be controlled in the same way as the term I3 in the proof
of Proposition 4.1, which gives

ρm∂iΦ1/m(x, t)dxdt.

R2
R2 ρ∞(x, T )xidx −

(cid:82)

1
2π

R2×R2

ρ∞(x)ρ∞(y)

xi − yi
|x − y|2 dxdy = 0.

Hence, sending m → ∞ in (4.23), we have (cid:82)

which ﬁnishes the proof.

R2 ρ∞(x, T )xidx =(cid:82)

R2 ρ∞(x, 0)xidx for i = 1, 2,
(cid:3)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

47

With this control on the center of mass of ρ∞(x, t) in hand, we now turn to the proof of the

main result.

be a disk such that |B0| = |Ω0| and (cid:82)

Theorem 4.12. Let Ω0 ⊆ R2 be a bounded domain with Lipschitz boundary, and let B0 ⊆ R2
xdx. Let ρ∞(·, t) = χΩ(t) be the gradient
ﬂow of E∞ with initial data χΩ0. Then for any 1 ≤ q < +∞, we have

xdx = (cid:82)

B0

Ω0

t→∞(cid:107)ρ∞(·, t) − χB0(cid:107)Lq(R2) = 0.
lim
(cid:90)

(cid:90)

Proof. We ﬁrst show that, for any f ∈ Cb(R2), the space of bounded, continuous functions,

ρ∞(x, t)f (x)dx =

lim
t→∞

(4.24)
R2
To show this, take any diverging time sequence (tn)∞
n=1. By Proposition 4.6, M2[ρ∞(tn)] is
uniformly bounded for all n. Hence by Prokhorov’s Theorem [2, Theorem 5.1.3], there exists
a subsequence (tnk )∞

χB0f (x)dx.

R2

(cid:90)
k=1 and µ ∈ L1

(cid:90)
+((1 + |x|)2dx) so that
ρ∞(x, tnk )f (x)dx =

R2

lim
k→∞

for all f ∈ Cb(R2). Choosing suitable test functions f , we have (cid:82) µdx = |Ω0| and (cid:107)µ(cid:107)∞ ≤

supt≥0 (cid:107)ρ∞(·, t)(cid:107)∞ = 1. In addition, by letting the test function f approach f (x) = x, we have
(4.25)

µ(x)f (x)dx

ρ∞(x, tnk )xdx =

µ(x)xdx.

(cid:90)

(cid:90)

R2

lim
k→∞

R2

R2

Since the energy functional E∞ is lower-semicontinuous with respect to weak-* convergence

of probability measures [20, Proposition 4.5], by Theorem 4.9,

E∞(µ) ≤ lim inf

k→∞ E∞(ρ∞(tnk )) = E∞(χB0).

As the only global minimizers of E∞ are translations of χB0, µ must equal some translation
of χB0 almost everywhere. Finally, recall that Lemma 4.11 and the deﬁnition of B0 give that

(cid:82)
R2 ρ∞(x, t)xdx =(cid:82) χΩ0xdx =(cid:82) χB0xdx for all time. Combining this with (4.25), we obtain
R2 µ(x)xdx =(cid:82) χB0xdx, leading to µ = χB0 a.e.. Thus, any diverging time sequence contains
(cid:82)
We now show that ρ∞(·, t) → χB0 in L1(R2). Since 0 ≤ ρ∞ ≤ 1, we have ρ∞ ≤ χB0 a.e. in
B0 and ρ∞ ≥ χB0 a.e. in Bc

a subsequence satisfying (4.24), so we conclude that (4.24) must hold.

0. Hence

(cid:90)

(cid:107)ρ∞(·, t) − χB0(cid:107)1 = 2

(χB0 − ρ∞(x, t))χB0dx.

R2

Thus, by choosing f ∈ Cb(R2) suﬃciently close to χB0 and applying (4.24), we can show that,
for any ε > 0, (cid:107)ρ∞(·, t) − χB0(cid:107)1 ≤ ε for suﬃciently large t. This shows that ρ∞(·, t) → χB0 in
L1(R2). Finally, for 1 < q < ∞, the convergence in Lq follows directly from the L1 convergence
(cid:3)
and the fact that (cid:107)ρ∞(·, t) − χB0(cid:107)∞ ≤ 1.

48

KATY CRAIG, INWON KIM, AND YAO YAO

5. Appendix

5.1. Deﬁnition of viscosity solutions of (P)∞. We begin by recalling some notation. For
Q ⊆ Rd × (0,∞), we write f ∈ C2,1(Q) if f is twice continuously diﬀerentiable in x and once
in t. We say that u− ϕ has a local maximum (minimum) zero (x0, t0) in Q if there exists ε > 0
such that

ϕ(x0, t0) = u(x0, t0) and ϕ ≥ u (ϕ ≤ u) in Q ∩ (Bε(x0) × (t0 − ε, t0 + ε)).

In other words, ϕ touches u from above (below) at (x0, t0) with respect to Q.

Likewise, given an open set Ω ⊆ Rd and a function h : Ω × [0, +∞) → R, we denote its

upper and lower semicontinuous envelopes by

(5.1)

h

∗

(x, t) := lim
ε→0

sup
|x−y|≤ε,
|t−s|≤ε

h(y, s),

h∗(x, t) := lim
ε→0

h(y, s).

inf

|x−y|≤ε,
|t−s|≤ε

Note that h∗ is the smallest upper semicontinuous function satisfying h ≤ h∗, and h∗ is the
largest lower semicontinuous function satisfying h ≥ h∗.
Now, we deﬁne the notion of viscosity subsolution, supersolution, and solution of (P)∞.
Instead of proceeding as above and deﬁning solutions of (P)∞ by comparison with classical
sub- and supersolutions, we follow an approach reminiscent of Kim [32] and Alexander, Kim,
and Yao [1]. While the former would ease our proof of the comparison theorem, Theorem 3.7,
the latter is more natural from the perspective of the convergence theorem, Theorem 3.14.
One notable diﬀerence in the deﬁnition below from those of Alexander, Kim, and Yao [1] is
the separation of the solution and the set evolution in our notion of subsolutions.

Deﬁnition 5.1 (subsolution of (P)∞). An upper semicontinuous function u : Rd × (0, +∞) →
[0, +∞), paired with a space-time set Σ = ∪t>0(Ω(t) × {t}), is a viscosity subsolution of (P)∞
if

(a) {u(·, t) > 0} ⊆ Ω(t) and Σ ∩ {t ≤ t0} ⊆ Σ ∩ {t < t0} for every t0 > 0;
(b) for all ϕ ∈ C2,1(Rd × (0, +∞)) so that u − ϕ has a local maximum zero at (x0, t0) in

Σ ∩ {t ≤ t0},
(i) if x0 ∈ Ω(t0)◦ or u(x0, t0) > 0, then −∆ϕ(x0, t0) ≤ 1;
(ii) if x0 ∈ ∂Ω(t0), u(x0, t0) = 0, and |∇ϕ|(x0, t0) (cid:54)= 0, then

min(−∆ϕ − 1, ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ)(x0, t0) ≤ 0.

addition,

We will say that u : Rd × [0, +∞) → [0, +∞) has compactly supported initial data u0 if, in
(c) u(·, 0) = u0(·) and {u0 > 0} = Σ ∩ {t = 0}.
We introduce the set Σ for technical reasons, to allow the possibility that u becomes zero in
the evolving set Ω(t). Condition (a) ensures that a subsolution does not jump up from zero.
Condition (b)(ii) ensures that limits of viscosity solutions are viscosity solutions, since it is
possible that the boundary collapses in a limit and boundary points of the limiting functions
become interior points of the limit.

Deﬁnition 5.2 (supersolution of (P)∞). A lower semicontinuous function v : Rd× (0, +∞) →
(0, +∞) is a viscosity supersolution of (P)∞ with initial data v0 if for all ϕ ∈ C2,1(Rd ×
(0, +∞)) so that v − ϕ has a local minimum zero at (x0, t0) with respect to Rd ∩ {t ≤ t0},

(i) if (x0, t0) ∈ {v > 0}, −∆ϕ(x0, t0) ≥ 1;

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

49

(ii) if (x0, t0) ∈ ∂{v > 0}, v(x0, t0) = 0,

(5.2)

|∇ϕ|(x0, t0) (cid:54)= 0, and {ϕ > 0} ∩ {v > 0} ∩ B (cid:54)= ∅ for some ball B centered at (x0, t0)
then max(−∆ϕ − 1, ϕt − |∇ϕ|2 − ∇ϕ · ∇Φ)(x0, t0) ≥ 0.

Will we say that v : Rd × [0, +∞) → (0, +∞) has initial data v0 if v(·, 0) = v0(·)

Condition (5.2) ensures that ϕ touches v from below in a non-degenerate way.

Deﬁnition 5.3. A lower semi-continuous function u is a viscosity solution of (P)∞ in Rd ×
(0,∞) with compactly supported initial data u0 if (u∗,{u > 0}) and u are respectively viscosity
sub- and supersolutions of (P)∞ with initial data u0.
The following lemma illustrates the fact that the solution of (P)∞ is entirely characterized

by its support.

Lemma 5.4. Suppose u is a viscosity solution of (P)∞ in Rd×(0,∞) and {u∗ > 0} = {u > 0}.
Then, for each t > 0, u(·, t) = (ht)∗, where

ht(x) = inf{α(x) : −∆α ≥ 1 in an open set E containing {u(·, t) > 0}; α ≥ 0 on E.}

Proof. By the deﬁnition of a viscosity supersolution, −∆u(·, t) ≥ 1 in {u(·, t) > 0}, so (ht)∗ ≤
u(·, t). On the other hand, by the deﬁnition of a viscosity subsolution, −∆u∗(·, t) ≤ 1 in Rd
and u∗(·, t) is supported in {u(·, t) > 0}. Therefore u∗(·, t) ≤ α for any candidate function α(x)
in the deﬁnition of ht, so u∗(·, t) ≤ (ht)∗. Consequently, we conclude that u(·, t) = (ht)∗.
(cid:3)

5.2. Further properties of gradient ﬂows of E∞, ˜E∞, and Em. In this section, we collect
several results on the gradient ﬂows of E∞, ˜E∞, and Em. We begin by proving Proposition
2.3, which provides elementary estimates on the Newtonian potential of a bounded, integrable
function. We use these estimates to conclude that E∞ is ω-convex along generalized geodesics.
(See [20, Theorem 4.3, Proposition 4.4].)

Proof of Proposition 2.3. The fourth inequality is a classical potential theory result (c.f. [17,
Proposition 2.1], [28, Lemma 2.1]), and the ﬁfth inequality is due to Loeper [39, Theorem 2.7].
(While Loeper only considers the case d ≥ 3, the same argument applies in d = 2.)

For the bounds on ∇Nρ and ∆Nρ, note that if B = B1(0),
(cid:107)∇Nρ(cid:107)∞ ≤ (cid:107)∇N(cid:107)L1(B)(cid:107)ρ(cid:107)∞ + (cid:107)∇N(cid:107)L∞(Bc)(cid:107)ρ(cid:107)1 ≤ Cd

Likewise, for the lower bound on(cid:82) Nρdρ, if we let N
(cid:90)

(cid:90)

Nρdµ ≥

−

N

∗ ρ(x)dµ(x) ≥ −(cid:107)N

∗ ρ(cid:107)∞ ≥ −(cid:107)N

−

and

(cid:107)∆Nρ(cid:107)∞ = (cid:107)ρ(cid:107)L∞ ≤ 1.
−(x) denote the negative part of N (x),
−
(cid:107)L1(B)(cid:107)ρ(cid:107)∞ − (cid:107)N
(cid:107)L∞(Bc)(cid:107)ρ(cid:107)1 ≥ −Cd.
(cid:3)

−

Next, we prove Proposition 2.5, which ensures that ρ∞ is Lipschitz in time, with respect to

the Wasserstein metric.
Proof of Proposition 2.5. By [20, Theorem 3.11], the function S(t) : D(E∞) → D(E∞) :
ρ∞(·, 0) (cid:55)→ ρ∞(·, t) is a semigroup, i.e. S(t + s) = S(t)S(s)µ for t, s ≥ 0. Therefore, it
suﬃces to show that W2(ρ∞(t), ρ∞(0)) ≤ 2Cdt for all t ≥ 0.

50

KATY CRAIG, INWON KIM, AND YAO YAO

Let ρn

τ be the discrete gradient ﬂow of E∞ with initial data ρ = ρ∞(0) and time step τ > 0,
as deﬁned by equation (i). By [20, Theorem 3.8], if we take τ = t/n for any t ≥ 0, then
limn→+∞ W2(ρn

t/n, ρ∞(t)) = 0. Therefore,

W2(ρ∞(t), ρ∞(0)) = lim

n→+∞ W2(ρn

t/n, ρ) ≤ lim
n→+∞

W2(ρi

t/n, ρi−1

where the last inequality follows from Lemma 2.14, which ensures W2(ρi

t/n ) ≤ 2Cdt,
t/n, ρi−1

t/n ) ≤ 2Cd(t/n).
(cid:3)

n(cid:88)

i=1

We now turn to the proof of Proposition 2.6, which concerns the regularity of ∇Nρ∞(x, t)

in space and time.
Proof of Proposition 2.6. The fact that ∇Nρ∞(x, t) is log-Lipschitz in space is an immediate
consequence of Proposition 2.3. We now consider the continuity with respect to time. By
Proposition 2.5, ρ∞ is Lipschitz in time with respect to the Wasserstein metric, so it suﬃces
to translate this into continuity in time with respect to the Euclidean norm.
Fix ψ ∈ C∞
c (Rd) so that supp ψ ⊆ B1(0) and (cid:107)ψ(cid:107)∞ ≤ 1, and let Φ(x, t) = Nρ∞(x, t) and
Φ1/m := Φ ∗ ψ1/m. Combining the ﬁfth inequality in Proposition 2.3 with Proposition 2.5,
|∇Φ1/m(x, t) − ∇Φ1/m(x, s)| = |ψ1/m ∗ (∇Nρ(x, t) − ∇Nρ(x, s))|

≤ (cid:107)ψ1/m(cid:107)L2(Rd)(cid:107)∇Nρ∞(t) − ∇Nρ∞(s)(cid:107)L2(Rd) ≤ md/2W2(ρ∞(t), ρ∞(s)) ≤ 2Cdmd/2|t − s|.
We now use this inequality controlling the continuity in time of ∇Φ1/m(x, t) to estimate the

continuity in time of ∇Φ(x, t). By Proposition 2.3,
|∇Φ(x, t) − ∇Φ1/m(x, t)| =

(∇Φ(x, t) − ∇Φ(x − y, t)) ψ1/m(y)dy

(cid:90)

(cid:12)(cid:12)(cid:12)(cid:12) ≤ Cd

σ(|y|)ψ1/m(y)dy

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)

(cid:90)

ψ1/m(y)dy = Cdσ(1/m).

≤ Cdσ(1/m)

Therefore,

|∇Φ(x, t) − ∇Φ(x, s)|

≤ |∇Φ(x, t) − ∇Φ1/m(x, t)| + |∇Φ1/m(x, t) − ∇Φ1/m(y, t)| + |∇Φ1/m(y, t) − ∇Φ(y, t)|
≤ 2Cdσ(1/m) + 2Cdmd/2|t − s|.
Let p = 1/2d. Since |t − s| < e(−1−√
2)/2, if we choose m = |t − s|(−2/d)(1−p) ≥ 1, we have
md/2|t−s| = |t−s|p, which takes care of the second term in the above inequality. Furthermore,
q = 1/(2(2 − 1/d)) < 1/2 ensures | log(x)| ≤ x−1/2 ≤ xq−1 for 0 ≤ x ≤ 1. Therefore,
if 1/m < e(−1−√
if 1/m ≥ e(−1−√

≤ 3(1/m)q = 3|t − s|(2q/d)(1−p) = 3|t − s|p.

(1/m)q
3/m

σ(1/m) ≤

(cid:40)

(cid:41)

2)/2

2)/2

Therefore, |∇Φ(x, t) − ∇Φ(x, s)| ≤ 10Cd|t − s|1/2d, which gives the result.

(cid:3)

In the next proposition, we show that, while the discrete time sequence corresponding to
˜E∞ may not be unique, the distance between any two such sequences converges to zero as the
time step τ → 0.

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

51

Proposition 5.5. Fix T > 0 and initial data ρ ∈ D(E∞) and let ˜ρn
τ be two choices for
the time discrete time sequence corresponding to ˜E∞, as deﬁned in Deﬁnition 2.12 (ii). Then
there exist positive constants N and C, depending on the dimension, T , and E∞(ρ), so that
for τ = t/n and all 0 ≤ t ≤ T and n > N ,
(W 2

τ and ˜µn

2 (˜ρn

τ , ˜µn

f (2n)
τ

τ )) ≤ Cω(τ ).

Proof. By Corollary 2.15, we have the following crude bound for all i = 1, . . . , n,

W2(˜ρi

τ , ˜µi

τ ) ≤ W2(˜ρi

τ , ρ) + W2(˜µi

τ , ρ) ≤ 4CdT.

τ as a minimizer

To obtain a more reﬁned bound, we use Proposition 2.8. First, we estimate the behavior of
the energy ˜E∞ along the discrete time sequence. By Proposition 2.3, Lemma 2.14, and the
deﬁnition of ˜ρi
˜E∞(˜ρi−1
; ρi
τ )
= ˜E∞(˜ρi−1
; ρi−1
; ρi−1
≤ ˜E∞(˜ρi−2

τ ) − ˜E∞(˜ρi−1
; ρi−1
; ρi
τ , ρi−1
) ≤ ˜E∞(˜ρi−2

) + ˜E∞(˜ρi−1
) + CdW2(ρi

) = ˜E∞(˜ρi−1

τ − ρi−1

τ ) + 2C2

τ d(ρi

) + 2C2

; ρi−1

(cid:90)

d T.

)

τ

τ

τ

τ

τ

τ

τ

τ

τ

τ

τ

τ

Likewise, we may control the ﬁrst term on the right hand side by

τ

τ

) +

; ρi−1

N˜ρi−1
d τ ≤ ··· ≤ ˜E∞(ρ; ρ1
(cid:90)

˜E∞(ρ; ρ1

τ ) = 2E∞(ρ) + ˜E∞(ρ; ρ1

τ ) − ˜E∞(ρ; ρ) = 2E∞(ρ) +

Nρd(ρ1

τ − ρ) ≤ 2E∞(ρ) + 2C2
d τ.

Thus, there exists C > 0 (which we allow to change from line to line) depending only on the
dimension, T , and E∞(ρ) so that

˜E∞(˜ρi−1

τ

; ρi

τ ) ≤ C.

Likewise, by Proposition 2.3, ˜E∞(·;·) is uniformly bounded below by −Cd.
Due to these estimates, we may apply Proposition 2.8 to conclude that there exist positive
constants C and N depending on the dimension, T , and E∞(ρ) so that for τ = t/n, 0 ≤ t ≤ T ,
and n > N ,

(W 2
f (2)
2 (˜ρi
τ
2 (˜ρi−1
≤ W 2

τ

τ , ˜µi
τ ))
, ˜µi−1

τ

) + Cdτ ω(CW2(˜µi

τ , ˜µi−1

τ

)) + 2τ ( ˜E∞(˜ρi−1

τ

τ ) − ˜E∞(˜ρi
; ρi

τ ; ρi

τ )) + Cτ 2.

By Lemma 2.14 (ii), we may bound the second term by Cdτ ω(Cτ ) and the third term by
4C2

d τ 2. Therefore, for all i = 1, . . . , n,
τ , ˜µi

2 (˜ρi

(W 2

f (2)
τ

(5.3)

τ )) ≤ W 2

2 (˜ρi−1

τ

, ˜µi−1

τ

) + Cτ ω(τ ).

We now show that, for all j = 1, . . . , n,

(5.4)

f (2j)
τ

(W 2

2 (˜ρn

τ , ˜µn

τ )) ≤ W 2

2 (˜ρn−j

τ

, ˜µn−j

τ

) + 2Cτ ω(τ )j.

Once we have this, taking j = n gives the result. We prove (5.4) by induction. The base case,
when j = 1, is a consequence of (5.3). Suppose that the result holds for j − 1,
) + 2Cτ ω(τ )(j − 1).

τ )) ≤ W 2

2 (˜ρn−j+1

f (2(j−1))

, ˜µn−j+1

τ , ˜µn

2 (˜ρn

(W 2

τ

τ

τ

52

KATY CRAIG, INWON KIM, AND YAO YAO

(2)
By Proposition 2.7, applying f
τ

f (2j)
τ

(W 2

2 (˜ρn

τ , ˜µn

to both sides,
2 (˜ρn−j+1
(W 2
2 (˜ρn−j, ˜µn−j) + 2Cτ ω(τ )j

, ˜µn−j+1

τ

τ

τ

τ )) ≤ f (2)
≤ W 2

)) + 2Cτ ω(τ )(j − 1) + Cτ 2

where the second inequality is a consequence of (5.3) and the fact that Cτ 2 ≤ Cτ ω(τ ). This
(cid:3)
gives the result.

Now, we turn to the proof that the discrete time sequence ρn

τ,m corresponding to Em con-

verges to the solution of (PME-D)m as the time step goes to zero.
Proposition 5.6. Given initial data ρ ∈ D(E∞), let ρn
τ,m be the discrete time sequence given
in Deﬁnition 2.12 (iii). Then, for any t ≥ 0, ρn
t/n,m converges as n → +∞ to a limit ρm(t),
and there exist positive constants C and N depending on the dimension, E∞(ρ), and T so that
for all n ≥ N , m ≥ d + 1, and 0 ≤ t ≤ T ,

W2(ρn

t/n,m, ρm(t)) ≤ Cn

−1/16e4CdT

.

Furthermore, ρm(t) is the unique weak solution of (PME-D)m.
Proof. Given initial data ρ ∈ D(E∞), let ρn
2.12 (i). Using this sequence, we deﬁne a time dependent energy En
Rd ψ1/m ∗ Nρn

Rd ν(x)mdx +(cid:82)
(cid:82)

τ,m(ν) := Em(ν; ρn

τ ) =

En

τ,m by

τ (x)dν(x)

τ be the discrete gradient ﬂow of E∞, as in Deﬁnition

if ν (cid:28) Ld,
otherwise.

τ,m given in Deﬁnition 2.12 (iii) is the time varying discrete gradient ﬂow of this energy

(cid:40) 1
(cid:26) 1

m−1
+∞

ρn
τ,m ∈ argmin
ν∈P2(Rd)

2τ

2 (ρn−1
W 2

τ,m , ν) + En

τ,m(ν)

and ρ0

τ,m := ρ.

Then ρn
in the sense that

(5.5)

(cid:27)

Consequently, we may apply the ﬁrst author’s results on convergence of the discrete gradient
ﬂow of time dependent energies [20, Theorem A.3], provided that we can show En
m satisﬁes [20,
Assumption A.2].

First, by [20, Theorem 4.3, Proposition 4.4], En
n ∈ N, m > 1, and τ > 0. In particular, there exists a solution to the minimization problem
(5.5) and En
τ is ω-convex along generalized geodesics, for λω = −Cd as in Proposition 2.3 and
ω(x) as in equation (2.4).
Next, we estimate the behavior of the energies and Wasserstein distance along the discrete

τ satisﬁes [20, Assumption 2.18] uniformly for

(cid:114)

gradient ﬂow. By Lemma 2.14 (iii), for all 1 ≤ i ≤ n,

τ,m, ρi−1

2τ
m − 1

((cid:107)ρi−1

W2(ρi

τ,m(cid:107)m

τ,m) ≤

m − (cid:107)ρi

τ,m(cid:107)m
(cid:113)
where, in the second inequality, we use that (cid:107)ρ0(cid:107)m
(cid:90)

Finally, since Proposition 2.3 ensures En
constant ˜Cd > 0, depending only on the dimension, so that

m,τ , ρ) ≤

4nτ (1 + 8C2

W2(ρn

d nτ ).

(cid:113)
2τ(cid:0)1 + nτ C2

d /2(cid:1) + 2Cdτ.

m) + 2Cdτ ≤
m ≤ 1. Likewise, by Corollary 2.15,

τ,m is uniformly bounded below by −Cd, there exists a

E0
τ,m(ρ) − En

τ,m(ρn

τ,m) ≤ Em(ρ, ρ) + Cd ≤ 1 +

Nρ(x)ψ1/m ∗ ρ(x)dx + Cd ≤ ˜Cd + E∞(ρ),

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

53

where in the last inequality we use that Nρ(x) is a continuous function with at most quadratic
growth and ψ1/m ∗ ρ

m→+∞
−−−−−→W2

m→+∞
−−−−−→

ρ, so(cid:82) Nρ(x)ψ1/m ∗ ρ(x)dx

(cid:82) Nρ(x)ρ(x)dx.

It remains to show that En

estimate the continuity of ρn
W 2

τ,m possesses suﬃcient continuity in nτ . To do this, we ﬁrst

τ in nτ . By Lemma 2.14, we have the following crude bound
2 (ρn

h) ≤ (2Cd(nτ + kh))2 ≤ 16C2

d T 2.

τ , ρk

Combining this with Proposition 2.7 (iii) and [20, Theorem 3.6], we obtain that for any T > 0,

there exists ¯τ = ¯τ (T, d) and ¯C = ¯C(T, d) so that for all 0 ≤ h < τ < ¯τ and k, n ∈ N with
kh, nτ ≤ T ,

F2kh(W 2

2 (ρn

τ , ρk

h)) ≤ ¯C

(nτ − kh)2 + τ 2n + hk ˜ω(√τ ) + h2k + ˜ω(h2)k

(cid:104)(cid:112)

(cid:105)

Since Ft(x) is decreasing in t, this implies there exists ˜C = ˜C(T, d, E∞(ρ)) so that for 0 < τ < ¯τ ,

+ 2h(E∞(ρ) − inf E∞) + Cdω(16C2

d T 2)T /n.

(5.6)

F2T (W 2

2 (ρn

τ , ρk

h)) ≤ ˜C

Since F2T (x) is strictly increasing and convex in x, F
Therefore,

−1
2T (x) is strictly increasing and concave.

(cid:104)(cid:112)
(cid:105)
(nτ − kh)2 + √τ| log τ|
(cid:113)

.

−1
2T (√x)

F

σ(x) :=

is a continuous, nondecreasing, concave function that vanishes only at zero. In particular, σ(x)
is also subadditive, so (5.6) implies that, for some C(cid:48) = C(cid:48)(T, d, E∞(ρ)),
(5.7)

(cid:48)(cid:2)σ(cid:0)(nτ − kh)2(cid:1) + σ(cid:0)τ| log τ|2(cid:1)(cid:3) .

h) ≤ C

W2(ρn

τ , ρk

We use this estimate to show that En

τ,m is continuous in nτ , up to an error that decreases

with τ . Since f := N(ψ1/m ∗ ρi
|En

τ,m(ρi
τ,m) − Ek
(cid:48)

(cid:107)∇f(cid:107)∞(cid:2)σ(cid:0)(nτ − kh)2(cid:1) + σ(cid:0)τ| log τ|2(cid:1)(cid:3) .

τ,m)| = |Em(ρi

τ,m) ∈ C1, by Lemma 2.2,
τ,m; ρk

τ ) − Em(ρi

τ,m; ρn

h,m(ρi

≤ C

(cid:12)(cid:12)(cid:12)(cid:12)(cid:90)

h)| =

N(ψ1/m ∗ ρi

τ,m)d(ρn

τ − ρk
h)

Rd

(cid:12)(cid:12)(cid:12)(cid:12)

Finally, (cid:107)∇f(cid:107)∞ is bounded uniformly in m, i, and τ , since for B = B1(0), there exists c
depending only on the dimension (and which we allow to change from line to line) so that, for
all m ≥ d + 1,

τ,m(cid:107)Lm(Rd) ≤ c + (1/αd)(m−1)/(m)(cid:107)ρi

τ,m(cid:107)Lm(Rd)

(cid:107)∇f(cid:107)∞ ≤ (cid:107)∇N(cid:107)L∞(Rd\B) + (cid:107)∇N(cid:107)Lm(cid:48)

(cid:16)

≤ c

1 + (cid:107)ρ(cid:107)m +(cid:0)(m − 1)T C2
(cid:104)

(cid:17)

where the fourth inequality uses Lemma 2.14.

(cid:16)

Thus, [20, Assumption A.2] is satisﬁed, so by [20, Theorem A.3], we conclude that for all

(cid:105)
0 ≤ t ≤ T , there exists C = C(E∞(ρ), T, d) (which we allow to change from line to line) so
+ σ(t2/n) + σ(t/n| log(t/n)|2)
(cid:21)

Hence, using again that Ft(x) is decreasing in t,
−1/2 log n +

t/√n + tω

t/n,m, ρm(t))

(cid:112)

(cid:113)

≤ C

2 (ρn

(cid:16)

(cid:17)

(cid:17)

−1
2T (t/√n) +

t/n,m, ρm(t))

W 2

2 (ρn

−1
2T (

(cid:20)

W 2

F2T

t/n

F2t

F

F

.

t/n| log(t/n)|)

.

≤ C

n

≤ c

(B)(cid:107)ρi

d /2(cid:1)1/m(cid:17)
(cid:16)(cid:112)
(cid:113)

54

KATY CRAIG, INWON KIM, AND YAO YAO

For 0 ≤ x ≤ e−1−√
(cid:16)

W2(ρn

t/n,m, ρm(t))

2, Ft(x) = xeCdt

(cid:17)2e2CdT

and n−1/2 log n = O(n−1/4), so for n suﬃciently large,
−1/16e4CdT
−1/8)1/e2CdT

.

=⇒ W2(ρn

t/n,m, ρm(t)) ≤ Cn

≤ C(n

Finally, it remains to show that the limit ρm is the unique solution of (PME-D)m. Following
a parallel argument as in Jordan, Kinderlehrer, and Otto’s original work on the convergence of
the discrete gradient ﬂow to solutions of the Fokker-Planck equation [27], one can show that

0

Rd

ρm(x, s)(∂sζ(x, s) − ∇Φ1/m(x, s)∇ζ(x, s))dxds

(cid:90)
for all ζ ∈ C∞
0 (Rd × [0, +∞)),
(cid:90) +∞

(cid:90)

(5.8)

0 =

Rd

ρm(x, 0)ζ(x, 0)dx +

(cid:90) +∞

(cid:90)

+

0

Rd

ρm(x, s)m∆ζ(x, s)dxds.

To conclude that ρm(x, t) is the unique weak solution of (PME-D)m, it remains to show that

for all 0 < t < +∞,
(5.9)

(cid:90) t

(cid:32)(cid:90)

(5.10)

0

Rd

(cid:12)(cid:12)(cid:12)(cid:12)∇ρm(x, s)m

ρm(x, s)

(cid:90) t

(cid:90)
(cid:12)(cid:12)(cid:12)(cid:12)2
Rd |ρm(x, s)|mdxds < +∞,

ds < +∞.

(cid:33)1/2

ρm(x, s)dx

0

+ ∇Φ1/m(x, s)

(See, for example, [15, Theorem 6.1] and [34, Theorem 7.1]. While these references do not
consider the case of a time-dependent drift, an identical argument applies to the present case.)

To show (5.9) and (5.10), we deﬁne the following piecewise constant interpolations:

¯ρt/n,m(x, s) := ρi

t/n,m(x) and ¯ρt/n(x, s) := ρi

t/n for s ∈ ((i − 1)t/n, it/n].

Using [20, Theorem 3.6] (see [20, Appendix A.3] for the adaptation to “time dependent” gra-
dient ﬂows), one can show that

¯ρt/n,m(x, s)

n→+∞
−−−−−→W2

ρm(x, s) and ¯ρt/n(x, s)

n→+∞
−−−−−→W2

ρ∞(x, s).

0

0

(cid:90) t

m with respect to Wasserstein
t/n,m(cid:107)m
m

(cid:90)
Rd |¯ρt/n,m(x, s)|mdxds = lim inf
n→+∞

We begin with (5.9). By the lower semicontinuity of (cid:107) · (cid:107)m
convergence [43, Lemma 3.4], Fatou’s Lemma, and Lemma 2.14, which bounds (cid:107)ρi
(cid:90) t
(cid:90)
uniformly in i and n,
Rd |ρm(x, s)|mdxds ≤ lim inf
n→+∞
We now turn to (5.10). To ease notation, we recall the deﬁnition of the R´enyi entropy and
(cid:90)
(cid:12)(cid:12)∇Φ1/m(x, s)(cid:12)(cid:12)2

(cid:90)
Rd |ρi
t/n,m(x)|mdx < +∞.
(cid:33)1/2

By inequality (2.8),(cid:90) t

(cid:12)(cid:12)(cid:12)(cid:12)∇µ(x)m

n(cid:88)
(cid:12)(cid:12)(cid:12)(cid:12)2

(cid:32)(cid:90)
(cid:19)1/2

its metric slope [2, Theorem 10.4.6],

ds ≤ Cdt < +∞.

|∂Sm|(µ) =

µ(x)mdx,

(cid:18)(cid:90)

ρm(x, s)dx

m − 1

Sm(µ) :=

Rd

µ(x)

µ(x)dx

.

1

t
n

i=1

0

Rd

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

55

Thus, by the triangle inequality and Jensen’s inequality, it suﬃces to show

(cid:18)(cid:90) t
0 |∂Sm|2(ρm(s))ds

(cid:19)1/2

< +∞.

(cid:104)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2

1

(cid:12)(cid:12)(cid:12)(cid:12)2
n(cid:88)

(cid:90)

(cid:105)

(5.11)

t
n

t/n,m)m
ρi
t/n,m

(cid:90) (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)∇(ρi
(cid:12)(cid:12)(cid:12)(cid:12)∇(¯ρt/n,m(x, s))m
(cid:90)
(cid:90) t

¯ρt/n,m(x, s)

Rd

0

(cid:34)
(cid:104)

1

1 + λt/n

1

1 + λt/n

≤

≤

(cid:105)

.

(cid:105)

(cid:35)

dx

,

By [2, Theorem 3.1.6, Theorem 10.4.13] and the fact that Em is λ-convex for λ = λ(m),

+ ∇ψ1/m ∗ Nρi

t/n

dρi

t/n,m ≤

1 + λt/n

Em(ρi−1

t/n,m; ρi

t/n) − Em(ρi

t/n,m; ρi

t/n)

Summing both sides from i = 1, . . . , n and using the deﬁnition of ¯ρt/n,m, ¯ρt/n, and Em,

+ ∇ψ1/m ∗ N¯ρt/n(x, s)

¯ρt/n,m(x, s)dxds

(cid:104)

Em(ρ; ρ1

t/n) − Em(ρn

t/n,m; ρn

t/n) +

Nψ1/m ∗ ρi

t/n,m(x)

ρi+1
t/n (x) − ρi

t/n(x)

Rd

i=1

Em(ρ; ρ1

t/n) + Cd + 2CmCdt

,

where in the last inequality we use Propositions 2.2, 2.3, and 2.14, for Cm chosen so that
t/n,m(cid:107)∞ < Cm. Taking the square root of both sides and applying the reverse
(cid:107)∇Nψ1/m ∗ ρi
(cid:18)(cid:90) t
triangle inequality for the L2(d¯ρt/n,m(·, s)) norm and Proposition 2.3,
0 |∂Sm|2(¯ρt/n,m(s))ds

t/n) + Cd + 2CmCdt

1(cid:112)

(cid:19)1/2

(cid:105)1/2

Em(ρ; ρ1

1 + λt/n

+ Cd.

(cid:104)

≤

Taking the lim inf n→+∞ and using that |∂Sm| is lower semicontinuous with respect to Wasser-
stein convergence [2, Corollary 2.4.10], we conclude the result.
(cid:3)

Acknowledgements. The authors would like to thank Jos´e Antonio Carrillo, Alessio Figalli,
and Alp´ar M´esz´aros for their helpful comments.

References

[1] Alexander, D., Kim, I., Yao, Y.: Quasi-static evolution and congested crowd transport. Nonlinearity 27(4),
823–858 (2014). DOI 10.1088/0951-7715/27/4/823. URL http://dx.doi.org/10.1088/0951-7715/27/4/
823

[2] Ambrosio, L., Gigli, N., Savar´e, G.: Gradient ﬂows in metric spaces and in the space of probability measures,

second edn. Lectures in Mathematics ETH Z¨urich. Birkh¨auser Verlag, Basel (2008)

[3] Ambrosio, L., Serfaty, S.: A gradient ﬂow approach to an evolution problem arising in superconductivity.
Comm. Pure Appl. Math. 61(11), 1495–1539 (2008). DOI 10.1002/cpa.20223. URL http://dx.doi.org/
10.1002/cpa.20223

[4] Balagu´e, D., Carrillo, J., Laurent, T., Raoul, G.: Nonlocal interactions by repulsive-attractive potentials:

Radial ins/stability. Phys. D. 260, 5–25 (2013)

[5] Balagu´e, D., Carrillo, J.A., Yao, Y.: Conﬁnement for repulsive-attractive kernels. Discrete Contin. Dyn.
Syst. Ser. B 19(5), 1227–1248 (2014). DOI 10.3934/dcdsb.2014.19.1227. URL http://dx.doi.org/10.
3934/dcdsb.2014.19.1227

[6] Benedetto, D., Caglioti, E., Carrillo, J.A., Pulvirenti, M.: A non-Maxwellian steady distribution for one-
dimensional granular media. J. Statist. Phys. 91(5-6), 979–990 (1998). DOI 10.1023/A:1023032000560.
URL http://dx.doi.org/10.1023/A:1023032000560

56

KATY CRAIG, INWON KIM, AND YAO YAO

[7] Bertozzi, A.L., Carrillo, J.A., Laurent, T.: Blow-up in multidimensional aggregation equations with mildly
singular interaction kernels. Nonlinearity 22(3), 683–710 (2009). DOI 10.1088/0951-7715/22/3/009. URL
http://dx.doi.org/10.1088/0951-7715/22/3/009

[8] Bertozzi, A.L., Kolokolnikov, T., Sun, H., Uminsky, D., von Brecht, J.: Ring patterns and their bifurcations
in a nonlocal model of biological swarms. Commun. Math. Sci. 13(4), 955–985 (2015). DOI 10.4310/CMS.
2015.v13.n4.a6. URL http://dx.doi.org/10.4310/CMS.2015.v13.n4.a6

[9] Bertozzi, A.L., Laurent, T., L´eger, F.: Aggregation and spreading via the Newtonian potential: the dy-
namics of patch solutions. Math. Models Methods Appl. Sci. 22(suppl. 1), 1140,005, 39 (2012). DOI
10.1142/S0218202511400057. URL http://dx.doi.org/10.1142/S0218202511400057

[10] Blanchet, A.: A gradient ﬂow approach to the Keller-Segel systems. to appear in RIMS Kokyuroku’s lecture

notes, preprint at http://publications.ut-capitole.fr/16518/

[11] Blanchet, A., Carlen, E.A., Carrillo, J.A.: Functional inequalities, thick tails and asymptotics for the critical
mass Patlak-Keller-Segel model. J. Funct. Anal. 262(5), 2142–2230 (2012). DOI 10.1016/j.jfa.2011.12.012.
URL http://dx.doi.org/10.1016/j.jfa.2011.12.012

[12] Burger, M., Fetecau, R., Huang, Y.: Stationary states and asymptotic behavior of aggregation models with
nonlinear local repulsion. SIAM J. Appl. Dyn. Syst. 13(1), 397–424 (2014). DOI 10.1137/130923786. URL
http://dx.doi.org/10.1137/130923786

[13] Caﬀarelli, L., Salsa, S.: A geometric approach to free boundary problems, Graduate Studies in Mathematics,
vol. 68. American Mathematical Society, Providence, RI (2005). DOI 10.1090/gsm/068. URL http://dx.
doi.org/10.1090/gsm/068

[14] Caﬀarelli, L., Vazquez, J.L.: Viscosity solutions for the porous medium equation. In: Diﬀerential equations:
La Pietra 1996 (Florence), Proc. Sympos. Pure Math., vol. 65, pp. 13–26. Amer. Math. Soc., Providence,
RI (1999). DOI 10.1090/pspum/065/1662747. URL http://dx.doi.org/10.1090/pspum/065/1662747

[15] Carlier, G., Laborde, M.: On systems of continuity equations with nonlinear diﬀusion and nonlocal drifts.

preprint at http://arxiv.org/abs/1505.01304

[16] Carrillo, J.A., Hittmeir, S., Volzone, B., Yao, Y.: Nonlinear aggregation-diﬀusion equations: Radial sym-

metry and long time asymptotics. in preparation

[17] Carrillo, J.A., Lisini, S., Mainini, E.: Uniqueness for Keller-Segel-type chemotaxis models. Discrete Contin.
Dyn. Syst. 34(4), 1319–1338 (2014). DOI 10.3934/dcds.2014.34.1319. URL http://dx.doi.org/10.3934/
dcds.2014.34.1319

[18] Carrillo, J.A., McCann, R.J., Villani, C.: Contractions in the 2-Wasserstein length space and thermalization
of granular media. Arch. Ration. Mech. Anal. 179(2), 217–263 (2006). DOI 10.1007/s00205-005-0386-1.
URL http://dx.doi.org/10.1007/s00205-005-0386-1

[19] Chuang, Y.L., Huang, Y., D’Orsogna, M., Bertozzi, A.: Multi-vehicle ﬂocking: scalability of cooperative
control algorithms using pairwise potentials. IEEE International Conference on Robotics and Automation
pp. 2292–2299 (2007)

[20] Craig, K.: Nonconvex gradient ﬂow in the Wasserstein metric and applications to constrained nonlocal

interactions. preprint at http://arxiv.org/abs/1512.07255

[21] Doye, J.P.K., Wales, D.J., Berry, R.S.: The eﬀect of the range of the potential on the structures of clusters.

J. Chem. Phys. 103, 4234–4249 (1995)

[22] Federer, H.: Curvature measures. Trans. Amer. Math. Soc. 93, 418–491 (1959)
[23] Fellner, K., Raoul, G.: Stable stationary states of non-local interaction equations. Math. Models Meth-
ods Appl. Sci. 20(12), 2267–2291 (2010). DOI 10.1142/S0218202510004921. URL http://dx.doi.org/10.
1142/S0218202510004921

[24] Fetecau, R.C., Huang, Y.: Equilibria of biological aggregations with nonlocal repulsive-attractive interac-
tions. Phys. D 260, 49–64 (2013). DOI 10.1016/j.physd.2012.11.004. URL http://dx.doi.org/10.1016/
j.physd.2012.11.004

[25] Fetecau, R.C., Huang, Y., Kolokolnikov, T.: Swarm dynamics and equilibria for a nonlocal aggregation
model. Nonlinearity 24(10), 2681–2716 (2011). DOI 10.1088/0951-7715/24/10/002. URL http://dx.doi.
org/10.1088/0951-7715/24/10/002

[26] Fusco, N., Maggi, F., Pratelli, A.: Stability estimates for certain Faber-Krahn, isocapacitary and Cheeger

inequalities. Ann. Sc. Norm. Super. Pisa Cl. Sci. 8(5), 51–71 (2009)

CONGESTED AGGREGATION VIA NEWTONIAN INTERACTION

57

[27] Jordan, R., Kinderlehrer, D., Otto, F.: The variational formulation of the Fokker-Planck equation. SIAM
J. Math. Anal. 29(1), 1–17 (1998). DOI 10.1137/S0036141096303359. URL http://dx.doi.org/10.1137/
S0036141096303359

[28] Judoviˇc, V.I.: Non-stationary ﬂows of an ideal incompressible ﬂuid. ˘Z. Vyˇcisl. Mat. i Mat. Fiz. 3, 1032–1066

(1963)

[29] Keller, E., Segel, L.: Initiation of slide mold aggregation viewed as an instability. J. Theoret. Biol. 26

(1970)

[30] Kim, I., Pozar, N.: Porous medium equation to Hele-Shaw ﬂow with general initial density. preprint at

http://arxiv.org/abs/1509.06287

[31] Kim, I., Yao, Y.: The Patlak-Keller-Segel model and its variations: properties of solutions via maximum

principle. SIAM Journal on Mathematical Analysis 44(2), 568–602 (2012)

[32] Kim, I.C.: Uniqueness and existence results on the Hele-Shaw and the Stefan problems. Arch. Ration.
Mech. Anal. 168(4), 299–328 (2003). DOI 10.1007/s00205-003-0251-z. URL http://dx.doi.org/10.1007/
s00205-003-0251-z

[33] Kim, I.C., Lei, H.K.: Degenerate diﬀusion with a drift potential: a viscosity solutions approach. Discrete
Contin. Dyn. Syst. 27(2), 767–786 (2010). DOI 10.3934/dcds.2010.27.767. URL http://dx.doi.org/10.
3934/dcds.2010.27.767

[34] Laborde, M.: On some non linear evolution systems which are perturbations of Wasserstein gradient ﬂows.

preprint at http://arxiv.org/abs/1506.00126

[35] Lieb, E.H., Loss, M.: Analysis, Graduate Studies in Mathematics, vol. 14. American Mathematical Society,

Providence, RI (1997)

[36] Lieb, E.H., Yau, H.T.: The Chandrasekhar theory of stellar collapse as the limit of quantum mechanics.
Comm. Math. Phys. 112(1), 147–174 (1987). URL http://projecteuclid.org/euclid.cmp/1104159813
[37] Lin, F., Zhang, P.: On the hydrodynamic limit of Ginzburg-Landau vortices. Discrete Contin. Dynam.
Systems 6(1), 121–142 (2000). DOI 10.3934/dcds.2000.6.121. URL http://dx.doi.org/10.3934/dcds.
2000.6.121

[38] Lions, P.L.: The concentration-compactness principle in the calculus of variations. The locally compact
case. I. Ann. Inst. H. Poincar´e Anal. Non Lin´eaire 1(2), 109–145 (1984). URL http://www.numdam.org/
item?id=AIHPC_1984__1_2_109_0

[39] Loeper, G.: Uniqueness of the solution to the Vlasov-Poisson system with bounded density. J. Math. Pures
Appl. (9) 86(1), 68–79 (2006). DOI 10.1016/j.matpur.2006.01.005. URL http://dx.doi.org/10.1016/j.
matpur.2006.01.005

[40] Masmoudi, N., Zhang, P.: Global solutions to vortex density equations arising from sup-conductivity.
Ann. Inst. H. Poincar´e Anal. Non Lin´eaire 22(4), 441–458 (2005). DOI 10.1016/j.anihpc.2004.07.002. URL
http://dx.doi.org/10.1016/j.anihpc.2004.07.002

[41] Maury, B., Roudneﬀ-Chupin, A., Santambrogio, F.: A macroscopic crowd motion model of gradient ﬂow
type. Math. Models Methods Appl. Sci. 20(10), 1787–1821 (2010). DOI 10.1142/S0218202510004799. URL
http://dx.doi.org/10.1142/S0218202510004799

[42] Maury, B., Roudneﬀ-Chupin, A., Santambrogio, F., Venel, J.: Handling congestion in crowd mo-
tion modeling. Netw. Heterog. Media 6(3), 485–519 (2011). DOI 10.3934/nhm.2011.6.485. URL http:
//dx.doi.org/10.3934/nhm.2011.6.485

[43] McCann, R.J.: A convexity principle for interacting gases. Adv. Math. 128(1), 153–179 (1997). DOI

10.1006/aima.1997.1634. URL http://dx.doi.org/10.1006/aima.1997.1634

[44] Mellet, A., Perthame, B., Quiros, F.: A Hele-Shaw problem for tumor growth. preprint at http://arxiv.

org/abs/1512.069957

[45] Perea, L., G´omez, G., Elosegui, P.: Extension of the Cucker–Smale control law to space ﬂight formations.

AIAA J. of Guidance, Control, and Dynamics 32, 527–537 (2009)

[46] Poupaud, F.: Diagonal defect measures, adhesion dynamics and Euler equation. Methods Appl. Anal. 9(4),
533–561 (2002). DOI 10.4310/MAA.2002.v9.n4.a4. URL http://dx.doi.org/10.4310/MAA.2002.v9.n4.a4
[47] Rechtsman, M., Stillinger, F., Torquato, S.: Optimized interactions for targeted self- assembly: application

to a honeycomb lattice. Phys. Rev. Lett. 95(22) (2005)

[48] Santambrogio, F.: Optimal transport for applied mathematicians. Progress in Nonlinear Diﬀerential Equa-
tions and their Applications, 87. Birkh¨auser/Springer, Cham (2015). DOI 10.1007/978-3-319-20828-2. URL
http://dx.doi.org/10.1007/978-3-319-20828-2. Calculus of variations, PDEs, and modeling

58

KATY CRAIG, INWON KIM, AND YAO YAO

[49] Sugiyama, Y.: Global existence in sub-critical cases and ﬁnite time blow-up in super-critical cases to

degenerate Keller-Segel systems. Diﬀerential Integral Equations 19(8), 841–876 (2006)

[50] Sun, H., Uminsky, D., Bertozzi, A.L.: Stability and clustering of self-similar solutions of aggregation
equations. J. Math. Phys. 53(11), 115,610, 18 (2012). DOI 10.1063/1.4745180. URL http://dx.doi.org/
10.1063/1.4745180

[51] Talenti, G.: Elliptic equations and rearrangements. Ann. Scuola Norm. Sup. Pisa Cl. Sci. (4) 3(4), 697–718

(1976)

[52] Topaz, C.M., Bertozzi, A.L., Lewis, M.A.: A nonlocal continuum model for biological aggregation. Bull.
Math. Biol. 68(7), 1601–1623 (2006). DOI 10.1007/s11538-006-9088-6. URL http://dx.doi.org/10.1007/
s11538-006-9088-6

[53] V´azquez, J.L.: The porous medium equation. Oxford Mathematical Monographs. The Clarendon Press,

Oxford University Press, Oxford (2007). Mathematical theory

[54] Villani, C.: Topics in optimal transportation, Graduate Studies in Mathematics, vol. 58. American Mathe-

matical Society, Providence, RI (2003)

[55] Wales, D.: Energy landscapes of clusters bound by short-ranged potentials. Chem. Eur. J. Chem. Phys.

11, 2491–2494 (2010)

Department of Mathematics, University of California, Santa Barbara

Department of Mathematics, University of California, Los Angeles

School of Mathematics, Georgia Institute of Technology

