6
1
0
2

 
r
a

 

M
1
1

 
 
]
T
S
h
t
a
m

.

[
 
 

1
v
6
9
4
3
0

.

3
0
6
1
:
v
i
X
r
a

A generalized quadratic estimate for random ﬁeld

nonstationarity †

Ethan Anderes1,∗ and Joe Guinness2

1Department of Statistics, University of California, Davis CA 95616, USA. e-mail: anderes@ucdavis.edu

2Department of Statistics, North Carolina State University. e-mail: jsguinne@ncsu.edu

Abstract: In this paper, we attempt to shed light on a new class of nonstationary random ﬁelds which
exhibit, what we call, local invariant nonstationarity. We argue that the local invariant property has a
special interaction with a new generalized quadratic estimate—also derived here—which extends
an estimate originally developed for gravitational lensing of the Cosmic Microwave Background
in Cosmology [10, 11]. The nature of this interaction not only encourages low estimation bias but
also enables accurate (and fast) quantiﬁcation of Frequentist mean square error quantiﬁcation of the
estimated nonstationarity. These quadratic estimates are interesting, in their own right, as they detect
and estimate nonstationarity by probing correlation among Fourier frequencies, the absence of which
is the characterizing feature of weak stationarity (by Bochner’s Theorem). Moreover, this generalized
quadratic estimate can be computed with a Fourier characterization that runs in O(n log n) time
when observing the ﬁeld on a uniform grid of size n in Rd. Finally, the work presented here partially
addresses two other problems associated with the statistical theory of nonstationarity: 1) estimating
the phase of a spatially varying modulated stationary random ﬁeld and 2) identifying a larger class
of nonstationary random ﬁelds which admit an extension of the quadratic estimator of gravitational
lensing that extends the same attractive statistical properties.

Contents

.
.

.
.

.
.

.
.

.
.

.
.

. . .

.
.

.
.

.
.

.
.

1 Introduction .

.
1.1 Notation .

2 Locally invariant nonstationary random ﬁelds

. . . . . . .

2.3.1 Variance spectral density Cvar ˆφ
2.3.2 Bias spectral density Cbias ˆφ

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . .
2.1 A generalized quadratic estimate of φ(x) . . . .
2.2 The Hu and Okamoto lensing estimate as a special case of ˆφ(cid:96) . . . . .
. . . . .
2.3 Variance and bias analytic approximation . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . .
. . . . . . . . . . . . . . . .
2.4 An illustration of the bias reduction due to local invariance . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . .
. . . . . . . . . . .
. . . . . . . . . . .
.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.1 Locally attainable spectral densities
3.2 Modeling ξk, Ck and ηk .
3.3 Nonstationary phase example d = 1 . . . . .
3.4 Nonstationary phase example d = 2 . . . . .

. . . . .
. . . . .

. . . . .
. . . . .

. . . . . . .

. . .
. . .

.
4 Discusssion .
References .
.
.
A Detailed derivations

.
.

.
.

.
.

.

3 Nonstationary spectral phase model

. . . . .

. . . . .

. . . . .

. . .

. . .

. . . . .

. . . . .

. . .

. . . . .

. . . .

.
.
.

.
.
.

. . .

.
.
.

.
.
.

.
.
.

.
.

.
.
.

(cid:96)

(cid:96)

.

.
.
.

2
3
4
5
7
7
8
9
10
12
13
17
17
20
22
24
25

∗EA was partially supported by NSF CAREER grant DMS-1252795
†All the source code used for the simulations and graphics in this paper is publicly available through the on-line repository

https://github.com/EthanAnderes/NonstationaryPhase.jl

1

Anderes and Guinness/Generalized quadratic estimate

2

1. Introduction

Many data sets in time series and spatial statistics show clear signs of nonstationarity [20, 6]. Despite
the prevalence of nonstationary data, theory for understanding and estimating nonstationary ran-
dom ﬁeld models is still underdeveloped compared to what is known for stationary random ﬁelds.
For example, there seems to be no consensus among statisticians as to the relative merits of various
nonstationary models and their corresponding estimates found in the current literature (examples of
such models can be found in [9, 21, 15, 5]). While powerful spectral techniques have been developed
for deriving absolute continuity or orthogonality of stationary random ﬁelds [12] and for under-
standing the implications for spatial interpolation [22], we know quite little about such topics for
nonstationary random ﬁelds. A further complicating matter is that even if the parametric form for
the nonstationary data generating mechanism is known, difﬁculties associated with the inevitable
increase in the number of unknown parameters and computational complexity can outweigh the
beneﬁts of ﬁtting the true nonstationary model. The situation is far worse for spatial statistics—as
compared to time series—where irregularity of spatial observation locations and large boundary ef-
fects can make estimation and modeling of nonstationarity more difﬁcult.

In this paper, we attempt to shed light on a new class of nonstationary random ﬁelds which ex-
hibit, what we call, local invariant nonstationarity. Formally deﬁned in Section 2, a locally invariant
nonstationary random ﬁeld {Z(x) : x ∈ Rd} has the feature that the covariance function can be writ-
ten in the following form,

cov(Z(x), Z(y)) = K(x − y, θ(x) − θ(y)),

where K(·,·) : Rd × Rd → R and θ(·) : Rd → Rd is a vector ﬁeld which characterizes the nonsta-
tionarity in Z(x). We argue that the locally invariant property has a special interaction with a new
generalized quadratic estimate (derived in Section 2.1) which extends an estimate originally devel-
oped for gravitational lensing of the Cosmic Microwave Background in Cosmology [10, 11]. The na-
ture of this interaction not only encourages low estimation bias but also enables accurate (and fast)
Frequentist mean square error quantiﬁcation of the nonstationarity characterized by θ(x). These
quadratic estimates are interesting in their own right, as they detect and estimate nonstationarity
by probing correlation among Fourier frequencies, the absence of which is the characterizing fea-
ture of weak stationarity (by Bochner’s Theorem). Moreover, this generalized quadratic estimate can
be computed with a Fourier characterization that runs in O(n log n) time and O(n) storage when
observing the ﬁeld on a uniform grid of size n in Rd. Finally, the work presented here partially ad-
dresses two unanswered questions that arise in two important bodies of work on nonstationarity: 1)
estimating the spatially varying phase in the models analyzed by Dahlhaus [2, 3] and 2) how to ex-
tend the quadratic estimate of dark matter from the Cosmic Microwave Background to more general
nonstationary random ﬁelds.

The seminal work of Dahlhaus in the time series literature [2, 3] is an example of a collection of
results that hint at a more general statistical theory of nonstationarity. Dahlhaus develops asymptotic
theory for a particular class of nonstationary random ﬁelds modeled by a spatially (or temporally)
varying spectral density. These random ﬁelds were originally developed for time series [18, 19] and
have the form

eix·kA(k, x)

Ck

dWk

(2π)d/2

(1)

(cid:90)

Z(x) =

Rd

(cid:112)

where Ck is a spectral density, dWk is an orthogonal increment random complex measure that sat-
isﬁes E|dWk|2 = dk (see [7] for details on random measures) and A(k, x) represents a spatial (or
temporal) modulation of
Ck. Dahlhaus proved consistency results for estimating the squared mod-
ulus |A(k, x)|2 when estimation is done by maximizing a weighted sum of local likelihood functions.
Left unanswered, however, is the question of estimating the phase of A(k, x). In Section 3, we partly
resolve this question by showing that a generalized quadratic estimate can be used to estimate a

√

Anderes and Guinness/Generalized quadratic estimate

3

pure phase modulation A(k, x) = exp(iB(k, x)) where B(k, x) is a function taking values in R and
is a separable function of x and k. Indeed, this nonstationary phase model has the local invariance
property and, as such, can be accurately estimated (under certain conditions on B(k, x)) with the
generalized quadratic estimate developed here.

Another important development in the statistical theory of nonstationarity comes from recent
gravitational lensing studies of the Cosmic Microwave Background (CMB) [4, 24, 16, 23, 17]. In Cos-
mology, gravitational lensing describes the distortion of photon trajectories due to density ﬂuctua-
tions of intervening dark matter. These density ﬂuctuations affect the CMB observations by intro-
ducing small nonstationarities in the original isotropic random ﬁeld model of the CMB. The state-
of-the-art estimator of lensing, the quadratic estimator developed by Hu and Okamoto [10, 11], has
become an incredibly successful tool for probing the nature of dark matter, understanding cosmic
structure and constraining cosmological parameters. What is so surprising about this estimate is that
is has small bias. This is due to a delicate cancellation of terms in an inﬁnite Taylor expansion of the
lensing effect. Unfortunately there has been no clear explanation as to why this cancellation occurs
and whether or not it exists in other models of nonstationarity. In this paper, we argue that this can-
cellation is due to the fact that the lensing-induced nonstationarity is locally invariant. Moreover, the
generalized quadratic estimator developed here extends the lensing estimator to more general set-
tings. Indeed, many of techniques we use to derive the generalized quadratic estimator are inspired
by—and closely follow—those used by Hu and Okamoto [10, 11]. The point of this paper, in contrast
to the work of Hu and Okamoto, is to identify the cause of the delicate Taylor series cancellation and
extend the beneﬁts of the lensing estimator to a larger class of nonstationary random ﬁelds available
to general practitioners of spatial statistics.

The ﬁrst part of this paper, given in Section 2, deﬁnes the locally invariant property and uses it
to derive a corresponding generalized quadratic estimate, called the quadratic estimate hereafter,
which has particularly low bias. These new estimates are global rather than local in nature and thus
avoid complicating theoretical and practical issues related to bandwidth selection. Moreover, they
are unique in that they work in the spectral domain by estimating cross correlation of the Fourier
coefﬁcients. In Section 2 we also derive analytic approximations for estimation variance and second
order bias of the quadratic estimate. These approximations, and indeed the estimate itself, are often
very accurate and have Fourier representations that yield fast computation.

The second part of this paper is given in Section 3. Here we analyze random ﬁelds which are char-
acterized by a spatially varying spectral phase modulation of a stationary ﬁeld, called nonstationary
spectral phase random ﬁelds for the remainder of this paper. These models effectively generalize
warping models, are locally invariant and, as such, are amenable to quadratic estimates. In Subsec-
tion 3.1 we characterize how the local spectral density of the nonstationary spectral phase model
varies as a function of spatial location. The theory of optimal transport and the L2-Wasserstein met-
ric play an important role in this characterization and leads to a natural heuristic for quantifying
estimation bias in terms of the Wasserstein geodesic cut locus (see Claim 3, Section 3.2 and Figure
3). We also present a set of simulations, based on nonstationary spectral phase random ﬁelds, which
demonstrate the accuracy of both the quadratic estimate and our approximation to the mean squared
sampling properties of the quadratic estimate.

1.1. Notation
For readability it will be advantageous to brieﬂy summarize the notational conventions used through-
out this paper, some of which are borrowed from Cosmology and are somewhat nonstandard in the
statistics literature. Variables taking values in Rd or Rd×d will generally be written with bold font
such as x, y, k, (cid:96) ∈ Rd or A, M ∈ Rd×d. Indexing into vector or matrix coordinates are written with
subscripts so that xi ∈ R denotes the ith coordinate of x ∈ Rd, for example. When z, w ∈ Cd we let
the (non-Hermitian) dot product be denoted by z · w = z1w1 + . . . + zdwd.
Vector ﬁelds θ(x) : Rd → Rd are also written bold so that θ(x) = (θ1(x), . . . , θd(x))T where
θi(x) : Rd → R. The Fourier transform of θ(x), for example, is applied coordinate-wise and written

Anderes and Guinness/Generalized quadratic estimate

4

θk = (θ1,k, . . . , θd,k)T where θj,k denotes the Fourier transform of θj(x) and is deﬁned as

(cid:90)

θj,k =

e−ix·kθj(x)

dx

(2π)d/2

.

k , f (2)

k , f (3)

(cid:96) = (2π)d/2C Z

For a mean-zero stationary random ﬁeld {Z(x) : x ∈ Rd} the autocorrelation function is denoted
C Z(x − y) := E(Z(x)Z(y)∗) and the spectral density is denoted C ZZ
(cid:96) where, via our
(cid:96) denotes the Fourier transform of C Z(x). Parenthetical superscripts are reserved for
convention, C Z
enumerating functions (and not higher order derivatives). For example f (1)
k , . . . denotes
a sequence of functions taking arguments k ∈ Rd in the Fourier domain. This convention avoids
indexing ambiguities and the subscript convention of the Fourier transform.
In the derivations that follow, one may assume all random ﬁelds have periodic boundary condi-
tions on (−L/2, L/2]d, for some large L > 0. This alleviates subtleties associated with the Fourier
transform of non-periodic random ﬁelds deﬁned on Rd. However, extensions to non-periodic ran-
dom ﬁelds can be made with an appropriate use of generalized random ﬁelds and generalized
Fourier transforms. To incorporate the periodic case and the—possibly generalized—general case
we use a single notation for the Fourier transform in both situations. For example when f (x) is pe-
(2π)d/2 should be interpreted
(2π/L)d
(2π)d/2 , respec-
k∈ 2π
tively. A consequence of this convention is that, in the periodic case, one equates dk with (2π/L)d
and, therefore, the Dirac delta function δk becomes a regular function taking the value 1/dk when
k = 0 and zero otherwise. In particular, if Z(x) is a mean zero stationary random ﬁeld with with
periodic boundary conditions on (−L/2, L/2]d then E(ZkZ∗

riodic on (−L/2, L/2]d the notation(cid:82) e−ix·kf (x)
as notationally equivalent to(cid:82) L/2

(2π)d/2 and(cid:82) eix·kfk
(2π)d/2 and(cid:80)

−L/2 ···(cid:82) L/2

and E(|Zk|2) = δ0C ZZ
k .

−L/2 e−ix·kf (x)

dx

ω) = δk−ωC ZZ

k

dk

L

Zd eix·kfk

dx

2. Locally invariant nonstationary random ﬁelds

In this section we deﬁne a property of nonstationary random ﬁelds called local invariance. This prop-
erty, along with a small set of generic model and observational assumptions, appears to be an impor-
tant ingredient for quadratic estimates of nonstationarity to have low bias. Indeed, this is the main
theme of the paper: that the structure of local invariance encourages bias cancellation. A secondary theme
of this paper is that local invariance provides a ﬂexible restriction to the class of all random ﬁeld
covariance functions whereby making generalized quadratic estimation available to a wide class of
nonstationary random ﬁeld applications.
Deﬁnition 1. Let C θ(x, y) be a positive deﬁnite covariance function deﬁned on x, y ∈ Rd and parameterized
by a vector ﬁeld θ(x) : Rd → Rd. Then θ(x) is said to be a local invariant for C θ(x, y) if there exists a
function K : Rd × Rd → R such that

C θ(x, y) = K(cid:0)x − y, θ(x) − θ(y)(cid:1).

(2)

Equivalently, Z(x) is locally invariant with respect to θ(x) if Z(x) is a random ﬁeld with covariance
function C θ that satisﬁes (2).

The name local invariance is intended to express the following fact: any region where θ(x) is con-
stant results in the same local stationary model. In particular, suppose Z(x) is a nonstationary ran-
dom ﬁeld with covariance function C θ(x, y) satisfying (2). If θ(x) has no variation (i.e. is constant)
over neighborhoods Ω1 ⊂ Rd and Ω2 ⊂ Rd then Z(x) is locally stationary over Ω1 and Ω2 with the
same local autocovariance function K(x − y, 0).

Examples of local invariant nonstationary random ﬁelds are easy to ﬁnd. Indeed any warped ran-
dom ﬁeld of the form Z(x + θ(x)) is locally invariant with respect to θ(x) when Z is a stationary
random ﬁeld. Another example of a locally invariant model, discussed later in Section 3, is the spa-
tially varying spectral phase model given in (1) where A(k, x) = exp(iθ(x) · ηk) and ηk is a known

Anderes and Guinness/Generalized quadratic estimate

5

function mapping Rd into Rd that has odd symmetry about the origin. It is interesting to note that
many of the asymptotic results for spatially (or temporally) varying spectral models study the es-
timation of |A(k, x)|2 using a local periodogram [2] or a version or the preperiodogram [3]. Since
|A(k, x)|2 = 1 for the spectral phase model (1), these local periodograms to not immediately apply
to the estimation of A(k, x) deﬁned in (1).

In what follows we derive a quadratic estimate of θ(x) for locally invariant nonstationarity of the
form given in Deﬁnition 1. The estimates are derived under the following observational scenario: a
single realization of the nonstationary random ﬁeld observed on a dense grid with additive station-
ary noise. These assumptions hold throughout the paper. We list them here to be completely explicit.
Assumption 1. Let Z(x) be a mean zero nonstationary Gaussian random ﬁeld with local invariant nonsta-
tionary covariance function C θ(x, y) satisfying Deﬁnition 1. The data ﬁeld, denoted Z obs(x), is observed on
a dense regular grid and has the form

where N (x) is a mean zero stationary Gaussian generalized random noise with spectral density C NN
k .

Z obs(x) = Z(x) + N (x)

Our second assumption is that the local invariant vector ﬁeld θ(x) can be additionally charac-
terized by an unknown scalar potential function φ(x) : Rd → R. This assumption simply reduces
the amount of complexity necessary for developing a quadratic estimate of θ(x) while still retaining
enough modeling ﬂexibility.
Assumption 2. Suppose the vector ﬁeld θ(x) : Rd → Rd is characterized by an unknown scalar potential
(cid:1)T
ﬁeld φ(x) : Rd → R along with a known vector ﬁeld ξk which satisﬁes

θk :=(cid:0)ξ1,k φk , . . . , ξd,k φk

.

For each j ∈ {1, . . . , d} the coordinate spectral multiplier ξj,k : Rd → C is assumed to be a Hermitian
function of k so that ξj,−k = ξ

Notice that the above scalar potential model includes the case that θ(x) = ∇φ(x), by setting

∗
j,k.

ξk = ik, and the case that θ(x) = (φ(x), . . . , φ(x)), by setting ξk = (1, . . . , 1).
Assumption 3. There exists a mean zero stationary Gaussian random ﬁeld prior for the unknown scalar
potential φ(x) : Rd → R. Let C φ(x − y) = E(φ(x)φ(y)) denote the autocovariance function for φ(x) and
C φφ
k denote the corresponding spectral density for this prior.
It is important to note that the prior in Assumption 3 is not used to generate a Bayesian posterior.
A Bayesian posterior sampling methodology would be an exciting development but not the scope of
the current paper. Instead, the prior is only used to approximate the marginal distribution of the data
which, in turn, is used to optimize Fourier weights and to generate a variance approximation for the
quadratic estimate of φk. Indeed the quadratic estimate, derived in Section 2.1, is deﬁned to be an
unbiased estimate of φ (up to ﬁrst order) regardless of how C φφ
k is speciﬁed. The only effect of mis-
speciﬁcation (or non-existence) of C φφ
k will be to generate an estimate which gives too much weight to
unruly frequencies and to report a less accurate mean squared error when using the approximations
developed in Section 2.3.

Assumptions 1, 2 and 3 are generic and intended to isolate a small set of assumptions for deriv-
ing an estimate with small bias. Bias is not universally guaranteed to be small but the generalized
quadratic estimates, derived in the next section for local invariance models, often have surprisingly
small estimation bias due to the local invariant property.

2.1. A generalized quadratic estimate of φ(x)
Based on assumptions 1, 2 and 3 given in the previous section, the ﬁrst step for deriving a generalized
quadratic estimate of φ(x) is to linearly approximate C θ(x, y), with a Taylor expansion in θ(x)−θ(y)

Anderes and Guinness/Generalized quadratic estimate

6

as follows

C θ(x, y) = C (0)(x − y) + C(1)(x − y) · (θ(x) − θ(y)) + O(φ2) + O(φ3) + ··· .

(3)
where C (0) : Rd → R and C(1) : Rd → Rd satisﬁes C(1)(−x) = −C(1)(x). Now, truncating (3) to ﬁrst
order and applying Claim 4 of Appendix A gives the following linear approximation of the cross
frequency covariance in the Fourier transform of Z(x)

E(cid:0)Zk+(cid:96)Z−k

(cid:1) ≈ φ(cid:96)

(cid:16)
ξ(cid:96)·C(1)

k − ξ(cid:96)·C(1)

(cid:17)

.

stationary if and only if E(cid:0)Zk+(cid:96)Z−k

(cid:1) = 0 for every (cid:96) (cid:54)= 0. Therefore nontrivial covariance between

k+(cid:96)

Recall Bochner’s Theorem (details can be found in [7]) which states that the random ﬁeld Z(x) is

Zk+(cid:96) and Z−k at some nonzero lag (cid:96) provides a direct probe into the nonstationarity present in Z(x).
Equation (4) is, therefore, a translation of how local invariant nonstationarity relates to nonzero cross
covariance in Zk. Using this translation, Claim 5 of Appendix A derives the quadratic estimate of
φ(cid:96). This estimate is effectively an inverse-variance weighted autocovariance estimate in the Fourier
domain and is given by

(4)

(cid:90) (cid:16)

(cid:17)∗ Z obs

k+(cid:96)Z obs−k

C ZZobs

k+(cid:96) C ZZobs

k

ˆφ(cid:96) = A(cid:96)

ξ(cid:96)·C(1)

k − ξ(cid:96)·C(1)

k+(cid:96)

dk

(2π)d/2

.

(5)

k

k

In the above formula, A(cid:96) is a normalizing constant (see Claim 5 for an exact expression), C ZZobs
is deﬁned to be C ZZm
is the spectral density of Z(x) marginalized over the
prior for φ(x) given in Assumption 3. Notice that the prior only serves to optimize the weights in ˆφ(cid:96).
k where C (0)
Indeed, one can easily avoid specifying C φφ
denotes the Fourier transform of C (0)(x) from (3).

k by instead deﬁning C ZZm

k where C ZZm

to be (2π)d/2C (0)

+ C NN

The normalizing constant A(cid:96) is completely determined by the weights used on the terms Z obs

k+(cid:96)Z obs−k
through the requirement that ˆφ(cid:96) be unbiased up to ﬁrst order in φ, in particular, requiring that
E( ˆφ(cid:96)) = φ(cid:96) + O(φ2) + O(φ3) + ··· or equivalently that 1
E( ˆφ(cid:96)) = 1 + O(φ) + O(φ2) + ··· . This
results in the following an analytic characterization for A(cid:96)

φ(cid:96)

k

k

k

(cid:90) (cid:12)(cid:12)ξ(cid:96)·C(1)

A(cid:96)

k − ξ(cid:96)·C(1)
k+(cid:96) C ZZobs

C ZZobs

k

k+(cid:96)

dk

(2π)d/2

= 1 + O(φ) + O(φ2) + ··· .

(6)

(cid:12)(cid:12)2

(cid:90)

Notice also that one is free to manually change weights used on each term Z obs
k+(cid:96)Z obs−k in (5). This may
be advantageous for optimizing the sampling behavior of ˆφ(cid:96) to speciﬁc applications. For example one
may want to down-weight corrupted frequencies in a particular experimental setting. In this case,
however, the form of the normalizing constant A(cid:96) given in (6) will need to be adjusted accordingly.
One of the advantages of the estimator ˆφ(cid:96), deﬁned in (5), is that there exists a fast algorithm for
computing ˆφ(cid:96) at all frequencies (cid:96) simultaneously by alternating pointwise operations in the Fourier
domain and the pixel domain. Indeed by Claim 5 of Appendix A the quadratic estimate given in (5)
is equivalent to

d(cid:88)

p=1

ˆφ(cid:96) = A(cid:96)

∗
p,(cid:96)

ξ

e−ix·(cid:96)A (x)Bp(x)

dx

(cid:96) /C ZZobs

where A(cid:96) := Z obs
time (when observing Z obs on a grid of size n) by a sequence of fast Fourier transforms, inverse fast
Fourier transforms and pointwise operations.

and Bp,(cid:96) := i2 imag(C(1)

(cid:96) /C ZZobs

p,(cid:96))Z obs

(cid:96)

(cid:96)

(2π)d/2
which can be computed in O(n log(n))

(7)

Anderes and Guinness/Generalized quadratic estimate

7

The derivation above only depends on the local invariance property insofar as it is used to opti-
mize the weights in (5) and the resulting normalizing constant given in (7). Indeed, exactly similar ar-
guments can be made for deriving quadratic estimates of nonstationary models which are not locally
invariant, such as covariance functions of the form C θ(x, y) = K(x − y, θ(x) + θ(y)) for example.
The key difference is that the quadratic estimate ˆφ(cid:96) for models which are not locally invariant tend
to either have a large O(φ2) + O(φ3) + ··· bias, small signal to noise ratio, or have signiﬁcant non-
Gaussian estimation variability. Local invariant models, in contrast, encourage a signiﬁcant amount
of cancellation occurring within O(φ2) + O(φ3) + ··· so that bias is small even in the regime of mod-
erately large signal to noise ratio. Moreover, small higher order terms provide a regime where mean
square estimation variability is accurately approximated with easily computable formulas. This is
explored in more detail in Section 2.3 and in the simulation examples presented later.

2.2. The Hu and Okamoto lensing estimate as a special case of ˆφ(cid:96)
In this section we show that ˆφ(cid:96), derived in the previous section, is an extension of the original
quadratic estimate developed in [10, 11] for Cosmic Microwave Background gravitational lensing.
Start by letting Z(x) = T (x + ∇φ(x)) denote the lensed Cosmic Microwave Background and φ(x)
denote the projected gravitational potential in the R2 ﬂat sky approximation. In the original deriva-
tion [10, 11] a Taylor approximation is ﬁrst applied to T (x + ∇φ(x)) as follows

the term(cid:0)∇T (x) · ∇φ(x)(cid:1)(cid:0)∇T (y) · ∇φ(y)(cid:1) which is quadratic in φ. Taking Fourier transforms, then

The above linear model is then used to linearly approximate Z(x)Z(y) by additionally discarding

Z(x) ≈ T (x) + ∇T (x) · ∇φ(x)

an expected value, results in the following approximation

(8)

(9)

(cid:16)

(cid:17)

.

E(Zk+(cid:96)Z−k) ≈ φ(cid:96)
2π

(cid:96) · (k + (cid:96))C T T

k+(cid:96) − (cid:96) · kC T T

k

k .
2π C T T

Notice that (9) is a special case of (4), and hence a special case of ˆφ(cid:96) in (5), when setting ξ(cid:96) = i(cid:96) and
C(1)

k = ik
It is important to notice a particular subtlety when analyzing the accuracy of (9) in terms of the
magnitude of the discarded terms in the Taylor approximation (8). This subtlety can be illustrated by
assuming the displacement ∇φ(x) is extremely large and happens to be a constant function of x. In
this case one clearly has Z(x) (cid:54)≈ T (x), i.e. the zeroth order Taylor approximation completely breaks
down. Yet, in a distributional sense, the zeroth order Taylor approximation is perfect since Z(x) and
T (x) have the same ﬁnite dimensional distributions (by the fact that T (x) is isotropic and ∇φ(x) is
assumed to be constant). Therefore one can not quantify the accuracy of (9) by a map level analysis
of the individual discarded terms in (8). In fact we propose that (9) is accurate, not because the map
level Taylor approximation (8) is good (for which it is not), but rather because ∇φ(x) is a locally
invariant parameter and the corresponding nonstationary covariance

C θ(x, y) = E(Z(x)Z(y)) = C T (x − y + ∇φ(x) − ∇φ(y))

has an accurate Taylor approximation in ∇φ(x) − ∇φ(y), vis-`a-vis (3).

2.3. Variance and bias analytic approximation
In Section 2.1 a fast formula was derived for computing the estimate ˆφ(cid:96) when observing a single
realization of Z obs(x). The speed at which ˆφ(cid:96) can be computed on a dense observation grid makes
it possible to perform large scale Monte Carlo analysis on ˆφ(cid:96) in any experimental setting for which
Z obs(x) can be easily simulated. In this section we complement a simulation-based method of uncer-
tainty quantiﬁcation by providing analytic approximations to variance and second order bias of ˆφ(cid:96).

Anderes and Guinness/Generalized quadratic estimate

8

These approximations are often very accurate and inherit a similar Fourier representation as (7) for
fast computation.

By inspection of (5) one can consider ˆφ(cid:96) as a function of the quadratic form Z obs
k+(cid:96)Z obs−k , integrating
over the variable k. In what follows we will consider the sampling behavior of ˆφ(cid:96) when replacing
k+(cid:96)Z obs−k by some other function Xk,(cid:96) of two variables k, (cid:96) ∈ Rd. The following deﬁnition sets no-
Z obs
tation for this operation which is useful for denoting terms which are related to variance and bias of
the estimator ˆφ(cid:96) derived in subsections 2.3.1 and 2.3.2.
Deﬁnition 2. For any function Xk,(cid:96) : Rd × Rd → C let ˆφ(cid:96){Xk,(cid:96)} denote the quadratic estimate ˆφ(cid:96) deﬁned
k+(cid:96)Z obs−k . In particular ˆφ(cid:96){Xk,(cid:96)} is a function of (cid:96) and
in (5) but applied to the function Xk,(cid:96) rather than Z obs
satisﬁes

ˆφ(cid:96){Xk,(cid:96)} := A(cid:96)

ξ(cid:96)·C(1)

k − ξ(cid:96)·C(1)

k+(cid:96)

If, on the other hand, Xk and Yk are both functions of a single frequency argument k ∈ Rd then we deﬁne

(cid:90) (cid:16)
(cid:90) (cid:16)

Xk,(cid:96)

(cid:17)∗
(cid:17)∗ Xk+(cid:96)Y−k

C ZZobs

k+(cid:96) C ZZobs

k

C ZZobs

k+(cid:96) C ZZobs

k

dk

(2π)d/2

.

dk

(2π)d/2

.

ˆφ(cid:96){X,Y } := A(cid:96)

ξ(cid:96)·C(1)

k − ξ(cid:96)·C(1)

k+(cid:96)

In the following two sections we derive approximations to the mean squared error and bias when
using ˆφ(cid:96) to estimate φ(cid:96). This comes in the form of two functions Cvar ˆφ
which represent
approximations to the spectral density of variance and bias after marginalizing over the unknown
φ(cid:96) using the Gaussian random ﬁeld prior given in Assumption 3.

and Cbias ˆφ

(cid:96)

(cid:96)

(cid:96)

2.3.1. Variance spectral density Cvar ˆφ
There are two main contributions to the variability in ˆφ(cid:96). The ﬁrst source of variability is due to the
additive observational noise N (x). The second source, sometimes called shape noise in Cosmology,
is due to the baseline stationary ﬂuctuations in Z(x) characterized by the autocovariance function
K(x − y, 0). The spectral density of this shape noise can be approximated by (2π)d/2C (0)
, which
corresponds to the zeroth order approximation in (3), or by C ZZm
which denotes the spectral density
of Z(x) marginalized over the prior from Assumption 3. Both these approximations can be used,
within the formulas derived below, to give accurate approximations to the mean squared variability
in ˆφ(cid:96). However, in the cosmology literature on gravitational lensing, the marginal stationary model
for Z(x) is typically used, rather than (2π)d/2C (0)

, for shape noise quantiﬁcation.

(cid:96)

(cid:96)

To derive Cvar ˆφ

(cid:96)

ﬁrst let X(x) denote the mean zero stationary Gaussian random ﬁeld which mod-
els the sum of the observational noise N (x) and the shape noise discussed in the previous paragraph.
By propagating the random ﬁeld X through the quadratic estimate one obtains an estimate of vari-
ability of ˆφ(cid:96) around its expected value. In particular

E(cid:0)(cid:2) ˆφ(cid:96) − E( ˆφ(cid:96))(cid:3)(cid:2) ˆφ(cid:96)(cid:48) − E( ˆφ(cid:96)(cid:48))(cid:3)∗(cid:1) ≈ E(cid:0) ˆφ(cid:96){X,X} ˆφ(cid:96)(cid:48){X,X}∗(cid:1) =: δ(cid:96)−(cid:96)(cid:48)Cvar ˆφ

(10)

(cid:96)

(cid:96)

where the existence of the spectral density Cvar ˆφ
is guaranteed by the fact that X(x) is stationary so
that ˆφ(cid:96){X, X} is stationary in the pixel domain (see Claim 6). Depending on which approximation
one uses for the baseline stationary ﬂuctuations in Z(x), the spectral density of X(x) can be deﬁned
in one of the following two ways

(cid:96)

(cid:40)

C XX

(cid:96) =

(cid:96) + (2π)d/2C (0)
C NN
(cid:96) + C ZZm
C NN

,

(cid:96)

(cid:96)

, option 1;
option 2.

(11)

Anderes and Guinness/Generalized quadratic estimate

Now given C XX

(cid:96)

, Claim 6 establishes that

(cid:90) (cid:12)(cid:12)(cid:12)ξ(cid:96)·C(1)

Cvar ˆφ

(cid:96)

= 2A2
(cid:96)

k − ξ(cid:96)·C(1)

k+(cid:96)

(cid:12)(cid:12)(cid:12)2 C XX

k+(cid:96)
(C ZZobs

k+(cid:96)

)2

C XX
(C ZZobs

k

k

9

(12)

dk
(2π)d .

)2

In certain situations the right hand side of (12) can be simpliﬁed. Recall that in the deﬁnition of ˆφ(cid:96),
(cid:96) + (2π)d/2C (0)
one has two options for deﬁning C ZZobs
, depending on if
one wants to use the prior spectral density C φφ
for optimizing the quadratic estimate weights. If the
choice of C ZZobs

(cid:96)
then one obtains the following simpliﬁcation of (12)

(cid:96) + C ZZm

, either C NN

(cid:96) or C NN

(cid:96)

(cid:96)

(cid:96)

matches the choice of C XX
Cvar ˆφ

(cid:96)

(cid:96)

= 2(2π)

−d/2A(cid:96).

(13)

It should be noted that when marginalizing over the prior given in Assumption 3 the process Z(x)
becomes stationary but non-Gaussian. On the other hand, when conditioning on φ, the process Z(x)
is Gaussian but nonstationary. Therefore, when using option 2 in equation (11) to model Cvar ˆφ
, the
approximation in (10) includes a Gaussian approximation to X(x). Finally, we mention that Claim 6
also gives a Fourier based characterization for fast computation of Cvar ˆφ

.

(cid:96)

(cid:96)

2.3.2. Bias spectral density Cbias ˆφ
The higher order terms O(φn) in (3) are the exclusive source of bias in the quadratic estimate. The
relation between O(φn) and estimation bias can be written as follows

(cid:96)

(cid:8)O(φ2)k+(cid:96),−k

(cid:9) + ˆφ(cid:96)

(cid:8)O(φ3)k+(cid:96),−k

(cid:9) + ···

E( ˆφ(cid:96)|φ) − φ(cid:96) = ˆφ(cid:96)

where O(φn)k+(cid:96),−k is deﬁned to be Fourier transform of O(φn)(x, y), deﬁned in (3), and evaluated
at frequencies k + (cid:96) and −k, respectively. For the local invariant models we consider here, the second
order bias term has the following form

O(φ2)(x, y) = (θ(x) − θ(y))T C(2)(x − y)(θ(x) − θ(y))

(14)
where C(2) : Rd → Rd×d is a symmetric function about the origin. This expression makes it clear how
local invariant nonstationarity encourages low quadratic estimation bias. When the observational
noise level is small, the high frequency ﬂuctuations in the observations Z obs(x) are more inﬂuential
to the quadratic estimate. At these small scales the smoothness of θ(x) and the function C(2)(x − y)
will attenuate the inﬂuence of O(φ2) when propagated through ˆφ(cid:96).

For remainder of this section we analyze how the second order term (14) propagates to second
. Claim 7 in the Appendix gives the following

order bias in the quadratic estimate, denoted ˆφbias
expression for ˆφbias

(cid:96)

(cid:96)

(cid:8)O(φ2)k+(cid:96),−k

(cid:9) = 2

(cid:90)

d(cid:88)

(cid:8)C(2)

p,q,k − C(2)

(cid:9) dω

ˆφbias
(cid:96) = ˆφ(cid:96)

Moreover the marginal expected value of this bias term satisﬁes E(cid:0) ˆφbias

θp,ωθq,(cid:96)−ω

p,q=1

ˆφ(cid:96)

.

p,q,k+ω

(2π)d/2

(cid:1) = 0 when (cid:96) (cid:54)= 0. Therefore,

(15)

to quantify the marginal magnitude of the second order bias one must use the variance of (15). This
is done in Claim 7 which establishes that when θ(x) is a mean zero Gaussian random ﬁeld with
spectral density matrix C θθ
(cid:96)

the corresponding spectral density for ˆφbias

, denoted Cbias ˆφ

, satisﬁes

(cid:96)

(cid:96)

(cid:96)

d(cid:88)

(cid:90) (cid:16)

Cbias ˆφ

(cid:96)

= 4

p,q,p(cid:48),q(cid:48)=1

C θθ

p,p(cid:48),ωC θθ

q,q(cid:48),(cid:96)−ω + C θθ

p,q(cid:48),ωC θθ

q,p(cid:48),(cid:96)−ω

(cid:8)C(2)

× ˆφ(cid:96)

p,q,k − C(2)

p,q,k+ω

p(cid:48),q(cid:48),k − C(2)

p(cid:48),q(cid:48),k+ω

(cid:9)∗ dω

(2π)d

(16)

(cid:17)
(cid:9) ˆφ(cid:96)
(cid:8)C(2)

Anderes and Guinness/Generalized quadratic estimate

10

(cid:96)

(cid:96)

when (cid:96) (cid:54)= 0. Notice that ˆφbias
equals the exact, map level, bias contribution from the second order
term O(φ2). Therefore the statement that Cbias ˆφ
is an approximation to the second order bias only
refers to the fact that it marginally quantiﬁes the impact of the second order term O(φ2) rather than
the all order bias O(φ2) + O(φ3) + ··· .

(cid:96)

(cid:96)

In contrast to Cvar ˆφ

(cid:96)

p,q,kω + 1

2 ωT∇2C(2)

(cid:8)C(2)

, which can be computed quickly using forward and inverse Fourier trans-
formations, the calculation of Cbias ˆφ
appears to require explicit looping over ω for each (cid:96). This is
problematic when Z(x) is observed on a high dimensional dense grid. However, there is an approx-
imation to Cbias ˆφ
which is both fast and yields excellent numerical accuracy for frequencies (cid:96) with
small to moderate magnitude. The approximation is derived with a second order Taylor approxima-
p,q,k + ∇C(2)
p,q,k+ω ≈ C(2)
tion C(2)
p,q,k − C(2)
ˆφ(cid:96)

(cid:9) ω − 1
(cid:9) only need to be computed once and can

The advantage being that ˆφ(cid:96)
therefore be factored out of the integral (16). The factored integral is then recognized as a convolu-
tion which can be quickly computed using forward and inverse Fourier transforms. The quality of
the approximation to Cbias ˆφ
is illustrated in Section 3.3 where simulations are done on a sufﬁciently
coarse grid to allow a comparison of both Cbias ˆφ
and the fast approximation. In Section 3.4, how-
ever, simulations are done on a two dimensional grid which is dense enough to necessitate the fast
approximation to Cbias ˆφ

(cid:8)∇C(2)
(cid:8)∇2C(2)

(cid:9) ≈ − ˆφ(cid:96)
(cid:9) and ˆφ(cid:96)

(cid:8)∇2C(2)

(cid:8)∇C(2)

p,q,kω so that

(cid:9) ω.

2 ωT ˆφ(cid:96)

(cid:96)

.

(17)

p,q,k+ω

p,q,k

p,q,k

p,q,k

p,q,k

(cid:96)

(cid:96)

2.4. An illustration of the bias reduction due to local invariance
k , C(1)
In this section we give an example of two stochastic processes with nearly the same values of C(0)
k
and C(2)
k , discussed above, but where one process is not locally invariant. A quadratic estimate of
nonstationarity is derived for both models and the resulting bias of each is compared. The main con-
clusion is that a small deviation from the locally invariant structure results in a bias that is orders of
magnitude larger than what is found in the local invariant model.

Consider the following two periodic nonstationary stochastic processes1 on [−π, π)

(cid:90)

eitkeiφ(t)k(cid:112)

Z(t) :=

Ck

dBk√
2π

,

(cid:90)

(cid:101)Z(t) :=

eitkeφ(t)|k|(cid:112)

Ck

dBk√
2π

(18)

where dBk is complex Gaussian white noise, Ck is the Mat´ern spectral density with parameters
ν = 2, ρ = 0.025, σ = 1 (using parameterization given in equation (33) of [22]), C φφ
is the Mat´ern
k
spectral density with parameters ν = 3, ρ = 2π/10, σ = 0.03. Notice that Z(t) has a local invariant

nonstationarity, whereas (cid:101)Z(t) does not. Indeed the analog to expansion (3) for the two covariance

structures is given by

cov(Z(t), Z(s)) = C (0)(t−s) +(cid:0)φ(t) − φ(s)(cid:1) C (1)(t−s)
cov((cid:101)Z(t),(cid:101)Z(s)) = C (0)(t−s) +(cid:0)φ(t) + φ(s)(cid:1) (cid:101)C (1)(t−s)

+(cid:0)φ(t) − φ(s)(cid:1)2
+(cid:0)φ(t) + φ(s)(cid:1)2(cid:101)C (2)(t−s) + O(φ3)

C (2)(t−s) + O(φ3)

k and (cid:101)C (2)

where (cid:101)C (1)
:= −C (2)
k .
Moreover, due to the periodic nature of Z(t) and ˜Z(t), our notation dictates(cid:82) ≡(cid:80)

:= |C (1)
k |,

(cid:101)C (1)

(cid:101)C (2)

k

k

k are related to the corresponding local invariant terms as follows

k∈Z in (18).

1We follow our notational convention and use non-bold symbols in this section to indicate scalar quantities for d = 1.

(19)

(20)

(21)

Anderes and Guinness/Generalized quadratic estimate

11

.

k+(cid:96)

(cid:17)

approximation

(cid:101)φ(cid:96) := (cid:101)A(cid:96)

(cid:90) (cid:16)(cid:101)C (1)

observational noise (so that C NN

The quadratic estimate ˆφ(cid:96) based on the observed local invariant process Z obs(t) = Z(t), without
on observations (cid:101)Z obs(t) = (cid:101)Z(t) ﬁrst notice that one can use the expansion (20) to derive the following
(cid:96) ≡ 0), is deﬁned by (5). To construct a quadratic estimate of φ(cid:96) based

This is similar to (4) with the exception of one sign change necessary to accommodate the non local

(cid:16)(cid:101)C (1)
(cid:1) ≈ φ(cid:96)
k + (cid:101)C (1)
invariant structure in (cid:101)Z. The above approximation can now be used to deﬁne the following quadratic
estimate of φ(cid:96), denoted(cid:101)φ(cid:96), from observations (cid:101)Z obs(t)
(cid:17)∗
k + (cid:101)C (1)

E(cid:0)(cid:101)Zk+(cid:96)(cid:101)Z−k

sign. Moreover, the approximations given in Sections 2.3.1 and 2.3.2 can be similarly modiﬁed—just
changing the negative sign in (15) and in the deﬁnition of Cvar ˆφ
(cid:96) —to produce analogous approxima-

where (cid:101)A(cid:96) is deﬁned just as in (6) with the exception that the minus sign is switched to a plus
tions for the variance and bias of(cid:101)φ(cid:96), denoted Cvar(cid:101)φ
mate ˆφ(cid:96) (shown at left) compared to the non local invariant estimate (cid:101)φ(cid:96) (shown at right). The left
shows (cid:96)2Cvar(cid:101)φ

(solid-green and dashed-red, respectively) whereas the right plot
(cid:96)
(solid-green and dashed-red, respectively). Both plots use the same axis
range and additionally show the signal spectral density (cid:96)2C φφ
(dotted line) for comparison of the re-
spective signal to noise ratios. Note that all spectral densities shown are multiplied by (cid:96)2 to improve
the visualization of the high frequency power.

Figure 1 shows the second order bias and variance approximation for the local invariant esti-

and (cid:96)2Cbias(cid:101)φ

k+(cid:96)(cid:101)Z obs−k
(cid:101)Z obs
(cid:101)C ZZobs
(cid:101)C ZZobs

and Cbias(cid:101)φ

plot shows (cid:96)2Cvar ˆφ

and (cid:96)2Cbias ˆφ

respectively.

dk√
2π

k+(cid:96)

k+(cid:96)

k

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(dashed-red) and the signal (cid:96)2Cφφ

FIG 1. These plots are intended to give an illustration of the bias attenuation effect of the local invariant covariance structure (the speciﬁcs
of the models are given in Section 2.4). The plot at left corresponds to the local invariant model and show estimation variance (cid:96)2Cvar ˆφ
(solid-green), bias (cid:96)2Cbias ˆφ
(dotted-black). In contrast the plot at right shows their non local
invariant counterparts. Notice that the locally invariant second order bias is orders of magnitude smaller than the corresponding non local
invariant bias, even though the functions C(1)

The main conclusion from Figure 1 is that, even though the functions (cid:101)C (1)

are similar to their non local invariant counterparts (cid:101)C(1)
k and (cid:101)C (2)

k are very sim-
ilar to their locally invariant counterparts, the local invariant model results in quadratic estimation

and (cid:101)C(2)

and C(2)

k .

k

k

k

(cid:96)

(cid:96)

100101102frequency10-910-810-710-610-510-410-310-210-1100101spectral densityLocal invariant modelsignal spectral densitybias spectral densityvariance spectral density100101102frequency10-910-810-710-610-510-410-310-210-1100101spectral densityNon local invariant modelAnderes and Guinness/Generalized quadratic estimate

12

bias that is orders of magnitude smaller than the corresponding non local invariant estimation bias.
Indeed at most small frequencies (cid:96) one has

(cid:96) (cid:28) min(C φφ
Cbias ˆφ
Cbias(cid:101)φ
(cid:96) (cid:29) max(C φφ

(cid:96)

(cid:96)

)

(cid:96)

, Cvar ˆφ

, Cvar(cid:101)φ

(cid:96)

).

Figure 1 also shows that for small (cid:96), the signal to noise ratio C φφ
is large enough to suggest
ˆφ(t) will be successful at tracking the large scale features of φ(t). Moreover, even at large (cid:96), where the
signal to noise ratio for ˆφ(cid:96) is small, the fact that the bias is sub-dominant to the signal implies that
detection of C φφ
is possible by averaging over a large number of frequencies to attenuate the impact
of Cvar ˆφ

.

(cid:96)

(cid:96) /Cvar ˆφ

(cid:96)

(cid:96)

3. Nonstationary spectral phase model

(cid:96)

(cid:96)

and Cbias ˆφ

In this section we specialize the results of the previous section to random ﬁelds which have a par-
ticular form: nonstationary spectral phase random ﬁelds. These models are locally invariant (c.f.
Deﬁnition 1) and can be viewed as generalized warping models which are amenable to quadratic es-
timates. The general formulas for ˆφ(cid:96), Cvar ˆφ
, given in the previous section, are derived for
the nonstationary spectral phase model to yield exact formulas. In subsection 3.1 we present a char-
acterization of the local spectral densities for nonstationary spectral phase models using the theory
of optimal transport and the L2-Wasserstein metric. In subsection 3.2 we present informal guidance
for specifying some of the modeling parameters of the nonstationary models presented here. Finally,
in sections 3.3 and 3.4, we present a set of simulations which demonstrate the quadratic estimate and
the accuracy of our approximation to the mean squared sampling properties.
Deﬁnition 3. A real random ﬁeld Z(x) on Rd is said to be a nonstationary spectral phase random ﬁeld
if there exists functions Ck : Rd → R+, θ(x) : Rd → Rd and ηk : Rd → Rd such that Ck has ﬁnite L1(Rd)
(cid:90)
norm, C−k = Ck, η−k = −ηk and

exp(cid:0)ix · k(cid:1) exp(cid:0)iθ(x) · ηk

(cid:1)(cid:112)

Z(x) =

(22)

Ck

dWk

(2π)d/2

where dWk denotes a complex Gaussian white noise random measure on Rd which satisﬁes E|dWk|2 = dk.
The covariance function C θ(x, y) := cov(Z(x), Z(y)) for the random ﬁeld deﬁned by (22), condi-

tioning on ηk and θ(x), can be computed as follows

(cid:90)

exp(cid:0)i(x − y) · k(cid:1) exp(cid:0)i(θ(x) − θ(y)) · ηk

(cid:1) Ck

C θ(x, y) =

dk
(2π)d .

(23)

The fact that C θ(x, y) can be written as a function of x − y and θ(x) − θ(y) implies that Z(x) has
the local invariant property (see Deﬁnition 1) with respect to the nonstationarity characterized by
θ(x). By assuming ηk is known and θ(x) is characterized by a scalar potential φ(x) : Rd → R (see
Assumption 2) the results of Section 2.1 can be applied to generate a quadratic estimate ˆφ(cid:96) based on a
single realization of Z(x) with additive stationary noise. Indeed, by expanding exp(i(θ(x)−θ(y))·ηk)
in (23), to second order, one obtains the following expression for the terms in (3) and (14)

C (0)

k =

Ck

(2π)d/2

,

C(1)

k =

iηkCk
(2π)d/2

,

k = − ηkηT
C(2)

k Ck
2(2π)d/2

.

(24)

Anderes and Guinness/Generalized quadratic estimate

13

The last ingredient needed for computing ˆφ(cid:96), Cvar ˆφ
is an expression for the marginal
spectral density of the observed ﬁeld Z obs(x) := Z(x) + N (x), denoted C ZZobs
in Section 2.1. Notice
that Assumption 3 guarantees that θ(x) is a stationary mean zero Gaussian random ﬁeld. Therefore

and Cbias ˆφ

k

(cid:96)

(cid:96)

E(cid:0) exp(i(θ(x) − θ(y)) · ηk)(cid:1) = exp(cid:0)− 1

k Σ(x − y)ηk

2 ηT

where Σ(x−y) is the covariance matrix of θ(x)−θ(y). This implies that the marginal spectral density
of the observations has the form

C ZZobs

k

= (2π)d/2C Zm

k + C N N

k

(25)

where C Zm

k

is the Fourier transform of the marginal auto covariance of Z(x) and is given by

(cid:1)

(cid:1) Ck

(cid:90)

exp(i(x − y) · k) exp(cid:0)− 1

C Zm(x − y) =

k Σ(x − y)ηk

2 ηT

dk
(2π)d .

Now the expressions for C ZZobs
estimate ˆφ(cid:96), the second order bias spectral density Cbias ˆφ
ance characterized by Cvar ˆφ

derived in Section 2.1.

k and C(2)

, C(1)

k

(cid:96)

(cid:96)

k given in (24) and (25) completely deﬁne the quadratic
and the approximation to estimation vari-

3.1. Locally attainable spectral densities
In this section we investigate the set of possible local spectral densities, for different values of the
nonstationary function θ(x), under the nonstationary spectral phase random ﬁeld model of Z(x).
Since the nonstationarity in Z(x) is exclusively due to local variation of a spectral phase, there is
signiﬁcant restriction on how local spectral densities can vary with x. For example, one can easily
see that all the local spectral densities of Z(x) must have the same integral (so that the pointwise
variance of Z(x) is a constant function of x). In what follows we characterize further restrictions
and, in doing so, identify a second source of estimation bias due to the curved nature of the local
spectral models. The theory of optimal transport and the L2-Wasserstein metric play an important
role in the characterization of local stationary models. We refer the reader to the excellent book [25]
for an overview of the subject.

The local invariance property of nonstationary spectral phase models implies that the local distri-
bution of Z(x) is invariant to changes in the magnitude of θ(x). However, the local behavior of Z(x)
is sensitive to the gradient of θ(x). In particular, suppose θ(x) has the form Ax + b where A ∈ Rd×d
and b ∈ Rd. In this case the covariance function C θ(x, y) is still invariant to changes in b ∈ Rd but is
sensitive to changes in A ∈ Rd×d. Indeed assuming θ(x) = Ax + b one has

(cid:90)

exp(cid:0)i(x − y)·(k + AT ηk)(cid:1) Ck

(cid:90)

exp(cid:0)i(x − y)·ω(cid:1) dλ(ω)

(2π)d

dk
(2π)d =

C θ(x, y) =

(26)

where λ is the spectral measure obtained by a change of variables ω = k + AT ηk (under appropriate
measurability assumptions on ηk) Therefore when θ(x) = Ax + b in a local neighborhood about x
the process Z(x) becomes locally stationary with local spectral measure given by λ.
The optimal transport literature uses the notation v (cid:93) λ(B) := λ(v−1(B)) to denote the push for-
ward of a measure λ on Rd under a measurable transformation vk : Rd → Rd. For our needs it will be
useful to extend this deﬁnition to spectral measures λ which have a spectral density Ck with respect
to Lebesgue measure on Rd. In particular we let vk (cid:93) Ck denote the push forward of the measure
Ckdk under the transformation vk. This notation allows one to easily express the spectral measure λ
in (26) as

λ = (k + AT ηk) (cid:93) Ck

and, in doing so, creates a succinct notation for the collection of locally attainable spectral measures
deﬁned as follows.

Anderes and Guinness/Generalized quadratic estimate

14

Deﬁnition 4. Suppose Z(x) is a nonstationary spectral phase random ﬁeld on Rd satisfying Deﬁnition 3.
The family of locally attainable spectral measures for Z(x) is deﬁned to be the collection of measures

C C,η :=(cid:8)(k + AT ηk) (cid:93) Ck : A ∈ Rd×d(cid:9)

so that for each λ ∈ C C,η there exists a matrix A such that when θ(x) = Ax the random ﬁeld Z(x) becomes
stationary with spectral measure λ.

Notice that, depending on ξ, there may a restriction on the possible matrices A which can satisfy
θ(x) = Ax. This will further limit the set of attainable local spectral densities but is not included in
the deﬁnition of C C,η. The role of ξ, in terms of modeling Z(x), is discussed in Section 3.2 below.

The following claim shows that given any two spectral densities Ck and ˜Ck with ﬁnite second
moments and the same L1(Rd) integral, there exists a nonstationary spectral phase random ﬁeld Z(x)
which has both Ck and ˜Ck as locally attainable spectral densities (i.e. Ck, ˜Ck ∈ C C,η). Moreover, each
measure contained in the L2-Wasserstein geodesic connecting Ckdk to ˜Ckdk is also locally attainable
by Z(x).
Claim 1 (Any pair of spectral densities with the same integral are attainable). Let d ≥ 1 be an
integer, t0 > 0 be a real number and Ck, ˜Ck be two spectral densities on Rd with ﬁnite second moments such
˜Ckdk. Then there exists a vector ﬁeld ηk : Rd → Rd which is L2(Rd) integrable
with respect to Ckdk and generates a one dimensional curve of spectral measures {λ(t) : t ∈ [0, t0]}, deﬁned
by

Rd Ckdk =(cid:82)

that σ2 =(cid:82)

Rd

λ(t) := (k + tηk) (cid:93) Ck

(27)
with endpoints λ(0) = Ckdk and λ(t0) = ˜Ckdk, such that {λ(t) : t ∈ [0, t0]} ⊂ C C,η. In particular there
exists a nonstationary spectral phase random ﬁeld model for which Ck and ˜Ck are both locally attainable.
Moreover, {λ(t) : t ∈ [0, t0]} is a L2-Wasserstein geodesic path within the class of absolutely continuous
spectral measures (with total mass σ2 and ﬁnite second moments) and each measure λ(t) has a density C (t)
k
with respect to Lebesgue measure on Rd which (weakly) satisﬁes

∂tC (t)

k + div(η(t)

k C (t)

k ) = 0

(28)

k := ηT

for all t ∈ [0, t0] where η(t)
Proof. By standard optimal transport theory (see [25] for example) the assumptions on Ck and ˜Ck
guarantee the existence of a convex function ψk : Rd → R such that ∇ψk is the optimal transport
from Ckdk to ˜Ckdk. Let ηk := 1
t0

(k) and Tt(k) := k + tηk.

(∇ψk − k) so that

−1
t

λ(t) := (k + tηk) (cid:93) Ck =(cid:0)(1 − t

)k + t
t0

∇ψk

t0

(cid:1) (cid:93) Ck.

(29)

The particular form of the right hand side of (29) implies each measure λ(t) has a density C (t)
k with
respect to Lebesgue measure and the path of measures {λ(t) : t ∈ [0, t0]} forms an L2-Wasserstein
geodesic with endpoints Ckdk and ˜Ckdk at t = 0 and t = t0 respectively (see Proposition 5.9 in [25]).
Moreover, C (t)
k where
∂tTt(k) = ηk. By setting A = tI d in (26) one has

k weakly satisﬁes (28) by Theorem 5.34 of [25] and the fact that C (t)

k = Tt (cid:93) C (0)

(cid:90)

exp(cid:0)i(x − y)·(k + tηk)(cid:1) Ck

(cid:90)

exp(cid:0)i(x − y)·ω(cid:1) C (t)

ω

dω

(2π)d

dk
(2π)d =

which implies that for each t ∈ [0, t0] the measure λ(t) is a locally attainable spectral measure.

Isotropic spectral densities are an important special case for many statistical applications. The fol-
lowing claim allows considerable simpliﬁcation for the construction of the vector ﬁeld ηk guaranteed
by Claim 1.

k

1
t0

(30)

(cid:17)

σ2Γ(d/2)

ηk :=

(cid:82) r
0 ξd−1Cξdξ and ˜F (r) := 2πd/2

15
Claim 2 (Special case for isotropic spectral densities). Let d ≥ 1 be an integer, t0 > 0 be a real number
and C|k|, ˜C|k| be two isotropic spectral densities on Rd with ﬁnite second moments and total mass σ2. Deﬁne

Anderes and Guinness/Generalized quadratic estimate

(cid:16) ˜F −1 ◦ F (|k|)
|k| − k
(cid:82) r
0 ξd−1 ˜Cξdξ. Then for all t ∈ [0, t0], ηk gener-
where F (r) := 2πd/2
σ2Γ(d/2)
ates the spectral measures λ(t) := (k + tηk) (cid:93) C|k| deﬁned in Claim 1. In particular, {λ(t) : t ∈ [0, t0]} forms
a L2-Wasserstein geodesic path of locally attainable spectral densities in C C,η, with endpoints λ(0) = C|k|dk
and λ(t0) = ˜C|k|dk, where k + tηk is the optimal transport from λ(0) to λ(t).
Proof. By the proof of Claim 1 it will be sufﬁcient to show that ˜F −1◦F (|k|) k|k| is the optimal transport
from C|k| to ˜C|k|. Let K and ˜K be random vectors in Rd with densities C|k|/σ2 and ˜C|k|/σ2, respec-
tively. By the distributional rotational symmetry of K there exists a convex ψ(r) : R+ → R such that
∇(ψ(|k|)) = ψ(cid:48)(|k|) k|k| is the optimal transport from L K to L ˜K (where L K and L ˜K denotes the
law, i.e. probability distribution, of K). Also notice that ψ(cid:48)(r) is the optimal transport from L |K| to
L | ˜K| since ψ(r) is convex and

P (ψ(cid:48)(|K|) ≤ r) = P(cid:0)(cid:12)(cid:12)ψ(cid:48)(|K|) K|K|
The optimal transport between two univariate random variables (see [25]) is given by the composi-
(cid:82) r
tion of the quantile function (of the target measure) and the cumulative distribution function (of the
base measure). Therefore the optimal transport from L |K| to L | ˜K| is given by ˜F −1 ◦ F (r) where
0 ξd−1 ˜Cξdξ are the cumulative distribution func-
F (r) = 2πd/2
tions of |K| and | ˜K|, respectively. By the uniqueness of optimal transports one has ψ(cid:48)(r) = ˜F −1◦F (r)
and therefore

(cid:82) r
0 ξd−1Cξdξ and ˜F (r) = 2πd/2

(cid:12)(cid:12) ≤ r(cid:1) = P (| ˜K| ≤ r).

σ2Γ(d/2)

σ2Γ(d/2)

∇(ψ(|k|)) = ψ(cid:48)(|k|)

k

|k| = ˜F −1 ◦ F (|k|)

k
|k|

is the optimal transport from L K to L ˜K, as was to be shown.

As a corollary to the above theorem one can obtain partial closed form solutions for ηk when the
spectral densities Ck and ˜Ck are both Mat´ern spectral densities with the same integral and with ﬁnite
second moments. The form of ηk, in this case, can be computed using the incomplete beta function
and the quantiles of beta random variables (which is not technically given in closed form but for
which simple Newton method characterizations are guaranteed to converge, see [8]).
Corollary 1 (Optimal transports between Mat´ern spectral densities). Let d ≥ 1 be an integer and
t0, ν, ˜ν, ρ, ˜ρ, σ2 > 0 be real numbers such that ν, ˜ν > 1. If

(cid:18) 4ν
(cid:18) 4˜ν

ρ2

(cid:19)ν(cid:18) 4ν
(cid:19)˜ν(cid:18) 4˜ν

˜ρ2

(cid:19)−ν−d/2
(cid:19)−˜ν−d/2

ρ2 + |k|2
˜ρ2 + |k|2
(cid:19)−1/2

− 1

(31)

(32)

(33)

(34)

C|k| = σ22dπd/2 Γ(ν + d/2)

Γ(ν)

˜C|k| = σ22dπd/2 Γ(˜ν + d/2)

Γ(˜ν)
then F and ˜F −1, deﬁned in Claim 2, are given by

F (r) = Ir2/(4ν/ρ2+r2)(d/2, ν)

(cid:18) 4˜ν

(cid:19)1/2(cid:18)

1

˜F −1(u) =

˜ρ2

Qu(d/2, ˜ν)

where Ix(p, q) is the incomplete beta function and Qu(p, q) is the quantile function for a univariate Beta(p, q)
random variable evaluated at u ∈ (0, 1).

Proof. First notice that (2π)dσ2 =(cid:82)

˜C|k|dk and the constraints ν, ˜ν > 1 are sufﬁcient
to ensure C|k| and ˜C|k| have ﬁnite second moments. Therefore Claim 2 applies. For any ν, a > 0, the
change of variables x = y2/(a + y2) gives

Rd

Anderes and Guinness/Generalized quadratic estimate

16

Rd C|k|dk =(cid:82)
(cid:90) r2

(cid:90) r

yd−1

(a + y2)ν+d/2

0

dy =

Therefore F (r) :=
mediately gives (33) an (34).

σ2(2π)dΓ(d/2)

2πd/2

a+r2

(1 − x)ν−1xd/2−1dx =

1
(cid:82) r
2aν
0 ξd−1Cξdξ = Ir2/(4ν/ρ2+r2)(d/2, ν) and similarly for ˜F (r). This im-

Ir2/(a+r2)(d/2, ν).

B(d/2, ν)

2aν

0

The Wasserstein structure of the locally attainable spectral models gives a convenient geometric
picture for potential difﬁculties when estimating local spectra in the nonstationary phase model. For
example, the space of probability distributions (with ﬁnite second moments) has positive curvature
(in the sense of Aleksandrov’s notion of metric curvature) under the L2-Wasserstein metric [1]. A
less precise mathematical illustration of this is the fact is that the two locally attainable spectra, (k +
AT ηk) (cid:93) Ck and (k − AT ηk) (cid:93) Ck, become asymptotically indistinguishable as the entries A become
arbitrarily large. Indeed, the probability distributions of K + AT ηK and K − AT ηK are similar
when K is a random vector with unnormalized density Ck and the magnitude of the entries of A are
large (since ηk has odd symmetry and Ck has even symmetric). One implication of this asymptotic
non-identiﬁability is that estimates of the local spectra can break down when θ(x) has large local
linear ﬂuctuations (i.e. when the entries of A are large) so that the two local models θ(x) = Ax + b
and θ(x) = −Ax + b are difﬁcult to distinguish from the data.

A possible numerical tool for probing this breakdown is to analyze the so called cut locus as-
sociated with L2-Wasserstein geodesics. Informally, the cut locus quantiﬁes the maximal extent of
geodesic paths emanating from some point. The cut locus of the geodesics emanating from Ckdk
can serve as a proxy for when curvature effects will corrupt local estimation of θ(x) due to the sim-
ilarity between the two local spectra characterized by the local linear models θ(x) = Ax + b and
θ(x) = −Ax + b. If the cut locus starting at Ckdk is far from Ckdk this implies the geodesic paths
are long and the entries of A need to be much larger for curvature difﬁculties to arise. In particular,
ﬁx A and consider the locally attainable models (k + cAT ηk) (cid:93) Ck indexed by c ∈ R. If there exists a
maximal c0 > 0 such that {(k+cAT ηk) (cid:93) Ck : c ∈ [0, c0]} and {(k+cAT ηk) (cid:93) Ck : c ∈ [−c0, 0]} are both
L2-Wasserstein geodesic, then nonstationary local linear models of the form θ(x) = ±cAx + b are
less exposed to curvature effects when |c| (cid:28) c0. Claim 3, below, allows one to numerically compute
the maximal such cutoff c0 which characterizes, what we call, the symmetric two sided cut locus.
Claim 3. Let d ≥ 1 be an integer, c0 > 0 be a real number, A ∈ Rd, Ck is a spectral density on Rd
with ﬁnite second moments and ηk : Rd → Rd which is L2(Rd) integrable with respect to Ckdk. Suppose
both k − c0AT ηk and k + c0AT ηk are C 1 diffeomorphisms which are gradients of convex functions. Then
{(k − cAT ηk) (cid:93) Ck : c ∈ [0, c0]} and {(k + cAT ηk) (cid:93) Ck : c ∈ [0, c0]} are paths of absolutely continuous
measures which are also L2-Wasserstein geodesics.
Proof. Let φk and ψk be convex functions deﬁned on Rd such that ∇φk = k − c0AT ηk and ∇ψk =
k + c0AT ηk. By the diffeomorphic assumption on k − c0AT ηk and k + c0AT ηk there exists two
spectral densities C (−c0)

and C (c0)

k which satisfy

k

Now for any c ∈ [0, c0] one has

C (−c0)
dk = (k − c0AT ηk) (cid:93) Ck
k
C (c0)
k dk = (k + c0AT ηk) (cid:93) Ck.

k − cAT ηk =(cid:0)1 − c
k + cAT ηk =(cid:0)1 − c

c0

c0

(cid:1)k + c
(cid:1)k + c

c0

c0

∇φk
∇ψk.

(35)
(36)

Anderes and Guinness/Generalized quadratic estimate

17
The explicit form of the right hand side of (35) and (36) imply {(k − cAT ηk) (cid:93) Ck : c ∈ [0, c0]} and
{(k + cAT ηk) (cid:93) Ck : c ∈ [0, c0]} are L2-Wasserstein geodesics of absolutely continuous measures,
connecting C (−c0)

k dk respectively (by Proposition 5.9 in [25]).

dk to Ckdk and Ckdk to C (c0)

k

3.2. Modeling ξk, Ck and ηk
In this section we give some informal guidance for specifying ξk, Ck and ηk in the nonstationary
spectral phase model (see Deﬁnition 3). Since the quadratic estimate is adept at detecting small de-
partures from stationarity—partly due to the accuracy of the variance calculations and the speed
at which the quadratic estimate can be simulated under a null stationary model—we focus on the
situation where the statistician wants to estimate or detect nonstationary extensions of a stationary
model. Further details of this approach can be found in the simulation sections 3.3 and 3.4.

Modeling Ck and ηk.
In sections 3.3 and 3.4 we model ηk implicitly by specifying two spectral
densities Ck, ˜Ck and require that they both be locally attainable in the nonstationary random ﬁeld
model (note: Ck and ˜Ck must have the same L1(Rd) integral). In other words we construct a vector
ﬁeld ηk from Ck and ˜Ck by requiring ˜Ck ∈ C C,η. The results of Section 3.1 show this is possible by
setting

(∇ψk − k)

1
t0

ηk :=

(37)
where ∇ψk is the optimal transport from Ck to ˜Ck and t0 > 0 is determined by the desired physical
units of θ(x) or is set to balance the bias and variance of the quadratic estimate (more on this in
the next paragraph). Corollary 1 seems particularity useful for this approach in that Ck can be de-
termined by an overall Mat´ern ﬁt and ˜Ck can be deﬁned by perturbing the Mat´ern parameters in a
direction of interest. For example, consider the case where one is interested in detecting nonstation-
arity arising from spatial variation in the Mat´ern smoothness parameter ν. Using the notation given
in Corollary 1 one could estimate σ2, ρ and ν (the parameters of Ck) by an overall stationary ﬁt, then
deﬁne ˜ν := ν +  and ˜ρ := ρ (the parameters of ˜Ck) for some  ∈ R.

Generally larger values of t0 or smaller values of  will increase estimation variance and decrease
estimation bias. We do not yet have a coherent story for the precise nature the dependence of bias
and variance as a function of t0 and . However, the cut locus of the L2-Wasserstein geodesics ema-
nating from Ck (discussed at the end of Section 3.1) can be a useful tool for probing this dependence.
For example, given t0 and  one can compute the maximal c0 which satisﬁes the antecedent of Claim
3. This maximal c0 effectively characterizes the symmetric two-sided cut locus (c.f. Claim 3) and heuris-
tically serves to characterize an upper bound on the magnitude of the entries of A, beyond which
bias is likely to dominate. This will be explored in more detail in Section 3.3 as a diagnostic tool for
determining values of t0 and  that result in large quadratic estimation bias.

Modeling ξk.
In some cases the spectral multiplier ξk will be constrained by the physics of a par-
ticular application. An example of such a constraint is that θ(x) be required to be curl free or diver-
gence free. Indeed, a curl free constraint is enforced in the gravitational lensing problem by setting
ξk = ik. In the absence of such constraints one can potentially use ξk to restrict the possible matrices

A which parameterize the locally attainable spectral models C C,η =(cid:8)(k + AT ηk) (cid:93) Ck : A ∈ Rd×d(cid:9).

If ξk := ik, for example, then A must be of the form (∂xp ∂xq φ(x))d
rotation matrix and Λ is a diagonal matrix with real entries.

p,q=1 = U ΛU T where U is a

3.3. Nonstationary phase example d = 1
In this section we present a simulation example to illustrate the quadratic estimate of θ(x), or equiv-
alently the potential φ(x), when observing a single realization of a nonstationary spectral phase

Anderes and Guinness/Generalized quadratic estimate

18

(cid:96)

(cid:96)

(cid:96)

random ﬁeld Z(x) in dimension d = 1 (c.f. Deﬁnition 3). According to our notational conventions,
vector quantities such as x, k, ξk, ηk, θ(x) are replaced with non-bold scalar notation x, k, ξk, ηk, θ(x)
to indicate scalar quantities for d = 1. There are multiple points we hope to convey with this exam-
ple. The ﬁrst is that the quadratic estimate ˆφ(cid:96), constructed to detect a spatially varying smoothness
parameter, is fast and accurate. The second point is that Cvar ˆφ
accurately quantify the em-
pirical variance and bias of ˆφ(cid:96). A third point is that the fast approximation to Cbias ˆφ
, discussed in the
last paragraph of Section 2.3.2, is accurate over a wide range of wave numbers. Finally we illustrate
qualitative features of the estimation bias which results when θ(cid:48)(x) is large enough to exceed the
symmetric two-sided cut locus discussed in Section 3.2 (c.f. Claim 3).

and Cbias ˆφ

Following the modeling approach outlined in Section 3.2 we ﬁrst deﬁne Ck to be the Mat´ern spec-
tral density given in (31) with parameters (ν, ρ, σ2) := (2, 0.05, 1). Now ηk is deﬁned implicitly by
specifying a second spectral density ˜Ck that is required to be locally attainable within the same non-
stationary phase model for Z(x). ˜Ck is deﬁned to be the Mat´ern spectral density given in (32) with
parameters (˜ν, ˜ρ, σ2) := (2.1, 0.05, 1). The variance parameter σ2 is the same for both Ck and ˜Ck as
per the necessary requirement for locally attainable spectral densities. Notice that the only difference
between the two Mat´ern models is the fractional smoothness parameter which is set to model non-
stationarity in the local smoothness in Z(x). The parameter t0 used in (37) to determine ηk is set to
1.5 for Figure 2 and 1.5/7 for Figure 3.

(cid:96)

, C (2)

, C (1)

and Cbias ˆφ

A single ground truth potential φ(x) is used throughout this section and was simulated from
a mean zero stationary Gaussian process with Mat´ern parameters (ν, ρ, σ2) := (5, 1.5, 152/(2π)4).
The spectral multiplier ξk is set to ik so that θ(x) = φ(cid:48)(x). The derivative θ(cid:48)(x), in particular φ(cid:48)(cid:48)(x),
is shown in blue in the middle plot of ﬁgures 2 and 3. The quantities C (0)
and C ZZobs
used to generate ˆφ(cid:96), Cvar ˆφ
are determined by (24) and (25). Finally, to avoid potential
aliasing issues in the simulated data Z obs(x), the quadratic estimate is set to ignore 10% of Fourier
coefﬁcients which are nearest the Nyquist limit by truncating the weights corresponding to those
frequency pairs.
The process Z(x) in this section is deﬁned on [−5, 5) with periodic boundary conditions. The
observed process Z obs(x) is simulated without additive noise on 104 evenly spaced observation lo-
cations in [−5, 5). A simple discrete Riemann sum approximation, at each observed x, was used to
approximate to the integral (22) to generate the simulation of Z obs(x). In general, this type of approx-
imation will result in aliasing errors. Generating a distributionally exact simulation of Z(x), without
any approximation, appears to be an open problem. It is not yet clear what impact the aliasing errors,
present in our simulation, have on the quadratic estimate. However, we found little empirical differ-
ence in the performance of the quadratic estimate when reducing the aliasing errors by increasing
the frequency upper limit used for the Riemann sum approximation.
Figure 2 shows the results of our simulation when t0 is set to 1.5. The top plot shows a simulation
of the nonstationary phase process Z(x). The blue line in the middle plot shows θ(cid:48)(x) along with 5
realizations of the quadratic estimate ˆθ(cid:48)(x), shown in grey, each one applied to an independent real-
ization of Z(x) with the same φ(x) . The dashed line in the middle plot shows an empirical estimate
to E(ˆθ(cid:48)(x)|φ) based on averaging the quadratic estimate applied to 100 independent realizations Z(x)
all simulated with the same nonstationary potential φ(x). On average, computing these 100 quadratic
estimates (each based on 104 observations) took 0.008 seconds on a 2013 MacBook Pro with a 2.3 GHz
Intel Core i7 CPU. This illustrates that the quadratic estimate can be computed extremely fast on a
dense set of observations. Notice also the estimate is accurate with respect to both variance and bias.
Indeed, by comparing signal spectral density (cid:96)2C φφ
(dotted black line in both bottom plots) with
(cid:96)2Cvar ˆφ
(green and red lines respectively) one can see that the signal-to-noise ratio for
estimation accuracy per-frequency is signiﬁcantly greater than 1 for a large range of wavenumbers.
The bottom two plots in Figure 2 show the accuracy of the analytic approximations (cid:96)2Cvar ˆφ
and
(cid:96)2Cbias ˆφ
for quantifying the empirical variance and bias (green and red dots respectively) computed

and (cid:96)2Cbias ˆφ

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

Anderes and Guinness/Generalized quadratic estimate

19

FIG 2. This ﬁgure shows a simulation of a nonstationary spectral phase random ﬁeld Z(x) (top), the quadratic estimate of θ(cid:48)(x) (middle)
and the spectral characterizations of estimation variance (bottom-left) and estimation bias (bottom-right). The details of the simulation
are given in Section 3.3. In the middle plot the blue line shows the value of θ(cid:48)(x) = φ(cid:48)(cid:48)(x) which characterizes the nonstationarity
in Z(x) through Deﬁnition 3, the grey lines show different quadratic estimates ˆθ(cid:48)(x) each one applied to an independent realizations of
Z(x) with the same θ(x) and the dashed line shows the empirical average of ˆθ(cid:48)(x) over 100 such realizations. In the bottom-left plot
The main purpose of this simulation is intended to illustrate the accuracy of the quadratic estimate and the ability of Cvar ˆφ
to
approximate the empirical variance and bias of the estimate. A secondary goal of this ﬁgure is to also show that the fast approximation to
Cbias ˆφ

is very accurate over a wide range of small wave numbers.

(cid:96)

(cid:96)

and Cbias ˆφ

(cid:96)

42024321012Nonstationary phase simulation4202421012Quadratic estimate, average quadratic estimate and the simulation truth θ0(x)ˆθ0(x)average ˆθ0(x)θ0(x)2468101214frequency ‘10-710-610-510-410-310-210-1Analytic vrs empirical bias spectra‘2Cbiasˆφ‘approx ‘2Cbiasˆφ‘‘2Cφφ‘‘2|φ‘−E(ˆφ‘)|2δ02468101214frequency ‘10-710-610-510-410-310-210-1spectral densityAnalytic vrs empirical variance spectra‘2Cvarˆφ‘‘2Cφφ‘‘2|E(ˆφ‘)−ˆφ‘|2δ0Anderes and Guinness/Generalized quadratic estimate

20

(cid:96)

(cid:96)

from the 100 realizations of ˆθ(cid:48)(x). The computation of Cvar ˆφ
took 0.098 seconds. The fast approxima-
tion to (cid:96)2Cbias ˆφ
is plotted with the dashed blue line in the bottom right plot. This approximation can
be seen to be very accurate, nearly indistinguishable from the red line, and took only 0.308 seconds
to compute (compared to 99.44 seconds for computing Cbias ˆφ

directly).

In Figure 3 we show another simulation which is similar the one shown in Figure 2 with the
exception that t0 is reduced from 1.5 to 1.5/7. This has the effect of shrinking the two-sided cut locus
(discussed in Section 3.2). This is equivalent to scaling φ(x) by a factor of 7 which has the effect of
dramatically increasing the bias in the quadratic estimate. Indeed, the main point of Figure 3 is to
illustrate the qualitative features of the quadratic estimate bias when φ(x) is too large for the linear
approximation in (3) to hold. Indeed, when the magnitude of the true θ(cid:48)(x) exceeds the two-sided
cut locus, the estimate ˆθ(cid:48)(x) transitions from a low bias estimate to a bias dominated one as seen in
the middle plot. This is presumably due to the ability of the two-sided cut locus to identify when
the geodesic path of local spectral densities begins to curl in on itself, creating an ill-posed inversion
from observed local spectral density to estimate φ(x).

(cid:96)

3.4. Nonstationary phase example d = 2
In this section we perform a simulation example to illustrate the quadratic estimate applied to a non-
stationary spectral phase random ﬁeld Z(x) in dimension d = 2. Besides the increase of dimension,
there are two main differences in this simulation as compared to the simulation given in Section 3.3.
The ﬁrst difference is that the spectral multiplier ξk is set to (ik2,−ik1)T where k = (k1, k2). There-
fore θ(x) = (∂x2φ(x),−∂x1φ(x))T is a divergent free vector ﬁeld. The second main difference is that
the two spectral densities Ck and ˜Ck, deﬁned by (31) and (32), have different Mat´ern parameter val-
ues as those used in Section 3.3. The parameter values for Ck are given by (ν, ρ, σ2) := (1.5, 0.015, 1)
and the parameter values for ˜Ck are given by (˜ν, ˜ρ, σ2) := (1.7, 0.014, 1). Recall that Ck and ˜Ck are
used to generate ηk (c.f. Section 3.2) by requiring both Ck and ˜Ck be locally attainable spectral mod-
els in Z(x). Therefore the corresponding quadratic estimate is tuned to detect not only a variation in
the smoothness of Z(x) but also a corresponding scale change, where the correspondence is related
inversely (an increase in smoothness corresponding to a reduction of spatial scale and vice versa).
For this simulation example, the process Z(x) is deﬁned on [−π, π)2 with periodic boundary con-
ditions and the observed process Z obs(x) is generated without additive noise on a evenly spaced
grid of size 400 × 400. Just as in Section 3.3, a simple discrete Riemann sum approximation, at each
observed x, was used to approximate to the integral (22) for generating the simulation of Z obs(x).
The ground truth potential φ(x), used to generate the nonstationarity in Z(x), is simulated from a
mean zero stationary Gaussian process with Mat´ern parameters (ν, ρ, σ2) := (5, 0.3π, 0.52). Just as
in Section 3.3 the quantities C (0)
are
determined by (24) and (25). Finally, the parameter t0 used in (37) to determine ηk is set to 1.5.

used to generate ˆφ(cid:96), Cvar ˆφ

and Cbias ˆφ

Figure 4 graphically summarizes the simulation results. The top left image shows the quadratic
estimate ˆφ(x) and the top right image shows the ground truth φ(x). These top images are intended
to illustrate the high accuracy of the estimate. The bottom right image shows the data Z obs(x) used
in the estimate ˆφ(x). The bottom left plot shows the radial proﬁle of |(cid:96)|2Cvar ˆφ
(solid green), |(cid:96)|2C φφ
(dotted black) along with the fast approximation to |(cid:96)|2Cbias ˆφ
(dashed blue) and the corresponding
radially averaged empirical mean squared error per wavenumber (dotted green). The computation
of ˆφ(cid:96) and Cvar ˆφ
took 0.25 seconds and 0.23 seconds to compute, respectively. The fast approximation
to Cbias ˆφ
is not computed in this case since the imputation
is intensive and takes on the order of hours in our implementation and is not shown).

took 77 seconds (the exact value of Cbias ˆφ

and C ZZobs

, C (1)

(cid:96)

, C (2)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

Anderes and Guinness/Generalized quadratic estimate

21

FIG 3. An illustration of the quadratic estimate bias which results when θ(cid:48)(x) is large enough to exceed the symmetric two-sided cut
locus discussed Section 3.2 (c.f. Claim 3). The shaded region shown in the middle plot corresponds to the interior of the symmetric
two-sided cut locus. When the true θ(cid:48)(x) (shown in blue) exits the symmetric two-sided cut locus, the quadratic estimate suffers from
large bias, attenuating for negative θ(cid:48)(x) and amplifying for positive θ(cid:48)(x). Note that the only difference between this ﬁgure and Figure
2 is the parameter t0 (c.f. Section 3.2) which was reduced by a factor of 1/7. This has the effect of shrinking the symmetric two-sided cut
locus. All other parameters, including the random seed, are the same.

42024321012Nonstationary phase simulation2468101214frequency ‘10-610-510-410-310-210-1Analytic vrs empirical bias spectra‘2Cbiasˆφ‘approx ‘2Cbiasˆφ‘‘2Cφφ‘‘2|φ‘−E(ˆφ‘)|2δ02468101214frequency ‘10-610-510-410-310-210-1spectral densityAnalytic vrs empirical variance spectra‘2Cvarˆφ‘‘2Cφφ‘‘2|E(ˆφ‘)−ˆφ‘|2δ042024321012Quadratic estimate, average quadratic estimate and the simulation truth θ0(x)ˆθ0(x)average ˆθ0(x)θ0(x)4. Discusssion

Anderes and Guinness/Generalized quadratic estimate

22

Part of the motivation for this paper is an attempt to construct an extended class of nonstationary
random ﬁelds, and a corresponding generalized quadratic estimate, which share the same attrac-
tive statistical properties of an estimate originally developed for gravitational lensing studies of the
Cosmic Microwave Background [10, 11]. In doing so we have identiﬁed a particular form of non-
stationarity, we call local invariance, which encourages a delicate cancellation of estimation bias. This
local invariant property—we believe—is the main source of what makes the gravitational lensing es-
timates so successful. Indeed, the generalized quadratic estimate, derived in Section 2, shares many
of the same attractive statistical features as the original gravitational lensing estimate: it is particu-
larly adept at detecting small departures from stationarity and allows fast, accurate quantiﬁcation
of mean square sampling properties. In Section 3 we focus on a particular subclass of locally invari-
ant nonstationary random ﬁelds which are given by a spatially varying spectral phase modulation
of a stationary random ﬁeld. In this work, the theory of optimal transport and the L2-Wasserstein
metric play a major role in characterizing the behavior of the set of possible local spectral densities
under these models and leads to a natural heuristic for quantifying estimation bias in terms of the
Wasserstein geodesic cut locus (see Claim 3, Section 3.2 and Figure 3).

One of the byproducts of this paper is the understanding that a nonstationary spectral phase can
be estimated by analyzing the correlation among the Fourier coefﬁcients of the nonstationary random
ﬁeld Z(x). This was illustrated in Section 3 using a quadratic estimate to reconstruct a spatially
varying spectral phase modulation of a stationary random ﬁeld. Left unanswered, however, is the
question of how one simultaneously estimates both the phase and the magnitude of the spectral
modulation A(k, x) in model (1). It appears this line of research has the potential to merge the seminal
work of Dahlhaus [2, 3] with the generalized quadratic estimate, presented here, for nonstationary
estimation within a broad class of nonstationary random ﬁelds.

It is also important to mention the fact that we have derived our results under the rather ideal-
ized assumption that the observations locations form a dense regular grid and Z(x) has periodic
boundary conditions. Extensions to more realistic experimental conditions are not in the scope of
this paper but are clearly important for real life applications. The situation is not hopeless, however,
since these same features are ubiquitous in measurements of the Cosmic Microwave Background.
Despite this, Cosmologists have devised methods which turn the idealized quadratic estimate into
a pragmatic statistical tool for probing gravitational lensing (see [14, 24, 16, 17], for example). This
suggests there exist analogous methods which can make the generalized quadratic estimate available
to more general observational scenarios.

We ﬁnish with a discussion of Assumption 2 that stipulates θ(x) be characterized by a scalar
potential φ(x). It is yet unclear how one generalizes this assumption, especially in the case where
θ(x) maps into a higher dimensional space Rm for m > d. Notice that by considering a general
θ(x) : Rd → Rm one may redeﬁne θ(x) by absorbing (i.e. concatenating) the observation locations x
into extra coordinates of θ(x). This generalization enables one to replace the local invariant condition
cov(Z(x), Z(y)) = K(x − y, θ(x) − θ(y)) with the more general condition

cov(Z(x), Z(y)) = K(θ(x) − θ(y)).

(38)

Random ﬁelds Z(x), which have a covariance function of the form (38), are simply traces of sta-
tionary random ﬁelds deﬁned on the higher dimensional space Rm, restricted to the d-dimensional
parameterized surface {θ(x) : x ∈ Rd}. Viewed from this perspective, it appears plausible that there
exists a deeper, more geometric, picture of local invariance and quadratic estimation. It is not yet clear
whether or not this viewpoint is useful, but it is tempting to imagine that the generalized quadratic
estimate is simply a manifold embedding estimate in disguise. If such a development bears theo-
retical fruit, it would be a major step in the direction of a uniﬁed statistical theory of nonstationary
random ﬁelds.

Anderes and Guinness/Generalized quadratic estimate

23

FIG 4. An illustration of the quadratic estimate in d = 2 for a nonstationary spectral phase random ﬁeld Z(x). The model for Z(x) is
deﬁned to have local variation in both the local smoothness of Z(x) and a local range parameter, where an increase of local smoothness
corresponds reduction of local range and vice versa. The top left image shows the quadratic estimate ˆφ(x) with the ground truth φ(x)
shown in the top right image and the data shown in the bottom right image. The bottom left plot shows the radial proﬁle of |(cid:96)|2Cvar ˆφ
(solid green), |(cid:96)|2Cφφ
(dashed blue) and the corresponding radially
averaged empirical mean squared error per wavenumber (dotted green). See Section 3.4 for further simulation details.

(dotted black) along with the fast approximation to |(cid:96)|2Cbias ˆφ

(cid:96)

(cid:96)

(cid:96)

32101233210123Nonstationary phase simulation051015202510-910-810-710-610-510-410-310-210-1100101Variance, bias and empirical MSE‘2Cφφ‘approx ‘2Cbiasˆφ‘‘2Cvarˆφ‘radial ‘2|φ‘−ˆφ‘|2δ032101233210123Quadratic estimate ˆφ(x)32101233210123Simulation truth φ(x)References

Anderes and Guinness/Generalized quadratic estimate

24

[1] L. Ambrosio, N. Gigli, and G. Savar´e. Gradient ﬂows: in metric spaces and in the space of probability

measures. Springer Science & Business Media, 2008.

[2] R. Dahlhaus. Fitting time series models to nonstationary processes. Annals of Statistics, 25(1):1–

[3] R. Dahlhaus. A likelihood approximation for locally stationary processes. Annals of Statistics,

37, 1997.

pages 1762–1794, 2000.

[4] S. Das et al. Detection of the power spectrum of cosmic microwave background lensing by the

Atacama cosmology telescope. Physical Review Letters, 107(2):021301, 2011.

[5] G. Fuglstad, F. Lindgren, D. Simpson, and H. Rue. Exploring a new class of non-stationary
spatial gaussian random ﬁelds with varying local anisotropy. Statistica Sinica, 25(1):115–133,
2015.

[6] G. Fuglstad, D. Simpson, F. Lindgren, and H. Rue. Does non-stationary spatial data always

require non-stationary random ﬁelds? Spatial Statistics, 14:505–531, 2015.

[7] I. Gikhman and A. Skorokhod. The Theory of Stochastic Processes I. Classics in Mathematics.

Springer Berlin Heidelberg, 2015.

[8] G. Giner and G. Smyth. A monotonically convergent Newton iteration for the quantiles of any

unimodal distribution, with application to the inverse Gaussian distribution. 2014.

[9] T. Hsing, T. Brown, and B. Thelen. Local intrinsic stationarity and its inference. Annals of Statis-

[10] W. Hu. Mapping the dark matter through the cosmic microwave background damping tail. The

tics, To Appear.

Astrophysical Journal Letters, 557(2):L79, 2001.

The Astrophysical Journal, 574(2):566, 2002.

Business Media, 2012.

[11] W. Hu and T. Okamoto. Mass reconstruction with cosmic microwave background polarization.

[12] I. Ibragimov and Yurii A. Rozanov. Gaussian random processes, volume 9. Springer Science &

[13] L. Isserlis. On certain probable errors and correlation coefﬁcients of multiple frequency distri-

butions with skew regression. Biometrika, 11(3):185–190, 1916.

[14] T. Namikawa, D. Hanson, and R. Takahashi. Bias-hardened CMB lensing. Monthly Notices of the

[15] C. Paciorek and M. Schervish. Spatial modelling using a new class of nonstationary covariance

Royal Astronomical Society, 431(1):609–620, 2013.

functions. Environmetrics, 17(5):483–506, 2006.

[16] Planck Collaboration. Planck 2013 results. XVII. Gravitational lensing by large-scale structure.

Astronomy and Astrophysics, 571:A17, November 2014.

[17] Planck Collaboration. Planck 2015 results. XV. Gravitational lensing. ArXiv e-prints, February

[18] M. Priestley. Evolutionary spectra and non-stationary processes. Journal of the Royal Statistical

Society. Series B (Methodological), pages 204–237, 1965.

[19] M. Priestley. Spectral analysis and time series, volume 2. Academic press, 1981.
[20] P. Sampson. Constructions for nonstationary spatial processes. Handbook of Spatial Statistics,

pages 119–130, 2010.

[21] P. Sampson and P. Guttorp. Nonparametric estimation of nonstationary spatial covariance struc-

ture. Journal of the American Statistical Association, 87(417):108–119, 1992.

[22] M. Stein. Interpolation of spatial data: some theory for Kriging. Springer Science & Business Media,

2015.

2012.

[23] The Polarbear Collaboration. A Measurement of the Cosmic Microwave Background B-mode
Polarization Power Spectrum at Sub-degree Scales with POLARBEAR. The Astrophysical Journal,
794:171, October 2014.

[24] A. Van Engelen et al. A measurement of gravitational lensing of the microwave background

using south pole telescope data. The Astrophysical Journal, 756(2):142, 2012.

[25] C. Villani. Topics in optimal transportation. Number 58. American Mathematical Soc., 2003.

Anderes and Guinness/Generalized quadratic estimate

25

[26] G. Wick. The evaluation of the collision matrix. Physical review, 80(2):268, 1950.

Appendix A: Detailed derivations

Claim 4. Let θ(x) : Rd → Rd be a vector ﬁeld and Z(x) be a random ﬁeld which satisﬁes E(cid:0)Z(x)Z(y)|θ(·)(cid:1) =

C (0)(x − y) + C(1)(x − y) · (θ(x) − θ(y)) + O(θ2). Then

E(Zk+(cid:96)Z−k|θ(·)) = θ(cid:96) ·(cid:0)C(1)

k − C(1)

k+(cid:96)

(cid:1) + O(θ2)

(39)

when (cid:96) (cid:54)= 0.
Proof. The Fourier transform C (0)(x − y), with respect to x and y, gives δ(cid:96)1+(cid:96)2 (2π)d/2C (0)
(cid:96)1 . Similarly,
the Fourier transform of θ(x) · C(1)(x − y) and −θ(y) · C(1)(x − y), with respect to x and y, gives
θ(cid:96)1+(cid:96)2 · C(1)−(cid:96)2 and −θ(cid:96)1+(cid:96)2 · C(1)

(cid:96)1 respectively. Summing these three terms gives

E(cid:0)Z(cid:96)1 Z(cid:96)2|θ(·)(cid:1) = (2π)d/2C (0)

(cid:96)1

δ(cid:96)1+(cid:96)2 + θ(cid:96)1+(cid:96)2 ·(cid:0)C(1)−(cid:96)2

(cid:1) + O(θ2).

Replacing (cid:96)1 with k + (cid:96) and (cid:96)2 with −k ﬁnishes the derivation.
Claim 5. Suppose assumptions 1, 2 and 3 hold. Then the ﬁrst order unbiased quadratic estimate of φ(cid:96), which
corresponds to an approximate inverse variance weighted averaging of Z obs

k+(cid:96)Z obs−k , has the form

− C(1)

(cid:96)1

ˆφ(cid:96) = A(cid:96)

∗
p,(cid:96)

ξ

e−ix·(cid:96)A (x)Bp(x)

dx

(2π)d/2

(40)

(cid:96) /C ZZobs

(cid:96)

, Bp,(cid:96) := i2 imag(C(1)

p,(cid:96))Z obs

(cid:96) /C ZZobs

(cid:96)

and the normalizing constant A(cid:96) is given

(cid:90)

d(cid:88)

p=1

where A(cid:96) := Z obs
by

(cid:90)

d(cid:88)

p,q=1

A−1
(cid:96) =

∗
q,(cid:96)

ξp,(cid:96)ξ

e−ix·(cid:96) [2Ap,q(x)B(x) − Cp(x)Cq(x) − Dp(x)Dq(x)]

dx

(41)

where Ap,q,(cid:96) := C(1)
Proof. By Claim 4 we have that

q,(cid:96) /C ZZobs

(cid:96)

p,(cid:96)C(1)∗

, B(cid:96) := 1/C ZZobs

E(cid:0)Z obs

k+(cid:96)Z obs−k

p,(cid:96)/C ZZobs

(cid:96)

(cid:96)

, Cp,(cid:96) := C(1)

(cid:1) = φ(cid:96) (ξ(cid:96) · f k,(cid:96)) + O(φ2)

(2π)d/2
and Dp,(cid:96) := C(1)∗

p,(cid:96) /C ZZobs

(cid:96)

.

(42)

when (cid:96) (cid:54)= 0 where f k,(cid:96) := C(1)
the ﬁrst order unbiased terms Z obs

k − C(1)

k+(cid:96). Therefore the quadratic estimate, as a weighted average of

k+(cid:96)Z obs−k /(ξ(cid:96) · f k,(cid:96)), can be written in the form

ˆφ(cid:96) =

wk,(cid:96)

Z obs
k+(cid:96)Z obs−k
ξ(cid:96) · f k,(cid:96)

dk

(2π)d/2

(43)

where wk,(cid:96) ≥ 0 are normalized so that ˆφ(cid:96) has expected value φ(cid:96) + O(φ2) using (42). Assuming (cid:96) (cid:54)= 0,
the Gaussian part of the variance of Z obs

k+(cid:96)Z obs−k /(ξ(cid:96) · f k,(cid:96)) can be computed as follows

(cid:90)

(cid:32)

var

Z obs
k+(cid:96)Z obs−k
ξ(cid:96) · f k,(cid:96)

(cid:33)

1

|ξ(cid:96) · f k,(cid:96)|2

(cid:104)
(cid:104)
(cid:124)
C ZZobs
k+(cid:96) C ZZobs
|ξ(cid:96) · f k,(cid:96)|2

|ξ(cid:96) · f k,(cid:96)|2

1

k

=

≈

=

k ) − E(Z obs
(cid:123)(cid:122)

E(Z obs

k+(cid:96)Z obs−k Z obs−k−(cid:96)Z obs

k+(cid:96)Z obs−k )E(Z obs−k−(cid:96)Z obs
k )

E(Z obs

k+(cid:96)Z obs−k−(cid:96))E(Z obs

k Z obs−k ) + E(Z obs

k+(cid:96)Z obs

k )E(Z obs−k Z obs−k−(cid:96))

only keeping the Gaussian part of the trispectrum

(cid:2)δ2

0 + δ2

2k+(cid:96)

(cid:3).

(cid:105)

(cid:105)
(cid:125)

(cid:90)
d(cid:88)
d(cid:88)
d(cid:88)

p=1

p=1

p=1

|ξ(cid:96) · f k,(cid:96)|2
C ZZobs
k+(cid:96) C ZZobs

k

k+(cid:96)
C ZZobs

(cid:90) (cid:104) Z obs
(cid:90)
(cid:90)

k+(cid:96)

∗
p,(cid:96)

ξ

∗
p,(cid:96)

ξ

∗
p,(cid:96)

ξ

ˆφ(cid:96) = A(cid:96)

= A(cid:96)

= A(cid:96)

= A(cid:96)

dk

(2π)d/2

Z obs
k+(cid:96)Z obs−k
ξ(cid:96) · f k,(cid:96)
C(1)

p,−kZ obs−k
C ZZobs
−k

− C(1)∗

p,k+(cid:96)Z obs
k+(cid:96)
C ZZobs

k+(cid:96)

(cid:105)

Z obs−k
C ZZobs
−k

dk

(2π)d/2

[Ak+(cid:96)Dp,−k − Cp,k+(cid:96)A−k]

dk

(2π)d/2

e−ix·(cid:96) [A (x)Dp(x) − Cp(x)A (x)]

dx

(2π)d/2

where A(cid:96) := Z obs
Fourier transform of Dp(x) − Cp(x) can be simpliﬁed as follows

, Dp,(cid:96) := C(1)

(cid:96) /C ZZobs

(cid:96) /C ZZobs

p,(cid:96)Z obs

(cid:96)

(cid:96)

and Cp,(cid:96) := C(1)∗

p,(cid:96) Z obs

(cid:96) /C ZZobs

(cid:96)

Dp,(cid:96) − Cp,(cid:96) =(cid:2)C(1)

p,(cid:96) − C(1)∗

p,(cid:96)

(cid:3) Z obs

(cid:96)

C ZZobs

(cid:96)

= i2 imag(C(1)
p,(cid:96))

Z obs

(cid:96)

C ZZobs

(cid:96)

.

This gives (40) as was to be shown.

The normalizing constant A(cid:96) is deﬁned so that the right hand of (44) is unbiased (up to ﬁrst order).

Utilizing (42) this unbiased constraint is written as follows

(44)

. Notice that the

Anderes and Guinness/Generalized quadratic estimate

26
denotes the spectral density of Z obs(x) marginalized over φ(·). If we ignore the term
where C ZZobs
2k+(cid:96), which only activates at the point k = −(cid:96)/2, then by deﬁning wk,(cid:96) in (43) to be proportional to
δ2
the approximate inverse (Gaussian part of the) variance of Z obs

k+(cid:96)Z obs−k /(ξ(cid:96) · f k,(cid:96)) one has

(cid:96)

|ξ(cid:96) · f k,(cid:96)|2
C ZZobs
k+(cid:96) C ZZobs

k

(cid:90)
(cid:90) (cid:12)(cid:12)ξ(cid:96) · C(1)
d(cid:88)
d(cid:88)

ξp,(cid:96)ξ

p,q=1

ξp,(cid:96)ξ

∗
q,(cid:96)

p,q=1

dk

(cid:12)(cid:12)2

C ZZobs

k

k

(2π)d/2
k+(cid:96) − ξ(cid:96) · C(1)
(cid:90) C(1)
k+(cid:96) C ZZobs
(cid:90)

∗
q,(cid:96)

1 = A(cid:96)

= A(cid:96)

= A(cid:96)

= A(cid:96)

dk

(2π)d/2

p,k+(cid:96)C(1)∗

q,k+(cid:96) + C(1)

p,kC(1)∗
C ZZobs

q,k − C(1)
k+(cid:96) C ZZobs

k

p,k+(cid:96)C(1)∗

q,k − C(1)∗

p,k+(cid:96)C(1)

q,k

dk

(2π)d/2

e−ix·(cid:96) [2Ap,q(x)B(x) − Cp(x)Cq(x) − Dp(x)Dq(x)]

dx

(2π)d/2

(45)

where Ap,q,(cid:96) := C(1)

p,(cid:96)C(1)∗

q,(cid:96) /C ZZobs

(cid:96)

, B(cid:96) := 1/C ZZobs

(cid:96)

, Cp,(cid:96) := C(1)

p,(cid:96)/C ZZobs

(cid:96)

and Dp,(cid:96) := C(1)∗

p,(cid:96) /C ZZobs

(cid:96)

.

Claim 6 (Estimation variance). Suppose X(x) is a mean-zero Gaussian random ﬁeld with spectral den-
sity given by C XX
=

. Then the spectral density of ˆφ(cid:96){X,X} (c.f. Deﬁnition 2), which satisﬁes δ(cid:96)−(cid:96)(cid:48)Cvar ˆφ

E(cid:0) ˆφ(cid:96){X,X} ˆφ(cid:96)(cid:48){X,X}∗(cid:1), is given as follows

(cid:96)

(cid:96)

(cid:90) (cid:12)(cid:12)(cid:12)ξ(cid:96)·C(1)
d(cid:88)

ξp,(cid:96)ξ

p,q=1

k − ξ(cid:96)·C(1)

k+(cid:96)

(cid:90)

Cvar ˆφ

(cid:96)

= 2A2
(cid:96)

= 2A2
(cid:96)

(cid:12)(cid:12)(cid:12)2 C XX

k+(cid:96)
(C ZZobs

k+(cid:96)

C XX
(C ZZobs

k

k

dk
(2π)d

)2

)2

∗
q,(cid:96)

e−ix·(cid:96) [2Ap,q(x)B(x) − Cp(x)Cq(x) − Dp(x)Dq(x)]

dx
(2π)d

(46)

(47)

Anderes and Guinness/Generalized quadratic estimate

for all (cid:96) (cid:54)= 0 where Ap,q,(cid:96) := C(1)
and Dp,(cid:96) := C(1)∗
/(C ZZobs

p,(cid:96) C XX

(cid:96)

(cid:96)

p,(cid:96)C(1)∗

q,(cid:96) C XX

/(C ZZobs
)2. Moreover, if C XX

(cid:96)

(cid:96)

)2, B(cid:96) := C XX

/(C ZZobs

(cid:96)

(cid:96)
one obtains

)2, Cp,(cid:96) := C(1)

p,(cid:96)C XX

(cid:96)

27

/(C ZZobs

(cid:96)

)2

(48)
Proof. Recall Deﬁnition 2 which states that ˆφ(cid:96){X,X} denotes the quadratic estimate applied to data
X(x). Therefore

= 2(2π)

(cid:96)

Cvar ˆφ

(cid:96)

(cid:96) = C ZZobs
−d/2A(cid:96).

E(cid:0) ˆφ(cid:96){X,X} ˆφ(cid:96)(cid:48){X,X}∗(cid:1) = A(cid:96)A(cid:96)(cid:48)

(cid:90)(cid:90) (cid:16)
× E(cid:0)Xk+(cid:96)X−kX−k(cid:48)−(cid:96)(cid:48)Xk(cid:48)(cid:1)

k − ξ(cid:96)·C(1)

ξ(cid:96)·C(1)

(cid:17)∗(cid:16)

ξ(cid:96)(cid:48)·C(1)

k+(cid:96)

C ZZobs

k+(cid:96) C ZZobs

k

C ZZobs

k(cid:48)+(cid:96)(cid:48) C ZZobs

k(cid:48)

k(cid:48) − ξ(cid:96)(cid:48)·C(1)
k(cid:48)+(cid:96)(cid:48)

(cid:48)
dkdk
(2π)d .

(49)

(cid:17)

Now expanding the above fourth moment, using Wick’s theorem (also called Isserlis’s Theorem)
[26, 13] and the Gaussianity of X(x), one obtains

E(cid:0)Xk+(cid:96)X−kX−k(cid:48)−(cid:96)(cid:48)Xk(cid:48)(cid:1) = C XX

k+(cid:96)C XX−k(cid:48)(cid:0)δ(cid:96)δ(cid:96)(cid:48) + δk−k(cid:48)+(cid:96)−(cid:96)(cid:48)δk−k(cid:48) + δk+k(cid:48)+(cid:96)δk+k(cid:48)+(cid:96)(cid:48)(cid:1)
k+(cid:96)C XX−k(cid:48)(cid:0)δ(cid:96)δ(cid:96)(cid:48) + δ(cid:96)−(cid:96)(cid:48)δk−k(cid:48) + δ(cid:96)−(cid:96)(cid:48)δk+k(cid:48)+(cid:96)(cid:48)(cid:1).

= C XX

(cid:96) (cid:54)= 0 and replacing E(cid:0)Xk+(cid:96)X−kX−k(cid:48)−(cid:96)(cid:48)Xk(cid:48)(cid:1) in (49) with 2C XX

(cid:48)
= 0. Furthermore, by a change of variables, one can
The term δ(cid:96)δ(cid:96)(cid:48) is only nonzero when (cid:96) = (cid:96)
see that effect of the terms δ(cid:96)−(cid:96)(cid:48)δk−k(cid:48) and δ(cid:96)−(cid:96)(cid:48)δk+k(cid:48)+(cid:96)(cid:48) in (49) are identical. Therefore assuming
k+(cid:96)C XX−k(cid:48)δ(cid:96)−(cid:96)(cid:48)δk−k(cid:48) gives (46). A similar
in (46)

approach to the derivation for (45) can be used to establish (47). Finally, if one replaces C XX
−d/2A(cid:96).
with the marginal spectral density C ZZobs

then using (45) one obtains Cvar ˆφ

= 2(2π)

k

k

(cid:96)

Claim 7 (Estimation bias). Let O(φ2)(x, y) := (θ(x) − θ(y))T C(2)(x−y)(θ(x)−θ(y)) where C(2)(x) : Rd →
Rd×d and C(2)(−x) = C(2)(x). Then

O(φ2)k+(cid:96),−k =

Deﬁne ˆφbias
tions given in Claim 5. Then

:= ˆφ(cid:96)

(cid:96)

p,q=1

(cid:16)

C(2)

θp,ωθq,(cid:96)−ω

(cid:90)
d(cid:88)
(cid:9) (see Deﬁnition 2), where the quadratic estimate ˆφ(cid:96) satisﬁes all the assump-
(cid:8)O(φ2)k+(cid:96),−k
(cid:90)
d(cid:88)

p,q,k+(cid:96)−ω − C(2)

p,q,k+(cid:96) − C(2)

(cid:111) dω

(cid:17) dω

p,q,k + C(2)

(2π)d/2

(cid:110)

p,q,k+ω

(50)

.

θp,ωθq,(cid:96)−ω

ˆφ(cid:96)

p,q,k − C(2)
C(2)

p,q,k+ω

ˆφbias
(cid:96) = 2

(51)

(2π)d/2

and the spectral density of ˆφbias
matrix C θθ

(cid:96) , satisﬁes

(cid:96)

E(cid:0) ˆφbias

(cid:96)

ˆφbias∗
(cid:96)(cid:48)

(cid:1) = 4δ(cid:96)−(cid:96)(cid:48)

d(cid:88)

p,q,p(cid:48),q(cid:48)=1

p,q=1

(cid:90) (cid:16)

× ˆφ(cid:96)

when (cid:96) (cid:54)= 0 or (cid:96)

(cid:48) (cid:54)= 0.

(cid:110)

, under a mean zero Gaussian random ﬁeld model for θ(x) with spectral density

(cid:17)

(cid:110)

(cid:111) ˆφ(cid:96)

C θθ

p,p(cid:48),ωC θθ

q,q(cid:48),(cid:96)−ω + C θθ

p,q(cid:48),ωC θθ

q,p(cid:48),(cid:96)−ω

p,q,k − C(2)
C(2)

p,q,k+ω

p(cid:48),q(cid:48),k − C(2)
C(2)

p(cid:48),q(cid:48),k+ω

(cid:111)∗ dω

(2π)d (52)

Anderes and Guinness/Generalized quadratic estimate

28
Proof. Notice that for any p, q ∈ {1, . . . , d} if one deﬁnes Bp,q(x, y) := (θp(x)− θp(y))(θq(x)− θq(y))
(cid:48)
then the Fourier transform of Bp,q(x, y) with respect to (x, y), evaluated at frequency vector (k, k
),
is given by

(cid:90)

(cid:16)

Bp,q,k,k(cid:48) =

θp,ω

θq,k−ωδ−k(cid:48) + θq,k(cid:48)−ωδ−kδω+ω(cid:48)−k(cid:48)

Using the fact that Fourier transform of C(2)

p,q,kδk+k(cid:48) one obtains

(cid:17)

dω.

− θq,k(cid:48)δω−kδω(cid:48)−k(cid:48) − θq,kδω(cid:48)−kδω−k(cid:48)
p,q(x − y) equals (2π)d/2C(2)
(cid:105)
(cid:125)

(cid:123)(cid:122)

k,k(cid:48)

(θp(x) − θp(y))(θq(x) − θq(y))

(cid:124)

(cid:125)
(cid:123)(cid:122)
p,q(x − y)
C(2)

Ap,q(x,y)

O(φ2)k,k(cid:48) =

=

=

p,q=1

d(cid:88)
d(cid:88)
d(cid:88)

(cid:104)
(cid:124)
(cid:90)(cid:90)
(cid:90)

p,q=1

p,q=1

Making the substitution k
follows from the fact that

(cid:110)

Ap,q,z+k,z(cid:48)+k(cid:48)Bp,q,−z,−z(cid:48)

(cid:16)

θp,ωθq,k+k(cid:48)−ω

C(2)

p,q,−k(cid:48) + C(2)

p,q,k − C(2)

p,q,k−ω − C(2)

p,q,ω−k(cid:48)

(cid:17) dω

(2π)d/2

.

(53)

(cid:48) → −k and k → k + (cid:96) in (53) proves (50). Equation (51) immediately

ˆφ(cid:96)

p,q,k+(cid:96) − C(2)
C(2)

p,q,k+(cid:96)−ω

= ˆφ(cid:96)

p,q,k − C(2)
C(2)

Bp,q(x,y)

dz dz(cid:48)
(2π)d

(cid:111)

(cid:110)

(cid:111)
k ∈ Rd×d, C(1)∗

p,q,k+ω

k and C(1)−k =
k along with the change of variables ˜k = −k − (cid:96). Finally, using Wick’s theorem for Gaussian

which is established by utilizing the three properties C(2)−k = C(2)
−C(1)
θ(x) gives

−k = C(1)

E(cid:0)θp,ωθq,(cid:96)−ωθ

q(cid:48),(cid:96)(cid:48)−ω(cid:48)(cid:1) = δ(cid:96)−(cid:96)(cid:48)(cid:0)C θθ

∗

∗
p(cid:48),ω(cid:48)θ

(cid:48) (cid:54)= 0. Expanding the quadratic E(cid:0) ˆφbias

p,p(cid:48),ωC θθ

when (cid:96) (cid:54)= 0 or (cid:96)
(52) as was to be shown.

q,q(cid:48),(cid:96)−ωδ(cid:96)−ω(cid:48)−ω + C θθ

p,q(cid:48),ωC θθ

(cid:1), applying Fubini and (54) then gives

q,p(cid:48),(cid:96)−ωδω(cid:48)+ω

(54)

ˆφbias∗
(cid:96)(cid:48)

(cid:96)

(cid:1)

