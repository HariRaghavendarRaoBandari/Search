6
1
0
2

 
r
a

M
1

 

 
 
]
I
S
.
s
c
[
 
 

1
v
5
4
1
0
0

.

3
0
6
1
:
v
i
X
r
a

On Tie Strength Augmented Social Correlation for Inferring

Preference of Mobile Telco Users

Shifeng Liu

State Key Laboratory of
Networking and Switching

Technology

Zheng Hu

State Key Laboratory of
Networking and Switching

Technology

Beijing University of Posts and

Beijing University of Posts and

Telecommunications

BeiJing, China

Telecommunications

BeiJing, China

liushifeng@bupt.edu.cn

huzheng@bupt.edu.cn

Sujit Dey

Mobile Systems Design Lab,

Dept. of Electrical and
Computer Engineering
University of California,

San Diego, USA

dey@ece.ucsd.edu

Xin Ke

Beijing Research Institute

China Telecom
BeiJing, China

kexin@ctbri.com.cn

ABSTRACT

For mobile telecom operators, it is critical to build prefer-
ence proﬁles of their customers and connected users, which
can help operators make better marketing strategies, and
provide more personalized services. With the deployment
of deep packet inspection (DPI) in telecom networks, it is
possible for the telco operators to obtain user online pref-
erence. However, DPI has its limitations and user prefer-
ence derived only from DPI faces sparsity and cold start
problems. To better infer the user preference, social cor-
relation in telco users network derived from Call Detailed
Records (CDRs) with regard to online preference is investi-
gated. Though widely veriﬁed in several online social net-
works, social correlation between online preference of users
in mobile telco networks, where the CDRs derived relation-
ship are of less social properties and user mobile internet
surﬁng activities are not visible to neighbourhood, has not
been explored at a large scale. Based on a real world tele-
com dataset including CDRs and preference of more than
550K users for several months, we veriﬁed that correlation
does exist between online preference in such ambiguous so-
cial network. Furthermore, we found that the stronger ties
that users build, the more similarity between their prefer-
ence may have. After deﬁning the preference inferring task
as a Top-K recommendation problem, we incorporated Ma-
trix Factorization Collaborative Filtering model with social
correlation and tie strength based on call patterns to gener-
ate Top-K preferred categories for users. The proposed Tie
Strength Augmented Social Recommendation (TSASoRec)
model takes data sparsity and cold start user problems into

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
KDD ’16 August 13–17, 2016, San Francisco, California, USA
c(cid:13) 2016 ACM. ISBN XXX-X-XXXX-XXXX-X/XX/XX. . . $10.00
DOI: 10.1145/1235

account, considering both the recorded and missing recorded
category entries. The experiment on real dataset shows the
proposed model can better infer user preference, especially
for cold start users.

Keywords

Social correlation; social tie strength; matrix factoriza-

tion;preference inference

1.

INTRODUCTION

Nowadays, the number of global mobile telco subscribers
has exceeded the world population and people are getting
used to communicating with others and the cyber space via
mobile phones. A huge amount of mobile communication ac-
tivities are recorded by the Telco operators. For examples,
the Call Detail Records (CDRs) record users’ communica-
tions with others; the users’ surﬁng activities on internet
content can also be obtained by using Deep Packet Inspec-
tion (DPI) [5]. The CDRs, of which each row provides infor-
mation about the caller, the callee, time duration and start
time of a call, could help us derive a social network among
users. The call records between any two users construct an
edge between these two nodes in the social network. At the
same time, user preference is widely used to characterize dif-
ferent types of customers. With the DPI logs, it is feasible
to calculate user preference under predeﬁned categories on
mobile internet. Given the social networks based on CDRs
and user preference based on DPI logs, it is natural for us
to ask whether the social correlation theory [21] could be
applied to the mobile telco social networks.

Social Correlation Theory, which suggests that there are
correlations between behaviours or attributes or preference
of connected users in a social network, has been widely
veriﬁed in several online social networks (OSNs), such as
Facebook, Twitter and even the Location Based Social Net-
works [15, 21, 8, 20]. Previous work on mobile telco so-
cial networks have discussed social correlation between con-
nected users’ mobility behaviors [22]. Some eﬀorts studied
user proﬁles and demographics in mobile telco context [4].

lenging problem is the extent to which preference of telco
users can be inferred from available recorded preference and
mobile social networks.

In this paper, we use a real-world data set from one op-
erator in a middle size city of China as the basis of inves-
tigation. The data includes Call Details Records (CDRs)
for 18 months. Beside the CDRs, the data contains users
preference based on DPI parsing over predeﬁned 643 cat-
egories for 6 months and the time period of DPI logs is
in that of the CDRs. The interplay of user preference to
content and user social communication with others is stud-
ied based on the data set. Through hypothesis testing, we
ﬁnd that correlation does exist in mobile telco social net-
works between the preference of connected users, i.e. the
preference similarities between the connected user pairs are
statistically signiﬁcantly higher than those between the un-
connected random user pairs. Furthermore, we observe that
the social tie strength based on call interaction statistically
correlate the preference similarities for the connected user
pairs, which we called Tie Strength Augmented Social Cor-
relation. Moreover, We discover that besides accumulative
duration and number of calls, directed call cycle is one of the
determinant features which should be considered for more
”preference social correlated”. We then develop a model to
represent tie strength based on selected features of calls be-
tween the dyads of ties.

Considering application value of the user preference, we
deﬁne the preference inference as a Top-K recommendation
problem and the objective is to recommend user’s Top-K
preferred categories over 643 predeﬁned categories. Collab-
orative ﬁltering (CF) is most eﬀective when user preference
are obtained enough to signiﬁcantly overlap with other users,
but it performs poorly for data sparsity and cold start users.
In the telco case, 643 categories covers a wide range of in-
terests and preference distribution is sparse, so we employ
users’ latent feature space derived from Matrix Factoriza-
tion (MF) models in collaborative ﬁltering. Comparing to
purely similarity based CF approaches, applying Social cor-
relation into recommendation system can improve the per-
formance of CF in cold start context which is common in
telco cases. And there have been some eﬀorts carried out on
on social collaborative ﬁltering (CF) based recommendation
solutions [25, 14, 27, 26, 13, 12, 9], in which the Top-K rec-
ommendations can be generated[26]. Therefore, we leverage
the social correlation discovered in our cases and propsoed
a Social Matrix Factorization CF model to generate Top-K
categories for users. Moreover, to improve the accuracy of
recommendation, the Tie Strength based on call patterns is
incorporated based on above discoveries, resulting in a Tie
Strength Augmented Social Recommendation (TSASoRec)
model. To the best of our knowledge, we are the ﬁrst to
study the correlation between online preference in telco mo-
bile users network and the ﬁrst to incorporate tie strength
derived from CDRs with social Top-K RS in real world telco
mobile network. To assess the performance of the proposed
TSASoRec Top-K RS, we undertake a comprehensive exper-
iment on the data set. The proposed TSASoRec model, for
both general users and cold-start users, outperforms SoRec
model which leverages no tie strength derived from CDRs
on accuracy metrics.

Organization Some related work is discussed in section
2, followed by the interesting correlation discoveries in Sec-
tion 3. Then we formalize the Top-k RS problem with social

Figure 1: Layered Structure Category Example

However, they do not consider the social correlation of user
online preference which are of high value in practice. More-
over, unlike the OSNs where the user behaviours such as
posting, commenting, etc. are visible to their connected
users and could explicitly inﬂuence or be inﬂuenced by their
adjacent users [1, 24], telco users’ communications with oth-
ers and mobile internet surﬁng activities are parallel.
In
other words, the online surﬁng activities of a user is usually
invisible to others, even they may have social relationships.
Finally, with mobile users relying more on OSN tools such
as Facebook, Twitter, Wechat to maintain their daily social
circles, the relationships based on CDRs are of less social
properties. In this paper, we aim to leverage a large-scale
mobile telco user network to study how the users’ online
preference correlates in such ambiguous social network.

User’s preference is always represented as a predeﬁned cat-
egories vector in which every entry records how the user
prefers to the category corresponding to the entry. Conven-
tionally, the categories are layered structured with the ones
closer to the roots (in our context the lower layer categories)
being of coarser granularity and so forth, which are shown
in Figure 1. For telco operators, the Deep Packet Inspec-
tion deployed in their networks can examine the data part
of a packet as it passes an inspection point. When a telco
user click a page on his/her mobile phone using browser or
an APP, a request packet might be sent via mobile cellular
networks and the Universal Resource Locator (URL) data
part of the request (usually the HTTP GET) packet, if any,
might be recorded. By parsing the page content of the URL,
the visiting can be classiﬁed into one of predeﬁned categories
and the times of visiting the corresponding category content
will plus one.
In this case, by using the visiting times of
diverse categories to present the preference, we can obtain
the user preference vectors.

However, DPI in Telco operators has its limitations. The
surﬁng activities using diﬀerent access networks could not
be inspected, e.g., roaming to other province, using WLAN
or other telco companies’ mobile networks. Moreover, if the
interaction data is encrypted (e.g. using HTTPS) or based
on complex protocols, it is impossible for telco operators to
extract the valuable information via inspection. These are
very common cases in APPs of smart mobile phones. There-
fore, the user preference of telco operators are incompletely
built. There are a signiﬁcant proportion of users might be
cold start users whose preference are nearly vacant. In our
real-world data set, no more than 15% of recorded users that
are in the CDRs have user preference extracted from DPI. It
is critical for mobile telco operators to build preference pro-
ﬁles for their customers and connected users, which can help
operators make better marketing strategies, provide better
personalized services. Therefore, an interesting but chal-

SportsBallsLiftingBasketballNBACostumeTree1Tree7Tree23Interactive ModeLayer1Layer2Layer3Layer4ClothingShoesForumInstant MessagingMen’sClothing............tie strength model and present the solution in Section 4. Ex-
periments are conducted to assess the proposed solution and
the results are shown in Section 5. Finally, we conclude this
work in Section 6.

2. RELATED WORK

In this section, we begin with discussions about social cor-
relation veriﬁcation as well as social strength study at telco
area in recent years. After that, we review the low-rank ma-
trix factorization models with social networks, with compre-
hensive consideration of diverse recommendation objectives.
2.1 Social Correlation and Social Strength

Social correlation has widely been investigated in the many
aspects for many years. Research on network structure [7]
divided social relations into weak ties and strong ties. Some
researchers focus on the constituent of social correlation.
Anagnostopoulos ,Kumar and Mahdian [1] seek the role that
social inﬂuence plays in social correlation with two prac-
tical experiments: shuﬄe test and edge reverse. This is
followed by Fond and Neville [10] presenting another ran-
domization framework. Leskovec et al. [11] explore posi-
tive relations such as friend relations and negative relations
e.g.competitive relations and adversarial relations in online
social networks. Xiang et al. [23] move a step further and
infer relation strength from interaction activity and user sim-
ilarity.

Due to ambiguous and invisible properties, researches on
telco social networks are far less than that on online social
networks.
[16] focuses on the relation among telco users
and draws the conclusion that the role of weak ties is to
keep the stability of social networks using call duration, the
overlap of friends, etc. Phithakkitnukoon and Dantu [17,
18] study the social closeness and communication patterns
in the telecom network by a small sample (around 3,000
users and 46,000 call activities), building a model with the
amount of time and the frequency of communication. They
also divide the telecom network into three broad groups by
diﬀerent closeness.

A CP-rank algorithm is proposed based on the ﬁnite Markov

chain for any communication system [6]. [19] proposes a
framework called ASG(Aggregated Social Graphs),which could
calculate the social strength from multiple communication
environments (e.g. Online Social Networks(OSN) and Tele-
com Networks) aggregating communication information and
social information. The frequency of communication be-
tween users is found playing an vital role in the measurement
of social strength [3].
2.2 Matrix Factorization and Social Networks
Matrix factorization is a widely used method in the model
based recommendation of collaborative ﬁltering. At ﬁrst,
there is no social networks involved until the emergence of
the trust network. SoRec, STE and SocialMF [13, 12, 9]
bring the trust network into the loss function of matrix fac-
torization, and achieve better performance with respect to
RMSE. Ma, Hao and Zhou [14] and Yu et al. [28] consider the
discrepancy between social networks and trust networks and
improve the SocialMF model with diﬀerent ways of similar-
ity calculation. [27] divides users’ neighbour sets into sub-
sets, believing that users would trust diﬀerent subsets of
users for diﬀerent domains. However, the trust network used

in the previous models just contains boolean relations,i.e. a
user trusts another user or not.

Additionally, many recommendation models address the
problem of predicting a single rate of a user, only consid-
ering the feedback from each individual user. In addition,
there are some research concerning on the top-k recommen-
dation,i.e.for each user,a list of a small number k items from
all the available items is given by the recommendation sys-
tem. [26] has showed that the existing social Matrix Factor-
ization (MF) CF models could be conveniently tailored for
Top-K recommendation by extending their training objec-
tive functions with a voting-based approach to consider both
observed and missing ratings. The authors extended some
classic matrix factorization models to improve the accuracy
of top-k recommendation by including social network in the
matrix factorization objective function and has the top-k hit
ratio improved especially for the cold start users. Among all
the modiﬁed MF models in [26], modiﬁed SoRec model is the
best which is in contrast when predicting a single rate.

3. HYPOTHESIS TEST

Social networks have already been studied by many re-
searchers for many years, especially for those online social
networks, which are explored in recent years. The correla-
tion among users has already been veriﬁed in those social
networks, which provide the basis to generate eﬀective tools
to help achieve better performance. However, the mobile
telco social network which is constructed via mobile phone
calls among telecom customers has been rarely explored due
to its privacy and invisibility. Therefore, whether social cor-
relation exists in telco network is worth to investigate.
3.1 Data Set

The data set which comes from one operator in a middle
size city of China. To protect the privacy and anonymity,
all data we got is anonymized by the operator in preprocess-
ing stage so that no real user could be traced or tracked via
data records. The Call Details Records (CDRs) start from
January 2014 and end at June 2015, in which there are in
average more than 6 million users with around 100 million
records per month. Each row in CDRs contains caller num-
ber, callee number, start time and duration. By grouping
the CDRs, the telco mobile social networks can be derived as
a graph G = (V, E), where V is the set of users and E is the
set of call connections among users. To eliminate some ser-
vice numbers, we only keep the relationship that two users
have reciprocal calls between them in 18 months. The user
preference are calculated based on DPI logs from January
2014 to June 2014. Each row records how many times the
user ui has visited the predeﬁned categories respectively dur-
ing that period. In the dataset, there are around 12 percent
of users in G have preference proﬁles. Therefore, from G
we choose a maximal connected subgraph Gs = (Vs, Es) in
which all users have preference as our study target. For Gs,
the |Vs| = 557541 and |Es| = 6497628.

The predeﬁned categories vector are layered structured in
which there are 23 trees with 643 leafs/entries across 4 lay-
ers, as shown in Figure 1. The categories at deeper layers
have ﬁner granularities for classiﬁcation and vice verse. In
the trees structure with 23 roots, each category is the super
class semantically of all categories located in the branches
of it. As shown in Figure 1), the category Sports at layer 1
semantically contains the categories Balls at layer 2, Lifting

at layer 2, Basketball at layer 3 and NBA at layer 4 which are
located in the branches of Sports node in the tree 7. If the
user’s request is meaningfully inspected and ﬁnally parsed
into one category, e.g. the NBA , the counts that user have
visited category NBA, e.g. 28, will add one and equal 29.
To keep the up direction consistency, the counts of all super
nodes from current category uptraced to the root category
along the branch in the tree are also added one, respec-
tively. That means, according to the structure of Figure 1,
the NBA’s super categories, including Basketball ,Balls and
Sports will increase by one, respectively. Practically, most
of URLs being visited can not be classiﬁed into the ﬁnest
granularity categories (i.e. Layer 4 categories). We leave
the downstream inconsistency of dataset unprocessed since
it does not inﬂuence the similarity metrics much. Using nor-
malization by the total visiting times of each user, we build
the new vectors as user preference for our study.
3.2 Social Correlation Inference

3.2.1 HierarchySim
We now have user preference proﬁles for six months in
target data. To reduce the inﬂuence of hot popular subcat-
egories and elevate the signiﬁcance of rarely accessed ones
while computing the similarities of user preference, we up-
date the preference vectors with their tf − idf values. Since
the preference vectors are layered structured, the similar-
ity between two users according to their preference should
be measured in terms of both their structures and the pref-
erence weights associated with overlapped categories. We
adapt the method introduced in [2] to our cases and de-
compose the similarity measurement between two users as a
weighted sum of the similarities between each corresponding
layer of preference vectors. As the deeper layers providing
a ﬁner granularity, they are given with a bigger weight. For
the similarity score between the same layers of two users, it
consists of two parts.

The ﬁrst part is the sum of weights for all overlapped cat-
egories at one layer for two users. The weight for an over-
lapped category, representing two users’ common preference
on the category, is selected as the minimum preference score
of two users on that category, as shown in Equation ??.
Higher the value of LayerSim is the more similarity be-
tween two users may have. The weight could also be calcu-
lated by other similarity metrics, such as cosine similarity.
We compare these metrics and ﬁnd the minimum weight one
achieves the best performance.

LayerSim(u, u

(cid:48)

, l) =

min(u.wc, u

(cid:48)

.wc).

(1)

(cid:88)

c∈Cl

The rest part is the entropy of each layer, which could
eﬀectively separate users by the diversity of their preference,
as shown in Equation 2. H(u, l) is the entropy of user u at
layer l, and P (c) is the probability that user u visits category
c in his preference vector.

H(u, l) = −(cid:88)

u.P (c) × lgu.P (c).

(2)

c∈Cl

Finally, the similarity score between two users could be
calculated by Equation 3, where β is the weight with the
depth increase of the layer. Here we choose β = 2l as the
visiting times for diﬀerent layers presents exponential distri-

bution as the depth of layers increases.

HierarchySim(u, u

(cid:48)

) =

|l|](cid:88)

l

β × LevelSim(u, u(cid:48), l)

1 + |H(u, l) − H(u(cid:48), l)| .
(3)

Social Correlation Veriﬁcation

3.2.2
To investigate the applicability of social correlation to
mobile telco social network, we need verify whether the
connected users achieve greater similarity score, e.g. us-
ing HierarchySim and other ones, than those unconnected
users according to their preference. We build two set of sam-
ples to measure similarity scores, the connected user pairs
set and the unconnected user pair. If there exists an edge in
Es, the edge’s users will be selected as a user pair in the con-
nected user pairs set. S is used to represent the similarity
scores of these user pairs. For the unconnected user pair set,
we randomly selected two users having no edge in Es from
Vs as user pair and use R to represent the set of similarity
scores of unconnected user pair set. As the number of all
the randomly selected unconnected user pairs is extremely
huge, we only use a small part with 56820916 unconnected
user pairs.

When it comes to hypothesis testing, we found the distri-
butions of similarity score in both S and R are not following
the normal distribution which is a necessity for the Student’s
T test [21]. Therefore, we perform a Mann-Whitney U test,
which just requires the independence of every two set, on S
and R. The null hypothesis H0 is that the probability of a
similarity score from S exceeding a similarity score from R
equals the probability of a similarity score from R exceeding
a similarity score from S; the alternative hypothesis H1 is
that the probability of a similarity score from S exceeding a
similarity score from R exceeds the probability of a similar-
ity score from R exceeding a similarity score from S. The
alternative hypothesis using in our experiment is stronger
than the classic one which only requires that the two proba-
bilities are diﬀerent. If there is strong evidence to reject the
null hypothesis, we verify that correlation theory exists in
telco social networks between online preference of connected
users.

The experiment result is shown in Table 1 with the sig-
niﬁcance level α = 0.001 and the single-tailed testing. All
ﬁve similarity methods achieve the conclusion that we should
accept the alternative hypothesis and reject the null hypoth-
esis as the probability values p for the signiﬁcance level α
are zero. In addition, the U scores of each U test for dif-
ferent similarity methods indicate that the HierarchySim
we propose is a better similarity method than those tradi-
tional ones due to the greater U score. This result veriﬁes
that the similarity between two familiar users is higher than
two strangers(Figure 2); i.e. the social correlation between
connected users’ online preference does exists in telco social
networks.

Moreover, as the relationships among people cannot be
simply divided into two sets with whether people communi-
cate with each other or not. Behind the calls, there may exist
diﬀerent relationships and correlations. An interesting prob-
lem is the extent to which the connected user pairs could be
classiﬁed by their call patterns meaningfully while being cor-
related with the similarities on preference. In other words,
can we ﬁnd social correlated tie strength model based on call
patterns of the tie with regard to preference? Therefore, we

Table 1: Comparison of Diﬀerent Similarity Methods

Methods

Adjusted Cosine Similarity

Cosine Similarity
Pearson Coeﬃcient
Tanimoto Coeﬃcient

HierarchySim

U score
1.62E+14
1.62E+14
1.62E+14
1.63E+14
1.69E+14

z score
-738.9601
-739.1275
-738.9601
-760.1081
-941.1750

p value

0
0
0
0
0

Table 2: the Results of U Test

Cluster tag Cluster tag

U score

p value

1
1
2

2
3
3

3.2155E+12
1.7420E+12
1.5952E+12

0
0
0

Table 3: tie strength and HierarchySim of Each Clus-
ter

|cluster|

tie strength

HierarchySim

Cluster 1 Cluster 2 Cluster 3

3047038
44.44996

0.3932

2760935
7.8488
0.3373

689657
23.2898
0.3592

Figure 2:
HierarchySim

the distribution of

two sets on

try to separate the set S into several sets with diﬀerent tie
strength represented by call patterns.
3.3 Social Strength Inference

To eﬀectively distinguish the relationships in set S, we
extract information from the call records during eighteen
months and build a series of features to describe the rela-
tionships among users. Here we only focus on those user
pairs in set S. Since a telephone call has a direction from
one to the other between two users, the features we listed
Appendix A.1 have maintained with directed and undirected
attributes.

With all the features extracted from the call records, we
use the classic Kmeans clustering algorithm to generate three
clusters. The reason why we set the K = 3 is that some so-
cial experts like Dunbar divide the relationship into three
progressive aggregation, i.e.
the closest, the normal and
the marginal. Thus the original user pairs recording the
two user’s id and their HierarchySim in preference vector
are extended with a cluster tag generated by the algorithm.
Here the range of cluster tag is 0,1 and 2. Both experiments
for K = 2 and K = 4 have been tried but neither of them
achieve a better performance than that of K = 3 in the
following experiment.

With K = 3 non-overlapping sets, we employ the Mann-
Whitney U test to analysis the similarity scores in every two
set. The null hypothesis H0 is just like what is proposed in
the previous U test. The alternative hypothesis H1 is that
the probability of a similarity score from set A exceeding a
similarity score from set B is diﬀerent from the probability
of a similarity score from set B exceeding a similarity score
from set A. The set A and set B are two set selected from
the three non-overlapping set. And the similarity methods
applied here is HierarchySim which achieves a better per-
formance than other traditional similarity methods. The
results of U test are shown in Table 2, with the signiﬁcance

level α = 0.05 and two-tailed test testing. From the table,
we can ﬁnd precisely that every two sets have diﬀerent dis-
tribution of similarity score, which means the three kinds of
relationships do have diﬀerent strength of social correlation.
Furthermore, we are wondering whether two connected
users with stronger tie strength have a higher HierarchySim
score between their preference vectors. Using the features
listed in Appendix A.1, the tiestrength testing metric is de-
ﬁned in Appendix A.2 which guarantees two users have more
call interactions also have higher tiestrength score. For the
3 clusters we got, the tiestrength score of each cluster is
the average value of all the scores of user pairs in that clus-
ter. The probability distribution functions of three clusters
is plotted in Figure 3 for judging the distinction of distribu-
tion spreads of the high, middle, and low tie strength clusters
visually. It clearly shows that the high tie strength cluster
(coloured in red) has a higher tie strength score, which indi-
cates people with stronger relations do have a tendency to
visit similar content categories on the Internet distinctively.

Figure 3: the distribution of three clusters

−15−10−505lg(HierarchySim)0.000.050.100.150.200.250.300.35probabilityLegendConnected SetUnconnected Set4. TIE STRENGTH AUGMENTED SOCIAL

RECOMMENDATION MODEL

Unlike conventional social CF recommendation systems
which only take the existence of social relationships into ac-
count, social strength is incorporated into our Tie Strength
Augmented Social Recommendation (TSASoRec) model,which
improves the performance of recommendation results. When
training and evaluating user data in our model, instead of
only considering the categories users have visited, we are
going to take the unvisited categories into account. This
is because user may visit one category but the DPI could
not inspected for the reasons mentioned previously. Base on
our TSASoRec, people’s untraced preference could be rec-
ognized, which could be used to solve the cold-start problem
such as ﬁlling the vacancy of users preference vectors.
4.1 Preliminaries
In the recommendation system, we have a set of users
U = {u1, ..., uN} and a set of predeﬁned categories C =
{ci, ..., cM}. The probability values expressed by users ac-
cessing the predeﬁned categories are given in a non-negative
preference matrix P = [Pu,c]N×M . In preference matrix P ,
Pu,c denotes the possibility that user u accesses a webpage
that is classiﬁed as predeﬁned category c. As each Pu,c is the
posterior probability calculated according to the records, so
their values are in the rage of [0, 1]. But in the telco social
network concerned, each user u has a set Nu of his neigh-
bours and iu,v denotes the value of social strength u has on
v as a real number greater than 0. Since zero means there
is no call between two users in eighteen months, we regard
these two users as strangers. The higher the value of social
strength is, the closer the two users are. The social strength
value are given in the matrix I = [Iu,v]N×N and non-zero
entries Iu,v in I denote the degree of social strength of a rela-
tion from u to v. As we only consider users who called each
other at least once in the history records, so I is symmetric
only when there is a entry.
According to the deﬁnition in the above paragraph, the
task of recommendation is as follows:Given a user u ∈ U,
give the rank of all the predeﬁned categories based on the
preference values we predict for each predeﬁned category
using P and I.

In this paper, we employ matrix factorization techniques
to get the latent features of users and predeﬁned categories
and give the rank of all the predeﬁned categories based on
the predicted preference values using these latent features.
Let U ∈ RN×K and V ∈ RM×K be the latent user feature
matrix and latent predeﬁned category feature matrix, with
row vectors Uu and Vc representing K-dimensional user-
speciﬁc and category-speciﬁc latent feature vectors of user u
and predeﬁned category c, respectively. The goal of matrix
factorization is to obtain those latent features, know unob-
servable features of both users and predeﬁned category, and
exploit them for predicting the preference values. As pre-
dicting the preference value that a user accesses a predeﬁned
category is hard to be accurate, it is more practical to give a
list of ranked predeﬁned categories in for providers to carry
out personalized services or market campaigns.
4.2 Social Strength Assignment

Both call duration and call times have been used in the
models to describe the social tie strength of telecom users.
Phithakkitnukoon and Dantu [17, 18]use Euclidean distance

of normalized duration and times to deﬁne the closeness of
users, which is shown in Equation 4.

S(i, j) =(cid:112)(1 − F (i, j))2 + (1 − T (i, j))2.

(4)

F (i, j) is the call times from user i to j normalized with the
max call times of user i,and T (i, j) is obtained in a similar
way.

From the deﬁnition of closeness, the closer relationship
that two users have, the lower the value is. In contrast, social
strength grows with stronger relationships among users. So
we deﬁne social strength in a similar way as S(i, j):

(cid:114)

I(i, j) =

F (i, j)2 + T (i, j)2

2

.

(5)

In Equation 5, the deﬁnitions of F (i, j) and T (i, J) are in
line with Equation 4. We limit the range of I(i, j) in [0, 1] (0
means there is no correlation among users’ preference and 1
shows the strongest relationship).

We argue that only considering call duration and call
times is insuﬃcient. For example, user i and user j pro-
duce a large number of explosive calls in only a few days,
leading to a great deal of call times and call duration. This
case is likely to happen in real life. There are also user i
and user j who make regular calls just several times a day.
A typical example of this is a pair of lovers, making calls
every day to keep in touch. For the two user relations, the
closeness deﬁned in Equation 4 and the social tie strength
deﬁned in Equation 5 are unable to separate them apart.

To ﬁnd out neglected features in the past, random for-
est algorithm is used to evaluate each features listed in Ap-
pendix A.1 for their contribution to the HierarchySim score.
Usually, random forest algorithm is used for classiﬁcation
which is able to avoid over-ﬁtting problem in decision tree.
We mix the features to compare the error in unclassiﬁed
data brought by this noise. If the precision drops by a large
margin after a feature is mixed with random noise, it means
that this feature has a great inﬂuence on the classiﬁcation
of the result, and also represents its high importance.

Figure 4: Feature importance via Random Forest

The result of ranking the feature importance is shown in
Fig 4, and only 46 features are shown considering the visual
eﬀect. Surprisingly, a feature that describes the directed call
cycle of ties is ranked as the most signiﬁcant one, which is
followed closely by the feature representing the sum of dura-
tion of calls for the user pairs. The number of calls between
users doesn’t seem to be so important as intuitive consider-
ing but also occupies an important position. To our surprise,
most features describing both directed call cycle and undi-
rected call cycle prove to have an signiﬁcant inﬂuence on
the level of similarity for users preference vectors. The dis-
coveries of ﬁrst-ranking signiﬁcance of directed call cycle is

(cid:114)

explainable. The direction reﬂects the aﬀective requirement
or aﬃliation from caller to the callee. And the cycle of di-
rected call perfectly express the periodic steadiness as one
facet of aﬀection aﬃliation strength (closeness) of the callee
to the caller, while undirected call cycle may introduce the
churn to the steadiness or periodicity.

Realizing that call cycle is one important feature to eval-
uate the tie strength in telco social network, we employ Dis-
crete Fourier Transform (DFT) to extract the feature, in
which call times series made up of call times within a day
from user i to user j are processed. The ﬁrst main lobe
in the frequency domain is extracted as call cycle and the
enhanced tie strength model is as follows:

I(i, j) = M f (i, j) ∗

F (i, j)2 + T (i, j)2

2

.

(6)

where M f (i, j) indicates the call cycle of user i and user j
in the speciﬁed period (It should be 18 months in our data
set); M f (i, j) is the value of the ﬁrst main lobe; F (i, j) and
T (i, j) are consistent with the deﬁnition in S(i, j). From
Equation 6, a user pair with more stable call interaction
would achieve a higher value when F (i, j) and T (i, j) are
ﬁxed. In this enhanced model, asymmetry is preserved and
enhanced since M f (i, j) and M f (j, i) are unequal with dif-
ferent appeal.
4.3 Model Training

Although some recommendation system proposed several
years ago have already considered the social relations among
users, only marking whether the two users know each other
is not enough. Nowadays, people have formed diﬀerent rela-
tionships among each other, which means the degree of mu-
tual aﬀective aﬃliation between people depends on their re-
lationships, i.e. their social strength. In TSASoRec, the so-
cial recommendation is incorporated with social tie strength
model derived from CDR patterns.

Using the tie strength weighed network I, as deﬁned above,
we train a matrix factorization model to generate the ranked
list of predeﬁned categories for users. Considering the pref-
erences which may be miss-tagged, we give a bit punishment
for those categories that are not observed in his preference.
Our loss function is similar to that of SoRec [?], but there
is a crucial diﬀerence of the social network constructed via
our social strength model. We use the following training loss
function [26] as follows:

(cid:88)
(cid:88)

allu

L =

+

Wu,c(Pu,c − ˆPu,c)2

u,v (Iu,v − ˆIu,v)2
F + ||Z||2

W (S)
F + ||V ||2

F ).

allu

+λ(||U||2

Wu,c =

Pu,c > 0
1
ωm otherwise

u,v = γ ·

W (S)

1
ω(S)
m

Iu,v > 0
otherwise

allc

allv

(cid:88)
(cid:88)
(cid:40)
(cid:40)

(7)

(8)

(9)

where we use Wu,c and W (S)
u,v to give diﬀerent degree of pun-
ishment to predicted errors for diﬀerent conditions with γ

working as the weight of the social strength network com-
pared to the preference data;here we use the Frobenius norm,
denoted by ||·||F , to regularize the learned latent feature ma-
trices U , V and Z; ˆPu,c is the predicted preference value of
user u in category c,

ˆPu,c = rm + UuV T
c

(10)

where rm is deﬁned as the global bias term for preference
matrix and ˆIu,v is the predicted social strength value of user
u for user v,

ˆIu,v = im + UuZ T
v

(11)

where we deﬁne the global bias term im for the social strength
network.

Usually, Equation 7 is minimized by the gradient decent
approach, but it is not eﬃcient enough for millions of users
and the condition preparing every Ru,c and Iu,v. So we ap-
ply the alternative least square approach to optimize Equa-
tion 7.

5. EXPERIMENT

In this section, we present experiment results on a real life
data set to generate the prediction of predeﬁned categories
and the impact of partial parameters. We focus on the top-
k hit ratio or recall as a more realistic measure than the
traditional RM SE and M AE [26]. Like the classical social
MF models, SoRec, STE and SocialMF, we also use rank
K = 10, which is the number of the latent features. Unlike
those existing experiments on Epinions which only consider
4-star and 5-star ratings as relevant ones, we take every pref-
erence values greater than zero into consideration. It means
even when a user access the predeﬁned category for only
once, we would like to consider whether the user visits this
category by mistake or just favours it incipiently. In all our
experiments, we set λ = 0.01 and ω(S)
m = 0 as we neglect the
situation that two users know each other but they don’t call
mutually in eighteen months.
5.1 Date Set Revisit

Many recommendation systems with social network use
Epinions Dataset or Flixster Dataset, as gathering a data
set containing both a social network and ratings is really
hard. Here we use the data set mentioned in Section 3.1
with preference vectors and the telco social network.

The preference part in the data set is really sparse as there
is a large diﬀerence between the average number(7) and the
total number(643) of predeﬁned categories. The data set
contains 557K users with at least one entry in the prefer-
ence vector. Here we regard users with less than 5 pre-
deﬁned categories in their preference vectors as cold start
users. With the telco social network in the data set, we
have nearly 6.5M pairs of users who at least called each
other once, which forms the Social Relation Matrix contain-
ing whether two users know each other. We also construct
the social tie strength matrix using our social strength model
and relevant features extracted from the data set.
5.2 Top-K Hit-Ratio

As cold-start problem is one of the concerns in prefer-
ence inference problem, the traditional evaluation metrics
e.g. the Mean Absolute Error(MAE) and the Root Mean
Square Error(RMSE), are not used any more here. Instead,

top-k hit ratio and recall [26] are more suitable to be used
as accuracy measures for the algorithm.

To get the top-k hit ratio and recall for each user u, we
rank the categories according to the predicted values. First,
only categories deﬁned as relevant are considered in the com-
putation process and a user should show his preference on
this category e.g.,the probability that a user visits this cat-
egory is above a certain threshold. For instance, the rating
values of 4 and 5 stars are used as relevant, while other
rating values and missing rating values are considered as ir-
relevant. Here we deﬁne the threshold for relevant categories
as 0, which means a category is relevant even if it is accessed
by a user only once.

The top-k hit ratio and recall can be deﬁned as the frac-
tion of relevant categories in the test set that is in the top-k
of the ranking list, denoted by N (k, u), from among all the
relevant categories in the test set for user u, denoted by
N (u). For each user u, the top-k hit ratio [26] is given by

H(k, u) =

N (k, u)

N (u)

.

(12)

Equation 12 can be aggregated over all users to obtain the
average top-k hit ratio, and recall is deﬁned as

(cid:80)
(cid:80)

u N (l, u)
u N (u)

recall(k) =

(13)

which is a weighted average across users, with each user’s
weight proportional to the user’s number of relevant cate-
gories of N (u). A higher top-(k) hit ratio and recall suggests
more accurate top-k recommendations.
5.3 Experiment Results

Figure 5 reports the recall values of diﬀerent k on our
data set using Social Relation Matrix and Social Strength
Matrix. The parameters γ is set to 0.01 for experiments in
our data set. Figure 5 shows that the results using our so-
cial strength matrix outperform the one with the traditional
Social Relation Matrix when k = 5 and k = 10. And the
performances of the two matrices is evenly matched when k
grows.

Figure 5: Results on Social Relation Network and
Social Strength Network

Our proposed TSASoRec improves the recall by 2% when
k is small compared to the large k in the previous meth-
ods. This is quite signiﬁcant as the recommended content
on phone is limited by the size of screen which means too

much content recommendation is infeasible. In the case of
a small amount of content recommendation, our TSASoRec
model can lead to better recommendation performance.
5.4

Impact of γ on the Results

Parameter γ controls the weight of the social strength
network on the call records of users. A greater value of
γ in the loss function of Equation 7 indicates that the social
strength network has more inﬂuence on the loss function.
When γ becomes smaller, the loss function would close to the
traditional PMF model without the consideration of social
networks. However, when γ is given a very large value, the
model would make users’ latent feature vectors similar to
their direct neighbours’, which omits the speciﬁcity of users
themselves.

Figure 6 shows the recall values of k = 5 and k = 10
for a range of γ in our data set. And they show the same
tendency for the impact of γ on recall. As shown in the
ﬁgure, our model has the best results for γ = 0.08.
5.5

Impact of ωm on the Results

We bring in ωm to give a punishment for the condition
that users may be interested in one category without ac-
cessing such a webpage via their phone. It is worthy that
we ﬁgure out the inﬂuence of ωm on the results. Larger val-
ues of ωm in Equation 8 indicate the possibility that users
do not access a predeﬁned category they prefer via phones.
When ωm declines to zero, our data displays users preference
more adequately and vice versa.

We show the results of recall of k = 5 and k = 10 for a
series of ωm in Figure 7. It is clearly that the performance
decrease as the increase of ωm with the most likely possibility
value of ωm = 0.06.
5.6 Performance on cold start users

Some users have a wide range of predeﬁned categories,
but they may express just a few, due to the unfamiliarity
with phones or diﬃculties in ﬁnding the relevant wedpages.
Filling vacancies in users preference vectors will help opera-
tors specify the marketing plan. We consider users who have
express less than 5 categories as cold start users.

Figure 8 shows that the results of cold start users using our
proposed social strength model outperform the traditional
social relation one by 4% and 1%when k = 5 and k = 10.
The gain for cold start users is doubled compared to the gain
for all users when k = 5 but decrease as k increases. This is
similar to what we discussed in the previous subsection. In
Figure 9, the performance of cold users reaches around 50%
when k = 5 and excel that of normal users. We believe this
is mainly due to the consideration of social strength in our
model.

6. CONCLUSION

Motivated by the question that whether there is a cor-
relation between connected users’ mobile internet interests
in telco social network, we endeavoured into Call Detail
Records (CDRs) and DPI logs of a real-world telco dataset.
We discovered that it is statistically signiﬁcant for users
with call interactions sharing more similar preference than
two strangers. On this basis, we further veriﬁed that the
stronger call based social relation two users have, the more
similar their preference may be. Based on feature engineer-
ing over features of recorded calls, we proposed a simple

k@5k@10k@15k@20k@25k@30k@40k@500102030405060708090Recall(%)14263846546174821628374553617480social relationsocial strengthFigure 6: Impact of diﬀerent values of γ on the per-
formance of recall on Social Strength Network

Figure 8: Results of Cold Start Users on Social Re-
lation Network and Social Strength Network

Figure 7: Impact of diﬀerent values of ωm on the
performance of recall on Social Strength Network

Figure 9: Results of Cold User and Normal User on
Social Strength Network

but eﬀective model that describes the strength of tie be-
tween two connected users, in which the directed cycle is
introduced. We deﬁned the preference inference problem as
a Top-K Recommendation problem, and incorporated the
model with the social matrix factorization CF model. The
proposed Tie Strength Augmented Social Recommendation
is evaluated by experiments which shows the improvement of
performance on recommending Top-K preferred categories
for both general users and cold-start users. TSASoRec per-
forms better under the case of less number categories ranking
or inferring, which help make better marketing strategies,
enhance customer experience, provide priority guidance for
service providers.

7. ACKNOWLEDGEMENTS

This work was partially supported by the National Nat-
ural Science Foundation of China (Grant No. 61302077),
Key Tech & Science Program Project of China (Grant No.
2014AA01A706) , the joint cooperation project of BUPT
and China Telecom Beijing Institute, and Funds for Cre-
ative Research Groups of NSFC (Grant No. 61421061).

8. REFERENCES
[1] A. Anagnostopoulos, R. Kumar, and M. Mahdian.

Inﬂuence and correlation in social networks. In
Proceedings of the 14th ACM SIGKDD international

conference on Knowledge discovery and data mining,
pages 7–15. ACM, 2008.

[2] J. Bao, Y. Zheng, and M. F. Mokbel. Location-based

and preference-aware recommendation using sparse
geo-social networking data. In Proceedings of the 20th
International Conference on Advances in Geographic
Information Systems, pages 199–208. ACM, 2012.

[3] M. De Choudhury, W. A. Mason, J. M. Hofman, and

D. J. Watts. Inferring relevant social networks from
interpersonal communication. In Proceedings of the
19th international conference on World wide web,
pages 301–310. ACM, 2010.

[4] Y. Dong, Y. Yang, J. Tang, Y. Yang, and N. V.
Chawla. Inferring user demographics and social
strategies in mobile social networks. In Proceedings of
the 20th ACM SIGKDD international conference on
Knowledge discovery and data mining, pages 15–24.
ACM, 2014.

[5] I. Dubrawsky. Firewall evolution-deep packet

inspection. Security Focus, 29, 2003.

[6] N. Dudarenko, J. Rana, and K. Synnes. Ranking

algorithm by contacts priority for social
communication systems. In Smart Spaces and Next
Generation Wired/Wireless Networking, pages 38–49.
Springer, 2010.

[7] M. S. Granovetter. The strength of weak ties.

0.000.020.040.060.080.100.12γ16.1516.2016.2516.3016.35Recall@5(%)k@5k@1028.5028.5528.6028.6528.7028.7528.80Recall@10(%)0.000.020.040.060.080.100.12ωm13.514.014.515.0Recall@5(%)k@5k@1024.525.025.526.026.527.0Recall@10(%)k@5k@10k@15k@20k@25k@30k@40k@50020406080100Recall(%)48748285889096975275798387919697social relationsocial strengthk@5k@10k@15k@20k@25k@30k@40k@50020406080100Recall(%)52757983879196971528374553617480cold usernormal userAmerican journal of sociology, pages 1360–1380, 1973.
[8] X. Hu, L. Tang, J. Tang, and H. Liu. Exploiting social

relations for sentiment analysis in microblogging. In
Proceedings of the sixth ACM international conference
on Web search and data mining, pages 537–546. ACM,
2013.

[9] M. Jamali and M. Ester. A matrix factorization

technique with trust propagation for recommendation
in social networks. In Proceedings of the fourth ACM
conference on Recommender systems, pages 135–142.
ACM, 2010.

with social theories. ACM SIGKDD Explorations
Newsletter, 15(2):20–29, 2014.

[22] D. Wang, D. Pedreschi, C. Song, F. Giannotti, and

A.-L. Barabasi. Human mobility, social ties, and link
prediction. In the 17th ACM SIGKDD international
conference, page 1100, New York, New York, USA,
2011. ACM Press.

[23] R. Xiang, J. Neville, and M. Rogati. Modeling

relationship strength in online social networks. In
Proceedings of the 19th international conference on
World wide web, pages 981–990. ACM, 2010.

[10] T. La Fond and J. Neville. Randomization tests for

[24] S.-H. Yang, B. Long, A. Smola, N. Sadagopan,

distinguishing social inﬂuence and homophily eﬀects.
In Proceedings of the 19th international conference on
World wide web, pages 601–610. ACM, 2010.

[11] J. Leskovec, D. Huttenlocher, and J. Kleinberg.

Predicting positive and negative links in online social
networks. In Proceedings of the 19th international
conference on World wide web, pages 641–650. ACM,
2010.

[12] H. Ma, I. King, and M. R. Lyu. Learning to

recommend with social trust ensemble. In Proceedings
of the 32nd international ACM SIGIR conference on
Research and development in information retrieval,
pages 203–210. ACM, 2009.

[13] H. Ma, H. Yang, M. R. Lyu, and I. King. Sorec: social

recommendation using probabilistic matrix
factorization. In Proceedings of the 17th ACM
conference on Information and knowledge
management, pages 931–940. ACM, 2008.

[14] H. Ma, D. Zhou, C. Liu, M. R. Lyu, and I. King.

Recommender systems with social regularization. In
Proceedings of the fourth ACM international
conference on Web search and data mining, pages
287–296. ACM, 2011.

[15] A. Mislove, B. Viswanath, K. P. Gummadi, and

P. Druschel. You are who you know: inferring user
proﬁles in online social networks. In Proceedings of the
third ACM international conference on Web search
and data mining, pages 251–260. ACM, 2010.

[16] J.-P. Onnela, J. Saram¨aki, J. Hyv¨onen, G. Szab´o,

D. Lazer, K. Kaski, J. Kert´esz, and A.-L. Barab´asi.
Structure and tie strengths in mobile communication
networks. Proceedings of the National Academy of
Sciences, 104(18):7332–7336, 2007.

[17] S. Phithakkitnukoon and R. Dantu. Mobile social

closeness and communication patterns. In Consumer
Communications and Networking Conference
(CCNC), 2010 7th IEEE, pages 1–5. IEEE, 2010.
[18] S. Phithakkitnukoon and R. Dantu. Mobile social

group sizes and scaling ratio. AI & society,
26(1):71–85, 2011.

[19] J. Rana, J. Kristiansson, and K. Synnes. Enriching

and simplifying communication by social
prioritization. In Advances in Social Networks
Analysis and Mining (ASONAM), 2010 International
Conference on, pages 336–340. IEEE, 2010.

[20] Y. Song, Z. Hu, X. Leng, H. Tian, K. Yang, and

X. Ke. Friendship inﬂuence on mobile behavior of
location based social network users. Communications
and Networks, Journal of, 17(2):126–132, 2015.

[21] J. Tang, Y. Chang, and H. Liu. Mining social media

Z. Zheng, and H. Zha. Like like alike: joint friendship
and interest propagation in social networks. In
Proceedings of the 20th international conference on
World wide web, pages 537–546. ACM, 2011.

[25] X. Yang, Y. Guo, Y. Liu, and H. Steck. A survey of

collaborative ﬁltering based social recommender
systems. Computer Communications, 41:1–10, 2014.

[26] X. Yang, H. Steck, Y. Guo, and Y. Liu. On top-k

recommendation using social networks. In Proceedings
of the sixth ACM conference on Recommender
systems, pages 67–74. ACM, 2012.

[27] X. Yang, H. Steck, and Y. Liu. Circle-based

recommendation in online social networks. In
Proceedings of the 18th ACM SIGKDD international
conference on Knowledge discovery and data mining,
pages 1267–1275. ACM, 2012.

[28] L. Yu, R. Pan, and Z. Li. Adaptive social similarities
for recommender systems. In Proceedings of the ﬁfth
ACM conference on Recommender systems, pages
257–260. ACM, 2011.

APPENDIX
A. SUPPLEMENT FOR SOCIAL STRENGTH

INFERENCE

A.1 Features of Call Pattern

Table 4: Call Pattern Features

Feature Name Undirected Feature Id Directed Feature Id

sumFre
sumDur
monthFre
monthDur
pairCycle

pairFrequency
pairDuration

0
1
2-19
20-37
38-40
41-58
59-76

77
78

79-96
97-114
115-117
118-135
136-153

A.2 Deﬁnition of tie strength

N(cid:88)

tie strength =

fi

(14)

where fi indicates the feature listed in Appendix A.1 with
the Id i.Here we set i from 0 to 76.

i

