6
1
0
2

 
r
a

 

M
8
1

 
 
]
t
f
o
s
.
t
a
m
-
d
n
o
c
[
 
 

1
v
9
8
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Breadth versus depth: Interactions that stabilize particle assemblies to
changes in density or temperature

William D. Piñeros,1 Michael Baldea,2 and Thomas M. Truskett2, a)
1)Department of Chemistry and Biochemistry, University of Texas at Austin, Austin,
TX 78712
2)McKetta Department of Chemical Engineering, University of Texas at Austin, Austin,
TX 78712

(Dated: 22 March 2016)

We use inverse methods of statistical mechanics to explore trade-oﬀs associated with designing interactions to
stabilize self-assembled structures against changes in density or temperature. Speciﬁcally, we ﬁnd isotropic,
convex-repulsive pair potentials that maximize the density range for which a two-dimensional square lattice is
the stable ground state subject to a constraint on the chemical potential advantage it exhibits over competing
structures (i.e., ‘depth’ of the associated minimum on the chemical potential hypersurface). We formulate
the design problem as a nonlinear program, which we solve numerically. This allows us to eﬃciently ﬁnd
optimized interactions for a wide range of possible chemical potential constraints. We ﬁnd that assemblies
designed to exhibit a large chemical potential advantage at a speciﬁed density have a smaller overall range of
densities for which they are stable. This trend can be understood by considering the separation-dependent
features of the pair potential and its gradient required to enhance the stability of the target structure relative
to competitors. Using molecular dynamics simulations, we further show that potentials designed with larger
chemical potential advantages exhibit higher melting temperatures.

I.

INTRODUCTION

The synthesis of matter with precise and well-
characterized structures at nanometer length scales is
critical to the discovery and manufacture of new ma-
terial systems with desirable optical,1 mechanical2, and
other physical3 properties. Unfortunately, despite recent
progress,4–6 direct fabrication of such materials using
top-down approaches can be technologically challenging,
expensive, and time-consuming. An alternative bottom-
up strategy is to synthesize systems of nanoscale particles
with eﬀective interactions7,8 that favor spontaneous or
directed self-assembly into the targeted structure (e.g., a
periodic crystal or superlattice conﬁguration).9–12

Historically, design in self assembly has focused on
forward approaches, whereby the interactions between
particles are altered in some rationally-guided or Edis-
onian fashion, and the resulting equilibrium structures
that such interactions produce are identiﬁed and cata-
logued according to their ability to meet various design
goals concerning their material properties. However, at-
tention has begun to shift toward inverse design strate-
gies, whereby interactions that favor the targeted struc-
ture or properties in the thermodynamically stable state
are formally discovered through a constrained, statistical
mechanical optimization.13,14

Several recently introduced computational methods for
inverse design focus on optimization of interparticle in-
teractions to stabilize a targeted ground-state conﬁgu-
ration with the assumption of an isotropic pair poten-
tial φ(r, {αi}) with variable parameter set {αi}. Such

a)Electronic mail: truskett@che.utexas.edu

approaches have found various interactions that sta-
bilize two-dimensional square, honeycomb and kagome
lattices15–18 as well as the three-dimensional diamond
crystal structure.19,20 Furthermore, it was demonstrated
that particles with the optimized interactions indeed as-
sembled into the targeted lattice phases at higher tem-
perature using molecular simulations15,16,20.

In this same vein, we have used inverse methods to
design convex-repulsive, isotropic pair potentials of the
following form21,22

φ(r/σ) = ǫ{A(r/σ)−n +

2

Xi=1

λi(1 − tanh[ki(r/σ − δi)])

+ fshift(r/σ)}H[(rcut − r)/σ].

(1)
that stabilize open crystal structures. The ﬁnal opti-
mized potentials qualitatively resembled eﬀective pair in-
teractions observed in various soft colloidal systems (e.g.,
star polymers, ligand-passivated nanocrystals, microgels,
etc.).7 Here, σ and ǫ represent characteristic length and
energy scales respectively; H is the Heaviside function;
{A, n, λi, ki, δi} are variable parameters (i.e., αi), one of
which is ﬁxed to ensure φ(1) = ǫ; rcut is a cut-oﬀ radius;
fshift is a quadratic function fshift(r/σ) = P (r/σ)2 +
Qr/σ + R added to enforce φ(rcut/σ) = φ′(rcut/σ) =
φ′′(rcut/σ) = 0. Using a simulated annealing optimiza-
tion approach, parameters for this potential that stabi-
lize, over a very wide range of density, square and hon-
eycomb lattices in two dimensions22 as well as simple
cubic and diamond ground-state structures in three di-
mensions were determined.21 Complete phase diagrams
were also calculated for the three-dimensional systems,23
which illustrated rich and complex phase equilibria with
the targeted assemblies exhibiting good thermal stability
relative to other competing crystal lattices.

One basic question that has not yet been addressed is,
which features of a pair potential would tend to max-
imize the melting temperature of a given target struc-
ture? Moreover, how would encoding high thermal sta-
bility into the interactions aﬀect the corresponding range
of densities for which the target structure is favored? In
other words, is there a natural compromise between de-
signing for robustness to changes in temperature versus
volume? Such questions are challenging to answer di-
rectly via inverse methods because they would require
incorporating full molecular simulations (for a wide range
of model parameters and thermodynamic conditions)
into the optimization problem, which is computation-
ally unfeasible at present. A pragmatic alternative is
to search for features of the ground-state behavior that,
while easier to compute than higher temperature proper-
ties, correlate with thermal stability of the target phase.
In the present work, we ﬁnd that placing constraints on
the minimum chemical potential advantage that the tar-
get structure would exhibit over selected equi-pressure
competing lattices at zero temperature helps determine
optimized interactions with higher target-phase melting
temperatures.

The speciﬁc structure that we target via ground-state
inverse optimizations in this work is the two-dimensional
square lattice ground state, which has attracted consid-
erable theoretical interest in recent years,22,24–26 and the
class of pair potentials we consider are those described by
eq. 1. The stable equilibrium ground-state structure can
be established by determining the global minimum of the
potential energy U at ﬁxed density and zero temperature
or the minimum of the chemical potential µ at ﬁxed pres-
sure and zero temperature (amongst other possibilities
that follow from classical thermodynamics27). Following
other works,21,22,28,29 we adopt the latter ﬁxed pressure
framework for our optimizations for convenience because
any coexistence between the target structure and another
lattice also requires equality of pressure between phases.
Through our optimizations, we test how the maximum
achievable range of density for stability of the square-
lattice ground state is aﬀected by constraining the diﬀer-
ences between its chemical potential at a prescribed state
point and those of selected competing lattice structures
at the same pressure. To do this systematically requires
the solution of a series of optimization problems, each uti-
lizing diﬀerent constraints. Given the considerable com-
putational expense of using stochastic optimizers (e.g.,
simulated annealing, genetic algorithms, etc.) for even a
single optimization, we instead formulate each optimiza-
tion problem of interest as a constrained mixed-integer
nonlinear problem, and we solve it numerically using the
General Algebraic Modeling System (GAMS)30. We then
explore the consequences of our imposed chemical poten-
tial advantage of the target ground state for the resulting
thermal stability (i.e., melting temperature) of the result-
ing lattices.

The paper is organized as follows. We ﬁrst introduce
the computational methods used for carrying out the

2

pair-potential optimization and the melting point estima-
tion. Next, we show the relationship between the density
range of ground-state stability for the target lattice and
the minimum chemical potential diﬀerence between the
target and selected competitors. We conclude by dis-
cussing how these trends manifest in the resulting pair
potentials and lattice melting temperatures.

II. METHODS

In this section, we describe how we formulate and
solve the inverse design problem of interest in this work:
ﬁnding isotropic pair interactions that maximize the
density range over which the targeted square lattice is
the ground-state conﬁguration given a constraint on its
chemical potential advantage over selected competing lat-
tices. We further detail the implementation of molecular
dynamics (MD) simulation methods for estimating the
melting point to characterize the corresponding thermal
stability of the designed lattice structures.

A.

Inverse Design of the Pair Potential

1. Optimization Problem Formulation

We formulate the design optimization problem follow-

ing the general paradigm

maximize

decision variables
subject to

f (x)

gi(x)

where f (x) is an objective function and gi(x) are con-
straint equality or inequality equations with variables x.
The mathematical forms of f (x) and gi(x) deﬁne the
type of problem to be solved (e.g., if integer variables or
non-linear functions are necessary, etc.). For the inverse
design calculations of interest here, the set of equations gi
incorporate any desired constraints to be imposed on the
interparticle pair potential and f is formulated to ensure
optimization of the desired thermodynamic property. To
optimize for speciﬁc ground states, one needs to consider
not only the target lattice lt of the design, but also other
lattices {l} that naturally compete with it for thermo-
dynamic stability (the procedure to determine the pool
of competing lattices is discussed separately in the next
section). Using eq.(1) as the model pair potential, we
ultimately seek potential parameters {A, n, li, ki, di} (i.e.
the decision variables) that maximize the density range
for which the target lattice lt has a chemical potential
lower than lattices in {l} at the same pressure such that
a minimum speciﬁed chemical potential advantage of the
target structure over select competitors is obtained at a
given state point.

Speciﬁcally, to incorporate the pair potential of eq.(1),
we introduce constraint equations that ensure the poten-
tial is appropriately normalized, repulsive, convex, and

continuous (we implicitly nondimensionalize energies by
ǫ, lengths by σ and omit parameter notation below for
brevity). The normality condition is given by

Lastly, an auxiliary equation is used

r2
0(ρl) ≤ r2

cut

3

(9)

φ(1) = 1

and the other constraints are given by

and

φ(r) > 0
−φ′(r) > 0
φ′′(r) > 0

φ(rcut) = 0
φ′(rcut) = 0
φ′′(rcut) = 0

(2)

(3a)
(3b)
(3c)

(4a)
(4b)
(4c)

We set rcut = 2.27183 as motivated by previous work
considering square lattices designed via this potential
form.22 As a practical matter, r is discretized over a ﬁ-
nite set of points in (0, rcut); we use ten uniform points
in φ(r), and 60 points distributed in a 1:6:5 ratio from
ranges [0.2,0.8), [0.8,1.2], (1.2,rcut) for φ′′(r), which we
ﬁnd suﬃcient to enforce the constraints. It is not nec-
essary to include the constraint on φ′(r) so long as the
other constraints are fulﬁlled.

Next, we specify the equations describing the physics
of the ground state. The ﬁrst is for the internal energy
per particle, which can be expressed

Ul =

1
2

ri,l≤rcut

Xi

ni,lφ(ri,l(ρl))

(5)

Here, ri,l(ρl) are the density-dependent coordination dis-
tances for each lattice l and ni,l are the number of neigh-
bors at those distances.31 The pressure Pl of lattice l is
related to its density ρl by the virial expression

Pl = −

1
4

ρl

ri,l≤rcut

Xi

ni,lri,l(ρl)φ′(ri,l(ρl))

(6)

For our purposes, the relevant density of a competing
lattice l, ρl, is that which leads to equality of pressure
with the target lattice lt of density ρt. In other words
ρl(ρt) can be determined from knowledge of ρt via the
relation Pl(ρl) = Pt(ρt), and thus from eq. 6, we have

ri,l≤rcut

ρl

Xi

ni,lri,l(ρl)φ′(ri,l(ρl)) =

ri,t≤rcut

ρt

Xi

ni,tri,t(ρt)φ′(ri,t(ρt))

(7)

The chemical potential of a ground-state lattice l is, in
turn, given by

µl = Ul(ρl) + Pl(ρl)/ρl

(8)

where r0(ρl) represents the nearest neighbor distance for
competing lattices at density ρl. This helps tighten the
optimization formulation by keeping density within a rea-
sonable range.

An objective function f (x) that fulﬁlls our optimiza-
tion goals must also be speciﬁed. We choose such an
objective function to evaluate to a ﬁnite scalar value
f (x) → f and to be conducive to maximizing the range
of densities ∆ρt = ρt,f − ρt,i for which the target lat-
tice exhibits a chemical potential lower than that of the
competing lattices. This is then deﬁned as

f = Xρt Yl

H[µl(ρl(ρt)) − µt(ρt)]

(10)

where the sum is over discretized target lattice densities
(each spaced a distance δ apart), ρl(ρt) is computed from
eq. 7, and H is again the Heaviside step function.

An additional constraint equation,

min{µl(ρl(ρt,o))} − µt(ρt,o) ≥ ∆

(11)

is introduced to specify the minimum acceptable chem-
ical potential diﬀerence ∆ between the target lattice at
an intermediate density point ρt,o and selected competing
lattices at the same pressure. Here, we use ρt,o = 1.39,
which was found in an earlier study22 to be in the mid-
dle of the density range of stability for a square lattice
designed for ∆ = 0 and the same pair potential form. In
practice, we have found that the post-optimization chem-
ical potential diﬀerence between the target lattice and
its closest selected competitor ∆µ ≡ min{µl(ρl(ρt,o))} −
µt(ρt,o) is approximately equal to the constraint ∆ in all
cases.

2. Numerical Solution Strategy

We implemented the optimization problem described
above in GAMS30, using the Basic Open-source Non-
linear Mixed INteger (BONMIN)32,33 solver with Inte-
rior Point OPTimizer (IPOPT)34 as the non-linear sub-
solver. This choice of solver permits us to use integer
valued functions such as in eq.(10) (i.e.
the Heaviside
function) as well as the remaining non-linear functions
present in the potential and system physics formulation.
In practice, each optimization begins by inputting an
initial guess for the pair potential parameter set that does
not violate the constraints of eq.(2)-(4) and specifying a
narrow target lattice density range [ρt,i, ρt,f ] containing
ρt,o to consider.

If the maximum attainable value of f is realized in
the optimization (i.e the maximum number of feasible
density points ∆ρt/δ = (ρt,f − ρt,i)/δ is achieved), the
boundaries of the density range are widened and the pre-
viously attained potential is used as the initial guess for

a new optimization. This procedure is repeated until
the optimization returns f < ∆ρt/δ, indicating that the
maximum density range of stability for a given chemi-
cal potential constraint ∆ was attained in the previous
optimization. We carry out the optimizations described
above for diﬀerent values of ∆ to explore how an imposed
chemical potential advantage of the target lattice aﬀects
the maximum attainable ∆ρt. As discussed in the results
section, there is a maximum value of ∆ above which a
feasible solution does not seem to exist for any density
range. While found values are not veriﬁably global due
to the local nature of the optimizer, they are optimal to
the best of our eﬀorts.

In addition to the explicit constraints described above,
only pair potentials that result in mechanically stable tar-
get ground-state structures (as determined from phonon
spectra analysis) were considered. Spontaneous assem-
bly of particles interacting via the optimized potentials
from the ﬂuid state into the target structure upon tem-
perature quenching was also veriﬁed at ρt,o using Monte
Carlo simulations (see supplemental material).

3. Competing Lattice Determination

In our previous work on inverse design of targeted
lattices,21,22 we sought pair potentials that simply maxi-
mized the density range of stability of the desired struc-
ture (∆ = 0). For that type of optimization, it was nec-
essary to choose a ﬁnite pool of competitive structures
to compare with the target lattice, ideally those with
the lowest values of chemical potential at the pressures
of interest (which are not generally known in advance).
We determined the composition of this competitive pool
from an iterative procedure. An initial set of structures
was selected (e.g., Bravais lattices plus a small number
of non-Bravais lattices or tilings) based on intuition and
knowledge obtained from earlier simulation studies on
similar pair potentials. An optimization was then per-
formed using the chosen competitive pool, followed by
a forward calculation of the ground-state phase diagram
with the optimized pair potential for densities in the tar-
geted range. Any new structures that appeared were sub-
sequently added to the previous competitive pool, and a
second optimization with the updated list of competi-
tive structures was completed. This process–updating
the competitive pool and optimizing the pair potential
considering the expanded list of possible lattices found
in forward calculations–was repeated until no new com-
peting lattice structures emerged.

In the present study, we repeat similar optimizations
but with the added requirement of a minimum chemi-
cal potential diﬀerence between the target and selected
competitors. The hypothesis is that such a constraint
will ﬁnd potentials displaying enhanced thermal stabil-
ity of the targeted phase. Note that one cannot enforce
a ﬁxed chemical potential diﬀerence between the target
lattice and all possible competitors. To understand why,

4

consider a representation of lattice structure deﬁned by
a set of primitive and basis vectors {v}. If {v} can be
modiﬁed continuously in some way (without adding or
removing particles), e.g., by a set of suitable parame-
ters {Θ}, then {v({Θ})} will then deﬁne a hyperspace
of continuously connected lattices with the target struc-
ture lt representing a speciﬁc point in this space. For
ground-state systems of a given pair potential at a spe-
ciﬁc pressure, state quantities such as µ depend on the
lattice structure (i.e. µ({v})) such that µ itself can be
represented as a hypersurface of continuously connected
lattices v({Θ}). Thus, one can always ﬁnd structures in
the neighborhood of the target lattice on the hypersur-
face with chemical potentials arbitrarily close to that of
the target.

Considering this, it is clear that one cannot enforce
a nonzero minimum chemical potential diﬀerence ∆ be-
tween the target and all possible competitive structures.
However, one can meaningfully constrain the µ hypersur-
face in the optimization by enforcing a minimum chemi-
cal potential diﬀerence ∆ between the target and a chosen
set of lattices {lg} that deﬁne ‘ﬂag points’ on the land-
scape. This helps achieve a standardized and well deﬁned
constraint depth that is feasible for the optimization. In-
deed, a similar approach was introduced by Zhang et al
for a related ∆µ optimization and justiﬁed under similar
premises.29

We provide an example for concreteness. The chosen
target square lattice can be represented as a point in
a larger Bravais subspace spanned by oblique primitive
vectors {vB({Θ})} with {Θ} consisting of an aspect ratio
b/a and primitive vector angle θ. Thus, the square lattice
is represented by v(1, π/2), while other Bravais lattices
like the triangular lattice are given by {v(1, π/3)} and so
on. The corresponding µ({v}) landscape of this Bravais
subset is then a function of (b/a, θ) (i.e. µ({v(b/a, θ)}).
As such, the ﬂag-point lattices we choose for enforcing
the depth constraints here are the triangular lattice and
a rectangular lattice which capture independent varia-
tions along the θ and b/a directions in the neighborhood
of the target (for an illustration of the resulting Bravais
chemical potential landscape from one of the optimized
potentials see ﬁgure 1S).35 Similar subspace arguments
can be made to account for elongated triangular (ET)
and snub-square (SS) non-Bravais lattices, where the for-
mer can be transformed into square by a row-shift and
the latter by a rotation of a single tile around its next
neighboring square tiles. Other tilings or non-Bravais
lattices can, in principle, be important for target lattice
stability, but we did not ﬁnd others that were relevant in
the present square-lattice design problem.

Given the above considerations, our ﬁnal competing
pool consisted of lattices determined from the iterative
forward procedure, some of which (those which naturally
belonged to a subspace that continuously deformed into
the square lattice) were also chosen as ﬂag-point lattices.
From the Bravais subspace, the ﬁnal competing pool con-
sisted of triangular, rectangular (REC) b/a = 1.17, and

oblique (OBL) b/a = 1.1, θ = 1.09 lattices, with trian-
gular and REC also serving as ﬂag points for the chemi-
cal potential constraint. Similarly, for the other relevant
non-Bravais subspaces, the competitive pool included one
SS lattice (b/a = 1.0) and three ET lattices (b/a = 1.07,
b/a = 1.20, and b/a = 1.23), with all but the last ET
lattice serving as ﬂag points for the chemical potential
constraint.

B. Melting Temperature Estimations

1. Z-method

The Z-method is a microcanonical molecular dynam-
ics (MD) simulation strategy for estimating the melt-
ing point of a crystal that does not require free energy
calculations.36 The approach is based on the idea that a
crystal remains metastable upon raising the temperature
until it reaches its superheating limit, where it is hy-
pothesized to have the same internal energy as the liquid
at the equilibrium melting temperature Tm. The name
is due to the fact that the estimate comes from the Z-
shaped (zig-zag) graph that one observes for the system
in the temperature T vs pressure P plane as it transforms
from the solid phase upon raising the energy at constant
volume. It has been applied for a variety of model sys-
tems and has been repeatedly tested for both accuracy
and variability.37–39 For our purposes here, where we seek
only estimates of melting temperatures to compare the
widely varying thermal stabilities of targeted assemblies
designed under various constraints, the Z-method pro-
vides an adequate guide.

Energy sweeps for the Z-method are carried out as fol-
lows. Initial particle positions are set in a perfect square
lattice, and initial velocities are chosen from a random
distribution and scaled to achieve a desired initial kinetic
energy. For a series of progressively increasing energies,
microcanonical MD simulation trajectories of N = 1024
particles (and a periodic square cell of length V 1/2 cho-
sen to set ρ = N/V = 1.39) are initiated with a time step
value of 0.001. After an initial pre-equilibration period
at each energy, averages of static quantities like tempera-
ture T and pressure P are taken every 1000 time steps for
at least 106 steps. Near the transition region, averages
for liquid and solid properties are taken separately with
the phase being determined by the translational order
parameter τ

τ (k) =

1
N

N

Xi=1

cos (k · ri)

(12)

Here, ri denotes particle positions vectors and k is a re-
ciprocal lattice vector. We chose k = 2π
l (1, 1) for this
purpose, where l denotes the lattice constant value at
density ρ. We use τ ≥ 0.5 to indicate solid conﬁgura-
tions and τ ≤ 0.1 to denote liquid conﬁgurations. These
assignments were additionally supported by monitoring

5

the mean square displacement of the particles as a func-
tion of time.

Reported estimates of Tm are averages of the tempera-
ture of the superheating limit of the solid obtained from
twelve independent energy sweeps.

2. Hysteresis method

As further corroboration of the estimates obtained
from the Z-method described above, we also carry out
melting point estimations by the hysteresis method.
This method is based on analysis of superheating
and supercooling processes in the framework of nucle-
ation theory and validated through molecular dynamics
simulations.40,41 The basic approach is to carry out a
simple heating and cooling sweep of the system near the
melting point to determine the temperature of superheat-
ing T+ and supercooling T−. The melting point Tm is
then estimated from

Tm = T+ + T− −pT+T−

(13)

As such, we carry out Monte Carlo simulations in the
canonical ensemble for N = 400 particles in a periodic
square cell of length V 1/2 adjusted to ﬁx density at ρ =
N/V = 1.39. Simulations are started from the crystal
phase and heated until melting is achieved. The system is
then cooled from the liquid back into the crystal. The T+
and T− points are obtained from the resulting hysteresis
loop in an energy vs temperature diagram.

III. RESULTS AND DISCUSSION

Using our described ground state optimization proce-
dure, we were able to obtain pair potential parameters for
eq. 1 that satisﬁed all of our objective goals. That is, we
found potentials that a) were convex repulsive, b) maxi-
mized the density range ∆ρt for which the square lattice
is the stable structure and c) were such that the target
at density ρt,o displayed a speciﬁed minimum chemical
potential advantage ∆µ over the ﬂag-point competitors
(as elaborated in the methods section). The resulting
relationship between ∆ρt subject to increasing values of
∆µ for the optimized potentials is plotted in Figure 1.

As seen, there is a clear negative correlation between
∆µ and ∆ρt. While the exact values of ∆ρt may change
based on the choice of non-linear subsolver (also given
local nature of the solutions), test runs using a diﬀerent
subsolver showed values that yielded a very similar trend
(not shown). In other words, there appears to be a clear
compromise with this potential form between designing
for high stability at a given density and designing for
stability with respect to changes in density. There also
appears to be a limit with this potential form to how
stable one can make the square lattice ground state at
ρt,o relative to the ﬂag-point lattices (∆µ ≈ 0.23). For

6

FIG. 1. The width of the density range ∆ρt for which the
square lattice is the stable ground-state structure for opti-
mized parameters of the pair potential in eq. 1 versus the
minimum chemical potential advantage ∆µ of the square lat-
tice ground state at ρt,o over the ﬂag-point lattices at that
pressure. Blue circles indicate results using the solver BON-
MIN with IPOPT as the non-linear subsolver. Dashed lines
are guides to the eye.

instance, we were only able to ﬁnd solutions consistent
with larger ∆µ than those shown in Figure 1 if we allowed
the pair potential to violate the convexity constraint.

In terms of judging the overall quality of the opti-
mizations, we can compare to one result from a previous
study22, where a simulated annealing algorithm was used
to ﬁnd parameters for the potential of eq. 1 that maxi-
mized the range of densities for which the square lattice
was the stable ground-state structure (with no chemi-
cal potential constraint). In that paper, ∆ρt = 0.39 was
found for the optimized potential, which displayed a min-
imum chemical potential advantage of ∆µ ≈ 0.01 over
the ﬂag-point lattices considered here. This can be com-
pared to that of the potential obtained in this study with
a ∆µ = 0.01 constraint, which exhibits a 50% wider den-
sity range, ∆ρt = 0.58. While reported solutions are not
veriﬁably global, the fact that such a large improvement
in the objective function was obtained points to one of
the advantages that the present rigorous framework has
over heuristic optimization approaches like simulated an-
nealing (a global optimizer in principle).

We now explore how features of the optimized inter-
particle potentials help to explain the observed trade-oﬀ
associated with designing for a large chemical potential
advantage of the target ground-state structure at a given
density versus designing for target stability over a wide
range of density. In Figure 2, the pair potentials corre-
sponding to ∆µ=[0.01-0.23] are shown (for the full list
of potential parameters values see tables S1 and S2)35.
While no pronounced features can be expected for strictly
convex-repulsive interactions, two important aspects of
the potential do manifest. As ∆µ increases, so does the
steepness of the core repulsion (for r <
∼ 0.8) as well as

FIG. 2. Optimized pair potentials φ(r) for diﬀerent chemical
potential constraints as a function of radial distance up to the
cut-oﬀ at rcut=2.27183. The inset shows a log-log plot of the
same potentials.

the rate of radial decay towards the cut-oﬀ point (for
r >
∼ 1.2). The latter part can be seen more clearly in the
log-log inset where intermediate features of core repulsion
and radial decay can be seen to lie approximately between
the two extrema potentials corresponding to ∆µ = 0.01
and ∆µ = 0.23. As we discuss next, this sharpening
of radial-dependent features with increasing ∆µ is what
provides the chemical potential advantage of the target
over its competitors, but at the cost of target lattice sta-
bility at other densities.

To look closer into the relation between pair potential
form and target stability, it is helpful to recall that the
chemical potential expression for a ground state system is
given as µl = Ul + Pl/ρl. Using the energy and pressure
expressions in (5) and (6), it is possible to recast this
expression as

µl =

ri,l≤rcut

Xi

ri,l≤rcut

=

Xi

ni,l(cid:20) φ(ri,l(ρl))

2

−

ri,l(ρl)φ′(ri,l(ρl))

4

(cid:21) (14)

ni,lψ(ri,l(ρl))

where ψ(r) has been deﬁned as

ψ(r) ≡

φ(r)

2

−

rφ′(r)

4

(15)

As such, we see chemical potential depends not only on
the pair potential but also on its gradient. Analyzing
the radial dependence of ψ(r) will thus help to under-
stand how the various lattice coordination shells at their
respective radial separations contribute to the chemical
potential and how they bias the functional form of the
optimized potentials leading to the observed negative cor-
relation between ∆µ and ∆ρt.

7

FIG. 3. a) The function ψ(r) of eq. 15 for optimized potentials with ∆µ = 0.01 (blue) and ∆µ = 0.23 (red), respectively.
Bars indicate fractional contributions of each of the ﬁrst three coordination shells to the total chemical potential for the square
lattice at optimized density ρo = 1.39. Bars are located at the respective coordination-shell distances. The contribution for the
third coordination shell of the ∆µ = 0.23 potential is not visible at this scale (∼ 10−4). b) ψ(r) for the ∆µ = 0.01 (blue) and
∆µ = 0.23 (red) optimized pair potentials. Shaded areas indicate the ranges of the ﬁrst and second neighbor distances (from
left to right respectively) of the target lattice for densities where it is the stable ground-state structure.

We illustrate these points by plotting ψ(r) for opti-
mized interactions corresponding to the limiting cases
of strongly (∆µ = 0.23) and weakly (∆µ = 0.01) con-
strained chemical potential advantage of the square lat-
tice ground state over the ﬂag point structures. The
plot in ﬁgure 3a) compares both ψ(r) and the fractional
coordination-shell contributions to the chemical poten-
tial of the square lattice for the two potentials. As can
be seen, interactions obtained with the larger ∆µ con-
straint impart greater emphasis on ﬁrst-shell contribu-
tions that translate into potentials with harder cores and
faster decays at these distances. These ψ(r) features help
the square lattice realize a lower chemical potential than
the triangular lattice whose more densely packed ﬁrst-
coordination shell lies at a separation similar to that of
the square lattice. Equally important is the shoulder-
like region that decays between the square lattice’s ﬁrst
and second coordination shells. The role of this shoulder
is to destabilize the closely competitive rectangular and
elongated triangular lattices that have second coordina-
tion shells at separations within the shoulder region and
thus contribute to their higher values of chemical poten-
tial compared to that of the square lattice (See table S3
for a list of µl,i/µ values of selected lattice competitors
shells up to the third coordination)35.

The potential shape trends obtained from optimiza-
tions with the high ∆µ constraint described above can
be contrasted to the muted features that manifest when
a smaller ∆µ constraint is applied (which leads to con-
siderably larger ∆ρt). Shown in ﬁgure 3b) is also ψ(r) for
the two cases, but now presented along with shaded ar-
eas to indicate the range of ﬁrst- and second-coordination
shell distances of the corresponding stable square lat-
tices. The key point is that small changes in coordi-
nation distances (due to changes in density) would have

very diﬀerent consequences for the chemical potential of
the ∆µ = 0.23 system as compared to the ∆µ = 0.01
system due to their diﬀerent forms for ψ(r). For the
∆µ = 0.23 system, small changes in density and coor-
dination distances will produce pronounced changes in
ψ(r) and hence the chemical potential. As a result, the
speciﬁc shape that provided great chemical potential ad-
vantage for the square lattice at ρt,o is no longer able
to favor the structure at even modestly lower or higher
densities. In contrast, the slower varying form of ψ(r) for
the ∆µ = 0.01 system, while providing reduced chemical
potential advantage at ρt,o, is able to keep the square
lattice stable over a wider density range. The inverse re-
lationship in ﬁgure 1 emerges as a natural consequence
of this trade oﬀ.

Moving on to understand how designing potentials for
large ∆µ for the square lattice ground state at ρt,o = 1.39
aﬀects the thermal stability of the target structure, we
use the Z-method and the hysteresis method to estimate
the corresponding melting temperatures Tm at that den-
sity. As can be seen in Figure 4, the potentials opti-
mized with larger ∆µ constraints also show higher Tm
irrespective of the estimation method. For instance,
while the ∆µ=0.01 system has a melting point at around
Tm=0.02, the melting point for the ∆µ=0.23 potential is
approximately Tm=0.2–an order of magnitude greater.
A slightly more pronounced but largely similar result
is found from the hysteresis method (Tm = 0.02 to
Tm = 0.22 at ∆µ = 0.01 to ∆µ = 0.23 respectively).
Considering the ψ(r) analysis presented above, this trend
makes intuitive sense. Potentials designed with larger ∆µ
constraints impose greater penalties to target lattice de-
formation, and hence a higher average energy is required
to move particles from their perfect lattice positions.
This apparently translates directly to a higher melting

m

T

0.25

0.2

0.15

0.1

0.05

0

0

Z-method
Hysteresis method

0.05

0.1

0.15

0.2

0.25

∆µ

FIG. 4. Estimated melting point of the targeted square lattice
ρt,o = 1.39 as a function of the minimum chemical potential
advantage ∆µ of the square lattice ground state at ρt,o over
the ﬂag-point lattices at that pressure. Results obtained from
the Z-method and the hysteresis method, respectively. Tem-
perature in units of ǫ/k. Dashed lines are guides to the eye.

point for the structure. A similar argument can be made
based on the discussion of the µ hypersurface in the meth-
ods section. Since ∆µ captures an eﬀective ‘well depth’
for the target structure, imposing higher ∆µ has the ef-
fect of creating greater ‘restoring forces’ on the target
(i.e. higher eigenvalues of the µ Hessian).29 This results
in increased mechanical stability at the ground state and
a correspondingly higher melting point as shown here.

Finally, an important question arises when comparing
back to Figure 1. Since we probed the melting points
along a path where both ‘range’ (∆ρt) and ‘depth’ (∆µ)
change simultaneously, how does Tm change if we hold
a particular depth constant and vary the range, or vice
versa? From our discussion so far, we expect that depth
alone will determine the thermal trend while the range
will be largely inconsequential. Indeed, test runs where
we probed systems with the same depth but diﬀerent
ranges yielded scatter around a mean value, whereas
holding range constant and varying depth produced melt-
ing points consistent with 4 (not shown). Thus, for our
inverse optimized pair potential, ∆µ of the target in the
ground state appears to strongly correlate with the ther-
mal stability of the assembly, while the corresponding
density range of stability has no such clear connection to
the melting temperature.

IV. CONCLUSION

We have used inverse methods of statistical mechan-
ics to gain new insights into the trade-oﬀ between de-
signing interactions for stability of a target structure
with respect to changes in temperature versus density.
Speciﬁcally, we have explored the consequences of con-

8

straining the minimum chemical potential advantage of
a target square lattice ground state at a prescribed den-
sity ρt,o over select competitors (∆µ or ‘depth’ on the
µ landscape) while designing potentials that maximize
the range of density where the target ground state is sta-
ble (∆ρt). The resulting constrained nonlinear optimiza-
tion problem was solved numerically. For the isotropic,
convex-repulsive pair interactions considered here, pair
potentials designed with a larger ∆µ constraint exhib-
ited a narrower range of density stability ∆ρt. The rea-
sons for this compromise are apparent when examining
the radially-dependent forms of the optimized pair po-
tentials and their gradients. To enable high stability at a
given density, features in the potential and its derivative
must align with speciﬁc coordination shells to help pro-
duce the desired diﬀerences in chemical potential. When
such features are present, however, the resulting target
structures can lose stability with even modest changes in
density.

We have also veriﬁed, via MD and Monte Carlo simu-
lations, that potentials exhibiting ground states designed
with larger ∆µ constraints have higher melting temper-
atures at the target density. Preliminary tests further
suggests that it is ∆µ alone, and not ∆ρt, that correlates
with Tm. Both results are in accord with the idea that
∆µ constraints ensure restoring forces on the µ hyper-
surface that resist deformation (and ultimately melting)
of the target structure.

ACKNOWLEDGMENTS

T.M.T. acknowledges support of the Welch Foundation
(F-1696) and the National Science Foundation (CBET-
1403768). We also gratefully acknowledge many insight-
ful and productive conversations with Dr. Avni Jain
about the ground-state calculations in this work, as well
as her help with comparing our results to those obtained
from earlier simulated annealing approaches to inverse
design.

1A. Luque and A. Marti, Nature Photonics 5, 137 (2011).
2R. Armiento, B. Kozinsky, M. Fornari, and G. Ceder, Physical
Review B 84, 014103 (2011).
3V. Mlinar, Annalen der Physik 527, 187 (2015).
4C. M. Soukoulis and M. Wegener, Nature Photonics 5, 523
(2011).
5S. J. Corbitt, M. Francour, and B. Raeymaekers, Journal of
Quantitative Spectroscopy & Radiative Transfer 158, 3 (2015).
6M. M. Hossain and M. Gu, Laser Photonics Reviews 8, 233
(2014).
7C. N. Likos, Physics Reports 348, 267 (2001).
8Z. Zhang and S. C. Glotzer, Nano Letters 4, 1407 (2004).
9E. Auyeung, W. Morris, J. E. Mondloch, J. T. Hupp, O. K.
Farha, and C. A. Mirkin, Journal of the American Chemical
Society 137, 1658 (2015).

10J. Zhang, E. Luijten, and S. Granick, Annual Review of Physical

Chemistry 66, 581 (2015).

11P. F. Damasceno, M. Engel, and S. C. Glotzer, Science 337, 453

(2012).

12Y. Zhao, L. Shang, Y. Cheng, and Z. Gu, Accounts of Chemical

Research 47, 3632 (2014).

9

13S. Torquato, Soft Matter 5, 1157 (2009).
14A. Jain, J. A. Bollinger, and T. M. Truskett, AlChE Journal 60,

(2009).

29G. Zhang, F. H. Stillinger, and S. Torquato, Physical Review E

2732 (2014).

88, 042309 (2013).

15E. Marcotte, F. Stillinger, and S. Torquato, Journal of Chemical

Physics 134, 164105 (2011).

16M. C. Rechtsman, F. H. Stillinger, and S. Torquato, Physical

Review letters 95, 228301 (2005).

30GAMS Development Corporation, “General Algebraic Modeling
System (GAMS) Release 24.2.3,” Washington, DC, USA (2015).
31J. O. Hirschfelder, C. F. Curtiss, and R. B. Bird, Molecular

Theory of Gases and Liquids (John Wiley & Sons, 1954).

17E. Edlund, O. Lindgren, and M. N. Jacobi, Physical Review

32P. Belotti, J. Lee, L. Liberti, F. Margot, and A. Waechter, Op-

Letters 107, 085503 (2011).

18M. Torikai, Journal of Chemical Physics 142, 144102 (2015).
19E. Marcotte, F. Stillinger, and S. Torquato, Journal of Chemical

Physics 138, 061101 (2013).

timization Methods & Software 24, 597 (2009).

33“BONMIN,” http://www.gams.com/dd/docs/solvers/bonmin.pdf,

last retrieved 8/29/2014.

34A. Wächter and L. T. Biegler, Mathematical programming 106,

20E. Edlund, O. Lindgren, and M. N. Jacobi, Journal of Chemical

25 (2006).

Physics 139, 024107 (2013).

21A. Jain, J. R. Errington, and T. M. Truskett, Soft Matter 9,

3866 (2013).

22A. Jain, J. R. Errington, and T. M. Truskett, Physical Review

X 4, 031049 (2014).

23A. Jain, J. R. Errington, and T. M. Truskett, Journal of Chem-

ical Physics 139, 141102 (2013).

24E. Jagla, Physical Review E 58, 1478 (1998).
25E. Jagla, Journal of Chemical Physics 110, 451 (1999).
26A. Scala, M. R. Sadr-Lahijany, N. Giovambattista, S. V.
Buldyrev, and H. Stanley, Physical Review E 63, 041202 (2000).
27M. S. Shell, Thermodynamics and Statistical Mechanics: An In-
tegrated Approach (Cambridge University Press, 2015) Chap. 11.
28S. Prestipino, F. Saija, and G. Malescio, Soft Matter 5, 2795

35Available as supplementary material.
36A. B. Belonoshko, N. Skorodumova, A. Rosengren, and B. Jo-

hansson, Physical Review E 73, 012201 (2006).

37A. B. Belonoshko, S. Davis, N. Skorodumova, P. Lundow,
A. Rosengren, and B. Johansson, Physical Review B 76, 064121
(2007).

38D. Alfe, C. Cazorla, and M. Gillan, Journal of Chemical Physics

135, 024102 (2011).

39J. Bouchet, F. Bottin, G. Jomard, and G. Zerah, Physical Re-

view B 80, 094102 (2009).

40S.-N. Luo, A. Strachan, and D. C. Swift, Journal of Chemical

Physics 120, 11640 (2004).

41S.-N. Luo, T. J. Ahrens, T. Cagin, A. Strachan, W. A. Goddard,

and D. C. Swift, Physical Review B 68, 134206 (2003).

