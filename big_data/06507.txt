Energy-Aware Cooperative Wireless Networks with

Multiple Cognitive Users

Mahmoud Ashour, Member, IEEE, M.Majid Butt, Senior Member, IEEE,

Amr Mohamed, Senior Member, IEEE, Tamer ElBatt, Senior Member, IEEE, Marwan Krunz, Fellow, IEEE

1

6
1
0
2

 
r
a

 

M
1
2

 
 
]
I

N
.
s
c
[
 
 

1
v
7
0
5
6
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—In this paper, we study and analyze cooperative
cognitive radio networks with arbitrary number of secondary
users (SUs). Each SU is considered a prospective relay for the
primary user (PU) besides having its own data transmission
demand. We consider a multi-packet transmission framework
which allows multiple SUs to transmit simultaneously thanks to
dirty-paper coding. We propose power allocation and scheduling
policies that optimize the throughput for both PU and SU
with minimum energy expenditure. The performance of the
system is evaluated in terms of throughput and delay under
different opportunistic relay selection policies. Towards this
objective, we present a mathematical framework for deriving
stability conditions for all queues in the system. Consequently, the
throughput of both primary and secondary links is quantiﬁed.
Furthermore, a moment generating function (MGF) approach
is employed to derive a closed-form expression for the average
delay encountered by the PU packets. Results reveal that we
achieve better performance in terms of throughput and delay
at lower energy cost as compared to equal power allocation
schemes proposed earlier in literature. Extensive simulations are
conducted to validate our theoretical ﬁndings.

Index Terms—Cognitive relaying, opportunistic communica-

tion, throughput, delay, relay selection.

I. INTRODUCTION

Cognitive radio networks have emerged as an efﬁcient
solution to the problem of spectrum scarcity and its under-
utilization. In a cognitive radio network, the secondary users
(SUs) exploit primary users’ (PUs) period of inactivity to
enhance their performance provided that PUs’ performance re-
mains unaffected. Depending on the mode of interaction of the
primary and the secondary users, the cognitive radio networks
are classiﬁed as interweave, underlay and overlay networks.
In the last decade or so, the industry and academia has shown
overwhelming interest in the application of cognitive radios
in different networking solutions. Reference [2] provides a
comprehensive overview of the cognitive radio fundamentals
and research activities.

The material

in this paper has been presented in part

in ISIT 2014,

Honolulu, Hi, USA [1].

Mahmoud Ashour is with the Department of Electrical Engineering and
Computer Science, The Pennsylvania State University, PA, USA. E-mail:
mma240@psu.edu.

M. Majid Butt is with the Center for Future Networks, Trinity College,

University of Dublin, Ireland. E-mail: majid.butt@ieee.org.

Amr Mohamed is with Computer Science and Engineering Dept., Qatar

University, Doha, Qatar. E-mail: amrm@qu.edu.qa.

Tamer Elbatt is with the Wireless Intelligent Networks Center, Nile Univer-
sity, Giza, Egypt and EECE Dept., Faculty of Engineering, Cairo University,
Giza, Egypt. Email: telbatt@ieee.org.

Marwan Krunz is with the Department of Electrical and Computer Engi-

neering, University of Arizona, AZ, USA. Email: krunz@ece.arizona.edu.

On the other hand, cooperative diversity has been widely
investigated in pursuit of combating multipath fading [3, 4].
Incorporating cooperation into cognitive radio networks results
in substantial performance gains in terms of throughput and
delay for both primary and secondary nodes [5]. The SUs help
the PUs to transmit their data, and create opportunities for
their own data transmission at the same time. The cooperation
between the PUs and the SUs vary from just sharing informa-
tion about queue states, channel state information (CSI), and
primary packet transmission activity to the use of SUs as cog-
nitive relays. Typically, relaying is carried out over orthogonal
channels due to the half-duplex communication constraint at
the relays [3]. However, some of the recent solutions overcome
this limitation by accommodating simultaneous transmissions
in a single slot [6, 7, 8]. This is achieved through space-time
coding [6] or dirty-paper coding (DPC) [7, 8]. Conventionally,
zero forcing and more recently prior zero forcing [9] has
been employed to mitigate the SU signal interference with the
PU signals. On the other side, for cooperative cognitive radio
networks with multiple SUs with their own data transmission
demands, employing DPC allows one SU to transmit new data
while the other SU helps the PU by relaying its data. Thus,
the spectral efﬁciency of the system is enhanced.

In literature, there is a rich volume of recent work focusing
on cooperation in cognitive relay networks. The beneﬁts
of cooperative relaying has been discussed and analyzed in
[10, 11, 12]. In [10], authors derive the maximum sustained
throughput of a single SU to maintain a ﬁxed throughput
for PU with and without relaying. They used a dominant
system approach to guarantee the queue stability of both SU
and PU while overcoming the queues interaction. A cognitive
system comprising a single PU and multiple SUs along with
multiple relays is considered in [12], where a proportion of
the secondary relays help the PU in communication while
a relay selection is performed from the remaining relays to
give simultaneous access to the SU. The authors show that
there exists an optimal number of cooperating relays with
the PU that achieve optimal outage performance. In [13],
the authors also discuss a cognitive relay selection problem
using optimal stopping theory. Reference [14] addresses a
cognitive radio cooperation model where the SU can transmit
its data along with primary transmission, but cooperates by
deferring its transmission when the PU is transmitting. The
authors in [15] address a cooperative cognitive relay network
where both primary and secondary nodes use cognitive relays
for data transmission. The relays help the PUs empty their
queues fast and thereby, the throughput for the SUs increases

as a result. SU throughput stability regions for cooperative
cognitive networks have been derived for cooperative cognitive
radio networks in different settings in [10, 16].

Krikidis et al. address different protocols for a cognitive
cooperative network and the stable throughput for both pri-
mary and the secondary networks is derived. In this paper,
we adopt the model presented in [7] and employ DPC. We
consider a cognitive network with arbitrary number of SUs co-
existing with a PU and sharing one common relay queue. We
propose power allocation and scheduling policies that enhance
the throughput of both primary and secondary links using the
least possible energy expenditure. The summary of the main
contributions of this work is as follows.

• We propose an energy-efﬁcient adaptive power (AP) allo-
cation scheme for the SUs that enhances the throughput
of both primary and secondary links. Energy-efﬁcient
transmission is achieved via exploiting instantaneous CSI
to adapt the transmission powers at all SUs.

• We introduce two SU scheduling policies, which pri-
oritize primary or secondary throughput enhancement
according to the network requirements. We analyze the
performance of both policies in conjunction with equal
and adaptive power allocation schemes.

• We develop a generic mathematical framework to derive
closed-form expressions for both PU and SU throughput,
and PU average delay. The mathematical analysis is
performed for an arbitrary number of SUs coexisting
with a PU. A detailed analysis is performed for each
combination of power allocation and SU scheduling poli-
cies. We validate our theoretical ﬁndings via simulations.
Results reveal
that AP-based schemes yield superior
performance compared to EP allocation proposed in [7],
with signiﬁcantly less energy cost.

2

Fig. 1. Cognitive radio network model under consideration. The (logical)
CSB is shown to coordinate the activities of the common relay queue.

words, if the interference is known a priori at the transmitter,
DPC renders the link between the transmitter and its intended
receiver interference-free.

B. Channel outage

√

√

hx + z, where

We present the basic deﬁnition of an outage event and
the corresponding outage probability calculation. Consider a
h and x denote
channel with output y =
the fading coefﬁcient and the input, respectively. Moreover,
the noise z is modelled as zero-mean circularly symmetric
complex Gaussian random variable with variance N0. For a
target transmission rate R0, an outage occurs if the mutual
information between the input and output is not sufﬁcient to
support that rate. The probability of such event, for a channel
with average power constraint P0, is
2R0 − 1
P0/N0

(cid:20)

(cid:21)

P

h <

.

(1)

The rest of this paper is organized as follows. Section II
presents the information-theoretic background and preliminar-
ies needed in the sequel. Section III introduces the system
model and the proposed cooperation strategy. The opportunis-
tic relay selection and power allocation strategies are presented
in Section IV along with their mathematical analysis in Section
V. Numerical results are then presented in Section VI. Finally,
concluding remarks are drawn in Section VII.

II. BACKGROUND AND PRELIMINARIES

A. Dirty-paper coding

(1/m)(cid:80)m

DPC was ﬁrst introduced in [17] and we brieﬂy state its
implication. Consider a channel with output y = x + q + z,
where x, q and z denote the input, interference, and noise,
respectively. The input x ∈ Cm satisﬁes the power constraint
i=1 |xi|2 ≤ P0. We assume that q and z are zero-
mean Gaussian vectors with covariance matrices QIm and
N0Im, respectively, where Im denotes the m × m identity
matrix. If the interference q is unknown to both transmitter and
receiver, the channel capacity is given by log(1+P0/(Q+N0))
(bits/channel use). However, if q is known to the transmitter
but not the receiver, the channel capacity is shown to be
the same as that of a standard ”interference free” Gaussian
channel with signal-to-noise ratio P0/N0 using DPC. In other

III. SYSTEM MODEL

We consider the cognitive radio system shown in Fig. 1.
The system comprises a PU p that transmits its packets to
a primary destination Dp. A cognitive network consisting
of an arbitrary number of SUs coexists with the primary
network. The number of SUs is denoted by N and we refer
to the set of SUs by S = {si}N
i=1. Each SU has its own
data that requires to be delivered to a common secondary
destination Ds. All nodes are equipped with inﬁnite capacity
buffers. Time is slotted, and the transmission of a packet
takes exactly one time slot. The duration of a time slot is
normalized to unity and hence, the terms power and energy
are used interchangeably in the sequel. We take into account
the bursty nature of the source through modelling the arrivals
at the PU as a Bernoulli process with rate λp (packets/slot).
In other words, at any given time slot, a packet arrives at the
PU with probability λp < 1. The arrival process at the PU
is independent and identically distributed (i.i.d.) across time
slots. On the other hand, the SUs are assumed backlogged, i.e.,
SUs always have packets awaiting transmission. We assume
that the SUs perfectly sense the PU’s activity, i.e., there is no
chance of collision between the PU and any of the secondary
users. A node that successfully receives a packet broadcasts

an acknowledgment (ACK) declaring the successful reception
of that packet. ACKs sent by the destinations are assumed
instantaneous and heard by all nodes error-free.

The channel between every transmitter-receiver pair ex-
hibits frequency-ﬂat Rayleigh block fading, i.e., the channel
coefﬁcient remains constant for one time slot and changes
independently from one slot to another. The scalars hri[n] and
hsi[n] denote the absolute squared fading coefﬁcient of the
channels that connect the ith SU to Dp and Ds, respectively,
at the nth time slot. Similarly, the absolute squared fading
coefﬁcient of the channels that connect the PU to Dp and
si, at the nth time slot, are denoted by hp[n] and hpsi [n],
respectively. According to the Rayleigh fading assumption,
hri[n], hsi [n], and hpsi[n] are exponential random variables
with means σ2, for all i = 1, . . . , N. We denote an expo-
nential random variable with mean σ2 by exp(σ2). Then, we
have hp[n] ∼ exp(σ2
p). All links are considered statistically
equivalent except for the link p → Dp. We assume that
p < σ2 to demonstrate the beneﬁts of cooperation [18]. For
σ2
the ease of exposition, we set σ2 = 1 throughout the paper. All
communications are subject to additive white Gaussian noise
of variance N0.

Next, we present the queuing model of the system followed

by the description of the employed cooperation strategy.

A. Queuing Model

The queues involved in the system analysis, shown in Fig.

1, are described as follows:

• Qp: a queue that stores the packets of the PU correspond-
ing to the external Bernoulli arrival process with rate λp.
• Qsi: a queue that stores the packets at the ith SU, where
i ∈ {1, . . . , N}.

• Qr: a queue that stores PU packets to be relayed to Dp.
Having independent relay queues for all SUs makes exact
performance analysis intractable with the increasing number
of users. To address this complexity, Krikidis et al. introduced
the idea of a common ’ﬁctitious’ relay queue Qr in [7], which
is maintained by a so-called cluster supervision block (CSB)
that controls and synchronizes all the activities of the cognitive
cluster. Along the lines of [7], we assume the existence
of a common relay such that SUs can perfectly exchange
information with the CSB with a negligible overhead. The
channels S → Dp, Ds are assumed known instantaneously at
the CSB [7, 19].

The instantaneous evolution of queue lengths is captured as
Qi[n + 1] = (Qi[n] − Li[n])+ + Ai[n], i ∈ {p, r} ∪ S (2)
where (x)+ = max(x, 0) and Qi[n] denotes the number of
packets in the ith queue at the beginning of the nth time slot.
The binary random variables taking values either 0 or 1, Li[n]
and Ai[n], denote the departures and arrivals corresponding to
the ith queue in the nth time slot, respectively.

B. Cooperation Strategy

3

2) If the packet is successfully decoded by Dp, it broadcasts

an ACK and the packet is dropped from Qp.

3) If the packet is not successfully received by Dp yet
successfully decoded by at
least one SU, an ACK
is broadcasted and the packet is buffered in Qr and
dropped from Qp.
4) If Dp and S fail to decode the packet, it is kept at Qp

for retransmission in the next time slot.

5) When the PU is sensed idle, if Qr is non-empty, two out
of all SUs transmit simultaneously. One SU is selected
to relay a packet from Qr to Dp and is denoted by r∗.
Another SU is selected to transmit a packet of its own
to Ds and is denoted by s∗. Otherwise, if Qr is empty,
1. The SUs’
one SU is selected to transmit a packet to Ds
selection policies are explained in Section IV-B.

6) If the packets transmitted by the SUs are successfully re-
ceived by their respective destinations, ACKs are broad-
casted and these packets exit the system. Otherwise, the
packet that experiences unsuccessful transmission is kept
at its queue for later retransmission.

IV. POWER ALLOCATION AND NODE SELECTION

In this section, we introduce the adaptive power allocation
and opportunistic relay selection strategies for an arbitrary
number of SUs, N ≥ 2. We propose a power allocation policy
that minimizes energy consumption at each SU as compared
to a ﬁxed power allocation policy in [7]. In the sequel, node
selection policy refers to the choice of the SU that relays a
primary packet from Qr to Dp, and the SU that transmits a
packet from its own queue to Ds, i.e., the selection of r∗ and
s∗. The availability of CSI for all the channels (and thereby
incurred interference) at the CSB is exploited to perform power
allocation and node selection online, i.e., every time slot.

A. Power Allocation

Whenever Qp is non-empty, the PU transmits a packet with
average power P0. However, when the PU is idle and Qr
is non-empty,
two SUs out of N transmit simultaneously
by employing DPC [17]. One SU relays a primary packet
to Dp while the other transmits a secondary packet to Ds.
Since all SUs can perfectly exchange information with the
CSB, Qr is accessible by both SUs selected for transmission.
Therefore, the transmission of r∗ is considered a priori known
interference at s∗. Accordingly, s∗ adapts its signal to see an
interference-free link to Ds using the result stated in Section
II-A. On the other hand, s∗ transmits a packet from its own
queue which is not accessible by r∗. Thus, the transmission
of s∗ causes an interference on the relay link, i.e., r∗ → Dp.
The achievable rate region on this Z-interference channel at
the nth time slot is given by

(cid:21)

(cid:20)
(cid:20)

Rs∗ [n] = log

Rr∗ [n] = log

1 +

1 +

Ps∗ [n]hs∗ [n]

N0

Pr∗ [n]hr∗ [n]

N0 + Ps∗ [n]hI[n]

(cid:21)

(3)

(4)

The employed cooperative scheme is described as follows.
1) The PU transmits a packet whenever Qp is non-empty.

1Note that two SUs can be selected for transmission if Qr is empty.
However, this requires multi-packet reception capability at the secondary
destination which is out of the scope of this paper.

where Ps∗ [n] and Pr∗ [n] denote the instantaneous transmit
powers of s∗ and r∗, respectively. The instantaneous abso-
lute squared fading coefﬁcients of the secondary, relay, and
interference links are denoted by hs∗ [n], hr∗ [n], and hI[n],
respectively. We denote the links s∗ → Ds, r∗ → Dp, and
s∗ → Dp by the secondary, the relay, and the interference
link, respectively. Hereafter, we omit the temporal index n
for simplicity. Nevertheless, it is implicitly understood that
power allocation and node selection are done on a slot-by-
slot basis. In this work, we focus on developing an adaptive
power allocation scheme for the transmitting SUs that use a
ﬁxed transmission rate R0. Speciﬁcally, our multi-criterion
objective is to enhance primary and secondary throughput
while minimizing the energy consumption at each SU. The
rates given by (3) and (4) stimulate thinking about how power
is allocated to both transmitting SUs.

Next, we investigate two different power allocation policies
for the SUs, namely, equal power (EP) allocation and adaptive
power (AP) allocation. It is worth noting that power allocation
and node selection are performed for the SUs since we have
no control on the PU. Thus, in the following lines, we focus
on the slots in which the PU is idle.

1) Equal Power Allocation: This policy assigns equal trans-
mission powers to the SUs as proposed in [7] and serves as
a baseline scheme in this work. Whenever an SU transmits,
it uses an average power Pmax. Speciﬁcally,
if an SU is
transmitting alone, e.g., Qr is empty, it uses a power Pmax.
If two SUs transmit simultaneously, e.g., Qr is non-empty,
Ps∗ = Pr∗ = Pmax.

2) Adaptive Power Allocation: Unlike EP allocation, we
exploit the CSI available at the CSB to propose an AP alloca-
tion scheme that minimizes the average power consumption
at each SU. We use (3) and (4) along with (1) to derive
conditions on Ps∗ and Pr∗ for successful transmission at a
target transmission rate R0. These conditions are

Ps∗ ≥ (2R0 − 1)N0
Pr∗ ≥ (2R0 − 1)[N0 + Ps∗ hI]

hs∗

hr∗

(5)

(6)

.

A transmitter that violates the condition on its transmission
power experiences a sure outage event. Furthermore, we
impose a maximum power constraint at each SU, where
Ps∗ , Pr∗ ≤ Pmax. It is worth noting that Ps∗ is computed ﬁrst
according to (5) followed by the computation of Pr∗ according
to (6). In a given slot, if Pmax is less than the power required
to guarantee a successful transmission for a given SU, i.e.,
Pmax is less than the right hand sides of either (5) or (6), the
CSB sets the power of that SU to zero to avoid a guaranteed
outage event. Clearly, this results in increasing the throughput
of the PU due to reduction in the amount of interference caused
by the transmission of s∗ on the relay link in the time slots
where s∗ refrains from transmitting. Moreover, compared to
EP allocation, energy wasted in slots where a sure outage event
occurs is now saved.

4

B. Node Selection Policies

We consider a system that assigns full priority to the
PU to transmit whenever it has packets. Therefore, the SUs
continuously monitor the PU’s activity seeking an idle time
slot. When the PU is sensed idle, the SUs are allowed to
transmit their own and/or a packet from the common queue
Qr. Note that it is possible to transmit only one packet by the
SUs in the following scenarios:

1) If Qr is empty, i.e., no primary packet to be relayed.
Then, we select the SU with the best channel to Ds.
2) Qr is non-empty, but r∗ or s∗ is set silent by the CSB
to avoid a guaranteed outage event on the r∗ → Dp
or s∗ → Ds link. Note that CSI for transmission is
assumed to be known at CSB and outage event (due to
power limitation) can be predicted before transmission
as discussed in Section IV-A2. In this case, we choose
the transmitting SU as the one with the best instanta-
neous link to the intended destination. For example, if
r∗ is silent and s∗ is transmitting alone, the SU with the
best link between S → Ds transmits.

The case for the simultaneous transmission of two SUs is
the main topic for investigation in this paper. If the two
transmissions occur simultaneously, the transmitting SUs are
selected according to one of the following policies.

1) Best secondary link (BSL):

In this policy, the utility
function to be maximized is the SU throughput. Therefore,
we choose the SU that transmits a packet of its own as the
one with the best instantaneous link to Ds, i.e.,

hs∗ = max.

(7)
Among the remaining (N − 1) SUs, the one with the best
instantaneous link to Dp is chosen to be r∗.

i∈{1,...,N} hsi.

2) Best primary link (BPL): In this policy, unlike BSL, the
utility function to be maximized is PU throughput. Thus, we
choose the SU that relays a primary packet from Qr as the
one with the best instantaneous link to Dp, i.e.,

hr∗ = max.

i∈{1,...,N} hri.

(8)
Among the remaining (N − 1) SUs, the one with the best
instantaneous link to Ds is chosen to be s∗.
It is worth noting that all links S → Dp, Ds are statistically
independent. Thus, at any given time slot, if a certain SU has
the best instantaneous channel to a certain destination, e.g.,
Dp, we can not infer any information about its link quality
to the other destination, e.g., Ds. Hence, ∀i ∈ {1, . . . , N}, si
can have the best link to Dp/Ds irrespective of the quality of
its link to the other destination.

So far, we have introduced two policies for each of the
power allocation and SU scheduling policies. Thus, we have
four different cases arising from the possible combinations of
these policies. Next, we proceed with the performance analysis
of the system for each case.

V. THROUGHPUT AND DELAY ANALYSIS

In this section, we conduct a detailed analysis for the system
performance in terms of throughput and delay. Towards this

5

noting that (9) provides a tighter bound on λp than (11) due
to the multiplication of µp in (9) by a term less than one.

On the other hand, we compute the throughput of SUs
by calculating the service rate of their queues since they
are assumed backlogged. Due to the symmetric conﬁguration
considered, i.e., statistically equivalent links S → Ds, the
throughput of all SUs is the same. For si ∈ S, a packet departs
if Qp is empty, si is selected to transmit a packet of
Qsi
its own and no outage occurs on the link si → Ds. Due to
symmetry, at any time slot, all SUs have equal probabilities
to be selected to transmit a packet from their own queues,
i.e., P[s∗ = si] = 1/N ∀i ∈ {1, . . . , N}. Therefore, the SUs’
throughput is given by (10) provided that µp is given by (12).

Next, we develop a mathematical framework to analyze the

average queuing delay for the PU’s packets.
Theorem 2. The average queuing delay encountered by the
PU packets in the system shown in Fig. 1, under any combi-
nation of power allocation and node selection policies, is

τ =

Np + Nr

λp

(14)

the average lengths of Qp and Qr,

where Np and Nr,
respectively, are given by

(9)

Np =

−λ2
p + λp
µp − λp
rλ2
p + ζλp + η

p + sλp

δλ2

Nr =

(cid:20) fr∗ − fp

µp

r = fps(1 − fp)
s = fps(1 − fp)µp
δ = fr∗ + fps(1 − fp)
ζ = µp [−2fr∗ − fps(1 − fp)]
η = µ2

pfr∗

− fr∗ − fps(1 − fp)

objective, we derive the stability conditions on the queues with
stochastic packet arrivals, namely, Qp and Qr. The stability of
a queue is loosely deﬁned as having a bounded queue size, i.e.,
the number of packets in the queue does not grow to inﬁnity
[18]. Furthermore, we analyze the average queuing delay of the
primary packets. We obtain a closed-form expression for this
delay through deriving the moment generating function (MGF)
of the joint lengths of Qp and Qr. It is worth noting that the
SUs’ queues are assumed backlogged and hence, no queueing
delay analysis is performed for the secondary packets. In the
following lines, we provide a general result for the throughput
of the primary and secondary links as well as the delay of
primary packets. Then, we proceed to highlight the role of
the proposed power allocation and node selection policies. We
ﬁrst introduce some notation. The probabilities of successful
transmissions on the relay and secondary links are denoted by
fr∗ and fs∗, respectively. A transmission on the link p → Dp
is successful with probability fp. In addition, the probability
that at least one SU successfully decodes a transmitted primary
packet is denoted by fps.
Theorem 1. The maximum achievable PU throughput for the
system shown in Fig. 1, under any combination of power
allocation and node selection policies, is given by

λp <

fr∗ [fp + (1 − fp)fps]
fr∗ + (1 − fp)fps

while the throughput of the SU si ∈ S is given by

(cid:20)

(cid:21)

µsi =

1
N

1 −

λp

fp + (1 − fp)fps

fs∗ .

(10)

and

Proof: We use Loynes’ theorem [20] to establish the
stability conditions for Qp and Qr. The theorem states that
if the arrival and service processes of a queue are stationary,
then the queue is stable if and only if the arrival rate is strictly
less than the service rate. Therefore, for Qp to be stable, the
following condition must be satisﬁed

λp < µp

(11)

where µp denotes the service rate of Qp. A packet departs Qp
if it is successfully decoded by at least one node in S∪{Dp}.
Thus, µp is given by

µp = fp + (1 − fp)fps.

Similarly, Qr is stable if

(1 − fp)fps <

λp
µp

1 − λp
µp

(cid:20)

(cid:21)

(12)

(13)

fr∗ .

A PU’s packet arrives at Qr if Qp is non-empty and an outage
occurs on the direct link p → Dp yet no outage occurs at least
on one link between p → S. From Little’s theorem [21], we
know that probability of Qp being non-empty equals λp/µp.
This explains the rate of packet arrivals at Qr shown on the left
hand side (LHS) of (13). The right hand side (RHS) represents
the service rate of Qr. A packet departs Qr if Qp is empty and
there is no outage on the link r∗ → Dp. Rearranging the terms
of (13), we obtain the maximum achievable PU throughput as
given by (9) provided that µp is given by (12). It is worth

(cid:21)

(15)

(16)

(17)

(18)
(19)
(20)
(21)

while µp is given by (12).

Proof: If a primary packet is directly delivered to Dp, it
experiences the queuing delay at Qp only. This happens with a
probability 1− = fp/ µp. However, if the packet is forwarded
to Dp through the relay link, it experiences the total queuing
delay at both Qp and Qr. Thus, the average delay is

τ = (1 − )τp + (τp + τr) = τp + τr

(22)
where τp and τr denote the average delays at Qp and Qr,
respectively. The arrival rates at Qp and Qr are given by λp
and λp, respectively. Thus, applying Little’s law [21] renders
(23)

τr = Nr/λp.

τp = Np/λp,

Substituting (23) in (22) renders τ exactly matching (14).

Proceeding with computing Np, we make use of the fact
that Qp is a discrete-time M/M/1 queue with arrival rate λp
and service rate µp. Thus, Np is directly given by (15) through
applying the Pollaczek-Khinchine formula [22]. However, the
dependence of the arrival and service processes of Qr on

For the ease of exposition, we deﬁne a = 2R0−1
,
b = (2R0 − 1)−1, and β = 1 − e−a. The exponential integral

function, E1[.], is deﬁned as E1[x] =(cid:82) ∞
(cid:18)N − 1
(cid:19)

x (e−t/t)dt.
Lemma 3. For EP-BSL, fr∗ and fs∗ are given by
e−ka

fr∗ = 1 − N−1(cid:88)

(−1)k

Pmax/N0

k

(1 + k/b)

fs∗ = 1 − βN .

k=0

Proof: See Appendix C.

(25)

[I1 − I2] .

(31)

Lemma 4. For EP-BPL, fr∗ is given by

(cid:18)N − 1
(cid:19)

k − 1

N−1(cid:88)

k=1

fr∗ =

N
N − 1

where

I1 =

I2 =

m=0

m

(−1)m

(cid:19)(cid:18)N

(N − k + m + 1)

(cid:18)k − 1
(cid:19)
k−1(cid:88)
(cid:18)k − 1
k−1(cid:88)
N(cid:88)
fs∗ = γ(cid:0)1 − βN−1(cid:1) + (1 − γ)(cid:0)1 − βN(cid:1)

(−1)m+(cid:96)e−a(cid:96)

(cid:19)

(cid:96)=0

m

(cid:96)

m=0

(N − k + m + (cid:96)/b + 1)

On the other hand, fs∗ is given by

6

(29)

(30)

(32)

(33)

(34)

(35)

(36)

(37)

the state of Qp necessitates using a MGF approach [23] to
calculate Nr. The MGF of the joint lengths of Qp and Qr is
deﬁned as

E(cid:104)

xQp[n]yQr[n](cid:105)

G(x, y) = lim
n→∞

(24)
where E denotes the statistical expectation operator. Following
the framework in [5, 24], we get
G(x, y) = (λpx + 1 − λp)

B(x, y)G(0, 0) + C(x, y)G(0, y)

yD(x, y)

where
B(x, y) = x(y − 1)fr∗
C(x, y) = xfr∗ − yfp − y2fps(1 − fp) + xy(µp − fr∗ )
D(x, y) = x−(λpx+1−λp)[fp +yfps(1 − fp) + x(1 − µp)].
(26)

First, we compute the derivative of (25) with respect to y and
then, take the limit of the result when x and y tend to 1. This
veriﬁes that Nr is given by (16).

Theorems 1 and 2 provide closed-form expressions for the
network performance metrics, throughput and delay. These
expressions are mainly functions of the outage probabilities
on various links in the network, namely, fp, fps, fr∗, and fs∗.
In the following lines, we quantify these outage probabilities
for the different combinations of power allocation and node
selection policies. It
is worth noting that fp and fps are
related to the PU side. Therefore, they remain the same for all
combinations of power allocation and node selection policies
which are performed at the SUs side. Using (1), we have

fp = P

hp >

= e−α/σ2

p

(27)

(cid:20)

(cid:21)

2R0 − 1
P0/N0

(cid:20)

(cid:21)

where α = 2R0−1
assumption that renders hp ∼ exp(σ2

P0/N0

. This follows from the Rayleigh fading

p). Similarly,

fps = P

max

i∈{1,...,N}hpsi > α

= 1 − (1 − e−α)N .

(28)

On the other hand, we shift our attention to the SU side to
calculate fr∗ and fs∗. We analyze the four cases arising from
the proposed power allocation and relay selection policies in
the following order: (i) EP-BSL, (ii) EP-BPL, (iii) AP-BSL,
and (iv) AP-BPL. Towards this objective, we ﬁrst note that
for each SU, its link qualities to Dp and Ds are statistically
independent. Furthermore, these links are independent of the
other (N − 1) users’ links. Thus, we are dealing with 2N
i.i.d. random variables, hri and hsi, ∀i ∈ {1, . . . , N}. Each
of these variables is exponentially distributed with mean 1 as
a direct consequence of the Rayleigh fading model consid-
ered. We begin with an analysis of the distributions of the
random variables involved in the derivations of fr∗ and fs∗,
speciﬁcally, hr∗, hI, and hs∗. Finding these distributions is
fundamental to the mathematical derivations presented next.
Obviously, the distributions is dependent on the node selection
policy employed and hence, we present a separate analysis for
BSL and BPL in Appendices A and B, respectively.

where

γ =

λp(1 − fp)fps
(µp − λp)fr∗

.

Proof: See Appendix D.

Lemma 5. For AP-BSL, fr∗ is given by

fr∗=βN(1−βN)+N

where

N − 1
k + 1

I3 =

N−2(cid:88)

(cid:96)=0

I4 =

a
b

eab(N − 1)

k

k=0

(−1)ke−a(k+1)[I3−I4]

(cid:18)N−1
(cid:19)
N−1(cid:88)
(cid:19) (−1)(cid:96)
(cid:18)N − 2
(cid:18)N − 2
(cid:19)
N−2(cid:88)
(cid:20) a(1 + b + (cid:96))(k + 1)

e−a((cid:96)+1)

(−1)(cid:96)e

((cid:96) + 1)

(cid:21)

(cid:96)=0

(cid:96)

(cid:96)

b

a(1+b+(cid:96))(k+1−b)

× E1

b

.

(38)

On the other hand, fs∗ is given by (30).

Proof: See Appendix E.

Lemma 6. For AP-BPL, fr∗ is given by

(cid:18)N−1
N−2(cid:88)

(cid:19)(cid:18)k−1

(cid:19)(cid:18)N−2

(cid:19)(−1)m+(cid:96)N 2 [I5−I6]

N−1(cid:88)

k−1(cid:88)

(cid:96)

m

(N−k+(cid:96)+1)

fr∗=

k−1
+ βN−1(1 − βN )

m=0

k=1

(cid:96)=0

(39)

7

(a) AP-BSL.

(b) AP-BPL.

Fig. 2. The probability of transmission success on the relay link versus Pmax/N0 for AP-based schemes.

where

I5 =

I6 =

e−a(m+1)
(m + 1)

(cid:18)N−1
N−1(cid:88)

n

n=0

(cid:19) (−1)ne−a(n+1)

(cid:18)N − 1

N−1(cid:88)
(cid:19)a(−1)ne−a(m+n−t+2)

(n + 1)

n=0

n

(t − n − 1)

and the terms t and c are

(40)

etcE1[t(a + c)] (41)

(cid:20)

t = b(N − k + (cid:96) + 1) + n + 1
− 1

m + 1

(42)

(43)

.

(cid:21)

c = a

b(N − k + (cid:96) + 1)
On the other hand, fs∗ is given by (34).

Proof: See Appendix F.

VI. NUMERICAL RESULTS

In this section, we validate the closed-form expressions
derived in the paper via comparing theoretical and numerical
simulation results. We investigate the system performance in
terms of the primary and secondary throughput as well as
the average primary packets’ delay. In addition, we quantify
the average power consumption at the SUs. Furthermore, we
conduct performance comparisons between the four strategies
resulting from the proposed power allocation and SU selection
policies. Accordingly, we draw insights about the beneﬁt of
employing the proposed power allocation schemes. We set
P0/N0 = 10 dB. Results are averaged over 106 time slots.

Theorems 1 and 2 provide closed-form expressions for
primary and secondary throughput as well as average queueing
delay for primary packets. Generic expressions have been
provided that work for any combination of power allocation
and node selection policies. These expressions are functions
of the probabilities of successful transmissions on relay and
secondary links, i.e., fr∗ and fs∗. This fact has been thor-
oughly addressed in the appendices, where the four different
power allocation and node selection policies have been ana-
lyzed. We start by validating our theoretical ﬁndings through
simulations. Towards this objective, the analytical expressions
for fr∗, derived in Appendix E and F, are compared to their

corresponding simulation results for both AP-BSL and AP-
BPL in Fig. 2. We set a target rate R0 = 1.5 (bits/channel
use) and we choose σ2
p = 0.25. Fig. 2(a) shows a perfect
match of theoretical and simulation results for AP-BSL for
any number of SUs, N. However, for AP-BPL, Fig. 2(b)
shows a slight deviation between both results. This difference
is attributed to the relaxation of the constraint that hI < hr∗
in the derivation presented in Appendix F, where we treat hI
and hr∗ as independent random variables. This constraint is an
immediate consequence of the node selection policy presented
in Section IV-B2. The relaxation has been done for the sake
of mathematical tractability. Nevertheless, Fig. 2(b) shows that
the constraint relaxation has a minor effect on the obtained
closed-form expression for fr∗. This validates our theoretical
ﬁndings. Fig. 2 show that fr∗ consistently increases as the
number of SUs increases for both AP-based schemes. This
behavior is also true for EP-based schemes and is attributed
to multi-user diversity gains obtained through increasing N.
We investigated the effect of varying N in Fig. 2. Without
loss of generality, the rest of the results are presented for
p = 0.25.
N = 2, R0 = 2 (bits/channel use), and σ2
We proceed with presenting the throughput of the PU and
the SUs for all combinations of power allocation and node
selection policies in Fig. 3. In Fig. 3(a), we plot the maximum
achievable PU throughput, i.e., maximum achievable λp given
by (9) in Theorem 1, versus Pmax/N0. AP-BPL is shown to
outperform all other schemes. Moreover, it is evident that AP-
based schemes outperform EP-based schemes [7], irrespective
of the node selection policy employed. In Fig. 3(b), we plot
the SU throughput versus λp at Pmax/N0 = 7 dB. For the
same node selection policy, the throughput region of the AP-
based schemes is shown to strictly contain that of the EP
based scheme. Furthermore, at every feasible λp for EP-BPL,
higher SU throughput is attained by AP-BPL. Thus, power
adaptation expands the stable throughput region. This shows
the superiority of AP-based schemes in both PU and SU
throughput over their EP-based counterparts.

In Fig. 4, we study the average delay encountered by the
PU packets. We refrain from plotting the results corresponding
to EP-BSL to get a clear view of the comparison. EP-BSL

Pmax/N0 (dB)02468101214161820Probability of success on relay link0.20.30.40.50.60.70.80.91N=2, theoreticalN=2, simulationN=4, theoreticalN=4, simulationN=8, theoreticalN=8, simulationPmax/N0 (dB)02468101214161820Probability of success on relay link0.20.30.40.50.60.70.80.91N=2, theoreticalN=2, simulationN=4, theoreticalN=4, simulationN=8, teoreticalN=8, simulation8

(a) Maximum achievable PU throughput versus Pmax/N0.

(b) SU throughput versus λp.

Fig. 3. The throughput of the PU and SUs for all combinations of power allocation and node selection policies.

(a) Average primary packets’ delay versus Pmax/N0.

(b) Average primary packets’ delay versus λp.

Fig. 4. The average queueing delay of PU’s packets for different combinations of power allocation and node selection policies.

yields much worse delay than the other three strategies. We
plot the average primary packet delay versus Pmax/N0 in Fig.
4(a). As the available power resources increase, i.e., Pmax/N0
increases, delay decreases. We attain lower average delay
through power adaptation. As expected, AP-BPL holds its
position as the best scheme with respect to PU. Furthermore,
we investigate the fundamental throughput-delay tradeoff in
Fig. 4(b). We plot the average packet delay for the PU versus
its throughput at Pmax/N0 = 5 dB. Intuitively, when a node
needs to maintain a higher throughput, it loses in terms of
the average delay encountered by its packets. Given that the
system is stable, the node’s throughput equals its packet arrival
rate. Thus, increased throughput means injecting more packets
into the system resulting in a higher delay. Furthermore, Fig.
4(b) shows that strictly lower average PU delay is attained via
AP-based schemes compared to EP allocation in [7]. It can
also be noticed that AP-BPL is still in the leading position
among all schemes in terms of both throughput and delay.
Moreover, we validate the obtained closed-form expressions
for average PU delay via simulations. Theoretical and sim-
ulation results for AP-BSL perfectly coincide. However, for
AP-BPL, the slight deviation between theory and simulations
is attributed to the relaxation of the constraint hI < hr∗

discussed earlier.

Finally, we plot

the average powers transmitted by the
SUs in Fig. 5, i.e., average Ps∗ and Pr∗, normalized to N0,
versus Pmax/N0. Clearly,
the AP-based schemes consume
signiﬁcantly less power than the EP assignment represented
by the 45◦ line. For the average power transmitted on the link
s∗ → Ds, the ﬁrst intuition that comes to mind is that AP-
BSL policy results in the minimum average power. However,
this is only true at high Pmax/N0 values. It is noticed that
the results corresponding to AP-BPL show slightly less power
consumption than that of AP-BSL at low Pmax/N0 values.
This behavior approximately holds till Pmax/N0 = 10 dB.
This is attributed to the nature of the proposed AP policy
which sets s∗ silent if its maximum power constraint is not
sufﬁcient to satisfy the condition of success (5). Since in AP-
BSL, s∗ always sees the best link to Ds, the number of slots in
which it remains idle is less than that in AP-BPL. This yields
a higher throughput at the expense of slightly higher average
transmitted power. The same argument holds for comparing
selection policies on the link r∗ → Dp.
A. Discussion on the Assumptions

The above system analysis is performed under the assump-
tion of fully-backlogged SUs. The motivation behind this

Pmax/N0 (dB)02468101214161820PU throughput (packets/slot)00.10.20.30.40.50.6AP-BPLAP-BSLEP-BPLEP-BSLλp (packets/slot)00.050.10.150.20.250.30.350.40.450.5SU throughput (packets/slot)00.050.10.150.20.250.30.350.4AP-BSLEP-BSLAP-BPLEP-BPLPmax/N0 (dB)510152025Average PU delay (slots/packet)1.522.533.544.55AP-BPL, theoreticalAP-BPL, simulationAP-BSL, theoreticalAP-BSL, simulationEP-BPLλp (packets/slot)00.020.040.060.080.10.120.140.160.180.2Average PU delay (slots/packet)2345678910AP-BPL, theoreticalAP-BPL, simulationAP-BSL, theoreticalAP-BSL, simulationEP-BPL9

validate the results through numerical simulations. Dynami-
cally adapting the transmission powers at the SUs according
to the channel conditions results in substantial improvement
in primary and secondary throughput. The SUs under EP-
based schemes always transmit at maximum power. This
results in excessive interference on the relay link which is
not the case for the AP-based schemes. Power adaptation is
performed at the SUs to transmit with the minimum power
required for the successful transmission. To further beneﬁt
the system, the SUs back-off if their maximum permissible
power is not sufﬁcient to yield a successful transmission and
avoid guaranteed outage events. The back-off beneﬁts the other
transmitting SU by reducing the incurred interference and
thereby, causes throughput increase. The AP-based schemes
are shown to reduce the average queuing delay encountered
by the PU packets compared to their EP-based counterparts.
We perform mathematical analysis of the proposed schemes
and show numerically that the AP-based schemes save energy;
and achieve higher throughput and lower delay simultaneously.

APPENDIX A

DISTRIBUTIONS OF hr∗ , hI, AND hs∗ FOR BSL
Referring to the policy described in Section IV-B1,

hs∗ = max.

i∈{1,...,N} hsi.

(44)

Therefore, the probability density function (PDF) of hs∗ is

Phs∗ (h) = N e−h(1 − e−h)N−1, h ≥ 0.

(45)
As indicated earlier, the fact that s∗ has the best link to Ds
gives absolutely no information about its link quality to Dp
and hence,

PhI (h) = e−h, h ≥ 0.

(46)

On the other hand,

Phr∗ (h) = (N − 1)e−h(1 − e−h)N−2, h ≥ 0.

(47)

We present a rigorous argument to prove that (47) is true. Con-
sider the 2N random variables representing the link qualities
of the N SUs to Dp and Ds. The SU with the best link to
Ds is selected to transmit a packet of its own. This leaves
(N − 1) possible candidates for relaying a primary packet to
Dp. Among the (N−1) random variables representing the link
qualities of these candidates to Dp, their maximum is selected.
This maximum has one of the following two possibilites.

• It is the second maximum of {hri}N

i=1. This occurs only
when the same SU has the best link to both Dp and
Ds simultaneously. A speciﬁc SU has the best link to
both destinations simultaneously with probability 1/N 2.
Taking into account N such possibilities, one for every
i=1 with
SU, hr∗
probability 1/N.
i=1. This occurs whenever s∗
is not the SU having the best link to Dp, which has a
probability 1 − (1/N ).

is the second maximum of {hri}N

• It is the maximum of {hri}N

The average distribution corresponding to the two possibilities
presented above with their respective probabilities is exactly
the same as the distribution of a maximum of (N − 1) i.i.d.

Fig. 5. Average SUs’ transmitted power normalized to N0 versus Pmax/N0.

assumption is two-fold. First, backlogged SUs represent the
worst case scenario from the PU’s point of view. Since we
consider cooperative communications, a portion of the PU’s
data is delivered to its intended destination via the relay
link, i.e., r∗ → Dp. However, the transmission of secondary
packets causes interference to the relay link as indicated
earlier. This interference is persistent in case of backlogged
SUs. Therefore, our results can be considered as a lower bound
on the achievable performance of the PU, i.e., a lower bound
on throughput and upper bound on delay. Furthermore, the
backlogged SUs assumption mitigates the interaction between
the queues of the SUs. This renders the system mathematically
tractable. Nevertheless, stochastic arrivals to the SUs’ queues
can still be considered and queues interaction can be tackled
using the dominant system approach originally introduced in
[25]. However, this is out of the scope of the paper.

It is worth noting that in the derivations corresponding to
BPL-based schemes, i.e., in Sections D and F of the Ap-
pendix, we consider hI and hr∗ independent random variables.
However, they are coupled through the constraint hI < hr∗.
This constraint
is an immediate consequence of the BPL
node selection policy. We relax this constraint to render the
problem mathematically tractable. Nevertheless, we quantify
the effect of relaxing this constraint on the obtained closed-
form expressions for fr∗ through numerical simulation results
presented in Section VI.

Finally, we assume that SUs perfectly sense the PU’s
activity. This assumption has been made to avoid adding
further complexity to the analysis which might distort the
main message behind the paper. Nevertheless, imperfect sens-
ing has been studied extensively in the literature. Reference
[26] presents a comprehensive survey of spectrum sensing
techniques in cognitive radio networks.

VII. CONCLUSION

We discuss a power allocation policy for cognitive radio
networks with multiple relays and propose different relaying
protocols depending on the network utility function. The
effect of SU power adaptation on throughput and average
delay is thoroughly investigated. We derive the closed-form
expressions for the achieved throughput and average delay and

Pmax/N0 (dB)0510152025Average transmitted power / N0 (dB)-15-10-50510152025EPAP-BSL, Pr*AP-BPL, Pr*AP-BPL, Ps*AP-BSL, Ps*exponential random variables with means 1 each. This is an
easy-to-show fact using order statistics arguments, omitted for
brevity. The proof of (47) is then concluded.

We substitute by (56) in (55). Then, the integral solution
renders fr∗ as in (29).

At the SUs side, we depend on (1) and (3) to write

10

APPENDIX B

DISTRIBUTIONS OF hr∗ , hI, AND hs∗ FOR BPL
According to the policy described in Section IV-B2,

hr∗ = max.

i∈{1,...,N} hri.

Therefore, the PDF of hr∗ is

Phr∗ (h) = N e−h(1 − e−h)N−1, h ≥ 0.

On the other hand,

Phs∗ (h) = (N − 1)e−h(1 − e−h)N−2, h ≥ 0.

(48)

(49)

(50)

An argument similar to that used to derive the distribution of
hr∗ in Appendix A is used to derive (50).
The SU with the best link to Dp is selected to relay a
primary packet. This eliminates the possibility that s∗ has the
best link to Dp, i.e., hI can not be the maximum of {hri}N
i=1.
In other words, hI can possibly be the kth order statistic of the
N random variables {hri}N
i=1, where k = 1, . . . , N − 1. The
kth order statistic is by convention the kth smallest random
variable. It remains to note that after the selection of r∗, the
remaining (N − 1) SUs possess equal probabilities of having
the best link to Ds. Consequently, hI is equally likely to be
any kth order statistic of {hri}N
i=1, k = 1, . . . , N − 1. Then,
the average distribution of these order statistics is given by
PhI (h)=

(cid:18)N−1
(cid:19)
N−1(cid:88)

e−h(N−k+1)(1−e−h)k−1, h ≥ 0.
(51)

N
N − 1

k−1

k=1

APPENDIX C

DERIVATION OF fr∗ AND fs∗ FOR EP-BSL

Using (1) and (4) along with the description of power
allocation and node selection policies provided in Sections
IV-A1 and IV-B1, respectively, we have
hI
b

fr∗ = P

hr∗ > a +

(52)

(cid:21)

(cid:20)

.

Then, total probability theory implies that

fr∗ =

hr∗ > a +

PhI(h)dh

(53)

(cid:20)

P

(cid:90) ∞

0

(cid:21)

h
b

Thus, (53) is readily solved via substituting by the distributions
of the random variables hI and hr∗ provided in (46) and (47),
respectively. We ﬁrst note that

P [hr∗ > w] = 1 − (1 − e−w)N−1, w ≥ 0

(54)

and then use (54) with w = a + h
1 − e−(a+ h

fr∗ =

(cid:20)
(cid:90) ∞
1 −(cid:104)
b )(cid:105)N−1

0

=

b in (53) to get

b )(cid:105)N−1(cid:21)
(cid:18)N − 1
(cid:19)

N−1(cid:88)

k

k=0

(cid:104)

1 − e−(a+ h

To solve this integration, we use the binomial theorem

(−1)ke−k(a+ h

b ). (56)

.e−hdh.

(55)

fs∗ = P [hs∗ > a] = 1 − βN

(57)

which follows directly from (45). This veriﬁes fs∗ in (30).

APPENDIX D

DERIVATION OF fr∗ AND fs∗ FOR EP-BPL

We use the description of power allocation and node selec-
tion policies presented in Sections IV-A1 and IV-B2, respec-
tively. Using (1) and (4), fr∗ is given by (52) which is the same
as (53) through total probability theory. The distributions of
hr∗ and hI given by (49) and (51), respectively, are used to
solve the integral in (53) using similar steps to that presented
in Appendix C. This renders fr∗ as given in (31).

empty. Therefore,

An SU transmits on the best link to Ds only when Qr is

fs∗ = P(cid:2) ¯Os∗(cid:12)(cid:12) B(cid:3) P [B] + P(cid:2) ¯Os∗(cid:12)(cid:12) ¯B(cid:3) P(cid:2)¯B(cid:3)

(58)
where Os∗ denotes the outage event on the secondary link,
and B denotes the event that Qr is non-empty. A bar over an
event’s symbol denotes its complement. Little’s theorem [21]
implies that

P [B] = γ

(59)

where γ is given by (35). In (59), we use the arrival and service
rates of Qr presented on both sides of (13), respectively. Next,
we compute the probability of packet success on the secondary
link when Qr is busy. From (1) and (3), we have

P(cid:2) ¯Os∗(cid:12)(cid:12) B(cid:3) = P [ hs∗ > a| B] = 1 − βN−1.

(60)

This follows from the distribution of hs∗ given by (50). On
the other hand, if Qr is empty, s∗ transmits on the best link
among S → Ds, i.e., hs∗ = max.

P(cid:2) ¯Os∗(cid:12)(cid:12) ¯B(cid:3) = P(cid:2) hs∗ > a| ¯B(cid:3) = 1 − βN .

i∈{1,...,N} hsi. Thus, we have

(61)

We substitute by the results of (59), (60), and (61) in (58).
This veriﬁes that fs∗ is given by (34).

APPENDIX E

DERIVATION OF fr∗ AND fs∗ FOR AP-BSL

Using total probability theory, we write

fr∗ = P(cid:2) ¯Or∗(cid:12)(cid:12)Os∗(cid:3) P [Os∗ ] + P(cid:2) ¯Or∗(cid:12)(cid:12) ¯Os∗(cid:3) P(cid:2) ¯Os∗(cid:3)

(62)
where Or∗ denotes the outage event on the relay link. In
(62), we take into account the fact that s∗ remains silent if
Pmax is not sufﬁcient to satisfy (5). Therefore, we compute
the probability of a successful transmission on the relay link
in both cases of s∗ activity, i.e., either active or silent. Thus,
from (5), we have

P [Os∗ ] = P[hs∗ < a] = βN .

(63)

This can directly be veriﬁed using the distribution of hs∗
presented in (45). In the event of a sure outage on the

secondary link, s∗ refrains from transmission. We then plug
Ps∗ = 0 into (6) and write

P(cid:2) ¯Or∗(cid:12)(cid:12)Os∗(cid:3) = P[hr∗ > a] = 1 − βN .

(64)
This result is explained as follows. When s∗ is silent, r∗ is
selected to be the SU with the best link to Dp to enhance the
PU throughput. Thus, in this speciﬁc case, hr∗ is the maximum
of N exponential random variables with means 1 each. This
renders P[hr∗ > a] = 1 − βN .
On the other hand, when s∗ is active, i.e., hs∗ ≥ a, we
choose Ps∗ to be the value that meets (5) with equality and
plug it into (6). After some algebraic manipulation, we write

(cid:18) hr∗

a

(cid:19)

(cid:12)(cid:12)(cid:12)(cid:12) hs∗ ≥ a
(cid:21)

hI ≤ b

− 1

hs∗

.

(65)

P(cid:2) ¯Or∗(cid:12)(cid:12) ¯Os∗(cid:3) =P

(cid:20)

The ﬁrst step towards solving (65) requires the computation
of P[ hI ≤ zhs∗| hs∗ ≥ a] for an arbitrary z ≥ 0. Proceeding
with that, we have

P[ hI ≤ zhs∗| hs∗ ≥ a] =

P[hI ≤ zhs∗ , hs∗ ≥ a]

P[hs∗ ≥ a]

.

(66)

(cid:90) ∞
(cid:90) zy

k

a

0

k=0

×

(cid:21)

(−1)ke−a(k+1)

(cid:18)N − 1
N−1(cid:88)
(cid:20) 1

The numerator of (66) can be computed as follows.
PhI (x)Phs∗ (y)dxdy (67)
P[hI ≤ zhs∗ , hs∗ ≥ a] =
The distributions of hI and hs∗ are given by (46) and (45),
respectively, and we use the fact that hI and hs∗ are indepen-
dent. This information, along with the binomial theorem, is
used to solve the double integral in (67). Thus,
P[hI ≤ zhs∗ , hs∗ ≥ a] = N

(cid:19)
− e−az
P(cid:2) ¯Os∗(cid:3) = P[hs∗ ≥ a] = 1 − βN .
(cid:90) ∞
(cid:12)(cid:12)(cid:12) hs∗ ≥ a
(cid:16) w
P(cid:104)
(cid:105)Phr∗(w)dw
(cid:17)
P(cid:2) ¯Or∗(cid:12)(cid:12) ¯Os∗(cid:3)=
a − 1(cid:1), in (70). The solution of
result of (66), with z = b(cid:0) w
(cid:18)N−1
(cid:19)
N−1(cid:88)
P(cid:2) ¯Or∗(cid:12)(cid:12) ¯Os∗(cid:3)=

(69)
Then, we substitute by (68) and (69) in (66). Next, we use
total probability theory to write (65) as

(70)
where Phr∗ (.) is given by (47). We then substitute by the

Furthermore, we know from (63) that

(−1)ke−a(k+1)[I3−I4]

the integral yields

hI ≤ b

z + k + 1

. (68)

− 1

k + 1

hs∗

N

a

a

(1 − βN )

k

k=0

(71)
where I3 and I4 are given by (37) and (38), respectively. The
derivation of (38) depends on the fact that

(cid:90) ∞

a

e−tw
w + c

dw = etcE1[t(a + c)]

(72)

for any constants t and c. Substituting by (37) and (38) in
(71), and using (63), (64), (69), and (71) in (62), fr∗ is shown
to be given by (36).

For the SUs, fs∗ is shown to be given by (57) following the
same proof provided for the case of EP-BSL in Appendix C.

11

APPENDIX F

DERIVATION OF fr∗ AND fs∗ FOR AP-BPL

The derivation of fr∗ for AP-BPL follows the same foot-
steps of the derivation presented in Appendix E. However,
the difference in the node selection policies induces different
distributions for the random variables of interest. We can write
fr∗ as in (62). First, we derive the ﬁrst term in the RHS of
(62) as follows.

P [Os∗ ] = P[hs∗ < a] = βN−1.

(73)

This follows from the distribution of hs∗ presented in (50).
When s∗ is silent, we plug Ps∗ = 0 into (6) and write

P(cid:2) ¯Or∗(cid:12)(cid:12)Os∗(cid:3) = P[hr∗ > a] = 1 − βN

(74)

where the distribution of hr∗ is given by (49). Then, we shift
our attention to the second term in the RHS of (62). When s∗ is
active, i.e., hs∗ ≥ a, we choose Ps∗ to be the value that meets
(5) with equality and plug it into (6). Then, we compute the
probability of success on the relay link given that s∗ is active
as in (65). We solve (67) using the distributions of hs∗ and
hI in (50) and (51), respectively, along with the fact that they
are independent to get

(cid:19)(cid:18)k−1
k−1(cid:88)
N−1(cid:88)
(cid:20)e−a(m+1)
− e−a(m+z(N−k+(cid:96)+1)+1)
(m+z(N−k+(cid:96)+1)+1)

P [hI≤ zhs∗, hs∗ ≥ a]=
× N (−1)m+(cid:96)
(75)
(N−k+(cid:96)+1)
z = b(cid:0) w
a − 1(cid:1), in (70) and solve the integral. After some
for z ≥ 0. Next, we substitute by the result of (75), with
(cid:18)N−1
N−2(cid:88)
k−1(cid:88)
N−1(cid:88)

algebraic manipulation, omitted for brevity, the second term
in the right hand side of (62) is found to be equal to

(cid:19)(cid:18)N−2
(cid:19)
(cid:21)

(cid:19) (−1)m+(cid:96)N 2

(cid:18)N−1
N−2(cid:88)

(cid:19)(cid:18)N−2

(cid:19)(cid:18)k−1

(m + 1)

k−1

m=0

k=1

(cid:96)=0

m

(cid:96)

k−1

(cid:96)

m

(N−k+(cid:96)+1)

k=1

(cid:96)=0

m=0

[I5−I6]
(76)

where

I5 =

I6 =

(cid:90) ∞

a

e−a(m+1)
(m + 1)

N−1(cid:88)

e−w(1 − e−w)N−1dw
e−tw
w + c

(cid:90) ∞

a

(t − n − 1)

a(−1)ne−a(m+n+2−t)

n=0

(77)

dw

(78)

and the terms t and c are given by (42) and (43), respectively.
The solution of the integral in (77) proves that I5 is given by
(40). We use (72) to show that I6 is given by (41). Then, (73),
(74), and (76) shows that fr∗ is given by (39).

On the other hand, fs∗ is shown to be given by (34)
following the same proof provided for the case of EP-BPL
in Appendix D.

REFERENCES

[1] M. Ashour, M. Butt, and A. Mohamed, “On the power
efﬁciency for cognitive radio networks with multiple
relays,” in IEEE International Symposium on Information
Theory (ISIT), Honolulu, HI, USA, June 2014.

12

transmission,” IEEE Transactions on Wireless Communi-
cations, vol. 9, no. 1, pp. 72–77, January 2010.

[17] M. Costa, “Writing on dirty paper,” IEEE Transactions
on Information Theory, vol. 29, no. 3, pp. 439–441, 1983.
[18] A. K. Sadek, K. R. Liu, and A. Ephremides, “Cognitive
multiple access via cooperation: protocol design and per-
formance analysis,” IEEE Transactions on Information
Theory, vol. 53, no. 10, pp. 3677–3696, 2007.

[19] A. Jovicic and P. Viswanath, “Cognitive radio: An
information-theoretic perspective,” IEEE Transactions on
Information Theory, vol. 55, no. 9, pp. 3945–3958, 2009.
[20] R. Loynes, “The stability of a queue with non-
inter-arrival and service times,” in Proc.
independent
Cambridge Philos. Soc, vol. 58, no. 3. Cambridge Univ
Press, 1962, pp. 497–520.

[21] D. P. Bertsekas, R. G. Gallager, and P. Humblet, Data

networks. Prentice-Hall International, 1992, vol. 2.

[22] L. Kleinrock, Queueing systems, vol. 1.

New York:

Wiley, 1975.

[23] M. Sidi and A. Segall, “Two interfering queues in packet-
radio networks,” IEEE Transactions on Communications,
vol. 31, no. 1, pp. 123–129, 1983.

[24] M. Ashour, A. A. El-Sherif, T. ElBatt, and A. Mohamed,
“Cognitive radio networks with probabilistic relaying:
stable throughput and delay tradeoffs,” IEEE Transac-
tions on Communications, vol. 63, no. 11, pp. 4002–
4014, 2015.

[25] R. R. Rao and A. Ephremides, “On the stability of
interacting queues in a multiple-access system,” IEEE
Transactions on Information Theory, vol. 34, no. 5, pp.
918–930, 1988.

[26] T. Y¨ucek and H. Arslan, “A survey of spectrum sensing
algorithms for cognitive radio applications,” IEEE Com-
munications Surveys & Tutorials, vol. 11, pp. 116–130,
2009.

[2] S. Haykin, “Cognitive radio: brain-empowered wireless
communications,” IEEE journal on selected areas in
communications, vol. 23, no. 2, pp. 201–220, 2005.

[3] J. N. Laneman, D. N. Tse, and G. W. Wornell, “Coop-
erative diversity in wireless networks: Efﬁcient protocols
and outage behavior,” IEEE Transactions on Information
Theory, vol. 50, no. 12, pp. 3062–3080, 2004.

[4] G. Kramer, M. Gastpar, and P. Gupta, “Cooperative
strategies and capacity theorems for relay networks,”
IEEE Transactions on Information Theory, vol. 51, no. 9,
pp. 3037–3063, 2005.

[5] B. Rong and A. Ephremides, “Cooperative access in
wireless networks: stable throughput and delay,” IEEE
Transactions on Information Theory, vol. 58, no. 9, pp.
5890–5907, 2012.

[6] K. Azarian, H. El Gamal, and P. Schniter, “On the
achievable diversity-multiplexing tradeoff in half-duplex
cooperative channels,” IEEE Transactions on Information
Theory, vol. 51, no. 12, pp. 4152–4172, 2005.

[7] I. Krikidis, J. N. Laneman, J. S. Thompson, and
S. McLaughlin, “Protocol design and throughput anal-
ysis for multi-user cognitive cooperative systems,” IEEE
Transactions on Wireless Communications, vol. 8, no. 9,
pp. 4740–4751, 2009.

[8] I. Krikidis and J. S. Thompson, “Opportunistic relay se-
lection in cooperative systems with dirty-paper coding,”
IEEE Transactions on Vehicular Technology, vol. 58,
no. 7, pp. 3322–3332, 2009.

[9] S. Song, M. Hasna, and K. Letaief, “Prior zero forcing
for cognitive relaying,” Wireless Communications, IEEE
Transactions on, vol. 12, no. 2, pp. 938–947, February
2013.

[10] O. Simeone, Y. Bar-Ness, and U. Spagnolini, “Stable
throughput of cognitive radios with and without relay-
ing capability,” IEEE Transactions on Communications,
vol. 55, no. 12, pp. 2351–2360, Dec 2007.

[11] G. Papadimitriou, N. Pappas, A. Traganitis, and V. Ange-
lakis, “Network-level performance evaluation of a two-
relay cooperative random access wireless system,” Com-
puter Networks, vol. 88, pp. 187 – 201, 2015.

[12] Y. Han, S. H. Ting, and A. Pandharipande, “Cooperative
spectrum sharing protocol with selective relaying sys-
tem,” Communications, IEEE Transactions on, vol. 60,
no. 1, pp. 62–67, January 2012.

[13] T. Jing, S. Zhu, H. Li, X. Xing, X. Cheng, Y. Huo, R. Bie,
and T. Znati, “Cooperative relay selection in cognitive
radio networks,” IEEE Transactions on Vehicular Tech-
nology, vol. PP, no. 99, 2014.

[14] R. Urgaonkar and M. Neely, “Opportunistic cooperation
in cognitive femtocell networks,” IEEE Journal on Se-
lected Areas in Communications, vol. 30, no. 3, pp. 607–
616, 2012.

[15] A. El-Sherif, A. Sadek, and K. Liu, “Opportunistic mul-
tiple access for cognitive radio networks,” IEEE Journal
on Selected Areas in Communications, vol. 29, no. 4, pp.
704–715, April 2011.

[16] I. Krikidis, N. Devroye, and J. Thompson, “Stability
analysis for cognitive radio with multi-access primary

