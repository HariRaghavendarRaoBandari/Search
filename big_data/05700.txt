6
1
0
2

 
r
a

 

M
7
1

.

 
 
]
T
S
n
i
f
-
q
[
 
 

1
v
0
0
7
5
0

.

3
0
6
1
:
v
i
X
r
a

Estimating the Integrated Parameter of the Locally

Parametric Model in High-Frequency Data

Yoann Potiron∗

This version: March 21, 2016

Abstract

0 θ∗

value over time of the parameter process Θ := T −1(cid:82) T

In this paper, we give a general time-varying parameter model, where the mul-
tidimensional parameter follows a continuous local martingale. As such, we call it
the locally parametric model. The quantity of interest is deﬁned as the integrated
t dt. We provide a local
parametric estimator of Θ based on the original (non time-varying) parametric
model estimator and conditions under which we can show consistency and the cor-
responding limit distribution. We show that the LPM class contains some models
that come from popular problems in the high-frequency ﬁnancial econometrics lit-
erature (estimating volatility, high-frequency covariance, integrated betas, lever-
age eﬀect, volatility of volatility), as well as a new general asset-price diﬀusion
model which allows for endogenous observations and time-varying noise which can
be auto-correlated and correlated with the eﬃcient price and the sampling times.
Finally, as an example of how to apply the limit theory provided in this paper, we
build a time-varying friction parameter extension of the (semiparametric) model
with uncertainty zones (Robert and Rosenbaum (2012)), which is noisy and en-
dogenous, and we show that we can verify the conditions for the estimation of
integrated volatility.
Keywords: continuous local martingale ; high-frequency data ; integrated pa-
rameter ; local parametric estimator ; microstructure noise ; time endogeneity ;
time-varying parameter model

∗Department of Statistics, The University of Chicago. 5734 S. University Avenue Chicago, IL 60637.

Phone: + 1 (773) 702 8044/8333. Fax: + 1 (773) 702 9810. Email: ypotiron@uchicago.edu

1

1 Introduction

1.1 Time-varying parameter models

Modeling dynamics is very important in various ﬁelds, including ﬁnance, economics,
physics, environmental engineering, geology and sociology. (Semi)parametric time de-
pendent models can deal with a special problem in dynamics, namely, the temporal
evolution of systems. This was extensively studied in Baillie and Bollerslev (1992),
Robins and Tsiatis (1992), Fan et al. (2003) and Chen and Fan (2006) among others.
By deﬁnition, (semi)parametric approaches come with the strong assumption that an
underlying parameter is non time-varying. Au contraire, as time goes by, the structure
driving the observations is often evolving. To corroborate this natural skepticism, there
exists a mass of empirical work which strongly suggests that the non time-varying as-
sumption is too restrictive. To acknowledge the issue, one can build a varying-coeﬃcient
model as in Fan and Gijbels (1996), Hastie and Tibshirani (1993) or Fan and Zhang
(1999) when regression and generalized regression models are involved, locally station-
ary processes following the work of Dahlhaus (1997, 2000), Dahlhaus and Rao (2006),
or any other time-varying parameter models, e.g. Stock and Watson (1998) and Kim
and Nelson (2006).

Consider models for variance of returns. Originally, it was assumed that the returns
Ri := Yi−Yi−1 of a time series {Y1, Y2,··· , Yn} observed at regular times {τ1, τ2,··· , τn}
were conditionally homoskedastic with variance parameter σ2, and they were split as
Ri = σzi where zi was the stochastic piece, typically a Gaussian with a time-increment
variance ∆τi := τi − τi−1. However, on the parametric side, Engle (1982) allowed con-
ditional heteroskedasticity, where the variance component following a moving-average
(MA) model. He was soon followed by Bollerslev (1986) and many other authors in-
cluding Nelson (1991) and Engle and Ng (1993) who allowed respectively an auto-
regressive-moving-average (ARMA) and more general models for the time-varying vari-
ance parameter σ2. Taking a nonparametric approach, the analysis of high-frequency
ﬁnancial data gave rise to the Stochastic Volatility model where log prices follow a local
martingale and returns are of the form

Ri :=

σtdWt.

(1)

(cid:90) τi

τi−1

2

The object of interest, which used to be the ﬁxed volatility parameter, became the
integrated volatility (IV), deﬁned as

IVt =

σ2
s ds.

(2)

(cid:90) t

0

Time-varying volatility is of substantial importance in the modeling of option prices
(see Hull and White (1987), Stein and Stein (1991), Heston (1993) and Ball and Roma
(1994)). In order to price using the formula (2), one can ﬁrst estimate it as in An-
dersen and Bollerslev (1998a,b), Andersen, Bollerslev, Diebold and Labys (2001,2003),
Barndorﬀ-Nielsen and Shephard (2001,2002), Barndorﬀ-Nielsen (2004), Jacod and Prot-
ter (1998), Zhang (2001) and Mykland and Zhang (2006).

1.2 Applications

We assume that the stochastic multidimensional parameter θ∗
of the returns. This leads us to the problem of estimating the integrated parameter

t is driving the structure

(cid:90) T

0

Θ :=

1
T

θ∗
sds.

(3)

The parameter process can be, for example, equal to the volatility, the covariation be-
tween several assets, the time-varying variance of the microstructure noise, the friction
parameter of the model with uncertainty zones (see Section 7.1.2 for more details), the
betas, the volatility of volatility, the leverage eﬀect process, the event arrival rate or
any other parameter driving the observation times (see for example Section 7.1), the
parameters of a self-exciting process (Hawkes (1971)) or in general of any time-varying
parameter extension of a parametric model, etc. As an example of an application of
(3), Chen and Mykland (2015) measured the liquidity risk when the parameter is equal
to the time-varying variance of the microstructure noise.

We assume in this work that the econometrician has a time-varying parameter model
(and in particular a parametric model) at hand, which is contained within the Locally
Parametric Model (LPM) class deﬁned in Section 5. The LPM covers a large class of
time-varying parameter models, as we will illustrate in the examples of Section 7. In

3

particular, in the case where we model the price of an asset as a continuous eﬃcient
stochastic process, it allows for endogeneity (the sampling times can be correlated with
the eﬃcient price and the microstructure noise), auto-correlated time-varying noise,
correlation between the eﬃcient return and the noise, as well as multidimensional asyn-
chronous observations.

In high-frequency data, when estimating a quantity such as volatility, one has to
ﬁrst build a model for the observations. When observations are close, empirical studies
strongly suggest that the market microstructure generates a divergence between the ob-
served price process and the eﬃcient price process. This divergence could be induced,
among other things, by transaction price changes occurring on the tick grid (price dis-
creteness) or by the existence of a waiting-list for sellers and buyers at each level of price
(bid-ask spreads). Accordingly, the market microstructure is very often assumed to be
stationary (i.e. with non time-varying variance), independent of the true price pro-
cess and not autocorrelated. Nonetheless, Hansen and Lunde (2006) have documented
empirically that the microstructure noise is time-dependent and correlated with the eﬃ-
cient price itself. Correlation between the eﬃcient price and the noise can be explained
by rounding eﬀects, price stickiness, asymmetric information, etc. Kalnina and Linton
(2008) introduced in their model possible non-stationarity of noise and correlation.

Furthermore, it is well observed empirically that the order of arrival times of trans-
action prices are correlated with the price level, volatility, and microstructure noise.
However, it is very common to assume full independence among them. On the con-
trary, endogeneity means that the sampling times are not independent of the other
quantities. Endogeneity can have bad eﬀects on the behavior of an estimator. When
estimating volatility, Li et al. (2014) and Fukasawa (2010) showed that Realized Volatil-
ity estimator (RV) has an asymptotic bias when sampling times are endogenous. They
estimated the bias, and removed the estimate from the Realized Volatility estimator to
obtain a bias-corrected estimator. Potiron and Mykland (2015) followed a similar line
of reasoning to provide a bias-corrected Hayashi-Yoshida (HY) estimator (Hayashi and
Yoshida (2005)) of the high-frequency covariance.

We also assume that the econometrician has a parametric estimator in the (non
time-varying) parametric model at hand, such as the MLE. This paper aims to build

4

general estimators (cid:98)Θn of (3), based on the parametric estimator. When parameters are

time-varying, researchers frequently chop the available data into short time blocks of
size hn and assume homoskedasticity within the blocks (e.g. Foster and Nelson (1996)).
In this work, we propose to use the same strategy to estimate the integrated parameter
(3): we estimate the local parameter on each block by using the parametric estimator
on the observations within the block and take a weighted sum of the local parameter
estimates, where each weight is equal to the corresponding block length. We call the
obtained estimator the local parametric estimator (LPE). Depending on the case, the
LPE can actually diﬀer from the original parametric estimator. For this technique to
work, we need that the parametric estimator is not badly-biased and that it uniformly
satisﬁes limit theory conditions, in addition to other conditions that can be found in
Section 6.

Depending on the model and the estimator chosen by the econometrician, the con-
ditions of Section 6 can be either straightforward or cumbersome to verify. Nonetheless,
our hope is that for any LPM and an accompanying large set of estimators, this paper
will help the econometrician by breaking the original nonparametric problem into two
easier sub-problems, a parametric problem and a control of the error between the non-
parametric and the parametric problem. We provide an insight on the work of Potiron
and Mykland (2015) in Section 7.2, who used exactly this strategy to ﬁnd the limit dis-
tribution of the integrated covariation in a general endogenous model they introduced,
the Hitting Boundary with Time process (HBT) model (which is contained within the
LPM class). They used the bias-corrected HY estimator (which can be expressed as a
LPE). In Section 7.1.2, we give another direct application of the techniques provided
in this paper by verifying conditions of Section 6 for another noisy and endogenous
problem. We introduce a time-varying friction parameter extension of the model with
uncertainty zones introduced in Robert and Rosenbaum (2011) and estimate the in-
tegrated volatility. For this purpose, we use a slight modiﬁcation of the parametric
estimator of volatility provided in Robert and Rosenbaum (2012).

We assume in this paper that the stochastic parameter is continuous. We prove that
under the diﬀusion assumption we can trust the parametric model locally. The order
of the block size hn to use is also given in Section 6. The idea that a continuous local

5

martingale parameter implies that the model is locally valid builds on previous inves-
tigations by Mykland and Zhang (2009, 2011) of the maximum size of a neighborhood
in which we can hold volatility of an asset constant. In the case where the observation
times of the price process are endogenous, techniques were extended in Potiron and
Mykland (2015).

Finally, from a practical point-of-view, empirical work (see Section 8) with Orange
France Telecom stock on the CAC 40 using the time-varying friction parameter exten-
sion of the model with uncertainty zones reveals that the friction parameter is indeed
time-varying and that the volatility estimates obtained with the LPE can diﬀer very
much from the ones calculated using the original parametric estimator. In addition,
they indicate that the estimates are robust to minor changes in the block size hn.

1.3 The serious statistical implications of incorrectly assuming

that a parameter is non time-varying

We remind the reader that assuming that θ∗ is constant when it’s not can raise serious
estimation issues. It means that we are using the estimator with the wrong model. In
likelihood theory, ever since Fisher (1922, 1925) introduced the method of maximum
likelihood, a signiﬁcant body of the literature has taken an interest in the asymptotic
behavior of the MLE when the model is misspeciﬁed. This was pioneered by Berk (1966,
1970) for the Bayesian approach and Huber (1967), who took the classical perspective.

More recently, White (1982), among numerous other authors, also investigated the
issue and showed that the Quasi Maximum Likelihood Estimator (QMLE) is no longer
necessarily consistent with the object of interest, in our case the integrated parameter
(3). The author showed that the QMLE can converge to a value, but this is not
necessarily the one the econometrician has in mind. Also, the estimated standard
deviation can be wrong.

Consequently, this has lead to wrong inferences, building conﬁdence intervals of
the wrong size, rejecting or accepting hypothese with a probability diﬀerent from the
acceptance rate, setting wrong forecast intervals and so on. This is much of the same
problem as the one we face when we are ﬁtting a general linear model (GLM) and we

6

encounter over-dispersion (see p.124 of McCullagh and Nelder (1989)). This issue is
easily, and very often, overlooked in practice.

2 The setup

2.1 Data-generating mechanism
We assume that we infer from the dr-dimensional vectors {R1,n, ··· , RNn,n}, which are
functions of the observations where Nn can be random, the observation times are such

that τ0,n := 0 < τ1,n < ··· < τNn,n ≤ T and(cid:2)τi−1,n, τi,n

(cid:3) is the time block corresponding

i,n , is equal to the time
to Ri,n. We further assume that the last component of Ri,n, R(dr)
increment ∆τi,n. As an example when dr := 2, R(1)
i,n can be deﬁned as the (possibly
log) returns of the original observations. As such, we will refer abusively to Ri,n as
returns in the rest of the paper, but they should be thought as observable quantities.
We assume that the returns Ri,n depend on the underlying parameter process θ∗
t . In
particular, the sampling times can depend on θ∗
t .

2.2 The parameter
We will assume that the p-dimensional parameter process θ∗
which is restricted to lie in K, a (not necessarily compact) subset of Rp, is a continuous
local martingale of the form

t )(1),··· , (θ∗

t

:= (cid:0)(θ∗

t )(p)(cid:1),

dθ∗

t := σθ

t dW θ
t

(4)

is a random nonnegative process (of dimension p × p), and W θ

where σθ
t
p-dimensional Brownian motion. The parameter θ∗
volatility, the high-frequency covariance, the betas, etc.

t a standard
t can be for example equal to the

We don’t assume any independence between θ∗

t and the other quantities driving the
observations, such as the Brownian motion of the eﬃcient price process, the volatility
of the eﬃcient price process, the microstructure noise, etc. In particular, there can be
leverage eﬀect (see e.g. Wang and Mykland (2014), Aït-Sahalia et al. (2014)). Also,
the arrival times τi,n and the parameter θ∗
t can be correlated, i.e. there is endogeneity
in sampling times.

7

use the notation | ν |:= (cid:80)u

In the rest of this paper, for any u-dimensional vector ν := (ν(1),··· , ν(u)), we will
k=1 |ν(k)| when referring to the Manhattan norm. Also,
for any θ ∈ K, we deﬁne the 1-dimensional vector θ+ as the minimum value of the
t | is locally
1-dimensional sub-parameters restricted to be positive. We assume that | θ∗
bounded and (θ∗
t )+ is locally bounded away from 0. Furthermore, we assume that the
volatility of the parameter, σθ

t , is locally bounded.

2.3 Asymptotics

There are commonly two choices of asymptotics in the literature: the high-frequency
asymptotics, which makes the number of observations explode on [0, T ], and the low-
frequency asymptotics, which takes T to inﬁnity. We chose the former one. Investigating
the low-frequency implementation case is beyond the scope of this paper1.

3 Estimation

We need ﬁrst to ﬁx the vocabulary for the rest of this paper. Parametric model will
refer to the (non time-varying) parametric model of the econometrician, and not to the
time-varying parameter model. Correspondingly, parametric estimator stands for the
parametric estimator (in the parametric model).

Since the stochastic parameter θ∗

t is continuous, the parametric model is not too far
from the time-varying parameter model locally. We recall that hn corresponds to the
block size. If we let ˜Θ1,n := θ∗
0 be the initial parameter value and we deﬁne on the ﬁrst
block for j = 1,··· , hn the return approximations ˜Rj,n which follow the parametric
1,n and Rj,n are very close to each other
model with mixture of parameters ˜Θ1,n, then ˜Rj
since the observation times τ1,n,··· , τhn,n are in a small neighborhood of 0. Thus,
because true and approximated returns are approximately the same, one can apply the
the parametric model. We thus obtain an estimate (cid:98)Θ1,n of the initial parameter value
parametric estimator to the observed returns Rj,n, even though Rj,n are not following

1If we set down the asymptotic theory in the same way as in p.3 of Dahlhaus (1997), we conjecture

that the results of this paper would stay true.

8

˜Θ1,n. We also deﬁne the spot parameter’s average on the ﬁrst block as

Θ1,n :=

,

(5)

(cid:82) T1,n

θ∗
sds
T0,n
∆T1,n

(cid:82) Ti,n

Ti−1,n

where the ﬁrst block inital time T0,n := 0 and ﬁnal time T1,n := τhn,n. Since the ﬁrst
block length ∆T1,n is very small, the value of ˜Θ1,n is approximately equal to the average

of the spot parameter on the ﬁrst block Θ1,n. Thus, (cid:98)Θ1,n can be used to estimate Θ1,n.

More generally, for i = 2,··· , Bn we deﬁne the spot parameter’s average on the ith

block as

θ∗
sds
∆Ti,n
where Ti,n := min(τihn, T ). Let Bn := (cid:112)Nnh−1
2,··· , Bn we estimate in the same way Θi,n with initial value ˜Θi,n := θ∗

parametric estimator on the ith block (cid:98)Θi,n. Then, we take the weighted sum of (cid:98)Θi,n

(cid:113) be the number of blocks. For i =
using the

Θi,n :=

Ti−1,n

(6)

n

,

and obtain an estimator of the integrated spot process

(cid:98)Θn :=

Bn(cid:88)

i=1

1
T

(cid:98)Θi,n∆Ti,n.

(7)

Note that each block includes exactly hn observations, except for the last one, which
might include fewer observations. We call (7) the local parametric estimator (LPE),
since we are are estimating with the parametric estimator on each block.

4 Outline of the problem

4.1 A simple model

We focus on a simple setting in this section. First, we work with dr := 2. Also, we
assume that the observations occur at equidistant time intervals ∆τn := T
n , so that
i,n := ∆τn is deterministic. For the rest of Section 4, we will
τi,n = i
forget about the second component of the returns Ri,n, which doesn’t provide us any
further information, and pretend that Ri,n is real-valued. The parametric model is

n T and thus R(2)

9

assumed to be very simple. It assumes that there exists a parameter θ∗ ∈ K such that
Ri,n are independent and identically distributed (IID) random functions of θ∗. If we
introduce Ui,n an adequate IID sequence of random variables with distribution U, we
can express the returns as

(cid:0)Ui,n, θ∗(cid:1),

Ri,n

:= Fn

(8)

where Fn(x, y) is a non-random function.
innovation.

In (8), Ui,n can be seen as the random

Since θ∗

:= σ2

t

τi−1,n

sumed to follow (4)), and Ri,n :=(cid:82) τi,n

t can in fact be time-varying, Ri,n don’t necessarily follow (8) in the time-
varying parameter model. A formal time-varying generalization of (8) will be given in
(11). In general, Ri,n are neither identically distributed nor independent. Ri,n are not
even necessarily conditionally independent given the true parameter process θ∗
t , as we
can see in the following two toy examples.
Example 1. (estimating volatility) Consider when θ∗

t (the volatility is thus as-
σsdWs, where Wt is a standard 1-dimensional
Brownian motion. In this case, the parameter space is K := R+∗ . The parametric model
assumes θ∗ := σ2 and that the distribution of the returns is Ri,n := σ∆Wτi,n, where
∆Wτi,n := Wτi,n − Wτi−1,n is the increment of the Brownian motion between the (i− 1)th
observation time and the ith observation time and σ2 is the ﬁxed volatility. Under that
assumption, the returns are IID. Under the time-varying parameter model, Ri,n are
clearly not necessarily IID, and they are also not necessarily conditionally independent
given the whole volatility process σ2
Example 2. (estimating the rate of a Poisson process) Suppose an econometrician ob-
serves data on the number of events (such as trades) in an arbitrary asset, and thinks
the number of events happening between 0 and t, Nt, follows a homogeneous Poisson
process with rate λ. The parameter rate θ∗
t := λt will be assumed to follow (4), with
possibly a null-volatility σθ
t = 0 if the homogeneity assumption turns out to be true. Be-
cause the econometrician doesn’t have access to the raw data, she can’t observe directly
the exact time of each event. Instead, she only observes the number of events happening
− Nτi−1,n.
on a period (for instance a ten-minute block) [τi−1,n, τi,n), that is Ri,n = N−
If the econometrician’s assumption of homogeneity is true, the returns are IID. In case

t if there is a leverage eﬀect.

τi,n

10

of heterogeneity, Nt will be a inhomogeneous Poisson process, and the returns Ri,n will
most likely be neither identically distributed nor independent.

i,n,··· , Rhn

We need to introduce some notation and deﬁnitions. On a given block i = 1,··· , Bn
the observed returns will be called R1
i,n :=
R(i−1)hn+j,n for any j = 1,··· , hn. In analogy with Rj
i,n, we introduce the approximated
returns ˜R1
i,n on the ith block. We also introduce the corresponding observation
times τ j
i−1,n. Finally, for j =
1,··· , hn we deﬁne the time increment between the (j − 1)th return and the jth return
of the ith block as ∆τ j

i,n,··· , ˜Rhn
i,n := τ(i−1)hn+j,n for j = 0,··· , hn. Note that τ 0

i,n. Formally, it means that Rj

i,n = τ hn

i,n := τ j

i,n − τ j−1
i,n .

We provide a time-varying generalization of the parametric model (8) as well as a
formal expression for the approximated returns. To deal with the former, we assume
that in general

(cid:0)Ui,n,{θ∗

Ri,n

:= Fn

s}τi−1,n≤s≤τi,n

(cid:1).

(9)

(10)

The time-varying parameter model in (9) is a natural extension of the parametric
model (8) because the returns Ri,n can depend on the parameter process path from
the previous sampling time τi−1,n to the current sampling time τi,n. As Ri,n depend
on the parameter path, it seems natural to allow Ui,n to be themselves process paths.
For example, when the parameter is equal to the volatility process θ∗
t , we will
assume that Ui,n are equal to the underlying Brownian motion Wt path (see Example 3
for more details). Also, as Ui,n are random innovation, they should be independent of
the parameter process path past, but not on the current parameter path. In the case
of volatility, it means that we allow for the leverage eﬀect. A simple particular case of
(9) is given by

:= σ2

t

(cid:0)Ui,n, θ∗

(cid:1),

Ri,n

:= Fn

τi−1,n

i.e. the returns depend on the parameter path only through its initial value. The time-
varying Hitting Constant Boundaries model and the time-varying friction parameter
model with uncertainty zones are deﬁned as a mix of (9) and (10) in Section 7.1.
Finally, the approximated returns ˜Ri,n follow a mixture of the parametric model (8)
with initial block parameter value. We are now providing a formal deﬁnition of our

11

(cid:0)U j
(cid:0)U j

s}τ j−1

i,n,{θ∗
i,n, ˜Θi,n

(cid:1),

(cid:1),

intuition. We assume that

i,n

:= Fn

s}τ j−1

i,n ≤s≤τ j

i,n

i,n ≤s≤τ j

i,n

Rj
i,n
˜Rj
i,n

i,n and the parameter process {θ∗
i,n in the two toy examples.

(11)
(12)
:= Fn
i,n take values on a space Un that can be functional2
where the random innovation U j
i,n are IID for a ﬁxed n but the distribution can depend
and that can depend on n, U j
on n, and Fn(x, y) is a non-random function3. Note that (11) is a mere re-expression
of (9) using a diﬀerent notation. For any block i = 1,··· , Bn and for any observation
time j = 0,··· , hn of the ith block, we deﬁne I j
4 the information up to time τ j
i,n.
i,n has to be independent of the past information5
The crucial assumption is that U j
(and in particular of ˜Θi,n). Note that we don’t assume any independence between the
random innovation U j
. We provide directly
the deﬁnitions of Fn and U j
Example 3. (estimating volatility) In this case, Un is deﬁned as the space C1[0, ∆τn] of
continuous paths parametrized by time t ∈ [0, τn], U j
are
the Brownian motion increment path processes between two consecutive observation
times. We assume that (W θ
t , Wt) is jointly a (possibly non-standard) 2-dimensional
i,n are indeed independent of the
Brownian motion. Thus, the random innovation U j
past in view of the Markov property of Brownian motions. We also deﬁne Fn(ut, θt) :=
for example the space C1[0, ∆τn] of 1-dimensional continuous paths
2Un is a Borel space,
parametrized by time t ∈ [0, τn].
3Let Cp(R+) be the space of p-dimensional continuous paths parametrized by time t ∈ R+, which is
a Borel space. Consequently, Un × Cp(R+) is also a Borel space. We assume that Fn(x, y) is a jointly
measurable real-valued function on Un × Cp(R+). Note that the advised reader will have seen that a
priori {θ∗
i,n ) in (11) and ˜Θi,n
is a vector in (12), whereas both should be deﬁned on the space Cp(R+) according to the deﬁnition.
We match the deﬁnitions by extending them as continuous paths on R+. Formally, if θt ∈ Cp[0, τn],
we extend it as θt := θτn for all t > τn. Similarly, if θ ∈ K, we extend it as θt := θ for all t ≥ 0.
4In this paper, we will be using the term information to refer to the mathematical object of
ﬁltration. Let (Ω,F, P ) be a probability space. Deﬁne the sorted information {Ik,n}k≥0 such that
for any non-negative integer k that we can decompose as k = (i − 1)hn + j where i ∈ {1,··· , Bn}
i,n. We assume that Ik,n is a (discrete-time) ﬁltration on (Ω,F, P ). In
and j ∈ {0,··· , hn}, Ik,n := I j
addition, we assume that {θ∗
s}0≤s≤τ j

is deﬁned on Cp[0, τn] (after translation of the domain by −τ j−1

i,n := {∆W[τ j−1

i,n ,s]}τ j−1

i,n-measurable.

i,n are I j

i,n ≤s≤τ j

i,n

s}τ j−1

i,n ≤s≤τ j

i,n

and U j
5past information means up to time τ j−1

i,n

i,n

12

(cid:82) τn

1
2

i,n :=(cid:82) τ j

i,n

τ j−1

i,n

i,n

∆W[τ j−1

i,n ,τ j

s dus. We thus obtain that the returns are deﬁned as Rj

σsdWs and that
i,n] are the same quantity when holding

0 θ
the approximated returns ˜Rj
i,n := στ 0
the volatility constant on the block.
Example 4. (estimating the rate of a Poisson process) We assume that the rate of the
(possibly inhomogeneous) Poisson process is αnλt, where αn is a non time-varying and
non-random quantity such that αn∆τn := 1. In this case, we assume that Un is the
space of increasing paths on R+ starting from 0 which takes values in N and whose
jumps are equal to 1. We also assume that for any path in Un, the number of jumps
is ﬁnite on any compact of R+. U j
i,n can be deﬁned as standard Poisson processes
{N i,j,n
0 αnθsdus. Thus, if
we let tj

}t≥0, independent of each other. We also have Fn(ut, θt) := u(cid:82) τn
i,n :=(cid:82) τ j

αnλsds, the returns are the time-changed Poisson processes

t

i,n

τ j−1

i,n

Rj

i,n = N i,j,n

tj
i,n

,

˜Rj

i,n = Nαn∆τ j

i,nλi,j,n

τ 0
i,n

.

(13)

(14)

4.2 Consistency

In the following of this section and Section 6, we will make the block size hn go to
inﬁnity

hn → ∞.

(15)

Furthermore, we will make the block length ∆Ti,n vanish asymptotically. Because we
assumed observations are regular in this section, this can be expressed as

hnn−1 → 0.

We can rewrite the consistency of (cid:98)Θn as
(cid:0)(cid:98)Θi,n − Θi,n

Bn(cid:88)

(cid:1)∆Ti,n

P→ 0.

(16)

(17)

where the formal deﬁnition of (cid:98)Θi,n can be found in (21). In order to show (17), we can
decompose the increments ((cid:98)Θi,n−Θi,n) into the part related to misspeciﬁed distribution

i=1

13

error, the part on estimation of approximated returns error and the evolution in the
spot parameter error

(cid:98)Θi,n − Θi,n =(cid:0)(cid:98)Θi,n −(cid:98)˜Θi,n

(cid:1) +(cid:0)(cid:98)˜Θi,n − ˜Θi,n

(cid:1) +(cid:0) ˜Θi,n − Θi,n

(cid:1),

where (cid:98)˜Θi,n, which is deﬁned formally in (22), is the parametric estimator used on

(18)

the underlying non-observed approximated returns. It is not a feasible estimator and
appears in (18) only to shed light on the way we can obtain the consistency of the
estimator in the proofs. We ﬁrst deal with the last error term in (18), which is due to
the non-constancy of the spot parameter θ∗

t . Note that

(19)

(20)

(cid:90) Ti,n

Ti−1,n

sds(cid:1)

θ∗

∆Ti,n −

Bn(cid:88)

i=1

Bn(cid:88)

(cid:0)θ∗
(cid:1)∆Ti,n =
(cid:0) ˜Θi,n − Θi,n
Bn(cid:88)
(cid:1)∆Ti,n
(cid:0) ˜Θi,n − Θi,n

Ti−1,n

i=1

i=1

P→ 0.

and thus we deduce from Riemann-approximation6 that

To deal with the other terms in (18), we assume that for any positive integer k, the
practitioner has at hand an estimator ˆθk,n := ˆθk,n(r1,n; ··· ; rk,n), which depends on the
input of returns {r1,n;··· ; rk,n}. On each block i = 1,··· , Bn we estimate the local
parameter as

The non-feasible estimator (cid:98)˜Θi,n is deﬁned as the same parametric estimator with ap-

(21)

i,n

i,n;··· ; Rhn

proximated returns as input instead of observed returns

(cid:98)Θi,n := ˆθhn,n

(cid:98)˜Θi,n := ˆθhn,n

(cid:0)R1
(cid:0) ˜R1

i,n;··· ; ˜Rhn

i,n

(22)

(cid:1).
(cid:1).

Note that (22) is infeasible because the approximated returns ˜Rj
quantities.
Example 5. (estimating volatility) The estimator is the scaled usual RV, i.e. ˆθk,n(r1,n;
j,n. Note that ˆθk,n can also be asymptotically seen as the

··· ; rk,n) := T −1k−1n(cid:80)k

i,n are non-observable

j=1 r2

MLE (see the discussion pp. 112-115 in Mykland and Zhang (2012)).

6see i.e. Proposition 4.44 in p.51 of Jacod and Shiryaev (2003)

14

Example 6. (estimating the rate of a Poisson process) The estimator to be used is the

return mean ˆθk,n(r1,n;··· ; rk,n) := k−1(cid:80)k

j=1 rj,n.

For any M > 0, we introduce the following bounded space for the parameter value.
| θ |≤ M and θ+ ≥

Deﬁnition. (KM) For any M > 0, we deﬁne KM := {θ ∈ K :
M−1}, which is a bounded subset of K.

In order to tackle the second term in (18), we make the assumption that the para-
metric estimator is L1-convergent, locally uniformly in the model parameter θ if we
actually observes returns coming from the parametric model. This can be expressed in
the following condition.
Condition (C1). Let the innovation of a block (V1,n,··· , Vhn,n) be IID with distribu-
tion U. For any M > 0,

E(cid:104)(cid:12)(cid:12)ˆθhn,n(Fn(V1,n, θ);··· ; Fn(Vhn,n, θ)) − θ(cid:12)(cid:12)(cid:105) → 0.

sup
θ∈KM

Remark 1. (practicability) Under Condition (C1), results on regular conditional distri-
butions7 give us that the error made on the estimation of the underlying non-observed
returns tends to 0, i.e.

Bn(cid:88)

(cid:0)(cid:98)˜Θi,n − ˜Θi,n

(cid:1)∆Ti,n

P→ 0.

(23)

i=1

This proof technique is the main idea of the paper. Regular conditional distributions
are used to deduce results on the time-varying parameter model using uniform results in
the parametric model. It considerably simpliﬁes the work of the econometrician, in the
sense that Condition (C1) is most likely easier to verify than (23). Indeed, Condition
(C1) is "parametric" with non-random parameter, whereas (23) is "nonparametric" and
each term of the sum ˜Θi,n is a mixture of parameter. Moreover, the uniform convergence
in Condition (C1) shouldn’t be an additional problem at all once the econometrician
has the (non-uniform) convergence because the parameter θ ∈ KM, which is a bounded
space.

7see for instance Leo Breiman (1992), see Appendix 10.2 for more details.

15

Remark 2. (consistency) Note that L1-convergence is slightly stronger than the simple
consistency of the parametric estimator. Nonetheless, in most applications, we will
have both.

To deal with the ﬁrst term of (18), we need to make sure that we can control the
discrepancy between the estimate made on the observed returns and the estimate made
on the underlying approximated returns, uniformly in the initial parameter and in the
future path of the parameter process. First, we need to introduce a new deﬁnition.
Deﬁnition. (EM,n) For any M > 0, we deﬁne EM,n the product space of all null-drift
continuous p-dimensional Itô-process and innovation (θt, Vn), where Vn := (V1,n,··· ,
Vhn,n), such that the initial value θ0 is non-random, θt ∈ KM for all 0 ≤ t ≤ T , the
volatility of θt is bounded by M for all 0 ≤ t ≤ T , and for any j = 1,··· , hn we have
Vj,n independent of the path past {θs}0≤s≤τ j−1

.

1,n

In analogy with KM which is a bounded space for the parameter value, EM,n can
be seen as a bounded space for the parameter path (in the parameter value and the
parameter volatility at each time 0 ≤ t ≤ T ). Note that each path in EM,n is random
(but with non-random starting value), whereas elements of KM are non-random. We
can now express the new following assumption.

Condition (C2). We have

(cid:20)(cid:12)(cid:12)(cid:12)ˆθhn,n
(cid:0)Fn(V1,n,{θs}0≤s≤τ 1

(θt,Vn)∈EM,n

sup

E

1,n

−ˆθhn,n

(cid:0)Fn(V1,n, θ0),··· , Fn(Vhn,n, θ0)(cid:1)

),··· , Fn(Vhn,n,{θs}τ hn−1

1,n ≤s≤τ hn

1,n

)(cid:1)(cid:12)(cid:12)(cid:12)(cid:21) P→ 0.

Remark 3. (practicability) Condition (C2) implies8 that the error due to the local model
approximation vanishes in the limit, i.e.

Bn(cid:88)

((cid:98)Θi,n −(cid:98)˜Θi,n)∆Ti,n

P→ 0.

(24)

i=1

Here again, the main argument of the proof is regular conditional distributions.
In
analogy with Remark 1, the econometrician is expected to have less trouble verifying

8see Appendix 10.2 for more details

16

Condition (C2) than (24). Indeed, the parameter has a non-random initial value (and
a random path) in Condition (C2), but a mixture of initial value σθ
(and a random
τ 0
i−1,n
path) in (24). Note that here again the uniformity in Condition (C2) is not expected
to add any diﬃculty to the problem because we look at expected values and EM,n is a
well-chosen bounded space (in the parameter value and the parameter volatility).

We can now summarize the theorem on consistency in this very simple case where
observations occur at equidistant time intervals and returns are IID under the para-
metric model.

Theorem (Consistency). Under Condition (C1) and Condition (C2), we have the
consistency of (7), i.e.

(cid:98)Θn

P→ Θ.

We obtain the consistency in the couple of toy examples9.

Remark 4. (adding a drift) In Example 1, by Girsanov theorem, together with local
arguments (see, e.g., pp.158-161 in Mykland and Zhang (2012)), we can weaken the
price and volatility local-martingale assumption by allowing them to follow an Itô-
process (of dimension 2), with a volatility matrix locally bounded and locally bounded
away from 0, and drift which is also locally bounded.
Remark 5. (LPE equal to the parametric estimator) The reader will have noticed that
in the couple of examples, the LPE is equal to the parametric estimator. This is because
in those very basic examples, the parametric estimator is linear, i.e.
for any positive
integer k and l = 1,··· , k − 1
l
k

ˆθk−l,n(rl+1,n;··· ; rk,n)

k − l
k

ˆθk,n(r1,n;··· ; rk,n) =

ˆθl,n(r1,n;··· ; rl,n) +

(25)

In more general examples of Section 7, (25) will break, and we will obtain two distinct
estimators.

4.3 Challenges

There are three empirical reasons why the presentation above is too simple. In practice,
the observed returns can be autocorrelated, noisy and there can be endogeneity in

9see Appendix 10.3 for proofs

17

sampling times. Accordingly, we will build the general LPM in Section 5. Also, we will
investigate the limit distribution in Section 6.

5 The Locally Parametric Model (LPM)

We want to allow a general model for the returns Ri,n. To do that, we introduce
the random non-observed quantities Qi,n, which take values into the general space
Qn. We also deﬁne Mi,n := (Qi,n, Ri,n), and assume that Mi,n take values on the
space Mn
10, which is a subset of Qn × Rdr. Let m be a nonnegative integer (which
can be inﬁnite) which will stand for the order of memory in the model. We deﬁne
the m initial values M−(m−1),n,··· , M0,n of the Markov chain. Also, we introduce the
m-dimensional "memory" vectors of past quantities Mi,n := (Mi,n,··· , Mi−(m−1),n),
which take values on a space Mm,n (subset of Mm
n ). Finally, we will refer to Mi,n :=
(Qi,n, Ri,n) respectively for the unobserved part and the observed part of Mi,n. The
parametric model is assumed to be expressed as

Mi,n := Fn(Mi−1,n, Ui,n, θ∗),

(26)
where Fn(x, y, z) is a Mn-valued non-random function11, the random innovation Ui,n
are IID with distribution U for a ﬁxed n (but the distribution can depend on n) and
independent of the past information. The parametric model (26) can be compared to
the simple parametric model (8). The only change is that we allow for past-correlation
in the model.

The interpretation of Qi,n is straightforward. Among all the non-observed informa-
tion we have from the past, Qi,n are the quantities which matter in the distribution of
the future returns. In particular, the parametric model (26) allows for auto-correlation
in returns (up to a lag possibly bigger than m). The reader should look at Section 7 to
see how we identify Qi,n and Ri,n to the quantities in diﬀerent models.

10Mn is assumed to be a Borel space.
11We assume that for i any positive integer, Ui,n ∈ Un where Un is a Borel space and that Fn(x, y, z)
is deﬁned on Mm,n×Un×Cp(R+). Additionally, we assume that Fn(x, y, z) is a jointly measurable Mn-
valued function such that for any (Mn, Un, θt) ∈ Mm,n×Un×Cp(R+), we have E | Fn(Mn, Un, θt) |< ∞

18

In analogy with (9), we assume that the time-varying parameter model can be

expressed as12

s}τi−1,n≤s≤τi,n).

Mi,n = Fn(Mi−1,n, Ui,n,{θ∗

(27)
If we take Qn big enough and m = +∞, it is almost always possible to ﬁnd a function Fn
and unobserved quantities Qi,n such that (27) holds. It means that most of the existing
models in the literature which assume null-drift Itô-process time-varying parameter are
contained within the LPM class. Nonetheless, conditions in Section 6 will be harder to
verify with a bigger Qn space, and techniques of this paper might be unhelpful in that
case. The econometrician should investigate the simplest possible Qn and the smallest
m to build her time-varying parameter model.

Equivalently, the parametric model (26) can be seen as a (m-dependent) Markov
chain of order m with a general state space Mm,n. We insist on the fact that under
the time-varying parameter model (27), the returns Ri,n can be much diﬀerent from a
Markov chain. Under the time-varying parameter model, Mi,n is not even necessarily
a inhomogeneous Markov chain (of order m). Nonetheless, we can see in (27) that
Mi,n is almost a inhomogeneous Markov chain (of order m), except for the evolution of
the parameter θ∗
t part which is not necessarily Markovian. In particular, if we assume
that the volatility σθ
t is not time-varying, Mi,n is a inhomogeneous
Markov chain (of order m). In the following, we will use the expression "Markov chain"
but the reader should understand "Markov chain under the parametric model" or even
"locally Markov chain". We also drop the part "of order m".

t of the parameter θ∗

Note that the simple model introduced in Section 4.1 is a particular case with m = 0
and no unobserved quantities Qi,n.
If we assume that we have regular observation
times and that the microstructure noise is uncorrelated with the eﬃcient price and
IID normally distributed, the parametric model of the observed returns is a MA(1)
(see Aït-Sahalia et al. (2005) and Xiu (2010)). Thus, we have m = 1 in that example.
s}0≤s≤τi,n ), and the Central Limit
Theorem stays true under this more general assumption.
In that case, the conditions of Section
6 would be slightly altered. Nonetheless, we choose to work under (27) to keep the analysis more
tractable in Section 6.

12In all generality, we can assume Mi,n = Fn(Mi−1,n, Ui,n,{θ∗

19

Additionally, the unobserved quantities Qi,n are non trivial. The details on that example
are to be found in Section 7.3.

6 Asymptotic properties

We investigate in the following of this section the limit distribution. Formally, for a
l ), we aim to ﬁnd the limit distribution
l > 0 (with corresponding rate of convergence n 1
of

Bn(cid:88)

(cid:0)(cid:98)Θi,n − Θi,n

(cid:1)∆Ti,n.

1

l T −1

n

(28)

i=1

Speciﬁcally, we want to show that (28) converges stably 13 to a limit distribution. We
give the deﬁnition of stable convergence.

Deﬁnition. (stable convergence) A sequence of integrable variable Zn known with
information J is said to converge weakly to an integrable random variable Z if for all
E ∈ J ,

E(cid:2)Zn1E

(cid:3) → E(cid:2)Z1E

(cid:3)

This mode of convergence, which is a bit stronger than the regular convergence in
distribution, is due for the statistical purpose. Because we will obtain in the variance
limit of (28) random quantities, we need the stable convergence to infer the same way
we would do it if the variance limit was nonrandom. Since the stable convergence needs
a corresponding information J to be deﬁned with, we need to be more speciﬁc about
the deﬁnition of J . We will be needing the following technical assumption, which turns
out to be easily veriﬁed on examples in Section 7. The idea goes back to Heath (1977).
We deﬁne Ii,n
13One can look at deﬁnitions of stable convergence in Rényi (1963), Aldous and Eagleson (1978),
Chapter 3 (p. 56) of Hall and Heyde (1980), Rootzén (1980), and Section 2 (pp. 169-170) of Jacod
and Protter (1998).

14 the information up to time τi,n.

14We assume that Ii,n is a (discrete-time) ﬁltration on (Ω,F, P ) such that {θ∗

s}0≤s≤τi,n and Ui,n
are adapted to Ii,n. Also, we assume that M0,n is I0,n-measurable. Finally, the assumption "Ui,n
independent of the past information" can be formally expressed as Ui,n independent of Ii−1,n.

20

Condition (E0). Ii,n can be extended into Ji,n
mation of a continuous information J (c)

, i.e. Ji,n = J (c)
τi,n.

t

15, where Ji,n is the interpolated infor-

In the following of this paper, when using the conditional expectation Eτ

we will refer to the conditional expectation of Z knowing J (c)
J := J (c)

the information to go with stable convergence.

τ

T

. Finally, we consider

(cid:2)Z(cid:3)16,

We are now more speciﬁc about the form of the parametric estimator. As in Sec-
tion 4.2, the parametric estimator will include the returns {r1,n,··· , rk,n} as inputs.
Moreover, because the returns are past-correlated, we allow the parametric estimator
to possibly depend on the m-dimensional vector of initial returns r0,n. To sum up, the
parametric estimator takes the following form

ˆθk,n := ˆθk,n(r1,n;··· ; rk,n; r0,n).

(29)
Let i = 1,··· , Bn be the block number. In analogy with the "block notations" in Sec-
tion 4.1, we deﬁne the Markov chain elements on the ith block M j
i,n := M(i−1)hn+j,n
for j = 1,··· , hn. We also deﬁne the initial vector of the ith block as M0
i,n :=
) := M(i−1)hn,n. Formally, the spot parameter estimator on the
(M 0

ith block (cid:98)Θi,n is deﬁned as the parametric estimator with observed returns as input
i,n,··· , M

−(m−1)
i,n

(cid:98)Θi,n := ˆθhn,n(R1

i,n;··· ; Rhn

i,n; R0

i,n).

(30)

We alo introduce the following deﬁnition.

Deﬁnition. (cid:0)E (1),i

M,n

(cid:1) For any block number i = 1,··· , Bn and any M > 0, E (1),i

ﬁned as the bounded space of time-varying parameter θt such that (θt, U 1
EM,n.

M,n is de-
i,n ) ∈

i,n,··· , U hn

M,n . For any j = −(m − 1),··· , hn we deﬁne M j,M,θ

Consider the block number i = 1,··· , Bn. Let M > 0, M ∈ Mm,n, θ ∈ KM
and θt ∈ E (1),i
the
Markov chain approximations with initial vector M and ﬁxed parameter θ (respec-
tively with time-varying parameter process θt). The initial vectors are deﬁned as
) := M. Also, we
(M

,··· , M 0,M,θt

) := M and (M

,··· , M 0,M,θ

and M j,M,θt

−(m−1),M,θt
i,n

−(m−1),M,θ
i,n

i,n

i,n

i,n

i,n

15It means that Ji,n is a discrete ﬁltration and for any i nonnegative integer Ii,n ⊂ Ji,n
16The underlying assumption is that τ is a J (c)

-stopping time.

t

21

,··· , M j−(m−1),M,θ
deﬁne the m-dimensional "memory" vectors as Mj,M,θ
)
and Mj,M,θt
). Finally, for any positive integer j, the
jth element of the ith block Markov chain approximations are obtained by the same
recurrence relations as (26) and (27)

,··· , M j−(m−1),M,θt

:= (M j,M,θt

:= (M j,M,θ

i,n

i,n

i,n

i,n

i,n

i,n

(cid:0)Mj−1,M,θ
(cid:0)Mj−1,M,θt

i,n

i,n

, U i
, U j

j,n, θ(cid:1),

i,n,{θs}τ j−1

i,n ≤s≤τ j

i,n

i,n

M j,M,θ
M j,M,θt

i,n

:= Fn

:= Fn

(cid:1).

(31)
(32)

We introduce now the infeasible estimator on the ith block ˆ˜ΘM
i,n with initial vector
M ∈ Mm,n. Compared to (21), ˆ˜ΘM
i,n depends also on the initial block vector. Such
dependence will be useful in the decomposition (34). The infeasible estimator is deﬁned
as

ˆ˜ΘM
i,n := ˆθhn,n(R1,M, ˜Θi,n

i,n

;··· ; Rhn,M, ˜Θi,n

i,n

; R0,M, ˜Θi,n

i,n

).

(33)

Since there is endogeneity, observation times matter in this work. When approximating
the returns on a block holding the parameter θ∗
t constant, we also induce a change in
the observation times. For that reason, we introduce the following deﬁnitions. We
deﬁne the length of the ith block with starting vector M and with non time-varying
)(dr) and the length of the ith block with starting
parameter θ as ∆TM,θ
vector M and with time-varying parameter θt as ∆TM,θt

i,n :=(cid:80)hn

:=(cid:80)hn

j=1(Rj,M,θ

Let the nonrandom known vector M∗

econometrician to carry the analysis of (28). We can decompose(cid:0)(cid:98)Θi,n − Θi,n
(cid:1)∆Ti,n as
(cid:0)(cid:98)Θi,n∆Ti,n − ˆ˜Θ
(cid:1)
+(cid:0) ˆ˜ΘM∗
(cid:1)∆TM∗
(cid:1)∆Ti,n

(cid:1) +(cid:0) ˜Θi,n − Θi,n

n) ∈ Mm,n, which is chosen by the

(cid:1) +(cid:0) ˆ˜Θ
(cid:0)∆TM∗

M0
i,n ∆T
n, ˜Θi,n

i,n ∆TM∗

j=1 (Rj,M,θt

n := (Q∗

n, R∗

− ∆Ti,n

M0
i,n ∆T

− ˆ˜ΘM∗

i,n − ˜Θi,n

+ ˜Θi,n

)(dr).

i,n, ˜Θi,n

i,n, ˜Θi,n

(34)

n, ˜Θi,n

M0
i,n

n, ˜Θi,n

i,n

n

i,n

i,n

M0
i,n

i,n

i,n

i,n

i,n

i,n

n

where the ﬁrst term is the error in estimation due to the use of the approximated
model (33) instead of the time-varying parameter model (27), the second term is the
error made when taking M∗
i,n as initial value of the block in the mixture
of the parametric model (33), the third term corresponds to the error of the estimation
of the constant parameter by the underlying approximations starting with a ﬁxed initial
value M∗
n, the fourth term corresponds to the error of arrival times approximation when

n instead of M0

22

considering a parametric model starting with initial value M∗
error made by holding the process parameter constant on each block. Note that ˆ˜Θ
is a mixture of the parametric model with parameter ˜Θi,n and a mixture of starting
value M0

n and the last term is the
M0
i,n

i,n

i,n.

It is instructive to consider (34) when we assume that the time-varying parameter
model is equal to the parametric model and that the observation times are regular. In
that case, all the previously deﬁned block length approximations are equal to ∆Ti,n.
The ﬁrst term, the fourth term and the ﬁfth term are equal to 0 by deﬁnition. Addition-
ally, we can hope that asymptotically the initial values of the blocks will be forgotten
and thus that under right conditions

(cid:0) ˆ˜Θ

Bn(cid:88)

i=1

1
l

n

(cid:1)∆Ti,n ≈ 0.

M0

i,n − ˆ˜ΘM∗

n
i,n

i,n

Finally, if we assume that we know the convergence rate n 1
N (0, Vθ∗) of the parametric estimator, for any i = 1,··· , Bn we have that h

θ∗(cid:1)∆Ti,n ≈ N (0, Vθ∗)∆Ti,n and thus we can hope that

2 and the limit distribution

1
2
n

(cid:0) ˆΘi,n −

Bn(cid:88)

(cid:0)(cid:98)Θi,n − θ∗(cid:1)∆Ti,n ≈ N (0, Vθ∗)

1

2 T −1

n

under right assumptions (in particular on the block size hn).

i=1

The time-varying parameter model and endogenous arrival time case will be treated
in a similar way than the parametric model case. Formally, we will be providing in the
following conditions such that

(cid:1)∆Ti,n
(cid:1)

1
l

i=1

Bn(cid:88)
(cid:0) ˜Θi,n − Θi,n
(cid:0)∆TM∗
(cid:0) ˆ˜ΘM∗

i,n − ˜Θi,n

n, ˜Θi,n

i,n

n

(cid:1)∆TM∗

i,n

− ∆Ti,n

n, ˜Θi,n

˜Θi,n

n

Bn(cid:88)
Bn(cid:88)

i=1

1
l

n

n

1
l

i=1

23

P→ 0,

P→ 0,

st-D→ (cid:16)

T

(35)

(36)

(37)

(cid:90) T

0

(cid:17) 1

2N (0, 1),

Vθ∗

s ds

1

l T −1

n

Bn(cid:88)

i=1

n

(cid:0) ˆ˜Θ
Bn(cid:88)

1
l

i,n

M0
i,n ∆T

M0
i,n

i,n, ˜Θi,n

(cid:0)(cid:98)Θi,n∆Ti,n − ˆ˜Θ

− ˆ˜ΘM∗

i,n ∆TM∗

i,n

n

n, ˜Θi,n

i,n

M0
i,n ∆T

M0
i,n

i,n, ˜Θi,n

(cid:1)
(cid:1)

P→ 0,

P→ 0.

(38)

(39)

i=1

Note that if the sampling times are not regular, Vθ∗ will most likely be diﬀerent from the
variance of the parametric estimator. For instances of this when estimating volatility,
one can look at Corollary 2.30 on p.154 in Mykland and Zhang (2012), where the
"Asymptotic Quadratic Variation of Time" alters the variance of the RV estimator.

In the following, we provide six conditions. Condition (E1) - Condition (E4) are
used to prove (35) - (37). Moreover, (38) is proven with Condition (E5). Finally, we
can show (39) assuming Condition (E6). We make the ﬁrst assumption, which is on
observation times.

Condition (E1). The observation times are such that for k = 1, 2, 4, 8

(40)

Eτi−1,n

sup
1≤i≤Nn

(cid:2)(∆τi,n)k(cid:3) = Op(n−k).
(cid:3) = O(hnn−1).

Remark 6. (practicability) Condition (E1) is used in the proof of (35) and (37).
Remark 7. (block length) As an obvious consequence of (40) when k = 1, we have that

the block length is such that E(cid:2)∆Ti,n

Remark 8. Note that condition (E1) is satisﬁed by the general endogenous HBT model
introduced in Potiron and Mykland (2015).

We make a second assumption on the observation times, which is due to non reg-
ularity of arrival times. We make sure that when the initial Markov-chain is ﬁxed to
M∗
n, we can bound the diﬀerence in length between the approximated block and the
true block, uniformly in the block initial value parameter θ0 and the path of the pa-
rameter process θt. Let M > 0 and i = 1,··· , Bn. For any θt ∈ E (i)
M,n, M ∈ Mm,n and
N ∈ Mm,n, we deﬁne the diﬀerence in block length expectation as

i,n
and the diﬀerence variance as

EM,N,θt

i,n − ∆TN,θt

i,n

V M,N,θt
i,n

i,n − ∆TN,θt

i,n

:= E(cid:2)∆TM,θ0
:= Var(cid:2)∆TM,θ0

24

(cid:3),
(cid:3).

Condition (E2). For any M > 0, we have

Bn(cid:88)
Bn(cid:88)

i=1

i=1

sup
θt∈E (i)

M,n

(cid:12)(cid:12)E

n,M0

i,n,θt

M∗
i,n

(cid:12)(cid:12) = op(n− 1

l ),

n,M0

i,n,θt

M∗
i,n

= op(n− 2
l ).

V

sup
θt∈E (i)

M,n

(41)

(42)

(43)

(44)

Remark 9. (practicability) Condition (E2) is used to obtain (36) and (37). The reader
can refer to Remark 3 to understand the practicability of Condition (E2). The reason
why there is a sum in (41) and (42) is the introduction of the past-dependence term in
the model. If the model is simple enough so that

(cid:12)(cid:12)EM,N,θt

V,n

(cid:12)(cid:12) = op(hnn−1− 1

l ),

sup

(θt,V,M,N)∈EM,n×M2

m,n

sup

(θt,V,M,N)∈EM,n×M2

m,n

V M,N,θt
V,n

= op(hnn−1− 2
l ),

V,n

V,n

and V M,N,θt

are deﬁned as EM,N,θt

where EM,N,θt
when taking V as inno-
vation, then Condition (E2) is satisﬁed. Depending on the model, Mm,n can be very
large, and thus it might be impossible to obtain (43) and (44). In Condition (E2), (41)
and (42) can be seen as average, in the initial block value, of the expressions (43) and
(44).

and V M,N,θt

i,n

i,n

1

l(cid:48) .

The following assumption provides the existence of a l(cid:48) > 0 such that the convergence
rate of the parametric estimator is n
In most examples, such as the MLE under
regular conditions, we have l(cid:48) = 2. Condition (E3) also assumes that the parametric
estimator is not too biased. For that purpose, we introduce the deﬁnition of the bias on
the ith block BM,θ
and any θ ∈ K.
Condition (E3). For any parameter θ ∈ K, we assume that there exists a covariance
matrix Vθ > 0 such that for any M > 0, we have Vθ is bounded for any θ ∈ KM and

i,n := E(cid:2)(cid:0)ˆθhn,n(R1,M,θ

(cid:3) for any M ∈ Mm,n

; R)− θ(cid:1)∆TM,θ

;··· ; Rhn,M,θ

i,n

i,n

i,n

25

uniformly in θ ∈ KM and in i = 1,··· , Bn
; R∗

;··· ; Rhn,M∗

n,θ

n,θ

l(cid:48)
n

Var(cid:2)h
(cid:0)ˆθhn,n(R1,M∗
E(cid:2)(cid:0)(cid:0)ˆθhn,n(R1,M∗

n,θ

i,n

;··· ; Rhn,M∗

n) − θ(cid:1)∆TM∗
n) − θ(cid:1)∆TM∗

n,θ

i,n

i,n

; R∗

n,θ

i,n

i,n

i,n

1

n,θ

n,θ

(cid:3) = VθE(cid:2)∆TM∗
(cid:1)4(cid:3) = O(h

nn−2)
+o(h2
4− 4
n n−4)
l(cid:48)
= o(hnn−1− 1
l )

n,θ

i,n

(cid:3)T hnn−1

(45)
(46)
(47)

BM∗

i,n

i,n

i,n

n,θ

n,θ

Remark 10. (practicability) Condition (E3) is used to show (37). To understand the
usefulness of Condition (E3), the reader should refer to Remark 1. Condition (E3) is
more involved than Condition (C1) for two reasons. First, a more general model than
in Section 4.1 is considered. Moreover, the limit distribution is investigated instead of
the simple consistency.
Remark 11. (regular observations case) The reader might get confused when ﬁrst con-
sidering the random block length term ∆TM∗
showing up in (45), (46) and (47). One
should keep in mind that in the simple case where observations are regularly spaced, we
have ∆TM∗
:= T hnn−1. In that case, (45) only assumes that the parametric estima-
tor normalized error variance converges uniformly. Furthermore, (46) assumes that the
fourth moment of the normalized error has bounded expectation. Finally, (47) asserts
that the parametric estimator used on a block of hn observations has a bias (in the
usual sense of the deﬁnition) of order at most o(n− 1
l ). We assume now that l = 2 and
l(cid:48) = 2. As we have that hn = o(n 1
2 ) in view of (48), we obtain that the parametric
estimator bias must be of order o(h−1
n ). The MLE bias is of order O(h−1
n ) and thus
(47) is not satisﬁed. Nonetheless, it is easy to correct for the ﬁrst-order bias (see, e.g.,
Firth(1993)) and thus obtain a ﬁrst-order bias-corrected estimator with bias of order
O(h−2
4 = o(hn). In the case where
observations are not regular, the presence of the random block length term ∆TM∗
n,θ
doesn’t seem to make Condition (E3) harder to verify than in the regular case, at least
in the model with uncertainty zones (See Appendix 10.6 for details).

n ), which satisﬁes (47) if hn is chosen such that n 1

i,n

We make a fourth assumption, which is on the block size hn. In practice, Condition
(E4) provides us with the maximum block size hn to use for constant approximation
of parameter. Note that in the most common case when l = 2 and l(cid:48) = 2, (49) is
2 ), which
automatically veriﬁed. Also in that case, (48) can be written as hn = o(n 1

26

is the same block size order found in Mykland and Zhang (2011), who investigated
how constant we can hold volatility in a small neighborhood in the case of regular
observations of the price following a continuous Itô-process.

Condition (E4). The block size hn is such that

1

l −1hn = o(1),
1− 2
n → 1.
l(cid:48)

n
l −1h

2

n

(48)
(49)

Remark 12. (practicability) Condition (E4) is used in the proof of (35) and (37).

The next condition assumes that through uniformity in the parameter value and
future parameter path, we can bound the discrepancy of the parametric model starting
with two diﬀerent initial vectors. Let M > 0. For any θ ∈ KM, M1 ∈ Mm,n and
M2 ∈ Mm,n, we introduce the diﬀerence bias on the ith block as

EM1,M2,θ

i,n

:= E(cid:104)ˆθhn,n(R1,M1,θ

i,n

−ˆθhn,n(R1,M2,θ

i,n

,··· , Rhn,M1,θ
,··· , Rhn,M2,θ

i,n

i,n

; R1)∆TM1,θ

i,n

; R2)∆TM2,θ

i,n

,

and the diﬀerence variance as

V M1,M2,θ
i,n

:= Var

(cid:104)ˆθhn,n(R1,M1,θ

i,n

,··· , Rhn,M1,θ

i,n

; R1)∆TM1,θ

i,n

,··· , Rhn,M2,θ

i,n

; R2)∆TM2,θ

i,n

(cid:105)

(cid:105)

,

Condition (E5). For any M > 0 we have

i,n

−ˆθhn,n(R1,M2,θ
Bn(cid:88)
Bn(cid:88)

(cid:12)(cid:12)E

sup
θ∈KM

M0
i,n

i=1

sup
θ∈KM

i=1

i,n,M∗
n,θ

(cid:12)(cid:12) = op(n− 1

l ),

i,n,M∗
n,θ

M0
i,n

V

= op(n− 2
l ).

(50)

(51)

Remark 13. (practicability) Condition (E5) is used to show (38). The reader can refer
to Remark 9 for more details on why we choose to use sums in (50) and (51) instead of
uniformity in the block initial value.

27

The last condition is very similar to Condition (E5), except that we are not looking
at the discrepancy induced by diﬀerent initial vectors but rather the diﬀerence between
the time-varying parameter model and the parametric model when initial vectors are
equal. For that reason, we provide the following deﬁnitions. Let i = 1,··· , Bn be the
block number. For any M > 0, any θt ∈ E (1),i
M,n and any M ∈ Mm,n, we introduce the
diﬀerence bias on the ith block as

i,n

EM,θt

i,n

−ˆθhn,n(R1,M,θ0

i,n
as well as the variance of the diﬀerence

:= E(cid:2)(cid:0)ˆθhn,n(R1,M,θt
:= Var(cid:2)(cid:0)ˆθhn,n(R1,M,θt
−ˆθhn,n(R1,M,θ0
Bn(cid:88)
Condition (E6). For any M > 0, we have
Bn(cid:88)

sup
θt∈E (1),i

(cid:12)(cid:12)E

V M,θt
i,n

M0
i,n

i,n,θt

i,n,θt

i=1

M,n

i,n

i,n

,··· , Rhn,M,θt
,··· , Rhn,M,θ0

i,n

i,n

; R)∆TM,θt
i,n
; R)∆TM,θ0

i,n

,··· , Rhn,M,θt

i,n

; R)∆TM,θt

,··· , Rhn,M,θ0

i,n

; R)∆TM,θ0

i,n

(cid:3),
(cid:3).

i,n

(cid:12)(cid:12) = op(n− 1

l ),

M0
i,n

V

sup
θt∈E (1),i

M,n

i=1

= op(n− 2
l ).

(52)

(53)

Remark 14. (practicability) Condition (E6) is used to show (39). One should refer to
Remark 13.

We now state the main theorem of this paper, which investigates the limit distribu-

tion of (34).
Theorem (Central Limit Theorem). Assume Condition (E0) - Condition (E6).
Then, stably in law as n → ∞,

l(cid:0)(cid:98)Θn − Θ(cid:1) →(cid:16)

1

n

(cid:17) 1

T −1

Vθ∗

s ds

2N (0, 1).

(54)

Remark 15. (parametric model with regular observations) Note that in the case where
observations are regular and the time-varying parametric model is equal to the para-

metric model with true parameter θ∗, the asymptotic variance of (cid:98)Θn is equal to the

variance of the parametric model, i.e.

l(cid:0)(cid:98)Θn − Θ(cid:1) → V

1

n

1
2

θ∗ N (0, 1).

(cid:90) T

0

28

Remark 16. (convergence rate and asymptotic variance) In most examples, we have
that l = 2, which is the best convergence rate in the parametric model. In view of (49)
in Condition (E4), in that case we also have l(cid:48) = 2 and thus the convergence rate in
(54) is the best attainable (Gloter and Jacod (2001)). If we also assume that we have a
parametric estimator which achieves the Cramér-Rao bound of eﬃciency, we conjecture
that the variance in the right term of (54) is the nonparametric eﬃcient bound, at least
in the case where there is no endogeneity.
Remark 17. (MLE) The MLE is a natural and popular estimator.
In order for the
practitioner to be able to apply the local MLE and show the associated Central Limit
Theorem, one has to keep in mind that in ﬁnite sample, the MLE is biased, with a bias
magnitude of the order of the number of observations inverse. To verify bias conditions
(47), (50) and (52), one has to apply a ﬁrst-order bias correction to the MLE discussed
for instance in Firth (1993). This correction is easy to obtain.
Remark 18. (block size) Condition (E4) provides the asymptotic order to use for the
block size hn. Thus, it gives a rule basis to use on ﬁnite sample, but it is left to the
practitioner to ultimitalely choose hn. If the parametric estimator is badly biased, the
practitioner should increase the value of hn. Also, if the parameter process θ∗
t seems
not to be moving a lot, hn can be chosen to be bigger. In Section 8, we can see on the
model with uncertainty zones that the estimated volatility is robust to the value of hn
if we choose hn ≈ N
Remark 19. (subset parameter estimation) In practice, one can be interested in esti-
mating only a p(cid:48)-dimensional integrated parameter Ξ, where p(cid:48) ∈ {1,··· , p − 1} and Ξ
is a subset of Θ. If we deﬁne in analogy with the quantities depending on θ∗
t the p(cid:48)-
dimensional subquantities ξ∗
Vξ, the Central Limit Theorem still holds in that case under the same assumptions

t , ˆξk,n, Ξi,n,(cid:98)Ξi,n(cid:98)Ξn as well as the p(cid:48)× p(cid:48)-dimensional matrix
l(cid:0)(cid:98)Ξn − Ξ(cid:1) →(cid:16)

2N (0, 1).

(cid:90) T

(cid:17) 1

T −1

Vθ∗

s ds

0

1
2

n .

1

n

Remark 20. (estimating the asymptotic variance) If the practitioner doesn’t have a
(parametric) variance estimator at hand and that her parametric estimator can be
written as in Mykland and Zhang (2014), one can use the techniques of the cited
paper to obtain a variance estimate. Investigating if such techniques would work in

29

our setting is beyond the scope of this paper. If she has a variance estimator ˆvhn,n,

then for any i = 1,··· , Bn she can estimate the ith block variance (cid:98)Vi,n as (cid:98)Vi,n :=

ˆvhn,n(R1

i,n;··· ; Rhn

i,n; R0

i,n), and the asymptotic variance as the weighted sum

(cid:98)Vn = T −2

Bn(cid:88)

(cid:98)Vi,n∆Ti,n.

(55)

i=1

Under conditions similar to the ones in Section 4.2 and Section 6, we can obtain the

consistency of (55).
Remark 21. (adding a drift to the parameter) It is left to the econometrician to check
if θ∗
t can follow a continuous Itô-process with drift. In the examples of this paper, we
were able to add a drift following the techniques in Remark 4.

7 Examples

We have two purposes in this section. First, we want to document that assumptions of
the LPM are widely satisﬁed by models of the literature used to estimate high-frequency
quantities. In addition to models from the literature, we introduce in Section 7.4 a new
model where eﬃcient price follows a continuous local martingale and the correlation
structure between eﬃcient price, microstructure noise and arrival times is very general.
We then show that this model is contained within the LPM class.

Second, we aim to show that theoretical conditions provided in Section 6 can be
satisﬁed for speciﬁc problems. As a ﬁrst example, Potiron and Mykland (2015) provided
a bias-corrected HY estimator and used techniques similar to the ones provided in this
paper to estimate the high-frequency covariance in the HBT model. We provide insight
into their work in Section 7.2. As a second example, we introduce a time-varying
friction parameter extension of the model with uncertainty zones introduced in Robert
and Rosenbaum (2011) to estimate volatility and show that conditions of Section 6 are
easily satisﬁed in that case. This can be found in Section 7.1.2.

7.1 Volatility in the HBT model

The HBT model was introduced in Potiron and Mykland (2015) as a general multi-
dimensional endogenous model which can possibly includes microstructure noise of a

30

In this section, we consider the one-dimensional case and notation of
speciﬁc form.
pp.7-8 in Potiron and Mykland (2015) are "in force". We deﬁne the observation time
process X (t)
, the down process dt,n(s) (which takes negative values) and the up process
t
ut,n(s) (which takes positive values). We also deﬁne the tick size αn and assume that
asymptotically αn → 0. The observation times are deﬁned as τ0,n := 0 and for any
positive integer i

[τi−1,n,t] /∈(cid:2)αndt,n (t − τi−1,n) , αnut,n (t − τi−1,n)(cid:3)(cid:111)

t > τi−1,n : ∆X (t)

τi,n := inf

(cid:110)

(56)

.

We assume that we observe Zτi,n := Xτi,n + τi,n, where τi,n corresponds to the mi-
crostructure noise. We also recall the deﬁnition of the two-dimensional process Yt :=
t ), and assume that Yt follows a null-drift Itô-process with (matrix) volatility
(Xt, X (t)
t . We assume that dt,n and ut,n depend on a multidimensional parameter µt and that
σY
θ∗
t )T , µt). We aim to express the HBT model as a LPM and propose in the
t := (σY
following to have a look at µt and other LPM quantities on a couple of HBT exam-
ples. Those two examples are the Hitting Constant Boundaries model in Section 7.1.1
and the model with uncertainty zones in Section 7.1.2. Furthermore, we investigate an
associated LPE and the corresponding limit error distribution in the latter model.

t (σY

7.1.1 Hitting Constant Boundaries

τi,n := 0 and constant up and down processes(cid:0)ut,n(s), dt,n(s)(cid:1) :=(cid:0)θu, θd
(cid:1). Since Xt := X (t)
We can deﬁne in that simple case µt := (cid:0)θu, θd

In Example 1 in Potiron and Mykland (2015), we assume no noise in observations
−).
, the information
t of Xt.
contained in σY
Thus, we can deﬁne θ∗
t , θu, θd). With the technology of this paper, we can
assume that θu and θd are continuous local martingale parameters in the model where
arrival times are deﬁned recursively as τ0,n := 0 and for any positive integer i

t )T can be expressed as the one-dimensional volatility σ2

(cid:1) ∈ (R∗

+, R∗

:= (σ2

t (σY

t

t

(cid:110)

(cid:111)

τi,n := inf

t > τi−1,n : ∆X[τi−1,n,s] = αnθu,τi−1,n or ∆X[τi−1,n,s] = αnθd,τi−1,n

.

(57)

In (57), the boundaries are piece-wise constant equal to the initial parameter value. We
can write (57) as a LPM with Mi,n := Ri,n := (∆Xτi,n, ∆τi,n). In particular no unob-
served quantity Qi,n are needed. Also, the order of memory is m := 0. The random inno-
t≥τi−1,n

vation is deﬁned as the future path of the Brownian motion Ui,n :=(cid:0)∆W[τi−1,n,t]

(cid:1)

31

and since m = 0, the returns can be written as Ri,n := Fn(Ui,n,{θ∗
deﬁne

(cid:90) t

s}τi−1,n≤s≤τi,n). If we
(cid:111)

σsdus = αnθd,0

0 σsdus, v(cid:1). Thus, the Hitting Constant

,

0

(cid:110)
(cid:0)ut, (σ2

(cid:90) t
t , θu,t, θd,t)(cid:1) := (cid:0)(cid:82) v

t > 0 :

0

v := inf

σsdus = αnθu,0 or

we can express Fn
Boundaries model is contained within the LPM class.

7.1.2 Model with uncertainty zones

We introduce the model with uncertainty zones of Robert and Rosenbaum (2011).
There is microstructure noise in this model. Let Zτi,n,n be the last traded price. In a
frictionless market, we can assume that a trade with 1-tick increment of the price will
occur when the eﬃcient price process crosses the mid-tick value Zτi,n,n + αn
2 (and a trade
with 1-tick decrement of the price when crossing the value Zτi,n,n − αn
2 ).

In practice, the absolute value of the increment (or the decrement) of the observed
price can be bigger than the tick size αn. For that reason, the authors introduced
the discrete variables Li,n that stand for the absolute size, in tick number, of the next
price change. Thus, the next traded price which corresponds to a price change will be
Zτi+1,n = Zτi,n ± αnLi,n. They also introduced a continuous (possibly multidimensional)
time-varying parameter χt, and assume that conditional on the past, Li,n take values
on {1,··· , m} with

Pτi,n(Li,n = k) = pk(χτi,n) , k = 1,··· , m,

for some unknown positive diﬀerentiable with bounded derivative functions pk. We
assume that the time-varying parameter is a null-drift Itô-process dχt := σχ
t , where
the volatility σχ
t

is continuous.

t dW χ

Also, the frictions induce that the transactions will not occur exactly when the
eﬃcient process is equal to the mid-tick values. For this purpose, in the notation of
Robert and Rosenbaum (2012), let 0 < η < 1 be a parameter that quantiﬁes the
aversion to price change. The frictionless non-realistic case would correspond to η := 0.
Inversely, if η is closer to 1, the agents are very averse to trade.
be

If we let X (α)

t

32

the value of Xt rounded to the nearest multiple of α, the sampling times are deﬁned
recursively as τ0,n := 0 and for any positive integer i

τi,n := inf

t > τi−1,n : Xt = X (αn)
τi−1,n

or Xt = X (αn)
τi−1,n

+ αn

+ η(cid:1)

(cid:0)Li−1,n − 1
+ η(cid:1)(cid:111)

2

.

− αn

(cid:0)Li−1,n − 1

2

Correspondingly, the observed price is assumed to be equal to the rounded eﬃcient
price Zτi,n := X (αn)
τi,n .

t

:= (σ2

To express the model with uncertainty zones as a LPM, we consider when µt :=
(η, χt). Thus, we have that θ∗
t , η, χt). We are not interested in estimating
directly χt and thus we follow Remark 19 and consider the subparameter ξ∗
t = (σt, η)
to be estimated. Following the setting of this paper, we will assume that η is a time-
varying parameter ηt and we will extend the model with uncertainty zones in (58). We
call this extension the time-varying friction parameter model with uncertainty zones.
The sampling times are deﬁned recursively as τi,n := 0 and for any positive integer i

(cid:110)

(cid:110)

τi,n := inf

t > τi−1,n : Xt = X (αn)
τi−1,n

+ ητi−1,n

(cid:1)

− αn

(cid:0)Li,n − 1
(cid:1)(cid:111)

2

.

+ ητi−1,n

(cid:0)Li,n − 1

2

or Xt = X (αn)
τi−1,n

+ αn

(58)

(cid:82) T

The idea behind the time-varying friction model with uncertainty zones is similar to
(57), we hold the parameter ηt constant between two observations.

We recall that the target quantity is the integrated parameter Ξ := ((cid:82) T

t dt,
0 ηtdt). We deﬁne the unobserved returns as Qi,n := Li,n and the observed returns
as Ri,n := (∆Zτi,n, ∆τi,n). The order of memory is m := 1. The random innovation is
deﬁned as the two-dimensional path Ui,n := ((∆W[τi−1,n,t])t≥τi−1,n, (∆W (cid:48)
[τi−1,n,t])t≥τi−1,n)
where the jump size Li,n is a function of W (cid:48)
t, which is a Brownian motion independent
of the other quantities and which was introduced in p.11 of Robert and Rosenbaum
(2012). We also deﬁne

0 σ2

(cid:110)

(cid:90) t

0

w+ := inf

t > 0 :

σsdu(1)

s = −αn

(cid:0)q − 1 + 2η0

(cid:1) or

(cid:90) t

0

33

(cid:111)

σsdu(1)

s = αnq

and

(cid:110)

t > 0 :

(cid:90) t

0

w− := inf

σsdu(1)

s = −αnq or

(cid:90) t

0

(cid:0)q − 1 + 2η0

(cid:1)(cid:111)

.

σsdu(1)

s = αn

Furthermore, we deﬁne

and

m(cid:88)

k=1

k1

y :=

w := w+1{r(1)>0} + w−1{r(1)<0}

(cid:110)
φ(cid:0)u(2)

w w− 1

2(cid:1) ∈(cid:104) k−1(cid:88)

j=1

(cid:0)χw

(cid:1),

pj

k(cid:88)

j=1

(cid:1)(cid:105)(cid:111)

(cid:0)χw

pj

(59)

where φ is the cumulative function of the standard normal distribution. The right
hand-side in (59) can be found in p.11 of Robert and Rosenbaum (2012). We can
express

(cid:0)(q, r(1), r(2)), (u(1)

t

Fn

, u(2)

t ), (σ2

t , ηt, χt)(cid:1) :=(cid:0)y, αnq sign(cid:0)(cid:90) w

(cid:1), w(cid:1).

σsdu(1)
s

0

We estimate on each block the volatility and the friction parameter using respectively

the estimator(cid:100)RV αn,t and a slight modiﬁcation of ˆηαn,t (see p.8 in Robert and Rosenbaum

(2012)) deﬁned as

ˆη(m)
α,t

:=

m(cid:88)

λ(m)
α,t,ku(m)

α,t,k

(60)

(cid:17)(cid:19)(cid:33)
− 1(cid:1) + 1

,

with

λ(m)
α,t,k :=

(cid:80)m

j=1

(cid:0)N (a)

N (a)

α,t,k + N (c)

α,t,k

α,t,j + N (c)

α,t,j

k=1

(cid:1) and u(m)

α,t,k := max

(cid:32)

(cid:18)

0, min

1,

(cid:16)
k(cid:0) N (c)

α,t,k
N (a)
α,t,k

1
2

where we assume that C

that as (cid:100)RV αn,t depends on ˆη(m)

0 := ∞, and in particular uα,t,k = 1 when N (a)

α,t,k = 0. Note
αn,t, the estimation of volatility is altered too when using
α,t . We choose to work with this modiﬁed estimator for two reasons. First, the
ˆη(m)
α,t,k = 0 in p.8 of Robert and Rosenbaum (2012).
deﬁnition of ˆηα,t was unclear when N (a)
is slightly smaller with the modiﬁed estimator.
Second, the ﬁnite sample bias of ˆη(m)
α,t
Asymptotically, they are equivalent and thus all the theory provided in Robert and
Rosenbaum (2012) can be used to prove the following theorem.

34

Theorem (Time-varying friction parameter model with uncertainty zones).
Stably in law as n → ∞,

(cid:0)(cid:98)Ξn − Ξ(cid:1) →(cid:16)

α−1

n

(cid:90) T

0

(cid:17) 1

T −1

Vθ∗

s ds

2N (0, 1),

(61)

where Vθ can be straightforwardly inferred from the deﬁnition of Lemma 4.19 in p.26 of
Robert and Rosenbaum (2012).

The proof, checking that Condition (E0) - Condition (E6) are satisﬁed, can be found

in Appendix 10.6.
Remark 22. We can add a drift to θ∗
Remark 23. Note that, equivalently, the convergence rate in (61) is the usual n 1
2 when
n corresponds to the expected number of observations. One can consult Remark 4 in
Potiron and Mykland (2015) for more details.

t following the techniques in Remark 4.

7.2 High-frequency covariance with asynchronous observations

in the HBT model

We generalize the deﬁnition of the HBT model in the two-dimensional case following
Section 2 of Potiron and Mykland (2015). We also recall the deﬁnition of the four-
) and assume that Yt follows a null-
dimensional process Yt := (X (1)
drift Itô-process with volatility σY
t,n and u(k)
depend on a multidimensional parameter µt such that θ∗
t )T , µt). The arrival
times of the kth asset are deﬁned as τ (k)

, X (2)
t . Finally, for k = 1, 2 we assume that d(k)

t := (σY

, X (t,1)

, X (t,2)

t (σY

t,n

t

t

t

t

/∈(cid:2)αnd(k)

i,n := 0 and for any positive integer i
t − τ (k)
i−1,n

t − τ (k)
i−1,n

, αnu(k)
t,n

t,n

(cid:16)

(cid:17)

(cid:16)

(cid:17)(cid:3)(cid:111)

. (62)

τ (k)
i,n := inf

t > τ (k)

i−1,n : ∆X (t)
[τ (k)

i−1,n,t]

(cid:110)

t (σY

We are concerned with the estimation of the high-frequency covariance and thus ξ∗
t :=
t )T )1,2. We are exactly in the setting of Remark 19 with p(cid:48) = 1. We choose
(σY
to work with the bias-corrected HY introduced in Section 4.2 of Potiron and Mykland
(2015).

We ﬁrst show that the two-dimensional HBT model is contained within the LPM
class. For that purpose, we identify the local Markov chain quantities used in the proof

35

t,n don’t depend on n in
of the cited work. Note that the authors assume that d(k)
their asymptotic, but under adequate assumptions17 which allow such dependence, the
limit theory of their work still holds. Following the notation, we deﬁne the non-observed
part as equal to

t,n and u(k)

(cid:1)

Qi,n :=(cid:0)∆X (2)

[τ 1C,−
i−1,n,τ 1C

i−1,n]

, ∆X (t,2)
[τ 1C,−
i,n ,τ 1C
i,n ]

and the observed-part as equal to
i−1,n − τ 1C

Ri,n :=(cid:0)τ 1C,+

i−1,n, τ 1C

i,n − τ 1C,−

i,n

, ∆X (1)
τ 1C
i,n

, ∆X (2)

τ 1C,−,+
i−1,n

, ∆τ 1C
i,n

(cid:1).

We have that m = 1. We don’t get more into details and choose not to express the
expression of the functions Fn to be used.

We now point to the parts of the proof in Potiron and Mykland (2015) that can be
used to verify the conditions in Section 6. Condition (E0) is straightforwardly satisﬁed
by the assumptions of their work. Condition (E1) is satisﬁed by Lemma 7 in their work
and Condition (E2) can be proven using the proof of Lemma 11. In Condition (E3),
Equations (45) and (47) can be satisﬁed using the same techniques than in the ﬁrst
three steps in the proof of Lemma 14. Equation (46) is straightforward to show. We
obtain Condition (E4) with l = 1
2 ). Proof techniques of the ﬁrst
three steps in the proof of Lemma 14 can be used to prove (50) and (51) in Condition
(E5). In Condition (E6), Equations (52) and (53) can be satisﬁed using a similar proof
to the proof of Lemma 13.

2 and hn = o(n 1

2, l(cid:48) = 1

We could add more general noise in the model extending the one-dimensional model
introduced in Section 7.4. We conjecture that a local parametric (bias-corrected) MLE
would satisfy the conditions of Section 6, and it would then be interesting to compare it
to the pre-averaged Hayashi-Yoshida estimator of Christensen et al. (2010), Christensen
et al. (2013) and Koike (2014), two scales covariance estimator in Zhang (2011), the
multivariate realised kernel in Barndorﬀ-Nielsen et al. (2011) and the high-frequency
covariance estimator of Aït-Sahalia et al. (2010).

17Investigating such assumptions is beyond the scope of this paper.

36

7.3 Volatility in an asset price with non auto-correlated noise

not correlated with the eﬃcient price

We assume that the observations occur at regular times τi,n = n−1T . We consider the
noised-return model

Ri,n := ∆Xτi,n + τi,n − τi−1,n,

(63)

1
2

where the noise t := n− 1
2 v

and independent of the eﬃcient process Xt := (cid:82) t
0 vtdt(cid:1). First, note that the model (63)
interested in the estimation of Θ :=(cid:0)(cid:82) T
t dt,(cid:82) T

t γt is time-varying, γt are IID standard normally distributed
0 σsdWs. The parameter process is
t , vt). We are

deﬁned as the two-dimensional volatility and noise process θ∗

0 σ2

:= (σ2

t

can be easily written as a LPM of order m = 1 with

Qi,n

Ri,n

Ui,n

:= τi,n,
:= ∆Xτi,n + τi,n − τi−1,n,
:= ({∆W[τi−1,n,s]}τi−1,n≤s≤τi,n, γτi,n).

Note that ∆τi,n are not included in the deﬁnition of Ri,n because observations are
x − x2.
regular. Deﬁne G : R−
If we assume that the
parameter is constant equal to (σ2, v), we can rewrite (63) as

∗ → R such that G(x) = − 1

where β := G−1(cid:0) σ2T

Ri,n := ηi,n + βηi−1,n,

v + 2(cid:1) and ηi,n are IID normal with variance un := − v

nβ and thus
the returns follow locally a MA(1) process. Xiu (2010) showed that we can still use
the MLE of MA(1) when volatility is time-varying pretending that it is constant on
the whole dataset. He showed the consistency and the associated limit distribution of
the QMLE in a slightly diﬀerent asymptotic setting than in this example (with the
noise component not shrinking to 0 asymptotically). Nonetheless, the author assumed
non time-varying noise. The techniques of the current paper allows us to go one step
further by allowing time-varying noise. We deﬁne the parametric estimator ˆθk,n as
the bias-corrected MLE of the MA(1) process. We conjecture that we can verify the
assumptions of Section 6 in this model with the local MLE.

37

7.4 Volatility in an extended noisy HBT model where noise can

be auto-correlated and correlated with the eﬃcient price

We go one step further the HBT model by allowing general microstructure noise in
the model as well. We keep the structure generating the sampling times (62), but we
observe now noisy returns

Ri,n := (∆Xτi,n + τi,n − τi−1,n, ∆τi,n).

(64)
We also deﬁne the unobserved returns Qi,n := (∆Xτi,n, τi,n) and we assume that there
exists θ∗
t and Ui,n such that (27) is satisﬁed for an order of memory m. Note that the
assumption (27) together with the assumption (64) allow for a very general model. In
particular, the noise and the eﬃcient price can be correlated with each other with a
more general form than in Kalnina and Linton (2008) and the noise auto-correlated.
Also, the sampling times can be correlated with the eﬃcient price, the volatility, the
microstructure noise and any other quantities of interest in the model. In the simplest
(non realistic) case, we can imagine that the noise follows the same assumption as in
Section 7.3. Because observations occur on the tick grid, a realistic model assumes
that the observed price Zτi,n := Xτi,n + τi,n takes only modulo of the tick size values.
One possible extension of the model introduced in Section 7.3 assumes that the price
is rounded, i.e. Zτi,n := (Xτi,n + τi,n)(αn). It can be expressed as a LPM of order m = 1
with

Qi,n

Ri,n

Ui,n

:= (τi,n, Xτi,n),
:= ∆Xτi,n + τi,n − τi−1,n,
:= ({∆W[τi−1,n,s]}τi−1,n≤s≤τi,n, γτi,n).

2 and ceiling rounding with probability 1

Furthermore, we can show that one other simple model, the ﬂoor rounding with
2 of the eﬃcient price model, which
probability 1
is decribed in p.7 of Dahlaus and Neddermeyer (2014), is contained within the LPM
class. We insist on the fact that those are basic examples and that the LPM class is
much broader.

We conjecture here again that a local MLE would satisfy the conditions of Section 6,
and that we could then infer in particular about the integrated volatalitity, observation
times parameter and integrated microstructure noise.

38

7.5 High Frequency Regression and ANOVA

We are interested in systems of the form dVt = βtdXt + dZt, where the high-frequency
correlation between Xt and Zt is null, i.e. (cid:104)X, Z(cid:105)t = 0, and we can observe the two
processes Vt and Xt. Moreover, we assume that Xt can be multidimensional. We can
see βt as the beta from portfolio optimization and Zt the idiosyncratic noise, or βt can
be the hedging delta of an option, with Zt the error. There are two diﬀerent objects of
interest. First, the regression problem seeks to infer about the integrated beta (Mykland
and Zhang (2009, Section 4.2, pp. 1424-1426), Kalnina (2012), Zhang (2012, Section
4, pp. 268-273), Reiss, Todorov, and Tauchen (2014)). The ANOVA problem seeks to
s )2ds (Zhang (2001) and Mykland and Zhang (2006)). We
deﬁne Yt := (Vt, Xt) and assume that Yt is a null-drift Itô-process with volatility σY
t .
We can deﬁne the multidimensional parameter θ∗
t )2). We are interested
in the estimation of the integrated sub-parameter ξ∗
t )2).

estimate (cid:104)Z, Z(cid:105)T := (cid:82) T

0 (σZ

t := (βt, σY

t , (σZ
t := (βt, (σZ

In the case where there is no microstructure noise in observations and the observa-
tions occur at regular times, it is easy to show that the LPM class contains the model
and that the estimator to be used locally is the usual least squares estimator, together
with the residual variance estimator. Furthermore, the assumptions of Section 6 are
easily satisﬁed. In the more general case where there can be microstructure noise, we
can use a model similar to Section 7.4. We conjecture in this case again that a local
MLE (or possibly another estimator) would satisfy the conditions of Section 6.

7.6 Limit Order Book (LOB)
A LOB collects for any t ≥ 0 the total volume of non-executed orders for any price level
and any type. We can model a LOB as a multidimensional point process, where each
component counts the number of orders of a given type and a given price level. Very
often it is assumed in the literature that the point process is a function of a non time-
varying parameter θ∗ as in Ogihara and Yoshida (2011). This constancy assumption
is seldom checked properly. Using the techniques of this paper, The LOB user could
allow for a time-varying parameter. First, she would need to investigate if the LPM class
contains her parametric model, build a time-varying parametric model and then check
the conditions of Section 6 to use a LPE. We saw in Example 2 that a 1-dimensional

39

Poisson-process is a LPM. Furthermore, we conjecture that we can build a time-varying
parameter extension of the Hawkes process introduced in Hawkes (1971) and used in,
for example, Bacry et al.
(2015), which is contained
within the LPM class. Moreover, we conjecture that the LPE of the QMLE in Clinet
and Yoshida (2015) would satisfy the conditions of Section 6.

(2013) and Aït-Sahalia et al.

7.7 Leverage eﬀect

The leverage eﬀect describes the (usually) negative relation between stock returns and
their volatility (see e.g. Wang and Mykland (2014), Aït-Sahalia et al. (2014)). In that
t := d(cid:104)X, F (σ)(cid:105)t/dt where conditions
case, the parameter of interest can be deﬁned as ξ∗
on the nonrandom function F can be found in p.199 of Wang and Mykland (2014).
4 if there is no microstructure noise. In light of
Note that the convergence rate is l = 1
Condition (E4), this example would provide a new estimator with a convergence rate
not as good as the parametric estimator. If we assume that the model is the same as in
Section 7.4, a LPE could work but a parametric estimator would ﬁrst need to be given.

7.8 Volatility of volatility

One would have to investigate ﬁrst a parametric estimator in this problem too. The
:= d(cid:104)σ2, σ2(cid:105)t/dt. The convergence rate is also
parameter of interest is deﬁned as ξ∗
4. We can ﬁnd results on this inference problem in Vetter (2011) and Mykland,
l = 1
Shephard and Sheppard (2012).

t

8 Empirical work

In this section, we are interested in estimating the integrated parameter in the time-
varying friction parameter model with uncertainty zones introduced in Section 7.1.2.
We remind the reader that the parameter of interest is deﬁned as ξ∗
t , ηt). We
are looking at Orange France Telecom stock price on the CAC 40 on Monday March
4th, 2013. The number of returns between 9am and 4pm corresponding to a "change
of price" is equal to Nn = 3306, and the tick size αn = 0.001 euro. We assume that
T := 1, consider that t = 0 corresponds to 9am and that t = T corresponds to 4pm.

t = (σ2

40

When assuming the non time-varying model with friction parameter equal to η,
we can estimate the friction parameter with ˆη(m)
αn,T . We deﬁne the standard deviation
sn(η) and the standard deviation estimate ˆsn(η), where the deﬁnition can be found
in Appendix 10.7. We estimate the standard deviation as ˆsn := ˆsn(ˆη(m)
α,T ). We ﬁnd
empirically ˆη(m)
αn,T is biased
αn,T = 0.155 and ˆsn = 0.008. Note that in ﬁnite sample, ˆη(m)
and that this bias can be estimated following the estimate ˆB introduced in Appendix
10.7. Because we choose hn big enough in this section, the bias is very small and will
not alter the values of the estimators and the results of the tests in the following.

i,n, ˆηi,n) the estimate of ξ∗

t on the ith block. We also deﬁne the
standard deviation estimate of ˆηi,n as ˆsi,hn := si,hn(ˆηi,n). Note that ˆsi,hn is not block-
dependent except for the last block, which is removed from the analysis in the following
because the number of observations can be too small in that block. We introduce the
notation ˆshn := ˆs1,hn. Figure 1 shows the evolution over time of ˆηi,n for diﬀerent values
of hn. Based on those estimates and the standard deviation estimate ˆshn, we compute
the associated chi-square statistic

We deﬁne (cid:98)Ξi,n := (ˆσ2

Bn−1(cid:88)

(cid:16) ˆηi,n − ˆη(m)

αn,T

i=1

ˆshn

(cid:17)2

.

χ2

n :=

We now compute(cid:98)Ξn := (ˆσ2

n follows approx-
Under the null hypothesis which states that ηt is non time-varying, χ2
imately a chi-square distribution with Bn − 1 degrees of freedom. We report χ2
n for
diﬀerent values of hn in Table 1. The obtained values indicate that we have strong
evidence against the null hypothesis, thus it provides us very good reasons to use the
techniques of this paper. Note that this analysis has been carried out on other days
and other stocks. Our conclusion is that in almost every case, the friction parameter is
time-varying.

n, ˆηn) for diﬀerent values of hn following the time-varying
n ≈ 57.5
friction parameter model with uncertainty zones. In view of (49), because N
we choose to work with hn = 43,··· , 63. We can see in Figure 2 that we obtain diﬀerent
estimates of volatility using the techniques of this work compared to the estimates of
the model with uncertainty zones, which is one reason why it is crucial to use a proper
time-varying model for ηt. The estimates of the model with uncertainty zones seems to
underestimate the integrated volatility. In addition, the RV estimator, which doesn’t

1
2

41

take account of the microstructure noise, seems to be overestimating the integrated
volatility. This is what to be expected in theory and thus indicates that the correction
made by ˆσn is reasonable. Finally, the estimates are very similar for diﬀerent values of
hn, which seems to indicate that the method is robust to small block size variation.

9 Conclusion

We have introduced in this paper a general class of time-varying parameter models
called LPM. In particular, if the asset price is assumed to follow a noisy continuous
eﬃcient price, the LPM allows for auto-correlated time-varying noise and correlation
between the eﬃcient process, the microstructure noise and the sampling times. If the
econometrician has a speciﬁc LPM and a parametric estimator at hand, we provided
an estimator of the integrated parameter. We also gave conditions under which the
econometrician can ﬁnd the limit distribution.

Depending on the problem, verifying those conditions is not necessarily straightfor-
ward. Nonetheless, this paper simpliﬁes consequently the work of the econometrician
because she can solve a nonparametric problem using only a parametric estimator. As
a matter of example, we showed that we were able to estimate the integrated volatility
when assuming a time-varying friction parameter model with uncertainty zones.

In the future, we would like to verify the conditions of Section 6 with the model
introduced in Section 7.4. Moreover, even though most examples of this paper are
coming from the eﬃcient price-process point-of-view, the LPM class is also conjectured
to contain numerous point process models used to model the LOB, such as Hawkes
processes. Finally, we would like to allow the parameter process to follow a general
semi-martingale with jumps.

This paper was focused on the estimation of the integrated parameter of the LPM.
Condition (E6) states that the normalized discrepancy between the estimator on the
observed returns and the approximated returns with the same starting value vanishes
asymptotically. Roughly speaking, it means that we can see the LPM as a block-
constant parameter model. Thus, we conjecture that parametric tests can also be

42

used. As an example, the log-ratio statistic could test for nested models and provide
us evidence on the structure driving the returns. This would most likely enable us to
investigate the question of presence of noise in, say, 5-minute returns, the question of
correlation between eﬃcient price and noise, the asymmetric information problem using
the extension of the model of uncertainty zones in Section 3.2 of Potiron and Mykland
(2015), the presence of endogeneity etc.

One other possible application of the fact that the LPM can be seen as a block-
constant parameter model is in model selection. Given data and a set of candidate
LPM, on the one hand we could sum up their block-local maximum likelihood functions.
Because of the Markov property of the LPM, we would obtain an estimate of their
maximum likelihood function on the whole interval [0, T ]. On the other hand, we
could build a measure of the integrated volatility of the parameter (cid:104)θ∗, θ∗(cid:105)T , based on
techniques used in Mykland and Zhang (2014). Then, we could generalize the Akaike
Information Criterion (AIC) when parameters are time-varying and LPM could be
compared on the basis of their maximum likelihood function and a penalization which
would include the number of parameters and the volatility of the parameter.

Finally, we also believe that the ideas of this paper can be useful to forecasting at
time T . The question of estimating the parameter of a time series, or more generally
any parametric model which admits a LPM time-varying extension, in order to "plug-
in" the value into the forecast model could be changed to the problem of estimating the
spot parameter θ∗
T and plug this value into the forecast model. One idea could be to
use a weighted sum of ˆΘn with increasing weights so that the information contained in
the most recent observations will be used more that the information contained in older
observations.

10 Appendix

10.1 Preliminaries
Since | θ∗
t )+ is locally bounded away from 0, we can follow
standard localisation arguments (see, e.g., pp. 160− 161 of Mykland and Zhang (2012))

t | is locally bounded and (θ∗

43

t ∈ KM for all
and assume without loss of generality that there exists M > 0 such that θ∗
0 ≤ t ≤ T . Furthermore, because we assume that the volatility of the parameter σθ
t is
locally bounded, we can use the same techniques and assume without loss of generality
that there exists σ+ > 0 such that σθ

t ≤ σ+ for all 0 ≤ t ≤ T .

Finally, we ﬁx some notation. In the following of this paper, we will be using C for

any constant C > 0, where the value can change from one line to the next.

10.2 Proof of Theorem (consistency)
Proof (C1) ⇒(23)
It suﬃces to show that (C1) implies that

By (12) and (22), we can build gn such that we can write
i,n,··· , U hn

i,n , ˜Θi,n),

where gn is a jointly measurable real-valued function such that

We have that

E(cid:104)

gn(U 1

i,n,··· , U hn

i,n , ˜Θi,n)

= op(1).

(65)

(cid:12)(cid:12)(cid:105)

sup
i≥0

E(cid:104)(cid:12)(cid:12)(cid:98)˜Θi,n − ˜Θi,n
(cid:12)(cid:12) = gn(U 1

(cid:12)(cid:12)(cid:98)˜Θi,n − ˜Θi,n
E(cid:12)(cid:12)gn(U 1
i,n,··· , U hn
(cid:105)

i,n , ˜Θi,n)(cid:12)(cid:12) < ∞.
= E(cid:104)E(cid:104)
(cid:20)(cid:90)

gn(U 1

= E

i,n,··· , U hn

gn(u, ˜Θi,n)µω(du)

(cid:105)(cid:105)

i,n , ˜Θi,n)(cid:12)(cid:12) ˜Θi,n
(cid:21)

where µω(du) is a regular conditional distribution for (U 1
e.g., Breiman (1992)). From Condition (C1), we obtain (65).

i,n,··· , U hn

i,n ) given ˜Θi,n (see,

Proof (C2) ⇒(24)
It is suﬃcient to show that (C2) implies that

E(cid:104)(cid:12)(cid:12) ˆΘi,n − ˆ˜Θi,n

(cid:12)(cid:12)(cid:105)

= op(1).

(66)

sup
i≥0

44

By (11), (12), (21) and (22), we can build g(2)
n
i,n,··· , U hn

n (U 1

(cid:12)(cid:12) ˆΘi,n − ˆ˜Θi,n
E(cid:104)| ˆΘi,n − ˆ˜Θi,n|(cid:105)

(cid:12)(cid:12) = g(2)
= E(cid:104)E(cid:104)
(cid:20)(cid:90)

We compute

g(2)
n (U 1

i,n,··· , U hn

, ˜Θi,n).

i−1,n≤s≤τ 0

such that we can write
s}τ 0
i,n ,{θ∗
(cid:21)
i,n ,{θ∗

i−1,n≤s≤τ 0

s}τ 0

i,n

i,n

(cid:105)(cid:105)

, ˜Θi,n)| ˜Θi,n

= E

n (v, ˜Θi,n)µω(dv)
g(2)

= op(1).

where µω(dv) is a regular conditional distribution for (U 1
given ˜Θi,n and where we used Condition (C2) in the last equality.

i,n,··· , U hn

i,n ,{θ∗

s}τ 0

i−1,n≤s≤τ 0

i,n

)

10.3 Proof of Consistency in Example 1

Let’s show Condition (C1) ﬁrst. For any M > 0, the quantity

(cid:12)(cid:12)(cid:12)ˆθhn,n

(cid:0)Fn(V1,n, θ);··· ; Fn(Vhn,n, θ)(cid:1) − θ
(cid:12)(cid:12)(cid:12) hn(cid:88)

(∆V[0;τn],j,n)2T −1 − 1

(cid:12)(cid:12)(cid:12).

(cid:12)(cid:12)(cid:12)

(67)

C

j=1

can be uniformly in {θ ∈ KM} bounded by

We can prove that (67) tends to 0 in probability as a straightforward consequence of
Theorem I.4.47 of p.52 in Jacod and Shiryaev (2003).

To show Condition (C2), let M > 0.

It is suﬃcient to show that the following

quantity

nh−1

n

(cid:34)(cid:12)(cid:12)(cid:12)(cid:0)θ0∆V[0;τn],j,n

(cid:1)2 −(cid:0)(cid:90) τ j

1,n

τ j−1

1,n

hn(cid:88)

j=1

E

θsdVs−τ j−1

1,n ,j,n

(68)

goes to 0 uniformly in {(θt, Vn) ∈ EM,n}. Using Conditional Burkholder-Davis-Gundy
inequality (BDG, see inequality (2.1.32) of p. 39 in Jacod and Protter (2012)), (68)
can be bounded uniformly by

θsdVs−τ j−1

1,n ,j,n

.

(69)

(cid:1)2(cid:12)(cid:12)(cid:12)(cid:35)

(cid:12)(cid:12)(cid:12)(cid:35)

(cid:34)(cid:12)(cid:12)(cid:12)θ0∆V[0;τn],j,n −

(cid:90) τ j

1,n

τ j−1

1,n

hn(cid:88)

j=1

E

Ch−1

n

45

We can also bound uniformly (69) by

hn(cid:88)

j=1

(cid:124)

(cid:123)(cid:122)

(∆τ j
1,n)1/2
O(n−1/2)

Ch−1

n

(cid:12)(cid:12)(cid:12)

E

(cid:124)

(cid:125)

|θ0 − θs|(cid:12)(cid:12)(cid:12)

sup
s∈[τ j−1
1,n ,τ j

(cid:123)(cid:122)

1,n]

op(n−1/2)


(cid:125)

where we used BDG another time to obtain op(n−1/2).

10.4 Proof of Consistency in Example 2

Condition (C1) can be shown easily. Similarly, Condition (C2) is a direct consequence
of the deﬁnition in (13), (14) together with (16).

10.5 Proof of Theorem (Central Limit Theorem)

We show (35)

We aim to show that

Ei,n :=

(70)

Note that ETi−1,n
limit of n 2

(cid:2)ei,n
l(cid:80)Bn
Bn(cid:88)

i=1

2
l

n

i=1

ei,n

(cid:3) = 0 and thus that Ei,n is a discrete martingale. We compute the
(cid:2)e2
(cid:2)e2

)du(cid:1)2(cid:105)

i,n

2
l

ETi−1,n

ETi−1,n

i,n

Ti−1,n

i=1

1

n

P→ 0.

(cid:1)∆Ti,n
(cid:125)

l(cid:0) ˜Θi,n − Θi,n
(cid:123)(cid:122)

Bn(cid:88)
(cid:124)
(cid:3). We have
(cid:104)(cid:0)(cid:90) Ti,n
Bn(cid:88)
(cid:3) = n
u − θ∗
(θ∗
Bn(cid:88)
(cid:2)(∆Ti,n)4(cid:3)(cid:1) 1
(cid:0)ETi−1,n
(cid:123)(cid:122)
(cid:124)
(cid:125)
(cid:16)ETi−1,n
(cid:2)
nn−2)
(cid:123)(cid:122)
(cid:124)
s − θ∗
(θ∗

Ti−1,n≤s≤Ti,n

≤ Cn

ETi−1,n

Ti−1,n

sup

Op(h2

i=1

i=1

2
l

2

Op(hnn−1)

)4(cid:3)(cid:17) 1
(cid:125)

2

Ti−1,n

= op(1),

46

where we used Conditional Cauchy-Schwarz in the inequality, (40) of Condition (E1)
together with BDG inequality to obtain the big taus, and (48) in the last equality.
Because we showed that n 2

(cid:3) tends to 0 in probability, we obtain (70).

l(cid:80)Bn

(cid:2)e2

ETi−1,n

i,n

i=1

n

i,n − ˜Θi,n

l(cid:0) ˆ˜ΘM∗

(cid:1)∆TM∗

We show (37)
Without loss of generality, we can assume that the prameter θ∗
is a 1-dimensional
process. Because for example the parametric estimator can be biased, in all generality,
is not the increment term of a discrete martingale.
Ai,n := n 1
Thus, we need ﬁrst to compensate it in order to apply usual discrete martingale limit
theorems. Let Bi,n := Ai,n − ETi−1,n [Ai,n]. We want to use Corollary 3.1 of pp. 58 − 59
in Hall and Heyde (1980). First, note that by Condition (E0), condition (3.21) in p.58
of Hall and Heyde (1980) is satisﬁed. We turn now to the two other conditions of the
corollary in the two following steps.

n, ˜Θi,n

i,n

t

First condition : We will show in this step that for all  > 0,

(cid:2)B2
i,n1{Bi,n>}(cid:3) P→ 0.

ETi−1,n

Bn(cid:88)

i=1

(71)

(72)

The conditional Cauchy-Schwarz inequality gives us that each term of the sum in (71)
can be bounded by

(cid:16)ETi−1,n

(cid:2)B4

i,n

(cid:3)ETi−1,n

(cid:2)1{Bi,n>}(cid:3)(cid:17) 1

2 .

To show that the right term of the sum in the right-hand side of (72) vanishes uniformly,
we use regular conditional distribution together with (40), (45) and (48). We apply
regular conditional distribution together with (46) on the left term of the sum in the
right-hand side of (72). Then, we use the block assumption (49) when taking the sum
of all the terms in the right-hand side of (72) and we can prove (71).

Second condition : We will prove that

Bn(cid:88)

ETi−1,n

(cid:2)B2

i,n

(cid:3) P→ T

(cid:90) T

0

Vθ∗

s ds.

(73)

i=1

47

By regular conditional distribution and (45), we have that

Bn(cid:88)

(cid:2)B2

i,n

(cid:3) = h

ETi−1,n

Bn(cid:88)

1− 2
l(cid:48)
n n

2

l −1T

ETi−1,n

(cid:2)Vθ∗

Ti−1,n

(cid:3) + op(1).

∆TM∗

i,n

n, ˜Θi,n

i=1

i=1

In view of (42), the conditional Cauchy-Schwarz inequality and the boundedness of Vθ,
we get

1− 2
l(cid:48)
h
n n

2

l −1

ETi−1,n

Vθ∗

Ti−1,n

∆TM∗

i,n

n, ˜Θi,n

1− 2
l(cid:48)
n n

= h

2

l −1

ETi−1,n

Vθ∗

Ti−1,n

∆Ti,n

+op(1).

(cid:104)

Bn(cid:88)

i=1

(cid:105)

Using Lemma 2.2.11 of Jacod and Protter (2012) together with conditional Cauchy-
Schwarz inequality, (40) and the boundedness of Vθ, we obtain

1− 2
l(cid:48)
h
n n

2

l −1T

ETi−1,n

Vθ∗

Ti−1,n

∆Ti,n

1− 2
l(cid:48)
n n

= h

2

l −1T

Vθ∗

Ti−1,n

∆Ti,n + op(1).

We can apply now Proposition I.4.44 (p. 51) in Jacod and Shiryaev (2003) and (49)
and we get

Bn(cid:88)

i=1

1− 2
l(cid:48)
h
n n

2

l −1T

Vθ∗

Ti−1,n

∆Ti,n

P→ T

Vθ∗

s ds.

(cid:104)

Bn(cid:88)

i=1

(cid:104)

Bn(cid:88)

i=1

(cid:105)

(cid:105)

Bn(cid:88)

i=1

(cid:90) T

0

We are interested in the stable convergence of the sum of Ai,n terms, but by using
Corollary 3.1 of pp. 58 − 59 in Hall and Heyde (1980), we only obtain the stable
convergence of the increment martingale terms Bi,n. We will show now that the sum of

(cid:3) tends to 0 in probability. An application

the conditional means Sn :=(cid:80)Bn

(cid:2)Ai,n

ETi−1,n

of (47) together with regular conditional distribution will give us the convergence to 0
of Sn.

i=1

We show (36)

We want to prove

Bn(cid:88)

i=1

1
l

n

˜Θi,n

(cid:0)∆TM∗

i,n

n, ˜Θi,n

(cid:1)

− ∆Ti,n

P→ 0.

(74)

48

We deﬁne the conditional expectation of the terms in the sum of (74)

(cid:104) ˜Θi,n

(cid:0)∆TM∗

i,n

Ci,n := ETi−1,n

n, ˜Θi,n

− ∆Ti,n

(cid:1)(cid:105)

.

In analogy with the previous part, we can rewrite the term on the left-hand side of (74)
as

l(cid:0) Bn(cid:88)

1

i=1

n

(cid:124)

˜Θi,n

(cid:0)∆TM∗

i,n

n, ˜Θi,n

− ∆Ti,n

(cid:123)(cid:122)

Di,n

(cid:1) − Ci,n
(cid:125)

Bn(cid:88)

i=1

+

Ci,n

(cid:1).

Note that(cid:80)k

i=1 Di,n is a discrete martingale, and thus to show that it vanishes asymp-

Bn(cid:88)

totically, it is suﬃcient to show

(cid:3) P→ 0.
distribution together with (41) enables us to deduce(cid:80)Bn

(cid:2)D2

ETi−1,n

i=1

n

i,n

2
l

Regular conditional distribution and (42) implies (75). Similarly, regular conditional
P→ 0. Thus, we proved

(75)

i=1 Ci,n

(74).

We show (38) and (39)

The proof is very similar to the previous part, using respectively Condition (E5) and
Condition (E6) instead of Condition (E2).

10.6 Proof of Theorem (Time-varying friction parameter model

with uncertainty zones)

We verify Condition (E0) - Condition (E6) introduced in Section 6. We choose M∗
(1, 1, 1).

n =

Condition (E0) : The continuous information can be deﬁned in this problem such

that Xt, θ∗

t , σθ

t , Wt, W (cid:48)

t are adapted to J (c)

t

.

Condition (E1) : This follows exactly from Corollary 4.4 of p.14 in Robert and

Rosenbaum (2012).

Condition (E2) : We can decompose ∆TM,θ0

(cid:0)∆TM,θ0

i,n − ∆TN,θ0

i,n

i,n − ∆TN,θt

i,n

(cid:1) +(cid:0)∆TN,θ0

i,n − ∆TN,θt

i,n

into

(cid:1).

(76)

49

(cid:0)Li,n, sign(R(1)

We deal with the ﬁrst term in (76). We can see that under the parametric model

i,n)(cid:1) follows a discrete Markov chain on the space {1,··· , m} × {−1, 1}.

Following the same line of reasoning as in the proof of Lemma 14 in Potiron and
Mykland (2015), we can easily show that

(cid:12)(cid:12)(cid:12)E(cid:2)∆TM,θ0
Var(cid:2)∆TM,θ0

i,n − ∆TN,θ0
i,n − ∆TN,θ0

i,n

i,n

sup

(θt,V,M,N)∈EM,n×M2

m,n

sup

(θt,V,M,N)∈EM,n×M2

m,n

l ),

l ).

(cid:3)(cid:12)(cid:12)(cid:12) = op(hnn−1− 1
(cid:3) = op(hnn−1− 2
(cid:3)(cid:12)(cid:12)(cid:12) = op(hnn−1− 1
(cid:3) = op(hnn−1− 2

We turn now to the second term in (76). Using the same idea as in the proof of Lemma
11 in Potiron and Mykland (2015), we deduce

i,n − ∆TN,θt
i,n − ∆TN,θt

(cid:12)(cid:12)(cid:12)E(cid:2)∆TN,θ0
Var(cid:2)∆TM,θ0
can be written as a sum of Markov chain(cid:0)Li,n, sign(R(1)
i,n)(cid:1)

(77)

(78)

l ).

l ),

i,n

i,n

Condition (E3) : We choose l(cid:48) = 2. Let M > 0. Because in the model with

uncertainty zones ∆TM∗
with a ﬁnite fourth moment, we have uniformly in θ ∈ KM and in i = 1,··· , Bn that

n,θ

i,n

sup

(θt,V,N)∈EM,n×Mm,n

sup

(θt,V,N)∈EM,n×Mm,n

Var(cid:2)h
= Var(cid:2)h
= Var(cid:2)h

1

1

1

i,n

i,n

n,θ

n,θ

l(cid:48)
n
l(cid:48)
n
l(cid:48)
n
θ,n∆TM∗

(cid:0)ˆθhn,n(R1,M∗
(cid:0)ˆθhn,n(R1,M∗
(cid:0)ˆθhn,n(R1,M∗
θ,n := Var(cid:2)h
(cid:3)T −1h−1

S(1)

n,θ

n,θ

l(cid:48)
n

i,n

1

with

θ,n := E(cid:2)∆TM∗

i,n

n) − θ(cid:1)∆TM∗
(cid:3)
n) − θ(cid:1)(cid:3)(cid:0)E(cid:2)∆TM∗
n) − θ(cid:1)(cid:3)E(cid:2)∆TM∗

n,θ

i,n

i,n

i,n

n,θ

; R∗
; R∗
; R∗

n,θ

n,θ

i,n

;··· ; Rhn,M∗
;··· ; Rhn,M∗
;··· ; Rhn,M∗

i,n

i,n

n,θ

(cid:0)ˆθhn,n(R1,M∗

i,n

n,θ

;··· ; Rhn,M∗

n,θ

i,n

; R∗

nn−2)
i,n + op(h2

n,θ

nn−2)

n,θ

(cid:3))2 + op(h2
(cid:3)∆TM∗
n) − θ(cid:1)(cid:3)

= S(1)

θ,nS(2)

i,n T hnn−1 + op(h2

n,θ

nn−2).

and S(2)
n n. By Lemma 4.19 in p.26 of Robert and Rosenbaum
(2012) in the special case where the volatility is constant, we obtain the existence and
the value of S(1)
. Also, by Corollary 4.4 in p.14 of Robert and
Rosenbaum (2012), there exists S(2)
,
θ S(2)
(45) is satisﬁed. Moreover, (46) and (47) can be veriﬁed easily.

. If we deﬁne Vθ = S(1)

θ
such that S(2)

θ,n → S(1)

θ,n → S(2)

such that S(1)

θ

θ

θ

θ

Condition (E4) : We choose l = 2, l(cid:48) = 2 and hn which satisﬁes (48).

50

Condition (E5) : This can be proven the same way as the ﬁrst term in (76).
Condition (E6) : We can prove it using (77), (78) and similar arguments to the

proof of Lemma 13 in Potiron and Mykland (2015).

10.7 Estimation of the friction parameter bias and standard

deviation in the model with uncertainty zones

The notation of Section 7.1.2 and Section 8 are in force. We deﬁne ˆsn(η) := ˆV , where
an expression of ˆV will be provided at the end of this section. First, we assume that
the absolute jump size is constant equal to the tick size, i.e. Li,n := 1. In view of (60),
we have

(cid:16)

(cid:17)

.

N (c)
α,t,1
2N (a)
α,t,1

ˆη(m)
α,t

:= min

1,

We also have by deﬁnition that the number of alternations is N (a)
we assume that Nn is non-random, then

α,t,1 = Nn − N (c)

α,t,1. If

α,t,1 ∼ Bin(Nn,
N (c)

2η

2η + 1

),

(79)

where Bin(n, p) is a binomial distribution with n observations and probability p. Let
B ∼ Bin(Nn,

2η+1). We can deﬁne the bias

2η

(cid:20)

(cid:16)

min

(cid:20)

(cid:16)

B

1,

2(Nn − B)

− η

(cid:17)(cid:21)
(cid:17)(cid:21)

.

B := E

and the variance as

V := Var

min

1,

B

2(Nn − B)

B and V can be computed easily numerically.

If Nn is random, we can work conditional on Nn. As the sampling times are en-
α,t,1 by

dogenous, (79) is not true in that case. Nonetheless, we can still approximate N (c)
Bin(Nn,

2η+1) if the number of observations is large enough.

2η

We now turn out to the general case, where Li,n can be diﬀerent from 1. For
and we let Bk be an independent sequence of

k = 1,··· , m we deﬁne pk := 2η+k−1

2η+k

51

(cid:16)

1
2

N (a)

.

Ck := max

0, min

1,

α,t,k + N (a)

distribution Bin(N (c)

(cid:0)k(cid:0)

α,t,k, pk), and

− 1(cid:1) + 1(cid:1)(cid:17)(cid:17)
(cid:16)
α,t can be approximated by the distribution of (cid:80)m
(cid:3) and the variance as ˆV :=
(cid:3).

Bk
α,t,k − Bk
α,t,k + N (c)

E(cid:2)Ck

The distribution of ˆη(m)

and we can estimate the bias as ˆB := (cid:80)m
(cid:80)m

α,t,i)2 Var(cid:2)Ck

i=1(λ(m)

i=1 λ(m)

α,t,kCk,

i=1 λ(m)

α,t,i

References

[1] Aït-Sahalia, Y., J. Cacho-Diaz and R.J.A. Laeven (2015). Modeling ﬁnancial con-
tagion using mutually exciting jump processes. Journal of Financial Economics
117(3), 585-606.

[2] Aït-Sahalia, Y., J. Fan, C.D. Wang and X. Yang (2014). The Estimation of con-

tinuous and discontinuous leverage eﬀect, Available at SSRN.

[3] Aït-Sahalia, Y., J. Fan and D. Xiu (2010). High-frequency covariance estimates
with noisy and asynchronous ﬁnancial data, Journal of the American Statistical
Association 105, 1504-1517.

[4] Aït-Sahalia, Y., P.A. Mykland and L. Zhang (2005). How often to sample a
continuous-time process in the presence of market microstructure noise, Review
of Financial Studies 18, 351-416.

[5] Andersen, T.G. and T. Bollerslev (1998a). Answering the Skeptics: Yes, Standard
Volatility Models do Provide Accurate Forecasts, International Economic Review,
39, 885-905.

[6] Andersen, T.G. and T. Bollerslev (1998b). Deutsche Mark-Dollar Volatility: In-
traday Activity Patterns, Macroeconomic Announcements, and Longer Run De-
pendencies, Journal of Finance, 53, 219-265.

[7] Andersen, T.G., T. Bollerslev, F.X. Diebold and P. Labys (2001). The Distri-
bution of Realized Exchange Rate Volatility Journal of the American Statistical
Association, 96, 42-55.

52

[8] Andersen, T.G., T. Bollerslev, F.X. Diebold and P. Labys (2003). Modeling and

Forecasting Realized Volatility Econometrica, 71, 579-625.

[9] Bacry, E., S. Delattre, M. Hoﬀmann, and J.-F. Muzy. Modelling microstructure
noise with mutually exciting point processes. Quantitative Finance 13(1), 65-77.

[10] Baillie, R. T. and T. Bollerslev (1992). Prediction in dynamic models with time-

dependent conditional variances. Journal of Econometrics 52(1), 91-113.

[11] Ball, C. A. and A. Roma (1994). Stochastic Volatility Option Pricing, The Journal

of Financial and Quantitative Analysis, 29, 589-607.

[12] Barndorﬀ-Nielsen, O.E. and N. Shephard (2001). Non-gaussian Ornstein-
Uhlenbeck-based models and some of their uses in ﬁnancial economics. Journal
of the Royal Statistical Society B 63, 167-241.

[13] Barndorﬀ-Nielsen, O.E. and N. Shephard (2002). Econometric analysis of realized
volatility and its use in estimating stochastic volatility models. Journal of the
Royal Statistical Society B 64, 253-280.

[14] Barndorﬀ-Nielsen, O.E. (2004). Power and Bipower Variation with Stochastic

Volatility and Jumps. Journal of Financial Econometrics 2, 1-37.

[15] Barndorﬀ-Nielsen, O.E., P.R. Hansen, A. Lunde and N. Shephard (2011). Mul-
tivariate realised kernels: consistent positive semi-deﬁnite estimators of the co-
variation of equity prices with noise and non-synchronous trading, Journal of
Econometrics 162, 149-169.

[16] Berk, R. H. (1966). Limiting Behavior of Posterior Distributions When the Model

Is Incorrect, Annals of Mathematical Statistics, 37, 51-58.

[17] Berk, R. H. (1970). Consistency a Posteriori, Annals of Mathematical Statistics,

41, 894-906.

[18] Bollerslev, T. (1986). Generalised autoregressive conditional heteroscedasticity,

Journal of Econometrics, 31, 307-327.

53

[19] Chen, R. and P.A. Mykland (2015). Discerning Non-Stationary Mar-
in High Fre-
or

at SSRN: http://ssrn.com/abstract=2699927

ket Microstructure Noise
quency Data. Available
http://dx.doi.org/10.2139/ssrn.2699927

and Time-Varying Liquidity

[20] Chen, X. and Y. Fan (2006). Estimation of copula-based semiparametric time

series models, Journal of Econometrics, 130(2), 307-335.

[21] Christensen, K., S. Kinnebrock and M. Podolskij (2010). Pre-averaging estimators
of the ex-post covariance matrix in noisy diﬀusion models with non-synchronous
data, Journal of Econometrics 159, 116-133.

[22] Christensen, K., M. Podolskij and M. Vetter (2013). On covariation estimation
for multivariate continuous Itô semimartingales with noise in non-synchronous
observation schemes, Journal of Multivariate Analysis, 120, 59-84.

[23] Clinet, S. and N. Yoshida (2015). Statistical Inference for Ergodic Point Processes

and Limit Order Book. arXiv preprint arXiv:1512.01899.

[24] Comte, F. and E. Renault (1998). Long memory in continuous-time stochastic

volatility models, Mathematical Finance 8, 291-323.

[25] Dahlhaus, R. (1997). Fitting time series models to nonstationary processes, The

Annals of Statistics 25(1), 1-37.

[26] Dahlhaus, R. (2000). A likelihood approximation for locally stationary processes,

The Annals of Statistics, 1762-1794.

[27] Dahlhaus, R. and S.S. Rao (2006). Statistical inference for time-varying ARCH

processes, The Annals of Statistics 34(3), 1075-1114.

[28] Dahlhaus, R. and J.C. Neddermeyer (2014). Online Spot Volatility-Estimation
and Decomposition with Nonlinear Market Microstructure Noise Models, Journal
of Financial Econometrics 12(1), 174-212.

[29] Engle, R.F. (1982). Autoregressive conditional heteroscedasticity with estimates

of the variance of United Kingdom inﬂation, Econometrica, 50, 987-1007.

54

[30] Engle, R.F. and V.K. Ng (1993). Measuring and Testing the Impact of News on

Volatility, Journal of Finance, 48, 1749-1778.

[31] Fan, J. and I. Gijbels (1996). Local polynomial modelling and its applications:

monographs on statistics and applied probability 66. Vol. 66. CRC Press.

[32] Fan, J., J. Jiang, C. Zhang and Z. Zhou (2003). Time-dependent diﬀusion models

for term structure dynamics. Statistica Sinica, 13(4), 965-992.

[33] Fan, J. and W. Zhang (1999). Statistical estimation in varying coeﬃcient models.

Annals of Statistics, 1491-1518.

[34] Firth, D. (1993). Bias reduction of maximum likelihood estimates. Biometrika 80

(1), 27-38.

[35] Fisher, R.A. (1922). On the Mathematical Foundations of Theoretical Statistics.
Philosophical Transactions of the Royal Society of London, Series A, 222, 309-368.

[36] Fisher, R.A. (1925). Theory of Statistical Estimation. Proceedings of the Cam-

bridge Philosophical Society, 22, 700-725.

[37] Foster, D. and D. Nelson (1996). Continuous record asymptotics for rolling sample

variance estimators, Econometrica 64, 139-174.

[38] Fukasawa, M. (2010). Realized volatility with stochastic sampling. Stochastic Pro-

cesses and Their Applications 120, 829-552.

[39] Gloter, A. and J. Jacod (2001). Diﬀusions with measurement errors. I. Local

asymptotic normality. ESAIM: Probability and Statistics 5, 225-242.

[40] Hall, P. and C.C. Heyde (1980). Martingale Limit Theory and its Application.

Academic Press, Boston.

[41] Hansen, P.R. and A. Lunde (2006). Realized Variance and Market Microstructure

Noise, Journal of Business and Economic Statistics

[42] Hastie T. and R. Tibshirani (1993). Varying-coeﬃcient models. Journal of the

Royal Statistical Society. Series B (Methodological), 757-796.

55

[43] Hawkes, A. G. (1971). Point spectra of some mutually exciting point processes.

Journal of the Royal Statistical Society. Series B (Methodological), 438-443.

[44] Hayashi, T. and N. Yoshida (2005). On covariance estimation of non-

synchronously observed diﬀusion processes. Bernoulli 11, 359-379.

[45] Hayashi, T. and N. Yoshida (2011). Nonsynchronous covariation process and limit

theorems. Stochastic Processes and Applications 121, 2416-2454.

[46] Heston, S. (1993). A Closed-Form Solution for Options with Stochastic Volatility
with Applications to Bonds and Currency Options, Review of Financial Studies,
6, 327-343.

[47] Huber, P. J. (1967). The Behavior of Maximum Likelihood Estimates Under Non-
standard Conditions. Proceedings of the Fifth Berkeley Symposiumin Mathemat-
ical Statistics and Probability. Vol. 1, No. 1, pp. 221-233.

[48] Hull, J. and A. White (1987). The Pricing of Options on Assets with Stochastic

Volatilities, Journal of Finance, 42, 281-300.

[49] Gloter, A. and Jacod, J. (2001). Diﬀusions with measurement errors. I. Local

asymptotic normality. ESAIM: Probability and Statistics, 5, 225-242.

[50] Jacod, J. and P. Protter (1998). Asymptotic error distributions for the Euler

method for stochastic diﬀerential equations. Annals of Probability 26, 267-307.

[51] Jacod, J. and P. Protter (2012). Discretization of Processes. Springer.

[52] Jacod, J. and A. Shiryaev (2003). Limit Theorems For Stochastic Processes (2nd

ed.). Berlin: Springer-Verlag.

[53] Kalnina, I. and O. Linton (2008). Estimating quadratic variation consistently in
the presence of endogenous and diurnal measurement error. Journal of Econo-
metrics 147(1), 47-59.

[54] Kalnina, I. (2012). Nonparametric tests of time variation in betas. Technical re-

port, University of Montreal, 2012.

56

[55] Kim, C. J. and Nelson, C. R. (2006). Estimation of a forward-looking mone-
tary policy rule: A time-varying parameter model using ex post data. Journal of
Monetary Economics, 53(8), 1949-1966.

[56] Koike, Y. (2014). Limit theorems for the pre-averaged Hayashi-Yoshida estimator
with random sampling. Stochastic Processes and Applications 124 (8), 2699-2753.

[57] Li, Y., P.A. Mykland, E. Renault, L. Zhang and X. Zheng (2014). Realized volatil-
ity when sampling times are possibly endogenous. Econometric Theory 30, 580-
605.

[58] McCullagh, P. and J.A. Nelder (1989). Generalized linear models. London: Chap-

man & Hall.

[59] Mykland, P.A., N. Shephard and K. Sheppard (2012). Eﬃcient and feasible infer-
ence for the components of ﬁnancial variation using blocked multipower variation.
Technical Report, University of Oxford.

[60] Mykland, P.A., and L. Zhang (2006). ANOVA for Diﬀusions and Itô Processes.

Annals of Statistics 34, 1931-1963.

[61] Mykland, P.A. and L. Zhang (2008). Inference for Volatility Type Objects and

Implications for Hedging, Statistics and its Interface 1, 255-278.

[62] Mykland, P.A. and L. Zhang (2009). Inference for Continuous Semimartingales

Observed at High Frequency. Econometrica 77, 1403-1445.

[63] Mykland, P.A. and L. Zhang (2011). The Double Gaussian Approximation for

High Frequency Data. Scandinavian Journal of Statistics 38, 215-236.

[64] Mykland, P.A. and L. Zhang (2012). The econometrics of High Frequency Data. In
M. Kessler, A. Lindner and M. Sørensen (eds.), Statistical Methods for Stochastic
Diﬀerential Equations, pp. 109-190. Chapman nad Hall/CRC Press.

[65] Mykland, P.A. and L. Zhang (2014). Assessment of Uncertainty in High Frequency

Data: The Observed Asymptotic Variance. Available at SSRN 2475620.

57

[66] Nelson, D.B. (1991). Conditional Heteroskedasticity in Asset Returns: A New

Approach, Econometrica, 59, 347-370.

[67] Ogihara, T. and N. Yoshida (2011). Quasi-likelihood analysis for the stochastic
diﬀerential equation with jumps. Statistical Inference for Stochastic Processes 14
(3), 189-229.

[68] Potiron, Y. and P.A. Mykland (2015). Estimation of integrated quadratic co-
variation between two assets with endogenous sampling times. arXiv preprint
arXiv:1507.01033.

[69] Reiss, M., V. Todorov and G. Tauchen (2014). Nonparametric test for a constant

beta over a Fixed Time Interval.

[70] Robert, C.Y. and M. Rosenbaum (2011). A new approach for the dynamics of
ultra-high-frequency data: the model with uncertainty zones. Journal of Financial
Econometrics 9, 344-366.

[71] Robert, C.Y. and M. Rosenbaum (2012). Volatility and covariation estimation
when microstructure noise and trading times are endogenous. Mathematical Fi-
nance 22 (1), 133-164.

[72] Robins, J. and A. A. Tsiatis (1992). Semiparametric estimation of an accelerated

failure time model with time-dependent covariates. Biometrika, 79(2), 311-319.

[73] Stein, E. M. and J. C. Stein (1991). Stock Price Distributions with Stochastic

Volatility: An Analytic Approach. Review of Financial Studies, 4, 727-752.

[74] Stock, J. H. and M. W. Watson (1998). Median unbiased estimation of coeﬃcient
variance in a time-varying parameter model. Journal of the American Statistical
Association, 93(441), 349-358.

[75] Vetter, M. (2011). Estimation of Integrated Volatility of Volatility with Applica-

tions to Goodness-of-ﬁt Testing. Discussion paper.

[76] Wang, C.D. and P.A. Mykland (2014). The Estimation of Leverage Eﬀect with
High Frequency Data. Journal of the American Statistical Association, 109, 197-
215.

58

[77] White, H. (1982). Maximum Likelihood Estimation of Misspeciﬁed Models.

Econometrica 50, 1-25.

[78] Xiu, D. (2010). Quasi-maximum likelihood estimation of volatility with high fre-

quency data. Journal of Econometrics 159, 235-250

[79] Zhang, L. (2001). From Martingales to ANOVA : Implied and Realized Volatility.

Ph.D. Thesis, The University of Chicago, Department of Statistics.

[80] Zhang, L. (2011). Estimation covariation: Epps eﬀect, microstructure noise. Jour-

nal of Econometrics 160, 33-47.

[81] Zhang, L. (2012). Implied and realized volatility: Empirical model selection. An-

nals of Finance, 8, 259-275.

59

Figure 1: Evolution of ˆηi,n for diﬀerent values of hn. The red line corresponds to ˆη(m)
αn,T .
The blue lines are one standard deviation ˆshn away from ˆη(m)
αn,T . The purple lines are
two standard deviations away from ˆη(m)
αn,T .

60

Figure 2: Estimated volatility ˆσn for diﬀerent values of hn. The red line corresponds to
the RV estimator. The blue line stands for the model with uncertainty zones volatility

estimator (cid:100)RV αn,T .

61

hn Bn Chi Sq. Stat Dg. Fr. p-value
50
100
150
200
250
300
350
400
450

0
0
0
0
0
0
0
0
6e−7

66
33
22
16
13
11
9
8
7

67
34
23
17
14
12
10
9
8

719
268
155
116
109
68.5
90.6
91.5
42.6

n based on the block size hn. Note that since
Table 1: Summary chi-square statistics χ2
the number of observations of the last block is arbitrary, the last block estimate ˆηBn,n
is not used to compute the chi-square statistic.

62

