6
1
0
2

 
r
a

M
8

 

 
 
]

.

M
P
n
i
f
-
q
[
 
 

1
v
4
5
3
2
0

.

3
0
6
1
:
v
i
X
r
a

Stock Selection as a Problem in Phylogenetics –

Evidence from the ASX

Hannah Cheng Juan Zhan1, William Rea1, and Alethea Rea2,

1. Department of Economics and Finance, University of Canterbury,

New Zealand

2. Data Analysis Australia, Perth, Australia

March 9, 2016

Abstract

We report the results of ﬁfteen sets of portfolio selection simulations us-
ing stocks in the ASX200 index for the period May 2000 to December 2013.
We investigated ﬁve portfolio selection methods, randomly and from within
industrial groups, and three based on neighbor-Net phylogenetic networks.
We report that using random, industrial groups, or neighbor-Net phyloge-
netic networks alone rarely produced statistically signiﬁcant reduction in
risk, though in four out of the ﬁve cases in which it did so, the portfolios
selected using the phylogenetic networks had the lowest risk. However, we
report that when using the neighbor-Net phylogenetic networks in combi-
nation with industry group selection that substantial reductions in portfolio
return spread were achieved.

Keywords: Stock selection, ASX200, neighbor-Net networks, portfolio risk

JEL Codes: G11

1

Introduction

Portfolio diversiﬁcation is critical for risk management because it aims to reduce
the variance of returns compared with a portfolio of a single stock or similarly un-
diversiﬁed portfolio. The academic literature on diversiﬁcation is vast, stretching
back at least as far as Lowenfeld (1909). The modern science of diversiﬁcation is
usually traced to Markowtiz (1952) which was expanded upon in great detail in
Markowitz (1991).

1

In one sense, the approach of Markowtiz (1952) is optimal and cannot be
improved in the case that, either the correlations and expected returns of the
assets are not time-varying (thus can be accurately estimated from historical data)
or, alternatively, they can be forecast accurately. Unfortunately, neither of these
conditions hold in real markets leaving the door open to other approaches.

The literature covers a wide range of approaches to portfolio diversiﬁcation,
such as; the number of stocks required to form a well diversiﬁed portfolio, which
has increased from eight stocks in the late 1960’s (Evans and Archer, 1968) to over
100 stocks in the late 2000’s (Domian et al., 2007), what types of risks should be
considered, (Cont, 2001; Goyal and Santa-Clara, 2003; Bali et al., 2005), factors
intrinsic to each stock (Fama and French, 1992; French and Fama, 1993), the age
of the investor, (Benzoni et al., 2007), and whether international diversiﬁcation is
beneﬁcial, (Jorion, 1985; Bai and Green, 2010), among others.

In recent years a signiﬁcant number of papers have appeared which apply graph
theoretical methods to the study of a stock or other ﬁnancial market, see, for
example, Mantegna (1999), Onnela et al. (2003a), Onnela et al. (2003b), Bonanno
et al. (2004), Miccich´e et al. (2006), Naylor et al. (2007), Kenett et al. (2010),
Djauhari (2012), and Rea and Rea (2014) among others.

On the pragmatic side, DiMiguel et al. (2009) list 15 diﬀerent methods for
forming portfolios and report results from their study which evaluated 13 of these.
Absent among these 15 methods are any which utilize the above-mentioned graph
theory approaches. This leaves an open question whether these graph theory
approaches can usefully be applied to the problem of portfolio selection.

The goal of this paper is to compare three network methods with two simple
portfolio selection methods for small private-investor sized portfolios. There are
two motivations for looking at very small portfolios sizes.

The ﬁrst is that, despite the recommendation of authorites like Domian et al.
(2007), Barber and Odean (2008) reported that in a large sample of American
private investors the average portfolio size of individual stocks was only 4.3. While
comparable data does not appear to be available for private Australian investors,
it seems unlikely that they hold substantially larger portfolios. Thus there is a
practical need to ﬁnd a way of maximising the diversiﬁcation beneﬁts for these
investors. The second is that testing the methods on small portfolios gives us
a chance to evaluate the potential beneﬁts of the network methods because the
larger the portfolio size, the more closely the portfolio resembles the whole market
and the less any potential beneﬁt is likely to be discernible.

The mean returns and variances of the individual contributing stocks are in-
suﬃcient for making an informed decision on selecting a suite of stocks because
selecting a portfolio requires an understanding of the correlations between each of
the stocks available for consideration for inclusion in the portfolio. The number

2

of correlations between stocks rises in proportion to the square of the number of
stocks, meaning that for all but the smallest of stock markets the very large num-
ber of correlations is beyond the human ability to comprehend them. Rea and
Rea (2014) presented a method to visualise the correlation matrix using nieghbor-
Net networks (Bryant and Moulton, 2004), yielding insights into the relationships
between the stocks.

Another key aspect of stock correlations is the potential change in the cor-
relations with a signiﬁcant change in market conditions (say comparing times of
general market increase with recession and post-recession periods).

In this paper we explore investment opportunities on the Australian Stock

Exchange using data from the stocks in the ASX200 index.

Our primary motivation is to investigate ﬁve portfolio selection strategies. The

ﬁve strategies are;

1. picking stocks at random;

2. forming portfolios by picking stocks from diﬀerent industry groups;

3. forming portfolios by picking stocks from diﬀerent correlation clusters;

4. forming portfolios by picking stocks from the dominant industry group within

correlation clusters;

5. forming portfolios by picking stocks from non-dominant industry groups

within correlation clusters.

Our results show that knowledge of correlation clusters together with the industry
groups within these clusters can reduce the portfolio risk.

The outline of this paper is as follows; Section (2) discusses the data and meth-
ods used in this paper, Section (3) discusses identifying the correlation clusters,
Section (4) presents the results of the simulations of the portfolio selection methods
and Section (5) contains the discussion and our conclusions.

2 Data and Methods

We used the weekly price data for the stocks in the ASX 200 as our dataset.
Weekly prices along with the dividend rate and payment date for the period 3
May 2000 to 4 December 2013 were obtained from DataStream. We appended one
or two letters to each ticker symbol in order to identify the industry group for each
stock.

Weekly returns were calculated from the price and dividend data for use in
both the portfolio formation simulations and for estimating the correlations. The

3

correlations were estimated using the function cor in base R (R Core Team, 2014)
We also calculated period returns for each stock in each of periods two to six for
use in the simulations.

We divided the whole period into six shorter periods shown in Figure (1) and
used out-of-sample testing to test the eﬀectiveness of each the ﬁve methods of
diversifying portfolios on reducing risk.

Figure 1: A plot of the ASX200 Index with the boundaries of the study periods
marked.

2.1 Neighbor-Net Splits Graphs

To be able to use clustering algorithms (neighbor-Net is a clustering algorithm,
Appendix (A) gives greater detail) we need to convert the numerical values in the
correlation matrix to a measure which can be used as a distance. In the literature

4

  01000200030004000500060007000ASX200 Index ValuesYearASX200 Index200020012002200320042005200620072008200920102011201220131223344556the most common way to do the conversion is by using the so-called ultra-metric
given by,

(cid:113)

dij =

2(1 − ρij)

(1)

where dij is the distance corresponding to the the estimated correlation, ρij, be-
tween stocks i and j, see Mantegna (1999) or Djauhari (2012) for details.

A typical stock market correlation matrix for n stocks is of full rank which
means that after converting to a distance matrix according to Equation (1), the
location of the points, here stocks, can only be fully represented in (n − 1)-
dimensional space. In visualization, the high dimensional data space is collapsed
to a suﬃciently low dimensional space that the data can be represented on 2-
dimensional surface such as a page or computer screen for viewing. Information
loss is often unavoidable in the reduction of the dimension of the data space. One
of the goals of visualization is to minimize the information loss while making the
structures within the data visible to the human eye.

Using the conversion in Equation (1) we formatted the converted correlation
matrix and augmented it with the appropriate stock codes for reading into the
neighbor-Net software, SplitsTree, available from http://www.splitstree.org
(Huson and Bryant, 2006). Using the SplitsTree software we generated the neighbor-
Nets splits graphs. Because the splits graphs are intended to be used for visualiza-
tion we defer the discussion of the identiﬁcation of correlation clusters and their
uses to Section (3) below.

2.2 Simulated Portfolios

Recently Lee (2011) discussed so-called risk-based asset allocation (sometimes
called risk budgeting). In contrast to strategies which require both expected risk
and expected returns for each investment opportunity as inputs to the portfo-
lio selection process, risk-based allocation considers only expected risk. The ﬁve
methods of portfolio selection we present below can be considered to be risk-based
allocation methods. This probably reﬂects private investor behaviour in that often
they have nothing more than broker buy, hold, or sell recommendations to assess
likely returns.

The portfolio formation methods were compared using simulations of 1,000
iterations. There were two sets of simulations. For ﬁrst set of simulations a
portfolio was sampled based on the rules governing the portfolio type using the
period return data. We recorded the mean and standard deviation of the returns
for the 1,000 portfolios. The second set of simulations was carried out in exactly
the same manner except weekly return data was used in order to obtain an estimate
of the weekly volatility of the portfolios. Each set covered ﬁve portfolio formation
strategies.

5

The ﬁve portfolio formation strategies are:

1. Selecting stocks at random;

2. Selecting stocks based on industry groupings;

3. Selecting stocks based on correlation clusters; and

4. Selecting stocks based on the dominant industry groups within the neighbor-

Net correlation clusters.

5. Selecting stocks based on based on the non-dominant industry groups within

the neighbor-Net correlation clusters.

We describe each of these in turn, combining (4) and (5) into a single description.

Random Selection: The stocks were selected at random using a uniform dis-
tribution without replacement. In other words each stock was given equal
chance of being selected according but with no stock being selected twice
within a single portfolio.

By Industry Groups: There were 11 industry groups represented among the
stocks. Some of the groups were very small. For example, the telecommu-
nications group only had two representatives in the early periods but this
increased over time as additional stocks classiﬁed as being in the telecommu-
nications industry were either listed or grew to suﬃcient size that they were
included in the index. Thus, when the groups were small, it was necessary to
merge some of them into larger groups for the purposes of the simulations.
This need lessened as the number of stocks grew. We had eight such groups
in periods two, three and four and nine groups in periods ﬁve and six.

Because the maximum portfolio size was eight stocks the industries were
chosen at random using a uniform distribution without replacement. Within
each industry group, stocks were selected using a uniform distribution.

By Correlation Clusters: The correlation clusters were determined by exam-
ining the neighbor-Net network for the relevant periods (periods one through
ﬁve). Each stock was assigned to exactly one cluster and each cluster can
be deﬁned by a single split (or bipartition) of the circular ordering of the
neighbor-Net for the relevant period. The clusters determined in periods
one through ﬁve were used to generate the stock groups for out-of-sample
testing in periods two through six respectively. Because the goal of portfolio
building is to reduce risk each cluster was paired with another cluster which
was considered most distant from it. This method is discussed in detail
below.

6

If there were fewer clusters than the desired portfolio size, cluster pairs were
selected at random and a stock selected from within each correlation cluster
pair. The simulation code was written so that if the desired portfolio size
was larger than the number of correlation clusters then each cluster group
pair had at least s stocks selected, where s is the quotient of the portfolio
size divided by the number of clusters. Some (the remainder of the portfolio
size divided by number of clusters) correlation groups will have s + 1 stocks
selected and the cluster pairs this applied to were chosen using a uniform dis-
tribution without replacement. However, in all cases the number of clusters
equalled or exceeded the number of stocks in the simulated portfolios.

By Dominant or Non-Dominant Industry Group within Clusters: The ﬁ-

nal two methods relate to selecting stocks from industry groups within cor-
relation clusters. Each stock within each cluster has an associated industry
group. Therefore each correlation cluster can be subdivided into up to eleven
sub-clusters based on industry. However, it was clear that in a number of
clusters one industry was dominant, sometimes more than half of the stocks.
This lead us to assign each stock to either the dominant industry group or
the non-dominant industry grouping creating two groups of stocks within
each cluster. This created two disjoint sets of clusters with no stock in both
groups.

From these two distinct sets of stocks, simulations were run in the same
manner as that described in “By Correlation Clusters” above. These simu-
lations were not comparable with the three above because the sample sizes
were diﬀerent and, obviously, each deals with a subset of the data. However,
care was taken to ensure that the sample sizes of both subsets was as close
to equal in size as was practical.

A problem arose, particularly with the non-dominant industry group stocks
when the number of stocks in the cluster was considered too small. In these
cases we took advantage of the circular ordering produced by neighbor-Nets
and combined the small cluster with a neighbouring cluster.

Unchanged from above, each cluster was paired with the one most distant
from it. Once a cluster was selected for inclusion, so was the paired cluster,
and a selection was made using a uniform distribution and, if necessary,
without replacement.

All simulations were coded and run in R (R Core Team, 2014).

We used the stocks weekly return data in period one to determine the clusters,
then observed period two’s return distributions of the simulated portfolios (1000
replications) which are picked from the diﬀerent correlation clusters. Because out-
of-sample testing was used in our analysis, the simulation then was continued for

7

period three, four, ﬁve and six based on the graphs produced from the weekly
returns in period two, three, four and ﬁve respectively.

3 Neighbor-Net Splits Graphs

For three of the ﬁve types of portfolio simulation methods discussed above we need
to identify correlation clusters from the neighbor-Net splits graphs. In this section
we explain how to identify the clusters, then proceed to present the neighbor-Net
splits graphs and the clusters identiﬁed for each of the ﬁrst ﬁve periods.

At its simplest a neighbor-Net splits graph is a type of map. The ability to
identify correlation clusters depends on the user’s skill in reading it. As an analogy,
all readers of a topographic map read the map in the same way. The information
the reader extracts depends on their needs. One person may read a map to extract
information about mountain ranges, another for information on river catchments,
and still another on the distribution of human settlements. But in all cases the
map readers agree which features are mountains, which are rivers and which are
towns and cities, no confusion arises because the map is read visually. In the same
way all readers of neighbor-Net splits graphs agree on which feature or features are
the origin, which are splits, which are recombinations and which are the terminal
locations.

Because this is a visual approach, the information extracted from reading a
neighbor-Net splits graph depends on the researcher or ﬁnancial analyst balancing
whatever competing requirements they may have. Here we know that in the sim-
ulations to follow the sizes of the portfolios we will generate will be two, four, or
eight stocks. Consequently, we do not need large numbers of clusters and we would
like them to have a suﬃciently large number of stocks such that when selecting
stocks at random from within the cluster there are a suﬃciently large number of
combinations available to make the simulations meaningful. These requirements
guide us when identifying clusters in the neighbor-Net splits graphs. The numbers
of clusters and cluster membership is determined visually and it is important not
to confuse visual with subjective.

Figures (2) through (8) present the neighbor-Nets splits graphs for periods one
through ﬁve. These were used to determine the stock groups for out-of-sample
testing using data from periods two through six respectively.

In Figure (2) eight clusters were identiﬁed and are colour coded in order to
distinguish them. The SplitsTree software generates a large amount of statistical
information about the network. However, we, like other users of neighbor-Nets,
look for breaks in the structure of the network. A good example can be found at
about eight o’clock in the splits graph between the stocks labelled CMW F and
CPA F. In its original context of phylogenetics, if these were species it would tell

8

us that the last common ancestor was in the distant past. Although CMW F and
CPA F are placed next to each other in the circular ordering, the two stocks are
not closely related.

Figure 2: Period 1 neighbor-Nets splits graph with eight clusters identiﬁed.

Figure (3) presents the same splits graph but within each cluster the stocks are
split into stocks which belong to the dominant industry group (larger typeface)
and stocks which are in other groups (smaller typeface). For example, in the aqua
coloured group, the dominant industry is ﬁnancials and all but three stocks belong
to this sector.

Figure (4) presents the neighbor-Nets splits graph for period 2. While the
clusters in this ﬁgure have not been visually separated into dominant and non-
dominate industry groups, the cluster between nine and ten o’clock is dominated
by ﬁnancial stocks. It is also straight-forward to see how the clusters were paired.

9

FOX_CSBHP_MRIO_MAWC_MTEN_CSMGX_MCAB_ISGM_MMND_ICDU_MMTS_CSNUF_MORI_MIIN_TNUGL_ICGF_FSMX_TNASX_FCPU_FREA_FMRM_IEWC_UPMV_FORG_UPG0_OWPL_OILU_MCTX_OALQ_CGPRY_HANN_HHZN_OFMG_MNZSK_CSAWE_OWDC_FENV_UBPT_OPDN_MCCL_CGDJS_CSSDL_MAGK_UASL_IAAD_FTCL_ICMW_FCPA_FCFX_FMGR_FSGP_FGPT_FDXS_FIOF_FBWP_FCQR_FRRL_MTLS_TCNZTE_TCTAH_CSWOW_CSAUT_OKCN_MSGN_CSSBM_MRSG_MNCM_MSIR_MOZL_MBRG_CGFWD_CGGUD_CGDLS_OALZ_FGMG_FLYC_MPNA_MGWA_IBLD_IQBE_FJHX_ICSR_ISUN_FCBA_FNAB_FANZ_FWBC_FGNC_CGBOQ_FRHC_HSTO_OCSL_HCOH_HRMD_HTOL_ILEI_IWES_CSALL_CSHVN_CSMQG_FAMP_FSWM_CSFLT_CSPPT_FBEN_FSHL_HDOW_IABC_ISKE_ILLC_FSXY_OBXB_IQAN_CSAMC_IFXJ_CS0.1Figure 3: Period 1 neighbor-Nets splits graph with the clusters split into dominant
and non-dominant industries.

The cluster just mentioned would be paired with the black coloured cluster between
about 2:30 and 3:30 on the opposite side of the network. These stocks are the most
distant in terms of the circular ordering. If the correlation clusters represent useful
ﬁnancial groupings of stocks we would expect that choosing a pair of stocks from
these two clusters would be likely to give a greater reduction in risk than two
stocks selected randomly.

10

FOX_CSBHP_MRIO_MAWC_MTEN_CSMGX_MCAB_ISGM_MMND_ICDU_MMTS_CSNUF_MORI_MIIN_TNUGL_ICGF_FSMX_TNASX_FCPU_FREA_FMRM_IEWC_UPMV_FORG_UPG0_OWPL_OILU_MCTX_OALQ_CGPRY_HANN_HHZN_OFMG_MNZSK_CSAWE_OWDC_FENV_UBPT_OPDN_MCCL_CGDJS_CSSDL_MAGK_UASL_IAAD_FTCL_ICMW_FCPA_FCFX_FMGR_FSGP_FGPT_FDXS_FIOF_FBWP_FCQR_FRRL_MTLS_TCNZTE_TCTAH_CSWOW_CSAUT_OKCN_MSGN_CSSBM_MRSG_MNCM_MSIR_MOZL_MBRG_CGFWD_CGGUD_CGDLS_OALZ_FGMG_FLYC_MPNA_MGWA_IBLD_IQBE_FJHX_ICSR_ISUN_FCBA_FNAB_FANZ_FWBC_FGNC_CGBOQ_FRHC_HSTO_OCSL_HCOH_HRMD_HTOL_ILEI_IWES_CSALL_CSHVN_CSMQG_FAMP_FSWM_CSFLT_CSPPT_FBEN_FSHL_HDOW_IABC_ISKE_ILLC_FSXY_OBXB_IQAN_CSAMC_IFXJ_CS0.1Figure 4: Period 2 neighbor-Nets splits graph with 10 clusters.

11

FOX_CSFXJ_CSENV_UPDN_MREA_FNZFB_INZTE_TCSMX_TNMRM_INZSK_CSSRX_HABC_ISIP_CSSYD_IEWC_UMTS_CSAPA_OMGX_MCTX_OSDL_MCCL_CGAGK_UWOW_CSAAD_FANN_HCSL_HALL_CSCOH_HASL_IPPT_FCPU_FTOL_IIAG_FLEI_ITSE_IDOW_IWOR_OTEN_CSSWM_CSBXB_IAMC_ICGF_FASX_FAWC_MRIO_MBHP_MARI_MBSL_MBLD_IJHX_ICSR_ISGM_MORG_USHL_HWES_CSNUF_MORI_MDJS_CSQAN_CSHVN_CSEVN_MFLT_CSFWD_CGSGN_CSSKE_IALZ_FBWP_FMGR_FSGP_FCFX_FIOF_FCPA_FCQR_FDXS_FGPT_FCBA_FWBC_FANZ_FNAB_FBOQ_FSUN_FQBE_FTAH_CSWDC_FMQG_FAUT_OILU_MSTO_OIRE_TNFMG_MAQA_MCMW_FLYC_MIIN_TNALQ_CGPRY_HTPM_TCPG0_OWPL_OAWE_OUGL_ICAB_IAMP_FLLC_FTCL_IABP_FMND_IBPT_OHZN_ODLS_OSXY_OGNC_CGPNA_MRSG_MOZL_MNCM_MSIR_MKCN_MSBM_MRRL_MPMV_FBRG_CGGUD_CGGWA_IBEN_FCDU_MRHC_HIGO_MWSA_MTLS_TCGMG_FSGT_TCRMD_H0.1Figure 5: Period 3 neighbor-Nets splits graph with 10 clusters.

12

FOX_CSFXJ_CSSWM_CSGMG_FCFX_FGPT_FWDC_FCQR_FDXS_FMGR_FSGP_FCPA_FIOF_FRHC_HWOR_OREA_FMND_ITSE_IBSL_MFWD_CGIRE_TNCAB_ITPM_TCAPA_OAGK_USIP_CSGUD_CGAUT_ONZSK_CSSIR_MSBM_MEVN_MDLS_OHZN_ODOW_ICMW_FABP_FAQA_MSMX_TNAAD_FSKE_IDJS_CSIGO_MWSA_MMRM_IBRG_CGALQ_CGASL_ILYC_MSXY_OGNC_CGCDU_MEWC_UFLT_CSALL_CSSRX_HRMD_HPRY_HQAN_CSSGT_TCTLS_TCNZTE_TCCCL_CGTCL_ISYD_ICSL_HPDN_MSHL_HNCM_MCSR_IKCN_MRRL_MRSG_MOZL_MPNA_MBPT_OAWE_OPG0_OWPL_ORIO_MBHP_MAWC_MSTO_OSDL_MMGX_MILU_MORG_UWES_CSJHX_ICTX_OPMV_FWOW_CSMTS_CSABC_IGWA_IENV_UBEN_FBOQ_FAMC_IBWP_FSGN_CSTEN_CSCPU_ICOH_HTOL_INUF_MBXB_ILLC_FQBE_FMQG_FANN_HARI_MNZFB_IFMG_MSGM_MHVN_CSLEI_IASX_FCGF_FAMP_FCBA_FNAB_FANZ_FWBC_FORI_MBLD_ISUN_FPPT_FIAG_FUGL_IALZ_FIIN_TNTAH_CS0.1Figure (5) gives a good example of where the cluster pairing may be diﬀerent.
Consider the green coloured cluster at the top of the splits graph. It is relatively
large and we shall call it cluster one. At the bottom of the graph are three smaller
clusters, two black and one green coloured which we shall call clusters six, seven
and eight, reading the circular ordering in a clockwise direction. The most distant
cluster from cluster one (the cluster at 12 o’clock) would be cluster seven (the
green coloured cluster at six o’clock). However, we should pair both clusters six
and seven (the black coloured cluster at ﬁve o’clock and the green coloured cluster
at six o’clock respectively) with cluster one. This illustrates the fact that while all
clusters have a cluster they are paired with, not all clusters are a reciprocal pair.

Figure 6: Period 4 neighbor-Nets splits graph with eight clusters.

Figures (7) and (8) are both splits graphs for period 5 divided into 10 and 11
correlation clusters respectively. As the number of stocks included in the analysis

13

FOX_CSPRY_HASX_FMRM_IJBH_CSMND_IHVN_CSDJS_CSFXJ_CSTEN_CSGUD_CGQAN_CSIRE_TNCSR_ITOL_ITTS_CSTAH_CSCAB_IVAH_CSWTF_CSAAD_FSUL_CSMMS_FGNC_CGFLT_CSREA_FIIN_TNTPM_TCSAI_ILLC_FCHC_FCQR_FGMG_FABP_FSGT_TCGPT_FMGR_FDXS_FDCG_IHGG_FCGF_FBWP_FCFX_FSGP_FWDC_FIOF_FCPA_FCMW_FSEK_ILEI_IWOR_OHZN_OABC_IIVC_CSWES_CSTSE_IALZ_FDOW_ISWM_CSAHE_CSUGL_IBKN_IALQ_CGAGK_UMFG_FTRS_CSCDD_IAQA_MMSB_HOGC_MPRU_MMML_MIGO_MNCM_MSBM_MEVN_MOZL_MKCN_MPMV_FACR_HILU_MORG_UFGE_ISKE_IAUT_ODLS_ODMP_CSNST_MCPU_ISXY_OSIR_MFMG_MRSG_MKAR_OBPT_OPG0_OSTO_OAWE_OWPL_OPDN_MWHC_MSGM_MCDU_MMGX_MWSA_MBHP_MAWC_MORI_MIPL_MBLY_OAGO_MPNA_MEWC_URIO_MFWD_CGNWH_IARI_MBSL_MASL_ILYC_MSDL_MCTX_OMIN_MSMX_TNFXL_FRRL_MBDR_MMTU_TCBRG_CGDUE_USYD_ISHL_HGFF_CGRMD_HTCL_ISPN_UENV_UPBG_CGNVT_CSSRX_HSGN_CSQUB_INZTE_TCNZSK_CSNZFB_IAPA_OSXL_CSTPI_ISFR_MBXB_IALL_CSANN_HAMC_ISIP_CSRHC_HCSL_HWOW_CSMTS_CSCCL_CGTLS_TCSKI_UCOH_HIFL_FPTM_FIAG_FPPT_FSUN_FAIO_IQBE_FBEN_FAMP_FMQG_FNAB_FANZ_FWBC_FCBA_FNUF_MBOQ_FGWA_IJHX_IBLD_I0.1Figure 7: Period 5 neighbor-Nets splits graph with 10 clusters.

grows the analyst gains some ﬂexibility in choosing the number of clusters.

To summarize, a stock market analyst or portfolio manager looks for breaks
in the structure of the neighbor-Net network when dividing the stocks into corre-
lation clusters. The SplitsTree software has considerable ﬂexibility to magnify
sections of the network to aid in decision making which cannot be easily captured
in the static pdf ﬁle outputs included in this paper. The circular ordering can be
very useful when splitting a correlation cluster into its component industry groups
because if one or more of the resulting groups are too small to be useful they can
be joined with groups next to them in the circular order.

14

FOX_CSFXJ_CSPTM_FNAB_FANZ_FWBC_FCBA_FSUN_FAMP_FBOQ_FBEN_FTTS_CSASX_FCTX_OPG0_OWPL_OORG_USTO_OILU_MBPT_OAWE_OWOR_OPNA_MAWC_MSGM_MWSA_MFMG_MAGO_MMGX_MBHP_MRIO_MOZL_MBSL_MARI_MORI_MSXL_CSACR_HHZN_OWHC_MIVC_CSIGO_MPDN_MKCN_MEVN_MSLR_MSBM_MNCM_MOGC_MPRU_MMML_MRSG_MEWC_UKAR_OPBG_CGIPL_MNVT_CSRHC_HDMP_CSSKE_IQUB_ISDL_MCOH_HCSL_HRMD_HMMS_FTSE_IFGE_IASL_IFXL_FAHE_CSSGN_CSIIN_TNSAI_IJHX_ILEI_ICDU_MDLS_OLYC_MDOW_IQBE_FMRM_IWTF_CSREA_FMIN_MDCG_ICDD_IALZ_FBWP_FTOL_IAAD_FCPU_ITPM_TCSEK_IAQA_MFLT_CSBLY_OBKN_IQAN_CSABC_ICSR_ICQR_FCHC_FMQG_FCGF_FCWN_CSSKI_UGMG_FGPT_FSGP_FMGR_FIOF_FGWA_IBLD_INWH_IALQ_CGAIO_IMND_IUGL_ILLC_FAMC_IBXB_IIFL_FBRG_CGSWM_CSTEN_CSPPT_FCMW_FSUL_CSMSB_HWOW_CSMTS_CSSPN_UAGK_UCCL_CGAPA_ONZTE_TCTLS_TCSHL_HPRY_HSXY_OSIR_MNZSK_CSGEM_CSSGT_TCSFR_MRRL_MBDR_MNST_MBRU_ONUF_MSIP_CSTCL_ITRS_CSANN_HAUT_OSYD_IALL_CSVAH_CSCAB_IIRE_TNSMX_TNDUE_UMFG_FIAG_FABP_FWDC_FCFX_FCPA_FDXS_FNZFB_IGUD_CGGNC_CGHVN_CSDJS_CSJBH_CSWES_CSPMV_FENV_UFWD_CGTPI_IMTU_TCSRX_HHGG_FGFF_CGTAH_CS0.1Figure 8: Period 5 neighbor-Nets splits graph with 11 clusters. Cluster 5 in Figure
(7) has been split into two smaller clusters coloured red and black.

15

FOX_CSFXJ_CSPTM_FNAB_FANZ_FWBC_FCBA_FSUN_FAMP_FBOQ_FBEN_FTTS_CSASX_FCTX_OPG0_OWPL_OORG_USTO_OILU_MBPT_OAWE_OWOR_OPNA_MAWC_MSGM_MWSA_MFMG_MAGO_MMGX_MBHP_MRIO_MOZL_MBSL_MARI_MORI_MSXL_CSACR_HHZN_OWHC_MIVC_CSIGO_MPDN_MKCN_MEVN_MSLR_MSBM_MNCM_MOGC_MPRU_MMML_MRSG_MEWC_UKAR_OPBG_CGIPL_MNVT_CSRHC_HDMP_CSSKE_IQUB_ISDL_MCOH_HCSL_HRMD_HMMS_FTSE_IFGE_IASL_IFXL_FAHE_CSSGN_CSIIN_TNSAI_IJHX_ILEI_ICDU_MDLS_OLYC_MDOW_IQBE_FMRM_IWTF_CSREA_FMIN_MDCG_ICDD_IALZ_FBWP_FTOL_IAAD_FCPU_ITPM_TCSEK_IAQA_MFLT_CSBLY_OBKN_IQAN_CSABC_ICSR_ICQR_FCHC_FMQG_FCGF_FCWN_CSSKI_UGMG_FGPT_FSGP_FMGR_FIOF_FGWA_IBLD_INWH_IALQ_CGAIO_IMND_IUGL_ILLC_FAMC_IBXB_IIFL_FBRG_CGSWM_CSTEN_CSPPT_FCMW_FSUL_CSMSB_HWOW_CSMTS_CSSPN_UAGK_UCCL_CGAPA_ONZTE_TCTLS_TCSHL_HPRY_HSXY_OSIR_MNZSK_CSGEM_CSSGT_TCSFR_MRRL_MBDR_MNST_MBRU_ONUF_MSIP_CSTCL_ITRS_CSANN_HAUT_OSYD_IALL_CSVAH_CSCAB_IIRE_TNSMX_TNDUE_UMFG_FIAG_FABP_FWDC_FCFX_FCPA_FDXS_FNZFB_IGUD_CGGNC_CGHVN_CSDJS_CSJBH_CSWES_CSPMV_FENV_UFWD_CGTPI_IMTU_TCSRX_HHGG_FGFF_CGTAH_CS0.1Period 2
Simulation
results
Mean return
(2-stock)
(4-stock)
(8-stock)
Std. Dev.
(2-stock)
(4-stock)
(8-stock)
Sharpe Ratio
(2-stock)
(4-stock)
(8-stock)
Levene Tests
(2-stock)
(4-stock)
(8-stock)

Random

Neighbor-Nets
correlation
cluster

Industry
Group

Correlation
Correlation
cluster with cluster without
industry group

industry group

106.49
101.51
104.66

79.34
*49.39
*33.61

1.34
2.06
3.11

94.93
98.45
96.90

*70.51
51.85
35.64

1.35
1.90
2.72

98.52
96.93
100.82

73.87
48.96
36.56

1.33
1.98
2.69

0.001
0.30
0.13

101.80
97.55
98.892

81.90
53.14
42.33

1.24
1.84
2.70

97.24
97.12
96.14

*62.47
*43.62
*29.81

1.56
2.23
3.23
1.0 × 10−7
1.7 × 10−6
1.3 × 10−12

Table 1: Period 2 portfolio performances with standard deviation for three diﬀerent
portfolio sizes. The selection method with the lowest standard deviation is marked
with an asterisk (*). The neighbor-Nets method is out-of-sample testing using the
correlation clusters determined from Period 1 data. The ﬁrst Levene test is the
p-value whether the standard deviation of the three diﬀerent portfolio selection
methods are equal. The second result is for the neightbor-Net clusters split into
dominant and non-dominant industry groupings.

4 Results

Tables (1) through (5) together with Figures (9) though (13) present the results
of the portfolio selection simulations.

In the third part of each table we have labelled the results presented there
the “Sharpe Ratio” though this is clearly not the ratio of Sharpe (1964). The
Sharpe ratio is properly applied to single assets or single portfolios and estimates
the reward to risk ratio. Here were are dividing the mean portfolio return by the
standard deviation of the returns estimated from the replications. A higher ratio
indicates either a higher mean return or a lower spread of returns generated by
that selection method or some combination of both. We believe the results are
worth reporting but do not discuss them further in this paper.

Table (1) presents the results for the Period 2 simulations which was a period of

16

strongly rising equity prices. The model building period (Period 1) was a period
when the market largely tracked sideways with a small decline over the period.
Thus the out-of-sample test represents a strong test of stock selection methods
between the two periods which do not resemble each other.

We are primarily concerned with reducing the risk of the portfolios. The results
in the table give the standard deviation of the returns of the 1000 replications of the
portfolio selection method. A lower standard deviation indicates that the returns of
the portfolios were more concentrated about the mean portfolio return. The Levene
tests show that only the two stock portfolios had a signiﬁcantly diﬀerent spread of
returns. The diﬀerence between the random selection method and neighbor-Nets
selection was almost nine percentage points diﬀerent.

The ﬁnal two columns of Table (1) present the results for the simulations
in which the correlation clusters were divided into dominant and non-dominant
industry groups. In this case the correlation clusters of non-dominant industries
showed statistically signiﬁcantly lower levels of spread of the portfolio returns.

Figure (9) plots the returns of the weekly standard deviation of the portfolio
returns, a measure of volatility, against the period portfolio return for the eight-
stock portfolios dividing the stocks in to dominant and non-dominant industry
groups. The diﬀerences are not pronounced but the spread of returns is smaller
for the correlation clusters with non-dominant industry groups though the weekly
volatility appears comparable.

Table (2) presents the results for the Period 3 simulations which was a period
of strongly rising equity prices. The model building period (Period 2) was also
a period of market increases. Thus the out-of-sample test and model building
periods closely resemble each other.

The Levene tests show that only the two stock portfolios had a signiﬁcantly
diﬀerent spread of returns, though the results for the eight-stock portfolios almost
reached statistical signiﬁcance. The diﬀerence between the neighbor-Nets selection
and industry group selection was almost 10 percentage points diﬀerent.

The ﬁnal two columns of Table (2) present the results for the simulations
in which the correlation clusters were divided into dominant and non-dominant
industry groups. In this case the correlation clusters of the dominant industries
showed statistically signiﬁcantly lower levels of spread of the portfolio returns.

Figure (10) plots the returns of the weekly standard deviation of the portfolio
returns, a measure of volatility, against the period portfolio return for the eight-
stock portfolios dividing the stocks in to dominant and non-dominant industry
groups. It is noticeable that the spread of returns is smaller for the correlation
clusters with dominant industry groups though the weekly volatility is higher.

Table (3) presents the result for the Period 4 simulations. Period four was
a period of strongly falling equity prices. The model building period (Period 3)

17

Period 3
Simulation
results
Mean return
(2-stock)
(4-stock)
(8-stock)
Std. Dev.
(2-stock)
(4-stock)
(8-stock)
Sharpe Ratio
(2-stock)
(4-stock)
(8-stock)
Levene Tests
(2-stock)
(4-stock)
(8-stock)

Random

Neighbor-Nets
correlation
cluster

Industry
Group

Correlation
Correlation
cluster with cluster without
industry group

industry group

156.32
152.99
154.30

108.11
75.93
51.34

1.45
2.01
3.01

149.30
151.27
149.05

109.64
75.47
50.15

1.36
2.00
2.97

135.11
134.02
137.79

*99.57
*71.01
*48.26

1.36
1.89
2.86

0.05
0.15
0.06

137.09
132.85
134.82

*66.02
*45.62
*32.49

2.07
2.91
4.15

150.97
155.49
152.94

116.40
83.45
57.63

1.27
1.86
2.65

< 10−16
< 10−16
< 10−16

Table 2: Period 3 portfolio performances with standard deviation for three diﬀerent
portfolio sizes. The selection method with the lowest standard deviation is marked
with an asterisk (*). The neighbor-Nets method is out-of-sample testing using the
correlation clusters determined from Period 2 data. The ﬁrst Levene test is the
p-value whether the standard deviation of the three diﬀerent portfolio selection
methods are equal. The second result is for the neightbor-Net clusters split into
dominant and non-dominant industry groupings.

18

Period 4
Simulation
results
Mean return
(2-stock)
(4-stock)
(8-stock)
Std. Dev.
(2-stock)
(4-stock)
(8-stock)
Sharpe Ratio
(2-stock)
(4-stock)
(8-stock)
Levene Tests
(2-stock)
(4-stock)
(8-stock)

Random

Neighbor-Nets
correlation
cluster

Industry
Group

Correlation
Correlation
cluster with cluster without
industry group

industry group

-46.58
-47.52
-47.48

22.80
*15.16
10.65

-2.04
-3.13
-4.46

-49.18
-49.46
-48.52

*21.30
15.41
10.49

-2.31
-3.21
-4.62

-45.56
-43.93
-44.09

21.70
15.68
*10.42

-2.10
-2.80
-4.25

0.78
0.32
0.73

-54.61
-54.81
-54.70

*17.16
*11.29
*8.03

-3.18
-4.85
-6.81

-43.26
-42.19
-42.18

23.49
16.80
11.11

-1.85
-2.51
-3.80
1.6 × 10−9
< 10−16
< 10−16

Table 3: Period 4 portfolio performances with standard deviation for three diﬀerent
portfolio sizes. The selection method with the lowest standard deviation is marked
with an asterisk (*). The neighbor-Nets method is out-of-sample testing using the
correlation clusters determined from Period 3 data. The ﬁrst Levene test is the
p-value whether the standard deviation of the three diﬀerent portfolio selection
methods are equal. The second result is for the neightbor-Net clusters split into
dominant and non-dominant industry groupings.

19

was a period of strong market increases. Thus the out-of-sample test and model
building periods are eﬀectively opposites of each other.

The Levene tests show that no stock portfolios had a signiﬁcantly diﬀerent

spread of returns.

The ﬁnal two columns of Table (3) present the results for the simulations
in which the correlation clusters were divided into dominant and non-dominant
industry groups. In this case the correlation clusters of the dominant industries
showed statistically signiﬁcantly lower levels of spread of the portfolio returns. The
Levene tests were highly signiﬁcant for all portfolio sizes.

Figure (11) plots the returns of the weekly standard deviation of the portfolio
returns against the period portfolio return for the eight-stock portfolios dividing
the stocks in to dominant and non-dominant industry groups.
It is noticeable
that the spread of returns is substantially smaller for the correlation clusters with
dominant industry groups though, again, the weekly volatility is higher.

Table (4) presents the results for the Period 5 simulations which was a period
of equity prices initially rebounding then tracking sideways. The model building
period (Period 4) was a period of strong market decreases. Thus the out-of-sample
test and model building periods are substantially diﬀerent.

The Levene tests show that only the four stock portfolios had a signiﬁcantly

diﬀerent spread of returns.

The ﬁnal two columns of Table (4) present the results for the simulations
in which the correlation clusters were divided into dominant and non-dominant
industry groups. In this case the correlation clusters of the dominant industries
showed statistically signiﬁcantly lower levels of spread of the portfolio returns. The
Levene tests were strongly signiﬁcant for all portoﬁlos sizes.

Figure (12) plots the returns of the weekly standard deviation of the portfolio
returns against the period portfolio return for the eight-stock portfolios dividing
the stocks in to dominant and non-dominant industry groups. It is noticeable that
the spread of returns is smaller for the correlation clusters with dominant industry
groups though, again, the weekly volatility is higher.

Table (5) presents the result for the Period 6 simulations which was a period of
rising equity prices with signiﬁcant volatility. The model building period (Period
5) was a period of rebound followed by a time of stacking sideways. Thus the
out-of-sample test and model building periods have some similarities.

The Levene tests show that the four and eight stock portfolios had a sig-
In both cases the neighbor-Nets portfolio

niﬁcantly diﬀerent spread of returns.
selection method had the lowest spread of returns.

The ﬁnal two columns of Table (5) present the results for the simulations
in which the correlation clusters were divided into dominant and non-dominant
industry groups. In this case the correlation clusters of the dominant industries

20

Period 5
Simulation
results
Mean return
(2-stock)
(4-stock)
(8-stock)
Std. Dev.
(2-stock)
(4-stock)
(8-stock)
Sharpe Ratio
(2-stock)
(4-stock)
(8-stock)
Levene Tests
(2-stock)
(4-stock)
(8-stock)

Random

Neighbor-Nets
correlation
cluster

Industry
Group

Correlation
Correlation
cluster with cluster without
industry group

industry group

164.49
162.29
162.43

144.70
105.14
70.68

1.14
1.54
2.30

159.20
150.17
154.90

149.58
*94.92
*68.04

1.06
1.58
2.28

156.22
160.37
162.25

*141.50
99.47
70.61

1.10
1.61
2.38

0.46
0.003
0.35

142.77
149.74
151.25

*124.24
*83.90
*60.30

1.15
1.78
2.51

160.07
164.06
163.34

155.57
106.43
73.00

1.03
1.54
2.24
3.9 × 10−5
3.3 × 10−8
1.4 × 10−8

Table 4: Period 5 portfolio performances with standard deviation for three diﬀerent
portfolio sizes. The selection method with the lowest standard deviation is marked
with an asterisk (*). The neighbor-Nets method is out-of-sample testing using the
correlation clusters determined from Period 4 data. The ﬁrst Levene test is the
p-value whether the standard deviation of the three diﬀerent portfolio selection
methods are equal. The second result is for the neightbor-Net clusters split into
dominant and non-dominant industry groupings.

21

Period 6
Simulation
results
Mean return
(2-stock)
(4-stock)
(8-stock)
Std. Dev.
(2-stock)
(4-stock)
(8-stock)
Sharpe Ratio
(2-stock)
(4-stock)
(8-stock)
Levene Tests
(2-stock)
(4-stock)
(8-stock)

Random

Neighbor-Nets
correlation
cluster

Industry
Group

Correlation
Correlation
cluster with cluster without
industry group

industry group

45.96
48.39
46.66

52.03
37.28
25.56

0.88
1.30
1.76

46.60
51.10
50.32

*49.87
*33.18
*21.63

0.93
1.54
2.33

54.36
55.19
55.62

51.62
34.11
22.94

1.05
1.62
2.42

0.64
0.007
1.1 × 10−9

34.77
35.85
35.36

*44.92
*28.49
*15.04

0.77
1.26
2.35

65.16
61.87
62.09

51.32
35.65
24.04

1.27
1.74
2.58

0.004
4.0 × 10−9
< 10−16

Table 5: Period 6 portfolio performances with standard deviation for three diﬀerent
portfolio sizes. The selection method with the lowest standard deviation is marked
with an asterisk (*). The neighbor-Nets method is out-of-sample testing using the
correlation clusters determined from Period 5 data. The ﬁrst Levene test is the
p-value whether the standard deviation of the three diﬀerent portfolio selection
methods are equal. The second result is for the neightbor-Net clusters split into
dominant and non-dominant industry groupings.

22

showed statistically signiﬁcantly lower levels of spread of the portfolio returns. The
Levene tests were highly signiﬁcant for all portoﬁlos sizes.

Figure (13) plots the returns of the weekly standard deviation of the portfolio
returns against the period portfolio return for the eight-stock portfolios dividing
the stocks in to dominant and non-dominant industry groups. It is noticeable that
the spread of returns is smaller for the correlation clusters with dominant industry
groups though, as with some previous periods, the weekly volatility is higher.

5 Discussion and Conclusions

The simulation tests performed here represent a particularly severe test of portfolio
diversiﬁcation because of the long out-of-sample test periods coupled with the fact
that the market conditions in the model building phase were often very diﬀerent
from the market conditions in the test phase.

In the 15 sets of simulations comparing, random, industry group, and neighbor-
Net correlation cluster selection methods, statistically signiﬁcant diﬀerences in the
portfolios standard deviation were obtained only ﬁve times.
In four cases the
neighbor-Net correlation cluster produced the lowest standard deviation and in
one case the industry group selection method was the lowest.

Considering the neighbor-Net correlation clusters split into dominant and non-
dominant industries, all 15 cases had statistically signiﬁcant diﬀerences in the
portfolios’ standard deviation. Of these 12 were correlation clusters with dominant
industry groups in Periods 3 through 6 and three were correlation clusters with
non-dominant industry groups in Period 2. Because we do not have data from
before the inception date of the ASX200 index it is not possible to say if this
represents a change in the behaviour of the market.

Figures (9) through (13) present this last observation in graphical form and it is
clear that the distribution both in terms of portfolio returns and weekly volatility
are diﬀerent for all periods. Graphs of the two and four stock portfolios show
similar results but are not reported here.

These results suggest that within each correlation cluster there are two distinct
sub-populations of stocks.
Intuitively, the dominant industry group are simply
stocks within the same industry with similar risk characteristics. We would expect
such stocks to be strongly correlated, hence fall into the same correlation cluster.
We would also expect that they would continue to be strongly correlated into the
future. On the other hand, the stocks in the non-dominant industry group within
a correlation cluster would seem far less likely to remain strongly correlated in the
future.

At this stage we can only recommend that this be investigated further. The
diﬀerences between the two groups of stocks appear signiﬁcant both in a statistical

23

and economic sense but it is not yet clear how to exploit this diﬀerence for ﬁnancial
gain.

This paper is primarily concerned about reducing risk in small portfolios. How-
ever, investors are also concerned about returns and in three of the ﬁve periods
(two, three and ﬁve) the randomly selected portfolios had the highest returns
among the three methods which included all stocks. Truly negative correlations
among stocks are uncommon and in a strongly rising market a negative correlation
between a pair of stocks often indicates that one stock is suﬀering from some form
of ﬁnancial distress and hence a falling share price. The correlation cluster method
excludes many stock combinations available to the random selection method but
also increases the probability of a stock being paired with one in ﬁnancial distress
hence depressing overall portfolio performance. If this explanation is correct then
the application of ﬁnancial analysis aimed at removing ﬁnancially distressed stocks
may well enhance the performance of all portfolio selection methods. Again, this
must wait for further research.

References

Bai, Y. and C. J. Green (2010). International Diversiﬁcation Strategies: Revisited

from the Risk Perspective. The Journal of Banking and Finance 34, 236–245.

Bali, T. G., N. Cakici, X. Yan, and Z. Zhang (2005). Does Idiosyncratic Risk

Really Matter? The Journal of Finance 60 (2), 905–929.

Barber, B. M. and T. Odean (2008). All That Glitters: The Eﬀect of Attention
and News on the Buying Behaviour of Individual and Institutional Investors.
The Review of Financial Studies 21 (2), 785–818.

Benzoni, L., P. Collin-Dufresne, and R. S. Goldstein (2007). Portfolio Choice over
the Life-Cycle when the Stock and Labor Markets are Cointegrated. The Journal
of Finance 62 (5), 2123–2167.

Bonanno, G., G. Calderelli, F. Lillo, S. Miccich´e, N.Vandewalle, and R. N. Man-
tegna (2004). Networks of equities in ﬁnancial markets. The European Physical
Journal B 38, 363–371. doi:10.1140/epjb/e2–4-00129-6.

Bryant, D. and V. Moulton (2004). Neighbor-net: An agglomerative method
for the construction of phylogenetic networks. Molecular Biology and Evolu-
tion 21 (2), 255–265.

Cont, R. (2001). Empirical properties of asset returns: stylized facts and statistical

issues. Quantitative Finance 1:2, 223–236.

24

DiMiguel, V., L. Garlappi, and R. Uppal (2009). Optimal versus Naive Diver-
siﬁcation: How Ineﬃcient is the 1/N Portfolio Strategy? Review of Financal
Studies 22 (5), 1915–1953.

Djauhari, M. A. (2012). A Robust Filter in Stock Networks Analysis. Physica

A 391 (20), 5049–5057.

Domian, D. L., D. A. Louton, and M. D. Racine (2007). Diversiﬁcation in Portfolios
of Individual Stocks: 100 Stocks Are Not Enough. The Financial Review 42,
557–570.

Evans, J. L. and S. H. Archer (1968). Diversiﬁcation and the Reduction of Dis-

persion: An Empirical Analysis. The Journal of Finance 23 (5), 761–767.

Fama, E. F. and K. R. French (1992). The Cross-Section of Expected Stock

Returns. The Journal of Finance 47 (2), 427–465.

French, K. R. and E. F. Fama (1993). Common Risk Factors in the Returns on

Stocks and Bonds. Journal of Financal Economics 33, 3–56.

Goyal, A. and P. Santa-Clara (2003). Idiosyncratic Risk Matters! The Journal of

Finance 58 (3), 975–1007.

Huson, D. H. and D. Bryant (2006). Application of phylogenetic networks in

evolutionary studies. Molecular Biology and Evolution 23 (2), 255–265.

Jorion, P. (1985).

International Portfolio Diversiﬁcation with Estimation Risk.

The Journal of Business 58 (3), 259–278.

Kenett, D. Y., M. Tumminello, A. Madi, G. Gur-Gershgoren, R. N. Mantegna,
and E. Ben-Jacob (2010). Systematic analysis of group identiﬁcation in stock
markets. PLoS ONE 5, e15032.

Lee, W. (2011). Risk-Based Asset Allocation: A New Answer to an Old Question?

Journal of Portfolio Management 37 (4), 11–28.

Lowenfeld, H. (1909). Investment, an Exact Science. Financial Review of Reviews.

Mantegna, R. N. (1999). Hierarchical structure in ﬁnancial markets. The European

Physical Journal B 11, 193–197.

Markowitz, H. M. (1991). Portfolio Selection: Eﬃcient Diversiﬁcation of Invest-

ments 2nd Edition. Wiley.

Markowtiz, H. (1952). Portfolio Selection. The Journal of Finance 7 (1), 77–91.

25

Miccich´e, S., G. Bonannon, F. Lillo, and R. N. Mantegna (2006). Degree stability
of a minimum spanning tree of price return and volatility. Physica A 324, 66–73.

Naylor, M. J., L. C. Rose, and B. J. Moyle (2007). Topology of foreign exchange

markets using hierarchical structure methods. Physica A 382, 199–208.

Onnela, J.-P., A. Chakraborti, K. Kaski, J. Kert`esz, and A. Kanto (2003a). Asset

Trees and Asset Graphs in Financial Markets. Physica Scripta T106, 48–54.

Onnela, J.-P., A. Chakraborti, K. Kaski, J. Kert`esz, and A. Kanto (2003b). Dy-
namics of market correlations: Taxonomy and portfolio analysis. Physical Re-
view E 68, 0561101–1 – 056110–12.

R Core Team (2014). R: A Language and Environment for Statistical Computing.

Vienna, Austria: R Foundation for Statistical Computing.

Rea, A. and W. Rea (2014). Visualization of a stock market correlation matrix.

Physica A 400, 109–123.

Sharpe, W. F. (1964). Capital Asset Prices: A Theory of Market Equilibrium

Under Conditions of Risk. The Journal of Finance 19 (3), 13–37.

A Neighbor-Net

This appendix gives a more technical description of the Neighbor-Net algorithm.
The construction of Neighbor-Net networks has four key components: the ag-
glomerative process, selection formulae, distance reduction and estimation of the
split weights. The agglomerative process describes how the hierarchy of nodes is
determined, selection formulae describe the system used in determining the hi-
erarchy and distance reduction describes how the distances are adjusted as the
hierarchy is built. The result of the these three steps is a circular collection of
splits. Formally a set of circular splits is one which satisﬁes that condition that
there is an ordering of the nodes x1, x2, . . . , xn such that every split is of the form
{xi, xi+1, . . . , xj}|X − {xi, . . . , xj} for some i and j satisfying 1 ≤ i ≤ j < n. As
highlighted above, the advantage of this set of splits is that they can be represented
on a plane.

We describe the algorithm following Bryant and Moulton (2004). All the nodes
start out as singletons and the selection formulae ﬁnds the two closest nodes.
These nodes are not grouped immediately but remain as singletons until a node
has two neighbors. At this stage the three nodes, the node and its two neighbors,
are merged into two nodes. Here we present the selection formula for grouping

26

nodes. Let neighboring relations group the n nodes into m clusters. Let dxy be
the distance between nodes x and y. Let C1, C2, . . . , Cm, m ≤ n be the m clusters.
The distance d(Ci, Cj) between two clusters is

d(Ci, Cj) =

1

|Ci||Cj|

dxy,

(2)

(cid:88)

(cid:88)

x∈Ci

y∈Cj

that is, an average of the distances between elements in each cluster.

The closest pair of clusters is given by ﬁnding the i and j that minimise

Q(Ci, Cj) = (m − 2)d(Ci, Cj) − (cid:88)

md(Ci, Ck) − (cid:88)

md(Cj, Ck),

(3)

k=i,k(cid:54)=i

k=i,k(cid:54)=i

and denote them Ci∗ and Cj∗

To choose particular nodes within clusters we select the node from each cluster

that minimises

ˆQ(xi, xj) = ( ˆm − 2)d(xi, xj) − (cid:88)

ˆmd(xi, Ck) − (cid:88)

ˆmd(xj, Ck)

(4)

k=i,k(cid:54)=i

k=i,k(cid:54)=i

where xi ∈ Ci∗ and xj ∈ Cj∗ and ˆm = m + |Ci∗| + |Cj∗| − 2.

The distance reduction updates the distance matrix with the distance from
the two new clusters to all the other clusters. The distance reduction formulae
calculate the distances between the existing nodes and the new combined nodes.
If y has two neighbors, x and z, then the three nodes will be combined and replaced
by two nodes which we can denote as u and v. The Neighbor-Net algorithm uses

d(u, a) = (α + β)d(x, a) + γd(y, a)
d(v, a) = αd(y, a) + (β + γ)d(z, a)
d(u, v) = αd(x, y) + βd(x, z) + γd(y, z)

(5)
(6)
(7)

where α, β and γ are non-negative real numbers with α + β + γ = 1.

The process stops when all the nodes are in a single cluster.
The Neighbor-Net method of Bryant and Moulton (2004) used non-negative
least squares to estimate the split weights given the distance vector and a set
splits known as the circular splits. Suppose that the splits in the network are
numbered 1, 2, . . . , m and that the nodes are numbered 1, 2, . . . , n. Let X be the
be the splits matrix with the dimensions n(n− 1)/2× m matrix with rows indexed
by pairs of nodes, columns indexed by splits, and entry Xij,k given by

(cid:40)

Xij,k =

1 if i and j are on opposite sides of the split
0 if i and j are on the same side of the split.

(8)

27

Similar nodes will be clustered together in the network. This is a direct result
of each pair of neighboring nodes in the ordering being close together in terms of
distance, and separated from node where the distance measure reveals dissimilarity.
The network, or splits graph, generated by Neighbor-Nets has three biologically
meaningful components. The places where a line splits represents a speciation
event, where a single population becomes two genetically isolated populations.
The places where two lines join to become one represents a recombination event,
where two genetically isolated populations exchange genetic material. The lengths
of the indivdual lines represent the time the population evolves without either a
speciation or recombination event. The interpretation of these three components
in a ﬁnancial context is an active area of research for the authors.

28

Figure 9: Scatter plots of Period 2 returns against the weekly volatility for the
eight-stock portfolios selected on the basis of the clusters identiﬁed in neighbor-
Nets splits graph from Period 1 with the clusters split into dominant and non-
dominant industry groups.

29

01234−5050150250Dominant 8 stocksweekly standard deviation of portfoliosperiod return of portfolios01234−5050150250Non−Dominant 8 stocksweekly standard deviation of portfoliosperiod return of portfolios01234−5050150250Non−Dominant 8 stocksweekly standard deviation of portfoliosperiod return of portfolios01234−5050150250Dominant 8 stocksweekly standard deviation of portfoliosperiod return of portfoliosFigure 10: Scatter plots of Period 3 returns against the weekly volatility for the
eight-stock portfolios selected on the basis of the clusters identiﬁed in neighbor-
Nets splits graph from Period 2 with the clusters split into dominant and non-
dominante industry groups.

30

0123450150250350Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios0123450150250350Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios0123450150250350Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios0123450150250350Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of PortfoliosFigure 11: Scatter plots of Period 4 returns against the weekly volatility for the
eight-stock portfolios selected on the basis of the clusters identiﬁed in neighbor-
Nets splits graph from Period 3 with the clusters split into dominant and non-
dominant industry groups.

31

345678−60−40−200Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios345678−60−40−200Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios345678−60−40−200Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios345678−60−40−200Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of PortfoliosFigure 12: Scatter plots of Period 5 returns against the weekly volatility for the
eight-stock portfolios selected on the basis of the clusters identiﬁed in neighbor-
Nets splits graph from Period 4 with the clusters split into dominant and non-
dominant industry groups.

32

1.52.02.53.03.54.04.55.00100200300400500Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios1.52.02.53.03.54.04.55.00100200300400500Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios1.52.02.53.03.54.04.55.00100200300400500Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios1.52.02.53.03.54.04.55.00100200300400500Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of PortfoliosFigure 13: Scatter plots of Period 6 returns against the weekly volatility for the
eight-stock portfolios selected on the basis of the clusters identiﬁed in neighbor-
Nets splits graph from Period 5 with the clusters split into dominant and non-
dominant industry groups.

33

23456050100150Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios23456050100150Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios23456050100150Non−Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios23456050100150Dominant 8 stocksWeekly Standard Deviation of PortfoliosPeriod Return of Portfolios