6
1
0
2

 
r
a

M
4

 

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
3
5
3
1
0

.

3
0
6
1
:
v
i
X
r
a

Rate-distance tradeoﬀ and resource costs for all-optical quantum repeaters

Mihir Pant,1, ∗ Hari Krovi,2 Dirk Englund,1 and Saikat Guha2

1Dept. of Electrical Engineering and Computer Science, MIT, Cambridge, MA 02139, USA

2Quantum Information Processing group, Raytheon BBN Technologies,

10 Moulton Street, Cambridge, MA 02138, USA

We present a resource-performance tradeoﬀ calculation of an all-optical repeater architecture
that uses photon sources, linear optics, photon detectors and classical feedforward at each repeater
node, but no quantum memories. The secret-key generation rate attainable by any repeaterless
quantum key distribution protocol over an optical channel of transmissivity η is at most Rdirect(η) =
− log2(1 − η) ≈ (1/ ln 2)η bits per mode, for η (cid:28) 1. With the device resources (number of photon
sources and detectors) held ﬁxed at each repeater node, we show that the key rate achieved by our
protocol has the form R(η) = Dηs bits per mode, where D and s are functions of the aforesaid
resource constraint and various losses in the system. Even with lossy sources, ineﬃcient detectors,
and coupling and propagation losses in optical ﬁbers and waveguides, we show that it is possible
to achieve s < 1, and hence outperform the repeaterless rate-loss upper bound Rdirect(η) beyond
a certain total range L, where η ∼ e−αL in optical ﬁber. We also propose a suite of modiﬁcations
to a recently-proposed all-optical repeater protocol that our protocol builds upon, which lowers
the number of photon sources required to create photonic clusters at the repeater nodes so as to
outperform the repeaterless bound, by 5 orders of magnitude, from ∼ 1011 to ∼ 106 photon sources
per repeater node. We show that the optimum separation between repeater stations is independent
of the total range L, and is around 1.5 km for assumptions we make on various device losses.

PACS numbers: 42.50.Ex, 03.67.Dd, 03.67.Lx, 42.50.Dv

I.

INTRODUCTION

Quantum key distribution (QKD) enables two distant
authenticated parties Alice and Bob, connected via a
quantum (e.g., optical) channel, to generate information-
theoretically secure shared secret bits. No knowledge of
the channel conditions (noise model, or any channel es-
timate) is required a priori to ensure security. However,
the shared secret is generated at a rate commensurate
with the worst-case adversary physically consistent with
the channel conditions actually presented to Alice and
Bob. The reason is that all the perceived channel im-
perfections (absolutely anything that causes the chan-
nel map to deviate from a noiseless identity transfor-
mation) is attributed to the actions of the most pow-
erful adversary allowed by physics—even though some
(or all) of that deviation of the channel from an iden-
tity map may actually stem from non-adversarial sources,
such as losses due to free-space diﬀraction, ﬁber loss,
detection ineﬃciency, thermal noise from blackbody at
the operating temperature and wavelength, and detec-
tor noise. An important consequence of this assump-
tion is that all the signal power transmitted by Alice
that is not collected by Bob is made available coher-
ently to the eavesdropper, Eve. This model for Eve is
the intuition behind why the secret key rate for a direct-
transmission based QKD protocol must decrease linearly
with η, the Alice-Bob power transmissivity, in the η (cid:28) 1
regime [1, 2]. For any direct-transmission protocol over
the pure-loss optical channel of transmissivity η, and as-

∗ mpant@mit.edu

suming unlimited authenticated two-way public classi-
cal communication, it was recently shown that the key
rate cannot exceed log2(1/(1 − η)) bits per mode [2],
which is ≈ 1.44η for η (cid:28) 1. We will refer to this as
the Pirandola-Laurenza-Ottaviani-Banchi (PLOB) upper
bound. For a pure-loss channel, the PLOB bound im-
proves over the Takeoka-Guha-Wilde (TGW) bound [1]
by a factor of 2 in the η (cid:28) 1 regime. The TGW
bound is an upper bound on the secret-key agreement
capacity with unlimited two-way classical communica-
tion P2(N ), applicable to a general quantum channel N .
For the pure-loss channel Nη, the PLOB bound coin-
cides with the best-known achievable rate [3], thus es-
tablishing P2(Nη) = log2(1/(1 − η)) bits per mode. The
bits/s rate of a QKD system is obtained by multiplying
the bits/mode rate by the spatio-temporal-polarization
bandwidth (modes/s), which is governed by the channel
geometry, and the transmitter and detector bandwidth.
Since loss increases exponentially with distance L in op-

tical ﬁber (i.e., η = e−αL), for η (cid:28) 1, the key rate gen-

erated by any direct-transmission QKD protocol must
decay exponentially with the range.

Quantum repeaters, proposed in [4], are devices which
when inserted along the length of the optical channel, can
help generate shared secret at a rate that surpasses the
PLOB bound [2]. Traditional quantum repeaters work in
the framework of entanglement-based QKD. At the end
of the transmission phase of an entanglement-based QKD
protocol, Alice and Bob share (noisy, or imperfect) en-
tangled pairs (e.g., of photons or matter-based stationary
qubits) which could have been tampered with, or which
could have deteriorated due to channel loss and noise. At
that point, if the end goal of Alice and Bob is to generate

shared entanglement (for use in some quantum protocol
that consumes shared entanglement, such as telepora-
tion [5] or dense coding [6]), they could perform entan-
glement distillation to sieve out a small number of clean
maximally entangled Bell pairs by performing local op-
erations and classical communications (LOCC). If the
end goal of Alice and Bob is to generate shared secret
(a strictly less demanding goal than generating shared
entanglement), they directly measure the noisy shared
entangled pairs, and perform (classical) error correction
and privacy ampliﬁcation on their correlated measure-
ment results over an authenticated public channel to dis-
till a shared secret key.

Several diﬀerent genres of repeater protocols have been
proposed [7]. The two primary ingredients in any of the
published repeater architectures are: (1) some form of a
quantum memory that can hold ‘one half’ of an entangled
pair of qubits while the other half is carried afar by an
optical photon, and (2) the ability to perform a certain
restricted class of quantum logic, i.e., gates and mea-
surements on the ﬂying (photonic) qubits as well as the
static (memory) qubits. In the most basic repeater pro-
tocol, the restricted quantum operation required is Bell
state measurement (BSM) on pairs of qubits. A BSM on
qubit b and qubit c converts two independent Bell pairs
|Ψ(cid:105)ab and |Ψ(cid:105)cd into one Bell pair |Ψ(cid:105)ad, upto local sin-
gle qubit operations, a process known as entanglement
swapping.

A. Quantum repeaters based on mode multiplexing

and Bell state measurements

In the ensuing discussion, we will focus on a class
of quantum repeaters that rely solely on probabilistic
BSMs, quantum memories, and multiplexing, i.e., the
ability to ‘switch’ qubits across (spatial, spectral, or tem-
poral) modes. The essence of such a repeater protocol
was developed by Sinclair et al., which employed spec-
tral multiplexing in multimode quantum memories across
m parallel spectral channels, and entanglement swapping
using linear optics and single photon detectors (the suc-
cess probability of which can at most be 50%) [8]. Guha
et al. analyzed the secret key rates achievable by the
above protocol, with a ﬁxed m (memory size) and found
that even when photon loss is the only source of noise,
the achievable key rate is of the form Dηs, where D, and
s < 1 are constants that are functions of various losses
in the system (viz., detection eﬃciencies, coupling losses,
memory loading and readout eﬃciencies, and BSM fail-
ure probability) [9]. Since the exponent of η, i.e., s < 1,
the key rate beats the PLOB bound (which scales as:
∝ η for η (cid:28) 1) beyond a certain minimum distance de-
termined by the actual values of the system’s loss param-
eters, which is around a couple of hundred kilometers for
reasonable estimates of the losses [9]. However, since
η = e−αL in ﬁber, the rate achieved by this repeater pro-
tocol for a ﬁxed memory size still scales exponentially

2

with the range L, albeit with a smaller exponent com-
pared to the best possible rate without any repeater,
which could turn into a huge absolute improvement in
the end-to-end secret key rate.

Azuma et al. recently proposed an all-photonic variant
of this protocol in which they substituted matter based
quantum memories with optical cluster states [10], based
on a proposal by Varnava et al.
to mimic a quantum
memory (i.e., protect against photon losses) by append-
ing each physical photonic qubit by an entangled ‘tree
cluster’ state [11]. As long as the losses incurred by each
photon (i.e., photons being protected as well as the ad-
ditional photons in the trees added for loss protection)
is less than 3 dB, the eﬀective loss of the logical qubit
can be made to approach zero, by increasing the size of
the tree cluster, i.e., the number of photons in the logi-
cal qubit [12]. Thus, Azuma et al.’s proposal showed the
theoretical feasibility of a quantum repeater architecture
(i.e., one that can beat the scaling of direct-transmission
QKD) using only ﬂying qubits, with the repeater nodes
being equipped only with single photon sources, passive
linear-optical circuits (beamsplitters and phase shifters),
single photon detectors, and classical feedforward.

Azuma et al.’s result marked a promising conceptual
leap towards all-optical quantum repeaters. However,
important unanswered questions remained, including the
achievable secure key generation rate and how it scales
with distance (or loss), as well as the physical resource
requirements: e.g., the number of photon sources and de-
tectors at the repeater nodes. As an example, a calcula-
tion in their paper shows that at a range of L = 5000 km,
an entanglement-generation rate of 69 kHz is achievable
in a ﬁber based linear optic system with 100 kHz repeti-
tion rate, 150 ns feed forward time and a source-detector
eﬃciency product of 95% whereas sharing a single entan-
gled pair via a direct transmission scheme with the same
parameters would require 1081 years. The level of error
protection required to achieve the aforesaid repeater per-
formance at L = 5000 km would require one to build en-
tangled clusters of ∼ 104 photons per clock cycle at each
repeater node. Building such a cluster using linear optics
and feed-forward [13, 14] would require around 1024 pho-
ton sources at each repeater node. Furthermore, since
every photon used for error correction is sent between re-
peater nodes in [10], their scheme would require around
m = 10, 000 parallel channels connecting the neighboring
nodes. Thus, while Ref. [10] crucially showed the theo-
retical feasibility of all-optical repeaters, further work is
needed to address their practical feasibility. These re-
sults open up a compelling line of research to investigate
improved all-photonic repeater architectures of various
genres which could be built with practically feasible re-
sources, and also a thorough comparative study of rates
achievable with each such all-optical repeater scheme.

B. Our main results

Our contributions in this paper are twofold. The ﬁrst is
a rigorous analysis of: (a) the secret key rates achievable
with the the aforesaid all-photonic repeater architecture
given the size of the cluster at each repeater station, and
(b) the resources required (e.g., number of single photon
sources and detectors required at each repeater node)
to build that cluster, while taking into account in ex-
plicit detail each step in building the required clusters
using a network of passive linear optics (i.e., beamsplit-
ters and phase shifters), imperfect on-demand sources
with loss (see section II for a description of the source),
single photon detectors (with some number resolving ca-
pability), and feed-forward. We ﬁnd that the achievable
secret key rate scales as Dηs bits/mode, where D and
s < 1 are functions of the number of photon sources
at each repeater node (the resource constraint—which is
parametrically related to the size of the cluster), all the
‘inline’ losses (e.g., losses in the optical ﬁber or waveg-
uide used while creating the cluster, independent of the
ﬁber loss between repeater stations), and the source and

detector eﬃciencies. With η ∼ e−αL in ﬁber, the key

rate still scales exponentially with L, but with a smaller
exponent compared to the best direct-transmission pro-
tocol. This is no surprise given the analysis of
[9], since
the tree-cluster construction of [10] essentially mimics
an imperfect quantum memory, but one whose eﬃciency
cannot simply be modeled by a constant per mode as
in Ref. [9]. Using the cluster building scheme proposed
by Li et al. [14], we ﬁnd that to a good approximation,
the resource requirements are determined by the num-
ber of fusion steps k required to build the cluster and
hence, we calculate the performance of the best cluster
that can be built in k fusion steps. We use the scheme
of Li et al. because it has been shown to be more eﬃ-
cient than the scheme of Varnava et al. [13] at building
clusters [14]. Given all the inline and device losses, we
evaluate the number of photon sources (and detectors)
needed at each repeater node to beat the PLOB bound
at a given total range L between Alice and Bob. We also
prove that given the device losses, there is an optimal
spacing between the repeater nodes (which evaluates to
roughly 1.5 km for a set of system parameters), regardless
of the overall range L.

3

ton sources (to beat the PLOB bound) by 5 orders of
magnitude, while reducing m to 4.
In both these cal-
culations, each source is used only once per clock cycle,
i.e., they are not temporally multiplexed. We prove a
tight analytical lower bound for the performance of our
improved scheme. These performance advances are en-
abled primarily by the following: (1) using boosted fusion
logic that improves the success probability of the BSM
to 75% by using four ancilla single photons [15], (2) em-
ploying a more resource-eﬃcient scheme for creating tree
clusters, building on the work of [13, 14], (3) retaining
all the ancilla photons used for loss protection (i.e., to
mimic a quantum memory) locally at the repeater nodes
in a lossy waveguide, and (4) optimizing the timing of
several single qubit measurements.

We will limit our analysis to include photon losses (dur-
ing the entire ‘lifetime’ of each photon, i.e., from the
time of generation to detection), but will not consider
‘multi-photon’ errors stemming, for instance, from multi-
photon emissions from the source, or detector dark clicks.
We should note however that the error correction scheme
analyzed here also provides some protection against de-
polarizing noise [10], a variant of which arises when one
assumes multi-photon errors, and errors stemming from
imperfect mode matching within the passive linear opti-
cal circuits at the repeater nodes.

The remainder of the paper is organized as follows.
Section II reviews preliminaries and notation used in the
paper. Section III describes our (improved) all-photonic
quantum repeater architecture with a detailed descrip-
tion of each step starting from the creation of the tree
clusters for error-protection, photon transmission, mea-
surements at the repeater nodes, and the measurements
by Alice and Bob, followed ﬁnally by key generation. Sec-
tion IV derives a closed form expression for a lower bound
to the rate-distance envelope (i.e., an achievable rate by
the protocol), which we show (numerically) to match the
true rate-distance envelope extremely closely. Section V
compares our scheme to that of Ref. [10] in terms of
resource requirements and rates, and discusses possible
avenues for further improvement. The concluding sec-
tion VI provides concrete directions for future research
in order to further improve the prospects of a quantum
communication network based solely on ﬂying qubits.

Our second major contribution in this paper is a sig-
niﬁcant improvement to the all-photonic repeater archi-
tecture in [10]—both in terms of the resources required
at each node and the number of parallel optical chan-
nels connecting the neighboring nodes. We ﬁnd that
barely beating the PLOB bound using the all-optical
[10] requires more than 1011 photon sources,
scheme of
at each repeater node for realizing the required opti-
cal cluster states and measurements.
It also requires
m = 104 parallel ﬁber channels connecting neighboring
nodes, even when assuming very optimistic device-loss
parameters. Assuming the same device losses, our im-
proved repeater architecture reduces the number of pho-

II. PRELIMINARIES

In this paper, we will work with dual-rail photonic
qubits, where the logical |0(cid:105) and |1(cid:105) are encoded by a
single photon in one of two orthogonal (spatial) modes.
A photonic cluster state (or, graph state), on a graph
G(V, E) with vertices in set V and edges in set E, can be
constructed by preparing each of the |V | qubits (one sta-
tioned at each vertex) in the state (|0(cid:105)+|1(cid:105))/√2, and ap-
plying |E| controlled-phase operations (a two-qubit uni-
tary gate that applies a pauli Z gate to the second qubit
if the ﬁrst qubit is in the |1(cid:105) state and applies an identity

otherwise) on each pair of vertices that share an edge [16].
The (entangled) quantum state of the |V | qubits thus
obtained is an eigenstate of the |V | stabilizer operators
Xi Πj∈N (i)Zj, where the index i runs over all the ver-
tices, Xi and Zj are Pauli X and Z operators on qubit i
and qubit j respectively, and N (i) is the set of all near-
est neighbor vertices of vertex i. One simple observa-
tion, given that the cluster state is an eigenstate of the
aforesaid stabilizer operators, is that an X measurement
on qubit i, and Z measurements on all but one of the
qubits in N (i), would deterministically reveal what the
outcome of a Z measurement on that unmeasured qubit
in N (i) would have been, even if that unmeasured qubit
had been lost. This realization is at the heart of the
tree-based counterfactual error correction for protection
against photon losses, developed by Varnava et al. [12].
The idea is to attach a tree cluster to each physical pho-
tonic qubit in the graph state that needs to be protected
against qubit loss. One can then deduce the result of any
measurement on that qubit via an appropriate sequence
of measurements on the qubits of the attached tree. The
physical qubit and the qubits of the tree together form
a protected (logical) qubit. We consider regular trees
described by the branching vector (cid:126)b ≡ {b0, b1, . . . , bm},
which signiﬁes that the root of the tree has b0 children
nodes, and each of those nodes have b1 children nodes,
and so on until b0b1 . . . bm nodes at depth m. For such
regular trees used for loss-error protection, one can write
an explicit, yet recursive, expression for the success prob-
ability P of performing an arbitrary single-qubit mea-
surement on the protected qubit [12]. It was shown that
one can push P arbitrarily close to 1 as long as the prob-
ability of losing each photon is less than 1/2. Fig. 1
illustrates how to attach a {3, 2, 2} tree, shown by the
dark (purple) shaded nodes, to a physical qubit of a clus-
ter, shown by light (green) shaded nodes. Note that after
the tree cluster is attached to the physical qubit, X basis
measurements must be performed on the physical qubit
itself and the root node of the tree. These X basis mea-
surements, if successful, create additional edges (shown
in dashed blue in Fig. 1) between each neighboring qubit
of the root node and each neighboring qubit of the phys-
ical qubit, after which the tree-protected logical qubit is
ready to use.

An ideal loss-less photonic cluster state on graph G
is a pure state, |ψ(cid:105)G. A lossy cluster state on G is ob-
tained when all the photonic qubits of |ψ(cid:105)G are transmit-
ted through independent pure-loss beamsplitters each of
transmissivity η. We call 1 − η the loss rate of such a
lossy cluster state. Clearly, the loss rate of |ψ(cid:105)G itself is
0.
Arbitrary photonic cluster states can be prepared—
with non-unity probability—using ideal single photons,
passive linear optics (i.e., beamsplitters and phase
shifters) and single photon detectors [17]. As examples,
in the absence of losses, a two-photon maximally entan-
gled (Bell) state can be prepared with success probability
3/16 [18], whereas a three-photon maximally entangled

4

FIG. 1. Attaching a {3, 2, 2} tree to a node of a photonic
cluster.

(GHZ) state can be prepared with success probability
1/32 [13]. Browne and Rudolph introduced linear-optic
Type I and Type II two-qubit fusion gates, which if suc-
cessful (with probability 1/2), can fuse two cluster frag-
ments into one, according to speciﬁc rules [17]. These
fusion gates, in conjunction with Bell states and GHZ
states, can be used to construct arbitrary cluster states.
The success probability of the fusion gates can be im-
proved to 3/4 if additional (ancilla) single photons are
available to be injected on-demand into an otherwise-
passive linear optical circuit, and if the detectors have
up to two-photon number resolution [15]. We will as-
sume such boosted fusion gates in our all-optical repeater
construction described in this paper.

We will model a lossy single photon source of eﬃ-
ciency ηs as one that emits, on demand, the mixed state
ηs |1(cid:105)(cid:104)1|+(1−ηs)|0(cid:105)(cid:104)0|. We will use ηd for the eﬃciency
of all detectors in the system. We will consider that the
cluster is created on a photonic chip to allow for easier
scalability after which the photons are coupled, with ef-
ﬁciency Pc, to ﬁber with loss coeﬃcient α and speed of
light cf . Pﬀ = e−βτscch will denote the survival proba-
bility of a photon on-chip during one feed-forward step,
where β is the loss coeﬃcient, cch is the speed of light and
τs is the feed-forward time, all on-chip. We will also use
P0 ≡ PGHZPc where PGHZ = ηsηd/(2 − ηsηd) [13] is the
survival rate of the photons that are input into a linear-
optic circuit intended to produce 3-photon maximally-
entangled GHZ states. The ﬁnal measurement step re-
quires feed-forward in ﬁber. The survival probability,
Pﬀ(ﬁb), during feed-forward time in ﬁber, τf , is Pﬀ(ﬁb) =
e−ατf cf . The values for device performance assumed for
the plots that appear later in the paper, are summarized
in Table I.

III. REPEATER ARCHITECTURE

Before we discuss the all-photonic repeater architec-
ture, it is instructive to review a generic quantum re-
peater architecture based on multimode quantum mem-
ories, probabilistic BSMs, and multiplexing over m or-
thogonal modes depicted in Figs. 2(a) and (b), which
was proposed by [8], and analyzed in [9]. Alice and Bob
are separated by optical ﬁber of length L (i.e., end-to-end
transmissivity, η = e−αL), interspersed with n repeater
stations spaced L0 = L/n apart, with Alice and Bob
L0/2 away from the terminal repeaters in the chain.

Each of the n repeater nodes (or,

‘major nodes’),
shown by a gray box, consists of a multimode quantum
memory straddled between sources of m Bell pairs on
its left and another m on its right. Each major node
loads one half of an entangled Bell state onto the mem-
ory, while transmitting the other half towards the middle
of the adjoining elementary link. Each major node does
the above synchronously on every clock cycle. At the
center of each elementary link is a ‘minor node’, shown
as dark-blue-shaded boxes in Fig. 2(b). After the qubits
from the major nodes reach the minor nodes (i.e., after
propagation through a distance L0/2), each minor node,
simultaneously, performs BSMs on each of the m pairs of
qubits received from the repeater nodes on its either side.
The successful BSMs within each elementary link are
shown by thick (green) line segments. Immediately after
the minor node BSMs, each minor node sends back the
information—about which (of the m) modes were suc-
cessfully measured—to its two neighboring major nodes,
on an authenticated classical channel. Upon receipt of
that information, each major node performs a BSM on
two qubits held in its memory that had been entangled
halves of qubits that participated in successful BSMs at
the minor node to the left of that major node, and the
minor node to its right, respectively. Simultaneous with
the minor-node BSMs, Alice and Bob measure, in one of
the two randomly-chosen mutually-unbiased bases, the
m qubits they receive at their respective ends of the ter-
minal half-elementary-link segments (see Fig. 2(b)), and
send the information about which channels generated a
‘click’ on their detectors, back to their respective neigh-
boring major nodes. Finally, each major node sends the
information on whether its BSM succeeded, to Alice and
Bob. Hence, at every clock cycle, with some probability
(i.e., if all the minor nodes heralded at least one success
each, all major node BSMs were successful, Alice and Bob
both detect a photon on at least one of the m channels
each while using the same measurement bases), Alice and
Bob obtain a shared (raw, sifted) bit. A long sequence of
sifted bits is thereafter used to distill a quantum-secure
shared secret via error correction and privacy ampliﬁca-
tion.

The all-optical repeater architecture we will now dis-
cuss builds upon a recent proposal by Azuma et al. [10],
although there are some important diﬀerences, which we
will point out later in Section V. The key idea is to mimic

5

FIG. 2. (a) and (b) show schematics of one elementary link,
and a chain of them connecting Alice and Bob, respectively,
for a repeater architecture that employs quantum memories,
Bell pair sources, probabilistic BSMs, and multiplexing over
m orthogonal modes (parallel channels). (c) depicts the con-
struction of a photonic cluster state that can subsume the
roles of the quantum memory and the Bell pair sources,
thereby resulting in a quantum repeater architecture based
solely on ‘ﬂying’ qubits. The outer (white) photonic qubits
are transmitted on the ﬁber channels, and the inner (black)
qubits are held locally in a (lossy) waveguide at the repeater
node. See text for a detailed description.

a quantum memory (whose goal is essentially to protect
photonic qubits against loss for a certain time duration)
by using the tree cluster approach described in Section II.
The authors of [10] went one step further and subsumed
the functionalities of all the subcomponents of the major
node (the quantum memory as well as the 2m Bell pair
sources) into one single giant optical cluster state, which
we will describe next. Fig. 2(c) illustrates the construc-
tion of this cluster. We start with a depth-2 star cluster
with a degree-2m root node, and 4m + 1 total qubits.
The ‘outer’ qubits, shown as white circles, play an analo-
gous role to the white qubits in Fig. 2(a) that are trans-
mitted to the minor nodes on ﬁber channels. The 2m
‘inner’ qubits, shown as gray circles, are each attached
with a tree cluster of an appropriately-chosen branching
vector (cid:126)b, thereby creating a giant tree cluster. The loss-
protected (logical) inner qubits play a dual role, that of
the black qubits in Fig. 2(a) that are held in the quan-
tum memories locally at the major nodes, and that of

the memories themselves. We make the two X measure-
ments corresponding to each tree appended to the star,
as described in the previous section (i.e., a total of 4m X
measurements). Finally, we make a Y measurement on
the root node of the star, which has an eﬀect of creating
a clique among all the (logical) inner qubits, shown by
black circles in Fig. 2(c). The clique of the 2m logical in-
ner qubits, connected to the 2m outer qubits, forms the
full photonic cluster state that each major node creates
every clock cycle, and sends out the 2m outer qubits (the
white circles) towards the neighboring minor nodes (m to
the left and m to the right) on ﬁber channels. Note that
the ﬁnal cluster state (after the X and Y measurements)
is not a tree.

Each major node is equipped with single photon
sources, reconﬁgurable passive linear optics, and single
photon detectors. The clusters are created using lin-
ear optics and feed-forward [13, 14]. Since the cluster
creation process is probabilistic, the resources (number
of photon sources, detectors, size of linear optic circuit)
must be chosen to ensure a near-unity success probability
of creating the cluster in every clock cycle (see Fig. 5).

The minor nodes are identical to what was described
earlier. The remainder of the protocol proceeds exactly
as described at the beginning of this Section in the con-
text of the memory-based architecture, except for the
following diﬀerence of the action at the major nodes.
When the information about which modes were success-
ful comes back at a major node (from the two neighboring
minor nodes), instead of doing a BSM between a pair of
qubits held in a memory, the major node applies X mea-
surements on the two logical inner qubits corresponding
to the successful modes on either side of the clique, and
makes Z measurements on the remaining 2m − 2 logical
inner qubits (see Fig. 2(c)). The X measurements have
the eﬀect of fusing the successful outer qubits into an en-
tangled chain, and the Z measurements have the eﬀect
of removing the extraneous qubits from the cluster.

So, in any given clock cycle, if the photonic clusters
at each major node are successfully created (which in-
cludes success in performing the 4m X measurements
and one Y measurement), if all the minor nodes herald
at least one BSM success, if the logical (inner) qubits sur-
vive the local storage at the major nodes while the outer
qubits ﬂy to the minor nodes and the classical informa-
tion (about which modes were successful) arrives back, if
the two X measurements and 2m − 2 Z measurements
done to prune the clusters at the major nodes using that
classical information are successful, and if Alice and Bob
get at least one click each while using same measurement
bases, then Alice and Bob obtain a raw sifted shared bit.
In Section IV, we will explicitly calculate this overall suc-
cess probability, and the resulting secret-key generation
rate. As we will see, larger error-protection trees will
aﬀord better rate performance (up to a limit governed
by the device loss rates), but creating larger clusters at
the major nodes will require more resources (sources and
detectors).

6

In Section III A, we will describe in detail the construc-
tion of the clusters at the major nodes using linear optics,
and calculate the success probability. In Section III B, we
will describe how the measurements on the major-node
clusters are done, after the BSMs at the minor nodes,
to stitch together an end-to-end entangled state between
Alice and Bob.

A. Constructing the clusters at the major nodes

The cluster as described above, prepared at each ma-
jor node in every clock cycle, is pieced together by fusing
single photons into progressively larger cluster fragments,
probabilistically, using linear-optic circuits and photon
detectors. The optimal algorithm for create photonic
cluster states using linear optics—in terms of minimizing
the total number of photons consumed and maximizing
the eventual probability of success—is not known even for
a general N -node line cluster. With losses from sources
detectors and waveguides during cluster construction,
ﬁnding the optimal recipe becomes even harder. One de-
sign knob is the number of redundant cluster fragments
attempted at each step. A higher number of attempts
improves the probability of successfully creating the ﬁ-
nal cluster, but with a higher number of required photon
sources and detectors. We will refer to this trick of at-
tempting the creation of multiple identical cluster frag-
ments at each step of the process as multiplexing.

We will describe now the resource counts and success-
probability calculations for two methods to create the
cluster at the major node. The ﬁrst one is a method im-
plied by previous rough estimates of the resource require-
ments [13, 14]. We will then discuss an improved scheme
that decreases the resource requirements during the cre-
ation process. Fig. 4 provides a schematic for these two
schemes, which we will refer to in the discussion below.

FIG. 3. The tree cluster C k (and the ﬁnal cluster C km after
the X and Y measurements), shown in Fig. 2, are created by
a sequence of probabilistic linear-optic fusion-II operations,
starting from 3-photon maximally-entangled (GHZ) states.

Let us label the ﬁnal cluster C km (see Fig. 2) where
the letter m signiﬁes that the Y measurement required

2

1

1

and C k−1

are: C k−2

to turn the inner qubits of the star into a clique (a fully
interconnected graph) and the X measurements required
to connect the error protection trees to the inner qubits
have already been applied. Before these measurements,
the (tree) cluster is labelled as C k. The daughter clusters
that are fused together to create C k will be labelled as
C k−1
. The daughter clusters that are fused
together to create C k−1
1,1 and C k−2
1,2 . The clus-
ters that are fused together to create C k−2
1,2 are: C k−3
1,2,1
and C k−3
1,2,2, and so on (See Fig. 3). At the bottom of the
stack are 3-photon GHZ states, C 0
i with i ≡ i1, i2 . . . , ik,
which are in turn created by groups of 6 photons fed
into linear-optic circuits that generate the 3-photon GHZ
states with probability SGHZ = [ηsηd(2 − ηsηd)]3 /32 [13].
The loss rate of the heralded GHZ states is, 1 − PGHZ
where PGHZ = ηsηd/(2 − ηsηd) [13].
We will assume that the cluster C k can be prepared
in a series of k fusion steps, where at each step, clusters
of roughly equal sizes are fused together, thus roughly
doubling the cluster size in each step [14]. This as-
sumption becomes accurate in the limit of large clusters.
This method ties the ﬁnal size of the intended cluster
(Q = 2k + 2 photons) to the number of fusion steps (k),
and this relationship becomes increasingly exact as k be-
comes large. In other words, we will assume that C l−1
i,1
and C l−1
i,2 are two clusters each of p photons, which when
fused successfully using a fusion-II gate (applied to one
photon each of the above two clusters) creates the 2p− 2
i, i ≡ i1, i2 . . . , ik−l. Starting with the
photon cluster C l
3-photon GHZ states C 0
i1,i2...,ik , the size of C k is 2k + 2
photons. Hence, the minimum number of fusion steps re-
quired to build a Q photon cluster is k = (cid:100)log2(Q − 2)(cid:101).
The label k, the number of fusion-II steps used to arrive
at C k, also translates to the resource requirements, and
the loss rate of each photon in the ﬁnal cluster, as we
show below. Note that k is a function of the branching
vector (cid:126)b of the error-correction trees used. The larger the
error-correction trees, the larger will be the ﬁnal cluster
C k, and the larger will be the number of steps k required
to prepare that cluster.

1. The original multiplexing scheme

Let us now examine the cluster creation process (de-
picted for k = 2 in Fig. 4(a)). At every point we need
the cluster fragment C l
i, we attempt to create nB copies
of that identical cluster (nB = 3 shown in Fig. 4(a)),
of which hopefully one is successfully created and her-
alded for further use. Therefore, creating one usable copy
of C k requires (2nB)k GHZ states C 0
i1,i2...,ik at the bot-
tom of the stack. Each GHZ state is picked from nGHZ
parallel-attempted GHZ states (nGHZ = 4 shown in Fig.
4(a)), and creating each GHZ state requires 6 single pho-
tons. Therefore, creating one usable copy of C k requires
(2nB)k× 6nGHZ single photons. Finally, at the top of the
chain, we create nmeas copies of C k in parallel (nmeas = 4

7

shown), on each of which the 4m X measurements and
one Y measurement are performed, to prepare copies of
the ﬁnal required cluster C km. We choose nmeas such
that we obtain with high probability one successfully-
created copy of C km. Therefore, the total number of sin-
gle photon sources (shown by black dots at the bottom of
Fig. 4(a)) that need to simultaneously ﬁre on every clock
cycle, Ns = 6nGHZ nmeas(2nB)k.

i,2

into C l

and C l−1

succeed with probability SmXY = (cid:0)PGHZP k+1

The probability of successfully creating a GHZ state
C 0
i1,i2...,ik is S0 = 1 − (1 − SGHZ)nGHZ . The success
probability of fusion at the l-th step—i.e., that of com-
bining C l−1
i—is given by SB(l) =
i,1
ﬀ )2/2. The success probability of heralding one
(PGHZP l
cluster C l
i (from the nB parallel copies attempted) is
l−1SB(l))nB ,
given by the recursive formula, Sl = 1−(1−S2
with S0 given as above. The 4m + 1 (X and Y ) measure-
ments required to convert C k to the ﬁnal cluster C km
.
Since this step is multiplexed over nmeas parallel at-
tempts, the success probability of heralding one copy
of the ﬁnal cluster at a major node is given by, Pc1 =
1 − (SB(k)SmXY)nmeas . The success probability of all n
repeater nodes creating the clusters C km locally during
any given clock period, is Pcn = P n
c1. The blue (dashed)
plot in Fig. 5 shows Pcn as a function of Ns for n = 250
repeater stations (major nodes), k = 7, and for device
parameters as given in Table I.

(cid:1)4m+1

ﬀ

2. The improved multiplexing scheme

The improved multiplexing scheme we now describe
addresses the following deﬁciencies of the scheme de-
scribed above.

2 cluster. The C 1

1 cluster and a C 1

• The protocol presented above does not make the
most optimal use of the multiple copies of identi-
cal clusters that are successfully created at a given
step. To illustrate this point, let us consider the
nB = 3 copies of (attempted) C 2 clusters that
are shown in Fig. 4(a), of which one successfully
created C 2 is picked. The ﬁrst of those three at-
tempted C 2 clusters is shown to be created by fus-
ing a C 1
1 is chosen
out of nB = 3 copies of (attempted) C 1
1 clusters, as
shown. If two of those three copies of C 1
1 are ac-
tually successfully created, the second success goes
waste. Note however that the second and the third
(of the three attempted) C 2 clusters will also each
need to be created by fusing a C 1
2 . Those
two C 1
1 clusters will also be picked from nB = 3
copies each of (attempted) C 1
1 clusters (not shown
in the ﬁgure). It is thus simple to see that at each
time step, a total of (nB)k = 9 copies of C 1
1 are at-
tempted, but the selection of successes only happen
within groups of three, which is clearly ineﬃcient.
A far more eﬃcient approach is to maintain one
single “bank” of copies of C 1
1 and similarly one sin-

1 and a C 1

8

FIG. 4. (a) the original multiplexing scheme. A dashed rectangle represents a cluster that has some probability of having been
been created after a probabilistic fusion step (red circle) or at the output of creating GHZ states using linear optics starting
from six single photons (labeled ‘GHZ Factory’). A solid rectangle represents a cluster state that is successfully created with
high probability by choosing a successful outcome (blue square) out of several identical copies attempted (dashed boxes). (b)
the improved multiplexing scheme. A box surrounding clusters of the same type represents a bank of clusters and any operation
applied to the bank is applied to all the clusters in it.

gle bank for copies of C 1
2 , and attempt fusions on
clusters from these two banks pairwise (and throw
away the excess clusters in the bank that has more
copies), to produce a single bank of C 2 clusters.
This way, one does not have to choose the multi-
plexing numbers nB, nGHZ and nmeas, and the total
number of single photons Ns directly translates to
an overall probability of success Pc1 of creating the
ﬁnal cluster C km. In general, we maintain single
banks of each distinct cluster fragment consumed
in the entire stack shown in Fig. 3, and for each fu-
sion step shown in Fig. 3, we apply pairwise fusion
to all cluster copies from the two banks correspond-
ing to the two daughter clusters (and throw away
the excess clusters from the bank that has more).

• The X and Y measurements that were performed

at the very end (on 4m + 1 nodes of the tree cluster
C k, to convert it to the required ﬁnal cluster C km)
can be performed at the very beginning—on the ap-
propriate photons (which would eventually become
those 4m + 1 photons in C k)—while they are still
part of the 3-photon GHZ states, i.e., before any of
the fusion-II operations begin. Making these mea-
surements at the bottom of the stack makes failures
much less costly, which in turn signiﬁcantly reduces
the resource requirements (i.e., the Ns required to
achieve a given ﬁnal success probability Pcn). Ap-
pendix A rigorously explains why these measure-
ments can be done on the photons while they are
still parts of the GHZ states.

• The success probability of each of the fusion-II op-
erations (at all k steps in the cluster creation pro-

Choose success!GHZ Factory!GHZ Factory!GHZ Factory!GHZ Factory!Final Clique!X, Y basis measurements!Fusion II!C2mC2mC2mC2mC2mC2mC2mC2mC2C2C2C2C2C2C2GHZ Factory!GHZ Factory!GHZ Factory!GHZ Factory!GHZ Factory!3 GHZ3 GHZ3 GHZ3 GHZ3 GHZ3 GHZ3 GHZ3 GHZ3 GHZ(a)!(b)!…!C11C12C11C11C11C01,1C01,2C01,1C01,2C01,1C01,2C1m1C1m1C1m2C1m2C1m2C1m2C1m2C1m2C1m2C1m1C1m1C1m1C1m1C0m1,1C0m1,1C0m1,1C0m1,1C0m2,2C0m2,2C0m2,2C0m2,2C0m2,2C0m2,2C0m2,2C0m2,2C0m2,2C02,2C02,2C02,2C02,2C02,2C0m1,1C0m1,1C0m1,1C0m1,1C0m1,1C01,1C01,1C01,1C01,1C01,1C01,2C01,2C01,2C01,2C02,1C02,1C02,1C02,1cess) can be improved from 1/2 to 3/4 by injecting
ancilla single photons [15]. These success proba-
bility numbers diminish with source and detection
ineﬃciencies. But, the cost of using additional pho-
tons needed (as ancillas) to realize these boosted
fusion gates is far outweighed by the eﬀect of the
success-probability improvement, thereby improv-
ing the eﬀective tradeoﬀ between Ns and Pcn.

9

x

1,2, C 0

1,1, C 0

1,1 and C 0

2,1 and C 0

We start with Ns photons and send them all through
GHZ factories, hence attempting the creation of (cid:98)Ns/6(cid:99)
3-photon GHZ states. The number of GHZ states
x successfully created follows a binomial distribution

B(x,(cid:98)Ns/6(cid:99), SGHZ) where B(x, n, p) =(cid:0)n

(cid:1)px(1 − p)n−x.

Hereonafter, let us follow an illustrative set of numbers
for a k = 2 cluster, which is depicted schematically in
Fig. 4(b). Suppose we get x = 18 successfully-created
GHZ states. These GHZ states are now split into 4 banks
corresponding to C 0
2,2. Out of these,
let us say C 0
2,2 consist of photons that would be
eventually measured in C k. As discussed in Appendix A,
these qubits can be measured now. Since the measure-
ment of photons has a success probability Pﬀ PGHZ, the
number of C 0m
1,1 cluster states (x) created as a result of
making measurements on y C 0
1,1 states follows a binomial
distribution B(x, y, Pﬀ ηGHZ). The banks corresponding
to C 0
2,2 are given a fraction 1/(Pﬀ PGHZ) more
GHZ states. Hence, these banks have 5 GHZ states each
whereas the other two have 4 each. Suppose that mea-
1,1 results in 4 copies of C 0m
suring the 5 copies of C 0
1,1 ,
and measuring the 5 copies of C 0
2,2 results in 4 copies of
C 0m
2,2 . The ﬁrst fusion step is now attempted (i.e., fusing
C 0m
1,1 with C 0
2,2 ) resulting in 2
successfully created copies of C 1m
and 3 copies of C 1m
(the maximum possible number of successes in both cases
was 4). In the ﬁnal step, there are 2 fusion attempts from
which we get one copy of the ﬁnal cluster state C 2m.

1,2, and fusing C 0

2,1 with C 0m

1,1 and C 0

1

2

(cid:17)

(cid:0) 1

i is, B

(cid:16)
4 (ηsηd)4(cid:1) [15] and ηB(l) = PGHZP l+1

In general, in a level-l fusion step in Fig. 3, and with y1
and y2 copies in the respective banks of the two daugh-
ter clusters, the distribution of the number x of fused
states C l
B(l) =
η2
B(l)
is the survival rate of photons up to before the lth fusion
step. The success probabilities of this scheme, Pc1 (and
Pcn) are calculated using Monte Carlo simulations.

x, min{y1, y2}, Sim

2 (ηsηd)2 + 1

, where Sim

B(l)

ﬀ

In Fig. 5, we plot the probability Pcn of successfully
building clusters C k (with k = 7), simultaneously at
n = 250 major nodes, for both schemes. nB, nGHZ and
nmeas are optimized for the original scheme to maximize
Pcn for any given Ns. The plot clearly shows that the
improved scheme leads to resource savings by a factor of
∼ 104. We further observe that, for both schemes, Pcn
undergoes a rapid percolation-like transition from zero to
one as Ns is increased beyond a certain threshold value.
Pcn is only a function of k, n, and Ns. We ﬁx Pcn = 0.9
and calculate the corresponding minimum Ns required,
for every value of k and n. This sharp-transition behav-

FIG. 5. The probability that all n = 250 major nodes are
simultaneously successful in creating clusters of size k = 7
fusion steps (i.e., 2k + 2 = 130 photon clusters), using the
original and the improved multiplexing schemes.

ior of Pcn allows us to conveniently split the problem of
designing the repeater architecture into two parts:

(1) choosing an error-protection level by choosing m
(number of parallel channels) and (cid:126)b (the branching vector
of the error protection trees), which gives us k (indicative
of the total cluster size), and using this to calculate the
key rate vs. distance achieved—both with n repeater
stations, and also the resulting envelope over all n; and
(2) given the design choices (m and (cid:126)b), calculating the
number of photon sources Ns so as to achieve a close-
to-unity Pcn (probability that all n nodes create the re-
quired clusters on every clock cycle), for a given value of
k (cluster size at each repeater node), and n (the number
of repeater nodes).

B. Measuring the clusters and connecting the chain

1

2n P k+2

Once the clusters are created, the outer qubits are sent
to minor nodes at the middle of the elementary links, as
shown by the arrows in Fig. 2(c). The outer qubits
are measured in the Bell basis at the minor nodes us-
ing ancilla-assisted boosted fusion gates [15]. The loss
rate seen by the outer qubits is trav ≡ 1 − η
ﬀ P0
where η1/2n is the transmissivity of half of an elemen-
tary link (of range L/2n). All the physical qubits cor-
responding to the inner (logical) qubits are stored lo-
cally in a ﬁber bundle with the same attenuation as the
communication ﬁber between the repeater stations. Due
to the classical-communication delay, the core qubits see
more loss than the outer qubits do, which we deﬁne as
stat = 1− η
ﬀ Pﬀ(ﬁb)P0. However, it is important to
note that, just like in the architecture of [8, 9], this delay
only leads to a latency in the scheme and does not aﬀect
the clock rate of the system.

n P k+2

1

When the result of the BSMs on the m channels at
the two neighboring minor nodes arrive back at a major

NsPcnNumber of photon sources1061081010101210-3010-2510-2010-1510-1010-5100originalimprovednode, the major node picks one successful channel on ei-
ther side (if none of the m BSMs were a success on any
one of the sides, then that time period is an overall fail-
ure). The logical inner qubits corresponding to all the
outer qubits that are not deemed part of the successful
BSMs are removed from the cluster by measuring them
in the Z basis [12] (note that this Z measurement is a log-
ical one, which beneﬁts from the loss-protection trees).
On the two logical qubits (one on either side) correspond-
ing to the successful channels, X basis measurements are
performed, which has an eﬀect of extending the entangle-
ment. Alice and Bob, simultaneous with the minor node
BSMs, detect the m outer photons sent to them by the
ﬁrst and the last major node in the repeater chain, over
links of length L0/2, using one of two randomly-chosen
mutually-unbiased bases. Assuming the clusters at all n
repeater nodes were successfully created (which happens
with probability Pcn), the conditional probability of gen-
erating an end-to-end entangled pair between Alice and
Bob, in one clock cycle, is given by the probability that
all n− 1 minor nodes herald at least one successful BSM,
and all the pruning logical X and Z measurements on
the clusters at all n major nodes are successful, and Al-
ice and Bob both obtain successful detects on at least
one of the m channels:
Pmeas = P 2(m−1)n

X [1 − (1 − PB)m]n−1 P 2

P 2n

end,

(1)

Z

where PX and PZ are the probabilities of successful X
and Z basis measurements on the logical inner qubits,
respectively. Pend is the probability that Alice (resp.,
Bob) obtains at least one successful detection in one of
the m channels.

We quantify the performance of the repeater architec-
ture in terms of the number of shared secret bits gener-
ated per mode (i.e., per clock cycle per spatial channel,
where m is the number of spatial channels employed).
Since, the channel noise comprises of only photon loss,
the success probability divided by the number of chan-
nels per attempt is the bits per mode generated by this
scheme i.e. S = PcnPmeas/m.

IV. RATE CALCULATIONS

In this Section, we will evaluate the secret key bits
generated per mode using the all-optical repeater archi-
tecture described above. We will ﬁrst derive an exact an-
alytical expression for the rate, given the design choices
(m and (cid:126)b), and compare it with the best rate achievable
without the use of quantum repeaters, for some example
values of m and (cid:126)b. A given choice of m and (cid:126)b determines
k, which quantiﬁes the size (2k +2 photons) of the cluster
C k generated at each major node on every clock cycle.
Next, we will choose a value of k, and numerically opti-
mize the choice of m and (cid:126)b (consistent with the chosen
k) that maximizes the rate.

The probabilities of fault-tolerant X and Z measure-
ments on one the (logical) inner qubits on a major node

10

cluster, PX and PZ, can be expressed in terms of the
probabilities Ri of a successful ‘indirect’ Z measurement
(as described in Section II) on a qubit at the i-th level of
the error-protection tree [10, 12]:

PX = R0
PZ = (1 − stat + statR1)b0 ,

(2)
(3)

(4)

where

(cid:2)1 − (1 − stat)(1 − stat + statRi+2)bi+1(cid:3)bi ,

Ri = 1 −
and i ≤ l, Rl+1 = 0, bl+1 = 0.
Let us assume a tree depth of d = 2, i.e., (cid:126)b = [b0 b1],
which is consistent with our numerical ﬁndings on the
optimal branching vector as described later in the pa-
per (see table II). For a depth-2 branching vector, using
Eq. (4), we ﬁnd that R0 = 1 −
and R1 = 1 − b1
(cid:20)

(cid:0)1 − stat)b1+1(cid:1)(cid:3)b0
(cid:21)b0

(cid:17)b1+1
(cid:17)b1+1(cid:21)b0

(cid:2)1 −

(cid:20)
(cid:16)

PX = 1 −

stat. Thus,

Bb1+1

1 −

(cid:16)

, and

(5)

1
n

η

,

(6)

PZ =

1 −

1 − η

1
n B

and the Bell measurement success probability becomes

PB =

1
n ,

η

(7)

where A = m(cid:0) 1

AB2
m

(cid:1)2

2 (ηsηd

+ 1

4 (ηsηd)4)/P 2

ﬀ(ﬁb), B =

P k+2

ﬀ Pﬀ(ﬁb)P0.
The probability of at least one successful detection at

Alice’s (or Bob’s) end is given by

(cid:16)

(cid:17)m

Pend = 1 −

1
2n C

1 − η

,

(8)

where C = P k+2

ﬀ P0.

We now have the bits-per-mode rate achievable with

an n-repeater-node chain,

Sn(L) =

Pcn
m

endP 2(m−1)n
P 2

Z

P 2n

X [1 − (1 − PB)m]n−1 ,

(9)
with PX , PZ, PB and Pend as given in Eqs. (5), (6), (7)
and (8), with η = e−αL the transmissivity of the end-of-
end channel (of range L). See the magenta (dotted) lines
in Fig. 6 for the plots of Sn(L) as a function of L for a few
chosen values of n. To obtain an achievable rate-distance
envelope, we pick the transmissivity (resp., range) value
given by

−nz ln(AB2)

ηn = e

(10)

on the rate-distance function Sn(L), for each n, and eval-
uate the rate-loss function SLB(L) by computing a locus
of the pair (ηn, Sn(− ln(ηn)/α)) over n ∈ {0, 1, 2, . . .},
which by construction is a lower bound to the true en-
velope of the functions Sn(L) over all n. The parameter
z in Eq. (10) is numerically optimized to maximize the
value of the lower-bound envelope SLB(L).

Let us evaluate PX , PZ, PB and Pend at η = ηn
in the respective ex-

pressions), and deﬁne the following quantities:

(i.e., substitute η1/n = (cid:0)AB2(cid:1)−z
(cid:0)AB2(cid:1)−z(b1+1)
(cid:0)AB2(cid:1)−z
(cid:0)AB2(cid:1)−z/2

(cid:104)
(cid:16)
(cid:0)AB2(cid:1)1−z
(cid:16)

pX = 1 −

1 −

pZ =

pB =

1 −
1
m
pend = 1 −

1 −

1 −

, and

(cid:20)

Bb1+1(cid:105)b0
(cid:17)b1+1(cid:21)b0
(cid:17)m

,

C

,

B

, and (11)

(12)

(13)

(14)

using which let us deﬁne the following: C1 = p2(m−1)
p2
X ,
C2 = 1 − (1 − pB)m, and C3 = p2
end. We can now
express Sn(L) evaluated at L = Ln ≡ − ln(ηn)/α
as Sn(Ln) = (C1C2)n C3Pcn
. To obtain the locus of
mC2
(ηn, Sn(− ln(ηn)/α)) over all n, we eliminate n from
Sn(Ln), and the expression of ηn in Eq. 10, and obtain
the following rate-loss envelope lower bound (expressed
as a function of η = e−αL):

Z

SLB(η) = Dηs,

(15)

and the exponent s = − ln(C1C2)

where D = C3Pcn
z ln(AB2) . We
mC2
now numerically optimize the choice of the parameter
z such that the value of the exponent s is minimized
(note that C1, C2 and C3 are functions of z). The re-
peater scheme, even when built with lossy components,
can achieve s < 1. This establishes that the rate achieved
by this repeater architecture scales better with the end-
to-end channel loss than the best possible scaling achiev-
able without the use of quantum repeaters. The rate
corresponding to the PLOB bound, an upper bound to
the best possible key rate achievable without repeaters,
scales as ∝ η, i.e., achieves an exponent s = 1. The value
of the exponent s achievable by the repeater scheme can
be improved (lowered) by enhancing the level of error
correction (i.e., choosing a larger (cid:126)b). Doing so increases
the size of the photonic clusters needed at the repeater
nodes, and hence increases the number of photon sources
Ns required locally at each node.

In Fig. 6, we plot Sn(L) (bits per mode) as a function
of L (in km) for n = 1, 10, 24, 56, 133, and 314 (magenta
dotted plots), with (cid:126)b = {7, 3} trees and m = 4 parallel
channels (which translates to k = 8 clusters at each ma-
jor node), and other device parameters as summarized in
Table I. We also show the analytical rate-envelope lower
bound SLB(L) (black solid line), obtained by choosing
the optimal z numerically. For the numbers chosen, we
get D = 0.23 and s = 0.37. Our lower bound SLB(L)

11

FIG. 6. The key rate (in bits per mode) Sn(L) achieved by an
n-node repeater chain shown as a function of range L, for n =
1, 10, 24, 56, 133, and 314 (magenta dotted plots). Our analyt-
ical lower bound to the rate-distance envelope SLB(L) (black
solid plot) is indistinguishable for the numerically-obtained
rate-distance envelope, which are shown to be very close to
one another in the ﬁgure inset. For all the rate-distance plots,
we choose m = 4 parallel channels and (cid:126)b = {7, 3} error-
protection trees (which translates to k = 8 clusters). The
PLOB bound is shown for comparison (blue dashed plot).

is seen to be remarkably close to the true rate-distance
envelope, and the bound remains an excellent approxi-
mation to the rate-distance envelope for all parameters
we tried. For the plots in Fig. 6, the maximum deviation
of SLB(L) from the envelope is 0.09% (at n = 1), and
the deviation is less than 0.005% for L > 32 km. This
close agreement of the analytical lower bound to the true
envelope suggests that the ansatz in Eq. 10 is a very good
approximation.
One implication of ηn = (AB2)−nz lying on the rate-
distance envelope is that the distance between each re-
peater (major) node,

L0 ≡

L
n

=

ln(AB2)

α

(16)

is a constant and independent of the total range L. In
other words, given the device parameters and the choice
of the major-node cluster size (i.e., m and (cid:126)b), there is an
optimal gap with which repeaters should be placed—no
more, and no less. For the numbers used for the plots in
Fig. 6, L0 = 1.49 km. Fig. 6 also shows the PLOB bound
for comparison (blue dashed plot), which the repeater
scheme is seen to outperform beyond a range of 64 km.

L (km)02004006008001000Bits per mode S10-810-610-410-2100L (km)198.002198.004198.006198.008#10-38.15788.1588.15828.15848.15868.15888.159Device parameter

ﬁber loss coeﬃcient

silicon loss coeﬃcient

feed-forward time in ﬁber
feed-forward time in silicon

chip to ﬁber coupling eﬃciency

source detector eﬃciency product

speed of light in ﬁber
speed of light on chip

symbol value

α

β

τf
τs
Pc
ηsηd
cf
cch

km−1
0.046
(0.2 dB/km)
0.62 m−1 (2.7
dB/m)
102.85 ns
20 ps
0.99
0.99
2 × 108m/s
7.6 × 107m/s

TABLE I. Assumed values for device performance parameters.
The source detector eﬃciency product ηsηd is suﬃcient for
the purposes of the calculations in this paper, and need not
be speciﬁed separately. Recall that Pﬀ = e−βτscch , Pﬀ(ﬁb) =
e−ατf cf , and P0 = ηsηdPc/(2 − ηsηd). τf has been chosen to
make Pﬀ = Pﬀ(ﬁb).

V. DISCUSSION

In this Section, we will go back to the all-photonic re-
peater architecture proposed by Azuma et al. [10], and
discuss the main modiﬁcations (improvements) we con-
sidered in the architecture we described and analyzed
above. We will also show a comparative study of the
resource requirements and rate performance of the orig-
inal scheme and our modiﬁed scheme. Following are the
salient diﬀerences between the architecture we analyzed
above, and the one proposed in [10].

Retaining vs.

transmitting the clusters—In the pro-
posal of [10], all the logical inner qubits, along with the
outer qubits (i.e., all the 2k +2 photons of the cluster at a
major node) are sent to the minor node, whereas we store
the inner qubit photons in a ﬁber spool locally at the ma-
jor nodes. The former has an advantage that no classical
communication needs to happen from minor nodes back
to major nodes before the logical X and logical Z mea-
surements are done to the logical inner qubits, since all
those qubits are present locally at the minor nodes when
the BSMs are performed there on outer-qubit pairs from
neighboring major node clusters. The advantage of our
(latter) scheme is that the number of parallel channels
needed (m) is much smaller as compared to the number
needed (2k−1 + 1) for the scheme in [10]. For the num-
bers in Fig. 6, that is 4 as opposed to 104 parallel ﬁber
channels connecting successive repeater nodes.

Diﬀerence in the bits-per-mode rate—Further, the bits
per mode achieved by the architecture in [10] would
be given by PcnPmeas/(2k−1 + 1), whereas the bits per
mode achieved by our modiﬁed architecture would be
PcnPmeas/m. The Pmeas of the former is higher (due to
lower loss incurred by the photons of the logical inner
qubits of the clusters as they do not need to wait in a
lossy ﬁber spool while waiting for the classical informa-
tion to ﬂy back from the minor nodes). However, the
other improvements described below more than compen-
sate for the better Pmeas, and the latter scheme achieves

12

a far better bits-per-mode performance (see Fig. 7).

Linear optic vs. boosted linear optic fusion gates—We
propose the use of the improved Bell-state measurement
scheme of Ewert et al. [15] that inject four single pho-
tons to boost the success probability of the fusion-II gate.
Our calculations show that the cost of using these addi-
tional ancilla photons is far outweighed by the eﬀect of
the improved success probability, in the performance of
the repeater architecture, despite assuming lossy sources
and detectors.

Improved multiplexing scheme for cluster generation—
We use an improved multiplexing scheme to create the
clusters at the major nodes, as described in Section III A
and depicted in Fig. 4(b). Previous studies have esti-
mated the resource requirements for cluster generation
based on the average number of attempts required for
each probabilistic steps [13, 14]. However, in order to
generate the required cluster at every repeater station
on every clock cycle with high probability, the resources
required at each repeater station need to be greater than
the number that would allow for cluster creation “on av-
erage”. To our knowledge, this is the ﬁrst study that
explicitly looks at how probabilistic operations need to
be multiplexed in a real system.

Pushing

the measurements ahead during

cluster
creation—The single qubits measurements that do not
depend on the outcomes of Bell measurements at the mi-
nor nodes, are performed before the fusion operations,
directly on the photons of the GHZ states, very early
during the cluster creation process.

Let us now see what the above modiﬁcations to the
architecture does to the rate performance. The bits-per-
mode rates for the original and the improved schemes
are plotted in Fig. 7(a) and (b), respectively. We as-
sume device loss parameters as listed in Table I for both
sets of plots. In each plot, we compute the rate-distance
performance (envelopes taken over n, the number of re-
peater nodes) for four diﬀerent error-protection levels
(i.e., k = 7, 8, 9, and 10). For every point on each rate-
distance envelope, m and (cid:126)b are optimally chosen (con-
sistent with the given k). Each rate-distance plot ex-
hibits the Dηs = De−sαL behavior, and the exponent
s diminishes as a higher k is chosen. For the original
scheme, the minimum k for which the repeater can beat
the PLOB bound (pink-dashed line) is k = 8 and the
optimized clusters at the major nodes have 192 photons
each. Hence, the scheme would require 104 parallel ﬁber
links connecting successive nodes. In comparison, in the
improved scheme, k = 7 is suﬃcient to beat the PLOB
bound, and requires m = 4 parallel ﬁber links. The op-
timal tree depth, for this k = 7 rate plot is found to be
d = 2, which is consistent with the analytical develop-
ment in Section IV.

Table II lists, at a range of L = 300 km, and for each
of the cases (k = 7, 8, 9, 10), the optimal values of m
for the original (morig) and new schemes (mnew), the op-
timal branching vector for the original ((cid:126)borig) and new
schemes ((cid:126)bnew), and the number of parallel ﬁber links

13

The original scheme requires 1.9× 1011 photon sources at
each major node, while the new scheme requires 3.3×106
sources, an improvement of 5 orders of magnitude (see
Fig. 5).

Given the size of the earth, for terrestrial long dis-
tance communications, it is useful to quantify the per-
formance of our (improved) all-optical repeater scheme
at say 5000 km. Without quantum repeaters, the best
QKD protocol realized with ideal devices cannot exceed

Our all-optical repeater scheme, with 954-photon clus-
ters (k = 10) at each repeater node can attain a key rate

a key rate of 2.9 × 10−99 bits per mode at this distance.
of 1.6 × 10−2 bits per mode using m = 9 parallel chan-

nels and n = 12411 repeater nodes, which translates to
a 144 kHz key generation rate assuming a 1 MHz repe-
tition rate. If we employed 518-photon clusters (k = 9)

instead, the rate achieved would only be 7.9 × 10−8 bits

per mode using m = 10 parallel channels and n = 12255
repeater nodes. The number of photon sources required
at a repeater node to create the required clusters (us-
ing linear optics) for the above two example cluster-size
constraints are 1.2 × 108 and 3.6 × 107, respectively.
In the presence of losses in the waveguide, there is a
maximum sustainable size of the clusters at the major
nodes, at least for the error protection methods described
in this paper. A larger cluster requires a greater creation
time and hence, each photon in the cluster sees a larger
eﬀective loss rate (stemming from the P k
ﬀ term in trav
and stat). Since the error correction scheme has a maxi-
mum loss tolerance of 50%, there is a maximum size of the
clusters that can be created and thus a maximum level of
error protection that a qubit can have. So, given a set of
device losses, increasing the error protection level (viz.,
k) cannot indeﬁnitely improve the rate performance.

The aforesaid detrimental eﬀect of loss with an increas-
ing cluster size has more serious implications for linear
optical cluster state quantum computing (CSQC) in gen-
eral, using only tree-based counterfactual error correc-
tion [12]. This is because a polynomial scaling of the
number of photon sources (with the size of the cluster) is
required in the asymptotic limit for the CSQC scheme to
be scalable. The failure probability of every qubit needs
to decrease exponentially with the size of the computa-
tion. Hence, the level of protection of each qubit must
increase with the size of the problem, which implies a
greater cluster creation time and hence a greater loss rate.
Since there is a 50% ceiling on the tolerable photon loss,
it is not possible to achieve the required level of pro-
tection for arbitrarily large computations, as discussed
above for the case of an all-photon quantum repeater.
Developing a scalable method for creation of arbitrarily
large clusters in constant time would solve this problem
and will also allow for a polynomial scaling of the num-
ber of photons with computation size. A recent paper
proposes using counterfactual error correction to fault-
tolerantly create surface code data qubits [14]. However,
the resource requirements for this scheme are found to
be extremely high.

FIG. 7. Scaling of the bits per mode as a function of distance
L for diﬀerent numbers of fusion steps k for the (a) original
scheme and (b) with the improvements of this paper. The
PLOB bound is the pink dashed line. Q = 2k + 2 is the total
number of photons in the cluster at each repeater station.

needed in the original scheme (Norig). In the case of the
new scheme, the number of parallel ﬁber links needed is
simply mnew.

k morig Norig (cid:126)borig mnew (cid:126)bnew
{4, 2}
7
{5, 3}
8
{7, 4}
9
{10, 5}
10

{3, 2}
50
104 {4, 2}
231 {5, 3}
432 {7, 4}

5
8
11
12

4
5
6
8

TABLE II. For k = 7, 8, 9, and 10, at L = 300 km range, morig
and mnew are the optimal values of m for the original and new
schemes respectively. (cid:126)borig and (cid:126)bnew are the optimal values of
(cid:126)b for the original and new schemes respectively. Norig is the
corresponding number of parallel ﬁber links needed between
successive repeater nodes in the original scheme. For the new
scheme, the number of parallel links is mnew.

Let us now compare the resources (number of photons,
Ns) required to build the major node clusters, for the
respective cases that can (barely) beat the PLOB bound.

L (km)0100200300400500Bits per mode S10-810-610-410-2100k = 79810PLOBL (km)0100200300400500Bits per mode S10-810-610-410-2100k = 78910PLOB(a) (b) VI. CONCLUSIONS

In conclusion, we have performed a rigorous analysis
of the resource requirements, and the achievable secret
key rates of an all-optical repeater scheme that improves
upon a recent proposal [10], while taking into account
all the losses in the system. While the all-optical re-
peater proposal of [10] presents an important conceptual
advancement, we show that it is not practically feasi-
ble given its astronomical resource requirements, both
in terms of the number of photon sources and detectors
needed at each repeater node, as well as the number of
parallel optical ﬁber channels that must connect succes-
sive repeater nodes. Our scheme improves the practical-
ity immensely in both of the aforementioned metrics, as
well as the actual rate-vs.-distance performance achieved.
In particular, the number of photon sources required at
each node is reduced by 5 orders of magnitude, and the
number of parallel channels between repeater nodes re-
quired to beat the performance of a direct-transmission
QKD scheme is brought down from more than a hundred,
to 4. These results suggest that further theoretical im-
provements on quantum photonic fault tolerant schemes
may further improve the performance of all-optical quan-
tum repeaters, as well as other applications of all-optical
quantum processing. One of our major contributions in
this paper was to rigorously prove that the rate-loss scal-
ing by the aforementioned genre of all-optical quantum
repeaters with a ﬁxed cluster size is given by Dηs bits per
mode, where D and s are constants that are functions of
various device loss parameters, and that of design choices
made (to choose the level of error protection). The fact
that it is possible to achieve a value as the exponent s < 1
proves the fact that this scheme can outperform the key
rates attainable by any QKD protocol that does not em-
ploy quantum repeaters, the rate performance of which
are upper bounded by the PLOB bound, whose linear
rate-transmittance decay implies s = 1.

In future work, it will be interesting to incorporate
more realistic eﬀects into the resource-performance trade-
oﬀ calculations of all-optical repeaters,
in particular
mode-mismatch errors in the passive interferometric ma-
nipulations on the photons held locally at the repeaters,
and multi-photon errors arising from imperfect sources
and noisy detectors. Finally, it would be instructive to
analyze and compare other forms of quantum repeater
architectures, especially forward-error-corrected one-way
transmission schemes [7], realized only with ﬂying pho-
tons, linear optics and detectors, but no quantum mem-
ories.

ACKNOWLEDGMENTS

This research was funded by the DARPA project Scal-
able Engineering of Quantum Optical Information Pro-
cessing Architectures (SEQUOIA), under US Army con-
tract number W31P4Q-15-C-0045 and by the Air Force

14

Oﬃce of Scientiﬁc Research MURI (FA9550-14-1-0052).
We would like to thank Sreraman Muralidharan, Liang
Jiang, Darius Bunandar, Koji Azuma and Hoi-Kwong Lo
for helpful discussions.

Appendix A: Re-ordering measurements in the

cluster-creation process

In this Section, we explain why the X measurements
required to attach trees for counterfactual error cor-
rection and the Y measurement required to create the
“clique” from the “star” cluster can be applied before
the fusion operations. This makes the cluster creation
process more eﬃcient. The reordering of the operations
is depicted in Fig. 8. Thin lines here represent pho-
tonic qubits, thick lines represent feed-forward opera-
tions, boxes labelled X, Y , Z, and H represent single
qubit X, Y , Z rotations, and Hadamard gates respec-
tively, and boxes labelled MX , MY , and MZ represent
measurement in the X, Y , and Z bases, respectively.

FIG. 8. Explanation of why single qubit measurements can
be applied before fusion operations

First, we show some results regarding re-ordering of
single qubit measurements and rotations. In the left side
of Fig. 8(a), the unitary operation U on qubit c is con-
ditioned on the result of an X or Y basis measurement
on qubit b (that is determined beforehand). In addition,
there is a conditional operation Z i on the qubit b which
depends on a feed-forward signal from a diﬀerent part of
the circuit, which in this case is the result of measure-
ment MA on qubit a. The application of a Z gate before
X or Y measurement simply has the eﬀect of ﬂipping
the result of the measurement. Hence, the measurement
MX/Y can be performed before MA and the feed-forward
result of MA can simply be used to ﬂip the result of MX/Y
as shown on the right side of Fig. 8(a). The system in
Fig. 8(b) is identical to the system in Fig. 8(a) except

Zi!MX/Y!U!U!MA!=!Zi!MZ!U!MZ!MA!=!MX/Y!U!H!MX!=!MZ!H!MZ!=!MX!H!MY!=!M-Y!MA!Zo!Zp!Zq!Zl!Zm!Zn!Zi!Zj!Zk!H!H!H!H!MX!MX!MY!U1!U2!Zr!Zt!Zv!Zs!Zu!Zw!MZ!MY!U1’!MX!GHZ factories!GHZ factories!U2’!=!Single photons!H!H!Bell measurements!Ancillas!Bell measurements!Final Cluster!(a)!(b)!(c)!(d)!a!b!c!a!b!c!15

for the fact that measurement in the X/Y basis is re-
placed by measurement in the Z basis. Since application
of a Z rotation does not inﬂuence the outcome of the Z
measurement, the Z gate and the associated feed-forward
can be removed entirely. In Fig. 8(c), we depict that a
Hadamard gate followed by an X basis measurement is
equivalent to a Z basis measurement, a Hadamard gate
followed by a Z basis measurement is equivalent to an X
basis measurement, and a Hadamard gate followed by a
Y basis measurement is equivalent to a Y basis measure-
ment with the result ﬂipped.

We now use these results to show how measurements
can be pushed earlier in the cluster creation process at
the major nodes. The left side of Fig. 8(d) shows the
system with measurements applied after the fusion oper-

ations. Single photons that are sent through GHZ facto-
ries to create 3-photon GHZ states, which are then fused
using Bell measurements using ancilla photons. The sur-
viving photons require some Hadamard and conditional
Z rotations as part of the controlled-phase and parity-
projection operations [14]. Finally, some of the surviving
photons require X and Y basis measurements, the results
of which are fed forward to photons in the ﬁnal “clique”
cluster. As shown in Fig. 8(a), (b) and (c), measurements
in the Pauli basis can be pushed in front of Hadamard
and conditional Z rotations by simply moving to a diﬀer-
ent Pauli basis or ﬂipping the result of the measurement
result. Hence, the system is equivalent to the right side
of Fig. 8(d) in which single qubit Pauli measurements are
applied before the fusion operation.

[1] M. Takeoka, S. Guha, and M. M. Wilde, Nature com-

(2015).

munications 5, 5235 (2014).

[10] K. Azuma, K. Tamaki, and H.-K. Lo, Nature communi-

[2] S. Pirandola, R. Laurenza, C. Ottaviani, and L. Banchi,

cations 6, 6787 (2015).

(2015), arXiv:1510.08863.

[11] M. Varnava, D. E. Browne, and T. Rudolph, New Jour-

[3] S. Pirandola, R. Garc´ıa-Patr´on, S. L. Braunstein, and

nal of Physics 9, 203 (2007).

S. Lloyd, Physical review letters 102, 050503 (2009).

[12] M. Varnava, D. Browne, and T. Rudolph, Physical Re-

[4] H.-J. Briegel, W. D¨ur, J. Cirac, and P. Zoller, Physical

view Letters 97, 120501 (2006).

Review Letters 81, 5932 (1998).

[13] M. Varnava, D. E. Browne, and T. Rudolph, Physical

[5] C. H. Bennett, G. Brassard, C. Cr´epeau, R. Jozsa,
A. Peres, and W. K. Wootters, Physical Review Letters
70, 1895 (1993).

Review Letters 100, 060502 (2008).

[14] Y. Li, P. C. Humphreys, G. J. Mendoza, and S. C. Ben-

jamin, Physical Review X 5, 041007 (2015).

[6] C. Bennett and S. Wiesner, Physical review letters 69,

[15] F. Ewert and P. van Loock, Physical Review Letters 113,

2881 (1992).

140403 (2014).

[7] S. Muralidharan, L. Li, J. Kim, N. L¨utkenhaus, M. D.

[16] R. Raussendorf and H. J. Briegel, Physical Review Let-

Lukin, and L. Jiang, (2015), arXiv:1509.08435.

ters 86, 5188 (2001).

[8] N. Sinclair, E. Saglamyurek, H. Mallahzadeh, J. A.
Slater, M. George, R. Ricken, M. P. Hedges, D. Oblak,
C. Simon, W. Sohler, and W. Tittel, Physical review
letters 113, 053603 (2014).

[9] S. Guha, H. Krovi, C. A. Fuchs, Z. Dutton, J. A. Slater,
C. Simon, and W. Tittel, Physical Review A 92, 022357

[17] D. E. Browne and T. Rudolph, Physical Review Letters

95, 010501 (2005).

[18] Q. Zhang, X.-H. Bao, C.-Y. Lu, X.-Q. Zhou, T. Yang,
and J.-W. Pan, Physical Review A 77,

T. Rudolph,
062316 (2008).

