6
1
0
2

 
r
a

 

M
4
1

 
 
]

C
S
.
s
c
[
 
 

1
v
5
8
2
4
0

.

3
0
6
1
:
v
i
X
r
a

Summation Theory II: Characterizations of
RΠΣ∗-extensions and algorithmic aspects

Carsten Schneider

Research Institute for Symbolic Computation (RISC)

Johannes Kepler University Linz

Altenbergerstraße 69, 4040 Linz, Austria

Abstract

Recently, RΠΣ∗-extensions have been introduced which extend Karr’s ΠΣ∗-ﬁelds substantially:
one can represent expressions not only in terms of transcendental sums and products, but one
can work also with products over primitive roots of unity. Since one can solve the parameterized
telescoping problem in such rings, covering as special cases the summation paradigms of tele-
scoping and creative telescoping, one obtains a rather ﬂexible toolbox for symbolic summation.
This article is the continuation of this work. Inspired by Singer’s Galois theory of diﬀerence
equations we will work out several alternative characterizations of RΠΣ∗-extensions: adjoining
naively sums and products leads to an RΠΣ∗-extension iﬀ the obtained diﬀerence ring is simple
iﬀ the ring can be embedded into the ring of sequences iﬀ the ring can be given by the interlacing
of ΠΣ∗-extensions. From the viewpoint of applications this leads to a fully automatic machin-
ery to represent indeﬁnite nested sums and products in such RΠΣ∗-rings. In addition, we work
out how the parameterized telescoping paradigm can be used to prove algebraic independence
of indeﬁnite nested sums. Furthermore, one obtains an alternative reduction tactic to solve the
parameterized telescoping problem in basic RΠΣ∗-extensions exploiting the interlacing property.

Key words: diﬀerence ring extensions, roots of unity, indeﬁnite nested sums and products,
simple diﬀerence rings, diﬀerence ideals, constants, interlacing of diﬀerence rings, embedding
into the diﬀerence ring of sequences, Galois theory

1.

Introduction

The foundation of the diﬀerence ﬁeld approach was led in [24,25]. Karr’s summation
algorithm enables one to solve the parameterized telescoping problem within a given ra-
tional function ﬁeld F in which indeﬁnite nested sums and products are represented by
variables and the shift-behaviour of the objects are modelled by a ﬁeld automorphism

⋆ Supported by the Austrian Science Fund (FWF) grant SFB F50 (F5009-N15).

Email address: Carsten.Schneider@risc.jku.at (Carsten Schneider).

Preprint submitted to Elsevier

15 March 2016

σ : F → F. As observed in [42] Karr’s algorithms covers also the creative telescoping
paradigm of deﬁnite summation [63]. Various improvements and extensions of such a
diﬀerence ﬁeld (F, σ), also called a ΠΣ∗-ﬁeld, have been incorporated into a strong sum-
mation theory within the last 15 years. These signiﬁcant reﬁnements enable one to ﬁnd
optimal product and sum representations by minimizing the nesting depth [45,50,53], by
minimizing the number of sums arising within the summand [44,56], or minimizing the de-
gree of the sums and products arising in the summands and multiplicands [6,35,46,48,9].
A central drawback of this ﬁeld approach is the lack to treat the alternating sign (−1)n
which is one of the central building blocks in many summation problems. This object,
and more generally αn with a primitive root of unity α, cannot be treated in a ﬁeld or an
integral domain: zero-divisors such as (1−(−1)n)(1+(−1)n) = 0 are introduced. In order
to overcome this vulnerability, a new diﬀerence ring theory has been elaborated [57,55].
The so-called RΠΣ∗-extensions have been introduced in which indeﬁnite nested sums
and products together with (α)n can be represented and in which the parameterized
telescoping problem can be solved by eﬃcient algorithms.

The aim of this article is twofold. First, we will provide new insight in the theory of
RΠΣ∗-extensions. In particular we will gain important characterizations and structural
theorems for RΠΣ∗-extensions. Second, we will emphasize the algorithmic nature of these
results in order to push forward the symbolic summation approach of diﬀerence rings.
Here we will restrict to the so-called basic RΠΣ∗-extension [57,55]. More precisely, we
start with a diﬀerence ﬁeld (F, σ) (e.g., any of Karr’s ΠΣ∗-ﬁelds) with the set of constants
K = const(F, σ) = {c ∈ F|σ(c) = c}. Then we extend this ﬁeld to a diﬀerence ring (E, σ)
by a tower of ring extensions of the following form (see Prop. 2.10 below):
• algebraic ring extensions (A-extensions) which introduce objects of the type αn with

α ∈ K being a root of unity;

• product extensions (P -extension) which introduce nested products in terms of Laurent
polynomials where the multiplicands are invertible and the multiplicands are free of
the deﬁning generators of A-extensions;

• sum extensions (S-extensions) which introduce nested sums in terms of polynomials.

Such a tower of extensions will be also called a basic AP S-extension. Finally, we impose
that during the construction the constants remain unchanged, i.e., (E, σ) = {c ∈ E|σ(c) =
c} = K. Precisely, this class of extensions will be called a basic RΠΣ∗-extension.

We will supplement the diﬀerence ring theory of [57] with the following alternative
characterizations of a basic RΠΣ∗-extension under the assumption that (F, σ) is constant-
stable (see Deﬁnition 2.18). More precisely, for a given tower of basic AP S-extensions
(E, σ) over the ground ﬁeld (F, σ) the following statements are equivalent:

(1) It forms a basic RΠΣ∗-extension, i.e., const(E, σ) = const(F, σ).
(2) (E, σ) is simple, i.e., any ideal of E which is closed under σ is either E or {0}.
(3) (E, σ) can be composed by the interlacing of ΠΣ∗-extensions.
(4) (E, σ) can be embedded into the ring of sequences provided that (F, σ) can be

embedded into the ring of sequences.

We emphasize that similar statements have been derived in the setting of Picard-
Vessiot rings in [58]; see also [21]. However, much stronger assumptions are imposed in
this setting, like assuming that the constant ﬁeld K is algebraically closed or that the
algebraic closure of the ground ﬁeld F can be embedded into the ring of sequences. Both
avenues, the Picard-Vessiot approach [58] and the basic RΠΣ∗-approach, cover the class

2

of d’Alembertian solutions [8,10], the ﬁrst approach with a very general and abstract
viewpoint and the latter one with a very algorithmic viewpoint. In other respects, they
complement each other non-trivially: Picard-Vessiot rings can represent all the solutions
of linear homogeneous recurrence relations, which is not possible by RΠΣ∗-extensions,
and vice versa, basic RΠΣ∗-extensions can represent, e.g., nested products, which cannot
be formulated in Picard-Vessiot rings.

The worked out machinery for the embedding of basic RΠΣ∗-extensions into the ring
of sequences is algorithmically. It has been implemented within the summation package
Sigma [49,54] and provides a solution to the following problem: given an expression in
terms of nested sums and products, ﬁnd an alternative expressions such that the arising
sums and products (up to root of unity products) are algebraically independent among
each other. This toolbox produces very compact representations of nested sum expres-
sions and plays a central role for large scale calculations in particle physics; see [1] and
references therein. Moreover, following the ideas of [51] we will show that the parameter-
ized telescoping problem enables one to show the algebraic independence of sums whose
summands are expressible within an RΠΣ∗-extension. Finally, exploiting the interlacing
property of an RΠΣ∗-extension we will present a new reduction technique that solves
the parameterized telescoping problem in an RΠΣ∗-extension or in its quotient ring.

The outline of the article is as follows. In Section 2 we will introduce basic AP S-
extensions and RΠΣ∗-extensions. In addition, we summarize the crucial (algorithmic)
properties of RΠΣ∗-extensions introduced in [57], and we present simple criteria to verify
if an A-extension is an R-extensions. The above equivalences between (1)–(4) are shown in
Sections 3–5, respectively. Finally, the applications mentioned in the previous paragraph
will be worked out in Sections 6 and 7. A conclusion is given in Section 8.

2. Deﬁnitions and basic properties of AP S- and RΠΣ∗-extensions

In this article will use a ring A to represent the given summation objects and we
will utilize a diﬀerence ring automorphism σ : A → A to model the shift behaviour of
the summation objects by acting appropriately on the ring elements. In this regard, the
following conventions and deﬁnitions will be used throughout this article.
• Basics: Z and N = {0, 1, 2, . . . } denote the set of integers and non-negative integers.
• Rings: All rings (resp. ﬁelds) contain the rational numbers as a subring (resp. subﬁeld).
A∗ is the set of units which forms multiplicatively a group. Q(A) denotes the quotient
ring. If A is integral, Q(A) is the quotient ﬁeld of A. For a ring element f ∈ A[z] (z
transcendental or algebraic over A) and a ∈ A[z] we write f (a) = f |z→a.
• Diﬀerence rings: A diﬀerence ring (resp. ﬁeld) (A, σ) is a ring (resp. ﬁeld) equipped
with a ring (resp. ﬁeld) automorphism σ : A → A. In this regard, the set of constants

K = const(A, σ) = {c ∈ A|σ(c) = c}

plays a central role. Note that K forms a subring of A. In particular, it is a subﬁeld of A
if A is a ﬁeld. Moreover, observe that Q is always contained as a subring (resp. subﬁeld)
in K (since we assume that Q is contained in A).
• Extensions: For the construction of diﬀerence rings (resp. ﬁelds) we need the concept of
diﬀerence ring (resp. ﬁeld) extensions. A diﬀerence ring (resp. ﬁeld) (E, σ′) is a diﬀerence
ring (resp. ﬁeld) extension of (A, σ) if A is a subring (resp. subﬁeld) of E and σ′|A = σ,
i.e., σ′(f ) = σ(f ) for all f ∈ A. Since σ and σ′ agree on A, we do not distinguish between

3

them anymore. Note that (A, σ) is a diﬀerence ring (resp. ﬁeld) extension of (K, σ).
• Ideals: Let (A, σ) be a diﬀerence ring. An ideal in A generated by the elements
f1, . . . , fr ∈ A is denoted by hf1, . . . , fri = {h1 f1 + · · · + hr fr|h1, . . . , hr ∈ A}; we
set h i = {0}. An ideal I in A is maximal if there are no other ideals contained between I
and A. I is a diﬀerence ideal in (A, σ) if for any f ∈ I we have that σ(f ) ∈ A. I is called
reﬂexive if also σ−1(f ) ∈ I holds for all f ∈ I. Clearly, A/I forms a ring. Note that for
a given reﬂexive diﬀerence ideal I we obtain a ring automorphism σ′ : A/I → A/I by
deﬁning σ′(a + I) = σ(a) + I for all a ∈ A. A diﬀerence ring (A, σ) is simple if there is
no diﬀerence ideal I in A, except I = {0} and I = A.
• Embeddings: A diﬀerence ring homomorphism τ : A1 → A2 between two diﬀerence rings
(A1, σ1) and (A2, σ2) is a ring homomorphism such that τ (σ1(f )) = σ2(τ (f )) holds for
all f ∈ A1. If τ is injective, we call τ a diﬀerence ring monomorphism or a diﬀerence ring
embedding. In this case, (A2, σ) is a diﬀerence ring extension of (τ (A1), σ) where (A1, σ)
and (τ (A1), σ) are the same up to the renaming of the objects with τ . If τ is bijective, τ
is also called a diﬀerence ring isomorphism and we say that the diﬀerence rings (A1, σ)
and (A2, σ) are isomorphic; in short we also write (A1, σ) ≃ (A2, σ).
For further details on these notions and properties we refer to [19,30].

In Subsection 2.1 we will present AP S-extensions to rephrase indeﬁnite nested sums
and products in diﬀerence rings. In order to obtain a precise description, we will in-
troduce the subclass of RΠΣ∗-extensions in Subsection 2.2, and we will restrict this
class further to basic RΠΣ∗-extensions in Subsection 2.3. In this latter class there are
algorithms available [57] which can be used to construct such a tower of extensions au-
tomatically. We remark that this class covers all the types of nested sums and products,
like [14,59,3,31,4,2], that we have encountered for practical problem solving so far. Some
further basic properties of A-extensions will be elaborated in Subsection 2.4 that will be
used for further considerations.

2.1. AP S-extensions

We start with S-extensions and P -extensions that enable one to represent iteratively
sums and products in a naive way. Let (A, σ) be a diﬀerence ring (in which we deﬁned
already sums and products by previous extensions). Now let β ∈ A and take the ring of
polynomials A[t] (i.e., t is transcendental over A). Then there is a unique diﬀerence ring
extension (A[t], σ) of (A, σ) with σ(t) = t+β. Such an extension is called a sum-extension
(in short S-extension); the generator t is also called an S-monomial.
Similarly, take a unit α ∈ A∗ and take the ring of Laurent polynomials A[t, 1
t ] (i.e., t
is transcendental over A). Then there is a unique diﬀerence ring extension (A[t, 1
t ], σ)
of (A, σ) with σ(t) = α t. Such an extension is called a product-extension (in short P -
extension); the generator t is also called a P -monomial.
Of special interest is the case when A is a ﬁeld and A(t) is a rational function ﬁeld (i.e.,
t is transcendental over A). Let α ∈ A∗ and β ∈ A. Then there is a unique diﬀerence
ﬁeld extension (A(t), σ) of (A, σ) with σ(t) = α t + β. If α = 1, this extension is called
an S-ﬁeld extension and t is called an S-monomial. Similarly, if β = 0, this extension
is called a P -ﬁeld extension and t is called a P -monomial. Note that for α = 1 we get
the chain of extensions (A, σ) ≤ (A[t], σ) ≤ (A(t), σ) and if β = 0 we get the chain of
extensions (A, σ) ≤ (A[t, 1

t ], σ) ≤ (A(t), σ).

4

Finally, we will introduce A-extensions to model algebraic objects like αk for a root
of unity α. More precisely, let λ ∈ N with λ > 1, let (A, σ) be a diﬀerence ring and let
α ∈ A∗ be a λth root of unity, i.e., αλ = 1. Now take the diﬀerence ring extension (A[z], σ)
of (A, σ) with z being transcendental over A and σ(z) = α z (again this construction is
unique). Next, take the ideal I := hzλ − 1i and consider the ring E = A[z]/I. Since I is
closed under σ and σ−1, i.e., I is a reﬂexive diﬀerence ideal, it follows that σ : E → E with
σ(f +I) = σ(f )+I forms a ring automorphism. In other words, (E, σ) is a diﬀerence ring.
Moreover, there is the natural embedding of A into E with a 7→ a + I. By identifying a
with a + I, (E, σ) forms a diﬀerence ring extension of (A, σ). Finally, by setting y := z + I
we get the diﬀerence ring extension (A[y], σ) of (A, σ) subject to the relation yλ = 1.
Note that this ring contains zero-divisors, like e.g., (y − 1)(1 + y + · · · + yλ−1) = 0.
By construction we have that min{i > 0|yi = 1} = λ. Moreover, for any polynomial
f (z) ∈ A[z] \ {0} with f (y) = 0 we have that deg(f ) ≥ λ. This extension is called
an algebraic extension (in short A-extension) of order λ; the generator y is also called
an A-monomial and we deﬁne ord(y) = λ. Note that y with the relations yλ = 1 and
σ(y) = α y imitates αk with the relations ((α)k)λ = 1 and (α)k+1 = α (α)k, respectively.

Example 2.1. We illustrate with our brute force tactic how the product-sum expressions

k,

(−1)k,

E2(k) =

, E3(k) =

k(cid:19) =

k

Yi=1

(−1)i
i(1 + i)

2k, (cid:18)n
Xi=1

k

n − i + 1

i

, E1(k) =

(−1)i

i

,

(−1)i
i(1 + i)

k

j

Xi=1
Xi=1

(−1)j

j

k

Xj=1

(2.1)

and the shift-operator Sk acting on these objects can be formulated in such extensions.
(1) Start with the rational function ﬁeld K = Q(n) and the automorphism σ : K → K
with σ = idK. Now take the S-extension (A1, σ) of (Q(n), σ) with A1 = Q(n)(x)
and σ(x) = x + 1. There the rational expressions in n and k are represented in A1
where x takes over the role of k, and the shift operator Sk is rephrased by σ.

(2) Taking the A-extension (A2, σ) of (A1, σ) with A2 = A1[y] and σ(y) = −y of order

2 we can model (−1)k by y.

(3) Constructing the P -extension (A3, σ) of (A2, σ) with A3 = A2[p1, 1
p1

] and σ(p1) =
2 p1 we model in addition polynomial expressions in 2k and 2−k with Sk2k = 2 2k
(and Sk

2k ) by rephrasing 2k with p1 (and 1

2k with 1

2k = 1

).

p1

1

2

1

(4) Introducing the P -extension (A4, σ) of (A3, σ) with A4 = A3[p2, 1
p2

] and σ(p2) =

n−x

x+1 p2 we are in the position to model polynomial expressions in (cid:0)n
with Sk(cid:0)n

k(cid:1) with p2 and (cid:0)n
k(cid:1)−1

k(cid:1) by rephrasing(cid:0)n

(5) Further, taking the S-extension (A5, σ) of (A4, σ) with A5 = A4[t1] and σ(t1) =
x+1 we can represent polynomial expressions in the sum E1(k) with SkE1(k) =

k(cid:1) and (cid:0)n
k(cid:1)−1

k+1(cid:0)n
k(cid:1) = n−k

with 1
p2

.

t1 + −y
E1(k + 1) = E1(k) + −(−1)k

k+1 by rephrasing E1(k) with t1.

(6) In addition, building the S-extension (A6, σ) of (A5, σ) with A6 = A5[t2] and
(x+1)(x+2) we can represent polynomial expressions in the sum E2(k)

−y

σ(t2) = t2 +
with SkE2(k) = E2(k) + −(−1)k

(k+1)(k+2) by rephrasing E2(k) with t2.

5

(7) Finally, introducing the S-extension (A7, σ) of (A6, σ) with A7 = A6[t3] and σ(t3) =
one can represent polynomial expressions in the sum E3(k) with

t3 + 1−(x+1)(x+2)yt2
SkE3(k) = E3(k) + 1−(k+1)(k+2)(−1)k E2(k)

(x+1)2(x+2)

(k+1)2(k+2)

by rephrasing E3(k) with t3.

t ] (i.e., t is transcendental over A) if (A[t, 1

For convenience we introduce the following notations. Let (E, σ) be a diﬀerence ring
extension of (A, σ) with t ∈ E. Then Ahti denotes the polynomial ring A[t] (i.e., t is
transcendental over A) if (A[t], σ) is an S-extension of (A, σ). Ahti denotes the ring of
Laurent polynomials A[t, 1
t ], σ) is a P -extension
of (A, σ). Finally, Ahti is the ring A[t] with t /∈ A subject to the relation tλ = 1 if (A[t], σ)
is an A-extension of (A, σ) of order λ. We call a diﬀerence ring extension (Ahti, σ) of (A, σ)
• an AP -extension (and t is an AP -monomial) if it is an A- or a P -extension;
• an AS-extension (and t is an AS-monomial), if it is an A- or an S-extension;
• a P S-extension (and t is a P S-monomial), if it is a P - or an S-extension;
• an AP S-extension (and t is an AP S-monomial) if it is an A-, P - or S-extension.
(Aht1i . . . htei, σ) is called a (nested) AP S-extension (resp. (nested) A-, P -, S-, AP −,
AS-, P S- extension) of (A, σ) if it is build by a tower of such extensions. For a ﬁeld A we
say that (A(t), σ) is a P S-ﬁeld extension of (A, σ) if it is a P -ﬁeld or an S-ﬁeld extension.
In addition, (A(t1) . . . (te), σ) is a (nested) P -/S-/P S-ﬁeld extension of (A, σ) if it is a
tower of such extensions.

Let (G, σ) be a diﬀerence ﬁeld and let (Ght1i . . . htei, σ) be a P S-extension of (G, σ).
Then the quotient ﬁeld F = Q(Ght1i . . . htei) forms a rational function ﬁeld with the
variables ti, i.e., F = G(t1) . . . (te). Then there is exactly one automorphism σ′ : F → F
with σ′|Ght1i...htei = σ which is deﬁned by σ′( p
σ(q) with p, q ∈ G[t1, . . . , te]. As above
we do not distinguish anymore between σ and σ′. We call this diﬀerence ﬁeld extension
(F, σ) of (G, σ) also a polynomial P S-ﬁeld extension. Similarly, we call it a polynomial
P -/S-ﬁeld extension if it is built only by P -/S-monomials.

q ) = σ(p)

Remark. Any polynomial P S-ﬁeld extension is also a P S-ﬁeld extension, but the reverse
statement does not hold in general: in the summands and multiplicands of polynomial
P S-monomials the P S-monomials introduced earlier can occur only as (Laurent) poly-
nomial expressions and not as rational function expressions.

Example 2.2. We introduce the rational diﬀerence ﬁeld and the q–mixed case.

(1) Take the diﬀerence ﬁeld (K, σ) with σ(c) = c for all c ∈ K. Now consider the S-
extension (K[x], σ) of (K, σ) with σ(x) = x + 1. Then there is exactly one diﬀerence
ring extension (K(x), σ) of (K[x], σ) with σ(x) = x + 1. In other words, (K(x), σ) is
an S-ﬁeld extension of (K, σ). For K = Q(n) this construction yields the diﬀerence
ﬁeld (A1, σ) in Example 2.1. (K(x), σ) is also called the rational diﬀerence ﬁeld.

(2) Take the diﬀerence ﬁeld (K, σ) with σ(c) = c for all c ∈ K where K = K′(q1, . . . , qv)
is a rational function ﬁeld. Let (E, σ) with E = K[x][x1, 1
] be the P S-
x1
extension of (K, σ) with σ(x) = x + 1 and σ(xi) = qi xi for 1 ≤ i ≤ v. If we take the
quotient ﬁeld F = Q(E) = K(x)(x1) . . . (xv), the diﬀerence ﬁeld (F, σ) is a P S-ﬁeld
extension of (K, σ). (F, σ) is also called the q–mixed diﬀerence ﬁeld; compare [12]

] . . . [xv, 1
xv

2.2. RΠΣ∗-extensions

So far we adjoined nested sums and products in a diﬀerence ring (resp. diﬀerence ﬁeld)
without taking care if algebraic relations exist between them. Later we will work out

6

that such relations can be excluded if and only if the ring of constants remain unchanged
during the construction of AP S-extension; see Theorem 3.10 below.

Deﬁnition 2.3. An A-extension/P -extension/S-extension (Ahti, σ) of (A, σ) is called an
R-extension/Π-extension/Σ∗-extension if const(Ahti, σ) = const(A, σ). Similarly, we call
such an extension RΠ-/RΣ∗-/ΠΣ∗-/RΠΣ∗-extension if it is an AP -/AS-/P S/-AP S-ex-
tension with const(Ahti, σ) = const(A, σ). Depending on the type of extension, t is called
an R-/Π-/Σ∗-/RΠ-/RΣ∗-/ΠΣ∗-/RΠΣ∗-monomial, respectively.
An AP S-extension (Aht1i . . . htei, σ) of (A, σ) is called a (nested) RΠΣ∗-extension (resp.
(nested) R-, Π-, Σ∗-, RΠ, RΣ∗-, ΠΣ∗- extension) it it is a tower of such extensions.
We will consider also mixed cases like RP S-extensions built by R- and P S-extensions.

We will rely heavily on the following property of RΠΣ∗-extensions [57, Thm 2.12] gen-
eralizing the ΠΣ∗-ﬁeld results given in [25,43].

Theorem 2.4. Let (A, σ) be a diﬀerence ring. Then the following holds.

(1) Let (A[t], σ) be an S-extension of (A, σ) with σ(t) = t + β where β ∈ A such that
const(A, σ) is a ﬁeld. Then this is a Σ∗-extension (i.e., const(A[t], σ) = const(A, σ))
iﬀ there does not exist a g ∈ A with σ(g) = g + β.

(2) Let (A[t, 1

t ], σ) be a P -extension of (A, σ) with σ(t) = α t where α ∈ A∗. Then this
t ], σ) = const(A, σ)) iﬀ there are no g ∈ A \ {0}

is a Π-extension (i.e., const(A[t, 1
and m ∈ Z \ {0} with σ(g) = αm g.

(3) Let (A[t], σ) be an A-extension of (A, σ) of order λ > 1 with σ(t) = α t where
α ∈ A∗. Then this is an R-extension (i.e., const(A[t], σ) = const(A, σ)) iﬀ there are
no g ∈ A \ {0} and m ∈ {1, . . . , λ − 1} with σ(g) = αm g.

Finally, we introduce ΠΣ∗-ﬁeld extensions; compare [24,25,57].

Deﬁnition 2.5. A (polynomial) P S-ﬁeld/P -ﬁeld/S-ﬁeld extension (F(t1) . . . (te), σ) of
a diﬀerence ﬁeld (F, σ) is called a (polynomial) ΠΣ∗-ﬁeld/Π-ﬁeld/Σ∗-ﬁeld extension if
const(F(t1) . . . (te), σ) = const(F, σ). In particular, if const(F, σ) = F, (F(t1) . . . (te), σ) is
called a (polynomial) ΠΣ∗-ﬁeld over F.

In Section 6 below we will utilize the following result. If we are given a ΠΣ∗-extension
(Fht1i . . . htei, σ) of a diﬀerence ﬁeld (F, σ), the quotient diﬀerence ﬁeld (F(t1) . . . (te), σ)
forms a polynomial ΠΣ∗-ﬁeld extension. This property follows by Corollary 2.6.

Corollary 2.6. Let (Fhti, σ) be a P S-extension of a diﬀerence ﬁeld (F, σ) with σ(t) =
α t + β and let (F(t), σ) be the P S-ﬁeld extension of (F, σ). Then const(Ahti, σ) =
const(A, σ) iﬀ const(A(t), σ) = const(A, σ).

Proof. The implication “⇐” is obvious. Now let t be an S-monomial with σ(t) = t + β,
and suppose that const(F[t], σ) = const(F, σ), which is a ﬁeld. By Theorem 2.4 it follows
that there does not exist a g ∈ F with σ(g) = g + β. This implies that const(F(t), σ) =
const(F, σ) by [57, Thms. 11] or [25]. Similarly, let t be a P -monomial with σ(t) = α t
where α ∈ F∗ and assume that const(F[t, 1
t ], σ) = const(F, σ). By Theorem 2.4 it follows
that there does not exist a g ∈ F∗ and m ∈ Z \ {0} with σ(g) = αm g. This implies that
const(F(t), σ) = const(F, σ) by [57, Thm. 18] or [25]. ✷

7

2.3. Basic AP S- and RΠΣ∗-extensions

Extending the techniques in [24] we turned Theorem 2.4 in [57] to a constructive
version for various subclasses of RΠΣ∗-extensions. Here we will focus on the subclass
of basic RΠΣ∗-extensions (which we called simple and single-rooted RΠΣ∗-extensions
in [57]). In order to introduce this type of extensions, we need the following notation.

Let (Aht1i . . . htei, σ) be an AP S-extension (or RΠΣ∗-extension) of (A, σ) as given in

Deﬁnition 2.3. Let G be a subgroup of A∗. Then we deﬁne the set

GE

A = {u tl1

1 . . . tle

e | u ∈ G and li ∈ Z for 1 ≤ i ≤ e

.

where li = 0 if ti is an AS-monomial (or RΣ∗-monomial)}

which forms a subgroup of the multiplicative group E∗; for a more general group see [57].

Deﬁnition 2.7. Let (A, σ) be a diﬀerence ring and G be a subgroup of A∗. An AP S-
extension (or RΠΣ∗-extension) (Aht1i . . . htei, σ) of (A, σ) is called G-basic if for 1 ≤ i ≤ e
the following holds:

(1) if ti is an A-monomial (or R-monomial) then σ(ti)
ti
(2) if ti is a P -monomial (or Π-monomial) then σ(ti)
ti

∈ const(A, σ)∗;
Aht1i...hti−1i
.
= G
A

An A∗-basic extension is also called a basic extension. The ti are called basic/G-basic
AP S-/RΠΣ∗monomials.

Everywhere (except in Section 5) we will consider the most general case G = A∗. So far
we have introduced basic AP S-monomials (most of them being basic RΠΣ∗-monomials)
where the P -monomials are not nested. Here is an example for nested basic P -monomials.

Example 2.8. Take the ΠΣ∗-ﬁeld (K(x), σ) over K with σ(x) = x + 1. Then we can
construct the basic P -extension (K(x)[p1, 1
], σ) of (K(x), σ) with σ(p1) =
p1
(x + 1)p1, σ(p2) = (x + 1)p1 p2 and σ(p3) = (x + 1)p1 p2 p3.

][p3, 1
p3

][p2, 1
p2

Note that the order of the generators in the tower of a general AP S-extension E =
Aht1i . . . htei is essential. Take, e.g., an S-monomial ti with 1 ≤ i ≤ e where σ(ti) − ti
depends on tj with 1 ≤ j ≤ e. Then tj must be introduced before ti, i.e., j < i. Similarly,
one has to take into account the correct order for P - and A-monomials. But if (E, σ) is a
basic AP S-extension (or a basic RΠΣ∗-extension) of (A, σ), we can reorder the generators
such that ﬁrst all A-monomials, then all P -monomials and afterwards all S-monomials
are introduced. In other words, we may assume that

E = A[y1, . . . , yl][p1, p−1

1 ] . . . [pr, p−1

r ][s1] . . . [sv]

(2.2)

holds where the yi are A-monomials (or R-monomials), the pi are P -monomials (or Π-
monomials) and the si are S-monomials (or Σ∗-monomials). Besides this representation,
we will also use the rearrangement

E = A[p1, p−1

1 ] . . . [pr, p−1

r ][y1, . . . , yl][s1] . . . [sv],

(2.3)

which is possible since the pi are free of R-monomials.

In the following we will elaborate further properties that are relevant for our article.

8

Lemma 2.9. (1) Let (E, σ) be an RP S-extension of a diﬀerence ﬁeld (F, σ). Then E is
reduced, i.e., there are no non-zero nil-potent elements in E.
(2) Let (E, σ) be an S-extension of a reduced diﬀerence ring (A, σ). Then E∗ = A∗.
(3) Let (E, σ) be a P S-extension of a diﬀerence ﬁeld (F, σ). Then
E∗ = {h tm1

| h ∈ F∗, mi ∈ Z for 1 ≤ i ≤ e with mi = 0 if ti is an S-monomial}.

. . . tme

1

e

Proof. Let (E, σ) be given as in (2.2) (with A = F). Set H = F[y1, . . . , yl] where the yi
are R-monomials. Note that E is built by a tower of P S-monomials on top of H. By [57,
Corollary 4.3], H is reduced. Moreover, one can verify the following fact: if a ring A is
reduced, the ring of polynomials A[t] or the ring of Laurent polynomials A[t, 1
t ] is reduced
(for a straightforward proof see [57, Corollary 4.3]: there we showed this result for ΠΣ∗-
monomials – however, we never used the property that the constants remain unchanged
and thus the proof is valid also for P S-monomials). Thus by iterative application of this
result, it follows that E is reduced and (1) is proven.
Now we use the fact that A[t]∗ = A∗ and A[t, 1
t ]∗ = {w tm|w ∈ A∗, m ∈ Z} if the
coeﬃcient ring A is reduced; for details and more general statements see [23, Theorem 1]
(and [32]). Hence by iterative application of these properties in combination with part (1)
we conclude that parts (2) and (3) follow. ✷

Next, we present an alternative characterization of basic RΠΣ∗-extensions (compare
Section 1) under the assumption that the ground ring (A, σ) is a ﬁeld.

Proposition 2.10. Let (Fht1i . . . htei, σ) be an AP S-extension of a diﬀerence ﬁeld (F, σ).
Then this extension is basic iﬀ for 1 ≤ i ≤ e the following holds:

(1) if ti is an A-monomial then σ(ti)
ti
(2) if ti is a P -monomial then α = σ(ti)
ti

∈ const(F, σ)∗;

∈ E∗ where α is free of R-monomials.

Proof. A basic AP S-extension fulﬁls properties (1) and (2) by deﬁnition. Now suppose
that we are given an AP S-extension with the properties (1) and (2). Observe that the
AP S-extension can be reordered to the form (2.2) with F = A by [57, Lemma 4.13] (this
reordering property is stated for basic RΠΣ∗-extensions; however, the proof holds also for
AP S-extensions since it does not use the property that the constants remain unchanged).
Since all P -monomials are free of A-monomials, we can reorder this extension further to
the form (2.3). Set E = Fhp1i . . . hpri. By part (3) of Lemma 2.9 we have E∗ = (F∗)E
F.
Hence σ(pi)
pi

∈ E∗ for 1 ≤ i ≤ r. Consequently the AP S-extension is basic. ✷

In this article we will use heavily the following result from [57, Thm. 22].

Theorem 2.11. Let (E, σ) be a basic RΠΣ∗-extension of a diﬀerence ﬁeld (F, σ) of the
form (2.2). Let a = u yn1
r with u ∈ F∗, ni ∈ N and zi ∈ Z, and let
f ∈ E \ {0}. If σ(f ) = a f , then there are a w ∈ F∗, ξi ∈ N and πi ∈ Z with

1 . . . ynl

1 . . . pzr

l pz1

f = w yξ1

1 . . . yξl

l pπ1

1 . . . pπr

r ∈ E∗.

(2.4)

Finally, we summarize the following algorithmic toolbox from [57] in the following remark.

Remark 2.12. We suppose that we are given a ground ﬁeld (F, σ) with certain algo-
rithmic properties stated in [57, Thm. 2.23]; see also Section 6 below. For instance, we
can take any ΠΣ∗-ﬁeld extension (F, σ) of a diﬀerence ﬁeld (G, σ) where (G, σ) is the

9

constant ﬁeld [24] (i.e., (F, σ) is a ΠΣ∗-ﬁeld over G). For typical examples see the diﬀer-
ence ﬁelds given in Example 2.13 below. Further, (G, σ) can be, e.g., the diﬀerence ﬁeld
of unspeciﬁed sequences [26] or of radical expressions [27]. Note that in all three cases
the underlying constant ﬁeld must also meet certain algorithmic properties [24,26]. This
is the case if we choose, e.g., a rational function ﬁeld over an algebraic number ﬁeld [46].
Now let (E, σ) with E = Fht1i . . . htei be a basic AP S-extension of (F, σ) as speciﬁed
above. Then Theorem 2.4 provides a strategy to verify if the given AP S-monomials
are also RΠΣ∗-monomials. Namely, suppose that we have checked that (A, σ) with
A = Fht1i . . . htk−1i is an RΠΣ∗-extension of (F, σ). Then given this setting the algo-
rithms from [57] can be used in order to solve the following problems:

(1) given β ∈ A, decide constructively if there exists a g ∈ A with σ(g) = g + β;
(2) given α ∈ (F∗)A

F with α being not a root of unity, decide constructively if there

exists a g ∈ A \ {0} and an m ∈ Z \ {0} such that σ(g) = αm g holds.

(3) Given α ∈ K∗ with ord(α) = λ ∈ N where λ > 1, decide constructively if there

exists a g ∈ A \ {0} and an m ∈ N with 0 < m < λ such that σ(g) = αm g holds.

Hence we can treat the next RΠΣ∗-monomial tk as follows. If tk is an S-monomial, we
can check if tk is a Σ∗-monomial by testing if there exists a g ∈ A with σ(g) = g + β
with β = σ(tk) − tk. If tk is a P -monomial (resp. A-monomial), we can check if tk is a Π-
monomial (resp. R-monomial) by testing if there exists a g ∈ A \ {0} and an m ∈ Z \ {0}
(resp. 0 < m < ord(tk)) with σ(g) = αm g where α = σ(tk)/tk.

Example 2.13. We go back to the (q–)rational diﬀerence ﬁeld from Example 2.2.

(1) Consider the rational diﬀerence ring (K(x), σ). Since there is no g ∈ K with σ(g) =

g + 1, x is a Σ∗-monomial. In particular, (K(x), σ) is a ΠΣ∗-ﬁeld over K.

(2) Let K = K′(q1, . . . , qv) and consider the P S-ﬁeld extension (E, σ) of (K(x), σ) from
Example 2.2 with E = K(x)[x1, 1
] where σ(xi) = qi xi for 1 ≤ i ≤ v.
x1
It is not too diﬃcult to see that there does not exist a g ∈ K(x)∗ and (0, . . . , 0) 6=
(m1, . . . , mv) ∈ Zv with σ(g) = qm1
g. Hence by [51, Thm. 9.1] (or by the
iterative application of Theorem 2.4 combined with Corollary 2.6) it follows that
const(E, σ) = const(K(x), σ) = K. Thus (E, σ) is a ΠΣ∗-ﬁeld over K.

] . . . [xv, 1
xv

. . . qmv

v

1

Example 2.14. We analyse the basic AP S-monomials in Example 2.1 using the algo-
rithms from [57] that are implemented within the package Sigma.

(1) As observed in Example 2.13 the diﬀerence ﬁeld (K(x), σ) with σ(x) = x + 1 and

const(K, σ) = K = Q(n) is a ΠΣ∗-ﬁeld over K.

(2) There are no g ∈ K(x)∗ and m ∈ {1} with σ(g) = (−1)m g. Hence the A-extension

(A2, σ) of (A1, σ) is an R-extension.

(3) There are no g ∈ A2 \ {0} and m ∈ Z \ {0} with σ(g) = 2m g. Thus (A3, σ) is a

Π-extension of (A2, σ).

x+1(cid:1)m
(4) There are no g ∈ A3 \ {0} and m ∈ Z \ {0} with σ(g) =(cid:0) n−x

a Π-extension of (A3, σ).

g. Thus (A4, σ) is

(5) There is no g ∈ A4 with σ(g) = g + −y
(6) However, we ﬁnd g = 2(x+1)t1+x−y+1

x+1
is not a Σ∗-extension of (A5, σ).

x+1 . Thus (A5, σ) is a Σ∗-extension of (A4, σ).
∈ A5 with σ(g) = g +
(x+1)(x+2) . Thus (A6, σ)

−y

10

To sum up, the diﬀerence ring (A5, σ) is an RΠΣ∗-extension of (Q(n)(x), σ) with A5 =
Q(n)(x)(y)[p1, 1
][t1], i.e., const(A5, σ) = const(Q(n)(x), σ) = Q(n). But t2 is not
p1
a Σ∗-monomial, e.g., we ﬁnd the constant

][p2, 1
p2

c = t2 − g = t2 −

2(x + 1)t1 + x − y + 1

x + 1

∈ const(A6, σ) \ A5.

(2.5)

2 = 1, and with σ(y3) = (−1)1/6y3 and y12

Example 2.15. Take the ΠΣ∗-ﬁeld (K(x), σ) over K with σ(x) = x + 1 and the A-
extension (K(x)[y1][y2][y3], σ) of (K(x), σ) with y2
1 = 1 and σ(y1) = −y1, with σ(y2) =
(−1)2/3 y2 and y3
3 = 1. We apply Theorem 2.4
together with our algorithmic machinery [57]. Since there does not exist a g ∈ K(x) \ {0}
with σ(g) = −g, y1 is an R-monomial. Moreover, since there are no g ∈ K(x)[y1] \ {0}
and m ∈ {1, 2} with σ(g) = (−1)2 m/3g, y2 is also an R-monomial. But we ﬁnd m = 10,
g = y1 y2 with σ(g) = (−1)m/6 g. Thus y3 is not an R-monomial. In particular, we get

c = y1y2y2

3 ∈ const(K(x)[y1][y2][y3], σ) \ K(x)[y1][y2].

(2.6)

For an alternative and direct check we refer to Example 2.24.

Example 2.16. Take the diﬀerence ﬁeld (A3, σ) with A3 = Q(n)(x)[y][p1, 1
p1
in Example 2.1. Now take the P -extension (A3[p2, 1
p2
σ(p2)

] given
], σ) of (A3, σ) with α2 :=

][p3, 1
p3

. Using part 2 of Theorem 2.4 we can

= (n−x)2

(x+1)2 and with α3 := σ(p3)

p3

= − 4(1+n−x)

x+1

p2

verify that p2 is a Π-monomial. However, we ﬁnd m = −2 and g = − p4
σ(g) = αm

3 g holds. Therefore p3 is not a Π-monomial and we get

1p2

(1+n−x)2 such that

c =

−p4

1p2

(1 + n − x)2p2
3

∈ const(A3[p2, 1
p2

][p3, 1
p3

], σ) \ A3[p2, 1
p2

].

(2.7)

Example 2.17. Take the basic P -extension (K(x)[p1, 1
], σ) of (K(x), σ)
p1
from Example 2.8. We check that there is no g ∈ K(x)∗ and m ∈ Z \ {0} with σ(g) =
(x + 1)m g. Thus p1 is a Π-monomial. Next, we show by our algorithms that there is no
g ∈ K(x)[p1, 1
] \ {0} and m ∈ Z \ {0} with σ(g) = ((x + 1)p1)m g. Hence p2 is a Π-
p1
monomial. Finally, we verify that there is no g ∈ K(x)[p1, 1
]\{0} and m ∈ Z\{0}
p1
such that σ(g) = ((x + 1)p1 p2)m g holds. Consequently, p3 is a Π-monomial. In total,
(K(x)[p1, 1
p1

], σ) is a Π-extension of (K(x), σ).

][p2, 1
p2

][p2, 1
p2

][p3, 1
p3

][p2, 1
p2

][p3, 1
p3

2.4. Simple tests for basic R-extensions

In the following we will carve out further properties of R-extensions. In particular,
we will show in Proposition 2.23 that the veriﬁcation of an R-extension is immediate if
certain properties hold for the underlying diﬀerence ﬁeld (F, σ). In addition, we will show
in Lemma 2.22 that a ring obtained by several R-extensions is isomorphic to a ring with
just one properly chosen R-extension; this construction will be relevant in Section 4.

We start with the following deﬁnition that will be crucial throughout this article.

Deﬁnition 2.18. A diﬀerence ring (resp. ﬁeld) is called constant-stable if const(F, σk) =
const(F, σ) for all k ∈ N.

11

Remark 2.19. We note that the class of diﬀerence ﬁelds introduced in Remark 2.12
are all constant-stable; compare [57, Subsec. 2.3.3]. In particular, all diﬀerence rings in
our examples (except Example 2.21 below) are built by a tower of basic AP S- or RΠΣ∗-
extensions (or mixed versions) over a constant-stable diﬀerence ﬁeld.

We obtain the following simple characterization (compare [55, Prop 1]) under the as-
sumption that the ground ﬁeld (F, σ) is constant-stable.

Proposition 2.20. Let (F, σ) be a constant-stable diﬀerence ﬁeld. Let (F[t], σ) be a basic
t ∈ const(F, σ)∗. Then this is an R-extension
A-extension of (F, σ) of order λ with α = σ(t)
iﬀ α is a primitive root of unity.

Proof. “⇒”: Suppose that α is not a primitive root of unity of order λ. Then we get
αs = 1 for some s ∈ N with 0 < s < λ. Hence σ(ts) = αs ts = ts, i.e., ts ∈ const(F[t], σ).
Since tλ = 1 is the deﬁning relation, ts /∈ F. Thus t is not an R-monomial.

“⇐”: Assume there is a g =Pλ−1

i=0 gi ti ∈ F[t] \ F with σ(g) = g. Thus we can take an m
with 0 < m < λ and gm ∈ F∗. Comparing the m-th coeﬃcient in σ(g) = g gives σ(gm) =
αm gm. Since α is a constant, σλ(gm) = (αm)λ gm = gm. Hence gm ∈ const(F, σ)∗ using
the property that (F, σ) is constant-stable. Consequently, gm = σ(gm) = αm gm and
therefore αm = 1. Thus α is not a primitive root of unity of order λ. ✷

Note that this characterization does not hold in general if (F, σ) is not constant-stable.

Example 2.21. Take the rational function ﬁeld Q(x) and deﬁne the ﬁeld automorphism
subject to the relation σ(x) = −x. Since σ(x2) = x2, we get const(Q(x), σ) = Q(x2).
Moreover, since σ2(x) = x, we have const(Q(x), σ2) = Q(x). Hence (Q(x), σ) is not
constant-stable. Now take the A-extension (Q(x)[y], σ) with σ(y) = −y. Then σ( y
x ) = y
x ,
i.e., const(Q(x)[y], σ) ) const(Q(x), σ). Hence y is not an R-monomial.

Next, we show that several R-extensions can be merged to one R-extension by means of
a diﬀerence ring isomorphism.

Lemma 2.22. Let (F, σ) be a constant-stable diﬀerence ﬁeld. Let (E, σ) with E =
F[t1] . . . [te] be a basic A-extension of (F, σ) of orders λ1, . . . , λe, respectively. Further,
∈ const(F, σ)∗ with 1 ≤ i ≤ e are primitive and that
suppose that the αi = σ(ti)
ti
gcd(λi, λj) = 1 holds for pairwise diﬀerent i, j. Then the following holds.

(1) There is an R-extension (F[t], σ) of (F, σ) of order λ :=Qe

(2) There is a diﬀerence ring isomorphism τ : E → F[t] with τ |F = idF and τ (ti) = t

t =Qe

i=1 λi with σ(t)

i=1 αi.
λ
λi

for 1 ≤ i ≤ e.

(3) (E, σ) is an R-extension of (F, σ).

Proof. (1) Note that α = α1 . . . αe is a primitive λth root of unity. Hence by Proposi-
tion 2.20 (F[t], σ) is an R-extension of (F, σ).
(2) Clearly, there is a ring homomorphism τ : E → F[t] deﬁned by τ |F = idF and
and thus
τ (ti) = t

λ

τ (σ(ti)) = τ (αi ti) = αi t
e )) =
τ (σ(ta1
e )) for any ai ∈ N and hence τ is a diﬀerence ring homomorphism by linearity.
Suppose that τ is not injective. Then there is an h ∈ E\{0} with τ (h) = 0. But this implies

1 . . . tae

λi t

1 . . . tae

λi for 1 ≤ i ≤ e. Note that αλ/λi
λi = σ(t

λi = α

j

λ

λ

λ

= 1 if j 6= i. Hence αλ/λi = αλ/λi
λi ) = σ(τ (ti)). Therefore σ(τ (ta1

i

λ

12

1

e

1

e

. . . t−ce

a1+···+ λ
λe

. . . tbe−ce

1 . . . tbe

1 . . . tae

+ · · · + ae
λe

e and h2 = tc1

e ) = 1. By construction, t

) on both sides of τ (h1) = τ (h2) yields τ (tb1−c1

that there are at least two diﬀerent monomials in h, say h1 = tb1
1 . . . tce
e
with (b1, . . . , be) 6= (c1, . . . , ce) and 0 ≤ bi, ci < λi such that τ (h1) = τ (h2) holds. Multi-
plying τ (t−c1
) = 1. Hence
we can assume that there is an 0 6= (a1, . . . , ae) ∈ Ne with 0 ≤ ai < λi for 1 ≤ i ≤ e and
τ (ta1
ae)
and consequently a1
∈ N. Since the λi are co-prime and 0 ≤ ai < λi, we
λ1
must have (a1, . . . , ae) = 0, a contradiction. Finally, let a ∈ N with 0 ≤ a < λ. Then
by division with remainder there is a vector (a1, . . . , ae) ∈ Ne with 0 ≤ ai < λi and
ae = ta. Hence τ is sur-
a = a1
jective and thus bijective. Consequently τ is a diﬀerence ring isomorphism.
(3) Suppose that (E, σ) is not an R-extension of (F, σ). Then there is an f ∈ E \ F with
σ(f ) = f . Consequently, τ −1(f ) = τ −1(σ(f )) = σ(τ −1(f )), i.e., τ −1(f ) ∈ const(F[t], σ).
Since (F[t], σ) is an R-extension of (F, σ), τ (f ) ∈ const(F, σ). In particular, τ (f ) ∈ F.
Since τ |F = idF, f = τ (f ) ∈ F, a contradiction. ✷

ae = 1, therefore λ | ( λ
λ1

, and we get τ (ta1

a1 + · · · + λ
λe

+ · · · + ae

1 . . . tae

a1+···+ λ
λe

e ) = t

λ
λe

λ
λ1

λ
λ1

λ
λ1

Finally, we obtain a simple test whether several basic A-extensions form an R-extension.

Proposition 2.23. Let (F, σ) be a constant-stable diﬀerence ﬁeld. Let (E, σ) with E =
F[t1] . . . [te] be an A-extension of (F, σ) over F of orders λ1, . . . , λe respectively. Then
this is an R-extension iﬀ for 1 ≤ i ≤ e the σ(ti)
are primitive λi-th roots of unity and
ti
gcd(λi, λj) = 1 for pairwise distinct i, j.

Proof. “⇐” follows by Lemma 2.22. “⇒”: Suppose that (E, σ) is an R-extension of (F, σ).
By reordering any R-monomial can be moved to the front. Thus by Proposition 2.20 all
σ(tl)/tl with 0 ≤ l ≤ e are primitive roots of unity. Now suppose that there are i, j with
i < j such that µ = gcd(λi, λj) 6= 1 holds. Deﬁne ri := λi/µ ∈ N and rj = λj/µ ∈ N. Let
i )µ = 1 = (αrj
αi = σ(ti)/ti and αj = σ(tj)/tj. Then (αri
j )µ. Summarizing, we are given
i and αrj
ri and rj with 0 < ri < λi and 0 < rj < λj such that αri
j are µth roots of unity.
Since αi, αj are primitive roots of unity of orders λi, λj, they produce multiplicatively
all µth roots of unity. We can therefore choose 0 < r′
j < λj such that
αr′
i . Then
i = α
j = 1

is a primitive µth root of unity. Now take w := t

j and such that αr′

σ(w) = w, i.e., w ∈ const(E, σ) = const(F, σ). Hence t
is not the deﬁning relation of tj; a contradiction. ✷

i < λi and 0 < r′

j < λj , tλj

j = w tr′

i . Since r′

j /tr′

r′
j

r′
j

r′
j

i

i

i

i

i

Example 2.24. Consider the A-extension (K(x)[y1][y2][y3], σ) of (K(x), σ) from Exam-
ple 2.15. Here we have σ(yi) = αi yi and yλi
i = 1 for i = 1, 2, 3 with λ1 = 2, λ2 = 3,
λ3 = 12 and α1 = −1, α2 = (−1)2/3, α3 = (−1)1/6. Note that (K(x), σ) is constant-stable,
that the α1 and α2 are primitive λ1-th and λ2-th roots of unity, and that gcd(λ1, λ2) = 1.
Hence (K(x)[y1][y2], σ) is an R-extension of (K(x), σ) by Proposition 2.23. Also α3 is a λ3-
th root of unity, but gcd(λ2, λ3) 6= 1 (or gcd(λ1, λ3) 6= 1). Thus y3 is not an R-monomial
by Proposition 2.23.

3. Simple diﬀerence rings and the constant ﬁeld

Let (E, σ) be a basic AP S-extension of a diﬀerence ﬁeld (F, σ) which is constant-
stable (see Deﬁnition 2.18). In this setting we will show in Subsections 3.1 and 3.2 that

13

the property const(E, σ) = const(F, σ) is equivalent to the property that (E, σ) is simple.
This means that there is no diﬀerence ideal in E, except the trivial ones: I = {0} and
I = E. In particular, if (E, σ) is not simple, we will be able to compute explicitly a non-
trivial diﬀerence ideal I in (E, σ) in Subsection 3.3. Further, we will address the problem
to compute a maximal inverse diﬀerence ideal in Subsection 3.4.

3.1. Basic RΠΣ∗-extensions over ﬁelds are simple diﬀerence rings

First, we will show in Theorem 3.3 that (E, σ) is simple if const(E, σ) = const(F, σ) holds.
Here we rely heavily on a speciﬁc term order that can be introduced as follows.

Suppose that we are given a basic AP S-extension (E, σ) of a diﬀerence ring (A, σ) in
the form (2.3) where K := const(A, σ) is a ﬁeld. In addition, we take care of the recursive
nature of the P -monomials and S-monomials. Namely, w.l.o.g. we can sort the generators
further by their nesting depth
1,1, . . . , p1,ν1, p−1

δ,1, . . . , pδ,νδ , p−1
δ,νδ
[y1, . . . , yl][s1,1, . . . , s1,n1][s2,1, . . . , s2,n2] . . . [sd,1, . . . , sd,nd]

2,1, . . . , p2,ν2, p−1

2,ν2] . . . [pδ,1, p−1

E =A[p1,1, p−1

1,ν1 ][p2,1, p−1

]

with the following properties:
(1) for 1 ≤ i ≤ δ and 1 ≤ j ≤ νi, the pi,j are basic P -monomials with

σ(pi,j )

pi,j

A[p1,1,p−1

1,1,...,p1,ν1 ,p−1
1,ν1

∈ (A∗)

A

]...[pi−1,1,p−1

i−1,1...,pi−1,νi−1 ,p−1

i−1,νi−1

(3.1)

]

where σ(pi,j )

pi,j

depends at least on one of the pi−1,1, . . . , pi−1,νi−1 ;

(2) for 1 ≤ i ≤ l the yi are A-monomials of order λi with σ(yi)
yi
(3) for 1 ≤ i ≤ d and 1 ≤ j ≤ ni the si,j are S-monomials with

∈ K∗,

σ(si,j) − si,j ∈ A[p1,1, . . . , p−1
δ,νδ

][y1, . . . , yl][s1,1, . . . , s1,n1] . . . [si−1,1, . . . , si−1,ni−1]

where σ(si,j ) − si,j depends at least on one of the si−1,1, . . . , si−1,ni−1 .

Subsequently, we say that a basic AP S-extension (or basic RΠΣ∗-extension) (E, σ) of
(A, σ) is in depth-order, if it is build as given in equation (3.1) with the properties (1–3).

Consider the set of all monomials
M := {pπ1,1

yξ1
1 . . . yξl

1,1 . . . p

πδ,νδ
δ,νδ

l sσ1,1

1,1 . . . s

σd,nd
d,nd

|0 ≤ ξi < λi, πi,j ∈ Z, σi,j ∈ N}.

(3.2)

Then such a depth-ordered basic AP S-extension introduces naturally the following lex-
icographical term order < of M where the underlying variable order is induced by the
order of the generators given in (3.1). This means that
1,ν1 < · · · < pδ,1 < p−1

δ,1 < · · · < pδ,νδ < p−1
δ,νδ
y1 < y2 < · · · < yl < s1,1 < · · · < s1,n1 < . . . sd,1 < sd,2 < · · · < sd,nd.

1,1 < · · · < p1,ν1 < p−1

p1,1 < p−1

(3.3)

<

Here various block orders are encoded: P -monomials come ﬁrst, then A-monomials and
ﬁnally S monomials. In particular, pi,j < p−1
i,j for all i, j. Finally, the nested depth is
encoded within the term order: the less the P - or S-monomials depend on the previous
elements, the smaller the variable is considered in the term order. Take the lexicographical
order of M (see (3.2)) induced by the depth-order representation (3.1), i.e, given by the
variable order (3.3). Then we have for instance

p2,1 p1

1,1 < p2,1 p10

1,1 < p2,1 p−1

1,1 < y1 < p21 y2 s11 < sd,1 < s3

1,1 sd,1.

14

Obviously, < forms a total order on M . The leading monomial of f ∈ E \ {0}, i.e.,
the largest monomial in f w.r.t. < is denoted by lm(f ) ∈ M . In addition, the leading
coeﬃcient of f ∈ E, i.e., the coeﬃcient of lm(f ) in f is denoted by lc(f ) ∈ A \ {0}.
We emphasize that the descending chain condition holds: for any ideal I and any sequence
hfiii≥0 with non-zero entries from I there does not an inﬁnite chain lm(f1) > lm(f2) >
lm(f3) . . . . This fact is ensured by pi,j < p−1
i,j for all i, j, i.e., eventually we obtain an
n ∈ N with fn = 1 which is the smallest element in this term order. In other words, any
ideal has an element f such that lm(f ) is minimal.

The introduced term order is not admissible (for appropriate term orders see [34]). Nev-
ertheless, we can exploit the following crucial property.

Lemma 3.1. Let (E, σ) be a basic AP S-extension of (A, σ) which is depth-ordered and
let < be its lexicographical order on the set of monomials. Suppose that σ(p)
p ∈ A∗ for
all P -monomials. Then for any f ∈ E \ {0} we have that lm(σ(f )) = lm(f ).

Proof. Let E be given as in (3.1) with δ = 1. We will show the statement by induction
on d. If d = 0, there are no S-monomials in E. Let f ∈ E \ {0} and take any monomial m
of f . This means that m = pπ1,1
for some πi,j ∈ Z and ξi,j ∈ N. Then
σ(m) = g m for some g ∈ A∗. Hence the monomials in f are precisely the monomials in
σ(f ) which implies that lm(σ(f )) = lm(f ) holds.
Now let E as given in (3.1) with d > 1 and suppose that the lemma holds for d − 1. For
a given f ∈ E \ {0} we will show that lm(σ(f )) = lm(f ) holds. Let

1 . . . yξl

π1,ν1
1,ν1 yξ1

1,1 . . . p

l

H = A[p1,1, p−1

1,1, . . . , p1,ν1, p−1

1,ν1 ][y1, . . . , yl][s1,1, . . . , s1,n1] . . . [sd−1,1, . . . , sd−1,nd−1].

Then (E, σ) with E = H[sd,1 . . . , sd,nd] is a Σ∗-extension of (H, σ) with βi := σ(sd,i) −
sd,i ∈ H for 1 ≤ i ≤ nd. Now let <1 be the lexicographical order of the basic S-extension
(E, σ) of (H, σ). In particular, we denote by M1 = [sd,1 . . . , sd,nd] the set of monomials
and lm1(f ) ∈ M1 denotes the leading monomial w.r.t. <1. Then we can write

f = h lm1(f ) + w

(3.4)

with h ∈ H \ {0} and w ∈ E where all monomials of w from M1 are smaller than lm1(f )
w.r.t. <1. Note that

lm(f ) = lm(h) lm1(f )

due to the variable order (3.3). Observe further that for any m = sl1
li ∈ N for 1 ≤ i ≤ nd we have that

d,1 . . . s

σ(m) = (sd,1 + β1)l1 . . . (sd,nd + βnd )lnd = m + v

(3.5)

lnd
d,nd

∈ M1 with

for some v ∈ E where for each monomial in v at least one exponent of the sd,i with
1 ≤ i ≤ nd is smaller than li. Thus all monomials of v from M1 are smaller than m w.r.t.
<1. Together with (3.4) we get

σ(f ) = σ(h)σ(lm1(f )) + σ(w) = σ(h) lm1(f ) + ˜w

for some ˜w ∈ E where all monomials of ˜w from M1 are smaller than lm1(f ) w.r.t. <1.
By our induction assumption, we have that lm(σ(h)) = lm(h) and due to (3.3) it follows
that σ(f ) = lc(h) lm(h) lm1(f ) + w′ for some w′ ∈ E where all terms of w′ from M are
smaller w.r.t < than lm(h) lm1(f ). Hence lm(σ(f )) = lm(h) lm1(f ) and with (3.5) it
follows that lm(σ(f )) = lm(f ). ✷

15

In order to obtain our ﬁrst main result in Theorem 3.3, we need the following slight
variation of Theorem 2.11.

Corollary 3.2. Let (E, σ) be a basic RΠΣ∗-extension of (A, σ) with (2.2) where A is
an integral domain. Let f1 ∈ A \ {0} and f2 = u yn1
r with u ∈ A \ {0},
ni ∈ N for 1 ≤ i ≤ l and zi ∈ Z for 1 ≤ i ≤ r. For any f ∈ E \ {0} with f1 σ(f ) = f2 f
we have that f = φ w for some w ∈ A \ {0} and φ ∈ E∗.

1 . . . ynl

1 . . . pzr

l pz1

q ) = σ(p)

Proof. Take the quotient ﬁeld H of A and extend σ to the ﬁeld automorphism σ′ : H → H
with σ′( p
σ(q) for p ∈ A and q ∈ A \ {0}. Then (H, σ) is a diﬀerence ring extension
of (A, σ). In particular, construct the basic AP S-ring extension (˜E, σ) of (H, σ) with
˜E = H[y1, . . . , yl][p1, p−1
r ][s1, . . . , sv] where the generators have precisely the
same shift behaviour as in the extension (E, σ) of (A, σ). Note that (˜E, σ) is a diﬀerence
ring extension of (E, σ). In particular, as sets we get

1 , . . . , pr, p−1

= u
f1

1 . . . ynl
yn1

E ∩ H = A ∩ H = A.
1 . . . pzr

(3.6)
∈ H∗, and let f ∈ E \ {0} ⊆ ˜E \ {0}. By
Now set a := f2
f1
Theorem 2.11 (with E and F replaced by ˜E and H, respectively) we conclude that (2.4)
holds for some w ∈ H∗, ξi ∈ N and πi ∈ Z. Set φ = yξ1
r ∈ E∗. Then
f = w φ. Since f ∈ E, w ∈ E and thus w ∈ (E ∩ H) \ {0}. Consequently, w ∈ A \ {0}
by (3.6). This proves the corollary. ✷

r with u
f1

1 . . . yξl

1 . . . pπr

l pz1

l pπ1

Theorem 3.3. Let (E, σ) be a basic RΠΣ∗-extension of a diﬀerence ﬁeld (F, σ). Then
(E, σ) is a simple diﬀerence ring.

Proof. Let E be given as in (3.1) with A = F and let I be a diﬀerence ideal in E with
I 6= {0}. We will show that I = E holds. Consider the basic AP S-extension (E, σ)
of (H, σ) with H = F[p1,1, p−1
]
and

δ−1,1, . . . , pδ−1,νδ−1 , p−1

1,ν1] . . . [pδ−1,1, p−1

1,1, . . . , p1,ν1 , p−1

δ−1,νδ−1

E = H[pδ,1, p−1

δ,1, . . . , pδ,νδ , p−1
δ,νδ

][y1, . . . , yl][s1,1, . . . , s1,n1] . . . [sd,1, . . . , sd,nd].

Let <1 be its lexicographical order and let lm1 and lc1 be the corresponding leading
monomial and coeﬃcient functions. Now take f ∈ I with f 6= 0 where lm1(f ) is minimal
w.r.t. <1. This implies that f ∈ H which can be seen as follows. We have that that
lm1(f ) = pπδ,1
δ,1 . . . p
for some πi,j ∈ Z, ξi ∈ N and σi,j ∈ N.
Take ˜α = pπδ,1
˜α ∈ H∗. Further, take ˜f := lc1(f ) ∈
δ,1 . . . p
H \ {0} and deﬁne

l sσ1,1
l and deﬁne α := σ( ˜α)

yξ1
1 . . . yξl
yξ1
1 . . . yξl

πδ,νδ
δ,νδ
πδ,νδ
δ,νδ

1,1 . . . s

σn,nd
n,nd

h := ˜f σ(f ) − σ( ˜f ) α f ∈ I.

By Lemma 3.1 it follows that lm1( ˜f σ(f )) = lm1(σ( ˜f ) α f )) and by construction we have
that lc1( ˜f σ(f )) = lc1(σ( ˜f ) α f )). Thus the leading monomial lm1(f ) cancels in h and
therefore lm1(h) < lm1(f ). By the choice of f it follows that h = 0. Consequently,
˜f σ(f ) = σ( ˜f ) α f . Note that H is an integral domain. By Corollary 3.2 (after reordering
the monomials to the form (2.2)) it follows that f = φ w for some φ ∈ E∗ and w ∈ H\{0}.
Hence w = 1
φ f ∈ I. Since lm1(f ) ≤ lm1(w), it follows by the deﬁnition of our lexico-
graphical order that 1 f ∈ H.

1 If δ = 1 (i.e., σ(p)
0 6= f ∈ I which implies I = E; further, Corollary 3.2 is obsolete and one needs only Theorem 2.11.

p ∈ F∗ for all P -monomials p), we are done: in this case we have f ∈ H = F with

16

1,1, . . . , p1,ν1 , p−1

1,ν1] . . . [pk−1,1, p−1

k,1, . . . , pk,νk , p−1
k,νk

Now let < be the lexicographical order with (3.3) and let lm be the corresponding leading
monomial function. Take f ′ ∈ I \ {0} such that lm(f ′) is minimal. For any f1 ∈ H and
f2 ∈ E \ H we have that lm(f1) < lm(f2). Since we showed that f ∈ H for f ∈ I with
minimal lm1(f ), it follows that f ′ ∈ H. If f ′ ∈ F, we conclude that I = E which proves
the theorem. Now suppose that f ′ /∈ F. We will show that this leads to a contradic-
tion. Let k be maximal s.t. f ′ depends on pk,1, . . . , pk,νk (with positive or negative pow-
ers). Deﬁne H′ = F[p1,1, p−1
]
k−1,νk−1
and E′ = H′[pk,1, p−1
], i.e., f ′ ∈ E′ \ H′. Now we repeat the argu-
ments from above. Let <2 be the lexicographical order for the depth-ordered exten-
sion (E′, σ) of (H′, σ) and let lm2 and lc2 be the corresponding leading monomial and
coeﬃcient functions. Now set ˜f ′
lm2(f ′) ∈ (H′)∗,
and deﬁne h′ := ˜f ′ σ(f ′) − σ( ˜f ) α′ f ′ ∈ I. As above it follows with Lemma 3.1 that
lm2(h′) <2 lm2(f ′). Note that for any f1, f2 ∈ E′ \ {0} with lm2(f1) <2 lm2(f2) we have
that lm(f1) < lm(f2). Thus lm(h′) < lm(f ′) which implies that h′ = 0 by the minimality
of f ′. Thus ˜f ′ σ(f ′) = σ( ˜f ′) α′ f ′. Since H′ is an integral domain, we use again Corol-
lary 3.2. Thus f ′ = φ′ w′ for some w′ ∈ H′ \ {0}, φ′ ∈ (E′)∗. Hence w′ = 1
φ′ f ′ ∈ I. Since
w′ ∈ H′ and f ′ /∈ E \ H′, lm(w′) < lm(f ′). This contradicts to the minimality of f ′. ✷

:= lc2(f ′) ∈ H′ \ {0} and α′ = σ(lm2(f ′))

k−1,1, . . . , pk−1,νk−1 , p−1

Remark 3.4. A related result can be deduced from [58] for Picard-Vessiot extensions.
They are deﬁned over a ground ﬁeld (F, σ) and describe precisely the solutions of lin-
ear homogeneous diﬀerence equations with coeﬃcients from F. Namely, as worked out
in Cor. 1.24 of [58] such a Picard-Vessiot extension is simple if there are no non-zero
nil-potent elements and if the constant ﬁeld of F is algebraically closed. Note that the
ﬁrst condition holds automatically for basic RΠΣ∗-extensions by Lemma 2.9; however,
the second condition is not needed to apply Theorem 3.3 for the class of basic RΠΣ∗-
extensions. Note further that Picard-Vessiot extensions and basic RΠΣ∗-extensions cover
the common class of basic RΠΣ∗-extensions where the Π-monomials are not nested, i.e.,
where their shift-quotients are from F. This subclass enables one to model nested sum
expressions over hypergeometric products and more generally over simple products (see
Section 7). In particular, it allows one to represent the so-called d’Alembertian solu-
tions [8,10] of a linear recurrence, but also the so-called Liouvillian solutions [22] by ex-
ploiting ideas from [41,40]. We notice that for this class the proof of Theorem 3.3 simpliﬁes
signiﬁcantly (see Footnote 1). In general, the results of both approaches complement each
other: basic RΠΣ∗-extensions, in particular nested Π-monomials, cannot be described by
a Picard-Vessiot extension in general, i.e., are not a solution of a homogeneous linear
recurrence with coeﬃcients from F. Conversely, solutions of linear recurrences being not
d’Alembertian (or Liouvillian) cannot be expressed within the RΠΣ∗-approach.

3.2. Simple and basic AP S-extensions over ﬁelds are RΠΣ∗-extensions

Now we want to treat the other implication. Let (E, σ) be a basic AP S-extension of a
constant-stable diﬀerence ﬁeld (F, σ). We will show in Theorem 3.10 that (E, σ) is simple if
const(E, σ) = const(F, σ) holds. More precisely, we will assume const(F, σ) 6= const(E, σ)
and will show that there is a non-trivial diﬀerence ideal I in E. Here we will exploit

Lemma 3.5. Let (E, σ) be a diﬀerence ring extension of a diﬀerence ﬁeld (F, σ), and let
h ∈ E with σ(h) = u h for some u ∈ E. Then I := h E is a diﬀerence ideal. In particular,
I = E if h ∈ E∗, and {0} ( I ( E if h 6= 0 and h /∈ E∗.

17

Proof. Obviously, I is an ideal. If h ∈ E∗, 1 ∈ I and therefore I = E. Otherwise,
if h /∈ E∗ and h 6= 0, we have that I 6= {0}. In addition, I 6= E, since otherwise
1 ∈ I, thus h u = 1 for some u ∈ E and hence h ∈ E∗. Finally, we show that I is a
diﬀerence ideal. Let f ∈ I. Then there is a w ∈ E with f = w h. Since σ(w) u ∈ E,
σ(f ) = σ(w h) = σ(w) u h = (σ(w) u) h ∈ I. Consequently, I is a diﬀerence ideal. ✷

In other words, we want to ﬁnd/compute an h as described in Lemma 3.5. In particular,
we will need that h /∈ E∗. In this regard, we will utilize the following lemma.

Lemma 3.6. Let A[t, 1
Then a + b tm /∈ A[t, 1
t ]∗.

t ] be a ring of Laurent polynomials, let a, b ∈ A∗ and m ∈ Z \ {0}.

Proof. Denote f := a + b tm. Let h = Pr

t ] with l ≤ r and hl 6= 0 6= hr
such that h f = 1 holds. Since f /∈ A, h /∈ A and therefore l < r. Suppose that m < 0.
If m + l < 0, hl b = 0 by coeﬃcient comparison at tm+l. Thus hl = 0; a contradiction.
Therefore m + l = 0, thus m + r > 0, and hence a hr = 0 by coeﬃcient comparison at
tm+r. Thus hr = 0; a contradiction. The case m > 0 is treated analogously. ✷

i=l hiti ∈ A[t, 1

The next three propositions will provide an h as proposed in Lemma 3.5 for the scenarios,
that one of the S-, P -, A-extensions is not a Σ∗-, Π-, R-extension, respectively.

Proposition 3.7. Let (E, σ) be a basic AP S-extension of (F, σ) with (2.2) where A = F
is a ﬁeld. Suppose that su is not a Σ∗-monomial but that y1, . . . , yl, p1, . . . , pr, s1, . . . , su−1
are RΠΣ∗-monomials; let H = Fhy1i . . . hylihp1i . . . hprihs1i . . . hsu−1i. Then there is an
f ∈ H with su − f ∈ const(E, σ) \ {0}. Any element of this form is not a unit.

Proof. Let β := σ(su) − su ∈ H. Since su is not a Σ∗-monomial, there is an f ∈ H with

σ(f ) − f = β

(3.7)

by Theorem 2.4. Thus σ(su − f ) = su − f , i.e., su − f ∈ const(H[su], σ) \ {0}. By part (1)
of Lemma 2.9 it follows that H is reduced and thus by part (2) of Lemma 2.9 we conclude
that E∗ = H∗. Thus any su − f with f ∈ H is not a unit. ✷

Proposition 3.8. Let (E, σ) be a basic AP S-extension of (F, σ) with (2.2) where A = F
is a ﬁeld. Suppose that pu is not a Π-monomial but that y1, . . . , yl, p1, . . . , pu−1 are RΠ-
monomials. Then there are ξ1, . . . , ξl ∈ N, π1, . . . , πu ∈ Z with πu 6= 0 and w ∈ F∗ with
1 − w yξ1

u ∈ const(E, σ) \ {0}. Any element of this form is not a unit.

1 . . . pπu

1 . . . yξl

l pπ1

Proof. Let H = Fhy1i . . . hylihp1i . . . hpu−1i and let α := σ(pu)/pu. Note that α =
u pz1
u−1 with zi ∈ Z and u ∈ F∗. Since pu is not a Π-monomial, there exists
an f ∈ H \ {0} and an m ∈ Z \ {0} such that

1 . . . pzu−1

σ(f ) = αm f

(3.8)

l pπ1

1 . . . pπu−1

u−1 p−m

1 . . . yξl

holds by Theorem 2.4. By Theorem 2.11, we conclude that (2.4) holds for some w ∈
F∗, ξi ∈ N and πi ∈ Z. In particular, f ∈ E∗. Consequently, we get ˜h := f p−m
u =
u = ˜h. Clearly, 1 − ˜h ∈
w yξ1
const(E, σ) \ {0}. Now reorder the generators in E by putting pu on top, say we get
E = H[pu, 1
] for a ring H which contains the other generators of E. Note that f ∈ H∗.
pu
u = 1 − ˜h is not a unit in H[pu, 1
Thus 1 − f p−m
pu

u with σ(˜h) = σ(f ) σ(p−m

] = E by Lemma 3.6. ✷

u ) = f p−m

18

Proposition 3.9. Let (E, σ) be a basic AP S-extension of (F, σ) as given in (2.2) (A = F)
where (F, σ) is a constant-stable diﬀerence ﬁeld. Suppose that yu is not an R-monomial
but that y1, . . . , yu−1 are R-monomials. Then there are ξ1, . . . , ξu ∈ N with 0 < ξu <
ord(yu) and 1 − yξ1

u ∈ const(E, σ) \ {0}. Any such element is not a unit.

1 . . . yξu

∈ const(F, σ)∗ with λ := ord(yu). We
Proof. Let H = Fhy1i . . . hyu−1i and let α := σ(yu)
yu
start as in the proof of Proposition 3.8. Since yu is not an R-monomial, there exists an
f ∈ H \ {0} and an m ∈ N with 0 < m < λ such that (3.8) holds by Theorem 2.4. By
Theorem 2.11, we conclude that (2.4) holds for some w ∈ F∗ and ξi ∈ N. Consequently,
we get ˜h := f y−m
u = ˜h. Deﬁne

u with σ(˜h) = σ(f ) σ(p−m

u ) = f p−m

u = w yξ1

1 . . . yξu−1

u−1 y−m
a := yξ1

1 . . . yξu−1

u−1 y−m
u .

(3.9)

with 1 ≤ i ≤ l are roots

Then σ(a) = u a with u = w/σ(w) ∈ F∗. Since the σ(yi)
yi
of unity, also u = σ(a)
is a root of unity. More precisely, let λi = ord(yi) and set
a
ρ = lcm(λ1, . . . , λu) > 0. Then aρ = uρ = 1. With σ(w) = 1
u w, we get σρ(w) =
u−ρ w = w, i.e., w ∈ const(F, σρ). Since (F, σ) is constant-stable, w ∈ const(F, σ). With
w a = ˜h = σ(˜h) = σ(w) σ(a) = w σ(a), we conclude that σ(a) = a. In particular,
σ(1 − a) = 1 − a. Now take any a as given in (3.9) with 1 ≤ m < λ. As above we can
take a ρ > 0 with aρ = 1. We show that 1 − a is not a unit. Clearly, 1 − a 6= 0 (otherwise,
a = 1 or equivalently ym
u = 1 would not be
the deﬁning relation of our A-monomial). Now deﬁne b = 1 + a + · · · + aρ−1. Note that
the term a given in (3.9) has the coeﬃcient 1. Hence the term ai with i ≥ 1 has again
the coeﬃcient 1. This implies that the arising monomials cannot cancel themselves and
thus b 6= 0. Finally, observe that (1 − a) b = 1 − aρ = 0. Thus 1 − a is a zero divisor which
implies that 1 − a ∈ const(E, σ) \ E∗. ✷

u−1 with 0 < m < λ and thus yλ

1 . . . yξu−1

u = yξ1

Combining these propositions with Theorem 3.3 produces the main result of this section.

Theorem 3.10 (Characterization of RΠΣ∗-extensions (I)). Let (E, σ) be a basic AP S-
extension of a diﬀerence ﬁeld (F, σ). Suppose that (F, σ) is constant-stable or that all
A-monomials are R-monomials. Then the following two statements are equivalent.

(1) (E, σ) is a basic RΠΣ∗-extension of (F, σ) (i.e., const(E, σ) = const(F, σ)).
(2) (E, σ) is a simple diﬀerence ring.

Proof. (1) ⇒ (2) follows by Theorem 3.3 ((F, σ) need not be constant-stable). What
remains to show is the direction (2) ⇒ (1). Suppose that (E, σ) is not an RΠΣ∗-extension
of (F, σ). Reorder the monomials in the form (2.2) (with A = F). If one of the yi is not
an R-monomial, we may assume in addition that (F, σ) is constant-stable and we can
apply Proposition 3.9. Otherwise, if all yi are R-monomials, but one of the pi is not
a Π-monomial, we apply Proposition 3.8. If all yi and pi are RΠ-monomials, we apply
Proposition 3.7. In any case, it follows that there exists an h ∈ const(E, σ) \ (E∗ ∪ {0}).
Hence by Lemma 3.5 it follows that I := h E is a diﬀerence ideal with {0} ( I ( E.
Consequently (E, σ) is not simple. ✷

Remark 3.11. Lemma 1.8 in [58] also provides the implication (2) ⇒ (1) in the following
general setting: it holds if the extension (E, σ) of (F, σ) is a ﬁnitely generated F-algebra,
but it relies on the assumption that const(F, σ) is algebraically closed.

19

3.3. Constructing non-trivial diﬀerence ideals in basic AP S-extensions

Let (F, σ) be a diﬀerence ﬁeld as introduced in Remark 2.12. Note that these diﬀerence
ﬁelds are constant-stable; see Remark 2.19. Moreover, let (E, σ) with E = Fht1i . . . htei be
an AP S-extension of (F, σ). Then the existence proof of a non-trivial diﬀerence ideal in
Theorem 3.10 turns to a constructive version. Namely, as worked out in Remark 2.12 we
can check iteratively, if the AP S-monomials ti with i = 1, 2, 3 . . . are RΠΣ∗-monomials.
In this way we can check if (E, σ) is an RΠΣ∗-extension of (F, σ), i.e., if (E, σ) is simple.
If it is not an RΠΣ∗-extension, we will discover a k with 1 ≤ k ≤ e such that the
t1, . . . , tk−1 are RΠΣ∗-monomials, but tk is not an RΠΣ∗-monomial. Namely, exactly
f ∈ H := Fht1i . . . htk−1i with (3.7) or f ∈ H and m 6= 0 (m ∈ Z or 0 < m < ord(yu))
with (3.8) are calculated to verify that tk is not an RΠΣ∗-monomial. Given such a witness,
we can now construct the h ∈ const(E, σ) \ (E∗ ∪ {0}) as given in the Propositions 3.9, 3.8
and 3.7. This ﬁnally yields the diﬀerence ideal I = h E with {0} ( I ( E that witnesses
that (E, σ) is not a simple diﬀerence ring.

Example 3.12. We demonstrate this constructive aspect for the diﬀerent cases.

(1) Consider the diﬀerence ring from Example 2.14. We checked that (A5, σ) is an
RΠΣ∗-extension of (K(x), σ) and thus (A5, σ) is a simple diﬀerence ring. However,
t2 is not a Σ∗-monomial. Thus (A6, σ) is not simple by Theorem 3.10. E.g., we
obtain c as given in (2.5) with σ(c) = c. By Proposition 3.7 c is not a unit and thus
I = hci is a diﬀerence ideal with {0} ( I ( A6 by Lemma 3.5.

][p2, 1
p2

(2) Consider the diﬀerence ring from Example 2.16. We checked that (A, σ) with A =
K(x)[y][p1, 1
] is an RΠ-extension of (K(x), σ) and thus (A, σ) is a simple
p1
diﬀerence ring. However, p3 is not a Π-monomial and thus (A[p3, 1
], σ) is not
p3
simple. By Lemma 3.5 and Proposition 3.8 we get the diﬀerence ideal I = h1 − ci
with c given in (2.7) where {0} ( I ( A[p3, 1
p3

].

(3) Consider the diﬀerence ring from Example 2.15. We checked that (A, σ) with A =
K(x)[y1][y2] is an R-extension of (K(x), σ) and thus (A, σ) is a simple diﬀerence ring.
However, y3 is not an R-monomial and thus (A[y3], σ) is not simple. By Lemma 3.5
and Proposition 3.9 we get the diﬀerence ideal I = h1 − ci with c given in (2.6)
where {0} ( I ( A[y3].

3.4. Constructing maximal diﬀerence ideals in S-extensions

Suppose we are given a basic AP S-extension (E, σ) of a diﬀerence ﬁeld (F, σ) where
(E, σ) is not simple. Moreover, assume that we are given a maximal reﬂexive diﬀerence
ideal I in (E, σ). Then by Lemma 1.7 in [58] this leads to a simple diﬀerence ring (E/I, σ).
A natural question is how one can construct such an ideal I and how one can design an
RΠΣ∗-extension (H, σ) of (F, σ) such that (E/I, σ) ≃ (H, σ) holds. This construction is
of particular interest in order to construct a Picard-Vessiot extension explicitly.
In the following we skip the AP -extension case and refer to related results in [46,55] where
it is shown that an expression in terms of ﬁnitely many hypergeometric products can be
represented within RΠ-extensions; for further details and generalizations see Remark 7.4
below. In this regard we refer also to the special case of c-ﬁnite sequences [28]. Now we
assume that we are given an RΠ-extension (A, σ) of (F, σ) in which all our products are
formulated. Then using the tools from above we can process a tower of S-extensions and
can construct a maximal diﬀerence ideal with the described properties as follows.

20

Theorem 3.13. Let (A[t1] . . . [te], σ) be an S-extension of (A, σ) with σ(ti) = ti + βi for
1 ≤ i ≤ e where K := const(A, σ) is a ﬁeld. Then there is a maximal reﬂexive diﬀerence
ideal I in A[t1] . . . [te] and a Σ∗-extension (A[s1] . . . [sr], σ) of (A, σ) with a diﬀerence ring
isomorphism µ : A[t1] . . . [te]/I → A[s1] . . . [sr]. In particular, the following holds.

(1) There are i1, . . . , ie−r ∈ N with 1 ≤ i1 < i2 < · · · < ie−r ≤ e and gj ∈
A[t1, . . . , tij −1] for 1 ≤ j ≤ e − r such that I = hti1 − g1, ti2 − g2, . . . , tie−r − ge−ri.
(2) Let {1, 2, . . . , e} \ {i1, i2, . . . , ie−r} = {k1, k2, . . . , kr} with k1 < k2 < · · · < kr. Then
µ can be given by µ(f + I) = f for f ∈ A, µ(tij + I) = µ(gj + I) for 2 1 ≤ j ≤ e − r
and µ(tkj + I) = sj + cj for 1 ≤ j ≤ r; the cj ∈ K can be freely chosen.

(3) If one can solve the telescoping problem in (A, σ), then the ideal I, the Σ∗-extension

(A[s1] . . . [sr], σ) of (A, σ) and the isomorphism µ can be given explicitly.

Proof. We show the theorem by induction on e. For e = 0 we take I = h i = {0} and the
statement holds trivially. Now suppose that the theorem holds for e ≥ 0 extensions. For
(E, σ) with E = A[t1] . . . [te] we can take a maximal ideal I = hti1 − g1, ti2 − g2, . . . , tie−r −
ge−ri with 0 ≤ r ≤ e which is closed under σ and σ−1. Further, we can take a Σ∗-extension
(S, σ) of (A, σ) with S = A[s1] . . . [sr] together with the diﬀerence ring isomorphism
µ : A[t1] . . . [te]/I → A[s1] . . . [sr] as claimed in the theorem. Consider the S-extension
(E[te+1], σ) of (E, σ) with σ(te+1) = te+1 + βe+1.
•Case 1. Suppose that there exists a g ∈ S with σ(g) − g = µ(βe+1 + I). Thus with
g′ := µ−1(g) ∈ E/I we get σ(g′) = g′+(βe+1+I). Moreover, σ(te+1) = te+1+βe+1 implies
σ(te+1 + I) = (te+1 + I) + (βe+1 + I). Consequently, σ((te+1 + I) − g′) = (te+1 + I) − g′.
Take ge−r+1 ∈ E with g′ = ge−r+1 + I. Obviously,

σ(ge−r+1 + I) = (ge−r+1 + βe+1) + I.

(3.10)

Moreover, σ(te+1 − ge−r+1) = te+1 − ge−r+1 + h for some h ∈ I and thus σ−1(te+1 −
ge−r+1) = te+1 −ge−r+1−σ−1(h). Consequently ˜I := (te+1 −ge−r+1)E+I = hti1 −g1, ti2 −
g2, . . . , tie−r − ge−r, tie−r+1 − ge−r+1i with ie−r+1 = e + 1 is a maximal and reﬂexive
diﬀerence ideal. Hence we can construct the diﬀerence ring (E[te+1]/ ˜I, σ). Identifying the
elements of h + I ∈ E/I with h + ˜I turns (E[te+1]/ ˜I, σ) into a diﬀerence ring extension
of (E/I, σ). Observe that ρ : E[te+1]/ ˜I → E/I with ρ(f + ˜I) = f |te+1→ge−r+1 + I forms a
ring isomorphism. Hence ρ is a diﬀerence ring isomorphism by

ρ(σ(te+1 + ˜I)) =ρ(te+1 + βe+1 + ˜I) = ρ(te+1 + ˜I) + ρ(βe+1 + ˜I)

=ge−r+1 + βe+1 + I

(3.10)
= σ(ge−r+1 + I) = σ(ρ(te+1 + ˜I)).

Consequently, we obtain the diﬀerence ring isomorphism µ′ : E[te+1]/ ˜I → S with µ′ :=
µ ◦ ρ. Note that the isomorphism is uniquely determined by µ′(f + ˜I) = µ(f + I) for all
f ∈ E and µ′(te+1 + ˜I) = µ(ge−r+1 + I)(= g).
•Case 2. Suppose that there is no g ∈ S with σ(g) = g +µ(βe+1 +I). This implies that one
can construct the Σ∗-extension (S[sr+1], σ) of (S, σ) with σ(sr+1) = sr+1 + µ(βe+1 + I).
Consider I as an ideal in E and in E[te+1]. Then (E[te+1]/I, σ) turns to a diﬀerence ring
which is a diﬀerence ring extension of (E/I, σ). Moreover, we get the ring isomorphism

2 Note that µ is constructed iteratively; see the proof below. Particularly, the application of µ to gj + I
is deﬁned before the application of µ to tij + I.

21

µ′ : E[te+1]/I → S[sr+1] deﬁned by µ′|E/I = µ and µ′(te+1 + I) = sr+1 + c; here c ∈ K
can be chosen arbitrarily. Finally, with
µ′(σ(te+1+I)) = µ′(te+1+βe+1+I) = sr+1+c+µ(βe+1+I) = σ(sr+1+c) = σ(µ′(te+1+I))
we conclude that µ′ is a diﬀerence ring isomorphism. Thus parts (1) and (2) are proven.
Now suppose that one can solve the telescoping problem in (A, σ). By the induction
assumption we can construct I, µ and (S, σ). By iterative application of [57, Thm. 7.1]
(or Theorem 6.1 below) one can solve the telescoping problem in (S, σ). Hence one can
decide algorithmically, if there exists a g ∈ S with σ(g) = g + µ(βe+1 + I). This turns
parts (1) and (2) to constructive versions and proves part (3) of the theorem. ✷

Example 3.14. Consider the diﬀerence ring from Example 2.1. In the following we set
A = Q(n)(x)[y][p1, 1
] where const(A, σ) = Q(n) and apply the construction given
p1
in the proof of Theorem 3.13 for the S-extension (A[t1][t2][t3], σ) of (A, σ). As observed
in Example 2.14 the S-monomial t1 with σ(t1) = t1 + β1 and β1 = −y
x+1 is a Σ∗-monomial.
Thus we are in case 2 and construct the Σ∗-extension (A[s1], σ) of (A, σ) with

][p2, 1
p2

σ(s1) = s1 + β1 = s1 +

−y
x + 1

.

(3.11)

Moreover, we set I0 := hi = {0} and deﬁne the diﬀerence ring isomorphism µ : A[t1]/I0 →
A[s1] with µ(f + I0) = f for all f ∈ A and µ(t1 + I0) = s1 + c1 for some c1 ∈ Q(n); here
we choose c1 = 0 and get

µ(t1 + I0) = s1.

(3.12)
(x+1)(x+2) . Here we
Now we turn to the S-monomial t2 with σ(t2) = t2 + β2 and β2 = −
ﬁnd g = 2(x+1)s1−y
+ c′ ∈ A[s1] with c′ ∈ Q(n) such that σ(g) − g = µ(β2) = β2 holds.
Thus we are in case 1 of our construction. In the following we specialize to c′ = 1. Hence
we take g′ := µ−1(g) = 2(x+1)t1−y
+ 1 ∈ E with
g′ = g2 + I0. This gives the reﬂexive diﬀerence ideal

+ 1 + I0 and obtain g2 = 2(x+1)t1−y

x+1

x+1

x+1

y

I = ht2 − g2i = {h(cid:0)t2 − 2(x+1)t1−y

x+1

+ 1)(cid:12)(cid:12)h ∈ A[t1]},

(3.13)

and we can construct the diﬀerence ring extension (A[t1][t2]/I, σ) of (A[t1], σ) together
with the diﬀerence ring isomorphism µ′ : A[t1][t2]/I → A[s1] with µ′(f + I) = µ(f + I0)
for all f ∈ E[t1] and µ′(t2 + I) = µ(g′ + I0) = µ(g′) = g. For simplicity we use again µ
instead of µ′ and get

µ(t2 + I) = 2(x+1)s1−y

(3.14)
Finally, we turn to the S-monomial t3 with σ(t3) = t3 + β3 and β3 = 1−(x2+3x+2)yt2
This time we do not ﬁnd a g ∈ A[s1] with σ(g) − g = µ(β3 + I) = 3+x−(x+1)(x+2)y(2s1+1)
Being in case 2 we construct the Σ∗-extension (A[s1][s2], σ) of (A[s1], σ) with

(x+1)2(x+2)

(x+1)2(x+2)

+ 1.

x+1

.

.

σ(s2) = s2 + µ(β3 + I) = s2 + 3+x−(x+1)(x+2)y(2s1+1)

(x+1)2(x+2)

.

(3.15)

Considering I as an ideal in A[t1][t2][t3] we can extend µ to µ : A[t1][t2][t3]/I → A[s1][s2]
with µ(t3 + I) = s2 + c2 for some c2 ∈ Q(n). Here we specialize c2 to 0, i.e, we deﬁne

µ(t3 + I) = s3.

(3.16)

Summarizing, we constructed the maximal reﬂexive diﬀerence ideal I in (A[t1][t2][t3], σ)
given in (3.13) and we constructed the Σ∗-extension (A[s1][s2], σ) of (A, σ) with (3.11)

22

and (3.15) such that µ : A[t1][t2][t3]/I → A[s1][s2] is a diﬀerence ring isomorphism with
µ(f + I) = f for all f ∈ A, and (3.12) with I0 replaced by I, (3.14) and (3.16). Note that
the construction of µ (with the choices c1 = 0, c′ = 1 and c2 = 0) encodes the identities

E1(k) =E1(k),

E2(k) = 2

E3(k) =

k

Pi=1(cid:16) −1

i(1 + i)

+

k

(−1)i

−

i
(−1)i(1 + i)

Pj=1
i(1 + i) (cid:16)1 + 2

(−1)k
k + 1

+ 1,

i

Pj=1

(−1)j

j (cid:17)(cid:17),

(3.17)

respectively; here the left and right hand sides are the representations in (A[t1][t2][t3], σ)
and (A[s1][s2], σ), respectively. From the viewpoint of symbolic summation further details
will be given in Example 7.6. Notably we will explain how the c′, c1, c2 are determined
and how the elements from (A[s1][s2], σ) are reinterpreted to get (3.17).

4.

Idempotent representations of basic RΠΣ∗-extensions

In [58, Corollary 1.16] (compare also [21]) it has been worked out that a Picard-Vessiot
ring extension, and more generally, a ﬁnitely generated diﬀerence ring extension (E, σ)
of (F, σ) can be decomposed in the form

E = e0 E ⊕ e2 E ⊕ · · · ⊕ en−1 E

(4.1)

for some idempotent elements es ∈ E (i.e., e2
s = es) with 0 ≤ s < n such that es E forms
an integral domain. In particular, given this representation for a simple diﬀerence ring
(E, σ), it has been shown for 0 ≤ s < n that (es E, σn) is a simple diﬀerence ring and
that σ is a diﬀerence ring isomorphism between (es E, σn) and (es+1 mod n E, σn).
Inspired by this result, we will elaborate in Theorem 4.3 such a decomposition for basic
RP S (and RΠΣ∗-extensions) in a very explicit form. This representation will lead to
further characterizations of RΠΣ∗-extensions in Theorem 4.9.

Let (F, σ) be a diﬀerence ﬁeld with K = const(F, σ), and take a basic RP S-extension

(E, σ) of (F, σ) of the form

(4.2)
E = F[y]ht1i . . . htei
where y is an R-monomial of order n with α := σ(y)
and where the ti with 1 ≤ i ≤ e
y
are P S-monomials with σ(ti) = αi ti + βi (note that either αi = 1 or αi ∈ (F∗)E
F with
βi = 0). We remark that the case that several basic R-monomials are involved can be
reduced to this situation by Lemma 2.22. Now take

˜es = ˜es(y) :=

(y − αj )

n−1

Qj=0

j6=n−1−s

for 0 ≤ s < n. Since α is a primitive root of unity by Proposition 2.20, ˜es(αn−1−s) 6= 0.
Thus we can deﬁne

es = es(y) :=

˜es(y)

˜es(αn−1−s)

(4.3)

for 0 ≤ s < n. It will be convenient to denote by s mod n with s ∈ Z the unique value
l ∈ {0, . . . , n − 1} with n | s − l. By construction it follows that for 0 ≤ s < n and
0 ≤ i < n we have that

es(α y) = es+1 mod n

and

es(αi) =(1

0

if i = n − 1 − s
if i 6= n − 1 − s.

(4.4)

23

First, we will show that the es ∈ E are idempotent, pairwise orthogonal and sum up to 1.
For this result and later considerations we will use the following simple lemma.

Lemma 4.1. Let A be an integral domain and consider the ring A[y] subject to the
i=0 gi yi with fi, gi ∈ A and

f (λi) = g(λi) for distinct {λ1, . . . , λn} ⊆ A. Then f = g.

i=0 fi yi and g =Pn−1
relation yn = 1 with n > 1. Let f =Pn−1
Proof. Consider the ring of polynomials A[z] and deﬁne ˜f =Pn−1

i=0 gizi ∈
A[z]. Take h := ˜f − ˜g ∈ A[z]. Then h(λi) = 0 for all 0 ≤ i < n. Since A is an integral
domain, we have h = 0. Therefore ˜f = ˜g and hence f = g. ✷

i=0 fizi, ˜g =Pn−1

Lemma 4.2. Let F be a ﬁeld and let α be a primitive nth root of unity. Let F[y] be a
ring subject to the relation yn = 1. Then the e0, . . . , en−1 deﬁned in (4.3) are idempotent,
they are pairwise orthogonal and we have that e0 + · · · + en−1 = 1.

Proof. Let 0 ≤ r < n and deﬁne w(y) = er(y)2 =Pn−1

i=0 hiyi for some hi ∈ F. By (4.4)
we have that w(αj ) = er(αj )2 = er(αj ) for 0 ≤ j < n, i.e., e(y) and w(y) have n distinct
common evaluation points. By Lemma 4.1 we get er(y) = w(y) = er(y)2.
For 0 ≤ i, j < n and i 6= j it is easy to verify that factors in ei(y) ej(y) produce yn − 1
which shows that ei(y) ej(y) = 0 holds. Hence the ei are pairwise orthogonal. Finally,
deﬁne f (y) = e0(y) + · · · + en−1(y) − 1. Then f (αi) = 0 for 0 ≤ i < n by (4.4). Thus
0 = f = e0 + · · · + en−1 − 1 by Lemma 4.1. ✷

Given these idempotent elements, we get the decomposition (4.1) where the es E with
0 ≤ s < n are rings with the multiplicative identity es. We will elaborate in the following
Theorem 3 4.3 that the (es E, σn) are P S-extensions of (F, σn). In particular, we will show
that they form ΠΣ∗-extensions if (E, σ) is an RΠΣ∗-extension of (F, σ).

Theorem 4.3. Let (E, σ) be a basic RP S-extension of a diﬀerence ﬁeld (F, σ) with (4.2)
where y is an R-monomial of order n with α = σ(y)
y . Let e0, . . . , en−1 be the idempotent,
pairwise orthogonal elements deﬁned in (4.3) that sum up to one. Then:

(1) We get the direct sum (4.1) of the rings es E with the multiplicative identities es.
(2) We have that es E = es ˜E with the integral domain
˜E := Fht1i . . . htei.

(4.5)

(3) For all 0 ≤ s < n, (es ˜E, σn) is a P S-extension of (es F, σn).
(4) σ is a diﬀerence ring isomorphism between (es ˜E, σn) and (es+1 mod n ˜E, σn).
(5) If (E, σ) is an RΠΣ∗-extension of (F, σ), (es ˜E, σn) is a ΠΣ∗-extension of (es F, σn)
for 0 ≤ s < n. Further, if (F, σ) is constant-stable, const(es E, σn) = es const(F, σ).

One can deduce Theorem 4.3 by taking [58, Corollary 1.16], specializing it to the above
form with some extra arguments and using Theorem 3.10. However, this result can be
proven directly with straightforward arguments. In the remaining part of this section we
will tackle the diﬀerent sub-statements and will illustrate them by concrete examples.
Special emphasis will be put on technical details that are relevant for concrete calculations
in Section 6. In addition, further characterizations of RΠΣ∗-extensions will be provided.

3 The simplest case E = F[y] has been handled also in [20, Cor. 3.35].

24

Pn−1
consider the map ρ : E → E deﬁned by Pn−1
Now deﬁne ˜f (y) := ρ(f ). Then observe that ˜f (αn−1−s) = Pn−1

Proof of parts (1) and (2) of Theorem 4.3: Any f ∈ E can be written in the form f =
i=0 fi yi where fi are entries from the integral domain (4.5). Using this representation
i=0 ei ˜fi with ˜fi = f (αn−1−s).
˜fi ei(αn−1−s) = ˜fs =
f (αn−1−s) for all 0 ≤ s < n. Since α is primitive, i.e., all αs with 0 ≤ s < n are
distinct, f = ˜f by Lemma 4.1. In other words, if we consider E as an ˜E-module with the
basis y0, . . . , yn−1, then also e0, . . . , en−1 is a basis and ρ is a basis transformation. In
particular, this produces the direct sum

i=0 fi yi 7→ Pn−1

i=0

E = e0 ˜E ⊕ · · · ⊕ en−1 ˜E

of modules. Note that es ˜E with 0 ≤ s < n is an integral domain with the multiplicative
identity es. Hence we obtain a direct sum of rings. In particular, for f ∈ E we get

es f = es f (αn−1−s)

(4.6)

with f (αn−1−s) ∈ ˜E and thus es E = es ˜E. This shows parts (1) and (2).

✷(1,2)

Before we continue with the remaining parts of Theorem 4.3, we summarize the following
properties that are useful to carry out basic operations.

Lemma 4.4. Let (E, σ) be a basic RP S-extension of a diﬀerence ﬁeld (F, σ) with (4.2).

i=0 ei(fi gi).

i=0 ei gi ∈ E with fi, gi ∈ ˜E = Fht1i . . . htei. Then:

hi = σ(hi−1 mod n)|y→αn−1−i .

i=0 ei fi ∈ E and g =Pn−1

Let f =Pn−1
(1) f + g =Pn−1
(2) σ(f ) = e0 σ(fn−1) + e1 σ(f0) + · · · + en−1 fn−2 = Pn−1
(3) σn(f ) =Pn−1
Proof. (1) f + g =Pn−1

i=0 ei (fi + gi) and f g =Pn−1
i=0 ei σn(fi) =Pn−1

i=0 ei fi gi follows
since the ei are idempotent and pairwise orthogonal. By (4.4) we get σ(en−1) = e0 and
σ(ei) = ei+1 for 0 ≤ i < n − 1. With w0(y) := σ(fn−1) and wi(y) := σ(fi−1) for 1 ≤
i < n we obtain w(y) := σ(f ) = e0(y) w0(y) + e1(y) w1(y) + · · · + en−1(y) wn−1(y). With
hi := w(αn−1−i) = wi(αn−1−i) ∈ ˜E we get part (2). Part (3) is implied by part (2). ✷

i=0 ei (fi + gi) follows by linearity and f g =Pn−1

i=0 ei hi with hi = σn(fi)|y→αn−1−i ∈ ˜E.

i=0 ei hi with hi ∈ ˜E where

x+1 p2, σ(s1) = s1 + −y

Example 4.5. Take the ΠΣ∗-ﬁeld (F, σ) over Q(n) with F = Q(n)(x) and σ(x) = x + 1
and consider the RΠΣ∗-extension (E, σ) of (F, σ) with E = F[y][p1, 1
][p2, 1
][s1][s′
2]
p2
p1
where σ(y) = −y, σ(p1) = 2 p1, σ(p2) = n−x
2 + 1
x+1 and σ(s′
2) = s′
(x+1)2 .
In this diﬀerence ring we get the idempotent elements e0 = 1−y
2 . Thus
2
E = e0 E⊕e1 E = e0 ˜E⊕e1 ˜E with ˜E = F[p1, 1
x+1 +
p1
(x+1)2(x+2) ∈ ˜E and
(x+1)2(x+2) ∈ E we get f = e0 f0 + e1 f1 with f0 = f |y→−1 = 2s1
f1 = f |y→1 = − 2s1
1 with
0 = σ(f1)|y→−1 = − 2s1
f ′
(x+1)(x+2)2(x+3) .
Furthermore, we get σ2(f ) = σ(e0 f ′
1)|y→−1 =
x4+11x3+45x2+81x+58
(x+1)(x+2)(x+3)2(x+4) + 2s1
x+3 and f ′′
x+3 . Note
that f ′′

(x+1)2(x+2) ∈ ˜E. Similarly, we have that σ(f ) = e0 f ′
x+2 − x3+7x2+16x+14

1) = e0 f ′′
0)|y→1 = − x4+9x3+25x2+19x−10

and e1 = 1+y
2]. E.g., for f = − 2ys1

(x+1)(x+2)(x+3)2(x+4) − 2s1

(x+1)(x+2)2(x+3) and f ′

x+2 + x3+5x2+6x−2

0 + e1 f ′
1 = σ(f ′

1 = σ(f0)|y→1 = 2s1

x+1 + x2+4x+5

x+1 − x2+2x−1

0 + e1 f ′′

1 with f ′′

0 = σ(f ′

0 = σ2(f0)|y→−1 and f ′′

1 = σ2(f1)|y→1.

][p2, 1
p2

][s1][s′

x+3

x+1 − y

0 + e1 f ′

Proof of parts (3) and (4) of Theorem 4.3: es ˜E is a ring with the multiplicative identity
es for 0 ≤ s < n. Moreover, σn : es ˜E → es ˜E is a ring automorphism by part 3 of

25

Lemma 4.4. Hence (es ˜E, σn) is a diﬀerence ring. Since es F is a subring of es ˜E, (es ˜E, σn)
is a diﬀerence ring extension of (es F, σn). For 1 ≤ i ≤ e we can write σn(ti) = ˜αi ti + ˜βi
F ⊆ ˜E and β = 0 (if ti is a P -monomial), or α = 1 and ˜βi ∈ E (if ti is an
with ˜αi ∈ (F∗)E
S-monomial). Now deﬁne the ring automorphism σs : ˜E → ˜E for each 0 ≤ s < n with

(4.7)
for all 1 ≤ i ≤ e. It is immediate that (˜E, σs) is a P S-extension of (F, σn), and that for
f ∈ ˜E we have

σs(ti) = ˜αi ti + ( ˜βi|y→αn−1−s)

(4.8)
Furthermore, we extend σs from ˜E to es ˜E = es E with σs(es) = es for 0 ≤ s < n. Then
(es ˜E, σs) is also a P S-extension of (es F, σn), and for f ∈ ˜E we have

σs(f ) = σn(f )|y→αn−1−s.

σs(es f ) = esσs(f )

(4.8)
= esσn(f )|y→αn−1−s

(4.6)
= esσn(f ) = σn(es f ).

Summarizing, we obtain the diﬀerence ring isomorphisms

(es E, σn) ≃ (es ˜E, σn) ≃ (es ˜E, σs)

(4.9)

where the ﬁrst isomorphism is given by rewriting the elements with (4.6) and the second
isomorphism is just the identity map. This completes part (3) of Theorem 4.3.
By Lemma 4.4 it follows that for all f ∈ es E we have that σ(f ) ∈ es+1 mod n E. More-
over, for all f ∈ es+1 mod n E we have that σ−1(f ) ∈ es E. Furthermore, σ(σn(f )) =
σn(σ(f )) for all f ∈ es E. Hence σ is a diﬀerence ring isomorphism between (es E, σn)
and (es+1 mod n E, σn). This establishes part (4) of Theorem 4.3. Note that (˜E, σs) and
(˜E, σs+1 mod n) are isomorphic by τs : ˜E → ˜E with τs(f ) = σ(f )|y→αn−2−s.
✷(3,4)

Example 4.6. We continue with Example 4.5. We obtain the P S-extension (E, σ2) of
(F, σ2) with σ2(x) = x + 2, σ2(y) = y and

σ2(p1) = 4 p1,

σ2(s1) = s1 −

σ2(p2) =

(n − x)(−1 + n − x)

(x + 1)(x + 2)

p2,

σ2(s′

2) = s′

2 −

+

x + 1
1
(x + 1)2 −

1

(x + 2)2 .

y

y

,

x + 2

Furthermore, with ˜E = Fhp1ihp2i[s1]s′

2], we get the P S-extension (˜E, σ0) of (F, σ2) with

σ0(p1) = 4 p1,

σ0(s1) = s1 +

σ0(p2) =

(n − x)(−1 + n − x)

(x + 1)(x + 2)

p2,

and the P S-extension (˜E, σ1) of (F, σ2) with

σ0(s′

2) = s′

2 −

σ1(p1) = 4 p1,

σ1(s1) = s1 −

σ1(p2) =

(n − x)(−1 + n − x)

(x + 1)(x + 2)

p2,

σ1(s′

2) = s′

2 −

1

1

,

,

(x + 1)(x + 2)
2x2 + 6x + 5

(x + 1)2(x + 2)2

(x + 1)(x + 2)
2x2 + 6x + 5
(x + 1)2(x + 2)2 .

In particular, it follows that σ2(f ) = e0 f ′′
1 = σ1(f1) as
given in Example 4.5. Furthermore, with σs(es) := es we get (es ˜E, σs) ≃ (es E, σ2) with
s ∈ {0, 1}. Moreover, (e0 ˜E, σ2) and (e1 ˜E, σ2) are isomorphic by σ. In addition, (˜E, σ0)
and (˜E, σ1) are isomorphic by τ0 : ˜E → ˜E with τ0(f ) = σ(f )|y→1.

0 = σ0(f0) and f ′′

1 with f ′′

0 + e1 f ′′

26

In order to show part (5) of Theorem 4.3 we rely on the following lemma.

Lemma 4.7. Let (E, σ) be the RP S-extension of a diﬀerence ﬁeld (F, σ) with (4.2).

i=0 ei fi ∈ E \ {0} with fi ∈ ˜E where ˜E := Fht1i . . . htei. Then:

Furthermore, let f =Pn−1

(1) f is a zero-divisor iﬀ fs = 0 for some 0 ≤ s < n.
(2) If f is not a zero-divisor, then f is a unit in Q(˜E)[y].
(3) f ∈ E iﬀ fs ∈ ˜E∗ = (F∗)

˜E
F for 0 ≤ s < n.

is a zero-divisor. Conversely, suppose that fs 6= 0 for all 0 ≤ s < n and let h =Pn−1

Proof. (1) If fs = 0 for some 0 ≤ s < n, take h ∈ esE\{0}. Since f h = 0 by Lemma 4.4, f
i=0 ei hi
with hi ∈ ˜E and 0 = f h = e0 (f0 h0) + · · · + en−1 (fn−1 hn−1). Hence fs hs = 0 and thus
hs = 0 for all 0 ≤ s < n. Therefore h = 0, and consequently f is not a zero-divisor.
(2) Suppose that f is not a zero-divisor. Then fi ∈ ˜E \ {0} for 0 ≤ i < n by the
ﬁrst part of the lemma. Hence fi is invertible in the quotient ﬁeld Q(˜E) and we de-
n−1 ∈ Q(˜E)[y](= Q(E[y]); compare (6.4) below. Mul-
ﬁne h = e0 f −1
tiplying f with h in Q(˜E)[y] and using the orthogonality property shows that f h =
n−1) = e0 + · · · + en−1 = 1. Thus f is invertible in Q(˜E)[y].
e0(f0 f −1
(3) For h = e0 h0 + · · · + en−1 hn−1 with hs ∈ ˜E for 0 ≤ s < n we have that f h =
e0(f0 h0) + · · · + en−1(fn−1 hn−1). Thus by 1 = e0 1 + · · · + en−1 1 and the unique repre-
sentation of the decomposition it follows that f h = 1 iﬀ hs fs = 1 for all 0 ≤ s < n iﬀ
˜E
fs ∈ E∗ for all 0 ≤ s < n. Hence f ∈ E iﬀ fs ∈ E∗ for all 0 ≤ s < n. E∗ = (F∗)
F follows
by part (3) of Lemma 2.9 and the fact that (˜E, σs) is a P S-extension of (F, σn). ✷

0 ) + · · · + en−1(fn−1 f −1

0 + · · · + en−1 f −1

Proof of part (5) of Theorem 4.3: Let K := const(F, σ) = const(E, σ). Let s with 0 ≤ s <
n and assume that we can take an es f ∈ const(es ˜E, σn)\const(es F, σn) with f ∈ ˜E. This
means that f ∈ ˜E \ F. Now deﬁne hs+k mod n := σk(f )|y→αn−1−s−k ∈ ˜E for 0 ≤ k < n.
Note that σk(es f ) = es+k mod nhs+k mod n and that hi 6= 0 for all 0 ≤ i < n. Further,
observe that σk is a diﬀerence ring isomorphism between (es ˜E, σn) and (es+k mod n ˜E, σn)
by part (4) of Theorem 4.3. Hence the constant property is carried over and we get
es+k mod nhs+k mod n ∈ const(es+k mod n ˜E, σn) for 0 ≤ k < n. Thus for

h := e0 h0 + · · · + en−1 hn−1 ∈ ˜E[y] \ F[y]

(4.10)

we get σn(h) = h. This construction with σk(es hs) = es+k mod nhs+k mod n for all 0 ≤
k < n and h(αn−1−i) = hi 6= 0 for all 0 ≤ i < n will lead to a contradiction.
Namely, by part (1) of Lemma 4.7 it follows that h is not a zero-divisor. Even more,
by part (2) of the lemma h is invertible in H[y] where H is the quotient ﬁeld of ˜E. In
particular, also σi(h) is not a zero-divisor for all 0 ≤ i < n. Now deﬁne g := h . . . σn−1(h).
Since the σi(h) are not zero-divisors, g 6= 0. Moreover, we get h σ(g) = g σn(h) = g h.
Thus multiplying h−1 in H[y] on both sides, we obtain σ(g) = g in H[y]. Since σ(g), g ∈
˜E[y], this identity holds also in ˜E[y] = E. Consequently, k := g ∈ K∗ and hence h w = 1
with w := 1
k σ(h) . . . σn−1(h) ∈ E. Therefore h is invertible not only in H[y], but in E.
W.l.o.g. suppose that the Π-monomials in (4.2) are t1, . . . , tr and the Σ∗-monomials are
tr+1, . . . , te. By part (3) of Lemma 4.7 it follows that hs ∈ ˜E∗, and even more that
hs = d tπ1
r with πi ∈ Z for 1 ≤ i ≤ r and d ∈ F∗. Since hs is free of the RΣ-
monomials, it follows that σk(hs) ∈ ˜E. Thus the relation σk(es hs) = es+k mod nhs+k mod n
implies σk(hs) = hs+k mod n for all 0 ≤ k < n. Thus (4.10) gives h = u tπ1
for some
u ∈ F[y]∗. There is a λ with 1 ≤ λ ≤ r and πλ 6= 0 since h /∈ F[y]. Take the maximal

1 . . . tπr

1 . . . tπr
r

27

λ with this property. Since σ(ti)
λ )n for some
ti
q ∈ F[y]ht1i . . . htλ−1i \ {0}. Since g = k ∈ K∗ and n > 1, we get πλ = 0, a contradiction.
Summarizing, (es ˜E, σn) is a ΠΣ∗-extension of (esF, σn) for all 0 ≤ s < n.
Suppose in addition that (F, σ) is constant-stable. Then it follows that const(es E, σn) =
const(es F, σn) = es const(es F, σn) = es const(F, σ) which completes part (5)

is free of tλ for all 1 ≤ i ≤ λ, g = q (tπλ

✷(5)

Example 4.8. (˜E, σ0) and (˜E, σ1) from Example 4.6 are ΠΣ∗-extensions of (F, σ2).

Summarizing, suppose that we are given an RΠΣ∗-extension (E, σ) of (F, σ) in the
form (4.2) with the idempotent elements e0, . . . , en−1 given by (4.3). Then the diﬀerence
rings (4.9) with 0 ≤ s < n are ΠΣ∗-extensions of (es F, σn). In particular, the (˜E, σs)
with 0 ≤ s < n are ΠΣ∗-extensions of (F, σn). Further, one can write (E, σ) as follows:

E = e0 ˜E

σ
⊕ e2 ˜E

σ
⊕ e3 ˜E

σ

⊕

σ

σ
⊕ en−2 ˜E

σ
⊕ en−1 ˜E

.

. . .

(4.11)

In short, shifting f = e0 f0+· · ·+en−1 fn−1 ∈ E with σ means that the component es fs is
moved cyclically to (es+1 mod n ˜E, σn) with σ(es fs) = es+1 mod nσ(fs)|y→αn−2−s. We note
that the diﬀerence ring (E, σ) can be considered as the “interlacing” of the diﬀerence rings
(es E, σn) = (es ˜E, σs). This idea will be made very precise in Lemma 5.16 by embedding
the decomposition (4.11) into the ring of sequences.

We conclude this section with the following reﬁned characterization of RΠΣ∗-extensions.

Theorem 4.9 (Characterization of RΠΣ∗-extensions (II)). Suppose that the diﬀerence
ﬁeld (F, σ) is constant-stable. Let (E, σ) be a basic RP S-extension of (F, σ) given in the
form (4.2) where the R-monomial y has order n with α = σ(y)
y . Let e0, . . . , en−1 be the
idempotent elements deﬁned in (4.3) Then the following statements are equivalent:

(1) (E, σ) is a basic RΠΣ∗-extension of (F, σ) (i.e., const(E, σ) = const(F, σ)).
(2) (E, σ) is a simple diﬀerence ring.
(3) E = e0 E ⊕ · · · ⊕ en−1E where (es E, σn) is a ΠΣ∗-extension of (es F, σn) for all

0 ≤ s < n.

(4) E = e0 E ⊕ · · · ⊕ en−1 E where (es E, σn) is simple for all 0 ≤ s < n.
(5) There is an s ∈ {0, . . . , n − 1} such that (es E, σn) is a ΠΣ∗-extension of (es F, σn).
(6) There is an s ∈ {0, . . . , n − 1} such that (es E, σn) is simple.

Proof. (1) ⇔ (2) follows by Theorem 3.10. Moreover, (1) ⇒ (3) follows by Theorem 4.3.
(3) ⇒ (1): Suppose that (3) holds and let K := const(F, σ). Now let f = e0 f0 +
· · · + en−1 fn−1 ∈ E with fs ∈ ˜E for 0 ≤ s < n such that σ(f ) = f holds. Then
σn(f ) = f and thus σs(fs) = fs for all 0 ≤ s < n. Since (˜E, σs) is a ΠΣ∗-extension
of (F, σn), fs ∈ const(F, σn). Further, since (F, σ) is constant-stable, fs ∈ K for all
0 ≤ s < n. With σ(f ) = f we conclude that c := f0 = · · · = fn−1 ∈ K and thus we get
f = (e0 + · · · + en−1)c = c ∈ K. This shows that the statements (1)–(3) are equivalent.
Clearly, also (F, σn) is constant-stable. Thus by Theorem 3.10 the statements (3) and (4)
are equivalent and the statements (5) and (6) are equivalent. (3) implies (5).
(5) ⇒ (3): Suppose that (5) holds and take j with 0 ≤ j < n. By Theorem 4.3
(es E, σn) = (es ˜E, σn) is isomorphic to (ej E, σn) = (ej ˜E, σn) by the isomorphism
σλj with λj = j − s mod n ∈ {0, . . . , n − 1}. Let ej c ∈ const(ej E, σn) with c ∈

28

&
&
&
&
"
"
(
(
(
(
l
l
˜E i.e., σn(ej c) = ej c. Then σn(σ−λj (ej c)) = σ−λj (σn(ej c)) = σ−λj (ej c) and thus
σ−λj (ej c) ∈ const(es E, σn) = es const(F, σn); the last equality follows since (es E, σn) is
a ΠΣ∗-extension of (es F, σn). Hence ej c ∈ ej const(F, σn) and therefore const(ej E, σn) =
ej const(F, σn). Summarizing, (ej E, σn) is a ΠΣ∗-extension of (ej F, σn) for all 0 ≤ j < n.
By part (1) of Theorem 4.3 we get E = e0 E ⊕ · · · ⊕ en−1 E which proves part (3). ✷

5. Embedding of basic RΠΣ∗-extensions into the ring of sequences

In Subsection 5.1 (Theorem 5.9) we will show that an RΠΣ∗-extension (E, σ) of a
diﬀerence ﬁeld (F, σ) can be embedded into the diﬀerence ring of sequences provided that
(F, σ) can be embedded in the ring of sequences. In particular, we will work out that this
construction is algorithmic if certain properties hold for the ground ﬁeld F. Further, in
Subsection 5.2 (Theorems 5.14 and 5.18) we will provide illuminating characterizations
of RΠΣ∗-extensions based on these constructions.

5.1. The algorithmic construction of K-embeddings

Let K be a ﬁeld and consider the set of sequences KN with elements hanin≥0 =
ha0, a1, a2, . . . i, ai ∈ K. With component-wise addition and multiplication we obtain
a commutative ring; the ﬁeld K can be naturally embedded by identifying k ∈ K with
the sequence k := hk, k, k, . . . i; note that 0 = h0, 0, 0, . . . i.
We follow the construction from [39, Sec. 8.2] in order to turn the shift

S : ha0, a1, a2, . . . i 7→ ha1, a2, a3, . . . i

(5.1)

into an automorphism: we deﬁne an equivalence relation ∼ on KN by hanin≥0 ∼ hbnin≥0
if there exists a d ≥ 0 such that an = bn holds for all n ≥ d. The equivalence classes form
a ring which is denoted by S(K); the elements of S(K) (also called germs) will be denoted,
as above, by sequence notation. Now it is immediate that S : S(K) → S(K) with (5.1)
forms a ring automorphism. The diﬀerence ring (S(K), S) is called the (diﬀerence) ring
of sequences (over K).
Let (A, σ) be a diﬀerence ring with constant ﬁeld K. Then a diﬀerence ring homomor-
phism (resp. diﬀerence ring monomorphism) τ : A → S(K) is called a K-homomorphism
(resp. K-monomorphism or K-embedding) if for all c ∈ K we have that τ (c) = c.

In the following we will construct an (injective) K-homomorphism from a basic RΠΣ∗-
extension into (S(K), S) by generalizing the ideas of [51]. We start with the following
simple observation. If τ : A → S(K) is a K-homomorphism, there is a map ev : A×N → K
with

for all f ∈ A which has the following properties. For all c ∈ K there is a δ ≥ 0 with

τ (f ) = hev(f, 0), ev(f, 1), . . . i

∀i ≥ δ : ev(c, i) = c;

for all f, g ∈ A there is a δ ≥ 0 with

∀i ≥ δ : ev(f g, i) = ev(f, i) ev(g, i),
∀i ≥ δ : ev(f + g, i) = ev(f, i) + ev(g, i);

29

(5.2)

(5.3)

(5.4)
(5.5)

for all f ∈ A and j ∈ Z there is a δ ≥ 0 with

∀i ≥ δ : ev(σj (f ), i) = ev(f, i + j);

and for all f ∈ A∗ there is a δ ≥ 0 with

∀i ≥ δ : ev(f, i) 6= 0.

(5.6)

(5.7)

The last property follows since f −1 ∈ A∗, thus τ (f )τ (f −1) = τ (f f −1) = τ (1) = 1, and
therefore τ (f ) is non-zero from a certain point on.
Conversely, if there is a function ev : A × N → K with (5.3), (5.4), (5.5) and (5.6), then
the function τ : A → S(K) deﬁned by (5.2) forms a K-homomorphism;.

Subsequently, we assume that a K-homomorphism/K-embedding is always deﬁned by
such a function ev; ev is also called a deﬁning function of τ . To take into account the
constructive aspects, we introduce the following functions for ev; compare [51].

Deﬁnition 5.1. Let (A, σ) be a diﬀerence ring and let τ : A → S(K) be a K-homomor-
phism given by a deﬁning function ev as introduced in (5.2). ev is called operation-
bounded by L : A → N if for all f ∈ A and j ∈ Z with δ = δ(f, j) := L(f ) + max(0, −j)
we have (5.6) and for all f, g ∈ A with δ = δ(f, g) := max(L(f ), L(g)) we have (5.4)
and (5.5); moreover, we require that for all f ∈ A and all j ∈ Z we have L(σj (f )) ≤
L(f ) + max(0, −j). Such a function is also called an o-function for ev.
Let M ⊆ A \ {0}. ev is called zero-bounded by Z : M → N if for all f ∈ M and all
i ≥ Z(f ) we have ev(f, i) 6= 0; such a function is also called a z-function of M for ev.

Note: if there is an o-function for a deﬁning function ev of τ , this implies that for all
f ∈ A there is a δ ∈ N such that for all j ∈ Z we have that

∀i ≥ δ + max(0, −j) : ev(σj(f ), i) = ev(f, i + j).

This bound on the shift is a stronger assumption than (5.6). Subsequently, we call a K-
homomorphism τ shift-bounded if the underlying deﬁning function ev has an o-function.

For concrete applications we will assume that we are given a K-embedding for the ground
ﬁeld (F, σ). In this article we will restrict to the following two examples.

Example 5.2. Take the ΠΣ∗-ﬁeld (K(x), σ) over K with σ(x) = x + 1 from part (1)
of Example 2.13. We obtain a K-homomorphism τ : K(x) → S(K) by introducing the
deﬁning function

ev( p

if q(k) = 0
if q(k) 6= 0

(5.8)

q , k) =(0

p(k)
q(k)

where p, q ∈ K[x], q 6= 0 and p, q are co-prime; here p(k), q(k) is the usual evaluation
of polynomials at k ∈ N. For the o-function L(f ) we take the minimal non-negative
integer l with q(k + l) 6= 0 for all k ∈ N, and as z-function we take Z(f ) = L(p q). By
construction τ is shift-bounded. In addition, since p(x) and q(x) have only ﬁnitely many
roots, τ ( p
q = 0. Hence τ is injective. Summing up, we have constructed a K-
embedding τ : K(x) → S(K). In particular, up to the renaming of the elements K(x) the
diﬀerence ﬁeld (K(x), σ) is contained in (S(K), S) as the sub-diﬀerence ring (τ (K(x)), S).
(τ (K(x)), S) is also called the diﬀerence ﬁeld of rational sequences.

q ) = 0 iﬀ p

30

Example 5.3. Take the ΠΣ∗-ﬁeld (F, σ) over K from part (2) of Example 2.13. Then
for f = p

q with p, q ∈ K[x, x1, . . . , xv], q 6= 0 and p, q being co-prime we deﬁne

ev(f, k) =(0

p(k,qk
q(k,qk

1 ,...,qk
v )
1 ,...,qk
v )

if q(k, qk
if q(k, qk

1 , . . . , qk
1 , . . . , qk

v ) = 0
v ) 6= 0.

(5.9)

There is an algorithm [12, Sec. 3.7] that determines a δ ∈ N with q(k, qk
v ) 6= 0
for all k ≥ δ. Hence for the o-function L(f ) we deﬁne (and compute) the value δ ∈ N
which is minimal such that q(k, qk
v ) 6= 0 holds for all k ≥ δ; as z-function we take
Z(f ) = L(p q). Since p(k, qk
1 , . . . , qk
v ) are non-zero for all k ≥ Z(f ),
τ ( p
q = 0. Hence τ is injective and equipped with computable o- and z-functions.
Summarizing, we have constructed a K-embedding τ : F → S(K). The diﬀerence ﬁeld
(τ (F), S) is called the diﬀerence ﬁeld of q–mixed rational sequences. Similarly, if we
perform this construction without x and with v = 1 where q = q1, we obtain the diﬀerence
ﬁeld of q–rational sequences (τ (K(x1)), S).

1 , . . . , qk
v ) and q(k, qk

q ) = 0 iﬀ p

1 , . . . , qk

1 , . . . , qk

As base case we will start with our ground ﬁelds (F, σ) from above (or more generally
with a diﬀerence ring (A, σ)) with constant ﬁeld K together with a K-homomorphism τ .
Then our goal is to construct for a given basic AP S-extension a K-homomorphism. Here
we will treat each AP S-monomial separately by applying the following lemma.

Lemma 5.4. Let (A, σ) be a diﬀerence ring with constant ﬁeld K and let G be a subgroup
of A∗. Let (Ahti, σ) be a G-basic AP S-extension of (A, σ) with σ(t) = α t + β (α = 1 and
β ∈ A or α ∈ G and β = 0). Let τ : A → S(K) be a K-homomorphism with a deﬁning
function ev as given in (5.2). Then the following holds.

(1) There is a K-homomorphism τ ′ : Ahti → S(K) with a deﬁning function ev′ with

ev′(Xi

and

ev(fi, k)ev′(t, k)i ∀k ∈ N

for some r ∈ N and c ∈ K with the following properties: if β = 0, then c 6= 0 and
ev(t, k) 6= 0 for all k ∈ N; in particular, if tλ = 1 for some λ > 1, then cλ = 1.

(2) Any other diﬀerence ring homomorphism τ ′′ : Ahti → S(K) with τ ′′|A = τ has a
deﬁning function ev′′ of the form (5.11) up to the choice of r ∈ N and c ∈ K with
the requirements stated in part (1).

(3) There is a z-function Z of G for ev. Further, if there is an o-function L, then there
for ev′ with

is an o-function L′ for ev′ with L′|A = L and a z-function Z ′ of G
Z ′|G = Z. An r in (5.11) can be deﬁned by

Ahti
A

r =(max(L(α), Z(α)) + 1

L(β) + 1

if σ(t) = α t
if σ(t) = t + β.

(5.12)

(4) If the deﬁning function ev of τ , and the functions L and Z from part (3) are
computable, then a deﬁning function ev′ for τ ′ and a o-function L′ and a z-function
Z ′ for ev′ as in part (3) are computable.

31

k

fi ti, k) =Xi
ev′(t, k) =
Qi=r
Pi=r


c

k

ev(α, i − 1)

if σ(t) = α t

ev(β, i − 1) + c

if σ(t) = t + β

(5.10)

(5.11)

Proof. (1): Let τ be deﬁned by (5.2), and let ev′(t, k) be deﬁned as in (5.11) (for the
constraints on r and c see the concrete cases below). Furthermore, extend ev from A to
Ahti by (5.10). First suppose that α = 1. Then we do not require any constraints on r
and consider the sequence given by (5.11) for some c ∈ K. Let j ∈ Z. Then we can choose
a δ ∈ N with δ ≥ r such that ev(σj (β), k) = ev(β, k + j) holds for all k ≥ δ. Hence for
all k ≥ δ we have that

ev′(σj (t), k) = ev′(t +

j−1

X

i=0

σi(β), k) = ev′(t, k) +

j−1

X

i=0

ev(σi(β), k)

=

k

X

i=r

ev(β, i − 1) +

j−1

X

i=0

ev(β, k + i) + c =

k+j

X

i=r

ev(β, i − 1) + c = ev′(t, k + j).

(5.13)

Now suppose that β = 0. By (5.7) we can take an r such that ev(α, k − 1) 6= 0 holds
for all k ≥ r. Note that ev′(t, k) 6= 0 for all k ∈ N. Let j ∈ Z. Then there is a δ ∈ N
with δ ≥ r such that ev(σj(α), k) = ev(α, k + j) holds for all k ≥ δ. Hence completely
analogously to the sum case it follows that for all k ≥ δ we have that

ev′(σj (t), k) = ev′(t, k + j)

(5.14)

for all k ≥ δ. Further, if we choose δ ≥ r big enough (depending on the fi and being larger

property (5.6) is established for an AP S-monomial.

than the chosen versions for (5.13) or (5.14)), we get (5.6) for f =Pi fiti. Summarizing,
Now let f =Pm

i=b giti ∈ Ahti be arbitrary but ﬁxed. Then we can choose

a δ ≥ 0 big enough such that for all k ≥ δ we have that

i=a fiti, g =Pn

((ev(fi, k) + ev(gi, k))ev′(t, k)i

ev′(f + g, k) = ev′(Pi
=Pi

(fi + gi) ti, k) =Pi

If t is a P S-monomial, it follows for a δ ≥ 0 chosen large enough that

ev′(f g, k) = ev′(

m+n

m+n

ev(gi, k)ev′(t, k)i = ev′(f, k) + ev′(g, k).

ev(fi, k)ev′(t, k)i +Pi
Pj=a+b
Pj=a+b
ev(fi, k)ev′(t, k)i(cid:17)(cid:16) n
=(cid:16) m
ev(gj, k)ev′(t, k)j(cid:17) = ev′(f, k)ev′(g, k)
Pj=b
Pi=a

ev′(t, k)jPi

tjPi

ev(figj−i, k)

figj−i, k) =

(5.15)

(5.16)

cλQk

holds for all k ≥ δ; outside of the support of f, g the fi, gi are zero. In addition, if t
is an A-monomial of order λ, we have cλ = αλ = 1 which implies that ev′(t, k)λ =
i=r ev(αλ, i − 1) = 1. With this property, we can choose a δ ≥ 0 suﬃciently large
and can again verify (5.16) with m = n = λ − 1. This establishes (5.5) and (5.4).
Moreover, (5.3) holds, since ev′|A×N = ev. Summarizing, if we deﬁne τ ′ : Ahti → S(K) by
τ ′(f ) = hev′(f, i)ii≥0 for all f ∈ Ahti then τ ′ forms a K-homomorphism.
(2): This construction is unique up to c and r in (5.11). Namely, take any other τ2 with
τ2(f ) = τ (f ) for f ∈ A and deﬁne T := τ2(t); if β = 0, then we require in addition that
T is non-zero from a certain point on. Then S(T ) = S(τ2(t)) = τ2(σ(t)) = τ2(α t + β) =
τ2(α)T +τ (β). Note that τ2(1) = 1 and τ2(0) = 0. Hence, if α = 1, then S(T ) = T +τ (β),
and therefore S(T −τ (t)) = T −τ (t), i.e., T = τ (t)+d for some constant d ∈ K. Similarly,
if β = 0, then S(T ) = τ (α)T . Since τ ′(t) is non-zero from the point r on, one can take
the inverse 1/τ ′(t) ∈ S(K) and gets S( T
T
τ ′(t) = d with d ∈ K, i.e.,

τ ′(t) ) = T

τ ′(t) . Hence

32

T = dτ ′(t). Since T is non-zero for almost all entries, d 6= 0. This shows that τ2 can
be deﬁned by (5.11) up to a constant d ∈ K; d 6= 0 if β = 0. In addition, if t is an
A-extension of order λ, it follows that 1 = τ2(1) = τ2(tλ) = τ2(t)λ = T λ = dλτ ′(t)λ =
dλτ ′(tλ) = dλτ ′(1) = dλ which implies dλ = 1. Note: a diﬀerent r for an AP S-monomial
can be compensated by an appropriate choice of d.
(3) By (5.7) it follows that there is a z-function Z of G for ev. Now suppose that
we are given an o function L for ev. Deﬁne the r for (5.11) by (5.12). Then for all
k ≥ r + max(−j, 0) we have that (5.13) and (5.14), respectively. Deﬁne L′ : Ahti → N by

L′(f ) =(L(f )

max(r, L(fa), . . . , L(fm))

if f ∈ A,

if f =Pm

i=a fiti /∈ Ahti \ A.

Then one can check that L′ is an o-function for τ ′ which extends L. Namely, let f =

Pm
i=a fiti and g =Pn

i=b giti ∈ Ahti. Then for all

k ≥ max(r, L(fa), . . . , L(fm), L(gb), . . . , L(gn)) = max(L′(f ), L′(g))

Ahti
A we get f = tm h with m ∈ Z and h ∈ G
we have that (5.15) and (5.16). For f ∈ G
Ahti
A → N by Z ′(f ) = Z(h). If t is an
(m = 0 if t is an AS-monomial). We deﬁne Z ′ : G
Ahti
RS-monomial, Z ′ is clearly a z-function of G
A = G. Otherwise, if t is a P -monomial,
ev(t, k) 6= 0 for all k ≥ 0 and ev(h, k) 6= 0 for all k ≥ Z(h). Thus ev(f, k) = ev(tm h, k) 6=
0 for all k ≥ Z(h) = Z ′(f ). Hence Z ′ is a z-function of G
(4) In particular, if L and Z are computable, then also L′ and Z ′ are computable.
Moreover, if ev is computable, ev′ with (5.10) is computable. ✷

extending Z.

Ahti
A

The iterative application of the (algorithmic) construction given in Lemma 5.4 yields

Proposition 5.5. Let (A, σ) be a diﬀerence ring with constant ﬁeld K, and let G be a
subgroup of A∗. Let (E, σ) be a G-basic AP S-extension of (A, σ), and let τ : A → S(K)
be a (shift-bounded) K-homomorphism. Then:

(1) There exists a (shift-bounded) K-homomorphism τ ′ : E → S(K) with τ ′|A = τ .
(2) Let ev be a deﬁning function of τ with a z-function Z of G, and suppose that
there is an o-function L for ev. Then there is a deﬁning function ev′ for τ ′ with an
o-function L′ and a z-function Z ′ of GE
A where ev′|A×N = ev, L′|A = L, Z ′|G = Z.

(3) If ev, L and Z are computable, such functions ev′, L′ and Z ′ are computable.

Aht1i...htr i
A

Proof. We apply part (1) of Lemma 5.4 iteratively (for E = Aht1i . . . htei we replace
G by G
for the rth iteration step). This shows that there is a diﬀerence ring
homomorphism from τ ′ : E → S(K) with τ ′|A = τ . Now let ev be a deﬁning function of τ
with a z-function Z for G (which exists by property (5.7)). In addition, suppose that τ is
shift-bounded. Then there is an o-function L for ev. Thus applying parts (1) and (3) of
Lemma 5.4 iteratively shows that there is a deﬁning function ev′ of τ ′ with ev′
A×N = ev
together with an o-function L′ for ev′ with L′|A = L and a z-function Z ′ : GE
A → N for ev′
with Z ′|G = Z. By construction τ ′ is shift-bounded. This establishes parts (1) and (2).
In addition, if ev, L and Z are computable, one obtains also computable functions L′
and Z ′ by part (4) of Lemma 5.4. This completes the proof. ✷

33

Example 5.6. Take the ΠΣ∗-ﬁeld (Q(n)(x), σ) over Q(n) with σ(x) = x + 1. With
Example 5.2 we get the Q(n)-embedding τ : Q(n)(x) → S(Q(n)). Now consider the
RΠΣ∗-extension (A[s1], σ) of (Q(n)(x), σ) with A = Q(n)(x)[y][p1, 1
] and (3.11)
p1
from Example 3.14. Starting with A = Q(n)(x) and G = Q(n)(x)∗ we apply Lemma 5.4
iteratively and extend τ successively by

][p2, 1
p2

k

k

Qi=1
Qi=1

τ (p2) = h

τ (y) = h

(−1)ik≥0 = h(−1)kik≥0,

τ (p1) = h

n + 1 − i

i

ik≥0 = h(cid:0)n

k(cid:1)ik≥0,

τ (s1) = h

2ik≥0 = h2kik≥0,

(−1)i

i

ik≥0.

(5.17)

k

k

Qi=1
Pi=1

Example 5.7. Take the basic Π-extension (K(x)[p1, 1
], σ) of (K(x), σ)
p1
from Example 2.17. With Example 5.2 we get the K-embedding τ : K(x) → S(K). Now
we apply Lemma 5.4 iteratively (starting with A = K(x) and G = K(x)∗) and extend τ
to the K-homomorphism τ : K(x)[p1, 1
p1

] → S(K) with

][p2, 1
p2

][p3, 1
p3

][p2, 1
p2

][p3, 1
p3

τ (p1) = hk!ik≥0,

τ (p2) = h

i!ik≥0,

τ (p3) = h

j!ik≥0.

(5.18)

k

Qi=1

k

Qi=1

i

Qj=1

Finally, we concentrate on the question when the obtained K-homomorphism is injective.

Lemma 5.8. Let (A, σ) be a diﬀerence ring with constant ﬁeld K and let τ : A → S(K)
be a K-diﬀerence ring homomorphism. If (A, σ) is simple, τ is a K-embedding.

Proof. Take the ideal I := ker(τ ) = {f ∈ A|τ (f ) = 0}. Let f ∈ I. Then τ (σ(f )) =
S(τ (f )) = S(0) = 0 and hence σ(f ) ∈ I. This proves that I is a diﬀerence ideal. Since
τ (1) = 1, 1 /∈ I and hence I 6= E. Since (E, σ) is simple, I = {0}, i.e., τ is injective. ✷

In a nutshell, we end up at the following central result by exploiting Theorem 3.3 from
Section 3; for an integral domain version see [51].

Theorem 5.9. Let (E, σ) be a basic RΠΣ∗-extension of a diﬀerence ﬁeld (F, σ) with a
(shift-bounded) K-embedding τ : F → S(K). Then:

(1) There exits a (shift-bounded) K embedding τ ′ : E → S(K) with τ ′|F = τ .
(2) If there is a computable deﬁning function for τ equipped with a computable o-
function and a computable z-function of F∗, such a K-embedding τ ′ can be given
explicitly (i.e., one can construct a computable deﬁning function for τ ′ equipped
with a computable o-function and a computable z-function of (F∗)E

F).

Proof. By part (1) of Proposition 5.5 (with A = F and G = F∗) there exists a (shift-
bounded) K-homomorphism τ ′ : E → S(K), and it can be constructed explicitly if a
deﬁning function of τ is computable and is equipped with a computable o-function and z-
function. Since (E, σ) is a basic RΠΣ∗-extension of (F, σ), (E, σ) is simple by Theorem 3.3.
Hence τ ′ is a K embedding by Lemma 5.8. ✷

Example 5.10. (1) Take the diﬀerence ring (E, σ) with E = Q(n)(x)[y][p1, 1
][s1]
p1
from Example 5.6 and take the shift-bounded Q(n)-homomorphism τ : E → S(Q(n)).
Since (E, σ) is an RΠΣ∗-extension of (Q(n)(x), σ), τ is a Q(n)-embedding.
(2) Similarly, it follows that the K-homomorphism τ : K(x)[p1, 1
p1
from Example 5.7 is a K-embedding.

] → S(K)

][p2, 1
p2

][p3, 1
p3

][p2, 1
p2

34

Remark 5.11. An existence statement related to Theorem 5.9 has been proved in [22,
Prop 4.1]: there exists an embedding of a Picard-Vessiot extension over (F, σ) with K =
const(F, σ) into (S(K), S) if the following rather strong conditions hold: K is algebraically
closed and the algebraic closure of F can be embedded into (S(K), S).
We remark further that Theorem 5.9 has been exploited in [5] to show that the class of
harmonic sums [14,59] and cyclotomic harmonic sums [3] can be embedded into the ring
of sequences; an interesting consequence is that the corresponding RΠΣ∗-extension is
obtained by simply using the underlying quasi-shuﬄe algebra [13,3] of the nested sums.
For further applications of Theorem 5.9 within symbolic summation we refer to Section 7.

5.2. Further characterizations of RΠΣ∗-extensions: the interlacing property

We will enhance the characterizations given in Theorem 3.10 with further equivalent
statements in terms of K-embeddings. In Theorem 3.10 we assumed that the underlying
diﬀerence ﬁeld is constant-stable. First, we will show that this property is implied by the
assumption that the underlying diﬀerence ﬁeld is embedded into the ring of sequences.

Lemma 5.12. Let (A, σ) be a diﬀerence ring with constant ﬁeld K. If A is an integral
domain and there is a K-embedding τ : A → S(K), then (A, σ) is constant-stable.

Proof. Suppose there is a K-embedding τ and suppose that A is an integral domain, but
suppose that (A, σ) is not constant-stable. Hence we can take an f ∈ A \ K and k > 1
with σk(f ) = f and σi(f ) 6= f for all 1 ≤ i < k. Then τ (f ) = τ (σk(f )) = Sk(τ (f )). Thus
τ (f ) is the interlacing of k − 1 constant-sequences and we get

τ (f ) = hc1, c2, . . . , ck−1, c1, c2, . . . , ck−1, . . . i

hl = f σ(f ) . . . σl(f ) with 0 ≤ l < k. Then observe that τ (hk−1) = Qk−1

for some c1, . . . , ck−1 ∈ K. Suppose that cr = 0 for some r with 1 ≤ r < k. Deﬁne
i=0 Siτ (f ) = 0
since cr will be multiplied to each component. Note that hk−1 = 0 since τ is injective.
Since h0 = f 6= 0, there is an s with 0 ≤ s < k − 1 and hs 6= 0. For the maximal s we have
0 = hs+1 = hs σs+1(f ). Since f 6= 0, we get σs+1(f ) 6= 0, and thus hs and σs+1(f ) are
zero-divisors; a contradiction since A is integral. Consequently, cr 6= 0 for all 1 ≤ r < k.
Now deﬁne

wi := ci σ(f ) − ci+1 f and wk := ck σ(f ) − c1 f1

for 1 ≤ i ≤ k − 1. Suppose that there is a j with 1 ≤ j ≤ k such that wj = 0 holds. Then
there exists a d ∈ K∗ with σ(f ) = d f . With σk(f ) = f , it follows that f = σk(f ) = dk f .
Since A is an integral domain, dk = 1, i.e., d is a kth root of unity. Now suppose that
dl = 1 for some 1 ≤ l < k. Then σl(f ) = dl f = f , a contradiction to the minimality of
k. Thus d is a primitive kth root of unity and d, d2, . . . , dk ∈ K are distinct roots of the
polynomial xk − 1 ∈ A[x]. Now observe that σ(f k) = dk f k = f k where f k 6= 0 and thus
f k = c for some c ∈ K∗. Since f /∈ K, we obtain h := f
c ∈ A \ K with hk = 1. Therefore
also h is a root of xk − 1. Thus xk − 1 has k + 1 roots (k distinct roots from K and one
extra root from A \ K), a contradiction to the assumption that A is an integral domain.
Consequently, we may suppose that wj 6= 0 for all 1 ≤ j ≤ k. Observe that in τ (wj )
always the jth entry is zero, but τ (wj ) 6= 0 (otherwise wj would be 0 using the fact
that τ is injective). Deﬁne gk = w1, . . . , wk. Consequently 0 = τ (w1) τ (w2) . . . τ (wk) =
τ (w1 w2 . . . wk) = τ (gk). Since τ is injective, gk = 0. By construction g1 = w1 6= 0. Now
let l with 1 ≤ l < k be maximal with gl 6= 0. Then 0 = gl+1 = gl wl+1 with wl+1 6= 0 and

35

gl 6= 0. Therefore gl and wl+1 are zero-divisors, again a contradiction to the assumption
that A is integral. This completes the proof. ✷

In addition, we will need the following simple observation.

Lemma 5.13. Let (A, σ) be a diﬀerence ring, let K be a ﬁeld with K ⊆ const(A, σ), and
let τ : A → S(K) be a K-embedding. Then const(A, σ) = K.

Proof. Let f ∈ const(A, σ). Then τ (f ) = τ (σ(f )) = S(τ (f )). Thus τ (f ) = k for some k ∈
K. Since τ is a K-embedding, τ (k) = k = τ (f ). Since τ is injective, f = k ∈ K. Therefore
const(A, σ) ⊆ K. The assumption K ⊆ const(A, σ) implies K = const(A, σ). ✷

Using these lemmas we can enrich the deﬁning properties of RΠΣ∗-extensions as follows.

Theorem 5.14 (Characterization of RΠΣ∗-extensions (III)). Let (F, σ) be a diﬀerence
ﬁeld with K = const(F, σ) and with a K-embedding τ : F → S(K). Let (E, σ) be a basic
AP S-extension of (F, σ). Then the following statements are equivalent.

(1) (E, σ) is a basic RΠΣ∗-extension of (F, σ) (i.e., const(E, σ) = const(F, σ)).
(2) (E, σ) is a simple diﬀerence ring.
(3) There is a K-embedding τ ′ : E → S(K) with τ ′|F = τ .
(4) There is a K-embedding τ ′ : E → S(K).

Proof. Since (F, σ) is constant-stable by Lemma 5.12, the equivalence (1) ⇔ (2) follows
by Theorem 3.10. (2) ⇒ (3) follows by Theorem 5.9. (3) ⇒ (4) is obvious. Suppose that
statement (4) holds. Since K ⊆ const(E, σ) and τ ′ is a K-embedding, it follows that
const(E, σ) = K by Lemma 5.13. Hence statement (1) holds. ✷

Finally, we will reﬁne these characterizations further by linking them to the idempotent
representation given in Section 4. First, we work out how the idempotent elements are
evaluated within a K-embedding.

Lemma 5.15. Let (F[y], σ) be an R-extension of (F, σ) of order n with σ(y) = α y. Let
τ : F → S(K) be a K-embedding with K = const(F, σ) and let τ ′ : F[y] → S(K) be a
K-embedding with τ ′|F = τ . Then there is a deﬁning function ev of τ ′ such that for all
k ∈ N we have ev(y, k) = αu αk for some u ∈ N with 0 ≤ u < n. In particular, for the es
with 0 ≤ s < n as deﬁned in (4.3) we get

ev(es, k) =(0

1

if n ∤ k + u + s + 1
if n | k + u + s + 1.

(5.19)

Proof. By Lemma 5.4 (part 1 and 2) it follows that τ (y) = hc ykik≥0 for some c ∈ K∗
with cn = 1. Thus c = αu for some u ∈ {0, . . . , n − 1}. Hence we can choose a deﬁning
function for τ ′ with ev(y, k) = αu αk. With (4.4) we conclude that (5.19) holds. ✷

Now we are ready to show that the representation in terms of our idempotent elements
encodes the interlacing of certain sequences. In this context, it will be convenient to
introduce for 0 ≤ s < n the function λs : S(K) → S(K) deﬁned by

λs(hakik≥0) = han r+(n−1−s)ir≥0.

In short, λs picks out the nth entries with oﬀset n − 1 − s. It is easily checked that λs
forms a diﬀerence ring homomorphism from (S(K), Sn) to (S(K), S).

36

Lemma 5.16. Let (F, σ) be a diﬀerence ﬁeld with K = const(F, σ), and let (E, σ) be
a basic RΠΣ∗-extension of (F, σ) given in the form (4.2) where the R-monomial y has
order n with α = σ(y)
y ∈ K. Let e0, . . . , en−1 be the idempotent elements deﬁned in (4.3).
(1) (Sub-sequences) Let τ : E → S(K) be a K-embedding with a deﬁning function ev
where ev(y, k) = αu+k for some 0 ≤ u < n. Then for 0 ≤ s < n and l := s + u
mod n we get the K-embedding τs = λl ◦ τ |es E from (es E, σn) to (S(K), S) where

τs(es f ) = hev(es f, r n + n − 1 − l)ir≥0.

(5.20)

(2) (Interlacing) Let τs : es E → S(K) be a K-embedding from (es E, σn) to (S(K), S)
with a deﬁning function evs for some 0 ≤ s < n. Then for 0 ≤ j < n the maps
τj : ej E → S(K) deﬁned by τj (ej f ) = τs(es σs−j(f )) are K-embeddings from
(ej E, σn) to (S(K), S) with the deﬁning functions evj(ej f, k) = evs(es σs−j (f ), k)
for all f ∈ E. Moreover, the interlacing of the sequences τn−1(en−1 f ), . . . , τ0(e0 f ),
i.e., the map τ : E → S(K) deﬁned by 4

τ (f ) =(cid:10) evn−1(en−1 f, 0), evn−2(en−2 f, 0), . . . , ev0(e0 f, 0),

evn−1(en−1 f, 1), evn−2(en−2 f, 1), . . . , ev0(e0 f, 1),

(5.21)

is a K-embedding from (E, σ) into (S(K), S); here we have that τ (y) = hαkik≥0.

...

...

. . .

...

(cid:11)

Proof. (1) Note that τ is a K-embedding of (E, σn) into (S(K), Sn) since τ (σn(f )) =
Sn(τ (f )) for all f ∈ E. In particular, τ |es E is a K-embedding of (es E, σn) into (S(K), Sn).
By Lemma 5.15 it follows that ev(es f, k + n r) with r ∈ N is zero if k 6= n − 1 − l. This
implies that τs = λl ◦ τ |es E is a K-embedding. The evaluation in (5.20) is obvious.
(2) Take the K-embedding τs : es E → S(K). By Theorem 4.3 it follows that the (ej E, σn)
are isomorphic to (es E, σn) with σs−j for 0 ≤ j < n. Thus we get the K-embeddings τj
as claimed in the statement. In particular, a deﬁning function for τj with 0 ≤ j < n
is given by evj(ej f, k) = evs(es σs−j (f ), k) for all f ∈ E. Now take the map τ as
deﬁned in (5.21). It is easily seen that τ is a ring isomorphism. Moreover, for any f ∈
E, for k ∈ N big enough and 0 ≤ r < n it follows that evn−1−r(en−1−rσ(f ), k) =
evs(esσs−n+1+r(σ(f )), k) = evs(esσs−n+1+(r+1)(f ), k) = evn−1−(r+1)(en−1−(r+1)f, k).
With (5.21) we conclude that τ (σ(f )) = S(τ (f )) and consequently τ is a diﬀerence
ring isomorphism. Finally, for any c ∈ K and 0 ≤ s < n we have τs(c) = c and therefore
τ (c) = c. Consequently, τ is a K-embedding. Consider τ ′ = τ |F[y] and let ev′ be a deﬁning
function. By the construction (5.21) we have that ev′(en−1, n k) = evn−1(en−1, k) for all
k ∈ N. Since τn−1 is a K-embedding and en−1 is the multiplicative identity, τn−1(en−1) =
1. Thus there is a δ ∈ N with ev′(en−1, n k) = 1 for all k ≥ δ. By Lemma 5.15 it follows
that ev′(y, k) = αk+u for some 0 ≤ u < n and k big enough and that ev′(en−1, n k) = 1
if n | n k + u + n. This implies that u = 0. Thus τ (y) = hev′(y, k)ik≥0 = hαkik≥0. ✷

4 At a ﬁrst glance this construction seems odd. However note that the shift in the representation (4.11)
is left to right. But the shift in (S(K), S) means that a sequence is moved from right to left drop-
ping the ﬁrst term. As a consequence also the interlacing of the sequences must be given in the order
evn−1, evn−2, . . . , ev0 in order to construct a diﬀerence ring homomorphism.

37

Remark 5.17. We obtain an alternative proof of part (5) of Theorem 4.3 if one assumes
that there is a K-embedding τ : F → S(K) (instead of the weaker assumption that (F, σ) is
constant-stable). Namely, together with the assumption that (E, σ) is an RΠΣ∗-extension
of (F, σ), we can conclude that there is a K-embedding τ ′ : E → S(K) with τ ′|F = τ by
using Theorem 5.14. Furthermore, by part (1) of Lemma 5.16 we get the K-embeddings
τs : es E → S(K) for 0 ≤ s < n. By part (3) of Theorem 4.3 it follows that the (es E, σn)
are P S-extensions of (es F, σn) for 0 ≤ s < n. Thus they are ΠΣ∗-extensions by the
equivalence (1)⇔(4) of Theorem 5.14.

We end up at the following ﬁnal characterizations of RΠΣ∗-extensions.

Theorem 5.18 (Characterization of RΠΣ∗-extensions (IV)). Let (F, σ) be a diﬀerence
ﬁeld with K = const(F, σ) equipped with a K-embedding τ : F → S(K). Let (E, σ) be a
basic RP S-extension of (F, σ) given in the form (4.2) where the R-monomial y has order
n with α = σ(y)
y ∈ K. Let e0, . . . , en−1 be the idempotent elements deﬁned in (4.3). Then
the following statements are equivalent.

(1) – (6) from Theorem 4.9.
(7) There is a K-embedding τ ′ : E → S(K) with τ ′|F = τ .
(8) There is a K-embedding τ ′ : E → S(K).
(9) For all s ∈ {0, . . . , n − 1} there is a K-embedding τs from (esE, σn) into (S(K), S)

with τs(es f ) = λs(τ (f )) for all f ∈ F.

(10) There is an s ∈ {0, . . . , n − 1} such that there is a K-embedding τs from (esE, σn)

into (S(K), S) with τs(es f ) = λs(τ (f )) for all f ∈ F.

(11) There are K-embeddings of (es E, σn) into (S(K), S) for 0 ≤ s < n such that

τ ′ : E → S(K) with (5.21) is a K-embedding with τ ′|F = τ .

(12) There is an s ∈ {0, . . . , n − 1} such that there is a K-embedding τs from (esE, σn)

into (S(K), S)

Proof. Since (F, σ) is constant-stable by Lemma 5.12, the equivalences (1)–(8) follow by
Theorems 4.9 and 5.14.
(7) ⇒ (9): Suppose that (7) holds and let s ∈ N with 0 ≤ s < n. Then by part (1) of
Lemma 5.16 we get the K-embedding τs := λs ◦ τ ′|es E from (esE, σn) into (S(K), S).
Since τ ′|F = τ |F, we have λs(τ ′(es f )) = λs(τ (f )) for all f ∈ F which shows part (9).
(9) ⇒ (10) is immediate. (10) ⇒ (11): Suppose that (10) holds and let evs and ev be
deﬁning functions for τs and τ , respectively. Then by part (2) of Lemma 5.16 we get the
K-embeddings τj from (ej E, σn) to (S(K), S) for 0 ≤ j < n with τj (ej f ) = τs(es σs−j (f ))
for all f ∈ E; for a deﬁning function we take evj(ej f ) := evs(esσj−s(f ), k) for f ∈ E.
By assumption we have that evs(es h, ˜k) = ev(h, n ˜k + n − 1 − s) for all h ∈ F and for all
˜k ∈ N and 0 ≤ s < n. Further, we get the K-embedding τ ′ : E → S(K) with (5.21). Let
ev′ be a deﬁning function for τ ′. Now let k ∈ N be chosen big enough and take ˜k ∈ N
and j with 0 ≤ j < n and k = ˜k n + j. Then for f ∈ F we get

ev′(f, k) = evn−1−j(en−1−jf, ˜k) = evs(esσs−n+1+j (f ), ˜k)

= ev(σs−n+1+j (f ), n ˜k + n − 1 − s) = ev(f, n ˜k + j) = ev(f, k)

which proves that τ ′(f ) = τ (f ) for all f ∈ F. Thus (11) is proven. (11) ⇒ (12) is trivial.
(12) ⇒ (5): By Theorem 4.3 (esE, σn) is a P S-extension of (es F, σn). Since (F, σ) is
constant-stable, also (es F, σ) is constant-stable. Therefore by (4) ⇒ (1) of Theorem 5.14
it follows that (esE, σn) is a ΠΣ∗-extension of (esF, σn). This completes the proof. ✷

38

Remark 5.19. We emphasize property (11) of Theorem 5.18. Consider the representa-
tion (4.11) of an RΠΣ∗-extension (E, σ) of (F, σ) together with a K-embedding τ : F →
S(K). Then one can construct a K-embedding τ ′ : E → S(K) by Theorem 5.18; here we
choose τ (y) = hαkik≥0. In particular, by part (1) of Lemma 5.16 the τs := λs ◦ τ |es E for
0 ≤ s < n are K-embeddings of the ΠΣ∗-extensions (es E, σn) of (es F, σn). Thus (E, σ)
is isomorphic to (τ (E), S) and by part 2 of Lemma 5.16 this ring is nothing else than
the interlacing of the sequences τn−1(en−1 E), . . . , τ0(e0 E). And since the (es E, σn) are
isomorphic to (τs(es E), Sn), the representation (4.11), in particular the statements in
Theorem 4.3, formulate precisely the interlacing property in the RΠΣ∗-language.

6. Application I: an alternative algorithm for parameterized telescoping

As motivated in Subsection 2.3, in particular in Remark 2.12, one is interested in the
telescoping problem: given a diﬀerence ring (A, σ) with constant ﬁeld K and given an
f ∈ A, decide constructively if there exists a g ∈ A with

σ(g) − g = f.

(6.1)

More generally, the parameterized telescoping problem in Subsec. 7.2 below will play a
prominent role: given f = (f1, . . . , fd) ∈ Ad, ﬁnd all c1, . . . , cd ∈ K and g ∈ A with

σ(g) − g = c1 f1 + · · · + cd fd.

(6.2)

Note that the set (compare [24])

V (f , A) := {(c1, . . . , cd, g) ∈ Kd × A| (6.2) holds}

is a subspace of Kd × A over K and the dimension is at most d + 1; see [57, Lemma 2.17].
Thus ﬁnding all such solutions can be summarized as follows.

Problem PTDR for (A, σ): Parameterized Telescoping for a Diﬀerence Ring.
Given a diﬀerence ring (A, σ) with constant ﬁeld K and f = (f1, . . . , fd) ∈ Ad.
Find a basis of the K-vector space V (f , A).

In [57] we derived an eﬃcient algorithmic framework that is summarized in

Theorem 6.1. Let (E, σ) be a basic RΠΣ∗-extension of a diﬀerence ﬁeld (F, σ). If one
can solve Problem PTDR for (F, σ) then one can solve Problem PTDR for (E, σ).

For instance, one can solve Problem PTDR for (F, σ) if (F, σ) is one of the diﬀerence
ﬁelds of Example 2.2. More generally, there is the following result [26] that one obtains
by analysing carefully Karr’s summation algorithm [24].

Theorem 6.2. Let (F, σ) be a ΠΣ∗-ﬁeld extension of (G, σ). If Problem PTDR is solvable
for (G, σ) and (G, σ) is σ∗-computable (i.e., certain algorithmic properties hold that are
speciﬁed in [26, Def. 1]), then Problem PTDR is solvable for (F, σ).

E.g., if (G, σ) is the diﬀerence ﬁeld of unspeciﬁed sequences [26] or of radical expres-
sions [27], it is σ∗-computable. Thus one can solve Problem PTDR for a tower of ΠΣ∗-ﬁeld
extensions over (G, σ); see Remark 2.12.

39

In Theorem 6.7 below we will derive an alternative approach that tackles Prob-
lem PTDR for a basic RΠΣ∗-extension (E, σ) of (F, σ). This new reduction will require
more conditions than the ones formulated in Theorem 6.1, but it provides more ﬂexibil-
ity: Problem PTDR can be solved for the quotient ring Q(E) by exploiting the existing
summation algorithms for ΠΣ∗-ﬁeld extensions [24,44,45,48,50,56].

We assume that the RΠΣ∗-extension (E, σ) of a constant-stable diﬀerence ﬁeld (F, σ) is
given in the form (4.2) where the y-monomial has order n and the idempotent elements
are given by (4.3) with 0 ≤ s < n. Here we emphasize once more that several basic
R-monomials can be reduced to this speciﬁc situation using Lemma 2.22. Then using
Theorem 4.3 we get the direct sum (4.1) where the (es E, σn) are ΠΣ∗-extensions of
(F, σ) with 0 ≤ s < n. More precisely, taking into account the isomorphisms (4.9) we get
the ΠΣ∗-extensions (˜E, σs) of (F, σn) for 0 ≤ s < n with ˜E = Fht1i . . . htei and (4.7).

Lemma 6.3. Let (F, σ) be a constant-stable diﬀerence ﬁeld with K = const(F, σ). Let
(E, σ) be a basic RΠΣ∗-extension of (F, σ) with (4.2) and (4.3) for 0 ≤ s < n. Then for
any f ∈ E with f + σ(f ) + · · · + σn−1(f ) = 0 we have that f ∈ K[y].

Proof. Let f = e0 f0 + · · · + en−1 fn−1 as above. Then 0 = σ(σn−1(f ) + · · · + f ) −
(σn−1(f ) + · · · + f ) = σn(f ) − f . Let 0 ≤ s < n . Then by part (3) of Lemma 4.4
we get σn(es fs) = es fs. Since (es E, σn) is a ΠΣ∗-extension of (esF, σn) by part (5) of
Theorem 4.3, it follows that es fs ∈ const(es F, σn). Therefore fs ∈ const(F, σn) and since
(F, σ) is constant-stable, fs ∈ K. Thus fs ∈ K for all 0 ≤ s < n, and hence f ∈ K[y]. ✷

Now we are ready to present the following reduction strategy.

Proposition 6.4. Let (E, σ) be the basic RΠΣ∗-extension of a constant-stable diﬀerence
ﬁeld (F, σ) with (4.2) and (4.3) for 0 ≤ s < n and take the ΠΣ∗-extensions (˜E, σs) of

(F, σn) for 0 ≤ s < n. Let f ∈ E and deﬁne ˜fs =(cid:16)Pn−1

(1) Then there exists a g ∈ E with (6.1) iﬀ there are ˜gs ∈ ˜E for 0 ≤ s < n with

i=0 σi(f )(cid:17)|y→αn−1−s ∈ ˜E.

σs(˜gs) − ˜gs = ˜fs.

(6.3)

(2) If we are given such ˜gs of 0 ≤ s < n, then we get f ′ := f − (σ(˜g) − ˜g) ∈ K[y] for
˜g = e0 ˜g0 + · · · + en−1 ˜gn−1. Furthermore, a solution g′ ∈ K[y] of σ(g′) − g′ = f ′ can
be computed, and g = ˜g + g′ is a solution of (6.1).

i=0 σi(f ) we have that ˜f = Pn−1

with gi ∈ ˜E for 0 ≤ i < n. For ˜f := Pn−1

Proof. “⇒”: Suppose that there is a g ∈ E with (6.1) and write g = e0 g0+· · ·+en−1 gn−1
i=0 (σ(g) − g) =
σn(g) − g. Note in addition that ˜f = e0 ˜f0 + · · · + en−1 ˜fn−1. Thus by Theorem 4.3 it
follows that σn(es gs) − es gs = es ˜fs and therefore σs(gs) − gs = ˜fs for all 0 ≤ s < n.
“⇐”: Suppose that we get ˜gs ∈ ˜E for 0 ≤ s < e with (6.3). Now deﬁne f ′ := f − (σ(˜g) −
s=0 ( ˜fs − (σ(˜gs) −
˜gs)) = 0. Therefore by Lemma 6.3 it follows that f ′ ∈ K[y]. Moreover, note that for any
0 ≤ i < n we have that σ(γ) − γ = 1
αi−1 . Thus by linearity
we can compute a g′ ∈ K[y] with σ(g′) − g′ = f ′. Consequently we can take g = ˜g + g′
and get f − (σ(g) − g) = f − (σ(˜g) − ˜g) − (σ(g′) − g′) = f ′ − f ′ = 0. Due to this explicit
construction, the second part of the proposition follows. ✷

˜g) ∈ E. Observe that f ′ + σ(f ′) + · · · + σn−1(f ′) = ˜f − (σn(˜g − ˜g) =Pn−1

αi−1 (αi yi − yi) = yi for γ = yi

40

In summary, solving the telescoping problem in (E, σ) can be reduced to solving the
telescoping problem in the n ΠΣ∗-extensions (˜E, σs) of (F, σn) with 0 ≤ s < n. By
Theorem 5 6.1 this is possible if one can solve Problem PTDR for (F, σn).

2s1

y

2(x2+4x+5)

−2ys1

(x+1)(x+2) +

(x+1)2(x+2)2(x+3) −

(x+1)2(x+2)2(x+3) and ˜f1 = ˜f |y→1 = −

Example 6.5. We continue with Examples 4.5–4.8. Given f ∈ E from Example 4.5,
we want to calculate a g ∈ E with (6.1). Therefore we set ˜f = f + σ(f ) and get
˜f =
(x+1)(x+2) = e0 ˜f0 + e1 ˜f1 with ˜f0 = ˜f |y→−1 =
(x+1)(x+2) + x3+8x2+19x+16
(x+1)2(x+2)2(x+3) . We
follow Proposition 6.4 and try to compute the ˜gs ∈ ˜E with s = 0, 1 such that (6.3)
holds. Using the algorithms from [56] we compute ˜g0 = s1 + s2
x+1 and ˜g1 =
s1 + s2
∈ E and deﬁne
f ′ := f − (σ(˜g) − ˜g) = −2 y ∈ K[y]. Finally, we compute g′ = y with σ(g′) − g′ = f ′ and
get the solution g = ˜g + g′ = s1 + s2

x+1 . Thus we set ˜g = e0 ˜g0 + e1 ˜g1 = s1 + s2

(x+1)(x+2) − x3+4x2+3x−4

2 − −1+y+x y

x+1

1 − s′

2 − x

1 − s′

2 + x+2

1 − s′

2 + 1

x+1 of (6.1).

2s1

1 − s′

Now we turn to the problem to solve the telescoping problem for the quotient ring

(Q(E), σ). Here we will exploit the representation

Q(E) = e0 Q(˜E) ⊕ · · · ⊕ en−1 Q(˜E);

(6.4)
compare [22, Sec. 1.3 ] and [21, Cor. 6.9]. Note that the diﬀerence ﬁeld (Q(˜E), σs) forms a
polynomial ΠΣ∗-ﬁeld extension of (F, σn) by iterative application of Corollary 2.6. Then
using these properties, one can extract the following reduction strategy.

Proposition 6.6. Let (E, σ) be a basic RΠΣ∗-extension of a constant-stable diﬀerence
ﬁeld (F, σ) with (4.2) and (4.3) for 0 ≤ s < n and take the ΠΣ∗-ﬁeld extensions (Q(˜E), σs)

of (F, σn) for 0 ≤ s < n. Let f ∈ Q(E) and set ˜fs :=(cid:16)Pn−1

(1) Then there is a g ∈ Q(E) with (6.1) iﬀ there are ˜gs ∈ Q(˜E) with (6.3) for 0 ≤ s < n.
(2) If we are given such ˜gs for 0 ≤ s < n, a solution g ∈ Q(E) of (6.1) can be computed

i=0 σi(f )(cid:17)|y→αn−1−s ∈ Q(˜E).

as given in part (2) of Proposition 6.4.

The proof is analogous to the one for Proposition 6.4 and is skipped. As a consequence,
we obtain a telescoping algorithm for (Q(E), σ) whenever we are given a telescoping
algorithm for the ΠΣ∗-ﬁeld extensions (Q(˜E), σs) of (F, σn) with 0 ≤ s < n.
Finally, we will solve Problem PTDR based on the above telescoping technology.

Theorem 6.7. Let (E, σ) be a basic RΠΣ∗-extension of a constant-stable diﬀerence ﬁeld
(F, σ) with (4.2) where the R-monomial y has order n.

(1) If Problem PTDR is solvable for (F, σn) then Problem PTDR is solvable for (E, σ).
(2) If (F, σn) is σ∗-computable and Problem PTDR is solvable for (F, σn) then Prob-

lem PTDR is solvable for (Q(E), σ).

Proof. (1) Take the idempotent elements (4.3) with 0 ≤ s < n. Let f = (f1, . . . , fd) ∈ Ed.
Deﬁne ˜fi,s = (fi + σ(fi) + · · · + σ(fi)n−1)|y→αn−1−s ∈ ˜E for 0 ≤ s < n and 1 ≤ i ≤ d,
and set hs = ( ˜f1,s, . . . , ˜fd,s) ∈ ˜Ed for 0 ≤ s < n. Since we can solve Problem PTDR for

5 Here one does not use the full machinery for RΠΣ∗-monomials, but exploits only sub-algorithms that
tackle ΠΣ∗-monomials. The resulting algorithm boils down to a special version given in [56].

41

(F, σn), we can solve Problem PTDR for (˜E, σs) with 0 ≤ s < n by Theorem 6.1. Thus
we can compute the bases of Vs := V (hs, (˜E, σs)) for 0 ≤ s < n. By linear algebra we
can calculate a basis, say {(ci,1, . . . , ci,d, ˜gi)}1≤i≤r, of

W := {(c1, . . . , cd, e0 h0 + · · · + en−1 hn−1)| (c1, . . . , cd, hs) ∈ Vs for all 0 ≤ s < n}.

i) − g′

i = f ′

i ∈ K[y] such that σ(g′

i ∈ K[y]. Thus we can calculate g′

i = ci,1f1 + · · · + ci,d fd − (σ(˜gi) − ˜gi) for 1 ≤ i ≤ r. By Proposition 6.4 it
i holds for
i}1≤i≤r

Now set f ′
follows that f ′
1 ≤ i ≤ r; for details see the proof of Proposition 6.4. Hence {(ci,1, . . . , ci,d, ˜gi + g′
forms a basis of V (f , E) by Proposition 6.4.
(2) The proof is analogous to part (1). We start with f = (f1, . . . , fd) ∈ Q(E)d and deﬁne
the vectors hs ∈ Q(˜E)d for 0 ≤ s < n as in part (1). Since (F, σn) is σ∗-computable and
Problem PTDR is solvable for (F, σn), we can compute the bases Vs = V (hs, Q(˜E)) for
0 ≤ s < n by Theorem 6.2. The remaining calculation steps are as in part (1). ✷
We observe that the obtained algorithm is based on solving Problem PTDR in (˜E, σs)
for 0 ≤ s < n. Here the summands and multiplicands blow up (see e.g., Example 4.6)
which results in heavy ring calculations. In contrast to that the algorithm presented
in [57] works just with the automorphism σ and keeps the multiplicands and summands
as simple as possible. Nevertheless, the new approach is interesting of its own and yields
the ﬁrst algorithm that solves Problem PTDR for the quotient ﬁeld of RΠΣ∗-extensions.

7. Application 2: Symbolic summation and the transcendence of sequences

We will utilize the constructive aspects of the previous sections in order to obtain a
fully automatic toolbox for symbolic summation that is implemented within the package
Sigma [49,54]. In Subsection 7.1 (Propositions 7.3 and 7.5) we will show how one can
compute nested sum and product representations where the sums and products are alge-
braically independent among each other. In addition, we will solve the zero-recognition
problem within such expressions. Moreover, we will provide an automatic machinery
in Subsection 7.2 that enables one to tackle the parameterized telescoping problem, in
particular the creative telescoping paradigm, for nested sums over nested products. Fur-
thermore, we will enhance substantially the techniques of [51] in Theorem 7.11 to show
the transcendence of sequences using the parameterized telescoping paradigm.

In the following we will focus on sequences that can be generated by the class of
nested sums over nested products. The subclass of nested sums over hypergeometric
products can be deﬁned recursively as follows. Let f (k) be an expression that evaluates
at non-negative integers (from a certain point on) to elements of a ﬁeld K.
• f (k) is called a hypergeometric product w.r.t. K and k if it is given in the form
j=l h(j) with l ∈ N and a rational function h(j) ∈ K(j); here l is chosen big

enough such that h(ν) has no pole and is non-zero for all ν ∈ N with ν ≥ l.

• f (k) is called a nested hypergeometric product w.r.t. K and k if it is given in the form

f (k) =Qk
Qk

j=l h1(j)h2(j) . . . hν(j) with l ∈ N where for 1 ≤ i ≤ ν one of the following holds:

· hi(j) ∈ K(j)∗ where hi(ν) has no pole and is non-zero for all ν ≥ k;
· hi(j) is a nested hypergeometric product w.r.t. K and j where hi(j) is free of k.

• f (k) is called a nested sum expression over hypergeometric products (or over nested

hypergeometric products) w.r.t K and k if it is composed recursively by
· elements from the rational function ﬁeld K(k);

42

· hypergeometric products (or nested hypergeometric products) w.r.t. K and k;
· the three operations 6 (+, −, ·);

j=l h(j) with l ∈ N and with h(j) being a nested sum expression
over hypergeometric products (or over nested hypergeometric products) w.r.t. K and
j and being free of k; here l is chosen big enough such that h(j)|j→ν does not intro-
j=l h(j) is also called a nested sum over hypergeometric

· sums of the formPk
duces poles for all ν ≥ l. Pk

products (or over nested hypergeometric products) w.r.t. k and K.

i

i=1

n−i+1

i=1

i

(= (cid:0)n

k(cid:1)), Qk

n−i+1 (=
) are hypergeometric products w.r.t. Q(n) and k. The expressions on the right hand
side of (5.18) are nested hypergeometric products w.r.t. Q and k. The expressions E1(k),
E2(k), E3(k) in (2.1) are nested sums over hypergeometric products w.r.t. Q and k.

i=1(−1)(= (−1)k), Qk

i=1 2(= 2k), Qk

Example 7.1. Qk
(cid:0)n
k(cid:1)−1
More generally, we introduce q-hypergeometric products Qk
hypergeometric products Qk

j=l h(qj) with h(x) ∈ K(x)
where K(x) and K = K(q) are rational functions ﬁelds. Further, we introduce q-mixed
v) with h(x, x1, . . . , xx) ∈ K(x, x1, . . . , xv)
where K(x, x1, . . . , xv) and K = K′(q1, . . . , qv) are rational function ﬁelds. In short, we call
the class of hypergeometric, q-hypergeometric and q-mixed hypergeometric products also
simple products. If one takes the nested versions of these products (the same deﬁnition as
for nested hypergeometric products), one obtains the so-called nested products. Finally,
the deﬁnitions of nested sum expressions over simple products/nested products carry
over immediately. The sums are also called nested sums over simple/nested products.

j=l h(j, qj

1, . . . , qj

We remark that the class of nested sums over hypergeometric products covers as spe-
cial cases harmonic sums [14,59], and more generally, generalized harmonic sums [31,4],
cyclotomic harmonic sums [3] or nested binomial sums [2], which occur as basic building
blocks, e.g., in combinatorics or particle physics [1]. Further, d’Alembertian solutions [8]
(and Liouvillian solutions [22] given by the interlacing of d’Alembertian solutions [41,40])
can be represented by nested sums over simple products.

Any nested sum or product with upper bound k can be evaluated at k for any non-
negative integer ν since poles are excluded by deﬁnition. In particular, a nested sum
expression over simple/nested products f (k) deﬁned as above can be evaluated at k = ν
if the rational functions outside of sums and products do not introduce any poles. If this
is the case, we write f (ν) or f |k→ν or f (k)|k→ν to perform the evaluation for ν ∈ N.

We emphasize that basic RΠΣ∗-extensions in combination with an appropriately cho-
sen K-embedding represent exactly this class of expressions. Namely, suppose that we are
given one of the diﬀerence ﬁelds (F, σ) of Example 2.13 together with the K-embedding
given in the Examples 5.2 or 5.3. Moreover, suppose that we constructed a basic RΠΣ∗-
extension (E, σ) of (F, σ) with E = Fht1i . . . htei and K = const(E, σ) and that we con-
structed a K-embedding τ : E → S(K) by iterative applications of Lemma 5.4 (see also
Theorem 5.9). Within this process we get in addition a deﬁning function ev together with
an o-function L and a z-function Z for τ . Note that the ti are mapped to (5.11) where
the summand or multiplicand are given in terms of the variables t1, . . . , ti−1 below of ti.
Expanding this deﬁnition leads precisely to nested sums over nested products.

6 We do not allow divisions, i.e., sums and products may not occur in denominators. However, we can

write (Qk

j=l

h(j))−1 asQk

j=l

1
h(j) which allows to represent Laurent polynomial expressions.

43

In this regard, we will introduce the following deﬁnition. Take f ∈ E and replace all
occurrences of x by the symbolic variable k and all ti by the nested sums and products
where the outermost upper bound is k. Then we call the derived expression also the by
τ (and ev) induced expression w.r.t. k and denote it by exprk(f ). By construction,

ev(f, ν) = exprk(f )|k→ν

for all ν ∈ N with ν ≥ L(f ). In particular, exprk satisﬁes the evaluation properties (5.3)–
(5.6); here the bound δ can be obtained by the given o-function L and z-function Z.

Example 7.2. Consider the RΠΣ∗-extension (E, σ) of the diﬀerence ﬁeld (Q(n)(x), σ)
with E = Q(n)(x)[y]hp1ihp2i[s1] and the K-embedding τ deﬁned by (5.17) from Exam-
ple 5.6. Then for β2 =

(x+1)(x+2) ∈ E we get

−y

exprk(β2) =

1

(k + 1)(k + 2)

(−1) =

1

(k + 1)(k + 2)

(−1)k

(7.1)

and for β3 =

exprk(β3) =

1

(x+1)2(x+2)(cid:0)3 + x − (x + 1)(x + 2)y(cid:0)2s1 + 1(cid:1)(cid:1) ∈ E we obtain

k

1

(k + 1)2(k + 2)(cid:0)3 + k − (k + 1)(k + 2)(−1)k(cid:0)2

Pi=1

(−1)i

i + 1(cid:1)(cid:1).

(7.2)

7.1. Automatic representations of nested sums and products in basic RΠΣ∗-extensions

k

Qi=1

We consider the following key problem of indeﬁnite summation.

Problem EAR: Elimination of Algebraic Relations.
Given a nested sum expression A(k) over nested products.
Find a δ ∈ N and a nested sum expression B(k) over nested products with

(1) A(ν) = B(ν) for all ν ≥ δ;
(2) the sequences produced by the occurring sums and products in B(k) (except

products over roots of unity) are algebraically independent.

In part (1) of Proposition 7.3 a recipe will be provided that solves Problem EAR. In
particular, if Problem EAR is tackled in this way, it is shown in part (2) of Proposition 7.3
that the zero-recognition problem is solved automatically.

Proposition 7.3. Let A(k) be a nested sum expression over nested products w.r.t. K and
k. Let (E, σ) be an RΠΣ∗-extension of one of the diﬀerence ﬁelds (F, σ) from Example 2.13
with constant ﬁeld K; let τ : E → S(K) be a K-embedding given by iterative application
of Lemma 5.4 starting with the embedding given in Examples 5.2 or 5.2. Let a ∈ E with
B(k) := exprk(a) and δ ∈ N such that A(ν) = B(ν) holds for all ν ∈ N with ν ≥ δ. Then:

(1) B(k) and δ are a solution of Problem EAR.
(2) B(k) is the zero-expression iﬀ A(ν) = 0 for all ν ≥ λ for some λ ∈ N.

Proof. (1) To show explicitly that B(k) is a solution of Problem EAR, reorder (E, σ) to
the form (2.2) where A = F. Then using the fact that τ is a K-embedding we get

=:L

τ (E) =

τ (F)[τ (y1), . . . , τ (yl)]

[τ (p1), τ (p−1

1 )] . . . [τ (pr), τ (p−1

r )][τ (s1)] . . . [τ (sv)]

{

z
|

=:R

{z

}

}|

44

where R is the ring given by the root of unity sequences, L is the ring extension of Laurent-
polynomials with the algebraically independent sequences τ (p1), τ (p−1
1 ), . . . , τ (pr), τ (p−1
r ),
and L[τ (s1)] . . . [τ (sv)] forms the polynomial ring with the algebraically independent
sequences τ (s1), . . . , τ (sv). Hence B and δ are indeed a solution of Problem EAR.
(2) A(ν) = B(ν) holds for all ν ≥ δ. This implies “⇒”.
“⇐”: Suppose that B(k) is not the zero-expression. Then B 6= 0 implies a 6= 0 and thus
τ (a) 6= 0. Hence for any λ ∈ N there exists a ν ≥ λ with 0 6= B(ν) = A(ν). ✷

Suppose we are given a nested sum expression A(k) over nested products w.r.t. K and
k. Then we will carry out the strategy introduced in Proposition 7.3 as follows.

Preparation: Determine a ρ ∈ N such that A(ν) can be evaluated for all ν ∈ N with
ν ≥ ρ. Namely, consider the denominators in A(k) which do not arise inside of sums
and products, and determine the ﬁnite number of zeros, say z1, . . . , zr ∈ N, that can
arise there (for the q–case and q–mixed case see [12, Sec. 3.7]). Then we can take
ρ = max(z1, . . . , zr) + 1. In addition, take the appropriate diﬀerence ﬁeld (F, σ) with
the K-embedding τ : F → S(K) from Examples 5.2 or 5.3.

Process all products: Try to compute a basic RΠ-extension (H, σ) of (F, σ) and, using
Lemma 5.4, extend τ to a K-embedding τ : H → S(K) together with an o-function L
and a z-function Z such that the following holds: for any arising product P (k) in
A(k) (here also the products inside of sums and products are handled where the upper
bounds are replaced with k) one obtains a p ∈ H and δp ∈ N such that exprk(p)|k→ν =
P (ν) holds for all ν ≥ δp; note that τ (p) = hP (k)ik≥0. If this fails, STOP.

Remark 7.4. For a ﬁnite set of hypergeometric products w.r.t. K and k with a rational
function ﬁeld K = K′(n1, . . . , nλ) and K′ = Q this product representation can be cal-
culated by the algorithms given in [46,55]. In [33] these ideas have been generalized for
simple products, i.e., for (q–)hypergeometric and q–mixed hypergeometric expressions
where the subﬁeld K′ of K can be even an algebraic number ﬁeld. For nested products
the automatic construction is more subtle and is currently under investigation.

Process all sums: By iterative application of Theorem 2.4 and Lemma 5.4 we will
construct a Σ∗-extension (E, σ) of (H, σ), and we will extend τ to a diﬀerence ring
embedding τ : E → S(K) such that for any sum S(k) in A(k) (here we take also those
sums occurring inside of sums and replace the outermost summation bound with k)
we can take an element s ∈ E with τ (s) = hS(k)ik≥0. We proceed stepwise.
Suppose that we treated already the nested sums and products A1(k), . . . , An(k) of
A(k) where for each Aj(k) with 1 ≤ j ≤ n we are given an aj ∈ E with τ (aj ) =
hAj (i)ii≥0 and we are given a δj ∈ N such that Aj(ν) = exprk(aj)|k→ν holds for
i=λ h(i) with λ ∈ N where all
sums and products in h(k) have been treated earlier. Hence replacing all occurrences
of Aj in h(k) by aj leads to β′ ∈ E such that exprk(β′)|k→ν = h(ν) holds for all
ν ≥ δ := max(λ, δ1, . . . , δn, L(β′)) (it suﬃces to take only those δj where tj occurs in
β). Note that τ (β′) = hh(ν)iν≥0. Now we set β := σ(β′) and consider two cases.
(1) With the algorithms from [57] one shows that there is no g ∈ E with σ(g) = g + β.
Hence we can construct the Σ∗-extension (E(te+1), σ) of (E, σ) with σ(te+1) = te+1 +
β. In addition, we can extend τ to τ : E[te+1] → S(K) with (5.11) where r := δ and
k=λ h(i) ∈ K. With an+1 := te+1 and δn+1 := δ we have for all ν ≥ δn+1:

all ν ≥ δj. We process the next sum An+1(k) = Pk

i=λ h(k) = An+1(ν).

c = Pδ−1
ev(an+1, ν) = ev(te+1, ν) =Pν

i=δ ev(β, i − 1) + c =Pν

45

(2) Otherwise one obtains a g ∈ E with σ(g) = g + β. Take δn+1 := max(δ, L(g)) and
i=λ h(i) ∈ K. With an+1 := g + c this yields ev(an+1, ν + 1) =
ev(an+1, ν) + ev(β, ν) and An+1(ν + 1) − An+1(ν) = ev(β, ν) for all ν ≥ δn+1. Since
i=λ h(i) =

set c := −ev(g, δ) +Pδ
the initial values agree, i.e., ev(an+1, δ) = ev(g + c, δ) = ev(g, δ) + c =Pδ

An+1(δ), we conclude that An+1(ν) = ev(a, ν) = exprk(a)|k→ν for all ν ≥ δn+1.

An+1(k) has been tackled and we continue with the remaining sums in A(k).

Combine expressions: Let A1(k), . . . , Am(k) be all occurring sums and products in
A(k) with the derived a1, . . . , am ∈ E and δ1, . . . , δm ∈ N, respectively. Replace the
Aj(k) by the aj in A(k) which yields b ∈ E. With ρ from the preprocessing step
we deﬁne δ := max(ρ, δ1, . . . , δm, L(b)) and B := exprk(b). By construction we get
B(ν) = ev(b, ν) = A(ν) for all ν ≥ δ.

If one succeeds in this construction, one has solved Problem EAR by Proposition 7.3. In
particular, if one restricts to the class of nested sums over simple products, this method
turns to a complete algorithm by Remark 7.4 which can be summarized as follows.

Proposition 7.5. Let A(k) be a nested sum expression over simple products w.r.t. K
and k where K is a rational function ﬁeld over an algebraic number ﬁeld. Then (E, σ) and
τ : E → S(K) as assumed in Proposition 7.3 can be computed. Further, Problem EAR
and the zero recognition problem for A(k) are solved.

The described method for nested sums over nested products can be executed within the
summation package Sigma with the function call SigmaReduce[A,k].

Example 7.6. Consider the expressions in (2.1) and apply them to SigmaReduce. Sigma
starts with the ΠΣ∗-ﬁeld (K(x), σ) with σ(x) = x+1 over K = Q(n) together with the K-
embedding τ : K(x) → S(K) from Example 2.17. Then the objects given in (2.1) (parsed
from left to right) are represented in an RΠΣ∗-extension. To be more precise, as worked
out in the Examples 2.1 and 2.14 Sigma constructs the basic RΠΣ∗-extension (A, σ) of
(K(x), σ) with A = K(x)[y][p1, 1
][s1] (here we set s1 = t1) where σ(y) = −y,
p1
σ(p1) = 2 p1, σ(p2) = n−x
x+1 . Furthermore, Sigma extends τ to
the K-embedding τ : A → S(K) with (5.17). In short, x, y, p1, p2 and s1 represent the

x+1 p2 and σ(s1) = s1 − y

][p2, 1
p2

2 =

y

n−i+1

i=1

i

, E1(k), respectively.

k(cid:1) =Qk

summation objects k, (−1)k, 2k, (cid:0)n
Next, Sigma treats E2(k) =Pk

i=1 h2(i) with h2(k) = (−1)k

x(x+1) . Set β2 := σ(β′

k(k+1) given in (2.1). Here we can
represent the summand h2(k) by β′
(x+1)(x+2) . Then we
have that τ (β2) = hh2(ν + 1)iν≥0 where exprk(β2)|k→ν = h2(ν + 1) for all ν ≥ δ0 := 0;
see also (7.1). As observed in Examples 2.14 or 3.14, one ﬁnds g = 2(x+1)s1−y
∈ A
such that σ(g) = g + β2 holds. Thus we get S(τ (g)) = τ (g) + τ (β2). In particular, for
0 = max(L(g), L(β2), δ0) = 0 and G2(k) = exprk(g) = 1
δ′
obtain G2(k+1) = G2(k)+h2(k+1) for all k ≥ δ′
it follows that G2(k) + c′ and E2(k) agree for all k ≥ 0 if they agree for k = δ′
Taking c′ = 1 we get E2(k) = G2(k) + 1 which is the second identity in (3.17).

k+1(cid:0)2(k + 1)E1(k) − (−1)k(cid:1) we

0 = 0. Since E2(k+1) = E1(k)+h2(k+1),
0 = 0.

2) =

−y

x+1

Finally, Sigma treats E3(k) = Pk

represented already in (A, σ). As a consequence h3(k) can be represented by β′
−1+y(1+x)(1+2s1)

j=1 h3(j). The sums and products in h3(k) have been
3 =
3) represents h3(k + 1): τ (β3) = hh3(k +
1)ik≥0 and by construction we get exprk(β3) = h3(k + 1); see also (7.2). We demonstrate

∈ A. In particular, β3 := σ(β′

x(1+x)

46

τ : A[s2] → S(K) with τ (s2) = hPk

the importance of enhanced telescoping algorithms to achieve simpliﬁcations.
• Naive telescoping. We do not ﬁnd a g ∈ A[s1] with σ(g) = g + β3; see Example 3.14.
Hence we take the Σ∗-extension (A[s2], σ) of (A, σ) with σ(s2) = s2 + β3 and extend τ to
i=1 h3(i)ik≥0. No simpliﬁcation has been accomplished
and exprk(s2) equals the right hand side of the third identity in (3.17). Still we solved
Problem EAR and conclude that hE3(k)ik≥0 is algebraically independent over τ (A).
• Reﬁned telescoping. Alternatively, we can use reﬁned summation algorithms as worked
out in [45,50,53,56]. Activating Sigma one computes the Σ∗-extension (A[s′
2], σ) of (A, σ)
with σ(s′
(x+1)2 together with the solution 7 g = s′
x+1 ∈ A[s2]
of σ(g) = g + β3. Extending the K-embedding to τ : A[s′
2) =
1
i2 ik≥0 we obtain S(τ (g)) = τ (g) + τ (β3) and G3(k + 1) = G3(k) + h3(k + 1) for
j +
k+1 . Thus G3(k) + c′′ with c′′ ∈ K and E3(k) agree if they are equal at

0) = 0 where G3(k) = exprk(g) =Pk

2 + s1 + s2
2] → S(K) with τ (s′

k ≥ δ1 := max(L(g), L(β3), δ′

i2 +Pk

2 + 1

2) = s′

1 + 1

+ 1

(−1)j

(−1)j

j=1

j=1

j=1

i=1

1

j

k = δ1 = 0. This is the case for c′′ = −1 yielding

hPk
(cid:0)Pk

(cid:1)2

E3(k) = exprk(g − 1) = G3(k) − 1 =

1
j2 +

k

Pj=1

k

Pj=1

(−1)j

j +(cid:16) k
Pj=1

(−1)j

j (cid:17)2

−

k

k + 1

.

(7.3)

Thus hE3(k)ik≥0 = τ (g − 1′). We remark that we get the following (Laurent) polynomial
ring over the coeﬃcient ring R = τ (Q(n)(x))[h(−1)k ik≥0]:

k

k

(−1)i

k(cid:1)ik≥0, h(cid:0)n
k(cid:1)−1

R(cid:2)h2kik≥0, h2−kik≥0(cid:3)(cid:2)h(cid:0)n

Pi=1
Example 7.7. Executing SigmaReduce[A,k] with the input A(k) = Qk

j=1 j! the
basic Π-extension (K(x)[p1, 1
], σ) of (K(x), σ) from Example 2.17 is con-
p1
structed together with the K-embedding τ : K(x)[p1, 1
] → S(K) deﬁned
p1
by (5.18). Here p3 represents A(k) and we get τ (p3) = hA(k)ik≥0. Summarizing, Sigma
returns A(k) without any simpliﬁcation. As a by-product, we gain the insight that

i2 ik≥0(cid:3).
i=1Qi

ik≥0(cid:3)(cid:2)h
Pi=1

][p2, 1
p2

][p2, 1
p2

][p3, 1
p3

][p3, 1
p3

ik≥0, h

1

i

τ (K(x))(cid:2)hk!ik≥0, hk!−1ik≥0(cid:3)(cid:2)h
Qi=1

k

i!ik≥0, h

k

Qi=1

i!−1ik≥0(cid:3)(cid:2)hA(k)ik≥0, hA(k)−1ik≥0(cid:3)

forms a (Laurent) polynomial ring over the ﬁeld τ (K(x)) of rational sequences.

7.2. Parameterized telescoping and algebraic independence of sum sequences

The summation paradigm of parameterized telescoping in terms of nested sum expres-

sions can be formulated as follows.

Problem PT: Parameterized Telescoping.
Given nested sum expressions F1(k), . . . , Fd(k) over nested products w.r.t. K and k.
Find an appropriate a nested sum expression G(k) over nested products, ﬁnd con-
stants c1, . . . , cd ∈ K, not all zero, and ﬁnd a δ ∈ N s.t. for all k ≥ δ we have

G(k + 1) − G(k) = c1 F1(k) + · · · + cd Fd(k).

(7.4)

a In the simplest version one searches for a G(k) in terms of the objects occurring in the Fi(k).

7 For the given (A[s′

2], σ) the solution g ∈ A[s′

2] has been computed in Example 6.5.

47

Suppose that we succeed in computing such a δ, a G(k) and the ci. Then we can sum
up (7.4) over k from δ to a and obtain the sum relation

c1

a

Xk=δ

a

Xk=δ

F1(k) + · · · + cd

Fd(k) = G(a + 1) − G(δ).

(7.5)

Note that the special case d = 1 boils down to the telescoping problem for indeﬁnite
summation. Further, Problem PT contains the summation paradigm of creative tele-
scoping [63] for deﬁnite summation, which we will illustrate in Example 7.8 below. In
this regard, we refer to [39,37,36,12,17,16] for the (q–mixed)hypergeometric approach,
to [62,18,29] for the holonomic approach, to [61,60,11] for the multi-sum approach, or
to [45,50,53,56] for further reﬁnements of the diﬀerence ﬁeld approach.

The simplest form of Problem PT is solved within the summation package Sigma by the
function call ParameterizedTelescoping[{F1, F2, . . . , Fd}, k]. Here Sigma starts with
the ΠΣ∗-ﬁeld (F, σ) and K-embedding from Examples 5.2 or 5.3. Using the machinery
of Subsection 7.1 (see Proposition 7.5) Sigma computes an RΠΣ∗-extension (E, σ) of
(F, σ) and a K-embedding τ : E → S(K) with a deﬁning function ev with the following
elements: f1, . . . , fd ∈ E and λ = max(L(f1), . . . , L(fd)) such that exprk(fi)|k→ν =
ev(fi, ν) = Fi(ν) holds for all ν ≥ λ and 1 ≤ i ≤ d. We emphasize that this construction
is fully algorithmically for nested sums over simple products.
Using the algorithms from [57,55] or from Section 6 (or enhanced telescoping algorithms
from [45,50,53,56]) we can now compute a basis of V ((f1, . . . , fd), E), and can decide if
there exists a g ∈ E and (c1, . . . , cd) ∈ Kd \ {0} such that (6.2) holds. If yes, we get

ev(g, ν + 1) − ev(g, ν) = c1 ev(f1, ν) + · · · + cd ev(fd, ν)

for all ν ≥ δ with δ := max(λ, L(g)). In particular, setting G(k) := exprk(g) we
have that G(ν) = ev(g, ν) and ev(fj, ν) = exprk(fi)|k→ν = Fi(ν) for all ν ≥ δ. Thus
(c1, . . . , cd, G(k)) is a solution of (7.4) for all k ≥ δ.

Example 7.8. A special case of parameterized telescoping is Zeilberger’s creative tele-
scoping paradigm [63]. We illustrate it with the sum

S(n) =

F (n, k) =

n

Xk=0

n

Xk=0(cid:18)n

k(cid:19)(cid:0)(−2)k + 2k(cid:1) k
Pi=1

(−1)i

i

.

(7.6)

j=1

We set Fi(k) := F (n + i − 1, k) for i ≥ 1 and obtain Fi(k) = Qi−1

n+j
n−k+j F (n, k). Now
we try to ﬁnd a solution of (7.4) for d = 1, 2, 3 . . . . Given F1(k), we start with the
ΠΣ∗-ﬁeld (K(x), σ) over K = Q(n) with σ(x) = x + 1. We parse the summation objects
in (7.6) and construct the RΠΣ∗-extension (E, σ) of (F, σ) with E = F[y]hp1ihp2i[s1]
from Example 5.6 together with the Q(n)-embedding τ : E → S(Q(n)) with (5.17). Here

Sigma, we fail to ﬁnd a g ∈ E such that (7.4) holds for d = 1. Hence we proceed with
n+j
n−x+j f0 ∈ E for i ≥ 1, i.e.,
we have that exprk(fi) = Fi(k) for all k ≥ 0. Eventually, at d = 5 we succeed: we

we obtain f1 = p2 s1(cid:0)y p1 + p1(cid:1) with exprk(f1) = F1(k). Activating the algorithms in
d = 2, 3, . . . . Here we represent the Fi(k) with fi = Qi−1
ﬁnd c1 = 9(n + 1)(n + 2), c2 = 12(n + 2)2, c3 = −2(cid:0)n2 + 5n + 9(cid:1), c4 = −4(n + 3)2,

c5 = (n + 3)(n + 4) and g ∈ E (which is too big to print it here) such that (6.2) holds.

j=1

48

Taking G(k) = exprk(g) leads to the solution (7.4) with d = 5 for k ≥ 0. Summing this
equation over k from 0 to a gives the sum relation

a

a

c1

a

Xk=0

F (n, k) + c2

F (n, k + 1) + · · · + c5

Finally, setting a = n and taking care of missing terms produces

Xk=0
9(n + 1)(n + 2)S(n) + 12(n + 2)2S(n + 1) − 2(cid:0)n2 + 5n + 9(cid:1)S(n + 2)

−4(n + 3)2S(n + 3) + (n + 3)(n + 4)S(n + 4) = −8.

Xk=0

F (n + 4, k) = G(a + 1) − G(0). (7.7)

Solving this recurrence relation in terms of d’Alembertian solutions with the algorithms
from [7,38,8,10,15,43,47], simplifying the solutions by our advanced telescoping algo-
rithms [45,50,53,56] and taking the ﬁrst 4 initial values of S(n) produces

S(n) = (−1)n

(−3)i

i

n

Xi=1

− (−1)n

(−1)i

i

+ 3n

n

Xi=1

n

Xi=1 (cid:0) − 1
3(cid:1)i

i

− 3n

n

Xi=1 (cid:0) 1
3(cid:1)i

i

.

Summarizing, a non-trivial solution of the parameterized telescoping problem provides
the linear relation (7.5). Conversely, it is amazing that the non-existence of such a solution
implies the algebraic independence of the sums given in (7.5). This aspect has been
worked out in [51] in the setting of ΠΣ∗-ﬁeld extensions; see also [21]. In the following
we will generalize these concepts from the ﬁeld to the ring setting. In this regard, we
utilize [5, Proposition 1]; compare [25,52] for various ﬁeld versions.

Proposition 7.9. Let (A[t1] . . . [te], σ) be a Σ∗-extension of (A, σ) with σ(ti) − ti ∈ A
for 1 ≤ i ≤ e where K := const(A, σ) is a ﬁeld. Let g ∈ A[t1] . . . [te] with σ(g) − g ∈ A.

i=1 ci ti + w with ci ∈ K and w ∈ A.

With this result we can now generalize [51, Thm 3.1] to the ring setting.

Then g =Pe

Theorem 7.10. Let (A, σ) be a diﬀerence ring with constant ﬁeld K and let (f1, . . . , fd) ∈
Ad. Then the following statements are equivalent.

(1) There do not exist a 0 6= (c1, . . . , cd) ∈ Kd and a g ∈ A with (6.2).
(2) There is a Σ∗-extension (A[t1] . . . [td], σ) of (A, σ) with σ(ti) = ti + fi for 1 ≤ i ≤ d.

Proof. (2) ⇒ (1): Suppose that (6.2) holds for some 0 6= (c1, . . . , cd) ∈ Kd and g ∈ A. In
addition, assume that there exists a Σ∗-extension (E, σ) of (A, σ) with E = A[t1] . . . [td]
i=1 ci ti) −
i=1 ci ti − g. Since not all ci are zero and g ∈ A,

i=1 ci(cid:0)σ(ti) − ti(cid:1) = σ(Pd

and σ(ti) = ti + fi for 1 ≤ i ≤ d. Then σ(g) − g =Pd
Pd
i=1 ci ti, and thus σ(h) = h with h =Pd
and thus γ = h +Pi
fi+1 −Pi

h /∈ const(E, σ) \ K; a contradiction since (E, σ) is a Σ∗-extension of (A, σ).
(1) ⇒ (2): Let 0 ≤ i < d be maximal such that (A[t1] . . . [ti], σ) is a Σ∗-extension of
(A, σ), but ti+1 is not a Σ∗-monomial. Hence σ(γ) − γ = fi+1 for some γ ∈ A[t1] . . . [ti],
j=1 cj tj for some cj ∈ K and h ∈ A by Prop. 7.9. Thence σ(h) − h =
j=1 cj fj, i.e., we get a solution of (6.2) in A. ✷

j=1 cj(σ(tj ) − tj) = fi+1 −Pi

To this end, we arrive at the following result; for a special case see [51, Thm. 5.2].

Theorem 7.11. Let (E, σ) be a basic RΠΣ∗-extension of (F, σ) with constant ﬁeld
K := const(F, σ), and let τ : E → S(K) be a K-embedding with (5.2) together with an
o-function L; let (f1, . . . , fd) ∈ Ed. Then the following statements are equivalent:

49

(1) There are no g ∈ E and 0 6= (c1, . . . , cd) ∈ Kd with (6.2).
(2) The sequences hS1(a)ia≥0, . . . , hSd(a)ia≥0 given by

S1(a) :=

a

Xk=l

a

Xk=l

ev(f1, k), . . . , Sd(a) :=

ev(fd, k)

(7.8)

with l ≥ max(L(f1), . . . , L(fd)) ∈ N are algebraically independent over τ (E).

Proof. (1) ⇒ (2): Suppose that there does not exist a g ∈ E and 0 6= (c1, . . . , cd) ∈ Kd
with (6.2). Then there does not exist a g ∈ E and 0 6= (c1, . . . , cd) ∈ Kd with σ(g) − g =
c1 σ(f1) + · · · + cd σ(fd). By Theorem 7.10 we can construct the Σ∗-extension (H, σ) of
(E, σ) with H = E[s1] . . . [sd] and σ(si) = si + σ(fi) for 1 ≤ i ≤ d. Note that (H, σ)
is a basic RΠΣ∗-extension of (F, σ). By iterative application of Lemmas 5.4 and 5.8 we
can extend τ to a K-embedding τ : H → S(K). In particular, we can take l ∈ N with
l ≥ max(L(f1), . . . , L(fd)) ∈ N and c = 0 in (5.11) and get exprk(sj)|k→n = Si(n) for all
n ≥ l. Consequently τ (E)[hS1(n)in≥0, . . . , hSd(n)in≥0] forms a polynomial ring.
(2) ⇒ (1): Assume that there exist a g ∈ E and 0 6= (c1, . . . , cd) ∈ Kd with (6.2).
Then we obtain (7.4) with G(k) = ev(g, k) and Fi(k) = ev(fi, k) for all k ≥ δ with
δ := max(L(f1), . . . , L(fd), L(g)). Therefore summing (7.4) over k from δ to a yields (7.5)
for all a ≥ δ. Note that for l ∈ N with l ≥ max(L(f1), . . . , L(fd)) we have that l ≤ δ.
Therefore we can adapt the lower bounds of the sums in (7.5) to l by taking care of
compensating terms which are elements from K. Thus we obtain a slightly modiﬁed right
hand side in (7.5). Thus the sequences produced by S1(a), . . . , Sd(a) are algebraically
dependent over τ (E). ✷

Example 7.12. Take the RΠΣ∗-extension (E, σ) of (F, σ) from Example 7.8 (resp. of
Examples 2.14 and 5.6). As demonstrated in Example 7.8 we can represent the shifted
versions Fi(k) = F (n + i − 1, k) of the summand F (n, k) in (7.6) for all i ≥ 1 by fi ∈ E.
Namely, we have that ev(fi, k) = Fi(k) = F (n + i − 1, k) for all k ≥ 0. In particular,
we checked in Example 7.8 that there is no g ∈ E with (6.2) for d = 4. Hence the
sequences (7.8) with l = 0 and d = 4 are algebraically independent over τ (E). We remark
that for d = 5 we obtain the relation (7.7) for explicitly given ci and G(a + 1) − G(0).

8. Conclusion

Starting from the results of [24,57] we derived new insight for basic RΠΣ∗-extensions
and gained similar results popping up in the Galois theory of diﬀerence equations [22,21].
As a consequence we obtained new intrinsic characterizations of basic RΠΣ∗-extensions
based on the notion of simple diﬀerence rings, on the decomposition of interlaced diﬀer-
ence rings, and on the embedding of diﬀerence rings into the ring of sequences. In par-
ticular, these results yield a new method to solve the parameterized telescoping problem
within such a ring or its quotient ring. Moreover, we provided a constructive machin-
ery to embed basic RΠΣ∗-extensions into the ring of sequences. As a consequence we
can justify in full generality that the summation package Sigma produces simpliﬁcations
where the arising sums are algebraically independent. In this regard, we could generalize
the diﬀerence ﬁeld results of [51] to show that the non-existence of a parameterized tele-
scoping solution (in particular, of a creative telescoping solution) in an RΠΣ∗-extension
provides a proof that certain indeﬁnite nested sums are algebraically independent.

50

Further investigations will be necessary in order to gain similar results for simple
RΠΣ∗-extension [57] which enable one to represent also expressions in terms of nested
products that depend on (−1)(k
l) for some l ∈ N. Besides this, it will be very interesting
to see if the obtained results (like, e.g., Theorem 3.13) can contribute to new algorithmic
aspects of the Galois theory of diﬀerence equations [58,21].

References

[1] J. Ablinger, A. Behring, J. Bl¨umlein, A. De Freitas, A. von Manteuﬀel, and C. Schneider. Calculating
three loop ladder and V-topologies for massive operator matrix elements by computer algebra.
Comput. Phys. Comm., in press, pages 1–110, 2016. arXiv:1509.08324 [hep-ph].

[2] J. Ablinger, J. Bl¨umlein, C.G. Raab, and C. Schneider. Iterated binomial sums and their associated

iterated integrals. J. Math. Phys., 55(112301):1–57, 2014. arXiv:1407.1822 [hep-th].

[3] J. Ablinger, J. Bl¨umlein, and C. Schneider. Harmonic sums and polylogarithms generated by

cyclotomic polynomials. J. Math. Phys., 52(10):1–52, 2011. [arXiv:1007.0375 [hep-ph]].

[4] J. Ablinger, J. Bl¨umlein, and C. Schneider. Analytic and algorithmic aspects of generalized harmonic

sums and polylogarithms. J. Math. Phys., 54(8):1–74, 2013. arXiv:1302.0378 [math-ph].

[5] J. Ablinger and C. Schneider. Algebraic independence of (cyclotomic) harmonic sums. In submitted.

2015. arXiv:1510.03692 [cs.SC].

[6] S. A. Abramov. The rational component of the solution of a ﬁrst-order linear recurrence relation
with a rational right-hand side. U.S.S.R. Comput. Maths. Math. Phys., 15:216–221, 1975. Transl.
from Zh. vychisl. mat. mat. ﬁz. 15, pp. 1035–1039, 1975.

[7] S. A. Abramov. Rational solutions of linear diﬀerential and diﬀerence equations with polynomial

coeﬃcients. U.S.S.R. Comput. Math. Math. Phys., 29(6):7–12, 1989.

[8] S. A. Abramov and M. Petkovˇsek. D’Alembertian solutions of linear diﬀerential and diﬀerence

equations. In J. von zur Gathen, editor, Proc. ISSAC’94, pages 169–174. ACM Press, 1994.

[9] S. A. Abramov and M. Petkovˇsek. Polynomial ring automorphisms, rational (w, σ)-canonical forms,

and the assignment problem. J. Symbolic Comput., 45(6):684–708, 2010.

[10] S. A. Abramov and E. V. Zima. D’Alembertian solutions of inhomogeneous linear equations

(diﬀerential, diﬀerence, and some other). In Proc. ISSAC’96, pages 232–240. ACM Press, 1996.

[11] M. Apagodu and D. Zeilberger. Multi-variable Zeilberger and Almkvist-Zeilberger algorithms and

the sharpening of Wilf-Zeilberger theory. Adv. Appl. Math., 37:139–152, 2006.

[12] A. Bauer and M. Petkovˇsek. Multibasic and mixed hypergeometric Gosper-type algorithms.

J. Symbolic Comput., 28(4–5):711–736, 1999.

[13] J. Bl¨umlein. Algebraic relations between harmonic sums and associated quantities. Comput. Phys.

Commun., 159(1):19–54, 2004. [arXiv:hep-ph/0311046].

[14] J. Bl¨umlein and S. Kurth. Harmonic sums and Mellin transforms up to two-loop order. Phys. Rev.,

D60, 1999.

[15] M. Bronstein. On solutions of linear ordinary diﬀerence equations in their coeﬃcient ﬁeld.

J. Symbolic Comput., 29(6):841–877, 2000.

[16] S. Chen, F. Chyzak, R. Feng, G. Fu, and Z. Li. On the existence of telescopers for mixed

hypergeometric terms. J. Symbolic Comput., 68(part 1):1–26, 2015.

[17] S. Chen and M. Kauers. Order-Degree Curves for Hypergeometric Creative Telescoping. In Joris

van der Hoeven and Mark van Hoeij, editors, Proceedings of ISSAC 2012, pages 122–129, 2012.

[18] F. Chyzak. An extension of Zeilberger’s fast algorithm to general holonomic functions. Discrete

Math., 217:115–134, 2000.

51

[19] R. M. Cohn. Diﬀerence Algebra. Interscience Publishers, John Wiley & Sons, 1965.

[20] B: Er¨ocal. Algebraic extensions for summation in ﬁnite terms. PhD thesis, RISC, Johannes Kepler

University, Linz, February 2011.

[21] C. Hardouin and M.F. Singer. Diﬀerential Galois theory of linear diﬀerence equations. Math. Ann.,

342(2):333–377, 2008.

[22] P. A. Hendriks and M. F. Singer. Solving diﬀerence equations in ﬁnite terms. J. Symbolic Comput.,

27(3):239–259, 1999.

[23] G. Karpilovsky. On ﬁnite generation of unit groups of commutative group rings. Arch. Math.

(Basel), 40(6):503–508, 1983.

[24] M. Karr. Summation in ﬁnite terms. J. ACM, 28:305–350, 1981.

[25] M. Karr. Theory of summation in ﬁnite terms. J. Symbolic Comput., 1:303–315, 1985.

[26] M. Kauers and C. Schneider. Indeﬁnite summation with unspeciﬁed summands. Discrete Math.,

306(17):2021–2140, 2006.

[27] M. Kauers and C. Schneider. Symbolic summation with radical expressions. In C.W. Brown, editor,

Proc. ISSAC’07, pages 219–226, 2007.

[28] M. Kauers and B. Zimmermann. Computing the algebraic relations of c-ﬁnite sequences and

multisequences. Journal of Symbolic Computation, 43(11):787–803, 2008.

[29] C. Koutschan. Creative telescoping for holonomic functions. In C. Schneider and J. Bl¨umlein, editors,
Computer Algebra in Quantum Field Theory: Integration, Summation and Special Functions, Texts
and Monographs in Symbolic Computation, pages 171–194. Springer, 2013. arXiv:1307.4554 [cs.SC].

[30] A. Levin. Diﬀerence algebra, volume 8 of Algebra and Applications. Springer, New York, 2008.

[31] S. O. Moch, P. Uwer, and S. Weinzierl. Nested sums, expansion of transcendental functions, and

multiscale multiloop integrals. J. Math. Phys., 6:3363–3386, 2002.

[32] Erhard Neher. Invertible and nilpotent elements in the group algebra of a unique product group.

Acta Appl. Math., 108(1):135–139, 2009.

[33] E.D. Ocansey and C. Schneider. Representing (q–)hypergeometric expressions and mixed versions

in diﬀerence rings. In preparation, 2016.

[34] Franz Pauer and Andreas Unterkircher. Gr¨obner bases for ideals in Laurent polynomial rings and
their application to systems of diﬀerence equations. Appl. Algebra Engrg. Comm. Comput., 9(4):271–
291, 1999.

[35] P. Paule. Greatest factorial factorization and symbolic summation. J. Symbolic Comput., 20(3):235–

268, 1995.

[36] P. Paule and A. Riese. A Mathematica q-analogue of Zeilberger’s algorithm based on an algebraically
motivated approach to q-hypergeometric telescoping. In M. Ismail and M. Rahman, editors, Special
Functions, q-Series and Related Topics, volume 14, pages 179–210. AMS, 1997.

[37] P. Paule and M. Schorn. A Mathematica version of Zeilberger’s algorithm for proving binomial

coeﬃcient identities. J. Symbolic Comput., 20(5-6):673–698, 1995.

[38] M. Petkovˇsek. Hypergeometric solutions of

linear recurrences with polynomial coeﬃcients.

J. Symbolic Comput., 14(2-3):243–264, 1992.

[39] M. Petkovˇsek, H. S. Wilf, and D. Zeilberger. A = B. A. K. Peters, Wellesley, MA, 1996.

[40] M. Petkovˇsek and H. Zakrajˇsek. Solving linear recurrence equations with polynomial coeﬃcients.
In C. Schneider and J. Bl¨umlein, editors, Computer Algebra in Quantum Field Theory: Integration,
Summation and Special Functions, Texts and Monographs in Symbolic Computation, pages 259–284.
Springer, 2013.

[41] C. Reutenauer. On a matrix representation for polynomially recursive sequences. Electron. J.

Combin., 19(3):Paper 36, 26, 2012.

52

[42] C. Schneider. An Implementation of Karr’s Summation Algorithm in Mathematica. Sem. Lothar.

Combin., S43b:1–10, 2000.

[43] C. Schneider. Symbolic summation in diﬀerence ﬁelds. Technical Report 01-17, RISC-Linz, J. Kepler

University, November 2001. PhD Thesis.

[44] C. Schneider. Symbolic summation with single-nested sum extensions. In J. Gutierrez, editor, Proc.

ISSAC’04, pages 282–289. ACM Press, 2004.

[45] C. Schneider. Finding telescopers with minimal depth for indeﬁnite nested sum and product

expressions. In M. Kauers, editor, Proc. ISSAC’05, pages 285–292. ACM, 2005.

[46] C. Schneider. Product representations in ΠΣ-ﬁelds. Ann. Comb., 9(1):75–99, 2005.

[47] C. Schneider. Solving parameterized linear diﬀerence equations in terms of indeﬁnite nested sums

and products. J. Diﬀer. Equations Appl., 11(9):799–821, 2005.

[48] C. Schneider. Simplifying sums in ΠΣ-extensions. J. Algebra Appl., 6(3):415–441, 2007.

[49] C. Schneider. Symbolic summation assists combinatorics. S´em. Lothar. Combin., 56:1–36, 2007.

Article B56b.

[50] C. Schneider. A reﬁned diﬀerence ﬁeld theory for symbolic summation. J. Symbolic Comput.,

43(9):611–644, 2008. [arXiv:0808.2543v1].

[51] C. Schneider. Parameterized telescoping proves algebraic independence of sums. Ann. Comb.,

14:533552, 2010. [arXiv:0808.2596]; for a preliminary version see FPSAC 2007.

[52] C. Schneider. Structural theorems for symbolic summation. Appl. Algebra Engrg. Comm. Comput.,

21(1):1–32, 2010.

[53] C. Schneider. A symbolic summation approach to ﬁnd optimal nested sum representations.

In
A. Carey, D. Ellwood, S. Paycha, and S. Rosenberg, editors, Motives, Quantum Field Theory, and
Pseudodiﬀerential Operators, volume 12 of Clay Mathematics Proceedings, pages 285–308. Amer.
Math. Soc, 2010. arXiv:0808.2543.

[54] C. Schneider. Simplifying multiple sums in diﬀerence ﬁelds. In C. Schneider and J. Bl¨umlein, editors,
Computer Algebra in Quantum Field Theory: Integration, Summation and Special Functions, Texts
and Monographs in Symbolic Computation, pages 325–360. Springer, 2013. arXiv:1304.4134 [cs.SC].

[55] C. Schneider. A streamlined diﬀerence ring theory: Indeﬁnite nested sums, the alternating sign and
the parameterized telescoping problem. In Franz Winkler, Viorel Negru, Tetsuo Ida, Tudor Jebelean,
Dana Petcu, Stephen Watt, and Daniela Zaharie, editors, Symbolic and Numeric Algorithms
for Scientiﬁc Computing (SYNASC), 2014 15th International Symposium, pages 26–33. IEEE
Computer Society, 2014. arXiv:1412.2782v1 [cs.SC].

[56] C. Schneider. Fast algorithms for reﬁned parameterized telescoping in diﬀerence ﬁelds.

In
M. Weimann J. Guitierrez, J. Schicho, editor, Computer Algebra and Polynomials, number 8942
in Lecture Notes in Computer Science (LNCS), pages 157–191. Springer, 2015. arXiv:1307.7887
[cs.SC].

[57] C. Schneider. A diﬀerence ring theory for symbolic summation. J. Symb. Comput., 72:82–127, 2016.

arXiv:1408.2776 [cs.SC].

[58] M. van der Put and M.F. Singer. Galois theory of diﬀerence equations, volume 1666 of Lecture

Notes in Mathematics. Springer-Verlag, Berlin, 1997.

[59] J. A. M. Vermaseren. Harmonic sums, Mellin transforms and integrals. Int. J. Mod. Phys., A14:2037–

2976, 1999.

[60] K. Wegschaider. Computer generated proofs of binomial multi-sum identities. Master’s thesis, RISC,

J. Kepler University, May 1997.

[61] H. Wilf and D. Zeilberger. An algorithmic proof theory for hypergeometric (ordinary and “q”)

multisum/integral identities. Invent. Math., 108:575–633, 1992.

[62] D. Zeilberger. A holonomic systems approach to special functions identities. J. Comput. Appl.

Math., 32:321–368, 1990.

[63] D. Zeilberger. The method of creative telescoping. J. Symbolic Comput., 11:195–204, 1991.

53

