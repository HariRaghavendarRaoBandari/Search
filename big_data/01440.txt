6
1
0
2

 
r
a

M
4

 

 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
0
4
4
1
0

.

3
0
6
1
:
v
i
X
r
a

CUBIC GRAPHS AND RELATED TRIANGULATIONS ON

ORIENTABLE SURFACES1

W. FANG2, M. KANG3, M. MOSSHAMMER3, AND P. SPR ¨USSEL3

Abstract. Let Sg be the orientable surface of genus g. We show that the
number of vertex-labelled cubic multigraphs embeddable on Sg with 2n vertices
2n(2n)!, where γ is an algebraic constant and
is asymptotically cg n
cg is a constant depending only on the genus g. We also derive an analogous
result for simple cubic graphs and weighted cubic multigraphs. Additionally
we prove that a typical cubic multigraph embeddable on Sg, g ≥ 1, has exactly
one non-planar component.

5(g−1)/2−1

γ

1. Introduction

Determining the numbers of maps and graphs embeddable on surfaces have been
one of the main objectives of enumerative combinatorics for the last 50 years. Start-
ing from the enumeration of planar maps by Tutte [30] various types of maps on the
sphere were counted, e.g. planar cubic maps by Gao and Wormald [15]. Further-
more, Tutte’s methods were generalised to enumerate maps on surfaces of higher
genus [1, 2, 5].

An important subclass of maps are triangulations. Brown [8] determined the
number of triangulations of a disc and Tutte enumerated planar triangulations [29].
Triangulations on other surfaces have been considered as well: Gao enumerated 2-
connected triangulations on the projective plane [12] as well as 2-connected and
connected triangulations on surfaces of arbitrary genus [13, 14].

Frieze [23] was the ﬁrst to ask about properties of random planar graphs. Mc-
Diarmid, Steger, and Welsh [24] showed the existence of an exponential growth
constant for the number of labelled planar graphs on n vertices. This growth con-
stant and the asymptotic number were determined by Gim´enez and Noy [16], while
the corresponding results for the higher genus case were derived by Chapuy et al. [9].
Since then various other classes of planar graphs were counted [4, 6, 7, 19, 20, 22, 26].
An interesting subclass of planar graphs are cubic planar graphs, which have been
enumerated by Bodirsky et al. [7]. Cubic planar graphs occur as substructures of
sparse planar graphs and have thus been one of the essential ingredients in the study
of sparse random planar graphs [20]. For surfaces of higher genus, the number of
embeddable cubic graphs has not been studied, and is the main subject of this
paper.

1.1. Main results. The main contributions of this paper are fourfold. We deter-
mine the asymptotic number of cubic multigraphs embeddable on Sg, the orientable

1An extended abstract of this paper has been published in the Proceedings of the European
Conference on Combinatorics, Graph Theory and Applications (EuroComb15), Electronic Notes
in Discrete Mathematics (2015), 603–610.

2LIAFA, UMR CNRS 7089, Universit´e Paris-Diderot, Paris Cedex 13, France.

email:
wfang@liafa.univ-paris-diderot.fr. Partially funded by Agence Nationale de la Recherche,
grant ANR 12-JS02-001-01 ”Cartaplus”.

3Graz University of Technology, Institute of Discrete Mathematics, 8010 Graz, Austria. email:
{kang,mosshammer,spruessel}@math.tugraz.at. Supported by Austrian Science Fund (FWF):
P27290 and W1230 II.

1

surface of genus g. Using the same method we also determine the asymptotic num-
ber of weighted cubic multigraphs and cubic simple graphs embeddable on Sg.
Finally we prove that almost all (multi)graphs from either of the three classes have
exactly one non-planar component.

The ﬁrst main result is about the exact asymptotic expression of the number of

cubic multigraphs embeddable on Sg.

Theorem 1.1. The number mg(n) of vertex-labelled cubic multigraphs embeddable
on Sg with 2n vertices is given by

mg(n) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) dgn5g/2−5/2)−1γ2n

1 (2n)! ,

where γ1 is an algebraic constant independent of the genug g and dg is a constant
depending only on g. The ﬁrst digits of γ1 are 3.973.

Our next main result concerns multigraphs weighted with the so-called compen-
sation factor introduced by Janson et al. [18]. This factor is deﬁned as the number
of ways to orient and order all edges of the multigraph divided by 2mm!, which
is equal to the number of such oriented orderings if all edges were distinguishable.
For example, a double edge results in a factor 1
2 and simple graphs are the only
multigraphs with compensation factor one.

Theorem 1.2. The number wg(n) of vertex-labelled cubic multigraphs embeddable
on Sg with 2n vertices weighted by their compensation factor is given by

wg(n) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) egn5g/2−5/2γ2n

2 (2n)! ,

where γ2 = 793/4

541/2 ≈ 3.606 and eg is a constant depending only on the genus g.

Theorem 1.2 can be used to derive the asymptotic number and structural prop-
erties of graphs embeddable on Sg [21]. Planar cubic multigraphs weighted by the
compensation factor were counted by Kang and  Luczak [20]. The discrepancy to
their exponential growth constant γ ≈ 3.38 is due to incorrect initial conditions, as
pointed out by Noy et al. [25]. While the explicit value of the correct exponential
growth constant γ was not determined in [25], the implicit equations given there
yield the same exponential growth constant γ2 as in Theorem 1.2.

Our methods also allow us to count cubic simple graphs (graphs without loops

and multiedges) embeddable on Sg.

Theorem 1.3. The number sg(n) of vertex-labelled cubic simple graphs embeddable
on Sg with 2n vertices is given by

sg(n) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) fgn5g/2−5/2γ2n

3 (2n)! ,

where γ3 is an algebraic constant independent of the genus g and fg is a constant
depending only on g. The ﬁrst digits of γ3 are 3.133.

The exponential growth constant γ3 coincides with the growth constant calcu-

lated for labelled cubic planar graphs by Bodirsky et al. [7].

The ﬁnal result describes the structure of cubic multigraphs embeddable on Sg.

Theorem 1.4. Let g ≥ 1 and let G be a graph chosen uniformly at random from
the class of vertex-labelled cubic multigraphs, cubic weighted multigraphs, or cubic
simple graphs embeddable on Sg with n vertices, respectively. Then with probability
1 − O(n−2), G has one component that is embeddable on Sg but not on Sg−1 and
all its other components are planar.

2

1.2. Proof techniques. To derive our results we will use topological manipula-
tions of surfaces (described in Section 2.1), constructive decomposition of graphs
along connectivity, and singularity analysis of generating functions.

More precisely, in order to enumerate cubic multigraphs we use constructive
decompositions along connectivity. The basic building blocks in the decomposition
are 3-connected cubic graphs which we will then relate to their corresponding cubic
maps. Note that due to Whitney’s Theorem [31] 3-connected planar graphs have
a unique embedding on the sphere. Therefore this step causes no problem for the
planar case. For surfaces of positive genus, however, embeddings of 3-connected
graphs are not unique. Following an idea from [9], we circumvent this problem
by making use of the concept of the facewidth of a graph and applying results by
Robertson and Vitray [27] which relate 3-connected graphs and maps.

Counting 3-connected cubic maps on Sg is a challenging task. To circumvent
this challenge, we shall use their duals, triangulations. In fact, Gao [12, 13, 14]
enumerated triangulations on Sg with various restrictions on the containment of
loops and multiedges. However, it turns out that the duals of 3-connected cubic
maps on Sg have very speciﬁc constraints that have not been considered by Gao. In
this paper we investigate therefore such triangulations by relating them to simple
triangulations counted by Gao [13] (see Propositions 3.6 and 3.12). We strengthen
Gao’s results (see Propositions 3.6 and 3.7) and derive very precise singular expan-
sions of generating functions. This enables us to apply singularity analysis to the
generating functions of these triangulations, as well as to the generating functions
of all other classes of maps and graphs considered in this paper.

The rest of the paper is organised as follows. In the next section we introduce
some basic notions and notations. In Section 3 we enumerate the triangulations that
occur as duals of 3-connected cubic maps and in Section 4 we prove the main results
(Theorems 1.1 to 1.4) after giving a constructive decomposition along connectivity
for cubic graphs embeddable on an orientable surface. Our strengthening of Gao’s
results and proofs is provided in the appendix.

2. Preliminaries

A graph G is called simple if it does not contain loops or multiedges. If in a
multigraph there are more than two edges connecting the same pair of vertices, we
call each pair of those edges a double edge. Therefore, every multiedge consisting of

n edges between the same two vertices contains(cid:0)n

denote by the base of e the unique vertex e is incident with. Similarly, we say that
e is based at its base. An edge that is neither a loop nor part of a double edge is a
single edge. An edge e of a connected multigraph G is called a bridge if deleting e
disconnects G.

2(cid:1) double edges. If e is a loop, we

A multigraph is called cubic if each vertex has degree three. By Φ we denote
the cubic multigraph with two vertices u, v and three edges between u and v (i.e. a
triple edge). Given a connected cubic multigraph G, let k and l denote the number
of double edges and loops of G, respectively. We deﬁne the weight of G to be

W (G) =( 1

6
2−(k+l)

if G = Φ,
otherwise.

If G is not connected, we deﬁne W (G) as the product of weights of its components.
For cubic multigraphs, this weight coincides with the compensation factor intro-
duced by Janson et al. [18]. Throughout this paper, when we refer to a weighted
cubic multigraph G, the weight in consideration will be W (G).

Throughout this paper let g ≥ 0 be ﬁxed and let Sg be the orientable surface
of genus g with a ﬁxed orientation. An embedding of a multigraph G on Sg is a

3

drawing of G on Sg without crossing edges. An embedding where additionally all
faces are homeomorphic to open discs is called a 2-cell embedding. Multigraphs
that have an embedding are called embeddable on Sg and multigraphs that have a
2-cell embedding are called strongly embeddable. A 2-cell embedding of a strongly
embeddable multigraph is also called map. A triangulation is a map where each
face is bounded by a triangle. These triangles might be degenerate, meaning that
three loops with the same base, a double edge and a loop based at one of the end
vertices of the double edge, or a loop and an edge from the base of the loop to
a vertex of degree one are considered to be triangles as well. If S is the disjoint
union of Sg1 , . . . , Sgn and for each i = 1, . . . , n, Mi is a 2-cell embedding of a graph
Gi on Sgi , then the induced function N : (G1 ∪ · · · ∪ Gn) → S is called a map on
S. Triangulations on S are deﬁned analogously. We denote by V (M ), E(M ), and
F (M ) the set of all vertices, edges, and faces of an embedding M , respectively.

We obtain the dual map of a map by taking one vertex for each face and connect-
ing two of these vertices if the corresponding faces have a common edge on their
boundaries. Note that the dual map has multiedges if two faces of the original
(primal ) map have more than one edge in common. It is well known that the dual
of a map is again a map.

For each vertex v ∈ V (M ) of a map M , the edges and faces incident to v have
a canonical cyclic order e0, f0, e1, f1, . . . , ed−1, fd−1 by the way they are arranged
around v (in counterclockwise direction). Note that faces can appear multiple times
and that a loop based at v will appear twice in this sequence. To avoid ambiguities,
we make the two ends of the loop distinguishable in this sequence (e.g. by using
half-edges or by orienting each loop). A triple (v, ei, e(i+1) mod d) of a vertex and
two consecutive edges in the cyclic sequence is called a corner (at v). We also say
that (v, ei, e(i+1) mod d) is a corner of the face fi. When we enumerate maps, we
always work with maps with one distinguished corner, called the root of the map.
If (v, ei, ei+1) is the root corner, we will call v the root vertex, ei the root edge, and
fi the root face.

2.1. Topological operations: surgeries. When dealing with maps on Sg we
will perform operations on the surfaces that are commonly known as cutting and
glueing. In the course of these operations we will encounter surfaces with holes. A
surface with k holes is a surface Sg from which the disjoint interiors D1, . . . , Dk of
k closed discs have been deleted. Each Di is called a hole. Let S be the disjoint
union of ﬁnitely many orientable surfaces, at least one of them with holes, and
suppose that X and Y are homeomorphic subsets of the boundary of S. By glueing
S along X and Y we mean the operation of identifying every point x ∈ X with
f (x) for any ﬁxed homeomorphism f : X → Y . The identiﬁcation of X and Y
induces a surjection σ from S onto the resulting space ˜S. We write ˜X for the
subset σ(X) = σ(Y ) of ˜S.

We will glue along subsets in two particular situations: when X and Y are

(i) disjoint boundaries of holes of S or
(ii) sub-arcs of the boundary of the same hole that meet precisely in their

endpoints.

For (ii), we will additionally assume that the homeomorphism f : X → Y induces
the identity on X ∩ Y . In either case, the space ˜S resulting from glueing along X
and Y is again the disjoint union of ﬁnitely many orientable surfaces with holes,
with the number of components being either the same or one less than that for
S. The subset ˜X of ˜S is a circle in Case (i) and homeomorphic to the closed unit
interval in Case (ii). If S has k holes, then ˜S has k − 2 holes in Case (i) and k − 1
holes in Case (ii). A special case of (i) is when one of the components of S is a disc

4

(i.e. a sphere with one hole) and Y is its boundary. In this case, we say that we
close the hole bounded by X by inserting a disc.

If in addition we are given a map M on S, then we will glue along X and Y
only if either both are contained in a face or both are unions of the same number of
vertices and the same number of edges of M . We also assume the homeomorphism
f : X → Y maps vertices to vertices and edges to edges. Under these conditions,
we obtain a map ˜M on ˜S. The subset ˜X of ˜S is then either a subgraph of ˜M or
a subset of a face of ˜M . Observe that the surjection σ : S → ˜S induces a bijection
between the sets of corners of M and of corners of ˜M . We will refer to this bijection
by saying that every corner of M corresponds to a corner of ˜M .

If ˜S is obtained from S by glueing along X and Y, we also say that S is obtained
from ˜S by cutting along ˜X. The operation of cutting along a circle or interval is well
deﬁned in the sense that if ˜S and ˜X are given, then S, X, and Y are unique up to
homeomorphism. If S has more components than ˜S, we call ˜X separating. Cutting
along a separating circle on Sg and closing the resulting holes by inserting discs will
yield two surfaces Sg1 , Sg2 with g1 + g2 = g. Cutting along a non-separating circle
and closing the holes by inserting discs reduces the genus by one.

A combination of cutting and glueing surfaces along some subsets of their bound-
aries is called a surgery. Again, if a map ˜M results from performing surgeries on
a map M , then every corner of ˜M corresponds to a corner of M . The following
result on embeddability can be obtained by performing simple surgeries.

Proposition 2.1. Let G be a multigraph.

(i) If M is an embedding of G on Sg and f is a face of M that is not a disc,
then f contains a circle C such that cutting along C results in one or two
surfaces such that either two of them contain a vertex of M or one of them
contains all vertices and edges of M and has genus less than g.

(ii) If G is connected and g is minimal such that G is embeddable on Sg, then
In particular, G is

every embedding of G on Sg is a 2-cell embedding.
strongly embeddable on Sg.

(iii) G is embeddable on Sg if and only if each connected component Ci of G is

strongly embeddable on a surface Sgi so that Pi gi ≤ g.

Proof. For (i), let Γ be the union of all curves in f that run along the boundary
at a small constant distance ε > 0. Suppose ﬁrst that Γ has only one component.
Then this component is a circle C. Cutting along C results in one surface S1 that
contains all vertices and edges of M and one component S2 that contains all points
of f with distance greater than ε to the boundary. Note that S2 cannot be a sphere
with one hole as otherwise f would have been a disc. Thus, the genus of S1 is
smaller than g and C is the desired circle.

Now suppose that Γ has more than one component. Each component is a circle
and cutting along all these circles results in one surface S that contains all points
of f with distance greater than ε to the boundary and surfaces S1, . . . , Sk which
all contain vertices from M . If k ≥ 2, then there is a circle C in f that separates
the vertices in at least two of these components. Otherwise, as S has at least two
holes, let C be one of the components of Γ; this is a non-contractible circle on Sg
that is not separating. Thus, cutting along C reduces the genus of the surface.

Claim (ii) follows immediately from (i). Finally, (iii) follows by recursively cut-
(cid:3)

ting along circles provided by (i).

2.2. Generating functions and singularity analysis. We will use generating
functions to enumerate the various classes of maps, graphs and multigraphs we
consider. Unless stated otherwise the formal variables x and y will always mark
vertices and edges, respectively. Generating functions for classes of maps will be

5

ordinary unless stated otherwise. Generating functions for multigraphs will be
exponential in x, because we consider vertex-labelled multigraphs. If A is a class
of maps, we write A(m) of A for the subclass containing all maps with exactly m

n! zn we write

[zn]G(z) := gn
n! .

class of multigraphs, we write B(n) for the subclass of B containing all multigraphs

edges. The generating function Pm |A(m)|ym will be denoted by A(y). If B is a
with exactly n vertices. The generating function Pn |B(n)|n! xn will be denoted by
B(x). For an ordinary generating function F (z) = Pn fnzn we use the notation
[zn]F (z) := fn. For an exponential generating function G(z) = P gn

If two generating functions F (z), G(z) satisfy 0 ≤ [zn]F (z) ≤ [zn]G(z) for all
n, we say that F is coeﬃcient-wise smaller than G, denoted by F (cid:22) G. The
singularities of F (z) with the smallest modulus are called dominant singularities
of F (z). Because every generating function we consider in this paper always has
non-negative coeﬃcients [zn]F (z), there is a dominant singularity located on the
positive real axis by Pringsheim’s Theorem [28, pp. 214]. We denote this dominant
singularity by ρF . If an arbitrary function F has a unique singularity with smallest
modulus and this singularity lies on the positive real axis, then we also denote it
by ρF . The function F : C → C converges on the open disc of radius ρF and thus
corresponds to a holomorphic function on this disc. In many cases, this function can
be holomorphically extended to a larger domain. Given ρ, R ∈ R with 0 < ρ < R
and θ ∈ (0, π/2),

∆(ρ, R, θ) := {z ∈ C | |z| < R ∧ | arg(z − ρ)| > θ}

is called a ∆-domain. Here, arg(z) denotes the argument of a complex number:
arg(0) := 0 and arg(reit) := t for r > 0 and t ∈ (−π/2, π/2]. We say that F is
∆-analytic if it is holomorphically extendable to some ∆-domain ∆(ρF , R, θ).

A function F is subdominant to a function G if either ρF > ρG or ρF = ρG
F (z)
G(z) = 0. In the latter case, if both F and G are ∆-analytic, then
and limz→ρG
the above limit is required to be zero for z from some ﬁxed ∆-domain to which
both F and G are holomorphically extendable. If F is subdominant to G, we also
write F (z) = o(G(z)). Analogously we write F (z) = O(G(z)) if either ρF > ρG or
ρF = ρG and lim supz→ρG
G(z) = c(cid:0)1 − ρ−1

with α ∈ R \ Z≤0, c ∈ R \ {0} or G(z) = c log(cid:0)1 − ρ−1

Given a function F (z) with a dominant singularity ρF , we say that a function

the dominant term of F if there is a decomposition

F z(cid:1)−α

F z(cid:1) is

|F (z)|
|G(z)|

< ∞.

F (z) = P (z) + G(z) + o(G(z)),

where P (z) is a polynomial. The dominant term, if it exists, is uniquely deﬁned
and ∆-analytic. If G(z) = c(1 − ρ−1
F z)−α, the exponent −α is called the dominant

exponent of F . If G(z) = c log(cid:0)1 − ρ−1

0.

F z(cid:1), we say that F has dominant exponent

The number of edges in cubic multigraphs and triangulations is always a multiple
of three. In terms of generating functions, this is reﬂected by the existence of three
diﬀerent dominant singularities, all of which only diﬀer by a third root of unity.
The corresponding dominant terms will also be the same up to a third root of unity.
Analogously, the number of vertices in cubic multigraphs is always even, resulting
in two dominant singularities ρF and −ρF . Again, the dominant terms only diﬀer
by a factor of −1. In either case, the terms for the coeﬃcients coming from the
diﬀerent dominant singularities will also only diﬀer by the corresponding root of
unity. Therefore, we will state our results only for the singularity ρF . With a slight
abuse of notation, we will also refer to ρF as the dominant singularity.

6

Singularity analysis allows us to derive an asymptotic expression for the coeﬃ-
cients of a generating function F (z) with help of the dominant singularity and the
dominant term of F (z). We state the well-known ‘transfer theorem’ for the speciﬁc
cases we will need.

Theorem 2.2 ([10]). Let F (z) be a ∆-analytic generating function.

(i) If

F (z) = P (z) + c(cid:0)1 − ρ−1

F z(cid:1)−α

+ O(cid:16)(cid:0)1 − ρ−1

F z(cid:1)1/4−α(cid:17)

with a polynomial P (z) and constants c 6= 0, α ∈ R \ Z≤0, then

[zn]F (z) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) c

Γ(α)

nα−1ρ−n
F .

0 zα−1e−z dz is the gamma function.

Here, Γ(α) :=R ∞

(ii) If

then

F (z) = P (z) + c · log(cid:0)1 − ρ−1

F z(cid:1) + O(cid:16)(cid:0)1 − ρ−1
[zn]F (z) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) (−c)n−1ρ−n

F .

F z(cid:1)1/4(cid:17) ,

If we are counting rooted maps or multigraphs, the roots will be counted in the
generating function unless stated otherwise. We will often mark vertices or edges of
multigraphs or maps. This corresponds to applying the diﬀerential operator z d
dz to
the generating functions (with z = x if vertices are marked and z = y if edges are
marked). To simplify notation we write δz for z d
z for recursively applying n
times the operator z d
dz , which corresponds to marking n vertices or edges, allowing
multiple marks on vertices or edges. Thus we will have to compare dominant terms
of functions before and after diﬀerentiation and (for a slightly diﬀerent reason) of
functions before and after integration.

dz and δn

Lemma 2.3. Let F (z) be a ∆-analytic generating function with the dominant term
Fd(z). Suppose there exists β ∈ R with

F (z) = P (z) + Fd(z) + O(cid:16)(cid:0)1 − ρ−1

F z(cid:1)−β(cid:17) ,

= o(Fd(z)). Then

where P (z) is a polynomial and (cid:0)1 − ρ−1

(i) we have

F z(cid:1)−β

F ′(z) = P ′(z) + F ′d(z) + O(cid:16)(cid:0)1 − ρ−1

F z(cid:1)−β−1(cid:17) .

(ii) If in addition Fd(z) = c(cid:0)1 − ρ−1

there exists a primitive Q(z) of P (z) such that

F z(cid:1)−α

, then for any primitive G(z) of F (z)

G(z) = Q(z) + Gd(z) + O(R(z))

with

and

F z(cid:1)−α+1
Gd(z) =( cρF
α−1(cid:0)1 − ρ−1
−cρF log(cid:0)1 − ρ−1
F z(cid:1)
F z(cid:1)−β+1
R(z) =((cid:0)1 − ρ−1
log(cid:0)1 − ρ−1
F z(cid:1)

7

if α 6= 1,
if α = 1

if β 6= 1,
if β = 1.

γ2

z

γ1

θ

ρF − |z − ρF |

ρF − ε

ρF

Figure 1. The integration curve γ1 + γ2. The direction of γ1
depends on whether |z − ρF | is larger or smaller than ε.

Proof. Let F (z) = P (z) + Fd(z) + S(z), where S(z) = O(cid:16)(cid:0)1 − ρ−1
to prove (i), we need to show that S′(z) = O(cid:16)(cid:0)1 − ρ−1

F z(cid:1)−β(cid:17). In order
F z(cid:1)−β−1(cid:17). Let ∆(ρF , R, θ)

be a ∆-domain to which F is holomorphically extendable and on which

lim sup
z→ρF

< ∞

|S(z)|

(cid:12)(cid:12)(cid:12)(cid:0)1 − ρ−1

F z(cid:1)−β(cid:12)(cid:12)(cid:12)

holds. Fix a positive radius r < R − ρF and denote the intersection of ∆(ρF , R, θ)
with the disc of radius r around ρF by U (r, θ). Let cr be such that |S(z)| ≤
for every z ∈ U (r, θ). For some ﬁxed θ′ ∈ (θ, π/2), consider
z ∈ U (r/2, θ′). There is a constant a ∈ (0, 1) such that for every such z, the closed
disc of radius a|ρF − z| around z is contained in U (r, θ). If M denotes the maximal
value of |S(z)| on the boundary of this disc, then Cauchy’s integral formula yields

cr(cid:12)(cid:12)(cid:12)(cid:0)1 − ρ−1

F z(cid:1)−β(cid:12)(cid:12)(cid:12)

|S′(z)| ≤

M

a|ρF − z|

crρ−1
F

≤

a min((1 − a)β, (1 + a)β)(cid:12)(cid:12)(cid:12)(cid:0)1 − ρ−1
F z(cid:1)−β−1(cid:17) on the domain ∆(ρF , R, θ′).

F z(cid:1)−β−1(cid:12)(cid:12)(cid:12)

and thus S′(z) = O(cid:16)(cid:0)1 − ρ−1

In order to prove (ii), we need to show that S(z) has a primitive T (z) with
T (z) = O(R(z)). Let r, cr, and U (r, θ) be as before. For ε ∈ (0, r), let Tε(z) be the
primitive of S(z) with Tε(ρF − ε) = 0. Then for every z ∈ U (r, θ) we have

Tε(z) =Zγ

S(z) dz

for any curve γ from ρF − ε to z in U (r, θ).

We choose γ = γ1 + γ2, where γ1 is a line segment from ρF − ε to ρF − |ρF − z|
and γ2 is a circular arc in U (r, θ) around ρF from ρF − |ρF − z| to z (see Figure 1).
If M2 denotes the maximum of |S(z)| on the trace of γ2, then

Zγ2

(cid:12)(cid:12)(cid:12)(cid:12)

S(z) dz(cid:12)(cid:12)(cid:12)(cid:12)

≤ π|ρF − z|M2 ≤ πcrρF (cid:12)(cid:12)1 − ρ−1
F z(cid:12)(cid:12)

8

−β+1

.

For the integral along γ1, we have to distinguish between β 6= 1 and β = 1. For
β 6= 1, we have

Zγ1

(cid:12)(cid:12)(cid:12)(cid:12)

S(z) dz(cid:12)(cid:12)(cid:12)(cid:12)

0

dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(1)

ρF

ρF

+ t

ρF

|ρF − z| − ε

(cid:19)−β

ρF − ε + t(ε − |ρF − z|)

Z 1
=(cid:12)(cid:12)(cid:12)(cid:12)
(ε − |ρF − z|)S(cid:0)ρF − ε + t(ε − |ρF − z|)(cid:1) dt(cid:12)(cid:12)(cid:12)(cid:12)
≤(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)ε − |ρF − z|(cid:12)(cid:12)Z 1
0 (cid:12)(cid:12)S(cid:0)ρF − ε + t(ε − |ρF − z|)(cid:1)(cid:12)(cid:12) dt(cid:12)(cid:12)(cid:12)(cid:12)
≤(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:19)−β
cr(cid:12)(cid:12)ε − |ρF − z|(cid:12)(cid:12)Z 1
0 (cid:18)1 −
dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
cr(cid:12)(cid:12)ε − |ρF − z|(cid:12)(cid:12)Z 1
0 (cid:18) ε
|β − 1|(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)1 − ρ−1
F z(cid:12)(cid:12)
|β − 1|(cid:12)(cid:12)1 − ρ−1
F z(cid:12)(cid:12)
S(z) dz(cid:12)(cid:12)(cid:12)(cid:12)
|Tε(z)| ≤(cid:18)πcrρF +

F z(cid:1)(cid:12)(cid:12) + crρF (cid:12)(cid:12)log(cid:0)ρ−1
F ε(cid:1)(cid:12)(cid:12) .

≤ crρF (cid:12)(cid:12)log(cid:0)1 − ρ−1

ρF(cid:19)−β+1(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
−(cid:18) ε

crρβ
F
|β − 1|

crρF

|β − 1|(cid:19) |R(z)| +

crρβ
F
|β − 1|

crρF

crρF

−β+1

+

ε−β+1.

ε−β+1.

=

≤

Zγ1

(cid:12)(cid:12)(cid:12)(cid:12)

−β+1

For β = −1 we analogously obtain

By combing the two integrals, we obtain for β 6= 1 and any ﬁxed ε

For β > 1, this implies that Tε(z) = O(R(z)), since crρβ
ε−β+1 is a constant, but
|β−1|
|R(z)| tends to inﬁnity as z tends to ρF . For β = 1, the integral along γ2 is bounded
by a constant and we again obtain Tε(z) = O(R(z)).

F

Finally, suppose that β < 1. Then (1) implies that, given δ > 0, we can choose

ε0 > 0 and z ∈ U (r, θ) close enough to ρF so that

|Tε(z)| <

δ
2

for every ε with 0 < ε < ε0 and thus

|Tε(z) − Tε′ (z)| < δ

(2)
for every ε, ε′ ∈ (0, ε0). As both Tε and Tε′ are primitives of S, they only diﬀer by a
constant and thus (2) holds for every z ∈ U (r, θ). Therefore the sequence (T1/n)n∈N
converges uniformly to a function T0 which is also a primitive of S. Letting ε tend
to zero in (1), we see that

|T0(z)| ≤(cid:18)πcrρF +

crρF

|β − 1|(cid:19) |R(z)|

for every z ∈ U (r, θ) and thus T0(z) = O(R(z)).

We have thus found a primitive T0 of S that satisﬁes T0(z) = O(R(z)). We
conclude the proof of (ii) by choosing Q as the unique primitive of P with Q(0) =
G(0) − Gd(0) − T0(0).
(cid:3)

Theorem 2.2 and Lemma 2.3 are very helpful when the generating functions in
question are ∆-analytic. However, for many of our generating functions we will not
be able to guarantee ∆-analyticity. In order to utilise the results of this section
also for generating functions that are not necessarily ∆-analytic, we introduce the

9

following concept and notation. Given a generating function F (z) and ∆-analytic
functions G(z), H(z), we say that F (z) is congruent to G(z) + O(H(z)) and write

F (z) ∼= G(z) + O(H(z))

if there exist ∆-analytic functions F +(z), F −(z) and polynomials P +(z), P −(z)
such that

• F − (cid:22) F (cid:22) F +;
• F +(z) = P +(z) + G(z) + O(H(z)); and
• F −(z) = P −(z) + G(z) + O(H(z)).

With this, we are able to apply the transfer theorem even if F itself is not ∆-
analytic. The following lemma is an immediate consequence of Theorem 2.2 and
the fact that F − (cid:22) F (cid:22) F +.
Lemma 2.4. If F (z) ∼= G(z) + O(H(z)) and G(z) + O(H(z)) is of one of the types
described in Theorem 2.2(i) or (ii), then

[xn]F (z) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) [zn]F +(z) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) [zn]F −(z).

In this paper we will often encounter sums, products, diﬀerentials and integrals
of generating functions. The following lemma states that these operations are com-
patible with the notion of congruence. We will frequently use this lemma without
explicitly mentioning it.

Lemma 2.5. Let G1, G2, H1, H2 be ∆-analytic functions with only ﬁnitely many
negative coeﬃcients. Let F1, F2 be generating functions such that

F1(z) ∼= G1(z) + O(H1(z))

and

F2(z) ∼= G2(z) + O(H2(z))

and let F (z) be a generating function with the dominant term Fd(z) such that

F (z) ∼= Fd(z) + O(cid:16)(cid:0)1 − ρ−1

F z(cid:1)−β(cid:17) ,

where (cid:0)1 − ρ−1

= o(Fd(z)). Then the following holds.
F1(z) ± F2(z) ∼= G1(z) ± G2(z) + O(H1(z)) + O(H2(z)),

F z(cid:1)−β

F1(z)F2(z) ∼= G1(z)G2(z) + O(G1(z)H2(z) + H1(z)G2(z) + H1(z)H2(z)),

F ′(z) ∼= F ′d(z) + O(cid:16)(cid:0)1 − ρ−1
F z(cid:1)−α

Furthermore, if Fd(z) = c(cid:0)1 − ρ−1

have

˜F (z) ∼= Gd(z) + O (R(z)) ,

F z(cid:1)−β−1(cid:17) .

, then for any primitive ˜F (z) of F (z) we

where Gd and R are as in Lemma 2.3(ii).

Proof. The ﬁrst congruence follows immediately from
and F −1 − F +

F −1 + F −2 (cid:22) F1 + F2 (cid:22) F +
For the product F1(z) · F2(z), we may assume that F −1 and F −2 have nonnegative
coeﬃcients, since G1 and G2 have only ﬁnitely many negative coeﬃcients. Hence

2 (cid:22) F1 − F2 (cid:22) F +

1 − F −2 .

1 + F +
2

F −1 · F −2 (cid:22) F1 · F2 (cid:22) F +

1 · F +
2

and the second congruence follows.

The last two congruences follow from Lemma 2.3 and the fact that

(F −)′ (cid:22) F ′ (cid:22) (F +)′

and

˜F − (cid:22) ˜F (cid:22) ˜F +,

where ˜F −, ˜F + are primitives of F −, F +, respectively, with ˜F −(0) ≤ ˜F (0) ≤ ˜F +(0).
(cid:3)

10

2.3. Maps with large facewidth. An essential circle on Sg is a circle that is
not contractible to a point on Sg. Let M be an embedding of a multigraph on Sg.
An essential cycle of M is a cycle of M that is an essential circle on the surface.
The facewidth fw(M ) of M is the minimal number of intersections of M with an
essential circle on Sg. The edgewidth ew(M ) of M is deﬁned as the minimal number
of edges of an essential cycle of M . If g = 0, there are neither essential circles nor
essential cycles and we use the convention fw(M ) = ew(M ) = ∞. Proposition 2.1
implies that if M is connected and not a 2-cell embedding, then fw(M ) = 0. The
facewidth fwg(G) of a multigraph G that is embeddable on Sg is deﬁned as the
maximal facewidth of all its embeddings on Sg.
If we count multigraphs with
restrictions to their facewidth, we will indicate the restriction by a superscript to
the corresponding generating function, e.g. Gfwg≥2(x) for the generating function
of all multigraphs with facewidth at least two. If the genus is clear from the context
we will omit it and write fw(G).

Having large facewidth proves to be a very helpful property. It will allow us to
derive a constructive decomposition along connectivity as well as the existence of a
unique embedding for 3-connected multigraphs. The following lemma was applied
in a similar way in [9].

Lemma 2.6. [27] Let g > 0 and let M be an embedding of a connected multigraph
G on Sg.

(i) M has facewidth fw(M ) = k ≥ 2 if and only if M has a unique 2-connected
component embedded on Sg with facewidth k and all other 2-connected
components of M are planar.

(ii) If G is 2-connected, M has facewidth fw(M ) = k ≥ 3 if and only if M has
a unique 3-connected component embedded on Sg with facewidth k and all
other 3-connected components of M are planar.

(iii) Let M1, M2 be embeddings of a 3-connected multigraph on Sg and suppose
that fw(M1) ≥ 2g + 3. Then there is a homeomorphism of Sg that maps
M1 to M2.

Lemma 2.6(iii) is a generalisation of Whitney’s theorem that all 3-connected pla-
nar multigraphs have a unique embedding up to orientation on the sphere. Because
we will need Lemma 2.6 for multigraphs rather than for embeddings, we will use
the following easy corollary.

Corollary 2.7. Let g > 0 and let G be a non-planar connected multigraph strongly
embeddable on Sg.

(i) If fwg(G) ≥ 2, then G has a unique 2-connected non-planar component
strongly embeddable on Sg with facewidth fwg(G) and all other 2-connected
components are planar.

(ii) If G is 2-connected and fwg(G) ≥ 3, then G has a unique 3-connected
non-planar component strongly embeddable on Sg with facewidth fwg(G)
and all other 3-connected components are planar.

(iii) If G is 3-connected and fwg(G) ≥ 2g + 3, then G has a unique 2-cell

embedding on Sg up to orientation.

Proof. By Lemma 2.6(i), for any ﬁxed embedding of G all but one components
are planar. As G itself is not planar, that exceptional component has to be non-
planar. As the component structure is the same for all embeddings, the non-
planar component I is independent of the embedding. Therefore, I is the unique
component described in (i). Part (ii) is proved analogously and (iii) is a direct
consequence of Lemma 2.6(iii).
(cid:3)

11

3. Maps and triangulations

The goal of this section is to enumerate cubic 3-connected maps on Sg. The
dual of these maps are triangulations, which are characterised in the following
proposition.

Proposition 3.1. Let M be a 2-cell embedding of a cubic multigraph on Sg and let
M∗ be its dual map. Then M is 3-connected if and only if M∗ is a triangulation
with at least 6 edges and without separating loops, separating double edges, and
separating pairs of loops.

Proof. For cubic maps with at least four vertices (and thus at least six edges),
3-connectivity and 3-edge-connectivity coincide. This can be seen by a simple
case analysis. We thus use 3-edge-connectivity hereafter. Since a vertex in M
corresponds to a face in M∗, deleting edges in the primal M has the same eﬀect as
cutting the surface along the dual edges of M∗, and a set of edges is a separator in
M if and only if cutting along the dual edges in M∗ separates the surface. Thus
a bridge in M corresponds to a separating loop in M∗. A 2-edge-separator in M
corresponds either to a separating double edge or a pair of loops in M∗ which
together separate the surface.
(cid:3)

3.1. Relations between triangulations. In order to enumerate the triangula-
tions described in Proposition 3.1, we will relate them to simple triangulations
that have been studied by Gao [13]. To this end we will use topological surgeries
that eliminate loops and double edges. The most frequently used surgery is the
following.

Deﬁnition 3.2. Let {e1, e2} be a double edge in a triangulation T on Sg. By
zipping {e1, e2} we mean the operation of cutting the surface along {e1, e2} and
eliminating the holes by identifying the two edges on the boundaries of the holes.
The two edges that result from this identiﬁcation are called zipped edges. The
resulting triangulation ˜T is rooted at the corner ˜c corresponding to the root corner
c of T . If {e1, e2} separates Sg, one of the two components of ˜T does not contain
˜c; we root this component C such that the zipped edge in C is the root edge. Note
that there are two choices for the root of C.

Note that zipping a double edge leaves the number of edges unchanged.
We will distinguish three kinds of double edges. We call a double edge planar
if zipping it results in two maps, one of which is planar and has no holes. Note
that an alternative way of deﬁning planar double edges would be to say that by
cutting along it we obtain two surfaces, one of which is a disc. We call a double
edge non-planar separating if zipping it results in two maps none of which is planar
and we call it non-separating if zipping it results in only one map.

Let Mg be the class of triangulations on Sg without separating loops, separating
double edges, and separating pairs of loops and let Mg(y) be its ordinary gener-
ating function. Note that these triangulations are either the duals of 3-connected
cubic maps on Sg by Proposition 3.1 or a triangulation with exactly three edges.
To obtain the asymptotic number of triangulations in Mg, we need some other
types of triangulations. Let Ng be the class of triangulations on Sg without loops
and separating double edges. Let Rg be the class of triangulations on Sg without
loops and planar double edges. Let ˆSg be the class of triangulations on Sg with-
out loops. Let Sg be class of simple triangulations on Sg (i.e. without loops and
double edges). Let Ng(y), Rg(y), ˆSg(y), and Sg(y) be their generating functions,
respectively. Table 1 summarises what kinds of edges are allowed for these classes
of triangulations.

12

loops

Some cases

No
No
No
No

Mg
Ng
Rg
ˆSg
Sg

non-separating planar non-planar separating

double edges

Yes
Yes
Yes
Yes
No

No
No
No
Yes
No

No
No
Yes
Yes
No

Table 1. Loops and double edges in diﬀerent classes of triangulations

Note that Sg ⊆ Ng ⊆ Rg ⊆ ˆSg and Ng ⊆ Mg.
We will relate the triangulations in Mg, Ng, Rg, ˆSg, and Sg by performing
surgeries. The most frequently used surgery will be to zip a separating double
edge. In order to relate the maps before and after the surgery, we need the following
lemma.

Lemma 3.3. Let Xg(m) be the class of all rooted triangulations on Sg with m
edges and a marked double edge {e1, e2} and let Y (i)
g (m) be the class of all rooted
triangulations on Sg with m edges, i of which are marked.

(i) Let X s

g (m) be the subclass of Xg(m) where {e1, e2} is a non-planar sep-
arating double edge. Then zipping {e1, e2} yields a 2-to-2 correspondence
from X s

g (m) to

[(cid:16)Y (1)

g1 (m1) × Y (0)

g2 (m2)(cid:17) ,

where the union is taken over all m1, m2, g1, g2 ∈ N such that m1 +m2 = m
and g1 + g2 = g.

(ii) Let X pl

g (m) be the subclass of Xg(m) where {e1, e2} is a planar double edge.

Then zipping {e1, e2} yields a 2-to-2 correspondence from X pl

g (m) to

[(cid:16)Y (1)

g (m1) × Y (0)

0 (m2) ∪ Y (1)

0 (m1) × Y (0)

g (m2)(cid:17) ,

where the union is taken over all m1, m2 ∈ N such that m1 + m2 = m.

Proof. In Case (i) the surface is disconnected into Sg1 and Sg2 with g1 + g2 = g.
Assume without loss of generality that the root face of the original triangulation is
on Sg1 . Then we mark the identiﬁed edge on Sg1 . For the root on Sg2 we have two
choices. Going back we have two possibilities of glueing the surface back together,
hence obtaining the 2-to-2 correspondence.

In Case (ii), the only diﬀerence to Case (i) is that g1 = 0 and g2 = g and that
(cid:3)

the root face might be in either of the two maps.

We ﬁnish this section by a last topological statement about planar double edges.

Deﬁnition 3.4. Let T be a triangulation on Sg (possibly with holes), g > 0, and
let d = {e1, e2} be a planar double edge. If c 6= d is a face, edge, or double edge, we
write c < d if the triangulation of the disc obtained by cutting along d contains c.

Lemma 3.5. Let T be a triangulation on Sg, g > 0, and let D be the set of planar
double edges in T . Then the relation < deﬁned in Deﬁnition 3.4 is a partial order
on D.

Proof. Let d1, d2 ∈ D. Let P1 and P2 be the triangulations of the discs obtained
by cutting along d1 and d2, respectively. Then d1 < d2 if and only if d1 ⊆ P2 by
deﬁnition and this holds if and only if P1 ⊆ P2, since T is a triangulation of Sg

13

and g > 0. As the subset relation on triangulations is a partial ordering, so is the
relation deﬁned in Deﬁnition 3.4.
(cid:3)

3.2. Counting triangulations. In this section, we determine the dominant terms
of the generating functions of various types of triangulations using singularity analy-
sis and topological surgeries, e.g. zipping double edges (Deﬁnition 3.2). The starting
point for this will be ˆSg(y) and Sg(y), which were examined by Gao [13, 14] and
(in the planar case) by Tutte [29]. However, the results obtained by Gao are not
strong enough in order to apply the theory of singularity analysis (developed in
Section 2.2). We obtain more reﬁned versions of their results.

Proposition 3.6. The dominant singularity of Sg(y) is given by ρS = 3
generating function S0(y) is ∆-analytic and satisﬁes

28/3 . The

S0(y) =

For g ≥ 1 we have

3

9

1
8

−

16(cid:0)1 − ρ−1
Sg(y) ∼= cg(cid:0)1 − ρ−1

S y(cid:1)3/2

25/2 (cid:0)1 − ρ−1

S y(cid:1) +
S y(cid:1)−5g/2+3/2(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1

+ O(cid:16)(cid:0)1 − ρ−1
S y(cid:1)1/4(cid:17)(cid:17) ,

S y(cid:1)2(cid:17) .

where cg is a constant depending only on g. Furthermore, the asymptotic number
of simple triangulations on Sg with m edges is given by

sg(m) =(cid:16)1 + O(cid:16)m−1/4(cid:17)(cid:17)

where c0 = 3

25/2 .

cg

Γ(5(g − 1)/2)

m5g/2−5/2ρ−m
S ,

Proposition 3.7. The dominant singularity of ˆSg(y) is given by ρ ˆS = 21/3
generating function ˆS0(y) is ∆-analytic and satisﬁes

3 . The

(3)

(4)

(5)

(6)

ˆS0(y) =

1
8

−

For g ≥ 1 we have

9

8(cid:16)1 − ρ−1

ˆS

ˆSg(y) ∼= ˆcg(cid:16)1 − ρ−1

ˆS

ˆS

y(cid:17)3/2

y(cid:17) + 3(cid:16)1 − ρ−1
y(cid:17)−5g/2+3/2(cid:18)1 + O(cid:18)(cid:16)1 − ρ−1

+ O(cid:18)(cid:16)1 − ρ−1
y(cid:17)2(cid:19) .
y(cid:17)1/4(cid:19)(cid:19) ,

ˆS

ˆS

where ˆcg is a constant depending only on g. Furthermore, the asymptotic number
of loop-less triangulations on Sg with m edges is given by

ˆsg(m) =(cid:16)1 + O(cid:16)m−1/4(cid:17)(cid:17)

where ˆc0 = 3.

ˆcg

Γ(5g/2 − 5/2))

m5g/2−5/2ρ−m

ˆS

,

For the proofs of Propositions 3.6 and 3.7 see Appendix A. The exact values of
cg and ˆcg are not necessary for our purpose; the interested reader can ﬁnd them in
[14]. The only fact about the coeﬃcients we will use in this paper is the relation

ˆcg = 25(1−g)/2cg.

(7)

Our ﬁrst step towards obtaining an asymptotic formula for Mg(y) is to relate
Rg(y) and ˆSg(y) by recursively zipping planar double edges. The resulting relation
will show that the dominant singularities of Rg(y) and Sg(y) are the same.

Proposition 3.8. The generating functions Rg(y) and Sg(y) have the same dom-
inant singularity ρS, R0(y) = S0(y), and

Rg(y) − Sg(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) ,

14

g ≥ 1.

Proof. For g = 0, all double edges are planar and hence R0 = S0. We may thus
assume that g > 0. For a triangulation T ∈ ˆSg, let Dmax be the set of maximal
planar double edges in the partial order deﬁned in Deﬁnition 3.4. For any two
double edges d1, d2 ∈ Dmax, their planar sides meet at most at the end vertices of
d1, d2, since otherwise either d1 > d2, d2 > d1, or there would be a double edge d
consisting of one edge from d1 and one edge from d2 such that d > d1 and d > d2.
We can thus zip all double edges in Dmax in an arbitrary order. We obtain a
triangulation R on Sg without planar double edges (thus in Rg) and |Dmax| planar
triangulations without loops but possibly with double edges (thus in ˆS0). To obtain
an equation between ˆSg and the triangulations resulting from the surgery, we have
to distinguish two cases: the original root face is in one of the planar triangulations
or not.

By the arguments above there can be at most one element in Dmax that contains
the root face in its planar part. By Deﬁnition 3.2, for this double edge d0, the
corresponding planar triangulation is rooted at the corner corresponding to the
root of T and the zipped double edge is marked. All other planar triangulations
are rooted at their zipped edge and have no additional marked edges. R is rooted
at the zipped edge d0 and all other zipped edges are marked. On the other hand,
if none of the double edges in Dmax contains the root face in its planar part, R is
rooted at the root of T and all zipped edges are marked.

In either case we end up with planar triangulations and a triangulation R ∈ Rg
where any subset of the edges is marked. By Lemma 3.3(i) this construction yields
a bijection (or more precisely a k-to-k correspondence, with k depending on the
number of zipped edges) between these collections of triangulations and ˆSg.

As any number of edges in R can be marked, we can directly replace any set of
edges by planar triangulations (more precisely, cut R along an edge and the planar
triangulation along its root edge and glue them along their boundaries). The root
can either be replaced in the same way as a non-root edge (if the root remains in
R), or by a planar triangulation with one marked edge, counted by δy ˆS0(y). Thus
we obtain

ˆSg(y) =(cid:16)1 + ˆS0(y) + δy ˆS0(y)(cid:17) Rg(y(1 + ˆS0(y)))

1 + ˆS0(y)

.

Here, Rg(y(1 + ˆS0(y))) corresponds to the substitution of edges, the denominator
1 + ˆS0(y) compensates for not allowing the root to be substituted in the same way,

and the factor (cid:16)1 + ˆS0(y) + δy ˆS0(y)(cid:17) corresponds to the substitution of the root.

This formula can be rearranged as

Rg(y(1 + ˆS0(y))) = ˆSg(y)

1 + ˆS0(y)

1 + ˆS0(y) + δy ˆS0(y)

.

(8)

By Proposition 3.7, the dominant singularity of ˆSg(y) occurs at ρ ˆS for all g.
Again by Proposition 3.7, ˆS0(y) and δy ˆS0(y) are ﬁnite and nonnegative at the
singularity. In particular, the fraction in (8) is ∆-analytic and of the form

Summing up we obtain

Rg(y(1 + ˆS0(y))) ∼=

Therefore, the dominant singularity of Rg(y) satisﬁes

1 + ˆS0(y)

1 + ˆS0(y) + δy ˆS0(y)

ˆS

=

1
2

+ O(cid:18)(cid:16)1 − ρ−1

y(cid:17)1/2(cid:19) .
y(cid:17)−5g/2+3/2(cid:18)1 + O(cid:18)(cid:16)1 − ρ−1

ˆS

1
2

ˆS

ˆcg(cid:16)1 − ρ−1
ρR ≥ ρ ˆS(1 + ˆS0(ρ ˆS)) = (9/8)ρ ˆS = ρS.

15

y(cid:17)1/4(cid:19)(cid:19) .

(9)

On the other hand, Sg ⊆ Rg, therefore ρR ≤ ρS and thus ρR = ρS.

It remains to show that

Rg(y) ∼= cg(cid:0)1 − ρ−1

S y(cid:1)−5g/2+3/2(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1

To this end we shall replace factors (cid:16)1 − ρ−1

and then replace each occurrence of y(1 + ˆS0(y)) by ˆy. We have

ˆS

S y(cid:1)1/4(cid:17)(cid:17) .
y(cid:17) in (9) by (cid:16)1 − ρ−1
y(cid:17) + O(cid:18)(cid:16)1 − ρ−1
y(cid:17)(cid:18)1 + O(cid:18)(cid:16)1 − ρ−1

S y(1 + ˆS0(y))(cid:17)
y(cid:17)3/2(cid:19)(cid:19)
y(cid:17)1/2(cid:19)(cid:19)

ˆS

ˆS

ˆS

9

8(cid:16)1 − ρ−1
y(cid:16)1 − ρ−1

ˆS

1 − ρ−1

S y(1 + ˆS0(y)) = 1 − ρ−1

S y(cid:18) 9

8

−

= 1 − ρ−1
ˆS

y + ρ−1
ˆS

ˆS

as ρ−1
ˆS

y(cid:16)1 − ρ−1

y(cid:17)1/2(cid:19)(cid:19) ,
implies b = a(cid:0)1 + O(cid:0)a1/2(cid:1)(cid:1) when a, b → 0, we have thus shown

y(cid:17)(cid:18)1 + O(cid:18)(cid:16)1 − ρ−1
y(cid:17)(cid:17)(cid:16)1 − ρ−1

= 2(cid:16)1 − ρ−1
y(cid:17) = (cid:16)1 −(cid:16)1 − ρ−1
2(cid:16)1 − ρ−1

S y(1 + ˆS0(y))(cid:17)(cid:18)1 + O(cid:18)(cid:16)1 − ρ−1

y(cid:17). Since a = b(cid:0)1 + O(cid:0)b1/2(cid:1)(cid:1)
S y(1 + ˆS0(y))(cid:17)1/2(cid:19)(cid:19) .

As all functions in this equation are ∆-analytic, inserting it into (9) yields

1 − ρ−1
ˆS

y =

1

ˆS

ˆS

ˆS

ˆS

Rg(ˆy) ∼= 25(g−1)/2ˆcg(cid:0)1 − ρ−1

(7)

S ˆy(cid:1)−5g/2+3/2(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1
S ˆy(cid:1)1/4(cid:17)(cid:17)

S ˆy(cid:1)−5g/2+3/2(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1

= cg(cid:0)1 − ρ−1

S ˆy(cid:1)1/4(cid:17)(cid:17)

with ˆy = y(1 + ˆS0(y)). By Proposition 3.6, this ﬁnishes the proof.

(cid:3)

Proposition 3.8 yields following structural statement.

Corollary 3.9. For g ≥ 1 the probability that a triangulation R chosen uniformly
at random from Rg(m) is simple is 1 − O(m−1/4).
Proof. We have Sg(y) (cid:22) Rg(y) since Sg ⊆ Rg. By Proposition 3.8, both Sg(y) and
)), and the result
(cid:3)

Rg(y) are of the form (cid:0)1 − ρ−1

follows by Theorem 2.2.

(1 + O((cid:0)1 − ρ−1

S y(cid:1)−5g/2+3/2

S y(cid:1)1/4

As Sg ⊆ Ng ⊆ Rg we immediately obtain analogous results for Ng.

Proposition 3.10. The generating functions Ng(y) and Sg(y) have the same dom-
inant singularity ρS, N0(y) = S0(y), and

Ng(y) − Sg(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) ,

g ≥ 1.

Corollary 3.11. For g ≥ 1 the probability that a triangulation N chosen uniformly
at random from Ng(m) is simple is 1 − O(m−1/4).

In order to analyse the generating function Mg(y), we use a similar strategy as in
Proposition 3.8. The only diﬀerence between Mg and Ng is that for triangulations
in Mg speciﬁc types of loops are allowed. We will use surgeries to eliminate all loops
from triangulations in Mg. These surgeries will relate Mg(y) to a combination of
Ng(y), Rg(y) and Sg(y). We will use this relation to prove that Mg(y) and Sg(y)
have the same dominant term.

Proposition 3.12. The generating functions Mg(y) and Sg(y) have the same dom-
inant singularity ρS, M0(y) = S0(y), and

Mg(y) − Sg(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) ,

16

g ≥ 1.

As for Propositions 3.8 and 3.10 we obtain the following corollary.

Corollary 3.13. For g ≥ 1 the probability that a triangulation M chosen uniformly
at random from Mg(m) is simple is 1 − O(m−1/4).

Proof of Proposition 3.12. A triangulation in Mg either has no loops or at least
one loop. Let Lg be the subclass of Mg of triangulations with at least one loop.
Then we have

Mg = Ng ⊎ Lg,

as Ng is the subclass of Mg of triangulations with no loops (see Table 1). Since
Mg(y) − Sg(y) = Mg(y) − Ng(y) + (Ng(y) − Sg(y)), Proposition 3.10 implies that
it suﬃces to prove that the generating function of Lg satisﬁes

Lg(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) .

Let M ∈ Lg. We wish to eliminate the loops in M by cutting along them and
closing the resulting holes (in some manner). However, the triangulations resulting
from cutting along loops (and closing the holes) do not have to be in Mg, as planar
double edges and separating pairs of loops can arise. We therefore cut the surface
recursively along loops (in any ﬁxed order) until every remaining loop bounds a
hole. Whenever we cut the surface, we root the new surface(s) in the following way.
Before cutting along a loop L, consider the root corner (v, e, e′) of the component
that contains L. After cutting along L, we deﬁne the corner corresponding to
(v, e, e′) to be the root corner of its component. If L separates the surface, then
there is a unique component S that does not have a root yet. Let LS be the copy
of L on S. The edges incident with the base u of LS are arranged around u in
a sequence LS = e1, e2, . . . , ei−1, ei = LS in counterclockwise direction. We let
(u, e1, e2) be the root corner of S.

(1)

(k)

(1)

Let M

, . . . , M

be the triangulations of the components of the resulting map
M . Without loss of generality let M
be the component containing (the corner
corresponding to) the original root. By construction, every hole is bounded by a
loop, and vice versa every loop is the boundary of a hole. Let l be the number
of loops we cut to obtain M . As every cut leaves two holes, we have 2l holes;
we denote them by H1, . . . , H2l so that for every j, H2j−1 and H2j originate from
cutting the j-th loop in our construction. Let gi be the genus of the surface that
(i)
M
by Ji and set hi := |Ji|. Let Mgi,Ji be the class of all triangulations of the surface
of genus gi with hi holes Hj, j ∈ Ji, that can occur by the previous surgery as a
component M

is embedded on. We denote the set of indices j for which Hj is a hole in M

(i)

(i)

.

In order to obtain an upper bound for Lg(y) in terms of the generating functions
M gi,Ji(y), we will have to incorporate the sum over all possible numbers of loops,
components, and genera of those components. Our ﬁrst step is to show that there
are only ﬁnitely many possibilities for these numbers.

Claim 1. The tuple g := (l, k; g1, . . . , gk; h1, . . . , hk) can attain only ﬁnitely many
values.

If k = 1, then none of the loops was separating and hence cutting along each of
the loops decreased the genus of the surface by one, yielding l ≤ g and g1 = g − l.
Now suppose k ≥ 2. For each M
had
only one hole, the loop bounding this hole would have been separating in M , a
contradiction to the fact that triangulations in Mg do not have separating loops.
If M
had precisely two holes, they either come from cutting the same loop or
from cutting two diﬀerent loops. In the former case, this would imply k = 1 as M

we claim that hi ≥ 3.

Indeed, if M

(i)

(i)

(i)

17

(i)

was connected. In the latter case, cutting along these two loops would disconnect
from the other parts of M , violating the deﬁnition of Mg. Therefore we have
M
hi ≥ 3 for all i and thus l = (h1 + · · · + hk)/2 ≥ 3k/2.

Next we show that k and l are bounded from above. When we cut along loops,
in each step we either decrease the genus of the surface by one or we cut it into two
parts. Since we ended up with k components, among l loops that were cut there
are exactly k − 1 loops that created a new component when we cut along them.
Thus for l − k + 1 of the loops cutting along them decreases the total genus and we
have g ≥ l − k + 1 ≥ k/2 + 1, implying

k ≤ 2(g − 1)

and, by inserting (10) into g ≥ l − k + 1,

l ≤ 3(g − 1).

As k and l are bounded and

g1 + · · · + gk = g − (l − k + 1)

(10)

(11)

(12)

is smaller than g, there are only ﬁnitely many possible values for g. This ﬁnishes
the proof of Claim 1.

Our aim is to obtain upper bounds for |Mgi,Ji| for any ﬁxed i. To do that we
shall describe the triangulations that can occur in Mgi,Ji in terms of triangulations
in Sg and Rg. First we describe two special triangulations that will occur during
the proof. Let Ψ be the triangulation consisting of one vertex and three loops each
bounding a hole. The other special triangulation consists of two vertices connected
by an edge and a loop based bounding a hole at one of the vertices. We denote this
(i)
triangulation by Λ (see Figure 2). Note that Ψ can occur as a component M
,
while Λ will only appear after some surgeries.

Ψ

Λ

Figure 2. The components of type Ψ and Λ.

(i)

Consider a component M

. It has genus gi and hi holes Hj, j ∈ Ji. Recursively
for j ∈ Ji, starting at the smallest index, we look at the face fj incident with the
loop Lj bounding the hole Hj. In each step we will perform surgeries for which
all maps remain triangulations. Thus, fj is bounded by a triangle tj. One of its
edges is Lj; the other edges are either two loops, a double edge, or a single edge
from the base of Lj to a vertex of degree one. In the second case, we additionally
have to distinguish whether tj is the root face of its component. We thus have the
following four possibilities.

(i) fj is the unique face of a component Ψ;
(ii) fj is the root face of its component and tj consists of Lj and a double

edge;

(iii) fj is not the root face and tj consists of Lj and a double edge; or
(iv) fj is the unique face of a component Λ.

18

In Cases (i), (ii), and (iv), we do not perform any surgery and proceed with the
next index in Ji. In Case (iii), we perform the following surgery.

Let dj be the double edge in tj. We zip dj, obtaining one copy Λj of Λ and a
component S; denote the zipped edge in S by ej. Now S might contain planar dou-
ble edges, but all such double edges are larger than ej in the sense of Deﬁnition 3.4.
Recursively pick a smallest planar double edge that does not contain the root face
of S on the same side as ej and zip it. If such a planar double edge encloses an
edge that carries a mark from an earlier step of the construction, we let the corre-
sponding edge in the planar part inherit the mark. This iterative zipping results
in a sequence σj of simple planar triangulations, each marked at the zipped edge
at which the previous triangulation was cut oﬀ. These components cannot contain
(planar) double edges, as such double edges would enclose ej and thus would con-
tradict the minimality of the double edges that have been zipped. Furthermore,
the last zipped double edge in the remaining part of S is marked. If (ii) occurred
for an index j0, we ﬁrst perform the above surgeries for all other j ∈ Ji. After these
surgeries the face fj0 satisﬁes (iv) if gi = 0 and (ii) otherwise. In the latter case we
zip the double edge in tj0 to obtain a copy Λj0 of Λ.

After performing these surgeries for all loops, every remaining planar double
edge has the root face on its planar side; in particular, the other side of the double
edge is not planar. Thus, the remaining planar double edges are partially ordered
by Lemma 3.5. We proceed the same way as before, recursively zipping smallest
double edges, thus obtaining another sequence of simple planar triangulations.

We split Mgi,Ji into the following sub-classes.

(A) Let Agi,Ji be the subclass of Mgi,Ji \ {Ψ} where the root face is incident

with a loop.

(B) Let Bgi,Ji be the subclass of Mgi,Ji where the root face is not incident

with a loop.

(i)

Note that M
separating. Thus we can write

cannot be Λ, as otherwise the corresponding loop would have been

where Ψ is only present if gi = 0 and hi = 3.

Mgi,Ji = Agi,Ji ⊎ Bgi,Ji ⊎ {Ψ},

Claim 2. Let Agi,Ji(y) be the generating function of Agi,Ji where loops are not
counted. Then

A0,Ji(y) (cid:22) hi2h2

i δhi−2

y

Agi,Ji(y) (cid:22) hi2h2

i δhi−1

y

(3y)hi

 
(1 − δy (S0(y)))hi−1! ,
 (cid:18)
1 − δy (S0(y))(cid:19)hi

3y

Rgi (y)! ,

for gi ≥ 1.

Suppose gi = 0. By the construction above we have one sequence σj of marked
simple planar triangulations for every loop that is not incident with the root face. At
the start of each of those sequences there is one component Λj. Such a component
is counted by 3y, since it has one single edge (and we do not count loops) and there
are three possibilities for the root. Therefore we obtain a factor of

(3y)hi−1

(1 − δy (S0(y)))hi−1 .

In addition, we have a copy of Λ containing the original root face. For each of the
hi − 1 sequences, there is one marked edge in one of the other components, thus
there are hi − 1 additional marked edges. As at least one of the marks (the last

19

one) is on the copy of Λ that contains the root face, we obtain

δhi−2
y

 

(3y)hi−1

(1 − δy (S0(y)))hi−1 δy (3y)! .

This is an upper bound as not all markings are allowed, e.g. placing the marking
of a sequence on the sequence itself. Going in the other direction we reattach the
triangulations in the sequences σj and the components Λj. We have to bound the
number of diﬀerent maps in Agi,Ji we can obtain by this construction.

Marks and sequences are sorted, hence it is uniquely deﬁned which mark belongs
to which sequence. We have hi copies Λj, j ∈ Ji, of Λ; deciding for which j0 the
component Λj0 contains the original root face gives us a factor of hi. Let j be the
largest index in Ji \ {j0}. Then the triangulations in the sequence σj are recursively
attached to Λj0 . By Lemma 3.3, each such step is a 2-to-2 correspondence. If for
a diﬀerent sequence σj ′ , its mark is placed in one of the triangulations of σj, then
there are at most two possibilities which edge carries this mark after reattaching all
triangulations in σj . As this can happen at most once for each pair of sequences,
the number of choices is bounded by 2h2
i . Together with the trivial observation
δy (3y) = 3y we have proved the ﬁrst statement of Claim 2.

For gi ≥ 1 we proceed analogously. Again, we have components Λj, j ∈ Ji, and
for each j ∈ Ji \ {j0} we have a sequence of marked simple planar triangulations,
one component Λj, and a marked edge where the sequence was attached to the
rest of the map. In contrast to the case gi = 0, we also have a sequence σ that
originated from zipping planar double edges between the root and the non-planar
component N in the last step of our construction. In the opposite direction, this
sequence is attached to N at the root edge of N , thus there is no additional mark.
The triangulation N is of genus gi, has no holes, and has no planar double edges;
thus N ∈ Rgi . In total, we have an upper bound of

δhi−1
y

 (cid:18)

3y

1 − δy (S0(y))(cid:19)hi

Rgi (y)! .

The factor hi2h2

i results from the same considerations as in the planar case.

Claim 3. Let Bgi,Ji(y) be the generating function of Bgi,Ji where loops are not
counted. Then

B0,Ji(y) (cid:22) (hi − 1) 2h2

i δhi−2

y

Bgi,Ji(y) (cid:22) 2(hi+1)2

δhi

y  (cid:18)

3y

1 − δy (S0(y))(cid:19)hi

 (cid:18)
1 − δy (S0(y))(cid:19)hi

yR0(y)(cid:1)! ,
(cid:0)δ2
1 − δy (S0(y))! ,

Rgi (y)

3y

for gi ≥ 1.

Proving these formulas works analogously to the previous claim. For the planar
case the diﬀerence is that we now have one sequence for every hole and the remaining
triangulation P is a planar triangulation without double edges (thus in R0). We
have to mark hi edges, one for each sequence. We claim that at least two of these
marks are on P .
If this
mark was the only mark on P , then the double edge we zipped to obtain the last
triangulation in σj would have been separating in M , a contradiction. Thus we
have at least two marks on P . One of these two marks is the mark for the last
sequence σj, for the other mark there are hi − 1 choices. The factor 2h2
i results
from the same reasoning as before.

Indeed, the mark from the last sequence σj is on P .

For the case gi ≥ 1 we again obtain one sequence for each loop and one additional
sequence for the part between the root and the non-planar component N . As this

20

additional sequence is attached at the root edge of N , we do not need an additional
mark. We thus have hi marks in total. As we have hi + 1 instead of hi sequences,
the factor 2h2

i changes to a factor 2(hi+1)2

.

Claim 4. The generating function Lg(y) of Lg is bounded from above as follows.

Lg(y) (cid:22)Xg (cid:18)

2l

h1, h2, . . . , hk(cid:19)yl(Ag1,J1(y) + Bg1,J1(y) + 1)

where the sum is over all possible values of g.

k

(Agi,Ji(y) + 1), (13)

Yi=2

After cutting along the l loops, the result is a set of triangulations with holes.
The sum realises each possible distribution of genera and numbers of holes to these
components. The multinomial coeﬃcient represents the choice of how the indices
of the holes are distributed among the components, while the factor yl counts the
containing the root might be in Ag1,J1,
loops that were cut. The component M
in Bg1,J1, or a copy of Ψ (which is counted as 1, since loops have been taken care of
separately). All other components are rooted along a loop around one of the holes.
with i > 1 can be in Bg1,J1. This ﬁnishes the proof

(1)

(i)

Therefore no component M
of the claim.

With these claims we are able to show that Lg(y) is indeed of the claimed order.

Claim 5. For any gi ≥ 0 and hi we have

To determine an upper bound for Agi,Ji(y) and Bgi,Ji(y) from Claims 2 and 3
1−δy(S0(y)) is ∆-analytic and of the

we repeatedly use the fact that the function

1

and thus in particular

form c0 + O(cid:16)(cid:0)1 − ρ−1

A0,Ji(y) (cid:22) c1δhi−2

y

For gi > 0 we have

Agi,Ji(y) (cid:22) cgδhi−1

y

∼= cgδhi−1

y

= O(cid:16)(cid:0)1 − ρ−1

Analogously we obtain

Agi,Ji(y) ∼= O(cid:16)(cid:0)1 − ρ−1
Bgi,Ji(y) ∼= O(cid:16)(cid:0)1 − ρ−1
Lg(y) ∼= O(cid:16)(cid:0)1 − ρ−1
Lg(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5gi/2−hi+5/2(cid:17) ,
S y(cid:1)−5gi/2−hi+3/2(cid:17) ,
S y(cid:1)−5g/2+2(cid:17) ,
S y(cid:1)−5g/2+7/4(cid:17) .

3y

S y(cid:1)1/2(cid:17), where c0 is a constant. We obtain
(cid:18)(cid:16)c0 + O(cid:16)(cid:0)1 − ρ−1
 (cid:18)
1 − δy (S0(y))(cid:19)hi
(cid:18)(cid:16)c0 + O(cid:16)(cid:0)1 − ρ−1
S y(cid:1)−5gi/2−hi+5/2(cid:17) .
∼= O(cid:16)(cid:0)1 − ρ−1
∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)3/2−hi(cid:17) and
S y(cid:1)−5gi/2−hi+3/2(cid:17) .

Rgi (y)!
S y(cid:1)1/2(cid:17)(cid:17)hi

O(cid:16)(cid:0)1 − ρ−1

Bgi,Ji

B0,Ji

21

S y(cid:1)1/2(cid:17)(cid:17)hi−1(cid:19) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)5/2−hi(cid:17) .

S y(cid:1)5gi/2+3/2(cid:17)(cid:19)

Therefore we conclude the claim for Agi,Ji(y) and Bgi,Ji(y). By Claim 1 the sum
in (13) has only ﬁnitely many terms. Therefore Lg(y) is congruent to the dominant
term among the summands. For the choice of k, l, g1, . . . , gk, h1, . . . , hk for which
the summand is the dominant term, we have by (12)

k

O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5gi/2−hi+5/2(cid:17)

Yi=2

Lg(y) ∼= O(cid:16)(cid:0)1 − ρ−1
= O(cid:16)(cid:0)1 − ρ−1
= O(cid:16)(cid:0)1 − ρ−1
= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5gi/2−h1+3/2(cid:17)
S y(cid:1)−5 P gi/2−P hi+5k/2−1(cid:17)
S y(cid:1)−5(g−l+k−1)/2−2l+5k/2−1(cid:17)
S y(cid:1)−5g/2+l/2+3/2(cid:17) .

As we cut along at least one loop, the claim and thus the proposition follows. (cid:3)

From Proposition 3.12 and Lemma 2.5 we immediately obtain the following.
Corollary 3.14. The dominant singularity of Mg is given by ρM = ρS = 3
The generating function M0(y) is ∆-analytic and satisﬁes

28/3 .

M0(y) =

For g ≥ 1 we have

3

9

1
8

−

25/2 (cid:0)1 − ρ−1

16(cid:0)1 − ρ−1
S y(cid:1) +
S y(cid:1)−5g/2+3/2(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1
Mg(y) ∼= cg(cid:0)1 − ρ−1

S y(cid:1)2(cid:17) .
+ O(cid:16)(cid:0)1 − ρ−1
S y(cid:1)1/4(cid:17)(cid:17) ,

S y(cid:1)3/2

where cg is a constant depending only on g.

(14)

(15)

4. Cubic graphs

Unless stated otherwise, graphs are unrooted. Recall that in our generating
functions x marks vertices and y marks edges. Additionally we will distinguish
whether edges are single edges, double edges or loops as they are treated diﬀerently
when obtaining relations between graph classes. We will use the variable z to mark
double edges and the variable w to mark loops. It is easy to see that 3-connected
cubic graphs are simple and that 2-connected cubic multigraphs do not contain
loops. The generating functions for these classes will only feature the variables of
edges that can occur.

In order to derive asymptotic results we shall deal with univariate generating
functions F (v). As cubic (multi)graphs always have 2n vertices and 3n edges for
some n ∈ N, we would like the coeﬃcient (2n)![vn]F (v) to be the number of graphs
(or multigraphs or weighted multigraphs) in the corresponding class with 2n ver-
tices and 3n edges. Such a univariate generating function can be obtained by the
following substitution.

Deﬁnition 4.1. Let F be a class of connected cubic multigraphs without triple
edges and let

F (x, y, z, w) = Xn,m,k,l≥0

fn,m,k,l

n!

xnymzkwl

be its exponential generating function. We deﬁne functions F (v), F u(v), and F s(v)
as follows.

F (v) := F (cid:18)v1/4, v1/6,

v1/3

2

,

v1/6

2 (cid:19) ,

F u(v) := F (v1/4, v1/6, v1/3, v1/6),
F s(v) := F (v1/4, v1/6, 0, 0).

22

and

If the generating function of F does not involve z or w, we deﬁne F (v), F u(v), and
F s(v) analogously, only using the substitutions of those variables that occur.

We claim that (2n)![vn]F (v) is the number of weighted multigraphs in F (2n),
i.e. the sum of W (G) for all G ∈ F with 2n vertices (and thus with 3n edges).
Indeed, if G ∈ F (2n) has k double edges, l loops, and m single edges, then there
are 2k + l + m = 3n edges in total and the substitution transforms the monomial
x2nymzkwl into 2−(k+l)vn/2+m/6+k/3+l/6 = W (G)vn. Similarly, (2n)![vn]F u(v) is
the number of (unweighted) multigraphs in F (2n). Finally, (2n)![vn]F s(v) is the
number of simple graphs in F (2n), since replacing z and w by 0 ensures that no
graphs with double edges or loops are counted in F s(v).

When we relate various classes of graphs, we will often mark edges, which corre-
sponds to applying the operator δy = y ∂
∂y to the generating function. As we apply
singularity analysis to the univariate generating function deﬁned above, we shall
express applications of δy by applications of δv. This is formalised by the following
lemma.

Lemma 4.2. Let F (x, y) be the generating function of a class F of connected cubic
multigraphs. Then

3δv(F (y)) = δy(F (x, y))|x=v1/4,y=v1/6 .

Proof. Since graphs in F are cubic, we have 3δx(F (x, y)) = 2δy(F (x, y)) and thus

3δv(F (v)) = 3v

∂F (v)

= (cid:18)3v
∂v
v1/4 ∂F (x, y)

∂x

= (cid:18) 3

4

∂y

∂y

∂v(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)x=v1/4,y=v1/6

∂F (x, y)

∂F (x, y)

∂x
∂v

+ 3v

∂x
v1/6 ∂F (x, y)

+

1
2

∂y (cid:19)(cid:12)(cid:12)(cid:12)(cid:12)x=v1/4,y=v1/6

= δy(F (x, y))|x=v1/4,y=v1/6 .

(cid:3)

4.1. From maps to graphs. Let Dg be the class of 3-connected cubic vertex-
labelled graphs strongly embeddable on Sg and let Dg(x, y) be its generating func-
tion. In this section we provide some necessary properties of Dg(v). We will use the
auxiliary classes Dg of 3-connected cubic edge-labelled graphs strongly embeddable
on Sg, and Mg of edge-labelled, unrooted triangulations where the triangulations
are in Mg.

Proposition 4.3. The dominant singularity of Dg(v) is ρD = ρ3
have the following congruences.

S = 27

256 and we

D v(cid:1)5/2
+ O(cid:16)(cid:0)1 − ρ−1
D0(v) ∼= c0(cid:0)1 − ρ−1
D v(cid:1) + O(cid:16)(cid:0)1 − ρ−1
D1(v) ∼= c1 log(cid:0)1 − ρ−1
D v(cid:1)−5g/2+5/2
Dg(v) ∼= cg(cid:0)1 − ρ−1

D v(cid:1)3(cid:17) ,
D v(cid:1)1/4(cid:17) ,
+ O(cid:16)(cid:0)1 − ρ−1

where the cg are constants.

D , v(cid:1)−5g/2+11/4(cid:17) ,

and

for g ≥ 2,

Applying Theorem 2.2, we immediately obtain the coeﬃcients of Dg(v).

Corollary 4.4. The coeﬃcients of Dg(v) satisfy

[vn]Dg(v) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) cgn5(g−1)/2−1ρ−n

D ,

where cg is a constant.

Proof of Proposition 4.3. First we compare Mg and Mg. For each triangulation
M ∈ Mg with m edges there are m! possibilities of labelling its edges. Conversely,

23

for a triangulation M ∈ Mg there are 2m possibilities of rooting it. Therefore the
exponential generating function M g(y) of Mg satisﬁes

and thus

[ym]Mg(y) = 2m[ym]M g(y)

Mg(y) = 2δyM g(y).

Every graph G ∈ Dg has at least two (edge-labelled) 2-cell embeddings. By
Proposition 3.1, the maps obtained this way are precisely the duals of the trian-
gulations in Mg. As y denotes the number of edges in M g(v1/3) and v denotes a
third of the number of edges in Dg(v), we obtain

2Dg(v) (cid:22) M g(v1/3).

We claim that for a cubic map M on Sg,
its facewidth fw(M ) is exactly the
edgewidth ew(M∗) of the triangulation M∗ that is the dual of M . Indeed, an essen-
tial cycle of M∗ witnessing the edgewidth of M∗ corresponds to an essential circle on
Sg that meets M in ew(M∗) edges and no vertices, resulting in fw(M ) ≤ ew(M∗).
On the other hand, any two faces of M that share a vertex also share an edge, as
M is cubic. Thus, there is an essential circle witnessing the facewidth of M that
meets M only in edges. As this circle corresponds to an essential cycle of M∗, we
have fw(M ) ≥ ew(M∗) and thus equality. Since by Lemma 2.6(iii) a 3-connected
graph embeddable on Sg with facewidth at least 2g + 3 has exactly two embeddings,
we have

2D

fw≥2g+3
g

(v) = M

ew≥2g+3
g

(v1/3).

As obviously D

fw≥2g+3
g

(v) (cid:22) Dg(v) we obtain the following chain of inequalities.

M

ew≥2g+3
g

(v1/3) = 2D

fw≥2g+3
g

(v) (cid:22) 2Dg(v) (cid:22) M g(v1/3).

(16)

Since there are no double edges in a 3-connected cubic graph, we know that
the two generating functions Dg(v) and Dg(v) are closely related. To be precise,
(2n)![vn]Dg(v) is the number of vertex-labelled graphs in Dg(2n). Since every
such graph has 3n edges, (3n)!(2n)![vn]Dg(v) is the number of 3-connected cubic
graphs with 2n vertices embeddable on Sg with both vertices and edges labelled.
As this number is equal to (2n)!(3n)!Dg(v) by an analogous argument, we have
[vn]Dg(v) = [vn]Dg(v).

Therefore we can replace Dg(v) by Dg(v) in (16). We obtain

Dg(v) (cid:22)

1
2

M g(v1/3) =

1

4Z t−1Mg(t) dt(cid:12)(cid:12)(cid:12)(cid:12)t=v1/3

and by Lemma 2.3 we obtain an upper bound for Dg(v) as claimed. To ﬁnish the
proof we will show the following claim.

Claim 1. The generating functions Mg(y)ew≥2g+3 and Mg(y) have the same dom-
inant singularity and

Mg(y) − M ew≥2g+3

g

(y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) .

Before we proof the claim, let us note that Proposition 4.3 follows immediately

from Claim 1, Lemma 2.5, and Corollary 3.14.

A more general statement than Claim 1 was proven in [3] for a variety of map
classes. Although we believe that the proof in [3] generalises to Mg, which was not
considered in [3], we give a slightly diﬀerent proof here.

24

The generating function of Mg \ Sg is congruent to O(cid:16)(cid:0)1 − ρ−1

Proposition 3.12. It thus suﬃces to show that

S y(cid:1)−5g/2+7/4(cid:17) by

Sew≤2g+2

g

∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) .

g

g

g

(y) (cid:22) SC=i

(y). Let M ∈ SC=i

For i ≥ 3 let SC=i
be the class of triangulations in Sg where one non-contractible
cycle of length i is marked and denote its generating function by SC=i
(y). Clearly
Sew=i
and let C be the marked cycle of M . We
cut along C and close the two resulting holes by inserting discs. For each of the
two discs, we then add a new vertex triangulating the disc. If C was separating,
we mark one of the corners at the new vertex in the component that contains the
original root face of M . For the other component, we choose one of the corners at
the new vertex to be its root. If C was not separating, then we mark one corner
at each of the two new vertices. In total we add 3i edges to the map. This surgery
results in

g

g

• two triangulations M (1), M (2), where M (1) contains the original root face

of M and a marked corner or

• one triangulation M∗ with two marked corners.

All resulting triangulations are in Sg′ for some g′, because the surgery does not
create loops or double edges. Thus, in the ﬁrst case M (1) ∈ Sg1 and M (2) ∈ Sg2
(disregarding markings) with g1 + g2 = g and g1, g2 ≥ 1.
In the second case
M∗ ∈ Sg−1 (disregarding markings).
Since a corner (v0, e, e′) is uniquely deﬁned once v0 and e are given, marking
a corner is equivalent to marking an edge and choosing one of its end vertices.
In terms of generating functions, this corresponds to applying the operator δy =
y ∂
∂y with an additional factor of two. Similarly to previous proofs we will mark
recursively, which will result in overcounting. Since we added 3i edges to M by our
construction, we have to compensate this by a factor of y3i. Therefore we obtain
the relation

y3iSC=i

g

(y) (cid:22) 4δ2

y (Sg−1(y)) + Xg1+g2=g

g1,g2≥1

2δy (Sg1 (y)) Sg2 (y).

By Proposition 3.6, we know that

4δ2

y (Sg−1(y)) + Xg1+g2=g

gj≥1

2δy (Sg1(y)) Sg2 (y) ∼= O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−5g/2+7/4(cid:17) .

Because

2g+2

Sew≤2g+2

g

(y) =

Xi=3

Sew=i

g

(y) (cid:22)

SC=i

g

(y),

2g+2

Xi=3

(cid:3)

this completes the proof of the claim.

4.2. From 3-connected graphs to connected multigraphs. In this section
we derive relations between diﬀerent classes of cubic multigraphs in the form of
dominance. In the end we will relate connected cubic multigraphs via 2-connected
cubic multigraphs to 3-connected cubic graphs enumerated in the previous section.
Let Dg, Bg, and Cg be the classes of 3-connected, 2-connected, and connected
vertex-labelled cubic multigraphs strongly embeddable on Sg with generating func-
n! xnymzk and Cg(x, y, z, w) =
xnymzkwl, respectively. In the generating function Cg(x, y, z, w) we will
not account for the graph consisting of two vertices connected by three edges. This
graph will be accounted for separately in the end.

tions Dg(x, y) = P dn,m
P cn,m,k,l

n! xnym, Bg(x, y, z) = P bn,m,k

n!

25

First we give a relation between a subclass of Dg and a subclass of Bg. To do this
we need the class N of edge-rooted 2-connected labelled cubic planar multigraphs,
called networks. In the exponential generating function N (x, y, z) of N we mark
the root always with y as a single edge and double edges without the root edge
with z.

Lemma 4.5. For g ≥ 1 the generating functions of Dg and Bg satisfy

Dfw≥3

g

(x, y) − D0(x, y) (cid:22) Bfw≥3

g

(x, y, z) (cid:22) Dfw≥3

g

(x, y),

(17)

where y = y(1 + N (x, y, z)).

Proof. Let B be a multigraph in Bfw≥3
on the right-hand side and at most once on the left-hand side of (17).

. We show that it is counted at least once

g

First, suppose that B is not planar. Then Corollary 2.7(ii) states that B has
a unique 3-connected component T strongly embeddable on Sg with the same
facewidth. T is in Dfw≥3
(x, y). To get B
from T we have to attach 2-connected components along the edges. That means,
either we leave an edge as it is (obtaining a summand of y) or we replace it by
two edges (obtaining a factor of y2) and one multigraph in N without its root edge
(obtaining a factor of 1
y N ). Thus B is counted exactly once on the right-hand side
of (17).

and therefore counted once in Dfw≥3

g

g

If B is planar, then it might be counted more than once on the right-hand side.
Indeed, in this case the 2-connected components carrying the facewidth might be
diﬀerent for diﬀerent embeddings. Therefore Dfw≥3
(x, y + yN (x, y, z)) is an upper
bound. To get a lower bound we have to subtract all multigraphs we over counted.
This is achieved by subtracting D0(x, y + yN (x, y, z)), as only planar multigraphs
are over counted and each such multigraph is subtracted once for each of its 3-
connected components.
(cid:3)

g

In the same spirit we can relate connected and 2-connected multigraphs using the
auxiliary class Q of all edge-rooted connected vertex-labelled cubic planar multi-
graphs where the root edge is a loop. To simplify the formulas later on, the root
will be marked by y in the generating function Q(x, y, z, w) and only non-root loops
are marked by w.

Lemma 4.6. For g ≥ 1 the generating functions of C and B satisfy the following
relation.

(x, y, z) − B0(x, y, z) (cid:22) Cfw≥2

g

(x, y, z, w) (cid:22) Bfw≥2

g

(x, y, z),

(18)

g

Bfw≥2
1−Q(x,y,z,w) and z = 1
2 (

y

where y =

y

1−Q(x,y,z,w) )2.

Proof. Let C ∈ Cfw≥2
side and at most once on the left-hand side of (18).

g

. We shall show it is counted at least once on the right-hand

First, suppose C is not planar. Then Corollary 2.7(i) states that C has a unique
2-connected component B strongly embeddable on Sg with the same facewidth, i.e.
B ∈ Bfw≥2
. To get C from B we have to replace each edge by a sequence of edges
and multigraphs in Q, that means we replace one edge by a sequence of alternately
edges and multigraphs in Q without the root, starting and ending with an edge.
Therefore the replacement is y 7→ y

1

g

This results in a 1-to-1 correspondence between the two generating functions
(x, y, z) for non-planar multigraphs. The replacement

Cfw≥2
for double edges results from replacing a set of two edges each as above.

(x, y, z, w) and Bfw≥2

g

g

As in Lemma 4.5, if C is planar, the above argument does not necessarily result
in a bijection. Thus we have to subtract all corresponding planar multigraphs again

26

1−Q(x,y,z,w).

v1

v2

e1

e2

w1

w2

C

v1

e3

v2

w1

e4

w2

Figure 3. Surgery along an essential circle.

in order to avoid overcounting. Therefore we get the claimed result analogously to
the previous lemma.
(cid:3)

Lemmas 4.5 and 4.6 give relations only for multigraphs with large facewidth.
Again, almost all multigraphs have large facewidth, which we show in the following
lemma.

Lemma 4.7. For g ≥ 1 the following relations hold.

z

y

1

+

y(cid:19)2(cid:18) 1
2(cid:18)y +
(δy + δz)(cid:16)Bfw≥2
Xg′=1

g−1

g′

+

(x,y, z, w) (xyw)2(cid:18) 1

y

+

y

z(cid:19)2
(cid:22) (δy + δz)2(cid:16)Bfw≥2
(x, y, z)(cid:17) (δy + δz)(cid:16)Bfw≥2
z(cid:19) (cid:22) δ2
w (Cg−1(x, y, z, w))

y

g−1 (x, y, z)(cid:17)
g−g′ (x, y, z)(cid:17) ,

(x,y, z)

Bfw=2

g

Cfw=1

g

+

g−1

Xg′=1

(19)

(20)

δw (Cg′ (x, y, z, w)) δw (Cg−g′ (x, y, z, w)) .

Proof. In order to show (19), let B be a multigraph in Bfw=2
. Consider a ﬁxed 2-cell
embedding M of B on Sg with facewidth two and let {e1 = {v1, w1}, e2 = {v2, w2}}
be two edges such that there exists an essential circle C on Sg meeting M only in
e1 and e2. Note that e1, e2 do not share vertices, because otherwise the facewidth
would have been one. Then we delete e1 and e2, cut the surface along C and close
both holes with a disc (see Figure 3). By this surgery we either disconnect the
surface or we reduce its genus by one.

g

Case 1: Cutting along C disconnects the surface. As C was an essential loop,
both components have genus at least one. Therefore we obtain two multigraphs
B∗1 and B∗2 , strongly embeddable on Sg1 and Sg2 , respectively, with g1, g2 ≥ 1
and g1 + g2 = g. Without loss of generality we can assume that v1, v2 ∈ B∗1 and
w1, w2 ∈ B∗2 . Furthermore {e1, e2} was a 2-edge-separator in B. Thus, B∗1 and B∗2
are connected as B is 2-edge-connected. Let B1 be obtained from B∗1 by adding
an edge e3 = {v1, v2} and marking e3. Note that B1 is also strongly embeddable
on Sg1 . We claim that B1 is 2-connected. Indeed, any path in B between vertices
in B1 gives rise to a path in B1 between the same vertices by replacing any sub-
path in B \ B1 by the edge e3. Thus B1 is 2-connected as B is. So B1 has to be
2-connected as well. Analogously we add the edge e4 = {w1, w2} to B∗2 to obtain
a 2-connected multigraph B2 strongly embeddable on Sg2 . We also mark e4. Thus
we can conclude that in this case a multigraph B can be constructed from a 2-
connected multigraph embeddable on Sg′ with one marked edge and a 2-connected

27

C”

C’

C

v1

v2

e1

e2

w1

w2

Figure 4. Finding an essential circle witnessing small facewidth

multigraph embeddable on Sg−g′ with one marked edge, resulting in the term

g−1

Xg′=1

(δy + δz) (Bg′ (x, y, z)) (δy + δz) (Bg−g′ (x, y, z)) .

Note that e3 and e4 might be single edges or part of double edges and therefore

y + y

z(cid:17)2

accounts for the deletion of e1 and e2, each of which might have been a single edge
or part of a double edge (hence deleting it turns a double edge into a single edge).

diﬀerentiating with respect to both results in an upper bound. The factor(cid:16) 1
y(cid:17)2
The factor(cid:16)y + z

represents the insertion of e3 and e4, each of which either adds
a single edge or turns a single edge into a double edge. Furthermore we obtain a
factor of two for the ways to obtain the original multigraph from B1 and B2.

Case 2: Cutting along C does not disconnect the surface. As the embedding
after cutting is still a 2-cell embedding, B\{e1, e2} is connected. We can connect v1,
v2, w1, w2 in B \ {e1, e2} by two edges (without loss of generality e3 = {v1, v2} and
e4 = {w1, w2}) so as to obtain a multigraph B∗. The graph B = B ∪ {e3, e4} has a
2-cell embedding M on Sg such that e1 ∪ e2 ∪ e3 ∪ e4 bounds a face. Indeed, starting
from M , e3 and e4 can be embedded so that they run close to e1, e2, and C. Let
M∗ be the embedding of B∗ induced by M . Suppose B∗ is not 2-connected, that
is, it has a bridge e. Note that e cannot be e3 or e4 as B∗ \ {e3, e4} = B \ {e1, e2}
is connected.

There is a (not necessarily essential) circle C′ on Sg hitting M∗ only in e. As e
has not been a bridge in B, C′ has to meet e1 and e2 as well. If it met neither e1
nor e2 it would either contradict B having facewidth two (if C′ is essential) or the
2-connectivity of B (if C′ is not essential). If it met only one of them, it would have
to meet one of e3, e4, because e1, e2, e3 and e4 bound a disc in M . This contradicts
the fact that C′ meets M∗ only in e.

We now construct the following circle C′′. Follow C′ from e to e1, but not
traversing it. Follow e1 until reaching C and then use C to reach e2 without
crossing e1 and e2. Then return back to C′ along e2 and return to e (see Figure 4).
C′′ meets M only in e. Either C′′ is an essential circuit contradicting the fact that
B has facewidth two or it is planar contradicting 2-connectivity. Again we can
conclude that all multigraphs B, where the surgery does not result in disconnecting
the surface can be constructed from a 2-connected multigraph embeddable on Sg−1

28

with two marked edges resulting in the term

The factor 1

2(cid:16)y + z

y(cid:17)2(cid:16) 1

y + y

(δy + δz)2 Bg−1(x, y, z).
z(cid:17)2

follows as in Case 1. We thus conclude (19).

To prove (20), let G be a multigraph in Cfw=1

. Fix a 2-cell embedding M of
G on Sg of facewidth one and let e1 = {v1, v2} be an edge such that there exists
an essential circle C on Sg meeting G only in e1. Then we perform the following
surgery. We delete e1, cut the surface along C, close both holes with a disc, and
attach an edge, an additional vertex and a loop to both v1 and v2. Remark that
the edge deleted may be a single edge or part of a double edge. Thus we have a

g

y + y

factor of (xyw)2(cid:16) 1

z(cid:17). The deleted edge cannot be a loop as in cubic maps

on orientable surfaces loops are always on the boundary of two diﬀerent faces and
as such cannot be the only intersection of an embedding of a multigraph with an
essential circle. This can easily be seen as at the base of the loop there is only one
other edge. Thus the boundary of the face of the loop without this additional edge
consists only of traversing the loop once.

By this surgery we either disconnect the surface or we reduce its genus by one.
If we separate the surface, we obtain two connected multigraphs each with one
marked loop. These multigraphs are counted by δw(Cg′ ) and by δw(Cg−g′ ), as the
genera of the two parts sum up to g and the embeddings resulting from the surgery
are still 2-cell embeddings.

If the surface is not separated, the resulting embedding is a 2-cell embedding
and hence the multigraph remains connected. Therefore we obtain a multigraph
counted by δ2
w(Cg−1). The factor in front of the generating function is once again
obtained by marking two loops. This proves (20).

(cid:3)

Lemma 4.7 will be used to show that the number of multigraphs with small
facewidth is negligible. We will thus be able to use Lemmas 4.5 and 4.6 to obtain
asymptotic formulas for connected and 2-connected cubic multigraphs. To this end
we will need equations for the generating functions of the auxiliary classes N and
Q.

Proposition 4.8. The generating function N (x, y, z) of N satisﬁes the system of
equations

N (x, y, z) =

u(1 − 2u) − x2y(1 + N (x, y, z))(y2 − 2z)

2

,

(21)

x2y3(1 + N (x, y, z))3 = u(1 − u)3

and the generating function Q(x, y, z, w) of Q satisﬁes

Q =

x2y3

2

A +

Q2
2

+ x2y2w,

A = Q + S + P + H,

S =

P =

A2

A + 1
x2y3

2

,

(22)

A2 + x2y3A + x2yz,

2H(1 + A) = u(1 − 2u) − u(1 − u)3,

x2y3A3 = u(1 − u)3.

Proof. We obtain (22) by following the lines of Section 3 in [20] or Section 3 in
[25]. The only diﬀerence is that we account for loops and double edges in the

29

initial conditions. In order to derive the equations for Q, one starts with an edge-
rooted connected cubic planar graph and recursively decomposes it depending on
the placement of the root. Then either

(i) the root is a loop;
(ii) the root is a bridge;
(iii) the root is part of a minimal separating edge set of size two;
(iv) the end vertices of the root separate the graph; or
(v) the root is part of a 3-connected component.

In Case (i) we obtain an equation for Q; Case (ii) results in an equation that can
immediately be eliminated from the system; Case (iii) results in the equation for S;
Case (iv) in the equation for P ; and Case (v) in the parametric equations for H in
terms of u. It is shown in [20] that these are indeed exhaustive. For each of these
cases there is a decomposition of the graph resulting in the corresponding equation
in the proposition.

To obtain the equations for N (x, y, z) we start with (22). Because N (x, y, z)
enumerates edge-rooted 2-connected planar cubic multigraphs, setting w = 0 and
Q(x, y, z, w) = 0 results in a system of equations for N (x, y, z) = 1 + A. The given
equations follow by eliminating S, P , and H from these equations.
(cid:3)

4.3. Asymptotics. The goal of this section is to obtain asymptotics for Cg(v).
The analysis for Cu
g (v) are analogous; we will point out the diﬀerences
when they occur.

g (v) and Cs

We start by determining the growth constant for N (v). We will shortly see that

the analogous results for N u(v) and N s(v) are not necessary for our purpose.

more, N (v) is ∆-analytic and

17(cid:1)3
Lemma 4.9. The dominant singularity of N (v) occurs at ρN = 2(cid:0) 6
N v)3/2 + O(cid:0)(1 − ρ−1
N v)2(cid:1) .

2 · 31/2 · 55 (1 − ρ−1

Proof. By eliminating u from (21) and substituting v as in Deﬁnition 4.1, we obtain
the following implicit equation for N (v).

(1 − ρ−1

N v) +

. Further-

51
400

N (v) =

1
16

−

175/2

0 =16N 6v2 + N 5v(32 + 96v) + N 4 · (16 + 56v + 240v2)
+ N 3 · (24 − 25v + 320v2) + N 2 · (12 − 91v + 240v2)
+ N · (2 − 43v + 96v2) − v(1 − 16v).

Using standard methods (see for example [11, VII.7.1]) to deal with implicitly given
functions we determine the dominant singularity to be at ρN = 2(6/17)3 and derive
the claimed expression for N .
(cid:3)

A second step is to analyse the dominant singularity of Q(x, y, z, w). The nu-
merical values of the results are diﬀerent for Q(v), Qu(v), and Qs(v), but analysis
works in exactly the same way.

Lemma 4.10. The dominant singularity of Q(v) is ρQ = 54
and

793/2 , Q(v) is ∆-analytic

Q(v) = q0 − q1(1 − ρ−1

Q v) + q2(1 − ρ−1

Q v)3/2 + O(cid:16)(1 − ρ−1

Q v)2(cid:17) ,

where q0 = 1 − 17
2√79

, q1 = 189

298√79

, and q2 = 79·23/2·35/2

.

1995/2

Proof. The simplest way of dealing with (22) after substituting v as in Deﬁnition 4.1
is to eliminate u, D, Q, S, P and H from these equations to get the following implicit

30

equation for A.

0 =4 − 52A2 + 240A4 − 448A6 + 256A8 + A3(336 + 1848A2 − 2400A4)v

+ A6(3017 + 1024A2)v2 + 4096A9v3.

Using standard methods for implicitly given functions (see for example [11,
793/2 and we obtain an
Q v). By substituting this expression
(cid:3)

VII.7.1]) we get the dominant singularity to be at ρQ = 54
expression for A(v) in terms of powers of (1−ρ−1
into the system of equations, we get the claimed expression for Q.

Using Lemma 4.9 we can analyse the function Bg(v). Since the substitution
in Lemma 4.6 satisﬁes z = 1
2 y2, we need the function Bg(v) also in the cases of
unweighted multigraphs and simple graphs. Accordingly, the networks used in the
substitution in Lemma 4.5 have to satisfy z = 1

2 y2.

Lemma 4.11. The dominant singularity of Bfw≥2
generating function Bfw≥2

(v) is ∆-analytic and satisﬁes

g

0

(v) is ρB = ρN = 2433

173 . The

where a0, a1, a2 are constants. Furthermore,

Bfw≥2

0

Bfw≥2

1

B v(cid:1)2
B v(cid:1) + a2(cid:0)1 − ρ−1
(v) =a0 + a1(cid:0)1 − ρ−1
B v(cid:1)5/2
B v(cid:1)3(cid:17) ,
+ O(cid:16)(cid:0)1 − ρ−1
+ c0(cid:0)1 − ρ−1
B v(cid:1)1/4(cid:17)
B v(cid:1) + O(cid:16)(cid:0)1 − ρ−1
(v) ∼= c1 log(cid:0)1 − ρ−1
B v(cid:1)−5g/2+11/4(cid:17) ,
B v(cid:1)−5g/2+5/2
+ O(cid:16)(cid:0)1 − ρ−1

and

Bfw≥2

g

(v) ∼= cg(cid:0)1 − ρ−1

where the cg are constants.

g ≥ 2,

Proof. Suppose ﬁrst that g = 0. For this case N (v) is the edge-rooted version of
B0(v). Therefore

B0(v) =Z 1

y

N (v) dy =

The result follows by Lemmas 2.3 and 4.9.

1

6Z 1

v

N (v) dv.

Let g ≥ 1. By the change of variables as in Deﬁnition 4.1 we have

Dfw≥3

g

(x, y + yN (x, y, z)) = Dfw≥3

g

(cid:0)v(1 + N (v))3(cid:1) .

g

(cid:0)v(1 + N (v))3(cid:1) is given either by the singularity

The dominant singularity of Dfw≥3
ρN of N (v) or by a solution of v(1 + N (v))3 = ρ3
S is the dominant
singularity of Dg(v).
S = ρD by
Proposition 3.6 and Lemma 4.9. This is the only solution of this equation, as
v(1 + N (v)) is monotone on the interval [0, ρN ). So ρN is the dominant singularity
and the composition is critical (in the sense of [11, pp. 411ﬀ]). By Proposition 4.3
and Lemma 4.9, we have

It can be veriﬁed that ρN (1 + N (ρN ))3 = ρ3

S, where ρ3

Dfw≥3

1

and, for g ≥ 2,

(v(1 + N (v))3) ∼= c1 log(1 − ρ−1

Dfw≥3

g

(v(1 + N (v))3) ∼= cg(1 − ρ−1

Similarly, we have

N v) + O(cid:16)(1 − ρ−1
N v)−5g/2+5/2 + O(cid:16)(1 − ρ−1
+ O(cid:16)(cid:0)1 − ρ−1

N v)1/4(cid:17)
N v)−5g/2+11/4(cid:17) .
N v(cid:1)3(cid:17) .

N v(cid:1)5/2

D0(v(1 + N (v))3) ∼= c0(cid:0)1 − ρ−1

31

Now Lemma 4.5 yields that

and

Bfw≥3

g

(v) ∼= cg(1 − ρ−1

It remains to show that

Bfw≥3

1

(v) ∼= c1 log(1 − ρ−1

N v) + O(cid:16)(1 − ρ−1

N v)1/4(cid:17)
N v)−5g/2+11/4(cid:17) ,

N v)−5g/2+5/2 + O(cid:16)(1 − ρ−1
(v) ∼= O(cid:16)(cid:0)1 − ρ−1

N v(cid:1)−5g/2+11/4(cid:17) .

Bfw=2

g

By Lemma 4.7 and the fact that

g ≥ 2.

δy(cid:18)F(cid:18)x, y,

y2

2 (cid:19)(cid:19) (cid:23) δz(F (x, y, z))|

z= y2

2

for every generating function F (x, y, z), we have the relation

Bfw=2

g

(cid:18)x, y,

y2

2 (cid:19) 1

2 y +
Xg′=1

g−1

+

+

y2
2

y

y !2  1
δy(cid:18)Bfw≥2

g′

y
y2

2 !2
(cid:18)x, y,

y2

(cid:22) δ2

g−1 (cid:18)x, y,
y(cid:18)Bfw≥2
g−g′ (cid:18)x, y,
2 (cid:19)(cid:19) δy(cid:18)Bfw≥2

2 (cid:19)(cid:19)
2 (cid:19)(cid:19) .

y2

y2

(23)

(24)

By Lemma 4.2, (24) implies that

81
8

Bfw=2

g

(v) (cid:22) 9δ2

v(Bfw≥2

g−1 (v)) + 9

g−1

Xg′=1

δv(Bfw≥2

g′

(v))δv(Bfw≥2

g−g′ (v)).

(25)

By Lemma 2.3 and the fact that all generating functions on the right-hand side of
(25) are for genus smaller than g, we deduce by induction that

v(Bfw≥2
δ2

δv(Bfw≥2

g′

g−1 (v)) ∼= O(cid:16)(cid:0)1 − ρ−1
(v)) ∼= O(cid:16)(cid:0)1 − ρ−1
g−g′ (v)) ∼= O(cid:16)(cid:0)1 − ρ−1

δv(Bfw≥2

Substituting this into (25) results in

B v(cid:1)−5g/2+3(cid:17) ,
B v(cid:1)−5g′/2+3/2(cid:17) ,
B v(cid:1)−5(g−g′)/2+3/2(cid:17) .
B v(cid:1)−5g/2+3(cid:17) ,

which immediately implies (23) and thus concludes the proof.

Bfw=2

g

(v) (cid:22) O(cid:16)(cid:0)1 − ρ−1

and

(cid:3)

As an immediate corollary of Lemma 4.11 we determine the coeﬃcients of Bfw≥2

g

(v).

Corollary 4.12. The number of 2-connected cubic vertex-labelled weighted multi-
graphs that are strongly embeddable on Sg with facewidth at least two is

[vn]Bfw≥2

g

(v) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) cgn5g/2−7/2ρ−n

B .

Here cg is a constant depending only on g and ρB = ρN = 2433
173 .

We can use Lemma 4.11 to determine the dominant term of connected cubic

multigraphs embeddable on Sg.

32

Theorem 4.13. The dominant singularity of the generating function Cg(v) of
connected cubic vertex-labelled weighted multigraphs that are strongly embeddable
on Sg is ρC = ρQ = 54

793/2 . The generating function C0(v) is ∆-analytic and

where a0, a1, a2 are constants. Furthermore,

C v(cid:1)2
C v(cid:1) + a2(cid:0)1 − ρ−1
C0(v) =a0 + a1(cid:0)1 − ρ−1
C v(cid:1)5/2
C v(cid:1)3(cid:17) .
+ O(cid:16)(cid:0)1 − ρ−1
+ c0(cid:0)1 − ρ−1
C v(cid:1)1/4(cid:17)
C v(cid:1) + O(cid:16)(cid:0)1 − ρ−1
C1(v) ∼= c1 log(cid:0)1 − ρ−1
C v(cid:1)−5g/2+5/2
C v(cid:1)−5g/2+11/4(cid:17) ,
+ O(cid:16)(cid:0)1 − ρ−1

g ≥ 2,

and

Cg(v) ∼= cg(cid:0)1 − ρ−1

where the cg are constants.

Proof. For g = 0, the class of planar connected cubic multigraphs is given by
unrooting the sum of the classes used in Lemma 4.10, see [7] or [20] for more
details.

Suppose g ≥ 1. By the substitution as in Deﬁnition 4.1 we have

Bfw≥2

g

 x,

y

1 − Q

,

1

1 − Q(cid:19)2! = Bfw≥2
2(cid:18) y

g

(cid:18)

v

(1 − Q(v))3(cid:19) .

The dominant singularity with respect to v is given either by the singularity ρQ of
Q(v) as calculated in Lemma 4.10 or by a solution of v/(1 − Q(v))3 = ρB, where
ρB is the dominant singularity of Bg calculated in Lemma 4.11. It can easily be
veriﬁed that ρQ/(1 − Q(ρQ))3 = ρB by Lemma 4.10 and Lemma 4.11. This is the
only solution of this equation as v/(1 − Q(v))3 is monotone (as it is a geometric
series of a generating function with nonnegative coeﬃcients). Therefore ρC = ρQ
is the dominant singularity and the composition is critical (in the sense of [11, pp.
411ﬀ]). By Lemmas 4.10 and 4.11, we have

Bfw≥2

g

(cid:18)

v

(1 − Q)3(cid:19) ∼= cg(cid:0)1 − ρ−1

for g ≥ 2 and

Bfw≥2

1

(cid:18)

Similarly, we have

B0(cid:18)

Now Lemma 4.6 yields that

v

v

C v(cid:1)−5g/2+5/2
(1 − Q)3(cid:19) ∼= c1 log(cid:0)1 − ρ−1
(1 − Q)3(cid:19) ∼= c0(cid:0)1 − ρ−1
C v(cid:1)5/2
C v) + O(cid:16)(1 − ρ−1

C v(cid:1)−5g/2+11/4(cid:17)
+ O(cid:16)(cid:0)1 − ρ−1
C v(cid:1)1/4(cid:17) .
C v(cid:1) + O(cid:16)(cid:0)1 − ρ−1
C v(cid:1)3(cid:17) .
+ O(cid:16)(cid:0)1 − ρ−1
C v)1/4(cid:17)
C v)−5g/2+11/4(cid:17) ,

C v)−5g/2+5/2 + O(cid:16)(1 − ρ−1

(v) ∼= c1 log(1 − ρ−1

g ≥ 2.

Cfw≥2

1

and

Cfw≥2

g

(v) ∼= cg(1 − ρ−1

It thus remains to show that

Cfw=1

g

∼= O(cid:16)(cid:0)1 − ρ−1

C v(cid:1)−5g/2+11/4(cid:17) .

33

(26)

By Lemma 4.7 and the fact that δy(F (x, y, y2
every generating function F (x, y, z, w), we have the relation

2 , y

2 )) (cid:23) δw(F (x, y, z, w))|

z= y2

2 ,w= y

2

for

Cfw=1

g

(cid:18)x, y,

y2
2

,

2 ! (cid:22) δ2

y

y

y

+

y
y2

2(cid:17)2  1
2(cid:19)(cid:16)xy
δy(cid:18)Cg′(cid:18)x, y,
Xg′=1

g−1

+

y2
2

,

y

y2
2

2(cid:19)(cid:19)
y(cid:18)Cg−1(cid:18)x, y,
2(cid:19)(cid:19) δy(cid:18)Cg−g′(cid:18)x, y,

y

,

y2
2

,

y

2(cid:19)(cid:19) .

(27)

By Lemma 4.2, (27) implies that

3
4

Cfw=1

g

(v) (cid:22) 9δ2

v(Cg−1(v)) + 9

g−1

Xg′=1

δv(Cg′ (v))δv(Cg−g′ (v)).

(28)

By the fact that all generating functions on the right-hand side of (28) are for genus
smaller than g, we can use induction on g like in the proof of Lemma 4.11 to deduce
(26). This concludes the proof.
(cid:3)

From Theorem 4.13 and Lemma 2.4 we can immediately evaluate the coeﬃcients

of Cg(v).

Corollary 4.14. The asymptotic number of connected cubic vertex-labelled multi-
graphs that are weighted by their compensation factor and are strongly embeddable
on Sg is given by

[vn]Cg(v) =(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) cgn5g/2−7/2ρ−n

C .

Here cg is a constant only depending on g and ρC = ρQ = 54

79√79

.

4.4. Proof of Theorem 1.2. Using the results from the previous section we can
now prove Theorem 1.2. Recall that a cubic multigraph embeddable on Sg is given

by a set of connected cubic multigraphs embeddable on Sgi such thatP gi ≤ g (see

Proposition 2.1). Therefore we have the relation

∞

Xk=1 XP gi≤g

k

1
k!

Yi=1(cid:16)Cgi (v) +

v

6(cid:17) .

(29)

Gg(v) (cid:22)

The summand v
6 accounts for the fact that a component might also be a triple
edge, not accounted for in Cgi (v) (this additional summand will diﬀer when proving
Theorems 1.1 and 1.3). We only get an upper bound, because we overcount if a
multigraph is strongly embeddable on surfaces of multiple genera. Later we will
also obtain a lower bound with the same asymptotics to complete the proof.

If g = 0, (29) simpliﬁes to G0 = exp(C0 + v

6 ), as there is no overcounting in
this case. This coincides with Theorem 1 of [20] and therefore we can conclude our
statement. (Although it is not directly shown there, the same arguments can be
used for unweighted planar cubic multigraphs. For simple graphs, see [7].)

Now suppose g ≥ 1. The ﬁrst step to obtain asymptotics from (29) is to rearrange
the sum in such a way that all planar components are singled out. This results in

Gg(v) (cid:22)

g

Xk=0 XP gi≤g

gi≥1

1
k!

k

Yi=1(cid:16)Cgi (v) +

v

6(cid:17)

∞

Xj=0

k!

(k + j)! (cid:16)C0(v) +

v

6(cid:17)j

.

(30)

34

By the dominant term and the value of C0(v) at the singularity ρC from Theo-
rem 4.13 we observe that the contribution of the last sum to the formula is only a
constant factor. Thus it remains to calculate the dominant term of 1
As the ﬁrst sum consists only of a constant number of summands, the dominant
term of the right-hand side of (30) will be the (sum of the) dominant terms from
1

k! Q(cid:0)Cgi (v) + v
6(cid:1).
6(cid:1) up to the constant obtained from the planar components. That

k!Q(cid:0)Cgi (v) + v

is, we shall compute the dominant term of

A(v) :=

1
k!

k

Yi=1(cid:16)Cgi (v) +

v

6(cid:17) ,

where the gi are positive and sum up to g′ ≤ g.

Suppose g = 1. Then either k = g′ = 0 or k = g′ = 1. By Theorem 4.13, we

have

and thus

A(v) = C1(v) +

v
6

∼= c1 log(1 − ρ−1

C v) +

v
6

A(v) (cid:22) P1(v) + c1 log(1 − ρ−1

C v(cid:1)1/4(cid:17)

+ O(cid:16)(cid:0)1 − ρ−1
C v(cid:1)1/4(cid:17)

C v) + O(cid:16)(cid:0)1 − ρ−1

with P1(v) a polynomial and c1 a constant. Suppose now g ≥ 2. Without loss of
generality let g1, . . . , gl = 1 and gl+1, . . . , gk > 1. Then

A(v) ∼=(cid:16)1 + O(cid:16)(cid:0)1 − ρ−1
∼=(cid:16)c + O(cid:16)(cid:0)1 − ρ−1

1(cid:0)log(cid:0)1 − ρ−1

C v(cid:1)1/4(cid:17)(cid:17) 1
C v(cid:1)1/4(cid:17)(cid:17)(cid:0)log(cid:0)1 − ρ−1

C v(cid:1)(cid:1)l

Yi=l+1
cgi(cid:0)1 − ρ−1
C v(cid:1)−5g′/2+5k/2
C v(cid:1)(cid:1)l(cid:0)1 − ρ−1

k!

cl

.

C v(cid:1)5(1−gi)/2

k

For k = 1 and g′ = g (and hence l = 0) we thus have

1
1!

1

Yg′=1(cid:16)Cgi +

v

6(cid:17) ∼= cg(1 − ρ−1

C v)−5g/2+5/2 + O(cid:16)(1 − ρ−1

C v)−5g/2+11/4(cid:17) .

For k ≥ 2 or g′ < g, (31) yields

1
k!

k

Yi=1

Cgi (v) ∼= O(cid:16)(1 − ρ−1

C v)−5g/2+5/2+2(cid:17)

and thus

(31)

(32)

(33)

Gg(v) (cid:22) cg(1 − ρ−1

C v)−5g/2+5/2 + O(cid:16)(1 − ρ−1

C v)−5g/2+11/4(cid:17) .

We derive a lower bound for g ≥ 1 as follows. Let ˜Gg be the class of graphs in

Gg with one component of genus g and all other components planar. Then

Cg(v)Cj
(j + 1)!

0 (v)

∞

Xj=0

(cid:23) ˜Gg(v) (cid:23)

∞

Xj=0

Cg(v)Cj
(j + 1)!

0 (v)

−

∞

Xj=0

(j + 1)Cj+1
(j + 1)!

0

(v)

.

Indeed, if the component of genus g is also planar, then the graph might be counted
up to j + 1 times (once for each component) on the left-hand side. Substituting the
corresponding summands thus yields a lower bound of Gg(v).

Gg(v) (cid:23) ˜Gg(v) (cid:23)

1

(j + 1)!

∞

Xj=0

Cg(v)Cj

0 (v) −

j
j!

∞

Xj=1

Cj

0 (v).

(34)

Applying Theorem 2.2 to the upper and lower bounds completes the proof.

35

4.5. Proofs of Theorems 1.1, 1.3 and 1.4. Theorems 1.1 and 1.3 can be proven
analogously to Theorem 1.2. We obtain ρ1 as the smallest positive solution of

0 = −46656 + 139968u + 9524176u2 − 1763856u3 + 121716u4 + 8748u5 + 729u6

and ρ3 as the smallest positive solution of

0 = −46656 − 139968u + 6043120u2 − 1717200u3 − 69228u4 − 8748u5 + 729u6.

Theorem 1.4 for the case of weighted multigraphs follows immediately from (32),
(33), and Theorem 2.2. Indeed, (32) and Theorem 2.2 imply that the number of
weighted multigraphs in Gg(n) that have a unique non-planar component that is
not embeddable on Sg−1 is

(cid:16)1 + O(cid:16)n−1/4(cid:17)(cid:17) egn5g/2−5/2γ2n

2 (2n)! .

On the other hand, (33) and Theorem 2.2 imply that the number of weighted
multigraphs in Gg(n) that do not have such a component is

O(cid:16)n5g/2−5/2−2γ2n

2 (2n)!(cid:17) .

Thus, Theorem 1.4 follows. Observe that the probability 1 − O(n−2) is not sharp.
Indeed, the exponent in (33) could be improved to −5g/2 + 5 − ε for every ε > 0,
which would yield a probability 1 − O(n−5/2+ε). The statements of Theorem 1.4
for unweighted multigraphs and simple graphs are proved analogously.

References

[1] E. A. Bender and E. R. Canﬁeld. The asymptotic number of rooted maps on a surface.

Journal of Combinatorial Theory, Series A, 43(2):244–257, 1986.

[2] E. A. Bender, E. R. Canﬁeld, and L. B. Richmond. The asymptotic number of rooted maps on
a surface.: II. Enumeration by vertices and faces. J. Combin. Theory Ser. A, 63(2):318–329,
1993.

[3] E. A. Bender, Z. Gao, and L. B. Richmond. Almost all rooted maps have large representa-

tivity. Journal of Graph Theory, 18(6):545–555, 1994.

[4] E. A. Bender, Z. Gao, and N. C. Wormald. The number of labeled 2-connected planar graphs.

Electron. J. Combin., 9(1):Research Paper 43, 13 pp. (electronic), 2002.

[5] E. A. Bender and N. C. Wormald. The asymptotic number of rooted nonseparable maps on

a surface. Journal of Combinatorial Theory, Series A, 49(2):370–380, 1988.

[6] M. Bodirsky, C. Gr¨opl, and M. Kang. Generating unlabeled connected cubic planar graphs

uniformly at random. Random Structures Algorithms, 32(2):157–180, 2008.

[7] M. Bodirsky, M. Kang, M. L¨oﬄer, and C. McDiarmid. Random cubic planar graphs. Random

Struct. Alg., 30:78–94, 2007.

[8] W. G. Brown. Enumeration of triangulations of the disk. Proc. London Math. Soc., 14(4):746–

768, 1964.

[9] G. Chapuy, ´E. Fusy, O. Gim´enez, B. Mohar, and M. Noy. Asymptotic enumeration and limit

laws for graphs of ﬁxed genus. J. Combin. Theory Ser. A, 118(3):748–777, 2011.

[10] P. Flajolet and A. M. Odlyzko. Singularity analysis of generating functions. SIAM J. Discrete

Math., 3(2):216–240, 1990.

[11] P. Flajolet and R. Sedgewick. Analytic Combinatorics. Cambridge University Press, New

York, NY, USA, 2009.

[12] Z. Gao. The number of rooted 2-connected triangular maps on the projective plane. J. Com-

bin. Theory Ser. B, 53(1):130–142, 1991.

[13] Z. Gao. The asymptotic number of rooted 2-connected triangular maps on a surface. J.

Combin. Theory Ser. B, 54(1):102–112, 1992.

[14] Z. Gao. A pattern for the asymptotic number of rooted maps on surfaces. J. Combin. Theory

Ser. A, 64(2):246–264, 1993.

[15] Z. Gao and N. C. Wormald. Enumeration of rooted cubic planar maps. Ann. Comb., 6(3):313–

325, 2002.

[16] O. Gim´enez and M. Noy. Asymptotic enumeration and limit laws of planar graphs. J. Amer.

Math. Soc., 22(2):309–329, 2009.

36

[17] Ian P. Goulden and David M. Jackson. Combinatorial enumeration. Wiley-Interscience series
in discrete mathematics. J. Wiley & Sons, New York, Brisbane, Toronto, 1983. A Wiley-
Interscience publication.

[18] S. Janson, D. E. Knuth, T.  Luczak, and B. Pittel. The birth of the giant component. Random

Structures Algorithms, 4(3):231–358, 1993. With an introduction by the editors.

[19] S. Janson, T.  Luczak, and A. Rucinski. Random graphs. Wiley-Interscience Series in Discrete

Mathematics and Optimization. Wiley-Interscience, New York, 2000.

[20] M. Kang and T.  Luczak. Two critical periods in the evolution of random graphs. Trans. Am.

Math. Soc., 364(8):4239–4265, August 2012.

[21] M. Kang, M.Moßhammer, and P. Spr¨ussel. Sparse graphs on surfaces. In preparation.
[22] M. Kang and P. Spr¨ussel. Characterisation of symmetries of unlabelled triangulations and its

applications. Preprint, arXiv:1509.00581, 2015.

[23] M. Karo´nski and Z. Palka, editors. Random graphs ’85, volume 144 of North-Holland Math-
ematics Studies. North-Holland Publishing Co., Amsterdam, 1987. Papers from the second
international seminar on random graphs and probabilistic methods in combinatorics held at
Adam Mickiewicz University, Pozna´n, August 5–9, 1985, Annals of Discrete Mathematics,
33.

[24] C. McDiarmid, A. Steger, and D. J. A. Welsh. Random planar graphs. J. Comb. Theory Ser.

B, 93(2):187–205, 2005.

[25] M. Noy, V. Ravelomanana, and J. Ru´e. On the probability of planarity of a random graph

near the critical point. Proc. Amer. Math. Soc., 143(3):925–936, 2015.

[26] D. Osthus, H. J. Pr¨omel, and A. Taraz. On random planar graphs, the number of planar
graphs and their triangulations. Journal of Combinatorial Theory, Series B, 88(1):119–134,
2003.

[27] N. Robertson and R. Vitray. Representativity of surface embeddings. In B. Korte, L. Lov´asz,
H.J. Promel, and A. Schrijver, editors, Algorithms and Combinatorics, pages 293–328.
Springer, 1990.

[28] E.C. Titchmarsh. The Theory of Functions. Oxford science publications. Oxford University

Press, 1939.

[29] W. T. Tutte. A census of planar triangulations. Canad. J. Math., 14:21–38, 1962.
[30] W. T. Tutte. A census of planar maps. Canad. J. Math., 15:249–271, 1963.
[31] H. Whitney. Congruent graphs and the connectivity of graphs. Amer. J. Math., 54:150–168,

1932.

Appendix A. Proof of Propositions 3.6 and 3.7

We begin with notations. The valency of a face f in a map is the number of
corners of f . We call a rooted map M a quasi triangulation if all faces except
the root face fr are bounded by triangles. Let Pg be the class of simple quasi
triangulations and Pg(y, u) its generating function, where u marks the valency of
fr. Given an index set I and an injective function h : I → F (M ) \ {fr}, we call M
an I-quasi triangulation with respect to h if all faces in F (M ) \ (h(I) ∪ {fr}) are
bounded by triangles. If in addition fr is also bounded by a triangle, we say that M
is an I-triangulation (with respect to h). Let Sg,I and Pg,I be the classes of simple
I-triangulations and simple I-quasi triangulations, respectively; their generating
functions are denoted by S(y, zI) and P (y, u, zI), respectively. Here u again marks
the valency of the root face fr and zI = (zi)i∈I is a vector where zi marks the
valency of h(i).

Note that Sg = Sg,∅ and Pg = Pg,∅. In the case I = ∅ we will therefore always
use the generating functions Sg(y) and Pg(y, u) without mentioning variables zi.
To simplify notation the one-vertex map is contained in P0, although it is not a
quasi triangulation (since it does not have any corners and thus cannot be rooted).
We say that a face f is marked if f ∈ h(I) and that we are marking a face f if we
add a new index i to the set I with h(i) = f .

To prove Proposition 3.6 we ﬁrst derive a recursive formula relating Pg,I for
diﬀerent genera and diﬀerent sizes of the set I. We will then prove Proposition 3.6
by applying this formula inductively. In order to derive the recursive formula, we
will delete the root edge of a given quasi triangulation and then perform surgeries

37

that either separate the given surface or decrease its genus. One part of the reverse
operation then consists of adding a new edge to a map. Let S be a map and let
(not necessarily distinct) corners c1 = (v1, e−1 , e+
2 ) of the same
face f of S be given. If T is a map with V (T ) = V (S) and E(T ) = E(S) ∪ {enew},
we say that enew is an edge from c1 to c2 if

1 ) and c2 = (v2, e−2 , e+

• enew is contained in f and its end vertices are v1 and v2;
• in the cyclic order of edges of T at v1, enew is the predecessor of e+
• in the cyclic order of edges of T at v2, enew is the successor of e−2 .

1 ; and

If c1 = c2 =: c, we also say that enew is a loop at c.

Before we derive the recursive formula, we study the base case of planar quasi

triangulations.

Proposition A.1. The generating function of planar quasi triangulations satisﬁes

P0(y, u) = 1 + yu2P 2

0 (y, u) +

y(P0(y, u) − 1)

u

− y2uP0(y, u) − S0(y)(P0(y, u) − 1).
(35)

Proof. The ﬁrst summand in (35) corresponds to the one-vertex map. Let S ∈ P0
be a planar quasi triangulation with at least one edge. We distinguish two cases.

First suppose that the root edge er is a bridge; then the only face incident with
er is the root face fr. The union fr ∪ er is not a disc and thus contains a non-
contractible circle C. We delete er, cut along C, and close the two resulting holes
by inserting discs. By this surgery, S is separated into two quasi triangulations S1,
S2. Let v1 and v2 be the end vertices of er in S1 and S2, respectively. One of these
two vertices is the root vertex of S; by renaming S1, S2 we may assume that v1 is
the root vertex of S. In the cyclic order of the edges of S at v1, let e−1 and e+
1 be
the predecessor and successor of er, respectively. Deﬁne e−2 and e+
2 analogously at
v2. We let (v1, e−1 , e+
2 ) be the root of S1 and S2, respectively. We
thus have S1, S2 ∈ P0. Furthermore, S1 and S2 together have one edge less than S
and the sum of the valencies of their root faces is two less than the valency of fr.
Thus we obtain yu2P 2

0 (x, u), the second term of the right-hand side of (35).

1 ) and (v2, e−2 , e+

Now suppose that er is not a bridge. Then it lies on the boundary of the root
face and of another face; this face is bounded by a triangle. In the cyclic order
of edges at the root vertex vr, let e−r and e+
r be the predecessor and successor of
er, respectively. We delete er and obtain a quasi triangulation S′ that we root at
r ). The valency of the root face of S′ is larger by one than the valency
c′r := (vr, e−r , e+
of fr. This is reﬂected by y
u (P0(y, u) − 1), the third term of the right-hand side
of (35), because S′ cannot be the quasi triangulation consisting only of a single
vertex. However, with this summand we have overcounted.
Indeed, the reverse
construction is as follows. Let f′r be the root face of S′. Then the corners of f′r can
be ordered by walking along the boundary of f′r in counterclockwise direction. In
this order, starting from c′r, let c′ = (v, e, e′) be the corner after the next; then S
is obtained from S′ by inserting an edge from c′r to c′. If vr = v this results in a
loop; if vr and v are adjacent, we obtain a double edge (see Figure 5).

These cases have to be subtracted again in order to obtain a valid formula. First
suppose that vr = v. As we do not have double edges in S′, this is only possible
if the corner between c′r and c′ is at a vertex of degree one. We have to subtract
y2uP0(y, u), i.e. the fourth term of the right-hand side of (35), for this case (we add
one vertex and two edges to a quasi triangulation and increase the root face valency
by one). Now suppose that vr and v are adjacent, i.e.
inserting an edge between
them creates a double edge.
In this case zipping the double edge separates the
quasi triangulation into two quasi triangulations S1, S2. For one of them, without
loss of generality for S1, the root face valency is the same as for S, while the root

38

v

vr = v

P0

S0

P0

vr

Figure 5. Obtaining a loop or a double edge by inserting an edge.

face of S2 has valency three. Thus, S1 is in P0 but not the one-vertex map, while
S2 ∈ S0. Summing up we have to subtract S0(y)(P0(y, u) − 1), the ﬁfth term of the
right-hand side of (35).
(cid:3)

We can use the quadratic method (see e.g.

[17]) to obtain the main result for
planar triangulations from Proposition A.1. Those were already obtained by Tutte
[29] with slightly diﬀerent parameters.

Lemma A.2. The dominant singularity of S0(y) is ρS = 3
and satisﬁes

28/3 , S0(y) is ∆-analytic

S0(y) =

1
8

−

9

16(cid:0)1 − ρ−1

S y(cid:1) +

3

25/2 (cid:0)1 − ρ−1

S y(cid:1)3/2

+ O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)2(cid:17) .

(36)

Furthermore, for u = f (y) with

f (y) =

t1/3
1 + t

and

y = t1/3(1 − t),

hold and P0(y, f (y)) is ∆-analytic. Let n ≥ 2 be an integer. Then

3

25/2 (cid:0)1 − ρ−1

125 · 33/4

223/3

S y(cid:1)1/2
(cid:0)1 − ρ−1
S y(cid:1)−n/2+3/4

+ O(cid:0)1 − ρ−1
S y(cid:1) ,
S y(cid:1)1/4
+ O(cid:16)(cid:0)1 − ρ−1
+ O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)1/2(cid:17)
S y(cid:1)−n/2+1(cid:17) ,

= c(n)(cid:0)1 − ρ−1

the equations

P0(y, f (y)) =

5
4

−

=

∂u

75
213/3 −

P0(y, u)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)u=f (y)
(cid:18) ∂
(cid:18) ∂n
∂un P0(y, u)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)u=f (y)
(cid:0)2yu3P0(y, u) + q(y, u)(cid:1)2

where c(n) is a positive constant depending only on n.

Proof. Multiplying (35) by 4yu4 and rearranging the terms yields

= q(y, u)2 + 4y2u3 − 4yu4 − 4yu4S0(y),

(37)

where q(x, u) = y − y2u2 − u − uS0(y). Let
Q(y, u) = 2yu3P0(y, u) + q(y, u)
R(x, u) = q(y, u)2 + 4y2u3 − 4yu4 − 4yu4S0(y).

and

Then (37) reduces to Q2(y, u) = R(y, u). To obtain the claimed asymptotic be-
haviour one chooses u = f (y) in such a way that Q(y, f (y)) = 0. This u is a double
zero of Q2(y, u) and therefore both R(y, u) and ∂
∂u R(y, u) are 0 at u = f (y), giving
0 = q(y, u)2 + 4y2u3 − 4yu4 − 4yu4S0(y),
0 = 2q(y, u)(1 + S0(y) + 2y2u) + 16yu3 + 16yu3S0(y) − 12y2u2.

By eliminating f (y) from this system we obtain the implicit equation

S0(y)4 + 3S0(y)3 + S0(y)2(3 + 8y3) + S0(y)(1 − 20y3) = (1 − 16y3)y3.

39

By standard methods for implicitly given functions (e.g. [11, VII.7.1]) we obtain
the dominant singularity and the singular expansion of S0(y) as stated in (36).

1+t = y

Conversely, by eliminating S0(y) and substituting y = t1/3(1 − t) we obtain
f (y) = t1/3
1−t2 has only nonnegative
coeﬃcients in t and t = t(y) has only nonnegative coeﬃcients by Lagrange Inversion,
f (y) has only nonnegative coeﬃcients as well. From the implicit equation for f (y)
we deduce that

1−t2 and S0(y) = t(1 − 2t). Since

1

(38)

f (y) =

24/3

5

−

211/6

25 (cid:0)1 − ρ−1

S y(cid:1)1/2

+ O(cid:0)1 − ρ−1
S y(cid:1) .

From 2yf (y)3P0(y, f (y)) + q(y, f (y)) = Q(y, f (y)) = 0, (36), (38), and y = ρS −
ρS(1 − ρ−1

S y) we derive the claimed expression

P0(y, f (y)) =

5
4

−

3

25/2 (cid:0)1 − ρ−1

S y(cid:1)1/2

+ O(cid:0)1 − ρ−1
S y(cid:1) .

Given n ∈ N0, let us write R(n)(y, u) = ∂n

∂un R(y, u). By the choice of f (y) we
know that R(0)(y, f (y)) = R(1)(y, f (y)) = 0. As R(y, u) is a polynomial of degree
four in u, we have R(n)(y, u) = 0 for all n ≥ 5. For n ∈ {2, 3, 4}, we obtain the
dominant term of R(n)(y, f (y)) by ﬁrst diﬀerentiating R(y, u) with respect to u and
then substituting u = f (y), (36), (38), and y = ρS − ρS(1 − ρ−1

S y). This yields

R(2)(y, f (y)) =

R(3)(y, f (y)) = −

R(4)(y, f (y)) = −

27

675

S y(cid:1)1/2
27/2 (cid:0)1 − ρ−1
216/3 + O(cid:16)(cid:0)1 − ρ−1
223/3 + O(cid:16)(cid:0)1 − ρ−1

+ O(cid:0)1 − ρ−1
S y(cid:1) ,
S y(cid:1)1/2(cid:17) ,
S y(cid:1)1/2(cid:17) .

10125

We deﬁne Q(n)(y, u) and P (n)

0

that Q(y, f (y)) = 0 and ∂n

2nQ(1)(y, f (y))Q(n−1)(y, f (y)) = R(n)(y, f (y))

∂un (cid:0)Q2(y, u)(cid:1) = R(n)(y, u) we deduce that

(y, u) analogously to R(n)(y, u). From the facts

for every n ∈ N. For n = 2, this implies that

Q(1)(y, f (y)) = c(1 − ρ−1

k(cid:19)Q(k)(y, f (y))Q(n−k)(y, f (y))

(39)

−

n−2

Xk=2(cid:18)n
S y)1/4 + O(cid:16)(1 − ρ−1

S y)3/4(cid:17) ,

where c = ± 33/2
to u, we deduce that

211/4 . By diﬀerentiating Q(y, u) = 2yu3P0(y, u) + q(y, u) with respect

P (1)
0

(y, f (y)) =

75
213/3 + c

125

259/1233/4 (cid:0)1 − ρ−1

S y(cid:1)1/4

+ O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)1/2(cid:17) .

(y, u) is a generating function of a combinatorial class, its coeﬃcients
(y, u) are nonnegative. As f (y) has only nonnegative coeﬃcients as well,

(y, u)|u=f (y) are nonnegative, implying that c = − 33/2
211/4 .

Since P (1)
0
[ykul]P (1)
all coeﬃcients of P (1)

0

0

For n = 3, we deduce from (39) that

Q(2)(y, f (y)) = −

675
6c216/3 (1 − ρ−1

S y)−1/4 + O(cid:16)(1 − ρ−1

S y)1/4(cid:17) .

For n ≥ 4, the term R(n)(y, f (y)) is constant, while the sum on the right-hand side
is nonempty. Since the sum only involves terms Q(j)(y, f (y)) with 2 ≤ j ≤ n − 2,
we deduce by induction that

Q(n)(y, f (y)) = c(n)(cid:0)1 − ρ−1

S y(cid:1)−n/2+3/4

40

+ O(cid:16)(cid:0)1 − ρ−1

S y(cid:1)−n/2+5/4(cid:17) ,

(40)

where c(n) is a constant depending only on n and c(n) > 0 for n ≥ 2.

The claimed expressions of P (n)

0

(y, f (y)) are now obtained by diﬀerentiating

Q(y, u) = 2y2u3P0(y, u) + q(y, u)

n times and by (36), (38), (40), and induction.

As all generating functions in this proof are given by a system of algebraic
(cid:3)

equations, they are ∆-analytic.

Our next aim is to derive a recursion formula for Pg(y, u, zI). Using the planar
case in Lemma A.2 as the base case, inductively applying the recursion formula
allows us to derive similar statements as Lemma A.2 for all g and I.
In order
to derive the recursion formula, we will perform diﬀerent surgeries on the surface
depending on the placement of the root. We distinguish four cases.

(A) The root edge er is only incident with the root face fr and is a bridge;
(B) er is only incident with fr and is not a bridge;
(C) er is incident with fr and one marked face; and
(D) er is incident with fr and one unmarked face.

The recursion formula is then of the form

Pg(y, u, zI) = Ag(y, u, zI) + Bg(y, u, zI) + Cg(y, u, zI) + Dg(y, u, zI),

(41)

where Ag(y, u, zI), Bg(y, u, zI), Cg(y, u, zI), and Dg(y, u, zI) are the generating
functions of the sub-classes Ag,I , Bg,I , Cg,I , and Dg,I of Pg,I corresponding to the
four cases (A), (B), (C), and (D), respectively. Each of the generating functions
can be further decomposed as

Ag(y, u, zI) = a(y, u)Pg(y, u, zI) + MA(g; y, u, zI) − EA(g; y, u, zI),
Bg(y, u, zI) = b(y, u)Pg(y, u, zI) + MB(g; y, u, zI) − EB(g; y, u, zI),
Cg(y, u, zI) = c(y, u)Pg(y, u, zI) + MC(g; y, u, zI) − EC (g; y, u, zI),
Dg(y, u, zI) = d(y, u)Pg(y, u, zI) + MD(g; y, u, zI) − ED(g; y, u, zI),

(42)

where a(y, u), b(y, u), c(y, u), and d(y, u) will be functions only involving the gener-
ating functions P0 and S0 of the planar case, while the other functions will involve
terms of the type Pg′ (y, u, zI ′) for g′ < g or I′ ( I. This will enable us to use
(41) to recursively determine the dominant terms of Pg(y, u, zI). In this recursion,
the functions MA, MB, MC, and MD will contribute to the dominant term; the
functions EA, EB, EC , and ED will turn out to be of smaller order.

We start by determining the functions for Case (A). In this case, after deleting

the root edge we can split the map into two maps whose genera add up to g.

Lemma A.3. The functions a(y, u, zI), MA(g; y, u, zI), and EA(g; y, u, zI) in (42)
are given by

a(y, u, zI) = 2yu2P0(y, u),

MA(g; y, u, zI) = yu2Xt,J

EA(g; y, u, zI) = 0.

Pt (y, u, zJ) Pg−t(cid:0)y, u, zI\J(cid:1) ,

The sum is over t = 0, . . . , g and J ⊆ I such that (t, J) 6= (0, ∅) and (t, J) 6= (g, I).

Proof. Let S be an I-quasi triangulation in Ag,I , with respect to h : I → F (S), say.
By (A), the union fr ∪ er is not a disc and thus contains a non-contractible circle
C. We delete er, cut along C, and close the two resulting holes by inserting discs.
Since er was a bridge, this surgery results in two components S1 and S2. We deﬁne
the roots of S1 and S2 like in Proposition A.1: let v1 and v2 be the end vertices of
er in S1 and S2, respectively. Without loss of generality we may assume that v1

41

is the root vertex of S. In the cyclic order of the edges of S at v1, let e−1 and e+
1
be the predecessor and successor of er, respectively. Deﬁne e−2 and e+
2 analogously
at v2. We let (v1, e−1 , e+
2 ) be the root of S1 and S2, respectively.
Denote the root faces by f1 and f2, respectively. These are the faces of S1 and S2
into which the discs were inserted.

1 ) and (v2, e−2 , e+

Since every face in F (S) \ {fr} corresponds to a face in F (S1) \ {f1} or in
F (S2) \ {f2}, h induces a function ˜h : I → (F (S1) ∪ F (S2)) \ {f1, f2}. If we write
J = ˜h−1(F (S1)), then S1 is a J-quasi triangulation on a surface of genus t ≤ g;
consequently, S2 is an (I \ J)-quasi triangulation on a surface of genus g − t. By
deleting er, we decreased the number of corners of fr by two; the surgery then
distributed the remaining corners of fr to f1 and f2. Therefore, the sum of valencies
of f1 and f2 is smaller by two than the valency of fr. On the other hand, we clearly
have |E(S1)| + |E(S2)| = |E(S)| − 1. The reverse operation of the surgery is to
delete an open disc from each of f1, f2, glue the surfaces along the boundaries of
these discs, and add an edge from the root corner of S1 to the root corner of S2.
As this operation is uniquely deﬁned, we deduce that

Ag(y, u, zI) = yu2

g

Xt=0XJ⊆I

Pt (y, u, zJ) Pg−t(cid:0)y, u, zi\J(cid:1) .

Extracting the terms for (t, J) = (0, ∅) and (t, J) = (g, I) ﬁnishes the proof.

(cid:3)

For Case (B), we will cut the surface along a circle contained in fr ∪ er and close
the holes by inserting discs. However, because the surface will not be separated
by this surgery, one needs to keep track of where to cut and glue (to reverse the
surgery). To this end we have to mark faces. Therefore, the index set I will increase.

Lemma A.4. The functions b(y, u, zI), MB(g; y, u, zI), and EB(g; y, u, zI) in (42)
are given by

b(y, u, zI) = 0,

MB(g; y, u, zI) = yu2δzi0 (cid:0)Pg−1(y, u, zI∪{i0})(cid:1)(cid:12)(cid:12)zi0 =u,
EB(g; y, u, zI) (cid:22)(cid:0)1 + yu2(cid:1) δu (Pg−1(y, u, zI)) .

Proof. Let S be an I-quasi triangulation in Bg,I , with respect to h : I → F (S), say.
We use the analogous surgery as in Lemma A.3, with the diﬀerence that S is not
separated by cutting along the circle C. Therefore we only obtain one map T . One
of the end vertices of er is the root vertex vr of S. Let e−r and e+
r be the predecessor
and successor of er in the cyclic order of edges of S at vr, respectively. Then we
deﬁne the root of T to be (vr, e−r , e+
r ). Denote the root face of T by f′r; this is one
of the two faces into which we inserted discs to close the holes during our surgery.
Denote the other such face by f2. We mark f2 by adding a new index i0 to the
index set I and extend the function h to I ∪ {i0} by setting h(i0) := f2. Then T is
an (I ∪ {i0})-quasi triangulation on Sg−1.

To reverse the surgery, we delete an open disc from each of f′r, f2, glue the surface
along the boundaries of these discs, add a new edge enew from the root corner of T to
a corner c2 of f2, and let (vr, enew, e+
r ) be the new root corner. We thus have to mark
to the generating
a corner of f2, which corresponds to applying the operator δzi0
function. After glueing, the corners of f2 become corners of the new root face; we
thus have to remove i0 from the index set and replace zi0 by u in the generating
function. Like in the previous cases, adding enew increases the total number of edges
by one and the valency of the root face by two, as enew lies only on the boundary

of the new root face. This results in the term yu2δzi0 (cid:0)Pg−1(y, u, zI∪{i0})(cid:1) |zi0 =u.

42

However, by this construction we have overcounted. If the vertex v of the corner
c2 is adjacent to vr, then enew will be part of a double edge; if v = vr, enew will be
a loop. We want to subtract all resulting maps ˜S for which enew is a loop or part of
a double edge. Suppose ﬁrst that enew is part of a double edge. Since enew lies only
on the boundary of the root face of ˜S, the double edge is not separating. Thus,
zipping it results in an I-quasi triangulation ˜T on Sg−1. One of the two zipped
edges is the root edge e′r of ˜T , denote the other zipped edge by e′. Both e′r and e′
lie on the boundary of the root face (see Figure 6). Let v′r be the root vertex of
˜T ; then v′r is one of the two copies of vr. If we denote the other copy by v′, then
v′ is an end vertex of e′ and thus there is a corner c′ = (v′, e′′, e′) of the root face
of ˜T . We can reconstruct ˜S from ˜T in the following way: cut along e′r and e′ and
glue the surface along the boundaries of the resulting holes in the unique way that
identiﬁes v′r and v′. Identifying the corner c′ is bounded by marking an arbitrary
corner of the root face of ˜T . This corresponds to applying the operator δu to the
generating function Pg−1(y, u, zI). As zipping a double edge does neither change
the number of edges nor the valencies of faces, δu (Pg−1(y, u, zI)) is an upper bound
in this case.

Suppose now that enew is a loop and recall that (vr, enew, e+

r ) is the root corner
of ˜S. Since enew lies only on the boundary of the root face of ˜S, there is a unique
edge e2 6= e+
r such that (vr, enew, e2) is a corner of the root face. We cut along enew,
close the two resulting holes by inserting discs, and delete the two copies of enew.
Again, cutting does not separate the surface. Thus, we obtain a map ˜T on Sg−1
that does not have loops or double edges. Let v′r be the copy of vr in ˜T that is
incident with e+
r ) for
some edge e′. Furthermore, the root face of ˜T has a corner (v′2, e′2, e2). Now ˜S can
be reconstructed from ˜T in the following way (see Figure 6).

r and let v′2 be the other copy. Then the root of ˜T is (v′r, e′, e+

(i) Add a loop at each of (v′r, e′, e+
(ii) delete the resulting two faces of valency one;
(iii) identify the two loops.

r ) and (v′2, e′2, e2);

v′r

e′r

v′

e′

v′r

v′2

Figure 6. Deriving an upper bound for EB.

In order to identify the corner (v′2, e′2, e2), we mark an arbitrary corner of the
root face, which is again overcounting. Since we have to add one edge to ˜T and
increase the valency of the root face by two to reconstruct ˜S, we have an additional
factor of yu2, resulting in the claimed upper bound for EB.
(cid:3)

In Case (C), the root edge is not a bridge. Therefore, we will not be able to ﬁnd
a circle C like in the previous two cases. On the other hand, deleting the root edge
does not produce any faces that are not discs. Our construction in this case will
thus start without cutting the surface.

43

Lemma A.5. The functions c(y, u, zI), MC(g; y, u, zI), and EC (g; y, u, zI) in (42)
are given by

c(y, u, zI) = 0,

MC(g; y, u, zI) = yXi∈I XT∈Pg (I\{i})
EC (g; y, u, zI) (cid:22) Xi∈I (cid:18) (1 + yuzi) δzi (Pg−1(y, u, zI))

y|E(T )|Yj6=i

zβj(T )
j

g

β(T )+1

Xk=1

ukzβ(T )+2−k

i

,

+ (1 + yuzi)

Xt=0 XJ⊆I\{i}

Pt(y, u, zJ)Pg−t(y, zi, zI\(J∪{i}))(cid:19),

where β(T ) and βj(T ) denote the valencies of the root face of T and of the face
with index j in T , respectively.

Note that the sum in MC is over all i ∈ I and all I \ {i}-quasi triangulations.

As such, MC can be written as

MC = yXi∈I

u2ziPg(y, u, zI\{i}) − uz2

i Pg(y, zi, zI\{i})

u − zi

.

However, similarly to Lemma A.2, we will replace u and zi by f (y) in order to derive
the desired asymptotic formulas, which would result in a division by 0. For that
reason we will use MC as stated in Lemma A.5. We will derive a more convenient
formulation in Proposition A.7.

Proof of Lemma A.5. Let S be an I-quasi triangulation in Cg,I , with respect to
h : I → F (S), say. We delete the root edge er, thus obtaining a map T on Sg. The
root of T is deﬁned as follows. Let e−r and e+
r be the predecessor and successor of
er at vr, respectively; then (vr, e−r , e+
r ) is the root of T . By (C), er was incident
with a marked face h(i). The root face of T is f′r := fr ∪ er ∪ h(i) and T is an
(I \ {i})-quasi triangulation with respect to h|I\{i}.

Let c be a corner of f′r and let ˜S be obtained from T by adding an edge enew

from (vr, e−r , e+

r ) to c and let the root of ˜S be
r ) and

r ) if c 6= (vr, e−r , e+

• (vr, enew, e+
• either (vr, enew, e+

r ) or (vr, enew, enew) otherwise,

see Figure 7. Adding enew divides f′r into two faces. One of these faces is the root
face of ˜S; we mark the other face with the index i and denote the corresponding
function I → F ( ˜S) by ˜h. Clearly, there is a unique choice of c 6= (vr, e−r , e+
r ) such
that ˜S = S. If c is a corner at vr (in particular if c = (vr, e−r , e+
r )), then enew will be
a loop. If c is a corner at a vertex adjacent to vr, then enew will be part of a double
edge. In either case, ˜S will not be simple and thus not an I-quasi triangulation.
r ) is clearly one of the cases when ˜S is not simple,
Although the case c = (vr, e−r , e+
it is slightly easier to derive the formulas including this case.

As f′r has valency β(T ), there are β(T ) + 1 choices for ˜S. The valency of the
root face of ˜S is one if c = (vr, e−r , e+
If
c = (vr, e−r , e+
r ), the valency is β(T )+1. Depending
on which corner is chosen as c, the valency of the root face can take any value k
between one and β(T ) + 1; the face ˜h(i) then has valency β(T ) + 2 − k. The
generating function of maps that can occur as ˜S from this particular (I \ {i})-quasi

r ) and the root face is (vr, enew, enew).

r ) and the root face is (vr, enew, e+

44

e+
r

vr
e−r

enew

˜h(i)

fr

c

e+
r

vr
e−r

enew

Figure 7. Adding the edge enew from (vr, e−r , e+
˜S. If c = (vr, e−r , e+
root face or ˜h(i).

r ) to c to obtain
r ), then each of the two faces can either be the

triangulation T is thus given by

y|E(T )+1| Yj∈I\{i}

zβj(T )
j

β(T )+1

Xk=1

ukzβ(T )+2−k

i

.

This holds as the number of edges is increased by one and the valencies of all other
marked faces do not change. After summing over all possible marked faces and all
possible T , we obtain MC .

As already mentioned, we overcount whenever the chosen corner c is at vr or at
a vertex adjacent to vr, making enew a loop or part of a double edge, respectively.
Suppose ﬁrst that enew is part of a double edge. We zip the double edge. If it does
not separate the surface, we have an upper bound δzi(Pg−1(y, u, zI)) analogous to
Lemma A.4. Indeed, the only diﬀerence to the corresponding case in Lemma A.4
is that we mark a corner of (the face corresponding to) ˜h(i) instead of a corner
of the root face, because enew was incident with both the root face and ˜h(i). If
the double edge separates the surface, we obtain two maps T1 on St for 0 ≤ t ≤ g
and T2 on Sg−t. One of the two maps, without loss of generality T2, contains (the
face corresponding to) ˜h(i). As T2 is rooted at a corner of that face and the root
face is never marked, the number of marks decreases by one. Thus, T1 is a J-quasi
triangulation on St and T2 is a (I \ (J ∪ {i}))-quasi triangulation on Sg−t, where
J ⊆ I \ {i}. Going back, all corners of the root face of T2 become corners of the
face with index i, meaning that we have to replace u by zi in Pg−t(x, zi, zI\(J∪{i})).
This gives us an upper bound of

g

Xt=0 XJ⊆I\{i}

Pt(x, u, J)Pg−t(x, zi, zI\(J∪{i})).

If enew is a loop, then we proceed the same way as in Lemma A.4: we cut along
enew, close the two resulting holes by inserting discs, and delete the two copies of
enew. Like in Lemma A.4, the reverse construction yields the same bounds as in
the case of enew being part of a double edge; the additional factor yuzi is due to
the fact that we add one edge and increase the valencies of the root face and of ˜h(i)
by one.
(cid:3)

The construction in Case (D) is similar to Case (C). The fact that the second

face incident with er is not marked makes the analysis easier.

45

Lemma A.6. The functions d(y, u, zI), MD(g; y, u, zI), and ED(g; y, u, zI) in (42)
are given by

d(y, u, zI ) = yu−1 − y2u − S0(y),
MD(g; y, u, zI) = −Sg(y, zI)P0(y, u),

ED(g; y, u, zI) (cid:22) Xt,J

St(y, J)Pg−t(y, u, zI\J)

+ 3Pg−1(y, u, zI∪{i0})|zi0 =u.

The sum is over t = 0, . . . , g and J ⊆ I such that (t, J) 6= (0, ∅) and (t, J) 6= (g, I).

Proof. Let S be an I-quasi triangulation in Dg,I . We delete er and choose the
root of the resulting map T to be c′r := (vr, e−r , e+
r ) like in Lemma A.5. As the
second face f incident with er is not marked and S is an I-quasi triangulation, f is
bounded by a triangle. Thus, T is also an I-quasi triangulation and the valency of
its root face f′r is larger by one than the valency of fr. For the reverse construction,
consider the ordering of the corners of f′r in clockwise direction along its boundary
and let c be the corner after the next, starting from c′r. We add an edge enew from
r ) be the root of the resulting I-quasi triangulation ˜S. If
c′r to c and let (vr, enew, e+
T was obtained from S by deleting er, then ˜S = S. However, if T is an arbitrary
I-quasi triangulation on Sg, then enew might be a loop or part of a double edge.
Thus,

(43)
is only an upper bound for Dg(y, u, zI). Again, we have to subtract the cases when
˜S is not simple.

yu−1Pg(y, u, zI)

The case when enew is a loop yields a term of
−y2uPg(x, u, zI )

(44)

analogously to Proposition A.1. When enew is part of a double edge, we need to
distinguish whether this double edge separates the surface. If it does separate, we
obtain

g

−

Xt=0XJ⊆I

St(y, J)Pg−t(y, u, zI\J)

(45)

by zipping the double edge, similar to Lemma A.3. The only diﬀerences are that
the number of edges and the valencies of the faces do not change and that one of the
two components is a J-triangulation, since its root face is f and thus has valency
three. Finally, if the double edge does not separate, then after zipping it we have
to mark f with a new index i0 like in Lemma A.4. However, since the valency of
f is three, we only have three possibilities how to reverse the construction. As the
number of edges and all valencies remain unchanged, we have a summand

−3Pg−1(y, u, zI∪{i0})|zi0 =u .

(46)

Note that (46) is overcounting as the reverse construction can lead to additional
loops or double edges.

Combining (43), (44), and the term from (45) with (t, J) = (0, ∅), we deduce the
claimed expression for d(y, u, zI ). The term from (45) with (t, J) = (g, I) yields
MD(g; y, u, zI); the remaining terms form the upper bound for ED(g; y, u, zI). (cid:3)

The only term having a diﬀerent structure than the others is MC which cannot be
easily expressed in terms of Pg′ (y, u, zI ′) and Sg′ (y, I′) with some genus g′ and set
I′. From MB and EB we observe that we need to calculate derivatives with respect
to u and zi0 and that we want to set zi0 = u in the end. We will be interested in
the dominant term of Pg(y, u, zI) when we set u = f (y) and zi = f (y) for all i ∈ I;

46

we will abbreviate this by u = zI = f (y). Observe that setting u = zI = f (y) does
not have any inﬂuence on the functions Sg(y), as they only depend on the variable
y.

The following proposition enables us to express arbitrary derivatives of MC at

u = zI = f (y) in terms of derivatives of Pg.

Proposition A.7. Let |y| < ρS, n ∈ N0, and αi ∈ N0 for all i ∈ I. Write |αI | for

∂n+|αI|

P αi. Then
∂unQi∈I ∂zαi
= y Xi∈I

i

n!αi!

∂n+1+|αI|

(n + αi + 1)!

MC(g; y, u, zI)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)u=zI =f (y)
∂un+1+αiQj∈I\{i}
yu3Pg(y, u, zI\{i}) = y XT∈Pg (I\{i})

(47)

.

∂zαj
j

(cid:0)u3Pg(y, u, zI\{i})(cid:1)!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)u=zI =f (y)
y|E(T )|uβ(T )+3 Yj∈I\{i}

zβj(T )
j

.

Proof. The generating function yu3Pg(y, u, zI\{i}) is given by

By comparing this term with the summand in

MC(g; y, u, zI) = yXi∈I XT∈Pg (I\{i})

y|E(T )|Yj6=i

zβj(T )
j

β(T )+1

Xk=1

ukzβ(T )+2−k

i

for a ﬁxed index i ∈ I, one sees that the diﬀerence between them is that the factor
. Taking the derivatives with respect
to u and zi the given number of times and comparing the coeﬃcients yields factors

uβ(T )+3 is replaced by Pβ(T )+1

ukzβ(T )+2−k

k=1

i

(β(T ) + 3)!

(β(T ) + 2 − n − αi)!

uβ(T )+2−n−αi

and

β(T )+2−αi

Xk=n

k!(β(T ) + 2 − k)!

(k − n)!(β(T ) + 2 − k − αi)!

uβ(T )+2−n−αi,

respectively, when n + αi + 1 ≤ β(T ) + 3 and factors 0 otherwise. The quotient of
(n+αi+1)! by a binomial identity. Summing over i ∈ I
these two coeﬃcients equals
ﬁnishes the proof.
(cid:3)

n!αi!

The only other term where diﬀerentiating is not straight forward is MB. By

using the chain rule n times we obtain

∂n+|αI|

∂unQi∈I ∂zαi

i

=

MB(g; y, u, zI)

(48)

Pg−1(cid:0)y, u, zI∪{i0}(cid:1)(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)zi0 =u!

∂n+|αI|

n

∂unQi∈I ∂zαi
k(cid:19) 
Xk=0(cid:18)n

∂zi0

∂

i  yu2(cid:18)zi0
∂un−kQi∈I ∂zαi

∂n−k+|αI|

i

i0

=y

of Sg and Pg.

∂k+1
∂zk+1

Using (47) and (48) we can now determine the dominant terms of the derivatives

(cid:0)u3Pg−1(cid:0)y, u, zI∪{i0}(cid:1)(cid:1)!(cid:12)(cid:12)(cid:12)(cid:12)zi0 =u
Theorem A.8. Let αi ∈ N0, i ∈ I, and |αI | :=P αi. If (g, I) 6= (0, ∅), then
S y(cid:1)e1+1/4(cid:17) ,
Q ∂zαi

S y(cid:1)e1 + O(cid:16)(cid:0)1 − ρ−1

∼= a0 + cg(cid:0)1 − ρ−1

Sg(y, zI)(cid:12)(cid:12)(cid:12)(cid:12)zI =f (y)

∂|αI |

(49)

47

i

.

where a0 and cg = cg(αi, i ∈ I) are positive constants and

e1 = −

5g
2

−

5|I|

4

−

|αI |

2

+

3
2

.

∂n

∂n+|αI|

∂un P0(y, u)(cid:12)(cid:12)u=f (y) is given as in Lemma A.2. If (g, I, n) 6= (0, ∅, 0), then
∂unQ ∂zαi

S y(cid:1)e2 + O(cid:16)(cid:0)1 − ρ−1

Pg(y, u, zI)(cid:12)(cid:12)(cid:12)(cid:12)u=zI =f (y)

where c = c(g, |I|, n, |αI |) is a positive constant and

∼= c(cid:0)1 − ρ−1

i

S y(cid:1)e2+1/4(cid:17) , (50)

e2 = e1 −

n
2

−

3
4

.

Proof. We show this by induction on (g, |I|, n) in lexicographic order. Lemma A.2
shows that (50) is true for (g, I) = (0, ∅) and n > 0. Note that |αI | = 0 for I = ∅.
Suppose now that (50) is true for all (g, |I|, n) < (g0, |I0|, 0) and (49) is true for
all (g, |I|) < (g0, |I0|) with (g, I) 6= (0, ∅). We ﬁrst prove that (49) then holds for
(g0, |I0|). By multiplying (41) by u and applying Lemmas A.3 to A.6 we obtain

u(1 − a − d)Pg0 (y, u, zI0) = u(MA + MB + MC) − uSg0(y, zI0 )P0(y, u) − uE,

where E = EB + EC + ED. The term

u(1 − a − d) = u − 2yu3P0(y, u) − uS0(y) − y + y2u2

is equal to −Q(y, u) in (37) and thus

−Q(y, u)Pg0(y, u, zI0) = u(MA + MB + MC) − uSg0(y, zI0 )P0(y, u) − uE.

(51)

Therefore, the left-hand side is zero when replacing u by f (y). As this factor is
independent of zI0 , this does also hold when diﬀerentiating the equation αi times
with respect to zi. Thus we obtain

∂|αI0|Sg0(y, zI0 )

uP0(y, u)

i

Q ∂zαi

= u

(cid:12)(cid:12)(cid:12)(cid:12)u=zI0 =f (y)

By inspecting the formulas for MA to ED in Lemmas A.3 to A.6 one sees that
all occurring terms are lexicographically smaller than (g0, |I0|, 0) and therefore the
induction hypothesis can be used. Inspection of the exponents of (1 − ρ−1
S y) in all
those terms shows the following.

∂|αI0|(MA + MB + MC − E)

i

Q ∂zαi

.

(cid:12)(cid:12)(cid:12)(cid:12)u=zI0 =f (y)

MA: The summands have the form

∂|αI0|

i

Q ∂zαi

(cid:0)Pt (y, u, zJ) Pg0−t(cid:0)y, u, zI0\J(cid:1)(cid:1)

for (t, J) 6= (0, ∅) and (t, J) 6= (g0, I0). Thus, for g0 + |I0| ≤ 1, we have
MA = 0. For all other values of (g0, |I0|), each summand is of the form
cA(1 − ρ−1

S y)mA + O(cid:0)(1 − ρ−1

S y)mA+1/4(cid:1) with

5(g0 − t)

|αJ |

5|J|

5|I0 \ J|

mA = −

5t
2

−

−

4

+

−

3
4

2

2

−

4

−

|αI0\J |

2

+

3
4

= e1

by induction. Furthermore, all coeﬃcients are positive by induction.

MB: We have MB = yu2δzi0 (cid:0)Pg0−1(y, u, zI∪{i0})(cid:1) |zi0 =u. Thus, for g0 = 0 we
S y)mB +1/4(cid:1)

have MB = 0 and otherwise MB = cB(1−ρ−1
with

S y)mB +O(cid:0)(1 − ρ−1

5(g0 − 1)

5|I0 ∪ {i0}|

|αI0 | + 1

mB = −

−

2

4

−

2

+

= e1

3
4

by induction. Again, the coeﬃcient is positive by induction.

48

MC: We determine the expression for MC by Proposition A.7. For g0 = 0 and

|I0| = 1 we have MC ∼= cC,1(1 − ρ−1
of the desired order, since e1 = 1/4 in this case. For all other (g0, I0),
induction yields that MC = cC,2(1 − ρ−1
with

S y)1/4 + O(cid:0)(1 − ρ−1

S y)1/2(cid:1), which is
S y)mC +1/4(cid:1)

S y)mC + O(cid:0)(1 − ρ−1

mC = −

5g0
2

−

5(|I0| − 1)

4

−

|αI0 |

2

−

+

= e1 .

1
2

3
4

Like in the previous cases, the coeﬃcient is positive by induction.

EB: The function EB is bounded from above by(cid:0)yu2 + 1(cid:1) δu (Pg0−1(y, u, zI0)).
S y)eB(cid:1)

For g0 = 0, we thus have EB = 0 and otherwise EB = O(cid:0)(1 − ρ−1

with

eB = −

5(g0 − 1)

5|I0|

|αI0 |

−

−

2

4

2

−

+

≥ e1 +

1
2

3
4

1
4

.

EC : The ﬁrst summand in the expression of EC from Lemma A.5 is 0 if g0 = 0

and otherwise O((1 − ρ−1

S y)eC,1 ) with

eC,1 = −

5(g0 − 1)

2

−

5|I0|

4

−

|αI0 | + 1

2

+

3
4

≥ e1 +

1
4

.

The second summand is aE + O(cid:0)(1 − ρ−1

Suppose (g0, |I0|) 6= (0, 1). Then every term

S y)1/2(cid:1) if g0 = 0 and |I0| = 1.

(1 + yuzi) Pt(y, u, zJ)Pg−t(y, zi, zI\(J∪{i}))

with (t, J) 6= (0, ∅) and (t, J) 6= (g0, I0 \ {i}) is O((1 − ρ−1

5|J|

4

−

|αJ |

2

+

3
4

−

5(g0 − t)

2

−

5(|I0 \ J| − 1)

4

−

eC,2 = −

5t
2

≥ e1 +

−

1
4

S y)eC,2 ) with
|αI0\J | − αi

+

2

3
4

by induction. The corresponding terms for (t, J) = (0, ∅) and (t, J) =

−

5g0
2

eC,3 = −

|αI0 | − αi

5(|I0| − 1)

S y)eC,3(cid:1) with

(g0, I0 \ {i}) are O(cid:0)(1 − ρ−1
In total, we have EC = O(cid:0)(1 − ρ−1
|I0| ≤ 1 and otherwise each of its summands is O(cid:0)(1 − ρ−1
S y)eD,1(cid:1) with
|αI0\J |

S y)e1+1/4(cid:1).

5(g0 − t)

5|I0 \ J|

≥ e1 +

1
4

.

ED: The ﬁrst summand in the expression of ED from Lemma A.6 is 0 if g0 +

|αJ |

5|J|

3
4

−

+

2

4

eD,1 = −

−

+

−

−

−

−

4

2

2

4

2

+

3
4

5t
2

3
2

≥ e1 +

1
4

by induction. The second term is 0 for g0 = 0 and O(cid:0)(1 − ρ−1

otherwise with

S y)eD,2(cid:1)

eD,2 = −

5(g0 − 1)

5(|I0| + 1)

|αI0 |

−

2

4

−

2

+

≥ e1 +

3
4

1
4

.

Combining these results, we have proved (49), where a0 = aM − aE for g0 = 0 and
|I0| = 1. As this constant is the value of the generating function S0(y, zI0)|zI0 =f (y)
at its singularity ρS, a0 is positive. For |αI0 | > 0 or (g0, |I0|) 6= (0, 1), the exponent
e1 is negative and thus (49) is true with the same value for a0. Finally, cg is positive,
since it is the sum of positive numbers.

To prove (50), recall that we assume that (50) is true for (g, |I|, n) < (g0, |I0|, 0)
and we have already shown that (49) is true for (g, |I|) ≤ (g0, |I0|). Let n0 ∈ N0 and

49

assume that (50) is also true for (g0, |I0|, n) with n < n0. Consider the derivative
∂n+1
∂un+1 of (51) and set u = f (y); as Q(y, f (y)) = 0, this yields

for the left-hand side of (51). For the derivatives of MA, MB, and MC, we obtain

−

n

Xk=0(cid:18)n + 1

k (cid:19) ∂k

∂uk Pg0 (y, u, zI0)

∂n+1−k

∂un+1−k Q(y, u)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)u=zI0 =f (y)
S y)mA+1/4(cid:17) ,
S y)mB +1/4(cid:17) ,
S y)mC +1/4(cid:17)

S y)mA + O(cid:16)(1 − ρ−1
S y)mB + O(cid:16)(1 − ρ−1
S y)mC + O(cid:16)(1 − ρ−1

MA = cA(1 − ρ−1

MB = cB(1 − ρ−1

MC = cC (1 − ρ−1

with positive constants cA, cB, cC and mA = mB = mC = e1 − n+1
4 . For
the derivatives of EB, EC , and ED the exponents eB, eC,1, . . . in the considerations
above become smaller by n+1
as well. By (40) and the induction hypothesis, each
2
term

2 = e2 + 1

∂k
∂uk Pg0 (y, u, zI0)
for k < n is of the form c(k)(1 − ρ−1
with c(k) > 0. Since ∂
c < 0, (50) follows.

∂n+1−k

∂un+1−k Q(y, u)(cid:12)(cid:12)(cid:12)(cid:12)u=zI0 =f (y)
S y)e1−(n+1)/2 + O(cid:0)(1 − ρ−1

∂u Q(y, u)|u=f (y) = c(1 − ρ−1

S y)1/4 + O(cid:0)(1 − ρ−1

S y)e1−(n+1)/2+1/4(cid:1)
S y)1/2(cid:1) with

(cid:3)

By Lemma A.2 and setting I = ∅ in (49) we obtain Proposition 3.6.
An analogous result can be obtained for I-quasi triangulations where double
edges are allowed. We will denote the analogous generating functions with hats.
To show Proposition 3.7 we will use the same method as for Proposition 3.6 and
will just point out the diﬀerences. The analogous equation to Equation (35) is

ˆP0(y, u) = 1+yu2 ˆP 2

0 (y, u)+

y( ˆP0(y, u) − 1)

u

−y2u ˆP0(y, u)−y2u ˆS0(y) ˆP0(y, u). (52)

This is due to the fact that double edges are allowed and thus the ﬁnal case in the
proof of Equation (35) does not have to be considered. Conversely, if the root is a
loop, the exceptional set is now larger, because the single edge is not the only quasi
triangulation with root face valency two any more.

By doing the same calculations as in Lemma A.2 for (52) we obtain the dominant

singularity at 21/3
3 and
1
9
8

ˆS0(y) =

−

8(cid:16)1 − ρ−1

ˆS

y(cid:17) + 3(cid:16)1 − ρ−1

ˆS

y(cid:17)3/2

+ O(cid:18)(cid:16)1 − ρ−1

ˆS

y(cid:17)2(cid:19) .

In the general case we distinguish the same four cases. Case A (Lemma A.3)
works in the same way. In the other three cases (Lemmas A.4 to A.6) the error
term concerning double edges does not appear and the term dealing with loops
will be modiﬁed similar to the planar case. Thus we obtain an analogous recursion
formula and obtain the same results as in Theorem A.8 with (1 − ρ−1
y) instead of
ˆS
(1 − ρ−1
S y) but with the same exponent. Thus Proposition 3.7 follows.

50

