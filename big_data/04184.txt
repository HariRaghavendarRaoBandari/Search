ARX modeling of unstable Box-Jenkins models (cid:63)

Miguel Galrinho a, Niklas Everitt a, H˚akan Hjalmarsson a

aACCESS Linnaeus Center, School of Electrical Engineering, KTH – Royal Institute of Technology, Sweden

6
1
0
2

 
r
a

 

M
4
1

 
 
]

Y
S
.
s
c
[
 
 

1
v
4
8
1
4
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

The use of high-order polynomial models that are linear in the parameters is common in system identiﬁcation to avoid the non-convexity of
the prediction error method when applied to other model structures. A common and fairly general case is to use high-order ARX models to
approximate Box-Jenkins structures. Then, a well known correspondence is made between the ARX polynomials and the plant and noise
models in the Box-Jenkins structure. However, this commonly used result is only valid when the Box-Jenkins predictor is stable. In this
contribution, we generalize these results to allow for unstable predictors due to an unstable plant. We show that high-order ARX models
are appropriate for this situation as well. However, corrections must be made to correctly retrieve the noise model and noise variance.

Key words: System identiﬁcation; polynomial models; closed-loop identiﬁcation.

1

Introduction

System identiﬁcation deals with obtaining mathematical
models for systems using experimental data. To obtain such
models, the prediction error method (PEM) is a bench-
mark in the ﬁeld, since it provides asymptotically efﬁcient
estimates if the chosen model orders are correct [1]. The
drawback with PEM is that, in general, it requires solving
a non-convex optimization problem, and the global min-
imum may not be attained. A procedure to improve the
convergence properties of PEM through input design has
been presented in [2]. Moreover, for some particular model
structures, minimizing the cost function of PEM consists
simply in solving a linear regression problem. This is the
case of autoregressive exogenous (ARX) models.

Despite the usefulness of ARX models due to the simplicity
of estimation, they provide limited ﬂexibility, not allowing
the plant and the noise model to be parametrized indepen-
dently. In this sense, Box-Jenkins (BJ) models are a more
encompassing choice, as the plant and noise model are ra-
tional transfer functions parametrized independently. How-
ever, estimating BJ models with PEM suffers the drawbacks
of solving a non-convex optimization problem.

Another advantage of ARX models is that, if the polynomial

(cid:63) This work was supported by the European Research Council
under the advanced grant LEARN, contract 267381 and by the
Swedish Research Council under contract 621-2009-4017.

Email addresses: galrinho@kth.se (Miguel Galrinho),
neveritt@kth.se (Niklas Everitt), hjalmars@kth.se
(H˚akan Hjalmarsson).

orders are allowed to increase, they can approximate a BJ
model arbitrarily well. Their limitation is that, as the number
of estimated parameters increases, so does the variance of the
estimated model. Nevertheless, high-order ARX models are
still useful: e.g., several methods use them as an intermediate
step in the estimation algorithm [3–6]. Because, as the model
order increases to inﬁnity, the ARX model estimate is a
sufﬁcient statistic for the problem, it can replace the data and
be used to obtain an estimate that is statistically efﬁcient.

If the Box-Jenkins model has a stable predictor, it is well
known that the plant and noise model can be recovered
from the ARX polynomials [7]. In this paper, we generalize
these results to unstable plants, with data obtained from a BJ
system under stabilizing feedback. Due to the independent
parametrization of the plant and noise model, these transfer
functions are not required to share unstable poles. Although
this is a non-standard case, because PEM has an unstable
predictor, it makes sense: for example, if the noise model
is used to model a sensor, restricting this model to contain
eventual unstable plant dynamics is unreasonable from a
physical perspective. To apply PEM in such a case, methods
have been proposed to deal with unstable predictors [8, 9].

Our contributions are the following. First, we derive the
ARX polynomials obtained asymptotically when the plant
in a BJ system description is unstable. Second, we observe
that appropriate corrections are required to obtain consis-
tent estimates of the noise model and the noise variance,
and illustrate how these can be applied. Third, although the
variance of the estimated model increases with the number
of estimated parameters, we observe that the variance of the
unstable poles remains small.

Preprint submitted to Automatica

15 March 2016

2 Problem Statement

is stable, (5) is minimized by [7]

Consider that data is generated by the BJ system

¯A(q) =

1

H(q)

,

¯B(q) =

G(q)
H(q)

,

yt = G(q)ut + H(q)et ,

(1)

with minimum

(7)

(8)

J(cid:63) = λe.

where ut is the plant input, et is Gaussian white noise with
variance λe, yt is the output, and G(q) and H(q) are the
true plant and noise models, respectively, which are rational
transfer functions in the delay operator q−1, given by

G(q) :=

H(q) :=

L(q)
F(q)
C(q)
D(q)

:=

:=

l1q−1 + . . . + lml q−ml

1 + f1q−1 + . . . + fm f q−m f
1 + c1q−1 + . . . + cmcq−mc
1 + d1q−1 + . . . + dmd q−md

,

,

where ml, m f , mc, and md are ﬁnite positive integers.

We impose that C(q) and D(q) are stable polynomials, i.e.,
all the roots lie inside the unit circle, and F(q) does not con-
tain roots on the unit circle. Since F(q) is not required to be
stable, we consider that the data is obtained with stabilizing
feedback,

yt = G(q)S(q)rt +
ut =

H(q)S(q)et ,
S(q)rt − K(q)H(q)S(q)et ,

(2)

where rt is a known external reference uncorrelated with
et, S(q) = [1 + K(q)G(q)]−1 is the sensitivity function, and
K(q) is a stabilizing regulator.

Consider also the ARX model

A(q)yt = B(q)ut + et ,

(3)

with inﬁnite order polynomials

A(q) = 1 +

akq−k,

∞
∑

k=1

B(q) =

bkq−k.

∞
∑

k=1

Using a quadratic cost, the PEM estimate of the ARX model
minimizes the cost function

J := E [Ayt − But ]2 ,

(4)

as the number of samples tend to inﬁnity (here, the argument
q was dropped for notational simplicity). Because the data
are generated by (2), the cost function can be expressed as

J = E [(AG− B)Srt + (A + KB)HSet ]2 .

(5)

Then, the global minimizers of (5), ¯A(q) and ¯B(q), can be
related to G(q) and H(q).

It is well known that, if the predictor

Thus, an inﬁnite order ARX model can be used to asymptot-
ically recover a BJ model, as well as the noise variance λe.
In this paper, we seek the minimizers ¯A(q) and ¯B(q) of (5)
when the plant G(q) is unstable and the noise model H(q) is
parametrized independently, as is the case with a BJ model.
Although this makes the predictor (6) unstable in general,
the cost function (5) will still have a minimum.

3 ARX Minimizer of Unstable BJ Model

First, we introduce a result that will be used to derive our
main result.

Theorem 1 Let X(q) and Z(q) be rational functions that
can be expanded as inﬁnite, monic polynomials. Let Z(q) be
ﬁxed, stable and inversely stable, and X(q) be a function of
a free parameter vector θ, X(q,θ ). Then, the cost function

(cid:12)(cid:12)X(eiω ,θ )(cid:12)(cid:12)2(cid:12)(cid:12)Z(eiω )(cid:12)(cid:12)2 dω

(9)

(cid:90) π

−π

J(θ ) =

1
2π

has the unique minimizer ¯X(q,θ ) = Z−1(q), with minimum
J(cid:63) = 1.

PROOF. This is a standard result, see e.g. Problem 3G.3
in [1]. A proof is included for completeness. The product
X(q)Z(q) can be expanded as a polynomial,

X(q)Z(q) =

giq−i,

∞
∑

i=0

(10)

where g0 = 1, since X(q) and Z(q) are both monic. Using
Parseval’s identity on (9) together with (10) yields

J = 1 +

|gi|2 ≥ 1.

∞
∑

i=1

The minimum J∗ = 1 is obtained for ¯X(q,θ ) = Z−1(q), since
Z(q) is inversely stable. Because the inverse is unique, the
minimum will not be attained for any other X(q,θ ), since
then at least one gi (cid:54)= 0,i > 0.
2

Before stating the main result of the paper, we introduce the
following deﬁnitions. Consider the factorization

ˆyt = (1− H−1)yt + H−1Gut

(6)

F(q) = Fs(q)Fa(q),

(11)

2

where Fs(q) and Fa(q) contain the stable (magnitude less
than one) and anti-stable (magnitude larger than one) roots
of F(q), respectively. Also, we deﬁne F∗
a (q) as the polyno-
mial with the roots of Fa(q) mirrored inside the unit circle,
k q−k), where {p1, . . . , pna} are the
i.e., F∗
unstable roots of F(q).

k=1(1− p−1

a (q) = ∏na

The following theorem states our main result.

Theorem 2 Let H(q) be stable and inversely stable, and
factorize F(q) according to (11). The asymptotic minimizers
of (14) are given by

¯A(q) =

1

H(q)

Fa(q)
F∗
a (q)

,

¯B(q) =

1

H(q)

L(q)
FsF∗
a (q)

,

(12)

and the attained global minimum is

(cid:12)(cid:12)(cid:12)(cid:12) Fa(eiω )

F∗
a (eiω )

(cid:12)(cid:12)(cid:12)(cid:12)2

J(cid:63) =

λe.

(13)

PROOF. Using that rt and et are uncorrelated and Parseval’s
identity, (5) can be written as

where

J = Jr + Je,

(cid:90) π
(cid:90) π

−π

−π

Jr =

Je =

1
2π
1
2π

|AG− B|2|S|2 Φr dω,
|A + KB|2|HS|2 λe dω,

(14)

(15)

(16)

with Φr the spectrum of rt. Let

˜S(q) :=

S(q)
Fa(q)

=

Fs(q)

F(q) + K(q)L(q)

,

and re-write (16) as

(cid:12)(cid:12)(cid:12)(cid:12) Fa(eiω )
where(cid:12)(cid:12)Fa(eiω )/F∗

F∗
a (eiω )

Je =

a (eiω )

|A + KB|2(cid:12)(cid:12)H ˜SF∗

(cid:12)(cid:12)(cid:12)(cid:12)2 1
(cid:90) π
(cid:12)(cid:12)2 λe dω,
(cid:12)(cid:12) is moved outside the integral since it is

2π

−π

a

an all-pass ﬁlter. Therefore, since A(q)+K(q)B(q) is monic,
and H(q) ˜S(q)F∗
a (q) is monic, stable, and inversely stable,
we are in the situation of Theorem 1, and Je is minimized by

A(q) + K(q)B(q) = [H(q) ˜S(q)F∗

a (q)]−1.

(17)

If (15) can be made zero while satisfying (17), a global
minimizer for J has been found. This is done by setting ¯A(q)
and ¯B(q) according to (12), with minimum (13).
2

Notice that, if the plant is stable, Fa(q) = 1 = F∗
a (q) and
Fs(q) = F(q), and (12) reduces to (7). Moreover, using a

3

similar approach to Theorem 2, it is straightforward to ex-
tend this result to the case with a non-minimum phase noise
model H(q). In this case, the noise model H(q) in (12) will
be replaced by its minimum phase equivalent. This corre-
sponds to the well known result that PEM identiﬁes an equiv-
alent minimum phase noise model if the true noise model is
non-minimum phase [8].

Recovering G(q) from the asymptotic minimizers of the
ARX model is straightforward, as

G(q) =

¯B(q)
¯A(q)

.

(18)

The following corollary describes how the noise model and
the variance λe can be retrieved.

Corollary 3 Let J(cid:63) be the asymptotic minimum of (5), and
¯A(q) the corresponding minimizer. Then, the noise model
H(q) and the noise variance λe can be retrieved by

H(q) =

λe = J(cid:63)

1
¯A(q)

¯Aa(q)
¯A∗
a(q)

(cid:12)(cid:12)(cid:12)(cid:12) ¯A∗

a(eiω )
¯Aa(eiω )

(cid:12)(cid:12)(cid:12)(cid:12)2

,

(19)

(20)

and

respectively.

PROOF. The asymptotic minimizer ¯A(q) can be factorized
by one polynomial Fa(q) with anti-stable roots and one poly-
nomial with only stable roots corresponding to 1/H(q)F∗
a (q).
Thus, Fa(q) can be retrieved as the anti-stable roots of ¯A(q),

Fa(q) = ¯Aa(q).

(21)

Then, (19) follows directly from (12) and (21), while (20)
follows from (13) and (21).
2

Comparing Corollary 3 to (7) and (8), it is observed that the
noise model H(q) and noise variance λe will be wrongly
estimated if the appropriate corrections due to the unstable
plant are not made. In particular, we observe that ¯Aa(q)/ ¯A∗
a(q)
is an amplifying all-pass ﬁlter. So, without this correction
factor, the magnitude of the noise model is underestimated
by a constant bias, and the noise variance is overestimated.

4 Practical Aspects

So far, we have only discussed consistency of the ARX
model. For the consistency results to be valid, the ARX
model has to be of inﬁnite order. Otherwise, the system (1)
is not in the model set deﬁned by (3), and a bias is induced

by the truncation. For estimation purposes, we consider the
ARX model (3), whose polynomials are given by

A(q) = 1 +

akq−k,

na∑

k=1

B(q) =

bkq−k,

nb∑

k=1

where the orders na and nb are chosen large enough for these
polynomials to capture the dynamics of the true system. In
that case, the bias error due to the truncation is assumed to
be small.

The inherent limitation of estimating a high order model is
that the estimated model will have high variance. However,
we observe that this does not apply to the unstable poles
of the ARX model, as will be illustrated with a simulation
in the next section. Thus, the estimate of Fa(q) obtained
from (21) will have high accuracy in comparison to the com-
plete high order ARX-model estimate. In turn, this means
that the noise variance can be estimated according to (20)
with high accuracy.

There is theoretical support for the observation that the un-
stable roots of A(q) have low variance. For a very general
class of models, encompassing both ARX models and Box-
Jenkins models, it has been shown that the variance of any
unstable root will converge to a ﬁnite limit (cf. Theorem 5.1
in [10]). However, Theorem 5.1 in [10] is not directly appli-
cable to the setting of this paper, since such variance analysis
requires that the model order tend to inﬁnity as function of
the sample size N, similarly to the approach in [7]. There is
no conceptual reason limiting the extension of this theorem
to our setting; however, due to the technical effort required,
it will be considered in a separate contribution.

5 Examples

Consider the plant and noise models

G(q) =

1q−1 − 1.7q−2
1− 2q−1 + 2q−2 ,

H(q) =

1 + 0.2q−1
1− 0.9q−1 ,

which are used to generate data according to (2) with the
controller K(q) = 1, where rt and et are uncorrelated Gaus-
sian white noise sequences with unit variance. Notice that
the plant G(q) has a pair of unstable complex poles at 1± i.

We use this system for two examples. First, we illustrate
the limit properties of the ARX model that were shown in
Section 3; then, we use different orders of the ARX model to
illustrate the observation in Section 4 regarding the variance
of the estimated unstable poles.

obtain estimates of G(q) and H(q) when the plant is unsta-
ble. Because these results concern the limit values, in both
model order and sample size, of the estimates of A(q) and
B(q), they can be more clearly illustrated if the estimation er-
ror is kept small. Thus, to minimize the bias error due to the
ARX model truncation, we choose G(q) and H(q) such that
the coefﬁcients of ¯A(q) and ¯B(q) decay quickly, which al-
lows us to use a relatively low order (na = nb = 15). The low
model order together with a large sample size (N = 100000)
ensure that also the variance error will be small. Finally, we
are also interested in estimating the noise variance, λe.

The procedure is as follows. First, the ARX polynomials
A(q) and B(q) are estimated by minimizing the cost function

J =

1
N

N

∑

t=1

[A(q)yt − B(q)ut ]2 ,

which is a consistent estimate of (4) for ﬁnite sample size.
This is a least-squares problem, and yields estimates ˆA(q)
and ˆB(q), at which the minimum ˆJ is obtained.

Then, we estimate the plant and noise model from the es-
timated ARX polynomials. Motivated by (18) and (19), we
calculate

ˆG(q) =

ˆB(q)
ˆA(q)

,

ˆH(q) =

1
ˆA(q)

ˆAa(q)
ˆA∗
a(q)

.

In Fig. 1 and Fig. 2, the Bode plots of G(q) and H(q) are
shown respectively together with their corresponding esti-
mates, and, in the case of the noise model, also the estimate
without the correction for the unstable plant is shown. Here,
it is observed that the ARX model correctly captures the true
system, according to (12). In particular, this illustrates the
main result of this paper, that when the plant G(q) has un-
stable poles and is parametrized independently of the noise
model H(q), a high-order ARX model is still appropriate
to consistently model this system. However, while the stan-
dard result (7) still applies to consistently retrieve the plant,
a consistent estimate of the noise model is obtained by using
a correction factor according to (19).

Finally, we are interested in estimating the noise variance,
λe. With that purpose, motivated by (20), we calculate

(cid:12)(cid:12)(cid:12)(cid:12) ˆA∗

a(eiω )
ˆAa(eiω )

(cid:12)(cid:12)(cid:12)(cid:12)2

ˆλe = ˆJ

.

(22)

Recalling that λe = 1, the results obtained for this example
were

5.1 Limit Properties of the ARX Model

ˆJ = 3.9816,

ˆλe = 0.9988.

The objective of this example is to illustrate the result ob-
tained in Theorem 2, and how Corollary 3 can be used to

Again, we observe how the high-order ARX model can still
be used to obtain a consistent estimate of the noise variance,

4

)

B
d
(

e
d
u
t
i
n
g
a
M

)
g
e
d
(

e
s
a
h
P

5

0

−5
−135
−180
−225

10−2

10−1

100

Frequency (rad/s)

Fig. 1. Bode plot of G(q) (red, dashed) and its estimate ˆG(q)
(blue, full).

)

B
d
(

e
d
u
t
i
n
g
a
M

)
g
e
d
(

e
s
a
h
P

20

0
−20
0
−180
−360

10−2

10−1

100

Frequency (rad/s)

Fig. 2. Bode plot of H(q) (red, dashed), its estimate ˆH(q) (blue,
full), and its uncorrected estimate ˆA−1(q) (yellow, dash-dotted).

even in our generalized setting for unstable plants, as long
as the appropriate correction (22) is made. Otherwise, taking
the minimum ˆJ as estimate for the noise variance, as in (8),
would overestimate the noise variance by a factor of four.

5.2 Variance of the Estimated Unstable Poles

As ARX models typically need to be of high order to cap-
ture the dynamics of Box-Jenkins systems, the variance of
the estimated model will be large. Although this intrinsic
limitation was not evident in the previous example, since
the dynamics of the considered system can be captured with
relatively low orders of A(q) and B(q) (and a large sample
size was used), it can be made clear by letting the order of
the ARX polynomials increase.

1

0.5

0

−0.5

−1

−1 −0.5

0

0.5

1

Fig. 3. Roots of
na = nb = 15.

ˆA(q) obtained with 50 Monte Carlo runs, for

1

0.5

0

−0.5

−1

−1 −0.5

0

0.5

1

Fig. 4. Roots of
na = nb = 100.

ˆA(q) obtained with 50 Monte Carlo runs, for

To illustrate this, we perform a Monte Carlo simulation with
50 runs, where two ARX models with different orders are
computed. The roots of ˆA(q) are plotted in Fig. 3 and Fig.
4, for na = nb = 15 and na = nb = 100, respectively. Here,
it is clear that the variance of the unstable poles is small
relative to the stable ones, and also that there is no apparent
variance increase for the unstable poles when the number of
estimated parameters increases.

6 Discussion

In this paper, we derived asymptotic results for the limit
values of ARX models when used to model a BJ structure
with an unstable plant. High-order ARX models can still
be used to model the underlying system in this situation.
However, while B(q)/A(q) still captures the plant, 1/A(q) no
longer corresponds to the noise model H(q), but will also
depend on the unstable part of the plant G(q).

As the variance of the estimated ˆA(q) will be large, also
the variance of the estimated poles of G(q) should be large,
since the poles of G(q) are obtained from the roots of ˆA(q).
However, following the discussion in Section 4, we observe
that this does not apply to the variance of the unstable poles.

This result has also implications for modeling output-error
(OE) structures with high-order models. Typically, in this
case, a high-order ﬁnite impulse response model can be esti-
mated instead of an ARX, since H(q) = 1 = A(q). However,
that is only the case if G(q) is stable. When G(q) is unstable,

5

a ﬁnite-order polynomial B(q) is not sufﬁcient to approxi-
mate G(q) arbitrarily well. Thus, even if the true system is
OE, an ARX model is required to asymptotically capture the
system dynamics in this case.

The results in this paper also have a correspondence to those
in [9]. Therein, the authors derive modiﬁed, but asymptot-
ically equivalent, versions of OE and BJ models that yield
stable predictors in the case of unstable systems. The modi-
ﬁed versions contain an additional factor F∗
a (q)/Fa(q) to be es-
timated in the noise model, which corresponds to the same
quantity appearing in the estimate of 1/A(q) here derived.

Finally, we have shown how the plant, noise model, and
noise variance of a system of BJ structure can be obtained
from an estimated ARX model, in the case of an unstable
plant. Also, we note that the high variance inherent to the
high order of the ARX model does not affect the estimation
of the unstable poles nor the estimation of the noise variance.

References

[1] L. Ljung. System Identiﬁcation. Theory for the User, 2nd ed. Prentice-

Hall, 1999.

[2] D. Eckhard, A. S. Bazanella, C. R. Rojas, and H. Hjalmarsson. Input
design as a tool to improve the convergence of PEM. Automatica,
49(11), 2013.

[3] M. Jansson. Subspace identiﬁcation and ARX modeling. In IFAC
Symposium on System Identiﬁcation, Rotterdam, The Netherlands,
2003.

[4] Y. Zhu. A Box-Jenkins method that

is asymptotically globally
convergent for open loop data. In 18th IFAC World Congress, pages
9047–9051, 2011.

[5] H. Hjalmarsson, J. S. Welsh, and C. R. Rojas.

Identiﬁcation of
Box-Jenkins models using structured ARX models and nuclear norm
relaxation. In 16th IFAC Symposium on System Identiﬁcation, pages
322–327, 2012.

[6] M. Galrinho, C. R. Rojas, and H. Hjalmarsson. A weighted least-
squares method for parameter estimation in structured models.
In
53rd IEEE Conference on Decision and Control, pages 3322–3327,
2014.

[7] L. Ljung and B. Wahlberg. Asymptotic properties of the least-squares
method for estimating transfer functions and disturbance spectra.
Advances in Applied Probabilities, 24:412–440, 1992.

[8] H. Hjalmarsson and U. Forssell. Maximum likelihood estimation
of models with unstable dynamics and non-minimum phase noise
zeros. In Proc. of 14th IFAC World Congress, pages 13–18, 1999.
[9] U. Forssell and L. Ljung. Identiﬁcation of unstable systems using
output error and box-jenkins model structures. IEEE Transactions
on Automatic Control, 45(1):137–141, January 2000.

[10] J. M˚artensson and H. Hjalmarsson. Variance-error quantiﬁcation for
identiﬁed poles and zeros. Automatica, 45(11):2512 – 2525, 2009.

6

