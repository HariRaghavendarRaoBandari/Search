CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION

OF LATIN SQUARES

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Abstract. Our main result essentially reduces the problem of ﬁnding an edge-decomposition of a balanced
r-partite graph of large minimum degree into r-cliques to the problem of ﬁnding a fractional r-clique
decomposition or an approximate one. Together with very recent results of Dukes as well as Montgomery
on fractional decompositions into triangles and cliques respectively, this gives the best known bounds on
the minimum degree which ensures an edge-decomposition of an r-partite graph into r-cliques (subject
to trivially necessary divisibility conditions). The case of triangles translates into the setting of partially
completed Latin squares and more generally the case of r-cliques translates into the setting of partially
completed mutually orthogonal Latin squares.

6
1
0
2

 
r
a

M
 
3

 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
3
4
0
1
0

.

3
0
6
1
:
v
i
X
r
a

a Kr-decomposition, then certainly e(G) is divisible by(cid:0)r

1. Introduction

(cid:1) and the degree of every vertex is divisible by

A Kr-decomposition of a graph G is a partition of its edge set E(G) into cliques of order r. If G has

r − 1. A classical result of Kirkman [18] asserts that, when r = 3, these two conditions ensure that Kn
has a triangle decomposition (i.e. Steiner triple systems exist). This was generalized to arbitrary r (for
large n) by Wilson [27] and to hypergraphs by Keevash [16]. Recently, there has been much progress
in extending this from decompositions of complete host graphs to decompositions of graphs which are
allowed to be far from complete. In this paper, we investigate this question in the r-partite setting. This
is of particular interest as it implies results on the completion of partial Latin squares and more generally
partial mutually orthogonal Latin squares.

2

1.1. Clique decompositions of r-partite graphs. Our main result (Theorem 1.1) states that if G is
(i) balanced r-partite, (ii) satisﬁes the necessary divisibility conditions and (iii) its minimum degree is
at least a little larger than the minimum degree which guarantees an approximate decomposition into
r-cliques, then G in fact has a decomposition into r-cliques. (Here an approximate decomposition is a set
of edge-disjoint copies of Kr which cover almost all edges of G.) To state this result precisely, we need
the following deﬁnitions.

We say that a graph or multigraph G on (V1, . . . , Vr) is Kr-divisible if G is r-partite with vertex classes

V1, . . . , Vr and for all 1 ≤ j1, j2 ≤ r and every v ∈ V (G) \ (Vj1 ∪ Vj2),

e(Vj1, Vj2) = e(Vj3, Vj4). In particular, e(G) is divisible by e(Kr) =(cid:0)r

d(v, Vj1) = d(v, Vj2).

(cid:1).

Note that in this case, for all 1 ≤ j1, j2, j3, j4 ≤ r with j1 (cid:54)= j2, j3 (cid:54)= j4, we automatically have

Let G be an r-partite graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let
ˆδ(G) := min{d(v, Vj) : 1 ≤ j ≤ r, v ∈ V (G) \ Vj}.

2

An η-approximate Kr-decomposition of G is a set of edge-disjoint copies of Kr covering all but at most
ηn2 edges of G. We deﬁne ˆδη
Kr (n) to be the inﬁmum over all δ such that every Kr-divisible graph G

Date: March 4, 2016.
The research leading to these results was partially supported by the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007–2013) / ERC Grant Agreement no. 258345 (B. Barber and D. K¨uhn)
and 306349 (D. Osthus). The research was also partially supported by the EPSRC, grant no. EP/M009408/1 (D. K¨uhn and
D. Osthus), and by the Royal Society and the Wolfson Foundation (D. K¨uhn).

1

2

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Kr (n). So if ε > 0 and G is suﬃciently large, Kr-divisible and ˆδ(G) > (ˆδη

on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n and ˆδ(G) ≥ δn has an η-approximate Kr-decomposition. Let
ˆδη
Kr := lim supn→∞ ˆδη
Kr +ε)n, then
G has an η-approximate Kr-decomposition. Note that it is important here that G is Kr-divisible. Take,
for example, the complete r-partite graph with vertex classes of size n and remove (cid:100)ηn(cid:101) edge-disjoint
perfect matchings between one pair of vertex classes. The resulting graph G satisﬁes ˆδ(G) = n − (cid:100)ηn(cid:101),
yet has no η-approximate Kr-decomposition whenever r ≥ 3.
Theorem 1.1. For every r ≥ 3 and every ε > 0 there exists an n0 ∈ N and an η > 0 such that the
following holds for all n ≥ n0. Suppose G is a Kr-divisible graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n.
If ˆδ(G) ≥ (ˆδη

Kr + ε)n, then G has a Kr-decomposition.

By a result of Haxell and R¨odl [14], the existence of an approximate decomposition follows from that of
a fractional decomposition. So together with very recent results of Dukes [10] as well as Montgomery [21]
on fractional decompositions into triangles and cliques respectively, Theorem 1.1 implies the following
explicit bounds. We discuss this derivation in Section 1.3.

104 + ε(cid:1) n, then G has a K3-decomposition.
(cid:0) 101
(cid:0)1 − 1
106r3 + ε(cid:1) n, then G has a Kr-decomposition.

Theorem 1.2. For every r ≥ 3 and every ε > 0 there exists an n0 ∈ N such that the following holds for
all n ≥ n0. Suppose G is a Kr-divisible graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n.

(i) If r = 3 and ˆδ(G) ≥
(ii) If r ≥ 4 and ˆδ(G) ≥
If G is the complete r-partite graph, this corresponds to a theorem of Chowla, Erd˝os and Straus [6].
A bound of (1 − 1/(1016r29))n was claimed by Gustavsson [13]. The following conjecture seems natural
(and is implicit in [13]).
Conjecture 1.3. For every r ≥ 3 there exists an n0 ∈ N such that the following holds for all n ≥ n0.
Suppose G is a Kr-divisible graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. If ˆδ(G) ≥ (1 − 1/(r + 1))n,
then G has a Kr-decomposition.

A construction which matches the lower bound in Conjecture 1.3 is described in Section 3.1 (this
construction also gives a similar lower bound on ˆδη
Kr ). In the non-partite setting, the triangle case is a long-
standing conjecture by Nash-Williams [22] that every graph G on n vertices with minimum degree at least
3n/4 has a triangle decomposition (subject to divisibility conditions). Barber, K¨uhn, Lo and Osthus [3]
recently reduced its asymptotic version to proving an approximate or fractional version. Corresponding
results on fractional triangle decompositions were proved by Yuster [28], Dukes [9], Garaschuk [11] and
Dross [8].

More generally [3] also gives results for arbitrary graphs, and corresponding fractional decomposition
results have been obtained by Yuster [28], Dukes [9] as well as Barber, K¨uhn, Lo, Montgomery and
Osthus [2]. Further results on F -decompositions of non-partite graphs (leading on from [3]) have been
obtained by Glock, K¨uhn, Lo, Montgomery and Osthus [12]. Amongst others, for any bipartite graph F ,
they asymptotically determine the minimum degree threshold which guarantees an F -decomposition.

1.2. Mutually orthogonal Latin squares and Kr-decompositions of r-partite graphs. A Latin
square T of order n is an n × n grid of cells, each containing a symbol from [n], such that no symbol
appears twice in any row or column. It is easy to see that T corresponds to a K3-decomposition of the
complete tripartite graph Kn,n,n with vertex classes consisting of the rows, columns and symbols.
Now suppose that we have a partial Latin square; that is, a partially ﬁlled in grid of cells satisfying the
conditions deﬁning a Latin square. When can it be completed to a Latin square? This natural question
has received much attention. For example, a classical theorem of Smetaniuk [24] as well as Anderson
and Hilton [1] states that this is always possible if at most n − 1 entries have been made (this bound is
best possible). The case r = 3 of Conjecture 1.3 implies that, provided we have used each row, column
and symbol at most n/4 times, it should also still be possible to complete a partial Latin square. This
was conjectured by Daykin and H¨aggkvist [7]. (Note that this conjecture corresponds to the special case

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

3

of Conjecture 1.3 when r = 3 and the condition of G being Kr-divisible is replaced by that of G being
obtained from Kn,n,n by deleting edge-disjoint triangles.)

More generally, we say that two Latin squares R (red) and B (blue) drawn in the same n×n grid of cells
are orthogonal if no blue symbol appears twice next to the same red symbol. In the same way that a Latin
square corresponds to a K3-decomposition of Kn,n,n, a pair of orthogonal Latin squares corresponds to a
K4-decomposition of Kn,n,n,n where the vertex classes are rows, columns, red symbols and blue symbols.
More generally, there is a natural bijection between sequences of r − 2 mutually orthogonal Latin squares
(where every pair from the sequence are orthogonal) and Kr-decompositions of complete r-partite graphs
with vertex classes of equal size. Sequences of mutually orthogonal Latin squares are also known as
transversal designs. Theorem 1.2 can be used to show the following (see Section 3.2 for details).

Theorem 1.4. For every r ≥ 3 and every ε > 0 there exists an n0 ∈ N such that the following holds for
all n ≥ n0. Let

(cid:40) 3

cr :=

104
9

107r3

if r = 3,
if r ≥ 4.

Let T1, . . . ,Tr−2 be a sequence of mutually orthogonal partial n × n Latin squares (drawn in the same
n× n grid). Suppose that each row and column of the grid contains at most (cr − ε)n non-empty cells and
each coloured symbol is used at most (cr − ε)n times. Then T1, . . . ,Tr−2 can be completed to a sequence
of mutually orthogonal Latin squares.

The best previous bound for the triangle case r = 3 is due to Bartlett [4], who obtained a minimum

degree bound of (1 − 10−4)n. This improved an earlier bound of Chetwynd and H¨aggkvist [5] as well as

the one claimed by Gustavsson [13].

1.3. Fractional and approximate decompositions. A fractional Kr-decomposition of a graph G is
a non-negative weighting of the copies of Kr in G such that the total weight of all the copies of Kr
containing any ﬁxed edge of G is exactly 1. Fractional decompositions are of particular interest to us
because of the following result of Haxell and R¨odl, of which we state only a very special case.

Theorem 1.5 (Haxell and R¨odl [14]). For every r ≥ 3 and every η > 0 there exists an n0 ∈ N such that
the following holds. Let G be a graph on n ≥ n0 vertices that has a fractional Kr-decomposition. Then
G has an η-approximate Kr-decomposition.

We deﬁne ˆδ∗
|V1| = ··· = |Vr| = n and ˆδ(G) ≥ δn has a fractional Kr-decomposition. Let ˆδ∗
Theorem 1.5 implies that, for every η > 0, ˆδη
following.

Kr (n) to be the inﬁmum over all δ such that every Kr-divisible graph G on (V1, . . . , Vr) with
Kr (n).
Kr . Together with Theorem 1.1, this yields the

Kr := lim supn→∞ ˆδ∗

Kr ≤ ˆδ∗

Corollary 1.6. For every r ≥ 3 and every ε > 0 there exists an n0 ∈ N such that the following holds
for all n ≥ n0. Suppose G is a Kr-divisible graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n.
ˆδ(G) ≥ (ˆδ∗
In particular, to prove Conjecture 1.3 asymptotically, it suﬃces to show that ˆδ∗

Kr + ε)n, then G has a Kr-decomposition.

If

Kr ≤ 1 − 1/(r + 1). For

triangles, the best bound on the ‘fractional decomposition threshold’ is due to Dukes [10].
Theorem 1.7 (Dukes [10]). ˆδ∗

K3 ≤ 101
104 .

For arbitrary cliques, Montgomery obtained the following bound. Somewhat weaker bounds (obtained
by diﬀerent methods) are also proved in [10].

Theorem 1.8 (Montgomery [21]). For every r ≥ 3, ˆδ∗

Kr ≤ 1 − 1

106r3 .

4

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Note that together with Corollary 1.6, these results immediately imply Theorem 1.2.

This paper is organised as follows. In Section 2 we introduce some notation and tools which will be
used throughout this paper. In Section 3 we give extremal constructions which support the bounds in
Conjecture 1.3 and we provide a proof of Theorem 1.4. Section 4 outlines the proof of Theorem 1.1 and
guides the reader through the remaining sections in this paper.

2. Notation and tools

Let G be a graph and let P = {U 1, . . . , U k} be a partition of V (G). We write G[U 1] for the subgraph
of G induced by U 1 and G[U 1, U 2] for the bipartite subgraph of G induced by the vertex classes U 1 and
U 2. We will also sometimes write G[U 1, U 1] for G[U 1]. We write G[P] := G[U 1, . . . , U k] for the k-partite
subgraph of G induced by the partition P. We write U <i for U 1 ∪ ··· ∪ U i−1. We say the partition P is
equitable if its parts diﬀer in size by at most one. Given a set U ⊆ V (G), we write P[U ] for the restriction
of P to U .
Let G be a graph and let U, V ⊆ V (G). We write NG(U, V ) := {v ∈ V : xv ∈ E(G) for all x ∈ U} and
dG(U, V ) := |NG(U, V )|. For v ∈ V (G), we write NG(v, V ) for NG({v}, V ) and dG(v, V ) for dG({v}, V ).
If U and V are disjoint, we let eG(U, V ) := e(G[U, V ]).
Let G and H be graphs. We write G−H for the graph with vertex set V (G) and edge set E(G)\E(H).
We write G \ H for the subgraph of G induced by the vertex set V (G) \ V (H). We call a vertex-disjoint
collection of copies of H in G an H-matching. If the H-matching covers all vertices in G, we say that it
is perfect.

Throughout this paper, we consider a partition V1, . . . , Vr of a vertex set V such that |Vj| = n for all

1 ≤ j ≤ r. Given a set U ⊆ V , we write

Uj := U ∩ Vj.

We write Kr(k) for the complete r-partite graph with vertex classes of size k. We say that an r-partite
graph G on (V1, . . . , Vr) is balanced if |V1| = ··· = |Vr|.
We use hierarchies, for example 1/n (cid:28) a (cid:28) b < 1, where constants are chosen from right to left. The
notation a (cid:28) b means that there exists an increasing function f for which the result holds whenever
a ≤ f (b). In order to simplify the presentation, we will not determine these functions explicitly.
Let m, n, N ∈ N with m, n < N . The hypergeometric distribution with parameters N , n and m is the
distribution of the random variable X deﬁned as follows. Let S be a random subset of {1, 2, . . . , N} of
size n and let X := |S ∩ {1, 2, . . . , m}|. We will frequently use the following bounds, which are simple
forms of Hoeﬀding’s inequality.
Lemma 2.1 (see [15, Remark 2.5 and Theorem 2.10]). Let X ∼ B(n, p) or let X have a hypergeometric
distribution with parameters N, n, m. Then P(|X − E(X)| ≥ t) ≤ 2e−2t2/n.
distribution and 0 < a < 3/2. Then P(|X − E(X)| ≥ aE(X)) ≤ 2e−a2E(X)/3.

Lemma 2.2 (see [15, Corollary 2.3 and Theorem 2.10]). Suppose that X has binomial or hypergeometric

3. Extremal graphs and completion of Latin squares

Kr (and thus on the fractional decomposition threshold ˆδ∗

3.1. Extremal graphs. The following proposition shows that the minimum degree bound conjectured in
Conjecture 1.3 would be best possible. It also provides a lower bound on the approximate decomposition
threshold ˆδη
Proposition 3.1. Let r ∈ N with r ≥ 3 and let η > 0. For inﬁnitely many n, there exists a Kr-divisible
graph G on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n and ˆδ(G) = (cid:100)(1− 1/(r + 1))n(cid:101)− 1 which does not have
a Kr-decomposition. Moreover, ˆδη
Proof. Let m ∈ N with 1/m (cid:28) η and let n := (r−1)m. Let {U 1, . . . , U r−1} be a partition of V1∪···∪Vr
such that, for each 1 ≤ i ≤ r − 1 and each 1 ≤ j ≤ r, U i

j = U i ∩ Vj has size m.

Kr ≥ 1 − 1/(r + 1) − η.

Kr ).

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

5

Let G0 be the intersection of the complete r-partite graph on (V1, . . . , Vr) and the complete (r − 1)-
partite graph on (U 1, . . . , U r−1). For each 1 ≤ q ≤ m and each 1 ≤ i ≤ r − 1, let H i
q be a graph formed
by starting with the empty graph on U i and including a q-regular bipartite graph with vertex classes
j1, U i
(U i
and let Gq := G0 ∪ Hq. Observe that Gq
is regular, Kr-divisible and

j2) for each 1 ≤ j1 < j2 ≤ r. Let Hq := H 1

q ∪ ··· ∪ H r−1
ˆδ(Gq) = (r − 2)m + q.

q

Now G0 is (r − 1)-partite, so every copy of Kr in Gq contains at least one edge of Hq. Therefore, any

collection of edge-disjoint copies of Kr in G will leave at least

(cid:96)(Gq) := e(Gq) − e(Hq)

2

(cid:18)r

(cid:19)

=(cid:0)(r − 2)m + q −

(cid:18)r

2

(cid:19)
q(cid:1)(cid:18)r
(cid:19)
(cid:19)
(cid:18)r

2

n

n

= (m − (r + 1)q/2)(r − 2)

2

edges of Gq uncovered. Let q0 := (cid:100)2m/(r + 1)(cid:101) − 1. Then (cid:96)(Gq0) > 0, so Gq0 does not have a Kr-
decomposition. Also,

ˆδ(Gq0) = (r − 2)m + (cid:100)2m/(r + 1)(cid:101) − 1 = (cid:100)(1 − 1/(r + 1))n(cid:101) − 1.

(cid:19)
Now let qη := (cid:100)2m/(r + 1) − ηn(cid:101). We have ˆδ(Gqη ) ≥ (1 − 1/(r + 1) − η)n and
n

(cid:96)(Gqη ) ≥ (m − (2m/(r + 1) − ηn + 1)(r + 1)/2)(r − 2)

(cid:18)r

2

Thus, ˆδη

Kr ≥ 1 − 1/(r + 1) − η.

= (ηn − 1)(r + 1)(r − 2)r(r − 1)n/4 ≥ 6(ηn − 1)n > ηn2.

(cid:3)

3.2. Completion of mutually orthogonal Latin squares. In this section, we give a proof of Theo-
rem 1.4. Note that better bounds on the fractional decomposition threshold would immediately lead to
better bounds on cr. For any r-partite graph H on (V1, . . . , Vr), we let H denote the r-partite complement
of H on (V1, . . . , Vr).

≤ n and each 1 ≤ m < m(cid:48)

Proof of Theorem 1.4. By making ε smaller if necessary, we may assume that ε (cid:28) 1. Let n0 ∈ N be
such that 1/n0 (cid:28) ε, 1/r. Use T1, . . . ,Tr−2 to construct a balanced r-partite graph G with vertex classes
Vj = [n] for 1 ≤ j ≤ r as follows. For each 1 ≤ i, j, k ≤ n and each 1 ≤ m ≤ r − 2, if in Tm the cell (i, j)
contains the symbol k, include a K3 on the vertices i ∈ Vr−1, j ∈ Vr and k ∈ Vm. (If the cell (i, j) is
ﬁlled in diﬀerent Tm, this leads to multiple edges between i ∈ Vr−1 and j ∈ Vr, which we disregard.) For
each 1 ≤ i, j, k, k(cid:48)
≤ r − 2 such that the cell (i, j) contains symbol k in Tm and
symbol k(cid:48) in Tm(cid:48), add an edge between the vertices k ∈ Vm and k(cid:48)
If r = 3, then G is an edge-disjoint union of copies of K3, so G is K3-divisible. Then G is also K3-
divisible and ˆδ(G) ≥ (101/104 + ε)n. So we can apply Theorem 1.2 to ﬁnd a K3-decomposition of G
which we can then use to complete T1 to a Latin square.
Suppose now that r ≥ 4. Observe that G consists of an edge-disjoint union of cliques H1, . . . , Hq such
that, for each 1 ≤ i ≤ q, Hi contains an edge of the form xy where x ∈ Vr−1 and y ∈ Vr. We have
q ≤ (cr − ε)n2. We now show that we can extend G to a graph which has a Kr-decomposition. We
will do this by greedily extending each Hi in turn to a copy H(cid:48)
i of Kr. Suppose that 1 ≤ p ≤ q and we
have already found edge-disjoint H(cid:48)
p−1. Given v ∈ V (G), let s(v, p − 1) be the number of graphs
in {H(cid:48)
p−1} ∪ {Hp, . . . , Hq} which contain v. Suppose that s(v, p − 1) ≤ 10(cr − ε2)n/9 for all
v ∈ V (G). For each 1 ≤ j ≤ r, let Bj := {v ∈ Vj : s(v, p − 1) ≥ 10(cr − ε)n/9}. We have
(3.1)

1, . . . , H(cid:48)

1, . . . , H(cid:48)

∈ Vm(cid:48).

q

.

|Bj| ≤

10(cr − ε)n/9 ≤

9n
10

6

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

(cid:83)p−1
i=1 (H(cid:48)

i − Hi). Note that

Let Gp−1 := G ∪
(3.2)
We will extend Hp to a copy of Kr as follows. Let {j1, . . . , jm} = {j : 1 ≤ j ≤ r and V (Hp)∩Vj = ∅}. For
(V (Hp) ∪ {xj1, . . . , xji−1}, Vji \
each ji in turn, starting with j1, choose one vertex xji from the set NGp−1
Bji). This is possible since (3.1) and (3.2) imply

ˆδ(Gp−1) ≥ (1 − 10(cr − ε2)/9)n.

dGp−1

(V (Hp) ∪ {xj1, . . . , xji−1}, Vji \ Bji) ≥ (1/10 − (r − 1)10(cr − ε2)/9)n > 0.

Let H(cid:48)
p be the copy of Kr with vertex set V (Hp)∪{xj : 1 ≤ j ≤ r and V (Hp)∩ Vj = ∅}. By construction,
for every v ∈ V (G), the number s(v, p) of graphs in {H(cid:48)
p} ∪ {Hp+1, . . . , Hq} which contain v
(cid:83)
satisﬁes s(v, p) ≤ 10(cr − ε2)n/9.
Continue in this way to ﬁnd edge-disjoint H(cid:48)
1, . . . , H(cid:48)
q such that s(v, q) ≤ 10(cr − ε2)n/9. Let Gq :=
1≤i≤q H(cid:48)
(cid:83)
i. We have ˆδ(Gq) ≥ (1 − 10(cr − ε2)/9)n = (1 − 1/106r3 + 10ε2/9)n and, since Gq is an edge-
disjoint union of copies of Kr, we know that Gq is Kr-divisible. So we can apply Theorem 1.2 to ﬁnd
a Kr-decomposition F of Gq. Note that F
i is a Kr-decomposition of the complete
(cid:48) to complete T1, . . . ,Tr−2 to a sequence
r-partite graph. Since Hi ⊆ H(cid:48)
(cid:3)
of mutually orthogonal Latin squares.

1≤i≤q H(cid:48)
i for each 1 ≤ i ≤ q, we can use F

(cid:48) := F ∪

1, . . . , H(cid:48)

4. Proof Sketch

Our proof of Theorem 1.1 builds on the proof of the main results of [3], but requires signiﬁcant new
ideas. In particular, the r-partite setting involves a stronger notion of divisibility (the non-partite setting

simply requires that r − 1 divides the degree of each vertex of G and that(cid:0)r

(cid:1) divides e(G)) and we have

to work much harder to preserve it during our proof. This necessitates a delicate ‘balancing’ argument
(see Section 10). In addition, we use a new construction for our absorbers, which allows us to obtain the
best possible version of Theorem 1.1. (The construction of [3] would only achieve 1 − 1/3(r − 1) in place
of 1 − 1/(r + 1).)
The idea behind the proof is as follows. We are assuming that we have access to a black box approximate
decomposition result: given a Kr-divisible graph G on vertex classes of size n with ˆδ(G) ≥ (ˆδη
Kr + ε)n
we can obtain an approximate Kr-decomposition that leaves only ηn2 edges uncovered. We would like
to obtain an exact decomposition by ‘absorbing’ this small remainder. By an absorber for a Kr-divisible
graph H we mean a graph AH such that both AH and AH ∪ H have a Kr-decomposition. For any ﬁxed
H we can construct an absorber AH . But there are far too many possibilities for the remainder H to
allow us to reserve individual absorbers for each in advance.

2

To bridge the gap between the output of the approximate result and the capabilities of our absorbers,
we use an iterative absorption approach (see also [3] and [19]). Our guiding principle is that, since we have
no control on the remainder if we apply the approximate decomposition result all in one go, we should
apply it more carefully. More precisely, we begin by partitioning V (G) at random into a large number of
parts U 1, . . . , U k. Since k is large, G[U 1, . . . , U k] still has high minimum degree, and, since the partition
is random, each G[U i] also has high minimum degree. We ﬁrst reserve a sparse and well structured
subgraph J of G[U 1, . . . , U k], then we obtain an approximate decomposition of G[U 1, . . . , U k]− J leaving
a sparse remainder H. We then use a small number of edges from the G[U i] to cover all edges of H ∪ J
by copies of Kr. Let G(cid:48) be the subgraph of G consisting of those edges not yet used in the approximate
decomposition. Then all edges of G(cid:48) lie in some G(cid:48)[U i], and each G(cid:48)[U i] has high minimum degree, so
we can repeat this argument on each G(cid:48)[U i]. Suppose that we can iterate in this way until we obtain a
partition W1 ∪ ··· ∪ Wm of V (G) such that each Wi has size at most some constant M and all edges of
G have been used in the approximate decomposition except for those contained entirely within some Wi.
Then the remainder is a vertex-disjoint union of graphs H1, . . . , Hm, with each Hi contained within Wi.
At this point we have already achieved that the total leftover H1 ∪ ··· ∪ Hm has only O(n) edges. More

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

7

importantly, the set of all possibilities for the graphs Hi has size at most 2M 2
m = O(n), which is a small
enough number that we are able to reserve special purpose absorbers for each of them in advance (i.e.
right at the start of the proof).

The above sketch passes over one genuine diﬃculty. Recall that H ⊆ G[U 1, . . . , U k] denotes the
sparse remainder obtained from the approximate decomposition, which we aim to ‘clean up’ using a well
structured graph J set aside at the beginning of the proof, i.e. we aim to cover all edges of H ∪ J with
copies of Kr by using a few additional edges from the G[U i]. So consider any vertex v ∈ U 1
1 (recall that
U i
j = U i ∩ Vj). In order to cover the edges in H ∪ J between v and U 2, we would like to ﬁnd a perfect
Kr−1-matching in N (v) ∩ U 2. However, for this to work, the number of neighbours of v inside each of
U 2
2 , . . . , U 2
r must be the same, and the analogue must hold with U 2 replaced by any of U 3, . . . , U k. (This
is in contrast to [3], where one only needs that the number of leftover edges between v and any of the
parts U i is divisible by r, which is much easier to achieve.) We ensure this balancedness condition by
constructing a ‘balancing graph’ which can be used to transfer a surplus of edges or degrees from one part
to another. This ‘balancing graph’ will be the main ingredient of J. Another diﬃculty is that whenever
we apply the approximate decomposition result, we need to ensure that the graph is Kr-divisible. This
means that we need to ‘preprocess’ the graph at each step of the iteration.

The rest of this paper is organised as follows. In Section 5, we present general purpose embedding
In Section 6,
lemmas that allow us to ﬁnd a wide range of desirable structures within our graph.
we detail the construction of our absorbers.
In Section 7, we prove some basic properties of random
subgraphs and partitions. In Section 8, we show how we can assume that our approximate decomposition
result produces a remainder with low maximum degree rather than simply a small number of edges. In
Section 9, we clean up the edges in the remainder using a few additional edges from inside each part of
the current partition. However, we assume in this section that our remainder is balanced in the sense
described above. In Section 10, we describe the balancing operation which ensures that we can make this
assumption. Finally, in Section 11 we put everything together to prove Theorem 1.1.

5. Embedding lemmas

Let G be an r-partite graph on (V1, . . . , Vr) and let P = {U 1, U 2, . . . , U k} be a partition of V (G).
j := U i ∩ Vj for each 1 ≤ i ≤ k and each 1 ≤ j ≤ r. We say that a graph (or multigraph)

Recall that U i
H is P-labelled if:
(a) every vertex of H is labelled by one of: {v} for some v ∈ V (G); U i
j for some 1 ≤ i ≤ k, 1 ≤ j ≤ r or
(b) the vertices labelled by singletons (called root vertices) form an independent set in H, and each

Vj for some 1 ≤ j ≤ r;
v ∈ V (G) appears as a label {v} at most once;
independent set in H.

(c) for each 1 ≤ j ≤ r, the set of vertices v ∈ V (H) such that v is labelled L for some L ⊆ Vj forms an

Any vertex which is not a root vertex is called a free vertex.

labelling if each vertex of H gets mapped to a vertex in its label.

Let H be a P-labelled graph and let H(cid:48) be a copy of H in G. We say that H(cid:48) is compatible with its
Given a graph H and U ⊆ V (H) with e(H[U ]) = 0, we deﬁne the degeneracy of H rooted at U to be

the least d for which there is an ordering v1, . . . , vb of the vertices of H such that

• there is an a such that U = {v1, . . . , va} (the ordering of U is unimportant);
• for a < j ≤ b, vj is adjacent to at most d of the vi with 1 ≤ i < j.

The degeneracy of a P-labelled graph H is the degeneracy of H rooted at U , where U is the set of root
vertices of H.
In the proof of Lemma 10.9, we use the following special case of Lemma 5.1 from [3] to ﬁnd copies of
labelled graphs inside a graph G, provided their degeneracy is small. Moreover, this lemma allows us to
assume that the subgraph of G used to embed these graphs has low maximum degree.

8

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Lemma 5.1. Let 1/n (cid:28) η (cid:28) ε, 1/d, 1/b ≤ 1 and let G be a graph on n vertices. Suppose that:
(i) for each S ⊆ V (G) with |S| ≤ d, dG(S, V (G)) ≥ εn.
Let m ≤ ηn2 and let H1, . . . , Hm be labelled graphs such that, for every 1 ≤ i ≤ m, every vertex of Hi is
labelled {v} for some v ∈ V (G) or labelled by V (G) and that property (b) above holds for Hi. Moreover,
suppose that:
(ii) for each 1 ≤ i ≤ m, |Hi| ≤ b;
(iii) for each 1 ≤ i ≤ m, the degeneracy of Hi (rooted at the set of vertices labelled by singletons) is at
(iv) for each v ∈ V (G), there are at most ηn graphs Hi with some vertex labelled {v}.
Then there exist edge-disjoint embeddings φ(H1), . . . , φ(Hm) of H1, . . . , Hm compatible with their labellings

such that the subgraph H :=(cid:83)m

most d;

i=1 φ(Hi) of G satisﬁes ∆(H) ≤ εn.

We will also use the following partite version of the lemma to ﬁnd copies of P-labelled graphs in an
r-partite graph G. We omit the proof since it is very similar to the proof of Lemma 5.1 in [3] (for details,
see [26]).
Lemma 5.2. Let 1/n (cid:28) η (cid:28) ε, 1/d, 1/b, 1/k, 1/r ≤ 1 and let G be an r-partite graph on (V1, . . . , Vr)
where |V1| = ··· = |Vr| = n. Let P = {U 1, . . . , U k} be a k-partition of V (G). Suppose that:
(i) for each 1 ≤ i ≤ k and each 1 ≤ j ≤ r, if S ⊆ V (G) \ Vj with |S| ≤ d then dG(S, U i
Let m ≤ ηn2 and let H1, . . . , Hm be P-labelled graphs such that the following hold:
(ii) for each 1 ≤ i ≤ m, |Hi| ≤ b;
(iii) for each 1 ≤ i ≤ m, the degeneracy of Hi is at most d;
(iv) for each v ∈ V (G), there are at most ηn graphs Hi with some vertex labelled {v}.
Then there exist edge-disjoint embeddings φ(H1), . . . , φ(Hm) of H1, . . . , Hm in G which are compatible
(cid:3)

with their labellings such that H :=(cid:83)

j ) ≥ ε|U i
j|.

1≤i≤m φ(Hi) satisﬁes ∆(H) ≤ εn.

6. Absorbers

Let H be any r-partite graph on the vertex set V = (V1, . . . , Vr). An absorber for H is a graph A such

that both A and A ∪ H have Kr-decompositions.
Our aim is to ﬁnd an absorber for each small Kr-divisible graph H on V . The construction develops
ideas in [3]. In particular, we will build the absorber in stages using transformers, introduced below, to
move between Kr-divisible graphs.
Let H and H(cid:48) be vertex-disjoint graphs. An (H, H(cid:48))r-transformer is a graph T which is edge-disjoint
from H and H(cid:48) and is such that both T ∪ H and T ∪ H(cid:48) have Kr-decompositions. Note that if H(cid:48) has
a Kr-decomposition, then T ∪ H(cid:48) is an absorber for H. So the idea is that we can use a transformer to
transform a given H into a new graph H(cid:48), then into H(cid:48)(cid:48) and so on, until ﬁnally we arrive at a graph
which has a Kr-decomposition.
Let V = (V1, . . . , Vr). Throughout this section, given two r-partite graphs H and H(cid:48) on V , we say
that H(cid:48) is a partition-respecting copy of H if there is an isomorphism f : H → H(cid:48) such that f (v) ∈ Vj
for every vertex v ∈ V (H) ∩ Vj.
Given r-partite graphs H and H(cid:48) on V , we say that H(cid:48) is obtained from H by identifying vertices if
there exists a sequence of r-partite graphs H0, . . . , Hs on V such that H0 = H, Hs = H(cid:48) and the following
holds. For each 0 ≤ i < s, there exists 1 ≤ ji ≤ r and vertices xi, yi ∈ V (Hi)∩ Vji satisfying the following:
(i) NHi(xi) ∩ NHi(yi) = ∅.
(ii) Hi+1 is the graph which has vertex set V (Hi)\{yi} and edge set E(Hi \{yi})∪{vxi : vyi ∈ E(Hi)}
Condition (i) ensures that the identiﬁcations do not produce multiple edges. Note that if H and H(cid:48) are
r-partite graphs on V and H(cid:48) is a partition-respecting copy of a graph obtained from H by identifying

(i.e., Hi+1 is obtained from Hi by identifying the vertices xi and yi).

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

9

vertices then there exists a graph homomorphism φ : H → H(cid:48) that is edge-bijective and maps vertices in
Vj to vertices in Vj for each 1 ≤ j ≤ r.
In the following lemma, we ﬁnd a transformer between a pair of Kr-divisible graphs H and H(cid:48) whenever
H(cid:48) can be obtained from H by identifying vertices.
Lemma 6.1. Let r ≥ 3 and 1/n (cid:28) η (cid:28) 1/s (cid:28) ε, 1/b, 1/r ≤ 1. Let G be an r-partite graph on
V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Suppose that ˆδ(G) ≥ (1 − 1/(r + 1) + ε)n. Let H and H(cid:48) be
vertex-disjoint Kr-divisible graphs on V with |H| ≤ b. Suppose further that H(cid:48) is a partition-respecting
copy of a graph obtained from H by identifying vertices. Let B ⊆ V be a set of at most ηn vertices. Then
G contains an (H, H(cid:48))r-transformer T such that V (T ) ∩ B ⊆ V (H ∪ H(cid:48)) and |T| ≤ s2.

In our proof of Lemma 6.1, we will use the following multipartite asymptotic version of the Hajnal–

j

(cid:83)

(cid:83)

are disjoint.

Let T be any graph deﬁned as follows:

: 1 ≤ j ≤ r and x, y /∈ Vj} is a set of r − 2 vertices. For each

Szemer´edi theorem.
Theorem 6.2 ([17] and [20]). Let r ≥ 2 and let 1/n (cid:28) ε, 1/r. Suppose that G is an r-partite graph on
(V1, . . . , Vr) with |V1| = ··· = |Vr| = n and ˆδ(G) ≥ (1−1/r+ε)n. Then G contains a perfect Kr-matching.
Proof of Lemma 6.1. Let φ : H → H(cid:48) be a graph homomorphism from H to H(cid:48) that is edge-bijective
and maps vertices in Vj to Vj for each 1 ≤ j ≤ r.
x ∈ V (H), let Zx :=(cid:83)
(a) For each xy ∈ E(H), Zxy := {zxy
y∈NH (x) Zxy.
(b) For each x ∈ V (H), Sx is a set of (r − 1)s vertices.
(c) For all distinct e, e(cid:48)
∈ E(H) and all distinct x, x(cid:48)
(d) V (T ) := V (H) ∪ V (H(cid:48)) ∪
e∈E(H) Ze ∪
(e) EH := {xz : x ∈ V (H) and z ∈ Zx}.
(f) EH(cid:48) := {φ(x)z : x ∈ V (H) and z ∈ Zx}.
(g) EZ := {wz : e ∈ E(H) and w, z ∈ Ze}.
(h) ES := {xv : x ∈ V (H) and v ∈ Sx}.
(i) E(cid:48)
S := {φ(x)v : x ∈ V (H) and v ∈ Sx}.
(j) For each x ∈ V (H), F x
(k) For each x ∈ V (H), F x
(cid:83)
(l) For each x ∈ V (H), F x
(m) For each x ∈ V (H), Zx is independent in F x
1 .
(n) E(T ) := EH ∪ EH(cid:48) ∪ EZ ∪ ES ∪ E(cid:48)
(cid:88)
(cid:88)
S ∪

1 is a perfect Kr−1-matching on Sx ∪ Zx.
2 is a perfect Kr−1-matching on Sx.
1 and F x

∈ V (H), the sets Ze, Ze(cid:48)

and V (H ∪ H(cid:48))

1 ∪ F x
2 ).
(cid:48)

2 are edge-disjoint.

x∈V (H) E(F x

, Sx, Sx(cid:48)

x∈V (H) Sx.

|T| = |H| + |H

| +

(cid:48)

|Ze| +

|Sx| = |H| + |H

| + (r − 2)e(H) + (r − 1)s|H| ≤ s2.

e∈E(H)

x∈V (H)

(cid:83)
Let T1 be the subgraph of T with edge set EH ∪ EH(cid:48) ∪ EZ and let T2 := T − T1. So E(T2) = ES ∪ E(cid:48)
S ∪
x∈V (H) E(F x
2 ). In what follows, we will often identify certain subsets of the edge set of T with the
subgraphs of T consisting of these edges. For example, we will write ES[{x}, Sx] for the subgraph of T
consisting of all the edges in ES between x and Sx. Note that there are several possibilities for T as we
have several choices for the perfect Kr−1-matchings in (j) and (k).

1 ∪ F x

Lemma 6.1 will follow from Claims 1 and 2 below.

If T satisﬁes (a)–(n), then T is an (H, H(cid:48))r-transformer.

Claim 1:
Proof of Claim 1. Note that H ∪ EH ∪ EZ can be decomposed into e(H) copies of Kr, where each copy
of Kr has vertex set {x, y}∪ Zxy for some edge xy ∈ E(H). Similarly, H(cid:48)
∪ EH(cid:48) ∪ EZ can be decomposed
into e(H) copies of Kr.

Then

10

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Figure 1. Left: Subgraph of T1 associated with xy ∈ E(H). Right: Subgraph of T2
associated with x ∈ V (H) in the case when r = 4.

and have Kr-decompositions. Since

For each x ∈ V (H), note that (EH(cid:48) ∪ E(cid:48)
(cid:48)
S)[{φ(x)}, Sx ∪ Zx] ∪ F x

(cid:0)(EH(cid:48) ∪ E

S)[{φ(x)}, Sx ∪ Zx]∪ F x
1 and ES[{x}, Sx]∪ F x
(cid:1)

(cid:0)ES[{x}, Sx] ∪ F x

T2 ∪ EH(cid:48) =

(cid:91)

(cid:91)

∪

1

2

(cid:1),

x∈V (H)

x∈V (H)

2 are edge-disjoint

S[{φ(x)}, Sx]∪F x

it follows that T2∪EH(cid:48) has a Kr-decomposition. Similarly, for each x ∈ V (H), (EH∪ES)[{x}, Sx∪Zx]∪F x
and E(cid:48)
2 are edge-disjoint and have Kr-decompositions, so T2∪EH has a Kr-decomposition.
To summarise, H∪EH∪EZ, H(cid:48)
∪EH(cid:48)∪EZ, T2∪EH and T2∪EH(cid:48) all have Kr-decompositions. Therefore,
T ∪H = (H∪EH ∪EZ)∪(T2∪EH(cid:48)) has a Kr-decomposition, as does T ∪H(cid:48) = (H(cid:48)
∪EH(cid:48)∪EZ)∪(T2∪EH ).
Hence T is an (H, H(cid:48))r-transformer.
Claim 2: G contains a graph T satisfying (a)–(n) such that V (T ) ∩ B ⊆ V (H ∪ H(cid:48)).
which satisﬁes (a)–(n), T1 is r-partite with vertex classes (V (H ∪ H(cid:48))∩ Vj)∪{zxy
Vj} where 1 ≤ j ≤ r. Also, T [V (H ∪ H(cid:48))] is empty and every vertex z ∈ V (T1) \ V (H ∪ H(cid:48)) satisﬁes

Proof of Claim 2. We begin by ﬁnding a copy of T1 in G. It will be useful to note that, for any graph T
: xy ∈ E(H) and x, y /∈

1

j

(6.1)

dT1(z) = 2 + (r − 3) + 2 = r + 1.

xq−1
2

So T1 has degeneracy r + 1 rooted at V (H ∪ H(cid:48)). Since ˆδ(G) ≥ (1 − 1/(r + 1) + ε/2)n + |B|, we can ﬁnd
a copy of T1 in G such that V (T1) ∩ B ⊆ V (H ∪ H(cid:48)).
(cid:83)q−1
We now show that, after ﬁxing T1, we can extend T1 to T by ﬁnding a copy of T2. Consider any ordering
x1, . . . , x|H| on the vertices of H. Suppose we have already chosen Sx1, . . . , Sxq−1, F x1
and
and we are currently embedding Sxq . Let B(cid:48) := B ∪ V (T1) ∪
i=1 Sxi; that is, B(cid:48) is the
F x1
2 , . . . , F
set of vertices that are unavailable for Sxq , either because they have been used previously or they lie B.
Note that |B(cid:48)
| ≤ |T| +|B| ≤ 2ηn. We will choose suitable vertices for Sxq in the common neighbourhood
of xq and φ(xq).
To simplify notation, we write x := xq and assume that x ∈ V1 (the argument is identical in the other
cases). Choose a set V (cid:48)
r| (recall
that V (cid:48)

⊆ (NG(x) ∩ NG(φ(x))) \ B(cid:48) which is maximal subject to |V (cid:48)

2| = ··· = |V (cid:48)

1 , . . . , F

xq−1
1

j = V (cid:48)

∩ Vj). Note that for each 2 ≤ j ≤ r, we have

(cid:48)
|V
j| ≥ (1 − 1/(r + 1) + ε)n − (1/(r + 1) − ε)n − |B

2|. For every 2 ≤ j ≤ r and every v ∈ V (G) \ Vj, we have

dG(v, V

(cid:48)

(cid:48)
j ) ≥ n

− (1/(r + 1) − ε)n ≥ (1 − 1/(r − 1) + ε)n

(cid:48)

.

(cid:48)

| ≥ (1 − 2/(r + 1))n.

Let n(cid:48) := |V (cid:48)

(6.2)

Fx1Fx2ZxSxxφ(x)Kr−2xyφ(x)φ(y)ZxyCLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

11

Roughly speaking, we will choose Sx as a random subset of V (cid:48). For each 2 ≤ j ≤ r, choose each vertex
of V (cid:48)
j independently with probability p := (1 + ε/8)s/n(cid:48) and let S(cid:48)
that, for each j, E(|S(cid:48)
j|) = n(cid:48)p = (1 + ε/8)s. We can apply Lemma 2.2 to see that
(cid:48)
(cid:48)
j| − (1 + ε/8)s| ≥ εs/8) ≤ P(||S
P(||S
j|)/10)

j be the set of chosen vertices. Note

(cid:48)
j| − (1 + ε/8)s| ≥ εE(|S
−ε2s/300 ≤ 1/4(r − 1).

≤ 2e

(6.3)

Given a vertex v ∈ V (G) and 2 ≤ j ≤ r such that v /∈ Vj, note that

E(dG(v, S

(cid:48)
j))

(6.2)

≥ (1 − 1/(r − 1) + ε)n

p > (1 − 1/(r − 1) + ε)s.

(cid:48)

We will say that a vertex v ∈ V (G) is bad if there exists 2 ≤ j ≤ r such that v /∈ Vj and dG(v, S(cid:48)
(1−1/(r−1)+3ε/4)s, that is, the degree of v in S(cid:48)

j) <
j is lower than expected. We can again apply Lemma 2.2

to see that

(cid:48)
j))| ≥ εs/4)
(cid:48)
j))| ≥ εE(dG(v, S

(cid:48)
j))/10)

P(dG(v, S

contains a bad vertex. We have

So P(v is bad) ≤ 2(r − 1)e−ε2s/600 ≤ e−s1/2
(cid:88)
(cid:88)

(cid:48)
(cid:48)
j) ≤ (1 − 1/(r − 1) + 3ε/4)s) ≤ P(|dG(v, S
j) − E(dG(v, S
(cid:48)
≤ P(|dG(v, S
j) − E(dG(v, S
−ε2s/600.
. Let S(cid:48) :=(cid:83)r
≤ 2e
P(v ∈ S
P(v ∈ S
p + (b − 1)(r − 2))e

v∈V (cid:48)
(cid:48)
≤ (n

)P(v is bad) +

v∈Zx
≤ 2se

is bad) ≤

and v is bad) +

j=2 S(cid:48)

−s1/2

(cid:48)

P(S

v∈V (cid:48)

(6.4)

(cid:48)

(cid:48)

=

j. We say that the set S(cid:48) is bad if S(cid:48)
(cid:88)
(cid:88)

P(v is bad)

v∈Zx

P(v is bad)

∪ Zx

−s1/2

≤ 1/4.

We apply (6.3) and (6.4) to see that with probability at least 1/2, the set S(cid:48) chosen in this way is not
bad and, for each 2 ≤ j ≤ r, we have s ≤ |S(cid:48)
j| ≤ (1 + ε/4)s. Choose one such set S(cid:48). Delete at most εs/4
j . Since S(cid:48) was
vertices from each S(cid:48)
2| = ··· = |Sx
not bad, for each 2 ≤ j ≤ r and each vertex v ∈ (Sx ∪ Zx) \ Vj,
(6.5)

r | = s. Let Sx :=(cid:83)r

j ) ≥ (1 − 1/(r − 1) + 3ε/4)s − εs/4 = (1 − 1/(r − 1) + ε/2)s.

j satisfying |Sx

j to obtain sets Sx

dG(v, Sx

j=2 Sx

We now show that we can ﬁnd F x

2 satisfying (j)–(m). Let Gx := G[Zx ∪ Sx] − G[Zx]. Note
that Gx is a balanced (r − 1)-partite graph with vertex classes of size nx where s ≤ nx ≤ s + (r − 2)(b −
1)/(r − 1) < s + b. Using (6.5), we see that

1 and F x

ˆδ(Gx) ≥ (1 − 1/(r − 1) + ε/2)s ≥ (1 − 1/(r − 1) + ε/3)nx.

So, using Theorem 6.2, we can ﬁnd a perfect Kr−1-matching F x
use (6.5) to see that

1 in Gx. Finally, let G(cid:48) := G − F x

1 and

(cid:48)

ˆδ(G

[Sx]) ≥ (1 − 1/(r − 1) + ε/3)s.

So we can again apply Theorem 6.2, to ﬁnd a perfect Kr−1-matching F x
a copy of T satisfying (a)–(n) such that V (T ) ∩ B ⊆ V (H ∪ H(cid:48)).

2 in G(cid:48)[Sx]. In this way, we ﬁnd
(cid:3)

12

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

We now construct our absorber by combining several suitable transformers.
Let H be an r-partite multigraph on V = (V1, . . . , Vr) and let xy ∈ E(H). A Kr-expansion of xy is
deﬁned as follows. Consider a copy Fxy of Kr on vertex set {u1, . . . , ur} such that uj ∈ Vj \ V (H) for all
1 ≤ j ≤ r. Let j1, j2 be such that x ∈ Vj1 and y ∈ Vj2. Delete xy from H and uj1uj2 from Fxy and add
edges joining x to uj2 and joining y to uj1. Let Hexp be the graph obtained by Kr-expanding every edge
of H, where the Fxy are chosen to be vertex-disjoint for diﬀerent edges xy ∈ E(H).
Fact 6.3. Suppose that the graph H(cid:48) is obtained from a graph H by Kr-expanding the edge xy ∈ E(H)
as above. Then the graph obtained from H(cid:48) by identifying x and uj1 is H with a copy of Kr attached to
x.
(cid:1). Note that Mh
Let h ∈ N. We deﬁne a graph Mh as follows. Take a copy of Kr on V (consisting of one vertex in each

be the graph obtained by Kr-expanding every edge of M . We have |Mh| = r + hr(cid:0)r

Vj) and replace each edge by h multiedges. Let M denote the resulting multigraph. Let Mh := Mexp

has degeneracy r − 1. To see this, list all vertices in V (M ) (in any order) followed by the vertices in
V (Mh \ M ) (in any order).

We will now apply Lemma 6.1 twice in order to ﬁnd an (H, Mh)r-transformer in G.

2

2

(cid:1). Let M(cid:48)

h)r-transformer T such that V (T ) ∩ B ⊆ V (H ∪ M(cid:48)

Kr-divisible graph on V with |H| ≤ b. Let h := e(H)/(cid:0)r

Lemma 6.4. Let r ≥ 3 and 1/n (cid:28) η (cid:28) 1/s (cid:28) ε, 1/b, 1/r ≤ 1. Let G be an r-partite graph on
V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Suppose that ˆδ(G) ≥ (1 − 1/(r + 1) + ε)n. Let H be a
h be a partition-respecting copy of Mh
on V which is vertex-disjoint from H. Let B ⊆ V be a set of at most ηn vertices. Then G contains an
(H, M(cid:48)
Proof. We construct a graph Hatt as follows. Start with the graph H. For each edge of H, arbitrarily
choose one of it endpoints x and attach a copy of Kr (found in G \ ((V (H ∪ M(cid:48)
h) ∪ B) \ {x})) to x. The
copies of Kr should be chosen to be vertex-disjoint outside V (H). Write Hatt for the resulting graph.
Let H(cid:48)
h)∪ B). Note that we are able to ﬁnd
these graphs since both have degeneracy r − 1 and ˆδ(G) ≥ (1 − 1/(r + 1) + ε)n.
By Fact 6.3, Hatt is a partition-respecting copy of a graph obtained from H(cid:48)
and this is also the case for M(cid:48)
in Vj. (We are able to do this since these vertices are non-adjacent with disjoint neighbourhoods.)

h. To see the latter, for each 1 ≤ j ≤ r, identify all vertices of H(cid:48)

exp be a partition-respecting copy of Hexp in G\ (V (Hatt ∪ M(cid:48)

exp by identifying vertices,
exp lying

h) and |T| ≤ 3s2.

Apply Lemma 6.1 to ﬁnd an (H(cid:48)
| ≤ s2. Then apply Lemma 6.1 again to ﬁnd an (H(cid:48)
|T (cid:48)
h) and |T (cid:48)(cid:48)
that V (T (cid:48)(cid:48)) ∩ B ⊆ V (M(cid:48)
exp ∪ (Hatt − H). Then T is edge-disjoint from H ∪ M(cid:48)
Let T := T (cid:48)
∪ H(cid:48)

exp, Hatt)r-transformer T (cid:48) in G− M(cid:48)
| ≤ s2.
(cid:48)

exp, M(cid:48)

∪ T (cid:48)(cid:48)

(cid:48)(cid:48)

h such that V (T (cid:48))∩ B ⊆ V (H) and
h)r-transformer T (cid:48)(cid:48) in G − (Hatt ∪ T (cid:48)) such

h. Note that

both of which have Kr-decompositions. Therefore T is an (H, M(cid:48)
Finally, observe that V (T ) ∩ B = V (T (cid:48)

∪ H
(cid:48)(cid:48)
∪ M

∪ Hatt) ∪ (T
(cid:48)
(cid:48)
exp) ∪ (T
∪ H
∪ Hatt) ∩ B ⊆ V (H ∪ M(cid:48)
∪ T (cid:48)(cid:48)

(cid:48)
h) ∪ (Hatt − H),

h).

T ∪ H = (T
(cid:48)
T ∪ M
h = (T

(cid:48)
exp) and

h)r-transformer. Moreover, |T| ≤ 3s2.
(cid:3)

We now have all of the necessary tools to ﬁnd an absorber for H in G.

Lemma 6.5. Let r ≥ 3 and let 1/n (cid:28) η (cid:28) 1/s (cid:28) ε, 1/b, 1/r ≤ 1. Let G be an r-partite graph on
V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Suppose that ˆδ(G) ≥ (1 − 1/(r + 1) + ε)n. Let H be a
Kr-divisible graph on V with |H| ≤ b. Let B ⊆ V be a set of at most ηn vertices. Then G contains an
absorber A for H such that V (A) ∩ B ⊆ V (H) and |A| ≤ s3.
Proof.
:= G \ (V (H) ∪ B). Write hKr for the graph consisting of
h vertex-disjoint copies of Kr. Since ˆδ(G(cid:48)) ≥ (1 − 1/(r + 1) + ε/2)n, we can choose vertex-disjoint
(partition-respecting) copies of Mh and hKr in G(cid:48) (and call these Mh and hKr again). Use Lemma 6.4

Let h := e(H)/(cid:0)r

(cid:1). Let G(cid:48)

2

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

13

to ﬁnd an (H, Mh)r-transformer T (cid:48) in G − hKr such that V (T (cid:48)) ∩ B ⊆ V (H) and |T (cid:48)
| ≤ 3s2. Apply
Lemma 6.4 again to ﬁnd an (hKr, Mh)r-transformer T (cid:48)(cid:48) in G − (H ∪ T (cid:48)) which avoids B and satisﬁes
| ≤ 3s2. It is easy to see that T := T (cid:48)
|T (cid:48)(cid:48)
Let A := T ∪ hKr. Note that both A and A ∪ H = (T ∪ H) ∪ hKr have Kr-decompositions. So A is
an absorber for H. Moreover, V (A) ∩ B ⊆ V (T (cid:48)) ∩ B ⊆ V (H) and |A| ≤ s3.
(cid:3)

∪ Mh is an (H, hKr)r-transformer.

∪ T (cid:48)(cid:48)

⊆ H, there is a distinct AH(cid:48) ∈ A such that AH(cid:48) is an absorber for H(cid:48).

6.1. Absorbing sets. Let H be a collection of graphs on the vertex set V = (V1, . . . , Vr). We say that
A is an absorbing set for H if A is a collection of edge-disjoint graphs and, for every H ∈ H and every
Kr-divisible subgraph H(cid:48)
Lemma 6.6. Let r ≥ 3 and 1/n (cid:28) η (cid:28) ε, 1/b, 1/r ≤ 1. Let G be an r-partite graph on V = (V1, . . . , Vr)
with |V1| = ··· = |Vr| = n. Suppose that ˆδ(G) ≥ (1 − 1/(r + 1) + ε)n. Let m ≤ ηn2 and let H be a
collection of m edge-disjoint graphs on V = (V1, . . . , Vr) such that each vertex v ∈ V appears in at most
ηn of the elements of H and |H| ≤ b for each H ∈ H. Then G contains an absorbing set A for H such

that ∆((cid:83)

A) ≤ εn.

We repeatedly use Lemma 6.5 and aim to avoid any vertices which have been used too often.

2) Kr-divisible subgraphs so m(cid:48)

Proof. Enumerate the Kr-divisible subgraphs of all H ∈ H as H1, . . . , Hm(cid:48). Note that each H ∈ H
can have at most 2e(H) ≤ 2(b
2)ηn2. For each v ∈ V (G) and each
0 ≤ j ≤ m, let s(v, j) be the number of indices 1 ≤ i ≤ j such that v ∈ V (Hi). Note that s(v, j) ≤ 2(b
2)ηn.
Let s ∈ N be such that η (cid:28) 1/s (cid:28) ε, 1/b, 1/r. Suppose that we have already found absorbers
A1, . . . , Aj−1 for H1, . . . , Hj−1 respectively such that |Ai| ≤ s3, for all 1 ≤ i ≤ j − 1, and, for every
v ∈ V (G),
where Gj−1 :=(cid:83)
(6.6)

1≤i≤j−1 Ai. We show that we can ﬁnd an absorber Aj for Hj in G− Gj−1 which satisﬁes

dGj−1(v) ≤ η1/2n + (s(v, j − 1) + 1)s3,

≤ 2(b

(6.6) with j replacing j − 1.

(cid:1)
Let B := {v ∈ V (G) : dGj−1(v) ≥ η1/2n}. We have

2m(cid:48)(cid:0)s3

|B| ≤

We have

2e(Gj−1)
η1/2n ≤

2

η1/2n ≤

2(b

2)+1ηn2s6
η1/2n

≤ η1/3n.

(6.6)

ˆδ(G − Gj−1)

≥ (1 − 1/(r + 1) + ε)n − η1/2n − (s(v, j − 1) + 1)s3
≥ (1 − 1/(r + 1) + ε)n − η1/2n − (2(b

2)ηn + 1)s3 > (1 − 1/(r + 1) + ε/2)n.

So we can apply Lemma 6.5 (with ε/2, η1/3, G− Gj−1 and Hj playing the roles of ε, η, G and H) to ﬁnd
an absorber Aj for Hj in G − Gj−1 such that V (Aj) ∩ B ⊆ V (Hj) and |Aj| ≤ s3.
We now check that (6.6) holds with j replacing j − 1. If v ∈ V (G)\ B, this is clear. Suppose then that
v ∈ B. If v ∈ V (Aj), then v ∈ V (Hj) and s(v, j) = s(v, j − 1) + 1. So in all cases,

dGj (v) ≤ η1/2n + (s(v, j) + 1)s3.

Continue in this way until we have found an absorber Ai for each Hi. Then A := {Ai : 1 ≤ i ≤ m(cid:48)

an absorbing set. Using (6.6),

∆(cid:0)(cid:91)

(cid:1) = ∆(Gm(cid:48)) ≤ η1/2n + (2(b

A

2)ηn + 1)s3 ≤ εn,

as required.

} is

(cid:3)

14

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

7. Partitions and random subgraphs

In this section we consider a sequence P1, . . . ,P(cid:96) of successively ﬁner partitions which will underlie
our iterative absorption process. We will also construct corresponding sparse quasirandom subgraphs Ri
which will be used to ‘smooth out’ the leftover from the approximate decomposition in each step of the
process.

Let G be an r-partite graph on (V1, . . . , Vr). An (α, k, δ)-partition for G on (V1, . . . , Vr) is a partition

j = U i ∩ Vj);

P = {U 1, . . . , U k} of V (G) such that the following hold:
(Pa1) for each 1 ≤ j ≤ r, {U i
(Pa2) for each 1 ≤ i ≤ k, |U i
(Pa3) for each v ∈ V (G), each 1 ≤ i ≤ k and each 1 ≤ j ≤ r,

j : 1 ≤ i ≤ k} is an equitable partition of Vj (recall that U i
1| = ··· = |U i
r|;
|dG(v, U i

j ) − dG(v, Vj)/k| < α|U i
j|;
(Pa4) for each 1 ≤ i ≤ k, each 1 ≤ j ≤ r and each v /∈ Vj, dG(v, U i
j ) ≥ δ|U i
j|.
We say that P = {U 1, . . . , U k} is a k-partition if it satisﬁes (Pa1) and (Pa2).
The following proposition guarantees a (n−1/3/2, k, δ − n−1/3/2)-partition of any suﬃciently large
balanced r-partite graph G with ˆδ(G) ≥ δn. To prove this result, it suﬃces to consider an equitable
partition U 1
Proposition 7.1. Let k, r ∈ N. There exists n0 such that if n ≥ n0 and G is any r-partite graph
on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n and ˆδ(G) ≥ δn, then G has a (ν, k, δ − ν)-partition, where
ν := n−1/3/2.
(cid:3)

j of Vj chosen uniformly at random (with |U 1

j | ≤ ··· ≤ |U k

j , U 2

j , . . . , U k

j |).

We say that P1,P2, . . . ,P(cid:96) is an (α, k, δ, m)-partition sequence for G on (V1, . . . , Vr) if, writing P0 :=

{V (G)},
(S1) for each 1 ≤ i ≤ (cid:96), Pi reﬁnes Pi−1;
(S2) for each 1 ≤ i ≤ (cid:96) and each W ∈ Pi−1, Pi[W ] is an (α, k, δ)-partition for G[W ];
(S3) for each 1 ≤ i ≤ (cid:96), all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3, each W ∈ Pi−1, each U ∈ Pi[W ] and each

v ∈ Wj1,

|dG(v, Uj2) − dG(v, Uj3)| < α|Uj1|;

(S4) for each U ∈ P(cid:96) and each 1 ≤ j ≤ r, |Uj| = m or m − 1.
Note that (S2) and (Pa2) together imply that |Uj1| = |Uj2| for each 1 ≤ i ≤ (cid:96), each U ∈ Pi and all
1 ≤ j1, j2 ≤ r.
By successive applications of Proposition 7.1, we immediately obtain the following result which guar-
antees the existence of a suitable partition sequence (for details see [26]).

≤ m ≤ km(cid:48).

Lemma 7.2. Let k, r ∈ N with k ≥ 2 and let 0 < α < 1. There exists m0 such that, for all m(cid:48)
≥ m0,
any Kr-divisible graph G on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n ≥ km(cid:48) and ˆδ(G) ≥ δn has an
(α, k, δ − α, m)-partition sequence for some m(cid:48)
(cid:3)
Suppose that we are given a k-partition P of G. The following proposition ﬁnds a quasirandom
spanning subgraph R of G so that each vertex in R has roughly the expected number of neighbours in
each set U ∈ P. The proof is an easy application of Lemma 2.1.
Proposition 7.3. Let 1/n (cid:28) α, ρ, 1/k, 1/r ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Suppose that P is a k-partition for G. Let S be a collection of at most n2 subsets
of V (G). Then there exists R ⊆ G[P] such that for all 1 ≤ j ≤ r, all distinct x, y ∈ V (G), all U ∈ P and
all S ∈ S:

• |dR(x, Uj) − ρdG[P](x, Uj)| < α|Uj|;

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

15

• |dR({x, y}, Uj) − ρ2dG[P]({x, y}, Uj)| < α|Uj|;
• |dG(y, NR(x, Uj)) − ρdG(y, NG[P](x, Uj))| < α|Uj|;
• |dR(y, Sj) − ρdG[P](y, Sj)| < αn.

(cid:3)

We need to reserve some quasirandom subgraphs Ri of G at the start of our proof, whilst the graph
G is still almost balanced with respect to the partition sequence. We will add the edges of Ri back after
ﬁnding an approximate decomposition of G[Pi] in order to assume the leftover from this approximate
decomposition is quasirandom. The next lemma gives us suitable subgraphs for Ri.
Lemma 7.4. Let 1/m (cid:28) α (cid:28) ρ, 1/k, 1/r ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with |V1| =
··· = |Vr|. Suppose that P1, . . . ,P(cid:96) is a (1, k, 0, m)-partition sequence for G. Let P0 := {V (G)} and,
for each 0 ≤ q ≤ (cid:96), let Gq := G[Pq]. Then there exists a sequence of graphs R1, . . . , R(cid:96) such that
Rq ⊆ Gq − Gq−1 for each q and the following holds. For all 1 ≤ q ≤ (cid:96), all 1 ≤ j ≤ r, all W ∈ Pq−1, all
distinct x, y ∈ W and all U ∈ Pq[W ]:
(i) |dRq (x, Uj) − ρdGq (x, Uj)| < α|Uj|;
(ii) |dRq ({x, y}, Uj) − ρ2dGq ({x, y}, Uj)| < α|Uj|;
(iii) dG(cid:48)
G(cid:48)
(cid:96)+1 := G and G(cid:96)+1 := G.

(y, NRq (x, Uj)) ≥ ρdGq+1(y, NGq (x, Uj)) − 3ρ2|Uj|, where G(cid:48)

q+1 := Gq+1 − Rq+1 if q ≤ (cid:96) − 1,

q+1

Proof. For 1 ≤ q ≤ (cid:96), we say that the sequence of graphs R1, . . . , Rq is good if Ri ⊆ Gi − Gi−1 and for
all 1 ≤ i ≤ q, all 1 ≤ j ≤ r, all W ∈ Pi−1, all distinct x, y ∈ W and all U ∈ Pi[W ]:
(a) (i) and (ii) hold (with q replaced by i);
(b) |dGi+1(y, NRi(x, Uj)) − ρdGi+1(y, NGi(x, Uj))| < α|Uj|;
(c) if i ≤ q − 1, dRi+1(y, NRi(x, Uj)) < ρdGi+1(y, NRi(x, Uj)) + α|Uj|.
Suppose 1 ≤ q ≤ (cid:96) and we have found a good sequence of graphs R1, . . . , Rq−1. We will ﬁnd Rq such
that R1, . . . , Rq is good. Let W ∈ Pq−1, let S1 be the empty set and, if q ≥ 2, let W (cid:48)
∈ Pq−2 be such that
W ⊆ W (cid:48) and let Sq := {NRq−1(x, W ) : x ∈ W (cid:48)
}. Apply Proposition 7.3 (with |W|/r, Gq+1[W ], Pq[W ]
and Sq playing the roles of n, G, P and S) to ﬁnd RW ⊆ Gq+1[W ][Pq[W ]] = Gq[W ] such that:

|dRW (x, Uj) − ρdGq (x, Uj)| < α|Uj|,
|dRW ({x, y}, Uj) − ρ2dGq ({x, y}, Uj)| < α|Uj|,
|dGq+1(y, NRW (x, Uj)) − ρdGq+1(y, NGq (x, Uj))| < α|Uj|,
|dRW (y, Sj) − ρdGq (y, Sj)| < α|Wj|,

for all 1 ≤ j ≤ r, all distinct x, y ∈ W , all U ∈ Pq[W ] and all S ∈ Sq. Set Rq :=(cid:83)

(7.1)

W∈Pq−1 RW . It is clear
that R1, . . . , Rq satisfy (a) and (b). We now check that (c) holds when 1 ≤ i = q − 1. Let 1 ≤ j ≤ r,
W ∈ Pq−2, x, y ∈ W be distinct and U ∈ Pq−1[W ]. If y /∈ U , then dRq (y, Uj) = 0 and so (c) holds. If
y ∈ U , then dRq (y, NRq−1(x, U )) = dRU (y, NRq−1(x, U )) and (c) follows by replacing W and S by U and
NRq−1(x, U ) in property (7.1). So R1, . . . , Rq is good.
So G contains a good sequence of graphs R1, . . . , R(cid:96). We will now check that this sequence also satisﬁes
(iii). If q = (cid:96), this follows immediately from (b). Let 1 ≤ q < (cid:96), 1 ≤ j ≤ r, W ∈ Pq−1, x, y ∈ W be
distinct and U ∈ Pq[W ]. We have

dRq+1(y, NRq (x, Uj))

Therefore,

(c)

(b)

< ρdGq+1(y, NRq (x, Uj)) + α|Uj|
< ρ2dGq+1(y, NGq (x, Uj)) + (αρ + α)|Uj| ≤ 2ρ2|Uj|.

dG(cid:48)

q+1

(y, NRq (x, Uj)) = dGq+1(y, NRq (x, Uj)) − dRq+1(y, NRq (x, Uj))

(b)

≥ ρdGq+1(y, NGq (x, Uj)) − 3ρ2|Uj|.

16

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

So R1, . . . , R(cid:96) satisfy (i)–(iii).

(cid:3)

We apply Lemma 7.4 when P1, . . . ,P(cid:96) is an (α, k, 1 − 1/r + ε, m)-partition sequence for G to obtain

the following result. For details of the proof, see [26].
Corollary 7.5. Let 1/m (cid:28) α (cid:28) ρ, 1/k (cid:28) ε, 1/r ≤ 1. Let G be a Kr-divisible graph on (V1, . . . , Vr)
with |V1| = ··· = |Vr|. Suppose that P1, . . . ,P(cid:96) is an (α, k, 1 − 1/r + ε, m)-partition sequence for G. Let
P0 := {V (G)} and Gq := G[Pq] for 0 ≤ q ≤ (cid:96). There exists a sequence of graphs R1, . . . , R(cid:96) such that
Rq ⊆ Gq − Gq−1 for each 1 ≤ q ≤ (cid:96) and the following holds. For all 1 ≤ q ≤ (cid:96), all 1 ≤ j, j(cid:48)
≤ r, all
W ∈ Pq−1, all distinct x, y ∈ W and all U, U(cid:48)
(i) dRq (x, Uj) < ρdGq (x, Uj) + α|Uj|;
(ii) dRq ({x, y}, Uj) < (ρ2 + α)|Uj|;
(iii) if x /∈ U ∪ U(cid:48)
(iv) if x /∈ U , y ∈ U and x, y /∈ Vj, then

∪ Vj ∪ Vj(cid:48), |dRq (x, Uj) − dRq (x, U(cid:48)

j(cid:48))| < 3α|Uj|;

∈ Pq[W ]:

where G(cid:48)

q+1 := Gq+1 − Rq+1 if q ≤ (cid:96) − 1 and G(cid:48)

dG(cid:48)

q+1

(y, NRq (x, Uj)) ≥ ρ(1 − 1/(r − 1))dGq (x, Uj) + ρ5/4|Uj|,

(cid:96)+1 := G.

(cid:3)

8. A remainder of low maximum degree

The aim of this section is to prove the following lemma which lets us assume that the remainder of G

after ﬁnding an η-approximate decomposition has small maximum degree.
Lemma 8.1. Let 1/n (cid:28) α (cid:28) η (cid:28) γ (cid:28) ε < 1/r < 1. Let G be an r-partite graph on (V1, . . . , Vr)
with |V1| = ··· = |Vr| = n and ˆδ(G) ≥ (ˆδη
Kr + ε)n. Suppose also that, for all 1 ≤ j1, j2 ≤ r and every
v /∈ Vj1 ∪ Vj2,
(8.1)
Then there exists H ⊆ G such that G − H has a Kr-decomposition and ∆(H) ≤ γn.

|dG(v, Vj1) − dG(v, Vj2)| < αn.

Our strategy for the proof of Lemma 8.1 is as follows. We ﬁrst remove a sparse random subgraph
H of G and then choose an η-approximate Kr-decomposition of G − H. Now consider the remainder
R obtained from G by deleting all edges in the copies of Kr in this decomposition. Suppose that v is
a vertex whose degree in R is too high. Our aim will be to ﬁnd a Kr−1-matching in a sparse random
subgraph whose vertex set is the neighbourhood of v in G. Each vertex in this random subgraph sees,
on average, at most ρdG(v)/(r − 1) (cid:28) (1 − 1/(r − 1) + ε)dG(v)/(r − 1) vertices in each other part, so
Theorem 6.2 alone is of no use. But Theorem 6.2 can be combined with the Regularity lemma in order
to ﬁnd the desired Kr-matching.

8.1. Regularity. In this section, we introduce a version of the Regularity lemma which we will use to
prove Lemma 8.1.

Let G be a bipartite graph on (A, B). For non-empty sets X ⊆ A, Y ⊆ B, we deﬁne the density of
G[X, Y ] to be dG(X, Y ) := eG(X, Y )/|X||Y |. Let ε > 0. We say that G is ε-regular if for all sets X ⊆ A
and Y ⊆ B with |X| ≥ ε|A| and |Y | ≥ ε|B| we have

The following simple result follows immediately from this deﬁnition.

|dG(A, B) − dG(X, Y )| < ε.

Proposition 8.2. Suppose that 0 < ε ≤ α ≤ 1/2. Let G be a bipartite graph on (A, B). Suppose that
⊆ A, B(cid:48)
G is ε-regular with density d. If A(cid:48)
| ≥ α|B| then G[A(cid:48), B(cid:48)] is
(cid:3)
ε/α-regular and has density greater than d − ε.

| ≥ α|A| and |B(cid:48)

⊆ B with |A(cid:48)

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

17

Proposition 8.2 shows that regularity is robust, that is, it is not destroyed by deleting a small number
of vertices. The next observation allows us to delete a small number of edges at each vertex and still
maintain regularity. The proof again follows from the deﬁnition.

Proposition 8.3. Let n ∈ N and let 0 < γ (cid:28) ε ≤ 1. Let G be a bipartite graph on (A, B) with
|A| = |B| = n. Suppose that G is ε-regular with density d. Let H ⊆ G with ∆(H) ≤ γn and let
G(cid:48) := G − H. Then G(cid:48) is 2ε-regular and has density greater than d − ε/2.
(cid:3)

The following proposition takes a graph G on (V1, . . . , Vr) where each pair of vertex classes induces an
ε-regular pair and allows us to ﬁnd a Kr-matching covering most of the vertices in G. Part (i) follows
from Proposition 8.2 and the deﬁnition of regularity. For (ii), apply (i) repeatedly until only (cid:100)ε1/rn(cid:101)
vertices remain uncovered in each Vj.
Proposition 8.4. Let 1/n (cid:28) ε (cid:28) d, 1/r ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with |V1| =
··· = |Vr| = n. Suppose that, for all 1 ≤ j1 < j2 ≤ r, the graph G[Vj1, Vj2] is ε-regular with density at
least d.
(i) For each 1 ≤ j ≤ r, let Wj ⊆ Vj with |Wj| = (cid:100)ε1/rn(cid:101). Then G[W1, . . . , Wr] contains a copy of Kr.
(cid:3)
(ii) The graph G contains a Kr-matching which covers all but at most 2rε1/rn vertices of G.

We will use a version of Szemer´edi’s Regularity lemma [25] stated for r-partite graphs. It is proved in

the same way as the non-partite degree version.

Lemma 8.5 (Degree form of the r-partite Regularity lemma). Let 0 < ε < 1 and k0, r ∈ N. Then there
is an N = N (ε, k0, r) such that the following holds for every 0 ≤ d < 1 and for every r-partite graph G
on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n ≥ N . There exists a partition P = {U 0, . . . , U k} of V (G),
m ∈ N and a spanning subgraph G(cid:48) of G satisfying the following:
(i) k0 ≤ k ≤ N ;
(ii) for each 1 ≤ j ≤ r, |U 0
(iii) for each 1 ≤ i ≤ k and each 1 ≤ j ≤ r, |U i
(iv) for each 1 ≤ j ≤ r and each v ∈ V (G), dG(cid:48)(v, Vj) > dG(v, Vj) − (d + ε)n;
(v) for all but at most εk2 pairs U i1

where 1 ≤ i1, i2 ≤ k and 1 ≤ j1 < j2 ≤ r, the graph G(cid:48)[U i1

j| = m;

j | ≤ εn;

j1 , U i2
j2

j1 , U i2
j2 ]

is ε-regular and has density either 0 or > d.

We deﬁne the reduced graph R as follows. The vertex set of R is the set of clusters {U i
: 1 ≤
i ≤ k and 1 ≤ j ≤ r}. For each U, U(cid:48)
∈ V (R), U U(cid:48) is an edge of R if the subgraph G(cid:48)[U, U(cid:48)] is ε-
regular and has density greater than d. Note that R is a balanced r-partite graph with vertex classes
Wj := {U i
j : 1 ≤ i ≤ k} for 1 ≤ j ≤ r. The following simple proposition relates the minimum degree of
G and the minimum degree of R.
Proposition 8.6. Suppose that 0 < 2ε ≤ d ≤ c/2. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n and ˆδ(G) ≥ cn. Suppose that G has a partition P = {U 0, . . . , U k} and a subgraph
G(cid:48)
(cid:3)

⊆ G as given by Lemma 8.5. Let R be the reduced graph of G. Then ˆδ(R) ≥ (c − 2d)k.

j

8.2. Degree reduction. At the beginning of our proof of Lemma 8.1, we will reserve a random subgraph
H of G. Proposition 8.8 below ensures that we can partition the neighbourhood of each vertex so that H
induces ε-regular graphs between these parts. In our proof of Proposition 8.8, we will use the following
well-known result for which we omit the proof.
Proposition 8.7. Let 1/n (cid:28) ε (cid:28) d, ρ ≤ 1. Let G be a bipartite graph on (A, B) with |A| = |B| = n.
Suppose that G is ε-regular with density at least d. Let H be a graph formed by taking each edge of G
independently with probability ρ. Then, with probability at least 1 − 1/n2, H is 4ε-regular with density at
(cid:3)
least ρd/2.

18

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Proposition 8.8. Let 1/n (cid:28) α (cid:28) 1/N (cid:28) 1/k0 ≤ ε∗
(cid:28) d (cid:28) ρ < ε, 1/r < 1. Let G be an r-partite graph
on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n and ˆδ(G) ≥ (1 − 1/r + ε)n. Suppose that for all 1 ≤ j1, j2 ≤ r
and every v /∈ Vj1 ∪ Vj2, |dG(v, Vj1) − dG(v, Vj2)| < αn. Then there exists H ⊆ G satisfying the following
properties:
(i) For each 1 ≤ j ≤ r and each v ∈ V (G), |dH (v, Vj) − ρdG(v, Vj)| < αn. In particular, for any
(ii) For each vertex v ∈ V (G), there exists a partition P(v) = {U 0(v), . . . , U kv (v)} of NG(v) and mv ∈ N

1 ≤ j1, j2 ≤ r such that v /∈ Vj1 ∪ Vj2, |dH (v, Vj1) − dH (v, Vj2)| < 3αn.
such that:

• k0 ≤ kv ≤ N ;
• for each 1 ≤ j ≤ r, |U 0
• for each 1 ≤ i ≤ kv and each 1 ≤ j ≤ r such that v /∈ Vj, |U i
• for each 1 ≤ i ≤ kv and all 1 ≤ j1 < j2 ≤ r such that v /∈ Vj1 ∪ Vj2, the graph H[U i

j (v)| ≤ ε∗n;

is ε∗-regular with density greater than d.

j (v)| = mv;

j1(v), U i

j2(v)]

Roughly speaking, (ii) says that for each v ∈ V (G) the reduced graph of H[NG(v)] has a perfect

Let H be the graph formed by taking each edge of G independently with probability ρ. For

Kr−1-matching.
Proof.
each 1 ≤ j ≤ r and each v ∈ V (G), Lemma 2.1 gives

P(|dH (v, Vj) − ρdH (v, Vj)| ≥ αn) ≤ 2e

−2α2n < 1/rn2.

So the probability that there exist 1 ≤ j ≤ r and v ∈ V (G) such that |dH (v, Vj) − ρdG(v, Vj)| ≥ αn is at
most rn/rn2 = 1/n. Let 1 ≤ j1, j2 ≤ r. Note that if v /∈ Vj1 ∪ Vj2 and |dH (v, Vj) − ρdG(v, Vj)| < αn for
j = j1, j2, then

|dH (v, Vj1) − dH (v, Vj2)| < |ρdG(v, Vj1) − ρdG(v, Vj2)| + 2αn < 3αn.

So H satisﬁes (i) with probability at least 1 − 1/n.
We will now show that H satisﬁes (ii) with probability at least 1/2. We ﬁnd partitions of the neigh-
bourhood of each vertex v ∈ V (G) as follows. To simplify notation, we will assume that v ∈ V1 (the
argument is identical for the other cases). For all 2 ≤ j1, j2 ≤ r, we have |dG(v, Vj1) − dG(v, Vj2)| < αn.
So, there exists nv and, for each 2 ≤ j ≤ r, a subset Vj(v) ⊆ NG(v, Vj) such that |Vj(v)| > dG(v, Vj)− αn
and

Let Gv denote the balanced (r − 1)-partite graph G[V2(v), . . . , Vr(v)]. Note that
(8.2)

+ ε

nv.

ˆδ(Gv) ≥ nv −

n
r

+ εn ≥

1 −

|Vj(v)| = nv ≥ ˆδ(G) ≥ (1 − 1/r)n.

(cid:18)

(cid:19)

1
r − 1

Apply Lemma 8.5 (with ε∗/4, 2d/ρ, k0 and Gv playing the roles of ε, d, k0 and G) to ﬁnd a partition
Q(v) = {W 0(v), . . . , W kv (v)} of V (Gv) satisfying properties (i)–(v) of Lemma 8.5. Let mv := |W 1
2 (v)|.
Let Rv denote the reduced graph corresponding to this partition. Proposition 8.6 together with (8.2)
implies that

ˆδ(Rv) ≥ (1 − 1/(r − 1) + ε/2)kv.

j | < |W 0

So we can use Theorem 6.2 to ﬁnd a perfect Kr−1-matching Mv in Rv. Let U 0(v) := W 0(v) ∪ (NG(v) \
j | + αn ≤ ε∗n. Let P(v) := {U 0(v), . . . , U kv (v)} be
V (Gv)). Note that for each 2 ≤ j ≤ r, |U 0
a partition of NG(v) which is chosen such that, for each 1 ≤ i ≤ kv, {U i
j (v) : 2 ≤ j ≤ r} induces a
copy of Kr−1 in Mv. By the deﬁnition of Rv, for each 1 ≤ i ≤ kv and all 2 ≤ j1 < j2 ≤ r, the graph
G[U i
j1(v), U i
Fix 1 ≤ i ≤ kv and 2 ≤ j1 < j2 ≤ r. Proposition 8.7 (with mv, ε∗/4, 2d/ρ, G[U i
j2(v)] and
j2(v)] is ε∗-regular and has
j1(v), U i
H[U i
density greater than d with probability at least 1 − 1/m2
v.

j2(v)] is ε∗/4-regular with density greater than 2d/ρ.

j2(v)] playing the roles of n, ε, d, G and H) gives that H[U i

j1(v), U i

j1(v), U i

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

19

j2(v) ∈ E(Mv). There are kv choices for i and, for each i, there are(cid:0)r−1

We require the graph H[U i
U i
j1(v)U i
So the probability that, for ﬁxed v ∈ V (G), there exists an edge U i
ε∗-regular with density greater than d is at most

j1(v), U i

j1(v)U i

2

j2(v)] to be ε∗-regular with density greater than d for every edge

(cid:1) choices for j1 and j2.

j2(v) ∈ E(Mv) which fails to be

kvr2 1
m2
v

<

1

2rn

.

We multiply this probability by rn for each of the rn choices of v to see that H satisﬁes property (ii) with
probability at least 1 − rn/2rn = 1/2. Hence, the graph H satisﬁes both (i) and (ii) with probability at
(cid:3)
least 1/2 − 1/n > 0. So we can choose such a graph H.

In order to ﬁnd an η-approximate Kr-decomposition in a graph G, we would like to use the deﬁnition
of ˆδη
Kr which requires G to be Kr-divisible. The next proposition shows that, provided that dG(v, Vj1) is
close to dG(v, Vj2) for all 1 ≤ j1, j2 ≤ r and v /∈ Vj1 ∪ Vj2, G can be made Kr-divisible by removing only
a small number of edges.
Proposition 8.9. Let 1/n (cid:28) α (cid:28) γ (cid:28) 1/r < 1. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n and ˆδ(G) ≥ (1/2 + 2γ/r)n. Suppose that, for all 1 ≤ j1, j2 ≤ r and every
v ∈ V (G) \ (Vj1 ∪ Vj2), |dG(v, Vj1) − dG(v, Vj2)| < αn. Then there exists H ⊆ G such that G − H is
Kr-divisible and ∆(H) ≤ γn.

To prove Proposition 8.9, we require the following result whose proof is based on the Max-Flow-Min-

a∈A na =(cid:80)

Cut theorem.
(ξ − α)n ≤ nv ≤ (ξ + α)n and such that(cid:80)
Proposition 8.10. Suppose that 1/n (cid:28) α (cid:28) ξ (cid:28) 1. Let G be a bipartite graph on (A, B) with
|A| = |B| = n. Suppose that δ(G) ≥ (1/2 + 4ξ)n. For every vertex v ∈ V (G), let nv ∈ N be such that
b∈B nb. Then G contains a spanning graph G(cid:48) such
that dG(cid:48)(v) = nv for every v ∈ V (G).
Proof. We will use the Max-Flow-Min-Cut theorem. Orient every edge of G towards B and give
Let c0 :=(cid:80)
each edge capacity one. Add a source vertex s∗ which is attached to every vertex a ∈ A by an edge of
capacity na. Add a sink vertex t∗ which is attached to every vertex in b ∈ B by an edge of capacity nb.
b∈B nb. Note that an integer-valued c0-ﬂow corresponds to the desired spanning
graph G(cid:48) in G. So, by the Max-Flow-Min-Cut theorem, it suﬃces to show that every cut has capacity at
least c0.
Consider a minimal cut C. Let S ⊆ A be the set of all vertices a ∈ A for which s∗a /∈ C and let T ⊆ B
be the set of all b ∈ B for which bt∗ /∈ C. Let S(cid:48) := A \ S and T (cid:48) := B \ T . Then C has capacity

a∈A na =(cid:80)

(cid:88)

s∈S(cid:48)

(cid:88)

t∈T (cid:48)

c :=

ns + eG(S, T ) +

nt.

First suppose that |S| ≥ (1/2 − 2ξ)n. In this case, since δ(G) ≥ (1/2 + 4ξ)n, each vertex in T receives

at least 2ξn edges from S. So

(cid:88)

t∈T (cid:48)

(cid:88)

t∈T (cid:48)

c ≥

nt + 2|T|ξn ≥

nt + |T|(ξ + α)n ≥ c0.

A similar argument works if |T| ≥ (1/2 − 2ξ)n. Suppose then that |S|,|T| < (1/2 − 2ξ)n. Then
|S(cid:48)
|,|T (cid:48)

| > (1/2 + 2ξ)n and

(cid:88)

s∈S(cid:48)

(cid:88)

t∈T (cid:48)

ns +

(cid:48)

(cid:48)

nt ≥ (|S

| + |T

c ≥

as required.

|)(ξ − α)n > (n + 4ξn)(ξ − α)n ≥ (ξ + α)n2 ≥ c0,

(cid:3)

20

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

We now use Proposition 8.10 to prove Proposition 8.9.

Proof of Proposition 8.9. For each v ∈ V (G), let

mv := min{dG(v, Vj) : 1 ≤ j ≤ r with v /∈ Vj}.
For each 1 ≤ j ≤ r and each v /∈ Vj, let av,j := dG(v, Vj) − mv. Note that,
(8.3)

0 ≤ av,j < αn.

For each 1 ≤ j ≤ r, let Nj :=(cid:80)

v∈Vj mv. We have, for any 1 ≤ j1, j2 ≤ r,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:88)
(cid:88)

v∈Vj1

v∈Vj1

(cid:88)

v∈Vj2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) (8.3)

(cid:88)

v∈Vj2

av,j2 −

av,j1

< αn2.

(dG(v, Vj2) − av,j2) −

(dG(v, Vj1) − av,j1)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

|Nj1 − Nj2| =

(8.4)

=

(cid:80)
Let N := min{Nj : 1 ≤ j ≤ r} and, for each 1 ≤ j ≤ r, let Mj := Nj − N . Note that (8.4) implies
0 ≤ Mj < αn2. For each 1 ≤ j ≤ r and each v ∈ Vj, choose pv ∈ N to be as equal as possible such that
v∈Vj pv = Mj. Then

(8.5)

0 ≤ pv < αn + 1.

Let ξ := γ/2r. For each 1 ≤ j ≤ r and each v /∈ Vj, let

Using (8.3) and (8.5), we see that,

(8.6)

nv,j := (cid:100)ξn(cid:101) + av,j + pv.

ξn ≤ nv,j ≤ (ξ + 3α)n.

We will consider each pair 1 ≤ j1 < j2 ≤ r separately and choose Hj1,j2 = H[Vj1, Vj2]. Fix 1 ≤ j1 <

j2 ≤ r and observe that,

(cid:88)

v∈Vj1

(cid:88)

v∈Vj1

(cid:88)

v∈Vj1

(cid:88)

v∈Vj1

(cid:88)

v∈Vj2

= (cid:100)ξn(cid:101)n − N + eG(Vj1, Vj2) =

nv,j1.

nv,j2 =

((cid:100)ξn(cid:101) + av,j2 + pv) = (cid:100)ξn(cid:101)n +

av,j2 + Mj1

= (cid:100)ξn(cid:101)n + Mj1 +

(dG(v, Vj2) − mv) = (cid:100)ξn(cid:101)n + Mj1 + eG(Vj1, Vj2) − Nj1

Let H :=(cid:83)

Let Gj1,j2 := G[Vj1, Vj2] and note that δ(Gj1,j2) ≥ (1/2+4ξ)n. Apply Proposition 8.10 (with 3α, ξ, Gj1,j2,
Vj1 and Vj2 playing the roles of α, ξ, G, A and B) to ﬁnd Hj1,j2 ⊆ Gj1,j2 such that dHj1,j2
(v) = nv,j2 for
every v ∈ Vj1 and dHj1,j2
we have

1≤j1<j2≤r Hj1,j2. By (8.6), we have ∆(H) ≤ 2rξn = γn. For any 1 ≤ j ≤ r and any v /∈ Vj,

(v) = nv,j1 for every v ∈ Vj2.

dG−H (v, Vj) = dG(v, Vj) − dH (v, Vj) = dG(v, Vj) − nv,j

= dG(v, Vj) − (cid:100)ξn(cid:101) − dG(v, Vj) + mv − pv = mv − pv − (cid:100)ξn(cid:101).

So G − H is Kr-divisible.

(cid:3)

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

21

We now have all the necessary tools to prove Lemma 8.1. This lemma ﬁnds an approximate Kr-

decomposition which covers all but at most γn edges at any vertex.
Proof of Lemma 8.1. The lemma trivially holds if r = 2, so we may assume that r ≥ 3. In particular,
by Proposition 3.1, ˆδ(G) ≥ (1 − 1/(r + 1) + ε/2)n. Choose constants N , k0, ε∗, d and ρ satisfying

η (cid:28) 1/N (cid:28) 1/k0 ≤ ε

(cid:28) d (cid:28) ρ (cid:28) γ.

∗

Apply Proposition 8.8 to ﬁnd a subgraph H1 ⊆ G satisfying properties (i)–(ii).
v /∈ Vj1 ∪ Vj2,

Let G1 := G − H1. Using (8.1) and that H1 satisﬁes Proposition 8.8(i), for all 1 ≤ j1, j2 ≤ r and each

|dG1(v, Vj1) − dG1(v, Vj2)| ≤ |dG(v, Vj1) − dG(v, Vj2)| + |dH1(v, Vj1) − dH1(v, Vj2)|

< αn + 3αn = 4αn.

Note also that ˆδ(G1) ≥ 3n/4. So we can apply Proposition 8.9 (with G1, 4α and γ/2 playing the
roles of G, α and γ) to obtain H2 ⊆ G1 such that G1 − H2 is Kr-divisible and ∆(H2) ≤ γn/2. Then
ˆδ(G1 − H2) ≥ (ˆδη

Kr + ε/2)n, so we can ﬁnd an η-approximate Kr-decomposition F of G1 − H2.
F be the graph consisting of all the remaining edges in G1 − H2. Let

Let G2 := G1 − H2 −

(cid:83)

B := {v ∈ V (G) : dG2(v) > η1/2n}.

Note that

(cid:83)

(8.7)
Let F1 := {F ∈ F : F ∩ B = ∅} and let G3 := G −
F1. If v ∈ B, then NG3(v) = NG(v). Suppose that
v /∈ B. For any u ∈ B, at most one copy of Kr in F \ F1 can contain both u and v. So there can be at

most (r − 1)|B| edges in(cid:83)(F \ F1) that are incident to v and so

|B| ≤ 2e(G2)/η1/2n ≤ 2η1/2n.

dG3(v) ≤ dH1(v) + dH2(v) + dG2(v) + (r − 1)|B|

(8.8)

≤ (r − 1)(ρ + α)n + γn/2 + η1/2n + 2(r − 1)η1/2n ≤ γn.

Label the vertices of B = {v1, v2, . . . , v|B|}. We will use copies of Kr to cover most of the edges at each
vertex vi in turn. We do this by ﬁnding a Kr−1-matching Mi in H1[NG3(vi)] = H1[NG(vi)] in turn for
1≤j<i Mj. To simplify notation,

each i. Suppose that we are currently considering v := vi and let M :=(cid:83)
we will assume that v ∈ V1 (the proof in the other cases is identical).
Let P(v) = {U 0(v), . . . , U kv (v)} be a partition of NG(v) satisfying Proposition 8.8(ii). We can choose
a partition Q(v) = {W 0(v), . . . , W kv (v)} of NG(v) and m(cid:48)

v ≥ mv − |B| such that, for each 1 ≤ i ≤ kv:

• W i(v) ⊆ U i(v);
• W i(v) ∩ B = ∅;
• for each 2 ≤ j ≤ r, |W i

j (v)| = m(cid:48)

v.

Note that, using (8.7), |W 0(v)| ≤ |U 0(v)| + |B|kvr ≤ r(ε∗n + 2η1/2nkv) ≤ 2ε∗rn.
By Proposition 8.8(ii), for each 1 ≤ i ≤ kv and all 2 ≤ j1 < j2 ≤ r, the graph H1[U i
j2(v)] is
j2(v)] is 2ε∗-regular
ε∗-regular with density greater than d. So Proposition 8.2 implies that H1[W i
with density greater than d/2. Let H(cid:48)
j1(v), W i
j2(v)]) ≤ |B| ≤
v, η1/3 and 2ε∗ playing the roles of n, γ and ε) to see
η1/3m(cid:48)
that H(cid:48)
v, 4ε∗, d/3 and r − 1 playing the roles of n, ε, d and r) to ﬁnd a
We use Proposition 8.4 (with m(cid:48)
Kr−1-matching covering all but at most 2(r − 1)(4ε∗)1/(r−1)m(cid:48)
1[W i(v)] for each 1 ≤ i ≤ kv.
Write Mi for the union of these Kr−1-matchings over 1 ≤ i ≤ kv. Note that Mi covers all but at most
)1/(r−1)n ≤ γn
(8.9)

v. So we can apply Proposition 8.3 (with m(cid:48)
1[W i

j2(v)] is 4ε∗-regular with density greater than d/3.

1 := H1 − M. Using (8.7), we have ∆(M[W i

|W 0(v)| + 2(r − 1)(4ε

rn + 2(r − 1)(4ε

v vertices in H(cid:48)

(cid:48)
vkv ≤ 2ε

∗

)1/(r−1)m

j1(v), W i

j1(v), W i

j1(v), U i

∗

∗

vertices in NG(v).

22

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

(cid:48) := (cid:83)
Continue to ﬁnd edge-disjoint M1, . . . , M|B|. For each 1 ≤ i ≤ |B|, M(cid:48)
i := {vi ∪ K : K ∈ Mi} is
an edge-disjoint collection of copies of Kr in G3 covering all but at most γn edges at vi in G. Write
(cid:48)) has a
(cid:48) = G −
M
(cid:3)
Kr-decomposition and ∆(H) ≤ γn, by (8.8) and (8.9).

(cid:48)). Then G − H = (cid:83)(F1 ∪ M

(cid:83)(F1 ∪ M

i and let H := G3 −

1≤i≤|B| M(cid:48)

(cid:83)

M

9. Covering a pseudorandom remainder between vertex classes

After applying Lemma 8.1, we are left with a graph H such that H[P] has low maximum degree. We
will add a suitable quasirandom graph R to H to be able to assume that the remainder H(cid:48) = R ∪ H is
actually quasirandom. The results in this section will allow us to cover any remaining edges in H(cid:48)[P]
using only a small number of edges from H(cid:48)
− H(cid:48)[P]. This is done by ﬁnding, for each x ∈ V (G), suitable
− H(cid:48)[P] such that each copy of Kr−1 forms a copy of Kr together
vertex-disjoint copies of Kr−1 inside H(cid:48)
with the edges incident to x in H(cid:48)[P].
Lemma 9.1. Let r ≥ 2 and 1/n (cid:28) 1/k, 1/r, ρ ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let q ≤ krn and let W 1, . . . , W q ⊆ V (G). Suppose that:
(i) for each 1 ≤ i ≤ q, there exists 1 ≤ ji ≤ r and ni ∈ N such that, for each 1 ≤ j ≤ r, |W i
j| = 0 if
(ii) for each 1 ≤ i ≤ q, ˆδ(G[W i]) ≥ (1 − 1/(r − 1))ni + 9kr2ρ3/2n;
(iii) for all 1 ≤ i1 < i2 ≤ q, |W i1 ∩ W i2| ≤ 2rρ2n;
(iv) each v ∈ V (G) is contained in at most 2kρn of the W i.
Then there exist edge-disjoint T1, . . . , Tq in G such that each Ti is a perfect Kr−1-matching in G[W i].

j| = ni otherwise;

j = ji and |W i

The W i in Lemma 9.1 will play the role of vertex neighbourhoods later on. The proof of Lemma 9.1
is similar to that of Lemma 10.7 in [3], we include it here for completeness. We will use the following
result.

Proposition 9.2 (Jain, see [23, Lemma 8]). Let X1, . . . , Xn be Bernoulli random variables such that,
for any 1 ≤ s ≤ n and any x1, . . . , xs−1 ∈ {0, 1},

P(Xs = 1 | X1 = x1, . . . , Xs−1 = xs−1) ≤ p.

s=1 Xi and let B ∼ B(n, p). Then P(X ≥ a) ≤ P(B ≥ a) for any a ≥ 0.

Proof of Lemma 9.1. Set t := (cid:100)8krρ3/2n(cid:101). Let Gi := G[W i] for 1 ≤ i ≤ q. Suppose we have already
found T1, . . . Ts−1 for some 1 ≤ s ≤ q. We ﬁnd Ts as follows.
t be
empty graphs on W s. Otherwise, (ii) implies

s := Gs − Hs−1[W s]. If ∆(Hs−1[W s]) > (r − 2)ρ3/2n, let T (cid:48)

i=1 Ti and G(cid:48)

1, . . . , T (cid:48)

Let X =(cid:80)n
Let Hs−1 := (cid:83)s−1

(cid:0)1 −

(cid:1)ns + 8kr2ρ3/2n ≥

(cid:0)1 −

(cid:48)
s) ≥

ˆδ(G

1
r − 1

1
r − 1
and we can greedily ﬁnd t edge-disjoint perfect Kr−1-matchings T (cid:48)
either case, pick 1 ≤ i ≤ t uniformly at random and set Ts := T (cid:48)
that Ts contains an edge incident to w in Gi. Let X i,w :=(cid:80)q

Consider any 1 ≤ i ≤ q and any w ∈ W i. For 1 ≤ s ≤ q, let Y i,w

∆(Hs−1[W s]) ≤ (r − 2)ρ3/2n

probability,

for all 1 ≤ s ≤ q.
s=1 Y i,w

s

+ ρ3/2(cid:1)ns + (r − 2)(t − 1)

1, . . . , T (cid:48)

t in G(cid:48)

s using Theorem 6.2. In
i . It suﬃces to show that, with positive

be the indicator function of the event
. Note dHq (w, W i) ≤ (r − 2)X i,w.
Fix 1 ≤ i ≤ q and w ∈ W i. Let J i,w be the set of indices s (cid:54)= i such that w ∈ W s; (iv) implies

So it suﬃces to show that, with positive probability, X i,w ≤ ρ3/2n for all 1 ≤ i ≤ q and all w ∈ W i.
(cid:88)
|J i,w| < 2kρn. If s /∈ J i,w ∪ {i}, then w /∈ W s and Y i,w

s

(9.1)

X i,w ≤ 1 +

s = 0. So
Y i,w
s

.

s∈J i,w

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

23

Let s1 < ··· < s|J i,w| be an enumeration of J i,w. For any b ≤ |J i,w|, note that

dGsb
So at most 2rρ2n of the subgraphs T (cid:48)
sb = 1 | Y i,w

P(Y i,w

(w, W i) ≤ |W i ∩ W sb|
j that we picked in G(cid:48)
s1 = y1, . . . , Y i,w

sb−1 = yb−1) ≤ 2rρ2n/t ≤ ρ1/2/4k

(iii)

≤ 2rρ2n.

sb contain an edge incident to w in Gi. Thus

for all y1, . . . , yb−1 ∈ {0, 1} and 1 ≤ b ≤ |J i,w|. Let B ∼ B(|J i,w|, ρ1/2/4k). Using Proposition 9.2,
(cid:88)
Lemma 2.1 and that |J i,w| ≤ 2kρn, we see that

(9.1)

P(X i,w > ρ3/2n)

s∈J i,w

s > 3ρ3/2n/4) ≤ P(B > 3ρ3/2n/4)
Y i,w

≤ P(
≤ P(|B − E(B)| > ρ3/2n/4) ≤ 2e

−ρ2n/16k.

There are at most qrn ≤ kr2n2 pairs (i, w), so there is a choice of T1, . . . , Tq such that X i,w ≤ ρ3/2n for
(cid:3)
all 1 ≤ i ≤ q and all w ∈ W i.

The following is an immediate consequence of Lemma 9.1.

Corollary 9.3. Let r ≥ 2 and 1/n (cid:28) 1/k, 1/r, ρ ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let U, W ⊆ V (G) be disjoint with |W1| = ··· = |Wr| ≥ (cid:98)n/k(cid:99). Suppose the
following hold:
(i) for all 1 ≤ j1, j2 ≤ r and all x ∈ U \ (Vj1 ∪ Vj2), dG(x, Wj1) = dG(x, Wj2);
(ii) for all 1 ≤ j ≤ r and all x ∈ U \ Uj, ˆδ(G[NG(x, W )]) ≥ (1 − 1/(r − 1))dG(x, Wj) + 9krρ3/2|W|;
(iii) for all distinct x, x(cid:48)
(iv) for all y ∈ W , dG(y, U ) ≤ 2kρ|W1|.
Then there exists GW ⊆ G[W ] such that G[U, W ]∪ GW has a Kr-decomposition and ∆(GW ) ≤ 2krρ|W1|.
Proof. Let q := |U| and let u1, . . . , uq be an enumeration of U . For each 1 ≤ i ≤ q, let W i := NG(ui, W ).
Note that q ≤ kr|W1|. Apply Lemma 9.1 (with G[W ] and |W1| playing the roles of G and n) to obtain
i=1 T i. Then G[U, W ] ∪ GW has a
(cid:3)
Kr-decomposition. For each y ∈ W , we use (iv) to see that dGW (y) ≤ (r − 1)dG(y, U ) < 2krρ|W1|.

edge-disjoint perfect Kr−1-matchings T i in each G[W i]. Let GW :=(cid:83)q

∈ U , |NG(x, W ) ∩ NG(x(cid:48), W )| ≤ 2ρ2|W|;

If we are given a k-partition P of the r-partite graph G, we can apply Corollary 9.3 repeatedly with

each U ∈ P playing the role of W to obtain the following result.
Corollary 9.4. Let r ≥ 2 and 1/n (cid:28) ρ (cid:28) 1/k, 1/r ≤ 1. Let G be an r-partite graph on (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let P = {U 1, . . . , U k} be a k-partition for G. Suppose that the following hold for
all 2 ≤ i ≤ k:
(i) for all 1 ≤ j1, j2 ≤ r and all x ∈ U <i \ (Vj1 ∪ Vj2), dG(x, U i
(ii) for all 1 ≤ j ≤ r and all x ∈ U <i \ Vj, ˆδ(G[NG(x, U i)] ≥ (1 − 1/(r − 1))dG(x, U i
(iii) for all distinct x, x(cid:48)
(iv) for all y ∈ U i, dG(y, U <i) ≤ 2kρ|U i
1|.
Then there exists G0 ⊆ G − G[P] such that G[P] ∪ G0 has a Kr-decomposition and ∆(G0) ≤ 3rρn.
Proof. For each 2 ≤ i ≤ k, let Gi := G[U <i, U i] ∪ G[U i]. Apply Corollary 9.3 to each Gi with U <i,
U i playing the roles of U , W to obtain G(cid:48)
i has a Kr-decomposition
and ∆(G(cid:48)
i . Then G[P] ∪ G0 has a Kr-decomposition and
(cid:3)
∆(G0) ≤ 3rρn.

i) ≤ 2krρ(cid:100)n/k(cid:101) ≤ 3rρn. Let G0 := (cid:83)k

∈ U <i, |NG(x, U i) ∩ NG(x(cid:48), U i)| ≤ 2ρ2|U i|;

i ⊆ G[U i] such that G[U <i, U i] ∪ G(cid:48)

j ) + 9krρ3/2|U i|;

j1) = dG(x, U i

i=2 G(cid:48)

j2);

24

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

10. Balancing graph

In our proof we will consider a sequence of successively ﬁner partitions P1, . . . ,P(cid:96) in turn. When
considering Pi, we will assume the leftover is a subgraph of G − G[Pi−1] and aim to use Lemma 8.1 and
then Corollary 9.4 to ﬁnd copies of Kr such that the leftover is now contained in G − G[Pi] (i.e. inside
the smaller partition classes). However, to apply Corollary 9.4 we need the leftover to be balanced with
respect to the partition classes. In this section we show how this can be achieved.

Let P = {U 1, . . . , U k} be a k-partition of the vertex set V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n.

We say that a graph H on (V1, . . . , Vr) is locally P-balanced if
j1) = dH (v, U i
j2)

dH (v, U i

for all 1 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v ∈ U i \ (Vj1 ∪ Vj2). Note that a graph which is locally
P-balanced is not necessarily Kr-divisible but that H[U i] is Kr-divisible for all 1 ≤ i ≤ k.
Let γ > 0. A (γ,P)-balancing graph is a Kr-decomposable graph B on V such that the following holds.
Let H be any Kr-divisible graph on V with:
(P1) e(H ∩ B) = 0;
(P2) |dH (v, U i
Then there exists B(cid:48)

j2)| < γn for all 1 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v /∈ Vj1 ∪ Vj2.

⊆ B such that B − B(cid:48) has a Kr-decomposition and

j1) − dH (v, U i

j1) = dH∪B(cid:48)(v, U i
for all 2 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v ∈ U <i \ (Vj1 ∪ Vj2).
graph G.

Our aim in this section will be to prove Lemma 10.1 which ﬁnds a (γ,P)-balancing graph in a suitable
Lemma 10.1. Let 1/n (cid:28) γ (cid:28) γ(cid:48)
with |V1| = ··· = |Vr| = n. Let P = {U 1, . . . , U k} be a k-partition for G. Suppose dG(v, U i
(1 − 1/(r + 1) + ε)|U i
a (γ,P)-balancing graph such that B is locally P-balanced and ∆(B) < γ(cid:48)n.

(cid:28) 1/k (cid:28) ε (cid:28) 1/r ≤ 1/3. Let G be an r-partite graph on (V1, . . . , Vr)
j ) ≥
j| for all 1 ≤ i ≤ k, all 1 ≤ j ≤ r and all v /∈ Vj. Then there exists B ⊆ G which is

dH∪B(cid:48)(v, U i

j2)

The balancing graph B will be made up of two graphs: Bedge, an edge balancing graph (which balances
the total number of edges between appropriate classes), and Bdeg, a degree balancing graph (which
balances individual vertex degrees). These are described in Sections 10.1 and 10.2 respectively.
10.1. Edge balancing. Let P = {U 1, . . . , U k} be a k-partition of the vertex set V = (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let γ > 0. A (γ,P)-edge balancing graph is a Kr-decomposable graph Bedge on V
such that the following holds. Let H be any Kr-divisible graph on V which is edge-disjoint from Bedge
and satisﬁes (P2). Then there exists B(cid:48)
edge has a Kr-decomposition and
eH∪B(cid:48)

edge ⊆ Bedge such that Bedge − B(cid:48)
j1 , U i2
(U i1
j3 )

j2 ) = eH∪B(cid:48)

j1 , U i2

(U i1

edge

edge

for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3.

In this section, we ﬁrst construct and then ﬁnd a (γ,P)-edge balancing graph in G.
For any multigraph G on W and any e ∈ W (2), let mG(e) be the multiplicity of the edge e in G. We say
that a Kr-divisible multigraph G on W = (W1, . . . , Wr) is irreducible if G has no non-trivial Kr-divisible
proper subgraphs; that is, for every H (cid:40) G with e(H) > 0, H is not Kr-divisible. It is easy to see that
there are only ﬁnitely many irreducible Kr-divisible multigraphs on W . In particular, this implies the
following proposition.

irreducible Kr-divisible multigraph on W has edge multiplicity at most N .

Proposition 10.2. Let r ∈ N and let W = (W1, . . . , Wr). Then there exists N = N (W ) such that every
(cid:3)
Let P = {U 1, . . . , U k} be a partition of V = (V1, . . . , Vr). Take a copy K of Kr(k) with vertex set
j : 1 ≤ j ≤

j } for each 1 ≤ j ≤ r. For each 1 ≤ i ≤ k, let W i := {wi

(W1, . . . , Wr) where Wj = {w1

j , . . . , wk

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

25

r}. Given a graph H on V , we deﬁne an excess multigraph EM(H) on the vertex set V (K) as follows.
Between each pair of vertices wi1

j1, wi2
j1 , U i2

j2 such that wi1
j2 ) − min{eH (U i1

j1wi2
j , U i2

j2 ∈ E(K) there are exactly
j(cid:48) ) : 1 ≤ j, j

≤ r, j (cid:54)= j

}

(cid:48)

(cid:48)

eH (U i1

multiedges in EM(H).

Proposition 10.3. Let r ∈ N with r ≥ 3. Let P = {U 1, . . . , U k} be a k-partition of the vertex set
V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let H be any Kr-divisible graph on V satisfying (P2).
Then the excess multigraph EM(H) has a decomposition into at most 3γk2r2n2 irreducible Kr-divisible
multigraphs.
Proof. First, note that for any 1 ≤ i1, i2 ≤ k, any 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3 and any v ∈ U i1
j1 ,
we have |dH (v, U i2
(10.1)

j2 ) − dH (v, U i2

j3 )| < γn|U i1

j1| < γn2.

j3 )| < γn by (P2). Therefore,
j1 , U i2
|eH (U i1
j2 ∈ E(K),

j2 ) − eH (U i1

j1 , U i2

We claim that, for all wi1

j1wi2

(10.2)

Let 1 ≤ j(cid:48)

1, j(cid:48)
|eH (U i1

2 ≤ r with j(cid:48)
j1 , U i2

1 (cid:54)= j(cid:48)
j2 ) − eH (U i1
j(cid:48)

1

mEM(H)(wi1

j1wi2

j2) < 3γn2.

2. Let 1 ≤ j ≤ r with j (cid:54)= j1, j(cid:48)
, U i2
j1 , U i2
j2 ) − eH (U i1
j(cid:48)
+ |eH (U i1
j(cid:48)

1. Then
j1 , U i2
j )| + |eH (U i1
j ) − eH (U i1
j(cid:48)

)| ≤ |eH (U i1

, U i2
j(cid:48)

, U i2

)|

1

1

2

2

(10.1)
< 3γn2.

j1 , U i2

j ) − eH (U i1
j(cid:48)

1

, U i2
j )|

So (10.2) holds.

We will now show that EM(H) is Kr-divisible. Consider any vertex wi1

1 ≤ j2, j3 ≤ r such that j1 (cid:54)= j2, j3. Note that, since H is Kr-divisible,

j1 ∈ V (EM(H)) and any

dEM(H)(wi1

j1, Wj2) =

mEM(H)(wi1

j1, wi

j2)

k(cid:88)

k(cid:88)

i=1

= eH (U i1

j1 , Vj2) −

= eH (U i1

j1 , Vj3) −

k(cid:88)
k(cid:88)

i=1

i=1

min{eH (U i1

j , U i

j(cid:48)) : 1 ≤ j, j

min{eH (U i1

j , U i

j(cid:48)) : 1 ≤ j, j

(cid:48)

(cid:48)

≤ r, j (cid:54)= j

≤ r, j (cid:54)= j

(cid:48)

(cid:48)

}

}

=

mEM(H)(wi1

j1, wi

j3) = dEM(H)(wi1

j1, Wj3).

i=1

So EM(H) is Kr-divisible and therefore has a decomposition F into irreducible Kr-divisible multigraphs.
By (10.2), there are at most 3γn2 edges between any pair of vertices in EM(H), so |F| ≤ (3γn2)e(K) <
(cid:3)
3γk2r2n2.

Let N = N (V (K)) be the maximum multiplicity of an edge in any irreducible Kr-divisible multigraph
j . Let K(N )

j of K by U i
on V (K) = (W1, . . . , Wr) (N exists by Proposition 10.2). Label each vertex wi
be the labelled multigraph obtained from K by replacing each edge of K by N multiedges.

We now construct a P-labelled graph which resembles the multigraph K(N ) (when we compare relative
diﬀerences in the numbers of edges between vertices) and has lower degeneracy. Consider any edge
e = wi1
j2 ∈ E(K(N )). Let θ(e) be the graph obtained by the following procedure. Take a copy Ke of

j1wi2

26

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

j1wi2

j1, wi2

j2 in Ke and join wi2

⊆ K(N ), let θ(K(cid:48)) :=(cid:83)

K[W i1, W i2]− wi1
j2 (Ke inherits the labelling of K[W i1, W i2]). Note that K[W i1, W i2] is a copy of Kr
if i1 = i2 and a copy of the graph obtained from Kr,r by deleting a perfect matching otherwise. Join wi1
j1
j2 to the copy of wi1
to the copy of wi2
j1 in Ke. Write θ(e) for the resulting P-labelled
graph (so the vertex set of θ(e) consists of wi1
j2 as well as all the vertices in Ke). Choose the graphs
Ke to be vertex-disjoint for all e ∈ E(K(N )). For any K(cid:48)
{θ(e) : e ∈ E(K(cid:48))}.
To see that the labelling of θ(K(N )) is actually a P-labelling, note that for any U i
j , the set of vertices
labelled U i
j forms an independent set in θ(K(N )). Moreover, note that θ(K(N )) has degeneracy r − 1.
To see this, list its vertices in the following order. First list all the original vertices of V (K). These form
an independent set in θ(K(N )). Then list the remaining vertices of θ(K(N )) in any order. Each of these
vertices has degree r − 1 in θ(K(N )), so the degeneracy of θ(K(N )) can be at most r − 1.
Proposition 10.4. Let P = {U 1, . . . , U k} be a k-partition of the vertex set V = (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let J = φ(θ(K(N ))) be a copy of θ(K(N )) on V which is compatible with its
P-labelling. Then the following hold:
(i) J is Kr-divisible and locally P-balanced;
(ii) for any multigraph H ⊆ K(N ), any 1 ≤ i1, i2 ≤ k and any 1 ≤ j1 < j2 ≤ r,

eφ(θ(H))(U i1

j1 , U i2

j2 ) = eH (W i1, W i2) + mH (wi1

j1wi2

j2).

jwi1

To see that J is locally P-balanced, consider any x ∈ V (θ(K(N ))). If x = wi

Proof. We ﬁrst prove that J is Kr-divisible. Consider any x ∈ V (θ(K(N ))). If x = wi
j ∈ V (K), then
dJ (φ(x), Vj1) = N k for all 1 ≤ j1 ≤ r with j1 (cid:54)= j (since for each edge wi
j1 ∈ E(K), x has exactly N
neighbours labelled U i1
j1 in θ(K(N ))). If x /∈ V (K), x must appear in a copy of Ke in θ(e) for some edge
e ∈ E(K(N )). In this case, dJ (φ(x), Vj) = 1 for all 1 ≤ j ≤ r such that φ(x) /∈ Vj. So J is Kr-divisible.
j ∈ V (K), then φ(x) ∈ U i
and dJ (φ(x), U i
j1) = N for all 1 ≤ j1 ≤ r with j1 (cid:54)= j. Otherwise, x must appear in a copy of Ke in θ(e)
for some edge e = wi1
j (so i ∈ {i1, i2}). If i1 (cid:54)= i2, then
≤ r with j(cid:48)
dJ (φ(x), U i
(cid:54)= j. So J
is locally P-balanced. Thus (i) holds.
jwi(cid:48)
j(cid:48) ∈ E(K(N )). The
P-labelling of θ(K(N )) gives

j(cid:48)) = 1 for all 1 ≤ j(cid:48)
We now prove (ii). Let 1 ≤ i1, i2 ≤ k and 1 ≤ j1 < j2 ≤ r. Consider any edge wi

j2 ∈ E(K(N )). Let i, j be such that φ(x) ∈ U i

≤ r. If i1 = i2, then dJ (φ(x), U i

j(cid:48)) = 0 for all 1 ≤ j(cid:48)

j1wi2

j

0

2
1

if {i, i(cid:48)
if {(i, j), (i(cid:48), j(cid:48))} = {(i1, j1), (i2, j2)},

} (cid:54)= {i1, i2},

otherwise.

(10.3)

eφ(θ(wi

j(cid:48) ))(U i1
j wi(cid:48)

j1 , U i2

j2 ) =

Let H ⊆ K(N ). Then (ii) follows from applying (10.3) to each edge in H.

(cid:3)

The following proposition allows us to use a copy of θ(K(N )) to correct imbalances in the number of

j1 and U i2

j2 when EM(H) is an irreducible Kr-divisible multigraph.

edges between parts U i1
Proposition 10.5. Let P = {U 1, . . . , U k} be a k-partition of the vertex set V = (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let H be a graph on V such that EM(H) = I is an irreducible Kr-divisible
multigraph. Let J = φ(θ(K(N ))) be a copy of θ(K(N )) on V which is compatible with its P-labelling and
edge-disjoint from H. Then there exists J(cid:48)
⊆ J such that J − J(cid:48) is Kr-divisible and H(cid:48) := H ∪ J(cid:48) satisﬁes
j1 , U i2
(10.4)
for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3.
Proof.
multigraph on V (K). So we may view I as a subgraph of K(N ). Let J(cid:48)

Recall that N denotes the maximum multiplicity of an edge in an irreducible Kr-divisible
:= J − φ(θ(I)). For all

j2 ) = eH(cid:48)(U i1

j1 , U i2
j3 )

eH(cid:48)(U i1

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

27

1 ≤ i1 < i2 ≤ k, let

pi1,i2 := min{eH (U i1

j1 , U i2

j2 ) : 1 ≤ j1, j2,≤ r, j1 (cid:54)= j2}.

Proposition 10.4 gives, for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2 ≤ r with j1 (cid:54)= j2,

eJ(cid:48)(U i1

j1 , U i2

j2 ) = eφ(θ(K(N )))(U i1

j1 , U i2

j2 ) − eφ(θ(I))(U i1

j1 , U i2
j2 )

Recall that I = EM(H), so eH (U i1
j2 ) = eH (U i1

eH(cid:48)(U i1

j1 , U i2

= eK(N )(W i1, W i2) + N − (eI (W i1, W i2) + mI (wi1
= eK(N )−I (W i1, W i2) + N − mI (wi1
j2) + pi1,i2 and
j2 ) = eK(N )−I (W i1, W i2) + N + pi1,i2.

j2 ) = mI (wi1
j2 ) + eJ(cid:48)(U i1

j1 , U i2
j1 , U i2

j1wi2
j1 , U i2

j1wi2

j1wi2

j2))

j2).

Note that the right hand side is independent of j1, j2. Thus (10.4) holds.

(cid:3)

sitions 10.4 and 10.5

The following proposition describes a (γ,P)-edge balancing graph based on the construction in Propo-
Proposition 10.6. Let k, r ∈ N with r ≥ 3. Let P = {U 1, . . . , U k} be a k-partition of the vertex set
J1, . . . , J(cid:96) on V . Suppose that J1, . . . , J(cid:96), A1, . . . , Am are edge-disjoint. Then Bedge :=(cid:83)(cid:96)
(cid:83)m
V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let J1, . . . , J(cid:96) be a collection of (cid:96) ≥ 3γk2r2n2 copies
of θ(K(N )) on V which are compatible with their labellings. Let {A1, . . . , Am} be an absorbing set for
i=1 Ai
is a (γ,P)-edge balancing graph.
Proof.
Let H be any Kr-divisible graph on V which is edge-disjoint from Bedge and satisﬁes (P2).
Apply Proposition 10.3 to ﬁnd a decomposition of EM(H) into a collection I = {I1, . . . , I(cid:96)(cid:48)} of irreducible
Kr-divisible multigraphs, where (cid:96)(cid:48)
edge ⊆ Bedge be the empty graph. If
(cid:96)(cid:48) > 0, we proceed as follows to ﬁnd B(cid:48)
edge. Let H1, . . . , H(cid:96)(cid:48) be graphs on V which partition the edge set
of H and satisfy EM(Hs) = Is for each 1 ≤ s ≤ (cid:96)(cid:48). (To ﬁnd such a partition, for each 1 ≤ s < (cid:96)(cid:48) form Hs
by taking one U i1
j2 in Is. Let H(cid:96)(cid:48) consist of all the remaining edges.)
Apply Proposition 10.5 for each 1 ≤ s ≤ (cid:96)(cid:48) with Hs and Js playing the roles of H and J to ﬁnd J(cid:48)
s ⊆ Js
such that Js − J(cid:48)

≤ 3γk2r2n2 ≤ (cid:96). If (cid:96)(cid:48) = 0, let B(cid:48)

i=1 Ji ∪

j1wi2

s satisﬁes
s(U i1

j2 ) = eH(cid:48)

j1 , U i2
j3 )

(10.5)

j1 U i2
s is Kr-divisible and H(cid:48)
eH(cid:48)

j2 -edge from H for each edge wi1
s := Hs ∪ J(cid:48)
s(U i1
j1 , U i2
edge =(cid:83)(cid:96)(cid:48)

edge := (cid:83)(cid:96)(cid:48)

s=1 J(cid:48)

s. Then (10.5)

s=1 H(cid:48)
j1 , U i2

for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3. Let B(cid:48)
implies that the graph H(cid:48) := H ∪ B(cid:48)

s satisﬁes
j2 ) = eH(cid:48)(U i1
eH(cid:48)(U i1
for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3.
We now check that Bedge and Bedge − B(cid:48)
edge are Kr-decomposable. Recall that every absorber Ai is
Kr-decomposable. Also recall that, for every 1 ≤ s ≤ (cid:96), Js is Kr-divisible, by Proposition 10.4(i). Since
{A1, . . . , Am} is an absorbing set, it contains a distinct absorber for each Js. So for each 1 ≤ s ≤ (cid:96),
there exists a distinct 1 ≤ is ≤ m such that Ais ∪ Js has a Kr-decomposition. Therefore Bedge is Kr-
decomposable. To see that Bedge − B(cid:48)
s is a
Kr-divisible subgraph of Js. So for each 1 ≤ s ≤ (cid:96), there exists a distinct 1 ≤ js ≤ m such that, if s ≤ (cid:96)(cid:48),
Ajs ∪ (Js − J(cid:48)
s) has a Kr-decomposition and, if s > (cid:96)(cid:48), Ajs ∪ Js has a Kr-decomposition. So we can ﬁnd

edge is Kr-decomposable, recall that for each 1 ≤ s ≤ (cid:96)(cid:48), Js − J(cid:48)

j1 , U i2
j3 )

a Kr-decomposition of

Bedge − B

(cid:48)
edge =

(Js − J

(cid:48)
s) ∪

Js ∪

s=(cid:96)(cid:48)+1

Am.

(cid:96)(cid:91)

m(cid:91)

(cid:96)(cid:48)(cid:91)

s=1

s=1

(cid:3)

Therefore, Bedge is a (γ,P)-edge balancing graph.

28

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

The next proposition ﬁnds a copy of this (γ,P)-edge balancing graph in G.
Proposition 10.7. Let 1/n (cid:28) γ (cid:28) γ(cid:48)
(cid:28) 1/k (cid:28) ε (cid:28) 1/r ≤ 1/3. Let G be an r-partite graph on
(V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let P = {U 1, . . . , U k} be a k-partition for G. Suppose that
dG(v, U i
j| for all 1 ≤ i ≤ k, all 1 ≤ j ≤ r and all v /∈ Vj. Then there exists a
(γ,P)-edge balancing graph Bedge ⊆ G such that Bedge is locally P-balanced and ∆(Bedge) < γ(cid:48)n.
Proof. Let γ1 be such that γ (cid:28) γ1 (cid:28) γ(cid:48). Recall that θ(K(N )) is a P-labelled graph with degeneracy
r − 1 and all vertices of θ(K(N )) are free vertices. Also,

j ) ≥ (1 − 1/(r + 1) + ε)|U i

(cid:18)r

2

(cid:19)
N ≤ k2r3N.

Let (cid:96) := (cid:100)3γk2r2n2(cid:101) ≤ γ1/2n2. We can apply Lemma 5.2 (with γ1/2, γ1, r − 1, k2r3N and θ(K(N ))
playing the roles of η, ε, d, b and Hi) to ﬁnd edge-disjoint copies J1, . . . , J(cid:96) of θ(K(N )) in G which are

|θ(K(N ))| ≤ |K| + 2re(K)N = kr + 2rk2

(cid:83)(cid:96)

compatible with their labellings and satisfy ∆((cid:83)(cid:96)
Let G(cid:48) := G[P] −
ˆδ(G
set A for J1, . . . , J(cid:96) in G(cid:48) such that ∆((cid:83)
Let Bedge :=(cid:83)(cid:96)
∆(Bedge) < γ(cid:48)n. Note that for each 1 ≤ i ≤ k, Bedge[U i] =(cid:83)(cid:96)

A) ≤ γ(cid:48)n/2.

i=1 Ji) ≤ γ1n.

(cid:83)

i=1 Ji and note that
(cid:48)
) ≥ (1 − 1/(r + 1) + ε)n − (cid:100)n/k(cid:101) − γ1n ≥ (1 − 1/(r + 1) + γ

(cid:48)

)n.

Apply Lemma 6.6 (with γ1, γ(cid:48)/2, k2r3N and G(cid:48) playing the roles of η, ε, b and G) to ﬁnd an absorbing

i=1 Ji ∪

A. Then Bedge is a (γ,P)-edge balancing graph by Proposition 10.6. Also,
s=1 Js[U i] (this is the reason for ﬁnding A
in G[P]). Moreover, each Js is locally P-balanced by Proposition 10.4(i). Therefore Bedge is also locally
(cid:3)
P-balanced.

10.2. Degree balancing. Let P = {U 1, . . . , U k} be a k-partition of the vertex set V = (V1, . . . , Vr) with
|V1| = ··· = |Vr| = n. Let γ > 0. A (γ,P)-degree balancing graph is a Kr-decomposable graph Bdeg on
V such that the following holds. Let H be any Kr-divisible graph on V satisfying:
(Q1) e(H ∩ Bdeg) = 0;
(Q2) eH (U i1
(Q3) |dH (v, U i
v ∈ U <i
j1 .
Then there exists B(cid:48)

j1| for all 2 ≤ i ≤ k, all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3 and all

j3 ) for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3;

j2 ) = eH (U i1
j2) − dH (v, U i

j1 , U i2
j3)| < γ|U i

deg has a Kr-decomposition and

j1 , U i2

deg ⊆ Bdeg such that Bdeg − B(cid:48)
(v, U i

dH∪B(cid:48)

deg

j1) = dH∪B(cid:48)

deg

(v, U i

j2)

for all 2 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v ∈ U <i \ (Vj1 ∪ Vj2).
We will build a degree balancing graph by combining smaller graphs which correct the degrees between
two parts of the partition at a time. So, let us assume that the partition has only two parts, i.e., let
P = {U 1, U 2} partition the vertex set V = (V1, . . . , Vr). We begin by deﬁning those graphs which will
form the basic gadgets of the degree balancing graph. Let D0 be a copy of Kr(3) with vertex classes
{wi
j : 1 ≤ j ≤ r}. We deﬁne a labelling
L : V (D0) → {U 1

j : 1 ≤ i ≤ 3} for 1 ≤ j ≤ r. For each 1 ≤ i ≤ 3, let W i := {wi

j : 1 ≤ j ≤ r} as follows:

j , U 2

(cid:40)

L(wi

j) =

U 1
j
U 2
j

if i = 1, 2,
if i = 3.

Suppose that x, y are distinct vertices in U 1
taking the labelled copy of D0 and changing the label of w1

j1 where 1 ≤ j1 ≤ r. Obtain the P-labelled graph Dx,y by
j1 to {y}. Let 1 ≤ j2 ≤ r be

j1 to {x} and w2

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

29

such that j2 (cid:54)= j1. Let Dj2

x→y be the P-labelled subgraph of Dx,y which has as its vertex set

j w2

contains all possible edges in W 1 \ {w1
and w1
were to identify the vertices w1
j1 and w2
in common.)

j1 where 1 ≤ j ≤ r and j (cid:54)= j1, j2, as well as the edges w1

j1}),

j1} ∪ (W 3 \ {w3

W 1 ∪ {w2
j1}, all possible edges in W 3 \ {w3
j1w1

j1w3
j
j2. (Note that if we
j1 we would obtain two copies of Kr which have only one vertex

j1}, all edges of the form w1
j2 and w2

j1w3

Figure 2. A copy of D1

x→y when r = 4 and x, y ∈ U 1
2 .

j3wi2

j4 ∈ E(Dx,y). Take a labelled copy De of D0[W i1, W i2] − wi1

As in Section 10.1, we would like to reduce the degeneracy of Dx,y. The operation θ (which will be
familiar from Section 10.1) replaces each edge of Dx,y by a P-labelled graph as follows. Consider any
edge e = wi1
j4 (De inherits the labelling
of D0[W i1, W i2]). Note that D0[W i1, W i2] is a copy of Kr if i1 = i2 and a copy of the graph obtained
from Kr,r by deleting a perfect matching otherwise. Join wi1
j4 to the
copy of wi1
j3 in De (so the vertex set of θ(e) consists of wi1
j4 as well as all the vertices in De). Write
θ(e) for the resulting P-labelled graph. Choose the graphs De to be vertex-disjoint for all e ∈ E(Dx,y).
For any D(cid:48)
{θ(e) : e ∈ E(D(cid:48))}. The graph θ(Dx,y) has the following properties:
≤ 10r3 (since we add at most 2re(Kr(3)) new vertices to obtain θ(Dx,y)
(θ2) θ(Dx,y) has degeneracy r − 1 (to see this, take the original vertices of Dx,y ﬁrst, followed by the

(θ1) |θ(Dx,y)| ≤ 3r + 2r32(cid:0)r

⊆ Dx,y, let θ(D(cid:48)) :=(cid:83)
(cid:1)

j3 to the copy of wi2
j3, wi2

j4 in De and join wi2

from Dx,y);

j3wi2

2

remaining vertices in any order).

Suppose that H is a graph on V and x, y ∈ U 1

j1. Suppose that dH (x, U 2
j2) is too small. The next proposition allows us to use copies of θ(Dj2

dH (y, U 2
surplus from x to y.
Proposition 10.8. Let P = {U 1, U 2} be a partition of the vertex set V = (V1, . . . , Vr). Let 1 ≤ j1, j2 ≤ r
with j1 (cid:54)= j2 and suppose x, y ∈ U 1
. Suppose that D1 = φ(θ(Dx,y)) is a copy of θ(Dx,y) on V which is
compatible with its labelling. Let D2 := φ(θ(Dj2

j2) is currently too large and
x→y) to ‘transfer’ some of this

x→y)) ⊆ D1. Then the following hold:

j1

(i) both D1 and D2 are Kr-divisible;
(ii) D1 is locally P-balanced;
(iii) for any 1 ≤ j3, j4 ≤ r with j4 (cid:54)= j2 and any v ∈ U 1 \ (Vj3 ∪ Vj4),

dD2(v, U 2

j3) − dD2(v, U 2

j4) =

if v = x and j3 = j2,
if v = y and j3 = j2,
otherwise.

−1

1
0

Proof. First we show that (i) holds. Consider any v ∈ V (θ(Dx,y)). If v ∈ V (Dx,y), then dD1(φ(v), Vj) =
3 for all 1 ≤ j ≤ r such that φ(v) /∈ Vj. Otherwise, v appears in a copy of De for some edge e ∈ E(Dx,y)

{x}{y}U21U11U13U14U23U2430

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

and dD1(φ(v), Vj) = 1 for all 1 ≤ j ≤ r such that φ(v) /∈ Vj. So D1 is Kr-divisible. For D2, consider any
x→y)). If v ∈ V (Dj2
v ∈ V (θ(Dj2
x→y), then dD2(φ(v), Vj) = 1 for all 1 ≤ j ≤ r with φ(v) /∈ Vj. Otherwise,
v appears in a copy of De for some edge e ∈ E(Dj2
x→y) and dD2(φ(v), Vj) = 1 for all 1 ≤ j ≤ r such that
φ(v) /∈ Vj. So D2 is Kr-divisible.
For (ii), consider any v ∈ V (θ(Dx,y)). First suppose v = wi
j ∈ V (Dx,y). If i = 1, 2, then φ(v) ∈ U 1
j
and dD1(φ(v), U 1
j(cid:48)) = 1
for all 1 ≤ j(cid:48)
(cid:54)= j. Otherwise, v must appear in a copy of De in θ(e) for some edge
j1wi2
e = wi1
If i1, i2 ∈ {1, 2} or if i1 = i2 = 3, then
dD1(φ(v), U i
≤ r. So D1
is locally P-balanced.

j2 ∈ E(Dx,y). Let i, j be such that φ(v) ∈ U i
j .
j(cid:48)) = 1 for all 1 ≤ j(cid:48)
(cid:40)

Property (iii) will follow from the P-labelling of θ(Dj2

j(cid:48)) = 0 for all 1 ≤ j(cid:48)
(cid:40)

(cid:54)= j. Otherwise, dD1(φ(v), U i
x→y). Note that

j(cid:48)) = 2 for all 1 ≤ j(cid:48)
≤ r with j(cid:48)

(cid:54)= j. If i = 3, then φ(v) ∈ U 2

≤ r with j(cid:48)

≤ r with j(cid:48)

j and dD1(φ(v), U 2

dD2(x, U 2

j(cid:48)) =

0 if j(cid:48)
1 otherwise

∈ {j1, j2},

and

dD2(y, U 2

j(cid:48)) =

if j(cid:48) = j2,
otherwise.

1
0

jw3

j(cid:48) ∈ E(Dj2

The only other edges ab in D2 of the form U 1U 2 are those which appear in the image of De for some
x→y) with i = 1, 2. Note that such e must be incident to x or y and that a and b are new
e = wi
vertices, i.e., a, b /∈ V (Dj2
≤ r
(cid:3)
such that φ(v) /∈ Vj(cid:48). It follows that (iii) holds.

x→y). But for any v ∈ φ(De) ∩ U 1, we have dD2(v, U 2

j(cid:48)) = 1 for every 1 ≤ j(cid:48)

≤ 1/r ≤ 1/3. Let V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let
j1, x (cid:54)=

In what follows, given a collection D of graphs and an embedding φ(D) for each D ∈ D, we write
φ(D) := {φ(D) : D ∈ D}.
Lemma 10.9. Let 1/n (cid:28) γ (cid:28) γ(cid:48)
P = {U 1, U 2} be a 2-partition of V . Let 1 ≤ j1 ≤ r. Then there exists D ⊆ {θ(Dj
y, 1 ≤ j ≤ r, j (cid:54)= j1} such that the following hold.
(i) |D| ≤ γ(cid:48)n2.
(ii) Each vertex v ∈ V is a root vertex in at most γ(cid:48)n elements of D.
partite graph on V which is edge-disjoint from(cid:83) φ(D) and satisﬁes (Q2) and (Q3). Then there exists
(iii) Suppose that, for each D ∈ D, φ(D) is a copy of D on V which is compatible with its labelling.
∈ D. Let H be any r-
⊆ D such that H(cid:48) := H ∪
, and all 1 ≤ j2, j3 ≤ r

Suppose further that φ(D) and φ(D(cid:48)) are edge-disjoint for all distinct D, D(cid:48)
(cid:48)
(cid:48)) satisﬁes the following. For all v ∈ U 1
D
such that j1 (cid:54)= j2, j3,
dH(cid:48)(v, U 2

x→y) : x, y ∈ U 1

(cid:83) φ(D

j1

j2) = dH(cid:48)(v, U 2
j3)
and for all 1 ≤ j2, j3 ≤ r and all v ∈ U 1 \ (Vj1 ∪ Vj2 ∪ Vj3),
j3) = dH (v, U 2

dH(cid:48)(v, U 2

j2) − dH(cid:48)(v, U 2

In particular, H(cid:48) satisﬁes (Q2) and (Q3).

j2) − dH (v, U 2
j3).

j1 such that ∆(R) < 2pm

Proof. Let p := γ(cid:48)/4(r − 1) and m := |U 1

and

(10.6)
for all S ⊆ U 1
probability p has these properties with high probability.

j1 with |S| ≤ 2.

j1|. Deﬁne an auxiliary graph R on U 1
|NR(S)| ≥ p2m/2

It is easy to ﬁnd such a graph R; indeed, a random graph with edge

Let

D := {θ(Dj

x→y), θ(Dj

y→x) : xy ∈ E(R), 1 ≤ j ≤ r, j (cid:54)= j1}.

Each vertex of V appears as x or y in some θ(Dj
times. In particular, this implies |D| ≤ γ(cid:48)m2. So D satisﬁes (i) and (ii).

x→y) in D at most 2(r − 1)∆(R) < 4(r − 1)pm = γ(cid:48)m

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

31

∈ D. Let H be any r-partite graph on V which is edge-disjoint from(cid:83) φ(D) and satisﬁes (Q2) and

We now show that D satisﬁes (iii). Suppose that, for each D ∈ D, φ(D) is a copy of D on V which
is compatible with its labelling. Suppose further that φ(D) and φ(D(cid:48)) are edge-disjoint for all distinct
D, D(cid:48)
(Q3).

Let jmin := min{j : 1 ≤ j ≤ r, j (cid:54)= j1}. For each v ∈ U 1

j1 and each jmin < j ≤ r such that j (cid:54)= j1, let

(10.7)

By (Q3),

f (v, j) := dH (v, U 2

j ) − dH (v, U 2

jmin).

{u}, U 1

(cid:48)
j1,{gj(u

|f (v, j)| < γ(m + 1) < 2γm.

(10.8)
j1 appears precisely max{f (v, j), 0} times. Let U−(j) be
Let U +(j) be a multiset such that each v ∈ U 1
a multiset such that each v ∈ U 1
j1 appears precisely max{−f (v, j), 0} times. Property (Q2) implies that
|U +(j)| = |U−(j)|, so there is a bijection gj : U +(j) → U−(j).
For each copy u(cid:48) of u in U +(j), let Pu(cid:48) be a path of length two whose vertices are labelled, in order,
)}.

So Pu(cid:48) has degeneracy two. Let Sj := {Pu(cid:48) : u(cid:48)
∈ U +(j)}. It follows from (10.8) that each vertex is used
as a root vertex at most 2γm times in Sj and |Sj| ≤ 2γm2. Using (10.6), we can apply Lemma 5.1 (with
m, 2, 3, 2γ, p2/2 and R playing the roles of n, d, b, η, ε and G) to ﬁnd a set of edge-disjoint copies Tj of
the paths in Sj in R which are compatible with their labellings. (Note that we do not require the paths
in Tj to be edge-disjoint from the paths in Tj(cid:48) for j (cid:54)= j(cid:48).) We will view the paths in Tj as directed paths
whose initial vertex lies in U +(j) and whose ﬁnal vertex lies in U−(j).
For each jmin < j ≤ r such that j (cid:54)= j1, let Dj := {θ(Dj

(cid:91)
(cid:83) φ(D
jmin<j≤r
let Hj := (cid:83) φ(Dj). Consider any vertex v ∈ U 1
(cid:48)) satisﬁes (iii). For each jmin < j ≤ r such that j (cid:54)= j1,
It remains to show that H(cid:48) := H ∪
j1 and let jmin < j2 ≤ r be such that j2 (cid:54)= j1. Now
v will be the initial vertex in exactly a := max{f (v, j2), 0} paths and the ﬁnal vertex in exactly b :=
max{−f (v, j2), 0} = a − f (v, j2) paths in Tj2. Let c be the number of paths in Tj2 for which v is an
internal vertex. By deﬁnition, Hj2 contains a + c graphs φ(D) where D is of the form θ(Dj2
v→y) for
x→v) for some x ∈ U 1
some y ∈ U 1
j1.
Proposition 10.8(iii) then implies that

j1. Also, Hj2 contains b + c graphs φ(D) where D of the form θ(Dj2

x→y) : −→xy ∈ E((cid:83)

Tj)}. Let

Dj ⊆ D.

j(cid:54)=j1

D

:=

(cid:48)

(v, U 2

(v, U 2

(10.9)
For any jmin < j3 ≤ r such that j3 (cid:54)= j1, j2, Proposition 10.8(iii) implies that
(10.10)

jmin) = (b + c) − (a + c) = −f (v, j2).

j2) − dHj2

(v, U 2

(v, U 2

dHj2

jmin) = 0.

dHj3
Equations (10.9) and (10.10) imply that

j2) − dHj3

jmin) = dHj2

(v, U 2

j2) − dHj2

(v, U 2

jmin) = −f (v, j2),

which together with (10.7) gives

d(cid:83) φ(D(cid:48))(v, U 2

j2) − d(cid:83) φ(D(cid:48))(v, U 2
j2) − dH(cid:48)(v, U 2

(10.11)
Thus, for all v ∈ U 1

dH(cid:48)(v, U 2
j1 and all 1 ≤ j2, j3 ≤ r such that j1 (cid:54)= j2, j3,

jmin) = dH (v, U 2

j2) − dH (v, U 2

jmin) − f (v, j2) = 0.

dH(cid:48)(v, U 2

j2) = dH(cid:48)(v, U 2

jmin) = dH(cid:48)(v, U 2

j3).

Finally, consider any 1 ≤ j2, j3 ≤ r and any v ∈ U 1 \ (Vj1 ∪ Vj2 ∪ Vj3). Proposition 10.8(iii) implies that

d(cid:83) φ(D(cid:48))(v, U 2

j2) − d(cid:83) φ(D(cid:48))(v, U 2

j3) = 0,

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

32

so

j2) − dH (v, U 2
(10.12)
j3).
That H(cid:48) satisﬁes (Q2) and (Q3) follows immediately from (10.11) and (10.12).

j2) − dH(cid:48)(v, U 2

j3) = dH (v, U 2

dH(cid:48)(v, U 2

(cid:3)

∈ D.

(cid:48)), then

j1) = dH(cid:48)(v, U 2
j2)

(cid:83) φ(D

⊆ D such that φ(D(cid:48)) is Kr-divisible and, if D
dH(cid:48)(v, U 2

Let P = {U 1, U 2} partition the vertex set V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n. We say that
a collection D of P-labelled graphs is a (γ, γ(cid:48))-degree balancing set for the pair (U 1, U 2) if the following
properties hold. Suppose that, for each D ∈ D, φ(D) is a copy of D on V which is compatible with its
labelling. Suppose further that φ(D) and φ(D(cid:48)) are edge-disjoint for all distinct D, D(cid:48)
(a) Each D ∈ D has degeneracy at most r − 1 and |D| ≤ 10r3.
(b) |D| ≤ γ(cid:48)n2.
(e) Let H be any r-partite graph on V which is edge-disjoint from(cid:83) φ(D) and satisﬁes (Q2) and (Q3).
(c) Each vertex v ∈ V is a root vertex in at most γ(cid:48)n elements of D.
(d) For each D ∈ D, φ(D) is Kr-divisible and locally P-balanced.
(cid:48) := {D(cid:48) : D ∈ D}
Then, for each D ∈ D, there exists D(cid:48)
and H(cid:48) := H ∪
for all 1 ≤ j1, j2 ≤ r and all v ∈ U 1 \ (Vj1 ∪ Vj2).
The following result describes a (γ, γ(cid:48))-degree balancing set based on the gadgets constructed so far.
Proposition 10.10. Let 1/n (cid:28) γ (cid:28) γ(cid:48)
≤ 1/r ≤ 1/3. Let V = (V1, . . . , Vr) with |V1| = ··· = |Vr| = n.
Let P = {U 1, U 2} be a 2-partition for V . Then (U 1, U 2) has a (γ, γ(cid:48))-degree balancing set.
Proof. Apply Lemma 10.9 for each 1 ≤ j1 ≤ r with γ(cid:48)/r playing the role of γ(cid:48) to ﬁnd sets Dj1 ⊆
x→y) in (cid:83)r
{θ(Dj
j1, x (cid:54)= y, 1 ≤ j ≤ r, j (cid:54)= j1} satisfying the properties (i)–(iii). Let D consist of one
j=1 Dj. We claim that D is a (γ, γ(cid:48))-degree balancing set. Note
copy of θ(Dx,y) for each θ(Dj
that each θ(Dx,y) satisﬁes |θ(Dx,y)| ≤ 10r3 and has degeneracy at most r − 1 by (θ1) and (θ2), so (a)
holds. For each 1 ≤ j ≤ r, |Dj| ≤ γ(cid:48)n2/r, so (b) holds. Also, each vertex v ∈ V is used as a root vertex
in at most γ(cid:48)n/r elements of each Dj. Since θ(Dx,y) and θ(Dj
x→y) have the same set of root vertices, (c)
holds. Property (d) follows from Proposition 10.8(i) and (ii).
∈ D. Let H be any r-partite graph on V which is edge-disjoint from (cid:83) φ(D) and satisﬁes (Q2)
It remains to show that (e) is satisﬁed. Suppose that, for each D ∈ D, φ(D) is a copy of D on V which
(cid:83) φ(D
is compatible with its labelling. Suppose further that φ(D) and φ(D(cid:48)) are edge-disjoint for all distinct
D, D(cid:48)
(cid:48)
and (Q3). Using property (iii) of D1 in Lemma 10.9, we can ﬁnd D
1)
satisﬁes (Q2), (Q3) and

(cid:48)
1 ⊆ D1 such that H1 := H ∪

x→y) : x, y ∈ U 1

for all v ∈ U 1
(Q2), (Q3) and

1 and all 2 ≤ j1, j2 ≤ r. We can then ﬁnd D

(cid:48)
2 ⊆ D2 such that H2 := H1 ∪

(cid:48)
2) satisﬁes

dH1(v, U 2

j1) = dH1(v, U 2
j2)

(cid:83) φ(D

j where j = 1, 2 and all 1 ≤ j1, j2 ≤ r with j (cid:54)= j1, j2. Continuing in this way, we eventually

dH2(v, U 2

j1) = dH2(v, U 2
j2)

(cid:48)
r−1) satisﬁes

j1) = dHr (v, U 2
j2)

(cid:83) φ(D

(cid:48)
r ⊆ Dr such that Hr := Hr−1 ∪
(cid:83)r
For each D ∈ Dj, if D ∈ D
j=1 Dj}. For each D(cid:48)

for all v ∈ U 1
ﬁnd D
dHr (v, U 2
(10.13)
for all 1 ≤ j1, j2 ≤ r and all v ∈ U 1 \ (Vj1 ∪ Vj2).
D ∈
Proposition 10.8(i). By (10.13), D
set for (U 1, U 2).

j, then let D(cid:48) := D; otherwise let D(cid:48) be the empty graph. Let D
(cid:48)
(cid:48) := {D(cid:48) :
x→y), so φ(D(cid:48)) is Kr-divisible by
(cid:48), D(cid:48) is either empty or of the form θ(Dj
∈ D
(cid:48) satisﬁes (e). So D satisﬁes (a)–(e) and is a (γ, γ(cid:48))-degree balancing
(cid:3)

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

33

The following result ﬁnds copies of the degree balancing sets described in the previous proposition.

Proof.

(cid:48)

(cid:48)

)n.

A) ≤ γ(cid:48)n/2.

j ) ≥ (1 − 1/(r + 1) + ε)|U i

) ≥ (1 − 1/(r + 1) + ε)n − (cid:100)n/k(cid:101) − γ2n ≥ (1 − 1/(r + 1) + γ

(cid:83) φ(D) and note that
(cid:83)

Proposition 10.11. Let 1/n (cid:28) γ (cid:28) γ(cid:48)
(cid:28) 1/k (cid:28) ε (cid:28) 1/r ≤ 1/3. Let G be an r-partite graph on
(V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let P = {U 1, . . . , U k} be a k-partition for G. Suppose that
dG(v, U i
j| for all 1 ≤ i ≤ k, all 1 ≤ j ≤ r and all v /∈ Vj. Then there exists a
(γ,P)-degree balancing graph Bdeg ⊆ G such that Bdeg is locally P-balanced and ∆(Bdeg) < γ(cid:48)n.
balancing set Di1,i2 for each pair (U i1, U i2) with 1 ≤ i1 < i2 ≤ k. Let D :=(cid:83)
Choose γ1, γ2 such that γ (cid:28) γ1 (cid:28) γ2 (cid:28) γ(cid:48). Proposition 10.10 describes a (γ, γ2
1 )-degree
1≤i1<i2≤k Di1,i2. We have
1 n2 ≤ γ1n2 and each vertex is used as a root vertex in at most k2γ2
|D| ≤ k2γ2
1 n ≤ γ1n elements of D.
∆((cid:83) φ(D)) ≤ γ2n.
By (a), we can apply Lemma 5.2 (with γ1, γ2, r − 1 and 10r3 playing the roles of η, ε, d and b) to ﬁnd
edge-disjoint copies φ(D) of each D ∈ D in G which are compatible with their labellings and satisfy
Let G(cid:48) := G[P] −
ˆδ(G
A for φ(D) in G(cid:48) such that ∆((cid:83)
Let Bdeg :=(cid:83) φ(D) ∪
Apply Lemma 6.6 (with γ2, γ(cid:48)/2, 10r3 and G(cid:48) playing the roles of η, ε, b and G) to ﬁnd an absorbing set
set so(cid:83) φ(Di1,i2) is locally P-balanced by (d). Since Bdeg[U i] =(cid:83) φ(D)[U i] for each 1 ≤ i ≤ k, the graph
A. Then, ∆(Bdeg) < γ(cid:48)n. For all 1 ≤ i1 < i2 ≤ k, Di1,i2 is a degree balancing
Bdeg must also be locally P-balanced.
We now check that Bdeg is a (γ,P)-degree balancing graph. Let H be any Kr-divisible graph on V
satisfying (Q1)–(Q3). Consider any 1 ≤ i1 < i2 ≤ k. Note that H[U i1 ∪ U i2] satisﬁes (Q1)–(Q3). Since
Di1,i2 is a (γ, γ(cid:48))-degree balancing set for (U i1, U i2), there exist D(cid:48)
⊆ D for each D ∈ Di1,i2 such that
φ(D(cid:48)) is Kr-divisible and, if D
j1 ) = dH(cid:48)
Note that V ((cid:83) φ(D
for all 1 ≤ j1, j2 ≤ r and all v ∈ U i1 \ (Vj1 ∪ Vj2). Let B(cid:48)
2 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v ∈ U <i \ (Vj1 ∪ Vj2).
It remains to show that Bdeg and Bdeg − B(cid:48)
deg both have Kr-decompositions. Recall that A is an
absorbing set for φ(D). So, for any Kr-divisible subgraph D∗ of any graph in φ(D), A contains an
absorber for D∗. Also, A is Kr-decomposable for each A ∈ A. Since φ(D) is Kr-divisible for each D ∈ D
by (d), we see that Bdeg has a Kr-decomposition. Note that, for each D ∈ Di1,i2, φ(D(cid:48)) is Kr-divisible
(cid:91)
(cid:91)
by (e) and hence φ(D) − φ(D(cid:48)) is also Kr-divisible. So
A ∪
D∈D

(cid:83) φ(D
(cid:48)
i1,i2) and let H(cid:48) := H ∪ B(cid:48)

(cid:48)
i1,i2)) ⊆ U i1 ∪ U i2 for all 1 ≤ i1 < i2 ≤ k. So we have dH(cid:48)(v, U i

(cid:48)
i1,i2 := {D(cid:48) : D ∈ Di1,i2} and H(cid:48)
deg :=(cid:83)

(v, U i2

dH(cid:48)

i1,i2

i1,i2

i1,i2 := H ∪
(v, U i2
j2 )

(cid:48)
deg =

Bdeg − B

(φ(D) − φ(D

(cid:48)

))

(cid:48)
i1,i2), then

1≤i1<i2≤k φ(D

j1) = dH(cid:48)(v, U i

deg.
j2) for all

has a Kr-decomposition. Therefore, Bdeg is a (γ,P)-degree balancing graph.

(cid:3)

10.3. Finding the balancing graph. Finally, we combine the edge balancing graph and degree bal-
ancing graph from Propositions 10.7 and 10.11 respectively to ﬁnd a (γ,P)-balancing graph in G.
Proof of Lemma 10.1. Choose constants γ1 and γ2 such that γ (cid:28) γ1 (cid:28) γ2 (cid:28) γ(cid:48). First apply
Proposition 10.7 to ﬁnd a (γ,P)-edge balancing graph Bedge ⊆ G such that Bedge is locally P-balanced
and ∆(Bedge) < γ1n. Now G(cid:48) := G − Bedge satisﬁes dG(cid:48)(v, U i
j| for all v /∈ Vj,
so we can apply Proposition 10.11 to ﬁnd a (γ2,P)-degree balancing graph Bdeg ⊆ G(cid:48) such that Bdeg is
locally P-balanced and ∆(Bdeg) < γ(cid:48)n/2. Let B := Bedge ∪ Bdeg. Then ∆(B) < γ(cid:48)n and B is locally
P-balanced. Also, since both Bedge and Bdeg are Kr-decomposable, B is Kr-decomposable.

j ) ≥ (1 − 1/(r + 1) + ε/2)|U i

34

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

We now show that B is a (γ,P)-balancing graph. Let H be any Kr-divisible graph on V satisfying (P1)
and (P2). Since Bedge is a (γ,P)-edge balancing graph, there exists B(cid:48)
has a Kr-decomposition and H1 := H ∪ B(cid:48)
eH1(U i1

edge ⊆ Bedge such that Bedge− B(cid:48)

edge satisﬁes
j1 , U i2

j1 , U i2
j3 )

j2 ) = eH1(U i1
for all 1 ≤ i1 < i2 ≤ k and all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3.

edge

Note that H1 is Kr-divisible. Also

|dH1(v, U i

j2) − dH1(v, U i

j3)| + ∆(Bedge) < γn + γ1n ≤ γ2|U i
j1|
for all 2 ≤ i ≤ k, all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3 and all v ∈ U <i
H1 and γ2 replacing H and γ. Now, Bdeg is a (γ2,P)-degree balancing graph so there exists B(cid:48)
such that Bdeg − B(cid:48)

deg has a Kr-decomposition and H2 := H1 ∪ B(cid:48)

j1 . So H1 satisﬁes (Q1)–(Q3) with
deg ⊆ Bdeg

j3)| ≤ |dH (v, U i

j2) − dH (v, U i

deg satisﬁes

j1) = dH2(v, U i
j2)
for all 2 ≤ i ≤ k, all 1 ≤ j1, j2 ≤ r and all v ∈ U <i \ (Vj1 ∪ Vj2).
deg. Then B − B(cid:48) = (Bedge − B(cid:48)
Let B(cid:48) := B(cid:48)
that H ∪ B(cid:48) = H2. So B is a (γ,P)-balancing graph.

edge ∪ B(cid:48)

dH2(v, U i

edge) ∪ (Bdeg − B(cid:48)

deg) has a Kr-decomposition. Note
(cid:3)

11. Proof of Theorem 1.1

In this section, we prove our main result, Theorem 1.1. The idea is to take a suitable partition P of
V (G), cover all edges in G[P] by edge-disjoint copies of Kr and then absorb all remaining edges using an
absorber which we set aside at the start of the process. However, for the ﬁnal step to work, we need that
the classes of P have bounded size. A key step towards this is the following lemma which, for a partition
P into a bounded number of parts, ﬁnds an approximate Kr-decomposition which covers all edges of
G[P]. We then iterate this lemma inductively to get a similar lemma where the parts have bounded size
(see Lemma 11.2).
Lemma 11.1. Let 1/n (cid:28) α (cid:28) η (cid:28) ρ (cid:28) 1/k (cid:28) ε (cid:28) 1/r ≤ 1/3. Let G be a Kr-divisible graph on
(V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let P be a k-partition for G. For each x ∈ V (G), each U ∈ P
and each 1 ≤ j ≤ r, let 0 ≤ dx,Uj ≤ |Uj|. Let G0 ⊆ G − G[P], G1 := G − G0 and R ⊆ G[P]. Suppose the
following hold for all U, U(cid:48)
(a) for all x ∈ Uj, |dG(x, Uj1) − dG(x, Uj2)| < α|Uj|;
(b) for all x /∈ Vj, dG1(x, Uj) ≥ (ˆδη
(c) for all x ∈ V (G), dR(x, Uj) < ρdx,Uj + α|Uj|;
(d) for all distinct x, y ∈ V (G), dR({x, y}, Uj) < (ρ2 + α)|Uj|;
(e) for all x /∈ U ∪ U(cid:48)
(f) for all x /∈ U and all y ∈ U such that x, y /∈ Vj,

∈ P and all 1 ≤ j, j1, j2 ≤ r such that j (cid:54)= j1, j2:

∪ Vj1 ∪ Vj2, |dR(x, Uj1) − dR(x, U(cid:48)

j2)| < 3α|Uj1|;

Kr + ε)|Uj|;

dG1(y, NR(x, Uj)) ≥ ρ(1 − 1/(r − 1))dx,Uj + ρ5/4|Uj|.

Then there is a subgraph H ⊆ G1 − G[P] such that G[P]∪ H has a Kr-decomposition and ∆(H) ≤ 4rρn.
To prove Lemma 11.1, we apply Lemma 8.1 to cover almost all the edges of G[P]. We then balance
the leftover using Lemma 10.1. The remaining edges in G[P] can then be covered using Corollary 9.4.
The graph R in Lemma 11.1 forms the main part of the graph G in Corollary 9.4. Conditions (c)–(f)
ensure that R is ‘quasirandom’.
Proof. Write P = {U 1, . . . , U k}. Let G2 := G1 − R = G − G0 − R. Note that Proposition 3.1 together
with (b) and (c) implies that for any 1 ≤ i ≤ k, any 1 ≤ j ≤ r and any x /∈ Vj,
j| ≥ (1 − 1/(r + 1) + ε/2)|U i
j|.

Kr + ε − 2ρ)|U i

j ) ≥ (ˆδη

dG2(x, U i

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

35

F2

G6

F3

B

F1

G2

G3

G4

G6 − (G6[P] ∪ H2)
= G1 − (G[P] ∪ H)

G1

R

G5

G

G0

G0

Figure 3. Outline for Proof of Lemma 11.1.

Choose constants γ1, γ2 such that η (cid:28) γ1 (cid:28) γ2 (cid:28) ρ. Apply Lemma 10.1 (with γ1, γ2, ε/2, k, G2, P
playing the roles of γ, γ(cid:48), ε, k, G, P) to ﬁnd a (γ1,P)-balancing graph B ⊆ G2 such that

(11.1)
and B is locally P-balanced. As B is also Kr-decomposable, for all 1 ≤ j1, j2 ≤ r and all x /∈ Vj1 ∪ Vj2,
(11.2)

dB[P](x, Vj1) = dB[P](x, Vj2).

∆(B) < γ2n

Let G3 := G2[P] − B = G[P] − R − B. Then (b), (c) and (11.1) give
Kr + ε)n − (cid:100)n/k(cid:101) − 2ρn − γ2n ≥ (ˆδη

ˆδ(G3) ≥ (ˆδη

Kr + ε/2)n.

Consider any 1 ≤ j1, j2 ≤ r and any x /∈ Vj1 ∪ Vj2. Using (a), (e) and (11.2), we have

|dG3(x, Vj1) − dG3(x, Vj2)| ≤ |dG[P](x, Vj1) − dG[P](x, Vj2)| + |dR(x, Vj1) − dR(x, Vj2)|

< αn + 3αn = 4αn.

So we can apply Lemma 8.1 (with 4α, η, γ1/2, ε/2, G3 playing the roles of α, η, γ, ε, G) to ﬁnd G4 ⊆ G3
such that G3 − G4 has a Kr-decomposition F1 and
(11.3)
The graphs G, G3 − G4 and B are all Kr-divisible (and G3 − G4 and B are edge-disjoint), so

∆(G4) ≤ γ1n/2.

G5 := G − (G3 − G4) − B = (G − G[P] − B) ∪ G4 ∪ R

must also be Kr-divisible. Note that e(G5 ∩ B) = 0 and G5[P] = G4 ∪ R. Consider any 1 ≤ i ≤ k, any
1 ≤ j1, j2 ≤ r and any x /∈ Vj1 ∪ Vj2. If x /∈ U i, (11.3) and (e) give
j1) − dG4∪R(x, U i

j2)| = |dG4∪R(x, U i

j1) − dG5(x, U i

|dG5(x, U i

≤ ∆(G4) + |dR(x, U i

j2)|
j1) − dR(x, U i

j2)| < (γ1/2 + 3α)n < γ1n.

If x ∈ U i, then we use (a), that B is locally P-balanced and that G4, R ⊆ G[P] to see that
j1) − dB(x, U i
j2)|

j2)| + |dB(x, U i

j1) − dG5(x, U i

j1) − dG(x, U i

|dG5(x, U i

j2)| ≤ |dG(x, U i
< αn ≤ γ1n.

So (P1) and (P2) in Section 10 hold with G5 and γ1 replacing H and γ. Since B is a (γ1,P)-balancing
graph, there exists B(cid:48)
⊆ B such that B − B(cid:48) has a Kr-decomposition F2 and, for all 2 ≤ i ≤ k, all
1 ≤ j1, j2 ≤ r and all x ∈ U <i \ (Vj1 ∪ Vj2),
(11.4)

j1) = dG5∪B(cid:48)(x, U i

dG5∪B(cid:48)(x, U i

j2).

36

Write H1 :=(cid:83)k

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

i=1(B − B(cid:48))[U i] and let
(cid:48)
G6 := G5 ∪ B

− G0 = (G − G[P] − G0 − B) ∪ R ∪ G4 ∪ B

(cid:48)

.

Note that

(11.5)

G6[P] = R ∪ G4 ∪ B

(cid:48)

[P] = G5[P] ∪ B

(cid:48)

[P].

We now check conditions (i)–(iv) of Corollary 9.4 (with G6 playing the role of G). Since G0 ⊆ G − G[P],
(i) follows immediately from (11.4). For (ii), suppose that 2 ≤ i ≤ k and x ∈ U <i. For any 1 ≤ j ≤ r,
using (c), (11.3) and (11.1), we have

(11.6)

(11.5)
dG6(x, U i
j )

≤ dR(x, U i
≤ ρdx,U i

j

+ 2γ2n.

j ) + ∆(G4) + ∆(B) < ρdx,U i

+ α|U i

j| + γ1n/2 + γ2n

j

Consider any y ∈ NG6(x, U i). Note that G6[U i] = G1[U i]− (B − B(cid:48))[U i]. So, for any 1 ≤ j ≤ r such that
x, y /∈ Vj, we have

dG6(y, NG6(x, U i

j )) − ∆(B)

(f),(11.1)

j )) ≥ dG6(y, NR(x, U i

j )) ≥ dG1(y, NR(x, U i
j| − γ2n

j

≥ (1 − 1/(r − 1))ρdx,U i
≥ (1 − 1/(r − 1))dG6(x, U i
> (1 − 1/(r − 1))dG6(x, U i

+ ρ5/4|U i
j ) + ρ5/4|U i
j ) + 9krρ3/2|U i|.

(11.6)

j| − 3γ2n

So (ii) holds.
x, x(cid:48)

To see that G6 satisﬁes property (iii) of Corollary 9.4, note that for all 2 ≤ i ≤ k and all distinct

∈ U <i, (d), (11.1), (11.3) and (11.5) imply that

|NG6(x, U i) ∩ NG6(x

(cid:48)

(cid:48)
, U i)| ≤ dR({x, x

}, U i) + ∆(G4) + ∆(B)

< (ρ2 + α)|U i| + γ1n/2 + γ2n ≤ 2ρ2|U i|.

Finally, by (c), (11.1), (11.3) and (11.5), for any y ∈ U i, we have that

dG6(y, U <i) ≤ ∆(R) + ∆(G4) + ∆(B) ≤ 3ρn/2 ≤ 2kρ|U i
1|,

and (iv) holds. Hence we can apply Corollary 9.4 to G6 to ﬁnd a subgraph H2 ⊆ G6 − G6[P] such that
G6[P] ∪ H2 has a Kr-decomposition F3 and ∆(H2) ≤ 3rρn. Set H := H1 ∪ H2 ⊆ G1 − G[P]. We have
∆(H) ≤ ∆(H1) + ∆(H2) ≤ ∆(B) + ∆(H2) ≤ 4rρn. Now,

G[P] ∪ H = G2[P] ∪ R ∪ H = G3 ∪ R ∪ H ∪ B[P]

(cid:91)
(cid:91)
(cid:91)

=

=

=

F1 ∪ G4 ∪ R ∪ H ∪ B[P] =
(F1 ∪ F2) ∪ G5[P] ∪ H2 ∪ B
(F1 ∪ F2 ∪ F3).

(cid:48)

(cid:91)

(cid:91)

F1 ∪ G5[P] ∪ H1 ∪ H2 ∪ B[P]

(11.5)

=

[P]

(F1 ∪ F2) ∪ G6[P] ∪ H2

So G[P] ∪ H has a Kr-decomposition F1 ∪ F2 ∪ F3.

(cid:3)

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

37

We now iterate Lemma 11.1, applying it to each partition Pi in a partition sequence P1, . . . ,P(cid:96) for
G. This allows us to cover all of the edges in G[P(cid:96)] by edge-disjoint copies of Kr, leaving only a small

remainder in(cid:83)

U∈P(cid:96)

G[U ].

Lemma 11.2. Let 1/m (cid:28) α (cid:28) η (cid:28) ρ (cid:28) 1/k (cid:28) ε (cid:28) 1/r ≤ 1/3. Let G be a Kr-divisible graph on
(V1, . . . , Vr) with |V1| = ··· = |Vr| = n. Let P1, . . . ,P(cid:96) be a (1, k, ˆδη
Kr + ε/2, m)-partition sequence for G.
For each 1 ≤ q ≤ (cid:96), each 1 ≤ j ≤ r, each U ∈ Pq and each x ∈ V (G), let 0 ≤ dx,Uj ≤ |Uj| be given. Let
P0 := {V (G)} and, for each 0 ≤ q ≤ (cid:96), let Gq := G[Pq]. Let R1, . . . , R(cid:96) be a sequence of graphs such that
Rq ⊆ Gq − Gq−1 for each q. Suppose the following hold for all 1 ≤ q ≤ (cid:96), all 1 ≤ j, j1, j2 ≤ r such that
j (cid:54)= j1, j2, all W ∈ Pq−1, all distinct x, y ∈ W and all U, U(cid:48)
(i) if q ≥ 2, Pq[W ] is a (1, k, ˆδη
Kr + ε)-partition for G[W ];
(ii) if x ∈ Uj, |dG(x, Uj1) − dG(x, Uj2)| < α|Uj|;
(iii) dRq (x, Uj) < ρdx,Uj + α|Uj|;
(iv) dRq ({x, y}, Uj) < (ρ2 + α)|Uj|;
(v) if x /∈ U ∪ U(cid:48)
(vi) if x /∈ U , y ∈ U and x, y /∈ Vj, then

∪ Vj1 ∪ Vj2, |dRq (x, Uj1) − dRq (x, U(cid:48)

j2)| < 3α|Uj1|;

∈ Pq[W ]:

where G(cid:48)

dG(cid:48)

q+1

q+1 := Gq+1 − Rq+1 if q ≤ (cid:96) − 1 and G(cid:48)

(y, NRq (x, Uj)) ≥ ρ(1 − 1/(r − 1))dx,Uj + ρ5/4|Uj|
(cid:83)

(cid:96)+1 := G.

U∈P(cid:96)

(cid:83)

G[U ] such that G − H has a Kr-decomposition.

Then there is a subgraph H ⊆
Proof. We will use induction on (cid:96). If (cid:96) = 1, apply Lemma 11.1 (with ε/2, P1, R1 and the empty graph
playing the roles of ε, P, R and G0) to ﬁnd H(cid:48)
⊆ G− G[P1] such that G[P1]∪ H(cid:48) has a Kr-decomposition.
Letting H := G − G[P1] − H(cid:48)
Suppose then that (cid:96) ≥ 2 and the result holds for all smaller (cid:96). Note that for each 1 ≤ j ≤ r, each
x /∈ Vj and each U ∈ P1, dG[P2]−R2(x, Uj) ≥ (ˆδη
Kr + ε/3)|Uj|, since R2 satisﬁes (iii) and P1, . . . ,P(cid:96) is a
(1, k, ˆδη
Kr + ε/2, m)-partition sequence for G. So we may apply Lemma 11.1 (with ε/3, P1, R1, G and
G∗ is Kr-divisible. Observe that G∗ =(cid:83)
(G − G[P2]) ∪ R2 playing the roles of ε, P, R, G and G0) to ﬁnd H(cid:48)
⊆ G[P2] − (G[P1] ∪ R2) such that
G[P1] ∪ H(cid:48) has a Kr-decomposition F1 and ∆(H(cid:48)) ≤ 4rρn. Let G∗ := G − G[P1] − H(cid:48) = G −
F1, so
U∈P1 G∗[U ], so G∗[U ] is Kr-divisible for each U ∈ P1.
Consider any U ∈ P1. We check that

G[U ], shows the result holds for (cid:96) = 1.

(cid:83)

U∈P(cid:96)

⊆

∗

G

[U ],P2[U ], . . . ,P(cid:96)[U ], R2[U ], . . . , R(cid:96)[U ]

satisfy the conditions of Lemma 11.2. Since ∆(H(cid:48)) ≤ 4rρn ≤ εn/4k2, P2[U ] is a (1, k, ˆδη
Kr + ε/2)-
partition for G∗[U ]. For any 3 ≤ q ≤ (cid:96) and any W ∈ Pq−1, G∗[W ] = G[W ] since H(cid:48)
⊆ G[P2].
Kr + ε/2, m)-partition sequence for G∗[U ]. For (ii), note
So (i) holds and P2[U ], . . . ,P(cid:96)[U ] is a (1, k, ˆδη
j) = dG(x, U(cid:48)
that for any 2 ≤ q ≤ (cid:96), any 1 ≤ j ≤ r, any U(cid:48)
j).
(cid:83)
Conditions (iii)–(v) are automatically satisﬁed. To see that (vi) holds, note that for any 2 ≤ q ≤ (cid:96) and
any U(cid:48)
(cid:83)
HU has a Kr-decomposition FU . Set H :=(cid:83)
⊆ G[P2]. So we can apply the induction hypothesis to
G∗[U ],P2[U ], . . . ,P(cid:96)[U ], R2[U ], . . . , R(cid:96)[U ] to obtain a subgraph HU ⊆
U(cid:48)∈P(cid:96)[U ] G∗[U(cid:48)] such that G∗[U ]−
U∈P(cid:96)
U∈P1 HU . Then, H ⊆
G[U ] and G − H has a Kr-
(cid:3)
decomposition F1 ∪

q+1[U(cid:48)] = Gq+1[U(cid:48)] since H(cid:48)
(cid:83)

∈ Pq[U ] and any x ∈ U(cid:48), dG∗(x, U(cid:48)

∈ Pq[U ], G∗

U∈P1 FU .

We are now ready to prove Theorem 1.1.

Proof of Theorem 1.1. Let n0 ∈ N and η > 0 be such that 1/n0 (cid:28) η (cid:28) ε and choose additional
constants η1, m(cid:48), α, ρ and k such that

1/n0 (cid:28) η1 (cid:28) 1/m

(cid:48)

(cid:28) α (cid:28) η (cid:28) ρ (cid:28) 1/k (cid:28) ε.

38

BEN BARBER, DANIELA K ¨UHN, ALLAN LO, DERYK OSTHUS AND AMELIA TAYLOR

Let G be any Kr-divisible graph on (V1, . . . , Vr) with |V1| = ··· = |Vr| = n ≥ n0 and ˆδ(G) ≥ (ˆδη
Kr + ε)n.
≤ m ≤ km(cid:48).
Apply Lemma 7.2 to ﬁnd an (α, k, ˆδη
So in particular, by (S3), for each 1 ≤ q ≤ (cid:96), all 1 ≤ j1, j2, j3 ≤ r with j1 (cid:54)= j2, j3, each U ∈ Pq and each
x ∈ Uj1,
(11.7)

Kr +ε−α, m)-partition sequence P1, . . . ,P(cid:96) for G where m(cid:48)

|dG(x, Uj2) − dG(x, Uj3)| < α|Uj1|.

Let P0 := {V (G)} and Gq := G[Pq] for 0 ≤ q ≤ (cid:96). Note that ˆδη
Kr + ε − α ≥ 1 − 1/r + ε (with room to
spare) by Proposition 3.1. So we can apply Corollary 7.5 to ﬁnd a sequence of graphs R1, . . . , R(cid:96) such
that Rq ⊆ Gq − Gq−1 for each 1 ≤ q ≤ (cid:96) and the following holds. For all 1 ≤ q ≤ (cid:96), all 1 ≤ j, j(cid:48)
≤ r, all
W ∈ Pq−1, all distinct x, y ∈ W and all U, U(cid:48)

∈ Pq[W ],

dRq (x, Uj) < ρdGq (x, Uj) + α|Uj|;
dRq ({x, y}, Uj) < (ρ2 + α)|Uj|;
(cid:48)
j(cid:48))| < 3α|Uj|
(y, NRq (x, Uj)) ≥ ρ(1 − 1/(r − 1))dGq (x, Uj) + ρ5/4|Uj|

|dRq (x, Uj) − dRq (x, U

q+1

dG(cid:48)
q+1 := Gq+1 − Rq+1 if q ≤ (cid:96) − 1 and G(cid:48)

(cid:96)+1 := G.

(11.8)

where G(cid:48)

(cid:48)

if x /∈ U ∪ U
if x /∈ U, y ∈ U and x, y /∈ Vj,

∪ Vj ∪ Vj(cid:48);

Let H := {G[U ] : U ∈ P(cid:96)}. Each H ∈ H satisﬁes |H| ≤ rm. Note that

ˆδ(G[P1] − R1) ≥ (ˆδη

Kr + ε)n − (cid:100)n/k(cid:101) − 2ρn > (1 − 1/(r + 1) + ε/2)n.
A satisﬁes ∆(A∗) ≤ αn.

an absorbing set A for H inside G[P1] − R1 such that A∗ :=(cid:83)
So we can apply Lemma 6.6 (with η1, α, rm and G[P1] − R1 playing the roles of η, ε, b and G) to ﬁnd
Let G∗ := G− A∗. Note that both G and A∗ are Kr-divisible, so G∗ is Kr-divisible. Since ∆(A∗) ≤ αn
and A∗
Kr + ε/2, m)-partition sequence for G∗. For each 1 ≤ q ≤ (cid:96),
each 1 ≤ j ≤ r, each U ∈ Pq and each x ∈ V (G), set dx,Uj := dGq (x, Uj). Using (11.7), (11.8) and that
A∗
⊆ G[P1], we see that G∗, the partition sequence P1, . . . ,P(cid:96) and the sequence of graphs R1, . . . , R(cid:96)
Note that H is a Kr-divisible subgraph of (cid:83)
satisfy properties (i)–(vi) of Lemma 11.2 (with ε− α playing the role of ε). So we may apply Lemma 11.2
to ﬁnd H ⊆
G[U ], so for each U ∈ P(cid:96), H[U ] ⊆ G[U ] is Kr-
divisible. Since A is an absorbing set for H, it contains a distinct absorber for each H[U ]. So H ∪ A∗ has
a Kr-decomposition F2. Thus G = (G∗
(cid:3)

⊆ G[P1], P1, . . . ,P(cid:96) is an (1, k, ˆδη
(cid:83)

− H) ∪ (H ∪ A∗) has a Kr-decomposition F1 ∪ F2.

− H has a Kr-decomposition F1.

G∗[U ] such that G∗

U∈P(cid:96)

U∈P(cid:96)

We are grateful to Peter Dukes and Richard Montgomery for helpful discussions.

Acknowledgements

References

[1] L.D. Anderson and A.J.W. Hilton, Thanks Evans!, Proc. London Math. Soc. 47 (1983) 507–522.
[2] B. Barber, D. K¨uhn, A. Lo, R. Montgomery and D. Osthus, Fractional clique decompositions of dense graphs and

hypergraphs, arXiv:1507.04985, 2015.

[3] B. Barber, D. K¨uhn, A. Lo and D. Osthus, Edge-decompositions of graphs with high minimum degree, Advances in

Mathematics 288 (2016), 337–385.

[4] P. Bartlett, Completions of ε-dense partial Latin squares, J. Combin. Designs 21 (2013) 447–463.
[5] A.G. Chetwynd and R. H¨aggkvist, Completing partial Latin squares where each row, column and symbol is used at

most cn times, Reports Dept. Mathematics, Univ. Stockholm (1985).

[6] S. Chowla, P. Erd˝os and E. Straus, On the maximal number of pairwise orthogonal Latin squares of a given order,

Canadian J. Math. 12 (1960) 204–208.

[7] D.E. Daykin and R. H¨aggkvist, Completion of sparse partial latin squares, Graph theory and combinatorics (Cambridge,

1983), pages 127–132, Academic Press, London, 1984.

[8] F. Dross, Fractional triangle decompositions in graphs with large minimum degree, SIAM J. Discrete Math. 30 (2016)

36–42.

CLIQUE DECOMPOSITIONS OF MULTIPARTITE GRAPHS AND COMPLETION OF LATIN SQUARES

39

[9] P. Dukes, Rational decomposition of dense hypergraphs and some related eigenvalue estimates, Linear Algebra Appl.

436(9) (2012) 3736–3746. Corrigendum: Linear Algebra Appl. 467 (2015) 267–269.

[10] P. Dukes, Fractional triangle decompositions of dense 3-partite graphs, arXiv:1510.08998, 2015.
[11] K. Garaschuk,

Linear methods

triangle

for

rational

decompositions. PhD thesis, Univ. Victoria,

https://dspace.library.uvic.ca//handle/1828/5665, 2014.

[12] S. Glock, D. K¨uhn, A. Lo, R. Montgomery and D. Osthus, On the decomposition threshold of a given graph, in

preparation.

[13] T. Gustavsson, Decompositions of large graphs and digraphs with high minimum degree. PhD thesis, Univ. Stockholm

(1991).

[14] P.E. Haxell and V. R¨odl, Integer and fractional packings in dense graphs, Combinatorica 21(1) (2001) 13–38.
[15] S. Janson, T. (cid:32)Luczak and A. Ruci´nski, Random graphs. Wiley-Interscience Series in Discrete Mathematics and Opti-

mization. Wiley-Interscience, New York, 2000.

[16] P. Keevash, The existence of designs, arXiv:1401.3665, 2014.
[17] P. Keevash and R. Mycroft, A geometric theory for hypergraph matching, Memoirs American Math. Soc. 233 (2014),

number 1098.

[18] T.P. Kirkman, On a problem in combinatorics, Cambridge Dublin Mathematical Journal 2 (1847) 191–204.
[19] D. K¨uhn, F. Knox and D. Osthus, Edge-disjoint Hamilton cycles in random graphs, Random Structures Algorithms 46

(2015) 397–445.

[20] A. Lo and K. Markstr¨om, A multipartite Hajnal-Szemer´edi theorem for graphs and hypergraphs, Comb. Probab. Comput.

22 (2013) 97–111.

[21] R. Montgomery, Fractional clique decompositions of dense partite graphs, preprint.
[22] C.St.J.A. Nash-Williams, An unsolved problem concerning decomposition of graphs into triangles. In Combinatorial

Theory and its Applications III, pages 1179–1183. North Holland, 1970.

[23] R. Raman, The power of collision: randomized parallel algorithms for chaining and integer sorting. In Foundations of
software technology and theoretical computer science (Bangalore, 1990), volume 472 of Lecture Notes in Comput. Sci.,
pages 161–175. Springer, Berlin, 1990.

[24] B. Smetianuk, A new construction on latin squares I. A proof of the Evans conjecture, Ars Combinatorica 11 (1981)

155–172.

[25] E. Szemer´edi, Regular Partitions of Graphs, Probl´emes Combinatoires et Th´eorie des Graphes Colloques Internationaux

CNRS 260 (1978) 399–401.

[26] A. Taylor, Substructures in large graphs, PhD thesis, University of Birmingham, in preparation.
[27] R.M. Wilson, Decompositions of complete graphs into subgraphs isomorphic to a given graph. In Proceedings of the
Fifth British Combinatorial Conference (Univ. Aberdeen, Aberdeen, 1975), pages 647–659. Congressus Numerantium,
No. XV, Utilitas Math., Winnipeg, Man., 1976.

[28] R. Yuster, Asymptotically optimal Kk-packings of dense graphs via fractional Kk-decompositions, J. Combin. Theory

Ser. B 95(1) (2005) 1–11.

Ben Barber
Heilbronn Institute for Mathematical Research
School of Mathematics
University of Bristol
University Walk
Bristol
BS8 1TW
UK
E-mail address: b.a.barber@bristol.ac.uk
Daniela K¨uhn, Allan Lo, Deryk Osthus, Amelia Taylor
School of Mathematics
University of Birmingham
Edgbaston
Birmingham
B15 2TT
UK

E-mail addresses: {d.kuhn, s.a.lo, d.osthus}@bham.ac.uk, a.m.taylor@pgr.bham.ac.uk

