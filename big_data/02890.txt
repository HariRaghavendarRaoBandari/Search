6
1
0
2

 
r
a

M
9

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
0
9
8
2
0

.

3
0
6
1
:
v
i
X
r
a

A Polynomial Analogue of Landau’s Theorem and Related

Problems

Oﬁr Gorodetsky

Abstract

Recently, an analogue over Fq[T ] of Landau’s Theorem on sums of two squares was considered by
Bary-Soroker, Smilansky and Wolf [10]. They counted the number of monic polynomials in Fq[T ] of
degree n of the form A2 + T B 2, which we denote by B(n, q). They studied B(n, q) in two limits: ﬁxed n
and large q, and ﬁxed q and large n. We generalize their result to the most general limit qn → ∞. More
precisely, we prove

B(n, q) ∼ Kq

1

· n −

n ! · qn,

2

qn

→ ∞,

(0.1)

q(cid:17).
for an explicit constant Kq = 1 + O(cid:16) 1

Our methods are diﬀerent and are based on giving explicit bounds on the coeﬃcients of generating
functions. These methods also apply to other problems, related to polynomials with prime factors of
even degree.

1

Introduction

Let b(n) be the characteristic function of integers that are representable as a sum of two squares and let

be the number of such integers up to x. Landau’s Theorem [9] gives an asymptotic formula for B(x):

B(x) = K

b(n)

B(x) =Xn≤x
ln3/2 x(cid:19) ,
+ O(cid:18) x
(1 − p−2)−1/2 ≈ 0.764

x → ∞,

x
√ln x
√2 Yp≡3 mod 4

1

where

K =

is the Landau-Ramanujan constant.

(1.1)

(1.2)

(1.3)

(1.4)

(1.5)

A polynomial analogue of the function B(x), which we describe below, was studied by Bary-Soroker,
Smilansky and Wolf [10]. Let q be an odd prime power, and Fq denote the ﬁeld of q elements. Denote by
Mn,q the set of monic polynomials in Fq[T ] of degree n, by Mq = ∪n≥0Mn,q the set of all monic polynomials
in Fq[T ] and by Pq the set of monic irreducible polynomials in Fq[T ].
For a polynomial f ∈ Mn,q we deﬁne the characteristic function

bq(f ) =(1,

0

f = A2 + T B2 for A, B ∈ Fq[T ]
otherwise

and the counting function

B(n, q) = Xf∈Mn,q

bq(f ).

1

In [10, Thm. 1.2,1.3], the asymptotic behaviour of B(n, q) was studied in two limits: ﬁxed n and large q,
and ﬁxed q and large n:

B(n, q) = (cid:0)2n
n(cid:1)4n · qn + On(qn−1),
n3/2(cid:19) ,
+ Oq(cid:18) qn
Kq√π ·

B(n, q) =

qn
√n

q → ∞,

n → ∞,

where

Kq = (1 − q−1)− 1

2 YP∈Pq:( P

T )=−1

(1 − q−2 deg P )− 1

2 = 1 + O(cid:18) 1
q(cid:19) .

(1.6)

(1.7)

(1.8)

The authors of [10] write ”We do not know of an asymptotic formula for B(n, q) in any more general sub-limits
of qn → ∞”. We prove an asymptotic formula in the most general limit qn → ∞.

Theorem 1.1.

B(n, q) = Kq ·(cid:18)n − 1

n (cid:19) · qn + O(cid:18) qn−1
n3/2(cid:19) ,

2

qn → ∞,

(1.9)

and the implied constant is absolute.

We also investigate the constant Kq, which turns out to be an analytic function of q−1.

Remark 1.2. To see that Theorem 1.1 is consistent with (1.6) and (1.7), note that

n (cid:19) = (cid:0)2n
n(cid:1)4n ∼
(cid:18)n − 1
and that by (1.8), Kq = 1 + O(cid:16) 1
q(cid:17).

2

1
√πn

,

n → ∞,

(1.10)

Our methods diﬀer from those used in [10], and are based on explicit estimates for the coeﬃcients of
a certain class of generating functions. Another advantage of our methods, is that they apply to other
problems, see §2.

Acknowledgements

I thank my advisor, Lior Bary-Soroker, for introducing me to Landau’s Theorem, for helpful discussions and
for teaching me, patiently, how to write. Also, I thank Amotz Oppenheim and Ze´ev Rudnick for their useful
comments on this paper and Mikhail Sodin for a helpful discussion related to the analytic part of the paper.
This research was partially supported by the Israel Science Foundation grant no. 952/14.

2 Further Applications

2.1 Prime Factors of Even Degree

Suppose we want to count ”ordinary” sums of two squares in Fq[T ], i.e. elements of the form A2 + B2. If

q ≡ 1 mod 4, then √−1 ∈ Fq, and so A2 + B2 = (A + √−1B)(A − √−1B). Given f ∈ Fq[T ], we have
f = ( f−1
2 )2, and so every polynomial is of the form A2 + B2. If q ≡ 3 mod 4, Leahey [20] has
shown that the polynomials of the form A2 + B2 are those whose prime factors of odd degree appear only
with even multiplicity. This raises the problem of estimating the number of monic polynomials of a given
degree in the following set, which makes sense for any prime power q:

2√−1 )2 + ( f +1

S1(q) = {f ∈ Mq : P | f and 2 ∤ deg P =⇒ 2 | vP (f )},

(2.1)

2

where vP (f ) is the multiplicity of P in f . Let

Chuang, Kuan and Yu [14] considered two natural variations on S1(q). The ﬁrst is the subset of S1(q) of
polynomials with no odd-degree prime factors:

B1(2n, q) = #{f ∈ S1(q) : deg f = 2n}.

(2.2)

S2(q) = {f ∈ Mq : P | f =⇒ 2 | deg P},

B2(2n, q) = #{f ∈ S2(q) : deg f = 2n}.

The second is the subset of squarefree polynomials in S2(q):

S3(q) = {f ∈ Mq : P | f =⇒ 2 | deg P and P 2 ∤ f},

B3(2n, q) = #{f ∈ S3(q) : deg f = 2n}.

(2.3)

(2.4)

The motivation for studying S2(q), S3(q) is the following. Assume that q is odd. As observed by Artin [15]
in his study of quadratic extensions of Fq(T ), the analogue over Fq[T ] of a fundamental discriminant is a
squarefree monic polynomial D. The negative Pell equation asks for the solubility of

where γq is a generator of F×q . By considering (2.5) modulo a prime factor P of D, we ﬁnd

X 2 − DY 2 = γq with X, Y ∈ Fq[T ],

The asymptotics of B2(2n, q), B3(2n, q) in the limit n → ∞ are given in [14, Thm. 1,2]:

B2(2n, q) = Cq,2

B3(2n, q) = Cq,3

q2n
√πn
q2n
√πn

n3/2(cid:19) ,
+ Oq(cid:18) q2n
n3/2(cid:19) ,
+ Oq(cid:18) q2n

n → ∞

n → ∞

where Cq,2 and Cq,3 are positive constants, given explicitly in [14, Thm. 1,2] as inﬁnite products.
We modify the main term of (2.7) to obtain an asymptotic formula in the general limit qn → ∞.
Theorem 2.1. For any positive integer n,

2

B1(2n, q) = Cq,1 ·(cid:18)n − 1
B2(2n, q) = Cq,2 ·(cid:18)n − 1
B3(2n, q) = Cq,3 ·(cid:18)n − 1

n (cid:19) · q2n + O(cid:18) q2n−1
n3/2 (cid:19) ,
n (cid:19) · q2n + O(cid:18) q2n−1
n3/2 (cid:19) ,
n (cid:19) · q2n + O(cid:18) q2n−1
n3/2 (cid:19) ,
q(cid:17).
where the implied constants are absolute. Moreover, Cq,i = 1 + O(cid:16) 1

2

2

qn → ∞,

qn → ∞,

qn → ∞, ,

3

(cid:16) γq
P(cid:17) = 1,

where(cid:0) •P(cid:1) is the Legendre symbol modulo P . By quadratic reciprocity, (2.6) implies that P has even degree.

Thus, the negative Pell equation has no solution for a given fundamental discriminant D of degree 2N unless
D is among those B3(2N, q) polynomials counted in (2.4).

The problem of estimating, in the limit n → ∞, the proportion in B3(2n, q) of the discriminants D for
which (2.5) is soluble, is an open problem studied by Bae and Jung [16, Thm. 1.5]. Their work is motivated
by the number ﬁeld setting, studied by Stevenhagen [17, Conj. 1.2] and Fouvry and Kl¨uners [18, Thm. 1].

(2.5)

(2.6)

(2.7)

(2.8)

(2.9)

(2.10)

2.2 Higher Genus

The paper [14] also considers an higher genus analogue of S2(q), S3(q). Consider a function ﬁeld K with
ﬁnite constant ﬁeld Fq, i.e. K is a ﬁnitely generated ﬁeld extension of transcendence degree one over Fq and
Fq is algebraically closed in K. For each place v of K, the residue ﬁeld at v is denoted by Fv which has
cardinality qv. The degree deg v of v is [Fv : Fq]. Let Kr be the ﬁxed constant ﬁeld extension over K of
degree r. Let Div(K) be the divisor group of K. We adopt the multiplicative notation so that every element
m in Div(K) is written as

Given m ∈ Div(K), we deﬁne

where

vordv (m).

m =Yv
kmk =Yv
deg m =Xv

qordv(m)
v

= qdeg m,

deg v · ordv(m)

(2.11)

(2.12)

(2.13)

(2.14)

(2.15)

(2.16)

(2.17)

(2.18)

is the degree of m. A divisor m is said to be positive if ordv(m) ≥ 0 for every place v of K. The set of
positive divisors is denoted by Div≥0(K).

Given positive integers n ≥ 1, ℓ ≥ 1, r ≥ 2, the following sets of positive divisors were studied in [14]:

S2(r, K) = {g ∈ Div≥0(k) : ordv(g) > 0 =⇒ r | deg vi},

S3(r, ℓ, K) = {g ∈ Div≥0(k) : ordv(g) > 0 =⇒ r | deg vi and ordv(g) ≤ ℓ}.

The asymptotics of

and

B2(rn, r, K) = #{g ∈ S2(r, K) : deg g = rn}

B3(rn, r, ℓ, K) = #{g ∈ S3(r, ℓ, K) : deg g = rn}

in the limit n → ∞ are given in [14, Thm. 3,4]:
r −1
n
Γ( 1

B2(rn, r, K) = Cr,K ·

1

B3(rn, r, ℓ, K) = Cr,ℓ,K ·

r ) · qrn(cid:18)1 + Or,K(cid:18) 1
n(cid:19)(cid:19) ,
n(cid:19)(cid:19) ,
r ) · qrn(cid:18)1 + Or,ℓ,K(cid:18) 1

r −1
n
Γ( 1

1

n → ∞,

n → ∞,

where Cr,K and Cr,ℓ,K are positive constants, given explicitly in [14, Thm. 3,4] as inﬁnite products.
We modify the main terms of (2.18) to obtain asymptotic formulas which hold in a more general range of
parameters.

Theorem 2.2. Let K be a function ﬁeld with constant ﬁeld Fq. Let gK be the genus of K, and deﬁne

fgK = max{gK, 1}. Given positive integers n ≥ 1, ℓ ≥ 1, r ≥ 2, we have

B2(rn, r, K) =(cid:18)n + 1
B3(rn, r, ℓ, K) =(cid:18)n + 1

r − 1
n

r − 1
n

(cid:19) · qrn · Cr,K + O  exp(126 fgK
(cid:19) · qrn · Cr,ℓ,K + O  exp(126 fgK

rqr/2 ) fgK
n
rqr/2 ) fgK
n

rqr/2

rqr/2

!! ,
!! ,

as long as

n ≫ 1 + fgK

r2 ln(q)

ln(cid:18) fgK

r2 ln(q)

+ 1(cid:19) .

4

(2.19)

(2.20)

(2.21)

Remark 2.3. In Theorem 2.2, the expression(cid:0)n+ 1

1

r −1
n

(cid:1) appears instead of n

1
r −1
r ) . By [21, Eq. 14],

Γ( 1

(cid:18)n + 1
(cid:18)n + 1

r − 1
n

r − 1
n

(cid:19) ≤
(cid:19) ≥

,

r −1
n
Γ( 1
r )
(n + 1
r )
Γ( 1
r )

and

1

r −1

=

1

r −1
n
Γ( 1

r ) (cid:18)1 +

r −1

1

rn(cid:19) 1
r ) (cid:18)1 −

1

rn(cid:19) .

1

r −1
n
Γ( 1

r ) (cid:18)1 +

1

rn(cid:19)−1

≥

1

r −1
n
Γ( 1

≥

(2.22)

From the proof of Theorem 2.2 we deduce the following corollary.

Corollary 2.4. Let {Ki}i≥1 be a sequence of function ﬁelds with constant ﬁelds Fqi . Let gKi be the genus
of Ki. Fix integers n ≥ 1, r ≥ 2, ℓ ≥ 1. Assume that
lim
i→∞

qi = ∞

(2.23)

= 1.

(2.24)

(2.25)

and

Then

lim
i→∞

lim
i→∞

gKi
qr/2
i

= 0.

B2(rn, r, Ki)

r −1
n

(cid:0)n+ 1

(cid:1) · qrn

i

= lim
i→∞

B3(rn, r, ℓ, Ki)

r −1
n

(cid:0)n+ 1

(cid:1) · qrn

i

2.3 Prime Factors in an Arithmetic Progression
Let a, m ∈ Fq[T ] be a pair of coprime polynomials with m monic of positive degree. Let Ga,m ⊆ Fq[T ] be
the set of monic polynomials whose monic prime factors are in the arithmetic progression a(T ) mod m(T ).
Let

S(n; a, m) = #{f ∈ Ga,m : deg(f ) = n},

(2.26)

be the number of polynomials of degree n in the semigroup Ga,m. What bounds are satisﬁed by S(n; a, m)?
Although studying S(n; a, m) is interesting for its own sake, the case a = 1 is an important ingredient in
the proof of the following theorem of Thorne [11, Thm. 1.2], which is a function ﬁeld analogue of a theorem
of Shiu [12, Thm. 1].
Theorem 2.5 (Thorne). Let a, m ∈ Fq[T ] with gcd(a, m) = 1 and deg m > 0, m monic. There exists a
constant D′ (depending on q and m) such that for any D > D′ there exists a string of consecutive monic
primes

of degree at most D, where k satisﬁes

pr+1 ≡ pr+2 ··· ≡ pr+k ≡ a mod m

k ≫q

1

φ(m)(cid:18) log D

(log log D)2(cid:19)1/φ(m)

.

(2.27)

(2.28)

Here ”consecutive” is to be understood with respect to lexicographic order. Thorne’s proof uses the

following asymptotic formula, Corollary of a result of Manstaviˇcius and Skrabut˙enas [6, Thm. 1]:

S(n; 1, m) ∼ C1,m ·

where

Ca,m = lim
q −
u→ 1

(1 − qu)1/φ(m)

φ(m)

n−1+ 1
Γ(1/φ(m)) · qn, n → ∞,
YP∈Pq:P≡a mod m

(1 − udeg P )−1.

(2.29)

(2.30)

As remarked after [11, Lem. 3.5], making (2.29) eﬀective allows one to determine the constant D′ appearing
in Theorem 2.5. We establish the following version of (2.29).

5

Theorem 2.6. Let a, m ∈ Fq[T ] be a pair of coprime polynomials with deg m > 0 and m monic. For

n ≥ 1 + 5 (6 deg m + 30) ln (6 deg m + 30) ,

we have

S(n; a, m) =(cid:18)n + 1

φ(m) − 1
n

where the implied constant is (at most) 48.

(cid:19) · qnCa,m + O

exp( 3(deg m+3)

√q

) (deg m+3)

√q

n

 ,

(2.31)

(2.32)

3 Methods

Let q be a prime power, and let Fq[T ] be the polynomial ring over the ﬁnite ﬁeld Fq. Denote by πq(n) the
number of irreducible monic polynomials in Fq[T ] of degree n.

Let G ⊆ Fq[T ] be a multiplicative semigroup generated by (possibly inﬁnitely many) mutually coprime
monic polynomials. Let g(n) be the number of generators of degree n. The coeﬃcients of the generating
function

(1 + xn + x2n + ··· )g(n)

(1 − xn)−g(n)

FG(x) := Yn≥1
= Yn≥1
expXn≥1
ψG(n) :=Xd|n

ψG(n)xn

n  ,

d · g(d).

(3.1)

(3.2)

(3.3)

(3.4)

count how many polynomials in G are of a speciﬁed degree. Via logarithmic diﬀerentiation, we may express
FG(x) as the formal power series

where

For instance, when G = Mq ⊆ Fq[T ] is the semigroup of monic polynomials, generated by monic irreducible
πq(d), which satisﬁes [1, Prop. 2.1]

polynomials, the corresponding function ψMq is the weighted prime-counting function ψMq (n) =Pd|n d ·

ψMq (n) =Xd|n

d · πq(d) = qn.

It turns out that for many semigroups that occur in counting problems, ψG satisﬁes the following bound,
where α, β, c1, c2 are some real numbers satisfying α > β > 0:

The bound (3.5) insures that we can write FG as a product of two analytic functions, with radii of convergence
at most α and exactly β, respectively:

|ψG(n) − c1β−n| ≤ c2α−n.

(3.5)

FG(x) = expXn≥1
= expXn≥1

where

enxn

n  · expXn≥1
n  ·(cid:18)1 −
β(cid:19)−c1

x

enxn

c1β−nxn

n 

,

en = ψG(n) − c1β−n.

6

(3.6)

(3.7)

In particular, the radii of convergence are distinct.
The problem of estimating the coeﬃcients of a product of two functions with diﬀerent radii of convergence has

[xn]f (x) denotes the coeﬃcient of xn in f , i.e. fn.
We mention two classical results. The ﬁrst is [2, Thm. VI.12].

been studied previously. First, we introduce a useful piece of notation. For a power series f (x) =Pi≥0 fixi,
Theorem 3.1. Let a(x) = P anxn and b(x) = P bnxn be two power series with radii of convergence
α > β ≥ 0, respectively. Assume that bn−1
of the product f (x) = a(x) · b(x) satisfy the following, as n tends to ∞:

bn → β as n tends to ∞, and that a(β) 6= 0. Then the coeﬃcients

Theorem 3.1 is proved using calculus. Applying Theorem 3.1, we solve the problem of estimating

[xn]f (x) ∼ a(β) · bn.

(3.8)

[xn]FG(x) as n tends to ∞ and q is ﬁxed, under assumption (3.5):

1

n

(3.9)

enαn

enαn

β(cid:19)n
(cid:19) · β−n.

Theorem 3.1 does not give information on the rate of convergence. A method, due to Darboux, gives a more
informative estimate for certain b’s [3, Thm. 11.10b].

[xn]FG(x) ∼ expXn≥1
n  ·(cid:18)−c1
n (cid:19) ·(cid:18)−
= expXn≥1
n  ·(cid:18)n + c1 − 1
β )−c1 =P bnxn (c1 ∈ C \ Z) be two power series with
Theorem 3.2. Let a(x) =P anxn and b(x) = (1 − x
mXk=1 (cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)

radii of convergence α > β ≥ 0, respectively. Fix an integer m ≥ 0. Then the coeﬃcients of the product
f (x) = a(x) · b(x) satisfy the following, as n tends to ∞:

[xn]f (x) = bn · a(β) +

a(k)(β) + Oa,b,m(cid:18) 1

Most proofs of Theorem 3.2 use contour integration, although an elementary proof was found by Knuth
and Wilf [4]. Using (3.6), Theorem 3.2 gives an asymptotic expansion of [xn]FG(x), as n tends to ∞, in all
of this paper’s applications.
Methods similar to Theorem 3.2 were used to study semigroup counting problems related to ﬁnite ﬁelds

nm+1(cid:19)! .

βk
k!

(3.10)

k

in the limit n → ∞ and q ﬁxed, see the papers [5, 6] and the monographs [7, 8].

Our objective is to establish results on the magnitude of [xn]FG(x) in the limit qn → ∞, for which
Theorem 3.2 is not suitable. To do so, we need to work out the dependency of the error term in (3.10) on
the parameters a, b. This is done in the following theorem, under additional restrictions inﬂuenced by (3.5).

Theorem 3.3. Let a(x) = exp(cid:16)Pn≥1 fanxn

n (cid:17) =P anxn and b(x) = (1 − x

two power series, with radii of convergence at least α and exactly β, respectively. Assume that α > β > 0.
Assume that

β )−c1 =P bnxn (c1 ∈ (0, 1)) be

(3.11)

(3.12)

(3.13)

1
√2
Further assume that there is a positive number c2 such that

β
α ≤

r =

.

Fix an integer m ≥ 0. For an integer n > m, write the n’th coeﬃcient fn of f (x) = a(x) · b(x) as

[xn]f (x) = bn · a(β) +

a(k)(β) + E! .

βk
k!

c2
αn .

|fan| ≤
mXk=1 (cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)

k

7

Then

|E| ≪m exp(3c2r)(cid:18)(cid:16) r
≪m,c1,c2(cid:16) r
n(cid:17)m+1

,

n(cid:17)m+1

(c2 + m)m+1 +(cid:18)n + c2 − 1

n

(cid:19) 4n2

c1

rn(cid:19)

(3.14)

(3.15)

where (x)n := x(x − 1)··· (x − (n − 1)) is the falling factorial. For m = 0, the implicit constant in (3.14) is
(at most) 24.

We also establish the following eﬀective corollary.

Corollary 3.4. Let a, b, α, β be as in Theorem 3.3, and assume that they satisfy (3.11), (3.12). Let
f (x) = a(x) · b(x). For n large enough, speciﬁcally

n ≥ max{5(cid:18) 2c2 + 4

ln( 1
r )

+ 1(cid:19) ln(cid:18) 2c2 + 4

+ 1(cid:19) + 1, 2
[xn]f (x) = bn ·(cid:18)a(β) + O(cid:18) exp(3c2r)c2r

ln( 1
r )

n

ln(c−1
1 )
ln( 1
r )

+ 1},

(cid:19)(cid:19) ,

(3.16)

(3.17)

we have

where the implied constant is (at most) 48.

Remark 3.5. In all of our applications, the Riemann Hypothesis for Function Fields shows that β−1 is a
of the form qc for some positive integer c depending on the application and α−1 is the square root of β−1.
Thus, r = β

α = q−c/2, which has two implications. First, (3.11) is satisﬁed. Second,

which by (3.15) shows that as q tends to ∞, the relative error term E tends to 0.
Remark 3.6. Assumption (3.12) implies that

r
n

lim
q→∞

= 0,

|a(β)| ≥ expXn≥1
|a(β)| ≤ expXn≥1

n

 ≥ expXn≥1
− |fan| βn
n  ≤ expXn≥1
|fan| βn

−c2rn

n  = (1 − r)c2 ,
n  = (1 − r)−c2 .

c2rn

In particular, we get the bound a(β) = exp (O(c2r)).

4 Landau’s Theorem over Fq[T ], for A2 + T B2

(3.18)

(3.19)

Let Gq ⊆ Fq[T ] be the set of monic polynomials of the form A2 + T B2. By [10, Thm. 2.5], a monic
irreducible polynomial f is in Gq if and only if the multiplicity of any monic irreducible polynomial P of

T(cid:1) = −1 in the factorization of f is even. In other words, Gq is the semigroup generated by the

following set of mutually coprime polynomials:

the form(cid:0) P

{P ∈ Fq[T ] : P is monic irreducible satisfying (cid:18) P

T(cid:19) = 1}
[{P 2 : P ∈ Fq[T ] is monic irreducible satisfying (cid:18) P

T(cid:19) = −1}[{T}.

Let χ2 : Fq[T ] → C denote the quadratic character modulo T :

(4.1)

(4.2)

T(cid:19) .
χ2(f ) =(cid:18) f

8

For any set S ⊆ {−1, 0, 1}, let πq(n; χ2, S) count the monic irreducible polynomials P of degree n in Fq[T ]
such that χ2(f ) ∈ S. For s ∈ {−1, 0, 1}, we write πq(n; χ2, s) for πq(n; χ2,{s}). It follows that the generating
function FGq of B(n, q) is

(1 − xn)−πq(n;χ2,{0,1})(1 − x2n)−πq(n;χ2,−1).

2 ∤ n
2 ; χ2,−1) 2 | n

,

B(n, q)xn

FGq (x) =Xn≥0
= Yn≥1
g(n) =(πq(n; χ2,{0, 1})
πq(n; χ2,{0, 1}) + πq( n
FGq (x) = Yn≥1
FGq (x) = expXn≥1
ψGq (n) =Xd|n

(1 − xn)−g(n).

 ,

ψGq (n)xn

n

d · g(d).

If we set

then FGq assumes the form

As before, one sees that

where

In §4.1 we obtain a closed-form expression for ψGq (n). In particular, we ﬁnd that

satisﬁes

en = ψGq (n) −

qn
2

en = O(q⌊n/2⌋),

(4.3)

(4.4)

(4.5)

(4.6)

(4.7)

(4.8)

(4.9)

(4.10)

(4.11)

and, as we saw in (3.6), we may write FGq as a product of two power series with distinct radii of convergence:

2 .

enxn

FGq (x) = expXn≥1
a(x) = expXn≥1

n  · (1 − qx)− 1
n  , b(x) = (1 − qx)− 1

enxn

2

Theorem 3.3 with

gives the asymptotics of B(n, q).

4.1 Proof of Theorem 1.1

First, we obtain an explicit formula for en. We write the (formal) zeta function of Fq[T ] and its Euler
product:

ZFq[T ](u) = Xf∈Mq
= YP∈Pq

udeg f = (1 − qu)−1
(1 − udeg P )−1 = Yn≥1

(1 − un)−πq(n).

(4.12)

9

We have πq(n) = πq(n; χ2,{0, 1}) + πq(n; χ2,−1), and so logarithmic diﬀerentiation of (4.12) gives

qn =Xd|n

d · (πq(d; χ2,{0, 1}) + πq(d; χ2,−1)) .

We consider the (formal) L-function of the quadratic character χ2:

LFq[T ](u, χ2) = Xf∈Mq

χ2(f )udeg f .

On the one hand, LFq[T ](u, χ2) is actually the constant polynomial 1, as half of the elements of F×q are
squares and half are non-squares:
(4.15)
On the other hand, since χ2 is completely multiplicative, LFq[T ](u, χ2) admits the following Euler product:

LFq[T ](u, χ2) = 1.

LFq[T ](u, χ2) = YP∈Pq:χ(P )=1

(1 − udeg P )−1 YP∈Pq:χ(P )=−1

(1 + udeg P )−1

= Yn≥1
= Yn≥1

(1 − un)πq(n;χ2,1)Yn≥1
(1 − un)−πq(n;χ2,{0,1})Yn≥1

(1 + un)πq(n;χ2,−1)

(1 + un)−πq(n;χ2,−1) · (1 − u).

(4.13)

(4.14)

(4.16)

(4.17)

(4.18)

(4.19)

Comparing (4.15) and (4.16), we have the following identity:

1

1 − u

= Yn≥1

(1 − un)−πq(n;χ2,{0,1})Yn≥1

(1 + un)−πq(n;χ2,−1).

We take the logarithmic derivative of (4.17), and obtain the following by comparing coeﬃcients:

1 =Xd|n

Using (4.13), we simplify (4.18):

d ·(cid:16)πq(d; χ2,{0, 1}) + πq(d; χ2,−1)(−1)n/d(cid:17) .
Xd|n,2d∤n

d · πq(d; χ2,−1) =

qn − 1

2

.

Let v2(n) be the exponent of the greatest power of 2 that divides n. To computePd|n d · πq(d; χ2,−1), we

2v2 (n) for n in (4.19) and sum:

plug n, n

2 ,··· ,

n

Xd|n

d · πq(d; χ2,−1) =

qn/2i
2

− 1

.

v2(n)Xi=0

Using (4.13) and (4.20), we ﬁnd

Xd|n

d · πq(d; χ2,{0, 1}) =

qn + 1

2 −

v2(n)Xi=1

qn/2i
2

− 1

.

(4.20)

(4.21)

10

Now we can calculatePd|n d · g(d), using deﬁnition (4.4) and (4.20), (4.21):

d
2

; χ2,−1)

d′ · πq(d′; χ2,−1)

Xd|n

d · g(d) =Xd|n
=Xd|n

d · πq(

d · πq(d; χ2,{0, 1}) + X2|d|n
d · πq(d; χ2,{0, 1}) + 2X2d′|n
v2(n/2)Xi=0

qn/2i
2

− 1

+ 2

2 −

qn + 1

qn + 1

2

+

qn/2i
2

− 1

.

v2(n)Xi=1
v2(n)Xi=1

=

=

By (4.22), the exact value of en, as deﬁned in (4.8), is

In particular, en satisﬁes

en =

1
2

+

v2(n)Xi=1

qn/2i
2

− 1

.

1
2 ≤ en ≤ q⌊n/2⌋.

qn/2i+1
2

− 1

(4.22)

(4.23)

(4.24)

We establish Theorem 1.1 with Kq = a(q−1). For n = 1, Theorem 1.1 is immediate since B(1, q) = q+1
by (4.24),

2 and,

Kq = a(q−1) = expXn≥1
= expXn≥1

n

O(q⌊n/2⌋−n)

en · q−n

n 
 = exp(cid:18)O(cid:18) 1
1 (cid:19) · q + O (1) ,

2

B(1, q) = Kq ·(cid:18)1 − 1

q(cid:19)(cid:19) = O(1),

and so

(4.25)

(4.26)

(4.27)

(4.28)

as needed. Now assume that n > 1. We may use Theorem 3.3 with m = 1 and the functions a, b as deﬁned
in (4.11), which satisfy a · b = FGq as we have seen in (4.10). By (4.24), the parameters for Theorem 3.3 are

We get the following estimate on B(n, q):

c1 =

1
2

, c2 = 1, α = q− 1

2 , β = q−1.

= a(q−1) +

1

a′(q−1)

2n − 1

q

+ O(cid:18) 1
qn2(cid:19) .

Theorem 1.1 follows once we show a′(q−1) = O(1). Note (4.24) implies that

B(n, q)

2

(cid:0)n− 1
n (cid:1) · qn
=Xn≥1

a′(q−1)
a(q−1)

en · q1−n =Xn≥1

O(q1+⌊n/2⌋−n) = O(1).

(4.29)

By (4.25) and (4.29), a′(q−1) = O(1) is established, as needed. It is obvious that Kq agrees with (1.8).

11

Remark 4.1. We show that B(n, q) is a polynomial in q of degree n, and explain how to compute its ﬁrst
d coeﬃcients. From deﬁnition (4.3) and identity (4.10), we get

From (4.23) we see that en is a polynomial in q of degree ≤ ⌊ n

2⌋. Thus, the n’th coeﬃcient of

ejxj

j  .

2

=

ejxj

B(n, q) = [xn](1 − qx)− 1
qn−i(cid:18)n − i − 1

2 · expXj≥1
j 
n − i (cid:19) · [xi] expXj≥1
nXi=0
i!Xj≥1
j 
j  =Xi≥0
expXj≥1
j  ≤ n − i + ⌊
n − i (cid:19) · [xi] expXj≥1
degqqn−i(cid:18)n − i − 1

2⌋. Hence, for any i ≤ n,

ejxj

ejxj

ejxj

1

2

i

is also a polynomial in q of degree ≤ ⌊ n

(4.30)

(4.31)

(4.33)

i
2⌋ = n − ⌈

i
2⌉,

(4.32)

and if i = 0 then equality holds in (4.32). Hence, (4.32) implies that B(n, q) is a polynomial in q of degree n.

If one only wants the ﬁrst d coeﬃcients of B(n, q), then only the ﬁrst 2d − 1 coeﬃcients of exp(cid:16)Pj≥1

are needed, as may be seen from the following identity, which follows from (4.30) and (4.32):

j (cid:17)

ej xj

B(n, q) =

2d−2Xi=0

4.2 The Constant Kq

qn−i(cid:18)n − i − 1

n − i (cid:19) · [xi] expXj≥1

2

ejxj

j  + On(qn−d).

We study the constant appearing in the main term of Theorem 1.1, Kq. In (1.8), the constant is expressed
as the following Euler product:

Kq = (1 − q−1)− 1

(1 − q−2 deg P )− 1

2 .

2 YP∈Pq:( P

T )=−1

(4.34)

We provide another expression, which is the polynomial analogue of the following similar expression obtained
in the integer setting independently in [22, 23]:

K =

1

√2 Yn≥1(cid:18)(1 −

1
22n )

ζ(2n)

L(2n, χ)(cid:19)1/2n+1

,

(4.35)

Although the method of derivation of (4.35) applies mutatis mutandis to the polynomial setting, we do it
slightly diﬀerently. In the process we obtain a functional equation for FGq (x).

χ(n)
ns and where χ is the principal character modulo 4.

where ζ(s) =Pn≥1 n−s, L(s, χ) =Pn≥1
Lemma 4.2. Let A(x) = exp(cid:16)Pn≥1
B(x) = exp(cid:16)Pn≥1

n (cid:17). Then

bnxn

anxn

n (cid:17) be a formal power series. Let bn = (an − an/2
A(x) =Yk≥0

B(x2k

)2−k

an

,

2 | n
2 ∤ n

and

(4.36)

12

where each of the roots B(x2k
In particular,

)2−k

is chosen so that the constant term is 1.

A2(x)
A(x2)

= B2(x).

Proof. Assertion (4.37) follows from (4.36). We have

B(x2k

)2−k

Yk≥0

so it suﬃces to show

which follows from the deﬁnition of bn.

bnx2kn

expXn≥1
2kn 
=Yk≥0
(cid:16)Pv2(n)
i=0 bn/2i(cid:17) xn
= expXn≥1
v2(n)Xi=0

2i ,
b n

an =

n

 ,

Applying Lemma 4.2 to A = FGq , we ﬁnd

F 2
Gq (x)
FGq (x2)

= h2(x),

Using the formula ψGq (n) = qn+1

−1

(see (4.23)) we ﬁnd

h(x) = expXn≥1
2 +Pv2(n)

qn/2i
2

i=1

(ψGq (n) − ψGq (

xn
n

 .

n
2

)
)

=0 if 2∤n

| {z }

ψGq (n) − ψGq (

n
2

qn − (−1)n

,

)

=

2

where

thus

and

where

(4.37)

(4.38)

(4.39)

(4.40)

(4.41)

(4.42)

(4.43)

(4.44)

=0 if 2∤n

| {z }
h(x) =r 1 + x

1 − qx

,

F 2
Gq (x)
FGq (x2)

=

1 + x
1 − qx

.

enxn

enxn

n (cid:17), we ﬁnd
expXn≥1
n  =Yk≥0eh(x2k
eh(x) =
4p1 − qx2

√1 + x

.

)2−k

13

This functional equation determines FGq (x) uniquely, assuming FGq is a power series with FGq (0) 6= 0.

Applying Lemma 4.2 to A(x) = a(x) = exp(cid:16)Pn≥1

,

(4.45)

(4.46)

Plugging x = q−1 in (4.45) gives the following identity:

Kq =Yk≥0

2k+1p1 + q−2k
2k+2p1 − q1−2k+1

= p1 + q−1
4p1 − q−1

4p1 + q−2
8p1 − q−3

8p1 + q−4
16p1 − q−7 ··· ,

which shows that Kq is an analytic function of q−1.

Next we discuss the the analogy between (4.47) and (4.35). Deﬁne |f| = qdeg f , and put

ζFq[T ](s) = Xf∈Mq
LFq[T ](s, χ2) = Xf∈Mq

1

|f|−s =

1 − q1−s ,
χ2(f )|f|−s = 1.

(4.47)

(4.48)

One may rearrange the terms of the product in (4.47) in a way that gives an expression which is analogous
to (4.35):

Kq =

1

p1 − q−1 Yn≥1(cid:18)(1 −

4.3 Second-Order Term for Fixed q

1
q2n )

ζFq[T ](2n)

LFq[T ](2n, χ2)(cid:19)1/2n+1

.

(4.49)

In the integer setting, Shanks [22] computed numerically the coeﬃcient c appearing in the following expan-
sion:

b(n) = K

Xn≤x

x

√ln x(cid:18)1 +

c

ln x

+ O(cid:18) 1

ln2 x(cid:19)(cid:19) ,

and found that c ≈ 0.581948659. We study a similar problem in the polynomial setting.
Equation (4.28) shows that in the limit n → ∞, we may expand B(n, q) as follows:

B(n, q) = Kq ·(cid:18)n − 1

n (cid:19) · qn(cid:18)1 +

2

a′(q−1)
2q · a(q−1)

1
n

+ O(cid:18) 1

qn2(cid:19)(cid:19) .

We give a formula for the constant

cq =

using the exact formula (4.23) for en:

a′(q−1)
2q · a(q−1)

(4.50)

(4.51)

(4.52)

(4.53)

(4.54)

cq =

=

=

eiq−i =

1

1

2Xi≥1
4 1
4 1

1

q − 1

q − 1

1

4Xi≥1
+Xj≥1Xi′≥1
+Xj≥1(cid:18)

i

1

=

eiq−i,

2Xi≥1
2k −i − q−i(cid:17)
q−i +
v2(i)Xk=1(cid:16)q
qi′(1−2j ) − q−i′2j
q2j − 1(cid:19)
q2(cid:19) .
+ O(cid:18) 1

1

1

q2j−1 − 1 −

cq =

1
2q

14

In particular, (4.53) gives the following estimate for cq:

5 Landau’s Theorem over Fq[T ], for A2 + B2

5.1 Proof of Theorem 2.1

We only prove estimate (2.8), as (2.9), (2.10) are proven mutatis mutandis.
Let q be a prime power. As explained in the beginning of §2, for q ≡ 3 mod 4, the set S1(q) deﬁned in
(2.1) is the set of monic polynomials of the form A2 + B2, although we study it for any prime power q. By
deﬁnition, S1(q) is the multiplicative semigroup of Fq[T ] generated by the following set of mutually coprime
polynomials:

{P ∈ Fq[T ] : P is monic irreducible of even degree }

[{P 2 : P ∈ Fq[T ] is monic irreducible of odd degree }.

It follows that the generating function of B1(2n, q) (counting function of S1(q), deﬁned in (2.2)) is

(5.1)

(5.2)

(5.3)

(5.4)

(5.5)

(5.6)

FS1(q)(x) =Xn≥0

B1(2n, q)xn

(1 − xdeg P )−1

If we set

then FS1(q) assumes the form

As before, one sees that

where

= YP∈Pq: 2|deg P
= Yn≥1

,

πq(2n)

2 ∤ n
2 | n

(1 − xdeg P/2)−1 YP∈Pq: 2∤deg P
(1 − xn)−πq(2n)(1 − x2n−1)−πq(2n−1).
h(n) =(πq(2n) + πq(n)
FS1(q)(x) = Yn≥1
FS1(q)(x) = expXn≥1
ψS1(q)(n) =Xd|n

(1 − xn)−h(n).

 ,

ψS1(q)(n)xn

d · h(d).

n

We evaluate ψS1(q)(n). Let v2(n) be the exponent of the greatest power of 2 that divides n. By (5.6) and
(3.4), we have

1

=

d · πd(d)

d · πq(2d) + Xd|n, 2∤d
ψS1(q)(n) =Xd|n
2Xd′|2n
2Xd′|2n
2Xd′|2n

d′ · πq(d′) + Xd|n, 2∤d
d′ · πq(d′) − Xd′|2n, 2∤d′
d′ · πq(d′) +
2 Xd′|n, 2∤d′
d′ · πq(d′)
2 Xd′|
d′ · πq(d′) .
d′ · πq(d′) +

2v2(n)

=

=

1

1

n

1

1

15

d · πq(d)

(5.7)

By (3.4) and (5.7), we ﬁnd

If we deﬁne

we see by (5.7) that

ψS1(q)(n) =

q(cid:16) n

2v2(n) (cid:17)
2

.

q2n
2

+

fn = ψS1(q)(n) −

q2n
2

,

q(cid:16) n

2v2 (n) (cid:17)
2

fn =

= O(qn).

(5.8)

(5.9)

(5.10)

As we saw in (3.6), we may write FS1(q) as a product of two power series with distinct radii of convergence:

We may apply Theorem 3.3 with m = 0 and

2 .

fnxn

FS1(q)(x) = expXn≥1
a(x) = expXn≥1

n  · (1 − q2x)− 1
n  , b(x) = (1 − q2x)− 1

fnxn

2 .

By (5.10), the parameters for Theorem 3.3 are

By Theorem 3.3 we ﬁnd

c1 =

1
2

, c2 =

1
2

, α = q−1, β = q−2.

B1(2n, q) =(cid:18)n − 1

n (cid:19) · q2n ·(cid:18)a(q−2) + O(cid:18) 1

qn(cid:19)(cid:19) .

2

This establishes (2.8) with

By Remark 3.6,

which concludes the proof.

5.2 The Constant Cq,1

Cq,1 = a(q−2).

Cq,1 = 1 + O(cid:18) 1
q(cid:19) ,

(5.11)

(5.12)

(5.13)

(5.14)

(5.15)

(5.16)

(5.17)

(5.18)

(5.19)

We study the constant appearing in the main term of (2.8), Cq,1. First, we show how we may express it as
a product over primes. By (5.11) (5.12), and (5.13),

a(x) =

FS1(q)(x)

b(x)

for any |x| < q−2. Letting x →(cid:0)q−2(cid:1)− in (5.17) and using (5.15), we get

FS1(q)(x)

Cq,1 = lim

x→(q−2)−

.

b(x)

For 0 < x < q−2, b has the following Euler product:

2 (1 + q√x)− 1

2

b(x) = (1 − q2x)− 1

2 = (1 − q√x)− 1
Fq[T ](−√x)
Fq[T ](√x) · Z 1/2
= Z 1/2
= YP∈Pq
(1 − xdeg P/2)−1/2 · YP∈Pq

(1 − (−1)deg P xdeg P/2)−1/2,

16

where ZFq[T ](x) is deﬁned in (4.12). By considering odd-degree and even-degree primes separately, (5.19)
shows
(5.20)

By (5.18), (5.20) and the Euler product for FS1(q) given in (5.2), we get the following expression for Cq,1:

Cq,1 = lim

(1 − xdeg P )−1/2.

(1 − xdeg P/2)−1 YP∈Pq: 2∤deg P

b(x) = YP∈Pq: 2|deg P
x→(q−2)− QP∈Pq: 2|deg P (1 − xdeg P/2)−1QP∈Pq: 2∤deg P (1 − xdeg P )−1
QP∈Pq: 2|deg P (1 − xdeg P/2)−1QP∈Pq: 2∤deg P (1 − xdeg P )−1/2
x→(q−2)− YP∈Pq: 2∤deg P
= YP∈Pq: 2∤deg P
(1 − q−2 deg P )− 1

(1 − xdeg P )− 1

= lim

2 .

2

We provide another expression for Cq,1. Applying Lemma 4.2 to A(x) = exp(cid:16)Pn≥1

fnxn

n (cid:17), we ﬁnd

where

B(x) = expX2∤n

Plugging x = q−2 in (5.22) and using (5.15), we get

(5.22)

(5.23)

=(cid:18) 1 + qx
1 − qx(cid:19) 1

4

.

.

(5.24)

B(x2k

)2−k

,

qnxn

qnxn

fnxn

n  =Yk≥0
expXn≥1
2n (cid:17)
exp(cid:16)Pn≥1
2n  =
2n (cid:17) =
exp(cid:16)P2|n
Cq,1 = Yk≥0  1 + q1−2k+1

qnxn

1 − q1−2k+1!−2−k−2

2

(1 − qx)− 1
(1 − q2x2)− 1

4

LFq[T ](s, η) = Xf∈Mq

η(f )|f|−s,

1

1 − q1−s .

(−1)nqnq−ns =

LFq[T ](s, η) =Xn≥0
Cq,1 = Yn≥1(cid:18) ζFq[T ](2n)

LFq[T ](2n, η)(cid:19)1/2n+1

.

(5.21)

(5.25)

(5.26)

(5.27)

(5.28)

Next we discuss the the analogy between (5.24) and (4.35). Let η : Fq[T ] → C be the (generalized) Dirichlet
character η(f ) = (−1)deg(f ), and deﬁne |f| = qdeg f . Let ζFq[T ] be as in (4.48) and

which equals

The identity (5.24) may be written diﬀerently as an expression which is analogous to (4.35):

5.3 Second-Order Term for Fixed q
Consider the functions a, b deﬁned in (5.12). By (5.11), the product a · b is the generating function of
B1(2n, q). Hence, if we apply Theorem 3.3 with m = 1 to the functions a, b, we ﬁnd that in the limit
n → ∞, we may expand B1(2n, q) as follows:

B1(2n, q) = Cq,1 ·(cid:18)n − 1

n (cid:19) · q2n(cid:18)1 +

2

a′(q−2)

2q2 · a(q−2)

1
n

+ O(cid:18) 1

q2n2(cid:19)(cid:19) .

17

We give a formula for the constant c′q = a′(q−2)

In particular, (5.29) gives the following estimate for c′q:

2q2·a(q−2) = 1
2Xi≥1
1
fiq−2i =

c′q =

c′q =

1
4q

i

1

q(cid:16)

2v2(i) (cid:17)−2i.

2Pi≥1 fiq−2i using the exact formula (5.9) for fn:
4Xi≥1
q3(cid:19) .
+ O(cid:18) 1

(5.29)

(5.30)

6 Counting Divisors over Function Fields

Here we prove Theorem 2.2 and Corollary 2.4. First, we prove an auxiliary lemma.

6.1 Counting Primes

Lemma 6.1. Let K be a function ﬁeld with ﬁnite constant ﬁeld Fq, i.e. K is a ﬁnitely generated ﬁeld
extension of transcendence degree one over Fq and Fq is algebraically closed in K. For any n ≥ 1, let

πK(n) = #{ Primes of degree n in K}.

Given integers r ≥ 2, ℓ ≥ 1, deﬁne the following functions:

ψr,K(n) =Xd|n

d · πK(rd),

fr,ℓ,K(n) = πK(rn) − πK(

ℓ + 1

ψr,ℓ,K(n) =Xd|n

d · fr,ℓ,K(d).

rn

{z

)

,

}

=0 if ℓ+1∤rn

|

Let

Then

fgK = max{gK, 1}.
+ O(cid:18)fgK
+ O(cid:18)fgK

qrn
r
qrn
r

r

r

qrn/2(cid:19) ,
qrn/2(cid:19) ,

ψr,K(n) =

ψr,ℓ,K(n) =

(6.1)

(6.2)

(6.3)

(6.4)

(6.5)

(6.6)

(6.7)

(6.8)

(6.9)

where the implied constants are (at most) 16 and 42, respectively.

Proof. The zeta function of K is

ζK(u) = XD∈Div≥0(K)

udeg D = Yn≥1

(1 − un)−πK (n).

The function ζK(u) is a rational function in u of the form

ζK(u) =

LK(u)

(1 − u)(1 − qu)

,

where LK is a polynomial with LK(0) = 1 and of degree twice the genus of K, 2gK. The Riemann Hypothesis
for ζK, proved by Weil, shows that the absolute value of the roots of LK is q−1/2 [1, Thm. A.7]. Hence,
taking the logarithmic derivative of (6.8), (6.9) and equating coeﬃcients, we ﬁnd

Xd|n

d · πK(d) = qn + 1 + O(gKqn/2) = qn + O(cid:16)fgKqn/2(cid:17) ,

18

(6.10)

with implied constant (at most) 3. We estimate ψr,K(n) as follows, using (6.10):

Xd|n

d · πK (rd) =

=

=

1

1

rd · πK(rd)

rXd|n
rXd′|rn
d′ · πK(d′) − Xr∤d′|rn
rqrn + O(fgK qrn/2) − Xr∤d′|rn

1

d′ · πK(d′)
d′ · πK(d′) ,

where the implied constant is 3. If d′ is an integer dividing nr but not divisible by r, it means d′ | nr
some prime p dividing nr. Hence, using (6.10), we see that the sumPr∤d′|nr d′ · πK(d′) is at most

p for

Xr∤d′|nr

2 ⌋/2Xi≥0

q− i

2

(6.12)

1

2 ⌋

(6.11)

(6.13)

(6.14)

(6.15)

(6.16)

(6.17)

Combining (6.11), (6.12), we get (6.6) with an implied constant 3 + 13 = 16. We now prove (6.7). Note that
(6.10) implies

If ℓ + 1 ∤ rn, then ψr,ℓ,K(n) = ψr,K(n), and (6.7) is established. Otherwise, by (6.13),

nr

p

nr

1

≤

4

nr
2 .

πK(n) ≤

d′ · πK (d′)
2p(cid:17)

d′ · πK(d′) ≤Xp|nr Xd′| nr
≤Xp|nr(cid:16)qnr/p + 3fgKq
2 ⌋Xi≥0
q−i + 3fgK√q⌊ nr
≤ q⌊ nr
1 − q−1 q⌊ nr
1 − q−1/2 q⌊ nr
2 ⌋ + 3fgK
3fgK
1 − 2−1/2 )q
≤ (2 +
2 ≤ 13fgKq
nfgKqn.
ℓ + 1(cid:19) ≤ 4fgK
≤ 4fgK
≤ 8fgK
d · πK(cid:18) rd
ℓ + 1(cid:19) ≤ 16fgK
ℓ + 1(cid:19) ≤

r Xd|n, ℓ+1|rd
ℓ+1Xi≥0

d · πK(cid:18) rd

d · πK(cid:18) rd

Xd|n, ℓ+1|rd

Xd|n, ℓ+1|rd

Xd|n, ℓ+1|rd

· rn · q

ℓ + 1

rn

2 .

q

rn

ℓ+1 .

q

ℓ + 1

ℓ + 1

r

r

rn

3 .

r

8fgK

r

rd
ℓ+1

q

rn

q

q−i

If ℓ = 1, then (6.14) gives

By (6.15) and (6.6), estimate (6.7) is established with the absolute constant 16+16=32.
If ℓ > 1, then (6.14) gives

Note that for any positive x.

x =

6
e ln 2 · e ·

ln 2
6

x ≤

6
e ln 2 · e · exp((

ln 2
6

x) − 1) =

6
e ln 2 · 2x/6 ≤

6
e ln 2 · qx/6.

19

Using (6.17) with x = rn in (6.16), we get

Xd|n, ℓ+1|rd

d · πK(cid:18) rd

ℓ + 1(cid:19) ≤

8 ·

6

e ln 2fgK

r

rn

2 .

q

(6.18)

By (6.15) and (6.6), estimate (6.7) is established with the absolute constant 16 + 8 ·

6

e ln 2 ≤ 42.

6.2 Proof of Theorem 2.2
The generating function Fr,K of {B2(rn, r, K)}n≥0 is, by deﬁnition,

(1 + xn + x2n + ··· )πK (rn)

(1 − xn)−πK (rn)

ψr,K(n)xn

n

 ,

Fr,K (x) = Yn≥1
= Yn≥1
= expXn≥1
Fr,ℓ,K(x) = Yn≥1

(1 + xn + ··· + xnℓ)πK (rn)

.

= Yn≥1(cid:18) 1 − xn(ℓ+1)
1 − xn (cid:19)πK (rn)
(1 − xn)−fr,ℓ,K (n) = expXn≥1

ψr,ℓ,K(n)xn

n

 ,

(6.19)

(6.20)

(6.21)

where πK is deﬁned in (6.1) and ψr,K is deﬁned in (6.2). The generating function Fr,ℓ,K of {B3(rn, r, ℓ, K)}n≥0
is, by deﬁnition,

We may rearrange (6.20) as follows:

Fr,ℓ,K(x) = Yn≥1

where fr,ℓ,K and ψr,ℓ,K are deﬁned in (6.3) and (6.4), respectively. The estimates (6.6), (6.7) of Lemma 6.1
show that we may write Fr,K, Fr,ℓ,K as

where

Fr,K = a1 · b,
Fr,ℓ,K = a2 · b,

r ,

a1 =

Fr,K

b

b(x) = expXn≥1

qrnxn

n  = (1 − qrx)− 1
n  ,
= expXn≥1 ga1,nxn
n  ,
= expXn≥1 ga2,nxn
qrn/2(cid:19) ,
|ga1,n| ,|ga2,n| = O(cid:18)fgK

Fr,ℓ,K

r

b

a2 =

20

(6.22)

(6.23)

(6.24)

where the implied constant in (6.24) is (at most) 42.
We apply Corollary 3.4 to a1, b and a2, b, with the following parameters, given by (6.23), (6.24):

, α = q−r, β = q−r/2.

(6.25)

c1 =

1
r

, c2 ≤

r

42fgK
+ 1! ln  4·42·fgK

We get that the estimates (2.19), (2.20) of Theorem 2.2 hold with an absolute implied constant, as long as

n ≥ max{2 ·  4·42·fgK

r + 8
r ln q

r + 8
r ln q

+ 1! + 1,

4
ln q

ln r
r

+ 1}.

(6.26)

4

Since
with the range (2.21) of Theorem 2.2, as needed.

ln r
r + 1 = O(1) and

r +8
r ln q + 1 = O( fgK

ln q

4·42·ggK

r2 ln q + 1), we get that the range (6.26) may be replaced

6.3 Proof of Corollary 2.4

We continue from (6.24). We apply Theorem 3.3 with m = 0 to a1, b and a2, b. We ﬁnd

B2(rn, r, K)

B3(rn, r, ℓ, K)

r −1
n

r −1
n

(cid:0)n+ 1
(cid:0)n+ 1

(cid:1) · qrn
(cid:1) · qrn

= a1(q−r) + O exp(cid:18) 3fgK
= a2(q−r) + O exp(cid:18) 3fgK

rqr/2(cid:19)  fgK
rqr/2(cid:19)  fgK

rqr/2n

rqr/2n

+(cid:18)n + 42fgK
+(cid:18)n + 42fgK

r − 1
n

r − 1
n

rqrn/2!! ,
(cid:19) n2
rqrn/2!! .
(cid:19) n2

(6.27)

Let Ki/Fqi be a sequence of function ﬁelds satisfying the conditions of Corollary 2.4. We denote the functions
a1, a2 corresponding to Ki by a1,Ki, a2,Ki, in order to emphasize the dependence of a1, a2 on Ki. In this
new notation, (6.27) gives

B2(rn, r, Ki)

B3(rn, r, ℓ, Ki)

r −1
n

(cid:0)n+ 1
(cid:0)n+ 1

r −1
n

i

(cid:1) · qrn
(cid:1) · qrn

i

By Remark 3.6,

= a1,Ki(q−r

i

= a2,Ki(q−r

i

rqr/2

) + O exp  3ggKi
) + O exp  3ggKi

i n

rqr/2

rqr/2

i !  ggKi
i !  ggKi
) = exp O  ggKi

+(cid:18)n +
+(cid:18)n +
i !! ,

rqr/2

rqr/2

i n

aj,Ki(q−r

i

42ggKi
r − 1
n
42ggKi
r − 1
n

rqrn/2

i

(cid:19) n2
(cid:19) n2

i

rqrn/2

for j = 1, 2. In particular, condition (2.24) implies

aj,Ki(q−r

i

) = 1,

lim
i→∞

for j = 1, 2. Next, note that

(cid:18)n +

42ggKi
r − 1
n

(cid:19) n2

rqrn/2

i

≤ n2  n − 1 +

qr/2
i

42ggKi

r

!n

.

By conditions (2.23) and (2.24) and estimate (6.31), we get

i→∞(cid:18)n + 42ggKi

lim

r − 1
n

(cid:19) n2

rqrn/2

i

= 0.

Combining (6.28), (6.30), (6.32) and (2.24), Corollary 2.4 follows.

21

!! ,
!! .

(6.28)

(6.29)

(6.30)

(6.31)

(6.32)

7 Polynomials with Prime Factors in an Arithmetic Progression

Let a, m ∈ Fq[T ] be a pair of coprime polynomials with deg m > 0, m monic. Let Ga,m ⊆ Fq[T ] be the
set of monic polynomials whose monic prime factors lie in the arithmetic progression a(T ) mod m(T ). Let
πq(n; a, m) count the number of monic primes of degree n in the arithmetic progression a(T ) mod m(T ).
The generating function of S(n; a, m) (counting function of Ga,m, deﬁned in (2.26)) is

As before, one sees that

where

Hence,

We estimate ψGa,m(n). By a result of Wan [19, Thm. 5.1],

The tailPd|n,d<n d · πq(d; a, m) is easily bounded:

(1 − xn)−πq(n;a,m).

ψGa,m (n)xn

n

 ,

d · πq(d; a, m).

FGa,m (x) = Yn≥1
FGa,m(x) = expXn≥1
ψGa,m(n) =Xd|n
(cid:12)(cid:12)(cid:12)(cid:12)n · πq(n; a, m) −
φ(m)(cid:12)(cid:12)(cid:12)(cid:12) ≤ (deg(m) + 1))q
d · πq(d; a, m) ≤ Xd|n,d<n

qn

qn

(cid:12)(cid:12)(cid:12)(cid:12)ψGa,m(n) −
Xd|n,d<n

n
2 .

φ(m)(cid:12)(cid:12)(cid:12)(cid:12) ≤ (deg(m) + 1)q
2 + Xd|n,d<n

n

d · πq(d; a, m).

qd

d · πq(d) ≤ Xd|n,d<n
1 − q−1 ≤ 2q

n
2 .

1

n
2

≤ q

By (7.5) and (7.6),

Hence we may write

where

n
2 .

qn

FGa,m(x) = a(x) · b(x),

(cid:12)(cid:12)(cid:12)(cid:12)ψGa,m(n) −
φ(m)(cid:12)(cid:12)(cid:12)(cid:12) ≤ (deg(m) + 3)q
n  ,
a(x) = expXn≥1fanxn
|fan| ≤ (deg(m) + 3)q
b(x) = (1 − qx)− 1

φ(m) .

2 ,

n

The conditions of Corollary 3.4 then hold with the following parameters:

α =

1
√q

, β =

1
q

, c1 =

1
φ(m) ≥ q− deg m, c2 = deg(m) + 3,

and so estimate (2.32) holds with an implied constant at most 48, whenever

n ≥ max{4(cid:18) 2(2c2 + 4)

ln(q)

+ 1(cid:19) ln(cid:18) 2(2c2 + 4)

ln(q)

+ 1(cid:19) + 1, 2

1 (cid:1)
ln(cid:0)c−1

ln q

+ 1}.

22

(7.1)

(7.2)

(7.3)

(7.4)

(7.5)

(7.6)

(7.7)

(7.8)

(7.9)

(7.10)

(7.11)

By plugging the parameters (7.10) in (7.11), and replacing ln(q) with the lower bound ln(2), the range (7.11)
may be replaced with the smaller range

n ≥ max{5(cid:18) 4 deg(m) + 20 + ln(2)

ln(2)

(cid:19) ln(cid:18) 4 deg(m) + 20 + ln(2)

ln(2)

(cid:19) + 1, 2 deg(m) + 1}.

(7.12)

Replacing 4 deg(m)+20+ln(2)

ln(2)

with the upper bound 6 deg(m) + 30, Theorem 2.6 follows.

8 Asymptotics

Here we prove Theorem 3.3, a theorem in analysis on which we relied in previous sections, and whose proof
implies Corollary 3.4. We break the proof into several auxiliary lemmas.

8.1 Basic Identities and Inequalities
Lemma 8.1. For any c1 /∈ Z and integers n ≥ i ≥ 0, the following identity holds:

Proof. Deﬁne the forward diﬀerence operator ∆(f )(x) := f (x + 1) − f (x), acting on C[x]. For f (x) =(cid:0)x
n(cid:1)
we have ∆(f )(x) =(cid:0) x

(−1)i(cid:0)−c1
n−i(cid:1)
k (cid:1)
iXk=0(cid:0) i
k(cid:1)(cid:0)k−c1
(cid:0)−c1
n (cid:1) =
(cid:0)n+c1−1
(cid:1) .
n−1(cid:1) (Pascal’s identity(cid:0)x+1
n (cid:1) −(cid:0)x
n(cid:1) =(cid:0) x
n−1(cid:1)) and so by induction we arrive at
∆(f )(i)(x) =(cid:18) x
n − i(cid:19).

(8.1)

k

On the other hand, we have in general

∆(f )(i)(x) =

iXk=0(cid:18)i

k(cid:19)(−1)i−kf (x + k).

Plugging x = −c1 in (8.2), (8.3) and comparing the results, we get

The proof concludes by observing

n (cid:19).
k(cid:19)(−1)i−k(cid:18)k − c1

iXk=0(cid:18) i
n − i(cid:19) =
(cid:18) −c1
Dividing both sides of (8.4) by (−1)i(cid:0)−c1
n (cid:1), we get
(−1)i(cid:0)−c1
n−i(cid:1)
k(cid:19)(−1)k(cid:0)k−c1
n (cid:1)
iXk=0(cid:18) i
(cid:0)−c1
(cid:0)−c1
n (cid:1) =
n (cid:1) .
n (cid:1) = (cid:0)k−c1
k (cid:1)
(−1)k(cid:0)k−c1
n (cid:1)
(cid:0)−c1
(cid:0)n+c1−1
(cid:1) .
(cid:1) ≤
k(cid:1)(cid:0)k−c1
k (cid:1)
n(cid:16)ln(n − m) + 2
(cid:0)n+c1−1

Lemma 8.2. The following bound holds for any m < i ≤ n and c1 ∈ (0, 1):

iXk=m+1(cid:0) i

(n+c1−1)m+1

k

k

(i)m+1

(i − m)

i < n

c1(cid:17) i = n

23

(8.2)

(8.3)

(8.4)

(8.5)

(8.6)

.

(8.7)

i ) ≤ 1, we can bound the LHS of (8.7) from above by

Proof. Since(cid:0)k−c1

k (cid:1) =Qk
iXk=m+1(cid:0) i

i=1(1 − c1
k(cid:1)(cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1) ≤

k

iXk=m+1

(i)k

(n + c1 − 1)k

(i)m+1

=

(i − m − 1)k−m−1

.

(n + c1 − m − 2)k−m−1
The case i < n follows by observing that each of the terms in the sum in (8.9) is ≤ 1.
For the case i = n, note that the RHS of (8.8) is equal to

(n + c1 − 1)m+1

iXk=m+1

The term k = n in (8.10) gives

from above by

(n
k)

(n+c1−1
)

k

= n
c1

n−1Xk=m+1 (cid:0)n
k(cid:1)
(cid:0)n−1
k (cid:1) =

n−1Xk=m+1

n
n − k

as needed.

Lemma 8.3. Let a(x) = exp(cid:16)Pn≥1 fanxn

We have the following for any i ≥ 0 and any 0 ≤ x < α:

. The sum of the rest of the terms is bounded

1

k

(cid:0)n
k(cid:1)
nXk=m+1
(cid:0)n+c1−1
(cid:1) .
n−1 ) ≤ n
i ≤ n (ln(n − m) + 1) ≤ n(cid:18)ln(n − m) +

(n+c1−1

c1

1

1

c1(cid:19) ,

= n

(8.11)

n−m−1Xi=1
n (cid:17) =P anxn be a power series satisfying (3.12) for some α, c2 > 0.
(cid:12)(cid:12)(cid:12)a(i)(x)(cid:12)(cid:12)(cid:12) ≤ α−i(c2 + i − 1)i(1 −
n  = exp(cid:16)−c2 log(1 −

)(cid:17) = (1 −

c2α−nxn

)−c2−i.

)−c2.

(8.12)

(8.13)

x
α

x
α

x
α

Proof. Property (3.12) allows us to bound |a(i)(x)| from above by |G(i)(x)| for 0 ≤ x < α, where

(8.8)

(8.9)

(8.10)

(8.14)

(8.15)

(8.16)

(8.17)

(8.18)

G(x) = expXn≥1

By repeated diﬀerentiation and using (−c2)i = (c2 + i − 1)i(−1)i, we ﬁnd
)−c2−i,

|G(i)(x)| = α−i(c2 + i − 1)i(1 −

x
α

as needed.

Lemma 8.4. Let t > 0. If n is a positive integer satisfying

then the inequality

holds.

n ≥ 1 + 5 (t + 1) ln (t + 1) ,

n − 1
ln(n) + 1 ≥ t

Proof. Let f (x) = x−1

ln(x)+1 . Note f is monotone increasing on [1,∞):

f′(x) =

ln(x) + 1
x
(ln(x) + 1)2 > 0.

Thus, to prove (8.16), it is enough to show that

f (1 + 5(t + 1) ln(t + 1)) ≥ t,

24

i.e.

Let

5(t + 1) ln(t + 1)

ln(1 + 5(t + 1) ln(t + 1)) + 1 ≥ t.

g(t) = (t + 1) ln(t + 1).

Note that g(t) − t is monotone increasing for t > 0, since

∀t > 0 : (g(t) − t)′ = ln(t + 1) > 0.

In particular,

(8.19)

(8.20)

(8.21)

(8.22)
and g(t) is monotone increasing for in [0,∞). We split the proof of (8.19) into two cases. If t ≤ 4, then by
(8.22) we get

∀t ≥ 0 : g(t) ≥ t

5(t + 1) ln(t + 1)

ln(1 + 5(t + 1) ln(t + 1)) + 1 ≥

5t

ln(1 + 5(4 + 1) ln(4 + 1)) + 1 ≥ t.

(8.23)

If t ≥ 4, then 5(t + 1) ln(t + 1) ≥ 1. In particular, using ln(t + 1) ≤ t < t + 1, we get the following when
t ≥ 4:

5(t + 1) ln(t + 1)

ln(1 + 5(t + 1) ln(t + 1)) + 1 ≥

5t ln(t + 1)

ln(10(t + 1) ln(t + 1)) + 1

5t ln(t + 1)

ln(10(t + 1)2) + 1

≥

= 5t(cid:18) 1

2 −

ln(10) + 1

4 ln(t + 1) + 2 ln(10) + 2(cid:19)

≥ 5t(cid:18) 1

2 −

ln(10) + 1

4 ln(4 + 1) + 2 ln(10) + 2(cid:19) ≥ t,

(8.24)

as needed.

8.2 Main Sum Inequality

Let β > 0 be a real number such that r = β

α satisﬁes (3.11). Let 0 ≤ m < n and deﬁne

Lemma 8.5. Let a(x) = exp(cid:16)Pn≥1 fanxn
n (cid:17) =P anxn be a power series satisfying (3.12) for some α, c2 > 0.
nXi=m+1
(cid:19)rn(cid:18)n ln(n) +

βi  iXk=m+1(cid:0) i
(cid:1)! a(i)(0)
k (cid:1)
k(cid:1)(cid:0)k−c1
(cid:0)n+c1−1
c1(cid:19) +(cid:16) r
n(cid:17)m+1

|S1| ≪m(cid:18)n + c2 − 1

(c2 + m)m+1(1 − r)−c2 (1 + c2r).

(8.25)

(8.26)

S1 =

Then

2n

i!

n

k

.

For m = 0, the implicit constant in (8.26) is (at most) 24.

Proof. We split S1 = S′ + S′′ into two parts, according to i = n and i < n:

S′′ =

,

k

n!

S′ = βn  nXk=m+1(cid:0)n

(cid:1)! a(n)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)! a(i)(0)
βi  iXk=m+1(cid:0) i
k(cid:1)(cid:0)k−c1
k (cid:1)
n−1Xi=m+1
(cid:0)n+c1−1
c1(cid:19) α−n(c2 + n − 1)n
=(cid:18)n + c2 − 1

2n

n!

i!

n

k

.

25

By Lemma 8.2 and Lemma 8.3, we get

|S′| ≤ βn(cid:18)n ln(n) +

(8.27)

(8.28)

(8.29)

2n

c1(cid:19) .

(cid:19)rn(cid:18)n ln(n) +

If m = n − 1, we have S′′ = 0. Otherwise, Lemma 8.2 and Lemma 8.3 give

|S′′| ≤

=

1

(n + c1 − 1)m+1

1

(n + c1 − 1)m+1

n−1Xi=m+1
n−1Xi=m+1

βi(i)m+1(i − m)α−i(cid:18)c2 + i − 1
ri(i)m+1(i − m)(cid:18)c2 + i − 1
(cid:19).

i

i

(cid:19)

We bound the sum in (8.30) from above by the inﬁnite series

We can compute (8.31). We diﬀerentiate the identity

ri(i)m+1(i − m)(cid:18)c2 + i − 1

i

(cid:19).

∞Xi=m+1
(−x)i(cid:18)c2 + i − 1

Xi≥0

i

(cid:19) = (1 + x)−c2

m + 1 times, multiply by xm+1 and obtain

(−x)i(i)m+1(cid:18)c2 + i − 1

i

(cid:19) = (−c2)m+1xm+1(1 + x)−c2−m−1.

Xi≥m+1

We apply the linear operator f 7→ x · f′ − m · f to both sides of (8.33):

(−x)i(i)m+1(i − m)(cid:18)c2 + i − 1

i

(cid:19) = (−c2)m+1xm+1(1 + x)−c2−m−1(1 − (c2 + m + 1)

Xi≥m+1

(8.30)

(8.31)

(8.32)

(8.33)

x

1 + x

).

(8.34)

We plug x = −r in (8.34) and ﬁnd the following formula for (8.31):
r

(−c2)m+1(−r)m+1(1 − r)−c2−m−1(cid:18)1 +

1 − r

(c2 + m + 1)(cid:19) .

Dividing (8.35) by the denominator appearing in (8.30), we get the following upper bound on |S′′|:

|S′′| ≤

(c2 + m)m+1

(n + c1 − 1)m+1(cid:18) r

1 − r(cid:19)m+1

(1 − r)−c2(cid:18)1 +

(c2 + m + 1)(cid:19) .

r

1 − r

Using (3.11) and the estimate (n + c1 − 1)m+1 = Ωm(nm+1), we may simplify (8.36) as

(8.35)

(8.36)

(8.37)

|S′′| ≪m(cid:16) r

n(cid:17)m+1

(c2 + m)m+1(1 − r)−c2 (1 + c2r).

By combining inequalities (8.29) and (8.37), we establish (8.26).

Now we assume that m = 0. If n = 1, we have S′′ = 0. Otherwise, plugging m = 0 in (8.36), we get

|S′′| ≤

c2r
n

(1 − r)−c2

n

n + c1 − 1

1 + c2r

(1 − r)2 .

Since

n

n+c1−1 ≤ 2 and (3.11) implies that 1+c2r

(1−r)2 ≤ 1+c2r
(1− 1√2

)2 ≤ 12(1 + c2r), (8.38) implies that

By (8.29) and (8.39), we ﬁnd that the implicit constant in (8.26) is at most 24, as needed.

|S′′| ≤ 24

c2r
n

(1 − r)−c2 (1 + c2r).

26

(8.38)

(8.39)

8.3

Integral Bound

0

k

βk

Then

S2 =

a(n+1)(x)dx.

(β − x)n−k
(n − k)!

Let β > 0 be a real number such that r = β

α satisﬁes (3.11). Let 0 ≤ m < n. Deﬁne

Lemma 8.6. Let a(x) = exp(cid:16)Pn≥1 fanxn
n (cid:17) =P anxn be a power series satisfying (3.12) for some α, c2 > 0.
mXk=0 (cid:0)k−c1
k (cid:1)
k! Z β
(cid:0)n+c1−1
(cid:1)
|S2| ≪m(cid:18)n + c2 − 1
k (cid:1) by the upper bound 1 and(cid:0)n+c1−1
mXk=0

(cid:1) by the lower bound(cid:0)n−1
k (cid:1):
(cid:12)(cid:12)(cid:12)a(n+1)(x)(cid:12)(cid:12)(cid:12) dx.

Proof. In (8.40), we replace(cid:0)k−c1

We use Lemma 8.3 to replace the function a(n+1)(x) appearing in the integrand of (8.42) with (c2 +n)n+1(1−
x
α )−c2−n−1α−n−1:

(cid:19)rn(1 + c2r)(1 − r)−c2 .

For m = 0, the implicit constant in (8.41) is (at most) 12.

(1 − x
β )n−k
(n − k)!

k! Z β

(cid:0)n−1
k (cid:1)

|S2| ≤

(8.40)

(8.42)

(8.41)

βn

n

1

k

0

We simplify the expression outside the integral:

(8.43)

(8.44)

(8.46)

(8.47)

|S2| ≤

0

1

=

βn

(c2 + n)n+1

mXk=0
mXk=0

k! Z β
(cid:0)n−1
k (cid:1)
(cid:0)n−1
k (cid:1)k!(n − k)!
(cid:0)n−1
k (cid:1)k!(n − k)!

(c2 + n)n+1

(c2 + n)n+1α−n−1(1 −

x
α

)−c2−n−1dx

(1 −

x
β

)n−k(1 −

x
α

)−c2−n−1dx.

n + 1(cid:19)(n + 1)n · rn+1 ·

β−1
n − k

(cid:19)n ((n + c2)r) · rn ·
(cid:19)(1 + c2r)n2 · rn ·

β−1
n − k
β−1
.
n − k

0

(1 − x
β )n−k
(n − k)!
βnα−n−1Z β
βnα−n−1 =(cid:18)c2 + n
=(cid:18)n + c2 − 1
≤(cid:18)n + c2 − 1
mXk=0Z β
(cid:19)(1 + c2r)n2 · rn
mXk=0Z 1

n

n

1

0

0

Plugging (8.44) back in (8.43), we see

|S2| ≤(cid:18)n + c2 − 1

n

(cid:19)(1 + c2r)n2 · rn

(1 −

x
β

)n−k(1 −

x
α

)−c2−n−1 dx
β

.

(8.45)

n − k

We perform the change of variables s := x

|S2| ≤(cid:18)n + c2 − 1

n

β in the RHS of (8.45), and get
(1 − s)n−k

(1 − rs)−c2−n−1ds.

n − k

We rewrite the integrand (1−s)n−k

n−k

(1 − rs)−c2−n−1 as

1

n − k(cid:18) 1 − s

1 − rs(cid:19)n−k

(1 − rs)−c2−k−1.

We apply two basic inequalities to (8.47), which hold for s ∈ [0, 1]: 0 ≤ 1−s
(1 − r)−1. This allows us to bound the RHS of (8.46) from above by
(1 − r)−c2−k−1Z 1

(cid:19)(1 + c2r)n2 · rn

(cid:18)n + c2 − 1

n − k

n

1

0

mXk=0

27

1−rs ≤ 1 + s(r − 1) and (1− rs)−1 ≤

(1 + s(r − 1))n−kds.

(8.48)

The integral in (8.48) can be evaluated precisely as 1−rn−k+1
Thus we get

1−r

1

n−k+1 , which we bound from above by

1

(1−r)(n−k+1) .

|S2| ≤(cid:18)n + c2 − 1

n

(cid:19)(1 + c2r)n2 · rn

mXk=0

(n − k)(n − k + 1)
Since k ≤ m, we may replace (1 − r)−c2−k−2 in (8.49) by (1 − r)−c2−m−2:

1

(1 − r)−c2−k−2.

(8.49)

|S2| ≤(cid:18)n + c2 − 1

n

(cid:19)(1 + c2r)n2 · rn(1 − r)−c2−m−2

mXk=0

1

(n − k)(n − k + 1)

.

(8.50)

1

1

=

=

mXk=0(cid:18) 1
n − k −
n − m −
(cid:19)(1 + c2r)

n(1 + m)
n − m

n + 1

1

n − k + 1(cid:19)

1 + m

=

(n − m)(n + 1)

.

rn(1 − r)−c2−m−2.

The sum in (8.50) telescopes as follows:

1

(n − k)(n − k + 1)

mXk=0

Thus, (8.50) becomes

|S2| ≤(cid:18)n + c2 − 1
n−m ≤ (1 + m)2 ≪m 1 and r ≤ 1√2

n

Since n(1+m)

|S2| ≪m(cid:18)n + c2 − 1
where the implied constant is (1 + m)2(1 − 1√2
constant is < 12.

n

by (3.11), the bound (8.52) may be simpliﬁed as

(cid:19)rn(1 + c2r)(1 − r)−c2 ,

)−m−2. This establishes (8.41). For m = 0, the implied

(8.51)

(8.52)

(8.53)

(8.54)

i!

1

1

n

1

fn =

a(i)(0)

a(i)(0)

aibn−i =

8.4 Proof of Theorem 3.3
Proof. Recall bn = [xn](1 − x

β(cid:17)n(cid:0)−c1
β )−c1 =(cid:16)− 1
n (cid:1) = β−n(cid:0)n+c1−1
(cid:1). We have
n − i(cid:19)
β(cid:19)n−i(cid:18) −c1
·(cid:18)−
nXi=0
nXi=0
β(cid:19)−i(cid:0)−c1
n−i(cid:1)
n (cid:19) nXi=0(cid:18)−
=(cid:18)−
β(cid:19)n(cid:18)−c1
(cid:0)−c1
n (cid:1)
i! ! .
= bn ·  nXi=0
n−i(cid:1)
βi(−1)i(cid:0)−c1
(cid:0)−c1
n (cid:1)
in (8.54) with Pi
By Lemma 8.1, we may replace (−1)i (−c1
n−i)
(−c1
n )
(cid:1)! a(i)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)! a(i)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1

βi  iXk=0(cid:0) i
βi  mXk=0(cid:0) i

βi  iXk=m+1(cid:0) i

nXi=0
nXi=0

nXi=m+1

small and large k:

k)(k−c1
( i
k )
(n+c1−1
)

fn = bn ·

= bn ·

+ bn ·

a(i)(0)

k=0

i!

k

k

i!

i!

k

28

and split the sum according to

(8.55)

.

(cid:1)! a(i)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1

i!

k

We denote the ﬁrst sum by S0 and the second sum by S1:

We rearrange the terms of S0 as follows:

k

.

i!

k

,

i!

S1 =

S0 =

S0 =

βi  mXk=0(cid:0) i
(cid:1)! a(i)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
nXi=0
(cid:0)n+c1−1
βi  iXk=m+1(cid:0) i
(cid:1)! a(i)(0)
k(cid:1)(cid:0)k−c1
k (cid:1)
nXi=m+1
(cid:0)n+c1−1
mXk=0 (cid:0)k−c1
k (cid:1)
nXi=k(cid:18) i
k(cid:19) a(i)(0)
(cid:0)n+c1−1
(cid:1)
mXk=0 (cid:0)k−c1
k (cid:1)
n−kXj=0
(cid:0)n+c1−1
(cid:1)
mXk=0 (cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)
mXk=0 (cid:0)k−c1
k (cid:1)
(cid:0)n+c1−1
(cid:1)
(β−x)n−k
(n−k)! a(n+1)(x)dx, and obtain

(β − x)n−k
(n − k)!

k! Z β

a(j+k)(0)

a(k)(β),

βk
k!

βk
k!

S2 =

M =

i!

j!

k

k

k

k

βk

0

βi

βj .

=

Let

(8.56)

(8.57)

(8.58)

a(j+k)(0)

j!

βj in (8.57) with

(8.59)

(8.60)

a(n+1)(x)dx.

By the integral formula for the remainder in a Taylor series, we may replacePn−k
a(k)(β) −R β

j=0

0

S0 = M − S2.

Summarizing (8.55) and (8.59), we see

fn = bn · (M + S1 − S2).

Note that bn · M is the main term of (3.13). The expression E, as deﬁned in (3.13), equals S1 − S2. The
sums S1, S2 are bounded in Lemmas 8.5 and 8.6, respectively, and these bounds give

|E| ≪m(cid:16) r

n(cid:17)m+1
+(cid:18)n + c2 − 1

n

(1 − r)−c2 (1 + c2r)(c2 + m)m+1
(cid:19)rn(cid:18)n ln(n) +

+ (1 − r)−c2 (1 + c2r)(cid:19) .

2n
c1

We simplify (8.61) using the following two inequalities:

and, since − ln(1 − r) ≤ 2r for 0 ≤ r ≤ 1√2

1 + c2r ≤ exp(c2r),
by simple calculus, we have

Plugging (8.62) and (8.63) into (8.61), we get

(1 − r)−c2 = exp(−c2 ln(1 − r)) ≤ exp(2c2r).

|E| ≪m(cid:16) r

n(cid:17)m+1
+(cid:18)n + c2 − 1

n

exp(3c2r)(c2 + m)m+1

(cid:19)rn(cid:18)n ln(n) +

2n
c1

+ exp(3c2r)(cid:19) .

29

(8.61)

(8.62)

(8.63)

(8.64)

We note that

Plugging (8.65) in(8.64), we get

n ln(n) +

2n
c1

+ exp(3c2r) ≤ exp(3c2r)

4n2
c1

.

|E| ≪m exp(3c2r)(cid:18)(cid:16) r

n(cid:17)m+1

(c2 + m)m+1 +(cid:18)n + c2 − 1

n

(cid:19) 4n2

c1

rn(cid:19) ,

(8.65)

(8.66)

as needed. For m = 0, the implied coeﬃcient is the maximum of the two implied constants of Lemmas 8.5
and 8.6, i.e. 24.

8.5 Proof of Corollary 3.4

We apply Theorem 3.3 with m = 0, and get

|E| ≪ exp(3c2r)(cid:18) c2r

n

+(cid:18)n + c2 − 1

n

(cid:19) 4n2

c1

rn(cid:19) ,

(8.67)

where the implied constant is 24. We ﬁnd a range of n where ﬁrst error term of (8.67) dominates the error,
i.e. we want to solve

c2r

n ≥(cid:18)n + c2 − 1

n

(cid:19) 4n2

c1

rn.

(8.68)

For n’s in this range, (3.17) holds with an implied constant (at most) 24 + 24 = 48. We ﬁnd a range of n for
which (8.68) holds by making several simpliﬁcations. Note that

(cid:18)n + c2 − 1

n

(cid:19)n2 =(cid:18)n + c2 − 1
n − 1 (cid:19)c2n =
≤ exp c2
n−1Xi=1

1

= (ne)c2+1 c2
e

,

n−1Yi=1(cid:16)1 +

c2

i (cid:17) c2n

i! c2n ≤ exp (c2 (ln(n) + 1)) c2n

so we may replace (8.68) by the following stricter inequality:

(8.69)

(8.70)

(8.71)

(8.72)

(8.73)

or, equivalently,

Inequality (8.71) holds when the following two inequalities hold simultaneously:

rn,

r

c1

4
e

≥ (ne)c2+2 1

n ≥ (ne)c2+1 1
r(cid:19)n−1
(cid:18) 1
r(cid:19)(n−1)/2
≥ (ne)c2+2 , (cid:18) 1
(cid:18) 1
ln(n)+1 ≥ 2c2+4
n−1

ln( 1

c1

4
e2 .

r(cid:19)(n−1)/2

1
c1

.

≥

The ﬁrst inequality of (8.72) holds whenever

r ) , which, by Lemma 8.4, is satisﬁed when

n ≥ 1 + 5(cid:18) 2c2 + 4

ln( 1
r )

+ 1(cid:19) ln(cid:18) 2c2 + 4

ln( 1
r )

+ 1(cid:19) .

The second inequality of (8.72) holds whenever n ≥ 2 ln(c−1

ln( 1

1 )
r ) + 1. This establishes Corollary 3.4.

30

References

[1] Michael Rosen, Number theory in function ﬁelds. Graduate Texts in Mathematics, vol. 210, Springer-

Verlag, New York, 2002.

[2] Philippe Flajolet, Robert Sedgewick, Analytic Combinatorics. Cambridge University Press, 2009.

[3] Peter Henrici, Applied and computational complex analysis, Volume 2: Special functions - integral trans-

forms - asymptotics - continued fractions. Wiley, 1977.

[4] Donald Knuth and Herbert S. Wilf, A short proof of Darboux’s lemma. Appl. Math. Lett. vol. 2 2:139-140,
1989. Peter Henrici, Applied and computational complex analysis, Volume 2: Special functions - integral
transforms - asymptotics - continued fractions. Wiley, 1977.

[5] Richard Warlimont, Arithmetical Semigroups V: Multiplicative Functions. Manuscripta Math. vol. 77,

4:361-383, 1992.

[6] E. Manstaviˇcius and R. Skrabut˙enas, Summation of values of multiplicative functions on semigroups.

Lithuanian Mathematical Journal, vol. 33, 3:255-264, 1993.

[7] J. Knopfmacher, Abstract Analytic Number Theory. Dover, 1990.

[8] J. Knopfmacher and W-B. Zhang, Number Theory Arising from Finite Fields. Analytic and Probabilistic

Theory. Pure and Appl. Math., vol. 241 , Marcel Dekker, New York, 2001.

[9] Edmund Landau, ¨Uber die Einteilung der positiven ganzen Zahlen in vier Klassen nach der Mindeszahl
der zu ihrer additiven Zusammensetzung erforderlichen Quadrate. Arch. Math. Phys., 13:305-312, 1908.

[10] Lior Bary-Soroker, Yotam Smilansky, Adva Wolf, On the Function Field Analogue of Landau’s Theorem

on Sums of Squares. Finite Fields Appl. vol. 39, 195-215, 2016.

[11] Frank Thorne, Irregularities in the distributions of primes in function ﬁelds. J. Number Theory vol.

128, 6:1784-1794, 2008.

[12] D. K. L. Shiu, Strings of congruent primes. J. London Math. Soc. vol. 61, 2:359-373, 2000.

[13] Atle Selberg, Collected Papers II. Springer Collected Works in Mathematics, 1991.

[14] Chih-Yun Chuang, Yen-Liang Kuan, Jing Yu, On Counting Polynomials over Finite Fields. Proc. Amer.

Math. Soc. vol. 143, 10:4305-4316, 2015.

[15] E. Artin, Quadratische K¨orper im Gebiete der h¨oheren Kongruenzen I, II. Math. Zeit. 19, 153-246, 1924.

[16] Sunghan Bae and Hwanyup Jung, On the 4-rank of ideal class groups of quadratic function ﬁelds. Acta

Arith. vol. 151, 4:325-360, 2012.

[17] Peter Stevenhagen, The number of real quadratic ﬁelds having units of negative norm. Experiment.

Math. vol. 2, 2:121-136, 1993.

[18] ´Etienne Fouvry, J¨urgen Kl¨uners, On the negative Pell equation. Ann. of Math.(2) vol. 172 , 3:2035-2104,

2010.

[19] Daqing Wan, Generators and irreducible polynomials over ﬁnite ﬁelds. Math. Comp. vol. 66, 219:1195-

1212, 1997.

[20] W. Leahey, Sums of squares of polynomials with coeﬃcients in a ﬁnite ﬁeld. Amer. Math. Monthly vol.

74, 7:816-819, 1967.

[21] G. J. O. Jameson, Inequalities for Gamma Function Ratios. Amer. Math. Monthly vol. 120, 10:936-940,

2013.

31

[22] D. Shanks, The Second-Order Term in the Asymptotic Expansion of B(x). Math. Comp. vol. 18, 75-86,

1964.

[23] P. Flajolet and I. Vardi, Zeta Function expansions of Classical Constants. Manuscript,

http://algo.inria.fr/ﬂajolet/Publications/landau.ps, 1996.

Raymond and Beverly Sackler School of Mathematical Sciences, Tel Aviv University, P. O. Box 39040,

Tel Aviv 6997801, Israel. E-mail address: oﬁr.goro@gmail.com

32

