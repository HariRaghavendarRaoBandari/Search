6
1
0
2

 
r
a

M
4

 

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
6
8
3
1
0

.

3
0
6
1
:
v
i
X
r
a

Short time full asymptotic expansion of hypoelliptic heat

kernel at the cut locus

Yuzuru Inahama and Setsuo Taniguchi

Abstract

In this paper we prove a short time asymptotic expansion of a hypoelliptic heat kernel
on an Euclidean space and a compact manifold. We study the ”cut locus” case, namely,
the case where energy-minimizing paths which join the two points under consideration
form not a ﬁnite set, but a compact manifold. Under mild assumptions we obtain an
asymptotic expansion of the heat kernel up to any order. Our approach is probabilistic
and the heat kernel is regarded as the density of the law of a hypoelliptic diﬀusion process,
which is realized as a unique solution of the corresponding stochastic diﬀerential equation.
Our main tools are S. Watanabe’s distributional Malliavin calculus and T. Lyons’ rough
path theory.

Mathematics Subject Classiﬁcation: 60H07, 58J65, 35K08, 41A60.
Keywords: Malliavin calculus, rough path theory, heat kernel, diﬀusion process, asymp-
totic expansion.

1

Introduction

Short time asymptotics of heat kernels is a huge topic in analysis, probability and geometry
and have been studied intensively and extensively. In this paper we focus on the short time oﬀ-
diagonal asymptotic expansion of heat kernels. We do not discuss the on-diagonal asymptotics,
the estimates or the logarithmic asymptotics of heat kernels. Even if we restrict our attention to
the oﬀ-diagonal expansion, so many papers have been published and our references are probably
far from complete.

Known proofs of oﬀ-diagonal asymptotics are either analytic or probabilistic and our proof
is the latter. The ﬁrst probabilistic proof was given by Molchanov [33] in the case of the
standard heat kernel on a Riemannian manifold, in which a pinned diﬀusion process is used.
Bismut [7] was ﬁrst to use Malliavin calculus, then followed by many others. The Feynman-Kac
representation is the key in these probabilistic approaches.

On a Riemannian manifold N , if x and x′ are outside the cut locus, the following asymptotic

expansion of the standard heat kernel is well-known:

pt(x, x′) ∼ e−d(x,x′)2/2tt−n/2(c0 + c1t + c2t2 + · · · )

as t ց 0.

(1.1)

1

Here, n = dimN and d(x, x′) is the Riemannian distance between x, x′ ∈ N . Ben Arous [6]
proved that the heat kernel of a hypoelliptic diﬀusion process of a wide class on an Euclidean
space admits essentially the same expansion as above if x and x′ are outside the cut locus. In
this case, however, the distance should be replaced by the sub-Riemannian distance.

When the two points are not near, this asymptotics becomes quite diﬃcult. Molchanov [33]
already mentioned that there is an example of a Riemannian manifold N and x, x′ ∈ N in the
cut locus such that the factor t−n/2 in (1.1) must be replaced by t−(n+n′)/2 with some n′ 6= 0.
Therefore, the oﬀ-diagonal asymptotics in the cut locus case is qualitatively diﬀerent and much
less understood than the case of ”near points.” (Note that we use the term ”cut locus” in a
loose sense in this section. What we precisely mean by the term will be given in Assumption
(B2) in the next section.)

The present paper aims to study the short time oﬀ-diagonal asymptotic expansion for hy-
poelliptic heat kernels in the cut locus case in a satisfactory general way. Our main result has
the following three features. To our knowledge, there are no results which satisfy all of these
conditions simultaneously:

1. The manifold and the hypoelliptic diﬀusion process on it are rather general.

In other

words, this is not a study of special examples.

2. The ”cut locus” case is studied. More precisely, we mean by this that the set of energy-
minimizing paths (or controls) which connect the two points under consideration becomes
a compact manifold of ﬁnite dimension.

3. The asymptotic expansion is full, that is, the polynomial part of the asymptotics is up to

any order.

A recent result by Barilari, Boscain and Neel [3] satisfy (a) and (b), but obtain only the
leading term of the asymptotic expansion. Chang and Li [11] proved a result which satisfy (b)
and (c) for special examples. There are many papers which obtained the leading term in the
”cut locus” case for special examples (see [4, 5, 9, 15, 37, 43, 44] among others). Note that the
results in [6] is formulated on a Euclidean space, but can be modiﬁed to the manifold case (if
the manifold is not too wild). Hence, it satisﬁes (a) and (c).

On an Euclidean space, however, there are two famous results which satisfy (b), (c) and
the latter half of (a). Both of them are probabilistic and use generalized versions of Malliavin
calculus. One is Takanobu and Watanabe [41]. They use Watanabe’s distributional Malliavin
calculus developed in [45, 46]. The other is Kusuoka and Stroock [29]. They use their version
of generalized Malliavin calculus developed in [28]. In this paper we use the former.

Though we basically follow Takanobu-Watanabe’s argument, a main diﬀerence is that we
use T. Lyons’ rough path theory together, which is something like a deterministic version of
the SDE theory. The main advantage of using rough path theory is that while the usual Itˆo
map i.e., the solution map of an SDE is discontinuous, the Lyons-Itˆo map i.e., the solution map
of a rough diﬀerential equation (RDE) is continuous.

This fact enables us to do ”local analysis” of the Lyons-Itˆo map (for instance, restricting
the map on a neighborhood of its critical point and doing Taylor-like expansion) in a somewhat

2

similar way we do in the Fr´echet calculus. Recall that in the standard SDE theory, this type
of local operation is often very hard and sometimes impossible, due to the discontinuity of the
Itˆo map. For this reason, the localization procedure in [41] looks so complicated that it might
be diﬃcult to generalize their method if rough path theory did not exist.

In this paper we ﬁrst reprove and generalize the main result in [41] in the Euclidean setting
by using rough path theory. Malliavin calculus for Brownian rough path was already studied
in [22, 24] in the proof of large deviation principle (LDP for short) for conditional measures. It
turned out that these two theories ﬁt very well.

The strategy of our proof is as follows: First, the LDP above implies that contributions
from the complement of the set of energy-minimizers (action-minimizers) are negligibly small.
In other words, only a neighborhood of the set of energy-minimizers matters. Next, around each
energy-minimizer in the Cameron-Martin space, we take a small neighborhood with respect to
the rough path topology with certain nice properties. Since the set of energy-minimizers is
compact, we need to compute contributions from ﬁnitely many of them only. Then, on each of
such small neighborhoods, we do local analysis. To prove the asymptotic expansion up to any
order, we use a modiﬁed version of Watanabe’s asymptotic theory given in [41], which can be
regarded as a ”localized” version of his asymptotic theory developed in [46, 19].

Even in this Euclidean setting, many parts of the proof are technically improved, thanks
to rough path theory. We believe that the following are worth mentioning: (i) Large deviation
upper bound (Theorem 3.8 and Lemma 7.1). (ii) Asymptotic partition of unity (Section 6).
(iii) A Taylor-like expansion of the Lyons-Itˆo map (Subsection 3.3) and the uniform exponential
integrability lemma for the ordinary and the remainder terms of the expansion (Lemmas 5.2
and 5.3).

Then, we study the manifold case. Recall that Malliavin calculus for a manifold-valued
SDE was studied by Taniguchi [42]. Thanks to rough path theory and the localized version
of Watanabe’s asymptotic theory, it is enough to localized in a small neighborhood of energy-
minimizers in the geometric rough path space. Restricted on such a small neighborhood, the
(Lyons-)Itˆo map corresponding to the given SDE on the manifold can easily be transferred to
one on a linear space. For these reasons, without much technical eﬀort the problem reduces
to the one on an Euclidean space. As a result, the proof of the asymptotic expansion in the
manifold setting is not so diﬀerent from the one in the Euclidean setting.

Of course, there is a possibility that our main result can be proved without rough path
theory, but we believe that the theory is quite suitable for this problem and gives us a very
clear view (in particular, in the manifold case).

The structure of the paper is as follows: In Section 2, we provide setting, assumptions and
our main results. First, we discuss the Euclidean case. Our assumptions are weaker that those
in [41] and hence our main result (Theorem 2.2) in the Euclidean case generalizes the main
result in [41]. Next, we formulate a parallel problem on a compact manifold. As mentioned
before, our main result (Theorem 2.5) in the manifold case satisﬁes all of (a), (b) and (c) above.
In the end of the section, a few examples are given.

Sections 3–7 are devoted to proving our main theorem in the Euclidean setting (Theorem

3

2.2).
In Section 3, we gather various facts from relevant research areas such as Malliavin
calculus, rough path theory and diﬀerential geometry. All of them are already known basically,
but some of them are not elementary. They will be used in the proof of the asymptotic
expansion.

In Section 4, we calculate the skeleton ODE driven by a energy-minimizing Cameron-Martin
path and show that the solution satisﬁes a naturally deﬁned Hamiltonian ODE. We look at
this well-known argument from a viewpoint of rough path theory.
In Section 5, we prove
the uniform exponential integrability of Wiener functionals which appear in the proof of the
asymptotic expansion. Since we use rough path theory, the Taylor-like expansion of the Lyons-
Itˆo map is deterministic and the remainder terms satisfy a simple and reasonable estimate.
This simpliﬁes our proof.

In Section 6, we study an asymptotic partition of unity which was ﬁrst introduced in [41].
Though it plays a important role in the proof of the asymptotics in [41], it is of very complicated
form. We construct a rough path version of it, which is written in terms of Besov norms of
Brownian rough path and looks simple and natural.

Section 7 is the main part of our proof of Theorem 2.2. Our main tool is a modiﬁed version
of Watanabe’s asymptotic theorem. In Section 8, we prove our main result in the manifold case
(Theorem 2.5).

2 Setting, assumptions and main results

2.1 Setting: The Euclidean case
Let W = C0([0, 1], Rr) be the set of the continuous functions from [0, 1] to Rr which start at
0. This is equipped with the usual sup-norm. The Wiener measure on W is denoted by µ. We
denote by

H = {h ∈ W | absolutely continuous and khk2

s|2ds < ∞}

H :=Z 1
0 |h′

the Cameron-Martin subspace of W.
In some (non-probabilistic) literatures, the derivative
of Cameron-Martin paths are called controls. The triple (W,H, µ) is called the classical
Wiener space. The canonical realization on W of r-dimensional Brownian motion is denoted
by (wt)0≤t≤1 = (w1
Let Vi : Rd → Rd be a vector ﬁeld with suﬃcient regularity (0 ≤ i ≤ r). Precise conditions
on Vi will be speciﬁed later. For a small parameter ε ∈ (0, 1], we consider the following SDE of
Stratonovich type:

t , . . . , wr

t )0≤t≤1.

rXi=1

dX ε

t = ε

Vi(X ε

t ) ◦ dwi

t + ε2V0(X ε

t )dt

with X ε

0 = x ∈ Rd.

(2.1)

When necessary, we will write X ε
When ε = 1, we simply write Xt = X 1
of the processes (X ε

t )t≥0 and (Xε2t)t≥0 are the same.

t = X ε(t, x, w) or X ε(t, x) and sometimes write λε

t = ε2t.
t . By the scaling property of Brownian motion, the laws

4

Now we introduce the skeleton ODE which corresponds to SDE (2.1). For a Cameron-Martin

path h ∈ H, we consider the following controlled ODE:

dφt =

rXi=1

Vi(φt)dhi
t

with

φ0 = x ∈ Rd.

(2.2)

The solution will often be denoted by φt(h), φ(t, x, h), etc. Note the absence of the drift term
in (2.2).

Let V be an n-dimensional linear subspace of Rd (1 ≤ n ≤ d) and ΠV : Rd → V be the
orthogonal projection. (For our purpose, we may and sometimes will assume without loss of
generality that V = Rn × {0d−n}, where 0d−n is the zero vector of Rd−n.) Set Y ε
t = ΠV(X ε
t )
and ψt = ΠV(φt), which will often be denoted by Y ε(t, x, w), and ψ(t, x, h), respectively.

For a ∈ V, deﬁne Ka = {h ∈ H | ψ(1, x, h) = a}. We set da := min{khkH | h ∈ Ka} and
Kmin
a = {h ∈ Ka | khkH = da}. It is known that if Ka 6= ∅, then inf{khkH | h ∈ Ka} actually
attains a minimum and Kmin
6= ∅. (We can see this from the goodness of the rate function in
a Schilder-type large deviation principle on the rough path space.) We will basically assume
x /∈ Π−1

V (a) and Ka 6= ∅, which imply 0 < da < ∞.

a

f

2.2 Assumptions: The Euclidean case

In this subsection we introduce assumptions. First, we impose two conditions on the coeﬃcient
vector ﬁelds. The ﬁrst one is on regularity of Vi.

b . (C k

(A1): Vi : Rd → Rd is of C ∞ with bounded derivatives of all order ≥ 1 (0 ≤ i ≤ r).
Note that Vi itself may have linear growth. When Vi is also bounded, Vi is said to be of
C ∞
b is similarly deﬁned for k = 1, 2, . . .). This assumption is very standard in Malliavin
calculus and most of the results in Malliavin calculus for SDEs are proved under this assump-
tion. Under (A1), a global solution X ε of (2.1) uniquely exists and X ε
t is smooth in the sense
of Malliavin calculus for any (t, ε) ∈ [0, 1]2 and their Sobolev norm of any index is bounded in
(t, ε) ∈ [0, 1]2. Similarly, (A1) is a standard assumption for the skeleton ODE (2.2). A unique
global solution φ for any h ∈ H exists and, moreover, φ(· , h, x) is Fr´echet smooth in h ∈ H for
any x under (A1).
Next we introduce a kind of H¨ormander’s bracket generating condition not on the ”upper”
1 ] and σ[ψ1] the (deterministic)
1 and ψ1, respectively. (Precise deﬁnitions will be given in

space Rd, but on the ”lower” space V. We denote by σ[Y ε
Malliavin covariance matrix of Y ε
Section 3.)

Set

Σ1 = {Vi | 1 ≤ i ≤ r}

and

Σk = {[Vi, W ] | 0 ≤ i ≤ r, W ∈ Σk−1}

for k ≥ 2 recursively. Note that the drift vector ﬁeld is not involved in the deﬁnition of Σ1.

5

(A2): At the starting point x ∈ Rd, ∪∞
linear algebra.

k=1{ΠVW (x) | W ∈ Σk} spans V in the sense of

Here, the bracket generating condition is assumed only at the stating point. This condition
implies that Y ε
t = Y ε(t, x, w) is non-degenerate in the sense of Malliavin calculus for any t > 0
and ε ∈ (0, 1]. Moreover, there exist positive constants ν and Cp (1 < p < ∞) such that

k det σ[Y ε

1 ]−1kLp ≤ Cpε−ν

(1 < p < ∞, 0 < ε ≤ 1).

(2.3)

(See Section 2 in Kusuoka and Stroock [27]). Note that ν is independent of p. Non-degeneracy
implies that, if ε > 0 and t > 0, δa(Y ε
t ) is well-deﬁned as a positive Watanabe distribution
(i.e., generalized Wiener functional), where δa stands for the delta function at a ∈ V, and its
generalized expectation E[δa(Y ε
t with respect
to the Lesbegue measure da on V for every a.

t )] equals the smooth density of the of the law of Y ε

From here we introduce assumptions on the subset Kmin

of energy minimizers (a 6= ΠVx).
(B1): Assume that Ka 6= ∅ and the deterministic Malliavin covariance matrix σ[ψ1](h) is
non-degenerate for any h ∈ Kmin
Note that non-degeneracy of σ[ψ1](h) is equivalent to surjectivity of the tangent map Dψ1(h) :
H → V at h. If we use terminology of sub-Riemannian geometry, This condition loosely means
that any element of Kmin
is a normal geodesics. (Keep in mind that we are not in the framework
of sub-Riemannian geometry, however.)
Unlike in the elliptic case, Ka or Kmin

a may not in general have a manifold structure under

hypoellipticity. Hence, we assume the following condition:

.

a

a

a

a

a

is a smooth, compact, connected manifold of ﬁnite dimension n′ regularly em-

(B2): Kmin
bedded in H.
In the above condition the case n′ = 0 is allowed, which means that Kmin
is a single-point
set. Note that compactness of Kmin
is essential and will be used throughout this paper. (On
the other hand, connectivity is assumed only for simplicity.) It will turn out in Remark 4.5 that
(A1) and (B1) imply compactness of Kmin
a with respect to H-topology. From this viewpoint,
the compactness assumption in (B2) seems natural.
Finally, we assume positivity of the Hessian of I|Ka on Kmin
H/2, in
an appropriate sense. Since I|Ka attains minimum on Kmin
, its Hessian is naturally deﬁned
on Kmin
a without assuming additional structures. Let us recall the deﬁnition of the Hessian at
h ∈ Kmin
. For any k ∈ ThKa (which is equivalent to k ∈ ker Dψ1(h)), take a smooth curve
(−τ0, τ0) ∋ τ 7→ c(τ ) ∈ Ka such that c(0) = h and c′(0) = k. (Here, τ0 > 0. Because of (A1)
and the implicit function theorem, H-neighborhood of h in Ka has a manifold structure. Hence,
the notion of ”smooth” curve in the neighborhood is well-deﬁned.) Then, we set

, where I(h) := khk2

a

a

a

a

I ′′(h)hk, ki

:=

I(c(τ )).

d2

dτ 2(cid:12)(cid:12)(cid:12)τ =0

6

As is well-known, this is independent of the chioce of the curve c and I ′′(h) becomes a bounded
bilinear form on ThKa × ThKa. It is obvious that I ′′(h)hk, ki = 0 if k ∈ ThKmin
vanishes. For simplicity, we will set H0(h) := ThKa ∩ (ThKmin
codimension n + n′.

are the ”only directions” in ThKa such that I ′′(h)
)⊥, which is a closed subspace of

We assume that the elements of ThKmin

a

.

a

a

a

and any k ∈ H0(h) \ {0}, I ′′(h)hk, ki > 0.

(B3): For any h ∈ Kmin
Some equivalent conditions to (B3) are known. (See e.g. Bismut [7] or Takanobu and Watan-
abe [41].) One obvious example is that (B3) remains the same if we replace ”k ∈ H0(h) \{0}”
by ”k ∈ ThKa \ ThKmin
a ”. It is worth remarking that this condition implies the exponential
integrability of a certain quadratic Wiener functional that appears in the proof of our main
theorem (see Section 5).

We introduce a family Gε(w) = G(ε, w) of scalar-valued D∞-functionals (0 < ε ≤ 1). Main
examples we have in mind are multiplicative functionals that appear in the Feynman-Kac(-Itˆo)
formulae. Here, D∞ stands for the space of test Wiener functionals.

(C1): For any ε ∈ (0, 1], Gε is a real-valued smooth Wiener functional, that is, Gε ∈ D∞.
Moreover, for any h ∈ H, the following asymptotic expansion holds:

G(ε, w +

h
ε

) ∼ Γ0(h) + εΓ1(w; h) + ε2Γ2(w; h) + · · ·

in D∞ as ε ց 0.

uniformly on {h ∈ H | khkH ≤ ρ} for any ρ > 0. Here, Γ0(h) is a smooth function on H and
Γj(· ; h) ∈ D∞ depends smoothly on h ∈ H (j ≥ 1).
In the asymptotic expansion of heat kernels, the odd order terms of ε(= √t) vanish. To
formulate and prove this phenomenon, we set the following assumption:

(C2): For any h ∈ Kmin
a
if j is even (resp. odd).

, Γj(· ; h) ∈ D∞ is even (resp. odd) Wiener functional in w-argument

We say a (generalized) Wiener functional F is even (resp. odd) if F (−w) = F (w) (resp.
F (−w) = −F (w)). These are well-deﬁned since the map w 7→ −w leaves µ invariant.
If
Gε ≡ 1, then (C2) is clearly satisﬁed.
Remark 2.1 The reader may wonder why we introduce the projection ΠV in our formulation.
In the early days of Malliavin calculus, this type of assumption was common in the study of
”partially hypoelliptic” problems (see [42, 27] and references within). This formulation probably
has its origin in Eells-Elworthy’s construction of Brownian motion on a Riemannian motion
(see Example 2.8). Recently, this kind of formulation attracted attention from mathematical
ﬁnance, too (see [12] for example).

7

2.3 Main result: The Euclidean case

In this subsection we present our main result in the Euclidean setting. The proof of this theorem
will be given in Sections 6–7. An explicit expression of the leading term c0 will be given in
(7.17). If Γ0 is non-negative, but not identically zero on Kmin
, c0 > 0. Note that the left hand
side of the asymptotic expansion is the generalized expectation.
Theorem 2.2 Let x ∈ Rd and a ∈ V such that ΠV(x) 6= a. Assume (A1), (A2), (B1), (B2),
(B3) and (C1). Then, we have the following asymptotic expansion:
ε−(n+n′)(c0 + c1ε + c2ε2 + · · · )

1 )] ∼ e−d2

E[G(ε, w)δa(Y ε

as ε ց 0

a/2ε2

a

for certain constants cj ∈ R (j ≥ 0). If we assume (C2) in addition, then c2j+1 = 0 (j ≥ 0).
Remark 2.3 The only diﬀerence between our Thorem 2.2 and Theorem 5.1 in [41] is the
H¨ormander’s bracket generating condition (A2). In [41] the stronger version of bracket gen-
erating condition is assumed at every x ∈ Rd on the upper space. (By ”stronger” we mean the
drift vector ﬁeld V0 is not involved in the condition.) On the other hand, we assumed the weaker
version of bracket generating condition only at the starting point on the lower space. Therefore,
we believe we have made sizable relaxation of the bracket generating condition.

Put in a broader context, however, whether this improvement is large or not is somewhat
unclear. In other words, we do not know how many of the newly allowed examples by this relax-
ation satisfy the other assumptions. (For instance, under the weaker version of H¨ormander’s
condition, (B1) may not hold very often.) It needs further investigations.

The formulation of Theorem 2.2, (in particular, the generalized expectation) may look too
general for non-experts of Watanabe’s distributional Malliavin calculus. Therefore, we give
basic examples below.

Example 2.4 Consider the case V = Rd and write a = x′(6= x). Then, the heat kernel pt(x, x′)

associated with the diﬀerential operator L := (1/2)Pr
In this example G(ε, w) ≡ 1. (In our convention, (etLf )(x) =RRd pt(x, x′)f (x′)dx′, where etL

denotes the heat semigroup associated with L.)

Let C be a tempered smooth function on Rd which is bounded from below. Then, the heat

pε2(x, x′) = E[δx′(X ε(1, x, w))].

i + V0 is expressed as

i=1 V 2

kernel pC

t (x, x′) associated with LC := (1/2)Pr

ε2(x, x′) = E[exp(cid:16)−ε2Z 1

pC

0

i=1 V 2

i + V0 − C is expressed as

C(X ε(s, x, w))ds(cid:17) δx′(X ε(1, x, w))].

In this case G(ε, w) = exp(−ε2R 1

tional and satisﬁes (C1). See Section V-10, Ikeda and Watanabe [19].

Due to the Feynman-Kac-Itˆo formula, the heat kernels of magnetic Schr¨odinger operators

0 C(X ε(s, x, w))ds) is the Feynman-Kac multiplicative func-

also admit a similar expression (we omit details. See Section 6 in Ikeda’s survey [25]).

8

2.4 The manifold case
Let M and N be compact manifolds with dimension d and n (1 ≤ n ≤ d), respectively, and let
Π : M → N be a smooth map. N is equipped with a smooth volume vol. (A measure on N
is said to be a smooth volume if it is expressed on each coordinate chart as a strictly positive
smooth density function times the Lebesgue measure.)

For vector ﬁelds Vi (0 ≤ i ≤ r) on M, we study the following scaled SDE and its corre-

sponding skeleton ODE:

dX ε

t = ε

Vi(X ε

t ) ◦ dwi

t + ε2V0(X ε

t )dt

with X ε

0 = x ∈ M,

(2.4)

(2.5)

rXi=1
rXi=1

dφt =

Vi(φt)dhi
t

with

φ0 = x ∈ M.

t = Π(X ε

t ) and ψt = Π(φt). When necessary we will write X ε

Set Y ε
For x ∈ M and a ∈ N such that Π(x) 6= a, we deﬁne Ka, Kmin
the Euclidean case.

a

t = X ε(t, x, w) etc. as before.
, and da in the same way as in

Malliavin calculus for SDEs on manifolds was studied by Taniguchi [42]. Roughly speaking,

most of important results in the ﬂat space case still hold true in the manifold case.

We impose two assumptions on the coeﬃcient vector ﬁelds. They are similar to the corre-

sponding ones in the Euclidean case.

(A1)’: Vi is a smooth vector ﬁelds on M (0 ≤ i ≤ r).
Under this condition, X ε
t
(For the deﬁnition of manifold-valued smooth Wiener functionals, see [42].)

is smooth in the sense of Malliavin calculus for any (t, ε) ∈ [0, 1]2.
Now we introduce a H¨ormander-type condition. Σk is deﬁned as in the Euclidean case.

Unlike in the Euclidean case, we assume the bracket generating condition at every point.

(A2)’: For every x ∈ M, ∪∞
algebra.

k=1{(Π∗)xW (x) | W ∈ Σk} spans TΠ(x)N in the sense of linear

1 ]−1 also holds in this case.

Choose a Riemannian metric on N so that the determinant of the (determinsitic) Malliavin
covariance of N -valued functionals are well-deﬁned. Results in Taniguchi [42] or Section 5
in Kusuoka-Stroock [27] applies to this case. Y ε
is non-degenerate in the sense of Malliavin
t
calculus for any t > 0 and ε ∈ (0, 1]. Moreover, Kusuoka-Stroock’s moment estimate (2.3) for
det σ[Y ε
As in the Euclidean case, if an N -valued smooth Wiener functional F is non-degenerate in
the sense of Malliavin, then composition T (F ) = T ◦ F ∈ ˜D−∞ is well-deﬁned as a Watanabe
distribution for any distribution T on N (see [42]). Therefore, δa(Y ε
1 ) a positive Watanabe
distribution under (A2)’ for every a ∈ N .

On the other hands, Assumptions (B1), (B2), (B3) and (C1) need not be modiﬁed and

9

will be imposed in the manifold setting again. In this case, too, non-degeneracy of σ[ψ1](h) is
equivalent to surjectivity of the tangent map Dψ1(h) : H → TaN at h.
Without loss of generality, we may assume that a Riemannian metric is given on both M
and N . The reason we introduce them is as follows: One on M is needed when a tubular
neighborhood on M is used. Since Malliavin covariance matrix of N -valued functional is
actually a bilinear form on the cotangent space, a metric on the cotangent space is needed
when the determinant and the eigenvalues of the Malliavin covariance matrix are considered.
For our purpose any Riemannian metric will do. In particular, even if we change the Riemannian
metric on N , (A2)’ and (B1) (and the other assumptions) remain equivalent. Hence, δa(Y ε
1 )
does not depend on the choice of the Riemannian metrics on M and N .
1 ) depend on the choice of vol. Since any other smooth

On the other hand, δa and δa(Y ε

volume can be expressed as cvol(dy) = ρ(y)vol(dy) for some strictly positive smooth function ρ
on N , the delta function with respect to cvol is given by ˆδa = ρ(a)−1δa. Therefore, it is suﬃcient

to prove Theorem 2.5 below for one particular smooth volume. In the proof of Theorem 2.5 in
Section 8, we will assume that vol is the Riemannian measure on N .
Theorem 2.5 Let x ∈ M and a ∈ N such that Π(x) 6= a. Assume (A1)’, (A2)’, (B1),
(B2), (B3) and (C1). Then, we have the following asymptotic expansion:

E[G(ε, w)δa(Y ε

1 )] ∼ e−d2

a/2ε2

ε−(n+n′)(c0 + c1ε + c2ε2 + · · · )

as ε ց 0

for certain constants cj ∈ R (j ≥ 0). If we assume (C2) in addition, then c2j+1 = 0 (j ≥ 0).
Remark 2.6 Compactness of M and N in Theorem 2.5 is assumed for simplicity. Since
manifold-valued Malliavin calculus in [42] is developed for a reasonable class of non-compact
manifolds, we believe that Theorem 2.5 extends to the case of non-compact manifolds under
fairly mild assumptions.

Remark 2.7 A remark similar to Example 2.4 holds in the manifold setting, too.
In par-
ticular, if M = N and Π is the identity map, then E[δx′(X ε(1, x, w))] is the Feynman-Kac

representation of the heat kernel pε2(x, x′) associated with L := (1/2)Pr

However, some important second order diﬀerential operators cannot be written in a ”sum of
squares” form as in Remark 2.7 above, which is the reason why two manifolds are considered.
Here are examples of manifolds M and N we have in mind.
The ﬁrst example is the orthonormal frame bundle over a compact Riemannian manifold.
This is a familiar example in stochasitc analysis on manifolds and called Eells-Elworthy’s con-
struction of Itˆo’s stochastic parallel transport (see Section V-4, [19] or Hsu [17], Stroock [39]
for example).

i=1 V 2

i + V0.

Example 2.8 Let N be a compact Riemannian manifold with dimN = n and let M = O(N )
be its orthonormal frame bundle Hence, d := dimM = n(n + 1)/2. Let Π : O(N ) → N be the
canonical projection. We take Vi to be the ith canonical horizontal vector ﬁeld on O(N ) for
1 ≤ i ≤ n and set V0 ≡ 0.

10

Let ˆa ∈ N and consider SDE (2.4) with r = n, x ∈ Π−1(ˆa) ⊂ O(N ) and a ∈ N . Then,
regardless of the choice of x, the process t 7→ Y ε(t, x, w) is the Brownian motion on N , that
is, the diﬀusion process associated to the (minus one half of ) Laplace-Beltrami operator △N
starting at ˆa ∈ N .
In this case (A1)’ and (A2)’ are clearly satisﬁed and δa(Y ε(1, x, w)) is well-deﬁned. More-
over, E[δa(Y ε(1, x, w))] = pε2(ˆa, a), the heat kernel associated to −△N /2. Note that the deter-
ministic Malliavin covariance is non-degenerate at any h ∈ H since the coeﬃcient vector ﬁelds
are elliptic at x. So, (B1) is also satisﬁed.
We denote by Hˆa(N ) the set of absolutely continuous path ξ on N starting at ˆa with E(ξ) :=
sk2
Tξs N ds < ∞. The development map h 7→ ψ(h) is a diﬀeomorphism (of Hilbert manifolds)
H for any h ∈ H.

0 kξ′
between H and Hˆa(N ) which preserves the energy, that is, E(ψ(h)) = khk2
Therefore,

R 1

d2
a = min{E(ξ) | ξ ∈ Hˆa(N ), ξ1 = a} and ψ(Kmin

a

) = {ξ ∈ Hˆa(N ) | ξ1 = a,E(ξ) = d2
a}

which will be denoted by Kmin
ˆa,a (N ). In other words, the set of minimal energy paths does not
change through ψ. Moreover, da is equal to the Riemannian distance dN (ˆa, a). Let us rewrite
the other assumptions in terms of Kmin

ˆa,a (N ).

First, (B2) is equivalent to

ˆa,a (N ) is a smooth, compact, connected manifold of ﬁnite dimension n′ regularly

(R2): Kmin
embedded in Hˆa(N ).
Set Kˆa,a(N ) := {ξ ∈ Hˆa(N ) | ξ1 = a}. Then, (B3) is equivalent to
(R3): For any ξ ∈ Kmin
Then, as a corollary of our main theorem, we obtain the following: Assume ˆa 6= a, (R2)
and (R3). Then, as a special case (Gε ≡ 1) of Theorem 2.5, we have the following asymptotic
expansion:

ˆa,a (N ) and any k ∈ TξKˆa,a(N ) \ TξKmin

ˆa,a (N ), E ′′(ξ)hk, ki > 0.

pε2(ˆa, a) ∼ exp(−

dN (ˆa, a)2

2ε2

)ε−(n+n′)(c0 + c2ε2 + c4ε4 + · · · )

as ε ց 0

for certain constants c2j ∈ R (j ≥ 0).

The next example is a compact, strictly pseudo-convex CR manifold and its unitary frame
bundle in Kondo and Taniguchi [26]. For fundamental facts on CR manifolds, the reader is
referred to [13] among others.

Example 2.9 A CR (Cauchy-Riemann) manifold N is a real smooth manifold equipped with a
complex subbundle T1,0 of the complexiﬁed tangent bundle CTN with properties that T1,0∩T0,1 =
{0}, where T0,1 = T1,0 is the complex conjugate of T1,0 and [T1,0, T1,0] ⊂ T1,0. Assume that N is
compact, orientable and of real dimension 2n + 1 and T1,0 is of complex dimension n.

11

There exists a real non-vanishing 1-form θ on N annihilating H = Re(T1,0 ⊕ T0,1). We

assume that N is strictly pseudo-convex, i.e., the Levi form Lθ deﬁned by

Lθ(Z, W ) = −√−1 dθ(Z, W )

for Z, W ∈ Γ∞(T1,0 ⊕ T0,1),

where Γ∞(V ) is the space of smooth sections of vector bundle V , is positive deﬁnite. Associated
with θ, the characteristic direction T , the unique real vector ﬁeld on N transverse to H is given
by

where T⌋ω is the interior product.

The Webster metric gθ is deﬁned by

T⌋dθ = 0,

T⌋θ = 1,

gθ(X, Y ) = dθ(X, JY ),

gθ(X, T ) = 0,

gθ(T, T ) = 1

for X, Y ∈ Γ∞(H),

where J : TN → TN is deﬁned so that its complex linear extension to CTN is equal to the
multiplication by √−1 on T1,0, that by −√−1 on T0,1, and J(T ) = 0. The Tanaka-Webster
connection is a unique linear connection ∇ on N such that

∇X Y ∈ Γ∞(H), ∇J = 0, ∇gθ = 0,
T∇(Z, W ′) = 2√−1Lθ(Z, W ′)T,

T∇(Z, W ) = 0,

T∇(T, J(X)) + J(T∇(T, X)) = 0

for X ∈ Γ∞(TN ), Y ∈ Γ∞(H), Z, W ∈ Γ∞(T1,0), and W ′ ∈ Γ∞(T0,1), where ∇X is the
covariant derivative in the direction of X and T∇ is the torsion tensor ﬁeld of ∇.

Deﬁne the unitary frame bundle over N by

U(T1,0) = ax∈M

{u : Cn → (T1,0)x; u is a unitary isometry}.

For u ∈ U(T1,0) with u : Cn → (T1,0)x, let Π(u) = x. Every v ∈ TxN admits a unique horizontal
lift ηu(v) ∈ TuU(T1,0), where u ∈ Π−1(x), so that there exist smooth curves p : [−a, a] → N

and bp : [−a, a] → U(T1,0) such that Π ◦bp = p, bp(0) = u, bp′(0) = ηu(v), (Π∗)uηu(v) = v, and the
curve [a, b] ∋ t 7→ bp(t)ζ ∈ T1,0 is a parallel section along p with respect to ∇ for any ζ ∈ Cn.

Extending ηu naturally to a complex linear mapping of CTxM to TuU(T1,0), set L(ζ)u = ηu(uζ)
for ζ ∈ Cn. Using the standard complex basis {e1, . . . , en} of Cn, deﬁne the canonical vector
ﬁelds L1, . . . , Ln by

Consider the stochastic diﬀerential equation on U(T1,0) given by

Li = L(ei),

i = 1, . . . , n.

dut =

{Li(ut) ◦ dbi(t) + Li(ut) ◦ dbi(t)},

nXi=1

where r = 2n, bi(t) = (wi
t. Then Π(ut) determines
a diﬀusion process generated by −∆b/2. Here the operator ∆b is a hypoelliptic sub-Laplacian
given by

t = bi

t + √−1wn+i

t

)/√2, Li = Li and bi

ZN

(∆bf )gψ =ZN

12

L∗

θ(dbf, dbg)ψ

for any complex valued smooth f, g on N , where ψ = θ ∧ (dθ)n, L∗
Lθ, and dbf is the projection of df onto H ∗.

θ is the dual metric on H ∗ of

Assumption (A1)’ clearly holds. Moreover (A2)’ is also satisﬁed as was seen in [26].

i=1 is a local orthonormal frame of T1,0, then

Indeed, if {Zi}n

(Π∗)u(Li) =

ei
jZj

nXj=1

and (Π∗)u[Li, Li] = −2√−1T mod {Zi, Zi; i = 1, . . . , n},

where (ej

i ) ∈ U(n). See Kondo and Taniguchi [26] for details.

Unlike the Riemannian counterpart in Example 2.8, however, not much is known about this
example. For example, it is yet unclear (i) when the other assumptions are satisﬁed or (ii) how
to translate these assumptions into terminology of CR geometry.

Grong and Thalmaier [16] recently showed that diﬀusion processes on sub-Riemannian man-
ifolds associated with sub-Laplacians also admits a similar construction. For basic information
on sub-Riemannian geometry, we refer to [34, 36, 10] among others.

Example 2.10 (Diﬀusions associated with sub-Laplacian on sub-Riemannian manifolds. See
Section 2, [16] for details.) Let (N ,D, g) be a compact sub-Riemannian manifolds. Here, D is
a sub-bundle of the tangent bundle TN of a smooth compact manifold N with dimN = n) and
g is a metric tensor on D. By deﬁnition, D is bracket generating.
Let ¯g be a Riemannian metric tensor of N that tames g (i.e., ¯g|D = g). Let Γ be the
orthogonal complement of D in TN . We write the orthogonal projection by prD and prΓ,
respectively. Denote by ¯∇ the Levi-Civita connection on N with respect to ¯g. Deﬁne a sub-
Laplacian by using a local orthonormal frame {A1, . . . , Ar} of D by
¯∇AiAj, AiiAi

ghprD

Lsub =

A2

i +

rXi=1

rXi,j=1

where r (1 < r < n) is the rank of D. This is a globally well-deﬁned diﬀerential operator and
known to be hypoelliptic.
The diﬀusion process on N associated with Lsub/2 + A0 admits Eell-Elworthy’s construction
for any vector ﬁeld A0 on N (A0 need not be a section of D). In this case, the principle bundle
is

O(D) ⊙ O(Γ) = [y∈N(cid:8)(u, v) | u : Rr → Dy and v : Rn−r → Γy are isometries(cid:9)

with its structure group O(r) × O(n − r). The projection is denoted by Π. Since ¯∇ is a metric
connection, it deﬁnes a Cartan-Ehresmann connection on O(D) ⊙ O(Γ). Deﬁne canonical
horizontal vector ﬁelds ¯Ai (1 ≤ i ≤ r) on O(D) ⊙ O(Γ) so that ( ¯Ai)(u,v) is the horizontal lift of
i=1 is the canonical basis of Rr. Also deﬁne ¯A0 to be the horizontal lift
uei ∈ DΠ(u,v), where {ei}n
of A0. Then, the solution to SDE on O(D)⊙O(Γ) with the coeﬃcient vector ﬁelds ¯Ai (0 ≤ i ≤ r)
is the diﬀusion process associated with Lsub/2 + A0. (In [16], only the case A0 ≡ 0 is treated.
However, a modiﬁcation of this ﬁrst order term is easy.)

13

3 Preliminaries

In this section we summarize results we will use in the proof of our main theorems. All the
results in this section are either known or easily derived from known results.

3.1 Preliminaries from Malliavin calculus

We ﬁrst recall Watanabe’s theory of generalized Wiener functionals (i.e., Watanabe distribu-
tions) in Malliavin calculus. Most of the contents and the notations in this subsection are
contained in Sections V.8–V.10, Ikeda and Watanabe [19] with trivial modiﬁcations. We also
refer to Shigekawa [38] and Nualart [35]. For basic results of quasi-sure analysis, see Chapter
II, Malliavin [32].

Let (W,H, µ) be the classical Wiener space as before. (The results in this subsection also
hold on any abstract Wiener space, however.) The following are of particular importance in
this paper:

(a) Basics of Sobolev spaces: We denote by Dp,r(X ) the Sobolev space of X -valued (gen-
eralized) Wiener functionals, where p ∈ (1,∞), r ∈ R, and X is a real separable Hilbert space.
As usual, we will use the spaces D∞(X ) = ∩∞
k=1∪1<p<∞ Dp,k(X )
of test functionals and the spaces D−∞(X ) = ∪∞
k=1 ∩1<p<∞
Dp,−k(X ) of Watanabe distributions as in [19]. When X = R, we simply write Dp,r, etc. The
Dp,r(X )-norm is denoted by k · kp,r. The precise deﬁnition of an asymptotic expansion up to
any order can be found in Section V-9, [19].

k=1 ∪1<p<∞ Dp,−k(X ), ˜D−∞(X ) = ∪∞

k=1∩1<p<∞ Dp,k(X ), ˜D∞(X ) = ∩∞

(b) Meyer’s equivalence of Sobolev norms: See Theorem 8.4, [19]. A stronger version can

be found in Theorem 4.6, [38], Theoem 1.5.1, [35] or Theorem 5.7.1 Bogachev [8].

(c) Watanabe’s pullback: Pullback T ◦ F = T (F ) ∈ ˜D−∞ of a tempered Schwartz distribu-
tion T ∈ S′(Rn) on Rn by a non-degenerate Wiener functional F ∈ D∞(Rn). (see Sections 5.9,
[19].) The key to prove this pullback is an integration by parts formula in the sense of Mallavin
calculus (its generalization is given in Item (d) below).

(d) A generalized version of the integration by parts formula in the sense of Malliavin

calculus for Watanabe distribution, which is given as follows (see p. 377, [19]):

For a non-degenerate Wiener functional F = (F 1, . . . , F n) ∈ D∞(Rn), we denote by σ[F ](w) =
F (w) =
F (w) the (i, j)-component of the inverse matrix σ−1
F .
F (Dσkl
F can be written
F ’s. Suppose G ∈ D∞ and T ∈ S′(Rn). Then, the

σF (w) the Malliavin covariance matrix of F whose (i, j)-component is given by σij
hDF i(w), DF j(w)iH. We denote by γij
F = Pk,l γik
Note that σij
F ∈ D∞ and Dγij
in terms of γij
F ’s and the derivatives of σij

F . Hence, derivatives of γij

F )γlj

14

following integration by parts holds;

where Φi(w; G) ∈ D∞ is given by

Φi(w; G) = −

E(cid:2)(∂iT ◦ F )G(cid:3) = E(cid:2)(T ◦ F )Φi(· ; G)(cid:3),
dXj=1n−

dXk,l=1
F (w)hDG(w), DF j(w)iH + γij

F (w)hDσkl

G(w)γik

F (w)γjl

+ γij

F (w), DF j(w)iH
F (w)G(w)LF j(w)o.

(3.1)

(3.2)

Note that the expectations in (3.1) are in fact the generalized ones, i.e., the pairing of ˜D−∞
and ˜D∞.

Watanabe’s asymptotic expansion theorem is a key theorem in his distributional Malliavin
calculus. Its standard version can be found in Theorem 9.4, pp. 387-388, [19] or Watanabe
[46]. In the present paper, however, we need a modiﬁed version in pp. 216–217, [41]. Though
it plays a key role, no proof is given in [41] unfortunately. Therefore, we will prove it below.

Let ρ > 0, ξ ∈ D∞ and F ∈ D∞(Rn) and suppose that

inf

v∈Rn:|v|=1

v∗σF (w)v ≥ ρ

on

{w ∈ W | |ξ(w)| ≤ 2}.

(3.3)

Let χ : R → R be a smooth function whose support is contained in [−1, 1]. Then, the following
proposition holds (Proposition 6.1, [41]).

Proposition 3.1 Assume (3.3). For every T ∈ S′(Rn), χ(ξ)(T ◦ F ) = χ(ξ)T (F ) ∈ ˜D−∞ can
be deﬁned in a unique way so that the following properties hold:
(i) If Tk → T ∈ S′(Rn) as k → ∞, then χ(ξ)Tk(F ) → χ(ξ)T (F ) ∈ ˜D−∞.
(ii) If T is given by g ∈ S(Rn), then χ(ξ)T (F ) = χ(ξ)g(F ) ∈ D∞.

Proof. Let η : R → R be a smooth function whose support is contained in (−2, 2). By the
assumption (3.3), σF is invertible on {η(ξ) 6= 0}, and η(ξ)σ−1
F is of class D∞. In fact, it is the
limit of η(ξ)(σF + 1
mIdn)−1 in D∞ as m → ∞, where Idn stands for the n × n-identity matrix.
Hence Φi(· ; η(ξ)G) in (3.2) is well deﬁned and of class D∞. Moreover, observe that

Φi(· ; η(ξ)G) = D∗(cid:18)η(ξ)G

γik

F DF k(cid:19)

nXk=1

(3.4)

for any G ∈ D∞. Let f ∈ S(Rn). Since

η(ξ)(∂if ◦ F ) = η(ξ)

nXk=1

15

hD(f ◦ F ), DF kiHγik
F ,

we have the same integration by parts formula as (3.1);

E[η(ξ)(∂if ◦ F )G] = E[(f ◦ F )Φi(· ; η(ξ)G)].

(3.5)

Furthermore, for p > 1 and r > 0, let Cp,r be a constant such that

kD∗(GK)kp,r ≤ Cp,rkGk2p,r+1kKk2p,r+1

for any G ∈ D2p,r+1 and K ∈ D2p,r+1(H). Then

kΦi(·; η(ξ)G)kp,r ≤ Cp,r(cid:13)(cid:13)(cid:13)(cid:13)η(ξ)

nXk=1

γik

F DF k(cid:13)(cid:13)(cid:13)(cid:13)2p,r+1kGk2p,r+1.

(3.6)

Take a sequence {χk}∞

k=1 of smooth functions on R such that χ1 = χ, suppχk ⊂ (−2, 2),
and χk+1 = 1 on suppχk, k = 1, 2, . . . For a multi-index α = (α1, . . . , αn), where αi’s are
non-negative integers, let iα = max{i; αi 6= 0} and α′ = (α1 − δ1iα, . . . , αn − δniα), δij being
Kronecker’s delta. Deﬁne Φ(α) by

if |α| =Pn

k=1 αk = 1, and

if |α| ≥ 2.

It then holds that

Φ(α)(· ; G) = Φiα(· ; χ1(ξ)G)

Φ(α)(· ; G) = Φ(α′)(cid:0)· ; χ|α|(ξ)Φiα(·; G)(cid:1)
E[χ(ξ)(∂αf ◦ F )G] = E[(f ◦ F )Φ(α)(· ; G)]

(3.7)
for any f ∈ S(Rn) and G ∈ D∞, where ∂α = (∂1)α1 · · · (∂n)αn. In fact, for |α| = 1, (3.7) is
nothing but (3.5). Suppose that (3.7) holds for α with |α| = k. Then for α with |α| = k + 1,
since

by the assumption of induction and (3.5), we obtain

χk+1(ξ)Φiα(· ; χ1(ξ)G) = Φiα(· ; χ1(ξ)G),

E[χ(ξ)(∂αf ◦ F )G] = E[χ1(ξ)(∂iα(∂α′

f ) ◦ F )G]

= E[(∂α′
= E[χ|α|(ξ)(∂α′

f ◦ F )Φiα(· ; χ1(ξ)G)]

f ◦ F )Φiα(· ; χ1(ξ)G)] = E[(f ◦ F )Φ(α)(· ; G)].

On account of (3.6) and (3.7), repeating the standard argument to construct Watanabe’s
pullback in Section V-9, [19], we arrive at the unique existence of the continuous mapping
u : S′(Rn) → ˜D−∞ such that u(f ) = χ(ξ)f (F ) for f ∈ S(Rn). Rewriting u(T ) as χ(ξ)T (F ), we
obtain the desired continuous linear mapping.

16

Next, we state the asymptotic expansion theorem, which is Proposition 6.2, [41]. Let
{Fε}0<ε≤1 ⊂ D∞(Rn) and {ξε}0<ε≤1 ⊂ D∞ be families of Wiener functionals such that the
following asymptotics hold:

Fε ∼ f0 + εf1 + ε2f2 + · · ·
ξε ∼ a0 + εa1 + ε2a2 + · · ·

in D∞(Rn) as ε ց 0,
in D∞ as ε ց 0.

(3.8)
(3.9)

Proposition 3.2 Assume (3.8), (3.9) and |a0| ≤ 1/8. Moreover, assume that there exists
ρ > 0 independent of ε such that (3.3) with F = Fε and ξ = ξε holds for any ε ∈ (0, 1]. Let
χ : R → R be a smooth function whose support is contained in [−1, 1] such that χ(x) = 1 if
|x| ≤ 1/2. Then, we have the following asymptotic expansion:

χ(ξε)T (Fε) ∼ Φ0 + εΦ1 + ε2Φ2 + · · ·

in ˜D−∞ as ε ց 0.

In the above proposition, Φk ∈ ˜D−∞ can be written as the kth coeﬃcient of the formal Taylor
expansion of T (f0 + [εf1 + ε2f2 + · · · ]). In particular, Φ0 = T (f0).
Proof. Let T ∈ S′(Rn). Take an m ∈ N so that φ = (1 + |x|2 − 1
2∆)−mT is a bounded function
on Rn which is k-times continuous diﬀerentiable with bounded derivatives up to order k. By
virtue of (3.7), there exists a continuous linear mapping ℓε : D∞ → D∞ such that

E[χ(ξε)T (Fε)G] = E[φ(Fε)ℓε(G)]

for every G ∈ D∞.

By (3.4),

ℓε(G) =

2mXi=0

hPi(ε), DiGiH⊗i,

lim
ε→0

1
εkkχ(ξε) − 1kp,r = 0

where Pi(ε) ∈ D∞, i = 0, . . . , 2m, are polynomials in Fε, χk(ξε)σ−1
derivatives. Since

Fε , k = 1, . . . , 2m, and their

for any p > 1, r > 0 and k ∈ N, applying the argument used in the proof of Theorem V.9.4,
[19] to χ(ξε)φ(Fε) instead of φ(Fε), we obtain the desired asymptotic expansion.

In the end of this subsection, we gather well-known facts about SDE (2.1) and ODE (2.2)
for later use. The Jacobian of φ(t, x, h) with respect to x and its inverse satisfy the following
ODEs:

rXi=1
rXi=1

dKt = −

dJt =

∇Vi(φt)Jtdhi

t

with

J0 = Idd,

(3.10)

Kt∇Vi(φt)dhi

t

with K0 = Idd.

(3.11)

17

Here, J, K,∇Vi are all d × d matrices. Note that Kt = J −1
. When the dependence on h and x
needs to be speciﬁed, we write Jt(h) or J(t, x, h), etc. The deterministic Malliavin covariance
is given by

t

σ[φ1](h) = J1(h)nZ 1

0

Jt(h)−1V(φt(h))V(φt(h))∗(Jt(h)−1)∗dtoJ1(h)∗

(3.12)

and σ[ψ1](h) = ΠVσ[φ1](h)Π∗

Similarly, the Jacobian process for SDE (2.1) and its inverse satisfy the following SDEs:

V, where we set V := [V1, . . . , Vr] ∈ Mat(d, r) for simplicity.

dJ ε

t = ε

∇Vi(X ε

t )J ε

t ◦ dwi

t + ε2∇V0(X ε

t )J ε

t dt

with

J ε
0 = Idd,

(3.13)

with K ε

0 = Idd.

(3.14)

rXi=1
rXi=1

dK ε

t = −ε

K ε
t ∇Vi(X ε

t ) ◦ dwi

t − ε2K ε

t ∇V0(X ε

t )dt

As before, K ε
covariance is given by

t = (J ε

t )−1. When necessary we will write J ε

t (w) or J ε(t, x, w), etc. The Malliavin

ε−2σ[X ε

1] = J ε

1nZ 1

0

(J ε

t )−1V(X ε

t )V(X ε

t )∗(J ε

t )−1,∗dto(J ε

1 )∗

(3.15)

and σ[Y ε

t ](w) = ΠV σ[X ε

t ](w)Π∗

V a.s. (the dependence on w is suppressed above).

3.2 Preliminaries from rough path theory

In this subsection we recall the geometric rough path space with H¨older or Besov norm and
quasi-sure property of rough path lift. For basic properties of geometric rough path space, we
refer to Lyons, Caruana, and L´evy [30], and Friz and Victoir [14]. For the geometric rough path
space with Besov norm, we refer to Appendix A.2, [14]. Quasi-sure property of rough path lift
is summarized in Inahama [23].

We assume that the Besov parameters (α, 4m) satisfy the following condition:

1
3

< α <

1
2

, m = 1, 2, 3, . . . , α −

1
4m

>

1
3

,

and

4m(

1
2 − α) > 1.

(3.16)

We choose such a pair (α, 4m) and ﬁx it throughout this paper.

We denote by GΩH

α-H¨older norm. Let C β−H
β-H¨older continuous paths that start at 0. If α + β > 1, then the Young pairing

α (Rr), 1/3 < α < 1/2, the geometric rough path space over Rd with
([0, 1], R), 0 < β ≤ 1, be the Banach space of all the R-valued,

0

GΩH

α (Rr) × C β−H

0

([0, 1], R) ∋ (w, λ) 7→ (w, λ) ∈ GΩH

α (Rr+1)

is a well-deﬁned, locally Lipschitz continuous map. (See Section 9.4, [14] for instance.)

18

Now we consider a system of RDEs driven by the Young pairing (w, λ) ∈ GΩH

α (Rd+1) of
([0, 1], R1). (In most cases, we will assume λt = const × t.) For

w ∈ GΩH
vector ﬁelds Vi : Rd → Rd (0 ≤ i ≤ r), consider

0

Vi(xt)dwi

t + V0(xt)dλt

with

x0 = x ∈ Rd.

(3.17)

α (Rd) and λ ∈ C 1−H
rXi=1

dxt =

The RDEs for the Jacobian process and its inverse are given as follows;

dJt =

∇Vi(xt)Jtdwi

t + ∇V0(xt)Jtdλt

with J0 = Idd ∈ Mat(d, d),

(3.18)

dKt = −

Kt∇Vi(xt)dwi

t − Kt∇V0(xt)dλt

with K0 = Idd ∈ Mat(d, d).

(3.19)

rXi=1
rXi=1

Assume that Vi’s are of C 4

Here, J, K, and ∇Vi are all Mat(d, d)-valued.
b for a while. Then, a global solution of (3.17)–(3.19) exists for any
w and λ . Moreover, Lyons’ continuity theorem holds. (The linear growth case is complicated
and will be discussed later). In that case, the following maps are continuous:

GΩH

α (Rr) × C 1−H

0

([0, 1], R1) ∋ (w, λ)

7→ (w, λ) ∈ GΩH
α (Rr+1)
7→ (w, λ; x, J, K) ∈ GΩH
7→ (x, J, K) ∈ GΩH

α (Rr+1 ⊕ Rd ⊕ Mat(d, d)⊕2)
(3.20)

α (Rd ⊕ Mat(d, d)⊕2).

Here, the ﬁrst map is the Young pairing, the second is the Lyons-Itˆo map, and the third is the
canonical projection. (The map (w, λ) 7→ x will be denoted by Φ : GΩH
([0, 1], R) →
GΩH
α (Rd).) Recall that in Lyons’ formulation of rough path theory, the initial values of the
0,t)−1 = Id + K1
ﬁrst level paths must be adjusted. Note that (Id + J1
When w is the natural lift h ∈ H and λ ≡ 0, the ﬁrst level path

α (Rr)×C 1−H
0,t always holds.

0

t 7→ (x + x1

0,t, Id + J1

0,t, Id + K1

0,t)

(3.21)

is identical to the solution of a system (2.2), (3.10), (3.11). Here, x1
0,t is the ﬁrst level path of
x evaluated at (0, t), etc. Similarly, if (w, λ) = (εW, λε), where W = L(w) is the Brownian
rough path under µ and λε
t = ε2t, then (3.21) coincides with the solution of (2.1), (3.13), (3.14)
a.s.

We deﬁne a continuous function Γ : GΩH

Γ(w, λ) = (Id + J1

0

α (Rr) × C 1−H
0,t)ˆΓ(w, λ)(Id + J1

([0, 1], R) → Mat(d, d) as follows: Set
(3.22)

0,t)∗,

where

ˆΓ(w, λ) :=Z 1

0

with V := [V1, . . . , Vr] ∈ Mat(d, r).

19

(Id + K1

0,t)V(x + x1

0,t)V(x + x1

0,t)∗(Id + K1

0,t)∗dt

From (3.12) (3.15) we can easily see the following: If λε

1](w)
for µ-a.a.w, where X ε
1 denotes the solution of SDE (2.1) at t = 1. If λt ≡ 0 and h = L(h)
is the natural lift of h ∈ H, then Γ(h, 0) = σ[φ1](h), the deterministic Malliavin covariance
matrix given in (3.12). From these we can easily see that ΠVΓ(εw, λε)Π∗
1 ](w) a.s.
and ΠVΓ(h, 0)Π∗

t = ε2t, then Γ(εW, λε) = ε−2σ[X ε

V = ε−2σ[Y ε

V = σ[ψ1](h).

Remark 3.3 In this paper we will use Lyons’ continuity theorem only with respect to α-H¨older
topology (1/3 < α < 1/2) and for C 4
b -coeﬃcient vector ﬁelds. We do not try to extend it to the
case of unbounded coeﬃcient vector ﬁelds or Besov topology.

Now we introduce the Besov topology on the rough path space. For (α, 4m) which satisﬁes
α,4m(Rr) denotes the geometric rough path space over Rr with (α, 4m)-Besov norm.

(3.16), GΩB
Recall that the distance on this space is given by

d(w, ˆw) = kw1 − ˆw1kα,4m−B + kw2 − ˆw2k2α,2m−B
|t − s|1+4mα dsdt(cid:17)1/4m

:=(cid:16)ZZ0≤s<t≤1

s,t − ˆw1

s,t|4m

|w1

+(cid:16)ZZ0≤s<t≤1

|w2

s,t|2m

s,t − ˆw2

|t − s|1+4mα dsdt(cid:17)1/2m

.

α−(1/4m)(Rr). If α < α′ < 1/2, there is a continuous embedding GΩH

By the Besov-H¨older embedding theorem for rough path spaces, there is a continuous embedding
α′(Rr) ֒→
α,4m(Rr) ֒→ GΩH
GΩB
α,4m(Rr). We remark that we will not write these embeddings explicitly. (For example, if
GΩB
we write Φ(w, λ) for (w, λ) ∈ GΩB
([0, 1], R), then it is actually the composition
of the ﬁrst embedding map above and Φ with respect to {α − 1/(4m)}-H¨older topology.)
The map (w, h) 7→ τh(w) is continuous from GΩB
called the Young translation of w by h and is deﬁned by

Note also that the Young translation by h ∈ H works perfectly on GΩB

α,4m(Rr) under (3.16).
α,4m(Rr), where τh(w) is

α,4m(Rr) × H to GΩB

α,4m(Rr)× C 1−H

0

τh(w)1

s,t := w1

s,t + h1

s,t,

τh(w)2

s,t := w2

s,t + h2

s,t +Z t

s

w1

s,udhu +Z t

s

h1

s,udwu.

Here, the integrals are in the Young (or Riemann-Stieltjes) sense and we set wt := w1
over, there exists a positive constant C = Cα,4m such that
kτh(w)1kα,4m−B ≤ kw1kα,4m−B + CkhkH,
kτh(w)2k2α,2m−B ≤ kw2k2α,2m−B + 2Ckw1kα,4m−BkhkH + C 2khk2
H.

0,t. More-

(3.23)
(3.24)

holds for all h ∈ H and w ∈ GΩα,4m(Rr).

For γ > 0 and h ∈ H, we set
Uh,γ = {w ∈ GΩα,4m(Rr) | kτ−h(w)1k4m
U ′
h,γ = Uh,2−1/4mγ = {w ∈ GΩα,4m(Rr) | kτ−h(w)1k4m

(3.25)
2α,2m−B < γ4m/2}.
When h = 0 we simply write Uγ and U ′
γ. By the continuity of τh with respect to the (α, 4m)-
Besov rough path topology, {Uh,γ}γ>0 forms a system of open neighborhood around h = L(h)
and so does {U ′

2α,2m−B < γ4m},
α,4m−B + kτ−h(w)2k2m

h,γ = Uh,γ2−1/4m, Uh,γ = τh(Uγ) and U ′

α,4m−B + kτ−h(w)2k2m

h,γ}γ>0. Clearly, U ′

h,γ = τh(U ′

γ).

20

α,4m(Rr)(cid:9).

Now we discuss quasi-sure properties of rough path lift map L from W to GΩB

α,4m(Rr). For
k = 1, 2, . . . and w ∈ W, we denote by w(k) the kth dyadic piecewise linear approximation of
w associated with the partition {l2−k | 0 ≤ l ≤ 2k} of [0, 1]. We set
k=1 is Cauchy in GΩB

Zα,4m :=(cid:8)w ∈ W | {L(w(k))}∞

0

It is known that Z c

We deﬁne L : W → GΩB
α,4m(Rr) by L(w) = limm→∞ L(w(k)) if w ∈ Zα,4m and we do not deﬁne
L(w) if w /∈ Zα,4m. (We will always use this version of L.) Note that H and C β−H
([0, 1], Rr)
with β ∈ (1/2, 1] are subsets of Zα,4m and this lift for elements of such subsets coincides with the
direct lift by means of the Riemann-Stieltjes integral. Under scalar multiplication and Cameron-
Martin translation, Zα,4m is invariant. Moreover, cL(w) = L(cw) and τh(L(w)) = L(w + h) for
any w ∈ Zα,4m, c ∈ R, and h ∈ H.
α,4m is slim, that is the (p, r)-capacity of this set is zero for any p ∈ (1,∞)
and r ∈ N.
(See Aida [1], Inahama [22, 23]). Therefore, from a viewpoint of quasi-sure
α,4m(Rr)
analysis, the lift map L is well-deﬁned. Moreover, the map W ∋ w 7→ L(w) ∈ GΩB
is ∞-quasi-continuous (Aida [1]). We will often write W := L(w) when it is regarded as a
rough path space-valued random variable deﬁned on W. Due to Lyons’ continuity theorem and
uniqueness of quasi-continuous modiﬁcation, ˜X ε(· , x, w) = x + Φ(εL(w), ε2λ)1 holds quasi-
b . (Here, λt = t and ˜X ε(· , x, w) denotes the ∞-quasi continuous
surely if Vi (0 ≤ i ≤ d) is of C 3
modiﬁcation of the path space-valued random variable w 7→ X ε(· , x, w).) A similar remark
holds for J ε and K ε.
Before closing this subsection, we give a remark for the coeﬃcient vector ﬁelds with linear

growth.

Remark 3.4 If Vi (0 ≤ i ≤ d) satisﬁes (A1) and has linear growth, it is not easy to prove the
existence of a global solution of RDE (3.17) for a given (w, λ) ∈ GΩH
([0, 1], R).
However, Bailleul [2] recently proved it. Hence, the Lyons-Itˆo map Φ can be deﬁned on the
whole space GΩH
([0, 1], R) and Lyons’ continuity theorem holds under (A1), too.
However, almost no other properties of the solution are known under (A1) at this moment.
Therefore, we basically assume that Vi (0 ≤ i ≤ r) is of C ∞
b when we use RDEs. The reason
why we may do so is as follows. In the proof of our main theorem we will discard contributions
from rough paths distant from L(Kmin
) by using large deviation theory. Therefore, by simple
cut-oﬀ argument, the problem reduces to the C ∞

α (Rr) × C 1−H

α (Rr) × C 1−H

b -case anyway.

a

0

0

3.3 Some useful results in Malliavin calculus on rough path space

First, we recall Taylor-like expansion of (Lyons-)Itˆo map. In the proof of our main theorem,
we will compute the Cameron-Martin translation of X ε. For a Cameron-Martin path h ∈ H,
we set X ε,h

:= X ε(t, x, w + (h/ε)), which satisﬁes

t

dX ε,h

t =

Vi(X ε,h

t

rXi=1

) ◦ (εdwi

t + dhi

t) + ε2V0(X ε,h

t

)dt

with X ε,h

0 = x ∈ Rd.

(3.26)

21

Similarly, the translations of the Jacobian process and its inverse satisfy:

∇Vi(X ε,h

t

)J ε,h

t

◦ (εdwi

t + dhi

t) + ε2∇V0(X ε,h

t

)J ε,h

t dt

with

J ε,h
0 = Idd

(3.27)

rXi=1

dJ ε,h

t =

and

dK ε,h

t = −

rXi=1

t ∇Vi(X ε,h
K ε,h

t

) ◦ (εdwi

t + dhi

t) − ε2K ε,h

t ∇V0(X ε,h

t

)dt with K ε,h

0 = Idd. (3.28)

It is east to see that (X ε,h, J ε,h, K ε,h) coincides a.s. with (3.21) with the driving rough path
being (τh(εW), λε) = (εL(w + h/ε), λε).

It is known that under (A1) the following asymptotic expansion holds in D∞(Rd) as ε ց 0:
(3.29)

) = f0(h) + εf1(w; h) + · · · + εkfk(w; h) + Qε

X ε(1, x, w +

k+1(w; h)

h
ε

where Qε

k+1(w; h) = O(εk+1). Note that f0(h) = φ1(h). It immediately follows that

Y ε(1, x, w +

h
ε

) = g0(h) + εg1(w; h) + · · · + εkgk(w; h) + Rε

k+1(w; h)

(3.30)

k+1(w; h) = ΠV(Qε

in D∞(Rd) as ε ց 0, where we set Rε
k+1(w; h)) and gj(w; h) = ΠV(fj(w; h)).
for all j = 0, 1, 2, . . .. Note that g0(h) = ψ1(h) and g1(w; h) = Dψ1(h)hwi. Moreover, these
asymptotic expansions are uniform in h as h varies in an arbitrary bounded set in H.
The expansion (3.29) has a counterpart in rough path theory, which we call Taylor-like
expansion of the Lyons-Itˆo map Φ (see Inahama and Kawabi [25] and Inahama [21]). Assume
1/3 < α < 1/2 and that Vi is of C ∞
for a while (0 ≤ i ≤ r). Then, there exist continuous maps
b
ˆfk : GΩH
α (Rr) × H 7→ Rd and ˆQε
α (Rr) × H 7→ Rd for k = 0, 1, . . . which satisfy the
k+1 : GΩH
following (i) and (ii):
(i) For all k = 0, 1, . . . and ε ∈ [0, 1],

fk(w; h) = ˆfk(W; h) and Qε

k+1(w; h) = ˆQε

k+1(W; h), µ-a.s.,

where we set

ˆQε

k+1(w; h) := x + Φ(τh(εw), λε)1

0,1 −(cid:8) ˆf0(h) + ε ˆf1(w; h) + · · · + εk ˆfk(w; h)(cid:9).

(ii) For any k ∈ N, ρ > 0, h ∈ H, there exist positive constants Ck and C ′

k,ρ such that

| ˆfk(w; h)| ≤ Ck(1 + kw1kα−H + kw2k1/2

2α−H )k

for any w ∈ GΩH

α (Rr) and
| ˆQε

k+1(w; h)| ≤ C ′

k,ρ(ε + k(εw)1kα−H + k(εw)2k1/2

2α−H)k+1

if k(εw)1kα−H + k(εw)2k1/2 ≤ ρ. Of course, Ck and C ′
depend only on khkH.
ΠV( ˆfk(w; h)) and ˆRε

k+1(w; h) := ΠV( ˆQε

Note that the inequalities (3.33) and (3.34) are deterministic. It is obvious that ˆgk(w; h) :=

k+1(w; h)) have similar properties to (3.31)–(3.34).

k,ρ also depend on h, but in fact they

(3.31)

(3.32)

(3.33)

(3.34)

22

k+1, respectively.

k+1 are ”lifts” of fk and

Remark 3.5 (i) Heuristically, (3.31) means that, in a sense, ˆfk and ˆQε
Qε
(ii) By abusing notations, we will simply write fk, gk, Qε
sequel.
(iii) If we assume that Vi is of C ∞
(0 ≤ i ≤ r), then we can actually obtain (3.29) via the
b
deterministic expansion (3.31)–(3.34) on the geometric rough path space (see Inahama [23]).
Under (A1), however, it is not known yet whether this is possible or not.
(iv) There is a simple expression of ˆfk(w, h) when the drift vector ﬁeld V0 ≡ 0. Suppose that
ξl ∈ H (l = 1, 2, . . .) converges to w in GΩH

k+1 for ˆfk, ˆgk, ˆQε

α (Rr). Then,

k+1 in the

k+1, ˆRε

k+1, Rε

ˆfk(w, h) = lim
l→∞

1
k!

Dkφ1(h)hξl, . . . , ξli,

(k-times).

Here, D stands for the Fr´echet derivative on H. (Even when V0 does not vanish, this kind of
expression exists. Since it looks quite complicated due the factor ε2 in front of V0, we omit it,
however.)

In order for F (X ε(1, x, w + h/ε)) to admit expansions as above, F need not be a projection
or a linear map. In the next lemma, we show that for quite general F , it admits expansions in
both senses. The proof is straight forward. So we omit it. We also remark that the expansions
in Lemma 3.6 are uniform in h as h varies in any bounded set in H. (Lemma 3.6 will be used
in the proof of the manifold case, not in the Euclidean case.)
Lemma 3.6 Let F : Rd → Re be a smooth map such that ∇jF is bounded for all j ≥ 1. Then,
we have the following (i)–(ii):
(i) As ε ց 0,

F (X ε(1, x, w +

)) = gF

0 (h) + εgF

1 (w; h) + · · · + εkgF

k (w; h) + Rε,F

k+1(w; h)

h
ε

in D∞(Rd). Here, Rε,F
composition of (3.29) and the Taylor expansion of F . For example,

k+1(w; h) = O(εk+1) in D∞(Rd) and gF

j (w; h) are determined by the formal

gF
0 (h) = F (f0(h)),
gF
1 (w; h) = ∇F (f0(h))hf1(w; h)i,
gF
2 (w; h) = ∇F (f0(h))hf2(w; h)i +

1
2∇2F (f0(h))hf1(w; h), f1(w; h)i

and so on.
(ii) Similarly, if ˆgF
expansion of F , then we have

j (w; h) is determined by by the formal composition of (3.32) and the Taylor

F (x + Φ(τh(εw), λε)1

0,1) = ˆgF

0 (h) + εˆgF

1 (w; h) + · · · + εkˆgF

k (w; h) + ˆRε,F

k+1(w; h),

k and ˆRε,F

where ˆgF
positive constants Ck and C ′
ˆRε,F

k+1(W; h), µ-a.s.

k+1 satisfy essentially the same estimates as in (3.33) and (3.34) (for diﬀerent
k+1(w; h) =

k,ρ). Moreover, we have ˆgF

j (w; h) and Rε,F

j (W; h) = gF

23

ihhwi =

hei, wiHei.

n′Xi=1

(3.35)

Next we will give a simple lemma for Malliavin covariance matrices of X ε(1, x, w + h/ε)
1(w; h)/ε =

and Y ε(1, x, w + h/ε). For any h ∈ H, the Malliavin covariance matrix of Qε
{X ε(1, x, w + h/ε) − f0(h)}/ε is given by

J ε,h
1 K ε,h

t V(X ε,h

t

)V(X ε,h

t

)∗(K ε,h

t

)∗(J ε,h

1 )∗dt = Γ(τh(εW), λε),

σ[Qε

1(· ; h)/ε](w) =Z 1

0

where λε
σ[Rε

t = ε2t, W = L(w) is Brownian rough path and Γ is deﬁned in (3.22). Note that
a ⊂ H. Here, n′ = dimKmin
.

i=1 be an orthonormal basis of ThKmin

1(· ; h)/ε](w) = ΠV σ[Qε
Let h ∈ Kmin

1(· ; h)/ε](w)Π∗
V.

and let {ei}n′

a

a

Set

In fact, hei, · iH ∈ W ∗, as we will see later. Then, the Malliavin covariance of (Rε
D∞(V × ThKmin

) is given by

a

1(w; h)/ε, ih) ∈

σ[(Rε

1(· ; h)/ε, ih)] =(cid:18)σ[Rε

1(· ; h)/ε] Ξ
Ξ∗

Idn′(cid:19) ,

)∗ which is deﬁned by e 7→ ΠVR 1

0 J ε,h

1 K ε,h

t V(X ε,h

t

)e′(t)dt.

where Ξ ∈ V ⊗ (ThKmin

a

The following lemma is essentially Lemma 6.3, [41], rewritten in a rough path way. Let

λ := inf

h∈Kmin

a

inf

z∈V:|z|=1

z∗σ[ψ1](h)z > 0

(3.36)

be the inﬁmum over h of the smallest eigenvalue of σ[ψ1](h).
Lemma 3.7 There exist γ0, ε0 ∈ (0, 1] such that the smallest eigenvalue of σ[(Rε
is greater than (λ ∧ 1)/2 if k(εW)1k4m
and 0 ≤ ε ≤ ε0. Moreover, both γ0 and ε0 can be chosen independent of h ∈ Kmin

α,4m + k(εW)2k2m

2α,2m < γ4m

1(· ; h)/ε, ih)](w)
(i.e., εW ∈ Uγ0), h ∈ Kmin

.

a

a

0

1(· ; h)/ε, ih)](w) is of the form A(τh(εW), λε), where

Proof. The covariance matrix σ[(Rε
(i) A : GΩα,4m(Rr+1) → L(V×ThKmin
map,
(ii) τh stands for the Young translation by h,
(iii) (τh(εW), λε) stands for the Young pairing of τh(εW) and λε. At (h, 0) (or equivalently
when ε = 0) the covariance matrix becomes

) ∼= Mat(n+n′, n+n′) is a certain continuous

,V×ThKmin

a

a

A(h, 0) =(cid:18)σ[ψ1](h) O
Idn′(cid:19) ,

O

which is clearly greater than or equal to λ∧1 as a quadratic form. (Since ThKmin
a ⊂ ker Dψ1(h),
the ”oﬀ-diagonal” components are zero.) Hence we can ﬁnd γ0 and ε0 as in the statement for
each h.

Since A and the Young translation/pairing are Lipschitz continuous on any bounded set,

we may take γ0 and ε0 independently from h ∈ Kmin

a

.

24

In the end of this subsection we discuss a large deviation principle of Freidlin-Wentzell type
for conditional measures. Using the upper estimate of the large deviation principle, we will
prove that contributions from a subset away from L(Kmin
) is negligibly small in the proof of
the asymptotic expansions. Note that we do not need the lower estimate, which probably does
not hold true under our assumptions.

a

Let θε

a be a ﬁnite Borel measure on W which corresponds to the positive Watanabe distri-
1 ) via Sugita’s theorem. Since L is quasi-surely deﬁned, we can lift this measure
a is the law of the random

α,4m(Rd). In other words, µε

x,a] on GΩB

bution δa(Y ε
to a measure µε
variable εW = L(εw) under θε
a.
Set a rate function I : GΩB
α,4m(Rn) → [0,∞] as follows;

a := (εL)∗[θε

I(w) =(khk2

∞

H/2 (if w = L(h) for some h ∈ Ka),

(otherwise).

This rate function I is actually good under (A1). (We can prove this by using Lyons’ continuity
theorem and the goodness of the rate function for the usual Schilder-type large deviation on
the rough path space.)

Theorem 3.8 Assume (A1) and (A2). Then, the family {µε
the following upper bound of a large deviation principle on GΩB
rate function I, that is, for any closed set A ⊂ GΩB

α,4m(Rd),

a}ε>0 of ﬁnite measures satisﬁes
α,4m(Rd) as ε ց 0 with a good

lim sup

εց0

ε2 log µε

a(A) ≤ − inf

w∈A

I(w).

Proof. This was proved in Inahama [24] (under slightly stronger assumptions). The keys of
the proof are Kusuoka-Stroock’s estimate (2.3) and the integration by parts formula (3.1) for
Watanabe distributions. Hence, the same proof works under (A1) and (A2). (The assumptions
in [24] are stronger for the lower bound of the LDP.)

3.4 Basic diﬀerential geometry on Kmin
In this subsection we recall some basic results on Kmin
and ﬁx notations. All the ingredients
in this subsection can be found in Section 6.2, [41]. We assume (A1), (B1), (B2) in this
subsection.

a

a

Let ι : Kmin

a

֒→ H denote the inclusion map. The induced Riemannian metric g on Kmin

is
. The Riemannian volume

a

given by ghhu, vi = h(ι∗)hu, (ι∗)hviH for u, v ∈ ThKmin
measure is denoted by ω.

a

and h ∈ Kmin

a

)⊥ be the second fundamental form deﬁned by

Let Ah : ThKmin

a → (ThKmin
a × ThKmin
Ahhu, vi = π⊥[∇(ι∗)hu(ι∗)hv]

a

for u, v ∈ ThKmin
25

a

and h ∈ Kmin

a

.

Here, ∇ denotes the ﬂat connection on H and π⊥ is a short hand for the orthogonal projection
from H onto the orthogonal complement of (ι∗)h[ThKmin
]. (Precisely, v should be extended to
a vector ﬁeld near h.)
Set ih ∈ D∞(ThKmin

) by

a

a

hu, ihhwiiThKmin

a = h(ι∗)hu, wiH

for u ∈ ThKmin

a

, h ∈ Kmin

a

.

Precisely, the right hand side above is the stochastic extension of the bounded linear map
h(ι∗)hu, · iH : H → R. However, we will see in the next section (Proposition 4.3) that it in fact
extends to a bounded linear map from W to R.

Deﬁne ah ∈ D∞(T ∗

h (Kmin

a

) ⊗ T ∗

h (Kmin

a

)) by

ah(w)hu, vi = hAhhu, vi, wiH

for u, v ∈ ThKmin

a

, h ∈ Kmin

a

.

For the same reason as above, this also extends to a bounded linear map from W (see a local
expression in (3.38) below).

An important remark is that

ah(h)hu, vi = −hu, viThKmin

a

for u, v ∈ ThKmin

a

, h ∈ Kmin

a

.

(3.37)

Note that (3.37) is non-trivial and is a consequence of the fact that Kmin
is a subset of a sphere
in H centered at 0. It can be checked as follows. First, the problem reduces to the case of two-
dimensional sphere embedded in three (or higher) dimensional vector space in a standard way.
Next, the case of the two-dimensional sphere can be shown by straight forward computation.

a

We will write these quantities in a local coordinate (U; θ1, . . . , θn′) of Kmin
∂θi(cid:17) =(cid:16) ∂ι
∂θi(cid:17)h
∂θj(cid:17)hEH
,(cid:16) ∂ι
∂θj(cid:17)h
and (ei)h := {G(h)−1/2}ij(cid:16) ∂

∂θi(cid:17)h
gij(h) =D(cid:16) ∂ι

(ι∗)h(cid:16) ∂

G(h) = (gij(h))1≤i,j≤n′

,

.

a

. Set

(Summation over repeated indices are omitted). By way of construction, {(ei)h}n′
thonormal basis of ThKmin

. Using this we can write down ih and ah as follows:

a

i=1 is an or-

ih(w) = h(ι∗)h(ei)h, wiH(ei)h,

ah(w)h(ei)h, (ej)hi = G(h)−1/2
= G(h)−1/2

∂θk(cid:17)h
∂θl(cid:17)hEG(h)−1/2
,(cid:16) ∂ι
ik ah(w)D(cid:16) ∂ι
hD(cid:16) ∂2ι
∂θk∂θl(cid:17)h
, wEH
∂θk∂θl(cid:17)h
, (ι∗)h(em)hEHh(ι∗)h(em)h, wiHiG(h)−1/2
−D(cid:16) ∂2ι

ik

lj

lj

.(3.38)

Deﬁne

∆(h)(w) = δ0(ih(w)) ∈ ˜D−∞ and D(h)(w) = det[−ah(w)] ∈ D∞,

26

Since Kmin

a ∋ h 7→ ∆(h)D(h) ∈ ˜D−∞ is continuous, the ˜D−∞-valued integration

, wEHon′

i,j=1i · δ0(cid:16)n(cid:10)(cid:16) ∂ι
∂θi(cid:17)h

, w(cid:11)Hon′

i=1(cid:17) ∈ ˜D−∞.

1

pdet G(h)
dethn−D(cid:16) ∂2ι
∂θi∂θj(cid:17)h
ZU

∆(h)D(h)ω(dh)

where δ0 stands for the delta function at 0 on ThKmin
of ih(w) is the identity matrix. In a local coordinate they can be written as follows:

. Note that Malliavin covariance matrix

a

∂θi(cid:17)h
∆(h)(w) =pdet G(h) · δ0(cid:16)n(cid:10)(cid:16) ∂ι

where δ0 stands for the delta function at 0 on Rn′, and

i=1(cid:17),
, w(cid:11)Hon′

D(h)(w) = det G(h)−1

∂θi∂θj(cid:17)h
× dethn−D(cid:16) ∂2ι

, wEH

∂θi∂θj(cid:17)h
+D(cid:16) ∂2ι

, (ι∗)h(em)hEHh(ι∗)h(em)h, wiHon′
i,j=1i.

Hence,

∆(h)(w)D(h)(w) =

is well-deﬁned, where ω(dh) =pdet G(h)dθ1 · · · dθn′ is the Riemannian volume measure.

4 Some computations of skeleton ODE

In this section we compute the skeleton ODE under (A1) and (B1). We do not assume
(A2), (B2) or (B3) for a while. The main point is that if h ∈ Kmin
then φ(h) satisﬁes (the
conﬁguration component of) a Hamiltonian ODE for a naturally deﬁned Hamiltonian. The
key in the proof of this fact is the Lagrange multiplier method. This kind of argument has
been known for a long time (see probabilistic literatures such as Bismut [7], Ben Arous [6] or
sub-Riemannian geometric literatures such as [10, 34, 36]). Our exposition basically follows
Section 2.2, Riﬀord [36]. However, we take a new look at this well-known argument from a
viewpoint of rough path theory and slightly modify it. For example, the Lagrange multiplier
q(h), the key quantity in this argument, can be understood in a rough path way.

a

First we give some formulae for the skeleton ODE (2.2). In the sequel D also stands for the
Fr´echet derivative on H. Let φt(h) be the solution of the skeleton ODE driven by h ∈ H and
set ψt(h) = ΠVφt(h). For simplicity, we set V = [V1, . . . , Vr] which is a (d × r)-matrix.

By straight forward computation,

Dφt(h)hki = Jt(h)Z t

0

Js(h)−1V(φs(h))dks

(k ∈ H).

(4.1)

27

From this expression, Dφt(h) and Dψt(h) = ΠVDφt(h) extend to continuous linear maps from
W to Rd and to V, respectively. In a similar way, we have

D2φt(h)hk, ˆki = Jt(h)Z t

0

Js(h)−1n∇2V(φs(h))hDφs(h)hki, Dφs(h)hˆki, dhsi

+∇V(φs(h))hDφs(h)hki, dˆksi
+∇V(φs(h))hDφs(h)hˆki, dksio

(k, k′ ∈ H)

(4.2)

and D2ψt(h) = ΠVD2φt(h). Note that |D2φt(h)hk, ˆki| ≤ CkkkHkˆkkW for some positive constant
C = C(h) which actually depends only on khkH.
H/2 under the constraint ψ1 = a. Due
to non-degeneracy of Dψ1(h), we have the following; for any h ∈ Kmin
, there exists a unique
q = q(h) ∈ V ∗ ∼= V such that the function

We apply the Lagrange multiplier method to k · k2

a

is stationary at h, that is,

H ∋ ˆh 7→

1
2kˆhk2

H − hq(h), ψ1(ˆh) − aiV

hh, kiH = hq(h), Dψ1(h)hkiiV

(k ∈ H, h ∈ Kmin

a

).

(4.3)

Hence, hh, · iH ∈ W ∗ for any h ∈ Kmin
If we choose an orthonormal basis of V and set n = dim V, then we can easily see from
the above relation and (A1) that q(h) has the following explicit expression in this coordinate
system:

.

a

q(h)i =

{σ[ψ1](h)−1}ijDψj

1(h)hhi

(1 ≤ i ≤ n).

(4.4)

Therefore, if we assume (B2) in addition, then h → q(h) is smooth from Kmin
to V. (We will
see later that h → q(h) extends to a continuous map from the geometric rough path space
under (A1) and (B1)).
We now introduce a Hamiltonian and a Hamiltonian ODE which are naturally associated

a

nXj=1

with the skeleton ODE. Deﬁne

H(x, p) =

1
2

rXi=1

hp, Vi(x)i2

((x, p) ∈ Rd × Rd ∼= T ∗Rd),

where the bracket denotes the pairing of a tangent vector and a covector. This is called a

Hamiltonian function and clearly smooth on Rd × Rd ∼= T ∗Rd.

The Hamiltonian ODE is given by

dxt
dt

dpt
dt

=

∂H
∂p

(xt, pt) =

rXi=1

= −

∂H
∂x

(xt, pt) = −

Vi(xt)hpt, Vi(xt)i,

rXi=1

hpt,∇Vi(xt)ihpt, Vi(xt)i.

(4.5)

(4.6)

28

Since we always assume x0 = x, dependence on x will be suppressed. The solution with the
initial condition (x, p0) is denoted by (xt(p0), pt(p0)).

In the natural coordinate x = (x1, . . . , xd) of Rd, we can write p =Pd

i (x)(∂/∂xj). Moreover,

j=1 V j

j=1 pjdxj and Vi(x) =

Pd

hp, Vi(x)i =

dXj=1

pjV j

i (x) ∈ R and hp,∇Vi(x)i =

pj

∂V j
i
∂xk (x)dxk.

dXj,k=1

Therefore, the Hamiltonian ODE (4.5)–(4.6) above can also be expressed as follows:

V k
i (xt)

pj,tV j

i (xt),

dxk
t
dt

=

∂H
∂pk

(xt, pt) =

rXi=1

dpk,t
dt

= −

∂H
∂xk (xt, pt) = −

dXj=1
dXj=1

pj,t

rXi=1

∂V j
i
∂xk (xt)

dXl=1

pl,tV l

i (xt).

We do not prove that a unique global solution exists for a given initial condition because it is
unnecessary for our purpose.

A remarkable fact is that the solution φt(h) of the skeleton ODE for h ∈ Kmin

expressed as the ”conﬁguration component” of the Hamiltonian ODE.
Proposition 4.1 Assume (A1) and (B1). Let h ∈ Kmin
and denote by q(h) the Lagrange
multiplier given in (4.3). Then, a unique global solution of the Hamiltonian ODE with the
initial condition p0 = hq(h), ΠVJ1(h)•iV ∈ T ∗
Moreover, hi

Rd(∼= Rd) exists and satisﬁes that xt(p0) ≡ φt(h).

can be

x

a

a

0hps(p0), Vi(xs(p0))ids (1 ≤ i ≤ r).

t ≡R t

Proof. For simplicity of notations. we assume that V = Rn × {0d−n}, where n = dimV.
(Without loss of generality we may do so.) Then, ΠV = [Idn|0n×(d−n)]. J and J −1 are d × d
matrices and V is a d × r matrix. q(h) and p are regarded as an n-dimensional and s d-
dimensional row vector, respectively.

From (4.1) and (4.3) we have

q(h)ΠVJ1(h)J −1

s (h)V(φs(h))k′

sds.

Since k ∈ H is arbitrary, we can easily see that

(h1

t , . . . , hr

q(h)ΠVJ1(h)J −1

s (h)V(φs(h))ds.

Z 1
0 hh′

s, k′

0

sids =Z 1
t ) ≡Z t

0

Deﬁne xt = φt(h) and pt = q(h)ΠVJ1(h)J −1
0 psV(φs(h))ds. The skeleton ODE can be rewritten as

t

(h). Clearly, p0 = q(h)ΠV J1(h) and (h1

t , . . . , hr

t ) ≡

R t

dφt(h) =

rXi=1

Vi(φt(h))dhi

t =

rXi=1

29

Vi(φt(h))[ptVi(φt(h))]dt,

which means that (4.5) is satisﬁed. From the ODE for J −1

t = Kt, we can see that

p′

t = q(h)ΠVJ1(h)h−J −1

t

(h)

rXi=1

t)′i
∇Vi(φt(h))(hi

= −pt

Thus, (4.6) is also satisﬁed.

rXi=1

∇Vi(φt(h))[ptVi(φt(h))].

Remark 4.2 In Proposition 3.1 above, the Hamiltonian H is of course constant along the
trajectory of t 7→ (xt(p0), pt(p0)). From the explicit form of h we can easily see that the constant
is d2
H/2 > 0. Furthermore, this implies that the smooth path t 7→ xt(p0) = φt(h) is
regular, that is, its velocity vector never vanishes. Indeed,

a/2 = khk2

hpt(p0), φ′

t(h)i =Dpt(p0),

rXi=1

Vi(φt(h))hpt(p0), Vi(φt(h))iE = 2H(xt(p0), pt(p0)) ≡ d2

a > 0

for any t. Here, we denote by h⋆,•i the pairing of a covector and a tangent vector.

Thanks to the above proposition, we know that if h ∈ Kmin

, then both h and φ(h) are
smooth in t. This fact is highly non-trivial since a generic element of H is not even of C 1.
Moreover, we have the following proposition:

a

Proposition 4.3 Assume (A1), (B1) and (B2). Then, the mappings (t, h) 7→ φt(h) and
(t, h) 7→ ht are smooth from [0, 1] × Kmin

to Rd and to Rr, respectively.

a

Proof. Assume that Hamiltonian ODE (4.5)–(4.6) has a unique global solution for an initial
condition (x, ˆp0). Then, a standard cut-oﬀ technique and smoothness of H shows that there is
an open neighborhood U of ˆp0 such that (i) a unique global solution exists for any (x, p0) with
p0 ∈ U and (ii) the mapping [0, 1] × U ∋ (t, p0) 7→ (xt(p0), pt(p0)) ∈ Rd × Rd is smooth.
xt(p0) = φt(h) is also smooth. Smoothness of (t, h) 7→ ht is immediate if we recall

∋ h 7→ p0 = hq(h), ΠVJ1(h)•iV is smooth under (B2), we see that (t, h) 7→

Since Kmin

a

∂
∂t

This completes the proof.

(h1

t , . . . , hr

t ) ≡ q(h)ΠVJ1(h)J −1

t

(h)V(φt(h)).

The continuity of the natural lift map L|H : H ֒→ GΩB

α,4m(Rr) means that the rough path
topology, restricted on L(H), is weaker than H-topology. The next proposition claims that on
L(Kmin

) the two topologies are in fact the same.

a

30

Proposition 4.4 Assume (A1) and (B1). Let h1, h2, . . . , h∞ ∈ Kmin
in H if and only if limj→∞ L(hj) = L(h∞) in GΩB

α,4m(Rr).

a

. Then, limj→∞ hj = h∞

Proof. By setting (w, λ) = (L(h), 0) in (3.20), we see that h 7→ (h, φ(h), J(h), J −1(h)) extends
α′(Rr ⊕ Rd ⊕ Mat(d, d) ⊕ Mat(d, d)) for any α′ ∈
to a continuous map from GΩB
(1/3, α − 1/(4m)). From this and (4.1) we see that

α,4m(Rr) to GΩH

h 7→ Dψ1(h)hhi = ΠVJ1(h)Z 1

0

Js(h)−1V(φs(h))dhs

α,4m(Rr) since the right hand side can be regarded as
extends to a continuous map from GΩB
a rough path integral along the natural lift of (h, φ(h), J(h), J −1(h)). Also, the deterministic
α,4m(Rr). Hence, from
Malliavin covariance h 7→ σ[ψ1](h) extends to a continuous map from GΩB
the explicit expression (4.4), we see that Kmin
∋ h 7→ q(h) is continuous with respect to the
rough path topology. Therefore, as h ∈ Kmin
varies continuously with respect to the rough
path topology,

a

a

d
dt

(h1

t , . . . , hr

t ) ≡ q(h)ΠV J1(h)J −1

t

(h)V(φt(h))

varies continuously with respect to L2([0, 1], Rr)-topology. Thus, limj→∞ L(hj) = L(h∞) in
GΩB

α,4m(Rr) implies limj→∞ khj − h∞kH = 0. The converse implication is obvious.

Remark 4.5 Since the rate function in a Schilder-type large deviation principle on the rough
α,4m(Rr)-topology under (A1). If we
path space is good, Kmin
assume (B1) in addition, the above proposition implies that it is also compact with respect to
H-topology. From this viewpoint, the compactness assumption in (B2) is no strong.

is compact with respect to GΩB

a

Besov rough path topology instead of the norm {|w1|2 +R 1

The following lemma is essentially a rough path version of Lemma 6.2, [41]. We use (α, 4m)-
In the statement
of this lemma, a ”neighborhood” means a neighborhood with respect to H-topology. Due
to Proposition 4.4, the assertion (i) clearly holds if γ is small enough since {Uh,γ | γ > 0}
forms a fundamental system of neighborhood of L(h) with respect to (α, 4m)-Besov rough path
topology.

0 |ws|2ds}1/2.

a

Lemma 4.6 Assume (A1), (B1) and (B2). For any h ∈ Kmin
neighborhood O ⊂ Kmin
O′ of O, there exists γ > 0 such that
| L(k) ∈ Uh,γ} ⊂ O′.
(i) {k ∈ Kmin

, there exists a coordinate
of h which satisﬁes the following property: For any subneighborhood

(ii) RO′ D(k)∆(k)ω(dk) = 1 on {w ∈ W | L(w) ∈ Uh,γ}, that is, for any F ∈ ˜D∞ such that
F · 1{L(w)∈Uh,γ } = F a.s., it holds that E[FRO′ D(k)∆(k)ω(dk)] = E[F ].

a

a

31

Proof. The proof here is essentially the same as the proof of Lemma 6.2, [41]. We use Propo-
sition 4.3 and the inverse function theorem. We denote by W B
α,4m the Banach space of all the
elements in W with ﬁnite (α, 4m)-Besov norm. The injection Kmin
֒→ H is denoted by ι, which
will be sometimes omitted when the notation gets too heavy.
and a coordinate neighborhood O of h arbitrarily. Let Q be an open subset
of Rn′ such that Q ∋ (θ1, . . . , θn′) 7→ k(θ) = k(θ1, . . . , θn′) ∈ O is diﬀeomorphic (namely,
k : Q ∼= O is a chart map).

Take h ∈ Kmin

a

a

We consider

and

∂2ι

∂θi∂θj(cid:12)(cid:12)(cid:12)k(θ)
1ERr −Z 1
0 Dwt,
1ERr −Z 1
0 Dwt,

∂
∂θi k(θ)′
∂2
∂θi∂θj k(θ)′

=n ∂2
∂θi∂θj k(θ)to0≤t≤1

.

dt,

tERr
∂
∂θi k(θ)′′
tERr
∂2
∂θi∂θj k(θ)′′

dt.

An integration by parts on [0, 1] immediately yields

∂ι

∂θi(cid:12)(cid:12)(cid:12)k(θ)
=n ∂
∂θi k(θ)to0≤t≤1
∂θi(cid:12)(cid:12)(cid:12)k(θ)
, wEH
= Dw1,
D ∂ι
∂θi∂θj(cid:12)(cid:12)(cid:12)k(θ)
D ∂2ι
, wEH
= Dw1,

From Proposition 4.3, these two functions are deﬁned for all (θ, w) ∈ Q×W B
α,4m and continuous
with respect to the product topology. (In particular, for each ﬁxed θ these two linear functionals
on H continuously extends to ones on W B
α,4m or W.) Moreover, they are smooth in θ for any
ﬁxed w and their derivatives are all continuous in (θ, w), too.

Set

∂θi(cid:12)(cid:12)(cid:12)k(θ)
f (θ, w) = −hD ∂ι
∂θi∂θj(cid:12)(cid:12)(cid:12)k(θ)
Jf (θ, w) = −hD ∂2ι

, wEHi1≤i≤n′
, wEHi1≤i,j≤n′

,

,

where the latter is the Jacobian matrix of the former with respect to the θ-variable. Then, we
can easily check that f (θ, k(θ)) = 0 and Jf (θ, k(θ))ij = gij(k(θ)), where (gij) is the Riemannian
metric tensor on Kmin
. (We omit the proof because it is a routine. See pp. 215–216, [41].
However, we note that the fact that Kmin
is a subset of a sphere is crucial here.) For each ﬁxed
θ, f is an Rn′-valued linear functional which is non-degenerate in the sense of Malliavin since
its Malliavin covariance matrix is given by (gij). Also, Jf is linear in w and det Jf is just a
polynomials in w.

a

a

Then, we can show the existence of ρ′ > 0 and γ′ > 0 such that

For each ﬁxed w, we use the inverse function theorem for f (· , w) and carefully keep track
of the dependence on w. We will write h = k(θ0), Qρ(θ0) = {θ | |θ − θ0| < ρ} ⊂ Q and
Bγ(h) = {w | kw − hkα,4m−B < γ} for ρ, γ > 0.
(a) for each w ∈ Bγ′(h), Qρ′(θ0) ∋ θ 7→ f (θ, w) ∈ f (Qρ′(θ0), w) is diﬀeomorphic and
(b) for each ρ ∈ (0, ρ′), there exist γ ∈ (0, γ′) such that ∩{f (Qρ(θ0), w) | w ∈ Bγ(h)} contains
0 ∈ Rn′ as an interior point and the assertion (i) holds.

32

(Though it is not diﬃcult, it is not so obvious, either. Find a nice textbook on calculus and
modify a proof in it. Note also that the implicit function theorem is not used here.) We write
Oρ = {k(θ) | θ ∈ Qρ(θ0)}, which is the subneighborhood O′ in the statement of the lemma.
Let χ : Rn′ → [0,∞) be a smooth, radial function with compact support such thatR χ = 1.
It is well-known that χκ := κ−n′χ(· /κ) → δ0 as κ ց 0 in S′(Rn′). If κ > 0 is suﬃciently small,

ZQρ(θ0)

det Jf (θ, w)χκ(f (θ, w))dθ = 1

for all w ∈ Bγ(h).

If F is supported in {w | L(w) ∈ Uh,γ} ⊂ Bγ(h),

EhFZQρ(θ0)

det Jf (θ, · )χκ(f (θ, · ))dθi = E[F ].

There exists constant l > 0 independent of θ such that χκ(f (θ, · )) → δ0(f (θ, · )) = δ0(−f (θ, · ))
in Dp′,−l-norm for any p′ ∈ (1,∞) uniformly in θ. Since F ∈ Dp,l for some p = p(l) ∈ (1,∞),
we have

Since ω(dk) =pdet G(k(θ))dθ, where G = (gij) is the Riemannian metric tensor, the left hand

side is equal to

EhFZQρ(θ0)

det Jf (θ, · )δ0(−f (θ, · ))dθi = E[F ].
EhFZOρ

D(k)∆(k)ω(dk)i.

Thus, we have shown (ii).

Remark 4.7 (1) By carefully examining the proof, we can slightly strengthen the assertion
(ii), Lemma 4.6 as follows: For any ε ∈ (0, 1],

RO′ D(k)(εw)∆(k)(εw)ω(dk) = 1 on {w | L(εw) ∈ Uh,γ}

for the same γ > 0 as in Lemma 4.6. The proof is essentially the same, but we should note
that f (θ, εw), Jf (θ, εw), etc. are well-deﬁned since f (θ, · ), Jf (θ, · ), etc. are continuous maps
from W.
(2) It is almost obvious that if (i), (ii) in Lemma 4.6 hold for some γ > 0, then they still hold
for any ˆγ ∈ (0, γ). In other words, we may replace γ in Lemma 4.6 by any smaller positive
constant.

5 Exponential integrability lemmas

In this section we will see that the positivity of Hessian assumed in (B3) implies exponential
integrability of a corresponding quadratic Wiener functional. In this section we assume (A1)
and (B1)–(B3).

33

Let (−τ0, τ0) ∋ τ 7→ c(τ ) ∈ Ka be a smooth curve in Ka such that c(0) = h ∈ Kmin

and
)⊥ =: H0(h) as in (B3). Then, a straight forward calculation

0 6= k := c′(0) ∈ ThKa ∩ (ThKmin
shows that

a

a

H

H

2

2

=

d2

d2

kc(τ )k2

− hq(h), ψ1(c(τ )) − ai(cid:17)

dτ 2(cid:12)(cid:12)(cid:12)τ =0(cid:16)kc(τ )k2
dτ 2(cid:12)(cid:12)(cid:12)τ =0
H + hc′′(0), c(0)iH −(cid:10)q(h), Dψ1(c(0))hc′′(0)i(cid:11) −(cid:10)q(h), D2ψ1(c(0))hc′(0), c′(0)i(cid:11)
= kc′(0)k2
H −(cid:10)q(h), D2ψ1(h)hk, ki(cid:11).
= kkk2
It is known that the symmetric bounded bilinear form (cid:10)q(h), D2ψ1(h)h•, ⋆i(cid:11) is Hilbert-
Schmidt and so is (cid:10)q(h), D2ψ1(h)hπh•, πh⋆i(cid:11), where πh : H → H0(h) is the orthogonal pro-

jection (an explicit form of πh will be given in (5.6) below). As a result, the spectra of their
corresponding symmetric operators are discrete except at 0. Consequently, the condition (B3)
implies that

The cancelation above was due to the Lagrange multiplier method (4.3).

(5.1)

C(h) := supn 1

2(cid:10)q(h), D2ψ1(h)hπhv, πhv′i(cid:11)V (cid:12)(cid:12)(cid:12) v, v′ ∈ H,kvkH = kv′kH = 1o <

From the explicit expressions of D2ψ1(h), q(h) and πh in (4.2), (4.4) and (5.6), we can easily
see that

1
2

.

(5.2)

is continuous with respect to the topology of bounded bilinear forms. This implies the continuity
of h 7→ C(h) and

Therefore, if Ξh ∈ C2 corresponds to the symmetric Hilbert-Schmidt bilinear form in (5.3),
namely the bilinear form is equal to (1/2)D2Ξh, then E[ec1Ξh] ≤ M < ∞ for certain constants
c1 > 1 and M > 0 independent of h ∈ Kmin
The following lemma is Lemma 6.1, [41], which states that the quadratic Wiener functional
that appear as the second term of the Taylor-like expansion of Itˆo map is exponentially in-
tegrable with respect to the conditional Gaussian measure. Though g2 can be written as a
iterated stochastic integral of second order, we do not use it. Our proof uses rough path theory
and can be found in [23] in a more detailed way. For the deﬁnition of ih and gi (i = 0, 1, 2, . . .)
see (3.35) and (3.29), respectively.

.

a

Lemma 5.1 Assume (A1) and (B1)–(B3). Then, there exists a constant c1 > 1 which is
independent of h ∈ Kmin
sup

Ehexp(cid:0)c1hq(h), g2(w; h)iV(cid:1)δ0(g1(w; h), ihhwi)i < ∞.

and satisﬁes that

h∈Kmin

a

(5.5)

a

Here, δ0 is the Dirac delta function on V × ThKmin

a ∼= Rn+n′.

34

Kmin
a ∋ h 7→

1

2(cid:10)q(h), D2ψ1(h)hπh•, πh⋆i(cid:11)

Cmax := max{C(h) | h ∈ Kmin

a } <

1
2

.

(5.3)

(5.4)

Proof. Let h ∈ Kmin
a ⊂ H. Due to
Proposition 4.3, hei(h), · iH ∈ H∗ naturally extends to an element in W ∗. Recall that g1(· ; h) ∈
W ∗ is the continuous extension of Dψ1(h) ∈ H∗. Then,

i=1 be an orthonormal basis of ThKmin

and let {ei(h)}n′

a

H0(h) = ker g1(· ; h) ∩(cid:0)∩n′

i=1 kerhei(h), · iH(cid:1) = ker g1(· ; h) ∩ ker ih,

which may depend on h, but not on the choice of the orthonormal basis. It is easy to see that
H0(h)⊥ is a ﬁnite dimensional subspace of dimension n + n′. Denote by W0(h) the closure of
H0(h) with respect to the topology of W. The orthogonal projection πh : H → H0(h) naturally
extends to a continuous projection πh : W → W0(h), which we denote by the same symbol.
The ﬁnite Borel measure corresponding to the positive Watanabe distribution δ0(g1(· ; h), ih)
via Sugita’s theorem is (2π)−(n+n′)/2{det σ[ψ1](h)}−1/2 · πh
∗ µ, which is a constant multiple of a
Gaussian probability measure πh
∗ µ) is
an abstract Wiener space.

∗ µ supported on W0(h). It is clear that (W0(h),H0(h), πh

Let us now identify V ∼= Rn by choosing an orthonormal basis of V. (The choice is indepen-

dent of h). Then we have explicitly that

πhw = w −

= w −

nXl,l′=1
{σ[ψ1](h)−1}ll′g1(w; h)l · ♯g1(· ; h)l′
nXl,l′=1
{σ[ψ1](h)−1}ll′g1(w; h)l · ♯g1(· ; h)l′

−

n′Xi=1

hei(h), wiei(h)

− ihhwi

(5.6)

and we set (πh)⊥w = w − πhw ∈ H. Here, g1(w; h)l is the lth component of g1(w; h) =
Dψ1(h)hwi, {σ[ψ1](h)−1}ll′ is the (l, l′)th component of the inverse of the deterministic co-
is the unique element in H that corresponds to
variance matrix σ[ψ1](h) at h,
g1(· ; h)l ∈ W ∗ ⊂ H∗ via the Riesz isometry. Note that ♯g1(· ; h)l and ei(h) are orhogonal
for any l and i.
By abusing notations we write πhW = L(πhw) = liml→∞ L((πhw)(l)). Here, w(l) denotes
the lth dyadic piecewise linear approximation of w and L denotes the rough path lift map
deﬁned by those dyadic approximations. By the explicit formula (5.6) for πhw, we can easily
see that πhW is well-deﬁned a.s. with respect to µ and in fact equal to the Young translation

♯g1(· ; h)l

l,l′=1{σ[ψ1](h)−1}ll′ · g1(w; h)l · ♯g1(· ; h)l′ − ihhwi.

It is shown in [23] that g2 actually has the following form: For some continuous map

= lim

l→∞n1

2

D2ψ1(h)hw(l), w(l)i + ΠV J1(h)Z 1

0

Js(h)−1V0(φs(h))dso.

Then, g2(πhw; h) = ˆg2(πhW, h) is deﬁned with respect to µ. This in turn implies that

g2(w; h) = ˆg2(W, h) is well-deﬁned with respect to πh

∗ µ. Hence, if

Z exp(c1hq(h), g2(w; h)iV)πh

∗ µ(dw) =Z exp(c1hq(h), g2(πhw; h)iV)µ(dw) ≤ M

(5.7)

35

of W by −Pn

ˆg2 : GΩα,4m(Rd) × H → V of ”quadratic order,”

g2(w; h) = ˆg2(W, h)

holds for some M > 0, then the proof of the lemma is done. (Since g2(w; h) = ˆg2(W, h) is
∞-quasi continuous in w, the left hand side above is a constant multiple of the integral in
(5.5).)
Now we show (5.7). It is straight forward to check that E[Dkhq(h), g2(πhw; h)iV] = 0 for all

k ∈ H and D3hq(h), g2(πhw; h)iV = 0. This shows that

hq(h), g2(πhw; h)iV − E[hq(h), g2(πhw; h)iV]

belongs to C2, the second order homogeneous Wiener chaos. The corresponding symmetric
Hilbert-Schmidt bilinear form is easily calculated as

(k, k′)

7→

1
2

k,k′hq(h), g2(πhw; h)iV =
D2

1

2(cid:10)q(h), D2ψ1(h)hπhk, πhk′i(cid:11)V.

From (5.4) and boundedness of E[hq(h), g2(πhw; h)iV] in h, we obtain (5.7).

We give two technical lemmas (Lemmas 5.2 and 5.3) on integrability of certain Wiener
functionals which will appear in the asymptotic expansion. Since the solution of RDE is involved
in these lemmas, we assume for safety that the coeﬃcients are of C ∞
b . In the proofs of these
lemmas we will write gj = gj(w; h), Rε

j(w; h) for simplicity of notations.

j = Rε

The ﬁrst one below corresponds to Lemma 6.4, [41]. Note that the constant γ depends on

r, but not on h with khkH ≤ r.
Lemma 5.2 Assume (A1), (B1)–(B3) and boundedness of Vi (0 ≤ i ≤ r). Then, the follow-
ing assertions (i)–(ii) hold: (i) For any r > 0 and c > 0, there exists γ > 0 such that

(ii) For any r > 0 and c > 0, there exists γ > 0 such that

sup
0<ε≤1

sup

khkH≤r

sup
0<ε≤1

sup

khkH≤r

Ehexp(c|Rε
Ehexp(c|Rε

2(· , h)/ε|2)1Uγ (εW)i < ∞.
3(· , h)|/ε2)1Uγ (εW)i < ∞.

Proof. We use the deterministic estimates (3.31)–(3.34) for the Taylor-like expansion of the
Lyons-Itˆo map and Besov-H¨older embedding for rough path spaces with α′ = α − 1/(4m). If
εW ∈ Uγ′, then

|Rε

j| ≤ C(ε + k(εW)1kα,4m + k(εW)2k1/2

2α,2m)j

for some positive constant C = C(j, γ′, r). We will take γ′ = 1 below. For 0 < γ < 1,

2/ε|2 ≤ cC(ε + γ)2(1 + kW1kα,4m + kW2k1/2

2α,2m)2.

Hence, we have

sup
0<ε≤γ

sup

khkH≤r

c|Rε
Ehexp(c|Rε

2/ε|2)1Uγ(εW)i ≤ Ehexp(cid:0)4cCγ2(1 + kW1kα,4m + kW2k1/2

2α,2m)2(cid:1)i.

By a Fernique-type theorem for Brownian rough path, the right hand side is integrable if γ
is chosen suﬃciently small. Once γ is ﬁxed, we can easily estimate the integral for ε ∈ [γ, 1].
Thus, we have shown assertion (i). The proof of assertion (ii) is essentially the same.

36

The other one is a key technical lemma. It corresponds to Lemma 6.5, [41].

Lemma 5.3 Assume (A1), (B1)–(B3) and boundedness of Vi (0 ≤ i ≤ r). Let c1 > 1 be
as in (5.5) in Lemma 5.1. Then, for any c2 ∈ (1, c1), there exists a constant γ1 > 0 which is
independent of h ∈ Kmin

and satisfy that

a

Ehexp(c2hq(h), Rε

sup
0<ε≤1

sup

h∈Kmin

a

for any κ > 0.

2(· , h)iV/ε2)1Uγ1 (εW) ; |ih|2 + |Rε

1(· , h)/ε|2 ≤ κ2i < ∞

Proof. Thanks to Lemma 5.2, (ii) and H¨older’s inequality, it is suﬃcient to show the following
integrability; For any c2 ∈ (1, c1), there exists γ > 0 such that

sup
0<ε≤1

sup

h∈Kmin

a

Ehexp(c2hq(h), g2iV)1Uγ (εW) ; |ih|2 + |Rε

1/ε|2 ≤ κ2i < ∞

(5.8)

for any κ > 0.

By straight forward computation, we see that

g2(w; h) = lim
l→∞

g2(w(l); h)

2

2

= lim

= lim

D2ψ1(h)hw(l), w(l)i + ΠVJ1(h)Z 1
l→∞n1
D2ψ1(h)h(πhw)(l), (πhw)(l)i + ΠV J1(h)Z 1
l→∞n1
l→∞nD2ψ1(h)h(πhw)(l), ((πh)⊥w)(l)i +
= g2(πhw; h) + D2ψ1(h)hπhw, (πh)⊥wi +

Js(h)−1V0(φs(h))dso
D2ψ1(h)h((πh)⊥w)(l), ((πh)⊥w)(l)io
1
2
D2ψ1(h)h(πh)⊥w, (πh)⊥wi.

Js(h)−1V0(φs(h))dso

+ lim

1
2

0

0

Here, we used basic properties of Young translation and the fact that g2(· ; h) is actually a
continuous function in W = L(w).
There exists a positive constant C (which depends only on khkH and may vary from line to
line) such that

|g2(w; h) − g2(πhw; h)| ≤ C(kπhwkWk(πh)⊥wkH + k(πh)⊥wk2
H)
≤ C(kwkWk(πh)⊥wkH + k(πh)⊥wk2
H)
H(cid:9),
≤ C(cid:8)ρ2
1
2ρ2 + 2)k(πh)⊥wk2

2 kwk2

W + (

(5.9)

where ρ > 0 is a small constant which will be determined later and we used the estimate for
D2φ1 given just below (4.2).

37

1/ε|2 ≤ κ2i
Ehexp(c2hq(h), g2iV)1Uγ (εW) ; |ih|2 + |Rε
1/ε|2 ≤ κ2i 1
≤ Ehexp(c1hq(h), g2 ◦ πhiV)1Uγ (εW) ; |ih|2 + |Rε
×Ehexp(p′c2 max
|q(h)||g2 − g2 ◦ πh|)1Uγ (εW) ; |ih|2 + |Rε
≤ (2π)(n+n′)/2p{det σ[ψ1](h)}1/2pEhexp(c1hq(h), g2iV)δ0(g1, ih)i 1
)(cid:17)1Uγ (εW)i 1
×Ehexp(cid:16)C ′ρ2

2 kwk2

W + C ′(

h∈Kmin

Rε
2

2

p′

a

p

1

2ρ2 + 2)(κ2 +(cid:12)(cid:12)(cid:12)

ε (cid:12)(cid:12)(cid:12)

1/ε|2 ≤ κ2i 1

p′

p

,

(5.10)

Under the condition that |ih|2 + |Rε
2/ε| ≤ κ + |Rε
Rε

2/ε|. From these, we have k(πh)⊥wkH ≤ C(κ + |Rε
|g2(w; h) − g2(πhw; h)| ≤

Cρ2
2 kwk2

W + C(

1/ε|2 ≤ κ2, we can easily see that |g1(w; h)| ≤ |Rε

1/ε −

2/ε|) and
Rε
2

1

2ρ2 + 2)(κ2 +(cid:12)(cid:12)(cid:12)

ε (cid:12)(cid:12)(cid:12)

2

).

Note that C > 0 is independent of κ, ε, ρ, w, h.

Using H¨older’s inequality with p = c1/c2 ∈ (1,∞) and 1/p + 1/p′ = 1, we have

a

where we set C ′ = Cp′c2 maxh∈Kmin
|q(h)|. The ﬁrst factor on the right hand side of (5.10)
above is dominated by a positive constant independent of h ∈ Kmin
, due to (5.5) or (5.7).
Now, we choose ρ so small that exp(C ′ρ2kwk2
W) is integrable, which is possible by Fernique’s
theorem, and use Schwarz’ inequality for the second factor. Then, by Lemma 5.2, (i), we can
choose γ > 0 so that supε suph of the second factor is ﬁnite. Thus, we have shown (5.8), which
completes the proof.

a

Corollary 5.4 Keep the same notations and assumptions as in Lemma 5.3. Then, the follow-
ing (i)–(iii) hold:
(i) For any c2 ∈ (1, c1) and any κ > 0,

(ii) For any smooth function f on V × ThKmin

a

sup

h∈Kmin

a

Ehexp(c2hq(h), g2(· , h)iV) ; |ih|2 + |g1(· , h)|2 ≤ κ2i < ∞.
with compact support,
exp(c2hq(h), g2(· , h)iV)f (g1(· , h), ih) ∈ ˜D∞.

Moreover, as h varies in Kmin
(iii) Let T ∈ S′(V × ThKmin
V × ThKmin

a

a

, these Wiener functionals form a bounded set in ˜D∞.

a
) with compact support. Take any two smooth function f and ˆf on

with compact support such that f ≡ 1 ≡ ˆf on the support of T . Then,

exp(c2hq(h), g2(· , h)iV)f (g1(· , h), ih)T (g1(· , h), ih)
= exp(c2hq(h), g2(· , h)iV) ˆf (g1(· , h), ih)T (g1(· , h), ih) ∈ D−∞.

In particular, the generalized expectations of these two Watanabe distributions also coincide.
Moreover, as h varies in Kmin

, these Watanabe distributions form a bounded set in D−∞.

a

38

Proof. We can easily prove (i) by applying Fatou’s lemma to the inequality in Lemma 5.3.
Noting that

1{|ih|2+|g1( · ,h)|2≤(κ/2)2} ≤ lim inf

εց0

1{|ih|2+|Rε

1( · ,h)/ε|2≤κ2}

for almost all w, we have the desired inequality with κ being replaced by κ/2. Since, κ > 0 is
arbitrary, we have shown (i).

It is straight forward to check (ii) from (i). We now prove (iii). Since T (g1(· , h), ih) is a
well-deﬁned element in ˜D−∞, we see from (ii) that both sides belong to D−∞. To check the
equality, we just have to use f · T = T = ˆf · T as ﬁnite dimensional distributions.

Remark 5.5 We may and will write exp(c2hq(h), g2(· , h)iV)T (g1(· , h), ih) ∈ D−∞ for sim-
plicity in the situation of Corollary 5.4, (iii). Later, we will usually choose T to be a partial
derivative of the delta function. Note that since exp(c2hq(h), g2(· , h)iV) /∈ ˜D∞, the product
exp(c2hq(h), g2(· , h)iV)Φ or its generalized expectation cannot be deﬁned for a general element
Φ ∈ ˜D−∞.

6 Asymptotic partition of unity

In this section, by using rough path theory, we modify the argument on an asymptotic partition
of unity in Section 6.6, [41].

Let f : R → R be an even smooth function such that f (s) = 1 if |s| ≤ 1/2 and f (s) = 0 if
|s| ≥ 1. We also assume that f is non-increasing on [0,∞). Deﬁne, for γ > 0, ε ∈ (0, 1] and
h ∈ H,

ζ ε

γ(w) = f(cid:16)k(εW)1k4m

ζ ε,h
γ (w) = ζ ε

γ(w −

α,4m−B + k(εW)2k2m

2α,2m−B

γ4m

h
ε

) = f(cid:16)kτ−h(εW)1k4m

(cid:17),

γ4m

α,4m−B + kτ−h(εW)2k2m

2α,2m−B

(cid:17).

Here, τ−h stands for the Young translation by −h on the geometric rough path space. Note
that these are D∞-functionals. It is clear that (i) ζ ε
γ = 0 if εW /∈ Uh,γ
γ = 1 if εW ∈ U ′
and (ii) ζ ε
ν=1U ′
hν ,γν , we deﬁne

γ and ζ ε,h
and γ1, . . . , γN > 0 satisfying that L(Kmin

γ = 0 if εW /∈ Uγ and ζ ε,h
h,γ.
) ⊂ ∪N

γ = 1 if εW ∈ U ′
For h1, . . . , hN ∈ Kmin

a

a

χε(w) = 1 −

NYν=1

˜χε
ν(w) = ζ ε,hν
γν

(w)

(1 − ζ ε,hν

γν

(w)),

ν−1Yµ=1

(1 − ζ ε,hµ

γµ (w))

(6.1)

(6.2)

for 1 ≤ ν ≤ N. Loosely speaking, χε(w) = 1 means that εw is close to hν for some ν. Similarly,
˜χε
ν(w) = 1 loosely means that εw is close to hν, but distant from h1, . . . , hν−1. It is clear that

0 ≤ χε ≤ 1 and easy to see thatPN

ν=1 ˜χε

ν = χε.

39

It is easy to see that

ζ ε,hν
γν

(w +

k
ε

) = 1 + O(εl)

in D∞ as ε ց 0 for any l > 0

uniformly in k ∈ L−1(U ′
. (Note that the Wiener functional on the left hand is the
composition of f and a polynomial in ε with the coeﬃcients from an inhomogeneous Wiener
chaos. Therefore, it clearly has an asymptotic expansion in D∞-topology and we just need to
check that the coeﬃcients vanish by formal diﬀerentiation.) In a similar way, we have

hν ,γν ) ∩ Kmin

a

χε(w +

k
ε

) = 1 + O(εl)

in D∞ as ε ց 0 for any l > 0

(6.3)

a

uniformly in k ∈ Kmin
. Note that we have repeatedly used the fact that f (x) = 1 on [−1/2, 1/2].
Now we get back to our SDE/RDE and choose such N, hν and γν (1 ≤ ν ≤ N). Before going
into details, we will explain below why our problem is reduced to the case where Vi (0 ≤ i ≤ r)
is of C ∞

b . (This remark is unnecessary if Vi is of C ∞
b

in the ﬁrst place.)

Remark 6.1 Since the deterministic Itˆo map is continuous under (A1),

R := sup{|x + Φ(h, λε)1

0,t| | t ∈ [0, 1], ε ∈ [0, 1], h ∈ Kmin

a } ∈ (0,∞).

From a result in [2] (or a standard cut-oﬀ argument, alternatively) we see the following: There
exists a neighborhood Λ of L(Kmin

α,4m−B(Rr) such that

) in GΩB

a

sup{|x + Φ(w, λε)1

0,t| | t ∈ [0, 1], ε ∈ [0, 1], w ∈ Λ} ≤ 2R.

Therefore, if we work on the neighborhood, we only need information of Vi restricted on the ball
of radius 2R.

In the argument in the rest of this section, taking γ = γh > 0 smaller if necessary, we have

Uh,γ ⊂ Λ. For these reasons, we may and will assume in the sequel that Vi is of C ∞
b .
(When we throw away contributions from the complement set of a neighborhood of L(Kmin
)
in Lemma 7.1 below, we use the upper bound estimate of the LDP in Theorem 3.8. Hence, it
is important that Theorem 3.8 holds under (A1).)

a

For any h ∈ Kmin

a

topology) and a constant γ = γh > 0 such that the following conditions holds:

, there exists a coordinate neighborhood Oh of h (with respect to H-

for any ε ∈ (0, 1],

sup

k∈Oh(cid:16) n′Xj=1(cid:12)(cid:12)(cid:0) ∂ι

ZOh
∂θj(cid:1)k(cid:12)(cid:12)H +

Kmin
a ∩ Uh,γ = {k ∈ Kmin

| k ∈ Uh,γ} ⊂ Oh.
D(k)(εw)∆(k)(εw)ω(dk) = 1 on {w ∈ W | εW ∈ Uh,γ}.

a

(6.4)

(6.5)

n′Xj,j ′=1(cid:12)(cid:12)(cid:0) ∂2ι

∂θj∂θj ′(cid:1)k(cid:12)(cid:12)H(cid:17) < ∞ and

inf
k∈Oh

det G(k) > 0.

(6.6)

Here, (θ1, . . . , θn′) is the local coordinate of Oh. Note that (6.4) and (6.5) are immediate from
Lemma 4.6 and Remark 4.7. (Note that γ above can be taken smaller if necessary. See Remark
4.7.)

40

We choose any c2 ∈ (0, c1) and ﬁx it, where the positive constant c1, c2 are given in Lemmas
5.1 and 5.3, respectively. Let λ > 0, γ0 > 0 and ε0 ∈ (0, 1] be the constants deﬁned in (3.36)
and Lemma 3.7, respectively. Similarly, let γ1 > 0 constant that appeared in Lemma 5.3.
We write ρ = ρh := supk∈Oh kk − hkH > 0. Then, we can take Oh and γ = γh > 0 so small

that the following inequalities hold:

161/4mCρ

σ = σh :=

≥ 21/4m,
2(1 + 321/4m)4mC 4mρ4m = 2(21/4mσγ + Cρ)4m ≤ γ4m
,
2(γ + Cρ)4m ≤ γ4m
.

γ

0

1

(6.7)

(6.8)
(6.9)

Here, C = Cα,4m > 0 is the smallest constant that satiﬁes the estimates (3.23)–(3.24). It is
easy to check that such ρ and γ exist. First, take Oh (or ρ) small enough and ﬁx it and then
we can retake γ > 0 smaller if necessary for this ﬁxed ρ.

is,

Note that the condition (6.8) immediately implies the following: If εW ∈ Uh−k,21/4mσγ, that
(6.10)

kτk−h(εW)1k4m
holds for k ∈ Oh, then k(εW)1k4m
, because of (3.23), (3.24), (6.8)
and the obvious fact that εW = τ−k+h ◦ τk−h(εW). (Thus, the assumption of Lemma 3.7 is
satisﬁed.) Therefore, under (6.10) we have

α,4m−B + kτk−h(εW)2k2m
α,4m−B +k(εW)2k2m

2α,2m−B ≤ 2σ4mγ4m

2α,2m−B ≤ γ4m

0

inf
k∈Oh

inf

z:|z|=1

z∗σ[(Rε

1(· ; k)/ε, ik)](w)z ≥

λ ∧ 1
2

Likewise, if kτk−h(εW)1k4m

and (6.9) implies that k(εW)1k4m
for k ∈ Oh. Therefore, by Lemma 5.3,

α,4m−B +kτk−h(εW)2k2m
α,4m−B + k(εW)2k2m

if ε ∈ (0, ε0] and εW ∈ Uh−k,21/4mσγ.
2α,2m−B ≤ γ4m for k ∈ Oh, then (3.23), (3.24)
2α,2m−B ≤ γ4m
. In other words, Uh−k,γ ⊂ Uγ1

(6.11)

1

sup
0<ε≤1

sup
k∈Oh

for any κ > 0.

Ehexp(cid:16) c2

ε2hq(k), Rε

2(w; k)iV(cid:17)1Uh−k,γ (εW) ; |ik|2 +(cid:12)(cid:12)(cid:12)

Rε

1(w; k)

ε

2

(cid:12)(cid:12)(cid:12)

≤ κ2i < ∞ (6.12)

Thus, we have shown the following lemma:

Lemma 6.2 Assume (A1) and (B1)–(B3). For any h ∈ Kmin
that (6.4), (6.5), (6.6), (6.11), (6.12) hold.

a

, we can ﬁnd Oh and γh such

a

a

a

ν=1U ′

) ⊂ ∪N

is compact, there exist ﬁnitely many h1, . . . , hN ∈ Kmin

hν ,γν , where we wrote γν = γhν for simplicity (1 ≤ ν ≤ N).

and γ1, . . . , γN > 0 such
In the
ν the asymptotic partition of unity deﬁned in (6.1)–(6.2)
ν=1.

Since Kmin
that L(Kmin
next section we denote by χε and ˜χε
associated with these data {(hν, γν)}N
ν in (6.1)–(6.2) depend only on N and {(hν, γν)}N
Remark 6.3 The deﬁnitions of χε and ˜χε
ν=1
and information of the SDE is not involved directly. (Of course, in choosing these data we
used information of the SDE, but that is not the point here.) Therefore, our version of the
asymptotic partition of unity is much simpler than the one in [41] and looks more powerful.
This is one of the advantages of our rough path approach.

41

7 Proof of the main thorem: The Euclidean case

In this section we prove our main theorem in the Euclidean setting (Theorem 2.2). We assume
(A1)–(A2), (B1)–(B3) and (C1) throughout this section. We set Gε(w) = G(ε, w) below.
Deﬁne

E[Gεδa(Y ε

1 )] = E[(1 − χε)Gεδa(Y ε

1 )] + E[χεGεδa(Y ε

1 )] =: I1(ε) + I2(ε).

(7.1)

Due to the large deviation upper bound (Theorem 3.8), the ﬁrst term I1(ε) does not contribute
to the asymptotic expansion.

Lemma 7.1 There exist positive constants c, C such that

|I1(ε)| ≤ C exp(cid:0)−

Here, da = inf{khkH | ψ(1, x, h) = a}.

d2
a + c

2ε2 (cid:1)

as ε ց 0.

Proof. We use notations in Theorem 3.8. By the way of construction, 1 − χε is dominated by
1{εW∈Oc} for some open set O ⊂ GΩB
(1 − χε) ˜Gεθε

α,4m(Rd) containing Kmin

. Therefore, we have

θε

a

a(Oc)1/pnZW | ˜Gε|p′

a(dw)o1/p′

for any p, p′ ∈ (1,∞) with 1/p + 1/p′ = 1. Here, ˜Gε is an ∞-quasi continuous modiﬁcation of
Gε.
a/2.

Since Oc is closed and the rate function I is good, it is easy to see that inf w∈Oc I(w) > d2

|I1(ε)| =(cid:12)(cid:12)(cid:12)ZW

a(dw)(cid:12)(cid:12)(cid:12) ≤ µε

Set κ := (inf w∈Oc I(w) − d2

a/2)/4 > 0. By Theorem 3.8 we have

µε

a(Oc)1/p = O(cid:16)exp(cid:0)− inf w∈Oc I(w) + κ

pε2
as ε ց 0 if p > 1 is suﬃciently close to 1.

(cid:1)(cid:17) ≤ O(cid:16)exp(cid:0)− inf w∈Oc I(w) + 2κ

ε2

(cid:1)(cid:17)

On the other hand, when p′ = 2l with arbitrarily large l ∈ N,

ZW | ˜Gε|2lθε

a(dw) = E[(Gε)2lδa(Y ε

1 )] ≤ k(Gε)2lkj,2kδa(Y ε

1 )k−j,2

for some j ∈ N such that δa(Y ε
1 ) belongs to the Sobolev space D−j,2 (j is independent of l).
1 )k−j,2 = O(ε−ν) as ε ց 0 for some ν > 0. (This comes
Moreover, it is well-known that kδa(Y ε
from (A2) and the integration by parts formula.) Since we assumed in (C1) that Gε is bounded
in D∞, (Gε)2l is bounded in Dj,2 for any l, j. Combining these all, we obtain

|I1(ε)| = O(cid:16)exp(cid:0)− inf w∈Oc I(w) + 3κ

ε2

as ε ց 0. If we set c = 2κ this is the statement of the lemma.

(cid:1)(cid:17)

42

Hence, the problem reduces to the asymptotic expansion for I2(ε) =PN

1 )].
For the reason we stated in Remark 6.1, we may additionally assume that Vi (0 ≤ i ≤ r) is
bounded. Now we compute each summand.

νGεδa(Y ε

E[ ˜χε

ν=1

0 (V, R) with η ≥ 0 andRV η(y)dy = 1 and set ηl(y) = lnη(ly) for l = 1, 2, . . ..

1 ) as l → ∞ in ˜D−∞. Noting that ˜χε

ν(w)1{εW∈Uhν ,γν } by

ν(w) = ˜χε

Then, ηl(Y ε
deﬁnition, we have from (6.5) that

1 − a) → δa(Y ε

Take η ∈ C ∞

E[ ˜χε

νGε · ηl(Y ε

νGε · ηl(Y ε

1 − a)] = E[ ˜χε
= ZOν

D(k)(εw)∆(k)(εw)ω(dk)
]

1 − a) ·ZOν
}
|
1 − a) · D(k)(εw)∆(k)(εw)]ω(dk),

{z

=1

E[ ˜χε

νGε · ηl(Y ε

(7.2)

where we set Oν = Ohν .

Let (θ1, . . . , θn′) is the local coordinate of Oν and let ˆOν ⊂ Rn′ be the image of Oν.
β=1 =
a ⊂ H. We
β=1, which is a continuous linear map from W to Rn′. (Recall that
β=1heβ(θ), wieβ(θ), which is almost the same as e(θ, w), but it takes values in

As before k ∈ Oν is denoted by k(θ), θ ∈ ˆOν. Set G(θ) = G(k(θ)) and [eβ(θ)]n′
G(θ)−1/2[(∂k/∂θβ)(θ)]n′
set e(θ, w) = [heβ(θ), wi]n′
ik(θ)hwi = Pn′

.) By deﬁnition we have D(k(θ))(εw)∆(k(θ))(εw) = det[−εak(θ)(w)]δ0(εe(θ, w)).

β=1 is an orthonormal basis of Tk(θ)Kmin

β=1. Then, {eβ(θ)}n′

Combining these with the Cameron-Martin translation by k(θ)/ε, we see that

Tk(θ)Kmin

a

E[ ˜χε

νGεηl(Y ε

1 − a)]

νGεηl(Y ε

1
εhk(θ), wiH −

1 − a) det[−εak(θ)]δ0(εe(θ, · ))(cid:3)pdet G(θ)dθ

= Z ˆOν
E(cid:2) ˜χε
= Z ˆOν
Ehexp(cid:16)−
× det[−εak(θ)(w) − ak(θ)(k(θ))]δ0(cid:0)εe(θ, w) + e(θ, k(θ))(cid:1)ipdet G(θ)dθ
2ε2(cid:1)Z ˆOν
= exp(cid:0)−
×ηl(Rε

ε
1(w; k(θ))) det[Idn′ − εak(θ)(w)]ζ ε,hν

Ehe−hk(θ),wiH/ε ˜χε

H(cid:17) ˜χε
1
2ε2|k(θ)|2

σν γν (w +

)G(ε, w +

)G(ε, w +

ν(w +

ν(w +

k(θ)

k(θ)

k(θ)

k(θ)

k(θ)

d2
a

ε

ε

ε

ε

)

)ηl(Y ε,k(θ)

1

− a)

)δ0(cid:0)εe(θ, w)(cid:1)ipdet G(θ)dθ. (7.3)

Here, we used the following facts: (i) e(θ, k(θ)) = 0, (ii) ak(θ)(k(θ)) = −Idn′ by (3.37), and
(iii)
σν γν (w + k(θ)/ε), which is immediate from f (s) =
f (s)f (s/σ4m

˜χε
ν(w + k(θ)/ε) = ˜χε

ν(w + k(θ)/ε)ζ ε,hν

ν ) for all s ∈ R, due to (6.7).

Now we apply Proposition 3.1 with F (w) = (Rε
ε (w) := kτk(θ)−hν (εW)1k4m

ξ(w) = ξ(ν)

1(w; k(θ))/ε, e(θ, w)), χ = f ,

α,4m−B + kτk(θ)−hν (εW)2k2m

2α,2m−B

.

ν γ4m
σ4m

ν

Note that ξ(w) is just a polynomial of order 4m and χ(ξ) = ζ ε,hν
σν γν (w + k(θ)/ε), which is on
the right hand side of (7.3). As we have seen in (6.10) and (6.11), |ξ(w)| ≤ 2 implies that the

43

smallest eigenvalue of σ[F ] is greater than or equal to (λ∧ 1)/2. Hence, we can use Proposition
3.1 to obtain that, for each 0 < ε ≤ ε0,
k(θ)

lim
l→∞

ζ ε,hν
σν γν (w +

= ζ ε,hν

σν γν (w +

ε
k(θ)

ε

)ηl(Rε

1(w; k(θ)))δ0(cid:0)εe(θ, w)(cid:1)
1(w; k(θ)), εe(θ, w)(cid:1)

)δ0(cid:0)Rε

in ˜D−∞

uniformly in θ ∈ ˆOν. Here, the delta function on the right hand side is deﬁned on V × Rn′.

Therefore, we have

E[ ˜χε

νGεδa(Y ε

1 )]

= e−d2

)G(ε, w +

k(θ)

)

ε

k(θ)

ε
k(θ)

ν(w +

σν γν (w +

a/2ε2Z ˆOν
Ehe−hk(θ),wiH/ε ˜χε
× det[Id − εak(θ)(w)]ζ ε,hν
a/2ε2Z ˆOν
a/2ε2ZOν

× det[Id − εak(θ)(w)]ζ ε,hν

Ehe−hk(θ),wiH/ε ˜χε
Ehe−hk,wiH/ε ˜χε

σν γν (w +

ε

ε

× det[Id − εak(w)]ζ ε,hν

σν γν (w +

k(θ)

)δ0(cid:0)Rε
)δ0(cid:16) Rε

1(w; k(θ)), εe(θ, w)(cid:1)ipdet G(θ)dθ
, e(θ, w)(cid:17)ipdet G(θ)dθ

ε
1(w; k(θ))

)G(ε, w +

k(θ)

ε

ε

)

ν(w +

k(θ)

ν(w +

)G(ε, w +

k
ε

)

k
ε
1(w; k)

ε

k
ε

)δ0(cid:16) Rε

, ikhwi(cid:17)iω(dk),

= ε−(n+n′)e−d2

= ε−(n+n′)e−d2

Under the condition that Rε
2(w; k)iV/ε.

where in the last line δ0 stands for the delta function on V × TkKmin
equal to −hq(k), Rε
where (y, z) denotes a generic element in V × TkKmin

Since f ((|y|2 + |z|2)/κ2)δ0(y, z) = δ0(y, z) as a distribution on V × TkKmin

1(w; k) = 0, hk, wiH = hq(k), Dψ1(k)hwiiV = hq(k), g1(w; k)iV is
for any κ > 0,

, we can see that

.

a

a

a

ζ ε,hν
σν γν (w +

(cid:17)δ0(cid:16) Rε
in ˜D−∞, where we set κε(w; k) = |Rε

)f(cid:16)κε(w; k)

k
ε

κ2

1(w; k)

, ikhwi(cid:17) = ζ ε,hν

ε
1(w; k)/ε|2 + |ikhwi|2 for simplicity.

k
ε

)δ0(cid:16) Rε

σν γν (w +

Summing up these all, we have the following lemma:

1(w; k)

, ikhwi(cid:17)

Lemma 7.2 For any 1 ≤ ν ≤ N, 0 ≤ ε ≤ ε0, κ > 0, it holds that

E[ ˜χε

νGεδa(Y ε

1 )]

= ε−(n+n′)e−d2

a/2ε2ZOν

Ehehq(k),Rε
× det[Id − εak(w)]f(cid:16)κε(w; k)

κ2

2(w;k)/ε2iV ˜χε

ν(w +

)G(ε, w +

k
ε

k
ε
1(w; k)

(cid:17)ζ ε,hν

σν γν (w +

k
ε

)δ0(cid:16) Rε

ε

, ikhwi(cid:17)iω(dk).

(7.4)

ε

)

Here, ε0 ∈ (0, 1] is the constant given in Lemma 3.7.

44

Now it suﬃces to compute a full asymptotic expansion of the generalized expectation in
Lemma 7.2 above. We will write Aν(ε, k) := E[· · · ] on the right hand side in (7.4). Note that
all the asymptotics below are uniform in k ∈ Kmin
. So, we do not explicitly write uniformity
or boundedness in k.

a

Now we list the asymptotic expansion of each factor in (7.4). First, by Assumption (C1),

G(ε, w +

k
ε

) ∼ Γ0(k) + εΓ1(w; k) + ε2Γ2(w; k) + · · ·

in D∞ as ε ց 0.

(7.5)

Next, det[Id − εak(w)] is just a polynomial:

det[Id − εak(w)] = J0(w; k) + εJ1(w; k) + · · · + εn′

Jn′(w; k)

(7.6)

for some Jj(w; k) ∈ D∞ (1 ≤ j ≤ n′). Note that J0(w; k) ≡ 1.

From (3.23), (3.24) and the deﬁnition of σν in (6.7), we can easily see that

0 ≤ lim

εց0

ξε(w) = kL(k − hν)1k4m

α,4m−B + kL(k − hν)2k2m

2α,2m−B

σ4m
ν γ4m

ν

1
8

,

≤

which is one of the assumptions in Proposition 3.2. It is clear that

(Rε

1(w; k)/ε, ikhwi) ∼ (g1(w; k), ikhwi) + ε(g2(w; k), 0) + · · ·

in D∞(Rn+n′) as ε ց 0.

Hence, we can use Proposition 3.2 to obtain

ζ ε,hν
σν γν (w +

k
ε

)δ0(cid:16) Rε

1(w; k)

ε

, ikhwi(cid:17)

∼ Φ0(w; k) + εΦ1(w; k) + ε2Φ2(w; k) + · · ·

in ˜D−∞ as ε ց 0.

(7.7)

The coeﬃcient Φj(w; k) is obtained by the formal asymptotic expansion for the composi-
tion of δ0 and (Rε
1(w; k)/ε, ikhwi) as explained in Proposition 3.2. In particular, Φ0(w; k) =
δ0(g1(w; k), ikhwi).
ν(w + k/ε)f (κε(w; k)/κ2) is bounded
in ˜D∞ due to Lemma 5.3, we have

Let L ∈ N be arbitrarily large. Since ehq(k),Rε

2(w;k)/ε2iV ˜χε

Aν(ε, k) = Ehehq(k),Rε

2(w;k)/ε2iV ˜χε

ν(w +

k
ε

)G(ε, w +

k
ε

)

× det[Id − εak(w)]f(cid:16)κε(w; k)

κ2

(cid:17)(cid:16) LXj=0

εjΦj(w; k)(cid:17)i + O(εL+1)

(7.8)

as ε ց 0.
is clear that

Then, we expand ehq(k),Rε

2(w;k)/ε2iV ˜χε

ν(w + k/ε)f (κε(w; k)/κ2) in ˜D∞ by using Lemma 5.3. It

Rε

3(w; k)

ε2

=

Rε

2(w; k)

ε2

− g2(w; k) ∼ εg3(w; k) + ε2g4(w; k) + · · ·

in D∞(Rn) as ε ց 0.

45

In particular, Rε
x = 0, we have

3(w; k)/ε2 = O(ε) in D∞(Rn) as ε ց 0. From the Taylor expansion of ex at

˜χε

ν(w +

k
ε

)f (

κε(w; k)

κ2

)ehq(k),Rε

2(w;k)/ε2iV

= ˜χε

ν(w +

κ2

k
ε

)f (

κε(w; k)

)nehq(k),g2(w;k)iV
LXj=0
dτ exp(cid:0)hq(k), (1 − τ )g2(w; k) + τ

+Z 1

0

hq(k), Rε

Rε

2(w; k)

ε2

V

3(w; k)/ε2ij
j!
iV(cid:1) · hq(k), Rε

3(w; k)/ε2iL+1
(L + 1)!

V

o. (7.9)

Using Lemma 5.3, (5.8) in its proof and H¨older’s inequality with the exponents 1/τ and 1/(1−τ ),
we can show that the last term on the right hand side of (7.9) is O(εL+1) in ˜D∞-topology. Here,
we have used (6.12). Similarly, ehq(k),g2(w;k)iV ˜χε

ν(w + k/ε)f (κε(w; k)/κ2) ∈ ˜D∞, due to (5.8).

Denote by Bj(w; k) ∈ D∞ (j ∈ N) the coeﬃcients that appear in the formal asymptotic

expansion of

hq(k), Rε

3(w; k)/ε2ij
j!

V

∞Xj=0

∼ B0(w; k) + εB1(w; k) + ε2B2(w; k) + · · ·

in D∞ as ε ց 0.

Note that B0(w; k) ≡ 1. As ε ց 0, it holds that

˜χε

ν(w +

k
ε

)f (

κε(w; k)

)ehq(k),Rε

2(w;k)/ε2iV

κ2

)f (

k
ε

= ˜χε

ν(w +

and therefore

κε(w; k)

κ2

)ehq(k),g2(w;k)iV

LXj=0

εjBj(w; k) + O(εL+1)

in ˜D∞

(7.10)

Aν(ε, k) = Ehehq(k),g2(w;k)iV ˜χε
(cid:17)(cid:16) LXj1=0
×f(cid:16)κε(w; k)

κ2

ν(w +

k
ε

)G(ε, w +

k
ε

) det[Id − εak(w)]

εj1Bj1(w; k)(cid:17)(cid:16) LXj2=0

εj2Φj2(w; k)(cid:17)i + O(εL+1). (7.11)

By Proposition 3.2, each Φj(w; k) is a ﬁnite sum of terms of the following form;

(a D∞-functional) × (∂βδ0)(g1(w; k), ikhwi),

where β is a certain (n+n′)-dimensional multi-index. Hence, by Corollary 5.4, (iii) and Remark
5.5, exp(hq(k), g2(w; k)iV)Φj(w; k) ∈ D−∞. Note that all the other factors in the generalized
expectation in (7.15) belong to D∞. (Because exp(hq(k), g2(w; k)iV) /∈ ˜D∞, a little care was
needed above). So, it suﬃces to expand them in D∞-topology.
By the general theory, f (κε(w; k)/κ2) admits asymptotic expansion in D∞-topology as fol-

lows:

46

f (

κε(w; k)

κ2

1(w; k)/ε|2 + |ikhwi|2

) = f(cid:16)|Rε
∼ C0(w; k) + εC1(w; k) + ε2C2(w; k) + · · ·

(cid:17)

κ2

in D∞ as ε ց 0.

(7.12)

Note that C0 = f ({|g1(w; k)|2 + |ikhwi|2}/κ2).
Let us see that {Ci(w; k)} does not contribute to the asymptotic expansion. In other words,
f (κε(w; k)/κ2) is merely a dummy factor which is introduced for technical reasons. Each term
in Ci(w; k) has a factor of the form f (l)({|g1(w; k)|2 + |ikhwi|2}/κ2) for some l ∈ N. Similarly,
by Proposition 3.2, each term of Φj(w; k) has a factor of the form (∂βδ0)(g1(w; k), ikhwi) for
some (n + n′)-dimensional multi-index β. Noting that

f (l)(cid:16)|g1(w; k)|2 + |ikhwi|2

κ2

(cid:17) · (∂βδ0)(g1(w; k), ikhwi)

=(0

(∂βδ0)(g1(w; k), ikhwi)

(if l ≥ 1),
(if l = 0),

we can easily see that Ci(w; k)Φj(w; k) = 0 in ˜D−∞ if i ≥ 1 and hence

∞Xi=0

εiCi(w; k)

∞Xj=0

εjΦj(w; k) =

εjΦj(w; k)

∞Xj=0

holds as a formal asymptotic expansion.

Again by the general theory, ˜χε

ν(w + k/ε) also admits asymptotic expansion in D∞:

˜χε

ν(w +

k
ε

) ∼ D(ν)

0 (w; k) + εD(ν)

1 (w; k) + ε2D(ν)

2 (w; k) + · · ·

in D∞ as ε ց 0. (7.13)

i

i

0 (w; k) ≡ 1.

(w; k) ≡ 0 for all i ≥ 0. Moreover, sincePN

However, we should note here that the coeﬃcient {D(ν)
(w; k)} may depend on ν. If k /∈ Oν, then
k /∈ Uhν ,γν , which implies that D(ν)
ν = χε and χε
admits the asymptotic expansion (6.3), we easily see that, for all k ∈ Kmin
(w; k) ≡ 0
for all i ≥ 1 andPν D(ν)
We now set a notation. Deﬁne Ei(w; k) ∈ ˜D−∞ by the following formal asymptotic series:
∞Xj=0
εjEj(w; k)
= (cid:16) ∞Xj1=0

εj4Φj4(w; k)(cid:17). (7.14)

εj2Jj2(w; k)(cid:17)(cid:16) ∞Xj3=0

εj3Bj3(w; k)(cid:17)(cid:16) ∞Xj4=0

εj1Γj1(w; k)(cid:17)(cid:16) mXj2=0

,Pν D(ν)

ν=1 ˜χε

a

i

Note that Γj(w; k),Jj(w; k),Bj(w; k), Φj(w; k) are all deﬁned not just for k ∈ Oν, but for any
k ∈ Kmin
. Hence, so is Ej(w; k), which means that the deﬁnition of Ej(w; k) is independent of
ν. It is easy to see that E0(w; k) = Γ0(k)δ0(g1(w; k), ikhwi).

a

47

Combining these all, we have the following asymptotics: for any L ∈ N,

Aν(ε, k) = Ehehq(k),g2(w;k)iV(cid:16) LXj=0

εjEj(w; k)(cid:17)(cid:16) LXl=0

εlD(ν)

l

(w; k)(cid:17)i + O(εL+1)

(7.15)

as ε ց 0 uniformly in k ∈ Kmin

a

. Therefore,

NXν=1

=

=

=

E[ ˜χε

νGεδa(Y ε

1 )]

NXν=1nZOν
NXν=1nZKmin
εjZKmin
LXj=0

a

a

l

εjEj(w; k)(cid:17)(cid:16) LXl=0
εlD(ν)
εjEj(w; k)(cid:17)(cid:16) LXl=0

(w; k)(cid:17)iω(dk) + O(εL+1)o
Ehehq(k),g2(w;k)iV(cid:16) LXj=0
Ehehq(k),g2(w;k)iV(cid:16) LXj=0
(w; k)(cid:17)iω(dk) + O(εL+1)o
εlD(ν)
Ehehq(k),g2(w;k)iVEj(w; k)iω(dk) + O(εL+1)

l

(7.16)

as ε ց 0, which is the desired asymptotic expansion. Note that {D(ν)
i
to the asymptotic expansion, either. The leading term is given by

(w; k)} does not contribute

c0 =ZKmin

a

Ehehq(k),g2(w;k)iV δ0(g1(w; k), ikhwi)iΓ0(k)ω(dk),

(7.17)

a

.

which is positive if Γ0 is non-negative, but not identically zero on Kmin
To complete the proof of our main theorem (Theorem 2.2), we show that c2j+1 = 0 (j =
0, 1, 2, . . .) under (C2). First, note that f2j(w; h) and f2j+1(w; h) are even and odd in w,
respectively. (For simplicity, we will say that {fj} satisﬁes the even-odd property.) Obviously,
so does {gj}. It immediately follows from this that {Bj} satisﬁes this property. Although not
so obvious, it is still straight forward to check the even-odd property of {Φj}. From the explicit
form of ak(εw), it is easy to see that {Jj} does, too. Therefore, {Ej} satisﬁes the even-odd
property and

Ehehq(k),g2(w;k)iVE2j+1(w; k)i = 0
by the invariance of the Wiener measure µ and g2(w; k) under w 7→ −w. (Although it is not
necessary in the proof of this Euclidean case, we note that {D(ν)
j } also satisﬁes this property
due to the explicit construction of ˜χε

ν.) Thus, we have shown Theorem 2.2.

8 Proof of the manifold case

In this section we prove Theorem 2.5. As we mentioned before, we choose Riemannian metrics
on M and N arbitrarily and ﬁx them. The measure vol is the Riemannian measure on N . It

48

is often useful to embed M into RN with suﬃciently high dimension N and solve diﬀerential
equations in the ambient space RN . For instance, when we prove continuity or diﬀerentiability
of various maps from (rough) path spaces, this extrinsic view has an advantage.

Choose such an embedding M ֒→ RN and extend Vi (0 ≤ i ≤ r) so that it becomes C ∞
b -
vector ﬁeld on RN . (By abusing notations we denote the extended vector ﬁelds by the same
symbols). Then, consider Stratonovich SDE (2.1) and skeleton ODE (2.2) on RN . If x ∈ M,
then the solutions stay in M and coincide with the solutions (2.4) and (2.5), respectively.
The case of RDE is slightly diﬀerent. We do not deﬁne RDE on M in an intrinsic way. We
just solve RDE (3.17) on RN and call the ﬁrst level path of the solution the solution of RDE
on M. (Note that if x ∈ M, then the ﬁrst level path of the solution stays in M.) Since we
only need the ﬁrst level path of the solution of the RDE, this is enough for our purpose.
Recall that J(t, x, h) deﬁned by (3.10) on the ambient space is a Jacobian of the smooth map
x 7→ φ(t, x, w). Hence, J(t, x, h) is a linear map from Tx(RN ) to Tφ(t,x,h)(RN ). When restricted
on Tx(M), it is from Tx(M) to Tφ(t,x,h)(M) and coincides with the Jacobian of x 7→ φ(t, x, w)
deﬁned by (2.5) on M. A similar fact holds for X ε(t, x, w) and J ε(t, x, w).
We remark that all the results in Section 4 remain valid in the manifold setting with trivial
modiﬁcations. To see this, let us write key quantities in an intrinsic way. As usual we will
identify H and H∗ via the Riesz isometry. We denote by L(X ,Y) the space of bounded linear
maps from from X to Y.
First, Dφt(h) ∈ L(H, Tφt(h)M) and Dψt(h) = (Π∗)φt(h) ◦ Dφt(h) ∈ L(H, Tψt(h)N ), where
(Π∗)x : TxM → TΠ(x)N is the tangent map of Π at x ∈ M. The deterministic Malliavin
covariance is deﬁned by

σ[ψ1](h) := Dψ1(h) ◦ Dψ1(h)∗ ∈ L(T ∗

ψ1(h)N , Tψ1(h)N ),

(8.1)

where the Riesz isometry H = H∗ is implicit.
for a.a. w. The Malliavin covariance of Y ε

t (w) ∈ L(H, TX ε

Similarly, DX ε

t (w)M) and DY ε

1 is as follows:

t (w) = (Π∗)X ε

t (w) ◦ DX ε

t (w) ∈ L(H, TY ε

t (w)N )

σ[Y ε

1 ](w) := DY ε

1 (w) ◦ DY ε

1 (w)∗ ∈ L(T ∗

Y ε

1 (w)N , TY ε

1 (w)N ).

(8.2)

The (deterministic) Malliavin covariance is viewed as a bilinear form on the cotangent space.
Since the cotangent space is equipped with an inner product, its eigenvalues and determinant
make sense.

Here, we discuss the integration by parts formula for a manifold-valued smooth Wiener
functionals. This was implicitly used in [42] and is not very diﬃcult. However, since no proof
is given in [42], we now give a sketch of proof for the reader’s convenience. This formula is used
in (i) pullback of a Schwartz distribution on the manifold by a non-degenerate manifold-valued
smooth Wiener functional, i.e., a manifold version of Item (c) in Subsection 3.1 and (ii) upper
estimate of the large deviation, i.e., a manifold version of Theorem 3.8.

Leaving SDE (2.4) aside for a moment, we discuss in a general setting. Let N be a compact
Riemannian manifold and let F be a D∞ -Wiener functional that takes values in N . (For basics
of manifold-valued Malliavin calculus, see [42].) The sets of smooth functions and of smooth

49

vector ﬁelds on N are denoted by C ∞(N ) and Γ∞(TN ), respectively. In a standard way, we
identify TyN and H with their dual spaces T ∗

y N and H∗, respectively.

Suppose that DF (w) ◦ DF (w)∗ : TF (w)N → TF (w)N is non-singular, i.e.,

det[DF (w) ◦ DF (w)∗] 6= 0 for a.a. w ∈ W.

(8.3)

For f ∈ C ∞(N ) and Z ∈ Γ∞(TN ), substituting

h = DF (w)∗ ◦ {DF (w) ◦ DF (w)∗}−1ZF (w)

into

we obtain that

D(f (F ))(w)hhi = hD(f (F ))(w), hiH = (∇f )(w)(cid:10)DF (w)hhi(cid:11),

hD(f (F ))(w), DF (w)∗ ◦ {DF (w) ◦ DF (w)∗}−1ZF (w)iH = (Zf )(F (w)).

In addition, assume that

Setting

(DF )∗ ◦ {DF ◦ (DF )∗}−1ZF ∈ D∞(H)
Φ1(Z 1; G) = D∗hG · [(DF )∗ ◦ {(DF ) ◦ (DF )∗}−1Z 1
F ]i,

Φk(Z 1, . . . , Z k; G) = Φ1(Z k; Φk−1(Z 1, . . . , Z k−1; G)),

for any Z ∈ Γ∞(TN ).

k = 2, 3, . . .

(8.4)

(8.5)

for Z 1, . . . , Z k ∈ Γ∞(TN ) and G ∈ D∞, and then using (8.4) successively, we arrive at the
desired integration by parts formula for a manifold-valued Wiener functional:

E[(Z 1 . . . Z kf )(F )G] = E[f (F )Φk(Z 1, . . . , Z k; G)]

(8.6)

for any Z 1, . . . , Z k ∈ Γ∞(TN ) and G ∈ D∞, f ∈ C ∞(N ). For the same reason as in the
Euclidean-valued case, this formula extends to the case when f is a Schwartz distribution on
N .

The assumptions (8.3) and (8.5) are satisﬁed provided that

k{DF ◦ (DF )∗}−1kop,F ∈ \1<p<∞

Lp(µ) or

det[{DF ◦ (DF )∗}−1] ∈ \1<p<∞

Lp(µ).

Here, k · kop,y stands for the operator norm of a linear mapping of TyN into itself with respect
to the Riemannian metric. Since we work on a compact manifold, the above condition is
independent of the choice of a Riemannian metric.

Let us get back to our original setting and assume (B1). For h ∈ Kmin

multiplier q(h) = σ[ψ1](h)−1Dψ1(h)hhi should be regarded as an element of T ∗

a

, the Lagrange
aN . Hence,

50

q(h) ◦ (Π∗)φ1(h) ∈ T ∗
value p0 of the Hamiltonian ODE associated with Hamiltonian

φ1(h)M and q(h) ◦ (Π∗)φ1(h) ◦ J1(h) ∈ T ∗

xM. Recall the latter is the initial

H(x, p) =

1
2

rXi=1(cid:10)p, Vi(x)(cid:11)2

(x, p) ∈ T ∗M = ∪x∈MT ∗

xM,

where the pairing is between T ∗
xM and TxM. Clearly, H is a smooth function on the cotangent
bundle T ∗M.
Then, if Assumption (A1) is replaced by (A1)’, Proposition 4.1, Remark 4.2, Proposition
4.3, Proposition 4.4 and Lemma 4.6 also hold in our manifold setting with trivial modiﬁcations
of the statements. (For instance, ΠV should be replaced by (Π∗)φ1(h), etc.) A rough sketch of
proof is as follows: If we take a local coordinate of M, ODEs for φ(h) and J(h) can be written
down in the coordinate. Then, the computation for the Hamiltonian ODE is essentially the
same as in Section 4. To prove diﬀerentiability or (rough path) continuity of q(h) or p0 = p0(h),
etc. in h, the extrinsic expression of the skeleton ODE on RN is better.

As we will see in the next lemma, in a neighborhood of the path t 7→ φt(h), h ∈ Kmin

, the
RDE on M can be transferred to an RDE on Rd. Hence, for local analysis around h of the
RDE on manifold, it is suﬃcient to deal with the corresponding RDE on the Euclidean space.
This is one of main advantages of using rough path theory since in the classical theory of Itˆo
maps this kind of ”local” operation is not easy and sometimes impossible.

a

, we can ﬁnd:

a

Lemma 8.1 (i) For any h ∈ Kmin
(1) An open neighborhood U = Uh of Imφ(h) := {φt(h) | t ∈ [0, 1]} in M.
(2) An bounded, connected, open subset U ′ = U ′
(3) A diﬀeomorphism θ = θh : U → U ′.
(4) Vector ﬁleds V (h)
on Rd of class C ∞
(θ(x)) (0 ≤ i ≤ r).
b
(ii) Consider skeleton ODE (2.2) and RDE (3.17) on Rd, but with the coeﬃcients V (h)
(0 ≤ i ≤
r) and the initial point θ(x). If k ∈ H is suﬃciently close to h in H-topology, then t 7→ θ(φt(k))
solves the skeleton ODE on Rd driven by k. Likewise, if w and h = L(h) are suﬃciently close
in GΩB
α,4m(Rd) and kλk1−H is suﬃciently small, then t 7→ θ(x + x1
0,t) is the
ﬁrst level path of the solution of the RDE on Rd driven by (w, λ).

such that (θ∗)xVi(x) = V (h)

0,t) = θ(x + Φ(w, λ)1

h in Rd.

i

i

i

Proof. First, we prove (i). Clearly, the image of the path φ(h) is compact in M and there is
no self-intersection due to the energy-minimizing condition. Moreover, by Remark 4.2, φ′
t(h)
never vanishes. Therefore, we can use the standard technique of the tubular neighborhood to
prove such U,U ′, θ exist. Then, existence of such V (h)
is almost obvious. Since the (Lyons-)Itˆo
maps associated with the skeleton ODE and the RDE is continuous, the assertion (ii) is easy.

i

Remark 8.2 To keep our notations simple, we will often identify U and U ′ through θ.
such cases we will treat ODE/RDE/SDE on Rd with the coeﬃcients V (h)

In
and the initial point

i

51

x ∈ Rd. The solution of SDE (2.1) associated with V (h)
is denoted by X ε,(h). (This should not
be confused with X ε,h
are
denoted by φ(h)(k), Φ(h)(w, λ), respectively. The ordinary terms and the remainder term in the
expansion of X ε,(h)(t, x, w +k/ε) in (3.29) and (3.32) are denoted by f (h)
j+1 (w; k),
respectively.

:= X ε(t, x, w + h/ε).) Likewise, φ(k), Φ(w, λ) associated with V (h)

(w; k) and Qε,(h)

j

t

i

i

Next, we take the normal coordinate around a ∈ N . Then, there exists a diﬀeomorphism
from a neighborhood of a to a neighborhood of 0 in TaN . Note that TaN is a vector space
with an inner product. Through this diﬀeomorphism, the delta function at a ∈ N corresponds
to the delta function at 0 ∈ TaN . Moreover, since the tangent map of this diﬀeomorphism at
a is isometric and so is its transpose, the determinant and the eigenvalues of the deterministic
Malliavin covariance of φ1(h) for h ∈ Ka remains the same even if they are calculated in this
normal coordinate.
and let U,U ′ and θ be as in Lemma 8.1 (they all depend on h). If we take a
small neighborhood of θ(φ1(h)) ∈ U ′, then Π (viewed as a map from U ′) maps it into the normal
coordinate of a ∈ N . In a standard way we can ﬁnd a C ∞
b -map Π(h) from Rd to TaN which
agrees with Π when restricted on the neighborhood of θ(φ1(h)). Consequently, for ε(h) > 0
and γ(h) > 0 small enough, it holds that

Let h ∈ Kmin

a

Π(h)[x + Φ(h)(εW, λε)1

0,1] = Y ε(1, x, w) ∈ TaN if ε ∈ [0, ε(h)] and εW ∈ Uh,γ(h).

(Precisely, this means that Y ε(t, x, w) takes values in the normal coordinate of a if ε ∈ [0, ε(h)]
and εW ∈ Uh,γ(h) and the value is equal to the left hand side.)

Asymptotic expansion of

Π(h)[x + Φ(h)(τk(εW), λε)1

0,1] = Π(h)[X ε,(h)(1, x, w +

k
ε

)]

a

j+1 (w; k) for gF

j (w; k) and Rε,F

j (w; k) and Rε,(h)

was already done in Lemma 3.6. We write g(h)
j+1(w; k)
in Lemma 3.6, respectively (with F = Π(h)). Thus, local analysis of the solution of RDE on
manifold M was reduced to that in the linear setting.
Remark 8.3 The deﬁnition of Kmin
depends on the coeﬃcient vector ﬁelds of the skeleton
ODE. If they are replaced by new vector ﬁelds V (h)
a may change and k ∈ Kmin
that is close enough to h may not belong to Kmin,(h)
anymore. However, we need not worry
about this for the following reasons: Such k is still a local minimum of k 7→ kkk2
H/2 subject to
ψ(h)
1 (k) = Π(h)(φ(h)
1 (k)) = 0 ∈ TaN and all the computations for the skeleton ODE, but one,
require just the local minimum property via the Lagrange multiplier method (so k need not be a
global minimizer of this conditional minimal problem in the proof of the asymptotic expansion).
The only exception where the global minimum property is really used is the proof of the large
deviation upper bound, in which we will treat original ψ1 and Kmin

(0 ≤ i ≤ r), Kmin

and Kmin,(h)

, not ψ(h)

.

a

a

i

a

a

1

Now we compute the second order terms. Let h ∈ Kmin

a

and take U and V (h)

i

in Lemma 8.1. Suppose that k is suﬃciently close to h. The Lagrange multiplier q(k) ∈ T ∗

(0 ≤ i ≤ r) as
aN ,

52

We can compute Dφ(h)

which is independent of h, is now an n-dimensional row vector and (4.3) with V replaced by
Rn ∼= TaN .
t (k)hl, ˆli in the same way as in (4.1) and (4.2),
respectively (if Vi are replaced by V (h)
1 (k)) and we do not distinguish them in this
paragraph. We denote by ∇ the usual gradient for maps from an open subset of Rd to TaN ∼=
Rn. Then, we have

Since k and h are close, Π(φ1(k)) = Π(h)(φ(h)

t (k)hli and D2φ(h)

).

i

Dψ(h)

1 (k)hli = (∇Π)(φ(h)

1 (k))hDlφ(h)

1 (k)i = (Π∗)yDlφ(h)

1 (k)

(with y = φ(h)

1 (k))

and

D2ψ(h)

1 (k)hl, l′i = (∇Π)(φ(h)

1 (k))hD2

l,l′φ(h)

1 (k)i + (∇2Π)(φ(h)

Here, we wrote Dlφ(h)

1 (k) = Dφ(h)

1 (k)hli and D2

l,l′φ(h)

1 (k) = D2φ(h)

Note that the same computations as in (5.1) and (5.2) still hold if k is close to h. Hence, if
, then sup{C (h)(k) | k ∈ Oh} < 1/2 instead

Oh is a suﬃciently small neighborhood of h in Kmin
of (5.4).

a

1 (k))hDlφ(h)

1 (k), Dl′φ(h)

1 (k)i.
1 (k)hl, l′i for simplicity.

(8.7)

For the same reason as before, if k is suﬃciently close to h,

hq(k), g(h)

2 (πkw; k)i − E[hq(k), g(h)

2 (πkw; k)i]

belongs to C2, the second order homogeneous Wiener chaos, and corresponds to the Hilbert-
Schmidt bilinear form

1

2(cid:10)q(k), D2ψ(h)

1 (k)hπk•, πk⋆i(cid:11).

To check the correspondence, just apply (1/2)D2 to gF
(i) and compare it with (8.7).

2 (πkw; k) with F = Π(h) in Lemma 3.6,

From this and sup{C (h)(k) | k ∈ Oh} < 1/2, we have the following under (A1)’ and (B1)–
such

, there exits c1 = c1(h) > 1 and a neighborhood Oh of h in Kmin

a

Ehexp(c1hq(k), g(h)

2 (w; k)i)δ0(g(h)

1 (w; k), ikhwi)i < ∞.

(8.8)

(B3): For any h ∈ Kmin
that
sup
k∈Oh

a

Here, δ0 is the Dirac delta function on Rn × TkKmin
. (The proof is essentially the same as in
Lemma 5.3.) Moreover, from (8.8) we obtain the following: For any c2 ∈ (1, c1(h)), there exists
a constant γ1 = γ1(h) > 0 which is independent of k ∈ Oh and satisfy that

a

sup
0<ε≤1

sup
k∈Oh

Ehexp(cid:16)c2(cid:10)q(k),

2

Rε,(h)
(w; k)
ε2

(cid:11)(cid:17)1Uγ1 (εW) ; |ikhwi|2 +(cid:12)(cid:12)(cid:12)

for any κ > 0. (The proof is essentially the same as in Lemma 5.3.)

1

Rε,(h)
(w; k)
ε

2

≤ κ2i < ∞

(8.9)

(cid:12)(cid:12)(cid:12)

In a similar way, Lemma 3.7 can be modiﬁed. If Oh is suﬃciently small, then

λ(h) := inf
k∈Oh

inf

z:|z|=1

z∗σ[ψ(h)

1 ](k)z > 0.

(8.10)

53

Taking Oh smaller if necessary, we have the following: There exist γ0 = γ0(h), ε0 = ε0(h) ∈ (0, 1]
such that the smallest eigenvalue of σ[(Rε,(h)
(· ; k)/ε, ik)](w) is greater than (λ(h) ∧ 1)/2 if
aN ∼= Rn-
and Rε,(h)
εW ∈ Uγ0, k ∈ Oh and 0 ≤ ε ≤ ε0. (Here, ψ(h)
valued maps.)

(· ; k)/ε are regarded as T ∗

1

1

1

In the same way as in Lemma 6.2, we have the following lemma. Note that in this case
(which makes no diﬀerence, however). The

the constants λ, γ0, γ1, ε0 all depend on h ∈ Kmin
deﬁnition of σ = σh is in (6.7).
Lemma 8.4 For any h ∈ Kmin
, we can ﬁnd Oh (or ρ = ρh := supk∈Oh kk − hkH > 0),
γ = γh > 0 and ε0 = ε0(h) ∈ (0, 1] such that (6.4), (6.5), (6.6) and the following three
conditions hold. The ﬁrst one is:

a

a

inf
k∈Oh

inf

z:kzk=1

z∗σ[(Rε,(h)

1

(· ; k)/ε, ik)](w)z ≥

λ(h) ∧ 1

2

if ε ∈ (0, ε0] and εW ∈ Uh−k,21/4mσγ.

The second one is:

Ehexp(cid:16) c2

ε2hq(k), Rε,(h)

2

sup
0<ε≤1

sup
k∈Oh

The last one is:

(w; k)i(cid:17)1Uh−k,γ (εW) ; |ik|2 +(cid:12)(cid:12)(cid:12)

1

Rε,(h)
(w; k)
ε

≤ κ2i < ∞.

2

(cid:12)(cid:12)(cid:12)

{x + Φ(w, λε)1

0,t | t ∈ [0, 1], ε ∈ [0, ε0], w ∈ Uh,γ}
∪{φ(k)t | t ∈ [0, 1], k ∈ Oh} ⊂ Uh ⊂ M,

where Uh ⊂ M is the tubular neighborhood of Imφ(h) introduced in Lemma 8.1.

Proof. The proof is the same as in Lemma 6.2.

a

ν depend only on (hν, γν)1≤ν≤N . Below we set ε′

As in the Euclidean case, contribution of the rough paths away from Kmin

In what follows let γh be the constant in Lemma 6.2. Since γh > 0 for all h ∈ Kmin
, we can
choose ﬁnitely many (h1, γ1), . . . , (hN , γN ) and construct asymptotic partition of unity χε and
˜χε
ν exactly in the same way as in (6.1)–(6.2). (Here, γν stands for γh with h = hν.) Note that the
deﬁnitions of χε and ˜χε
0 := min1≤ν≤N ε0(hν) ∈
(0, 1] and λ′ := min1≤ν≤N λ(hν) > 0.
is negligible. To
prove it, we need to modify Theorem 3.8, the large deviation upper estimate, to the manifold
case. (Once this is done, a manifold version of Theorem 7.1 can be obtained in the same way.)
The Keys of the proof of Theorem 3.8 are Kusuoka-Stroock’s moment estimate (2.3) of
1 ]−1 and the integration by parts formula for Watanabe distributions. Both of them
det σ[Y ε
hold in the manifold case (see (8.6)). Therefore, we can prove Theorem 3.8 in the manifold
case, too. Consequently, I1(ε) does not contribute to the asymptotic expansion.
Proof of Theorem 2.5.

It is suﬃcient to compute

a

I2(ε) =

NXν=1

E[ ˜χε

νGεδa(Y ε

1 )]

54

Let η ∈ C ∞

0] tends to zero. Here, δa is the Dirac measure at a ∈ N and Y ε

as ε ∈ (0, ε′
being the solution of the M-valued SDE (2.4).
0 (TaN , R) be as in (7.2) in Section 7. Then, {ηl}l=1,2,..., deﬁned by ηl(y) = lnη(ly)
approximates the delta function at 0 on TaN . Denote by ˆηl ∈ C ∞
0 (N , R) the function which
corresponds to ηl via the exponential map at a. Then, {ˆηl}l=1,2,... approximates the delta
function at a on N . Therefore,

1) with (X ε
t )

1 = Π(X ε

E[ ˜χε

νGεδa(Y ε

1 )] = lim
l→∞

E[ ˜χε

νGε ˆηl(Y ε

1 )] = lim
l→∞

E[ ˜χε

νGεηl(Y ε,(ν)

1

)]

(8.11)

since ˜χε

ν = 0 if εW /∈ Uhν ,γν . Here Y ε,(ν)

1

is a shorthand for

Y ε,(h)
1

= Π(h)[X ε,(h)(1, x, w)]

with h = hν

and δ0 is the delta function at 0 on TaN ∼= Rn with respect to the Lesbegue measure associated
with the inner product on TaN . Note that the right hand side of (8.11) is essenatially the same
as the left hand side of (7.2). Thus, the asymptotic problem has been reduced to the one on
the Euclidian space. Note also that we need not prove non-degeneracy of σ[Y ε,(h)
] because we
use Propositions 3.1 and 3.2.

Deﬁne E (ν)

(w; k) ∈ ˜D−∞ in the same way as in (7.14). (This time it depends on ν (or hν),
however). By the same computation as in (7.16), we have the following asymptotics: for any
L ∈ N,
E[ ˜χε

1

j

νGεδa(Y ε

1 )]

(w; k)(cid:17)iω(dk) + O(εL+1)
as ε ց 0. Note that the asymptotic expansion insideR ω(dk) is uniform in k ∈ Oν. Vanishing

of c2j+1 under (C2) can be shown in the same way as in the Euclidean case. This completes
the proof of Theorem 2.5.

εjE (ν)

j

References

[1] Aida, S.; Vanishing of one-dimensional L2-cohomologies of loop groups. J. Funct. Anal.

261 (2011), no. 8, 2164–2213.

[2] Bailleul, I.; Flows driven by rough paths. Rev. Mat. Iberoam. 31 (2015), no. 3, 901–934.

[3] Barilari, D.; Boscain, U.; Neel, R.; Small-time heat kernel asymptotics at the sub-

Riemannian cut locus. J. Diﬀerential Geom. 92 (2012), no. 3, 373–416.

55

= ZOν
= ZOν

Ehexp(hq(k), g(ν)
Ehexp(hq(k), g(ν)

2 (w; k)i)(cid:16) LXj=0
2 (w; k)i)(cid:16) LXj=0

εjE (ν)

j

(w; k) + O(εL+1)(cid:17) ˜χε
(w; k)(cid:17)(cid:16) LXl=0
εlD(ν)

l

ν(w +

k
ε

)iω(dk)

[4] Barilari, D.; Jendrej, J.; Small time heat kernel asymptotics at the cut locus on surfaces

of revolution. Ann. Inst. H. Poincar´e Anal. Non Lin´eaire 31 (2014), no. 2, 281–295.

[5] Beals, R.; Gaveau, B.; Greiner, P. C.; Hamilton-Jacobi theory and the heat kernel on

Heisenberg groups. J. Math. Pures Appl. (9) 79 (2000), no. 7, 633–689.

[6] Ben Arous, G.; D´eveloppement asymptotique du noyau de la chaleur hypoelliptique hors

du cut-locus. Ann. Sci. ´Ecole Norm. Sup. (4) 21 (1988), no. 3, 307–331.

[7] Bismut, J.-M.; Large deviations and the Malliavin calculus. Progress in Mathematics, 45.

Birkh¨auser Boston, Inc., Boston, MA, 1984.

[8] Bogachev, V.; Gaussian measures. American Mathematical Society, Providence, RI, 1998.

[9] Brockett, R. W.; Mansouri, A.; Short-time asymptotics of heat kernels for a class of

hypoelliptic operators. Amer. J. Math. 131 (2009), no. 6, 1795–1814.

[10] Calin, O.; Chang, D.-C.; Sub-Riemannian geometry. General theory and examples. Cam-

bridge University Press, Cambridge, 2009.

[11] Chang, D.-C.; Li, Y.; Heat kernel asymptotic expansions for the Heisenberg sub-Laplacian

and the Grushin operator. Proc. A. 471 (2015), no. 2175, 20140943, 19 pp.

[12] Deuschel, J. D.; Friz, P. K.; Jacquier, A.; Violante, S.; Marginal density expansions for
diﬀusions and stochastic volatility I: Theoretical foundations. Comm. Pure Appl. Math.
67 (2014), no. 1, 40–82.

[13] Dragomir, S.; Tomassini, G.; Diﬀerential geometry and analysis on CR manifolds.

Birkh¨auser Boston, Inc., Boston, MA, 2006.

[14] Friz, P.; Victoir, N.; Multidimensional stochastic processes as rough paths. Cambridge

University Press, Cambridge, 2010.

[15] Gaveau, B.; Principe de moindre action, propagation de la chaleur et estim´ees sous ellip-

tiques sur certains groupes nilpotents. Acta Math. 139 (1977), no. 1–2, 95–153.

[16] Grong, E.; Thalmaier, A.; Curvature-dimension inequalities on sub-Riemannian manifolds

obtained from Riemannian foliations, Part I. To appear in Math. Z. arXiv 1408.6873.

[17] Hsu, E. P.; Stochastic analysis on manifolds. American Mathematical Society, Providence,

RI, 2002.

[18] Ikeda, N., Probabilistic methods in the study of asymptotics. ´Ecole d’´et´e de Probabilist´es
de Saint-Flour XVIII, 1988, 195–325, Lecture Notes in Math., 1427, Springer, Berlin, 1990.

[19] Ikeda, N., Watanabe, S.; Stochastic diﬀerential equations and diﬀusion processes. Second

edition. North-Holland Publishing Co., Amsterdam; Kodansha, Ltd., Tokyo, 1989.

56

[20] Inahama, Y.; Quasi-sure existence of Brownian rough paths and a construction of Brownian

pants. Inﬁn. Dimens. Anal. Quantum Probab. Relat. Top. 9 (2006), no. 4, 513–528.

[21] Inahama, Y.; A stochastic Taylor-like expansion in the rough path theory. J. Theoret.

Probab. 23 (2010) 671–714.

[22] Inahama, Y.; Large deviation principle of Freidlin-Wentzell type for pinned diﬀusion pro-

cesses. Trans. Amer. Math. Soc. 367 (2015), 8107-8137.

[23] Inahama, Y.; Short time kernel asymptotics for rough diﬀerential equation driven by frac-

tional Brownian motion, preprint, (2014). arXiv:1403.3181

[24] Inahama, Y.; Large deviations for rough path lifts of Watanabe’s pullbacks of delta func-

tions. To appear in Int. Math. Res. Not. (2016). arXiv:1412.8113.

[25] Inahama, Y.; Kawabi, H,; Asymptotic expansions for the Laplace approximations for Itˆo

functionals of Brownian rough paths. J. Funct. Anal. 243 (2007), no. 1, 270–322.

[26] Kondo, H.; Taniguchi, S.; A construction of diﬀusion processes associated with sub-

Laplacian on CR manifolds and its applications. Preprint. arXiv:1410.2925.

[27] Kusuoka, S., Stroock, D. W.; Applications of the Malliavin calculus. II. J. Fac. Sci. Univ.

Tokyo Sect. IA Math. 32 (1985), no. 1, 1–76.

[28] Kusuoka, S., Stroock, D. W.; Precise asymptotics of certain Wiener functionals. J. Funct.

Anal. 99 (1991), no. 1, 1–74.

[29] Kusuoka, S.; Stroock, D. W.; Asymptotics of certain Wiener functionals with degenerate

extrema. Comm. Pure Appl. Math. 47 (1994), no. 4, 477–501.

[30] Lyons, T.; Caruana, M.; L´evy, T.; Diﬀerential equations driven by rough paths. Lecture

Notes in Math., 1908. Springer, Berlin, 2007.

[31] Lyons, T., Qian, Z.; System control and rough paths. Oxford University Press, Oxford,

2002.

[32] Malliavin, P.; Stochastic analysis. Springer-Verlag, Berlin, 1997.

[33] Molchanov, S. A.; Diﬀusion processes, and Riemannian geometry. Russian Math. Surveys

30 (1975), no. 1, 1–63.

[34] Montgomery, R; A tour of subriemannian geometries, their geodesics and applications.

American Mathematical Society, Providence, RI, 2002.

[35] Nualart, D.; The Malliavin calculus and related topics. Second edition. Springer-Verlag,

Berlin, 2006.

57

[36] Riﬀord, L.; Sub-Riemannian geometry and optimal transport. Springer Briefs in Mathe-

matics. Springer, Cham, 2014.

[37] S´eguin, C.; Mansouri, A.; Short-time asymptotics of heat kernels of hypoelliptic Laplacians

on unimodular Lie groups. J. Funct. Anal. 262 (2012), no. 9, 3891–3928.

[38] Shigekawa,

I.; Stochastic analysis. Translations of Mathematical Monographs, 224.
Iwanami Series in Modern Mathematics. American Mathematical Society, Providence, RI,
2004.

[39] Stroock, D. W.; An introduction to the analysis of paths on a Riemannian manifold.

American Mathematical Society, 2000.

[40] Sugita, H.; Positive generalized Wiener functions and potential theory over abstract Wiener

spaces. Osaka J. Math. 25 (1988), no. 3, 665–696.

[41] Takanobu, S.; Watanabe, S.; Asymptotic expansion formulas of the Schilder type for a
class of conditional Wiener functional integrations. Asymptotic problems in probability
theory: Wiener functionals and asymptotics (Sanda/Kyoto, 1990), 194–241, Pitman Res.
Notes Math. Ser., 284, Longman Sci. Tech., Harlow, 1993.

[42] Taniguchi, S.; Malliavin’s stochastic calculus of variations for manifold-valued Wiener

functionals and its applications. Z. Wahrsch. Verw. Gebiete 65 (1983), no. 2, 269–290.

[43] Uemura, H.; Oﬀ-diagonal short time expansion of the heat kernel on a certain nilpotent

Lie group. J. Math. Kyoto Univ. 30 (1990), no. 3, 403–449.

[44] Uemura, H.; Watanabe, S.; Diﬀusion processes and heat kernels on certain nilpotent
groups. Stochastic analysis (Paris, 1987), 173–197, Lecture Notes in Math., 1322, Springer,
Berlin, 1988.

[45] Watanabe, S.; Lectures on stochastic diﬀerential equations and Malliavin calculus. Tata

Institute of Fundamental Research, Bombay, Springer-Verlag, Berlin, 1984.

[46] Watanabe, S.; Analysis of Wiener functionals (Malliavin calculus) and its applications to

heat kernels. Ann. Probab. 15 (1987), no. 1, 1–39.

Yuzuru Inahama
Graduate School of Mathematics, Kyushu University,
Motooka 744, Nishi-ku, Fukuoka, 819-0395, JAPAN.
Email: inahama@math.kyushu-u.ac.jp

Setsuo Taniguchi
Faculty of Arts and Science, Kyushu University,
Motooka 744, Nishi-ku, Fukuoka, 819-0395, JAPAN.
Email: se2otngc@artsci.kyushu-u.ac.jp

58

