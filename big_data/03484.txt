6
1
0
2

 
r
a

 

M
0
1

 
 
]
E
M

.
t
a
t
s
[
 
 

1
v
4
8
4
3
0

.

3
0
6
1
:
v
i
X
r
a

Bayesian Nonparametric Conditional Copula

Estimation of Twin Data∗

Luciana Dalla Valle 1

Fabrizio Leisen2

Luca Rossini3

1 University of Plymouth, U.K.

2 University of Kent, U.K.

3 Ca’ Foscari University of Venice, Italy

March 14, 2016

Abstract

Several studies on heritability in twins aim at understanding
the diﬀerent contribution of environmental and genetic factors to
speciﬁc traits. Considering the National Merit Twin Study, our
purpose is to correctly analyse the inﬂuence of the socioeconomic
status on the relationship between twins’ cognitive abilities. Our
methodology is based on conditional copulas, which allow us to model
the eﬀect of a covariate driving the strength of dependence between
the main variables. We propose a ﬂexible Bayesian nonparametric
approach for the estimation of conditional copulas, which can model
any conditional copula density. Our methodology extends the work
of Wu, Wang, and Walker (2015) by introducing dependence from a
covariate in an inﬁnite mixture model. Our results suggest that
environmental factors are more inﬂuential in families with lower socio-
economic position.

Keywords:

Bayesian nonparametrics, Conditional Copula

models, Slice sampling

∗Email Addresses

(Luca Rossini);
fabrizio.leisen@gmail.com (Fabrizio Leisen); luciana.dallavalle@plymouth.ac.uk (Luciana
Dalla Valle).

for correspondences

:

luca.rossini@unive.it

1

1

Introduction

The literature on heritability of traits in children often focusses on twins,
due to the shared environmental factors and the association of genetical
characteristics. Among studies on the heritability of diseases, Wang et al.
(2011) applied an eﬃcient estimation method to mixed-eﬀect models to
analyze disease inheritance in twins.

One of the main purposes of studies on heritability is to estimate the
diﬀerent contribution of genetic and environmental
factors to traits or
outcomes (see, for example, the latent class twin method of Baker (2016)).
Bioecological theory states that environmental factors modify the heritability
of certain characteristics, such as cognitive ability, that is the readiness for
future intellectual or educational pursuits. Several studies have found that
cognitive ability is more heritable among those raised in higher socioeconomic
status families and therefore the environment can moderate the eﬀect of
genes. Bates, Lewis, and Weiss (2013) studied the interactions between
environmental and genetic eﬀects to intelligence in twins, showing that higher
socioeconomic status is associated with higher intelligence scores.

The aim of this paper is to correctly analyse the eﬀect of environmental
factors on the relationship between twins’ cognitive abilities.
From a
sample of 839 US adolescent twin pairs who completed the National
Merit Scholarship Qualifying Test, we consider each twin’s overall school
performance (measured by a total score including English, Mathematics,
Social Science, Natural Science and Word Usage), the mother’s and father’s
education level and the family income. The data are plotted in Figure 1,
which shows the scatterplots of the twins’ school performances, on each axis,
against the socioeconomic variables, whose values are in diﬀerent colours
(dark red denotes low values, while light yellow denotes high values). From
Figure 1 it is clear that the twins’ school performances are strongly correlated
and positively inﬂuenced by all socioeconomic variables.

In order to model the dependence structure between the twins’ school
performances, we used copulas, which are popular modeling approaches in
multivariate statistics allowing the separation of the marginal components
of a joint distribution from its dependence structure. More precisely,
Sklar (1959) proved that a d-dimensional distribution H of the random
variables Y1, . . . , Yd can be fully described by its marginal distributions
[0, 1]d → [0, 1], called copula, through the relation
and a function C :
H(y1, . . . , yd) = C(F1(y1), . . . , Fd(yd)).
In the literature, copulas have

2

been applied to model the dependence between variables in a wide
variety of ﬁelds (see Kolev, dos Anjos, and Vaz de Mendes (2006) and
In particular, applications
Cherubini, Luciano, and Vecchiato (2004)).
of copula models
(Andersen (2005)),
survival analysis of Atlantic halibut (Braekers and Veraverbeke (2005)) and
transfusion-related AIDS and cancer analysis (Emura and Wang (2012),
Huang and Zhang (2008) and Owzar, Jung, and Sen (2007)).

involved lifetime data analysis

The introduction of covariate adjustments to copulas has attracted
an increased interest in recent years,
since it allows the dependence
structure to be explained by a speciﬁc covariate. Craiu and Sabeti (2012)
propose a conditional copula approach in regression settings where the
bivariate outcome can be mixed or continuous. Patton (2006) introduce
time-variation in the dependence structure of ARMA models (see also
Jondeau and Rockinger (2006) and Bartram, Taylor, and Wang (2007) for
other applications of time-series analysis to dependence modelling). The
paper of Acar, Craiu, and Yao (2010) provides a nonparametric procedure
to estimate the functional relationship between copula parameters and
covariates, showing that the gestational age drives the strength of dependence
between the birth weights of twins. Abegaz, Gijbels, and Veraverbeke (2012)
and Gijbels, Omelka, and Veraverbeke (2012) propose semiparametric and
nonparametric methodologies for the estimation of conditional copulas,
establishing consistency and asymptotic normality results for the estimators.
The methodology is then applied to examine the inﬂuence of the gross
domestic product (GDP), in USD per capita, on the life expectancies of males
and females at birth. Following this literature, we adopt a conditional copula
approach to model the eﬀect of a covariate, such as the parents’ education
or the family income, on the strength of dependence between twins’ school
performances.

The literature oﬀers a rich range of copula families, such as elliptical
copulas (e.g. Gaussian and Student’s t) and archimedean copulas (e.g.
Frank, Gumbel, Clayton and Joe) to accommodate various dependence
structures. Nonetheless, the choice of the copula family may be controversial
and it is still an open problem (see Joe (2014)). To overcome this issues,
Wu et al. (2015) propose a Bayesian nonparametric procedure to estimate
any unconditional copula density function. The authors combine the well-
known Gaussian copula density with the modeling ﬂexibility of the Bayesian
nonparametric approach, proposing to use an inﬁnite mixture of Gaussian
copulas. Our paper extends the work of Wu et al. (2015) to the conditional

3

copula setting, by proposing a novel methodology which combines the
advantages of a conditional copula approach with the modeling ﬂexibility of
Bayesian nonparametrics. In particular, we included a conditional covariate
component to explain the variables dependence structure, allowing us further
ﬂexibility to the copula density modelling. Up to our knowledge, this is the
ﬁrst Bayesian nonparametric proposal in the conditional copulas literature.
The outline of the paper is the following. In Section 2 we brieﬂy review
the literature about conditional copulas and Bayesian nonparametric copula
estimation.
In Section 3 we introduce our novel Bayesian nonparametric
conditional copula setting. Section 4 provides an algorithm for estimating
the posterior parameters and Section 5 illustrates the performance of the
methodology. Section 6 is devoted to the application of our methodology
to the analysis of the National Merit Twin Study. Concluding remarks are
given in section 7.

2 Preliminaries

In this Section, we review some preliminary notions about conditional
copulas and illustrate the Bayesian nonparametric copula density estimation
introduced in Wu et al. (2015). In what follows, we focus on the bivariate
case for simplicity, however the arguments can be easily extended to more
than two dimensions.

2.1 The conditional copula

Let Y1 and Y2 be continuous variables of interest and X be a covariate
that may aﬀect the dependence between Y1 and Y2. Following Gijbels et al.
(2012), Abegaz et al. (2012) and Acar et al. (2010), we suppose that the
conditional distribution of (Y1, Y2) given X = x exists and we denote the
corresponding conditional joint distribution function by

Hx(y1, y2) = P (Y1 ≤ y1, Y2 ≤ y2|X = x).

If the marginals of Hx, denoted as

F1x(y1) = P (Y1 ≤ y1|X = x)

F2x(y2) = P (Y2 ≤ y2|X = x),

are continuous, then according to Sklar’s theorem there exists a unique copula
Cx which equals

Cx(u, v) = Hx(F −1

(1)

1x (u), F −1

2x (v))

4

1x (u) = inf{y1 : F1x ≥ u} and F −1

where F −1
2x (v) = inf{y2 : F2x ≥ v}, are
the conditional quantile functions and u = F1x(y1) and v = F2x(y2) are
called pseudo-observations. The conditional copula Cx fully describes the
conditional dependence structure of (Y1, Y2) given X = x. An alternative
expression for (1) is

Hx(y1, y2) = Cx(F1x(y1), F2x(y2)).

(2)

2.2 Bayesian nonparametric copula density estimation

Wu et al. (2015) introduced a Bayesian nonparametric copula density
estimation by using an inﬁnite mixture of Gaussian copulas. Let Φρ(y1, y2)
denote the standard bivariate normal distribution function with correlation
coeﬃcient ρ. Then, Cρ is the copula corresponding to Φρ, taking the form:

Cρ(u, v) = Φρ(Φ−1(u), Φ−1(v))

(3)

where Φ is the univariate standard normal distribution function. The
Gaussian copula density is:

cρ(u, v) = |Σ|−

1

2 exp(cid:26)−

1
2

(Φ−1(u), Φ−1(v))(Σ−1 − I)(cid:18)Φ−1(u)

Φ−1(v)(cid:19)(cid:27)

(4)

where the covariance matrix is:

Σ = (cid:20)1 ρ
ρ 1(cid:21) .

Wu et al. (2015) proposed to use an inﬁnite mixture of Gaussian copulas for
the estimation of a copula density, as follows

c(u, v) =

∞

Xj=1

wjcρj (u, v)

(5)

where the weights wj’s sum up to 1 and the ρj’s vary in (−1, 1). This proposal
is motivated by the fact that bivariate density functions on the real plain can
be arbitrarily well approximated by a mixture of a countably inﬁnite number
of bivariate normal distributions of the form

f (y1, y2) =

∞

Xj=1

wjN((y1, y2)|(µ1j, µ2j), Σj)

5

Roughly speaking,

where N((y1, y2)|(µ1j, µ2j), Σj) is the joint bivariate normal density with
mean vector (µ1j, µ2j) and covariance matrix Σj (see Lo (1984) and Ferguson
(1983)).
the authors are mimicking the Dirichlet
in the Copula setting (see Escobar (1994) and
process mixture model
Escobar and West (1995)). The sampling strategy follows the slice sampler
of Walker (2007) and Kalli, Griﬃn, and Walker (2011). The authors show
that the Gaussian mixture is ﬂexible enough to accurately approximate any
bivariate copula density.

3 Conditional

copula

estimation with

Dirichlet process priors

Suppose that the dependence parameter of the conditional copula depends
on the covariate as follows

Cx(u, v) = Cx(u, v; θ(x)),

where θ(x) is a function of the covariate, called calibration function.
Following Abegaz et al. (2012), we model the function θ(x) as a polynomial
of degree p. It is important to highlight that in many copula families the
parameter space is restricted. In contrast, polynomial modeling inherently
assumes that any value on the real line can be taken. For this reason,
we introduce the transformation ψ(θ(x)) = η(x) such that θ(x) = ψ−1(x),
assuming that the inverse transformation ψ−1 exists. We suppose that the
(p + 1)-th continuous derivative of the η function exists at the x point. We
approximate our calibration function η(Xi) for a data point Xi by a Taylor
expansion of degree p:

η(Xi) ≈ η(x) + η ′(x)(Xi − x) + · · · +

η(p)(x)

p!

(Xi − x)p = xt

i,xβ

(6)

where xi,x = (1, Xi − x, . . . , (Xi − x)p)t and β = (β0, . . . , βp)t, with
βι = η(ι)(x)/ι!.
In our implementation, as in Fan and Gijbels (1996) and
Acar et al. (2010), we use the commonly adopted local linear ﬁt, assuming
p = 1.

Our model is based on an inﬁnite mixture of Gaussian copulas, adopting a
similar approach to Wu et al. (2015). However, while the authors restrict

6

their attention to unconditional Gaussian copulas, we extend their work by
considering a conditional Gaussian copulas, assuming that the correlation
coeﬃcient ρ depends on the covariate X. Hence, our Bayesian nonparametric
conditional copula model is deﬁned as

c(u, v|x) =

∞

Xj=1

wjcρj(θj (x))(u, v|x)

(7)

where the weights wj’s sum up to one and the ρj’s vary in (−1, 1). The
parameter ρ is linked to θ(x) via the following transformation

ρ(x) =

2

|θ(x)| + 1

− 1

(8)

where θ ∈ [0, ∞) is modelled by the polynomial approximation described in
equation (6).

4 Posterior sampling algorithm

Following equation (7), given the observations (ui, vi) for i = 1, . . . , n, and
the conditional variable xi, the conditional copula density function for each
pair (ui, vi) can be written as an inﬁnite mixture of conditional Gaussian
copulas, such that:

c(ui, vi|xi) =

∞

Xj=1

wjcρj(θj (xi))(ui, vi|xi)

(9)

where wj’s are the stick-breaking weights, i.e.

wj = πj

j−1

(1 − πl)

Yl=1

where the πj are distributed as a Be(1, b), b > 0. In order to sample from the
inﬁnite mixture displayed in equation (9), we use the slice sampling algorithm
for mixture models proposed by Walker (2007) and Kalli et al. (2011). To
reduce the dimensionality of the problem, the authors introduce a latent
variable zi for each i which allows us to write the inﬁnite mixture model as
follows:

∞

c(ui, vi, zi|xi) =

Xj=1

I(zi < wj)cρj (θj (xi))(ui, vi|xi).

(10)

7

The introduction of the slice variable zi reduces the sampling complexity to
the analogous of a ﬁnite mixture model. In particular, letting

Aw = {j : zi < wj},

(11)

then it can be proved that the cardinality of the set Aw is almost surely
ﬁnite. Consequently, there is a ﬁnite number of parameters to be estimated.
By iterating the data augmentation principle further, we introduce another
latent variable di, which is called allocation variable, allowing us to allocate
each observation to one component of the mixture model. Then, the
conditional copula density c(ui, vi, zi, di|xi) takes the form:

c(ui, vi, zi, di|xi) = I(zi < wdi)cρdi (θdi (xi))(ui, vi|xi)

(12)

where di ∈ {1, 2, . . . }. Hence, the full likelihood function of the conditional
copula model is:

n

Yi=1

c(ui, vi, zi, di|xi) =

n

Yi=1

I(zi < wdi)cρdi (θdi (xi))(ui, vi|xi).

(13)

We use the notation (U, V ) = {i = 1, . . . , n : (ui, vi)}, X = {x1, . . . , xn}
to describe the pseudo-observations and the covariate values, respectively,
θ = {θ1, θ2, . . . , θn} and ρ = {ρ1, ρ2, . . . , ρn} to denote the calibration
and the parameter values, and D = {d1, . . . , dn}, Z = {z1, . . . , zn} and
π = {π1, π2, . . . } to denote the new variables that we have introduced in
this Section. Therefore, we used a Gibbs sampler to simulate iteratively
from the posterior distribution function, according to the following steps:

1. The

stick-breaking
[Z, D, θ, ρ, (U, V ), X];

components

π

are

updated

given

2. The latent slice variables Z are updated given [π, D, θ, ρ, (U, V ), X];

3. The allocation variables D are updated given [π, Z, θ, ρ, (U, V ), X];

4. The calibration and parameter vectors (θ, ρ) are updated given

[π, Z, D, (U, V ), X].

The Gibbs sampling details are explained in Appendix .

8

5 Simulation experiments

This section illustrates the performance of our Bayesian nonparametric
conditional copula model with simulated data. We generate datasets (U, V )
of sizes n = 250, 500 and 1000 from elliptical and archimedean copula
families, such as the Gaussian, Frank and Double Clayton copula, which
combines the regular Clayton copula with its 90◦ rotation, allowing positive
and negative dependence modelling. The copula dependence parameter is
considered as a function of the exogenous variable X, which is simulated
from an Uniform distribution in the interval [−2, 2].

For the simulated data and for the Normal copula mixture, we assume

the following calibration functions for θ:

1. The correlation coeﬃcient is a function of the X variable as follows:

ρ(x) =

2

(θ(x) + 1)

− 1,

where θ(x) is a quadratic calibration function:

θ(x) = α + βx2

adopting uniform priors U(0, 0.2) for α and β.

(14)

(15)

2. The correlation coeﬃcient is a function of the X variable as follows:

ρ(x) =

2

(|θ(x)| + 1)

− 1

where θ(x) is a quadratic calibration function:

θ(x) = α + βx + γ exp (−δx2)

adopting uniform priors U(0, 0.2) for α, β, γ and δ.

(16)

(17)

We run the Gibbs sampler algorithm described in Section 4 for 4000
iterations with (i) 500 burn-in iterations and (ii) 3500 burn-in iterations.
Aiming at a parsimonious representation of the results, we focussed on 3500
burn-in iterations, since 500 burn-in iterations gave very similar results.

Figures 2, 3 and 4 illustrate the results of the application of the Bayesian
nonparametric conditional copula model to data simulated from a gaussian
copula, with sample sizes n = 250, 500 and 1000, respectively. Figures

9

5, 6 and 7 illustrate similar results for the Frank copula; while Figures
8, 9 and 10 illustrate analogous results for the Double Clayton copula.
In Figures 2-10, panels (a), (b), (c) and (d) show the scatter plots and
histograms of the simulated data and the predictive samples, respectively,
obtained using the ﬁrst calibration function; while panels (e), (f), (g)
and (h) show the scatter plots and histograms of the simulated data and
the predictive sample, respectively, obtained using the second calibration
function. The comparison between the simulated and predictive outputs
highlights the excellent ﬁt of the Bayesian nonparametric conditional copula
model using either calibration function and with diﬀerent sample sizes. The
model performance appears to be consistent across all three copula families,
demonstrating that the approach is suitable to model diﬀerent dependence
patterns and tail structures.

6 Real Data applications

We now apply the proposed Bayesian nonparametric conditional copula
method to a sample of 839 adolescent twin pairs, which is a subset of the
National Merit Twin Study (Loehlin and Nichols, 2009, 2014). The dataset
contains questionnaire data from 17 years old twins and their parents, where
the twins were identiﬁed among 600.000 US high school juniors who took part
to the National Merit Scholarship Qualifying Test (NMSQT). The NMSQT
was designed to measure cognitive aptitude, that is students’ readiness for
future intellectual or educational pursuits. The participants to the test
include identical twins and same-sex fraternal twins who were asked to ﬁll
in a complete questionnaire in order to understand their school performance
and attitude. Our purpose is to examine whether the relationship between
twins’ cognitive ability, measured by the NMSQT, is inﬂuenced by their
socioeconomic status, measured by parent education and parental income.
The variables we considered from this study are the overall measures of each
twin’s performance at school (obtained as the sum of individual scores in
English Usage, Mathematics Usage, Social Science Reading, Natural Science
Reading and Word Usage/Vocabulary), the mother’s and father’s level of
education and the family income. The overall scores range from 30 to 160,
the education covariates range from 0 to 6, while the family income covariate
ranges from 0 to 7.

As discussed in Section 1, the scatterplots in Figure 1 clearly show that

10

there is a strong correlation between the twins’ school performance and the
strength of dependence varies according to the values of a covariate, which
is the mother’s (top panel) or father’s level of education (middle panel) or
the family income (bottom panel). In Figure 1 the eﬀect of the covariates is
illustrated by dots of diﬀerent colours, where we notice that most of the light
yellow dots are grouped in the upper right corner, while the dark red dots
lie in the bottom left corner. Therefore, the higher the parents’ education or
family income, the higher the twins’ school performance. In order to model
the eﬀect of a covariate, such as the mother’s and father’s education and
family income, on the dependence between the overall scores of the twins, we
implement the Bayesian nonparametric conditional copula model.

Adopting the same priors of the simulation studies, we run the Gibbs
sampling algorithm described in Section 4 for 4000 iterations. Figures 11, 12
and 13 show, with respect to the mother’s and father’s education and family
income, respectively, the scatterplots of the twins’ overall scores using the real
and transformed pseudo-observations (panels (a) and (b)), the scatterplots
of the predictive and transformed predictive samples (panels (c) and (d)) and
the histograms of the real and the predictive samples (panels (e) and (f)).
From the comparison between the scatterplots and histograms of the real and
predictive samples obtained with the three diﬀerent covariates, it emerges
that the Bayesian nonparametrics conditional copula model accurately
captures the tail structures and the dependence patterns between the twins’
overall scores. We note that the good performance of this approach in tail
modelling makes it suitable to various applications focussing on extremes.
Figure 14 shows the Kendall’s tau estimated from the model against the
mother’s (top panel) and father’s level of education (middle panel) and the
family income (bottom panel). The plots clearly illustrate the negative eﬀect
of all three covariates on the dependence between the twins’ overall scores.
The eﬀect is greater for the family income, where the Kendall’s tau decreases
from approximately 0.83 to 0.43, while for the parents’ education levels the
Kendall’s tau decreases from approximately 0.8 to 0.57. Therefore, the higher
the parents’ education and family income, the better the socioeconomic
status and the higher the diﬀerences between the twins’ school performances.
The cognitive aptitudes of twins from less advantaged families are more
similar than those from high income, highly educated families. This might
suggest, as in Loehlin, Harden, and Turkheimer (2009), that environmental
factors are more inﬂuential in families with lower socio-economic position. On
the contrary, other factors, such as genetic causes, may be more dominant in

11

families with higher socio-economic position.

7 Conclusion

In this paper we proposed a Bayesian nonparametric conditional copula
approach to model the strength and type of dependence between two
variables of interest and we applied the methodology to the National Merit
Twin Study.
In order to capture the dependence structure between two
variables, we introduced two diﬀerent calibration functions expressing the
functional form of a covariate variable. The statistical inference was obtained
implementing a slice sampling algorithm, assuming an inﬁnite mixture model
for the copula. The methodology combines the advantages of the conditional
copula approach with the modeling ﬂexibility of Bayesian nonparametrics.

The simulation studies illustrated the excellent performance of our model
with three distinct copula families and diﬀerent sample sizes. The application
to the twins data revealed the importance of the environment in the
development of twins belonging to low socioeconomic classes and suggest
that genetic factors are more inﬂuential in families with higher socioeconomic
status.

Although this paper focusses on bivariate copula models, the methodology
can be extended to multivariate copulas including more than one covariate.
However,
the inclusion of multiple covariates needs special attention
regarding the choice of variables prior to estimate the calibration functions.
Moreover, the increasing computational cost due to the additional covariates
should be taken carefully into consideration.

Acknowledgements

Fabrizio Leisen was supported by the European Community’s Seventh
Framework Programme [FP7/2007-2013] under grant agreement no: 630677.

References

Abegaz, F., Gijbels, I., and Veraverbeke, N. (2012).

Semiparametric
estimation of conditional copulas. Journal of Multivariate Analysis 110,
43–73.

12

Acar, E. F., Craiu, R. V., and Yao, F. (2010). Dependence calibratin in
conditional copulas: a nonparametric approach. Biometrics 67, 445–453.

Andersen, E. (2005). Two-stage estimation in copula models used in family

studies. Lifetime Data Analysis 11, 333–350.

Baker, S. (2016). The latent class twin method. Biometrics .

Bartram, S., Taylor, S., and Wang, Y. (2007). The Euro and European
ﬁnancial market dependence. Journal of Banking and Finance 31, 1461–
1481.

Bates, T., Lewis, G., and Weiss, A. (2013). Childhood socioeconomic status
ampliﬁes genetic eﬀects on adult intelligence. Psychological Science 24,
2111–2116.

Braekers, R. and Veraverbeke, N. (2005). A copula-graphic estimator for
the conditional survival function under dependent censoring. Canadian
Journal of Statistics 33, 429–447.

Cherubini, U., Luciano, E., and Vecchiato, W. (2004). Copula methods in

ﬁnance. John Wiley and Sons .

Craiu, R. V. and Sabeti, A. (2012). In mixed company: Bayesian inference for
bivariate conditional copula models with discrete and continuous outcomes.
Journal of Multivariate Analysis 110, 106–120.

Emura, T. and Wang, W. (2012). Nonparametric maximum likelihood
estimation for dependent truncation data based on copulas. Journal of
Multivariate Analysis 110, 171–188.

Escobar, M. D. (1994). Estimating normal means with a Dirichlet process

prior. Journal of the American Statistical Association 89, 268–277.

Escobar, M. D. and West, M. (1995). Bayesian density estimation and
inference using mixtures. Journal of the American Statistical Association
90, 577–588.

Fan, J. and Gijbels, I. (1996). Local polynomial modelling and its applications,

volume 66. Chapman & Hall.

13

Ferguson, T. (1983). Bayesian density estimation by mixtures of normal

distributions, pages 287–303. New York: Academic Press.

Gijbels, I., Omelka, M., and Veraverbeke, N. (2012). Multivariate and
functional covariates and conditional copulas. Electronic Journal of
Statistics 6, 1273–1306.

Huang, X. and Zhang, N. (2008). Regression survival analysis with an
assumed copula for dependent censoring: a sensitivity analysis approach.
Biometrics 64, 1090–1099.

Joe, H. (2014). Dependence Modeling with Copulas. Chapman & Hall.

Jondeau, E. and Rockinger, M. (2006). The copula-GARCH model of
conditional dependencies: An international stock market application.
Journal of International Money and Finance 25, 827–853.

Kalli, M., Griﬃn, J. E., and Walker, S. G. (2011). Slice sampling mixture

models. Statistics and Computing 21, 93–105.

Kolev, N., dos Anjos, U., and Vaz de Mendes, B. (2006). Copulas: a review

and recent developments. Stochastic Models 22, 617–660.

Lo, A. (1984). On a class of Bayesian nonparametric estimates i: density

estimates. Annals of Statistics 12, 351–357.

Loehlin, J., Harden, K., and Turkheimer, E. (2009). The eﬀect of assumptions
about parental assortative mating and genotype–income correlation on
estimates of genotype–environment interaction in the national merit twin
study. Behavior Genetics 39, 165–169.

Loehlin, J. and Nichols, R. (2009). The National Merit twin study. Harvard

Dataverse, V3, http://hdl.handle.net/1902.1/13913 .

Loehlin, J. and Nichols, R. (2014). Heredity, environment and personality:

A study of 850 sets of twins. University of Texas Press .

Owzar, K., Jung, S.-H., and Sen, P. K. (2007). A copula approach for
detecting prognostic genes associated with survival outcome in microarray
studies. Biometrics 63, 1089–1098.

14

Patton, A. J. (2006). Modelling asymmetric exchange rate dependence.

International Economic Review 47, 527–556.

Sklar, A. (1959). Fonctions de r´eparation `a n dimensions et leurs marges.
Publications de l’Institut de Statistique de l’Universit´e de Paris 8, 229–231.

Walker, S. G. (2007). Sampling the Dirichlet mixture model with slices.

Communications in Statistics - Simulation and Computation 36, 45–54.

Wang, X., Guo, X., He, M., and Zhang, H. (2011). Statistical inference
in mixed models and analysis of twin and family data. Biometrics 67,
987–995.

Wu, J., Wang, X., and Walker, S. (2015). Bayesian nonparametric estimation
of a copula. Journal of Statistical Computation and Simulation 85, 103–
116.

A Gibbs sampling details

Let Dj = {i = 1, . . . , n : di = j} be the set of indexes of the observations
allocated to the j-th component of the mixture, while D = {j : Dj 6= ∅} is the
set of indexes of non-empty mixtures components. Let D∗ = sup {D} be the
number of stick-breaking components used in the mixture. As in Kalli et al.
(2011), the sampling of inﬁnite elements of π and (ρ, θ) is not necessary,
since only the elements of the full conditional probability density functions
of D are need.

The maximum number of stick-breaking components to be sampled is:

N ∗ = max {i = 1, . . . , n|N ∗
i }

where N ∗
i

is the smallest integer such that PN ∗

i

j=1 wj > 1 − zi.

A.1 Update of π

We update the stick-breaking components and consequently the weights wj

based on the equation wj = πj Qk<j(1 − πk). Assuming that πj is distributed

as a Beta (Be(1, b)), the full conditional distribution of πj is:

πj| · · · ∼ Be(1 + #{di = j}, b + #{di > j})

(18)

15

where #{di = j} are the number of di equal to j and #{di > j} is the
number of di greater than j for j < D∗.

On the other hand, if j = D∗ + 1, . . . , N ∗ we have that

πj| · · · ∼ Be(1, b).

A.2 Update of Z

From the full likelihood function (13), zi follows a uniform distribution

zi| · · · ∼ U(0, wdi)

(19)

and it is sampled accordingly.

A.3 Update of D

The allocation variable di values lie between 0 and Ni and the density of di
satisﬁes

P (di = j| . . . ) ∝ I(zi < wdi)cρj (θdi (xi))(ui, vi|xi).

(20)

A.4 Update of (θ, ρ)

The full conditional of the parameters of the calibration function θ(x) is:

f (θ(x)| . . . ) ∝ f (θ(x)) Ydi=j

cρdi (θj (xi)(ui, vi|xi),

(21)

where f (θ(x)) is the prior on θ(x).
Since the (21) is not a standard
distribution, we used a Random Walk Metropolis Hastings with proposal
distributed as a truncated Normal in the interval (0, ∞). Consequently ρ is
derived using equation (8).

16

180

160

140

120

100

80

60

40

i

n
w

t
 

d
n
o
c
e
s
 

e
r
o
c
s
 
l

a

t

o
T

20

20

180

160

140

120

100

80

60

40

i

n
w

t
 

d
n
o
c
e
s
 

e
r
o
c
s
 
l

a

t

o
T

20

20

180

160

140

120

100

80

60

40

i

n
w

t
 
d
n
o
c
e
s
 

e
r
o
c
s
 
l

a

t

o
T

20

20

n
o
i
t
a
c
u
d
e
 
f
o
 
l
e
v
e
l
 
s
‘
r
e
h
t
o
M

n
o

i
t

a
c
u
d
e

 
f

o

 
l

e
v
e

l
 
s
‘
r
e
h
a
F

t

6

5

4

3

2

1

0

6

5

4

3

2

1

0

7

6

5

4

3

e
m
o
c
n

i
 
s
y

‘

l
i

m
a
F

2

1

0

40

60

80

100

120

140

160

Total score first twin

40

60

80

100

120

140

160

Total score first twin

40

60

80

100

120

140

160

Total score first twin

Figure 1: Scatterplots of the twins overall scores with respect to the mother’s
(top panel) and father’s level of education (middle panel) and family income
(bottom panel).

17

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 2: Gaussian copula with sample size n = 250. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

18

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 3: Gaussian copula with sample size n = 500. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

19

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 4: Gaussian copula with sample size n = 1000. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

20

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 5: Frank copula with sample size n = 250. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

21

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 6: Frank copula with sample size n = 500. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

22

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 7: Frank copula with sample size n = 1000. Panels (a), (b), (c) and
(d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

23

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 8: Double Clayton copula with sample size n = 250. Panels (a), (b), (c)
and (d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

24

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 9: Double Clayton copula with sample size n = 500. Panels (a), (b), (c)
and (d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

25

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(a) Simulated, 1st cal.fun.

(b) Simulated, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Predictive, 1st cal.fun.

(d) Predictive, 1st cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(e) Simulated, 2nd cal.fun.

(f) Simulated, 2nd cal.fun.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(g) Predictive, 2nd cal.fun.

(h) Predictive, 2nd cal.fun.

Figure 10: Double Clayton copula with sample size n = 1000. Panels (a), (b), (c)
and (d) depict the scatter plots and histograms, obtained with the ﬁrst calibration
function, of the simulated and predictive samples, respectively; panels (e), (f),
(g) and (h) depict the scatter plots and histograms, obtained with the second
calibration function, of the simulated and predictive sample, respectively.

26

180

160

140

120

100

80

60

40

20

20

180

160

140

120

100

80

60

40

20

20

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

(a) Real data

(b) Transformed pseudo-observations

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

180

(c) Predictive sample

(d) Predictive transformed sample

(e) Histogram of real data

(f) Predictive histogram

Figure 11: Panels (a) and (b): scatterplots of the twins’ overall scores for the
real and pseudo-observations with respect to the mother’s level of education;
panels (c) and (d): scatterplots of the predictive and transformed predictive
sample; panels (e) and (f): histograms of the real data and the predictive
sample.

27

180

160

140

120

100

80

60

40

20

20

180

160

140

120

100

80

60

40

20

20

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

(a) Real data

(b) Transformed pseudo-observations

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

180

(c) Predictive sample

(d) Predictive transformed sample

(e) Histogram of real data

(f) Predictive histogram

Figure 12: Panels (a) and (b): scatterplots of the twins’ overall scores for the
real and pseudo-observations with respect to the father’s level of education;
panels (c) and (d): scatterplots of the predictive and transformed predictive
sample; panels (e) and (f): histograms of the real data and the predictive
sample.

28

180

160

140

120

100

80

60

40

20

20

180

160

140

120

100

80

60

40

20

20

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

(a) Real data

(b) Transformed pseudo-observations

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

40

60

80

100

120

140

160

(c) Predictive sample

(d) Predictive transformed sample

(e) Histogram of real data

(f) Predictive histogram

Figure 13: Panels (a) and (b): scatterplots of the twins’ overall scores for the
real and pseudo-observations with respect to the family income; panels (c)
and (d): scatterplots of the predictive and transformed predictive sample;
panels (e) and (f): histograms of the real data and the predictive sample.

29

0.85

0.8

u
a

t
 
s

‘
l
l

a
d
n
e
K

 
l

a
n
o

i
t
i

d
n
o
C

0.75

0.7

0.65

0.6

0.55

0

0.8

0.75

0.7

0.65

0.6

u
a

t
 
s

‘
l
l

a
d
n
e
K

 
l

a
n
o

i
t
i

d
n
o
C

0.55

0

0.85

0.8

0.75

0.7

0.65

0.6

0.55

0.5

0.45

u
a

t
 
s

‘
l
l

a
d
n
e
K

 
l

a
n
o

i
t
i

d
n
o
C

1

2

3

4

5

6

Mother‘s level of education

(a) Mother’s level of education

1

2

3

4

5

6

Father‘s level of education

(b) Father’s level of education

0.4

0

1

2

3

4
Family‘s income

5

6

7

(c) Family income

Figure 14: Estimated Kendall’s tau against the mother’s (top panel) and
father’s level of education (middle panel) and the family income (bottom
panel).

30

