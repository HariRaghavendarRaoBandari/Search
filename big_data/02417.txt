6
1
0
2

 
r
a

 

M
0
2

 
 
]
h
p
-
t
n
a
u
q
[
 
 

2
v
7
1
4
2
0

.

3
0
6
1
:
v
i
X
r
a

Quantum thermodynamics with constrained ﬂuctuations in work

Jonathan G. Richens1, 2 and Lluis Masanes2

1Controlled Quantum Dynamics theory group, Department of Physics,

Imperial College London, London SW7 2AZ, UK.

2Department of Physics and Astronomy, University College London, Gower Street, London WC1E 6BT, UK.

In the standard framework of thermodynamics the work produced or consumed in a process is a ran-
dom variable whose average is bounded by the change in the free energy of the system. This average
work is calculated without regard for the size of its ﬂuctuations. We ﬁnd that in some processes,
such as reversible cooling, the ﬂuctuations of the work given by the change in free energy can diverge.
Small or fragile thermal machines may be unable to cope with arbitrarily large ﬂuctuations. Hence,
with the present focus on nano-scale thermodynamics, we analyse how thermodynamic eﬃciency
rates are modiﬁed when the size of these ﬂuctuations are restricted. We quantify the work content
and work of formation of arbitrary ﬁnite dimensional quantum states when the work ﬂuctuations are
bounded by a given amount c. By varying c we interpolate between the work given by the change
in the standard free energy c =∞ and the min-free energy c = 0, deﬁned in the context of single-shot
thermodynamics. We derive fundamental relations between average and deterministic work, and
explore the emergence of irreversibility and partial order on state transformations when bounding
ﬂuctuations. We also study the eﬃciency a single qubit thermal engine model with constrained
ﬂuctuations, and derive the corrections to the Carnot eﬃciency.

Historically, thermodynamics has been a theory of
macroscopic systems comprising of many particles. As
we venture away from the thermodynamic limit we must
question the validity of established principles. Recently,
the problem of extracting work from a microscopic quan-
tum system has received much attention [1–5]. The stan-
dard free energy is used to calculate the maximal amount
of average work that can be extracted from a system in
thermal contact with an inﬁnite heat bath. Generally
the work extracted on each running of the protocol ﬂuc-
tuates, but in the thermodynamic limit the relative size
of ﬂuctuations in work vanishes. However, in the case
of microscopic systems, and systems that are far from
equilibrium, ﬂuctuations in the work can no longer be
ignored. It is of signiﬁcant practical importance that we
understand these ﬂuctuations in order to describe the be-
haviour of small and fragile machines such as quantum
heat engines comprising of just a few qubits [6–8]. Real-
istic thermal machines are designed to operate at speciﬁc
energies with a certain tolerance to ﬂuctuations. Taking
into account this inevitable fragility requires a modiﬁed
free energy that tells us the average work associated with
a process when ﬂuctuations in that work are constrained.
One approach to dealing with ﬂuctuations is to simply
not allow for them. This is the tactic employed by single-
shot thermodynamics, a recently developed approach to
quantum thermodynamics inspired by the ﬁeld of single-
shot information theory [1, 4, 5]. The single-shot (de-
terministic) work associated with a process is given by
the diﬀerence in min-free energy between initial and ﬁ-
nal states [1, 4], which is generally signiﬁcantly smaller
that the standard free energy diﬀerence. The work cost
of forming a state from the Gibbs state is given by the
max-free energy [1, 4], which is generally signiﬁcantly
larger than the deterministic work that can be extracted
from the state. This discrepancy between the work cost
and work content of states in the single-shot regime re-
sults in thermodynamic irreversibility when transforming
between states. Furthermore, the set of allowed thermo-
dynamic transformations in the single-shot regime are
severely restricted.
In this regime, it is possible for a
state to undergo a transition ρ → ρ(cid:48) deterministically

(and without supplying work) on the condition that an
inﬁnite family of “second laws” are satisﬁed [9]. Some
transitions ρ ↔ ρ(cid:48) can only be achieved by supplying
work in both forward and backward directions, result-
ing in a partial order on the set of states with respect
to the resource of work [9]. This is in stark contrast to
when we allow work to ﬂuctuate freely, whereby all states
can be inter-converted in a thermodynamically reversible
manner. One may be tempted to assume that the funda-
mental irreversibility and partial order are idiosyncratic
of the single-shot regime, due to the strong constraint of
requiring work to be a deterministic quantity. In this ar-
ticle we show that there are always state transformations
that can only be achieved in a thermodynamically irre-
versible way, or exhibiting a partial order with respect
to work, if we demand only that work cannot ﬂuctuate
inﬁnitely.

To date the majority of thermodynamic protocols treat
work either as an unconstrained random variable or a to-
tally constrained (deterministic) quantity. In this article
we explore the landscape of protocols that exist between
these two regimes. We ﬁnd that many processes, for ex-
ample thermodynamically reversibly cooling, result in di-
verging ﬂuctuations in work. This makes realising these
protocols practically infeasible, especially for small and
fragile machines. To this end we deﬁne the c-bounded
work, giving the optimal average work (cid:104)w(cid:105) associated
with a process for which all ﬂuctuations of the random
variable w are bounded as

| w − (cid:104)w(cid:105)| ≤ c

(1)

where c is a adjustable parameter. We explore how
bounding work ﬂuctuations aﬀects work extraction,
state formation and the allowed state transformations of
individual systems. Finally, we use the c-bounded work
to derive a corrected Carnot eﬃciency for a single qubit
engine model when ﬂuctuations in the work produced
by the engine are constrained.

The organisation of the paper is as follows.

In the
ﬁrst section we introduce the framework within which
we derive our results. In the second and third sections
we discuss deterministic and unbounded average work

extraction and work of
formation, and discuss the
conditions under which ﬂuctuations associated with
reversible processes diverge. We then introduce and
characterise the c-bounded work, and in the ﬁnal section
we apply these results to the study of a single qubit heat
engine.

The framework. In this section we provide a precise de-
scription of our framework, describing the system, bath,
work system and the set of allowed operations.

We make use the widely applied set-up for thermo-
dynamic protocols of system, inﬁnite thermal bath and
a weight, which acts as a store and source of the work
produced or consumed by a protocol [2, 3, 10].
In the
following we set the Boltzmann constant kB to 1. The
bath has inﬁnite volume and it is in the Gibbs state
ρB = 1
e−βHB , where β is the inverse temperature, HB
ZB
the Hamiltonian, and ZB the partition function.
pendent only on its displacement HW = (cid:82)
The work system is modelled as a suspended weight
with a continuous energy spectrum and Hamiltonian de-
R dx x|x(cid:105)(cid:104)x|,
where the orthonormal basis {|x(cid:105),∀ x ∈ R} represents
the position of the weight. In order to deﬁne work as a
classical random variable w, the position of the weight is
measured at the beginning and end of the protocol.

dt e−iH

(cid:48)
Stρ(cid:48) eiH

(cid:48)
St =

(cid:90)
(cid:90)

xs|s(cid:105)(cid:104)s| ,

dt e−iHStρ eiHSt =

The system being transformed has Hilbert space of di-
mension d, initial state and Hamiltonian (ρ, HS), and ﬁ-
nal state and Hamiltonian (ρ(cid:48), H(cid:48)S). It is useful to deﬁne
the initial and ﬁnal dephased states and their spectral
decompositions

(cid:88)
(cid:88)
the spectral decompositions HS =(cid:80)
(cid:80)
The two bases |s(cid:105) and |s(cid:48)(cid:105) deﬁned above, allow to write
s Es|s(cid:105)(cid:104)s| and H(cid:48)S =
s(cid:48) Es(cid:48)|s(cid:48)(cid:105)(cid:104)s(cid:48)|.
(Note that we use notation xs(cid:48) and Es(cid:48)
instead of x(cid:48)s(cid:48) and E(cid:48)s(cid:48).) Finally, we assume that initially
the joint state of system, bath and weight is product
ρ ⊗ ρB ⊗ ρW. We consider any process that is a joint
transformation of system, bath and weight represented
by a Completely Positive Trace Preserving (CPTP) map
ΓSBW satisfying the following conditions:

xs(cid:48)|s(cid:48)(cid:105)(cid:104)s(cid:48)| .

s

s

(2)

(3)

Microscopic reversibility (Second Law): It has an
SBW, which implies unitarity

(CPTP) inverse Γ−1
ΓSBW(ρSBW) = U ρSBWU†.

Energy conservation (First Law): [U, HS + HB +

HW] = 0.

Independence from the “position” of the weight:
The unitary commutes with the translations on
the weight [U, ∆W] = 0. The generator of the
translations ∆W is canonically conjugated to the
position of the weight [HW, ∆W] = i.

Classicality of work: Before and after applying the
global map ΓSBW the position of the weight is mea-
sured, obtaining outcomes |x(cid:105) and |x + w(cid:105) respec-
tively. The joint transformation of the system and

(cid:90)

work random variable w is given by the map

(cid:2)Qx+w U (ρS ρB QxρWQx) U†(cid:3) ,

Λ(ρS, w) =

dx trBW

R

2

(4)
where Qx = |x(cid:105)(cid:104)x| is a weight position projector.
The assumption that the dynamics of a closed system
is reversible and conserves energy is widely used, because
it corresponds to a common physical setup. The third
condition implies that the reduced map on the system
and bath is a mixture of unitaries, and therefore cannot
decrease the entropy of the joint state of system and
bath (See Result 1 in [10]). This ensures that the weight
cannot be used as a source of non-equilibrium, and
can be viewed as a necessary condition for deﬁning
work [2, 11]. A consequence of the fourth condition is
that the dynamics of the “diagonal part” of the state
xs → xs(cid:48) decouples from the rest of the transformation
ρ → ρ(cid:48) (See Appendix 1C). In the case of optimal work
extraction and work of formation we ﬁnd that the initial
/ ﬁnal state is diagonal (See Appendix 3A). Therefore
we need only to consider to diagonal part of the state,
denoted xs, when determining the work content and
work of formation of a state.

F min(ρ) = −β−1 log(cid:80)

Deterministic work. The single-shot work content of
a system is given by the diﬀerence in min free energy
s e−βEs between the state ρ and

s x0

the thermal state

s e−βEs ,
x0

(5)

W (0)(ρ) =

1
β

log Z −

1
β

log

s

Z = tr(cid:0)e−βHS(cid:1) is the partition function of the sys-

where x0 returns 1 if x > 0 and 0 if x = 0, and

tem [1, 4].
If xs has full rank then min free energy is
−β−1 log Z. Therefore non-zero deterministic work can
only be extracted from states that are not of full rank.
The single-shot work of formation is

(cid:88)

W (0)

F (ρ) =

1
β

log Z +

1
β

log max

s

xs eβEs .

(6)

i.e.

F (ρ) > W (0)(ρ),

In general we ﬁnd that W (0)
it
is not possible to form most states in a thermody-
namically reversible manner. When a weight is not
present, the necessary and suﬃcient condition for a
state transformation (ρ, HS) → (ρ(cid:48), H(cid:48)S) to be possible
If in
is given by the thermo-majorisation criteria [1].
addition a catalyst is used, the necessary and suﬃcient
conditions are given in [9]. The key phenomenon is
that in single-shot thermodynamics there is a partial
order on states, i.e. there are state transitions that are
impossible,
in both forward and backward directions,
without supplying work.
In contrast thermodynamic
irreversibility and partial order are not observed in the
standard thermodynamic formalism,
in which work is
allowed to ﬂuctuate freely, as we discuss next.

Work with unbounded ﬂuctuations. The maxi-
mum average work that can be extracted from a sys-
tem with the assistance of a heat bath with inverse tem-
perature β is given by the diﬀerence in free energy be-
tween ρ and the Gibbs state. The free energy is given by

F (ρ) = (cid:104)E(cid:105) − β−1S(ρ), (cid:104)E(cid:105) = tr (ρ HS) =(cid:80)
(cid:80)

s xsEs is the
internal energy of the state, S(xs) = −
s xs log xs is the
entropy of the de-phased state. The Gibbs state, with en-
ergy level occupation probabilities xs = Z−1e−βEs , is the
unique state given HS and β with the lowest free energy
(given by −β−1 log Z). Therefore the optimal average
work that can be extracted from an out of equilibrium
state is given by W (∞) = β−1 log Z + F (ρ). In the re-
verse process of state formation the work cost is also given
by the diﬀerence in free energy between initial and ﬁnal
states. In other words, if we do not bound ﬂuctuations
in the work it is always possible to realise all state trans-
formations in a thermodynamically reversible way. This
poses the question - what is the minimum amount we
must allow work to ﬂuctuate in order for a transition to
be achievable with a thermodynamically reversible pro-
tocol?

Result 1. There exists a thermodynamically reversible
process achieving the transition (ρ, HS) → (ρ(cid:48), H(cid:48)S) with
ﬂuctuations in work less than or equal to c if

eβ(∆F−c) ≤

xseβEs
xs(cid:48)eβEs(cid:48) ≤ eβ(∆F +c) ∀ s, s(cid:48) ,

(7)

where ∆F = F (ρ) − F (ρ(cid:48)) is the change in the standard
free energy. This becomes a necessary and suﬃcient con-
dition if the initial and/or or ﬁnal state is diagonal in
the energy eigenbasis

Proof. See Appendix 2

Note that for any ﬁnite c there exist states such that
(7) cannot be satisﬁed. These bounds have strong conse-
quences for the minimal ﬂuctuations that can be achieved
with a thermodynamically reversible protocol. For exam-
ple

log

log

lim
xi→0

xseβEs
xs(cid:48)eβEs(cid:48) = − lim
xs(cid:48)→0

xseβEs
xs(cid:48)eβEs(cid:48) = −∞ (8)
Therefore as an energy level occupation probability tends
to zero the work ﬂuctuation associated with transition-
ing to or from this energy level diverges, negatively for
work extraction and positively for state formation, when
performing a thermodynamically reversible protocol.
In either case we require c → ∞ in order to satisfy
inequalities (7).
Result 1 tells us that the further from equilibrium
the larger the work
the initial or ﬁnal states are,
ﬂuctuations will be in thermodynamically reversible
protocols. Note that cooling a system close to its ground
state is an example of transitioning from the thermal
state to a far from equilibrium state. Similarly, if we
want to extract work form a far from equilibrium state
using a thermodynamically reversible transformation
we encounter the same divergence in ﬂuctuations. The
ﬂuctuations can diverge even if the average work remains
small (for example, if the system is a qubit with trivial
Hamiltonian then W ≤ β−1 log 2). These divergences
have been previously noted in the recent study of
absolute irreversibility [12, 13].

Previous discussions of the inadequacy of the standard
free energy in the nano-regime have focused on the
deﬁnitions of work [4, 5]. Here we add another criticism,

3

that using the standard free energy to describe work we
necessarily requires set-ups that can tolerate arbitrary
ﬂuctuations, which diverge in size for processes with
initial or ﬁnal states that are increasingly far from
equilibrium.

Work with bounded ﬂuctuations.
Motivated by these observations we deﬁne the c-bounded
work content W (c)(ρ) as the maximum average work that
can be extracted from state ρ with initial Hamiltonian
HS and ﬁnal Hamiltonian H(cid:48)S, when the ﬂuctuations of
the work are constrained by c, as in (1). Analogously,
we deﬁne the c-bounded work of formation W (c)
F (ρ) as
the minimal average work that is necessary to create a
state ρ with Hamiltonian H(cid:48)S from the Gibbs state (with
respect to initial Hamiltonian HS), such that ﬂuctuations
in the work are bounded by c.

Result 2. The c-bounded work content W (c)(ρ) and work
of formation W (c)

F (ρ) are given by
1
β

log Z(cid:48) −

1
β

log

(cid:88)
(cid:16)

s

xs
β

log

s∈Xu

(cid:48)

sZ

(cid:34)(cid:88)

(9)

(cid:35)

(10)

W (c)

xseβE

1
Xu

s e−β(Es−θ(c)
s )
x0

W (c)(ρ) =

+c (1−Xu)

F (ρ) =

(cid:17)
First we describe the terms in (9). Z(cid:48) =(cid:80)

Proof. See Appendices 3 and 4 respectively

included in the summation. θ(c)
s

s(cid:48) e−βEs(cid:48) is
the partition function of the ﬁnal Hamiltonian H(cid:48)S. The
second term can be viewed as a generalisation of the min
free energy (5) that allows for ﬂuctuations in work θ(c)
s .
The only diﬀerence to the min free energy is the term
eβθ(c)
is the ﬂuctuation
of the work marginal from the c-bounded average W (c)(ρ)
given that the system was initially in state |s(cid:105). In order
to ﬁnd the ﬂuctuations associated with the optimal c-
bounded work extraction protocol we must partition the
energy levels into three disjoint subsets {1, 2, . . . , d} =
Xu∪X+∪X−, representing the energy levels with positive
X+, negative X− and unbounded Xu ﬂuctuations. We
also deﬁne

s

Xu = (cid:80)
X± = (cid:80)

xs ,
s∈Xu
s∈X±xs .
determining

The

algorithm for

partition
Xu ∪ X+ ∪ X−, which requires the checking of at
most d − 1 inequalities, is described Appendix 3B. Once
we have determined the partition, the ﬂuctuations are
given by

the

(11)

(12)

(13)

(14)

(15)

 1

β log(xseβEs ) − ν,
+c,
−c,

s ∈ X+
s ∈ X−

s ∈ Xu

θ(c)
s =

where

1
Xu

(cid:88)

ν =

Fu(ρ) =

(Fu + c(X+ − X−))
xs log(xseβEs)

s∈Xu

where Fu(ρ) is the un-normalised free energy calculated
for the unbounded partition only. Note that W (c)(ρ)
can be written in the more compact form

W (c)(ρ) =

1
β

log Z(cid:48)−

1
β

where

log(cid:0)Xue−βν + Z+eβc + Z−e−βc(cid:1)
(cid:88)

(16)

e−βEs

(17)

Z± =

s∈X±

are the partition functions calculated over the positive
and negative bounded partitions respectively. In Appen-
dices 3 and 4 we ﬁnd that in the optimal work extrac-
tion and state formation protocols the ﬁnal / initial state
of the system is the Gibbs state, which is diagonal in
the energy eigenbasis. Hence equations (9) and (10) give
the optimal work for arbitrary quantum states (See Ap-
pendix 1C). For a two-level quantum system d = 2, the
work content can be expressed succinctly as

 1

1

W (c)(ρ) =

1

β log Z(cid:48) − 1
β log Z(cid:48) − 1
β log Z(cid:48) + F (ρ)

β log(cid:2)e+βc(cid:0)1 + e−β(E+c/x1)(cid:1)(cid:3)
β log(cid:2)e−βc(cid:0)1 + e−β(E−c/x1)(cid:1)(cid:3)

(18)

if c < ξ
if c > −ξ
otherwise

where

ξ =

1
β

ln(1−x1) − F (ρ) .

(19)

Without loss of generality we have assumed above
x1 ≥ x2 and w deﬁne E = E1 − E2. The above expression
derives from (16) and the partitioning algorithm given
in Appendix 3.

state of the system, is given by H(cid:48)S =(cid:80)

Returning to the c-bounded work of formation, (10)
and the algorithm for ﬁnding the state space partition
giving the c-bounded work of formation (10) is detailed
in Appendix 4. Note that the hamiltonian of ρ, the ﬁnal
j E(cid:48)j |j(cid:105)(cid:104)j|. The
work of formation for a two level system can be succinctly
stated as

(cid:40) 1

(cid:16)

(cid:17)

W (c)

F (ρ) =

β log Z − F (ρ) ,
1
Z
β log

x eβE

(cid:48)

c ≥ ξ
x , c < ξ

+ c 1−x

(20)

where ρ = x|0(cid:105)(cid:104)0|+(1−x)|1(cid:105)(cid:104)1|, x ≥ 1/2 and HS = E |0(cid:105)(cid:104)0|
is the Hamiltonian of the initial Gibbs state.

We now summarise some of the properties of the c-

bounded work.

Result 3. The c-bounded work is related to the non-
ﬂuctuating work by inequalities

W (c)(ρ) ≤ W (0)(ρ) + c
W (c)
F (ρ) ≥ W (0)
F (ρ) − c

(21)

(22)

becoming strict inequalities for c > 0

4

FIG. 1: ﬁgure shows the unbounded work W (ρ), the c-
bounded work content W (c)(ρ) and the c-bounded work of
F (ρ) for the state ρ = x|0(cid:105)(cid:104)0| +(1−x)|1(cid:105)(cid:104)1| with
formation W (c)
Hamiltonian Hs = E |0(cid:105)(cid:104)0| with β = 1, E = 0.1 and c = 0.7.
The red shaded area gives the average work dissipated forming
F (ρ) − W (∞)(ρ),
the state due to bounding ﬂuctuations, W (c)
and the blue shaded are gives the average work dissipated
when extracting c-bounded work, W (c)(ρ) − W (∞)(ρ). Note
that despite choosing a c-bound that allows for ﬂuctuations of
the order of the maximal work that can be extracted from the
pure state x = 1, in general we can extract much less that this
amount. There is a discontinuity in W (c)(ρ) at x = 0 where
we recover W (c)(ρ) = W (∞)(ρ). Notice also that closer to the
thermal state the dissipation is greater for state formations
than work extraction, and this reverses as the state becomes
more athermal.

Proof. See Appendix 5B

These inequalities imply that in order to do better
than single shot work extraction / state formation, our
work must have ﬂuctuations that are greater than the
increase in work / decrease in work cost with respect
to the deterministic work. In Appendix 7 we show that
the c-bounded work distributions that give W (c)(ρ) and
W (c)
F (ρ) obey the Jarzinski equality [14]. In Appendix 5
W (c)(ρ) = W (0)(ρ) and similarly for
we prove that lim
c→0
W (c)

F (ρ).
For the interested reader, it is simple to see that for
any ﬁnite c a partial ordering of the states w.r.t work
emerges. A simple way to observe this is to choose a
qubit state ρ with Hamiltonian HS and a thermal qubit
state γ with Hamiltonian H(cid:48)S (cid:54)= HS such that neither
state thermo-majorizes the other (see [1] for examples).
For any two such states there is a value of c below
which W (c)(ρ) (for ρ → γ) is negative and W (c)
F (ρ)
(for γ → ρ) is positive, i.e.
it costs work to perform
both the forward and backwards transitions. Note that
there are states with the same standard free energy that
exhibit a partial order for ﬁnite c. Allowing the weight
to ﬂuctuate allows us to transition between these states
freely. This is an example of how weight is not just a
resource for extracting additional ﬂuctuating work but
in accommodating dynamics, even when on average its

xworkW(⇢)W(c)(⇢)W(c)F(⇢)0.700.750.800.850.900.951.000.00.10.20.30.40.50.60.7half of the cycle is given by

 1

βH
1
βH

(cid:16)
(cid:16)

log

log

(cid:17)

ZH
ZC
ecβH ZC +e−EβH

ZH eβH c

+ tr[HsρC]

(cid:17)
(cid:18) βC − βH

βH

βH

(cid:16) βH−βC
(cid:19)

, if A ≤ c

A = E
ZC

5

(cid:17)

, if A > c

(24)

(25)

W (c)

1 (ρ) =

where

FIG. 2: ﬁgure shows W (c)
F (ρ) and W (c)(ρ) v.s. c for the trit
state ρ = 0.7|0(cid:105)(cid:104)0| + 0.2|1(cid:105)(cid:104)1| + 0.1|2(cid:105)(cid:104)2| with Hamiltonian
Hs = E1 |0(cid:105)(cid:104)0| + E2 |1(cid:105)(cid:104)1| with E1 = 0.1, E2 = 0.2. β is set
to 1. The red shaded area gives gives the work dissipated in
F (ρ)−W (∞)(ρ), and the blue shaded are
forming the state, W (c)
gives the work dissipated when extracting work from the state,
W (ρ)(∞) − W (c)(ρ). The diﬀerent colours represent diﬀerent
partitions used in calculating the bounded work. For small c
the formation protocol is more dissipative that the extraction
protocol, and for large c the relationship is inverted. Note
that for c > 0.9 it possible to reversibly prepare state ρ but
not to reversibly extract work from it.

displacement remains zero.
It is an interesting open
question to determine how much we must allow work
to ﬂuctuate to allow a transition ρ → ρ(cid:48) to be achieved
without costing work.

Qubit Carnot engine.
In this section we ﬁnd the
c-bounded Carnot eﬃciency for a qubit carnot engine
model, i.e. the maximal eﬃciency the qubit engine can
reach given that ﬂuctuations in the work it produces are
bounded by c. We use the same single qubit engine
model as described in [2]. The engine operates by mov-
ing a qubit ρ with Hamiltonian Hs = E |0(cid:105)(cid:104)0| between
two baths of inverse temperature βH and βC, with βH <
βC. The qubit has state ρH,C = Z−1
H,Ce−βH,CE |0(cid:105)(cid:104)0| +
Z−1
H,C |1(cid:105)(cid:104)1| when in equilibrium with the hot / cold bath,
where ZH,C = 1 + e−βH,CE . The engine cycle begins with
the qubit in thermal equilibrium with the cold bath. In
the ﬁrst half of the cycle it is then placed in contact with
the hot bath and work is extracted. In the second step
of the cycle the qubit is returned to the cold bath and
work is extracted a second time. In Appendix 6 we show
that, in the case that ﬂuctuations are not bounded, it is
possible to reach Carnot eﬃciency with this engine, as
shown in [2].

ηCarnot = 1 −

βH
βC

(23)

In the case that c is ﬁnite, the work extracted in the ﬁrst

if A ≤ c we simply extract the diﬀerence in free energy
between the two thermal states, otherwise we extract the
c-bounded work of ρC in contact with the bath βH . Sim-
ilarly, on the second part of the cycle we extract

 1

βC
1
βC

(cid:16)
(cid:16)

log

log

ZC
ZH
e−cβCZH +e−EβC

−βC c

ZC e

(cid:17)

(cid:17)

βH

+ tr[HsρH ]

(cid:16) βC−βH
(cid:17)
(cid:19)
(cid:18) βC − βH

, if B ≤ c

βC

B = E
ZH

, if B > c

(26)

(27)

W (c)

2 (ρ) =

where

Note that satisfying (27) implies that (25) is also satis-
ﬁed, therefore breaking inequality (25) is the condition
for achieving Carnot eﬃciency in this model. Also note
that B gives the minimum worst case ﬂuctuation of the
work extracted by this engine when operating thermo-
dynamically reversibly. The eﬃciency is given by the
ratio of the heat ﬂow from the hot bath to the total
work extracted in the cycle. The heat ﬂow from the hot
bath is found by applying the 1st law of thermodynamics,
QH = ∆(cid:104)E(cid:105)(ρH → ρC) + W (c)
1 where ∆(cid:104)E(cid:105)(ρH → ρC)
is the change in the systems internal energy in the ﬁrst
part of the cycle. Therefore the c-bounded eﬃciency of
the engine is given by

η(c) =

1 + W (c)
W (c)
2
∆U + W (c)

1

(28)

In the case that c → ∞, we recover the Carnot eﬃciency,
which is bounded from above by 1, i.e. we recover unit
eﬃciency in the limit that βC/βH → ∞. For any ﬁnite
c this is no longer the case, with the maximal eﬃciency
give by

η(c)
max =

lim

βC /βH→∞

η(c) = 1 −

E

2(2c + E)

(29)

This gives an upper limit on the eﬃciency of the
single qubit engine protocol described above, which is
dependent only on the Hamiltonian of the qubit and the
parameter c.

As E → 0, η(c)
max → 1, but the work extracted tends to
zero as the Gibbs states associated with the two bath
temperatures become indistinguishable. For c → 0 we
get that η(c)
max is bounded from below by 1/2, but at
c = 0 no work can be extracted as the thermal states
are of full rank, giving η(0)
max = 0. Therefore we ﬁnd that,
although this engine cannot run at non-zero eﬃciency
in the single-shot regime,
if we allow for arbitrarily

0.00.51.01.50.00.10.20.30.40.5cworkW(⇢)W(c)(⇢)W(c)F(⇢)6

impossible to extract more that the deterministic work
content of a system without necessitating ﬂuctuations
that are greater than the gain in work (and similarly for
the work cost of state formation).

An interesting open question is to what extent we
must allow work to ﬂuctuate in order to allow for a
given state transformation. Answering this question
would require the extension of the results presented
in this article to processes with arbitrary initial and
ﬁnal states, including the case where both initial and
ﬁnal states contain coherences between energy levels.
In Appendix 1C we show that, under the assumption
that the protocol is independent on the position state
of the weight, the “coherence modes” [16–18] evolve
independently under the action of the thermal map.
This lays the ground for future investigations into how
the presence of coherences aﬀects the allowed thermal
operations in the case that work is allowed to ﬂuctuate.
Finally, we have used the c-bounded work to study
how bounding work ﬂuctuations aﬀects the eﬃciency
of a single qubit nano-engine, and have derived an
upper bound on eﬃciency of this engine that depends
only on c and the engine’s Hamiltonian, establishing a
fundamental trade-oﬀ between a the engines eﬃciency
and the ﬂuctuations in the work it produces. This
opens the door to correcting the eﬃciency for general
thermodynamic protocols,
the
fragility of realistic machines that cannot tolerate large
ﬂuctuations in work.

taking into account

it would be of

Given that there are many thermal engine models that
can reach Carnot eﬃciency in the case the ﬂuctuations
in work are unbounded,
interest to
determine the optimal engine with respect to minimizing
ﬂuctuations in work whilst maximising eﬃciency or the
power produced. Furthermore, it is well known that in
the thermodynamic limit the relative size of ﬂuctuations
in work to the average tends to zero.
It would be of
interest to determine if it is possible to design engines
operating far from the thermodynamic limit that achieve
a similar quasi-deterministic work output with non-zero
power.
For example it could be possible, through
clever choice of the working system Hamiltonian, or
by controlling interactions between a small number of
systems that constitute the working system, to ﬁnd
engine models that achieve quasi-deterministic work
output without needing to take the thermodynamic
limit. Further work in this direction would provide
invaluable insights for designing realistic nano-engines
that are robust to ﬂuctuations.

FIG. 3: Figure shows the c-bounded Carnot eﬃciencies vs.
TH for single qubit engine with gap E = 0.1 and TC = 1. The
black line gives the unbounded Carnot eﬃciency. The Blue
lines give the c-bounded eﬃciencies with there correspond-
ing c’s marked on the ﬁgure. The Black dashed lines give
the maximum attainable eﬃciency in the limit of asymptotic
temperature diﬀerence between βC /βH → ∞

small ﬂuctuations it is possible in principle to reach
a maximum eﬃciency greater that 1/2 (although the
ﬂuctuations in work will still be of the order of the work
extracted, given inequality (21)). Similar results relating
to the single-shot regime are discussed in [15].

Conclusions.
In this article we have derived tight
bounds on the minimal ﬂuctuations in work associated
with thermodynamically reversible protocols, for which
the average work is given by diﬀerence in free energy
between initial and ﬁnal states. We have found that
thermodynamically reversible protocols have ﬂuctua-
tions that diverge in size as the relative athermality of
initial or ﬁnal states increases.

Motivated by this we have presented a powerful
framework for computing the work associated with a
thermodynamic process under arbitrary convex bounds.
We have derived the c-bounded work content and work
of formation of arbitrary quantum states, which can be
understood as modiﬁed free energies that interpolate
between the standard and single shot free energies. By
exploring this new territory, we have found that the
phenomenology of single-shot thermodynamics, namely
thermodynamic irreversibility and a partial order of
states with respect to work, are to some extent present
for any ﬁnite c. Furthermore we have found that it is

[1] Micha(cid:32)l Horodecki and Jonathan Oppenheim. Fundamen-
tal limitations for quantum and nanoscale thermodynam-
ics. Nature communications, 4, 2013.

[2] Paul Skrzypczyk, Anthony J Short, and Sandu Popescu.
Work extraction and thermodynamics for individual
quantum systems. Nature communications, 5, 2014.

[3] J Gemmer and J Anders. From single-shot towards gen-
eral work extraction in a quantum thermodynamic frame-
work. arXiv preprint arXiv:1504.05061, 2015.

[4] Johan ˚Aberg. Truly work-like work extraction via a

single-shot analysis. Nature communications, 4, 2013.

[5] Oscar CO Dahlsten, Renato Renner, Elisabeth Rieper,
and Vlatko Vedral.
Inadequacy of von neumann en-
tropy for characterizing extractable work. New Journal
of Physics, 13(5):053015, 2011.

[6] Noah Linden, Sandu Popescu, and Paul Skrzypczyk. How
small can thermal machines be? the smallest possible re-
frigerator. Physical review letters, 105(13):130401, 2010.

123456780.00.20.40.60.81.0TH⌘(c)1.02.04.08.16[7] CA Ryan, O Moussa, J Baugh, and R Laﬂamme.
Spin based heat engine:
demonstration of multiple
rounds of algorithmic cooling. Physical review letters,
100(14):140501, 2008.

[8] HT Quan, YD Wang, Yu-xi Liu, CP Sun, and Franco
Nori. Maxwells demon assisted thermodynamic cycle in
superconducting quantum circuits. Physical review let-
ters, 97(18):180402, 2006.

[9] Fernando Brand˜ao, Micha(cid:32)l Horodecki, Nelly Ng,
Jonathan Oppenheim, and Stephanie Wehner. The sec-
ond laws of quantum thermodynamics. Proceedings of the
National Academy of Sciences, 112(11):3275–3279, 2015.
[10] Lluis Masanes and Jonathan Oppenheim. A derivation
(and quantiﬁcation) of the third law of thermodynamics.
arXiv preprint arXiv:1412.3828, 2014.

[11] R Gallego, J Eisert, and H Wilming. Deﬁning work from
operational principles. arXiv preprint arXiv:1504.05056,
2015.

[12] Yˆuto Murashita and Masahito Ueda. Absolute irre-
versibility resolves the gibbs paradox. arXiv preprint
arXiv:1506.04468, 2015.

[13] Yˆuto Murashita, Ken Funo, and Masahito Ueda.
Nonequilibrium equalities in absolutely irreversible pro-
cesses. Physical Review E, 90(4):042110, 2014.

[14] Christopher Jarzynski. Nonequilibrium equality for free
energy diﬀerences. Physical Review Letters, 78(14):2690,
1997.

[15] Mischa P Woods, Nelly Ng, and Stephanie Wehner.
The maximum eﬃciency of nano heat engines de-
pends on more than temperature.
arXiv preprint
arXiv:1506.02322, 2015.

[16] Matteo Lostaglio, David Jennings, and Terry Rudolph.
Description of quantum coherence in thermodynamic
processes requires constraints beyond free energy. Na-
ture communications, 6, 2015.

[17] Matteo Lostaglio, Kamil Korzekwa, David Jennings, and
Terry Rudolph. Quantum coherence, time-translation
symmetry, and thermodynamics. Physical Review X,
5(2):021001, 2015.

[18] Piotr ´Cwikli´nski, Micha(cid:32)l Studzi´nski, Micha(cid:32)l Horodecki,
and Jonathan Oppenheim. Limitations on the evolu-
tion of quantum coherences: Towards fully quantum sec-
ond laws of thermodynamics. Physical review letters,
115(21):210403, 2015.

[19] Johan Aberg. Fully quantum ﬂuctuation theorems. arXiv

preprint arXiv:1601.01302, 2016.

[20] ´Alvaro M Alhambra, Lluis Masanes, Jonathan Oppen-
heim, and Christopher Perry. The second law of quan-
tum thermodynamics as an equality.
arXiv preprint
arXiv:1601.05799, 2016.

I. PRELIMINARIES

A. Thermal operations with ﬂuctuating work

In this appendix we introduce the framework that we
will use to derive W (c)(ρ). The work extraction protocol
is performed using a system ρ, a inﬁnite thermal bath
and a work system or weight.

First, let us characterize the type of process/operation
that we consider, which we refer to as thermal operations
with ﬂuctuating work. Our setting consists of a system
with Hamiltonian HS, a bath with Hamiltonian HB ini-
tially in the thermal state ρB = 1
e−βHB , and an ideal
ZB

weight with Hamiltonian HW =(cid:82)
R dx x|x(cid:105)(cid:104)x|, where the
orthonormal basis {|x(cid:105),∀ x ∈ R} represents the position
of the weight. Any joint transformation of system, bath
and weight is represented by a Completely Positive Trace
Preserving (CPTP) map ΓSBW satisfying the following
conditions:

7

Microscopic reversibility (Second Law): It has an
SBW, which implies unitarity

(CPTP) inverse Γ−1
ΓSBW(ρSBW) = U ρSBWU†.

Energy conservation (First Law): [U, HS + HB +

HW] = 0.

Independence from the “position” of the weight:
The unitary commutes with the translations on
the weight [U, ∆W] = 0. The generator of the
translations ∆W is canonically conjugated to the
position of the weight [HW, ∆W] = i.

Classicality of work: Before and after applying the
global map ΓSBW the position of the weight is mea-
sured, obtaining outcomes |x(cid:105) and |x + w(cid:105) respec-
tively. The joint transformation of the system and
work random variable w is given by the map

(cid:2)Qx+w U (ρS ρB QxρWQx) U†(cid:3) ,

(cid:90)

Λ(ρS, w) =

dx trBW

R

where Qx = |x(cid:105)(cid:104)x| is a weight eigen-projector.

(30)

Condition [U, ∆W] = 0 implies that the reduced map on
system and bath is a mixture of unitaries (Result 1 in
[10]). Hence, this transformation can never decrease the
entropy of system and bath, which guarantees that the
weight is not used as a source of non-equilibrium. Note
that after integrating over the work varable

(cid:2)U (ρS ρB Θ[ρW]) U†(cid:3) = ΓS(ρS) ,

dw Λ(ρS, w) = trBW

(31)
we obtain the reduced CPTP map for the system. The
Rdx QxρWQx is the energy-diagonal ver-
sion of ρW. But Λ(ρS, w) being independent of ρW, we
can choose the initial state to be diagonal Θ[ρW]. Also,
note that when tracing the system

(cid:90)
state Θ[ρW] =(cid:82)

R

trSΛ(ρS, w) = P (w) ,

(32)

we obtain the probability distribution of the work gener-
ated in the transformation.

B. Thermal operations with non-constant

Hamiltonian

Thermal operations are general enough to include the
case where the initial Hamiltonian of the system HS is
diﬀerent than the ﬁnal one H(cid:48)S. This is done by including
an additional qubit X which plays the role of a switch
(as in [1, 19]). Now the total Hamiltonian is

H = HS ⊗ |0(cid:105)X(cid:104)0| + H(cid:48)S ⊗ |1(cid:105)X(cid:104)1| + HB + HW ,

(33)

and energy conservation reads [V, H] = 0, where V is
the global unitary when we include the switch. We im-
pose that the initial state of switch is |0(cid:105)X and the global
unitary V performs the switching

V (ρSBW ⊗ |0(cid:105)X(cid:104)0|) V † = ρ(cid:48)SBW ⊗ |1(cid:105)X(cid:104)1| ,

for any ρSBW. This implies

V = U ⊗ |1(cid:105)X(cid:104)0| + ˜U ⊗ |0(cid:105)X(cid:104)1| ,

(34)

(35)

where U and ˜U are unitaries on system, bath and weight.
Condition [V, H] = 0 implies

U (HS + HB + HW) = (H(cid:48)S + HB + HW)U .

(36)

Therefore, the reduced map on system, bath and weight
can be written as

8

ΓSBW(ρSBW) = U ρSBWU† ,

(37)

where the unitary U does not necessarily commute with
HS + HB + HW nor H(cid:48)S + HB + HW but satisﬁes (36).

C. Reducing the quantum problem to the classical case

Let us show that the equation connecting the initial state of the system ρS with the ﬁnal one conditioned on work

w,

decouples in the diagonal part and the other energy modes [16–18]. The map Θα deﬁned as

1

P (w)

Λ(ρS, w) ,

ρ(cid:48)S|w =
(cid:90)

Θα[ρS] =

R

dt eiαt eiHStρSe−iHSt ,

(38)

(39)

projects the state ρS onto the α-energy mode of HS. When α = 0 it projects the state onto its diagonal, when written
in the energy eigenbasis. And in general, it projects the state onto all the terms |s1(cid:105)(cid:104)s2| such that Es1 − Es2 = α.
Using constraint (36) and identities eitHW Qx = eitx and [HB, ρB] = 0 we obtain

dt eiαt eiH

(cid:48)
St Λ(ρS, w) e−iH

(cid:48)
St

Θα[Λ(ρS, w)] =

=

=

=

dt dx eiαt trBW

dt dx eiαt trBW

dt dx eiαt trBW

ei(H

(cid:48)
S+HB+HW)tQx+w U (ρS ρB QxρWQx) U†e−i(H

S+HB+HW)t(cid:105)
ei(HS+HB+HW)tρS ρB QxρWQxe−i(HS+HB+HW)t(cid:17)
(cid:105)

(cid:104)
(cid:104)
(cid:2)Qx+w U(cid:0)eiHStρSe−iHSt ρB QxρWQx

(cid:1) U†(cid:3)

Qx+w U

(cid:16)

U†

(cid:48)

(cid:90)
(cid:90)
(cid:90)
(cid:90)

R

R

R

R

= ΓS(Θα[ρS], w) ,

(40)

as claimed above. This shows that when the initial state is diagonal, Θα[ρS] = 0 for all α (cid:54)= 0, so is the ﬁnal one; and
visa-versa. Thus our results, concerning work extraction and state formation where either the initial or ﬁnal state
diagonal in the energy eigenbasis, are valid in the case that the non-equilibrium state involves coherences between
energy eigenstates.

The diagonal part of the map is nicely characterized by the conditional probability distribution

t(s(cid:48), w| s) = (cid:104)s(cid:48)|Λ(|s(cid:105)(cid:104)s|, w)|s(cid:48)(cid:105) ,

(41)

where |s(cid:105) is the eigenbasis of Θ[ρS] and |s(cid:48)(cid:105) is the eigenbasis of Θ[Λ(ρS, w)]. Note that the “dynamics” of the
diagonals is a completely classical problem. From now on we use ρ = Θ[ρS], ρ(cid:48) = ΓSΘ[ρS] for the initial/ﬁnal states
in optimal work extraction / state formation processes.

D. Necessary condition for thermal operations

(cid:90)
(cid:90)

(cid:88)
(cid:88)
(cid:90)

s

s

Using (36) and deﬁnitions made above we obtain

dw t(s(cid:48), w|s) eβ(Es(cid:48)−Es+w)

R

(cid:1) U†(cid:3)
(cid:2)eβHW Qx+w U(cid:0)e−βHS|s(cid:105)(cid:104)s| ρB e−βHW QxρWQx
(cid:21)
(cid:19)

(cid:18)

(cid:48)
S trBW

(cid:20)

|s(cid:48)(cid:105)

e−βHS e−βHB
ZB

e−βHW QxρWQx

U†

|s(cid:48)(cid:105)

(cid:48)
S trBW

eβHW Qx(cid:48) U

(cid:21)

=

dw dx(cid:104)s(cid:48)| eβH

R

R

=

(cid:20)
dx(cid:48) dx(cid:104)s(cid:48)| eβH
(cid:20)
= (cid:104)s(cid:48)| eβH
|s(cid:48)(cid:105)(cid:104)s(cid:48)|

(cid:48)
S trBW

= trSBW

eβHW e−βH

e−βHB

ZB

U Θ[ρW]U†

e−βHB

(cid:48)
S

ZB

(cid:21)

e−βHW U Θ[ρW]U†

.

|s(cid:48)(cid:105)

trW(cid:2)UISBρWU†(cid:3) = ISB
(cid:20)
|s(cid:48)(cid:105)(cid:104)s(cid:48)|

U Θ[ρW]U†

= trSB

(cid:21)

(cid:21)

e−βHB

ZB

= 1 .

for all ρW. Applying this to (42) we obtain

(cid:20)
|s(cid:48)(cid:105)(cid:104)s(cid:48)|

e−βHB

ZB

trSBW

As mentioned above, Result 1 in [third law masanes oppenheim] proves that condition [U, ∆W] = 0 implies

This proves the “only if” part of the following
Result 4. The (classical) map t(s(cid:48), w|s) comes from a thermal operation
t(s(cid:48), w|s) = (cid:104)s(cid:48)|Λ(|s(cid:105)(cid:104)s|, w)|s(cid:48)(cid:105) ,
(cid:90)
(cid:88)

if and only if

dw t(s(cid:48), w|s) eβ(Es(cid:48)−Es+w) = 1 ,

R

s

for all s(cid:48).

The “if” part of the above result is proven in Result 5 from [20].

E. Optimal thermal operations have minimal work ﬂuctuations

Given a process t(s(cid:48), w|s), satisfying (46), the work generated in a particular state transition s → s(cid:48) has probability

distribution

where t(s(cid:48)|s) =(cid:82)

t(w|s, s(cid:48)) =

t(s(cid:48), w|s)
t(s(cid:48)|s)

,

(47)

R dw t(s(cid:48), w|s) is the marginal transformation on the system. In general, despite the conditioning on
s, s(cid:48), the distribution (47) contains ﬂuctuations on w. In certain setups, a less ﬂuctuating work variable w is desirable.
The following result shows that this can always be done without decreasing the average work generated in the given
process t(s(cid:48), w|s).
Result 5. If t(s(cid:48), w|s) satisﬁes condition (46) then

9

(42)

(43)

(44)

(45)

(46)

(48)

(49)

(50)
(51)

with

also satisﬁes (46), and in addition

˜t(s(cid:48), w|s) = δ(w − ws,s(cid:48))t(s(cid:48)|s)

(cid:90)

ws,s(cid:48) = T ln

dw t(w|s, s(cid:48)) eβw

R

(cid:104)w(cid:105)˜t ≥ (cid:104)w(cid:105)t ,
w : ˜t(w)>0|w − (cid:104)w(cid:105)˜t| ≤ max

max

w : t(w)>0|w − (cid:104)w(cid:105)t| .

The above inequalities are saturated if and only if ˜t(w, s(cid:48)|s) = t(w, s(cid:48)|s).

To show that ˜t(s(cid:48), w|s) satisﬁes (46), ﬁrst, exponentiate the two sides of (49),

dw t(w|s, s(cid:48)) eβw ,
R
(cid:90)
(cid:88)
and second, multiply by t(s(cid:48)|s) eβ(Es(cid:48)−ES) and sum over s,

(cid:88)

eβws,s(cid:48) =

(cid:90)

t(s(cid:48)|s) eβ(Es(cid:48)−ES+ws,s(cid:48) ) =

s

R

s

dw t(s(cid:48), w|s) eβ(Es(cid:48)−ES+w) = 1 .

10

(52)

(53)

Note that the two maps, t(s(cid:48), w|s) and ˜t(s(cid:48), w|s), have the same marginal t(s(cid:48)|s). That is, they perform the same
transformation on the system.

To show (50) we use the convexity of the exponential in equation (49), obtaining

ws,s(cid:48) ≥ T ln e

) β w =

dw t(w|s, s(cid:48)) w .

(54)

R

Averaging over s, s(cid:48) gives (50). Also, note that due to strict convexity of the exponential, the equality in (54) is only
achieved when t(w|s, s(cid:48)) = δ(w − ws,s(cid:48)) = ˜t(w|s, s(cid:48)).
values w+ > ws,s(cid:48) and w− < ws,s(cid:48) such that t(w±|s, s(cid:48)) > 0. Hence, equality is only achieved when t = ˜t.

To show (51), note that the convexity of the exponential implies that, unless t(w|s, s(cid:48)) = δ(w − ws,s(cid:48)), there are

(cid:82)R dw P (w|s,s

(cid:48)

(cid:90)

II. OPTIMAL UNBOUNDED WORK

In this appendix we calculate the maximal average work
extracted (or minimal work of formation) for the state
transformation ρ → ρ(cid:48) with unbounded ﬂuctuations.
The work is given by the diﬀerence in free energy. By
explicitly calculating the work distribution we show that
the work ﬂuctuations diverge as the initial or ﬁnal system
states become more athermal. We also show that there
is no map that can achieve the optimal average work
(i.e. thermodynamically reversible) with a smaller range
of ﬂuctuations about the average (see also Appendix 1E).

In the previous Appendices we simpliﬁed the work-
optimal map to a form where it is deﬁned by the map
parameters {t(s(cid:48)|s), wss(cid:48)} where t(s(cid:48)|s) deﬁned the re-
duced map on the system. We have shown that, in the
case that the initial or ﬁnal state is diagonal we can work
with de-phased initial and ﬁnal states. Furthermore the
t(s(cid:48)|s) must obey
1 =

(55)

t(s(cid:48)|s)
xst(s(cid:48)|s)
t(s(cid:48)|s) eβ(Es(cid:48)−Es+ws,s(cid:48) )

(56)

(57)

(cid:88)
(cid:88)
(cid:88)

s(cid:48)

s

s

xs(cid:48) =

1 =

where the ﬁrst two constraints ensure that the reduced
map acting on the system is stochastic and achieves the
desired state transformation, and the third constraint,
derived in the previous section, is required to ensure that
the map is microscopically reversible.
In the following
we simplify the map further in the case of optimal work
extraction.

It will be useful to relax the reversibility equality to an

inequality

1 ≥

(cid:88)

s

where saturation of the inequality implies that the
map is an allowed (thermal) operation.
In all future
calculations we make use of this relaxed constraint and
show that our solutions saturate the inequality.

The average work associated with the optimal map

(cid:88)
achieving ρ → ρ(cid:48) is given by

W =

it turns out to be suﬃcient to optimize this under the
reversibility constraint (58). The Lagrangian is

(cid:88)

ss(cid:48)

L =

xst(s(cid:48)|s)wss(cid:48)+

ss(cid:48)

(cid:88)

s(cid:48)

xst(s(cid:48)|s)wss(cid:48)
(cid:32)

(cid:88)
(cid:18) xseβ∆Ess(cid:48)

1 −

ss(cid:48)

λs(cid:48)

λs(cid:48)β

wss(cid:48) =

1
β

log

Maximising with respect to wss(cid:48) gives

(59)

(cid:33)

t(s(cid:48)|s)eβ(wss(cid:48) +∆Ess(cid:48) )
(cid:19)

(60)

(61)

Extremizing with respect to λs(cid:48) and applying (55) and
(56) gives

Substituting this into (61) gives the optimal work

λs(cid:48) =

xs(cid:48)
β

(cid:18) xseβ∆Ess(cid:48)

(cid:19)

xs(cid:48)

(cid:88)

ss(cid:48)

xst(s(cid:48)|s)

1
β

log

= F (ρ) − F (ρ(cid:48))

(63)

(62)

where F (ρ) = (cid:104)E(ρ)(cid:105) − 1/β S(ρ) is the standard free en-
ergy and we have again used (55), (56). Notice that the
result is independent of our choice of t(s(cid:48)|s), i.e. any map
that takes us from ρ → ρ(cid:48) gives the same optimal work.
This is simply a statement that the free energy is a state
is path independent). The work W (∞) is
variable (i.e.
the average of the work marginals, gives by

(cid:18) xseβ∆Ess(cid:48)

(cid:19)

xs(cid:48)

t(s(cid:48)|s) eβ(Es(cid:48)−Es+ws,s(cid:48) )

(58)

wss(cid:48) =

1
β

log

(64)

Note work marginals with xs = 0 are set to zero
(they have zero probability of occurring in the work
distribution). Note that the ﬂuctuations diverge as the
initial / ﬁnal state moves further from equilibrium.
It
is easy to check that substituting our solutions for wss(cid:48)
into (58) saturates the inequality, therefore this map is
achievable with thermal operations.

Result 5 shows that no thermal map can achieve
this W with smaller worst case ﬂuctuations. Having
explicitly calculated the work marginals, we have derived
necessary and suﬃcient conditions for a thermal map
to exist that achieves this W (i.e.
the thermodynam-
ically reversible work) given that the ﬂuctuations are
constrained |w − W| ≤ c
Result 1. The process (ρ, HS) → (ρ(cid:48), H(cid:48)S) can be
achieved in a thermodynamically reversible map if

eβ(∆F (ρ→ρ

(cid:48)

)−c) ≤

xseβEs
xs(cid:48)eβEs(cid:48) ≤ eβ(∆F (ρ→ρ

(cid:48)

)+c) ∀ s, s(cid:48)

(65)
This becomes a necessary and suﬃcient condition if the
initial and/or or ﬁnal state is diagonal in the energy
eigenbasis

Proof. Given Result 5, it is suﬃcient to ﬁnd the condi-
tions that the work marginals (64) obey the c-bound

(cid:18) xseβ∆Ess(cid:48)

(cid:19)

(cid:12)(cid:12)(cid:12)(cid:12) 1

β

log

xs(cid:48)

− ∆F (ρ → ρ(cid:48))

(66)

(cid:12)(cid:12)(cid:12)(cid:12) ≤ c

which gives the desired inequalities

III. OPTIMAL WORK EXTRACTION WITH

BOUNDED FLUCTUATIONS

In this appendix we derive the c-bounded work content

for general quantum state ρ.

Lemma 1. We can always ﬁnd an optimal protocol where
(cid:48)
t(s(cid:48)|s) → ˜ts = e−βEs(cid:48) /Z(cid:48), where Z(cid:48) = tr[e−βH
S ], and
wss(cid:48) → ˜ws that obeys | ˜ws − (cid:104)W(cid:105)| ≤ |wss(cid:48) − (cid:104)W(cid:105)| ∀ s, s(cid:48)
Proof. The average work extracted by a given protocol is
given by

W =

xst(s(cid:48)|s)wss(cid:48)

(67)

(cid:88)

ss(cid:48)

where {t(s(cid:48)|s), wss(cid:48)} obey constraints (55) (56) and (58).
protocol
{t(s(cid:48)|s), wss(cid:48)} that satisﬁes these and obeys the c-
bound

Assume

optimal

exists

there

some

A. determining the optimal map

Z(cid:48) ≥

eβ(ws−Es)

|wss(cid:48) − W| ≤ c ∀s, s(cid:48)

(68)

k

11

(69)

(70)

Deﬁne a new protocol with

˜ts(cid:48) =

˜ws =

e−βEs(cid:48)
Z(cid:48)
t(k|s)wsk

(cid:88)
(cid:88)

k

s

(cid:88)

ss(cid:48)

(cid:88)

ss(cid:48)

The average work extracted by this protocol is

˜W =

xs˜ts(cid:48) ˜ws =

xs ˜ws =

xst(s(cid:48)|s)wss(cid:48)

(71)

therefore it extract the same amount of work as the opti-
mal protocol. It is also obeys the microscopic reversibility
inequality (58) as

(cid:88)

s

˜ts(cid:48)eβ( ˜ws−∆Ess(cid:48) ) =

(cid:18)(cid:80)

k

β

e

(cid:19)

t(k|s)wsl−Es

t(k|s)eβwsk−βEs

t(k|s)eβwsk−βEs+βEk−βEk

e−βEk

where we have used the fact that (cid:80)
(cid:80)

k t(k|s) = 1 and
the convexity of the exponential function to get eβ ˜ws ≤
k t(k|s)eβwsk , and in the second to last line have used
the reversibility of the original map. Finally, the new
protocol also obeys the c-bound as the work values ˜ws
are convex sums of the work marginals wss(cid:48) and therefore
max{wsk} ≥ ˜ws ≥ min{wsk}. As W is unchanged then
the worst case ﬂuctuations of the new work distribution
about the average must be less than or equal to those of
the optimal distribution.

We now drop the tilde from ˜ws and ˜ts(cid:48). It is simple to
check that ts(cid:48) = 1/Z(cid:48)e−βEs(cid:48) satisﬁes the conditions (55)

and (56). The reversibility inequality (58) becomes

and the average work is given by

W =

xsws

(cid:80)

We are now in a position to derive W (c)(ρ). The La-
(cid:80)
grangian is the same as employed in the previous sec-
tion except that it includes terms bounding all |ws −
k xkwk| ≤ 0. Due to the exponential in the reversibility
term Z(cid:48) ≥
s eβ(ws−Es) we must linearise these bounds
so as to avoid generating a transcendental equation when
extremizing the Lagrangian over ws. We therefore select
the bounds

(cid:88)

k

ws −

(cid:88)

xkwk ≤ c

xkwk − ws ≤ c

(72)

(73)

(74)

(75)

s

(cid:88)
(cid:88)
(cid:88)
(cid:88)

sk

sk

k

≤

1
Z(cid:48)
1
Z(cid:48)
1
Z(cid:48)
1
≤
Z(cid:48)
= 1

=

(cid:88)
(cid:88)

s

s

with associate Lagrange parameters µss(cid:48) and ¯µss(cid:48). As all
ﬂuctuations are either positive (ws ≥ W (c)(ρ)) or neg-
ative (ws < W (c)(ρ)) one of these bounds will always
be trivial for each work marginal ws. Including the re-
versibility constraint (72) we maximise the average work

s xsws by extremizing the Lagrangian

(cid:32)
Z(cid:48) −

(cid:88)

fsws + λ

(cid:33)

(cid:88)

eβ(ws−Es)

+ c

s

s

(µs + ¯µs)

(76)

W =(cid:80)
(cid:88)

L =

s

where

where f = 1 +(cid:80)
Lagrange parameters with λ = Z(cid:48)(cid:80)
(cid:80)
(cid:19)
(cid:18) fseβEs

fs = xs f − (¯µs − µs)
k(¯µk − µk) and we have replaced the old
s λs and µs(¯µs) =

s(cid:48) µss(cid:48)(¯µss(cid:48)). Maximizing w.r.t wi and λ gives

(77)

ws =

log

1
β

βλ

(78)

where we have used (cid:80)

λ =

1
βZ(cid:48)
s fs = 1. Substituting these into

(79)

the Lagrangian simpliﬁes it to

(cid:88)

s

fs log(cid:0)fseβEsZ(cid:48)(cid:1) + c

(cid:88)

s

L =

1
β

(µs + ¯µs)

(80)

Maximizing w.r.t µj and ¯µj under the condition µj ≥ 0
and ¯µj ≥ 0 gives

(cid:88)
xs log(cid:0)fseβEs(cid:1) = −βc
= 0 → log(cid:0)fjeβEj(cid:1)
(cid:88)
= 0 → − log(cid:0)fjeβEj(cid:1) +
xs log(cid:0)fseβEs(cid:1) = −βc

−

s

(81)

(82)

∂L
∂µj

∂L
∂ ¯µj

s

where we have used

∂fs
∂µj
∂fs
∂ ¯µj

= −xs + δsj

(83)

= xs − δsj

For c > 0, equations (81) and (82) cannot be simulta-

neously satisﬁed by any wj = 1/β log(cid:0)fjeβEjZ(cid:48)(cid:1) there-
1/β log(cid:0)fieβEiZ(cid:48)(cid:1) equations (81) and (82) can be writ-

fore if µj > 0 then ¯µj = 0 and visa-versa. As wi =

ten in the form

(84)

µj (cid:54)= 0 → wj − (cid:104)W(cid:105) = −c
¯µj (cid:54)= 0 → wj − (cid:104)W(cid:105) = c

(85)
(86)

Therefore ﬂuctuations saturate either a positive or nega-
tive bound, or saturate no bounds (µj = ¯µj = 0). It will
therefore be useful to partition the set of energy levels
into those for which the resulting ﬂuctuations will satu-
rate a positive bound i ∈ X+, a negative bound j ∈ X−
or saturate no bounds u ∈ Xu. For ﬂuctuations wi, wi(cid:48)

(93)

(94)

(cid:19)

(95)

that saturate a positive bound and wj, wj(cid:48) that saturate
a negative bound we have

12

fieβEi = fi(cid:48)eβEi(cid:48)
fjeβEj = fj(cid:48)eβEj(cid:48)
fjeβEj = fi(cid:48)eβ(Ei(cid:48)−2c)

fi = xif − ¯µi
fj = xjf + µj
fu = xuf

(87)
(88)

(89)
(90)
(91)
(92)

where (87) comes from summing (81) for µj, µj(cid:48), (88)
from summing (82) for ¯µi, ¯µi(cid:48), (89) comes from subtract-
ing (81) for µj and (82) for ¯µi and (90)–(92) are just the
deﬁnition (77) with the conditions ¯µj = 0, µi = 0 and
µu = ¯µu = 0 applied.
(87)–(89) and (92) allow us to
simplify (81) and (82) to

= 0 → log

fjeβEj

(cid:18) f
(cid:18) f

(cid:19)
(cid:19)

fieβEi

= ν + c

= ν − c

∂L
∂µj
∂L
∂ ¯µi

ν =

= 0 → log

(cid:18) 1
Where X+ = (cid:80)
(cid:80)
(cid:80)

β
Xu

β

Hu(ρ) + c(X− − X+) − (cid:104)Eu(ρ)(cid:105)

xs, X− = (cid:80)
(cid:80)

s∈X− xs, Xu =
s∈X+
s∈Xu xs, Hu(ρ) = −
s∈Xu xs log xs and (cid:104)Eu(ρ)(cid:105) =
s∈Xu xsEs. (87)–(92) let us to relate the remaining La-

grange parameters by

¯µi(cid:48) = f (xi(cid:48) − xieβ(Ei−Ei(cid:48) )) + ¯µieβ(Ei−Ei(cid:48) )
µj(cid:48) = f (xjeβ(Ej−Ej(cid:48) ) − xj(cid:48)) + µjeβ(Ej−Ej(cid:48) )

(96)

(97)
(98)

¯µi =

(k − µj)(eβEi xi − eβ(2c−Ej )xj) − µjeβ(2c−Ej )

(1 − xi)eβEi + xjeβ(2c−Ej )

i(cid:48)

where k = f − ¯µi + µj. Summing (96) over i(cid:48) and (97)
over j(cid:48) gives(cid:88)
(cid:88)
¯µi(cid:48) = f (X+ − xieβEiZ+) + ¯µieβEiZ+
µj(cid:48) = f (xjeβEjZ− − Xi) + µjeβEjZ− (100)
where Z+ =(cid:80)
1 +(cid:80)
(cid:80)

e−βEs. f =
s∈X+
j(cid:48) µj(cid:48) therefore we can get f in terms of

e−βEs and Z− =(cid:80)

s∈X+

(99)

j(cid:48)

i(cid:48) ¯µi(cid:48) −

¯µi and µj alone

f =

1 + ¯µieβEiZ+ − µjeβEjZ−
xieβEiZ+ + xjeβEjZ− + Xu

(101)

We now have f in terms of ¯µi and µj, and (98) relates
these to eachother, so we can solve (93) and (94) simul-
taneously (using k = f − ¯µi + µj) to ﬁnd ¯µi and µj, and
by (96), (97) all Lagrange multipliers. Substituting (96)
and (97) into (87) and solving for µj gives

µj =

keβEi (e−βc − xjeβEj +ν)

eβ(Ei−c) + eβ(Ej +c) + (1 − xi − xj)eβ(Ei+Ej )+ν

(102)

and similarly for ¯µi

¯µi =

keβEj (eβc − xieβEi+ν)

eβ(Ei−c) + eβ(Ej +c) + (1 − xi − xj)eβ(Ei+Ej )+ν

(103)
Using (101) and k = f − µj + ¯µi simultaneously solve
(102) and (103) to give

¯µi =

µj =

xieν − e−β(Ei−c)

eνXu + Z+eβc + Z−e−βc

e−β(Ej +c) − xjeν

eνXu + Z+eβc + Z−e−βc

(104)

(105)

it is simple to check that (96) and 97 result in ex-
actly the same equation for all ¯µi(cid:48) and µj(cid:48) but with
the corresponding index. Now armed with the explicit
form of the Lagrange parameters we have solved the La-
grangian. It is easy to check that for these solutions for
s xsws where
ws = 1/β log(fseβEsZ(cid:48)) where the fi are now of the form

¯µi, µj the Lagrangian simpliﬁes to L =(cid:80)

xseν ,

eβ(c−Es) ,
e−β(c+Es) ,

s ∈ Xu

s ∈ X+
s ∈ X−

fs = γ−1

where

(106)

(107)

γ = eνXu + Z+eβc + Z−e−βc
Substituting in the above values for fs

s xs log(fseβEsZ

(cid:48)

into L =
) gives our ﬁnal result for work ex-

1/β(cid:80)

traction

W (c)(ρ) =

1
β

(log Z(cid:48) − log γ)

(108)

s x0

Next we show that γ can be written as γ =
se−βEseβθs there θS is the ﬂuctuation associates
with subspace |s(cid:105)(cid:104)s| which, in the c-bounded distribu-
tion, is given by

(cid:80)

 1

θs =

β log(xseβEs) + ν
β ,
+c,
−c,

s ∈ X+
s ∈ X−

s ∈ Xu

(109)

In general, the c-bounded work is given by the diﬀerence
between the free energy of the ﬁnal thermal state and the
c-bounded free energy

F (c)(ρ) = − log

se−βEs eβθs
x0

(110)

(cid:88)

s

B. Finding the optimal partition

In this appendix we derive the inequalities for par-
titioning the state space into positively bounded X+,
negatively bounded X− and unbounded Xu energy levels,
as required by our main result. We derive the general set
of inequalities for any state and Hamiltonian and give
worked through examples of how to ﬁnd the partition for
arbitrary 2 and 3 dimensional systems. Firstly we derive
the partition inequalities for work extraction protocols,

and then show that the partition inequalities for work of
formation are identical.

13

The Lagrangian is maximised under the condition that ¯µi
and µj given in (102) and (103) are positive. Therefore
if our optimization gives a negative Lagrange parameter
it is set to zero, removing the corresponding c-bound.
The Lagrange parameters are positive when the following
inequalities are satisﬁed

ν
β

log(cid:0)xieβEi(cid:1) > c −
log(cid:0)xjeβEj(cid:1) < −c −
(cid:18) 1

1
β
1
β

where

ν =

β
Xu

→ ¯µi > 0
ν
β → µj > 0

(cid:19)

(111)

(112)

(113)

Hu(ρ) + c(X− − X+) − (cid:104)Eu(ρ)(cid:105)

β

and we have used γ ≥ 0. Clearly ν depends on how you
partition the state space in to positively, negatively and
unbounded ﬂuctuations. In the following we derive a set
of inequalities that determine the unique partition give ρ
and c. The following observations simplify the problem

Lemma 2. For any c-bounded work distribution where
bounded ﬂuctuations saturate their bounds, X± < 1/2
Proof. Consider a c-bounded work distribution with work
s xsws, and all
work marginals obey |ws − W| ≤ c. Break the work
distribution up into work marginals that give positive
ﬂuctuations wi ≥ W and negative ﬂuctuations wj < W .
Writing the ﬂuctuations as θi = wi−W and θj = W −wj

marginals {ws}, average work W = (cid:80)
and substituting into W =(cid:80)
(cid:88)

s xsws we get

(cid:88)

(114)

xiθi =

xjθj

i

j

which merely states that the average (non-absolute value)
ﬂuctuation of a random variable is zero, as is always the
s∈X− xs and
s∈X− xs < 1/2 so X− < 1/2. If
X+ ≥ 1/2 then, as bounded ﬂuctuations saturate their
bounds, (114) gives the inequality

s∈X+

xs > (cid:80)

case. Take the case that (cid:80)
X+ > 1/2. Clearly (cid:80)
(cid:88)
taking the factor of (cid:80)
1(cid:80)

write the inequality

s∈X−

xsc <

s∈X+

c <

(cid:88)

s∈X+

(cid:88)

xs to the other side we can

xsθs

(115)

xsθs

(116)

xs

s∈X−

s∈X−

The right hand side is a convex sum, and all θs ≥ 0,
therefore at least one θs > c contradicting the fact
that the work distribution is c-bounded. Therefore we
must have X+ < 1/2. A similar argument for the case

(cid:80)

xs <(cid:80)

s∈X+

s∈X− xs gives that X− < 1/2.

The inequalities are

(cid:88)

i

(cid:88)

j

(1 −

xi −

xj)(wk − c) +

(cid:88)

i

xi −

(cid:88)

j

(1 −

+

xj)(wl + c) +

+

14

xi(wi − c)

(121)

xj(wj + c) > W (ρ)

xi(wi − c)

(122)

xj(wj + c) < W (ρ)

i

(cid:88)
(cid:88)
(cid:88)
(cid:88)

j

i

j

Whenever an inequality is satisﬁed it ﬁxes that ﬂuctu-
ation as being the inﬁnitum of its set. For example, if
(121) is satisﬁed for wk then k ∈ ˜X+ regardless of ˜X−.
To see this, consider the case that (121) is satisﬁed for
wk but (122) isn’t for wl

Xu(wk − c) +

Xu(wl + c) +

xi(wi − c) +

xi(wi − c) +

xj(wj + c) > W (ρ)

xj(wj + c) > W (ρ)

down to wl(cid:48)>l. This makes Xu → Xu +(cid:80)l
(cid:80)R
(cid:80)l

as wl doesn’t satisfy its bound we have to move further
(cid:48)
j=l xj and
(cid:48)
j=l xj(wj + c).

(cid:80)R

j=l xj(wj + c) →

j=l xj(wj + c) −

The left hand side of (121) gains the term

k(cid:88)
k(cid:88)

i=1

i=1

R(cid:88)
R(cid:88)

j=l

j=l

(cid:48)(cid:88)

l

j=l

xj(wj + c)

(123)

The second observation is that the inequalities (111)
and (112) obey a β-ordering hierarchy. The β-odered
state, ρ↓β, is deﬁned as

ρ↓β = (x1, x2, . . . , xR)

,

xseβEs ≥ xs+1eβEs+1

(117)

where R = rank(ρ) (there is no work marginal w(∞)
asso-
s
i ≥ w(∞)
ciated with xs = 0). The β-ordering gives w(∞)
i+1 .
Therefore if w(∞)
i−1 , and
if w(∞)
j+1 . From this we
can deduce that the partition of the state space will look
like

satisﬁes (111) then so does w(∞)

satisﬁes (112) the so does w(∞)

j

i

ρ↓β = (x1, x2, . . . , xk

, xk+1, . . . , xl−1

, xl, . . . , xR

)

(118)

(cid:124)

(cid:123)(cid:122)

X+

(cid:125)

(cid:124)

(cid:123)(cid:122)

Xu

(cid:125)

(cid:124)

(cid:125)

(cid:123)(cid:122)

X−

Finally, it will be useful to put the inequalities in to
In the following we drop the (∞)
the following form.
superscript from the unbounded work marginals w(∞)
.
Subscript i will label positively bounded ﬂuctuations and
subscript j negatively bounded ﬂuctuations. (111) and
(112) can be written in terms of the unbounded work
distribution only (therefore the problem of ﬁnding the
partition, assuming it exists, is a closed form)

s

(cid:88)
(cid:88)

s∈X+

W (∞)(ρ) < Xu(wi(cid:48) − c) +

∀ i(cid:48) ∈ X+

W (∞)(ρ) > Xu(wj(cid:48) + c) +

xs(ws − c) +

xs(ws − c) +

s∈X+

∀ j(cid:48) ∈ X−

(cid:88)
(cid:88)

s∈X−

xs(ws + c)

(119)

xs(ws + c)

s∈X−

(120)

is

where W (∞)(ρ)
the unbounded average work
W (∞)(ρ) = β−1 log Z(cid:48)+F (ρ) and Xu = 1−X+−X−. We
now prove that for a given ρ and c there exists a unique
partition for which all inequalities (119) and (120) are
satisﬁed.

Lemma 3. Given state ρ, bound value c and inverse
temperature β, there is a unique partition of the state
space that gives the optimal c-bounded work. For R =
rank(ρ) there are at most R − 1 inequalities that must be
checked to determine the partition.

the furthest xk s.t. (cid:80)k
the furthest xl s.t. (cid:80)R

Proof. By 2 we know that X± < 1/2, therefore Xu >
0. The partition obeys the β-ordering hierarchy (118).
Starting from x1 count left to right in ρ↓β until you ﬁnd
i=1 xs < 1/2. These will form
our trial set for the bounded positive ﬂuctuations ˜X+.
Starting from xR count from right to left until you ﬁnd
j=l xj < 1/2. These form our
trial set for the bounded negative ﬂuctuations ˜X−.
If
this is indeed the correct partition for the state space,
the tightest bounds will be (119) on wk and (120) on wl.

l

(cid:48)(cid:88)
(cid:48)(cid:88)

j=l

l

j=l

+

=

xj(wk − c) −

xj(wk − wj)

As wk ≥ wj ∀ j = l, . . . , l(cid:48) this term is positive and
the new (121) is guaranteed to be satisﬁed. Therefore
we see that there is a unique partition as satisfying an
inequalities ﬁxes the corresponding (positive or negative)
subspace. There are at most R − 1 inequalities that we
need to check, i.e. the “worst case” being when the state
space is unbounded and we check all R − 1 inequalities.

In summary, the algorithm for determining the parti-

tion can be summarised as follows

and R = rank(ρ).

1. β-order the state ρ↓β = (x1, . . . , xR) where xβEs

s ≥
xβEs+1
This ordering gives
s+1
the unbounded work distribution in descending or-
der (w1, . . . , xR) where ws = β−1 log(xseβEsZ(cid:48)) and
ws ≥ ws+1
(cid:80)k

2. Take the trial partition where you maximise X+ =
i=1 xi under the condition X+ < 1/2 and X− =

(cid:80)R

j=l

i=1

i=1

(124)

Xu(wl + c) +

xj(wj + c) > W (ρ)

xi(wi − c) +

xi(wi − c) +

Xu(wk − c) +

k(cid:88)
k(cid:88)

j=l xj, X− < 1/2. Check inequalities

R(cid:88)
R(cid:88)
3. If (124) is satisﬁed xk ﬁxes X+ =(cid:80)k
equalities lower in the hierarchy, with X+ =(cid:80)k−1
if (124) is not satisﬁed and/or(cid:80)R

i=1 xi and similar
for (125). Otherwise we perform the next set of in-
i=1 xi
j=l+1 xj if (125) is not
satisﬁed. We repeat this process until we ﬁnd a pair
of inequalities that are simultaneously satisﬁed, ﬁxing
˜X± = X±, requiring at most R − 1 inequalities to be
checked.

xj(wj + c) < W (ρ)

(125)

j=l

Case: d=2. This is the simplest case, as either x1 >
1/2 or x2 > 1/2 or they both = 1/2. In the ﬁrst case
we bound the negative ﬂuctuation, and there is a single
bound to check

w2 < W (∞)(ρ) − c

(126)

and in the second case we bound the positive ﬂuctuation
if

w1 > W (∞)(ρ) + c

(127)

and if x1 = x2 = 1/2 when the two ﬂuctuations must be
equal (as the average of the positive ﬂuctuations = the
average of the negative ﬂuctuations) and we can choose
to bound one or the other, giving the same free energy.

In the following section we show that the same algo-
rithm is used for determining the partition for the c-
bounded work of formation. Note that, unless all ﬂuctu-
ations are unbounded W (c)(ρ) < W (∞)(ρ) and, as shown
in the next section, W (c)

F (ρ) > W (∞)

(ρ).

F

IV. WORK OF FORMATION WITH BOUNDED

FLUCTUATIONS

In this appendix we derive the c-bounded minimal

work of formation W (c)
F .

A. determining the optimal work of formation map

some

there

exists

optimal

Assume

of
{t(s(cid:48)|s), wss(cid:48)} that minimize the work cost whilst
obeying the c-bounds and microscopic reversibility (58).
We start in the thermal state with xs = 1/Ze−βEs and
end the protocol in state ρ with probabilities xs(cid:48). The
average work is

choice

W =

1
Z

e−βEst(s(cid:48)|s)wss(cid:48)

(128)

(cid:88)

ss(cid:48)

where the tij must obey (55), (56) and (57).

15

s

(cid:48)
t(s

−βEs

Lemma 4. We can always choose new protocol parame-
wss(cid:48) that give the
same average work as the optimal protocol and obey all
the necessary constraints

ters ˜ts(cid:48) = xs(cid:48) and ˜ws(cid:48) =(cid:80)
Proof. Clearly these choices of ˜ts(cid:48) satisfy(cid:80)
(cid:80)
s(cid:48) ˜ts(cid:48) = 1 and
s 1/Ze−βEs ˜ts(cid:48) = xs(cid:48), and the average work is given by
(129)

(cid:88)

|s)e
xs(cid:48)Z

˜ts(cid:48) ˜ws(cid:48)

1/Ze−βEs ˜ts(cid:48) ˜ws(cid:48) =

s(cid:48)

˜W =

(cid:88)
(cid:88)
Note that (cid:80)

ss(cid:48)

=

ss

xs(cid:48)

t(s(cid:48)|s)e−βEs

Zxs(cid:48)

wss(cid:48) = W

= 1 so ˜ws(cid:48) is a convex sum of
the wss(cid:48). The reversibility inequality (58) demands that

s

(cid:48)
t(s

−βEs

|s)e
xs(cid:48)Z

(cid:88)

(130)

which we can see to be true as the LHS is

˜ts(cid:48)eβ( ˜ws(cid:48)−∆Ess(cid:48) ) ≤ 1

s

s

e−βEs

LHS = xs(cid:48)eβ( ˜ws(cid:48) +Es(cid:48) )(cid:88)
= xs(cid:48)Zeβ( ˜ws(cid:48) +Es(cid:48) )
β(cid:80)
≤ xs(cid:48)ZeβEs(cid:48)(cid:88)
= xs(cid:48)ZeβEs(cid:48) e
t(s(cid:48)|s)e−βEs
(cid:88)

t(s(cid:48)|s)e−βEs

xs(cid:48)Z

s(cid:48) Z

s

x

i

=

s

t(s(cid:48)|s)eβ(wss(cid:48)−∆Ess(cid:48) ) ≤ 1

wss(cid:48)

eβwss(cid:48)

where in the fourth step we have used the convexity of the
exponential function and in the last step we have used the
fact that the optimal protocol deﬁned by {t(s(cid:48)|s), wss(cid:48)}
is reversible.
Clearly the new protocol obeys the c-bounds as ˜ws(cid:48) is
a convex combination of wss(cid:48) and the average of the
work distribution is the same for both maps, therefore
the spread of ˜ws(cid:48) about the average is less than or equal
to that of wss(cid:48).

s(cid:48)

s(cid:48)

L =

fs(cid:48)ws(cid:48)+

(cid:88)

(cid:88)

the Lagrangian and simplifying gives

λs(cid:48)(cid:0)1 − xs(cid:48)eβEs(cid:48)Zeβws(cid:48)(cid:1)+c

Substituting t(s(cid:48)|s) → ˜ts(cid:48) = xs(cid:48) and wss(cid:48) → ˜ws(cid:48) into
(cid:88)
xs(cid:48)(1 + f )− (¯µs(cid:48) − µs(cid:48)) and f =(cid:80)

(131)
where we have dropped the tilde from ˜ws(cid:48) and fs(cid:48) =
(¯µs(cid:48) − µs(cid:48)). ¯µ give the
bounds on positive ﬂuctuations and µ give the bounds
for negative ﬂuctuations. Maximizing w.r.t ws(cid:48) and λs(cid:48)
gives

s(cid:48)

s(cid:48)

(µs(cid:48)+¯µs(cid:48))

λs(cid:48) = max{

ws(cid:48) = −

= −

1
β
1
β

fs(cid:48)
β

, 0}

(cid:18) βλs(cid:48)xs(cid:48)eβEs(cid:48)Z
log(cid:0)xs(cid:48)eβEs(cid:48)Z
(cid:1) ,

log

fs(cid:48)

(cid:19)

fs(cid:48) (cid:54)= 0

(132)

(133)

(134)

which is the work marginal given in the unbounded cases
(it contains no ¯µj, µj terms). Therefore all ﬂuctuations

16

B. ﬁnding the optimal partition for state formation

We now show this algorithm for ﬁnding the partition
is identical to the algorithm derived in Appendix 2
for work extraction, in the case of positive ﬂuctuation
bounds only.

Result 6. The partition of the state space that gives the
c-bounded work of formation is found using the algorithm
described in Lemma 3 but bounding only positive ﬂuctu-
ations.

Proof. Take the ﬁnal state ρ(cid:48) and β-order it

ρ(cid:48)↓β = (x1, . . . xR)

,

xs(cid:48)eβEs(cid:48) ≥ xs(cid:48)+1eβEs(cid:48)+1

(142)

where R = rank(ρ) (we can discount work marginals in
the unbounded work distribution associated with xs = 0
as they have no probability of being observed). The un-
bounded work distribution obeys the inverse β-ordering

wR. For a correct partition where X+ =(cid:80)R

as ws(cid:48) = −β−1 log(xs(cid:48)eβEs(cid:48)Z), therefore w1 ≤ w2 ≤ ··· ≤
s(cid:48)=k xi we re-
quire that ws(cid:48) ≤ WF (ρ(cid:48))(c) + c ∀ s < k. As with the
c-bounded work extraction protocol the β-ordering puts
these inequalities into a hierarchy, with the bound for
wk−1 being the tightest. As all bounds must be satisﬁed
we need only check the tightest one. For the aforemen-
tioned partition the tightest bound is

(cid:33)

R(cid:88)

s(cid:48)=k

xs(cid:48)ws(cid:48) + c

xs(cid:48)

(143)

(cid:32)
W (∞) −

R(cid:88)

s(cid:48)=k

wk−1 ≤

1

R(cid:80)

i=k

xi

which can be re-arranged to give

R(cid:88)

s(cid:48)=k

R(cid:88)

s(cid:48)=k

which is simply the inequality used for checking a parti-
tion of the state space in the c-bounded work extraction
protocol, in the case that there are no negative ﬂuctua-
tions that saturate their bounds (124). It can be simpli-
ﬁed further to

xs(cid:48)(wk−1 − ws(cid:48)) ≤ c

(145)

So the partition is deﬁned by the largest k s.t.

(¯µs + µs)

(136)

(137)
(¯µk(cid:48) − µk(cid:48))

(138)

with fs(cid:48) > 0 are unbounded, with µs(cid:48)(¯µs(cid:48)) = 0, giving
fs(cid:48) = xs(cid:48) if unbounded or 0 if bounded. The Lagrangian
reduces to
1
β

fs(cid:48) log(cid:0)xs(cid:48)eβEs(cid:48)Z

(cid:1) + c

(¯µs(cid:48) + µs(cid:48)) (135)

(cid:88)

(cid:88)

L = −

s(cid:48)

Which we can now re-write in terms of bounded and un-
bounded ﬂuctuations. Index all ﬂuctuations with fs(cid:48) > 0
with s(cid:48) ∈ Xu, and all those with fs(cid:48) = 0 with s(cid:48) ∈ X+.
The Lagrangian becomes

xs(cid:48)(1+f ) log(cid:0)xs(cid:48)eβEs(cid:48)Z

(cid:1)+c

(cid:88)

s(cid:48)∈X+

L = −

1
β

s(cid:48)

(cid:88)

s(cid:48)∈Xu

fs = 0 ∀s(cid:48) ∈ X+ gives

¯µs(cid:48) − µs(cid:48) = xs(cid:48)(1 + f )

Summing over s ∈ X+ and solving for f =(cid:80)
where Xc =(cid:80)

Xc
1 − Xc

gives

f =

k(cid:48)

s(cid:48)∈X+

xs. For a given bounded ﬂuctuation
only one of the µ Lagrange parameters is non-zero, cor-
responding to if the ﬂuctuation is positive or negative.
Using the above result gives

Xc
1 − Xc

) =

xk

1 − Xc

¯µk = xk(1 +

µl = −

xl

1 − Xc

(139)

(140)

The Lagrange parameters are restricted to being positive,
µs ≥ 0 and ¯µs ≥ 0 ∀ s. Therefore as µs = −xs/(1 − Xc)
which is ≤ 0, therefore all µs = 0 and we never bound
negative ﬂuctuations.

(cid:32)

xs(cid:48) log(cid:0)xs(cid:48)eβEs(cid:48)Z

(cid:1) + c Xc

(cid:33)

(cid:88)

s(cid:48)∈Xu

W (c)

F =

1
Xu

1
β

−

(141)
This is exactly the work cost when we calculate the c-
bounded work of formation in the following way. Take
the optimal unbounded work distribution for forming a
state (w1, . . . , wd) with average W (∞)(ρ). Equation (141)
is given by the solution to the equation

(cid:88)
(cid:88)

s∈X+

=

xsws +

W =

(cid:88)
(cid:88)
s∈Xu
∴ W (1 −
(cid:123)(cid:122)
(cid:125)
(cid:124)
(cid:32)(cid:88)

s∈X+
Xu

xs)

∴ W =

1
Xu

s∈Xu

s∈Xu

(cid:33)

xsws + cX+

xs(W + c)

xsws + cX+

Using Xu = 1− Xc we arrive at the c-bounded optimal

work of formation

(1 −

xs(cid:48))wk−1 +

xs(cid:48)ws(cid:48) ≤ W (∞) + c

(144)

k−1(cid:88)

s(cid:48)=1

k(cid:88)
k−1(cid:88)

s(cid:48)=1

s(cid:48)=1

xs(cid:48)(wk − ws(cid:48)) > c

xs(cid:48)(wk−1 − ws(cid:48)) ≤ c

(146)

(147)

I.e we simply take the optimal unbounded work dis-
tribution and if the largest positive ﬂuctuation breaks
wi − W ≤ c we replace it with W (cid:48) + c, recalculating the
average each time.

All ws with s ≥ k are bounded and all with s < k are
unbounded. Once again we have at most R − 1 inequali-
ties to check. I.e. starting from k = 2 we check (146) for
k = 2, 3, . . . .

V. PROPERTIES OF C-BOUNDED WORK

A.

recovering standard and single-shot regimes

Result 7. lim
c→0

W (c)(ρ) = Wmin(ρ)

17

Proof. As c → 0 the inequalities that determine if a ﬂuc-
tuation saturates its bound (111) and (112) become

log(cid:0)xseβEs(cid:1)
log(cid:0)xseβEs(cid:1)

1
β
1
β

≥ −ν/β → s ∈ X+
≤ −ν/β → s ∈ X−

s

B. bounds on c-bounded work

All ﬂuctuations satisfy one of these bounds, except in the
case that xs = 0 (i.e. there is no ﬂuctuation associated
with state |s(cid:105)), therefore Xu → 0. γ = Xueν + Z+eβc +
Z−e−βc → Z+ + Z− which can be formulated as

(cid:88)

γ =

se−βEs
x0

(148)

(cid:32)
log Z(cid:48) − log

(cid:33)

se−βEs
x0

(149)

(cid:88)

s

therefore W (c)(ρ) becomes

W (c)(ρ) =

lim
c→0

1
β

= Wmin(ρ)

Result 8. lim
c→0

W (c)

F (ρ) = W min

F

(ρ)

Proof. Following the partition algorithm derived in
Lemma 6, clearly when c → 0 we bound all but the most
negative ﬂuctuation(s), those with value w1, as this gives
the only positively bounded work distribution for which
F . Any other choice of partition
would require both negative and positive bound satura-
tion, which contradicts (139) being positive. Therefore
W (0)

all work values are ≤ W (0)
(cid:16)

(cid:17)(cid:27)

is given by

(cid:26)

(cid:16)

(cid:17)

F

W (0)

F = min

s

1
β

−

log

xseβE

1
β

= −

log

x1eβE

(cid:48)

1Z
(150)

where ρ(cid:48)↓β = (x1, . . . , xR). We can interpret

(cid:48)

sZ

(cid:16)

(cid:17)

w1 = −

1
β

log

x1eβE

(cid:48)

1Z

(151)

−w1 is the “on ramp” (the ﬁrst segment) of the Lorenz
curve of state ρ(cid:48) (see Figure 4 and [1]). It therefore gives
the work that can be extracted from the “thermally sharp
state”, where all segments either have the same gradient
or zero gradient, that just thermomajorizes ρ(cid:48), see ﬁgure
4 below and also [1]. This can also be interpreted as the
upper bound to the work that can be in-deterministically
extracted from ρ(cid:48), and this is precisely the single-shot
work of formation.

FIG. 4: Figure shows the thermally sharp state whose single-
shot work content gives the work of formation of state ρ(cid:48).
This also represents the maximal average work that can be
extracted from ρ(cid:48)

Lemma 5. W (c)(ρ) ≤ Wmin(ρ) + c. c ∈ [0, ccrit], there-
fore any gain in work extracted over the single-shot work
context of ρ requires ﬂuctuations that are at least as large
as the increase in extracted work

Proof. For c = 0 we get that Wc=0(ρ) = Wmin(ρ). W (c)
increases as we increase c from 0. We show W (c)(ρ) grows
sub-linearly with c, i.e. that

∂W (c)(ρ)

∂c

≤ 1 ∀ c

(152)

which implies that |W (c)(ρ)− Wmin(ρ)| ≤ c. Using (108)
the derivative of W (c)(ρ) with respect to c is

∂W (c)(ρ)

∂c

1
βγ

∂γ
∂c

= −

=

1
γ

(cid:0)(X+ − X−)eν − Z+eβc + Z−e−βc(cid:1)

(153)
where γ = Xueν +Z+eβc+Z−e−βc. For this to be greater
than 1 we require that

(X+−X−)eν−Z+eβc+Z−e−βc > Xueν +Z+eβc+Z−e−βc
(154)
As Z±e±βc ≥ 0 and eν ≥ 0 this cannot be satisﬁed unless

X+ − X− > Xu

∴
−→ X+ >

1
2

(155)

Using W (c)(ρ) = (cid:80)
(cid:80)

where we have used Xu = 1 − X+ − X−. We now show
that this is never true for c-bounded work distributions.
s xsθs, where θs = ws − W (c)(ρ) is
the ﬂuctuation associated with work marginal ws, gives
s xsθs = 0. Divide the ﬂuctuations for the c-bounded
protocol θs into positive θα ≥ 0 where α ∈ X+ and neg-
ative θβ < 0 where β ∈ X−, giving

(cid:88)

α

(cid:88)

β

xα|θα| =

xβ|θβ|

(156)

⇢# =(x1,x2,x3)x1x1+x21e  ✏1e  ✏1+e  ✏2Z18

(cid:88)

s

(cid:88)

s

Result 9. Any protocol that saturates all reversibility
constraints immediately satisﬁes the Jarzinski equality
Proof. If a protocol, characterised by {t(s(cid:48)|s), wss(cid:48)}, sat-
urates all reversibility constraints then

t(s(cid:48)|s)eβ(wss(cid:48)−Es+Es(cid:48) ) = 1

(163)

Dividing by Z and re-arranging gives
t(s(cid:48)|s)eβwss(cid:48) =

e−βEs
Z

e−βEs(cid:48)

Z

(164)

if we sum over s(cid:48), the LHS of this is equivalent to
(cid:104)eβwss(cid:48)(cid:105) with the initial state being thermal w.r.t HS ,
xs = Z−1e−βEs , and the RHS becomes Z(cid:48)/Z, which is
equal to eβ∆F . Note that we use the convention of posi-
tive work for work extracted from the system, hense our
wss(cid:48) = −ws are the negatives of the work marginals given
in the Jarzinski equality.

Result 10. The work distributions associated with
W (c)(ρ) and W (c)

F (ρ) obey the Jarzinski equality.

First we cover the case of work extraction, W (c)(ρ).

The work marginals are give by

β

=

(158)

(157)

α(cid:54)=α(cid:48)

cX+ +

β

xβ

β

xβ|θβ|

xα|θα|

β xβ gives

α(cid:54)=α(cid:48)
xβ

β

(cid:88)

xα|θα| =

according to (85) and (86), bounded ﬂuctuations saturate
their bounds. Take the subset of the positive ﬂuctuations
that saturate their bounds as θα(cid:48). (156) becomes

(cid:88)
Dividing both sides by(cid:80)
(cid:80)
cX+ + (cid:80)
(cid:80)
xβ|θβ|(cid:80)
β xβ < 1/2, and(cid:80)
and therefore(cid:80)
(cid:12)(cid:12)(cid:12) ≥ |Wmax(ρ(cid:48))| − c. c ∈ [0, ccrit],
(cid:12)(cid:12)(cid:12)W (c)
(cid:12)(cid:12)(cid:12) < |Wmax(ρ(cid:48))| − c then, taking w1 =
(cid:12)(cid:12)(cid:12)W (c)
(cid:32) (cid:88)

the right hand side is strictly larger than c as X+ > 1/2
α(cid:54)=α(cid:48) xα|θα| ≥ 0. The
left hand side is a convex sum with all |θβ| ≥ 0, therefore
at least one |θβ| must be larger than c. Therefore in a
c-bounded protocol X+ ≤ 1/2.
Lemma 6.
therefore any gain in work extracted over the single-shot
work of formation of ρ(cid:48) requires ﬂuctuations that are at
least as large as the increase in extracted work

Proof. if
max{ws(cid:48)} = max{β−1 log xs(cid:48)eβs(cid:48)Z} = |Wmax(ρ(cid:48))| when

we require that

F (ρ(cid:48))

F (ρ(cid:48))

(cid:33)

ws(cid:48) + c(1 − Xu)

+ c < w1

(159)

1
Xu

s(cid:48)∈Xu

which requires that

c <

(cid:88)

s(cid:48)∈Xu

(w1 − ws(cid:48))

(160)

ws =

1
β

log(fseβEsZ(cid:48))

and the t(s(cid:48)|s) are given by

ts(cid:48) =

as derived in Appendix 2. Note that

(cid:48)
s(cid:48)

e−βE
Z(cid:48)

(cid:88)

(165)

(166)

fs = 1

(167)

which contradicts (145) for any partition

s

C.

c-bounded work obeys the Jarzinski equality

In this appendix we show that all c-bounded work
distributions obey the Jarzinski equality. The equality
is given in the case that a system begins in the thermal
state of an initial Hamiltonian Hi and the Hamiltonian
is transformed to Hf , causing the state to evolve to a
state that is, potentially, out of equilibrium with the
ﬁnal Hamiltonian. The equality is stated as

The LHS of the reversibility constraints are

(cid:88)
(cid:88)
(cid:88)

s

s

=

=

=

eβ(ws−Es+Es(cid:48) )

e−βEs(cid:48)
Z(cid:48)
elog(fsZ

1
Z(cid:48)
fs = 1

(cid:48)

))

s

and can similarly be shown for W (c)(ρ).

(cid:104)e−βw(cid:105) = e−β∆F

(161)

VI. QUBIT CARNOT ENGINE

where w is the work random variable (i.e.
the work
marginals associated with the protocol), with the con-
vention that they are positive if the work is done on the
system, and ∆F is the free energy diﬀerence between
the equilibrium states of HS and H(cid:48)

S , given by

(cid:18)

(cid:19)

Z
Z(cid:48)

∆F =

1
β

log

In this appendix we calculate the c-bounded Carnot
eﬃciency for a single qubit quantum engine. The engine
operates by moving a qubit ρ = x|0(cid:105)(cid:104)0| + (1 − x)|1(cid:105)(cid:104)1|
with Hamiltonian Hs = E |0(cid:105)(cid:104)0| between two baths with
inverse temperature βH and βC, with βH < βC. The
engine cycle begins with the qubit in thermal equilibrium
with the cold bath. It is then placed in contact with the
hot bath, and extracting work by allowing the state to

(162)

19

where QH is the heat ﬂow out of the hot bath. The
eﬃciency is given by the ratio of the total work to QH ,
giving

Wtot
QH

= 1 −

βH
βC

(176)

which is the Carnot eﬃciency.
Case: c ﬁnite.
E > 0 implies that x < 1/2 for all thermal states of
ρ, therefore by the partitioning algorithm derived in
Appendix 4, the least likely ﬂuctuation w(c)
associated
0
with subspace |0(cid:105) is the only ﬂuctuation that can be
bounded. Using equation (16), the c-bounded work
content for a qubit ρ↓β = (x1, x2) is given by

F (ρ) ,

x1eβE1 ≤ eβ(F (ρ)+c
x2eβE2 ≥ eβ(F (ρ)−c

F (c)
1 (ρ) , w0 < W (ρ) − c
F (c)
2 (ρ) , w0 > W (ρ) + c

1−x + e−cβ−Eβ(cid:17)

(cid:16)
1−x + ecβ−Eβ(cid:17)

e−cβ+ cβ

(177)

1 (ρ) = −β−1 log
ecβ− cβ

where F (c)
F (c)
2 (ρ) = −β−1 log
, W (ρ) is the
unbounded work given by the free energy, and w0 =
β−1 log(xeβEZ).
In the ﬁrst step, putting the qubit
in contact with the hot bath, the work we extract is
bounded negatively if w0,H < F (ρC, βH )−F (ρH , βH )−c,
which gives the inequality

and



(cid:16)

(cid:18) βC − βH

(cid:19)

βH

E
ZC

> c

(178)

note that βC > βH therefore the LHS of (178) is positive.
In order to break the positive ﬂuctuation bound we would
require -LHS > c which is impossible for positive c, there-
fore in the ﬁrst part of the engine cycle the work extracted
is either unbounded or negatively bounded. For the sec-
ond cycle, re-equilibriating the qubit with the cold bath,
the inequality that implies a positively bounded work is
given by w0,C > F (ρH , βC) − F (ρC, βC) + c, which sim-
pliﬁes to

(cid:18) βC − βH

(cid:19)

βC

E
ZH

> c

(179)

Again the LHS is positive, and we would require -LHS
> c in the case of a negatively bounded protocol. There-
fore on the second part of the cycle the work is either
unbounded or positively bounded. Also note that as
βH < βC and therefore ZC < ZH , satisfying inequality
(178) implies inequality (179) is also satisﬁed. There are
therefore three cases, 1) the work is unbounded and we
can achieve Carnot eﬃciency, 2) the work extracted from
the hot bath is negatively bounded, and 3) 2 and the
work extracted from the cold bath is positively bounded.

the c-bounded work extracted from the hot bath, in

the case that inequality (178) is satisﬁed, is given by

(cid:18)

(cid:19)

(cid:18)

ZH
ZC

(cid:19)
(cid:18) βH − βC
(cid:19)

βH

eE(βH−βC )

+ tr (Hsρc)

(cid:18)
(cid:18)

(cid:19)

ZH
ZC
ZH
ZC

where tr (HsρC) = Z−1

C e−βCEE and work marginals

w0,H =

w1,H =

1
βH
1
βH

log

log

where we have used the result for the optimal unbounded
work extraction protocol ws = β−1 log xseβEsZ. Return-
ing the qubit to the cold bath we extract work

(cid:18)

ZC
ZH

(cid:19)
(cid:18) βC − βH
(cid:19)

βC

eE(βC−βH )

F (ρH , βC) − F (ρC, βC) =

1
βC

log

+ tr (HsρH )

with work marginals

w0,C =

w1,C =

1
βC
1
βC

log

log

(cid:18)
(cid:18)

ZC
ZH
ZC
ZH

(cid:19)

(170)

(cid:19)

(171)

(172)

where tr (HsρH ) = Z−1
tracted in one cycle is

H e−βHEE. The total work ex-

(cid:18) 1

(cid:19)

Wtot =

βH −

1
βC

(SH − SC)

(173)

where SH,C = − log ZH,C − βH,Ctr (HsρH,C) is the Von
Neumann entropy of the Gibbs state with inverse tem-
perature βH,C. Applying the ﬁrst law of thermodynamics
∆U = Q − W to the ﬁrst step (extracting work from the
hot bath), we get

tr (HsρH )− tr (HsρH ) = QH − (F (ρC, βH ) − F (ρH , βH ))
(174)
which simpliﬁes to

equilibrate. The ﬁnal step in the cycle is to return the
qubit to the cold bath, allowing it to equilibrate and
extracting work.
Case: c → ∞. Following the proof given in [2], we
show that in the case that ﬂuctuations are unbounded it
is possible to reach Carnot eﬃciency. The equilibrium
state of the qubit if given by

ρH,C =

1

ZH,C

e−βH,CE |0(cid:105)(cid:104)0| +

1
ZH,C |1(cid:105)(cid:104)1|

(168)

where ZH,C = e−βH,CE + 1. When ρC is placed in ther-
mal contact with the hot bath we can extract a maximal
average work given by the free energy diﬀerence

F (ρC, βH ) − F (ρH , βH ) =

1
βH

log

(cid:19)

(169)

W (c)(ρ) =

1
β

log Z +

QH =

1
βH

(SH − SC)

(175)

W (c)

1 =

1
βH

log

ZH

ecβHZC + e−βHE

+ c

(180)

where we have used the expressions in (177). If inequality
(179) is satisﬁed for the second part of the cycle, then we
get

take βH → ∞ and n → ∞.

(cid:18)

(cid:18)

(cid:19)

W (c)

2 =

1
βC

log

ZC

e−cβCZH + e−βCE

− c

(181)

lim
n→0

lim

βH→∞

20

(184)

= 1 −

E

2(2c + E)

(cid:17)(cid:19)

(cid:16)

η(c)
1

Of course as E → 0 the eﬃciency tends to 1, but this is
because we are no longer extracting any work (as the
two Gibbs states are identical). As c → ∞ we recover
the Carnot eﬃciency upper bound, although for any
ﬁnite c we can never reach an eﬃciency of 1. Therefore
all realistic engines of this form have an upper bound to
their eﬃciency deﬁned by their energy gap and fragility
c. This represents a general physical upper bound on
the eﬃciency of a the qubit engine, given by its ability
to withstand ﬂuctuations. Also notice that as c → 0
the maximal eﬃciency is bounded from below by 1/2.
For c = 0 the eﬃciency is zero, as no work can be
extracted. Therefore we observe, in this model at least,
a genuine discontinuity between the capabilities of a
thermal machine in the single-shot regime. Allowing for
arbitrarily small ﬂuctuations in principle will allow the
engine to reach a maximum eﬃciency that is bounded
from below by 1/2. But if we demand that the work is
deterministic, the eﬃciency is zero.

Using QH = ∆U + W (c)

1 , the eﬃciency is given by

η(c)
1 =

W (c)

1 + F (ρH , βC) − F (ρC, βC)

∆U + W (c)

1

if inequality (178) is satisﬁed and

η(c)
2 =

W (c)
1 + W (c)
2
∆U + W (c)

1

(182)

(183)

if inequalities (178) and (179) are satisﬁed. As the
temperature diﬀerence between hot and cold baths
increases, the eﬃciency increases.
In the unbounded
case, the Carnot eﬃciency is bounded from above by 1.
As βH /βC → 0, inequality (179) cannot be satisﬁed for
any ﬁnite c. To ﬁnd the upper bound of η(c)
1 we make
the change of variables βC/n = βH , i.e. TH = nTC and
n is the ratio of the two bath temperatures. We then

