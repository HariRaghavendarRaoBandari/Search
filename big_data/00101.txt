6
1
0
2

 
r
a

M
1

 

 
 
]

.

O
C
h
p
-
o
r
t
s
a
[
 
 

1
v
1
0
1
0
0

.

3
0
6
1
:
v
i
X
r
a

Study on the mapping of dark matter clustering from real space to redshift space

1Korea Astronomy and Space Science Institute, Daejeon 34055, Republic of Korea

Yi Zheng1, ∗ and Yong-Seon Song1, †

The mapping of dark matter clustering from real space to redshift space introduces the anisotropic
property to the measured density power spectrum in redshift space, known as the Redshift Space
Distortion eﬀect. The mapping formula is intrinsically non-linear, which is complicated by the
higher order polynomials due to indeﬁnite cross correlations between the density and velocity ﬁelds,
and the Finger–of–God eﬀect due to the randomness of the peculiar velocity ﬁeld. Whilst the full
higher order polynomials remain unknown, the other systematics can be controlled consistently
within the same order truncation in the expansion of the mapping formula, as shown in this paper.
The systematic due to the unknown non–linear density and velocity ﬁelds is removed by separately
measuring all terms in the expansion directly using simulations. The uncertainty caused by the
velocity randomness is controlled by splitting the FoG term into two pieces, 1) the non–local FoG
term being independent of the separation vector between two diﬀerent points, and 2) the local
FoG term appearing as an indeﬁnite polynomials which is expanded in the same order as all other
perturbative polynomials. Using 100 realizations of simulations, we ﬁnd that the best ﬁtted non–
local FoG function is Gaussian, with only one scale–independent free parameter, and that our new
mapping formulation accurately reproduces the observed 2-dimensional density power spectrum in
redshift space at the smallest scales by far, up to k ∼ 0.3 h Mpc−1, considering the resolution of
future experiments.

PACS numbers: 98.80.-k; 98.80.Es; 98.80.Bp; 95.36.+x

I.

INTRODUCTION

The presence of the cosmic acceleration has been con-
ﬁrmed by multiple experiments since 1998 [1, 2], sup-
porting the standard model of the universe, which is
dominated by dark materials motivating new physics [3].
There has been signiﬁcant theoretical and observational
studies exploring the true nature of the cosmic acceler-
ation. Some predict the unknown materials such as the
dark energy expelling the cosmic expansion against the
gravitational force [4–11] , and others propose the mod-
iﬁed gravity which is the consequence of our incomplete
knowledge of the gravitational theory [12–20]. Whichever
it might be true, the outcome will revolutionize our un-
derstanding of the fundamental physics.

The nature of the dark universe can be revealed by
observing the large scale structure of the universe. Com-
bined with the galaxy angular positions, the redshifts of
galaxies at a selected sky area are measured to reveal the
3D distribution of the galaxies. The large scale struc-
ture of the matter can be estimated from this observed
redshift map, which provides us an opportunity to probe
in precision the key observables demanded for explain-
ing the dark materials of the universe. First, the galaxy
clustering at large scales contains the fossil information
of the primordial baryonic plasma from the last scatter-
ing epoch, called the baryon acoustic oscillations (here-
after BAO). The characteristic BAO scale determined
by the cosmic microwave background (hereafter CMB)

∗Email at yizheng@kasi.re.kr
†Email at ysong@kasi.re.kr

experiments oﬀers us a standard ruler which allows us
to measure the distances to the selected galaxies with a
high accuracy [21–29]. Second, the observed clustering
pattern of galaxy power spectrum becomes anisotropic
with the presence of the apparent mismatch between the
underlying theoretical model and the true universe, as
the redshift and angular positions of galaxies need to be
converted to the co–moving radial and transverse dis-
tances using theoretical model. This is known as the
Alcock-Paczynski (A-P) eﬀect [30]. Third, the observed
galaxy clustering provides us an unique window accessing
the evolution history of the cosmic structure formation.
The observed galaxy clustering seen by the spectroscopic
measurements is distorted along the line of sight by the
peculiar velocity of galaxies, known as the redshift space
distortions (hereafter RSD) eﬀect [31–36]. The strength
of the anisotropic pattern imprinted on the power spec-
trum can be used to determine the linear growth rate of
the structure formation [20, 29, 37–49].

However, the full statistical analysis of the anisotropy
pattern of the RSD eﬀect is contaminated by several
systematics [33, 49–79], which weakens our conﬁdence
on RSD cosmological constraints in comparison with
other probes of large scale structure [64, 67, 72, 76, 80–
82]. First, the transformation between real and redshift
spaces is intrinsically non–linear, in that the density per-
turbation and velocity ﬁelds are non–linearly coupled
together in the mapping. The factorized formula has
been proposed to achieve the RSD theoretical model,
which turns out to be the combination of non–separable
linear squeezing eﬀect and non–linear smearing eﬀects
caused by those higher order polynomials. Next, the
non–linear corrections on density and velocity ﬁelds are
poorly understood and hard to be cleaned from the mea-

sured anisotropic power spectrum. Several perturba-
tion theory with diﬀerent truncation strategies, e.g., the
closure approximation [83], have been exploited to pre-
dict the non–linear density–density, density–velocity and
velocity–velocity power spectra, but all of them are not
trustable beyond the limit of approximation. Finally, the
small scale distortion along the line of sight is caused by
the randomness of the velocity ﬁeld, called the Finger–
of–God (hereafter FoG) eﬀect. This eﬀect is intrinsically
non–perturbative, and there is little clue of its exact theo-
retical form neither in scale nor in time. All these system-
atics are mixed up in the full RSD analysis, which makes
us losing our conﬁdence on cosmological constraints from
the RSD eﬀect beyond the conservative limited scale at
quite linear regime.

In this paper, we study solutions to remove the above
systematics and to reproduce the observed power spec-
trum in accuracy. The mapping formula of cluster-
ing from real to redshift space is given in an unbiased
way. The full higher order polynomials are given by inﬁ-
nite cross correlation terms between density and velocity
ﬁelds, which will not be provided in any closed form but
simply expanded and truncated at certain order. Mean-
while, other systematics can be removed at least in the
same expansion order of polynomials. In the expansion
of higher order polynomials, there are multi-point power
spectra whose non–linear corrections are unknown. The-
oretical non–linear approximation can be used, but it
is diﬃcult to theoretically formulate higher order cor-
relation functions in accuracy such as bi–spectra and
tri–spectra. So we provide the direct measurements of
all perturbative terms using many realisations of simu-
lations, which removes the uncertainty due to the un-
known non–linear corrections. The systematic caused by
the randomness of the peculiar velocity ﬁeld can be con-
trolled as well. The theoretical expression of the FoG
term contains two distinct parts; the non–local FoG term
which is independent of the separation vector between
two diﬀerent points, and the local FoG term which is
given by an inﬁnite expansion of the velocity auto corre-
lation ﬁelds. The local FoG term is coherently expanded
in the same order as other higher order polynomials, and
the non–local FoG term is provided in the closed formula
with a single scale independent parameter of velocity dis-
persion. We will prove that, when the mapping formula
is expanded up to second order polynomials of kµ, the
measured non–local FoG term at diﬀerent scales is con-
sistently aligned on the one single curve which is close to
a Gaussian function. When the directly measured non–
linear corrections and the pre–determined FoG functional
form are exploited, the estimated 2-dimensional (here-
after 2D) redshift space power spectrum is well repro-
duced up to k <
the future survey.

∼ 0.3h/Mpc within the statistical error of

The paper is organized as follows. In Sec. II, we intro-
duce our theoretical model of redshift distortion. Sec. III
presents the simulation measurements of individual terms
of the formula. In Sec. IV, the residual FoG term is mea-

2

sured and the best ﬁtting function is studied. Finally, we
conclude and discuss in Sec. V.

II. RSD FORMULA

Both inhomogeneous density and velocity ﬁelds at
large scales are small perturbations to the homogeneous
background of the universe.
If the ﬁrst order approx-
imation of ﬂuctuations dominates, the observed red-
shift space power spectrum could be expanded in two–
dimensional space spanned by radial and transverse di-
rections.

The density ﬁeld seen at the redshift space is distorted

by the peculiar motions of particles, halos or galaxies,

s = r +

v · ˆz
aH

,

(1)

where r and s denote vector distances in real and red-
shift spaces respectively, and v, a and H are the physical
peculiar velocity, the scale factor and the Hubble param-
eter. We choose ˆz direction as the line-of-sight direction.
Then the observed 2D power spectrum in redshift space
is given by [61],

P (S)(k, µ) =Z d3x ei k·x(cid:10)ej1A1A2A3(cid:11) ,

in which we deﬁne

(2)

j1 = −i kµ,

A1 = uz(r) − uz(r′),
A2 = δ(r) + ∇zuz(r),
A3 = δ(r′) + ∇zuz(r′),

where x = r − r′, u ≡ −v/(aH), uz is the radial di-
rection component of u, and µ denotes the cosine of the
angle between k and the line of sight. Eq. (2) adopts
the plane parallel approximation and single-streaming
approximation, beside which it describes a rigorous map-
ping from real space density clustering to redshift space
density clustering.

The pairwise velocity ﬁeld, A1, which appears in the
exponential function of the mapping in Eq. (2), will cause
an indeﬁnite series of higher order polynomials, as shown
later. We rewrite the ensemble average hej1A1A2A3i in
terms of the connected cumulants [57, 61] as

then Eq. (2) reduces to

hej1A1A2A3i = exp(cid:8)hej1A1ic(cid:9)

×(cid:2)hej1A1A2A3ic + hej1A1A2ichej1A1 A3ic(cid:3) ,
P (S)(k, µ) =R d3x eik·x exp(cid:8)hej1A1ic(cid:9)
×(cid:2)hej1A1A2A3ic + hej1A1A2ichej1A1 A3ic(cid:3) .

The “perturbative terms” after mapping, which will be
Taylor expanded later, are collected inside the bracket

(3)

in the second line of the equation, which includes the
squeezing Kaiser terms, and other higher order perturba-
tive polynomials. These higher order polynomials have
either amplifying or damping eﬀects to P (S)(k, µ). The

prefactor exp(cid:8)hej1A1ic(cid:9) mainly describes the uncertainty

due to the randomness of the velocity ﬁeld.
source of the FoG eﬀect.

It is the

In the conventional assumption, the FoG prefactor

exp(cid:8)hej1A1ic(cid:9) is treated as a non–local term which could

be factored out of the spatial integration (e.g. [61]). Here
“non-local” means “global”, that a quantity is indepen-
dent of the separation vector x. On the opposite, “local”
means that a quantity is dependent on x. Then the ob-
served power spectrum could be approximately described

3

as,

P (S)(k, µ) = DFoG(kµσz)Pperturbed(k, µ),

(4)

where DFoG(kµσz) is the FoG term, in which σ2
denotes the line-of-sight velocity dispersion, and the
Pperturbed represents the Fourier transformation of the
bracket terms in the integral of Eq. (3).

z ≡(cid:10)u2
z(cid:11)c

Rigorously, the non-local assumption of exp(cid:8)hej1A1ic(cid:9)

is questionable, as that it can be mathematically divided
into two parts [61, 73], one non-local part consisting of
one point velocity cumulants, and the other local part
which includes local auto velocity ﬁeld correlations. After
Taylor expanding ej1A1 , the decomposition is shown as,

exp(cid:8)hej1A1ic(cid:9) = exp( ∞
Xn=1
= exp( ∞
Xn=1

n! ) = exp( ∞
1 hAn
1ic
Xn=1
jn
(2n)! ) × exp( ∞
2huz(r)2nic
Xn=1

j2n
1

= DFoG

non−local(kµ) × DFoG

local(kµ, x).

1 h(uz(r) − uz(r′))2nic
j2n

(2n)!

)

1 h(uz(r) − uz(r′))2nic − huz(r)2nic − huz(r′)2nic
j2n

(2n)!

The odd power terms in Eq. (6) are nulliﬁed due to the symmetric characteristic of the velocity ﬁeld,

(cid:10)uz(r)αuz(r′)β(cid:11)c = 0 when α + β = 2n + 1. Two exponential terms in Eq. (6) are deﬁned in Eq. (7) in order

local, which could be reformed as,

non−local and DFoG

by DFoG

(5)

)(6)

(7)

(8)

DFoG

j2n
1

DFoG

non−local(kµ) ≡ exp( ∞
Xn=1
local(kµ, x) ≡ exp( ∞
Xn=1
= exp(−j2
1huz(r)uz(r′)ic +

(2n)! ) = exp(j2
2huz(r)2nic

1 σ2

z +

j2n
1

∞

Xn=2

1 h(uz(r) − uz(r′))2nic − huz(r)2nic − huz(r′)2nic
j2n

(2n)!

(2n)! ) ,
2huz(r)2nic
)

1 h(uz(r) − uz(r′))2nic − huz(r)2nic − huz(r′)2nic
j2n

(2n)!

) .

(9)

∞

Xn=2

This classiﬁcation of FoG assists us to isolate the
true “non-local” part of the FoG term. The local FoG
part depending on x remains in the integration with
other perturbative terms.
It will be expanded coher-
ently in the same order as higher order polynomials of
density–velocity cross correlations. And the non–local
part DFoG
non−local is safely factored out of the integration
which is in terms of x, and as shown later, it could be
parameterized with a single parameter of σz, which by
deﬁnition is a constant. Then the conventional expres-
sion of the observed spectrum in Eq. (4) is rewritten as,

P (S)(k, µ) = DFoG

non−local(kµ)R d3x eik·xDFoG

×(cid:2)hej1A1A2A3ic + hej1A1A2ichej1A1A3ic(cid:3) . (10)

Deﬁning the reduced cumulants of the velocity ﬁeld,
non−local could

z, the non-local FoG term DFoG

local(kµ, x)

Ki ≡(cid:10)ui(cid:11)c /σi

be written as [73],

DFoG

non−local(kµ) = exp(j2

1 σ2

z + 2

1 σ2n
j2n
z

K2n

(2n)!) ,

∞

Xn=2

(11)
where the higher order reduced velocity cumulants K2n
(n ≥ 2) indicate the non-Gaussianity of the velocity ﬁeld,
which is generated by non-linear structure formation. In
[74], authors measured σ2
z and higher order K2n from
simulations, together with the exact non-local FoG term
by integrating the measured velocity Probability Distri-
bution Function. They proved that the non-local FoG
term can be well approximated by a Gaussian form (Fig.
11 of [74]),

non−local(kµσz) ≃ ej2
DFoG

1 σ2

z = e−k2µ2σ2
z .

(12)

The accuracy of the approximation is within 1% accu-

racy at k < 0.3h/Mpc and z = 0 ∼ 2. Here, σ2
z is not
only the dispersion of small scale random velocity, but
the dispersion of the whole velocity ﬁeld, which could be
expressed as the integral of the velocity power spectrum,

σ2
z =

1

3Z dk

2π2 PΘΘ .

(13)

The local FoG term and other perturbative parts in
Eq. (10) are indeﬁnite to be expressed by order expan-
sion. In the regime of small j1, ej1A1 is expanded in terms
of j1 as,

local(kµ, x)(cid:2)hej1A1A2A3ic + hej1A1A2ichej1A1A3ic(cid:3)
DFoG
≃ j0
1hA2A3ic + j1
1nhA1A2ichA1A3ic +
+j2
+O(j3
1 ) ,

1hA1A2A3ic
1
2 hA2

1A2A3ic − huzu′

zichA2A3ico

(14)

where we truncate the expansion at j2
1 order. Then the
zeroth order term, hA2A3ic, representing the squeezing
eﬀect, corresponds to Pδδ + 2µ2PδΘ + µ4PΘΘ [57] with
the velocity divergence Θ ≡ −∇ · v/(aH) = ∇ · u. The
higher order terms are deﬁned as,

A(k, µ) = j1 Z d3x eik·x hA1A2A3ic,

B(k, µ) = j2

T (k, µ) =

F (k, µ) = −j2

1
2

j2

1 Z d3x eik·x hA1A2ic hA1A3ic,
1 Z d3x eik·x hA2
1 Z d3x eik·x huzu′

1A2A3ic,

zichA2A3ic,

Here A, B and T terms are originated from higher or-
der density–velocity cross correlation polynomials, and
F terms comes from higher order velocity auto correla-
tions.

Finally we derive the RSD model in coherent order

expansion of kµ,

P (S)(k, µ) = DFoG(kµσz)Pperturbed(k, µ)

= DFoG(kµσz)[Pδδ + 2µ2PδΘ + µ4PΘΘ (15)
+A(k, µ) + B(k, µ) + T (k, µ) + F (k, µ)].

From now on, we drop the subscript of “non–local”, and
DFoG(kµσz) represents the non–local FoG eﬀect. Al-
though DFoG(kµσz) function is expected to be Gaussian
[74], the exact functional form is assumed to be unknown
in this paper. The higher order truncation eﬀect is ab-
sorbed into DFoG(kµσz). Consequently σz represents ef-
fects from the summation of velocity cumulants and the
truncated higher order polynomials, remaining unknown
but a constant. We test diverse FoG functions which are
adopted in many literatures,

DFoG(kµσz) =


e−k2µ2σ2

z /2

(cid:0)1 + k2µ2σ2
(cid:0)1 + k2µ2σ2

z /2(cid:1)−1
z /2(cid:1)−2

Gaussian,
Lorentzian,
squared Lorentzian,

(16)

4

value

parameter physical meaning
Ωm
ΩΛ
Ωb
h
ns
σ8
Lbox
Np
mp
Nsnap
zini
zfinal

present fractional matter density 0.3132
1 − Ωm
0.6868
present fractional baryon density 0.049
H0/(100 km s−1Mpc−1)
0.6731
primordial power spectral index 0.9655
r.m.s. linear density ﬂuctuation 0.829
simulation box size
simulation particle number
simulation particle mass
number of output snapshots
redshift when simulation starts
redshift when simulation ﬁnishes 0.0

1890 h−1Mpc
10243
5.46 × 1010h−1M⊙
13
49.0

TABLE I: The parameters and technical speciﬁcations of the
N-body simulations for this work.

where σz is set to be a free parameter ﬁtted by simula-
tion measurements. In this manuscript, the perturbative
terms are expanded up to j2
1 order, and the only un-
determined parameter becomes σz with the given FoG
functional form. If this order truncation approximation
is valid, σz remains a constant. When it becomes scale
dependent, the RSD model is considered to be contami-
nated by higher order jn

1 (n ≥ 3) terms.

III. MEASUREMENTS OF THE

PERTURBATIVE TERMS

In this section, we provide the individual measure-
ments for all perturbative terms in Eq. (15), using the N-
body simulations. In Sec. IV, the summation of them will
be divided from the measured 2D redshift space power
spectrum to obtain the non-local FoG term measure-
ments. This helps us remove the uncertainty due to the
non–linear evolution which can not be perfectly predicted
by perturbation theory. Though the non–linear spectra
at zeroth order of j1 are well known both by analytic
formulation and by simulation, higher order polynomials
have been calculated only theoretically, and have not yet
been conﬁrmed directly for each term from simulations.
Our work is based on 100 realisations of N–body dark
matter simulations (Minji Oh et.al 2016, in preparation).
Each simulation is run by the cosmological simulation
code GADGET2 [84], with box-size Lbox = 1.89 h−1Gpc
and Np = 10243 particles. The box-size is chosen to
mimic a similar survey volume as DESI will observe be-
tween z = 0.8 and z = 1.0 [85]. All realisations are
generated with the same cosmological model, so 100 sim-
ulations could help us identify the systematic contamina-
tion at 10% level of the targeted signal to noise for DESI
survey. We assume a LCDM cosmology with Gaussian
initial condition and ﬂat space. The cosmological pa-
rameters are identical to PLANK15 results [86]. The
initial conditions are generated by the 2LPT code [87] at
z = 49. We mainly analyse 4 snapshots in this paper,
namely z = 0.5, 0.9, 1.5, and 3.0. The detailed simula-
tion parameters are listed in Table I.

In the following subsections, we describe the method-
ology to directly measure each term in Eq. (15), which

5

points, as shown in Sec. II, all perturbative terms are
essentially deﬁned at only two distinct points of r and
r′, whose measurements turn out to be calculations of
only two point correlation functions. Mathematically, all
terms can be decomposed into three basic elements of
δ(r), uz(r) and ∇zuz(r). So ﬁrst we use the Nearest
Grid Point (NGP) method to sample the density ﬁeld on
regular 10243 girds and use the Nearest Particle (NP)
[74] method to sample the velocity ﬁelds on regular 5123
grids. Then the combination of three elements at each
point is computed, ﬁnally we construct two speciﬁc ﬁelds
by summing the basic elements and make the two point
correlation functions of these two ﬁelds to complete the
measurements.

All measurements contain systematic errors due to ﬁ-
nite particle number and grid size [89–91]. But since our
simulations have high enough particle number density
and small enough grid size, all these numerical eﬀects are
negligible at 1% level for the scientiﬁc goal of this work,
at least within our interested scales, e.g., k < 0.2h/Mpc
[92]. We also compare the simulation calculations with
perturbative predictions to show the break-down scales
of the perturbation theories in this section.

A.

j0
1 order: power spectra

In this subsection, we calculate the zero’s order terms
in the j1 expansion, using both perturbation theory and
direct measurement from the simulations. There is no
other higher order polynomials but the simple Kaiser
terms of Pδδ, PδΘ, and PΘΘ in this lowest order.

First, these Kaiser terms are calculated using pertur-
bation theory. The odd UV behaviour appears in the
standard perturbation theory caused by the incomplete
expansion. It is improved by incorporating an appropri-
ate UV regularization, which removes all bad UV sectors,
dubbed as the regularized perturbation theory [88] (here-
after RegPT). The RegPT theory is based upon a multi-
point propagator expansion which applies to both density
and velocity ﬁeld multiple propagators to encapsulate the
non-perturbative properties of gravitational eﬀect. We
apply the RegPT for deriving theoretical prediction of j0
1
order terms, and present the results as dash curves in
Fig. 1. The predictions of Pδδ, PδΘ, and PΘΘ using RegPT
are shown in the top, middle and bottom panels respec-
tively at four diﬀerent redshifts of z = 0.5, 0.9, 1.5, and
3.0.

Next, the Pδδ, PδΘ, and PΘΘ spectra are directly mea-
sured using simulations, which are represented by solid
curves in the top, middle and bottom of Fig. 1 respec-
tively. Theoretical prediction fails at the regime in which
UV behaviour becomes dominant. The diﬀerence be-
tween solid and dash curves is explained by this reason.
The theoretical prediction for Pδδ agrees with the mea-
surement at k <
PΘΘ prediction breaks down at k >
causes the inaccurate prediction of the observed spec-

∼ 0.2 h Mpc−1 at low redshifts, but the
∼ 0.1 h Mpc−1, which

FIG. 1: We present the measured Pδδ, PδΘ, and PΘΘ ver-
sus the theoretical Pδδ, PδΘ, and PΘΘ at z = 0.5, 0.9, 1.5,
and 3.0., as solid and dash curves respectively. The top,
middle and bottom panels represent tests on Pδδ, PδΘ, and
PΘΘ respectively. The measured Pδδ, PδΘ, and PΘΘ are
mean values out of 100 simulations, and the small error bars
on the solid curves denote the standard errors of the mean,
σmean = σ/√N , with σ being the sample standard deviation,
N = 100 being the sample number. The dashed lines show
the predictions from RegPT [88].

1 terms, one j1

1 term and three j2

includes three j0
1 terms.
We separately compute the averages of all those terms
from 100 realisations, which are assumed to be suﬃ-
ciently close to the true values. The averages from the
limited number of realisations leaves the small deviations,
but the diﬀerence is as small as 10% of the statistical
uncertainty of the given simulation volume. Although
some terms could be expressed as the integrations of
the higher order correlation functions larger than two

6

FIG. 3: Similar with Fig. 2, but for B(k, µ) term. We caution
that the y-axis ranges of up and bottom panels are diﬀerent.

where the bispectrum Bσ is deﬁned by

(cid:28)θ(k1)(cid:26)δ(k2) +

= (2π)3δD(k1 + k2 + k3) Bσ(k1, k2, k3).

k2
2z
k2
2

θ(k2)(cid:27)(cid:26)δ(k3) +

k2
3z
k2
3

θ(k3)(cid:27)(cid:29)

(19)

The theoretical solution of A(k, µ) is calculated con-
sistently with theoretical j0
1 terms derived using RegPT
scheme which are presented as dash curves in Fig. 1. The
level in the A(k, µ) perturbation is correspondent to the
tree level, in which j0
1 order terms are selected to com-
pute this level by incorporating one loop level. Then the
perturbative expansion in Bσ is truncated at the leading
order, and other higher order levels are ignored (see the
Appendix of [61] for details). The theoretical solution is
presented by dash curves in four panels in Fig. 2. Each
panel represents the results at diﬀerent redshifts z = 0.5,
0.9, 1.5 and 3.0.

While the theoretical solution of A(k, µ) is derived by
integrating bi–spectra in Fourier space using Eq. (18),
it is a time–consuming procedure when A(k, µ) is com-
puted numerically from simulations. Instead, we exploit
the expression given in Eq. (17), which is eﬀectively de-
composed into two point functions in the conﬁguration
space. All perturbative ﬁelds of δ(r), uz(r), ∇zuz(r),
δuz(r), and uz∇zuz(r) are separately measured to be
combined at two diﬀerent points. The combined ﬁelds
at both r and r′ are cross–correlated appropriately, and
the measured pairs in the conﬁguration space are trans-
formed into the Fourier space. We collect all Fourier
components to provide the numeric A(k, µ), which is pre-
sented as solid curves in Fig. 2 at diverse redshifts.

FIG. 2: A(k, µ) term measured from 100 N-body simulations
at z = 0.5, 0.9, 1.5, and 3.0. Diﬀerent colors represent diﬀer-
ent k bins. The solid lines are the mean value averaged over
100 simulations, and the error bars are the standard errors of
the mean, σmean = σ/√N , with σ being the sample standard
deviation, N = 100 being the sample number. The dashed
lines show the predictions from standard perturbation theory
[61]. We caution that the y-axis ranges of up and bottom
panels are diﬀerent.

trum at µ → 1 limit. If we are interested in RSD model
at k >
∼ 0.1 h Mpc−1, more precise theoretical prediction
is demanded. In this manuscript, the measured j0
1 order
terms from simulations are used, and our results are free
from UV issues.

B.

j1
1 order: A term

The A(k, µ) in Eq. (15) is a leading j1

1 order in poly-
nomial expansion generated by non–linear mapping of
density–velocity cross–correlation. There is no corre-
sponding j1
1 order term in the expansion of velocity auto–
correlation mapping. The A(k, µ) term is described as
[61],

A(k, µ) = j1 Z d3x eik·x hA1A2A3ic
= j1 Z d3x eik·x h(uz − u′
×(δ + ∇zuz)(δ′ + ∇zu′
z)ic
= (kµ)Z d3
−Bσ(p, k,−k − p)},

p
(2π)3

z)

pz
p2{Bσ(p, k − p,−k)

(17)

(18)

7

FIG. 4: Similar with Fig. 2, but for T (k, µ) term. We caution
that the y-axis ranges of up and bottom panels are diﬀerent.

FIG. 5: Similar with Fig. 2, but for F term. We caution that
the y-axis ranges of up and bottom panels are diﬀerent.

We compare the theoretical and numerical results in
Fig. 2 using characteristic scales from linear to non–linear
regimes of k = (0.055, 0.115, 0.155, 0.215, 0.255) h Mpc−1.
Both agree at small µ → 0 limit, but deviates to each
other at µ → 1. It is diﬃcult to explain the origin of the
diﬀerences, as higher order perturbative theory is not well
understood beyond two point functions. However, the
theoretical prediction even at the tree level is quite con-
sistent with the measurement, which explains most suc-
cessful applications of the improved theoretical model for
observations at low redshifts. Note that the eﬀect of j1
1
order contributes diﬀerently to the observed power spec-
trum, in that the enhancement at small k modes and the
decrement at high k modes, which are numerically con-
ﬁrmed here. In this work, because the numerical j0
1 order
solutions are adopted, the numeric A(k, µ) is counted.

C.

j2
1 order: B, T and F terms

Three terms of B(k, µ), T (k, µ) and F (k, µ) in Eq. (15)
represent the complete components in the expansion of
j2
1 order. The B(k, µ) and T (k, µ) are provided by non–
linear mapping of density–velocity cross–correlations,
and the F (k, µ) comes from the mapping of velocity auto–
correlation huzu′
zic pairs which are generated from the
FoG eﬀect. In this subsection, we calculate these terms
numerically, and compare them with theoretical predic-
tions if available.

The expression of B(k, µ) is given by,

B(k, µ) = j2

1 Z d3x eik·x hA1A2ic hA1A3ic,

= j2

1 Z d3x eik·x h(uz − u′
×h(uz − u′
z)(δ′ + ∇zu′
z)ic.

z)(δ + ∇zuz))ic

(20)

Then the numeric solution for B(k, µ) is straightforward.
Again, we compute both two point correlation functions
of hA1A2ic and hA1A3ic to be combined into the in-
tegrand in terms of x. The Fourier transformation of
that integrand provides us the correct solution of B(k, µ).
Unlike the case of A(k, µ), the alternative expression of
B(k, µ) is not complicated to be used for numeric calcu-
lation. The B(k, µ) could also be expressed in the Fourier
space as,

B(k, µ) = (kµ f )2Z d3p
p2 (cid:26)PδΘ(p) + f

(2π)3 F (p)F (k − p),
p2 PΘΘ(p)(cid:27) .

p2
z

pz

F (p) =

(21)

If all power spectra of density and velocity ﬁelds are di-
rectly measured as in Sec. III A, the integrand in Fourier
space can be derived correctly. We compare both mea-
sured results from Eq. (20) and Eq. (21), and they are
consistent with each other. This indirectly conﬁrms that
our method applied for calculating B(k, µ) in the con-
ﬁguration space is correct. The measured B(k, µ) are
presented as solid curves in Fig. 3. We see that the am-
plitude of B(k, µ) term is 3 ∼ 4 times smaller than that
of A(k, µ) term.
The theoretical prediction of B(k, µ) is derived using
tree level perturbative theory, by substituting the linear
density power spectrum into Eq. (21), which is presented

8

FIG. 6: The mean values of the residual FoG are described in the section IV A at z = 0.5 and 1.5 in the top and bottom
panels respectively. The selected scales are k = (0.065, 0.095, 0.155, 0.215, 0.275) h−1 Mpc. (The ﬁrst column) The residual FoG
is presented after subtracting j0 order perturbative terms. (The second column) The subtracted terms includes A + B as well
as j0 order perturbative terms. (The third column) The subtracted terms includes A + B + T as well as j0 order perturbative
terms. (The fourth column) The subtracted terms includes A + B + T + F as well as j0 order perturbative terms.

as dash curves in Fig. 3. The agreement between the
theoretical and numerical B(k, µ) is impressive, although
there is slight diﬀerence observed at low redshifts. It is
predicted that it decays the observed spectrum at small
µ and enhances it at large µ, which is conﬁrmed numer-
ically as well.

The expression of T (k, µ) in Eq. 15 is given by,

T (k, µ) =

=

j2

1
1 Z d3x eik·x hA2
1A2A3ic
2
1
1 Z d3x eik·x h(uz − u′
j2
z)2
2
×(δ + ∇zuz)(δ′ + ∇zu′
z)ic.

(22)

We apply the same numerical method as A(k, µ) calcula-
tion to derive T (k, µ) here. We construct the combined
ﬁelds at r and r′ separately, and compute the correla-
tion functions in the conﬁguration space. Those terms
are collected to be transformed into the Fourier space,
which are presented as solid curves in Fig. 4.

Unfortunately, the theoretical prediction of this tri–
spectrum contribution is not provided in this work. The
numerical results are shown in Fig. 4, and the T (k, µ)
contributes to the suppression of the observed spectrum
at all scales and pair orientations. It is remarkable that
this contribution is comparable to terms of A(k, µ) and
B(k, µ) which are key elements in the improved theoreti-
cal RSD model [61]. Because it eﬀectively suppresses the
observed spectrum in redshift space, it can be considered
to be a part of FoG suppression. However, FoG sup-
pression to the observed spectrum is coherent in terms
of scales, which is a distinct feature of T (k, µ) suppres-
sion. If T (k, µ) is absorbed into the FoG eﬀect, then the
residual FoG will not present the scale–independence in

terms of k.

The origin of F (k, µ) in Eq. (15) is diﬀerent from other
j2
1 terms which are only parts of perturbative higher order
Kaiser terms. The local FoG eﬀect contains the higher
order velocity correlations depending on the separation
of two points. This velocity auto–correlation polynomi-
als are indeﬁnite as well, which needs to be expanded.
It is also chosen to be expanded it in terms of j1, then
both the perturbative terms and local FoG polynomials
are expanded coherently. The leading order of this ef-
fect appears as the multiplication between huzu′
zic and
hA2A3ic in j2

1 , which is given by,

F (k, µ) = −j2
= −j2

1 Z d3x eik·x huzu′
1 Z d3x eik·x huzu′
zic
×h(δ + ∇zuz)(δ′ + ∇zu′
z)ic.

zichA2A3ic,

(23)

This equation is numerically computed using simulations
using the similar methods described as B(k, µ) term cal-
culation. Again, the alternative tree level expression in
Fourier space is given by,

(2π)3 δD(k − p − q)
q PδΘ(q) + f 2 µ4

F (k, µ) = (kµ f )2Z d3pd3q
× (cid:8)Pδδ(q) + 2 f µ2
≃ (kµ f )2Z d3pd3q
(2π)3 δD(k − p − q)
q(cid:1)2
p2 (cid:0)1 + f µ2
×

µ2
p

µ2
p
p2 PΘΘ(p)
q PΘΘ(q)(cid:9)(24)

Plin(p)Plin(q).

(25)

We cross–check that the results from Eq. (23) and (24)

9

FIG. 7: Left panel: The measured FoG is presented at z = 0.5, 0.9, 1.5 and 3.0, with errors being the sample standard deviation.
The measured points are central values from 100 realisation simulations. Right panel: The diﬀerence between the measured
and best ﬁt Gaussian FoG’s.

are consistent with each other, which conﬁrms our nu-
merical calculation.

The structure of F (k, µ) is similar to B(k, µ) case in
which the simple tree level calculation agrees with the
direct measurement using simulations. The directly mea-
sured F (k, µ) is presented as solid curves in Fig. 5, and
the prediction using Eq. (25) is presented as dash curves.
Both are consistent. Note that the eﬀect of F (k, µ) co-
herently enhances the observed spectrum which makes
similar size of but opposite contribution to the redshift
space power spectrum as T (k, µ). So the combined eﬀect
of F (k, µ) and T (k, µ) on the observed spectrum can be
smaller. But for the completeness of the order expansion,
we include both contributions in our analysis.

IV. FINDING THE FOG FUNCTION

If the full

indeﬁnite higher order polynomials in
Eq. (15) are given, the residual non–local FoG, DFoG,
appears as a complete function of the single parameter
σz which is independent of scale [74]. But, in reality, the
perturbative terms in Eq. (15) are incompletely known,
the assumed non–locality will not be available at the spe-
ciﬁc scale.
In this work, the higher order polynomials
contain the order contributions of density–velocity cross–
correlations and velocity–velocity auto–correlations up to
j2
1 order. The cutoﬀ scale is placed at the regime in which
those low order polynomials are dominating. Within this
limit, DFoG is described by a scale independent coher-
ent curve which can be pre–determined in cosmological

model independent way.

A. The best ﬁtted FoG function

The non–local FoG term is, by deﬁnition, independent
of the separation vector x between two points, and fac-
tored out of the integration in terms of x. Then the re-
maining integrand contains all the correlation pairs, and
the external multiplicity factor DFoG depends on only
one point random velocity dispersion and its cumulants.
This non–local FoG factor is described by a function of
kµ in Fourier space. If we fully subtract the perturba-
tive integrand from the observed spectra, the residual
multiplicity factor will be consistent with the true DFoG,
which should be described by a single function in terms
of kµ regardless of the individual k modes. We present
the measured residual FoG term after subtracting out
diﬀerent perturbative term combinations in Fig. 6.

To begin with, the residual FoG is presented after sub-
tracting only j0
1 order terms at z = 0.5 and 1.5 in the ﬁrst
column of Fig. 6.
It is correspondent to Scoccimarro’s
model in which non–linear corrections are complete for all
zero’s order terms, but no higher polynomials are added
[57]. The residuals are computed using diﬀerent scales
of k = (0.065, 0.095, 0.155, 0.215, 0.275) h Mpc−1 at both
redshifts. Those residuals at diﬀerent k modes are not
aligned coherently along a single curve. It indicates that
the measured residuals are contaminated by other per-
turbative terms which are not ignorable at those scales.
The improved RSD theoretical model, TNS model [61],

10

FIG. 8: The FoG is assumed to be Gaussian, and we ﬁt best
σv for the measured residuals at each k, to test whether the
observed σv is nearly scale dependent or not. The measured
residuals are presented as triangle points, and errors are ex-
plained in the text. The solid and dash lines separately rep-
resent the simulation measured and linear one dimensional
velocity dispersions.

FIG. 9: The ﬁtted kcut − Vsurvey relation for A + B + T +
F model. In general, Gaussian FoG function is better than
other ﬁtting functions. This ﬁgure could be a guideline of the
maximum k mode we can use for a speciﬁc survey strategy in
the future.

1 and one j2

has been suggested to reproduce BAO features in preci-
sion . This standard perturbation RSD theory addition-
ally includes one j1
1 order terms, which are
A(k, µ) and B(k, µ) respectively. Other contributions in
j2
1 order were not included, as those are considered to be
irrelevant for BAO reconstruction. The measured residu-
als are presented in the second column of Fig. 6, which ex-
hibits more consistent DFoG at diﬀerent scales, although
there is still slight inconsistency at high k modes and
large µ bins. Here the uncertainty due to non–linear cor-
rections is removed by directly measuring both A and B
terms, and the result can be improved by completing all
polynomials at the given order.

Next we present new result after subtracting out j1

1 and
j2
1 order polynomials generated by all density–velocity
cross–correlations, i.e.
including T (k, µ) as well. The
T (k, µ) based on the tri–point correlation function has
not been considered seriously yet, as it is assumed not to
be signiﬁcant for BAO reconstruction, and the full non–
linear corrections are not known. In this manuscript we
are interested in full RSD clustering analysis more than
just focusing on distance measures, and we are able to
calculate non–linear corrections using simulations. The
residuals are presented in the third column of Fig. 6. The
measured FoG is aligned more consistently along a single
curve which is diﬀerent from the previous case of A + B
subtraction. It is interesting to note that the eﬀect of T is

∼ 0.3h/Mpc presented

not negligible at all. If the information of full RSD clus-
tering is requested, then T should be counted. Finally,
we also include another j2
1 order term originated from
velocity–velocity auto correlation higher order polyno-
mials, F (k, µ). All measured residuals at diﬀerent scales
are exhibited consistently up to k <
in the fourth column of Fig. 6. From now on, the residual
FoG is derived after subtracting all A, B, T and F terms.
The detailed test on the residual FoG is provided to
determine the best FoG functional form for the resolu-
tion of (1.89 Gpc/h)3 box which is close to the survey
volume of most future experiments such as DESI. First
of all, errors on the residual FoG are estimated in the
following way. Averages of all perturbative terms at
j0
1 , j1
1 are computed using 100 realisation sim-
ulations. The observed spectrum for each box is sub-
tracted by this averaged perturbative templates, which
provides the dispersion of the measured residuals as pre-
sented in the left panel of Fig. 7. Then we ﬁt the con-
ventional FoG models such as Gaussian, Lorentzian and
squared Lorentzian. The σz is assumed to be constantly
variable for all FoG models. The k space is binned
from kmin = 0.035 h Mpc−1 to kmax = 0.6 h Mpc−1 with
k spacing of ∆k = 0.01 h Mpc−1. The ﬁtting to the
measured residual FoG starts from the lowest k mode,
and halts when the reduced χ2 becomes greater than
χ2

reduced
The best ﬁtting FoG model turns out to be Gaus-

1 and j2

>

∼ 1.

11

FIG. 10: The multipole components of spectrum is presented at z = 0.5, 0.9, 1.5 and 3.0 from the ﬁrst to fourth columns.
Monopole, quadrupole and hexadecapole spectra are shown in the top, middle and bottom panels. The solid curve represents
the theoretical estimation using the best FoG ﬁtting, and the cross points represent the directly observed multipoles.

∼ k <

sian with kcut = (0.275, 0.305, 0.355, 0.465) h Mpc−1 at
z = (0.5, 0.9, 1.5, 3.0). The solid curves in the left panel
of Fig. 7 represent the best ﬁtting Gaussian FoG at the
given kcut. Being diﬀerent from the conventional results,
Lorentzian FoG poorly ﬁts to the data with the same kcut
of Gaussian case. The reduced χ2 is presented in the ﬁg-
ure, and Lorentzian FoG becomes uncompetitive when
the full perturbative terms are correctly subtracted out.
The third option of squared Lorentzian is more favoured
than Lorentzian one, but still not better than Gaussian
FoG. This result is consistent with our prediction. In the
right panel of Fig. 7, we present the diﬀerence between
the measured and estimated FoG using Gaussian model.
Considered the resolution of map with (1.89 Gpc/h)3 vol-
ume, the estimated FoG model up to kcut is reasonably
placed within errors.

B. The ﬁtted σ2

z − k relation

Note that we have to be assured that whether there is
any scale dependence on the measured σz. In Fig. 8, we
present the ﬁtted σz in each k mode, which contains 10
equally distributed µ bins from µ = 0 to 1, at z = 0.5,
0.9, 1.5 and 3.0 using Gaussian FoG model. The ob-
served spectra are minimally contaminated by non–linear
physics at high redshift, e.g. z = 3.0. The observed σz
at z = 3.0 is indeed constant regardless of k scale up
to k <
∼ 0.3 h Mpc−1. Here we do not present results at
k <
∼ 0.1 h Mpc−1, because the measured residual is nearly

featureless to determined σv. There will be no planned
redshift survey at this high redshift, but we conﬁrm our
methodology at the region in which the measured spec-
trum remains nearly linear. We continue our test at lower
redshifts of z = 0.5, 0.9 and 1.5 in which the observed
spectra are highly contaminated by non–linear physics.
There is slight k dependence of σz developed between
0.1 <
∼ 0.15, but the variation of σz is much smaller
than errors which are expected from the future survey.
When the subtraction is incomplete, the measured σz
keeps rising at k >
∼ 0.15. In our cases, it remains nearly
constant up to k <
∼ 0.3 h Mpc−1. When the full infor-
mation of higher order polynomials up to j2
1 is known,
there exists the non–local FoG with nearly constant σz
at k <

∼ 0.3 h Mpc−1.
In Fig. 8, it is interesting to notice the diﬀerence be-
tween the ﬁtted σ2
z from
simulations. As mentioned in [73, 74], the non-local FoG
part could be well approximated by a Gaussian func-
tion with the measured σ2
z as input. The accuracy is
within 1% level at k < 0.3h/Mpc. The diﬀerences here
could be a sign that higher than j2
1 order polynomials
play important roles in these scales. So at z = 3 when
the non-linearity is ignorable, the measured σ2
z is consis-
tent with the ﬁtted σ2
z within error budget, but at lower
redshifts, the diﬀerences become larger due to larger non-
linear evolution of density and velocity ﬁelds. This ex-
planation could be directly tested if we include higher
order polynomial calculations in the model. Another
possibility for the diﬀerences is that we adopt the single-

z and the directly measured σ2

12

at all redshifts.

We estimate the RSD power spectrum using the mea-
sured perturbative templates of A(k, µ), B(k, µ), T (k, µ),
F (k, µ), and the predetermined Gaussian FoG function
with a variable constant σv, from simulations. The tem-
plates are computed using averages of 100 realisations of
which variation is as small as 10% of statistical uncer-
tainty of each simulation. We ignore this small variation
in predicting the RSD power spectrum using these tem-
plates. Higher order polynomials of jn
1 with n ≥ 3 are
not included in our RSD model, as we remove modes
at k >
∼ kcut in which those higher order terms begin
to be dominant.
In our treatment, the systematic due
to unknown non–linear corrections is resolved as those
are exact measurements from the simulations. Also, the
systematic due to the randomness of peculiar velocities
of particles is controlled by the predetermined Gaus-
sian FoG function, which is tested to be the best op-
tion not only theoretically but also observationally. The
σz remains undetermined, but proved to be constant at
k <
∼ kcut. When the best ﬁtting σz is known, the theo-
retical RSD spectrum is provided.

We present the multipole components of the estimated
RSD spectrum in Fig. 10. Monopole moments are pre-
sented in the top panels at z = 0.5, 0.9, 1.5 and 3.0 from
the ﬁrst to the fourth column. The cross points rep-
resent the direct monopole measurement from the sim-
ulations, and the solid curves represent the estimated
RSD spectrum described in the previous paragraph. The
measured and estimated spectra are consistent to each
other. Quadrupole moments are more contaminated by
all systematics caused by non–linear clustering mapping
from real to redshift spaces, which are presented in the
middle panels. The measured ones agree with the esti-
mation in precision by k = 0.275 h Mpc−1 at z = 0.5,
k = 0.305 h Mpc−1 at z = 0.9, k = 0.355 h Mpc−1 at
z = 1.5, and k = 0.465 h Mpc−1 at z = 3.0.
It is a
remarkable improvement in our model.
In the bottom
panels, we compare hexadecapole moments as well. Al-
though there are discrepancies observed at low redshifts,
the measured errors are big there as well. The measured
and estimated hexadecapole moments are still consistent
under the error budget.

Alternatively, the RSD spectrum can be presented in
the 2D anisotropy plane of k and µ, as denoted by
P s(k, µ). We select spectra at ﬁve diﬀerent scales be-
tween kmin and kcut at each redshift bin, and present
those in µ direction. The P s(k, µ) at µ → 1 are con-
taminated most by RSD systematics. The directly mea-
sured P s(k, µ) are presented as cross points in Fig 11,
and our estimated P s(k, µ) are presented as solid curves.
Both are consistent in great precision even at µ → 1
limit. In the following works, we will investigate the de-
tailed power spectra reconstruction, the mapping of halo
or galaxy clustering, and the eﬀect of higher than j2
1 or-
der polynomials .

FIG. 11: The 2D anisotropy spectra are presented at z = 0.5,
0.9, 1.5 and 3.0. The points with errors represent the direct
measurements from the simulations, and the solid curves rep-
resent the theoretical estimation using our method.

In general, the
steaming approximation in our model.
multi-streaming eﬀect will induce an additional global
damping eﬀect to the power spectrum, which may turn
out to be the diﬀerences shown in Fig. 8.

V. DISCUSSIONS

We study the non–linear mapping of dark matter clus-
tering from real space to redshift space. The perturbative
description with a non–local FoG prior is proved to be
a precise RSD theoretical model predicting the observed
spectrum in the redshift space. However, this pertur-
bative theory is incomplete, and the model contains an
unknown sub–dominant contamination even at k <
∼ kcut
due to higher order terms which are not included in the
ﬁnite expansion. In the previous section, we deﬁne kcut
at the scale in which the systematic uncertainty due to
this contamination is smaller than the cosmic variance of
the survey volume. The conservative bound will be im-
posed, if we are concerned with bigger survey volumes,
or if we wishes to control systematics much smaller than
the survey variance. In Fig. 9, we present new bounds of
kcut according to bigger survey volumes represented by

N× survey volume (then the survey variance ∝ 1/√N ).

When N = 10, the contamination is controlled to be
smaller approximately by a factor of 3 than the cosmic
variance of one survey volume. Note that there is little
change in kcut until N ∼ 10. If it is requested under 10%
uncertainty control, then kcut is reduced by 0.1 h Mpc−1

Acknowledgments

We thank Pengjie Zhang for useful discussions and
thank Minji Oh for running the N-body simulations. Nu-

merical calculations were performed by using a high per-
formance computing cluster in the Korea Astronomy and
Space Science Institute.

13

[1] A. G. Riess, A. V. Filippenko, P. Challis, A. Clocchiatti,
A. Diercks, P. M. Garnavich, R. L. Gilliland, C. J. Hogan,
S. Jha, R. P. Kirshner, et al., AJ 116, 1009 (1998), astro-
ph/9805201.

[2] S. Perlmutter, G. Aldering, G. Goldhaber, R. A. Knop,
P. Nugent, P. G. Castro, S. Deustua, S. Fabbro, A. Goo-
bar, D. E. Groom, et al., Astrophys. J. 517, 565 (1999),
astro-ph/9812133.

[3] D. H. Weinberg, M. J. Mortonson, D. J. Eisenstein, C. Hi-
rata, A. G. Riess, and E. Rozo, Physics reports 530, 87
(2013), 1201.2434.

[4] L. Amendola, C. Quercellini, and E. Giallongo, MNRAS

357, 429 (2005), arXiv:astro-ph/0404599.

[5] K. Yamamoto, B. A. Bassett, and H. Nishioka, Phys-
ical Review Letters 94, 051301 (2005), arXiv:astro-
ph/0409207.

[6] Y. Wang, JCAP 5, 21 (2008), 0710.3885.
[7] W. J. Percival and M. White, MNRAS 393, 297 (2009),

0808.0003.

[8] Y.-S. Song and W. J. Percival, JCAP 10, 4 (2009),

0807.0810.

[9] M. White, Y.-S. Song, and W. J. Percival, MNRAS 397,

1348 (2009), 0810.1518.

[10] Y.-S. Song, Phys. Rev. D 83, 103009 (2011), 1009.2753.
[11] Y. Wang, W. Percival, A. Cimatti, P. Mukherjee,
L. Guzzo, C. M. Baugh, C. Carbone, P. Franzetti,
B. Garilli, J. E. Geach, et al., MNRAS 409, 737 (2010),
1006.3517.

[12] P. Zhang, M. Liguori, R. Bean, and S. Dodelson, Physical

Review Letters 99, 141302 (2007), 0704.1932.

[13] B. Jain and P. Zhang, Phys. Rev. D 78, 063503 (2008),

0709.2375.

M. Tegmark, Z. Zheng, et al., Astrophys. J. 633, 560
(2005), arXiv:astro-ph/0501171.

[23] C. Blake, E. A. Kazin, F. Beutler, T. M. Davis,
D. Parkinson, S. Brough, M. Colless, C. Contreras,
W. Couch, S. Croom, et al., MNRAS 418, 1707 (2011),
1108.2635.

[24] L. Anderson, E. Aubourg, S. Bailey, D. Bizyaev, M. Blan-
ton, A. S. Bolton, J. Brinkmann, J. R. Brownstein,
A. Burden, A. J. Cuesta, et al., MNRAS 427, 3435
(2012), 1203.6594.

[25] E. A. Kazin, J. Koda, C. Blake, N. Padmanab-
han, S. Brough, M. Colless, C. Contreras, W. Couch,
S. Croom, D. J. Croton, et al., MNRAS 441, 3524 (2014),
1401.0358.

[26] Y.-S. Song, T. Okumura, and A. Taruya, Phys. Rev. D

89, 103541 (2014), 1309.1162.

[27] L. Anderson,

´E. Aubourg, S. Bailey, F. Beutler,
V. Bhardwaj, M. Blanton, A. S. Bolton, J. Brinkmann,
J. R. Brownstein, A. Burden, et al., MNRAS 441, 24
(2014), 1312.4877.

[28] H. Gil-Mar´ın, W. J. Percival, A. J. Cuesta, J. R. Brown-
stein, C.-H. Chuang, S. Ho, F.-S. Kitaura, C. Maras-
ton, F. Prada, S. Rodr´ıguez-Torres, et al., ArXiv e-prints
(2015), 1509.06373.

[29] G.-B. Zhao, Y. Wang, A. J. Ross, S. Shandera, W. J.
Percival, K. S. Dawson, J.-P. Kneib, A. D. Myers, J. R.
Brownstein, J. Comparat, et al., MNRAS 457, 2377
(2016), 1510.08216.

[30] C. Alcock and B. Paczynski, Nature (London) 281, 358

(1979).

[31] J. C. Jackson, MNRAS 156, 1P (1972).
[32] W. L. W. Sargent and E. L. Turner, ApJL 212, L3

[14] E. V. Linder, Astroparticle Physics 29, 336 (2008),

(1977).

0709.1113.

[15] R. Reyes, R. Mandelbaum, U. Seljak, T. Baldauf, J. E.
Gunn, L. Lombriser, and R. E. Smith, Nature (London)
464, 256 (2010), 1003.2185.

[16] Y.-C. Cai and G. Bernstein, MNRAS 422, 1045 (2012),

1112.4478.

[17] E. Gazta˜naga, M. Eriksen, M. Crocce, F. J. Castander,
P. Fosalba, P. Marti, R. Miquel, and A. Cabr´e, MNRAS
p. 2931 (2012), 1109.4852.

[18] E. Jennings, C. M. Baugh, B. Li, G.-B. Zhao, and

K. Koyama, ArXiv e-prints (2012), 1205.2698.

[19] B. Li, W. A. Hellwing, K. Koyama, G.-B. Zhao, E. Jen-
nings, and C. M. Baugh, MNRAS 428, 743 (2013),
1206.4317.

[20] T. Okumura, C. Hikage, T. Totani, M. Tonegawa,
H. Okada, K. Glazebrook, C. Blake, P. G. Ferreira,
S. More, A. Taruya, et al., ArXiv e-prints (2015),
1511.08083.

[21] H.-J. Seo and D. J. Eisenstein, Astrophys. J. 598, 720

(2003), arXiv:astro-ph/0307460.

[22] D. J. Eisenstein, I. Zehavi, D. W. Hogg, R. Scoccimarro,
M. R. Blanton, R. C. Nichol, R. Scranton, H.-J. Seo,

[33] P. J. E. Peebles, The large-scale structure of the universe

(1980).

[34] N. Kaiser, MNRAS 227, 1 (1987).
[35] J. A. Peacock and S. J. Dodds, MNRAS 267, 1020

(1994), arXiv:astro-ph/9311057.

[36] W. E. Ballinger, J. A. Peacock, and A. F. Heavens, MN-

RAS 282, 877 (1996), arXiv:astro-ph/9605017.

[37] J. A. Peacock, S. Cole, P. Norberg, C. M. Baugh,
J. Bland-Hawthorn, T. Bridges, R. D. Cannon, M. Col-
less, C. Collins, W. Couch, et al., Nature (London) 410,
169 (2001), arXiv:astro-ph/0103143.

[38] M. Tegmark, A. J. S. Hamilton, and Y. Xu, MNRAS

335, 887 (2002), arXiv:astro-ph/0111575.

[39] M. Tegmark, M. R. Blanton, M. A. Strauss, F. Hoyle,
D. Schlegel, R. Scoccimarro, M. S. Vogeley, D. H. Wein-
berg, I. Zehavi, A. Berlind, et al., Astrophys. J. 606,
702 (2004), arXiv:astro-ph/0310725.

[40] L. Samushia, W. J. Percival, and A. Raccanelli, MNRAS

420, 2102 (2012), 1102.1014.

[41] L. Guzzo, M. Pierleoni, B. Meneux, E. Branchini, O. Le
F`evre, C. Marinoni, B. Garilli, J. Blaizot, G. De Lu-
cia, A. Pollo, et al., Nature (London) 451, 541 (2008),

14

0802.1944.

1105.4165.

[42] C. Blake, S. Brough, M. Colless, C. Contreras, W. Couch,
S. Croom, T. Davis, M. J. Drinkwater, K. Forster,
D. Gilbank, et al., MNRAS 415, 2876 (2011), 1104.2948.
[43] C. Blake, S. Brough, M. Colless, C. Contreras, W. Couch,
S. Croom, D. Croton, T. M. Davis, M. J. Drinkwater,
K. Forster, et al., MNRAS 425, 405 (2012), 1204.3674.

[44] B. A. Reid, L. Samushia, M. White, W. J. Percival,
M. Manera, N. Padmanabhan, A. J. Ross, A. G. S´anchez,
S. Bailey, D. Bizyaev, et al., ArXiv e-prints (2012),
1203.6641.

[45] R. Tojeiro, W. J. Percival, J. Brinkmann, J. R. Brown-
stein, D. Eisenstein, M. Manera, C. Maraston, C. K.
McBride, D. Duna, B. Reid, et al., ArXiv e-prints (2012),
1203.6565.

[46] B. A. Reid, H.-J. Seo, A. Leauthaud, J. L. Tinker, and

M. White, MNRAS 444, 476 (2014), 1404.3742.

[47] Y.-S. Song, C. G. Sabiu, T. Okumura, M. Oh, and E. V.

Linder, JCAP 12, 005 (2014), 1407.2257.

[48] Y.-S. Song, A. Taruya, E. Linder, K. Koyama, C. G.
Sabiu, G.-B. Zhao, F. Bernardeau, T. Nishimichi,
and T. Okumura, Phys. Rev. D 92, 043522 (2015),
1507.01592.

[49] F. Simpson, C. Blake, J. A. Peacock, I. K. Baldry,
J. Bland-Hawthorn, A. F. Heavens, C. Heymans, J. Love-
day, and P. Norberg, Phys. Rev. D 93, 023525 (2016),
1505.03865.

[50] K. B. Fisher, Astrophys. J. 448, 494 (1995), arXiv:astro-

ph/9412081.

[51] A. F. Heavens, S. Matarrese, and L. Verde, MNRAS 301,

797 (1998), arXiv:astro-ph/9808016.

[69] U. Seljak and P. McDonald, JCAP 11, 39 (2011),

1109.1888.

[70] T. Okumura, U. Seljak, P. McDonald, and V. Desjacques,

JCAP 2, 10 (2012), 1109.1609.

[71] T. Okumura, U. Seljak, and V. Desjacques, JCAP 11,

014 (2012), 1206.4070.

[72] J. Kwan, G. F. Lewis, and E. V. Linder, Astrophys. J.

748, 78 (2012), 1105.1194.

[73] P. Zhang, J. Pan, and Y. Zheng, Phys. Rev. D 87, 063526

(2013), 1207.2722.

[74] Y. Zheng, P. Zhang, Y. Jing, W. Lin, and J. Pan, Phys.

Rev. D 88, 103510 (2013), 1308.0886.

[75] T. Ishikawa, T. Totani, T. Nishimichi, R. Takahashi,
N. Yoshida, and M. Tonegawa, MNRAS 443, 3359
(2014), 1308.6087.

[76] M. White, B. Reid, C.-H. Chuang, J. L. Tinker, C. K.
McBride, F. Prada, and L. Samushia, MNRAS 447, 234
(2015), 1408.5435.

[77] E. Jennings, R. H. Wechsler, S. W. Skillman, and M. S.

Warren, MNRAS 457, 1076 (2016), 1508.01803.

[78] D. Bianchi, M. Chiesa, and L. Guzzo, MNRAS 446, 75

(2015), 1407.4753.

[79] D. Bianchi, W. Percival, and J. Bel, ArXiv e-prints

(2016), 1602.02780.

[80] E. Jennings, C. M. Baugh, and S. Pascoli, ApJL 727, L9

(2011), 1011.2842.

[81] D. Bianchi, L. Guzzo, E. Branchini, E. Majerotto, S. de
la Torre, F. Marulli, L. Moscardini, and R. E. Angulo,
MNRAS 427, 2420 (2012), 1203.1545.

[82] S. de la Torre and L. Guzzo, ArXiv e-prints (2012),

[52] M. White, MNRAS 321,

1 (2001),

arXiv:astro-

1202.5559.

ph/0005085.

[83] A. Taruya and T. Hiramatsu, Astrophys. J. 674, 617-635

[53] U. Seljak, MNRAS 325, 1359 (2001), arXiv:astro-

(2008), 0708.1367.

ph/0009016.

[84] V. Springel, MNRAS 364, 1105 (2005), arXiv:astro-

[54] X. Kang, Y. P. Jing, H. J. Mo, and G. B¨orner, MNRAS

ph/0505010.

336, 892 (2002), arXiv:astro-ph/0201124.

[55] J. L. Tinker, D. H. Weinberg, and Z. Zheng, MNRAS

368, 85 (2006), arXiv:astro-ph/0501029.

[56] J. L. Tinker, MNRAS 374, 477 (2007), arXiv:astro-

ph/0604217.

[57] R. Scoccimarro, Phys. Rev. D 70, 083007 (2004),

arXiv:astro-ph/0407214.

[85] M. Levi, C. Bebek, T. Beers, R. Blum, R. Cahn, D. Eisen-
stein, B. Flaugher, K. Honscheid, R. Kron, O. Lahav,
et al., ArXiv e-prints (2013), 1308.0847.

[86] Planck Collaboration, P. A. R. Ade, N. Aghanim, M. Ar-
naud, M. Ashdown, J. Aumont, C. Baccigalupi, A. J.
Banday, R. B. Barreiro, J. G. Bartlett, et al., ArXiv e-
prints (2015), 1502.01589.

[58] T. Matsubara, Phys. Rev. D 77, 063530 (2008),

[87] M. Crocce, S. Pueblas, and R. Scoccimarro, MNRAS

0711.2521.

373, 369 (2006), astro-ph/0606505.

[59] T. Matsubara, Phys. Rev. D 78, 083519 (2008),

[88] A. Taruya, F. Bernardeau, T. Nishimichi, and S. Codis,

0807.1733.

Phys. Rev. D 86, 103528 (2012), 1208.1191.

[60] V. Desjacques and R. K. Sheth, Phys. Rev. D 81, 023526

[89] Y. P. Jing, Astrophys. J. 620, 559 (2005), arXiv:astro-

(2010), 0909.4544.

ph/0409240.

[61] A. Taruya, T. Nishimichi, and S. Saito, Phys. Rev. D

[90] P. Zhang, Y. Zheng, and Y. Jing, Phys. Rev. D 91,

82, 063522 (2010), 1006.0699.

043522 (2015), 1405.7125.

[62] A. Taruya, T. Nishimichi, and F. Bernardeau, Phys. Rev.

[91] Y. Zheng, P. Zhang, and Y. Jing, Phys. Rev. D 91,

D 87, 083509 (2013), 1301.3624.

043523 (2015), 1409.6809.

[63] T. Matsubara, Phys. Rev. D 83, 083518 (2011),

1102.4619.

[64] T. Okumura and Y. P. Jing, Astrophys. J. 726, 5 (2011),

1004.3548.

[65] T. Okamura, A. Taruya, and T. Matsubara, JCAP 8, 12

(2011), 1105.1491.

[66] M. Sato and T. Matsubara, Phys. Rev. D 84, 043501

(2011), 1105.5007.

[67] E. Jennings, C. M. Baugh, and S. Pascoli, MNRAS 410,

2081 (2011), 1003.4282.

[68] B. A. Reid and M. White, MNRAS 417, 1913 (2011),

[92] Main uncertainty comes from the volume-weighted ve-
locity ﬁeld estimation. We make convergence tests by
comparing the velocity power spectrum measured from
a fraction of randomly selected particles with that of all
the particles. This gives good estimation of the system-
atic error of our sampled velocity ﬁeld. For more details,
please refer to [91] and the Appendix of [74].

