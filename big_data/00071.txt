6
1
0
2

 
r
p
A
1

 

 
 
]

.

G
A
h
t
a
m

[
 
 

2
v
1
7
0
0
0

.

3
0
6
1
:
v
i
X
r
a

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

MARIA DONTEN-BURY AND SIMON KEICHER

Abstract. Let G ⊆ GL(n) be a ﬁnite group without pseudo-reﬂections. We
present an algorithm to compute and verify a candidate for the Cox ring of a
resolution X → Cn/G, which is based just on the geometry of the singularity
Cn/G, without further knowledge of its resolutions. We explain the use of
our implementation of the algorithms in Singular. As an application, we
determine the Cox rings of resolutions X → C3/G for all G ⊆ GL(3) with the
aforementioned property and of order |G| ≤ 12. We also provide examples in
dimension 4.

1. Introduction

We consider quotient spaces Cn/G = Spec C[x1, . . . , xn]G, where G is a ﬁnite
group acting linearly on Cn. By Noether’s theorem the ring of invariants of G is
ﬁnitely generated, hence such quotients are (complex) algebraic varieties. They are
usually singular and in such a case are called quotient singularities. In their con-
struction, geometry meets ﬁnite group theory and there have been many attempts
of extending this relation to resolutions of Cn/G. An example, probably the most
important one, of describing the geometric structure of crepant (which in this case
means that the canonical divisor is linearly trivial) resolutions of Cn/G in terms of
algebraic properties of the group G is the McKay correspondence; for an introduc-
tion see, e.g., [21]. Though proved in several cases (see section 3.2), in general it
reveals how much there is still to learn about this class of singularities and their
resolutions.

In this paper, we study quotient singularities X0 := Cn/G and their resolutions

in terms of the Cox ring

R (X0) = MCl(X)

Γ (X0, O(D)) ,

see [1] for details on the construction. Cox rings have already been successfully used
by various authors to study resolutions of quotient singularities, in particular for
symplectic quotients in [9, 7], described by a generating set in a simpler ring, and
via an algorithmic approach based on toric ambient modiﬁcations in [12]. In this
article we generalize the methods used in [12]. While ﬁnishing a draft of this paper,
we also found out about Yamagishi’s work [25], which extends [9, 7]. However, our
approach is diﬀerent from [25] and our methods are not restricted to the class of
crepant resolutions. In particular, as explained below, we do not try to construct
the generators of the Cox ring directly from the group structure data, but we obtain
it via toric ambient modiﬁcations, chosen in an intermediate step based on tropical
geometry.

Our ﬁrst contribution, presented in Section 2.1, is an an algorithm to compute
and verify a candidate for the Cox ring of a resolution X → X0 without requiring

2010 Mathematics Subject Classiﬁcation. 14E15, 14Q10, 14Q15, 14C20, 14L24.
This work was completed while the ﬁrst author held a Dahlem Research School Postdoctoral
Fellowship at Freie Universit¨at Berlin. The ﬁrst author was partially supported by a Polish
National Science Center project 2013/11/D/ST1/02580 and the second author was supported
by Proyecto FONDECYT Postdoctorado N. 3160016.

1

2

M. DONTEN-BURY AND S. KEICHER

further knowledge of X0. More precisely, Algorithm 2.3 computes R(X0) and Algo-
rithm 2.8 then computes a candidate for the Cox ring of a resolution X → X0 and
veriﬁes the result. Here, the main tool are toric ambient modiﬁcations as in [11, 13]:
we embed X0 into an aﬃne toric variety Z0 and compute a resolution Z → Z0. The
proper transform X → X0 then is the desired candidate for a resolution which we
can verify algorithmically. Note that the choice of the toric resolution involves a
tropical step; this is in the spirit of Tevelev and Teissier [22, 23]. Algorithm 2.8 is a
variant of the algorithm [19] given for Mori dream spaces, which, in turn, is based
on [1, 15] where the algorithm has been shown to work in the setting of complete
rational complexity one T -varieties. See also [14] for the case of aﬃne C∗-surfaces.
Our algorithms are implemented in a library for the Open Source computer algebra
system Singular [6]; we explain its use in Section 2.2 by examples.

Our second contribution concerns resolutions of three-dimensional quotient sin-
gularities; it is presented in Section 3. We ﬁrst classify in Proposition 3.2 the ﬁnite,
non-abelian groups G ⊆ GL(3) with |G| ≤ 12 and without pseudo-reﬂections (see
Remark 2.2). When G is abelian, the quotient singularity is toric; since the algo-
rithm of constructing a (toric) resolution and the structure of the Cox ring is known
in this case, we do not consider it. Using our algorithms from Section 2.1, we ﬁrst
present the Cox rings of all singularities C3/G on the list, see Proposition 3.3 and
then their resolutions, see Theorem 3.5. Then we discuss certain properties of the
obtained resolutions in order to understand what can be expected from the output
of the algorithm in general. In particular, we check whether the resolutions for sub-
groups of SL(3) on the list are crepant. In Subsection 3.3, we then give a modiﬁed
algorithm to produce smaller resolutions. We apply it to obtain two more crepant
resolutions.

Finally, in Section 4, we apply our methods to two four dimensional examples.
Note that in dimension 4 less is known about resolutions of quotient singularities,
hence computational experiments are even more valuable than in dimension 3. We
provide the Cox rings of X0 = C4/G for chosen representations of G = S3 and
G = D8 and compute the Cox rings of modiﬁcations X → X0. We are able to
retrieve crepant resolutions that were also found in [7], see Proposition 4.3 and 4.4.
Acknowledgements: We would like to thank J¨urgen Hausen for several helpful
discussions. We further thank Yue Ren and Christof S¨oger respectively for answer-
ing question about Singular and Normaliz.

2. Algorithms and Implementation

2.1. Algorithms. In this section, we describe algorithms to compute the Cox ring
of a quotient singularity X0 := Cn/G for a ﬁnite group G and the Cox ring of
a resolution X → X0. The latter algorithm is a variant of [1, Theorem III.4.4.9]
and [19, Algorithm 2.4.8]. It produces candidates using a tropical step and veriﬁes
them. We work with representations of G, usually assuming that they are faithful.
In this case we will often identify the representation with its image in GL(n), i.e.,
consider G as a matrix group.

Deﬁnition 2.1. A matrix group G ⊆ GL(n) is small if it does not have pseudo-
reﬂections; these are A ∈ G ⊆ GL(n) of ﬁnite order such that the subspace of ﬁxed
points (Cn)A is a hyperplane. We also say that a representation of an abstract
group G is small, if its image in GL(n) is small.

Remark 2.2. Note that the assumption on the representation of G not having
pseudo-reﬂections is not restrictive: let H ⊆ G be the normal subgroup generated
by all pseudo-reﬂections. Then

Cn/G ∼= (Cn/H)(cid:14)(G/H) ∼= Cn(cid:14)(G/H)

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

3

since Cn/H is smooth by the Chevalley-Shephard-Todd theorem. In particular, the
singularity for G is the same as the one for the smaller group G/H.

The degree map of the Cox ring R(X0) is a homomorphism Zs → Cl(X0) that
sends the i-th canonical basis vector ei ∈ Zs to deg(Ti). We call the matrix with
columns deg(T1), . . . , deg(Ts) the degree matrix.

Algorithm 2.3 (Cox ring of X0). Input: a small group G ⊆ GL(n).

• Compute generators f1, . . . , fs for the invariant ring C[S1, . . . , Sn][G,G].
• Then G′ := G/[G, G] acts on the C-vector space V := linC(f1, . . . , fs).
Compute matrices Mi such that, as a group, G′ = hM1, . . . , Mki ⊆ GL(s).
• Compute a basis g1, . . . , gs ∈ V of eigenvectors for V with respect to all

the Mi.

• In C[S1, . . . , Sn, T1, . . . , Ts], consider the ideal J := hTi − gi; 1 ≤ i ≤ si.
Compute the elimination ideal J ′ := J ∩ C[T1, . . . , Ts] and the saturation
I0 := J ′ : (T1 · · · Ts)∞.

• Deﬁne the matrix Q0 with the i-th column (χi1, . . . , χik) where χij is the

eigenvalue of gi with respect to Mj.

Output:
R(Cn/G) in terms of generators and relations and Q0 is the degree matrix.

I0 ⊆ C[T1, . . . , Ts] and Q0. Then C[T1, . . . , Ts]/I0 is a presentation of

Proof. This proof is a generalization of the one given in [12, Proposition 3.1]: By a
result by Arzhantsev and Ga˘ıfullin [2], the Cox ring R(Cn/G) is isomorphic to the
invariant ring C[S1, . . . , Sn][G,G]. Then the gi are X(G′)-homogeneous prime gener-
ators for the invariant ring. The desired presentation C[T1, . . . , Ts]/I0 is obtained
by considering

C[T1, . . . , Ts] → C[S1, . . . , Sn][G,G],

Ti 7→ gi

and computing the ideal I0 of relations among the generators, e.g., by computing
the listed elimination ideal.
(cid:3)

Example 2.4. We consider the faithful representation of the quaternion group
G := Q8 with 8 elements whose image G ⊆ GL(2) is generated by

0 −i(cid:1),
(cid:0) i 0

(cid:0) 0 −i
−i 0 (cid:1),

where i ∈ C denotes the imaginary unit. There are no pseudo-reﬂections since
no matrix in G has 1 as eigenvalue. We now apply the steps of Algorithm 2.3.
Generators for the invariant ring C[S1, S2][G,G], where [G, G] = h−idi, are

f1 = S1S2,

f2 = S2
1 ,

f3 = S2
2 .

Moreover, the group G′ = G/[G, G] is isomorphic to (Z/2Z)2 and acts on the linear
hull V := linC(f1, f2, f3); we work with the description

G′ ∼= (cid:28)(cid:20) 1

0
0 −1
0

0

0 −1 (cid:21) ,(cid:20) −1

0

0

0

1

0

0 (cid:21)(cid:29) ⊆ GL(3).

1

0

0

The vector space V then has the G′-invariant subspaces linC(f1) and linC(f2, f3).
We have a basis (g1, g2, g3) for V consisting of the eigenvectors

g1 := f1,

g2 := f2 + f3,

g3 := −f2 + f3 ∈ V

where the weights wi := (χi1, χi2) ∈ (Z/2Z)2 ∼= G′ are w1 = (0, 1), w2 = (1, 0) and
w3 = (1, 1). The degree map is

Q0 : Z3 → (Z/2Z)2,

ei 7→(cid:20) 0

1

1
0

1

1 (cid:21) · ei

4

M. DONTEN-BURY AND S. KEICHER

In the ring C[S1, S2, T1, T2, T3], we consider the ideal J := hT1 − g1, . . . , T3 − g3i
and compute its elimination ideal J ′ := J ∩ C[T1, T2, T3] as well as the saturation
I0 := J ′ : (T1T2T3)∞. We arrive at the G′-graded Cox ring with degree matrix Q0:

R(C2/G) ∼= C[T1, T2, T3]/I0,

I0 = h4T 2

1 − T 2

2 + T 2

3 i.

We recall some theory for the resolution algorithm and ﬁx the setting. Assume we
know a presentation R(X0) = C[T1, . . . , Ts]/I0 and its degree matrix Q0. Consider
the aﬃne variety X 0 := Spec(R(X0)) ⊆ Cs. We ﬁx a Gale dual matrix P0 for Q0,
i.e., a matrix ﬁtting into the dual exact sequences

(1)

0

0

/ L

Cl(X0)

Q0

/ Zs

Zs

P0

P ∗
0

/ N

ker(Q0)

0

where P ∗
shortly recall the construction of the tropical variety Trop(X0).

0 denotes the transpose of P0; see, e.g., [19] for its computation. Let us

Construction 2.5. Let the setting be as above. Setting T := C∗, we obtain the
tropical varieties

Yei∈γ0

fi /∈ phfi; ei /∈ γ0i

and Q(γ0) ∈ Φ holds. Write rlv(X) for the set of relevant F-faces. Then one deﬁnes
the canonical ambient toric variety as the toric variety Z ⊇ X whose fan Σ has the
maximal cones

Σmax = {P (γ∗

0 ); γ0 ∈ rlv(X) minimal}

where γ∗
disjoint decomposition

0 (cid:22) (Qr

≥0)∨ denotes the dual face. Further note that we have a pairwise

X = [γ0∈rlv(X)

X(γ0),

X(γ0) := p(cid:0){z ∈ X; zi 6= 0 ⇔ ei ∈ γ0}(cid:1) ,

By the decomposition from Construction 2.6, we can test smoothness of X by
testing each X(γ0) with the following straight-forward test; it was also used in [12].
Write T := C∗.

Trop(cid:0)X 0 ∩ Ts(cid:1) := \f ∈I0
Trop(X0) := P0(cid:0)Trop(cid:0)X 0 ∩ Ts(cid:1)(cid:1) ⊆ N ⊗Z Q

Trop(f ) ⊆ Qs,

where Trop(f ) ⊆ Qs is the support of the codimension-one skeleton of the normal
fan over the Newton polytope of the polynomial f ∈ C[T1, . . . , Ts]. It is possible to
establish a fan structure on Trop(X0), see, e.g., [4, 20].

Construction 2.6. See [1, Section III] and [11]. Let X be a normal, irreducible A2-
maximal variety with Γ(X, O∗) = C∗ such that both K := Cl(X) and R := R(X)
are ﬁnitely generated. Fix a system of pairwise non-associated, K-prime generators
F := (f1, . . . , fm) for R, the degree matrix Q and a Gale dual matrix P . Then X is
the good quotient p of an open subset

bX ⊆ X := Spec(R) ⊆ Cr

by the action of the characteristic quasitorus Spec(C[K]), and bX can be described

combinatorially by a set Φ of pairwise overlapping polyhedral cones in K ⊗Z Q.
The triple (R, F, Φ) already determines X up to isomorphism. Moreover, a face
γ0 (cid:22) Qr

≥0 is a relevant F-face if

/
/
/
o
o
o
o
o
o
o
o
COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

5

Algorithm 2.7 (Smoothness test). Input:
the Cox ring R = C[T1, . . . , Tr]/I
with degree matrix Q, of a normal, irreducible A2-maximal variety X, a relevant
F-face γ0 (cid:22) Qr

≥0. Let P be a Gale dual (n × r) matrix for Q.

• If σ := P (γ∗
• Find A ∈ GL(n, Z) such that Avij = ej holds for all rays Q≥0 · vij of σ, vij

0 ) is not smooth, return false.

primitive.

• Let Iγ0 ⊆ C[T1, . . . , Tr] be the ideal obtained from I by setting Ti = 0 ⇔

ei /∈ γ0.

• With the toric morphisms α : Tn → Tn and p : Tr → Tn corresponding
to A and P , compute the pushforward and pullback Jγ0 := α∗p∗Iγ0 ⊆
C[Y1, . . . , Yn].

• Let jγ0 ⊆ C[Y1, . . . , Yn] be the jacobian ideal, i.e., the ideal generated by

all (n − dim(Jγ0) × (n − dim(Jγ0)) minors of the Jacobian of Jγ0.

• Return true if 1 ∈ (Jγ0 + jγ0) : (Ym+1 · · · Yn)∞ holds in C[Y1, . . . , Yn].

Return false otherwise.

Output: true if X(γ0) is smooth, false otherwise.
Proof. The ﬁrst steps produce equations for X(γ0) in O(Cm × Tn−m) ∼= C[σ∨ ∩
Zn]. The second to last step computes the ideal of the singular locus V (Jγ0)sing of
V (Jγ0 ) ⊆ Cn. The last step checks whether V (Jγ0 )sing ∩ Cm × Tn−m is empty. (cid:3)

The following algorithm computes a candidate for the Cox ring R(X) of a resolu-
tion X → X0 and veriﬁes it; it is close to [19, Algorithm 2.4.8] which in turn is based
on [1, Theorem III.4.4.9] where the complete, complexity-one-case is treated. See
also [15, Chapter 3] and consider [14, Section 3] for the case of aﬃne C∗-surfaces.
The idea is to embed X0 ⊆ Z0 into its ambient aﬃne toric variety Z0 = Cn/G′,
perform a toric resolution Z → Z0 and consider the proper transform X → X0.
The step Z → Z0 involves the tropical variety.

Algorithm 2.8 (Cox ring of a resolution X → X0 = Cn/G). Input: a ﬁnite small
group G ⊆ GL(n).

• Compute the Cox ring R(X0) = C[T1, . . . , Ts]/I0 of X0 with Algorithm 2.3.

Determine Q0 and P0 as in (1).
≥0) ⊆ Qn.

• Compute σ := P0(Qn

It determines the ambient aﬃne toric

variety Z0 = Cn/G′ where G′ := G/[G, G].
• Compute a fan Υ with support Trop(X0).
• Form the fan Σ := {σ} ∩ Υ by cone-wise intersection.
• Resolve the toric singularities by stellar subdivisions of Σ at primitive

vectors v1, . . . , vm.

• Write π : Z → Z0 for the toric resolution. Compute a Gale dual Q out of

the enlarged matrix P := [P0, v1, . . . , vm] as in (1).

• Compute the Cox ring of the proper transform X → X0 under π using [13,

Algorithm 3.6] with the ’verify’-option:

– Compute the ideal I ′ := p∗(p0)∗I0 ⊆ C[T1, . . . , Tr], i.e., the pullback
of the pushforward under the toric maps p, p0 corresponding to P , P0.

– Compute the saturation I := I ′ : (T1 · · · Tr)∞.
– Verify that all Ti deﬁne prime elements in R := C[T1, . . . , Tr]/I.
– Verify that dim(I) − dim(hTi, Tji + I) ≥ 2 for all i 6= j.

• Verify smoothness of the variety X determined by (R, Σ):

– For each τ ∈ Σmax, do:

∗ determine γ0 (cid:22) Qr
∗ Verify that X(γ0) is smooth with Algorithm 2.7.

≥0 with P (γ∗

0 ) = τ .

Output: R and Q. If the veriﬁcations of the last two steps were successful, then R
is the Cox ring of X of a resolution X → X0 and Q is the degree matrix of R.

6

M. DONTEN-BURY AND S. KEICHER

Lemma 2.9. In Algorithm 2.8, suppose R is the Cox ring of X. With the fan Σ,
the relevant (T 1, . . . , T r)-faces are

rlv(X) = {γ0 (cid:22) Qr

≥0; P (γ∗

0 ) ∈ Σ}.

Proof. By a result of Tevelev [22, Lemma 2.2] and the deﬁnition of the tropical
variety Trop(X), we obtain

γ0 (cid:22) Qr

≥0 relevant (T 1, . . . , T r)-face

⇔

P (γ∗

0 )◦ ∩ Trop(X) 6= ∅
and P (γ∗

0 ) ∈ Σ.

As the support of Σ equals Trop(X), the ﬁrst condition on the right-hand-side can
be dropped.
(cid:3)

Lemma 2.10. In the setting of Algorithm 2.8, if Spec(R) ∩ Tr is smooth and all
variables T1, . . . , Tr are prime, then R is normal.

Proof. Write X i for the localization of X := Spec(R) at the product T1 · · · Ti. By

assumption, bX := Spec(R) ∩ Tr is smooth and therefore also X r is smooth and

in particular normal. Since Tr is prime, this implies normality of X r−1, see [1,
Lemma IV.1.2.7]. Iterating this argument, X 0 = Spec(R) is normal.
(cid:3)

Proof of Algorithm 2.8. By construction and [13, Algorithm 3.6], X → X0 is a
modiﬁcation and R the Cox ring of X. Note that [13, Algorithm 3.6] directly
translates to the aﬃne setting and the required normality test of R is provided
by Lemma 2.10 since Qr
≥0) = p(Spec(R) ∩ Tr) is smooth
by veriﬁcation. Again by the smoothness veriﬁcation step and Lemma 2.9, X is
smooth.
(cid:3)

≥0 ∈ rlv(X) and X(Qr

Remark 2.11. If the smoothness test in Algorithm 2.8 is left out, R is still the
Cox ring of a modiﬁcation of X0 provided R is normal.

Example 2.12. Consider the Cox ring R(X0) = C[T1, T2, T3]/I0 computed in
Example 2.4 with its degree-map Q : Z3 → (Z/2Z)2. We apply the steps of Algo-
rithm 2.8 to X0. The canonical ambient toric variety is the aﬃne toric variety Z0 =
Z0(σ) with σ ⊆ Q3 being the polyhedral cone spanned by (1, 0, 0), (1, 2, 0), (1, 0, 2).
The following picture shows the steps for the toric resolution.

(1, 2, 0)

(1, 2, 0)

(0, 0, 0)

(1, 0, 0)

(0, 0, 0)

(1, 0, 2)

σ (gray) and Σ (blue)

v1

v3

v4

v2

(1, 0, 0)
(1, 0, 2)

Σ and new rays
Q≥0 · vi (red)

The two-dimensional fan Σ = {σ}∩Trop(X0) has already the additional ray Q≥0 ·v1
where v1 := (3, 2, 2). The fan can be resolved by insertion of the further rays through

v2 := (2, 1, 2),

v3 := (2, 2, 1),

v4 := (2, 1, 1).

This yields a toric resolution Z → Z0 which then induces a resolution X → X0 as
the proper transform of Z → Z0; its Z4-graded Cox ring R(X) and degree matrix
are

R(X) = C[T1, . . . , T7]/h4T 2

2 + T 2

3 T5i,

" −1 −1 −1

0 −1
0
0 −1
0
0 −1 −1

1 T7 − T6T 2

1 −1 # .

0
0
1 −1
1 −1 −1
1

1
0
1 −1
1

0

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

7

One veriﬁes that X is smooth. As X is a surface, we can verify minimality of the

−1, −1, −1, −2, −2, −2, −2.

resolution by inspecting the self intersection numbers of the V (bX; Ti): they are

We will use Algorithms 2.3 and 2.8 in Section 3 to compute resolutions of quotient
singularities. The next section explains an implementation of the algorithms of this
section.

2.2. Implementation. We have implemented Algorithms 2.3 and 2.8 in the library
quotsingcox.lib for the Open Source computer algebra system Singular [6]. It
will be made available at [8]. We currently make use of the interface to Normaliz [5].
We shortly explain its use in the following two examples.

Example 2.13 (Algorithm 2.3). We recompute Example 2.4 using the library
quotsingcox.lib [8].
In Singular, we ﬁrst load the built-in library for convex
geometry (implemented by Y. Ren) and our library with

> LIB "gfanlib.so";

> LIB "quotsingcox.lib";

Next, we enter generators for G ⊆ GL(2). We ﬁrst have to deﬁne a ring where not
only the generators of G are deﬁned but also all eigenvalues; Q(i) will work here:

> ring R = (0,CplxUnit),T(1..2),dp; minpoly = CplxUnitˆ2 + 1;

> matrix M0[2][2] =

> CplxUnit,0,

> 0,-CplxUnit;

> matrix M1[2][2] =

> 0,-CplxUnit,

> -CplxUnit,0;

> list G = M0, M1; // the group G

Next, we have to enter generators for the derived subgroup. For integer entries,
you can also use the command list GG = gapDerivedSubgroup(G); which writes
a ﬁle and applies GAP [10].

> matrix M2[2][2] =

> -1,0,

> 0,-1;

> list GG = M2; // derived subgroup of G

We can then compute the Cox ring R(X0) and investigate it using the following
commands:

> def R0 = coxquot(G, GG); setring R0; R0;

// characteristic :

0

// 1 parameter :

CplxUnit

// minpoly :

(CplxUnitˆ2+1)

// number of vars :

3

// block 1 :

ordering dp

// :

names T(1) T(2) T(3)

// block 2 :

ordering C

> ideal I0 = Inew; I0; // Cox ring of X0 is R0/I0

I0[1]=T(1)ˆ2-T(2)ˆ2-4*T(3)ˆ2

Generators for Cl(X0) as a matrix subgroup Gnew of GL(3) and the degrees deg(Ti) ∈
Cl(X0) of the generators of R(X0) can be displayed as follows:

> print(Gnew[1]); // the two generators for Gnew

-1,0, 0,

0, -1,0,

8

M. DONTEN-BURY AND S. KEICHER

0, 0, 1

> print(Gnew[2]);

0, -1,0,

-1,0, 0,

0, 0, -1

> Wnew; // degrees of the generators (eigenvalues)

[1]:

[1,1]=-1

[2,1]=-1

[2]:

[1,1]=-1

[2,1]=1

[3]:

[1,1]=1

[2,1]=-1

Example 2.14 (Algorithm 2.8). Building on Example 2.13, we recompute Exam-
ple 2.12. The next step has to be prepared manually: one has to give the isomor-

phism type of Gnew as a productQ Z/niZ. Here, gapStructureDescription(Gnew);

can be used to see that n1 = n2 = 2. We store the integers ni, translate the degrees
given in Wnew into the columns of a matrix Q0 and compute a Gale dual matrix P0
for Q0:

> list ClX0 = 2, 2; // ZZ/2ZZ x ZZ/2ZZ

> intmat Q0[2][3] = // degree matrix

> 1, 1, 0,

> 1, 0, 1;

> intmat P0 = finiteGaleDual(Q0, ClX0); P0;

1,1,1

1,2,0

0,0,2

We can then compute, verify and print a candidate for the Cox ring of a resolution
X → X0 using Algorithm 2.8 with the following commands. We present the Cox
ring as C[T1, . . . , Ts]/I0; the algorithm returns the ideal I0.

> def R = resolveQuotSing(I0, P0, 1); setring R; R; // 1 means verify

1st part of Verification successful:

please check primality of the variables (e.g.

with

primeVars).

// characteristic :

0

// 1 parameter :

CplxUnit

// minpoly :

(CplxUnitˆ2+1)

// number of vars :

7

// block 1 :

ordering dp

// :

names T(1) T(2) T(3) T(4) T(5) T(6) T(7)

// block 2 :

ordering C

> Inew; // Cox ring of X is R/Inew

Inew[1]=T(1)ˆ2*T(5)-T(2)ˆ2*T(6)-4*T(3)ˆ2*T(7)

One can check the primality of the variables Ti using the command primeVars(Inew);.
The Z4-grading is stored in the new degree matrix Q; it is obtained as a Gale dual
matrix to the new matrix P :

> intmat P = L[2]; P;

1,1,1,3,2,2,2,

0,2,0,2,1,2,1,

0,0,2,2,1,1,2

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

9

> intmat Q = gale(P); Q;

-1,-1,-1,1,0,0,0,

-2,-1,-1,0,2,0,0,

3,0,1,0,-4,2,0,

2,0,0,0,-3,1,1

3. Resolutions of 3-dimensional quotient singularities

3.1. Cox rings. In this section, we compute Cox rings of resolutions of quotient
singularities C3/G where G is a group of order at most 12 and discuss the results.
As explained in Remark 2.2, we will consider only faithful representations of G
without pseudo-reﬂections.

Notation 3.1. In the following, we denote by S3 the permutation group of three
elements, by D2n the dihedral group of 2n elements, by Q8 the quaternion group
and by A4 the alternating group of four elements. Moreover, we write BD3 for the
binary dihedral group, i.e., the abstract group with 12 elements

BD3 = (cid:10)a, x; a6 = 1, x2 = a3, x−1ax = a−1(cid:11) .

Proposition 3.2. Up to conjugacy in GL(3), the 3-dimensional faithful small rep-
resentations of non-abelian groups up to order 12 are as follows.

No.

G

gen.s in GL(3)

0

0

1

2

3

4

5

6

7

8

9

1

1

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

1

0

1

0

0

0

0

0

0

1

S3

Q8

Q8

D8

1 −1
0
0

0
0 −i
0
0

0
0 −i
0

(cid:20) 0 −1
(cid:20) 0 −1
(cid:20) i
(cid:20) i
(cid:20) ζ5
(cid:20) −ζ3
(cid:20) 0
BD3 (cid:20) −ζ2
BD3 (cid:20) −ζ2

D10

D12

A4

1

0

0

0

1

0

0

0
0 −1
0

1 (cid:21) , (cid:20) −1
1 (cid:21) , (cid:20) 1
1 (cid:21) , (cid:20) 0 −1
0 −1 (cid:21) , (cid:20) 0 −1
1 (cid:21) , (cid:20) 0
1 (cid:21) , (cid:20) 0
0 (cid:21) , (cid:20) −1

0 −1 (cid:21) .
0 −1 (cid:21) .
1 (cid:21).
1 (cid:21).
0 −1 (cid:21).
0 −1 (cid:21) .
1 (cid:21) .
1 (cid:21) , (cid:20) 0 −i
1 (cid:21) .
0 −1 (cid:21) , (cid:20) 0 −i
i (cid:21).

0 −1
0
0

−i
0

−i
0

0

0

0

0

1

0

0

0

0

0

0

0

0

0

0

0

0

0
0 −ζ3
0
0

3
0 −ζ3
0
0

3
0 −ζ3
0

0
ζ4
5
0

0

0

1

0

0

0

1

0

1

0

0

0

0

0

1

0

0

0

10

M. DONTEN-BURY AND S. KEICHER

10

BD3 (cid:20) −ζ2

0

3
0 −ζ3
0
0

0

1 (cid:21) , (cid:20) 0 −i

0 −1 (cid:21).

−i
0

0

0

0

0

In the table, i ∈ C denotes the imaginary unit, and ζk ∈ C is a primitive k-th

root of unity. All listed representations are reducible except for the A4-case.

Proof. To classify these representations we use the library of groups of small order,
which is a part of GAP [10]. We do the following steps:

(i) view the character tables to get dimensions of irreducible representations,
(ii) ﬁnd all irreducible representations: for a group of small order and a given
character one can either locate a representation in the literature or con-
struct easily,

(iii) combine irreducible representations to get all faithful 3-dimensional rep-
resentations of a given group (in particular, direct sums of 1-dimensional
representations are not allowed since they are not faithful representations
– the image is an abelian group),

(iv) eliminate representations with pseudo-reﬂections (see Remark 2.2),
(v) check whether obtained representations have diﬀerent groups as images (if
representations diﬀer just by a permutation of conjugacy classes in G, they
give the same quotient); for any two representations of the same group on
the list above the set of matrix traces are diﬀerent, hence this condition is
satisﬁed.
(cid:3)

Proposition 3.3. In the setting of Proposition 3.2, the Cox rings of X0 := C3/G
are as listed the following table.

No.

G

Cl(X0)

degree matrix

R(X0)

1

2

3

4

S3

D8

Q8

Q8

5

D10

6

D12

7

A4

1

1

Z/2Z

(cid:2) 1
Z/2Z × Z/2Z h 1
Z/2Z × Z/2Z h 1
Z/2Z × Z/2Z h 1
(cid:2) 1
Z/2Z × Z/2Z h 1
(cid:2) 0

Z/2Z

Z/3Z

1

1

1

0

1

0

1

0

1

0

0

1

0

1

1

0

1

0

1

0

0

1

0

2

0

0

0

0 (cid:3)
0 i
0 i
1 i
0 (cid:3)
0 i
1 (cid:3)

0

C[T1, . . . , T4]/I with I gen. by

4T 3

3 − T 2

2 − 27T 2

4

C[T1, . . . , T4]/I with I gen. by

4T 2

1 + T 2

2 − T 2

4

C[T1, . . . , T4]/I with I gen. by

T 2

1 − T 2

2 + 4T 2

3

C[T1, . . . , T4]/I with I gen. by

T 2

1 − T 2

3 + 4T 2

4

C[T1, . . . , T4]/I with I gen. by

4T 5

3 + T 2

2 − T 2

4

C[T1, . . . , T4]/I with I gen. by

4T 3

4 + T 2

1 − T 2

2

C[T1, . . . , T4]/I with I gen. by
T 3
1 + T 3

3 − 3T1T3T4 + T 3

4 − 27T 2

2

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

11

8

BD3

Z/4Z

9

BD3

Z/4Z

10 BD3

Z/4Z

1

2

1

1

1

2

(cid:2) 3
(cid:2) 3
(cid:2) 3

0 (cid:3)
2 (cid:3)
2 (cid:3)

C[T1, . . . , T4]/I with I gen. by

4T 3

3 + T 2

1 − T 2

2

C[T1, . . . , T4]/I with I gen. by

4T 3

4 + T 2

1 − T 2

3

C[T1, . . . , T4]/I with I gen. by

4T 3

4 + T 2

1 − T 2

2

Proof. The listed Cox rings are obtained by applying Algorithm 2.3 to the list of
representations from Proposition 3.2 using our implementation 2.2.
(cid:3)

Remark 3.4. Note that several rings on the list (without grading considered) are
isomorphic. This is because the ring structure of the Cox ring of Cn/G is just the
invariant ring C[x1, . . . , xn][G,G] and derived subgroups in cases 2, 3, 4 (D8 and Q8
representations) and also 6, 8, 9, 10 (D12 and BD3 representations) are conjugate
subgroups of GL(3).

Theorem 3.5. In the setting of Proposition 3.3, a resolution X → X0 of the
quotient X0 = C3/G has the following Cox ring, respectively.

No. G Cl(X)

degree matrix

R(X)

1

S3

Z4

2 D8

Z4

3 Q8

Z4

4 Q8

Z4

5 D10

Z5

6 D12

Z5

0

1

2

0

2 0

0

2

1

1

1

2

0 0

0 0

0 0

0 0 0

0 0 0

0 −1

−1 −1

0 −1 1
0 0

0 −2 0
0

−2 −1 −1 0 0

−1
−1 −1
0

2 0 0
0 −1 −1 0 −2 1 0

2 0 0
0 −1 0 0 −2 2 0
0

" 0 −3 −2 −3 1
" −1 −1
" −1 −1 −1 0 1
" −1



0 −1 −2 0 −3 0 1#
1 0 −1 −1 1#
0 0 0 −3 1 1#
0 0 −3 1 1#



2 0 0 0
0 −1 −1 0 −2 1 0 0
0 −1 −2 0 −4 0 1 0
0 −1 −3 0 −5 0 0 1

2 0 0 0

0 0 0 0

0 −2
0
0
0 −1
0 1 0 0
1 −1 −1 0 1 0
1 −2
0 0 0 1

2 0 0
0 −1 0 −2 2 0
0

0 −1 −1 1
−2 −1 −1 −1 0

0 −5 −2 −5 1
0 0

−3 −3
−1
1

0 −1
1
0

−1 −1

0 0 0 0

0 0 0

2

2

1

2

0

1

2

2

1

2

0

0

0

1

C[T1, . . . , T8]/I with I gen. by

4T 3

3 T7 − T 2

2 T6 − 27T 2

4 T8

C[T1, . . . , T8]/I with I gen. by

−4T 2

1 T6 + T 2

4 T7 − T 2

2 T8

C[T1, . . . , T8]/I with I gen. by

T 2

1 T6 + 4T 2

3 T7 − T 2

2 T8

C[T1, . . . , T8]/I with I gen. by

−T 2

1 T6 − 4T 2

4 T7 + T 2

3 T8

C[T1, . . . , T9]/I with I gen. by

4T 5

3 T 3

7 T8 + T 2

2 T6 − T 2

4 T9

C[T1, . . . , T9]/I with I gen. by

4T 3

4 T 2

7 T9 + T 2

1 T6 − T 2

2 T8

12

M. DONTEN-BURY AND S. KEICHER

C[T1, . . . , T10]/I with I gen. by

7 A4

Z3

(cid:20) 0 0 −1 −1

0 0
−1 0

0 −1
0

0 −1 −1
0

0 −1 −1 2 0

0 −1 −1 −1

1 1 0

0 0 1(cid:21)

8 BD3

Z5

9 BD3

Z8 

10 BD3

Z5

2
2 0 −3

−3 −3 −2 0

0 0 0 0

2

3

−1 −2 −2 0
−2 −5 −3 0
−2 −4 −3 0

2 0 0 0
2 −2 1 0 0
5 −5 0 1 0
4 −4 0 0 1





−3
0 −3 −2 1
−1 −1 −1 −2 0
−1
3

0

1

2
2 0 −3

0
0 −3 0
0 −3 0
0 −3 0
0 −4 0
0 −6 0

2

2

3

4

1

0

1

2

0

0 0 0 0 0 0

0 0 0 0 0 0

2 0 0 0 0 0
5 −5 1 0 0 0 0
4 −4 0 1 0 0 0
4 −4 0 0 1 0 0
6 −6 0 0 0 1 0
9 −9 0 0 0 0 1

−3 −3
0 −2
1
0
3 −1

2 0
0 −1 1
2 −3 0

1

2

0 0 0

0 0 0

−2 −5
−2 −4

2 −3
2 −3

2 0 0
5 0 −5 1 0
4 0 −4 0 1





T4T7T9 + T2T6 + T3T5,
T 2
4 T9 − T2T3 − T6T10,
T3T6T8 + T2T7 + T4T5,
T 2
3 T8 − T2T4 − T7T10,
27T 2
6 T8 + T5T7,
27T 2
7 T9 + T5T6,
1 T2 − T 2
5 ,
2 + T5T10,

T6T7T8T9 + 27T 2
T3T4T8T9 − T 2

1 T4 − T 2
1 T3 − T 2

T3T7T8T9 + T4T6T8T9 − 27T 2

1 T10 + T2T5

C[T1, . . . , T9]/I with I gen. by

4T 3

3 T 2

7 T9 + T 2

1 T6 − T 2

2 T8



C[T1, . . . , T12]/I with I gen. by
4T 3
3 T8

1 T7T12 − T 2

6 T9T10 + T 2

4 T 2

C[T1, . . . , T9]/I with I gen. by

4T 3

4 T 2

6 T9 + T 2

1 T7 − T 2

2 T8

Proof. Cases where G 6= A4: The Cox rings of the X0 = C3/G have been presented
in Proposition 3.3. We then obtain the Cox ring of a resolution X → X0 using our
implementation 2.2 of Algorithm 2.8. The veriﬁcations of the primality of the
variables Ti are done directly computationally, the smoothness tests are done with
Algorithm 2.7 as implemented in MDSpackage [12].

Case G = A4: To obtain the Cox ring of a resolution of the quotient singularity
for G = A4 one needs to change the presentation of the Cox ring of C3/G. The one
shown in Proposition 3.3 comes from the generating set of C[x, y, z][G,G]

T1 = x2 + y2 + z2, T2 = xyz, T3 = x2 + εy2 + ε2z2, T4 = x2 + ε2y2 + εz2

composed of eigenvectors of G/[G, G] action (where ε is the 3rd root of unity). For
the resolution algorithm to work (compare Example 3.6), we want the generating
set to satisfy [7, Condition 3.6], developed in the more general context including
the present case in [25]. Roughly speaking, it determines when a generating set of
R(X0) is suitable for being extended to the Cox ring of its resolution. Thus we add
to the generating set elements

T5 = T 2

1 − T3T4,

T6 = T 2

3 − T1T4,

T7 = T 2

4 − T1T3,

which are obstructions for this condition for the original generating set. We obtain
a presentation R(X0) = C[T1, . . . , T7]/I0 where generators for I0 and the Z/3Z-
grading matrix are

T4T5 + T3T6 + T2T7,
T 2

T2T3 − T 2

4 + T6,

T3T5 + T2T6 + T4T7,

T 2

3 − T2T4 − T7,

2 − T3T4 − T5,

27T 2

1 − T2T5 − T4T6 − T3T7,

(cid:2) 0 0 2 1 0 2 1(cid:3) .

The ring in the table is obtained via ambient toric modiﬁcation from the Cox
ring of C3/G, presented as above. More precisely, we apply Algorithm 3.15 (to be
explained in Subsection 3.3) with the choice of the three vectors

v1 := (0, 0, 2, 1, 0, 1, 1),

v2 := (0, 0, 2, 1, 0, 1, 2)

v3 := (1, 0, 3, 1, 1, 2, 3).

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

13

All the necessary veriﬁcations, in particular the smoothness test, are successful. (cid:3)

Example 3.6 (Non-example). Note that for G = A4, if we apply Algorithm 2.8
directly to the presentation of R(X0) given in case 7 of Proposition 3.3, we only
obtain the Cox ring of a modiﬁcation X → X0 where X is not smooth. More
precisely, it computes the Z8-graded Cox ring and degree matrix

C[T1, . . . , T12]/I with I gen. by
T 3
9 T12

4 T6T 2
−3T1T3T4T6T7T8T9T11T12 + T 3

8 T11 + T 3

7 T 2
1 T8T9T 2

3 T 2

6 T7T 2

11T 2

12

−27T 2

2 T10



1

0

0

0

0 0 0 0 0 0 0

−2 −3 −2 −2 1
0 −2 −1 0
0
−1 −1
−1 −1
−1 −2
−2 −2
−2 −2

3 0 0 0 0 0 0
0 0 −2 1 0 0 0 0 0
0 0 −2 0 1 0 0 0 0
0 0 −4 0 0 1 0 0 0
0 0 −3 0 0 0 1 0 0
0 0 −4 0 0 0 0 1 0
0 0 −5 0 0 0 0 0 1

1

2

1

2

.



Remark 3.7. Using these methods and its implementation, one can directly go to
higher group orders |G|. Since the number of diﬀerent representations to consider
grows quickly for isomorphism types of G with higher order, we end the table at
order 12.

3.2. Properties of quotients and their resolutions. We discuss certain geo-
metric properties of the quotient singularities and their resolutions corresponding
to the Cox rings from Theorem 3.5. At ﬁrst, we turn to torus actions on quotient
spaces: we consider the relation between the form of the Cox ring and the existence
of a torus action on Cn/G.

Proposition 3.8. Let V be an aﬃne space which is a direct sum of n representa-
tions of a given group G. Then V admits an action of (C∗)n which commutes with
the action of G.

Proof. Let (xi,1 . . . , xi,ni ) be the coordinates of the i-th representation (of dimen-
sion di). The following action commutes with the action of G.

(C∗)n × V → V,

(t1, . . . , tn) · (x1,1 . . . , x1,d1 , . . . , xn,1 . . . , xn,dn )

= (t1x1,1 . . . , t1x1,d1 , . . . , tnxn,1 . . . , tnxn,dn )

(cid:3)

Corollary 3.9. A quotient of C3 by a direct sum of a 2-dimensional and a 1-
dimensional representation is a T -variety of complexity one.

Remark 3.10. All representations in the table in Proposition 3.2 except the case
of A4 are direct sums of two irreducible representations, as it can be easily seen from
the generating matrices. In particular, all varieties X0 in Proposition 3.3 except
possibly for the A4 case are T -varieties of complexity one.

Thus, the only 3-dimensional quotient singularities which are possibly not T -
varieties of complexity one correspond to irreducible representations. The represen-
tation of A4 in Proposition 3.2 is irreducible and we expect that there is no (C∗)2
action.

Note that, in spite of the (C∗)2-action from Remark 3.10 for the other cases, we
still did not know a priori that Algorithm 2.8 would compute the Cox ring of a
resolution: to our knowledge, only for complete T -varieties [1, Theorem III.4.4.9]
and for aﬃne C∗-surfaces [14, Section 3] this is known. However, it seems natural
that, as in the cases of complete T -varieties and C∗-surfaces, the single relations of
the Cox rings of the singularity and its resolution are in all cases except for the A4
case of trinomial shape.

Remark 3.11. By the previous discussion, it would be interesting to continue
the list of results in Theorem 3.5 with irreducible, 3-dimensional representations.
However, the smallest cases of such representations (one of order 21, two of order
24 and two of order 27) are at the moment computationally out of reach on our
machines.

14

M. DONTEN-BURY AND S. KEICHER

We now turn to properties of the resolutions found in Theorem 3.5. Recall that a
resolution of singularities π : X → X0 is called crepant if KX = π∗KX0. For surface
quotient singularities for G ⊆ SL(2), i.e. du Val singularities, crepant resolutions
are the minimal ones: the special ﬁber is a tree of smooth rational curves dual to
a Dynkin diagram An, Dn, E6, E7 or E8. The relation between the structure of G
(its conjugacy classes or irreducible representations) and the shape of the diagram
of the resolution of C/G was noticed by McKay. The postulated relation between
the geometry of crepant resolutions of (Gorenstein) quotient singularities and the
structure of the group is called the McKay correspondence.
It has been studied
in several special cases and in diﬀerent formulations. In particular, it is proved in
dimension 3, see e.g. [16], for symplectic singularities in dimension 4, see [17], and
a weak version for any G ⊂ SL(n) (the equality of the dimension of cohomology
space and the number of conjugacy classes of G) is due to Batyrev [3].

It is a natural question to ask how good the resolutions obtained using Algo-
rithm 2.8 are and what properties to expect of them. In particular, we would like
to know whether they are crepant for G ⊂ SL(n). To test this property for the
3-dimensional results in Theorem 3.5 we can use the McKay correspondence.

Remark 3.12. Among groups listed in Proposition 3.2 the cases 1, 2, 3, 5, 6, 7
and 8 are in SL(3).

Proposition 3.13. In Theorem 3.5, the Cox rings of resolutions of singularities
in cases 1 (S3) and 5 (D10), are not the Cox rings of crepant resolutions. The
resolutions in cases 2 (D8), 3 (Q8), 6 (D12), 7 (A4) and 8 (BD3) are crepant.

Proof. By [9, Lemma 2.11], the class group Cl(X) of a resolution π : X → Cn/G
of a quotient singularity is a free group and its rank m is equal to the number of
irreducible components of the exceptional divisor. By the McKay correspondence
in dimension n = 3 we know that m is the number of conjugacy classes of junior
elements in G where an element g ∈ G is junior if

age(g) = 1

where

age(g) :=

1
r

nXk=1

ak

2πiak

with ak coming from the exponents of eigenvalues e
of g, see e.g. [21]. Thus the
conjugacy classes of junior elements can be determined with simple computations
(e.g. using GAP [10]), and the results are as follows:

r

case number
junior classes

1
2

2
4

3
4

5
3

6
5

7
3

8
5

Comparing them with the rank of Cl(X) given in Theorem 3.5 we obtain that the
resolutions in cases 1 and 5 have too many components of the exceptional divisor
to be crepant.

In the remaining cases obtained resolutions are crepant: since any crepant divisor
appears necessarily on any resolution (see e.g. [16, 2.3]), it is enough to show that
the number of exceptional divisors is equal to the number of junior classes.
(cid:3)

Note that in dimension 3 there is one Cox ring corresponding to all crepant reso-
lutions, because they are all birationally equivalent and ﬂops preserves smoothness
in dimension 3.

Remark 3.14. We can describe the geometry of all crepant resolutions for groups
2, 3, 6, 7 and 8 of Proposition 3.2 by computing GIT quotients of the spectrum of
their Cox rings. To determine the GIT fan describing the variation of the quotients,
we use [18].

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

15

case number

max. GIT-cones within Mov(X)

2
9

3
1

6
16

7
5

8
1

Actually, the cases 3 and 8 are products of a representation of a ﬁnite group
in SL(2) and a 1-dimensional trivial representation, so the resolutions will be just
products of minimal resolutions of du Val singularities by C. Hence, there is just
one crepant resolution, i.e., just one chamber in the GIT fan restricted to the cone
of movable divisor classes Mov(X).

3.3. Smaller resolutions. In Algorithm 2.8, we computed Cox rings of resolutions
as proper transforms under toric resolutions. The latter was obtained by intersection
of the tropical variety with the aﬃne ambient toric variety of X0. This may yield
unnecessarily many new rays and therefore bigger resolutions. In this subsection,
we shortly describe an immediate alternative version that works with subsets of
these rays in a brute force manner. A similar idea was used in [12, Section 3]. We
can then improve two resolutions of Theorem 3.5.

Algorithm 3.15. Input:
C[T1, . . . , Ts]/I0 of X0, σ = P0(Qs

as in the ﬁrst steps of Algorithm 2.8: the Cox ring
≥0), a fan Υ with support Trop(X0), Σ = {σ} ∩ Υ.
• Resolve Σ, i.e., determine a set V ⊆ Qn of primitive vectors such that the

stellar subdivision of Σ at V is regular.

• Insert into V primitive generators for the rays of Σ that are not rays of σ.
• For each k = 1, . . . , |V|, do:

– For each vi1 , . . . , vik ∈ V, do:

∗ Perform the steps of Algorithm 2.8 starting from line 6 with
v1, . . . , vm replaced by vi1 , . . . , vik and Σ replaced by the stellar
subdivision of σ at these vectors. Stop, if the veriﬁcation is
positive.

Output (if provided):

the Cox ring R(X) = C[T1, . . . , Tr]/I of a resolution X → X0.

Proposition 3.16. In the setting of Theorem 3.5, the following are Cox rings of
crepant resolutions.

No. G Cl(X)

degree matrix

R(X)

1

S3

Z2

5 D10

Z3

h 1
(cid:20) 1

4T 3

3 T6 − T 2

2 T5 − 27T 2

C[T1, . . . , T6]/I with I gen. by

0 1i
0 −1 1(cid:21) C[T1, . . . , T7]/I with I gen. by

6 T7 + T 2

2 T5 − T 2

4T 5

3 T 3

0 0

1 0

4

4

1

0

0 −2 0

0 −1 −1 −1

1

0

0 −2
0

0 −1 −1 −1
0 −1
0 −1

Proof. In case 1, the fan Σ0 of the ambient aﬃne toric variety has the maximal cone
σ generated by

(1, 0, 0, 0),

(1, 2, 0, 0),

(0, 0, 1, 0),

(0, 0, 0, 1) ∈ Q4.

Algorithm 3.15 then stellarly subdivides Σ0 = fan(σ) at (1, 1, 0, 0) and (1, 2, 1, 1) ∈
Q4. The veriﬁcations succeed. Similarly, in case 5, the cone σ is generated by

(1, 0, 0, 0),

(1, 2, 0, 0),

(0, 0, 1, 0),

(0, 0, 0, 1) ∈ Q4.

Again, Algorithm 3.15 stellarly subdivides Σ0 at the vectors (1, 1, 0, 0), (1, 2, 1, 1)
and (2, 4, 1, 2) ∈ Q4.

Both resolutions are crepant, because the number of exceptional divisors is the
same as the number of junior conjugacy classes in G, compare the end of the proof
of 3.13.
(cid:3)

16

M. DONTEN-BURY AND S. KEICHER

Remark 3.17. As in Remark 3.14, we compute the variation of GIT-quotients for
the two cases of Proposition 3.16:

case number

max. GIT-cones within Mov(X)

1
2

5
3

Remark 3.18. Applying Algorithm 3.15 to the other cases of Theorem 3.5 does not
yield better resolutions in the sense of smaller Picard number or fewer generators.
Note that these cases are precisely the ones which are not in SL(3).

4. Two 4-dimensional examples

In this section, we present two 4-dimensional examples. In dimension 4 much
less is known about the resolutions of quotient singularities. In particular, crepant
resolutions do not always exist, and the McKay correspondence has been proved
just for the symplectic case by Kaledin, see [17]. Hence it is a very appropriate
setting for computational experiments with constructing resolutions via Cox rings.
Moreover, it is interesting also from the point of view of the Cox ring theory: while
in dimension 3 all our cases except for one can be deﬁned with a single trinomial
relation, here the ring structure will be more complicated.

The groups given below are complex symplectic, hence we work here with sym-
plectic quotient singularities. Both examples have also been treated in [7] where
the Cox rings of symplectic resolutions was constructed.

Proposition 4.1. Consider the 4-dimensional quotient singularities C4/G for the
two small groups G ⊆ GL(4)

G gen.s in GL(4)

0

0

1 −1
0
0

S3 " 0 −1
D8 " 0 −1

1

0

0

0

0

0

0

0

0

0

0

0
0
0 −1

1 −1 # , " −1
0 # , " 1

0
0
0 −1
1

0

0

0

0
0 −1
0
0

0

1

1
0
0 −1
0
0

0

1

0

0

1 # .
0 −1 # .

0

0

0

1

0

0

The Cox ring of the quotient space X0 := Cn/G, the degree matrix and the class

group of X0 are as follows.

G

S3

Z/2Z

Cl(X0), degree matrix and R(X0)

(cid:2) 1

1

1

1

1

0

0

0

0

0

0

0 (cid:3)

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

17

C[T1, . . . , T12]/I with I gen. by

3T9T10 − T7T11 + T6T12,
3T6T8 + T9T11 − T7T12,

3T3T8 − 3T2T10 − T5T11 − T4T12,

T4T7 − 2T3T9 + T1T11,
T5T6 − T3T9 + T1T11,
T2T6 + T4T9 − T1T12,

T 2

11 + 9T10T12,

4 − T3T5 − 3T 2
T1T4 + 3T7T11 − 6T6T12,
T1T3 + 9T7T10 − 6T6T11,

3T5T10 − 2T4T11 + T3T12,
3T4T8 − T2T11 − 2T5T12,
T5T7 − 2T4T9 + T1T12,
T2T7 − 3T1T8 + 2T5T9,
2T4T6 − T3T7 + 3T1T10,
T1T5 + 6T9T11 − 3T7T12,
5 + 9T8T11 − 3T 2

T2T4 + T 2

12,

T2T3 + T4T5 + 27T8T10 − 3T11T12,

T1T2 + 9T7T8 − 6T9T12,

T 2

1 + 3T 2

7 − 12T6T9,

2T7T 2
9 + T2T5 − 9T8T12,
2T1T 2
9 − 9T5T8 − 3T2T12,
2T6T7T9 − T4T5 − 3T11T12,
6 T9 − T3T5 − 6T 2

4T 2
7 − 4T6T7T9 − 27T8T10 + 3T11T12,

T 3
7 − 4T1T6T9 − 9T3T8 − 3T5T11 + 6T4T12,

11 + 9T10T12,

T1T 2

T1T6T7 + 3T4T11 − 3T3T12,
2T1T 2
6 + 9T4T10 − 3T3T11

9 − T 2

4T 3
4T6T 2

2 − 27T 2
8 ,
5 − 3T 2
12,

9 − T 2

T 2

9 − 9T8T11 + 3T 2
7 T9 − 4T6T 2
T1T7T9 − 3T2T11 − 3T5T12,
2T1T6T9 + 3T5T11 − 3T4T12,

12,

T6T 2

7 − 4T 2
2T 2

6 T9 + 3T 2

11 − 9T10T12,

6 T7 − T3T4 − 9T10T11,
4T 3

3 − 27T 2

6 − T 2

10,

D8 Z/2Z × Z/2Z

1

1

1

1

1

0

1

0

1

0

0

1

0

0

0

0

h 1

1

C[T1, . . . , T10]/I with I gen. by

0

0 i

T5T8 + T4T9 − 2T6T10

T 2

7 − T8T9 + T 2

10,

T5T7 + T2T9 − 2T3T10,
2T3T7 − T6T9 + T5T10,
2T1T7 + T6T8 − T4T10,
T2T5 − 2T3T6 + T7T9,
T3T4 − T1T5 − T7T10,

4T 2

3 + T 2
4T1T3 + T 2

5 − T 2
9 ,
6 − T 2
10,

2T1T2 + T4T6 − T8T10,

T3T8 + T1T9 − T2T10,
T6T7 + 2T1T9 − T2T10,
T4T7 − T2T8 + 2T1T10,
T2T7 − T4T9 + T6T10,
T4T5 − T 2
6 + T8T9 − T 2
10,
2T1T5 − T2T6 + T7T10,
T2T4 − 2T1T6 − T7T8,
2T2T3 + T5T6 − T9T10,

T 2
2 + T 2
4T 2

1 + T 2

6 − T8T9,
4 − T 2

8

Proof. This is again an application of Algorithm 2.3.

(cid:3)

We now compute the Cox rings of a resolution for the two cases X0 = C4/S3
and X0 = C4/D8 presented in the previous proposition.
In Proposition 4.3, we
present a resolution for the D8-case thereby retrieving a result of Grab and the ﬁrst
author [7, Prop. 5.15]; Proposition 4.4 treats the case of S3.

Remark 4.2. In the case of G = D8 in Proposition 4.1, applying Algorithm 2.8 to
X0 = C4/G without changes, we obtain a modiﬁcation X → X0 with Cl(X) = Z16
and the Cox ring R(X) = C[T1, . . . , T26]/I with 28 generators for I. Due to this
size, we could not verify smoothness on our machines. Similarly, the smoothness
tests in the case G = S3 were computationally infeasible.

It turns out, that after some changes in Algorithm 3.15, we obtain the Cox
rings of symplectic resolutions for S3 and D8. Note that for a symplectic quotient
singularity a crepant resolution and a symplectic resolution is the same, see [24,
Thm 2.5].

Proposition 4.3. In the case of G = D8 in Proposition 4.1, applying a variant of
Algorithm 2.8 to X0 = C4/G, we obtain a resolution X → X0 with Cl(X) = Z2
and the Cox ring is R(X) = C[T1, . . . , T12]/I where generators for I and the degree
matrix are

18

M. DONTEN-BURY AND S. KEICHER

T 2

7 T12 − T 2

T5T8 + T4T9 − 2T6T10,
T2T5 − 2T3T6 + T7T9,
2T3T4 − T2T6 − T7T10,
2 + 4T1T3,
T5T7T12 + T2T9 − 2T3T10,
10,
2T3T7T11 − T6T9 + T5T10,
2T1T7T11 + T6T8 − T4T10,
2T2T3T11 + T5T6T12 − T9T10,
2T1T2T11 + T4T6T12 − T8T10,

6 T12 + T8T9 − T 2

T4T5T12 − T 2

T3T8 + T1T9 − T2T10,
2T1T5 − T2T6 + T7T10,
T2T4 − 2T1T6 − T7T8,
T6T7T12 + 2T1T9 − T2T10,
T4T7T12 − T2T8 + 2T1T10,
T 2
T2T7T11 − T4T9 + T6T10,
4T 2
4T1T3T11 + T4T5T12 + T8T9 − 2T 2
4T 2

7 T11 + T4T5 − T 2
6 ,

5 T12 − T 2
9 ,

3 T11 + T 2

4 T12 − T 2

1 T11 + T 2

8

10,

0

2 i .

h −1 −1 −1

1

1

0

0

1 −1 −1 −1

0 −1
0

0

0

0

0

0
2
0 −2

After a suitable linear change of coordinates one sees that this ring is isomorphic
to the Cox ring of symplectic, i.e. crepant, resolutions of considered representation
of D8 computed in [7, Section 5].

Proof. This is an application of Algorithm 3.15 with the following modiﬁcations
(similar to [12, Section 3]): There are three minimal elements σ1, σ2, σ3 of the set
consisting of all singular P0(γ∗
0 ) such that γ0 is an F-face. We form the cone-wise
i → Σi. Denoting by primit(Ξ(1))
intersections Σi = {σi}∩Υ and resolve the fans: Σ′
the primitive generators of the rays of a fan or cone Ξ, we have

primit(cid:16)Σ′(1)

i (cid:17) \ primit(cid:16)σ(1)

i (cid:17) = (cid:26) (2, 2, 1, 0, 0, 0, 1, 0, 0, 0),

(2, 2, 2, 1, 1, 1, 1, 0, 0, 0)(cid:27) =: {v1, v2}.

3[i=1

The remaining steps of the algorithm deliver the result. All needed veriﬁcations, in
particular the smoothness test, succeed.
(cid:3)

Proposition 4.4. In the case of G = S3 in Proposition 4.1 we obtain a resolution
X → X0 with Cl(X) = Z and the Cox ring is R(X) = C[T1, . . . , T13]/I where
generators for I and the degree matrix are

T 2

4 T13 − T3T5T13 − 3T 2

3T9T10 − T7T11 + T6T12,
3T6T8 + T9T11 − T7T12,
3T3T8 − 3T2T10 − T5T11 − T4T12,
T4T7 − 2T3T9 + T1T11,
T5T6 − T3T9 + T1T11,
T2T6 + T4T9 − T1T12,
11 + 9T10T12,
T1T4T13 + 3T7T11 − 6T6T12,
T1T3T13 + 9T7T10 − 6T6T11,
T 2
1 T13 + 3T 2
7 − 12T6T9,
2T7T 2
9 + T2T5T13 − 9T8T12,
9 − 9T5T8 − 3T2T12,
2T6T7T9 − T4T5T13 − 3T11T12,
11 + 9T10T12,
1 T9 − 3T2T4 − 3T 2
5 ,
11 − 9T10T12,
6 T7 − T3T4T13 − 9T10T11,
1 T7 − 3T2T3 − 3T4T5,
6 + 9T4T10 − 3T3T11,

6 T9 − T3T5T13 − 6T 2

T 2
6 T9 + 3T 2

7 − 4T 2
2T 2

T 2
2T1T 2

2T1T 2

T6T 2

4T 2

12,

5 T13 + 9T8T11 − 3T 2

3T5T10 − 2T4T11 + T3T12,
3T4T8 − T2T11 − 2T5T12,
T5T7 − 2T4T9 + T1T12,
T2T7 − 3T1T8 + 2T5T9,
2T4T6 − T3T7 + 3T1T10,
T1T5T13 + 6T9T11 − 3T7T12,
T2T4T13 + T 2
T2T3T13 + T4T5T13 + 27T8T10 − 3T11T12,
T1T2T13 + 9T7T8 − 6T9T12,
4T 3
4T6T 2
T 2
T1T7T9 − 3T2T11 − 3T5T12,
2T1T6T9 + 3T5T11 − 3T4T12,
T 3
T1T 2
T1T6T7 + 3T4T11 − 3T3T12,
4T 3
T 2

7 − 4T6T7T9 − 27T8T10 + 3T11T12,

2 T13 − 27T 2
8 ,
5 T13 − 3T 2

3 T13 − 27T 2
4 + 3T3T5

6 − T 2
1 T6 − 3T 2

9 − 9T8T11 + 3T 2

7 T9 − 4T6T 2

9 − T 2

9 − T 2

10,

12,

12,

7 − 4T1T6T9 − 18T3T8 + 9T2T10 + 9T4T12,

[ −1 −1 −1 −1 −1

0

0

0

0

0

0

0

2 ] .

After a suitable linear change of coordinates one sees that this ring is isomorphic to
the Cox ring of symplectic resolution of considered representation of S3 computed
in [7, Section 4].

Proof. This is an application of Algorithm 3.15; one new ray is added to the fan of
the ambient toric variety corresponding to the Cox ring of X0. To show that the ring
is isomorphic to the one given by a generating set in [7, Section 4] it is suﬃcient to
compute the relations between these generators and perform the coordinate change
to pass from one representation of S3 to the other. Having this, the smoothness tests

COMPUTING RESOLUTIONS OF QUOTIENT SINGULARITIES

19

are not needed: by [7, Prop. 4.4] we indeed obtain the Cox ring of the symplectic
resolution of X0.
(cid:3)

References

[1] I. Arzhantsev, U. Derenthal, J. Hausen, and A. Laface. Cox rings, volume 144 of Cambridge

Studies in Advanced Mathematics. Cambridge University Press, Cambridge, 2014.

[2] I. V. Arzhantsev and S. A. Ga˘ıfullin. Cox rings, semigroups, and automorphisms of aﬃne

varieties. Mat. Sb., 201(1):3–24, 2010.

[3] V. V. Batyrev. Non-Archimedean integrals and stringy Euler numbers of log-terminal pairs.

J. Eur. Math. Soc. (JEMS), 1(1):5–33, 1999.

[4] T. Bogart, A. N. Jensen, D. Speyer, B. Sturmfels, and R. R. Thomas. Computing tropical

varieties. J. Symbolic Comput., 42(1-2):54–73, 2007.

[5] W. Bruns, B. Ichim, T. R¨omer, R. Sieg, and C. S¨oger. Normaliz. algorithms for rational cones

and aﬃne monoids. Available at https://www.normaliz.uni-osnabrueck.de.

[6] W. Decker, G.-M. Greuel, G. Pﬁster, and H. Sch¨onemann. Singular 4-0-3 — A computer

algebra system for polynomial computations. http://www.singular.uni-kl.de, 2016.

[7] M. Donten-Bury and M. Grab. Cox rings of some symplectic resolutions of quotient singular-

ities. 2015. Preprint. arXiv:1504.07463.

[8] M. Donten-Bury and S. Keicher. quotsingcox.lib – a Singular library to compute Cox rings
of quotient singularities, 2016. www.mathematik.uni-tuebingen.de/˜keicher/quotsingcox/.
[9] M. Donten-Bury and J. A. Wi´sniewski. On 81 symplectic resolutions of a 4-dimensional quo-

tient by a group of order 32. 2014. Preprint. arXiv:1409.4204.

[10] The GAP Group. GAP – Groups, Algorithms, and Programming, Version 4.7.5, 2014.
[11] J. Hausen. Cox rings and combinatorics. II. Mosc. Math. J., 8(4):711–757, 847, 2008.
[12] J. Hausen and S. Keicher. A software package for Mori dream spaces. LMS J. Comput. Math.,

18(1):647–659, 2015.

[13] J. Hausen, S. Keicher, and A. Laface. Computing Cox rings. Math. Comp., 85(297):467–502,

2016.

[14] J. Hausen and M. Wrobel. Non-complete rational T-varieties of complexity one. 2015.

Preprint. arXiv:1512.08930.

[15] E. Huggenberger. Fano Varieties with Torus Action of Complexity One. PhD thesis, Univer-

sit¨at T¨ubingen, Wilhelmstr. 32, 72074 T¨ubingen, 2013.

[16] Y. Ito and M. Reid. The McKay correspondence for ﬁnite subgroups of SL(3, C). In Higher-

dimensional complex varieties (Trento, 1994), pages 221–240. de Gruyter, Berlin, 1996.

[17] D. Kaledin. McKay correspondence for symplectic quotient singularities. Invent. Math.,

148(1):151–175, 2002.

[18] S. Keicher. Computing the GIT-fan. Internat. J. Algebra Comput., 22(7):1250064, 11, 2012.
[19] S. Keicher. Algorithms for Mori Dream Spaces. PhD thesis, Universit¨at T¨ubingen, 2014.
[20] D. Maclagan and B. Sturmfels. Introduction to tropical geometry, volume 161 of Graduate

Studies in Mathematics. American Mathematical Society, Providence, RI, 2015.

[21] M. Reid. La correspondance de McKay. Ast´erisque, (276):53–72, 2002. S´eminaire Bourbaki,

Vol. 1999/2000.

[22] J. Tevelev. Compactiﬁcations of subvarieties of tori. Amer. J. Math., 129(4):1087–1104, 2007.
[23] J. Tevelev. On a question of B. Teissier. Collect. Math., 65(1):61–66, 2014.
[24] M. Verbitsky. Holomorphic symplectic geometry and orbifold singularities. Asian J. Math.,

4(3):553–563, 2000.

[25] R. Yamagishi. On smoothness of minimal models of quotient singularities by ﬁnite subgroups

of SLn(C). 2016. Preprint. arXiv:1602.01572.

University of Warsaw, Institute of Mathematics, Banacha 2, 02-097 Warszawa, Poland
& Freie Universit¨at Berlin, Mathematisches Institut, Arnimallee 3, 14195 Berlin, Ger-
many

E-mail address: m.donten@mimuw.edu.pl

Departamento de Matematica, Facultad de Ciencias Fisicas y Matematicas, Universi-

dad de Concepci´on, Casilla 160-C, Concepci´on, Chile

E-mail address: keicher@mail.mathematik.uni-tuebingen.de

