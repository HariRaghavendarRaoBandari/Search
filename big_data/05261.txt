6
1
0
2

 
r
a

M
 
6
1

 
 
]

.

C
N
o
i
b
-
q
[
 
 

1
v
1
6
2
5
0

.

3
0
6
1
:
v
i
X
r
a

Optimally controlling the human connectome: the role of network topology
Richard F. Betzel1, Shi Gu1, John D. Medaglia1,2, Fabio Pasqualetti3, and Danielle S. Bassett1,4∗

1Department of Bioengineering, University of Pennsylvania, Philadelphia, PA, 19104

2Department of Psychology, University of Pennsylvania, Philadelphia, PA, 19104

3Department of Mechanical Engineering, University of California, Riverside, Riverside, CA, 92521 and

4Department of Electrical and Systems Engineering,
University of Pennsylvania, Philadelphia, PA, 19104

(Dated: March 18, 2016)

To meet ongoing cognitive demands, the human brain must seamlessly transition from one brain
state to another, in the process drawing on diﬀerent cognitive systems. How does the brain’s
network of anatomical connections help facilitate such transitions? Which features of this network
contribute to making one transition easy and another transition diﬃcult? Here, we address these
questions using network control theory. We calculate the optimal input signals to drive the brain
to and from states dominated by diﬀerent cognitive systems. The input signals allow us to assess
the contributions made by diﬀerent brain regions. We show that such contributions, which we
measure as energy, are correlated with regions’ weighted degrees. We also show that the network
communicability, a measure of direct and indirect connectedness between brain regions, predicts the
extent to which brain regions compensate when input to another region is suppressed. Finally, we
identify optimal states in which the brain should start (and ﬁnish) in order to minimize transition
energy. We show that the optimal target states display high activity in hub regions, implicating the
brain’s rich club. Furthermore, when rich club organization is destroyed, the energy cost associated
with state transitions increases signiﬁcantly, demonstrating that it is the richness of brain regions
that makes them ideal targets.

I.

INTRODUCTION

One of the goals of modern biology is to understand
how a system’s form inﬂuences its functionality. Human
brain networks manifest structure-function relationships,
with converging evidence suggesting that the brain’s net-
work of white-matter ﬁber pathways (structural connec-
tivity; SC) constrains the intrinsic functional interac-
tions among brain regions at rest (functional connec-
tivity; FC), thereby shaping the emergence of coherent
spatiotemporal patterns of neural activity [1–5]. The ef-
fect of these constraints is that over long periods of time
(hours, days) resting FC largely recapitulates the under-
lying SC [6] so that the strongest functional interactions
are often mediated by direct anatomical projections [7].
Over shorter timescales, however, FC is more variable,
decoupling from the underlying anatomy to engage spe-
ciﬁc cognitive systems both at rest [8–10] and in order to
meet ongoing cognitive demands [11–13].

How does the brain smoothly transition from the ac-
tivation of one cognitive system to the activation of an-
other? What are the anatomical and topological sub-
strates that facilitate such transitions? One approach
for addressing these and similar questions is to model the
human brain as a dynamical system, treating brain re-
gions as dynamic elements with time-dependent internal
states. As the system evolves, each brain region’s state
is updated according to its own history and the states of
its connected neighbors. Such models vary in their com-
plexity and neurophysiological basis, ranging from bio-

∗ dsb @ seas.upenn.edu

physically plausible descriptions of interacting neuronal
populations [14–18] to abstract models based on oscilla-
tions, diﬀusion, and epidemic spreading [19–22].

In most applications, the question of how to control
distributed brain dynamics is not explicitly considered.
Here, control refers to the possibility of manipulating a
dynamical system so that it evolves to follow a partic-
ular trajectory through its state space. We posit that
the nature of brain state transitions can be meaning-
fully addressed with network control theory, which oﬀers
a mathematical framework for studying and, ultimately,
controlling the evolution of dynamical systems on net-
works [23, 24].

Most dynamical systems can be framed in a control
perspective by introducing exogenous input to the sys-
tem through a set of control sites (network nodes) in the
form of time-varying signals. The eﬀect of such inputs is
to drive the system along a trajectory through its state
space; diﬀerent inputs, then, result in diﬀerent trajecto-
ries [24, 25]. The eﬀect of input on a system’s trajectory
depends upon (i) the system’s dynamics, (ii) the compo-
sition of the control sites, and (iii) the conﬁguration of the
system’s nodes and edges into a network (its topology)
[24]. Understanding how control occurs in the brain and
how these factors contribute to enacting control is of crit-
ical importance, with clear clinical and engineering impli-
cations. For example, the eﬃcacy of implantable neuro-
modulatory devices for suppressing Parkinsonian symp-
toms [26], seizure abatement in epilepsy [27], and other
methods for manipulating brain activity, such as tran-
scranial magnetic stimulation [28], depend on our ability
to modify a network’s function by introducing external
electromagnetic signals.

In the current work we use network control theory to

identify minimum energy input signals that cause the
system to transition to and from speciﬁc brain states.
The input signals are introduced through control sites
– brain regions – and can be thought of in two com-
plementary ways. One view is that control signals are
issued directly from brain regions, themselves acting as
local computational elements administering control over
the network. Alternatively, control signals can be viewed
as having extracranial provenance, originating from im-
planted electrodes or other neuromodulatry devices and
thereby acting on speciﬁc brain regions. In either case,
a region’s local contribution can be modeled as an in-
put of energy over time and interpreted as a measure of
the amount of eﬀort it puts forth during a control task
[25, 29].

We seek to better understand the role of brain network
topology in determining a region’s energy – what topo-
logical factors contribute to making transitions between
diﬀerent brain states more or less eﬀortful? Previous
investigations addressing similar questions have focused
on how the underlying networks’ statistical properties
(e.g. the shape of degree distribution) and global metrics
(e.g. modularity, clustering, etc.) inﬂuence the minimum
number of control sites necessary to render the network
controllable [24, 30–33]. Such approaches, while illumi-
nating, are limited. First, the focus on global network
statistics makes it diﬃcult to assess the contributions
of individual nodes or edges. Second, the classiﬁcation
of networks as either “controllable” or “uncontrollable”
overlooks ﬁner gradations in the amount of energy re-
quired for control. Though some node-level metrics have
been proposed [34], the precise roles of individual nodes
and other topological features in facilitating control is not
well understood. Previous applications of network con-
trol theory to brain networks investigated related ques-
tions, by studying all possible state transitions and as-
suming an inﬁnite time horizon [18, 35]. Here, we focus
on ﬁnite-time transitions between a limited set of accessi-
ble states, which we choose to correspond to previously-
deﬁned brain systems [36].

The remainder of this report is divided into two sec-
tions.
In the ﬁrst, we explore a set of progressively
more diﬃcult control tasks, demonstrating that a brain
region’s weighted degree (strength) is highly correlated
with its control energy, suggesting that regions with
many, strong connections contribute disproportionately
more energy than regions with few or weak connections.
We also studied the eﬀect of selectively suppressing input
to select sets of brain regions, which revealed a network
of compensatory interactions among brain regions. We
show that the degree to which one brain region compen-
sates for the removal of another can be predicted with the
network measure “communicability”, which measures the
strength of direct and indirect pathways between network
nodes.

The second section builds on the results from the ﬁrst.
Rather than use a pre-deﬁned set of initial and target
states, we objectively assign nodes to initial and target

2

states so as to minimize the cost of the transitions among
these states. We ﬁnd that the optimal assignments impli-
cate highly connected brain regions as ideal targets and
weakly connected regions as ideal observers (i.e.
they
play no role in control). We also show that the energy
associated with these optimal assignments is less than
what would be expected given a degree-preserving ran-
dom network model. Finally, we show that when the
network’s rich club [37] is disrupted the energy increases,
further suggesting that the conﬁguration of connections
among hub regions supports low-energy transitions.

II. MATHEMATICAL MODEL

We studied a dynamical system in which the brain’s
network of white matter ﬁber tracts among brain regions
constrained the following linear time-invariant nodal dy-
namics [35, 38]:

˙x = Ax(t) + BKuK(t).

(1)
Here, x(t) ∈ Rn×1, is the state vector whose element,
xi(t), represents the state (activity level) of brain region
i at time t. The matrix A ∈ Rn×n is the symmetric
and weighted adjacency matrix, whose element Aij is the
number of detected tracts between regions i and j nor-
malized by the sum of their volumes. The input matrix,
BK, speciﬁes the set of control points, K = {k1 . . . km},
such that:

BK = [ek1, . . . , ekm],

(2)

where eki is the ith canonical column vector of dimension
n. The time-varying input signals are denoted as uK(t) ∈
Rm×1 where uki (t) gives the input at control point ki at
time t (Figure 1).

t=0 (cid:107)u∗
i=1 Eki.

ki

We were interested in the control task where the sys-
tem transitions from some initial state, x0 = x(t = 0),
to some target state, xT = x(t = T ). We solved this
task using an optimal control framework, deriving the
set of minimum-energy inputs, u∗
K(t), for accomplishing
this task (Materials and Methods). Each control point’s
(t)(cid:107)2dt and the to-

energy was deﬁned as Eki =(cid:82) T
tal energy was given by E =(cid:80)m

Rather than investigate all possible transitions, we con-
sidered a limited repertoire, focusing on a set of eight
states based on systems previously identiﬁed in intrin-
sic functional connectivity studies [36] (Materials and
Methods, Cognitive systems). We analyzed all system-
to-system transitions (excluding self-transitions), result-
ing in 56 possible control tasks.
Importantly, because
our dynamical model is linear, any possible transition
can be written as a linear combination of these transi-
tions (though the resulting transition may not be opti-
mal, in terms of minimum energy). Thus, our results are
generally relevant to all transitions.

3

FIG. 1. Schematic illustrating structural controllability framework. (A) The space of all possible states includes
regions that require prohibitively large energy to access as well as damaging conﬁgurations. Our analyses are restricted to
the accessible region of state space populated by viable conﬁgurations. (B) A set of time-varying inputs are injected into the
system at diﬀerent control points (nodes; brain regions). The aim is to drive the system from some particular initial state to a
target state (e.g. from somatosensory to visual system). (C) Example trajectory through state space. Without external input
(control signals) the system’s passive dynamics leads to a state where random brain regions are more active than others; with
input the system is driven into the desired target state. (D) Schematic illustration of all possible system-to-system transitions.

For a given control task we classiﬁed brain regions

based on their states at times t = 0 and t = T :

1. The initial class includes all regions that were ac-
tive at t = 0 and inactive at t = T (denoted as
x0).

2. The target class, on the other hand, included all
regions that were inactive at t = 0 but active at
t = T (denoted as xT ).

3. The bulk class included regions that inactive at

both t = 0 and t = T .

In principal, there is a fourth class of regions active
at both t = 0 and t = T . However, given the control
tasks we consider here, this case never arises.
In sub-
sequent sections we will present our results within this
classiﬁcation scheme.

III. RESULTS

Predicting energy from topology

One of the principal aims of this report was to de-
termine what features of the brain’s topology inﬂuence
control energy.
In this section we assessed the role of
topology in determining the energy associated with each
of the 56 control tasks. We began this investigation with
a simple scenario in which all brain regions served as con-
trol points. We observed that Etarget > Einitial > Ebulk
(one-way ANOVA comparing log-transformed energies
across all control tasks and participants yielded mini-
mum omnibus test-statistic of F (2, 126) = 83.0, and a
maximum p-value of p = 1.0 × 10−23; pairwise t-tests
for Etarget > Einitial and Einitial > Ebulk yielded min-
imum t-statistic of t = 8.31 and maximum p-value of
p = 1.6 × 10−9, Bonferroni adjusted) (Figure 2A).

To explain this ranking of energies, we need to con-
sider the system’s dynamics under free evolution – the
absence of input. In such a case, the system evolves as
x(t) = eAtx0, which we obtained by solving Eq. 1. The
vector v(t) = xT − x(t), then, speciﬁed the distance,
vi(t), of each region from its target state at time t. Intu-
itively, as distance increased, more energy was required to
drive the system towards its desired conﬁguration (Figure
S1). Moreover, distance followed a class-speciﬁc trajec-
tory (Figure 2B). At the control horizon, t = 1, bulk re-
gions were nearest their target state, followed by initially
active regions, followed by target regions, explaining why
speciﬁc classes required more or less energy.

degrees (strength; si = (cid:80)

The previous analysis demonstrated that, foremost, re-
gional control energy depended on class. Within each
class, however, we found that much of the remaining
variance could be accounted for by regions’ weighted
j Aij). Across participants
and control tasks, the logarithm of control energy for
regions assigned to initial and bulk classes was both pos-
itively correlated with the logarithm of strength (me-
dian(interquartile range) correlations of r = 0.85(15) and
r = 0.79(15), respectively) while the opposite was true
for target regions r = −0.84(13)) (Figure 2C-E; Figure S2
for summary across all participants). Collectively, these
results imply that predicting a brain region’s energy con-
tribution requires both topology and contextualizing a
region’s role – i.e.
initial, target, bulk – in a given con-
trol task.

Simulated suppression and compensatory eﬀects

In the previous section we investigated a scenario in
which all brain regions served as control points, making
it possible to control any region’s state directly. In the
current section we imagined a more diﬃcult scenario in

4

FIG. 2. Energy depends on class and strength when all regions are controlled. (A) Violin plot of node-level control
energies aggregated across all control tasks and divided into initial (x0), target (xT ), and bulk classes. (B) Average distance
of x(t) from target state, xT , under free evolution (i.e. no input signals) as a function of time and averaged within each class.
(C-E) Scatterplots of node-level control energies, log10Eki , versus strengths, ski , (total normalized streamline counts) across
all control tasks. (F-H) Distributions of Pearson’s correlation coeﬃcients for best-ﬁt lines shown in panels (C-E).

which the system performed the same control tasks but
with speciﬁc subsets of brain regions excluded from the
control set. These excluded regions, then, could only
be manipulated via indirect input from their neighbors –
they required help from the rest of the network to achieve
their desired state. This framework, which we refer to
as “simulated suppression”, is analogous to inhibitory
neuromodulation, which can be achieved externally us-
ing transcranial magnetic stimulation (TMS), in which
a brain region’s local activity is suppressed but still re-
ceives inputs from surrounding areas [39, 40] but could
also be achieved internally via competitive or inhibitory
dynamics among neuronal populations.

Using simulated suppression we investigated how the
suppression of input to speciﬁc regions changed the en-
ergies of the remaining, unsuppressed, regions. We inter-
preted such changes as a measure of compensation. In
this section, we explored a series of progressively more
diﬃcult control scenarios in which we suppressed both
individual brain regions and entire classes of regions.

Suppression of individual brain regions

In this section we suppressed individual brain regions,
one at a time, and repeated the same control tasks as the
previous section. We expected that with fewer control
points the total control energy, E, would increase. We
found that this was largely the case, with the greatest
percent changes in energy occurring among bulk regions
(Figure 3A).

The simulated suppression framework allowed us to

calculate the extent to which brain regions engaged in
compensatory relationships with one another, wherein
the suppression of one region consistently resulted in in-
creased energy of another region. We were also interested
in determining to what extent these compensatory rela-
tionships could be predicted based on topological proper-
ties of the network. We hypothesized that the strength of
compensatory relationships should depend upon the ex-
tent to which they were interconnected. We reasoned
that even indirectly-connected regions should be able
to compensate for one another provided that they were
linked by many multi-step paths. This intuition can be
formalized as the communicability between two regions,
a statistic that quantiﬁes the strength of both direct and
indirect pathways between node pairs [41]. Communica-
bility can be thought of as the capacity for two regions to
communicate with one another by pathways of all topo-
logical lengths (Figure 3B) (Materials and Methods, Net-
work communicability).

For each control task we calculated the percent change
in energy of region ki after suppressing region kj, which
we denote as %∆Eki,kj (Figure 3C). When averaged
across all control tasks we found excellent correspon-
dence between this measure and weighted communica-
bility, with a correlation of r = 0.95(0.01) across partic-
ipants (Figure 3D). The same relationship persisted (al-
beit attenuated) when we examined speciﬁc control tasks
and sub-divided regions according to their class: for ini-
tial r = 0.74(0.08), for target r = 0.80(0.06), and for bulk
r = 0.68(0.11)) (Figure 3E-G). These results suggest that
both direct and indirect connections play important roles
in compensating for suppressed brain regions (Figure S3

5

FIG. 3. Communicability predicts compensation (or change in energy) when individual regions are suppressed.
(A) Violin plot of percent change in regions’ energies (%∆Eki ) after suppressing region kj aggregated by class. (B) Com-
pensation network in matrix form; the weights of the compensation network are deﬁned as the percent change in energy of
region ki (%∆Eki ) after suppressing region kj averaged across all control tasks. (C) Weighted communicability matrix, which
measures the total strength of direct and indirect connections between two regions. (D) Scatterplot showing the correlation
of communicability and the compensation network weights. (E-G) Percent change in the energy of region ki after suppressing
region kj. Each class is shown separately – x0 are active at time t = 0, xT are active at time t = T , and bulk nodes are inactive
at both t = 0 and t = T . Matrices in panels (B) and (C) are shown with logarithmic scaling.

for summary across all participants).

Suppressing initial and target classes

Suppressing initial or target classes

communicability to the suppressed class ((cid:80)
and (cid:80)

We extended the simulated suppression framework by
simultaneously suppressing entire classes of brain regions,
resulting in considerably more diﬃcult control tasks. In
particular, we suppressed all regions assigned to either
initial or target classes. As in the previous section, we
found that bulk regions exhibited the greatest percent
change in their energies (Figures 4A,F). Also in agree-
ment with the previous section, we found that the per-
cent change in a region’s energy was predicted by its total
Gki,kj
Gki,kj ) (Figure 4B,C,G,H). When the tar-
get class was suppressed, the correlation of communi-
cability and change in energy was r = 0.76(0.24) and
r = 0.38(0.36) for the remaining initial and bulk regions,
respectively. When the initial class was suppressed, the
correlation of communicability and change in energy was
r = 72(0.30) and r = 0.32(0.41) for the remaining tar-
get and bulk regions (Figure S4 for summary across all
participants).

kj∈xT

kj∈x0

Finally, we explored the consequences of simultane-
ously suppressing both initial and target regions, leav-
ing only the bulk as control points.
In the previous
sections if suppression was applied to initial or target
nodes, the remaining bulk could perform the same con-
trol task as the missing nodes. Here, however the bulk
was tasked with performing two duties: simultaneously
turning on and oﬀ target and initial regions, respectively.
The most energetic members of the bulk were those with
high levels of communicability to either initial or tar-
get regions, thereby aﬀording them the possibility of di-
rectly and indirectly controlling the states of those classes
(Figure 5A) (across participants, the correlation of Eki
kj∈{x0∪xT } Gki,kj , the communicability of region
ki to both initial and target regions, was r = 0.57(0.25)).
These results further suggest that bulk regions – those
not actively changing their own state during a control
task – nonetheless acted as compensators when other re-
gions become compromised.

and (cid:80)

We also were able to predict bulk regions whose energy
contributions increased by the greatest amount. As noted
earlier, the vector v(t) = xT − eAtx0 gives the Euclidean
distance in nodes’ states at time t with their respective

6

FIG. 4. Summary of initial or target class suppression. (A) Violin plot showing percent changes in energy %∆Eki,kj ,
for the remaining nodes after excluding all target nodes from the control set. (B,C) Scatterplot of the percent change of
region ki’s energy after suppressing all target nodes against ki’s communicability to all target nodes. (D,E) Distributions of
Pearson’s correlation coeﬃcients between change in energy and communicability, ˆrG,u, for initial and bulk nodes. Panels (F-J)
recapitulate (A-E) but with initial nodes excluded from the control set rather than target nodes.

calculated θ ∈ Rm×1 whose element θki =(cid:80)

target states. We hypothesized that the greater the dis-
tance a bulk region’s neighbors were from their target
states would be related to how much additional energy
that region would have to contribute. To this end, we
j Aki,j(cid:107)vj(cid:107)
gives the total distance of ki’s neighbors from their tar-
get states weighted by the strength of ki’s connection to
those nodes. We found that the logarithm of θki and Eki

were robustly negatively correlated across both partici-
pants and control tasks (r = −0.33(0.18)) (Figure 5B)
(Figure S5 for summary across all participants).

Collectively, the results reported in this section make
two important points. First, bulk regions – those not
changing their state from active to inactive (or vice versa)
– exhibited the greatest increase in energy following the
suppression of other regions, suggesting that these “by-

standers” may play important compensatory roles in the
control of brain dynamics. Secondly, in demonstrating
that brain region’s compensatory relationships are corre-
lated with their communicability, we implicate indirect
connections as important pathways through which com-
pensatory relationships emerge.

Optimal class assignments

In the previous section we explored the relationship of
control energy to network topology across a set of control
tasks involving transitions to and from pre-deﬁned states.
An alternative approach, is to identify initial and target
states so that the associated transition requires little en-
ergy. In this section we investigated such an approach.
Speciﬁcally, we identiﬁed assignments that minimized the
objective function, E = vT v, where v is deﬁned the same
way as before. We chose this particular objective func-
tion because it is highly correlated with control energy
(Figure S1) and also for computational ease, as it can be
calculated in a more straightforward manner than energy,
which requires ﬁrst deriving the optimal control signals.
We used a simulated annealing optimization algorithm
to minimize E and generate estimates of the probabil-
ity with which each brain region was assigned to initial,
target, and bulk classes. Across participants we found
that the probability of a region being assigned to either
the target and bulk classes was highly correlated with
its weighted degree (rtarget = 0.88(0.03) and rbulk =
−0.73(0.07); maximum p-value of p = 2.5× 10−16), while
the nodes assigned to the initial class were not closely
associated with weighted degree (r = −0.02(0.09); min-
imum p-value of p = 0.27). These results suggest that
highly and weakly connected regions are ideal targets and
bystanders, respectively.

What aspects of the network’s organization determines
class assignments? One possibility is that the low-energy
transitions facilitated by these assignments are merely a
consequence of the number and weight of connections a
brain region makes – i.e. they do not depend on the ac-
tual conﬁguration of a network’s connections. To test this
hypothesis, we randomized connection placement while
preserving the number of connections that each brain re-
gion makes (generating 100 random networks for each
participant) and evaluated the objective function for the
optimal class assignments given these networks. We ob-
served that across all class compositions the randomized
networks were associated with signiﬁcantly greater en-
ergies than the observed networks (non-parametric test,
max p < 1 × 10−15).

Rich club promotes low-energy transitions

The observation that highly-connected brain regions
make good targets and poor bystanders suggests that hub
regions and, perhaps, rich clubs play an important role

7

in facilitating low-energy control [37, 42]. Intuitively, a
rich club is a collection of hubs – highly connected, highly
central regions – that are more densely interconnected to
one another than expected. This type of organization is
thought to promote rapid transmission and integration of
information among brain regions [43]. Indeed, rich club
regions were more likely to be assigned to the optimal tar-
get state (Figure S6). The previous null model, wherein
all connections were randomized, tested the null hypoth-
esis that structureless networks could produce compara-
ble levels of energy. To test whether a network’s rich
club inﬂuences energy, we require a more subtle and spe-
ciﬁc null model. Moreover, a network’s rich club is a
pseudo-continuous structure and can be deﬁned at mul-
tiple resolutions. Our focus was on the neighborhood of
binary rich clubs identiﬁed at k = 84 – i.e. all brain
regions included in the rich club must have degree of at
least 84 – which corresponds to the maximum normal-
ized rich club coeﬃcient obtained across all participants
(Figure 6A). At this level, the most consistent rich club
regions across participants included subcortical regions
thalamus, caudate, putamem and hippocampus as well
as precuneus, isthmus cingulate, posterior cingulate, lat-
eral orbito-frontal, and insular cortex. These regions are
in close agreement with previously-described rich clubs
and hubs [1, 37, 42, 44, 45].

We implemented a null model where we rewired only
connections among rich club members (while preserving
degree) so that the density of connections among rich
club members was as low as possible. We observed that
as long as eight brain regions (the smallest increment
that we considered) were assigned as initially-active re-
gions, then rewiring connections to dissolve the rich club
alway yields increased energy (non-parametric test, max
p < 1 × 10−15), suggesting that the brain’s rich club,
speciﬁcally, supports low-energy transitions from a di-
verse set of initial states to a target state of high-strength
hub regions (we verify that this result holds for rich clubs
deﬁned at k = 80 to k = 88; Figure S7).

DISCUSSION

In this report we used network control theory to in-
vestigate the role of the brain’s anatomical network in
supporting transitions among diﬀerent brain systems. In
the ﬁrst section we focused on transitions among a pre-
deﬁned set of brain systems and demonstrated, in agree-
ment with earlier work, that brain regions with many
strong connections were associated with increased ener-
gies. We further demonstrated that when the control
set is perturbed, by suppressing control of both individ-
ual brain regions and entire classes, the remaining re-
gions compensate for the loss by increasing their own
energies. Moreover, we showed that the percent change
in a controller’s energy could be predicted by its com-
municability to the suppressed regions, highlighting the
role of indirect communication paths. In the second sec-

8

Eki , are strongly correlated with their communicability to the initial and target nodes,(cid:80)
θki = (cid:80)

FIG. 5. Summary of initial and target class suppression (A) Only bulk nodes are directly controlled. Their energies,
kj∈{x0∪xT } Gki,kj . (B) The percent
change in total energy going from the full control experiment to the no control experiment was negatively correlated with
j Aki,j(cid:107)vj(cid:107), or the weighted distance of controller ki’s neighbors from their respective target states relative to their
states under free evolution. (C) An illustrative example of the components that go into calculating θki . The blue and orange
bars represent the state of the system at times t = 0 and t = T . The blue bars indicate the activation of DMN nodes, in this
case, while the orange bars indicate activation of VIS nodes. The grey bars represent the state of the system at time t = T
under free evolution after starting in x0 = DM N . Finally, the black line is equal to v(t) = xT − x0, or the element-wise
diﬀerence between the orange and grey bars. (D,E) Distributions of Pearson’s correlation coeﬃcients from the best-ﬁt lines
shown in panels (A) and (B), respectively.

tion, we sought to objectively identify initial and target
states that could be transitioned to and from for little
energy. We found that the optimal initial states were di-
verse while the probability that a region was among the
target state was highly correlated with its weighted de-
gree. We showed that transitions among these optimal
class assignments were, in part, facilitated by the brain’s
rich club; when connections among rich club regions were
rewired, the energy associated with such transitions con-
sistently increased.

From descriptive to predictive network models.

The study of networked neural systems has advanced
rapidly in the past decade. While early analyses focused
on the topological properties of SC networks such as
their small-worldness [46, 47] or the presence of hubs,
rich clubs, and modules [1, 37], the focus of recent work
has shifted from static descriptions to dynamical systems
models, making it possible to investigate how network
topology shapes passive dynamics (i.e. no inputs) [19–
22]. The natural extension of these and other recent
studies is to incorporate exogenous input into the dy-
namical model. Such an extension makes it possible to
begin addressing questions related to the control of the

brain. At the level of large-scale human brain networks,
these theoretical questions are only now beginning to be
addressed [18, 35], though the utility of this approach is
obvious, showing promise in stimulation-based treatment
of epilepsy [27]. These ﬁrst studies contributed statistics
for characterizing the extent to which brain regions con-
tribute to making the entire state space accessible for a
network – i.e. rendering it controllable. The entire state
space, however, likely contains states that, for one reason
or another, should actively be avoided by the system. In
this present study we sought to characterize the energy
contributions of brain regions based on transitions among
a limited state space populated by seemingly neurophys-
iologically plausible states.

Structural predictors of the ease or diﬃculty of

control

The aim of this report was to shed light on the features
of a network’s topology that contribute to making a con-
trol task easier or diﬃcult. Toward this end we made a
number of contributions and novel observations. First,
we presented a classiﬁcation system of nodes for study-
ing speciﬁc control tasks. We showed that for the control
tasks we investigated, a node’s control energy is highly

9

FIG. 6. Rich club detection and optimal class assignments. (A) Class assignment probabilities as a function of the
logarithm of each brain region’s strength. (B) Normalized rich club coeﬃcient as a function of degree. Gray envelope represents
± one standard deviation. (C) Topographic distribution of rich club nodes and classiﬁcation of edges (top 5% for visualization)
as either “local” (links two non-rich club regions), “feeder” (links a rich club region to a non-rich club region), or “rich club”
(links a rich club region to another rich club region). The size of each node is proportional to its degree and the darkness of
each point indicates the likelihood, across participants, that that node was assigned to the k = 84 rich club. (D) Comparison
of energy with rich club intact (Erich) versus rewired rich club (Eno−rich). Each point (pie chart) represents a particular
composition of class assignments. The gray line indicates the “break-even” line – points along the line correspond to optimal
class assignments that have approximately equal average energy both with and without a rich club. Points above this line
indicate that rewiring the rich club leads to increased energy associated with the optimal class assignments.

correlated with its strength. The nature of this relation-
ship, however, depends critically on whether a node is
classiﬁed as part of the initial, target, or bulk set – the
energies of nodes that are initially active and later in-
active (initial) as well as nodes that, at the boundary
conditions of t = 0 and t = T , are inactive (bulk) main-
tain strong positive relationships with node strength; the
opposite is true for target nodes, which are negatively
correlated with node strength.

Under this framework, we explored a series of progres-
sively more diﬃcult control tasks in which we suppressed
speciﬁc subsets of nodes. This set of experiments high-
lighted the brain’s compensation network – a network
whose edge weights represent the percent change in a
node’s energy when other nodes are excluded from the
control set. We went on to show that communicability
between two nodes was highly correlated with their com-
pensation weight, which is interesting for several reasons.
Communicability measures the strength of direct and in-
direct connections between two nodes [48], which sug-
gests a possible functional role for multi-step pathways
in the human brain. Namely, that when a brain region’s
capacity for control is compromised – e.g. acute ischemic
stroke or electro-magnetic simulation – the regions that
“pick up the slack” and take on expanded control roles
include, as one might anticipate, those with direct con-
nections to the compromised region, but also those with
many indirect and potentially long-distance connections.
This observation serves as a potential mechanistic ac-
count of diaschiatic phenomena, where the eﬀect of a
focal lesion on brain function is observed some distance

from the lesion site [49–51]. Additionally, this observa-
tion is in line with recent work showing that including
multi-step pathways in predictive models of FC leads to
decreased error rates and improved predictions of resting
state functional connectivity [5, 7].

Interestingly, we observed that bulk regions exhibited
the greatest percent increase in their energy. This sug-
gests that regions not directly involved in a particular
control task actually play a disproportionately greater
compensatory role than those directly involved – i.e. ini-
tial and target regions. Intuitively, these results may pro-
vide a context to understand cognitive dysfunction ob-
served in neurological conditions that involve region dam-
age or loss, such as traumatic brain injury or Alzheimer’s
disease. From a control theoretic perspective, as brain re-
gions suﬀer damage, the increased burden to bulk nodes
for multiple control tasks may interfere with one an-
other. Bulk regions may become sites of processing in-
terference due to competition between new compensatory
roles. This increased competition between control tasks
could have implications for the consequences of brain in-
jury and neurodegeneration over longer timescales [52].
In particular, increased processing burdens may result in
later deleterious eﬀects on regions that assume a dispro-
portionate share of compensatory burdens [53], resulting
in a cascade of later failures across the brain.

Regional suppression is also relevant to models of con-
ﬂict processing and the cognitive eﬀort expended in doing
so [54]. In such models, computational executive control
mechanisms can be deployed for a limited number of si-
multaneous tasks, resulting in opportunity costs. With

increased opportunity costs comes the phenomenology of
eﬀort (motivation, fatigue, boredom), which, in turn, al-
ters the control mechanisms. In the context of our control
theoretic view of task control, as node suppression in-
troduces potential conﬂicts between control tasks among
bulk regions, we might expect increases in perceived ef-
fort, diﬃculty managing sustained tasks or task switches,
and negative consequences for task performance in a va-
riety of disorders and tasks with control demands. Fu-
ture studies could test this prediction by mapping the
cognitive diﬃculties and perceived eﬀort that arise from
conﬂicting control demands following real region damage
or following non-invasive temporary suppression. Specif-
ically, we would expect that cognitive performance would
be low and perceived eﬀort high in general in individuals
where a relatively small set of bulk regions assume a rela-
tively high set of compensatory roles across control tasks.
Thus, our control theoretic approach may provide a prac-
tical means to quantify eﬀort and processing conﬂicts in
health and disease.

The rich club as control backbone

Whereas we have approached control from an engineer-
ing perspective, in cognitive neuroscience the term con-
trol refers to a set of processes, which include memory
and attentional systems, for guiding behavior towards a
particular goal [55, 56]. Control is thought to be instan-
tiated via an anatomical substrate consisting of cortical
[57] and sub-cortical areas [57] acting largely through in-
hibitory mechanisms. An important question concerns
how this neuro-mechanistic account of control interfaces
with current theories on the role of brain connectivity
in normative brain function and to what extent it is re-
lated to the engineering-focused approach adopted here.
In the second section we identiﬁed brain regions that act,
in an objective sense as optimal initial, target, and bulk
classes for control. We showed that the probability of
a region being classiﬁed as target or bulk was closely
related to its strength, with high and low strength re-
gions more likely to be classiﬁed as targets and bulk,
respectively. The initial class, on the other hand, had a
more diverse constituency and was not obviously related
to strength. We went on to show that the energies as-
sociated with these class assignments were much lower
than those obtained from degree-preserved random net-
works, indicating that the class assignments were driven
by some non-trivial aspect of the network’s topology. We
further showed that when the brain’s rich club was dis-
solved the energy associated with these optimal assign-
ments increased, suggesting that the rich club contributes
in facilitating low-energy transitions from among a di-
verse set of initial states to target states composed of
high-strength, high-degree rich club regions.

The rich club is typically thought of as an integra-
tive backbone that allows hub regions to communicate
with one another, facilitating rapid communication and

10

transmission of signals across the entire brain [43, 58, 59].
Despite this supposition, there is some controversy as to
the rich club’s precise role in network communication,
with some indication that rich club hubs are primarily
drivers of network dynamics – acting in a top-down fash-
ion to inﬂuence diﬀerent sub-systems [60–62]. On the
other hand, rich club regions are highly connected to the
rest of the network and, by this virtue, are not only in
a position to inﬂuence their neighbors, but also to be in-
ﬂuenced by their neighbors. Indeed, computational mod-
els suggest that rich clubs adopt stable, regular behavior
as a consequence of receiving input from a multitude of
sources [63]. Our results agree with this latter account
in some respects. We observed that high-degree, rich
club regions are best suited for roles as targets that can
be transitioned into from a diverse set of initial states.
Part of why rich club regions are so successful in this re-
spect is by virtue of their many connections – no matter
where input is injected into the system, there is a high
probability that the signal will propagate from its source
to activate regions in the rich club, suggesting a possible
explanation for why rich club regions, which overlap con-
siderably with the brain’s default mode network, tend to
be active in the default mode of resting state function
[62]. More relevant to the present discussion, this also
suggests that under certain conditions the rich club (or
at least highly connected regions) may be in a better po-
sition to be indirectly controlled than weakly connected
regions on the network periphery.

Methodological considerations

Several important methodological considerations are
pertinent to this work. First, we relied on diﬀusion
spectrum imaging and tractography to infer the pres-
ence of large-scale ﬁber tracts in participants’ brains.
These methodologies are imperfect and can detect spuri-
ous tracts or fail to detect existing tracts [64, 65]. How-
ever, at present there exist no other non-invasive meth-
ods for reconstructing human structural connectivity net-
works. Future work will likely address these shortcom-
ings by introducing improved tractography algorithms
and imaging techniques [66].

Another important consideration is our use of a linear
dynamical model despite the fact that, by most accounts,
brain activity is fundamentally non-linear [6]. Our jus-
tiﬁcation for using such dynamics is twofold. First, the
emphasis of this paper is on the role that the brain’s
structural connectivity network plays in control. While
the form of dynamics certainly contributes to making a
system controllable or not, we focus primarily on the con-
tribution of the network’s topology. Secondly, a linear
dynamics is in line with other papers that investigate
control theory with an emphasis on topology [24, 29, 67].
Moreover, describing non-linear systems in terms of a lin-
ear approximation in the neighborhood of its equilibrium
points is common [68], and makes it possible to apply lin-

ear control to otherwise intractable systems.

A ﬁnal limitation is the form of the communicabil-
ity measure, which (when applied to a binary networks)
weighs longer paths exponentially less than shorter paths.
While this standard form appears suﬃcient for our pur-
poses here, alternative weighting schemes may provide
additional insight in the role of multi-step paths on net-
work control.

Conclusion

Understanding how control occurs in the brain, and
how we can use external interventions to aﬀect that con-
trol, has broad implications across the cognitive and clini-
cal neurosciences. By examining control strategies imple-
mented in ﬁnite time and with limited energy, we were
able to uncover fundamental principles of brain struc-
ture that impact the ease or diﬃculty of control tasks
informed by the systems known to perform diverse cog-
nitive functions. It is intuitively plausible that these prin-
ciples may be altered by psychiatric disease and neuro-
logical disorders, via a change in underlying structural
connectivity. In future, it will be interesting to under-
stand how individual diﬀerences in brain structure af-
fect individual diﬀerences in the natural implementation
of control (e.g., cognitive control) and resulting behav-
ior in executive domains. Moreover, it will be interest-
ing to understand how these individual diﬀerences might
also directly aﬀect susceptibility and response to exter-
nal interventions via invasive or non-invasive neuromod-
ulation. Such an understanding would provide critical
groundwork for personalized medicine.

11

ues are used to warp the brain to a template QA vol-
ume in Montreal Neurological Institute (MNI) space us-
ing the statistical parametric mapping (SPM) nonlinear
registration algorithm. Once in MNI space, spin density
functions were again reconstructed with a mean diﬀusion
distance of 1.25 mm using three ﬁber orientations per
voxel. Fiber tracking was performed in DSI studio with
an angular cutoﬀ of 55◦, step size of 1.0 mm, minimum
length of 10 mm, spin density function smoothing of 0.0,
maximum length of 400 mm and a QA threshold deter-
mined by DWI signal in the colony-stimulating factor.
Deterministic ﬁber tracking using a modiﬁed FACT al-
gorithm was performed until 1,000,000 streamlines were
reconstructed for each individual.

Anatomical scans were segmented using FreeSurfer59
and parcellated using the connectome mapping toolkit
[70]. A parcellation scheme including n = 129 regions
was registered to the B0 volume from each subject’s DSI
data. The B0 to MNI voxel mapping produced via QSDR
was used to map region labels from native space to MNI
coordinates. To extend region labels through the grey-
white matter interface, the atlas was dilated by 4 mm
[71]. Dilation was accomplished by ﬁlling non-labelled
voxels with the statistical mode of their neighbors’ la-
bels. In the event of a tie, one of the modes was arbitrar-
ily selected. Each streamline was labelled according to its
terminal region pair. From these data, we constructed a
structural connectivity matrix, A whose element Aij rep-
resented the number of streamlines connecting diﬀerent
regions, divided by the sum of volumes for regions i and
j.

MATERIALS AND METHODS

Data acquisition and processing

Cognitive systems

Diﬀusion spectrum images (DSI) were acquired for a
total of 30 subjects along with a T1-weighted anatomi-
cal scan at each scanning session. We followed a parallel
strategy for data acquisition and construction of stream-
line adjacency matrices as in previous work [35]. DSI
scans sampled 257 directions using a Q5 half-shell acqui-
sition scheme with a maximum b-value of 5,000 and an
isotropic voxel size of 2.4 mm. We utilized an axial ac-
quisition with the following parameters: repetition time
(TR) = 5 s, echo time (TE)= 138 ms, 52 slices, ﬁeld of
view (FoV) (231, 231, 125 mm). All participants volun-
teered with informed consent in accordance with the In-
stitutional Review Board/Human Subjects Committee,
University of Pennsylvania.

DSI data were reconstructed in DSI Studio (www.dsi-
studio.labsolver.org) using q-space diﬀeomorphic recon-
struction (QSDR)[69]. QSDR ﬁrst reconstructs diﬀusion-
weighted images in native space and computes the quan-
titative anisotropy (QA) in each voxel. These QA val-

The human brain can also be studied as a network of
functional connections. Functional connectivity networks
are modular, which means that they can be partitioned
into non-overlapping sub-systems [36, 72, 73]. These sub-
systems are referred to as intrinsic connectivity networks
(ICNs) and have distinct cognitive and behavioral ﬁnger-
prints [74, 75]. The ICN deﬁnition used here was based
on the canonical systems deﬁned in [36], and included
default mode (DMN), control (CONT), dorsal attention
(DAN), saliency/ventral attention (SAL/VAN), somato-
motor (SM), visual (VIS), limbic (LIM), and sub-cortical
(SUB) systems. In order to assign each region of interest
to a single system, we mapped both atlases to a common
surface template (fsaverage) and calculated the overlap
(number of common vertices) of each region of interest
with each of the seven ICNs. A region’s ICN assignment
was deﬁned as the system with which it overlapped to
the greatest extent (Figure S9).

Control tasks

We considered transitions from an initial state, x0, to
a target state, xT , where T = 1 is the control horizon.
We chose this particular horizon in order to ensure that
the system has time to evolve from its initial state (and
thereby require some corrective input signals) but also
not to be trivially long.
Initial and target states were
selected correspond to speciﬁc cognitive systems. For ex-
ample, one possible control task was to start in a state
where the default mode network (DMN) was maximally
active, and to transition to a state where the visual sys-
tem (VIS) becomes maximally active. Intuitively, such
a transition might correspond to the presentation of a
visual stimulus at rest, eliciting activation of visual cor-
tex while suppressing activation of the default mode sys-
tem.
In this context, the control question one asks is
which nodes play a role in the minimum energy trajec-
tory between these states. We modeled this control task
by starting DMN regions in an active state at t = 0:

Similarly, when t = T , only visual regions were in an
active state:

(cid:40)

(cid:40)

xi(t = 0) =

if i /∈ DMN
if i ∈ DMN.

0,
1,

xi(t = T ) =

if i /∈ VIS
if i ∈ VIS.

0,
1,

Given these boundary conditions, we calculated the op-
timal inputs, u∗
K(t) to eﬀect the transition from speciﬁed
initial state to speciﬁed target state.
In general, state
vectors at other times can take on any real value. Though
we considered this limited set of states, the linear model
of brain dynamics means that any transition can be writ-
ten as a linear combination of the transitions we studied
here.

Network communicability

[41], G ∈ Rn×n, whose element Gij = (cid:80)∞

The adjacency matrix, A, encodes a network’s direct
connections. In addition, communication between pairs
of nodes can also take advantage of indirect connections.
To quantify the extent to which nodes are connected in-
directly, one can calculate the communicability matrix
k! )ij =
(eA)ij. The element Gij, then, represents the weighted
sum of walks of all lengths. The k! in the denomina-
tor means that longer walks contribute disproportion-
ately less compared to shorter walks. Communicabil-
ity has been generalized to weighted networks, such as
those considered here [76]. Speciﬁcally, Gw
ij , where
2 and D ∈ Rn×n is the square matrix
A(cid:48) = D− 1

ij = eA(cid:48)

2 AD− 1

k=0( Ak

whose diagonal elements Dii =(cid:80)

j Aij. Communicabil-
ity is also related to the linear dynamics we study here.
Solving (1) for the special case where there is no input,
the evolution of the system is described by the matrix
exponential of the connectivity matrix.

12

Optimal class assignments and simulated annealing

One of the aims of this paper was to identify objec-
tively optimal initial and target class assignments. Be-
cause we did not know, a priori, the number of nodes that
should be assigned to either class, we treated the num-
ber of nodes assigned to each class as a free parameter.
Our investigation of this parameter space involved ﬁxing
the number of bulk nodes (48, 56, 64, 72, 80, 88, 96, 104)
and, of the remaining nodes, splitting them among initial
and target classes in diﬀerent proportions. For example,
with 56 bulk nodes, the remaining 72 nodes were split
among initial/target class in proportions of 8/64, 16/56,
24/48, 36/36, 48/24, 56/16, and 64/8. This division lead
to 44 distinct class compositions. For each composition
we used a simulated annealing algorithm to gradually
reduce E and obtain estimates of the optimal class as-
signments. We ran the annealing algorithm 50 times for
each composition. Each annealing run consisted of 100
stages. During each stage, the temperature, τ , was ﬁxed
at a particular value and we performed 5000 iterations,
where an iteration consisted of selecting two nodes of op-
posite classes at random and swapping their class assign-
ments, after which we recalculated E(cid:48). If E(cid:48) < E or with
probability P r = e
τ we retained the new assignments
for the next iteration. For all runs we used a starting
temperature of τ0 = 1 which we decreased by 0.925 with
each stage so that by the ﬁnal stage the temperature was
τ ≈ 4.11× 10−4. During each annealing run, we retained
all unique class assignments. After the algorithm ter-
minated, we retained the 100 unique assignments with
lowest energies for further analysis.

E(cid:48)−E

Rich club detection

2E>k

A rich club refers to a subset of nodes, all of degree
≥ k, that are densely connected to one another [77, 78].
The density of any such subset is summarized by its rich
club coeﬃcient: φ(k) =
N>k(N>k−1) . We calculated φ(k)
for all possible values of k across all participants and
subsequently normalized rich club coeﬃcients by compar-
ing them against the distribution of coeﬃcients obtained
from an ensemble of randomized networks (preserved de-
gree sequence) [79]. It is sometimes the case that there
is no single rich club – there may be many statistically
signiﬁcant rich clubs spanning a range of k [37]. For
ease of description, however, we focus on the rich club
detected at k = 84, which corresponds to the greatest
value of φnorm averaged across participants (Figure 6A).
We explore the consistency of this rich club in Figure S7.

Acknowledgements. This work was supported from
the John D. and Catherine T. MacArthur Foundation,
the Alfred P. Sloan Foundation, the Army Research
Laboratory and the Army Research Oﬃce through con-
tract numbers W911NF-10-2-0022 and W911NF-14-1-
0679, the National Institute of Mental Health (2-R01-
DC-009209-11), the National Institute of Child Health
and Human Development (1R01HD086888-01), the Of-
ﬁce of Naval Research, and the National Science Founda-
tion (BCS-1441502 and BCS-1430087). FP acknowledges
support from BCS-1430280. JDM acknowledges support
from the Oﬃce of the Director at the National Institutes
of Health (1DP5OD021352-01).

(cid:20) A −(2ρ)−1BBT

˜A =

−2I

−AT

˜x =

(cid:21)

(cid:20)x∗
(cid:20)0
(cid:21)

p∗

˜b =

2xT

I

(cid:21)

13

(A.6)

(A.7)

(A.8)

then we can then write the reduced equation as:

Appendix: Optimal control

˙˜x = ˜A˜x + ˜b

(A.9)

There can be an inﬁnite number of inputs, uK, for driv-
ing a system from x0 to xT . We wish to ﬁnd the inputs
corresponding to the following minimization problem:

which we can solve as:

˜x(t) = e

˜At ˜x(0) +

(cid:90) t

0

[eA(t−τ ) ˜b]dτ

(A.10)

(cid:90) T

min

u

0

(xT − x)T (xT − x) + ρuTKuK.

(A.1)

or, alternatively

Here, ρ ∈ R>0 is a free parameter that scales the relative
importance of the ﬁrst term to the second term in the
integral. We set ρ = 100. To identify the optimal inputs,
uK, we deﬁne the Hamiltonian:

˜x(t) = e

˜At ˜x(0) + A−1(eAt − I)˜b.

(A.11)

Then, substituting t = T , we arrive at:

H(p, x, u, t) = xT x + ρuTKuK + p(Ax + BKu).

(A.2)

In this expression A is a scaled version of the weighted
connectivity matrix. Speciﬁcally, we divide the original
matrix by its largest eigenvalue and subtract 1 from all
diagonal elements. This eﬀectively ensures that all eigen-
values are less than zero and renders the system stable.
From the Pontryagin minimization principle, if u∗
K is an
optimal solution to the minimization problem with cor-
responding trajectory, x∗, then there exists p∗ such that:

˜x(T ) = e

˜AT ˜x(0) + A−1(eAT − I)˜b.

(A.12)

Let

c = A−1(eAT − I)˜b.

(A.13)

We can then write:

(cid:21)

(cid:20)x∗(T )

p∗(T )

=

(cid:20)E11 E12

E21 E22

(cid:21)(cid:20)x∗(0)

(cid:21)

p∗(0)

(cid:21)

(cid:20)c1

c2

+

(A.14)

= −2(xT − x∗) + AT p∗ = ˙p∗

(A.3)

∂H
∂x

Rewriting this, we get:

= 2ρu∗

∂H
∂x

This set of equations reduces to:

(cid:21)

(cid:20) ˙x∗

˙p∗

(cid:20) A −(2ρ)−1BBT

=

−2I

−AT

K + BTKp∗ = 0.
(cid:21)

(cid:21)(cid:20)x∗

p∗

+

(cid:20)0
(cid:21)

I

.
If we denote:

(A.4)

x∗(T ) = E11x∗(0) + E12p∗(0) + c1

(A.15)

which can be rearranged to write:

2xT

(A.5)

p∗(0) = E−1

12 [x∗(T ) − E11x∗(0) − c1]

(A.16)
Given p∗(0) and x0, we can then integrate ˜x forward,
thereby obtaining xT from which we subsequently obtain
the optimal inputs, u∗
K.

14

[1] P. Hagmann, L. Cammoun, X. Gigandet, R. Meuli, C. J.
Honey, V. J. Wedeen, and O. Sporns, PLoS Biol 6, e159
(2008).

[2] C. Honey, O. Sporns, L. Cammoun, X. Gigandet, J.-P.
Thiran, R. Meuli, and P. Hagmann, Proceedings of the
National Academy of Sciences 106, 2035 (2009).

[3] A. M. Hermundstad, D. S. Bassett, K. S. Brown, E. M.
Aminoﬀ, D. Clewett, S. Freeman, A. Frithsen, A. John-
son, C. M. Tipper, M. B. Miller, et al., Proceedings of
the National Academy of Sciences 110, 6169 (2013).

[24] Y.-Y. Liu, J.-J. Slotine, and A.-L. Barab´asi, Nature 473,

167 (2011).

[25] J. Sun and A. E. Motter, Physical Review Letters 110,

208701 (2013).

[26] B. Rosin, M. Slovik, R. Mitelman, M. Rivlin-Etzion, S. N.
Haber, Z. Israel, E. Vaadia, and H. Bergman, Neuron 72,
370 (2011).

[27] P. N. Taylor, J. Thomas, N. Sinha, J. Dauwels, M. Kaiser,
T. Thesen, and J. Ruths, Frontiers in Neuroscience 9,
202 (2015).

[4] S. Atasoy, I. Donnelly, and J. Pearson, Nature Commu-

[28] M. D. Fox, M. A. Halko, M. C. Eldaief, and A. Pascual-

nications 7 (2016).

[5] C. O. Becker, S. Pequito, G. J. Pappas, M. B. Miller,
S. T. Grafton, D. S. Bassett, and V. M. Preciado, arXiv
preprint arXiv:1512.02602 (2015).

Leone, Neuroimage 62, 2232 (2012).

[29] G. Yan, J. Ren, Y.-C. Lai, C.-H. Lai, and B. Li, Physical

review letters 108, 218703 (2012).

[30] W.-X. Wang, X. Ni, Y.-C. Lai, and C. Grebogi, Physical

[6] G. Deco, V. K. Jirsa, and A. R. McIntosh, Nature Re-

Review E 85, 026115 (2012).

views Neuroscience 12, 43 (2011).

[7] J. Go˜ni, M. P. van den Heuvel, A. Avena-Koenigsberger,
N. V. de Mendizabal, R. F. Betzel, A. Griﬀa, P. Hag-
mann, B. Corominas-Murtra, J.-P. Thiran,
and
O. Sporns, Proceedings of the National Academy of Sci-
ences 111, 833 (2014).

[8] E. A. Allen, E. Damaraju, S. M. Plis, E. B. Erhardt,
T. Eichele, and V. D. Calhoun, Cerebral cortex , bhs352
(2012).

[9] F. I. Karahano˘glu and D. Van De Ville, Nature commu-

nications 6 (2015).

[10] R. F. Betzel, M. Fukushima, Y. He, X.-N. Zuo,

and

O. Sporns, NeuroImage 127, 287 (2016).

[11] D. S. Bassett, N. F. Wymbs, M. A. Porter, P. J. Mucha,
J. M. Carlson, and S. T. Grafton, Proceedings of the
National Academy of Sciences 108, 7641 (2011).

[12] U. Braun, A. Sch¨afer, H. Walter, S. Erk, N. Romanczuk-
Seiferth, L. Haddad, J. I. Schweiger, O. Grimm, A. Heinz,
H. Tost, et al., Proceedings of the National Academy of
Sciences 112, 11678 (2015).

[13] M. G. Mattar, M. W. Cole, S. L. Thompson-Schill, and
D. S. Bassett, PLoS Comput Biol 11, e1004533 (2015).
[14] H. R. Wilson and J. D. Cowan, Biophysical journal 12,

[31] N. J. Cowan, E. J. Chastain, D. A. Vilhena, J. S.
Freudenberg, and C. T. Bergstrom, PloS one 7, e38398
(2012).

[32] M. P´osfai, Y.-Y. Liu, J.-J. Slotine, and A.-L. Barab´asi,

Scientiﬁc reports 3 (2013).

[33] J. Ruths and D. Ruths, Science 343, 1373 (2014).
[34] F. Pasqualetti, S. Zampieri, and F. Bullo, Control of

Network Systems, IEEE Transactions on 1, 40 (2014).

[35] S. Gu, F. Pasqualetti, M. Cieslak, Q. K. Telesford, B. Y.
Alfred, A. E. Kahn, J. D. Medaglia, J. M. Vettel, M. B.
Miller, S. T. Grafton, et al., Nature communications 6
(2015).

[36] B. T. Yeo, F. M. Krienen, J. Sepulcre, M. R. Sabuncu,
D. Lashkari, M. Hollinshead, J. L. Roﬀman, J. W.
Smoller, L. Z¨ollei, J. R. Polimeni, et al., Journal of neu-
rophysiology 106, 1125 (2011).

[37] M. P. van den Heuvel and O. Sporns, The Journal of

neuroscience 31, 15775 (2011).

[38] C. T. Lin, Automatic Control, IEEE Transactions on 19,

201 (1974).

[39] A. Pascual-Leone, V. Walsh, and J. Rothwell, Current

opinion in neurobiology 10, 232 (2000).

[40] J. Silvanto and N. G. Muggleton, Neuroimage 39, 549

1 (1972).

(2008).

[15] G. Deco, V. K. Jirsa, P. A. Robinson, M. Breakspear,
and K. Friston, PLoS Comput. Biol 4, e1000092 (2008).
[16] A. C. Marreiros, S. J. Kiebel, and K. J. Friston, Neu-

[41] E. Estrada and N. Hatano, Physical Review E 77, 036111

(2008).

[42] M. P. van den Heuvel and O. Sporns, Trends in cognitive

roimage 51, 91 (2010).

sciences 17, 683 (2013).

[17] F. Freyer, J. A. Roberts, R. Becker, P. A. Robinson,
P. Ritter, and M. Breakspear, The Journal of Neuro-
science 31, 6353 (2011).

[18] S. F. Muldoon, F. Pasqualetti, S. Gu, M. Cieslak, S. T.
Grafton, J. M. Vettel, and D. S. Bassett, arXiv preprint
arXiv:1601.00987 (2016).

[19] M. Breakspear, S. Heitmann, and A. Daﬀertshofer, Fron-

tiers in human neuroscience 4 (2010).

[43] M. P. van den Heuvel, R. S. Kahn, J. Go˜ni,

and
O. Sporns, Proceedings of the National Academy of Sci-
ences 109, 11372 (2012).

[44] R. F. Betzel, L. Byrge, Y. He, J. Go˜ni, X.-N. Zuo, and

O. Sporns, Neuroimage 102, 345 (2014).

[45] N. A. Crossley, A. Mechelli, J. Scott, F. Carletti, P. T.
Fox, P. McGuire, and E. T. Bullmore, Brain 137, 2382
(2014).

[20] A. Haimovici, E. Tagliazucchi, P. Balenzuela, and D. R.

[46] Y.

Chialvo, Physical review letters 110, 178101 (2013).

[21] F. Abdelnour, H. U. Voss, and A. Raj, Neuroimage 90,

335 (2014).

[22] B. Miˇsic, R. F. Betzel, A. Nematzadeh, J. Go˜ni, A. Griﬀa,
P. Hagmann, A. Flammini, Y.-Y. Ahn, and O. Sporns,
Neuron 86, 1518 (2015).

[23] R. E. Kalman, Journal of the Society for Industrial &

Applied Mathematics, Series A: Control 1, 152 (1963).

Iturria-Medina, R. C. Sotero, E. J. Canales-
and L. Melie-Garc´ıa,

Rodr´ıguez, Y. Alem´an-G´omez,
Neuroimage 40, 1064 (2008).

[47] G. Gong, Y. He, L. Concha, C. Lebel, D. W. Gross, A. C.
Evans, and C. Beaulieu, Cerebral cortex 19, 524 (2009).
[48] E. Estrada, N. Hatano, and M. Benzi, Physics reports

514, 89 (2012).

[49] C. Grefkes and G. R. Fink, Brain , awr033 (2011).
[50] E. Carrera and G. Tononi, Brain , awu101 (2014).

[78] J. J. McAuley, L. da Fontoura Costa, and T. S. Caetano,

Applied Physics Letters 91, 084103 (2007).

[79] S. Maslov and K. Sneppen, Science 296, 910 (2002).

15

[51] J. J. Crofts, D. J. Higham, R. Bosnell, S. Jbabdi, P. M.
Matthews, T. Behrens, and H. Johansen-Berg, Neuroim-
age 54, 161 (2011).

[52] T. M. Sivanandam and M. K. Thakur, Neuroscience &

Biobehavioral Reviews 36, 1376 (2012).

[53] C. J. Stam, Nature Reviews Neuroscience 15, 683 (2014).
[54] R. Kurzban, A. Duckworth, J. W. Kable, and J. Myers,

Behavioral and Brain Sciences 36, 661 (2013).

[55] W. Schneider and R. M. Shiﬀrin, Psychological review

84, 1 (1977).

[56] D. A. Norman and T. Shallice, Attention to action

(Springer, 1986).

[57] E. K. Miller and J. D. Cohen, Annual review of neuro-

science 24, 167 (2001).

[58] M. Senden, G. Deco, M. A. de Reus, R. Goebel, and

M. P. van den Heuvel, Neuroimage 96, 174 (2014).

[59] G. Collin, O. Sporns, R. C. Mandl, and M. P. van den

Heuvel, Cerebral cortex 24, 2258 (2014).

[60] L. Harriger, M. P. Van Den Heuvel, and O. Sporns, PloS

one 7, e46497 (2012).

[61] E. K. Towlson, P. E. V´ertes, S. E. Ahnert, W. R. Schafer,
and E. T. Bullmore, The Journal of Neuroscience 33,
6380 (2013).

[62] M. P. van den Heuvel and O. Sporns, The Journal of

neuroscience 33, 14489 (2013).

[63] L. L. Gollo, A. Zalesky, R. M. Hutchison, M. van den
Heuvel, and M. Breakspear, Philosophical Transactions
of the Royal Society of London B: Biological Sciences
370, 20140165 (2015).

[64] C. Thomas, Q. Y. Frank, M. O. Irfanoglu, P. Modi, K. S.
Saleem, D. A. Leopold, and C. Pierpaoli, Proceedings of
the National Academy of Sciences 111, 16574 (2014).

[65] C. Reveley, A. K. Seth, C. Pierpaoli, A. C. Silva, D. Yu,
R. C. Saunders, D. A. Leopold, and Q. Y. Frank, Pro-
ceedings of the National Academy of Sciences 112, E2820
(2015).

[66] F. Pestilli, J. D. Yeatman, A. Rokem, K. N. Kay, and

B. A. Wandell, Nature methods 11, 1058 (2014).

[67] F.-J. M¨uller and A. Schuppert, Nature 478, E4 (2011).
[68] D. Luenberger, (1979).
[69] F.-C. Yeh, V. J. Wedeen, and W.-Y. I. Tseng, Neuroim-

age 55, 1054 (2011).

[70] L. Cammoun, X. Gigandet, D. Meskaldji, J. P. Thiran,
O. Sporns, K. Q. Do, P. Maeder, R. Meuli, and P. Hag-
mann, Journal of neuroscience methods 203, 386 (2012).
[71] M. Cieslak and S. Grafton, Brain imaging and behavior

8, 292 (2014).

[72] J. D. Power, A. L. Cohen, S. M. Nelson, G. S. Wig, K. A.
Barnes, J. A. Church, A. C. Vogel, T. O. Laumann, F. M.
Miezin, B. L. Schlaggar, et al., Neuron 72, 665 (2011).

[73] O. Sporns and R. F. Betzel, Annual review of psychology

67 (2015).

[74] S. M. Smith, P. T. Fox, K. L. Miller, D. C. Glahn, P. M.
Fox, C. E. Mackay, N. Filippini, K. E. Watkins, R. Toro,
A. R. Laird, et al., Proceedings of the National Academy
of Sciences 106, 13040 (2009).

[75] N. A. Crossley, A. Mechelli, P. E. V´ertes, T. T. Winton-
Brown, A. X. Patel, C. E. Ginestet, P. McGuire, and
E. T. Bullmore, Proceedings of the National Academy of
Sciences 110, 11583 (2013).

[76] J. J. Crofts and D. J. Higham, Journal of the Royal So-

ciety Interface , rsif (2009).

[77] V. Colizza, A. Flammini, M. A. Serrano, and A. Vespig-

nani, Nature physics 2, 110 (2006).

16

FIG. S1. Distance from target is correlated with con-
trol energy. We generated 1000 random initial and target
states and calculated both the total control energy, E, asso-
ciated with the control task as well as the distance that the
system would be from its target state given that it started in
the initial state and evolved with no exogenous input, (cid:107)v(cid:107). In
calculating E we assumed that all nodes were directly con-
trolled. (A) Scatterplot of the raw log10 E against (cid:107)v(cid:107). (B)
Scatterplot of ranked log10 E against (cid:107)v(cid:107).

17

FIG. S2. Summary of full control across all partici-
pants. In the main text we demonstrated that control en-
ergy was predicted by weighted degree (strength). Here we
show that this same general pattern holds across all 30 partic-
ipants. We show, here, for all three classes – (A) initial, (B)
target, and (C) bulk – the distribution of correlation coeﬃ-
cients (logarithm weighted degree versus logarithm energy)
obtained across all control tasks.

18

FIG. S3. Summary of single-region suppression across
all participants.
In the main text we demonstrated that
communicability between two regions predicted the extent to
which either region compensated for the suppression of the
other. We show, here, for all three classes – (A) initial, (B)
target, and (C) bulk – the distribution of correlation coef-
ﬁcients (communicability versus percent change in energy)
obtained across all control tasks.

19

FIG. S4. Summary of initial or target class suppression
across all participants. In the main text we demonstrated
that suppressing entire classes of brain regions (either initial
or target classes) led to compensatory responses from the re-
maining brain regions. Moreover, we demonstrated that the
percent change in energy of the remaining regions was closely
predicted by their communicability to the suppressed class.
Here, we show that this eﬀect is consistent across all par-
ticipants. Panels (A) and (B) show the distribution of cor-
relation coeﬃcients (communicability to initial class regions
versus percent change in energy) obtained for target and bulk
regions when we suppressed the initial class. Panels (C) and
(D) show the same correlation coeﬃcients but for initial and
bulk classes when the target regions were suppressed.

20

FIG. S5. Summary of initial and target class sup-
pression across all participants.
In the main text we
demonstrated that suppressing entire classes of brain regions
(both initial or target classes) led to compensatory responses
from the remaining brain regions. We showed that the en-
ergy associated with the remaining regions was proportional
to their communicability to both suppressed classes and that
their percent change in energy was related to how far their
connected neighbors were from their desired state under free
evolution. Here, we recapitulate those results for each partic-
ipant. Panel (A) shows the distribution of correlation coef-
ﬁcients (energy versus communicability to initial and target
classes) across all control tasks for each participant. Panel (B)
shows the distribution of correlation coeﬃcients (distance of
neighbors from desired state versus percent change in energy).

21

FIG. S6. Class assignments by brain system and rich
club. We aggregate class assignment probabilities according
to brain system – panels (A),(C),(E) – and whether or those
regions were assigned to the rich club at k = 84 – panels
(B),(D),(F). Each row represents a diﬀerent node class: tar-
get (xT ), initial (x0), and bulk classes. The probability of
being assigned to the target class was statistically greater for
rich club regions compared to non-rich club regions in 27/30
participants compared to 13/30 and 9/30 for bulk and initial
classes, respectively (p < 0.05; Bonferroni corrected).

FIG. S7. Consistency of rich club. In the main text we focus on the rich club deﬁned at k = 84, shown in (A). In (B) we
show that the composition of the rich club over the range k = 81 to k = 88 is, generally, consistent. Each row represents a
brain region and each column a diﬀerent value of k. The color of each cell represents the fraction of participants for which a
brain region was assigned to the rich club at a given k.

22

FIG. S8. Eﬀect of rich club rewiring on energy.
In
the main text we focus on the rich club deﬁned at k = 84,
demonstrating that when rich club connections were rewired
the energy associated with transitioning from the optimal ini-
tial class to the optimal target class increased. Here we show
the robustness of that result with respect to variation in the
level at which the rich club was deﬁned. Each plot shows a
diﬀerent rich club, ranging from k = 80 to k = 88. The y-axis
shows the number of nodes assigned to the bulk class and the
x-axis shows the number of nodes assigned to the initial class.
Not shown is the number of target nodes, which can be cal-
culated as N − |bulk| − |x0|. Gray cells correspond to class
compositions that were not possible. The remaining cells dis-
play the probability that rewiring rich club connections will
reduce energy, averaged across all participants.

23

Topographic
FIG. S9. Brain system assignments.
distributions of eight brain systems: Visual system (VIS;
dark purple), somatomotor network (SMN; blue), default
limbic system (LIM; cream),
mode network (DMN; red),
saliency/ventral attention network (SAL/VEN;
light pur-
ple), dorsal attention network (DAN; green), control network
(CONT; orange), and subcortex (SUB; slate).

