6
1
0
2

 
r
a

 

M
5
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
0
2
9
4
0

.

3
0
6
1
:
v
i
X
r
a

TEMPORAL UPSCALING IN MICRO MAGNETISM VIA

HETEROGENEOUS MULTISCALE METHODS

DOGHONAY ARJMAND, STEFAN ENGBLOM, AND GUNILLA KREISS

Abstract. We consider a multiscale strategy addressing the disparate tem-
poral scales in the Landau-Lifschitz equations of micro-magnetism. At the
microscopic scale, the magnetisation dynamics is driven by either a high fre-
quency ﬁeld when considering ferromagnetic resonance, or a white noise pro-
cess modeling thermal ﬂuctuations. On the macroscopic scale we are interested
in simulating the dynamics of single magnetic spins without fully resolving the
microscopic scales.

The method follows the framework of heterogeneous multiscale methods
and it has two main ingredients: a micro- and a macroscale model. The mi-
croscopic model is assumed to be known exactly whereas the macro model is
incomplete as it lacks eﬀective parameter values. The two models are inte-
grated at diﬀerent temporal resolution and eﬀective parameter values for the
macro model are computed on the ﬂy, allowing for improved eﬃciency over
traditional one-scale schemes.

For the analysis, we consider a deterministic high frequency ﬁeld and show
that eﬀective parameter values can be obtained accurately with step-sizes much
larger than the size of the microscopic scales required to resolve the microscopic
scale. We consider also the stochastic setting and verify via numerical experi-
ments that the eﬀective dynamics are accurately captured.

1. Introduction

Suppose that we are given an ensemble of particles {i}N

i=1, each of them possess-
ing a magnetisation represented by mi(t) ∈ R3, for all t ∈ [0, T ]. At a microscopic
level, the dynamics of the magnetisation of the particle i is modeled by the Landau-
Lifschitz (LL) equation, [26]:

(1.1)

∂tmi = βmi × Hi − γmi × (mi × Hi) .

The ﬁrst term on the right hand side accounts for the precessional motion of the
magnetisation mi around a ﬁeld Hi while the nonlinear term is responsible for
damping the magnetisation toward the ﬁeld Hi. In general, the eﬀective ﬁeld Hi
accounts for the contributions of diﬀerent short and long range interactions. In the
presence of exchange, anisotropy, and an external ﬁeld, Hi is given by

Hi =Xj

Jijmj + Kanip · mi + ˜H,

where Jij is the exchange rate between the particles i and j, p is the material
anisotropy which is the energetically favourable direction of magnetisation, and
where ˜H is an external ﬁeld interacting with the particles. Note that the above

2010 Mathematics Subject Classiﬁcation. Primary: 65L04; Secondary: 65L05, 65L70.
Key words and phrases. Micro magnetism, Landau-Liftshitz equations, Heterogeneous multi-

scale methods.

1

2

D. ARJMAND, S. ENGBLOM, AND G. KREISS

form of Hi is stated only for a general introduction of the LL equation and to
illustrate the idea behind multiscale methods. However, the theoretical settings in
this paper will cover the contribution of the external ﬁeld ˜H only.

We are often interested in the dynamics of the magnetisation at scales much
larger than the size of the spatial and temporal variations at a particle level. It
is, however, computationally unaﬀordable to solve the microscopic model over the
entire domain to simulate macroscopic dynamics of the magnetisation process. The
macroscopic quantities can be deﬁned as e.g. local averages, in time and space, of
the magnetisations of the particles. A traditional approach is the molecular ﬁeld
approximation, where an equation for the volume-averaged magnetisation is derived
[2]. Such an approach, however, lacks generality as the approximation may not be
valid e.g. in the vicinity of microscopic defects. To treat microscopic irregularities,
it is therefore necessary to develop multiscale strategies that can iterate back and
forth between an accurate microscopic and a computationally eﬃcient macroscopic
model. The microscopic model is expensive and, therefore, should be used only
when necessary.

There are two common types of multiscale strategies to couple the disparate
scales in multiscale problems. The ﬁrst approach is the domain partitioning strat-
egy which implies an explicit interface between mathematical laws valid at diﬀerent
scales. The other alternative is to use methods based on upscaling, where a macro-
scopic model is assumed everywhere and the microscopic information is upscaled to
the macro model only in a small part of the domain when, for example, the molec-
ular ﬁeld approximation breaks down and a more detailed description is needed.
Schematics of these approaches are given in Figure 1.1. There are a large number of
related literature on coupling diﬀerent length scales in magnetism. Without being
exhaustive we refer the curious reader to [8, 12, 13, 16, 23, 30, 33].

In this article, as a ﬁrst step towards designing general multiscale methods such
as the upscaling strategy illustrated in Figure 1.1 (the left schematic), we pro-
pose and analyse an upscaling strategy based on heterogeneous multiscale methods
(HMM) [18], to couple disparate temporal scales in the LL equations. The algo-
rithm assumes a macro model where some data in the model are missing. These
data are then computed and upscaled by carrying out simulations in localised, in
time, microscopic domains. As we limit ourselves to the analysis of temporal up-
scaling only, we consider a model problem where the eﬀective ﬁeld H includes the
inﬂuence of a time-dependent external ﬁeld with no particle interactions. Since we
do not have any interaction, such as exchange, among the particles, we regard all
particles as being identical and rewrite the LL equation (1.1) as

(1.2)

∂tmε = βmε × Hε − γmε × (mε × Hε) .

In this setting the magnetisation dynamics of a particle is driven only by an
external ﬁeld Hε, which may possess slow and fast variations at the same time.
The parameter ε ≪ 1 denotes the wave-length of the rapid variations. The high-
frequency component of Hε may be a deterministic term, as in ferromagnetic res-
onance (FMR), see [24], or a random ﬁeld which is used in the modeling of tem-
perature eﬀects in micro-magnetism, [11]. The external ﬁeld is usually written in
the form Hε(t) := H0(t) + Hε
1(t), where H0 is a smooth ﬁeld, typically a constant
state, and Hε
1 is a high frequency component which ﬂuctuates with the wavelength
ε ≪ 1. We are mainly interested in two settings:

MULTISCALE MODELING IN MICRO MAGNETISM

3

t

t∗
...
△t

Macro grids

Micro domain

Microscopic region
t

Interface

Macroscopic region

τ < △t

Ωt∗,x∗

x

△x

· · ·

x∗

t

x

Figure 1.1. (Left) A multiscale strategy based on upscaling: The
macroscopic model lacks some information in the center of the mi-
cro boxes, e.g. at (t∗, x∗). The missing eﬀective parameter values
are then computed by carrying out local, in time and space, micro-
scopic simulations in small boxes, e.g. Ωt∗,x∗. The micro problems
should be synchronised with the corresponding coarse scale data
and the eﬀective quantities are computed and upscaled from the
micro to the macro level. (Right) A multiscale strategy based on
domain partitioning: Diﬀerent mathematical laws are valid at dif-
ferent regions. The macroscopic region does not see the small scale
variations in the microscopic domain. These two regions are con-
nected by an interface. The interface acts as a transition region
and conditions are often imposed to ensure the consistency between
the microscopic and the macroscopic quantities.

1. Hε = H0(t) + Hdet(t/ε)
2. Hε = H0(t) + Hε

sto(t),

modeling deterministic and stochastic ﬂuctuations, respectively. We will carry out
the analysis for the deterministic case, but we provide numerical results showing
the applicability of the method to the stochastic setting as well. In the stochastic
framework, the upscaling algorithm we introduce in this paper can be seen as an
alternative to the well-known Landau-Lifshitz-Bloch (LLB) equations, derived in
[22], which approximate the macroscopic dynamics of stochastic Landau-Lifshitz
(SLL) equations, see also [9, 8] for an LLB-type macroscopic model valid at high
temperatures. More detailed discussion about this can be found in Section 3.3.
Although the theoretical ﬁndings in the current study do not cover the full LL
equations with all energy terms, they present a good insight regarding the sources
of errors in a typical multiscale coupling based on upscaling. For the analysis in
the deterministic setting, we assume that Hε(t) = H(t, t/ε) so that mε has non-
trivial dependence on the slow and fast scales, which is a better representative of
the situation when other energy contributions are taken into account.

Remark 1. Note that there are two variants of SLL equations in the literature.
The ﬁrst variant, see e.g. [32], considers the noise both in the precession and the
damping term, as in equation (1.2), while in the second variant, [8], the noise term
is included only in the precessional term. The numerical method here is developed
for the former. Note also that in the stochastic setting, the SLL equation (1.2)
should be interpreted in the Stratonovic sense.

4

D. ARJMAND, S. ENGBLOM, AND G. KREISS

The paper is structured as follows. In Section 2, we introduce the notation and
preliminary results which will be used later in the analysis. In Section 3, we give
a general overview of HMM for multiscale ordinary diﬀerential equations (ODEs)
and we also present our multiscale algorithm. Section 4 is devoted to the analysis
of the method where a fully discrete estimate for the diﬀerence between the HMM
solution and the exact local average is given. Finally, we conclude our paper by
presenting numerical examples corroborating our theoretical statements.

2. Preliminaries

2.1. Notation. We will use calligraphic fonts, e.g. H(t), to denote matrices or
matrix functions. Vector functions are represented by a bold face letter, e.g. m(t).
Macroscopic and microscopic step-sizes will be denoted by △t and δt, respectively.
The space of functions of bounded variations is written as BV (R). The Euclidian
2-norm is written as |m|2 = pm2
3 and we denote the corresponding
inner-product by hu, vi = Pd
i=1 uivi. Unless otherwise speciﬁed, | · | is to mean
| · |2. Throughout the paper, the constant C = O(1) is a generic constant whose
value may change in subsequent occurences.

1 + m2

2 + m2

2.2. Utility results. The upscaling strategy that is summarised in the next section
is heavily based on the notion of local averages. Assume that we have an oscillatory
function f ε(t) := f (t/ε) for t ∈ [0, T ], where f is a 1-periodic function and ε ≪ 1.
The function f (t/ε) is then ε-periodic. To compute the local average we introduce
an interval Iτ := [−τ /2, τ /2], where τ = O(ε). A naive local averaging approach
is to integrate the function f ε over the interval Iτ . The following estimate for the
error of this naive averaging can easily be shown.

1

τ Z τ /2

−τ /2

f (s/ε) ds −Z 1

0

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ε
τ

.

≤ C

f (s)ds(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(2.1)

In this paper, τ stands for the size of the microscopic simulations and it should
practically be chosen of the same order as ε. But the error in (2.1) can be very
large when τ = O(ε). To reduce this error, we introduce the space of kernels Kp,q
and we say that K ∈ Kp,q if K has a compact support in [−1/2, 1/2] and

• K(t) = K(−t)
• K (q+1) ∈ BV (R)
• K has p vanishing moments:

K(t)trdt =(1

ZR

r = 0,

0, 0 < r ≤ p.

Note that K (q+1) is the (q + 1)th weak derivative and that a constant kernel
belongs to K 1,−1. To localise the kernel we introduce a scaled version Kτ (t) :=
1/τ K(t/τ ), with K ∈ Kp,q. The local averages can then be computed by taking
a weighted average of the function f ε with Kτ over the domain Iτ . The following
lemma from [6] shows how the convergence rate in (2.1) improves upon using such
averaging kernels.

MULTISCALE MODELING IN MICRO MAGNETISM

5

Lemma 1 (Lemma 2.3 in [6]). Let f be a 1-periodic bounded function such that

0 f (s)ds we have

≤ C |f|∞(cid:16) ε

τ(cid:17)q+2

,

f ∈ L∞([0, 1]) and K ∈ Kp,q. Then with ¯f =R 1
Kτ (s)f (s/ε) ds − ¯f(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z τ /2

−τ /2

where the constant C > 0 is independent of ε and τ but may depend on K, f, p or
q.

Remark 2. Note that, in its original form in [6], the Lemma 1 assumes continuity
of the integrand f . However, if the derivatives are interpreted in the weak sense,
the same proof will be valid under the condition that f ∈ L∞([0, 1]), see Figure 2
in [7] for a numerical veriﬁcation of this statement.

A well-known property of the LL equation (1.1) is the conservation of the length
of magnetisation. In other words, if |m(0)|2 = 1, the magnetisation vector m(t)
will stay on the unit sphere S2 in R3 for all t ∈ [0, T ] . This can be seen by
taking the inner-product of (1.1) by m(t). From a numerical point of view, it is
then desirable to use discretisation schemes that respect this property. We refer
to [14] for a survey of common time stepping schemes for the LL equation, to [31]
for an analytical treatment of general computational approaches and to [25] for
the treatment of relaxation based models used in stationary micromagnetism. One
commonly used time-stepping scheme that preserves the magnetisation amplitude
along with other invariants such as the Hamiltonian and the Lyapunov structures
is the midpoint rule, see [15] for the analysis of the midpoint rule and [28] for a
variant of it. The midpoint rule for (1.1) is

mn+1 = mn + β△tmn+1/2 × Hn+1/2 − γ△tmn+1/2 ×(cid:0)mn+1/2 × Hn+1/2(cid:1) ,

where un+1/2 = (un + un+1)/2 for u = m or u = H. In this paper, we will use
the mid-point rule as our choice of temporal discretisation for the LL equation.
However, we emphasise that the multiscale method that we describe in the next
section can easily be modiﬁed for any integration method with no conceptual change
in the coupling conditions.

Finally, we state a simple inequality that is used in the proof of Lemma 3 below.

Lemma 2. Suppose that the relation

1
2

d
dt

ψ2(t) ≤ f (t)ψ(t)

holds for suﬃciently smooth ψ > 0. Then we have the obvious inequality

(2.2)

ψ(T ) ≤ ψ(0) +Z T

0

f (s)ds.

3. The multiscale method

3.1. Heterogeneous multiscale methods. HMM was originally proposed by E
and Engquist [18] as a general framework for designing multiscale algorithms for
coupling mathematical models at diﬀerent scales. For a recent account of ap-
plications of HMM in various ﬁelds, see the survey article [1]. Here we refer to
[21, 4, 5, 3, 17] for the analysis and developments in the context of ordinary dif-
ferential equations (ODEs) with multiple scales. For the analysis of HMM in the
stochastic setting, see e.g. [34, 19]. Before proceeding further to the presentation

6

D. ARJMAND, S. ENGBLOM, AND G. KREISS

of our multiscale method, we present the general idea behind HMM. For this, we
introduce

(Kmε) (ta) :=Z Kτ (t − ta)mε(t) dt.

We can then see that K∂t = ∂tK. Next, we apply the operator K to both sides
of the equation (1.2) and use the commutative property to see that, with M(t) :=
(Kmε) (t),

∂tM(t) = β (K (mε × Hε)) (t) − γ (K (mε × (mε × Hε))) (t).

The macro variable M is smooth since by deﬁnition the ﬂuctuations in mε are
ﬁltered out. Moreover, the right hand side ∂tM is given by a local average of the
original LL which oscillates around and damps towards the external ﬁeld Hε. This
suggests that we may assume a macro solver of the form:

(3.1)

∂tM(t) = F(t, M),

where F is given by solving the original LL only locally and averaging the time
derivative ∂tmε. In the next section, we propose a strategy which is diﬀerent than
a typical HMM in two respects: (i) We do not consider the above-mentioned form
for the macro-solver, (ii) While computing the eﬀective parameter, e.g. F in the
above case, which requires solving the LL equation (1.2) locally, we will not include
the damping term. We will show later, by analytical and numerical means, that
this strategy does not induce any additional error.

3.2. HMM for the LL equation (1.2) with deterministic Hε. The eﬀective
equation on the macro level assumes the following form:

(3.2)

Macro Model: ( ∂tM(t) = F(t, M) −

M(0) = mε(0),

γ
β

M × F(t, M),

t ∈ (0, T ],

where F is the missing data in the model. Note that, unlike the model (3.1), the
macro model (3.2) includes also a damping term . As the macro-solver, we use
the midpoint rule due to the mentioned conservation properties it possesses. In
principle, the HMM introduced in this section can be combined with any time-
stepping scheme with no change in the macroscopic and microscopic models. In
this paper, we will carry out the analysis for the implicit midpoint rule. The macro-
solver uses a macro step-size △t and reads as
(3.3) Macro Solver: ( Mn+1 = Mn + △tFn+1/2 −
where Fn+1/2 := F(cid:0)tn+1/2, Mn+1/2(cid:1), tn+1/2 := (tn+tn+1)/2 and Mn+1/2 = (Mn+

Mn+1)/2. To close the system one needs to compute the right hand side F(ta, M).
To achieve this we ﬁrst solve the micro model:

γ
β△tMn+1/2 × Fn+1/2,

M0 = mε(0),

(3.4)

Micro Model:

∂tmε(t) = βmε(t) × Hε(t),
mε(ta) = M,

t ∈ I±τ ,

where I +
τ
computed by:

:= (ta, ta + τ /2] and I−τ

:= [−τ /2 + ta, ta). Then, F(ta, M) can be

(3.5) Upscaling: F(ta, M ) = (K∂tmε) (ta) :=Z ta+τ /2

ta−τ /2

Kτ (s − ta) ∂smε(s) ds.

MULTISCALE MODELING IN MICRO MAGNETISM

7

In practice we choose τ = O(ε) and therefore the computational cost of solving
the micro model (3.4) is independent of the small scale parameter ε. Nevertheless,
the theory and the method itself are not restricted by this assumption. Note that
the initial data of the micro problem is given by the coarse scale solutions. This is
necessary for synchronising the micro-problem with the current macroscopic quan-
tities. Moreover, the macro stepsize is chosen larger than the size of the microscopic
simulation box, i.e., τ < △t, so that the overall cost of the multiscale method is
cheaper than the cost of a direct numerical approximation of the full multiscale
problem.

Remark 3. We emphasize that for computation of the ﬂux (3.5), the micro problem
must be solved forward and backward locally in time.

The micro model does not include the damping term. This does not cause any
big change in the dynamics of the macro-scale variable M owing to the fact that
the solution mε of the micro model (3.4) with or without damping would precess
around the ﬁeld Hε in both cases and the high frequency variations are ﬁltered out
in the upscaling step (3.5). It is possible to include the damping term in the micro
problem but this requires removing the damping in the macroscopic model (3.2).
It is also possible to carry out the local averaging in the upscaling (3.5) locally
forward in time instead, i.e., in the interval [0, τ ]. Such a procedure will result in a
qualitatively similar macroscopic solution but may lead to a signiﬁcant deterioration
in the order of convergence. The main advantage with using the conservative micro
model (3.4) is that the nonlinearity is treated only in the macroscopic equation (3.2)
which leads to signiﬁcant simpliﬁcations in relation with the convergence analysis
for the upscaling step and the numerical computation of the micro solution. Note
that the macro-solver is also nonlinear, in Mn+1, due to our choice of discretisation.

Remark 4. The micro problem (3.4) can be posed instead over the domain (0, τ /2]
by shifting the argument of the ﬁeld Hε by ta:

(3.6)

∂tmε(t) = βmε(t) × Hε(t + ta),
mε(0) = M,

t ∈ ˜I±τ

where ˜I +
ten as

τ := (0, τ /2] and ˜I−τ := (−τ /2, 0]. Accordingly, the ﬂux (3.5) can be rewrit-

(3.7)

F(ta, M) = (K∂tmε) (0) :=Z τ /2

−τ /2

Kτ (s) ∂smε(s) ds.

3.3. Modiﬁcation for the stochastic microscale model. In this case the mi-
croscopic magnetisation is driven by an external ﬁeld which includes a random
term, Hε(t; ω) := H0(t) + Hε
1(t; ω) is a white noise with zero corre-
lation in time. In practice, it has a zero mean but the method is not restricted by
this assumption. Moreover, the macroscopic variables do not see these ﬂuctuations.
Therefore the macro model is deterministic and remains unchanged as in (3.2). The
micro model is also the same as (3.4) but Hε(t) is replaced by Hε(t; ω). The only
fundamental modiﬁcation appears in the upscaling step which now reads as

1(t; ω), where Hε

Upscaling: F(ta, M ) = (K∂tE[mε]) (ta) :=Z ta+τ /2

ta−τ /2

Kτ (s − ta) ∂sE[mε(s; ω)] ds.

8

D. ARJMAND, S. ENGBLOM, AND G. KREISS

In practice, the expectation E[mε] can be approximated by solving the micro prob-
lem for n diﬀerent realisations and computing the average

E[mε] ≈

1
n

n

Xj=1

mε(t, ωj).

In principle, due to ergodicity, one could avoid computing the expectation by in-
stead solving the micro problem for a much larger larger τ . However, this should
be avoided owing to computational ineﬃciency. As diﬀerent realisations are embar-
rassingly parallel, the computational time of computing the expectation remains
the same as that of the corresponding deterministic model if the computations are
done in parallel.

Remark 5. The HMM approach presented here is similar to the Landau-Lifshitz-
Bloch models introduced in [22, 8] in the sense that all these approaches approximate
the expected value of mε. The LLB derived by Garanin, [22], works well for low
temperatures but does not predict the right behaviour for elevated temperatures as
the macroscopic magnetisation does not respect the power law at intermediate tem-
peratures below the Curie temperature. Another strategy was suggested later in [8]
to overcome this issue. The idea was to force the LLB, by properly ﬁtting a param-
eter in the equation, so that the macroscopic magnetisation obeys the power law.
At this stage, we are not able to make a further comparison between our HMM and
the LLB type models. This is because to be able to see the temperature dependence
of the average macroscopic magnetisation, an extension of the HMM to the general
case with local averaging in time and space is needed. This is a work in progress.
However, we emphasise here that when adapted to both the spatial and the tempo-
ral averaging setting, the HMM approach would potentially be more general than
the LLB type macroscopic models which heavily rely on the classical molecular ﬁeld
approximation (MFA). This is due to the fact that with HMM it will be possible to
upscale average quantities even in the presence of microscopic defects where MFA
breaks down.

Without loss of generality we assume that β = 1. The LL equation with β = 1

can be written as

4. Analysis

(4.1)
where Hε(t) ∈ R3×3 for all t ∈ [0, T ] is a skew-symmetric matrix function given by

∂tmε(t) = Hε(t)mε(t) − γmε(t) × (Hε(t)mε(t)) ,
Hε(t) =


H ε
3 (t) −H ε
0
2(t)
−H ε
H ε
3 (t)
0
1 (t)
H ε
2 (t) −H ε
0
1 (t)


 .

For the analysis, we assume that Hε(t) = H(t, t/ε), where the ﬁeld H(t,·) is

1-periodic. By periodicity we can write

Hε(t + ta) = H(t + ta, t/ε + r), where r = {ta/ε},

and {z} represents the fractional part of z. To simplify the notation, we will write
Hta,r(t, t/ε) := H(t + ta, t/ε + r). We assume that for all v ∈ R3, and k = 0, 1, the
following bounds hold

(4.2)

t Hta.r(t, z)v(cid:12)(cid:12)2 ≤ c1 |v|2 ,
(cid:12)(cid:12)∂k

∀t ∈ [0, T ] and z ∈ R.

MULTISCALE MODELING IN MICRO MAGNETISM

9

In practice, in the ODE setting, it is often the case that H(t, t/ε) = H0 + H1(t/ε)
where H0 is constant and hence ∂tH(t, z) = 0. However, we will keep the assump-
tions as above so that they are suitable also for more general cases when the solution
mε might have a non-trivial dependence on the slow and fast temporal scales such
as in the full PDE setting.

From the classical theory of averaging for oscillatory ODEs, see e.g.

[10, 29],
it follows that, when H(t,·) is 1-periodic, the exact average magnetisation, ¯m, is
driven by the eﬀective Hamiltonian ¯H(t) :=R 1
0 H(t, s) ds and the eﬀective equation
reads as

(4.3)

∂t ¯m(t) = ¯H(t) ¯m(t) − γ ¯m(t) ×(cid:0) ¯H(t) ¯m(t)(cid:1) ,

¯m(0) = mε(0).

Our aim in the next section is to show that the HMM solution M in (3.2)
approximates the solution ¯m of the eﬀective equation (4.3) without assuming any
knowledge about the eﬀective Hamiltonian ¯H. The equation (4.3) is needed only
for the analysis and the HMM does not use it.

Remark 6. In what follows, we assume that the initial magnetisation |M0|2 = 1.
Figure 5.6 shows that the HMM introduces an error at later times and therefore
the magnetisation length is not preserved exactly. See Remark 8 where we give an
upper bound for this error, in the deterministic setting.

4.1. Upscaling error. Our main result in this section is the following theorem
which shows that the upscaling step in the HMM strategy captures the right macro-
scopic quantity.

Theorem 1. Let ¯H(t) :=R 1

0 H(t, s)ds. Suppose that mε(t) solves the micro prob-
lem (3.6). Moreover, suppose that the assumptions (4.2) hold. Then F(ta, M) given
by the upscaling step (3.7) satisﬁes

(cid:12)(cid:12)F(ta, M) − ¯H(ta)M(cid:12)(cid:12)2 ≤ C1(cid:18)τ +(cid:16) ε

τ(cid:17)q+2(cid:19)|M|2 ,

where C1 is independent of ε, and τ but may depend on p, q or K.

Proof. We start by rescaling mε to bring the O(ε) oscillations back to O(1) time
scales. For this we introduce the fast time scale ζ = t/ε

m(ζ; ε) := mε(t).

Then we see that from (4.1)

(4.4)

∂tm(t; ε) = εHta,r(εt, t)m(t; ε).

We now Taylor expand m(t; ε) in terms of ε

m(t; ε) = m0(t) + εm1(t) +

ε2
2

m2(t) + ··· ,

where mj(t) := ∂j
see that

ε m(t; ε)|ε=0. From (4.4) and the deﬁnition of mj with j = 0, we

(4.5)

∂tm0(t) = ∂tm(t; 0) = 0, and m0(0) = mε(0) = M.

10

D. ARJMAND, S. ENGBLOM, AND G. KREISS

Hence m0(t) = M. Moreover, for j = 1, we diﬀerentiate (4.4) with respect to ε
and ﬁnd that
∂t∂εm(t; ε) = ∂ε (εHta,r (εt, t) m (t; ε))

= Hta,r(εt, t)m(t; ε) + εtH(1)

ta,r(εt, t)m(t; ε) + εHta,r(εt, t)∂εm(t; ε),

where H(k)

ta,r(t, z) := ∂k

t Hta,r(t, z). Upon putting ε = 0, we obtain
∂tm1(t) = Hta,r(0, t)m0(t), m1(0) = 0.

(4.6)
We now deﬁne etail(t; ε) := m(t; ε) − (m0(t) + εm1(t)). We can then write
∂tmε(t) = ∂t (m0(t/ε) + εm1(t/ε)) + ∂tetail(t/ε; ε)

= ∂ζm1(t/ε) + ∂tetail(t/ε; ε) = Hta,r(0, t/ε)m0(t/ε) + ∂tetail(t/ε; ε)
= Hta,r(0, t/ε)M + ∂tetail(t/ε; ε).

From the last equality, it follows that

−τ /2

−τ /2

−τ /2

Z τ /2

Kτ (s) ∂smε(s) ds − ¯H(ta)M(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2
Kτ (s) ∂setail(s/ε; ε) ds − ¯H(ta)M(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2
Kτ (s)Hta,r(0, s/ε)M ds +Z τ /2
+(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Kτ (s) ∂setail(s/ε; ε) ds(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2
Kτ (s)Hta,r(0, s/ε) dsM − ¯H(ta)M(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2
Z τ /2
}
}
|
τ(cid:1)q+2
|M|2. Moreover, by Lemma 3 pre-

(cid:12)(cid:12)F(ta, M) − ¯H(ta)M(cid:12)(cid:12)2 :=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z τ /2
≤(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z τ /2
{z
|
By Lemma 1, we have Eaveraging ≤ C(cid:0) ε
sented below, it follows that Etail ≤ Cτ |M|2. The proof is completed.
4.2. The tail error. The following lemma quantiﬁes the tail error that arises from
replacing m by ˜m := m0 + εm1, where m0 and m1 are given in (4.5) and (4.6)
respectively, in the upscaling step.

{z

Eaveraging

−τ /2

−τ /2

Etail

(cid:3)

Lemma 3. Suppose that the assumptions (4.2) hold and that

˜m(t; ε) := m0(t) + εm1(t),

and

e(t; ε) := m(t; ε) − ˜m(t; ε),

where m0 and m1 are given in (4.5) and (4.6), respectively. Moreover, let K ∈ Kp,q
and τ ≥ ε. Then

(4.7)

Z τ /2

−τ /2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Kτ (t)∂te(t/ε; ε) dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

≤ Cτ |M|2 ,

where C is independent of ε, τ and T but may depend on Hta,r.
Proof. By deﬁnition we can write, with δHta,r := Hta,r(εt, t) − Hta,r(0, t),

∂te(t; ε) = ∂tm(t; ε) − ∂t ˜m(t; ε) = ∂tm(t; ε) − ε∂tm1(t)

= εHta,r(εt, t)m(t; ε) − εHta,r(0, t)m0(t)
= εHta,r(εt, t)e(t; ε) + εHta,r(εt, t) ˜m(t; ε) − εHta,r(0, t)m0(t)
= εHta,r(εt, t)e(t; ε) + εδHta,rm0(t) + ε2Hta,r(εt, t)m1(t).

MULTISCALE MODELING IN MICRO MAGNETISM

11

Moreover, taking the inner-product of the above equation with e we get

h∂te, ei = εhHta,r(εt, t)e, ei + εhδHta,rm0(t), ei + ε2hHta,r(εt, t)m1(t), ei

= εhδHta,rm0(t), ei + ε2hHta,r(εt, t)m1(t), ei.

This implies the inequality

(4.8)

1
2

∂t |e(t; ε)|2

2 ≤(cid:0)ε |δHta,rm0(t)|2 + ε2 |Hta,r(εt, t)m1(t)|2(cid:1)|e(t; ε)|2 .

By the assumptions (4.2) and a Taylor’s expansion, we have |δHta,rm0|2 ≈ εt|M|2.
For the second term, we again use (4.2) and (4.6). This gives

|Hta,r(εt, t)m1(t)|2 ≤ C |m1(t)|2 = C(cid:12)(cid:12)(cid:12)(cid:12)

0 H(0, s)m0 ds(cid:12)(cid:12)(cid:12)(cid:12)2
Z t

0 |H(0, s)m0|2 ds ≤ Ct|M|2 .

≤ CZ t

An application of inequality (2.2) in Lemma 2 for (4.8) yields

(4.9)

|e(t; ε)|2 ≤Z t

0

ε |δHta,rm0(s)|2 + ε2 |Hta,r(εs, s)m1(s)|2 ds ≤ Cε2(cid:0)1 + t2(cid:1)|M|2 .

We can now bound the tail error in the upscaling procedure. With α := ε/τ , we
have

(K∂te(t/ε; ε)) (0) :=Z τ /2
τ Z τ /2

−τ /2
Finally, we use (4.9) to obtain

−τ /2
1

= −

1

τ Z τ /2

−τ /2

Kτ (t)∂te(t/ε; ε) dt =

K(t/τ )∂te(t/ε; ε) dt

1
τ

K′(t/τ )e(t/ε; ε) dt = −αZ 1/2α

−1/2α

1
τ

K′(tα)e(t; ε) dt.

| (K∂te(t/ε; ε)) (0)| ≤ |K′|∞

1
τ

max

t∈[− 1

2α , 1

2α ] |e(t; ε)|2 ≤ Cτ |M|2 .

(cid:3)

4.3. Estimates for the full solution. In this section, we give a fully discrete
error estimate for the diﬀerence between the HMM solution given in (3.3) and the
solution of the exact locally-averaged equation (4.3). For this, let us denote the
}N
HMM solution by {M△t,δt
n=0. This is the solution that is computed by solving the
micro and the macro problems in a discrete setting. We deﬁne also a semi-discrete
solution {M△t
n=0 which is essentially the HMM solution but when the micro
problem is solved exactly. Moreover, we introduce { ¯m△t
j=1 which approximates
the solution of the eﬀective equation (4.3) by the implicit midpoint rule:

j }N

n }N

n

(4.10)

¯m△t

n+1 = ¯m△t

where ¯mn+1/2 :=

1
2

n+1 + △t ¯H(tn+1/2) ¯m△t
( ¯mn+1 + ¯mn) and

n+1/2 + Nγ[ ¯m△t

n+1/2],

¯m△t

0 = mε(0),

Nγ[ ¯m△t

n+1/2] := −γ ¯m△t

n+1/2 ×(cid:16) ¯H(tn+1/2) ¯m△t

n+1/2(cid:17) .

12

D. ARJMAND, S. ENGBLOM, AND G. KREISS

On the other hand, we see from equation (3.3) that the HMM solution satisﬁes

(4.11)

M△t

n

n+1/2)

n+1/2 × Eups

n+1/2,

n+1/2 × F(tn+1/2, M△t
n+1/2]

n+1/2(cid:17) + △tNγ[M△t

n+1/2) − γ△tM△t
n+1/2 + Eups

where Eups
Theorem 1. We can then split the overall error into three parts as follows

n + △tF(tn+1/2, M△t
n + △t(cid:16) ¯H(tn+1/2)M△t

n+1 = M△t
= M△t
− γ△tM△t
n+1/2 := F(tn+1/2, Mn+1/2) − ¯H(tn+1/2)Mn+1/2 satisﬁes the estimate in
− ¯m(tn)(cid:12)(cid:12)2 ≤(cid:12)(cid:12)M△t,δt
n − ¯m(tn)(cid:12)(cid:12)2
− M△t
{z
}
{z

n − ¯m△t
{z

+(cid:12)(cid:12)M△t
|

+(cid:12)(cid:12) ¯m△t
|

The ﬁrst and the last errors are the micro and the macro discretisation errors, which
can be bounded in a rather standard way. The HMM error EHMM is, however,
related to the upscaling error Eups
n which was estimated in Theorem 1. In what
follows we will ﬁrstly prove a theorem which provides an upper-bound for the error
EHMM for the case γ = 0.

(cid:12)(cid:12)M△t,δt

n (cid:12)(cid:12)2
}

n (cid:12)(cid:12)2
}

Emicro

EHMM

EM acro

n

|

.

Theorem 2. Suppose that {M△t
n=0 solves (3.3) with β = 1 and γ = 0, where the
associated micro problem (3.4) is solved exactly. Moreover, assume K ∈ Kp,q and
that ¯m△t
n satisﬁes

n+1 solves 4.10 and △t ≤ 2/3. Then the error e△t

n − ¯m△t

n := M△t

n }N

N |2 ≤ C√T(cid:18)τ +(cid:16) ε
|e△t

τ(cid:17)q+2(cid:19) max

0≤n≤N |M△t

n+1/2|2,

where T = N△t, and C is a constant independent of ε, τ and T but may depend
on H, p, q, K.
Proof. For simplicity we drop △t in the notation and instead write en. We can see,
from (4.10) and (4.11), that

en+1 = en + △t ¯H(tn+1/2)en+1/2 + △tEups

n+1/2,

e0 = 0.

Next we rearrange the above scheme and take the inner-product with en+1/2. This
gives

hen+1 − en, en+1/2i = △th ¯H(tn+1/2)en+1/2, en+1/2i + △thEups

n+1/2, en+1/2i

We now use the relation en+1/2 =

(en+1 + en) and write

n+1/2, en+1/2i.

= △thEups
1
2

hen+1 − en,

1
2

(en+1 + en)i =

1
2hen+1, en+1i −

1
2hen, eni = △thEups

n+1/2, en+1/2i.

MULTISCALE MODELING IN MICRO MAGNETISM

13

From here and the fact that e0 = 0, it follows that

heN , eNi =

N−1

hEups

n+1/2, en+1/2i

N−1

2

2

2

N−1

N−1

N−1

+ △t

+ △t

≤ △t

Xn=0

(hen+1, en+1i − hen, eni) = 2△t
N−1

Xn=0
n+1/2(cid:12)(cid:12)(cid:12)
Xn=0(cid:12)(cid:12)(cid:12)Eups
Xn=0(cid:12)(cid:12)en+1/2(cid:12)(cid:12)
≤ △t
n+1/2(cid:12)(cid:12)(cid:12)
Xn=0(cid:12)(cid:12)(cid:12)Eups
|en|2 + △t
Xn=0
2 (cid:19)−1 N△t max
n+1/2(cid:12)(cid:12)(cid:12)
0≤n≤N−1(cid:12)(cid:12)(cid:12)Eups
2 (cid:19)−1
n+1/2(cid:12)(cid:12)(cid:12)
0≤n≤N−1(cid:12)(cid:12)(cid:12)Eups
n+1/2(cid:12)(cid:12)(cid:12)
0≤n≤N−1(cid:12)(cid:12)(cid:12)Eups
Xn=0
N△t max
N (cid:12)(cid:12)(cid:12)2 ≤ C√T(cid:18)τ +(cid:16) ε

EHMM :=(cid:12)(cid:12)(cid:12)M△t

N△t max

N − ¯m△t

|en|2 .

N−1

+

+

2

2

2

2

2

We have with △t ≤ 2/3,
|eN|2 ≤(cid:18)1 − △t
≤(cid:18)1 − △t
≤

3
2

By a simple induction and an application of Theorem 1 we obtain

2 |eN|2 .

2

+ △t

N−1

|en|2!
Xn=0
2△t
Xn=0
|en|2
2 − △t

N−1

τ(cid:17)q+2(cid:19) .

(cid:3)

Remark 7. Note the constraint on the time step, △t ≤ 2/3, in Theorem 2. It
appears despite using the implicit midpoint rule on the macro level. Nevertheless,
the restriction on the time step does not inﬂuence the eﬃciency as it still allows
for large macroscopic stepsizes.

We present now a lemma which estimates the length of the macroscopic mag-

netisation at diﬀerent discrete time instants.
Lemma 4. Suppose that {M△t
that satisﬁes |M0|2 = 1. Moreover, let K ∈ Kp,q and δ = τ + (ε/τ )q+2. Then

n=0 solves (4.11) with an initial magnetisation

n }N

|Mn|2 ≤ exp(Ctn

) = 1 + O(δ),

δ

1 − δ△t

2

where C is a constant independent of n, ε, τ and tn = n△t.
Proof. We take the inner-product of (4.11) with Mn+1/2. Following the same idea
as in the proof of Theorem 2 and using Theorem 1 we obtain
hMn+1 − Mn+1i − hMn − Mni = 2△thEups
n+1/2, Mn+1/2i
≤ △t|Eups
n+1/2|2|Mn+1/2|2 ≤ C△tδ|Mn+1/2|2
≤ C △tδ
2 (cid:0)|Mn+1|2
2 ! |Mn|2
2 ≤  1 + C δ△t
1 − C δ△t

2(cid:1) .
2 + |Mn|2

|Mn+1|2

Hence

2.

2

2

14

D. ARJMAND, S. ENGBLOM, AND G. KREISS

From here and the fact that |M0|2 = 1 it follows that, with z := x/(1 − x) where
x = C δ△t
2 ,

|Mn|2

2 ≤  1 + C δ△t
2 !n
1 − C δ△t

2

= (1 + 2z)n ≤ exp(2nz).

The ﬁnal result follows by putting tn = n△t.

(cid:3)

We now present a theorem where an estimate of the HMM error, EHMM , for

the nonlinear case when γ > 0 is given.

Theorem 3. Suppose that {M△t
n }N
n=0 solves (3.3) with β = 1 and γ > 0, where the
associated micro problem (3.4) is solved exactly. Moreover, assume K ∈ Kp,q and
that ¯m△t
3(1+2c1γ+2C1γ) , where C1 = O(1) is a constant
n+1 solves (4.10) and △t ≤
such that |M△t
h∂MNγ( ¯mn+1/2 + θen+1/2)en+1/2, en+1/2i ≤ γc1(cid:12)(cid:12)en+1/2(cid:12)(cid:12)

n+1/2|2 ≤ C1, and

∀ θ ∈ [0, 1].

2
2 ,

2

Then the error e△t

n = M△t

n − ¯m△t

n satisﬁes

N (cid:12)(cid:12)(cid:12)2 ≤ C√T(cid:18)τ +(cid:16) ε
(cid:12)(cid:12)(cid:12)e△t

τ(cid:17)q+2(cid:19) max

n+1/2(cid:12)(cid:12)(cid:12)2
0≤n≤N(cid:12)(cid:12)(cid:12)M△t

,

where T = N△t, and C is a constant independent of ε, τ and T but may depend
on H, p, q, K or γ.
Proof. For convenience we write −γJ to denote the Jacobian ∂MNγ and we remove
△t in the notations. By (4.10) and (4.11), we see that the error en satisﬁes
en+1 = en + △t ¯H(tn+1/2)en+1/2 + △tEups

n+1/2 + △t(cid:0)Nγ[Mn+1/2] − Nγ[ ¯mn+1/2](cid:1)
n+1/2 − γ△tJ [ ¯mn+1/2 + θen+1/2]en+1/2

n+1/2

− γ△tMn+1/2 × Eups
= en + △t ¯H(tn+1/2)en+1/2 + △tEups
− γ△tMn+1/2 × Eups

n+1/2.

Hence

hen+1 − en, en+1i = △thEups

n+1/2, en+1/2i − γ△thJ [ ¯mn+1/2 + θen+1/2]en+1/2, en+1/2i

− γ△thMn+1/2 × Eups

n+1/2, en+1/2i.

We now use the fact that by Lemma 4 |Mn+1/2|2 ≤ C1, where C1 = O(1) for
suﬃciently small values for δ and we proceed similar to the analysis of the linear

MULTISCALE MODELING IN MICRO MAGNETISM

15

case. Moreover, we deﬁne κ := (1 + 2c1γ + 2C1γ) and ﬁnd that

hJ [ ¯mn+1/2 + θen+1/2]en+1/2, en+1/2i

n+1/2, en+1/2i − 2γ△t

(hen+1, en+1i − hen, eni)
N−1
Xn=0
n+1/2, en+1/2i
N−1

hMn+1/2 × Eups

2

+ (1 + 2c1γ)△t

≤ (1 + 2C1γ)△t

N−1

N−1

N−1

= 2△t

Xn=0
heN , eNi =
Xn=0
hEups
Xn=0
− 2γ△t
n+1/2(cid:12)(cid:12)(cid:12)
Xn=0(cid:12)(cid:12)(cid:12)Eups
+(cid:12)(cid:12)en+1/2(cid:12)(cid:12)
|eN|2

Now let △t ≤ 2

≤ △t

N−1

2

3κ . Then

2

2

N−1

Xn=0(cid:12)(cid:12)en+1/2(cid:12)(cid:12)
n+1/2(cid:12)(cid:12)(cid:12)
Xn=0(cid:12)(cid:12)(cid:12)Eups
n+1/2(cid:12)(cid:12)(cid:12)
0≤n≤N(cid:12)(cid:12)(cid:12)Eups
n+1/2(cid:12)(cid:12)(cid:12)
0≤n≤N(cid:12)(cid:12)(cid:12)Eups
Xn=0

N△t max

N−1

+

2

|en|2 .

1 + 2C1γ
1 − κ△t/2
3κ
2

T max

2 ≤

≤

2

N−1

n+1/2(cid:12)(cid:12)(cid:12)
Xn=0(cid:12)(cid:12)(cid:12)Eups
|en|2 + κ△t

2 |eN|2 .

+ 2C1γ△t
N−1
Xn=0

+ κ△t

2

+

N−1

Xn=0

|en|2

A simple induction together with an application of Theorem 1 yields the desired
estimate.
(cid:3)

Remark 8. Using the error estimates in Theorems 2 and 3, the estimate in Lemma
4 and the fact that | ¯m△t

n |2 = 1, one can see that

N

(cid:12)(cid:12)(cid:12)|M△t,δt

N

− M△t

|2 − 1(cid:12)(cid:12)(cid:12) ≤(cid:12)(cid:12)(cid:12)M△t,δt

N (cid:12)(cid:12)(cid:12) +(cid:12)(cid:12)(cid:12) ¯m△t
≤ Emicro + C√T(cid:18)τ +(cid:16) ε

N − M△t
τ(cid:17)q+2(cid:19) ,

N (cid:12)(cid:12)(cid:12) +(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ¯m△t
N (cid:12)(cid:12)(cid:12)
| {z }=1

−1(cid:12)(cid:12)(cid:12)

which shows that the magnetisation length does not remain constant for HMM type
multiscale couplings but that the error can be reduced down to O(ε) by using high
order methods at the micro level and by choosing τ ≈ ε1−β, for β = 1/(q + 2).

5. Numerical results

5.1. The tail error. In this section, we aim at illustrating the validity of the
expansion made in the proof of Theorem 1. For this we solve the problem (4.4)
between 0 ≤ t ≤ 1 with the initial condition M = [0, 0, 1]T , and the external ﬁeld

H(t, z) = [0, 0, 1]T + [sin(2πz), cos(2πz), 0]T .

16

D. ARJMAND, S. ENGBLOM, AND G. KREISS

We study the convergence for two cases: (i) The convergence against m0, where
m0 = M, (ii) The convergence against the truncated solution ˜m(t; ε) = m0 +
εm1(t), where m1 solves (4.6). The error is deﬁned as

Etail = max

0≤t≤1|m(t; ε) − u(t; ε)|2 ,

where u(t; ε) = m0 or ˜m(t; ε).

The left plot in Figure 5.1 shows that we gain one order in ε upon including the
term m1 in the expansion and, in particular, that the estimate (4.7) holds.

5.2. The upscaling error. We show now evidence that the estimate, for the up-
scaling error, given in Theorem 1, is sharp. For this we compare the upscaled ﬂux
in (3.5) with the exact eﬀective ﬂux ¯H(t)M for M = [0, 0, 1]T . The micro problem
is solved with the initial data [0, 0, 1]T and the external ﬁeld

Hε(t) = [0, 0, 1]T + [cos(2πt/ε), cos(2πt/ε), 0]T .

(5.1)
In this case ¯H = [0, 0, 1]T . The convergence is shown for two cases: (i) By setting
τ = 5.3ε, and letting ε −→ 0 for increasing values of q, where higher q means a
better regularity for the kernel K, see the right plot in Figure 5.1 (ii) By ﬁxing
τ = 0.1 and τ = 0.2 and study the diﬀerence as ε −→ 0, see the Figure 5.2. Both
tests corroborate our theoretical ﬁndings in Theorem 1.

5.3. The full solution. In Figure 5.3, we consider two examples with

H(t, t/ε) = H0 + H1(t/ε),

where H1(t) = [sin(2πt), cos(2πt), 0]T or H1(t) = [sin(2πt)2, cos(2πt)2, 0]T and
H0 = [0, 0, 1]T in both cases. We observe that, in the former, the solution mε
converges to [0, 0, 1]T as T increases whereas in the latter, the solution converges to
a non-trivial limit given by the average. In both cases, the HMM solution captures
the coarse features of the exact solution using only 20 discretisation points.

Moreover, in Figure 5.4 we provide the results for external ﬁelds with a random

term

H(t, t/ε) = H0 + Hε

sto, Hε

sto = H1(t/ε) + H2(t; ω)

(5.2)
where H1(t) = [sin(2πt), cos(2πt), 0]T , H2 dt = √σ dW(t), with W(t) a Wiener-
process and where the measure is interpreted in the Stratonovich sense, and σ =
0.0001.
In the left plot we compare the HMM solution computed by only one
realisation in the upscaling with E[mε], whereas in the right plot we compare the
HMM solution computed by 20 realisations in the upscaling step against E[mε].
This ﬁgure shows the need for computing the expected value in the upscaling step.
All other parameters in the simulation are stated in the description of Figure 5.4.
Note that in these simulations, i.e., Figures 5.3 and 5.4, we considered the high
damping scenario by choosing γ = 1. Moreover, to illustrate the performance of
the method for a low damping parameter, we take γ = 0.1 and we see that the coarse
scale features are again captured nicely for the deterministic and the stochastic high
frequency ﬁelds, see Figure 5.5. Note that, in Figure 5.5 all parameters other than
γ is chosen exactly in the same manner as in Figure 5.3 for the deterministic and
as in Figure 5.4 for the stochastic settings.

MULTISCALE MODELING IN MICRO MAGNETISM

17

5.4. Magnetisation amplitude. We consider the full problem with an external
ﬁeld of the form (5.1), where H1(t) = [sin(2πt), cos(2πt), 0]T and H0 = [0, 0, 1]T
and we look at two scenarios: (i) For a ﬁxed ε we keep track of the evolution of the
magnetisation amplitude over the macro time steps, (ii) We study the deviation of
the magnetisation amplitude in comparison to the initial length of magnetisation
as we reﬁne the small scale parameter ε. The initial magnetisation is given as
M0 = 1√3
[1, 1, 1]T so that |M0| = 1. Figure 5.6 shows that the HMM does not
preserve the initial length of the magnetisation.
In the left plot, we show the
evolution of the magnetisation amplitude for each macroscopic time when ε = 0.01.
In this simulation we have used N△t = 2π and N = 20. The magnetisation length
|Mn| for n > 0 clearly deviates from |M0| = 1. In the right plot, however, we study
the convergence

max

0≤n≤N ||Mn|2 − |M0|2| −→ 0

as ε −→ 0, for N△t = 1 and N = 10. The simulation result veriﬁes the expected
convergence rate stated in Remark 8. In the simulations we have chosen a kernel
K ∈ Kp,q with p = 1 and q = 7. Moreover, we set τ = 5.3ε and observe O(ε)
convergence in the selected range of ε. Note that the O((ε/τ )q+2) error term is not
seen in this simulation since we have used a large q.

10-1

10-2

10-3

10-4

10-5

10-6

10-2

The tail error

maxt≤1 |m(t, ε) − m0|2
maxt≤1 |m(t, ε) − ˜m1(t, ε)|2
O(ε)
O(ε2)

ε

10-1

τ = 5.3ε

q = 1
q = 3
q = 7
O(ε)

100

10-1

10-2

10-3

10-4

10-5

10-6

2

--

M

)
a
t
(

¯H
−

)

M

,
a
t
(
F

--

10-7

10-6

10-5

10-4

ε

10-3

10-2

10-1

Figure 5.1. (Left) The diﬀerences m − m0 and m − ˜m, where
˜m = m0 + εm1 as ε −→ 0 are shown. The result shows that
the estimate (4.7) is sharp. (Right) The upscaling error, which is
estimated in Theorem 1, is depicted. An averaging domain of size
τ = 5.3ε is used in the simulation. The constant part of the error
corresponds to O((ε/τ )q+2) from Theorem 1 and it decreases upon
using smoother kernels with high q. This result conﬁrms the error
estimate from the Theorem.

18

D. ARJMAND, S. ENGBLOM, AND G. KREISS

100

2

--

M

)
a
t
(

¯H
−

)

M

,
a
t
(
F

--

10-1

10-2

τ = 0.1

q = 1
q = 3
q = 7

100

2

--

M

)
a
t
(

¯H
−

)

M

,
a
t
(
F

--

10-1

10-2

τ = 0.2

q = 1
q = 3
q = 7

10-3

10-2

ε

10-1

10-3

10-2

ε

10-1

Figure 5.2. The upscaling error from Theorem 1 is shown. The
error, |F − ¯H(ta)M|2, as ε −→ 0 is depicted for (Left) τ = 0.1,
(Right) τ = 0.2. The results verify the estimate in the theorem.

0.6

0.5

0.4

0.3

0.2

0.1

0

)
t
(
2

m

ε = 0.01, γ =1

M(t)
mε(t)

0.6

0.58

0.56

0.54

0.15

0.2

0.25

0.3

0.35

0.6

0.55

0.5

0.45

0.4

)
t
(
2

m

ε = 0.01, γ =1

M(t)
mε(t)

0.6

0.59

0.58

0.57

0.56

0.525 0.53 0.535 0.54

-0.1

-0.2

-0.1

0

0.1

0.2

m1(t)

0.3

0.4

0.5

0.6

0.35

0.35

0.4

0.45

0.5

0.55

0.6

m1(t)

=

where H0

5.3. The HMM solution M with H(t, t/ε) =
Figure
(Left)
H0 + H1(t/ε),
H1(t/ε) = [sin(2πt/ε), cos(2πt/ε), 0]T
(Right) H1(t/ε) =
[sin(2πt/ε)2, cos(2πt/ε)2, 0]T ,
for ε = 0.01 is compared to the
exact solution mε. We have used β = 1, γ = 1, τ = 5ε, T = 2π,
△t = T /20 and a kernel K ∈ Kp,q with p = 5, q = 4 in the
simulations. The average behaviour of the ﬁne scale solution is
recovered by using only 20 points on the macroscopic grid.

[0, 0, 1]T

and

MULTISCALE MODELING IN MICRO MAGNETISM

19

σ = 0.0001, ε =0.01, Nrealisation =1, γ =1

M(t)
E[mε(t)]

0.6

0.5

0.4

0.3

0.2

0.1

0

)
t
(
2

m

σ = 0.0001, ε =0.01, Nrealisation =20, γ =1

M(t)
E[mε(t)]

0.6

0.5

0.4

0.3

0.2

0.1

0

)
t
(
2

m

-0.1

-0.2

-0.1

0

0.1

0.2

m1(t)

0.3

0.4

0.5

0.6

-0.1

-0.2

-0.1

0

0.1

0.3

0.4

0.5

0.6

0.2

m1(t)

Figure 5.4. The HMM solution M with H(t, t/ε) = H0 + Hε
sto,
where Hε
sto is given in (5.2) with σ = 0.0001. The paremeters
β, γ, T,△t and K are chosen as in Figure 5.3 and ε = 0.0033, τ =
(Left) The HMM solution with
15ε is used in this simulation.
only one realisation in the upscaling step is compared to E[mε]
(Right) The HMM solution with 20 realisations in the upscaling
step is compared to E[mε]. The average behaviour of the ﬁne scale
solution is recovered by using only 20 points on the macroscopic
grid.

ε = 0.01, γ =0.1

M(t)
mε(t)

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

)
t
(
2

m

σ = 0.0001, ε =0.01, Nrealisation =20, γ =0.1

M(t)
E[mε(t)]

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

)
t
(
2

m

-0.8

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

-0.8

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

m1(t)

m1(t)

Figure 5.5. The HMM solution M with (Left) Hε =
H0 + H1(t/ε), where H0 = [0, 0, 1]T
and H1(t/ε) =
[sin(2πt/ε), cos(2πt/ε), 0]T (Right) Hε = H0 + Hε
sto, where H0 =
[0, 0, 1]T and Hε
sto is given in (5.2) with σ = 0.0001. We have used
β = 1, γ = 0.1, τ = 5ε, T = 2π, △t = T /20 and a kernel K ∈ Kp,q
with p = 5, q = 4 in the simulations. The average behaviour of
the ﬁne scale solution is recovered by using only 20 points on the
macroscopic grid.

20

D. ARJMAND, S. ENGBLOM, AND G. KREISS

ε = 0.01, p =1, q =7

|Mn|
|M0|

1.0003

1.0002

1.0001

|
n

M

|

1

0.9999

0.9998

0.9997

0

1

2

3

t

4

5

6

10-1

10-2

10-3

10-4

10-5

10-6

10-7

10-8

10-6

p= 1, q=7

max0≤tn≤1 ||Mn|2 − 1|
O(ε)

10-5

10-4

10-3

10-2

10-1

ε

|Mn|N

5.6. The magnetisation amplitude

n=0 with
Figure
H(t, t/ε) = H0 + H1(t/ε), where H0 = [0, 0, 1]T and H1(t) =
[sin(2πt), cos(2πt), 0]T is computed using a kernel K ∈ Kp,q with
p = 1 and q = 7. (Left) The evolution of the magnetisation am-
plitude is illustrated for ε = 0.01. The HMM does not conserve
the initial length. (Right) The convergence of the magnetisation
length to unit length, as ε −→ 0, for τ = 5.3ε is depicted. The
O(ε) convergence rate is in a good agreement with the estimate
provided in Remark 8. The error O((ε/τ )q+2) is not seen in this
plot as q is chosen suﬃciently large.

MULTISCALE MODELING IN MICRO MAGNETISM

21

6. Discussion

We have proposed and analysed a multiscale method based on the HMM frame-
work for coupling disparate time scales in the Landau-Lifshitz equations of micro-
magnetism. The current study serves as a ﬁrst step in designing general upscaling
algorithms for incorporating eﬀects of microscopic variations into smoothly varying
macroscopic dynamics.

As a model problem we have considered a simple case where the microscopic
model is driven by a high frequency ﬁeld. We have shown that the HMM captures
the right eﬀective quantities by proving an error estimate between the HMM and
the exact averaged dynamics. Two important outcomes of the analysis are: (i) The
error between the HMM and the exact dynamics consist of discretisation errors
in the micro and macro levels and the upscaling error which can be pushed down
to O(ε), where ε ≪ 1 is a typical lengthscale representing the ratio between the
ﬁne and the coarse scales, (ii) Unlike one-scale methods such as the implicit mid-
point rule, the multiscale algorithms would, in general, suﬀer from non-constant
length of the magnetisation. However this error can be controlled upon choosing
an appropriate high-order micro solver along with a suitable choice for the size of
the local averaging domain, see Remark 8. Alternatively, a projection step could be
added at each time iteration to project the magnetisation to the unit sphere, which
is a common practice in micro-magnetic simulations, see e.g.
[20, 27]. Moreover,
the proposed microscopic and macroscopic models can be easily used with any
time-stepping scheme.

We believe that the results in the present article give a good insight regarding
the nature of the errors that may appear in more general settings where the eﬀec-
tive ﬁeld contains inﬂuences of spatial variations as well. The proposed method can
potentially be used to approximate macroscopic eﬀects that may arise in diﬀerent
physical problems such as spin waves. The extension of the current method to prob-
lems in micro-magnetism with multiple scales in spatial and temporal dimensions
is under investigation and will be addressed in upcoming reports.

References

[1] A. Abdulle, W. E, B. Engquist, and E. Vanden-Eijnden, The hetero-

geneous multiscale method, Acta Numerica, 21 (2012), pp. 1–87.

[2] A. Aharoni, Mathematical theory of ferromagnetism, Oxford Un. Press, 1996.
[3] G. Ariel, B. Engquist, S. J. Jim, and R. Tsai, Iterated averaging of
three-scale oscillatory systems, Commun. Math. Sci., 12 (2014), pp. 791–824.
[4] G. Ariel, B. Engquist, and R. Tsai, Numerical multiscale methods for

coupled oscillators, Multiscale Model. Sim., 7 (2009), pp. 1387–1404.

[5] G. Ariel, B. Engquist, and R. Tsai, A reversible multiscale integration

method, Comm. Math. Sci., 7 (2009), pp. 595–610.

[6] D. Arjmand and O. Runborg, Analysis of heterogeneous multiscale methods
for long time wave propagation problems, Multiscale Model. Sim., 12 (2014),
pp. 1135–1166.

[7] D. Arjmand and O. Runborg, A time dependent approach for removing the
cell boundary error in elliptic homogenization problems, to appear in J. Comp.
Phys., (2016), doi:10.1016/j.jcp.2016.03.009.

[8] L. Banas, Z. Brzezniak, M. Neklyudov, and A. Prohl, Stochastic fer-

romagnetism, De Gruyter Studies in Mathematics 58, 2014.

22

D. ARJMAND, S. ENGBLOM, AND G. KREISS

[9] L. Banas, A. Prohl, and M. Slodicka, Numerical scheme for augmented
landau-lifshitz equation in heat assisted recording, J. Comput. Appl. Math.,
236 (2012), pp. 4775–4787.

[10] N. N. Bogoliubov and Y. A. Mitropolski, Asymptotic methods in the

theory of non-linear oscillations, New York: Gordon and Breach, 1961.

[11] W. F. Brown, Thermal ﬂuctuations of a single-domain particle, Phys. Rev.,

130 (1963), pp. 1677–1686.

[12] F. Bruckner, C. Vogler, B. Bergmair, T. Huber, M. Fuger,
D. Suess, M. Feischl, T. Fuehrer, M. Page, and D. Praetorius,
Combining micromagnetism and magnetostatic maxwell equations for multi-
scale magnetic simulations, J. Magn. Magn. Mat., 343 (2013), pp. 163–168.

[13] J. Chen, C. J. Garcia-Cervera, and X. Yang, A mean-ﬁeld model for
spin dynamics in mutilayered ferromagnetic media, Multiscale Model. Sim., 13
(2015), pp. 551–570.

[14] I. Cimrak, A survey on the numerics and computations for the landau-lifshitz
equation of micromagnetism, Arch. Comp. Meth. Eng., 15 (2008), pp. 277–309.
[15] M. d’Aquino, C. Serpico, and G. Miano, Geometrical integration of
landau-lifshitz-gilbert equation based on the mid-point rule, J. Comp. Phys.,
209 (2005), pp. 730–753.

[16] V. Dobrovitski, M. Katnelson, and B. Harmon, Statistical coarsegrain-
ing as an approach to multiscale problems in magnetism, J. Magn. Magn. Mat.,
221 (2000), pp. L235–L242.

[17] W. E, Analysis of the heterogeneous multiscale method for ordinary diﬀerential

equations, Commun. Math. Sci., 1 (2003), pp. 423–436.

[18] W. E and B. Engquist, The heterogeneous multiscale methods, Commun.

Math. Sci., 1 (2003), pp. 87–133.

[19] W. E, D. Liu, and E. Vanden-Eijnden, Analysis of multiscale methods for
stochastic diﬀerential equations, Commun. on Pure and Appl. Math., LVIII
(2005), pp. 1544–1585.

[20] W. E and X. P. Wang, Numerical methods for the landau-lifshitz equation,

SIAM J. Numer. Anal., 38 (2000), pp. 1647–1665.

[21] B. Engquist and R. Tsai, Heterogeneous multiscale methods for stiﬀ ordi-

nary diﬀerential equations, Math. Comp., 74 (2005), pp. 1707–1742.

[22] D. A. Garanin, Fokker-planck and landau-lifshitz-bloch equations for classical

ferromagnets, Phys. Rev. B, 55 (1997).

[23] G. Grinstein and R. H. Koch, Coarse graining in micromagnetics, Phys.

Rev. Lett., 90 (2003), pp. 207201–1–4.

[24] C. Kittel, On the theory of ferromagnetic resonance absorption, Phys. Rev.,

73 (1948), pp. 155–161.

[25] M. Kruzik and A. Prohl, Recent developments in the modeling, analysis,

and numerics of ferromagnetism, SIAM Rev., 48 (2006), pp. 439–483.

[26] L. Landau and E. Lifshits, On the theory of the dispersion of magnetic
permeability in ferromagnetic bodies, Phys. Zeitsch. der Sow., 8 (1935), pp. 153–
169.

[27] D. Lewis and N. Nigam, Geometric integration on spheres and some inter-

esting applications, J. Comp. Appl. Math., 151 (2003), pp. 141–170.

[28] R. I. McLachlan, K. Modin, and O. Verdier, Symplectic integrators for

spin systems, Phys. Rev. E, 89 (2014).

MULTISCALE MODELING IN MICRO MAGNETISM

23

[29] G. A. Pavliotis and A. Stuart, Multiscale methods: Averaging and ho-

mogenization, Text in Applied Mathematics, Springer, 2008.

[30] M. Poluektov, O. Eriksson, and G. Kreiss, Scale transitions in mag-

netisation dynamics, 2015. Preprint.

[31] A. Prohl, Computational micromagnetism, Advances in Numerical Mathe-

matics, 2001.

[32] W. Scholz, T. Schrefl, and J. Fidler, Micromagnetic simulation of ther-
mally activated switching in ﬁne particles, J. Magn. Magn. Mat., 233 (2001),
pp. 296–304.

[33] V. Tsiantos, W. Scholz, D. Suess, T. Schrefl, and J. Fidler, The
eﬀect of the cell size in langevin micromagnetic simulations, J. Magn. Magn.
Mat., 242–245 (2002), pp. 999–1001.

[34] E. Vanden-Eijnden, Numerical techniques for multiscale dynamical systems

with stochastic eﬀects, Commun. Math. Sci., 1 (2003), pp. 385–391.

E-mail address: doghonay.arjmand, stefane, gunilla.kreiss@it.uu.se

Division of Scientific Computing, Department of Information Technology, Uppsala

University, SE-751 05 Uppsala, Sweden.

