Two dimensional, electronic particle tracking in liquids with a

graphene-based magnetic sensor array

R. F. Neumann1, M. Engel2, and M. Steiner1

1IBM Research, Av. Pasteur 138 & 146, Urca, Rio de Janeiro, 22290-240, Brazil

2IBM Research, Yorktown Heights, New York, 10598, United States

March 7, 2016

Abstract

The investigation of liquid ﬂow at the nanoscale is a key area of applied research with high relevance to

Physics, Chemistry and Biology. We introduce a method and a device that allows to spatially resolve liquid

ﬂow by integrating an array of graphene-based magnetic sensors used for tracking the movement of magnetic

nanoparticles in the liquid under investigation. With a novel device conception based on standard integration

processes and experimentally veriﬁed material parameters, we simulate the performance of a single sensor pixel,

as well as the whole array, for tracking magnetic nanoparticles. The results demonstrate the ability (a) to detect

individual nanoparticles in the liquid and (b) to reconstruct particle trajectories across the sensor array as a

function of time, in what we call “Magnetic Nanoparticle Velocimetry” technique. Being a non-optical detection

method, potential applications include particle tracking and ﬂow analysis in opaque media at sub-micron scales.

1 Introduction

The characterization of liquid behavior at the nanoscale, including wetting phenomena and ﬂow, is a key objective

for research in Physics, Chemistry, and Biology with potential technological applications across various industries.

Liquids conﬁned in microscale and nanoscale porous media exhibit diﬀerent physical behaviors than those in larger

dimensions, mainly due to the increased surface-to-volume ratio, leading to enhanced surface eﬀects, and to the

breakdown of the continuum framework for ﬂow [1, 2]. A method that allows to measure liquid ﬂow with nanometer

scale resolution would enable the analysis of liquid-solid interactions that are not typically captured in continuum

ﬂow models.

Characterizing ﬂow in very small constrictions is typically achieved by tracking individual particles immersed in

the liquid under study using optical microscopy methods [3, 4]. These methods require optically transparent samples,

calling for an all-electronic detection method which could be integrated with non-transparent samples.

Indeed,

signiﬁcant progress in the integration of electronic sensing functionalities for the characterization of ﬂuids has been

made [5, 6, 7, 8, 9, 10]. However, a sensor (array) that can be integrated with microﬂuidic or nanoﬂuidic devices

and able to track electronically the movement of a single nanoparticle (< 100 nm) has yet to be demonstrated. Most

demonstrations so far lack the sensitivity to detect single nanoparticles, the ability to track moving nanoparticles,
or have limited spatial resolution due to large active sensor areas ((cid:38) 10µm2).

Previous attempts at detecting small magnetic particles employing Si- [11, 12], InSb- [13], and InAs/AlSb [14] Hall

devices targeted the detection of magnetic microbeads composed by thousands of nanometer-sized iron-oxide particles

1

6
1
0
2

 
r
a

M
3

 

 
 
]
l
l
a
h
-
s
e
m

.
t
a
m
-
d
n
o
c
[
 
 

1
v
8
9
2
1
0

.

3
0
6
1
:
v
i
X
r
a

dispersed in a polymer matrix. Analogously, Al2O3- [15] and MgO-based [16, 17] Magnetic Tunnel Junctions have also
been used to detect such magnetic microbeads. Giant magnetoresistance spin valve sensors [18] or semiconductor-

based Hall sensors [19, 20] were used to detect compound nanobeads made of hundreds or thousands of sub-20 nm

particles, provided they were attached directly to the sensor.

Graphene, due to its favorable electronic properties, has been identiﬁed as candidate material for electronic ﬂow

sensing. Flow sensing based on single-cell detection was achieved employing a graphene transistor array integrated

into a microﬂuidic channel [21]. Moreover, all-electronic detection of the average ﬂow speed in a microchannel was

demonstrated by measuring the streaming potential of an electrolyte solution through the changes it caused in the

electrical properties of a graphene transistor integrated into the microﬂuidic chip [22, 23]. Based on its potential to

integrate within ﬂuidic devices and to shrink lateral dimensions below the micrometer scale, a graphene-based Hall
sensor [24, 25] could be used to detect single magnetic nanoparticles immersed in a liquid in nanoscale constrictions.

Furthermore, the integration of a two-dimensional sensor array within a ﬂuidic channel device would provide an all-

electronic means of tracking a particle’s position through the simultaneous analysis and correlation of Hall-voltage

changes in each individual sensor of the array.

2 Results and Discussion

We discuss in the following an integration framework and investigate numerically an all-electronic, device-based

method to map liquid ﬂow at the nanometer scale by tracking an individual magnetic nanoparticle immersed in the

liquid under study. To that end, we introduce the conception of an array of graphene-based Hall-eﬀect sensors which is

integrated with a ﬂuid channel device based on realistic manufacturing steps. We perform a numerical analysis based

on experimentally conﬁrmed material parameters that reveals quantitatively the sensitivity of individual nanoparticle
detection in the liquid as a function of the particle position. A simultaneous analysis of Hall voltages from N × M
graphene-based Hall detectors forming a sensor array allows to reconstruct the two-dimensional particle trajectory

within the channel device.

2.1 Device implementation and principle of operation

Based on basic integration steps and standard manufacturing principles, we introduce an approach to implement

an integrated, two dimensional nanoscale ﬂow sensor. The sensing scheme presented here requires on-demand gener-

ation of DC and AC magnetic ﬁelds to facilitate static and dynamic magnetization in conjunction with a Hall sensor

device. In Figure 1(a)-(e) we illustrate the monolithic integration of the diﬀerent functional layers.

We start with a planar substrate that in principle can be solid or ﬂexible like, for example, silicon or polyimide,

as in Figure 1(a). In Figure 1(b) we show the ﬁrst functional layer which is a co-planar spiral inductor that is used

to generate a DC magnetic ﬁeld. First a dielectric layer is deposited followed by patterning and pattern transfer

by means of dry etching. Next metal is evaporated in the patterned trenches followed a planarization step. This

process sequence is repeated with a via etch in between to create a underpass metal line that provides connection

to the inner contact of the spiral [26]. Optionally, a ferromagnetic core can be included into the spiral to increase

the DC magnetic ﬁeld [27]. In Figure 1(c) we illustrate the second functional layer that is a metal line to produce

a AC magnetic ﬁeld. Fabrication is similar to the previous layer except that the process has only to be done once.

To insulate the second functional layer from the Hall sensor device another dielectric layer is deposited followed by

transfer of graphene on top of the dielectric surface by a suitable process [28], as illustrated in Figure 1(d). Next the

Hall bar structure is patterned and etched into the graphene by for example oxygen plasma. In a ﬁnal step metal

contacts to the graphene are deﬁned followed by metallization and a metal lift-oﬀ process, as shown in Figure 1(e).

2

Figure 1(e) also shows the working principle of the sensor. The Hall device is voltage biased (Vbias) while the
appropriate DC and AC magnetic ﬁelds are generated by independently applying voltages VDC and VAC, respectively.
The interplay between the BDC and BAC components of the applied ﬁeld Bapp is depicted in Figure 1(f). A small
AC ﬁeld BAC ∼ 100 mT is continuously applied. It induces an AC magnetization on the nanoparticle, that should be
in-phase with the applied ﬁeld provided that the period of oscillation τAC is larger than the nanoparticle’s relaxation
time [29]. A stronger DC ﬁeld BDC ∼ 102 mT is switched on and oﬀ at regular intervals τDC (cid:29) τAC. The DC ﬁeld
(partially) saturates the nanoparticle, therefore decreasing its susceptibility and the amplitude of the AC component
of the magnetization. The variation of the Hall voltage VH AC amplitude between the “on” and “oﬀ” states of the
DC ﬁeld is directly aﬀected by the presence of a nanoparticle nearby.
In Figure 1(g) we illustrate the proposed

sensing platform in combination with a ﬂuidic channel on top that guides magnetic nanoparticles across the Hall

sensor devices.

The VH(t) signal measured by the sensor is modiﬁed in presence of a nanoparticle and, therefore, may be used
to extract its location (cid:126)r0(t) within the channel. The integrated device conception illustrated in Figure 1(g) enables
tracking a magnetic nanoparticle’s position with respect to the embedded sensor array. This device geometry, with
N sensors and M measuring pads per sensor, permits the collection of N × M independent Hall voltage signals VH(t)
– a task which might be performed in parallel or sequentially. The matrix [VH(t)]n,m contains the information for
localizing nanoparticles and for estimating their ﬂow velocity inside the channel. This matrix can be thought of as a

two-dimensional pixel array, with each pixel providing a certain voltage signal that reﬂects the presence of a nearby

nanoparticle. As a nanoparticle crosses the array, the pixels indicate the nanoparticle’s presence through changes in

their respective Hall voltages. By analyzing and correlating the signals of a set of “pixels” it is, hence, possible to

determine a particle’s position, velocity, and trajectory with respect to the sensor array.

In view of applications, we note that when considering a superparamagnetic nanoparticle solution, a liquid such

as water should be used so that diamagnetic eﬀects can be neglected. Also, the nanoparticle concentration should

be adjusted in order to avoid agglomeration; see Appendix. In addition, surface coating and functionalization within

the ﬂuid channel may be considered as well [30].

2.2 Simulated device operation and sensitivity assessment

In the following, we discuss simulations of the device operation obtained by numerically solving the charge

continuity equation in an ohmic medium (Equation 1) under the inﬂuence of the spatially inhomogeneous magnetic

ﬁeld (Equation 2) provided by a nanoparticle. The following results assume a graphene sensor with a “triple cross”

geometry containing three measuring pads (L / C / R), as the one in Figure 2, with the following dimensions:
Lx = 1 µm, Ly = 100 nm and (cid:96)x = (cid:96)y = 40 nm. We use realistic electronic parameters for modeling the graphene
sheet [31, 32, 33], i.e. ρ = 1016 m−2 and µ = 1.5 m2V−1s−1. A DC voltage V0 = 100 mV is applied along x by an
external source in order to impose a current ﬂow. Whenever a magnetic ﬁeld acts upon the current, a transverse
Hall voltage VH emerges in one or more of the measuring pads. Unless stated otherwise, the applied magnetic ﬁelds
were BAC = 5 mT and BDC = 100 mT. For more information on the choice of magnetic ﬁelds, see Appendix. All
calculations were performed at T = 300 K but no signiﬁcant changes were observed to within 50 K of that value. The
nanoparticle saturation magnetization was chosen as MS = 380 kA/m for it is a typical value for widely-available
iron-oxide nanomaterials [34, 35].

The change in the AC component of the Hall voltage when the DC ﬁeld is applied is the chosen ﬁgure-of-merit,
for it is highly sensitive to the nanoparticle’s position. We represent this ﬁgure-of-merit as δV γ
H (Equation 3), where
γ controls whether there is (γ = 1) or not (γ = 0) a nanoparticle nearby. The relationship between Equation 3
and its experimental realization can be understood in terms of the applied ﬁeld in Figure 1(f). While δV 0
H is the

3

baseline signal and needs to be measured only once (before the nanoparticle solution is inserted), the detection signal
δV 1
H needs to be measured continuously over time. The minuend on the left corresponds to the measurement of the
AC Hall voltage during the times when the DC ﬁeld is “oﬀ”, while the subtrahend on the right corresponds to the

measurement performed when the DC ﬁeld is “on”. By continuously measuring the AC amplitude on both the “on”

and “oﬀ” states of the DC ﬁeld, by means of integrated circuitry, one can monitor the presence of a nearby magnetic
nanoparticle with time resolution of 2τDC, simply by comparing the detection signal to the baseline.

Using the previously mentioned values for the parameters, the baseline level was calculated to be at δV 0

The intensity of the δV 1
values of the ﬁgure-of-merit δV γ
Hall voltage AC amplitude caused by a nearby nanoparticle at a given measuring pad m can exceed a 100-fold

H/δV 0
H

H = 0.56 µV.
H Hall voltage depends on the size D and position (cid:126)r0 of the nanoparticle. In general, typical

H range from 100 to 102 µV, so that the relative change Ωm =(cid:0)δV 1

(cid:1)(cid:12)(cid:12)m in the

increase. For more details on the calculation, see Appendix.

2.3 Single-pixel performance and nanoparticle detection

In order to simulate the detection of a magnetic nanoparticle as it moves across a single sensor, the Hall detection
signals at the central measuring pad were calculated for several nanoparticle positions (cid:126)r0. Figure 3(a) shows the
detection signals δV 1
H obtained for a D = 30 nm nanoparticle at positions (x0, y0) in the z0 = 100 nm plane. The
maximum value corresponds roughly to a 30-fold increase with respect to the baseline level. One can see in the graph

that the eﬀect of the magnetic ﬁeld is strongly localized within 200 nm around the point on the sensor surface below
it. Numerical analysis of Equation 2 conﬁrmed by calculations for diﬀerent z0 indicate that the half-width of the
peak is about 2z0. The upper inset in Figure 3(a) shows that, as the nanoparticle moves along y on the x0 = 0 nm
line (in red), a bell-shaped voltage peak is detected as a function of time by the central sensor, reaching a maximum
ΩC ∼ 30-fold increase with respect to the baseline level δV 0
H = 0.56 µV. When the x-coordinate of the nanoparticle
moves away from the central measuring pad, the voltage signal decreases drastically, as can be seen in the lower inset

graph of Figure 3(a).

According to these results, and using Figure 2 as geometrical reference, nanoparticles ﬂowing along y in the middle
of the channel (x0 ≈ 0 nm) generate voltage signals mainly on measuring pad “C”, while nanoparticles ﬂowing closer
to the left (right) channel wall generate voltage signals mainly on the “L” (“R”) measuring pad. Therefore, the

resolution for nanoparticle detection in x (y) is related to the distance ∆x (∆y) between the pixels. In other words,

the higher the pixel density, the better the spatial resolution.

For greater vertical distances, larger nanoparticles are required to maintain an Ω-value suﬃcient for single particle
detection. The dependence of Ω on the nanoparticle diameter D and vertical distance z0 is shown in Figure 3(b),
for a nanoparticle located directly above the central measuring pad. For example, at z0 = 500 nm (1000 nm), a
D = 50 nm (100 nm) nanoparticle is required to achieve a moderate sensitivity of Ω ≈ 3, as illustrated by the dashed
line. The nanoparticle size should, therefore, be selected depending on the channel height and the desired sensitivity

threshold of the sensor. In essence, a sub-100 nm magnetic particle will be detectable within ﬂuid channels having

heights of up to 1 µm. For a more detailed study of the size and distance dependence, see Appendix.

2.4 Multi-pixel nanoparticle tracking and trajectory reconstruction

Having established the detection capabilities of an individual, graphene-based Hall sensor, we will now investigate

the detection capabilities of a two-dimensional sensor array.

In order to illustrate the trajectory reconstruction

methodology, we generated synthetic data simulating the movement of a nanoparticle across a two-dimensional
sensor array with N × M Hall crosses that collect a matrix of δV 1
H voltage signals as a function of time, as shown

4

in Figure 4(a). In this particular example, we use a 3 × 3 pixel array located at points (cid:126)Pij = (i∆x, j∆y, 0) with
(i, j) ∈ {1, 2, 3}. The response function of pixel (i, j) was modeled as a Gaussian centered at (cid:126)Pij with σx = σy = 0.3.

The particle trajectory in this example was (cid:126)r0(t) = (cid:0)1 + t
voltage signals depicted in Figure 4(b). At every time step, the distances dij = | (cid:126)Pij − (cid:126)r0| = Gauss−1(cid:0)[δV 1

the pixel centers were calculated and the three closest pixels used to deﬁne a triangle {P1, P2, P3}, as in Figures 4(a)
and 4(c). Using a standard trilateration algorithm [36], the nanoparticle position (cid:126)r0 was calculated at each time
step as a function of the distances {d1, d2, d3} and sensor coordinates {P1, P2, P3}, reconstructing the full trajectory.
The nanoparticle velocity d
dt(cid:126)r0(t) was calculated using ﬁnite diﬀerences. The ﬁnal results in Figure 4(c) demonstrate
agreement between simulated and reconstructed trajectories.
In general, an experimental characterization of the

50 , 1 + 2 sin πt

100 , 0(cid:1) for t ∈ [0, 100], which generated the
(cid:1) to

H]ij

voltage-distance response function is required to calibrate the distances given the measured voltage signals. In order

to illustrate the reconstruction of the nanoparticle trajectory from the voltage signals we provide a video in the

Appendix.

We would like to point out that there are general rules-of-thumb that may be considered while choosing the

several length and time constants involved in the method, for they impose limits on the trajectories and velocities
that can be measured. Each measurement of δV γ
H requires the deﬁnition of an integration window τint for the lock-in
ampliﬁer. We suggest choosing τint = τDC (cid:38) 10τAC, so that every plateau of BDC encompasses several oscillations
of BAC and allows for the integration of the signal by the lock-in ampliﬁer. By synchronizing the lock-in ampliﬁer
to BDC and setting τint = τDC, every measurement corresponds to either the minuend or subtrahend of Equation 3,
so that a new value for δV 1
H is obtained every 2τDC. The frequency of data collection is the largest limitation to the
ﬁdelity of reconstructed trajectories and velocities.

In terms of applications, the graphene-based sensor array could be integrated with “lab-on-chip” immunoassay

devices as magnetic nanoparticles are widely used for separation, biosensing and sampling [37, 38, 39, 40]. In addition,

the array could be integrated to measure ﬂuid ﬂow properties in micro- or nanochannels made of opaque materials,

such as “reservoir-on-chip” micromodels using geo-materials [41, 42, 43]. The potentially high spatial resolution of

the array allows the investigation of liquid-solid interactions, such as wettability and slip phenomena, which could

unveil novel aspects of the ﬂuid’s behaviour at the nanometer scale. Finally, an extension of the graphene-based

sensor conception to other 2D materials is needed in order to take advantage of the tunable electronic properties of

novel semiconductor materials.

3 Conclusions

In summary, we have investigated a graphene-based Hall-eﬀect sensor array that is integrated within a ﬂuid

channel device for characterizing liquid ﬂow at the nanoscale. We have introduced an implementation concept based

on CMOS-compatible manufacturing steps and, based on experimentally veriﬁed materials parameter, we have

performed numerical simulations for quantifying integrated device operation and detection sensitivity. Based on our

analysis results, the system is capable of (1) performing nanoparticle detection by means of a single sensor pixel and

(2) to record nanoparticle trajectories based on the simultaneous analysis of multiple voltage signals in case a multi-

pixel sensor array is used. A sensitivity analysis indicates that sub-100 nm magnetic particles are detectable within

ﬂuid channels having heights of up to 1 µm. The device conception and the “Magnetic Nanoparticle Velocimetry”

method has potential as a ﬂow sensing technique for the characterization of liquid behavior at the nanoscale, including

wetting phenomena and ﬂow, with potential technological applications in industrial and applied research.

5

Computational method

The Hall device was modelled as a two-dimensional conducting sheet at z = 0 with carrier density ρ and carrier
mobility µ, representing a graphene sheet [31]. The geometry of the sheet is composed of a rectangular section with
dimensions (Lx, Ly) and a set of M measuring pads or “crosses” with dimensions ((cid:96)x, (cid:96)y) equally spaced along the
rectangular section by a distance ∆x = Lx/(M + 1). The sensor is oriented perpendicular to the ﬂuidic channel so
that nanoparticles ﬂow along y and the channel width is comparable to Lx.

ponents σxx = σyy = σ0/(cid:2)1 + (µB)2(cid:3) and σxy = −σyx = µBσxx, where σ0 = ρeµ is the zero-ﬁeld conductivity and

The electrical transport in the sensor is described by its space-dependent conductivity tensor ¯σ(x, y), with com-

B(x, y) is the inhomogeneous magnetic ﬁeld perpendicular to the sensor surface. Combining the continuity equation
∇ · (cid:126)J = 0 with Ohm’s law (cid:126)J = ¯σ (cid:126)E leads to the PDE that provides the electrostatic potential φ(x, y)

∇ · [¯σ(x, y)∇φ(x, y)] = 0

(1)

under Dirichlet boundary conditions to enforce φ(Lx/2, y) − φ(−Lx/2, y) = V0. The Hall voltage VH for a given
magnetic ﬁeld is calculated by taking the diﬀerence of the average potential at opposite sides of a given measuring

pad. Due to the inhomogeneous nature of Equation 1, its solutions can only be obtained numerically [44, 45, 46], a
task for which we used the PDE solver FreeFem++ [47, 48]. The computational mesh employed is similar to that of
Figure 2, only twice as dense, containing 1000 points along the contour. A self-adaptive mesh was also tested, but

results turned out to be more numerically stable and reproducible with an homogeneous mesh.

A superparamagnetic nanoparticle located at position (cid:126)r0 = (x0, y0, z0) inside the liquid, is subject to a homoge-
neous applied ﬁeld Bapp, with DC and AC components such that BDC (cid:29) BAC. The magnetization of such nanopar-
ticle at temperature T is given by a Langevin function M (Bapp, T ) = MSL (MSV Bapp/kBT ), where V = (π/6)D3 is
the volume of the nanoparticle [29, 49]. The magnetic dipole ﬁeld created by the nanoparticle’s magnetic moment

at (and perpendicular to) the z = 0 plane is given by

(cid:20) 3z2

µ0
4π

M V

0 − r(x, y)2
r(x, y)5

(cid:21)

,

(2)

where r(x, y) =(cid:112)(x − x0)2 + (y − y0)2 + z2

BNP(x, y) =

0. Finally, the total magnetic ﬁeld is simply the sum of the applied and

induced ﬁeld components B(x, y) = BDC + BAC + BNP(x, y).

Since all AC phenomena is restricted to frequencies well below the GHz range, a quasi-static approach for the

transport in graphene is acceptable [50]. Therefore, the eﬀect of having magnetic ﬁelds with both AC and DC

components acting on the sensor is the emergence of a Hall voltage with the same time dependence. The amplitude

of the in-phase AC Hall voltage can be calculated simply by taking diﬀerences of the Hall voltage obtained at the
maximum and minimum values of the BAC ﬁeld, with or without the BDC ﬁeld and with or without a magnetic
nanoparticle nearby.

We denote by V α,β,γ

H

and γ = {0, 1}. Therefore, we express the amplitude of the AC component by
the variation in the AC amplitude due to the application of a DC ﬁeld is, thus,

the Hall voltage calculated with B = αBDC +βBAC +γBNP, where α = {0, 1}, β = {−1, +1}
. Consequently,

− V α,−1,γ

V α,+1,γ
H

H

(cid:17)

H ≡(cid:16)

δV γ

(cid:17) −(cid:16)

V 0,+1,γ
H

− V 0,−1,γ

H

V 1,+1,γ
H

− V 1,−1,γ

H

.

(3)

(cid:16)

(cid:17)

The change in the AC amplitude due to the DC ﬁeld is aﬀected by the presence of a nearby nanoparticle, which is

controlled by parameter γ. The device working conditions can be tailored as to create a substantial diﬀerence between

6

H

H (with NP) and δV 0

range from 101 to 103 microvolts. The amplitude of the Hall voltage AC component

the δV 1
H (no NP) levels, so that they can be distinguished experimentally. In general, typical values
− V α,−1,γ
of V α,β,γ
is, typically, of the order of 102 µV, which should not pose a problem to state-of-the-art scientiﬁc measurement
tools [51].

V α,+1,γ
H

H

(cid:16)

(cid:17)

Acknowledgement

R. F. Neumann thanks Benoit Jouault (Universit´e Montpellier 2/CNRS) for help with FreeFem++, Em´ılio Vital
Brazil and Rodrigo da Silva Ferreira (IBM Research) for fruitful discussions regarding the particle trajectory recon-

struction algorithm. M. Engel thanks David W. Abraham and N. Wang (IBM Research) for discussion regarding

device implementation.

A Appendix

We present in the Appendix some additional results to be used as a guideline for the choice of parameters.

Speciﬁcally, we discuss the choice of nanoparticle diameter and concentration, the choice of magnetic ﬁeld components

and present details of the numerical calculations.

A.1 Choice of nanoparticle concentration

(cid:104)

(cid:105)

πD3

2MS

4π cv

In order to help the reader select the nanoparticle volume/volume concentration cv depending on the nanopar-
ticle diameter D, Figure 5 shows the comparison between the typical magnetic dipole-dipole interaction energy
Ed-d = − µ0
and the thermal energy kBT at room temperature, for nanoparticles with diameter D
and saturation magnetization MS = 380 kA/m. The formula for Ed-d was obtained by calculating the dipolar en-
ergy between neighbouring nanoparticles, assuming they are placed in a cubic lattice. The dashed line represents
|Ed-d| = kBT at room temperature. Thermal agitation is expected to prevent agglomeration for (cv, D) points well
below the dashed line.

6

A.2 Visualization of raw results

The numerical solution to Equation 1 provided by FreeFem++ consists of a two-dimensional function φ(x, y)
deﬁned on a mesh within the sensor geometrical boundaries as in Figure 2. In Figure 6 one can see the φ(x, y) used
to calculate V 1,+1,1
methodology.

. Table 1 illustrates the typical raw values that enter Equation 3, as calculated by the current

H

[µV ]
V 0,+1,γ
H
V 0,−1,γ
H
V 1,+1,γ
H
V 1,−1,γ
H
δV γ
H

no NP with NP
74.39
-77.98
1595.91
1444.10

75.84
-79.43
1598.61
1446.80

0.56

3.46

Table 1: Individual Hall voltage values used to calculate δV 0
H at the central measuring pad according to
Equation 3. This table corresponds to a D = 20 nm nanoparticle at z0 = 100 nm above the origin and excited by
BAC = 5 mT and BDC = 100 mT magnetic ﬁelds.

H and δV 1

7

A.3 Choice of magnetic ﬁeld components

in terms of the relative change Ωm =(cid:0)δV 1

H/δV 0
H

For the choice of the AC and DC components of the applied magnetic ﬁeld, several combinations were evaluated

(cid:1)(cid:12)(cid:12)m in the Hall voltage AC amplitude they induce. In Figure 7 one

H in Figure 7(b) changes drastically with respect to the baseline level δV 0

ﬁnds the results for the detection of a D = 20 nm nanoparticle z0 = 100 nm away from the origin. The detection
signal δV 1
H in Figure 7(a), specially for low
BAC ﬁelds. As a result, the relative change in the signal that allows for the detection of an adjacent nanoparticle
attains higher values on the lower left corner of Figure 7(c). The 6-fold increase in the signal for BAC = 5 mT and
BDC = 100 mT is large enough for most experimental implementations and, therefore, those ﬁeld values were chosen.
For larger nanoparticles, even higher Ω values are obtained.

A.4 Choice of nanoparticle size

As presented in Figure 3b, the nanoparticle diameter D must be chosen in accordance with the channel height,

for it limits the maximum vertical distance z0 at which the nanoparticle is detectable.
In order to facilitate the
selection of diameters, Figures 8(a) and 8(b), respectively, show the dependency of Ω on D for selected z0 and on z0
for selected D. For a target sensitivity of Ω = 3, represented by a dashed line, one clearly concludes that D = 50 nm

and 100 nm nanoparticles are required for channels as high as 500 nm and 1000 nm respectively.

References

[1] Jan CT Eijkel and Albert Van Den Berg. Nanoﬂuidics: what is it and what can we expect from it? Microﬂuidics

and Nanoﬂuidics, 1(3):249–267, 2005.

[2] Lyd´eric Bocquet and Elisabeth Charlaix. Nanoﬂuidics, from bulk to interfaces. Chemical Society Reviews,

39(3):1073–1095, 2010.

[3] Minami Yoda. Nano-particle image velocimetry: A near-wall velocimetry technique with submicron spatial

resolution. In BioMEMS and Biomedical Nanotechnology, pages 331–348. Springer, 2007.

[4] Jae S Park, Chang K Choi, and Kenneth D Kihm. Nano-ptv using confocal microscopy. In ASME 2004 Heat

Transfer/Fluids Engineering Summer Conference, pages 551–557. American Society of Mechanical Engineers,

2004.

[5] Lei Chen, Jiapeng Yu, and Hao Wang. Convex nanobending at a moving contact line: The missing mesoscopic

link in dynamic wetting. ACS Nano, 8(11):11493–11498, 2014.

[6] Detlef Lohse and Xuehua Zhang. Surface nanobubbles and nanodroplets. Reviews of Modern Physics, 87(3):981,

2015.

[7] Peter Nirmalraj, Damien Thompson, Agust´ın Molina-Ontoria, Marilyne Sousa, Nazario Mart´ın, Bernd Gots-

mann, and Heike Riel. Nanoelectrical analysis of single molecules and atomic-scale materials at the solid/liquid

interface. Nature Materials, 2014.

[8] Fong Yew Leong, Utkur M Mirsaidov, Paul Matsudaira, and L Mahadevan. Dynamics of a nanodroplet under

a transmission electron microscope. Physics of Fluids, 26(1):012003, 2014.

8

[9] MB Steiner, M Engel, PW Bryant, R Giro, RF Neumann, P Avouris, and C Feger. Nanowetting microscopy

probes liquid-solid interaction at the nanoscale. In SPE Asia Paciﬁc Enhanced Oil Recovery Conference. Society

of Petroleum Engineers, 2015.

[10] Seokwoo Jeon, Viktor Malyarchuk, Jeﬀrey O White, and John A Rogers. Optically fabricated three dimensional

nanoﬂuidic mixers for microﬂuidic devices. Nano Letters, 5(7):1351–1356, 2005.

[11] Pierre-A Besse, Giovanni Boero, Michel Demierre, Vincent Pott, and Radivoje Popovic. Detection of a single

magnetic microbead using a miniaturized silicon hall sensor. Applied Physics Letters, 80(22):4199–4201, 2002.

[12] Goran Mihajlovi´c, Khaled Aledealat, Peng Xiong, Stephan Von Molnar, Mark Field, and Gerard J Sullivan.

Magnetic characterization of a single superparamagnetic bead by phase-sensitive micro-hall magnetometry. Ap-

plied Physics Letters, 91(17):172518, 2007.

[13] Lorenzo Di Michele, Connor Shelly, Patrizia de Marco, Patrick See, David Cox, and Olga Kazakova. Detection

and susceptibility measurements of a single dynal bead. Journal of Applied Physics, 110(6):063916, 2011.

[14] Goran Mihajlovi´c, Peng Xiong, Stephan Von Moln´ar, Mark Field, Gerard J Sullivan, Keita Ohtani, and Hideo

Ohno. Submicrometer hall sensors for superparamagnetic nanoparticle detection. Magnetics, IEEE Transactions

on, 43(6):2400–2402, 2007.

[15] Weifeng Shen, Xiaoyong Liu, Dipanjan Mazumdar, and Gang Xiao.

In situ detection of single micron-sized

magnetic beads using magnetic tunnel junction sensors. Applied Physics Letters, 86(25):253901, 2005.

[16] Weifeng Shen, Benaiah D Schrag, Matthew J Carter, Jin Xie, Chenjie Xu, Shouheng Sun, and Gang Xiao.

Detection of dna labeled with magnetic nanoparticles using mgo-based magnetic tunnel junction sensors. Journal

of Applied Physics, 103(7):07A306, 2008.

[17] Weifeng Shen, Benaiah D Schrag, Matthew J Carter, and Gang Xiao. Quantitative detection of dna labeled with

magnetic nanoparticles using arrays of mgo-based magnetic tunnel junction sensors. Applied Physics Letters,

93(3):033903, 2008.

[18] Guanxiong Li, Shouheng Sun, Robert J Wilson, Robert L White, Nader Pourmand, and Shan X Wang. Spin

valve sensors for ultrasensitive detection of superparamagnetic nanoparticles for biological applications. Sensors

and Actuators A: Physical, 126(1):98–106, 2006.

[19] Lorenzo Di Michele, Connor Shelly, John Gallop, and Olga Kazakova. Single particle detection: Phase control

in submicron hall sensors. Journal of Applied Physics, 108(10):103918, 2010.

[20] A Manzin, V Nabaei, and O Kazakova. Modelling and optimization of submicron hall sensors for the detection

of superparamagnetic beads. Journal of Applied Physics, 111(7):07E513, 2012.

[21] Priscilla Kailian Ang, Ang Li, Manu Jaiswal, Yu Wang, Han Wei Hou, John TL Thong, Chwee Teck Lim, and

Kian Ping Loh. Flow sensing of single cell by graphene transistor in a microﬂuidic channel. Nano Letters,

11(12):5240–5246, 2011.

[22] Rong Xiang He, Peng Lin, Zhi Ke Liu, Hong Wei Zhu, Xing Zhong Zhao, Helen LW Chan, and Feng Yan.

Solution-gated graphene ﬁeld eﬀect transistors integrated in microﬂuidic systems and used for ﬂow velocity

detection. Nano Letters, 12(3):1404–1409, 2012.

9

[23] AKM Newaz, DA Markov, D Prasai, and KI Bolotin. Graphene transistor as a probe for streaming potential.

Nano Letters, 12(6):2931–2935, 2012.

[24] Vishal Panchal, David Cox, Rositza Yakimova, and Olga Kazakova. Epitaxial graphene sensors for detection of

small magnetic moments. Magnetics, IEEE Transactions on, 49(1):97–100, 2013.

[25] V Panchal, Karin Cedergren, Rositsa Yakimova, A Tzalenchuk, Sergey Kubatkin, and O Kazakova. Small

epitaxial graphene devices for magnetosensing applications. Journal of Applied Physics, 111(7):07E509, 2012.

[26] Adolfo C Reyes, Samir M El-Ghazaly, Steve J Dorn, Michael Dydyk, Dieter K Schroder, and Howard Patterson.

Coplanar waveguides and microwave inductors on silicon substrates. IEEE Transactions on Microwave Theory

and Techniques, 43(9):2016–2022, September 1995.

[27] C H Ahn and M G Allen. A planar micromachined spiral inductor for integrated magnetic microactuator

applications. Journal of Micromechanics and Microengineering, 3(2):37–44, June 1993.

[28] Xuesong Li, Yanwu Zhu, Weiwei Cai, Mark Borysiak, Boyang Han, David Chen, Richard D Piner, Luigi

Colombo, and Rodney S Ruoﬀ. Transfer of Large-Area Graphene Films for High-Performance Transparent

Conductive Electrodes. Nano Letters, 9(12):4359–4363, December 2009.

[29] Louis N´eel. Th´eorie du traˆınage magn´etique des ferromagn´etiques en grains ﬁns avec applications aux terres

cuites. Ann. G´eophys, 5(2):99–136, 1949.

[30] An-Hui Lu, E emsp14L Salabas, and Ferdi Sch¨uth. Magnetic nanoparticles: synthesis, protection, functional-

ization, and application. Angewandte Chemie International Edition, 46(8):1222–1244, 2007.

[31] Andre K Geim and Konstantin S Novoselov. The rise of graphene. Nature Materials, 6(3):183–191, 2007.

[32] Jian-Hao Chen, Chaun Jang, Shudong Xiao, Masa Ishigami, and Michael S Fuhrer.

Intrinsic and extrinsic

performance limits of graphene devices on sio2. Nature Nanotechnology, 3(4):206–209, 2008.

[33] Akin Akturk and Neil Goldsman. Electron transport and full-band electron-phonon interactions in graphene.

Journal of Applied Physics, 103(5):053702, 2008.

[34] David J Dunlop and ¨Ozden ¨Ozdemir. Rock magnetism:

fundamentals and frontiers, volume 3. Cambridge

university press, 2001.

[35] Bernard Dennis Cullity and Chad D Graham. Introduction to magnetic materials. John Wiley & Sons, 2011.

[36] Bryant N Sturgess and Frank T Carey. Trilateration. In The Surveying Handbook, pages 234–270. Springer,

1995.

[37] Kyu Sung Kim and Je-Kyun Park. Magnetic force-based multiplexed immunoassay using superparamagnetic

nanoparticles in microﬂuidic channel. Lab on a Chip, 5(6):657–664, 2005.

[38] Petr I Nikitin, Petr M Vetoshko, and Tatiana I Ksenevich. New type of biosensor based on magnetic nanoparticle

detection. Journal of Magnetism and Magnetic Materials, 311(1):445–449, 2007.

[39] Jaephil Do and Chong H Ahn. A polymer lab-on-a-chip for magnetic immunoassay with on-chip sampling and

detection capabilities. Lab on a Chip, 8(4):542–549, 2008.

10

[40] Alphonsus HC Ng, Kihwan Choi, Robert P Luoma, John M Robinson, and Aaron R Wheeler. Digital microﬂuidic

magnetic separation for particle-based immunoassays. Analytical Chemistry, 84(20):8805–8812, 2012.

[41] Naga Siva Kumar Gunda, Bijoyendra Bera, Nikolaos K Karadimitriou, Sushanta K Mitra, and S Majid Has-

sanizadeh. Reservoir-on-a-chip (roc): a new paradigm in reservoir engineering. Lab on a Chip, 11(22):3785–3792,

2011.

[42] Mark L Porter, Joaqu´ın Jim´enez-Mart´ınez, Ricardo Martinez, Quinn McCulloch, J William Carey, and Hari S

Viswanathan. Geo-material microﬂuidics at reservoir conditions for subsurface energy resource applications. Lab

on a Chip, 15(20):4044–4053, 2015.

[43] Wen Song, Thomas W de Haas, Hossein Fadaei, and David Sinton. Chip-oﬀ-the-old-rock: the study of reservoir-

relevant geological processes with real-rock micromodels. Lab on a Chip, 14(22):4382–4390, 2014.

[44] IS Ibrahim, VA Schweigert, and FM Peeters. Diﬀusive transport in a hall junction with a microinhomogeneous

magnetic ﬁeld. Physical Review B, 57(24):15416, 1998.

[45] S Liu, H Guillou, AD Kent, GW Stupian, and MS Leung. Eﬀect of probe geometry on the hall response in an

inhomogeneous magnetic ﬁeld: A numerical study. Journal of Applied Physics, 83(11):6161–6165, 1998.

[46] SJ Bending and A Oral. Hall eﬀect in a highly inhomogeneous magnetic ﬁeld distribution. Journal of Applied

Physics, 81(8):3721–3725, 1997.

[47] Fr´ed´eric Hecht. New development in freefem++. Journal of Numerical Mathematics, 20(3-4):251–266, 2012.

[48] B Jouault, L Bouguen, S Contreras, A Kerlain, and Vincent Mosser. Finite element modeling for temperature

stabilization of gated hall sensors. Journal of Applied Physics, 104(5):053705, 2008.

[49] CP Bean and JD Livingston. Superparamagnetism. Journal of Applied Physics, 30(4):S120–S129, 1959.

[50] Ming Liu, Xiaobo Yin, Erick Ulin-Avila, Baisong Geng, Thomas Zentgraf, Long Ju, Feng Wang, and Xiang

Zhang. A graphene-based broadband optical modulator. Nature, 474(7349):64–67, 2011.

[51] JJ Hudson, MR Tarbutt, BE Sauer, and EA Hinds. Stochastic multi-channel lock-in detection. New Journal of

Physics, 16(1):013005, 2014.

11

Figure 1: (a)-(e) 3D illustration of the process ﬂow for monolithic integration of (b) co-planar spiral inductor for
DC magnetic ﬁeld generation, (c) metal line for AC magnetic ﬁeld generation, (d) graphene transfer, (e) Hall device
deﬁnition and electrical interfacing. Also shown are the electrical connections and working principle. (f) Applied
ﬁeld Bapp as a function of time, depicting BAC = 5 mT and BDC = 100 mT components. While the AC component
is always on, the DC part is turned on and oﬀ at intervals τDC. (g) Platform comprising N sensors with M crosses
each, combined with a microﬂuidic channel that guides magnetic nanoparticles.

12

Figure 2: Sketch of the computational mesh and sensor geometry with indicated voltages. The VH Hall voltage signal
due to the total magnetic ﬁeld (including the spatially inhomogeneous nanoparticle ﬁeld) is calculated by solving the
electronic transport equations using a ﬁnite-element approach.

(a)

(b)

Figure 3: Single-pixel detection sensitivity demonstrated by numerical calculations. (a) Detection signal δV 1
H for a
D = 30 nm nanoparticle at several positions (x0, y0) in the z0 = 100 nm plane. The upper inset graph shows the
detection signal plotted along the color-coded lines in the main graph. The lower inset graph shows the value of
each curve on the upper inset graph for y0 = 0 nm. (b) Two-dimensional plot of the relative change Ω as a function
of the nanoparticle diameter D and vertical distance z0 for nanoparticles directly above the central measuring pad
(x0 = 0 nm, y0 = 0 nm). The dashed line represents Ω = 3.

13

VbiaslxlyLxLyVHLCRxyz−500−400−300−200−1000100200300400500x0[nm]−500−400−300−200−1000100200300400500y0[nm]0246810121416±V1H[¹V]−400−2000200400y0[nm]061218±V1H[¹V]0100200x0[nm]061218±V1H[¹V]1002003004005006007008009001000z0[nm]20406080100120140160180200D[nm]10-1100101102103104105­(a)

(b)

(c)

Figure 4: (a) Sketch of device implementation with 3 × 3 Hall crosses, integrated into a ﬂuidic channel (light blue)
where a nanoparticle (red) moves with an arbitrary trajectory (cid:126)r0(t). The dashed grid overlay represents the analogy
between the sensing units and a pixel array (green squares). The inset illustrates the trilateration algorithm used
to extract particle positions from voltage signals. Panel (b) shows the set of nanoparticle-induced voltage signals
used in our computational experiment, while (c) shows the reconstructed trajectory and velocity vector (red) at
t/(2τDC) = 86.

14

roP1P3P2d1d2d3di = |Pi - r0|r0(t)020406080100t=(2¿DC)0.00.20.40.60.81.01.2normalized ±V1HP1;3P1;2P1;1P2;3P2;2P2;1P3;3P3;2P3;1Figure 5: Typical magnetic dipole-dipole energy as a function of nanoparticle concentration and diameter. The
dashed line represents kBT at room temperature.

Figure 6: Sketch of the numerical solution to φ(x, y) showing the equipotential lines that indicate the existence of a
transverse Hall voltage V 1,+1,1

across the central measuring pad of a “triple-cross” geometry.

H

15

0.00.51.01.52.02.53.03.54.04.55.0cv[%v=v]101520253035404550D[nm]−600−525−450−375−300−225−150−750Ed¡d[meV](a)

(b)

(c)

ratio ΩC =(cid:0)δV 1

H/δV 0
H

Figure 7: Variation of the Hall voltage AC amplitude δV γ
H as a function of BDC and BAC, for when there is (a) no
nanoparticle nearby and (b) a D = 20 nm nanoparticle placed z0 = 100 nm from the origin. Panel (c) represents the

(cid:1)(cid:12)(cid:12)C evaluated at the central measuring pad.

16

56789101112131415BAC[mT]100120140160180200220240260280300BDC[mT]02468101214±V0H[¹V]56789101112131415BAC[mT]100120140160180200220240260280300BDC[mT]35791113151719±V1H[¹V]56789101112131415BAC[mT]100120140160180200220240260280300BDC[mT]1.21.82.43.03.64.24.85.46.0­(a)

(b)

Figure 8: Selected subplots showing the variation of Ω (a) along D for selected z0 and (b) along z0 for selected D.
The dashed line represents Ω = 3.

17

20406080100120140160180200D[nm]100101102103104­z0=200nmz0=500nmz0=1000nm1002003004005006007008009001000z0[nm]100101102103104­D=20nmD=50nmD=100nm