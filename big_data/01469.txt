6
1
0
2

 
r
a

M
4

 

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
9
6
4
1
0

.

3
0
6
1
:
v
i
X
r
a

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR

PROBLEM

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

Abstract. The far ﬁeld refractor problem with a discrete target is solved with
a numerical scheme that uses and simplify ideas from [CKO99]. A numerical
implementation is carried out and examples are shown.

1. Introduction

The purpose of this paper is to present an algorithm to construct far ﬁeld
one source refractors with arbitrary precision. We use the ideas from the paper
[CKO99] by Caﬀarelli, Kochengin and Oliker, where they develop an algorithm
to construct far ﬁeld point source global reﬂectors, i.e., the source domain Ω is the
whole sphere S2, and the density is smooth. For our refraction problem, we are
able to simplify and extend these ideas to deal with densities that are only bounded
and work in general domains. In particular, we do not need to consider derivatives
of the refractor measure, we only need to prove an appropriate Lipschitz bound
for the refractor measure which considerably simpliﬁes the approach proposed
in [CKO99]. In addition, our approach does not use the mass transport structure
of the far ﬁeld problem, and therefore it can be used in near ﬁeld problems.
Since we are working in general domains Ω and with a non smooth density, the
diﬀerentiability of the refractor measure might not hold in general. This depends
on the shape and regularity of the domain and the smoothness of the density.
The nature of refraction problems demands for domains for which total internal
reﬂection does not occur, see condition (2.5). Therefore the global problem does
not make sense in this case.

To place our results in perspective we mention the following. Recently, Castro,
M´erigot and Thibert [CMT15] introduced numerical methods to solve the reﬂector
problem. These are based on optimal transport ideas introducing a concave
function arising from the Kantorovitch functional. This function is analyzed
numerically and their results follow, combined with other numerical packages.
An advantage of this approach is that the convergence of their algorithm is faster
than the one proposed in [CKO99]. For general cost functions satisfying the

March 7, 2016

C. E. G was partially supported by NSF grant DMS–1201401.
The numerical part in Section 6 was developed ﬁrst on the computational cluster of the Italian
National Institute for Nuclear Physics (INFN), and lately on the cluster of the College of Arts and
Sciences at Howard University.

1

2

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

Ma, Trudinger and Wang condition arising in optimal transport [MTW05], the
∞
algorithm in [CKO99] is extended in [Kit14] when the density is C
and the
domains are convex with respect to the cost function. We remark that this does
not include our results when the density is smooth, since the refractor considered
in the present paper is for κ < 1 and the condition of Ma, Trudinger and Wang
does not hold in this case; see [GH09, Section 5]. We believe the case κ < 1 is more
interesting for lens design since lenses are made of materials that are denser than
the surrounding medium. In fact, if the material around the source is cut out with
sphere centered at the source, then the lens sandwiched between that sphere and
the constructed refractor surface will perform the desired refracting job.

The far ﬁeld refractor problem has been considered and solved for the ﬁrst
time in [GH09] using optimal mass transport. Several models and variants have
been introduced to reﬂect more accurately the physical features of the problem;
see [GM13], [GT13], [GT15], and [GS14]. For numerical results to design reﬂec-
tors solving Monge-Amp`ere type pdes we refer to [BHP15b] and [BHP15a] both
containing many references.

The organization of the paper is as follows. In Section 2, we explain the set
up and the problem solved.
In Section 3.1 we prove lemmas concerning the
tracing map and the refractor measure to be used in solving the problem. Section
3.2 contains a few results about geodesic disks that are needed in the proof of
the Lipschitz estimates. The algorithm is explained in detail in Section 4, and
the convergence in a ﬁnite number of steps in Section 4.3. Section 5 contains
the Lipschitz estimate in Proposition 5.1 needed to show the convergence of the
algorithm in a ﬁnite number of steps. Finally, in Section 6 we give a numerical
implementation of our algorithm to construct various examples.

2. Set up, definitions, and statement of results

Suppose Γ is a surface in R3 that separates two homogeneous, isotropic and
dielectric media I and II having refractive indices n1 and n2, respectively. If a ray
of light having direction x ∈ S2, the unit sphere in R3, and traveling through the
medium I strikes Γ at the point P, then this ray is refracted in the direction m ∈ S2
through the medium II according to the law of refraction (Snell’s Law)
(2.1)
where ν is the unit normal to Γ at P pointing towards medium II. If we set κ = n2/n1,
then we can also write (2.1) as
(2.2)

where λ ∈ R is given by λ = x · ν − m · ν = x · ν − κ(cid:112)
1 − κ−2(1 − (x · ν)2). When
medium I is optically denser than medium II, that is, κ < 1, the vector m bends
away from the normal, and total internal reﬂection might occur. That is, the ray
with direction m is transmitted to medium II if and only if x·m ≥ κ, or equivalently
x · ν ≥ √

1 − κ2; see [GH09, Section 2.1].

n1(x × ν) = n2(m × ν),

x − κm = λν

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

3

When κ < 1, the surfaces having the uniform refracting property, are ellipsoids
of revolution having a focus at the origin, see [GH09, Section 2.2]. That is, the
surface written in polar coordinates ρ(x)x with x ∈ S2 and with
(2.3)

ρ(x) =

b

,

1 − κm · x

2κb
1 − κ2 m,
b > 0, is an ellipsoid of revolution with axis m, eccentricity κ, foci 0 and
and refracts all rays emanating from 0 into the direction m for x · m ≥ κ. We then
denote this semi-ellipsoid by

(cid:41)
, x ∈ S2, m · x ≥ κ

.

b

1 − κm · x

(cid:40)

(2.4)

E(m, b) =

ρ(x)x : ρ(x) =

We assume throughout the paper that medium I is denser than medium II and therefore
κ = n2/n1 < 1. We also point out that similar analysis can be done for the case
κ = n2/n1 > 1, changing ellipsoids for hyperboloids, see [GH09, Section 2.2].

are two domains of the unit sphere S2 of R3∗

Suppose that Ω and Ω∗

with the

inf

m∈ ¯Ω∗,x∈ ¯Ω

m · x ≥ κ,

property, to avoid total reﬂection [BW59, Sect. 1.5.4], that
(2.5)
where m · x is the usual inner product of m and x in R3; and the boundary of Ω
has surface measure zero.
Deﬁnition 2.1. A surfaceR in R3 parameterized by ρ(x)x is a refractor from ¯Ω to ¯Ω∗
any xo ∈ ¯Ω there exists a semi-ellipsoid E(m, b) with m ∈ ¯Ω∗
b
and ρ(x) ≤
1 − κm · x
ρ(xo)xo or simply at xo.
From the deﬁnition, it is easy to see that refractors are Lipschitz continuous in
¯Ω, i.e., |ρ(x) − ρ(y)| ≤ Cκ
only on κ.
Deﬁnition 2.2. Given a refractor R = {ρ(x)x : x ∈ ¯Ω}, the refractor mapping of R is the
multi-valued map deﬁned for xo ∈ ¯Ω by

if for
1 − κm · xo
for all x ∈ ¯Ω. We call E(m, b) a supporting semi-ellipsoid to R at
(cid:0)infΩ ρ(cid:1) |x − y| for x, y,∈ ¯Ω with Cκ a constant depending

such that ρ(xo) =

b

NR(xo) = {m ∈ ¯Ω∗

: E(m, b) supports R atρ(xo)xo f or some b > 0}.

Given mo ∈ ¯Ω∗

the tracing mapping of R is deﬁned by

TR(mo) = {x ∈ ¯Ω : mo ∈ NR(x)}.

Suppose that we are given a nonnegative function g ∈ L1( ¯Ω). We then recall the
notion of refractor measure, see [GH09, Section 3.1].

∗
The physical problem considered is three dimensional; the mathematical extension to n dimen-

sions is straightforward.

4

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

Deﬁnition 2.3. The refractor measure associated with the refractor R and the function g
is the Borel measure given by

(cid:90)

GR(ω) =

g(x) dx

TR(ω)

for every Borel subset ω of ¯Ω∗.

(cid:82)

such that GR = µ in Ω∗

Given a Borel measure µ in Ω∗
satisfying the energy conservation condition
), the far ﬁeld refractor problem consists in ﬁnding a refractor R
Ω g(x) dx = µ(Ω∗
from Ω to Ω∗
. Existence of refractors and uniqueness up
to dilations is proved in [GH09] using mass transport techniques. This is also
proved in [GM13] with a diﬀerent method where a more general case that takes
into account internal reﬂection is considered.
For the remaining part of the discussion ﬁx m1, m2, . . . , mN, N ≥ 2, distinct points
in ¯Ω∗ ⊂ S2. Given b = (b1, . . . , bN) ∈ RN
+ , i.e., with each bi > 0, we denote by R(b)
the refractor deﬁned by a ﬁnite number of semi-ellipsoids and given by

(cid:40)
ρ(x)x : x ∈ ¯Ω, ρ(x) = min
1≤i≤N

(cid:41)

.

bi

1 − κmi · x

(2.6)

R(b) =

In this setting, we recall the following theorem from [GM13, Remark 6.10] for
discrete targets.
Theorem 2.4. Let g ∈ L1( ¯Ω) with g > 0 a.e., f1, . . . , fN are positive numbers, m1,··· , mN ∈
S2 are distinct points with x · mj ≥ κ for all x ∈ Ω and 1 ≤ j ≤ N. Assume the energy
conservation condition

(cid:90)

(2.7)

¯Ω

g(x) dx = f1 + ··· + fN.

†
, having the form (2.6), and solving

Then there exists a refractor unique up to dilations
GR(b)(mi) = fi for all i = 1, . . . , N.
The main result of this paper is to describe an iterative scheme to construct this refractor
with arbitrary precision. That is, given g ∈ L
non negative, and f1,··· , fN; m1,··· , mN,
∞
as in Theorem 2.4, and  > 0 we ﬁnd a vector b ∈ RN
+ , which depends on , such
that the refractor R(b) of the form 2.6 satisﬁes
(2.8)

|GR(b)(mi) − fi| ≤ ,

1 ≤ i ≤ N.

3. Preliminary results

3.1. Lemmas for the tracing map and refractor measures.
Lemma 3.1. Let b = (b1, . . . , bN) ∈ RN with each bi > 0. Consider the family of refractors
obtained from R(b) = {ρ(x)x : x ∈ Ω}, by changing only bi and ﬁxing bj for all j (cid:44) i.
Then:

i. GR(b)(mi) = 0 for bi > (1 + κ) minj(cid:44)i bj.
†
The assumption g > 0 a.e. is only used to prove uniqueness up to dilations.

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

5

ii. GR(b)(mi) =(cid:82)

Ω g(x) dx for 0 < bi < minj(cid:44)i bj
1 + κ

.

Proof. To prove (i) suppose x ∈ TR(b)(mi), and x is not a singular point of R(b).
Then E(mi, bi) is a supporting semi-ellipsoid to R(b) at ρ(x)x. So we have

bi

1 − κmi · x

≤

bj

1 − κmj · x

for all j = 1, . . . , N. Therefore
bi ≤ 1 − κmi · x
1 − κmj · x

bj ≤ 1 − κ2

1 − κ bj = (1 + κ)bj, j = 1,··· , N.

Hence if bi > (1 + κ) minj(cid:44)i bj, then TR(b)(mi) ⊂ S, where S is the singular set of R(b).
The ﬁrst part of the lemma is then proved.
Let us prove (ii). Let b0 = minj(cid:44)i bj, and take 0 < bi < b0/(1 + κ). Then for any
x ∈ Ω and for any j (cid:44) i we have

bi

< b0/(1 + κ)
1 − κmi · x
So for 0 < bi < b0/(1 + κ) we obtain

1 − κmi · x

≤ bo
1 − κ2

≤ bj
1 − κ2

≤

bj

1 − κmj · x

.

min
1≤l≤N

bl

1 − κml · x

=

bi

1 − κmi · x

j(cid:44)i

(cid:26)

(cid:91)

(cid:111)(cid:91)(cid:92)

(cid:110)
b = (b1,··· , bN) : bi ≥ (1 + κ) bj

and consequentlyTR(b)(mi) = ¯Ω completing the proof of part (ii) of the Lemma. (cid:3)
Remark 3.2. For each ﬁxed 1 ≤ i ≤ N, from Lemma 3.1, the function GR(b)(mi) is
(cid:27)
constant on the set deﬁned by linear inequalities
Fi :=
If we set Gi(b) = GR(b)(mi), 1 ≤ i ≤ N, and consider the map b = (b1,··· , bN) (cid:55)→
(G1(b),··· , GN(b)), the Jacobian of this map is zero on the set ∪N
Lemma 3.3. Let b = (b1, . . . , bN) and b
∗
l, b
l
(3.1)
and

= bi, where 1 ≤ l, i ≤ N. Then

b = (b1,··· , bN) : bi ≤ 1

≤ bl and for all i (cid:44) l, b
∗
i

∗
, . . . , b
N) be in RN

+ . Suppose that for some

TR(b)(ml) ⊆ TR(b

∗

1 + κ bj

∗ = (b
∗
1

i=1Fi.

)(ml)

j(cid:44)i

.

(3.2)
where the inclusions are up to a set of measure zero. Consequently

TR(b

∗

)(mi) ⊆ TR(b)(mi) for i (cid:44) l,

GR(b)(ml) ≤ GR(b

∗

)(ml) and GR(b)(mi) ≥ GR(b

∗

)(mi) for i (cid:44) l.

6

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

(x) ≤ ρ(x) for all x ∈ Ω, where ρ∗

Proof. We use here that if x0 ∈ TR(b)(ml) and x0 is not a singular point, then the
ellipsoid E(ml, bl) supports R(b) at x0, this holds for any refractor R(b) and any
1 ≤ l ≤ N; see [GM13, Lemma 5.1].
‡
We ﬁrst prove (3.2) when x0 is not a singular point of R(b
≤ bl, we
∗
). Since b
is the parametrization of R(b
∗
obviously have ρ∗
l
)
and ρ is the parametrization of R(b). Suppose i (cid:44) l and let x0 ∈ TR(b
)(mi). Then,
since x0 is not a singular point of R(b
1 − κx · mi
), the ellipsoid with polar radius
) at x0. We have ρ(x) ≤
supports R(b
1 − κx · mi
(x0) ≤ ρ(x0) ≤
= ρ∗

. Therefore

bi

bi

bi

bi

∗

∗

∗

,

∗

1 − κx0 · mi

1 − κx0 · mi

∗

bj

1 − κ x · ml

supports R(b
∗
∗
b
l

), and x0 ∈ TR(b)(ml), then x0 ∈ TR(b
∗
b
l

1 − κ x · ml
(x) ≤
for some j (cid:44) l, and therefore

that is, x0 ∈ TR(b)(mi).
We now prove (3.1). That is, if x0 is neither a singular point of R(b) nor a
singular point of R(b
)(ml). We may assume
< bl. We have that E(ml, bl) supports R(b) at x0. We claim that the ellipsoid
∗
b
l
) at x0. Suppose this is not true.
with polar radius
Since by deﬁnition ρ∗
ρ∗
1 − κ x0 · mj
(x0) =
) at x0.
Since x0 is not a singular point of R(b
), then by the inclusion previously proved
we get that x0 ∈ TR(b)(mj). Since j (cid:44) l we obtain that x0 is a singular point of R(b),
(cid:3)
a contradiction.
Remark 3.4. We show that if Ω is connected, 0 < |TR(b)(ml)| < |Ω|, and b
∗
(cid:96) < b(cid:96),
then |TR(b
)(ml) \ TR(b)(ml)| > 0. Therefore, if g > 0 a.e., then this implies that if
In fact, the proof follows the argument in [Gut14, Lemma 4.12]. Since|TR(b)(ml)| >
0, by [Gut14, Lemma 4.11] if x0 ∈ TR(b)(ml), then the semi-ellipsoid E(m(cid:96), b(cid:96)) sup-
ports R(b) at x0. Hence
∗
(cid:96) < b(cid:96), we then
for all j. Since b
get

, we would have ρ∗
1 − κ x · mj

0 < GR(b)(ml) <(cid:82)

1 − κ x0 · ml
(x0) <
supports R(b
∗

Ω g(x) dx we obtain GR(b)(ml) < GR(b
∗

∗
(cid:96) < b(cid:96).
)(ml) when b

1 − κ m(cid:96) · x0

1 − κ mj · x0

. So

≥

∗
l

b

bj

bj

∗

∗

∗

b(cid:96)

∗
b
(cid:96)

bj

1 − κ mj · x0

>

1 − κ m(cid:96) · x0

∀j.

‡
The restriction that x0 is not a singular point cannot be disposed of. For example, consider a
refractor R that is the min of only two semi-ellipsoids E(m2, b2) and E(m3, b3). Take a singular point
x0 of this refractor and consider a supporting semi-ellipsoid E(m1, b) at x0 having another direction
m1. Take now E(m1, b1) with b1 > b. The refractor can be deﬁned with the three ellipsoids E(mi, bi),
1 ≤ i ≤ 3, because the deﬁnition of refractor does not see E(m1, b1), but E(m1, b) is supporting at x0
and b < b1 and E(m1, b1) does not support R at x0.

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

7

By continuity there is a neighborhood Vx0 such that

bj

1 − κ mj · x

>

1 − κ m(cid:96) · x

∗
b
(cid:96)

∀j, ∀x ∈ Vx0

.

Thus Vx0

⊂ TR(b

∗

)(ml). Therefore, we have the inclusion
)(ml)

T := TR(b)(ml) ⊂ interior

∗

:= O.

(cid:16)TR(b

(cid:17)

∗

Ω g(x) dx for b

)(ml) < (cid:82)

On the other hand, from the proof of [Gut14, Lemma 3.12], the set TR(b)(ml) is
(cid:82)
compact. Therefore the set O \ TR(b)(ml) is an open set. Now since GR(b)(ml) <
Ω g(x) dx, by the continuity of the refractor measure as a function of b(cid:96), Lemma
∗
3.6(ii) below, we have that GR(b
∗
(cid:96) suﬃciently close to b(cid:96).
∗
Since GR(b
)(ml) increases when b
(cid:96) decreases, it is enough to prove the desired
(cid:96) is suﬃciently close to b(cid:96). This implies that O (cid:44) ¯Ω. So we have
∗
inequality when b
the conﬁguration T closed, T ⊂ O (cid:36) ¯Ω. If the set O \ T (cid:44) ∅, then since O \ T
is open, we have |O \ T| > 0. Since O \ T ⊂ TR(b
)(ml) \ TR(b)(ml), we obtain the
desired result. It then remains to show that O \ T (cid:44) ∅. Suppose by contradiction
that O \ T = ∅. That is, O ∩ ( ¯Ω \ T ) = ∅. We shall prove this implies that
(3.3)
Since both sets in this union are open (T is closed) relative to ¯Ω, and O (cid:44) ¯Ω, we
obtain that ¯Ω is disconnected, contradicting the assumption that ¯Ω is connected.
So let us prove (3.3). Write

¯Ω = O ∪ ( ¯Ω ∩ T c).

∗

O ∪ ( ¯Ω ∩ T c) = (O ∪ ¯Ω) ∩ (O ∪ T c) = ¯Ω ∩ (O ∪ T c)
since T ⊂ O.

⊃ ¯Ω ∩ (O ∪ Oc) = ¯Ω

This completes the remark.

By [GM13, Lemma 3.6], we also have the following:
Lemma 3.5. Let Rj = {ρj(x)x : x ∈ ¯Ω}, j ≥ 1 be refractors from ¯Ω to ¯Ω∗. Suppose that
0 < a1 ≤ ρj ≤ a2 and ρj → ρ pointwise on ¯Ω. Then:
i. R := {ρ(x)x : x ∈ ¯Ω} is a refractor from ¯Ω to ¯Ω∗.
ii. The measures GRj converge weakly to the measure GR.

Lemma 3.6. If in Lemma 3.5, Rj and R are deﬁned by ﬁnite number of semi-ellipsoids as:

ρ(x)x : x ∈ ¯Ω, ρ(x) = min
Rj = R(bj) =
(cid:40)
ρ(x)x : x ∈ ¯Ω, ρ(x) = min
, GR =(cid:80) GR(mi)δmi
1≤i≤N

R = R(b) =

1≤i≤N

=(cid:80) GRj(mi)δmi

i. GRj
ii. GRj(mi) → GR(mi) for all 1 ≤ i ≤ N, when bj → b.

and

then

 .
1 − κmi · x
(cid:41)

bj
i

bi

1 − κmi · x

.

8

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

For a proof of this lemma see [Gut14, Lemma 4.7].
3.2. Geodesic disks. Recall that if α, β ∈ S2, the geodesic distance between them
−1(α · β). We deﬁne a geodesic disk with center α and radius r to be
is given by cos
the set of points x on S2 for which x · α ≥ cos r.
Lemma 3.7. Let b1, b2 > 0 and m1, m2 ∈ S2 be such that m1 (cid:44) m2. Consider the set

(cid:41)

(cid:40)
x ∈ S2 :

V12 =

≤

.

b2

1 − κ x · m2

b1
1 − κ x · m1
b1 − b2
κ|b1m2 − b2m1| ≤ 1, and V12 is the geodesic disk with
A12 = b1m2 − b2m1
|b1m2 − b2m1|
b1 − b2
−1
(cid:110)

κ|b1m2 − b2m1|,
x ∈ S2 : x · A12 ≥ cos τ12

(cid:111) .

τ12 = cos

This set is non empty if and only if
center at

and radius

that is,

In addition, if

V12 =

b1 − b2
(cid:40)

κ|b1m2 − b2m1| ≤ −1, then V12 = S2. If R(b) is the refractor in Ω with

b1

b2

1 − κ x · m1

polar radius ρ(x) = min
Proof. If TR(b)(m1) = ∅, there is nothing to prove. Otherwise, let x ∈ TR(b)(m1).
Then

. So b1 − b2 ≤ x · κ(b1m2 − b2m1), and we obtain

1 − κ x · m2

≤

b2

b1

,

1 − κm1 · x

1 − κm2 · x

(cid:41)
, then TR(b)(m1) ⊂ V12.

in particular, we must have

geodesic disc with center at

κ

b1 − b2

|b1m2 − b2m1|,

x · b1m2 − b2m1
|b1m2 − b2m1| ≥ 1
b1 − b2
κ|b1m2 − b2m1| ≤ 1. Thus TR(b)(m1) is contained in the
b1 − b2
b1m2 − b2m1
−1
|b1m2 − b2m1|
|b1m2 − b2m1| and geodesic radius cos
(cid:3)

(cid:32)

1
κ

(cid:33)

.

Remark 3.8. If R(b) is a refractor of the form (2.6), then
(3.4)

(cid:40)
TR(b)(mi) = Ω ∩ ∩N
j=1Vij, except possibly on the singular set of R(b),
bi

. In fact, if x0 ∈ TR(b)(mi) and x0 is
where Vij =
not singular, then by [GM13, Lemma 5.1] the semi-ellipsoid E(mi, bi) supportsR(b)
at x0 implying
j=1Vij,

for all j. Vice versa, if x0 ∈ Ω ∩ ∩N

1 − κ x · mj
bj

1 − κ x · mi

x ∈ S2 :

(cid:41)

≤

≤

bj

bi

1 − κ x0 · mi

1 − κ x0 · mj

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

9

then the polar radius ρ satisﬁes ρ(x0) =
ρ at x0.

bi

1 − κ x0 · mi

, and so

bi

1 − κ x · mi

supports

b1

b2

1 − κ x · m2

gular points. In fact, take two ellipsoids E1 and E2 with polar radii

The following example shows that in (3.4) it is necessary to remove the sin-
1 − κ x · m1
respectively, with m1 (cid:44) m2 and take the corresponding refractor
and
minimum of the two ellipsoids and let ρ(x) be the polar radius. Suppose the
refractor ρ has a singular point x0. At x0 take a supporting semi-ellipsoid to ρ
having axis m3, with m3 diﬀerent from m1 and m2. Let the polar radius of this
ellipsoid be
with
b∗ much larger than b3 so that the ellipsoids E1 and E2 are contained in the in-
, i = 1, 2, are both strictly smaller than
terior of the solid E, that is,
b∗
1 − κx · m3
(cid:40)
is the same
as the refractor ρ(x). We have that x0 ∈ Tρ(m3). On the other hand, the sets
= ∅.
V31 =

(cid:40)
1 − κ x · mi
b1
1 − κ x · m1
(cid:41)
= ∅ and V32 =

. Then refractor min
b∗

b∗
1 − κx · m3
(cid:41)

. Now take an ellipsoid E of the form

1 − κ x · m2
(cid:40)
b∗

,

1 − κx · m3

b3

1 − κx · m3

(cid:41)

b∗

b2

,

1 − κx · m3

≤

b1

1 − κ x · m1

1 − κx · m3

≤

b2

1 − κ x · m2

bi

4. The algorithm

We assume the energy conservation condition (2.7).
4.1. The set W of admissible vectors. Let N ≥ 2, fo = min1≤i≤N fi, and 0 < δ <
fo/N. Consider the set of admissible vectors

W = {b = (1, b2, . . . , bN) : bi > 0 and GR(b)(mi) ≤ fi + δ for i = 2, . . . , N}.

This set is non empty and their coordinates are bounded away from zero. This is
the contents of the following lemma.
Lemma 4.1. Suppose fo = min1≤i≤N fi and 0 < δ < fo/N. We have that
(1) if bi > 1 + κ for 2 ≤ i ≤ N, then (1, b2, b3,··· , bN) ∈ W;
(2) if b = (1, b2,··· , bN) ∈ W, then
bi ≥ 1
(4.1)
Proof. We prove (1). Let b = (1, b2,··· , bN) with bi > 0. Fix j ≥ 2 and let x ∈ TR(b)(mj)
be a non singular point. Then from [GM13, Lemma 5.1], the semi-ellipsoid E(mj, bj)
supports R(b) at x. Since x · mj ≥ κ, we have
= ρ(x) ≤

1 + κ for 2 ≤ i ≤ N.

≤

bj

1

,

1 − κ x · m1

≤ 1
1 − κ

1 − κ x · mj

bj
1 − κ2

10

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

GR(b)(m1) = f1 +

and so bj ≤ 1 + κ. Therefore, if bj > 1 + κ with j (cid:44) 2, and x ∈ TR(b)(mj), then x is a
singular point and thereforeTR(mj) has measure zero, and so GR(b)(mj) = 0 < fj +δ.
To show (2), we ﬁrst prove that GR(b)(m1) > 0 for each b ∈ W. In fact, from (2.7)
and the deﬁnition of W we have

N(cid:88)
( fi − GR(b)(mi)) > f1 − (N − 1)δ > f1 − Nδ > 0

from the choice of δ. Since g ≥ 0, the set TR(b)(m1) has positive measure. This
∪N
TR(b)(mi) which means that each point in TR(b)(m1) is singular, and therefore
|TR(b)(m1)| = 0; a contradiction. From this we conclude (4.1) because, if b ∈ W,

implies that for each b ∈ W, TR(b)(m1)∩(cid:16)∪N
then we can pick x0 ∈ TR(b)(m1) ∩(cid:16)∪N

(cid:17)c (cid:44) ∅. Otherwise, TR(b)(m1) ⊂

and we have

i=2

i=2

so

1

ρ(x0) =

1 − κ x0 · m1
bi ≥ 1 − κ x0 · mi
1 − κ x0 · m1

i=2

i=2

TR(b)(mi)
(cid:17)c
TR(b)(mi)
≤
1 − κ x0 · mi
≥ 1 − κ x0 · mi
1 − κ2

bi

,

≥ 1 − κ
1 − κ2

i = 2,··· , N

= 1

1 + κ

.

(cid:3)

4.2. Detailed description of the algorithm. From Lemma 4.1 (2), we can pick
b1 = (1, b2,··· , bN) ∈ W. We will construct N − 1 intermediate consecutive vectors
b2,··· , bN associated with b1 in the following way.
Step 1. We ﬁrst test if b1 satisﬁes the inequality:

f2 − δ ≤ GR(b1)(m2) ≤ f2 + δ.

GR(b1)(m2) < f2 − δ.

∈ (0, b2), and leave all other components ﬁxed, so that the new
, b3,··· , bN) belongs to W, and satisﬁes

(4.2)
If b1 satisﬁes this inequality, then we set b2 = b1 and we proceed to Step 2 below.
Notice that the inequality on the right hand side of (4.2) holds since b1 ∈ W. If b1
does not satisfy (4.2), then
(4.3)
∗
We shall pick b
2
∗
vector b2 = (1, b
2
(4.4)
In fact, this is possible because applying Lemma 3.3 with (cid:96) = 2 we get that
∈ (0, b2] from (3.2); and applying Lemma
GR(b2)(mj) ≤ GR(b1)(mj) for j (cid:44) 2 and b
∗
→ 0, from the
Ω g(x) dx = f1 + ··· + fN as b
2
∗
energy conservation assumption. Since the fi’s are all positive, f1 + ··· + fN > f2,
2
and from the choice of δ we have f1 + ··· + fN > f2 + δ. As a function of b
∗
2, the
function GR(b2)(m2) is non-increasing on (0, b2) from (3.1), tends to f1 + ··· + fN as
→ 0, and from (4.3) is strictly less than f2 − δ at b
∗
∗
= b2. Therefore by continuity
b
2
2

3.1 (ii.) we get that GR(b2)(m2) → (cid:82)

f2 ≤ GR(b2)(m2) ≤ f2 + δ.

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

11

∈ (0, b2) such that (4.4) holds
§
∗
of GR(b2)(m2), Lemma 3.6 ii, we can pick a value b
.
2
Therefore, if the vector b1 does not satisfy (4.2), we have then constructed a vector
b2 ∈ W that satisﬁes (4.4) which is stronger than (4.2).
Step 2. Next we proceed to test the inequality
f3 − δ ≤ GR(b2)(m3) ≤ f3 + δ,
(4.5)
with b2 the vector constructed in Step 1. If b2 satisﬁes (4.5), we set b3 = b2 and
we proceed to the next step. If b2 does not satisfy (4.5), then

GR(b2)(m3) < f3 − δ

and we proceed as before, now to decrease the value of b3, the third component
of the vector b2, and construct a vector b3 ∈ W such that

f3 ≤ GR(b3)(m3) ≤ f3 + δ,

and in particular, (4.5) holds for b3. Notice that we do not know if the newly
constructed vector b3 satisﬁes (4.2).
Step 3. Next we proceed to test the inequality
(4.6)
with b3 the vector from Step 2. If this is true, then we set b4 = b3 and proceed to
the next step. Otherwise, we must have

f4 − δ ≤ GR(b3)(m4) ≤ f4 + δ,

GR(b3)(m4) < f4 − δ

and we continue in the same way as before now decreasing the fourth component
b4 of b3 obtaining a new vector b4 satisfying

f4 ≤ GR(b4)(m4) ≤ f4 + δ,

fN − δ ≤ GR(bN−1)(mN) ≤ fN + δ,

in particular, (4.6).
Step N − 1. We proceed to test the inequality
(4.7)
where bN−1 is the vector from Step N−2. If this holds we set bN = bN−1. Otherwise,
we have
and proceeding as before, by decreasing the Nth-component of bN−1, we obtain a
vector bN ∈ W

GR(bN−1)(mN) < fN − δ,

fN ≤ GR(bN)(mN) ≤ fN + δ.

In this way, starting from a ﬁxed vector b1 ∈ W, we have constructed intermediate
vectors b2,··· , bN all belonging to W and satisfying the above inequalities. Notice
that by construction, the (cid:96)-th components of bj−1 and bj are all equal for (cid:96) (cid:44) j. If

Notice that for any a ∈ [ f2 − δ, f1 + ··· , fN], we can pick b
∗
§
2

∈ (0, b2) such that GR(b2)(m2) = a.

12

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

for some 2 ≤ j ≤ N, bj−1 (cid:44) bj, then the j-th component of bj is strictly less than
the j-th component of bj−1. And so if we needed to decrease the j-th component
of bj−1 to construct bj is because

GR(bj−1)(mj) < fj − δ,

and then by construction bj satisﬁes

fj ≤ GR(bj)(mj) ≤ fj + δ.

δ < GR(bj)(mj) − GR(bj−1)(mj),

We therefore obtain from the last two inequalities the following important in-
equality
(4.8)
We now repeat the construction above starting with the last vector bN.
In
fact, we start from a vector b1,1 ∈ W and constructed N − 1 intermediate vectors
b1,2,··· , b1,N using the procedure described. So we obtain in the ﬁrst step the
ﬁnite sequence of vectors

for intermediate vectors bj (cid:44) bj−1.

b1,1, b1,2,··· , b1,N.

In the second step we repeat the construction now starting with the vector b1,N
and we get the ﬁnite sequence of vectors

b2,1, b2,2,··· , b2,N

with b2,1 = b1,N. For the third step we repeat the process now starting with the
last intermediate vector b2,N obtained in the previous step, obtaining the ﬁnite
sequence of vectors

b3,1, b3,2,··· , b3,N

with b3,1 = b2,N. Continuing in this way we obtain a sequence of vectors, in
principle inﬁnite,
(4.9)
b1,1,··· , b1,N; b2,1,··· , b2,N; b3,1,··· , b3,N;··· ; bn,1,··· , bn,N; bn+1,1,··· , bn+1,N;···
with b2,1 = b1,N, b3,1 = b2,N,··· , bn+1,1 = bn,N,··· . If for some n, the vectors in the
nth-stage are equal, i.e., bn,1 = bn,2 = ··· = bn,N := bn, then from the construction

Furthermore, by conservation of energy,(cid:80)N
|GR(bn)(mj) − fj| ≤ δ,
GR(bn)(mj) − fj

| f1 − GR(bn)(m1)| =

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) N(cid:88)

j=2

for 2 ≤ j ≤ N.

i=1 GR(bn)(mi) =(cid:80)N
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ N(cid:88)

j=2

i=1 fi, so we obtain

|GR(bn)(mj) − fj| ≤ N δ.

If we now choose δ = /N, then the refractor R(bn) will satisfy (2.8), and the
problem is solved.
Therefore, if we show that for some n the intermediate vectors b1,n, b2,n,··· , bn,N
are all equal, we are done.

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

13

,··· , b0

j=2[1/(1 + κ), b0

4.3. A Lipschitz estimate implies that the process stops. We shall prove that
the estimate (5.6) implies that there is an n such that the vectors in the group
bn,1, bn,2,··· , bn,N are all equal, and we also show an upper bound for the number
of iterations.
N) ∈ W. Since by con-
Suppose we originate the iteration at b0 = (1, b0
2
struction the coordinates of the vectors in the sequence (4.9) are decreased or kept
constant, the jth coordinate of any vector in the sequence is less than or equal to b0
j ,
1 ≤ j ≤ N. In addition, from (4.1), points in W have all their coordinates bounded
compact box K = {1} ×(cid:81)N
below by 1/(1 + κ). Therefore all terms in the sequence (4.9) are contained in the
j ]. We want to show that there is n0 such
that the intermediate vectors bn0,1, bn0,2,··· , bn0,N are all equal. Otherwise, for each
n the intermediate vectors bn,1, bn,2,··· , bn,N are not all equal. This implies that
for each n there are two consecutive intermediate vectors (1, b2, b3,··· , bN) and
(1, ¯b2, ¯b3,··· , ¯bN), that are diﬀerent. By construction of intermediate vectors, they
can only diﬀer in one coordinate, say that bj > ¯bj. Notice that j depends on n, but
there is j and a subsequence n(cid:96) such that there are two consecutive intermediate
,··· , ¯bn(cid:96)
N ) in each group bn(cid:96),1,··· , bn(cid:96),N such
N ) and (1, ¯bn(cid:96)
, ¯bn(cid:96)
vectors (1, bn(cid:96)
3
2
> ¯bn(cid:96)
that their j-th coordinates satisfy bn(cid:96)
j , and all other coordinates are equal.
j
(cid:16)
Also notice that since the coordinates are chosen in a decreasing form we have
bn(cid:96)
j

,··· , bn(cid:96)
(cid:16)
for (cid:96) = 1,··· . From (4.8) we then get
,··· , bn(cid:96)
1, ¯bn(cid:96)
(4.10)
2
for each (cid:96) ≥ 1. We write
,··· , ¯bn(cid:96)
,··· ¯bn(cid:96)
(1, ¯bn(cid:96)
N ),
2
≥ 1/(1 + κ).
< 0. Since the vectors belong to W, we have ¯bn(cid:96)
and let t := ¯bn(cid:96)
j
j
Then from (5.6) we obtain
− bn(cid:96)
(4.11)

(∗) ≤ −(cid:16)¯bn(cid:96)

g) (N − 1) := L (bn(cid:96)

(cid:17) − Gj

N ) = (1, ¯bn(cid:96)

2

> ¯bn(cid:96)+1

j
δ < Gj

,··· , ¯bn(cid:96)

,··· , bn(cid:96)

, ¯bn(cid:96)
3
− bn(cid:96)

j

≥ bn(cid:96)+1

j

1, bn(cid:96)
2

, bn(cid:96)
3

+ ¯bn(cid:96)
j

j

− bn(cid:96)

j

> ¯bn(cid:96)
j

= (∗)

N

, ¯bn(cid:96)
3

∀(cid:96).

, ¯bn(cid:96)
3

N

, bn(cid:96)
3

(cid:17)

2

j

,··· ¯bn(cid:96)
(cid:17)
∞(cid:88)

j

j

Cκ (sup
Ω

− ¯bn(cid:96)
j ),

j

On the other hand,

− ¯bn(cid:96)

j ) ≤ b0

(bn(cid:96)
j

− 1
1 + κ

,

j

(cid:96)=1

(4.12)
which contradicts (4.10) and therefore the intermediate vectors bn0,1, bn0,2,··· , bn0,N
are all equal for some n0.
Let us now estimate the number of iterations used. Consider the sequence of
vectors (4.9) constructed and list them as a sequence denoted by vi, i = 1, 2, 3,···
and maintaining the given order. By construction the j-th coordinate of the
vector vi is greater than or equal than the j-th coordinate of the vector vi+1, 1 ≤
j ≤ N. Given 1 ≤ j ≤ N, if we let cj(vi) = j-th coordinate of the vector vi, then
cj(vi) ≥ cj(vi+1); and any two consecutive vectors vi and vi+1 can diﬀer in only one

14

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

coordinate. Let Cj = {i : cj(vi) > cj(vi+1)}; (notice that C1 = ∅). If i ∈ Cj, then from
(4.10) and (4.11)

cj(vi) − cj(vi+1) ≥ δ
L

,

(cid:18)

(cid:19)

and so adding over i we get from (4.12)
#(Cj) ≤ L
Cj, and therefore the sequence (4.9) is constant for

− 1
1 + κ

b0
j

δ

.

Now the set {i : vi (cid:44) vi+1} ⊂ ∪N
all n ≥ n0 with

j=2

(1 + κ) Cκ (supΩ g) (N − 1)

n0 ≤ N

δ

max
2≤j≤N

(4.13)
4.4. Limit as n → ∞ of the sequence (4.9). We will show here that the procedure
described always converges in an inﬁnite number of steps, assuming only that
g ∈ L1(Ω) with g not necessarily bounded. This can be clearly seen by listing the
vectors constructed in the following way:
b1,1
2

(cid:18)

− 1
1 + κ

b0
j

(cid:19)

.




b1,2
2

b1,2
3

···
···
···

b1,1
3
= ≤ =

b1,1 → 1
b1,2 → 1
b1,3 → 1
···
b1,N−1 → 1 b1,N−1
b1,N → 1
b1,N
2
= =

b1,1
b1,1
= ··· =
N
4
b1,2
b1,2
= = ≤ = ··· =
N
4
b1,3
b1,3
= ≤ ··· =
N
3
b1,N−1
b1,N−1
b1,N−1
= ··· ≤
b1,N
b1,N
= ··· =
N
4

b1,3
2
= (cid:113)

···
···

b1,N
3
=

b1,3
4

= =

3
=

N

4

2

b2,2
2

b2,1
2

b2,2
3

···
···
···

b2,1
3
= ≤ =

b2,1 → 1
b2,2 → 1
b2,3 → 1
···
b2,N−1 → 1 b2,N−1
b2,N → 1
b2,N
2
= =

b2,1
b2,1
= ··· =
N
4
b2,2
b2,2
= = ≤ = ··· =
N
4
b2,3
b2,3
= ≤ ··· =
N
3
b2,N−1
b2,N−1
b1,N−1
= ··· ≤
b2,N
b2,N
= ··· =
N
4

b2,3
2
= (cid:113)

···
···

b2,N
3
=

b2,3
4

= =

3
=

N

4

2

group 1

group 2

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

15



b3,2
2

b3,2
3

···
···
···

b3,1
3
= ≤ =

b3,1
2

b3,1 → 1
b3,2 → 1
b3,3 → 1
···
b3,N−1 → 1 b3,N−1
b3,N → 1
b3,N
2
= =

b3,1
b3,1
= ··· =
N
4
b3,2
b3,2
= = ≤ = ··· =
N
4
b3,3
b3,3
= ≤ ··· =
N
3
b3,N−1
b3,N−1
b1,N−1
= ··· ≤
b3,N
b3,N
= ··· =
N
4

b3,3
2
= (cid:113)

···
···

3
=

b3,N
3
=

b3,3
4

2

= =

N

4

group 3

and continuing in this way we get an inﬁnite matrix having N columns. With the
notation bi,j
k we have that i=group, j=vector in the group, and k= the component.
We have

≥ bi,j+1

j+1

, for j = 1,··· , N − 1, and i = 1, 2,···

bi,j
j+1

and

bi,j
(cid:96) = bi,j+1

(cid:96)

, for (cid:96) (cid:44) j + 1.

We now look at each of the N columns of the inﬁnite matrix above. Each column
has entries in non increasing order (the ﬁrst column is obviously one), therefore the
limit of the entries exists and is a number diﬀerent from zero because the vectors
belong to W and therefore each limiting coordinate is bigger than 1/(1 + κ). Let
j be the limit of the entries in the column j, j ≥ 2. Then the vector
∞
b

∞ = (1, b

b

∞
2

∞
, b
2

,··· , b

∞
N)

satisﬁes

fj − δ ≤

(4.14)
TR(b∞
)(mj)
In fact, ﬁx 2 ≤ j ≤ N, the vector b
∞
vectors bi,j verify

(cid:90)

(cid:90)

g(x) dx ≤ fj + δ, j = 2,··· , N.
is the limit of the vectors bi,j as i → ∞. But the

g(x) dx ≤ fj + δ, for i = 1, 2,··· .

TR(bi,j)(mj)

fj − δ ≤
(cid:82)

TR(b)(mj) g(x) dx is continuous as a function of b for each j,
Since the function
Lemma 3.6ii, taking the limit as i → ∞ we obtain (4.14). As it was shown before,
the validity of (4.14) for j (cid:44) 1 implies that (4.14) holds with j = 1 and with δ
replaced by Nδ.

16

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

Consider the map G : RN

5. A Lipschitz estimate of Gi
+ → RN≥0 given by

G : b = (b1, . . . , bN) → (G1(b), . . . , GN(b))

(5.1)

where

Gj(b) = GR(b)(mj)

(5.2)
for j = 1, . . . , N and RN
Let ei be the unit vector in RN with 1 at the i-th position. We shall compute
Gi(bt) − Gi(b) where bt = (bt

+ = {b = (b1, . . . , bk) : bj > 0 for j = 1, . . . , N}.
N) := b + t ei. From Remark 3.8

, . . . , bt

1

TR(b)(mi) = Ω ∩ N(cid:92)

Vj

j=1

(cid:40)

except possibly on a set of measure zero, with
≤

x ∈ S2 :

(5.3)

Vj =

bi

1 − κmi · x

bj

1 − κmj · x

where for brevity we have used the notation Vj for Vij. Likewise

(cid:41)

,

.

Vt
j

j=1

TR(bt)(mi) = Ω ∩ N(cid:92)
x ∈ S2 :
TR(b)(mi) = Ω ∩(cid:92)

1 − κmi · x

Vj,

Vt
j

bt
i

=

bt
j

≤

1 − κmj · x

 .
TR(bt)(mi) = Ω ∩(cid:92)

= Vj = S2 for j = i. So

j(cid:44)i

.

Vt
j

j(cid:44)i

where

(5.4)

We have Vt
j

(5.5)

We prove the following proposition needed to show in Section 4.3 that the

algorithm stops in a ﬁnite number of steps.
Proposition 5.1. If g is bounded in Ω, then

0 ≤ Gi(b + t ei) − Gi(b) ≤

(5.6)
for −bi < t < 0 and for each b ∈ RN
and the angle between mi and mr.

(cid:32)

g

sup
Ω

(cid:33)(cid:88)

r(cid:44)i

C(κ, mi · mr)

br

(−t),

+ , where the constant C(κ, mi · mr) depends only on κ

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

17

Proof. We have

so from (5.5)

and

Since

we obtain

⊂ Vj for t > 0, j (cid:44) i and Vj ⊂ Vt

j for t < 0, j (cid:44) i,

Vt
j

TR(bt)(mi) ⊂ TR(b)(mi) for t > 0
TR(b)(mi) ⊂ TR(bt)(mi) for t < 0.
(cid:90)

g(x)dx −

TR(bt)(mi)

Gi(bt) − Gi(b) =

g(x)dx,

TR(b)(mi)

(cid:90)
−(cid:82)
(cid:82)

If t < 0, then we have

j

j

Gi(bt) − Gi(b) =

TR(b)(mi)\TR(bt)(mi) g(x)dx
TR(bt)(mi)\TR(b)(mi) g(x)dx

if t > 0
if t < 0.

r

j

Vt
r

∩ Vt

r

⊂ ∪r(cid:44)i

(cid:111) \ {∩r(cid:44)iVr}(cid:111)
TR(bt)(mi) \ TR(b)(mi) = Ω ∩(cid:110)(cid:110)∩j(cid:44)iVt
= Ω ∩(cid:110)(cid:110)∩j(cid:44)iVt
(cid:111) ∩(cid:8)(∩r(cid:44)iVr)c(cid:9)(cid:111)
(cid:111) ∩(cid:8)∪r(cid:44)iVc
(cid:9)(cid:111)
= Ω ∩(cid:110)(cid:110)∩j(cid:44)iVt
= Ω ∩(cid:110)∪r(cid:44)i
(cid:110)
∩(cid:110)∩j(cid:44)iVt
(cid:111)(cid:111)(cid:111)
(cid:110)
(cid:111)(cid:111)
⊂ Ω ∩(cid:110)∪r(cid:44)i
j
Vc
(cid:17) .
(cid:16)
r
Vc
r
\ Vr
(cid:16)
(cid:17) .
Vr \ Vt
TR(b)(mi) \ TR(bt)(mi) ⊂ ∪r(cid:44)i
(cid:90)
g(x)dx ≤
(cid:17)(cid:17)
(cid:16)∪r(cid:44)i
(cid:16)
Ω∩{∪r(cid:44)i{Vc
\ Vr
(cid:17) .
(cid:16)
Vt
r
\ Vr
(cid:1) = 0.

(cid:33)
(cid:33)(cid:88)
g
\ Vr for r (cid:44) i and for −bi < t < 0.
= S2 and so area(cid:0)Vt

TR(bt)(mi)\TR(b)(mi)

sup
Ω

sup
Ω

\ Vr

g

area

area

Vt
r

≤

r(cid:44)i

r

On the other hand, if t > 0, then

(cid:90)
We will estimate for −bi < t < 0
(cid:32)
(cid:32)

0 ≤ Gi(bt) − Gi(b) =
≤

(5.7)

We will calculate the area of Vt
r
Case Vr = S2.
In this case, Vt
Case Vr (cid:44) ∅.
r
If t → −bi, then Vt

r

r

r}} g(x) dx

r∩Vt

→ S2. We will estimate the area measure of Vt

\ Vr when

r

18

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

−bi < t < 0. The center of Vr is the point Ar = bimr − brmi
|bimr − brmi|. Fix an arbitrary vector
u from which we are going to measure the angles θ. Given 0 ≤ θ ≤ 2π consider
the points γr(θ, s) along the geodesic originating from Ar and forming an angle
θ with the vector u; s denotes geodesic arc length. The point γr(θ, s) is on the
boundary of Vr if and only if the parameter s = τr = cos
. Since
Vr ⊂ Vt
r for a
unique value of s with s ≥ τr. Let us denote this value of s by

r, and so the geodesic curve γr(θ, s) must intersect the boundary of Vt

κ|bimr − brmi|

bi − br

(cid:32)

(cid:33)

−1

and so

Let us set

hr(θ, t),

γr(θ, s) ∈ ∂Vt

r if and only if s = hr(θ, t).

xt = γr(θ, hr(θ, t)).

hr(θ, t) = arccos (Ar · xt) .

Since γr(θ, s) is a geodesic curve from the point Ar to the point xt, we have

On the other hand, the boundary of Vt
ellipsoids E(mi, bi + t) and E(mr, br) intersect. So xt satisﬁes

r is the collection of points where the

bi + t

1 − κxt · mi

=

br

1 − κxt · mr

,

which yields

area(Vt
r

which using the deﬁnition of Ar yields

Ar · xt =

κ|bimr − brmi| t = cos s + 1 − κ xt · mr
κ|bimr − brmi| t,
where in the last identity we used the deﬁnition of s = τr. We are now ready to
\ Vr. Integrating in polar coordinates we obtain
calculate the surface area of Vt
r
sin s ds dθ

\ Vr) =

br(1 − κ xt · mi) = (bi + t)(1 − κ xt · mr)
bi − br
κ|bimr − brmi| + 1 − κ xt · mr
(cid:90) hr(θ,t)
(cid:90) 2π
(cid:90) 2π
≤ (−t) 2π 1 + κ

(cid:90) 2π
|bimr − brmi| ≤ C(κ, mi · mr)

(cos τr − cos hr(θ, t)) dθ = (−t)

(5.8)
for −bi < t < 0, where C(κ, mi · mr) is a positive constant depending only on κ
¶
and the dot product mi · mr.
Since mi (cid:44) mr and have absolute value one, we have mi · mr ≤ 1− δ for some 1 > δ > 0. We then
have|bimr−brmi|2 = b2
δ(2−δ).
Similarly, |bimr − brmi|2 ≥ b2

r −2brbimr·mi +b2
r δ(2 − δ).

= (br−(1−δ)bi)2 +b2

r −2brbi(1−δ)+b2

δ(2−δ) ≥ b2

≥ b2

1 − κ xt · mr
κ|bimr − brmi| dθ
max{br, bi} (−t),

0

0

=

i

i

i

i

0

1

1

κ

τr

¶

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

19

Case when Vr = ∅.
Let us recall that

Vr =

(cid:40)
x ∈ S2 :
(cid:40)

x ∈ S2 :

bi

1 − κmi · x

≤

(cid:41)
1 − κmr · x
(cid:41)

br

br

1 − κmr · x

.

(cid:41)

bi + t − br

κ|(bi + t)mr − brmi|

and

We have that

Vt
r

=

Let

≤

bi + t

=

Vt
r

1 − κmi · x
(cid:40)
x ∈ S2 : x · (bi + t)mr − brmi
|(bi + t)mr − brmi| ≥
bi + t − br

κ|(bi + t)mr − brmi|, t ∈ (−bi, +∞).

g(t) =

(5.9)
Since Vr = ∅ we have
If we set ∆(t) = |(bi + t)mr − brmi|, then by calculation

g(0) > 1.

(cid:48)
g

and therefore

Also

and

(t) = br(bi + t + br)(1 − mi · mr)

,

κ ∆(t)3
∀t ∈ (−bi, +∞).
, when t → −bi,

(cid:48)

(t) > 0,
g
g(t) → − 1

κ

g(t) → 1

, when t → ∞.

κ

r

r consists only of the center point Ar,t0

Therefore there is a unique number −bi < t0 < 0 such that Vt
= ∅ for t0 < t < 0 and
(cid:44) ∅ for −bi < t ≤ t0; this is the value for which g(t0) = 1. In particular, when
Vt
= (bi + t0)mr − brmi
r
|(bi + t0)mr − brmi|. We
t = t0, the set Vt0
r for −bi < t ≤ t0. To do this we will use the
need to calculate the area of Vt
r
calculation from the previous case with Vr (cid:123) Vt0
r . In fact, we now parametrize the
boundary of Vt
r , Ar,t0. Fix a arbitrary vector u from which we
are going to measure the angles θ. Given 0 ≤ θ ≤ 2π consider the points γr(θ, s)
along the geodesic originating from Ar,t0 and forming an angle θ with the vector
u; s denotes geodesic arc length. The point γr(θ, s) is on the boundary of Vt0
if
r
= 0. Since t ≤ t0,
and only if the parameter s = τr,t0

r from the center of Vt0

(bi + t0) − br

\ Vr = Vt

= cos

(cid:32)

(cid:33)

−1

κ|(bi + t0)mr − brmi|

20

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

r ⊂ Vt
Vt0
a unique value of s with s > τr,t0

r, and so the geodesic curve γr(θ, s) must intersect the boundary of Vt

r for

= 0. Let us denote this value of s by

and so

Let us set

hr(θ, t),

γr(θ, s) ∈ ∂Vt

r if and only if s = hr(θ, t).

hr(θ, t) = arccos(cid:0)Ar,t0

xt = γr(θ, hr(θ, t)).
· xt

(cid:1) .

Since γr(θ, s) is a geodesic curve from the point Ar,t0 to the point xt, we have

On the other hand, the boundary of Vt
ellipsoids E(mi, bi + t) and E(mr, br) intersect. So xt satisﬁes

r is the collection of points where the

bi + t

1 − κxt · mi

=

br

1 − κxt · mr

,

which yields
br(1 − κ xt · mi) = (bi + t)(1 − κ xt · mr) = (bi + t0)(1 − κ xt · mr) + (t − t0)(1 − κ xt · mr)
which using the deﬁnition of Ar,t0 yields

· xt =

Ar,t0

κ|(bi + t0)mr − brmi| +
= 1 +

(bi + t0) − br
κ|(bi + t0)mr − brmi| (t − t0),

1 − κ xt · mr

1 − κ xt · mr

κ|(bi + t0)mr − brmi| (t − t0)

= 0. Integrating in polar coordinates

where in the last identity we used that τr,t0
as before we obtain for −bi < t ≤ t0 that
sin s ds dθ

area(Vt

r) =

(cid:90) 2π

0

1 − κ xt · mr

κ|(bi + t0)mr − brmi| dθ

0

0

=

(cid:90) hr(θ,t)

(cid:90) 2π
(cid:90) 2π
≤ (t0 − t) 2π 1 + κ
≤ C(κ, mi · mr)
≤ C(κ, mi · mr)

κ

0

1
br

(1 − cos hr(θ, t)) dθ = (t0 − t)

1

1

|(bi + t0)mr − brmi|
max{bi + t0, br} (t0 − t)
(t0 − t) ≤ C(κ, mi · mr)

br

(−t),

since t0 < 0, where C(κ, mi · mr) is a positive constant depending only on κ and the
dot product mi · mr.
(cid:3)
As a conclusion we obtain combining all cases the proposition.

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

21

Figure 1. Graph of the functions G2(b) = GR(b)(m2) (semitransparent)
and G3(b) = GR(b)(m3) (opaque) in the [0, 2]2 square for the case with three
unit output directions m1, m2, m3 given by the homogeneous coordinates
[0 : 0 : 1], [0 : 1 : 5], and [1 : 0 : 5], respectively.

Remark 5.2. Similar estimates for Gi(b) hold when the increment are in the vari-
ables br with r (cid:44) i. In fact, using arguments similar to the ones used in the proof
of the last proposition one can show that

0 ≤ Gi(b + t er) − Gi(b) ≤ Cκ sup

g

Ω

1

max{bi, br} t

for all 0 < t < ∞ and for each b ∈ RN
+ , r (cid:44) i. Using these estimates for r (cid:44) i, and
the fact that in the far ﬁeld the refractor measure is invariant by dilations, one can
also obtain the estimate (5.6).

6. Numerical analysis

In order to see our algorithm in action, we implemented routines in the C/C++
programming language to produce some concrete numerical examples of refrac-
. We will assume that the function g in Deﬁnition
tors for a given output image.
2.3 is constant.
Assuming b1 = 1 and conservation of energy G1(1, b2,··· , bN)+G2(1, b2,··· , bN)+
··· + GN(1, b2,··· , bN) =constant, we have from Remark 3.2 that the map
(6.1)

(b2,··· , bN) (cid:55)→ (G2(1, b2,··· , bN),··· , GN(1, b2,··· , bN))

(cid:107)

(cid:107)
All software used in our numerical investigation and graphical results can be found at

http://helios.physics.howard.edu/ deleo/Refractor/

22

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

(cid:16)∪N

(cid:17)c

.

i=1Fi

has a highly degenerate Jacobian in a large region of the phase space (e.g. see
Figure 1), that is, in the region ∪N
i=1Fi (with b1 = 1). Notice that the vector b in (2.8)
belongs to
To evaluate numerically the output intensities Gi(b) = GR(b)(mi) for any ﬁxed
b = (1, b2,··· , bN), we proceed as follows. We discretize Ω into a ﬁnite array of
directions A. Fix a direction γ ∈ A and considered the ray, denoted by (cid:96)γ, from
0 having direction γ. Now all the ellipsoids E(mj, bj) intersect the ray (cid:96)γ at some
point P(j, γ). Then there is a jγ such that the distance from P(j, γ) to the origin is
minimum, and we choose this ellipsoid. So for each γ ∈ A we have an index jγ
such that the ellipsoid E(mjγ, bjγ) intersects the ray (cid:96)γ at the point having minimum
distance to the origin. Since the refractor is by deﬁnition the minimum of the polar
radii of ellipsoids, then, in the direction γ, the refractor refracts into the direction
mjγ. This way we have a map T from each γ ∈ A into a vector mjγ. Clearly, this
map T might not cover all of the m1, ..., mN. We have

(6.2)

Gi(b) = #{γ ∈ A : T(γ) = mi}

#{γ ∈ A}

.

(cid:48)

(cid:48)
, b
j0

(cid:48)
), where b and b

(cid:48)

and subsequently obtaining the value of Gi(b

By doing so we cut the running time by a factor of N.

To reduce computational time in the calculation of Gi(b), it is helpful not only to
keep track of how many of the directions γ get refracted in the direction mi, but
also to record T(γ) at each γ ∈ A. This is because in two consecutive steps of
the algorithm described in Section 4 we need to compute the values of Gi(b) and
(cid:48)
are two vectors that diﬀer only in one component. In fact,
Gi(b
are successive values in the algorithm diﬀering only in the j0-th
suppose b and b
component, and we know T(γ) = mj relative to b. To evaluate T(γ) relative to
(cid:48)
b
), we only need to consider the
ellipsoids E(mjγ, bjγ) and E(mj0
) and the distance from the origin to P(j, γ) and
P(j0, γ).∗∗
From (4.13), we know that the number of iterations needed to ﬁnd the optimal
vector b, for which err = max2≤i≤N | fi − Gi(b)| < δ, grows not faster than N2/δ.
We expect it not to grow slower than this as well, so that we expect a theoretical
computational time of order O(N2/δ).
In addition, to use smaller values of δ
requires increasing the value of K and therefore increasing also the number of
directions in A to test (see the end of Section 4.2). Indeed, for any given A, from
(6.2) the set of values that Gi(b) takes on is ﬁnite. Therefore for δ small enough
+ δ.
there is j0 such that we cannot ﬁnd a value of bj0 for which fj0
This means that, if we want to ﬁnd a b such that err < δ, we need to increase the
size of A so that #A > 1/δ. Since the loop on A leads to a running time proportional
to #A, in our implementation we expect a computational time of order O(N2/δ2).
For the calculations here we choose Ω as the intersection of the upper semi
sphere in R3 with the cone with vertex at the origin and generated by the vectors
and b are as in Lemma 3.3, then if γ ∈ Tb(mj), then
(cid:48)(mk) for some k (cid:44) (cid:96).

γ ∈ Tb
Then by (3.2), γ ∈ Tb(mk), and since γ is not singular, we get k = j.

(cid:48)(mj) (γ no singular). Because if γ (cid:60) Tb

(cid:48)
∗∗
First notice that T depends on b. If b

(cid:48)(m(cid:96)), then γ ∈ Tb

(cid:48)(m(cid:96)) or γ ∈ Tb

< Gj0(b) < fj0

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

23

(1, 1, 2), (−1, 1, 2), (−1,−1, 2) and (1,−1, 2). The set Ω∗
is the intersection of the
upper semi sphere in R3 with the cone with vertex at the origin and generated by
the vectors (1, 1, 5), (−1, 1, 5), (−1,−1, 5) and (1,−1, 5). This choice of the domains Ω
and Ω∗
=(cid:8)[r : r
integers(cid:9) ;
satisfy the condition (2.5) avoiding total internal reﬂection when κ = 1/2.
, we choose the refracted directions {mi}1≤i≤N, with N = (n + 1)2, as
Inside Ω∗
Ω∗
ΩK =(cid:8)[r : r

(cid:48) = −n,−n + 2, . . . , n − 2, n; with r, r
(cid:48)
(cid:48), 2n). We discretize
: 2n] denotes the unit vector in the direction (r, r

N
(cid:48)
where [r : r
Ω into K = (2M + 1)2 points having the form

integers(cid:9) .

: 5n] : r, r

(cid:48)

: 2M] : −M ≤ r, r

(cid:48) ≤ M; with r, r

(cid:48)

(cid:48)

We always start the algorithm in Section 4 with a vector in W, the set of admis-
sible vectors, satisfying b1 = 1 and bi = 2 for i ≥ 2 to obtain a vector b satisfying
(2.8), with  = 1/10N, and uniform output intensities fi = 1/N, 1 ≤ i ≤ N, for the
directions mi ∈ Ω∗

N. That is, we stop our computations when

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)GR(b)(mi) − 1

N

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤  = 1

10N

.

max
1≤i≤N

While implementing the algorithm for 1 ≤ n ≤ 10, with δ = /N = 1/(10N2), as in
Section 4.2, our data in Fig. 2a, show that the number of iterations ν grows roughly
as ν(N) (cid:39) 0.3N2.8; although the exponent appears to slow down towards 2 as N
increases. This is consistent with (4.13), according to which the growth cannot be
faster than N4. Similarly, for the running times τ we observe that τ(N) (cid:39) 0.003N3.
Note that the evident jump in the running times when n ≥ 7 is due to the fact
that the values of δ for these cases get so small that for the algorithm to complete
successfully it is necessary to use for these cases larger values of K (M = 200 for n
up to 4, M = 250 for 5 ≤ n ≤ 6, M = 500 for n = 7, M = 350 for n = 8, M = 800 for
n = 9 and M = 1100 for n = 10). Such a fast growth suggests that, although the
algorithm in Section 4 always yields a solution b after a ﬁnite number of iterations,
it might take a long computational time for large values of n. For example for
n = 30, namely N = 961, these data predict a running time of at least 34 days.

The running time decreases considerably if we disregard the direction m1. In
fact, in order to be able to use the algorithm in Section 4.2 with higher values of
N, we disregard the intensity in the ﬁrst refracted direction m1, namely, we stop
our computations when

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)GR(b)(mi) − 1

N

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤  = 1

10N

.

max
2≤i≤N

As it is clear from the discussion in Section 4.2, in order to achieve this result it
is enough to take δ ≤ . This way, omitting m1, δ will decrease more slowly with
N and, accordingly, the number of iterations will grow slower with N and with
the size of the discretization of Ω. Therefore, the running time will be shorter. In
Fig. 2b we show the growth of the number of iterations and running time when
1 ≤ n ≤ 30, corresponding to 4 ≤ N ≤ 961. In this case, the data show a growth

24

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

a) Runtime/iteration time growth with full error

b) Runtime/iteration time growth with partial error

c) Lens

d) Vector b for N = 5041

Figure 2. a) Growth of runtime and number of iterations in our imple-
mentation of the algorithm of Section 4.2 when we minimize |GR(b)(mi) −
1/N| for all mi. Blue is (ln N, ln τ(N)); orange is (ln N, ln ν(N)). b) Same plot
when we disregard what happens in the direction m1, as a function of the
number of output directions. c) Detail of the lens giving rise to Descartes’
image with N = 712 output directions. d) Plot of the components of the
→ R, when the refractor R(b) gives the
vector b, considered as a map Ω∗
71 × 71 Descartes’ picture in Figure 3 b. The set Ω∗
N is represented as the
(cid:48) = −n,−n + 2, . . . , n, inside the square
(cid:48)/5n), r, r
array of points (r/5n, r
[−1/5, 1/5]2.

N

in the number of iterations ν roughly quadratic in the number N of the output
directions: ν(N) (cid:39) 2.7N2.05. Similarly, for the running times τ, we observe that
τ(N) (cid:39) αN1.9. Here α depends on the value of δ, and so from the duration of
every single step in the program’s loop to evaluate the map T(γ), the size of the
discretization ΩK (and therefore the number of steps in the loop above), as well as
on non mathematical factors like the hardware on which the program runs
and
the coding details of the algorithm implementation. For 1 ≤ n ≤ 9 (see Fig. 2a)
−3 and M = 200 and ﬁnd α (cid:39) 0.03 seconds. For n ≥ 10, the value
we use δ = 10
−3 is not small enough for the algorithm to reach a 10% error and so we
δ = 10
lower it to δ = 2 · 10
−4. This change of course increases α, leading to the visible
jump in the (log-log) graph of τ(N). For 10 ≤ n ≤ 22 we ﬁnd α (cid:39) 0.05s. For n ≥ 23,

††

††
All data in Fig. 2 and Fig 3 are produced on an Intel Xeon 2.6GHz CPU

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

25

a discretization of Ω with M = 200 is not ﬁne enough to allow the evaluation of
the map T(γ). So we increase M to 300, leading to a second visible jump in the
graph corresponding to the larger value α (cid:39) 0.135 secs. For example, with this
last value of α, we get a lower bound of about 16 days for the running time in the
case N = 5000, i.e, n ≈ 70.
The results can be obtained faster combining this algorithm for small values
of n with a quasi-Newtonian root-ﬁnding algorithm. Such methods are gen-
eralizations of the Newton method to ﬁnd the root of a function without an
explicit expression of its Hessian. The problem is that, as for the Newton method,
quasi-Newtonian methods require a starting point where the function has a non-
degenerate Jacobian and, as we already pointed out at the beginning of the section,
the function (6.1) has a degenerate Jacobian in a large portion of its domain. We
use the GNU Scientiﬁc Library (GSL) implementation of the quasi-Newtonian
version of Powell’s Hybrid method, since this method does not need an explicit
Jacobian.

(cid:12)(cid:12)(cid:12)GR(b)(mi) − 1/N

∗
for which the output intensities Gi(b

961, corresponding to n = 30. This computation, with δ = 10

(cid:12)(cid:12)(cid:12) <  over the array Ω∗

Therefore, as a ﬁrst step we use the algorithm from Section 4.2 (disregarding
the direction m1) to ﬁnd a vector ˜b inside the region where the Jacobian is non-
degenerate. And next use ˜b as a starting point of the quasi-Newtonian algorithm
∗
to ﬁnd a vector b
) are “close enough” to
the fi = 1/N. In fact, we start by evaluating a vector ˜b = (˜b1, . . . , ˜b961) which gives
homogeneous light intensity ( fi = 1/N) in all directions (except m1) within 10% for the
output array Ω∗
−4 and
M = 300, took about 15 hours. The vector ˜b is then used as starting point by any
∗ = (b1, . . . , b961) such that
quasi-Newtonian method to ﬁnd the desired vector b
max1≤i≤961
961 and any (reasonable) . With
this method, it takes only about 25 minutes to ﬁnd, starting from the vector ˜b, a
∗
giving rise to a homogeneous distribution of light ( fi = 1/N) in all the
vector b
directions of the array Ω∗
∗
We now use the vector b
as a pivot in a concrete case; namely, to produce a lens
that yields an image of a famous portrait of Descartes by Frans Hals on the array
of refracted directions Ω∗
14641, corresponding to n = 120. The images produced
with the lens using LuxRender are shown in Fig. 3 for various resolutions. First
of all, we need to extract from a digital version of the original picture the output
intensities fi, 1 ≤ i ≤ 14641. For this purpose we use Imlib2, a general purpose
open source C library aimed at images manipulation. Our ﬁnal goal is ﬁnding a
vector b so that the refractor R(b) satisﬁes the inequalities
{ fi}/10.

961 within 10%!

(6.3)

(cid:12)(cid:12)(cid:12)GR(b)(mi) − fi

(cid:12)(cid:12)(cid:12) ≤ min

1≤i≤14641

max
1≤i≤14641

Note that, since the naked eye cannot usually detect nuances of black within a
complex picture, and since for large arrays the amount of light in dark spots is
very low, it is actually enough for us that the max and min in (6.3) are taken only
over i such that fi is suﬃciently large when N is large ( fi small corresponds with

26

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

a) Rendering (VTK 41x41)

b) Rendering (CGAL 71x71)

c) Rendering (VTK 121x121)

d) Rendering (CGAL 121x121)

Figure 3. Rendering of Descartes’ image from 3D models generated by
the graphic libraries VTK and CGAL. The rendering has been done via
LuxRender, a physically accurate raytracer engine, through the modeling
package Blender.

∗

961. Next using b

dark spots). Heuristically for this particular case we set this number to be 30% of
the total number of refracted directions.
Now we evaluate the coeﬃcients fi corresponding to Descartes’ picture for the
array Ω∗
, calculated in the ﬁrst step, as a starting point in the
quasi-Newtonian algorithm, we ﬁnd the corresponding b giving rise to the fi.
It takes about 23 minutes to get a b such that all GR(b)(mi) are within 10% from
the fi; all but one within 1%, and 96% of them are within .1%. At this point, we
consider the array Ω∗
1681, corresponding to n = 40, evaluate the fi’s corresponding
to Descartes’ picture on this array and use a standard interpolation algorithm (in
concrete we use an implementation available in the GSL) to interpolate the values
of (b1, . . . , b961) into a new vector (˜b1, . . . , ˜b1681) and ﬁnally use this as starting point
for the quasi-Newtonian code to ﬁnd a vector b = (b1, . . . , b1681) giving rise to the
fi, 1 ≤ i ≤ 1681, within 10%. It takes about 28 minutes to ﬁnd a b such that all
GR(b)(mi) but three are within 10% from the corresponding fi (and 98% of them
is actually within 1%). From this we move to the array Ω∗
2601, interpolate the
previous b = (b1, . . . , b1681) to a new ˜b = (b1, . . . , b2601) and use it as a starting point
for the quasi-Newtonian algorithm, that in about 3 hours is able to ﬁnd a b such

ON THE NUMERICAL SOLUTION OF THE FAR FIELD REFRACTOR PROBLEM

27

that all GR(b)(mi) but ﬁve are within 10% from the corresponding fi. We continue
with this process by increasing n by 10 at every step until we arrive to n = 120,
which provides the ﬁnal b (see Fig. 3c,d) so that the 70% of the GR(b)(mi) are within
10% from the corresponding fi. The last computational step took about 2 days.
The process can be continued to obtain higher resolution pictures.

7. Conclusion

We have obtained a numerical procedure to ﬁnd far ﬁeld refractors with arbi-
trary precision when the target is discrete composed of N directions, and radiation
emanates from one source point. The density of the incoming radiation is assumed
only bounded away from zero and inﬁnity, and the domains Ω are general subsets
of the unit sphere having boundary with surface measure zero. The procedure
converges in a ﬁnite number of steps and an estimate of this number is given
in terms of N, the angles between the diﬀerent directions in the target, and the
required approximation. To show the convergence we prove a Lipschitz estimate
of the refractor map. A numerical implementation of the algorithm is carried out
by using C/C++ programming language, and concrete examples of refractors for
a given output image are provided. The near ﬁeld case can be treated with similar
methods and we will return to this problem in the near future.

References

[BHP15a] K. Brix, Y. Haﬁzogullari, and A. Platen, Designing illumination lenses and mirrors by the
numerical solution of Monge-Amp`ere equations, Jour. Optical Soc. Amer. A, to appear;
http://arxiv.org/pdf/1506.07670.pdf, 2015.

[BHP15b]

, Solving the Monge-Ampere equations for the inverse reﬂector problem, Mathematical
Models and Methods in Applied Sciences 25 (2015), no. 5, 803–837, https://arxiv.
org/pdf/1404.7821v2.pdf.

[BW59] M. Born and E. Wolf, Principles of optics, electromagnetic theory, propagation, interference
and diﬀraction of light, seventh (expanded), 2006 ed., Cambridge University Press, 1959.
[CKO99] L. A. Caﬀarelli, S. A. Kochengin, and V. Oliker, On the numerical solution of the problem of
reﬂector design with given far-ﬁeld scattering data, Contemporary Mathematics 226 (1999),
13–32.

[CMT15] Pedro Machado Manh˜aes Castro, Quentin M´erigot, and Boris Thibert, Far-ﬁeld reﬂector

problem and intersection of paraboloids, Numerische Mathematik (2015), 1–23.
C. E. Guti´errez and Qingbo Huang, The refractor problem in reshaping light beams, Arch.
Rational Mech. Anal. 193 (2009), no. 2, 423–443.

[GM13] C. E. Guti´errez and H. Mawi, The far ﬁeld refractor with loss of energy, Nonlinear Analysis:

[GH09]

[GS14]

[GT13]

[GT15]

Theory, Methods & Applications 82 (2013), 12–46.
C. E. Guti´errez and A. Sabra, The reﬂector problem and the inverse square law, Nonlinear
Analysis: Theory, Methods & Applications 96 (2014), 109–133.
C. E. Guti´errez and F. Tournier, The parallel refractor, Development in Mathematics 28
(2013), 325–334.

, Regularity for the near ﬁeld parallel refractor and reﬂector problems, Calc. Var. PDEs

54 (2015), no. 1, 917–949.

[Gut14] C. E. Guti´errez, Refraction problems in geometric optics, Lecture Notes in Mathematics,

vol. 2087, Springer-Verlag, 2014, pp. 95–150.

28

ROBERTO DE LEO, CRISTIAN E. GUTI ´ERREZ AND HENOK MAWI

[Kit14]

Jun Kitagawa, An iterative scheme for solving the optimal transportation problem, Calc. Var.
PDEs 51 (2014), no. 1-2, 243–263.

[MTW05] Xi-Nan Ma, N. Trudinger, and Xu-Jia Wang, Regularity of potential functions of the optimal

transportation problem, Arch. Rational Mech. Anal. 177 (2005), no. 2, 151–183.

Department of Mathematics, Howard University, Washington, D.C. 20059
E-mail address: roberto.deleo@howard.edu, henok.mawi@howard.edu

Department of Mathematics, Temple University, Philadelphia, PA 19122
E-mail address: gutierre@temple.edu

