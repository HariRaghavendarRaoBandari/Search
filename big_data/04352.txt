6
1
0
2

 
r
a

 

M
4
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
2
5
3
4
0

.

3
0
6
1
:
v
i
X
r
a

OVERPARTITIONS RELATED TO THE MOCK THETA FUNCTION ω(q)

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Abstract. It was recently shown that qω(q), where ω(q) is one of the third order mock theta
functions, is the generating function of pω(n), the number of partitions of a positive integer n such

that all odd parts are less than twice the smallest part. In this paper, we study the overpartition

analogue of pω(n), and express its generating function in terms of a 3φ2 basic hypergeometric series
and an inﬁnite series involving little q-Jacobi polynomials. This is accomplished by obtaining a new

seven parameter q-series identity which generalizes a deep identity due to the ﬁrst author as well
as its generalization by R.P. Agarwal. We also derive two interesting congruences satisﬁed by the

overpartition analogue, and some congruences satisﬁed by the associated smallest parts function.

1. Introduction

Since Ramanujan introduced mock theta functions in his last letter to Hardy in 1920, they have
been the subject of intense study for many decades. Along with his third order mock theta function
f (q), there are many studies on the mock theta function

in the literature [12], [16], [19], [27]. Throughout the paper, we adopt the following q-series notation:

ω(q) :=

q2n2+2n
(q; q2)2

n+1

∞

Xn=1

(a; q)n := (1 − a)(1 − aq)··· (1 − aqn−1),
(a; q)∞ := lim
n→∞

(a; q)n,|q| < 1.

When the base is q, we sometimes use the short-hand notation (a)n := (a; q)n, (a)∞ := (a; q)∞.

In a recent paper [10], the ﬁrst, second and the fourth author discovered a new partition theoretic
interpretation of ω(q), namely, the coeﬃcient of qn in q ω(q) counts pω(n), the number of partitions
of n in which all odd parts are less than twice the smallest part, that is,

∞

∞

pω(n)qn =

Xn=1

qn

(1 − qn)(qn+1; q)n(q2n+2; q2)∞

= qω(q).

Xn=1

In the same paper they also studied the associated smallest parts function sptω(n) whose generating
function is given by

sptω(n)qn =

∞

Xn=1

∞

Xn=1

qn

(1 − qn)2(qn+1; q)n(q2n+2; q2)∞

.

In this paper we study the overpartition analogue of pω(n) and its associated smallest parts function.
Overpartitions are ordinary partitions extended by allowing a possible overline designation on the

1Keywords: partitions, overpartitions, smallest parts functions, mock theta functions, partition congruences, basic

hypergeometric series, little q-Jacobi polynomials

22000 AMS Classiﬁcation Numbers: Primary, 11P81; Secondary, 05A17

1

2

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

ﬁrst (or equivalently, the ﬁnal) occurrence of a part. For instance, there are 8 overpartitions of 3, i.e.,
3, 3, 2 + 1, 2 + 1, 2 + 1, 2 + 1, 1 + 1 + 1, and 1 + 1 + 1. Throughout this paper, however, we consider
overpartitions in which the smallest part is always overlined, and denote by p(n) the number of such
overpartitions. For instance, p(3) = 4 since there are 4 such overpartitions of 3, i.e., 3, 2 + 1, 2 + 1,
and 1 + 1 + 1. In an overpartition, a smallest part may or may not be overlined, so the number of
overpartitions of n is exactly twice of p(n).

Since its introduction in [17], the overpartition construct has been very popular, and has led to a

number of studies in q-series, partition theory, modular and mock modular forms.

As remarked earlier, in this paper we study the overpartition analogue of pω(n), namely pω(n),
which enumerates the number of overpartitions of n such that all odd parts are less than twice the
smallest part, and in which the smallest part is always overlined. It is clear that its generating function
is given by

pω(n)qn =

∞

Xn=1

The series in (1.1) can be simpliﬁed to

∞

Xn=1

qn(−qn+1; q)n(−q2n+2; q2)∞
(1 − qn)(qn+1; q)n(q2n+2; q2)∞

.

pω(n)qn =

∞

Xn=1

=

q(−q2; q2)∞
(1 − q)(q2; q2)∞
q(−q2; q2)∞
(1 − q)(q2; q2)∞

∞

Xn=0
4φ3 q,

(−q3; q2)n(q; q)n
(q3; q2)n(−q2; q)n

qn

q,
−q2,

q3/2, −q3/2 ; q, q! ,
iq3/2, −iq3/2

(1.1)

(1.2)

where the basic hypergeometric series r+1φr is deﬁned as

r+1φr a1, a2, . . . , ar+1

b1, b2, . . . , br

; q, z! :=

∞

Xn=0

(a1; q)n(a2; q)n ··· (ar+1; q)n

(q; q)n(b1; q)n ··· (br; q)n

zn.

Thus the generating function is essentially a nonterminating 4φ3. The problem of relating this gener-
ating function with familiar objects in the theory of basic hypergeometric series, modular forms and
mock modular forms is quite diﬃcult. In fact in order to transform it, we derive a new multi-parameter
q-series identity, which generalizes a deep identity due to the ﬁrst author, and its extension due to
R.P. Agarwal (see Theorem 3.1). Basically we need its following variant for our case.

Theorem 1.1. Let the Gaussian polynomial be deﬁned by

m#q
" n
m# =" n

(q; q)n

(q; q)m(q; q)n−m
0, otherwise.

:=


,

if 0 ≤ m ≤ n,

(1.3)

Then, provided β, δ, f, t 6= q−j, j ≥ 0, the following identity holds:

(α)n(γ)n(ǫ)n
(β)n(δ)n(f )n

tn

∞

Xn=0

=

(ǫ, γ, β/α, q, αt, q/(αt), δq/β, f q/β; q)∞

(f, δ, q/α, β, β/(αt), αtq/β, γq/β, ǫq/β; q)∞

β ,

3φ2  αq

+(cid:18)1 −

q

β(cid:19) (ǫ, γ, t, δq/β, f q/β; q)∞

(f, δ, αt/β, γq/β, ǫq/β; q)∞

β ,

3φ2(cid:18) αq

γq
β ,
δq
β ,

γq
β ,
δq
β ,
ǫq
β
f q
β

ǫq
β
f q
β

; q, t!

; q, t(cid:19)(cid:18)2φ1(cid:18)q,

q
t
βq
αt

; q,

q

α(cid:19) − 1(cid:19)

+

q

β(cid:19)

(ǫ, γ; q)∞

(f, δ; q)∞ (cid:18)1 −
Xn=0
×

∞

(t)n

(q)n(αt/β)n+1 (cid:18) q

β(cid:19)n n
Xp=0

3

ǫm(cid:18) δ

γ(cid:19)n−m

γn−m,

(1.4)

(αt/β)p

(t)p (cid:18) β

q(cid:19)p n

Xm=0" n

m#(cid:18) f

ǫ(cid:19)m

where we use the notation

(a1, a2,··· , am; q)n := (a1; q)n(a2; q)n ··· (am; q)n.

This result is then specialized to obtain the following theorem which expresses the generating
function in terms of a 3φ2 basic hypergeometric series and an inﬁnite series involving the little q-
Jacobi polynomial deﬁned by [8, Equation (3.1)]

pn(x; α, β : q) = 2φ1(cid:18)q−n, αβqn+1

αq

; qx(cid:19).

(1.5)

∞

Theorem 1.2. The following identity holds for |q| < 1:
Xn=0
(q; q2)n(−q)n
(−q; q2)n(1 + q2n)

qn(−q3; q2)n(q; q)n
(q3; q2)n(−q2; q)n

q(cid:19) (q; q)2
(−q; q)2
Xn=0

(−q; q2)∞
(q3; q2)∞

2(cid:18)1 −

Xn=0

1
q

+

=

∞

∞

∞

∞

1

1

(−1; q)n(−q; q2)n
(q; q2)n(q; q)n

qn

p2n(−1; q−2n−1,−1 : q).

(1.6)

Hence the generating function of pω(n) is given by

∞

Xn=1

pω(n)qn = −

+

∞

Xn=0

1
2

(q; q)∞(q; q2)∞
(−q; q)∞(−q; q2)∞
(−q; q)∞
(q; q)∞

∞

Xn=0

(−1; q)n(−q; q2)n
(q; q2)n(q; q)n

qn

(q; q2)n(−q)n

(−q; q2)n(1 + q2n)

p2n(−1; q−2n−1,−1 : q).

(1.7)

The series involving the little q-Jacobi polynomials on the right side of (1.6) satisﬁes a nice con-

gruence modulo 4 given below.

Theorem 1.3. The following congruence holds:

1
q

(−q; q2)∞
(q3; q2)∞

∞

Xn=0

(q; q2)n(−q)n

(−q; q2)n(1 + q2n)

p2n(−1; q−2n−1,−1 : q) ≡

1
2q −

1
2

(mod 4).

(1.8)

This suggests that this series might be further linked to some important objects in the literature. As
of now this has remained elusive for us though.

The overpartition function pω(n) satisﬁes some nice congruences. Indeed the two congruences in

the following theorem will be proved in Section 4.

Theorem 1.4. We have

pω(4n + 3) ≡ 0 (mod 4),
pω(8n + 6) ≡ 0 (mod 4).

(1.9)

(1.10)

4

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Bringmann, Lovejoy, and Osburn [14, 15] deﬁned spt(n) as the number of smallest parts in the
overpartitions of n and showed that spt(n) is a quasimock theta function (see [15, p. 3–4] for the
deﬁnition) satisfying simple Ramanujan-type congruences, for instance,

spt(3n) ≡ 0 (mod 3).

In this paper, we study sptω(n), the number of smallest parts in the overpartitions of n in which
the smallest part is always overlined and all odd parts are less than twice the smallest part. By its
deﬁnition we see that the generating function of sptω(n) is given by

sptω(n)qn =

∞

Xn=1

∞

Xn=1

qn(−qn+1; q)n(−q2n+2; q2)∞
(1 − qn)2(qn+1; q)n(q2n+2; q2)∞

.

(1.11)

The smallest parts function sptω(n) seems to carry arithmetic properties analogous to those of spt2(n),
where spt2(n) counts the number of smallest parts in the overpartitions of n with smallest parts even.
It is known [14] that

spt2(3n) ≡ 0
spt2(3n + 1) ≡ 0
spt2(5n + 3) ≡ 0

(mod 3),

(mod 3),

(mod 5).

The following are the main congruences satisﬁed by sptω(n):

Theorem 1.5. We have

sptω(3n) ≡ 0 (mod 3),
sptω(3n + 2) ≡ 0 (mod 3),
sptω(10n + 6) ≡ 0 (mod 5),
sptω(6n + 5) ≡ 0 (mod 6).

There are further congruences that both spt(n) and sptω(n) satisfy:

Theorem 1.6. For any positive integer n,

if n = k2 or 2k2 for some k,

0 (mod 2) otherwise.

Theorem 1.7. For any positive integer n,

1 (mod 2)

sptω(n) ≡ spt(n) ≡

spt(7n) ≡ spt( n
7 )
sptω(7n) ≡ sptω( n
7 )

(mod 4),

(mod 4),

(1.12)

(1.13)

(1.14)

(1.15)

(1.16)

(1.17)

(1.18)

(1.19)

(1.20)

(1.21)

where we follow the convention that spt(x) = sptω(x) = 0 if x is not a positive integer.

This paper is organized as follows.

In Section 2, we recall some basic facts and theorems that
are used in the sequel. Section 3 is devoted to ﬁnding an alternate representation for the generating
function of pω(n) in terms of a 3φ2 basic hypergeometric series and an inﬁnite series involving the
little q-Jacobi polynomials. A congruence modulo 4, satisﬁed by the latter series, is also obtained in
this section. In Section 4, we give a proof of the congruences modulo 4 satisﬁed by pω(n). We recall
some facts about spt(n) and spt2(n) in Section 5 and represent the generating function of sptω(n) in

terms of those of these functions. In Section 6, we prove the congruences modulo 3, 5 and 6 given in
Theorem 1.5 based on these representations. Lastly we prove Theorems 1.6 and 1.7 in Section 7.

5

2. Preliminaries

We collect below the important facts and theorems in the literature on q-series and partitions in this
section. First of all, we assume throughout the paper that |q| < 1. The most fundamental theorem in
the literature is the q-binomial theorem given for |z| < 1 by [5, p. 17, Equation (2.2.1)]

(a; q)nzn
(q; q)n

=

(az; q)∞
(z; q)∞

.

∞

Xn=0

For |z| < 1 and |b| < 1, Heine’s transformation [5, p. 19, Corollary 2.3] is given by

2φ1 a,

b
c

; q, z! =

(b, az; q)∞
(c, z; q)∞

2φ1 c/b,

z
az

; q, b! ,

and we also note Bailey’s 10φ9 transformation [7, Equation (2.10)], [11, Equation (6.3)]

(2.1)

(2.2)

a3q4N +3
p2
1p2

2f 


(2.3)

p1,
aq2
p1

,

p1q,
aq
p1

,

p2,
aq2
p2

,

p2q,
aq
p2

,

f,
aq2
f

q−2N ,

q−2N +1

, aq2N +2, aq2N +1 ; q2,

lim
N→∞

=

a,

q2√a, −q2√a,
10φ9
√a,
−√a,

(aq; q)∞(cid:18) aq
; q(cid:19)∞
(cid:18) aq
; q(cid:19)∞
; q(cid:19)∞(cid:18) aq

Xn=0

p1p2

p1

p2

∞

(p1; q)n(p2; q)n(cid:16) aq
(q; q)n(aq; q2)n(cid:16) aq

f ; q2(cid:17)n
f ; q(cid:17)n

p1p2(cid:19)n
(cid:18) aq

.

Finally we note a transformation for 2ψ2 due to Bailey [21, p. 148, Exer. 5.11]:

2ψ2  e, f

c , aq

aq

d

; q,

aq

ef! =

c , q
( q
(aq, q

d , aq
a , aq

e , aq
cd , aq

f ; q)∞
ef ; q)∞

∞

Xn=−∞

(1 − aq2n)(c, d, e, f ; q)n
(1 − a)( aq

f ; q)n (cid:18) qa3

d , aq

e , aq

c , aq

cdef(cid:19)n

qn2

,

(2.4)

where rψr is the basic bilateral hypergeometric series deﬁned by [21, p. 137, Equation (5.1.1)]

rψr a1, a2, . . . , ar

b1, b2, . . . , br

; q, z! :=

∞

Xn=−∞

(a1, a2,··· , ar; q)n
(b1, b2,··· , br; q)n

zn.

3. The generating function of pω(n)

First, we recall that pω(n) counts the number of overpartitions of n such that all odd parts are less
than twice the smallest part, and in which the smallest part is always overlined. None of the already
existing identities from the theory of basic hypergeometric series seems to be capable of handling
its generating function. Hence we devise a new q-series identity consisting of seven parameters that
transforms (1.2) into a 3φ2 and an inﬁnite series involving little q-Jacobi polynomials deﬁned in (1.5).
The motivation and the need for devising such an identity is now given.

In the proof of the representation of the generating function of pω(n) in terms of the third order
mock theta function ω(q) [10, Theorem 3.1], the following four parameter q-series identity due to the

6

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

ﬁrst author [6, Theorem 1] played an instrumental role.

∞

Xn=0

(B; q)n(−Abq; q)nqn
(−aq; q)n(−bq; q)n

= −a−1(B; q)∞(−Abq; q)∞

(−bq; q)∞(−aq; q)∞

∞

Xm=0

a (cid:17)m
(A−1; q)m(cid:16) Abq
(cid:0)− B
a ; q(cid:1)m+1
(−a−1; q)m+1(cid:16)− ABq
a ; q(cid:17)m
(−b)m
a ; q(cid:1)m+1(cid:16) Abq
a ; q(cid:17)m+1
(cid:0)− B

.

+ (1 + b)

∞

Xm=0

(3.1)

Agarwal [2, Equation (3.1)] obtained the following ‘mild’ extension/generalization of (3.1) in the

sense that we get (3.1) from the following identity when t = q.

(α)n(γ)n
(β)n(δ)n

tn

∞

Xn=0

=

(q/(αt), γ, αt, β/α, q; q)∞
(β/(αt), δ, t, q/α, β; q)∞

2φ1(cid:18)δ/γ,

+

+

(γ)∞

(δ)∞ (cid:18)1 −
(δ)∞ (cid:18)1 −

(γ)∞

q

β(cid:19) ∞
Xm=0
β(cid:19) ∞
Xp=0

q

t

qαt/β

; q, γq/β(cid:19)
(qγ/β)m 2φ1(cid:18)q,

(δ/γ)m(t)m

(q)m(αt/β)m+1

q/t

qβ/(αt)

; q, q/α(cid:19) − 1!

γp(δ/γ)p

(q)p

∞

Xm=0

(δqp/γ)m(tqp)m

(q1+p)m(αtqp/β)m+1

(qγ/β)m.

(3.2)

Since the right side of (1.2) involves three q-shifted factorials (with base q) in the numerator as well
as in the denominator of its summand, we need to ﬁrst generalize (3.2). Indeed, a generalization of
(3.2) will be given below. However, we shall ﬁrst prove its variant, namely Theorem 1.1, that we need
for our purpose.

Proof of Theorem 1.1. Let

S := S(α, β, γ, δ, ǫ, f ; q; t) :=

(α)n(γ)n(ǫ)n
(β)n(δ)n(f )n

tn.

∞

Xn=0

(3.3)

Then by an application of the q-binomial theorem (2.1),

S =

=

=

=

=:

(ǫ)∞
(f )∞

(ǫ)∞
(f )∞

(ǫ)∞
(f )∞

(ǫ)∞
(f )∞

∞

∞

∞

Xn=0
Xn=0
Xm=0
Xm=0

∞

(α)n(γ)n(f qn)∞
(β)n(δ)n(ǫqn)∞

tn

(α)n(γ)ntn
(β)n(δ)n

(f /ǫ)mǫm

(q)m

∞

∞

Xm=0
Xn=0

(f /ǫ)m
(q)m

(ǫqn)m

(α)n(γ)n
(β)n(δ)n

(tqm)n

(f /ǫ)mǫm

(q)m (cid:26) (q1−m/(αt), γ, αtqm, β/α, q; q)∞

(βq−m/(αt), δ, tqm, q/α, β; q)∞

2φ1(cid:18)δ/γ,

+

(γ)∞
(δ)∞

(1 − q/β)
(1 − αtqm/β)
V1 + V2(cid:19) ,

(ǫ)∞

(f )∞ (cid:18) (γ, β/α, q; q)∞

(δ, q/α, β; q)∞

(δ/γ)k(αtqm/β)kγk
(q)k(αtqm+1/β)k

∞

Xk=0

∞

Xr=0

αtqm+1/β

tqm

; q, γq/β(cid:19)
(βq1−k−m/(αt))r (cid:16) q

(q1−k−m/t)r

α(cid:17)r(cid:27)

(3.4)

where in the penultimate step, we used (3.2) in the form given in [2, Equation (3.2)]. Here

Next, using Heine’s transformation (2.2) in the second step below, we see that

V1 :=

V2 :=

∞

Xm=0
(δ)∞ (cid:18)1 −

(γ)∞

(f /ǫ)m(q1−m/(αt), αtqm; q)∞ǫm

(q)m(βq−m/(αt), tqm; q)∞

q

β(cid:19) ∞
Xm=0

(cid:16) f
ǫ(cid:17)m

β (cid:17)
(q)m(cid:16)1 − αtqm

V1 =

(αt)∞(q/(at))∞
(t)∞(β/(at))∞

∞

Xm=0

(αt)∞(q/(at))∞(δq/β)∞

(αtq/β)∞(γq/β)∞(β/(at))∞

=

=

∞

Xm=0
Xk=0

tqm

∞

γk

ǫm

αtqm+1/β

2φ1(cid:18)δ/γ,
(cid:16) δ
γ(cid:17)k(cid:16) αtqm
β (cid:17)k
Xk=0
(cid:17)k
(q)k(cid:16) αtqm+1
β (cid:19)m
2φ1(cid:18)δ/γ,
(αtq/β)m(q)m (cid:18) qǫ
β (cid:19)m
(q)m (cid:18) qǫ

(f /ǫ)m(t)m

(f /ǫ)m

∞

β

t

∞

αt

; q, γq/β(cid:19),
(cid:16) q1−k−m
(cid:17)r
(cid:17)r (cid:16) q
α(cid:17)r
Xr=0
(cid:16) βq1−k−m
; q, γq/β(cid:19)
; q, tqm(cid:19)

αtqm+1/β

tqm

2φ1(cid:18)αq/β, γq/β

δq/β

(αt)∞(q/(at))∞(δq/β)∞

(αtq/β)∞(γq/β)∞(β/(at))∞

(αq/β)k(γq/β)k(f qk+1/β)∞tk

(δq/β)k(q)k(ǫqk+1/β)∞

,

where in the last step we used (2.1) after interchanging the order of summation. Hence

V1 =

(αt, q/(αt), δq/β, f q/β; q)∞

(β/(αt), αtq/β, γq/β, ǫq/β; q)∞

3φ2(cid:18)αq/β,

γq/β,

ǫq/β

δq/β, f q/β

; q, t(cid:19).

7

.

(3.5)

(3.6)

(3.7)

,

q(cid:19)p


(3.8)

(3.9)

.

(3.10)

Let us now consider V2. Since

∞

Xr=0

(q1−k−m/t)r

α(cid:17)r
(βq1−k−m/(αt))r (cid:16) q

=

=

∞

(t)m+k

(t)m+k

(αt/β)m+k−r

β(cid:19)m+k ∞
(αt/β)m+k (cid:18) q
(t)m+k−r (cid:18) β
Xr=0
β(cid:19)m+k
Xp=1 (cid:0) q
t(cid:1)p
(cid:18) q
αt(cid:17)p (cid:16) q
α(cid:17)p

(cid:16) βq
β(cid:19) (V3 + V ∗

(δ)∞ (cid:18)1 −

β (cid:17)m+k
(cid:16) αt

(γ)∞

V2 =

3 ),

+

q

q(cid:19)m+k−r
Xp=0

m+k

(αt/β)p

(t)p (cid:18) β

we ﬁnd that

where

V3 :=

V ∗
3 :=

∞

∞

Xm=0
Xm=0

(f /ǫ)m(t)m(ǫq/β)m

(q)m(αt/β)m(1 − αtqm/β)
(f /ǫ)m(ǫq/β)m
(q)m(1 − αtqm/β)

∞

Xk=0

(δ/γ)k(tqm)k(γq/β)k

(q)k(αtqm+1/β)k

∞

Xk=0

(δ/γ)k(t)m+k(αtqm/β)k(γq/β)k

(q)k(αtqm+1/β)k(αt/β)m+k

∞

,

(q/t)p

(βq/(αt))p (cid:16) q
α(cid:17)p
Xp=1
q(cid:19)p
(t)p (cid:18) β
Xp=0

(αt/β)p

m+k

Consider V3. Again using Heine’s transformation (2.2) for the middle series followed by (2.1), we have

V3 =

(t, δq/β, f q/β; q)∞

(αt/β, γq/β, ǫq/β; q)∞

3φ2(cid:18)αq/β, γq/β,

δq/β,

ǫq/β
f q/β

; q, t(cid:19)(cid:18)2φ1(cid:18)q,

q/t

βq/(αt)

; q, q/α(cid:19) − 1(cid:19).

(3.11)

Also,

V ∗
3 =

∞

Xn=0

(t)n

(q)n(αt/β)n+1 (cid:18) q

β(cid:19)n n
Xp=0

(αt/β)p

(t)p (cid:18) β

q(cid:19)p n

Xm=0" n

m#(cid:18) f

ǫ(cid:19)m

ǫm(cid:18) δ

γ(cid:19)n−m

(γ)n−m.

(3.12)

8

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Finally from (3.4), (3.7), (3.9), (3.11) and (3.12), we arrive at (1.4).

(cid:3)

We now give the aforementioned generalization of (3.2) which can also be viewed as a corollary of
Theorem 1.1.

Theorem 3.1. Provided β, δ, f, t 6= q−j, j ≥ 0, the following identity holds:

(α)n(γ)n(ǫ)n
(β)n(δ)n(f )n

tn

∞

Xn=0

=

(ǫ, γ, β/α, q, αt, q/(αt), δq/β, f q/β; q)∞

(f, δ, q/α, β, β/(αt), αtq/β, γq/β, ǫq/β; q)∞

3φ2 αq/β, γq/β,

δq/β,

ǫq/β
f q/β

; q, t!

3φ2(cid:18)αq/β, γq/β,

δq/β,

ǫq/β
f q/β

; q, t(cid:19)

q

+(cid:18)1 −
×(cid:18)2φ1(cid:18)q,
+(cid:18)1 −
Xp=0
×
+(cid:18)1 −

∞

q

(f, δ, αt/β, γq/β, ǫq/β; q)∞

β(cid:19) (ǫ, γ, t, δq/β, f q/β; q)∞
; q/α(cid:19) − 1(cid:19)

βq/(αt)

q/t

(f, δ, αt/β, ǫq/β; q)∞

β(cid:19) (ǫ, γ, t, f q/β; q)∞
Xk=0

(δ/γ)p(αt/β)pγp

(t)p(q)p

∞

q

β(cid:19) (ǫ, γ; q)∞

(f, δ; q)∞

∞

Xp=1

∞

Xk=0

(δqp/γ)k(qγ/β)k

(q1+p)k

ǫq/β
f q/β

; q, tqk+p(cid:19)

(f /ǫ)pǫp

(δ/γ)kγk

(f qp/ǫ)m(tqp+k)m

(q)p

(q)k

(q1+p)m(αtqp+k/β)m+1

(ǫq/β)m.

(3.13)

2φ1(cid:18)αq/b,
Xm=0

∞

Proof. Write V ∗

3 in (3.10) as

where

V ∗
3 = V4 + V5,

(3.14)

∞

V4 =

(f /ǫ)m(ǫq/β)m
(q)m(1 − αtqm/β)
(f /ǫ)m(ǫq/β)m
(q)m(1 − αtqm/β)
Note that V4 can be written as

Xm=0
Xm=0

V5 =

∞

(δ/γ)k(t)m+k(αtqm/β)k(γq/β)k

(q)k(αtqm+1/β)k(αt/β)m+k

(δ/γ)k(t)m+k(αtqm/β)k(γq/β)k

(q)k(αtqm+1/β)k(αt/β)m+k

∞

∞

Xk=0
Xk=0

k

m

Xp=0
Xp=1

(αt/β)p

,

q(cid:19)p
(t)p (cid:18) β
q(cid:19)k+p
(t)k+p (cid:18) β

(αt/β)k+p

.

(3.15)

∞

∞

∞

Xm=0
Xm=0
Xp=0
Xp=0

∞

V4 =

=

=

=

=

(f /ǫ)m(t)m(ǫq/β)m

(q)m(αt/β)m+1

(f /ǫ)m(t)m(ǫq/β)m

(q)m(αt/β)m+1

∞

∞

Xp=0
Xp=0

(αt/β)p

(t)p (cid:18) β

q(cid:19)p ∞
Xk=p

(δ/γ)k(tqm)k

β (cid:19)k
(q)k(αtqm+1/β)k (cid:18) γq

(αt/β)p(δ/γ)p(tqm)pγp
(t)p(αtqm+1/β)p(q)p

(δqp/γ)k(tqm+p)k(γq/β)k
(qp+1)k(αtqm+p+1/β)k

∞

Xk=0

(δ/γ)pγp

(q)p

(δ/γ)pγp

(q)p

∞

∞

Xm=0
Xk=0

(f q/β)∞(t)∞

(αt/β)∞(ǫq/β)∞

(f /ǫ)m(tqp)m

(δqp/γ)k(tqp)k

β (cid:19)m ∞
(q)m(αtqp/β)m+1 (cid:18) ǫq
Xk=0
β (cid:19)k ∞
(qp+1)k(αtqp/β)k+1 (cid:18) γq
Xm=0
Xk=0
Xp=0

(δ/γ)p(αt/β)pγp

(t)p(q)p

∞

∞

(δqp/γ)k(tqm+p)k(γq/β)k
(qp+1)k(αtqm+p+1/β)k

(f /ǫ)m(tqp+k)m

β (cid:19)m
(q)m(αtqp+k+1/β)m (cid:18) ǫq

(δqp/γ)k(qγ/β)k

(q1+p)k

2φ1(cid:18)αq/b,

ǫq/β
f q/β

; q, tqk+p(cid:19),

(3.16)

where in the last step, we used (2.2) to transform the innermost series. Lastly, V5 can be simpliﬁed to

9

V5 =

=

=

(δ/γ)kγk

(q)k

(δ/γ)kγk

(q)k

(f /ǫ)pǫp

(q)p

∞

∞

Xk=0
Xk=0
Xp=1

∞

m

∞

∞

(αtqk/β)p

(f /ǫ)m(tqk)m(ǫq/β)m

(q)m(αtqk/β)m+1

(αtqk/β)p

q(cid:19)p
(tqk)p (cid:18) β

Xp=1
q(cid:19)p ∞
(tqk)p (cid:18) β
(q)m+p(αtqk/β)m+p+1 (cid:18) ǫq
Xm=0
β (cid:19)m
(q1+p)m(αtqp+k/β)m+1 (cid:18) ǫq
Xm=0

(f /ǫ)m+p(tqk)m+p

(f qp/ǫ)m(tqp+k)m

(q)k

(δ/γ)kγk

Xm=1
Xp=1
Xk=0

∞

∞

.

β (cid:19)m+p

(3.17)

Now (3.4), (3.7), (3.9), (3.11), (3.14), (3.16) and (3.17) give (3.13). This completes the proof.

(cid:3)

Remarks. 1. Agarwal’s identity (3.2) can be obtained from (3.13) by letting ǫ = f = 0 in (3.13),
and then applying (2.2) to each of the 3φ2’s and to the 2φ1 in the third expression on the right side.

2. The fact that the identity [1, Equation (4.5)]

∞

Xn=0

(α)n
(β)n

tn =

(β/α, q, αt, q/(αt); q)∞
(q/α, β, t, β/(αt); q)∞

+

(1 − (q/β))
(1 − (αt/β)) 2φ1(q, q/t; qβ/(αt); q, q/α)

(3.18)

was used in the proof of (3.2) (see [2, p. 294]), and (3.2) was used in the proof of (3.13) given above

suggests that a generalization of (3.2) for the series P∞

We now prove Theorem 1.2 from Theorem 1.1.

n=0

Lemma 3.2. If m is a positive integer, we have

(a1,a2,a3,··· ,ar;q)n
(b1,b2,b3,··· ,br ;q)n

tn is not inconceivable.

m

Xj=0"m

j# (−a)j(−a)m−j(−1)j =


Proof. We note that

(q; q2)n(a2; q2)n,

if m = 2n,

0,

if m is odd.

(3.19)

m

Xj=0"m

j# (−a)j(−a)m−j(−1)j = (−a)m
=


0,

by [4, p. 526, Equation (1.7)].

m

Xj=0

(q−m)j(−a)j(q/a)j
(q)j(−a−1q1−m)j

(q; q2)n(a2; q2)n,

if m is odd,

if m = 2n,

(cid:3)

Remark. Ismail and Zhang [24, Lemma 4.1] have obtained several interesting results of the similar
type as Lemma 3.2.
Proof of Theorem 1.2. Let β = −q2, γ = iq3/2, δ = q3/2, ǫ = −iq3/2, f = −q3/2, t = q in Theorem
1.1, and then let α → q. Note that the second expression on the right side of (1.4) vanishes. Hence

∞

1

1

=

qn(−q3; q2)n(q; q)n
Xn=0
(q3; q2)n(−q2; q)n
q(cid:19) (q; q)2
2(cid:18)1 −
(−q; q)2
(−q3; q2)∞
(q3; q2)∞ (cid:18)1 +

+

∞

∞

qn

∞

Xn=0
q(cid:19) ∞
Xn=0

(−1; q)n(−q; q2)n
(q; q2)n(q; q)n
(−i√q)n
(−1)n+1

Xp=0

1

n

(−1)p(−q)p

(q)p

n

Xm=0" n

m# (−i)m(−i)n−m(−1)m

10

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

=

1

2(cid:18)1 −

+

1
2q

1

∞

q(cid:19) (q; q)2
(−q; q)2
(−q; q2)∞
Xn=0
(q3; q2)∞

∞

∞

∞

(−1; q)n(−q; q2)n
(q; q2)n(q; q)n

Xn=0
(q; q2)n(−1; q2)n(−q)n

(−q)2n

qn

2n

Xp=0

(−1)p(−q)p

(q)p

,

(3.20)

where in the last step, we applied Lemma 3.19 with a = i. This proves (1.6) upon observing that

p2n(−1; q−2n−1,−1 : q) =

(−1)p(−q)p

(q)p

,

2n

Xp=0

which follows from (1.5). Now (1.2) and (1.6) imply (1.7).

Next Theorem 1.3 is proven.

Proof of Theorem 1.3. Let

∞

1

S1(q) :=

qn(−q3; q2)n(q)n
Xn=0
(q3; q2)n(−q2)n
q(cid:19) (q)2
2(cid:18)1 −
S2(q) := −
(−q)2
q(cid:19) (q)2
2(cid:18)1 −
(−q)2

S3(q) := −

∞

∞

∞

∞

1

1

1

,

,

(−1)n(−q; q2)n
(q; q2)n(q)n

qn.

∞

Xn=1

By (1.6), proving (1.8) is equivalent to showing

S1(q) + S2(q) + S3(q) ≡

1
2q −

1
2

(mod 4).

Note that (q)2

∞ ≡ (−q)2

∞ (mod 4). Hence

∞

S1(q) + S3(q) ≡ S1(q) +

(mod 4)

(−q)n−1(−q; q2)nqn−1

(q3; q2)n−1(q)n
(−q)n(−q; q2)n+1qn

(q3; q2)n(q)n+1

∞

Xn=1
Xn=0
qn(−q; q2)n+1(q)n
(q3; q2)n(−q)n+1
(−q; q2)n+1qn

+

+

(q3; q2)n

Xn=0
(cid:18) (q)n
(q)n+1(cid:19)
(−q)n
(−q)n+1
(−q; q2)n+1qn
(cid:0)(q)2
n(1 − qn+1) + (−q)2
(q2; q)2n+1
(−q; q2)n+1(q)2
(q2; q)2n+1

(mod 4),

nqn

= S1(q) +

∞

∞

∞

=

=

Xn=0
Xn=0
Xn=0
Xn=0
≡ 2

=

∞

∞

(−q)n(−q; q2)n+1qn

(q3; q2)n(q)n+1

n(1 + qn+1)(cid:1)

since (q)2

n ≡ (−q)2

n (mod 4). Now

S2(q) = −

1

2(cid:18)1 −

1

q(cid:19) 1 + 2

∞

(−1)nqn2!2
Xn=1

(3.21)

(cid:3)

(3.22)

(3.23)

(3.24)

=

1
2q −

1
2

+

2
q

(1 − q)


∞

(−1)nqn2

Xn=1

(−1)nqn2!2
+  ∞
Xn=1
 .

From (3.24) and (3.25), it suﬃces to show that

2

∞

Xn=0

(−q; q2)n+1(q)2
(q2; q)2n+1

∞

2
q

nqn

Xn=1

≡ −

(1 − q)

(q2; q2)n+1(q3; q2)n ≡ −
Xn=1


(q3; q2)n(q2; q2)nqn+1

∞

or equivalently,

∞

Xn=0

Now

(−1)nqn2

(−1)nqn2

(−1)nqn2!2
+  ∞
Xn=1

 (mod 4),

(−1)nqn2!2
+  ∞
Xn=1

 (mod 2).

(q3; q2)n(q2; q2)nqn+1
(q2; q2)n+1(q3; q2)n

∞

Xn=0

qn+1

1 − q2n+2
do(N )qN ,

=

=

∞

∞

Xn=0
XN =1

where do(N ) is the number of odd divisors of N . Also,

11

(3.25)

(3.26)

(3.27)

(3.28)

∞

−
Xn=1


(−1)nqn2

Let

qn2

∞

Xn=1

(−1)nqn2!2
+  ∞
Xn=1
 ≡
+  ∞
Xn=1

a(N )qN :=

XN =1

Xn=1

qn2

∞

∞

+  ∞
Xn=1
qn2!2

.

qn2!2

(mod 2).

(3.29)

(3.30)

Let r2(m) denote the number of representations of m as a sum of two squares, where representations
with diﬀerent orders or diﬀerent signs of the summands are regarded as distinct. Now if N is not a
square, then the number of representations of N as a sum of 2 positive squares is equal to

1

4 r2(N ) = d1(N ) − d3(N ) ≡ do(N ) (mod 2),

(3.31)

where Jacobi’s formula was employed in the penultimate step. That is, a(N ) ≡ do(N ) (mod 2). If,
however, N is a square, then the number of representations of N as a sum of 2 positive squares is
equal to 1

4 r2(n) − 1. Hence,

a(N ) =

1
4

r2(N ) = d1(N ) − d3(N ) ≡ do(N ) (mod 2).

This implies that (3.27) always holds, and this proves the theorem.

This section is devoted to proving Theorem 1.4. We start with the following series S(q):

4. Congruences for pω(n)

S(q) :=

∞

Xn=1

qn(qn+1; q)n(q2n+2; q2)∞

(1 + qn)(−qn+1; q)n(−q2n+2; q2)∞

.

(3.32)

(cid:3)

(4.1)

12

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Lemma 4.1. The following identity holds:

S(q) = −

∞

(−1)nq2n2

Xn=1

+

∞

Xk=1

qk(q; q2)k

(−q; q2)k(1 + q2k)

.

(4.2)

Proof.

∞

S(q) =

q(2n+1)k

q(2k+1)n

∞

∞

qn(qn+1; q)n(q2n+2; q2)∞

(q; q)n

∞

∞

∞

∞

=

=

=

=

(q; q)n(q2n+1; q2)∞

(−1; q2)k
(q2; q2)k

qn(−q; q)n−1

qn(−q; q)n−1(−q2n+1; q2)∞

Xn=1
(1 + qn)(−qn+1; q)n(−q2n+2; q2)∞
(q; q)∞
Xn=1
(−q; q)∞
(q; q)∞
Xn=1
Xk=0
(q; q)n
(−q; q)∞
qk(−1; q2)k
(−q; q)n−1
(q; q)∞
Xk=0
Xn=1
(q2; q2)k
(−q; q)∞
(q2; q2)k  −
qk(−1; q2)k
(q; q)∞
Xk=0
(−q; q)∞
qk(−1; q2)k
(q; q)∞
Xk=0
(q2; q2)k
2(−q; q)∞
(−q; q2)∞
(q; q)∞
(q; q2)∞
2(−q; q)∞
(q2; q2)∞
2(−q2; q2)∞
1
2 −

(q; q)∞
2(−q; q)∞
qk(−1; q2)k
(q2; q2)k

Xn=0
(q; q)∞
2(−q; q)∞
Xk=0
(q; q)2k
(−q; q)2k
qk(q; q2)k

+

Xk=0
(−1)nq2n2

+

= −

1
2

+

1
2

1
2

+

= −

= −

= −

∞

1
2

+

+

∞

∞

Xn=1

∞

Xk=1

(−q; q2)k(1 + q2k)

,

q(2k+1)n!
qk(−1; q2)k
Xn=0
(q2; q2)k

∞

∞

(−1; q)n
(q; q)n

∞

Xk=0
qk(−1; q2)k
(q2; q2)k

∞

(−q2k+1; q)∞
(q2k+1; q)∞

(−1; q)n
(q; q)n

q(2k+1)n

where (2.1) was used for the third and seventh equalities.

Let

Lemma 4.2. we have

A(q) :=

∞

Xk=1

qk(q; q2)k

(−q; q2)k(1 + q2k)

.

A(q) + A(−q) = −

1
2

+

1
2

(q2, q2; q2)∞
(−q2,−q2; q2)∞

.

(cid:3)

(4.3)

Proof. We now extend the sum in (4.3) to negative inﬁnity:

∞

Xk=−∞

qk(q; q2)k

(−q; q2)k(1 + q2k)

=

1
2

+

∞

Xk=1

qk(q; q2)k

(−q; q2)k(1 + q2k)

+

∞

Xk=1

(−1)kqk(−q; q2)k
(q; q2)k(1 + q2k)

,

(4.4)

where (a; q)n := (a; q)∞/(aqn; q)∞. Thus

∞

Xk=−∞

qk(q; q2)k

(−q; q2)k(1 + q2k)

=

1
2

+ A(q) + A(−q).

(4.5)

Set q → q2, a = −1, c = q, d = 1, e = q, and f = −1 in (2.4). Then we obtain
qk(q; q2)k(−1; q2)k
(−q; q2)k(−q2; q2)k

(−q; q2)k(1 + q2k)

qk(q; q2)k

1
2

=

∞

∞

Xk=−∞

Xk=−∞
(q, q2,−q, q2; q2)∞
(−q2,−q2,−q, q; q2)∞
(q2, q2; q2)∞
(−q2,−q2; q2)∞

,

=

=

1
2

1
2

which with (4.5) completes the proof.

Lemma 4.3. We have

1

2(cid:18)A(q) − A(−q)(cid:19) ≡ q

(q8; q8)4
∞
(q4; q4)2
∞

(mod 4).

Proof. First note that using Alladi’s identity [3, p. 215] we obtain

13

(cid:3)

(4.6)

Thus

∞

A(q) =

=

≡

∞

Xk=1
Xk=1
Xk=1

∞

(q; q2)k
(−q; q2)k

= 1 − 2

k

Xj=1

q2j−1(q; q2)j−1

(−q; q2)j

.

qk(q; q2)k

∞

qk

1 + q2k − 2

(−q; q2)k(1 + q2k)
Xk=1
Xk=1

1 + q2k + 2

qk

∞

qk

qk

1 + q2k

1 + q2k

q2j−1(q; q2)j−1

(−q; q2)j
q2j−1

1 + q2j−1

(mod 4).

(4.7)

k

Xj=1
Xj=1

k

Now

qk

1 + q2k

∞

Xk=1

k

Xj=1

q2j−1

1 + q2j−1 =

(mod 2)

(4.8)

1 + q2k

qk

qk

1 + q2k

1 + q2k

qk

qk

1 + q2k

∞

∞

∞

=

Xk=1
Xk=1
Xk=1
= −
Xk=1
= −
Xk,m=1
Xk=1

≡

≡

∞

∞

∞

k

∞

k

∞

∞

k−1

(−1)m−1q(2j−1)m

(−1)m−1q(2j−1)m

q2mj

Xj=1
Xm=1
Xm=1
Xj=1
Xm=1
Xj=0
(−q)m
(−q)m (1 − q2km)
Xm=1
1 − q2m
Xk,m=1
q2k2+2k
(1 − q2k)2

qk+m

+

∞

∞

∞

Xk=1

(1 + q2k)(1 + q2m)

(1 + q2k)(1 + q2m)

q2km+k+m

q2k

(1 − q2k)2 +

(mod 2),

14

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

where the last congruence follows since each of the double summations is symmetric in k and m. Thus,
by (4.7) and (4.8)

A(q) ≡

≡

∞

∞

Xk=1
Xk=1

∞

qk

∞

q2k

1 + q2k + 2

Xk=1
Xk=1
1 − q4k + 2
Xk=1
Xk=1
1 + q4k + 2
1 + q4k−2 +

q2k−1

q2k

∞

∞

q2k(k+1)
1 − q4k
q2k
1 − q4k + 2

(mod 4)

∞

Xk=1

q2k(k+1)
1 − q4k

(mod 4).

Since the odd powers of q appear only in the ﬁrst sum on the right hand side above, we see that

1

2(cid:18)A(q) − A(−q)(cid:19) ≡

∞

Xk=1

q2k−1

1 + q4k−2

(mod 4)

= q

(q8; q8)4
∞
(q4; q4)2
∞

,

where the last equality follows from (32.26) in [18]. It can also be derived by letting q → q4, and then
substituting a = −q−2, b = −q2, z = q2 in Ramanujan’s 1ψ1 summation formula [21, p.239, (II 29)]

∞

Xn=−∞

(a; q)n
(b; q)n

zn =

(az; q)∞(q/(az); q)∞(q; q)∞(b/a; q)∞
(z; q)∞(b/(az); q)∞(b; q)∞(q/a; q)∞

,

valid for |b/a| < |z| < 1 and |q| < 1.
By Lemmas 4.2 and 4.3, we have

A(q) ≡ −

1
4

+

1
4

(q2; q2)2
∞
(−q2; q2)2

∞

+ q

(q8; q8)4
∞
(q4; q4)2
∞

(mod 4).

Also, we recall that

φ(−q) :=

ψ(q) :=

Thus,

(−1)nqn2

qn(n+1)/2 =

∞

∞

Xn=−∞
Xn=0

= (q; q)∞(q; q2)∞ =

(q; q)∞
(−q; q)∞

,

(q2; q2)∞
(q; q2)∞

=

(q2; q2)2
∞
(q; q)∞

.

(4.9)

(cid:3)

(4.10)

(4.11)

A(q) ≡ −

1
4

+

1
4

∞

Xm,n=−∞

(−1)m+nq2(m2+n2) + q

∞

Xm,n=0

We are now ready to prove Theorem 1.4. First, note that

q2m(m+1)+2n(n+1)

(mod 4).

(4.12)

1 + x

1 − x ≡

1 − x
1 + x

(mod 4).

(4.13)

∞

Xn=1

pω(n)qn ≡

∞

Xn=1

qn(qn+1; q)n(q2n+2; q2)∞

(1 − qn)(−qn+1; q)n(−q2n+2; q2)∞

(mod 4).

(4.14)

Thus from (1.1),

Now

∞

qn(qn+1; q)n(q2n+2; q2)∞

Xn=1
(1 − qn)(−qn+1; q)n(−q2n+2; q2)∞
qn(qn+1; q)n(q2n+2; q2)∞
Xn=1

(1 + qn)(−qn+1; q)n(−q2n+2; q2)∞

=

∞

+ 2

∞

Xn=1

q2n(qn+1; q)n(q2n+2; q2)∞

(1 − q2n)(−qn+1; q)n(−q2n+2; q2)∞

≡

≡

∞

∞

Xn=1
Xn=1

qn(qn+1; q)n(q2n+2; q2)∞

(1 + qn)(−qn+1; q)n(−q2n+2; q2)∞

qn(qn+1; q)n(q2n+2; q2)∞

(1 + qn)(−qn+1; q)n(−q2n+2; q2)∞

q2n
1 − q2n
q2n2

,

+ 2

+ 2

∞

∞

Xn=1
Xn=1

(mod 4)

where the second last congruence follows from the fact that

For the last congruence above, we used Clausen’s identity [18, p. 16, Equation (14.51)]

1 + x ≡ 1 − x (mod 2).

which implies that

∞

Xn=1

∞

Xn=1

d(n)qn =

∞

Xn=1(cid:18) 1 + qn

1 − qn(cid:19) qn2

,

qn

1 − qn ≡

∞

Xn=1

qn2

(mod 2).

Thus, from (4.1), (4.14) and (4.15), we have

Theorem 4.4. We have

pω(n)qn ≡ S(q) + 2

∞

Xn=1

q2n2

(mod 4).

∞

Xn=1

∞

15

(4.15)

(4.16)

(4.17)

(4.18)

∞

Xn=1

pω(n)qn ≡ −1 +

(−1)m+nq2(m2+n2) + q

Xm,n=0

q2m(m+1)+2n(n+1)

(mod 4).

(4.19)

∞

Xm,n=0

Proof. The congruence follows from (4.2), (4.3), (4.12), and (4.18).

(cid:3)

Thus it immediately follows from Theorem 4.4 that pω(4n + 3) ≡ 0 (mod 4). Since 8n + 6 = 2(4n + 3)
and 4n + 3 cannot be written as a sum of two squares, this also proves pω(8n + 6) ≡ 0 (mod 4).

5. Different representations of the generating function of sptω(n)

As in [20], deﬁne

spt(n)qn =

∞

Xn=1

∞

Xn=1

qn(−qn+1; q)∞

(1 − qn)2(qn+1; q)∞

.

Here we note that this spt(n) is exactly a half of the smallest parts function for overpartitions of n
deﬁned by Bringmann, Lovejoy, and Osburn in [14]. By taking d = 1 and e = 0 in Equations (1.1),
(1.2), and Theorem 7.1. in [15], we see that

spt(n)qn =

∞

Xn=1

∞

Xn=1

qn(−qn+1; q)∞

(1 − qn)2(qn+1; q)∞

=

(−q; q)∞
(q; q)∞

∞

Xn=1

nqn

1 − qn + 2

(−q; q)∞
(q; q)∞

∞

Xn=1

(−1)nqn2+n
(1 − qn)2 . (5.1)

We also deﬁne

spt2(n)qn =

∞

Xn=1

∞

Xn=1

q2n(−q2n+1; q)∞

(1 − q2n)2(q2n+1; q)∞

.

16

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Then, again by taking d = 1, e = q−1 and replacing q by q2 in Equations (1.1), (1.2), and Theorem
7.1. in [15], we have

spt2(n)qn =

∞

Xn=1

∞

Xn=1

q2n(−q2n+1; q)∞

(1 − q2n)2(q2n+1; q)∞

=

(−q; q)∞
(q; q)∞

∞

Xn=1

nqn

1 − qn +

(−q; q)∞
(q; q)∞

∞

Xn=1

(−1)nqn(1 + qn2

)

.

(1 − qn)2

(5.2)

Theorem 5.1. We have

sptω(n)qn =

(−q2; q2)∞
(q2; q2)∞

∞

Xn=1

Proof.

In (2.3), we set a = 1, p1 = z = p−1

∞

∞

nqn

(−q2; q2)∞
(q2; q2)∞

1 − qn + 2

Xn=1
Xn=1
2 , and f = −1. Then we obtain

(−1)nq2n(n+1)
(1 − q2n)2

.

(5.3)

∞

Xn=0

(z; q)n(z−1; q)n(−q; q2)nqn

(q; q)n(q; q2)n(−q; q)n

=

(zq; q)∞(z−1q; q)∞

(q; q)2
∞

 1 + 2

∞

Xn=1

(1 − z)(1 − z−1)(−1)nq2n(n+1)

(1 − zq2n)(1 − z−1q2n)

! .

(5.4)

Now take the second derivative on both sides of (5.4) with respect to z, then set z = 1 to obtain

∞

Xn=1

qn(q; q)n(−q; q2)n

(1 − qn)2(−q; q)n(q; q2)n

=

∞

Xn=1

nqn

1 − qn + 2

∞

Xn=1

(−1)nq2n(n+1)
(1 − q2n)2

.

Multiply both sides of the above identity by (−q2; q2)∞/(q2; q2)∞ to get
(−q2; q2)∞
1 − qn + 2
(q2; q2)∞

(1 − qn)2(−q; q)n(q; q2)n

qn(q; q)n(−q; q2)n

(−q2; q2)∞
(q2; q2)∞

nqn

=

∞

∞

(−q2; q2)∞
(q2; q2)∞

Xn=1

Xn=1

∞

Xn=1

(−1)nq2n(n+1)
(1 − q2n)2

.

(5.5)

Note that the left hand side of (5.5) is
qn(q; q)n(−q; q2)n

∞

(−q2; q2)∞
(q2; q2)∞

(1 − qn)2(−q; q)n(q; q2)n

Xn=1

=

=

=

=

(−q2; q2)∞
(q2; q2)∞
(−q2; q2)∞
(q2; q2)∞

∞

∞

Xn=1
Xn=1

qn(q; q)n(−q; q)2n(q2; q2)n

(1 − qn)2(−q; q)n(q; q)2n(−q2; q2)n

qn(−qn+1; q)n(q2; q2)n

(1 − qn)2(qn+1; q)n(−q2; q2)n

qn(−qn+1; q)n(−q2n+2; q2)∞
(1 − qn)2(qn+1; q)n(q2n+2; q2)∞
sptω(n)qn,

∞

∞

Xn=1
Xn=1

where the last equality follows from the deﬁnition of sptω(n) in (1.11). This completes the proof. (cid:3)

Lemma 5.2. We have

Proof. Note that

∞

Xn=1

(−1)nqn
(1 − qn)2 = −

∞

Xn=1

(2n − 1)q2n−1

1 − q2n−1

.

∞

Xn=1

(−1)nqn
(1 − qn)2 =

∞

Xn,k=1

(−1)nkqkn = −

kqk
1 + qk .

∞

Xk=1

Robbins [26, Theorem 3] has shown that this is the negative of the generating function for the sum of
the odd divisors of n which is the right-hand side of the identity we wanted to prove.
(cid:3)

17

(5.6)

We now relate our sptω(n) to spt(n) and spt2(n).

Corollary 5.3. We have

sptω(n)qn =

∞

Xn=1

=

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

∞

∞

nq2n

1 − q2n! +
(2n − 1)q2n−1
Xn=1
Xn=1
1 − q2n−1 +
1 − q4n−2 ! + 2
(2n − 1)q4n−2
(2n − 1)q2n−1
Xn=1
1 − q2n−1 + 2

∞

spt(n)q2n,

spt2(n)q2n.

(5.7)

∞

Xn=1

Proof. From (5.3),
∞

sptω(n)qn =

Xn=1

=

=

∞

∞

(−q2; q2)∞
Xn=1
(q2; q2)∞
(−q2; q2)∞
Xn=1
(q2; q2)∞
(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

(2n − 1)q2n−1
1 − q2n−1 +
(2n − 1)q2n−1
1 − q2n−1 +
(2n − 1)q2n−1
1 − q2n−1 +

(−q2; q2)∞
(q2; q2)∞
(−q2; q2)∞
(q2; q2)∞

∞

2nq2n

∞

∞

nq2n

Xn=1
Xn=1
1 − q2n! +

1 − q2n + 2
Xn=1
1 − q2n +
Xn=1

nq2n

∞

∞

Xn=1

spt(n)q2n,

(−q2; q2)∞
(q2; q2)∞

∞

Xn=1

(−1)nq2n(n+1)
(1 − q2n)2

spt(n)q2n

where the second last equality follows from (5.1). Also, by (5.2),

sptω(n)qn =

∞

Xn=1

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

(2n − 1)q2n−1
1 − q2n−1 − 2

∞

Xn=1

(1 − q2n)2! + 2
(−1)nq2n

∞

Xn=1

spt2(n)q2n,

(cid:3)

which with Lemma 5.2 yields (5.7).

6. Congruences for sptω(n)

The congruences satisﬁed by sptω(n), which are given in Theorem 1.5, are proved in this section.

6.1. Congruences modulo 3. We prove (1.15) and (1.16) here. Let

S(q) :=

Then, by (5.7),

cnqn =

∞

Xn=1

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

(2n − 1)q2n−1
1 − q2n−1 + 2

∞

Xn=1

1 − q4n−2 ! .
(2n − 1)q4n−2

sptω(n) = cn + 2spt2(cid:16) n
2(cid:17) ,

where we follow the convention that spt2(x) = 0 if x is not a positive integer.
By (1.12) and (1.13), it suﬃces to show that c3n ≡ c3n+2 ≡ 0 (mod 3). Now

(6.1)

(6.2)

∞

Xn=1

1 − q4n−2 ! (mod 3)
(2n − 1)q4n−2

S(q) ≡

∞

=

(2n − 1)q2n−1
1 − q2n−1 −

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(−q2; q2)∞
(2n − 1)q2n−1
Xn=1
(q2; q2)∞
(−q2; q2)∞
(q2; q2)∞
= q(−q2; q2)9
≡ q(−q6; q6)3

q(q4; q4)8
∞
(q2; q2)4
∞
∞(q2; q2)3
∞
∞(q6; q6)∞ (mod 3),

1 − q4n−2

=

where the third equality follows from [18, Equation (32.31)]. Hence c3n ≡ c3n+2 ≡ 0 (mod 3).

18

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

6.2. Another proof of (1.15). Let

M1(q) :=

dnqn =

∞

Xn=1

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

(2n − 1)q2n−1
1 − q2n−1 +

∞

Xn=1

nq2n

1 − q2n! .

Since [20, Thm. 1.2] implies spt(3n) ≡ 0 (mod 3), it suﬃces to show d3n ≡ 0 (mod 3) by (5.6). Now

∞

∞

Xn=1
Xn=1

nq2n

1 − q2n!
1 − q2n! (mod 3)

2nq2n

M1(q) =

≡

=

≡

(2n − 1)q2n−1
1 − q2n−1 +
(2n − 1)q2n−1
1 − q2n−1 −

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(−1)n−1nqn
(−q2; q2)∞
Xn=1
(q2; q2)∞
(−q2; q2)∞
Xn=1
(q2; q2)∞

χ(n)qn
1 − qn

1 − qn

(mod 3),

∞

∞

where χ(n) = 1 if n ≡ 1 or 2 (mod 6), is −1 if n ≡ 4 or 5 (mod 6), and is 0 if n ≡ 0 (mod 3). Thus,

M1(q) ≡

(−q2; q2)∞
(q2; q2)∞

where

∞

E1,2(n; 6)qn

(mod 3),

Xn=1

E1,2(n; 6) = Xd|n

d≡1,2 (mod 6)

1 − Xd|n

d≡−1,−2 (mod 6)

1.

By (4.10), we see that

∞

∞

φ(−q) =

(−1)nq9n2

Xn=−∞
− 2q
= φ(−q9) − 2qW (q3).

(−1)nq9n2+6n

Xn=−∞

Hence, by [18, p. 80, eq. (32.39)],

E1,2(n; 6)qn

(mod 3)

∞ (cid:19) (mod 3)

(q2; q2)∞(q3; q3)6
∞
(q; q)2
∞(q6; q6)3
φ(−q3)3
φ(−q) (cid:19)

M1(q) ≡

≡

=

∞

1

1

Xn=1
φ(−q2)
φ(−q2)(cid:18)1 −
φ(−q2)(cid:18)1 −
(φ(−q) − φ(−q9))
φ(−q2)φ(−q)

1

≡
= −2qW (q3)(−q; q)∞(−q2; q2)∞

(mod 3)

(q2; q2)∞(q; q)∞

= −2qW (q3)(q; q)∞(−q2; q2)∞

(q; q)3
∞

qW (q3)
(q3; q3)∞

≡

(q4; q4)∞(q; q2)∞ (mod 3)

∞

19

=

qW (q3)
(q3; q3)∞

(−1)nq2n2−n.

Xn=−∞

Now 2n2 − n is only congruent to 0 or 1 modulo 3. Hence this last expression has no non-zero
coeﬃcients for terms where q is a power of 3. Hence 3 | d3n.
6.3. Congruence modulo 6. The congruence in (1.18) can be reduced to (1.16). Using (4.16), we
see that

sptω(n)qn =

∞

Xn=1

≡

=

∞

∞

Xn=1
Xn=1
Xn=1

∞

qn(−qn+1; q)n(−q2n+2; q2)∞
(1 − qn)2(qn+1; q)n(q2n+2; q2)∞

(mod 2)

qn

(1 − qn)2
σ(n)qn,

(6.3)

where σ(n) denotes the sum of all positive divisors of n.

Now any number of the form 6n + 5 has all its prime divisors odd. The sum of the divisors of an
odd prime raised to an odd power is even. For any number congruent to 5 mod 6 there must be at
least one odd prime congruent to 5 mod 6 raised to an odd power in its prime factorization (otherwise
the number would be congruent to 1 mod 6). Since σ(n) is multiplicative, it follows that σ(6n + 5) is
even. Hence the coeﬃcients of q6n+5 in both series are all even.

6.4. Congruence modulo 5. The congruence (1.17) is proved here. Since spt2(5n + 3) ≡ 0 (mod 5),
using (6.2), it suﬃces to show that c10n+6 ≡ 0 (mod 5), where cn is deﬁned in (6.1). By (6.1),

S(q) =

=

=

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1

∞

∞

1 − q4n−2 !
(2n − 1)q4n−2
(2n − 1)q2n−1
Xn=1
1 − q2n−1 + 2
(2n − 1)q4n−2
(2n − 1)q2n−1
Xn=1
1 − q4n−2 + 2
1 − q4n−2 +
1 − q4n−2 !
(2n − 1)q4n−2
(2n − 1)q2n−1
Xn=1
1 − q4n−2 + 3

∞

=: qE1(q2) + 3E2(q2).

∞

Xn=1

1 − q4n−2 !
(2n − 1)q4n−2

Thus, it suﬃces to show that the coeﬃcient of q5n+3 in E2(q) is congruent to 0 mod 5, which follows
from the following lemma.

Lemma 6.1. Let

r(q) = q1/5 (q, q4; q5)∞
(q2, q3; q5)∞

,

and let E2(q) be deﬁned as above. Then,
∞(q10; q10)∞
∞(q5; q5)2

q(q; q)2
(q2, q3; q5)5

E2(q1/5) ≡

∞ (cid:18) r(q2)
r(q)2 +

1

r(q)2r(q2)

+

3
r(q)3 +

r(q2)

r(q)3(cid:19) (mod 5).

Proof. As in [22], set

A(q) = q1/5 (q, q4, q5; q5)∞

(q; q)3/5
∞

, B(q) =

(q2, q3, q5; q5)∞

(q; q)3/5
∞

.

20

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Although A(q)±1 and B(q)±1 do not have integer coeﬃcients, all of the series A(q)±5, B(q)±5, and
r(q)±1 have integer coeﬃcients. We will use the following properties:

r(q) =

A(q)
B(q)

,

A(q)B(q) = q1/5 (q5; q5)∞
(q; q)1/5
∞
2A(q)5 + B(q)5 ≡ 1 (mod 5),

,

A(q1/5)5 ≡

r(q)

1 + 2r(q)

(mod 5).

(6.4)

(6.5)

(6.6)

(6.7)

Identities (6.4) and (6.5) follow directly from the deﬁnitions of A(q) and B(q). By multiplying through
by (q; q)3

∞ and using (6.5), we see that (6.6) has the equivalent formulation

(q2, q3, q5; q5)5

∞ + 2q(q, q4, q5; q5)5

∞ ≡ (q; q)3

∞ (mod 5).

After applying Jacobi’s triple product identity [5, p. 21, Theorem 2.8] to each of the products on the
left hand side, applying the fact that the characteristic is 5, and using Jacobi’s identity [5, p. 176] on
the right side, we must show that

∞

(−1)nq

Xn=−∞

5n

2 (5n−1) + 2q

∞

(−1)nq

Xn=−∞

5n

2 (5n−3) ≡

∞

(2n + 1)(−1)nq

Xn=0

n

2 (n+1)

(mod 5),

which is easily seen to be true by breaking n into residue classes modulo 10 on the right hand side.
Next, from [22, Theorem 3.3], we have

A(q1/5)5 = A(q)5 − 3A(q)4B(q) + 4A(q)3B(q)2 − 2A(q)2B(q)3 + A(q)B(q)4,

so, by (6.4),

A(q1/5)5 = A(q)5 − 3A(q)4B(q) + 4A(q)3B(q)2 − 2A(q)2B(q)3 + A(q)B(q)4

= B(q)5r(q)(1 − 2r(q) + 4r(q)2 − 3r(q)3 + r(q)4)
≡ B(q)5r(q)(1 + 2r(q))4
≡

r(q)(1 + 2r(q))4

(mod 5)

(mod 5)

1 + 2r(q)5
r(q)

≡

1 + 2r(q)

(mod 5),

where (6.6) was used to obtain the penultimate equality. Thus, (6.7) is clear. We will also require the
two identities

(q1/5; q1/5)∞ = q1/5(q5; q5)∞(cid:18) 1



1 − qn ·

Xn=1

A(q)5 =

qn

5∤n

3,

1,

∞

r(q) − r(q) − 1(cid:19) ,

n ≡ 1

(mod 5)

−3, n ≡ 2

(mod 5)

n ≡ 3

(mod 5)

−1, n ≡ 4

(mod 5)

(6.8)

(6.9)

.

The ﬁrst identity can be found in [13, p. 270] and the second is the ﬁrst equality in [22, Lemma 2.4].
Let us save space by writing r = r(q) and R = r(q2). Now, by (6.9),

21

E2(q1/5) =

(−q1/5; q1/5)∞
(q1/5; q1/5)∞

∞

Xn=1
≡

(2n − 1)q(2n−1)/5
1 − q(2n−1)/5 =

(q2/5; q2/5)∞(q1/5; q1/5)3
∞

(q; q)∞

(q2/5; q2/5)∞
(q1/5; q1/5)2
∞

∞

∞

2nq2n/5

Xn=1(cid:18) nqn/5
1 − q2n/5(cid:19)
1 − qn/5 −
Xn=1(cid:18) nqn/5
1 − q2n/5(cid:19) (mod 5)
1 − qn/5 −
(cid:16)A(q1/5)5 − 2A(q2/5)5(cid:17) (mod 5).

2nq2n/5

(q2/5; q2/5)∞(q1/5; q1/5)3
∞

(q; q)∞

≡

By the dissection formulas (6.8) and (6.7),

E2(q1/5) ≡

≡

≡

=

≡

q(q5; q5)3

q(q5; q5)3

q(q5; q5)3

R − R − 1(cid:19)(cid:18) 1
(cid:18) 1

∞(q10; q10)∞
(q; q)∞
∞(q10; q10)∞
(q; q)∞
∞(q10; q10)∞(1 + 2r5)

(1 + 2R)2

R

(1 + 2R)2

(1 + 2r)6

r3

(q; q)∞

R

q(q5; q5)3

∞(q10; q10)∞(1 + 2r5)

(q; q)∞

q(q5; q5)3

∞(q10; q10)∞

(q; q)∞B(q)5

(cid:18) R
r2 +

(cid:18)−

1

4R
r2 +
3
r3 +

+

r2R

2R

1 + 2R(cid:19) (mod 5)

2R

1 + 2r

r − r − 1(cid:19)3(cid:18) r
1 + 2r −
1 + 2R(cid:19) (mod 5)
(cid:18) r
1 + 2r −
r3 (cid:18) r
1 + 2r −
r3 (cid:19)
1
2
r3 −
r2R −
r3(cid:19) (mod 5).
R

2R

4R

1 + 2R(cid:19) (mod 5)

This is the result as stated.

(cid:3)

Remark. In the proof of Theorem 6.4 in [10], it is written that

∞

Xn=0

(2n + 1)q2n+1

1 − q2n+1 = q

(q4; q4)8
∞
(q2; q2)4
∞

,

which is not correct. What the authors meant is

∞

Xn=0

(2n + 1)q2n+1

1 − q4n+2 = q

(q4; q4)8
∞
(q2; q2)4
∞

.

The proof can be easily ﬁxed as the congruence concerns the odd power terms only. However, using
the functions A(q), B(q) and r(q) from the proof of the lemma above, we can also correct the proof of
Theorem 6.4 in [10]. With the parameter k = r(q)r(q2)2, we have the parameterizations [9, Entry 24]

1 + k(cid:19)2
r(q)5 = k(cid:18) 1 − k

,

r(q2)5 = k2(cid:18) 1 − k
1 + k(cid:19) ,

and the dissection of the relevant q-series is found to be

1

(q1/5; q1/5)∞

∞

Xn=1

nqn/5

1 − qn/5 ≡

r(q2)B(q)5B(q2)5

q2/5(q10; q10)∞

(2 + k)3

(1 + k)2 (cid:0)4k + 2r(q)(1 + k) + r(q2)(cid:1)

(mod 5).

7. Congruences involving spt(n) and sptω(n)

This section is devoted to proving Theorems 1.6 and 1.7. We ﬁrst need the following lemmas.

22

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

Lemma 7.1. We have

∞

Xn=1

qn(n+1)/2

1 − qn =

∞

Xn=1

q2n−1

1 − q2n−1 .

Proof. This is proved in [25, p. 28].

Lemma 7.2. We have

∞

Xn=1

q2n−1

1 − q2n−1 ≡

∞

(qn2

Xn=1

+ q2n2

)

(mod 2).

Proof. We have

by (4.17).

∞

Xn=1

q2n−1

1 − q2n−1 =
≡

∞

∞

Xn=1
Xn=1

qn

1 − qn −
qn2
Xn=1

+

∞

∞

Xn=1

q2n
1 − q2n

q2n2

(mod 2),

7.1. Proof of Theorem 1.6. By (5.1) and (5.3), we know that

∞

Xn=1

spt(n)qn ≡

≡

≡

∞

∞

Xn=1
Xn=1
Xn=1

∞

sptω(n)qn

(mod 2)

(mod 2)

nqn
1 − qn
q2n−1
1 − q2n−1

Therefore, the congruences in (1.19) follow from (7.2).

7.2. Proof of Theorem 1.7. Let us introduce the series

Several identities satisﬁed by this series are

T (q) =

qn2

.

∞

Xn=1

(mod 2).

,

1 + 2T (−q) =

T (q) + T (q)2 =

∞

(q; q)∞
(−q; q)∞
Xn=0

(−1)nq2n+1
1 − q2n+1 ,

(7.1)

(cid:3)

(7.2)

(cid:3)

(7.3)

(7.4)

where the ﬁrst identity is a restatement of (4.10) and the second is [18, p. 59, Equation (26.63)]. By
applying (5.1), (7.1), (7.3), and (7.4) in the same sequence, we ﬁnd that

spt(n)qn =

∞

Xn=1

≡

(q; q)∞   ∞
(−q; q)∞
Xn=1
(q; q)∞   ∞
(−q; q)∞
Xn=0

∞

nqn

Xn=1
1 − qn + 2
(−1)nq2n+1
1 − q2n+1 + 2

(1 − qn)2 !
(−1)nqn2+n
Xn=0

q4n+2

∞

1 − q4n+2 + 2

∞

Xn=1

qn(n+1)

1 − q2n! (mod 4)

(−1)nq2n+1
1 − q2n+1

≡

∞

(−q; q)∞
(q; q)∞

Xn=0
1 + 2T (−q)

1

(T (q) + T (q)2)

≡
≡ (1 + 2T (q))(T (q) + T (q)2)
≡ 2T (q)3 + 3T (q)2 + T (q)

(mod 4).

23

(mod 4)

(mod 4)

(mod 4)

Next, set

∞

q(7n+0)2/7 = T (q7),

q(7n+1)2/7,

t =

a =

∞

Xn=1
Xn=−∞

and note that T (q1/7) = t + a + b + c. Therefore,

b =

c =

∞

∞

Xn=−∞
Xn=−∞

q(7n+2)2/7,

q(7n+3)2/7,

∞

Xn=1

spt(n)qn/7 ≡ 2T (q1/7)3 + 3T (q1/7)2 + T (q1/7)

(mod 4)

= 12abc + 2t3 + 3t2 + t

+ 6at2 + 6at + a + 6b2t + 3b2 + 6bc2

+ 6a2t + 3a2 + 6ab2 + 6ct2 + 6ct + c

+ 2a3 + 12act + 6ac + 6b2c

+ 6a2c + 6bt2 + 6bt + b + 6c2t + 3c2

+ 12abt + 6ab + 6ac2 + 2b3

+ 6a2b + 12bct + 6bc + 2c3,

where the terms in the expansion have been collected according to the residue classes modulo 1 of the
exponents on q. Taking the terms involving only integral powers of q gives

∞

Xn=1

spt(7n)qn ≡ 12abc + 2t3 + 3t2 + t
(mod 4)

(mod 4)

∞

≡ 2t3 + 3t2 + t
Xn=1
spt(n)q7n
≡

(mod 4).

This proves the congruence (1.20). Similarly, by (5.3),

sptω(n)qn =

∞

Xn=1

∞

∞

∞

≡

nqn

Xn=1
1 − qn + 2
(−1)nq2n+1
1 − q2n+1 + 2

(1 − q2n)2 !
(−1)nq2n(n+1)
1 − q4n+2 + 2  ∞
(−1)nq4n+2
Xn=0
Xn=1

(q2; q2)∞   ∞
(−q2; q2)∞
Xn=1
(q2; q2)∞ 
(−q2; q2)∞
Xn=0

1 + 2T (−q2)(cid:0)T (q) + T (q)2 + 2T (q2) + 2T (q2)2 + 2(T (q) + T (q)2)4(cid:1)
≡ (1 + 2T (q)2)(T (q) + 3T (q)2 + 2T (q)8)
≡ 2T (q)8 + 2T (q)4 + 2T (q)3 + 3T (q)2 + T (q)

(mod 4).

(mod 4)

=

1

qn(n+1)/2

1 − qn !4

 (mod 4)

(mod 4)

24

GEORGE E. ANDREWS, ATUL DIXIT, DANIEL SCHULTZ, AND AE JA YEE

This polynomial in T (q) may be dissected in the same fashion, and we ﬁnd that

∞

Xn=1

sptω(7n)qn ≡ 2t8 + 2t4 + 2t3 + 3t2 + t

(mod 4)

≡

∞

Xn=1

sptω(n)q7n

(mod 4),

which proves the congruence (1.21).

8. Concluding remarks and some open problems

In concluding, we remark that the study involving the partition function pω(n) and its associated
smallest parts function sptω(n) is more diﬃcult than the one involving pω(n) and sptω(n). Nonethe-
less, these functions are as interesting as their aforementioned counterparts. This certainly merits
further study of these functions. In particular, we give two open problems below.

Problem 1. Is the generating function of pω(n) representable in terms of some more important
functions, say for example, mock theta functions or more generally, mock modular forms or mixed
mock modular forms? Is it possible to further simplify the series involving the little q-Jacobi polyno-
mials in Theorem 1.2?

We were able to obtain another proof of the mod 4 congruences in Theorem 1.4 assuming the

conjecture that the function Y (q) deﬁned by

Y (q) := Xn,m≥1

(−1)mq2nm+m

(1 + qn)(1 − q2m−1)

(8.1)

is an odd function of q. Some coeﬃcients in the expansion of Y (q) are

Y (q) = −q3 − 2q5 − 3q7 − 5q9 − 4q11 − 7q13 − 9q15 − ··· − 53q91 − 62q93 − 38q95 − 55q97 − ··· .

Unfortunately we are unable to prove that indeed it is an odd function, hence we state it below as
another open problem.

Problem 2. Prove that the function Y (q) deﬁned in (8.1) is an odd function of q.

The fourth author was partially supported by a grant (#280903) from the Simons Foundation.

Acknowledgements

References

[1] R.P. Agarwal, A family of basic hypergeometric and combinatorial identities and certain summation formulae,

Indian J. Pure Appl. Math. 12 (1981), 728–737.

[2] R.P. Agarwal, On the paper “A ‘Lost’ Notebook of Ramanujan”, Adv. Math. 53 (1984), 291–300.
[3] K. Alladi, Variants of classical q-hypergeometric identities and partition implications, Ramanujan J. 31 Issues 1-2

(2013), 213–238.

[4] G.E. Andrews, On the q-analog of Kummer’s theorem and applications, Duke Math. J. 40 (1973), 525–528.
[5] G.E. Andrews, The theory of partitions, Addison-Wesley Pub. Co., NY, 300 pp. (1976). Reissued, Cambridge

University Press, New York, 1998.

[6] G.E. Andrews, Ramanujan’s “Lost” notebook: I. Partial theta functions, Adv. Math. 41 (1981), 137–172.

25

[7] G.E. Andrews, Ramanujan’s “Lost” Notebook IV. Stacks and Alternating Parity in Partitions, Adv. Math. 53

(1984), 55–74.

[8] G.E. Andrews and R.A. Askey, Enumeration of partitions: The role of Eulerian series and q-orthogonal polyno-

mials, Higher Combinatorics, M. Aigner, ed., Reidell Publ. Co., Dordrecht, Holland, pp. 3-26 (1977).

[9] G.E. Andrews, B.C. Berndt, L. Jacobsen, and R.L. Lamphere, The continued fractions found in the unorganized

portions of Ramanujan’s notebooks, Memoir No. 477, Amer. Math. Soc. 99 (1992).

[10] G.E. Andrews, A. Dixit and A.J. Yee, Partitions associated with the Ramanujan/Watson mock theta functions

ω(q), ν(q) and φ(q), Research in Number Theory, 1 Issue 1 (2015), 1–25.

[11] W.N. Bailey, Identities of the Rogers-Ramanujan type, Proc. London Math. Soc. 50 No. 2 (1949), 1–10.
[12] J. Berg, A. Castillo, R. Grizzard, V. Kala, R. Moy and C. Wang, Congruences for Ramanujan’s f and ω functions

via generalized Borcherds products, Ramanujan J. 35 (2014), 327–338.

[13] B. C. Berndt, Ramanujan’s Notebooks, Part III, Springer-Verlag, New York, 1991.
[14] K. Bringmann, J. Lovejoy, and R. Osburn, Rank and crank moments for overpartitions, J. Number Theory, 129

(2009), 1758–1772.

[15] K. Bringmann, J. Lovejoy, and R. Osburn, Automorphic properties of generating functions for generalized rank

moments and Durfee symbols, IMRN 2010 No. 2, 238–260.

[16] J. Bruinier and K. Ono, Identities and congruences for Ramanujan’s ω(q), Ramanujan J. 23 (2010), 151–157.
[17] S. Corteel and J. Lovejoy, Overpartitions, Trans. Amer. Math. Soc. 356 No. 4 (2004), 1623–1635.

[18] N.J. Fine, Basic hypergeometric series and applications, Amer. Math. Soc., Providence, 1988.

[19] S.A. Garthwaite, The coeﬃcients of the ω(q) mock theta function, Int. J. Number Theory 4 No. 6 (2008), 1027–1042.
[20] F.G. Garvan and C. Jennings-Shaﬀer, The spt-crank for overpartitions, Acta Arithmetica, 166 (2014), 141–188.

[21] G. Gasper and M. Rahman, Basic Hypergeometric Series, 2nd ed., Cambridge University Press, Cambridge, 2004.
[22] T. Huber, A theory of theta functions to the quintic base, J. Number Theory, 134 (2014), 49–92.

[23] M.E.H. Ismail, Classical and Quantum Orthogonal Polynomials in One Variable, Cambridge University Press,

Cambridge, 2009.

[24] M.E.H. Ismail and R. Zhang, q-Bessel functions and Rogers-Ramanujan type identities, arXiv:1508.06861v1.

[25] P.A. Macmahon, Combinatory Analysis, Vol. II, Cambridge University Press, Cambridge, 1915-1916, reissued,

Chelsea, 1960.

[26] N. Robbins, On partition functions and divisor sums, J. Integer Sequences 5 (2002), Article 02.1.4.

[27] M. Waldherr, On certain explicit congruences for mock theta functions, Proc. Amer. Math. Soc. 139 No. 3 (2011),

865–879.

Department of Mathematics, The Pennsylvania State University, University Park, PA 16802, USA

E-mail address: gea1@psu.edu

Department of Mathematics, Indian Institute of Technology Gandhinagar, Near village Palaj, Gand-

hinagar, Gujarat 382355, India

E-mail address: adixit@iitgn.ac.in

Department of Mathematics, The Pennsylvania State University, University Park, PA 16802, USA

E-mail address: dps23@psu.edu

Department of Mathematics, The Pennsylvania State University, University Park, PA 16802, USA

E-mail address: auy2@psu.edu

