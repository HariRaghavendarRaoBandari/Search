6
1
0
2

 
r
a

M
3

 

 
 
]
T
G
.
s
c
[
 
 

2
v
2
6
5
0
0

.

3
0
6
1
:
v
i
X
r
a

Ironing the Border: Optimal Auctions for Negatively Correlated

Items

Pingzhong Tang

IIIS, Tsinghua University
kenshinping@gmail.com

Zihe Wang

IIIS, Tsinghua University
wzh5858588@163.com

March 4, 2016

Abstract

We consider the problem of designing revenue-optimal auctions for selling two items and bidders’
valuations are independent among bidders but negatively correlated among items. Abstractly, this setting
can be thought of as an instance with single-dimensional type space but multi-dimensional allocation
space. Such setting has been extensively studied in the literature, but all under the assumption that
the items are positively correlated. Under the positive correlation assumption, the optimal allocation
rules are simple, avoiding difﬁculties brought by ensuring Bayesian incentive compatibility (BIC) under
multi-dimensional feasibility constraints and by ensuring interim individual rationality (IIR) given the
possibility that the lowest utility point may no longer at the boundary of the type domain. However, the
nice properties no longer hold when there is negative correlation among items.

In this paper, we obtain the closed-form optimal auction for this setting, by directly addressing the
two difﬁculties above. In particular, the ﬁrst difﬁculty is that when pointwise maximizing virtual surplus
under multi-dimensional feasibility (i.e., the Border feasibility), (1) neither the optimal interim allocation
is trivially monotone in the virtual value, (2) nor the virtual value is monotone in the bidder’s type. As a
result, the optimal interim allocations resulting from virtual surplus maximization no longer guarantees
BIC. To address (1), we prove a generalization of Border’s theorem and show that optimal interim allo-
cation is indeed monotone in the virtual value. To address (2), we adapt Myerson’s ironing procedure to
this setting by redeﬁning the (ironed) virtual value as a function of the lowest utility point. The second
difﬁculty, perhaps a more challenging one, is that the lowest utility type in general is no longer at the
endpoints of the type interval. To address this difﬁculty, we show by construction that there exist an
allocation rule and an induced lowest utility type such that they form a solution of the virtual surplus
maximization and in the meanwhile guarantees IIR.

In the single bidder case, the optimal auction consists of a randomized bundle menu and a determin-
istic bundle menu; while in the multiple bidder case, the optimal auction is a randomization between
two extreme mechanisms. The optimal solutions of our setting can be implemented by a Bayesian IC
and IR auction, however, perhaps surprisingly, the revenue of this auction cannot be achieved by any
(dominant-strategy) IC and IR auction. In other words, we have witnessed the ﬁrst instance where a
Bayesian IC auction yields strictly more revenue than any DIC auction, resolving an important conjec-
ture concerning whether there exists a quasi-linear setting where the optimal revenues differ under the
two different solution concepts.

1 Introduction

We consider a setting where a revenue-maximizing monopolist has two items for sale. The bidders’ valua-
tions are bidder-wise independent but negatively correlated item-wise, concretely in the form of v1
i =

i + av2

1

b, where v1
constant.

i and v2

i are the private valuations of bidder i for the two items respectively and a, b are positive

We obtain in closed-form revenue-optimal auctions subject to Bayesian incentive compatibility (BIC)
and interim individual rationality (IIR) in this setting. For the case of a single bidder, the optimal auction
consists of two options: a randomized bundle (1/a fraction of the ﬁrst item together with the second item)
as well as a deterministic grand bundle. For the case of multiple i.i.d bidders, the optimal auction is a
randomization between two extreme allocations resulted from solving a relaxed seller’s problem. We show
that such allocation can be implemented by a BIC and (ex post) IR auction.

Perhaps surprisingly, the optimal revenue achieved by the auction above cannot be achieved by any DIC
and (ex post) IR auction. In other words, we have actually witnessed the ﬁrst setting, to our best knowledge,
where optimal revenues differ with respect to the two notions of IC, resolving a conjecture raised in a series
of important papers concerning revenue equivalence between Bayes Nash implementation and dominant
strategy implementation under quasi-linear utility [20, 11, 27]. Given the importance of this conjecture,
we provide an independent proof for the case where two bidders have i.i.d types both drawn from uniform
distribution on [0, 1].

To understand non-triviality of the problem and our technical contributions. Let us ﬁrst recall Myerson’s
approach for the single item case [Myerson 1981]. In Myerson’s analysis, an important intermediate step is
to show that the expected revenue equals the expected virtual surplus, minus the sum of bidders’ utilities in
their lowest types. By pointwise maximizing virtual surplus (i.e., give the item to the bidder with the highest
non-negative virtual value), one can obtain an allocation rule whose interim expectation (aka. allocation
in the reduced-form) [5, 4] is monotone in one’s virtual value. Together with the regularity assumption (or
the so-called ironing technique) that ensures the virtual value is further monotone in one’s type, one can
guarantee that the virtual surplus maximization allocation is monotone in bidder’s interim type. In other
words, the optimal allocation of the relaxed maximization problem (without considering IC and IR) satisﬁes
IC. Noticing that a bidder must attain his lowest utility at his lowest type, one can ﬁnd, for any allocation
rule, a payment rule (aka. payment identity) that guarantees zero utility for the lowest type agents. In other
words, IR is ensured for any allocation rule with its payment identity.

In our setting, there are a number of essential differences. The ﬁrst observation is that the lowest utility
point is not necessarily at the endpoints of the valuation interval. It is also not easy to claim there is a ﬁxed
zero point no matter what other bidders report. As a result, a clean payment rule cannot be derived from an
ex post type representation. This difﬁculty motivates us to adopt an interim representation of the revenue
formula, that is, to represent the revenue as a function of interim utility and interim allocation.

However, to accommodate interim allocation feasibility contraints in the problem formulation requires
the so-called Border’s theorem [Border 1992], a neat sufﬁcient and necessary condition that characterizes
exactly what set of interim allocation rule can actually be implemented by an auction (ex post allocation).
Introducing Border’s feasibility condition complicates the relaxed seller problem, i.e., the problem of choos-
ing a virtual surplus maximization interim allocation without considering BIC and IIR. It is no longer trivial
that the resulting allocation is monotone in virtual value, a key step in Myerson’s analysis that guarantees
BIC. Our ﬁrst technical contribution is to ensure this is indeed the case. In particular, we put forth a surplus-
maximization version of Border’s theorem, that (1) remains to be a sufﬁcient and necessary condition of the
implementability of an interim allocation rule; (2) ensures the optimal allocation rule resulted from virtual
surplus maximization (for any deﬁnition of virtual value function) subject to Border feasibility being mono-
tone in the virtual value. With this generalization, together with a properly generalized ironing procedure
(by deﬁning virtual value as a function of both the actual type as well as the lowest utility type), we ensure
that the allocation resulted from the relaxed seller’s problem is indeed monotone in bidder’s type.

2

A more challenging step is to guarantee IIR. Our strategy is to search through the set of allocations
from the previous step (the solutions that solves the relaxed seller’s problem and satisﬁes the conditions
sufﬁcient for the ironing procedure to guarantee optimal revenue) to ﬁnd an allocation rule that ensures IIR
and that the lowest utility is indeed zero. That is, this allocation rule achieves an allocation-independent
revenue upper bound set by the relaxed seller’s problem, while guarantees both BIC and IIR. In other words,
this is the optimal allocation we look for. This step is established by a characterization of the set of all
optimal allocation from the relaxed seller’s problem, a careful analysis of possible allocations, and extreme
allocations in particular, for the set of types that share the same virtual value and by establishing certain
continuity of the optimal allocation function.

1.1 Related work
Negatively correlated valuations are not uncommon in the literature. For example, consider an instance of
the well-known facility location game with two facilities [19]: agents are interested in services from the two
facilities, located at the endpoints of a street. Each agent’s type is his/her location on the street, between the
two facilities. The cost (negative utility) to either facility, the same as in [23], is simply one’s distance to
that facility, so his overall costs (as well as valuations) sum up to a constant — the length of the street.

As mentioned, there have been extensive studies on extending Myerson’s technique to settings with
multi-dimensional ﬂavor. [13, 1] consider the aforementioned positive correlation setting, but restricted to
the single bidder case and unit-demand valuations. In their setting, a bidder’s type is represented by his
valuation towards the more favored item and his valuation towards the less favored item is simple his type
multiplied a discount factor, private in [1] and public in [13]. To visualize, one can think of this type domain
as a ray from the origin on the two-dimensional plane. In [1], it is shown that the optimal mechanism is
simply to post a price for the higher valued item. Moreover, he shows that such price is independent from
the discount factor, allowing rays with different slopes to have a uniform optimal mechanism. Since one
can fully cover certain two dimensional distributions with such rays, the optimal posted price mechanism
is actually optimal for these two-dimensional distributions as well.
In [13], the above result on rays is
extended to curves satisfying certain monotone conditions. These conditions are derived by ﬁrst assuming
the optimality of the posted price mechanism and then inferring reversely under what type of distributions
is the posted price mechanism virtual-surplus-maximizing. Comparing to these works, negative correlation
adds additional difﬁculties in that the lowest utility point is not necessary at the boundary type. In addition,
comparing to [13] that focuses on a well-behaved subset of distributions, we deal with the multi-dimensional
feasibility directly without any assumption on the type distribution.

[17] considers a setting where the bidders valuations are positively correlated between the items and are
both weakly increasing with respect to a one-dimensional type. Levin shows that, under regularity condition,
this case can be solved using Myerson’s very method. Our work can be seen as a complement of Levin’s
setting to the negative correlation setting.

Extending the ironing technique to multidimensional domain dates back to the seminal work by [25],
where they study the single bidder case. They invent a sweeping procedure that properly generalizes ironing
to multidimensions. Their method is non-constructive, thus does not yield an explicit representation of the
optimal mechanism.

At a higher level, our work is within the agenda of multidimensional revenue maximization. In par-
ticular, our work is in the direction of exactly optimal mechanism design [8, 9, 3, 13], orthogonal to those
aiming for approximate optimality [16, 14, 18, 27]

There are a number of papers that consider the equivalence between BIC and DIC with respect to the
objective of social welfare[10, 7]. For the objective of revenue maximization, [20] proves that in the inde-

3

pendent private values model with linear utility, the outcome in terms of interim allocation rule and interim
payment rule of any BIC mechanism, can also be obtained with a DIC mechanism (without any restriction
on IR). Since the interim allocation rule and payment rule are same under the two IC notions, their work
actually implies that any interim IR and BIC auction can be implemented in an interim IR and DIC auction.
However, do notice that their result does not imply the equivalence between ex post IR and BIC mechanisms
and ex post IR and DIC mechanisms, because equivalence in interim utilities does not imply equivalence in
ex post utilities under the two notions of IC.

[11] extend the above work to general multi-dimensional, possibly non-linear settings. They provide a
setting where, under a restricted deﬁnition of mechanism, the optimal DIC “mechanism” produces strictly
less revenues than the optimal BIC “mechanism”.

However, in their setting that sells two items to two bidders, any mechanism under their deﬁnition must
be restricted to only three deterministic allocations: sell the bundle to the ﬁrst bidder, sell the bundle to
the second bidder, and sell one to each. So the revenue optimal “mechanism” under their deﬁnition is not
optimal under the standard deﬁnition, because they preclude the possibility of reserving one or both of the
items.

2 Setting

i , v2

i ) towards the two items are negatively correlated, satisfying v1

A seller has two items for sale. There are n bidders interested in the items. For each bidder i, his valuation
i = b, where a ≥ 1 and b > 0.
(v1
Now that v2
i to denote bidder i’s type. We
assume each ti is independently, identically drawn from a differentiable density function f on [0, b]. In other
words, the probability density at valuation (ti, (b − ti)/a) is f (ti).

i + av2
i )/a, we can use a one-dimensional variable ti = v1

i = (b − v1

By revelation principle [22], it is without loss for the seller to focus on direct mechanisms. Such mech-
anism ﬁrst solicits a type proﬁle t = (t1, . . . , tn) from the bidders and then speciﬁes an allocation rule and a
i (t) ≥ 0, (j = 1, 2) to denote the probability that bidder i is allocated the j-th item,
payment rule. We use qj
and payi(t) to denote his payment. For each item j, the allocation rule must satisfy the feasibility constraint,

i (t) ≤ 1,∀t. Bidder i’s utility in this case is ui(t) = q1
i qj

i (t)ti + q2

i (t)(b − ti)/a − payi(t).

i.e.,(cid:80)

The seller’s goal is to design a direct mechanism (i.e., auction) that maximizes the sum of payments
(i.e., revenue) subject to Bayesian incentive compatibility (BIC) and Interim individual rationality (IIR)
constraints [22].

Bayesian incentive compatibility states that no bidder has any incentive to lie about his valuation without

knowing other bidders’ types. Formally,

Et−i[q1

i (t(cid:48)

i, t−i)ti + q2

i (t(cid:48)

i, t−i)

b − ti
a

− pay(t(cid:48)

i, t−i)] ≤ Et−i[ui(ti, t−i)]

Interim individual rationality states that a bidder never gets negative expected utility by participating in
the auction. Formally, Et−i[ui(ti, t−i)] ≥ 0. Interim IR is a weaker concept than the standard ex post IR,
which requires that a bidder never gets negative utility for any realization of type proﬁle. Even though we
have interim IR in the problem formulation, the optimal auctions we obtain are indeed ex post IR.

It is convenient to have the following interim notations (aka. reduced forms).

Deﬁnition 2.1 We use qj
item at type ti. Formally qj
payi(ti) and ui(ti).

i (ti), i = 1, 2 to denote the expected probability that bidder i is allocated the j-th
i (ti, t−i)]. Similarly, we can deﬁne interim payment and utility

i (ti) = Et−i[qj

4

Furthermore, for bidders with i.i.d type distributions, by [21], it is without loss of generality to only
consider mechanisms that are symmetric in bidders. In this case, we simplify notation by dropping subscript
i, i.e. qj(ti) = qj
i (ti), pay(ti) = payi(ti) and u(ti) = ui(ti). Furthermore we use t to denote one bidder’s
type directly when there is no ambiguity.
It is well known [24, 15, 26] that the BIC constraint is equivalent to that each bidder has a convex utility
function, i.e., u(cid:48)(cid:48)(·) ≥ 0,∀i. On the other hand, given such a utility function, the allocation rule is given by
the gradient of the utility function,

∂v2
∂t
The seller’s problem is formally deﬁned as follows.

u(cid:48)(t) =

∂v1
∂t

∂u
∂v1

∂u
∂v2

(t) +

(t) = q1(t) − q2(t)
a

(cid:90) b

0

M aximize

s.t.

(cid:88)

REV = n

[t · q1(t) +

· q2(t) − u(t)] · f (t)dt

b − t
a

i (t) ≤ 1 ∀t ∈ [0, b]n, j = 1, 2
qj

i

u(t) ≥ 0, u(cid:48)(t) = q1(t) − q2(t)
a

, u(cid:48)(cid:48)(t) ≥ 0,∀t ∈ [0, b]

2.1 Border’s theorem
Note that in the seller’s problem, everything is deﬁned in terms of interim notations except for the feasibility
constraints. Fortunately, the following theorem, well known as the Border’s theorem, allows us to equiva-
lently convert the feasibility constraints into interim notations. Theorem 2.2 and Lemma 2.3 are applied for
asymmetric case. We use fi to denote the density function of bidder i.

Theorem 2.2 [2, 6, 9, 12] There exists a feasible mechanism implements the interim allocation rule qj
and only if

i if

qi(t)fi(t)dt ≤ 1 − Πi(1 −

fi(t)dt) ∀Si, i = 1, ..., n

(cid:90)

(cid:88)

(cid:90)

t∈Si
Si is any subset of type of player i. Here, Si ⊆ [0, b], i = 1...n.

t∈Si

i

In symmetric setting, feasible constraint reduces to that the inequality always hold when Si,∀i are the

same. By Border’s Theorem, the seller’s problem is equivalent to,

M aximize

s.t.

(cid:90) b
qj(t)f (t)dt ≤ 1 − (1 −(cid:82)

[t · q1(t) +

b − t
a

0

REV = n

(cid:90)

t∈S f (t))n
t∈S
n
u(t) ≥ 0, u(cid:48)(t) = q1(t) − q2(t)
a

, u(cid:48)(cid:48)(t) ≥ 0

· q2(t) − u(t)] · f (t)dt

∀S, j = 1, 2

5

2.2 Monotonicity of the optimal solution of the relaxed seller’s problem
Recall Myerson’s techniques in the single-item case, revenue is expressed as the expected virtual surplus
and the optimal allocation rule is to naturally allocate the item to the bidder with the highest virtual value.
A key property, perhaps also a trivial one, is that the allocation rule is monotone with respect to the virtual
value, i.e., higher virtual value implies higher probability of being allocated. This property, together with the
regularity assumption (or the ironing technique in the irregular case), implies that the interim allocation is
monotone in bidder’s interim type. In other words, IC is guaranteed in the relaxed virtual surplus maximizing
solution.

However, in our problem, such property is nontrivial because of the multi-dimensional feasibility con-
straints, i.e., the Border feasibility. Therefore, to extend Myerson’s technique to this setting, an important
step is to show that, the virtual surplus maximizing allocation rule is still monotone with respect to the
virtual value. Then, with a generalized ironing technique that ensures virtual value is monotone in interim
type, we guarantee that the optimal allocation rule in the virtual surplus maximizing solution satisﬁes the IC
constraints.

The following lemma and theorem, in the form of generalizations of Border’s Theorem, are for this

purpose. The lemma and theorem may be of independent interest.

Lemma 2.3 There exists a feasible mechanism implements the interim allocation rule qi if and only if for
any virtual value function xj

(cid:88)

i (t) ∈ [0, +∞),
(cid:90) b

qi(t)fi(t)xi(t)dt ≤

(cid:90) +∞

0

i

0

(cid:90)

1 − Πi(1 −

fi(t)dt)dv

xi(t)≥v

This theorem subsumes Border’s theorem. To see this, let v = 1, and xi(t) = 1, t ∈ Si, and xi(t) = 0, t /∈
Si. Proof. If the interim allocation rule is implementable, we have

(cid:90) b

(cid:88)

0

i

qi(t)fi(t)xi(t)dt =

≤

(cid:90) +∞
(cid:90) +∞

0

0

(cid:90)

(cid:88)

(cid:90)

i

xi(t)≥v
1 − Πi(1 −

qi(t)fi(t)xi(t)dtdv

fi(t)dt)dv

(1)

xi(t)≥v

The inequality follows from the Border’s theorem. For the opposite direction, since qi satisﬁes the Border’s
(cid:117)(cid:116)
condition by setting xi(t) = 1, the interim allocation rule is implementable by Border’s Theorem.

From now on, we restrict to the i.i.d. bidders case. The following theorem states that in the optimal
solution of the relaxed seller’s problem that only considers Border feasibility constraints, without IC and IR
constraints1, interim allocation probability q(t) in monotone with respect to virtual value x(t). To formally
state our result, the monotone property must be stated on the nonzero measure.

Theorem 2.4 In the i.i.d. bidders case, there exists a feasible mechanism that implements the interim allo-
cation rule q if and only if for any x(t) ∈ [0, v],

(cid:90) b

(cid:90) v

(cid:90)

q(t)f (t)x(t)dt ≤

1 − (1 −

0

0

f (t)dt)ndv

x(t)≥v

1This problem is called the relaxed (seller’s) problem throughout the paper.

6

When the bound is achieved, for any set C,D with nonzero measure,

t∈C {x(t)} > max

min

t∈C q(t)f (t)dt

t∈D q(t)f (t)dt

t∈D f (t)dt

(cid:82)

(cid:82)

≥

Proof. For the ﬁrst part, the proof is exact same except using Border’s theorem in symmetric version
instead. For the second part, when the bound is achieved, the inequality (1) becomes equality. In symmetric
version, it is

Let W = {s : x(s) ≥ mint∈C{x(t)}}, w =(cid:82)

x(t)≥v

Then

q(t)f (t)dt =

,∀v

x(t)≥v f (t)dt)n
n

t∈C f (t)dt, and d =(cid:82)

1 − (1 − w)n

t∈D f (t)dt

W f (t)dt)n
n

=

W−C f (t)dt)n
n
W+D f (t)dt)n
n

n
1 − (1 − w + c)n

n

1 − (1 − w − d)n

n

=

=

(cid:90)

(cid:90)
(cid:90)
(cid:90)

W

W−C

(cid:82)

q(t)f (t)dt =

t∈C f (t)dt

t∈D {x(t)} ⇒

(cid:82)
1 − (1 −(cid:82)
t∈W f (t)dt, c =(cid:82)
1 − (1 −(cid:82)
q(t)f (t)dt ≤ 1 − (1 −(cid:82)
q(t)f (t)dt ≤ 1 − (1 −(cid:82)
(cid:90)
(cid:82)
(cid:90)
(cid:82)

D
D q(t)f (t)dt

n−1(cid:88)

n−1(cid:88)

c

≤ 1
n

k=0

W+D

By (2)-(3) and (4)-(2), we have

(2) − (3)

(4) − (2)

(cid:82)

Hence

C q(t)f (t)dt

c

≥

(cid:82)

D q(t)f (t)dt

d

.

d

q(t)f (t)dt ≥ (1 − w + c)n − (1 − w)n

C
C q(t)f (t)dt
q(t)f (t)dt ≤ (1 − w)n − (1 − w − d)n

≥ 1
n

k=0

n

(1 − w + c)(1 − w)n−1−k

n

(1 − w − d)k(1 − w)n−1−k

(2)

(3)

(4)

(cid:117)(cid:116)

3 Warm-up: the single bidder case

In this section, we study the single bidder case. This case is easier because the feasibility constraint is
simply q1(t), q2(t) ∈ [0, 1]. Another important reason why this case is easier is that the lowest utility point
is always at the lowest type (i.e., the lowest valuation of the ﬁrst item), avoiding complexities brought by IR
and by optimizing the location of the lowest utility point.

Lemma 3.1 In the optimal mechanism, u(0) = 0.

If u(t) > 0,∀t ∈ [0, b], we can always decrease the buyer utility function by simultaneously

Proof.
increasing the payment of every menu. We assume u(t∗) = 0, t∗ ∈ [0, b].

7

We ﬁrst prove the payment when t ∈ [0, t∗] must be less than or equal to b
a.

pay(t) = tq1(t) +

b − t
a

q2(t) − u(t) ≤ t(q1(t) − 1
a

q2(t)) +

q2(t) − 0

b
a

≤ 0 +

b
a

q2(t) ≤ b
a

The ﬁrst inequality follows from u(t) ≥ 0. The second inequality follows from the fact q1(t) − 1
a q2(t) =
u(cid:48)(t) ≤ 0 when t ∈ [0, t∗], since u(t) is convex. The last inequality follows from q2(t) ≤ 1. The upper
bound b/a is achieved only when (q1(t), q2(t), u(t)) = (1/a, 1, 0).

For any q1(t), q2(t) and u(t), consider the following allocation and utility function:

(cid:26) (1/a, 1, 0)

(q1, q2, u(t)) =

(q1(t), q2(t), u(t))

t ∈ [0, t∗]
t ∈ (t∗, b]

This is indeed achieved by a mechanism where the payment is b/a, t ∈ [0, t∗], which is the largest
possible payment for this interval as proved earlier. The payment remains the same for t ∈ (t∗, b]. As a
result, the modiﬁed mechanism generates strictly more revenue than the original mechanism, except when
they are the same.
Furthermore, this modiﬁed mechanism clearly satisﬁes IR constraint by its deﬁnition and IR of the
original mechanism. We complete the proof by showing it is IC. Since u(t∗) = 0 and u(t) ≥ 0, t ∈ [0, b],
we have u(cid:48)(t∗) = 0. Since u is convex, we have u(cid:48)(cid:48)(t) ≥ 0, t ∈ (t∗, b]. By deﬁnition, u(cid:48)(cid:48)(t) = 0, t ∈ [0, t∗].
Combined together u(cid:48)(cid:48)(t) ≥ 0, t ∈ [0, b], i.e., IC is satisﬁed. Thus the optimal mechanism must be in this
(cid:117)(cid:116)
form. In particular, u(0) = 0.

3.1 The optimal solution
Because u(0) = 0, we can rewrite the revenue formula as follows,

(cid:90) b
(cid:90) b

0

0

REV =

=

q2(t) −

b − t
(q1(s) − 1
a
a
q2(t))(tf (t) − 1 + F (t)) +

0

[tq1(t) +

(q1(t) − 1
a

b
a

f (t)q2(t)dt

q2(s))ds − u(0)]f (t)dt

Let h(t) = tf (t) + F (t) − 1 and apply the ironing technique of Myerson.
Deﬁnition 3.2 [22] For any z ∈ [0, 1], let

(cid:90) t

(cid:90) F −1(z)

0

(cid:90) F −1(z)

0

8

H(z) =

h(t)dt

H ir(z) =

hir(t)dt

and let H ir(z) be the convex hull of H(z), i.e., the largest convex function that is less than or equal to H(z).
We deﬁne hir(t), t ∈ [0, b] such that

Lemma 3.3 The function ∂H ir
weakly increasing in t. 2

∂z (z) is weakly increasing in z and the ironed virtual value function hir(t)

f (t)

is

It may be helpful to think of hir(t)

f (t) as the virtual value of type t in our setting. The above lemma claims

that the virtual value is indeed monotone after ironing.

Lemma 3.4 We have(cid:82) b

a )h(t)dt ≤(cid:82) b

0 (q1(t) − q2(t)

either H(F (t)) = H ir(F (t)) or (q1(t) − q2(t)

a )(cid:48) = 0, then the inequality becomes equality.

0 (q1(t) − q2(t)

a )hir(t)dt. If for almost every t, we have

Similar to Myerson’s analysis, the above lemma states that ironing does not hurt revenue, i.e., the ironed

revenue achieves the revenue upper bound computed as if h is monotone.
Proof.

(cid:90) b

0

0

(cid:90) b
(cid:90) b
(cid:90) b
(cid:90) b

0

= −

≤ −

=

0

(q1(t) − q2(t)
a

(q1(t) − q2(t)
a
(q1(t) − q2(t)
a
(q1(t) − q2(t)
a

0

(cid:90) t

0

)h(t)dt =

(q1(t) − q2(t)
a

)dH(F (t))

)(cid:48)H(F (t))dt + (q1(t) − q2(t)
a

)

h(s)ds|b

0

)(cid:48)H ir(F (t))dt + (q1(t) − q2(t)
a
(q1(t) − q2(t)
a

(cid:90) b

)dH ir(F (t)) =

0

)H ir(F (t))|b

0

)hir(t)dt

(5)

(6)

The ﬁrst term in (5) is less than or equal to the ﬁrst term in (6). The second terms in (5) and (6) are equal.
The inequality becomes equality when (q1(t) − q2(t)
a )(cid:48)H ir(F (t)) fails on zero
(cid:117)(cid:116)
measure.

a )(cid:48)H(F (t)) = (q1(t) − q2(t)

Going back to the problem, it becomes

M aximize

s.t.

By Lemma 3.4, we have

REV ≤

(cid:90) b

0

(cid:90) b

0

REV =
q1(t), q2(t) ∈ [0, 1]
q1(t) − q2(t)
a

(q1(t) − 1
a

q2(t))h(t) +

b
a

f (t)q2(t)dt

≥ 0, (q1(t) − q2(t)
a

)(cid:48) ≥ 0

(q1(t) − q2(t)
a

)hir(t)dt +

b
a

f (t)q2(t)dt

Let s = maxt{t|hir(t) = 0}, then (q1(t) − q2(t)

a )hir(t) ≤ 0, we get

REV ≤

(q1(t) − q2(t)
a

)hir(t)dt +

b
a

f (t)q2(t)dt +

(cid:90) b

s

(cid:90) s

bf (t)

0

a

q2(t)dt

(7)

2 ∂Hir

∂z (z) exists for almost every point except for some breaking points.

9

Since q1(t) ≤ 1, t ∈ [s, b] and q2(t) ≤ 1, t ∈ [0, s], we have

(cid:90) s

bf (t)

(cid:90) b
(cid:90) b

s

REV ≤

=

)hir(t) +

q2(t)dt +

dt

(8)

(1 − q2(t)
a

hir(t)dt +

(cid:90) s

bf (t)

0

a

(cid:90) b

bf (t)

a

dt +

a
bf (t) − hir(t)

0

s

a

q2(t)dt

The coefﬁcient of q2 is nonnegative, since

s

hir(t)
f (t)

=

∂H ir
∂t

(F (t)) ≤ max

t

(F (t)) ≤ max

∂H
∂t

(F (t))

t

= max

t

h(t)
f (t)

{t +

= max

t

∂H ir
∂t
F (t) − 1

f (t)

} ≤ b

Since q2(t) ∈ [0, 1], t ∈ [s, b],

REV ≤

(cid:90) b

s

hir(t)dt +

(cid:90) s

0

Construct q1 and q2 as follows,

(q1(t), q2(t)) =

bf (t)

dt +

(cid:90) b
(cid:26) (1/a, 1)

a

s

t ∈ [0, s]
t ∈ (s, b]

(1, 1)

bf (t) − hir(t)

a

dt

(9)

Using this allocation rule, inequalities (7) (8) (9) become equalities.

Remember H ir(·) is the convex hull of H(·). If H(F (t)) > H ir(F (t)), curve (z, H ir(z)), z ∈ [F (t) −

, F (t) + ] must be a straight line for some . Thus ∂ hir(t)

f (t) /∂t = 0.

When hir(t)
f (t)

or equal to s. By deﬁnition, q1(t)− q2(t)
an equality as well.

a

is equal for any two types s1 and s2, s1 and s2 must be both larger than s, or both less than
is equal for the s1 and s2. Thus the ironing inequality (6) becomes

Then we get utility function and payment function:

(cid:26) 0,

u(t) =

a (t − s),
a−1

t ∈ [0, s]
t ∈ (s, b]

pay(t) =

(cid:40) b
a ,
a + (a−1)s
b

a

,

t ∈ [0, s]
t ∈ (s, b]

Theorem 3.5 In the single-bidder case, the optimal mechanism consists of 2 menus: the ﬁrst is a ran-
domized bundle (1/a, 1, b/a) and the second is a deterministic bundle (1, 1, b
), where s =
maxt{t|hir(t) = 0}.

a + (a−1)s

a

4 The n-bidder case

As mentioned, this case is more complicated for at least two reasons: Border feasibility, as well as the fact
that the zero utility point may not be at the lowest type. For any t∗ ∈ [0, b], we ﬁrst rewrite the revenue
formula as a function of t∗ and u(t∗). Later we will pick t∗ such that it is the zero utility point.

10

4.1 Revenue formula

(cid:90) b
(cid:90) b
(cid:90) b

0

0

REV

n

=

=

=

Where,

0

(cid:90) t

[t · q1(t) +

· q2(t) − u(0) −

b − t
(q1(s) − q2(s)
a
a
(q1(t) − q2(t)
dt − u(0)
)(tf (t) + F (t) − 1) + q2(t) · bf (t)
a
a
(q1(t) − q2(t)
dt − u(t∗)
a

)h(t, t∗) + q2(t) · bf (t)
a

0

)ds] · f (t)dt

(cid:26) tf (t) + F (t)

t ≤ t∗
tf (t) + F (t) − 1 t > t∗

h(t, t∗) =

(10)

Ironing

4.2
By separating q1 and q2, revenue formula (10) can be rewritten as

(cid:90) b

0

q1(t)f (t)

h(t, t∗)
f (t)

+ q2(t)f (t)(

− h(t, t∗)

af (t)

b
a

)dt − u(t∗).

a

Now consider the relaxed maximization problem on the integral with only Border’s feasibility. Since for
different t∗, the relaxed problem is different. Let q1(t, t∗) and q2(t, t∗) denote the solution with respect to
t∗. Let u(t, t∗) denote a still unﬁxed utility function while keeping ∂u(t,t∗)
, t ∈ [0, b].
By Theorem 2.4, in the optimal solution, q1(t, t∗) and −q2(t, t∗) are monotone with respect to h(t,t∗)
f (t) . Thus
q1(t, t∗) − q2(t,t∗)
f (t) might not be monotone in t, then
q1(t, t∗) − q2(t,t∗)

is monotone with respect to h(t,t∗)

∂t = q1(t, t∗) − q2(t,t∗)

f (t) . However h(t,t∗)

to be monotone in t. After ironing, equation (10) becomes(cid:82) b

To satisfy BIC, we hope the optimal solution of q1(t, t∗) and −q2(t, t∗) to be both monotone in t. We ap-
ply a generalized ironing procedure to the coefﬁcient function h(t, t∗), ensuring ironed virtual value hir(t,t∗)
af (t) )dt−
u(t∗). By Theorem 2.4, the upper bound is achieved when q1(t, t∗) and −q2(t, t∗) are monotone with re-
spect to hir(t,t∗)
is
same, q1, q2 are not ﬁxed, the monotonicity will be clariﬁed in the next section. 3

. Hence, q1(t, t∗) and −q2(t, t∗) are monotone in t and BIC is satisﬁed. When hir(t,t∗)

0 q1(t)f (t) hir(t,t∗)

a might not be monotone in t, violating BIC.

f (t) +q2(t)f (t)( b

a− hir(t,t∗)

f (t)

f (t)

f (t)

a

Deﬁne the following ironing function with respect to any given type t∗.

Deﬁnition 4.1 For any z ∈ [0, 1], let

(cid:90) F −1(z)

0

h(t, t∗)dt

H(z, t∗) =

H ir(z, t∗) is the convex hull of H(z, t∗), i.e., the largest convex function that is less than or equal to H(z, t∗).
We deﬁne hir(s, t∗) such that

(cid:90) F −1(z)

H ir(z, t∗) =

hir(t, t∗)dt

3There is an exception when hir (t,t∗)

f (t)

is the same for several types, In this case, q1 and q2 are not ﬁxed. How to determine q1

and q2 in this case and to prove monotonicity will be clariﬁed in detail in the next section.

0

11

The following two lemmas are exactly the same as the single bidder case. The second part of Lemma
4.3 states that, when certain conditions hold, one can replace the virtual value function h(t, t∗) by the ironed
one hir(t, t∗) in the revenue formula and achieve the same revenue upper bound. However, in the n-bidder
case, when the conditions hold, there may be many possible solutions of q1(t, t∗) and q2(t, t∗). In the next
section, we will pick a speciﬁc pair of q1(t, t∗) and q2(t, t∗).

∂z (z, t∗) is weakly increasing in z and the virtual value function hir(t,t∗)

f (t)

is

Lemma 4.2 The function ∂H ir
weakly increasing in t.

Lemma 4.3 We have(cid:82) b

0 (q1(t)− q2(t)

a )h(t, t∗)dt ≤(cid:82) b

every t we have either H(F (t), t∗) = H ir(F (t), t∗) or (q1(t) − q2(t)
equality.

0 (q1(t)− q2(t)

a )hir(t, t∗)dt. Furthermore, if for almost
a )(cid:48) = 0, then the inequality becomes

With the two lemmas, by Equation (10), we have

(cid:90) b
(cid:90) b
(cid:90) b

0

0

(cid:90) b

REV

n

≤

=

=

(q1(t) − q2(t)
a

)hir(t, t∗) + q2(t)

bf (t)

dt − u(t∗)

a

bf (t) − hir(t, t∗)

q1(t)hir(t, t∗) + q2(t)

∂( hir(t,t∗)

)

dt − u(t∗)

(cid:90) b

(cid:90) t

a

1
a

q1(s)f (s)ds

f (t)
∂t

dt +

)/∂t ≥ 0. By Border’s feasibility constraint, we have(cid:82) b

q2(s)f (s)ds

f (t)
∂t

0

0

t q1(s)f (s)ds ≤

∂( hir(t,t∗)

)

dt − u(t∗)

0

t

By Lemma 4.2, we have ∂( hir(t,t∗)
1−F n(t)

,(cid:82) t
0 q2(s)f (s)ds ≤ 1−(1−F (t))n

f (t)

n

n

, then

REV

n

≤ 1 − F n(t)
≤ 1 − F n(t)

n

n

∂( hir(t,t∗)

∂( hir(t,t∗)

f (t)
∂t

f (t)
∂t

)

)

dt +

dt +

(cid:90) b
(cid:90) b

0

0

1
a

1
a

1 − (1 − F (t))n

n

1 − (1 − F (t))n

n

∂( hir(t,t∗)

∂( hir(t,t∗)

f (t)
∂t

f (t)
∂t

)

)

dt − u(t∗)

dt

(11)

(12)

Up to now, we have shown that, for any t∗, there exist allocation function q1(t, t∗) and q2(t, t∗) such
that (11) becomes an equation (thus, by Theorem 2.4, such allocation function guarantees BIC).
It remains to prove there exist t∗, together with q1(t, t∗), q2(t, t∗) and u(t, t∗) found in the ﬁrst step,
such that u(t∗, t∗) = 0, t∗ is the lowest point of u(t, t∗) and (12) becomes an equation, i.e. such t∗ together
with q1(t, t∗), q2(t, t∗) and u(t, t∗) ensure IR.
revenue upper bound (12) set by Border feasibility alone, in which the lowest utility point is at type t∗.

To sum up we show that there is indeed an IC, IR mechanism that achieves the allocation-independent

5 Satisfying IR

We ﬁrst state our main result of this section.
Theorem 5.1 There exists a type t∗, allocation rule q1(t, t∗), q2(t, t∗) and utility function u(t, t∗) such that
inequality (12) becomes an equality, also u(t, t∗) ≥ 0 and ∂u

∂t (t, t∗) = q1(t, t∗) − q2(t,t∗)

a

.

12

The proof of Theorem 5.1 is divided into several steps. First, we provide a structural characterization
of the set of q1(t∗, t∗) and q2(t∗, t∗) from all possible solutions of the relaxed problem. It turns out that,
for each t∗, there exists a closed interval (could be a single point) such that any number in this interval
corresponds to such a q1(t∗, t∗), Similarly for q2(t∗, t∗) and q1(t∗, t∗) − q2(t∗,t∗)
Then the value intervals of q1(t∗, t∗)− q2(t∗,t∗)
a
on properties of the union of these intervals.

Second, we show that, such value intervals of q1(t∗, t∗) for each t∗ seamlessly connect, as t∗ increases.
seamlessly connect, as t∗ increases. We then choose t∗ based

a

.

5.1 Finalizing the optimal allocation rule
To determine the value interval of q1(t∗, t∗) for each t∗, we need to investigate a set of types around t∗ such
that, for each type t in this set, hir(t, t∗)/f (t) = hir(t∗, t∗)/f (t∗). In other words, these types have the same
ironed virtual value as at type t∗. However, these types may have different interim allocation probabilities,
i.e., q1(t, t∗) for these types may be different. This is also different from the Myerson case where virtual
value is the unique identity to determine the interim allocation rule. In our case, the set of types with the
same ironed virtual value can be partitioned into several subsets. The partition points are exactly those where
the convex hull H ir touches H.
It can be shown that, the largest (rightmost point of the interval) value of q1(t∗, t∗) is given by uniformly
setting the highest possible interim probability for some subsets and the lowest interim probability on the
remaining subsets. The smallest (leftmost point of the interval) value of q1(t∗, t∗) is given similarly.

To make the above ideas formal, we now introduce several notations regarding how to partition the set

of types with the same ironed virtual value.
Lemma 5.2 H(F (t∗), t∗) > H ir(F (t∗), t∗), when t∗ ∈ (0, b).
It says point (t∗, H(F (t∗), t∗)) is above point (t∗, H ir(F (t∗), t∗)) when t∗ ∈ (0, b). Thus lmin
lmax
1
Deﬁnition 5.3 For any t∗ ∈ (0, b), we deﬁne

(t∗, t∗). By this lemma, (ˆq1, ˆq2) and (ˇq1, ˇq2) are well deﬁned.

2

(t∗, t∗) >

(F (t), t∗))

lmin
1

lmin
2

lmax
1

lmax
2

∂H ir
∂z

∂H ir
∂z

(x, t∗) =

(t, t∗) = min
(
x≤F (t)
(H ir(x, t∗) = H ir(F (t), t∗))
(t, t∗) = min
x≥F (t)
(H ir(x, t∗) = H ir(F (t), t∗))
(t, t∗) = max
x≤F (t)
(t, t∗) = max
(
x≥F (t)

(x, t∗) =

∂H ir
∂z

∂H ir
∂z

(F (t), t∗))

2

(t, t∗) is the leftmost point of the straight line segment on which point (t, H ir(t, t∗)) lies.

Look at Fig 1, lmin
1
Similar for lmin
If ( hir(t,t∗)
If ( hir(t,t∗)

(t, t∗), lmax

(t, t∗), lmax
)(cid:48) > 0, H ir(F (t), t∗) = H(F (t), t∗). q1(t, t∗) = F n−1(t), q2(t, t∗) = (1 − F (t))n.
)(cid:48) = 0, there are two cases: First, if hir(t,t∗)

(t, t∗). Next we deﬁne the interim allocation rule.

f (t) = hir(t∗,t∗)
One extreme allocation is to assign a higher probability on [F −1(lmin

, there are two extreme allocations.
(t∗, t∗)), F −1(lmax
(t∗, t∗))] and a

f (t)

f (t)

1

2

f (t)

2

2

13

Figure 1: Partition points and allocations

lower probability on [F −1(lmin

(t∗, t∗)), F −1(lmin

(t, t∗))).

2
(t∗,t∗))n−(lmin
(t∗,t∗)−lmin
(t∗,t∗))n−(lmin
(t∗,t∗)−lmin

1

1

2

2

(lmin

2

lmin
2
(lmax

2

lmax
2

(t∗,t∗))n
(t∗,t∗)
(t∗,t∗))n
(t∗,t∗)

, F (t) ∈ [lmin
, F (t) ∈ [lmin

1

2

(t∗, t∗), lmin
(t∗, t∗), lmax

2

(t∗, t∗))
(t∗, t∗)]

2

(1−lmin

(t∗,t∗))n−(1−lmin

(t∗,t∗))n

1

2

(t∗,t∗)−lmin
lmin
(t∗,t∗))n−(1−lmax
2
(t∗,t∗)−lmin
lmax
2

1

2

2

(t∗,t∗)
(t∗,t∗))n

(t∗,t∗)

,

(lmin

2

, F (t) ∈ [lmin
F (t) ∈ [lmin

1

2

(t∗, t∗), lmin
(t∗, t∗), lmax
(t∗, t∗), lmax

2

(t∗, t∗))
(t∗, t∗)]
(t∗, t∗)] and a lower

2

2

1

The other extreme allocation is to assign a higher probability on [lmax

one on [lmin

1

(t∗, t∗), lmax

(t, t∗)). That is,

1

ˆq1(t, t∗) =

ˆq2(t, t∗) =

n
1
n

1

n
1
n

 1
 1
 1
 1

n
1
n

n
1
n

ˇq1(t, t∗) =

ˇq2(t, t∗) =

(lmin

2

lmin
2
(lmax

2

1

(t∗,t∗))n−(lmin
(t∗,t∗)−lmin
(t∗,t∗))n−(lmin
(t∗,t∗)−lmin

(t∗,t∗))n
(t∗,t∗)
(t∗,t∗))n
(t∗,t∗)

1

2

lmax
2

2

, F (t) ∈ [lmin
, F (t) ∈ [lmax

1

(t∗, t∗), lmax
(t∗, t∗), lmax

1

(t∗, t∗))
(t∗, t∗)]

1

2

(1−lmin

(t∗,t∗))n−(1−lmin

(t∗,t∗))n

1

2

(t∗,t∗)−lmin
lmin
(t∗,t∗))n−(1−lmax
2
(t∗,t∗)−lmin
lmax
2

1

2

2

(t∗,t∗)
(t∗,t∗))n

(t∗,t∗)

,

(lmin

2

, F (t) ∈ [lmin
F (t) ∈ [lmax

1

(t∗, t∗), lmax
(t∗, t∗), lmax

1

(t∗, t∗))
(t∗, t∗)]

1

2

Second, if hir(t,t∗)

f (t)

(cid:54)= hir(t∗,t∗)

f (t)

same ironed virtual value.
q1(s, t∗) =

(cid:110) 1
(cid:110) 1

n

n

1

1

, we assign the same interim allocation probability to all the types with

(lmax

2

lmax
2

(t,t∗))n−(lmin
(t,t∗)−lmin

(t,t∗))n
(t,t∗)

1

, F (s) ∈ [lmin

1

(t, t∗), lmax

2

(t, t∗))

q2(s, t∗) =

(1−lmin

1

(t,t∗))n−(1−lmax
(t,t∗)

(t,t∗)−lmin

2

(t,t∗))n

lmax
2

, F (s) ∈ [lmin

1

(t, t∗), lmax

2

(t, t∗))

Let α denote a parameter in [0, 1]. Consider q1(t, t∗) = αˆq1(t, t∗) + (1 − α)ˇq1(t, t∗) and q2(t, t∗) =
αˆq2(t, t∗)+(1−α)ˇq2(t, t∗), t ∈ [lmin
(t∗, t∗)]. When H ir(F (t), t∗) < H(F (t), t∗), we always
have ∂(q1(t, t∗)− q2(t,t∗)
)/∂t = 0. By Lemma 4.3, q1(t, t∗) and q2(t, t∗) still maximize the relaxed problem.
q1(t, t∗) and −q2(t, t∗) are both monotone in t, which guarantees BIC. When α goes from 0 to 1, q1(t∗, t∗)
can achieve any value between the interval [ˇq1(t∗, t∗), ˆq1(t∗, t∗)]. Furthermore, q1(t∗, t∗) − q2(t∗,t∗)
can
achieve any value in the corresponding interval.

(t∗, t∗), lmax

a

a

1

2

14

l1minl1maxl2minl2maxF(t*)HHirl1minl1maxl2maxF(t*)l2min∧1qq∨12

2

(cid:83)

We give example of q1 when t∗ = 0. It is similar when for t∗ = b and q2. The difference between
(0, 0)]n−1 when
Deﬁnition 5.3 is that we assign a unique interim allocation probability q1(t, 0) = [lmax
t ∈ [0, lmax
(0, 0)]. q1(t, 0) is same as in Deﬁnition 5.3. Then, as promised, we show the value intervals of
q1(t∗, t∗) are seamlessly connect as t∗ increases. Let [k1(t∗), k2(t∗)] denote the value interval for q1(t∗, t∗).
We say intervals seamlessly connect, if for any two types t∗1 < t∗2, we have that k2(t∗1) ≤ k1(t∗2), and
t∗[k1(t∗), k2(t∗)] is connected.
Lemma 5.4 The value intervals of q1(t∗, t∗) seamlessly connect as t∗ increases.
Finally we can prove Theorem 5.1 Proof. By Lemma 5.4, we know the value intervals of q1(t∗, t∗)− q2(t∗,t∗)
also seamlessly connect. If zero is in the union of value intervals, we assume it is in the value interval
of q1(t∗∗, t∗∗) − q2(t∗∗,t∗∗)
. Choose α such that q1(t∗∗, t∗∗) = αˆq1(t∗∗, t∗∗) + (1 − α)ˇq1(t∗∗, t∗∗). Let
q1(t, t∗∗) = αˆq1(t, t∗∗) + (1 − α)ˇq1(t, t∗∗) for t ∈ [lmin
∂t (t, t∗∗) = q1(t, t∗∗)− q2(t,t∗∗)

=
∂t (t, t∗∗) is monotone in t, we have u(cid:48)(t, t∗∗) ≤ 0, t ∈ [0, t∗∗] and u(cid:48)(t, t∗∗) ≥ 0, t ∈ [t∗∗, b]. Then
0 and ∂u
u(t∗∗, t∗∗) is indeed the lowest utility point. The constructed q1(·, t∗∗), q2(·, t∗∗) and u(·, t∗∗) satisﬁes both
IIR and BIC and achieves the revenue upper bound in Equation (12) and is therefore revenue optimal.
If zero is below(above) the union of value intervals, we set t∗∗ = 0(b) and α = 0(1) instead. The zero
(cid:117)(cid:116)

(t∗∗, t∗∗)). Similar for q2(t, t∗∗).
∂t (t∗∗, t∗∗) = q1(t∗∗, t∗∗)− q2(t∗∗,t∗∗)

Let u(t∗∗, t∗∗) = 0 and ∂u

utility point will be 0(b).

(t∗∗, t∗∗), lmax

2
. Since ∂u

a

a

a

a

1

Implementation: the form of the optimal auction

5.2
Given type t∗, interim allocation rule q1(t, t∗) and q2(t, t∗), and expected utility function u(t, t∗) that in
Theorem 5.1. We now describe the form of the optimal mechanism.
Let q1(t∗, t∗) = αˆq1(t∗, t∗) + (1 − α)ˇq1(t∗, t∗). The optimal auction, in general, allocates item 1
uniformly among the bidders with the highest ironed virtual value. However, there are exceptions when the
highest ironed virtual value is equal to hir(t∗,t∗)
(t∗, t∗)],
f (t∗)
same for ˆq2 and ˇq2. Then (ˆq1, ˆq2, u) also corresponds to a mechanism. We can regard mechanism (q1, q2, u)
as a randomization between (ˆq1, ˆq2, u) and (ˇq1, ˇq2, u). By deﬁnition, we have

. Let ˆq1(t, t∗) = ˇq1(t, t∗), t /∈ [lmin

(t∗, t∗), lmax

1

2

(cid:90)

ˆq1(t)f (t)dt = 1 − (1 −

f (t)dt)n

(cid:90)

n

t∈[lmin

2

(t∗,t∗),b]

It means in the ex post allocation rule, when there is a type among lmin
ders with such types. So in mechanism (ˆq1, ˆq2, u), when the ironed virtual value is equal to hir(t∗,t∗)
f (t∗)
are priorities for types in [lmin

(t∗,t∗),b]
(t∗, t∗), b, we allocate it among bid-
, there
(t∗, t∗)]. Similar for item 2. Similar for mechanism (ˇq1, ˇq2, u).
˙pay(t)) denote the mechanism we construct. In fact Et−i ˙q1(ti, t−i) = q1(t1, t∗)]. The

Let ( ˙q1(t), ˙q2(t),

(t∗, t∗), lmax

2

2

2

2

t∈[lmin

payment rule is:

payi(ti, t−i) = (1 −

u(ti)
tiq1(ti, t∗) + b−ti

a q2(ti, t∗)

)(ti ˙q1(ti, t−i) +

b − ti
a

˙q2(ti, t−i))

This guarantees that ˙u(ti, t−i) is always nonnegative, and we have

Et−i ˙u(ti, t−i) =

u(ti)
tiq1(ti, t∗) + b−ti

a q2(ti, t∗)

Et−i(ti ˙q1(ti, t−i) +

b − ti
a

˙q2(ti, t−i)) = u(ti, t∗)

15

By Theorem 5.1, ( ˙q1(t), ˙q2(t),
˙pay(t)) is indeed an optimal IR and BIC mechanism. By [20], there is a DIC
and IIR mechanism achieves the same optimal revenue. However this mechanism in general does not satisfy
DIC and ex post IR at the same time. We will discuss this later in more details via an example.

6 An example where BIC differs from DIC in revenue, under ex post IR
6.1 Two bidders with uniform distributions
There are two i.i.d. bidders with uniform valuation v1 + v2 = 1, i.e. Fi(ti) = F (ti) = ti, ti ∈ [0, 1]. If
there is one such bidder, the optimal mechanism is trivial, i.e., to sell the items in a bundle at price 1. In
the two-bidder case, ﬁrst of all, consider optimal BIC and IIR mechanism. WLOG, we can restrict attention
to bidder-symmetric mechanism [21]. Note that if a mechanism is DIC and ex post IR, then there is also a
symmetric mechanism is DIC and ex post IR.

By our approach, one can show that t∗ must equal 1

2 in the optimal BIC and IIR mechanism. In the
optimal symmetric BIC and IIR mechanism, we ﬁrst prove the allocation rule and the expected utility are
ﬁxed in certain subset of types. From Equation (10), we have

0

(cid:90) 1
(cid:90) 1
(cid:90) 1
(cid:90) 1

0

0

0

(cid:90)

=

(cid:26) 2t

REV

2

=

≤

≤

q1(t)h(t,

1
2

) + q2(t)(1 − h(t,

))dt − u(

1
2

1
2

)

(q1(t) − q2(t))h(t,

1
2
(q1(t) − q2(t))hir(t,

) + q2(t)dt

) + q2(t)dt

1
2

(13)

(14)

q1(t)hir(t,

1
2

) + q2(t)(1 − hir(t,

1
2

))dt

 2t
(cid:90) t

t ∈ [0, 1/4)
t ∈ [1/4, 3/4]
1/2
2t − 1 t ∈ (3/4, 1]

where, h(t,

1
2

) =

t ∈ [0, 1/2]
2t − 1 t ∈ (1/2, 1]

hir(t) =

REV

2

=

[0,1/4]∪[3/4,1]

[

q1(s)ds +

q2(s)ds]dt

,

(cid:90) 1
(cid:90) t

t

and

0

0

q2(s)ds ≤ 1 − (1 − t)2

2

By Border’s Theorem

We have

t

(cid:90) 1

2

q1(s)ds ≤ 1 − t2
2 ≤(cid:82)

REV

To attain the revenue upper bound 29

24, (13)(14) and (15) must be equalities.

• Equality (13) requires u( 1
• Equality (14) requires q1(t) − q2(t) = 0, t ∈ ( 1

2 ) = 0.

4 , 3

4 ).

16

[0,1/4]∪[3/4,1]

2 + 1−(1−t)2
1−t2

2

dt = 29
48

(15)

• Equality (15) requires(cid:82) 1

2 , (cid:82) 1

t q1(s)ds = 1−t2
4 ]. This
further implies when the lower type is in [0, 1
4 , 1], the item is allocated to the bidder with a higher
type. In particular, q1(ti, 0) = 1 and q2(ti, 0) = 0 for t ∈ (0, 1]. Interim allocation rule in some
intervals is also ﬁxed,

t q1(s)ds = 1−t2
4 ]∪ [ 3

for almost every t /∈ [ 1

4 , 3

2

(cid:26) q1(t, 1
2 ) = t
2 ) = 1 − t
(cid:26) 3
16 − t + t2

q2(t, 1

u(t,

) =

1
2

0

t ∈ [0, 1/4] ∪ [3/4, 1]
t ∈ [0, 1/4] ∪ [3/4, 1]

t ∈ [0, 1/4] ∪ [3/4, 1]
t ∈ (1/4, 3/4)

However, interim allocation rule in interval [1/4, 3/4] is not fully ﬁxed. The expected utility function
is ﬁxed

We now show that there is a BIC and ex post IR mechanism that achieves the revenue bound. In the

following, we construct the ex post IR and BIC mechanism. The ex post allocation rule is

 1/2 t1 = t2 or (t1, t2) ∈ (1/4, 3/4) × (1/4, 3/4)

t1 > t2 and (t1, t2) /∈ (1/4, 3/4) × (1/4, 3/4)
o.w.

1(t1, t2) = q1
To satisfy the ex post IR constraint, the payment rule is a little tricky. We let it be the valuation multiplies

2(t1, t2) = q1

1(t1, t2) and q2

1(t1, t2).

Let q2
a factor β(t1) ∈ [0, 1], i.e.,

q1
1(t1, t2) =

1
0
2(t1, t2) = 1 − q2

pay1(t1, t2) = β(t1)(q1

1(t1, t2)(1 − t1))

where, β(t) =

u(t)

q1(t)t + q2(t)(1 − t)

=

t ∈ [0, 1/4] ∪ [3/4, 1]
t ∈ (1/4, 3/4)

It is easy to verify that u1(t1, t2) ≥ 0 and Et2u1(t1, t2) = u(t1).

To see this mechanism is not DIC, consider the case when t2 = 0. When t1 ∈ (0, 1], by deﬁnition we

1(t1, t2)t1 + q2

(cid:40) 3/16−t+t2

t2+(1−t)2
0

(cid:40) 3t1/16−t2

1+t3
1
1+(1−t1)2
t2

0

have (q1

1(t1, 0), q2

1(t1, 0)) = (1, 0), and
pay(t1, 0) = (1 − β(t1))t1 =

t1 ∈ [0, 1/4] ∪ [3/4, 1]
t1 ∈ (1/4, 3/4)

1(t1, 0), q2

1(t1, 0)) is constant (1, 0), but pay1

For t1 ∈ (0, 1], the allocation rule (q1
words, in this interval, the agent wants to report a type between (1/4, 3/4), where the payment is zero.
Theorem 6.1 No DIC and ex post IR auction achieves the revenue bound 29
24.
Proof. Suppose by contradiction that there exists a such mechanism. Since u( 1
that u1( 1
that ∂u(t1, 0)/∂t1 = q1(t1, 0) − q2(t1, 0) = 1, t1 ∈ (0, 1]. Thus u(t1, 0) = t1 − 1
ex post IR also requires u(t1, 0) ≥ 0, contradicts to the DIC constraint.

2 ) = 0, ex post IR implies
2 , 0) = 0. When t2 = 0, DIC constraint implies
2 , t1 ∈ (0, 1]. However,
(cid:117)(cid:116)

2 , t2) = 0 for type t2 ∈ [0, 1]. In particular, u1( 1

1(t1, 0) is not. In other

7 Acknowledgement

The authors would like to thank Weiran Shen, Yulong Zeng, and Song Zuo for helpful discussion. Part
of this work has been done while Pingzhong Tang was a participant of the Economics and Computation
program, Simon Institute, UC Berkeley. He beneﬁts from discussions with Nima Haghpanah and Christos
Tzamos on the single-bidder case.

17

References

[1] Mark Armstrong. 1996. Multiproduct nonlinear pricing. Econometrica: Journal of the Econometric

Society (1996), 51–75.

[2] Kim C Border. 1991. Implementation of reduced form auctions: A geometric approach. Econometrica:

Journal of the Econometric Society (1991), 1175–1187.

[3] Yang Cai, Constantinos Daskalakis, and S Matthew Weinberg. 2011. On optimal multidimensional

mechanism design. ACM SIGecom Exchanges 10, 2 (2011), 29–33.

[4] Yang Cai, Constantinos Daskalakis, and S Matthew Weinberg. 2012a. An algorithmic characteriza-
tion of multi-dimensional mechanisms. In Proceedings of the forty-fourth annual ACM symposium on
Theory of computing. ACM, 459–478.

[5] Yang Cai, Constantinos Daskalakis, and S Matthew Weinberg. 2012b. Optimal multi-dimensional
mechanism design: Reducing revenue to welfare maximization. In Foundations of Computer Science
(FOCS), 2012 IEEE 53rd Annual Symposium on. IEEE, 130–139.

[6] Yeon-Koo Che, Jinwoo Kim, and Konrad Mierendorff. 2011. Generalized Reduced-Form Auctions: A

Network-Flow Approach. University of Z¨urich. Technical Report. ECON-Working Papers.

[7] Jacques Cremer and Richard P McLean. 1988. Full extraction of the surplus in Bayesian and dominant

strategy auctions. Econometrica: Journal of the Econometric Society (1988), 1247–1257.

[8] Constantinos Daskalakis, Alan Deckelbaum, and Christos Tzamos. 2013. Mechanism design via opti-

mal transport. In ACM Conference on Electronic Commerce. 269–286.

[9] Constantinos Daskalakis, Alan Deckelbaum, and Christos Tzamos. 2015. Strong duality for a multiple-
good monopolist. In Proceedings of the Sixteenth ACM Conference on Economics and Computation.
ACM, 449–450.

[10] Claude d’Aspremont and Louis-Andr´e G´erard-Varet. 1979. Incentives and incomplete information.

Journal of Public economics 11, 1 (1979), 25–45.

[11] Alex Gershkov, Jacob K Goeree, Alexey Kushnir, Benny Moldovanu, and Xianwen Shi. 2013. On the
equivalence of Bayesian and dominant strategy implementation. Econometrica 81, 1 (2013), 197–220.

[12] Parikshit Gopalan, Noam Nisan, and Tim Roughgarden. 2015. Public Projects, Boolean Functions,
and the Borders of Border’s Theorem. In Proceedings of the Sixteenth ACM Conference on Economics
and Computation. ACM, 395–395.

[13] Nima Haghpanah and Jason Hartline. 2015. Reverse mechanism design. In Proceedings of the Six-

teenth ACM Conference on Economics and Computation. ACM, 757–758.

[14] Sergiu Hart and Noam Nisan. 2012. Approximate revenue maximization with multiple items. In ACM

Conference on Electronic Commerce. 656.

[15] Sergiu Hart and Philip Reny. 2012. Maximal Revenue with Multiple Goods: Nonmonotonicity and

Other Observations. Technical Report.

18

[16] Jason D. Hartline and Tim Roughgarden. 2009. Simple versus Optimal Mechanisms. In ACM EC.

[17] Jonathan Levin. 1997. An Optimal Auction for Complements. Games and Economic Behavior 18, 2

(February 1997), 176–192.

[18] Xinye Li and Andrew Chi-Chih Yao. 2013. On revenue maximization for selling multiple indepen-

dently distributed items. Proceeding of National Academy of Science (2013).

[19] Pinyan Lu, Xiaorui Sun, Yajun Wang, and Zeyuan Allen Zhu. 2010. Asymptotically optimal strategy-
proof mechanisms for two-facility games. In Proceedings of the 11th ACM conference on Electronic
commerce. ACM, 315–324.

[20] Alejandro M Manelli and Daniel R Vincent. 2010. Bayesian and Dominant-Strategy Implementation

in the Independent Private-Values Model. Econometrica 78, 6 (2010), 1905–1938.

[21] Eric S Maskin and John G Riley. 1984. Optimal Auctions with Risk Averse Buyers. Econometrica 52,

6 (November 1984), 1473–1518.

[22] Roger B. Myerson. 1981. Optimal Auction Design. Mathematics of Operations Research 6, 1 (1981),

58–73.

[23] Ariel D Procaccia and Moshe Tennenholtz. 2009. Approximate mechanism design without money. In

Proceedings of the 10th ACM conference on Electronic commerce. ACM, 177–186.

[24] Jean-Charles Rochet. 1985. The taxation principle and multi-time Hamilton-Jacobi equations. Journal

of Mathematical Economics 14, 2 (1985), 113–128.

[25] Jean-Charles Rochet and Philippe Chon´e. 1998. Ironing, sweeping, and multidimensional screening.

Econometrica (1998), 783–826.

[26] Zihe Wang and Pingzhong Tang. 2014. Optimal mechanisms with simple menus. In ACM EC. ACM,

227–240.

[27] Andrew Chi-Chih Yao. 2015. An n-to-1 bidder reduction for multi-item auctions and its applications.
In Proceedings of the Twenty-Sixth Annual ACM-SIAM Symposium on Discrete Algorithms. SIAM,
92–109.

19

A Appendix
A.1 Proof of Lemma 3.3
Proof. Since H ir(z) is convex, so ∂H ir

(cid:90) F −1(z)

∂z (z) is weakly increasing. We have

∂H ir
∂z

(z) = (

0

hir(s)ds)(cid:48) = hir(F −1(z))(F −1(z))(cid:48) =

hir(F −1(z))
f (F −1(z))

so hir(t)
f (t)

is weakly increasing as well.

A.2 Proof of Lemma 5.2
Proof. By deﬁnition,

(cid:90) F −1(z)

h(s, t∗)ds

H(z, t∗) =

(z, t∗) =

∂H
∂z
(F (t), t∗) =

∂H
∂z

0

h(F −1(z))
f (F −1(z))
h(t)
f (t)

(cid:26) tf (t) + F (t)

t ≤ t∗
tf (t) + F (t) − 1 t > t∗

Since

h(t, t∗) =

we have

> t∗ +
So point (F (t∗), H(F (t∗), t∗)) is above the convex hull.

(F (t∗), t∗) = t∗ +

∂−H
∂z

F (t∗)
f (t∗)

F (t∗) − 1

f (t∗)

=

∂+H
∂z

(F (t∗), t∗)

(cid:117)(cid:116)

(cid:117)(cid:116)

A.3 Proof of Lemma 5.4
Proof. We prove the right direction for q1, we consider the case t∗ ∈ (0, b) ﬁrst. A small lemma is required,

Lemma A.1 ∃ > 0, ∀t2 ∈ (t∗, t∗ + ), we have lmax

Second we prove when t2 is close to t∗, lmin

1

Lemma A.2 ∃ > 0, ∀t2 ∈ (t∗, t∗ + ), we have lmin
Lemma A.3 ∃ > 0, ∀t2 ∈ (t∗, t∗ + ), we have lmin

1

1

(t2, t2) < F (t∗).
(t2, t2) is close to lmax
(t2, t2) ≥ lmax
(t2, t2) ≤ lmax

1

1

1

1

Third we prove when t2 is close to t∗, lmin

2

Lemma A.4 ∃ > 0, ∀t2 ∈ (t∗, t∗ + ), we have lmin
Lemma A.5 ∃ > 0, ∀t2 ∈ (t∗, t∗ + ), we have lmin

2

2

(t2, t2) is close to lmax
(t2, t2) ≥ lmax
(t2, t2) ≤ lmax

2

2

2

(t∗, t∗).
(t∗, t∗).
(t∗, t∗) + .
(t∗, t∗).
(t∗, t∗)
(t∗, t∗) + .

20

2

2

(t∗, t∗), lmax

(t2, t2) ∈ [lmax

Combined above lemmas, ∃ > 0, ∀t2 ∈ (t∗, t∗ + ) we have lmin

(t∗, t∗) +
(t∗, t∗) + ]. By the deﬁnition of q1, ˆq1(t2, t2) can be arbitrarily
When t∗ = 0, the formula of the allocation rule might be different. But using the exact same method,

(t2, t2) ∈ [lmax
] and lmin
close to ˇq1(t∗, t∗). Also, ˆq1(t, t) is increasing in l1 and l2, so ˆq1(t2, t2) ≥ ˇq1(t∗, t∗).
we can prove q1(0, 0) = limt∗→0 q1(t∗, t∗).
as t∗ increases.

The left direction is similar. It is also similar for q2. To sum up the value intervals seamlessly connect
(cid:117)(cid:116)

(t∗, t∗), lmax

2

1

1

1

A.4 Proof of Lemma A.1
Proof.

Figure 2: Path L2 and the parallelogram

Look at the Fig 2, we put a parallelogram on point (F (t∗), H ir(F (t∗), t∗)). One edge is vertical and
one edge is on the boundary of H ir(z, t∗). The opposite point moves along the path L2(z, F −1(z) − t∗ +
H ir(z, t∗)), z > F (t)∗. We consider the ﬁrst parallelogram touches the curve H(z, t∗). Then the axis of
the opposite point is

l0 = max

x

{∀t ∈ [t∗, F −1(x)] H(F (t), t∗) ≥ H ir(F (t), t∗) + t − t∗}

We claim when t2 ∈ (t∗, F −1(l0)], lmax

(t2, t2) < F (t∗).

Otherwise, suppose lmax

1

1

(t2, t2) ≥ F (t∗). Since t2 > t∗, we have
(F (t2), t2) ≥ ∂H ir
∂z

(F (t∗), t2) >

∂H ir
∂z

∂H ir
∂z

(F (t∗), t∗)

Point A(lmax

(t2, t2), H(lmax

(t2, t2), t2)) and B(lmax

straight line which contains one of the edge of the parallelogram. Then point A is above the line L1

1

1

2

(t∗, t∗), H(lmax

(t∗, t∗), t2)). Let L1 denote the

2

2

H(lmax
= H(lmax
≤ H(lmax

2

2

(t∗, t∗), t2))
(t∗, t∗), t∗) + t2 − t∗
(t∗, t∗), t∗) + F −1(l0) − t∗

21

F(t*)HirHl1max(t*,t*)l2max(t*,t*)l0L1L2By deﬁnition of l0, we have H(l0, t∗) = H ir(l0, t∗) + F −1(l0) − t∗. So

H(lmax
≤ H(lmax

2

2

(t∗, t∗), t2))
(t∗, t∗), t∗) + H(l0, t∗) − H ir(l0, t∗)

This means point B is on or below line L1. For simplicity, we use (AB)(cid:48) and (L1)(cid:48) to denote the gradient
of line AB and line L1 respectively. Then

Contradiction.

A.5 Proof of Lemma A.2
Proof. First prove a gadget,

(AB)(cid:48) ≤ (L1)(cid:48)

⇒ ∂H ir
∂z
⇒ ∂H ir
∂z

(F (t2), t2) ≤ ∂H ir
∂z
(F (t2), t∗) ≤ ∂H ir
∂z

(F (t∗), t∗)
(F (t∗), t∗)

H(z, t2) = H(z, t∗)
H(z, t2) > H(z, t∗)
(F (t∗), t2) >

⇒ ∂H ir
∂z

z ∈ [0, F (t∗)]
z ∈ (F (t∗), 1]
(F (t∗), t∗)

∂H ir
∂z

(lmin

1

(t2, t2), t2)

(F (t2), t2)
(F (t∗), t2)
(F (t∗), t∗)

by(16)

∂+H ir

>

∂z
∂H ir
=
∂z
≥ ∂H ir
∂z
∂H ir
∂z
∂+H ir

=
∂z
≥ ∂−H ir
∂z
∂−H ir

=

∂z

(lmax

1

(lmax

1

(lmax

1

(t∗, t∗), t∗)
(t∗, t∗), t∗)
(t∗, t∗), t2)

(H ir is the covex hull.)

Thus lmin

1

(t2, t2) ≥ lmax

1

(t∗, t∗).

A.6 Proof of Lemma A.3
Proof. Consider the following three points:

A(lmax

1

(t∗, t∗), H(lmax

1

(t∗, t∗), t∗)))

22

(cid:117)(cid:116)

(16)

(cid:117)(cid:116)

1

B(lmin
C(lmax

(t2, t2), H(lmin
(t∗, t∗), H(lmax

1

(t2, t2), t2)))
(t∗, t∗), t2)))

2

2

Points A,B and C all lie on curve (z, H ir(z, t2)). By convexity, we know

(AB)(cid:48) ≤ (AC)(cid:48)

Let M (z, t∗), z ∈ [0, F (t∗)] be the largest convex function under H(z, t∗), z ∈ [0, F (t∗)]. Note
(t∗, t∗))), H(z, t2) = H(z, t∗), z ∈ [0, F (t∗)]. We must have M (z, t∗) ≥

that any t2 ∈ (t∗, F −1(lmin
H ir(z, t2), z ∈ [0, F (t∗)].

2

(t2, t2) < F (t∗). Then M (lmin

1

(t2, t2), t∗) ≥

By Lemma A.1, we can pick t2 which is small enough so that lmax
1

(t2, t2), t2). By deﬁnition of M,

1

H(lmin

1

H(lmin
≥ M (lmin
≥ H(lmin
= H(lmin

1

1

1

(t2, t2), t∗)
(t2, t2), t∗)
(t2, t2), t2)
(t2, t2), t∗)

Thus all the inequalities become equalities. Point B must lie on curve M (z, t∗).
(t∗, t∗) + , t∗)), we must have

(t∗, t∗) + , M (lmax

Consider point D(lmax

1

1

(AD)(cid:48) ≤ (AB)(cid:48)

, furthermore (AD)(cid:48) ≤ (AC)(cid:48).

H ir(lmax

1

(t∗, t∗) + , t∗) − H(lmax

1



(t∗, t∗), t∗)

2

≤ H(lmax

(t∗, t∗), t2) − H(lmax
lmax
2

(t∗, t∗) − lmax
(t∗, t∗), t2) on the right hand side.

1

1

(t∗, t∗)

(t∗, t∗), t∗)

We transform the inequation and leave only H(lmax

2

W1(, t∗) ≤ H(lmax
W1(, t∗) ≤ H(lmax

2

2

(t∗, t∗), t2)
(t∗, t∗), t∗) + t2 − t∗

We transform the inequation and leave only t2 on the right hand side.

W2(, t∗) ≤ t2

lmax
1

Where W1 and W2 are functions of  and t∗. So as long as t2 < W2(, t∗), we have lmin
(t∗, t∗) + 
Consider point E(lmax

(t∗, t∗), H(lmax
(t∗, t∗) + , t∗) − H(lmax

(t∗, t∗), t∗)), we have (AD)(cid:48) > (AE)(cid:48), i.e.
(t∗, t∗), t∗)

H(lmax

(t∗, t∗), t∗)

2

2

1

H ir(lmax

1

1

>

2

(t2, t2) ≤



(t∗, t∗), t∗) − H(lmax
lmax
2

(t∗, t∗) − lmax

1

1

(t∗, t∗)
(t2, t2) ≤ lmax

1

(t∗, t∗) + . (cid:117)(cid:116)

Then we get W2(, t∗) > t∗. So as long as t2 ∈ (t∗, W2(, t∗)), we have lmin

1

23

Figure 3: Six points

A.7 Proof of Lemma A.4
Proof. By Lemma A.1, we can pick t2 > t∗ which is small enough so that

(t∗, t∗)
(t2, t2) < F (t∗)

F (t2) < lmin
lmin
1

2

We claim that lmin

2

(t2, t2) ≥ lmax

2

1

1

1

(t∗, t∗). Suppose not, consider the following six points in Fig 3.
A(lmax
B(lmin
C(lmin
D(lmax
E(lmin
F (lmax

(t∗, t∗), H(lmax
(t2, t2), H(lmin
(t2, t2), H(lmin
(t∗, t∗), H(lmax
(t2, t2), H(lmin
(t∗, t∗), H(lmax

(t∗, t∗), t∗))
(t2, t2), t∗))
(t2, t2), t2))
(t∗, t∗), t2))
(t2, t2), t∗))
(t∗, t∗), t∗))

2

2

1

2

2

2

2

2

2

Because lmin
(t∗, t∗) > F (t2), we have

(t2, t2) < lmax

2

2

lmax
2

(t∗, t∗), point C is on the left of point D. Since lmin

2

(t2, t2) > F (t2) and

H(z, t2) − H(z, t∗) = F (t2) − F (t∗), z > F (t2)

Thus CDF E is parallelogram.

= (AF )(cid:48)

∂H ir(F (t∗), t∗)
≥ (EF )(cid:48) = (CD)(cid:48)
≥ (BC)(cid:48) =

∂z

∂H ir(F (t∗), t∗)

∂z

>

∂H ir(F (t∗), t2)

∂z

Contradiction. So as long as t2 is small enough such that F (t2) < lmin
have lmin

(t2, t2) ≥ lmax

(t∗, t∗).

2

2

2

24

(t∗, t∗) and lmin

1

(t2, t2) < F (t∗), we
(cid:117)(cid:116)

A(l1max(t*,t*))B(l1min(t2,t2))F(l2max(t*,t*))E(l2min(t2,t2))CDHHirA.8 Proof of Lemma A.5
(t∗, t∗)+
Proof. For any  > 0, consider the boundary straight line on which point (lmax
, t∗)) lies. This line might be a point or a line segment. Let point (l3, H ir(l3, t∗)) denote the left endpoint
of this line. If this line is a point, then l3 equals lmax

(t∗, t∗) + . Formally,

(t∗, t∗)+, H ir(lmax

2

2

2

l3 = min

(z, t∗) =
(t∗, t∗). Choose t2 ∈ (t∗, F −1(lmin

{ ∂+H ir
∂z

z

2

∂+H ir

(lmax

2

(t∗, t∗) + , t∗)}

∂z
(t∗, t∗))), if lmin

2

(t2, t2) > l3, consider the following

Then l3 ≥ lmax
ﬁve points:

2

(t2, t2), H(lmin

1

(t2, t2), t2))

1

A(lmin
B(l3, H(l3, t2))
C(lmin
D(l3, H(l3, t∗))
E(lmin

2

2

(t2, t2), H(lmin

2

(t2, t2), H(lmin

2

(t2, t2), t2))

(t2, t2), t∗))

Since lmin

2

(t2, t2) > F (t2), and l3 > F (t2), we have

H(z, t2) − H(z, t∗) = F (t2) − F (t∗)

Then BCED is a parallelogram.
(BC)(cid:48).

By the deﬁnition of points A and C, we know point B is above the line AC. So (BA)(cid:48) > (AC)(cid:48) >

(BC)(cid:48) = (DE)(cid:48) ≥ ∂+H ir
∂z

(l3, t∗) =

∂+H ir

∂z

By Lemma A.1, we can choose t2 small enough such that lmin

1

2

(t∗, t∗) + , t∗)
(lmax
(t2, t2) < F (t∗), then

H(lmin

1

(t2, t2), t2) = H(lmin

1

(t2, t2), t∗)

Thus, we have

(BA)(cid:48) =

=

H(l3, t2) − H(lmin

l3 − lmin

1

1
(t2, t2)

(t2, t2), t2)

F (t2) − F (t∗) + H(l3, t∗) − H(lmin

1

(t2, t2), t∗)

(BCDE is parallelogram)

l3 − lmin

1

(t2, t2)

By (BA)(cid:48) > (BC)(cid:48), we have

F (t2) − F (t∗) + H(l3, t∗) − H(lmin

1

l3 − lmin

1

(t2, t2)

(t2, t2), t∗)

≥ ∂+H ir
∂z

(lmax

2

(t∗, t∗) + , t∗)

F (t2) − F (t∗) ≥ [l3 − lmin
+H(lmin

1

(t2, t2)] · ∂+H ir
(lmax
∂z
(t2, t2), t∗) − H(l3, t∗)

2

1

(t∗, t∗) + , t∗)

25

{(l3 − z) · ∂+H ir
≥ min
z≤F (t∗)
∂z
+H(z, t∗) − H(l3, t∗)}

= W (, t∗)

(lmax

2

(t∗, t∗) + , t∗)

We let W (, t∗) denote the minimum part. Hence if F (t2) − F (t∗) < W (, t∗), we have

lmin
2

(t2, t2) ≤ l3 ≤ lmax

2

(t2, t2) + 

Next we prove W (, t∗) > 0. By deﬁnition of l3, for any z ∈ [0, l3), point (z, H(z, t∗)) is above the

straight line that goes through point (l3, H ir(l3, t∗)) with gradient g = ∂+H ir

(lmax

2

∂z

(t∗, t∗) + , t∗). So

H(z, t∗) > H(l3, t∗) + (z − l3)g

So W (, t∗) ≥ 0. Suppose W (, t∗) = 0. Since (l3−z)g+H(z, t∗)−H(l3, t∗) is a continuous function of z,
then there exists z0 such that (l3− z0)g + H(z0, t∗)− H(l3, t∗) = 0, which means (z0, H(z0, t∗)) lies on the
straight line that goes through point (l3, H ir(l3, t∗)) with gradient g. Contradiction. Hence W (, t∗) > 0.
(cid:117)(cid:116)
To sum up, as long as t2 < F (t∗) + W (, t∗), we have lmin

(t2, t2) ≤ lmax

(t∗, t∗) + .

1

2

26

