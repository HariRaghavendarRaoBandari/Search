MINIMIZING MOVEMENT FOR A FRACTIONAL POROUS

MEDIUM EQUATION IN A PERIODIC SETTING

Lucas C. F. Ferreira, Matheus C. Santos and Julio C. Valencia-Guevara

6
1
0
2

 
r
a

 

M
0
1

Abstract

We consider a fractional porous medium equation that extends the classical porous medium
and fractional heat equations. The ﬂow is studied in the space of periodic probability measures
endowed with a non-local transportation distance constructed in the spirit of the Benamou-Brenier
formula. For initial periodic probability measures, we show the existence of absolutely continu-
ous curves that are generalized minimizing movements associated to R´enyi entropy. For that, we
need to obtain entropy and distance properties and to develop a subdiﬀerential calculus in our setting.

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
3
9
3
3
0

.

3
0
6
1
:
v
i
X
r
a

1

Introduction

We are concerned with the fractional porous medium equation (FPME)

∂tρ + (−∆)σρm = 0 and ρ(0, x) = ρ0(x)

(1.1)

where the spatial-dimension d ≥ 1, 0 < σ < 1 and m∗ := (d−2σ)+
< m 6 2. Our aim is to study the
global ﬂow ρ = ρt(x) with spatial-periodic conditions, i.e. (t, x) ∈ [0, +∞) × Td (Td is the d-dimensional
torus). We use an optimal transport approach on the space P(Td) equipped with a pseudo-metric W to
ﬁnd a generalized minimizing movement curve associated to the R´enyi entropy, which gives us a weak
notion of gradient ﬂow for (1.1).

d

The equation (1.1) appears in the study of hydrodynamic limits of particle systems [18], the boundary
heat control problems as studied by Athanasopoulos and Caﬀarelli [5], and the so-called anomalous
diﬀusion process that appears when jump processes are introduced in the modeling (see [1, 23, 24]). In
[11, 12], the authors studied the model (1.1) and developed a theory for the problem in Rd and with
general initial data ρ0 ∈ L1(Rd) that includes also sign changing solutions. For the case σ = 1/2 they
constructed a weak solution by rewriting the non-local problem in a local way by mean of a well known
harmonic extension. The general case was treated in [12] by approximating the initial data by bounded
functions and approximating Rd by bounded domains. Existence and uniqueness results are true for
any positive value m of the nonlinearity if the initial data is, for example, also bounded, but the full
theory only works for values of m larger than the critical value m∗. In this case, if we take a nonnegative
integrable initial data ρ0, then conservation of mass, positivity and regularity hold. Let us observe that,
for the sake of coherence, we are assuming m∗ < m 6 2 in order to assure mass and sign conservation for
(1.1), however most of arguments and results in this paper hold true for the full range m ∈ (0, 2].

The optimal transport approach was used by [20] in the analysis of solutions to the classical porous

medium equation

∂tρ = ∆ρm = ∇ · (ρ∇U′(ρ)),

U (ρ) =

1

m − 1

ρm.

(1.2)

Departamento de Matem´atica - IMECC, Universidade Estadual de Campinas, 13083-859, Campinas-SP, Brazil.
Email addresses: lcﬀ@ime.unicamp.br (LCFF), msantos.ufrgs@gmail.com (MCS), ra099814@ime.unicamp.br (JCV-G)
March 11, 2016

1

It was showed that solutions to this equation can be interpreted as a gradient ﬂow t 7→ ρt(x)dx of
probabilities on P(Rd) associated to the R´enyi entropy

Um(ρ) :=

1

m − 1ZRd

ρ(x)m dx

with respect to (w.r.t. for short) the L2-Wasserstein distance W2, which is deﬁned by

W2(µ0, µ1) :=

π∈Γ(µ0,µ1)(cid:18)ZRd×Rd |x − y|2 dπ(x, y)(cid:19)1/2

inf

, for all µ0, µ1 ∈ P(Rd),

where Γ(µ0, µ1) is the set of probability measures π on Rd × Rd with marginals µ0 and µ1. This method
has allowed one to obtain uniqueness, well-posedness and asymptotic behavior of solutions (such as
contraction property and rates for the entropy decay) to the porous medium and to a number of other
equations (see e.g.
[2],[22],[4],[19]). See also [10], [17] and [16] for periodic solutions of PDEs without
fractional Laplacian. Besides that, the use of the entropy and the optimal transport distance also have
provided a powerful method to prove existence of solutions by the so-called Minimizing Movement Scheme
(in the general metric framework as considered in [4]) or JKO-scheme (in the Wasserstein space P2(Rd)
used in [19, 4, 9, 13, 7] and many others).
In the metric approach, that is obtained in the following
way (see [4]):
if (X, d) is a complete metric space and we consider a lower semicontinuous functional
E : X → (−∞,∞], then for an initial data u0 ∈ X and time step τ > 0, we can consider the implicit
discrete scheme deﬁned by



u0 := u0

un ∈ arg min(cid:18)E(u) +

d2(u, un−1)

2τ

(cid:19) , n > 1

(1.3)

that is, un is any minimizer for the functional u 7→ E(u) + d2(u,un−1)
. Deﬁning the piecewise constant
curve uτ (t) = un if t ∈ [nτ, (n + 1)τ ), then a limit curve u : [0,∞) → X of uτ as τ → 0 (up to a
subsequence) is called a generalized minimizing movement curve (GMM curve) starting from u0 and it
is a weak notion of gradient ﬂow for E.

2τ

A slightly diﬀerent notion of gradient ﬂow in metric spaces involves the concept of curves of maximal
slope w.r.t. upper gradient (see [4]): we say that a function g deﬁned on the metric space is an upper
gradient for the entropy E if, for all absolutely continuous curve v : [0,∞) 7→ X, one has |(E ◦ v)′(t)| 6
g(v(t))|v′|(t), where |v′|(t) denotes the metric derivative. And we say that an absolutely continuous curve
u : [0,∞) 7→ X is a curve of maximal slope for E w.r.t the upper gradient g if

d
dtE(u(t)) ≤ −

g(u(t))2

2

− |u′|2(t)

2

,

for almost t ∈ [0,∞).

(1.4)

Let us comment that if we consider the Wasserstein space (P2(Rd), W2), then the inequality (1.4) becomes
essentially equivalent to the continuity equation of the curve u(t). In the most of cases this continuity
equation becomes the partial diﬀerential equation that gives birth to the functional considered. Another
way to explain the relation between the equation (1.2) and the Wasserstein distance (specially in the case
where the velocity ﬁeld is a gradient vector ﬁeld) can be seen by the dynamic characterization of W2,
which is known as Benamou-Brenier formula (see [6]):

where CE 1(¯µ0, ¯µ1) is the set of all suﬃciently smooth pairs (µt, vt)t∈[0,1] such that

W2(¯µ0, ¯µ1)2 =

inf

(µ,v)∈CE 1(¯µ0,¯µ1)(cid:26)Z 1
(cid:26) ∂tµt + ∇ · (µt∇vt) = 0 ,

µ0 = ¯µ0 ,

µ1 = ¯µ1

0 ZRd |∇vt(x)|2 dµt(x)dt(cid:27)

in (0, 1) × Rd

As in [14, 15], we use these ideas to deﬁne a metric, in a Benamou-Brenier style, on a subset of P(Td)
that incorporates the non-local character of the problem (1.1) and we use it to construct a gradient ﬂow

2

associated to the R´enyi entropy. For that matter, we need to obtain properties for the non-local metric
and entropy, and develop a subdiﬀerential calculus in our setting.

In [15], the author showed that solutions to the fractional linear heat equation (i.e. m = 1)

∂tρ + (−∆)σρ = 0 in (0,∞) × Rd and ρ(0, x) = ρ0

(1.5)

can be seen as a gradient ﬂow in a non-local metric (built from a L´evy jump kernel) by using, among
others, that (1.5) generates a well-behaved semigroup. Due to the presence of (−∆)σ in (1.1), we are
led to consider some ideas from [15]. However, we adopt a periodic setting that allows us to obtain the
necessary compactness and convergence of the discrete scheme (1.3). So, we are moving in the opposite
direction from that of [15] in the sense that we are constructing a ﬂow for (1.1) via the scheme (1.3), and
not using previously known information about existence of solutions.

Let us just mention that we consider the d-dimensional torus Td as the cube [0, 1)d equipped with the

metric dTd deﬁned by

dTd (x, y) = min

k∈Zd |x − y + k|.

(1.6)

From [21] we know that, if f : Td → R is suﬃciently smooth, the following pointwise formula holds

for the fractional Laplacian on the torus:

(−∆)σf (x) = p.v.Z[0,1)d

(f (x) − f (y)) K σ(x − y) dy

where the kernel K σ is Zd-periodic and deﬁned by

K σ(x) := Cd,σ Xk∈Zd

1

|x + k|d+2σ , with Cd,σ :=

4σΓ(cid:0) d

2 + σ(cid:1)

πd/2 |Γ(−σ)|

.

Motivated by that, let us call ρ : (0,∞) × Td → R (in some suitable class) a weak solution to (1.1) if, for
all ϕ ∈ C∞c ((0, T ); C∞(Td)), one has

∂tϕt(x)ρt dxdt−

(ϕt(x)− ϕt(y))(ρt(x)m− ρt(y)m)K σ(x− y) dx dydt = 0 (1.7)

0 Z[0,1)d
Z T

where

1

0 ZG([0,1)d)
2Z T
G([0, 1)d) := {(x, y) ∈ [0, 1)d × [0, 1)d | x 6= y}.

(1.8)

(1.9)

(1.10)

Throughout the paper, we denote by ∇f the discrete gradient

∇f (x, y) := f (y) − f (x), for all f : Rd → R.

Thus, if m 6= 1, we can rewrite (1.7) as

Z T
0 Z[0,1)d

∂tϕt(x)ρt dxdt =

=

=

Um(s) :=

sm
m − 1

t

t

K σ(x − y) dxdydt

t

1

1

1

∇ρm
∇ρm−1

t K σ(x − y) dxdydt

2Z T
0 ZG([0,1)d) ∇ϕt∇ρm
2Z T
0 ZG([0,1)d) ∇ϕt∇ρm−1
2Z T
0 ZG([0,1)d) ∇ϕt∇U′m(ρt)bρmK σ(x − y) dxdydt
and bρm(x, y) :=

∇ρm(x, y)
∇ρm−1(x, y)

m − 1
m

.

3

where

If m = 1 we have the same representation if we deﬁne

Therefore, we can write (1.10) formally as

U1(s) := s log s and bρ1(x, y) := ∇ρ(x, y)

∇ log ρ(x, y)

.

which resembles the classical porous medium equation given in (1.2).

∂tρ − ∇ · (cρm∇U′m(ρ)) = 0

This paper is organized as follows. In Section 2 we give some basic deﬁnitions and notations. Section
3 is devoted to the action functional A(µ, ν) and its properties. Some results about a periodic non-local
continuity equation are presented in Section 4. In Section 5 we deﬁne the periodic non-local Wasserstein
distance W based on the Benamou-Brenier formula and show some of its properties.
In Section 6 a
subdiﬀerential calculus is constructed in the periodic Wasserstein space P(Td) endowed with the non-
local metric W. In Section 7 we show the existence of GMM curves associated to (1.1).

2 Notation and preliminaries

In this section, we make some deﬁnitions and remarks about the notation that will be used in the

sequel.

Following [17], we deﬁne the equivalence relation in P(Rd) given as

µ1, µ2 ∈ P(Rd). µ1 ∼ µ2 ≡ZRd

ζ(x) dµ1(x) =ZRd

ζ(x) dµ2(x) ,∀ ζ ∈ C(Td),

where C(Td) stands for the space of continuous functions in Rd which are Zd-periodic. Then, it is well
known that P(Td) = P(Rd)/ ∼.

Considering the set

and the space of functions

G(Rd) = {(x, y) ∈ Rd × Rd | x 6= y}

we can analogously deﬁne the equivalence relation

Cc(G(Td)) = {ϕ ∈ C(G(Rd)) | min{|x − y| | (x, y) ∈ supp (ϕ)} > 0 , ϕ is (Zd × Zd)-periodic} ,
ν1, ν2 ∈ M0(Rd) ν1 ∼ ν2 ≡ZG(Rd)

ϕ(x, y)dν1(x, y) =ZG(Rd)

ϕ(x, y)dν2(x, y) ,∀ ϕ ∈ Cc(G(Td)),

where

M0(Rd) :=(ν ∈ Mloc(G(Rd)) | ZG(Rd)

(1 ∧ |x − y|) d|ν|(x, y) < ∞) ,

and Mloc(G(Rd)) stands for the locally ﬁnite Radon measures on G(Rd). It is straightforward to check
that

M0(Td) ≃ M0(Rd)/ ∼

where

M0(Td) :=(ν ∈ Mloc(G([0, 1)d)) | ZG([0,1)d)

dTd (x, y) d|ν|(x, y) < ∞) ,

(2.1)

and Mloc(G([0, 1)d)) denotes the set of locally ﬁnite signed Radon measure deﬁned in the Borelians of
G([0, 1)d), deﬁned in (1.8), that are generated by dTd .

4

Next, ∀ζ ∈ C(Td), ∀[µ] ∈ P(Td) we deﬁneRTd ζ d[µ] :=RRd ζ dµ. In particular, since there exists only

one µ ∈ P(Rd) such that supp µ ⊆ [0, 1)d e µ ∼ µ (see [10, 17]), we actually have

ZTd

ζ d[µ] =Z[0,1)d

ζ dµ.

The measure µ can be obtained by

µ(B) := Xk∈Zd

µ(B + k) ,

for all Borelians B ⊆ [0, 1)d,

which is the push-forward of µ by the map T : Rd → [0, 1) deﬁned by T (x1, . . . , xd) := (x1−⌊x1⌋, . . . , xd−
⌊xd⌋), where ⌊.⌋ is the greatest integer function.

Analogously, for ϕ ∈ Cc(G(Td))and [ν] ∈ M0(Td) we deﬁne

ZG(Td)

ϕ d[ν] :=ZG(Rd)

ϕ dν.

In particular, the integrability condition in (2.1) allows us to use the push-forward by T and obtain that
there exists ν ∈ Mloc(G(Rd)) such that supp ν ⊆ G([0, 1)d) and ν ∼ ν. Therefore

ZTd

ϕ d[ν] =ZG([0,1)d)

ϕ dν.

Let us recall the narrow convergence in P(Td) which will be used in the results of compactness. In

fact, this topology coincides with the weak-∗ topology induced by the dual of C(Td).
Deﬁnition 2.1. We say that a sequence (µn)n ⊆ P(Td) weakly (narrowly) converges to µ ∈ P(Td) if

Z[0,1)d

ϕ(x) dµn(x) →Z[0,1)d

ϕ(x) dµ(x) , ∀ ϕ ∈ C(Td).

Remark 2.2. Note that the cube [0, 1)d with the torus metric dTd (see (1.6)) is a compact metric space
and therefore, by Prokhorov’s Theorem, P(Td) is a weakly compact space.

3 The action functional

The weak formulation given in (1.10) for the fractional porous medium equation leads us to the following
function, which is used there as a mean for probability densities between any two diﬀerent points. We
deﬁne the m-mean θm : [0,∞) × [0,∞) → [0,∞) by

and extended by continuity to s = t. The function θm : [0,∞)2 → [0,∞) satisﬁes the following integral
representation

else,

m − 1
m

s − t
,
log s − log t
sm − tm
sm−1 − tm−1 ,

θm(s, t) :=
θm(s, t) =
Z 1
Z 1
0 (cid:0)(1 − α)sm−1 + αtm−1(cid:1) 1

sαt1−α dα ,

0

5

if m = 1

for s 6= t ,

if m = 1

if m 6= 1

m−1 dα ,

and the following properties for 0 < m 6 2:

1. Symmetry: θm(s, t) = θm(t, s);

2. Homogeneity: θm(λs, λt) = λθm(s, t), for all λ > 0;

3. Concavity: θm is concave for 0 < m 6 2;

4. Monotonicity: If m1 < m2 then θm1 (s, t) < θm2(s, t) for all s, t > 0;

5. Monotonicity: If 0 6 s1 6 s2 and t > 0 then θm(s1, t) 6 θm(s2, t);

6. Boundary values: θm(0, t) = 0 for all t > 0 if and only if m 6 1. For 1 < m 6 2, we have

θm(0, t) = m−1

m t, for all t > 0.

Given a probability density ρ(x)dx ∈ P(Td), we use the following notation for the m-mean of ρ

between any two points (x, y) ∈ Td × Td:

bρm(x, y) := θm(ρ(x), ρ(y)).

Let us deﬁne now the action functional that will be used in the dynamic deﬁnition of the non-local
fractional Wasserstein distance. Just for a moment, let us write the torus as the cube [0, 1)d with its
Borelians deﬁned by the metric dTd .
Deﬁnition 3.1. Given (µ, ν) ∈ P([0, 1)d) × Mloc(G([0, 1)d)), we deﬁne µ1, µ2 ∈ Mloc(G([0, 1)d)) by

dµ1(x, y) = K σ(x − y) dy dµ(x) , dµ2(x, y) = K σ(x − y) dx dµ(y) ∈ Mloc(G([0, 1)d))

Now, let λ ∈ Mloc(G([0, 1)d)) be a nonnegative Borelian measure such that µ1, µ2 and ν are absolutely
continuous with respect to λ with dµ1 = ρ1dλ, dµ2 = ρ2dλ and dν = wdλ. The measure λ can be taken
as |µ1| + |µ2| + |ν|, for examle. Then we deﬁne the action A by
w(x, y)2

1

A(µ, ν) :=

2ZG([0,1)d)

θm(ρ1(x, y), ρ2(x, y))

dλ(x, y)

Remark 3.2. We should mention that the action functional does depend on the order σ of the fractional
Laplacian and also on the nonlinearity m, although we will not mention them in the notation in order to
keep it clearer.

This functional is well deﬁned since the integrand is positively 1-homogeneous.

Let us show that for m = 1 the present case is the natural periodization of the one deﬁned in [15].

Given µ ∈ P(Rd), we can deﬁne

dµ1(x, y) =

Cd,σ

|x − y|d+2σ dydµ(x) ∈ Mloc(G(Rd))

and consider the respective equivalent classes [µ] and [µ1]. Therefore, if ϕ ∈ Cc(G(Td)), we can write for
all x ∈ Rd

ϕ(x, y)K σ(x − y) dy

6

ZRd\{x}

ϕ(x, y)

|x − y|d+2σ dy = Xk∈ZdZ([0,1)d+k)\{x}
ϕ(x, y) Xk∈Zd

=Z[0,1)d\{x}
Cd,σZ[0,1)d\{x}

=

1

ϕ(x, y)

|x − y|d+2σ dy = Xk∈ZdZ[0,1)d\{x}
|x − y + k|d+2σ dy

1

ϕ(x, y − k)
|x − y + k|d+2σ dy

and then

ZG(Td)

ϕ(x, y) d[µ1](x, y) =ZG(Rd)

ϕ(x, y) dµ1(x, y)

=ZRdZRd\{x}
=ZRdZ[0,1)d\{x}
=Z[0,1)dZ[0,1)d\{x}
=ZG([0,1)d)

Cd,σ

|x − y|d+2σ ϕ(x, y) dy dµ(x)
ϕ(x, y)K σ(x − y) dy dµ(x)

ϕ(x, y)K σ(x − y) dy dµ(x)

ϕ(x, y)K σ(x − y) dy dµ(x)

Therefore, we can write d[µ1](x, y) = K σ(x − y) dy d[µ](x). Analogously we deﬁne d[µ2](x, y) = K σ(x −
y) dx d[µ](y).

From now onwards we denote any equivalence class in P(Td) or Mloc(G(Td)) by its representative
element with support in [0, 1)d, and thus, we skip the bracket notation. Also, in order to simplify the
notation, we will denote by dK σ(x, y) the locally ﬁnite measure K σ(x − y)dxdy ∈ Mloc(G([0, 1)d)).

A key ingredient to working with the action functional and later with the Minimizing Movement
Scheme is the lower semi-continuity property. This is a direct consequence of the following more general
result that can be found in [8].
Lemma 3.3. Let Ω be a locally compact Polish space and f : Ω×Rn → [0, +∞] be a lower semicontinuous
function such that f (z,·) is convex and positively 1-homogeneous for every z ∈ Ω. Then the functional
F : Mloc(Ω)n → [0, +∞] deﬁned by

F (σ1, . . . , σn) =ZΩ

f (z, h1(z), . . . , hn(z)) dλ(z) ,

where λ ∈ Mloc(Ω) is such that dσi = hi(z)dλ, for 1 6 i 6 n, is weak* lower semicontinuous on Mloc(Ω).

The results contained in the next lemma are periodic analogous to the ones obtained in [15] for the

equivalent problem in Rd.
Lemma 3.4. The action functional A is convex in P(Td)×Mloc(G(Td)). Also, it is lower semicontinuous,
i.e., if µn → µ weakly and νn → ν weakly*, then

A(µ, ν) 6 lim inf

n→∞ A(µn, νn).

Furthermore, for any dµ = ρ(x) dx and ν ∈ Mloc(G(Td)) such that A(µ, ν) < ∞, there exists a function

w : G([0, 1)d) → R such that ν = wbρmdK σ and

1

A(µ, ν) =

2ZG([0,1)d) |w(x, y)|2bρm(x, y)dK σ(x, y).

Proof. The convexity is clear from the fact that θ is concave and (x, y) 7→ x2/y is convex and
decreasing in y. The lower semicontinuity follows from Lemma 3.3 for Ω = G([0, 1)d), f (z, h1, h2, h3) :=
|h3|2θm(h1, h2)−1 and noting that µi,n ∗⇀ µi for i = 1, 2 if µn ⇀ µ. Thus

A(µ, ν) = F (µ1, µ2, ν) =

f (ρ1, ρ2, w) dλ

1

2ZG([0,1)d)

is lower semicontinuous w.r.t. the weak-weak* convergence.

7

The second claim follows from a similar proof as the one in [15, Lemma 2.3] and it is left to the reader.

The following lemma will be useful in order to provide uniform estimates that will be needed in several

results in the sequel.

Lemma 3.5. There exists a constant C > 0 such that

ZG([0,1)d)

dTd (x, y)|ν|(x, y) 6 CpA(µ, ν),

for all µ ∈ P(Td) and ν ∈ Mloc(G(Td)). Also, for every Borelian F ⊆ G(Td) such that δ :=
inf{dTd(x, y) : (x, y) ∈ F} > 0, there exists a constant C = C(δ) such that

Now, let λ ∈ Mloc(G(Td)) such that µ1, µ1, ν ≪ λ with dµi = ρidλ for i = 1, 2 and dν = wdλ. If

1

1

w2

d(x, y) d|ν|.

δ d|ν| 6

|ν|(F ) 6 CpA(µ, ν).
δZF
δZF
θm(ρ1,ρ2) = ∞o(cid:17) = 0 and thus
dTd (x, y)p2θm(ρ1, ρ2)s w2
Td (x, y)θm(ρ1, ρ2) dλ! 1

dTd (x, y)|w(x, y)| dλ

d2

Proof. We start by estimating

|ν|(F ) =

ZG([0,1)d)

A(µ, ν) < ∞ then λ(cid:16)n(x, y) ∈ G(Td) |
dTd (x, y) d|ν| =ZG([0,1)d)
=ZG([0,1)d)
6 2ZG([0,1)d)
= CpA(µ, ν),
Td (x, y)θm(ρ1, ρ2) dλ 6ZG([0,1)d)
2ZG([0,1)d)
2ZG([0,1)d)
=ZG([0,1)d)
x∈[0,1)dZ[0,1)d

ZG([0,1)d)

6 sup

d2

+

6

1

1

where C is the constant that appears in the following estimate:

2θm(ρ1, ρ2)

dλ

2 ZG([0,1)d)

w2

2θm(ρ1, ρ2)

2

dλ! 1

(3.1)

d2
Td (x, y)

ρ1 + ρ2

2

dλ

d2
Td (x, y)K σ(x − y) dydµ(x)
d2
Td (x, y)K σ(x − y) dxdµ(y)

d2
Td (x, y)K σ(x − y) dydµ(x)

d2
Td (x, y)K σ(x − y) dy =: C.

(3.2)

8

We can see that C is ﬁnite by using that dTd (x, y) 6 mink∈Zd{|x − y + k|} 6 1 and

Z[0,1)d

d2

1

Td (x, y)K σ(x − y) dy 6 Cd,σZ[0,1)d X|k|61
+ Cd,σZ[0,1)d X|k|>1
6 Cd,σZ|x−y|62√d
+ Cd,σZ|x−y|>2√d
= Cd,σZ|y|62√d

1

1

|x − y + k|d+2σ−2 dy
|x − y + k|d+2σ dy
|x − y|d+2σ−2 dy
|x − y|d+2σ dy
|y|d+2σ−2 dy + Cd,σZ|y|>2√d

1

1

< ∞

1

|y|d+2σ dy

4 The non-local continuity equation in Td

This section is devoted to present some results about the periodic continuity equation

∂tµt + ∇ · νt = 0 ,

in (0, T ) × [0, 1)d,

(4.1)

where ∇ is the discret gradient deﬁned in (1.9). Here (µt)t∈[0,T ] and (νt)t∈[0,T ] are Borel families of
measures in P(Td) and Mloc(G(Td)), respectively, and satisfying

Z T
0 ZG([0,1)d)

dTd (x, y) d|νt|dt < ∞.

We suppose that (4.1) holds in the periodic distributional sense, i.e., for all ϕ ∈ C∞c ((0, T ); C∞(Td)) we
have that the pair (µt, νt)t∈[0,T ] satisﬁes

0 Z[0,1)d
Z T

∂tϕt dµt(x) dt +

1

0 ZG([0,1)d) ∇ϕt(x, y) dνt(x, y) dt = 0.
2Z T

Let us deﬁne the class of pairs that we will use in the Benamou-Brenier formulation.

Deﬁnition 4.1. Given eµ0,eµ1 ∈ P(Td), we denote CE T (eµ0,eµ1) the set of pairs (µt, νt)t∈[0,T ] such that
i) t ∈ [0, T ] 7→ µt is weakly continuous (Deﬁnition 2.1) with µ0 =eµ0 and µ1 =eµ1;
ii) (νt)t∈[0,T ] is a Borel family in Mloc(G(Td)) withR T

0 RG([0,1)d) dTd (x, y) d|νt|dt < ∞;

iii) The pair (µt, νt)t∈[0,T ] satisﬁes ∂tµt + ∇ · νt = 0 in the periodic distributional sense.
Remark 4.2. Let us denote by CE T all the pairs (µt, νt)t∈[0,T ] satisfying the items ii) and iii) above,
with t 7→ µt weakly continuous but with no ﬁxed end points.

also satisﬁes

Remark 4.3. It is clear that if a pair (µt, νt)t∈[0,T ] ∈ CE T (eµ0,eµ1) and ϕ ∈ C(Td) is Lipschitz, then it

1

Z ϕ(x) deµ1(x) −Z ϕ(x) deµ0(x) =

2Z 1
0 ZG([0,1)d) ∇ϕ(x, y) dνtdt .

9

The condition ii) ensures that the weak formulation iii) is well deﬁned since, for every ϕ ∈ C(Td)

Lipschitz and k ∈ Zd we have

|∇ϕ(x, y)| = |ϕ(x) − ϕ(y)| = |ϕ(x) − ϕ(y + k)| 6 [ϕ]1|x − y − k|

where

[ϕ]1 := sup
x6=y

|ϕ(x) − ϕ(y)|

|x − y|

,

and therefore |∇ϕ(x, y)| 6 [ϕ]1dTd (x, y).

The lemma below consists in a time-rescaling property for solutions of (4.1).

Lemma 4.4. Let t : [0, T ] → [0, T ] be a strictly increasing absolutely continuous map with absolutely
continuous inverse s := t−1. Then (µt, νt)t∈[0,T ] is a distributional solution of ∂tµt + ∇ · νt = 0 in
(0, T ) × [0, 1)d in the periodic sense if and only if the pair (µs, νs)s∈[0,T ], deﬁned by µs = µt(s) and
ν s = t′(s)νt(s), is a solution in (0, T ) × [0, 1)d in the periodic sense.

Proof. Let us assume that s ∈ C1(0, T ) with s′ > 0. For every ϕ ∈ C∞c ((0, T ); C∞(Td)), we deﬁne

ϕt(x) := ϕs(t)(x). Therefore, we can write

Z T
0 Z[0,1)d
0 Z[0,1)d
=Z T
=Z T
0 Z[0,1)d

∂tϕt dµt(x) dt +

1

2Z T
0 ZG([0,1)d) ∇ϕt(x, y) dνt(x, y) dt

∂sϕs(t)(x) dµt(x) s′(t) dt +

∂sϕs(x) dµt(s)(x) ds +

1

∇ϕs(t)(x, y)

0 ZG([0,1)d)
2Z T
2Z T
0 ZG([0,1)d) ∇ϕs(x, y)t′(s) dνt(s)(x, y) ds

s′(t)

1

dνt(x, y) s′(t) dt

And thus, the pair (µt, νt)t∈[0,T ] is a solution if and only if (µs, ν s)s∈[0,T ] is also a solution.

5 The non-local transport distance on P(Td)

In this section we deﬁne the periodic non-local Wasserstein metric in the sense of Benamou-Brenier
formula and show that in the set where it is ﬁnite, it deﬁnes a metric that induces a topology stronger
than the narrow one (see Deﬁnition 2.1).
Deﬁnition 5.1. For µ0, µ1 ∈ P(Td) we deﬁne the function

(5.1)

W(µ0, µ1)2 := inf(cid:26)Z 1

We will show later that this inﬁmum is actually a minimum.

Lemma 5.2. For any T > 0 we have

W(µ0, µ1)2 = inf( TZ T

0 A(µt, νt) dt(cid:12)(cid:12)(cid:12)(cid:12) (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1)(cid:27) .
0 A(µt, νt) dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(µt, νt)t∈[0,1] ∈ CE T (µ0, µ1)) .
T 2Z T

0 A(µs(t), νs(t)) dt =

0 A(µt, νt) dt.

T Z 1

1

1

10

Proof. Let s : [0, T ] → [0, 1] deﬁned by s(t) = T −1t. For any (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) we have,
by Lemma 4.4, that (µ, ν) ∈ CE T (µ0, µ1) where µt := µs(t) and ν t := T −1νs(t). Now, since A is
2−homogeneous in the variable ν, we have

Z T

0 A(µt, ν t) dt =

Using the inverse s−1 we can also see that CE T (µ0, µ1) is mapped onto CE 1(µ0, µ1) with the same relation
as above. This concludes the proof.

Lemma 5.3. For any T > 0 and µ0, µ1 ∈ P(Td), we have

we have by Cauchy-Schwarz inequality that

Proof. Let us denote by cW(µ0, µ1) the right-hand side of (5.2). For every (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1)

(µt, νt)t∈[0,T ] ∈ CE T (µ0, µ1)) .

(5.2)

W(µ0, µ1) = inf(Z T

0 pA(µt, νt) dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
0 pA(µt, νt) dt 6 √T Z T
Z T

0 A(µt, νt) dt! 1

2

,

and thus, by Lemma 5.2, cW(µ0, µ1) 6 W(µ0, µ1). For the opposite inequality we argue as in [14]. Let us

suppose that W(µ0, µ1) < ∞ and let (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) be such that

(5.3)

Then, for every ε > 0 we deﬁne the function sε on (0, T ) by

Z T

0 A(µt, νt) dt < ∞ .

sε(t) :=Z t

0 pε + A(µr, νr) dr .

We have that sε is strictly increasing and its derivative exists a.e. with s′ε > √ε. So its inverse tε := s−1
is well deﬁned and satisﬁes the hypothesis from Lemma 4.4. Therefore, we know that (bµs,bνs)s∈[0,sε(T )] ∈
CE sε(T )(µ0, µ1) where bµs := µtε(s) and bνs := t′ε(s)νtε(s). Using Lemma 5.2, we have

ε

0

W(µ0, µ1)2 6 sε(T )Z sε(T )
= sε(T )Z sε(T )
= sε(T )Z T
= sε(T )Z T

0

0

0

6 sε(T )2

A(bµs,bνs) ds
t′ε(s)2A(µtε (s), νtε(s)) ds

(t′ε ◦ sε(t))2A(µt, νt)s′ε(t) dt
ε + A(µt, νt)pε + A(µt, νt) dt

A(µt, νt)

This holds for all ε > 0 and therefore

W(µ0, µ1)2 6 lim
ε→0+

sε(T )2 = Z T

0 A(µt, νt) dt!2

.

Since we have this inequality for all pairs (µt, νt)t∈[0,T ] satisfying (5.3), we can take the inﬁmum over

CE T (µ0, µ1) and obtain W(µ0, µ1) 6 cW(µ0, µ1).

Proposition 5.4. Given µ∗ ∈ P(Td), the function W is a metric in Pµ∗ := {µ ∈ P(Td) | W(µ∗, µ) < ∞}.

11

Proof. Symmetry: Let µ0, µ1 ∈ Pµ∗ and (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) and consider the pair (eµt,eνt) :=
(µ1−t,−ν1−t). It is straightforward to check that (eµt,eνt) ∈ CE 1(µ1, µ0) (see Lemma 4.4). Since

0 A(µ1−t,−ν1−t) dt =Z 1

0 A(µt, νt) dt,

Z 1
0 A(eµt,eνt) dt =Z 1

we have that

Analogously, it follows the opposite inequality.

W(µ1, µ0) 6 W(µ0, µ1).

Triangular Inequality: Assume that µ2 ∈ Pµ∗ . Choose (¯µt, ¯νt) ∈ CE 1(µ0, µ1) and (¯¯µt, ¯¯νt) ∈

CE 1(µ1, µ2). Deﬁne the pair

Let us to check that (eµt,eνt) satisﬁes the non-local continuity equation in the periodic distributional sense

according to Deﬁnition 4.1(iii). Let ϕ ∈ C∞c ((0, 1); C∞(Td)), then

.

1

if
if

t ∈ [0, 1/2)
t ∈ [1/2, 1]

(¯¯µ2t−1, ¯¯ν2t−1)

(eµt,eνt) =(cid:26) (¯µ2t, ¯ν2t)
2Z 1
0 Z[0,1)d
¯∇ϕt deνt(x, y) dt
4Z 1
0 Z[0,1)d
0 Z[0,1)d
4Z 1
∂tϕ1/2 d¯¯µ0! = 0,

∂tϕt deµt(x) dt +

∂tϕ(t+1)/2 d¯¯µt(x) dt +

∂tϕt/2 d¯µt(x) dt +

1

1

=

1

Z 1
0 Z[0,1)d
2Z 1
0 Z[0,1)d
0 Z[0,1)d
2Z 1
2 Z[0,1)d

+

1

1

=

¯∇ϕt/2 d ¯νt(x, y) dt

¯∇ϕ(t+1)/2 d¯¯νt(x, y) dt

∂tϕ1/2 d¯µ1 −Z[0,1)d
W(µ0, µ2) 6Z 1

0 A(¯µt, ¯νt) dt +Z 1

0 A(¯¯µt, ¯¯νt) dt.

because ¯µ1 = ¯¯µ0 = µ1. Thus, (µt, νt) ∈ CE 1(µ0, µ2) and

Taking the inﬁmum, it follows the triangular inequality.

Now, we assume that W(µ0, µ1) = 0. By deﬁnition, we can get a sequence (µk

t , ν k

t )k∈N ∈ CE 1(µ0, µ1)

such that

Now, for any ϕ ∈ C(Td) Lipschitz, we have from Remark 4.3 and from Lemma 3.5 that the following
estimate holds for all k ∈ N:

lim

k→0Z 1
(cid:12)(cid:12)(cid:12)(cid:12)Z ϕ dµ1 −Z ϕ dµ0(cid:12)(cid:12)(cid:12)(cid:12) 6

6

0 A(µk

t , ν k

t ) dt = 0.

t |dt

dTd (x, y) d|ν k

t |dt

t ) dt

t ) dt(cid:19)1/2

,

2

2

1

6 C

[ϕ]Lip

[ϕ]Lip

t , νk

2Z 1
0 ZG([0,1)d) |∇ϕ| d|ν k
Z 1
0 ZG([0,1)d)
Z 1
0 qA(µk
2 (cid:18)Z 1
0 A(µk
Z ϕ deµ0 =Z ϕ deµ1

t , νk

[ϕ]Lip

6 C

12

where [ϕ]Lip is the Lipschitz constant of ϕ. Therefore, taking the limit as k → ∞, we obtain

for all Lipschitz ϕ ∈ C(Td). By an approximation argument, we conclude that µ0 = µ1.

For the next result, let us recall the following fact about the Kantorovich-Rubinstein metric (see [22,

Theorem 1.14]):
Lemma 5.5. Let (X, d) be a Polish metric space. The Kantorovich-Rubinstein distance on P(X) is
deﬁned by

Wd(µ0, µ1) :=

d(x, y) dπ(x, y)

π∈Γ(µ0,µ1)ZX×X

inf

where Γ(µ0, µ1) is the set of probability measures π on X × X with marginals µ0 and µ1. Then we have:

i) (Kantorovich-Rubinstein Theorem) Let Lip1(X) := {ϕ ∈ C(X) | [ϕ]Lip < 1} where

Then

[ϕ]Lip := sup
x6=y

|ϕ(x) − ϕ(y)|

d(x, y)

Wd(µ0, µ1) = sup

ϕ∈Lip1(x)|ZX

ϕ dµ0 −ZX

ϕ dµ1|

ii) Wd is lower semicontinuous w.r.t. weak (narrow) convergence in P(X).
Proposition 5.6 (Compactness of solutions). Let {(µn
0 A(µn

t ) dt < ∞.

S := sup

t , ν n

t , ν n

n∈NZ T

t )t∈[0,T ]}n∈N be a sequence in CE T such that

Then there exists a subsequence {(µnk

t

, ν nk

t )t∈[0,T ]}k∈N and a pair (µt, νt)t∈[0,T ] ∈ CE T such that

µnk
t ⇀ µt weakly in P(Td) for all t ∈ [0, T ]
ν nk ∗⇀ ν weakly-∗ in Mloc(G(Td) × [0, T ])

Furthermore, for any convergent sequence of couples {(µn
following lower semicontinuity formula

t , ν n

t )t∈[0,T ]}n∈N in the above sense, we have the

Z T

0 A(µt, νt) dt 6 lim inf

0 A(µn

t , ν n

t ) dt.

n→∞ Z T

(5.4)

Proof. Let us ﬁrst deﬁne for each n ∈ N the measures dνn(x, y, t) := dν n(x, y)dt. So, for every
compact subset K ⊂ G(Td) and every Borelian B ⊂ [0, T ], we can use Lemma 3.5 to obtain a constant
C(K) depending on K and write

sup

n∈N|νn|(K × B) = sup

t |(K) dt 6 C(K) sup

t , ν n

t ) dt

(5.5)

n∈NZB |ν n
6 C(K)|B|1/2 sup
6 C(K)|B|1/2S1/2.

n∈N Z T

n∈NZBpA(µn
t ) dt!1/2

t , ν n

0 A(µn

Therefore, the measures νn have total variation uniformly bounded on each compact subset of
∗⇀ ν for some
G(Td) × [0, T ], which assures that we can extract a subsequence νnk , such that νnk
ν ∈ Mloc(G(Td) × [0, T ]) as k → ∞. Furthermore, the estimate (5.5) leads to

ν(K × B) 6ZB

mK(t) dt ,

for mK(t) := sup

n∈N|ν n

t |(K) ∈ L1(0, T ),

13

so, by the Disintegration Theorem (see [3, Theorem 2.28]), there exists a Borel family (νt)t∈[0,T ] ⊆
Mloc(G(Td)) such that ν can be disintegrated w.r.t. the Lebesgue measure on [0, T ] as dν(x, y, t) =
dνt(x, y)dt.

Let us show now that the subsequence {µnk

t }n also admits subsequence which is weakly convergent
for all t ∈ [0, T ]. For any k ∈ N, 0 6 s 6 t 6 T and ϕ ∈ C(Td) Lipschitz, we can use the same argument
as in the proof of Proposition 5.4 to obtain

(cid:12)(cid:12)(cid:12)(cid:12)Z ϕ dµnk

s (cid:12)(cid:12)(cid:12)(cid:12) 6 C
t −Z ϕ dµnk

6 C

6 C

[ϕ]Lip

t

2

Z t
s pA(µnk
2 (cid:18)Z 1
0 A(µnk
S1/2√t − s

2

t

[ϕ]Lip

[ϕ]Lip

, ν nk

t ) dt

, ν nk

t ) dt(cid:19)1/2 √t − s

Therefore, by the Kantorovich-Rubinstein Theorem (see Lemma 5.5 (i)), we have that

lim sup
k→∞

Wd(µnk

s , µnk

t ) 6 CS1/2|t − s|1/2

(5.6)

Now, by the compactness of P(Td) w.r.t. the weak convergence (Remark 2.2) and the item ii) from
Lemma 5.5, we have that the weak topology on P(Td) is compatible with Wd. This fact together with
(5.6) allow us to apply [4, Proposition 3.3.1] to the sequence {µnk
t }k and obtain that there exists a
subsequence, still denoted by {µnk
t ⇀ µt
weakly for all t ∈ [0, T ] as k → ∞.

t }k, and a Wd-continuous curve µ : [0, T ] → P(Td) such that µnk

In order to see that the pair (µt, νt)t∈[0,T ] belongs to CE T , we ﬁrst note that by Lemma 3.5 and the

hypothesis above, we have the following estimate

0 ZG([0,1)d)
Z t

dTd (x, y) d|νt|dt 6 sup

dTd (x, y) d|ν n

t |dt

(5.7)

6 C sup

0 ZG([0,1)d)
n∈NZ t
n∈NZ T
0 pA(µn
n∈N Z T
0 A(µn

t , ν n

6 CT 1/2 sup

t ) dt

t ) dt!1/2

t , ν n

Also, since µ : [0, T ] → P(Td) is Wd-continuous, it implies that it is weakly continuous as well.

6 CT 1/2S1/2 < ∞.

Let us now prove that (µt, νt)t∈[0,T ] satisﬁes the continuity equation in the periodic distributional
sense. Let ϕ ∈ C∞c (0, T ; C∞(Td)). Then, since ∇ϕ 6∈ Cc(G([0, 1)d) × [0, T ]), we use an argument by
approximation. Let η ∈ C∞c (−1, 1) be such that 0 6 η 6 1 and η(s) = 1 for |s| 6 1/2 and, for all ε > 0,
let us deﬁne ηε : G([0, 1)d) → [0, 1] by ηε(x, y) = η(dTd (x, y)/ε). Thus, the function (1 − ηε)∇ϕ does
belong to Cc(G([0, 1)d) × [0, T ]) and we have

(1 − ηε)∇ϕ dν nk

(1 − ηε)∇ϕ dνtdt ,

for all ε > 0.

(5.8)

Let us deﬁne now the set Dε := {(x, y) ∈ G([0, 1)d) | dTd (x, y) 6 ε}. Since supp ηε ⊆ Dε, we obtain

k→∞Z T

lim

0 ZG([0,1)d)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

Z T
0 ZG([0,1)d)

0 ZG([0,1)d)

t dt =Z T
t dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

14

ηε∇ϕt dν nk

6Z T
0 k∇ϕtk∞ZDε
dTd (x, y) d|ν nk
t∈[0,T ]k∇ϕtk∞Z T
0 ZDε

6 sup

t

|dt

dTd (x, y) d|ν nk

t

|dt.

Arguing as in (3.1) with Dε in the place of G([0, 1)d), we obtain with the inequality (3.2) that

Z T
0 ZDε

dTd (x, y) d|ν nk

t

Td (x, y)K σ(x − y) dydµnk
d2

t (x)(cid:19)1/2

dt

, ν nk

t )(cid:18)ZDε
t )dt!1/2

, ν nk

t

t

|dt 6 √2Z T
0 pA(µnk
6 √2 Z T
0 A(µnk
× Z T
0 ZDε
6 √2S1/2T 1/2  sup
k∈N(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

0 ZG([0,1)d)
Z T

lim
ε→0

sup

d2

Td (x, y)K σ(x − y) dydµnk
d2
x∈[0,1)dZ{y|d(x,y)6ε}
t dt(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ηε∇ϕt dν nk

= 0.

t (x)dt!1/2
Td (x, y)K σ(x − y) dy!1/2

.

(5.9)

(5.10)

(5.11)

Since the right-hand side of (5.9) goes to zero as ε → 0, we have that

Now, since (1 − ηε)∇ϕt(x, y) → ∇ϕt(x, y), for all (x, y) ∈ G([0, 1)d) and t ∈ [0, T ], and
dTd (x, y) ∈ L1(dνtdt) , by (5.7) ,

|(1 − ηε)∇ϕt(x, y)| 6 sup

t∈[0,T ]k∇ϕtk∞

we can use the Dominated Convergence Theorem to obtain

Therefore, from (5.8), (5.10) and (5.11) we conclude that

lim

ε→0Z T
0 ZG([0,1)d)
0 ZG([0,1)d) ∇ϕt(x, y) dν nk
k→∞Z T
0 Z[0,1)d
k→∞Z T

(1 − ηε)∇ϕt(x, y) dνtdt =Z T
t dt =Z T
t (x)dt =Z T

0 ZG([0,1)d) ∇ϕt(x, y) dνtdt.
0 ZG([0,1)d) ∇ϕt(x, y) dνtdt.
0 Z[0,1)d

∂tϕt(x) dµt(x)dt

∂tϕt(x) dµnk

lim

lim

Finally, µnk

t ⇀ µt weakly for all t ∈ [0, T ] implies that

and this shows that (µt, νt)t∈[0,T ] satisﬁes the continuity equation in the periodic distributional sense.
The lower semicontinuity property follows from Lemma 3.3 by considering Ω = G(Td) × [0, T ], the
→ [0,∞] deﬁned

function f (z, h1, h2, h3) := |h3|2θm(h1, h2)−1 and functional F :(cid:0)Mloc(G(Td) × [0, T ])(cid:1)3

by

(µt, νt)t∈[0,T ] 7→ F (µ1

t , µ2

t , νt) :=Z T

0 ZG([0,1)d)

f (ρ1

t , ρ2

t , wt) dλtdt.

Therefore, we have that F is weakly* lower semicontinuous, which gives (5.4) because µn
that µi,n

tdt weakly* in Mloc(G(Td) × [0, T ]).

t dt ∗⇀ µi

t ⇀ µt implies

Proposition 5.7. Let µ0, µ1 ∈ P(Td) be such that W(µ0, µ1) < ∞. Then there exists a pair
(µt, νt)t∈[0,1] ⊂ CE 1(µ0, µ1) which attains the inﬁmum in (5.1). Furthermore, any such curve satisﬁes

A(µt, νt) = W(µ0, µ1)2 ,

for almost every t ∈ [0, 1].

(5.12)

Also, any curve (µt)t∈[0,1] satisfying (5.12) is a constant speed geodesic for W, i.e.

W(µs, µt) = (t − s)W(µ0, µ1) ,

for all 0 6 s 6 t 6 1.

15

Proof.
t , ν n

{(µn

If µ0, µ1 ∈ P(Td) are such that W(µ0, µ1) < ∞,

t )t∈[0,1]}n∈N in CE 1(µ0, µ1) such that

W(µ0, µ1)2 = lim

0 A(µn

t , ν n

t ) dt.

n→∞Z 1

then there exists a sequence

Thus, by Proposition 5.6, there exists a pair (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) such that, for some subsequence
(nk), we have µnk
t ⇀ µt weakly in P(Td) for all t ∈ [0, T ] and ν nk ⇀ ν weakly-∗ in Mloc(G(Td)× [0, T ]).
Therefore, also by the same proposition, we have

Therefore

Z 1

0 A(µt, νt) dt 6 lim inf

, ν nk

t ) dt = W(µ0, µ1)2 .

t

k→∞ Z 1
0 A(µnk
W(µ0, µ1)2 =Z 1
0 pA(µt, νt) dt 6(cid:18)Z 1

0 A(µt, νt) dt.

Using Lemma 5.3 and the Cauchy-Schwarz inequality, we conclude that

W(µ0, µ1) 6Z 1

0 A(µt, νt) dt(cid:19) 1

2

= W(µ0, µ1).

This implies that A(µt, νt) = W(µ0, µ1) for a.e. t ∈ [0, 1].

Moreover, if a pair (µt, νt)t∈[0,1] ⊂ CE 1(µ0, µ1) is such that A(µt, νt) is constant almost everywhere,
we have that, for any 0 6 s 6 r 6 1, the pair (µt+s, νt+s)t∈[0,r−s] belongs to CE r−s(µs, µr) and, by
Lemma 5.3, it satisﬁes

W(µs, µr) 6Z r−s

0

A(µt+s, νt+s) dt = (r − s)W (µ0, µ1)

The opposite inequality is always true. In fact, if it is not veriﬁed for some s and r, then

W(µ0, µ1) 6 W(µ0, µs) + W(µs, µr) + W(µr, µ1)

< sW(µ0, µ1) + (r − s)W(µ0, µ1) + (1 − r)W(µ0, µ1)
= W(µ0, µ1),

which gives a contradiction. Therefore, one must have W(µs, µr) = (r − s)W(µ0, µ1).

In next proposition we state the convexity of W 2 in P(Td). The proof is similar to that of [15,

Proposition 4.7] and is left to the reader.
Proposition 5.8. The function (µ0, µ1) ∈ P(Td) × P(Td) 7→ W(µ0, µ1)2 is convex.
Deﬁnition 5.9. For µ0, µ1 ∈ P(Td) such that W(µ0, µ1) < ∞, we call any pair (µt, νt)t∈[0,1] given by
Proposition 5.7 as geodesic pair or optimal pair for W(µ0, µ1). And the curves (µt)t∈[0,1] as a geodesic
curve between µ0 and µ1.
Proposition 5.10. The map (µ0, µ1) 7→ W(µ0, µ1) is lower semicontinuous w.r.t. weak convergence.
Moreover, the topology induced by W is stronger than the weak topology.
1}n∈N ⊆ P(Td) be two sequences such that µn

i ⇀ µi weakly for i = 0, 1 and
1 ) < ∞ and let (nk) be a subsequence such
1 ). Proposition 5.7 assures that for every k there exists

0 , µn

Proof. Let {µn
µ0, µ1 ∈ P(Td). Let us suppose that lim inf n→∞ W(µn
that limk→∞ W(µnk
a pair (µnk
t

1 ) = lim inf n→∞ W(µn

0}n∈N,{µn
0 , µnk

0 , µn
1 ) such that

0 , µnk

, ν nk

t )t∈[0,1] ∈ CE 1(µnk

W(µnk

0 , µnk

1 )2 =Z 1

0 A(µnk

t

, ν nk

t ) dt.

16

Thus, the existence of the limit limk W(µnk
1 ) assures that the hypothesis of Proposition 5.6 is valid
and we can extract a new subsequence, still denoted by (µnk
t ⇀ µt weakly in
t
P(Td) for all t ∈ [0, T ] and ν nk ⇀ ν weakly-∗ in Mloc(G([0, 1)d) × [0, T ]) for some pair (µt, νt)t∈[0,1] ∈
CE 1(µ0, µ1). Thus, from the lower semicontinuity result in the same proposition, it follows that

t )t∈[0,1], such that µnk

0 , µnk

, ν nk

0 A(µnk

t

, ν nk

t ) dt = lim

k→∞ W(µnk

0 , µnk

1 )2

W(µ0, µ1)2 6Z 1

k→∞ Z 1

0 A(µt, νt) dt 6 lim inf
n→∞ W(µn

0 , µn

1 )2.

= lim inf

Now, let {µn}n be a sequence in P(Td) such that W(µn, µ) → 0. Then, any convergent subsequence
{µnk} that converges weakly to a µ∗ satisﬁes, by the lower semicontinuity of W, that W(µ, µ∗) 6
lim inf W(µnk , µ) = 0. Since P(Td) is sequentially compact, then we obtain that µn converges weakly to
µ.

Proposition 5.11. Given µ∗ ∈ P(Td), we have that the pair (Pµ∗ ,W) is a complete metric space, where
Pµ∗ := {µ ∈ P(Td) | W(µ∗, µ) < ∞}.

Proof. Let (µn)n∈N ⊆ Pµ∗ be a Cauchy sequence w.r.t. W. Since P(Td) is weakly compact, we can
extract a subsequence (µnk )k∈N such that µnk ⇀ µ for some µ ∈ P(Td). Using the lower semicontinuity
of W, we have
(5.13)

W(µ, µm) 6 lim inf

k→∞ W(µnk , µm) , ∀ m ∈ N.

Thus, since the right hand side of (5.13) can be made arbitrarily small if m is suﬃciently big, we conclude
that (µn)n∈N converges to µ, which therefore must belong to Pµ∗ .

6 Subdifferential Calculus

In this section we construct a subdiﬀerential calculus in the space P(Td) endowed with the non-local
metric W. We give the corresponding notion of tangent space, subdiﬀerential of a functional and the
characterization of this concept to λ−convex functionals.
Deﬁnition 6.1. For µ ∈ P(Td) we deﬁne the tangent space of P(Td) at µ by

TanµP(Td) :=(cid:26)ν ∈ Mloc(G(Td)) (cid:12)(cid:12)(cid:12)(cid:12)
· A(µ, ν) 6 A(µ, ν + η) , ∀η ∈ Mloc(G(Td)) with ∇ · η = 0 (cid:27)
TanµP(Td) :=(cid:8)wbρm dK σ ∈ Mloc(G(Td)) | ∃(φn)n∈N ⊂ C∞c (Td) , ∇φn → w in L2(bρmdK σ)(cid:9)

Let µ0, µ1 ∈ P(Td) be such that W(µ0, µ1) < ∞, then by Proposition 5.7 there exists a geodesic pair

· A(µ, ν) < ∞ ,

If dµ(x) = ρ(x)dx then

(µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) satisfying

W 2(µ0, µ1) = A(µt, νt) ,

for a.e. t ∈ [0, 1].

If K ⊆ G(Td) is compact, then by Lemma 3.5 there exists a constant C = C(K) such that the total
variation of νt is uniformly bounded for a.e. t ∈ [0, 1] with

|νt|(K) 6 C(K)pA(µt, νt) = C(K)W(µ0, µ1).

Therefore, there exists a sequence tn → 0+ and ν ∈ Mloc(G([0, 1)d)) such that νtn ∗⇀ ν. Thus, since the
set of weak-∗ limit measures for νt as t → 0 is non empty, we can have the following deﬁnition:

17

Deﬁnition 6.2. Given µ0, µ1 ∈ P(Td) such that W(µ0, µ1) < ∞, let Γ0(µ0, µ1) be the set of all weak-∗
limit measures of νt as t → 0+ where (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) is a geodesic pair.

Now we give the notion of subdiﬀerential for functionals deﬁned in P(Td) with respect to the geometric

structure given by W.
Deﬁnition 6.3. Let µ ∈ P(Td) with dµ(x) = ρ(x)dx and let E : P(Td) → (−∞, +∞] be a proper
subdiﬀerential ∂E(µ) if

and weak lower semicontinuous functional. We say that dξ = ζbρmdK σ ∈ TanµP(Td) belongs to the

1

W(µ, µ1) E(µ1) − E(µ) −

ν∈Γ0(µ,µ1)ZG([0,1)d)

inf

ζ(x, y) dν(x, y)! > 0

lim inf
µ1→µ

or, equivalently,

E(µ1) − E(µ) >

ν∈Γ0(µ,µ1)ZG([0,1)d)

inf

ζ(x, y) dν(x, y) + o(W(µ, µ1)).

The next lemma deals with geodesics constructed via a glueing type process. See [14] for such a type

of construction in another context.

Lemma 6.4. Let (µt, νt)t∈[0,1] ∈ CE 1(µ0, µ1) be a geodesic pair for W(µ0, µ1) and let s ∈ (0, 1).
(µs

t )t∈[0,s] is another geodesic pair for W(µ0, µs), then the composition

t , ν s

If

µt :=

µs
t , 0 6 t 6 s
µt ,

s < t 6 1 ν t :=

ν s
t , 0 6 t 6 s
νt ,
s < t 6 1

is also a geodesic pair for W(µ0, µ1).

Let us deﬁne what a λ-geodesically convex functional means in our context. We say that a proper func-
tional E : P(Td) → (−∞, +∞] is λ-convex for some λ ∈ R if for every µ0, µ1 ∈ P(Td) with W(µ0, µ1) < ∞,
there exists a geodesic curve (µt)t∈[0,1] such that the following inequality is true

E(µt) 6 (1 − t)E(µ0) + tE(µ1) −

λ
2

t(1 − t)W(µ0, µ1)2, ∀ t ∈ [0, 1].

In the case when the functional E is λ-geodesically convex, we have the following characterization.

Proposition 6.5. Let E : P(Td) → (−∞, +∞] be a lower semicontinuous and λ-geodesically convex
W(µ, µ1) < ∞ there exists ν0 ∈ Γ0(µ, µ1) satisfying

functional. If dµ(x) = ρ(x)dx then dξ = ζbρmdK σ ∈ ∂E(µ), if and only if, for all µ1 ∈ P(Td) such that

E(µ1) − E(µ) >ZG([0,1)d)

ζ(x, y) dν0(x, y) +

λ
2 W 2(µ, µ1).

Proof. Let µ1 ∈ P(Td) be such that W(µ, µ1) < ∞ and let (µt, νt)t∈[0,1] ∈ CE 1(µ, µ1) be a geodesic

pair for W(µ, µ1). Since W(µ, µt) = tW(µ, µ1) for all t ∈ [0, 1], there exists ν t

0 ∈ Γ0(µ, µt) such that

E(µt) − E(µ) >ZG([0,1)d)

ζ(x, y) dν t

0 + o(t).

(6.1)

Claim: t−1ν t

0 ∈ Γ0(µ, µ1).

18

Let (µt

s, ν t

s)s∈[0,1] ∈ CE 1(µ, µt) be a geodesic pair for W(µ, µt) such that ν t

as s → 0+. By Lemma 4.4, the pair(cid:16)µt

by Lemma 6.4, the pairs (µt

s
t

s, νt

, t−1ν t

s

t(cid:17)s∈[0,t]

s)s
are still geodesic pairs for W(µ, µt) for all t and,

0 is a limit point of (ν t

s)s∈[0,1] deﬁned by
0 6 s 6 t
t < s 6 1

,
µs ,

s
t

s :=(cid:26) µt

µt

νt

s :=(cid:26) t−1ν t

νs ,

s
t

, 0 6 s 6 t
t < s 6 1

are also geodesic pairs for W(µ, µ1) and have t−1ν t

0 as a limit point for νs as s → 0+.

Now, by Proposition 5.7, these geodesic pairs satisfy W 2(µ, µ1) = A(µt

s) for all t ∈ [0, 1] and for
a.e. s ∈ [0, 1], and for all K ⊆ G(Td) we can use Lemma 3.5 and the weak-weak∗ lower semicontinuity of
A to estimate

s, νt

t−1|ν t

0|(K) 6 C(K)qA(µ, t−1ν t

s→0 qA(µt

0) 6 C(K) lim inf

s, νt

s) = C(K)W(µ, µ1).

Therefore, there exists ν0 weak-∗ limit point of t−1ν t
also a geodesic pair (µt, νt)t∈[0,1] ∈ CE 1(µ, µ1) such that ν t ∗⇀ ν0 and therefore, ν0 ∈ Γ0(µ, µ0).

0 as t → 0+. Finally, by Proposition 5.6, there exists

Since E is λ-convex, the following inequality holds for all t ∈ (0, 1]

E(µ1) − E(µ) −

λ
2

(1 − t)W 2(µ, µ1) > E(µt) − E(µ)

t

(6.2)

ζ(x, y) dν0,

(6.3)

t

lim inf
t→0

and, for dξ = ζbρmdK σ ∈ ∂E(µ), we obtain from (6.1) that

E(µt) − E(µ)

> lim inf

ζ(x, y)t−1 dν t

where the equality follows from the following fact: since dµ(x) = ρ(x) dx and A(µ, t−1ν t
then there exist wt
t−1ν t

0 ∗⇀ ν0 implies that wt

0 =ZG([0,1)d)

t→0 ZG([0,1)d)
0, w0 ∈ L2(bρm dK σ) such that t−1 dν t
t→0ZG([0,1)d)
t→0ZG([0,1)d)
=ZG([0,1)d)
=ZG([0,1)d)

0 ⇀ w0 in L2(bρm dK σ). Thus, since ζ ∈ L2(bρm dK σ), we have
0(x, y)bρm dK σ
ζ(x, y)w0(x, y)bρm dK σ

ζ(x, y) t−1 dν t

ζ(x, y) dν0.

ζ(x, y)wt

0 = lim

0 = wt

lim

0),A(µ, ν0) < ∞

0bρm dK σ and dν0 = w0bρm dK σ. Therefore,

Finally, from (6.2) and (6.3) we obtain the desired expression.

Remark 6.6. If Ω ⊂ Rk is open and νn ∗⇀ ν in Mloc(Ω) with dνn = wndπ for some 0 6 π ∈ Mloc(Ω),
then wn ⇀ w in L2(dπ).

7 Generalized minimizing movements

In this section we consider the R´enyi entropy functional which is the internal energy functional associ-
ated to the porous medium equation in the classical case. We show that for each µ0 ∈ P(Td) there exists
an absolutely continuous curve obtained as the limit (up to a subsequence) of the discrete variational
scheme (1.3). As commented in the introduction, such curve is a generalized minimizing movement for
(1.1) starting at µ0.

19

Deﬁnition 7.1. For µ ∈ P(Td) and m ∈ (0, 2] we deﬁne the entropy Um at µ by

where

Um(µ) :=

+∞ ,

Z[0,1)d
Um(s) :=

Um(ρ(x)) dx ,

if dµ = ρ(x) dx

else

,

s log s

sm
m − 1

if m = 1

else

.

Deﬁnition 7.2. For µ ∈ P(Td) and m = 1 we deﬁne the entropy dissipation (or ﬁsher information
associated) I1 at µ by

I1(µ) := Ξ(µ1, µ2) :=

1

2ZG([0,1)d)

(ρ1 − ρ2)2
θ(ρ1, ρ2)

dλ

where dµ1(x, y) = K σ(x − y)dydµ(x), dµ2(x, y) = K σ(x − y)dxdµ(y) and λ ∈ Mloc(G(Td)) is such that
µ1, µ2 ≪ λ.
Remark 7.3. Note that when dµ(x) = ρ(x)dx, we have

I1(µ) =

1

2ZG([0,1)d) ∇ρ(x, y)∇ log ρ(x, y)K σ(x − y)dxdy.

Since the integrand in the deﬁnition of Ξ is a lower semicontinuous function of ρ1 and ρ2, and also
the weak* convergence in
positively 1-homogeneous, we have that Ξ is lower semicontinuous w.r.t.
n ∗⇀ µi, for i = 1, 2, and it implies
Mloc(G(Td)). Therefore, if µn ⇀ µ weakly in P(Td), then µi
that

Analogously, for m 6= 1 we can deﬁne the ﬁsher information as

I1(µ) = Ξ(µ1, µ2) 6 lim inf
n→∞

Ξ(µ1

n, µ2

n) = lim inf

n→∞ I1(µn).
m − 1ZG([0,1)d) ∇(ρm−1)∇(ρm)K σ(x − y) dxdy,

m

Im(µ) :=

for dµ = ρ dx. Note that, in this case the integrand is (2m− 1)− homogeneous and thus it is not possible
to extend it for more general measures.

The next theorem shows a coercivity property to the internal energy deﬁned in Deﬁnition 7.1.

Theorem 7.4. For any τ > 0 and µ∗ ∈ P(Td), the function

µ ∈ Pµ∗ 7→ Φ(τ, µ∗; µ) :=

1
2τ W 2(µ∗, µ) + Um(µ)

is bounded from below in P(Td). Moreover, there exists a unique µ0 ∈ P(Td) (depending on τ and µ∗)
such that

Φ(τ, µ∗; µ0) 6 Φ(τ, µ∗; µ) , ∀ µ ∈ P(Td).

Proof. We ﬁrst notice that for m = 1 and any µ = ρ(x) dx ∈ Pac(Td), we can rewrite U1 as

U1(µ) =Z[0,1)d

ρ log ρ dx =Z[0,1)d

(ρ log ρ − ρ + 1) dx

and use the fact that s 7→ s log s − s + 1 is nonnegative in [0,∞).

If m ∈ (1, 2] then the nonnegativity of Um is clear.

20

Finally, if m ∈ (0, 1), we have that

Um(µ) =Z[0,1)d(cid:18) ρ(x)m

m − 1

+ ρ(x) − 1(cid:19) dx

and we can use the fact that s 7→ sm

m−1 + s − 1 is bounded from below.

Therefore, for all m ∈ (0, 2], τ > 0 and µ∗ ∈ P(Td), the functional Φ is bounded from below.
The existence of points of minimum follows from the fact that any minimizing sequence for Φ is
relatively compact w.r.t. the weak convergence. Therefore, by the lower semicontinuity of W and Um
(the semicontinuity of the functional w.r.t. the weak convergence is a very well known fact), we have
that any limit point attains the minimum value for Φ. The uniqueness is a consequence of the fact that
the composition t ∈ [0, 1] 7→ µt := (1 − t)µ0 + tµ1 7→ Um(µt) is strictly convex.

Theorem 7.5. For any τ > 0 and µ0 ∈ P(Td) such that Um(µ0) < ∞ we can deﬁne

µ0
τ := µ0 and µn

Now deﬁning the interpolation µτ : [0,∞) → P(Td) by

τ := argmin(cid:8) Φ(τ, µn−1

0

; µ)(cid:12)(cid:12) µ ∈ P(Td)(cid:9) , ∀n ∈ N.

µτ (t) := µn
τ

for

t ∈ [nτ, (n + 1)τ ) ,

and n ∈ N ∪ {0},

we have that there exists a curve µ ∈ ACloc([0,∞),P(Td)) such that (up to a subsequence)

µτ (t) ⇀ µ(t), as τ → 0 ∀ t > 0.

Proof. For a ﬁxed µ∗ ∈ P(Td), we have from the previous results that the following ones are true:

1. The weak topology on Pµ∗ is compatible with W, in the sense that it is weaker than the one

generated by W and the function (µ0, µ1) 7→ W(µ0, µ1) is weak lower semicontinuous;

2. The entropy functional is weak lower semicontinuous on Pµ∗ ;
3. For all τ > 0 the functional µ ∈ Pµ∗ 7→ Φ(τ, µ∗; µ) is bounded from below;
4. The space Pµ∗ is weakly sequentially compact.

Therefore, we just need to apply the general results for metric spaces like in [4, Proposition 2.2.3 or

Corollary 3.3.4].

Acknowledgement: LCFF was supported by CNPq and FAPESP, Brazil. MCS acknowledges the
support from the S˜ao Paulo Research Foundation (FAPESP) grant #2014/23326-1, Brazil. JCV-G
acknowledges the support from CNPq, Brazil.

References

[1] S. Abe, S. Thurner. Anomalous diﬀusion in view of Einstein’s 1905 theory of Brownian motion, Physica A:
Statistical Mechanics and its Applications, Volume 356, Issues 2-4, 15 October 2005, Pages 403-407, ISSN
0378-4371.

[2] M. Agueh, Existence of solutions to degenerate parabolic equations via the Monge-Kantorovich theory, Adv.

Diﬀerential Equations 10 (3) (2005), 309-360.

21

[3] L. Ambrosio, N. Fusco, D. Pallara. Functions of bounded variation and free discontinuity problems. vol. 254,

Clarendon Press Oxford, 2000.

[4] L. Ambrosio, N. Gigli, G. Savar´e. Gradient ﬂows in metric spaces and in the space of probability measures.

Lectures in Mathematics ETH Z¨urich. Birkh¨auser Verlag, Basel, second edition, 2008.

[5] I. Athanasopoulos, L. A. Caﬀarelli. Continuity of the temperature in boundary heat control problems, Adv.

Math. 224 (2010) 293-315.

[6] J.-D. Benamou, Y. Brenier. A computational ﬂuid mechanics solution to the Monge-Kantorovich mass transfer

problem, Numer. Math. 84 (2000), no. 3, 375–393.

[7] A. Blanchet, P. Lauren¸cot, The parabolic-parabolic Keller-Segel system with critical diﬀusion as a gradient

ﬂow in Rd, d > 3. Comm. Partial Diﬀerential Equations 38 (2013), no. 4, 658–686.

[8] G. Buttazzo. Semicontinuity, relaxation and integral representation in the calculus of variations, Pitman

Research Notes in Mathematics Series, 207. Longman Scientiﬁc & Technical, Harlow, 1989.

[9] J. A. Carrillo, M. Di Francesco, A. Figalli, T. Laurent, D. Slepcev, Global-in-time weak measure solutions

and ﬁnite-time aggregation for nonlocal interaction equations, Duke Math. J. 156 (2011), no. 2, 229–271.

[10] J. A. Carrillo, D. Slepcev. Example of a displacement convex functional of ﬁrst order. Calc. Var. Partial

Diﬀerential Equations 36 (2009), no. 4, 547–564.

[11] A. de Pablo, F. Quiros, A. Rodriguez, J.L. Vazquez. A fractional porous medium equation. Adv. Math. 226

(2011), 1378-1409.

[12] A. de Pablo, F. Quiros, A. Rodriguez, J.L. Vazquez. A general fractional porous medium equation. Comm.

Pure Appl. Math. 65 (2012), no. 9, 1242–1284.

[13] M. Di Francesco, S. Fagioli, Measure solutions for non-local interaction PDEs with two species, Nonlinearity

26 (2013), no. 10, 2777-2808.

[14] J. Dolbeault, B. Nazaret, G. Savar´e. A new class of transport distances between measures. Calc. Var. Partial

Diﬀerential Equations 34 (2009), no. 2, 193–231.

[15] M. Erbar, Gradient ﬂows of the entropy for jump processes. Ann. Inst. Henri Poincar´e Probab. Stat. 50

(2014), no. 3, 920–945.

[16] L. C. F. Ferreira, J. C. Valencia-Guevara. Periodic solutions for a 1D-model with nonlocal velocity via mass

transport, to appear in J. Diﬀ. Eq. (2016).

[17] W. Gangbo, A. Tudorascu. Weak KAM theory on the Wasserstein torus with multidimensional underlying

space. Comm. Pure Appl. Math. 67 (2014), no. 3, 408–463.

[18] M. Jara. Hydrodynamic limit of particle systems with long jumps, preprint, http://arxiv.org/abs/0805.1326.

[19] R. Jordan, D. Kinderlehrer, F. Otto. The variational formulation of the Fokker-Planck equation. SIAM J.

Math. Anal. 29 (1998), no. 1, 1–17.

[20] F. Otto. The geometry of dissipative evolution equations: the porous medium equation. Comm. Partial Dif-

ferential Equations 26 (2001), no. 1-2, 101–174.

[21] L. Roncal, P. Stinga. Fractional Laplacian on the torus, to appear in Commun. Contemp. Math. (2015).

[22] C. Villani. Topics in optimal transportation. Graduate Studies in Mathematics 58, American Mathematical

Society, Providence, RI, 2003.

[23] L. Vlahos, H. Isliker, Y. Kominis, K. Hizonidis. Normal and anomalous Diﬀusion: A tutorial, in: T. Bountis

(Ed.), Order and Chaos, vol. 10, Patras University Press, 2008.

[24] H Weitzner, G.M Zaslavsky, Some applications of fractional equations, Communications in Nonlinear Science
and Numerical Simulation, Volume 8, Issues 3-4, September-December 2003, Pages 273-281, ISSN 1007-5704.

22

