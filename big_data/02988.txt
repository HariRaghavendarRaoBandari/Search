ESTIMATES OF THE GREEN FUNCTION AND THE

INITIAL-DIRICHLET PROBLEM FOR THE HEAT EQUATION IN

SUB-RIEMANNIAN SPACES

NICOLA GAROFALO AND ISIDRO H. MUNIVE

Dedicated to the memory of Gene Fabes

6
1
0
2

 
r
a

M
9

 

Abstract. In a cylinder DT = Ω× (0, T ), where Ω ⊂ Rn, we examine the relation between
the L-caloric measure, dω(x,t), where L is the heat operator associated with a system of
vector ﬁelds of H¨ormander type, and the measure dσX × dt, where dσX is the intrinsic
X-perimeter measure. The latter constitutes the appropriate replacement for the standard
surface measure on the boundary and plays a central role in sub-Riemannian geometric
measure theory. Under suitable assumptions on the domain Ω we establish the mutual
absolute continuity of dω(x,t) and dσX × dt. We also derive the solvability of the initial-
Dirichlet problem for L with boundary data in appropriate Lp spaces, for every p > 1.

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
8
8
9
2
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

In this paper we study the initial-Dirichlet problem in a space-time cylinder DT = Ω×(0, T )
for the heat equation associated with a system X = {X1, . . . , Xm} of C∞ vector ﬁelds in Rn
satisfying H¨ormander’s ﬁnite rank condition

(1.1)
The heat operator in Rn+1 that we are interested in is deﬁned as follows

rank Lie [X1, . . . , Xm] ≡ n.

(1.2)

L = − m(cid:88)

j=1

j Xj − ∂
X (cid:63)
∂t

,

where X (cid:63)
j denotes the formal adjoint of Xj. Notice that the time-independent part of L
is in divergence form. The results that we establish should be seen as the sub-Riemannian
counterpart of those obtained by Fabes and Salsa in [19] for the classical heat equation. In
that paper the authors proved the unique solvability of the initial-Dirichlet problem in a
cylindrical domain with Lipschitz cross-section, lateral data in Lp, p > 2, and zero initial
values. They also showed that there is a Poisson kernel with the property that its L2-averages
over parabolic rectangles are equivalent to L1-averages over the same sets.

In the non-Euclidean context of the present paper the class of Lipschitz domains is in
essence meaningless, due to the generic presence of characteristic points on the lateral bound-
ary of the cross-section Ω, i.e., points at which the system X = {X1, ..., Xm} becomes tangent
to the boundary ∂Ω. At such points a host of negative phenomena occur, see the discussion
below and also the papers [6] and [11]. Instead, we work with cylinders in which the cross-
section Ω satisﬁes some natural assumptions that, in the time independent case, allow to
successfully solve the Dirichlet problem in Lp, for every p > 1, see [9], [10] and [11]. For such

First author supported in part by a grant “Progetti d’Ateneo, 2014,” University of Padova.

1

2

NICOLA GAROFALO AND ISIDRO H. MUNIVE

class of cylinders, we prove the corresponding solvability of the parabolic initial-Dirichlet
problem for boundary data in Lp, for every p > 1, see Theorems 1.3 and 1.6 below.
Notice that when X = {∂x1, ..., ∂xn}, then (1.2) reduces to the standard heat operator
L = ∆ − ∂
∂t. A genuinely non-Euclidean situation of prototypical interest for the results in
this paper is when the system X is a basis of the bracket generating layer of a Carnot group
j = −Xj, and thus (1.2) becomes the heat operator
G of step r > 1. In such case we have X (cid:63)
j , see [21]. In the
m(cid:88)

∂t on G × R, associated with the sub-Laplacian(cid:80)m

j = −Xj + aj, where aj = − div Xj, and we can thus write

L =(cid:80)m

general case, we have X (cid:63)

j − ∂

j=1 X 2

j=1 X 2

L =

X 2

j + X0,

∂t −(cid:80)m
(cid:0)Xjaj − a2

j=1

j=1

with a0 = (cid:80)m

j=1 ajXj. Notice that in this situation we can write X (cid:63)

(cid:1). We remark that, under the assumption (1.1), the system

where X0 = − ∂
0 = −X0 + a0,
{X0, X1, ..., Xm} satisﬁes the ﬁnite rank condition with dimension n + 1, i.e., the Lie algebra
generates the whole of Rn+1, see the introduction of [25].
For a domain D ⊂ Rn+1, we let ∂pD denote the parabolic boundary of D; i.e., ∂pD is
the set of points on the topological boundary of D that can be connected to some interior
point of D by a closed curve having strictly increasing t-coordinate. In this work we focus
on cylindrical domains of the form

j

(1.3)
where Ω ⊂ Rn is a connected bounded open set, and T > 0. With ST = ∂Ω × (0, T ), it is
well-known that the parabolic boundary of such DT is given by

DT = Ω × (0, T ),

(1.4)
Using Bony’s maximum principle [1] one can show that for any ϕ ∈ C(∂pDT ) there exists a
to (1.4). If we ﬁx a point (x, t) ∈ DT , the
unique Perron-Wiener-Brelot-Bauer solution H DT
mapping ϕ → u(x, t) is a continuous nonnegative linear functional on C(∂pDT ) and hence

on ∂pDT .

u = ϕ

ϕ

We denote by L∗ = −(cid:80)m

∂pDT = ST ∪ (Ω × {0}).

j Xj + ∂

j=1 X∗

∂t the formal adjoint of (1.2). For a domain D ⊂ Rn+1,
the relevant parabolic boundary associated with L∗, denoted by ∂∗
pD, contains the points
on the boundary of D that can be connected to some interior point of D by a closed curve
having strictly decreasing t-coordinate. The operator L∗ can be seen as the backwards heat
operator.
Thanks to H¨ormander’s theorem [25], the assumption (1.1) guarantees the hypoellipticity
of L, L∗. The fundamental solution of L with singularity at (ξ, 0), that we will denote by
p(x, ξ, t), exists, it is smooth and symmetric for t > 0, and satisﬁes Lp(·, ξ,·) = 0 for t > 0.
Corresponding Gaussian estimates for the heat kernel were independently obtained by Jerison
and Sanchez-Calle [28] and by Kusuoka and Stroock [31], see Theorem 2.4 below. One should
also see the references [40] and [3].

In DT such as (1.3) above we consider the initial-Dirichlet problem

(cid:26) Lu = 0 in DT ,

DIRICHLET PROBLEM

3

there exists a unique Borel measure, ω(x,t) = ω(x,t)

DT ,L, on ∂pDT so that

ϕ(y, s)dω(x,t)(y, s),

for every ϕ ∈ C(∂pDT ).

(cid:90)

H DT

ϕ (x, t) =

∂pDT

The measure ω(x,t) is called the L-parabolic measure (associated with DT ) evaluated at (x, t).
Because of Harnack’s inequality, see [31] and [3], for nonnegative solutions of the heat equation
(1.2), we have ω(x,s) << ω(y,t) provided x, y ∈ Ω and 0 < s < t < T .
In this work we examine the relation between the L-parabolic measure, dω(x,t), and the
measure dσX × dt on ST , where dσX = PX(Ω,·) is the so-called horizontal perimeter measure
on ∂Ω. The latter constitutes the appropriate replacement for the standard surface measure
on ∂Ω and plays a central role in sub-Riemannian geometric measure theory. We also derive
the solvability of the Dirichlet problem (1.4) for boundary data ϕ ∈ Lp (ST , dσX × dt).

The results in this paper should be considered as the parabolic counterpart of those in the
paper [11]. As pointed out in that paper, a remarkable new aspect is the interplay between
the sub-Riemannian geometry associated with X and the nature of the boundary of the
domain Ω. In this connection, those points of ∂Ω at which the vector ﬁelds become tangent
to ∂Ω play a special role. At such points, which are known as characteristic points, solutions
of Lu = 0 reveal a behavior that is quite diﬀerent from classical caloric functions. For a
detailed discussion of this aspect in the time-independent case the reader should see [11].
In order to describe this new behavior we recall that given a bounded C 1 domain Ω ⊂ Rn,
a point x0 ∈ ∂Ω is called characteristic for the system X = {X1, . . . , Xm} if, indicating with
N (x0) a normal vector to ∂Ω at x0, one has

(cid:104)N (x0), X1(x0)(cid:105) = . . . = (cid:104)N (x0), Xm(x0)(cid:105) = 0.

The characteristic set of Ω, hereafter denoted by Σ = ΣΩ,X, is the collection of all character-
istic points of ∂Ω. It is a compact subset of ∂Ω.
In this paper we prove the boundedness of the parabolic Poisson kernel for L at the
characteristic set, under the hypothesis that the domain Ω ⊂ Rn in (1.3) satisﬁes a condition
similar to the classical Poincar´e tangent outer sphere condition, see [37]. To understand the
role of such assumption one should go back to the work of D. Jerison on the Dirichlet problem
for the Kohn Laplacian on the Heisenberg group Hn. In [26], Jerison constructed an example
of a smooth (in fact, real analytic) domain for which the Dirichlet problem admits a Green’s
function which, in the neighborhood of an isolated characteristic point, is at most H¨older
continuous up to the boundary. His domain is a paraboloid ΩM = {(z, t) ∈ Hn | t > −M|z|2},
for an approriately chosen M > 0. As a consequence, in Jerison’s example the Poisson kernel
for the Kohn Laplacian (that we introduce in the parabolic setting in Deﬁnition 1.2 below)
fails to be bounded near the isolated characteristic point (0, 0). Besides showing, in particular,
that Euclidean smoothness of the domain is not relevant in the subelliptic Dirichlet problem, a
distinctive feature of Jerison’s example is that it fails to satisfy a tangent outer ball condition
at the characteristic point (0, 0). In fact, being invariant with respect to the non-isotropic
group dilations (z, t) → (λz, λ2t), the domain ΩM should be interpreted as the analogue of a
non-convex cone in Euclidean analysis.

[32] and [11], based on smooth level sets of the time independent sub-Laplacian −(cid:80)m

The metric balls are not smooth (see [6]), and therefore it would not be possible to have a
notion of tangency based on these sets. The right notion of tangency is, as ﬁrst shown in [8],
j Xj.
These level sets are called X − balls.
In [8], [32] and [11], it was shown that, when the

j=1 X∗

4

NICOLA GAROFALO AND ISIDRO H. MUNIVE

domain satisﬁes the tangent outer X-ball condition, then it is possible to control near the
characteristic set the intrinsic horizontal gradient of the Green’s function associated to a
sub-Laplacian.
In this paper we establish a similar result for the parabolic equation (1.2) above. Beside the
outer X−ball condition, we also assume that the domain Ω ⊂ Rn in (1.3) is non-tangentially
accessible with respect to the Carnot-Carath´eodory metric associated with the system X (a
N T A domain, henceforth), see Deﬁnition 6.1 below. We also assume that Ω be C∞. The
N T A property allows us to use some of the basic results developed in [6], [23] and [35],
whereas the smoothness assumption permits us to use, away from the characteristic set,
standard tools from calculus.

The N T A domains, ﬁrst introduced in the study of the Dirichlet problem for the standard
Laplacian by Jerison and Kenig in [27], appear to be suitable for the study of boundary value
problems in sub-Riemannian geometry. The notion of N T A domain presents the advantage
of being purely metrical, and therefore, in the context of the present paper, it is intrinsic
to the underlying sub-Riemannian structure. The drawback is that producing rich classes
of examples in this setting becomes much harder since the geometry is considerably more
complicated than the Euclidean one. Fortunately, however, this has been done in the papers
[6], [33], see also [17].

Before summarizing the assumptions that we impose on the cylinder DT , we prompt the
interested reader to become acquainted with the notion of relative X-perimeter PX (E, A)
of a Borel set E ⊂ Rn with respect to a given open set A ⊂ Rn introduced in [5]. This
constitutes a generalization of De Giorgi’s notion of intrinsic perimeter. As such, it represents
the appropriate “surface measure” in sub-Riemannian geometric measure theory. With such
notion of X-perimeter, we deﬁne the X-surface measure σX on the boundary of the cross-
section Ω ⊂ Rn of the cylinder DT = Ω× (0, T ). Let x ∈ ∂Ω and r > 0, then the σX measure
of the metric surface ball ∂Ω ∩ Bd(x, r) is deﬁned in the following way:

σX (∂Ω ∩ Bd(x, r)) def= PX (Ω, Bd (x, r)) .

Deﬁnition 1.1. Given a system X = {X1, ..., Xm} of smooth vector ﬁelds satisfying (1.1),
we say that a connected bounded open set Ω ⊂ Rn is admissible with respect to the system
X, or simply ADPX, if:
1) Ω is of class C∞;
2) Ω is non-tangentially accessible (NTA) with respect to the Carnot-Carath´eodory metric

associated to the system X (see Deﬁnition 6.1 below);

3) Ω satisﬁes a uniform tangent outer X-ball condition (see Deﬁnition 4.1 below);
4) The measure σX is upper 1-Ahlfors regular. This means that there exist A, R0 > 0

depending on X and Ω such that for every x ∈ ∂Ω and 0 < r < R0 one has

σX (∂Ω ∩ Bd(x, r)) ≤ A

r

|Bd(x, r)|

.

When the condition 4) is replaced by the following balanced degeneracy assumption on the
standard surface measure σ on ∂Ω:
4(cid:48)) There exist B, R0 > 0 depending on X and Ω such that for every x ∈ ∂Ω and 0 <

max

y∈∂Ω∩Bd(x,r)

W (y)

σ (∂Ω ∩ Bd(x, r)) ≤ B

|Bd(x, r)|

r

,

r < R0 one has(cid:18)

(cid:19)

then we say that Ω is a σ − ADPX domain.

DIRICHLET PROBLEM

5

For the deﬁnition of the function W in 4(cid:48)), see (1.5) below. We emphasize that arbitrary
bounded C∞ domains need not to satisfy either conditions 4) or 4(cid:48)). For this aspect see
[8], [10], [17], [7], [11]. Furthermore, in these works it is shown that the standard surface
measure σ on ∂Ω can behave quite badly at characteristic points. The one-sided Ahlfors
property, namely assumption 4), will be needed to establish the mutual absolute continuity
of the L-parabolic measure and the horizontal perimeter measure, see Theorem 1.3 below.
Condition 4(cid:48)) instead, will be important in the proof of Theorem 1.6 below.
The constants appearing in 4) (or in 4(cid:48))), and in Deﬁnitions 4.1 and 6.1 below, will be
referred to as the ADPX-parameters (or, the σ − ADPX parameters) of Ω. We introduce
next a central character in this play, the parabolic Poisson kernel of DT = Ω × (0, T ) and
In fact, we deﬁne two such functions, each one playing a diﬀerent role. Assume that
L.
Ω ⊂ Rn be of class C∞ and let G(x, t; y, s) = GL
(x, t; y, s) indicate the Green function for
the heat operator L in (1.2) and for a cylinder DT = Ω × (0, T ). By H¨ormander’s theorem
[25] and the results in [30] and [18], see Theorem 3.5 below, for any ﬁxed (x, t) ∈ D the
function (y, s) → G(x, t; y, s) is C∞ up to the boundary in a suitably small neighborhood of
any non-characteristic point. Let ν(y) indicate the outer unit normal at y ∈ ∂Ω. At every
point y ∈ ∂Ω we denote by N X(y) the vector deﬁned by

DT

N X (y) = ((cid:104)ν (y) , X1 (y)(cid:105) , . . . ,(cid:104)ν (y) , Xm (y)(cid:105)) .

Denoting by Σ the characteristic set of Ω, we remark that the vector N X(y) = 0 if and only
if y ∈ Σ. We also consider the so-called angle function

W (y) =(cid:12)(cid:12)N X (y)(cid:12)(cid:12) =

(cid:118)(cid:117)(cid:117)(cid:116) m(cid:88)

(cid:104)ν (y) , Xj (y)(cid:105)2.

(1.5)

We note explicitly that it was proved in [5] that on ∂Ω

j=1

dσX = W dσ.

This formula implies, in particular, that it is always true that dσX << dσ, where dσ denotes
the standard surface measure on ∂Ω, but the opposite is not true in general since dσ can be
quite singular on the characteristic set.
Deﬁnition 1.2. Given a C∞ bounded open set Ω ⊂ Rn, and DT as in (1.3) above, for every
((x, t), (y, s)) ∈ DT × ((∂Ω \ Σ) × (0, T )), we deﬁne the parabolic Poisson kernel for DT and
L as follows

(cid:26) < XG (x, t; y, s) , N X (y) >, 0 < s < t,

P (x, t; y, s) =

We also deﬁne

s ≥ t

0,

K(x, t; y, s) =

P (x, t; y, s)

W (y)

.

We emphasize here that the reason for which in the deﬁnition of P (x, t; y, s) and K(x, t; y, s)
we restrict to points (y, s) ∈ (∂Ω \ Σ) × (0, T ) is that, as we have explained above, the
horizontal gradient XG(x, t; y, s) may not be deﬁned at points of Σ × (0, T ). Since the angle
function W vanishes on Σ × (0, T ), it should be clear that the function K(x, t; y, s) is more
singular then P (x, t; y, s) at the characteristic points. However, such additional singularity is

6

NICOLA GAROFALO AND ISIDRO H. MUNIVE

balanced by the fact that the density W of the measure σX with respect to surface measure
on ∂Ω vanishes at the characteristic points. As a consequence, K(x, t; y, s) is the appropriate
Poisson kernel with respect to the intrinsic measure dσX × dt, whereas P (x, t; y, s) is more
naturally attached to the “wrong measure” dσ × dt.

Hereafter, for (x, t) ∈ ST it will be convenient to indicate with
Cr(x, t) = Bd(x, r) × (t − r2, t + r2)

the parabolic cylinder centered at (x, t) with radius r > 0. We also denote by

∆r(x, t) = Cr(x, t) ∩ ST

the parabolic lateral surface cylinder centered at (x, t) with radius r > 0. The ﬁrst main
result in this paper is contained in the following theorem.
Theorem 1.3. Let DT = Ω × (0, T ), where Ω is an ADPX domain and T > 0. For every
p > 1 and any ﬁxed x ∈ Ω there exist positive constants C, R1, depending on p, M, R0, (x, T ),
and on the ADPX parameters, such that for (x0, t0) ∈ ST , with 0 < r < R1 and ∆r(x0, t0) ⊂
ST , one has

(cid:32)

(cid:90)

∆r(x0,t0)

(cid:90)

1

|∆r(x0, t0)|dσX×dt

K(x, T ; y, t)pdσX(y)dt

C

|∆r(x0, t0)|dσX×dt

∆r(x0,t0)

K(x, T ; y, t)dσX(y)dt,

(cid:33) 1

p ≤

where |∆r(x0, t0)|dσX×dt =(cid:82)

the measure dσX × dt are mutually absolutely continuous on ST .

∆r(x0,t0) dσX(y)dt. Moreover, the L-parabolic measure ω(x,T ) and

A signiﬁcant class of Carnot groups of step two in which one can construct examples of
ADPX domains is that of groups of Heisenberg type. Such groups constitute a generalization
of the Heisenberg group and they carry a natural complex structure. Let g be a graded
nilpotent Lie algebra of step two. This means that g admits a splitting g = V1 ⊕ V2, where
[V1, V1] = V2, and [V1, V2] = 0. We endow g with an inner product (cid:104)·,·(cid:105) with respect to which
the decomposition V1 ⊕ V2 is orthogonal. Let G be the connected and simply connected
graded nilpotent Lie group associated with g. Consider the map J : V2 → End(V1) deﬁned
for every η ∈ V2 by

(cid:104)J(η)ξ, ξ(cid:48)(cid:105) = (cid:104)[ξ, ξ(cid:48)], η(cid:105),

ξ, ξ(cid:48) ∈ V1, η ∈ V 2.

Then, G is said of H-type (Heisenberg type) if J(η) is an orthogonal map on V1 for every
η ∈ V2 such that (cid:107)η(cid:107) = 1. When G is of H-type we thus have for ξ, ξ(cid:48) ∈ V1, η ∈ V2,

(cid:104)J(η)ξ, J(η)ξ(cid:48)(cid:105) = (cid:107)η(cid:107)2(cid:104)ξ, ξ(cid:48)(cid:105).

The J map induces a complex structure since in every group of H-type one has for every
η, η(cid:48) ∈ V2,

J(η)J(η(cid:48)) + J(η(cid:48))J(η) = −2(cid:104)η, η(cid:48)(cid:105)I,

see [29]. In particular,

J(η)2 = −(cid:107)η(cid:107)2I.

DIRICHLET PROBLEM

7

We mention explicitly that, thanks to the results in [29], in every group of Heisenberg type
with an orthogonal system X of generators of g = V1 ⊕ V2, the fundamental solution of the
sub-Laplacian associated with X is given by

where Q = dim V1 + 2 dim V2 is the homogeneous dimension of G, and

C(G)

Γ(x, y) =

N (x, y)Q−2 ,

N (x, y) =(cid:0)|x|4 + 16|y|2(cid:1)1/4 .

The following result provides a general class of domains satisfying the uniform X-ball condi-
tion, see [8], [9], [10], [11], and also [32]. We recall the following deﬁnition from [10]. Given
a Carnot group G, with Lie algebra g, a set A ⊂ G is called convex, if exp−1(A) is a convex
subset of g.
Theorem 1.4. Let G be a Carnot group of Heisenberg type and denote by X = {X1, . . . , Xm}
a set of generators of its Lie algebra. Every C∞ convex bounded domain Ω ⊂ G is a ADPX
and also a σ − ADPX domain.
In particular, the gauge balls in G are ADPX and also
σ − ADPX domains.

By combining Theorem 1.3 and Theorem 1.4 with the results in [35] and [23], we can solve
the Dirichlet problem with boundary data in Lp with respect to the measure dσX × dt in
cylinders DT = Ω × (0, T ) ⊂ G × (0, T ), where G is a group of Heisenberg-type and Ω is a
C∞ convex bounded domain. To state the relevant results we need to introduce a deﬁnition.
For any (y, s) ∈ ST a nontangential region at (y, s) is deﬁned by

where

Γα(y, s) = {(x, t) ∈ DT : dp((x, t), (y, s)) < (1 + α)dp((x, t), ST )} ,

dp((x, t), (y, s)) =(cid:112)d(x, y)2 + |t − s|.

Given a function u ∈ C(DT ), the α−nontangential maximal function of u at y is deﬁned by

Nα(u)(y, s) =

sup

(x,t)∈Γα(y,s)

|u(x, t)| .

In the following result L indicates the heat equation associated with any sub-Laplacian on
G.
Theorem 1.5. Let G be a Carnot group of H-type and Ω ⊂ G be a C∞ convex bounded do-
main. Set DT = Ω×(0, T ), with 0 < T < ∞. Then, for every p > 1, if f ∈ Lp (ST , dσX × dt),
the generalized solution H DT

to the problem

f

on ST ,
on Ω × {0}

u = f
u = 0

 Lu = 0 in DT ,
(cid:90)
(cid:1)(cid:13)(cid:13)Lp(ST ,dσX dt)

ST

f

H DT

(cid:13)(cid:13)Nα

(cid:0)H DT

f

exists, and it is given by

Moreover, there exists a constant C > 0, depending on G, Ω and p, such that

(x, t) =

K(x, t, y, s)f (y, s)dσX(y)ds.

≤ C (cid:107)f(cid:107)Lp(ST ,dσX dt) .

8

NICOLA GAROFALO AND ISIDRO H. MUNIVE

Furthermore, H DT

f

converges nontangentially dσX × dt−a.e. to f on ST .

Theorems 1.3 and 1.5 provide solvability of the Dirichlet problem with respect to the
“natural” surface measure dσX ×dt on ST . On the other hand, even if, as we have mentioned,
the ordinary surface measure dσ × dt is the “wrong one” in the Dirichlet problem, it would
still be highly desirable to know if there exist situations in which (1.4) can be solved for
boundary data in some Lp with respect to dσ × dt. This is where the notion of σ − ADPX
domain becomes relevant.
Theorem 1.6. Let DT1 = Ω × (0, T1), where Ω is a σ − ADPX domain and T1 > 0. For
every p > 1 and any ﬁxed (x, T ) ∈ DT1 there exist positive constants C, R1, depending on
p, M, R0, (x, T ), and on the σ − ADPX parameters, such that for that for (x0, t0) ∈ ST , with
0 < r < R1 and ∆r(x0, t0) ⊂ ST , one has

(cid:18)

(cid:90)

(cid:19) 1

p ≤

1

|∆r(x0, t0)|dσ×dt
C

(cid:90)

∆r(x0,t0)

P (x, T ; y, t)pdσX(y)dt

where |∆r(x0, t0)|dσ×dt = (cid:82)

|∆r(x0, t0)|dσ×dt
∆r(x0,t0) dσdt. Moreover, the L-parabolic measure ω(x,T ) and the

P (x, T ; y, t)dσX(y)dt,

∆r(x0,t0)

measure dσ × dt on ST are mutually absolutely continuous.

Combining Theorems 1.6 and 1.4, we obtain the following result.

Theorem 1.7. Let G be a Carnot group of Heisenberg-type and Ω ⊂ G be a bounded C∞
convex set. Set DT = Ω×(0, T ), with 0 < T < ∞. For every p > 1, and f ∈ Lp (ST , dσ × dt),
then the generalized solution H DT

to the problem

f

on ST ,
on Ω × {0}

u = f
u = 0

 Lu = 0 in DT ,
(cid:90)
(cid:1)(cid:13)(cid:13)Lp(ST ,dσdt)

ST

H DT

f

(cid:13)(cid:13)Nα

(cid:0)H DT

f

≤ C (cid:107)f(cid:107)Lp(ST ,dσdt) .

exists, and it is given by

Moreover, there exists a constant C > 0 depending on G, Ω and p, such that

(x, t) =

P (x, t, y, s)f (y, s)dσ(y)ds.

Furthermore, H DT

f

converges nontangentially dσ × dt−a.e. to f on ST .

In closing, we brieﬂy describe the organization of the paper. In Section 2 we collect some
known results on Carnot-Carath´eodory metrics that are needed in the paper.
In Section
3 we discuss some known results on the subelliptic Dirichlet problem which constitute the
potential theoretic backbone of the paper.
In Section 4, we use the interior Schauder estimates in [16] to prove that if the cross-section
Ω of the cylinder DT = Ω × (0, T ) satisﬁes a uniform outer tangent X-ball condition, then
the horizontal gradient of the Green function G is bounded up to the lateral boundary ST ,
hence, in particular, near ΣT , see Theorem 4.5. The proof of such result rests in an essential
way on the linear growth estimate provided by an ad-hoc barrier, inspired by the one used

DIRICHLET PROBLEM

9

in [8], [32] and [11]. In the ﬁnal part of the section we show that, by imposing the uniform
outer X-ball condition only in a neighborhood of the characteristic set Σ, we are still able to
obtain the boundedness of the horizontal gradient of G up to the characteristic set, although
we now lose the uniformity in the estimates, see Corollary 4.6.

In Section 5, we establish a Poisson type representation formula for domains whose base
satisfy the uniform outer X-ball condition in a neighborhood of the characteristic set. This
result generalizes the Poisson type formula in [19] to the non-Euclidean setting of this paper.
If the Green function of a smooth domain had bounded horizontal gradient up to the charac-
teristic set, then such Poisson formula would follow in an elementary way from integration by
parts. As we previously stressed, however, things are not so simple and the boundedness of
XG fails in general near the characteristic set. However, when Ω ⊂ Rn satisﬁes the uniform
outer X-ball condition in a neighborhood of the characteristic set, then combining Theorem
4.5 with the estimate

K(x, t; y, s) ≤ |XG(x, t; y, s)| , x ∈ Ω, y ∈ ∂Ω,

and 0 ≤ s ≤ t,

see (5.3), we prove the boundedness of the Poisson kernel (y, s) → K(x, t; y, s) on ST . The
main result in section 5 is Theorem 5.9. Solvability of (1.4) with data in Lebesgue classes
requires, however, a much deeper analysis.

In the opening of Section 6 we recall the deﬁnition of N T A-domain along with those results
from [35], [22] and [23] which constitute the foundations of the present study. Using these
results we establish Theorem 8.9. The remaining part of the section is devoted to proving
Theorems 1.3, 1.5, 1.6 and 1.7.

2. Preliminaries

In Rn, with n ≥ 3, we consider a system X = {X1, . . . , Xm} of C∞ vector ﬁelds satisfying
H¨ormander’s ﬁnite rank condition (1.1). A piecewise C 1 curve γ : [0, (cid:96)] → Rn is called
subunitary in [20] if whenever γ(cid:48)(t) exists one has for every ξ ∈ Rn

We note explicitly that the above inequality forces γ(cid:48)(t) to belong to the span of {X1(γ(t)), . . . ,
Xm(γ(t))}. The subunit length of γ is by deﬁnition ls(γ) = (cid:96). If we ﬁx an open set Ω ⊂ Rn,
then given x, y ∈ Ω, denote by SΩ(x, y) the collection of all sub-unitary γ : [0, (cid:96)] → Ω which
join x to y. The fundamental accessibility theorem of Chow and Rashevsky, [12], [38], states
that, if Ω is connected, then for every x, y ∈ Ω there exists γ ∈ SΩ(x, y). As a consequence,
if we deﬁne

dΩ(x, y) = inf {ls(γ) | γ ∈ SΩ(x, y)},

we obtain a distance on Ω, called the Carnot-Carath´eodory distance, associated with the
system X. When Ω = Rn, we write d(x, y) instead of dRn(x, y). It is clear that d(x, y) ≤
dΩ(x, y), x, y ∈ Ω, for every connected open set Ω ⊂ Rn. In [36] it was proved that, given
Ω ⊂⊂ Rn, there exist C, ε > 0 such that
C|x − y| ≤ dΩ(x, y) ≤ C−1|x − y|ε,
(2.1)
This gives d(x, y) ≤ C−1|x − y|ε, x, y ∈ Ω, and therefore

x, y ∈ Ω.

i : (Rn,| · |) → (Rn, d)

is continuous.

< γ(cid:48)(t), ξ >2 ≤ m(cid:88)

j=1

< Xj(γ(t)), ξ >2 .

10

NICOLA GAROFALO AND ISIDRO H. MUNIVE

It is easy to see that also the continuity of the opposite inclusion holds [24], hence the metric
and the Euclidean topologies are equivalent.
For x ∈ Rn and r > 0, we let Bd(x, r) = {y ∈ Rn | d(x, y) < r}. The basic properties
of these balls were established by Nagel, Stein and Wainger in their seminal paper [36].
Denote by Y1, ..., Yl the collection of the X(cid:48)
js and of those commutators which are needed to
generate Rn. A formal “degree” is assigned to each Yi, namely the corresponding order of
the commutator. If I = (i1, . . . , in), 1 ≤ ij ≤ l is a n-tuple of integers, following [36] we let
j=1 deg(Yij ), and aI(x) = det(Yi1, . . . , Yin). The Nagel-Stein-Waigner polynomial is

d(I) =(cid:80)n

deﬁned by

(cid:88)

Λ(x, r) =

|aI(x)|rdI

For a given bounded open set U ⊂ Rn, we let

I

Q = sup{d(I)||aI(x)| (cid:54)= 0, x ∈ U} , Q(x) = inf {d(I)||aI(x)| (cid:54)= 0} ,

(2.2)
and notice that n ≤ Q(x) ≤ Q. The numbers Q and Q(x) are respectively called the local
homogeneous dimension of U and the homogeneous dimension at x with respect to the system
X.
Theorem 2.1. For every bounded open set U ⊂ Rn, there exist constants C, R0 > 0 such
that, for any x ∈ U , and 0 < r ≤ R0,

(2.3)

C ≤ |Bd(x, r)|

Λ(x, r)

≤ C−1.

(2.4)

As a consequence, one has with C1 > 0,
|Bd(x, 2r)| ≤ C1|Bd(x, r)|

Let Γ (x, y) = Γ (y, x) be the positive fundamental solution of the sub-Laplacian −(cid:80)m

for every x ∈ U and

0 < r ≤ R0.

i=1 X∗

i Xi

and consider its level sets

Ω(x, r) =

(cid:26)

(cid:27)

.

y ∈ Rn : Γ(x, y) >

1
r

Let us recall the notion of X-ball, introduced in [8].
Deﬁnition 2.2. For every x ∈ Rn, and r > 0, the set
y ∈ Rn : Γ (x, y) >

B (x, r) =

(cid:26)

(2.5)

(cid:27)

,

1

E (x, r)

where E(x, r) def= Λ(x, r)/r2, will be called the X-ball, centered at x with radius r.

The X-balls are equivalent to the Carnot-Carath´eodory balls:

exists a > 1, depending on U and X, such that

(cid:0)x, a−1r(cid:1) ⊆ B (x, r) ⊆ Bd (x, ar) ,

(2.6)
for x ∈ U , 0 < d (x, y) ≤ R0, for some local parameter R0, which depends only on n and X.

Bd

for every U ⊂ Rn, there

DIRICHLET PROBLEM

11

2.1. Strong maximum principle. Consider the cylinder DT = Ω × (0, T ), where Ω ⊂ Rn
and T > 0. We deﬁne the class Γ2(DT ) to be the set of all continuous functions u on DT
such that ∂tu as well as Xiu and XiXju are continuous in DT for all i, j = 1, . . . , m.
Theorem 2.3. Let Ω ⊂ Rn be a connected, bounded open set, and T > 0. Let u ∈ Γ2(DT )
and u ≤ 0 in DT .
(1) Suppose that Lu ≥ 0 in DT , then, if u(x0, t0) = 0 for some (x0, t0) ∈ DT , we have
(2) Suppose that L∗u ≥ 0 in DT , then, if u(x0, t0) = 0 for some (x0, t0) ∈ DT , we have

u(x, t) ≡ 0 whenever (x, t) ∈ DT ∩ {t : t ≤ t0}.
u(x, t) ≡ 0 whenever (x, t) ∈ DT ∩ {t : t ≥ t0}.

Proof. It follows from Theorem 3.2 in [1].

(cid:3)

2.2. Gaussian bounds. We close this section with the following basic estimate due to
Kusuoka and Stroock [31], see also [28].
In order to use this result we need to assume
that outside a compact set K ⊂ Rn, with Ω ⊂ K, the system X equals the standard basis
for Rn. Since our results are local in nature the imposition of such hypothesis on the system
X has no consequences for our theory.
Theorem 2.4. The fundamental solution p(x, t; ξ, τ ) = p(x; ξ, t − τ ) with singularity at
there exists M = M (X) > 0 and for every
(ξ, τ ) satisﬁes the following size estimates:
k, s ∈ N ∪ {0}, there exists a constant C = C (X, k, s) > 0, such that

(cid:12)(cid:12)(cid:12)(cid:12) ∂k

∂tk Xj1Xj2...Xjsp(x, t; ξ, τ )

p(x, t; ξ, τ ) ≥

C

√
1

t − τ(cid:1)(cid:12)(cid:12) exp
(cid:12)(cid:12)Bd
(cid:0)x,
(cid:32)
t − τ(cid:1)(cid:12)(cid:12) exp
−M−1d (x, ξ)2

t − τ

(t − τ )s+2k
C−1
√

(cid:0)x,

(cid:33)

,

(cid:32)
−M d (x, ξ)2
(cid:33)

t − τ

,

for every x, ξ ∈ Rn and any −∞ < τ < t < ∞.

(cid:12)(cid:12)(cid:12)(cid:12) ≤
(cid:12)(cid:12)Bd

(cid:40)

3. Dirichlet Problem

In the following we let D ⊂ Rn+1 be any bounded open set, for which we assign f ∈ C(∂pD),

and we study the Dirichlet problem

Lu = 0,
u = f

in D,
on ∂pD.

We say that D is L-regular if for any f ∈ C(∂pD) there exists a unique function H D

(3.1)
If u : D → R is a smooth function satisfying Lu = 0 in D, then we say that u is L-parabolic
in D. We denote by PL(D) the linear space of functions which are L-parabolic in D.
f ∈
PL(D) such that lim(x,t)→(x0,t0) H D
f (x, t) = f (x0, t0) for every (x0, t0) ∈ ∂pD. Furthermore, if
D is L-regular, then in view of Theorem 2.3 (one actually only needs the weaker form of it) for
every ﬁxed (x, t) ∈ D the map f (cid:55)→ H D
f (x, t) deﬁnes a positive linear functional on C(∂pD).
By the Riesz representation theorem there exists a unique Borel measure ω(x,t) = ω(x,t)
D ,
supported in ∂pD, such that for every f ∈ C(∂pD) one has

(3.2)

H D

f (x, t) =

f (y, s)dω(x,t)(y, s).

(cid:90)

∂pD

12

NICOLA GAROFALO AND ISIDRO H. MUNIVE

A lower semi-continuous function u : D → ] − ∞,∞] is said to be H-superparabolic in D

We will refer to ω(x,t) as the L-parabolic measure relative to D and (x, t).
if u < ∞ in a dense subset of D and if
u(x, t) ≥

u(y, s)dω(x,t)

(y, s),

(cid:90)

∂V

V

+

for every open L-regular set V ⊂ V ⊂ D and for every (x, t) ∈ V . We denote by S(D) the set
(D) the set of the functions in S(D) which are
of L-superparabolic functions in D, and by S
nonnegative. A function v : D → [−∞,∞[ is said to be L-subparabolic in D if −v ∈ S(D)
and we write S(D) := −S(D). As the collection of L-regular sets is a basis for the Euclidean
topology according to Corollary 5.2 in [1], it follows that S(D) ∩ S(D) = PL(D). Finally,
we recall that H D
f can be realized as the generalized solution in the sense of Perron-Wiener-
Brelot-Bauer to the problem (3.1). In particular,
f = supU D

f = H D
f ,

inf U D

(3.3)
where we have indicated with U D
lim inf

(x,t)→(x0,t0)

f the collection of all u ∈ S(D) such that inf D u > −∞, and
u(x, t) ≥ f (x0, t0), ∀ (x0, t0) ∈ ∂pD,

and with U D

f the collection of all u ∈ S(D) for which supD u < ∞, and

u(x, t) ≤ f (x0, t0),

for every (x0, t0) ∈ ∂pD.

lim sup
(x,t)→(x0,t0)

Lemma 3.1. Let D ⊂ Rn+1 be a bounded open set, let f ∈ C(∂pD), and let u be the
generalized Perron-Wiener-Brelot-Bauer solution to the problem (3.1), i.e., u = H D
f where
f be deﬁned as in (3.3). Then, u ∈ Γ2(D).
H D
Proof. This follows from Theorem 1.1 in [39].

(cid:3)

Brelot type holds.

Here, it is important to recall that, thanks to the results in [1], the following result of

Theorem 3.2. A function f is resolutive if and only if f ∈ L1(cid:0)∂pD, dω(x,t)(cid:1), for one (and

therefore for all) (x, t) ∈ D.

In the following we are concerned with the issue of regular boundary points and we note,
concerning the solvability of the Dirichlet problem for the operator L, that in [39] Uguzzoni
developes what he refers to as a “cone criterion” for non-divergence equations modeled on
H¨ormander vector ﬁelds. This is a generalization of the well-known positive density condition
of classical potential theory. In the following we describe his result in the setting of domains
of the form DT = Ω × (0, T ) where Ω ⊂ Rn is assumed to be a bounded domain. In [39]
a bounded open set Ω is said to have outer positive d-density at x0 ∈ ∂Ω if there exist r0,
ϑ > 0 such that

(3.4)

|Bd(x0, r) \ Ω| ≥ ϑ|Bd(x0, r)|,

for all r ∈ (0, r0).

Furthermore, if r0 and ϑ can be chosen independently of x0 then one says that Ω satisﬁes the
outer positive d-density condition. The following lemma is a special case of Theorem 4.1 in
[39].

DIRICHLET PROBLEM

13

Lemma 3.3. Assume that Ω satisﬁes the outer positive d-density condition. Given f ∈
C(∂pDT ), there exists a unique solution u ∈ Γ2(DT ) ∩ C(DT ∪ ∂pDT ) to the problem (3.1).
In particular, DT is L-regular for the Dirichlet problem (3.1).

For a cylinder DT = Ω × (0, T ), where Ω ⊂ Rn is open and bounded, the Green function,

G, is given by G (x, t; y, s) = p (x, t; y, s) − h(y,s) (x, t) where h(y,s) solves

(cid:26) Lh(y,s) = 0

h(y,s) (x, t) = p (x, t; y, s) on ∂pDT .

in DT ,

The existence of the Green function follows from the results of [1] and [3]. In the following
result we use the short notation z = (x, t), ζ = (y, s).

Theorem 3.4. Let Ω ⊂ Rn be a regular domain for the sub-Laplacian −(cid:80)m
(1) G is a continuous function deﬁned on the set(cid:8)(z; ζ) ∈ (Ω × [0, T )) × (Ω × (0, T )) : z (cid:54)= ζ(cid:9).

j Xj. Then,
there exists a Green function G = GΩ for L and the cylinder DT = Ω × (0, T ) with the
properties listed below:

j=1 X (cid:63)

Moreover, for every ﬁxed ζ ∈ DT , G(·; ζ) ∈ C∞(DT \ {ζ}), and we have

L(G(·; ζ)) = 0

in (DT ) \ {ζ}, G(·; ζ) = 0

in ∂Ω × (0, T )

(2) We have 0 ≤ G ≤ p. Moreover, G(x, t; y, s) = 0 if t < s.
(3) For every ϕ ∈ C(Ω) such that ϕ = 0 in ∂Ω and for every ﬁxed s ∈ (0, T ) the function

x ∈ Ω, t > s
belongs to the class C∞(Ω × (s, T )) ∩ C([s, T ) × Ω) and solves

G(x, t; y, s)ϕ(y)dy,

u(x, t) =

(cid:90)
 Lu = 0

Ω

in Ω × (s, T ),
in ∂Ω × [s, T ),

u = 0
u(·, s) = ϕ in Ω.

We close this section with an important consequence of the results of Derridj [18] about
Given a closed set S ⊂ Rn+1, we will denote by C∞(S) the collection of the restrictions to

smoothness in the Dirichlet problem at non-characteristic points.
S of functions ϕ ∈ C∞(U ), where U ⊂ Rn+1 is open with S ⊂ U .

Theorem 3.5. Let Ω ⊂ Rn be a C∞ domain which is regular for the sub-Laplacian −(cid:80)m

j=1 X (cid:63)
j Xj,
and set DT = Ω × (0, T ). Consider the caloric function H DT
If
x0 ∈ ∂Ω is a non-characteristic point, then there exists an open neighborhood V of x0 such
that H DT

ϕ , with ϕ ∈ C∞(∂pDT ).

ϕ ∈ C∞((V ∩ Ω) × (0, T )).

4. Boundary Estimates for the Green Function

In this section we establish some estimates for the Green function as well as for its horizontal

gradient near the bounday assuming some conditions on the geometry of the domain Ω.
Deﬁnition 4.1. A domain Ω ⊂ Rn is said to possess an outer X-ball tangent at x0 ∈ ∂Ω if
for some r > 0 there exists a X-ball B(x1, r) such that:
(4.1)

x0 ∈ ∂B(x1, r), B(x1, r) ∩ Ω = ∅.

We say that Ω possesses the uniform outer X-ball if one can ﬁnd R0 > 0 such that for every
x0 ∈ ∂Ω, and any 0 < r < R0, there exists a X-ball B(x1, r) for which (4.1) holds.

(cid:110) ∂

(cid:111)

14

NICOLA GAROFALO AND ISIDRO H. MUNIVE

, . . . , ∂
∂xn

∂x1

Notice that, when X =

, then the distance d(x, y) is just the ordinary
Euclidean distance |x − y|. In such case, Deﬁnition 4.1 coincides with the notion introduced
by Poincar´e in his classical paper [37]. In this setting a X -ball is just a standard Euclidean
ball, and, hence, a domain possesses the uniform outer X -ball condition if and only if it is
C 1,1 smooth. In the sub-Riemannian setting, the gauge balls in Carnot groups of Heisenberg-
type satisfy the uniform outer X-ball condition. In fact, as it has already been mentioned
in the introduction, every bounded convex subset of such Carnot groups satisfy the uniform
outer X-ball condition, see Theorem 1.4 and the original sources [9] and [32]. Moreover, it
should be clear from (2.6) and Theorem 3.3 that if Ω ⊂ Rn satisﬁes the uniform outer X -ball
condition, then D = Ω × (0, T ), T > 0, is regular for the Dirichlet problem (3.1).
such that for every (x, t), (y, s) ∈ DT
0 ≤ G(x, t; y, s) ≤

(4.2)
Lemma 4.2. Let DT = Ω × (0, T ), where Ω ⊂ Rn is a connected, bounded open set and
T > 0. Suppose that for some r > 0, Ω has an outer X-ball B(x1, r) tangent at x0 ∈ ∂Ω. Let

From Theorem 2.4, and the maximum principle, one easily sees that there exists C > 0

t − s(cid:1)(cid:12)(cid:12) exp

(cid:12)(cid:12)B(cid:0)x,

−M d (x, y)2

t − s

(cid:32)

(cid:33)

√
C

.

Cr = B(x1, 2r) × (s0, T ),

for some 0 ≤ s0 < T . There exists C > 0, depending only on Ω and on X, such that if
ϕ ≡ 0 on (B(x1, 2r) ∩ Ω) × {s0},
ϕ ∈ C(∂pDT ), ϕ ≡ 0 on (B(x1, 2r) ∩ ∂Ω) × (s0, T ) and H DT
then for every (x, t) ∈ Ω × (s0, T ), we have

|H DT

ϕ (x, t)| ≤ C

d(x, x0)

|ϕ|.

max
∂pDT

r

Proof. We can assume without loss of generality that max∂pDT |ϕ| = 1. Now, we consider the
following barrier

E(x1, r)−1 − Γ(x1, x)
E(x1, r)−1 − E(x1, 2r)−1 ,

v(x, t) def=

(4.3)
with domain Rn×(0,∞). Clearly, Lv = 0 in (Rn \ {x1})×(0,∞) and v ≥ 0 in (Rn \ B (x1, r))×
(0,∞). Furthermore, v ≡ 1 on (∂B(x, 2r) ∩ Ω)×(0, T ) and v ≥ 1 in (Rn \ B (x1, 2r))×(0, T ).
Therefore, the maximum principle implies
ϕ (x, t)| ≤ v (x, t) ,

(x, t) ∈ Cr ∩ D.

for every

|H DT

In order to ﬁnish the proof, we recall from Theorem 6.3 in [8] that there exits C = C(X, Ω) > 0
such that

v (x, t) ≤ C

d (x0, x)

r

for every

x ∈ Ω.

(cid:3)

Theorem 4.3. Suppose that Ω satisfy the uniform outer X-ball condition with constant R0.
Then, there exist C, M1 > 0, depending on X and Ω, such that the Green function for L and
DT = Ω × (0, T ) satisﬁes the estimate

G (x, t; y, s) ≤

(d (x, y) ∧ R0)(cid:12)(cid:12)Bd

Cd (y, ∂Ω)

(cid:0)x,

t − s(cid:1)(cid:12)(cid:12) exp

√

−M1d (x, y)2

t − s

(cid:32)

(cid:33)

with x (cid:54)= y ∈ Ω and 0 ≤ s < t < T .
Proof. Consider a > 1 as in (2.6). Because of (4.2) we may assume that

DIRICHLET PROBLEM

15

ad(y, ∂Ω) <

Choose

and d (y, ∂Ω) < R0.

d(x, y)
a(a + 3)

(cid:18) d (x, y)

(cid:19)

aR0
2

(4.4)
Let x0 ∈ ∂Ω such that d (x0, y) = d (y, ∂Ω). Let B (x1, r/a) be the outer X-ball tangent to
the boundary of Ω at x0. Since

2a (a + 3)

r = min

,

.

x0 ∈ B(x1, r/a) ⊂ Bd(x1, r),

we have

(4.5)

Therefore,

(4.6)

d (y, x1) ≤ d (y, x0) + d (x0, x1) <

+ r <

a + 3

r.

(cid:0)x1, a−1(a + 3)r(cid:1) ⊆ B (x1, (a + 3)r) .

a

y ∈ Bd

2r
a

On the other hand, the triangle inequality gives

and therefore we obtain

d (x, x1) ≥ d (x, y) − d (y, x1) ≥ d (x, y) − a + 3
r
a
1 − 1
2a2

> d (x, y)

(cid:18)

(cid:19)

,

x ∈ Rn \ Bd

x1,

1 − 1
2a2

d (x, y)

.

(cid:18)

(cid:18)
(cid:19)

(cid:19)

(cid:18)

(cid:19)
(cid:18)

⊂ Rn \ B
1 − 1
2a2
⊂ Rn \ B (x1, (a + 3) r),

x1,

1
a

(cid:18)

(cid:18)

(cid:19)

Rn \ Bd

x1,

1 − 1
2a2

d (x, y)

By the equivalence between X-balls and Carnot-Carathe´odory balls, see (2.6), we have

given that a > 1. Consider the cylinder

Cr = B (x1, (a + 3)r) × [s, t).

For z ∈ B (x1, (a + 3)r),

(cid:18)

(4.7)

Deﬁne

where β2 =(cid:0)1 − 1

w (z, τ )

2a2 − 1

2a

d (x, z) ≥ d (x, x1) − d (z, x1) ≥ d (x, y)

1 − 1

(cid:32)

.

√

t − s(cid:1)(cid:12)(cid:12) exp

= C(cid:12)(cid:12)Λ(cid:0)x,
(cid:1) and C = C(X, Ω) is a suitable positive constant that will be chosen

2d (x, y)2
t − s

G (x, t; z, τ ) ,

M β2

2a2 − 1
(cid:33)

2a

in a moment. Consequently, since x ∈ Rn \ B(x1, (a + 3)r), we have from (2.3), the Gaussian

(cid:19)

(cid:19)

d (x, y)

(cid:19)

.

16

NICOLA GAROFALO AND ISIDRO H. MUNIVE

(cid:18) 1

(cid:19)(cid:19)

(cid:12)(cid:12)Λ(cid:0)x,
(cid:12)(cid:12)B(x,

t − s(cid:1)(cid:12)(cid:12)
t − τ )(cid:12)(cid:12) exp

√
√

(cid:18)

bounds in (4.2) and the estimate (4.7) that we can ﬁnd a positive constant C = C(X, Ω)
such that

w (z, τ ) ≤ C

≤ 1,
with (z, τ ) ∈ (∂B(x1, (a + 3)r) ∩ Ω) × [s, t). Furthermore, w ≡ 0 on ST ∩ Cr and

− 1
t − τ

M d (x, z)2

t − s

w(z, τ ) = 0 with z ∈ B(x1, (a + 3)r) ∩ DT .

lim
τ(cid:37)t

Notice that we also have L∗w = 0. Let Dr .
adjoint heat equation L∗, where ϕ ∈ C(∂∗

= Cr ∩ DT and consider the solution H Dr

pDr), 0 ≤ ϕ ≤ 1, is such that

ϕ ≡ 0 on ((B(x1, (1 + a)r) ∩ ∂Ω) × (s, t)) ∪ ((B(x1, (1 + a)r) ∩ ∂Ω) × {t}).

Moreover, ϕ ≡ 1 on
(∂B(x1, (a + 3)r) ∩ Ω) × (s, t).
Observe that B(x1, (a + 3)r) ∩ Ω satisﬁes the uniform X−ball condition at x0 ∈ Ω. By the
L∗−version of Lemma 4.2 we conclude that for (z, τ ) ∈ Dr,

ϕ of the

Since w ≤ H Dr

ϕ

ϕ (z, τ ) ≤ C
H Dr

d(z, ∂Ω)

r

.

in Dr, the result follows with M1 = M β2
2.

(cid:3)

Recall that the main goal of this section is to estimate the horizontal gradient of the Green
function up to the lateral boundary. In order to establish this estimate we state ﬁrst the
following theorem from [16]. Before stating the result, we introduce some notation. For
(x, t) ∈ Rn, we consider the following parabolic cylinders

Qr(x, t) = Bd(x, r) × (t, t + r2) Q+

r (x, t) = Bd(x, r) × (t +

r2
4

, t +

).

r2
2

Theorem 4.4. Let D ⊂ Rn+1 be an open subset and suppose that u ≥ 0 solves L∗u = 0.
There exists R1 > 0 depending on D and X such that for every (x0, t0) ∈ D and 0 < r ≤ R1
for which Qr(x0, t0) ⊂ D, one has for any s, k ∈ N, for some constant C = C (D, X, s, k) > 0,

(cid:12)(cid:12)(cid:12)(cid:12) ∂k

(cid:12)(cid:12)(cid:12)(cid:12) ≤ C

sup
r (x0,t0)

Q+

∂tk Xj1Xj2...Xjsu

rs+2k u (x0, t0) .

In the above estimate, for every i=1,. . . ,s, the index ji runs in the set {1, . . . , m}.
We can now prove our main estimate.

Theorem 4.5. Asume the uniform X-ball condition for Ω. There exist constants C, M1 > 0,
depending only on X and Ω, such that

|XG (x, t; y, s)| ≤

×

d(y, ∂Ω)

d(y, ∂Ω) ∧ √

t − s ∧ R1

C

(d (x, y) ∧ R0)
×

√
1

(cid:0)x,

(cid:12)(cid:12)Bd

t − s(cid:1)(cid:12)(cid:12) exp

(cid:32)

−M1d (x, y)2

t − s

(cid:33)

,

where x (cid:54)= y ∈ Ω and 0 < s < t < T . Here, R0 is the constant in Deﬁnition 4.1 and R1 is
the constant in Theorem 4.4.

DIRICHLET PROBLEM

17

Proof. Notice that the Green function, G (x, t; y, s), is well deﬁned for 0 < s < t < T . Let
0 < r < R1 be as in Theorem 4.4 such that (x, t) /∈ Qr (y, s − r2/16) ⊂ DT . Notice that

If we apply Theorem 4.4 to the function G(x, t;·,·) at the point (y, s − r2/16) we obtain

(y, s) ∈ Q

+
r/2

(cid:0)y, s − r2/16(cid:1) .
G(cid:0)x, t; y, s − r2/16(cid:1) .
(cid:33)

d (y, ∂Ω)

,

R1
2

,

2

Choose

r = min

|XG (x, t; y, s)| ≤ C
r

(cid:32)

2

(cid:114) t − s

,

15

and then invoke Theorem 4.3 to obtain

|XG (x, t; y, s)| ≤

×

Cd (y, ∂Ω)

1

(cid:16)

r (d (x, y) ∧ R0)

(cid:12)(cid:12)(cid:12)Bd
r (d (x, y) ∧ R0)(cid:12)(cid:12)Bd

x,(cid:112)t − s + r2/16
(cid:0)x,

Cd (y, ∂Ω)

√

(cid:33)

(cid:32)
− M d (x, y)2
t − s + r2/16
(cid:32)
−M1d (x, y)2

(cid:17)(cid:12)(cid:12)(cid:12) exp
t − s(cid:1)(cid:12)(cid:12) exp

t − s

.

(cid:33)

Observe that t − s ≤ t − s + r2/16 ≤ 2 (t − s), therefore

|XG (x, t; y, s)| ≤

(cid:3)
From this we easily obtain the desired conclusion in Theorem 4.5, with M1 = 2M .
Corollary 4.6. Let DT = Ω× (0, T ), where Ω ⊂ Rn is a bounded open set. If Ω satisﬁes the
outer X-ball condition in V , where V is a neighborhood of Σ, then for any (x0, t0) ∈ DT and
every open neighborhood U of ∂Ω such that x0 /∈ U , one has

(cid:107)G (x0, t0;·,·)(cid:107)L∞(U×(0,t0)) + (cid:107)XG (x0, t0;·,·)(cid:107)L∞(U×(0,t0)) ≤ C(x0, t0, Ω, V, U, X).

5. Representation formula for caloric functions

In this section we establish a representation formula for smooth domains that satisfy the
outer X-ball condition. Consider a cylinder DT = Ω × (0, T ), where Ω ⊂ Rn is a bounded
open set regular for the Dirichlet problem, and denote by G(x, t; y, s) the Green function for
L and DT . Fix a point (x, t) ∈ DT and consider a C∞ domain U ⊂ U ⊂ Ω containing x, and
we let 0 < s < t < T . For any u, v ∈ C∞(DT ) we obtain from the divergence theorem

(vLu − uL∗v) dyds =

[uXjv − vXju](cid:104)Xj, νy(cid:105) dσ

0

∂U

v (y, s) u (y, s) dy +

v (y, 0) u (y, 0) dy

(cid:90)

U

Recall that G (x, t; y, s) = p (x, t; y, s) − h(y,s) (x, t), where h(y,s) is the unique L-parabolic
function with boundary values p(·,· ; y, s). The function G is continuous in any relatively

(cid:90) s

(cid:90)

m(cid:88)
(cid:90)

j=1

−

U

(cid:90)

U×(0,s)

18

NICOLA GAROFALO AND ISIDRO H. MUNIVE

compact subdomain of DT \ {(x, t)}. If we let v (y, s) = G (x, t; y, s) in the above equation,
keeping in mind that L∗G(x, t;·,·) = 0, we obtain for 0 < s < t

G(x, t; y, τ )Lu(y, τ )dydτ =

[uXjG − GXju](cid:104)Xj, νy(cid:105) dσ

(cid:90)

U×(0,s)

(cid:90) s

(cid:90)

m(cid:88)
(cid:90)
(cid:90)

−

j=1

+

U

U

0

∂U

G (x, t; y, s) u (y, s) dy

G (x, t; y, 0) u (y, 0) dy.

(cid:90)

U

u (x, t) = lim
s(cid:37)t

G (x, t; y, s) u (y, s) dy.

By Theorem 3.4 we have

We thus conclude

u (x, t) = −

+

(cid:90)
m(cid:88)

U×(0,t)

(cid:90) t

(cid:90)

j=1

0

∂U

G(x, t; y, s)Lu(y, s)dyds +

G (x, t; y, 0) u (y, 0) dy

U

[uXjG − GXju](cid:104)Xj, νy(cid:105) dσds.

(cid:90)

(cid:90)

Deﬁnition 5.1. Given a bounded open set Ω ⊂ Ω ⊂ Rn of class C 1, at every point y ∈ ∂Ω
we let

N X (y) = ((cid:104)ν (y) , X1 (y)(cid:105) , . . . ,(cid:104)ν (y) , Xm (y)(cid:105)) ,

where ν(y) is the outer unit normal to Ω in y. We also set

W (y) =(cid:12)(cid:12)N X (y)(cid:12)(cid:12) =

(cid:118)(cid:117)(cid:117)(cid:116) m(cid:88)

(cid:104)ν (y) , Xj (y)(cid:105)2.

If y ∈ ∂Ω \ Σ, we set

One has(cid:12)(cid:12)νX (y)(cid:12)(cid:12) = 1 for every y ∈ ∂Ω \ Σ.

νX (y) =

j=1

N X (y)
|N X (y)|.

We note explicitly that one has for the characteristic set Σ of Ω

Σ = {y ∈ ∂Ω : W (y) = 0} .

Proposition 5.2. Let DT = Ω × (0, T ), where Ω ⊂ Rn is a bounded open set, with positive
Green function G. Consider a C 1 domain U ⊂ U ⊂ Ω. For any u ∈ C∞(DT ), and every
(x, t) ∈ U × (0, T ) one has

u (x, t) = −

(cid:90)
(cid:90)
(cid:90) t
(cid:90) t
(cid:90)

0

∂U

0

∂U

−

+

u (y, 0) G (x, t; y, 0) dy

U×(0,t)

G (x, t; y, s) Lu (y, s) dyds +

G (x, t; y, s)(cid:10)Xu, N X (y, s)(cid:11) dσ (y) ds
u (y, s)(cid:10)XG (x, t; y, s) , N X (y, s)(cid:11) dσ (y) ds.

U

19

u (y, 0) G (x, t; y, 0) dy

If moreover Lu = 0 in DT , then

u (x, t) = −

(cid:90) t
(cid:90)
(cid:90) t

0

(cid:90)

DIRICHLET PROBLEM

(cid:90)
G (x, t; y, s)(cid:10)Xu, N X (y)(cid:11) dσ (y) ds +
u (y, s)(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds

∂U

U

+

In particular, the latter equality gives for every (x, t) ∈ DT

0

∂U

(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds

(cid:90)

(cid:90) t
(cid:90)

0

1 =

+

∂U

G (x, t; y, 0) dy

The following result due to Derridj, see Theorem 1 in [18], will be important in the sequel.

U

Theorem 5.3. Let Ω ⊂ Rn be a C∞ domain.
If Σ denotes its characteristic set, then
σ(Σ) = 0. As a consequence, if we consider the cylinder DT = Ω × (0, T ), with lateral
boundary ST = ∂Ω × (0, T ), then the set Σ × (0, T ) ⊂ ST has vanishing dσ × dt measure.
Deﬁnition 5.4. With the notation of Deﬁnition 5.1, for every ((x, t), (y, s)) ∈ DT × (∂Ω \
Σ × (0, T )) we deﬁne

(cid:26) (cid:10)XG (x, t; y, s) , N X (y)(cid:11) ,

0 < s < t,
s ≥ t.

(5.1)

P (x, t; y, s) =

We also deﬁne

0,

P (x, t; y, s)

K(x, t; y, s) =

(5.2)
We extend the deﬁnition of P and K to all DT × ST by letting P (x, t; y, s) = K(x, t; y, s) = 0
for any (x, t) ∈ DT and (y, s) ∈ Σ× (0, T ). According to Theorem 5.3 the extended functions
coincide dσ × dt-a.e. with the kernels in (5.1), (5.2).
For (x, t; y, s) ∈ D × (∂Ω \ Σ × (0, T )), with 0 < s < t we have
(5.3)

P (x, t; y, s) ≤ W (y)|XG(x, t; y, s)| , K(x, t; y, s) ≤ |XG(x, t; y, s)| .

W (y)

.

We introduce a new measure on ∂Ω by letting

dσX = W dσ.

(5.4)
Observe that since we are assuming that Ω ∈ C∞ the density W is smooth and bounded on
∂Ω and therefore (5.4) implies that dσX << dσ. In view of this observation Theorem 5.3
implies σX(Σ) = 0.
Proposition 5.5. Assume that DT = Ω × (0, T ), where Ω ⊂ Rn is a bounded C∞ domain
that satisﬁes the uniform outer X-ball condition in a neighborhood of its characteristic set
Σ. For every (x, t) ∈ DT we have

(cid:90)

(cid:90)

Ω

(cid:90) t
(cid:90) t

0

(cid:90)
(cid:90)

∂Ω

1 =

=

P (x, t; y, s)dσ (y) ds +

G (x, t; y, 0) dy

K(x, t; y, s)dσX (y) ds +

G (x, t; y, 0) dy

0

∂Ω

Ω

20

NICOLA GAROFALO AND ISIDRO H. MUNIVE

k ∪ Γ2

k, with Γ1

Proof. Fix (x, t) ∈ DT .
In view of Theorem 5.3 we can choose an exhaustion of Ω with
a family of C∞ connected open sets Ωk ⊂ Ωk ⊂ Ω, with Ωk (cid:37) Ω as k → ∞, such that
k) → 0. By Proposition 5.2 we obtain for
k (cid:37) ∂Ω, σ(Γ2
(cid:90)
∂Ωk = Γ1
every k ∈ N
(cid:90)
(cid:90) t

P (x, t; y, s)dσ (y) ds +

G (x, t; y, 0) dy

1 =

(5.5)

Ωk

P (x, t; y, s)dσ (y) ds +

P (x, t; y, s)dσ (y) ds

k ⊂ ∂Ω \ Σ, Γ1
(cid:90)
(cid:90) t
(cid:90)
(cid:90) t
(cid:90)

∂Ωk

Γ1
k

0

0

G (x, t; y, 0) dy.

=

+

0

Γ2
k

We now pass to the limit as k → ∞ in the above integrals. Using Corollary 4.6 and σ(Γ2
we infer

k) → 0,

The fact that Γ1
theorem, and obtain

k (cid:37) ∂Ω and once again Corollary 4.6, allow to use the dominated convergence

Ωk

lim
k→∞

(cid:90) t

(cid:90)

0

0

Γ1
k

Γ2
k

(cid:90)

(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds = 0.
(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds =
(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds.

(cid:90) t
(cid:90)
(cid:90) t
(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds +
(cid:90)
(cid:90)

(cid:90) t

(cid:90)

∂Ω

Ω

0
In conclusion, we have found

lim
k→∞

∂Ω

0

(cid:90)
(cid:90) t
(cid:90) t
(cid:90)

0

Ωk

(cid:90) t

(cid:90)

1 =

G (x, t; y, 0) dy.

The ﬁrst equality is thus established. In order to prove the second identity we rewrite (5.5)
as follows

1 =

K(x, t; y, s)dσX (y) ds +

P (x, t; y, s)dσ (y) ds

Γ1
k

0

Γ2
k

+

G (x, t; y, 0) dy.

Since we have observed dσX << dσ, in view of the second estimate K(x, t; y, s) ≤ |XG(x, t; y, s)|
in (5.3), we can again use Corollary 4.6 and dominated convergence (with respect to σX) to
conclude that

lim
k→∞

0

Γ1
k

K(x, t; y, s)dσX (y) ds =

K(x, t; y, s)dσX (y) ds.

(cid:3)
This completes the proof.
Theorem 5.6. Let DT = Ω × (0, T ) satisfy the assumptions in Proposition 5.5.
If ϕ ∈
0 (∂pDT ), with supp ϕ ⊂ ST , assumes a single constant value in a neighborhood of Σ×(0, T ),
C∞
then

(5.6)

||XH DT

ϕ ||L∞(DT ) < ∞.

(cid:90) t

(cid:90)

0

∂Ω

Furthermore, if for ϕ ∈ C(∂pDT ), with supp ϕ ⊂ ST , the function H DT
for every (x, t) ∈ DT one has

ϕ

satisﬁes (5.6), then

DIRICHLET PROBLEM

21

(cid:90) t
(cid:90) t

0

(cid:90)
(cid:90)

0

∂Ω

H DT

ϕ (x, t) =

=

∂Ω

P (x, t; y, s)ϕ (y, s) dσ (y) ds

K(x, t; y, s)ϕ (y, s) dσX (y) ds.

Proof. We start with the proof of the regularity result. Let ϕ be as in the ﬁrst part of the
statement. Consider U × (0, T ), where U is a neighborhood of Σ, in which the function ϕ
is constant and along which the domain DT satisﬁes the uniform outer X−ball condition.
Let us assume that U = ∪P∈ΣB(P, ε), for some ε = ε(U, X) > 0. If we denote by R0 the
constant involved in the deﬁnition of X-ball (see Deﬁnition 2.5 above), then we can always
select a smaller constant so that ε = 2R0. In view of Proposition 5.5 we can assume without
loss of generality that ϕ vanishes in a neighborhood of Σ × (0, T ) and max
|ϕ| = 1. We want
is in L∞ in such neighborhood. Fix x0 ∈ Σ, and
to show that the horizontal gradient of H DT
0 < r < R0, where R0 is as in Deﬁnition 2.5. Suppose that ϕ ≡ 0 on (B(x0, ε) ∩ Ω) × (0, T ).
C = C(X, Ω) > 0 such that for every (y, s) ∈ (B(x0, ε) ∩ Ω) × (0, T ),

Moreover, since ϕ ≡ 0 on(cid:0)B(x0, ε) ∩ Ω(cid:1)×{0}, we conclude from Lemma 4.2 that there exist

∂pD

ϕ

(cid:12)(cid:12)H DT
ϕ (y, s)(cid:12)(cid:12) ≤ C

d (x0, y)

r

.

Suppose that x ∈ Bd (x0, r/2)∩Ω and consider the ball Bd(x, τ ), where τ = min
with 0 < s < T . Theorem 4.4 implies

(cid:16) d(x,∂Ω)

4

√

,

T−s
4

(cid:17)

,

Let P ∈ ∂Ω such that d(x, P ) = d(x, ∂Ω). Observe that d(P, Σ) ≤ d(P, x0) + d(x, x0) ≤
2d(x, x0) ≤ R0 = ε/2. In particular, we can apply once more Lemma 4.2, and obtain

(cid:0)x, s +

(cid:1).

τ 2
16

= C

d (x, ∂Ω)

r

.

H DT
ϕ

C

(5.7)

d(x, ∂Ω)

ϕ (x, s)(cid:12)(cid:12) ≤
(cid:12)(cid:12)XH DT
(cid:12)(cid:12)(cid:12)(cid:12)H D
(cid:1)(cid:12)(cid:12)(cid:12)(cid:12) ≤ C
ϕ (x, s)(cid:12)(cid:12) ≤ C
The latter inequality and (5.7) imply(cid:12)(cid:12)XH D
This proves that (cid:12)(cid:12)XH D

(cid:0)x, s +

d (x, P )

τ 2
16

r

ϕ

(cid:12)(cid:12) ∈ L∞((B(x0, r/2) ∩ Ω) × (0, T )), from which (5.6) follows. To

r

.

establish the second part of the theorem, we take a function ϕ ∈ C(∂pDT ) with supp ϕ ⊂ ST
for which (5.6) hold. We ﬁx (x, t) ∈ DT , and consider a sequence of C∞ domains Ωk as in

ϕ

22

NICOLA GAROFALO AND ISIDRO H. MUNIVE

the proof of Proposition 5.5. Proposition 5.2 gives

(cid:90)
(cid:90)

(cid:90) t
(cid:90) t
(cid:90)

0

0

Ωk

∂Ωk

∂Ωk

H D

ϕ (x, t) =

−

+

G (x, t; y, s)(cid:10)(cid:0)XH D
(cid:1) (y, s) , N X (y)(cid:11) dσ (y) ds
ϕ (y, s)(cid:10)XG (x, t; y, s) , N X (y)(cid:11) dσ (y) ds

H D

ϕ

H D

ϕ (y, 0) G (x, t; y, 0) dy.

At this point the conclusion follows along the lines of the proof of Proposition 5.5.
Proposition 5.7. Let Ω be a C∞ domain and consider DT = Ω × (0, T ).

i) If Ω satisﬁes the uniform outer X-ball condition in a neighborhood of Σ, then P (x, t; y, s) ≥

0 and K(x, t; y, s) ≥ 0 for each ((x, t), (y, s)) ∈ DT × ST ;
such that for ((x, t), (y, s)) ∈ DT × ST ,

ii) If Ω satisﬁes the uniform outer X-ball condition, then there is a constant CΩ > 0

(cid:3)

0 ≤ P (x, t; y, s) ≤

0 ≤ K(x, t; y, s) ≤

CΩ

(cid:0)d (x, y)2 ∧ √
(cid:0)d (x, y)2 ∧ √

CΩ

t − s ∧ R0

t − s ∧ R0

(cid:1)
(cid:1)

(cid:12)(cid:12)Bd
(cid:12)(cid:12)Bd

(cid:0)x,
(cid:0)x,

t − s(cid:1)(cid:12)(cid:12) exp
t − s(cid:1)(cid:12)(cid:12) exp

√
1

√
1

(cid:32)
−M1d (x, y)2
(cid:32)
(t − s)
−M1d (x, y)2
(t − s)

(cid:33)
(cid:33)

,

.

Proof. We start with the proof of part i). For (y0, s0) ∈ ST and r > 0, we consider the
cylinder

C X

r (y0, s0)

= B(y0, r) × (s0 − r2, s0 + r2).
.

Suppose that for some (x0, t0) ∈ DT and (y0, s0) ∈ ST , with 0 < s0 < t0, we have
P (x0, t0; y0, s0) = α < 0. This implies that y0 /∈ Σ. By the smoothness away from
characteristic points, see Theorem 3.5, there exists a suﬃciently small r > 0 such that
2r(y0, s0) ∩ ∂pDT . We can assume that 2r < d(y0, Σ).
P (x0, t0; y, s) ≤ α/2 for every (y, s) ∈ C X
r (y0, s0) ∩ ∂pDT and
ϕ ≡ 0 outside C X
ϕ ≥ 0 in DT , where
H DT
is the Perron-Wiener-Brelot solution to Dirichlet problem (1.4) with boundary data ϕ.
By the Harnack inequality or the strong maximum principle, we must have H DT
ϕ (x, t) > 0 in
Ω × (s0 − r2/16, T ). On the other hand, Theorem 5.6 gives

We now choose ϕ ∈ C∞(∂pDT ) such that 0 ≤ ϕ ≤ 1, ϕ ≡ 1 on C X
3r/2(y0, s0) ∩ ∂pDT . The maximum principle implies H DT

ϕ

ϕ (x, t) ≤ α
H DT
2

0

B(y0,3r/2)∩∂Ω

ϕ(y, s)dσ(y)ds ≤ 0,

The proof of part ii) is an inmediate consequence of (5.3) and of Theorem 4.5. The estimate
(cid:3)
for K(x, t; y, s) follows from (5.2) and from the one for P (x, t; y, s).

Remark 5.8. It is not diﬃcult to see that by the properties of the Green function we have
for every Borel set E ⊂ Ω

ω(x,t)(E) =

G(x, t; y, 0)dy.

(cid:90) t

(cid:90)

(cid:90)

E

We now ﬁx (x, t) ∈ DT . For every σ−measurable E ⊂ ST we set

DIRICHLET PROBLEM

23

ν(x,t)(E) =

K(x, t; y, s)dσX(y)ds.

According to Proposition 5.7, dν(x,t) deﬁnes a Borel measure on ST . The following theorem,
a consequence of Theorems 5.3 and 5.6, is the main result of this section.
Theorem 5.9. Let Ω ⊂ Rn be a C∞ domain possessing the uniform outer X-ball condition
in a neighborhood of the characteristic set Σ. Consider DT = Ω × (0, T ), with 0 < T < ∞.
For every (x, t) ∈ DT , we have ω(x,t) = ν(x,t), i.e., for every ϕ ∈ C(∂pDT ) with supp ϕ ⊂ ST ,
one has

H DT

ϕ (x, t) =

=

∂Ω

P (x, t; y, s)ϕ (y, s) dσ (y) ds

K(x, t; y, s)ϕ (y, s) dσX (y) ds.

In particular, dω(x,t) is absolutely continuous with respect to dσX × dt and dσ × ds on ST =
∂Ω × (0, T ), and for every ((x, t)(y, s)) ∈ DT × ST one has

0

∂Ω

dω(x,t)
dσX × dt

dω(x,t)
dσ × dt

(y, s) = P (x, t; y, s).

(y, s) = K(x, t; y, s),

(5.8)
Proof. We start with the proof of (5.8). Let ε > 0 and (x, t) ∈ DT . From Theorem 5.3 and
the estimates for K, we have that there exists open sets Σε, Uε such that Σ ⊂ Σε ⊂ Σε ⊂ Uε
0 (∂Ω) with 0 ≤ ϕ ≤ 1 and ϕ = 1
and ν(x,t)(Uε × (0, T )) < ε/2. Consider a function ϕ ∈ C∞
on Uε, such that the function ϕ : DT → R, deﬁned by slightly abusing the notation as
ϕ(y, s) = ϕ(y) for every (y, s) ∈ DT , satisﬁes ν(x,t)(supp ϕ) ≤ 3
4ε. Moreover, for every k ∈ N
let ϕk : [0, T ] → R be a smooth function such that 0 ≤ ϕk ≤ 1, ϕk ≡ 1 on [k−1, T − k−1] and
(cid:90)
ϕk ≡ 0 on [0, (2k)−1] ∪ [T − (2k)−1, T ]. We then have

(cid:19)(cid:19)

(cid:90) T

(cid:18)

(cid:90)

(cid:18) 1

dω(x,t)(y, s) ≤

Uε

0

∂Ω

ϕ(y, s)ϕn(s)dω(x,t)(y, s)

ω(x,t)

Uε ×

, T − 1
k

k

(cid:90)

E

(cid:90) t
(cid:90) t

0

(cid:90)
(cid:90)

k

1
k

(cid:90) T− 1
(cid:90)
(cid:90) t
(cid:90)
(cid:90) t

0

∂Ω

=

=

= H DT
ϕϕk

(x, t)

(by Theorem 5.6)

K(x, t; y, s)ϕ(y, s)ϕk(s)dσX(y)ds

K(x, t; y, s)ϕ(y, s)dσX(y)ds

≤
≤ ν(x,t)(supp ϕ) ≤ 3
4

∂Ω

0

ε.

By letting k → ∞ we ﬁnd

Let F ⊆ ST be a Borel set.

If F = ST then (5.8) follows from Theorem 5.5 and the
Remark 5.8. Let us thus assume that F ⊂ ST . Once again by the boundedness of the

ω(x,t) (Uε × (0, T )) ≤ 3
4

ε.

24

NICOLA GAROFALO AND ISIDRO H. MUNIVE

functions K(·;·) and W (·), we can ﬁnd open sets Eε, Fε ⊂ ST such that F ⊂ Fε ⊂ Fε ⊂ Eε
and ν(x,t)(E \ F ) ≤ ε/2. Let now ψ0, ψ1 ∈ C∞(ST ) such that 0 ≤ ψ0, ψ1 ≤ 1, and for which

ψ0 ≡ 1 on ST \ Uε × (0, T ), ψ0 ≡ 0 on Σε × (0, T ),
ψ1 ≡ 1 on F, ψ1 ≡ 0 on ST \ Eε.

(cid:18)

(cid:18)

Then, we have

ω(x,t)

F ∩

∂Ω ×

(cid:19)(cid:19)(cid:19)

(cid:18) 1

, T − 1
k

k

(cid:18)

(cid:18)

F \ Uε ∩

∂Ω ×

(cid:19)(cid:19)(cid:19)

(cid:18) 1

k

, T − 1
k

ψ0(y, s)ψ1(y, s)ϕk(s)dω(x,t)(y, s)

(x, t)

(by Theorem 5.6)

ψ0(y, s)ψ1(y, s)ϕk(s)K(x, t; y, s)dσX(y)ds

ψ0(y, s)ψ1(y, s)K(x, t; y, s)dσX(y)ds

ST

=

=

ε +

ψ0ψ1ϕk

ε + H DT

(cid:90)
(cid:90) t
(cid:90) t

≤ ω(x,t)(Uε) + ω(x,t)
≤ 3
4
3
4
3
4
≤ 3
4
≤ 3
4
≤ 3
4

(cid:90)
(cid:90)

ε +

0

∂Ω

0

∂Ω

ε +

ε + ν(x,t)(Eε)
ε + ν(x,t)(F ) + ν(x,t)(Eε \ F ) < ν(x,t)(F ) +

5
4

ε.

Since ε > 0 is arbitrary, we conclude by letting k → ∞ that ω(x,t)(F ) ≤ ν(x,t)(F ). The
argument can be repeated with the set Eε\ F instead of F . Hence, we obtain ω(x,t)(Eε\ F ) ≤
ν(x,t)(Eε \ F ). From this we conclude, by exchanging the role of ω(x,t) and ν(x,t) in the above
computations, that ν(x,t)(F ) ≤ ω(x,t)(F ). This proves (5.8).
From (5.8) the rest of the proof easily follows. By the deﬁnition of L−parabolic measure,
we have for ϕ ∈ C(∂pDT ), with supp ϕ ⊂ ST , that

(cid:90)

ST

H D

ϕ (x, t) =

ϕ(y, s)dω(x,t)(y, s).

We conclude from (5.8) that dω(x,t)(y, s) = K(x, t; y, s)dσX(y)ds, and this completes the
(cid:3)
proof of the theorem.

6. Reverse H¨older inequalities for the Poisson kernel

This section is devoted to proving the main results of this paper, namely Theorems 1.3, 1.5,
1.6 and 1.7. In the course of the proofs we will need some basic results about N T A domains
from the papers [23] and [35], see also [22]. We begin by recalling the relevant deﬁnitions.

Deﬁnition 6.1. We say that Ω is an non-tangentially accessible domain (N T A domain) if
there exists M , r0 > 0 for which:
(1) (Interior corkscrew condition) For any Q ∈ ∂Ω and r ≤ r0 there exists Ar (Q) ∈
M .(This implies that

M ≤ d (Ar (Q) , Q) ≤ r and d (Ar (Q) , ∂Ω) > r
(2) (Exterior corkscrew condition) Ωc = Rn \ Ω satisﬁes property (1).

(cid:1) is (3M, X)-nontangential.)

(cid:0)Ar (Q) ,

Ω such that
Bd

r
2M

r

DIRICHLET PROBLEM

25

(3) (Harnack chain condition) For any ε > 0 and x, y ∈ Ω such that d (x, ∂Ω) > ε,
d (y, ∂Ω) > ε, and d (x, y) < 2kε, there exists a Harnack chain joining x to y
of length M k and such that the diameter of each ball is bounded from below by
M−1 min{d (x, ∂Ω) , d (y, ∂Ω)}.

Lemma 6.2. Let Ω ⊂ Rn be an N T A domain. Then, there exist positive constants C, R1,
depending on the N T A parameters of Ω, such that for every y ∈ ∂Ω and every 0 < r < R1
one has,

C|Bd(y, r)| ≤ min{|Ω ∩ Bd(y, r)|,|Ωc ∩ Bd(y, r)|} ≤ C−1|Bd(y, r)|.

In particular, every N T A domain has outer positive d-density and therefore, in view of
Lemma 3.3, given f ∈ C(∂pDT ), there exists a unique solution u ∈ Γ2(DT ) ∩ C(DT ∪ ∂pDT )
to the Dirichlet problem (3.1). In particular, DT is regular.

We now state a basic non-degeneracy property of the horizontal perimeter measure dσX.

The proof can be found in Theorem 8.3 in [11].
Theorem 6.3. Let Ω ⊂ Rn be an N T A domain of class C 2, then there exist C (cid:63), R1 > 0,
depending on Ω, X and on the N T A parameters of Ω, such that for every y ∈ ∂Ω and every
0 < r < R1

σX(∂Ω ∩ B(y, r)) ≥ C (cid:63)|Bd(y, r)|

.

r

In particular, σX is lower 1-Alfhors according to [17] and σX(∂Ω ∩ B(y, r)) > 0.
Corollary 6.4. Let Ω ⊂ Rn be an N T A domain of class C 2 satisfying the upper 1−Ahlfors
assumption in iv) of Deﬁnition 1.1. Then, the measure σX is 1-Ahlfors, in the sense that
there exist A1, R1 > 0 depending in the N T A parameters of Ω and on A > 0 in iv), such that
for every y ∈ ∂Ω, and every 0 < r < R1, one has

(6.1)

A1

|Bd(y, r)|

r

≤ σX(∂Ω ∩ Bd(y, r)) ≤ A−1

1

|Bd(y, r)|

.

r

In particular, the measure σX is doubling, i.e., there exists C > 0 depending on A1 and on
the constant C1 in (2.4), such that

(6.2)
for every y ∈ ∂Ω and 0 < r < R1.

σX(∂Ω ∩ Bd(y, 2r)) ≤ C σX(∂Ω ∩ Bd(y, r)),

The following results from [23], [22] and [35], namely Lemma 6.5, Theorem 6.6, Theorem
6.7 and Theorem 6.8 below, play a fundamental role in the rest of the paper. All of these
results assume that the cross-section Ω of the cylinder DT is an N T A−domain with respect
to the intrinsic distance of the system X.

For (Q, s) ∈ S and r > 0, we deﬁne

Ar(Q, s) = (Ar(Q), s + 2r2),

and

where Ar(Q) is the corkscrew in the deﬁnition of N T A−domain.

∆r(Q, s) = ∂pDT ∩ Cr(Q, s),

26

NICOLA GAROFALO AND ISIDRO H. MUNIVE

Lemma 6.5. Let (Q, s) ∈ ∂pDT and r > 0 suﬃciently small, depending on r0. Then, there
exists a constant C > 0, depending on L, M , and r0 such that
ω(x,t) (∆2r (Q, s)) ≥ C.
(6.3)

inf

Cr(Q,s)∩DT

The next result states that the L−caloric measure has the so-called doubling property.

Theorem 6.6. There exist a positive constant C = (X, M, r0, diam Ω, T ) such that for all
(Q, s) ∈ S and 0 < r ≤ 1

(6.4)
with d (x, Q) ≤ K |t − s|1/2 and |t − s| ≥ 16r2.

√

2 min(cid:8)r0,
(cid:110)

√
T − s,

s(cid:9) we have
(cid:111)
r0/2,(cid:112)(T − s)/4,(cid:112)s/4

ω(x,t)(∆2r(Q, s)) ≤ C ω(x,t)(∆r(Q, s)),

, (Q, s) ∈ ST . Let u and v be two
Theorem 6.7. Let r < min
non-negative solutions of Lu = 0 in DT , and assume that u and v vanish continuously on
∂pDT \ ∆r/2(Q, s). Then, there exists a constant C = (X, M, r0, diam(Ω), T ) such that

u(x0, T )v(Ar(Q, s)) ≤ Cv(x0, T )u(Ar(Q, s)),

where x0 ∈ Ω is ﬁxed.

For any (y, s) ∈ ∂pDT and α > 0 a nontangential region at (y, s) is deﬁned by
Γα(y, s) = {(x, t) ∈ DT | dp((x, t), (y, s)) < (1 + α)dp((x, t), ∂pDT )} ,

dp((x, t), (y, s)) =(cid:0)d(x, y)2 + |t − s|(cid:1)1/2 .

where

(cid:90)

Theorem 6.8. Let Ω ⊂ Rn be an N T A domain, and set DT = Ω × (0, T ). Given a point
(x1, t1) ∈ DT , let f ∈ L1(ST , dω(x1,t1)) and deﬁne

u(x, t) =

f (y, s)dω(x,t)(y, s),

(x, t) ∈ DT .

ST

Then, u is L-caloric in DT and:

(1) Nα(u)(y, s) ≤ CMω(x1,t1)(f )(y, s), (y, s) ∈ ST ;
(2) u converges non-tangentially a.e. (dω(x1,t1)) to f .

Theorem 6.7 has the following important consequence.

Theorem 6.9. Let DT = Ω × (0, T ), where Ω ⊂ Rn be a ADPX domain and T > 0. Let
K(·;·) be the Poisson kernel deﬁned in (5.2). Fix x0 ∈ Ω. There exists r1 > 0 depending on
M and r0, and a constant C = C(X, M, r0, x0, T, R0) > 0, such that given (Q0, s0) ∈ ST , for
every 0 < r < r1 one can ﬁnd a set E = E(Q0,s0),(x0,T ),r ⊂ ∆r(Q0, s0), with |E|dσX×dt = 0, for

which

K(x0, T ; y, s) ≤ CK(Ar(Q0, s0); y, s)ω(x0,T ) (∆r(Q0, s0))

for every (y, s) ∈ ∆r(Q, s) \ E.
Proof. Let (Q0, s0) ∈ ST . For each (y, t) ∈ ∆r(Q, s) and 0 < ˆr < r/2 set
v(x, t) = ω(x,t)(∆r/2(Q0, s0)).
(6.5)

u(x, t) = ω(x,t)(∆ˆr(y, s)),

The functions u and v are L−parabolic in DT and vanish continuously on ST \ ∆2r(Q0, s0).
Theorem 6.7 gives

DIRICHLET PROBLEM

27

(6.6)

u(x0, T )
v(x0, T )

≤ u(Ar(Q0, s0))
v(Ar(Q0, s0))

.

In terms of the deﬁnitions of u and v we obtain from (6.6)

(6.7)

ω(x0,T )(∆ˆr(y, s))

ω(x0,T )(∆r/2(Q0, s0))

≤ C

ωAr(Q0,s0)(∆ˆr(y, s))

ωAr(Q0,s0)(∆r/2(Q0, s0))

.

Upon dividing by |∆ˆr(y, s)|dσX×dt in (6.7), we ﬁnd

(6.8)

ω(x0,T )(∆ˆr(y, s))
|∆ˆr(y, s)|dσX×dt

≤ C

ωAr(Q0,s0)(∆ˆr(y, s))
|∆ˆr(y, s)|dσX×dt

ω(x0,T )(∆r/2(Q0, s0))

ωAr(Q0,s0)(∆r/2(Q0, s0))

.

Using Theorem 6.5 in the right-hand side of (6.8), we conclude

(6.9)

ω(x0,T )(∆ˆr(y, s))
|∆ˆr(y, s)|dσX×dt

≤ C

ωAr(Q0,s0)(∆ˆr(y, s))
|∆ˆr(y, s)|dσX×dt

ω(x0,T )(∆r(Q0, s0))

We now observe that (6.2) in Corollary 6.4 allows to obtain a Vitali covering theorem and
diﬀerentiate the measure ω(x0,T ) with respect to the measure dσX × dt. This means that for
dσX × dt-a.e. (y, s) ∈ ∆r(Q0, s0) the
ω(x0,T )(∆ˆr(y, s))
|∆ˆr(y, s)|dσX×dt

dω(x0,T )
dσX × dt

exists and equals

(y, s).

lim
ˆr→0

This being said, passing to the limit as ˆr → 0+ in (6.9), we obtain for dσX × dt-a.e. (y, s) ∈
∆r(Q0, s0)

dω(x0,T )
dσX × dt

(y, s) ≤ C

dωAr(Q0,s0)
dσX × dt

(y, s)ω(x0,T )(∆r(Q0, s0)).

Since by (5.8) in Theorem 5.9 we know that

dω(x0,T )
dσX × dt

dωAr(Q0,s0)
dσX × dt

and

(6.11)

|Bd(x0, r)| ≤ C

(y, s) = K(x0, T ; y, s),

(y, s) = K(Ar(Q0, s0); y, s),

(cid:3)
we have reached the desired conclusion.
Proof of Theorem 1.3. We ﬁx p > 1, (x0, t0) ∈ ST and x1 ∈ Ω. Let R1 be the minimum of the
constants in Deﬁnitions 4.1, 6.1 and in Theorem 6.9. Moreover, we choose R1 so small that
d(x0, x1) > M R1. Let 0 < r < R1. If Ar(x0) is a corkscrew for x0, then by the deﬁnition of
a corkscrew, the triangle inequality and (2.2), it is easy to see that for all (y, s) ∈ ∆r(x0, t0)
(6.10)

d(Ar(x0), y) ∼ Cr,

(cid:12)(cid:12)t0 + 2r2 − s(cid:12)(cid:12) ∼ Cr2,
(cid:12)(cid:12)(cid:12) .

t0 + 2r2 − s)

(cid:112)

(cid:12)(cid:12)(cid:12)Bd(Ar(x0),

28

NICOLA GAROFALO AND ISIDRO H. MUNIVE

(cid:33) 1

p

(cid:33) 1

p

K(x1, T ; y, s)pdσX(y)ds

(by (5.8))

K(x1, T ; y, s)p−1dω(x1,T )(y, s)

(by Theorem 6.9)

∆r(x0,t0)

K(Ar(x0, t0); y, s)p−1dω(x1,T )(y, s)

(cid:12)(cid:12)XG(Ar(x0, t0); y, s)(cid:12)(cid:12)p−1

(cid:19)p−1(cid:90)

∆r(x0,t0)

r

r2 |Bd(x0, r)|

∆r(x0,t0)

(by (5.3))

(cid:33) 1

p

dω(x1,T )(y, s)

(by (4.5)

dω(x1,T )(y, s)

(by 4) in Deﬁnition 1.1)

(cid:33) 1

p

(cid:33) 1

p

(cid:90)
(cid:90)

∆r(x0,t0)

∆r(x0,t0)

We now have

(cid:32)
(cid:32)

1

1

|∆r(x0, t0)|dσX×dt
(cid:32)
|∆r(x0, t0)|dσX×dt
ω(x1,T ) (∆r(x0, t0))
(cid:32)
|∆r(x0, t0)|dσX×dt
ω(x1,T ) (∆r(x0, t0))
(cid:32)
|∆r(x0, t0)|dσX×dt
ω(x1,T ) (∆r(x0, t0))
(cid:90)
|∆r(x0, t0)|dσX×dt
(cid:90)

C

|∆r(x0, t0)|dσX×dt
|∆r(x0, t0)|dσX×dt

C

=

≤ C

≤ C

≤ C

≤

=

(cid:90)
(cid:90)
(cid:18)

dω(x1,T )(y, s) by (5.8)

K(x1, T ; y, s)dσX(y)ds.

∆r(x0,t0)

∆r(x0,t0)

This concludes the proof of the reverse H¨older inequality. Regarding the absolute continuity,
we already know from (5.8) that dω(x1,T ) is absolutely continuous with respect to dσX×dt. To
prove that dσX × dt is absolutely continuous with respect to dω(x1,T ) we only need to observe
that the reverse H¨older inequality for K established above and the doubling property for dσX
(cid:3)
from (6.2) in Corollary 6.4 allows to invoke Lemma 5 in [13].

We next establish a reverse H¨older inequality for the kernel P (x, t; y, s) deﬁned in (5.1).
To state the main result we modify the class of ADPX domains in Deﬁnition 1.1. Speciﬁcally,
we recall the following deﬁnition from [11].
Deﬁnition 6.10. Given a system X = {X1, ..., Xm} of smooth vector ﬁelds satisfying (1.1),
we say that a connected bounded open set Ω ⊂ Rn is σ−admissible for the Dirichlet problem
(1.4) with respect to the system X, or simply σ − ADPX, if:

(1) Ω is of class C∞.
(2) Ω is non-tangentially accessible (NTA) with respect to the Carnot-Carath´eodory metric

associated to the system X (see Deﬁnition 6.1);

(3) Ω satisﬁes a uniform tangent outer X-ball condition (see Deﬁnition 4.1);
(4) The horizontal perimeter measure is upper 1-Ahlfors regular. This means that there
exist B, Ro > 0 depending on X and Ω such that for every x ∈ ∂Ω and 0 < r < Ro
one has

(cid:18)

(cid:19)

max

y∈∂Ω∩Bd(x,r)

σ (∂Ω ∩ Bd(x, r)) ≤ B

|Bd(x, r)|

.

r

The proof of the following result can be found in [11].

Theorem 6.11. Let Ω ⊂ Rn be a σ − ADPX domain. There exists C, R1 > 0, depending on
the σ − AP DX parameters of Ω, such that for every y ∈ ∂Ω and 0 < r < R1,

DIRICHLET PROBLEM

29

σ(∂Ω ∩ Bd(y, 2r)) ≤ Cσ(∂Ω ∩ Bd(y, r)).

Proof of Theorem 1.6. The relevant reverse H¨older inequality for P (x1, t1;·) is proved starting
from the second identity dω(x1,t1) = P (x1, t1;·)d (dσ × dt) in (5.8) and then arguing in a
similar fashion as in the proof of Theorem 1.3 but using the non-degeneracy estimate in iv)
of Deﬁnition 6.10, instead of the upper 1-Ahlfors assumption in Deﬁnition 1.1. We leave the
(cid:3)
details to the interested reader.

Proof of Theorem 1.5. We start by proving that functions f ∈ Lp (ST , dσX × dt) are reso-
lutive for the Dirichlet problem 1.4. Thanks to Theorem 3.2 it is enough to prove that

f ∈ L1(cid:0)ST , dω(x1,t1)(cid:1) for some ﬁxed (x1, t1) ∈ DT . From (5.8) and Proposition 5.7 we have
(cid:90)
(cid:19) 1

|f (y, s)| K(x1, t1; y, s)dσXds

|f (y, s)| dω(x1,t1)(y, s) =

ST

p(cid:48)

≤

|f (y, s)|p dσXds

K(x1, t1; y, s)p(cid:48)

dσXds

≤ C

|f (y, s)|p dσXds

This shows that Lp (ST , dσX × dt) ⊂ L1(cid:0)ST , dω(x1,t1)(cid:1), and therefore, by Theorem 3.2, for

ST

each f ∈ Lp (ST , dσX × dt) the generalized solution H DT

f

exists and it is represented by

(cid:90)

ST

H DT

f

(x, t) =

f (y, s)dω(x,t)(y, s).

(cid:90)
(cid:18)(cid:90)
(cid:18)(cid:90)

ST

ST

(cid:19) 1
p(cid:18)(cid:90)
(cid:19) 1

p

.

ST

At this point we invoke Theorem 6.8 and obtain for every (y, s) ∈ ST

(cid:0)H DT

f

(cid:1) (y, s) ≤ CMω(x1,t1)(f )(y).

(6.12)

Nα

Moreover, H DT
converges non-tangentially dω(x1,t1)-a.e. to f . By virtue of Theorem 1.3, we
converges non-tangentially dσX × dt-a.e. to f . To conclude the proof we
also have that H DT
need to show that there is a constant C > 0, depending on 1 < p < ∞, Ω and X, such that

f

f

(cid:13)(cid:13)Nα

(cid:0)H DT

f

(cid:1)(cid:13)(cid:13)Lp(ST ,dσX×dt)

≤ C (cid:107)f(cid:107)Lp(ST ,dσX×dt) ,

for every f ∈ Lp (ST , dσX × dt). We start by proving the following intermediate estimate

(6.13)

(cid:107)Mω(x1,t1) (f )(cid:107)Lp(ST ,dσX×dt) ≤ C (cid:107)f(cid:107)Lp(ST ,dσX×dt) ,

1 < p ≤ ∞.

30

NICOLA GAROFALO AND ISIDRO H. MUNIVE

Since p > 1, we choose β so that 1 < β < p and ﬁx (x1, t1) ∈ DT as in Theorem 1.3. From
(5.8) and the reverse H¨older inequality in Theorem 1.3, we have

1

ω(x1,t1) (∆r(x0, t0))

(cid:16)(cid:82)
∆r(x0,t0) |f (y, s)|β dσX(y)ds

∆r(x0,t0)

(cid:17) 1

β

(cid:18)(cid:90)

ω(x1,t1) (∆r(x0, t0))

≤

f (y, s)dω(x1,t1)(y, s)

(cid:19) 1

β(cid:48)

dσX(y)ds

K(x1, t1; y, s)β(cid:48)



K(x1, t1; y, s)dσX(y)ds

(cid:90)


(cid:90)

∆r(x0,t0)

(cid:90)

1

≤ C

= C

(cid:107)f(cid:107)Lβ (∆r(x0,t0))
(cid:32)
ω(x1,t1) (∆r(x0, t0))

1

|∆r(x0, t0)|dσX×dt

|∆r(x0, t0)| 1

β

dσX×dt

∆r(x0,t0)

|f (y, s)|β dσX(y)ds

(cid:33) 1

β

.

∆r(x0,t0)

If we now ﬁx (y, s) ∈ ST and take the supremum on both sides of the latter inequality by
integrating on every surface box ∆r(x0, t0) containing (y, s), we obtain

(6.14)

Mω(x1,t1)(f )(y, s) ≤ CMσX (|f|β)(y, s)

1

β .

(cid:90)
Lp(ST ,dσX dt) ≤ C

By the doubling property (6.2) in Corollary 6.4 we know that the space (ST , dp(x, t; y, s), dσXdt)
is a space of homogeneous type. This allows to use the results in [14] and invoke the continuity
in Lp (ST , dσXdt) of the Hardy-Littlewood maximal function obtaining
(cid:107)Mω(x1,t1)f(cid:107)p

β

(cid:13)(cid:13)(cid:13)(cid:13)MσX

(cid:13)(cid:13)(cid:13)(cid:13)p
(cid:16)|f|β(cid:17) 1
(cid:16)|f|β(cid:17) p

(cid:90)

Lp(ST ,dσX dt)

β dσXdt ≤ C

|f|p dσXdt = C (cid:107)f(cid:107)p

ST

=

MσX

Lp(ST ,dσX dt) ,
(cid:3)
which proves (6.13). The conclusion of the theorem follows from (6.12) and (6.13).
Proof of Theorem 1.7. If the domain Ω is a σ − ADPX-domain, instead of a ADPX-domain,
then using Theorem 1.6 instead of Theorem 1.3 we can establish the solvability of the Dirichlet
problem for boundary data in Lp with respect to the standard surface measure. Since the
proof of the following result is similar to that of Theorem 1.5 (except that we use the second
(cid:3)
identity in 5.8 and also Theorem 6.11), we leave the details to the interested reader.

ST

References

[1] Bony, J.-M., Principe du maximum, in´egalite de Harnack et unicit´e du probl`eme de Cauchy pour les

op´erateurs elliptiques d´eg´en´er´es, Ann. Inst. Fourier (Grenoble), 19, 1969, fasc. 1, 277–304 xii.

[2] Bramanti, M., Brandolini, L., Lanconelli, E. and Uguzzoni, F., Heat kernels for non-divergence operators

of H¨ormander type, C. R. Math. Acad. Sci. Paris, 343, 2006, 7, 463–466.

[3] Bramanti, M., Brandolini, L., Lanconelli, E. and Uguzzoni, F., Non-divergence equations structured on
H¨ormander vector ﬁelds: heat kernels and Harnack inequalities, Mem. Amer. Math. Soc., 204, 2010,
961, vi+123.

[4] Bonﬁglioli, A., and Uguzzoni, F., Maximum principle and propagation for intrinsically regular solutions

of diﬀerential inequalities structured on vector ﬁelds, J. Math. Anal. Appl., 322, 2006, 2, 886–900.

[5] Capogna, L., Danielli, D. and Garofalo, N., The geometric Sobolev embedding for vector ﬁelds and the

isoperimetric inequality, Comm. Anal. Geom., 2, 1994, 2, 203–215.

DIRICHLET PROBLEM

31

[6] Capogna, L. and Garofalo, N., Boundary behavior of nonnegative solutions of subelliptic equations in

NTA domains for Carnot-Carath´eodory metrics, J. Fourier Anal. Appl., 4, 1998, 4-5, 403–432.

[7] Capogna, L. and Garofalo, N., Ahlfors type estimates for perimeter measures in Carnot-Carath´eodory

spaces, J. Geom. Anal. 16 (2006), no. 3, 455-497.

[8] Capogna, L., Garofalo, N. and Nhieu, D.-M., A version of a theorem of Dahlberg for the subelliptic

Dirichlet problem, Math. Res. Lett., 5, 1998, 4, 541–549.

[9] Capogna, L., Garofalo, N. and Nhieu, D.-M., Examples of uniform and NTA domains in Carnot groups,
Proceedings on Analysis and Geometry (Russian) (Novosibirsk Akademgorodok, 1999), 103–121, 2000.
[10] Capogna, L., Garofalo, N. and Nhieu, D.-M., Properties of harmonic measures in the Dirichlet problem

for nilpotent Lie groups of Heisenberg type, Amer. J. Math., 124, 2002, 2, 273–306.

[11] Capogna, L., Garofalo, N. and Nhieu, D.-M., Mutual absolute continuity of harmonic and surface mea-
sures for H¨ormander type operators, Perspectives in partial diﬀerential equations, harmonic analysis and
applications, Proc. Sympos. Pure Math., 79, 49–100, Amer. Math. Soc., Providence, RI, 2008.

[12] Chow, W.-L., ¨Uber Systeme von linearen partiellen Diﬀerentialgleichungen erster Ordnung, Math. Ann.,

117, 1939, 98–105.

[13] Coifman, R. R. and Feﬀerman, C., Weighted norm inequalities for maximal functions and singular

integrals, Studia Math., 51, 1974,241–250.

[14] Coifman, R. R. and Weiss, G., Analyse harmonique non-commutative sur certains espaces homog`enes,

Lecture Notes in Mathematics, Vol. 242, Springer-Verlag, Berlin, 1971, v+160 .

[15] Cygan, J., Subadditivity of homogeneous norms on certain nilpotent Lie groups, Proc. Amer. Math.

Soc., Proceedings of the American Mathematical Society, 83, 1981, 1, 69–70.

[16] Danielli, D. and Garofalo, N., Interior Cauchy-Schauder estimates for the heat ﬂow in Carnot-

Carath´eodory spaces, Methods Appl. Anal., 15, 2008, 1, 121–136.

[17] Danielli, D., Garofalo, N. and Nhieu, D.-M., Non-doubling Ahlfors measures, perimeter measures, and
the characterization of the trace spaces of Sobolev functions in Carnot-Carath´eodory spaces, Mem.
Amer. Math. Soc., 182, 2006, 857, x+119.

[18] Derridj, M., Un probl`eme aux limites pour une classe d’op´erateurs du second ordre hypoelliptiques, Ann.

Inst. Fourier (Grenoble), 21, 1971, 4, 99–148.

[19] Fabes, E. and Salsa, S., Estimates of caloric measure and the initial-Dirichlet problem for the heat

equation in Lipschitz cylinders, Trans. Amer. Math. Soc., 279, 1983, 2, 635–650.

[20] Feﬀerman, C. and Phong, D. H., Subelliptic eigenvalue problems, Conference on harmonic analysis in
honor of Antoni Zygmund, Vol. I, II (Chicago, Ill., 1981), Wadsworth Math. Ser., 590–606, Wadsworth,
Belmont, CA, 1983.

[21] Folland, G. B., Subelliptic estimates and function spaces on nilpotent Lie groups, Ark. Math., 13 (1975),

161-207.

[22] Frentz, M., Garofalo, N., G¨otmark, E., Munive, I. and Nystr¨om, K., Non-divergence form parabolic
equations associated with non-commuting vector ﬁelds: boundary behavior of nonnegative solutions,
Ann. Sc. Norm. Super. Pisa Cl. Sci. (5), 11, 2012, 2, 437–474.

[23] Frentz, M. and G¨otmark, E., Boundary Behavior of Subelliptic Parabolic Equations on Time-Dependent

Domains, ArXiv e-prints, 1301.5176, 2013.

[24] Garofalo, N. and Nhieu, D.-M., Isoperimetric and Sobolev inequalities for Carnot-Carath´eodory spaces

and the existence of minimal surfaces, Comm. Pure Appl. Math., 49, 1996, 10, 1081–1144.

[25] H¨ormander, L., Hypoelliptic second order diﬀerential equations, Acta Math., 119 , 1967, 147–171.
[26] Jerison, D. S., The Dirichlet problem for the Kohn Laplacian on the Heisenberg group. I, J. Funct.

Anal., 43, 1981, 1, 97–142.

[27] Jerison, D. S. and Kenig, C. E., Boundary behavior of harmonic functions in nontangentially accessible

domains, Adv. in Math., 46, 1982, 1, 80–147.

[28] Jerison, D. S. and S´anchez-Calle, A., Estimates for the heat kernel for a sum of squares of vector ﬁelds,

Indiana Univ. Math. J., 35, 1986, 4, 835–854.

[29] Kaplan, A., Fundamental solutions for a class of hypoelliptic PDE generated by composition of quadratic

forms, Trans. Amer. Math. Soc., 258, 1980, 1, 147–153.

[30] Kohn, J. J. and Nirenberg, L., Non-coercive boundary value problems, Comm. Pure Appl. Math., 18,

1965, 443–492.

32

NICOLA GAROFALO AND ISIDRO H. MUNIVE

[31] Kusuoka, S. and Stroock, D., Applications of the Malliavin calculus. III, J. Fac. Sci. Univ. Tokyo Sect.

IA Math., 34, 1987, 2, 391–442.

[32] Lanconelli, E. and Uguzzoni, F., On the Poisson kernel for the Kohn Laplacian, Rend. Mat. Appl. (7),

17, 1997, 4, 659–677.

[33] Monti, R. and Morbidelli, D., Non-tangentially accessible domains for vector ﬁelds, Indiana Univ. Math.

J., 54, 2005, 2, 473–498.

[34] Monti, R. and Morbidelli, D., Regular domains in homogeneous groups, Trans. Amer. Math. Soc., 357,

2005, 8, 2975–3011 (electronic).

[35] Munive, I., Boundary behavior of non-negative solutions of the heat equation in sub-Riemannian spaces,

Potential Anal., 37, 2012, 4, 333–352.

[36] Nagel, A., Stein, E. M., and Wainger, S., Balls and metrics deﬁned by vector ﬁelds. I. Basic properties,

Acta Math., 155, 1985, 1-2, 103–147.

[37] Poincare, H., Sur les Equations aux Derivees Partielles de la Physique Mathematique, Amer. J. Math.,

12, 1890, 3, 211–294.

[38] Rashevsky, P.K., Any two points of a totally nonholonomic space may be connected by an admissible

line, Uch. Zap. Ped. Inst. im. Liebknechta, Ser. Phys. Math., (Russian), 2, 1938, 83–94.

[39] Uguzzoni, F., Cone criterion for non-divergence equations modeled on H¨ormander vector ﬁelds, Subel-
liptic PDE’s and applications to geometry and ﬁnance, Lect. Notes Semin. Interdiscip. Mat., 6, 227–241,
Semin. Interdiscip. Mat. (S.I.M.), Potenza, 2007.9

[40] Varopoulos, N. Th., Saloﬀ-Coste, L. and Coulhon, T., Analysis and geometry on groups, Cambridge

Tracts in Mathematics, 100, Cambridge University Press, Cambridge, 1992, xii+156.

Dipartimento di Ingegneria Civile, Edile e Ambientale (DICEA), Universit`a di Padova, via

Trieste 63, 35131 Padova, ITALY

E-mail address, Nicola Garofalo: nicola.garofalo@unipd.it

Center for Mathematical Research, CIMAT AC, Guanajuato, 36000 Guanajuato, Mexico
E-mail address: imunive@cimat.mx

