6
1
0
2

 
r
a

M
2

 

 
 
]
h
p
-
m
e
h
c
.
s
c
i
s
y
h
p
[
 
 

1
v
1
6
5
0
0

.

3
0
6
1
:
v
i
X
r
a

An integral-factorized implementation of the driven similarity renormalization
group second-order multireference perturbation theory

Kevin P. Hannon,1 Chenyang Li,1 and Francesco A. Evangelista1, a)
Department of Chemistry and Cherry Emerson Center for Scientiﬁc Computation, Emory University, Atlanta, GA,
30322

(Dated: March 3, 2016)

We report an eﬃcient implementation of a second-order multireference perturbation theory based on the driven
similarity renormalization group (DSRG-MRPT2) [C. Li and F. A. Evangelista, J. Chem. Theory Comput. 11,
2097 (2015)]. Our implementation employs factorized two-electron integrals to avoid storage of large four-
index intermediates.
It also exploits the block structure of the reference density matrices to reduce the
computational cost to that of second-order Møller–Plesset perturbation theory. Our new DSRG-MRPT2
implementation is benchmarked on ten naphthyne isomers using basis sets up to quintuple-ζ quality. We
ﬁnd that the singlet-triplet splittings (∆ST) of the naphthyne isomers strongly depend on the equilibrium
structures. For a consistent set of geometries, the ∆ST values predicted by the DSRG-MRPT2 are in good
agreements with those computed by the reduced multireference coupled cluster theory with singles, doubles,
and perturbative triples.

Keywords: Electronic structure theory, Driven similarity renormalization group, Multireference perturbation
theory, Density ﬁtting, Cholesky decomposition, Naphthyne

I.

INTRODUCTION

Second-order Møller–Plesset perturbation theory
(MP2) is perhaps one of the simplest approach to treat
dynamic electron correlation in atoms and molecules.1
Eﬃcient implementations of MP2 may be achieved via
techniques that factorize the two-electron integrals via
density ﬁtting (DF),2,3 or Cholesky decomposition.4–9
Due to lower storage requirements,
integral factoriza-
tion techniques signiﬁcantly reduce the cost of MP2
calculations and easily permit to target systems with
2000–3000 basis functions.10 Linear scaling10–13 and
stochastic14–16 implementations of MP2 can further
reduce the asymptotic computational scaling of MP2
from O(N 5) to O(N ), where N is the number of basis
functions.
However, when MP2 is applied to study open-shell
species, the buildup of static correlation due to near-
degenerate excited conﬁgurations can lead to the diver-
gence of the correlation energy. In this case, it is nec-
essary to use a multireference generalization of pertur-
bation theory (MRPT) that can handle both dynamic
and static correlation eﬀects.
In practice, the distinc-
tion between dynamic and static correlation is enforced
by dividing the full conﬁguration interaction space into
a reference space and its orthogonal complement. The
reference space consists of determinants generated by
varying the occupation of the close-lying active orbitals,
and consequently captures static correlation eﬀects. Nu-
merous multireference perturbation theories have been
proposed,17–23 many of which have been conveniently re-
viewed and compared in Refs. 21 and 22.

a)Electronic mail: francesco.evangelista@emory.edu

A troubling aspect of several multireference perturba-
tion theories is the well-known intruder-state problem.24
Intruder states are encountered when determinants that
lie within the reference space become near-degenerate
with determinants that lie in the orthogonal complement.
In perturbative theories, intruders lead to divergences
in the ﬁrst-order amplitudes, and the corresponding po-
tential energy curves show characteristic spikes.25–27 A
popular solution to remove intruders is shifting the en-
ergy denominators.28 However, level shifting can signiﬁ-
cantly aﬀect computed spectroscopic constants29 and the
order of electronic states.30 In second-order n-electron
valence state perturbation theory (NEVPT2),20,31,32 in-
truders are removed by using Dyall’s modiﬁed zeroth-
order Hamiltonian.33 Nevertheless, Zgid et al.34 noticed
that if the three- and four-particle density cumulants are
approximated then “false intruders” may also appear in
NEVPT2.

The importance of the intruder-state problem is
not limited to multireference perturbation theories.
In the case of multireference coupled cluster theories
(MRCC)35–44 and other nonperturbative theories of dy-
namical correlation,45–47 intruders cause numerical insta-
bility problems. In this case, however, it is more appro-
priate talk of intruder solutions, which arise from ex-
istence of multiple solutions to the MRCC equations.26
Unfortunately, it is still not clear whether or not tradi-
tional techniques used to remove intruders in MRPT can
be extended to the case of nonperturbative multirefer-
ence methods. Therefore, ﬁnding a solution to the prob-
lem of intruders in MRPT might also shed light on how
to create highly-accurate multireference approaches that
are numerically stable.

Recently, we have proposed the driven similarity renor-
malization group (DSRG),48 a many-body formalism in-
spired by ﬂow renormalization group methods.49–55 The

DSRG was used to formulate a theory of dynamic elec-
tron correlation that is free from divergences due to van-
ishing denominators. In the unitary DSRG ansatz, the
bare Hamiltonian ( ˆH) is progressively brought to a block-
diagonal form (renormalized) via a continuous unitary
transformation [ ˆU (s)] controlled by the so-called ﬂow
variable s:

ˆH → ¯H(s) = ˆU (s) ˆH ˆU

†

(s),

s ∈ [0,∞).

(1)

In the limit s → ∞ the DSRG unitary operator ˆU (s)
is required to block-diagonalize the Hamiltonian. More
speciﬁcally, if we indicate the non-diagonal part of ¯H(s)
with [ ¯H(s)]N,56,57 then we require that in the limit of s
that goes to inﬁnity, the DSRG transformation must zero
the nondiagonal parts of ¯H(s), that is lims→∞[ ¯H(s)]N =
0. For intermediate values of s, the DSRG transformation
achieves a partial block-diagonalization of the Hamilto-
nian, leaving states that diﬀer in energy by less than the
energy cutoﬀ Λ = s−1/2 mostly unchanged.49,58–60 Con-
sequently, in the DSRG the mixing of reference-space de-
terminants with close-lying determinants in the orthog-
onal complement is suppressed and intruder states are
avoided.

Another distinctive aspect of the DSRG is that it em-
ploys a Fock-space many-body formalism,61,62 such that
Eq. (1) should be interpreted as a set of operator equa-
tions. Nooijen and coworkers41 recently pointed out that
a many-body formulation of multireference theories is ad-
vantageous because it removes the need to orthogonal-
ize the excitation manifold. The orthogonalization step
is often a bottleneck that prevents computations with
large active spaces. For example, in a study of the com-
plete active space perturbation theory (CASPT2)17,63–65
coupled with the density matrix renormalization group
(DMRG),66–69 Yanai and Kurashige70 found that the
perturbation theory is limited to approximately 30 active
orbitals per irreducible representation due to the required
diagonalization of the overlap metric between internally-
contracted conﬁgurations.

In a previous work,71 we formally extended the
DSRG to multireference cases (MR-DSRG) by employ-
ing the generalized Wick theorem of Mukherjee and
Kutzelnigg.72 To study the viability of the MR-DSRG ap-
proach we performed a perturbative analysis and derived
a second-order MR-DSRG perturbation theory (DSRG-
MRPT2). The DSRG-MRPT2 energy and amplitude
equations are surprisingly simple and lead to a computa-
tional approach that requires only the the two- and three-
body cumulants of the reference wave function. Bench-
mark computations on small systems (HF, N2, and p-
benzyne) showed that the DSRG-MRPT2 has an accu-
racy comparable to that of other second-order MRPTs.
The DSRG-MRPT2 method avoids the intruder-state
problem without the use of level-shifting or increasing
the size of the active space, and in addition, it is rig-
orously size consistent,73,74 and thus applicable to large
systems.

2

The present work focuses on the eﬃcient implemen-
tation of the DSRG-MRPT2 theory to extend its ap-
plicability to chemically interesting systems. We care-
fully analyze each energy contribution, and realize the
possibility to factorize some terms by taking advantage
of the structure of the one-particle and one-hole density
matrix. For an active space of ﬁxed size, the improved
algorithm is dominated by terms have the same com-
putational cost of single-reference second-order Møller–
Plesset perturbation theory. The simplicity of the DSRG-
MRPT2 equations allows us to utilize common integral
factorization techniques,75 including density ﬁtting and
Cholesky decomposition, to reduce the memory and disk
requirements.
In addition to MP2, various electronic
structure methods have beneﬁted from these integral
factorization tactics.10,76–81 For instance, the Cholesky-
decomposed CASPT2 has been applied to systems with
up to 1500 basis functions82,83 and the density-ﬁtted
NEVPT2 has been used in applications with up to 2000
basis functions.31,84

This paper proceeds as follow. In Sec. II, we start with
an overview of the DSRG-MRPT2 theory and integral
factorization techniques. Then, in Sec. III we analyze
the computational complexity of each energy term and
detail our current implementation. Section V presents
applications of DSRG-MRPT2 to evaluate the singlet-
triplet splittings of naphthynes. Finally, we discuss fu-
ture developments of the DSRG-MRPT2.

II. THEORY

A. The MR-DSRG formalism

In this section we brieﬂy summarize the MR-DSRG
approach.71 We assume that the reference is deﬁned by
a set of spin orbitals {φp} partitioned into core (C), ac-
tive (A), and virtual (V) subsets of size NC, NA, and
NV, respectively. Core orbitals are designated by in-
dices m, n, active orbitals by indices u, v, w, x, y, z, and
virtual orbitals by indices e, f . We also introduce two
composite orbital subsets: hole (H = C ∪ A) and par-
ticle (P = V ∪ A) of dimension NH = NC + NA and
NP = NV + NA, respectively. Orbitals belonging to hole
set are associated with the labels i, j, k, l, while particle
orbitals are labeled with a, b, c, d. General orbitals (hole
or particle) are labeled as p, q, r, s.

We consider the case of a complete active space (CAS)
self-consistent ﬁeld (CASSCF) or a CAS conﬁguration
interaction (CASCI) reference wave function Φ obtained
by doubly occupying the core orbitals and distribut-
ing a given number of active electrons (nact) in the ac-
tive orbitals [CAS(nact, NA)]. The reference Φ deﬁnes
the Fermi vacuum with respect to which all operators
are normal ordered according to Mukherjee and Kutzel-
nigg’s generalized Wick theorem.72,85–89 From the refer-
ence wave function we also extract the one-particle den-
sity matrix (γp
q ) as well as the two- and three-body cu-

mulants (λrs

pq, λstu

pqr),72,90,91 deﬁned as:
†
γp
pˆaq|Φ(cid:105) ,
q = (cid:104)Φ|ˆa
λxy
uv = γxy
uγy
λxyz
uvw = γxyz

v + γy
uγx
v ,
(−1)πγx
uλyz

uv − γx
uvw −(cid:88)π

vw − det(γx

uγy

v γz

w),

(2)

(3)

(4)

where det(·) indicates the sum of all permutations of
lower labels with a sign factor corresponding to the par-

ity of permutations and (cid:80)(−1)π indicates a sum over

all permutations of the lower and upper labels with a
sign factor corresponding to the parity of a given per-
mutation. Note that for a CASSCF/CASCI reference
the cumulant are null unless all indices belong to the ac-
tive space. For convenience we also deﬁne the one-body
cumulant as λv
u, with u, v ∈ A. The MR-DSRG
equations for the amplitude and energy [E(s)] are given
by:

u = γv

E(s) = (cid:104)Φ| ¯H(s)|Φ(cid:105) ,

[ ¯H(s)]N = ˆR(s),

(5)

(6)

where ˆR(s) is the source operator, a s-dependent Her-
mitian operator that drives the transformation of the
Hamiltonian. Thus, the unitary operator, ˆU (s), is im-
plicitly deﬁned by ˆR(s). The unitary operator ˆU (s) that
controls the DSRG transformation is expressed as the
exponential of an anti-Hermitian operator ˆA(s), that is,
ˆU (s) = exp[ ˆA(s)]. The operator ˆA(s) is conveniently ex-
pressed in terms of the coupled cluster excitation opera-
tor ˆT (s), so that ˆA(s) = ˆT (s)− ˆT †(s). Note that internal
amplitudes that involve only active-orbital indices are ex-
cluded from ˆT (s), that is txy...
uv...(s) = 0 ∀u, v, x, y ··· ∈ A.

B. The DSRG-MRPT2 method

The starting point of the DSRG-MRPT2 approach is
the partitioning of the normal-ordered Hamiltonian into
a zeroth-order part [ ˆH (0)] plus a ﬁrst-order perturbation
[ ˆH (1)]. The zeroth-order Hamiltonian is chosen to con-
tain the reference energy (E0) and the diagonal block of
the one-body operator [ ˆF (0)]:71

ˆH (0) = E0 + ˆF (0),
εp{ˆap
p},

ˆF (0) =(cid:88)p

(7)

(8)

where the orbital energies εp = f p
ments of the generalized Fock matrix:

p are the diagonal ele-

f q
p = hq

p +(cid:88)rs

prγr
vqs
s .

(9)

3

As is the case for other perturbation theories, we ﬁnd it
advantageous to formulate the DSRG-MRPT2 in a basis
of semicanonical molecular orbitals92 so that the core,
active, and virtual blocks of the generalized Fock matrix
are diagonal. This choice implies that ˆF (1) only contains
contributions from the oﬀ-diagonal blocks of the Fock
matrix.

The DSRG-MRPT2 equations may be obtained
from Eqs.(5) and (6) by performing a order-by-order
expansion.93 The zeroth-, ﬁrst-, and second-order energy
expressions are given by:71

E(0)(s) = E0,
E(1)(s) = 0,
E(2)(s) = (cid:104)[ ˜H (1)(s), ˆT (1)(s)](cid:105) ,

(10)

(11)

(12)

where ˜H (1) is an eﬀective ﬁrst-order Hamiltonian with
modiﬁed non-diagonal components:

˜H (1)(s) = ˆH (1)(s) + [ ˆR(1)(s)]N,

(13)

while the diagonal components of ˜H (1) are identical to
those of ˆH (1).

A ﬁrst-order expansion of the MR-DSRG amplitude

equations leads to the equation:

[ ˆH (1)]N + [ ˆH (0), ˆT (1)]N = [ ˆR(1)(s)]N,

(14)

from which explicit equations for the the ﬁrst-order am-
plitudes can be derived:71

ti,(1)
a

(s) = [f i,(1)

a +

utiu,(1)

ax

(s)γx
u]

1 − e−s(∆i

a)2

∆i
a

,

ab)2

.

(15)

(16)

∆x

A(cid:88)ux
1 − e−s(∆ij

∆ij
ab

tij,(1)
ab

(s) = vij,(1)

ab

ab···, deﬁned as ∆ij···

Here we have introduced the Møller–Plesset denomina-
tors ∆ij···
ab··· = εi + εj + . . .− εa − εb − . . ..
In the derivation of Eqs. (15) and (16) we used the source
operator introduced in Ref. 48, which is designed to re-
produce the energy of the second-order similarity renor-
malization group.94

Once the ﬁrst-order amplitudes are solved, the second-
order energy E(2)(s) can be obtained via an eﬃcient
non-iterative procedure that requires at most three-body
density cumulants. For convenience, we list all DSRG-
MRPT2 energy contributions in Table I. These quantities
are expressed in terms of the modiﬁed ﬁrst-order Fock
matrix matrix elements:

˜f i,(1)
a

(s) =f i,(1)

a

[1 + e

−s(∆i

a)2

]

∆x

utiu,(1)

ax

(s)γx

u]e

−s(∆i

a)2

,

(17)

+ [(cid:88)ux

The quantities hq
pq = (cid:104)φpφq||φrφs(cid:105)
are respectively one-electron and antisymmetrized two-
electron integrals in the molecular orbital basis.

p = (cid:104)φp|ˆh|φq(cid:105) and vrs

the modiﬁed two-electron integrals:

˜vij,(1)
ab

(s) =vij,(1)

ab

[1 + e

−s(∆ij

ab)2

],

(18)

Table I. DSRG-MRPT2 second-order energy expressions. The
Einstein convention for the summation over repeated indices
is employed. Asymptotic scalings are given in big O notation
from a straightforward tensor-index analysis.

Term

Energy Expression

Cost

(s)](cid:105)

(s)](cid:105)

+ ˜f b,(1)

j

b

1

a

xy

(cid:104)[ ˜F (1)(s), ˆT (1)
1
(s)ti,(1)
(s)γj
i ηa
(cid:104)[ ˜V (1)(s), ˆT (1)
(s)tu,(1)
(s)λxy
uv
(s)tm,(1)
(s)λxy
uv
(cid:104)[ ˜F (1)(s), ˆT (1)
˜f e,(1)
(s)tuv,(1)
x
˜f v,(1)
m (s)tum,(1)

2 ˜vev,(1)
2 ˜vuv,(1)

my

xy

ey

x

2

e

+ 1
− 1

+ 1
2
− 1

2

(s)](cid:105)

(cid:104)[ ˜V (1)(s), ˆT (1)
(s)tij,(1)
(s)γk
(s)tuv,(1)
(s)tij,(1)

ab

ab

xy
(s)tiv,(1)

ay

(s)γj

2

(s)λxy
uv
(s)λxy
uv
(s)](cid:105)
jηa
i γl
c ηb
d
dλxy
c ηb
uv
jλxy
i γl
(s)γk
uv
i ηa
b λxy
uv
(s)λxyz
uvw
(s)λxyz
uvw

(s)ηa

xy

(s)tmw,(1)
(s)tuv,(1)

ez

kl

kl

xy

+ 1

+ 1

4 ˜vcd,(1)
8 ˜vcd,(1)
8 ˜vuv,(1)
+ 1
+˜vbu,(1)
4 ˜vuv,(1)
+ 1
4 ˜vwe,(1)

+ 1

mz

xy

jx

N 2

PN 2
H

N 4

ANV

N 4

ANC

N 4

ANV

N 4

ANC

N 3

N 4

N 4

N 4

PN 2
H
AN 2
P
AN 2
H
ANPNH

N 6

ANC

N 6

ANV

A

B

C

D

E

F

G

H

I

J

K

q , ηp

q = δp

the one-particle and one-hole density matrix elements
(γp
q − γp
q ), and the two- and three-body density
cumulants (λuv
xyz ) of the reference Φ. Eqs. (15)–(18)
and the equations reported in Table I deﬁne the DSRG-
MRPT2 method.

xy, λuvw

To highlight the mechanism by which the DSRG-
MRPT2 avoids intruders, we perform a Maclaurin ex-
pansion of the ﬁrst-order amplitudes as a function of
the energy denominators. For example, the t2 amplitude
[Eq. (16)] can be rewritten as:

tij,(1)
ab

(s) = vij,(1)

ab

ab + O[s3/2(∆ij

(19)

(cid:16)s∆ij

ab)3](cid:17) ,

4

C.

Integral factorizations

The simple structure of the MR-DSRG amplitude and
energy equations (Table I) allows the use of integral
factorization techniques such as DF and/or Cholesky
decomposition to improve the eﬃciency of the DSRG-
MRPT2.
Integral factorization techniques seek to ap-
proximate the electron repulsion integrals as a contrac-
tion of two three-index tensors. The two-electron inte-
grals written in chemist notation can be factorized as:

(pq|rs) ≈

M(cid:88)Q

BQ

pqBQ
rs,

(20)

where M is the size of the auxiliary basis set {χP (r)}. In
the DF approach, the factors BQ

pq are given by:95
−1/2]P Q,

(21)

BQ

pq =(cid:88)P

(pq|P )[J

where (pq|P ) and JP Q are three- and two-center integrals
deﬁned as:

(pq|P ) =(cid:90) dr1(cid:90) dr2 φp(r1)φq(r1) r
JP Q =(cid:90) dr1(cid:90) dr2 χP (r1) r

−1
12 χQ(r2).

−1
12 χP (r2),

(22)

(23)

In this work we evaluate the DSRG-MRPT2 energy using
the resolution of the identity (RI) basis sets of Weigend
and co-workers.96 We note, however, that there is no con-
sensus on the most appropriate auxiliary basis set for
multireference perturbation theories.

In the CD approach, the Cholesky factors BQ

pq are ob-
tained directly via decomposition of the four-index two-
electron integrals.8 The CD approach generates the aux-
iliary basis set by a numerical Cholesky decomposition.97
As such, CD is sometimes referred to ab initio den-
sity ﬁtting.6,7 The upper bound of the summation
M in Eq. (20) is determined by a CD threshold,
which measures the error introduced by the Cholesky
decomposition.7,8

which approaches zero in the limit of |∆ij
ab| → 0. Thus
for ﬁnite values of s, the second-order energy, E(2)(s), is
well-behaved and free from divergences due to small en-
ergy denominators. One of the drawbacks of the DSRG-
MRPT2 renormalization procedure is that the ﬁnal en-
ergy shows a dependence on the value of s used in a
computation. In our previous work,71 we analyzed the s-
dependence of the DSRG-MRPT2 energy and found that
−2
the range s ∈ [0.1, 1.0] E
h gives the best agreement with
full conﬁguration interaction results. Values of s that fall
out of this “Goldilocks zone” either lead to recovering
too little correlation energy (when s (cid:28) 0.1) or expose
the theory to the intruder state problem (when s (cid:29) 1).

III.

IMPLEMENTATION

An eﬃcient implementation of the DSRG-MRPT2 is
achieved by taking advantage of the structure of the den-
sity matrices and integral factorization.
In most prac-
tically relevant cases, the number of active orbitals is
negligible compared to the number of core and virtual
orbitals, that is we may assume that:

NA (cid:28) NC < NV.

(24)

Under this assumption, the most expensive term in
the evaluation of the DSRG-MRPT2 energy is term F

5

Table II. DSRG-MRPT2 energy terms that arise from dia-
gram F after taking into account the block structure of the
one-hole and one-particle density matrices. Contractions in-
volving the one-particle density matrix (γi
j) and hole indices
are indicated with a red circle, while contractions of the one-
hole density matrix (ηa
b ) and particle indices are indicated
with a blue circle.

Expression

˜vef,(1)
mn (s)tmn,(1)

(s)

ef

˜vef,(1)
mu

(s)tmv,(1)

ef

(s)γu
v

˜vev,(1)
mn (s)tmn,(1)

eu

(s)ηu
v

Term

Diagram

F1

F2

F3

F4

F5

F6

F7

F8

1
2

1
2

1
4

mnef

mef uv

mneuv

(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)
(cid:80)

wxyz

uvxy

mn

1
4

1
4

1
2

me

1
2

ef

uvxy

uvxy

(cid:80)
(cid:80)

euv

mwz

uvxy

˜vef,(1)
xu

(s)tyv,(1)

ef

(s)γx

y γu
v

˜vvy,(1)
mn

(s)tmn,(1)

ux

(s)ηu

v ηx
y

˜vve,(1)
mx

(s)tmy,(1)

ue

(s)γx

y ηu
v

˜vve,(1)
yz

(s)twx,(1)

ue

(s)γy

wγz

xηu
v

mw (s)tmz,(1)
˜vvy,(1)

ux

(s)γw

z ηu

v ηx
y

γi
j

ηa
b

−2s(∆mn

ef )2

]/∆mn
the renormalized denominators [1 − e
ef
through a dot-product operation to give a pair energy
for every m and n.98 The loop over the (m, n) pairs is
parallelized using OpenMP for shared memory architec-
tures. The scaling of the implementation of Eq. (26)
on a eight-core processor is demonstrated in Fig. 2. Our
implementation is also optimized for the evaluation of di-
agrams F2 and F3 so that no storage of large four-index
intermediate quantities is necessary.

The DSRG-MRPT2 equations are implemented in our
code Forte,99 a suite of multireference methods written
as a plugin to the Psi4 quantum chemistry package.100
All tensor contractions were coded using the open-source
library Ambit.101 Ambit provides shared memory paral-
lelization and performs tensor contractions using BLAS
operations. A very convenient feature of Ambit is its
ability to deal with composite orbital spaces. Figure 3
gives an example of a tensor contraction encountered in
the DSRG-MRPT2 equations and how it is implemented

Figure 1. The structures of one-particle density matrix γp
q
and one-hole density matrix ηp
q Non-zero elements of the one-
particle and one-hole density matrices are indicated respec-
tively in red and blue.

of Table I. This term originates from the contraction

2

(cid:104)[ ˜V (1)(s), ˆT (1)
H(cid:88)ijkl

F =

1
4

(s)](cid:105) and is given by:

˜vcd,(1)
kl

(s) tij,(1)

ab

P(cid:88)abcd

(s) γk

i γl

jηa

c ηb
d.

(25)

PN 2

PN 4

H) via factorization into intermediate tensors.

The computational cost required to evaluate term F
scales formally as O(N 4
H), but can be reduced to
O(N 3
For a CASSCF/CASCI reference, we can reduce the
cost of evaluating term F by taking advantage of the
structure of the one-particle and one-hole density ma-
trices. As illustrated in Fig. 1, γp
q is diagonal in the
core-core block and in the active-active block it is equal
to the one-body cumulant λp
q. Upon explicit replace-
ment of the one-body density and hole density matri-
ces into Eq. (25) we obtain eight contributions (F1–F8)
that are reported in Table II. Each term is also rep-
resented as a diagram in which one or more lines pass
through a one-particle (red circle) or one-hole (blue cir-
cle) vertex. The most expensive contributions to term F
[Eq. (25)] is diagram F1, which has a computation scal-
ing of O(N 2
C), followed by F2 and F3, which scale
as O(N 2
C), respectively. The
remaining diagrams shown in Table II (F4–F8) carry at
least two active indices and are signiﬁcantly less expen-
sive to evaluate.

VNANC) and O(NVNAN 2

VN 2

Diagram F1 may be written in a form that is reminis-

cent of the MP2 correlation energy:

1
4

C(cid:88)mn

V(cid:88)ef

−2s(∆mn

ef )2

mn|2 1 − e
|vef

∆mn
ef

.

(26)

Eq. (26) can be implemented in an eﬃcient way by an
outer loop over pairs of occupied orbitals m and n. For
each pair (m, n) we compute all the antisymmetrized two
electron integrals {vef
mn,∀e, f} using the DF or CD fac-
tors. The integrals squared are then contracted with

γpq=δpqp,q∈Cλpqp,q∈A0otherwiseηpq=0otherwise−p,q∈Aδpqp,q∈VδpqλpqACVACVefmnuvefmuvemnyxuvefuxvymnuvxyemxuzvyweuxvywzmijab6

grals:

1. Compute γq
p,

p, λxy
ηq
uv,
CASSCF/CASCI reference.

and λxyz

uvw for

the

2. Compute the Fock matrix from γq

p and the DF/CD

tensors.

Figure 2. The scaling of diagram F1 of Table II for (2, 3)-
naphthyne using a cc-pVTZ basis set. The speed up is de-
termined as S(1)
S(N ) where S(i) is the total time required to
evaluate this term using i threads. Results are for up to 8
threads on an Intel Xeon E5-2650 v2 processor.

Figure 3. This ﬁgure illustrates the ability of the Ambit ten-
sor library to deal with block-sparse tensors that span com-
posite orbital space. The tensor contraction shown at the top
involves a summation over the index j that spans the general-
ized orbitals space (H), which is the union of the core (C) and
active (A) orbitals. The tensors γj
a are deﬁned over
subsets (shown in orange) of the full orbital indices and are
block sparse. For example, the A-A block of ti
a is zero because
internal amplitudes are not deﬁned in the DSRG-MRPT2.
Ambit allows to write contractions over block-sparse tensors
as contractions over composite index tensors, thus, reducing
the number of equations required to include in the source
code.

i and ti

3. Canonicalize the core, active, and virtual MOs.

4. Form the antisymmetrized two electron integrals
with at least one active index from the DF/CD ten-
sors.

5. Transform all the density matrices, cumulants, and

integrals to the semi-canonical basis.

6. Compute the second order energy terms A–E, G–K,

and F4–F8 using the Ambit library.

7. Compute the energy terms F1–F3 with an opti-
mized algorithm that does not require storage of
four-index intermediates.

IV. COMPUTATIONAL DETAILS

In this work, we studied the singlet-triplet splittings
(∆EST = ES − ET) of ten naphthyne isomers. Each iso-
mer is designated as (i, j)-naphthyne, and it is formally
obtained by removing two hydrogens from the carbons
at i and j positions of a naphthalene. Figure 4 shows the
numbering scheme of naphthalene used in this work.

Figure 4. Naphthalene numbering scheme used in this study.
The notation (i, j)-naphthyne indicates that two hydrogen
atoms were removed from positions i and j.

via Ambit. Composite spaces are deﬁned from “primi-
tive” spaces (for example, the sets of core, active, virtual
MOs) and arise naturally in all multireference theories
based on a CASCI/CASSCF reference. Ambit is aware
of composite orbital spaces and can perform contractions
over block-sparse tensors. This feature greatly simpliﬁes
the implementation of multireference theories since it al-
lows the user to directly encode tensor contractions that
involve composite orbital indices.

In summary, the following procedure was used for com-
puting the DSRG-MRPT2 energy using DF or CD inte-

Following Ref. 102, we optimized the geometry of
singlet (1,3)-, (2,6)-, and (1,6)-naphthyne isomers at
the CASSCF/cc-pVDZ level of theory with a CAS(4,4),
CAS(2,2), and CAS(2,2) active space,
respectively.
All other naphthyne isomers were optimized using
Becke’s three-parameter exchange103 and Lee-Yang-Parr
correlation104 (B3LYP) functional and the cc-pVDZ105
basis set. Unrestricted Kohn-Sham orbitals were used
for both singlet and triplet states. Geometry optimiza-
tions were performed using the NWChem106 software
package.

112345678234Number of coresActualIdeal5678Speed-upI[”ja”] = gamma[”ji”] * t1[”ia”];Ija=Hiγjitia=ACVTensor contractionC++ codeContractions between block-sparse tensors87651043219Table III. Point group symmetries for all naphthyne iso-
mers along with the corresponding minimal active spaces
in Cotton’s ordering.107 For (1,4)-, (1,8)-, (2,3)-, and (2,7)-
naphthynes, the molecules are placed in the xz plane, where
z is the C2 rotation axis. All other naphthynes are placed in
the xy plane.

Isomer

Sym.

1,2
1,3
1,4
1,5
1,6
1,7
1,8
2,3
2,6
2,7

Cs
Cs
C2v
C2h
Cs
Cs
C2v
C2v
C2h
C2v

States
1A(cid:48), 3A(cid:48)
1A(cid:48), 3A(cid:48)
1A1, 3B1
1Ag, 3Bu
1A(cid:48), 3A(cid:48)
1A(cid:48), 3A(cid:48)
1A1, 3B1
1A1, 3B1
1Ag, 3Bu
1A1, 3B1

Active Space

CAS(2,2)
(2, 0)
(2, 0)
(1, 0, 1, 0)
(1, 0, 0, 1)
(2, 0)
(2, 0)
(1, 0, 1, 0)
(1, 0, 1, 0)
(1, 0, 0, 1)
(1, 0, 1, 0)

CAS(12,12)
(2, 10)
(2, 10)
(1, 5, 1, 5)
(1, 5, 5, 1)
(2, 10)
(2, 10)
(1, 5, 1, 5)
(1, 5, 1, 5)
(1, 5, 5, 1)
(1, 5, 1, 5)

7

Table IV. Analysis of the DSRG-MRPT2 energy error (in kcal
mol−1) introduced by density ﬁtting (DF) and Cholesky de-
composition (CD). Statistics were computed from the singlet-
triplet splittings of the ten naphthyne isomers. Density ﬁtting
results were obtained using the cc-pVDZ-RI auxiliary basis
set, while Cholesky vectors were generated using a threshold
of 10−5 Eh.

Factorization

DF

CD

Statistics
MAXb
MAEc

σd

MAXb
MAEc

σd

VDZ*a
0.017
0.007
0.005
0.003
0.002
0.001

cc-pVDZ

0.017
0.007
0.005
0.004
0.002
0.001

a The VDZ* basis set is constructed from the cc-pVDZ basis
(cid:80)10
set by removing the p functions for hydrogen atoms.
b Maximum absolute error: MAX = max(|∆i|).
(cid:80)10
i=1 |∆i|.
c Mean absolute error: MAE = 1
10
i=1(∆i − ¯∆)2]1/2, where
d Standard deviation: σ = [ 1
10

(cid:80)10

¯∆ = 1
10

i=1 ∆i.

State-speciﬁc DSRG-MRPT2 computations used a
CASCI reference. The active spaces for diﬀerent naph-
thyne isomers are reported in Table III. Since at the
moment we do not have access to a DF/CD CASSCF
implementation, we opted for evaluating the energy of
both the singlet and triplet states using restricted open-
shell Hartree–Fock (ROHF) orbitals. This choice of or-
bitals is certainly not optimal, and may lead to an imbal-
anced treatment of singlet and triplet states. Dunning’s
correlation-consistent cc-pVXZ (X = D, T, Q, 5) ba-
sis sets105,108 were used to deduce basis set eﬀects, and
the corresponding auxiliary basis sets were chosen as cc-
pVXZ-JKFIT basis sets109 for ROHF computations and
cc-pVXZ-RI basis sets96,110 for DSRG-MRPT2 compu-
−2
tations. We used a value of s = 0.5 E
h , and kept the
1s-like orbitals on carbon atoms frozen for all DSRG-
MRPT2 computations.

We ﬁrst verify the accuracy of the integral factoriza-
tion techniques by performing DSRG-MRPT2 computa-
tions with DF, CD, and conventional integrals. Table IV
reports an analysis of the errors introduced by the DF
and CD approximations when applied to compute ∆ST.
These results shows that both approximations introduce
errors that are well within chemical accuracy: the max-
imum absolute error for DF and CD is only 0.017 and
0.003 kcal mol−1, respectively.

Table V reports adiabatic singlet-triplet splittings of
the ten naphthyne isomers computed with the DSRG-
MRPT2 approach using various basis sets (cc-pVXZ,
with X = D, T, Q, 5). These results were computed us-
ing two active spaces: 1) CAS(2,2) which consists of two
carbon σ orbitals on radical centers and 2) CAS(12,12),
which augments the CAS(2,2) space with ten carbon π
orbitals.

V. RESULTS

A. Singlet-triplet splittings of naphthyne diradicals

In this section we will demonstrate how our eﬃcient
implementation of the DSRG-MRPT2 can be used to
obtain the singlet-triplet splitting of naphthynes with
fairly large basis sets. Among arynes,111–113 the elec-
tronic structure of ortho, meta, and para benzyne has
been well characterized from the point of view of both
experiment and theory.102,114–120 However, in the case of
naphthynes, singlet-triplet splittings have been investi-
gated mostly by theoretical studies102,115,121,122 and, to
the best of our knowledge, no experimental values have
been reported.

Following the analysis of Squires and Cramer,115
we separate the naphthyne isomers into three diﬀer-
ent groups characterized by diﬀerent magnitudes of the
singlet-triplet splitting.102 Group I naphthynes, which
consists of (1,2) and (2,3)-naphthyne, have adjacent rad-
ical centers and their ∆ST is comparable to that of o-

benzyne (−37.5 ± 0.3 kcal mol−1, from experiment).116

For group I naphthynes, through-bond interactions114,115
tend to stabilize the singlet state and are thus responsi-
ble for the relatively large ∆ST value. Our best DSRG-
MRPT2 estimates for the ∆EST of (1,2) and (2,3)-

naphthyne are −33.6 and −28.9 kcal mol−1, respectively.

Group II contains (1,3)-naphthyne, the only isomer
with the two radical centers in meta position. Our best
estimate for the ∆ST value of this isomer is −14.2 kcal
mol−1, which is comparable to the value for m-benzyne
(−21.0 kcal mol−1). Going from group I to II, there

is a buildup of diradical character, which is reﬂected in
the ratio between the two dominant conﬁgurations of the

8

Table V. Adibatic singlet-triplet splittings (∆EST = ES − ET) of naphthyne diradicals computed with the DF-DSRG-
MRPT2 approach and a variety of basis sets. All computations utilized ROHF triplet orbitals. Carbon 1s-like orbitals
were excluded from the computations of the correlation energy.

Group I

Group II

Group III

Naphthyne Isomers

Active Space

Basis

cc-pVDZ
cc-pVTZ
cc-pVQZ
cc-pV5Z
cc-pVDZ
cc-pVTZ
cc-pVQZ

CAS(2,2)

CAS(12,12)

c1/c2

a

1,2
−30.2
−33.5
−34.4
−34.7
−29.0
−32.6
−33.6
2.6

2,3
−24.9
−28.3
−29.2
−29.5
−24.3
−27.8
−28.9
2.5

1,3
−11.7
−14.1
−14.4
−14.5
−11.0
−13.7
−14.2
1.6

1,5
1.3
0.3
0.0
0.0
0.8
−0.4
−0.6
1.3

1,6
1.4
−0.8
−1.1
−1.2
2.0
−0.2
−0.5
1.0

1,4
6.4
5.3
5.1
5.1
5.3
4.2
4.1
1.3

2,7
0.9
0.3
0.1
0.0
1.3
0.6
0.3
1.1

2,6
1.3
−0.8
−1.1
−1.1
1.3
−0.8
−1.0
1.0

1,7
5.2
4.2
4.1
4.0
5.2
4.2
4.0
1.1

1,8
3.7
3.0
2.9
2.9
4.3
3.4
3.3
1.2

a The ratio of CI coeﬃcients between the two dominant determinants in a CAS(2,2). This characteristic was used to

separate the naphthynes into three separate groups.

CAS(2,2) reference. This quantity is reported at the bot-
tom of Table V, and it goes from 2.6–2.5 for group I to
1.6 for group II naphthynes. Group III naphthynes have
singlet-triplet splittings that range from −1.0 to +4.1
kcal mol−1. This range is comparable to the ∆ST of p-
benzyne (−3.8 kcal mol−1). As indicated by the small

c1/c2 ratio, these species are almost pure diradicals.

Table VI reports a comparison between our CAS(2,2)
DSRG-MRPT2 results and the reduced multireference
coupled cluster with singles, doubles, and perturbative
triples [RMR-CCSD(T)] results of Li and Paldus102 using
the same geometries and basis set. Our DSRG-MRPT2
results for group I and II isomers agree very well with
those from RMR-CCSD(T): the maximum deviations are
respectively 3.8 and 1.1 kcal mol−1. In the case of group
III naphthynes, the disagreement between the DSRG-
MRPT2 and RMR-CCSD(T) results is slightly less fa-
vorable. The assignment of the ground state is consistent
among the two methods, except for the (1,5) isomer, and
(1,4)-naphthyne displays the largest absolute error (4.8
kcal mol−1).

Table VI also reports a comparison between our
DSRG-MRPT2 results
amd the CASPT2 results
of Squires and Cramer,115 both obtained using a
CAS(12,12) reference. Note, that the comparison of
these two sets of computations is complicated by the
fact that the naphthynes geometries and orbitals used
in these studies are diﬀerent: the CASPT2 calculations
use CASSCF(12,12) optimized geometries and orbitals.
As a consequence, the DSRG-MRPT2 results show some
signiﬁcant disagreements with the CASPT2 results. For
example, the DSRG-MRPT2 results favor triplet ground
states for all the group III isomers, while CASPT2
predicts exactly the opposite. Notice that the RMR-
CCSD(T) approach also predicts triplet ground states
for all group III naphthynes, except for the (1,5) isomer.

To illustrate the importance of the geometry used to
compute ∆ST, we optimized the singlet and triplet state

geometry of (1,4)-naphthyne with the Mukherjee mul-
tireference coupled cluster approach with singles and
doubles (Mk-MRCCSD) using the cc-pVDZ basis set and
a CASSCF(2,2) reference. At this level of theory, the
singlet state is predicted to be the ground state and the

adiabatic ∆ST = −4.98 kcal mol−1. The Mk-MRCCSD

∆ST of (1,4)-naphthyne agrees well with the experimen-
tal ∆ST of p-benzyne, indicating that the nature of these
two diradicals is similar. More importantly, this result
is also in agreement with the ground state assignment
of CASPT2 computations.115 DSRG-MRPT2 ∆ST com-
puted using the Mk-MRCCSD/cc-pVDZ geometries also
favor a singlet ground state. For example, when us-
ing ROHF orbitals, the DSRG-MRPT2 ∆ST is equal

[CAS(12,12)]. The use of CASSCF orbitals improves
the agreement with the Mk-MRCCSD data:
the cor-

to −0.9 kcal mol−1 [CAS(2,2)] and −1.98 kcal mol−1
responding ∆ST are −2.27 kcal mol−1 [CAS(2,2)] and
−3.82 kcal mol−1 [CAS(12,12)]. As anticipated, ROHF
∼1.5 kcal mol−1. Although these results are not conclu-

orbitals tend to favor the triplet state, shifting ∆ST by

sive, they do suggest that to obtain reliable estimates of
∆ST for the naphthynes it is necessary to employ geome-
tries optimized at a high level of theory.

In addition to adiabatic singlet-triplet splittings, in Ta-
ble VII we report a comparison of the vertical DSRG-
MRPT2 splittings with those from highly-accurate mul-
tireference coupled cluster (MRCC) computations by
Brabec and coworkers.121 These authors reported ∆ST
for (2,7)-, (2,6)-, (1,7)- and (1,8)-naphthyne computed
with the Brillouin–Wigner (BW) MRCC approach with
the a posteriori correction38,123 and the Mk-MRCCSD
approach. To facilitate this comparison, all DSRG-
MRPT2 results in Table VII are computed using the
same type of orbitals (restricted Hartree–Fock) and ge-
ometries used by Brabec et al.121 The DSRG-MRPT2
results agree well with those from BW-MRCCSD: both
methods agree in the assignment of the ground state and

Table VI. Adiabatic singlet-triplet splittings (∆EST = ES − ET) of naphthyne diradicals computed with the DSRG-
MRPT2, CASPT2, and RMR-CCSD(T) approaches. All DSRG-MRPT2 computations used triplet ROHF orbitals and
the cc-pVDZ-RI auxiliary basis set. RMR-CCSD(T) results used RHF and ROHF orbitals for singlet and triplet states,
respectively. CASPT2 results used CASSCF(12,12) orbitals. RMR-CCSD(T) and DSRG-MRPT2 results are based on the
same geometries (from DFT and CASSCF, see Sec. IV), while CASPT2 results are based on CASSCF(12,12) optimized
geometries. The VDZ* basis set is constructed from the cc-pVDZ basis set by removing hydrogen p functions.

9

Group I

Group II

Group III

Naphthyne Isomers

1,2

Method

2,3
RMR-CCSD(T)a −35.2 −28.9
DSRG-MRPT2b −30.2 −25.0
−31.8 −27.7
DSRG-MRPT2b −29.0 −24.3

CASPT2c

1,3
−12.7
−11.6
−17.5
−11.0

CAS/Basis

(2,2)/VDZ*

(12,12)/cc-pVDZ

a From Ref. 102.
b This work.
c From Ref. 115.

1,6
2.1
1.5

1,4
1.6
6.4

1,5
1,8
−0.3
6.5
1.3
3.8
−8.6 −2.2 −6.7 −3.9 −3.0 −2.7 −1.8
4.3
0.8

2,7
2.9
0.8

2,6
5.7
1.5

1,7
6.5
5.2

2.0

5.3

1.3

1.3

5.2

the maximum error is only 2.54 kcal mol−1. Note, that
there is a substantial disagreement between the BW- and
Mk-MRCCSD results, which was attributed to the a pos-
teriori corrections used in BW-MRCCSD.

Table VIII. Timing of DSRG-MRPT2 naphthyne computa-
tions (TPT2, in seconds) as a function of basis set size (N ).
The total time (T ) includes the CASCI step, generation of
the DF integrals, and evaluation of the DSRG-MRPT2 en-
ergy. These computations ran on one Intel Xeon E5-2650 v2
processor using 8 threads.

B. Scaling with respect to basis set and active space size

Active Space

Basis

In this section we illustrate the eﬃciency of our DSRG-
MRPT2 by reporting timings for the single-point energy
computation of singlet (2,3)-naphthyne. DSRG-MRPT2
timings for basis sets that range from 152 to 1240 or-
bitals are reported in Table VIII. Due to the eﬃciency
of the DF approximation, DSRG-MRPT2 computations
with 1000–1500 may be performed routinely. Indeed, our
largest calculation using a CAS(2,2) reference and the cc-
pV5Z basis set takes about 5 minutes with 8 threads on
an Intel Xeon E5-2650 v2 processor. This time is only
about 5% of the total time required (110 minutes), with
the majority of the remaining part of the computation
spent building the Fock matrix (20 minutes) and the gen-
eration of the MO transformed DF integrals (35 minutes).
The timings for the CAS(2,2) computations as function

Table VII. A comparison of the vertical singlet-triplet split-
ting between MRCC and the DSRG-MRPT2. All of these
results use singlet geometries, RHF orbitals, and a CAS(2,2).

Naphthyne Isomers

Basis
2,7
cc-pVDZ −3.0
cc-pVTZ −3.2
cc-pVDZ −0.46
cc-pVTZ −0.78
6.47
cc-pVDZ
7.16
cc-pVTZ

Method

DSRG-MRPT2a

BW-MRCCSDb

Mk-MRCCSDb

a This work.
b From Ref. 122

1,7
−1.6
−1.7

2,6
1,8
−2.6
0.2
−2.8
0.2
1.39 −0.34 −1.40
1.05 −0.50 −1.47
3.82
8.48
4.43
9.79

7.29
6.79

CAS(2,2)

CAS(12,12)

cc-pVDZ
cc-pVTZ
cc-pVQZ
cc-pV5Z
cc-pVDZ
cc-pVTZ
cc-pVQZ

N
170
384
730
1240
170
384
730

TPT2
3.5
22.6
93.6
316.5
13.2
72.1
284.3

TPT2/T %

21.0
18.6
7.8
4.8
9.6
27.8
26.5

of the basis set size nicely follow the quadratic scaling
expected from the DSRG-MRPT2 equations when the
number of core and active orbitals is kept ﬁxed. Going
from the CAS(2,2) to the CAS(12,12) active space we
notice an increase of a factor 3–4 of the timing for the
DSRG-MRPT2 step. This result is signiﬁcant because it
suggests that for the active space here considered, terms
that scale as a power of the number of active orbitals have
a very small prefactor. Indeed, even with the CAS(12,12)
reference, the most expensive steps in the energy compu-
tation are the generation of the amplitudes tab
ij and ˜vmn
ef ,
which require respectively 52% and 27% of the total time.

VI. CONCLUSION

In this work, we presented a new formulation of the
DSRG-MRPT2 approach that takes advantage of two-
electron integral factorization and the structure of CAS
density matrices. The resulting algorithm is similar to
the one used in the evaluation of the single-reference MP2
energy, has reduced memory requirements, and allows

10

the routine application of the DSRG-MRPT2 to systems
with up to 50 atoms (1500–2000 basis functions).

REFERENCES

To demonstrate the applicability of this novel DSRG-
MRPT2 implementation to medium-sized system we
studied the singlet-triplet splittings for the ten isomers
of naphthyne diradicals. We reported computations
with CAS(2,2) and CAS(12,12) active spaces and up
to quintuple-ζ quality basis sets (1240 basis functions).
Overall, the DSRG-MRPT2 results are in good agree-
ment with previously reported adiabatic singlet-triplet
splittings computed at the RMR-CCSD(T)/VDZ* level
of theory:
the mean absolute deviation between the
two approaches in only 2.7 kcal mol−1. We ﬁnd that
the singlet-triplet splittings of Group III naphthynes are
strongly dependent on the quality of the molecular ge-
ometries. This fact makes the comparison with previ-
ously reported CASPT2 results more diﬃcult to analyze.
It also suggests that extra caution is required to interpret
highly-correlated results for naphthynes based on DFT or
CASSCF geometries. DSRG-MRPT2 computations with
larger bases suggest that one should at least use a triple-ζ
basis set to converge the single-triplet splitting of Group
III naphthynes to 0.4 kcal mol−1, while a quadruple-ζ
basis is necessary to reduce this error to about 0.1 kcal
mol−1.

In this work we have showed that the cost of evaluating
the DSRG-MRPT2 energy can be signiﬁcantly reduced
by resorting to integral factorization techniques. Never-
theless, the computational scaling of integral-factorized
DSRG-MRPT2 remains proportional to the ﬁfth power
of the number of electrons. Therefore, to apply this ap-
proach to systems with 100–150 atoms it will be neces-
sary to reduce its computational scaling. Given the sim-
plicity of the DSRG-MRPT2 equations, an interesting
option is to combine the prescreening of atomic orbital
(AO) integrals with Laplace transformation of the en-
ergy denominators.11,13,124–126 One novel issue that arises
in the application of the Laplace transformation to the
DSRG-MRPT2 approach is the fact that the energy de-
nominators are renormalized. However, we think that
this problem may be addressed either by ﬁnding a suit-
able decomposition of the renormalized denominators,
or by redeﬁning the source operator to treat the most
expensive contributions (from diagram F1–F3) as non-
renormalized quantities. We anticipate that the Laplace-
transformed AO-DSRG-MRPT2 will be an essential tool
to go beyond the current limit of 2000 basis functions.

ACKNOWLEDGMENTS

The authors are grateful to Dr. Robert M. Parrish for
many insightful discussions. K. P. H. would like to thank
the entire Evangelista lab for their insightful advice. This
research was supported by start-up funds provided by
Emory University.

1S. Hirata, X. He, M. R. Hermes, and S. Y. Willow, J. Phys.
Chem. A 118, 655 (2014).
2J. L. Whitten, J. Chem. Phys. 58, 4496 (1973).
3B. I. Dunlap, J. Connolly, and J. Sabin, J. Chem. Phys. 71,
3396 (1979).
4N. H. Beebe and J. Linderberg, Int. J. Quantum Chem. 12, 683
(1977).
5H. Koch, A. S. de Mer´as, and T. B. Pedersen, J. Chem. Phys.
118, 9481 (2003).
6F. Aquilante, T. B. Pedersen, and R. Lindh, J. Chem. Phys.
126, 194106 (2007).
7F. Aquilante, L. Gagliardi, T. B. Pedersen, and R. Lindh, J.
Chem. Phys. 130, 154107 (2009).
8F. Aquilante, L. Boman, J. Bostr¨om, H. Koch, R. Lindh,
A. S. de Mer´as, and T. B. Pedersen, in Linear-Scaling Tech-
niques in Computational Chemistry and Physics, Challenges
and Advances in Computational Chemistry and Physics, Vol. 13,
edited by R. Zalesny, M. G. Papadopoulos, P. G. Mezey, and
J. Leszczynski (Springer Netherlands, 2011) pp. 301–343.
9N. J. Higham, WIREs: Comp. Stat. 1, 251 (2009).
10H.-J. Werner, F. R. Manby, and P. J. Knowles, J. Chem. Phys.

118, 8149 (2003).

11P. Y. Ayala and G. E. Scuseria, J. Chem. Phys. 110, 3660

(1999).

12M. Schutz, G. Hetzer, and H. J. Werner, J. Chem. Phys. 111,

5691 (1999).

13B. Doser, D. S. Lambrecht, J. Kussmann, and C. Ochsenfeld,

J. Chem. Phys. 130, 064107 (2009).

14S. Y. Willow, K. S. Kim, and S. Hirata, J. Chem. Phys. 137,

204122 (2012).

15S. Y. Willow, M. R. Hermes, K. S. Kim, and S. Hirata, J. Chem.

Theory Comput. 9, 4396 (2013).

16D. Neuhauser, E. Rabani,

and R. Baer, J. Chem. Theory

Compt. 9, 24 (2012).

17K. Andersson, P.-˚A. Malmqvist, and B. O. Roos, J. Chem.

Phys. 96, 1218 (1992).

18K. Hirao, Chem. Phys. Lett. 190, 374 (1992).
19P. M. Kozlowski and E. R. Davidson, J. Chem. Phys. 100, 3672

(1994).

20C. Angeli, R. Cimiraglia, S. Evangelisti, T. Leininger, and J.-P.

Malrieu, J. Chem. Phys. 114, 10252 (2001).

21R. K. Chaudhuri, K. F. Freed, G. Hose, P. Piecuch, K. Kowalski,
M. W(cid:32)loch, S. Chattopadhyay, D. Mukherjee, Z. Rolik, ´A. Szaba-
dos, G. T´oth, and P. R. Surj´an, J. Chem. Phys. 122, 134105
(2005).

22M. R. Hoﬀmann, D. Datta, S. Das, D. Mukherjee, A. Szabados,
Z. Rolik, and P. R. Surj´an, J. Chem. Phys. 131, 204104 (2009).
23F. A. Evangelista, A. C. Simmonett, H. F. Schaefer, D. Mukher-
and W. D. Allen, Phys. Chem. Chem. Phys. 11, 4728

jee,
(2009).

24J. Paldus, P. Piecuch, L. Pylypow, and B. Jeziorski, Phys. Rev.

A 47, 2738 (1993).

25S. Evangelisti, J. P. Daudey, and J. P. Malrieu, Phys. Rev. A

35, 4930 (1987).

26K. Kowalski and P. Piecuch, Phys. Rev. A 61, 052506 (2000).
27K. Kowalski and P. Piecuch, Int. J. Quantum Chem. 80, 757

(2000).

28B. O. Roos and K. Andersson, Chem. Phys. Lett. 245, 215

(1995).

29C. Camacho, H. A. Witek,

and S. Yamamoto, J. Comput.

Chem. 30, 468 (2009).

30C. Camacho, R. Cimiraglia, and H. A. Witek, Phys. Chem.

Chem. Phys. 12, 5058 (2010).

31C. Angeli, R. Cimiraglia, and J.-P. Malrieu, J. Chem. Phys.

117, 9138 (2002).

32C. Angeli, M. Pastore, and R. Cimiraglia, Theor. Chem. Acc.

117, 743 (2007).

33K. G. Dyall, J Chem. Phys. 102, 4909 (1995).

11

34D. Zgid, D. Ghosh, E. Neuscamman, and G. K.-L. Chan, J.

74J. A. Pople, R. Krishnan, H. B. Schlegel, and J. S. Binkley, Int.

Chem. Phys. 130, 194107 (2009).

35B. Jeziorski and H. J. Monkhorst, Phys. Rev. A 24, 1668 (1981).
36U. S. Mahapatra, B. Datta, and D. Mukherjee, Mol. Phys. 94,

157 (1998).

37U. S. Mahapatra, B. Datta, and D. Mukherjee, J. Chem. Phys.

110, 6171 (1999).

38J. Pittner, P. Nachtigall, P. ˇC´arsky, J. M´aˇsik, and I. Hubaˇc, J.

Chem. Phys. 110, 10275 (1999).

39M. Hanrath, J. Chem. Phys. 123, 084102 (2005).
40L. Kong, K. R. Shamasundar, O. Demel, and M. Nooijen, J.

J. Quantum Chem. 14, 545 (1978).

75F. Weigend, M. Kattannek, and R. Ahlrichs, J. Chem. Phys.

130, 164106 (2009).

76C. H¨attig and F. Weigend, J. Chem. Phys. 113, 5154 (2000).
77F. Aquilante, T. B. Pedersen, R. Lindh, B. O. Roos,
A. S´anchez de Mer´as, and H. Koch, J. Chem. Phys. 129, 024113
(2008).

78E. G. Hohenstein and C. D. Sherrill, J. Chem. Phys. 132, 184111

(2010).

79A. E. DePrince and C. D. Sherrill, J. Chem. Theory Comput.

Chem. Phys. 130, 114101 (2009).

9, 2687 (2013).

41D. Datta, L. Kong, and M. Nooijen, J. Chem. Phys. 134, 214116

80E. Epifanovsky, D. Zuev, X. Feng, K. Khistyaev, Y. Shao, and

(2011).

42D. Datta and M. Nooijen, J. Chem. Phys. 137, 204107 (2012).
43M. Nooijen, O. Demel, D. Datta, L. Kong, K. R. Shamasundar,
V. Lotrich, L. M. Huntington, and F. Neese, J. Chem. Phys.
140, 081102 (2014).

44Z. Chen and M. R. Hoﬀmann, J. Chem. Phys. 137, 014108

(2012).

45T. Yanai and G. K.-L. Chan, J. Chem. Phys. 124, 194106

(2006).

46T. Yanai and G. K.-L. Chan, J. Chem. Phys. 127, 104107

(2007).

A. I. Krylov, J. Chem. Phys. 139, 134105 (2013).

81W. Gy¨orﬀy, T. Shiozaki, G. Knizia, and H.-J. Werner, J. Chem.

Phys. 138, 104104 (2013).

82F. Aquilante, P.-˚A. Malmqvist, T. B. Pedersen, A. Ghosh, and

B. O. Roos, J. Chem. Theory Comput. 4, 694 (2008).

83J. Bostr¨om, M. G. Delcey, F. Aquilante, L. Serrano-Andr´es,
T. B. Pedersen, and R. Lindh, J. Chem. Theory Comput. 6,
747 (2010).

84F. Neese, WIREs: Comput. Mol. Sci. 2, 73 (2012).
85D. Mukherjee, Chem. Phys. Lett. 274, 561 (1997).
86U. S. Mahapatra, B. Datta, B. Bandyopadhyay, and D. Mukher-

47E. Neuscamman, T. Yanai, and G. K.-L. Chan, J. Chem. Phys.

jee, Adv. Quantum Chem. 30, 163 (1998).

132, 024106 (2010).

48F. A. Evangelista, J. Chem. Phys. 141, 054109 (2014).
49S. Kehrein, The Flow Equation Approach to Many-Particle Sys-

tems (Springer Berlin Heidelberg, 2006).

50F. Wegner, Annalen der Physik 506, 77 (1994).
51K. Tsukiyama, S. Bogner, and A. Schwenk, Phys. Rev. Lett.

106, 222502 (2011).

52K. Tsukiyama, S. Bogner, and A. Schwenk, Phys. Rev. C 85,

061304 (2012).

53H. Hergert, S. Bogner, T. Morris, S. Binder, A. Calci, J. Lang-

hammer, and R. Roth, Phys. Rev. C 90, 041302 (2014).

54E. Jurgenson, P. Navratil, and R. Furnstahl, Phys. Rev. Lett.

103, 082501 (2009).

87K. R. Shamasundar, J. Chem. Phys. 131, 174109 (2009).
88L. Kong, M. Nooijen, and D. Mukherjee, J. Chem. Phys. 132,

234107 (2010).

89D. Sinha, R. Maitra, and D. Mukherjee, Comput. Theor. Chem.

1003, 62 (2013).

90W. Kutzelnigg and D. Mukherjee, J. Chem. Phys. 110, 2800

(1999).

91D. A. Mazziotti, Chem. Rev. 112, 244 (2011).
92N. C. Handy, J. A. Pople, M. Head-Gordon, K. Raghavachari,

and G. W. Trucks, Chem. Phys. Lett. 164, 185 (1989).

93I. Shavitt and R. J. Bartlett, Many-Body Methods in Chemistry
and Physics: MBPT and Coupled-Cluster Theory (Cambridge
University Press, Cambridge, UK, 2009).

55S. Bogner, R. Furnstahl, and R. Perry, Phys. Rev. C 75, 061001

94H. Hergert,

S. Bogner,

and
http://doi:10.1016/j.physrep.2015.12.007.

Tsukiyama,

K.

T. Morris,
Phys.

Rep.

A.

Schwenk,
(2016),

(2007).

56W. Kutzelnigg, in Recent Progress in Coupled Cluster Meth-
ods, Challenges and Advances in Computational Chemistry and
Physics, Vol. 11, edited by P. ˇC´arsky, J. Paldus, and J. Pittner
(Springer Netherlands, 2010) pp. 299–356.

57W. Kutzelnigg, Int. J. Quantum Chem. 109, 3858 (2009).
58S. D. G(cid:32)lazek and K. G. Wilson, Phys. Rev. D 49, 4214 (1994).
59F. Wegner, in Advances in Solid State Physics 40 , Advances
in Solid State Physics, Vol. 40, edited by B. Kramer (Springer
Berlin Heidelberg, 2000) pp. 133–142.

60S. R. White, J. Chem. Phys. 117, 7472 (2002).
61I. Lindgren, Int. J. Quantum Chem. 14, 33 (1978).
62M. Nooijen and R. J. Bartlett, J. Chem. Phys. 104, 2652 (1996).
63B. O. Roos, P. Linse, P. E. Siegbahn, and M. R. Blomberg,

Chem. Phys. 66, 197 (1982).

64P. Pulay, Int. J. Quantum Chem. 111, 3273 (2011).
65K. Andersson, P.-˚A. Malmqvist, B. O. Roos, A. J. Sadlej, and

K. Wolinski, J. Phys. Chem. 94, 5483 (1990).

66S. R. White, Phys. Rev. Lett. 69, 2863 (1992).
67G. K.-L. Chan and M. Head-Gordon, J. Chem. Phys. 116, 4462

(2002).

68S. Wouters and D. Van Neck, Eur. Phys. J. D 68, 1 (2014).
69R. Olivares-Amaya, W. Hu, N. Nakatani, S. Sharma, J. Yang,

and G. K.-L. Chan, J. Chem. Phys. 142, 034102 (2015).

70Y. Kurashige and T. Yanai, J. Chem. Phys. 135, 094104 (2011).
71C. Li and F. A. Evangelista, J. Chem. Theory Comput. 11, 2097

(2015).

72W. Kutzelnigg and D. Mukherjee, J. Chem. Phys. 107, 432

(1997).

73J. A. Pople, J. S. Binkley, and R. Seeger, Int. J. Quantum

Chem. 10, 1 (1976).

95R. A. Kendall and H. A. Fr¨uchtl, Theor. Chem. Acc. 97, 158

(1997).

96F. Weigend, A. K¨ohn, and C. H¨attig, J. Chem. Phys. 116, 3175

(2002).

97G. H. Golub and C. F. Van Loan, Matrix Computations (Johns

Hopkins University Press, 2012).

98D. E. Bernholdt and R. J. Harrison, Chem. Phys. Lett. 250, 477

(1996).

99Forte, a suite of quantum chemistry methods for strongly cor-
related electrons. For the current version, see https://github.
com/evangelistalab/forte (2015).

100J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohen-
stein, F. A. Evangelista, J. T. Fermann, B. J. Mintz, L. A.
Burns, J. J. Wilke, M. L. Abrams, N. J. Russ, M. L. Leininger,
C. L. Janssen, E. T. Seidl, W. D. Allen, H. F. Schaefer, R. A.
King, E. F. Valeev, C. D. Sherrill, and T. D. Crawford, WIREs
Comput. Mol. Sci. 2, 556 (2012).

101Ambit is a C++ library for the implementation of tensor prod-
uct calculations through a clean, concise user interface, written
by Turney, J. M.; Parrish, R. M.; Evangelista, F. A.; Smith, D.
G. For the current version, see https://github.com/jturney/
ambit (2015).

102X. Li and J. Paldus, Can. J. Chem. 87, 917 (2009).
103A. D. Becke, J. Chem. Phys. 98, 5648 (1993).
104C. Lee, W. Yang, and R. G. Parr, Phys. Rev. B 37, 785 (1988).
105T. H. Dunning, J. Chem. Phys. 90, 1007 (1989).
106M. Valiev, E. J. Bylaska, N. Govind, K. Kowalski, T. P.
Straatsma, H. J. J. Van Dam, D. Wang, J. Nieplocha, E. Apra,
T. L. Windus, and W. A. de Jong, Comput. Phys. Commun.

12

181, 1477 (2010).

107F. A. Cotton, Chemical Applications of Group Theory (John

Wiley & Sons, 2008).

117C. J. Cramer, J. Am. Chem. Soc. 120, 6261 (1998).
118T. D. Crawford, E. Kraka, J. F. Stanton, and D. Cremer, J.

Chem. Phys. 114, 10638 (2001).

108D. E. Woon and T. H. Dunning, J. Chem. Phys. 100, 2975

119F. A. Evangelista, W. D. Allen, and H. F. Schaefer III, J. Chem.

(1994).

109F. Weigend, Phys. Chem. Chem. Phys. 4, 4285 (2002).
110C. H¨attig, Phys. Chem. Chem. Phys. 7, 59 (2005).
111H. H. Wenk, M. Winkler, and W. Sander, Angew. Chem. Int.

Ed. 42, 502 (2003).

112R. Sanz, Org. Prep. Proc. Int. 40, 215 (2008).
113M. Abe, J. Ye, and M. Mishima, Chem. Soc. Rev. 41, 3808

(2012).

Phys. 127, 024102 (2007).

120E. B. Wang, C. A. Parish, and H. Lischka, J. Chem. Phys. 129,

044306 (2008).

121J. Brabec, S. Krishnamoorthy, H. J. van Dam, K. Kowalski,

and J. Pittner, Chem. Phys. Lett. 514, 347 (2011).

122J. Brabec, K. Bhaskaran-Nair, K. Kowalski, J. Pittner, and

H. J. van Dam, Chem. Phys. Lett. 542, 128 (2012).

123I. Hubaˇc, J. Pittner, and P. ˇC´arsky, J. Chem. Phys. 112, 8779

114R. Hoﬀmann, A. Imamura, and W. J. Hehre, J. Am. Chem.

(2000).

Soc. 90, 1499 (1968).

115R. R. Squires and C. J. Cramer, J. Phys. Chem. A 102, 9072

(1998).

124J. Alml¨of, Chem. Phys. Lett. 181, 319 (1991).
125M. H¨aser and J. Alml¨of, J. Chem. Phys. 96, 489 (1992).
126D. S. Lambrecht, B. Doser, and C. Ochsenfeld, J. Chem. Phys.

116P. G. Wenthold, R. R. Squires, and W. Lineberger, J. Am.

123, 184102 (2005).

Chem. Soc. 120, 5279 (1998).

