6
1
0
2

 
r
a

M
7

 

 
 
]

.

A
F
h
t
a
m

[
 
 

1
v
3
2
3
2
0

.

3
0
6
1
:
v
i
X
r
a

Finiteness Principles for Smooth Selection

Charles Feﬀerman, Arie Israel, Garving K. Luli ∗

March 9, 2016

Introduction

In this paper and [18], we extend a basic ﬁniteness principle [6,10], used in [15,16]
to ﬁt smooth functions F to data. Our results raise the hope that one can start to
understand constrained interpolation problems in which e.g. the interpolating
function F is required to be nonnegative.

Let us set up notation. We ﬁx positive integers m, n, D. We will work
with the function spaces Cm(Rn, RD) and Cm−1,1(Rn, RD) and their norms

all functions F : Rn

whose derivatives ∂βF (for all |β| ≤ m − 1) are bounded and Lipschitz on Rn.

kFkCm(Rn,RD) and kFkCm−1,1(Rn,RD). Here, Cm(cid:0)Rn, RD(cid:1) denotes the space of
→ RD whose derivatives ∂βF (for all |β| ≤ m) are continuous
and bounded on Rn, and Cm−1,1(cid:0)Rn, RD(cid:1) denotes the space of all F : Rn
→ RD
When D = 1, we write Cm (Rn) and Cm−1,1 (Rn) in place of Cm(cid:0)Rn, RD(cid:1) and
Cm−1,1(cid:0)Rn, RD(cid:1).

Expressions c (m, n), C (m, n), k (m, n), etc. denote constants depending
only on m, n; these expressions may denote diﬀerent constants in diﬀerent
occurrences. Similar conventions apply to constants denoted by C (m, n, D),
k (D), etc.

If X is any ﬁnite set, then # (X) denotes the number of elements in X.
We recall the basic ﬁniteness principle of [10].

Theorem 1 For large enough k# = k (m, n) and C# = C (m, n) the following
hold:

each S ⊂ E with # (S) ≤ k# there exists FS ∈ Cm (Rn) with norm

(A) Cm FLAVOR Let f : E → R with E ⊂ Rn ﬁnite. Suppose that for
(cid:13)(cid:13)FS(cid:13)(cid:13)Cm(Rn) ≤ 1, such that FS = f on S. Then there exists F ∈ Cm (Rn)

with norm kFkCm(Rn) ≤ C#, such that F = f on E.

∗The ﬁrst author is supported in part by NSF grant DMS-1265524, AFOSR grant FA9550-
12-1-0425, and Grant No 2014055 from the United States-Israel Binational Science Foundation
(BSF). The third author is supported in part by NSF grant DMS-1355968 and by a start-up
fund from UC Davis.

1

for each S ⊂ E with # (S) ≤ k#, there exists FS ∈ Cm−1,1 (Rn) with

(B) Cm−1,1 FLAVOR Let f : E → R with E ⊂ Rn arbitrary. Suppose that
norm (cid:13)(cid:13)FS(cid:13)(cid:13)Cm−1,1(Rn) ≤ 1, such that FS = f on S. Then there exists

F ∈ Cm−1,1 (Rn) with norm kFkCm−1,1(Rn) ≤ C#, such that F = f on E.

Theorem 1 and several related results were conjectured by Y. Brudnyi and
P. Shvartsman in [5] and [6] (see also [23–25]). The ﬁrst nontrivial case m = 2
with the sharp “ﬁniteness constant” k# = 3 · 2n−1 was proven by P. Shvartsman
[22,25]; see also [9,23]. The proof of Theorem 1 for general m, n appears in [10].
For general m, n, the optimal k# is unknown, but see [1, 30].

The proof [23, 25] of Theorem 1 for m = 2 was based on a generalization of
the following “ﬁniteness principle for Lipschitz selection” [24] for maps of metric
spaces.

Theorem 2 For large enough k# = k# (D) and C# = C# (D), the following
holds.
Let X be a metric space. For each x ∈ X, let K (x) ⊂ RD be an aﬃne subspace
in RD of dimension ≤ d. Suppose that for each S ⊂ X with # (S) ≤ k# there

for all x ∈ S.

F (x) ∈ K (x) for all x ∈ X.

exists a map FS : S→ RD with Lipschitz constant ≤ 1, such that FS (x) ∈ K (x)
Then there exists a map F : X→ RD with Lipschitz constant ≤ C#, such that

In fact, P. Shvartsman in [24] showed that one can take k# = 2d+1 in

Theorem 2 and that the constant k# = 2d+1 is sharp, see [26].

P. Shvartsman also showed that Theorem 2 remains valid when RD is re-

placed by a Hilbert space (see [27]) or a Banach space (see [29]).

It is conjectured in [6] that Theorem 2 should hold for any compact convex
subsets K(x) ⊂ RD. In [28], P. Shvartsman provided evidence for this conjecture:
He showed that the conjecture holds in the case when D = 2 and in the case
when X is a ﬁnite metric space and the constant C# is allowed to depend on
the cardinality of X.

In this paper we prove ﬁniteness principles for Cm(cid:0)Rn, RD(cid:1)-selection, and
for Cm−1,1(cid:0)Rn, RD(cid:1)-selection, in particular providing a proof for the conjecture

in [6] for the case X = Rn.

Theorem 3 For large enough k# = k (m, n, D) and C# = C (m, n, D), the
following hold.

(A) Cm FLAVOR Let E ⊂ Rn be ﬁnite. For each x ∈ E, let K (x) ⊂ RD be
convex. Suppose that for each S ⊂ E with # (S) ≤ k#, there exists FS ∈

all x ∈ S.

Cm(cid:0)Rn, RD(cid:1) with norm (cid:13)(cid:13)FS(cid:13)(cid:13)Cm(Rn,RD) ≤ 1, such that FS (x) ∈ K (x) for
Then there exists F ∈ Cm(cid:0)Rn, RD(cid:1) with norm kFkCm(Rn,RD) ≤ C#, such

that F (x) ∈ K (x) for all x ∈ E.

2

(B) Cm−1,1 FLAVOR Let E ⊂ Rn be arbitrary. For each x ∈ E, let K(x) ⊂
Rn be closed and convex. Suppose that for each S ⊂ E with # (S) ≤ k#,

such that FS (x) ∈ K (x) for all x ∈ S.

there exists FS ∈ Cm−1,1(cid:0)Rn, RD(cid:1) with norm (cid:13)(cid:13)FS(cid:13)(cid:13)Cm−1,1(Rn,RD) ≤ 1,
Then there exists F ∈ Cm−1,1(cid:0)Rn, RD(cid:1) with norm kFkCm−1,1(Rn,RD) ≤

C#, such that F (x) ∈ K (x) for all x ∈ E.

In a forthcoming paper [18], we will prove the following closely related result

on interpolation by nonnegative functions.

Theorem 4 For large enough k# = k (m, n) and C# = C (m, n) the following
hold.

for each S ⊂ E with # (S) ≤ k#, there exists FS ∈ Cm (Rn) with norm

(A) Cm FLAVOR Let f : E → [0,∞) with E ⊂ Rn ﬁnite. Suppose that

(cid:13)(cid:13)FS(cid:13)(cid:13)Cm(Rn) ≤ 1, such that FS = f on S and FS ≥ 0 on Rn.

Then there exists F ∈ Cm (Rn) with norm kFkCm(Rn) ≤ C#, such that
F = f on E and F ≥ 0 on Rn.

that for each S ⊂ E with # (S) ≤ k#, there exists FS ∈ Cm−1,1 (Rn) with

(B) Cm−1,1 FLAVOR Let f : E → [0,∞) with E ⊂ Rn arbitrary. Suppose

norm (cid:13)(cid:13)FS(cid:13)(cid:13)Cm−1,1(Rn) ≤ 1, such that FS = f on S and FS ≥ 0 on Rn.

Then there exists F ∈ Cm−1,1 (Rn) with norm kFkCm−1,1(Rn) ≤ C#, such
that F = f on E and F ≥ 0 on Rn.

One might ask how to decide whether there exist FS as in the above results.
For Theorem 1 this issue is addressed in [10]; for Theorems 3 and 4 we address
it in this paper and [18].

A weaker version of the case D = 1 of Theorem 3 appears in [10]. There,
In place of the conclu-
each K (x) is an interval [f (x) − ε (x) , f (x) + ε (x)].
sion F (x) ∈ K (x) in Theorem 3, [10] obtains the weaker conclusion F (x) ∈
[f (x) − Cε (x) , f (x) + Cε (x)] for a constant C determined by m, n.

Our interest in Theorems 3 and 4 arises in part from their possible connection
to the interpolation algorithms of Feﬀerman-Klartag [15, 16]. Given a function

f : E → R with E ⊂ Rn ﬁnite, the goal of [15, 16] is to compute a function

F ∈ Cm (Rn) such that F = f on E, with norm kFkCm(Rn) as small as possible up
to a factor C (m, n). Roughly speaking, the algorithm in [15, 16] computes such
an F using O (N log N) computer operations, where N = # (E). The algorithm
is based on ideas from the proof [10] of Theorem 1. Accordingly, Theorems 3
and 4 raise the hope that we can start to understand constrained interpolation
problems, in which e.g.
the interpolant F is constrained to be nonnegative
everywhere on Rn.

Theorems 3 and 4 follow from a more general result on Cm functions whose
Taylor polynomials belong to prescribed convex sets. More precisely, let Jx(F)
denote the (m − 1)rst degree Taylor polynomial of F at x; thus, Jx(F) belongs
to the vector space of P of all such polynomials. Let E ⊂ Rn be ﬁnite. For

3

each x ∈ E and M > 0, let Γ (x, M) be a convex subset of P. Under suitable
hypotheses on the Γ (x, M) we will prove the following:

Finiteness Principle Fix M0 > 0. Suppose that for each S ⊆ E with #(S) ≤
k#(m, n) there exists FS ∈ Cm(Rn) with ||FS||Cm(Rn) ≤ M0, such that Jx(FS) ∈
Γ (x, M0) for all x ∈ S.

Then there exists F ∈ Cm(Rn) with ||F||Cm(Rn) ≤ CM0, such that Jx(FS) ∈

Γ (x, CM0) for all x ∈ E.

Here, C depends only on m, n and the constants in our assumptions on the

Γ (x, M).

See Section III.1 below for our assumptions on the Γ (x, M). The precise
statement of the above ﬁniteness principle is given by Theorem 6 in Section III.1
and the remark after its proof. That result and the closely related Theorem 5
in Section II.10 form the real content of this paper.

A special case of Theorem 6 was proven in [11]. In that special case, the
sets Γ (x, M) have the form Γ (x, M) = fx + M · σ(x) with fx ∈ P and σ(x) a
symmetric convex subset of P. The σ(x) are required to be “Whitney convex”;
see [11].

Here, to prove Theorems 5 and 6, we adapt the arguments in [11] to more gen-
eral families of convex sets Γ (x, M). In particular, our hypothesis of “(Cw, δmax)-
convexity”, formulated in Section I.2 below, generalizes the notion of Whitney
convexity to the present context.

However, at one crucial point (Case 2 in the proof of Lemma 15 below) the

argument has no analogue in [11].

We refer the reader to the expository paper [14] for an explanation of the

main ideas in [11].

This paper is part of a literature on extension, interpolation, and selec-
tion of functions, going back to H. Whitney’s seminal work [32], and includ-
ing fundamental contributions by G. Glaeser [19], Y, Brudnyi and P. Shvarts-
man [4,6–9,22–30], J. Wells [31], E. Le Gruyer [20], and E. Bierstone, P. Milman,
and W. Paw lucki [1–3], as well as our own papers [10–17]. See e.g. [14] for the
history of the problem, as well as Zobin [33, 34] for a related problem.

We are grateful to the American Institute of Mathematics, the Banﬀ Inter-
national Research Station, the Fields Institute, and the College of William and
Mary for hosting workshops on interpolation and extension. We are grateful also
to the Air Force Oﬃce of Scientiﬁc Research, the National Science Foundation,
the Oﬃce of Naval Research, and the U.S.-Israel Binational Science Foundation
for ﬁnancial support.

We are also grateful to Pavel Shvartsman and Alex Brudnyi for their com-
ments on an earlier version of our manuscript, and to Bo’az Klartag and all the
participants of the Eighth Whitney Problems Workshop for their interest in our
work. Finally, we are grateful to the referee for careful, expert reading, and for
comments that improved our paper.

4

Part I
Shape Fields and Their
Reﬁnements

I.1 Notation and Preliminaries

Fix m, n ≥ 1. We will work with cubes in Rn; all our cubes have sides parallel
to the coordinate axes. If Q is a cube, then δQ denotes the sidelength of Q.
For real numbers A > 0, AQ denotes the cube whose center is that of Q, and
whose sidelength is AδQ.

A dyadic cube is a cube of the form I1 × I2 × · · · × In ⊂ Rn, where each Iν
has the form [2k · iν, 2k · (iν + 1)) for integers i1, · · · , in, k. Each dyadic cube
Q is contained in one and only one dyadic cube with sidelength 2δQ; that cube
is denoted by Q+.

We write P to denote the vector space of all real-valued polynomials of
degree at most (m − 1) on Rn. If x ∈ Rn and F is a real-valued Cm−1 function
on a neighborhood of x, then Jx (F) (the “jet” of F at x) denotes the (m − 1)rst
order Taylor polynomial of F at x. Thus, Jx (F) ∈ P.

For each x ∈ Rn, there is a natural multiplication ⊙x on P (“multiplication

of jets at x”) deﬁned by setting

P ⊙x Q = Jx (PQ) for P, Q ∈ P.

We write Cm (Rn) to denote the Banach space of real-valued Cm functions F
on Rn for which the norm

kFkCm(Rn) = sup
x∈Rn

max
|α|≤m

|∂αF (x)|

is ﬁnite. For D ≥ 1, we write Cm(cid:0)Rn, RD(cid:1) to denote the Banach space of all

RD-valued Cm functions F on Rn, for which the norm

kFkCm(Rn,RD) = sup
x∈Rn

max
|α|≤m

k∂αF (x)k

is ﬁnite. Here, we use the Euclidean norm on RD.

If F is a real-valued function on a cube Q, then we write F ∈ Cm (Q) to
denote that F and its derivatives up to m-th order extend continuously to the
closure of Q. For F ∈ Cm (Q), we deﬁne

kFkCm(Q) = sup
x∈Q

max
|α|≤m

|∂αF (x)| .

Similarly,

if F is an RD-valued function on a cube Q, then we write F ∈

Cm(cid:0)Q, RD(cid:1) to denote that F and its derivatives up to m-th order extend con-

5

tinuously to the closure of Q. For F ∈ Cm(cid:0)Q, RD(cid:1), we deﬁne

kFkCm(Q,RD) = sup
x∈Q

max
|α|≤m

k∂αF (x)k ,

where again we use the Euclidean norm on RD.

If F ∈ Cm (Q) and x belongs to the boundary of Q, then we still write Jx (F)
to denote the (m − 1)rst degree Taylor polynomial of F at x, even though F isn’t
deﬁned on a full neighborhood of x ∈ Rn.

Let S ⊂ Rn be non-empty and ﬁnite. A Whitney ﬁeld on S is a family of

polynomials

~P = (Py)y∈S (each Py ∈ P),

parametrized by the points of S.

We write Wh (S) to denote the vector space of all Whitney ﬁelds on S.
For ~P = (Py)y∈S ∈ Wh (S), we deﬁne the seminorm

=

max

x,y∈S,(x6=y),|α|≤m

|∂α (Px − Py) (x)|

|x − y|m−|α|

.

(cid:13)(cid:13)(cid:13)
~P(cid:13)(cid:13)(cid:13) ˙Cm(S)

(If S consists of a single point, then (cid:13)(cid:13)(cid:13)

|α| = α1 + · · · + αn ≤ m − 1.

~P(cid:13)(cid:13)(cid:13) ˙Cm(S)

= 0.)

We write M to denote the set of all multiindices α = (α1, · · · , αn) of order

We deﬁne a (total) order relation < on M, as follows. Let α = (α1, · · · , αn)
and β = (β1, · · · , βn) be distinct elements of M. Pick the largest k for which
α1 + · · · + αk 6= β1 + · · · + βk. (There must be at least one such k, since α and
β are distinct). Then we say that α < β if α1 + · · · + αk < β1 + · · · + βk.

We also deﬁne a (total) order relation < on subsets of M, as follows. Let
A, B be distinct subsets of M, and let γ be the least element of the symmetric
diﬀerence (A \ B)∪(B \ A) (under the above order on the elements of M). Then
we say that A < B if γ ∈ A.

One checks easily that the above relations < are indeed total order relations.
Note that M is minimal, and the empty set ∅ is maximal under <. A set A ⊆ M
is called monotonic if, for all α ∈ A and γ ∈ M, α + γ ∈ M implies α + γ ∈ A.
We make repeated use of a simple observation:

Suppose A ⊆ M is monotonic, P ∈ P and x0 ∈ Rn. If ∂αP (x0) = 0 for all

α ∈ A, then ∂αP ≡ 0 on Rn for α ∈ A.

This follows by writing ∂αP (y) = P|γ|≤m−1−|α|

and noting that all the relevant α + γ belong to A, hence ∂α+γP (x0) = 0.

We need a few elementary facts about convex sets. We recall

1

γ! ∂α+γP (x0) · (y − x0)γ

Helly’s Theorem Let K1, · · · , KN ⊂ RD be convex. Suppose that Ki1 ∩ · · · ∩
KiD+1 is nonempty for any i1, · · · , iD+1 ∈ {1, · · · , N}. Then K1 ∩ · · · ∩ KN is
nonempty.

6

See [21].
We also use the following

Trivial Remark on Convex Sets Let Γ be a convex set, and let P0, P0 + Pν,
P0 − Pν ∈ Γ for ν = 1, · · · , νmax. Then for any real numbers t1, · · · , tνmax
with

we have

|tν| ≤ 1,

νmaxXν=1

P0 +

νmaxXν=1

tνPν ∈ Γ .

If λ = (λ1, · · · , λn) is an n-tuple of positive real numbers, and if β =

(β1, · · · , βn) ∈ Zn, then we write λβ to denote

λβ1
1 · · · λβn
n .

We write Bn (x, r) to denote the open ball in Rn with center x and radius r,
with respect to the Euclidean metric.

I.2 Shape Fields

(possibly empty) convex set. We say that ~Γ = (Γ (x, M))x∈E,M>0 is a shape ﬁeld

Let E ⊂ Rn be ﬁnite. For each x ∈ E, M ∈ (0,∞), let Γ (x, M) ⊆ P be a
if for all x ∈ E and 0 < M′ ≤ M <∞, we have

Γ (x, M′) ⊆ Γ (x, M) .

Let ~Γ = (Γ (x, M))x∈E,M>0 be a shape ﬁeld and let Cw, δmax be positive real
numbers. We say that ~Γ is (Cw, δmax)-convex if the following condition holds:

Let 0 < δ ≤ δmax, x ∈ E, M ∈ (0,∞), P1, P2, Q1, Q2 ∈ P. Assume that

(1) P1, P2 ∈ Γ (x, M);

(2) |∂β(P1 − P2)(x)| ≤ Mδm−|β| for |β| ≤ m − 1;

(3) |∂βQi(x)| ≤ δ−|β| for |β| ≤ m − 1 for i = 1, 2;

(4) Q1 ⊙x Q1 + Q2 ⊙x Q2 = 1.

Then

(5) P := Q1 ⊙x Q1 ⊙x P1 + Q2 ⊙x Q2 ⊙x P2 ∈ Γ (x, CwM).

The following lemma follows easily from the deﬁnition of (Cw, δmax)-convexity.

7

Lemma 1 Suppose ~Γ = (Γ (x, M))x∈E,M>0 is a (Cw, δmax)-convex shape ﬁeld.
Let

(6) 0 < δ ≤ δmax, x ∈ E, M > 0, P1, P2, Q1, Q2 ∈ P and A′, A′′ > 0.

Assume that

(7) P1, P2 ∈ Γ (x, A′M);

(8) (cid:12)(cid:12)∂β (P1 − P2) (x)(cid:12)(cid:12) ≤ A′Mδm−|β| for |β| ≤ m − 1;
(9) (cid:12)(cid:12)∂βQi (x)(cid:12)(cid:12) ≤ A′′δ−|β| for |β| ≤ m − 1 and i = 1, 2;

(10) Q1 ⊙x Q1 + Q2 ⊙x Q2 = 1.

Then

(11) P := Q1 ⊙x Q1 ⊙x P1 + Q2 ⊙x Q2 ⊙x P2 ∈ Γ (x, CM) with C determined

by A′, A′′, Cw, m, and n.

By Lemma 1 and an induction argument, we also have the following result.
Lemma 2 Suppose ~Γ = (Γ (x, M))x∈E,M>0 is a (Cw, δmax)-convex shape ﬁeld.
Let

(12) 0 < δ ≤ δmax, x ∈ E, M > 0, A′, A′′ > 0, P1, · · · Pk, Q1, · · · , Qk ∈ P.

Assume that

(13) Pi ∈ Γ (x, A′M) for i = 1, · · · , k;

i=1 Qi ⊙x Qi = 1.

Then

n, k.

that for all y ∈ E there exists P ∈ Γ (y, M) for which

i=1 Qi ⊙x Qi ⊙x Pi ∈ Γ (x, CM) , with C determined by A′, A′′, Cw, m,

(14) (cid:12)(cid:12)∂β (Pi − Pj) (x)(cid:12)(cid:12) ≤ A′Mδm−|β| for |β| ≤ m − 1, i, j = 1, · · · , k;
(15) (cid:12)(cid:12)∂βQi (x)(cid:12)(cid:12) ≤ A′′δ−|β| for |β| ≤ m − 1 and i = 1, · · · , k;
(16) Pk
(17) Pk
to be ~Γ # =(cid:0)Γ # (x, M)(cid:1)x∈E,M>0, where Γ # (x, M) consists of those P# ∈ P such
(18) (cid:12)(cid:12)∂β(cid:0)P# − P(cid:1) (x)(cid:12)(cid:12) ≤ M |x − y|m−|β| for |β| ≤ m − 1.

Note that each Γ # (x, M) is a (possibly empty) convex subset of P, and
that M′ ≤ M implies Γ # (x, M′) ⊆ Γ # (x, M). Thus, ~Γ # is again a shape ﬁeld.
Taking y = x in (18), we see that Γ #(x, M) ⊂ Γ (x, M).

Next, we deﬁne the ﬁrst reﬁnement of a shape ﬁeld ~Γ = (Γ (x, M))x∈E,M>0

8

Lemma 3 Let ~Γ = (Γ (x, M))x∈E,M>0 be a (Cw, δmax)-convex shape ﬁeld, and

let ~Γ # =(cid:0)Γ # (x, M)(cid:1)x∈E,M>0 be the ﬁrst reﬁnement of ~Γ #. Then ~Γ # is (C, δmax)-

convex, where C is determined by Cw, m, n.

Proof. We write c, C, C′, etc., to denote constants determined by Cw, m,
n. These symbols may denote diﬀerent constants in diﬀerent occurrences. Let
0 < δ ≤ δmax, M > 0, x ∈ E, P#

2 ∈ P, and assume that

2 , Q#

1 , Q#

1 , P#

(19) P#

i ∈ Γ #(x, M) for i = 1, 2;

≤ Mδm−|β| for |β| ≤ m − 1;

≤ δ−|β| for |β| ≤ m − 1, i = 1, 2; and

2(cid:17) (x)(cid:12)(cid:12)(cid:12)

1 − P#

(20) (cid:12)(cid:12)(cid:12)
(21) (cid:12)(cid:12)(cid:12)

∂β(cid:16)P#
i (x)(cid:12)(cid:12)(cid:12)

1 ⊙x Q#

∂βQ#

(22) Q#

1 + Q#

2 ⊙x Q#

2 = 1.

Under the above assumptions, we must show that

(23)

P# := Q#

1 ⊙x Q#

1 ⊙x P#

1 + Q#

2 ⊙x Q#

2 ⊙x P#

2 ∈ Γ # (x, CM) .

By deﬁnition of Γ # (·, ·), this means that given any y ∈ E there exists

(24) P ∈ Γ (y, CM) such that

(25) |∂β(P# − P)(x)| ≤ CM|x − y|m−|β| for |β| ≤ m − 1, where

Thus, to prove Lemma 3, we must prove that there exists P satisfying (24),
(25), under the assumptions (19)· · · (22). To do so, we start by deﬁning the
functions

(26) θi =

Q#
i
+(Q#

2 )2i1/2 on Bn(x, c0δ) (i = 1, 2).

h(Q#

1 )2

We pick c0 < 1 small enough so that (21), (22) guarantee that θi is well-

deﬁned on Bn(x, c0δ) and satisﬁes

(27) |∂βθi| ≤ Cδ−|β| on Bn (x, c0δ) for |β| ≤ m, i = 1, 2,

and

(28) θ2

1 + θ2

2 = 1 on Bn(x, c0δ).

Also

(29) Jx(θi) = Q#
i

for i = 1, 2,

thanks to (22).
We now divide the discussion of (24), (25) into two cases.
CASE 1: Suppose y ∈ Bn(x, c0δ).
By (19) and the deﬁnition of Γ #(·, ·), there exist

9

(30) Pi ∈ Γ (y, M) (i = 1, 2)

satisfying

(31) |∂β(P#

i − Pi)(x)| ≤ M|x − y|m−|β| for |β| ≤ m − 1, i = 1, 2.

Since we are in CASE 1, estimates (20) and (31) together imply that

(32) |∂β(P1 − P2)(x)| ≤ CMδm−|β| for |β| ≤ m − 1.

Consequently,

(33) |∂β(P1 − P2)| ≤ CMδm−|β| on Bn(x, c0δ) for |β| ≤ m.

(Recall that P1, P2 are polynomials of degree at most m − 1.)
Thanks to (27), (28), (30), (33), and the (Cw, δmax)-convexity of ~Γ , we may
apply Lemma 1 to the polynomials P1, P2, Q1, Q2, where Qi = Jy (θi) for
i = 1, 2. This tells us that

(34) P := Jy(cid:16)θ2

1P1 + θ2

2P2(cid:17) ∈ Γ (y, CM).

That is, the P in (34) satisﬁes (24). We will show that it also satisﬁes (25).
Thanks to (23), (29), we have

(35) P# = Jx(θ2

1P#

1 + θ2

2P#

2 ).

In view of (34), (35), our desired estimate (25) is equivalent to the following:

∂β(cid:16)θ2

(36) (cid:12)(cid:12)(cid:12)

for |β| ≤ m − 1.

1P#

1 + θ2

2P#

2 − Jy(cid:16)θ2

1P1 + θ2

2P2(cid:17)(cid:17) (x)(cid:12)(cid:12)(cid:12)

≤ CM |x − y|m−|β|

Thus, we have reduced the existence of P satisfying (24), (25) in CASE 1 to

the task of proving (36).

Since θ2

1 +θ2

2 = 1 (see (28)) and JyP1 = P1, the following holds on Bn(x, c0δ):

Consequently, the desired estimate (36) will follow if we can show that

1P#

(cid:16)θ2
1(cid:16)P#

= θ2

2P#

1 + θ2

2 − Jy(cid:16)θ2
1 − P1(cid:17) + θ2
2(cid:16)P#
i − Pi(cid:17) (x)i(cid:12)(cid:12)(cid:12)
i (cid:16)P#

∂βhθ2

(cid:12)(cid:12)(cid:12)
2 (P1 − P2) − Jy(cid:16)θ2

(37)

and
(38)

(cid:12)(cid:12)(cid:12)
∂βhθ2

2 (P1 − P2)(cid:17)i (x)(cid:12)(cid:12)(cid:12)

10

1P1 + θ2

2P2(cid:17)(cid:17)
2 − P2(cid:17) +hθ2

2 (P2 − P1) − Jy(cid:16)θ2

2 (P2 − P1)(cid:17)i .

≤ CM |x − y|m−|β| for |β| ≤ m − 1, i = 1,2,

≤ CM |x − y|m−|β| for |β| ≤ m − 1.

Moreover, (37) follows at once from (27) and (31), since δ−|β| ≤ C |x − y|−|β|

in CASE 1.

To check (38), we apply (27) and (33) to deduce that

(cid:12)(cid:12)(cid:12)

∂βhθ2

2 (P1 − P2)i(cid:12)(cid:12)(cid:12)

≤ CM

on B (x, c0δ) for |β| = m.

Therefore, (38) follows from Taylor’s theorem.
This proves the existence of a P satisfying (24), (25) in CASE 1.
CASE 2: Suppose that y 6∈ Bn(x, c0δ).
Since P#

1 ∈ Γ (x, M) (see (19)), there exists

(39) P1 ∈ Γ (y, M)

such that

(40) (cid:12)(cid:12)(cid:12)

∂β(cid:16)P#

1 − P1(cid:17) (x)(cid:12)(cid:12)(cid:12)

≤ M |x − y|m−|β| for |β| ≤ m − 1.

Thanks to (22), we may rewrite P# in the form

P# = P#

1 + Q#

2 ⊙x Q#

2 ⊙x(cid:16)P#

2 − P#

1(cid:17) .

Our assumptions (20), (21) therefore yield the estimates

≤ CMδm−|β|

for |β| ≤ m − 1.

Since we are in CASE 2, it follows that

1(cid:17) (x)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)
∂β(cid:16)P# − P#
1(cid:17) (x)(cid:12)(cid:12)(cid:12)

≤ CM |x − y|m−|β| for |β| ≤ m − 1.

From (40) and (41), we learn that

∂β(cid:16)P# − P#

(41) (cid:12)(cid:12)(cid:12)
(42) (cid:12)(cid:12)∂β(cid:0)P# − P1(cid:1) (x)(cid:12)(cid:12) ≤ CM |x − y|m−β for |β| ≤ m − 1.

We now know from (39) and (42) that P := P1 satisﬁes (24) and (25). Thus,
in CASE 2 we again have a polynomial P satisfying (24) and (25). We have seen
in all cases that there exists P ∈ P satisfying (24), (25).

The proof of Lemma 3 is complete.
Next we deﬁne the higher reﬁnements of a given shape ﬁeld ~Γ0 = (Γ0(x, M))x∈E,M>0.

By induction on l ≥ 0, we deﬁne ~Γl = (Γl(x, M))x∈E,M>0; to do so, we start
with our given ~Γ0, and deﬁne ~Γl+1 to be the ﬁrst reﬁnement of ~Γl, for each l ≥ 0.
Thus, each ~Γl is a shape ﬁeld.

By the deﬁnition of the ﬁrst reﬁnement and Lemma 3, we have the following

result.

11

Lemma 4 (A) Let x, y ∈ E, l ≥ 1, M > 0, and P ∈ Γl(x, M). Then there

exists P′ ∈ Γl−1(y, M) such that

(cid:12)(cid:12)∂β (P − P′) (x)(cid:12)(cid:12) ≤ M |x − y|m−|β| for |β| ≤ m − 1.

(B) If ~Γ0 is (Cw, δmax)-convex, then for each l ≥ 0, ~Γl is (Cl, δmax)-convex,

where Cl is determined by Cw, l, m, n.

We call ~Γl the l-th reﬁnement of ~Γ0. (This is consistent with our previous

deﬁnition of the ﬁrst reﬁnement.)

I.3 Polynomial Bases

Let ~Γ = (Γ (x, M))x∈E,M>0 be a shape ﬁeld. Let x0 ∈ E, M0 > 0, P0 ∈ P,
A ⊆ M, Pα ∈ P for α ∈ A, CB > 0, δ > 0 be given. Then we say that

(Pα)α∈A is an (A, δ, CB)-basis for ~Γ at (cid:0)x0, M0, P0(cid:1) if the following conditions

are satisﬁed:

(1) P0 ∈ Γ (x0, CBM0).

(2) P0 + M0δm−|α|

CB

Pα, P0 − M0δm−|α|

CB

Pα ∈ Γ (x0, CBM0) for all α ∈ A.

(3) ∂βPα (x0) = δαβ (Kronecker delta) for β, α ∈ A.

(4) (cid:12)(cid:12)∂βPα (x0)(cid:12)(cid:12) ≤ CBδ|α|−|β| for all α ∈ A, β ∈ M.

We say that (Pα)α∈A is a weak (A, δ, CB)-basis for ~Γ at (x0, M0, P0) if con-
ditions (1), (2), (3) hold as stated, and condition (4) holds for α ∈ A, β ∈
M, β ≥ α.

We make a few obvious remarks.

(5) Any (A, δ, CB)-basis for ~Γ at (x0, M0, P0) is also an (A, δ, C′

B)-basis for ~Γ

at (x0, M0, P0), whenever C′

B ≥ CB.

(6) Any (A, δ, CB)-basis for ~Γ at (x0, M0, P0) is also an (A, δ′, CB·[max{ δ′

δ , δ

δ′ }]m)-

basis for ~Γ at (x0, M0, P0), for any δ′ > 0.

(7) Any weak (A, δ, CB)-basis for ~Γ at (x0, M0, P0) is also a weak (A, δ′, C′

B)-

basis for ~Γ at (x0, M0, P0), whenever 0 < δ′ ≤ δ and C′

B ≥ CB.

Note that (1) need not follow from (2), since A may be empty.

(8) If A = ∅, then the existence of an (A, δ, CB)-basis (or a weak (A, δ, CB)-

basis) for ~Γ at (x0, M0, P0) is equivalent to the assertion that P0 ∈ Γ (x0, CBM0).

12

The main result of this section is Lemma 7 below. The proof of Lemma 7

relies on two other lemmas.

As a consequence of Lemma 1, we have the following result.

Lemma 5 Let ~Γ = (Γ (x, M))x∈E,M>0be a (Cw, δmax)-convex shape ﬁeld. Fix
x0 ∈ E, M0 > 0, 0 < δ ≤ δmax, C1 > 0, and let P0, ^P, ^S ∈ P.

Assume that

(9) P0 + 1
C1

^P, P0 − 1
C1

^P ∈ Γ (x0, C1M0);

(10) (cid:12)(cid:12)∂β ^P (x0)(cid:12)(cid:12) ≤ C1M0δm−|β| for |β| ≤ m − 1; and
(11) (cid:12)(cid:12)∂β ^S (x0)(cid:12)(cid:12) ≤ C1δ−|β| for |β| ≤ m − 1.

Then

(12) P0 + 1
C2

^S ⊙x0
C1, Cw, m, n.

^P, P0 − 1
C2

^S ⊙x0

^P ∈ Γ (x0, C2M0), with C2 determined by

We also need the following result, which is immediate1 from Lemma 16.1

in [10].

Lemma 6 (Rescaling Lemma) Let A ⊆ M, and let C, a be positive real
numbers. Suppose we are given real numbers Fα,β, indexed by α ∈ A, β ∈ M.
Assume that the following conditions are satisﬁed.

(13) Fα,α 6= 0 for all α ∈ A.

(14) |Fα,β| ≤ C · |Fα,α| for all α ∈ A, β ∈ M with β ≥ α.

(15) Fα,β = 0 for all α, β ∈ A with α 6= β.

the following properties:

Then there exist positive numbers λ1, · · · , λn and a map φ : A→ M, with

(16) c(a) ≤ λi ≤ 1 for each i, where c(a) is determined by C, a, m, n;

(17) φ(α) ≤ α for each α ∈ A;

(18) For each α ∈ A, either φ(α) = α or φ(α) 6∈ A.

Suppose we deﬁne ^Fα,β = λβFα,β for α ∈ A, β ∈ M, where we recall that

λβ denotes λβ1

1 · · · λβn

n for β = (β1, · · · , βn). Then

(19) |^Fα,β| ≤ a · |^Fα,φ(α)| for α ∈ A, β ∈ M \ {φ(α)}.

1Lemma 16.1 in [10] involves also real numbers Fα,β with |β| = m. Setting those Fα,β = 0,

we recover the Rescaling Lemma stated here.

13

satisﬁes also

Lemma 3.3 in [10] tells us that any map φ : A → M satisfying (17), (18)

(20) φ(A) ≤ A, with equality only if φ is the identity map.

We are ready to state the main result of this section.

Lemma 7 (Relabeling Lemma) Let ~Γ = (Γ (x, M))x∈E,M>0 be a (Cw, δmax)-
convex shape ﬁeld. Let x0 ∈ E, M0 > 0, 0 < δ ≤ δmax, CB > 0, P0 ∈

Γ (x0, M0), A ⊆ M. Suppose (cid:0)P00
(cid:0)x0, M0, P0(cid:1). Then, for some monotonic ^A ≤ A, ~Γ has an ( ^A, δ, C′

B)-basis at
B determined by CB, Cw, m, n. Moreover, if A 6= ∅ and
α (x0)| exceeds a large enough constant determined by

(x0, M0, P0), with C′
maxα∈A,β∈M δ|β|−|α||∂βP00
CB, Cw, m, n, then we can take ^A < A (strict inequality).

α (cid:1)α∈A is a weak (A, δ, CB)-basis for ~Γ at

Proof. If A is empty, then we can take ^A empty. Thus, Lemma 7 holds trivially
for A = ∅. We suppose that A 6= ∅.

Without loss of generality, we may take x0 = 0. We introduce a constant

a > 0 to be picked later, satisfying the

Small a condition: a is less than a small enough constant determined by CB,

Cw, m, n.

We write c, C, C′, etc., to denote constants determined by CB, Cw, m,
n; and we write c(a), C(a), C′(a), etc., to denote constants determined by
a, CB, Cw, m, n. These symbols may denote diﬀerent constants in diﬀerent
occurrences.

Since (P00

α )α∈A is a weak (A, δ, CB)-basis for ~Γ at (0, M0, P0), we have the

following.

(21) P0, P0 ± cM0δm−|α|P00

α ∈ Γ (0, CM0) for α ∈ A.

(22) ∂βP00

α (0) = δβα for β, α ∈ A.

Thanks to (22), (23), the numbers Fα,β = δ|β|−|α|∂βP00

α (0) satisfy (13),
(14), (15). Applying Lemma 6, we obtain real numbers λ1, · · · , λn and a map

α (0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ A, β ∈ M, β ≥ α.

(23) (cid:12)(cid:12)∂βP00
φ : A→ M satisfying (16), · · · , (19). We deﬁne a linear map T : Rn

→ Rn by

(24) T (x1, · · · , xn) = (λ1x1, · · · , λnxn) for (x1, · · · , xn) ∈ Rn.

setting

From (16) · · · (19) for our Fα,β, we obtain the following.

(25) c (a) ≤ λi ≤ 1 for i = 1, · · · , n.

(26) φ (α) ≤ α for all α ∈ A.

(27) For each α ∈ A, either φ (α) = α or φ (α) 6∈ A.

14

(28) δ|β|−|α|(cid:12)(cid:12)∂β(cid:0)P00

A, β ∈ M\φ (α).

α ◦ T(cid:1) (0)(cid:12)(cid:12) ≤ a · δ|φ(α)|−|α|(cid:12)(cid:12)∂φ(α)(cid:0)P00

α ◦ T(cid:1) (0)(cid:12)(cid:12) for all α ∈

Since the left-hand side of (28) is equal to λβ ≥ c(a) for β = α (by (22) and

(25)), it follows from (28) that

(29) δ|φ(α)|−|α|(cid:12)(cid:12)∂φ(α)(cid:0)P00

We deﬁne

α ◦ T(cid:1) (0)(cid:12)(cid:12) ≥ c (a) for α ∈ A.

(30) ¯A = φ(A)

and introduce a map

(31) ψ : ¯A→ A

such that

(32) φ(ψ(¯α)) = ¯α for all ¯α ∈ ¯A.

Thanks to (26), (27), and Lemma 3.3 in [10] (mentioned above), we have

¯A ≤ A,

with equality only when φ =identity. Moreover, suppose φ = identity. Then
(22) and (28) show that

λβδ|β|−|α|∂βP00

(cid:12)(cid:12)(cid:12)

α (0)(cid:12)(cid:12)(cid:12)

= δ|β|−|α|(cid:12)(cid:12)∂β(cid:0)P00
≤ (cid:12)(cid:12)∂α(cid:0)P00
α ◦ T(cid:1) (0)(cid:12)(cid:12)

= λα

α ◦ T(cid:1) (0)(cid:12)(cid:12)

for α ∈ A and β ∈ M. Hence, (25) yields

this holds provided φ =identity.

cannot be the identity map, and therefore ¯A < A (strict inequality).

α (0)(cid:12)(cid:12) ≤ C (a) for all α ∈ A and β ∈ M;

(33) δ|β|−|α|(cid:12)(cid:12)∂βP00
If maxα∈A,β∈M δ|β|−|α|(cid:12)(cid:12)∂βP00
(34) ¯A ≤ A, with strict inequality if maxα∈A,β∈M δ|β|−|α|(cid:12)(cid:12)∂βP00

α (0)(cid:12)(cid:12) > C(a) with C (a) as in (33), then φ
α (0)(cid:12)(cid:12) exceeds

a large enough constant determined by a, Cw, CB, m, n.

Thus,

For ¯α ∈ ¯A, we deﬁne

(35) b ¯α =hδ| ¯α|−|ψ( ¯α)|∂ ¯α(cid:16)P00

ψ( ¯α) ◦ T(cid:17) (0)i−1

estimate (29) with α = ψ (¯α) gives

;

15

(36) |b ¯α| ≤ C (a) for all ¯α ∈ ¯A.

For ¯α ∈ ¯A, we also deﬁne

(37) ¯P ¯α = b ¯αδ| ¯α|−|ψ( ¯α)| · P00

ψ( ¯α).

From (28), (35), (37), we ﬁnd that

(38) (cid:12)(cid:12)(cid:12)

δ|β|−| ¯α|∂β(cid:0)¯P ¯α ◦ T(cid:1) (0) − δβ ¯α(cid:12)(cid:12)(cid:12)

Note that δm−| ¯α| ¯P ¯α = b ¯αδm−|ψ( ¯α)|P00

≤ a for ¯α ∈ ¯A, β ∈ M.

ψ( ¯α). Hence, (36) and (21) (with α =

ψ (¯α)) tell us that

(39) P0 ± c (a) M0δm−| ¯α| ¯P ¯α ∈ Γ (0, CM0),

since Γ (0, CM0) is convex.
Next, deﬁne

(40) ^A =(cid:8)γ ∈ M : γ = ¯α + ¯γ for some ¯α ∈ ¯A, ¯γ ∈ M(cid:9),
¯A, ω : ^A→ M, such that
and introduce maps χ : ^A→

(41) ^α = χ (^α) + ω (^α) for all ^α ∈ ^A.

By deﬁnition (40),

(42) ^A is monotonic,

and ¯A ⊆ ^A, hence

(43) ^A ≤ ¯A.

From (34) and (43), we have

(44) ^A ≤ A, with strict inequality if maxα∈A,β∈M δ|β|−|α|(cid:12)(cid:12)∂βP00

a large enough constant determined by a, Cw, CB, m, n.

α (0)(cid:12)(cid:12) exceeds

For ^α ∈ ^A, we introduce the monomial

(45) S ^α (x) = χ( ^α)!

^α! λ−ω(^α)xω( ^α) (x ∈ Rn).

We have

(46) S ^α ◦ T (x) = χ( ^α)!

^α! xω( ^α),

hence

(47) ∂β (S ^α ◦ T ) (0) = χ( ^α)!ω( ^α)!

^α!

δβω(^α) for ^α ∈ ^A, β ∈ M.

16

gives

Case 1: If β is not of the form β = ω(^α) + ˜β for some ˜β ∈ M, then (47)

We study the derivatives ∂β(cid:0)(cid:2)(cid:0)S ^α ¯Pχ( ^α)(cid:1) ◦ T(cid:3) (0)(cid:1) for ^α ∈ ^A, β ∈ M.
(48) ∂β(cid:2)(cid:0)S ^α ¯Pχ( ^α)(cid:1) ◦ T(cid:3) (0) = 0.

Case 2: Suppose β = ω(^α) + ˜β for some ˜β ∈ M. Then (47) gives

=

=

=

β!

∂β(cid:2)(cid:0)S ^α ¯Pχ( ^α)(cid:1) ◦ T(cid:3) (0)
ω (^α) !˜β!h∂ω(^α) (S ^α ◦ T ) (0)i ·h∂

β!

χ (^α) !ω (^α) !

ω (^α) !˜β!
β!χ (^α) !

^α!˜β!

h∂

^α!

·h∂
˜β(cid:0)¯Pχ( ^α) ◦ T(cid:1) (0)i .

˜β(cid:0)¯Pχ( ^α) ◦ T(cid:1) (0)i

˜β(cid:0)¯Pχ( ^α) ◦ T(cid:1) (0)i

Hence, by (38), we have

(49)

^α!˜β!

β!χ (^α) !

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

δ| ˜β|−|χ( ^α)|∂β(cid:2)(cid:0)S ^α · ¯Pχ( ^α)(cid:1) ◦ T(cid:3) (0) − δ ˜βχ( ^α)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

≤ a.

Since in this case β = ω (^α) + ˜β and ^α = ω (^α) + χ (^α) (see (41)), we have
δ ˜βχ( ^α) = δβ ^α, |˜β| − |χ (^α)| = |β| − |^α|, and ^α! ˜β!

β!χ( ^α)! = 1 if β = ^α.

Hence, (49) implies that

(50)

in Case 2.

δ|β|−| ^α|∂β(cid:2)(cid:0)S ^α · ¯Pχ( ^α)(cid:1) ◦ T(cid:3) (0) − δβ ^α(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

≤ Ca

Thanks to (41) and (48), estimate (50) holds also in Case 1.
Thus, (50) holds for all ^α ∈ ^A, β ∈ M. Consequently,

(cid:12)(cid:12)(cid:12)
δ|β|−| ^α|∂β(cid:0)(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3) ◦ T(cid:1) (0) − δβ ^α(cid:12)(cid:12)(cid:12)

≤ Ca

for all ^α ∈ ^A, β ∈ M.

We prepare to apply Lemma 5, with ^S = δ−|ω( ^α)|S ^α and ^P = M0δm−|χ( ^α)| ¯Pχ(^α).

From (25) and (45), we have

(51)

(52)

From (38) we have

≤ C (a) δ−|β| for ^α ∈ ^A, β ∈ M.

(cid:12)(cid:12)(cid:12)
∂β(cid:16)δ−|ω( ^α)|S ^α(cid:17) (0)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)∂β(cid:0)¯Pχ( ^α) ◦ T(cid:1) (0)(cid:12)(cid:12) ≤ Cδ|χ(^α)|−|β| for ^α ∈ ^A, β ∈ M;
∂β(cid:16)M0δm−|χ( ^α)| ¯Pχ( ^α)(cid:17) (0)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

17

hence, by (25),

(53)

≤ C (a) M0δm−|β| for ^α ∈ ^A, β ∈ M.

Also, (39) gives

(54)

P0 ± c (a) M0δm−|χ( ^α)| ¯Pχ( ^α) ∈ Γ (0, CM0) for ^α ∈ ^A.

Our results (52), (53), (54) are the hypotheses of Lemma 5 for ^S, ^P as given

above. Applying that lemma, we learn that

P0 ± c (a)(cid:16)δ−|ω(^α)|S ^α(cid:17) ⊙0(cid:16)M0δm−|χ(^α)| ¯Pχ( ^α)(cid:17) ∈ Γ (0, C (a) M0) for ^α ∈ ^A.

Recalling (41), we conclude that

(55)

P0 ± c (a) M0δm−| ^α|S ^α ⊙0 ¯Pχ( ^α) ∈ Γ (0, C (a) M0) for ^α ∈ ^A.

Next, (51) and the small a condition tell us that there exists a matrix of

real numbers (bγ ^α)γ, ^α∈ ^A satisfying

(56) X^α∈ ^A

bγ ^α∂β(cid:0)(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3) ◦ T(cid:1) (0) · δ|β|−| ^α| = δγβ for γ, β ∈ ^A

and

(57)

From (56) we have

|bγ ^α| ≤ 2, for all γ, ^α ∈ ^A.

Also, (51) and (57) imply that
(59)

∂β
X^α∈ ^A
bγ ^αδ|γ|−| ^α|(cid:0)(cid:2)S ^α ⊙0 ¯Pχ(^α)(cid:3) ◦ T(cid:1)


bγ ^αδ|γ|−| ^α|(cid:0)(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3) ◦ T(cid:1)

(0)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(58)

∂β
X^α∈ ^A

Since

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(0) = δγβ for γ, β ∈ ^A.

≤ Cδ|γ|−|β| for γ ∈ ^A, β ∈ M.

M0δm−|γ|
X^α∈ ^A
bγ ^α ·(cid:10)M0δm−| ^α| ·(cid:2)S ^α ⊙0 ¯Pχ(^α)(cid:3)(cid:11) ,
= X^α∈ ^A

bγ ^αδ|γ|−| ^α|(cid:0)(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3)(cid:1)


we learn from (55), (57) and the Trivial Remark on Convex Sets in Section I.1,
that
(60)

P0 ± c (a) M0δm−|γ|
X^α∈ ^A

bγ ^αδ|γ|−| ^α|(cid:0)(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3)(cid:1)


18

∈ Γ (0, C (a) M0)

for γ ∈ ^A.

We deﬁne

(61)

Pγ = λγ X^α∈ ^A

bγ ^αδ|γ|−| ^α|(cid:2)S ^α ⊙0 ¯Pχ( ^α)(cid:3) for γ ∈ ^A.

From (25), we have |λγ| ≤ C (a). Recall from (21) that P0 ∈ Γ (0, CM0).

Hence, we deduce from (60) (and from the convexity of Γ (0, C (a) M0)) that

(62) P0, P0 + c (a) M0δm−|γ|Pγ, P0 − c (a) M0δm−|γ|Pγ ∈ Γ (0, C (a) M0) for

γ ∈ ^A.

Also, (58) and (61) give

(63)

∂βPγ (0) = δβγ for β, γ ∈ ^A.

From (25), (59), (61), we have

(64)

Our results (62), (63), (64) show that

(cid:12)(cid:12)∂βPγ (0)(cid:12)(cid:12) ≤ C (a) δ|γ|−|β| for γ ∈ ^A, β ∈ M.
(65) (Pγ)γ∈ ^A is an (cid:0) ^A, δ, C (a)(cid:1)-basis for ~Γ at (cid:0)0, M0, P0(cid:1).

We now pick a to to be a constant determined by CB, Cw, m, n, small
enough to satisfy our small a condition. Then (42), (44), and (65) immediately
imply the conclusions of Lemma 7.

The proof of that lemma is complete.
The next result is a consequence of the Relabeling Lemma (Lemma 7).

Lemma 8 (Control Γ Using Basis) Let ~Γ = (Γ (x, M))x∈E,M>0 be a (Cw, δmax)-
convex shape ﬁeld. Let x0 ∈ E, M0 > 0, 0 < δ ≤ δmax, CB > 0, A ⊆ M, and

let P, P0 ∈ P. Suppose ~Γ has an (A, δ, CB)-basis at (cid:0)x0, M0, P0(cid:1). Suppose also

that

(66) P ∈ Γ (x0, CBM0),

(67) ∂β(cid:0)P − P0(cid:1) (x0) = 0 for all β ∈ A, and
(68) maxβ∈M δ|β|(cid:12)(cid:12)∂β(cid:0)P − P0(cid:1) (x0)(cid:12)(cid:12) ≥ M0δm.

Then there exist ^A ⊆ M and ^P0 ∈ P with the following properties.

(69) ^A is monotonic.

(70) ^A < A (strict inequality).

(71) ~Γ has an ( ^A, δ, C′

m, n.

B)-basis at (x0, M0, ^P0), with C′

B determined by CB, Cw,

19

(72) ∂β(cid:0)^P0 − P0(cid:1) (x0) = 0 for all β ∈ A.
(73) (cid:12)(cid:12)∂β(cid:0)^P0 − P0(cid:1) (x0)(cid:12)(cid:12) ≤ M0δm−|β| for all β ∈ M.

Proof. We write c, C, C′, etc., to denote constants determined by CB, Cw, m,
n. These symbols may denote diﬀerent constants in diﬀerent occurrences.
Let (Pα)α∈A be an (A, δ, CB)-basis for ~Γ at (x0, M0, P0). By deﬁnition,

(74) P0 ∈ Γ (x0, CBM0),

(75) P0 ± cM0δm−|α|Pα ∈ Γ (x0, CBM) for all α ∈ A,

(76) ∂βPα (x0) = δβα for β, α ∈ A,

(77) (cid:12)(cid:12)∂βPα (x0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for all α ∈ A, β ∈ M.

P such that (66), (67) hold, and also

Assuming there exists P ∈ P such that (66), (67), (68) hold, then there exists

(78) maxβ∈M δ|β|(cid:12)(cid:12)∂β(cid:0)P − P0(cid:1) (x0)(cid:12)(cid:12) = M0δm.

(We just take our new P to be a convex combination of our original P and

P0.)

We pick γ ∈ M to achieve the above max. Thanks to (67), we have

(79) γ 6∈ A,

hence

(80) A ∪ {γ} < A (strict inequality).

We set

(81) ^P0 = 1

2 (P0 + P).

From (66), (74), (75), we have

(82) ^P0, ^P0 ± c′M0δm−|α|Pα ∈ Γ (x0, CM0) for α ∈ A.

Also,

(83) ^P0 ± 1

since ^P0 + 1
From (67) and (78), we have

2(cid:0)P − P0(cid:1) ∈ Γ (x0, CM)
2(cid:0)P − P0(cid:1) = P and ^P0 − 1
(84) ∂β(cid:0)^P0 − P0(cid:1) (x0) = 0 for all β ∈ A,

and

2(cid:0)P − P0(cid:1) = P0.

20

(85) (cid:12)(cid:12)∂β(cid:0)^P0 − P0(cid:1) (x0)(cid:12)(cid:12) ≤ M0δm−|β| for all β ∈ M.

We deﬁne

(86) P#

γ =(cid:2)∂γ(cid:0)P − P0(cid:1) (x0)(cid:3)−1 ·(cid:0)P − P0(cid:1).

We are not dividing by zero here; by (78) and the deﬁnition of γ, we have

(87) (cid:12)(cid:12)∂γ(cid:0)P − P0(cid:1) (x0)(cid:12)(cid:12)

From (67), (79), (86), we have

−1

= M−1

0 δ|γ|−m.

(88) ∂βP#

γ (x0) = δβγ for all β ∈ A ∪ {γ}.

Also, (78), (86), (87) give

∂βP#

≤ M−1

0 δ|γ|−m · M0δm−|β| = δ|γ|−|β| for all β ∈ M.

(89) (cid:12)(cid:12)(cid:12)

γ (x0)(cid:12)(cid:12)(cid:12)

From (86), (87), we have P − P0 = σM0δm−|γ|P#

γ for σ = 1 or σ = −1.

Therefore, (83) implies that

(90) ^P0 ± cM0δm−|γ|P#

γ ∈ Γ (x0, CM0).

From (82), (90) and the Trivial Remark on Convex Sets in Section I.1, we

conclude that

(91) ^P0 + sM0δm−|γ|P#

γ +Pα∈A tα · M0δm−|α|Pα ∈ Γ (x0, CM0),

whenever |s|, |tα| ≤ c (all α ∈ A) for a small enough c.

For α ∈ A, we deﬁne

(92) P#

α = Pα − [∂γPα (x0)] · P#
γ .

Fix α ∈ A. If β ∈ A, then (76), (79), (88) imply

∂βP#

α (x0) = ∂βPα (x0) − [∂γPα (x0)] · ∂βP#

γ (x0) = δβα.

On the other hand, (79) and (88) yield

∂γP#

α (x0) = ∂γPα (x0) − [∂γPα (x0)] · ∂γP#

γ (x0) = 0 = δγα.

Thus,

∂βP#

α (x0) = δβα for β ∈ A∪ {γ} , α ∈ A.

Together with (88), this tells us that

(93) ∂βP#

α (x0) = δβα for β, α ∈ A ∪ {γ}.

21

Next, we learn from (77), (89), (92) that

(cid:12)(cid:12)∂βP#

α (x0)(cid:12)(cid:12) ≤ (cid:12)(cid:12)∂βPα (x0)(cid:12)(cid:12) + |∂γPα (x0)| ·(cid:12)(cid:12)∂βP#

≤ Cδ|α|−|β| + Cδ|α|−|γ| · δ|γ|−|β|
≤ C′δ|α|−|β| for α ∈ A, β ∈ M.

γ (x0)(cid:12)(cid:12)

Together with (89), this tells us that

∂βP#

≤ Cδ|α|−|β| for all α ∈ A ∪ {γ}, β ∈ M.

(94) (cid:12)(cid:12)(cid:12)

α (x0)(cid:12)(cid:12)(cid:12)

Next, note that for α ∈ A, we have

M0δm−|α|P#

α = M0δm−|α|Pα −hδ|γ|−|α|∂γPα (x0)i · M0δm−|γ|P#

γ ,

with (cid:12)(cid:12)(cid:12)hδ|γ|−|α|∂γPα (x0)i(cid:12)(cid:12)(cid:12)

Therefore, (91) shows that

≤ C by (77).

^P0 ± cM0δm−|α|P#

α ∈ Γ (x0, CM0) for α ∈ A,

provided we take c small enough. Together with (90), this yields

(95) ^P0 ± cM0δm−|α|P#

α ∈ Γ (x0, CM0) for all α ∈ A ∪ {γ}.

Our results (93), (94), (95) tell us that (cid:16)P#
basis for ~Γ at (cid:0)x0, M0, ^P0(cid:1).

with the following properties.

α(cid:17)α∈A∪{γ}

Consequently, the Relabeling Lemma (Lemma 7) produces a set ^A ⊆ M

is an (A∪ {γ} , δ, C)-

(96) ^A is monotonic.

(97) ^A ≤ A ∪ {γ} < A, see (80).

(98) ~Γ has an ( ^A, δ, C′)-basis at (x0, M0, ^P0).

Our results (84), (85), (96), (97), (98) are the conclusions (69)· · · (73) of

Lemma 8.

The proof of that lemma is complete.

I.4 The Transport Lemma

In this section, we prove the following result.

Lemma 9 (Transport Lemma) Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a shape ﬁeld.
For l ≥ 1, let ~Γl = (Γl (x, M))x∈E,M>0 be the l-th reﬁnement of ~Γ0.

22

(1) Suppose A ⊆ M is monotonic and ^A ⊆ M (not necessarily monotonic).

Let x0 ∈ E, M0 > 0, l0 ≥ 1, δ > 0, CB, ^CB, CDIFF > 0. Let P0, ^P0 ∈ P.

Assume that the following hold.

(2) ~Γl0 has an (A, δ, CB)-basis at (cid:0)x0, M0, P0(cid:1), and an (cid:0) ^A, δ, ^CB(cid:1)-basis at

(cid:0)x0, M0, ^P0(cid:1).

(3) ∂β(P0 − ^P0) ≡ 0 for β ∈ A.

(4) |∂β(P0 − ^P0)(x0)| ≤ CDIFFM0δm−|β| for β ∈ M.

Let y0 ∈ E, and suppose that

(5) |x0 − y0| ≤ ǫ0δ,

where ǫ0 is a a small enough constant determined by CB, ^CB, CDIFF, m, n.
Then there exists ^P# ∈ P with the following properties.

(6) ~Γl0−1 has both an (A, δ, C′

B)-basis and an ( ^A, δ, C′

B)-basis at (y0, M0, ^P#),

with C′

B determined by CB, ^CB, CDIFF, m, n.

(7) ∂β(^P# − P0) ≡ 0 for β ∈ A.

(8) |∂β(^P# − P0)(x0)| ≤ C′M0δm−|β| for β ∈ M, with C′ determined by CB,

^CB, CDIFF, m, n.

Remark Note that A and ^A play diﬀerent rˆoles here; see (1), (3), and (7).

In the trivial case A = ^A = ∅, the
Proof of the Transport Lemma.
Transport Lemma holds simply because (by deﬁnition of the l-th reﬁnement)
there exists ^P# ∈ Γl0−1 (y0, CBM0) such that

(cid:12)(cid:12)∂β(cid:0)^P# − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CBM0 |x0 − y0|m−|β|

≤ CBM0δm−|β| for β ∈ M.

(Recall that P0 ∈ Γl0 (x0, CBM0) since ~Γl0 has an (A, δ, CB)-basis at(cid:0)x0, M0, P0(cid:1).)

From now on, we suppose that

(9)

# (A) + #(cid:0) ^A(cid:1) 6= 0.

In proving the Transport Lemma, we do not yet take ǫ0 to be a constant

determined by CB, ^CB, CDIFF, m, n. Rather, we make the following

(10) Small ǫ0 assumption: ǫ0 is less than a small enough constant determined

by CB, ^CB, CDIFF, m, n.

23

Assuming (1)· · · (5) and (9), (10), we will prove that there exists ^P# ∈ P
satisfying (6), (7), (8). Once we do so, we may then pick ǫ0 to be a constant
determined by CB, ^CB, CDIFF, m, n, small enough to satisfy (10). That will
complete the proof of the Transport Lemma.

Thus, assume (1)· · · (5) and (9), (10).
We write c, C, C′, etc.

to denote “controlled constants”, i.e., constants
determined by CB, ^CB, CDIFF, m, n. These symbols may denote diﬀerent
controlled constants in diﬀerent occurrences.

Let (Pα)α∈A be an (A, δ, CB)-basis for ~Γl0 at (x0, M0, P0), and let (^Pα)α∈ ^A

be an ( ^A, δ, ^CB)-basis for ~Γl0 at (x0, M0, ^P0).

By deﬁnition, the following hold.

(11) P0 + c0σM0δm−|α|Pα ∈ Γl0 (x0, CM0) for α ∈ A, σ ∈ {1, −1}.

(12) ^P0 + ^c0σM0δm−|α| ^Pα ∈ Γl0 (x0, CM0) for α ∈ ^A, σ ∈ {1, −1}.

(13) ∂βPα (x0) = δβα for α, β ∈ A.

(14) ∂β ^Pα (x0) = δβα for α, β ∈ ^A.

(15) (cid:12)(cid:12)∂βPα (x0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ A, β ∈ M.
(16) (cid:12)(cid:12)∂β ^Pα (x0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ ^A, β ∈ M.

We ﬁx controlled constants c0, ^c0 as in (11), (12). Recall that ~Γl0 is the
ﬁrst reﬁnement of ~Γl0−1. Therefore, by (5), (10), (11), there exists ˜Pα,σ ∈
Γl0−1(y0, CM0) (α ∈ A, σ ∈ {1, −1}) such that

∂β(cid:16)˜Pα,σ −hP0 + c0σM0δm−|α|Pαi(cid:17) (x0)(cid:12)(cid:12)(cid:12)

≤ CM0 |x0 − y0|m−|β| ≤ Cǫ0M0δm−|β|, for β ∈ M.

(cid:12)(cid:12)(cid:12)

Writing

we have

Eα,σ =

˜Pα,σ −hP0 + c0σM0δm−|α|Pαi

c0σM0δm−|α|

,

(17) P0 + c0σM0δm−|α| (Pα + Eα,σ) ∈ Γl0−1 (y0, CM0) for α ∈ A, σ ∈ {1, −1},

and

(18) (cid:12)(cid:12)∂βEα,σ (x0)(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for α ∈ A, β ∈ M, σ ∈ {1, −1}.
Similarly, we obtain ^Eα,σ ∈ P (cid:0)α ∈ ^A, σ ∈ {1, −1}(cid:1), satisfying
(19) ^P0 + ^c0σM0δm−|α|(cid:0)^Pα + ^Eα,σ(cid:1) ∈ Γl0−1 (y0, CM0) for α ∈ ^A, σ ∈ {1, −1},

24

and

(20) (cid:12)(cid:12)∂β ^Eα,σ (x0)(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for α ∈ ^A, β ∈ M, σ ∈ {1, −1}.

We introduce the following polynomials:

(21)

^P′ =

(see (9));

(22)

P′
α =

1

2(cid:2)# (A) + #(cid:0) ^A(cid:1)(cid:3)−1

 Pα∈A,σ=±1(cid:10)P0 + c0σM0δm−|α| (Pα + Eα,σ)(cid:11)
+Pα∈ ^A,σ=±1(cid:10)^P0 + ^c0σM0δm−|α|(cid:0)^Pα + ^Eα,σ(cid:1)(cid:11) 


1

2c0M0δm−|α| 


(cid:10)P0 + c0M0δm−|α| (Pα + Eα,1)(cid:11)
−(cid:10)P0 − c0M0δm−|α| (Pα + Eα,−1)(cid:11) 


= Pα +

(Eα,1 + Eα,−1) for α ∈ A;

1
2

(23)

^P′
α =

1

2^c0M0δm−|α| 


1

(cid:10)^P0 + ^c0M0δm−|α|(cid:0)^Pα + ^Eα,1(cid:1)(cid:11)
−(cid:10)^P0 − ^c0M0δm−|α|(cid:0)^Pα + ^Eα,−1(cid:1)(cid:11) 


= ^Pα +

2(cid:0)^Eα,1 + ^Eα,−1(cid:1) for α ∈ ^A.

For a small enough controlled constant c1, we have

(24) ^P′ + c1M0δm−|α|P′

α, ^P′ − c1M0δm−|α|P′

α ∈ Γl0−1 (y0, CM0) for α ∈ A,

and

(25) ^P′ + c1M0δm−|α| ^P′

α, ^P′ − c1M0δm−|α| ^P′

α ∈ Γl0−1 (y0, CM0) for α ∈ ^A,

because each of the polynomials in (24), (25) is a convex combination of the
polynomials in (17), (19). (In fact, we can take c1 =

.)

c0

#(A)+#( ^A)

From (24), (25) and the Trivial Remark on Convex Sets in Section I.1, we

obtain the following, for a small enough controlled constant c2.

(26) ^P′ +Pα∈A sαM0δm−|α|P′

α +Pα∈ ^A tαM0δm−|α| ^P′

whenever |sα| ≤ c2 for all α ∈ A and |tα| ≤ c2 for all α ∈ ^A.

α ∈ Γl0−1 (y0, CM0),

Note also that (21) may be written in the equivalent form

25

(27)

^P′ = P0 +"

# (A) + # ^(A)#(cid:0)^P0 − P0(cid:1)
#(cid:0) ^A(cid:1)

+

1

2(cid:2)# (A) + #(cid:0) ^A(cid:1)(cid:3)

+Pα∈ ^A,σ=±1 ^c0σM0δm−|α| ^Eα,σ (cid:15) .
(cid:14) Pα∈A,σ=±1 c0σM0δm−|α|Eα,σ

Consequently, (3), (4), (18), (20) tell us that

Similarly, (13)· · · (16), (18), (20), and (22), (23) together imply the estimates

From (30)· · · (33) and (5), we have also

(28) (cid:12)(cid:12)∂β(cid:0)^P′ − P0(cid:1) (x0)(cid:12)(cid:12) ≤ Cǫ0M0δm−|β| for β ∈ A;
(29) (cid:12)(cid:12)∂β(cid:0)^P′ − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CM0δm−|β| for β ∈ M.
α (x0) − δβα(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for α, β ∈ A;
(30) (cid:12)(cid:12)∂βP′
α (x0) − δβα(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for α, β ∈ ^A;
(31) (cid:12)(cid:12)∂β ^P′
α (x0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ A, β ∈ M; and
(32) (cid:12)(cid:12)∂βP′
α (x0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ ^A, β ∈ M.
(33) (cid:12)(cid:12)∂β ^P′
α (y0) − δβα(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for β, α ∈ A;
(34) (cid:12)(cid:12)∂βP′
α (y0) − δβα(cid:12)(cid:12) ≤ Cǫ0δ|α|−|β| for β, α ∈ ^A;
(35) (cid:12)(cid:12)∂β ^P′
α (y0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ A, β ∈ M; and
(36) (cid:12)(cid:12)∂βP′
α (y0)(cid:12)(cid:12) ≤ Cδ|α|−|β| for α ∈ ^A, β ∈ M.
(37) (cid:12)(cid:12)∂β ^P′
(38) ∂β(cid:0)^P# − P0(cid:1) (x0) = 0 for β ∈ A;
(39) (cid:12)(cid:12)∂β(cid:0)^P# − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CM0δm−|β| for β ∈ M;
(40) ^P# +Pα∈A sαM0δm−|α|P′

whenever all |sα|, |tα| are less than c3.

for a small enough controlled constant c3, we have

Next, we prove that there exists ^P# ∈ P with the following properties:

α +Pα∈ ^A tαM0δm−|α| ^P′

α ∈ Γl0−1 (y0, CM0),

Indeed, if A = ∅, we set ^P# = ^P′; then (38) holds vacuously, and (39), (40)
α (α ∈ A)

simply restate (29), (26). Suppose A 6= ∅. We will pick coeﬃcients s#
for which

26

(41) ^P# := ^P′ +Pα∈A s#

α M0δm−|α|P′

α satisﬁes (38), (39), (40).

In fact, with ^P# given by (41), equation (38) is equivalent to the system of

the linear equations

(42) Pα∈Ahδ|β|−|α|∂βP′

α (x0)i s#

α = −M−1

0 δ|β|−m∂β(cid:0)^P′ − P0(cid:1) (x0) (β ∈ A).

By (28), the right-hand side of (42) has absolute value at most Cǫ0. Hence,
α , and we

by (30) and the small ǫ0 assumption (10), we can solve (42) for the s#
have

The resulting ^P# given by (41) then satisﬁes (38). Moreover, for β ∈ M, we

s#

have

α(cid:12)(cid:12)(cid:12)

≤ Cǫ0 for all α ∈ A.

(43) (cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)∂β(cid:0)^P# − P0(cid:1) (x0)(cid:12)(cid:12) ≤ (cid:12)(cid:12)∂β(cid:0)^P′ − P0(cid:1) (x0)(cid:12)(cid:12) + Xα∈A(cid:12)(cid:12)s#

≤ (cid:12)(cid:12)∂β(cid:0)^P′ − P0(cid:1) (x0)(cid:12)(cid:12) + Cǫ0δm−|β|M0,

thanks to (32), (41), (43).

Therefore, (29) gives

α(cid:12)(cid:12) · M0δm−|α|(cid:12)(cid:12)∂βP′

α (x0)(cid:12)(cid:12)

(cid:12)(cid:12)∂β(cid:0)^P# − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CM0δm−|β| for β ∈ M,

Finally, (40) follows at once from (26), (41), (43) and the small ǫ0 assump-

Thus, in all cases, there exists ^P# satisfying (38), (39), (40). We ﬁx such a

proving (39).

tion (10).

^P#.

Next, we produce an (A, δ, C)-basis for ~Γl0−1 at (y0, M0, ^P#). To do so, we

ﬁrst suppose that A 6= ∅, and set

(44) P#

γ =Pα∈A bγαδ|γ|−|α|P′

α

for real coeﬃcients (bγα)γ,α∈A to be picked below. For β, γ ∈ A, we have

Thanks to (34) and the small ǫ0 assumption (10), we may deﬁne (bγα)γ,α∈A

bγαhδ|β|−|α|∂βP′

α (y0)i .

α(y0)(cid:17)α,β∈A

, and we then have

∂βP#

γ (y0) = δ|γ|−|β| · Xα∈A
as the inverse matrix of (cid:16)δ|β|−|α|∂βP′

(45) ∂βP#

γ (y0) = δβγ (β, γ ∈ A)

and

27

(46) |bγα − δγα| ≤ Cǫ0 for γ, α ∈ A.

In particular,

(47) |bγα| ≤ C,

and therefore for γ ∈ A, β ∈ M we have

(48)

(cid:12)(cid:12)∂βP#

γ (y0)(cid:12)(cid:12) ≤ Xα∈A
≤ CXα∈A

|bγα| δ|γ|−|α|(cid:12)(cid:12)∂βP′

α (y0)(cid:12)(cid:12)

δ|γ|−|α|δ|α|−|β| ≤ C′δ|γ|−|β|,

thanks to (36).

Also, for γ ∈ A, we have

hM0δm−|γ|P#

γi = Xα∈A

bγα ·hM0δm−|α|P′
αi .

Therefore, for a small enough controlled constant c4, we have

(49) ^P# + c4M0δm−|γ|P#

γ , ^P# − c4M0δm−|γ|P#

γ ∈ Γl0−1 (y0, CM0) for γ ∈ A,

thanks to (40), which in turn holds thanks to (47). Since we are assuming that
A 6= ∅, (49) implies that also

(50) ^P# ∈ Γl0−1 (y0, CM0).

is an (A, δ, C)-basis

Thus, we have produced the desired (A, δ, C)-basis, provided that A 6= ∅.
On the other hand, if A = ∅, then the existence of an (A, δ, C)-basis for ~Γl0−1

Our results (45), (48), (49), (50) tell us that (cid:16)P#
for ~Γl0−1 at (cid:0)y0, M0, ^P#(cid:1).
at (cid:0)y0, M0, ^P#(cid:1) is equivalent to the assertion that

(51) ^P# ∈ Γl0−1 (y0, CM0),

γ(cid:17)γ∈A

and (51) follows at once from (40). Thus, in all cases,

suppose ﬁrst that ^A 6= ∅, and set

(52) ~Γl0−1 has an (A, δ, C)-basis at (cid:0)y0, M0, ^P#(cid:1).
Similarly, we can produce an ( ^A, δ, C)-basis for ~Γl0−1 at (cid:0)y0, M0, ^P#(cid:1). We
γ =Pα∈ ^A

α for γ ∈ ^A, with coeﬃcients ^bγα to be picked

^bβαδ|γ|−|α| ^P′

(53) ^P#

below.

28

Thanks to (35) and the small ǫ0 assumption (10), we can pick the coeﬃcients

^bγα so that

(54) ∂β ^P#

γ (y0) = δβ,γ for β, γ ∈ ^A

and

hence

(55) (cid:12)(cid:12)
(56) (cid:12)(cid:12)
(57) (cid:12)(cid:12)(cid:12)

^bγα − δγα(cid:12)(cid:12) ≤ Cǫ0 for γ, α ∈ ^A,
^bγα(cid:12)(cid:12) ≤ C for γ, α ∈ ^A.
γ (y0)(cid:12)(cid:12)(cid:12)

∂β ^P#

in analogy with (48). Also for γ ∈ ^A, we have

From (37), (53), (56), we obtain the estimate

≤ Cδ|γ|−|β| for γ ∈ ^A and β ∈ M,

M0δm−|γ| ^P#

γ = Xα∈ ^A

^bγαhM0δm−|α| ^P′
αi .

Together with (40) and (56), this tells us that

(58) ^P# + c5M0δm−|γ| ^P#

γ , ^P# − c5M0δm−|γ| ^P#

γ ∈ Γl0−1 (y0, CM0) for γ ∈ ^A

in analogy with (49). Since we are assuming that ^A 6= ∅, (58) implies that

(59) ^P# ∈ Γl0−1 (y0, CM0).

Thus, we have produced the desired ( ^A, δ, C)-basis, provided ^A 6= ∅. On
the other hand, if ^A = ∅, then the existence of an ( ^A, δ, C)-basis for ~Γl0−1 at

Our results (54),(57), (58), (59) tell us that (cid:16)^P#
for ~Γl0−1 at (cid:0)y0, M0, ^P#(cid:1).
(cid:0)y0, M0, ^P#(cid:1) is equivalent to the assertion that

(60) ^P# ∈ Γl0−1 (y0, CM0),

γ(cid:17)γ∈ ^A

is an ( ^A, δ, C)-basis

and (60) follows at once from (40). Thus, in all cases,

(61) ~Γl0−1 has an (cid:0) ^A, δ, C(cid:1)-basis at (cid:0)y0, M0, ^P#(cid:1).

Our results (52) and (61) together yield conclusion (6) of the Transport
Lemma (Lemma 9). Also, our results (38) and (39) imply conclusions (7) and
(8), since A is monotonic. (See (1).)

Thus, starting from assumptions (1)· · · (5) and (9), (10), we have proven

conclusions (6), (7), (8) for our ^P#.

The proof of the Transport Lemma (Lemma 9) is complete.

29

Remark The monotonicity of A was used in the proof of the Transport Lemma
only to gurantee that formulas (3) and (7) are independent of the base point.

Part II
The Main Lemma

II.1 Statement of the Main Lemma

For A ⊆ M monotonic, we deﬁne

(1) l (A) = 1 + 3 · # {A′ ⊆ M : A′ monotonic, A′ < A}.

Thus,

(2) l (A) − 3 ≥ l (A′) for A′, A ⊆ M monotonic with A′ < A.

By induction on A (with respect to the order relation <), we will prove the

following result.

Main Lemma for A Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a (Cw, δmax)-convex
shape ﬁeld, and for l ≥ 1, let ~Γl = (Γl (x, M))x∈E,M>0 be the l-th reﬁnement

P0 ∈ P, as well as positive real numbers M0, ǫ, CB. We make the following
assumptions.

of ~Γ0. Fix a dyadic cube Q0 ⊂ Rn, a point x0 ∈ E ∩ 5(cid:0)Q+
(A1) ~Γl(A) has an (cid:0)A, ǫ−1δQ0 , CB(cid:1)-basis at (cid:0)x0, M0, P0(cid:1).

0(cid:1) and a polynomial

(A2) ǫ−1δQ0 ≤ δmax.

(A3) (“Small ǫ Assumption”) ǫ is less than a small enough constant determined

by CB, Cw, m, n.

Then there exists F ∈ Cm(cid:0) 65
(C1) (cid:12)(cid:12)∂β(cid:0)F − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

determined by ǫ, CB, Cw, m, n.

Q0

by ǫ, CB, Cw, m, n.

64 Q0(cid:1) satisfying the following conditions.

on 65

64 Q0 for |β| ≤ m, where C (ǫ) is

(C2) Jz (F) ∈ Γ0 (z, C′ (ǫ) M0) for all z ∈ E ∩ 65

64 Q0, where C′ (ǫ) is determined

Remarks

• We state the Main Lemma only for monotonic A.

• Note that x0 may fail to belong to 65
may be meaningless. Even if x0 ∈ 65
P0. However, see Corollary 4 in Section III.1 below.

64 Q0, hence the assertion Jx0 (F) = P0
64 Q0, we do not assert that Jx0 (F) =

30

II.2 The Base Case

The base case of our induction on A is the case A = M.

In this section, we prove the Main Lemma for M. The hypotheses of the

lemma are as follows:

(1) ~Γ0 = (Γ0 (x, M))x∈E,M>0 is a (Cw, δmax)-convex shape ﬁeld.

(2) ~Γ1 = (Γ1 (x, M))x∈E,M>0 is the ﬁrst reﬁnement of ~Γ0.

(3) ~Γ1 has an (cid:0)M, ǫ−1δQ0 , CB(cid:1)-basis at (cid:0)x0, M0, P0(cid:1).

(4) ǫ−1δQ0 ≤ δmax.

(5) ǫ is less than a small enough constant determined by CB, Cw, m, n.

(6) x0 ∈ 5 (Q0)+ ∩ E.

We write c, C, C′, etc., to denote constants determined by CB, CW, m, n.

These symbols may denote diﬀerent constants in diﬀerent occurrences.

(7) Let z ∈ E ∩ 65

64 Q0.

Then (6), (7) imply that

(8) |z − x0| ≤ CδQ0 = Cǫ ·(cid:0)ǫ−1δQ0(cid:1).

From (1), (2), (3), (5), (8), and Lemma 9 in Section I.4 (with ^A = A,

^P0 = P0), we obtain a polynomial ^P# ∈ P such that

(9) ~Γ0 has an (cid:0)M, ǫ−1δQ0 , C′(cid:1)-basis at (cid:0)z, M0, ^P#(cid:1), and
(10) ∂β(cid:0)^P# − P0(cid:1) = 0 for β ∈ M.

From (9), we have ^P# ∈ Γ0(z, C′M0), while (10) tells us that ^P# = P0. Thus,

(11) P0 ∈ Γ0 (z, C′M0) for all z ∈ 65

64 Q0 ∩ E.

Consequently, the function F := P0 on 65

64 Q0 satisﬁes the conclusions (C1),

(C2) of the Main Lemma for M.

This completes the proof of the Main Lemma for M. (cid:4)

31

II.3 Setup for the Induction Step

Fix a monotonic set A strictly contained in M, and assume the following

(1) Induction Hypothesis: The Main Lemma for A′ holds for all monotonic

A′ < A.

Under this assumption, we will prove the Main Lemma for A. Thus, let ~Γ0,
~Γl (l ≥ 1), Cw, δmax, Q0, x0, P0, M0, ǫ, CB be as in the hypotheses of the Main
Lemma for A. Our goal is to prove the existence of F ∈ Cm( 65
64 Q0) satisfying
conditions (C1) and (C2). To do so, we introduce a constant A ≥ 1, and make
the following additional assumptions.

(2) Large A assumption: A exceeds a large enough constant determined by

CB, Cw, m, n.

(3) Small ǫ assumption: ǫ is less than a small enough constant determined by

A, CB, Cw, m, n.

We write c, C, C′, etc., to denote constants determined by CB, Cw, m,
n. Also we write c(A), C(A), C′(A), etc., to denote constants determined
by A, CB, Cw, m, n. Similarly, we write C (ǫ), c (ǫ), C′ (ǫ), etc., to denote
constants determined by ǫ, A, CB, Cw, m, n. These symbols may denote
diﬀerent constants in diﬀerent occurrences.

In place of (C1), (C2), we will prove the existence of a function F ∈ Cm(cid:0) 65

64 Q0(cid:1)

satisfying

(C*1) (cid:12)(cid:12)∂β(cid:0)F − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

(C*2) Jz (F) ∈ Γ0 (z, C (ǫ) M0) for all z ∈ E ∩ 65

Q0

on 65

64 Q0 for |β| ≤ M; and

64 Q0.

Conditions (C*1), (C*2) diﬀer from (C1), (C2) in that the constants in

(C*1), (C*2) may depend on A.

Once we establish (C*1) and (C*2), we may ﬁx A to be a constant deter-
mined by CB, Cw, m, n, large enough to satisfy the Large A Assumption (2).
The Small ǫ Assumption (3) will then follow from the Small ǫ Assumption
(A3) in the Main Lemma for A; and the desired conclusions (C1), (C2) will
then follow from (C*1), (C*2).

Thus, our goal is to prove the existence of F ∈ Cm(cid:0) 65

and (C*2), assuming (1), (2), (3) above, along with hypotheses of the Main
Lemma for A. This will complete our induction on A and establish the Main
Lemma for all monotonic subsets of M.

64 Q0(cid:1) satisfying (C*1)

II.4 Calder´on-Zygmund Decomposition

We place ourselves in the setting of Section II.3. Let Q be a dyadic cube. We
say that Q is “OK” if (1) and (2) below are satisﬁed.

32

(1) 5Q ⊆ 5Q0.

(2) Either #(E ∩ 5Q) ≤ 1 or there exists ^A < A (strict inequality) for which

the following holds:

(3) For each y ∈ E ∩ 5Q there exists ^Py ∈ P satisfying

(3a) ~Γl(A)−3 has a weak (cid:0) ^A, ǫ−1δQ, A(cid:1)-basis at (cid:0)y, M0, ^Py(cid:1).
(3b) (cid:12)(cid:12)∂β(cid:0)^Py − P0(cid:1) (x0)(cid:12)(cid:12) ≤ AM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
(3c) ∂β(cid:0)^Py − P0(cid:1) ≡ 0 for β ∈ A.

for all β ∈ M.

Remark The argument in this section and the next will depend sensitively on
several details of the above deﬁnition. Note that (3a) involves ~Γl(A)−3 rather
than ~Γl( ^A), and that (3b) involves x0, δQ0 rather than y, δQ. Note also that the
set ^A in (2), (3) needn’t be monotonic.

A dyadic cube Q will be called a Calder´on-Zygmund cube (or a CZ cube) if

it is OK, but no dyadic cube strictly containing Q is OK.

Recall that given any two distinct dyadic cubes Q, Q′, either Q is strictly
contained in Q′, or Q′ is strictly contained in Q, or Q ∩ Q′ = ∅. The ﬁrst two
alternatives here are ruled out if Q, Q′ are CZ cubes. Hence, the Calder´on-
Zygmund cubes are pairwise disjoint.

Any CZ cube Q satisﬁes (1) and is therefore contained in the interior of 5Q0.
On the other hand, let x be an interior point of 5Q0. Then any suﬃciently small
dyadic cube Q containing x satisﬁes 5Q ⊂ 5Q0 and #(E ∩ 5Q) ≤ 1; such Q
are OK. However, any suﬃciently large dyadic cube Q containing x will fail
to satisfy 5Q ⊆ 5Q0; such Q are not OK. It follows that x is contained in a
maximal OK dyadic cube. Thus, we have proven

Lemma 10 The CZ cubes form a partition of the interior of 5Q0.

Next, we establish

Lemma 11 Let Q, Q′ be CZ cubes. If 65

64 Q∩ 65

64 Q′ 6= ∅, then 1

2 δQ ≤ δQ′ ≤ 2δQ.

Proof. Suppose not. Without loss of generality, we may suppose that δQ ≤
1
4 δQ′. Then δQ+ ≤ 1
64 Q′ 6= ∅; hence, 5Q+ ⊂ 5Q′. The cube
Q′ is OK. Therefore,

2 δQ′, and 65

64 Q+ ∩ 65

(4) 5Q+ ⊂ 5Q′ ⊆ 5Q0.

If # (E ∩ 5Q′) ≤ 1, then also # (E ∩ 5Q+) ≤ 1. Otherwise, there exists

^A < A such that for each y ∈ E ∩ 5Q′ there exists ^Py ∈ P satisfying

(5) ~Γl(A)−3 has a weak (cid:0) ^A, ǫ−1δQ′ , A(cid:1)-basis at (cid:0)y, M0, ^Py(cid:1),
(6) (cid:12)(cid:12)∂β(cid:0)^Py − P0(cid:1) (x0)(cid:12)(cid:12) ≤ AM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

for β ∈ M, and

33

(7) ∂β(cid:0)^Py − P0(cid:1) ≡ 0 for β ∈ A.

For each y ∈ E ∩ 5Q+ ⊆ E ∩ 5Q′, the above ^Py satisﬁes (6), (7); and (5)

implies

(8) ~Γl(A)−3 has a weak (cid:0) ^A, ǫ−1δQ+, A(cid:1)-basis at (cid:0)y, M0, ^Py(cid:1)

because ǫ−1δQ+ < ǫ−1δQ′ , and because (5), (8) deal with weak bases. (See
remarks in Section I.3.) Thus, (4) holds, and either # (E ∩ 5Q+) ≤ 1 or else
our ^A < A and ^Py (y ∈ E ∩ 5Q+) satisfy (6), (7), (8). This tells us that Q+
is OK. However, Q+ strictly contains the CZ cube Q; therefore, Q+ cannot be
OK. This contradiction completes the proof of Lemma 11.

Note that the proof of Lemma 11 made use of our decision to involve x0,
δQ0 rather than y, δQ in (3b), as well as our decision to use weak bases in (3a).

We also have the following easy lemma.

Lemma 12 Only ﬁnitely many CZ cubes Q satisfy the condition

(9) 65

64 Q ∩ 65

64 Q0 6= ∅.

II.5 Auxiliary Polynomials

We again place ourselves in the setting of Section II.3 and we make use of the
Calder´on-Zygmund decomposition deﬁned in Section II.4.

Recall that x0 ∈ E ∩ 5Q+

0 , and that ~Γl(A) has an (A, ǫ−1δQ0 , CB)-basis at
(x0, M0, P0); moreover, A ⊆ M is monotonic, and ǫ is less than a small enough
constant determined by CB, Cw, m, n.

Let y ∈ E ∩ 5Q0. Then |x0 − y| ≤ CδQ0 = (Cǫ)(ǫ−1δQ0 ). Applying Lemma
9 in Section I.4 with ^A = A, ^P0 = P0, we see that there exists Py ∈ P with the
following properties.

(1) ~Γl(A)−1 has an (cid:0)A, ǫ−1δQ0 , C(cid:1)-basis (Py
(2) ∂β(cid:0)Py − P0(cid:1) ≡ 0 for β ∈ A,
(3) (cid:12)(cid:12)∂β(cid:0)Py − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

We ﬁx Py, Py

tionship between the polynomials Py, Py
decomposition.

α (α ∈ A) as above for each y ∈ E ∩ 5Q0. We study the rela-
α (α ∈ A) and the Calder´on-Zygmund

α)α∈A at (y, M0, Py),

for β ∈ M.

Lemma 13 (“Controlled Auxiliary Polynomials”) Let Q ∈ CZ, and sup-
pose that

(4) 65

64 Q ∩ 65

64 Q0 6= ∅.

Let

34

(5) y ∈ E ∩ 5Q0 ∩ 5Q+.

Then

for α ∈ A, β ∈ M.

(6) (cid:12)(cid:12)∂βPy

α (y)(cid:12)(cid:12) ≤ C ·(cid:0)ǫ−1δQ(cid:1)|α|−|β|

Proof.

If A = ∅, then (6) holds vacuously. Suppose A 6= ∅.
Let K ≥ 1 be a large enough constant to be picked below, and assume that

(7) maxα∈A,β∈M(cid:0)ǫ−1δQ(cid:1)|β|−|α|(cid:12)(cid:12)∂βPy

We will derive a contradiction.
Thanks to (1), we have

α (y)(cid:12)(cid:12) > K.

(8) Py, Py ± CM0 ·(cid:0)ǫ−1δQ0(cid:1)m−|α|

α (y) = δβα for β, α ∈ A,

(9) ∂βPy

and

(10) (cid:12)(cid:12)∂βPy

Also,

α (y)(cid:12)(cid:12) ≤ C(cid:0)ǫ−1δQ0(cid:1)|α|−|β|

Py
α ∈ Γl(A)−1 (y, CM0) for α ∈ A,

for α ∈ A, β ∈ M.

(11) 5Q ⊂ 5Q0 since Q is OK.

If δQ ≥ 2−12δQ0, then from (10), (11), we would have

(12) maxα∈A,β∈M(cid:0)ǫ−1δQ(cid:1)|β|−|α|(cid:12)(cid:12)∂βPy

We will pick

α (y)(cid:12)(cid:12) ≤ C′.

(13) K > C′, with C′ as in (12).

Then (12) contradicts our assumption (7).
Thus, we must have

(14) δQ < 2−12δQ0.

Let

(15) Q = ^Q0 ⊂ ^Q1 ⊂ · · · ⊂ ^Qνmax be all the dyadic cubes containing Q and

having sidelength at most 2−10δQ0.

Then

(16) ^Q0 = Q, δ ^Qνmax

νmax ≥ 2.

= 2−10δQ0, ^Qν+1 = (cid:0) ^Qν(cid:1)+

for 0 ≤ ν ≤ νmax − 1, and

35

For 1 ≤ ν ≤ νmax, we deﬁne

(17) Xν = maxα∈A,β∈M(cid:16)ǫ−1δ ^Qν(cid:17)|β|−|α|

From (7) and (10), we have

(cid:12)(cid:12)∂βPy

α (y)(cid:12)(cid:12).

(18) X0 > K, Xνmax ≤ C′,

and from (16), (17), we have

(19) 2−mXν ≤ Xν+1 ≤ 2mXν, for 0 ≤ ν ≤ νmax.

We will pick

(20) K > C′ with C′ as in (18).

Then ˜ν := min {ν : Xν ≤ K} and ˜Q = ^Q ˜ν satisfy the following, thanks to

(18), (19), (20): ˜ν 6= 0, hence

(21) ˜Q is a dyadic cube strictly containing Q; also 2−mK ≤ X˜ν ≤ K,

hence

(22) 2−mK ≤ maxα∈A,β∈M(cid:16)ǫ−1δ ˜Q(cid:17)|β|−|α|

Also, since Q ⊂ ˜Q, we have 65
64

˜Q∩ 65

(cid:12)(cid:12)∂βPy

α (y)(cid:12)(cid:12) ≤ K.

we conclude that

64 Q0 6= ∅ by (4); and since δ ˜Q ≤ 2−10δQ0,

(23) 5 ˜Q ⊂ 5Q0.

From (8), (10), and (23), we have

(24) Py, Py ± cM0(cid:16)ǫ−1δ ˜Q(cid:17)m−|α|

for α ∈ A;

and

Py
α ∈ Γl(A)−1 (y, CM0) ⊂ Γl(A)−2 (y, CM0)

(25) (cid:12)(cid:12)∂βPy

Our results (9), (24), (25) tell us that

for α ∈ A, β ∈ M, β ≥ α.

α (y)(cid:12)(cid:12) ≤ C(cid:16)ǫ−1δ ˜Q(cid:17)|α|−|β|
α)α∈A is a weak (cid:16)A, ǫ−1δ ˜Q, C(cid:17)-basis for ~Γl(A)−2 at (y, M0, Py).

(26) (Py

Note also that

(27) ǫ−1δ ˜Q ≤ ǫ−1δQ0 ≤ δmax, by (23) and hypothesis (A2) of the Main

Lemma for A.

36

Moreover,

(28) ~Γl(A)−2 is (C, δmax)-convex, thanks to Lemma 4 (B).

If we take

(29) K ≥ C∗ for a large enough C∗,

then (22), (26)· · · (29) and the Relabeling Lemma (Lemma 7) produce a

monotonic set ^A ⊂ M, such that

(30) ^A < A (strict inequality)

and

(31) ~Γl(A)−2 has an (cid:16) ^A, ǫ−1δ ˜Q, C(cid:17)-basis at (y, M0, Py).

Also, from (9), (22), (24), we see that

(32) (Py

α)α∈A is an (cid:16)A, ǫ−1δ ˜Q, CK(cid:17)-basis for ~Γl(A)−2 at (y, M0, Py).

We now pick

(33) K = ^C (a constant determined by CB, Cw, m, n), with ^C ≥ 1 large enough

to satisfy (13), (20), (29).

Then (31) and (32) tell us that

(34) ~Γl(A)−2 has both an (cid:16) ^A, ǫ−1δ ˜Q, C(cid:17)-basis and an (cid:16)A, ǫ−1δ ˜Q, C(cid:17)-basis at

(y, M0, Py).

Let z ∈ E ∩ 5 ˜Q. Then z, y ∈ 5 ˜Q+ (see (5)), hence

(35) |z − y| ≤ Cδ ˜Q = Cǫ ·(cid:16)ǫ−1δ ˜Q(cid:17).

From (34), (35), the Small ǫ Assumption and Lemma 9 (and our hypothesis
that A is monotonic; see Section II.3), we obtain a polynomial ˇPz ∈ P, such
that

(36) ~Γl(A)−3 has an (cid:16) ^A, ǫ−1δ ˜Q, C(cid:17)-basis at (cid:0)z, M0, ˇPz(cid:1),
(37) ∂β(cid:0)ˇPz − Py(cid:1) ≡ 0 for β ∈ A,
(38) (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (y)(cid:12)(cid:12) ≤ CM0(cid:16)ǫ−1δ ˜Q(cid:17)m−|β|

From (23) and (38), we have

and

for β ∈ M.

37

(39) (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (y)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

Since y ∈ 5Q0 by hypothesis of Lemma 13, while x0 ∈ 5Q+

0 by hypothesis
of the Main Lemma for A, we have |x0 − y| ≤ CδQ0, and therefore (39) implies
that

for β ∈ M.

From (2), (3), (37), (40), we now have

(40) (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (x0)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
(41) ∂β(cid:0)ˇPz − P0(cid:1) ≡ 0 for β ∈ A
(42) (cid:12)(cid:12)∂β(cid:0)ˇPz − P0(cid:1) (x0)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

and

for β ∈ M.

for β ∈ M.

Our results (36), (41), (42) hold for every z ∈ E ∩ 5 ˜Q.
We recall the Large A Assumption in the Section II.3. Then (23), (30), (36),

(41), (42) yield the following results: 5 ˜Q ⊂ 5Q0, ^A < A (strict inequality).

For every z ∈ E ∩ 5 ˜Q, there exists ˇPz ∈ P such that

• ~Γl(A)−3 has an (cid:16) ^A, ǫ−1δ ˜Q, A(cid:17)-basis at (cid:0)z, M0, ˇPz(cid:1).
• ∂β(cid:0)ˇPz − P0(cid:1) ≡ 0 for β ∈ A.
• (cid:12)(cid:12)∂β(cid:0)ˇPz − P0(cid:1) (x0)(cid:12)(cid:12) ≤ AM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

for β ∈ M.

that ˜Q is OK.

Comparing the above results with the deﬁnition of an OK cube, we conclude

However, since ˜Q properly contains the CZ cube Q, (see (21)), ˜Q cannot be

OK.

This contradiction proves that our assumption (7) must be false.

Thus, (cid:12)(cid:12)∂βPy

α (y)(cid:12)(cid:12) ≤ K(cid:0)ǫ−1δQ(cid:1)|α|−|β|

proof of Lemma 13.

for α ∈ A, β ∈ M.

Since we picked K = ^C in (33), this implies the estimate (6), completing the

As an easy consequence of Lemma 13, we have the following result.

Corollary 1 Let Q ∈ CZ, and suppose 65
Then (Py

α)α∈A is an (cid:0)A, ǫ−1δQ, C(cid:1)-basis for ~Γl(A)−1 at (y, M0, Py).

Lemma 14 (“Consistency of Auxiliary Polynomials”) Let Q, Q′ ∈ CZ,
with

64 Q∩ 65

64 Q0 6= ∅. Let y ∈ E∩5Q0∩5Q+.

(43) 65

64 Q ∩ 65

64 Q0 6= ∅, 65

64 Q′ ∩ 65

64 Q0 6= ∅

and

(44) 65

64 Q ∩ 65

64 Q′ 6= ∅.

38

Let

(45) y ∈ E ∩ 5Q0 ∩ 5Q+, y′ ∈ E ∩ 5Q0 ∩ 5 (Q′)+.

Then

≤ CM0(cid:0)ǫ−1δQ(cid:1)m−|β|

for β ∈ M.

(46) (cid:12)(cid:12)(cid:12)

∂β(cid:16)Py − Py′(cid:17) (y′)(cid:12)(cid:12)(cid:12)
∂β(cid:16)Py − Py′(cid:17) (x0)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)
∂β(cid:16)Py − Py′(cid:17) (y′)(cid:12)(cid:12)(cid:12)

Hence, (cid:12)(cid:12)(cid:12)

(47) δQ < 2−20δQ0.

Proof. Suppose ﬁrst that δQ ≥ 2−20δQ0. Then (3) (applied to y and to y′)
tells us that

≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
≤ C′M0(cid:0)ǫ−1δQ0(cid:1)m−|β|

for β ∈ M.

≤ C′′M0(cid:0)ǫ−1δQ(cid:1)m−|β|

for β ∈ M, since x0, y′ ∈ 5Q+

0 . Thus, (46) holds if δQ ≥ 2−20δQ0. Suppose

By (44) and Lemma 11, we have

(48) δQ, δQ′ ≤ 2−20δQ0 and 1

2 δQ ≤ δQ′ ≤ 2δQ.

Together with (43), this implies that

(49) 5Q+, 5 (Q′)+ ⊆ 5Q0.

From Corollary 1, we have

From (44), (45), (48), we have

(50) ~Γl(A)−1 has an (cid:0)A, ǫ−1δQ′, C(cid:1)-basis at (cid:16)y′, M0, Py′(cid:17).
(51) |y − y′| ≤ CδQ′ = Cǫ(cid:0)ǫ−1δQ′(cid:1).

We recall from (48) and the hypotheses of the Main Lemma for A that

(52) ǫ−1δQ′ ≤ ǫ−1δQ0 ≤ δmax,

and we recall from Section II.3 that

(53) A is monotonic.

Thanks to (50)· · · (53), Lemma 9 in Section I.4 (with ^A = A, ^P0 = P0)

produces a polynomial P′ ∈ P such that

(54) ~Γl(A)−2 has an (cid:0)A, ǫ−1δQ′, C(cid:1)-basis at (y, M0, P′);
(55) ∂β(cid:16)P′ − Py′(cid:17) ≡ 0 for β ∈ A;

39

and

(56) (cid:12)(cid:12)(cid:12)

∂β(cid:16)P′ − Py′(cid:17) (y′)(cid:12)(cid:12)(cid:12)

≤ CM0(cid:0)ǫ−1δQ′(cid:1)m−|β|

From (54) we have in particular that

for β ∈ M.

(57) P′ ∈ Γl(A)−2 (y, CM0),

and from (56) and (48) we obtain

for β ∈ M.

for β ∈ M,

∂β(cid:16)Py′

≤

− Py(cid:17) (y′)(cid:12)(cid:12)(cid:12)

∂β(cid:16)Py′

If we knew that

− P′(cid:17) (y′)(cid:12)(cid:12)(cid:12)

(58) (cid:12)(cid:12)(cid:12)
≤ CM0(cid:0)ǫ−1δQ(cid:1)m−|β|
(59) (cid:12)(cid:12)∂β (Py − P′) (y)(cid:12)(cid:12) ≤ M0(cid:0)ǫ−1δQ(cid:1)m−|β|
then also(cid:12)(cid:12)∂β (Py − P′) (y′)(cid:12)(cid:12) ≤ C′M0(cid:0)ǫ−1δQ(cid:1)m−|β|
CδQ thanks to (44), (45), (48). Consequently, by (58), we would have(cid:12)(cid:12)(cid:12)
CM0(cid:0)ǫ−1δQ(cid:1)m−|β|
Corollary 1 shows that ~Γl(A)−1 has an (cid:0)A, ǫ−1δQ, C(cid:1)-basis at (y, M0, Py).
(60) ~Γl(A)−2 has an (cid:0)A, ǫ−1δQ, C(cid:1)-basis at (y, M0, Py).

Since Γl(A)−1 (x, M) ⊂ Γl(A)−2 (x, M) for all x ∈ E, M > 0, it follows that

for β ∈ M, which is our desired inequality (46). Thus,

From (2) and (55) (applied to y and y′), we see that

Lemma 14 will follow if we can prove (59).

Suppose (59) fails.

for β ∈ M since |y − y′| ≤

(61) ∂β (Py − P′) ≡ 0 for β ∈ A.

Since we are assuming that (59) fails, we have

(62) maxβ∈M(cid:0)ǫ−1δQ(cid:1)|β|(cid:12)(cid:12)∂β (Py − P′) (y)(cid:12)(cid:12) ≥ M0(cid:0)ǫ−1δQ(cid:1)m

Also, from (48) and the hypotheses of the Main Lemma for A, we have

.

(63) ǫ−1δQ < ǫ−1δQ0 ≤ δmax.

From Lemma 4 (B), we know that

(64) ~Γl(A)−2 is (C, δmax)-convex.

Our results (57), (60)· · · (64) and Lemma 8 produce a set ^A ⊆ M and a

polynomial ^P ∈ P, with the following properties:

(65) ^A is monotonic;

(66) ^A < A (strict inequality);

40

may apply Lemma 9 to produce ˇPz ∈ P satisfying the following conditions.

By (2) and (71), we have

x0, y ∈ 5Q+
estimate

and

for β ∈ M.

By (70) and the Large A Assumption,

for β ∈ M.

Now let z ∈ E ∩ 5Q+. We recall that A is monotonic, and that (60), (61),
(67), (68), (69) hold. Moreover, since y, z ∈ 5Q+, we have |y − z| ≤ CδQ =

(67) ~Γl(A)−2 has an (cid:0) ^A, ǫ−1δQ, C(cid:1)-basis at (cid:0)y, M0, ^P(cid:1);
(68) ∂β(cid:0)^P − Py(cid:1) ≡ 0 for β ∈ A (recall, A is monotonic);
(69) (cid:12)(cid:12)∂β(cid:0)^P − Py(cid:1) (y)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ(cid:1)m−|β|
Cǫ(cid:0)ǫ−1δQ(cid:1). Thanks to the above remarks and the Small ǫ Assumption, we
(70) ~Γl(A)−3 has an (cid:0) ^A, ǫ−1δQ, C(cid:1)-basis at (cid:0)z, M0, ˇPz(cid:1).
(71) ∂β(cid:0)ˇPz − Py(cid:1) ≡ 0 for β ∈ A.
(72) (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (y)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ(cid:1)m−|β|
(73) ~Γl(A)−3 has an (cid:0) ^A, ǫ−1δQ+, A(cid:1)-basis at (cid:0)z, M0, ˇPz(cid:1).
(74) ∂β(cid:0)ˇPz − P0(cid:1) ≡ 0 for β ∈ A.
By (48) and (72), we have (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (y)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
β ∈ M, hence (cid:12)(cid:12)∂β(cid:0)ˇPz − Py(cid:1) (x0)(cid:12)(cid:12) ≤ CM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
(75) (cid:12)(cid:12)∂β(cid:0)ˇPz − P0(cid:1) (x0)(cid:12)(cid:12) ≤ AM0(cid:0)ǫ−1δQ0(cid:1)m−|β|

for β ∈ M, since
0 . Together with (3) and the Large A Assumption, this yields the

We have proven (73), (74), (75) for each z ∈ E ∩ 5Q+. Thus, 5Q+ ⊂ 5Q0
(see (49)), ^A < A (strict inequality; see (66)), and for each z ∈ E ∩ 5Q+ there
exists ˇPz ∈ P satisfying (73), (74), (75).

Comparing the above results with the deﬁnition of an OK cube, we see that
Q+ is OK. On the other hand Q+ cannot be OK, since it properly contains the
CZ cube Q. Assuming that (59) fails, we have derived a contradiction. Thus,
(59) holds, completing the proof of Lemma 14.

41

for

for β ∈ M.

II.6 Good News About CZ Cubes

In this section we again place ourselves in the setting of Section II.3, and we
make use of the auxiliary polynomials Py and the CZ cubes Q deﬁned above.

Lemma 15 Let Q ∈ CZ, with

(1) 65

64 Q ∩ 65

64 Q0 6= ∅

and

(2) # (E ∩ 5Q) ≥ 2.

Let

(3) y ∈ E ∩ 5Q.

Then there exist a set A# ⊆ M and a polynomial P# ∈ P with the following

properties.

(4) A# is monotonic.

(5) A# < A (strict inequality).

(6) ~Γl(A)−3 has an (cid:0)A#, ǫ−1δQ, C (A)(cid:1)-basis at (cid:0)y, M0, P#(cid:1).
(7) (cid:12)(cid:12)∂β(cid:0)P# − Py(cid:1) (y)(cid:12)(cid:12) ≤ C (A) M0(cid:0)ǫ−1δQ(cid:1)m−|β|
(8) ∂β(cid:0)Py − P0(cid:1) ≡ 0 for β ∈ A (see (2) in Section II.5)

Proof. Recall that

for β ∈ M.

and that

(9) 5Q ⊆ 5Q0, since Q is OK.

Thanks to (3) and (9), Corollary 1 in Section II.5 applies, and it tells us that

(10) ~Γl(A)−1 has an (cid:0)A, ǫ−1δQ, C(cid:1)-basis at (y, M0, Py).

On the other hand, Q is OK and #(E ∩ 5Q) ≥ 2; hence, there exist ^A ⊆ M

and ^P ∈ P with the following properties

(11) ~Γl(A)−3 has a weak (cid:0) ^A, ǫ−1δQ, A(cid:1)-basis at (cid:0)y, M0, ^P(cid:1).
(12) (cid:12)(cid:12)∂β(cid:0)^P − P0(cid:1) (x0)(cid:12)(cid:12) ≤ AM0(cid:0)ǫ−1δQ0(cid:1)m−|β|
(13) ∂β(cid:0)^P − P0(cid:1) ≡ 0 for β ∈ A.

(14) ^A < A (strict inequality).

for β ∈ M.

42

We consider separately two cases.
Case 1: Suppose that

(15) (cid:12)(cid:12)∂β(cid:0)^P − Py(cid:1) (y)(cid:12)(cid:12) ≤ M0(cid:0)ǫ−1δQ(cid:1)m−|β|

By Lemma 4 (B),

for β ∈ M.

(16) ~Γl(A)−3 is (C, δmax)-convex.

Also, (9) and hypothesis (A2) of the Main Lemma for A give

(17) ǫ−1δQ ≤ ǫ−1δQ0 ≤ δmax.

Applying (11), (16), (17) and Lemma 7, we obtain a set A# ⊆ M such that

(18) A# ≤ ^A,

(19) A# is monotonic,

and

(20) ~Γl(A)−3 has an (cid:0)A#, ǫ−1δQ, C (A)(cid:1)-basis at (cid:0)y, M0, ^P(cid:1).

Setting P# = ^P, we obtain the desired conclusions (4)· · · (7) at once from

(14), (15), (18), (19), and (20).

Thus, Lemma 15 holds in Case 1.

M, i.e.,

Case 2: Suppose that (cid:12)(cid:12)∂β(cid:0)^P − Py(cid:1) (y)(cid:12)(cid:12) > M0(cid:0)ǫ−1δQ(cid:1)m−|β|
(21) maxβ∈M(cid:0)ǫ−1δQ(cid:1)|β|(cid:12)(cid:12)∂β(cid:0)^P − Py(cid:1) (y)(cid:12)(cid:12) > M0(cid:0)ǫ−1δQ(cid:1)m

From (11) we have

for some β ∈

.

(22) ^P ∈ Γl(A)−3 (y, AM0).

Since Γl(A)−1(x, M) ⊆ Γl(A)−3 (x, M) for all x ∈ E, M > 0, (10) implies that

(23) ~Γl(A)−3 has an (cid:0)A, ǫ−1δQ, C(cid:1)-basis at (y, M0, Py).

As in Case 1,

(24) ~Γl(A)−3 is (C, δmax)-convex,

and

(25) ǫ−1δQ ≤ ǫ−1δQ0 ≤ δmax.

From (8) and (13) we have

(26) ∂β(cid:0)^P − Py(cid:1) ≡ 0 for β ∈ A.

43

Thanks to (21)· · · (26) and Lemma 8 there exist A# ⊆ M and P# ∈ P with
the following properties: A# is monotonic; A# < A (strict inequality); ~Γl(A)−3
has an (A#, ǫ−1δQ, C(A))-basis at (y, M0, P#); ∂β(P# − Py) ≡ 0 for β ∈ A;
|∂β(P# − Py)(y)| ≤ M0(ǫ−1δQ)m−|β| for β ∈ M.

Thus, A# and P# satisfy (4)· · · (7), proving Lemma 15 in Case 2.
We have seen that Lemma 15 holds in all cases.

Remarks

• The analysis of Case 2 in the proof of Lemma 15 is a new
ingredient, with no analogue in our previous work on Whitney problems.

• The proof of Lemma 15 gives a ^P that satisﬁes also ∂β(^P − P0) ≡ 0 for

β ∈ A, but we make no use of that.

• Note that x0 and δQ0 appear in (12), rather than the desired y, δQ. Con-

sequently, (12) is of no help in the proof of Lemma 15.

In the proof of our next result, we use our Induction Hypothesis that the
Main Lemma for A′ holds whenever A′ < A and A′ is monotonic. (See Section
II.3.)

Lemma 16 Let Q ∈ CZ. Suppose that

(27) 65

64 Q ∩ 65

64 Q0 6= ∅

and

(28) # (E ∩ 5Q) ≥ 2.

Let

(29) y ∈ E ∩ 5Q.

Then there exists Fy,Q ∈ Cm( 65

64 Q) such that

(*1) (cid:12)(cid:12)∂β(cid:0)Fy,Q − Py(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|
(*2) Jz(cid:0)Fy,Q(cid:1) ∈ Γ0 (z, C (ǫ) M0) for all z ∈ E ∩ 65

on 65

Q

64 Q, for |β| ≤ m; and

64 Q.

Proof. Our hypotheses (27), (28), (29) are precisely the hypotheses of Lemma
15. Let A#, P# satisfy the conclusions (4)· · · (7) of that Lemma. Recall the
deﬁnition of l(A); see (1), (2) in Section II.1. We have l(A#) ≤ l(A) − 3 since
A# < A; hence (6) implies that

(30) ~Γl(A#) has an (cid:0)A#, ǫ−1δQ, C (A)(cid:1)-basis at (cid:0)y, M0, P#(cid:1).

Also, since Q is OK, we have 5Q ⊆ 5Q0, hence δQ ≤ δQ0 . Hence, hypothesis

(A2) of the Main Lemma for A implies that

(31) ǫ−1δQ ≤ δmax.

44

By (4), (5), and our Inductive Hypothesis, the Main Lemma holds for A#.
Thanks to (29), (30), (31) and the Small ǫ Assumption in Section II.3, the Main

Lemma for A# now yields a function F ∈ Cm(cid:0) 65
(32) (cid:12)(cid:12)∂β(cid:0)F − P#(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

(33) Jz (F) ∈ Γ0 (z, C (ǫ) M0) for all z ∈ E ∩ 65

on 65

Q

64 Q.

64 Q(cid:1), such that

64 Q, for |β| ≤ m; and

Thanks to conclusion (7) of Lemma 15 (together with (29)), we have also

(34) (cid:12)(cid:12)∂β(cid:0)P# − Py(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Q

on 65

64 Q for |β| ≤ m.

(Recall that P# − Py is a polynomial of degree at most m − 1.) Taking
Fy,Q = F, we may read oﬀ the desired conclusions (*1) and (*2) from (32), (33),
(34).

The proof of Lemma 16 is complete.

II.7 Local Interpolants

In this section, we again place ourselves in the setting of Section II.3. We make
use of the Calder´on-Zygmund cubes Q and the auxiliary polynomials Py deﬁned
above. Let

64 Q ∩ 65

(1) Q =(cid:8)Q ∈ CZ : 65
For each Q ∈ Q, we deﬁne a function FQ ∈ Cm(cid:0) 65

PQ ∈ P. We proceed by cases. We say that Q ∈ Q is

64 Q0 6= ∅(cid:9).

64 Q(cid:1) and a polynomial

Type 1 if #(E ∩ 5Q) ≥ 2,

Type 2 if #(E ∩ 5Q) = 1,

Type 3 if #(E ∩ 5Q) = 0 and δQ ≤ 1

1024 δQ0, and

Type 4 if #(E ∩ 5Q) = 0 and δQ > 1

1024 δQ0.

If Q is of Type 1, then we pick a point yQ ∈ E ∩ 5Q, and set PQ = PyQ.

Applying Lemma 16, we obtain a function FQ ∈ Cm(cid:0) 65
(2) (cid:12)(cid:12)∂β(cid:0)FQ − PQ(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|
(3) Jz(cid:0)FQ(cid:1) ∈ Γ0 (z, C (ǫ) M0) for all z ∈ E ∩ 65

on 65

64 Q.

Q

64 Q(cid:1) such that

64 Q, for |β| ≤ m; and

If Q is of Type 2, then we let yQ be the one and only point of E ∩ 5Q, and
64 Q then (3) holds

deﬁne FQ = PQ = PyQ. Then (2) holds trivially. If yQ 6∈ 65
vacuously.

45

If yQ ∈ 65

64 Q, then (3) asserts that PyQ ∈ Γ0 (yQ, C (ǫ) M0). Thanks to (2)
in Section II.5, we know that PyQ ∈ Γl(A)−1 (yQ, CM0) ⊂ Γ0 (yQ, C (ǫ) M0).
Thus, (2) and (3) hold also when Q is of Type 2.

1

If Q is of Type 3, then 5Q+ ⊂ 5Q0, since 65

64 Q0 6= ∅ and δQ ≤
1024 δQ0. However, Q+ cannot be OK, since Q is a CZ cube. Therefore
# (E ∩ 5Q+) ≥ 2. We pick yQ ∈ E ∩ 5Q+, and set FQ = PQ = PyQ. Then
(2) holds trivially, and (3) holds vacuously.

64 Q ∩ 65

If Q is of Type 4, then we set FQ = PQ = P0, and again (2) holds trivially,

and (3) holds vacuously.

Note that if Q is of Type 1, 2, or 3, then we have deﬁned a point yQ, and

we have PQ = PyQ and

(4) yQ ∈ E ∩ 5Q+ ∩ 5Q0.

(If Q is of Type 1 or 2, then yQ ∈ E ∩ 5Q and 5Q ⊆ 5Q0 since Q is OK. If
Q is of Type 3, then yQ ∈ E ∩ 5Q+ and 5Q+ ⊂ 5Q0). We have picked FQ and
PQ for all Q ∈ Q, and (2), (3) hold in all cases.

Lemma 17 (“Consistency of the PQ”) Let Q, Q′ ∈ Q, and suppose 65
65
64 Q′ 6= ∅. Then

64 Q ∩

(5) (cid:12)(cid:12)(cid:12)

∂β(cid:16)PQ − PQ′(cid:17)(cid:12)(cid:12)(cid:12)

≤ C (ǫ) M0δm−|β|

Q

on 65

64 Q ∩ 65

64 Q′, for |β| ≤ m.

Proof. Suppose ﬁrst that neither Q nor Q′ is Type 4. Then PQ = PyQ and
= PyQ′ with yQ ∈ E ∩ 5Q+ ∩ 5Q0, yQ′ ∈ E ∩ 5 (Q′)+ ∩ 5Q0. Thanks to
PQ′
Lemma 14, we have

(cid:12)(cid:12)(cid:12)

∂β(cid:16)PQ − PQ′(cid:17) (yQ)(cid:12)(cid:12)(cid:12)

≤ C (ǫ) M0δm−|β|

Q

for β ∈ M,

which implies (5), since yQ ∈ 5Q+ and PQ − PQ′
polynomial.

is an (m − 1)rst degree

Next, suppose that Q and Q′ are both Type 4.
Then by deﬁnition PQ = PQ′
Finally, suppose that exactly one of Q, Q′ is of Type 4.
Since δQ and δQ′ , diﬀer by at most a factor of 2, the cubes Q and Q′ may
be interchanged without loss of generality. Hence, we may assume that Q′ is of
Type 4 and Q is not. By deﬁnition of Type 4,

= P0, and consequently (5) holds trivially.

(6) δQ′ > 1

1024 δQ0 ; hence also δQ ≥ 1

1024 δQ0,

since δQ, δQ′, are powers of 2 that diﬀer by at most a factor of 2.
Since Q′ is of Type 4 and Q is not, we have PQ = PyQ and PQ′

= P0, with

(7) yQ ∈ E ∩ 5Q+ ∩ 5Q0.

Thus, in this case, (5) asserts that

46

However, by (7) above, property (3) in Section II.5 gives the estimate

Q

(8) (cid:12)(cid:12)∂β(cid:0)PyQ − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|
(9) (cid:12)(cid:12)∂β(cid:0)PyQ − P0(cid:1) (x0)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Q0

on 65

64 Q ∩ 65

64 Q′, for |β| ≤ m.

for |β| ≤ m − 1.

Recall from the hypotheses of the Main Lemma for A that x0 ∈ 5 (Q0)+.
Since PyQ − P0 is an (m − 1)rst degree polynomial, we conclude from (9) that

(10) (cid:12)(cid:12)∂β(cid:0)PyQ − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Q0

all cases.

on 5Q, for |β| ≤ m.

The desired inequality (8) now follows from (6) and (10). Thus, (5) holds in

The proof of Lemma 17 is complete.
From estimate (2), Lemma 11 and Lemma 17, we immediately obtain the

following.

Corollary 2 Let Q, Q′ ∈ Q and suppose that 65

64 Q ∩ 65

64 Q′ 6= ∅. Then

≤ C (ǫ) M0δm−|β|

Q

on 65

64 Q ∩ 65

64 Q′, for |β| ≤ m.

Regarding the polynomials PQ, we make the following simple observation.

(11) (cid:12)(cid:12)(cid:12)

∂β(cid:16)FQ − FQ′(cid:17)(cid:12)(cid:12)(cid:12)

Lemma 18 We have

(12) (cid:12)(cid:12)∂β(cid:0)PQ − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Q0

Proof. Recall that if Q is of Type 1, 2, or 3, then PQ = PyQ for some yQ ∈
E ∩ 5Q0. From estimate (3) in Section II.5, we know that

on 65

64 Q, for |β| ≤ m and Q ∈ Q.

for |β| ≤ m − 1.

(13) (cid:12)(cid:12)∂β(cid:0)PQ − P0(cid:1) (x0)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Since x0 ∈ 5Q+

Q0

is a polynomial of degree at most m − 1, and since 65
Q is OK), estimate (13) implies the desired estimate (12).

0 (see the hypotheses of the Main Lemma for A) and PQ − P0
64 Q ⊂ 5Q ⊂ 5Q0 (because

If instead, Q is of Type 4, then by deﬁnition PQ = P0, hence estimate (12)

holds trivially.

Thus, (12) holds in all cases.

Corollary 3 For Q ∈ Q and |β| ≤ m, we have(cid:12)(cid:12)∂β(cid:0)FQ − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

on 65

64 Q.

Q0

Proof. Recall that, since Q is OK, we have 5Q ⊂ 5Q0. The desired estimate
therefore follows from estimates (2) and (12).

47

II.8 Completing the Induction

We again place ourselves in the setting of Section II.3. We use the CZ cubes Q
and the functions FQ deﬁned above. We recall several basic results from earlier
sections.

(1) ~Γ0 is a (C, δmax)-convex shape ﬁeld.

(2) ǫ−1δQ0 ≤ δmax, hence ǫ−1δQ ≤ δmax for Q ∈ CZ.

(3) The cubes Q ∈ CZ partition the interior of 5Q0.

(4) For Q, Q′ ∈ CZ, if 65

64 Q ∩ 65

64 Q′ 6= ∅, then 1

2 δQ ≤ δQ′ ≤ 2δQ.

Let

(5) Q =(cid:8)Q ∈ CZ : 65

Then

64 Q ∩ 65

64 Q0 6= ∅(cid:9).

(6) Q is ﬁnite.

For each Q ∈ Q, we have

64 Q(cid:1),

(7) FQ ∈ Cm(cid:0) 65
(8) Jz(cid:0)FQ(cid:1) ∈ Γ0 (z, C (ǫ) M0) for z ∈ E ∩ 65
(9) (cid:12)(cid:12)∂β(cid:0)FQ − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|
64 Q′ 6= ∅, then(cid:12)(cid:12)(cid:12)

64 Q′, for |β| ≤ m.

(10) For each Q, Q′ ∈ Q, if 65

64 Q ∩ 65

64 Q∩ 65

on 65

on 65

Q0

64 Q, and

64 Q, for |β| ≤ m.

≤ C (ǫ) M0δm−|β|

Q

∂β(cid:16)FQ − FQ′(cid:17)(cid:12)(cid:12)(cid:12)

Set

≤ Cδ

−|β|
Q for |β| ≤ m.

We introduce a Whitney partition of unity adapted to the cubes Q ∈ CZ.
64 Q,

For each Q ∈ CZ, let ˜θQ ∈ Cm (Rn) satisfy ˜θQ = 1 on Q, support(cid:16)˜θQ(cid:17) ⊂ 65
(cid:12)(cid:12)(cid:12)
∂β˜θQ(cid:12)(cid:12)(cid:12)
(11) θQ = ˜θQ ·(cid:18)PQ′∈CZ(cid:16)˜θQ′(cid:17)2(cid:19)−1/2
(12) PQ∈Q θ2
(13) F =PQ∈Q θ2

Note that we have

Q = 1 on 65

We deﬁne

64 Q0.

QFQ.

.

48

For each Q ∈ Q, (7), (11) show that θ2

QFQ ∈ Cm (Rn). Since also Q is ﬁnite

(see (6)), it follows that

(14) F ∈ Cm (Rn).

Moreover, for any x ∈ 65

64 Q0 and any β of order |β| ≤ m, we have

QFQ(cid:11), where
(15) ∂βF (x) =PQ∈Q(x) ∂β(cid:10)θ2
64 Q(cid:9).
(16) Q (x) =(cid:8)Q ∈ Q : x ∈ 65

Note that

(17) # (Q (x)) ≤ C, by (4).

Let ^Q be the CZ cube containing x. (There is one and only one such cube,
64 Q0.) Then ^Q ∈ Q(x), and (15)

thanks to (3); recall that we suppose that x ∈ 65
may be written in the form

(18) ∂β(cid:0)F − P0(cid:1) (x) = ∂β(cid:16)F

^Q − P0(cid:17) (x) +PQ∈Q(x) ∂β(cid:10)θ2

Q ·(cid:16)FQ − F

^Q(cid:17)(cid:11) (x).

(Here we use (12).) The ﬁrst term on the right in (18) has absolute value at
; see (9). At most C distinct cubes Q enter into the second

most C (ǫ) M0δm−|β|
term on the right in (18); see (17). For each Q ∈ Q(x), we have

Q0

by (10) and (11). Hence, for each Q ∈ Q(x), we have

∂β(cid:10)θ2
(cid:12)(cid:12)(cid:12)
∂β(cid:10)θ2
(cid:12)(cid:12)(cid:12)

Q ·(cid:16)FQ − F

Q ·(cid:16)FQ − F

^Q(cid:17)(cid:11) (x)(cid:12)(cid:12)(cid:12)
^Q(cid:17)(cid:11) (x)(cid:12)(cid:12)(cid:12)

≤ C (ǫ) M0δm−|β|

Q

,

≤ C (ǫ) M0δm−|β|

Q0

;

see (3).

The above remarks and (18) together yield the estimate

(19) (cid:12)(cid:12)∂β(cid:0)F − P0(cid:1)(cid:12)(cid:12) ≤ C (ǫ) M0δm−|β|

Moreover, let z ∈ E ∩ 65

64 Q0. Then

Q0

on 65

64 Q0, for |β| ≤ m.

Jz (F) = XQ∈Q(z)
(cid:12)(cid:12)∂β [Jz (θQ)] (z)(cid:12)(cid:12) ≤ Cδ
XQ∈Q(z)

Jz (θQ) ⊙z Jz (θQ) ⊙z Jz(cid:0)FQ(cid:1) (see (15));

−|β|
Q for |β| ≤ m − 1, Q ∈ Q (z) (see (11));

[Jz (θQ)] ⊙z [Jz (θQ)] = 1

49

(see (12) and note that Jz(θQ) = 0 for Q 6∈ Q(z) by (11) and (16));

Jz(cid:0)FQ(cid:1) ∈ Γ0 (z, C (ǫ) M0) for Q ∈ Q (z) (see (8));
∂β(cid:10)Jz(cid:0)FQ(cid:1) − Jz(cid:16)FQ′(cid:17)(cid:11) (z)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

≤ C (ǫ) M0δm−|β|

Q

for |β| ≤ m − 1, Q, Q′ ∈ Q (z) (see (10)); # (Q (z)) ≤ C (see (17)); δQ ≤ δmax
(see (2)); ~Γ0 is a (C, δmax)-convex shape ﬁeld (see (1)).

The above results, together with Lemma 2, tell us that

(20) Jz (F) ∈ Γ0 (z, C (ǫ) M0) for all z ∈ E ∩ 65

64 Q0.

From (14), (19), (20), we see at once that the restriction of F to 65

64 Q0

belongs to Cm(cid:0) 65
As we explained in that section, once we have found a function in Cm(cid:0) 65

64 Q0(cid:1) and satisﬁes conditions (C*1) and (C*2) in Section II.3.
64 Q0(cid:1)

satisfying (C*1) and (C*2), our induction on A is complete. Thus, we have
proven the Main Lemma for all monotonic A ⊆ M. (cid:4)

II.9 Restatement of the Main Lemma

An equivalent version of the Main Lemma for A = ∅ reads as follows.
Restated Main Lemma Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a (Cw, δmax)-convex
shape ﬁeld. For l ≥ 1, let ~Γl = (Γl (x, M))x∈E,M>0 be the lth-reﬁnement of ~Γ0.
Fix a dyadic cube Q0 of sidelength δQ0 ≤ ǫδmax, where ǫ > 0 is a small enough
constant determined by m, n, Cw. Let x0 ∈ E∩5Q+
0 , and let P0 ∈ Γl(∅) (x0, M0).

Then there exists a function F ∈ Cm(cid:0) 65
• (cid:12)(cid:12)∂β (F − P0) (x)(cid:12)(cid:12) ≤ C∗M0δm−|β|

• Jz (F) ∈ Γ0 (z, C∗M0) for all z ∈ E ∩ 65

Q0

64 Q0;

64 Q0(cid:1), satisfying

for x ∈ 65

64 Q0, |β| ≤ m; and

where C∗ is determined by Cw, m, n.

II.10 Tidying Up

In this section, we remove from the Restated Main Lemma the small constant
ǫ and the assumption that Q0 is dyadic.
Theorem 5 Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a (Cw, δmax)-convex shape ﬁeld.
For l ≥ 1, let ~Γl = (Γl (x, M))x∈E,M>0 be the lth-reﬁnement of ~Γ0. Fix a cube
Q0 of sidelength δQ0 ≤ δmax, a point x0 ∈ E ∩ 5Q0, and a real number M0 > 0.
Let P0 ∈ Γl(∅)+1 (x0, M0).

Then there exists a function F ∈ Cm (Q0) satisfying the following, with C∗

determined by Cw, m, n.

50

• (cid:12)(cid:12)∂β (F − P0) (x)(cid:12)(cid:12) ≤ C∗M0δm−|β|

• Jz (F) ∈ Γ0 (z, C∗M0) for all z ∈ E ∩ Q0.

Q0

for x ∈ Q0, |β| ≤ m; and

Sketch of Proof. Let ǫ > 0 be the small constant in the statement of the
Restated Main Lemma in Section II.9. In particular, ǫ is determined by Cw,
m, n. We write c, C, C′, etc., to denote constants determined by Cw, m, n.
These symbols may denote diﬀerent constants in diﬀerent occurrences.

We cover CQ0 by a grid of dyadic cubes {Qν}, all having the same sidelength

δQν, with ǫ

20 δQ0 ≤ δQν ≤ ǫδQ0, and all contained in C′Q0.
64 Qν 6= ∅, we pick a point xν ∈ E∩ 65

For each Qν with E∩ 65

64 Qν; by deﬁnition

Q0

for β ∈ M.

CM0δm−|β|

Since xν ∈ E ∩ 65

64 Qν, Pν ∈ Γl(∅), and δQν ≤ ǫδQ0 ≤ ǫδmax, the Restated

of the lth-reﬁnement, there exists Pν ∈ Γl(∅)(xν, M0) such that(cid:12)(cid:12)∂β (Pν − P0) (x0)(cid:12)(cid:12) ≤
Main Lemma applies to xν, Pν, Qν to produce Fν ∈ Cm(cid:0) 65
(1) (cid:12)(cid:12)∂β (Fν − Pν) (x)(cid:12)(cid:12) ≤ CM0δm−|β|

64 Qν(cid:1) satisfying

64 Qν, |β| ≤ m;

≤ CM0δm−|β|

Qν

Q0

for x ∈ 65

and

(2) Jz (Fν) ∈ Γ0 (z, CM0) for all z ∈ E ∩ 65

64 Qν.

E ∩ 65

We have produced such Fν for those ν satisfying E ∩ 65
64 Qν = ∅, then we set Fν = P0.
Next, we introduce a partition of unity. We ﬁx cutoﬀ functions θν ∈ Cm (Rn)

64 Qν 6= ∅. If instead

satisfying

(3) support θν ⊂ 65

64 Qν, (cid:12)(cid:12)∂βθν(cid:12)(cid:12) ≤ Cδ

−|β|
Q0

for |β| ≤ m,Pν θ2

ν = 1 on Q0.

We then deﬁne

(4) F =Pν θ2

νFν on Q0.

One checks easily that F satisﬁes the conclusions of Theorem 5.

Part III
Applications

III.1 Finiteness Principle I

In this section we prove a ﬁniteness principle for shape ﬁelds.

Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a shape ﬁeld. For l ≥ 1, let ~Γl = (Γl (x, M))x∈E,M>0

be the lth-reﬁnement of ~Γ0. Fix M0 > 0. For x ∈ E, S ⊂ E, deﬁne

51

(1) Γ (x, S) =(cid:14) Px : ~P = (Py)y∈S∪{x} ∈ Wh (S ∪ {x}) , (cid:13)(cid:13)(cid:13)

Py ∈ Γ0 (y, M0) for all y ∈ S ∪ {x} .

~P(cid:13)(cid:13)(cid:13) ˙Cm(S∪{x})

(See Section I.1 for the deﬁnition of Wh(·) and || · || ˙Cm(·).) Note that

≤ M0,

(cid:15)

(2) Γ (x, ∅) = Γ0 (x, M0).

Deﬁne

(3) Γ fp

l

(x, M0) =TS⊂E,#(S)≤(D+2)l Γ (x, S) for l ≥ 0, where

(4) D = dim P.

Note that

(5) Γ fp

0 (x, M0) ⊆ Γ0 (x, M0), thanks to (2).

Each Γ (x, S), Γ fp
(x, M0) is a (possibly empty) convex subset of P.
As a consequence of Helly’s theorem, we have the following result.

l

Lemma 19 Let x ∈ E, l ≥ 0. Suppose Γ (x, S) 6= ∅ for all S ⊂ E with # (S) ≤
(D + 2)l+1. Then Γ fp

(x, M0) 6= ∅.

l

Lemma 20 For x ∈ E, l ≥ 0, we have

(6) Γ fp

l

(x, M0) ⊆ Γl (x, M0).

Proof. We use induction on l. The base case l = 0 is our observation (5). For
the induction step, ﬁx l ≥ 1. We will prove (6) under the inductive assumption

(7) Γ fp

l−1 (y, M0) ⊆ Γl−1 (y, M0) for all y ∈ E.

Thus, let P ∈ Γ fp

l

(x, M0) be given. We must prove that P ∈ Γl (x, M0),

which means that given y ∈ E there exists

m − 1.

We will prove that there exists

(8) P′ ∈ Γl−1 (y, M0) such that (cid:12)(cid:12)∂β (P − P′) (x)(cid:12)(cid:12) ≤ M0 |x − y|m−|β| for |β| ≤
l−1 (y, M0) such that (cid:12)(cid:12)∂β (P − P′) (x)(cid:12)(cid:12) ≤ M0 |x − y|m−|β| for |β| ≤

(9) P′ ∈ Γ fp

Thanks to our inductive hypothesis (7), we see that (9) implies (8). There-
fore, to complete the proof of the Lemma, it is enough to prove the existence of
a P′ satisfying (9). For S ⊂ E, deﬁne

m − 1.

^Γ (S) =(cid:14) Py : ~P = (Pz)z∈S∪{x,y} ∈ Wh (S ∪ {x, y}) , Px = P,(cid:13)(cid:13)(cid:13)

Pz ∈ Γ0 (z, M0) for all z ∈ S ∪ {x, y} .

~P(cid:13)(cid:13)(cid:13) ˙Cm(S∪{x,y})

By deﬁnition,

≤ M0,

(cid:15)

52

(10) ^Γ (S) ⊂ Γ (y, S) for S ⊂ E.

Let S1, · · · , SD+1 ⊂ E with # (Si) ≤ (D + 2)l−1 for each i.
Then ^Γ (S1)∩· · ·∩^Γ (SD+1) ⊃ ^Γ (S1 ∪ · · · ∪ SD+1), and # (S1 ∪ · · · ∪ SD+1 ∪ {y}) ≤

(D + 1) (D + 2)l−1 + 1 ≤ (D + 2)l. Since P ∈ Γ fp
it follows that
there exists ~P = (Pz)z∈S1∪···∪SD+1∪{x,y} ∈ Wh (S1 ∪ · · · ∪ SD+1 ∪ {x, y}) such
≤ M0, Pz ∈ Γ0 (z, M0) for all z ∈
S1 ∪ · · · ∪ SD+1 ∪ {x, y}. We then have Py ∈ ^Γ (S1 ∪ · · · ∪ SD+1), hence ^Γ (S1) ∩
· · · ∩ ^Γ (SD+1) ⊃ ^Γ (S1 ∪ · · · ∪ SD+1) 6= ∅.

~P(cid:13)(cid:13)(cid:13) ˙Cm(S1∪···∪SD+1∪{x,y})

that Px = P, (cid:13)(cid:13)(cid:13)

(x, M0),

l

By Helly’s theorem, there exists

(11) P′ ∈TS⊂E,#(S)≤(D+2)l−1 ^Γ (S).

In particular, P′ ∈ ^Γ (∅), which implies that

(cid:12)(cid:12)∂β (P − P′) (x)(cid:12)(cid:12) ≤ M0 |x − y|m−|β| for |β| ≤ m − 1.

Also, (10), (11) imply that

P′ ∈

\

S⊂E,#(S)≤(D+2)l−1

Γ (y, S) = Γ fp

l−1 (y, M0) .

Thus, P′ satisﬁes (9), completing the proof of Lemma 20.

Theorem 6 (Finiteness Principle for Shape Fields) For a large enough
k# determined by m, n, the following holds. Let ~Γ0 = (Γ0 (x, M))x∈E,M>0
be a (Cw, δmax)-convex shape ﬁeld and let Q0 ⊂ Rn be a cube of sidelength
δQ0 ≤ δmax. Also, let x0 ∈ E ∩ 5Q0 and M0 > 0 be given. Assume that for each
S ⊂ E with # (S) ≤ k# there exists a Whitney ﬁeld ~PS = (Pz)z∈S such that

and

≤ M0,

(cid:13)(cid:13)(cid:13)
~PS(cid:13)(cid:13)(cid:13) ˙Cm(S)

Pz ∈ Γ0 (z, M0) for all z ∈ S.

Then there exist P0 ∈ Γ0 (x0, M0) and F ∈ Cm (Q0) such that the following hold,
with a constant C∗ determined by Cw, m, n:

• Jz(F) ∈ Γ0 (z, C∗M0) for all z ∈ E ∩ Q0.

• |∂β(cid:0)F − P0(cid:1) (x) | ≤ C∗M0δm−|β|
• In particular, (cid:12)(cid:12)∂βF (x)(cid:12)(cid:12) ≤ C∗M0 for all x ∈ Q0, |β| = m.

for all x ∈ Q0, |β| ≤ m.

Q0

53

Proof. For l ≥ 1, deﬁne ~Γl = (Γl (x, M))x∈E,M>0 and ~Γ fp
as in Lemmas 19 and 20. We take l∗ = 100+l (∅) and k# = 100+(D + 2)l∗+100.
(For the deﬁnition of l (∅), see Section II.1.)

(x, M)(cid:17)x∈E,M>0

l =(cid:16)Γ fp

l

Lemmas 19 and 20 show that Γ fp
l∗

(x0, M0) is nonempty, hence Γl(∅)+1 (x0, M0)
is nonempty. Pick any P0 ∈ Γl(∅)+1 (x0, M0) ⊂ Γ0 (x0, M0). Then Theorem 5 in
Section II.10 produces a function F ∈ Cm(Q0) with the desired properties.

The ﬁniteness principle for ~Γ = (Γ (x, M))x∈E,M>0 stated in the Introduction

follows easily from Theorem 6, under the following assumptions on ~Γ :

• ~Γ is a (Cw, δmax)-convex shape ﬁeld, with δmax = 1.

• Any P ∈ Γ (x, M) satisﬁes |∂βP(x)| ≤ M for |β| ≤ m − 1.

We have the following corollary to Theorem 6.

Corollary 4 Let Q0 be a cube of sidelength δQ0 ≤ δmax, and let x0 ∈ E ∩ Q0.
Let ~Γ0 = (Γ0(x, M))x∈E,M>0 be a (Cw, δmax)-convex shape ﬁeld, and for l ≥ 1,
let ~Γl = (Γl(x, M))x∈E,M>0 be its lth reﬁnement. Let M0 > 0, and let P0 ∈
Γl∗(x0, M0), where l∗ is a large enough integer constant determined by m and
n.

Then there exists F ∈ Cm(Q0) such that

• |∂αF(x)| ≤ C∗M0 for x ∈ Q0, |α| = m.

• Jx(F) ∈ Γ0 (x, C∗M0) for all x ∈ E ∩ Q0.

• Jx0 (F) = P0.

Here, C∗ depends only on m, n, Cw.

Remark The corollary strengthens Theorem 6, because we now obtain Jx0 (F) =
for |β| ≤ m.
The l∗ here is much bigger than in the proof of Theorem 6; maybe one can do
better than here.

P0 rather than the weaker assertion (cid:12)(cid:12)∂β (F − P0)(cid:12)(cid:12) ≤ C∗M0δm−|β|

Q0

To prove the corollary, we use a simple “clustering lemma”, namely Lemma 3.4

in [12].

Lemma 21 (Clustering Lemma) Let S ⊂ Rn, with 2 ≤ # (S) ≤ k#. Then S
can be partitioned into nonempty subsets S0, S1, · · · , Sνmax , such that #(Sν) <
#(S) for each ν, and dist (Sν, Sµ) ≥ c · diam (S), for µ 6= ν, with c depending
only on k#.

We use Lemma 21 to prove the following lemma.

Lemma 22 Let ~Γ0 = (Γ0 (x, M))x∈E,M>0 be a shape ﬁeld. For l ≥ 1, let ~Γl =
(Γl (x, M))x∈E,M>0 be the lth reﬁnement of ~Γ0. Let l∗ ≥ 1, M0 > 0, x0 ∈ E,

54

and let P0 ∈ Γl∗ (x0, M0). Then for any S ⊂ E with x0 ∈ S and # (S) ≤ l∗, there
exists a Whitney ﬁeld ~PS = (Px)x∈S such that Px ∈ Γ0 (x, C∗M0) for x ∈ S;

(cid:12)(cid:12)∂β (Px − Py) (x)(cid:12)(cid:12) ≤ C∗M0 |x − y|m−β for x, y ∈ S, |β| ≤ m − 1;

and Px0 = P0. Here, C∗ depends only on m, n, l∗.

Proof of Lemma 22.
constant determined by m, n, l∗.

Throughout the proof of Lemma 22, C∗ denotes a

We use induction on l∗.
In the base case, l∗ = 1, so S ≡ {x0}, and we can take our Whitney ﬁeld ~PS

to consist of the single polynomial P0.

For the induction step, we ﬁx l∗ ≥ 2, and make the inductive assumption:
Lemma 22 holds with (l∗ − 1) in place of l∗. We will then prove Lemma 22 for
the given l∗.

Let ~Γl, M0, x0, P0, S be as in the hypotheses of Lemma 22.
If # (S) ≤ l∗ − 1, then the conclusion of Lemma 22 follows instantly from

our inductive assumption. Suppose # (S) = l∗.

Let S0, S1, · · · , Sνmax be a partition of S as in Lemma 21. We may assume
that the Sν are numbered so that x0 ∈ S0. For each ν = 1, · · · , νmax, we pick a
point xν ∈ Sν.

Recall that P0 ∈ Γl∗ (x0, M0). By deﬁnition of the lth reﬁnement, for each

ν = 1, · · · , νmax, there exists

(12) Pν ∈ Γl∗−1 (xν, M0) such that(cid:12)(cid:12)∂β (Pν − P0) (x0)(cid:12)(cid:12) ≤ M0 |xν − x0|m−|β| for

|β| ≤ m − 1.

Fix such Pν for ν = 1, · · · , νmax; and note that (12) holds also for ν = 0.
For each ν = 0, 1, · · · , νmax, we have Pν ∈ Γl∗−1 (xν, M0), xν ∈ Sν ⊂ E, and

# (Sν) ≤ l∗ − 1.

Hence our inductive assumption produces a Whitney ﬁeld ~PSν = (Px

ν)x∈Sν

ν − Py

ν) (x)(cid:12)(cid:12) ≤ C∗M0 |x − y|m−|β|

such that Px
for x, y ∈ Sν, |β| ≤ m − 1, Pxν

ν ∈ Γ0 (x, C∗M0) for x ∈ Sν,(cid:12)(cid:12)∂β (Px

ν = Pν.

We now combine the ~PSν into a single Whitney ﬁeld ~PS = (Px)x∈S by setting
ν for x ∈ Sν. Note that Px ∈ Γ0 (x, C∗M0) for x ∈ S, and that Px0 =

Px = Px
Px0
0 = P0. We check that

(13) (cid:12)(cid:12)∂β (Px − Py) (x)(cid:12)(cid:12) ≤ C∗M0 |x − y|m−|β| for x, y ∈ S, |β| ≤ m − 1.

We already know (13) for x, y belonging to the same Sν.
Suppose x ∈ Sν, y ∈ Sµ with µ 6= ν. Then |x − y| is comparable to diam (S)

so (13) asserts that

(14) (cid:12)(cid:12)∂β (Px − Py) (x)(cid:12)(cid:12) ≤ C∗M0 (diam (S))m−|β| for |β| ≤ m − 1.

We know that

55

(15) (cid:12)(cid:12)∂β (Px − Pν) (xν)(cid:12)(cid:12) =(cid:12)(cid:12)∂β (Px

C∗M0 (diam (S))m−|β| for |β| ≤ m − 1.

ν ) (xν)(cid:12)(cid:12) ≤ C∗M0 |x − xν|m−|β| ≤

ν − Pxν

Similarly,

(16) (cid:12)(cid:12)∂β (Py − Pµ) (xµ)(cid:12)(cid:12) ≤ C∗M0 (diam (S))m−|β| for |β| ≤ m − 1.
(17) Also, (cid:12)(cid:12)∂β (Pν − P0) (x0)(cid:12)(cid:12) ≤ C∗M0 (diam (S))m−|β| for |β| ≤ m − 1, and
(18) (cid:12)(cid:12)∂β (Pµ − P0) (x0)(cid:12)(cid:12) ≤ C∗M0 (diam (S))m−|β| for |β| ≤ m − 1.

Because the points x0, xµ, xν, x all lie in S, the distance between any two

of these points is at most diam (S).

Hence, the estimates (15),· · · ,(18) together imply (14), completing the proof

of (13). This completes our induction on l∗, thus establishing Lemma 22.

Proof of Corollary 4. We set ^Γ =(cid:0)^Γ (x, M)(cid:1)x∈E,M>0, where

^Γ (x, M) =(cid:12) Γ0 (x, M)

{P0}

if x ∈ E \ {x0}
if x = x0

.

One checks trivially that ^Γ is a (Cw, δmax)-convex shape ﬁeld.

By applying Lemma 22 with l∗ = k# + 1 (so that if necessary we can add

x0 into the set S below), we obtain the following conclusion:

(19) Given S ⊂ E with #(S) ≤ k#, there exists a Whitney ﬁeld ~PS = (Px)x∈S

such that Px ∈ ^Γ (x, C∗M0) for x ∈ S, and(cid:12)(cid:12)∂β (Px − Py) (x)(cid:12)(cid:12) ≤ C∗M0 |x − y|m−|β|

for x, y ∈ S, |β| ≤ m − 1.

Here, C∗ depends only on m, n, k#.
For large enough k# depending only on m, n, (19) and Theorem 6 together

imply the conclusion of our corollary.

The proof of Corollary 4 is complete.

III.2 Finiteness Principle II

Proof of Theorem 3 (A). Let us ﬁrst set up notation. We write c, C, C′, etc.,
to denote constants determined by m, n, D; these symbols may denote diﬀerent
constants in diﬀerent occurrences. We will work with Cm vector and scalar-
valued functions on Rn, and also with Cm+1 scalar-valued functions on Rn+D.
We use Roman letters (x, y, z, · · · ) to denote points of Rn, and Greek letters
(ξ, η, ζ, · · · ) to denote points of RD. We denote points of the Rn+D by (x, ξ),
(y, η), etc. As usual, P denotes the vector space of real-valued polynomials of
degree at most m − 1 on Rn. We write P D to denote the direct sum of D copies
of P. If F ∈ Cm−1(Rn, RD) with F(x) = (F1 (x) , · · · , FD (x)) for x ∈ Rn, then
Jx(F) := (Jx (F1) , · · · , Jx (FD)) ∈ P D.

56

We write P + to denote the vector space of real-valued polynomials of degree
(x,ξ)F ∈ P + to

at most m on Rn+D.
denote the mth-degree Taylor polynomial of F at the point (x, ξ) ∈ Rn+D.
When we work with P +, we write ⊙(x,ξ) to denote the multiplication

If F ∈ Cm+1(cid:0)Rn+D(cid:1), then we write J+

P ⊙(x,ξ) Q := J+

(x,ξ) (PQ) ∈ P + for P, Q ∈ P +.

We will use Theorem 6 for Cm+1-functions on Rn+D. (Compare with [17].)
Thus, m + 1 and n + D will play the rˆoles of m, n, respectively, when we apply
that theorem.

We take k# as in Theorem 6, where we use m + 1, n + D in place of m, n,

respectively.

We now introduce the relevant shape ﬁeld.

Let E+ =(cid:8)(x, 0) ∈ Rn+D : x ∈ E(cid:9). For (x0, 0) ∈ E+ and M > 0, let
(1) Γ ((x0, 0) , M) =(cid:14) P ∈ P + : P (x0, 0) = 0, ∇ξP (x0, 0) ∈ K (x0) ,

≤ M for |α| + |β| ≤ m (cid:15) ⊂ P +.

x ∂β
∂α

Let ~Γ = (Γ (x0, 0) , M) (x0,0)∈E+,M>0.

(cid:12)(cid:12)(cid:12)

ξ P (x0, 0)(cid:12)(cid:12)(cid:12)

Lemma 23 ~Γ is a (C, 1)-convex shape ﬁeld.

The proof of the lemma follows easily from the following observation: If
P1, P2 ∈ Γ ((x0, 0) , M) and Q1, Q2 ∈ P +, then P1 (x0, 0) = P2 (x0, 0) = 0, hence
P := Q1 ⊙(x0,0) Q1 ⊙(x0,0) P1 + Q2 ⊙(x0,0) Q2 ⊙(x0,0) P2 satisﬁes P (x0, 0) = 0
and ∇ξP (x0, 0) = (Q1 (x0, 0))2 ∇ξP1 (x0, 0) + (Q2 (x0, 0))2 ∇ξP2 (x0, 0).

Lemma 24 Let S+ ⊂ E+ with # (S+) ≤ k#. Then there exists ~P = (Pz)z∈S+,
with each Pz ∈ P +, such that

(2) Pz ∈ Γ (z, C) for each z ∈ S+, and

(3) (cid:12)(cid:12)(cid:12)

x ∂β
∂α
|β| ≤ m.

ξ (cid:16)Pz − Pz′(cid:17) (z)(cid:12)(cid:12)(cid:12)

≤ C |z − z′|(m+1)−|α|−|β| for z, z′ ∈ S+ and |α| +

Since E+ = E × {0}, we have S+ = S × {0} for an
Proof of Lemma 24.
S ⊂ E with # (S) ≤ k#. By hypothesis of Theorem 3 (A), there exists FS ∈

Cm(cid:0)Rn, RD(cid:1) such that
(4) (cid:13)(cid:13)FS(cid:13)(cid:13)Cm(Rn,RD) ≤ 1 and FS (x0) ∈ K (x0) for all x0 ∈ S.
Let FS (x) =(cid:0)FS
(5) P(x0,0) (x, ξ) =PD

D (x)(cid:1) for x ∈ Rn, and let ~P =(cid:0)P(x0,0)(cid:1)(x0,0)∈S×{0}
i(cid:1) (x)(cid:3) for x ∈ Rn, ξ = (ξ1, · · · , ξD) ∈ RD.

i=1 ξi(cid:2)Jx0(cid:0)FS

1 (x) , · · · , FS

with

57

Each P(x0,0) belongs to P + and satisﬁes

(6) P(x0,0) (x0, 0) = 0, ∇ξP(x0,0) (x0, 0) ∈ K (x0), and

and

≤ C for |α| + |β| ≤ m,

x ∂β
∂α

(7) (cid:12)(cid:12)(cid:12)
ξ P(x0,0) (x0, 0)(cid:12)(cid:12)(cid:12)
x ∂ξj(cid:16)P(x0,0) − P(y0,0)(cid:17) (x0, 0)(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)

∂α

thanks to (4), (5). Our results (6), (7) and deﬁnition (1) together imply (2).
We pass to (3). Let (x0, 0) , (y0, 0) ∈ S+ = S × {0}. From (4), (5), we have

= (cid:12)(cid:12)∂α

x (cid:0)Jx0(cid:0)FS

j(cid:1) − Jy0(cid:0)FS

≤ C |x0 − y0|m−|α|
= C |x0 − y0|(m+1)−(|α|+1)

j(cid:1)(cid:1) (x0)(cid:12)(cid:12)

for |α| ≤ m − 1, j = 1, · · · , D. For |β| 6= 1, we have

x ∂β
∂α

ξ (cid:16)P(x0,0) − P(y0,0)(cid:17) (x0, 0) = 0

by (5). The above remarks imply (3), completing the proof of Lemma 24.

Lemma 25 Given a cube Q ⊂ Rn of sidelength δQ = 1, there exists FQ ∈
Cm(Q, RD) such that

(8) (cid:12)(cid:12)∂αFQ (x)(cid:12)(cid:12) ≤ C for x ∈ Q, |α| ≤ m; and

(9) FQ (z) ∈ K (z) for all z ∈ E ∩ Q.

If E ∩ Q = ∅, then we can just take FQ ≡ 0. Otherwise,
Proof of Lemma 25.
pick x00 ∈ E ∩ Q, let Q′ ∈ RD be a cube of sidelength δQ′ = 1, containing the
origin in its interior, and apply Theorem 6 (with m + 1, n + D in place of m,
n, respectively) to the shape ﬁeld ~Γ = (Γ (x0, 0) , M)(x0,0)∈E+,M>0 given by (1),
the cube Q0 := Q × Q′ ⊂ Rn+D, the point (x00, 0), and the number M0 = C.
Lemmas 23 and 24 tell us that the above data satisfy the hypotheses of

Theorem 6. Applying Theorem 6, we obtain

(10) P0 ∈ Γ ((x00, 0) , C) and F ∈ Cm+1 (Q × Q′) such that

x ∂β
∂α

(11) (cid:12)(cid:12)(cid:12)

(12) J+

ξ (F − P0) (x, ξ)(cid:12)(cid:12)(cid:12)

(z,0) (F) ∈ Γ ((z, 0) , C) for all z ∈ E ∩ Q.

≤ C for |α| + |β| ≤ m + 1 and (x, ξ) ∈ Q × Q′; and

By (10), (12) and deﬁnition (1), we have

(13) (cid:12)(cid:12)(cid:12)

x ∂β
∂α

ξ P0 (x00, 0)(cid:12)(cid:12)(cid:12)

≤ C for |α| + |β| ≤ m

58

and

(14) ∇ξF (z, 0) ∈ K (z) for all z ∈ E ∩ Q.

Since (x00, 0) ∈ Q × Q′ and δQ×Q′ = 1, (13) implies that

≤ C

(cid:12)(cid:12)(cid:12)

x ∂β
∂α

ξ P0 (x, ξ)(cid:12)(cid:12)(cid:12)

for (x, ξ) ∈ Q × Q′, |α| + |β| ≤ m + 1. (Recall that P0 is a polynomial of degree
at most m.) Together with (11), this implies that

x ∂β
∂α

(15) (cid:12)(cid:12)(cid:12)

Taking

ξ F (x, ξ)(cid:12)(cid:12)(cid:12)

≤ C for (x, ξ) ∈ Q × Q′, |α| + |β| ≤ m + 1.

FQ (x) = ∇ξF (x, 0) for x ∈ Q,

we learn from (14), (15) that FQ ∈ Cm(cid:0)Q, RD(cid:1); (cid:12)(cid:12)∂αFQ (x)(cid:12)(cid:12) ≤ C for x ∈ Q,

|α| ≤ m; and FQ (z) ∈ K (z) for all z ∈ E ∩ Q. Thus, FQ satisﬁes (8) and (9),
completing the proof of Lemma 25.

It is now trivial to complete the proof of Theorem 3 (A) by using a partition

of unity on Rn.

Proof of Theorem 3 (B). We write c, C, C′, etc., to denote constants
determined by m, n, D. These symbols may denote diﬀerent constants in
diﬀerent occurrences.

Suppose ﬁrst that E is ﬁnite.
Given FS as in the hypothesis of Theorem 3 (B), set ~P = (Px)x∈S, with

By Whitney’s extension theorem for ﬁnite sets, there exists

Px = Jx(cid:0)FS(cid:1) ∈ P D. Then Px (x) ∈ K (x) for x ∈ S, (cid:12)(cid:12)∂βPx (x)(cid:12)(cid:12) ≤ C for x ∈ S,
|β| ≤ m − 1, and (cid:12)(cid:12)∂β (Px − Py) (x)(cid:12)(cid:12) ≤ C |x − y|m−|β| for x, y ∈ S, |β| ≤ m − 1.
• ˜FS ∈ Cm(cid:0)Rn, RD(cid:1) such that
• (cid:13)(cid:13)(cid:13)
˜FS(cid:13)(cid:13)(cid:13)Cm(Rn,RD)
Jx(cid:16)˜FS(cid:17) = Px for x ∈ S; in particular,

≤ C, and

• ˜FS (x) = FS (x) ∈ K (x) for x ∈ S.

Thanks to the above bullet points, we have satisﬁed the hypotheses of The-

orem 3 (A). Hence, we obtain F ∈ Cm(cid:0)Rn, RD(cid:1) ⊂ Cm−1,1(cid:0)Rn, RD(cid:1) such that

kFkCm−1,1(Rn,RD) ≤ C kFkCm(Rn,RD) ≤ C′, and F (x) ∈ K (x) for each x ∈ E.
Thus, we have proven Theorem 3 (B) in the case of ﬁnite E.

59

Next, suppose E is an arbitrary subset of a cube Q ⊂ Rn. Then

X =(cid:10)F ∈ Cm−1,1(cid:0)Q, RD(cid:1) : kFkCm−1,1(Q,RD) ≤ C(cid:11)

is compact in the topology of the Cm−1(Q, RD)-norm, by Ascoli’s theorem.

For each x ∈ E, let

X(x) = {F ∈ X : F (x) ∈ K (x)} .

Then each X(x) is a closed subset of X, since K(x) ⊂ Rn is closed. Moreover,
given ﬁnitely many points x1, · · · , xN ∈ E, we have X(x1) ∩ · · · ∩ X(xN) 6= ∅,
thanks to Theorem 3 (B) in the known case of ﬁnite sets.

Consequently, Tx∈E X(x) 6= ∅. Thus, there exists F ∈ Cm−1,1(cid:0)Q, RD(cid:1) such

that

(16) kFkCm−1,1(Q,RD) ≤ C and F (x) ∈ K (x) for all x ∈ E.

We have achieved (16) under the assumption E ⊂ Q.
Finally, Theorem 3 (B) for arbitrary E ⊂ Rn follows from the known case

E ⊂ Q by an obvious argument using a partition of unity.

References

[1] Edward Bierstone and Pierre D. Milman. Cm-norms on ﬁnite sets and Cm

extension criteria. Duke Math. J., 137(1):1–18, 2007.

[2] Edward Bierstone, Pierre D. Milman, and Wies law Paw lucki. Diﬀerentiable
Invent. Math.,

functions deﬁned in closed sets. A problem of Whitney.
151(2):329–352, 2003.

[3] Edward Bierstone, Pierre D. Milman, and Wies law Paw lucki. Higher-order
tangents and Feﬀerman’s paper on Whitney’s extension problem. Ann. of
Math. (2), 164(1):361–370, 2006.

[4] Yuri Brudnyi and Pavel Shvartsman. A linear extension operator for a
space of smooth functions deﬁned on a closed subset in Rn. Dokl. Akad.
Nauk SSSR, 280(2):268–272, 1985.

[5] Yuri Brudnyi and Pavel Shvartsman. The traces of diﬀerentiable functions
to subsets of Rn. Linear and complex analysis. Problem book 3. Part II,
Lecture Notes in Mathematics, vol. 1574, Springer-Verlag, Berlin, 1994,
279–281.

[6] Yuri Brudnyi and Pavel Shvartsman. Generalizations of Whitney’s exten-
Internat. Math. Res. Notices, (3):129 ﬀ., approx. 11 pp.

sion theorem.
(electronic), 1994.

60

[7] Yuri Brudnyi and Pavel Shvartsman. The Whitney problem of existence of

a linear extension operator. J. Geom. Anal., 7(4):515–574, 1997.

[8] Yuri Brudnyi and Pavel Shvartsman. The trace of jet space JkΛω to an
arbitrary closed subset of Rn. Trans. Amer. Math. Soc., 350(4):1519–1553,
1998.

[9] Yuri Brudnyi and Pavel Shvartsman. Whitney’s extension problem for
multivariate C1,ω-functions. Trans. Amer. Math. Soc., 353(6):2487–2512
(electronic), 2001.

[10] Charles Feﬀerman. A sharp form of Whitney’s extension theorem. Ann. of

Math. (2), 161(1):509–577, 2005.

[11] Charles Feﬀerman. A generalized sharp Whitney theorem for jets. Rev.

Mat. Iberoamericana, 21(2):577–688, 2005.

[12] Charles Feﬀerman. Whitney’s extension problem for Cm. Ann. of Math.

(2), 164(1):313–359, 2006.

[13] Charles Feﬀerman. Cm extension by linear operators. Ann. of Math. (2),

166(3):779–835, 2007.

[14] Charles Feﬀerman. Whitney’s extension problems and interpolation of

data. Bull. Amer. Math. Soc. (N.S.), 46(2):207–220, 2009.

[15] Charles Feﬀerman and Bo’az Klartag. Fitting a Cm-smooth function to

data. I. Ann. of Math. (2), 169(1):315–346, 2009.

[16] Charles Feﬀerman and Bo’az Klartag. Fitting a Cm-smooth function to

data. II. Rev. Mat. Iberoam., 25(1):49–273, 2009.

[17] Charles Feﬀerman and Garving K. Luli. The Brenner-Hochster-Koll´ar and
Whitney problems for vector-valued functions and jets. Rev. Mat. Iberoam.,
30(3):875–892, 2014.

[18] Charles Feﬀerman, Arie Israel, and Garving K. Luli. Interpolation of data

by smooth non-negative functions. to appear.

[19] Georges Glaeser.

´Etude de quelques alg`ebres tayloriennes. J. Analyse

Math., 6:1–124; erratum, insert to 6 (1958), no. 2, 1958.

[20] Erwan Le Gruyer. Minimal Lipschitz extensions to diﬀerentiable functions

deﬁned on a Hilbert space. Geom. Funct. Anal., 19(4):1101–1118, 2009.

[21] R. Tyrrell Rockafellar. Convex analysis. Princeton Landmarks in Math-
ematics. Princeton University Press, Princeton, NJ, 1997. Reprint of the
1970 original, Princeton Paperbacks.

61

[22] Pavel Shvartsman. The traces of functions of two variables satisfying to
the Zygmund condition. In Studies in the Theory of Functions of Several
Real Variables, (Russian), pages 145–168. Yaroslav. Gos. Univ., Yaroslavl,
1982.

[23] Pavel Shvartsman. Lipschitz sections of set-valued mappings and traces of
functions from the Zygmund class on an arbitrary compactum. Dokl. Akad.
Nauk SSSR, 276(3):559–562, 1984.

[24] Pavel Shvartsman. Lipschitz sections of multivalued mappings. In Studies
in the theory of functions of several real variables (Russian), pages 121–132,
149. Yaroslav. Gos. Univ., Yaroslavl, 1986.

[25] Pavel Shvartsman. Traces of functions of Zygmund class. (Russian) Sibirsk.
Mat. Zh., (5):203–215, 1987. English transl. in Siberian Math. J. 28 (1987),
853–863.

[26] Pavel Shvartsman. K-functionals of weighted Lipschitz spaces and Lipschitz
In Interpolation spaces and related
selections of multivalued mappings.
topics, (Haifa, 1990), 245–268, Israel Math. Conf. Proc., 5, BarIlan Univ.,
Ramat Gan, 1992.

[27] Pavel Shvartsman. On Lipschitz selections of aﬃne-set valued mappings.

Geom. Funct. Anal., 11(4):840–868, 2001.

[28] Pavel Shvartsman. Lipschitz selections of set-valued mappings and Helly’s

theorem. J. Geom. Anal., 12(2):289–324, 2002.

[29] Pavel Shvartsman. Barycentric selectors and a Steiner-type point of a con-

vex body in a Banach space. J. Funct. Anal., 210(1):1–42, 2004.

[30] Pavel Shvartsman. The Whitney extension problem and Lipschitz se-
lections of set-valued mappings in jet-spaces. Trans. Amer. Math. Soc.,
360(10):5529–5550, 2008.

[31] John C. Wells. Diﬀerentiable functions on Banach spaces with Lipschitz

derivatives. J. Diﬀerential Geometry, 8:135–152, 1973.

[32] Hassler Whitney. Analytic extensions of diﬀerentiable functions deﬁned in

closed sets. Trans. Amer. Math. Soc., 36(1):63–89, 1934.

[33] Nahum Zobin. Whitney’s problem on extendability of functions and an

intrinsic metric. Advances in Math., 133(1):96–132, 1998.

[34] Nahum Zobin. Extension of smooth functions from ﬁnitely connected pla-

nar domains. Journal of Geom. Analysis, 9(3):489–509, 1999.

62

Charles Feﬀerman
Aﬃliation: Department of Mathematics, Princeton University, Fine Hall
Washington Road, Princeton, New Jersey, 08544, USA
Email: cf@math.princeton.edu

Arie Israel
Aﬃliation: The University of Texas at Austin, Department of Mathematics,
2515 Speedway Stop C1200, Austin, Texas, 78712-1202, USA
Email: arie@math.utexas.edu

Garving K. Luli
Aﬃliation: Department of Mathematics, University of California, Davis, One
Shields Ave, Davis, California, 95616, USA
Email: kluli@@math.ucdavis.edu

63

