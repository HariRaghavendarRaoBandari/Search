6
1
0
2

 
r
a

 

M
7
1

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
7
2
5
5
0

.

3
0
6
1
:
v
i
X
r
a

Pseudo-real multiplication and an application to

Teichm¨uller curves

Kolja Hept

March 18, 2016

Abstract

In this paper, we classify three-dimensional complex Abelian varieties
isogenous to a product A1 × A2, where one of the factors admits real mul-
tiplication by a real quadratic order OD of discriminant D. We show that
the moduli space X (3)
D of these varieties essentially is the disjoint union
of certain Hilbert modular varieties X (3)
a , each component depending on
the choice of an ideal a of OD. We give an explicit construction of these
varieties.
We show that the boundary of the eigenform locus for pseudo-real
multiplication by an order O in Q(√D) ⊕ Q over geometric genus zero

stable curves is contained in the union of subvarieties deﬁned by equations
involving cross-ratios of projective coordinates. Moreover, restricted to
certain topological types of stable curves relevant to the classiﬁcation of
primitive Teichm¨uller curves, we show that the boundary of the eigenform
locus coincides with the subspace cut out by these cross-ratio equations.
We compute these equations for the example of genus three Prym Teich-
m¨uller curves.

1

Contents

1 Introduction

2 Teichm¨uller curves: state of the art

3 Complete statements of the results

4 Complex Abelian varieties

4.1 Complex tori and Abelian varieties . . . . . . . . . . . . . . . . .
4.2 Symplectic forms . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Quadratic orders and the trace pairing

5.1 Quadratic orders and their ideals . . . . . . . . . . . . . . . . . .
5.2 Symplectic modules over real quadratic orders . . . . . . . . . . .

6 The real multiplication loci in dimension two and three

6.1 The moduli space in dimension two . . . . . . . . . . . . . . . . .
6.2 Counting modular surfaces
. . . . . . . . . . . . . . . . . . . . .
6.3 The moduli space in dimension three . . . . . . . . . . . . . . . .
6.4 The universal family . . . . . . . . . . . . . . . . . . . . . . . . .
6.5 Lower and upper bounds . . . . . . . . . . . . . . . . . . . . . . .
6.6 Level structures . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7 Pseudo-real multiplication, cusps and extension classes

7.1 Pseudo-real multiplication . . . . . . . . . . . . . . . . . . . . . .
7.2 Cusps and symplectic extensions
. . . . . . . . . . . . . . . . . .
7.3 Extension classes and cusp packets . . . . . . . . . . . . . . . . .

3

6

10

15
15
19

25
25
30

37
37
44
46
56
59
64

68
68
71
76

8 Boundary strata

83
8.1 Eigenforms for pseudo-real multiplication . . . . . . . . . . . . .
83
8.2 Lagrangian boundary strata . . . . . . . . . . . . . . . . . . . . .
87
8.3 Families with pseudo-real multiplication . . . . . . . . . . . . . .
89
8.4 Generalized period coordinates . . . . . . . . . . . . . . . . . . .
92
8.5 Admissibility . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
94
8.6 A reformulation of admissibility . . . . . . . . . . . . . . . . . . .
98
8.7 Period coordinates in terms of cross-ratios . . . . . . . . . . . . . 100

9 Prym Teichm¨uller curves

106
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
9.1 Prym varieties
9.2 Cusps of Prym Teichm¨uller curves - an example . . . . . . . . . . 108

10 References

113

2

1

Introduction

Let Mg be the moduli space of Riemann surfaces of a ﬁxed genus g. Teichm¨uller
curves in Mg arise naturally in the study of billiard tables and combine such
various topics as algebraic geometry, ergodic theory, ﬂat geometry and number
theory. Much progress was made in classifying Teichm¨uller curves in the last
two decades. We summarize the state of the art in Section 2. Teichm¨uller curves
can roughly be distinguished by their trace ﬁeld, a totally real number ﬁeld of
degree at most g. Consider the bundle ΩMg → Mg of non-zero holomorphic
one-forms over Mg. If any pair (X, ω) ∈ ΩMg generates a Teichm¨uller curve C,
then by [M¨ol06b] the Jacobian Jac(X) of X lies in the locus of principally polar-
ized Abelian varieties isogenous to a product, where the one factor admits real
multiplication by the trace ﬁeld K = Q(tr(SL(X, ω))) of X (and is consequently
of dimension [K : Q]). If the trace ﬁeld of a Teichm¨uller curve is Q, then the
curve comes from certain covering constructions of a torus.

Now consider the case g = 3. It is shown in [BHM14], that there are only
ﬁnitely many Teichm¨uller curves with [K : Q] = 3. Many partially results are
known for the case [K : Q] = 2. In particular for the Prym eigenform locus, there
are several classiﬁcation statements in [LN14a] and [LN14b] similar to those by
McMullen in the genus two case. Furthermore, it is shown in [ANW13] and
[NW14], that there are only ﬁnitely many Teichm¨uller curves with [K : Q] = 2
in the minimal stratum outside of the Prym eigenform locus.

In this paper, we are dealing with the three-dimensional case where the
trace ﬁeld of (X, ω) ∈ ΩM3 has degree two over Q. Thus A = Jac(X) is
isogenous to a product of an elliptic curve and a complex Abelian surface that
admits real multiplication by a quadratic order OD of some positive, non-square
discriminant D. The choice of such an Abelian subsurface S together with the
choice of real multiplication Q(√D) ֒→ End+(S)⊗Z Q is equivalent to the choice

of an endomorphism

Q(√D) ⊕ Q ֒→ End+(A) ⊗ Q,

what we will call pseudo-real multiplication.

Since we do not want to restrict ourselves to the Prym eigenform locus, the
subvariety of Jac(X) admitting real multiplication can be of any type (1, d).
Our ﬁrst goal will be to classify all three-dimensional complex Abelian varieties

admitting pseudo-real multiplication by a pseudo-cubic numberﬁeld Q(√D)⊕Q

together with the choice of such an endomorphism. We will introduce in Sec-
tion 5.2 a certain condition on d depending on the discriminant D, which we will
call the prime factor condition. Let d ∈ N be relatively prime to the conductor
of D and satisfying the prime factor condition. Then for each ideal a ⊆ OD of
norm d we will construct explicitly a Hilbert modular variety X (3)
a . Denoting by
X (3)
D,d the moduli space of three-dimensional complex Abelian varieties together
with some choice of pseudo-real multiplication by Q(√D)⊕ Q of type (1, d), we

will prove the following theorem.
Theorem 1.1. Let D ∈ N be a non-square discriminant and let d ∈ N be
relatively prime to the conductor of D. Then X (3)
D,d is non-empty if and only if d
satisﬁes the prime factor condition in OD. Moreover, in this case X (3)
D,d consists

3

of the 2s irreducible components X (3)
divisors of d.

a , where s is the number of splitting prime

Let ΩMg → Mg be the bundle of stable forms over the Deligne-Mumford
compactiﬁcation of Mg. If I is a lattice in a totally real number ﬁeld F of de-
gree g, then each boundary stratum S ⊂ Mg(I) of I-weighted geometric genus
zero curves can be embedded into the boundary of ΩMg. Let ΩιRMO be the
locus of stable forms (X, ω) ∈ ΩMg, where ω is some choice of a ι-eigenform
for real multiplication on X by an order O ⊂ F . In [BM12], Bainbridge and
M¨oller gave a certain condition for I-weighted boundary strata called admissi-
bility. They showed that each stable form (X, [ω]) ∈ PΩMg in the boundary of
PΩιRMO lies in the image of some S(h), a certain subvariety of an admissible
boundary stratum S deﬁned by some h ∈ End+
Q (F ). Using the techniques de-
veloped in this paper, we will show that an analogous statement also holds in
the pseudo-cubic case.

Furthermore, Bainbridge and M¨oller deﬁned in [BM12] for the genus three
case the quadratic function Q mapping each x ∈ F to the number N F
Q (x)/x ∈ F .
They showed that an I-weighted boundary stratum with weights w1, ..., wn is
admissible if and only if the set {Q(w1), ..., Q(wn)} is not contained in a closed
half-space of its Q-span.

Using coordinates, we will also deﬁne a quadratic function

Q : Q(√D) ⊕ Q → Q3.

After the preliminary work in the sections before, we can construct this func-
tion precisely in that way, that the analogous statement like in the cubic case
holds. A boundary stratum S of I-weighted stable curves is isomorphic to a
product of certain M0,ni, the moduli spaces of genus zero curves with ni marked
points. Thus each weighted stable curve in S can be represented by projective
coordinates. Using cross-ratios of these coordinates, it is shown in [BM12], that
each subvariety S(h) of an admissible stratum S is cut ot by a single equation
in these cross-ratios. We will show the analogous statement for the stratum of
irreducible stable curves with cross-ratios pij as follows.
Theorem 1.2. Let r = (r1, r2, r3) be a Z-basis of I and let s = (s1, s2, s3) be its
dual basis of I∨ with respect to the pseudo-trace pairing. The subvariety Sr(h)
of the stratum Sr of trinodal curves with weights r is cut out by the equations

pa1
23 · pa2

13 · pa3

12 = exp(−2πi(a1b23 + a2b13 + a3b12)),

where the bij are certain rational numbers deﬁned by h and where (a1, a2, a3)
runs over the integral solutions of

a1s2s3 + a2s1s3 + a3s1s2 = 0.

(1)

Contrary to the cubic case in [BM12], where the subvariety Sr(h) is cut out
by a single equation, note that the Z-module of solutions of Equation (1) may
have rank two, see Example 8.19. This is a consequence of the fact, that in the
pseudo-cubic case the trinodal boundary stratum is in general not a maximal
dimensional boundary stratum. Furthermore, in [BM12] it turns out, that for
genus three, admissibility is also a suﬃcient condition, i.e. that the boundary
of the real multiplication locus is precisely the union of all images in PΩM3 of

4

the varieties S(h), where S runs over all admissible boundary strata. We show
that this statement holds in the pseudo-cubic case at least for those boundary
strata relevant for classifying Teichm¨uller curves.

The quadratic function Q and the cross-ratio equations could be used in fu-
ture work for constructing an algorithm to classify Teichm¨uller curves by their
cusps in a similar spirit as the algorithm given in [BM12]. Fixing the discrim-
inant D and the type (1, d), one ﬁrst uses the function Q to list admissible
bases for all lattices I ⊂ F deﬁning admissible I-weighted boundary strata and
then solve the cross-ratio equations. Presumably, one can use the techniques
from [BHM14], to get a ﬁniteness result for primitive (but not algebraically
primitive) Teichm¨uller curves in M3.
Acknowledgements. This paper is my PhD-thesis at the Goethe Universit¨at
Frankfurt am Main. First of all I would like thank my adivsor Martin M¨oller
for making all this work possible and for his excellent guidance. I am also grate-
ful to my colleagues Matteo Constantini, Quentin Gendron, Thorsten J¨orgens,
S¸evda Kurul, David Torres Teigell and Jonathan Zachhuber for proofreading
this paper. Finally I would like to thank my family, especially my parents, and
my friends for their continuous support.

5

2 Teichm¨uller curves: state of the art

The moduli space Mg of genus g compact Riemann surfaces carries a natural
metric induced by the Teichm¨uller metric on its universal covering orbifold,
the Teichm¨uller space Tg. There is a natural action of SL2(R) on QTg, the
space of genus g marked Riemann surfaces together with a non-zero quadratic
diﬀerential. This action is induced by linear transformations on the quadratic
diﬀerential. Fixing any point (X, q) ∈ QTg, post-composition of A 7→ A.(X, q)
with the forgetful map QTg → Tg factors through the quotient SO2(R)\SL2(R)
and yields an isometric embedding

H = SO2(R)\SL2(R) ֒→ Tg.

Post-composing with the covering map Tg → Mg, we obtain a complex geodesic

f : H → Mg,

and we say that (X, q) generates f (H). Conversely, by a consequence of Teich-
m¨uller’s Theorem, every complex geodesic in Mg is generated by a quadratic
diﬀerential in this way. Of special interests are the complex geodesics gener-
ated by squares of a holomorphic one-form. One reason is, that by [Kra81],
Theorem 1, this happens if and only if the composed map

H → Mg → Ag

is a geodesic (here Mg → Ag denotes the Torelli map), where Ag denotes the
moduli space of g-dimensional, principally polarized Abelian varieties. Another
reason is, that any complex geodesic is commensurable to a complex geodesic
generated by the square of a holomorphic one-form. There is also a natural
action of SL2(R) (respectively GL2(R)) on ΩMg, the space of Riemann surfaces
of genus g together with a non-zero holomorphic one-forms. If (X, q) = (X, ω2)
for some non-zero ω ∈ Ω(X), and setting F (A) = A.(X, ω) for all A ∈ SL(X, ω),
then the diagram

SL2(R)

F−−−−→ ΩMg

H = SO2(R)\SL2(R)

−−−−→ Mg

f

y

y

commutes. Thus one can look at holomorphic one-forms instead of quadratic
diﬀerentials. Any Riemann surface with a holomorphic one-form (X, ω) can
also be seen as a translation surface with singularities. The translation atlas is
given by integrating ω, which allows a geometric approach to this topic. For
this reason, any such pair (X, ω) ∈ ΩMg is called a ﬂat surface.
Teichm¨uller curves. A complex geodesic in Mg, which is simultaneously an
algebraic curve (which is usually not the case), is called a Teichm¨uller curve. It
is well known that a ﬂat surface (X, ω) generates a Teichm¨uller curve if and only
if its GL2(R)-orbit is closed in Mg. Furthermore, (X, ω) generates a Teichm¨uller
curve if and only if Stab(f ) or equivalently its Veech group SL(X, ω) (the image
in SL2(R) of orientation-preserving aﬃne diﬀeomorphisms under the derivative

6

map) is a lattice in SL2(R). Such a ﬂat surface is called a Veech surface. In every
stratum there are inﬁnitely many Teichm¨uller curves, each of them generated
by a torus covering ramiﬁed only over one point (also known as square-tiled
surfaces).

In his famous work [Vee89], Veech constructed ﬁrst examples of Teichm¨uller
curves not of this type. He showed that the Veech group of any translation sur-
face is a discrete subgroup of SL2(R). Moreover, if it is a lattice, then it satisﬁes
the Veech dichotomy: The geodesic ﬂow in any direction is either periodic or
uniquely ergodic. These surfaces with a lattice Veech group became an object
of fruitful research, as they are combining such various topics as algebraic ge-
ometry, ergodic theory, ﬂat geometry, number theory and Teichm¨uller theory.

Primitivity. A compact Riemann surface together with a quadratic diﬀeren-
tial (X, q) (respectively a ﬂat surface (X, ω)) is said to be geometrically primi-
tive, if it is not the pullback of a quadratic diﬀerential (respectively a ﬂat surface)
of lower genus. A complex geodesic is said to be geometrically primitive, if any
one (and thus each) generating diﬀerential is geometrically primitive. M¨oller
showed in [M¨ol06a], Theorem 2.6 that each ﬂat surface (X, ω) is the pullback
of a primitive ﬂat surface (X0, ω0). The primitive ﬂat surface (X0, ω0) is also
unique provided that the genus of X0 is at least two. Moreover, he showed
that (X, ω) and (X0, ω0) are commensurable if (X, ω) generates a Teichm¨uller
curve. Thus, for classiﬁcation of Teichm¨uller curves it makes sense to classify
the primitive ones.

Classiﬁcation. During the last twelve years, much eﬀort was made to classify
all Teichm¨uller curves generated by ﬂat surfaces. A complete classiﬁcation for
primitive Teichm¨uller curves in M2 was achieved by McMullen in a series of pa-
pers in 2003 and 2004 ([McM03], [McM05a], [McM05b], [McM06b]). The central
role here plays the Weierstrass locus WD, where D is a positive discriminant (i.e.
D ≡ 0, 1 mod 4). It consists of those genus two Riemann surfaces X such that
the Jacobian Jac(X) of X admits real multiplication by the real quadratic or-
der OD and such that there exists an eigenform ω ∈ Ω(X) for some choice of real
multiplication which has a double zero. The classiﬁcation can be summarized
as follows.

Theorem A (McMullen). Let D ≥ 5 be a non-square discriminant.

1. If D 6≡ 1 mod 8, then WD is a single primitive Teichm¨uller curve, gen-

erated by a certain L-shaped translation surface.

2. If D ≡ 1 mod 8, then WD consists of two irreducible components, distin-
guished by their spin invariant. Each of the two components is a primitive
Teichm¨uller curve generated by a certain L-shaped translation surface.

3. The regular decagon is an eigenform in ΩM(1, 1) for real multiplication,

and its orbit projects to a primitive Teichm¨uller curve in M2.

These curves are all primitive Teichm¨uller curves in M2, and they are pairwise
diﬀerent.

The curves in WD were indepently discovered by Calta in [Cal04].

7

Figure 1: L-shaped translation surface, opposite edges are identiﬁed

The Prym-eigenform locus. The next step was to look for primitive Te-
ichm¨uller curves in higher genera, using a generalization of WD, namely the
Prym-Weierstrass locus. This locus, denoted by W g
D, is deﬁned to be the locus
of Riemann surfaces X ∈ Mg, such that

1. there is a holomorphic involution τ : X → X, such that the Prym variety

Jac(X)− := (Ω(X)−)∗/H1(X; Z)− ⊂ Jac(X)

has dimension two (where Ω(X)− denotes the eigenspace of τ to the eigen-
value −1),

2. Jac(X)− admits real multiplication by OD, and
3. there exists an eigenform ω ∈ Ω(X)− for some choice of real multiplication

which has only one zero.

D is empty if g /∈ {2, 3, 4, 5}.

By the Riemann-Hurwitz formula, W g
In genus
two, this deﬁnition coincides with the old one, since each genus two Riemann
surface is hyperelliptic. In [McM06a], McMullen constructed inﬁnitely primitive
Teichm¨uller curves contained inSW g
D ⊂ Mg for g ∈ {3, 4, 5}. He also showed
that for D not a square, the locus W g
D is a ﬁnite union of primitive Teichm¨uller
curves.
Removing the ’only one zero’-condition in the deﬁnition of W g
D, we de-
ﬁne ΩE g
D to be the locus of those (X, ω) ∈ ΩMg, such that there is a holomorphic
involution τ : X → X, with Jac(X)− a two-dimensional subvariety of Jac(X)
that admits real multiplication by the quadratic order OD, and such that ω is
in Ω(X)− and an eigenform for some choice of real multiplication. For any par-
tition α = (α1, ..., αk) of 2g − 2, there is the natural stratum ΩMg(α) in ΩMg
consisting of those ﬂat surfaces (X, ω), where ω has exactly k zeroes z1, ..., zk
with zi of multiplicity αi. We set ΩE g
D ∩ ΩMg(α) and ﬁnally we
denote by E g
D respectively ΩE g
D(α) in Mg
under the forgetful map. Note that W g
D(2g − 2) and that the decagon
form in Theorem 2 generates the only primitive Teichm¨uller curve in E 2
D(1, 1).
The trace ﬁeld and splitting varieties. The trace ﬁeld Q(SL(X, ω)) of a
holomorphic form (X, ω) ∈ ΩMg is deﬁned to be the ﬁeld extension of Q gen-
erated by the traces of all the elements in SL(X, ω). By [McM03], Theorem 5.1
we have

D(α) = ΩE g
D(α) the image of ΩE g
D = E g

D respectively E g

[Q(SL(X, ω)) : Q] ≤ g.

8

Flat surfaces (X, ω) with [Q(SL(X, ω)) : Q] = g are called algebraically prim-
itive, and the Teichm¨uller curve generated by such a form is also called alge-
braically primitive. Since the trace ﬁeld is preserved by translation coverings,
each algebraically primitive Teichm¨uller curve is also geometrically primitive.
All the primitive Teichm¨uller curves mentioned above are generated by ﬂat sur-
faces (X, ω), such that Jac(X) is isogenous to a product of Abelian varieties,
and where the one factor admits real multiplication by Q(SL(X, ω)), in these
cases a real quadratic number ﬁeld.

This had to happen, as M¨oller has shown in [M¨ol06b]:

Theorem B (M¨oller). Let (X, ω) ∈ ΩMg be a ﬂat surface generating a Te-
ichm¨uller curve C in Mg. Then we have the following.
1. The trace ﬁeld K = Q(tr(SL(X, ω))) is totally real.
2. The image of C → Ag under the Torelli map is contained in the locus of
Abelian varieties isogenous to A1 × A2, where A1 has dimension [K : Q]
and real multiplication by K. The generating diﬀerential ω ∈ Ω(X) is an
eigenform for real multiplication by K.

Thus, we have three possibilities for a ﬂat surface (X, ω) ∈ ΩM3 generating
a Teichm¨uller curve C. The ﬁrst one is, that the trace ﬁeld K is Q (these
curves are called arithmetic). Then (X, ω) covers a torus, in particular C is
not primitive. The second one is, that K is a totally real cubic number ﬁeld,
i.e. C is algebraically primitive. In [BHM14], Bainbridge, Habegger and M¨oller
have shown that there are only ﬁnitely many algebraically primitive Teichm¨uller
curves in M3. The remaining case, where K is a real quadratic number ﬁeld,
is what we are dealing with in this paper. Therefore, we are interested in
three-dimensional principally polarized complex Abelian varieties isogenous to
a product A1 × A2, where A1 is a one-dimensional polarized complex Abelian
variety of type d and A2 is a two-dimensional polarized complex Abelian variety
of type (1, d) admitting real multilplication by a real quadratic order OD.
Prym-Weierstraß locus.
Theorem C (Lanneau, Nguyen). For D ≥ 17, ΩE 3
D(4) ⊂ ΩM3 is non empty
if and only if D ≡ 0, 1, or 4 mod 8. All the loci ΩE 3
D(4) are pairwise disjoint.
Moreover, for the values 0,1,4 of discriminants, the following dichotomy holds.
Either

In [LN14b], Lanneau and Nguyen proved the following classiﬁcation of the

1. D is odd and then ΩE 3
2. D is even and ΩE 3

D(4) is connected.

D(4) has exactly two connected components,

In addition, each component of ΩE 3
For D < 17, ΩE 3
is connected.

2 (R)-orbit.
D(4) is non-empty if and only if D ∈ {8, 12} and in this case it

D(4) corresponds to a closed GL+

In [LN14a], they showed that the analogous satement holds for the loci
D(1, 1, 2) for D ≥ 8. Note that the Prym variety Jac(X)−
D(2, 2)odd and ΩE 3
ΩE 3
for a genus three Riemann surface always carries a polarization of type (1, 2).
Beyond the curves of Prym loci, there are currently no classiﬁcation results
known for Teichm¨uller curves in genus three that are primitive but not alge-
braically primitive.

9

3 Complete statements of the results

As mentioned at the end of the last section, we are interested in principally
polarized complex Abelian varieties isogenous to a product A1 × A2, where A1
is a one-dimensional polarized complex Abelian variety of type d and A2 is a
two-dimensional polarized complex Abelian variety of type (1, d) admitting real
multilplication by a real quadratic order OD. We will see in Section 7.1, that
this is equivalent to the concept of pseudo-real multiplication.

Moduli-space of Abelian varieties with pseudo-real multiplication.
Our ﬁrst goal is to parameterize all these polarized Abelian varieties together
with a choice of some real multiplication. With this goal in mind, we ﬁrst con-
sider the two-dimensional part. For a non-square discriminant D and d1 | d2 ∈ N
we denote by XD,(d1,d2) the space of all isomorphism classes [(A, H, ρ)], where
(A, H) is a polarized Abelian surface of type (d1, d2) that admits real multipli-
cation by OD and ρ : OD ֒→ End+(A) is some choice of real multiplication. If
d1 = d2 = 1, it is well known that XD,(1,1) is isomorphic to the Hilbert modular
surface

XD = PSL2(OD ⊕ O∨D)\H × H.

The reason that XD,(1,1) consists only of one irreducible component, is that
every rank two symplectic OD-module (the lattice deﬁning the Abelian surface)
is isomorphic to OD ⊕ O∨D, where OD ⊕ O∨D is equipped with the natural trace
pairing. This does not hold in the non-principal case. It turns out that, provided
that the quotient d = d2
is relatively prime to the conductor of D, the lattice
d1
deﬁning the surface is as a symplectic OD-module isomorphic to OD ⊕ 1√D
a for
some ideal a ⊂ OD of norm d1d2. The locus of such Abelian surfaces is denoted
by

Xa ⊂ XD,(d1,d2).

To count the irreducible components of XD,(d1,d2), consider the prime factoriza-
i of d. If d is relatively prime to the conductor of D, then we say that
the pair (d1, d2) satisﬁes the prime factor condition in OD, if the following two
conditions hold.

tionQ pki
1. No pi is inert over Q(√D) and
2. If pi is ramiﬁed over Q(√D), then ki = 1.
In Section 6.1, we use the prime ideal factorization for (d) ⊆ OD to prove

the following.
Theorem 6.6. Let D ∈ N be a non-square discriminant and let d1, d2 ∈ N
with d1 | d2 and d2
relatively prime to the conductor of D. Then XD,(d1,d2)
is non-empty if and only if (d1, d2) satisﬁes the prime factor condition in OD.
In this case XD,(d1,d2) consists of 2s irreducible components Xa, where s is the
number of splitting prime divisors of d2
. For each component Xa deﬁned by the
d1
ideal a, we have an isomorphism

d1

Φ : PSL2(OD ⊕ 1√D

a)\H2 ∼= Xa,

[z] 7→ [(Az, Hz, ρz)]

between the corresponding Hilbert modular surface and Xa.

10

Here we have seen why it makes sense to presuppose that d = d2
d1

is relatively
prime to the conductor of D. Otherwise we would not have a unique prime ideal
factorization for the ideal (d).

Now let us go back to dimension three. Similar to the lower dimensional case
above, we denote by X (3)
D,d the space of all isomorphism classes [(A, H, S, ρ)],
where (A, H) is a principally polarized Abelian variety of dimension three, S is
a two dimensional subvariety of A of type (1, d) and ρ : OD → End(S) is some
choice of real multiplication by OD on S. Again, we require that the degree d is
relatively prime to the conductor of D. We say that (A, H, S, ρ) is of type a for
an ideal a ⊆ OD, if [(S, H|S, ρ)] is in Xa. We denote the locus of such classes
[(A, H, S, ρ)] by

a ⊂ X (3)
X (3)
D,d.

Analogously to the dimension two case, in Section 6.3 we construct for each
z ∈ H3 such a variety (Az, Hz, Sz, ρz) ∈ Xa and get the following theorem.
Theorem 6.16. Let D ∈ N be a non-square discriminant and let d ∈ N be
relatively prime to the conductor of D. Then X (3)
D,d is non-empty if and only
if d satisﬁes the prime factor condition in OD. In this case X (3)
D,d consists of 2s
irreducible components X (3)
a , where s is the number of splitting prime divisors
of d. For each component X (3)
deﬁned by the ideal a we have an isomorphism

a

Φ : ΓD,d(η1, η2)\H3 ∼= X (3)

a ,

[z] 7→ [(Az, Hz, sz, ρz)]

between the corresponding Hilbert modular variety and X (3)
a .

We will give an explicit description of the group Γ = ΓD,d(η1, η2), a ﬁnite-
index subgroup of SL2(OD⊕ 1√D
a)×SL2(Z). Unfortunately, Γ depends not only
on the ideal a, but also on the choice of a Z-basis (η1, η2) of a. Furthermore, Γ
does not have the structure of a direct product. We can construct a universal
family

ΓD,d(η1, η2) ⋉ Z6\(H3 × C3) → X (3)

a

for those components, but for many other problems (like counting the cusps
of Γ\H3) the group is much too unwieldy. Nevertheless, we can give a lower
and an upper bound for Γ (with both inclusions of ﬁnite index), which do not
dependent on any choice of basis and which are direct products. More precisely,
we have the inclusion

SL  1 + a √DOD

1 + a ! × Γ(d) ⊆ ΓD,d(η1, η2) ⊆ SL2(OD ⊕ 1√D

1√D

a2

a) × SL2(Z)

and we interpret the quotients of H3 by these groups as moduli spaces of polar-
ized complex Abelian varieties with real multiplication and certain level struc-
tures.

Generalized period coordinates and cross-ratio equations. Before the
ﬁnal statement in [BHM14] mentioned in the previous section, Bainbridge and
M¨oller have proven in [BM12] the ﬁniteness of algebraically primitive curves

11

in M3 generated by ﬂat surfaces in the stratum ΩM3(3, 1), using a generaliza-
tion of the classical period coordinates.
Let Mg(L) be the space of arithmetic genus g stable curves together with a
Lagrangian marking (weighting) by a rank g free Abelian group L. There is a
natural stratiﬁcation of Mg(L) deﬁned by weight preserving homeomorphisms.
If I is a lattice in a totally real number ﬁeld of degree g, then each boundary
stratum in Mg(L) can be embedded into the boundary of PΩMg, where ΩMg
is the bundle of stable forms over the Deligne-Mumford compactiﬁcation of Mg.
Bainbridge and M¨oller showed that a necessary condition for a boundary point X
for lying in the closure of the real multiplication locus RMO ⊂ Mg in Mg is the
following. There is some subvariety S(h) deﬁned by h ∈ SymQ(F ) of a so-called
admissible I-weighted boundary stratum S ⊂ PΩMg, such that X lies in the
image of S(h) under the forgetful map PΩMg → Mg. They also showed, that
this condition is suﬃcient in genus three.
The key was a description of the closure of the eigenform locus ΩEO (where O
is an order in a totally real number ﬁeld F of degree g) in ΩMg. For any free
Abelian group L of rank g, they constructed a homomorphism

Ψ : SZ(Hom(L, Z)) → Hol∗(Mg(L)),

where SZ(·) denotes the symmetric square and Mg(L) the moduli space of Rie-
mann surfaces together with a Lagrangian marking by L. This homomorphism
can be seen as a coordinate free version of exponentials of the classical period
coordinates. They proved that for each a ∈ SZ(Hom(L, Z)), the function Ψ(a)
extends to a meromorphic function on Mg(L) and computed the orders of van-
ishing.
In genus three, they constructed a quadratic function Q : F → F and showed
that a weighted boundary stratum is admissible if and only if the Q-images of
the weights are not contained in a closed half-space of their Q-span. This geo-
metric condition is called the no-half-space condition. For each n ∈ N, let M0,n
be the moduli space of n labeled points on P1(C). Each I-weighted boundary
stratum S is isomorphic to a product of certain M0,ni, one factor for each ir-
reducible component. Thus, any point of S can be represented by an ordered
tuple of elements in P1(C). They described the function Ψ(a) in terms of cross-
ratios of these projective coordinates, and constructed single explicit equations
cutting out the subvarieties S(h). They used these so-called cross-ratio equa-
tions to prove the ﬁniteness statement for algebraically primitive Teichm¨uller
curves in the stratum ΩM3(3, 1). Moreover, they constructed an algorithm that
searches for possible cusps (necessarily represented by irreducible stable forms)
of algebraically primitive Teichm¨uller curves in the stratum ΩM3(4)hyp. This
algorithm works as follows. Fixing an order O in a totally real cubic number
ﬁeld, ﬁrst one lists all admissible bases of ideals in O. For each admissible basis,
there are just ﬁnitely many irreducible stable forms having these residues and
a single zero. Then one checks, if the cross-ratio equation holds.

Our goal in Section 8 is, to construct analogues for the locus of those genus
three Riemann surfaces X, where Jac(X) admits multiplication by a pseudo-

cubic number ﬁeld F = Q(√D) ⊕ Q. We ﬁrst show that an isomorphism

class of (A, ρ), where ρ is such a choice of pseudo-real multiplication on a
three-dimensional principally polarized Abelian variety, is the same as a class
[(A, H, S, ρ)] in X (3)
D,d. We formulate admissibility for the pseudo-cubic case and

12

give the following necessary condition for lying in the boundary of the pseudo-
real multiplication locus.

Corollary 8.13. Let O be a pseudo-cubic order. Each geometric genus zero
stable curve X ∈ RMO lies in the image under the forgetful map of some
admissible I-weighted boundary stratum S ⊂ M3(I).

We construct a quadratic function Q : F → Q3 and give a similar geometric
reformulation of admissibility as in the cubic case. To be more precise, we deﬁne

Q : F → Q3,

(x, q) 7→

N (√Dx)
tr(x)q
tr(√Dx)q

 .

Then we show the following criterion.

Theorem 8.14. An I-weighted boundary stratum S is admissible if and only
if the set

is not contained in a closed half-space of its Q-span.

Q(S) := {Q(w) : w ∈ Weight(S)}

Then we give also explicit equations in terms of cross-ratios that cut out the
subvarieties S(h) ⊂ S. In the boundary stratum of irreducible stable curves of
geometric genus zero, which we also call the stratum of trinodal type, this is
the following.
Theorem 8.18. Let r = (r1, r2, r3) be a Z-basis of I, let s = (s1, s2, s3) be
its dual basis of I∨ with respect to the pseudo-trace pairing and let Sr be the
I-weighted boundary stratum of trinodal curves with weigths r. Moreover, if h
is an element of SymQ(F )/(Λ1 + SymZ(I)), then we write

h =

3Xi,j=1

bij(ri ⊗ rj )

with bij ∈ Q and bij = bji. We identify Sr with M0,6, the moduli space of six
labeled points in P1(C), and denote the cross-ratios by
pjk := (pj, qj; qk, pk) ∈ C \ {0, 1}

for p = (p1, p2, p3, q1, q2, q3) ∈ P1(C)6 with pairwise distinct entries. Then, the
subvariety Sr(h) of Sr is cut out by the equations

pa1
23 · pa2

13 · pa3

12 = exp(−2πi(a1b23 + a2b13 + a3b12)),

where (a1, a2, a3) runs over the integral solutions of

a1s2s3 + a2s1s3 + a3s1s2 = 0.

As mentioned in the introduction, note that contrary to the cubic case, in
general we do not get a single equation anymore. We get an analogous result
for a second type of stratum, which we will call to be of nice non-trinodal type.
A cusp packet for a pseudo-cubic order O is a pair (I, Eh(I)) with a lattice I
in F and a certain symplectic extension class Eh(I). We will see that any

13

boundary point of the pseudo-real multiplication locus corresponds to a cusp
packet. Hence, at least for the strata relevant for Teichm¨uller curves, we can
use the cross-ratio equations to get the following description of the boundary of
the eigenform locus for pseudo-real multiplication.

Theorem 8.22. Let O ⊂ F be a pseudo-cubic order of degree relatively prime
to the conductor of D, and let (I, Eh(I)) ∈ C(O) be a cusp packet for O.
Furthermore, let ι : F ֒→ R be one of the two real quadratic pseudo-embeddings.
Then the intersection of the closure of the cusp of PΩιRMO associated to
(I, Eh(I)) with the union of the strata of trinodal and nice non-trinodal type
is equal to the union of all pι(S(h)), the ι-pseudo-embeddings of the subvari-
eties S(h) of S, where S runs over all admissible I-weighted boundary strata of
trinodal and nice non-trinodal type.

Finally, for doing a crosscheck, for every n ∈ N we take the Teichm¨uller
curve Cn generated by a speciﬁc S-shaped surface Tn (known as Thurston-
Veech-construction) in the locus ΩE4(2n+1). We show that a cusp indeed lies
in the image of some admissible I-weighted boundary stratum and we compute
the (in this case single) deﬁning cross-ratio equation for the subvariety S(h)
containing Cn.

14

4 Complex Abelian varieties

Compact Riemann surfaces of a ﬁxed genus g can be parameterized via the
Torelli map by their Jacobians, principally polarized complex Abelian varieties
of dimension g. Although this is our main motivation, arbitrary (not necessar-
ily principally) polarized complex Abelian varieties are objects also worth for
studying them in detail. In this paper non-principal polarized Abelian varieties
appear as subvarieties of higher dimensional principally polarized ones. Here we
summarize standard notations for complex Abelian varieties and a section with
technical lemmata on symplectic forms on lattices.

4.1 Complex tori and Abelian varieties

We recall some deﬁnitions and properties concerning complex Abelian varieties.
If not other stated, we follow [BL04] and refer the reader there for more details.

Complex tori and period matrices. A lattice in a ﬁnite-dimensional com-
plex vector space V is a discrete subgroup Λ of V of maximal rank. Thus,
if V has complex dimension g, then Λ is a free Abelian group of rank 2g. The
quotient A = V /Λ, equipped with the Lie group structure inherited by V , is
called a complex torus, a connected compact complex Lie group of dimension g.
Conversely, each connected compact complex Lie group A of dimension g is iso-
morphic to a complex torus of dimension g, since the universal cover V of A is
a complex vector space of dimension g and the kernel of the universal covering
map π : V → A is a lattice in V .
Any subset A1 of a complex torus A = V /Λ is a subtorus if and only if it is
of the form A1 = V1/Λ1, where V1 ⊆ V is a subspace such that the intersection
Λ1 = V1 ∩ Λ is a lattice in V1. A complex torus is said to be simple, if it does
not have any non-trivial subtorus.
A homomorphism of complex tori is a holomorphic map compatible with the
group structures. Each homomorphism f : V /Λ → V ′/Λ′ of complex tori can
be lifted to a unique C-linear map F : V → V ′. We call ρa(f ) := F the analytic
representation of f and its restriction to the lattices ρr(f ) := F|Λ : Λ → Λ′ the
rational representation of f . Conversely, a C-linear map F : V → V ′ descends
to a homomorphism of complex tori if and only if F (Λ) ⊆ Λ′. A homomorphism
of complex tori is called an isogeny, if it is surjective with ﬁnite kernel, and this
holds if and only if its analytic representation is an isomorphism of vector spaces.
Consequently, an isomomorphism is an isogeny with trivial kernel, respectively
ρr(f )(Λ) = Λ′.

If (e1, ..., eg) is a C-basis of V and (λ1, ..., λ2g) is a Z-basis of Λ, then we can

write λj =Pg

i=1 αijei and call the matrix

Π =

α1,1
...
αg,1

···

···

··· α1,2g
...
··· αg,2g

 ∈ Mg,2g(C)

a period matrix for A. Let Π and Π′ be period matrices for the tori A = V /Λ
and A′ = V ′/Λ′ with respect to certain bases and let f : A → A′ be a homo-
morphism. Then ρa(f ) is represented by a matrix M ∈ Mg,g(C) with respect
to the chosen C-bases and ρr(f ) is represented by a matrix R ∈ M2g,2g(Z) with

15

respect to the chosen Z-bases and the relation

M Π = Π′R

holds.

Complex Abelian varieties and polarizations. From the viewpoint of
algebraic geometry, a polarization on a complex torus A = V /Λ is by deﬁnition
the ﬁrst Chern class of a positive deﬁnite holomorphic line bundle on A. For
our purposes it is more convenient to take an equivalent deﬁnition in terms of
Hermitian forms.

Deﬁnition 4.1. Let A = V /Λ be a complex torus. A polarization on A is a
positive deﬁnite Hermitian form on H : V × V → C, such that Im(Λ × Λ) ⊆ Z.
If there exists a polarization H on a complex torus A, then A is called
a complex Abelian variety and the pair (A, H) is called a polarized complex
Abelian Variety. A homomorphism of polarized complex Abelian varieties is a
homomorphism of complex tori, such that the analytic representation preserves
the Hermitian forms. For simplicity, we will ommit the term ’complex’ often.

Any positive deﬁnite Hermitian form H on V gives rise to a non-degenerated

alternating R-bilinearform

EH : V × V → R, EH (v, w) := Im(H(v, w))

with the property that EH (iv, iw) = EH (v, w) holds for all v, w ∈ V . Con-
versely, any non-degenerated alternating R-bilinearform E on V with this prop-
erty deﬁnes a positive deﬁnite Hermitian form

HE : V × V → C, HE(v, w) := E(iv, w) + iE(v, w).

The assignment H 7→ HE is a group isomorphism between the N´eron-Severi
group N S(A), the group of Hermitian forms on V with Im(Λ × Λ) ⊆ Z,
and the group of alternating R-bilinearforms on V with E(Λ × Λ) ⊆ Z and
EH (iv, iw) = EH (v, w) for all v, w ∈ V . Its inverse is E 7→ HE and it induces a
bijection between the positive deﬁnite Hermitian forms and the non-degenerated
alternating forms.

A symplectic form on a free Z-module Λ is a non-degenerated alternating
bilinearform E with integer values. A symplectic module homomorphism of
modules with symplectic forms is a module homomorphism preserving the forms.
If the module with symplectic form E is of ﬁnite rank, then it is of even rank
2g and there exists a Z-basis (λ1, ..., λg, µ1, ..., µg) of Λ, such that E is given by
a matrix of the form

with respect to this basis, where D = diag(d1, ..., dg) with di ∈ N and di | di+1
for all i. Such a basis is called a symplectic basis and the tuple (d1, ..., dg),
as well as the diagonal matrix D, is called the type of E. The type does not
depend on the choice of the basis, and so does the degree of E, deﬁned as
i=1 di. If H is a polarization of an Abelian variety V /Λ and if we
speak of the type, respectively the degree of H, we mean the type, respectively
the degree of EH|Λ×Λ. We also refer to a symplectic basis for EH as a symplectic

deg(E) :=Qg

(cid:18) 0 D
−D 0(cid:19)

16

basis for H. A polarization H is said to be principal, if it is of type (1, ..., 1).
That is, if and only if EH|Λ×Λ is unimodular.
Each subtorus A1 of an Abelian variety A is also an Abelian variety, because
any polarization H on A = V /Λ induces the polarization H1 = H|V1×V1 on A1.
Let V2 be the orthogonal complement of V1 in V with respect to H. Then
Λ2 = V2 ∩ Λ is a lattice in V2 and A2 = V2/Λ2 is called the complementary
subvariety of A1 (with respect to H).
In the case that H is principal, we
have the following relation between the types of the induced polarizations on
complementary subvarieties.

Proposition 4.2. Let (A, H) be a principally polarized Abelian variety and
let A1, A2 ⊆ A be complementary subvarieties with dim(A1) ≤ dim(A2).
If
(A1, H1) is of type (d1, ..., dh), then (A2, H2) is of type (1, ..., 1, d1, ..., dh).

This is Corollary 12.1.5.

in [BL04]. In the next subsection, we will give a
similar proof for the slightly more general situation, where we do not have a
complex structure on our objects.

The moduli space of polarized Abelian varieties. Given any such type
D = diag(d1, ..., dg), polarized Abelian varieties of type D can be constructed
in the following way. We denote by

Hg := {Z ∈ Mg(C) : Z t = Z, Im(Z) > 0}

the upper Siegel half space, i.e. the space of symmetric complex g × g-matrices
with positive deﬁnite imaginary part. For each Z ∈ Hg we deﬁne ΛZ to be the
lattice in Cg generated by the columns of ΠZ := (Z, D) ∈ Mg×2g(C). Then
the bilinearform HZ on Cg deﬁned by the matrix Im(Z)−1 with respect to the
standard basis is a polarization on the complex torus AZ := Cg/ΛZ of type D.
A symplectic basis BZ is given by the columns of ΠZ .

An isomorphism between two triples (A1, H1, B1) and (A2, H2, B2) where
(Ai, Hi) is a polarized Abelian variety and Bi a symplectic basis for Hi, is an
isomorphism between (A1, H1) and (A2, H2) such that the rational represen-
tation maps the ordered tuple B1 onto B2.
It is a consequence of the Rie-
mann Relations (see [BL04], Section 4.2) that any such triple is isomorphic to
(AZ , HZ, BZ ) for some Z ∈ Hg. Thus the upper Siegel half space Hg, a com-
plex manifold of dimension 1
2 g(g + 1), is a moduli space for polarized Abelian
varieties of type D together with the choice of a symplectic basis. To get rid
of the choice of a basis, let ΛD be the Z-module generated by the columns of

the matrix(cid:0) Ig 0

0 D(cid:1) and let GD be the subgroup of the symplectic group Sp2g(Q)

consisting of those matrices M with M tΛD ⊂ ΛD. Then GD acts transitively,
properly and discontinously on Hg via

γ δ(cid:17) .Z := (αZ + β)(γZ + δ)−1.
(cid:16) α β

Given any two Z1, Z2 ∈ Hg, the polarized Abelian varieties (AZ1 , HZ1 ) and
(AZ2 , HZ2 ) are isomorphic if and only if Z1 and Z2 are in the same GD-orbit.

Theorem 4.3 ([BL04], Theorem 8.2.6.). The normal complex analytic space
AD := Hg/GD is a moduli space for polarized Abelian varieties of type D.

17

In this paper, we
Endomorphism structures and real multiplication.
are interested in Abelian varieties with a speciﬁc endomorphism structure. In
general, the endomorphism Q-algebra EndQ(A) := End(A) ⊗Z Q of an Abelian
variety A is determined by the endomorphism structure of its simple subvari-
eties. The reason is that for any two complementary subvarieties A1, A2, there
is an isogeny between A and A1 × A2. Then, by induction, we get the following
decomposition.

Theorem 4.4 (Poincar´e’s Complete Reducibility Theorem). Every complex
Abelian variety A is isogenous to a product

An1
1 × ... × Anr
r ,

with pairwise not isogenous simple Abelian varieties Ai. Moreover, the natu-
ral numbers ni are uniquely determined by A and the Abelian varieties Ai are
uniquely determined by A up to isogeny.

Given such an isogeny A → An1

isomorphism of Q-algebras

1 × ... × Anr

r as in the theorem, there is an

EndQ(X) ∼= Mn1 (F1) ⊕ ... ⊕ Mnr (Fr),

where each Fi = EndQ(Ai) is a skew ﬁeld of ﬁnite dimension over Q. Any choice
of a polarization H on an Abelian variety A determines an anti-involution on
EndQ(A), the Rosati involution. On the level of analytic representations, the
Rosati involution just maps a C-linear map to its adjoint with respect to H. If
A is simple and the Rosati involution is the identity on the centre of the skew
ﬁeld F = EndQ(A), then there are three possibilities for F . It can be a totally
real number ﬁeld, a totally indeﬁnite quaternion algebra, or a totally deﬁnite
quaternion algebra. In the ﬁrst case, the endomorphism ring End(A) coincides
with the subring

End+(A) := {f ∈ End(A) : H(ρa(f )(·),·) = H(·, ρa(f )(·))}

of endomorphisms self-adjoint with respect to the polarization, and this leads
to the deﬁnition of real multiplication.

Deﬁnition 4.5. Let F be a totally real number ﬁeld of degree g and let (A, H)
be a polarized Abelian variety of dimension g. Real multiplication on (A, H)
by F is a Q-algebra monomorphism

ρ : F ֒→ End+(A) ⊗ Q.

If such a monomorphism exists, we say that A admits real multiplication by F .

This is the deﬁnition from [McM07], without the condition of the polarization
being principal. A lattice in a ﬁnite dimensional Q-vector space is a free Abelian
subgroup of rank equal to the dimension of the vector space. An order in
a number ﬁeld is a subring containing 1 which is also a lattice.
If ρ is real
multiplication on (A, H) by a totally real number ﬁeld F , then the preimage
ρ−1(End(A)) is an order in F .

18

Deﬁnition 4.6. Let O be an order in a totally real number ﬁeld F of degree g
and let (A, H) be a polarized Abelian variety of dimension g. Real multiplication
on (A, H) by O is a ring-monomorphism

ρ : O ֒→ End+(A)

that is proper, i.e. it does not extend to a larger order in F . If such a monomor-
phism exists, we say that A admits real multiplication by O.

It is well known that the moduli space of principally polarized Abelian vari-
eties admitting real multiplication by O together with a choice of such real mul-
tiplication is the disjoint union of Hilbert modular varieties Γ\Hg, see [BM12].
Jacobians and the Torelli map. For each g ∈ N, we denote by Ag the moduli
space of principally polarized Abelian varieties of dimension g and by Mg the
moduli space of compact Riemann surfaces of genus g. Note that, throughout
this paper, Riemann surfaces are always meant to be connected. There is a
natural embedding Mg ֒→ Ag deﬁned as follows. Given any compact Riemann
surface X of genus g, the C-vector space Ω(X) of holomorphic one-forms is of
dimension g. The ﬁrst singular homology group H1(X; Z) can be embedded
into the dual vector space Ω(X)∗ := HomC(Ω(X); C) via

H1(X; Z) ֒→ Ω(X)∗,

γ 7→(cid:18)ω 7→Zγ

ω(cid:19) .

We identify H1(X; Z) with its image under this map, a lattice in Ω(X)∗. The
complex torus

Jac(X) := Ω(X)∗/H1(X; Z)

is an Abelian variety and is called the Jacobian of X. A polarization is given by
the intersection form. To be more precise, recall that for each homology class
γ ∈ H1(X; Z), there exists a unique class γ∗ ∈ H 1
dR(X) in the ﬁrst de Rham
cohomology group satisfying ∫γ ω = ∫X γ∗ ∧ ω for all ω ∈ H 1
dR(X), the Poincar´e
dual of γ. The intersection pairing on X is deﬁned by
hγ1, γ2i :=ZX

h·,·i : H1(X; Z) × H1(X; Z) → Z,

γ∗1 ∧ γ∗2 ,

an unimodular symplectic form on H1(X; Z). Moreover, its R-linear extension
to Ω(X)∗ satisﬁes hiv, iwi = hv, wi for all v, w ∈ Ω(X)∗. Thus it induces a
principal polarization ΘX := Hh·,·i on Jac(X). We have the following well
known result.

Theorem 4.7 (Torelli). The Torelli map

t : Mg → Ag, X 7→ (Jac(X), ΘX )

is injective.

4.2 Symplectic forms

Here, we prove some technical lemmata about symplectic forms on lattices
needed throughout this paper. Except for the last one, they are propably scat-
tered throughout the literature. For the readers convenience, we recall them at
this point.

19

The ﬁrst one concerns the type of the form induced by a sublattice.

Lemma 4.8. Let Λ be a free Z-module of ﬁnite rank and let E be a symplectic
form on Λ. Then, for every submodule Λ′ ≤ Λ of maximal rank and the induced
form E′ on Λ′ we have

deg E′ = |Λ/Λ′| · deg E.

Proof. Let (λ1, ..., λ2g) and (λ′1, ..., λ′2g) be bases of the free modules Λ and Λ′.
Then, for some A ∈ Z2g×2g with det A 6= 0 we have

(λ′1, ..., λ′2g)t = A(λ1, ..., λ2g)t,

in particular |Λ/Λ′| = | det A|. Let Z, Z′ ∈ Z2g×2g be the matrices representing
the symplectic forms E, E′ with respect to the chosen bases. Then Z′ = AZAt
and therefore

deg E′ = | det Z′|

1

2 = | det A| · | det Z|

1

2 = |Λ/Λ′| deg E.

Rational tori. Analogous to the concept of complex tori, a rational torus is
just a quotient V /Λ, where V is a ﬁnite dimensional vector space over Q and Λ
a lattice in V , i.e. a free Abelian subgroup with rkZ(Λ) = dimQ(V ). A homo-
morphism of complex tori T1 = V1/Λ1, T2 = V2/Λ2 is a group homomorphism
f : T1 → T2 induced by a Q-linear map fa : V1 → V2 that maps Λ1 into Λ2.
Analogous to the complex tori, we call fa the analytic representation of f and
fr := fa|Λ1 : Λ1 → Λ2 the rational representation of f . Given any such rational

torus T = V /Λ, its dual torus is deﬁned by bT = bV /bΛ, with bV := HomQ(V, Q)
and bΛ := {α ∈ bV : α(Λ) ⊆ Z}. Any homomorphism f : T1 → T2 induces a
well-deﬁned homomorphism bf : bT2 → bT1 on the dual tori by [α]bΛ2 7→ [α◦ fa]bΛ1

.
Thus, we get a contravariant functor from the category of rational tori to itself,
and this functor turns out to be exact.

Lemma 4.9. Let

be an exact sequence of rational tori. Then, the dual sequence

0 → T1 → T2 → T3 → 0

is also exact.

0 → bT3 → bT2 → bT1 → 0

Proof. The rational representation of the sequence

0 → T1 → T2 → T3 → 0

yields a sequence

0 → Λ1 → Λ2 → Λ3 → 0.

By considering the Q-span of each point in Λi, one can see that this sequence
of the lattices is exact. This also holds for the dual sequence

0 → Hom(Λ3; Z) → Hom(Λ2; Z) → Hom(Λ1; Z) → 0,

20

where exactness at the last position follows from the fact that the sequence of

the free Abelian Z-modules Λi splits. Identifying each Hom(Λi; Z) with bΛi, we

get a commutative diagramm

0 −−−−→ bΛ3 −−−−→ bΛ2 −−−−→ bΛ1 −−−−→ 0
0 −−−−→ bV3 −−−−→ bV2 −−−−→ bV1 −−−−→ 0,

y

y

y

where the vertical arrows are the natural inclusions. Since these inclusions are
injective, the induced sequence of the cokernels

is exact.

0 → bT1 → bT2 → bT3 → 0

Now we can proof the more general version of Proposition 4.2 which does

not make use of a complex structure.

Lemma 4.10. Let V be a 2g-dimensional vector space over Q with an alternat-
ing non-degenerated Q-bilinearform E. Furthermore, let V1 be a subspace of V
of dimension at most g, such that E is non-degenerated on V1. Furthermore, let
Λ be a lattice in V , such that (Λ, E) is of type (1, .., 1). Then, denoting the or-
thogonal complement of V1 in V by V2 and writing Λi = Vi ∩ Λ for i ∈ {1, 2}, we
have: If (Λ1, E) is of type (d1, ..., dh), then (Λ2, E) is of type (1, ..., 1, d1, ..., dh).
Proof. A priori, (Λ2, E) is of some type (e1, ..., eg−h). For each i ∈ {1, 2},
consider the group

Ki := {[v]Λi ∈ Vi/Λi : E(v, Λi) ⊆ Z}.

By choosing symplectic bases, we immediately see

K1 ∼=

hMi=1

Z/diZ and K2 ∼=

Z/eiZ.

g−hMi=1

Hence, it suﬃces to show that K1 is isomorphic to K2. Let T := V /Λ and
Ti := Vi/Λi be the resulting rational tori. Since (Λ, E) is of type (1, ..., 1), the
map

is an isomorphism. Denoting by ιi : Ti ֒→ T the natural inclusions, we get

Φ : T → bT ,
Ki = ker(bιi ◦ Φ ◦ ιi) = ι−1

[v]Λ 7→ [E(v,·)]bΛ
(ker(bιi ◦ Φ)).

i

T1 ∩ T2 would follow and thus by symmetry K1 = K2.

We claim that it suﬃces to show ker(bι1 ◦ Φ) = T2. Indeed, then K1 = ι−1
To prove ker(bι1 ◦ Φ) = T2, we ﬁrst note that we have
Hence, we have T2 ⊆ ker(bι1 ◦ Φ), as V2 is the orthogonal complement of V1.

Denoting the connected component containing zero with the subscript ’0’, we
get by equality of the dimensions of the rational tori

ker(bι1 ◦ Φ) = {[v]Λ ∈ V /Λ : E(v, Λi) ⊆ Z}.

1 (T2) =

T2 = (ker(bι1 ◦ Φ))0.

21

the exact sequence

Therefore, we have to show that ker(bι1 ◦ Φ) ∼= ker(bι1) is connected. Consider

ι1−→ T → T /T1 → 0,

where T /T1 = V /(Λ + V1) ∼= V2/π2(Λ) is indeed a rational torus (here, the map
π2 : V → V2 denotes the natural projection). Then, by the preceeding lemma,
the dual sequence

0 → T1

0 → [T /T1 → bT bι1−→ bT1 → 0

is connected.

is also exact. It follows that ker(bι1) = [T /T1 is a rational torus, in particular it

Lagrangian subgroups. Any symplectic basis of a symplectic Z-module de-
termines a decomposition into convenient submodules deﬁned as follows.

Deﬁnition 4.11. Let Λ be a free Z-module of rank 2g and let E be a symplectic
form on Λ.

1. A subgroup Λ1 ≤ Λ is called a Lagrangian subgroup of Λ, if Λ/Λ1 ∼= Zg

(or equivalently, Λ1 ∼= Zg and Λ/Λ1 is torsion-free) and E|Λ1×Λ1 ≡ 0.

2. A pair (Λ1, Λ2) of two Lagrangian subgroups of Λ is called a decomposition

for Λ, if Λ = Λ1 ⊕ Λ2.

Obviously, any choice of a symplectic basis determines a decomposition.
Conversely, the next lemma shows that each decomposition is induced by a
suitable symplectic basis.

Lemma 4.12. If (Λ1, Λ2) is a decomposition for (Λ, E), then there exists a
symplectic basis (λ1, ...λg, µ1, ..., µg) for (Λ, E) with λi ∈ Λ1 and µi ∈ Λ2 for all
i ∈ {1, ..., g}.
Proof. First, choose bases (λ1, ...λg) and (µ1, ..., µg) of Λ1 and Λ2. Then the
matrix of E with respect to the basis (λ1, ...λg, µ1, ..., µg) is of the form

(cid:18) 0

−Z t

Z

0(cid:19)

for some Z ∈ Zg×g with det(Z) 6= 0. If A1(λ1, ...λg)t and A2(µ1, ..., µg)t with
Ai ∈ GL2(Z) are new bases of Λ1 and Λ2, then the matrix of E with respect to
the new basis of Λ is

0

0 A2(cid:19)(cid:18) 0
(cid:18)A1

−Z t

Z

0(cid:19)(cid:18)A1

0 A2(cid:19)t

0

=(cid:18)

0

2)t
−(A1ZAt

A1ZAt
2

0 (cid:19) .

By the elementary divisor theorem, one can choose A1, A2, such that A1ZAt
of the form diag(d1, ...dg) with di | di+1 for all i ∈ {1, ..., g − 1}.

2 is

If the form is unimodular and a submodule is given by a submodule of a La-
grangian subgroup, then the type of the induced form is given by the elementary
divisors.

Lemma 4.13. Let E be of type (1, ..., 1) and let (Λ1, Λ2) be a decomposition for
(Λ, E). Moreover, let Λ′1 be a subgroup of Λ1 of Z-rank g and let (d1, ..., dg) be
the type of E|Λ′×Λ′ with Λ′ = Λ′1 ⊕ Λ2. Then, there is a basis (η1, ...ηg) of Λ1
such that (d1η1, ..., dgηg) is a basis of Λ′1.

22

Proof. By the previous lemma, there is a symplectic basis (λ1, ..., λg, µ1, ..., µg)
of Λ with λi ∈ Λ1, µi ∈ Λ2 and a symplectic basis (λ′1, ..., λ′g, µ′1, ..., µ′g) of Λ′
with λ′i ∈ Λ′1, µ′i ∈ Λ2 for all i ∈ {1, ..., g}. By dualizing these two Z-bases of Λ2,
we get

HomZ(Λ2, Z) = hµ∗1, ..., µ∗giZ = h(µ′1)∗, ..., (µ′g)∗iZ.

Now, consider the homomorphism

φ : Λ1 → HomZ(Λ2, Z),

λ 7→ (µ 7→ E(λ, µ)).

Since φ(λi) = µ∗i for all i, it follows that φ is an isomorphism, and together with
φ(λ′i) = di(µ′i)∗ we get

Λ1/Λ′1 ∼= φ(Λ1)/φ(Λ′1) ∼=

(Z/diZ).

gMi=1

We conclude with the proof of a very technical statement needed in Sec-
tion 6.3. Roughly speaking, it states that for each sublattice Λ ≤ Λ and each
’basis’ of the quotient Λ/Λ, the represantives of this basis can be chosen in a
way such that they diﬀer only by rational multiples from a Z-basis of Λ.
Lemma 4.14. Let Λ be a free Z-module of rank n, let Λ ≤ Λ be a submodule
of the same rank n and let d1|...|dn ∈ N be the elementary divisors of Λ in Λ.
Moreover, let (λ1, ..., λn) be a tuple in Λ, such that
Λ/Λ = h[λ1]i ⊕ ... ⊕ h[λn]i

with ord([λi]) = di.
Then, there is a basis (λ1, ..., λn) of Λ such we can choose for every i ∈ {1, ..., n}
a representative λ′i ∈ [λi] with

diλ′i = aiλi
for some ai ∈ N with ai ≤ di and (ai, di) = 1.
Proof. We can choose a basis (µ1, ..., µn) of Λ such that for all i ∈ {1, ..., n} we
have

diλi =

aij µj

nXj=i

for some aij ∈ Z.
First, we will show by induction that for all i ∈ {1, ..., n} we have

nXk=i+1

aikµk ∈ di+1Λ + di+1hλi+1i + ... + dnhλni and (di, aii) = 1.

We will do this induction in reverse order, so starting with i = n. For the ﬁrst
statement, there is nothing to proof and (dn, ann) = 1 holds, because the order
of [λn] is dn and dnλn = annµn.
Now, let i ∈ {1, ..., n − 1} and let us assume that for all j > i we have

νj :=

nXk=j+1

ajkµk ∈ dj+1Λ + dj+1hλj+1i + ... + dnhλni and (dj, ajj ) = 1.

23

In particular, for all j > i there are xj, yj ∈ Z with xjdj + yjajj = 1 and this
yields

nXj=i+1

aijµj =

=

=

nXj=i+1
nXj=i+1
nXj=i+1

aijxj djµj +

djaijxj µj +

djaijxj µj +

nXj=i+1
nXj=i+1
nXj=i+1

aij yjajj µj

aij yj(dj λj −

ajkµk)

nXk=j+1
nXj=i+1

dj aijyjλj −

aijyjνj.

By the induction hypothesis and the fact that dk divides dl for k < l, it follows

νi ∈ di+1Λ + di+1hλi+1i + ... + dnhλni.

In particular, we have

νi ∈ (di, aii)(Λ + hλi+1i + ... + hλni)

and therefore

diλi = aiiµi + νi ∈ (di, aii)(Λ + hλi+1i + ... + hλni).

Hence, in Λ/Λ we have

di

(di,aii) [λi] ∈ h[λi+1]i + ... + h[λn]i,

and as the sum of h[λi]i, ...,h[λn]i is direct in Λ/Λ and the order of [λi] is di, it
follows (di, aii) = 1.

Now we know that for all i ∈ {1, ..., n}, there are xi, yi ∈ Z with xidi + yiaii = 1,
so we can write

aijxidi = aij − yiaiiaij

for all j > i. Thus, we can choose the basis (µ1, ..., µn) of Λ such that di
divides aij for all i < j. Changing the class representatives of [λi] allows us to
add an element of diZ to each aij. Therefore, we can assume without loss of
generality

diλi = aiiµi

with 0 < aii ≤ di.

24

5 Quadratic orders and the trace pairing

The deﬁning lattice of a two-dimensional principally polarized complex Abelian
variety with real multiplication by a real quadratic order O is a proper torsion-
free O-module of rank two together with a unimodular symplectic form com-
patible with the O-module structure. It is well known that any such module is
isomorphic to O ⊕O∨ as a symplectic O-module, where O∨ denotes the inverse
diﬀerent and O⊕O∨ is equipped with a certain symplectic form, the trace pair-
ing. In preparation to parameterize two-dimensional polarized complex Abelian
varieties of arbitrary type, we classify in this section such modules where the
symplectic form is not unimodular anymore.

5.1 Quadratic orders and their ideals

First, we collect some facts about quadratic orders with non-square discrimi-
nants and their ideals. Our focus will be on orders which are not maximal and we
assume that the reader is familiar with the ring of integers in a quadratic num-
ber ﬁeld. If not, we refer to [Sch07] for all the results we need about quadratic
number ﬁelds and their maximal orders.

Two viewpoints of quadratic orders. The usual deﬁnition of a quadratic
order is the following.
Deﬁnition 5.1. For b, c ∈ Z, we call the ring

Ob,c := Z[X]/(X 2 + bX + c)

a quadratic order. The discriminant of Ob,c is deﬁned to be the integer

D := b2 − 4c.

For our purposes it will be more convenient to work with quadratic orders
as subrings of quadratic number ﬁelds instead of quotients of Z[X]. So, let K
be a quadratic number ﬁeld and let

σ : K → K,

x 7→ xσ

be the Galois-conjugation, i.e. the unique non-trivial automorphism of K. For
all x ∈ K we denote by N (x) := xxσ the norm of x and by tr(x) := x + xσ the
trace of x.
Now let O ⊂ K be a ring with 1 ∈ O and O ∼= Z2 as a Z-module. Note
that the last condition implies O ⊗Z Q = K. For a Z-basis (ω1, ω2), we call the
number

(cid:18)det(cid:18)ω1 ω2

ωσ
1 ωσ

2(cid:19)(cid:19)2

the discriminant of O, which is independent of the choice of the basis. We
denote by OK the ring of integers of K and by ∆K its discriminant. Now
let D be the discriminant of O. Elementary computations show the following
properties:

1. K = Q(√D)

25

2. D ∈ Z, D ≡ 0 mod 4 or D ≡ 1 mod 4, D is not a square
3. O = h1, D+√D
4. If we write K = Q(√d) with d ∈ Z squarefree, then there is a natural
number f , called the conductor of O, with

iZ, in particular O is uniquely determined by D.

2

D = f 2∆K =(cid:26) f 2d

f 24d

if d ≡ 1 mod 4
if d ≡ 2, 3 mod 4

.

5. If f is the conductor of O, then for every ω ∈ K with OK = h1, ωiZ we

have

O = Z + fOK = h1, f ωiZ ⊂ OK,

and therefore |OK : O| = f and Oσ = O.

On the other hand, for any non-square integer D ≡ 0, 1 mod 4, we set

γD := D+√D

2

and see that the Z-module

OD := h1, γDiZ

is a subring of K = Q(√D) with 1 ∈ OD and isomorphic to Z2 as a Z-module.
Now let Ob,c be a quadratic order in the sense of Deﬁnition 5.1 and let
D = b2 − 4c be its discriminant. Again we can see by elementary computations:

1. D ≡ 0 mod 4 or D ≡ 1 mod 4
2. If D is any integer with D ≡ 0 mod 4 or D ≡ 1 mod 4, then the discrim-

inant of the quadratic order OD, D2−D

4

is D.

3. Ob,c is an integral domain if and only if D is not a square.
4. Ob,c = h1, XiZ ∼= Z2 as a Z-module

5. If D is not a square, then

Ob,c ∼= OD

as rings, with an isomorphism deﬁned by

X 7→ γD − D+b
2 .

6. If D is a square, say D = d2, then we have an injective ring homomorphism

Ob,c ֒→ Z2

X 7→ (−b+d

2

, −b−d

2

).

deﬁned by

The image of Ob,c is

Od2 := {(x, y) ∈ Z2 : x ≡ y mod d}.

26

So, for every D ∈ Z with D ≡ 0, 1 mod 4 it makes sense to call D a
discriminant and OD a quadratic order. If D is not a square, then OD is an
order in a quadratic number ﬁeld K, and if in addition D is positive, then OD is
called a real quadratic order. The ring of integers OK is called the maximal order
in K (and indeed it is the unique maximal order with respect to inclusion) and
ﬁnally a discriminant is called fundamental if it is the discriminant of a maximal
order. For the rest of this paper, we deal with the case that D is not a square.

Ideals. We are interested in ideals of non-maximal orders. Many properties,
like the multiplicativity of the norm function or the factorization of ideals into
prime ideals, work quite diﬀerent than in maximal orders. Our aim is to restrict
ourselves to those ideals which ’behave’ like ideals of maximal orders. If not
other stated, proofs for all the statements below about quadratic orders which
are not maximal can be found in [Cox89], §7. The statements in [Cox89] are
mostly formulated for imaginary quadratic number ﬁelds, but note that all these
proofs work also without the condition ’imaginary’.

The ﬁrst big diﬀerence to maximal orders is that the set of fractional ideals
with respect to the multiplication is in general not a group, but just a monoid.
The invertible ideals are precisely the proper ones, deﬁned as follows.

Deﬁnition 5.2. Let O be an order in a quadratic number ﬁeld K. A fractional
ideal a of O is said to be proper if and only if

O = {x ∈ K : xa ⊂ a}.

Lemma 5.3. Let O be an order in a quadratic number ﬁeld K and let a be a
fractional ideal of O. Then the following conditions are equivalent.

1. a is proper.

2. a is invertible.

3. a is projective as an O-module.

Moreover, in this case the inverse of a is given by

a−1 = {x ∈ K : xa ⊂ O}.

The equivalence of the last condition to the previous ones can be found in
[Rib69], Chapter I.6 (e).

In maximal orders all fractional ideals are proper. As an example of a non-

proper ideal, let O be the order of conductor 2 in K = Q(√−3), i.e. O =
Z[√−3]. Setting a := h2, 1 + √−3iZ, we have

{x ∈ K : xa ⊂ a} = OK 6= O.

Hence, a is an example for an ideal which is not proper and thus not invertible.
By I(O) we denote the group of all proper fractional ideals of O and by IK
the group of all fractional ideals of OK. For an ideal a E O we denote by
N(a) := [O : a] the norm of a.
Lemma 5.4. Let O be an order in a quadratic number ﬁeld. The norm function
has the following properties.

27

1. N(xO) = N (x) for all x ∈ O \ {0}.
2. N(ab) = N(a)N(b) if at least one of the ideals a, b E O is proper.
3. aaσ = N(a)O for all proper ideals a E O.
The second statement can be found in [Coh93], Proposition 4.6.8.. As exam-
ples where the last two equations do not hold, let O be an order in a quadratic
number ﬁeld K with conductor f 6= 1, that is O = Z+fOK, and let a be the ideal
of O deﬁned as a := fOK, so N(a) = f . Then, we have a2 = f 2OK and hence
N(a2) = f 3 6= N(a)2. We also have aσ = a and therefore aaσ = f 2OK 6= N(a)O.
By the previous lemma, it follows that a is not proper for f 6= 1. Therefore, we
can always ﬁnd non-proper ideals of non-maximal orders.
It turns out that the condition ’proper’ is still to weak for the factorization

into prime ideals. This leads to the following deﬁnition.

Deﬁnition 5.5. Let O be an order in a quadratic number ﬁeld, a E O an ideal
which is not zero and n ∈ Z. Then a is called relatively prime to n if

a + nO = O.

This is a stronger condition than being proper, and it can be easily verﬁed

by computing the norm.

Lemma 5.6. Let O be an order in a quadratic number ﬁeld with conductor f
and let a E O be an ideal which is not zero. Then, a is relatively prime to f if
and only if N(a) is relatively prime to f . Furthermore, if a is relatively prime
to f , then a is proper.

Considering just ideals relatively prime to a given conductor, one can switch
between the ideals in the corresponding order and the ideals in the maximal
order in the following sense.

Lemma 5.7. Let O be an order in a quadratic number ﬁeld K with conductor f .
1. If a is an ideal of O relatively prime to f , then aOK is an ideal of OK

relatively prime to f of the same norm and aOK ∩ O = a.

2. If a is an ideal of OK relatively prime to f , then a ∩ O is an ideal of O

relatively prime to f of the same norm and (a ∩ O)OK = a.

For an order O in a quadratic number ﬁeld K with conductor f , we denote
K(f ) the set of

by I+(O, f ) the set of ideals in O relatively prime to f and by I+
ideals in OK relatively prime to f .
the map

For all a, b ∈ I(O) we have (ab)OK = (aOK)(bOK ) and for all a ∈ I +(O, f )

O/a → OK/aOK,

[x] 7→ [x]

is a ring isomorphism. Together with Lemma 5.7, this yields the following
corollary.

Corollary 5.8. Let O be an order in a quadratic number ﬁeld K with conduc-
tor f . The map

I+(O, f ) → I+

K(f ),

a 7→ aOK

28

is a norm preserving monoid isomorphism. Its inverse map is

I+
K(f ) → I+(O, f ),

a 7→ a ∩ O.

An ideal a of O relatively prime to f is a prime ideal if and only if aOK is a
prime ideal of OK .

For this paper, the most important consequences of this corollary are the
following. Every ideal of O relatively prime to f has a unique factorization into
prime ideals, we get this factorization in a natural way by the prime factorization
in OK, and we can use the ramiﬁcation law for prime integers not dividing f .
Moreover, for two ideals a, b of O relatively prime to f , the inclusion a ⊂ b
holds if and only if b | a.

How do ideals of orders in a quadratic number ﬁeld look like? For any ideal
a E OD we have a ∩ N 6= ∅, thus we can always ﬁnd a Z-basis for a of the form
(n, a + bγD) with n, a, b ∈ Z. We can even choose n, b > 0 and 0 ≤ a < n, and
in this case the basis is unique. Elementary computations lead to the following
technical lemma needed in Section 6.1.
Lemma 5.9. Let OD be an order in a quadratic number ﬁeld, let n, a, b ∈ Z
with n, b > 0 and let ω := a + bγD. Then, we have for a := hn, ωiZ the following.

1. a is an ideal of OD if and only if b | a, b | n and n | N (ω)

b

.

2. N(a) = nb.

3. If a is an ideal of OD, then a is primitive (that is, if m is an integer, then

1

m a ⊂ OD implies m ∈ {−1, 1}) if and only if b = 1.

4. The primitive ideal a = hn, a + γDiZ is invertible if and only if

gcd(n, N (a+γD )

n

, tr(a + γD)) = 1.

In this case, we have a−1 = 1
More generally, an arbitrary ideal b = hα, βiZ of OD is invertible if and
only if

n aσ.

gcd(N (α),N (β), tr(aσβ)) = N(b).

In this case, we have

b−1 = 1

N(b) bσ.

For many problems it suﬃces to consider ideals just up to multiples in K.
Two fractional ideals I, J of a quadratic order O are said to be equivalent, if
there is some x ∈ K, such that xI = J. Furthermore, they are said to be strictly
equivalent, if there is some x ∈ K with N (x) > 0, such that xI = J. Then, we
have by [HK13], Theorem 5.5.7.2(b) the following very useful lemma.

Lemma 5.10. Let I be an invertible, fractional ideal of O. Then, for ev-
ery positive integer M , there is an invertible, primitive ideal a of OD with
gcd(N(a), M ) = 1 and N(a) ≥ 1, such that I and a are strictly equivalent.
The proof uses the continued fraction expansion of quadratic irrationals. There
are two immediate consequences we are going to use.

29

Corollary 5.11. Let O be a quadratic order.

1. Every invertible ideal O is strictly equivalent to an ideal relatively prime

to the conductor of O.

2. Let a, b be ideals relatively prime to the conductor of O. Then, a is strictly

equivalent to an ideal a′ of O such that a′ and b are relatively prime.

5.2 Symplectic modules over real quadratic orders

We are interested in polarized complex Abelian surfaces with real multiplication
(in the sense of Deﬁnition 4.6). Real multiplication by a real quadratic order OD
on the surface X/Λ makes the lattice Λ to a proper, torsion-free OD-module
of rank two carrying the symplectic form induced by the polarization. Here
the rank of Λ is the dimension of Λ ⊗Z Q as a K-vector space. This form is
compatible with the OD-module structure, i.e. the action of OD is self-adjoint
with respect to the form.
The goal of this section is, to classify symplectic OD-modules arising from
polarized complex Abelian surfaces with real multiplication. We will see that
for a given type and a given real quadratic order OD, the isomorphism classes of
these modules correspond to the ideals of OD with norm equal to the quotient
of the type of the polarization.
Deﬁnition 5.12. Let D > 0 be a non-square discriminant. A symplectic OD-
module is a pair (Λ, E), where Λ is a torsion-free rank two OD-module and E
is a symplectic form on Λ compatible with the OD-module structure.
An isomorphism of symplectic OD-modules is an OD-module isomorphism pre-
serving the forms.

Now we introduce the most important example for symplectic forms on rank

two OD-modules, those induced by the trace pairing in Q(√D) ⊕ Q(√D).
Recall that, if OD is the real quadratic order of discriminant D, then we
have OD ⊂ Q(√D) and OD = h1, γiZ with γ := γD = D+√D
. From now on, we
ﬁx D to be a positive, non-square discriminant and set K = Q(√D). Writing
K = Q(√d) with d a square-free integer and x = a + b√d ∈ K with a, b ∈ Q, we
call R(x) := a the invariant part of x and I(x) := b the antiinvariant part of x.
Again we denote for all x ∈ K by xσ the Galois-conjugate, by N (x) := xxσ the
norm and by tr(x) := x + xσ = 2R(x) the trace of x. For any ideal a of OD, we
deﬁne the inverse diﬀerent of a as the fractional ideal

2

a∨ := {x ∈ K : tr(xy) ∈ Z for all y ∈ a}.

Using Lemma 5.9, an elementary computation yields

a∨ = 1√D

1

N(a) aσ

for any ideal a. Thus, in the case of a = OD we get O∨D = 1√DOD. We will now
deﬁne a symplectic form on the OD-module OD ⊕ O∨D.
Deﬁnition 5.13. The trace pairing on OD ⊕ O∨D is deﬁned by

h·,·i : (OD ⊕ O∨D)2 → Z,

h(x, y), (˜x, ˜y)i := tr(˜xy − x˜y).

30

One can easily check that the trace pairing is a symplectic form of type (1, 1).

A symplectic basis is given by

((1, 0), (γ, 0), (0, 1√D

γσ), (0, −1√D

)),

which we call the standard symplectic basis of (OD ⊕ O∨D,h·,·i). In particular,
(OD ⊕ {0},{0} ⊕ O∨D) is a decomposition for (OD ⊕ O∨D,h·,·i). Moreover, the
action of OD on OD ⊕ O∨D is self-adjoint with respect to the trace pairing, i.e.

hxλ, λ′i = hλ, xλ′i

for all x ∈ OD and λ, λ′ ∈ OD ⊕ O∨D.
In order to get symplectic forms of arbitrary types (d1, d2), we consider
submodules of OD ⊕ O∨D. We will show that not every type will appear, and
this leads to the following deﬁnition.
Deﬁnition 5.14. Let d1, d2 ∈ N with d1 | d2 and d2
conductor of D. Let Q pki
quotient d2
d1
in OD, if the following conditions hold.

relatively prime to the
i , with ki ∈ N, be the prime factorization of the
. We say that the pair (d1, d2) satisﬁes the prime factor condition

d1

1. No pi is inert over K and

2. If pi is ramiﬁed over K, then ki = 1.

We say that d ∈ N satisﬁes the prime factor condition in OD, if (1, d) satisﬁes
the prime factor condition in OD.
For a pair (d1, d2) ∈ N2 with d1 | d2, we call d2

the quotient of (d1, d2).

d1

This is precisely the condition for the type that guarantees the existence of

d1

i (if pi is ramiﬁed) or pipσ

an ideal inducing this type with respect to the trace pairing.
Proposition 5.15. Let d1, d2 ∈ N with d1 | d2 and d2
relatively prime to the
conductor of D. Then, there exists an ideal a E OD such that the trace pairing
on a ⊕ O∨D is of type (d1, d2) if and only if (d1, d2) satisﬁes the prime factor
condition in OD. The same holds for OD ⊕ 1√D
a instead of a ⊕ O∨D.
Proof. LetQ pki
i be the prime factorization of d2
. The prime ideal factorization
d1
i with pi 6= pσ
of piOD is either piOD (if pi is inert), p2
(if pi splits).
Let a E OD be an ideal such that the trace pairing on a⊕O∨D is of type (d1, d2).
By Lemma 4.13, the OD-module b := 1
a is still an ideal of OD, and on b⊕O∨D
the trace pairing is of type (1, d2
). Hence, the norm of b is relatively prime to
d1
the conductor of D. In particular, b is proper. Now let us assume that (d1, d2)
does not satisfy the prime factor condition in OD. Then, there is an inert or a
ramiﬁed prime number pi such that pε
with ε = 1 if pi is inert and ε = 2
if pi is ramiﬁed. Lemma 4.8 implies N(b) = d2
, where N is the norm function
d1
of ideals of OD, thus pε
iOD | bbσ and
therefore, using the unique prime ideal factorization for ideals relatively prime
to the conductor, b ⊂ piOD. But, as the trace pairing on piOD ⊕ O∨D is of type
(pi, pi) and on b ⊕ O∨D of type (1, d2

| N(b). Since b is proper, we have pε

), we have a contradiction.

d1

i | d2

d1

i

i

d1

31

To prove the converse, suppose that (d1, d2) satisﬁes the prime factor condi-

tion in OD. The ideal

a := (Y pki

i )(d1OD)

has norm N(a) = d1d2. As a ⊂ d1OD and as the trace pairing on d1OD ⊕ O∨D
is of type (d1, d1), the trace pairing on a ⊕ O∨D is of type (d′1, d′2) with d1 | d′1
It remains to show that d1 = d′1.
and, again by Lemma 4.8, d1d2 = d′1d′2.
Assume that there is a prime number p with p | d′1
. Let (λ1, λ2, µ1, µ2) be the
standard symplectic basis of (OD ⊕ O∨D,h·,·i). Then, we have for every a ∈ a,
that (a, 0) = α1λ1 + α2λ2 with αi ∈ Z and thus pd1 | h(a, 0), µii = αi. It follows
a ⊂ pd1OD and therefore pOD |Q pki
i , which is impossible as (d1, d2) satisﬁes
the prime factor condition in OD.

d1

For any fractional ideal I of K, we have K = Q ⊗Z I. Therefore, if I1, I2
are fractional ideals of K, any symplectic form on I1 ⊕ I2 extends naturally by
tensoring with Q to a unique alternating Q-bilinear form on K 2. We denote
this form also by E.

The next step is the construction of symplectic bases.

Lemma 5.16. Let a be an ideal of OD and let (η1, η2) be a Z-basis of a. Then,
we have possibly after multiplying one of the ηi with −1 the following identity.

I(η1ησ
In particular, (λ1, λ2, µ1, µ2) with

2 ) = − 1

2I(√D)N(a).

λ1 := (η1, 0), λ2 := (η2, 0), µ1 := (0, 1√D

N(a) ησ
1 )
is a symplectic basis of (a ⊕ a∨,h·,·iQ) and h·,·iQ is on a ⊕ a∨ of type (1, 1).
Proof. Because of (η1, η2)t = A(1, γ)t with A ∈ GL2(Q) ∩ Z2×2, we have

2 ), µ2 := (0, −1√D

N(a) ησ

1

1

I(η1ησ

2 ) = −

1

2I(√D) det(A),

and thus

Using N(a) = | det(A)|, an easy computation gives the second assertion.

hλ1, µ1i = hλ2, µ2i = det(A).

A direct consequence of Lemma 4.13, Lemma 5.16 and the fact, that the
Galois conjugation is an isomorphism of OD, is the following corollary, which
allows us to choose a symplectic basis and a basis for the Smith normal form
simultaneously.
Corollary 5.17. Let a E OD be an ideal such that the trace pairing on a⊕ O∨D
(respectively OD ⊕ 1√D
a) is of type (d1, d2). Then, there exists a Z-basis (η1, η2)
of OD such that

((η1, 0), (η2, 0), (0, 1√D

ησ
2 ), (0, −1√D
is a symplectic basis of (OD ⊕ O∨D,h·,·i) and
((d1η1, 0), (d2η2, 0), (0, 1√D

ησ
2 ), (0, −1√D

ησ
1 ))

ησ
1 ))

(respectively ((η1, 0), (η2, 0), (0, d1√D

ησ
1 )))
is a symplectic basis of (a ⊕ O∨D,h·,·i) (respectively (OD ⊕ 1√D
a,h·,·i)).

2 ), (0, −d2√D
ησ

32

The goal of this section is to show that each proper symplectic OD-module,
presupposing that the quotient of the type is relatively prime to the conductor,
is isomorphic to one of those constructed in Proposition 5.15. For that we need
the following three technical lemmata.

Lemma 5.18. Let I1, I2 be fractional ideals of K and let E be a symplectic form
on I1 ⊕ I2 compatible with the OD-module structure. Then, (I1 ⊕ {0},{0} ⊕ I2)
is a decomposition for (I1 ⊕ I2, E).
Proof. It remains to show that E|Ii⊕Ii ≡ 0 for i ∈ {1, 2} (here, we identify I1
with I1 ⊕{0} and I2 with {0}⊕ I2). We extend E to the natural Q-bilinearform
on K 2. Since the multiplication with elements of K is self-adjoint with respect
to E and E is alternating, we have for all k1, k2 ∈ K:

E((k1, 0), (k2, 0)) = E((1, 0), (k1k2, 0))
= −E((k1k2, 0), (1, 0))
= −E((k1, 0), (k2, 0))

This yields EI1⊕I1 ≡ 0 and analogous EI2⊕I2 ≡ 0.
Lemma 5.19. Let I1, I2 be fractional ideals of K and let E be a symplectic
form on I1 ⊕ I2 compatible with the OD-module structure. Then, there exists a
fractional ideal I of K with I1 ⊂ I (respectively I2 ⊂ I) such that on Λ := I ⊕ I2
(respectively Λ := I1 ⊕ I) the alternating form E is symplectic of type (1, 1).
Proof. We deﬁne

I := {x ∈ K : ∀y ∈ I2 : E((x, 0), (0, y)) ∈ Z}.

Obviously, we have I1 ⊂ I ⊂ K and, since the action of OD is self-adjoint with
respect to E, we have that I is an OD-module.
Let (d1, d2) be the type of E and let ((λ1, 0), (λ2, 0), (0, µ1), (0, µ2)) be a sym-
plectic basis of (I1 ⊕ I2, E). We can write every v ∈ K as

v = q1

1
d1

λ1 + q2

1
d2

λ2

with q1, q2 ∈ Q. This leads to

I = h 1

d1

λ1, 1
d2

λ2iZ.

In particular, I is a fractional ideal and on Λ := I ⊕ I2 the form E is clearly
symplectic of type (1, 1) with symplectic basis

( 1
d1

(λ1, 0), 1
d2

(λ2, 0), (0, µ1), (0, µ2))

Lemma 5.20. Let a be an ideal of OD, let I be a fractional ideal of K and
let E be a symplectic form on a⊕ I of type (1, 1) compatible with the OD-module
structure. Then, there exists an isomorphism of symplectic OD-modules

θ : (a ⊕ I, E) → (a ⊕ a∨,h·,·i)

with θ((λ, 0)) = (λ, 0) for all λ ∈ a and θ({0} ⊕ a∨) = {0} ⊕ a∨.

33

Proof. By Lemma 5.18 the pair (a ⊕ {0},{0}⊕ I) is a decomposition for (Λ, E)
with Λ := a ⊕ I. Hence, by Lemma 4.12, there are Z-bases (λ1, λ2) of a and
(µ1, µ2) of I, such that

((λ1, 0), (λ2, 0), (0, µ1), (0, µ2))

is a symplectic basis of (Λ, E). By Lemma 5.16, there is a Z-basis (˜µ1, ˜µ2) of a∨
such that

((λ1, 0), (λ2, 0), (0, ˜µ1), (0, ˜µ2))
is a symplectic basis of a ⊕ a∨. Then, the assignment

(λi, 0) 7→ (λi, 0), (0, µi) 7→ (0, ˜µi) for all i ∈ {1, 2}

deﬁnes a symplectic isomorphism of groups

θ : (Λ, E) → (a ⊕ a∨,h·,·i)

with θ((λ, 0)) = (λ, 0) for all λ ∈ a and θ({0} ⊕ I) = {0} ⊕ a∨. It remains to
show that θ is OD-linear.
By construction, we clearly have θ(x(λ, 0)) = xθ((λ, 0)) for all x ∈ OD, λ ∈ a.
Now, let x ∈ OD and µ ∈ I. Then, we have

θ(x(0, µ)) = α1 ˜µ1 + α2 ˜µ2 and xθ((0, µ)) = β1 ˜µ1 + β2 ˜µ2

with αi, βi ∈ Z. Since multiplying by x is self-adjoint, we get for all i ∈ {1, 2}

αi = h(λi, 0), θ(x(0, µ))i
= E((λi, 0), x(0, µ))
= E((xλi, 0), (0, µ))
= h(xλi, 0), θ(0, µ)i
= h(λi, 0), xθ(0, µ)i
= βi

θ(x(0, µ)) = xθ((0, µ)).

and, therefore,

Because θ is Z-linear, this ﬁnishes the proof.

A direct consequence of the previous two lemmata and Lemma 5.15 is, that

in this situation there do not exist symplectic forms of any arbitrary type.

Corollary 5.21. Let I be a fractional ideal of K and let E be a symplectic
form on OD ⊕ I of type (d1, d2) compatible with the OD-module structure. If
the quotient d2
is relatively prime to the conductor of D, then (d1, d2) satisﬁes
d1
the prime factor condition in OD.

For torsion-free OD-modules of rank one (i.e. fractional ideals), properness
is equivalent to invertibility and also equivalent to projectivity. In the rank two
case, projectivity is a strictly stronger condition if OD is not maximal, since Λ
is isomorphic to the direct sum of two fractional ideals (see the proof below).
Nevertheless, our lattices carry a symplectic form of a type relatively prime to
the conductor of D. The next theorem shows in particular that this additional
condition is enough to guarantee Λ to be projective.

34

Theorem 5.22. Let (Λ, E) be a proper symplectic OD-module of type (d1, d2)
with d2
relatively prime to the conductor of D. Then, there is a unique ideal a
d1
of OD such that

(Λ, E) ∼= (OD ⊕ 1√D

a,h·,·i)

d1

as symplectic OD-modules. In particular, Λ is a projective OD-module and d2
satisﬁes the prime factor condition in OD.
Proof. First we show the existence. If we had (Λ, 1
d1
for some ideal a of OD, then also (Λ, E) ∼= (OD ⊕ 1√D
Hence, we may assume without loss of generality that (d1, d2) = (1, d).

E) ∼= (OD ⊕ 1√D
a,h·,·i)
(d1a),h·,·i) would hold.
As an OD-module, Λ is torsion-free, every ideal of OD can be generated by
at most two elements and the integral closure of OD is the maximal order OK.
Hence, it follows by [Bas62], Theorem 1.7, that Λ is isomorphic to a0 ⊕ b0 as an
OD-module, where a0 and b0 are ideals of OD. We can choose a0 and b0 to be
primitive. We denote the induced alternating form on a0 ⊕ b0 also by E.
The ﬁrst step is, to show that a0 and b0 are proper as OD-ideals. By
Lemma 5.19 and Lemma 5.20, we know that there is a symplectic OD-module
isomorphism

(a0 ⊕ b0, E) ∼= (a0 ⊕ I,h·,·i)

for some fractional ideal I ⊆ a∨0 . The ideal a0 is not proper as an OD-module
if and only if there is a prime number p dividing the conductor of D such that
for the order OE ) OD with E = p−2D we have OEa0 ⊆ a0. We will show that
such an order would also act on I. If we write a0 = hn, a + γDiZ, we see that
OEa0 is contained in a0 if and only if
2 − a
γE · (a + γD) = − N (a+γD)

p · (a + γD) and
p + E(1−p)

p ) · n + n
· n + ( a+D

γE · n = ( E(1−p)

) · (a + γD)

pn

2

are both elements of a0. Using

n | N (a + γD) = a2 + aD + D(D−1)

2

and considering the case p = 2 separately (we have p | a for p odd), we deduce
that this is equivalent to

p | n and pn | N (a + γD).

(2)

We want to deduce that OE a0 ⊆ a0 implies OEI ⊆ I. Since (a0 ⊕ a∨0 ,h·,·i) is
of type (1, 1) and a∨0 = 1√D

N (a0) aσ, the fractional ideal I is of the form

1

I = 1√D

1

N (a0) J σ

for an OD-ideal J ⊆ a0 with [a0 : J] = d. Thus, we can write

J = hm, b + cγDiZ

for some m, b, c ∈ N0 with n | m and mc = nd. We have to show that the
conditions in (2) hold for the OD-ideal h m
c + γDiZ. The ﬁrst one is clear, as
p | n | m, c | d and p ∤ d. For the second one, we remark that (2) implies that the

c , b

35

norm of every element in a0 is a multiple of pn. Indeed, for λ = kn + l(a + γD)
with k, l ∈ Z, we compute

N (λ) = l2N (a + γD) + kn(kn + 2la + lD)

m

and use p | a for p odd. Since J ⊆ a0, we have pn | N (b + cγD). Together with
c | N ( b

c + γD) by Lemma 5.9 and p ∤ d, we get

p m
c | N ( b

c + γD).

We have shown that OEa0 ⊆ a0 implies OEI ⊆ I and thus OEΛ ⊆ Λ.
In
particular, if Λ is proper as an OD-module, then a0 and analogously b0 are also
proper and Λ is projective.
Now, we are in the situation that Λ is isomorphic to a0 ⊕ b0, where a0
and b0 are proper ideals of OD. By Corollary 5.11, we may choose a0 and b0 to
be relatively prime. Hence, the OD-module homomorphism

a0 ⊕ b0 → OD,

(x, y) 7→ x + y

is surjective, and as OD is free, this epimorphism splits. Thus, Λ is isomorphic
to OD ⊕ I for some fractional ideal I of OD. Finally, by Lemma 5.19 and
Lemma 5.20, there is a symplectic OD-module isomorphism

(OD ⊕ I, E) ∼= (OD ⊕ 1√D

a,h·,·i)

for some ideal a E OD. In particular, (d1, d2) satisﬁes the prime factor condition
in OD.

It remains to show that the choice of the ideal a is unique. Let us assume

that there is any ideal b with
(OD ⊕ 1√D

a,h·,·i) ∼= (OD ⊕ 1√D

b,h·,·i)

as symplectic OD-modules. An isomorphism ϕ between the underlying OD-
modules is given by multiplication with a matrix

A ∈ GL  OD √Da−1
ba−1 ! .

1√D

b

Since

hϕ(x, y), ϕ(˜x, ˜y)i = tr(det(A)(˜xy − x˜y)),

it follows that ϕ is symplectic if and only if det(A) = 1. Hence, we have 1 ∈ ba−1
and thus a ⊆ b. Since a and b have the same norm, they must coincide.
Corollary 5.23. Let D > 0 be a discriminant and let d1 | d2 ∈ N such that
d = d2
is relatively prime to the conductor of D and satisﬁes the prime factor
d1
condition in OD. Furthermore, we denote by s the number of splitting prime
divisors of d in OD. Then there are precisely 2s isomorphism classes of proper
symplectic OD-modules of type (d1, d2).
Proof. This follows immediately from the uniqueness statement in Theorem 5.22
and the construction in Proposition 5.15 using the prime ideal decomposition.

36

6 The real multiplication loci in dimension two

and three

The moduli space of principally polarized Abelian surfaces with some choice
of real multiplication by OD is a single Hilbert modular surface Γ\H2. In this
section we construct the moduli space of principally polarized Abelian vari-
eties of dimension three with some choice of real multiplication by OD on a
two-dimensional subvariety, such that the induced polarization on this sub-
variety is of a ﬁxed type. This space turns out to be the disjoint union of
Hilbert modular varieties Xi = Γi\H3, where the Γi are certain subgroups of
SL2(Q(√D)) × SL2(Q). Furthermore, we will ﬁnd lower and upper bounds
for Γi in SL2(Q(√D)) × SL2(Q), both being direct products of a subgroup of
SL2(Q(√D)) and a subgroup of SL2(Q), and with both inclusions of ﬁnite in-
dex. Finally, we interpret the resulting quotients of H3 by these groups as the
moduli spaces of products of varieties with level structures.

6.1 The moduli space in dimension two

First, we want to parameterize all polarized Abelian surfaces with real multipli-
cation by OD, where the quotient of the type is relatively prime to the conductor
of D. In accordance with the classiﬁcation of symplectic OD-modules in the pre-
vious section, we will show that the moduli space of polarized Abelian surfaces
of a ﬁxed type together with the choice of real multiplication by a ﬁxed order OD
is the union of 2s Hilbert modular surfaces, where s is determined by the type
and the discriminant.

Let us ﬁrst specify the deﬁnition of real multiplication from Section 4.1 to

the two-dimensional case.

Deﬁnition 6.1. Let (A, H) with A = V /Λ be a polarized Abelian surface. Real
multiplication on A by OD is an injective ring homomorphism

such that

ρ : OD ֒→ End(A),

1. the action of OD is self-adjoint with respect to H, i.e.
H(ρ(x)(v), w) = H(v, ρ(x)(w))

for all x ∈ OD and v, w ∈ V (here we identify ρ(x) with its analytic
representation).

2. ρ is proper, i.e. there is no injective ring homomorphism

ρ′ : OE ֒→ End(A)
with ρ′|OD = ρ for some order OE % OD in K.

A polarized Abelian surface with real multiplication by OD is a triple

(A, H, ρ),

where (A, H) is a polarized Abelian surface and ρ : OD ֒→ End(A) a choice of
real multiplication on A by OD.

37

Construction of polarized Abelian surfaces with real multiplica-
tion. Let (d1, d2) ∈ N2 with d1 | d2, such that d2
is relatively prime to
the conductor of D and satisﬁes the prime factor condition in OD. Then by
Lemma 5.15, there is an ideal a E OD, such that the trace pairing on OD⊕ 1√D
a
is of type (d1, d2). The ﬁrst step is to construct polarized Abelian varieties with
real multiplication by OD for any such ideal.
Proposition 6.2. Let (d1, d2) ∈ N2 and let a ⊆ OD as above. Then for each
pair z = (z1, z2) ∈ H2, the embedding of groups

d1

φz : OD ⊕ 1√D

a ֒→ C2,

(x, y) 7→ (x + yz1, xσ + yσz2)

yields an Abelian variety Az := C2/Λz for Λz := φz(OD ⊕ 1√D
a). A polariza-
tion Hz of type (d1, d2) is induced by the trace pairing. The polarized Abelian va-
riety (Az, Hz) admits real multiplication by OD, given by the OD-module struc-
ture on OD ⊕ 1√D
Proof. By Lemma 5.16 we can take a Z-basis (η1, η2) of OD satisfying the sign
convention I(η1ησ

2I(√D). Then deﬁning
λ1 := (η1, 0), λ2 := (η2, 0), µ1 := (0, d1√D

2 ), µ2 := (0, −d2√D
ησ

ησ
1 ),

2 ) = − 1

a.

implies that (λ1, λ2, µ1, µ2) is a symplectic basis of (OD ⊕ 1√D
The images of λ1, λ2, µ1, µ2 under φz are linearly independent over R, hence
Az = C2/Λz is a complex torus. Let Ez be the extension of the trace pairing
to C2, i.e. the unique R-bilinear form on C2 with

a,h·,·i).

Ez(φz(λ), φz(λ′)) = hλ, λ′i

for all λ, λ′ ∈ OD ⊕ 1√D

a. The period matrix for Az with respect to the Z-basis

(φz(λ1), φz(λ2), φz(µ1), φz(µ2))

of the lattice Λz and the standard C-basis ((1, 0), (0, 1)) of C2 is

Π = η1

ησ
1

η2
ησ
2

d1√D
−d1√D

2 z1 −d2√D
ησ
d2√D
η2z2

ησ
1 z1

η1z2! .

ησ
1
and then multplying Π from the left with

Setting

yields

1
0

η2
ησ

B :=(cid:18)η1
Bt(cid:18)−z−1
Π′ =(cid:18)Bt(cid:18)−z−1

2(cid:19)
2 (cid:19)
0
−z−1
2 (cid:19) B,(cid:18)d1
0
−z−1
Z := Bt(cid:18)−z−1
2 (cid:19) B.
0
−z−1

1
0

1
0

38

as a period matrix for Az with respect to the same Z-basis of Λz. Let

0

d2(cid:19)(cid:19)

0

Since our ﬁxed Z-basis of Λz is symplectic with respect to the alternating
form Ez, the matrix Im(Z)−1 is the matrix of the Hermitian form Hz corre-
sponding to Ez, with respect to the new C-basis of C2. Obviously, we have
Z ∈ H2, so Hz is indeed a polarization on Az.

Real multiplication ρz : OD ֒→ End(Az) on Az by OD is deﬁned by

ρ : OD ֒→ EndC(C2),

ρ(k)(c1, c2) := (kc1, kσc2)

for all k ∈ OD and (c1, c2) ∈ C2. Then we obviously have

φz(k(x, y)) = ρ(k)φz((x, y))

for all k ∈ OD and (x, y) ∈ OD ⊕ 1√D
a. In particular, ρ(k) acts on Λz and is
self-adjoint with respect to Ez for all k ∈ OD, and thus the triple (Az, Hz, ρz)
is indeed a polarized Abelian surface with real multiplication by OD.

An isomorphism of polarized Abelian surfaces with real multiplication by OD,
say (A, H, ρ) and (A′, H′, ρ′), is an isomorphism of polarized Abelian varieties

f : (A, H) → (A′, H′)

that commutes with the action of OD, i.e. the diagram

A

yρ(k)

A

yρ′(k)

f

−−−−→ A′

f

−−−−→ A′

is commutative for all k ∈ OD.
Proposition 6.3. The triples (Az, Hz, ρz) deﬁned above are up to isomorphism
all polarized Abelian surfaces with real multiplication by OD, where the quotient
of the type is relatively prime to the conductor of D.

Proof. Let (A = V /Λ, H, ρ) be a polarized Abelian surface with real multiplica-
tion by OD, with the quotient of the type (d1, d2) of (A, H) relatively prime to
the conductor of D. We identify ρ with its analytic representation

ρ : OD ֒→ EndC(V ).

Then ρ deﬁnes a proper OD-module structure on Λ. Let E = EH be the
alternating form on Λ induced by H. As an OD-module, Λ is torsion-free, and
we have dimQ(Λ ⊗Z Q) = 4. Hence, by Theorem 5.22 there is a unique ideal a
in OD, such that there is an isomorphism

φ : (OD ⊕ 1√D

a,h·,·i) ∼= (Λ, E).

In particular, (d1, d2) satisﬁes the prime factor condition in OD. As in the proof
of the previous proposition, let (η1, η2) be a Z-basis of OD satisfying the sign
convention I(η1ησ

2I√D. Again we deﬁne
λ1 := (η1, 0), λ2 := (η2, 0), µ1 := (0, d1√D

2 ), µ2 := (0, −d2√D
ησ

ησ
1 )

2 ) = − 1

39

and get (λ1, λ2, µ1, µ2) as a symplectic basis of (OD ⊕ 1√D
homomorphism ρ extends uniquely to a homomorphism of Q-algebras

a,h·,·i). The ring

ρQ : K ֒→ EndC(V ).

We will now determine the eigenvalues of ρQ(k). If k is rational, we have

ρQ(k) = kidV and k = kσ is the only eigenvalue.
Otherwise, if k ∈ K r Q, the minimal polynomial of k with respect to the ﬁeld
extension K/Q is

m(x) = (X − k)(X − kσ) = X 2 − tr(k)X + N (k) ∈ Q[X]

and because of m(ρQ(k)) = 0, we have µρQ(k)(X) | m(X), where µρQ(k)(X)
denotes the minimal polynomial of ρQ(k) ∈ EndC(V ). As the characteristic
polynomial of ρQ(k) as an R-linear map of the 4-dimensional R-vector space V
is equal to the characteristic polynomial of the rational representation of ρQ(k)
and therefore a rational polynomial, both, k and kσ, must be eigenvalues of
ρQ(k).

Summarizing, we have seen that for every k ∈ K the C-linear map ρQ(k) is
With η1, η2 from above, we ﬁx k := η2
η1 ∈ K r Q and choose a C-basis of V ,

diagonalizable and the set of eigenvalues is {k, kσ}.
such that the matrix of ρQ(k) with respect to this basis is

Since ρQ is a Q-algebra homomorphism, the matrix of ρQ(kσ) with respect to
the chosen basis is

0

D(k) :=(cid:18)k
0 kσ(cid:19) .
N (k)D(k)−1 =(cid:18)kσ
k(cid:19) .
1(cid:19) and φ(µ2) =  t d2√D

sησ

0

0

η1!

ησ
1
−u d2√D

φ(λ1) =(cid:18)rη1

With respect to this basis we write

with r, s, t, u ∈ C. Using the representation matrices of ρQ(k) and ρQ(kσ),
we deduce that the period matrix of A with respect to the symplectic basis
(φ(λ1), φ(λ2), φ(µ1), φ(µ2)) is

Π = rη1

sησ
1

rη2
sησ
2

t−d1√D
u d1√D

t d2√D
ησ
2
η2 u −d2√D

ησ
1

η1! .

The columns have to be linearly independent over R, so r, s, t, u 6= 0. Again we
set

and changing the C-basis of V while keeping the same Z-basis of Λ yields the
period matrix

B :=(cid:18)η1

ησ
1

η2
ησ

2(cid:19) ,
2 (cid:19) B,(cid:18)d1
0
−z−1

0

40

Π′ =(cid:18)Bt(cid:18)−z−1

1
0

0

d2(cid:19)(cid:19)

with z1 := − t

r and z2 := − u

s . The matrix

Z := Bt(cid:18)−z−1

1
0

2 (cid:19) B
0
−z−1

has to be in the Siegel upper half space because Im(Z)−1 represents the Hermi-
tian form H, and therefore z1, z2 ∈ H. Thus we get an isomorphism

(A, H) ∼= (Az, Hz)

with z := (z1, z2) ∈ H2. Since for all k ∈ OD the matrix D(k) commutes with
diagonal matrices, this isomorphism is also compatible with the action of OD,
which yields

(A, H, ρ) ∼= (Az, Hz, ρz).

We have seen that polarized Abelian surfaces of a ﬁxed type with real mul-
tiplication by OD are classiﬁed by certain ideals of OD, and this leads to the
following deﬁnition.
Deﬁnition 6.4. Let D ∈ N be a non-square discriminant and let d1, d2 ∈ N
with d1 | d2. Then we denote by XD,(d1,d2) the moduli space of all isomorphism
classes [(A, H, ρ)], where (A, H) is a polarized Abelian surface of type (d1, d2)
that admits real multiplication by OD and ρ : OD ֒→ End(A) is some choice of
real multiplication.
is relatively prime to the conductor of D, we denote by

Furthermore, if d2
d1

Xa ⊆ XD,(d1,d2)

the locus of those isomorphism classes coming from the ideal a in the construc-
tion above.
If [(A, H, ρ)] is in Xa, then we say that (A, H, ρ) is of type a.
(Notice that the type a uniquely determines the type (d1, d2).)

We have seen that for d2
d1

relatively prime to the conductor, XD,(d1,d2) is non-
empty if and only if (d1, d2) satisﬁes the prime factor condition in OD. In this
case the previous proposition, Theorem 5.22 and the proof of Lemma 5.15 tell
us that XD,(d1,d2) is the disjoint union of components Xa, where a runs through
the ideals of the form a = d1a′ with a′ a primitive ideal of OD of norm d2
. For a′
we have 2s choices, where s is the number of splitting prime factors of d2
d1

d1

.

For every such ideal a, there is a surjective map

eΦ : H2 ։ Xa,

z 7→ [(Az, Hz, ρz)].

We now want to make this map injective. To do this, consider the group

SL2(OD ⊕ 1√D

a) := SL  OD

1√D

a

( 1√D

a)−1

OD ! := SL(K) ∩  OD

1√D

a

( 1√D

a)−1

OD ! .

Then M ∈ K 2×2 is in SL2(OD ⊕ 1√D

a) if and only if the map

(x, y) 7→ (x, y) · M t

41

There is also an action of SL2(OD ⊕ 1√D

is a symplectic OD-module automorphism of OD ⊕ 1√D
a.
a) on H2 via
M.(z1, z2) := (M z1, M σz2) =(cid:18) az1 + b

cz1 + d

,

aσz2 + bσ

cσz2 + dσ(cid:19)

for all M =(cid:18)a b

c

d(cid:19) ∈ SL2(OD ⊕ 1√D
ΓD(a) := PSL2(OD ⊕ 1√D

action is {I2,−I2}, thus the Hilbert modular group

a) := SL2(OD ⊕ 1√D

a)/{I2,−I2}

a) and (z1, z2) ∈ H2. The kernel of this

acts faithfully on H2.
Proposition 6.5. For all M ∈ SL2(OD ⊕ 1√D

a) and z ∈ H2 we have

(Az, Hz, ρz) ∼= (AMz, HMz, ρMz).

a)

d(cid:19) ∈ SL2(OD ⊕ 1√D
d(cid:19) ∈ SL2(OD ⊕ 1√D

a)

Proof. For

and (z1, z2) ∈ H2 we deﬁne

c

M =(cid:18)a b
M∗ :=(cid:18) a −b
D(M, z) :=(cid:18)(cz1 + d)−1
φz((x, y)) · D(M, z)t =(cid:18) yz1 + x

cz1 + d

−c

0

Then we have

and

0

(cσz2 + dσ)−1(cid:19) ∈ GL2(C).
cσz2 + dσ(cid:19) = φMz ((x, y) · (M∗)t)

yσz2 + xσ

,

for all (x, y) ∈ OD ⊕ 1√D

a, i.e. the diagram

OD ⊕ 1√D

φz−−−−→ C2

OD ⊕ 1√D

φM z−−−−→ C2

a

a

yM∗

yD(M,z)

is commutative. Therefore,

C2 → C2,
is the desired isomormorphism.

(x, y) 7→ (x, y) · D(M, z)t

Thus we have a well-deﬁned surjective map
a)\H2 ։ Xa,

Φ : PSL2(OD ⊕ 1√D

[z] 7→ [(Az, Hz, ρz)]

and we can state the main theorem of this subsection.

42

d1

Theorem 6.6. Let D ∈ N be a non-square discriminant and let d1, d2 ∈ N
with d1 | d2 and d2
relatively prime to the conductor of D. Then XD,(d1,d2)
is non-empty if and only if (d1, d2) satisﬁes the prime factor condition in OD.
In this case XD,(d1,d2) consists of 2s irreducible components Xa, where s is the
number of splitting prime divisors of d2
. For each component Xa deﬁned by the
d1
ideal a, we have an isomorphism

Φ : PSL2(OD ⊕ 1√D

a)\H2 ∼= Xa,

[z] 7→ [(Az, Hz, ρz)]

between the corresponding Hilbert modular surface and Xa.

Proof. It remains to show that Φ is injective. To do this, let z = (z1, z2),
˜z = (˜z1, ˜z2) ∈ H2 and let

f : (Az, Hz, ρz) → (A˜z, H˜z, ρ˜z)

be an isomorphism of polarized Abelian varieties with real multiplication by OD.
The key idea of the proof is to compare the rational representation with the
analytic representation.

Let B = (λ1, λ2, µ1, µ2) be the symplectic basis of (OD ⊕ 1√D

the construction of (Az, Hz) above, i.e.

a,h·,·i) as in

λ1 = (η1, 0), λ2 = (η2, 0), µ1 = (0, d1ησ
2√D

), µ2 = (0, −d2ησ
1√D

).

Furthermore, let R = (rij )i,j ∈ GL4(Z) be the matrix of the rational represen-
tation

of f with respect to the Z-bases φz(B) and φ˜z(B). Then R is also the matrix of

ρr(f ) : Λz → Λ˜z

F := φ−1

˜z ◦ ρr(f ) ◦ φz : OD ⊕ 1√D

a → OD ⊕ 1√D

a

with respect to the Z-basis (λ1, λ2, µ1, µ2). Setting k := η2
η1
get kλ1 = λ2 and lµ2 = µ1. Let

and l := − d1

d2

kσ, we

π1 : K ⊕ K → K ⊕ K,

(x, y) 7→ (x, 0)

be the canonical projection onto the ﬁrst factor and let FQ : K ⊕ K → K ⊕ K
be the extension of F to K ⊕ K by tensoring with Q. For the composition
F1 := π1 ◦ FQ we have

F1(λ1) = (r11 + r21k)λ1 and F1(λ2) = (r12k−1 + r22)λ2.

As F1 is K-linear and λ2 = kλ1, this yields

a := r11 + r21k = r12k−1 + r22.

Similarly, we get

= −N (k) d1
b
c
d := r33 + r43l−1 = r34l + r44.

:= r13 + r23k
:= r31 + r41l−1 = −1
N (k)

d2
d1

(r14k−1 + r24)

d2
(r32l + r42)

43

Hence, we have

F (λ1) = r11λ1 + r21λ2 + r31µ1 + r41µ2 = aλ1 + cµ1

and analogously

If we deﬁne

cµ2

d2

bλ2 + dµ2.

F (λ2) = aλ2 − N (k) d1
F (µ1) = bλ1 + dµ1
d2
F (µ2) = − 1
N (k)
d1
M := 

√D
d1
d

a
− d1√D

ησ
2
η1

−

c

η1
ησ
2

b

!

and M∗ in the same way as in the proof of Proposition 6.5, one can easily
compute that for all (x, y) ∈ OD ⊕ 1√D

a we have

F ((x, y)) = (x, y)(M∗)t.

Since F is a symplectic OD-module automorphism, M∗ lies in SL2(OD ⊕ 1√D
hence M ∈ SL2(OD ⊕ 1√D
tation with respect to the standard C-basis ((1, 0), (0, 1)) of C2 is

An elementary computation yields that the matrix of the analytic represen-

a) and thus ad − bc = 1.

a),

A = a + d1√D

0

ησ
2
η1

c˜z1

0
aσ − d1√D

η2
ησ
1

cσ ˜z2! .

Now let Π andeΠ be the period matrices of Az and A˜z with respect to the chosen
bases, so we have AΠ = eΠR. Comparing the matrix entries and using all the

relations above, we see that this equation holds if and only if ˜z = M z. It follows
that Φ is indeed injective.

a) and the genus class group of OD.

6.2 Counting modular surfaces
As varieties, two Hilbert modular surfaces Γ1\H2 and Γ2\H2 are obviously
isomorphic, if the groups Γ1, Γ2 ⊂ SL2(Q(√D)) are conjugate.
In this sec-
tion we show that there is a bijection between the set of conjugacy classes of
SL(OD ⊕ 1√D
Genus of quadratic orders. Let K ⊂ R be a real quadratic number ﬁeld
and let K + be the multiplicative group of all totally positive elements in K (an
element x ∈ K is said to be totally positive, x ≫ 0, if both x > 0 and xσ > 0).
Let OD be the order in a real quadratic number ﬁeld K of discriminant D > 0
and conductor f . Recall that I(OD) is the group of invertible fractional ideals
of OD. We denote the ideal class group of OD by
Cl(OD) := I(OD)/K∗.

Two ideals a1, a2 ∈ I(OD) are deﬁned to be equivalent in the narrow sense or
strictly equivalent (denoted by a1 ∼+ a2) if there is some x ∈ K + such that
a1 = xa2. The equivalence classes form a group

Cl+(OD) := I(OD)/K +,

44

the narrow ideal class group. Furthermore, the squaring map is deﬁned by

Sq+ : Cl+(OD) → Cl+(OD),

a 7→ a2.

Deﬁnition 6.7. The factor group

G(OD) := Cl+(OD)/Sq+(Cl+(OD))

is called the genus group of OD, a coset of Sq+(Cl+(OD)) is called a genus and
Sq+(Cl+(OD)) is called the principal genus.

Now we want to count the number of conjugacy classes of groups of the form
SL(OD ⊕ 1√D
a), to get an upper bound for the number of isomorphy classes of
the Hilbert modular varieties Xa = SL2(OD ⊕ 1√D
a)\H2, where a runs through
the set I+(O, f ) of ideals relatively prime to the conductor f of D (without
ﬁxing the norm d).
Lemma 6.8. Let a1 and a2 be two invertible, fractional ideals of OD. Then the
two matrix algebras

a1 OD(cid:19) and (cid:18)OD a−1
(cid:18)OD a−1
a2 OD(cid:19)

1

2

are conjugate in K 2×2 if and only if a1 and a2 belong to the same genus.

Proof. If a1 and a2 belong to the same genus, then we have by deﬁnition

a2 = xb2a1

for an invertible ideal b and some totally positive x ∈ K. We claim that there
is a matrix

with determinant 1. Indeed, by Corollary 5.11 it suﬃces to show that for any
two invertible, relatively prime OD-ideals a and b there is a matrix in

M ∈(cid:18) b

a1b

a−1
1 b−1

b−1 (cid:19)

(cid:18)b a−1
a b−1(cid:19)

with determinant 1. But this is clear, since 1 lies in each of a + b, a−1 and b−1.

Now we can compute directly

respectively

1

0

0

(cid:18)x−1
M(cid:18)x 0

1(cid:19) M−1(cid:18)OD a−1
a2 OD(cid:19)(cid:18)x−1
1(cid:19)(cid:18)OD a−1
To prove the converse, let M =(cid:18)a b

0

0

2

which shows equality.

a1 OD(cid:19) M(cid:18)x 0

2

0

1(cid:19) ⊆(cid:18)OD a−1
a2 OD(cid:19)
a1 OD(cid:19) ,
1(cid:19) M−1 ⊆(cid:18)OD a−1

0

1

c d(cid:19) ∈ GL2(K) with
a1 OD(cid:19) M−1 =(cid:18)OD a−1
a2 OD(cid:19) .

M(cid:18)OD a−1

1

2

45

Comparing the lower left entries gives

a2 = 1

det(M) (cdOD + d2a1 + c2a−1
and the invertibility of b = dOD + ca−1
fractional ideal b2 = det(M )a−1

1

1 a2.

1 ) = 1

det(M) (dOD + ca−1

1 )2a1

follows from the invertibility of the

Corollary 6.9. For two invertible fractional ideals a1 and a2, the two groups
SL(OD ⊕ a1) and SL(OD ⊕ a2) are conjugate in GL2(K) if and only if a1 and a2
belong to the same genus.

Proof. This follows from the same arguments as in the previous proof, together

with the fact that(cid:16) OD a−1

a OD(cid:17) is generated by SL2(OD⊕ 1√D

a) as a Z-algebra.

6.3 The moduli space in dimension three

Now we will use the results of the previous section to parameterize all princi-
pally polarized Abelian varieties isogenous to a product of an Abelian surface
with real multiplication and an elliptic curve. We will show that the moduli
space of principally polarized Abelian varieties together with the choice of a
two-dimensional Abelian subvariety of a ﬁxed type and a choice of real mul-
tiplication by a ﬁxed order OD is the union of 2s three-dimensional Hilbert
modular varieties, where the number s is determined by the type and the dis-
criminant. For this, we will combine the techniques developed in the previous
section and those in [Xia85], where Xiao parameterized principally polarized
Abelian Surfaces isogenous to a product of elliptic curves.
Deﬁnition 6.10. Let D ∈ N be a discriminant and let d ∈ N. A polarized
Abelian variety of dimension three with real multiplication by OD of type d is
a quadruple

(A, H, S, ρ),

where (A, H) is a three-dimensional principally polarized Abelian variety, S is
a two-dimensional subvariety of A of type (1, d) and ρ : OD → End(S) is some
choice of real multiplication by OD on S.

Recall that the complementary subvariety of S in A in the deﬁnition above

is of type (d), as (A, H) is principal.

Construction of three-dimensional Abelian varieties with real multi-
plication on a subsurface. Again let D be a squarefree discriminant and let d
be relatively prime to the conductor of D. We will see that there are diﬀerent
similar ways to construct polarized Abelian varieties of dimension three with
real multiplication by OD of type d, corresponding to the choice of a Z-basis of
certain ideals of OD.
We already know that there is no such Abelian variety if d does not satisfy
the prime factor condition in OD. In the other case, recall that there exists a
primitive ideal a in OD of norm d and a Z-basis (η1, η2) of OD satisfying the
2 ) = − 1
sign convention I(η1ησ
1 ) is a Z-basis of a. We
have seen that this means that

2I(√D), such that (ησ

2 , dησ

((η1, 0), (η2, 0), (0, 1√D

ησ
2 ), (0, −d√D

ησ
1 ))

46

1 ) a smart basis for a.

a,h·,·i), where h·,·i is the trace pairing on
2 , dησ

is a symplectic basis of (OD ⊕ 1√D
OD ⊕ O∨D. We call such a basis (ησ
Proposition 6.11. Let d ∈ N be relatively prime to the conductor of D and
satisfying the prime factor condition in OD. Furthermore, let a be a primitive
ideal of OD of norm d. Then, ﬁxing a smart basis (ησ
1 ) for a, each triple z =
(z1, z2, z3) ∈ H3 determines a polarized Abelian variety (Az = C3/Λz, Hz, Sz, ρz)
of dimension three with real multiplication by OD of type d. Identifying C2×{0}
with C2, we have Sz = C2/(C2∩ Λz), and the polarized Abelian surface with real
multiplication (Sz, Hz|C2×C2 , ρz) is the one deﬁned by

2 , dησ

φ(z1,z2) : OD ⊕ 1√D

a ֒→ C2,

(x, y) 7→ (x + yz1, xσ + yσz2)

as in Proposition 6.2.

Proof. We start with constructing the three-dimensional principally polarized
Abelian variety. In C3 we deﬁne

2 z1, −1√D
ησ
1 z1, 1√D
ησ
d η2, 1
2 ,− 1
d ησ
These vectors are linearly independent over R, hence

λ1 := (η1, ησ
λ2 := (η2, ησ
λ3 := (0, 0, 1),

1 , 0), µ1 := ( 1√D
2 , 0), µ2 := ( −1√D

µ3 := ( 1

η2z2, 0),
η1z2, 1
d ),
d z3).

Λz := hλ1, λ2, λ3, µ1, µ2, µ3iZ

is a lattice in C3 and Az := C3/Λz is a complex torus. Let Ez : C3 × C3 → R
be the unique alternating R-bilinearform with Ez(λi, λj ) = Ez(µi, µj) = 0 and
Ez(λi, µj) = δij for all i, j ∈ {1, 2, 3}, and let Hz : C3 × C3 → C be the corre-
sponding Hermitian form. Then Ez is a symplectic form on Λz of type (1, 1, 1)
with symplectic basis (λ1, λ2, λ3, µ1, µ2, µ3). The period matrix of Az with re-
spect to this Z-basis of Λz and the standard C-basis ((1, 0, 0), (0, 1, 0), (0, 0, 1))
of C3 is

η1
ησ
1
0

Πz =
B :=

η1
ησ
1
0

With

we get

η2
ησ
2
0

0
0
1

1√D
−1√D

ησ
2 z1
η2z2
0

−1√D
1√D

ησ
1 z1
η1z2
1
d

1
d η2
1
d ησ
2
− 1
d z3

η2
ησ
2
0

0
0

1 and Z :=

−z1
0
1
d η2

Πz = (B, Z(B−1)t),

 .


0
−z2
d ησ

1
d η2
1
d ησ
2
2 − 1
d z3

1

and as −B−1Z(B−1)t is in the upper Siegel half space H2, the form Hz is indeed
a polarization on Az.

With V2 := C2 × {0} and

we have

ˆµ2 := dµ2 − λ3 = ( −d√D

ησ
1 z1, d√D

η1z2, 0)

Λ2 := V2 ∩ Λz = hλ1, λ2, µ1, ˆµ2iZ.

47

Thus Λ2 is a lattice in V2 and Sz := V2/Λ2 is a subvariety of Az of type (1, d)
with symplectic basis (λ1, λ2, µ1, ˆµ2). Note that Λ2 is just the image of the
embedding

φ(z1,z2) : OD ⊕ 1√D

a ֒→ C3,

(x, y) 7→ (x + yz1, xσ + yσz2, 0),

a,h·,·i) to (λ1, λ2, µ1, ˆµ2).

which maps our symplectic basis ((η1, 0), (η2, 0), (0, 1√D
1√D
As in the previous section, we deﬁne real multiplication ρz : OD ֒→ End(Sz)
on Sz by OD via

ησ
1 )) of (OD⊕

2 ), (0, −d√D
ησ

ρ : OD ֒→ EndC(V2),

ρ(k)(c1, c2, 0) := (kc1, kσc2, 0)

for all k ∈ OD and c1, c2 ∈ C.
Collecting everything together, we have seen that (Az, Hz, Sz, ρz) is indeed
a polarized Abelian variety of dimension three with real multiplication by OD
of type d.

We remark that in the proof above, the orthogonal complement of V2 in C3
with respect to Hz is V1 := {0}2×C, and that a symplectic basis of Λ1 := V1∩Λ
for Ez|Λ1×Λ1 is given by (ν1, ν2) with

ν1 := λ3 = (0, 0, 1) and ν2 := dµ3 − λ2 = (0, 0,−z3).

An isomorphism of polarized Abelian varieties of dimension three with real
multiplication by OD, say (A, H, S, ρ) and (A′, H′, S′, ρ′), is an isomorphism of
polarized abelian varieties

f : (A, H) → (A′, H′)

with f (S) = S′, such that f|S commutes with the action of OD.
Proposition 6.12. Let d ∈ N be relatively prime to the conductor of D. Fix-
ing a smart basis for each primitive ideal a ⊆ OD of norm d, the quadruples
(Az, Hz, Sz, ρz) deﬁned above are up to isomorphism all polarized Abelian vari-
eties of dimension three with real multiplication by OD of type d. More precisely,
we deﬁne

and

Az = C3/Λz with Λz = ΠzZ6

η1
ησ
1
0

η2
ησ
2
0

0
0
1

1√D
−1√D

ησ
2 z1
η2z2
0

−1√D
1√D

ησ
1 z1
η1z2
1
d

Πz =

1
d η2
1
d ησ
2
− 1
d z3



2 , dησ

for a smart basis (ησ
the polarization Hz by symplectic pairing the columns of Πz,
Sz = V2/(V2 ∩ Λz) with V2 = C2 × {0}

1 ) of an ideal a in OD and z = (z1, z2, z3) ∈ H3 and

and the real multiplication ρz on Sz is deﬁned by

ρ : OD ֒→ EndC(V2),

ρ(k)(c1, c2, 0) := (kc1, kσc2, 0)

for all k ∈ OD and c1, c2 ∈ C.

48

Proof. Let d ∈ N be relatively prime to the conductor of D and let (A, H, S, ρ)
be a polarized Abelian variety of dimension three with real multiplication by OD
of type d. We have A = V /Λ for a three-dimensional C-vector space V and a
lattice Λ in V and S = V2/Λ2 with V2 ≤ V , dimC(V2) = 2 and Λ2 := V2 ∩ Λ,
and we write H2 for H|V2×V2.
We have seen in Proposition 6.3, that there is an isomorphism of polarized
Abelian varieties with real multiplication by OD,

f : (Az, Hz, ρz) → (S, H2, ρ),

where (Az = C2/Λz, Hz, ρz) is a polarized Abelian surface with real multi-
plication by OD for a primitive ideal a of norm d in OD and for some pair
z = (z1, z2) ∈ H2.
2 , dησ
1 ) be any smart basis for a and let F := ρa(f ) be the analytic
representation of f . Then

Let (ησ

(F ((η1, ησ

1 )), F ((η2, ησ

2 )), F (( 1√D

2 z1, −1√D
ησ

η2z2)), F (( −d√D

ησ
1 z1, d√D

η1z2)))

is a symplectic basis of (S, H2), denoted by (λ1, λ2, µ1, ˆµ2). Since the two vectors
v1 := F ((1, 0)) and v2 := F ((0, 1)) form a C-basis of V2, we get

λ1 = η1v1 + ησ
λ2 = η2v1 + ησ

1 v2, µ1 = ( 1√D
ˆµ2 = ( −d√D
2 v2,

2 z1)v1 + ( −1√D
ησ
1 z1)v1 + ( d√D
ησ

η2z2)v2,
η1z2)v2,

and the real multiplication is given by

ρ(k)(c1v1 + c2v2) = (kc1)v1 + (kσc2)v2

for all k ∈ OD and c1, c2 ∈ C, as desired.
basis (λ1, λ2, µ1, ˆµ2) nor the C-basis (v1, v2) during the rest of the proof.

It is important to keep in mind, that we will neither change the symplectic

We denote by V1 the orthogonal complement of V2 in V with respect to H
and by H1 := H|V1×V1 the induced polarization on A1 := V1/Λ1 for Λ1 := V1∩Λ.
Furthermore, for Λ′ := Λ1⊕Λ2 let H′ be the induced polarization on A′ := V /Λ′.
Since (A2, H2) is of type (1, d), we know that (A′, H′) is of type (1, d, d), and so
by Lemma 4.8 we have

|Λ/Λ′| = d2.

For i ∈ {1, 2}, let πi : V → Vi be the canonical projection and let Λi := πi(Λ)
be the induced lattice in Vi. For the alternating form E2 corresponding to H2,
we have E2(Λ2, Λ2) ⊆ Z and therefore Λ2 ⊆ hλ1, 1

d ˆµ2iZ. Because

d λ2, µ1, 1

ϕi : Λ/Λ′ → Λi/Λi,

[λ] 7→ [πi(λ)]

is an isomorphism of groups and hence |Λi/Λi| = d2, we even have

Λ2 = hλ1, 1

d λ2, µ1, 1

d ˆµ2iZ,

in particular

Λ/Λ′ ∼= Λi/Λi ∼= Z2
d.
d λ2 + λ′, 1
There are λ′, µ′ ∈ Λ1, unique up to Λ1, with 1
d µ2 + µ′ ∈ Λ. As ϕ1
and ϕ2 are isomorphisms, we know that ([λ′], [µ′]) is a basis (in the sense of

49

Lemma 4.14) of Λ1/Λ1 and so by Lemma 4.14 there is a basis (ν1, ν2) of Λ1
and l, m ∈ N with 1 ≤ l, m ≤ d and (l, d) = (m, d) = 1, such that λ′ = l
d ν2
and µ′ = m
d ν1. We can write ν2 = −z3ν1 with z3 ∈ C \ R. If Im(z3) < 0, we
can choose −ν2 and λ′ − ν2 = d−l
d (−ν2) instead of ν2 and λ′, so without loss
of generality we may assume z3 ∈ H. Now we take n ∈ N with 1 ≤ n ≤ d and
nl ≡ 1 mod d and deﬁne

µ2 := 1

d (ˆµ2 + mν1), µ3 := 1

d (nλ2 + ν2) = n( 1

d λ2 + λ′) + 1−nl

d ν2 ∈ Λ.

Then we have hλ1, λ2, µ1, ˆµ2, ν1, ν2iZ = Λ′ and h[µ2], [µ3]i = Λ/Λ′ and hence

hλ1, λ2, µ1, ˆµ2, ν1, ν2, µ2, µ3iZ = Λ.

As Im(z3) > 0, it follows

and

EH (ν1, ν2) = Im(z3)H(ν1, ν1) = +d

EH (µ2, µ3) = 1

d (m − n).

Because EH (µ2, µ3) is an integer, we see by the choice of m and n, that m = n
and EH (µ2, µ3) = 0, so with λ3 := ν1, we have that (λ1, λ2, λ3, µ1, µ2, µ3) is a
symplectic basis of (A, H).

To show that we can always choose m = 1, let us assume m 6= 1. Since m

and d2 are relatively prime, there are a, b ∈ Z with am − bd2 = 1. Hence

µ′′ := 1

d (λ2 + aν2) = aµ3 − am−1

d λ2

is in Λ and we deﬁne

and

µ′2 := µ2 + bν2, µ′3 := µ′′ + ν1 ∈ Λ
(cid:18)ν′1
ν2(cid:19) .
ν′2(cid:19) :=(cid:18)m bd
a(cid:19)(cid:18)ν1
We get a new symplectic basis (ν′1, ν′2) for (A1, H1) with ν′2 = −z′3ν′1 for some
z3 ∈ H and deﬁne λ′3 := ν′1. Also note that we have now
d (λ2 + ν′2)

d (ˆµ2 + ν′1), µ′3 = 1

µ′2 = 1

d

and can replace the symplectic basis (ν1, ν2) of (A1, H1) by (ν′1, ν′2) and the
symplectic basis (λ1, λ2, λ3, µ1, µ2, µ3) of (A, H) by (λ1, λ2, λ′3, µ1, µ′2, µ′3). This
shows that we can assume without loss of generality m = n = 1. Then with
v1, v2 deﬁned at the beginning of the proof and v3 := ν1, our period matrix of A
with respect to this symplectic basis and the C-basis (v1, v2, v3) of V is indeed

Πz =

η1
ησ
1
0

η2
ησ
2
0

0
0
1

1√D
−1√D

ησ
2 z1
η2z2
0

−1√D
1√D

ησ
1 z1
η1z2
1
d

1
d η2
1
d ησ
2
− 1
d z3

 ,

which ends the proof.

50

As in the two-dimensional case, we have seen that polarized Abelian varieties
of dimension three with real multiplication by OD of a ﬁxed type d are classiﬁed
by certain ideals of OD, and this leads to the following deﬁnition.
Deﬁnition 6.13. Let D ∈ N be a non-square discriminant and let d ∈ N.
Then we denote by X (3)
D,d the set of all isomorphism classes [(A, H, S, ρ)], where
(A, H, S, ρ) is a polarized Abelian variety of dimension three with real multipli-
cation by OD of type d.

Furthermore, if d is relatively prime to the conductor of D, we denote by

X (3)
a ⊆ X (3)

D,d

the locus of those isomorphism classes [(A, H, S, ρ)], where (S, H|S, ρ) is of
type a. If [(A, H, S, ρ)] is in X (3)
a , then we also say that (A, H, S, ρ) is of type a.

As in the two-dimensional case, it follows that for d relatively prime to the
conductor, X (3)
D,d is non-empty if and only if d satisﬁes the prime factor condition
in OD. In this case it is the disjoint union of 2s components X (3)
a , where a runs
through all primitive ideals of OD of norm d and s is the number of splitting
prime factors of d.

We ﬁx an ideal a of OD of norm d and a smart basis (ησ

we want to make the surjective map

2 , dησ

1 ) for a. Again

a ,

eΦ : H3 ։ X (3)

z 7→ [(Az, Hz, Sz, ρz)]

The group SL2(OD ⊕ 1√D

injective by factoring out the appropriate group action.
a) × SL2(Z) acts on H3 via
(A, B).(z1, z2, z3) := (Az1, Aσz2, Bz3)

for all (A, B) ∈ SL2(OD⊕ 1√D
a)× SL2(Z) and (z1, z2, z3) ∈ H3, where the action
on the components is given by M¨obius transformations. We will see that this
group is slightly to big, and that the correct group involves the choice of the
smart basis. With this in mind, we set

S := S(D, d, η1, η2) := 0

1

√D
d

η2
ησ
1

0 !

and

Lemma 6.14.

MD,d(η1, η2) :=  d

η2 OD
d√Dη2
a

√D
1 OD
ησ
1
ησ
1

a ! ⊂ M2(K).

ΓD,d(η1, η2) = {(A, B) ∈ SL2(OD⊕ 1√D
is a subgroup of SL2(OD ⊕ 1√D

a) × SL2(Z).

a)×SL2(Z) : A−SBS−1 ∈ MD,d(η1, η2)}

51

Proof. For all B ∈ SL2(Z), we deﬁne B := SBS−1.

First, let (A1, B1), (A2, B2) ∈ ΓD,d(η2, η2). From the inclusions

SL2(OD ⊕ 1√D

a) · MD,d(η1, η2) ⊆ MD,d(η1, η2)

and

we get

MD,d(η1, η2) · S · SL2(Z) · S−1 ⊆ MD,d(η1, η2),

A1A2 − B1B2 = A1(A2 − B2) + (A1 − B1)B2 ∈ MD,d(η1, η2),

and therefore (A1, B1) · (A2, B2) is in ΓD,d(η1, η2).
in MD,d(η1, η2).

It is obvious that (I2, I2) lies in ΓD,d(η1, η2), because the zero matrix is

It remains to show that for any (A, B) ∈ ΓD,d(η1, η2), its inverse (A−1, B−1)

also lies in ΓD,d(η1, η2). We write

γ

A − B =(cid:18)α β
δ(cid:19)
√D
1 OD, γ ∈ d√Dη2
ησ

a, δ ∈ 1

ησ
1

a.

η2OD, β ∈
a) and B ∈ SL2(Z), we even get
α ∈ d

η2 OD ∩ OD and δ ∈ 1
=(cid:18) δ −β
α (cid:19) ,

A−1 − B−1

−γ

ησ
1

a ∩ OD.

d

η2 OD ∩ OD = hd, d η1

η2iZ ∩ OD

with

α ∈ d
As A ∈ SL2(OD ⊕ 1√D

it is suﬃcient to show that

Since

and

1 iZ ∩ OD
are the same ideals of OD. Recall that we can write

2
ησ

1
ησ
1

a ∩ OD = hd, ησ
(cid:18)η1
η2(cid:19) =(cid:18)a1

a3

a2

a4(cid:19)(cid:18)1
γ(cid:19)

with γ = D+√D

2

In particular η1ησ

and a1a4 − a2a3 = 1. Then an elementary computation yields

η1ησ

2 = (a1a3 + a2a4N (γ) + a1a4D) − γ.

2 is primitive in OD. Now we deﬁne
1 ∈ OD} ⊆ Q.

2
ησ

I := {x ∈ Q : x ησ
2 and η1ησ

= 1

We have ησ
2
ησ
1
we take an arbitrary z ∈ hd, d η1

N (η1) η1ησ

η2 iZ ∩ OD, i.e.

2 is primitive in OD, hence I = N (η1)Z. Now

z = xd + yd η1
η2

= xd + ydN ( η1

η2

) ησ
2
ησ
1

52

with x, y ∈ Z and the additional condition that z lies in OD. Then ydN ( η1
in I ⊆ Z, and thus z is in hd, ησ
For the reverse inclusion, note that [OD : a] = d and ησ
2 OD] ∈ dZ.

2 ∈ a implies

1 iZ.

2
ησ

η2

) is

For an arbitrary z ∈ hd, ησ

2
ησ

N (η2) = [OD : ησ
1 iZ ∩ OD,
z = xd + y ησ
2
ησ
1

= xd + y

N (η1)N (η2) η1

η2

with x, y ∈ Z and the additional condition that z lies in OD, the fact that
y ∈ I and d | N (η2) implies that z is in hd, d η1
sition states that the map eΦ : H3 ։ X (3)

Thus we have a group action of ΓD,d(η1, η2) on H3, and the following propo-
factorizes through the corresponding

quotient map.
Proposition 6.15. For each γ ∈ ΓD,d(η1, η2) and z ∈ H3, we have

η2 iZ.

a

(Az, Hz, Sz, ρz) ∼= (Aγ.z, Hγ.z, Sγ.z, ργ.z).

Proof. We write z = (z1, z2, z3), γ.z = (˜z1, ˜z2, ˜z3) and

γ = (A, B) =(cid:18)(cid:18)a1 a2

a3 a4(cid:19) ,(cid:18)b1

b3

Furthermore, we deﬁne

D(γ, z) :=

(a3z1 + a4)−1

0
0

and

0

(aσ

3 z2 + aσ

4 )−1

0

b2

b4(cid:19)(cid:19) .
(b3z3 + b4)−1

0
0

F : C3 → C3,

v 7→ D(γ, z) · v.

We want to show that F is the analytic representation of an isomorphism

(Az = C3/Λz, Hz, Sz, ρz) ∼= (Aγ.z = C3/Λz, Hγ.z, Sγ.z, ργ.z).

Identifying C2 × {0} with C2 and using the notations from Proposition 6.2, we
have Sz = C2/Λ(z1,z2) and Sγ.z = C2/Λ(˜z1,˜z2). As A is in SL2(OD ⊕ 1√D
a), we
have seen in the proof of Proposition 6.5, that

F2 := F|C2 : C2 → C2

deﬁnes an isomorphism of polarized Abelian surfaces with real multiplication

f2 : Sz → Sγ.z,

[x] 7→ [F2(x)].

We also identify C with {(0, 0)} × C. Denoting the complementary subvariety

of Sz respectively Sγ.z by C respectively eC, we get C = C/Λz3 and eC = C/Λ˜z3

53

with Λz3 = h1, z3iZ and Λ˜z3 = h1, ˜z3iZ. Since B is in SL2(Z), the C-linear map
F1 := F|C : C → C induces an isomorphism of polarized elliptic curves

f1 : C → eC,

[x] 7→ [F1(x)].

Thus F is an isomorphism of C-vectorspaces preserving the Hermitian forms
and the OD-module structure.
forms, it suﬃces to show that F (Λz) is contained in Λγ.z.

It remains to prove that F maps Λz onto Λγ.z. As F preserves the Hermitian

Recall that Z-bases of Λ(z1,z2) and Λ(˜z1,˜z2) are given by (λ1, λ2, µ1, µ′2) and

(λ1, λ2, ˜µ1, ˜µ′2) with

λ1 := (η1, ησ
1 , 0),
2 z1, −1√D
µ1 := ( 1√D
ησ
µ′2 := ( −d√D
1 z1, d√D
ησ

η2z2, 0),
η1z2, 0),

λ2 := (η2, ησ
2 , 0),
2 ˜z1, −1√D
˜µ1 := ( 1√D
ησ
˜µ′2 := ( −d√D
1 ˜z1, d√D
ησ

η2 ˜z2, 0),
η1 ˜z2, 0).

Let R = (rij )i,j ∈ GL4(Z) be the matrix of the rational representation of f2
with respect to these bases. We have seen in the proof of Proposition 6.5, that

F ′2 := φ−1

(˜z1,˜z2) ◦ F2|Λ(z1 ,z2) ◦ φ(z1,z2) : OD ⊕ 1√D
is given by multiplication with the matrix A∗ =(cid:0) a1 −a2

Moreover, we have seen in the proof of Theorem 6.6 that

−a3 a4 (cid:1) ∈ SL2(OD ⊕ 1√D

a → OD ⊕ 1√D

a

a).

A = 

r12
1√D

η1
η2
ησ
2
η2

+ r22
+ r42

d√D

ησ
1
η2

r14

−r32

√D
d

−r34

√D
d

+ r44 ! .

η2
ησ
1

+ r24
ησ
2
ησ
1

η1
ησ
1
1
d

The matrix of the rational representation f1 with respect to the symplectic
bases (ν1, ν2) := ((0, 0, 1), (0, 0,−z3)) of Λz3 and (˜ν1, ˜ν2) := ((0, 0, 1), (0, 0,−˜z3))
of ˜Λ˜z3 is just B.

Now consider the Z-basis (λ1, λ2, λ3, µ1, µ2, µ3) of Λz with

λ3 := ν1, µ2 := 1

d (µ′2 + ν1), µ3 := 1

d (λ2 + ν2)

and the Z-basis (λ1, λ2, λ3, ˜µ1, ˜µ2, ˜µ3) of Λ˜z with

˜µ2 := 1

d (˜µ′2 + ν1), ˜µ3 := 1

d (λ2 + ˜ν2).

We already know that F (λ1), F (λ2), F (λ3) and F (µ1) lie in Λ(˜z1,˜z2)+Λ˜z3 ⊆ Λγ.z.
Therefore, it remains to show that both

F (µ2) = 1
= 1

d (r14λ1 + r24λ2 + r34 ˜µ1 + r44 ˜µ′2 + b1ν1 + b3˜ν2)
d (r14λ1 + (r24 − b3)λ2 + r34 ˜µ1 + (b1 − r44)λ3) + r44 ˜µ2 + b3 ˜µ3

and

F (µ3) = 1
= 1

d (r12λ1 + r22λ2 + r32 ˜µ1 + r42 ˜µ′2 + b2ν1 + b4˜ν2)
d (r12λ1 + (r22 − b4)λ2 + r32 ˜µ1 + (b2 − r42)λ3) + r42 ˜µ2 + b4 ˜µ3

are in Λ˜z, and this holds if and only if

r14, r24 − b3, r34, r44 − b1, r12, r22 − b4, r32, r42 − b2 ∈ dZ.

(3)

54

Then, computing

1 ))! ,
A − SBS−1 = 
we see that condition (3) holds if and only if A− SBS−1 is in MD,d(η1, η2). But
this holds since (A, B) is in ΓD,d(η1, η2), and thus

d η1 + r22−b4
2 + r42−b2
d ησ

√D
ησ
1
(−r34

( r12
d
η2
(−r32

η2)
(dησ

( r14
d ησ

d η1 + r24−b3
d
2 + r44−b1

d

η2)
(dησ

d√Dη2

d

d

1 ))

1
ησ
1

f : Az → A˜z,

[x] 7→ [F (x)]

is indeed the desired isomorphism of polarized Abelian varieties of dimension
three with real multiplication by OD of type d.

Again it follows that we have a well-deﬁned surjective map

Φ : ΓD,d(η1, η2)\H3 ։ X (3)

a ,

[z] 7→ [(Az, Hz, Sz, ρz)],

and we can state the main theorem of this subsection.
Theorem 6.16. Let D ∈ N be a non-square discriminant and let d ∈ N be
relatively prime to the conductor of D. Then X (3)
D,d is non-empty if and only
if d satisﬁes the prime factor condition in OD. In this case X (3)
D,d consists of 2s
irreducible components X (3)
a , where s is the number of splitting prime divisors
of d. For each component X (3)
deﬁned by the ideal a we have an isomorphism

a

Φ : ΓD,d(η1, η2)\H3 ∼= X (3)

a ,

[z] 7→ [(Az, Hz, sz, ρz)]

between the corresponding Hilbert modular variety and X (3)
a .

Proof. It remains to show that Φ is injective. To do this, let z = (z1, z2, z3),
˜z = (˜z1, ˜z2, ˜z3) ∈ H3 such that there exists an isomorphism
f : (Az, Hz, Sz, ρz) → (A˜z, H˜z, S˜z, ρ˜z)

of polarized abelian varieties of dimension three with real multiplication by OD
of type d. As in the proof of the previous proposition, we relate the represen-
tations of the induced isomorphisms on the complementary subvarieties (Sz, C)

and (eSz,eC).
get Sz = C2/Λ(z1,z2), S˜z = C2/ ˜Λ(˜z1,˜z2), C = C/Λz3 and eC = /Λ˜z3.

Again we identify C2 × {0} with C2 and {(0, 0)} × C with C, and thus we
We denote by

F := ρa(f ) : C3 → C3

the analytic representation of f , hence F2 := F|C2 : C2 → C2 is an isomorphism
of C-vector spaces. The symplectic OD-module isomorphism

F ′2 := φ−1

(˜z1,˜z2) ◦ F|Λ2 ◦ φ(z1,z2) : OD ⊕ 1√D

a → OD ⊕ 1√D

a

is given by multiplication with A∗ for some matrix A ∈ SL2(OD ⊕ 1√D
the C-linearity of F2, computations yield

a). Using

(˜z1, ˜z2) = (Az1, Aσz2).

55

Analogously, the C-linear isomorphism F1 := F|C : C → C induces a sym-
: Λz3 → ˜Λ˜z3. Hence the ma-
plectic Z-module isomorphism F ′1 := F1|Λz3
trix B of F ′1 with respect to the symplectic bases (ν1, ν2) = (1,−z3) of Λz3
and (˜ν1, ˜ν2) = (1,−˜z3) of Λ˜z3 is in SL2(Z). Again we can use C-linearity to
compute

˜z3 = Bz3.

Now we have ˜z = (A, B).z for some (A, B) ∈ SL2(OD ⊕ 1√D

a)× SL2(Z), and
it remains to show that (A, B) lies in ΓD,d(η1, η2). But this works exactly as
in the proof of Proposition 6.15. We take the same bases (λ1, λ2, λ3, µ1, µ2, µ3)
and (λ1, λ2, λ3, ˜µ1, ˜µ2, ˜µ3) and denote the matrix of the rational representation
with respect to these bases by R = (rij )i,j . Then we conclude with the same
arguments, that F maps Λz into Λ˜z if and only if the congruence condition (3)
holds. Again, this is the case if and only if A − SBS−1 lies in MD,d(η1, η2).

6.4 The universal family

Moduli spaces come with universal families, so the next natural step is to con-
struct such a family for each connected component X (3)

a

of X (3)
D,d.

2 , dησ

For a given ideal a of OD, we choose a smart basis (ησ
1 ) for a. Over each
z ∈ H3, we have an Abelian variety C3/ΠzZ6 ∈ X (3)
a ∼= ΓD,d(η1, η2)/H3, thus
our aim is to construct a suitable semi-direct product structure of the form
ΓD,d(η1, η2) ⋉ Z6 acting on H3 × C3.
Lemma 6.17. For each (A, B) ∈ SL2(OD ⊕ 1√D
a) × SL2(Z), there exists a
unique matrix M (A, B) ∈ M6×6(Q(√D)) independent of z and which satisﬁes
b3 b4(cid:1). Recall that by the deﬁnition of the

Πz · M (A, B) = D(A, B, z)−1 · Π(A,B).z.
a3 a4 ) and B = (cid:0) b1 b2

Proof. Let A = ( a1 a2
matrix D(A, B, z) in the proof of Proposition 6.15 we have

(4)

D(A, B, z)−1 = diag(a3z1 + a4, aσ

3 z2 + aσ

4 , b3z3 + b4).

Comparing the entries in (4), we get 18 equations. But since ’independent of z’
just means that we can compare the coeﬃcients of z separately, we have in fact
36 equations. Using the fact that the sign convention I(η1ησ
smart bases is equivalent to

2I(√D) for

2 ) = − 1

η1ησ

2 − ησ

1 η2 = −

√D,

patiently solving these equations yield that the (6 × 6)-matrix

0

2 a4

tr( η1η2a3

tr(cid:16) η1ησ
−√D (cid:17) tr(cid:16) N (η2 )a4
−√D (cid:17)
1 η2a4√D (cid:17) b3
tr(cid:16) N (η1 )a4√D (cid:17) tr(cid:16) ησ
tr(cid:18) η2
d (cid:19)
tr(−η1η2a3)
tr(−η2
2 a3)
0

tr(−η2
tr(−η1η2a3)

1 a3)

2 a3

b4

)

0

0

0

d



is the unique solution for M (A, B).

−db3

0

1 ησ

tr(cid:16) ησ
2d b3−

2 a2

1 ησ

2 )2a2

−D (cid:19)
tr(cid:18) (ησ
D (cid:17) tr(cid:18) 1
tr(cid:16) ησ
d√D (cid:17) tr(cid:16) 1
tr(cid:16) N (η2 )a1
tr(cid:16) η1 ησ
−√D (cid:17)
−√D (cid:17)
tr(cid:16) N (η2 )a1

2 a1

tr(cid:16) N (η2 )a4
−d√D (cid:17)

2d b1+

ησ

(ησ

2 a2

1 )2 a2

D (cid:17)
D (cid:19) tr(cid:16)− 1
d√D (cid:17) tr(cid:18)− 1
tr(cid:18) η2

1 η2a1

2d b2+

)

tr( η1η2a3
−d
2 a3

−d (cid:19)

b1

2d b4−
tr(cid:16) N (η1 )a1√D (cid:17)
1 η2 a1√D (cid:17)
tr(cid:16) ησ
−b3

ησ

1 η2a4

d√D (cid:17)
d2 (cid:19)

2 a3

η2



56

We want to deﬁne a group action of ΓD,d(η1, η2) on Z6 by

(A, B) 7→ (r 7→ M (A, B) · r).

Therefore, we ﬁrst check that M (A, B) is indeed in M6×6(Z).
Lemma 6.18. For all (A, B) ∈ ΓD,d(η1, η2), the entries of M (A, B) are inte-
gers.
Proof. Writing out the condition A− SBS−1 ∈ MD,d(η1, η2) from the deﬁnition
of ΓD,d(η1, η2) gives

a1 ∈ b4 + d
a3 ∈ d√D

ησ
1
η2

η2OD,
b2 + d√D

1
η2

Writing

√D
d

η2
ησ
1

a2 ∈

a, a4 ∈ b1 + 1

ησ
1

b3 +
a.

√D
1 OD,
ησ

√D
d

a1 = b4 + d
(x1η1 + y1η2)
η2
√D
η2
a2 =
b3 +
ησ
ησ
1
1
ησ
a3 = d√D
b2 + d√D
1
η2
a4 = b1 + 1
(x4ησ
ησ
1

(x3ησ
2 + y4(dησ

(x2η1 + y2η2),
1
η2

2 + y3(dησ
1 ))

1 )),

2 a4

with xi, yi ∈ Z, we get
−√D (cid:17) tr(cid:16) N (η2 )a4
−√D (cid:17)
tr(cid:16) η1 ησ
−x4
−x3
tr(−η2
dx3

M (A, B) =

−db2−d2y3

b1+dy4
b2+dy3

1a3)

dx3

0

0

0

b3
b4

0

0

2 )2 a2

tr(cid:18) (ησ
−D (cid:19)
−x2
−x1
tr(cid:16) η1ησ
−√D (cid:17) tr(cid:16) N (η1 )a1√D (cid:17)

−x2
−y2
−y1

2 a1

dx1

−db3

0

b4+dy1
−b3

−d√D (cid:17)
tr(cid:16) N (η2 )a4

y4
y3

x3

−b2−dy3

b1

.



From the description in Lemma 5.9 we see that d divides the norm of every
element in a, in particular d | N (η2). Using the fact that a1, a4 ∈ OD and
a3 ∈ 1√DOD we see that the remaining entries containing a1, a3 or a4 are
integers.

Finally, as a2 is in ( 1√D

a)−1 =

√D
d aσ, we can set a2 =

√D
d (xη2 + ydη1) with

x, y ∈ Z and get

tr(cid:16) (ησ

2 )2a2

−D (cid:17) = −xN (η2)

d

tr(cid:16) ησ
2√D(cid:17) − ytr(cid:16) η1(ησ

√D (cid:17) ∈ Z.

2 )2

Lemma 6.19. The assignment

(( ˜A, ˜B), ˜r) · ((A, B), r) := (( ˜AA, ˜BB), M (A, B) · ˜r + r))

deﬁnes a semi-direct group structure on the Cartesian product ΓD,d(η1, η2)×Z6.
Proof. It remains to show that f(A,B) : r 7→ M (A, B)·r deﬁnes an automorphism
of Z6 for each (A, B) ∈ ΓD,d(η1, η2). But as M (I2, I2) = I6 holds, this would
follow from compatibility of (A, B) 7→ f(A,B) with the group structure.

Now let (A, B), ( ˜A, ˜B) ∈ ΓD,d(η1, η2) and write A = ( a1 a2
B =(cid:0) b1 b2

˜b3 ˜b4(cid:17). By using the relation

b3 b4(cid:1) and ˜B =(cid:16) ˜b1 ˜b2

tr(x)tr(y) = tr(x(y + yσ))

˜a3 ˜a4(cid:1),
a3 a4 ), ˜A =(cid:0) ˜a1 ˜a2

57

for all x, y ∈ Q(√D), we see that the upper left entry of M ( ˜A, ˜B) · M (A, B) is

2 ˜a4

2 a4

2 a4

+

2 )2˜a2

1 ησ

2 ˜a2

ησ
1 η2aσ

tr(cid:18) η1ησ
+tr(cid:18) (ησ
= tr(cid:18) η1ησ
+tr(cid:18) ησ
2 ησ
2 ˜a2
−D
= tr(cid:18) η1ησ
2 ˜a4
−√D
= tr(cid:18) η1ησ
= tr(cid:18) η1ησ

−√D (cid:19) tr(cid:18) η1ησ
−√D (cid:19) + tr(cid:18)N (η2)˜a4
−D (cid:19) tr(−η2
1a3) + tr(cid:18) ησ
−√D (cid:18) η1ησ
4√D (cid:19)(cid:19) + tr(cid:18) η2ησ
−√D
3 )(cid:19) + tr(cid:18) ησ
(−η1η1a3 − ησ
1 aσ
η1ησ
η2ησ
2 a4
1 a4√D
2 ˜a4
−√D
−√D
2 − η2ησ
1 )˜a4a4 + (η1ησ
(cid:19) .
2 (a3˜a2 + a4˜a4)

−√D (cid:19) tr(cid:18)N (η1)a4√D (cid:19) + 0
D (cid:19) tr(−η1η2a3) + 0
−√D (cid:18) η1ησ
1 a4√D
(−η1η2a3 − ησ
ησ
1 ησ
2 ˜a2
−D

1 ησ
2 ˜a2
D
2 ησ
ησ
2 ˜a2
D

1 η2)˜a2a3)(cid:19)

2 − ησ

η1η1a3 +

((η1ησ

η1ησ

+

2 ˜a4

+

2

D

1 ησ

+

ησ
1 η1aσ
4

−√D (cid:19)(cid:19)
3 )(cid:19)
η1η2a3(cid:19)

1 ησ

2 aσ

2 ˜a4

−√D

Analogous computations for the other entries yield

M ( ˜A, ˜B) · M (A, B) = M (A ˜A, B ˜B).

(5)

The twist in Equation (5) is no problem. It just means that ΓD,d(η1, η2) acts
on Z6 from the right by multiplication from the left. Nevertheless, we obtain a
well-deﬁned group structure and set

eΓD,d(η1, η2) := ΓD,d(η1, η2) ⋉ Z6.

Moreover, for all ((A, B), r) ∈eΓD,d(η1, η2) and (z, u) ∈ H3 × C3 we deﬁne
Lemma 6.20. The assignment (6) deﬁnes an action ofeΓD,d(η1, η2) on H3×C3.

((A, B), r).(z, u) := ((A, B).z, D(A, B, z) · (u + Πzr)).

Proof. Clearly we have

(6)

((I2, I2), 0).(z, u) = (z, u)

and using the two relations

Πz · M (A, B) = D(A, B, z)−1 · Π(A,B).z

D( ˜A, ˜B, (A, B).z) · D(A, B, z) = D( ˜AA, ˜BB, z),

and

we get

(( ˜A, ˜B), ˜r).(((A, B), r).(z, u))

= (( ˜A, ˜B), ˜r).((A, B).z, D(A, B, z) · (u + Πzr))
= (( ˜AA, ˜BB).z, D( ˜A, ˜B, (A, B).z) · (D(A, B, z) · (u + Πzr) + Π(A,B).z ˜r))
= (( ˜AA, ˜BB).z, D( ˜AA, ˜BB, z) · (u + Πzr + D(A, B, z)−1 · Π(A,B).z ˜r)))
= (( ˜AA, ˜BB).z, D( ˜AA, ˜BB, z) · (u + Πz(r + M (A, B) · ˜r)))
= (( ˜AA, ˜BB), M (A, B) · ˜r + r).(z, u).

58

Now we can prove the ﬁnal result of this subsection.

Theorem 6.21. The universal family (with singularities) for the irreducible
component X (3)

D,d deﬁned by the ideal a = hησ

a ⊆ X (3)

1 iZ is

2 , dησ

π : eΓD,d(η1, η2)\(H3 × C3) → X (3)

a ,

Proof. Left multiplication with D(A, B, z) is just the analytic representation of
the isomorphism

[(z, u)] 7→ (Az, Hz, Sz, ρz).

(Az, Hz, Sz, ρz) ∼= (A(A,B).z, H(A,B).z, S(A,B).z, ρ(A,B).z),

and thus the ﬁbre over each (Az, Hz, Sz, ρz) is isomorphic to C3/ΠzZ6, equipped
with the usual polarization and OD-structure.

6.5 Lower and upper bounds

The group ΓD,d(η1, η2) is much to unwieldy to use it for problems like counting
cusps. For this reason, we construct a lower and an upper bound for ΓD,d(η1, η2),
both being direct products and independent of the choice of the smart basis and
with both inclusions of ﬁnite index. Our focus will be on the lower bound, as
this deﬁnes a covering space of X (3)
a , and we will show that this bound is optimal
with respect to the requirements above.

Again, let d be a natural number satisfying the prime factor condition in OD,
1 ) be a smart basis
a deﬁned by a of

let a be a primitive ideal in OD of norm d and let (ησ
of a. Recall that our model for the irreducible component X (3)
our moduli space X (3)

2 , dησ

D,d is

where ΓD,d(η1, η2) was deﬁned to be the group

ΓD,d(η2, η2)\H3 ∼= X (3)

a ,

{(A, B) ∈ SL2(OD ⊕ 1√D

a) × SL2(Z) : A − SBS−1 ∈ MD,d(η1, η2)}.

Unfortunately, this group depends on the choice of the pair (η1, η2). We handle
this problem by ﬁnding two groups independent of this choice, an upper and
a lower bound for ΓD,d(η1, η2), such that both inclusions have ﬁnite indices.
Additionaly, for better applicability, we require these two groups to be direct
products, so they would be much better to handle with. To be concrete, setting

eΓlb(D, a) := SL  1 + a √DOD
1 + a !

1√D

a2

and denoting by Γ(d) = {B ∈ SL2(Z) : B ≡ I2 mod d} the principal congru-
ence subgroup of level d, we deﬁne

and

Γlb(D, a) :=eΓlb(D, a) × Γ(d),

Γub(D, a) := SL2(OD ⊕ 1√D

a) × SL2(Z).

59

Proposition 6.22. There is a chain of group inclusions of ﬁnite indices

Γlb(D, a) ⊆ ΓD,d(η1, η2) ⊆ Γub(D, a).

The lower bound Γlb(D, a) is optimal in the sense that it is the largest group of
the form Γ1 × Γ2 ⊆ ΓD,d(η1, η2) with Γ1 ⊆ SL2(OD ⊕ 1√D
a) and Γ2 ⊆ SL2(Z)
independent of the choice of the smart basis (ησ

2 , dησ

1 ).

Proof. It is clear that ΓD,d(η1, η2) is a ﬁnite index subgroup of Γub(D, a).

For the lower bound, recall that we deﬁned

MD,d(η1, η2) =  d

η2 OD
d√D
a

1
η2

√D
1 OD
ησ
1
ησ
1

a ! and S = S(D, d, η1, η2) = 0

1

√D
d

η2
ησ
1

0 ! .

For A = ( a1 a2

a3 a4 ) ∈ SL2(OD ⊕ 1√D
A − SBS−1 =  a1 − b4
a3 − d√D

ησ
1
η2

b2

a) and B =(cid:0) b1 b2

b3 b4(cid:1) ∈ SL2(Z) we get
a4 − b1 ! .

√D
d

η2
ησ
1

b3

a2 −

Hence the largest subgroups Γ1 ⊆ SL2(OD⊕ 1√D
contained in ΓD,d(η1, η2) are

a) and Γ2 ⊆ SL2(Z) with Γ1×Γ2

and

1√D

η2OD)
a

Γ1 = SL 1 + (OD ∩ d
a ∩ d√D
Γ2 = SL2(Z) ∩ 1 + 1

1
η2

d

ησ
1

a,
η2 OD,

√D
√D
d aσ ∩
1 OD
ησ
1 + (OD ∩ 1

a)!

ησ
1

1
ησ
1
1 + d

a

η2 OD!

We will compare these groups with those in the deﬁnition of Γlb(D, a). Let us
ﬁrst look at Γ2. Because of

1
ησ
1
d

a ∩ Z

= h ησ
η2 OD ∩ Z = hd η1

2
ησ
1

η2

, diZ ∩ Z = dZ
, diZ ∩ Z = dZ

and

we get Γ2 = Γ(d).

Now consider Γ1. We claim that (η1ησ

check this, just use I(η1ησ
of Lemma 5.9 to see that a matrix in Z2×2 transforming (d, ω) to (d, η1ησ
necessarily in GL2(Z).

2I(√D) and the normal form a = hd, ωiZ

2 ) = − 1

2 , d) is also a smart basis for a. To

2 ) is

Now we see that

OD ∩ d

η2 OD = OD ∩ d

η2 hη1, η2iZ

= hη1ησ
= hη1ησ
= a,

2 , 1iZ ∩ h
2 , diZ

1

N (η2)/d η1ησ

2 , diZ

60

√D
d aσ ∩

√D
1 OD =
ησ

√D
1 h1, ησ
1 η2iZ
ησ
d η2iZ ∩ h 1
, 1

ησ
1

, η2iZ(cid:17)

√D
d hη2, dη1iZ ∩

= √D (cid:16)hN (η1) 1
= √D hN (η1) 1
= √D OD

ησ
1

ησ
1

, η2iZ

and

OD ∩ 1

ησ
1

ησ

2 , dησ
1 hησ
a = OD ∩ 1
= h1, η1ησ
2iZ ∩ hd,
= hd, η1ησ
2 iZ
= a.

1 iZ
N (η1) η1ησ
2 iZ

1

The tricky part is to determine

1√D

d
η2

a = h

and

a ∩ d√D
2 )2,

1
η2

a. Writing

d2

N (η2) ησ

1 ησ

2 iZ

d

N (η2) (ησ

a2 = h(ησ

2 )2, dησ

1 ησ

2 , d2(ησ

1 )2iZ,
a and thus we have a2 ⊆ a∩ d

we see, using d | N (η2), that a2 is contained in d
a.
Collecting everything together, so far we have shown that Γlb(D, a) is con-
tained in ΓD,d(η1, η2), and that this group is optimal in the sense of the proposi-
tion, if at least for one choice of the smart basis we have a2 = a∩ d
a. Therefore,
we choose a smart basis of the form (ησ
1 ) = (ωσ, d) with ω = a + γD for a
and show that the index of a ∩ d

ω a in a is d. We have

2 , dησ

η2

η2

η2

d

N (ω) ωσiZ.
Now, given any x, y ∈ Z we see that the linear combination

N (ω) ωσa = h dtr(ω)

N (ω) ωσ − d,

ω a = d

d2

x(cid:16) dtr(ω)
N (ω) ωσ − d(cid:17) + y(cid:16) d2

N (ω) ωσ(cid:17)

is an element of a if and only if

xtr(ω) + yd ≡ 0 mod N (ω)

d

.

Next we identify the Z-module a with Z2 by the coordinate isomorphism given
by the basis (ωσ, d). Under this isomorphism, a ∩ d

a is the image of

η2

under

ϕ : L → Z2,

L := {(x, y) ∈ Z2 : xtr(ω) + yd ≡ 0 mod N (ω)
d }
N (ω) ,−x(cid:17) .

(x, y) 7→(cid:16)(xtr(ω) + yd)
d ϕ(L) and Z2 ⊇ ϕ(L) ⊇ N (ω)

Z2 ⊇ L ⊇ N (ω)

d ϕ(L).

d

This gives rise to the two chains of inclusions

61

Three of the four occuring indices are known: We have gcd(d, tr(ω), N (ω)
by Lemma 5.9, and hence [Z2 : L] = N (ω)
we have

) = 1
. For the second one, we mention that

d

d

N (ω)

d ϕ(L) =(cid:18) tr(ω) d
0(cid:19) L

− N (ω)

d

and thus we get the index [L : N (ω)

d ϕ(L)] = N (ω). Therefore, we have
d ϕ(L)] = N (ω)2

d

[Z2 : N (ω)

and comparing with [ϕ(L) : N (ω)

, we see that

d (cid:17)2
d ϕ(L)] =(cid:16) N (ω)

[a : a ∩ d

η2

a] = [Z2 : N (ω)

d ϕ(L)] = d.

It follows that Γlb(D, a) =eΓlb(D, a)×Γ(d) indeed has the desired properties.

We can give at least an estimate for the indices.

Proposition 6.23. Let a be a primitive ideal of OD with norm d relatively
prime to the conductor of D. Then there is a group homomorphism

ϕ : SL2(OD ⊕ 1√D

a) → SL2(Z/dZ)

with ker(ϕ) =eΓlb(D, a). In particular, we have the index estimate
(1 − p−2))2.

[Γub(D, a) : Γlb(D, a)] ≤ |SL2(Z/dZ)|2 = (d3 ·Yp|d

Proof. The primitive ideal a is of the form a = hd, ωiZ for some ω = a + γD
with a ∈ Z. Therefore, we can write

SL2(OD ⊕ 1√D

h1, ωiZ ! .
√Dh1, 1

d ωσiZ

a) = SL  h1, ωiZ
1√Dhd, ωiZ
a) → SL2(Z/dZ) by
d ωσ)

1

! 7→(cid:18)

[x1]d

[x3tr(ω) + y3 N (ω)

d

[y2]d

[x4]d(cid:19)

]d

We deﬁne the map ϕ : SL2(OD ⊕ 1√D
A =  x1 + y1ω
√D(x2 + y2
x4 + y4ω

(x3d + y3ω)

1√D

with xi, yi ∈ Z. Since we have

1 = det(A) =x1x4 − y2(x3tr(ω) + y3 N (ω)

d

) − (y1y4 N (ω)

d − x2x3)d

+ (x1y4 + y1x4 + y1y4tr(ω) − x2y3 + y2x3)ω,

we get x1x4 − y2(x3tr(ω) + y3 N (ω)
) ≡ 1 mod d, hence ϕ is well-deﬁned. A
straight-forward computation using d | N (ω) yields that ϕ is a homomorphism.
It remains to show that the kernel is eΓlb(D, a). We start with determining
the ideal a2. Recall that d satisﬁes the prime factor condition in OD, as a is

d

62

primitive. Therefore, we can write d = P Q, where P is the ramiﬁed part and Q
is the splitting part in the prime factorization of d. Then we get

a2 = hP Q2, P ω + nP QiZ

for some n ∈ N0 with

Q2 | N (ω + nP Q) = N (ω) + n2Q2 + nQtr(ω).

Since a2 is also equal to hP 2Q2, P Qω, tr(ω)ω − N (ω)iZ, we get the three addi-
tional conditions

P | tr(ω),

gcd(Q, tr(ω)) = 1,

and

gcd(P 2,N (ω)) = P.

Now consider the lower left entry of ϕ(A). Using these four conditions, we
deduce
d | x3tr(ω) + y3 N (ω)

d ⇔P 2Q2 | x3P Qtr(ω) + y3N (ω)

⇔P 2 | y3N (ω) ∧ Q2 | x3P Qtr(ω) − y3(n2Q2 + nQtr(ω))
⇔P | y3 ∧ Q | x3P − y3n,

and this holds if and only if x3P Q + y3ω = (x3P − y3n)Q + y3(ω + nQ) is in a2.
Hence, we have shown that the lower left entry of ϕ(A) is zero in Z/dZ if and
only if the lower left entry of A is in 1√D
a2. The other three entries are easy to
check, thus we get

ker(ϕ) = SL  1 + a √DOD

1√D

a2

1 + a ! =eΓlb(D, a).

Finally, the estimate follows from the well known fact

|SL2(Z/dZ)| = [Γ(1) : Γ(d)] = d3Yp|d

(1 − p−2).

A direct consequence is the following corollary, which could be used amongst
other things for computating boundaries of the number of cusps of the Hilbert
modular varieties X (3)
a .

Corollary 6.24. The identity on H3 yields a chain of coverings of ﬁnite degrees

Γlb(D, a)\H3 ։ ΓD,d(η2, η2)\H3 ։ Γub(D, a)\H3.

For the composition π : Γlb(D, a)\H3 ։ Γub(D, a)\H3, we can estimate the
degree by

4 (d3Qp|d(1 − p−2))2

deg(π) ≤(cid:26) 1
a) × PSL2(Z) acts faithfully on H3 and that −I2 is ineΓlb(D, a)

Proof. This is a direct consequence of the previous proposition, the fact that
PSL2(OD ⊕ 1√D
respectively Γ(d) if and only if d = 2.

if d > 2
if d = 2.

36

63

6.6 Level structures

By what we have seen in Section 6.1, the Hilbert modular variety

Γub(D, a)\H3 ∼= Xa × SL2(Z)\H

is the moduli space of isomorphism classes of products of polarized complex
Abelian surfaces with real multiplication by OD of type a and principally po-
larized elliptic curves.

Recall that we have Γlb(D, a) =eΓlb(D, a) × Γ(d). To see what the space

Γlb(D, a)\H3 =eΓlb(D, a)\H2 × Γ(d)\H

is parameterizing, we deﬁne level structures for each of the two factors.

For the one-dimensional factor, we follow [BL04] Chapter 8.3.1. We equip Z2

with the alternating form

B : Z2 × Z2 → Z,

((x1, y1), (x2, y2)) 7→ x1y2 − x2y1.

Then, for every Z-module Λ ∼= Z2 with an alternating form E : Λ × Λ → Z and
every d ∈ N, we deﬁne the multiplicative alternating form

expd(E) : (Λ/dΛ) × (Λ/dΛ) → C∗,

(λ1, λ2) 7→ exp(cid:16)2πi E(λ1,λ2)

d

(cid:17) .

Deﬁnition 6.25. Let (C = V /Λ, H) be a principally polarized elliptic curve and
let d ∈ N. A level d-structure on (C, H) is a symplectic Z-module isomorphism

ψ : (Λ/dΛ, expd(EH )) → (Z2/dZ2, expd(B)).

An isomorphism of principally polarized elliptic curves with level d-structure,

say (C = V /Λ, H, ψ) and (C′ = V ′/Λ′, H′, ψ′), is an isomorphism

of polarized Abelian varieties, such that for the induced isomorphism

f : (C, H) → (C′, H′)

we have

[ρr(f )] : Λ/dΛ → Λ′/dΛ′

ψ = ψ′ ◦ [ρr(f )].

Proposition 6.26. The quotient Γ(d)\H is a moduli space for isomorphism
classes of principally polarized elliptic curves with level d-structure.
Proof. We use the usual convention for SL2(Z)\H as the moduli space of prin-
cipally polarized elliptic curves as follows. We associate to every z ∈ H the
principally polarized elliptic curve (Cz = C/Λz, Hz) with Λz = hz, 1iZ and the
Hermitian form Hz given by Im(z)−1. It follows, that the rational representa-
tion of the corresponding isomorphism Cz ∼= CAz for A ∈ SL2(Z) with respect
to the latter bases (z, 1) and (Az, 1) is multiplication with (At)−1 ([BL04] for
example).

64

Now we equip for every z ∈ H the curve (Cz = C/Λz, Hz) with the level

d-structure

ψz : Λz/dΛz → Z2/dZ2,

xz + y 7→ (x, y).

It is clear that every principally polarized elliptic curve with level d-structure
is isomorphic to (Cz, Hz, ψ) for some z ∈ H and some ψ : Λz/dΛz → Z2/dZ2.
Because the isomorphism ψz ◦ ψ−1 : Z2/dZ2 → Z2/dZ2 is symplectic, it is given
by a matrix B ∈ SL2(Z/dZ). We lift B to a matrix At ∈ SL2(Z), denote by
f : Cz → CAz the corresponding isomorphism and get a commutative diagram

Λz/dΛz

Id−−−−→ Λz/dΛz

[ρr (f )]

−−−−→ ΛAz/dΛAz

Z2/dZ2

B−−−−→ Z2/dZ2

B−1

−−−−→ Z2/dZ2

yψ

yψz

yψAz

and deduce that f : (Cz, Hz, ψ) → (CAz, HAz, ψAz) is an isomorphism of prin-
cipally polarized elliptic curves with level d-structure. Thus every principally
polarized elliptic curve with level d-structure is isomorphic to (Cz, Hz, ψz) for
some z ∈ H. Taking A ∈ SL2(Z), we see that (Cz, Hz, ψz) and (CAz, HAz, ψAz)
are isomorphic if and only if (At)−1 induces the identity on Z2/dZ2, and this
holds if and only if A is in Γ(d).

Now we consider the two-dimensional factor Xa, the moduli space of polar-
ized Abelian surfaces (A, H, ρ) with real multiplication by OD of type a. For
abbreviation we just say that (A, H, ρ) is a polarized Abelian surface of type a.

Deﬁnition 6.27. Let (A = V /Λ, H, ρ) be a polarized Abelian surface of type a.
A level a-structure on (A, H, ρ) is a symplectic OD-module isomorphism

ψ : (Λ, EH ) → (OD ⊕ 1√D

a,h·,·i).

We denote the induced isomorphism on the quotient OD-modules by

[ψ] : Λ/aΛ → (OD ⊕ 1√D

a)/(a ⊕ 1√D

a2),

[λ] 7→ [ψ(λ)].

(Here aΛ is of course deﬁned to be the Z-algebra generated by the products aλ
with a ∈ a and λ ∈ Λ, which is also an OD-module.)
say (A = V /Λ, H, ρ, ψ) and (A′ = V ′/Λ′, H′, ρ′, ψ′), is an isomorphism

An isomorphism of polarized Abelian surfaces of type a with level a-structure,

f : (A, H, ρ) → (A′, H′, ρ′)

of polarized Abelian surfaces of type a, such that
[ψ] = [ψ′ ◦ ρr(f )].

Proposition 6.28. The quotient eΓlb(D, a)\H2 is a moduli space for isomor-
phism classes of polarized Abelian surfaces of type a with level a-structure.
Proof. In Section 6.1 we associated to each z = (z1, z2) ∈ H2 the polarized
Abelian surface (Az = C2/Λz, Hz, ρz) of type a. Therefore we used the embed-
ding

φz : OD ⊕ 1√D

a ֒→ C2,

(x, y) 7→ (x + yz1, xσ + yσz2)

65

to get the lattice Λz = φz(OD ⊕ 1√D
a). It turned out that two such polarized
Abelian surfaces of type a, say (Az, Hz, ρz) and (A˜z, H˜z, ρ˜z), are isomorphic if
and only if ˜z = M z for some matrix

M =(cid:18)a1 a2

a3 a4(cid:19) ∈ SL2(OD ⊕ 1√D

a).

Furthermore, we pointed out that the analytic representation of the correspond-
ing isomorphism is given by the diagonal matrix D(M, z), and that we have a
commutative diagram

OD ⊕ 1√D

a

φz−−−−→ C2

yM∗
yD(M,z)
OD ⊕ 1√D
a4 (cid:19) ∈ SL2(OD ⊕ 1√D
M∗ =(cid:18) a1 −a2

φM z−−−−→ C2

−a3

a

a).

with

Now we deﬁne a level a-structure on (Az, Hz, ρz) simply by setting

ψz := φ−1

z

: Λz → OD ⊕ 1√D

a.

By taking a look at the diagram above it is clear that this isomorphism is also
an isomorphism of polarized Abelian surfaces of type a with level a-structure
if and only if M∗ induces the identity on (OD ⊕ 1√D
a2). Moreover,
this holds if and only if M∗ and thus M is in eΓlb(D, a).

It remains to show that every polarized Abelian surface (A, H, ρ, ψ) of type a
with level a-structure is isomorphic to one of these. We may assume without
loss of generality that (A, H, ρ, ψ) = (Az, Hz, ρz, ψ) for some z ∈ H2. Because ψ
is symplectic, the isomorphism

a)/(a ⊕ 1√D

ψ ◦ ψ−1

z

: OD ⊕ 1√D

a → OD ⊕ 1√D

a

is given by multiplication with M∗ for some matrix M ∈ SL2(OD ⊕ 1√D
a).
Writing f : Az → AMz for the corresponding isomorphism and denoting the
multiplication with M∗ also with M∗, we get

(Az, Hz, ρz, ψ) ∼= (AMz , HMz, ρMz, ψ ◦ ρr(f )−1)

= (AMz , HMz, ρMz, ψ ◦ φz ◦ (M∗)−1 ◦ φ−1
Mz )
= (AMz , HMz, ρMz, ψMz).

Remark 6.29. We deﬁned level a-structures as isomorphisms on the lattices
instead of on the quotients as in the one-dimensional case. This was necessary
because in general the submodule aΛ ⊆ Λ is not, unlike dΛ ⊆ Λ in the one-
dimensional case, the submodule deﬁned by {λ ∈ Λ : EH (λ, Λ) ⊆ dZ} - this
would be precisely aσΛ.

We ﬁnish this subsection with summing up both propositions.

66

Theorem 6.30. The space

Γlb(D, a)\H3 =eΓlb(D, a)\H2 × Γ(d)\H

is a moduli space of products of polarized Abelian surfaces of type a with level a-
structure and principally polarized elliptic curves with level d-structure.

67

7 Pseudo-real multiplication, cusps and exten-

sion classes

For an order O in a totally real number ﬁeld F of degree g, let XO be the moduli
space of g-dimensional principally polarized complex Abelian varieties with a
choice of real multiplication by O.
It is the disjoint union of certain Hilbert
modular varieties, one component for each isomorhism class of proper rank two
symplectic O-modules. Bainbridge and M¨oller have shown in [BM12], that any
such symplectic O-module can be completely described (up to isomorphism) by
a pair formed by a lattice in F and a Q-endomorphism of F compatible with
the trace pairing. Such a pair modulo an action of F ∗ is called a cusp packet
for O. They proved that there is a natural bijection between the set of cusp
packets for O, the set of cusps of the Baily-Borel compactiﬁcation of XO and
the set of isomorphism classes of certain symplectic extensions over O.
In the case we are interested in, the analogue of real multiplication by a
cubic number ﬁeld on a three-dimensional Abelian variety is pseudo-real multi-
plication by a pseudo-cubic number ﬁeld. We will introduce this concept in the
ﬁrst subsection and show that it corresponds to a choice of real multiplication
on an Abelian subsurface. In the other two subsections, we deﬁne symplectic
extensions over pseudo-cubic orders and cusp packets. We will see that we de-
ﬁned all these objects exactly in this way, that the same bijections as for totally
real cubic ﬁelds hold.

7.1 Pseudo-real multiplication

We deﬁned real multiplication on Abelian surfaces, but we are interested in
three-dimensional Abelian varieties. We have to consider endomorphisms on
those three-dimensional objects, and this leads to the concept of pseudo-real
multiplication. We will see that that the choice of an Abelian subsurface with
some choice of real multiplication on it is equivalent to the choice of some
pseudo-real multiplication on the three-dimensional variety.

If A is a polarized Abelian variety, recall that End+(A) denotes the sub-
module of End(A) consisting of those endomorphisms which are self-adjoint
with respect to the polarization of A.

Deﬁnition 7.1. Let K be a real quadratic number ﬁeld. Then the Q-Algebra

F = K ⊕ Q

is called a pseudo-cubic ﬁeld. If A is a three-dimensional principally polarized
Abelian variety, then a Q-Algebra monomorphism

ρ : F ֒→ End+

Q (A) := End+(A) ⊗Z Q

is called pseudo-real multiplication by F on A.

The choice of such pseudo-real multiplication ρ is not unique. If σ denotes

the Galois automorphism of K, then

ρσ := ρ ◦ (σ ⊕ IdQ)
is another choice of real multiplication by F on A.

68

Lemma 7.2. Let F = K ⊕ Q be a pseudo-cubic ﬁeld and let ρ be pseudo-
real multiplication by F on a three-dimensional principally polarized Abelian
variety A. Then there is a unique pair (S, ρ2), where S is a two-dimensional
subvariety of A with the induced polarization and ρ2 : K ֒→ End+
Q (S) is real
multiplication by K induced by the embedding K ֒→ F and the restriction of ρ
to S.
Proof. Consider such a pseudo-real multiplication ρ : F ֒→ End+
Q (A). The
structure of F = K ⊕ Q as a direct product naturally induces two subvarieties
of V , namely the kernels of the two factors. To be more precise, choose m, n ∈ N
such that ρ(m, 0), ρ(0, n) ∈ End+(A) and set

C := ker(ρ(m, 0))0, S := ker(ρ(0, n))0,

where the index 0 denotes the connected component of 0. We want to show
that C and S are complementary subvarieties of A. If we write A = V /Λ with
a three dimensional C-vector space V , then for every x ∈ F the image ρ(x) acts
on V by linear transformations. Writing C = V1/Λ1 and S = V2/Λ2, we get

V1 = {v ∈ V : ρ(x)(v) = 0 for all x ∈ K} = ker(ρ(1, 0)) and
V2 = {v ∈ V : ρ(x)(v) = 0 for all x ∈ Q} = ker(ρ(0, 1)).

For all x ∈ K and q ∈ Q we have

(x, 0)(0, q) = 0 = (0, q)(x, 0)

(7)

and thus ρ(K)(V2) ⊂ V2 and ρ(Q)(V1) ⊂ V1 by the deﬁnition of V1 and V2.
Hence, we have at least a homomorphism ρ2 : K → End+
Q (S) induced by the
embedding of K and the restriction of ρ.

The Vi are non-trivial (V1 = {0} would imply V2 = V by equation (7)
and vice versa, in contradiction to the assumption that ρ is injective). From
ρ(1, 1) = Id it follows that V1 ∩ V2 = {0} and thus ρ(x)(v) 6= 0 for every x ∈ K∗,
v ∈ V2 \ {0} (respectively x ∈ Q∗, v ∈ V1 \ {0}). Hence we get monomorphisms

and

ρ1 : Q ֒→ End+

Q (C),

q 7→ IdC ⊗ q

ρ2 : K ֒→ End+

Q (S).

As K is a real quadratic ﬁeld, the subvariety S cannot be an elliptic curve,
hence dim(V2) = 2, dim(V1) = 1 and thus V = V1 ⊕ V2. Since the action of ρ is
self-adjoint with respect to the polarization of A, the subvarieties C and S are
indeed complementary by the deﬁnition of V1 and V2.

It remains to prove the uniqueness statement. As ρ2(1) = ρ(1, 0) and Equa-
tion (7) holds in F , any such subvariety S of A must be contained in the ker-
nel ker(ρ(0, n))0, and for dimension reasons they coincide.

Consider the monomorphisms ρ1, ρ2 from the proof above. While we have
2 (End(S)) is an order in K of some discrim-

ρ−1
1 (End(C)) = Z, the preimage ρ−1
inant D > 0, hence we get real multiplication

ρ2 : OD ֒→ End+(S).

69

Since S and ρ2 were uniquely determined, we also say that ρ is pseudo-real
multiplication with discriminant D. Moreover, we get
ρ−1(End(A)) ⊂ OD ⊕ Z.

Hence ρ−1(End(A)) is a subring of F with 1, such that its additive group is free
Abelian of rank three.

Now we can reﬁne our deﬁnition of pseudo-real multiplication.

Deﬁnition 7.3. Let F be a pseudo-cubic ﬁeld. A subring of F with 1, such
that its additive group is free Abelian of rank three, is called a pseudo-cubic
order in F . If A is a three-dimensional principally polarized Abelian variety
and O ⊂ F is a pseudo-cubic order, then pseudo-real multiplication by O on A
is a ring monomorphism

ρ : O ֒→ End+(A)

that is proper in the sense that it does not extend to a ring monomorphism

ρ : R ֒→ End+(A) for any ring R with O $ R ⊂ Q(√D) ⊕ Q. The degree of ρ
is deﬁned to be the type of the polarization on the elliptic curve induced by ρ.
We denote by XO the moduli space of pairs (A, ρ), where A is a principally

polarized Abelian variety and ρ is pseudo-real multiplication by O on A.

Each ideal a of OD gives rise to the pseudo-cubic order

Oa := a + Z(1, 1) = {(x, y) ∈ OD ⊕ Z : x − y ∈ a}.

It turns out that these examples are all the pseudo-cubic orders we are interested
in.
Lemma 7.4. Let O be a pseudo-cubic order and let ρ : O ֒→ End+(A) be
pseudo-real multiplication by O on A with discriminant D. If the degree d of ρ
is relatively prime to the conductor of D, then there is a primitive ideal a ⊂ OD
of norm d, such that O = Oa.
Proof. Let (S, ρ2) be the induced polarized Abelian subsurface with real multi-
plication by OD. This polarized Abelian variety is of type (1, d), hence (S, ρ2)
is of type a for some primitive ideal a ⊆ OD of norm d. Let ρQ be the extension
of ρ to ρQ : F ֒→ End+(A) ⊗Z Q. For any (x, y) ∈ OD ⊕ Z, the image ρQ(x, y)
is an endomorphism of A = V /Λ if and only if ρQ(x, y)(Λ) ⊂ Λ. Since y is an
integer, this inclusion holds if and only if ρQ(x − y, 0)(Λ) ⊂ Λ. Using a smart
basis (ησ
2 , d) for a and the explicit description of A in Section 6.3, one can easily
compute that this holds if and only if x − y is in a. Since ρ is proper, we have

O = ρ−1

Q (End+(A)) = {(x, y) ∈ OD ⊕ Z : x − y ∈ a}.

We will also refer to the number [OD ⊕ Z : O] as the degree of O. We have
just seen that it is equal to the degree d of ρ, if d is relatively prime to the
conductor of D. Furthermore, we say that pseudo-real multiplication by O is
of type a, if O = Oa. Thus, pseudo-real multiplication with discriminant D of
type a is the same as pseudo-real multiplication by Oa.
The ﬁnal theorem of this subsection states that the choice of an Abelian
subsurface with some choice of real multiplication on it is equivalent to the
choice of pseudo-real multiplication on the three-dimensional variety, and thus
we will use these concepts interchangeably.

70

Theorem 7.5. Let D > 0 be a non-square discriminant.

1. There are natural bijections between the set

X (3)

D :=ad∈N

X (3)
D,d

of isomorphism classes of quadruples (A, H, S, ρ) of principally polarized
Abelian varieties of dimension three with real multiplication by OD de-
scribed in Section 6.3 and the set of isomorphism classes of pairs (A, ρ),
where A is a principally polarized Abelian variety of dimension three and ρ
is pseudo-real multiplication on A with discriminant D.

2. If d is relatively prime to the conductor of D, then there are natural bijec-

tions between the set

X (3)
a ⊂ X (3)

D,d

of isomorphism classes of quadruples (A, H, S, ρ) of principally polarized
Abelian varieties of dimension three with real multiplication by OD of
type a described in Section 6.3 and the set XOa of isomorphism classes of
pairs (A, ρ), where A is a principally polarized Abelian variety of dimen-
sion three and ρ is pseudo-real multiplication on A by Oa.

Proof. This follows immediately from the previous two lemmata and the fact
Q (S) on an Abelian subsurface S of A

that real multiplication ρ : Q(√D) ֒→ End+

can be naturally extended to pseudo-real multiplication

ρ′ : Q(√D) ⊕ Q ֒→ End+

Q (A) = End+

Q (S) ⊕ End+

Q (C),

where C denotes the complementary subvariety of S in A.

7.2 Cusps and symplectic extensions

Three-dimensional complex Abelian varieties with a choice of pseudo-real multi-
plication are parameterized by certain Hilbert modular varieties. In the follow-
ing subsection we will introduce the Baily-Borel-compactiﬁcation of these ob-
jects and show that the cusps correspond to symplectic extensions over pseudo-
cubic orders.

For preparation, we ﬁrst treat the two-dimensional case.

Deﬁnition 7.6. Let D > 0 be a non-square discriminant. A symplectic OD-
extension is a short exact sequence of OD-modules

E :

0 → I1 → M → I2 → 0,

where I1, I2 are torsion-free OD-modules of rank one and M is a proper symplec-
tic OD-module in the sense of Deﬁnition 5.12. An isomorphism of symplectic
OD-extensions is an isomorphism of exact sequences such that the isomorphism
on the rank two modules is symplectic.

We want to parameterize these extension classes for a ﬁxed symplectic mod-

ule in the middle.

71

First we deﬁne for every L ∈ P1(K) a symplectic OD-extension. We can see
a ⊂ K 2 we can take

L as a line in K 2, so with the natural inclusion OD ⊕ 1√D
the intersection

and the OD-factor module

IL := L ∩ (OD ⊕ 1√D

a)

eIL := (OD ⊕ 1√D
The natural inclusion ι : IL ֒→ OD ⊕ 1√D
OD ⊕ 1√D

a ։ eIL yield the short exact sequence of OD-modules

0 → IL → OD ⊕ 1√D

a)/IL.

a and the natural projection π :

Finally we deﬁne EL to be this short exact sequence together with the trace
pairing on OD ⊕ 1√D

a.

The matrix group GL2(K) acts on P1(K) by

a →eIL → 0.

A.[α : β] := [a1α + a2β : a3α + a4β]

a3 a4 ) ∈ GL2(K) and [α : β] ∈ P1(K).

for all A = ( a1 a2
Proposition 7.7. Let d ∈ N be relatively prime to the conductor of D. The
map

L 7→ (cid:16)EL : 0 → IL → (OD ⊕ 1√D

induces a well-deﬁned bijection between

a,h·,·i) → eIL → 0(cid:17)

a[OD:a]=d

P1(K)/SL2(OD ⊕ 1√D

a)

and the set of those isomorphism classes of symplectic OD-extensions, where
the symplectic form on the module in the middle is of type (1, d).
Proof. Given A ∈ SL2(OD ⊕ 1√D
a), multiplication by A is a symplectic OD-
module automorphism of OD ⊕ 1√D
a that maps IL onto IA.L, so it deﬁnes an
isomorphism of symplectic OD-extensions between EL and EA.L. Conversely,
any symplectic OD-module automorphism of OD ⊕ 1√D
a is given by a matrix
A ∈ SL2(OD ⊕ 1√D
a), and this automorphism maps IL onto IA.L. Thus we
have seen that two such lines, say L and L′, give isomorphic symplectic OD-
extensions EL and EA.L if and only if L′ = A.L for some A ∈ SL2(OD ⊕ 1√D
a).
It remains to show that the map is surjective. Given any symplectic OD-
extension E : 0 → I1 → M → I2 → 0, where the symplectic form on M
is of type (1, d) with d relatively prime to the conductor, the module M is
isomorphic to (OD ⊕ 1√D
a,h·,·i) as a symplectic OD-module for some ideal
a E OD of norm d and the trace pairing h·,·i. So without loss of generality we
can replace M by (OD⊕ 1√D
a,h·,·i) and I1 by its image in OD⊕ 1√D
a. Because I1
has rank one, it is contained in a line L ⊂ K 2, so I1 ⊆ IL = L ∩ (OD ⊕ 1√D
a)
and since I2 is torsion-free, we even have I1 = IL and thus E ∼= EL.

72

The symplectic pseudo-trace pairing We are interested in short exact se-
quences of O-modules, where O is a pseudo-cubic order and the module in the
middle comes from the lattice deﬁning a complex Abelian variety with pseudo-
real multiplication by O. We will see that these lattices are not of arbitrary
form, but isomorphic to lattices in F 2 for some pseudo-cubic number ﬁeld F ,
together with the symplectic form deﬁned as follows.
For all x = (x1, x2) ∈ F , the rational number trp(x) := tr(x1) + x2 is called the
pseudo-trace of x. The pairing

F × F → Q,

(x, y) 7→ trp(xy)

is called the pseudo-trace pairing and the symplectic form

h·,·ip : F 2 × F 2 → Q,

((x1, y1), (x2, y2)) 7→ trp(x2y1 − x1y2)

is called the symplectic pseudo-trace pairing.

Deﬁnition 7.8. Let O be a pseudo-cubic order in some pseudo-cubic number
ﬁeld F . A symplectic O-module is an O-module together with a symplectic
form of type (1, 1, 1), isomorphic to a lattice in F 2 together with the symplectic
pseudo-trace pairing.
Proposition 7.9. Let D > 0 be a non-square discriminant and let d ∈ N
be relatively prime to the conductor of D.
D,d is a
principally polarized complex Abelian variety with pseudo-real multiplication by
a pseudo-cubic order O ⊂ F of degree d, then the lattice (Λ, EH ) is a proper
symplectic O-module.
Proof. By the description in Proposition 6.12 we may assume without loss of
generality, that (X = V /Λ, H, ρ) is of the following form. There is a primitive
ideal a in OD of norm d, a smart basis (ησ
1 ) of a and some z = (z1, z2, z3) ∈
H3, such that V = C3, and that a symplectic basis of Λ for EH is given by the
columns λ1, ..., λ6 of

If (X = V /Λ, H, ρ) ∈ X (3)

2 , dησ

η1
ησ
1
0

η2
ησ
2
0

Πz =

1
d η2
1
d ησ
2
− 1
d z3
The pseudo-real multiplication ρ : O → End+(Λ) is given by
ρ(x, r).(c1, c2, c3)T = (xc1, xσc2, rc3)T .

ησ
1 z1
η1z2
1
d

ησ
2 z1
η2z2
0

−1√D
1√D

1√D
−1√D

0
0
1

 .

Consider the lattice M in F 2 spanned by the columns α1, ..., α6 of

(0, 0)

(0, 1)
(0, 0)

(η2, 0)
(0, 0)

(cid:18)(η1, 0)

(0,−1)(cid:19) .
Then αi 7→ λi deﬁnes a symplectic O-isomorphism (M,h·,·ip) ∼= (Λ, EH ).
The Baily-Borel-Satake-compactiﬁcation and Cusps. Let D ∈ N be a
non-square discriminant, K = Q(√D) and let d ∈ N be relatively prime to the

(0, 1
d )
ησ
1 , 0)

(0, 0)
ησ
2 , 0)

( 1
d η2, 0)

( −1√D

( 1√D

73

conductor of D. We have seen in Theorem 6.16, that the moduli space X (3)
the disjoint union of certain Hilbert modular varieties

D,d is

X (3)

D,d =aa

X (3)
a ,

where a runs over all primitive ideals in OD of norm d. The Hilbert modular
varieties X (3)

are of the form

a

X (3)
a = X(M ) := SL(M )\H3,

where M ≤ (F 2,h·,·ip) is a certain symplectic Oa-module and SL(M ) is the sub-
group of SL2(F ) = SL2(K)× SL2(Q) preserving M , i.e. the group of symplectic
automorphisms of M . We say that M represents Oa.
More generally, given any pseudo-cubic order O and any symplectic O-
module M , we deﬁne SL(M ) and X(M ) = SL(M )\H3 analogously and set

XO := aM≤F 2

X(M ),

where M runs over a set of representatives of all isomorphism classes of proper
symplectic O-modules.
dings

We compactify each X(M ) in the following way. Consider the two embed-

P1(K) ֒→ (R ∪ {∞})2,
P1(Q) ֒→ (R ∪ {∞}),

y , xσ
[x : y] 7→ ( x
[q : r] 7→ q
r .

yσ ) and

Each of the factors of

H3
F := (H2 ∪ P1(K)) × (H ∪ P1(Q))

carries a topology induced by the toplogy on H2 and H respectively, and certain
neighbourhood bases for each cusp in P1(K) and P1(Q) respectively. For more
details, see [vdG88]. Then the action of GL2(F ) = GL2(K) × GL2(Q) by
M¨obius transformations extends naturally to an action on H3
F . The (Baily-
Borel-)compactiﬁcation of X(M ) is then deﬁned by

BB

X(M )

:= SL(M )\H3
F ,

which is a complex analytic space. Writing P(F ) := P1(K)× P1(Q), the embed-
dings above yield a well-deﬁned embedding

SL(M )\P(F ) ֒→ X(M )

BB

.

is denoted by C(M ), the set of cusps of X(M )

.
O of XO is deﬁned to be the disjoint
, and the union of the sets of cusps C(M ) is denoted

BB

BB

In the cases we are interested in, it turns out that XO has just one compo-

The image of P(F ) in X(M )
The (Baily-Borel-)compactiﬁcation X

BB

BB

union of the X(M )
by CO, the set of cusps of X
nent.

BB

O .

74

Proposition 7.10. Let a be a primitive ideal in OD of norm d relatively prime
to the conductor of D > 0. Then we have exactly one isomorphism class of
proper symplectic Oa-modules. In other words, we have

XOa = X (3)

a = X(M )

for some M representing Oa.
Proof. Let d be the norm of a and let (ησ
1 ) be a smart basis of a. We have
to show that any symplectic Oa-module (Λ, E) is isomorphic to (M,h·,·ip),
where M is the lattice in F 2 described in the proof of Proposition 7.9. To be
more precise, the columns of

2 , dησ

(cid:18)(η1, 0)

(0, 0)

(η2, 0)
(0, 0)

(0, 1)
(0, 0)

(0, 0)
ησ
2 , 0)

( 1√D

(0, 1
d )
ησ
1 , 0)

( −1√D

( 1
d η2, 0)

(0,−1)(cid:19)

form a symplectic basis for M .

Consider some arbitrary proper symplectic Oa-module (Λ, E) with Λ ⊂ F 2.
We denote by πK (respectively πQ) the natural projections from F = K ⊕ Q
to K = Q(√D) (respectively Q). Moreover, we deﬁne Λ1 := Λ ∩ Q2 and
Λ2 := Λ ∩ K 2. We have πK(Oa) = OD, thus OD acts on Λ2, and we claim
that Λ2 is proper as an OD-module. Otherwise, there would be some e ∈ N>1
dividing the conductor f of D, such that the order OE with conductor e acts
on Λ2. Writing OK = h1, γiZ, we have OD = h1, f γiZ and OE = h1, eγiZ.
As (d, 0) maps Λ to Λ2, we deduce that (deγ, 0) acts on Λ. But d and f are
relatively prime, hence deγ is not in OD and consequently (deγ, 0) cannot lie
in Oa, in contradiction to the fact that Λ is proper as an Oa-module.
Writing Ei := E|Λi×Λi for i ∈ {1, 2}, the symplectic Z-module (Λ1, E1) is
a priori of some type (c). As K 2 is the orthogonal complement of Q2 in F 2,
the symplectic OD-module (Λ2, E2) is of type (1, c) by Lemma 4.10. Since
(d, 0)Λ ⊆ Λ2 and (0, d)Λ ⊆ Λ1, we have Λ ⊆ 1
d (Λ1 ⊕ Λ2). Considering the
symplectic form d2E, the multiplication formula for the degree of sublattices
from Lemma 4.8 gives

d8 = | 1

d (Λ1 ⊕ Λ2)/Λ| · c2.

Thus c | d4, in particular c is relatively prime to the conductor of D. Therefore,
by Theorem 5.22, c satisﬁes the prime factor condition in OD and there is a
unique ideal b of norm c in OD, such that (Λ2, E2) is isomorphic to (OD ⊕
1√D

b,h·,·i). We choose a smart basis (θσ

1 ) for b. As

2 , dθσ

(λ1, λ2, µ1, ˆµ2) =(cid:16)(θ1, 0), (θ2, 0), (0, 1√D

θσ
2 ), (0, −c√D

θσ

1 )(cid:17)

is a symplectic basis of (OD ⊕ 1√D
b) ⊂ K 2 and E((1, 0)Λ × Λ2) ⊂ Z, we see
that (1, 0)Λ is contained in hλ1, 1
c ˆµ2iZ. Now we are exactly in the same
situation as in the proof of Proposition 6.12, where we have shown that we can
choose a basis (ν1, ν2) of Λ1, such that

c λ2, µ1, 1

(cid:0)λ1, λ2, ν1, µ1, 1

c (ˆµ2 + ν1), 1

c (λ2 + ν2)(cid:1)

is a symplectic basis of Λ, which has the desired form. Hence Λ is a proper
Ob-module. But then a und b must equal, and we can choose (ησ
1 ) for our
smart basis, which ﬁnishes the proof.

2 , dησ

75

Symplectic O-extensions Now we will classify the extension classes coming
from complex Abelian varieties with pseudo-real multiplication by a pseudo-
cubic number ﬁeld F = Q(√D) ⊕ Q.
Deﬁnition 7.11. Let O be a pseudo-cubic order in a pseudo-cubic number-
ﬁeld F . A symplectic O-extension is a short exact sequence of O-modules

E :

0 → I1 → M → I2 → 0,

where I1,I2 are O-modules isomorphic to lattices in F and M is a proper sym-
plectic O-module. (In particular, I1 maps onto a Lagrangian subgroup of M .)
An isomorphism of symplectic O-extensions is an isomorphism of exact se-
quences such that the isomorphism on the rank two modules is symplectic.

Analogous to the quadratic case, we want to parameterize these extension
classes for a ﬁxed symplectic module in the middle. We identify each point L =
([x1 : x2], [q1 : q2]) ∈ P(F ) with the line h(v1, v2)iF in F 2, where vi := (xi, qi).
Again, given any lattice M in F 2, we set IL := L ∩ M . Finally, we get the
symplectic O-extension

EL : 0 → IL → (M,h·,·ip) → M/IL → 0.

Proposition 7.12. Let O be a pseudo-cubic order and let Mi be lattices in F 2,
such that {(Mi,h·,·ip)} is a set of representatives of all isomorphism classes of
proper symplectic O-modules. Then the maps

L 7→ (EL : 0 → IL → (Mi,h·,·ip) → Mi/IL → 0)

induce a well-deﬁned bijection between the set of cusps

CO =ai

SL(Mi)\P(F )

and the set of isomorphism classes of symplectic O-extensions.
Proof. The proof works identically like the proof of Proposition 7.7. We just
note that the elements of F 2, whose F -span is of Q-dimension three, are exactly
the elements of the form ((x1, q1), (x2, q2)) with (x1, x2) 6= 0 and (q1, q2) 6= 0.

7.3 Extension classes and cusp packets

There is another viewpoint of symplectic extensions over pseudo-cubic orders,
namely that of cusp packets. Analogous to [BM12], Section 2, we will show that
extension classes correspond to certain classes of Q-linear endomorphisms of the
pseudo-cubic ﬁeld.

For a lattice I in a pseudo-cubic number ﬁeld F we denote by

O(I) := {x ∈ F : x · I ⊂ I}

its coeﬃcient ring and by

I∨ := {x ∈ F : trp(xI) ⊂ Z} ∼= HomZ(I; Z)

its dual with respect to the pseudo-trace pairing.

76

Deﬁnition 7.13. Let I be a lattice in F such that its coeﬃcient ring contains a
pseudo-cubic order O. A symplectic (O,I)-extension is a short exact sequence
of O-modules

0 → I → M → I∨ → 0,

where M is a proper O-module together with a symplectic form of type (1, 1, 1),
such that

1. the O-module structure on M is self-adjoint with respect to this form (in

particular, I maps onto a Lagrangian subgroup of M ),

2. if s : I∨ → M is a Z-splitting that maps I∨ onto a Lagrangian complement
of I in M , then the induced Z-isomorphism I ⊕ I∨ ∼= M is symplectic
with respect to the symplectic pseudo-trace pairing on I⊕I∨ (this property
does not depend on the choice of the splitting).

We note that the coeﬃcient ring of a lattice in F is always a pseudo-cubic
order. An isomorphism between two such symplectic extensions is an isomor-
phism of exact sequences of O-modules that is symplectic on the module in the
middle. Let E(I) be the set of all symplectic (O,I)-extensions for some pseudo-
cubic order O ⊂ O(I) up to isomorphism which are the identity on I and I∨.
With a slight expansion of the Baer sum of extensions, see [Wei94], we get the
following.
Lemma 7.14. The set E(I) carries the structure of an Abelian group.
Proof. We recall the deﬁnition of the Baer sum of extensions, see [Wei94]. Given
any two symplectic (O,I)-extensions

0 → I ιi−→ Mi

πi−→ I∨ → 0,

then M1 ⊕ M2 is a proper O1 ∩ O2-module. We deﬁne ι : I → M1 ⊕ M2 by
ι(x) := (ι1(x),−ι2(x)) and π : M1⊕M2 → I∨ by π(m1, m2) := π1(m1)−π2(m2).
The sum of the two extensions is deﬁned as

with

for all x ∈ I and

0 → I → ker(π)/im(ι) → I∨ → 0

x 7→ (ι1(x), 0) = (0, ι2(x))

(m1, m2) 7→ π1(m1) = π2(m2)

for all (m1, m2) ∈ ker(π)/im(ι).
form on ker(π)/im(ι).
ker(π)/im(ι) is simply deﬁned as their sum,

In our context we have to extend this deﬁnition by declaring a symplectic
If h·,·ii are the forms on Mi, the symplectic form on

h(m1, m2), (n1, n2)i := hm1, n1i1 + hm2, n2i2.

That this form satisﬁes the conditions in Deﬁnition 7.13 can be easily seen as
follows. Taking two splittings si : I∨ → Mi as in the deﬁnition, a splitting
of the Baer sum is given by s := s1 ⊕ s2. Thus the induced isomorphism
I ⊕ I∨ ∼= ker(π)/im(ι) is given by

(x, y) 7→ (ι1(x) + s1(y), s2(y)) = (s1(y), ι2(x) + s2(y)).

77

Here we can see that the pairing is well-deﬁned and that it is just the form
induced by the symplectic pseudo-trace pairing on I ⊕ I∨.
element of E(I) is the trivial extension

The Baer sum gives E(I) the structure of an Abelian group. The identity

E0(I) : 0 → I → (I ⊕ I∨,h·,·ip) → I∨ → 0.

The inverse of any symplectic O-extension

is given by

0 → I ι−→ (M, E) π−→ I∨ → 0

0 → I ι−→ (M,−E) −π−−→ I∨ → 0.

The next step is to classify the extension classes in E(I), and we start with

the construction of certain extensions. For this we deﬁne

Hom+

Q (F, F ) := {h ∈ HomQ(F, F ) :

trp(h(µ1)µ2) = trp(µ1h(µ2)) for all µ1, µ2 ∈ F},

which is a Q-vector space of dimension six, and

Hom−Q (F, F ) := {h ∈ HomQ(F, F ) :

trp(h(µ1)µ2) = −trp(µ1h(µ2)) for all µ1, µ2 ∈ F},

which is a Q-vector space of dimension three. For each x ∈ F , we denote
by Mx ∈ HomF (F, F ) multiplication by x. Now given any h ∈ Hom+
Q (F, F ),
we assign to each x ∈ F the Q-endomorphism [Mx, h] ∈ Hom−Q (F, F ), where
[X, Y ] := XY − Y X denotes the commutator of X and Y wherever it makes
sense. We have the pseudo-cubic order

Oh(I) := {x ∈ O(I) : [Mx, h](I∨) ⊂ I}

and can deﬁne a proper Oh(I)-module structure on I ⊕ I∨ that is self-adjoint
with respect to h·,·ip by setting

x.(λ, µ) := (xλ + [Mx, h](µ), xµ)

for all x ∈ Oh(I) and (λ, µ) ∈ I ⊕ I∨. We denote I ⊕ I∨ together with
this module structure and the symplectic pseudo-trace pairing by (I ⊕ I∨)h.
Together with the natural inclusion of I and the natural projection onto I∨
this becomes a symplectic (Oh(I),I)-extension, which we will denote by Eh(I).
Lemma 7.15. Each class in E(I) has a representative

Eh(I) : 0 → I → (I ⊕ I∨)h → I∨ → 0
Q (F, F ).

for some h ∈ Hom+

78

(cid:13)(cid:13)(cid:13)

yφ

(cid:13)(cid:13)(cid:13)

Proof. Let [E : 0 → I → M → I∨ → 0] ∈ E(I). Again we use a Z-splitting
s : I∨ → M mapping I∨ onto a Lagrangian complement of I in M and obtain
a Z-isomorphism of short exact sequences
ι−−−−→ M

π−−−−→ I∨ −−−−→ 0

0 −−−−→ I

0 −−−−→ I −−−−→ I ⊕ I∨ −−−−→ I∨ −−−−→ 0,

where φ = (ι + s)−1 is symplectic by the deﬁnition of symplectic extensions.
Equipping I ⊕ I∨ with the O-module structure of M induced by φ, the lower
row becomes O-linear and we get indeed an isomorphism of symplectic (O,I)-
extensions. From the O-linearity of the lower row it also follows that the O-
structure on I ⊕ I∨ is of the form

x.(λ, µ) = (xλ + fx(µ), xµ)
for all x ∈ O and (λ, µ) ∈ I ⊕ I∨. Moreover, we have

(x 7→ fx) ∈ HomZ(O, HomZ(I∨,I))

and

fxy = Mxfy + fxMy

for all x, y ∈ O. The property that the O-structure is self-adjoint with respect
to the pairing h·,·ip on I ⊕ I∨ is equivalent to

trp(fx(µ1)µ2) = −trp(µ1fx(µ2))

for all x ∈ O and µ1, µ2 ∈ I∨. Thus, after tensoring with Q, the map x 7→ fx is
an element of

Hom∗Q(F, Hom−Q (F, F )) := {f ∈ HomQ(F, Hom−Q (F, F )) :

f (xy) = Mxf (y) + Myf (x) for all x, y ∈ F},

Since the O-module structure is proper, it remains to show that there is some
h ∈ Hom+
Q (F, F ) with fx = [Mx, h] for all x ∈ F . We choose some x0 ∈ F , such
that F = h(1, 1), x0, x2

0iQ. Then the Q-homomorphism
Hom∗Q(F, Hom−Q (F, F )) → Hom−Q (F, F )

f 7→ f (x0)

is injective by f (x2

0) = Mx0f (x0) + f (x0)Mx0 and f (1, 1) ≡ 0 and thus

dimQ(Hom∗Q(F, Hom−Q (F, F ))) ≤ 3.

Since

and the Q-linear map

dimQ(Hom+

Q (F, F )/(HomF (F, F )) = 6 − 3 = 3

Hom+

Q (F, F )/(HomF (F, F ) → Hom∗Q(F, Hom−Q (F, F ))

h 7→ (x 7→ [Mx, h])

is injective, it is also an isomorphism and hence x 7→ fx lies in its image.

79

Analogously to [BM12], Theorem 2.1., we get for the pseudo-cubic case the

following identiﬁcation.

Lemma 7.16. The map h 7→ Eh(I) induces a group isomorphism
Z (I∨,I)) → E(I).

Q (F, F )/(HomF (F, F ) + Hom+

Hom+

Proof. We have already seen that Eh(I) lies in E(I). It is easy to check that
this map is well-deﬁned, we just mention that we have Oh(I) = Oh+ϕ(I) for all
h ∈ Hom+
Z (I∨,I), and that in this case an isomorphism
of symplectic extensions over Oh(I) is given by

Q (F, F ) and ϕ ∈ Hom+

(I ⊕ I∨)h+ϕ → (I ⊕ I∨)h

(λ, µ) 7→ (λ + ϕ(µ), µ).

To see that our map is a group homomorphism, let h1, h2 ∈ Hom+

Q (F, F ).
Then with ι and π deﬁned as in the deﬁnition of the Baer sum of Eh1(I)
and Eh2 (I), an isomorphism of symplectic O-extensions is given by

(I ⊕ I∨)h1+h2 → ker(π)/im(ι)
(λ, µ) 7→ ((λ, µ), (0, µ))

Q (I∨,I).

To show that our map is injective, let h ∈ Hom+

and thus Eh1+h2(I) = Eh1(I) + Eh2(I) in E(I).
Q (F, F ) such that there is
an isomorphism φ : Eh(I) → E0(I) to the trivial extension. This isomorphism
must be of the form (λ, µ) 7→ (λ + f (µ), µ) for some f ∈ Hom+
Q (I∨,I) with
[Mx, h − f ] = 0 for all x ∈ Oh(I) = O(I). The latter condition comes from
the Oh(I)-linearity of φ and is equivalent to h − f ∈ HomF (F, F ), and thus
h ∈ HomF (F, F ) + Hom+
Since we have already proven surjectivity in the previous lemma, the result
follows.
Cusp packets. Given any h ∈ Hom+
Q (F, F ) and a ∈ F ∗, we denote by
ha ∈ Hom+
Q (F, F ) the endomorphism x 7→ ah(ax). For each lattice I in F ,
we obviously have O(I) = O(aI) and Oh(I) = Oha(aI). For any pseudo-cubic
order O in F , let LO be the set of lattices I in F with O ⊆ O(I). We denote
by EO(I) ⊂ E(I) the set of classes of symplectic (O,I)-extensions. Moreover,
we denote by eC(O) the set of pairs (I, E) with I ∈ LO and E ∈ EO(I). Us-
ing the identiﬁcation from Lemma 7.16, we have seen that each a ∈ F ∗ acts
on the disjoint union EO :=`I∈LO EO(I), by sending E = Eh(I) ∈ EO(I) to
Ea := Eha (aI) ∈ EO(aI), as well as on eC(O) by sending (I, E) to (aI, Ea).

Finally, a cusp packet for O is deﬁned to be an element of

C(O) := eC(O)/F ∗.

Proposition 7.17. Let O be a pseudo-cubic order. The assignment

(I, Eh(I)) 7→ (0 → I → (I ⊕ I∨)h → I∨ → 0)

induces a well-deﬁned bijection between the set of cusp packets C(O) and the set
of isomorphism classes of symplectic (O,I)-extensions, where I runs over all
lattices in LO.

80

Proof. Given any (I, [Eh(I)]) ∈ eC(O) and any a ∈ F ∗, there is a natural iso-

morphism ϕa of symplectic Oh(I)-extensions between the sequences Eh(I) and
Eha (I). To be more precise, ϕa is given by
0 −−−−→ I −−−−→ (I ⊕ I∨)h

−−−−→ I∨ −−−−→ 0

yMa⊕Ma−1

yMa−1

0 −−−−→ aI −−−−→ (aI ⊕ (aI)∨)ha −−−−→ (aI)∨ −−−−→ 0.

Thus the map is well-deﬁned. Surjectivity follows from Lemma 7.16, so it re-

mains to show injectivity. Let (I1, [E1]), (I2, [E2]) ∈ eC(O) with Ei = Ehi (Ii),
such that there is an isomorphism of symplectic O-extensions ϕ : E1 ∼= E2. On
rank one modules, an isomorphism between two lattices in F is just multiplica-
tion with an invertible element of F . Hence there are a, d ∈ F ∗ and b ∈ F with
I2 = aI1, such that ϕ is of the form

0 −−−−→ I1 −−−−→ (I1 ⊕ I∨1 )h1

−−−−→ I∨ −−−−→ 0

yMa

yMa

yψ

yMd

0 −−−−→ aI1 −−−−→ (aI1 ⊕ (aI1)∨)h2 −−−−→ (aI1)∨ −−−−→ 0

with ψ(λ, µ) = (aλ + bµ, dλ) for all (λ, µ) ∈ I ⊕I∨. As ψ is symplectic, we have
d = a−1 and thus the isomorphism of symplectic O-extensions

ϕa ◦ ϕ−1 : E2 = Eh2 (aI1) ∼= Ea

1

is the identity on aI1 and (aI1)∨. Hence E2 and Ea
in EO(aI) and we get

1 represent the same elements

(I1, E1) ∼ (aI1, Ea

1 ) = (I2, E2).

Corollary 7.18. Let O be a pseudo-cubic order. The assignment

(I, Eh(I)) 7→ (0 → I → (I ⊕ I∨)h → I∨ → 0) ,

where I runs over all lattices in LO, induces a well-deﬁned bijection between
the set of cusp packets C(O) and the set of isomorphism classes of symplectic
O-extensions (or equivalently the set of cusps CO).
Proof. To show that the map is well-deﬁned, we have to prove that each (I⊕I)h
is isomorphic to some lattice in F 2 as a symplectic O-module. But (I ⊕ I)h
is a lattice in (I ⊕ I)h ⊗Z Q = (F ⊕ F )h, and a symplectic F -isomorphism
F 2 ∼= (F ⊕ F )h is given by (x, y) 7→ (x − [My, h](1, 1), y).
Injectivity follows from the last proposition, so it remains to show that any
symplectic O-extension

E :

0 → I1 → M → I2 → 0

is isomorphic to one of the desired form. By deﬁnition, we may assume without
loss of generality that M is a lattice in F 2 equipped with the symplectic pseudo-
trace pairing and that I1 = I is a lattice in F . Since the image of I is a

81

Lagrangian subgroup of M , the symplectic pseudo-trace pairing on M and a
choice of a Z-splitting s : I2 ֒→ M onto a Lagrangian complement of I induces
a Z-module isomorphism

The pseudo-trace pairing on I induces also a Z-module isomorphism

I2 ∼= HomZ(I; Z).

I∨ ∼= HomZ(I; Z).

Moreover, since the O-module structure on M is self-adjoint with respect to
the symplectic pseudo-trace pairing and for each x ∈ O the commutator [s, Mx]
maps to I ⊂ M , the resulting isomorphism ϕ : I2 ∼= I∨ is in fact O-linear. It
follows that the sequence E of O-modules is isomorphic to the sequence

0 → I → M → I∨ → 0.

Since the Z-splitting s ◦ ϕ−1 : I∨ ֒→ M induces a symplectic isomorphism
I ⊕ I∨ ∼= M , the result follows from Lemma 7.15.

Remark. We have seen in the last proof, that in Deﬁnition 7.11 we can

replace the condition that the O-module I2 in the sequence

E :

0 → I1 → M → I2 → 0

is a lattice in F , with the condition that I1 maps onto a Lagrangian subgroup
of M .

82

8 Boundary strata

In [BM12], Bainbridge and M¨oller introduced a generalization of the classical
period matrices on the moduli space Mg(L) of L-weighted stable curves via a
meromorphic function on Mg(L). They used this function to give a necessary
and, for g = 3, suﬃcient condition for a stable curve for lying in the boundary of
the real multiplication locus. Furthermore, they described how the correspond-
ing weighted stable curves can be cut out by equations in terms of cross-ratios
of projective coordinates.

In the following section, we transfer these techniques to our pseudo-cubic
case. We will see that one has to be very careful about the subtleties and that
not everything works as ﬁne as in the cubic case. Nevertheless, we get the same
necessary condition and very similar cross-ratio equations.

8.1 Eigenforms for pseudo-real multiplication

Now we introduce eigenforms for pseudo-real multiplication on Jacobians of
Riemann surfaces. We will see that, once we have ﬁxed a quadratic pseudo-
embedding, the choice of pseudo-real multiplication corresponds to the choice
of an eigenform. In fact, we will do this for a larger class then just Riemann
surfaces, namely for stable curves with compact Jacobians.

Deligne-Mumford compactiﬁcation. A stable Riemann surface or stable
curve is by deﬁnition a connected, compact, complex analytic variety of dimen-
sion one with only ﬁnitely many singularities, such that each singularity is a
node - i.e. a singularity of the form xy = 0 - and such that each connected
component of the complement of the nodes is hyperbolic. The geometric genus
of a stable curve X is the sum of the genera of the connected components of the
normalization of X. The arithmetic genus of X is the genus of the Riemann
surface obtained by thickening each node to an annulus. If we speak just of the
genus, we mean the arithmetic genus. We give now a brief description, how the
moduli space Mg of genus g stable curves can be constructed. For more details
concerning this construction of Mg as an analytic space, see [HK14].

Figure 2: A stable curve of arithmetic genus three and geometric genus one

Fix a compact, oriented surface Σg of genus g. For any genus g stable
curve X, a marking by Σg or collapse is a continuous surjective map f : Σg → X,
such that the preimage of each node is a simple closed curve in Σg and such
that f induces an orientation preserving homeomorphism on the complement of
these curves. We denote the set of preimages of the nodes under f by Γf . A pair

83

(X, f ), where X is a stable curve and f : Σg → X is a collapse, is called a Σg-
marked stable curve. Two Σg-marked stable curves, say (X1, f1) and (X2, f2),
are deﬁned to be equivalent, if there is an isomorphism φ : X1 → X2, such that
there is an homeomorphism h : Σg → Σg isotopic to the identity on Σg with
φ ◦ f1 = f2 ◦ h. The augmented Teichm¨uller space T g(Σg) is deﬁned to be the
set of all Σg-marked stable curves up to this equivalence relation and it carries
a topology deﬁned as follows. For each simple closed curve γ in Σg, there is the
well-deﬁned function lγ : T g → R≥0 ∪ {∞} assigning to each [(X, f )] ∈ T g(Σg)
the hyperbolic length of the unique geodesic in X homotopic to f (γ). Note that
l(γ) = 0, if γ is homotopic to a curve in Γf , and that l(γ) = ∞, if γ is transversal
to a curve in Γf . Then T g(Σg) is equipped with the smallest topology, such
that each fγ is continuous. It contains the Teichm¨uller space Tg(Σg) of classes
of Σg-marked Riemann surfaces as an open, dense subspace.
The mapping class group Mod(Σg) is deﬁned to be the group of orientation

preserving homeomorphisms of Σg up to isotopy. It acts on T g(Σg) via

h.[(X, f )] := [(X, f ◦ h−1)]

and we get Mg = T g(Σg)/Mod(Σg) for the moduli space of genus g stable
curves. It compactiﬁes the moduli space Mg = Tg(Σg)/Mod(Σg) of genus g
Riemann surfaces and is called the Deligne-Mumford compactiﬁcation of Mg.
Stable Abelian diﬀerentials and Jacobians. For any Riemann surface X of
genus g, we denote by Ω(X) the g-dimensional C-vector space of holomorphic
one-forms (or Abelian diﬀerentials) and by ΩMg → Mg the vector bundle of
holomorphic one-forms. We extend this bundle to a vector bundle ΩMg → Mg
over the moduli space of stable forms as in [BM12] as follows. For any stable
curve X, we denote by X0 the complement of the nodes in X. To a pair of
cusps of X0 coming from the same node of X we will refer as opposite cusps. A
stable Abelian diﬀerential or for short just stable form on X is deﬁned to be a
holomorphic one-form ω on X0 with at most simple poles at each cusp of X0,
such that for any pair (c1, c2) of opposite cusps, for the residues we have

resc1(ω) = −resc2 (ω).

If X has arithmetic genus g, then the space Ω(X) of stable Abelian diﬀerentials
on X is a C-vector space of dimension g. An isomorphism between two pairs
(X1, ω1), (X2, ω2), where each ωi is a stable form on the stable curve Xi, is an
isomorphism f : X1 → X2 with f∗(ω2) = ω1. Deﬁning ΩMg to be the space of
isomorphism classes of stable curves with stable forms, we get a vector bundle

ΩMg → Mg,

[(X, ω)] → [X],

the bundle of stable forms, that induces the usual bundle ΩMg → Mg of holo-
morphic one-forms.
The homology group H1(X0; Z), a free Abelian group of rank at most 2g,

can be embedded into the C-vector space Ω(X)∗ := HomC(Ω(X); C) via

H1(X0; Z) ֒→ Ω(X)∗,

γ 7→(cid:18)ω 7→Zγ

ω(cid:19) .

The Jacobian of X is then deﬁned as the quotient

Jac(X) := Ω(X)∗/H1(X0; Z).

84

It is an Abelian variety if and only if the geometric genus of X is g, and this holds
if and only if every node is separating. Otherwise it is not compact, since the Z-

rank of H1(X0; Z) is strictly smaller than 2g. We denote by fMg ⊂ Mg the locus
of stable curves with compact Jacobians. For X ∈ fMg, the intersection pairing

on the irreducible components induces a principal polarization ΘX on Jac(X),
and thus the Torelli map extends to a map

which is surjective for g ≤ 3.

We will often just write Jac(X) instead of the pair (Jac(X), ΘX).

t : fMg → Ag, X 7→ (Jac(X), ΘX),

Eigenforms for pseudo-real multiplication. Consider a genus three stable
curve X with compact Jacobian Jac(X). The embedding

H1(X0; Z) ֒→ Ω(X)∗,

γ 7→ (ω 7→ ∫γ

ω)

extends Q-linear to an embedding H1(X0; Q) ֒→ Ω(X)∗, therefore the action
of End(Jac(X)) on H1(X0; Z) extends naturally to an action of EndQ(Jac(X))
on H1(X0; Q). As always, let O be a pseudo-cubic order in a pseudo-cubic
number ﬁeld F = K ⊕ Q. We say that X has pseudo-real multiplication by O
(respectively F ), if Jac(X) has pseudo-real multiplication by O (respectively F ).
We denote by

RMO ⊂ M3

(respectively ]RMO ⊂ fM3)

the locus of Riemann surfaces (respectively stable curves with compact Jaco-
bian) having pseudo-real multiplication by O and by

RMO ⊂ M3

its closure in the Deligne-Mumford compactiﬁcation of M3. We deﬁne RMF ,
]RMF and RMF analogously.
Now we want to discuss eigenforms for pseudo-real multiplication. In the
case of a real cubic number ﬁeld, eigenforms are deﬁned by using the three ﬁeld
embeddings into R. The analogue to these three maps in the pseudo-cubic case
is the following. Let ι1, ι2 : K ֒→ R be the two real embeddings of K into R.
The two maps

will also be denoted by ιi for i ∈ {1, 2}. The third map is simply

F → R,

(x, q) 7→ ιi(x)

ι3 : F → R,

(x, q) 7→ q.

We call these three (non-injective) maps ι1, ι2, ι3 : F → R the three real pseudo-
embeddings of F to R. We also refer to the ﬁrst two of these maps, ι1 and ι2, as
the two real quadratic pseudo-embeddings. Now consider some choice of pseudo-
real multiplication

ρ : F ֒→ End+

Q (Jac(X)).

This choice induces a monomorphism F ֒→ EndC(Ω(X)∗) and by duality a
monomorphism F ֒→ EndC(Ω(X)), both also denoted by ρ. Once we have ﬁxed
the choice of pseudo-real multiplication, we will also write x.· instead of ρ(x)(·)
wherever it makes sense.

85

Deﬁnition 8.1. Let X ∈ ]RMF for a pseudo-cubic number ﬁeld F and let ρ
be some choice of pseudo-real multiplication by F . Furthermore, let ι : F → R
be some real pseudo-embedding of F . Then a non-zero holomorphic one-form
ω ∈ Ω(X) is called a ι-eigenform for ρ, if

x.ω = ι(x)ω

for all x ∈ F . The form ω is called an eigenform for ρ if it is a ι-eigenform for
some real pseudo-embedding ι : F → R and it is just called an eigenform if it is
an eigenform for some choice of pseudo-real multiplication.

By the deﬁnition of the embedding of H1(X0; Z) into Ω(X)∗ by integrating
forms and the deﬁnition of the induced action of F on Ω(X) by duality, one sees
immediately that ω ∈ Ω(X) is a ι-eigenform for ρ if and only if we have

∫x.γ

ω = ι(x)∫γ

ω

for all x ∈ O and γ ∈ H1(X0; Z).
For every real pseudo-embedding ι we denote by Ωι(X) ≤ Ω(X) the one-
dimensional subspace of ι-eigenforms for ρ. Analogous to the case of totally real
number ﬁelds, we have the decomposition of Ω(X) into eigenspaces,

Ω(X) =

Ωιi(X),

3Mi=1

(8)

as can be easily seen by the description of principally polarized Abelian varieties
with pseudo-real multiplication in Section 6.3. On Ω(X) there is the Hermitian
form

hω1, ω2i =

ω1 ∧ ω2,

i

2ZX

and the action of F on Ω(X) is also self-adjoint with respect to this form.
Therefore, the decomposition (8) is in fact orthogonal.

We denote by

ΩιRMO ⊂ ΩM3

the locus of Riemann surfaces (respectively stable curves with compact Jaco-
bian) admitting pseudo-real multiplication by O together with the choice of
a ι-eigenform for some choice of such a pseudo-real multiplication, and by

(respectively Ωι]RMO ⊂ ΩfM3)

ΩιRMO ⊂ ΩM3

we denote its closure in the space of stable Abelian diﬀerentials. We deﬁne

ΩιRMF , Ωι]RMF and ΩιRMF analogously.
Lemma 8.2. Let O ⊂ F be a pseudo-cubic order and let ι : F → R be one of
the two real quadratic pseudo-embeddings. Moreover, let X ∈ ]RMO. Then, for
each choice of pseudo-real multiplication ρ by O, there is, up to scalar multiples,
a unique ι-eigenform ω for ρ. Conversely, if ω ∈ Ω(X) is any ι-eigenform,
then there is a unique choice of pseudo-real multiplication ρ realizing ω as a ι-
eigenform.

86

Proof. Without loss of generality, we may assume that ι = ι1. The ﬁrst state-
ment follows from the decomposition (8). To prove the second statement, let
ω ∈ Ω(X) be a ι-eigenform for two choices ρ1, ρ2 of pseudo-real multiplica-
tion. We have to show that they induce the same decomposition (8). A priori,
Ωι3(X) = Ωι3
ρi (X) depends on ρi. We have seen in Section 7.1, that each ρi
deﬁnes a one-dimensional subvariety Ci of X, namely the kernel of ρi(Q√D).
These kernels are just Ci = Ωι3
ρi(X) ∩ H1(X; Z). On the
other hand, as ω is a ι1-eigenform for both ρ1 and ρ2, each lattice Λi is generated
by those cycles γ ∈ H1(X; Z), where ∫γ ω = 0. Thus Ωι3
ρi (X) = Λi⊗Z Q depends
only on ω. Finally, Ωι2(X) is the orthogonal complement of Ωι1(X) ⊕ Ωι3(X)
in Ω(X).

ρi(X)/Λi with Λi = Ωι3

Recall that XO was deﬁned to be the moduli space of pairs (A, ρ), where A
is a principally polarized Abelian variety and ρ is pseudo-real multiplication

by O on A. Since the extended Torelli-map t : fM3 → A3 is surjective, we

immediately get the following corollary.

Corollary 8.3. The map

PΩι]RMO → XO,

(X, [ω]) 7→ (Jac(X), ρ),

where ρ denotes the choice of pseudo-real multiplication by O realizing ω as
a ι-eigenform form, is surjective. Furthermore, restricted to the dense subset
PΩιRMO, it is injective.

8.2 Lagrangian boundary strata

Here we recall the concept of Lagrangian boundary strata, see [BM12], Section 3.

For any stable curve X of arithmetic genus g, let N (X) be the set of nodes of X,
let C(X) be the set of cusps of X (so |C(X)| = 2|N (X)|), and let X0 again
be the complement of the nodes. For each cusp c of X we denote by c′ the
opposite cusp and by αc ∈ H1(X0; Z) the class of a positively oriented simple
closed curve around c. We deﬁne the subgroup

I := hαc + αc′ : c ∈ C(X)i ≤ H1(X0; Z),

the factor group

and its subgroup

bH1(X; Z) := H1(X0; Z)/I

bC(X) := h[αc] : c ∈ C(X)i ≤ bH1(X; Z).

If eX denotes any smooth curve obtained by thickening each node of X to an

annulus, we get the natural homomorphism

Deﬁnition 8.4. Let X be a stable curve of arithmetic genus g.

h : bH(X; Z) → H1(eX; Z).

1. A subgroup L ≤ bH1(X; Z) is called a Lagrangian subgroup, if the following

three conditions hold.

87

(a) The group L is free Abelian of rank g.

(b) The factor group bH1(X; Z)/L is torsion-free.
(c) The intersection form of H1(eX; Z) is trivial on h(L). (This is inde-

pendent from the choice of the thickening.)

2. A Lagrangian marking of X by L, where L is any free Abelian group of

rank g, is a group monomorphism

such that the image ̺(L) is a Lagrangian subgroup.

̺ : L ֒→ bH1(X; Z),
Remark that ̺(L) necessarily contains bC(X).

isomorphism ϕ∗ : bH1(X1; Z) → bH1(X2; Z) is compatible with the Lagrangian

An isomorphism (respectively topological equivalence) of pairs (X1, ̺1) and
(X2, ̺2) of stable curves with Lagrangian markings by L is by deﬁnition an
isomorphism (resp. homeomorphism) ϕ : X1 → X2, such that the induced group
markings, i.e. ϕ∗ ◦ ̺1 = ̺2. We denote by Mg(L) the space of isomorphism
classes of arithmetic genus g stable curves with Lagrangian markings by L and
by Mg(L) ⊂ Mg(L) the subspace of isomorphism classes of genus g Riemann
surfaces with Lagrangian markings by L.
We can realize those spaces by taking quotients of the Teichm¨uller spaces
in the following way. Fix a genus g surface Σg and a Lagrangian subgroup
L ≤ H1(Σg; Z). Let Mod(Σg) be the mapping class group of Σg. We deﬁne

Mod(Σg, L) := {σ ∈ Mod(Σg) : σ∗|L = IdL},

T (Σg, L) := {(X, f ) ∈ T (Σg) : f collapses only curves γ with [γ] ∈ L}

and get

Mg(L) = T (Σg)/Mod(Σg, L),
Mg(L) = T (Σg, L)/Mod(Σg, L).

A topological equivalence class in ∂Mg(L) = Mg(L) \ Mg(L) is called a La-
grangian boundary stratum.
If γ ∈ L ≤ H1(Σg; Z) is any non-zero simple closed curve, then we denote
by Dγ ⊂ Mg(L) the divisor of stable curves obtained by pinching a curve
homologous to γ.
If the geometric genus of X is zero, then there is another
viewpoint of the boundary strata which we will describe next.

Deﬁnition 8.5. Let L be a free Abelian group of rank g and let X be a stable
curve of arithmetic genus g and geometric genus 0. A L-weighting of X is a
map w : C(X) → L satisfying the following three conditions.

1. w(c) = −w(c′) for all c ∈ C(X).
2. Pc∈C(Y )

3. hw(C(X))iZ = L

w(c) = 0 for all irreducible components Y ⊆ X.

88

The image w(c) is called the weight of the cusp c.

It follows that cusps of separating nodes have weight zero. There is an
obvious correspondence between L-weighted stable curves (X, w) and genus zero
stable curves with Lagrangian markings (X, ̺). If c1, c′1, ..., cn, c′n are the cusps
of X coming from non-separating nodes, then the weights w(ci) generate L.
Hence the L-weighting w yields the well-deﬁned marking ̺ mapping each w(ci)

to αci ∈ bH1(X; Z).
Given a stable curve X of arbitrary geometric genus with a Lagrangian
marking ̺, and given a cusp c ∈ C(X) we will also call the element ̺−1(c) ∈ L
the weight of the cusp c.

An isomorphism (respectively topological equivalence) of pairs (X1, w1) and
(X2, w2) of L-weighted stable curves is by deﬁnition a weight preserving iso-
morphism (respectively homeomorphism). These correspond to the isomor-
phisms (respectively topological equivalences) of genus zero stable curves with
Lagrangian markings deﬁned above. In terms of L-weighted stable curves we
call a geometric genus zero Lagrangian boundary stratum a L-weighted boundary
stratum.

For an arbitrary Lagrangian boundary stratum (not necessarily consisting
of geometric genus zero curves) or L-weighted boundary stratum S we denote
by Weight(S) the set of weights of S.
Pseudo-embeddings of weighted boundary strata. In the case of a totally
real cubic number ﬁeld, we have natural embeddings of weighted boundary
strata into ΩM3 by using the embeddings of the ﬁeld into the real numbers. In
our pseudo-cubic case we deﬁne in the same way a (not necessarily injective)
map as follows. Let I be a lattice in F and let S ⊂ M3(I) be an I-weighted
boundary stratum. Furthermore, let ι : F → R be one of the three real pseudo-
embeddings into the real numbers. For every X ∈ S and for each cusp c of X,
we denote by w(c) the weight of the cusp. Then we deﬁne

πι : S → ΩM3,

(X, ̺) 7→ (X, ω),

where ω ∈ Ω(X) is the unique stable form which satisﬁes resc(ω) = ι(w(c))
for each cusp c. We will denote by pι the composition of πι with the natural
projection Ω(X) → PΩ(X) and refer to pι as the ι-pseudo-embedding of S.

8.3 Families with pseudo-real multiplication
We are interested in the boundary in M3 of the pseudo-real multiplication
locus in M3. We will use the concept of vanishing cycles, described in [BM12],
Section 5, and will ﬁrst give a short repetition. Then we will show that a
smooth family of stable curves at a geometric zero stable curve with pseudo-
real multiplication corresponds to a cusp packet.

We call a family X → ∆ = {z ∈ C : |z| < 1} of stable curves of arithmetic
genus three smooth, if for every z ∈ ∆∗ = ∆ \ {0} the ﬁber Xz is smooth. Such
a family deﬁnes via z 7→ Xz a holomorphic map ∆ → M3. Conversely, any
holomorphic map ∆ → M3 sending ∆∗ to M3, after possibly taking a cover
of ∆ ramiﬁed only over 0, arises from such a family.

89

For any two points z1, z2 ∈ ∆∗ and any path γ joining z1 with z2, we denote
If γ is a closed path in ∆∗,
by fγ : Xz1 → Xz2 the lifted homeomorphism.
starting and ending at z, then fγ is just a product of Dehn twists. There is
a collection of isotopy classes of simple closed curves in Xz1, called vanishing
curves, such that the images under fγ are pinched as z2 → 0. This collection
does not depend on the choice of the path. The homology classes in the subgroup
Vz ≤ H1(Xz; Z) generated by the vanishing curves are called vanishing cycles.
Let O be a pseudo-cubic order. A smooth family X → ∆ has pseudo-real
multiplication by O, if we can equip each smooth ﬁber Xz with pseudo-real
multiplication

ρz : O ֒→ End+(Jac(Xz))

for each z ∈ ∆∗, such that the isomorphisms H1(Xz1 ; Z) → H1(Xz2; Z) aris-
ing from the Gauss-Manin connection commute with the action of O. This
is equivalent to the condition that for each z1, z2 ∈ ∆∗ and for each path γ
in ∆∗ joining z1 with z2, the action of O on the homology groups H1(Xzi; Z)
commutes with the induced isomorphism (fγ)∗ : H1(Xz1; Z) → H1(Xz2 ; Z).
Analogous to [BM12], Proposition 5.5, we have the following lemma.
Lemma 8.6. Let X → ∆ be a smooth family of stable curves of arithmetic
genus three with pseudo-real multiplication by O. Then for each z ∈ ∆∗, the
action of O on H1(Xz; Z) preserves the subgroup Vz ≤ H1(Xz; Z) of vanishing
cycles.

Proof. By the deﬁnition of pseudo-real multiplication on a family, it suﬃces to
show that there is at least one z ∈ ∆∗, such that O preserves Vz.
as

Given any Riemann surface X, the Hodge-norm of γ ∈ H1(X; R) is deﬁned

where ||ω|| = (RX |ω|2)

2 ∫X ω1∧ω2.
The extremal length of the family of curves homotopic to a ﬁxed closed curve γ
in X is deﬁned as

2 is the norm induced by the form hω1, ω2i = i

1

where the supremum is taken over all conformal metrics ρ(z)dz with ρ nonneg-
ative and measurable,

||γ||X = sup
ω∈Ω(X)

||ω||=1 (cid:12)(cid:12)(cid:12)(cid:12)Zγ

ω(cid:12)(cid:12)(cid:12)(cid:12) ,

Ext(γ) := sup

ρ

L(ρ)2
A(ρ)

,

L(ρ) := inf

ρ(z)|dz|

δ≃γZδ
A(ρ) :=ZX
ρ(z)2|dz|2.
||γ||2

X ≤ Ext(γ)

and

Due to [BM12], Proposition 3.1, We have

for every closed curve γ in X. Furthermore, by [BM12], Proposition 3.2, there is
a constant C > 0 independent of X, such that any γ ∈ H1(X; Z) is represented
by a sum of simple closed curves δ1, ..., δn with
Ext(δi) ≤ C||γ||2

X

90

for each i.

For each x ∈ F we deﬁne

||x||∞ := |ι1(x)| + |ι2(x)| + |ι3(x)|,

primitive. We choose some ω0 ∈ Ω(X) with ||ω0|| = 1 and ||x.γ||Xz = |Rx.γ ω0|.

where ι1, ι2, ι3 again denote the three real pseudo-embeddings. Now let x ∈ O be
By the decomposition (8) of Ω(X), we can write ω0 = ω1 + ω2 + ω3 with
ωi ∈ Ωιi(X). Since this decomposition is orthogonal, we have ||ωi|| ≤ ||ω0|| = 1
and get the estimate

||x.γ||Xz ≤

=

ωi(cid:12)(cid:12)(cid:12)(cid:12)

3Xi=1(cid:12)(cid:12)(cid:12)(cid:12)Zx.γ
3Xi=1(cid:18)|ιi(x)| · ||ωi|| ·(cid:12)(cid:12)(cid:12)(cid:12)Zγ
3Xi=1

(|ιi(x)| · ||γ||Xz )

≤
= ||x||∞||γ||Xz

ωi

||ωi||(cid:12)(cid:12)(cid:12)(cid:12)(cid:19)

for every γ ∈ H1(Xz; Z). For any ε > 0, we may choose z suﬃciently small,
such that for each vanishing curve γi in Xz we have Ext(γi) < ε and thus

||x.γi|| < ||x||∞ε1/2.

So in H1(Xz; Z) each x.γi is represented by a sum of simple closed curves
δ1, ..., δn with

Ext(δi) < C||x||2

∞ε.

There is a constant D > 0, such that Ext(γ) > D for every z ∈ ∆∗ and every
curve γ in Xz that is not a vanishing curve. Thus, the δi must be vanishing
curves if we choose ε suﬃciently small, and the claim follows.

Recall that in M3(L) only curves in L are collapsed. Therefore, if the stable
curve X0 from the family in the lemma above is of geometric genus zero, then
in this case the Lagrangian subgroup of H1(Xz; Z) marked by L is exactly the
subgroup of vanishing cycles, and we will identify these two groups.

Proposition 8.7. Let O be a pseudo-cubic order with discriminant D of de-
gree d relatively prime to the conductor of D. Then each smooth family of
genus three stable curves X → ∆ with pseudo-real multiplication by O and with
the stable curve X0 of geometric genus zero, determines a unique cusp packet
in C(O).
Proof. Since X0 has geometric genus zero, each subgroup of vanishing cycles
Vz ≤ H1(Xz; Z) is free Abelian of rank three. The action of O on the groups
H1(Xz; Z) is compatible with the Gauss-Mannin connection and it preserves the
subgroup of vanishing cycles. Hence, we obtain pairwise isomorphic short exact
sequences of O-modules

0 → L → H1(Xz; Z) → H1(Xz; Z)/L → 0

(9)

91

mapping L onto Vz, where L is as a Z-module of rank three. Because the
intersection pairing on H1(Xz; Z) ⊗Z Q restricted to L ⊗Z Q is identically zero,
real multiplication is self-adjoint with respect to the intersection pairing and
F \ {0} has no nilpotent elements, there is no x ∈ F \ {0} with ρz(x)|L⊗Z Q ≡ 0.
Together with the fact that L ⊗Z Q and F both have Q-dimension three, it
follows that there exists an F -torsion-free element λ ∈ L and thus λ generates
L⊗ZQ as an F -module. In particular, there is an O-module isomorphism L ∼= I,
where I is a lattice in F such that the coeﬃcient ring O(I) of I contains O. Since
H1(Xz; Z) is isomorphic to a lattice in F 2 by Proposition 7.9, it follows from the
remark after Corollary 7.18, that the sequence (9) is a symplectic O-extension
in the sense of Deﬁnition 7.11. Hence the choice of pseudo-real multiplication
by O on the family X → ∆ determines a unique cusp packet (I, E) ∈ C(O).

8.4 Generalized period coordinates

Here we follow [BM12], Section 4, and introduce certain meromorphic functions
on the closure Mg(L), generalizing the classical period matrices.

First we will introduce some notations and identiﬁcations. Let R be a
commutative ring with 1 and M a R-module. Then the symmetric group
S2 = {id, θ} acts on the tensor product M ⊗R M by θ(x ⊗ y) := y ⊗ x for
all x, y ∈ M , so we can deﬁne

SymR(M ) := {λ ∈ M ⊗R M : θ(λ) = λ}

and

Furthermore, we denote for a Z-module M by

SR(M ) := (M ⊗R M )/S2.

h·,·i : SZ(Hom(M, Z)) × Sym(M ) → Z

the natural pairing deﬁned by

h[f1 ⊗ f2],Xi,j

xi ⊗ xji :=Xi,j

f1(xi)f2(xj ).

(10)

We ﬁx a genus g surface Σg and a Lagrangian subgroup L ≤ H1(Σg; Z).
We choose a Lagrangian complement of L, which is by deﬁnition a Lagrangian
subgroup M ≤ H1(Σg; Z), such that

H1(Σg; Z) = L ⊕ M.

For every (X, f ) ∈ T (Σg), this splitting yields the two isomorphisms
M : Ω(X) → HomZ(M, C),

P X
L : Ω(X) → HomZ(L, C), P X

both given by ω 7→ (γ 7→ ∫f (γ) ω). It follows that we get a holomorphic map

T (Σg) → HomC(HomZ(L, C), HomZ(M, C)),
(X, f ) 7→ P X

M ◦ (P X

L )−1.

92

There is the natural isomorphism

HomC(L∗ ⊗Z C, L ⊗Z C) ∼= L ⊗Z L ⊗Z C
cijλi ⊗ λj,

ψ 7→Xi,j

where (cij)i,j ∈ Cg×g is the representation matrix of ψ with respect to the
basis (λ1, ..., λg) of L and its dual basis (λ∗1, ..., λ∗g) of L∗ = HomZ(L, Z) (this
isomorphism does not depend on the choice of the basis).

Using the isomorphism M∗ = HomZ(M, Z) ∼= L given by the intersection

form on Σg, we obtain a holomorphic map

Φ : T (Σg) → L ⊗Z L ⊗Z C.

The embedding H1(X; Z) ֒→ Ω(X)∗ maps a given Z-basis (λ1, ..., λg) of L to a C-
basis of Ω(X)∗, and we denote by (ω1, ..., ωg) its dual basis of Ω(X). Moreover,
let (µ1, ..., µg) be its dual basis of M with respect to the intersection form. With
these notations and the identiﬁcation HomZ(M, C) ∼= L ⊗Z C, we get

ωj) =Xi

( ∫f (µi)

ωj)λi

ωj)λi ⊗ λj .

and thus

(P X

M ◦ (P X

L )−1)(λ∗j ) = (µ 7→ ∫f (µ)
Φ(X, f ) =Xi,j

( ∫f (µi)

Therefore, the coeﬃcients are the period coordinates of Jac(X) with respect to
our chosen bases. To be more precise, the period matrix with respect to the
symplectic basis (f (λ1), ..., f (λg), f (µ1), ..., f (µg)) of H1(X, Z) and the C-basis
(ω∗1, ..., ω∗g ) of Ω(X)∗ is (Ig, Z) with

Z = ( ∫f (µj )

ωi)i,j.

In particular, Z−1 lies in the upper Siegel half space and thus Z is symmetric.
Hence Φ maps in fact just to the symmetric tensors,

Φ : T (Σg) → SymZ(L) ⊗Z C.

We get the dual group homomorphism

Φ∗ : SZ(L∗) ⊗Z C → Hol(T (Σg), C),

[f1 ⊗ f2] 7→ ((X, f ) 7→ [f1 ⊗ f2](Φ(X, f ))),

which is just given by

Φ∗(λ∗i ⊗ λ∗j )(X, f ) = ∫f (µj )

ωi.

The map Φ∗ depends on the choice of the Lagrangian complement M . An-
other choice, say M′, yields another basis (µ′1, ..., µ′g) of M′ dual to (λ1, ..., λg)
with respect to the intersection form. Since L is Lagrangian, the duality condi-
tion gives that the new basis elements must be of the form µ′i = µi + li for some
li ∈ L. It follows that the restriction to SZ(L∗) of the new map diﬀers from

93

the restriction of the old one just by values in Z. Thus, we get a well-deﬁned
homomorphism

Ψ : SZ(L∗) → Hol∗(Mg(L)),

a 7→ exp(2πiΦ∗(a)(·)).

Recall that for any non-zero simple closed curve γ ∈ L, we deﬁned Dγ ⊂
Mg(L) to be the divisor of stable curves obtained by pinching a curve homolo-
gous to γ. Using the notation of the pairing (10), we have the following theorem.
Theorem 8.8 (Bainbridge, M¨oller). For each a ∈ SZ(L∗), the function Ψ(a) is
meromorphic on Mg(L). For each γ ∈ L \ {0}, the order of vanishing of Ψ(a)
along Dγ is

ordDγ (Ψ(a)) = ha, γ ⊗ γi.

The function Ψ(a) is holomorphic and nowhere vanishing along any Lagrangian
boundary stratum obtained by pinching a curve homologous to zero. If S is a
Lagrangian boundary stratum with

ha, γ ⊗ γi ≥ 0

If ha, γ ⊗ γi = 0
for all γ ∈ Weight(S), then Ψ(a) is holomorphic on S.
for all γ ∈ Weight(S), then Ψ(a) is nowhere vanishing on S. Otherwise, if
ha, γ ⊗ γi ≥ 0 for all γ ∈ Weight(S) and ha, γ0 ⊗ γ0i > 0 for at least one γ0, we
have Ψ(a) ≡ 0 on S.

This is Theorem 4.1. in [BM12] and a proof using plumbing coordinates can

be found there.

8.5 Admissibility

Our aim is, analogous to [BM12], Section 5, to formulate a necessary condition
for geometric genus zero stable curves for lying in the boundary of the pseudo-
real multiplication locus.

In all that follows, F = K ⊕ Q is again a pseudo-cubic number ﬁeld. As Q-
vector spaces, we can identify F with its dual HomQ(F, Q) via the isomorphism
given by the pseudo-trace pairing

F ∼= HomQ(F, Q),
x 7→ (y 7→ trp(xy))

and the tensor product F ⊗Q F with HomQ(F, F ) via the isomorphism

F ⊗Q F ∼= HomQ(F, F ),
x1 ⊗ x2

7→ (ψx1⊗x2 : y 7→ trp(x1y) · x2)

We call a homomorphism f ∈ HomQ(F, F ) self-adjoint, if

trp(f (x)y) = trp(xf (y))

holds for all x, y ∈ F . Thus, Hom+
is the subspace of all self-adjoint homomorphisms.

Q (F, F ) ≤ HomQ(F, F ) deﬁned in Section 7.3

94

The tensor product F ⊗Q F carries the structure of an F -bimodule, and we

can deﬁne the submodule

Λ1 := {λ ∈ F ⊗Q F : ∀x ∈ F : xλ = λx}.

Under the identiﬁcation of F ⊗Q F with HomQ(F, F ) above, SymQ(F ) corre-
sponds to Hom+
Q (F, F ) and Λ1 corresponds to HomF (F, F ). In particular, we
have Λ1 ⊂ SymQ(F ).

Using the identiﬁcation F ∼= F ∗ = HomQ(F, Q), we have a pairing

deﬁned by

h·,·i : SQ(F ) × SymQ(F ) → Q,

h[ϕ1 ⊗ ϕ2],Xi,j

qij xi ⊗ xji :=Xi,j

qij ϕ1(xi)ϕ2(xj )

on the simple tensors of SQ(F ). Since this pairing is perfect, we can identify
the dual of SymQ(F ) with SQ(F ). Finally, we denote by Ann(Λ1) ⊂ SQ(F ) the
annihilator of Λ1 with respect to this pairing.

Now let I be a lattice in F . For each I-weighted boundary stratum S we

deﬁne

C(S) := {a ∈ SQ(F ) : ∀w ∈ Weight(S) : ha, w ⊗ wi ≥ 0} and
N (S) := {a ∈ SQ(F ) : ∀w ∈ Weight(S) : ha, w ⊗ wi = 0}.

Deﬁnition 8.9. An I-weighted boundary stratum S is called admissible if

C(S) ∩ Ann(Λ1) ⊂ N (S).
Restriction gives a surjective map of algebraic tori
p : Hom(N (S) ∩ SZ(I∨), C∗) → Hom(N (S) ∩ Ann(Λ1) ∩ SZ(I∨), C∗).

For each non-zero a ∈ N (S) ∩ SZ(I∨), the function Ψ(a) is holomorphic and
nowhere vanishing on S by Theorem 8.8, hence we get a morphism

CR : S → Hom(N (S) ∩ SZ(I∨), C∗), X 7→ (a 7→ Ψ(a)(X))

For every a ∈ Ann(Λ1) ∩ SZ(I∨) and h ∈ SymQ(F ), we deﬁne

q(h)(a) := exp(−2πiha, hi).

As q(h)(a) = 1 for h ∈ Λ1 or h ∈ SymZ(I), we get a well-deﬁned homomorphism

q : SymQ(F )/(Λ1 + SymZ(I)) → Hom(N (S) ∩ Ann(Λ1) ∩ SZ(I∨), C∗).

Using the three maps above, every h ∈ SymQ(F )/(Λ1 + SymZ(I)) yields a
subvariety of S, namely

S(h) := CR−1(p−1(q(h))),

consisting of those X ∈ S, where Ψ(· )(X) and exp(−2πih· , hi) coincide on
N (S) ∩ Ann(Λ1) ∩ SZ(I∨).

95

Now we ﬁx a genus three surface Σ3. Given a lattice I in F , a homomorphism
Q (F, F ) ∼= SymQ(F ) and a symplectic Z-isomorphism η : I ⊕ I∨ →

h ∈ Hom+
H1(Σ3; Z), we deﬁne

RT (I, h, η) ⊂ T (Σ3)

to be the locus of those marked Riemann surfaces (X, f ) ∈ T (Σ3), such that
the Jacobian of X has pseudo-real multiplication by Oh(I) and the symplectic
Z-module isomorphism

f∗ ◦ η : (I ⊕ I∨)h → H1(X; Z)

is Oh(I)-linear. The Lagrangian decomposition induced by η determines the
holomorphic function

Φ : T (Σ3) → SymZ(I) ⊗Z C

from Section 8.4, and analogous to [BM12] we get the following proposition.
Lemma 8.10. The locus RT (I, h, η) is the preimage under Φ of the coset of
Λ1 ⊗Z C represented by −h,

RT (I, h, η) = Φ−1(Λ1 ⊗Q C − h).

Proof. Again we will identify F ⊗Q F with HomQ(F, F ) via the pseudo-trace
pairing, so in particular we may regard φ := Φ(X, f ) from Section 8.4 as an
element of Hom+

C (I∨ ⊗Z C,I ⊗Z C). Consider the graph

Graph(φ) = {(φ(µ), µ) : µ ∈ I∨ ⊗Z C} ⊂ (I ⊗Z C) ⊕ (I∨ ⊗Z C).

By the Hodge decomposition, the C-linear map

deﬁned as

Graph(φ) → HomC(Ω(X); C),

(φ(µ), µ) 7→ (ω 7→ ∫µ

ω) = (ω 7→ ∫φ(µ)

ω),

is an isomorphism. The last identity follows from the construction of Φ, and
therefore φ(µ) ∈ I ⊗Z C is the same element as µ ∈ I∨ ⊗Z C in H1(X; R). For
every x ∈ F we deﬁne fx ∈ EndC((I ⊗Z C) ⊕ (I∨ ⊗Z C)) by

fx(λ, µ) := (xλ + [Mx, h](µ), xµ),

which is just the C-linear continuation of the action of F on

H1(X; R) ∼= (I ⊗Z R) ⊕ (I∨ ⊗Z R).

The marked surface (X, f ) is in RT (I, h, η) if and only if the Oh(I)-module
structure on H1(X; Z) induced by f∗ ◦ η extends to pseudo-real multiplication
on Jac(X). This happens if and only if for each x ∈ Oh(I) the C-linear map fx
preserves Graph(φ), i.e.

fx(φ(µ), µ) = (φ(xµ), xµ)

for all µ ∈ I∨. This holds if and only if φ(xµ) = xφ(µ) + [Mx, h](µ), or
equivalently (φ + h)(xµ) = x(φ + h)(µ) for all µ ∈ I∨. Finally, this condition is
equivalent to

Φ(X, f ) + h ∈ Λ1 ⊗Q C.

96

Given a lattice I in F and a homomorphism h ∈ Hom+

Q (F, F ) ∼= SymQ(F ),

we deﬁne

RM(I, h) ⊂ M3(I)

to be the locus of pairs (X, ̺) of a genus three Riemann surface X and a La-
grangian marking ̺ : I ֒→ H1(X; Z), such that Jac(X) has pseudo-real multi-
plication by a pseudo-cubic order O ⊆ Oh(I), the marking ̺ is O-linear and
the symplectic (O,I)-extension

0 → I → H1(X; Z) → I∨ → 0

induced by ̺ is isomorphic to Eh(I) (in particular O = Oh(I)).
For every (X, ̺) ∈ RM(I, h), we can choose a symplectic Z-isomorphism
η : I ⊕ I∨ → H1(Σ3; Z) and a marking f : Σ3 → X, such that (X, ̺) can be
represented by some (X, f ) ∈ RT (I, h, η) in the Teichm¨uller space T (Σ3).
Corollary 8.11. Let I be a lattice in F and h ∈ SymQ(F ).

1. For every a ∈ Ann(Λ1) ∩ SZ(I∨) and h ∈ SymQ(F ) we have
Ψ(a)|RM(I,h) ≡ exp(−2πiha, hi) = q(h)(a).

2. If S ⊂ M3(I) is an I-weighted boundary stratum with S ∩RM(I, h) 6= ∅,

then S is admissible and we have S ∩ RM(I, h) ⊆ S(h).

Proof. The ﬁrst statement follows immediately from the last proposition and the
deﬁnitions of Φ and Ψ. To prove the second one, let S be an I-weighted bound-
ary stratum with S ∩ RM(I, h) 6= ∅. If S were non-admissible, there would be
some a ∈ Ann(Λ1) ∩ SZ(I∨) with ha, w ⊗ wi ≥ 0 for all w ∈ Weight(S) and
ha, w0 ⊗ w0i > 0 for some speciﬁc w0 ∈ Weight(S). But then by Theorem 8.8,
we would have Ψ(a)|S ≡ 0, hence a contradiction as Ψ(a) ≡ q(h)(a) 6= 0 on
RM(I, h).

the locus of principally polarized complex Abelian varieties with pseudo-real

Let fMg ⊂ Mg be the locus of stable curves with compact Jacobians. For
g ∈ {2, 3}, the Torelli-map t : fMg → Ag is surjective. We denote by RAO ⊂ A3
multiplication by a pseudo-cubic order O, hence ]RMO = t−1(RAO) ⊂ M3.
Now ﬁx one of the two real quadratic pseudo-embeddings ι : F ֒→ R. By
Corollary 8.3, we have a surjective map

PΩι]RMO → XO,

(X, [ω]) 7→ (Jac(X), ρ),

that is injective on PΩιRMO. It is a consequence of [Nam76], Corollary (18.9),
that this map extends continuously to

PΩιRMO → X

BB

O .

BB

BB

O .

If the geometric genus of a stable curve X is zero, then (X, [ω]) is mapped to
a cusp of X
If the geometric genus is one (respectively two), then it is
O with representatives in P1(K) × H (respectively
mapped to an element of X
H2 × P1(Q)). Each cusp of X
O corresponds to a unique cusp packet (I, E)
in C(O), and we call the preimage of (I, E) in PΩιRMO the cusp of PΩιRMO
associated to (I, E).

BB

97

Theorem 8.12. Let O ⊂ F be a pseudo-cubic order of degree relatively prime
to the conductor of D, and let (I, Eh(I)) ∈ C(O) be a cusp packet for O.
Furthermore, let ι : F ֒→ R be one of the two real quadratic pseudo-embeddings.
Then the closure of the cusp of PΩιRMO associated to (I, Eh(I)) is contained
in the union of all pι(S(h)), the ι-pseudo-embeddings of the subvarieties S(h)
of S, where S runs over all admissible I-weighted boundary strata.
Proof. Let (X, [ω]) be in the closure of the cusp of PΩιRMO associated to
(I, Eh(I)). Since the locus PΩιRMO is a variety, we can choose a holomorphic
map

∆ → PΩιRMO,

z 7→ (Xz, [ωz])

with (X0, ω0) = (X, ω) and which sends ∆∗ to PΩιRMO. Let f be the com-
position of this map with the forgetful map to M3. By what we have said
in Section 8.3, the map f can be chosen such that it arises from a smooth
family X → ∆ with pseudo-real multiplication by O. In the proof of Propo-
sition 8.7, we have seen that f factorizes through a map ∆ → M3(I), map-
ping ∆∗ to RM(I, h) and 0 to some I-weighted boundary stratum S with
S ∩ RM(I, h) 6= ∅. Thus by Corollary 8.11, the stratum S is admissible and
(X0, ̺0) lies in S(h).
It remains to show that the residues of the stable form ω are common mul-
tiples of the images under ι of the weights of the corresponding cusps. For
every z ∈ ∆∗, the Lagrangian marking ̺z maps I onto the group of vanishing
cycles of Xz. Therefore, for each vanishing curve λ ∈ I, we have

ι(λ) ∫(1,1)

ωz = ∫̺z(λ)

ωz ≡ r(λ),

where r(λ) is the residuum of ω at the cusp represented by λ, and the statement
follows.

What we have just proven, is a reﬁnement of the following corollary.

Corollary 8.13. Let O be a pseudo-cubic order of degree relatively prime to the
conductor of D. Then each geometric genus zero stable curve X ∈ RMO lies
in the image under the forgetful map of some admissible I-weighted boundary
stratum S ⊂ M3(I).

8.6 A reformulation of admissibility

For a totally real cubic ﬁeld, Bainbridge and M¨oller constructed in [BM12],
Section 6, a quadratic map Q from the ﬁeld to itself, which allows to test
explicitly if a weighted boundary stratum is admissible or not, by checking a
geometric condition for the Q-values of the weights of the stratum.
In our
pseudo-cubic case, this map map turns out to be a little more unwieldy, as it
just maps to Q3. However, we can construct it in such a way, that we get the
same geometric condition.

Recall that we identiﬁed F with F ∗ = HomQ(F, Q) using the pseudo-trace

pairing and that we deﬁned a perfect pairing on

SQ(F ) × SymQ(F ) → Q

98

by

h[ϕ1 ⊗ ϕ2],Xi,j

qij xi ⊗ xji =Xi,j

qij ϕ1(xi)ϕ2(xj).

There is another perfect pairing

h·,·i : (F ⊗Q F ) × (F ⊗Q F ) → Q

deﬁned by

hx1 ⊗ x2, y1 ⊗ y2i := trp(x1y1)trp(x2y2)

on the simple tensors. The latter is in fact also symmetric and positive deﬁnite,
and its restriction induces a symmetric and positive deﬁnite pairing

Therefore, we get isomorphisms

SymQ(F ) × SymQ(F ) → Q.

SQ(F ) ∼= HomQ(SymQ(F ), Q) ∼= SymQ(F ).

These isomorphisms identify Ann(Λ1) ⊂ SQ(F ) with Λ⊥1 ⊂ SymQ(F ). Since Λ1
is isomorphic to HomF (F, F ), it has Q-dimension three, and thus

dimQ(Λ⊥1 ) = dimQ(SymQ(F )) − dimQ(Λ1) = 3.

By using suitable coordinates we can identify Λ⊥1 with Q3 and state a reformu-
lation of admissibility.

Theorem 8.14. Let Q be the function deﬁned by

Q : F → Q3,

(x, q) 7→

N (√Dx)
tr(x)q
tr(√Dx)q



and let h·,·is be the standard scalar product in Q3. Then an I-weighted boundary
stratum S is admissible if and only if for every v ∈ Q3 the following condition
holds. If we have

for all w ∈ Weight(S), then we also have

hv, Q(w)is ≥ 0

hv, Q(w)is = 0

for all w ∈ Weight(S).
the set

Equivalently, an I-weighted boundary stratum S is admissible if and only if

Q(S) := {Q(w) : w ∈ Weight(S)}

is not contained in a closed half-space of its Q-span, and this holds if and only
if 0 lies in the interior of the convex hull of Q(S).
Proof. A Q-basis of Λ1 is given by B1 = (λ1, λ2, λ3) with
λ1 = (1, 0) ⊗ (1, 0) + 1
λ2 = (√D, 0) ⊗ (1, 0) + (1, 0) ⊗ (√D, 0),
λ3 = (0, 1) ⊗ (0, 1).

D [(√D, 0) ⊗ (√D, 0)],

99

A Q-basis of the orthogonal complement Λ⊥1 is given by B⊥ = (µ1, µ2, µ3) with

µ1 = 1
µ2 = 1
µ3 = 1

4 ((√D, 0) ⊗ (√D, 0) − D((1, 0) ⊗ (1, 0))),
2 ((1, 0) ⊗ (0, 1) + (0, 1) ⊗ (1, 0)),
2 ((√D, 0) ⊗ (0, 1) + (0, 1) ⊗ (√D, 0)).

We want to see what admissibility means in terms of our new spaces. Let a ∈ Λ⊥1
and let w ∈ F . We write a =P3
i=1 qiµi with q = (q1, q2, q3) ∈ Q3 and we write
w = (x, q) with x = r + s√D, q, r, s ∈ Q. An elementary computation gives
=*

ha, w ⊗ wi = q1(s2D2 − r2D) + q2rq + q3sDq

N (√Dx)
tr(x)q
tr(√Dx)q

 ,

q1
q2
q3

+

s

= hq, Q(w)is

and this ﬁnishes the proof.

Remark 8.15. In [BM12], the pseudo-cubic ﬁeld F is replaced by a totally
real number ﬁeld. The Galois closure of F is denoted by K. The orthogonal
decomposition

is induced by the decomposition

SymQ(F ) = Λ1 ⊕ Λ⊥1
K ⊗Q K = Mσ∈Gal(K/Q)

Λσ

with

Λσ := {λ ∈ K ⊗Q K : x · λ = λ · σ(x) for all x ∈ K}.

This does not work in the pseudo-cubic case, because for our non-trivial auto-

morphism σ : Q(√D) ⊕ Q → Q(√D) ⊕ Q, one can easy compute that

Λ1 ∩ Λσ = h(0, 1) ⊗ (0, 1)iQ,

hence the intersection is non-trivial. The reason is that σ acts on {0} ⊕ Q as
the identity.

8.7 Period coordinates in terms of cross-ratios
Each I-weighted boundary stratum S can be described in projective coordinates.
Analogously to [BM12], we construct explicit equations in terms of cross-ratios
of these coordinates which cut out the subvarieties S(h).
In Section 8.4 we introduced the group homomorphism

Ψ : SZ(I∨) → Mer(M3(I)),

a 7→ exp(2πiΦ∗(a)(·)),

where Mer(M3(I)) denotes the multiplicative group of meromorphic functions
on M3(I). Furthermore, in Section 8.5 we deﬁned on a given I-weighted bound-
ary stratum S the map

CR : S → Hom(N (S) ∩ SZ(I∨), C∗), X 7→ (a 7→ Ψ(a)(X)) .

100

For each h ∈ SymQ(F )/(Λ1 + SymZ(I)), the subvariety S(h) ⊂ S was deﬁned
to be the locus of those X ∈ S satisfying the equations
Ψ(a)(X) = exp(−2πiha, hi)

for all a ∈ N (S) ∩ Ann(Λ1) ∩ SZ(I∨). We want to describe these functions in
terms of cross-ratios for certain types of Lagrangian boundary strata to give a
more explicit version of Corollary 8.11.

The type of a boundary stratum S is given by the combinatoric of its dual
graph deﬁned as follows. Take an arbitrary X ∈ S. Then the dual graph Γ(S)
of S consists of a vertex for each irreducible component of X and an edge for
each node of X. The endpoints of an edge coming from a node n ∈ N (X)
are just the vertices coming from the irreducible components connected by n
(particularly Γ(S) may have loops as edges).
We are interested in strata of geometric genus zero stable curves. The dual
graphs of these strata must have Euler characteristic −2 (roughly spoken, one
needs three nodes to kill the holes and one node for producing an additional
irreducible component) and the degree of each vertex is at least three. It follows
that such a dual graph has at most four vertices and that there exist exactly 15
types of strata.

The irreducible stratum. First we will discuss the irreducible strata, i.e. the
strata where the dual graph is the unique graph with just one vertex (and thus
three loops as edges), as can be seen in Figure 3.

Figure 3: The dual graph of an irreducible stable curve of geometric genus zero

Given a Z-basis r = (r1, r2, r3) of I, let Sr ⊂ ∂M3(I) be the I-weighted
irreducible boundary stratum with weights r1, r2, r3. Every I-weighted stable
curve in Sr can be realized in the following way. Choose a tuple of six distinct
points p = (p1, p2, p3, q1, q2, q3) ∈ P1(C)6 and identify each pi with qi. Then
deﬁne an I-weighting of the resulting stable curve Xp by setting w(pi) = ri and
w(qi) = −ri. Two such I-weighted stable curves represent the same element
in M3(I) if and only if there is an isomorphism between Xp and Xp′ preserving
the ordered sextuples of chosen points. Thus Sr is isomorphic to M0,6, the
moduli space of six ordered marked points on P1(C). Our aim is to determine
Ψ(a)(Xp) for arbitrary Xp ∈ Sr and a ∈ SZ(I∨), and we do this in terms of a
basis for SZ(I∨).
Lemma 8.16. Let r = (r1, r2, r3) be a Z-basis of I and let s = (s1, s2, s3) be its
dual basis of I∨ with respect to the pseudo-trace pairing. If S is any I-weighted
boundary stratum with weigths

Weight(S) = {±r1,±r2,±r3},

101

then (s1 ⊗ s2, s1 ⊗ s3, s2 ⊗ s3) is a Q-basis of N (S) and thus a Z-basis of the
intersection N (S) ∩ SZ(I∨).
Proof. A Q-basis of SQ(F ) is given by the simple tensors si ⊗ sj with 1 ≤ i ≤
j ≤ 3 and for any a =Pi≤j aijsi ⊗ sj we have ha, ri ⊗ rii = aii.
(z1 − z3)(z2 − z4)
(z1 − z4)(z2 − z3) ∈ P1(C)

For z1, z2, z3, z4 ∈ P1(C) we denote by

(z1, z2; z3, z4) =

their cross-ratio and for p = (p1, p2, p3, q1, q2, q3) ∈ P1(C)6 with pairwise distinct
entries we set

pjk := (pj, qj; qk, pk) ∈ C \ {0, 1}

for all j 6= k.
Lemma 8.17. Let r = (r1, r2, r3) be a Z-basis of I and let s = (s1, s2, s3) be
its dual basis of I∨ with respect to the pseudo-trace pairing. Then we have

Ψ(sj ⊗ sk)(Xp) = pjk

for all Xp ∈ Sr and j 6= k.
Proof. M¨obius transformations preserve cross-ratios, so without loss of gener-
ality we may assume that pj = 0, qj = ∞ and qk = 1. By the description in
Section 8.4 of Φ∗ in terms of period coordinates we see that Ψ(sj ⊗ sk)(Xp) is
computed in the following way.
For each cusp c, let γ(c) be a positively oriented, simple closed curve winding
once around c. Then let ωj be the stable Abelian diﬀerential with ∫γ(pi) ωj = δij
and ∫γ(qi) ωj = −δij for every i. Since pj = 0 and qj = ∞, we get ωj = 1
2πiz dz.
Now we have to integrate ωj over a path γk starting at pk and ending at qk = 1.
This yields

Ψ(sj ⊗ sk)(Xp) = exp(2πi ∫γk

ωj) = exp(∫γk

1

z dz) = p−1

k = pjk.

Theorem 8.18. Let r = (r1, r2, r3) be a Z-basis of I, let s = (s1, s2, s3) be its
dual basis of I∨ with respect to the pseudo-trace pairing and let h be an element
of SymQ(F )/(Λ1 + SymZ(I)). Writing

h =

3Xi,j=1

bij(ri ⊗ rj )

with bij ∈ Q and bij = bji, and identifying the I-weighted boundary stratum Sr
with M0,6 as above, the subvariety Sr(h) ⊂ Sr is cut out by the equations

pa1
23 · pa2

13 · pa3

12 = exp(−2πi(a1b23 + a2b13 + a3b12)),

where (a1, a2, a3) runs over the integral solutions of

a1s2s3 + a2s1s3 + a3s1s2 = 0.

(11)

102

Proof. By Lemma 8.16, each a ∈ N (Sr) ∩ SZ(I∨) can be written as

a = a1s2 ⊗ s3 + a2s1 ⊗ s3 + a3s1 ⊗ s2

with ai ∈ Z. Then the term a1b23 + a2b13 + a3b12 is just ha, hi, so by the
last lemma it remains to show that Equation (11) describes the intersection of
N (Sr) ∩ SZ(I∨) with Ann(Λ1). We deﬁne λ = r1 ⊗ s1 + r2 ⊗ s2 + r3 ⊗ s3.
Under the identiﬁcation F ⊗Q F ∼= HomQ(F, F ) this element corresponds to the
identity, hence it generates Λ1 as a F -module. Thus a lies in Ann(Λ1) if and
only if ha, xλi = 0 for all x ∈ F . Since

ha, xλi = ha, λxi = trp(x(a1s2s3 + a2s1s3 + a3s1s2)),

this holds if and only if

a1s2s3 + a2s1s3 + a3s1s2 = 0.

In particular, we have shown that Sr(h) ⊂ Sr is cut out by r cross-ratio
equations, where r = rkZ (N (Sr) ∩ SZ(I∨) ∩ Ann(Λ1)) is also the rank of the
Z-module of the solutions of Equation (11).

Example 8.19. In [BM12] it is shown that for a cubic number ﬁeld and an
admissible stratum Sr, the Z-module N (Sr) ∩ SZ(I∨) ∩ Ann(Λ1) has rank one.
Here in the pseudo-cubic case, there is more than one possibility for this rank.
1. Set r1 = (1, 0), r2 = (√D, 0) and r3 = (0, 1). Then Q(r1) = (−D, 0, 0)t,

Q(r2) = (D2, 0, 0)t and Q(r3) = 0, thus Sr is admissible. Moreover, we
have s1s2 = ( 1
4√D

, 0) and s2s3 = s3s1 = 0, hence

rkZ(N (Sr) ∩ SZ(I∨) ∩ Ann(Λ1)) = 1.

2. Set r1 = (1, 1

√D, 0), hence

2 D), r2 = (1,− 1

2 D) and r3 = (√D, 0). Then we get Q(r1) =
(−D, D, 0)t, Q(r2) = (−D,−D, 0)t and Q(r3) = (D2, 0, 0), thus Sr is
admissible. Moreover, we have s1s2 = ( 1
D2 ) and s2s3 = s3s1 =
( 1
8D

16 ,− 1

rkZ(N (Sr) ∩ SZ(I∨) ∩ Ann(Λ1)) = 2.

A non-irreducible stratum. Another type of stratum is the one where the
dual graph has two vertices, one loop at each vertex and two edges connecting
the two vertices, as can bee seen in Figure 4.

Figure 4: The dual graph of a certain non-irreducible stable curve

103

For a given Z-basis (r1, r2, r3) of I, let ¯r = ((r1, r3), (r2, r3)) and let S¯r be
the I-weighted boundary stratum of this type with weights ±r1,±r3 on one
irreducible component and weights ±r2,±r3 on the other. Every I-weighted
stable curve in S¯r can be realized in the following way. Take two copies of
3 , q−3 ) of four distinct points in the ﬁrst
P1(C), then choose a tuple (p1, q1, p+
3 , p−3 ) of four distinct points in the second copy. Now
copy and a tuple (p2, q2, q+
identify p1 with q1, p2 with q2, p+

3 and p−3 with q−3 .

3 with q+

p1

q1

p+
3

q+
3

q−3

p−3

p2

q2

Figure 5: The stable curve X ¯p

i

i

Then deﬁne an I-weighting on the resulting stable curve X ¯p by w(p(±)

) = ri
) = −ri. Therefore, the stratum S¯r is isomorphic to M0,4 × M0,4.

and w(q(±)
Analogous to the irreducible stratum we deﬁne the cross-ratios
3 , p−3 )

¯p13 = (p1, q1; q−3 , p+

¯p23 = (p2, q2; q+

3 ),

and get the following lemma.
Lemma 8.20. Let r = (r1, r2, r3) be a Z-basis of I and let s = (s1, s2, s3) be
its dual basis of I∨ with respect to the pseudo-trace pairing. Then we have

Ψ(s1 ⊗ s2)(X ¯p) = 1,
Ψ(s1 ⊗ s3)(X ¯p) = ¯p13,
Ψ(s2 ⊗ s3)(X ¯p) = ¯p23

for all X ¯p ∈ S¯r.
Proof. To compute Ψ(sj ⊗ sk) with j ∈ {1, 2}, we have to integrate a stable
Abelian diﬀerential ωj that has two simple poles at pj, qj and is holomorphic
everywhere else. Thus ωj must vanish on the component not containing pj. In
the case k = 2 we integrate over a path γ2 joining p2 with q2 in the component
where ω1 is vanishing, so

Ψ(s1 ⊗ s2)(X ¯p) = exp(2πi ∫γ2

ω1) = 1.

In the case i = 1, k = 3 we have to integrate over a path starting at p+
3 , running
over q−3 = p−3 and ending at q+
3 . The second part of this path lies in the
3 to q−3 .
component where ω1 is vanishing, so we just have to integrate from p+
Again by using M¨obius transformations we may assume that p1 = 0, q1 = ∞
and q−3 = 1 and get

Ψ(s1 ⊗ s3)(Xp) = exp(2πi ∫γ3

∫p+
ω1) = exp(

1

3

1

z dz) = (p+

3 )−1 = ¯p13.

104

Finally, by replacing 1 with 2, we get Ψ(s2 ⊗ s3)(Xp) = ¯p23.
Proposition 8.21. Let r = (r1, r2, r3) be a Z-basis of I, let s = (s1, s2, s3)
be its dual basis of I∨ with respect to the pseudo-trace pairing and let h be an
element of SymQ(F )/(Λ1 + SymZ(I)). Writing

h =

3Xi,j=1

bij(ri ⊗ rj )

with bij ∈ Q and bij = bji and identifying the I-weighted boundary stratum S¯r
with M0,4×M0,4 as above, the subvariety S¯r(h) ⊂ S¯r is cut out by the equations

(¯p23)a1 · (¯p13)a2 = exp(−2πi(a1b23 + a2b13 + a3b12)),

where (a1, a2, a3) runs over the integral solutions of

a1s2s3 + a2s1s3 + a3s1s2 = 0.

Proof. Using the Ψ-values from the previous lemma, this proof works precisely
as the proof of Theorem 8.18.

We call the type of the boundary stratum given by the graph in Figure 3
the trinodal type and the type of the boundary stratum given by the graph in
Figure 4 the nice non-trinodal type. We denote by Snice ⊂ PΩM3 the locus of
stable forms (X, [ω]), where X is a stable curve in a stratum of one of these
types. By the cross-ratio equations and the techniques developed in [BM12], it
follows that the necessary condition in Theorem 8.12 is also suﬃcient for stable
forms in Snice.
Theorem 8.22. Let O ⊂ F be a pseudo-cubic order of degree relatively prime
to the conductor of D, and let (I, Eh(I)) ∈ C(O) be a cusp packet for O.
Furthermore, let ι : F ֒→ R be one of the two real quadratic pseudo-embeddings.
Then the intersection of the closure of the cusp of PΩιRMO associated
to (I, Eh(I)) with Snice is equal to the union of all pι(S(h)), the ι-pseudo-
embeddings of the subvarieties S(h) of S, where S runs over all admissible
I-weighted boundary strata of trinodal and nice non-trinodal type.
Proof. By Corollary 8.11 and Theorem 8.12, it remains to show that the converse
inclusion S(h) ⊆ S ∩ RM(I, h) holds for all admissible boundary strata S of
trinodal or nice non-trinodal type. But this proof is already done in [BM12],
Section 8. A sketch of this proof is as follows.

The stratum S ⊂ M3(I) = T (Σ3,I)/Mod(Σ3,I) is obtained by pinching
curves γ1, ..., γm in Σ3. Let U (S) be the union of M3(I), S and all bound-
ary strata obtained by pinching only curves γk. Thus U (S) is an open subset
of M3(I). Then one can ﬁnd convenient τ1, ..., τn ∈ SZ(I∨), such that after
possibly switching to a degree two quotient S′ of S, the maps Ψ(τ1), ..., Ψ(τn)
form a system of local coordinates on S respectively S′. Here the description
of Ψ in terms of cross-ratios was used, in our cases given by Lemma 8.17 and
Lemma 8.20. Finally, one can prove the analogous statement for algebraic tori,
and the claim follows. We refer the reader to [BM12] for more details.

105

9 Prym Teichm¨uller curves

In his famous work [McM03], McMullen showed that in genus two, the Riemann
surfaces (with a suitable choice of a holomorphic one-form) generating primitive
Teichm¨uller curves are precisely those Riemann surfaces admitting real multipli-
cation on their Jacobian. A few years later, he discovered in [McM06a] inﬁnite
many examples of primitive Teichm¨uller curves in genus three. Indeed, he con-
structed inﬁnitely many ﬂat surfaces with a holomorphic involution, such that
the resulting Prym variety admits real multiplication. For a crosscheck, we
check the admissibility-condition from Theorem 8.12 on a class of these surfaces
obtained by the Thurston-Veech construction. Moreover, we will determine the
cross-ratio equations for these examples.

9.1 Prym varieties

In this subsection we give a brief introduction to Prym varieties. We will use
the deﬁnition of McMullen in [McM06a] and present some of his results.

Prym varieties. Fix a Riemann surface X ∈ Mg and a non-trivial involution τ
of X, i.e. some τ ∈ Aut(X)\{Id} with τ 2 = Id. We will call such a pair (X, τ ) a
Prym surface. The pullback τ∗ ∈ AutC(Ω(X))\{Id} is an involution of C-vector
spaces and hence it deﬁnes a decomposition

Ω(X) = Ω(X)+ ⊕ Ω(X)−,

where Ω(X)± is the eigenspace of τ∗ to the eigenvalue ±1. We will call the
elements of Ω(X)− the Prym forms of X with respect to τ . This yields a de-
composition of the dual vector spaces

Ω(X)∗ = (Ω(X)+)∗ ⊕ (Ω(X)−)∗,

where (Ω(X)+)∗ is the space of linear forms vanishing on Ω(X)− and vice versa.
Now consider the eigenspaces H1(X; Z)± ⊂ H1(X; Z) to the eigenvalues ±1
of the induced Z-module automorphism τ∗ ∈ AutZ(H1(X; Z)). We have the
following well known decomposition of Jac(X).

Lemma 9.1. Let (X, τ ) be a Prym surface. Then the quotients

Jac(X)+ := (Ω(X)+)∗/H1(X; Z)+ and Jac(X)− := (Ω(X)−)∗/H1(X; Z)−

are complementary subvarieties of Jac(X).

Proof. The involution τ∗ is self-adjoint with respect to the intersection pairing
and thus H1(X; Z)+ and H1(X; Z)− are orthogonal submodules. From the
formula ∫τ∗(γ) ω = ∫γ τ∗(ω) for all γ ∈ H1(X; Z) and ω ∈ Ω(X), it follows that
each group H1(X; Z)± is mapped into (Ω(X)±)∗ under the usual embedding
H1(X; Z) ֒→ Ω(X)∗. Since

H1(X; Q) = H1(X; Q)+ ⊕ H1(X; Q)−,

we have that H1(X; Z)± is a lattice in (Ω(X)±)∗, and that (Ω(X)+)∗ and
(Ω(X)−)∗ are orthogonal with respect to the intersection form. It follows that
(Jac(X)+, Jac(X)−) is indeed a pair of complementary subvarieties of Jac(X).

106

Deﬁnition 9.2. Let (X, τ ) be a Prym surface. The subvariety

Prym(X, τ ) := Jac(X)−

of Jac(X) is called the Prym variety of (X, τ ).

The pullback of the canonical projection π : X → X/τ is an isomorphism

π∗ : Ω(X/τ ) ∼= Ω(X)+, and thus

p(X, τ ) := dim(Prym(X, τ )) = g(X) − g(X/τ ).

The projection π is of degree two, so by the Riemann-Hurwitz formula we have

g(X) = 2p(X, τ ) + 1 − 1

2|Fix(τ )|,

where Fix(τ ) ⊂ X denotes the set of ﬁxpoints of τ . Therefore, we get

p(X, τ ) ≤ g(X) ≤ 2p(X, τ ) + 1.

(12)

These inequalities are sharp. This can be seen by deﬁning τ to be the canonical
involution of a hyperelliptic surface X which yields Ω(X) = Ω(X)−, respec-
tively by deﬁning τ to be the non-trivial deck transformation of a degree-two
unramiﬁed double covering X → Y , which yields Fix(τ ) = ∅. If p(X, τ ) = 2,
then according to (12) the genus of X lies in {2, 3, 4, 5}.
Prym varieties with real multiplication. We are interested in genus three
Prym surfaces (X, τ ), such that Prym(X, τ ) is of dimension two and has real
multiplication by a real quadratic order OD. Given such a Prym surface, we
call a Prym form ω ∈ Ω(X)− a Prym eigenform, if it is an eigenform for some
choice of real multiplication on Prym(X, τ ) by OD (i.e. an eigenform for the
corresponding pseudo-real multiplication). We denote by ΩE g
D ⊆ ΩMg the lo-
cus of all pairs (X, ω), such that there exists a non-trivial involution τ of X,
the corresponding Prym variety Prym(X, τ ) is of dimension two and has real
multiplication by the real quadratic order OD, and such that ω 6= 0 is a Prym
eigenform. Furthermore, we denote by ΩW g
D the locus of those (X, ω),
D respectively W g
where ω has a unique zero (of degree 2g − 2), and by E g
D the
image of ΩE g
McMullen showed in [McM06a], that the locus W g
D is the union of ﬁnitely
many Teichm¨uller curves, and that for non-square D, each such curve is primi-
tive. He used the following theorem we will need in the next subsection.
Theorem 9.3 (McMullen). The locus ΩE g
plication by OD is a closed, SL2(R)-invariant subset of ΩMg.

D of Prym eigenforms for real multi-

D ⊆ ΩE g

D respectively ΩW g

D in Mg.

Furthermore, he developed the following very useful suﬃcient condition for

holomorphic one-forms for lying in ΩE g
D.
Theorem 9.4 (McMullen). Let (X, τ ) be a Prym surface, such that the dimen-
sion of Prym(X, τ ) is two and let ω ∈ Ω(X)− \ {0}. If SL(X, ω) contains a
hyperbolic element A, then we have (X, ω) ∈ ΩE g
D for some D ∈ N>1 satisfying
Q(√D) = Q(tr(A)).

Note that in this theorem D may be a square, or equivalently OD may be

an order in Q ⊕ Q.

107

9.2 Cusps of Prym Teichm¨uller curves - an example

In [Thu88] Thurston constructed a large class of diﬀeomorphisms on a given
surface by using generalized Dehn twists about multicurves. In [McM06a], Mc-

Mullen used this construction to obtain inﬁnitely many points inSD WD ⊂ Mg

for each g ∈ {2, 3, 4}. This leads to inﬁnitely many primitive Teichm¨uller curves
in Mg. Since our focus is on the genus three case, we give a more detailed
discussion of this construction for g = 3, including a computation of the dis-
criminant of these examples. Furthermore, we will use these examples for doing
a crosscheck of Theorem 8.12 and determine the corresponding cross-ratio equa-
tions.

S-shaped polygons. We ﬁrst explain the construction, established by Mc-
Mullen in [McM06a]. For each n ∈ N, we deﬁne the matrix

An :=

1

0
0
0

0
1
0
0
0 n 0
0
0
0
0
1
0
0 n 0
0
0
0
0
1
1
n 0
0
0

1
0
0
0

1
0



.



µ =qn + 1 + √2n + 1,
µ/n√2

µ/n

µ − n/µ

µ/n

=

=





.



µ/n

1√2µ/n

1

h1
h2
h3
h4
h5
h6







1

1

µ2/n − 1

The characteristic polynomial of An is

χAn (x) = (x2 − n)(x4 − 2(n + 1)x2 + n2),

and thus An has six pairwise diﬀerent real eigenvalues. The largest one is

and a generator for the one-dimensional eigenspace of An to µ is

= √2

(13)

Here we have used the beautiful identity
1 + √2n + 1

pn + 1 + √2n + 1

for all n ∈ N. Now let Sn be the S-shaped polygon with sides si, s′i of lengths hi
as shown in Figure 6 below and let Tn be the translation surface obtained from
Sn by identifying si with s′i by translations. The numbers on the right picture
denote the lenghts of the edges.

The rotation around the centre of this polygon by the angle π induces
an involution τ ∈ Aut(Sn) \ {Id}. Since the genus of Sn/τ is one, we have
dim(Prym(Sn, τ )) = 2. Let ω ∈ Ω(Sn) be the holomorphic form represented
by dz on the charts of the translation atlas. Then clearly ω is a Prym form
of Tn with respect to τ having a single zero, and we want to show that (Tn, ω)
is in ΩW 3
D.

108

s5

s′5

s1

s2

s4

s′4

s3

s′1

s6

s′6

s′2

s′3

γ6

1

µ
n

√2

γ4

1

γ1

γ2

γ3

γ5

√2 µ

n

µ
n

Figure 6: S-shaped surface

Proposition 9.5 (McMullen). For each n ∈ N with 2n + 1 not a square,
let (Tn, ω) be the translation surface constructed above. Then we have

(Tn, ω) ∈ ΩW 3

D

for some non-square discriminant D > 0 and Prym(Tn, τ ) is of type (1, 2).

Proof. First we verify that the Prym surface (Tn, τ ) satisﬁes the conditions in
Theorem 9.4. Consider the natural foliation of the polygon Sn into the three
horizontal cylinders C1, C2, C3, where Ci is the cylinder with the sides si and s′i
identiﬁed. Let τi be the standard Dehn twist of Ci along the cylinder midth,
i.e. the aﬃne automorphisms with derivatives given by

0

Dτ1 =(cid:18)1
Dτ2 =(cid:18)1
Dτ3 =(cid:18)1

0

0

and

Therefore, the composition

h5+h6

0

h1

1 (cid:19) =(cid:18)1 µ
1(cid:19) ,
1(cid:19) =(cid:18)1 µ/n
1 (cid:19)
1 (cid:19) =(cid:18)1 µ
1(cid:19) .

h3

0

0

h5
h2

h4+h5

2 ◦ τ3
is an aﬃne automorphism of Sn with derivative

τh := τ1 ◦ τ n
Ah := Dτh =(cid:18)1 µ
1(cid:19) .

0

Moreover, there is also a natural foliation of this polygon into three vertical
cylinders C4, C5, C6. We can deﬁne the standard Dehn twists τi for these vertical
cylinders in an analogous way and obtain the derivatives

Dτ4 =(cid:18) 1

−µ/n 1(cid:19) , Dτ5 =(cid:18) 1

−µ 1(cid:19) and Dτ6 =(cid:18) 1

−µ/n 1(cid:19) .

0

0

0

109

Therefore, the composition

τv := τ n

4 ◦ τ5 ◦ τ n
is an aﬃne automorphism of Sn with derivative
Av := Dτv =(cid:18) 1
−µ 1(cid:19) .

0

6

From now on we will use that n ∈ N with 2n + 1 is not a square. We compute
that

tr(Ak

v) = 2 − klµ2 = 2 − kl(n + 1 + √2n + 1)
hAl

for all k, l ∈ Z. By choosing k and l suﬃciently large, we deduce that SL(Tn, ω)
contains inﬁnitely many hyperbolic elements. Thus, by Theorem 9.4 we get
that Prym(Tn, τ ) has real multiplication by OD for some discriminant D with
Q(√D) = Q(√2n + 1) and that ω is a Prym eigenform.
A Z-basis of H1(Tn, Z) is given by the homology classes of the simple closed

curves γi given by the cylinder midths as in Figure 6. We have

and

H1(Tn; Z)+ = hγ1 − γ3, γ4 − γ6iZ

H1(Tn; Z)− = hγ2, γ5, γ1 + γ3, γ4 + γ6iZ.

It follows that the induced polarization on Prym(Tn, τ ) is of type (1, 2).

As McMullen didn’t determine the discriminant of the order OD, we will do

this here.
Proposition 9.6. For each n ∈ N with 2n + 1 not a square, let (Tn, ω) ∈ ΩE 3
be the translation surface constructed above. Then we have D = 4(2n + 1).

D

Proof. We use the same notations as in the previous proof. Since

K = Q(√D) = Q(√2n + 1),

we deduce that D = q2(2n + 1) for some q ∈ Q+. We already know that K acts
on H1(Tn; Q)− by Q-linear maps, and the order OD ⊂ K is just the coeﬃcient
ring of H1(Tn; Z)− ⊂ H1(Tn; Q)−. The order OD = h1, γDiZ acts on H1(Tn; Z)−
if and only if γD preserves H1(Tn; Z)−. So our aim is to choose a suitable Z-
basis for H1(Tn; Z) and to verify for which choices of q the matrix of γD with
respect to this basis has integral entries. A symplectic basis of H1(Tn; Z)− is
given by

(λ1, λ2, λ3, λ4) = (γ5 − γ4 − γ6, γ4 + γ6, γ2, γ1 + γ3).

Let A = (aij)i,j ∈ GL4(Q) be the matrix of γD with respect to this basis, so

γD.λj =

aij λi.

4Xi=1

The form ω is a ι-eigenform for one of the two embeddings K ֒→ R and hence

ι(γD)Zλj

aijZλi

ω =

4Xi=1

110

ω.

(14)

Since ω = dz on the charts of the translation atlas, the integrals over the λi
are given by the complex lengths of the cylindermidths deﬁning the curves γi.
More concretely, we have

ω = √2i,

Zλ1

ω = 2(µ/n)i,

Zλ2
ω = √2µ/n,
2 (D ± √D), multiplying with n/µ = 1

Zλ4
√2(√2n + 1 − 1) and
√2(√2n + 1 + 1) and D = q2(2n + 1), the four

ω = 2µ2/n.

Zλ3

2

Writing ι(γD) = 1
using the identities µ = 1
2
equations in (14) become

q2(2n+1)±q√2n+1

+a31√2 + a41√2(√2n + 1 + 1)

2

(√2n + 1 − 1)i = a11(√2n + 1 − 1)i + a212i
(q2(2n + 1) ± q√2n + 1)i = a12(√2n + 1 − 1)i + a222i
√2 = a13(√2n + 1 − 1)i + a232i
√2(√2n + 1 + 1) = a14(√2n + 1 − 1)i + a242i

q2(2n+1)±q√2n+1

2

+a32√2 + a42√2(√2n + 1 + 1)

+a33√2 + a43√2(√2n + 1 + 1)

+a34√2 + a44√2(√2n + 1 + 1)

q2(2n+1)±q√2n+1

2

We assumed that 2n+1 is not a square, hence √2 and √2√2n + 1 are Q-linearly
independent. By equating the coeﬃcients, we obtain

A =

1

2 (D ∓ q)
± 1
2 qn
0
0

1

2 (D ± q)

±q
0
0

0
0

1

2 (D ∓ q)
± 1
2 q

0
0
±qn

1

2 (D ± q)



All the entries of A are integers if and only if q is in 2Z, and therfore it fol-
lows D = 4(2n + 1).

Crosscheck for admissibility. We denote by ΓTn ⊂ ΩM3 the orbit
of (Tn, ω) under Γ = SL2(R), and by PΓTn ⊂ PΩM3 its image under the
natural projection. By Theorem 9.3, we have ΓTn ⊂ ΩE 3
D.
It follows by Theorem 8.12, that any geometric genus zero curve in the clo-
sure of PΓTn in PΩM3 lies in the image pι(S) of some admissible I-weighted
boundary stratum under the ι-pseudo-embedding. To obtain such a stable curve,
notice that for any r ∈ R+, the diagonal matrix diag(r−1/2, r1/2) is in Γ, and the
two translation surfaces Tn,r := diag(1, r).(Tn, ω) and diag(r−1/2, r1/2).(Tn, ω)
deﬁne the same points in PΩM3. The surface Tn,r is obtained by Tn by re-
maining the horizontal lengths constant and by stretching the vertical length
by the factor r. As r tends to inﬁnity, topologically the curves γ1, γ2, γ3 deﬁned
by the horizontal cylinder midths are pinched to zero. We see by Figure 6, that
the resulting stable curve is irreduzible of geometric genus zero. During this
process, the periods ∫γi ω for i ∈ {1, 2, 3} remain constant. Thus Tn,r converges
to an irreducible stable form (T, ω) ∈ PΩM3 with three nodes n1, n2, n3. Up to
a common scalar multiple, each residuum ˜ri at one of the cusps ci of ni is given
by

˜r1 = ˜r3 = 1

2 (1 + √2n + 1)

and ˜r2 = 1.

111

By Corollary 8.13, there is some admissible I-weighted boundary stratum
S ⊂ M3(I) with (T, ω) ∈ πι(S). But with the aim of doing a crosscheck, we
can verify this also directly. Choose

r1 := ( 1

2 (1 ± √2n + 1), 1),

r2 := (1, 0),

r3 := ( 1

2 (1 ± √2n + 1),−1)

in F = K ⊕ Q and let I := hr1, r2, r3iZ. Moreover, let ̺ be the I-weighting
of T with weight ri at each cusp ci and let S be the corresponding I-weighted
boundary stratum. Then we have πι(T, ̺) = (T, ω) and compute

Q(r1) =

2n(2n + 1)

±2(2n + 1) , Q(r2) =

1

−4(2n + 1)

0
0

 , Q(r3) =

2n(2n + 1)

∓2(2n + 1) .

−1

In each of the two possibilities for ι we see that

0 = Q(r1) + nQ(r2) + Q(r3)

is in the interior of the convex hull of the Q(ri), and thus S is admissible.
Cross-ratio equations. Now want to determine the cross ratio equations from
Theorem 8.18. The dual basis of (r1, r2, r3) is (s1, s2, s3) with

By computing the products sisj for si 6= sj, Equation (11) becomes

s1 = 1

√2n+1

s2 = 1

2n+1 , 1(cid:17) ,

2(cid:16)1 ∓
2(cid:16)±
D (±√2n + 1 − 1), 0(cid:1) + a2(cid:0) 1
a1(cid:0) 1

√2n+1

√2n+1

s3 = 1

2n+1 , 0(cid:17) ,
4(cid:1) + a3(cid:0) 1

2(cid:16)±

2n+1 ,−1(cid:17) .
D (±√2n + 1 − 1), 0(cid:1) = 0,

which is equivalent to a1 + a3 = a2 = 0. Therefore, for any given

D ,− 1

h =

3Xi,j=1

bij(ri ⊗ rj) ∈ SymQ(F )/(Λ1 + SymZ(I)),

the subvariety Sr(h) ⊂ Sr = M0,6 is cut out by the single equation

p12/p23 = exp(−2πi(b12 − b23)).

Note that on the right side of this equation, all roots of unity exp(πiq), q ∈ Q
appear, as h runs through SymQ(F )/(Λ1 + SymZ(I)).

112

10 References

[ANW13] D. Aulicino, D.-M. Nguyen, and A. Wright. Classiﬁcation of higher

rank orbit closures in Hodd(4). ArXiv e-prints, August 2013.

[Bas62] Hyman Bass. Torsion free and projective modules. Trans. Amer.

Math. Soc., 102:319–327, 1962.

[BHM14] M. Bainbridge, P. Habegger, and M. Moeller. Teichmueller curves in
a . ArXiv e-prints,

genus three and just likely intersections in Gn
October 2014.

m×Gn

[BL04] Christina Birkenhake and Herbert Lange. Complex abelian varieties,
volume 302 of Grundlehren der Mathematischen Wissenschaften
[Fundamental Principles of Mathematical Sciences]. Springer-Verlag,
Berlin, second edition, 2004.

[BM12] Matt Bainbridge and Martin M¨oller. The Deligne-Mumford com-
pactiﬁcation of the real multiplication locus and Teichm¨uller curves
in genus 3. Acta Math., 208(1):1–92, 2012.

[Cal04] Kariane Calta. Veech surfaces and complete periodicity in genus two.

J. Amer. Math. Soc., 17(4):871–908, 2004.

[Coh93] Henri Cohen. A course in computational algebraic number theory,
volume 138 of Graduate Texts in Mathematics. Springer-Verlag,
Berlin, 1993.

[Cox89] David A. Cox. Primes of the form x2 + ny2. A Wiley-Interscience
Publication. John Wiley & Sons, Inc., New York, 1989. Fermat, class
ﬁeld theory and complex multiplication.

[HK13] Franz Halter-Koch. Quadratic irrationals. Pure and Applied Math-
ematics (Boca Raton). CRC Press, Boca Raton, FL, 2013. An in-
troduction to classical number theory.

[HK14] John H. Hubbard and Sarah Koch. An analytic construction of the
Deligne-Mumford compactiﬁcation of the moduli space of curves. J.
Diﬀerential Geom., 98(2):261–313, 2014.

[Kra81] Irwin Kra. The Carath´eodory metric on abelian Teichm¨uller disks.

J. Analyse Math., 40:129–143 (1982), 1981.

[LN14a] E. Lanneau and D.-M. Nguyen. Connected components of Prym

eigenform loci in genus three. ArXiv e-prints, August 2014.

[LN14b] Erwan Lanneau and Duc-Manh Nguyen. Teichm¨uller curves gener-
ated by Weierstrass Prym eigenforms in genus 3 and genus 4. J.
Topol., 7(2):475–522, 2014.

[McM03] Curtis T. McMullen. Billiards and Teichm¨uller curves on Hilbert
modular surfaces. J. Amer. Math. Soc., 16(4):857–885 (electronic),
2003.

113

[McM05a] Curtis T. McMullen. Teichm¨uller curves in genus two: discriminant

and spin. Math. Ann., 333(1):87–130, 2005.

[McM05b] Curtis T. McMullen. Teichm¨uller curves in genus two: the decagon

and beyond. J. Reine Angew. Math., 582:173–199, 2005.

[McM06a] Curtis T. McMullen. Prym varieties and Teichm¨uller curves. Duke

Math. J., 133(3):569–590, 2006.

[McM06b] Curtis T. McMullen. Teichm¨uller curves in genus two: torsion divi-

sors and ratios of sines. Invent. Math., 165(3):651–672, 2006.

[McM07] Curtis T. McMullen. Dynamics of SL2(R) over moduli space in genus

two. Ann. of Math. (2), 165(2):397–456, 2007.

[M¨ol06a] Martin M¨oller. Periodic points on Veech surfaces and the Mordell-
Weil group over a Teichm¨uller curve. Invent. Math., 165(3):633–649,
2006.

[M¨ol06b] Martin M¨oller. Variations of Hodge structures of a Teichm¨uller curve.

J. Amer. Math. Soc., 19(2):327–344, 2006.

[Nam76] Yukihiko Namikawa. A new compactiﬁcation of the Siegel space and
degeneration of Abelian varieties. II. Math. Ann., 221(3):201–241,
1976.

[NW14] Duc-Manh Nguyen and Alex Wright. Non-Veech surfaces in Hhyp(4)

are generic. Geom. Funct. Anal., 24(4):1316–1335, 2014.

[Rib69] Paulo Ribenboim. Rings and modules. Interscience Tracts in Pure
and Applied Mathematics, No. 24. Interscience Publishers John Wi-
ley & Sons, Inc., New York-London-Sydney, 1969.

[Sch07] Alexander Schmidt. Einf¨uhrung in die algebraische Zahlentheorie.

Springer, Berlin, 2007.

[Thu88] William P. Thurston. On the geometry and dynamics of diﬀeomor-
phisms of surfaces. Bull. Amer. Math. Soc. (N.S.), 19(2):417–431,
1988.

[vdG88] Gerard van der Geer. Hilbert modular surfaces, volume 16 of Ergeb-
nisse der Mathematik und ihrer Grenzgebiete (3) [Results in Mathe-
matics and Related Areas (3)]. Springer-Verlag, Berlin, 1988.

[Vee89] W. A. Veech. Teichm¨uller curves in moduli space, Eisenstein series
and an application to triangular billiards. Invent. Math., 97(3):553–
583, 1989.

[Wei94] Charles A. Weibel. An introduction to homological algebra, volume 38
of Cambridge Studies in Advanced Mathematics. Cambridge Univer-
sity Press, Cambridge, 1994.

[Xia85] Gang Xiao. Surfaces ﬁbr´ees en courbes de genre deux, volume 1137

of Lecture Notes in Mathematics. Springer-Verlag, Berlin, 1985.

114

