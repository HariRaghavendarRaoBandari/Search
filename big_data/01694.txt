6
1
0
2

 
r
a

M
5

 

 
 
]
T
I
.
s
c
[
 
 

1
v
4
9
6
1
0

.

3
0
6
1
:
v
i
X
r
a

1

Intracell Interference Characterization and
Cluster Inference for D2D Communication

Haﬁz Attaul Mustafa1, Muhammad Zeeshan Shakir2, Ali Riza Ekti3,

Muhammad Ali Imran1, and Rahim Tafazolli1

1Institute for Communication Systems, University of Surrey, Guildford, UK.

{h.mustafa, m.imran, r.tafazolli}@surrey.ac.uk

2Dept. of Systems and Computer Engineering, Carleton University, Ottawa, Canada.

muhammad.shakir@sce.carleton.ca

3Dept. of Electrical and Computer Engineering, Gannon University, Erie, PA, U.S.A.

alirizaekti@gmail.com

Abstract—The homogeneous poisson point process (PPP) is
widely used to model temporal, spatial or both topologies of base
stations (BSs) and mobile terminals (MTs). However, negative
spatial correlation in BSs, due to strategical deployments, and
positive spatial correlations in MTs, due to homophilic relations,
cannot be captured by homogeneous spatial PPP (SPPP). In
this paper, we assume doubly stochastic poisson process, a
generalization of homogeneous PPP, with intensity measure as
another stochastic process. To this end, we assume Permanental
Cox Process (PCP) to capture positive spatial correlation in
MTs. We consider product density to derive closed-form ap-
proximation (CFA) of spatial summary statistics. We propose
Euler Characteristic (EC) based novel approach to approximate
intractable random intensity measure and subsequently derive
nearest neighbor distribution function. We further propose the
threshold and spatial extent of excursion set of chi-square random
ﬁeld as interference control parameters to select different cluster
sizes for device-to-device (D2D) communication. The spatial
extent of clusters is controlled by nearest neighbor distribution
function which is incorporated into Laplace functional of SPPP to
analyze the effect of D2D interfering clusters on average coverage
probability of cellular user. The CFA and empirical results are
in good agreement and its comparison with SPPP clearly shows
spatial correlation between D2D nodes.

Index Terms—Intracell interference, D2D communication, Spa-
tial correlation, Permanental Cox process, Random ﬁeld, Euler
Characteristic, Nearest neighbor distribution function.

I. INTRODUCTION

T HE homogeneous poisson point process (PPP) is char-

acterized with remarkable property of complete spatial
randomness. This property is useful when underlying points
are completely uncorrelated with each other and, subsequently,
distributed homogeneously. For example, call arrival in cellular
networks can precisely be modeled by temporal PPP if we
ignore trafﬁc inhomogeneity during day and night
times.
The spatial version of PPP (SPPP) is extensively used to
model position of base stations (BSs) and mobile terminals
(MTs) [1–3]. However, neither BSs/MTs are uncorrelated nor
distributed homogeneously. Moreover, due to spatial variations
in trafﬁc, the intensity measure of the point process cannot be
considered constant. The inhomogeneity and spatial correla-

tion is usually governed by several dominant factors such as
strategical deployments of BSs, homophilic relations between
MTs, emergence of mobile social networks, and existence of
hot-spots. As a result, homogeneous PPP is too conservative
to model temporal/spatial topologies of network entities. Such
point process cannot precisely model cellular networks since
it cannot capture negative correlation, in case of BSs, and pos-
itive correlation, in case of MTs. The relevant processes that
capture negative and positive spatial correlations are fermion
and boson [4]. These processes can, respectively, be modeled
by Determinantal Point Process (DPP) and Permanental Cox
Process (PCP) [5]. The PCP is a doubly stochastic Poisson
process with intensity measure governed by chi-square random
ﬁeld (χ2

k-RF) with k degrees of freedom (df).

A. Related Work

The negative correlation between BSs are modeled using
DPP and Ginibre point process [6–8]. However, to the best
knowledge of authors, the spatial modeling of MTs is restricted
to homogeneous SPPP in the literature. This paper is the ﬁrst
attempt to model inhomogeneous distribution of MTs with
spatial correlation that exists due to any homophilic relation.
In this paper, we extend our SPPP approach [9, 10] to PCP
model with random intensity measure and inhomogeneous dis-
tribution to characterize interference in underlay D2D network.
To validate simulated realizations, we used nth-order product
density of PCP to derive Ripley’s K and variance stabilized
L functions. These functions are compared with benchmark
SPPP process to see the deviations. The more upper deviations
mean high positive correlation between points of the process.
The K and L functions of various point processes are available
[7, 11], however no analytic expressions for PCP exist in
the literature. The random intensity measure of PCP is ap-
proximated by topological inference based on expected Euler
Characteristic (EC) [12]. This approximation is used to derive
nearest neighbor distribution function which is introduced into
Laplace functional of SPPP to capture interference due to D2D
pairs. We propose u and r as interference control parameters
to analyze and ensure coverage probability of cellular user.

B. Contributions

we can deﬁne χ2

k-RF as [16]:

2

(3)

g(t) =

k

Xm=1

f 2
m(t).

1) Using nth-order product density of PCP, we derive K

and L functions for exponential covariance function.

2) We propose expected EC based novel approach to ap-
proximate random intensity measure of PCP which is
governed by χ2

k-RF with k df.

3) Inspired by statistical parameter mapping (SPM) and
random ﬁeld theory (RFT) approaches towards func-
tional analysis of brain imaging [13]1, we adopted RFT
approach to derive closed-form approximation (CFA) for
intractable nearest neighbor distribution function G.

4) We introduce G function into Laplace functional of
SPPP to capture interference and subsequently derive
CFA for average coverage probability of cellular user in
D2D underlay network.

5) We propose u and r as interference control parameters to
characterize intracell interference and analyze coverage
probability of cellular user in underlay D2D network.

C. Mathematical Preliminaries

1) Permanental Cox Process: We deﬁne spatial point pro-
cess Φ in terms of nth-order product density ̺(n). The Φ
is a random subset X of underlying locally compact topo-
logical/parameter space S, a subspace of stratiﬁed manifold
M ⊂ Rk. The Φ is said to be PCP process if X is poisson
process with random intensity measure deﬁned as [14]:

Λ(B) a.s.= ZB

λ(s)ds,

=ZB(cid:2)Y 2
=ZB

χ2

1 (s) + ··· + Y 2
kds,

k (s)(cid:3)ds,

(1)

where B ⊆ S is a Borel set, λ(s) is random intensity
function and Y(·)(s) are k independent Gaussian Random
Fields (GRFs).

2) Random Field (RF): An RF f = f (t) on M can be
deﬁned as a function whose values are random variables (RVs)
for any t ∈ M [15]. This function is fully characterized by its
ﬁnite-dimensional distributions (ﬁdi) i.e.,

Ft1,...tk (x1, ..., xk) =p(cid:0)f (t1) ≤ x1, ..., f (tk) ≤ xk(cid:1).

In case, (2) is multivariate Gaussian, f is known as GRF.
In real world, not all RFs are Gaussian. Non-Gaussian ﬁelds
form very broader class and are not well deﬁned. Here,
we will consider RFs of the form g(t) = G(fm(t)) =
G(f1(t), ..., fk(t)) as non-Gaussian or Gaussian related RFs.
In case f1(t), ..., fk(t) are zero mean and unit variance GRFs,

(2)

1In standard functional analysis of brain and neuroimaging, two approaches
are followed to identify activation regions against the null hypothesis (e.g.,
z-test, χ2-test, t-test, F-test), (i) Bonferroni correction, (ii) Random Field
Theory. The functional analysis of brain comprises large number of voxels
i.e., large number of statistic values. In case, the statistic values are completely
independent,
to identify activation regions.
However, in multiple comparison problem, spatial correlation always exist
and hence later approach provides less conservative analysis and accurate
identiﬁcation of activation regions.

the former approach is best

The marginal distribution of (3) for each t ∈ M is χ2 with k
degrees of freedom.
3) Excursion Set: The excursion set, Au above level u ∈ R,

of k-dimensional RF on M is given as [17, 18]:

Au(f, M ) , [t ∈ M : f (t) ≥ u] ≡ f −1([u, +∞)).

(4)

The excursion set of a real-valued non-Gaussian RF can be
deﬁned by applying function composition g = (G ◦ f ) on
is equivalent to the excursion set of vector-
M . This set
valued Gaussian f in G−1[u, +∞), which, under appropriate
assumptions on G,
is a manifold with piece-wise smooth
boundary given by [12]:

Au(cid:0)g, M(cid:1) =Au(cid:0)(G ◦ f ), M(cid:1),

={t ∈ M : (G ◦ f )(t) ≥ u},
={t ∈ M : f (t) ∈ G−1[u, +∞)},
=M ∩ f −1(G−1[u, +∞)).

(5)
Since, G−1[u, +∞) is a speciﬁc stratiﬁed manifold in Rk, we
can generalize it to D ⊂ Rk in (5)

Au(g, M ) =M ∩ f −1(D).

(6)

4) Lipschitz-Killing Curvature Measures: The Euler Char-
acteristic X is a fundamental additive functional that counts
topological components of M . In order to consider boundaries,
curvatures, surface area, and volume of M , the position and
rotation-invariant generalized functionals are considered which
are known as Lipschitz-killing curvature measures. They are
also known as geometric identiﬁers that capture intrinsic
volume of M . For example, in case of M ⊂ R2, L0 ≡ X ,
L1, L2 gives EC, boundary length, and area of manifold
R , N -
M . The Lipschitz-killing curvature measures Lj, on BN
dimensional ball of radius R, is given as [12, Section 6.3]:

R ) = (cid:18)N

j (cid:19) Rj wN

wN −j

Lj(BN

,

(7)

where j has dimension M (i.e., j = |M|) and ωn is the volume
of the unit ball in Rn.

D. Organization

The rest of the paper is organized as follows: In Section II,
we present system model of cellular network with underlay
D2D communication. This is followed by PCP model, for
spatial distribution of potential D2D nodes, and details to
generate such a process. To validate the simulated realizations
of PCP, we also derive CFA of K and L functions in
this section. In Section III, we present the main result of
approximating G function of PCP. The CFA of G function is
derived based on expected EC of excursion set of χ2
k-RF. The
CFA and empirical G function are compared with SPPP. In
Section IV, we introduce G function into Laplace functional
of SPPP to derive CFA for average coverage probability of
cellular user. Conclusion is drawn in Section V.

II. SYSTEM MODEL

In this section, we present cellular network model, PCP
model, process generation, and validation using K and L
functions.

A. Cellular Network Model

The cellular network comprises small cell BS (SBS) and
MTs as shown in Fig. 1. We consider orthogonal frequency
division multiple access (OFDMA) based cellular network. In
this network, we want to analyze maximum frequency reuse
and the effect of interference due to D2D communication. In
order to avoid coverage holes, SBS should provide homoge-
neous coverage for the cellular user. For the homogeneous
coverage at each position in the coverage area, we consider
one MT as cellular user which is distributed uniformly. All
other MTs are potential D2D users distributed according to
PCP process.

The uplink resources of cellular user are shared by potential
D2D users. The time division duplex (TDD) mode is assumed
between D2D nodes to capture the effect of interference by
both nodes. In case of frequency division duplex (FDD) mode,
the interference at any time instant will simply be half that of
TDD mode. The data and signaling is provided by the serving
SBS to the cellular user whereas only signaling is assumed
for potential D2D nodes. For average coverage probability of
cellular user, interference is generated by all successful D2D
pairs. We consider negligible interference at serving SBS from
successful D2D nodes in neighboring SBSs due to negligibly
small transmit power.

The cellular and potential D2D users are distributed in
the coverage area bounded between SBS radius R and the
protection region R0. The distance between SBS and cellular
user is rc which is used to calculate path-loss at SBS. Every
successful D2D pair has a distance of r between nodes.
The channel model assumes distance dependent path-loss
and Rayleigh fading. The simple singular path-loss model
−α) is assumed where the protection region R0 ensures
(rc
the convergence of the model by avoiding nodes to lie at
the origin. The received power at SBS follows exponential
distribution. The distance rc follows uniform distribution [9]:

3

Data Service
Signaling
D2D Link
Interference

r

D2D Interferer

R

Cluster 1

o

R

SBS

r

c

r

Cluster n

Cellular User

Fig. 1: System model for PCP deployed MTs.

The sum of independent chi-square distributions has remark-

able property given by the following theorem [20]:

Theorem 1. The sum of k independent chi-square distribu-
i=1 vi

tions with vi df follows a chi-square distribution with Pk

df i.e.,

Z =χ2

v1(si) + ... + χ2
∼ χ2
v1+...+vk (si).

vk (si),

(11)

Each squared GRF in (10) has unit df (vi = 1); this results
k(si). Therefore, the intensity measure of PCP
in Y 2
(·)(si) ∼ χ2
is governed by χ2

k-RF with k df as:

Λ(si) =χ2

k(si).

(12)

Since the distribution of potential D2D nodes is translation and
motion invariant, we can assume stationary PCP and hence
borrow the deﬁnition from [14]:

Deﬁnition 1. A Permanental Cox Process is stationary if and
only if the underlying GRF is stationary.

The stationarity of GRF is ensured by underlying covariance
function. In order to generate smooth GRFs, we consider
squared exponential covariance function [21]

f (rc) =

2rc
R2 , f (θ) =
where R0 ≤ rc ≤ R and 0 ≤ θ ≤ 2π.
B. PCP Model

1
2π

,

(8)

C(s1, s2) = e− ||s||2
2l2 ,

(13)

where ||s|| = ||s1 − s2|| = p(s1x − s2x)2 + (s1y − s2y )2

is the Euclidean distance between s1 and s2, and l is the
characteristic length-scale. The resulting covariance matrix of
PCP is represented by [C](s1, ..., sn).

The fact that PCP is a type of Permanental point process is

(9)

due to the following theorem [19]:

The nth-order product density ̺(n) of a Cox process is [19]:

̺(n)(s1, ..., sn) = E

n

Yi=1

Λ(si),

where Λ(·) is a random intensity measure. In order to model
spatially correlated process for potential D2D nodes, we
consider PCP with the following intensity measure:

Λ(si) = Y 2

(10)
where Y(·)(·) are zero mean unit variance k independent real-
valued stationary GRFs and Y 2

1 (si) + ··· + Y 2

k (si),

(·)(·) ∼ χ2(·) with unit df.

Theorem 2. The nth-order product density of Cox process is
equal to the weighted permanent of the covariance matrix i.e.,

̺(n)(s1, ..., sn) = perα[C](s1, ..., sn).

(14)

Proof: See, [19, Sec. 2.1.1, p. 876, Theorem 1].

The boson (or photon) process corresponds to α = 1 [22]

resulting in k = 2α df for underlying GRFs of PCP.

4

(a) Intensity function of PCP resembles bell-like blobs of GRF.

(b) Sampled realization of PCP shows high and low intensity regions.

Fig. 2: Random intensity function of PCP process and sampled histogram.

C. Process Generation

D. Summary Statistics: K and L Functions

The random intensity measure of PCP is governed by χ2
k-
RF which is non-Gaussian or Gaussian related RF. This ﬁeld
is generated by squaring the component ﬁeld which is GRF
(as discussed in Section II-B). The GRF is a collection of
RVs with ﬁdi as multivariate Gaussian. Therefore, it can be
generated by drawing real valued multivariate normal random
vectors and mapping it to the underlying grid. It can also be
generated via circulant embedding method [23]. We followed
the former approach to generate RFs and subsequently PCP
k-RF of PCP comprises large number of χ2 RVs
process. The χ2
which are mapped to each grid point s ∈ S. Due to smooth
underlying covariance structure, each RV results into smooth
sample path. The blobs and holes show spatial covariance
between χ2 RVs. The overall shape of intensity measure of
PCP is similar to symmetric bell-like blobs of GRF, however,
the loss of symmetry in this case is due to low df of χ2
k-RF. For
large df, due to central limit theorem, the intensity measure of
PCP resembles symmetric bell-like blobs of GRF.

The lattice representation of χ2

k-RF with 2 df is shown in
Fig. 2(a). In this ﬁgure, we can see number of blobs and holes
which, respectively, show high and low intensity areas. The
high intensity areas (7 → 10 on colorbar) capture strong spatial
correlation between points and results in group clustering
whereas low intensity areas (1 → 3 on colorbar) form holes
due to nonexistence of any homophilic relation. The Markov
chain Monte Carlo based Metropolis-Hasting (MH) sampler2
is used to sample PCP points under χ2
k-RF as shown in Fig.
2(b) which shows inhomogeneous and clustered distribution
of points.

2The MH sampler is used to sample RVs from multidimensional spaces.
The states of the underlying Markov chain can be updated in two different
ways, (i) Block-wise, (ii) Component-wise. The ﬁrst approach updates all
state variables simultaneously whereas the second approach iterates with
component-wise update. In both the cases,
the acceptance probability is

α = min(cid:18)1,

p(θθθ∗)

p(θθθ(t−1) )

q(θθθ(t−1) |θθθ∗)

q(θθθ∗|θθθ(t−1) )(cid:19), where p(θθθ) and q(θθθ) stand for

proposal and target distributions, respectively [24].

The Ripley’s K function and variance stabilized L functions

are, respectively, given as [25]:

g(s)2πsds,

K(r) =Z r
L(r) =r K(r)

0

π

,

(15)

(16)

where r is the distance and g(s) is the pair correlation function.
Using (14), the ﬁrst and second order product densities can

be derived as [26]:

̺ = αC(0),

̺(2)(s) = α(cid:2)1 + C2(s)(cid:3).

(17)

Since g(s) = ̺(2)(s)/̺2, the pair correlation function of PCP
for α = 1 is given by:

g(s) =1 + C2(s).

(18)

The corresponding K and L functions can be derived as:

l )2
K(r) =πr2 + πl2(1 − e−( r
L(r) =qr2 + l2(1 − e−( r

l )2 ).

),

The SPPP is a special case of PCP with g(s) = 1,
K(r) = πr2, and L(r) = r. If we assume complete spatial
independence, the covariance between s1 and s2 vanishes and
product densities from (17) reduces to:

̺ = α,

̺(2)(s) = α(cid:2)1 + 0(cid:3).

The corresponding pair correlation function (for k = 2 i.e.,
α = 1) is 1. The K and L functions for SPPP can be validated
as K(r) = πr2 and L(r) = r, respectively.

The estimated ˆK function for SPPP and PCP is, respec-

tively, given as [27]:

ˆKSP P P (r) =

1
λn

n

Xi=1

n

Xj=1,i6=j

I(si, sj, r),

2500

2000

)
r
(

K

1500

1000

500

0
 
0

SPPP: πr2
SPPP: Empirical
PCP: πr2 + πl2(1 − e−( r
PCP: Empirical

l )2 )

 

5

10
r

15

20

30

25

20

)
r
(
L

15

10

5

0
 
0

5

 

SPPP: r
SPPP: Empirical
PCP:qr2 + l2(1 − e−( r
PCP: Empirical

l )2 )

2

4

6

8

10
r

12

14

16

18

20

Fig. 3: CFA and empirical approximations for K function of SPPP and PCP.

Fig. 4: CFA and empirical approximations for L function of SPPP and PCP.

ˆKP CP (r) =

1
n

n

Xi=1

n

Xj=1,i6=j

I(si, sj, r)
λ(si)λ(sj )

,

where λ is the constant intensity function of SPPP, λ(·) is the
random intensity function of PCP and I(·) is the indicator
function for the distance r between points si and sj. The
analytic expression of K and L functions and empirical
estimates are shown in Fig. 3 and Fig. 4, respectively. As
an illustration, the plot is shown for the value of l = 50. This
parameter captures the length-scale of the underlying sample
path. In modeling problem, it can be used to incorporate the
level of covariance in points of the process. We can see that
the estimates of K and L functions matches CFA. In these
ﬁgures, SPPP serves as a benchmark with zero correlation
between points. The positive spatial correlation of PCP can
be veriﬁed by upper drift of K and L functions. In case of
negative spatial correlation, the K and L functions shall lie
below SPPP curves as can be seen in [6–8].

III. NEAREST NEIGHBOR DISTRIBUTION FUNCTION
In this section, we approximate G function using topolog-
ical inference based on expected EC and Poisson clumping
heuristic [28].

A. Nearest Neighbor Distribution Function

The nearest neighbor distribution function of a point process

is given as:

G(r) =1 − E(cid:2)e−Λ(BN
r )(cid:3),
λ(s)ds(cid:21),

=1 − E(cid:20)e

− RBN

r

(19)

where Λ and λ are, respectively, intensity measure and func-
tion of point process over closed ball of radius r at arbitrary
position.

In case of SPPP, λ is constant and hence (19) can be

simpliﬁed as:

Considering Λ from (12), the nearest neighbor distribution

function of PCP is given as:

G(r) =1 − E(cid:20)e− RBN
=1 − E(cid:20)e− RBN

r

χ2

k ds(cid:21),

r Rv1

··· Rvn

χ2dv1···dvn ds(cid:21).

(21)

k-RF is a collection of large number of RVs, this
Since χ2
r which
results in evaluation of nested integrals over BN
is mathematically intractable. In this case, we approximate
intensity measure Λ using expected EC of excursion set of
k-RF [12].
χ2
1) Approximation of Intensity Measure: The expected in-
tensity measure in (21) can be estimated by making topological
inference of average number of upcrossings of χ2
k-RF above
level u of excursion set. This approach is based on Gaussian
Kinematic Formulae (GKF) given as [12, Theorem 15.9.4]:

Theorem 3. Let M be an N -dimensional, regular stratiﬁed
manifold, D a regular stratiﬁed subset of Rk. Let f =
(f1, ..., fk) : M → Rk be a vector-valued Gaussian ﬁeld, with
independent, identically distributed components and f being
Morse function3 over M with probability one. Then

E(cid:2)Li(M ∩ f −1(D))(cid:3) =

N −i

Xj=0

(cid:20)i + j
j (cid:21) Li+j (M )Mj(D)

j
2

(2π)

,

(22)
where Li+j for i = 0, ..., N, j = 0, ..., N − i, are Lipschitz-
Killing curvature measures on M with respect to the metric in-
duced by f and Mj are the generalized (Gaussian) Minkowski
functionals on Rk.

For notational convenience, we assume the combinatorial

G(r) =1 − e−λπr2

.

(20)

3For the deﬁnition of Morse function and Morse’s Theorem, refer [29,

Theorem 4.4.1, pp. 87] and [24, Section 9.3, Deﬁnition 9.3.1, pp. 206].

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

y
t
i
s
n
e
D
C
E

ρ0(u)
ρ1(u)
ρ2(u)

 

x 104

3

s
g
n

i
s
s
o
r
c
p
U
e
g
a
r
e
v
A

2.5

2

1.5

1

0.5

6

 

E{L0(Au(χ2
E{L1(Au(χ2
E{L2(Au(χ2

k, S))}
k, S))}
k, S))}

0
 
0

5

10

15
u

20

25

30

0
 
0

5

10

15
u

20

25

30

Fig. 5: EC density representing density of unit component of χ2
survives threshold u.

k-RF that

Fig. 6: Average number of components of χ2
killing curvature measures over 200 × 200 square grid.

k-RF for different Lipschitz-

ﬂag coefﬁcients (cid:20)i + j

j (cid:21) = (cid:20)a

b(cid:21) given as:

[a]!

(cid:20)a
b(cid:21) =
Using Theorem 3 and putting M ∩ f −1(D) from (6), the
expected intensity measure can be approximated as follows:

π
Γ( a
2 + 1)

[a]! = a!ωa, ωa =

[b]![a − b]!

a
2

,

.

k(BN

r )(cid:3),
ψ0 ≈E(cid:2)χ2
=E(cid:2)L0(cid:0)Au(χ2
r )(cid:1)(cid:3),
k, BN
Lj(BN
r )Mj(D)
Xj=0
(2π)

=

N

j
2

.

(23)

where

The Minkowski functionals Mj(D) can be transformed into
EC density for χ2

k-RF as [12]:

ψ0 =

N

Xj=0

ρj(u)Lj (BN
r ),

(24)

where

ρj(u) =

⌊ j−1

2 ⌋

j−1−2l

k−j

j

2

2

u

k−2

(2π)

2 e− u
2 Γ( k
2 )2

Xm=0
k − 1

Xl=0
× 1{k≥j−m−2l}(cid:18)
j − 1 − m − 2l(cid:19)
(−1)j−1+m+l(j − 1)!
×

um+l.

m!l!2l

k-
The EC density over R2 and average upcrossings of χ2
RF are shown in Fig. 5 and Fig. 6, respectively.
In Fig. 5,
a very interesting fact can be observed for ρ0. The value of
j = 0 transforms N dimensional Manifold M to a single point
where spatial correlation does not make sense. In this case, EC
density reduces to χ2 distribution with k df conforming the
k-RF is χ2 distributed [16].
fact that marginal distribution of χ2
In Fig. 6, the behavior of χ2
k-RF for different u is plotted with
respect to different Li measures. In this paper, we consider L0
(i.e., EC) to approximate intensity measure of PCP process.

2) Poisson Clumping Heuristic4: To approximate nearest
neighbor distribution function, we consider probability of
getting one, or more, clusters (D2D pairs) with spatial extent
r, or more, above threshold u. The general expression for this
cluster level inference is given as [13, 31]:
G(r) ≃ 1 − e−ψ0 p(v≥r).

(25)

The volume v of clusters (D2D pairs) over spatial extent r is
distributed according to [32]:

p(v ≥ r) ≈ e(cid:0)−βr

2

N(cid:1),

β = (cid:18) Γ( N

2 + 1)
η

N

(cid:19) 2

,

(26)

and η = ρ0

vLN /ψ0 is the expected volume of each cluster.
The plots of η and p(v ≥ r) are shown in Fig. 7 and Fig.
8, respectively. In these ﬁgures, we can see that the maximum
expected volume and the probability to have nodes with spatial
extent (≥)r occurs for v = 1. In deriving CFA of G function,
we, consider η for v = 1.
Using (7), the Lipschitz-Killing curvature measures Lj over

ball of spatial extent r can be derived as:

L0 = 1,
L1 = 2√πr
L2 = πr2 Γ(1)

Γ(2)

.

Γ( 1

2 + 1)
Γ(2)

,

(27a)

(27b)

(27c)

Considering (27), (24), and (26) in (25) for, at most, distance
r, the G function can be approximated. The plot of G function
can be seen in Fig. 9 where PCP points, due to positive
spatial correlation, have higher probability of D2D pairs as

4At high thresholds, the clusters in the excursion set can be regarded as
multidimensional point process with no memory and hence they behave as
poisson clumps [30].

7

6

5

4

3

2

1

r
e
t
s
u

l
c

h
c
a
e

f
o

e
m
u

l
o
v

d
e
t
c
e
p
x
E

0

0

)
r
≥
v
(
p

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 
0

7

 

r = 1 m
r = 2 m
r = 4 m
r = 8 m

5

10

15

20

25

Cluster Number (v)

5

10

15

20

25

Cluster Number (v)

Fig. 7: Expected volume of each cluster depends on EC density, volume of
underlying space, and expected EC. The plot is drawn for u = 31.

Fig. 8: The probability of cluster v with different spatial extents r is

exponentially distributed with mean β (cid:0)see Eq. (26)(cid:1).

compared to SPPP points. For example, at a distance of 2.5 m,
the probability of two spatially correlated potential candidates
for D2D communication is 0.8 as compared to 0.42 in SPPP
points which occur so close by chance (i.e., not due to spatial
correlation under some homophilic relation). This is because
SPPP cannot model spatial correlation between points and is
characterized by complete spatial randomness.

IV. AVERAGE COVERAGE PROBABILITY

In this section, we introduce G function as retention prob-
ability of D2D nodes at spatial extent r to analyze the
interference and resulting average coverage probability of
cellular user. We assume interference-limited environment due
to large number of potential D2D pairs. Hence, the signal-to-
interference ratio (SIR) is given as:

SIRSBS =

,

(28)

pcfcr−α

c

Pi∈Φ pifir−α

i

where pc and pi are transmit powers of cellular user and D2D
interferers, respectively; fc, and fi are respective small-scale
fading. The corresponding distance dependent path-loss are
. Assuming exponential distribution with mean
r−α
c
1 for power received by SBS, the average coverage probability
of uplink cellular user is given by the following theorem.

and r−α

i

Theorem 4. The average coverage probability of a cellular
user with underlay D2D communication is

pc

cov =Z R

R0

−

e

2π2 ψ0p(r) r2
c

α sin( 2π
α

pc(cid:1) 2
) (cid:0) γ

2
α

α E[p

i ] 2rc

R2 drc.

(29)

Proof: See Appendix A.

For same transmit power of all D2D interferers, the average
coverage probability of cellular user for path-loss exponent
α = 4 and R0 ∼ 0 reduces to:

pc
cov =

2

e− π2R2 ψ0p(r)
− π2R2ψ0p(r)

2

q γpi

pc − 1
q γpi

pc

.

(30)

V. NUMERICAL RESULTS AND DISCUSSION

In this section, we numerically evaluate the analytic expres-
sions of Sec. IV by varying the number of different parameters.
The average coverage probability of cellular user in (30)
depends on R, ψ0 (and an important implicit parameter u),
spatial extent r, D2D transmit power pi, transmit power of
cellular user pc, and target threshold γ. The ﬁrst and foremost
step is to identify implicit parameter u which is introduced as
interference control parameter for D2D pairing. This parameter
is a function of grid size and more speciﬁcally SBS radius
R. By ﬁnding the feasible range of u for a given radius R,
we have varied other parameters to analyze average coverage
probability of cellular user. For different spatial extents r, the
cumulative interference effect is captured. Since the distance
between D2D pairs is much smaller as compared to distance
between D2D pair and SBS, it is reasonable to assume same
transmit power for every D2D pair in the coverage area. To

 

SPPP: 1 − e−λπr2
SPPP: Empirical
PCP: CFA
PCP: Empirical

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

)
r
(

G

0
 
0

5

10
r

15

20

Fig. 9: Nearest neighbor distribution function of PCP shows high probability
for lower values of r as compared to homogeneous SPPP process.

8

(a) Intensity function of PCP on 200×200 grid for thresh-
old values u = (1, 2, 4, 8).

(b) 10×10 extract of Fig. 10(a) clearly shows surviving
and departing blobs at same values of u.

v
o
cc
p

1

0.8

0.6

0.4

0.2

0
40

30

20

u

10

20

15

10

5

0

0

−5

γ(dB)

(c) Coverage probability of cellular user drops for low
values of u i.e., maximum number of possible D2D pairs.

Fig. 10: Interference characterization in terms of intensity measure of PCP at different values of u (Fig. 10(a), 10(b)) and average coverage probability of
cellular user (Fig. 10(c)) for pi = 0 dBm, pc = 20 dBm, and R = 100 m.

analyze the interference due to D2D clusters, we introduce
nearest neighbor distribution function into Laplace functional
of SPPP.

In Fig. 10, we show intensity function at different thresholds
and corresponding average coverage probability of cellular
user for grid size 200×200 (SBS of radius R = 100 m).
For clear illustration, the small portion of this grid has been
shown in Fig. 10(b). In this grid, if we set u = 2 (transparent
black plane), all nodes (despite low spatial correlation) will be
considered to make D2D pairs5 based on the spatial distance
r. This results in maximum intracell interference and causes
blockage for the cellular user. If we increase u (red, green,
and blue transparent planes), only those potential D2D pairs
will survive that lie under high intensity blobs of χ2
k-RF.
In this case, the coverage probability of cellular user can
be ensured while reusing the resources for D2D pairs. The
coverage probability curves for different u and γ can be seen
in Fig. 10(c). The high threshold, for example, u = 35 in
this ﬁgure shows no D2D pair and ensure the unit coverage
probability of cellular user.

The interference control parameter u for different grid sizes
has been plotted in Fig. 11. In this ﬁgure, it can be seen
that the interference, due to D2D communication on coverage

probability of cellular user, is captured by u. As an example,
cov rises
for 10×10 grid size (SBS of radius R = 5 m), the pc
from 2% to 98% for u = 5 to 16 as compared to 1000×1000
grid size (R = 500 m) where the blockage extends on the ﬂoor
upto the value of u = 37 and shows 98% rise in pc
cov at u =
45.

r
e
s
u

r
a
l

u

l
l
e
c

f
o

.

b
o
r
p

e
g
a
r
e
v
o
C

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 

10 × 10
200 × 200
500 × 500
1000 × 1000

 

(27, 0.02)

(35, 0.98)

5

10

15

20

25

30

35

40

45

Interference threshold (u)

5The maximum number of upcrossings of χ2

k-RF occurs at around u = k
as can be veriﬁed in Euler density (Fig. 5) and expected EC (Fig. 6) plots.

Fig. 11: Interference control parameter u for different grid sizes (SBS radius
R) for pi = 0 dBm, pc = 20 dBm.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

r
e
s
u

r
a
l

u

l
l
e
c

f
o

.

b
o
r
p

e
g
a
r
e
v
o
C

0
 
−5

 

C1 <= 16 m
C2 <= 8 m
C3 <= 4 m
C4 <= 2 m

0

5

10

15

20

Target SIR (γ(dB))

Fig. 12: Clusters of D2D nodes and coverage probability of cellular user for
u = 31, pi = 0 dBm, pc = 20 dBm and R = 100 m.

In Fig. 12, we have shown the effect of interference due
to different cluster sizes on coverage probability of cellular
user. The cluster sizes show different number of D2D nodes
that survive the threshold u. For example, at u = 31 (pc
cov =
0.62 from Fig. 11), four cluster sizes of r = (16, 8, 4, 2)m
are shown that consider D2D communication by reusing
the frequency of cellular user. The maximum cluster size
considers all nodes which are less than or equal to 16 m for
D2D communication and hence causes maximum interference.
Contrary to this, the minimum cluster size considers nodes
with 2m or less distance for D2D communication and hence
results in less interference.

The effect of power control on D2D pairs can be seen in Fig.
13. In this ﬁgure, we can see that the coverage probability of
cellular user can be ensured by controlling the transmit power
of successful D2D pairs. The coverage drop at two values of
γ (0 and 20 dB) is approximately equal, however, two curves
with smaller pi ([-20 -10] dBm) converges rapidly at lower
values of γ as compared to curves with high pi ([0 10] dBm).
This trend is reversed at high values of γ.

The effect of power control on cellular user and coverage
probability curves are shown in Fig. 14. It can be seen that the
curves for different pc converge to low coverage probability
for high γ. The coverage probability can be increased by either
reducing transmit power of D2D pairs or reducing the number
of D2D pairs by increasing threshold u. The threshold u and
spatial extent r (small r requires lower pi) are key control
parameters to ensure the extent of frequency reuse (D2D pairs)
while ensuring coverage probability of cellular user.

VI. CONCLUSION

In this paper, we proposed PCP process to model inho-
mogeneous and spatially correlated distribution of MTs. We
considered this process to characterize intracell interference in
D2D underlay network. We further approximated intractable
nearest neighbor distribution function by adopting expected
Euler Characteristic and Poisson clumping heuristic. The key
ﬁndings of this research are enumerated as:

9

1) Simple SPPP process with constant intensity measure
cannot capture prevailing inhomogeneity and spatial
correlation in dense cellular networks. Therefore, point
processes with attraction/repulsion property (e.g., Cox
process/DPP) are potential candidates for precise spatial
modeling of MTs/BSs.

2) Euler Characteristic and RFT framework can be used
to analyze and identify high intensity areas/hotspots for
D2D communication.

3) Provided SPMs of coverage area are available, statistical
inference can be performed to identify clusters of MTs
with high spatial correlation (potential areas for D2D
communication).

4) The intensity measure of PCP is governed by χ2

k-RF.
In this case the threshold u of the excursion set plays
a key role to control cluster size, for D2D communica-
tion, level of interference, due to frequency reuse, and
coverage probability of cellular user.

APPENDIX A - PROOF OF THEOREM 4

The average coverage probability of uplink cellular user
distributed uniformly over plane between R and R0 at a
distance rc from the serving SBS is given as follows:

where

pc

γIm
pcr−α

cov =Erc(cid:2)p(cid:0)SIRSBS ≥ γ(cid:1)| rc(cid:3),
(cid:1)| rc(cid:21),
=Erc(cid:20)p(cid:0)fc ≥
Im = Xi∈Φ

pifir−α

,

c

i

(A.1)

(A.2)

i

c

, pi, fi, r−α

is the cumulative interference due to D2D clusters in the
coverage area and E(·) is expectation with respect to (·).
In (A.1), the coverage probability depends on number of
RVs e.g., pc, fc, r−α
. The power transmitted by
the cellular user pc is assumed to be independent of the
interferers. The serving SBS uses uplink power control to
ensure quality of service of the cellular user based on distance
dependent path-loss. The fading fc and fi follows Rayleigh
distribution with pc and pi as exponentially distributed. The
cellular user is uniformly distributed in the coverage area
whereas all potential D2D nodes are distributed according
to PCP process. Conditioning on g = {pi, fi}, the coverage
probability of cellular user for a given transmit power pc is:

p(cid:0)SIRSBS ≥ γ(cid:1)| rc, g =Z ∞

e−xdx,

x= γIm
−α
c

pc r
c rα

=e−γp−1

c Im.

De-conditioning by g, (A.3) results in

c rα

p(cid:0)SIRSBS ≥ γ(cid:1)| rc =Eg(cid:2)e−γp−1
=Eg(cid:2)e−scIm(cid:3),
=LIm(cid:0)sc(cid:1),

c Im(cid:3),

where sc = γp−1

c .
c rα

(A.3)

(A.4)

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

r
e
s
u

r
a
l

u

l
l
e
c

f
o

.

b
o
r
p

e
g
a
r
e
v
o
C

0
 
−5

0.65

 

pi = -20 dBm
pi = -10 dBm
pi = 0 dBm
pi = 10 dBm

0.60

0

5

10

15

20

Target SIR (γ(dB))

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

r
e
s
u

r
a
l

u

l
l
e
c

f
o

.

b
o
r
p

e
g
a
r
e
v
o
C

0
 
−5

10

 

pc = 5 dBm
pc = 10 dBm
pc = 15 dBm
pc = 20 dBm

0

5

10

15

20

Target SIR (γ(dB))

Fig. 13: Power control on D2D pairs and effect on coverage probability of
cellular user for u = 31, pc = 20 dBm and R = 100 m.

Fig. 14: Power control on cellular user and coverage probability for u = 31,
pi = 0 dBm and R = 100 m.

Putting the value of Im from (A.2) in (A.4)

i (cid:21)
LIm(cid:0)sc(cid:1) =EΦ,pi,fi(cid:20)e−sc Pi∈Φ pifir−α
i (cid:21)
e−scpifir−α
i (cid:19)(cid:21)
(cid:21),
i (cid:19)
}

=EΦ,pi,fi(cid:20)Yi∈Φ
=EΦ(cid:20)Yi∈Φ
Epi(cid:18)
=EΦ(cid:20)Yi∈Φ
(cid:18)
|

1 + scE[pi]r−α

1 + scpir−α

{z

f (x)

1

1

Since R0 ≪ R, therefore assuming R0 ∼ 0, the integral on
right hand side of (A.8) can be evaluated as:

0 (cid:18) u
Z ∞

1 + uα(cid:19)du =

π

α sin( 2π
α )

.

(A.9)

Putting (A.9) in (A.8) and using uniform distribution from (8),
the average coverage probability of a cellular user (A.1) is:

(A.5)

pc

cov =Erc(cid:20)e
=Z R

e

R0

−

−

2π2 ψ0 p(r) r2
c

α sin( 2π
α

2π2 ψ0p(r) r2
c

α sin( 2π
α

α E[p

2
α
i ]

|rc(cid:21),

2
α

α E[p

i ] 2rc

pc(cid:1) 2
) (cid:0) γ
pc(cid:1) 2
) (cid:0) γ

R2 drc.

(A.10)

where (A.5) results from the i.i.d. assumption of pi and fi and
further independence from PCP process.

The probability generating functional of f (x) with retention
probability p(r) = G(r) from (25) and Λ from (Sec. III-A1)
is6

EΦ(cid:20)Yi∈Φ

f (x)(cid:21) = e− RR2 (1−f (x))p(r)ψ0dx,

= e−ψ0 p(r) R ∞
0 R 2π
= e−2πψ0 p(r) R ∞

0 (1−f (x))xdθdx,
0 (1−f (x))xdx.

(A.6)

Putting f (x) from (A.5) in (A.6), LIm (·) can be computed as

LIm(cid:0)sc(cid:1) =e

=e

R0(cid:0)1−
−2πψ0 p(r) R ∞
R0(cid:0)
−2πψ0 p(r) R ∞

1

1+sc E[pi]x−α(cid:1)xdx
sc E[pi](cid:1)xdx

.

1

1+ xα

,

(A.7)

By substituting

xα
sc E[pi] = uα, (A.7) can be derived as
1+uα(cid:1)du.

R0(cid:0) u

i ] R ∞

2
α E[p

LIm(cid:0)sc(cid:1) =e−2πψ0 p(r)(sc)

2
α

(A.8)

6The Laplace functional of SPPP, with random intensity measure Λ and
thinning based on G function of PCP has been applied [33, Proposition 1.2.2
and 1.3.5] to capture interference due to successful D2D clusters.

REFERENCES

[1] R. Heath, M. Kountouris, and T. Bai, “Modeling het-
erogeneous network interference using poisson point
processes,” IEEE Trans. Signal Process., vol. 61, no. 16,
pp. 4114–4126, Aug. 2013.

[2] H. Dhillon, R. Ganti, F. Baccelli, and J. G. Andrews,
“Modeling and analysis of k-tier downlink heterogeneous
cellular networks,” IEEE J. Sel. Areas Commun., vol. 30,
no. 3, pp. 550–560, Apr. 2012.

[3] C.-H. Lee, C.-Y. Shih, and Y.-S. Chen, “Stochastic ge-
ometry based models for modeling cellular networks in
urban areas,” Wireless Networks, vol. 19, no. 6, pp. 1063–
1072, Oct. 2012.

[4] T. Shirai and Y. Takahashi, “Random point ﬁelds associ-
ated with certain Fredholm determinants I: fermion, Pois-
son and boson point processes,” J. Functional Analysis,
vol. 205, no. 2, pp. 414 – 463, Dec. 2003.

[5] J. Hough, M. Krishnapur, Y. Peres, and B. Virag, “Deter-
minantal processes and independence,” Probability Sur-
veys, vol. 3, pp. 206–229, 2006.

[6] Y. Li, F. Baccelli, H. Dhillon, and J. G. Andrews,
“Statistical modeling and probabilistic analysis of cellu-
lar networks with determinantal point processes,” IEEE

11

Trans. Commun., vol. 63, no. 9, pp. 3405–3422, Sep.
2015.

[7] N. Deng, W. Zhou, and M. Haenggi, “The ginibre point
process as a model for wireless networks with repulsion,”
IEEE Trans. Wireless Commun., vol. 14, no. 1, pp. 107–
121, Jan. 2015.

[8] Y. Li, F. Baccelli, H. S. Dhillon, and J. G. Andrews,
“Fitting determinantal point processes to macro base sta-
tion deployments,” in Proc. Intl. Conf. Global Communs.,
GLOBECOM’2014, Austin, TX, USA, Dec. 2014.

[9] H. Mustafa, M. Shakir, M. Imran, A. Imran, and R. Tafa-
zolli, “Coverage gain and device-to-device user density:
Stochastic geometry modeling and analysis,” IEEE Com-
mun. Lett., vol. 19, no. 10, pp. 1742–1745, Oct. 2015.

[10] H. Mustafa, M. Shakir, M. Imran, and R. Tafazolli,
“Distance based cooperation region for D2D pair,” in
Proc. Vehicular Technology Conf., VTC’2015, Glasgow,
Scotland, May 2015.

[11] F. Lavancier, J. Møller, and E. Rubak, “Determinantal
point process models and statistical
inference,” J. R.
Statist. Soc. B, vol. 77, no. 4, pp. 853–877, Sep. 2015.
[12] R. J. Adler and J. E. Taylor, Random Fields and Geom-
etry, 1st ed. New York, USA: Springer-Verlag, 2007.

[13] K. Friston, Statistical Parametric Mapping: The Analysis
London, UK:

of Functional Brain Images, 1st ed.
Academic Press, 2007.

[14] J. Møller, A. R. Syversveen, and R. P. Waagepetersen,
“Log Gaussian Cox processes,” Scandinavian Journal of
Statistics, vol. 25, no. 3, pp. 451–482, 1998.

[15] P. Abrahamsen and N. regnesentral, “A Review of Gaus-
sian Random Fields and Correlation Functions,” Norsk
Regnesentral, Norwegian Computing Center, Oslo, Nor-
way, Tech. Rep. 917, 1997.

[16] K. J. Worsley, “Local maxima and the expected Euler
characteristic of excursion sets of χ2, F and t ﬁelds,”
Advances in Applied Probability, pp. 13–42, 1994.

[17] R. J. Adler and A. M. Hasofer, “Level crossings for
random ﬁelds,” The Annals of Probability, vol. 4, no. 1,
pp. 1–12, Feb. 1976.

[18] R. J. Adler, “Excursions above a ﬁxed level by n-
random ﬁelds,” J. Applied Probability,

dimensional
vol. 13, no. 2, pp. 276–289, 1976.

[19] P. McCullagh and J. Møller, “The permanental process,”
Advances in Applied Probability, vol. 38, no. 4, pp. 873–

888, Dec. 2006.

[20] S. M. Ross, Introduction to Probability and Statistics
Boston, USA:

for Engineers and Scientists, 4th ed.
Academic Press, Mar. 2009.

[21] C. E. Rasmussen and C. K. I. Williams, Gaussian Pro-
cesses for Machine Learning. Massachusetts, USA: MIT
Press, Jan. 2006.

[22] O. Macchi, “The coincidence approach to stochastic
point processes,” Advances in Applied Probability, vol. 7,
no. 1, pp. 83–122, 1975.

[23] E. Spodarev, Stochastic Geometry, Spatial Statistics and
Random Fields: Asymptotic Methods, 1st ed. Heidel-
berg, Germany: Springer-Verlag, Feb. 2013.

[24] W. L. Martinez and A. R. Martinez, Computational
Statistics Handbook with Matlab, 2nd ed. Florida, USA:
CRC Press, Dec. 2007.

[25] B. D. Ripley, “The second-order analysis of stationary
point processes,” J. Applied Probability, vol. 13, no. 2,
pp. 255–266, Jun. 1976.

[26] J. Møller and P. McCullagh, “The permanent process,”
Aalborg University, Department of Mathematical Sci-
ences, Aalborg, Denmark, Tech. Rep. R-2005-29, 2005.
[27] E. Marcon and F. Puech, “Generalizing Ripley’s K func-
tion to inhomogeneous populations,” preprint, Apr. 2009.
[28] J. Cao, “The size of the connected components of ex-
cursion sets of χ2, t and F ﬁelds,” Advances in Applied
Probability, vol. 31, no. 3, pp. 579–595, 1999.

[29] R. J. Adler, The Geometry of Random Fields. Philadel-
phia, USA: Society for Industrial and Applied Mathe-
matics, Dec. 2009.

[30] D. Aldous, Probability Approximations via the Poisson
Clumping Heuristic, 1st ed. New York, USA: Springer-
Verlag, Mar. 2013.

[31] J. C. Mazziotta, A. W. Toga, and R. S. J. Frackowiak,
San Diego, USA:

Brain Mapping: The Disorders.
Academic Press, May 2000.

[32] K. J. Friston, K. J. Worsley, R. S. J. Frackowiak, J. C.
Mazziotta, and A. C. Evans, “Assessing the signiﬁcance
of focal activations using their spatial extent,” Human
Brain Mapping, vol. 1, no. 3, pp. 210–220, Jan. 1994.

[33] F. Baccelli and B. Błaszczyszyn, “Stochastic geometry
and wireless networks: volume I theory,” Foundations
and Trends in Networking, vol. 3, no. 34, pp. 249–449,
2008.

