6
1
0
2

 
r
a

M
2

 

 
 
]
T
I
.
s
c
[
 
 

1
v
8
4
6
0
0

.

3
0
6
1
:
v
i
X
r
a

Superimposed Pilots are Superior for

Mitigating Pilot Contamination in Massive

MIMO — Part I: Theory and Channel

1

Estimation

Karthik Upadhya, Sergiy A. Vorobyov Senior Member, IEEE, Mikko

Vehkaper¨a, Member, IEEE

Abstract

Superimposed pilots are shown, in this two-part paper, to be a superior alternative to time-multiplexed

pilot and data symbols for mitigating pilot contamination in massive multiple-input multiple-output

systems (MIMO). Provided that the number of symbols transmitted in the uplink time-slot is larger

than the total number of users in the system, superimposed pilots allow for each user to be assigned

a unique pilot sequence. This property, along with larger time-averaging owing to longer length pilot-

sequences, allows for a signiﬁcant reduction in pilot contamination. In this part of the two-part paper,

superimposed pilots are introduced as an approach for mitigating pilot contamination and it is shown that

a hybrid system with users utilizing both time-multiplexed pilots and superimposed pilots is superior

to an optimally designed system that only employs conventional pilots. In addition, we describe an

iterative data-aided method for uplink channel estimation that offers a signiﬁcantly better performance.

Approximate expressions for the uplink signal-to-interference-plus-noise ratio are also provided for this

method. Numerical simulations validate the approximations and the performance of the proposed method

while demonstrating its superiority.

K. Upadhya and S. A. Vorobyov are with the Department of Signal Processing and Acoustics, Aalto University, FI-00076

Aalto, Finland (E-mails: karthik.upadhya@aalto.ﬁ, svor@ieee.org).

M. Vehkaper¨a is with the Department of Electronic and Electrical Engineering, University of Shefﬁeld, Shefﬁeld, S1 3JD,

UK (E-mail: m.vehkapera@shefﬁeld.ac.uk).

S. A. Vorobyov is the corresponding author.

2

Index Terms

Massive MIMO, pilot contamination, superimposed pilots.

I. INTRODUCTION

Massive multiple-input multiple-output (MIMO) systems, proposed in [1], have received sig-

niﬁcant interest in recent years as a candidate for ﬁfth-generation mobile communication tech-

nologies [2]–[4]. These systems are a variation of multi-user MIMO (MU-MIMO) with a large

number of base station (BS) antennas and they offer an increased spectral efﬁciency through

spatial multiplexing [5], [6]. Under favorable propagation conditions [1], signiﬁcant gains in

throughput can be achieved by employing simple linear processing at the BS [7], [8]. In addition,

not only do large numbers of antennas result in an improved energy-efﬁciency [9], but also render

the system performance resilient to hardware impairments [10].

However, all the above mentioned beneﬁts of a massive MIMO communication system hinge

on the assumption that the BS has access to accurate estimates of the channel state information

(CSI). For systems that employ either frequency division duplexing (FDD) or time division

duplexing (TDD), the channel estimates are obtained using orthogonal pilot sequences. In FDD

systems, each antenna at the BS transmits a pilot sequence that is orthogonal to the pilot

sequences transmitted by the other antennas. Since the length of the orthogonal pilot sequences

become proportional to the number of BS antennas [5], FDD is impractical for channel estimation

in massive MIMO. Moreover, since the CSI corresponding to each antenna is estimated by

the users, it has to be fedback from the users to the BS, consuming additional bandwidth.

Consequently, massive MIMO systems are typically assumed to employ TDD with full frequency-

reuse and utilize channel reciprocity to obtain CSI. In these systems, each user in a cell is assigned

a different pilot sequence and these pilots are time-multiplexed with data in each coherence block.

When using time-multiplexed pilots, the requirement for high spectral efﬁciency necessitates

sharing of pilot sequences between adjacent cells, resulting in the channel estimates of the users

in a cell being corrupted by the channel vectors of users in the adjacent cells. This phenomenon

called ‘pilot contamination’ [11] introduces interference in both the uplink (UL) and downlink

(DL), degrading the overall performance of the system.

Existing methods to mitigate pilot contamination for massive MIMO are designed for the

case where the pilots are time-multiplexed with the data, henceforth referred to as conventional

3

time-multiplexed pilots. In [12], it has been observed that the eigenvectors of the autocorrelation

matrix of the received data correspond to the channel vectors of the desired and interfering

users, and a method for channel estimation has been developed based on this observation. Pilot

decontamination has been performed in [13] by projecting the contaminated channel estimate

on an interference-free subspace spanned by the channel vectors of the desired users. In [14], a

coordinated method for pilot allocation has been proposed for separating desired and interfering

users in correlated channels. A pilot decontamination method based on array processing has been

proposed in [15] for use in parametric channels with a ﬁnite number of discrete paths. In [16],

a resource allocation approach has been proposed for optimizing the number of users scheduled

in each cell in order to minimize the effect of pilot contamination.

In this paper, we propose using superimposed pilots as an alternative to conventional time-

multiplexed pilots in massive MIMO systems. Superimposed pilots have been extensively studied

for channel estimation in MIMO systems [17]–[20]. However, these papers have focused on

superimposed pilots in the context of accommodating a loss in signal-to-noise ratio (SNR) in

exchange for a reduced pilot transmission overhead [17], [18]. Most recently, superimposed pilots

have been employed in the context of multi-cell multiuser MIMO systems [21], without realizing

that it provides a superior solution to the pilot contamination problem in massive MIMO. In the

context of multi-cell massive MIMO, superimposed pilots allow for each user in the system to

be assigned a unique pilot sequence, enabling the receiver to estimate the channel vectors of

both the desired and interfering users. In addition, these pilots mitigate pilot contamination by

time-averaging over long sequences and offer a higher efﬁciency due to a reduced transmission

overhead.

We propose a novel low-complexity iterative matched-ﬁlter (MF) based channel estimation

scheme for superimposed pilots and demonstrate its effectiveness by deriving a closed-form
approximation for the UL signal-to-interference-plus-noise ratio (SINR) of the system.1 Although

the use of superimposed pilots requires some coordination between the BSs in assigning pilot

sequences to the users and estimating their path-loss coefﬁcients, these are minor impediments

compared to the performance improvements provided by the proposed scheme.

1The work in this paper is a signiﬁcant extension of our submitted conference paper [22]. In addition to a detailed exposition

of the conference paper, we have included additional results that demonstrate the superiority of massive MIMO systems that

use superimposed pilots instead of conventional pilots.

4

In Section II, the system model for the massive MIMO UL is described. In Section III, the

conventional time-multiplexed pilots and the pilot contamination problem are detailed. Section IV

introduces the superimposed pilot scheme and describes the non-iterative method for channel

estimation and Section V discusses the iterative data-aided scheme. In Section VI, a few im-

portant remarks are made about the complexity of the proposed method and its application in

practice. Section VII presents simulation results demonstrating the effectiveness of employing

superimposed pilots for pilot decontamination. Section VIII concludes the paper. Some of the

proofs are detailed in Appendix.

Notation : Lower case and upper case boldface letters denote column vectors and matrices,
respectively. The notations (·)∗, (·)T , (·)H, and (·)−1 represent the conjugate, transpose, Hermitian
transpose, and inverse, respectively. The Kronecker product is denoted by ⊗. The notation
CN (µµµ, Σ) stands for the complex normal distribution with mean µµµ and covariance matrix Σ
and E{·} is used to denote the expectation operator. The notation IN denotes an N × N identity
matrix, and k·k and k·kF denote the Euclidean norm of a vector and Frobenius norm of a matrix,
represents the indicator function
respectively. Upper case calligraphic letters denote sets and 1{S}
over the set S, while δn,m denotes the Kronecker delta function. The empty set is denoted by
∅. The notation η(·) stands for an element-by-element hard-decision function that replaces each
element of the input vector with the constellation point that is closest in Euclidean distance to
that element. The notation o (·) denotes the order of magnitude of a term.

II. SYSTEM MODEL

We consider a TDD massive MIMO UL with L cells and K single-antenna users per cell.
Each cell has a BS with M ≫ K antennas. The matrix of received measurements Yj ∈ CM×Cu
at the jth BS can be written as

Yj = √pu

hj,ℓ,kxT

ℓ,k + Wj

(1)

L−1Xℓ=0

K−1Xk=0

where pu denotes the transmit power of each user, xℓ,k ∈ CCu×1 denotes the vector of symbols
transmitted by the kth user in the ℓth BS, Wj ∈ CM×Cu is the additive white Gaussian noise
at the jth BS with each column distributed as CN (0, σ2IM ). Moreover, the columns of Wj are
mutually independent of each other. The vector hj,ℓ,k ∈ CM×1 represents the channel response

between the jth BS and the kth user in the ℓth cell, and is distributed as

hj,ℓ,k ∼ CN (0, βj,ℓ,kIM )

5

(2)

where βj,ℓ,k denotes the large-scale path-loss coefﬁcient and depends on the user location in the
cell. In addition, the channel vectors hj,ℓ,k are assumed to be mutually independent of each other
∀j, ℓ, k. These statistics of the channel vector represent a non-line-of-sight scenario with rich
scattering [1]. By virtue of their zero mean and mutual independence, the channel vectors are

asymptotically orthogonal and the following equation holds almost surely [1], i.e.,

hH

j,k,ℓhm,n,p

M

lim
M→∞

= βj,k,ℓ δj,mδk,nδℓ,p, ∀ j, k, ℓ, m, n, p .

(3)

Moreover, hj,ℓ,k is assumed to be constant for the duration of C symbols, where C is the smallest
channel coherence time of all the users in the system. However, the statistics of hj,ℓ,k, determined
by βj,ℓ,k, remains constant for a signiﬁcantly longer duration that depends on user mobility. The
coherence time C is assumed to be divided into Cu and Cd, which are the durations of the
UL and DL time slots, respectively. The elements of xℓ,k are assumed to be independent and
identically distributed (i.i.d) random variables with zero-mean and unit variance and take values

from the alphabet χ.

III. CONVENTIONAL TIME-MULTIPLEXED PILOTS AND THE PILOT CONTAMINATION

PROBLEM

With conventional time-multiplexed pilots, each user in a cell transmits a τ ≥ K length
orthogonal pilot sequence for channel estimation followed by Cu − τ symbols of uplink data. In
order to minimize the overhead incurred for the transmission of these τ symbols, it is necessary
to reuse these pilot sequences in the adjacent L − 1 cells. However, this pilot-reuse results in
the channel estimates of the desired users being contaminated by the channel vectors of users

in adjacent cells, causing interference and in turn, a loss in spectral efﬁciency.

It is assumed here that the transmission of the pilot sequences by the users in the L cells are

synchronized, which corresponds to the worst-case scenario for pilot contamination. Let the pilot
sequences transmitted by the users be the elements of a pilot book B consisting of orthogonal
sequences of length τ and deﬁned as [16]

B , {Φ1, . . . , Φτ} where ΦH

k Φl = τ δk,l .

(4)

If bℓ,k ∈ {1, . . . , τ} is the index of a pilot in B that is transmitted by the kth user of the ℓth cell,
and if Φbℓ,k is the corresponding pilot sequence, then the received signal at the jth BS during
pilot training Y(p)

j ∈ CM×τ can be written as

6

j = √pu
Y(p)

L−1Xℓ=0

K−1Xk=0

hj,ℓ,kΦT

bℓ,k + Wj .

(5)

The least-squares (LS) estimate of the channel of the mth user in the jth BS can be obtained as

[1]

,

j,j,m

bhCP

1

τ√pu

Y(p)

j Φ∗bj,m= hj,j,m +

hj,ℓ,m +

L−1Xℓ=0

ℓ6=j

1

τ√pu

WjΦ∗bj,m

(6)

where the superscript CP indicates that the estimates are computed when using conventional

pilots. It can be observed that the estimates of the channel vectors of the users in the jth cell
are contaminated by the channel vectors of the users in the remaining L − 1 cells. If each pilot
sequence is reused once every r , τ /K cells [16], the SINR in the UL for the mth user in the

jth cell with the channel estimate in (6) and using an MF for detection, can be written as [1]

SINRCP−ul
j,j,m

=

M→∞

β2

β2

j,j,mPℓ6=j

ℓ∈Lj(r)

j,ℓ,m

(7)

where Lj(r) is the subset of the L cells that use the same set of pilots as the jth cell. The
corresponding throughput of the user using Gaussian signaling in the UL can then be expressed

as [1], [16]

RCP−ul

j,j,m =

(Cu − τ )

C

(Cu − rK)

=

C

log2(cid:0)1 + SINRCP−ul
j,j,m (cid:1)

j,j,mPℓ6=j

ℓ∈Lj(r)

log2

1 +

β2

β2

j,ℓ,m



.

(8)

From the above equation, it can be observed that the rate per user is a function of both the

overhead τ as well as the loss in SINR due to pilot contamination. A larger value of r would
increase the pilot transmission overhead and reduce the transmission efﬁciency (Cu−τ )/C while
increasing the SINR.

IV. SUPERIMPOSED PILOTS

With superimposed pilots, the pilot symbols are transmitted at a reduced power alongside the

data symbols, and in its simplest version, the pilot and data symbols are transmitted alongside

7

each other for the entire duration of the uplink data slot Cu. If the total number of users in
the system is smaller than the number of symbols in the uplink, i.e., KL ≤ Cu, then with
superimposed pilots, each user can be assigned a unique orthogonal pilot pℓ,k ∈ CCu×1. The
pilots are taken from the columns of an orthogonal matrix P ∈ CCu×Cu such that PHP = CuICu.
If (ρℓ,kxℓ,k + λℓ,kpℓ,k) is the transmitted vector from the kth user in the ℓth cell, the received
signal at the jth BS Yj ∈ CM×Cu, when using the superimposed pilot scheme, can be written
as

Yj =

hj,ℓ,k (ρℓ,kxℓ,k + λℓ,kpℓ,k)T + Wj

(9)

L−1Xℓ=0

K−1Xk=0

ℓ,k and λ2

where ρ2
respectively, and the total transmitted power µℓ,k is given as µℓ,k = λ2

ℓ,k are the fractions of the transmit power reserved for the pilot and data symbols,

ℓ,k + ρ2

ℓ,k.

A. Non-Iterative Channel Estimation

Treating the data symbols of all users as additive noise, the channel estimate of the kth user

in the ℓth BS can be obtained at the jth BS using the LS criterion [21]

Solving (10) yields

h kYj − λℓ,kh pT

ℓ,kk2
F .

λℓ,kp∗ℓ,k =

1

Cuλℓ,k

Yjp∗ℓ,k

ρm,nhj,m,nxT

m,np∗ℓ,k

bhj,ℓ,k , arg min
ℓ,kpℓ,k(cid:1)−1
L−1Xm=0
K−1Xn=0

ℓ,k pH

Cuλℓ,k

1

bhj,ℓ,k = Yj(cid:0)λ2

= hj,ℓ,k +

1

+

Cuλm,n

Wjp∗ℓ,k .

(10)

(11)

corresponding to the transmitted superimposed pilot λj,mhj,j,mpT

In order to estimate the data from the received observations, it is necessary to remove the term
j,m from the observation vector
j,m as an estimate for this term, the estimate of xj,m can then be obtained

in (9). Using λj,mbhj,j,mpT

from the observation Yj using an MF and a hard-decision device as follows

8

(12)

(13)

j,m(cid:17)
j,j,m(cid:16)Yj − λj,mbhj,j,mpT

1

j,j,m =

Mρj,mβj,j,mbhH

exT
bxj,j,m = η (exj,j,m) .

The SINR of the mth user in the jth cell when M → ∞ and when employing the non-iterative
superimposed pilot scheme can be written as

SINRSP−ul
j,j,m

=

M→∞

1
j,mρ2

j,m

Cuλ2

.

ℓ,kµℓ,kβ2
ρ2

j,ℓ,k

(14)

β2
j,j,m

L−1Pℓ=0

K−1Pk=0

The derivation of the above expression is given in Appendix A Then, the corresponding per-user

rate in the uplink when using Gaussian signaling is given as

RSP−ul

j,j,m =

Cu
C

log2(cid:0)1 + SINRSP−ul
j,j,m (cid:1) .

(15)

B. Power Control and Choice of Parameters λj,m and ρj,m

From (14), it can be seen that the SINR of a user is dependent on the product of the transmit
powers and large-scale fading coefﬁcients of the remaining LK − 1 users, in addition to the
product of its own transmit power and large-scale fading coefﬁcient. This dependence results in

a situation similar to the near-far problem in code division multiple access (CDMA), wherein

users that have larger values of large-scale fading coefﬁcient β swamp users that have smaller

values of β. Therefore, it becomes necessary to use power control to provide a uniform user

experience.

While the parameters µℓ,k, ρℓ,k, and λℓ,k can be optimized by maximizing the sum-rate of all

the users, i.e.,

µℓ,k,ρℓ,k,λℓ,k(RSP−ul

max

tot

,

ℓ,ℓ,k )

RSP−ul

(16)

L−1Xℓ=0

K−1Xk=0

the optimization problem is in general non-convex and requires coordination between the BSs.

As an alternative, a suboptimal solution that does not involve coordination between the BSs is

obtained here for the parameters µℓ,k, ρℓ,k, and λℓ,k. This suboptimal solution will be shown to
maximize a lower bound on the sum-rate RSP−ul

, and it is as follows.

tot

For the parameter µℓ,k, we propose using the statistics-aware power-control approach detailed
in [16], wherein the mth user in the jth cell transmits at a power µj,m = δ/βj,j,m, where δ is

a design parameter. This power control policy results in an identical received power of δ at the

jth BS for all the users in the jth cell.

The received signal in (9) can be equivalently written as

9

Yj =

=

where

pT

ℓ,k(cid:19)+Wj

xT

ℓ,k +

√µℓ,k

λℓ,k
√µℓ,k

√µℓ,khj,ℓ,k(cid:18) ρℓ,k
L−1Xℓ=0
K−1Xk=0
L−1Xℓ=0
K−1Xk=0
¯hj,ℓ,k(cid:0)¯ρℓ,kxℓ,k + ¯λℓ,kpℓ,k(cid:1)T + Wj
¯hj,ℓ,k , √µℓ,khj,ℓ,k ∼ CN(cid:0)0, ¯βj,ℓ,kIM(cid:1)
¯ρℓ,k ,s ρ2
¯λℓ,k ,s λ2

¯βj,ℓ,k , βj,ℓ,kµℓ,k

ℓ,k
µℓ,k

ℓ,k
µℓ,k

> 0

> 0

¯λ2
ℓ,k + ¯ρ2

ℓ,k = 1

(17)

(18)

(19)

(20)

(21)

(22)

From (17), it can be seen that a system having arbitrary values of βj,ℓ,k, µℓ,k, ρℓ,k, and λℓ,k,
can be reduced into an equivalent system with parameters ¯βj,ℓ,k, ¯ρℓ,k, and ¯λℓ,k, such that 0 ≤
¯ρℓ,k, ¯λℓ,k ≤ 1. Moreover, as mentioned in [16], the ratio 0 ≤ βj,ℓ,k/βℓ,ℓ,k ≤ 1 is the relative
strength of the interference received at the jth BS from a user in the ℓth cell. This ratio is at

most 1, when the user is at the edge of the jth cell, and reduces to zero as its distance from the
jth cell increases. Therefore, using the deﬁnitions of ¯βj,ℓ,k, ¯ρℓ,k, and ¯λℓ,k, the choice of µℓ,k, and
the inequality 0 ≤ βj,ℓ,k/βℓ,ℓ,k ≤ 1, the following equations can be obtained

¯βj,j,m = βj,j,mµj,m = δ
¯βj,ℓ,k = βj,ℓ,kµℓ,k ≤ βℓ,ℓ,kµℓ,k = δ ∀ ℓ 6= j

j,mβj,j,m = ¯ρ2
ρ2

j,mδ

j,mδ

j,mβj,j,m = ¯λ2
λ2
ρ2
ℓ,kβj,ℓ,k ≤ ρ2
ℓ,kβj,ℓ,k ≤ λ2
λ2

ℓ,kβℓ,ℓ,k = ¯ρ2

ℓ,kβℓ,ℓ,k = ¯λ2

ℓ,kδ ∀ ℓ 6= j
ℓ,kδ ∀ ℓ 6= j

(23)

(24)

(25)

(26)

(27)

(28)

SINRSP−ul

j,j,m =

L−1Pℓ=0

K−1Pk=0

ℓ,kµℓ,kβ2
ρ2
j,mρ2
Cuλ2

j,mβ2

j,ℓ,k

j,j,m

L−1Pℓ=0

K−1Pk=0

{ℓ6=j,k6=m}

βj,ℓ,kµℓ,k
ρ2
j,mβj,j,m

+

L−1Pm=0

K−1Pn=0

{m6=ℓ,n6=k}

+ 1
M

1

1


K−1Pn=0

L−1Pm=0

{m6=ℓ,n6=k}

≥

L−1Pℓ=0

K−1Pk=0

¯ρ2
ℓ,k
Cu ¯λ2
j,m ¯ρ2

j,m

+ LK−1

M ¯ρ2

j,m

+

(LK−1)¯ρ2
M Cu ¯λ2
j,m ¯ρ2

m,n

j,m

10

ρ2
m,nβj,ℓ,kβj,m,nµℓ,k
Cuλ2

j,mβ2

j,mρ2

j,j,m (29)

(30)

Substituting the above equations in (29), a lower bound on the SINR, as shown in (30), can be

obtained. The equation for the SINR in (29) is derived in Appendix A, and both the equations

(29) and (30) are written at the top of the page. +2

However, maximizing the lower bound on the SINR and hence, a lower bound on the sum
rate, is still a non-convex problem in the parameters ¯ρℓ,k and ¯λℓ,k and requires coordination
between the BSs. To circumvent this problem, we restrict the parameters ¯ρℓ,k and ¯λℓ,k such that
¯ρℓ,k = ¯ρ,∀ ℓ, k and ¯λℓ,k = ¯λ,∀ ℓ, k. The choice of this restriction is motivated by the observation
that from the BSs’ perspective, the received power of each user is the same for all the users in

its cell and as a result, there is no beneﬁt in assigning different values of ¯ρℓ,k to its users. More
importantly, such a restriction renders the choice of ¯ρopt dependent only on L, K, Cu, and M
as will be shown next. Setting ¯ρℓ,k = ¯ρ,∀ ℓ, k and ¯λℓ,k = ¯λ,∀ ℓ, k in (30), we obtain

Substituting the above equation in the deﬁnition of RSP−ul
RSP−ul

as

tot

tot

in (16), gives a lower bound on

Differentiating the right hand side of (30) with respect to ¯ρ2 and setting the resulting expression

SINRSP−ul

j,j,m ≥

LK

Cu(1−¯ρ2) + 1

1
¯ρ2 + (LK−1)2

M(cid:16) LK−1

RSP−ul
tot ≥

LKCu

C

log21 +

LK
Cu

1
+ (LK−1)2
(1−¯ρ2) +

M Cu

Cu(1−¯ρ2)(cid:17) .


LK−1

M
¯ρ2

(29)

(30)

to zero, the value of ¯ρ2 that maximizes the lower bound on RSP−ul

tot

can be obtained as

¯ρ2
opt =

1 +r LK

Cu

1

+ (LK−1)2

M Cu

LK−1

M

≈

1

1 +q M +LK

Cu

and the optimal value of ¯λ2 is obtained as

¯λ2
opt = 1 − ¯ρ2

opt ≈

1

1 +q Cu

M +LK

11

(31)

(32)

It can be seen that as M → ∞, ¯ρopt → 0 and ¯λopt → 1 as pointed out in [21]. While this
behavior does not signiﬁcantly improve the UL SINR performance, it results in an asymptotically

interference free DL, which will be described in Part II of this paper.

Based on the fact established in this subsection that systems using ρ, λ, β, h, and ¯ρ, ¯λ, ¯β, ¯h
are equivalent, we drop the overbar for ease of notation and adopt the former set of symbols in

the rest of the paper. In addition, we set µℓ,k = ¯ρ2

ℓ,k + ¯λ2

ℓ,k = 1, ∀ℓ, k.

C. Theoretical Analysis

Using (14) and (15), the following theorem shows that a massive MIMO system that uses

a combination of conventional and superimposed pilots is superior to a system that uses only

conventional pilots. This improvement is the result of a higher transmission efﬁciency offered

by superimposed pilots.

Theorem 1. For a system that is designed to optimize the sum-rate using conventional pilots,

such as in [16], let K be the optimal number of users per cell, L be the total number of cells

in the system, τ be the optimal number of symbols used for pilot training, r be the optimal
pilot-reuse factor, and Cu − τ and Cd be the number of data symbols in the UL and DL slots,
respectively. Then, with M → ∞, there exists a hybrid system that uses both conventional and
superimposed pilots supporting Cu − τ additional users and has a higher sum-rate in the UL
than the optimal system that only employs conventional pilots.

Proof: Consider the frame structure in Fig. 1, wherein there are two sets of users UCP
and USP. The users in the set UCP employ conventional pilots, with parameters selected using
approaches such as in [16]. The users in the set USP maintain radio silence during the pilot
training phase of the users in UCP, i.e., for τ symbols in the frame, and transmit orthogonal

12

τ

Pilots

τ

No Transmission

Cu

Cu

UCP

Cd

Uplink Data

Downlink Data

USP

Superimposed Pilots

+

Uplink Data

Cd

Downlink Data

Fig. 1. Frame structure of a hybrid system with both conventional and superimposed pilots.

pilots superimposed with data during the uplink data phase of Cu − τ symbols. Since these
users maintain radio silence during the pilot training phase of τ symbols, they do not affect
the quality of the channel estimates of the users in UCP. As a result, under the assumption of
asymptotic orthogonality of the channels, the per-cell sum-rate in the UL for the users in UCP
remains unchanged and can be found from (8) to be

Rul
j (UCP) =

(Cu − τ )

C

log2

K−1Xk=0

k∈UCP

1 +

β2

β2

j,j,kPℓ6=j

ℓ∈Lj(r)

j,ℓ,k

.

(33)





If all the users in USP are located in the jth cell, then using (14) and (15), the sum-rate of the
users in USP can be found as

Rul
j (USP) =

(Cu − τ )

log2 (1 + SINRm (USP))

SINRm (USP) ,

j,mβ2

j,j,m

(Cu − τ ) λ2
ℓ,kβ2
ρ2
ρ2
j,m

+

j,ℓ,k

j,ℓ,k

β2

L−1Pℓ=0

K−1Pk=0
where the additional term in the denominator of SINR(USP ) is due to the interference from the
users in UCP. Therefore, from (33) and (35), the combined rate Rul
is strictly greater
than Rul
. In addition, since the data slot is made up of Cu−τ symbols, it is possible to allocate
Cu − τ orthogonal pilots and therefore the set USP can contain a maximum of Cu − τ users.
This concludes the proof.

USP + Rul
UCP

k∈UCP

UCP

C Xm∈USP
 Pk∈USP

(34)

(35)

While Theorem 1 discusses the maximum number of users supported by a hybrid system for

13

ﬁxed values of Cu and τ, it is also informative to analyze the impact of Cu for a ﬁxed set of
parameters r, τ, and K. Using (14), the following theorem presents an important condition that

guarantees the superiority of methods based on superimposed pilots over the LS estimator that

is based on conventional pilots.

Theorem 2. With ﬁxed values of r and τ and if M → ∞, there exists a UL duration κj,m
beyond which a channel estimator based on superimposed pilots outperforms the LS based

channel estimator that utilizes conventional pilots, in terms of the SINR performance, in any
channel scenario {βj,ℓ,m 0 ≤ j, ℓ ≤ L − 1, 0 ≤ m ≤ K − 1}.

Proof: If κj,m is deﬁned as the number of symbols in the uplink such that (7) and (14) are

equal, i.e.,

β2
j,j,m

1
κj,mλ2
j,mρ2

j,m

L−1Pℓ=0

K−1Pk=0

=

ρ2
ℓ,kβ2

j,ℓ,k

β2

β2

j,j,mPℓ6=j

ℓ∈Lj(r)

j,ℓ,m

(36)

then it is evident from (14) and (36) that Cu > κj,m is a sufﬁcient condition for a method that
is based on superimposed pilots to outperform the LS method that employs conventional pilots.

In addition, κj,m is given as

κj,m ,

This completes the proof.

K−1Pk=0

β2

j,ℓ,m

ρ2
ℓ,kβ2

j,ℓ,k

.

(37)

1

λ2
j,mρ2

j,m

L−1Pℓ=0
Pℓ6=j

ℓ∈Lj(r)

An important consequence of the above theorem is that in scenarios with negligible pilot con-

tamination, the LS method utilizing superimposed pilots require large values of Cu to outperform
the LS method employing conventional pilots. As an example, consider the case when r = 1,
βj,j,m = 1, ∀m, βj,ℓ,m = β, ∀ℓ 6= j, m, and ρ2
j,m,∀ j, m. For such a scenario, κj,m is
given as
κj,m = 2K(cid:18)1 +

(L − 1)β2(cid:19) .

Then, if the LS estimator based on superimposed pilots is required to maintain superiority over the

j,m = λ2

(38)

1

LS estimator employing conventional pilots, Cu must scale inversely with β2. This dependence

on Cu is evident from the expression for the channel estimation error, which is given as

14

(39)

∆hj,j,m , hj,j,m −bhj,j,m
Cuλj,m L−1Xℓ=0

= −

1

ρℓ,khj,ℓ,kxT

ℓ,k + Wj! p∗j,m .

K−1Xk=0

Instead of only relying on time-averaging to mitigate pilot contamination, the robustness of this

estimator with respect to Cu can be improved by additionally utilizing the array-gain of the
antenna, which can be achieved using iterative data-aided schemes.

V. ITERATIVE DATA-AIDED CHANNEL ESTIMATION

In the iterative approach to channel estimation that we develop in this section, the estimated

channel and data vectors of both the desired and interfering users are used in feedback in order

to eliminate the ﬁrst term in (39). In addition, to minimize error propagation between the channel

estimates of different users, the iteration is started from the user with the highest SINR and is

progressed in the decreasing order of the SINR.

A. Algorithm

For the sake of clarity and without loss of generality, we replace the two indices k, ℓ with a
single index m that lies in the range 0 ≤ m ≤ N − 1, where N , KL. The index m is used to
index the users in all the L cells. In addition, we drop the index j and implicitly assume that

the channel estimation is performed at the jth BS. Then, (9) can be rewritten as

Y =

hm (ρmxm + λmpm)T + W .

(40)

N−1Xm=0

Since for large M, the SINRs of the users are proportional to the users’ path-loss coefﬁcients,
the users are arranged in the decreasing order of their path-loss coefﬁcients, i.e., β0 > β1 >
. . . > βN−1. 2 Then, using an estimate of ρmhmxT
mp∗m for each user as a correction factor to

2It is assumed that the BSs have access to the exact values of the path-loss coefﬁcients βm and that there is no false-ordering.
This assumption is reasonable since for large M, the path-loss coefﬁcients can be computed at the BS with negligible error by

averaging the power of the channel coefﬁcients over the entire array.

minimize the interference from other users, the corresponding channel estimate of the mth user

15

can be written as

1

Cuλm

m =

bh(i)

Y −
ρkbh(i−1)

k

k∈U (i)

m

k (cid:17)T
k (cid:16)bx(i)
m−1Xk=0
ρkbh(i)
(cid:17)T p∗m
(cid:16)bx(i−1)

k

−

N−1Xk=m

k∈U (i)

m

(41)

(42)

(43)

m = 0, ∀ m and U (i)

m is the set of users whose estimated data is used in feedback at the
ith iteration to estimate the channel vector of the mth user. The channel estimate in the above

wherebh(0)

equation is a modiﬁed version of the LS estimator deﬁned in (11) with an added correction

factor. Utilizing the resulting channel estimate in an MF and hard-decision device, similar to

(12) and (13), the estimate of the data is obtained as follows

1

=

Mρmβm(cid:16)bh(i)
(cid:0)ex(i)
m(cid:1)T
m = η(cid:0)ex(i)
m(cid:1)
bx(i)

m(cid:17)H(cid:16)Y − λmbh(i)

m pT

m(cid:17)

m = 0, ∀ m = 0, . . . , N − 1.

wherebx(0)

B. Interference Power at the BS

Let e(i)

m , xm −ex(i)

m be the error in the estimate of the data symbols of the mth user obtained
m be the corresponding error
m be the associated error in the
n and assuming that the elements
m are i.i.d. circular complex-Gaussian random variables with zero mean and variance I (i)
m ,

from the matched ﬁlter in the ith iteration. Let ∆x(i)
vector after the hard-decision operation and let ∆h(i)
channel estimate. If α(i)
of e(i)
an approximate expression for the interference power I (i)
σ2βm
Mρ2
m

m , xm −bx(i)
m , hm −bh(i)

n is the variance of the elements of ∆x(i)

m can be written as

+

1

M 2ρ2
m

I (i)
m ≈

βkβm +

1
β2
m

Mρ2
m

(44)

1



N−1Xk=0

k6=m

where the expression for ψ(i)
The detailed derivation of I (i)

m is given in (47) on the top of the next page and ψ(0)
m can be found in Appendix B.

m = 0, ∀m.

ψ(i)

m

ψ(i)

m(cid:12)(cid:12)(cid:12)(cid:12)i≥1
N−1Xk=0

k /∈U (i)

m

+

=

M 2
Cuλ2
m

k(β2

ρ2

k +

ρ2


k
m−1Xk=0
M ) +
N−1Xn=0

k∈U (i)

βnβk

m

kα(i)
β2

k +

k (cid:17)M 2
k +(cid:16)1 + α(i)

βnβkα(i)

1
M

N−1Xn=0

N−1Xk=m

k∈U (i)

m

ρ2

k

kα(i−1)
β2

k

+

βnβkα(i−1)

k

M

N−1Xn=0

16

ψ(i)

+

σ2

k 
M  N−1Xn=0
βn!
(47)
(cid:17) ψ(i−1)
+(cid:16)1 + α(i−1)


k
M 2

k

+1 In deriving (44), the following simpliﬁcations have been made in order to obtain a closed

form expression:

(S1) e(i)
(S2) ∆x(i)
(S3) ∆x(i)
(S4) ∆h(i)

m is independent of xk and W, ∀ k, i.
m is independent of xk, W, and hk, ∀ k, i.
m is independent of ∆x(p)
m is independent of xk, W, and ∆x(p)

k , ∀ k, p.

k , ∀p 6= i, m 6= k and the elements of ∆x(i)

m are i.i.d.

In scenarios with low interference and with large M, the elements of ∆x(i)
m are sparse, and the
elements of e(i)
m take small values, resulting in the simpliﬁcations (S1), (S2), and (S3) being
reasonably accurate. Although the expression for ∆h(i)
m , (given in Equation (85) in Appendix
B) is explicitly dependent on xk and ∆x(i)
m , we neglect the correlation between these terms
since ∆h(i)
m is inversely proportional to Cu, and the simpliﬁcation (S4) is fairly accurate when
Cu is large with respect to N and when scenarios with low interference are considered. Since
e(i)
m is assumed to be a zero-mean random variable, ∆x(i)
is also a zero-mean random variable,
k
provided the constellation points in χ and their probability density functions are symmetric about
the origin. This is true since by deﬁnition, ∆x(i)
following relation

m are related to each other through the

k and e(i)

∆x(i)

k = xk − η(cid:0)xk − e(i)
m(cid:1) .

(45)

17

From (45), an expression for the variance of the elements of ∆x(i)

k , i.e., α(i)

k can be found as

α(i)
k

2(cid:27) =Z |∆x|2 p∆x
, E(cid:26)(cid:12)(cid:12)(cid:12)h∆x(i)
k in(cid:12)(cid:12)(cid:12)
= Zx∈χ Z |x − η (x − e)|2 pe(i)
= Zx∈χ Z |x − η (x − e)|2 pe

k ,xk

(i)
k

(∆x)d∆x

(i)
k

(e, x) de dx

(e) pxk (x) de dx

(46)

k

k

(·), p∆x(i)

k , and xk, respectively, and pe(i)

(·), and pxk (·) are the probability density functions of the elements of e(i)
where pe(i)
k ,
∆x(i)
(·) is the joint density function of the random variables
e(i)
k and xk. The latter has been written as the product of their individual distributions in the
ﬁnal expression of (46), due to the simpliﬁcation (S1).

k ,xk

When the elements of xm are uniformly distributed and take values from a unit-power P -
quarternary amplitude modulation (QAM) constellation, then under the assumption that the
symbol errors in ∆x(i)
k are dominated by the closest neighboring symbols, the expression for
α(i)
m can be written as

24

√P(√P +1)

Q r 3

m ! ,

I (i)

(P −1)

α(i)

m =

1,

i ≥ 1

i = 0

(47)

where Q (·) is the Q-function. The detailed derivation of the above expression can be found in
Appendix C.

C. Choice of the Set of Users U (i)

m

Let S be a set of the KL users in the system and let P (S) be its power set. In addition, for
m in
m can be obtained by solving the following optimization

the sake of clarity, let the additional argument U (i)
this section. Then, the optimal set U (i)
problem

m be added to the functions I (i)

m and ψ(i)

Substituting (44) in (48) yields

U (i)
m = arg min

U (i)
m = arg min

U∈P(S)(cid:8)I (i)
U∈P(S)(cid:8)ψ(i)

m (U)(cid:9) .
m (U)(cid:9) .

(48)

(49)

Now, ψ(i)

m (U) can be rewritten as

where c, ξk, and ǫ(i)

k (U) are deﬁned as

ψ(i)
m (U) = c +

+ǫ(i−1)

k (U)1{k∈U ,k<m}

c , Mσ2
Cuλ2

ξk , M 2ρ2
k
Cuλ2

k

N−1Xk=0nξk1{k /∈U} + ǫ(i)
(U)1{k∈U ,k≥m}o
m N−1Xn=0
βn!
m(β2
m(β2
k (cid:17)M 2
+(cid:16)1 + α(i)

N−1Xn=0
N−1Xn=0
k (U)

M 2ρ2
k
Cuλ2

kα(i)

1
M

k +

ψ(i)

k +

ǫ(i)
k (U) ,

βnβk)

1
M

.

βnβkα(i)
k

18

(50)

(51)

(52)

(53)

(54)

(55)

(56)

(57)

It can be seen from (50) that the optimization problem (49) is separable over the user indices,
implying that the decision to include the kth user in U (i)
m is independent of the other N − 1 users.
Therefore, the channel and data estimates of the kth user are needed in the ith iteration if the

following condition is satisﬁed

From (50) and (54), the set U (i)

m iﬀ ψ(i)

k ∈ U (i)
m is obtained as
m =nk ∈ N ǫ(i)
U (i)

and ǫ(i−1)

k

m

m

.

< ψ(i)

m(cid:12)(cid:12)k /∈U (i)

m(cid:12)(cid:12)k∈U (i)
(U) < ξk when k ≥ mo .

k (U) < ξk when k < m

Equivalently, using (52) and (53), the above expression simpliﬁes to

where

k

and α(i−1)

m =nk ∈ N α(i)
U (i)
, (β2
(β2

k + 1
M

k + 1
M

γ(i)
k

N−1Pn=0
N−1Pn=0

k < γ(i)

k when k < m

< γ(i−1)

k

βkβn −

βkβn +

ψ(i)

when k ≥ mo
k (cid:12)(cid:12)k∈U
M 2 )
k (cid:12)(cid:12)k∈U
M 2 ) .

ψ(i)

(i)
m

(i)
m

If xm takes values from the P -QAM constellation, after substituting (47) in (56), the set U (i)
can be obtained as

m

19

m =nk ∈ N I (i)
U (i)
and I (i)

k < f (i−1)

k

k < f (i)

k when k < m

when k ≥ mo
√P(cid:16)√P + 1(cid:17) γ(i)


24

k

Q2

where f (i)
k

is deﬁned as

f (i)
k

,

3

P − 1

(58)

(59)

(60)

However, it is worth commenting that the reliability of the decision rule in (56) decreases with

increasing user and iteration indices, since the decision rules are based on approximate SINR
expressions. Alternatively, a ﬁxed and conservative decision rule can be used to obtain U as
follows

Uﬁxed =(cid:8)m ∈ N I (2)

m ({m}) < I (2)

m (∅) = I (1)

m (∅)(cid:9)

The decision rule in (60) results in a set Uﬁxed that is computed at the beginning of the ﬁrst
iteration and is unchanged for the subsequent iterations.

A. Complexity of the non-iterative and iterative methods

VI. REMARKS

From (11) the non-iterative method for channel estimation has a per-user complexity of O(Cu),
whereas the MF operation and hard-decision operations in (12) and (13) have complexities of
O(M) and O(Cu), respectively. The complexity for the non-iterative method is similar to that
of the LS method for conventional pilots.

For the iterative method with ν iterations, the channel estimator, matched ﬁlter, and hard-

decision device have a combined complexity of O(νM + νCu).

B. Variable-length Uplink Slots for Variable Mobility

We build upon the discussion in [1] on grouping users based on their coherence times. While

such a grouping does not offer any performance beneﬁts to users when employing the approach

in [1], the use of superimposed pilots offers low-mobility users an increase in throughput, by

20

minimizing the channel estimation error resulting from transmitting the data alongside the pilots.

This improvement in performance is a direct consequence of Theorem 2.

In addition, the type of pilot transmitted by a user can also be chosen based on the coherence

time. While users with high-mobility or low pilot contamination would ﬁnd it sufﬁcient to use

conventional pilots, users with low-mobility who suffer from signiﬁcant pilot contamination

due to their proximity to the cell-edge or due to shadowing would signiﬁcantly beneﬁt from

employing superimposed pilots.

VII. SIMULATION RESULTS

We compare the SINR and bit-error rate (BER) performance of the LS-based and eigenvalue

decomposition (EVD) based methods that use conventional pilots to the performance of the chan-

nel estimator that uses superimposed pilots. Two scenarios are considered for this comparison.

1) Scenario 1 : The users are uniformly distributed in hexagonal cells of radius 1km.

2) Scenario 2 : The users are assumed to be in a ﬁxed conﬁguration and are spaced at equal

intervals on a circle of radius 800m from the BS. The cells have a radius of 1km. This

scenario emphasizes the effect of pilot contamination on users that are at the edge of the

cell.

In both scenarios, L = 7 cells are considered with K = 5 users per cell. A 4-QAM constellation is

employed and the path-loss coefﬁcient is assumed to be 3. The simulations for the superimposed

pilots based channel estimation scheme have been performed for 3 iterations. The duration of
the uplink time slot Cu is set to 100 symbols.

In Fig. 2, the cumulative distribution of the SINR has been plotted for Scenario 1, wherein

the users are distributed uniformly across the cell. While the LS based method employing

conventional pilots have a higher SINR than the LS method employing superimposed pilots

with a probability of approximately 0.6, the latter method is seen to offer a signiﬁcantly higher

minimum SINR compared to the former method. Moreover, the users employing superimposed

pilots have a smaller variation in their SINR than those employing conventional pilots. The

iterative method based on superimposed pilots is observed to offer a remarkably higher SINR

performance over all user-location realizations with respect to its non-iterative counterpart and

the LS based method employing conventional pilots.

21

SP-Optimal U (i)
SP-Non-iterative
CP-LS Based Estimate

j

y
t
i
l
i
b
a
b
o
r
P

e
v
i
t
a
l
u
m
u
C

1

0.8

0.6

0.4

0.2

0

−5

0

10
5
SINR (dB)

15

20

Fig. 2. Cumulative distribution of the SINR in dB for users in Scenario 1. The purple line indicates the ≥ 0.95 probability

SINRs.

In Fig. 3 the variation of the SINR with respect to M of an arbitrary user is shown at the

SNR of 10dB in Scenario 2. The SINR of the proposed method is shown to linearly increase

in the number of antennas, whereas the SINR performance is observed to saturate for the LS

based method. This trajectory of the proposed method could be potentially maintained using

techniques such as adaptive modulation and coding, thereby implying that the effects of pilot

contamination could be eliminated.

In Figs. 4 and 5, the BER is plotted for different values of M at the SNR of 10dB in both

Scenarios 1 and 2, respectively. The BER of the proposed scheme is signiﬁcantly lower than the

BER of the LS and EVD-based methods.

VIII. CONCLUSION

We have proposed superimposed pilots as a superior alternative to time-multiplexed data and

pilots for uplink channel estimation in massive MIMO. In the limit of an inﬁnite number of

antennas, a hybrid system using both superimposed pilots and conventional time-multiplexed

data and pilots offers a higher UL rate and supports larger number of users than the optimal

system that only utilizes conventional time-multiplexed data and pilots. In addition, a system

that only uses superimposed pilots beneﬁts from a higher value of Cu, with its performance

R
N
I
S

30

25

20

15

10

5

0

22

SP- Ufixed -Simulation
SP- Ufixed -Theoretical
SP-Optimal U (i)

SP-Optimal U (i)
CP - LS Based Estimate

m -Simulation
m -Theoretical

100

200

300

400

500

600

M

Fig. 3. Comparison of the SINR of a user vs. M in the reference BS for the LS based and proposed schemes at 10dB SNR

in Scenario 2.

R
E
B

10−1

10−2

10−3

10−4

10−5

10−6

10−7

m - Simulation

SP-Optimal U (i)
EVD based method in [13]
CP - LS based Estimate

100

200

300

400

500

600

M

Fig. 4. Comparison of the BER vs. M in the reference BS for the LS based and proposed schemes at 10dB SNR in Scenario

1.

superseding that of a system that only employs conventional pilots, when Cu exceeds a threshold
that is dependent on the channel scenario.

The resilience to pilot contamination can be signiﬁcantly improved with superimposed pilots

through the use of an iterative data-aided channel estimation scheme that utilizes the data

23

10−1

10−2

R
E
B

10−3

10−4

10−5

m - Simulation

SP-Optimal U (i)
EVD based method in [13]
CP - LS Based Estimate

100

200

300

400

500

600

M

Fig. 5. Comparison of the BER vs. M in the reference BS for the LS based and proposed schemes at 10dB SNR in Scenario

2.

symbols of both the desired and interfering users in the feedback loop. Computer simulations

in both a realistic scenario, in which users are distributed uniformly over the entire cell, and a

high-interference scenario, in which users are concentrated at the cell edge, show that channel

estimation methods using superimposed pilots offer a signiﬁcant performance improvement over

those that use conventional pilots.

Uplink SINR of the Non-Iterative Channel Estimation Method

APPENDIX A

Without loss of generality and for the sake of clarity, we replace the indices ℓ, k in (9) with a
single index m that lies in the range 0 ≤ m ≤ N − 1, where N , KL. In addition, the index j
is dropped and the channel and data are implicitly assumed to be estimated at the jth BS. Now,

(9) can be rewritten as

Y =

N−1Xm=0

hm (ρmxm + λmpm)T + W

(61)

From (11), the estimation error of the channel estimate can be obtained as

From (12) and (62), the estimate of the received data after MF with the estimated channel can

be written as

24

(62)

(63)

(64)

(65)

(66)

(67)

(68)

(69)

(70)

∆hm , hm −bhm
Cuλm N−1Xk=0

= −

1

ρkhkxT

k + W! p∗m .

m(cid:17)
m(cid:16)Y − λmbhmpT

m(cid:1)
m − ∆hH

hk (ρkxk + λkpk)T + W

m =

exT

=

1

1

MρmβmbhH
Mρmβm(cid:0)hH
× N−1Xk=0

−λm (hm − ∆hm) pT

m(cid:1) = sT + iT

where s and i are the signal and interference components of the matched ﬁltered signal, respec-

tively, and are given as

s , xm

i ,

t1 ,(cid:18)khmk2

tn

5Xn=1
Mβm − 1(cid:19) xm +
mW(cid:1)T
Mρmβm(cid:0)hH

1

λm

hH

m∆hmpm

+

Mρmβm

t2 ,

hH
mhn
Mρmβm

N−1Xn=0

n6=m

(λnpn + ρnxn)

t3 , −

1

Mβm

∆hH

mhmxm

t4 , −

1

Mρmβm

λm

t5 , −

Mρmβmk∆hmk2pm .

∆hH

mhn (λnpn + ρnxn) −(cid:0)∆hH

mW(cid:1)T

Mρmβm

N−1Xn=0

n6=m

The average interference power can be found as

Now, using the deﬁnitions of tn,∀ n = 1, . . . , 8 in (66) – (70) and the deﬁnition of ∆hm in
(62), the following expressions can be easily obtained

25

(71)

(72)

(73)

(74)

(75)

(76)

(77)

(78)

(79)

(80)

2
tn(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
M(cid:19)
βnµn + o(cid:18)Cu

ρ2
kβnβkµn
Mλ2
mβ2
m

mρ2

+

n6=m

nµnβ2
ρ2
n
λ2
mρ2
mβ2
m

N−1Xn=0
+ o(cid:18) N
M(cid:19)
+ o(cid:18) N
Cu(cid:19)
+ o(cid:18) N
Cu(cid:19)

n6=m

ρ2
m
λ2
m

5Xn=1

Cu
Mρ2
mβm

E(cid:8)kik2(cid:9) = E
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
N−1Xn=0
E(cid:8)kt1k2(cid:9) =
E(cid:8)kt2k2(cid:9) = 1 + o(cid:18) N
M(cid:19)
+ o(cid:18) N
M(cid:19)
E(cid:8)kt3k2(cid:9) =
N−1Xn=0
N−1Xk=0
E(cid:8)kt4k2(cid:9) =
N−1Xn=0
N−1Xp=0
N−1Xp=0
N−1Xn=0
E(cid:8)kt5k2(cid:9) =
En(t3 + t4)H t5o = −
N−1Xp=0
N−1Xn=0
M(cid:19)
1 t2(cid:9) = o(cid:18) N
E(cid:8)tH
3 t4(cid:9) = o(cid:18) N
Cu(cid:19)
E(cid:8)tH

ρ2
nρ2
Cuλ2

ρ2
nρ2
Cuρ2

n6=m

k6=n

n6=m

p6=m

n6=p

n6=p

+

pβpβn
mλ2
mβ2
m

pβnβp
mβ2
mρ2
m

ρ2
nρ2
Cuλ2

pβnβp
mβ2
mρ2
m

The remaining terms of the form tH

n tp,∀ n 6= p in the expansion of (71) are zero. If M is large
with respect to N, then the terms that are o (N/M) can be neglected. Terms that are o(N/Cu)
are at most o(1) and can also be dropped. In addition, if σ2 ≪ Cu, then the effect of noise can
also be neglected. Then, substituting (72) – (78) in the expansion of (71), the interference power

is obtained as

E(cid:8)kik2(cid:9) ≈

+

N−1Xn=0
N−1Xn=0

n6=m

nµnβ2
ρ2
n
λ2
mρ2
mβ2
m

+

Cuβnµn
Mρ2
mβm

N−1Xn=0

n6=m

ρ2
kβnβkµn
Mλ2
mβ2
m

mρ2

.

N−1Xk=0

k6=n

Using (81), the SINR can be obtained as

SINRSP−ul

m

,

E{ksk2}
E{kik2}

Cu

Cuβnµn
M ρ2
mβm

=

nµnβ2
ρ2
n
λ2
mρ2
mβ2
m

N−1Pn=0

N−1Pn=0
n6=m
In addition, for M → ∞, the SINR becomes
=

SINRSP−ul

+

m
M→∞

1
Cuλ2
mρ2
m

It completes the derivation of (14).

.

ρ2
kβnβkµn
M λ2
mβ2
m

mρ2

+

N−1Pn=0

n6=m

N−1Pk=0

k6=n

.

ρ2
nµnβ2
n

β2
m

N−1Pn=0

Interference Power of the Iterative Method

APPENDIX B

26

(81)

(82)

(83)

To derive the SINR, using the deﬁnition of ∆x(i)

m , the channel estimate in (41)

(84)

can be simpliﬁed as

m , xm −bx(i)
k (cid:17)T
k (cid:16)bx(i)
ρkbh(i)

k∈Uj

1

Cuλm


N−1Xk=0
(cid:17)T
(cid:16)bx(i−1)

k

ρkhkxk−

m−1Xk=0
+ Wj p∗m

k

ρkbh(i−1)

m = hm +

bh(i)
N−1Xk=m

−

k∈Uj

+ ∆h(i)

k xT

k

∆h(i)

m = −

− ∆h(i)

k (cid:16)∆x(i)

1

k∈Uj

Cuλm


m−1Xk=0
k (cid:17)T(cid:27) +

ρk(cid:26)hk(cid:16)∆x(i)
k (cid:17)T
ρk(cid:26)hk(cid:16)∆x(i−1)
(cid:17)T
N−1Xk=m
(cid:17)T(cid:27) +
(cid:16)∆x(i−1)
N−1Xk=0
k − ∆h(i−1)
xT

k∈Uj

k

k

k

k /∈Uj

+∆h(i−1)

k

+W!p∗m .

ρkhkxT
k

hk(ρkxk + λkpk)T

The received symbols after MF in (42) are then given as

where

where

hH

mhk (ρkxk + λkpk)

1

=

ak

k6=m

a2 , 1

a1 , 1
Mρm

Mρm(cid:16)hH

m(cid:1)H(cid:17) N−1Xk=0
m(cid:1) pm(cid:1)

m−(cid:0)∆h(i)
bxm =
+W − λm(cid:0)hm − ∆h(i)
7Xk=1
1
M khmk2xm +
N−1Xk=0
Mρm(cid:0)hH
mW(cid:1)T
M (cid:0)∆h(i)
m(cid:1)H
N−1Xk=0
k6=m(cid:0)∆h(i)
m(cid:1)H
Mρm(cid:16)(cid:0)∆h(i)
W(cid:17)T
m(cid:1)H
m(cid:13)(cid:13)2
Mρm(cid:13)(cid:13)∆h(i)

a6 , −
a7 , −

a4 , −

hH
m∆h(i)

m pm

a5 , −

λm
Mρm

hmxm

a3 ,

Mρm

pm .

λm

1

1

1

hk (ρkxk + λkpk)

27

(85)

(86)

(87)

(88)

(89)

(90)

(91)

(92)

(93)

Under the assumption that the interference power at each of the received symbols is the same,

28

the average interference power of the mth user at the jth cell is given as

where the terms a6, a7, and aH
forwardly that

Moreover, E{ka3k2}, E{ka4k2}, and E{ka5k2} can be written as
hmo
mp∗m(cid:0)∆h(i)
m(cid:1)H
mo
mo

Cuλ2
m
M 2ρ2
m

λ2
m
M 2ρ2
m

mx∗mhH

m∆h(i)

m∆h(i)

m∆h(i)

1
M 2

hmhH

hmxT

m pT

=

βkβm

1
Cu

1

(95)

(96)

k6=m

.

Cu
Mρ2
m

N−1Xk=0

I ul
m(i) =

Cuσ2βm
Mρ2
m

kakk2)#

Cu"E( 5Xk=1

E
2 ≈
ak(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
7Xk=1
p aq, ∀p, q have been dropped. Further, it can be shown straight-
E(cid:8)ka1k2(cid:9) =
E(cid:8)ka2k2(cid:9) =
EnhH
E(cid:8)ka3k2(cid:9) =
En(cid:0)∆h(i)
m(cid:1)H
En(cid:0)∆h(i)
m(cid:1)H
E(cid:8)ka4k2(cid:9) =
mx∗m(cid:9) En(cid:0)∆h(i)
E(cid:8)xT
m(cid:1)H
En(cid:0)∆h(i)
mo
m(cid:1)H
En(cid:0)∆h(i)
mo
N−1Xk=0
N−1Xℓ=0
E(cid:8)ka5k2(cid:9) =
m(cid:1)H
× En(ρℓxℓ + λℓpℓ)H (ρkxk + λkpk)o
m
E(cid:0)∆h(i)
k ∆h(i)
m(cid:1)H
kakk2) =
E( 5Xk=3
× E((cid:0)∆h(i)
m) .
k! ∆h(i)

m(cid:1)H N−1Xk=0

1
M 2
Cu
M 2

Cu
M 2ρ2
m

Cu
M 2ρ2
m

N−1Xk=0

mo

m∆h(i)

hℓhH

k ∆h(i)

hmhH

m∆h(i)

ℓ6=m

k6=m

M 2ρ2
m

hkhH

.

(97)

(98)

=

=

=

hkhH

(100)

hmhH

(94)

(99)

and

1

Summing up (97), (98) and (99), we obtain

k6=m

Now, let ψ(i)

m be deﬁned as the second term in (100), i.e.,

Using (85) and the simpliﬁcations (S1) to (S4), (101) can be simpliﬁed as

m) .
n! ∆h(i)

hnhH

kα(i)

k +

βnβkα(i)
k

1
M

N−1Xn=0
βnβk)
N−1Xn=0

k +

1
M

ψ(i)

+

ρ2

ρ2

ψ(i)

k∈Uj

ψ(i)

M 2
Cuλ2
m

, E((cid:0)∆h(i)
m(cid:1)H N−1Xn=0
m(cid:12)(cid:12)i≥1

k(β2
m−1Xk=0
m(cid:12)(cid:12)i≥1 =
k (cid:17)M 2
+(cid:16)1 + α(i)
k 
k(β2
N−1Xk=0
k(β2
N−1Xk=m
N−1Xn=0
(cid:17)M 2
+(cid:16)1 + α(i−1)
k 
N−1Xk=0

I ul
m(i) ≈

kα(i−1)

ψ(i−1)

Mρ2
m

1
M

k∈Uj

k /∈Uj

+

k

+

ρ2

k

k6=m

βnβkα(i−1)

k

+

σ2

M  N−1Xn=0

βn! .

Substituting (95), (96), (100), and (102) in (94), I ul
βkβm +

1

m(i) can be obtained as

σ2βm
Mρ2
m

+

1

M 2ρ2
m

ψ(i)

m .

It completes the derivation of (44).

Derivation of α(i)

m for a P -QAM constellation

APPENDIX C

29

(101)

(102)

(103)

(105)

For P -QAM constellation and i ≥ 1, the integral over xm in (46) reduces to a summation,

which can be written as

α(i)

m =Xx∈χZ |x − η (x − e)|2 pe(i)

m

(e) pxm (x) de dx .

(104)

Since the P symbols are equally likely, pxm(x) = 1/P, ∀ x and under the assumption that
the errors x − η (x − e) are dominated by the closest neighboring symbols, the above equation
reduces to

α(i)

m =

1

P Xx∈χ

d2

xkxQ

dx

2qI ul

m(i)
2



where dx is the distance between the symbol x and its closest neighbor, and kx is the number
of symbols at a distance of dx from x. The Q-function in the above equation results from the
assumption on the statistics of e(i)

m . For a unit-power P -QAM constellation, dx =p6/P − 1, ∀x
(√P − 2)4 symbols on the outer edges, and kx = 4 for the remaining P − 4√P + 4 symbols.

[23]. In addition, it can be easily veriﬁed that kx = 2 for the 4 corner symbols, kx = 3 for the

Substituting these values into (105) yields

α(i)

m(cid:12)(cid:12)i≥1 =

24

m(i) .
√P(cid:16)√P + 1(cid:17) Qs 3

(P−1)
I ul

30

(106)

Moreover, since ∆x(0)
derivation of (47).

ℓ,m = xℓ,m, the value of α(0)

m at the 0th iteration is 1. It completes the

REFERENCES

[1] T. Marzetta, “Noncooperative cellular wireless with unlimited numbers of base station antennas,” IEEE Trans. Wireless

Commun., vol. 9, no. 11, pp. 3590–3600, Nov. 2010.

[2] F. Boccardi, R. Heath, A. Lozano, T. Marzetta, and P. Popovski, “Five disruptive technology directions for 5G,” IEEE

Commun. Mag., vol. 52, no. 2, pp. 74–80, Feb. 2014.

[3] E. Larsson, O. Edfors, F. Tufvesson, and T. Marzetta, “Massive MIMO for next generation wireless systems,” IEEE

Commun. Mag., vol. 52, no. 2, pp. 186–195, Feb. 2014.

[4] J. Andrews, S. Buzzi, W. Choi, S. Hanly, A. Lozano, A. Soong, and J. Zhang, “What will 5G be?” IEEE J. Sel. Areas

Commun., vol. 32, no. 6, pp. 1065–1082, Jun. 2014.

[5] L. Lu, G. Li, A. Swindlehurst, A. Ashikhmin, and R. Zhang, “An overview of massive MIMO: Beneﬁts and challenges,”

IEEE J. Sel. Topics Signal Process., vol. 8, no. 5, pp. 742–758, Oct. 2014.

[6] F. Rusek, D. Persson, B. K. Lau, E. Larsson, T. Marzetta, O. Edfors, and F. Tufvesson, “Scaling up MIMO: Opportunities

and challenges with very large arrays,” IEEE Signal Process. Mag., vol. 30, no. 1, pp. 40–60, Jan. 2013.

[7] J. Hoydis, S. ten Brink, and M. Debbah, “Massive MIMO in the UL/DL of cellular networks: How many antennas do we

need?” IEEE J. Sel. Areas Commun., vol. 31, no. 2, pp. 160–171, Feb. 2013.

[8] H. Yang and T. Marzetta, “Performance of conjugate and zero-forcing beamforming in large-scale antenna systems,” IEEE

J. Sel. Areas Commun., vol. 31, no. 2, pp. 172–179, Feb. 2013.

[9] H. Q. Ngo, E. Larsson, and T. Marzetta, “Energy and spectral efﬁciency of very large multiuser mimo systems,” IEEE

Trans. Commun., vol. 61, no. 4, pp. 1436–1449, Apr. 2013.

[10] E. Bjornson, J. Hoydis, M. Kountouris, and M. Debbah, “Massive MIMO systems with non-ideal hardware: Energy

efﬁciency, estimation, and capacity limits,” IEEE Trans. Inf. Theory, vol. 60, no. 11, pp. 7112–7139, Nov. 2014.

[11] J. Jose, A. Ashikhmin, T. Marzetta, and S. Vishwanath, “Pilot contamination and precoding in multi-cell TDD systems,”

IEEE Trans. Wireless Commun., vol. 10, no. 8, pp. 2640–2651, Aug. 2011.

[12] H. Q. Ngo and E. Larsson, “EVD-based channel estimation in multicell multiuser MIMO systems with very large antenna

arrays,” in Proc. IEEE Int. Conf. on Acoustics, Speech and Signal Processing (ICASSP), Kyoto, Mar. 2012, pp. 3249–3252.

31

[13] R. Muller, L. Cottatellucci, and M. Vehkapera, “Blind pilot decontamination,” IEEE J. Sel. Topics Signal Process., vol. 8,

no. 5, pp. 773–786, Oct. 2014.

[14] H. Yin, D. Gesbert, M. Filippou, and Y. Liu, “A coordinated approach to channel estimation in large-scale multiple-antenna

systems,” IEEE J. Sel. Areas Commun., vol. 31, no. 2, pp. 264–273, Feb. 2013.

[15] K. Upadhya and S. A. Vorobyov, “An array processing approach to pilot decontamination for massive MIMO,” in Proc.

IEEE 6th Int. Workshop on Computational Advances in Multi-Sensor Adaptive Processing (CAMSAP), Cancun, Dec. 2015.

[16] E. Bjornson, E. Larsson, and M. Debbah, “Massive MIMO for maximal spectral efﬁciency: How many users and pilots

should be allocated?” IEEE Trans. Wireless Commun., to be published.

[17] S. He, J. Tugnait, and X. Meng, “On superimposed training for MIMO channel estimation and symbol detection,” IEEE

Trans. Signal Process., vol. 55, no. 6, pp. 3007–3021, Jun. 2007.

[18] M. Coldrey and P. Bohlin, “Training-based MIMO systems – part I: Performance comparison,” IEEE Trans. Signal Process.,

vol. 55, no. 11, pp. 5464–5476, Nov. 2007.

[19] H. Zhu, B. Farhang-Boroujeny, and C. Schlegel, “Pilot embedding for joint channel estimation and data detection in MIMO

communication systems,” IEEE Commun. Lett., vol. 7, no. 1, pp. 30–32, Jan. 2003.

[20] T. Cui and C. Tellambura, “Pilot symbols for channel estimation in OFDM systems,” in Proc. IEEE Global Telecommu-

nications Conf. (GLOBECOM), St. Louis, vol. 4, Dec. 2005, pp. 5 pp.–2233.

[21] H. Zhang, S. Gao, D. Li, H. Chen, and L. Yang, “On superimposed pilot for channel estimation in multi-cell multiuser

MIMO uplink: Large system analysis,” IEEE Trans. Veh. Technol., to be published.

[22] K. Upadhya, S. A. Vorobyov, and M. Vehkaper¨a, “Superimposed pilots: An alternative pilot structure to mitigate pilot

contamination in massive MIMO,” in Proc. IEEE Int. Conf. on Acoustics, Speech and Signal Processing (ICASSP), Accepted,

2016.

[23] J. Proakis and M. Salehi, Digital Communications. McGraw-Hill, 2008.

