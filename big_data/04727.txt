6
1
0
2

 
r
a

 

M
5
1

 
 
]
h
p
-
m
s
a
l
p

.
s
c
i
s
y
h
p
[
 
 

1
v
7
2
7
4
0

.

3
0
6
1
:
v
i
X
r
a

Gyrokinetic simulations of fusion

plasmas using a spectral velocity space

representation

Joseph Parker
Brasenose College
University of Oxford

A thesis submitted for
Doctor of Philosophy

Trinity 2015

Abstract

Magnetic conﬁnement fusion reactors suffer severely from heat and particle
losses through turbulent transport, which has inspired the construction of ever
larger and more expensive reactors. Numerical simulations are vital to their
design and operation, but particle collisions are too infrequent for ﬂuid descrip-
tions to be valid. Instead, strongly magnetised fusion plasmas are described by
the gyrokinetic equations, a nonlinear integro-differential system for evolving
the particle distribution functions in a ﬁve-dimensional position and velocity
space, and the consequent electromagnetic ﬁeld. Due to the high dimension-
ality, simulations of small reactor sections require hundreds of thousands of
CPU hours on cutting-edge High Performance Computing platforms.

We develop a Hankel–Hermite spectral representation for velocity space that
exploits structural features of the particle streaming, gyroaveraging, and colli-
sion terms in the gyrokinetic system. This representation exactly conserves a
discrete free energy in the absence of explicit dissipation, while our Hermite
hypercollision operator captures Landau damping with as few as ten variables.
Calculation of the electromagnetic ﬁelds also becomes purely local. This
eliminates all inter-processor communication in, and hence vastly accelerates,
searches for linear instabilities. We implement these ideas in SPECTROGK, an
efﬁcient parallel code.

Turbulent fusion plasmas may dissipate free energy through linear phase mix-
ing to ﬁne scales in velocity space, as in Landau damping, or through a non-
linear cascade to ﬁne scales in physical space, as in hydrodynamic turbulence.
Using SPECTROGK to study saturated electrostatic drift-kinetic turbulence in
Cartesian geometry, we ﬁnd that the nonlinear cascade completely suppresses
linear phase mixing at energetically-dominant scales, so the turbulence is ﬂuid-
like. We use these observations to derive Fourier–Hermite spectra for the
electrostatic potential and distribution function, and conﬁrm these spectra with
SPECTROGK simulations.

Contents

I

Introduction

1 Fusion, turbulence, and gyrokinetic theory

1

. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.1 Motivation . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Nuclear fusion .
1.3 Turbulence
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
1.4 Fluid, kinetic and gyrokinetic theory . . . . . . . . . . . . . . . . . . . . .
1.5 Numerical methods for the gyrokinetic equations

2
2
3
5
7
. . . . . . . . . . . . . . 11

. .
.
.

.
.
.

.
.
.

.

2 Gyrokinetic-Maxwell system

.

.

.

.

2.1 Preliminaries

.
δf ordering .

16
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.1.1 Gyrokinetic–Maxwell equations . . . . . . . . . . . . . . . . . . . 18
Small scale averaging . . . . . . . . . . . . . . . . . . . . . . . . . 19
2.1.2
2.1.3 Geometry .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
2.1.4
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
2.1.5 Gyrokinetic variables . . . . . . . . . . . . . . . . . . . . . . . . . 23
2.1.6 Nondimensionalization . . . . . . . . . . . . . . . . . . . . . . . . 26
2.2 Derivation of slab gyrokinetic equations . . . . . . . . . . . . . . . . . . . 30
2.2.1 Maxwell’s equations . . . . . . . . . . . . . . . . . . . . . . . . . 33
.
2.2.2
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
2.3.1 Electrostatic invariant . . . . . . . . . . . . . . . . . . . . . . . . . 38
2.4 Computational forms of the gyrokinetic equations . . . . . . . . . . . . . . 38
2.4.1 Complementary distribution function . . . . . . . . . . . . . . . . 39
2.4.2
Fourier space representation . . . . . . . . . . . . . . . . . . . . . 39
Simpliﬁed equations . . . . . . . . . . . . . . . . . . . . . . . . . 42
2.4.3

Summary .
. .

2.3 Free energy . .

i

II Numerical Methods

45

3 Parallel velocity space and the Hermite spectral representation

3.2 Collisions .

.

.

.

.

.

46
3.0.1 Landau damping . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
3.0.2 Landau damping in a discrete system . . . . . . . . . . . . . . . . 52
3.1 Hermite representation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
3.1.1 Hermite functions . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
3.1.2 Truncated Hermite series . . . . . . . . . . . . . . . . . . . . . . . 57
3.1.3 Hermite system . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
3.1.4 Hermite representation of a Case–Van Kampen mode . . . . . . . . 61
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
3.2.1 The Landau collision operator and its properties . . . . . . . . . . . 63
3.2.2 The Lenard–Bernstein and Kirkwood collision operators . . . . . . 65
3.2.3 The linearized Kirkwood collision operator
. . . . . . . . . . . . . 66
3.2.4 Hypercollisions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
3.3 Theoretical Hermite spectra and the hypercollision plateau . . . . . . . . . 70
3.3.1 Theoretical Hermite spectra . . . . . . . . . . . . . . . . . . . . . 71
3.3.2 Hypercollisional plateau against collisionality . . . . . . . . . . . . 72
3.3.3 Hypercollisional plateau against hypercollision exponent . . . . . . 77
3.3.4 Convergence with hypercollision parameters
. . . . . . . . . . . . 78
Initial value problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
3.4.1
. . . . . . . . . . . . . . . . 80
3.4.2 Wave analysis of the initial value problem . . . . . . . . . . . . . . 82
3.4.3 Eigenmode formation in the initial value problem . . . . . . . . . . 83
3.5 Arbitrary velocity space grids . . . . . . . . . . . . . . . . . . . . . . . . . 85
3.6 Summary .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

Solution by method of characteristics

3.4

. .

. .

4 Perpendicular velocity space and the Hankel transform

88
4.1 Continuous Hankel transform . . . . . . . . . . . . . . . . . . . . . . . . . 90
4.2 Discrete Hankel transform . . . . . . . . . . . . . . . . . . . . . . . . . . 91
4.3 Hankel space structure of gyrokinetics . . . . . . . . . . . . . . . . . . . . 93
4.4 Alternative Hankel treatments of perpendicular velocity space
. . . . . . . 95
4.4.1 Discretization in velocity space
. . . . . . . . . . . . . . . . . . . 97
4.4.2 Discretization in Hankel space . . . . . . . . . . . . . . . . . . . . 97
4.4.3
SPECTROGK discretization . . . . . . . . . . . . . . . . . . . . . 99

ii

5 SPECTROGK

101
5.1 Spectral gyrokinetic-Maxwell system . . . . . . . . . . . . . . . . . . . . 101
5.1.1
Full ﬁve-dimensional system . . . . . . . . . . . . . . . . . . . . . 102
5.1.2 Reduced four-dimensional system . . . . . . . . . . . . . . . . . . 105
5.2 Algorithm description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.2.1 ASTROGK .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.2.2 Time integration . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
5.2.3 Calculation of the electromagnetic ﬁeld . . . . . . . . . . . . . . . 110
5.2.4 Nonlinear term and dealiasing . . . . . . . . . . . . . . . . . . . . 112
5.2.5 Recurrence and velocity space dissipation . . . . . . . . . . . . . . 114
. . . . . . . . . . . . . . . 115
5.2.6 Data layout and parallelization scheme
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
5.3.1 Linear ITG .
5.3.2
Free energy conservation . . . . . . . . . . . . . . . . . . . . . . . 121
5.3.3 Antenna driving . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
5.3.4 Orszag–Tang vortex problem . . . . . . . . . . . . . . . . . . . . . 125
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
Single processor scaling . . . . . . . . . . . . . . . . . . . . . . . 125
Parallel performance . . . . . . . . . . . . . . . . . . . . . . . . . 127

5.3 Code veriﬁcation .

5.4 Performance .

5.4.1
5.4.2

. .

. .

III Results

129

.
.
.

.
.
. .
.
.

6 Suppression of Landau damping in saturated ITG-driven turbulence

130
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
.
6.1
Introduction .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
.
6.2 Drift kinetics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
.
6.3 Simulations .
6.4 Free energy transfer .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
6.5 Phase-mixing and anti-phase-mixing modes . . . . . . . . . . . . . . . . . 135
6.6 Critical balance .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
6.7 Hermite spectra and dissipation . . . . . . . . . . . . . . . . . . . . . . . . 137
6.8 Discussion .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

.

.

.

.

.

.

.

7 Phase space spectra for drift-kinetic turbulence

139
7.1 Derivation of scalings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
. . . . . . . . . . . . . . . 140
Spectrum for the electrostatic potential
Spectrum for the distribution function . . . . . . . . . . . . . . . . 141

7.1.1
7.1.2

iii

7.2 Observed spectra .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
7.2.1 Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
7.2.2 Electrostatic potential . . . . . . . . . . . . . . . . . . . . . . . . . 147
7.2.3 Distribution function . . . . . . . . . . . . . . . . . . . . . . . . . 147

8 Conclusion

8.1 Future work . .

. .

.

158
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161

IV Appendices

163

A Fourier–Hermite spectral representation for the Vlasov–Poisson system in the

weakly collisional limit
J. T. Parker and P. J. Dellar

B Irreversible energy ﬂow in forced Vlasov dynamics

G. G. Plunk and J. T. Parker

Bibliography

164

165

166

iv

List of Figures

1.1 Solution to the free streaming equation.

. . . . . . . . . . . . . . . . . . . 12

2.1 Periodic temperature ﬂuctuations about a macroscopic gradient.

. . . . . . 22

3.1

Integration contours for the plasma dispersion function, and growth rates
and eigenmodes for a na¨ıve velocity space discretization.

. . . . . . . . . . 49
. . 57
3.2 Hermite spectra for delta functions, and the Hermite cardinal functions.
3.3 Hermite spectra of growing and decaying eigenmodes.
. . . . . . . . . . . 61
3.4 Growth rates and Hermite spectra calculated with Kirkwood collisions. . . . 68
3.5 Growth rates and Hermite spectra calculated with hypercollisions.
. . . . . 70
3.6 Calculated Hermite spectra against theoretical spectra . . . . . . . . . . . . 73
. . . . . . . . . . . . . 74
3.7 The hypercollision plateau for different resolutions.
. . . . 75
3.8 Location of the largest term in the free energy dissipation spectrum.
3.9 The hypercollision plateau for different hypercollision exponents.
. . . . . 77
3.10 Convergence of growth rate calculation.
. . . . . . . . . . . . . . . . . . . 79
3.11 Free energy propagation with and without recurrence. . . . . . . . . . . . . 81
3.12 Time traces for free energies and their respective time derivatives.
. . . . . 84
3.13 Hypercollisional damping performed on a uniform grid. . . . . . . . . . . . 86

. . . . . . . . . . . . . . . . . . . . . 92
4.1 The ﬁrst six Hankel basis functions.
4.2 Possible discretizations in Hankel space. . . . . . . . . . . . . . . . . . . . 96
4.3 Contour of the integral K(k⊥, p, 5) from (4.27).
. . . . . . . . . . . . . . . 98
4.4 A k⊥–p grid masked around the line p = ρik⊥. . . . . . . . . . . . . . . . . 99

5.1 The dispersion relation for the ITG instability. . . . . . . . . . . . . . . . . 118
5.2 Convergence of linear growth rates with perpendicular velocity resolution. . 119
5.3 Testing the Hankel transform at points off the p-grid.
. . . . . . . . . . . . 120
5.4 Free energy conservation in a ﬁve-dimensional, two-species, nonlinear,

electrostatic gyrokinetic simulation.

. . . . . . . . . . . . . . . . . . . . . 122

v

5.5 Free energy conservation in ﬁve-dimensional, nonlinear, electrostatic ITG-

driven turbulence. . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
5.6 An Alfv´en wave driven by an external parallel current.
. . . . . . . . . . . 124
5.7 Contour plots for the Orszag–Tang test problem. . . . . . . . . . . . . . . . 126
5.8 SPECTROGK single processor scaling. . . . . . . . . . . . . . . . . . . . . 127
5.9 SPECTROGK strong and weak scalings.
. . . . . . . . . . . . . . . . . . . 128

6.1 Free energy transfer from ﬂuid to kinetic modes in saturated turbulence,

normalized to its value in a linear plasma.

. . . . . . . . . . . . . . . . . . 134

6.2 Free energy transfer from mode 100 to 101 in saturated turbulence, normal-

ized to its value in a linear plasma.

. . . . . . . . . . . . . . . . . . . . . . 136

6.3 Hermite spectra at ﬁxed k in the linear streaming dominated and nonlin-

earity dominated regions . . . . . . . . . . . . . . . . . . . . . . . . . . . 137

Isotropy of turbulence in the perpendicular plane.

. . . . . . . . . . . . . . 145
7.1
. . . . . . . . . . . . . . . . 146
7.2 Critical balance for the electrostatic potential.
7.3 Summed spectra for the electrostatic potential. . . . . . . . . . . . . . . . . 146
7.4 Spectrum Eϕ as a function of η = k4/3⊥ /k(cid:107). . . . . . . . . . . . . . . . . . . 148
7.5 Contours of E±
. . . . . . . . . . . . 150
7.6 Spectra of E±
. . . . . . . . . . . . . . . . . 152
7.7 Spectra of E±
. . . . . . . . . . . . . . . . . 153
7.8 Spectra of E±
. . . . . . . . . . . . . . . . . 155
7.9 Spectrum of E−
. . . . . . . . . . . . . . . . . . . . 156

m and the normalized free energy ﬂux.
m against k⊥ at ﬁxed k(cid:107) and m.
m against k(cid:107) at ﬁxed k⊥ and m.
m against m at ﬁxed k(cid:107) and k⊥.

m against η = k4/3⊥ /k(cid:107).

vi

Part I

Introduction

1

Chapter 1

Fusion, turbulence, and gyrokinetic
theory

1.1 Motivation
The world needs energy. Global energy consumption is around 6 × 1020 J per year—
an average power of 20 TW—with usage growing at around 2% per year.1 Indeed, even
though global consumption fell in 2009 as a result of the ﬁnancial crisis, consumption in
Asia and Oceania still grew by 5%—a salient reminder of the future pressures on energy
production from increasing consumption and population growth.

Current energy production is dominated by fossil fuels—oil, coal and natural gas—
which account for 87% of global production [2]. Producing energy by burning fossil fuels is
simple and cheap, but produces greenhouse gases like carbon dioxide, and other pollutants.
Moreover, reserves are limited. Estimates are very rough, relying on future consumption
and resource discovery, but proven reserves of coal will last 100 years at current production
rates, while oil and gas reserves will last 50 years [2].

The other contributions to global energy production are from hydroelectric power (7%),
nuclear ﬁssion (4%) and renewable energies (2%) [2]. Hydroelectric power is severely
limited by geography. Nuclear ﬁssion also has its problems, particularly with the need to
store radioactive waste, with political and security concerns, and with its susceptibility to
meltdown in the case of accident, attack or, as seen at Fukushima in 2011, natural disaster.
Renewable energies, like solar or wind, are still in their infancy. These struggle with cost
efﬁciency, and are only viable in the UK due to government subsidy.2

1Based on the U.S. Energy Information Administration’s estimates for the years 1980–2012. Global

consumption for 2012 quoted as 528.797 × 1015 Btu. [1]
nuclear ﬁssion (≥£33/MWh), gas (£4/MWh), oil (55p/MWh) and coal (20p/MWh) [3].

2Renewable energy is subsidized by the U.K. Government at £50 per MWh, compared to subsidies for

2

A better prospect for clean, safe and large-scale energy production is nuclear fusion.
Nuclear fusion could power the whole world using only a tiny fraction of the amount of
fuel required in nuclear ﬁssion or in burning fossil fuels. Fusion has no carbon dioxide
emissions, no meltdowns, and no radioactive waste (save decommissioned fusion reactors,
which would decay to safe levels after 50 years [4]). Instead its product is helium, which
is not only harmless and useful for applications like magnetic resonance imaging, but also
a ﬁnite commodity which is relatively scarce [5].

These are, unfortunately, the same arguments for fusion that have been made for the last
seventy years. But nuclear fusion’s now long-standing reputation as a promising future en-
ergy source belies the extraordinary progress made by fusion research. In the period 1970–
2000, the fusion triple product, the accepted measure of fusion performance, increased by
a factor of 10,000—a rate of improvement that outstrips Moore’s law for the growth of
the number of transistors on a chip [6]. While that technology transformed society with
personal computers and laptops and tablets and smartphones, nuclear fusion’s moment is
yet to come, awaiting an elusive further factor of 6 that would take the fusion triple product
from the current best performance into the realm of a viable fusion power plant [6].

1.2 Nuclear fusion

What are the methods, and challenges, of nuclear fusion? In nuclear fusion, we recreate
one of the simpler reactions which sustain the sun: deuterium–tritium fusion. When one
nucleus of deuterium and one of tritium fuse, they produce 17.6 MeV of energy divided
between the reaction products: a helium nucleus (with 3.5 MeV of kinetic energy) and a
neutron (with 14.1 MeV) [7]. Assuming a rate of 1021 reactions per second, only 10 mg
per second of fuel provides 1 GW of power [assuming 30% reactor efﬁciency, 8]. That
is, 3500 tonnes of fuel per year would power the whole world, equivalent to 8400 million
tonnes of oil [9]. Deuterium is readily available in seawater [10], and while tritium itself is
rare, it may be “bred” using lithium and the neutron produced in the reaction. Lithium too
is abundant in seawater [10].

We thus have a fuel cycle, and fuel which may be reﬁned from seawater. What is the
challenge? This: for the deuterium and tritium nuclei to fuse, they must have enough energy
to overcome their mutual electrostatic repulsion. This requires temperatures of around
107 K. No known material can withstand this temperature to conﬁne the fuel directly. Some
other method is required.

The most promising method exploits the full ionization of deuterium and tritium atoms
at these high temperatures. The electrons and ions dissociate to form a plasma, and in an

3

electromagnetic ﬁeld experience the Lorentz force

F s = qs

E +

v × B

c

(cid:18)

(cid:19)

,

(1.1)

where s denotes the particle species (ion i or electron e), qs and v are the particles’ charge
and velocity, E and B are the electric and magnetic ﬁelds, and c is the speed of light. We
use Gaussian units throughout this thesis. A particle in a strong magnetic ﬁeld (with no
electric ﬁeld, E = 0) is constrained to move helically around a magnetic ﬁeld line, with
frequency of gyration (cyclotron frequency, or gyrofrequency) Ωs = qsB/msc, where ms
is the particle mass and B = |B|. The radius of gyration (gyroradius) is ρs = v⊥/Ωs,
where v⊥ is velocity perpendicular to the magnetic ﬁeld. The particle’s motion remains
centred around this ﬁeld line, so the particle may be conﬁned if ﬁeld lines are made to form
closed surfaces. This is only possible for magnetic ﬁelds which are topologically a torus.

Thus in magnetic conﬁnement fusion, the plasma is conﬁned with a strong magnetic
ﬁeld designed to form layers of closed toroidal surfaces called ﬂux surfaces. There are
two main classes of magnetic conﬁnement fusion device: tokamaks (which are axisymmet-
ric about the central axis) and stellarators (which have more intricate non-axisymmetric
shapes). Tokamaks are the more common device, so toroidal geometry is prevalent in fu-
sion theory and simulations (and is used in popular codes such as GS2 and GENE, discussed
in Chapter 2).

The problem facing fusion devices is that their conﬁnement is not perfect. Two ef-
fects which degrade conﬁnement are collisions and particle drifts. Collisions cause par-
ticles to be knocked from their ﬁeld line onto another nearby, and so through multiple
collisions, particles can cross ﬂux surfaces and escape from the device. This process is
called “classical transport”. Classical transport alone does not present a problem.
In-
deed a typical tokamak volume of 10 m3 contains around 1022 particles, which collide
at a rate of roughly 4 × 1013 s−1cm−3. Thus each particle experiences collisions at a
c ∼ 4 × 10−2s−1. Each collision deﬂects a particle by a distance like the ion
rate τ−1
gyroradius, typically ρi ∼ 5 × 10−4m, so that the random walk diffusion coefﬁcient is
c ∼ 10−8m2s−1. Assuming a major radius of L ∼ 1m, the conﬁnement time is
D ∼ ρ2
i τ−1
τ ∼ L2/D ∼ 108s. That is, if affected by collisions alone, a particle at the core takes a few
years to leave the machine.

A more signiﬁcant effect occurs when collisions and particle drifts combine. Parti-
cle drifts are slow motions perpendicular to magnetic ﬁeld caused by perturbations to the
equilibrium electric and magnetic ﬁelds in Lorentz’s law (1.1). The primary drifts (which
we derive in §2.2) are the E × B drift due to perturbations to the electric ﬁeld caused by

4

motions of the particles, and the gradient-B and curvature drifts, which arise from inhomo-
geneities in the background magnetic ﬁeld [11]. Tokamaks are designed so that outwards
drifts will, on average, be countered by inwards drifts. The problem is rather the combi-
nation of collisions and drifts. A particle may drift outwards, collide with another particle
and be knocked onto a new ﬁeld line where it again drifts outwards. This process, called
“neoclassical transport”, is much more signiﬁcant than classical transport. Neoclassical
transport has been extensively studied [12] and good estimates may be derived for its size
in various simple fusion devices [13]. Indeed, neoclassical transport is controllable, and
even including its effect, we could achieve fusion in a reactor with a minor radius as small
as 1m [14]—a “table-top tokamak”. The reason we are yet to achieve sustainable fusion is
transport from an altogether different and less well-understood phenomenon, that of plasma
turbulence.

1.3 Turbulence

Turbulence is a ubiquitous phenomenon in liquids, gases and plasmas, appearing as an
erratic and quickly-evolving mixture of eddies, vortices and jets. In strongly magnetized
fusion plasmas, turbulence manifests itself as ﬂuctuations in the electromagnetic ﬁeld, and
in plasma properties like density and temperature. It is the ﬁeld ﬂuctuations which de-
grade conﬁnement. Magnetic ﬁeld perturbations may deform the background magnetic
ﬁeld, causing a very large loss of conﬁnement. Fortunately, this effect is minimal in the
current generation of machines as the particle pressure is never large relative to the mag-
netic pressure [15]. Rather the problem is electric ﬁeld perturbations which induce eddies
in the plasma ﬂow that lie across magnetic ﬁeld lines. These eddies rapidly convect parti-
cles across ﬂux surfaces, leading to turbulent transport an order of magnitude larger than
neoclassical transport.

Moreover, turbulence is driven by ion temperature gradients [16–23] and electron den-
sity and temperature gradients [24–26]. High pressure at the core of the machine, as re-
quired for fusion at a commercially viable rate, necessitates a strong pressure gradient be-
tween the core and the edge. But since pressure is the product of density and temperature,
large pressure gradients mean large density and temperature gradients, so we ﬁnd that tur-
bulence is driven by the very quantities we want to maximize. This leads to ever-increasing
machine sizes, since a larger machine means both that high core pressure can be achieved
with shallower gradients, and that particles must be transported further in order to escape

5

the device. This explains the planned 837 m3 volume of the ITER tokamak3 currently under
construction in Cadarache, France, over ﬁve times the volume of its predecessor, the Joint
European Torus (JET), located at Culham, U.K. Such large sizes bring a raft of problems.
For one, devices are so expensive as to be only feasible through large international collabo-
rations. For another, the increased machine size presents engineering problems associated
with large heat loads, neutron ﬂuxes and mechanical stresses on the tokamak’s material
wall.

To progress we must not only mitigate turbulence, but understand and control it. This is
now the focus of much experimental and theoretical work. Experimentalists have created
“transport barriers”, annular regions of laminar ﬂow about the tokamak core [29, 30]. By
their suppression of turbulence, these allow much steeper temperature gradients and there-
fore higher core pressures. Theoreticians too have studied mechanisms for suppressing
turbulence and creating transport barriers, such as shear ﬂow [31].

The nature of turbulence means progress with theory is very difﬁcult. Turbulence is
an inherently nonlinear phenomenon. Thus analytic solutions are rare, and understanding
comes from scaling theories and numerical simulations. Moreover, there are additional
problems particular to strongly magnetized plasma turbulence that do not arise in ﬂuid
turbulence.

Firstly, plasma turbulence spans multiple scales in space and time. The turbulent ﬂuctu-
ations depend on scale, and behaviour changes as the scale ﬁrst crosses the ion gyroscale ρi,
then the electron gyroscale ρe. These scales are well-separated from one another, ρi (cid:29) ρe,
and from the system size L (cid:29) ρi, the scale of bulk movement of the plasma. Similarly, the
typical timescale for plasma dynamics is well-separated from other timescales, being much
slower than the timescale Ω−1
for particle gyration, but much faster than the timescale τ
for transport and the background ﬁeld evolution.

s

In addition, plasma turbulence is kinetic. That is, it is characterized by effects—like
Landau damping discussed in Chapter 3—which must be explained in terms of the inter-
action of particles with the electromagnetic ﬁeld (a kinetic description), rather than solely
in terms of macroscopic variables, like density, momentum and temperature (a ﬂuid de-
scription). This means that kinetic models must include velocities, as well as positions, as
coordinates. Consequently kinetic models are higher-dimensional than ﬂuid models, and
thus much more computationally challenging.

3This formerly stood for “International Thermonuclear Experimental Reactor”, though there is no mention
It is widely held that the word “experimental” proved unpopular in the

of this in ofﬁcial literature [27].
context. Now the name is simply iter, “the way” in Latin [28].

6

1.4 Fluid, kinetic and gyrokinetic theory

We now discuss the mathematical description of gases and plasmas. We ﬁrst consider
the case of a dilute gas of monatomic, neutral particles. The system is described by the
distribution function ˜f (x, v, t), the number density of particles at position x moving with
velocity v at time t. It evolves according to the Boltzmann equation

∂ ˜f
∂t

+ v · ∇ ˜f = νCB[ ˜f , ˜f ],

(1.2)

where νCB is the Boltzmann collision operator describing collisions between pairs of parti-
cles with frequency ν. Collisions between three or more particles are negligibly infrequent.
Collisions between pairs of particles conserve mass, momentum, and energy, so the follow-
ing three integrals of the collision operator vanish:

(cid:90)

(cid:90)

d3v

(cid:90)

d3v CB[ ˜f , ˜f ] = 0,

d3v vCB[ ˜f , ˜f ] = 0,
|v|2CB[ ˜f , ˜f ] = 0.

1
2

(1.3a)

(1.3b)

(1.3c)

Other moments of CB typically do not vanish.

Macroscopic quantities of the gas are given by velocity moments of ˜f. The ﬁrst few are

(cid:90)

(cid:90)

n(x, t) =

d3v ˜f (x, v, t),

u(x, t) =

(cid:90)

1
d3v v ˜f (x, v, t),
n
d3v |v − u|2 ˜f (x, v, t),

T (x, t) =

1
3n

(1.4a)

(1.4b)

(1.4c)

respectively the number density, bulk velocity, and temperature in so-called energy units
where T 1/2 is the isothermal (Newtonian) sound speed. In a ﬂuid description, we replace
the Boltzmann equation (1.2) for the distribution function ˜f with a system of equations
for macroscopic quantities, moments of distribution function like n, u and T . Taking
moments of the Boltzmann equation (1.2) corresponding to the integrals (1.3), we derive
three macroscopic conservation laws

∂(mn)

∂t

+ ∇ · (mnu) = 0,

(mnu) + ∇ · Π = 0,

∂
∂t

∂E
∂t

+ ∇ · F = 0,

(1.5)

7

where m is the particle mass. The energy density E, momentum ﬂux Π, and energy ﬂux F
are deﬁned by further moments of ˜f:
E = m

|v|2 ˜f (x, v, t),

(cid:90)

d3v

(1.6a)

(cid:90)

1
2

Π = m

(cid:90)

F = m

d3v vv ˜f (x, v, t),
v|v|2 ˜f (x, v, t).

1
2

(1.6b)

(1.8)

(1.9)

(1.10a)

(1.10b)

(1.10c)

(cid:18)

∂Π
∂t
+ ∇ ·

m

(cid:90)

∂F
∂t

(cid:19)

(cid:90)

d3v

(1.6c)
The evolution equations for n, u, E (1.5) are not closed as the ﬂuxes Π and F are un-
known. We could ﬁnd evolution equations for these ﬂuxes by taking further moments of
the Boltzmann equation,
+ ∇ ·

d3v vvCB[ ˜f , ˜f ] (cid:54)= 0,

d3v vvv ˜f

(1.7a)

(cid:19)

(cid:18)

= νm

(cid:90)

(cid:90)

m

d3v

1
2

vv|v|2 ˜f

= νm

d3v

1
2

v|v|2CB[ ˜f , ˜f ] (cid:54)= 0,

(1.7b)

but then these depend on yet higher unknown moments. In fact, this is a generic problem—
the “closure problem”—which arises in taking moments of kinetic equations like (1.2):
the evolution of the nth moment will always depend on the (n + 1)th moment because
of the velocity in the streaming term v · ∇ ˜f. One may close the system (and thereby
produce a ﬂuid model) by deﬁning the (n + 1)th moment in terms of known quantities.
In the simplest model, the Euler equations, one motivates deﬁnitions for E, Π and F by
noting that if collisions in a gas are frequent, the collision frequency ν is large relative
to expected hydrodynamic timescales. The evolution equations for all moments except n,
u and E have a collision term on the right-hand side. Thus in the limit of very frequent
collisions, the right-hand side dominates all moment equations. It is therefore reasonable
to set CB[ ˜f , ˜f ] = 0. This equation is solved by the Maxwell–Boltzmann distribution

˜f (0)(x, v, t) =

n(x, t)

[2πT (x, t)]3/2

exp

(cid:18)
−|v − u(x, t)|2

(cid:19)

.

2T (x, t)

Substituting this into (1.6) gives
E =
which on further substitution into (1.5) yields the Euler equations for n, u and T ,

mnT, Π = mnuu + mnT I, F =

mnu|u|2 +

m|u|2 +

1
2

5
2

1
2

3
2

mnT u,

(cid:19)

∂n
∂t
+ u · ∇u

+ ∇ · (nu) = 0,
+ ∇(mnT ) = 0,

(cid:18) ∂u
(cid:18) ∂T

mn

3
2

mn

∂t

∂t
+ u · ∇T

+ mnT ∇ · u = 0.

(cid:19)

8

The Euler equations are in fact the leading order result of the Chapman–Enskog expansion
[32], where the distribution function in the Boltzmann equation is expanded in powers of
the Knudsen number Kn, the ratio of the mean free path to the characteristic system length.
Expanding to higher orders yields further ﬂuid models: the Navier–Stokes equations at
O(Kn), the Burnett equations at O(Kn2) and the super-Burnett equations at O(Kn3) [33,
34].

In a plasma, the relevant kinetic equation is the Fokker–Planck–Landau equation

(cid:18)

(cid:19)

∂ ˜fs
∂t

+ v · ∇ ˜fs +

qs
ms

v × B

c

E +

· ∂ ˜fs
∂v

=

(cid:88)

r

νsrCL[ ˜fs, ˜fr],

(1.11)

where ˜fs is the distribution function for species s. Now we have an additional term for the
acceleration due to the Lorentz force (1.1), and a different collision operator, the Landau
operator for collisions between charged particles mediated by long-range Coulomb interac-
tions (see §3.2.1), where νsr is the collision frequency for collisions between species s and
r. Macroscopic quantities are still deﬁned by moments of ˜f (1.4) and (1.6), but in addition,
moments also give the charge density  and current density j,

(cid:88)

(cid:90)

(cid:88)

(cid:90)

 =

qs

d3v ˜f ,

j =

qs

d3v v ˜f .

(1.12)

The charge and current densities appear as sources in Maxwell’s equations,

s

s

∇ · E = 4π,
∇ · B = 0,
= −c∇ × E,
4π
∂E
c
∂t

j +

1
c

,

∂B
∂t
∇ × B =

(1.13a)
(1.13b)

(1.13c)

(1.13d)

which determine the electric and magnetic ﬁelds appearing in the Lorentz force term in
(1.11). Thus the plasma is described by a coupled nonlinear integro-differential equation
system (1.11) and (1.13) for ˜f in six dimensional phase space. Moreover, as mentioned
above, this system contains a wide range of scales in both space and time. This is analyti-
cally and numerically intractable.

The wide range of timescales both causes the largest difﬁculty and points towards a
solution. Estimates for timescales in the JET tokamak regime give a gyrofrequency Ωi ∼
2 × 108 s−1, typical turbulent ﬂuctuations ω ∼ 2 × 104 s−1, and transport rate τ−1 ∼ 2 s−1
[35]. Supposing one needs ten timesteps to properly resolve ion gyromotion, one would
need to evolve the system for 105 timesteps to see just one oscillation of a typical turbulent

9

ﬂuctuation, and for 109 timesteps to see any change in macroscopic properties. To progress,
we must relax this timestep restriction.

s

This is achieved through gyrokinetic theory, which was introduced independently by
RUTHERFORD & FRIEMAN [36] and TAYLOR & HASTIE [37] in the 1960’s (and is de-
rived and discussed in Chapter 2). The key idea is to average over the particle gyromotion.
This eliminates the fast timescale Ω−1
from the problem, and removes the dependence on
azimuthal velocity. Thus the six-dimensional kinetic system for charged particles reduces
to the ﬁve-dimensional gyrokinetic system for the motion of charged rings. The gyroki-
netic system, summarized in §2.2.2, is still very expensive computationally. Simulations
of a whole tokamak are not routinely possible (though “global” codes do exist, e.g. [38])
and even ﬂux-tube simulations of a tokamak section [20] require upwards of hundreds of
thousands of CPU hours each on High Performance Computing platforms. Because of the
high-dimensionality, resolution in each dimension is usually coarse.

It is standard to compute directly with the gyrokinetic equations, or simpliﬁed (e.g.
reduced-dimensional) cases of it. Working with this system, we are guaranteed to include
all physical effects which are slower than the gyromotion, and all behaviour which depends
on velocity space. This approach is the subject of this thesis, as outlined in the next sec-
tion. There are however also ﬂuid models which are derived from gyrokinetics. These
“gyroﬂuid” models, derived in the 1990’s by Hammett and coworkers [39–41], close the
moment equations using a model for Landau damping [42]. The computation effort saved
by replacing a velocity space grid of O(100) points with four [40] or six [41] moments
may be redeployed in increasing spatial resolution, for example. Alternatively, gyroﬂuid
models have been used in conjunction with transport solvers like TRINITY [43] to provide
computationally inexpensive approximations to turbulent properties like heat ﬂuxes.

Gyroﬂuid models are of interest to us as in the spectral representation of the distribution
function (which we shortly introduce) there is a direct correspondance between coefﬁcients
of the spectral representation and moments of the distribution function. Therefore, by
minimizing the velocity space resolution in our methods we are naturally approaching a
ﬂuid-like representation of gyrokinetics. Ultimately it would be interesting to compare our
representation (which is entirely based on computational considerations) with gyroﬂuid
models (which are based on modelling assumptions), but this falls outside the scope of this
thesis.

10

1.5 Numerical methods for the gyrokinetic equations

In this thesis we improve numerical methods for the solution of the gyrokinetic-Maxwell
system. We employ spectral methods in velocity space to complement the Fourier spectral
method typically used in physical space. In spectral methods, dependent variables—here
the distribution function and the electromagnetic ﬁelds—are represented using a series ex-
pansion in a family of orthogonal functions. Thus instead of discretizing the system on
a ﬁnite grid, we derive a ﬁnite set of moment equations for the coefﬁcients of the series
expansion, analogous to the moment equations (1.10) derived previously for a neutral gas.
Such spectral methods are desirable as they efﬁciently represent the distribution func-
tion, minimizing the resolution and memory required. They are also conservative: unlike
grid methods, they introduce no spurious numerical dissipation in the calculation of deriva-
tives, and thus exactly conserve quadratic invariants of the gyrokinetic-Maxwell system
such as free energy (see §2.3). Finally, spectral methods introduce a change of coordinates
(e.g., from space coordinate x to Fourier wavenumber k) which can be exploited to make
the equations local in phase space. This is particularly useful for computation on multi-
processor platforms, because data and operations which are local in phase space are also
local to a processor, and so do not require costly inter-processor communication. Such con-
siderations are important as it is typically inter-processor communication, not computation,
that limits the performance of codes, particularly for large numbers of processors.

In this thesis we use the Hermite and Hankel spectral representations in parallel and per-
pendicular velocity space respectively. Parallel velocity space must be treated very care-
fully in order to capture Landau damping, an important dissipation mechanism which is
related to the formation of inﬁnitesimally ﬁne scales in the distribution function, due to the
streaming term v·∇ ˜fs in the kinetic equation (1.11). To understand this effect, we consider
the simplest such case, the free streaming equation

∂ ˜f
∂t

+ v(cid:107)

∂ ˜f
∂z

= 0,

(1.14)

which has the solution ˜f (z, v(cid:107), t) = ˜f (z − v(cid:107)t, v(cid:107), 0). That is, the solution is the initial
distribution sheared in phase space, as shown in Figure 1.1 where we plot ˜f (z, v(cid:107), t) =
(cid:107) sin(z − v(cid:107)t), the solution to the free streaming equation with the initial condition
−v2
e
˜f (z, v(cid:107), t = 0) = e
(cid:107) sin z. The distribution function rapidly oscillates in velocity space,
forming inﬁnitesimally ﬁne velocity space scales as t → ∞. Although the distribution
function itself does not decay, the rapid oscillation means that moments of the distribution
function with respect to parallel velocity, like the electrostatic potential, do decay. At any
ﬁnite time, the distribution function ˜f is continuous and differentiable; however it is not

−v2

11

(a)

(b)

(c)

(cid:107) sin(z − v(cid:107)t), which solves the free
−v2
Figure 1.1: The distribution function ˜f (z, v(cid:107), t) = e
streaming equation with the initial condition ˜f (z, v(cid:107), 0) = e
(cid:107) sin(z). The distribution
function is plotted at three times, (a) t = 0, (b) t = 10, and (c) t = 20. The left-hand
column shows contours of the distribution function, while the right-hand column shows a
slice through the distribution function at z = π/2 (which is marked with a dashed line in
the left-hand column). The distribution function becomes more sheared with increasing
time, and velocity space slices through the distribution function become characterized by
ﬁner scales.

−v2

12

0.00.51.01.52.0z/(2π)-2-1012v-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0-2.0-1.5-1.0-0.50.00.51.01.52.0v-1.0-0.50.00.51.0f(z=π/2,v)0.00.51.01.52.0z/(2π)-2-1012v-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0-2.0-1.5-1.0-0.50.00.51.01.52.0v-1.0-0.50.00.51.0f(z=π/2,v)0.00.51.01.52.0z/(2π)-2-1012v-1.0-0.8-0.6-0.4-0.20.00.20.40.60.81.0-2.0-1.5-1.0-0.50.00.51.01.52.0v-1.0-0.50.00.51.0f(z=π/2,v)an exponentially decaying separable solution of (1.14). Seeking eigenmodes of (1.14) by
taking a Fourier transform in z and t (with wavenumber k and frequency ω respectively) we
ﬁnd a continuous spectrum of eigenvalues ω = kv(cid:107) related to the singular eigenfunctions
δ(ω − kv). Moreover, these eigenfunctions are not square integrable.

The behaviour of the free streaming equation is replicated in the Fokker–Planck equa-
tion (1.11). Here the decay of the electrostatic potential with time is known as Landau
damping. The decay behaviour is different to that of the free streaming equation due to the
presence of Lorentz force terms, but again is ultimately due to the formation of ﬁne scales
in velocity space. The Landau-damped distribution function is derived by solving the ki-
netic equation via a Laplace transform (as shown in Chapter 3). As before, inﬁnitesimally
ﬁne scales form in velocity space as t → ∞, so the velocity space moments decay. Again,
the distribution function is not a time eigenmode of the problem; rather the eigenmodes are
singular “Case–Van Kampen” modes.

This behaviour changes when collisions are introduced. Collisions provide a velocity
space diffusion, a term like ν∂2 ˜fs/∂v2(cid:107) on the right-hand side of (1.14) which acts to smooth
the ﬁne scale structure in the distribution function. The eigenmodes of the system are now
continuous and differentiable, being obtained from a differential equation in v(cid:107). Moreover,
the Landau-damped distribution function emerges as an eigenmode of the system in the
singular limit of vanishing collisions, ν → 0. The velocity space diffusion continues to
have an effect due to the formation of inﬁnitesimal scales in this limit. Eigenmodes of the
strictly collisionless system (ν = 0) are still singular.

This behaviour makes Landau damping difﬁcult to capture in a discrete system where
there is necessarily a shortest resolved velocity scale. With insufﬁciently strong collisions,
the eigenmodes of the discrete system are discrete approximations to the singular solutions
of the strictly collisionless equation. However, smooth solutions may be found by solving
the collisional problem with ν sufﬁciently large to smooth the distribution function so that
it is resolved for a given grid. In principle, one may then recover the Landau solution by
taking the limit ν → 0 while simultaneously taking the number of grid points to inﬁnity to
ensure the solution is always resolved.

The Hermite representation introduced in Chapter 3 provides a convenient description
of parallel velocity space. The mth order Hermite polynomial has a characteristic veloc-
√
ity scale vth/
m so that each expansion coefﬁcient represents a different velocity space
scale. The square of each coefﬁcient represents that scale’s contribution to the free energy.
Moreover, the electrostatic potential is proportional to the coefﬁcient of the zeroth order
˜f becomes nearest neighbour mode coupling in m
polynomial. The streaming term v(cid:107)∂z
that results in the transfer of free energy from low m to high m. Thus Landau damping

13

may be interpreted as the ﬂux of free energy out of the electrostatic potential at m = 0
and towards high m where it is dissipated by collisions. This free energy transfer is linear
and reversible, but we show in Chapter 3 that the solution of an initial value problem of the
linearized kinetic system approaches an eigenmode where only the forward transfer occurs.
The backward transfer is also observed in numerical simulations where insufﬁcient colli-
sions at the largest retained m result in free energy reﬂecting back to low m and causing
the electrostatic potential to grow. This numerical phenomenon is called recurrence.

In Chapter 3, we introduce the iterated Kirkwood hypercollisional operator which se-
lectively damps the ﬁnest resolved scales in the distribution function, while leaving the
details of the free energy transfer unaffected. Doing so, we very efﬁciently capture Lan-
dau damping behaviour and prevent recurrence, retaining only around ten moments in the
Hermite expansion.

The Hermite representation is also convenient as it is mostly local in phase space, with
the only signiﬁcant nonlocality coming from the nearest neighbour mode coupling due
to the streaming term.
In particular, the parallel velocity space integral in the sources
(1.12) required to calculate the electromagnetic ﬁelds from Maxwell’s equations (1.13) are
coefﬁcients of single Hermite modes, not sums as they would be in a grid discretization.
This motivates our use of the Hankel transform, which localizes the perpendicular velocity
space integral in the gyrokinetic and spatially Fourier transformed version of (1.12) where
there is an additional Bessel function factor in the integrand. In Fourier–Hankel–Hermite
space, the linearized gyrokinetic equations are local but for the Hermite mode coupling, and
so may be solved very efﬁciently as a one-dimensional problem. While this is no longer
true of the nonlinear gyrokinetic system, it too has interesting locality properties which
may be exploited, as we discuss in Chapter 4.

We implement the Fourier–Hermite–Hankel representation in the spectral gyrokinetics
code SPECTROGK, described in Chapter 5. This is an implementation of the gyrokinetic-
Maxwell system derived in Chapter 2, supporting electromagnetic perturbations and multi-
ple kinetic species. SPECTROGK is based on GS2 and ASTROGK, both grid point codes in
velocity space, but shares their well-tested parallelization framework and software infras-
tructure. Other advantages of the implementation include exact free energy conservation in
the absence of explicit collisions, and the capture of Landau damping through the use of the
iterated Kirkwood hypercollisional operator. SPECTROGK is the main practical outcome
of this thesis, a tool ideally suited to studying turbulence in weakly collisional plasmas.
Moreover, SPECTROGK is a useful test-bed for new algorithms and optimizations, and the
natural starting point in future efforts to develop a spectral toroidal code.

14

In Chapters 6 and 7, we use SPECTROGK to study electrostatic drift-kinetic turbu-
lence in Cartesian slab geometry, a convenient long perpendicular wavelength limit of the
gyrokinetic-Maxwell system, which nonetheless captures its important features. In Chap-
ter 6, we describe the turbulent behaviour in terms of competing free energy cascades: the
linear transfer of free energy to ﬁne velocity space scales via phase-mixing, as described in
Chapter 3, and the nonlinear transfer to ﬁne physical space scales, similar to that in hydro-
dynamic turbulence. We show that phase space is divided into two regions depending on
which cascade is faster, where one cascade dominates the other. Moreover, we show the
surprising result that the nonlinearity excites a transfer of free energy from small to large
scales in velocity space which counteract the forward transfer of free energy from large
to small velocity space scales from linear phase-mixing. Thus where the nonlinearity is
dominant, it completely suppresses the transfer of free energy to ﬁne velocity space scales,
and the turbulence in that region of phase space is ﬂuid-like. In fact, these scales also cor-
respond to the energetically dominant scales in the plasma, so that the overall behaviour of
the turbulence is ﬂuid-like.

We use this new understanding of drift-kinetic turbulence in Chapter 7 to derive com-
plete scaling laws for the spectra of the electrostatic potential and the distribution function,
and verify these scalings using SPECTROGK simulations.

From these two Chapters we have a complete understanding of the behaviour of elec-
trostatic drift-kinetic turbulence in a slab. Moreover, we have developed the analytical and
numerical tools required to study gyrokinetic turbulence in future work.

15

Chapter 2

Gyrokinetic-Maxwell system

We begin by deriving the gyrokinetic-Maxwell system which models turbulence in a wide
variety of astrophysical and nuclear fusion plasmas. Such turbulence spans multiple scales
in space and time (see Table 2.1). Turbulence occurs on spatial scales comparable with
the ion gyroradius ρi, while macroscopic quantities like densities, bulk velocities and mean
temperatures vary over much longer lengths comparable with the system size L. Similarly,
turbulent ﬂuctuations have characteristic frequency ω which is much faster than the rate
of evolution of macroscopic properties τ−1, where τ is the transport time. In §2.1.2 we
introduce the turbulent average to exploit this separation of scales. This average partitions
quantities into a mean part (which evolves slowly on large spatial scales) and a turbulent
part (which evolves quickly on small spatial scales). The equations for each part decouple,
allowing for independent solution at different scales.

Further, the turbulent ﬂuctuations themselves exhibit a disparity of scales. In a strong
magnetic ﬁeld, the particles gyrate around ﬁeld lines with gyrofrequency Ωs = qsB/msc
which for both ions and electrons is much larger than the typical frequency of ﬂuctuations
ω. The turbulence is also spatially anisotropic, with particles streaming along mean ﬁelds
much faster than they drift across them. Hence typical wavelengths in the turbulences are
much longer parallel to the mean ﬁeld than perpendicular to it. These two properties allow
for separation of scales via the “gyroaverage”, the average over the particle gyration (see
§2.1.5.1), a crucial procedure which makes the system tractable. Gyroaveraging removes
the fast cyclotron time scales, as well as eliminating the dependence on azimuthal veloc-
ity, so the six-dimensional system for particles reduces to a ﬁve-dimensional system for
charged rings.

Gyrokinetic theory, which determines the evolution of these charged rings, was in-
troduced independently by RUTHERFORD & FRIEMAN [36] and TAYLOR & HASTIE [37].
These built on the earlier guiding centre approximation (see e.g. ALFV ´EN & F ¨ALT-
HAMMER [45]), which applied the idea of studying the motion of charged rings to a single

16

Tokamaks

Astrophysics

Parameter

ρi (m)
L (m)
vthi (m s−1)
τ−1 (s−1) a
ω (s−1) b
Ωi (s−1)
ε = ρi/L
βi = 8πniTi/B2
0

JET
5.1 × 10−4
1
8.7 × 104
2.0
2.0 × 104
1.7 × 108
5 × 10−4
0.025

ITER
(projected)
3.2 × 10−4
2
7.7 × 104
0.3
5.5 × 104
2.4 × 108
2 × 10−4
0.04

Solar wind at
1AU
9 × 104
∼ 108
9 × 104
4 × 10−4
1
9 × 10−4
5

Accretion ﬂow
near Sgr A*
4 × 103
∼ 1011
108
7 × 10−4
7 × 10−2
4 × 10−9
4

Table 2.1: Parameter values adapted from ABEL ET AL. [35, Table 1] (tokamaks) and
SCHEKOCHIHIN ET AL. [44, Table 1] (astrophysics). Notes: a Transport time for astro-
physical plasmas estimated as bulk velocity U [from 44] over the system size L. b Plasma
frequency estimated for astrophysical plasmas as ω ∼ k(cid:107)vA ∼ vA/L with vA the Alfv´en
velocity.

particle rather than a distribution. The derivation is greatly simpliﬁed by CATTO’s [46]
introduction of guiding centre coordinates (see also §2.1.5). Gyrokinetic theory was ex-
tended to include electromagnetic perturbations by ANTONSEN & LANE [47] and CATTO
ET AL. [48], and to incorporate nonlinear effects by FRIEMAN & CHEN [49]. Finally,
gyrokinetic theory was united with neoclassical theory (which describes large scale, non-
turbulent ﬂuctuations, see e.g. CATTO ET AL. [50]) in a single theoretic framework by
ABEL ET AL. [35].

The standard derivation of the gyrokinetic-Maxwell system is via an asymptotic expan-
sion in the gyrokinetic parameter ε = ρi/L, the ratio of the ion gyroradius to the system
size. All other scale disparities (e.g. ω/Ωi) are related to ε using the “δf-ordering” intro-
duced by ANTONSEN & LANE [47] and FRIEMAN & CHEN [49], see §2.1.4. Thus every
term has a deﬁnite size, yielding a hierarchy of coupled equations to be solved order-by-
order in ε. These equations are not closed as the fast particle gyration always results in
a term corresponding to a higher order perturbation to the distribution function. Gyroav-
eraging removes these terms yielding closed equations at each order. Further, turbulent
averaging separates equations into mean and turbulent parts allowing simultaneous deriva-
tion of the gyrokinetic equation for turbulent ﬂuctuations and the neoclassical equation for
large scale perturbations.

In the above asymptotic approach, energy is conserved by the system overall, but is
not conserved at each order. Indeed, this energy transfer between orders is interpreted as a
feature of a multiscale system [35]. Alternative Hamiltonian derivations of gyrokinetics do

17

conserve energy at each order by retaining terms which are formally small in the asymp-
totic expansion [see 51–54]. However, the gyrokinetic equation itself does conserve free
energy, the weighted integral of disturbance amplitudes (see §2.3), which is related to the
Boltzmann entropy (see §3.2.1). The free energy is quadratic and is neatly expressed via
Parseval’s theorem as the sum of squares of coefﬁcients of the Fourier–Hankel–Hermite
spectral expansion described in Chapters 3 to 5.

Finally, since gyrokinetic theory was originally developed for tokamak modelling, it is
commonly presented in toroidal geometry [see 35, §3.3]. However, Cartesian slab geometry
typically sufﬁces for astrophysical applications. As a consequence of neglecting geome-
try terms, slab gyrokinetics no longer has the distinction between “trapped” and “passing”
particles determined by a particle’s magnetic moment (one of the gyrokinetic variables in-
troduced by CATTO [46]). Therefore velocity space in slab gyrokinetics is more commonly
expressed in terms of parallel and perpendicular velocity [e.g. 55, 56], which simpliﬁes the
ﬁnal equations and more naturally describes reduced dimension models (see §4.3).

In this chapter, we derive gyrokinetics (§§2.1–2.2) following the asymptotic approach
in ABEL ET AL. [35], but simpliﬁed for a slab geometry. Unlike other slab derivations
[e.g. 55], we explicitly nondimensionalize so that the gyrokinetic parameter appears in the
equations and we work directly with the same normalized quantities as in the GS2 family
of codes [56, 57]. The derivation keeps up to second order in the gyrokinetic parameter,
corresponding to deriving the equations solved in SPECTROGK. By retaining the next or-
der, we could derive the transport equations for the evolution of macroscopic quantities. In
§2.3 we derive equations for free energy which we use in Chapters 6 and 7 to characterize
plasma turbulence. Finally in §2.4 we derive the various simpliﬁed versions of gyrokinetics
studied in this thesis by taking limits of the gyrokinetic-Maxwell system.

2.1 Preliminaries
2.1.1 Gyrokinetic–Maxwell equations

The starting point is the Fokker–Planck equation

d ˜fs
dt

=

∂ ˜fs
∂t

+ v · ∇ ˜fs +

qs
ms

(cid:32)(cid:101)E +

(cid:33)

(cid:88)

r

· ∂ ˜fs
∂v

=

Csr[ ˜fs, ˜fr],

(2.1)

v × (cid:101)B

c

which describes the evolution of the distribution function ˜fs of species s with mass ms and
charge qs in the six-dimensional phase space (r, v). We use Gaussian units, with speed of

light c, electric ﬁeld (cid:101)E and magnetic ﬁeld (cid:101)B. The operator Csr is the Landau operator,

describing collisions between particles of species s and r.

18

The electromagnetic ﬁelds (cid:101)E and (cid:101)B are found via Maxwell’s equations

∇ · (cid:101)E = 4π ˜,
∇ · (cid:101)B = 0,
= −c∇ × (cid:101)E,
∂(cid:101)E

˜j +

,

4π
c

1
c

∂t

(cid:90)

∂t

∂(cid:101)B
∇ × (cid:101)B =
(cid:88)
(cid:88)

˜ =

s

˜j =

qs

(cid:90)

qs

where the charge density ˜ and current ˜j are velocity moments of the distribution function

(2.2)
(2.3)

(2.4)

(2.5)

(2.8)
(2.9)

d3v ˜fs,

d3v v ˜fs.

(2.6)

(2.7)

We neglect Debye-scale and relativistic effects,

s

De (cid:28) 1,
k2⊥λ2
ths/c2 (cid:28) 1,
v2

where k⊥ is a typical perpendicular wavenumber, λDe =(cid:112)Te/4πnee2 is the electron De-
bye length and vths =(cid:112)2Ts/ms is the thermal velocity, with ns and Ts the species density
Further, we satisfy (2.3) and (2.4) by introducing the potentials (cid:101)ϕ and (cid:101)A,

and temperature, and e the electron charge.

(cid:101)E = −∇(cid:101)ϕ +
(cid:101)B = ∇ × (cid:101)A,
and we work in the Coulomb gauge, ∇ · (cid:101)A = 0.

∂(cid:101)A

∂t

1
c

,

(2.10)

(2.11)

2.1.2 Small scale averaging

The gyrokinetic equation is derived using the separation of temporal and spatial scales to
partition physical quantities into their mean and ﬂuctuating parts. To do so, we introduce
quantity (cid:101)Q =
the average over the short turbulent length and time scales, (cid:104)·(cid:105)turb, and write each physical

+ Q, where by construction (cid:104)Q(cid:105)turb = 0.

(cid:68)(cid:101)Q
(cid:69)

In space, the macroscopic length scale which characterizes the equilibrium is well-
separated from the gyroscale on which ﬂuctuations occur. We can therefore ﬁnd an inter-
mediate scale (cid:96) for which

turb

ρ (cid:28) (cid:96) (cid:28) L,

19

(2.12)

and deﬁne the perpendicular average
(cid:104)F (r, v, t)(cid:105)⊥ =

(cid:90)

(cid:96)2

1
(cid:96)2

d2r(cid:48)

⊥ F (r(cid:48)

⊥, r(cid:107), v, t),

(2.13)

where integration is over a square of side (cid:96) perpendicular to the ﬁeld line and centred at
r. The perpendicular average varies on the length scales (cid:96). It therefore averages over the
turbulent ﬂuctuations on the gyroscale ρ (cid:28) (cid:96), but leaves variation on the macroscale L (cid:29) (cid:96)
unaffected.

Similarly we ﬁnd an intermediate timescale ˜τ between the turbulent and transport time

scales

ω−1 (cid:28) ˜τ (cid:28) τ,

and deﬁne the time average

(cid:104)F (r, v, t)(cid:105)˜τ =

(cid:90) t+˜τ /2

t−˜τ /2

1
˜τ

dt(cid:48) F (r, v, t(cid:48)).

(2.14)

(2.15)

Again, this averages over turbulent timescales without affecting quantities that vary on the
transport time scales.

The turbulent average is deﬁned as the combination of these two averages

(cid:104)F(cid:105)turb = (cid:104)(cid:104)F(cid:105)˜τ(cid:105)⊥ .

This allows the separation of all quantities into mean parts and turbulent parts

turb

(cid:69)
(cid:68) ˜fs
(cid:69)
(cid:68)(cid:101)E
(cid:69)
(cid:68)(cid:101)B
(cid:68)(cid:101)A
(cid:69)
¯ϕ = (cid:104)(cid:101)ϕ(cid:105)turb .

turb

turb

turb

,

,

,

,

Fs =

¯E =

¯B =

¯A =

˜fs = Fs + fs,

(cid:101)E = ¯E + E,
(cid:101)B = ¯B + B,
(cid:101)A = ¯A + A,
(cid:101)ϕ = ¯ϕ + ϕ,

(2.16)

(2.17)

(2.18)

(2.19)

(2.20)

(2.21)

The scales of the temporal and spatial variations of a typical quantity Q can then be esti-
mated as

(cid:68)(cid:101)Q
(cid:69)

∇ ln

turb

ln(cid:104)Q(cid:105)turb ∼ τ−1,

∂
∂t

∼ b · ∇ ln Q ∼ L−1,

∂
∂t

ln Q ∼ ω,
∇⊥ ln Q ∼ ρ−1

.

i

(2.22)

where b is the unit vector in the direction of the magnetic ﬁeld, and ∇⊥ is the gradient
in the direction perpendicular to b. These state that macroscopic time evolution is on the

20

transport timescale τ, while turbulent evolution is on the timescale of plasma dynamics
ω−1. Macroscopic spatial variation occurs over system scales L, as do turbulent spatial
ﬂuctuations parallel to the ﬁeld line, while perpendicular spatial ﬂuctuations occur on scales
comparable to the ion gyroradius.

2.1.3 Geometry

We solve for the perturbed distribution function fs in a Cartesian box with spatial dimension
(x, y, z) ∈ [0, Lx] × [0, Ly] × [0, Lz] and velocity space dimension (v(cid:107), v⊥) ∈ R × [0,∞).
The mean parts of the electromagnetic ﬁeld, ¯E and ¯B, are imposed. For relevant astro-
physical and nuclear fusion regimes, there is no mean electric ﬁeld ¯E = 0, ¯ϕ = 0, and the
magnetic ﬁeld ¯B = B0b is approximately constant. Speciﬁcally, ¯B has no explicit time
dependence, ∂ ¯B/∂t = 0. The vector b is approximately a unit vector pointing in the z-
direction. It is curl-free (∇ × b = 0) and has a small curvature pointing in the x-direction,
κ = κˆx = (b · ∇)b.1 The ﬁeld strength B0 is assumed to be a small deviation from a
constant reference ﬁeld strength. It is constant along the ﬁeld line, b · ∇B0 = 0, but has a
small linear variation in the x-direction, i.e. ∇ ln B0 = −L−1

B ˆx where L−1

B is a constant.

Similarly, we impose perpendicular gradients in density and temperature by expanding
the leading order distribution function (which we show in §2.2 is a Maxwellian) about
a global reference density n0 and temperature T0. We again take the perturbation to be
constant and pointing in the x-direction, L−1

n ˆx = −∇ ln n0 and L−1

T ˆx = −∇ ln T0.

As there are no macroscopic gradients in the y- and z-directions, we use periodic bound-
ary conditions in y and z. This is computationally convenient, as it permits a Fourier series
representation for fs. It is permissible provided that the correlation length of the turbulence
(the characteristic length scale, ρi) is much shorter than the box length, so that a point in
space is not affected by its periodic image. Moreover, while the gradients in the x-direction
prevent the whole problem being periodic in x, the constant gradients in the density, tem-
perature and magnetic ﬁeld enter the equations for fs in a way which does not prevent fs
being periodic. Therefore we also take fs to be periodic in x. This means that there are
small periodic perturbations to density, temperature and the electric ﬁeld superimposed on
non-periodic macroscopic gradients, see Figure 2.1.

1These conditions are satisﬁed by any vector b = (b1(x, y), b2(x, y), 1) such that (i) b2

2 (cid:28) 1, so that
|b| ≈ 1, (ii) ∂b1/∂y = ∂b2/∂x, so that ∇ × b = 0; and (iii) b1∂b2/∂x + b2∂b2/∂y = 0, so that κ · ˆy = 0.

1 + b2

21

(a)

(b)

Figure 2.1: Schematic representation of periodic temperature ﬂuctuations about a macro-
scopic temperature gradient. (a) The total temperature (solid) and the macroscopic tem-
perature proﬁle (dashed) over two domain lengths, [0, Lx], [Lx, 2Lx]. (b) The temperature
perturbation about the macroscopic proﬁle. While the total temperature is not periodic, the
perturbed temperature may be periodic for sufﬁciently large Lx.

2.1.4 δf ordering

We now impose the δf ordering introduced by ANTONSEN & LANE [47] and FRIEMAN &
CHEN [49]. This orders all quantities (except the transport and collisional timescales) with
respect to the small gyrokinetic parameter ε,

ω
Ωi

∼ fs
Fs

∼ |B|
| ¯B| ∼ eϕ

T

∼ ρi
L

≡ ε (cid:28) 1.

(2.23)

The ﬁrst term states that plasma dynamics are much slower than particle gyromotion. The
second two terms state that the ﬂuctuations in the distribution function and magnetic ﬁeld
are small in amplitude relative to the mean values. As ¯E = 0, there is no analogous
ordering for |E|/| ¯E|. Instead the fourth term imposes that the E × B velocity is much
smaller than the thermal velocity

c|E|
B

∼ cϕ
ρsB

∼ vthsε.

(2.24)

It follows from (2.23) that the vector potential ﬂuctuations A are very small. This is

because ¯A and A vary on different perpendicular length scales,

so that

¯B = ∇ × ¯A ∼ 1
L

¯A,

B = ∇ × A ∼ 1
ρs

A,

| ¯A| ∼ ρs|B|
|A|

L| ¯B| ∼ ε2.

22

(2.25)

(2.26)

Consequently the electric ﬁeld (2.10) is primarily electrostatic.

It also follows from the gradients (2.22) and the δf ordering (2.23) that the variation
in turbulent ﬂuctuations is anisotropic, with cross-ﬁeld variation much faster than variation
along the ﬁeld line

b · ∇Q
|∇⊥Q| ∼ ε.

(2.27)

The δf ordering thus gives sizes for all scales except the transport and collisional
timescales. To determine the transport time scale we use the gyro-Bohm estimate for tur-
bulent thermal diffusivity χTs ∼ ρ2
1
τ

sω [23]. Then
∼ χTs
L2

∼ ε2ω ∼ ε3Ωi,

(2.28)

so that transport is two orders slower than plasma dynamics. This means time derivatives
of the leading-order distribution do not appear at orders we study, so for our purposes Fs is
constant in time.

We also formally order the collision time

(2.29)
We can therefore study plasmas which are either weakly collisional ν ∼ ω or collisionless
ν (cid:28) ω by taking a subsidiary ordering for ν [55].

ν ∼ εΩi.

Finally, we expand the mean and ﬂuctuating parts of the distribution function ˜fs (2.17)

in powers of the gyrokinetic parameter ε,

˜fs = Fs + fs,

Fs = F0s + F1s + F2s + . . .

(2.30)
where Fns ∼ fns ∼ εnF0s. There is no f0s term in the fs expansion, consistent with
fs/Fs ∼ ε.

fs = f1s + f2s + . . .

Now every term in the gyrokinetic-Maxwell system has a well-deﬁned order with re-
spect to ε. In §2.1.6 we nondimensionalize using scales which make this ordering transpar-
ent; but ﬁrst we introduce gyrokinetic variables and the gyroaverage which are crucial for
the derivation.

2.1.5 Gyrokinetic variables

To derive the gyrokinetic equation, we transform the Fokker–Planck equation (2.1) from
position space coordinates (r, v) to guiding centre space coordinates introduced by CATTO

23

[46]: guiding centre position Rs, particle energy Es, magnetic moment µs, gyroangle ϑ and
sign of parallel velocity σ. These are deﬁned by

Rs = r − ρs,

Es =

1
2

msv2,

µs =

msv2⊥
2B0

,

σ =

v(cid:107)
|v(cid:107)| ,

where the gyroradius is

b × v
Ωs

,

ρs =

(2.31)

(2.32)

and the gyroangle ϑ is deﬁned implicitly in terms of parallel and perpendicular velocity

v = v(cid:107)b + v⊥,

v⊥ = v⊥(cos ϑˆx + sin ϑˆy).

(2.33)

In position space we denote the same gyroangle with Θ to emphasize which coordinate
system is meant. Derivatives in (r, v(cid:107), v⊥, Θ) and (Rs, Es, µs, ϑ, σs) are related via the
chain rule. We only require the relations

= ∇,

∂

∂Rs

∂
∂ϑ

=

∂
∂Θ

− v⊥
Ωs

· ∇.

It is also convenient to introduce the gyrokinetic potential

χs = ϕ − v · A.

(2.34)

(2.35)

In the gyrokinetic equation, all information about the electromagnetic ﬁeld enters as a func-
tion of χs. Note that the gyrokinetic potential is independent of species, but will become
species-dependent when nondimensionalized in §2.1.6.1.

2.1.5.1 Gyroaverage

The average over a particle gyration, or gyroaverage, is an important tool that allows us to
close the kinetic equation at each order of the asymptotic expansion. The gyroaverage is
deﬁned

(cid:104)a(r)(cid:105)Rs

=

1
2π

dϑ a

Rs +

,

(2.36)

where v is a function of ϑ deﬁned by (2.33). Thus the gyroaverage (2.36) is a function of
the guiding centre variables Rs, Es, µs, σ. The analogously-deﬁned gyroaverage

(cid:18)

(cid:18)

b × v
Ωs

(cid:19)

(cid:19)

(cid:90) 2π

0

(cid:90) 2π

0

(cid:104)v⊥ · ∇a(cid:105)Rs

= −Ωs

24

(cid:104)a(Rs)(cid:105)r =

1
2π

dΘ a

is a function of the position space variables r, v⊥, v(cid:107).

It follows from (2.34) that for an arbitrary function a(r),

Ωs

Rs − b × v
(cid:29)
(cid:28) ∂a

= 0.

∂ϑ

Rs

,

(2.37)

(2.38)

2.1.5.2 Fokker–Planck equation in gyrokinetic variables

The Fokker–Planck equation (2.1) in guiding centre variables is

d ˜f
dt

=

∂ ˜fs
∂t

+ ˙Rs · ∂ ˜fs
∂Rs

+ ˙Es

∂ ˜fs
∂Es

+ ˙µs

∂ ˜fs
∂µs

+ ˙ϑ

∂ ˜fs
∂ϑ

=

C[ ˜fs, ˜fs(cid:48)],

(2.39)

(cid:88)

s(cid:48)

where the dot is the full time derivative along the particle orbit, given by the Vlasov operator

d
dt

=

∂
∂t

with ˙r and ˙v the particle motions

˙r = v,

˙v =

qs
ms

+ ˙r · ∇ + ˙v · ∂
∂v

(cid:32)
−∇(cid:101)ϕ − 1

c

∂(cid:101)A

∂t

,

+

(cid:33)

.

v × (cid:101)B

c

(2.40)

(2.41)

We therefore need to evaluate the time derivatives of the gyrokinetic variables (2.31),

(cid:18) v × b

(cid:19)

d
dt
v × ((v · ∇)b)

Ωs

(cid:34)

˙Rs = ˙r +

= v(cid:107)b +

+

×

qs
ms

Ωs
b
Ωs

∇(cid:101)ϕ +
v · ∂(cid:101)A
˙Es = msv · ˙v = −qsv · ∇(cid:101)ϕ − qs
v⊥ · ∂(cid:101)A

v⊥ · ∇(cid:101)ϕ − qs

v⊥ · ˙v⊥ − µs
B0

ms
B0
= − qs
B0

˙µs =

cB0

˙B0

∂t

∂t

c

qs
msc

,

+

qs
cB0

∂(cid:101)A

∂t

− qsv × B

msc

(cid:35)

+ v(v · ∇ ln B0)

v⊥ · (v × B) − µsv · ∇ ln B0,

(2.42)

,

(2.43)

(2.44)

where we have used (2.41) for ˙r and ˙v. We have assumed that the magnetic ﬁeld has spatial
dependence but no explicit time dependence, so that

= (v · ∇) b,

db
dt
where we have also assumed that B0 does not change parallel to the ﬁeld, b · ∇B0 = 0.

= Ωsv⊥ · ∇ ln B0, (2.45)

= v · ∇B,

qs
msc

dB0
dt

dΩs
dt

dB
dt

=

To ﬁnd the gyrophase evolution ˙ϑ we take the time derivative of (2.33),

˙v⊥ =

˙v⊥
v⊥

v⊥ + (b × v⊥) ˙ϑ.

(2.46)

25

Gyrokinetic parameter
Thermal velocity
Gyrofrequency
Gyroradius
Plasma beta

vthr =(cid:112)2Tr/mr

ε = ρr/L

Ωr = qrB0/mrc
ρr = vthr/Ωr
βs = 8πnsTs/B2
0

Table 2.2: Normalizing quantities, adapted from HIGHCOCK [9].

Taking the scalar product of this with (b×v⊥), the ﬁrst term on the right-hand side vanishes
and we obtain

˙ϑ =

=

1
v2⊥
1
v2⊥

(b × v⊥) · ˙v⊥

(cid:34)

(b × v⊥) ·

qs
ms

(cid:32)

−∇⊥(cid:101)ϕ − 1

c

∂(cid:101)A⊥

∂t

(v × (cid:101)B)⊥

c

+

(cid:33)(cid:35)

.

(2.47)

We have thus expressed the Fokker–Planck equation in terms of the gyrokinetic vari-

ables; we now nondimensionalize and solve order-by-order in the gyrokinetic parameter.

2.1.6 Nondimensionalization

We now nondimensionalize using scales which respect the δf ordering (2.23). We follow
the approach used in the GS2 family of codes and nondimensionalize with respect to a
ﬁctitious reference species, denoted with subscript r. The scales are based on those in
HIGHCOCK [9] and are given in Tables 2.2 and 2.3. Thus for our slab system, we obtain
the same equations as solved in ASTROGK [56].

Note that the normalization with respect to a reference species removes constant factors
and leads to unexpected quantities. For example, the normalized thermal velocity is vthN s =

(cid:112)TN s/mN s, while the unnormalized thermal velocity is the usual vths =(cid:112)2Ts/ms. Con-

sequently surprising factors of 2 occasionally appear.

In the following subsections we nondimensionalize the electromagnetic ﬁelds and the
gyrokinetic potential (§2.1.6.1), the gyrokinetic variables, their time derivatives and their
gyroaverages (§2.1.6.2), the background Maxwellian (§2.1.6.3) and the Boltzmann re-
sponse term (§2.1.6.4).

2.1.6.1 Electromagnetic ﬁelds and gyrokinetic potential

The normalized electromagnetic ﬁelds and gyrokinetic potential are deﬁned by

(cid:101)B = B0(cid:101)BN ,

(cid:101)E = E =

εTr
qrρr

EN ,

χs =

εTr
qr

χN s,

(2.48)

26

ths)
ths)

Equilibrium distribution FN s = Fs/(ns/v3
Perturbed distribution
fN s = fs/(εns/v3
Electrostatic potential
ϕN = ϕ/(εTr/qr)
Vector potential
AN = A/(εTr/qr(vthr/c))
b = ¯B/B0
Mean magnetic ﬁeld
Perturbed magnetic ﬁeld BN = B/(εB0)
Radial coordinate
Poloidal coordinate
Parallel coordinate
Perpendicular gradient
Background gradients
Velocity coordinates
Thermal velocity
Time
Charge
Density
Mass
Temperature
Gyrofrequency
Collision operator

tN = t/(L/vthr)
qN s = qs/qr = qs
nN s = ns/nr
mN s = ms/mr
TN s = Ts/Tr
ΩN s = Ωs/Ωr = qN s/mN s
CN = C/(vthr/L)

xN = x/ρr
yN = y/ρr
zN = z/L
∇N⊥ = ρr∇⊥
∇N⊥ = L∇⊥
vN = v/vths

vthN s = vths/vthr =(cid:112)TN s/mN s

Table 2.3: Normalized quantities, adapted from HIGHCOCK [9].

where

(cid:101)BN = b +

ε
2

(∇N⊥ × AN ) +

ε2
2
EN = −∇N⊥ϕN − ε∇N(cid:107)ϕN − ε
χN s = ϕN − vthN svN · AN ,

(cid:0)∇N(cid:107) × AN

∂AN
∂tN

,

(cid:1) ,

(2.49)

(2.50)

(2.51)

and where the factors of 1/2 arise due to the choice of the deﬁnition of the thermal velocity
in the normalization.

2.1.6.2 Gyrokinetic variables

The nondimensional gyrokinetic variables are

RN s = rN − ρN sρN ,

EN s = v2
N ,

µN s = v2

N⊥,

σN =

vN(cid:107)
|vN(cid:107)|,

(2.52)

and the nondimensional derivatives are

∂

∂RN s

= ∇N ,

∂
∂ϑ

=

∂
∂Θ

− ρN svN⊥ · ∇N .

(2.53)

27

The nondimensional time derivatives are deﬁned implicitly by

˙Rs = vthr

˙RN s,

˙Es =

Tsvthr

L

˙EN s,

˙µs =

Tsvthr
B0L

˙µN s,

˙ϑ =

vthr
L

˙ϑN .

(2.54)

From these and equations (2.42–2.44), (2.47) we have

˙RN s = vthN svN(cid:107)b + ε

(cid:20)1

2

TN s
qN s
∇N⊥χN s +

vN × ((vN · ∇N )b)
(vN · ∇N ) AN +
1
2

TN s
qN s

+ εb ×

vN (vN · ∇N ln B0)

+ O(ε2),

(cid:21)

(cid:19)

(cid:18)

(2.55)

(2.56)

(2.57)

(2.58)

(2.59)

(2.60)

(2.61)

(2.62)

vN · ∇N⊥ϕN − εvN · ∇N(cid:107)ϕN − εvN · ∂AN
∂tN

˙EN s = −qN svthN s
TN s
vN⊥ · ∇N⊥ϕN − ε
˙µN s = − 1
ρN s
ρN s
+ vthN svN(cid:107)vN⊥ · ∇N⊥AN(cid:107) − εvthN svN⊥ · [(vN(cid:107) · ∇N )AN⊥]
− vthN sµN svN⊥ · ∇N ln B0 + O(ε2),

vN⊥ · ∂AN
∂tN

˙ϑN = −1
ε

ΩN s + O(1),

where in the magnetic moment we have used (2.49) and written AN = AN(cid:107)b + AN⊥. The
gyroaverages of (2.55)–(2.58) are
TN s
qN s

= vthN svN(cid:107)b + ε

b ×

(cid:20)

(cid:21)

Rs

(cid:18)

+

ε
2

1
2

N⊥∇N ln B0
N(cid:107)(b · ∇N )b +
v2
v2
(cid:19)
(cid:29)
(cid:28)
b × ∇N⊥ (cid:104)χN s(cid:105)Rs
vN · ∂AN
(cid:10)vN⊥ · [(vN(cid:107) · ∇N )AN⊥](cid:11)
∂tN

+

Rs

(cid:29)

vN · ∇N(cid:107) (cid:104)ϕN(cid:105)Rs
− εvthN s

,

+ O(ε2),

= −ε

qN svthN s

(cid:28)

TN s

= − ε
ρN s

vN⊥ · ∂AN
∂tN

Rs

Rs

+ O(ε2),

(cid:68) ˙RN s
(cid:68) ˙EN s

(cid:69)
(cid:69)
(cid:104) ˙µN s(cid:105)Rs
(cid:69)

(cid:68) ˙ϑN

Rs

Rs

= −1
ε

ΩN s + O(1).

Notice that many terms vanish due to the property (cid:104)v⊥ · ∇a(cid:105)Rs
= 0, equation (2.38). In
particular, taking the gyroaverage reduces the order of the energy and magnetic moment
∼ O(ε).
terms from ˙EN s ∼ ˙µN s ∼ O(1) to

(cid:68) ˙EN s

(cid:69)

∼ (cid:104) ˙µN s(cid:105)Rs

Rs

2.1.6.3 Maxwellian

We will also need the Maxwellian

fM (Rs) = ns(Rs)

(cid:18) ms

(cid:19)3/2

2πTs(Rs)

exp

(cid:18)

− msv2
2Ts(Rs)

(cid:19)

,

(2.63)

28

and the normalized Maxwellian

fN M = π−3/2 exp(cid:0)−v2

(cid:1) = π−3/2 exp (−EN ) .

(2.64)

N

The density and temperature gradients vanish in this normalization as they are small in ε.
Therefore to obtain an expression for the gradient, we expand the density and temperature
about their reference values to obtain

(cid:20) ∂ns/∂Rs

+

ns

(cid:18) msv2

2Ts

(cid:19) ∂Ts/∂Rs

(cid:21)

Ts

− 3
2

∂fM
∂Rs

=

fM (Rs).

(2.65)

We show in the next section that the density and temperature gradients must be perpen-
dicular to the magnetic ﬁeld, and without loss of generality we take these to be in the X s
direction,

n X s = −∂ns/∂Rs
L−1

ns

,

T X s = −∂Ts/∂Rs
L−1

Ts

,

(2.66)

where the gradients of the Maxwellian (2.65) are assumed constant, and L−1
Thus the normalized gradient is

n ∼ L−1

T ∼ L−1.

(cid:20)

(cid:18)

(cid:19)

(cid:21)

∂fM N
∂Rs

= −

ωn +

N − 3
v2
2

ωT

fM X s,

(2.67)

(2.68)

where the normalized density and temperature gradients are

ωn = L/Ln,

ωT = L/LT .

2.1.6.4 Boltzmann response

The Boltzmann response term, qsF0sϕ/Ts, appears as the particular integral in the solution
to the Fokker–Planck equation at O(1), see (2.81). To use this solution at the next order we
must calculate the full time derivative d/dt(qsF0sϕ/Ts), which is simplest to do in position
space. However this requires care as gradients and time derivatives of F0s and ϕ vary on
different scales. Consequently terms such as
∇⊥(ϕF0s) = F0s∇⊥ϕ + ϕ∇⊥F0s = ε

(FN s0∇N⊥ϕN + εϕN∇N⊥FN s0) ,

(2.69)

nsTr
qrv3
thsρr

are the sums of terms which are at different order in ε. Therefore derivatives of products
must be expanded before normalization.

29

With this proviso, we calculate the time derivative of the Boltzmann response

+ v · ∇ +

(cid:32)
(cid:18) qN svthN sFN 0s
(cid:32)

qs
ms

TN s

qN sFN 0s

=

=

∂
∂t

nsvthr
v3
thsL

+ ε

nsvthr
v3
thsL

∂(cid:101)A

−∇(cid:101)ϕ − 1

c

∂t
vN⊥ · ∇N⊥ϕN

+

(cid:19)

+ vthN svN · ∇N

∂ϕN
∂tN
qN svthN sFN 0s

vN(cid:107)b · ∇N ϕN

c

Ts

(cid:33)

· ∂
∂v

(cid:33)(cid:18)qsF0sϕ
v × (cid:101)B
(cid:19)
(cid:18) qN sFN 0s
(cid:33)

TN s

ϕN

FN 0sϕN vN⊥ · ∇N⊥ϕN

+ O(ε2),

(cid:18) qsF0sϕ
(cid:19)
(cid:32)

Ts

d
dt

TN s

+

+

TN s
q2
N svthN s
T 2
N s

(cid:32)

qN sFN 0s

and its gyroaverage

(cid:28) d

(cid:18) qsF0sϕ

(cid:19)(cid:29)

dt

Ts

= ε

nsvthr
v3
thsL

Rs

(cid:19)

(2.70)

(2.71)

∂(cid:104)ϕN(cid:105)Rs

TN s

∂tN
+ vthN svN(cid:107)b · ∇N

(cid:18) qN sFN 0s

(cid:19)

TN s

(cid:33)
(cid:104)ϕN(cid:105)Rs

+

qN svthN sFN 0s

TN s

vN(cid:107)b · ∇N (cid:104)ϕN(cid:105)Rs

+ O(ε2).

2.2 Derivation of slab gyrokinetic equations

We now solve the Fokker–Planck equation (2.1) order-by-order in ε. From hereon we work
in normalized variables, but for presentation drop the subscript N. The Fokker–Planck
equation to O(ε2) is

(cid:16)

(cid:16) ˙R0 + ε ˙R1
(cid:17)
· ∂ ˜fs
(cid:16) ˙E0 + ε ˙E1
(cid:17) ∂ ˜fs
∂Rs
(cid:88)

∂Es
Css(cid:48)[ ˜fs, ˜fs(cid:48)],

(cid:107)

∂fs
∂t

+

+

=

(cid:18)

(cid:17)
(cid:18)1

⊥

ε

+

ε ˙R1 + ε2 ˙R2

+ ( ˙µ0 + ε ˙µ1)

∂ ˜fs
∂µs

+

· ∂
∂Rs

Fs +

1
ε

˙ϑ0 + ˙ϑ1 + ε ˙ϑ2

(cid:19)
(cid:19) ∂ ˜fs

fs

∂ϑ

(2.72)

s(cid:48)

where ˜fs = Fs + fs with Fs = F0s + εF1s + . . . and fs = εf1s + ε2f2s + . . ., the normalized
version of the distribution function expansion (2.30). We have also written ˙Rs = ˙R0 +

30

ε ˙R1, where ˙R0 is the zeroth-order contribution to ˙Rs and so on. Note that
perpendicular component, ( ˙R0)⊥ = 0.

At O(ε−1) we ﬁnd that the background distribution function F0s is gyrophase indepen-
dent. At O(1) we ﬁnd that F0s is Maxwellian, and that the perturbation f1s can be decom-
posed into the Boltzmann response and the gyrophase-independent distribution function for
guiding centres, hs. At O(ε) we derive the gyrokinetic equation for hs, and the neoclassical
drift-kinetic equation for F1s. We ﬁnish our derivation at O(ε), but continuing to O(ε2) we
would obtain the transport equations [see e.g. 35].

˙R0 has no

Order O(1/ε): gyrotropy of F0s At lowest order we ﬁnd

−Ωs

∂F0s
∂ϑ

= 0,

(2.73)

so that F0s(Rs, Es, µs, t) is gyrotropic, i.e. independent of gyrophase.

Order O(1) At next order we ﬁnd

˙R0 · ∂F0s
∂Rs

+ ˙E0

∂F0s
∂Es

+ ˙µ0

∂F0s
∂µs

+ ˙ϑ0

∂
∂ϑ

(F1s + f1s) =

(cid:88)

s(cid:48)

Css(cid:48)[F0s, F0s(cid:48)].

(2.74)

To solve for F0s we remove the perturbations F1s and f1s by gyroaveraging. In addition the
energy and magnetic moment terms vanish as F0s (and therefore ∂F0s/∂Es and ∂F0s/∂µs)
are gyrotropic, and

= 0. We treat the remaining terms

(cid:69)

(cid:68) ˙E0

= (cid:104) ˙µ0(cid:105)Rs

(cid:42)(cid:88)

Rs

vthsv(cid:107)b · ∂F0s
∂Rs

=

(cid:43)

Css(cid:48)[F0s, F0s(cid:48)]

,

Rs

(2.75)

s(cid:48)

(cid:28)(cid:90)
(cid:90)

=

as in the proof of Boltzmann’s H-theorem: we multiply by (1 + ln F0s), integrate over all
velocities and take the perpendicular average (2.13). The left-hand side becomes

(cid:90)

d3v (1 + ln F0s)vthsv(cid:107)b · ∂F0s
∂Rs

d2r

(cid:96)2

d3v v(cid:107)b · ∂
∂Rs

(F0s ln F0s) =

(cid:29)

⊥

(cid:29)

d3v v(cid:107)b · ∂
∂Rs

(cid:28)(cid:90)
(cid:90)
d3v ∇ ·(cid:2)vthsv(cid:107)b (F0s ln F0s)(cid:3) = 0,

⊥
d3v v(cid:107)b · ∇ (F0s ln F0s)

(F0s ln F0s)

(cid:90)

d2r

(cid:96)2

=

(cid:90)

(cid:90)

=

d2r

(2.76)

where we have used that ∇ = ∂/∂Rs in normalized variables. The ﬁnal expression van-
ishes as the magnetic ﬁeld is orthogonal to the plane of integration.

(cid:96)2

31

The right-hand side of (2.75) becomes

(cid:42)(cid:90)

(cid:42)(cid:88)

s(cid:48)

d3v

ln F0sCss(cid:48)[F0s, F0s(cid:48)]

(cid:43)

(cid:43)

= 0,

(2.77)

⊥

where we have used the fact that the collision operator conserves particle number,

i.e.,(cid:82) d3v Css(cid:48)[F0s, F0s(cid:48)] = 0. By Boltzmann’s H-theorem, (2.77) is solved by a local

Rs

Maxwellian [12]. Substituting this into (2.75) and noting that the equation must hold for
all v(cid:107), we ﬁnd that the Maxwellian must have no parallel gradients and no bulk ﬂow [35],
i.e. it has the form of the Maxwellian introduced in §2.1.6.3. Substituting (2.64) and (2.67)
into (2.74) we ﬁnd
− ˙E0F0s + ˙ϑ0

F0sv · ∇⊥ϕ − Ωs

(F1s + f1s) = 0.

(F1s + f1s) =

(2.78)

qsvths

∂
∂ϑ

∂
∂ϑ

Ts

Using the turbulent average to separate this into mean and ﬂuctuating parts gives

Ωs

Ωs

∂F1s
∂ϑ
∂f1s
∂ϑ

= 0,

=

qsvths

Ts

F0sv · ∇⊥ϕ = −qsΩs
Ts

F0s

∂ϕ
∂ϑ

.

(2.79)

(2.80)

For the last equality in (2.80), we have used the chain rule (2.34), and the fact that the
electrostatic potential ϕ(r) is gyrophase independent in position space, ∂ϕ/∂Θ = 0, but
not in guiding centre space ∂ϕ/∂ϑ (cid:54)= 0. Integrating with respect to ϑ we ﬁnd that F1s is
gyrotropic, and that

f1s = hs − qs
Ts

F0sϕ

(2.81)

where hs(Rs, Es, µs) is the ϑ-independent complementary function. Thus f1s is composed
of a Boltzmann response −qsF0sϕ/Ts, and the complementary function hs which we inter-
pret as the distribution function for guiding centres. We ﬁnd an evolution equation for hs
at next order in ε.

Order O(ε) The Fokker–Planck equation at O(ε) is

∂hs
∂t

(cid:18)

+ ˙E1

+ ˙R0 · ∂
∂Rs
∂F0s
∂Es
−qsF0s
Ts

(cid:18)

d
dt

+

+

(F1s + hs) + ˙R1 · ∂
∂Rs

(F0s + hs)

(cid:19)

∂
∂Es

˙E0

(cid:19)

ϕ

=

+ ˙µ0

(cid:88)

∂
∂µs

(F1s + hs) + ˙ϑ0

∂
∂ϑ

(F2s + f2s)

(2.82)

(Css(cid:48)[F0s, F1s(cid:48) + hs(cid:48)] + Css(cid:48)[F1s + hs, F0s(cid:48)]) ,

s(cid:48)

32

where we have separated f1s into hs and the Boltzmann response. Notice that the Boltz-
mann response, being Maxwellian, vanishes from the collision operator. For convenience,
we evaluate the full time derivative of the Boltzmann response in position space (r, v), as
given by (2.70). As before we remove higher-order perturbations by gyroaveraging. Using
the gyrotropy of F0s, F1s and hs, we ﬁnd

(F1s + hs) + (vD + vχ) · ∂
∂Rs

(cid:42)(cid:88)

(F0s + hs)

(cid:43)

+

(Css(cid:48)[F0s, F1s(cid:48) + hs(cid:48)] + Css(cid:48)[F1s + hs, F0s(cid:48)])

∂hs
∂t

=

+ vthsv(cid:107)b · ∂
∂Rs
∂(cid:104)χs(cid:105)Rs

qsF0s

Ts

∂t

where

,

Rs

(2.83)

(2.84)

s(cid:48)

vχ =

(cid:20)

b × ∇(cid:104)χs(cid:105)Rs

,

1
2

(cid:21)

is the drift velocity due to the ﬂuctuating gyrokinetic potential (2.35), and

vD =

b ×

Ts
qs

v2(cid:107)(b · ∇)b +

v2⊥∇ ln B0

1
2

,

(2.85)

is the guiding-centre drift velocity with terms corresponding to the curvature drift and ∇B
drift respectively. We have also used the gyroaverage of the Boltzmann response time
derivative (2.71).

We separate (2.83) into mean and ﬂuctuating parts using the turbulent average. This

gives an equation for the neoclassical distribution function F1s,

vthsv(cid:107)b · ∂F1s
∂Rs

+ vD · ∂F0s
∂Rs

(cid:42)(cid:88)
+(cid:0)vthsv(cid:107)b + vD + vχ(cid:1) · ∂hs

=

s(cid:48)

∂hs
∂t

∂Rs
∂(cid:104)χs(cid:105)Rs

+

∂t

=

qsF0s

Ts

+ vχ · ∂F0s
∂Rs

(cid:42)(cid:88)

and the gyrokinetic equation for the guiding centre distribution hs,

(cid:43)

Rs

(cid:43)

(2.87)

(Css(cid:48)[F0s, F1s(cid:48)] + Css(cid:48)[F1s, F0s(cid:48)])

,

(2.86)

(Css(cid:48)[F0s, hs(cid:48)] + Css(cid:48)[hs, F0s(cid:48)])

.

Rs

s(cid:48)

2.2.1 Maxwell’s equations

It remains to express the electromagnetic ﬁeld in terms of the guiding centre distribution
hs. The ﬁelds enter the gyrokinetic equation only through the gyroaveraged gyrokinetic
potential (cid:104)χs(cid:105)Rs
, so we relate the potentials ϕ and A to integrals of
hs via Gauss’ and Amp`ere’s laws.

= (cid:104)ϕ − vthsv · A(cid:105)Rs

33

The electromagnetic ﬁeld is deﬁned by four scalar ﬁelds (ϕ, Ax, Ay, A(cid:107)). However,
imposing the Coulomb gauge ∇ · A = 0, we may describe the electromagnetic ﬁeld com-
pletely using three scalar ﬁelds ϕ, A(cid:107) and B(cid:107) as follows. To leading order, the normalized
ﬁelds (2.49), (2.50) are

(∇⊥ × A) ,

1
2

B =
E = −∇⊥ϕ.

(2.88)

(2.89)

(cid:0)∇⊥A(cid:107) × b(cid:1) + B(cid:107)b,

Writing A = A(cid:107)b + A⊥, (2.88) becomes

(cid:0)∇⊥A(cid:107) × b(cid:1) +

1
2

(∇⊥ × A⊥) =

1
2

1
2

B =

(2.90)
where B(cid:107) = b · (∇⊥ × A⊥)/2. Further, when written in Fourier space, the gyroaveraged
gyrokinetic potential (cid:104)χs(cid:105)Rs
is also a function of only the three scalars ϕ, A(cid:107) and B(cid:107), as we
show in §2.4.2. Thus we close the system by relating ϕ, A(cid:107) and B(cid:107) to integrals of hs via
quasineutrality and Amp`ere’s law.

The scalars ϕ, A(cid:107) and B(cid:107) are functions of position space r, but Maxwell’s equations
relate these to velocity space integrals of distribution functions which are functions of guid-
ing centre space. The velocity space integrals are therefore evaluated at ﬁxed r and conse-
quently a gyroaverage of the distribution function appears

d3v a(Rs(r, v), V s(r, v)) = 2π

dv(cid:107)dv⊥ v⊥ (cid:104)a(Rs, V s)(cid:105)r =

(cid:90)

d3v (cid:104)a(Rs, V s)(cid:105)r .
(2.91)

(cid:90)

(cid:90)

2.2.1.1 Gauss’ Law and quasineutrality

Gauss’ law in normalized units is

−ε (λDr/ρr)2 ∇2⊥ϕ + O(cid:0)ε2λ2
(cid:88)

(cid:90)

qsns

(cid:88)

(cid:1) =

s

(cid:69)

(cid:68) ˜fs

.

r

d3v

(2.92)

Dr/ρ2
r

At leading order only the right-hand side remains, so that using the leading order distribu-
tion function F0s = π−3/2e−v2, we see that the plasma is neutral overall,

Neglecting Debye length effects λDr (cid:28) ρr, the left-hand side also vanishes at O(ε). Fur-
ther, separating the equation into mean and ﬂuctuating parts using the turbulent average,
we obtain the equation for the ﬂuctuating part at O(ε) as

(cid:90)

(cid:88)

s

qsns

d3v

−qsϕ
Ts

F0s + hs

= 0.

r

(2.93)

(2.94)

qsns = 0.

s

(cid:28)

34

(cid:29)

Integrating the Boltzmann response term and noting that both ϕ(r) and F0s = π−3/2e−v2
are independent of Rs, we obtain the quasineutrality condition
d3v (cid:104)hs(cid:105)r .

(cid:88)

(cid:88)

(2.95)

(cid:90)

qsns

ϕ =

q2
s ns
Ts

s

2.2.1.2 Amp`ere–Maxwell law

The Amp`ere–Maxwell law is

s

(cid:18)

ε2 v2
thr
c2

(cid:19)

.

qsnsvths

˜j + O

(cid:88)

s

∇ × (cid:101)B = βr
(cid:88)

∇ × (cid:101)B = εβr

(cid:90)

Using the deﬁnition of the current (2.7), this becomes

qsnsvths

d3v (cid:104)v(F1s + hs)(cid:105)r ,

s

correct to O(ε). Integrals of the Maxwellian parts of the distribution function have van-
thr/c2 (cid:28) 1, the
ished as these are odd in v. Note that as the plasma is nonrelativistic v2
displacement current is negligible even for very low beta βr ∼ ε2.

Separating (cid:101)B using the turbulent average gives the ﬂuctuating part
d3v (cid:104)vhs(cid:105)r ,

∇ × B = βr

(cid:88)

qsnsvths

(2.98)

(cid:90)

(2.96)

(2.97)

where the integral is evaluated at ﬁxed r. Using (2.90) then gives

(cid:90)

qsnsvths

d3v (cid:104)vhs(cid:105)r ,

(2.99)

so that the parallel component is

Taking the perpendicular curl of (2.99) gives the perpendicular component

−∇2⊥B(cid:107) = b ·

∇⊥ × βr

qsnsvths

d3v (cid:104)v⊥hs(cid:105)r

.

(2.101)

(2.100)

d3v v(cid:107) (cid:104)hs(cid:105)r .
(cid:90)

(cid:35)

s

(cid:88)

s

(cid:90)

−1
2

∇2⊥A(cid:107)b + ∇B(cid:107) × b = βr
(cid:88)

−∇2⊥A(cid:107) = 2βr

qsnsvths

s

(cid:34)

(cid:88)

s

35

2.2.2 Summary

The gyrokinetic-Maxwell system consists of the gyrokinetic equation

∂hs
∂t

+(cid:0)vthsv(cid:107)b + vD + vχ(cid:1) · ∂hs
(cid:42)(cid:88)

∂(cid:104)χs(cid:105)Rs

qsF0s

∂Rs

=

Ts

∂t

+ vχ · ∂F0s
∂Rs

+

(Css(cid:48)[F0s, hs(cid:48)] + Css(cid:48)[hs, F0s(cid:48)])

,

Rs

s(cid:48)

(cid:43)

with the gyrokinetic potential

and the drift velocities

χs = ϕ − vthsv · A,

(cid:20)

1
vχ =
2
v2(cid:107)(b · ∇)b +

(cid:21)
b × ∇(cid:104)χs(cid:105)Rs
v2⊥∇ ln B0

1
2

,

,

vD =

b ×

Ts
qs

coupled to the quasineutrality condition, and the parallel and perpendicular components of
Amp`ere’s law

(2.102)

(2.103)

(2.104)

(2.105)

(2.106a)

(2.106b)

(cid:88)
q2
s ns
(cid:88)
Ts
−∇2⊥A(cid:107) = 2βr
(cid:34)
(cid:88)

∇⊥ × βr

s

s

(cid:88)

s

(cid:90)

(cid:90)

ϕ =

qsns

qsnsvths

(cid:90)

d3v (cid:104)hs(cid:105)r ,
d3v v(cid:107) (cid:104)hs(cid:105)r ,
(cid:35)

−∇2⊥B(cid:107) = b ·

qsnsvths

d3v (cid:104)v⊥hs(cid:105)r

.

(2.106c)

2.3 Free energy

s

The collisionless gyrokinetic-Maxwell system with no background gradients conserves free
energy,

(cid:19)

(cid:35)

d3v

n0sT0s (cid:104)h2
s(cid:105)r
2F0

s ϕ2

− n0sq2
2T0s

|B|2
βr

+

,

(2.107)

(cid:90)

(cid:34)(cid:88)

(cid:18)(cid:90)

s

W =

d3r

a quadratic invariant which we show in Chapter 3 is related to Boltzmann entropy. To
write a global budget equation for W we multiply the gyrokinetic equation (2.102) by

36

nsT0shs/F0, sum over species, and integrate over all velocities and guiding centres,

(cid:19)(cid:33)

(cid:18) nsT0sh2

(cid:90)
(cid:90)
−(cid:88)
d3v(cid:0)vthsv(cid:107)b + vD + vχ(cid:1) · ∂

2F0s

d3v

s

s

(cid:90)
(cid:18) nsT0sh2

s

(cid:19)

d3Rs

d3vqsnshs

∂Rs

∂(cid:104)χs(cid:105)Rs

∂t

d3v

nsT0shs

F0s

d3v

nsT0shs

F0s

vχ · ∂F0s
∂Rs

(cid:42)(cid:88)

(Css(cid:48)[F0s, hs(cid:48)] + Css(cid:48)[hs, F0s(cid:48)])

.

Rs

s(cid:48)

2F0s

(cid:43)

(2.108)

(cid:90)

s

(cid:32)(cid:88)
(cid:90)
(cid:88)
(cid:90)
(cid:88)
(cid:90)
(cid:88)

s

s

s

d
dt

+

+

=

d3Rs

(cid:90)
(cid:90)
(cid:90)

d3Rs

d3Rs

d3Rs

C =

(cid:90)

(cid:88)

s

=

=

d
dt

d
dt

The integrand on the second line is a divergence because the velocities v(cid:107)b, vD and vχ are
divergence-free. Therefore the second line vanishes. The third line is the source of free
energy due to background temperature and density gradients,

(cid:90)

(cid:88)

s

T =

d3Rs

(cid:90)
(cid:42)(cid:88)

The ﬁnal line is a collisional sink of free energy,

(cid:90)

(cid:90)

(cid:88)

s

d3Rs

d3v

nsT0shs

F0s

d3v

nsT0shs

F0s

vχ · ∂F0s
∂Rs

.

(2.109)

(cid:43)

(Css(cid:48)[F0s, hs(cid:48)] + Css(cid:48)[hs, F0s(cid:48)])

,

(2.110)

s(cid:48)

Rs

which is non-positive, owing to Boltzmann’s H-theorem [35].

The ﬁrst line of (2.108) may be written as a single time derivative: the second term is
(ϕ − vthsv · A)

d3v qsnshs

d3Rs

d3r

=

(cid:90)

(cid:90)
(cid:32)(cid:88)
(cid:32)(cid:88)

s

(cid:90)
(cid:90)

d3r

d3r

∂(cid:104)χs(cid:105)Rs
(cid:33)

∂t

s nsϕ2
q2
2Ts

(cid:90)

(cid:88)
(cid:90)

s

− 1
βr

(cid:90)

s nsϕ2
q2
2Ts

− 1
βr

d3r |B|2

,

∂
∂t

d3v qsns (cid:104)hs(cid:105)r
(cid:33)

d3r (∇ × B) · ∂A
∂t

s

where the ﬁrst equality uses the identity(cid:82) d3Rs (cid:104)h(Rs)χ(r)(cid:105)Rs
(cid:18)

and the deﬁnition χs = ϕ − vthsv · A, the second equality uses Maxwell’s equations (2.98)
and (2.106a), and the ﬁnal equality uses the identity
B × ∂A
∂t
B × ∂A
∂t

= (cid:82) d3r (cid:104)h(Rs)χ(r)(cid:105)r,
(cid:19)

(∇ × B) · ∂A
∂t

∇ × ∂A
∂t

∂|B|2
∂t

(cid:18)
(cid:18)

(cid:19)
(cid:19)

+ B ·

= ∇ ·

= ∇ ·

(2.112)

(2.111)

+

.

37

Thus (2.108) becomes the free energy balance equation

+ T = C,

dW
dt

(2.113)

showing that free energy (2.107) is conserved in the absence of collisions and driving gra-
dients.

2.3.1 Electrostatic invariant

(cid:90)

nsq2
s
Ts

E =

d3r

ϕ (1 − Γ0) ϕ,

In addition to free energy, the two-dimensional electrostatic gyrokinetic-Maxwell system
also conserves the “electrostatic invariant”

(cid:88)
(cid:10)(cid:104)ϕ(cid:105)Rs
(cid:11)
where Γ0 is the operator Γ0ϕ =(cid:82) d3v F0s
(cid:32)(cid:88)
(cid:28)(cid:0)vthsv(cid:107)b + vD + vϕ(cid:1) · ∂hs
(cid:88)
(cid:29)

r. To see this, we take the gyroaverage
(cid:104)·(cid:105)r of (2.102), multiply by nsqs, sum over species and integrate over all velocity space to
give

(1 − Γ0) ϕ

(cid:33)
(cid:28)

nsq2
s
Ts

(cid:90)

r

(2.115)

(2.114)

+

d3v

nsqs

(cid:29)

∂
∂t

(cid:90)

∂Rs

s

s

+

d3v

nsqs

vϕ · ∂F0s
∂Rs

s

= 0,

r

(cid:88)

s

where vϕ = b × ∇(cid:104)ϕ(cid:105)Rs
/2, and where we have used quasineutrality (2.106a) on the ﬁrst
term. The velocity integral of the collision term vanishes as collisions are mass conserving.
Multiplying by ϕ and integrating over all position space, we obtain the equation for the
electrostatic invariant

(cid:90)

(cid:90)

dE
dt

+

d3r

d3v

nsqsϕ

vthsv(cid:107)b · ∂hs
∂Rs

= 0.

r

(2.116)

(cid:28)

(cid:88)

s

(cid:29)

Generally the second term is nonzero, so that E is not conserved. However, in the two-
dimensional case, there can be no parallel variation, so that b · ∂hs/∂Rs = 0 and the
electrostatic invariant is conserved.

2.4 Computational forms of the gyrokinetic equations

In this section we derive the various forms of the gyrokinetic-Maxwell system used in this
thesis. Firstly in §2.4.1 we replace the guiding centre distribution function hs with the
complementary distribution function gs used for computation in SPECTROGK. This yields

38

the most general set of equations implemented in SPECTROGK. We then derive reduced
equations by taking simplifying limits of the gyrokinetic-Maxwell system. All equations
we study have adiabatic electrons (derived in §2.4.3.1) and are electrostatic (derived in
§2.4.3.2). Finally in §2.4.3.3 we neglect ﬁnite Larmor radius effects to derive the drift
kinetic equation studied in Chapters 3, 6 and 7.

2.4.1 Complementary distribution function

The gyrokinetic-Maxwell system (2.102)–(2.106) is written in terms of the guiding centre
distribution hs, as is usual for theoretical discussion [e.g. 44]. We now write the system in
terms of the complementary distribution function

With this, the gyrokinetic equation becomes

gs = hs − qs
Ts

F0s.

(2.117)

(cid:104)χs(cid:105)Rs
(cid:18)
(cid:19)
(cid:18)

1
2

+

F0

(cid:19)
(cid:21) ∂(cid:104)χs(cid:105)Rs

∂Rs

b × ∂(cid:104)χs(cid:105)Rs
(cid:19)

· ∂gs
∂Rs

v2⊥ + v2(cid:107) − 3
2

ωT

∂Ys

(2.118)

F0

(cid:18)

∂gs
∂t

∂
∂Zs

(cid:2)2κv2(cid:107) + L−1

gs +

+ vthsv(cid:107)
− 1
2
1
2

(cid:20)
Ts
qs
−2κv2(cid:107) − L−1
= ν (cid:104)C[hs](cid:105)Rs

+

,

qs
Ts

(cid:104)χs(cid:105)Rs
(cid:3) ∂gs

∂Ys

B v2⊥

B v2⊥ + ωn +

where Rs = (Xs, Ys, Zs). This is a convenient form for computation, as the gyrokinetic
equation now contains only one time derivative term. Moreover, this form is analogous
to the Vlasov equation studied by, among others, LANDAU [58], VAN KAMPEN [59] and
CASE [60]. This allows us to apply their work on the Vlasov equation to the gyrokinetic
equation in Chapter 3.

2.4.2 Fourier space representation

As the spatial domain is triply periodic, we express both functions of position and guiding
centre space as Fourier series

(cid:88)

(cid:88)

where(cid:80)

gs(Rs) =

eik·Rs ˆgs(k),

ϕ(r) =

eik·r ˆϕ(k),

(2.119)

k

k

k denotes the sum over all wavevectors k = (kx, ky, k(cid:107))T . Wavenumbers kx, ky
and k(cid:107) are related to the lengths Lx, Ly, Lz which deﬁne the periodic box Ω = [0, Lx] ×
[0, Ly] × [0, Lz], with kx ∈ {0, 1/x0, 2/x0, . . .} and x0 = Lx/2π, and similarly in y and

39

z. Where unambiguous, we also denote Fourier components with a subscript k, e.g. ϕk ≡
ˆϕ(k). We derive the inverses to (2.119) using the orthogonality formula

d3Rs ei(k−k(cid:48))·Rs = δ(k − k(cid:48)),

(2.120)

(cid:90)

Ω

1
V

where V = LxLyLz is the volume of the box, and δ is the Kronecker delta which is unity if
all components of k and k(cid:48) are equal, and zero otherwise. With this, the respective inverses
to (2.119) are

ˆgs(k) =

1
V

d3Rs e−ik·Rsgs(Rs),

ˆϕ(k) =

1
V

d3r e−ik·rϕ(r).

(2.121)

The Fourier modes interact very neatly with the gyroaverage (2.36), with gyroaveraging

(cid:90)

Ω

leading to factors of Bessel functions due to the relation [61]
dϑ ei(nϑ−x sin ϑ).

Jn(x) =

(cid:90) 2π

0

1
2π

We use this to calculate gyroaverages. Choosing the direction of k⊥ = k⊥ ˆx to simplify
the algebra (but not change the phase-independent results), we have ρs = ρsb × v =
ρsv⊥(− sin ϑˆx + cos ϑˆy) and v⊥ = v⊥(cos ϑˆx + sin ϑˆy), so we deduce

(2.122)

(2.123)

(2.124)

(cid:90)

Ω

(cid:19)

(cid:43)

Rs

Rs

=

=

0

0

0

=

1
2π
1
2π
1
2π
iv⊥
k⊥

(cid:90) 2π
(cid:10)eik·r(cid:11)
(cid:90) 2π
(cid:90) 2π
(cid:10)veik·r(cid:11)
and similarly(cid:10)eik·Rs(cid:11)
(cid:42)(cid:88)
(cid:20)
(cid:88)

potential as
(cid:104)χs(cid:105)Rs

=

=

k

=

k

dϑ eik·(Rs+ρsb×v)

(cid:18) eiϑ + e−iϑ

2

dϑ v⊥

J1(ρsk⊥v⊥)eik·Rsk × b,

dϑ eik·Rse−iρsk⊥v⊥ sin ϑ = J0(ρsk⊥v⊥)eik·Rs,

eiϑ − e−iϑ

2i

ˆy

ˆx +

e−iρsk⊥v⊥ sin ϑeik·Rs

r = J0(ρsk⊥v⊥)eik·r, etc. With these we can write the gyrokinetic

(cid:0)ϕk − vthsv(cid:107)A(cid:107)k − vthsv⊥ · A⊥k

(cid:1) eik·r

J0(as)ϕk − vthsv(cid:107)J0(as)A(cid:107)k +

Rs
2v2⊥J1(as)

as

Ts
qs

B(cid:107)k

(cid:21)

eik·Rs,

(2.125)

where as = ρsk⊥v⊥, and we have used Ak = 2Bk × k⊥/(ik2⊥) which follows from (2.88).
We deﬁne the (velocity-dependent) Fourier component of the gyrokinetic potential

(cid:104)χs(cid:105)Rs,k = J0(as)ϕk − vthsv(cid:107)J0(as)A(cid:107)k +

Ts
qs

2v2⊥J1(as)

as

B(cid:107)k.

(2.126)

This simpliﬁes further calculation as (2.126) is gyrophase independent, so we may ﬁnd the
gyroaverage of (cid:104)χs(cid:105)Rs

(2.125) using only the gyroaverage of Fourier modes (2.123).

40

Inserting the Fourier series (2.119) into the gyrokinetic equation (2.118) and applying the

2.4.2.1 Gyrokinetic-Maxwell system in Fourier space

operator V −1(cid:82)

(cid:18)

Ω d3Rs e−ik·Rs, we obtain
(cid:20)

gsk +

+ ivthsv(cid:107)k(cid:107)

∂gsk
∂t

B v2⊥ + ωn +

(cid:19)
(cid:18)
(cid:104)χs(cid:105)Rs,k F0
v2⊥ + v2(cid:107) − 3
2

+(cid:8)(cid:104)χs(cid:105)Rs
(cid:1) gsk = ν (cid:104)C[hs](cid:105)Rs,k ,
(cid:88)

=

1
2

k(cid:48)

qs
Ts
−2κv2(cid:107) − L−1
Ts
qs

(cid:0)2κv2(cid:107) + L−1
(cid:9)
(cid:8)(cid:104)χs(cid:105)Rs

, gs

k

B v2⊥

+

iky
2
− iky
2

where the nonlinear term is

(cid:9)

, gs

(cid:19)

(cid:21)

k

b · (k × k(cid:48))(cid:104)χs(cid:105)Rs,k(cid:48) gk−k(cid:48).

(2.128)

Further, inserting the complementary distribution function (2.117) and gyrokinetic poten-
tial (2.125) into Maxwell’s equations (2.106), we obtain

(1 − Γ0s) − B(cid:107)k

qsnsΓ1s =

qsns

d3v gskJ0(as),

(2.129a)

ωT

(cid:104)χs(cid:105)Rs,k F0

(2.127)

(cid:90)

(cid:88)

s

(cid:90)
(cid:33)

s

(cid:88)
(cid:34)
(cid:88)

ϕk

A(cid:107)k

nsq2
s
Ts

k2⊥
2βr

+

(cid:88)

s

s

(cid:88)
(cid:88)
(cid:88)

s

(cid:35)

=

2
βr

+

q2
s ns
2ms

Γ0s

(cid:32)

ϕk

where

nsqsΓ1s + B(cid:107)k

s

(cid:90)

d3v

Γ1s =

d3v gskv(cid:107)J0(as),

(2.129b)

qsnsvths

TsnsΓ2s

= −(cid:88)

s

s

(cid:90)

nsTs

d3v gskv2⊥

2J1(as)

as

,

(cid:90)
(cid:18)2v2⊥

as

(cid:19)2

Γ0s =

(cid:90)

as

d3v

2v2⊥J0(as)J1(as)

d3v J0(as)2F0(v) = I0(bs)e−bs,
F0(v) = (I0(bs) − I1(bs))e−bs,

Γ2s =

J1(as)2F0(v) = 2Γ1(bs),

(2.129c)

(2.130a)

(2.130b)

(2.130c)

with bs = (ρsk⊥)2/2 and with I0, I1 the modiﬁed Bessel functions [55]. The equations
(2.127)–(2.129) are solved by SPECTROGK, as discussed in Chapter 5.

Finally, we may write the free energy (2.107) in terms of the complementary distribu-

tion function in Fourier space
n0sT0s|gk|2

W =

d3v

+

2F0

(cid:90)

(cid:88)

s,k

(cid:88)

(cid:88)

k

+

k2⊥|A(cid:107)k|2

4βr

+

(cid:88)

k

.

|B(cid:107)k|2
βr
(2.131)

s (1 − Γ0s)|ϕk|2

n0sq2

s,k

2T0s

41

2.4.3 Simpliﬁed equations

We now derive a series of simpliﬁed equation sets used in this thesis from a number of limits
of the gyrokinetic-Maxwell system (2.127)–(2.129). Firstly we show the adiabatic electron
closure in §2.4.3.1 which reduces the two species system to a system for just ions. This
assumes electrons are massless and have inﬁnite velocity so that the electron equilibrium
distribution instantaneously forms. We then neglect magnetic ﬁeld perturbations, deriving
the electrostatic equations for ions in §2.4.3.2. Finally in §2.4.3.3 we remove ﬁnite Larmor
radius effects to derive the drift kinetic equation. The linearized drift kinetic equation
provides the paradigm for Landau damping which we study in Chapter 3, while we study
the properties of nonlinear drift kinetic turbulence in Chapters 6 and 7.

2.4.3.1 Adiabatic electrons

We ﬁrst derive the adiabatic closure, where massless electrons instantaneously assume their
equilibrium distribution. Formally we take the limit me → 0, vthe → ∞ such that Te =
the remains constant. In this limit, ﬁnite electron Larmor radius effects are removed as
mev2
ρe = vthe/Ωe = Te/(qevthe) → 0. With the limits

lim
x→0

J0(x) = lim
x→0

= lim
x→0

I0(x) = 1,

2J1(x)

x

lim
x→0

I1(x) = 0,

(2.132)

the gyrokinetic equation (2.127) for electrons is still

(cid:18)

(cid:19)
(cid:18)
(cid:104)χe(cid:105)Re,k F0

+(cid:8)(cid:104)χe(cid:105)Re
(cid:19)
(cid:1) gke = ν (cid:104)C[he](cid:105)Re,k ,

v2⊥ + v2(cid:107) − 3
2

, ge

(cid:9)

(cid:21)

k

ωT

B v2⊥ + ωn +

∂gke
∂t

+ ivthev(cid:107)k(cid:107)

(cid:20)

gke +

qe
Te
−2κv2(cid:107) − L−1
Te
qe

(cid:0)2κv2(cid:107) + L−1

B v2⊥

+

iky
2
− iky
2

(cid:104)χe(cid:105)Re,k F0

(2.133)

but where the gyrokinetic potential (2.126) is now

(cid:104)χe(cid:105)Re,k = ϕk − vthev(cid:107)A(cid:107)k +

Te
qe

v2⊥B(cid:107)k.

(2.134)

We solve (2.133), interpreting vthe as a large expansion parameter. At O(v2
the) only the
second term in the ﬁrst parenthesis of (2.133) remains, giving A(cid:107)k = 0. Thus gke ∼
(cid:104)χe(cid:105)Re,k ∼ O(1), so at O(vthe) the only contribution is from the remainder of the streaming
term, which gives

gke = − qe
Te

ϕkF0 − v2⊥B(cid:107)kF0.

(2.135)

42

Maxwell’s equations become

(1 − Γ0i) − B(cid:107)k (qiniΓ1i + qene) =

ϕk

niq2
i
Ti

(cid:88)

(cid:90)

qsns

(cid:88)

s

d3v gskJ0(as),

0 =

qsnsvths

d3v gskv(cid:107)J0(as),

s

ϕk (neqe + niqiΓ1i) + B(cid:107)k

(cid:18) 2

βr

+ 2Tene + TiniΓ2i

(cid:19)

= −(cid:88)

nsTs

(cid:90)

d3v gskv2⊥

s

(2.136c)
where Γ0e = 1, Γ1e = 1 and Γ2e = 2. The velocity space integrals are found for electrons
by inserting gke (2.135) and noting ae → 0, resulting in simple integrals of Maxwellians.
Further simplifying by using ni = ne and qi = −qe, we obtain

(cid:19)

(cid:90)

(cid:18)

ϕk

niq2
i
Ti

1 +

Ti
Te

ϕkniqiΓ1i + B(cid:107)k

− Γ0i

− B(cid:107)kqiniΓ1i = qini

d3v gikJ0(ai),

(cid:18) 2

βr

(cid:19)

(cid:90)

0 = qinivthi
= −niTi

+ TiniΓ2i

d3v v(cid:107)gikJ0(ai),

d3v v2⊥gik

2J1(ai)

ai

.

(2.136a)

(2.136b)

2J1(as)

as

,

(2.137a)

(2.137b)

(2.137c)

(cid:90)

(cid:90)

This is almost the same as the A(cid:107)k = 0, single species case of Maxwell’s equations (2.129),
i /Ti)(Ti/Te) on
however equation (2.137a) contains an extra temperature ratio term (ϕkniq2
the left-hand side. The gyrokinetic equation for ions is

∂gki
∂t

+ ivthiv(cid:107)k(cid:107)

(cid:20)

gki +

qi
Ti
−2κv2(cid:107) − L−1
Ti
qi

(cid:0)2κv2(cid:107) + L−1

+

iky
2
− iky
2

(cid:19)
(cid:18)
(cid:104)χi(cid:105)Ri,k F0
, gi
v2⊥ + v2(cid:107) − 3
2

+(cid:8)(cid:104)χi(cid:105)Ri
(cid:1) gki = ν (cid:104)C[hi](cid:105)Ri,k .

(cid:9)
(cid:19)

B v2⊥ + ωn +

B v2⊥

(cid:21)

k

ωT

(cid:104)χi(cid:105)Ri,k F0

(2.138)

Equations (2.137)–(2.138) are solved by SPECTROGK when a single ion species is se-
lected.

2.4.3.2 Electrostatic equations

The one species, electrostatic version of gyrokinetics, solved in Chapter 6, is found by
setting A(cid:107) = B(cid:107) = 0 in (2.137)–(2.138) so that ϕ replaces χi in the gyrokinetic equation.
We also neglect magnetic ﬁeld inhomogeneities (κ = L−1

B = 0), so that

(cid:18)

(cid:18)

∂gki
∂t

(cid:20)

+ ivthiv(cid:107)k(cid:107)

+

iky
2

ωn +

qi
Ti

(cid:19)
(cid:104)ϕ(cid:105)Ri,k F0

(cid:18)
gki +
v2⊥ + v2(cid:107) − 3
2

(cid:104)ϕ(cid:105)Ri,k F0 = ν (cid:104)C[hi](cid:105)Ri,k ,

(2.139)

+(cid:8)(cid:104)ϕ(cid:105)Ri

(cid:9)

, gi

k

(cid:19)
(cid:21)

ωT

43

with the electrostatic potential determined using quasineutrality

(cid:18)

(cid:19)

(cid:90)

ϕk

niq2
i
Ti

1 +

− Γ0i

Ti
Te

= qini

d3v gikJ0(ai).

(2.140)

As quasineutrality alone is sufﬁcient to determine the electrostatic potential, Amp`ere’s law
is not considered.

2.4.3.3 Drift kinetic equations

Finally, we derive the drift kinetic equations by considering the long perpendicular wave-
length limit k⊥ (cid:28) 1. This removes ﬁnite Larmor radius effects so that (cid:104)ϕ(cid:105)Ri,k = ϕk
and Γ0i = 1. Further, assuming that gki is proportional to a Maxwellian in perpendicular
velocity space, we obtain

(cid:18)

(cid:19)

(cid:20)

∂gki
∂t

+ ivthiv(cid:107)k(cid:107)

gki +

(cid:107)
0

ϕkF

qi
Ti

+

iky
2

ωn +

(cid:18)
(cid:19)
(cid:110)
v2(cid:107) − 1
2

(cid:21)
(cid:111)

(cid:107)
ϕkF
0

ωT

+

ϕk, gs

= νC[hi],

k

(2.141a)

(2.141b)

ϕk

niq2
i
Ti

where F

(cid:18) Ti

(cid:19)

(cid:90) ∞

Te

= qini

dv(cid:107) gik,
−∞
√
0 (v(cid:107)) = exp(−v2(cid:107))/
(cid:107)
(cid:110)

(cid:111)

ϕk, gs

=

k

1
2

(cid:88)

k(cid:48)

π, and the nonlinear term is

b · (k × k(cid:48))ϕk(cid:48)gk−k(cid:48).

(2.142)

In the development of our collision operator and spectral method in Chapter 3, we study
the linearized version of (2.141) obtained by neglecting this nonlinear term.

44

Part II

Numerical Methods

45

Chapter 3

Parallel velocity space and the Hermite
spectral representation

Having derived the gyrokinetic-Maxwell system in Chapter 2, we now turn our attention to
its numerical solution. Due to the high dimensionality, simulations of large domains (like
whole tokamaks) are barely feasible. Even smaller domains (like ﬂux-tube simulations of
a tokamak section) require upwards of hundreds of thousands of CPU hours each. Even so,
resolution is usually coarse. For example, recent numerical work by HIGHCOCK ET AL.
[62] with the gyrokinetic code GS2 [57] used 64×32×14 points for physical space and 24×
8 × 2 on a pitch angle-energy-sign grid in velocity space. That is, over 11 million degrees
of freedom, but still modest resolution in each dimension. The velocity space resolution
above uses the equivalent of a grid of 16 points in parallel velocity space, while other recent
studies [63–66] typically use between 32 to 128 points for parallel velocity space. Since
the problem size is this multiplied by the resolutions in the four other dimensions, there is
a strong motivation to improve the treatment of the parallel velocity degrees of freedom.

In this Chapter and the next, we study spectral representations for parallel and per-
pendicular velocity space respectively, with the goal of deriving a representation for the
distribution function which requires little resolution, but nonetheless can capture impor-
tant features of the solution (like Landau damping, described shortly). To investigate the
representation of parallel velocity space, we use the linearized model for drift-kinetic ions
derived in §2.4.3.3,

∂g
∂t

+ ikv (g + ϕF0) + i

˜ωn +

˜ωT

ϕF0 = νC[g],

(cid:20)

(cid:18)

(cid:19)

(cid:21)

v2 − 1
2

(cid:90) ∞

−∞

ϕ =

dv g,

(3.1a)

(3.1b)

where ˜ωn = kyωn/2 and ˜ωT = kyωT /2. For brevity we have written the complementary
distribution function as g = gki and electrostatic potential as ϕ = ϕk. We have also dropped

46

the subscript (cid:107) on the parallel wavenumber k, parallel velocity v, and parallel Maxwellian
√
F0 = exp(−v2)/
π. As the system is linear, we may study different wavenumbers in-
dependently, so we write the full distribution function as F (z, v, t) = F0(v) + eikzg(v, t).
Further, we have chosen ions to be the reference species in the normalization (r = i in
§2.1.6), so the normalized charge, temperature, and thermal velocity appearing in (2.141)
are all unity.

This system was recently studied numerically by PUESCHEL ET AL. [66] using the
GENE code [25]. For comparison with that work, we choose the parameters ˜ωn = 0.3
and ˜ωT = 3.0, and consider the parallel wavenumbers k ∈ [0, 8αi], where the constant
αi = 0.34 is a dimensionless combination of length and velocity scales arising from the
normalization used in GENE [see 66]. This system exhibits a wide range of growing and
decaying behaviour in the electrostatic potential ϕ, and is therefore a useful benchmark for
numerical methods.

3.0.1 Landau damping

We begin by describing the analytic solution to (3.1), where the presence of a destabilising
density gradient ˜ωn and temperature gradient ˜ωT requires a small amendment to the text-
book theory of Landau damping and Case–Van Kampen modes [67]. We then discuss
how this theory changes when velocity space is discretized, as is necessary in numerical
solutions.

Writing (3.1) in operator notation, we have

∂g
∂t

where Lν is the operator deﬁned by

(cid:20)

Lν[g] = kvg +

˜ωn + ˜ωT

= −iLν[g],

(cid:18)

v2 − 1
2

(cid:19)

(cid:21)

+ kv

ϕF0 + iνC[g],

(3.2)

(3.3)

and ϕ is related to g by (3.1b). We ﬁrst consider the collisionless case (ν = 0) and solve
(3.2) using Landau’s method [58], as follows. We take the Laplace transform

¯g(v, p) =

dt e−ptg(v, t),

(3.4)

(cid:90) ∞
(cid:2)˜ωn + ˜ωT

0

47

of (3.2) in time, and rearrange to ﬁnd the transformed distribution function

¯g(v, p) =

g0(v)
p + ikv

+

(cid:0)v2 − 1

(cid:1) + kv(cid:3) F0(v) ¯ϕ(p)

2

ip − kv

,

(3.5)

(cid:90) i∞+σ

−i∞+σ

ϕ(t) =

1
2πi

(cid:90) ∞

where g0(v) = g(v, t = 0) is the initial distribution. We have used the property of Laplace
transforms that ∂g/∂t = p¯g − g0. We then integrate (3.5) over all velocities and use the
quasineutrality condition (3.1b) to obtain a linear equation for ¯ϕ(p). We solve, and invert
the Laplace transform to give

dp ¯ϕ(p) ept,

¯ϕ(p) =

1

D(ip)

−∞

dv

g0(v)
p + ikv

,

(3.6)

where the p-integral is the Bromwich integral (the Laplace transform inverse) with Re(σ)
to the right of all poles in the integrand, and D(ω) is given by

(cid:18)(cid:16)ω

k

(cid:17)2 − 1

2

(cid:19)(cid:19)

(cid:21)

(cid:16) ω

(cid:17)

k

+

ω
k

Z

.

(3.7)

(cid:20)(cid:18) ωn
The plasma dispersion function Z(ζ) =(cid:82) ∞

D(ω) = 2 +

˜ωT
k

ω
k

+

+

k

˜ωT
k

−∞ dv F0(v)/(v − ζ) has its integration contour
along the real line for Im(ζ) > 0 and along the Landau contour for Im(ζ) ≤ 0. The Landau
contour is a deformation of the real line which passes below the complex pole at v = ζ, as
shown in Figure 3.1(a). Properties of the plasma dispersion function, such as asymptotic
expansions, are well-known [68, 69]. In the long-time limit, ϕ becomes proportional to
ep∗t where p∗ is the pole of the integrand with largest real part. For non-singular initial
conditions, this is given by p∗ = −iω, where ω is the solution of D(ω) = 0 with largest
imaginary part. Thus, in the long time limit, we have ϕ ∝ e−iωt (but, as we see shortly, not
necessarily g ∝ e−iωt).

Solving D(ω) = 0 with no driving or collisions, ˜ωn = ˜ωT = ν = 0, gives Landau
damping, the surprising result that the growth rate Im(ω) is negative, i.e. that the electro-
static potential decays despite the system being apparently time-reversible. With driving,
the growth rate plotted in green in Figure 3.1(b) exhibits growth and decay for different
wavenumbers, so provides a useful benchmark for studying numerical methods.

The distribution function g is also given by Landau’s method. Inverting (3.5), we obtain

(cid:2)˜ωn + ˜ωT

(cid:0)v2 − 1

(cid:1) + kv(cid:3) F0(v) ¯ϕ(p)

(cid:35)

2

ip − kv

ept.

(3.8)

(cid:34)

(cid:90) i∞+σ

−i∞+σ

g(v, t) =

1
2πi

dp

g0(v)
p + ikv

+

The ﬁrst term in the integrand integrates to g0(v)e−ikvt, which is purely oscillatory and
satisﬁes the particle streaming part of (3.2), ∂g/∂t + ikvg = 0. The second term is propor-
tional to ϕ. Leaving the p integral alone and instead integrating over v gives

(cid:90) ∞

−∞

dv g(v, t) =

1
2πi

(cid:90) i∞+σ

−i∞+σ

dp

(cid:20)(cid:90) ∞

−∞

(cid:21)

ept = ϕ(t),

(3.9)

g0(v)
p + ikv

dv − D(ip) ¯ϕ(p) + ¯ϕ(p)

48

(a)

(c)

(b)

(d)

Figure 3.1: (a) Integration contours of the plasma dispersion function Z(ζ) for Im(ω) ≶ 0.
(b) Growth rate plotted against parallel wavenumber for a discretization with N points on
a Gauss–Hermite grid. (c) The fastest growing eigenmode for different wavenumbers. A
Case–Van Kampen mode forms as the growth rate γ → 0+ as k → kcrit. (d) The slowest
decaying eigenmode corresponding to k = 4.1αi, calculated using the Kirkwood operator
(3.62). The distribution develops a boundary layer of width |γ| about the resonant velocity
v = ωR/k, and becomes more singular as ν → 0.

49

Im(ω)>0Im(ω)<0Im(ω)<01012345678parallelwavenumber,k/αi−0.2−0.10.00.10.20.3growthrate,γN=10N=100dispersionrelation−3−2−10123parallelvelocity,v−0.8−0.6−0.4−0.20.00.20.40.6distributionfunction,g(v)k/αi=2.753.253.75−1.75−1.00−0.25−0.6−0.20.2−3−2−10123parallelvelocity,v−0.8−0.6−0.4−0.20.00.20.40.6distributionfunction,g(v)=0.1=1=10−1.2−0.9−0.6−0.6−0.20.2where using ¯ϕ from (3.6), we see the contribution D(ip) ¯ϕ from the second term in the
integrand in (3.8) exactly cancels the ﬁrst, purely oscillatory term. Thus even though g
oscillates, its integral ϕ can decay without violating the quasineutrality condition. This
shows that the Landau-damped solution (3.8) for g is not an eigenmode of (3.2).

In contrast, for growing modes Im(ω) > 0, the ϕ behaviour dominates (3.8) in the long
time limit, so g ∝ ϕ and the solution is an eigenmode. It is therefore instructive to consider
the separable solutions

g(v, t) = ˆg(v) e−iωt,

ϕ(t) = ˆϕ e−iωt.

(3.10)

The long-time behaviour of the initial value problem will be determined by the fastest
growing or slowest decaying mode, for which Im(ω) is largest. With (3.10), equation (3.2)
becomes the linear eigenvalue problem

ωˆg = Lν[ˆg],

(3.11)

with the collisionless case being ωˆg = L0[ˆg] for ν = 0. The operator L0 is real, so its
eigenvalues occur in complex conjugate pairs. Therefore the dominant growth rate, the
largest imaginary part of any eigenvalue, is non-negative. The eigenfunctions ˆg and ˆϕ are
found by solving (3.11) for ˆgc, the analytic continuation of ˆg into the complex plane such
that ˆgc(v) = ˆg(v) for real v,

(cid:2)˜ωn + ˜ωT

(cid:0)v2 − 1

(cid:1) + kv(cid:3) ϕF0

+ Aϕδ(ω − kv).

2

ˆgc(v) =

ω − kv

(3.12)
The delta function term arises from dividing (3.11) by (ω − kv) because A(ω − kv)δ(ω −
kv) ≡ 0, with A an arbitrary constant. The solution is singular at the point v = ω(k)/k
whose location varies with k. Putting (3.12) into the quasineutrality condition (3.1b) yields
the consistency condition

(cid:90) ∞

dv

−∞

(cid:2)ωn + ˜ωT

(cid:1) + kv(cid:3) F0

(cid:0)v2 − 1

2

ω − kv

(cid:90) ∞

−∞

+ A

dv δ(ω − kv) = 1,

(3.13)

where the integration contour is the real line in the complex v plane. When ω is not real,
the second integral vanishes and (3.13) becomes an integral equation to determine ω(k) =
ωR + iγ. When γ > 0, equation (3.13) is D(ω) = 0 and the method agrees with the Landau
approach. However, there are no solutions such that γ < 0, which we argue as follows.
The ﬁrst integral in (3.13) is a function of ω that is symmetric in the real axis, so for γ < 0
equation (3.13) reduces to D(ωR − iγ) = 0. Thus every decaying solution corresponds to
a solution growing with rate −γ, and there are no wavenumbers where the dominant mode
has a negative growth rate.

50

When ω is real (γ = 0), the second integral remains in (3.13) and the ﬁrst term is taken
as a principal value integral. There are modes for all real ωR, with (3.13) serving to deter-
mine A. This results in a continuous spectrum of singular eigenmodes ˆgc (3.12) with real
eigenvalues ωR, the Case–Van Kampen modes [59, 60]. Thus the dispersion relation found
with eigenmodes agrees with the Landau dispersion relation for growing modes, but gives
a zero growth rate for non-growing mode while the Landau growth rate is strictly negative.
This reﬂects the fact that the Landau-damped solutions are not eigenmodes, so we will
not ﬁnd decay by studying single eigenmodes of the collisionless system. The eigenmode
approach does not contradict Landau’s method however; CASE [60] showed that the Case–
Van Kampen modes are complete, and the distribution for a Landau-damped solution is an
inﬁnite superposition of Case–Van Kampen modes. Its integral ϕ decays through phase
mixing, the interaction of an inﬁnite number of oscillating modes with different frequen-
cies.

The picture changes when ν > 0, as any nonzero degree of collisionality counteracts
phase mixing. Plasma collisions are dominated by glancing encounters due to the long-
range Coulomb interactions between charged particles, which are modelled by Fokker–
Planck-type operators with ﬁrst and second order velocity space derivatives (see §3.2.1
onwards). Equation (3.11) becomes a second-order differential equation for ˆg, and the na-
ture of the eigenvalue problem changes. Collisions balance particle streaming, regularizing
the problem and preventing the formation of structure at inﬁnitesimal scales. LENARD &
BERNSTEIN [70] solved the undriven system with a simple Fokker–Planck operator, ﬁnd-
ing a damped eigenmode solution with a decay rate that tends to the Landau rate in the
limit of vanishing collisions. NG ET AL. [71, 72] showed that this system has a discrete
spectrum and a complete set of smooth and square integrable eigenmodes, instead of the
continuous spectrum of singular eigenmodes in the collisionless system. A subset of the
collisional eigenmodes have eigenvalues that tend to solutions of the Landau dispersion
relation D(ω) = 0 in the limit of vanishing collision frequency [73]. As collisionality is
reduced, the eigenmodes develop boundary layers of width |γ| and become more singular
with oscillations of width ν−1/4 [73]. Therefore, while Landau’s solution is for an ini-
tial value problem, we may obtain the Landau growth rate from a collisional eigenvalue
problem, and so we consider eigenvalue problems for computation convenience.

Many problems, such as nonlinear problems or those in complicated geometry, must
be solved numerically, so we discuss the system with discrete velocity space. In the con-
tinuous case, the collisionless limit (ν → 0) is singular and corresponds to the formation
of inﬁnitesimally ﬁne scales in velocity space. The solution changes from smooth colli-
sional behaviour for ν > 0 to singular collisionless behaviour at ν = 0. Once discretized,

51

there are no arbitrarily small velocity scales, and the solution must vary continuously with
ν (because the problem becomes a ﬁnite matrix eigenvalue problem). Now we expect be-
haviour to change at a ﬁnite νcrit which depends on the resolution of velocity space. When
ν < νcrit, the velocity space structure is too ﬁne to be resolved and the behaviour is Case–
Van Kampen-like, while when ν > νcrit the solution is smooth and collisional.

3.0.2 Landau damping in a discrete system

We discretize (3.11) and solve the matrix eigenvalue problem

ωˆgj = Mjlˆgl,

(3.14)

where the matrix M is the discretization of Lν, and ˆgj is the vector of values of ˆg(vj) on
the discretization grid {v0, . . . , vN}. There is an implied sum over the repeated index l.
Without collisions, M is real so its eigenvalues occur in complex-conjugate pairs, and the
discretization cannot capture Landau damping. Figures 3.1(b) and (c) show typical be-
haviour for a discretized collisionless system. In Figure 3.1(b) we plot the growth rate
calculated from (3.14) where we discretized ˆg on the grid of N Gauss–Hermite points
described in §3.1.3 for N = 10 and N = 100. The numerical growth rate is plotted
in blue and red against the exact dispersion relation in dashed green. The calculation is
qualitatively correct for positive growth rates, but requires O(100) grid points for quantita-
tive agreement. Regardless of the resolution, the method fails to produce negative growth
rates. Figure 3.1(c) shows the fastest growing mode for three wavenumbers near the critical
wavenumber where the growth rate crosses zero to become negative. As the wavenumber
increases, the growth rate tends to zero and the structure in the eigenmodes becomes ﬁner
until the grid is unable to resolve them. (The eigenmode shown is calculated on a higher
resolution uniform grid.) This corresponds to the formation of a Case–Van Kampen mode
as the growth rate decreases to zero. For zero growth rates, the eigenvectors are discretiza-
tions of Case–Van Kampen modes: numerical approximations to delta functions located at
the discretization grid points. The eigenvalue spectrum thus becomes dense along the real
line in the limit of increasing resolution.

By including a collision term in M in (3.14), we can ﬁnd decaying eigenmodes for the
driven system which approach the correct Landau decay rate, analogous to the eigenmodes
for the undriven system found by LENARD & BERNSTEIN (see §3.2.4). These eigenmodes
become more singular as collisionality is reduced. Figure 3.1(d) shows the slowest decay-
ing eigenmode for k = 4.1αi calculated on a Hermite grid using the Kirkwood collision op-
erator introduced in §3.2.2 with different collision frequencies ν. Unlike in the continuous

52

system, where any ﬁnite collisionality regularizes the problem, some minimum collisional-
ity is required in the discrete case. This minimum is related to resolution, and we show in
§3.3.2 that discrete approximations to Lν based on Hermite polynomials correctly capture
decaying modes provided that the number of modes N exceeds some Ncrit(ν), a critical
number needed to capture the roll-over of the Hermite spectrum of the eigenfunction at
the point where collisions become dominant. Crucially Ncrit → ∞ as ν → 0. Natural
discretizations of L0 lose Landau damping as ﬁrst N is ﬁxed, then ν → 0 is taken. To
correctly capture Landau damping, one must set ν > 0 so that Lν has a discrete spectrum
of square-integrable eigenfunctions, and then choose N to satisfy N > Ncrit(ν).

The above criterion N ≥ Ncrit(ν) implies that N must be too large for efﬁcient com-
putation when ν is sufﬁciently small to represent realistic fusion plasmas. In this Chapter
we investigate the effectiveness of a hypercollisional operator in capturing weakly colli-
sional plasmas, and ﬁnd that accurate calculations are possible with a few tens of degrees
of freedom in velocity space. An efﬁcient formalism for velocity space in (3.1) uses the
Hermite spectral representation. Hermite polynomials have been commonly used in ki-
netic theory of neutral particles and of plasmas as they are orthogonal with respect to a
Maxwellian weight, and are the eigenfunctions of the linearized Boltzmann collision op-
erator for Maxwell molecules (a convenient model of particles with an inverse 5th power
repulsion [74]). Hermite polynomials are also the eigenfunctions of the Lenard–Bernstein
and Kirkwood collision operators, two Fokker–Planck-type collision operators that are suit-
able for representing weakly collisional plasmas. We introduce a higher-order hypercolli-
sional operator by iterating the Kirkwood operator. This gives numerically accurate results
for very low computational cost, (i.e. it has a low value of Ncrit) and so allows a coarse
resolution to be used. We also study the Hermite spectrum of the eigenmodes, and investi-
gate the effect of hypercollisions in the initial value problem. The operator is formulated in
Hermite space and so is simplest to apply on a Gauss–Hermite velocity grid (see §3.1.2).
However, we demonstrate later that the hypercollisional operator may be used with any
velocity space discretization.

3.1 Hermite representation

The use of spectral expansions of the distribution function has a long history in kinetic
theory. It is natural to consider functions of velocity that are orthogonal with respect to
the Gaussian weight function that arises from the Maxwell–Boltzmann equilibrium distri-
bution. BURNETT [33, 34] used a combined expansion in spherical harmonics and So-
nine polynomials to greatly simplify the computation of the collision integrals that arise in

53

the calculation of the viscosity and thermal conductivity in the Chapman–Enskog expan-
sion. The standard Hermite polynomials are orthogonal with respect to a Gaussian weight
function in one dimension [75] so GRAD [76, 77, 78] introduced sets of tensor Hermite
polynomials as a Cartesian alternative to Burnett’s expansion. Both expansions convert an
integro-differential kinetic equation into an inﬁnite hierarchy of partial differential equa-
tions in x and t for the expansion coefﬁcients.

The same expansion in Hermite polynomials for velocity space, and in Fourier modes
for physical space, was used in early simulations of the 1+1D Vlasov–Poisson system, such
as by ARMSTRONG [79], GRANT & FEIX [80] and JOYCE ET AL. [81], albeit with different
forms of dissipation and, inevitably, much lower resolution than is currently feasible.

However, through disappointment with the available velocity-space resolution [82], and
with higher dimensional models becoming computationally feasible, interest turned instead
to particle-in-cell (PIC) methods. These represent the distribution function using a set of
macro-particles located at discrete points (xi, vi) in phase space, each of which represents
many physical ions or electrons [83–85]. The method exploits the structure of the left-hand
side of the kinetic equation (2.1) as a derivative along a characteristic in phase space. A
PIC method evolves the solution by propagating macro-particles along their characteris-
tics, analogous to the Lagrangian formulation of ﬂuid dynamics. The representation of the

continuous distribution function (cid:101)F (x, v, t) by a discrete set of n macro-particles creates
ties in the tail of the distribution where (cid:101)F is much smaller than its maximum value. An

√
an O(1/

n) sampling error, sometimes called “shot noise”, that creates particular difﬁcul-

information preservation approach has been developed to alleviate this problem in particle
simulations of neutral gases [86] but it has not yet been employed for plasmas.

Instead, more recent multi-dimensional gyrokinetics codes have returned to Eulerian
representations of velocity space, using ﬁxed grids either for velocities [25, 87] or for
energy and pitch angles [57, 88]. However Hermite polynomials have been used to de-
velop reduced kinetic [89] and gyroﬂuid models [90, 91], as well as the Hermite expansion
coefﬁcients being used to characterize velocity space behaviour [92–94] in analogy with
KOLMOGOROV’s 1941 theory of hydrodynamic turbulence [95] expressed using the en-
ergy spectrum in Fourier space. This has reignited interest in using Hermite polynomials
for computation in new reduced-dimension [96, 97] gyrokinetics codes, and our fully ﬁve-
dimensional SPECTROGK described in Chapter 5. A recent comparison between a PIC
code and a Fourier–Hermite code shows that the latter is much more computationally efﬁ-
cient for the 1+1D Vlasov–Poisson system when high accuracy is desired [98].

54

3.1.1 Hermite functions

We introduce the standard Hermite polynomials Hm(v), and the re-normalized Hermite
functions φm(v), deﬁned by

Hm(v) = (−1)mev2 dm
dvm

(3.15)
√
for m = 0, 1, 2, . . .. The φm are orthonormal with respect to the weight function e−v2/
π,
equal to our dimensionless Maxwell–Boltzmann distribution. Introducing the dual Hermite
√
functions φm(v) = e−v2φm(v)/
π thus establishes the bi-orthonormality conditions

φm(v) =

√
Hm(v)
2mm!

,

,

(cid:16)

e−v2(cid:17)

dv φn(v)φm(v) = δnm for m, n ≥ 0.

(3.16)

Each φm satisﬁes the velocity space boundary conditions φm(v) → 0 as v → ±∞. They
form a complete set for functions g(v) that are analytic in a strip centred on the real axis
and satisfy the decay condition |g(v)| < c1 exp (−c2v2/2) for some constants c1 > 0 and
c2 > 1 [99, 100] so we may expand the perturbed distribution function as

g(v) =

gmφm(v),

with

gm =

dv g(v)φm(v).

(3.17)

(cid:90) ∞

−∞

(cid:90) ∞

−∞

∞(cid:88)

m=0

(cid:90) ∞
(cid:90) ∞
(cid:90) ∞

−∞

−∞

−∞

g0 =

g1 =

g2 =

This is an asymmetrically weighted Hermite expansion, in the terminology of HOLLOWAY
[99]. The symmetric expansion uses the orthogonal functions ψm(v) = e−v2/2φm(v)π−1/4.
In kinetic theory problems one may choose the width of the Gaussian weight function in
the Hermite orthogonality condition to differ from the width of the Maxwell–Boltzmann
distribution [101, 102], but LE BOURDIEC ET AL. [103] found that taking the two Gaus-
sians to have the same width gives optimal accuracy. The expansion (3.17) then coincides
with the expansion originally introduced by GRAD [76, 77, 78].

The ﬁrst few expansion coefﬁcients in (3.17) have physical interpretations,

dv g(v) = ni,

√

√

2

(cid:18)

dv

dv

√

(cid:19)

2vg(v) =

2niui,

√

2(2Ei − niTi),

g(v) =

v2 − 1
2

(3.18)

where ni, ui, and Ei are the perturbations due to g in the ion ﬂuid density, ﬂuid velocity,
and energy density respectively, and Ti = 1/2 is the background equilibrium temperature
in our dimensionless variables. These expressions are of particular importance for efﬁcient

55

computation, since integrals required to ﬁnd the current and charge densities in Maxwell’s
equations (2.106) are now single Hermite coefﬁcients, rather than integrals approximated
as sums over velocity space grids.

In contrast to low m moments, coefﬁcients for higher m are associated with ﬁne scales
and kinetic, not ﬂuid, moments: the asymptotic behaviour of the symmetrically weighted
Hermite functions for large m is [75, 104],

ψm(v) ∼ Am cos(v

√
2m − mπ/2),

with

Am =

21−m/2Γ(m)1/2
π1/4m1/2Γ(m/2)

.

(3.19)

Hermite functions with larger m thus represent progressively ﬁner scale structures in v.

Hermite functions with adjacent m values satisfy the recurrence relation

(cid:114) m + 1

2

(cid:114) m

2

vφm(v) =

φm+1(v) +

φm−1(v).

(3.20)

This may be written as a matrix equation using the Jacobi matrix J,

vφm(v) =

Jmnφn(v),

(3.21)

(cid:112)m/2 [105]. Derivatives of Hermite functions may be expressed as

where J is inﬁnite, symmetric, and tridiagonal with nonzero entries Jm,m−1 = Jm−1,m =

= −(cid:112)2(m + 1)φm+1,

dφm
dv

and

√

2mφm−1.

dφm
dv

=

(3.22)

The relations (3.20) and (3.22) allow us to develop a pure spectral discretisation in velocity
space. Once initial conditions have been expressed as coefﬁcients in a Hermite expansion,
we do not need a collocation grid in v analogous to that required to compute the nonlinear
terms in x space (see §5.1.1.1). We later use initial conditions that have simple expressions
as truncated Hermite expansions, such as the Maxwellian in Chapter 6, but generically one
must evaluate the Hermite transform of the initial conditions.

Finally, we shall ﬁnd the Hermite expansions of delta functions useful. Combining the

two expressions in (3.17) gives

∞(cid:88)

m=0

(cid:90) ∞

dV

−∞

(cid:32) ∞(cid:88)

m=0

(cid:33)

g(v) =

gmφm(v) =

φm(V )φm(v)

g(V ),

(3.23)

from which we deduce the resolution of the identity formula

δ(v − V ) =

φm(V )φm(v).

(3.24)

∞(cid:88)

n=0

∞(cid:88)

m=0

56

(a)

(b)

Figure 3.2: (a) Hermite spectra of δ(v − V ). Black lines show m−1/2 decay, and crosses
give a lower bound for the position of the maxima m = V 2/2 − 1. (b) Three examples of
16th order Hermite cardinal functions, with markers located at Hermite grid points. Each
function is zero at all grid points but one, and one at the other.

Therefore the expansion coefﬁcients for the delta function δ(v − V ) are gm = φm(V ). The
spectrum |gm|2/2, plotted in Figure 3.2(a), increases super-exponentially until a maximum
is reached, and then decays like m−1/2, which follows from (3.19) and Stirling’s formula
[75]

log Γ(m + 1) = log m! = m log m − m +

log(2πm) + O(m−1).

(3.25)

1
2

If the maximum is at m∗, then

(cid:12)(cid:12)φm∗(V )(cid:12)(cid:12) >(cid:12)(cid:12)φm∗+1(V )(cid:12)(cid:12) >
|V | −(cid:113)

(cid:18)(cid:113)

2
m∗

m∗+1

m∗

m∗

(cid:12)(cid:12)(cid:12) −

(cid:12)(cid:12)(cid:12)(cid:12)(cid:113)

m∗+1V φm∗(V )

m∗+1φm∗−1(V )

(cid:12)(cid:12)(cid:12)(cid:12) ,
(cid:12)(cid:12)(cid:12)(cid:113) 2
(cid:19)(cid:12)(cid:12)φm∗(V )(cid:12)(cid:12) <(cid:12)(cid:12)φm∗−1(V )(cid:12)(cid:12) <(cid:12)(cid:12)φm∗(V )(cid:12)(cid:12) ,

where the ﬁrst inequality is by deﬁnition of a maximum, and the second is due to the
recurrence relation (3.20) and the triangle inequality. Rearranging (3.26) gives

(3.26)

(3.27)

which yields the bound m∗ > V 2/2 − 1. This is also plotted in Figure 3.2(a).

3.1.2 Truncated Hermite series

We approximate the distribution function perturbation (3.17) by the truncated Hermite se-
ries

g(v, t) =

gm(t)φm(v),

(3.28)

N(cid:88)

m=0

57

100101102103Hermitemode,m+110−710−310110510910131017102110251029103310371041|gm|2/2=φm(V)2/2V=1V=5V=8V=10∝m−1/2−4−2024parallelvelocity,v−10−50510Hermitecardinalfunctions,C16j(v)j=4j=8j=14which is a polynomial of degree N multiplied by F0. We expect g to decay as e−v2, so
this expansion provides a spectrally accurate approximation to (3.17) using a convenient
bi-orthonormal basis.

We calculate moments via the Gauss–Hermite quadrature formula [106]

(cid:90) ∞

−∞

N(cid:88)

j=0

j =(cid:2)N φN (vj)2(cid:3)−1

p(v)F0(v)dv =

wN

j p(vj), wN

,

(3.29)

where the quadrature points vj are the N + 1 roots of the Hermite polynomial HN +1(v).
Equation (3.29) holds exactly for all polynomials p(v) with degree 2N + 1 or less. Set-
ting p(v) = φm(v)φn(v) and using the bi-orthogonality condition (3.16) establishes that
Hermite polynomials of degree at most N form a ﬁnite orthogonal set:

wN

j φm(vj)φn(vj) = δnm,

for

n, m ∈ {0, 1, . . . , N}.

(3.30)

Dual to this is the discrete resolution of the identity formula, obtained by multiplying (3.30)
by φm(vl) and summing over m,

wN

j φm(vj)φm(vl) = δjl,

for

j, l ∈ {0, 1, . . . , N}.

(3.31)

These formulae motivate the introduction of the Hermite cardinal polynomials

N(cid:88)

j=0

N(cid:88)

m=0

N(cid:88)

˜CN
j (v) =

wN

j φm(vj)φm(v),

(3.32)

m=0

polynomials of degree N that are analogous to Whittaker’s sine cardinal function for
Fourier series [107–109] in that ˜CN
j (vl) = δjl. Hermite cardinal polynomials lie in the span
of Hermite polynomials up to degree N, being the Lagrange interpolation polynomials for
the Gauss–Hermite quadrature points. We also deﬁne the Hermite cardinal functions

CN
j (v) =

F0(v)
F0(vj)

˜CN
j (v).

(3.33)

These also satisfy CN
Three examples of C16
(3.28) becomes

j (vl) = δjl for Hermite roots, but decay like a Maxwellian as v → ±∞.
j (v) are plotted in Figure 3.2(b). With these, our truncated expansion

g(v, t) =

N(cid:88)

j=0

N(cid:88)

m=0

gm(t)φm(v) =

58

g(vj, t)CN

j (v),

(3.34)

and we may express our truncated approximation of g either in terms of the coefﬁcients
gm(t) or the function values g(vj, t). As (3.34) shows, this truncation is equivalent to a dis-
cretization of g on the grid of N + 1 Gauss–Hermite quadrature points vj with coefﬁcients
gm related to the function values g(vj) through an invertible linear transformation.

The optimal method for calculating the Hermite roots vj uses a truncation of the Jacobi
matrix from (3.21). The leading N + 1 × N + 1 submatrix JN of J has the property that
its characteristic polynomial is proportional to the Hermite function φN +1(v) [110, 111].
Therefore the roots of the Hermite polynomial φN +1(v) may be readily computed as the
eigenvalues of the symmetric tridiagonal matrix JN using the QR algorithm [112].

3.1.3 Hermite system

Substituting the truncated expansion (3.28) into (3.2) and projecting onto each of the φm in
turn gives the system

(cid:18)

(cid:19)

∂gm
∂t

+

i
k

˜ωnδm0 +

δm2

g0 +

˜ωT√
2

i√

2

δm1 g0 + i

gm+1 +

2

(cid:32)(cid:114) m + 1

(cid:114) m

(cid:33)

2

gm−1

= 0,

(3.35)

where we have neglected collisions and eliminated ϕ = g0 using the quasineutrality condi-
tion. We have also rescaled time by t (cid:55)→ kt to simplify the algebra in subsequent sections.
The recurrence relation (3.20) allows the streaming term vg in (3.3) to be expressed as a
coupling between mode m and modes m ± 1. The electrostatic response and the driving
from background gradients appear only in the ﬁrst few equations for m ∈ {0, 1, 2}. Equa-
tion (3.35) is the problem treated by NG ET AL. [71] in their analytic work, but generalized
to include density and temperature gradients.

Equation (3.35) may be rewritten as the matrix equation

∂gm
∂t

= −iMmngn,

(3.36)

59

for the matrix



M =

1√
2
0

1

0

0

0

0

0

0

0

0
1

(cid:113) 3

0

2

0

0

0

0

0

0

0
0

(cid:113) 3

2

0
...

0

0
0

0

0

0
0

0
0

0
...

(cid:113) N

0

2

0
0

0

0

0

(cid:113) N

0

2

0

0
0

0

0

0




.

(3.37)

1√
2

˜ωn
k
+ 1√
√
˜ωT
k
2

2

0

0

0



˜ωn
k
1√
2
√
˜ωT
k
2

0

0

0

= JN +

This is the N + 1th order leading submatrix of the Jacobi matrix for Hermite polynomials
J in (3.21), with three additional non-zero elements in the ﬁrst column due to the driving
and the electrostatic response. Thus M is a rank-one update to JN, that is M = JN + xyT
√
for vectors x = (˜ωn/k, 1/
2, ˜ωT /k, 0, . . . , 0)T and yT = (1, 0, . . . , 0). Theory exists for
inverting matrices of this form [113] and for ﬁnding eigenvalues in special cases such as
when M is symmetric (x = y) [114] or when x or y are eigenvectors of JN [115], but it does
not seem possible to exploit this structure for the asymmetric eigenvalue problem with a
general rank-one update.

The growth rates shown in Figure 3.1(b) are calculated by ﬁnding the eigenvalues of
the truncated matrix M. As explained above, this is equivalent to discretizing g(v) on a
Gauss–Hermite grid in velocity space. However we may now explain these results in terms
of the truncated representation of g (3.28). Putting m = N in (3.36) gives

(cid:114)

(cid:114)

N + 1

2

gN +1 +

N
2

gN−1 = ωgN ,

(3.38)

but a simple truncation sets gN +1 = 0 and is only valid when gN +1 is negligibly small.1 To
see if this is so we plot the Hermite spectrum for N = 100 and two wavenumbers k/αi = 2
and k/αi = 6 in Figure 3.3. The spectrum for k/αi = 2 decays from gm ∼ 1 at small m to
1More generally, the coefﬁcient gN +1 in (3.38) may be approximated by a linear combination of the
coefﬁcients g0, g1, . . . , gN . This assumes that the smallest scale structure may be extrapolated from larger
scales, an approach studied by Smith [116].

60

(a)

(b)

Figure 3.3: Hermite spectra for two values of the parallel wavenumber, (a) k/αi = 2 and
(b) k/αi = 6, calculated using the truncation (3.28) with N = 100. Spectra are plotted
against m + 1 to not omit the zeroth mode on the logarithmic scale.

gm ∼ 10−3 at m = 100, so the last few terms retained are roughly a thousand times smaller
than the ﬁrst few terms. The spectrum for k/αi = 6 does not decay. The gm are initially
negligible, but grow rapidly for 12 (cid:46) m (cid:46) 40 and then saturate for m (cid:38) 40. The spectrum
is similar to the growing part of the spectra of delta functions shown in Figure 3.2(a). We
may expect this as k = 6αi exceeds kcrit, the critical wavenumber at which the Case–Van
Kampen mode forms (see Figure 3.1(c)). Therefore the truncation is valid for growing
modes, but not for decaying modes.

3.1.4 Hermite representation of a Case–Van Kampen mode

The behaviour of the Hermite spectrum for k/αi = 6 may be understood by considering
the free streaming equation

∂g
∂t

+ ikvg = 0,

(3.39)

the kinetic equation in (3.1a) with no driving from background gradients, collisions, or
electrostatic response. Seeking time periodic solutions proportional to e−iωt and rescaling
time as in §3.1.3 gives

(v − ω)ˆg = 0.

(3.40)
This equation admits the generalized eigenfunctions ˆg = δ(v − ω), which are equivalent to
the Case–Van Kampen modes in the original system. Indeed the collisionless and undriven
form of (3.1) may be reduced to (3.39) using a different integral transform in place of the
Fourier transform [117].

61

100101102Hermitemode,m+110−710−610−510−410−310−210−1100freeenergy,|gm|2/2k/αi=2,γ>0100101102Hermitemode,m+110−3310−3010−2710−2410−2110−1810−1510−1210−910−610−3freeenergy,|gm|2/2k/αi=6,γ=0(cid:114) m + 1

(cid:114) m

2

The calculations in §3.1.3 hold for equation (3.39) if we omit the electrostatic response
term and set ˜ωn = ˜ωT = 0. Now M = JN and the truncated matrix eigenvalue problem
becomes,

2

gm+1 +

gm−1 = ω gm,

(3.41)
for m = 0, . . . , N − 1. The last row is modiﬁed because gN +1 ≡ 0 due to the truncation.
The matrix JN is the N + 1th order leading submatrix of the Jacobi matrix for Hermite
polynomials J in (3.21). The characteristic polynomial of JN is proportional to φN +1(v),
so the eigenvalues of JN are the roots of φN +1(v). This may also be seen by noting that the
relation (3.41) coincides with the recurrence relation (3.20) for m = 0, . . . , N−1, so φm(v)
is a candidate eigenvector with components (φ0(v), . . . , φN (v)) and eigenvalue v = ω. To
satisfy the last row of the matrix equation we need φN +1(v) = 0, which determines the
eigenvalues as the N + 1 Gauss–Hermite quadrature points vj that satisfy φN +1(vj) = 0.
The distribution functions corresponding to the eigenvectors are

N(cid:88)

gj(v) =

φm(vj)φm(v),

(3.42)

m=0

which are approximations of the delta functions δ(v− vj) such that in the limit N → ∞ we
recover the Hermite representation of a delta function (3.24). Moreover the Gauss–Hermite
quadrature points expand to ﬁll the real line because they spread outwards proportional to
√
√
N as N → ∞, and their spacing decreases as 1/
N [118]. Thus the spectra of the ma-
trices JN approach a continuous spectrum as N → ∞, and the corresponding eigenvectors
approach the Case–Van Kampen modes.

3.2 Collisions
As we have seen in §3.1.3, discrete representations of collisionless dynamics require regu-
larization to prevent inﬁnitesimally ﬁne scales forming in velocity space. It is natural to do
this with physical collision operators, i.e. to study weakly collisional plasmas. The relevant
collision operator is the Landau operator [119] which contains the long-range Coulomb
potential rather than the Maxwell molecule inverse 5th power potentials [74] used in the
kinetic theory of uncharged particles. The Landau operator is not amenable to simple com-
putation, so in §3.2.2 we consider model collision operators which share the properties of
the Landau operator discussed in §3.2.1. With the Coulomb potential, collisions are pre-
dominantly glancing, so velocity changes are small. This allows a Taylor expansion of
the distribution function which leads to ﬁrst and second-order velocity space derivatives

62

in the Landau operator. Thus the operator produces diffusion in velocity space, which is
effective at removing ﬁne scales in the distribution.2 In Hermite space this corresponds
to damping higher modes which represent smaller scales, and provides a mechanism for
gN +1 and higher to be made negligible. However this requires that we resolve collisional
scales, which we show in §3.2.2 to be prohibitively expensive. To circumvent this we use
the separation of scales of the Hermite system (3.35): driving and the Boltzmann response
are represented by low moments, and only particle streaming appears in the high moments.
Free energy cascades from low moments to high moments via particle streaming, similar
to the turbulent cascade through wavenumbers in hydrodynamic theory. Here however,
the cascade is linear and reversible. Still, we ﬁnd for our system that changes to the col-
lision model do not affect the low moments, nor properties determined by these, such as
the growth rate. Therefore in §3.2.4 we introduce a hypercollisional operator with high
order derivatives in velocity space to artiﬁcially increase the scales on which collisions act
and to make damping severe over a narrow range of high modes. This leaves low modes
unaffected, so the correct growth rate is found with fewer terms in the Hermite expansion.
This approach is similar to the hyperviscosity used in spectral methods for physical
space in hydrodynamic turbulence [e.g. 122, 123] and plasma simulations [e.g. 66]. A
higher order term, typically −(−∇2)n for some integer n, operating on the velocity or
vorticity conﬁnes dissipation to a small range of high wavenumbers. The approach of
damping velocity space with a hypercollisional operator has also been considered before
[e.g. 81, 124, 125]. These works use hypercollisions to prevent recurrence, the spurious
reappearance of free energy in low moments after ﬁnite time, rather than as a means to
reduce the necessary resolution in velocity space.

3.2.1 The Landau collision operator and its properties

Particles interacting via the long-range Coulomb potential experience many small deﬂec-
tions due to glancing collisions. Expanding the distribution function in the Boltzmann
binary collision operator in a Taylor expansion for small velocity changes, and cutting off
the divergent contributions at small and large scales gives the Landau operator

(cid:90)

(cid:18)

(cid:19)

C[F ] =

·

∂
∂v

K(v − v(cid:48)) ·

F (v(cid:48))

∂
∂v

F (v) − F (v)

∂

∂v(cid:48) F (v(cid:48))

dv(cid:48).

(3.43)

Here K(v−v(cid:48)) = (I−ˆ¯vˆ¯v)/|¯v|, where ¯v = v−v(cid:48) is the closing velocity, and ˆ¯v a unit vector
th) where log Λ is the
in that direction. The collision frequency is ν = 2πniq4
2It is also possible to remove ﬁne scales using a velocity-dependent collision frequency [e.g. 120, 121],

i log Λ/(m2

i v3

but we do not discuss this.

63

(cid:18)

(cid:19)

Coulomb logarithm that absorbs the effects of the cutoffs, and ni, qi, mi and vthi are the
ion number density, charge, mass and thermal velocity (the characteristic velocity scale).
Equation (3.43) is for ion–ion collisions, the relevant term in equation (3.1). Collisions
between the adiabatic electrons and the ion perturbation are neglected, being smaller by a

factor of the square root of the mass ratio(cid:112)me/mi ≈ 1/40 [126]. The Landau collision

operator (3.43) may be rewritten in the Fokker–Planck form

F − F [F ]F

,

(3.44)

·

C[F ] =

D[F ] · ∂
∂v
using the diffusion tensor D and friction vector F,
K(v − v(cid:48))F (v(cid:48)) dv(cid:48), F [F ] =

D[F ] =

∂
∂v

(cid:90)

(cid:90)

K(v − v(cid:48)) · ∂F (v(cid:48))

∂v(cid:48) dv(cid:48).

(3.45)
The F dependence of D and F makes them inconvenient expressions to work with. In-
serting approximations for D and F into the Fokker–Planck form (3.44) leads to useful
model collision operators. The properties of the Landau operator that model operators
should share are often given [e.g. 127, 128] as the model operator (i) representing the ef-
fect of small-angle collisions, (ii) vanishing when applied to any Maxwellian distribution,
(iii) conserving mass, momentum and energy, and (iv) driving the distribution function to
a Maxwellian as t → ∞.

The ﬁrst property holds for Fokker–Planck operators due to the presence of velocity
derivatives in (3.44). We only use the global Maxwellian F0, so the second property is
C[F0] = 0. Conservation of mass, momentum and energy correspond respectively to the
zeroth, ﬁrst and second velocity moments of the collision operator vanishing,

C[F ] dv =

vC[F ] dv =

v2C[F ] dv = 0.

(3.46)

The ﬁnal property imposes a bound on the behaviour of F at long times. We express

this using a convenient measure of entropy relative to the Maxwellian F0,

R[F|F0] ≡

F log

− F + F0 dv.

(3.47)

This relative entropy was introduced for studying the Boltzmann equation [e.g. 129, 130],
in particular for establishing rigorous hydrodynamic limits [130–132]. It is also used to es-
tablish the existence and long-time attracting properties of steady solutions of the Vlasov–
Poisson system [133, 134] and in other plasma applications [89, 135, 136]. Expanding for
small perturbations g = F − F0 (cid:28) F0,
R[F|F0] =

+ O(g3),

(cid:90) ∞

(3.48)

dv

g2
F0

1
2

−∞

64

(cid:90) ∞

−∞

(cid:90) ∞

−∞

(cid:90) ∞

−∞

(cid:90) ∞

−∞

(cid:18) F

(cid:19)

F0

so R is positive deﬁnite and quadratic in small perturbations. The leading order term de-
ﬁnes the free energy of the perturbed distribution for linearized theory, which may also be
expressed in terms of the Hermite expansion coefﬁcients (3.17) as

(cid:90) ∞

−∞

(cid:90) ∞

∞(cid:88)

−∞

n,m=0

Wf ≡ 1
2

g2
F0

dv =

1
2

gngmφnφm dv =

1
2

|gm|2.

(3.49)

∞(cid:88)

m=0

This is also a statement of Parseval’s theorem for expansions in Hermite functions. The
total free energy for the system (3.1) is W = Wf + Wϕ, where Wϕ = |ϕ|2/2 = |g0|2/2
is the free energy of the electric ﬁeld. The free energy W is conserved in the collisionless
system with no temperature gradient (ν = ˜ωT = 0), as shown in §3.4.3. The Hermite
spectrum Em ≡ |gm|2/2 (previously plotted in Figures 3.2 and 3.3) is thus the contribution
to Wf from each Hermite mode.

Relative entropy R differs from the Boltzmann entropy,

H[F ] ≡

F log F dv,

(3.50)

(cid:90) ∞

−∞

(cid:90) ∞

−∞

only by terms which are linear in number density and energy density. Using the Maxwellian
F0 = (n0/(2πT0)−1/2) exp(−v2/2T0),

R[F|F0] =

F log F − F log F0 − F + F0 dv

= H[F ] +

E
T0

+ n0 − ni log

(cid:18) en0

(2πT0)1/2

(cid:19)

,

(3.51)

where ni and E are the number density and energy density associated with the total distri-
bution F . Thus T0R is analogous to the Gibbs free energy density at a point in space with
temperature T0 and pressure n0T0, plus a chemical potential term to account for the possi-
bility of local changes in particle number. Relative entropy R is also the plasma part of the
general grand canonical ensemble density [136]. When the collision operator conserves ni
and E, the behaviour of R and H under collisions is the same, i.e. dH/dt = dR/dt, and
we may recast statements about the entropy in terms of the relative entropy. In particular,
the plasma is driven to equilibrium by collisions if and only if

dR
dt

=

C[F ] log

dv ≤ 0.

F
F0

(3.52)

(cid:90) ∞

−∞

3.2.2 The Lenard–Bernstein and Kirkwood collision operators
We study two Fokker–Planck type model collision operators where D and F are approx-
imated. LENARD & BERNSTEIN [70] proposed D = 1/2 (the equilibrium temperature in

65

our dimensionless variables) and F = −v, which in one dimension gives

(cid:18)
(cid:90) ∞

(cid:19)
(cid:18)

(cid:12)(cid:12)(cid:12)(cid:12) ∂

∂v

(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)2

C [F ] =

∂
∂v

vF +

1
2

∂F
∂v

.

(3.53)

(cid:90) ∞

−∞

The Boltzmann entropy decreases under Lenard–Bernstein collisions [137],

dH
dt

=

C[F ] log

F
F0

dv = −1
2

F

−∞

log

F
F0

dv ≤ 0,

(3.54)

with equality only if F = F0. The eigenfunctions and eigenvalues are the Hermite functions

C[φm] = −mφm,

for all m ≥ 0.

(3.55)

The Lenard–Bernstein operator preserves the leading order Maxwellian, C[F0] = 0, which
follows from F0 = φ0. Thus C[F ] = C[g], and expanding the perturbed distribution
m gmφm, we investigate the conservation properties by calculating the

integrals (3.46). Mass is conserved since

C[F ] dv = −

mgmδm0 = 0,

(3.56)

(cid:90) ∞

(cid:88)

−∞

m

mgmφm dv = −(cid:88)
(cid:90) ∞

m

function as g = (cid:80)
(cid:90) ∞
(cid:90) ∞

−∞

but the Lenard–Bernstein operator conserves neither momentum nor energy,

vC[F ] dv = − g1√
2

,

−∞

√
v2C[F ] dv = −2
2g2.

−∞

(3.57)

The Kirkwood operator [138] restores conservation of momentum and energy by incorpo-
rating local values of the ﬂuid velocity u and temperature T into F = v − u and D = T ,
giving

where

ni[F ] =

(cid:90) ∞

−∞

C[F ] =

F dv,

u[F ] =

∂
∂v

1
ni

(v − u[F ])F + T [F ]

vF dv,

T [F ] =

(3.58)

(v − u)2F dv,

(3.59)

(cid:19)
(cid:90) ∞

,

−∞

∂F
∂v

1
ni

(cid:18)
(cid:90) ∞

−∞

so that the Kirkwood operator is a nonlinear integro-differential operator.

3.2.3 The linearized Kirkwood collision operator

Formally in equation (3.1a) we require the linearized form of the Landau operator (3.43)
which describes collisions between the ion Maxwellian F0 and a perturbation g [139],

(cid:90)

C[g] =

·

∂
∂v

K(v − v(cid:48)) · F0(v)F0(v(cid:48))

(cid:18) g(v(cid:48))

(cid:19)(cid:21)

F0(v(cid:48))

− ∂
∂v(cid:48)

dv(cid:48). (3.60)

(cid:20) ∂

(cid:18) g(v)

(cid:19)

∂v

F0(v)

66

We replace this with the linearized Kirkwood operator

(cid:18)1

L[g] =

∂
∂v

∂g
∂v

+ vg + T [g]

∂F0
∂v

− u[g]F0

2

In Hermite space this linearized Kirkwood operator is

where the indicator function Im≥3 is deﬁned by

∞(cid:88)
(cid:40)

m=0

1
0

L[g] = −

mgmφmIm≥3,

Im≥3 =

for m ≥ 3,
otherwise.

(cid:19)

.

(3.61)

(3.62)

(3.63)

The eigenfunctions are the Hermite functions φm, each with corresponding eigenvalue
−mIm≥3. Thus φ0, φ1 and φ2 all have eigenvalue zero, which establishes the required
conservation properties.

With (3.62) the collisional version of the moment system (3.35) is

(cid:18)

(cid:19)

∂gm
∂t

+

i
k

˜ωnδn0 +

δn2

g0 +

˜ωT√
2

i√

2

δm1g0 + i

(cid:32)(cid:114) m + 1

(cid:114) m

(cid:33)

2

gm+1 +

2

gm−1
= −νmgmIm≥3.

(3.64)

Writing this in the form of (3.36), there are now imaginary entries on the diagonal of the
matrix. As it is complex, its eigenvalues do not necessarily occur in conjugate pairs, and so
the method can capture negative growth rates.

Figure 3.4 shows the growth rate plotted against parallel wavenumber for different col-
lision frequencies ν and numbers of Hermite functions N. Figure 3.4(a) shows that when
the collision frequency is small, the growth rate is similar to the collisionless case and
negative growth rates are not correctly captured. However when the collision frequency is
large enough to correctly capture the qualitative growth rate behaviour, the growth rate is
too large in the low wavenumbers and too small in the high wavenumbers. The correct rate
is found by increasing N, but Figure 3.4(b) shows this requires hundreds of terms.

Figures 3.4(c) and (d) show the Hermite spectra for two truncations with ν = 10−2 and
a ﬁxed parallel wavenumber, corresponding to points on the red curve in Figure 3.4(b). As
in Figure 3.3, the N = 100 calculation is correct for k/αi = 2 and incorrect for k/αi = 6.
Now, however, both spectra decay, even though the k/αi = 6 spectrum is not negligible
at the truncation point. The behaviour of the N = 10 spectra is similar to the N = 100
spectra. This shows we can truncate at different points without qualitative changes to the
spectra, but also that we must use a large number of terms to resolve collisional scales.

67

(a)

(c)

(b)

(d)

Figure 3.4: Kirkwood collisions. The growth rate is plotted for (a) varying collision fre-
quency ν and ﬁxed truncation point N = 100, and (b) varying truncation point and ﬁxed
collision frequency ν = 10−2. Spectra are plotted for truncations N = 10, N = 100 and
wavenumbers (c) k/αi = 2, (d) k/αi = 6.

3.2.4 Hypercollisions

To reduce the number of Hermite modes required to resolve collisional scales we introduce
a hypercollisional operator that leaves most of the spectrum unaffected but severely damps
a narrow range of the highest modes. This is deﬁned by

C[φm] = −(m/N )nφmIm≥3.

(3.65)

It differs from the Kirkwood collision operator (3.62) by the power n, and the replacement
of m by m/N. This is a convenient rescaling of ν so that the damping strength depends
on relative position within the truncated series, not absolute mode number. The highest
mode is damped by ν for all N, and the parameter n determines how sharply the damping
changes in Hermite space. A similar operator, C[φm] = −m(m− 1)(m− 2)φm, which also
conserves mass, momentum and energy, was proposed by CAMPOREALE ET AL. [98]. The
latter does not have a simple deﬁnition as a differential operator in velocity space, but can

68

012345678parallelwavenumber,k/αi−1.0−0.8−0.6−0.4−0.20.00.20.4growthrate,γν=10−1ν=10−2ν=10−3dispersionrelation012345678parallelwavenumber,k/αi−1.0−0.8−0.6−0.4−0.20.00.20.4growthrate,γN=100N=200N=300dispersionrelation100101102Hermitemode,m+110−810−710−610−510−410−310−210−1100freeenergy,|gm|2/2N=10N=100100101102Hermitemode,m+110−810−710−610−510−410−310−210−1100freeenergy,|gm|2/2N=10N=100be constructed from the Lenard–Bernstein operator [98]. In contrast, the hypercollisional
operator (3.65) may be deﬁned using the Kirkwood operator L (3.61), analogously to the
deﬁnition of hyperviscosity as a power of a Laplacian,

C[f ] ≡ −(−1)n

N n

Ln[f ].

(3.66)

The hypercollision operator inherits some properties from the Kirkwood operator. The
equilibrium distribution is unaffected by collisions as L[F0] = 0, and the Hermite functions
φm are the eigenfunctions. Hypercollisions conserve mass, momentum or energy. The free
energy Wf (3.49) does not increase under collisions, which is sufﬁcient for a linearized
theory: differentiating (3.49) with respect to time gives

= − N(cid:88)

m=3

(cid:17)n |gm|2,

(cid:16) m

N

dWf
dt

(3.67)

so that relative entropy R, and therefore entropy H, decrease to leading order in small
perturbations g (cid:28) F0.

(cid:18)

With hypercollisions, equation (3.35) becomes,

∂gm
∂t

+

i
k

˜ωnδm0 +

˜ωT√
2

δm2

g0 +

i√
2

δm1g0 + i

(cid:19)

(cid:32)(cid:114) m + 1

(cid:33)

(cid:114)m
(cid:17)n
(cid:16) m

N

gm+1 +

2

= −ν

gm−1
2
gmIm≥3.

(3.68)

As with Kirkwood collisions, the corresponding matrix is not purely imaginary, resulting
in negative growth rates.

Figure 3.5(a) shows that with hypercollisions the growth rate may be captured accu-
rately for all wavenumbers with as few as 10 modes. The quality of the approximation
depends on the parameters ν and n, but is quite robust to changes (a property we investi-
gate in §3.3.2). Figure 3.5(b) shows the normalized error plotted for various values of N.
This error is deﬁned as

Normalized Error =

,

(3.69)

|γcalc − γexact|

|γexact|

where γcalc is the computed growth rate, and γexact is the growth rate from the dispersion
relation (3.7). The normalized error decreases as N increases, but tends to increase as
k increases. The troughs in the ﬁrst three lines correspond to a change of sign in the
numerator of (3.69). The error is below one percent with as few as 10 terms in the Hermite
expansion.

Figures 3.5(c) and (d) show that high modes of the hypercollision spectra are now
damped to zero before the series is truncated. This is true for all truncations as the highest

69

(a)

(c)

(b)

(d)

Figure 3.5: Results for hypercollisions, ν = 16, n = 6: (a) the growth rate against parallel
wavenumber, and (b) the normalized error in the calculation The last two ﬁgures show
Hermite spectra for (c) k/αi = 2 and (d) k/αi = 6.

mode is always damped by −νgN. Again the behaviour of the low modes is independent
of N with the N = 10 spectrum agreeing with N = 100 spectrum before its highest
modes are damped. Before damping, the k/αi = 6 spectrum increases in magnitude with
increasing m, showing that the distribution would have ﬁne structure in velocity space but
for the effect of collisions and truncation.

3.3 Theoretical Hermite spectra and the hypercollision

plateau

We now study the Hermite spectrum of the hypercollisional system (3.68). We derive a
partial differential equation for the free energy density Em = |gm|2/2 as a function of
continuous (t, m) space. Solving for eigenmodes in time, we ﬁnd a theoretical expression
for the Hermite spectrum in terms of the growth rate and hypercollision parameters.

We also plot the calculated growth rate against the collision frequency ν and ﬁnd a

70

012345678parallelwavenumber,k/αi−1.0−0.8−0.6−0.4−0.20.00.2growthrate,γhypercollisions,N=10simpletruncation,N=100exactdispersionrelation012345678parallelwavenumber,k/αi10−1010−910−810−710−610−510−410−310−210−1100normalizederrorN=8N=10N=20N=100100101102Hermitemode,m+110−810−710−610−510−410−310−210−1100freeenergy,|gm|2/2N=10N=100100101102Hermitemode,m+110−1010−910−810−710−610−510−410−310−210−1100freeenergy,|gm|2/2N=10N=100¯gm

∂gm
∂t

+ i

gm+1¯gm +

¯gmgm−1

(cid:32)(cid:114) m + 1
(cid:32)(cid:114)m + 1

2

(cid:114)m
(cid:114) m

2

(cid:33)

= −ν

(cid:33)

bm

∂bm
∂t

+

bm+1bm −

2

bmbm−1

2

= −ν

for m > 2. The substitution bm = imgm gives the equation

N

(3.70)

(cid:16) m
(cid:17)n |gm|2,
(cid:17)n
(cid:16) m
(cid:112)(m + 1)/2, the

(3.71)

b2
m,

N

“hypercollision plateau”, an interval in ν where the growth rate is accurately calculated,
independent of the precise value of ν. Using the theoretical spectrum, we ﬁnd the ends of
the plateau and thereby derive inequalities for the parameter values in the hypercollision
operator.

3.3.1 Theoretical Hermite spectra

To derive the theoretical Hermite spectrum we follow the approach of WATANABE &
SUGAMA [140] and ZOCCO & SCHEKOCHIHIN [89], and multiply the kinetic equation
(3.68) by ¯gm (where overbar denotes the complex conjugate) to obtain the difference equa-
tion

which supports real-valued solutions bm. Deﬁning Γm+1/2 = bm+1bm
mode coupling term may be interpreted as a ﬁnite difference approximation to a derivative
in m considered as a continuous variable,

Γm+1/2 − Γm−1/2

(m + 1/2) − (m − 1/2)

≈ ∂Γm
∂m

.

(3.72)

We interpret Γm as the free energy ﬂux through mode numbers, the same concept as the
ﬂux that cascades through wavenumber space in Kolmogorov’s hydrodynamic turbulence
theory [95]. The approximation is valid in the large m limit, in which Γm ≈ b2
provided bm+1 ≈ bm. It is known from the theory of ﬁnite difference approximations for
advective partial differential equations that (3.71) also supports “alternating” or “parasitic”
solutions for which bm+1 ≈ −bm, and the ﬂux propagates in the opposite direction [141,
142]. We return to this point when studying the initial value problem in §3.4.

(cid:112)m/2,

m

In the large m limit, (3.71) may be rewritten as an evolution equation for the free energy

density, Em = |gm|2/2 = b2
∂Em
∂t

Introducing the variables µ =

(cid:18) ∂

(cid:16)√
(cid:19)

m/2, in continuous (m, t) space,

(cid:17)

(cid:16) m

(cid:17)n

2mEm

∂
+
∂m
√
2m and ˜Eµ = µEm, and multiplying (3.73) by µ gives

= −2ν

Em.

N

(3.73)

+

∂t

∂
∂µ

˜Eµ = −2νµ2n(2N )−n ˜Eµ.

(3.74)

71

Considering eigenmodes in time we have ∂gm/∂t = −iωgm and d ˜Eµ/dt = 2γ ˜Eµ, where
γ = Im(ω). Substitution into (3.74) yields

d ˜Eµ
dµ

= −2γ ˜Eµ − 2νµ2n(2N )−n ˜Eµ.

(3.75)

Solving, and rewriting the solution ˜Eµ using the original variables gives the Hermite spec-
trum of the eigenmode as

,

(3.76)

(cid:32)

Em =

C√
2m

exp

− γ
|γ|

(cid:19)n+1/2(cid:33)

(cid:18) m
(cid:18) m
(cid:19)1/2 −
(cid:21)1/(n+1/2)
(cid:20) N n (n + 1/2)

mγ

mc

√

ν

2

where the growth rate cutoff mγ and the collisional cutoff mc are deﬁned by

mγ =

1
8γ2

,

mc =

.

(3.77)

The spectrum has three parts: an underlying m−1/2 decay, and two exponential factors due
to the growth rate and collisions. Typically mγ < mc so collisions dominate at the largest
m. Modes above the collisional cutoff, m > mc, are strongly damped, with the steepness
of the cutoff increasing with increasing n. Between cutoffs, mγ < m < mc, the behaviour
depends on the sign of γ, with the spectrum growing for γ < 0 and decaying for γ > 0.
The m−1/2 behaviour is observed in the modes below both cutoffs. As γ → 0, the spectrum
becomes like m−1/2, like that of a delta function, as found in §3.1.1.

The theoretical spectra (3.76) for k/αi = 2 and k/αi = 6 are plotted in Figure 3.6
along with corresponding spectra calculated as eigenvectors of (3.68), and the collisional
and growth rate cutoffs. The growth rate γ in (3.76) is not determined in this derivation
of the spectrum, so we use the growth rate calculated in the discrete eigenvalue calculation
(3.68). Since the theoretical and numerical spectra are both eigenfunctions, their overall
normalizations are arbitrary. We have aligned the theoretical spectrum to the numerical
spectra using a least squares ﬁt for the normalization. The theoretical spectra for both
growth and decay show remarkable agreement with the numerical spectra. This is particu-
larly striking as the theoretical spectra are derived in the large m limit, but hold for modes
as small as m = 2. The collisional cutoff also gives an accurate guide for the point at which
hypercollisions become dominant.

3.3.2 Hypercollisional plateau against collisionality

We now study how the calculation of the growth rate depends on the parameters ν, n, and
N in the hypercollisional operator. In particular, we wish to choose ν and n to minimize

72

(a)

(b)

Figure 3.6: Calculated Hermite spectra with hypercollisions against theoretical spectra for
n = 6, ν = 10 and two wavenumbers (a) growing mode k/αi = 2 and (b) decaying
k/αi = 6. The two vertical lines are the growth rate and collisional cutoffs.

the necessary resolution N. We ﬁrst ﬁx N and n, and plot the growth rate of the k/αi = 6
decaying mode against the damping of the highest mode, ν, in Figure 3.7(a), and against the
collision frequency, ν/N n, in Figure 3.7(b). We ﬁnd that the decay rate is underestimated
until some critical value νcrit (marked with the vertical line ν = 6 in Figure 3.7(a)). Then
there is a plateau where the correct value is calculated for a range of ν, before the decay
rate becomes incorrect as ν becomes too large. This pattern is repeated for different values
of N. As N increases, νcrit is unchanged so that νcrit/N n, the minimum collision frequency
required for correct capture of the growth rate, decreases. However the right-hand end of
the plateau is at a ﬁxed ν/N n (≈ 1.2 × 10−6, marked in Figure 3.7(b)) so the range of
feasible values of ν increases with increasing N.

We ﬁnd the location of the plateau by calculating ∂γ/∂ν via matrix perturbation theory

[143]. We write (3.68) as the eigenvalue problem

ωa = (M − D)a,

(3.78)
where D is a diagonal matrix whose entries are Dmm = iν(m/N )nIm≥3, and a = (gm)
is the eigenvector of Hermite coefﬁcients for the dominant eigenvalue ω. Taking the ν-
derivative, we obtain

∂ν
so that left-multiplying by the adjoint eigenvector b∗ and rearranging gives

N

N

(cid:104)

∂a
∂ν

= −i

(cid:16) m
= −b∗(cid:2)(cid:0) m

N

(cid:17)n Im≥3a +
(cid:1)n Im≥3
(cid:3) a

b∗a

M − iν

(cid:80)N
(cid:80)N

m=3 b∗

m

= −

(cid:16) m

(cid:105) ∂a
(cid:17)n Im≥3
(cid:1)n gm
(cid:0) m

.

m=0 b∗

N
mgm

∂ω
∂ν

a + ω

−i

∂ω
∂ν

,

(3.79)

(3.80)

73

100101102Hermitemode,m+110−2010−1810−1610−1410−1210−1010−810−610−410−2100freeenergy,Emtheoreticalspectrumnumericalspectrumgrowthratecutoffcollisionalcutoff100101102Hermitemode,m+110−610−510−410−310−210−1freeenergy,Emtheoreticalspectrumnumericalspectrumgrowthratecutoffcollisionalcutoff(a)

(c)

(b)

(d)

Figure 3.7: The hypercollision plateau for n = 6. (a,b) The calculated growth rate for
different resolutions plotted against (a) the damping of the highest mode, and (b) the hy-
percollision frequency. There is a plateau where the calculated growth rate equals the value
obtained from the dispersion relation (3.7), indicated with the dashed line. In (a), the small
vertical lines indicate estimates for the start of the plateau: (ν = −γexact) from the lower
bound (3.84), and (ν = 6) by inspection. In (b), the vertical line indicates the end of the
plateau obtained by inspection. The end is at ν/N n ≈ 1.2 × 10−6 which corresponds to
mcrit = 10 (see (3.86)). (c) The derivative of the calculated growth rate |dγ/dν| against ν.
(d) The derivative of the calculated growth rate |dγ/d(ν/N n)| against ν/N n. In (c,d) there
is also a plateau that begins at ﬁxed ν and ends at ﬁxed ν/N n, but appears smaller than the
plateau in the growth rate due to the logarithmic scale.

74

10−310010310610910121015dampingofhighestmode,ν−0.7−0.6−0.5−0.4−0.3−0.2−0.10.00.1growthrate,γν=−γexactν=6N=16N=32N=64N=128N=25610−1810−1510−1210−910−610−3100collisionfrequency,ν/Nn−0.7−0.6−0.5−0.4−0.3−0.2−0.10.00.1growthrate,γν/Nn=1.2×10−6N=16N=64N=32N=128N=25610−310010310610910121015dampingofhighestmode,ν10−1610−1410−1210−1010−810−610−410−2changeingrowthrate,|dγ/dν|ν=6N=16N=32N=64N=128N=256N=16N=32N=64N=128N=25610−1810−1510−1210−910−610−3100collisionfrequency,ν/Nn10−910−710−510−310−110110310510710910111013Nn|dγ/dν|ν/Nn=1.2×10−6N=16N=32N=64N=128N=256N=16N=32N=64N=128N=256(a)

(b)

Figure 3.8: Location of the largest term in the numerator of (3.80) against (a) ν and (b)
ν/N n. The dashed line in (a) gives the theoretical shape of the N = 256 curve from
solving (3.82).

The ∂a/∂ν terms cancel since b∗ω = b∗(M − iν(m/N )nIm≥3), the adjoint equation of
(3.78). A set of parameters {ν, n, N} is in the plateau when ∂ω/∂ν is small.
In Fig-
ures 3.7(c) and (d) we plot ∂γ/∂ν = Re (−i∂ω/∂ν) against ν and against ν/N n. There
is a plateau where ∂γ/∂ν is small and constant, and, as with the growth rate plateau, the
plateau begins at ﬁxed ν and ends at ﬁxed ν/N n. As it is plotted on a logarithmic scale, the
plateau in ∂γ/∂ν appears to begin later and end sooner than the plateau in the growth rate.
Therefore Figures 3.7(c) and (d) give conservative values for the extent of the plateau.

Equation (3.80) shows that ∂ω/∂ν is a sum with contributions from each Hermite mode
m = 3, . . . , N. The location of the largest term in this sum is also a good indicator of
the extent of the plateau.
In Figures 3.8(a) and (b) we plot the m-value corresponding

(cid:1)n gm, the numerator in (3.80). To the left of

to the largest term in the sum(cid:80)N

(cid:0) m

m=3 b∗

m

N

the plateau, this is at m = N, it then decreases algebraically until it reaches m = 3.
Figure 3.8(a) shows that the plateau begins with m slightly smaller than N at ν = 6, while
Figure 3.8(b) shows that the end of the plateau ν/N n ≈ 1.2× 10−6 corresponds to m ≈ 10
for all resolutions.

We may relate the largest term in (3.80) to the dissipation of free energy by collisions
(discussed in §3.4.3) as follows. Since the eigenvector a and adjoint eigenvector b both
satisfy the theoretical spectrum (3.76), we may approximate the sum

(cid:32)

exp

− γ
|γ|

(cid:19)1/2 −

(cid:18) m

mγ

(cid:18) m

mc

(cid:19)n+1/2(cid:33)

.

(3.81)

75

(cid:16) m

(cid:17)n

N

b∗

m

N(cid:88)

m=3

gm ≈ N(cid:88)
N(cid:88)

m=3

=

(cid:16) m
(cid:16) m

N

(cid:17)n |gm|2
(cid:17)n 2C√

N

m=3

2m

10−310010310610910121015dampingofhighestmode,ν101102expectedvalueofmη=6N=256N=128N=64N=32N=1610−1810−1510−1210−910−610−3100collisionfrequency,ν/Nn101102expectedvalueofmν/Nn=1.2×10−6N=256N=128N=64N=32N=16The right-hand side of this is the free energy dissipated by collisions (see C (3.101)). Thus
the largest term in (3.81) is the Hermite mode which is most affected by collisions.

From (3.81) we may ﬁnd an approximate expression for the location of the largest term,
and use this to derive inequalities for the extent of the plateau. Treating m as a continuous
variable and taking the m-derivative of (3.81), we ﬁnd that the location of the largest term
m satisﬁes

mn+1/2 + γm1/2 − n − 1/2√

2

ν
N n

= 0.

(3.82)

The numerical solution of this equation (constrained between 3 and N) is plotted for the
N = 256 case in dashed black in Figure 3.8(a) and is in excellent agreement with the
observed largest value. To derive inequalities for the extent of the plateau, we solve (3.82)
approximately by taking balances of two of the terms. The ﬁrst term is positive while the
other two are negative, so we balance the ﬁrst term with the larger of the other two. This
is too crude to give quantitative agreement, but we shall derive qualitative behaviour. With
n = 6, γ = −0.387, the second term is larger than the third when m (cid:38) 100. For sufﬁciently
large N, this is the case at the left-hand end of the plateau. Thus balancing the ﬁrst two
terms in (3.82), we ﬁnd that the largest term is located at

N,

(3.83)

provided γ < 0. For the parameters to give a point in the plateau, the dominant m must
satisfy m < N, so dividing (3.83) by N we derive a lower bound for ν,

ν > −γ ≡ νcrit.

(3.84)

Plotting this in Figure 3.7(a), we see that this underestimates the beginning of the plateau;
in fact we have already observed that the plateau begins at νcrit = 6. Substituting νcrit = 6
into (3.83), we deduce that rather than m < N, we must have m (cid:46) 0.6N. That is, even the
smallest collision frequency must yield a spectrum where ∼ 40% of the modes are after the
most damped mode.

At the right-hand end of the plateau, m < 100 and the ﬁrst and third terms in (3.82)

(cid:18)−γ

(cid:19)1/n

m =

ν

balance, giving

m =

Figure 3.7(b) shows that the plateau ends at a critical value of the collision frequency,
(ν/N n)crit, so rearranging (3.85) we obtain the inequality

.

(3.85)

,

(3.86)

(cid:20) N n(n − 1/2)

(cid:21)1/(n+1/2)

√
2

ν

ν
N n

<

(n − 1/2)
√
mn+1/2
2

crit

=

(cid:16) ν

(cid:17)

N n

crit

76

(a)

(b)

Figure 3.9: The calculated growth rate for different hypercollision exponents plotted
against the damping of the highest mode for different resolutions (a) N = 128, and (b)
N = 32. The n = 1 corresponds to the Kirkwood operator, n = 6 to the hypercollision
operator used in §3.2, and n = 36 to the velocity space version of the Hou–Li ﬁlter [144]
used in PARKER & DELLAR [145].

where mcrit is a critical value of the peak of the Hermite spectrum deﬁned implicitly by the
equality in (3.86). Taking the observed value of (ν/N n)crit ≈ 1.2×10−6 from Figure 3.7(b),
we obtain mcrit = 10 (which also agrees well with the value given by Figure 3.8(b)). This
shows that the even the largest collision frequency must leave around 10 modes unaffected.
We use the inequalities for the two ends of the plateau to estimate the minimum possible
resolution N. At the minimum resolution, the left and right ends of the plateau coincide
so we combine the conditions m ≥ mcrit = 10 and m (cid:46) 0.6N to obtain the lower bound
N (cid:38) 17. Again, this is a conservative estimate—the correct growth rate was calculated in
§3.2.4 with N = 10—however for N (cid:46) 17, there is no guarantee of a range of ν values
that give the correct result.

The existence of νcrit gives a discrete analog of the work of NG ET AL. [71, 72]. There,
Landau-damped modes are found to be the eigenmodes of the collisional problem in the
limit of vanishing collisions; however the eigenfunctions of the purely collisionless prob-
lem are the undamped Case–Van Kampen modes. In our work Case–Van Kampen modes
are found without collisions, and Landau damped modes are found with hypercollisions
provided ν > νcrit. This means to take the limit of vanishing collisions ν/N n → 0 we must
also take the limit of inﬁnite resolution N → ∞.

3.3.3 Hypercollisional plateau against hypercollision exponent

We now study the plateau as a function of hypercollision exponent n. In Figure 3.9 we
plot the calculated growth rate against the damping of the highest mode for different n at

77

10−310010310610910121015dampingofhighestmode,ν−0.7−0.6−0.5−0.4−0.3−0.2−0.10.0growthrate,γn=1n=2n=4n=6n=8n=12n=3610−310010310610910121015dampingofhighestmode,ν−0.7−0.6−0.5−0.4−0.3−0.2−0.10.0growthrate,γresolutions N = 32 and N = 128. The overall pattern is very similar to Figure 3.7(a), with
the plateau beginning at a nearly constant ν and ending at ﬁxed (ν/N n). Thus the plateau
extends further with increasing n. This is seen in the plot for high resolution, N = 128,
in Figure 3.9(a). Two features of this plot are notable. Firstly, there is effectively no
plateau for the Kirkwood collision operator, n = 1, indicating it is not appropriate for use
as an operator for providing numerical dissipation (as opposed to a physically-motivated
collision operator). Secondly, the behaviour at the right-hand end of the plateau changes
with increasing n. For low n (cid:46) 4, the growth rate decreases further at the right-hand end
of the plateau, before returning monotonically to zero. At higher n (cid:38) 6, the growth rate
beyond the end of the plateau oscillates about the correct value before returning to zero.
Figure 3.9(a) suggests that one should increase n indeﬁnitely, with even very sharp cutoffs
like n = 36 (which corresponds to the velocity space version of the Hou–Li ﬁlter [144]
employed in PARKER & DELLAR [145]) performing very well. However this is only the
case for large N. Figure 3.9(b) shows the plateaus for N = 32. The low values of n
still have effectively no plateau, but now large n also do not have a plateau. With even
smaller resolutions down to around N = 16, only n ∈ {4, 6, 8} retain any plateau. Thus
for simulations with limited resolution we should choose n ∈ {4, 6, 8} for which there is a
robust plateau.

3.3.4 Convergence with hypercollision parameters

Finally we consider convergence of the calculated complex frequency ω to the exact fre-
quency from the dispersion relation ωexact. We plot the normalized error |ω − ωexact|/|ωexact|
at ﬁxed ν against N and against n in Figure 3.10. In Figure 3.10(a) we plot the error against
N for ν = 10 and various n. This shows algebraic convergence with N, with fastest con-
vergence for n ≈ 6. In Figure 3.10(b) we plot the same data against n. This shows that
convergence is fastest for the values n ∈ {4, 6, 8} corresponding to the region with a ro-
bust plateau in §3.3.3. However, there is almost no convergence for small (n = 1) or large
(n ≥ 36) values of n.

Figure 3.10(c,d) correspond to Figure 3.10(a,b), but now with ν = 100. These ex-
hibit similar behaviour, but now with increased collision strength, larger values of n yield
convergence.

3.4

Initial value problem

We now return to the free energy equation (3.74) and solve it as an initial value problem by
the method of characteristics. This allows us to explain recurrence in terms of free energy

78

(a)

(c)

(b)

(d)

Figure 3.10: Convergence to the complex frequency with N and n at k/αi = 6 and ﬁxed
ν. (a) Convergence against N for different n with ν = 10 and (b) the same data plotted
against n for each N. (c,d) Corresponding plots with ν = 100.

79

101102103N10−1010−810−610−410−2100|ω−ωexact|/|ωexact|n=1n=2n=4n=6n=8n=12n=36n=1n=2n=4n=6n=8n=12n=36100101n10−910−810−710−610−510−410−310−210−1100|ω−ωexact|/|ωexact|N=4N=8N=16N=32N=64N=128N=256N=512N=4N=8N=16N=32N=64N=128N=256N=512101102103N10−1010−810−610−410−2100|ω−ωexact|/|ωexact|n=1n=2n=4n=6n=8n=12n=36n=1n=2n=4n=6n=8n=12n=36100101n10−910−810−710−610−510−410−310−210−1100|ω−ωexact|/|ωexact|N=4N=8N=16N=32N=64N=128N=256N=512N=4N=8N=16N=32N=64N=128N=256N=512ﬂow in Hermite space. We also show that an eigenmode forms in the long time limit of a
sufﬁciently damped system.

3.4.1 Solution by method of characteristics

The characteristic equations for (3.74) are,

d ˜Eµ
dµ

= − 2νµ2n
(2N )n

˜Eµ,

dµ
dt

= 1,

(3.87)

showing that free energy propagates outwards along the straight line characteristics µ =
µ0 + t. The solution of (3.87) is
˜Eµ = ˜E0(µ − t) exp

(cid:0)(µ − t)2n+1 − µ2n+1(cid:1)(cid:19)

for µ ≥ t,

(cid:18)

,

(3.88)

ν

(n + 1/2)(2N )n

where ˜E0(µ) = ˜E(µ, t = 0). Without collisions, the initial values are conserved along
characteristics, while with collisions the ˜Eµ decay at a µ-dependent rate. We only have
initial data for non-negative mode numbers, m ∈ [0, N ] or µ ∈ [0,
N ]. The characteristics
t = µ− µ0 from these data only cover the region in phase space where µ ≥ t. In the region
µ < t, we still have characteristics with dµ/dt = 1, but no knowledge of the value ˜Eµ
along these. Moreover in deriving equation (3.74) we neglected the driving and Boltzmann
response terms in m = 0, 1, 2, and took the limit of large m. Therefore to ﬁnd the solution
inside the characteristic cone µ < t we must solve (3.68) numerically. The solutions for a
collisionless and collisional case are shown in Figure 3.11.

√

√
0 + t/

We can use the solution (3.88) to investigate the recurrence phenomena seen in Hermite
simulations of collisionless initial value problems [80]. Since instabilities are driven on
large scales, the initial conditions are dominated by low Hermite modes. These propagate to
higher m along the characteristics m1/2 = m1/2
2 and are undamped as ν = 0. When
the propagation reaches m = N, the calculation becomes invalid as the condition applied
is gN +1 = 0. This contradicts the assumption that gm is slowly varying in m, and results in
gN taking an incorrect value. Through mode coupling, this error propagates back to lower
modes. Assuming the initial conditions are only in g0, the propagation of initial conditions
to the highest mode takes a time t =
2N and so limiting the velocity space resolution
also limits the validity of the solution in time. This is seen in Figure 3.11(a) where without
sufﬁciently strong collisions, free energy reﬂects back into low modes causing an incorrect
solution. This gives an explanation for the scaling of the time until recurrence with total
number of modes used that was observed in early simulations [79, 80].

√

80

(a)

(b)

Figure 3.11: Normalized Hermite spectra for the initial value problem. At each time level
the spectrum is normalized by the maximum value of |gm|2/2 at that time. Dark areas show
√
relatively large values of free energy. We use the variable µ =
2m so that characteristics
are straight lines with gradient one. (a) With no damping the free energy reﬂects off the
highest mode and propagates back to the lower modes. (b) With hypercollisions free energy
is damped before reaching the highest mode. An eigenmode similar to Figure 3.6(b) forms.

Equation (3.74) only has outward-propagating characteristics, while Figure 3.11(a)
shows both outwards and inward propagating characteristics. We may also describe inward-
propagating characteristics in this framework. The derivation of (3.74) depends on the mod-
elling assumption that bm = imgm is slowly varying, so that bm+1 ≈ bm and (3.72) gives a
ﬂux. This leads to the outward characteristics t = µ − µ0. However one may equally use
cm = (−i)mgm, assuming instead cm+1 ≈ cm. This reverses the sign on the ﬂux and results
in inward characteristics t = µ0− µ. This provides the mechanism for reﬂected free energy
to propagate towards low modes if collisions provide insufﬁcient damping in the region of
the truncation point. Putting cm into equation (3.70) and proceeding as before leads to

(cid:18) ∂

(cid:19)

(cid:18)

(with ˜Eµ = µc2
this gives

− ∂
∂µ

∂t

˜Eµ = −2νµ2n(2N )−n ˜Eµ,

(3.89)
m/2), like equation (3.74) but with (∂t − ∂µ) replacing (∂t + ∂µ). Solving

(cid:0)µ2n+1 − (µ + t)2n+1(cid:1)(cid:19)

,

(3.90)

˜Eµ = ˜E0(µ + t) exp

ν

(n + 1/2)(2N )n

with characteristics µ = µ0 − t, which is the second,
Figure 3.11(a).

inwards characteristic in

In contrast, when collisions are suitably effective, no free energy is reﬂected and the
eigenmode with largest growth rate is found as the solution in the large time limit, as
shown in Figure 3.11(b).

81

051015202530p2m020406080100t0.00.10.20.30.40.50.60.70.80.91.0051015202530p2m020406080100t0.00.10.20.30.40.50.60.70.80.91.03.4.2 Wave analysis of the initial value problem

We can capture both inwards and outwards characteristics in a single framework using an
approach adapted from the wave analysis of ﬁnite difference schemes [142, 146, 147]. We
put the wave Ansatz

into (3.71) and, neglecting collisions, ﬁnd the frequency

bm = ˆb(m) exp(i(km − ω(k, m)t))

(cid:32)
√
eik − ˆb(m − 1)
√
ˆb(m + 1)

m

m + 1

ˆb(m + 1)

ˆb(m)

1
2i

(cid:33)

.

e−ik

(3.91)

(3.92)

ˆb(m + 1)

ˆb(m)

sin k,

√
ˆb(m − 1)
√
ˆb(m + 1)
m + 1

m

= 1,

(3.93)

ω =(cid:112)2(m + 1)
ω =(cid:112)2(m + 1)

Seeking a real frequency, we decompose this as

where the second term is two independent recurrence relations, one each for even and odd
m. Solving with a power series we ﬁnd

(cid:18)

m−5/4 + O(cid:0)m−9/4(cid:1)(cid:19)

ˆb(m) = b±

m−1/4 − 5
16

,

(3.94)

ω = ±(cid:112)2(m + 1)

(cid:18)

(cid:19)

1 − 1
4m

where b+ and b− are two undetermined constants corresponding to the even and odd series
respectively. For the amplitude of ω to vary smoothly with m, we need b+ = ±b−. Thus
there are two cases for ˆb(m), one where the sign changes between m and m + 1, and one
where it does not. This gives two cases for the frequency

(3.95)
where the ± sign is coupled to the sign in b+ = ±b−. The sign may be absorbed into a
change in k, so we consider only the case where b+ = b− and ω takes the plus sign.

sin k + O(m−3/2).

In the initial value problem, the initial conditions in the low moments cause an outgoing
wave. For the boundary condition bN +1 = 0 to be satisﬁed, the outgoing wave must cancel
with a reﬂected wave at the boundary, so we seek a solution as the sum of two waves:

bm = ˆb(m)ei(km−ω(k)t) + αˆb(m)ei(k∗m−ω(k∗)t).

(3.96)
For bN +1 = 0 to hold at all times, we require ω(k) = ω(k∗), so for non-trivial solutions
k∗ = π − k. Then bN +1 = 0 becomes an equation for α, giving α = (−1)N e2ik(N +1) and

bm = ˆb(m)ei(km−ωt) + (−1)N +me2ik(N +1)ˆb(m)e−i(km+ωt).

(3.97)

82

Thus the reﬂected wave has the same frequency and minus the wavenumber of the original
wave. The amplitude of the reﬂected wave oscillates with m, analogous to the oscillation
cm = (−1)mbm for the inward wave in the previous theory.

Collisions are simple to include. Retaining the right-hand side of (3.71), the frequency

is modiﬁed to

ω =(cid:112)2(m + 1)

(cid:18)

(cid:19)

(cid:16) m

(cid:17)n

N

1 − 1
4m

sin k − iν

+ O(m−3/2).

(3.98)

The algebra follows as before, except each wave solution is now damped by a factor of
exp (−ν (m/N )m t). An incoming wave is still needed to satisfy the boundary condition,
but in practice it is not seen if the outward-travelling wave has been damped sufﬁciently, as
in Figure 3.11(b).

the total free energy is W = Wf + Wϕ where Wf =(cid:80)∞

3.4.3 Eigenmode formation in the initial value problem
The free energy balance also gives insight into the initial value problem. As noted in §3.2.1,
m=0 |gm|2/2 and Wϕ = |ϕ|2/2 are
the free energy contributions from the distribution function and the electrostatic potential
respectively. Evolution equations for Wf and Wϕ are derived by multiplying (3.68) by
¯gm, and adding the resulting equation to its complex conjugate, giving an equation for
∂|gm|2/∂t. Summing these equations over m gives an equation for dWf /dt, while the
m = 0 case gives an equation for dWϕ/dt:
+ T + F = C,

− F = 0,

(3.99)

v2 − 1
2

¯g dv

= Re

g0¯g2

(cid:19)

√
2

(cid:18) i˜ωT
(cid:17)n |gm|2,
(cid:16) m

k

N

(cid:19)
(cid:19)

(cid:16)

dWϕ
dt

(cid:19)

N(cid:88)
(cid:17)

m=3

,

,

(3.100)

(3.101)

(3.102)

where

T = Re

(cid:18)

dWf
dt

(cid:18) i˜ωT
(cid:18)

k

ϕ

(cid:90) ∞
(cid:90) ∞

−∞

is the free energy source due to the temperature gradient,

C = Re

ν

¯gC[g]

−∞

F0

dv

= ν

is the free energy sink due to collisions and
F = Re

√
2¯g1g0

i

is the free energy ﬂux out of m = 0. Summing the two equations in (3.99) yields the
conservation equation

(Wf + Wϕ) + T = C.

d
dt

83

(3.103)

(a)

(c)

(b)

(d)

Figure 3.12: Time traces for (a) free energies and (b) their respective time derivative for
the initial value problem for k/αi = 6 and with hypercollisions ν = 10, n = 6. (c,d)
Corresponding plots with no collision operator.

As noted in §3.2.1, free energy is conserved in the absence of driving and collisions.

Introducing the time-integrated sources and sinks,

(cid:90) t

WT =

(cid:90) t

T (t(cid:48)) dt,

WC =

C(t(cid:48)) dt,

(3.104)

(3.105)

equation (3.103) becomes the conservation law

0

0

(Wf + Wϕ + WT − WC) = 0.

d
dt

In Figure 3.12(a) and (b) we plot the free energies and their derivatives against time
for an initial value simulation of the decaying mode k/αi = 6 with hypercollisions (ν =
10, n = 6) and resolution N = 512, corresponding to Figure 3.11(b). After an initial tran-
sient lasting until t = 10, the system enters a state reminiscent of the linear Landau solution
(3.8) and (3.9), where the free energy of the electric ﬁeld Wϕ decays exponentially while
the free energy of the distribution Wf remains constant. This corresponds to the initial
propagation of free energy out to high moments, as seen for early times in Figure 3.11.

84

020406080100time10−1110−1010−910−810−710−610−510−410−310−210−1100101freeenergyWfWϕWTWC020406080100time−0.4−0.20.00.20.40.60.81.0freeenergychangedWf/dtdWϕ/dtTC0246−0.50.00.51.0020406080100time10−1110−1010−910−810−710−610−510−410−310−210−1100101freeenergyWfWϕWT020406080100time−0.4−0.20.00.20.40.60.81.0freeenergychangedWf/dtdWϕ/dtT0246−0.50.00.51.0On reaching the highest modes, the free energy in the distribution function is damped by
collisions, as shown by the increase in C and corresponding decrease in dWf /dt at around
t = 25 in Figure 3.12(b). Thereafter both Wϕ and Wf decay exponentially with the linear
damping rate, showing that an eigenmode solution has formed.

For comparison, in Figure 3.12(c) and (d) we also plot the time traces for the system
without collisions, corresponding to Figure 3.11(a). After the initial transient, this system
enters the Landau regime and remains in this regime until the recurrence time. This corre-
sponds to the time taken for free energy to return to the lowest modes, having reﬂected from
the effective hard-wall boundary that results from setting gN +1 = 0 at the highest mode at
around t = 25, rather than being damped as in Figure 3.12(b). Note that, except during the
transient and the recurrence, Wf remains constant and Wϕ decays at the correct linear rate.
Note also that collisions have no effect on Wϕ because C[φ0] = 0, so the values of Wϕ in
the two simulations are the same until the recurrence time. Thus one can use the strictly
collisionless system to determine collisionless behaviour, but the validity of the simulation
is limited in time.

3.5 Arbitrary velocity space grids

The hypercollision operator is simple to implement on a Gauss–Hermite grid in velocity
space, and in Hermite space, since Hermite functions are its eigenfunctions and damping
is represented by a diagonal matrix D in a Hermite basis. We can also apply the same
hypercollision operator on arbitrary grids in velocity space, such as the parallel velocity
grid v(cid:107) used in [65] or the pitch-angle/energy grid (v2⊥/v2, v2) (with v ≡ v2⊥ + v2(cid:107) and v⊥ the
perpendicular velocity) used in [56, 88], only now the collision matrix is not diagonal. To
construct the collision matrix, we map distribution function values on the supplied velocity
grid to Hermite coefﬁcients with a matrix T−1, apply the hypercollision matrix D, and map
back to distribution function values at grid points with T. That is, we compute

C[g] = TDT−1g

(3.106)

where g = (g(v1), . . . , g(vN )) is the vector of distribution function values on the velocity
space grid, and the diagonal hypercollision matrix in Hermite space has coefﬁcients

Dml = −ν

δmlIm≥3.

(3.107)

(cid:16) m

(cid:17)n

N

85

(a)

(b)

Figure 3.13: Hypercollisional damping performed on a 16 point uniform grid in velocity
space: (a) growth rate and (b) eigenfunctions for wavenumbers k/αi = 2 and k/αi = 6.
The calculated function values are marked and interpolated with a 15th order polynomial.

The expansion of the distribution function as g(v) =(cid:80)N

m=0 gmφm(v) determines the trans-

formation matrix T through

g(vj) =

N(cid:88)

m=0

gmφm(vj),

Tjm = φm(vj),

(3.108)

and we invert T numerically to ﬁnd T−1. It is only necessary to perform this calculation
once if the velocity grid does not change in time, and computing C[f ] is then equivalent
to multiplication by a constant dense matrix. The growth rate and eigenfunctions calcu-
lated with hypercollisions on a uniform velocity space grid with 16 points are shown in
Figure 3.13.

3.6 Summary

In this Chapter we have introduced the Hermite spectral representation for parallel ve-
locity space. Expanding the distribution function in terms of polynomials which are or-
thogonal with respect to the Maxwell–Boltzmann distribution is a relatively old idea from
the kinetic theory of neutral gases dating from BURNETT [33] in the 1930’s, with Her-
mite polynomials themselves being introduced by GRAD [76, 77] in the 1940’s. Hermite
polynomials were also used in early plasma simulations [79–81] and are still valuable in
modern multi-processor simulations. Their main advantage is the neat structure of the
gyrokinetic-Maxwell equations when written in Fourier–Hermite space. There is very little
mode coupling in the kinetic equation, only nearest neighbour coupling from the streaming
term. Moreover, the integrals over parallel velocity space for the source terms in Maxwell’s

86

012345678parallelwavenumber,k/αi−1.0−0.8−0.6−0.4−0.20.00.20.4growthrate,γsimpletruncationhypercollisionsexactdispersionrelation−4−3−2−101234parallelvelocity,v−0.5−0.4−0.3−0.2−0.10.00.10.20.3distributionfunction,g(v)k/αi=2k/αi=6equations become evaluations of single Hermite coefﬁcients, rather than sums over velocity
space grids. This allows very efﬁcient solution of linear problems.

We have also studied the hypercollision operator. This too is a relatively old idea,
dating at least to the 1970’s [81], though it appears only to have been used as an ad hoc
method to prevent recurrence in calculating Landau-damped solutions. We showed that
a suitable hypercollision operator gives accurate growth rates with around ten to twenty
degrees of freedom (compared to the O(100) for grid methods) while also capturing Landau
damping (which collisionless methods cannot do at all). We studied the hypercollision
operator parameters and showed that there is a “plateau” in parameter space, a region where
the calculation gives an accurate growth rate and is insensitive to changes in resolution,
collision frequency, and hypercollision exponent. This means the hypercollision operator
is very well suited to practical use.

We have also derived an analytic expression for the Hermite spectra of eigenmodes.
The underlying m−1/2 spectrum is the same as that of a delta function, showing that in-
ﬁnitesimally ﬁne velocity space scales would develop, were it not for hypercollisions which
exponentially damp the ﬁnest scales. To ﬁnd this spectrum, we derived a partial differential
equation for free energy and its ﬂux through Hermite space. We showed that phase mix-
ing transfers free energy from large to small velocity space scales, analogously to the free
energy cascade through Fourier wavenumbers in hydrodynamic turbulence. In this case,
however, the transfer is linear and reversible. Indeed, in collisionless initial value problems
we observe a reverse ﬂux from small to large scales, resulting from the reﬂection of free
energy at the highest resolved mode. This forwards and backwards transfer of free energy
will be an important mechanism in our study of the nonlinear drift kinetic system in Chap-
ters 6 and 7. There however it will not be the unphysical reﬂection from the highest mode
which causes the ﬂux of free energy to large scales; it will be the result of the interaction
with the E × B nonlinearity.

87

Chapter 4

Perpendicular velocity space and the
Hankel transform

In Chapter 3, we introduced the Hermite representation for parallel velocity space which
minimized mode coupling in the gyrokinetic-Maxwell system. In particular, the Hermite
representation reduces the integrals over parallel velocity space to ﬁnd the charge and cur-
rent densities in Maxwell’s equations to single Hermite coefﬁcients. We wish to achieve
something similar with the more complicated integrals in perpendicular velocity space. In
Chapter 2, we derived the gyrokinetic-Maxwell system for hs, the distribution function for
charged rings (see summary §2.2.2). The distribution function hs is a function of guiding
centre position Rs = r−ρs, where r is the position space coordinate and ρs = Ω−1
s b×v is
the gyroradius. In contrast, the electromagnetic ﬁeld variables ϕ, A(cid:107), and B(cid:107) are functions
of position space r. Therefore, Maxwell’s equations for determining these from hs using
the quasineutrality condition and Amp`ere’s law (2.106),

(cid:88)
q2
s ns
(cid:88)
Ts
−∇2⊥A(cid:107) = 2βr
(cid:34)
(cid:88)

∇⊥ × βr

s

s

qsnsvths

(cid:90)

qsnsvths

−∇2⊥B(cid:107) = b ·

(cid:88)

s

(cid:90)

(cid:90)

ϕ =

qsns

d3v (cid:104)hs(cid:105)r ,
d3v v(cid:107) (cid:104)hs(cid:105)r ,
(cid:35)

d3v (cid:104)v⊥hs(cid:105)r

,

(4.1a)

(4.1b)

(4.1c)

s

contain gyroaverages in the integrands to account for the change of variables from Rs
to r. With the Fourier representation introduced in §2.4.2, the gyroaverages becomes
Inserting the complementary distribution function
multiplications by Bessel functions.

88

(cid:90)

qsns

(cid:88)

s

d3v gskJ0(as),

F0s/Ts) into (4.1) gives

(1 − Γ0s) − B(cid:107)k

qsnsΓ1s =

gs = hs − (qs (cid:104)χs(cid:105)Rs
(cid:88)

nsq2
s
Ts

ϕk

A(cid:107)k

k2⊥
2βr

+

s

(cid:88)
(cid:34)
(cid:88)

s

ϕk

nsqsΓ1s + B(cid:107)k

q2
s ns
2ms

Γ0s

(cid:32)

s

s

(cid:88)
(cid:88)
(cid:88)

s

(cid:35)

=

2
βr

+

(cid:90)
(cid:33)

(4.2a)

(4.2b)

d3v gskv(cid:107)J0(as),

qsnsvths

TsnsΓ2s

= −(cid:88)

s

s

(cid:90)

nsTs

d3v gskv2⊥

2J1(as)

as

, (4.2c)

where Γ0s = I0(bs)e−bs, Γ1s = (I0(bs)− I1(bs))e−bs and Γ2s = 2Γ1(bs), with as = ρsk⊥v⊥
and bs = (ρsk⊥)2/2. Thus while the integrands in (4.2) contain only simple factors in
parallel velocity space, they contain Bessel function factors in perpendicular velocity space.
To ﬁnd the ﬁelds, we therefore need to evaluate the perpendicular velocity space integral

(cid:90) ∞
for (4.2a,b), and the integral (cid:90) ∞

0

dv⊥ v⊥J0(ρsk⊥v⊥)g(v⊥),

dv⊥ v2⊥J1(ρsk⊥v⊥)g(v⊥),

(4.3)

(4.4)

0

(cid:90) ∞

for (4.2c). We focus on (4.3) since this is always needed to ﬁnd ϕk and A(cid:107)k. The integral
(4.4) is only needed when B(cid:107)k (cid:54)= 0, and we treat this later in §4.2.

We will see in §4.1 that the integral (4.3) is the zeroth order Hankel transform of g,

¯g(p) =

dv⊥ v⊥J0(pv⊥)g(v⊥),

(4.5)

0

evaluated at the point p = ρsk⊥ [148]. This shows that the phase space line p = ρsk⊥ is of
particular signiﬁcance for computing the electromagnetic ﬁeld: we may ﬁnd ϕk and A(cid:107)k
by knowing ¯g only along the line p = ρsk⊥, rather than everywhere in phase space. This
is similar to the idea that ﬁnding ϕk and A(cid:107)k only requires the zeroth and ﬁrst Hermite
moments.

In this Chapter we represent g using the Hankel transform ¯g to exploit this phase space
locality. We discuss two approaches to solving the gyrokinetic-Maxwell system in Han-
kel space: (1) using a purely spectral method with the grid pi = ρsk⊥ = ρs
x + k2
y
implied by the uniform Fourier grids kx, ky; and (2) a pseudospectral method using grids
of scaled Bessel roots in p and v⊥. For the former, we use the continuous Hankel trans-
form (4.5) whose properties are introduced in §4.1. This is equivalent to representing the
distribution function g as an inﬁnite superposition of zeroth-order Bessel functions with

(cid:112)k2

89

different arguments. For the latter, we introduce the discrete Hankel transform in §4.2,
which is equivalent to representing g as the ﬁnite sum of zeroth-order Bessel functions
with different arguments. Both the continuous and discrete Hankel transforms prove useful
in computation, but when each is used depends on the properties of the particular system
being solved. In §4.3 we discuss the Hankel space structure of gyrokinetics to inform the
different Hankel space implementations in SPECTROGK. Finally in §4.4 we present the
two approaches to perpendicular velocity space which are implemented in SPECTROGK:
the spectral (Galerkin) and pseudospectral (collocation) approaches, which are analogous
respectively to the expansion coefﬁcient and grid point value approaches discussed in Chap-
ter 3.

4.1 Continuous Hankel transform

The continuous Hankel transform (4.5) is deﬁned provided that the integral

dv⊥ v1/2⊥ |g(v⊥)|,

(4.6)

exists. It is sufﬁcient for g(v⊥) to be piecewise continuous and of bounded variation in
every ﬁnite subinterval of (0,∞) [149].

The Hankel transform (4.5) is its own inverse,

(cid:90) ∞

0

(cid:90) ∞

0

g(v⊥) =

dp pJ0(pv⊥)¯g(p),

which follows from the orthogonality relation for Bessel functions:
dv⊥ pv⊥J0(pv⊥)J0(qv⊥) = δ(p − q).

(cid:90) ∞

(4.7)

(4.8)

0

Therefore the inverse Hankel transform (4.7) represents g as the superposition of zeroth
order Bessel functions with different arguments.

The Hankel transform (4.5) is the radial part of the two dimensional Fourier transform,
and is therefore equivalent to the two dimensional Fourier transform of an axisymmetric
function [150].
In particular, since the distribution function is gyrophase independent,
the Hankel transform is the Fourier transform of g in perpendicular velocity space. The
line p = ρsk⊥ is then the set of phase space points where the Fourier wavenumbers for
perpendicular physical space and perpendicular velocity space are equal, for the species
used to deﬁne the normalization (for which ρs = 1 in our units).

90

4.2 Discrete Hankel transform

(cid:90) ∞

∞(cid:88)

n=1

2
τ 2

We also consider the discrete Hankel transform, which we introduce via a quadrature rule
on a grid of scaled Bessel function roots, based on a result due to FRAPPIER & OLIVIER
[151]. As well as the discrete Hankel transform, this gives us a quadrature rule to use for
other perpendicular velocity integrals which are not (zeroth-order) Hankel transforms, such
as in the perpendicular Amp`ere’s law for B(cid:107) (2.129c) and in the free energy (2.131). The
quadrature rule is based on the formula

dv⊥ v⊥f (v⊥) =

1
J 2
1 (jn)

f (jn/τ ),

(4.9)

0

where jn are the roots of the zeroth-order Bessel function, so that J0(jn) = 0, and τ > 0

is a free scaling parameter. This formula holds for functions f such that f (v⊥) = O(cid:0)v−δ⊥

for δ > 2 as v⊥ → ∞, and such that for every  > 0, there exists a constant A such that
|f (z)| ≤ A exp(2|z|) as |z| → ∞, for complex z [151, Theorem 1]. These are satisﬁed by
typical distribution functions.

(cid:1)

Motivated by the Gaussian decay of the Maxwell–Boltzmann distribution, we assume
f (v⊥) is negligible for v⊥ greater than some velocity space cutoff vcut, and construct a
velocity grid using the ﬁrst Np scaled Bessel roots, vn = jn/τ = jnvcut/jNp+1, with τ =
jNp+1/vcut. With (4.9), this yields the quadrature rule

(cid:90) vcut

0

dv⊥ v⊥f (v⊥) =

2
τ 2

1
J 2
1 (jn)

f (vn) =

wnf (vn),

(4.10)

Np(cid:88)

n=1

Np(cid:88)

n=1

cut/(j2

1 (jn)). We may use this to evaluate the free energy
with the weights wn = 2v2
integrals (2.131) by setting f (v⊥) = |g(v⊥)|2/F ⊥
0 (v⊥), and the integrals for charge and
current density in Maxwell’s equations (2.129) by setting f (v⊥) equal to J0(k⊥v⊥)g(v⊥)
or v⊥J1(k⊥v⊥)g(v⊥).

Np+1J 2

The quadrature rule (4.10) is consistent with the discrete Hankel transform given by
JOHNSON [149], which we now derive. Setting f (v⊥) = J0(k⊥v⊥)g(v⊥) in (4.10), we
obtain the semi-discrete Hankel transform

¯g(p) =

dv⊥ v⊥J0(pv⊥)g(v⊥) =

wnJ0(pvn)g(vn),

(4.11)

0

n=1

the Hankel transform which is discrete in v⊥, but continuous in p. Further, restricting (4.11)
to the grid pm = jm/vcut, we obtain the discrete Hankel transform

¯g(pm) =

wnJ0(pmvn)g(vn) =

v2
cut
j2
Np+1

91

2J0(pmvn)

J 2
1 (jn)

g(vn).

(4.12)

(cid:90) vcut

Np(cid:88)

n=1

Np(cid:88)

Np(cid:88)

n=1

Figure 4.1: The ﬁrst six Hankel basis functions.

This p-grid is chosen to exploit the discrete orthogonality relation [149]

Np(cid:88)

Np(cid:88)

m=1

J0(jmjl/jNp+1)J0(jnjl/jNp+1)

l=1

J 2
1 (jl)

=

J 2
1 (jm)j2

Np+1

4

δnm.

(4.13)

With the discrete Hankel variable pn = jn/vcut and the velocity grid vn = jnvcut/jNp+1,
(4.13) gives the two orthogonality relations

Np(cid:88)

Np(cid:88)

=

J0(pmvl)J0(pnvl)

J0(plvm)J0(plvn)

l=1

J 2
1 (jl)

l=1

J 2
1 (jl)

=

1 (jm)j2
J 2

Np+1

4

δnm.

(4.14)

Multiplying (4.12) by 2J0(pmvl)/(v2
tain the exact inverse transform to the discrete Hankel transform (4.12),

1 (jm)), summing over m and using (4.14), we ob-

cutJ 2

g(vl) =

1
v2
cut

2J0(pmvl)
J 2
1 (jm)

¯g(pm) =

j2
Np+1
v4
cut

wmJ0(pmvl)¯g(pm).

(4.15)

As with the Hermite representation (3.28), we may think of (4.15) either a discretization
of g on a velocity space grid, or as a truncated spectral expansion. In (4.15), the basis
functions are 2J0(pmvl)/(v2
1 (jm)). The continuous v⊥ version of the basis functions,
1 (jm))I[0,vcut] (where I[0,vcut] = 1 if v⊥ ∈ [0, vcut] and 0 otherwise), are
2J0(pmv⊥)/(v2
plotted in Figure 4.1. The nonzero part of these functions oscillates with characteristic
wavelength 2π/pm so that higher pm correspond to more quickly oscillating functions.

cutJ 2

cutJ 2

The discrete Hankel transforms (4.12) and (4.15) form a self-inverse pair up to a con-

stant factor

Np(cid:88)

n=1

¯g(pm) =

v2
cut
j2
N +1

hmng(vn),

g(vn) =

92

Np(cid:88)

m=1

1
v2
cut

hnm¯g(pm),

(4.16)

Np(cid:88)

m=1

0.00.20.40.60.81.01.2v/vcut30201001020304050602J0(pnv)/J21(jn)/v2cutHankel basis functionswhere hmn are the coefﬁcients of the transform matrix:

hmn =

2J0(jnjm/jNp+1)

J 2
1 (jn)

.

(4.17)

4.3 Hankel space structure of gyrokinetics

To allow comparison of different perpendicular velocity space methods, we now study the
structure of the gyrokinetic-Maxwell system in Hankel space. It sufﬁces to consider the
collisionless, single ion species, electrostatic gyrokinetic-Maxwell system (A(cid:107) = B(cid:107) = 0)
with no driving (L−1
n = 0) and no inhomogeneities in the magnetic ﬁeld (κ =
L−1
B = 0). All the effects neglected here (bar the gradient-B term) may also be treated
purely spectrally, i.e. using the expansion coefﬁcients without introducing a collocation grid
in v⊥. Taking the Hermite transform of (2.139) and denoting Fourier–Hermite expansion
coefﬁcients by gkm, the ion gyrokinetic equation becomes

T = L−1

(cid:32)(cid:114)m + 1

2

∂gkm(v⊥)

+ ivthik(cid:107)

∂t
qs√
msTs

+ i

k(cid:107)√
2

δm1J0(ρik⊥v⊥)F ⊥

and the quasineutrality condition becomes

(cid:18)

(cid:19)

ϕk

niq2
i
Ti

1 +

− Γ0i

Ti
Te

gk,m+1(v⊥) +

2

(cid:114)m
0 (v⊥)ϕk +(cid:8)(cid:104)ϕ(cid:105)Ri
(cid:90)

(cid:33)
, gm(Ri, v⊥)(cid:9)

gk,m−1(v⊥)

= 0,

k

= 2πqini

dv⊥ v⊥J0(ρik⊥v⊥)gk,m=0(v⊥)

= 2πqini ¯gk,m=0(p = ρik⊥).

(4.18)

(4.19)

(4.20)

Here to obtain (4.20) we have noted that the integral on the right-hand side of (4.19)
is in the form of a Hankel transform (4.5) with argument p = ρik⊥. The electrostatic
potential is therefore determined using only the single Fourier–Hankel–Hermite mode
¯gk,m=0(p = ρik⊥), i.e., a single (p, m) dual velocity space point for each Fourier wavenum-
ber k. Thus the system greatly simpliﬁes if this mode decouples from other modes.

Taking the continuous Hankel transform of (4.18), we obtain the gyrokinetic equation

∂¯gkm(p)

∂t

+ ivthik(cid:107)

¯gk,m+1(p) +

(cid:32)(cid:114) m + 1
dv⊥ v⊥J0(pv⊥)(cid:8)(cid:104)ϕ(cid:105)Ri

(cid:114) m
exp(cid:0)−(ρik⊥)2/2(cid:1) I0
, gm(Ri, v⊥)(cid:9)

k(cid:107)√
2

1
2π

δm1

2

2

¯gk,m−1(p)

(cid:33)
(cid:0)(ρik⊥)2/2(cid:1) ϕk

= 0,

k

+ i

qs√
msTs

(cid:90) ∞

+

0

(4.21)

93

for ¯g deﬁned in (4.5). This shows that the Hankel and Fourier modes are coupled only
through the nonlinear term, while the Hermite modes are coupled only through the stream-
ing term.
In the linearized system, the Fourier–Hankel modes decouple, meaning that
the system reduces to a one-dimensional problem in Hermite space, parameterized by the
wavenumber k and Hankel mode p = ρik⊥. As established in Chapter 3, the one dimen-
sional Hermite system may be solved very efﬁciently.

In the nonlinear system, the Fourier–Hermite modes remain coupled. The nonlinear
system has been studied in Hankel space in the simpliﬁed case with k(cid:107) = 0 [152–155]. This
so-called “two-dimensional gyrokinetics” (i.e. the two perpendicular spatial dimensions
plus perpendicular velocity space) has two signiﬁcant differences from ﬁve-dimensional
gyrokinetics (4.20) and (4.21). Firstly, as parallel velocity space is neglected, there is no
free energy transfer via parallel phase mixing and therefore no Landau damping. Sec-
ondly, while collisionless ﬁve-dimensional gyrokinetics conserves free energy (2.107),
two-dimensional gyrokinetics conserves both free energy and the electrostatic invariant
(2.114), see also [154]. Free energy cascades forwards (as in ﬁve-dimensional gyrokinet-
ics), while the electrostatic invariant has either a forwards or inverse cascade depending
on the distribution of free energy in phase space [155]. Despite these differences, the non-
linear term, and therefore the perpendicular free energy transfer mechanism, is the same in
two- and ﬁve-dimensional gyrokinetics, and it is reasonable to expect some properties of
the two-dimensional system to be replicated in ﬁve dimensions.

Studies of two-dimensional gyrokinetics highlight the signiﬁcance of the phase space
line p = ρik⊥, beyond its meaning as the only Hankel modes required to determine the
electromagnetic ﬁeld. PLUNK ET AL. [154] showed that Fourier and Hankel modes are
coupled via a three mode interaction which is most signiﬁcant near the line p = ρik⊥ (see
(4.27) below). PLUNK ET AL. [154] also derived spectra for the free energy:

(cid:40)

W (ρik⊥, p) ∝

(ρik⊥)−2p−1/3,
p−2(ρik⊥)−1/3,

ρik⊥ (cid:29) p (cid:29) 1,
p (cid:29) ρik⊥ (cid:29) 1,

(4.22)

showing that these decay away from the line p = ρik⊥. TATSUNO ET AL. [153] conﬁrmed
these spectra numerically, and moreover showed that free energy transfer, while in principle
nonlocal, is in effect local with all signiﬁcant transfer conﬁned to a narrow band about
p = ρik⊥.

These simulations were carried out using the code ASTROGK [56, see also §5.2.1],
which uses a Fourier representation in perpendicular space, and a pitch angle-energy-sign
grid in velocity space. To resolve the ﬁne velocity space structure, these simulations used

94

up to 16384 points in velocity space, corresponding to Np ∼ O(100).1 The Hankel rep-
resentation was used only for post-processing, rather than for computation; however the
results suggest properties which may be exploited in computations, and we now discuss
different approaches to performing these calculations in Hankel space.

4.4 Alternative Hankel treatments of perpendicular

velocity space

We compare three approaches to solving the gyrokinetic-Maxwell system which arise from
writing these equations in different forms in Hankel and perpendicular velocity space. We
do this to determine which is the most efﬁcient method, and where our knowledge of the
Hankel space structure of gyrokinetics can lead to computational savings. Ultimately we
ask: is the system better treated by discretizing (4.18) and (4.19) in perpendicular velocity
space, or by discretizing (4.20) and (4.21) in Hankel space? For each, what is the best
discretization grid to use?

To measure efﬁciency we consider the computational complexity and inter-processor
communication involved in calculating terms in the equations. Large complexity is caused
by sums over phase space, while communication is caused by nonlocality in phase space.
It transpires that the calculation of the nonlinear term dominates both complexity and com-
munication, due to the distributed Fourier and Hankel transforms. We follow the traditional
numerical analysis approach of quantifying complexity, but by minimizing the number of
Fourier and Hankel transforms, we will be minimizing both complexity and communica-
tion.

The nonlinear term has the structure of a Fourier convolution, and so is most efﬁciently
calculated pseudospectrally using the Fast Fourier Transform [156, 157]. This requires
O(NX log2 NX) operations, where NX = NxNyNz is the total number of spatial grid
points. The discrete Hankel transform can also appear in the calculation of the nonlinear
term in Hankel space. The Hankel transform (4.5) is equivalent to the radial part of a two-
dimensional Fourier transform [150], but while there is work on polar Fourier transforms
[e.g. 158], there is no exact radial Fast Fourier Transform. Similarly there are efﬁcient
approximations to the continuous Hankel transform for large numbers of points [159, 160]
but as we expect to have relatively few points in perpendicular velocity, we may also calcu-

1In this case, ASTROGK is unnecessarily resolving both parallel and perpendicular velocity space, when
only perpendicular velocity space is required. This is because perpendicular velocity cannot be expressed
using only one of pitch angle and energy.

95

(a)

(b)

Figure 4.2: Possible discretizations in Hankel space. The diagonal line is p = ρsk⊥, the
line along which the electrostatic potential is calculated. (a) The Hankel grid in p is chosen
to comprise the same points as the ρsk⊥ points. The electrostatic potential is found as a
single function evaluation (at the blue points), but the Hankel grid will contain many points.
(b) An arbitrary grid is used for Hankel space. The point p = ρsk⊥ is not in general a grid
point. The electrostatic potential is found by interpolating the value of ¯gi0(k, ρik⊥) at the
blue point, from the values ¯gi0(k, pn), the red points.

late the discrete transform (4.12) using the matrix multiplication (4.17), for which highly
efﬁcient implementations are available (e.g. BLAS [161]).

We are also interested in the calculation of the electrostatic potential from the quasi-
neutrality condition (4.19). In Hankel space, the electrostatic potential is proportional to
a single Fourier–Hankel–Hermite mode, and in the linearized system, the lack of coupling
lets us evolve this mode alone. In the full system, mode coupling means that we need a
grid in Hankel space. To take advantage of the calculation of the electrostatic potential as
a single mode, we would need a grid point at every p = ρsk⊥—a Hankel space grid with
O(NxNy) points! The alternative is either to neglect modes that are far from p = ρsk⊥,
or to use a smaller grid in p, and evaluate ¯g0(k, p = ρsk⊥) via interpolation as a sum of
¯g0(k, pn). These two approaches are shown schematically in Figure 4.2. A discretization
on a generic v⊥ grid will also lead to the evaluation of the electrostatic potential via a sum,
but now through a quadrature rule. These summations will have complexity far smaller
than that of the calculation of the nonlinear term, but will result in (modest) inter-processor
communication, as discussed in §5.2.3.

96

We now derive the three approaches to the nonlinear term: a discretization in v⊥, a
pseudospectral approach, and a purely spectral approach on a grid in p. The discretization
grids are not chosen a priori, but must be determined as part of the method.

4.4.1 Discretization in velocity space

(cid:90)

R3

The nonlinear term in v⊥–Fourier–Hermite space from equation (4.18) is
˜k⊥v⊥) ˆϕ(˜k)ˆgm(k − ˜k, v⊥),

d3 ˜k b · (˜k × k)J0(ρi

(4.23)

a Fourier convolution which may be written as the product of Fourier transforms

F(cid:0)F−1 (ikxJ0(ρik⊥v⊥) ˆϕ)F−1 (iky ˆgm) − F−1 (ikyJ0(ρik⊥v⊥) ˆϕ)F−1 (ikxˆgm)(cid:1) . (4.24)

There is no coupling in v⊥–Hermite space, but the convolution couples Fourier modes.
The ﬁve Fourier transforms dominate the work. Three of the Fourier transforms are of
distribution-sized arrays and require O(NXNmNp log2(NX)) operations, while the two
transforms of J0(k⊥v⊥) ˆϕ only require O(NXNp log2(NX)) operations since ˆϕ has no m-
dependence.

Although the lack of v⊥-coupling in the nonlinear term allows an arbitrary treatment
of v⊥, we need to introduce a quadrature grid to approximate the perpendicular velocity
integral to ﬁnd ˆϕ from the quasineutrality condition.

4.4.2 Discretization in Hankel space

The nonlinear term in Hankel space (from equation 4.21) is

HF(cid:110)F−1 (ikxJ0(ρik⊥v⊥) ˆϕ)F−1(cid:0)ikyH−1¯gm

(cid:1)

− F−1 (ikyJ0(ρik⊥v⊥) ˆϕ)F−1(cid:0)ikxH−1¯gm

(cid:1)(cid:111)

,

(4.25)

where we have substituted in the deﬁnition ¯g = Hˆg with H the continuous Hankel trans-
form (4.5). The pseudospectral approach is to discretize this in Hankel space on the grid
of Bessel roots pn = jn/vcut introduced in §4.2 and use the discrete Hankel transform
(4.16) instead of H. In addition to the ﬁve Fourier transforms in (4.24), there are now three
Hankel transforms each of complexity O(N 2
p NXNm). Thus this direct pseudospectral ap-
proach is not useful. However PLUNK ET AL. [154] showed that the integrals in the Hankel
transforms in (4.25) may be rearranged to give

dq qF(cid:104)F−1(cid:0)ikxK(ρik⊥, p, q) ˆϕ(cid:1)F−1(cid:0)iky ¯gm(k, q)(cid:1)

(cid:90) ∞

0

− F−1 (ikyK(ρik⊥, p, q) ˆϕ)F−1 (ikx¯gm(k, q))

97

(cid:105)

,

(4.26)

Figure 4.3: Contour of the integral K(k⊥, p, 5) from (4.27).

where

(cid:90) ∞

0

K(ρik⊥, p, q) =

dv⊥ v⊥J0(ρik⊥v⊥)J0(pv⊥)J0(qv⊥),

(4.27)

is a known integral: if the scalars ρik⊥, p, q can form the three sides of a triangle, then
K = 1/(2π∆) where ∆ is the area of that triangle; otherwise K = 0. The example of
K(ρik⊥, p, 5) is plotted in Figure 4.3. The integral is zero for q (cid:54)∈ (|ρik⊥ − p|, ρik⊥ + p);
otherwise, it is largest as q approaches edge of that interval (but zero when q = |ρik⊥ − p|
or q = ρik⊥ + p. Thus we may rewrite the nonlinear term as

dq qF(cid:104)F−1(cid:0)ikxK(ρik⊥, p, q) ˆϕ(cid:1)F−1(cid:0)iky ¯gm(k, q)(cid:1)

(cid:90) ρik⊥+p

|ρik⊥

−p|

− F−1 (ikyK(ρik⊥, p, q) ˆϕ)F−1 (ikx¯gm(k, q))

(cid:105)

.

(4.28)

This shows that some localization is preserved from the linearized case. In the linearized
case we only need to evolve the Hankel mode p = ρik⊥. In this nonlinear case, we need
to evolve all Hankel modes, but for each p and ρik⊥, only the subset of modes (|ρik⊥ −
p|, ρik⊥ + p) contributes to the nonlinear term. Of course, to evolve the ρik⊥ + p mode,
we need to know modes up to 2ρik⊥ + p, etc., so in this fashion all modes are coupled.
However at a given p and a given timestep, only a subset of modes are required to exactly
calculate the nonlinear term.

As before, the three distribution-function-sized Fourier transforms have complexity
O(NpNmNX log2(NX)). However now we must evaluate the transforms of K ˆϕ in (4.28)
for all p and q, so that the two transforms of the electrostatic potential are increased by fac-
tor of Np to O(N 2
p NX log2(NX)). Thus this method is also not viable, unless the resolution
is such that Np is smaller than the O(100) points required in the velocity grid method in

98

the same uniform 100 point grid in kx and ky, which yields 53 unique k⊥ = (cid:112)k2

Figure 4.4: A k⊥–p grid masked around the line p = ρik⊥. The grid is formed taking
x + k2
y
points. The Hankel grid is chosen such that p = ρik⊥, yielding a total array of 532 = 2809
points. The black and dark grey points are in the intervals p ∈ [ρik⊥ − 1, ρik⊥ + 1] and
p ∈ [ρik⊥−3, ρik⊥ +3] respectively. There are 457 black points and 1289 dark grey points,
so restricting the calculation to these regions reduces the number of Hankel modes by 84%
and 54% respectively.

§4.4.1. Such a reduction may be achieved by using the observed localization properties in
Hankel space, namely, the localization of free energy ﬂow about the diagonal p = ρik⊥
[153] and decay in the spectrum away from the diagonal [153, 154]. These properties sug-
gest that we may neglect modes away from the diagonal. Figure 4.4 shows an example of
this for k⊥–p space with k⊥ and p discretized on the same grid. Restricting the simulation to
points within a band about p = ρik⊥ dramatically reduces the resolution and therefore com-
plexity. For example, restricting the simulation to the band p ∈ [ρik⊥− 3, ρik⊥ + 3] reduces
the number of Hankel modes by 54%, while restricting it to the band p ∈ [ρik⊥−1, ρik⊥+1]
reduces the number of modes by 84%. Moreover, the width of the band is a parameter
which takes the system from a full kinetic simulation to a reduced model.

4.4.3 SPECTROGK discretization
The fully spectral approach described in §4.4.2 is implemented in SPECTROGK, but is
not used for the simulations in this thesis. The reason for this is that simulations of the
ρik⊥ < 1 regime (like that presented in §5.3.2) has limited perpendicular phase mixing, so
the resolution requirements in v⊥ are modest. Instead it is more efﬁcient to work on a grid in

99

02468101214p02468101214ρskperpendicular velocity, calculating the nonlinear term as (4.24). We discretize on the grid of
scaled Bessel roots vn = jnvcut/jNp+1 as described in §4.2, with the electrostatic potential
calculated from (4.20) by setting the integrand to be f (v⊥) = J0(ρik⊥v⊥)gm(k, v⊥) in the
quadrature rule (4.10),

¯gm(k, ρik⊥) =

dv⊥ v⊥J0(ρik⊥v⊥)gm(k, v⊥) =

wnJ0(k⊥vn)gm(k, vn).

(4.29)

0

n=1

By discretizing on this grid, the method is completely equivalent to the pseudospectral
method (4.25) which solves for ¯gm(k, pn) on the grid pn = jn/vcut.
In this case how-
ever, the calculation of ¯gm(k, ρsk⊥) for the quasineutrality condition may be viewed as an
interpolation formula, as follows. Using (4.15) to substitute ¯gm(k, pl) for gm(k, vn), the
right-hand side of (4.29) becomes

(cid:90) vcut

(cid:90) vcut

Np(cid:88)

Np(cid:88)

¯gm(k, ρik⊥) =

where

dv⊥ v⊥J0(ρik⊥v⊥)gm(k, v⊥) =

ˆwl(ρik⊥)¯gm(k, pl),

(4.30)

0

l=1

Np(cid:88)

n=1

ˆwl(ρik⊥) =

4
v2
cut

J0(ρik⊥vn)J0(plvn)

1 (jn)J 2
J 2

1 (jl)

,

(4.31)

which is an interpolation formula for ¯gm(k, ρik⊥) using data points ¯gm(k, pn), as in Fig-
ure 4.2(b). Note the similarity of (4.31) to the discrete orthogonality relation (4.14). Indeed,
for grid points ρik⊥ = pn, we have ˆwl(ρik⊥) = δln and the sum reduces to the single term
¯gm(k, pn).

Therefore, performing the calculation on a grid in v⊥ and approximating the veloc-
ity space integral in the quasineutrality condition as a velocity space sum is equivalent to
performing the calculation on a grid in p and evaluating the integral as a sum of Hankel
modes. Moreover, the calculation on a velocity grid is more efﬁcient as it does not entail
the calculation of discrete Hankel transforms. In this thesis we perform the calculation in
Fourier–Hermite–v⊥ space, only using the discrete Hankel transform (4.12) to output data
in Hankel space.

100

Chapter 5

SPECTROGK

We now describe SPECTROGK, the code in which we implement the spectral methods
described in Chapters 3 and 4, and which we use in our study of the gyrokinetic-Maxwell
system in Chapters 6 and 7 (and the Vlasov–Poisson system in Appendix A and Ref. [145]).
We present the gyrokinetic-Maxwell system in the exact form solved by SPECTROGK
in §5.1, describe the SPECTROGK algorithm in §5.2, and verify the code and study its
performance in §5.3.

5.1 Spectral gyrokinetic-Maxwell system

SPECTROGK solves the gyrokinetic-Maxwell system using a Fourier representation for
guiding centre space and a Hermite expansion in parallel velocity space. The treatment of
perpendicular velocity space depends on the particular system being solved. For the lin-
earized system with no parallel magnetic ﬁeld perturbations, B(cid:107) = 0, SPECTROGK solves
the system spectrally using a Hankel representation in perpendicular velocity space. Both
ϕ and A(cid:107) are obtained from a single Fourier–Hankel–Hermite mode with Hankel point
p = ρsk⊥. Since there is no Hankel mode coupling, it is only necessary to evolve this
single Hankel mode for each perpendicular Fourier wavenumber. As Fourier modes also
decouple in the linearized system, this problem is in effect a one-dimensional problem
in Hermite space parameterized by k, and hence p = ρsk⊥. In practice, SPECTROGK
solves this system on a four-dimensional Fourier–Hermite grid, allowing simultaneous so-
lution for many Fourier modes. This “four-dimensional” spectral system is described in
§5.1.2. Otherwise, SPECTROGK solves the ﬁve-dimensional gyrokinetic-Maxwell system
with Fourier–Hermite modes, and a discretization of perpendicular velocity space using the
grid of scaled Bessel roots discussed in Chapter 4.

In Chapter 2, we derived the gyrokinetic-Maxwell system in wave vector k and ve-
locity (v(cid:107), v⊥) coordinates. In this Chapter, we solve the version of this system for the

101

complementary distribution function g expressed in Fourier space, which is summarized in
§2.4.2.1. The system comprises the gyrokinetic equation

∂gsk
∂t

+ ivthsv(cid:107)k(cid:107)

+

iky
2
− iky
2

(cid:9)

, gs

(cid:19)

(cid:21)

k

ωT

(cid:18)

B v2⊥ + ωn +

(cid:19)
(cid:18)
(cid:104)χs(cid:105)Rs,k F0

+(cid:8)(cid:104)χs(cid:105)Rs
(cid:1) gsk = ν (cid:104)C[hs](cid:105)Rs,k ,
(cid:88)

v2⊥ + v2(cid:107) − 3
2

(cid:20)

gsk +

qs
Ts
−2κv2(cid:107) − L−1
Ts
qs

(cid:0)2κv2(cid:107) + L−1
(cid:9)
(cid:8)(cid:104)χs(cid:105)Rs

, gs

k

B v2⊥

=

1
2

k(cid:48)

b · (k × k(cid:48))(cid:104)χs(cid:105)Rs,k(cid:48) gs,k−k(cid:48),

where the nonlinear term is

and the gyrokinetic potential is

(cid:104)χs(cid:105)Rs,k F0

(5.1)

(cid:104)χs(cid:105)Rs,k = J0(as)ϕk − vthsv(cid:107)J0(as)A(cid:107)k +
(cid:90)

(cid:88)

(1 − Γ0s) − B(cid:107)k

qsnsΓ1s =

qsns

Ts
qs

2v2⊥J1(as)

as

B(cid:107)k,

d3v gskJ0(as),

and Maxwell’s equations

ϕk

A(cid:107)k

nsq2
s
Ts

k2⊥
2βr

+

(cid:88)

s

q2
s ns
2ms

Γ0s

(cid:32)

ϕk

nsqsΓ1s + B(cid:107)k

s

(cid:88)
(cid:34)
(cid:88)

s

s

(cid:88)
(cid:88)
(cid:88)

s

(cid:35)

=

2
βr

+

(5.2)

(5.3)

(5.4a)

(5.4b)

(5.5)

(5.6)

s

(cid:90)
(cid:33)

Nm−1(cid:88)

m=0

d3v gskv(cid:107)J0(as),

qsnsvths

TsnsΓ2s

= −(cid:88)

s

s

(cid:90)

nsTs

d3v gskv2⊥

2J1(as)

as

, (5.4c)

where as = ρsk⊥v⊥, and Γ0s, Γ1s, and Γ2s are known functions of k⊥ given in (2.130).

5.1.1 Full ﬁve-dimensional system

In the general case, SPECTROGK solves the gyrokinetic-Maxwell system in Fourier–
Hermite–v⊥ space, using the representation

gsk(vn, v(cid:107), t) =

φm(v(cid:107))˘gsmk(vn, t).

where the φm are the Hermite basis functions deﬁned in (3.15),
Hm(v(cid:107)) = (−1)mev2

φm(v(cid:107)) =

(cid:107)

,

Hm(v(cid:107))
√
2mm!

−v2
(cid:107)√
e
π

(cid:16)

(cid:17)

,

−v2
e
(cid:107)

dm
dvm(cid:107)

and vn = jnvcut/jNp+1 is the nth point in the perpendicular velocity space grid, with jn
the nth root of the Bessel function J0, and vcut the velocity space cutoff, a parameter to be
chosen. For convenience, we will usually suppress the time argument t.

102

5.1.1.1 Gyrokinetic equation

Taking the Hermite transform of the gyrokinetic equation (5.1) gives

∂˘gsmk

∂t

+ Lg ˘gsmk + Lϕϕk + LAA(cid:107)k + LBB(cid:107)k + N [(cid:104)χs(cid:105)Rs

where Lg, Lϕ, LA, LB are the linear operators deﬁned by

, gs(Rs, vn, v(cid:107))] = νC[hs],
(5.7)

(cid:33)

˘gs,m−1,k

,

(5.8a)

(cid:114)m

2

(cid:19)(cid:27)

(cid:32)(cid:114) m + 1

2

δm0 +

˘gs,m+1,k +

(cid:18) δm2√

2

ky
2LT

(cid:19)

ky
2Ln

(cid:18) δm2√

+

√
ky
2Ln
2

δm1 +

√
3ky
4LT

δm3

− δm0

I1ϕk + δm0

(cid:41)

iky
2LT

I3ϕk,
(5.8b)

I1A(cid:107)k

(5.8c)

(cid:18) δm2√

2

(cid:19)(cid:27)

− δm0

2I2B(cid:107)k

δm0 +

ky
2LT

(5.8d)

Lϕϕk = i

k(cid:107)√
2

δm1 +

Lg ˘gsmk =ivthsk(cid:107)

(cid:26) qs√
(cid:40)

msTs

k(cid:107)

qs√
msTs
δm1vthsL−1

2
T I3A(cid:107)k,

+

δm0
2

LAA(cid:107)k = − ivths

√
− iky
2
2

(cid:26) qs√

LBB(cid:107)k =i

Ts
qs

ky
2Ln

k(cid:107)√
δm1 +
2
T 2I4B(cid:107)k.
L−1

msTs
Ts
qs

iky
2

+ δm0

The perpendicular velocity space dependence of the Lϕ, LA and LB operators is entirely
contained in the four coefﬁcients

I1 = J0(ρsk⊥vn)F ⊥
nJ0(ρsk⊥vn)F ⊥

I3 = v2

0 (vn),

0 (vn),

I2 =
I4 =

vn
ρsk⊥
v3
n
ρsk⊥
0 (vn) = exp(−v2

n)/π.

J1(ρsk⊥vn)F ⊥

0 (vn),

J1(ρsk⊥vn)F ⊥

0 (vn),

where the perpendicular Maxwellian is F ⊥

The nonlinear term N [(cid:104)χs(cid:105)Rs

, gs] is the Fourier–Hermite transform of (5.2), the Pois-
son bracket of the distribution function and the gyroaveraged gyrokinetic potential, dis-
cretized in perpendicular velocity space:
N [(cid:104)χs(cid:105)Rs

dv(cid:107)φm(v(cid:107))

, gs] =

(5.9)

1
2
F

−∞

(cid:90) ∞
(cid:34)
F−1(cid:16)
− F−1(cid:16)

kx (cid:104)χs(cid:105)Rs,k

ky (cid:104)χs(cid:105)Rs,k

(cid:32)
(cid:17)F−1
(cid:17)F−1

Nm−1(cid:88)
Nm−1(cid:88)

m(cid:48)=0

kx

ky

(cid:32)

m(cid:48)=0

103

(cid:33)

˘gsm(cid:48)k(vn)φm(cid:48)(v(cid:107))

(5.10)

(cid:33)(cid:35)

˘gsm(cid:48)k(vn)φm(cid:48)(v(cid:107))

.

Here F denotes the three-dimensional discrete Fourier transform, and we have inserted
the Hermite expansion of the distribution function. We may decompose N [(cid:104)χs(cid:105)Rs
, gs] =
Nϕ + NA + NB, where Nϕ, NA and NB correspond to the ϕ, A(cid:107) and B(cid:107) terms in χs (5.3).
These represent the E × B drift, particle streaming along the perturbed magnetic ﬁeld,
and the gradient-B drift respectively. The velocity enters these three terms via factors of
J0(as), v(cid:107)J0(as), and v⊥J1(as) respectively multiplying ˘gsmk. The parallel velocity integral
in (5.10) can thus be calculated analytically. Inserting (cid:104)χs(cid:105)Rs,k into (5.10) and performing
the integrals then gives

Nϕ =

F

1
2

F−1 (kxJ0(ρsk⊥vn)ϕk)F−1 (ky ˘gsmk(vn))

− F−1 (kyJ0(ρsk⊥vn)ϕk)F−1 (kx˘gsmk(vn))

(cid:35)

,

(5.11a)

(cid:34)

(cid:34)

NA = −1
2

vthsF

NB =

Ts
qs

F

F−1

F−1 (ky ˘gsmk(vn))

(cid:19)

B(cid:107)k

F−1 (kx˘gsmk(vn))

(cid:35)

,

(5.11c)

so that we obtain moments ˘gm in the terms proportional to ϕ and B(cid:107), and the moments
˘gm−1 and ˘gm+1 via Hermite mode coupling (3.20) in the term proportional to A(cid:107).

5.1.1.2 Maxwell’s equations

Integrals in the ﬁeld solve (5.4) are evaluated by replacing(cid:82) dv⊥ v⊥ . . . with(cid:80)Np

n=1 wn . . .,

yielding

(cid:88)

s

ϕk

(1 − Γ0s) − B(cid:107)k

nsq2
s
Ts

(cid:88)

s

qsnsΓ1s = 2π

(cid:88)

s

qsns

Np(cid:88)

n=1

104

wnJ0(ρsk⊥vn)˘gs,0,k(vn),

(5.12a)

˘gs,m+1,k(vn) +

(cid:1)

ky

F−1

F−1(cid:0)kxJ0(ρsk⊥vn)A(cid:107)k
(cid:32)
(cid:32)(cid:114)m + 1
− F−1(cid:0)kyJ0(ρsk⊥vn)A(cid:107)k
(cid:1)
(cid:32)
(cid:32)(cid:114) m + 1
(cid:34)
(cid:18) kxvnJ1(ρsk⊥vn)

F−1

kx

2

˘gs,m+1,k(vn) +

2

(cid:19)
(cid:18) kyvnJ1(ρsk⊥vn)

B(cid:107)k

k(cid:48)

k(cid:48)

− F−1

˘gs,m−1,k(vn)

(cid:33)(cid:33)
(cid:33)(cid:33)(cid:35)

˘gs,m−1,k(vn)

,

(cid:114) m
(cid:114)m

2

2

(5.11b)

(cid:34)

(cid:88)

s

k2⊥
2βr

+

(cid:35)

√

2π

=

q2
s ns
2ms

Γ0s

(cid:32)

(cid:88)

s

2
βr

+

A(cid:107)k

(cid:88)

s

ϕk

nsqsΓ1s + B(cid:107)k

TsnsΓ2s

Np(cid:88)

n=1

(cid:88)

s

qsnsvths

(cid:33)

wnJ0(ρsk⊥vn)˘gs,1,k(vn),

(5.12b)

(cid:88)

s

Np(cid:88)

n=1

wnvn

2J1(ρsk⊥vn)

ρsk⊥

˘gs,0,k(vn),

(5.12c)

= −2π

nsTs

where Γ0s = I0(bs)e−bs, Γ1s = (I0(bs) − I1(bs))e−bs, and Γ2s = 2Γ1(bs) with bs =
(ρsk⊥)2/2.

5.1.2 Reduced four-dimensional system

The calculation of ϕ and A(cid:107) from Maxwell’s equations (5.4) only requires the Hankel
mode p = ρsk⊥, so we may neglect all other Hankel modes if the gyrokinetic equation
for ¯g(p = ρsk⊥) evolves independently of other modes. Taking the Hankel transform of
(5.7), shows that Hankel mode coupling only occurs in the nonlinear term. This is because
whenever g appears in linear terms, it is not multiplied by a function of v⊥, so we may use
the orthogonality of Bessel functions (4.8); however, when g appears in the nonlinear term,
it is multiplied by a function of v⊥ and we may no longer use orthogonality. Therefore in
linear simulations with B(cid:107) = 0, SPECTROGK does not initialize a p-space grid, but instead
evolves ¯g(p = ρsk⊥) only for each (k, m) grid point. Formally, this is equivalent to taking
the continuous Hankel transform of (5.1) at p = ρsk⊥ while using the Ansatz

Nm−1(cid:88)

(cid:90) ∞

gsk(v⊥, v(cid:107), t) =

φm(v(cid:107))

dp pJ0 (pv⊥) ¯gsmk(p, t),

(5.13)

m=0

0

and only solving for ¯gsmk(p = ρsk⊥, t). The electromagnetic ﬁelds are found from (5.4)
by evaluating the zeroth and ﬁrst Hermite coefﬁcients. The Fourier modes also decouple
in both the gyrokinetic equation and the ﬁeld solve, so that the system is effectively one-
dimensional in Hermite space and parametrized by k.

This method does not ﬁnd the whole distribution function ¯gsmk(p, t), but only the part
needed to ﬁnd the electromagnetic ﬁelds. However, it is exact, and valid for generic initial
conditions that have been projected onto p = ρsk⊥. In this case SPECTROGK is signiﬁ-
cantly faster than ASTROGK due to the reduced dimensionality and reduced inter-processor
communication.

105

5.1.2.1 Gyrokinetic equation

Taking the Hankel–Hermite transform of the linearized gyrokinetic equation (5.1) we ob-
tain

∂¯gsmk

+ Lg ¯gsmk + Lϕϕk + LAA(cid:107)k + LBB(cid:107)k = νC[hs],

where Lg, Lϕ, LA, LB are the linear operators (5.8), but now with coefﬁcients
I1 =
I2 =

dv⊥ v⊥J0(k(cid:48)v⊥)2e−v2

−k(cid:48)2

1
2π

⊥ =

exp

I0

2

2

⊥

,

0

(cid:19)

(cid:18) k(cid:48)2

(cid:19)

0

∂t

exp

(cid:18) k(cid:48)2

(cid:90) ∞
(cid:90) ∞
(cid:18)
dv⊥ v2⊥J0(k(cid:48)v⊥)J1(k(cid:48)v⊥)e−v2
−k(cid:48)2
(cid:90) ∞
(cid:18)
dv⊥ v3⊥J0(k(cid:48)v⊥)2e−v2
1 − k(cid:48)2
−k(cid:48)2
(cid:90) ∞
2
(cid:18)
dv⊥ v4⊥J0(k(cid:48)v⊥)J1(k(cid:48)v⊥)e−v2
−k(cid:48)2

(cid:18)
(cid:19)(cid:21)
(cid:18) k(cid:48)2
(cid:19)
(cid:18) k(cid:48)2
(cid:19)
(cid:18) k(cid:48)2

(cid:19)(cid:20)
(cid:19)(cid:20)(cid:18)
(cid:19)(cid:20)(cid:18)

(cid:19)
(cid:19)
(cid:19)

1 − 3k(cid:48)2

− I1

exp

exp

I0

I0

2

2

2

2

2

⊥

⊥

0

0

+

I0

1
π
1
πk(cid:48)
1
4π
1
π
1
2π
1
πk(cid:48)
1
2π

2

2

8

,

=

I3 =

=

I4 =

=

k(cid:48)2
2

I1

(cid:18) k(cid:48)2
(cid:18) k(cid:48)2

2

− 1

(cid:19)(cid:21)
(cid:19)

I1

,

2

+

(5.14)

(5.15a)

(5.15b)

(5.15c)

(cid:18) k(cid:48)2

(cid:19)

2

− k(cid:48)2

8

I2

(cid:18) k(cid:48)2

(cid:19)(cid:21)

,

2
(5.15d)

where k(cid:48) = ρsk⊥. Integrals I1 and I3 appear in [162], while I2 and I4 are given by

∂I1
∂k(cid:48) ,

I4 = − 1
k(cid:48)

∂I3
∂k(cid:48) .

(5.16)

I2 = − 1
k(cid:48)

5.1.2.2 Maxwell’s equations

The ﬁrst two moments of g, (5.4a,b) are single Hankel–Hermite modes, so that the quasi-
neutrality condition and the parallel Amp`ere’s law become

(1 − Γ0s) − B(cid:107)k

qsnsΓ1s = 2π

qsns¯gs,0,k(p = ρsk⊥),

(5.17a)

k2⊥
2βr

+

q2
s ns
2ms

Γ0s

=

qsnsvths¯gs,1,k(p = ρsk⊥),

(5.17b)

which determine ϕ and A(cid:107) when B(cid:107) = 0.

We note also that the second moment of g (5.4c) is the derivative with respect to p of a

single mode, so the perpendicular Amp`ere’s law is

(cid:12)(cid:12)(cid:12)(cid:12)p=ρsk⊥

nsTs
ρsk⊥

∂¯gs,0,k

∂p

.

(5.17c)

(cid:88)

s

ϕk

nsq2
s
Ts

(cid:34)

A(cid:107)k

(cid:88)

s

ϕk

nsqsΓ1s + B(cid:107)k

(cid:88)

s

(cid:35)

(cid:88)

s

(cid:32)

(cid:88)

2
βr

+

(cid:88)
(cid:88)

s

s

(cid:88)

√

2π

(cid:33)

TsnsΓ2s

= 4π

s

s

106

Thus the four-dimensional method may be extended to include cases where B(cid:107) (cid:54)= 0 by also
evolving ∂¯gsmk/∂p|p=ρsk⊥
via the derivative with respect to p of the Hankel-transformed

gyrokinetic equation.

5.2 Algorithm description
We now discuss details of the SPECTROGK algorithm. For both cases described in §5.1,
the gyrokinetic equation may be written schematically as

= A [a] ,

da
dt

(5.18)

where a denotes the set of expansion coefﬁcients. Given an algorithm for forming the
right-hand side, we use the third-order Adams–Bashforth scheme described in §5.2.2 to
advance the coefﬁcients in time. To form A, we must determine the electromagnetic ﬁeld,
calculate the nonlinear term, and control the growth of ﬁne scales in physical and velocity
space due to the nonlinear term and particle streaming respectively. These are discussed
in §§5.2.3–5.2.5. We describe the parallelization and communication patterns of the code
in §5.2.6. But ﬁrst we give a brief overview of ASTROGK, the code which is the starting
point for SPECTROGK development.

5.2.1 ASTROGK

ASTROGK is a slab gyrokinetics code, implemented as a simpliﬁed version of the tokamak
gyrokinetics code GS2 that neglects effects due to toroidal geometry. Both ASTROGK
and GS2 are publicly available and widely used [57]; ASTROGK (which is documented
in [56]) is used to study astrophysical plasmas [e.g. 155, 163, 164] while GS2 is used for
tokamak plasmas [e.g. 62, 165].

s = hs−(qsF0s/Ts)(cid:104)ϕ − v⊥ · A⊥(cid:105)Rs

ASTROGK solves the gyrokinetic-Maxwell system (2.102)–(2.106), using the modiﬁed
, rather than
complementary distribution function gAGK
gs = hs − (qsF0s/Ts)(cid:104)χs(cid:105)Rs
(2.117) as used in SPECTROGK. It uses a Fourier representa-
tion for perpendicular space, and a discretization on a uniform grid in parallel space. The
latter is inherited from GS2’s toroidal geometry, and has no particular merit in a slab code.
The parallel spatial derivatives in the streaming term (v(cid:107)∂zg) and the electrostatic response
(F0s∂zϕ) are evaluated by an upwinding compact ﬁnite difference scheme.
In velocity
space, ASTROGK discretizes on grids in energy E = v2⊥ + v2(cid:107) and pitch angle λ = v2⊥/E,
with a separate variable for sign of parallel velocity σ = v(cid:107)/|v(cid:107)|. A grid of Gauss–Legendre
quadrature points is used for pitch angles, while a composite grid of Gauss–Laguerre and

107

Gauss–Legendre quadrature points is used for energy. This grid yields spectral convergence
for the integrals used to determine the electromagnetic ﬁeld from Maxwell’s equations (see
[56], §3.1 and §4.3). Splitting the integral range in two allows for changes of variables
which remove singularities in the integrand at E = 0 and E = ∞.

The nonlinear term is calculated pseudospectrally as in §4.4.1, replacing the convolu-
tion in k⊥ with the product of inverse Fourier transforms. This is efﬁcient as the nonlinear
term is otherwise local in the remaining coordinates z, v⊥ =
σ.

λE, v(cid:107) =(cid:112)(1 − λ)E and

√

For time integration, ASTROGK separates the operator A in (5.18) into linear and non-
linear parts, ﬁnding the evolution of the distribution function due to each part separately.
The nonlinear part is integrated using the explicit third-order Adams–Bashforth, as dis-
cussed in §5.2.2. The linear part is integrated using KOTSCHENREUTHER ET AL.’s (1995)
implicit Green’s function method (described in [56], §3.3.1)

ASTROGK is implemented in Fortran 90 with parallelization achieved using MPI. A
copy of the three-dimensional electromagnetic ﬁeld is kept on each processor, while the
ﬁve-dimensional distribution function is divided between processors. The distribution func-
tion is stored as a three-dimensional array with the ﬁrst two dimensions holding parallel
space z and the sign of parallel velocity σ respectively. The remaining coordinates are
concatenated in the ﬁnal dimension. The order of this ﬁnal dimension is determined by a
“layout” input parameter, a ﬁve-character string comprising l (pitch angle, λ), e (energy
E), x and y (perpendicular wavenumbers kx, ky) and s (species s). The parallelization is
over the ﬁnal dimension so that ﬁnite differences in z are always local to each processor,
as are the operations on the same |v(cid:107)|. Generically, all other operations are distributed.
However, by carefully choosing layout and resolution, one can arrange for some operations
to be local. For example, with the layout lexys, velocity space may be made local to each
processor by choosing NxNyNs to be divisible by the number of processors Nproc. Then
the sums approximating the velocity space integrals in the ﬁeld solve become local, and the
electromagnetic ﬁeld is calculated with no inter-processor communication. Similarly with
xyles, choosing NλNENs to be divisible by Nproc ensures that Fourier space is local, and
therefore Fourier transforms are calculated without inter-processor communication.

SPECTROGK is also written in Fortran 90 and reuses the code base of ASTROGK
so far as possible. It inherits memory management and communication in perpendicular
Fourier transforms, but is otherwise rewritten for Hankel, Hermite, and parallel Fourier
space. SPECTROGK is however compatible with ASTROGK (and GS2), using the same
input parameter names (meaning Fortran namelist input ﬁles are transferable), and the same
compilation procedures and Makeﬁles.

108

5.2.2 Time integration

SPECTROGK computes the approximate solution of (5.18) using the explicit third-order
Adams–Bashforth scheme

(cid:18)23

12

A(cid:2)ai(cid:3) − 4

A(cid:2)ai−1(cid:3) +

3

A(cid:2)ai−2(cid:3)(cid:19)

5
12

ai+1 = ai + ∆t

,

(5.19)

where ai denotes the expansion coefﬁcients at the ith time level, and ∆t is the timestep.
SPECTROGK also implements a variable time-spacing version of this formula that allows
the timestep to change during execution. In nonlinear runs, the size of the timestep is varied
automatically to satisfy the CFL condition for the nonlinear drift velocity vNL
D , exactly as
in ASTROGK. In every iteration the timestep ∆t is made to satisfy

(cid:32)

(cid:33)

∆t ≤ CCFL min

∆x

max vNL
Dx

,

∆y

max vNL
Dy

,

(5.20)

where ∆x = 2π/kx,max, ∆y = 2π/ky,max, and CCFL ≤ 1 is an input parameter.

The Adams–Bashforth scheme (5.19) is stable and accurate for non-dissipative wave
phenomena, with third-order accuracy in amplitude and wave speed. It is well-suited to
problems like ours where the calculation of A dominates the computation work. DUR-
RAN [167, 168] deﬁnes the “efﬁciency factor” of a numerical integration scheme to be the
maximum stable timestep for an oscillatory test problem divided by the number of evalua-
tions of A per timestep. By this measure Adams–Bashforth is the most efﬁcient third-order
scheme. While it has a smaller stable timestep than other schemes such as the Runge–Kutta
family, it only requires one A evaluation per timestep.

The main disadvantage of the third-order Adams–Bashforth scheme is that it requires
the two previous values ai−1 and ai−2 to advance from ai to ai+1. We must amend the
scheme for the ﬁrst and second timesteps, for which fewer previous values are available. We
use the explicit Euler method for the ﬁrst timestep, and the second-order Adams–Bashforth
method, which requires only one previous value, for the second timestep.

In principle, this reduces the global time accuracy to only second order, since the ﬁrst
Euler timestep alone contributes an O(∆t2) global error. However, for typical simula-
tion parameters and initial conditions, this error is in fact smaller than the error accu-
mulated over the subsequent third-order Adams–Bashforth timesteps (see [145]/Appendix
A). The fastest timescales in the system arises from parallel streaming with frequencies

ω = k(cid:112)m/2. Let ω0 be the typical frequency of the modes that are nonzero in the initial

conditions, ωtyp a typical frequency for the dominant modes in the subsequent evolution,

109

(cid:112)mmax/2 the highest frequency present in the simulation. The accumu-

and ωmax = kmax
lated amplitude error after a time T is then

E =

T
∆t

3
8

(ωtyp∆t)4 +

1
4

(ω0∆t)3 +

1
2

(ω0∆t)2,

(5.21)

using the amplitude errors for the explicit Euler and Adams–Bashforth methods [168, Table
2.2].

The maximum stable timestep is ∆t = α/ωmax, with α ≈ 0.723 for the third order
Adams–Bashforth method [168]. The error after n characteristic times (T = n/ωtyp) using
this timestep is thus
3
8

1
(5.22)
2
0ωmax)1/3n−1/3. The error due
which is dominated by the ﬁrst term whenever ωtyp > (ω2
to the ﬁrst explicit Euler timestep is thus negligible if the initial conditions contain only
slowly evolving modes (as do ours) and the system is not heavily over-resolved so that ωtyp
is not small compared with ωmax in the sense made precise by the previous inequality.

nα3(ωtyp/ωmax)3 +

α3(ω0/ωmax)3 +

α2(ω0/ωmax)2,

E =

1
4

In SPECTROGK, we use the Adams–Bashforth scheme for all terms on the right-hand
side of the gyrokinetic equation. It would be possible to implement an implicit scheme
for the linear parts of the gyrokinetic equation, such as Kotschenreuther’s Green’s function
method [166] that is used in ASTROGK. This allows larger timesteps at the cost of higher
complexity. However we favour an explicit approach so that we may exploit phase space
locality and reduced dimensionality in the linear Fourier–Hermite–Hankel system. In the
nonlinear case, the nonlinear term must be treated explicitly, so that the timestep is limited
by the CFL condition. In this case it is preferable to use an explicit timestepping algorithm
for the linear terms too, as an implicit method gives an increase in complexity without an
increase in the timestep.

5.2.3 Calculation of the electromagnetic ﬁeld
In order to form the operator A, we need to calculate the quantities ϕ, A(cid:107) and B(cid:107) that
determine the electromagnetic ﬁeld. For each wave vector k, Maxwell’s equations, (5.12)

or (5.17), may be written asc1

0
c3
0

c2
0
c5

0
c4

 ϕ

 =

A(cid:107)
B(cid:107)

 ,

d1

d2
d3

(5.23)

where the ﬁrst row is the quasineutrality condition, and the second and third rows are the
parallel and perpendicular components of Amp`ere’s law respectively. In the general ﬁve-
dimensional version of the code, the coefﬁcients d1, d2, d3 are proportional to coefﬁcients

110

Coef.

c1

c2

c3

c4

c5

d1

d2

d3

2π(cid:80)
2π(cid:80)
−2π(cid:80)

√

(cid:80)Np
(cid:80)Np
(cid:80)Np

5D (5.12)

4D (5.17)

s nsq2

(cid:80)
−(cid:80)
k2⊥/(2βr) +(cid:80)
(cid:80)
2/βr +(cid:80)

s (1 − Γ0s)/Ts
s nsqsΓ1s

s q2

s nsΓ0s/(2ms)

s nsqsΓ1s

s nsTsΓ2s

s qsns

n=1 wnJ0(ρsk⊥vn)gs0(k, vn)

s qsns¯gs0(k, p = ρsk⊥)

s qsnsvths

n=1 wnJ0(ρsk⊥vn)gs1(k, vn)

s qsnsvths¯gs1(k, p = ρsk⊥)

s nsTs

n=1 wnvn

2J1(ρsk⊥vn)

ρsk⊥

gs0(k, vn)

s

nsTs
ρsk⊥

∂¯gs0
∂p

2π(cid:80)
2π(cid:80)
4π(cid:80)

√

(cid:12)(cid:12)(cid:12)p=ρsk⊥

Table 5.1: Coefﬁcients in the ﬁeld solve (5.23) for the multispecies case.

of single Fourier–Hermite modes summed over perpendicular velocities (see 5.12). In the
four-dimensional version, the coefﬁcients d1, d2, d3 are proportional to coefﬁcients of a
single Fourier–Hermite–Hankel mode (5.17). The coefﬁcients c1, c2, c3, c4 and c5 are
known constants which are the same in the four- and ﬁve-dimensional versions of the code.
For reference, these constants are tabulated in Table 5.1 for the multispecies case, and in
Table 5.2 for a single ion species with adiabatic electrons.

Thus the electromagnetic ﬁeld variables are calculated at every Fourier wavenumber

using

ϕ = (c5d1 − c2d3)/(c1c5 − c2c4),
A(cid:107) = d2/c3,
B(cid:107) = (c4d1 − c1d3)/(c1c5 − c2c4).

In electrostatic simulations we only solve the quasineutrality condition,

ϕ = d1/c1,

(5.24)
(5.25)
(5.26)

(5.27)

and neglect Amp`ere’s law.

In order to perform these calculations, we must evaluate d1, d2 and d3 from the dis-
tribution function, which in general requires inter-processor communication. The four-
dimensional case is simple. At every Fourier wavenumber k, the ﬁeld is calculated on the

111

Coef.

5D (5.12)

4D (5.17)

c1

c2

c3

c4

c5

d1

d2

d3

(cid:80)Np
(cid:80)Np
(cid:80)Np

2πqini

√
2πqinivthi
−2πniTi

i (1 + Ti/Te − Γ0i)/Ti

niq2

−niqiΓ1i

0

niqiΓ1i

2/βr + niTiΓ2i

√

n=1 wnJ0(ρsk⊥vn)gi0(k, vn)

2πqini¯gi0(k, p = ρsk⊥)

n=1 wnJ0(ρsk⊥vn)gi1(k, vn)

2πqinivthi¯gi1(k, p = ρsk⊥)

n=1 wnvn

2J1(ρsk⊥vn)

ρsk⊥

gi0(k, vn)

4π niTi
ρsk⊥

∂¯gi0
∂p

(cid:12)(cid:12)(cid:12)p=ρsk⊥

Table 5.2: Coefﬁcients in the ﬁeld solve (5.23) for a single ion species with adiabatic
electrons.

processor which holds the point (k, m = 0, p = ρsk⊥); this requires no communication.1
Each processor sets the electromagnetic ﬁelds to zero, except for at the points which that
processor calculated. The ﬁelds are then broadcast to all processors via an MPI “sum all
reduce” operation.

The ﬁve-dimensional case is similar, only now a sum over perpendicular velocity is
required. The electromagnetic ﬁeld is calculated by the processor which holds the point
(k, m = 0, p = v1). Processors with other velocities at the Fourier–Hermite mode (k, m =
0) send their contribution to the sums in d1, d2, d3 to that processor. Once calculated, the
electromagnetic ﬁeld is broadcast to all processors as in the four-dimensional case.

5.2.4 Nonlinear term and dealiasing
As described in §5.1.1.1 we calculate the nonlinear term (5.10) using fast Fourier trans-
forms to convert between expansion coefﬁcients at a discrete set of wavenumbers and func-
tion values at a uniformly spaced set of collocation points. We use the FFTW library [169]
which implements unnormalized discrete Fourier transforms, i.e. in one dimension the pair
1The Hermite modes m = 0 and m = 1 are always on the same processor for a given (k, vn); see §5.2.6.

112

of operators

Nz−1(cid:88)

l=0

Fjl =

e−ikj zl,

F−1
ln =

Nz−1(cid:88)

n=0

eiknzl,

(5.28)

with wavenumbers kn = 2πn/Lz and grid points zl = lLz/Nz, as in §2.4.2.

This pseudospectral approach reduces the cost of computing the nonlinear term to
O(NV NX log NX) instead of O(NV N 2
X), where NX = NxNyNz is the total spatial res-
olution and NV = NmNp is the total velocity resolution. However, it creates a source of
error due to aliasing between different wavenumbers. The product of two truncated Fourier
series that occurs in the nonlinear term (5.10) contains terms involving ei(kn+kn(cid:48) )zl. How-
ever, only terms with |kn + kn(cid:48)| ≤ kNz can be represented on the collocation grid. The
remaining terms are omitted from the original convolution (5.2), but on the collocation
points zl they are indistinguishable from Fourier modes with wavenumbers kn + kn(cid:48) ∓ kNz.
This aliasing of wavenumbers outside the truncation onto retained wavenumbers creates
errors in the coefﬁcients of the retained wavenumbers. It may be removed by setting the
coefﬁcients for the highest third of wavenumbers to zero before the nonlinear term is cal-
culated [100, 170]. This “two-thirds rule” removes all spurious contributions from aliasing
for quadratic nonlinearities, such as the Fourier convolution (5.2). All wavenumbers with
|kn + kn(cid:48)| > kNz now map onto wavenumbers that are eliminated by the ﬁlter.

The abrupt transition from unmodiﬁed Fourier coefﬁcients to those that are set to zero
acts like a reﬂecting boundary condition for the typical Kolmogorov-like nonlinear cas-
cade of disturbances towards larger wavenumbers. This will distort the higher resolved
wavenumbers unless their Fourier coefﬁcients are already negligible at the two-thirds rule
cut-off point. In ASTROGK, this is ensured by applying hyperviscosity in the perpendicular
Fourier directions. In its simplest form, hyperviscosity is the term

−νhypervisc(k2⊥/k2⊥max)4gm(k, v⊥),

(5.29)

added to the right-hand side of (5.7). Other viscosity models, such as one based on the
nonlinear Smagorinsky eddy viscosity [171], are also implemented in ASTROGK. As the
perpendicular hyperviscosity implementation is closely related to the distributed perpen-
dicular Fourier transform, this routine is inherited by SPECTROGK.

In parallel Fourier space (which is a new implementation) we employ the smooth non-
reﬂecting cut-off provided by the HOU & LI [144] ﬁlter that multiplies the expansion co-
efﬁcients by

exp(cid:0)−36(|k(cid:107)|/k(cid:107)max)36(cid:1) ,

113

(5.30)

at each timestep. This ﬁlter is highly selective in wavenumber space, yet it provides suf-
ﬁcient dissipation to replace both the two-thirds rule dealiasing, and the parallel hypervis-
cous dissipation usually employed to prevent an accumulation of free energy at the ﬁnest
resolved scales. For the same resolution, this smooths the distribution while keeping 12–
15% more modes than the 2/3 aliasing rule [144].

5.2.5 Recurrence and velocity space dissipation

As shown in Chapter 3, the shear in phase space due to the particle streaming term v(cid:107)∂zg
tends to form ﬁne scale structures in velocity space, which, for any discretization of velocity
space, become unresolvable after some ﬁnite, resolution-dependent time. The v(cid:107)∂zg term
creates the linear coupling between coefﬁcients with adjacent m values in the gyrokinetic
equation. We showed in Chapter 3 that this coupling may be interpreted as a propagation
of disturbances towards larger m values that continues until they encounter the truncation
condition gNm = 0. As with the two-thirds rule mentioned above, this condition appears
as a reﬂecting boundary condition that creates disturbances propagating in the reverse di-
rection towards low m values. Disturbances eventually reach m = 0 to create a spurious
increase in the amplitude of the electric ﬁeld, a phenomenon known as recurrence [80].

The recurrence may be suppressed using collision terms on the right hand side of the
gyrokinetic equation, chosen to ensure that the coefﬁcients reach negligibly small values
before m reaches Nm. Various collision operators are implemented in SPECTROGK: the
LENARD & BERNSTEIN [70] and KIRKWOOD [138] collision operators

(5.31)
(5.32)
(where I{m≥3} denotes the indicator function) which were discussed in §3.2.2 and §3.2.3,
and the Kirkwood hypercollisional operator

CLB[g] = −νmg,
CK[g] = −νmI{m≥3}g,

K [g] = −ν(m/Nm)αI{m≥3}g,
C H

(5.33)
which was discussed in §3.2.4. In these, ν and α are input parameters. In addition, the
velocity-space analogue of the HOU–LI (2007) ﬁlter

exp(cid:0)−36(m/(Nm − 1))36(cid:1)

(5.34)

is also implemented. We discuss this ﬁlter in Appendix A/Ref. [145].

Each of these operators is trivial to apply as all are known functions of m multiply-
ing the distribution function expansion coefﬁcients. Thus no communication and minimal
computation are required.

114

5.2.6 Data layout and parallelization scheme

In SPECTROGK the distribution function g has size NxNyNzNmNpNs and the electromag-
netic ﬁeld variables ϕ, A(cid:107), and B(cid:107) have size NxNyNz. A copy of these scalars is kept on
each processor, while the much larger distribution function is divided between processors.
SPECTROGK inherits its data layout from ASTROGK which is described in §5.2.1 and Ref.
[56, §3.4]. Recall that the distribution is stored in a three dimensional array. The ﬁrst two
dimensions correspond to the parallel space coordinate z and the sign of parallel velocity
respectively. The remaining coordinates are concatenated in the third dimension. The ar-
ray is distributed by keeping the ﬁrst two dimensions local, but splitting the third between
processors.

For compatibility, SPECTROGK also uses the ﬁrst dimension for the parallel space
dependence. In the two elements of the second dimension it stores pairs of Hermite modes.
This minimizes communication in the particle streaming term as a Hermite mode is always
on processor with at least one neighbour. This is also convenient for the ﬁeld solve, as
the array containing the two necessary Hermite modes m = 0 and m = 1 is referenced
by a single index. A reference to these Hermite pairs is stored in the third dimension
concatenated with Hankel and perpendicular Fourier modes.2

In SPECTROGK coordinates, there are three terms which potentially require inter-
processor communication. Firstly, the linear operator Lg (5.8a) requires neighbouring
Hermite modes for streaming. Secondly, the perpendicular velocity space integrals in
Maxwell’s equations require sums over all Hankel modes, or over all perpendicular ve-
locity grid points. Finally, the Hankel transforms and perpendicular Fourier transforms in
the nonlinear term require sums across kx, ky, and p.

In linear runs, there is no communication across Fourier space and the most efﬁcient
layouts are where the Hermite mode is most local. If velocity space is made entirely local
by making the number of Hermite mode pairs to be divisible by the number of processors,
i.e., by choosing Nm/(2Nproc) ∈ Z, then SPECTROGK recognizes this and performs all
calculations locally.

In nonlinear runs there is a compromise between keeping velocity space local, which
is best for the ﬁeld solve and linear terms, and keeping physical space local, which is most
efﬁcient for the Fourier transforms in the nonlinear term. In our experience, it is usually

2Using ASTROGK layout terminology, SPECTROGK uses the energy coordinate e to reference the Hankel
mode and the lambda index l to reference Hermite pairs. Thus if sgn=0,1 gives the index of the second
array, the mth Hermite mode satisﬁes m = sgn+2l. As in ASTROGK, x, y and z refer to spatial coordinates
and s labels the species.

115

most efﬁcient to perform the Fourier transforms locally, i.e. to choose parameters such that
NmNp/(2Nproc) ∈ Z.

5.3 Code veriﬁcation

SPECTROGK and ASTROGK both solve the gyrokinetic-Maxwell system (2.102)–(2.106),
but discretize using different coordinates; therefore we expect agreement between the codes
in the limit of inﬁnite resolution. The change from ASTROGK’s grid in z to SPECTROGK’s
Fourier wavenumbers is straightforward, with the difference being that SPECTROGK cap-
tures resolved Fourier modes exactly, while ASTROGK suffers ﬁnite-differencing errors.
We therefore focus on velocity space behaviour. We repeat some of the linear and nonlinear
tests used in Ref. [56] to test ASTROGK. This both veriﬁes SPECTROGK and helps deter-
mine optimal parameters, particularly for the Hankel space representation which contains
the undetermined velocity space cutoff vcut.

5.3.1 Linear ITG

We ﬁrst compare the growth rate for the electrostatic ion temperature gradient instabil-
ity obtained from a SPECTROGK initial value problem to the value given by the disper-
sion relation. This is a case where SPECTROGK can run in four dimensions. The four-
dimensional code is exact in Fourier–Hankel space (with solutions parameterized by the
Fourier wavenumber k, p = ρsk⊥), so this is a test solely of the Hermite space discretiza-
tion. We also repeat the test with the ﬁve-dimensional code to verify that version’s treatment
of the linear terms.

The linear electrostatic dispersion relation is found via Landau’s Laplace transform
method, analogous to that described in Chapter 3. We take the Laplace transform in time
of (2.139) with transform variable ˆp and with LA = LB = N = 0. We then divide by ˆp +
0 dv⊥ v⊥J0(ρsk⊥v⊥), and use the quasineutrality

ivthsv(cid:107)k(cid:107), apply the operator(cid:82) ∞

condition (2.140) to obtain the dispersion relation

(cid:18)

niq2
i
Ti

1 +

− Γ0i

Ti
Te

+

ky

2vthik(cid:107)

(cid:19)

−∞ dv(cid:107)(cid:82) ∞
(cid:34)

(cid:26)(cid:18)

= −qini

qi
Ti
ωn − 3
2

(cid:19)

(1 + ˜ωZ(˜ω))I1(ρik⊥) +

Z(˜ω)I3(ρik⊥)

kyωT
2vthik(cid:107)

(cid:27)

(cid:35)

ωT

Z(˜ω) + ωT Z(˜ω) + ˜ωZ(˜ω)

I1(ρik⊥)

,

(5.35)

where ˜ω = ω/(vthik(cid:107)) with ω the complex frequency of the solution in the long-time limit,
and I1 and I3 are given by (5.15a) and (5.15c). The parallel velocity integral leads to

116

factors of the plasma dispersion function Z(ω) = π−1/2(cid:82) dv(cid:107) e

(cid:107)/(v(cid:107) − ω), as in (3.7).
−v2
We solve (5.35) numerically for ω(k) and compare the result to that from an initial value
problem with the four-dimensional code. This is a test for the Hermite representation as
the k and p dependence is treated exactly.

We can also derive a dispersion relation mimicking the ﬁve-dimensional code. We sup-
pose the distribution function is only known on v⊥-grid points, so that rather than taking the
continuous Hankel transform and using the quasineutrality condition (2.140), we take the
n=1 wnJ0(ρik⊥vn) and use the discrete quasineutrality condi-

discrete Hankel transform(cid:80)Np

tion (5.12a). With this approach, we obtain

niq2
i
Ti

1 +

Ti
Te

= −qini

qi
Ti

(1 + ˜ωZ(˜ω))

wkJ 2

0 (ρik⊥vn)F ⊥

0 (vn)

ωT

Z(˜ω) + ωT Z(˜ω) + ˜ωZ(˜ω)

wkJ 2

0 (ρik⊥vn)F ⊥

0 (vn)

(cid:18)

(cid:19)

− Γ0i

(cid:26)(cid:18)

(cid:34)

(cid:19)

+

+

ky

2vthik(cid:107)

kyωT
2vthik(cid:107)

ωn − 3
2

Np(cid:88)

n=1

Z(˜ω)

wkv2

nJ 2

0 (ρik⊥vn)F ⊥

0 (vn)

Np(cid:88)

n=1

(cid:35)

(cid:27) Np(cid:88)

n=1

,

(5.36)
which is the same as the exact dispersion relation (5.35) but with I1 and I3 approximated
as sums. Therefore the linear behaviour in Hankel space is captured if the quadrature rule
suitably approximates the integral I1 and I3. We therefore use these functions to quantify
the accuracy in §5.3.1.2.

5.3.1.1 Four-dimensional ITG

In Figure 5.1 we plot the linear frequency and growth rate obtained from a four-dimensional
initial value problem against k(cid:107) for a range of temperature gradients with (kxρi, kyρi) =
(0, 1) and T0e = T0i. The initial value problem gives perfect mode-by-mode agreement
with the dispersion relation for kx, ky, k(cid:107) with as few as 12 Hermite modes. Importantly,
SPECTROGK also captures Landau damping due to the hypercollision operator developed
in Chapter 3, exactly matching the negative growth rates in the right-hand plot.

5.3.1.2 Five-dimensional ITG

The four-dimensional linear calculation does not solve for the perpendicular velocity struc-
ture. The method only ﬁnds the amplitude of the single Hankel mode ¯g(p = ρsk⊥) that is
required to determine the electrostatic potential, while the v⊥ structure depends on the su-
perposition of all modes ¯g(p). We therefore perform ﬁve-dimensional linear calculations to

117

(a)

(b)

Figure 5.1: The dispersion relation for the linear slab ITG instability. The marks show
values calculated by SPECTROGK for (a) the frequency and (b) the growth rate against
parallel wavenumber, with lines showing the exact dispersion relation. These plots are
the same as the ASTROGK results in NUMATA ET AL. [56, Figure 4] for growing modes.
Unlike ASTROGK, SPECTROGK correctly calculates negative growth rates in the right-
hand plot due to the use of the hypercollisional operator (5.33).

ensure the code correctly represents v⊥ structure, and to study its behaviour when discrete
perpendicular velocity space is included. We show that the linear growth rate obtained in
the ﬁve-dimensional code converges to the value obtained from the four-dimensional code.
We also show convergence behaviour of the quadrature rule (4.29) used the ﬁeld solve.

The perpendicular velocity space grid vn = jnvcut/jNp+1 depends on two parameters:
Np the number of grid points, and vcut the largest perpendicular velocity (in units of vths)
captured by the discretization. Naturally we want to take vcut → ∞, but this coarsens
the v⊥ resolution for a ﬁxed Np.
In fact, convergence behaviour depends on the ratio
vcut/Np, which is the approximate grid spacing, since the Bessel roots jn are approximately
linearly spaced. In Figure 5.2(a) we plot the error in the calculation of the growth rate by
the ﬁve-dimensional code (γ) compared to the four-dimensional code (γexact) for typical
parameters (ρikx, ρiky, Rk(cid:107), R/LT ) = (0, 1, 0.1, 0.7) corresponding to a point on the blue
curve in Figure 5.1(b). The growth rate converges super-algebraically with decreasing
grid spacing, until reaching some vcut-dependent minimum error, beyond which there is
no further convergence. This minimum error decreases with increasing vcut, and reaches
machine precision for vcut ≥ 6 at around vcut/Np ≈ 0.4.

For practical reasons, we are typically limited to a modest, ﬁxed resolution, Np, and
must choose a value of vcut. As the error decreases with decreasing grid spacing vcut/Np we
generally wish to minimize vcut, but doing so for vcut < 6 leads to increases in error due to

118

00.050.10.150.20.250.30.35−0.4−0.35−0.3−0.25−0.2−0.15−0.1−0.050kka0ωRa0/vthi  a0/LT=0.7a0/LT=1.0a0/LT=1.500.050.10.150.20.250.30.35−0.15−0.1−0.0500.05kka0ωIa0/vthi  a0/LT=0.7a0/LT=1.0a0/LT=1.5(a)

(b)

Figure 5.2: Convergence of linear growth rates with perpendicular velocity resolution Np
and with velocity space cutoff vcut.

the minimum error for each vcut. Consequently there is an optimal value of vcut for each Np,
as shown in Figure 5.2(b) where the error is plotted against vcut. For N ≥ 16, the optimal
choice is vcut = 6, while for smaller resolutions the optimal choice of vcut decreases.

As well as verifying the ﬁve-dimensional linear calculation, this test also demonstrates
that the approximate dispersion relation (5.36) converges to the exact dispersion relation
(5.35). This shows that the sum-approximations to I1 and I3 which appear in (5.36) (and
in the ﬁeld solve) must also converge. However the quantities I1 and I3 contain Bessel
functions which oscillate more rapidly as ρik⊥ increases, and we have only shown conver-
gence at ρik⊥ = 1. This is sufﬁcient for drift kinetics for which ρik⊥ (cid:46) 1, but for future
sub-Larmor scale work it is instructive to study these approximations as a function of ρik⊥.

We consider the error in the approximation of I1 by the quadrature rule (4.29),

I1(k⊥) =

dv⊥ v⊥J 2

0 (ρik⊥v⊥)F ⊥

wnJ 2

0 (ρik⊥vn)F ⊥

0 (vn).

(5.37)

(cid:90) ∞

0

0 (v⊥) ≈ Np(cid:88)

n=1

As in the previous test, convergence depends on the grid spacing vcut/Np, with a minimum
error depending on vcut. However, since the approximation is in the form of a Hankel
transform with transform variable ρik⊥, the range in ρik⊥ for which the approximation
converges depends on the Hankel grid pn = jn/vcut rather than the velocity space grid.

We plot the error of the approximation (5.37) in Figure 5.3; results for I2, I3 and I4
are similar. Figure 5.3(a) shows approximations to I1(ρik⊥) (itself under the cyan curve)
for various resolutions Np and vcut = 6. The function I1 and all approximations to it are
positive for all k⊥. The dashed black line indicates the smallest grid point p1 = j1/vcut,
the same for all resolutions. The coloured vertical indicate the highest grid point pNp =
jNp/vcut for each resolution. Since Bessel roots jn are approximately linearly spaced, pNp

119

10-1100vcut/Np10-1410-1210-1010-810-610-410-2100|γ−γexact|/γexactvcut34567823456789vcut10-1410-1210-1010-810-610-410-2100|γ−γexact|/γexactNp48163264(a)

(c)

(b)

(d)

Figure 5.3: Testing the Hankel transform at points off the p-grid. Equation (5.37) is used to
approximate I1(ρik⊥) in the ﬁeld solve. (a) The approximation to I1(ρik⊥) with vcut = 6
and different Np . (b–c) The error in the approximation against Np for ﬁxed vcut, (b) vcut =
4, (c) vcut = 6. (d) The error with Np = 32 and different vcut.

increases roughly linearly with Np. The approximation (5.37) is valid between the lowest
and highest grid points, but it also converges below the lowest grid point. At the highest
grid point the approximation tends to zero and this leads to a deterioration before this point.
This is more clearly seen in the error plots, Figure 5.3(b)–(d). The error for a given
vcut and Np has some ﬂat characteristic level. However the error increases rapidly as ρik⊥
approaches the end of the p-grid range, where the error becomes O(1). As before, the error
decreases with decreasing grid spacing vcut/Np. But, in addition, the range of convergence
in ρik⊥ also increases with decreasing vcut/Np, since the end of the p-grid is located at
pNp = jNp/vcut which increases roughly linearly with Np/vcut.

Again, we consider the question of how to choose vcut given a ﬁxed resolution. For
ﬁxed Np, the error decreases with increasing vcut, provided that the ρik⊥ is in the resolution
range for all vcut. For example, in Figure 5.3(d) the error decreases with increasing vcut for
ρik⊥ ∈ (j1/vcut, j32/vcut), but increases sharply for ρik⊥ above j32/vcut. Therefore, for ﬁxed

120

05101520ρik⟂10-610-510-410-310-210-1I1(k)ExactNp=4Np=8Np=16Np=32Np=6405101520ρik⟂10-1610-1410-1210-1010-810-610-410-2100|I1(k⟂)−(cid:0)nwnJ20(k⟂vn)F⟂0(vn)|2Np=4Np=8Np=16Np=32Np=6405101520ρik⟂10-1610-1410-1210-1010-810-610-410-2100|I1(k⟂)−(cid:0)nwnJ20(k⟂vn)F⟂0(vn)|2Np=4Np=8Np=16Np=32Np=6405101520ρik⟂10-1610-1410-1210-1010-810-610-410-2100|I1(k⟂)−(cid:0)nwnJ20(k⟂vn)F⟂0(vn)|2vcut=3vcut=4vcut=5vcut=6resolution, the choice of vcut depends on the range of ρik⊥ to be resolved. Unfortunately,
the point where the error starts to increase does not seem to be simply related to vcut, so
must be determined for each choice of Np and vcut. However, it is only necessary to consider
minimizing the error at the largest ρik⊥ to be resolved. To see this, suppose we must resolve
wavenumbers up to ρik⊥ = 15 with ﬁxed resolution Np = 32. Then from Figure 5.3(d)
we see it is optimal to choose vcut = 5, as this is the value which yields the lowest uniform
error. Since increases in the error occur at the end of the domain, vcut = 5 is also the value
which minimizes the error at the point ρik⊥ = 15.

5.3.2 Free energy conservation
We now illustrate SPECTROGK’s free energy conservation properties. Recall from §2.3
that the gyrokinetic-Maxwell system conserves free energy W (2.107) in the absence of
driving and dissipation. The Fourier–Hermite–v⊥ spectral representation (§5.1.1) also con-
serves free energy. This is a consequence of the orthogonality of the Fourier and Hermite
basis functions, and of the fact that the linear operators Lϕ, LA and LB in the gyrokinetic
equation (5.7) are each proportional to F ⊥
0 (vn). We may therefore replace the perpendicular
n=1 wn . . .
which preserves all the qualitative properties needed in the derivation in §2.3. The resulting
conservation equation is

velocity space integral operator(cid:82) dv⊥ v⊥ . . . with its discrete approximation(cid:80)Np

(cid:33)

(Wgs + Wϕs)

+ T = C + D,

(5.38)

from the electrostatic potential and distribution function for each species,

s (Wgs + Wϕs) has been written in terms of contributions

nsTs

wn|˘gsmk(vn)|2

2F ⊥

0 (vn)

and

Wϕs =

nsq2
s
2Ts

(1 − Γ0s(k⊥))|ϕk|2,

(cid:88)

k

and the source of free energy from the temperature gradient (2.109) is

T = Re

nsTs

√
iky
LT 2

2

wnJ0(ρsk⊥vn)ϕkg∗

s,m=2,k(vn)

(cid:32)(cid:88)

s,n,k

(cid:33)

.

(5.39)

(5.40)

We have written the collision operator in (2.110) as the sum of a hyperviscous term (5.29),
giving dissipation

(cid:32)(cid:88)
where the free energy W = (cid:80)

d
dt

s

(cid:88)

m,n,k

Wgs =

D = −(cid:88)

Nm(cid:88)

n,k,s

m=3

121

νv(k⊥/k⊥max)8nsTswn|˘gsmk(vn)|2,

(5.41)

(a)

(b)

Figure 5.4: Free energy conservation in a ﬁve-dimensional, two-species, nonlinear, elec-
trostatic gyrokinetic simulation. (a) The four contributions to the free energy, and their
sum. The sum should be constant, but is only approximately constant due to the temporal
truncation error. (b) Absolute values of the time derivatives of the free energy contributions
in (a), and their sum. The sum should vanish, but does not due to temporal truncation error.

and a hypercollisional term (5.33), giving dissipation

C = −(cid:88)

Nm(cid:88)

νc(m/Nm)6nsTswn|˘gsmk(vn)|2.

(5.42)

n,k,s

m=3

We ﬁrst show free energy conservation for a two species ion-electron plasma with mass
ratio me/mi = 1/1836 and no driving (T = 0) or dissipation (C = D = 0). From (5.38),
the free energy would be constant in a continuous time formulation. In Figure 5.4(a) we
plot the contributions to the free energy, Wgi, Wge, Wϕi and Wϕe, and their sum W . The
sum W is indeed nearly constant, but decreases slightly due to the dissipative truncation
error in the third order Adams–Bashforth timestepping algorithm [168]. In Figure 5.4(b)
we plot the absolute values of the time derivatives of the contributions to the free energy
˙Wgi,
˙Wϕi and ˙Wϕe (approximated by ﬁrst-order ﬁnite differences), and their sum ˙W ,
which would vanish in a continuous time formulation. While the sum ˙W does not vanish,
˙Wgi. Moreover,
it is two orders of magnitude smaller than its smallest contributing term,
the magnitude of the sum decreases linearly with decreasing timestep, which is consistent
with truncation error in the ﬁrst order ﬁnite difference approximation.

˙Wge,

We also show free energy conservation for a simulation of nonlinear electrostatic ITG-
driven turbulence with kinetic ions and adiabatic electrons. Turbulence is driven with a
temperature gradient ωT = 100, and free energy is dissipated by hyperviscosity with coef-
ﬁcient νv = 1 and by hypercollisionality with coefﬁcient νc = 10. Now there is only one
species (s = i), and to account for the adiabatic electrons, the free energy contribution Wϕi

122

(a)

(c)

(b)

(d)

Figure 5.5: Free energy conservation in ﬁve-dimensional, nonlinear, electrostatic ITG-
driven turbulence. (a) Summed electrostatic potential against time. (b) Absolute values
of time-derivatives of free energy. (c) Time-derivatives of free energies on a linear scale.
(d) A close-up of (c).

123

Figure 5.6: An Alfv´en wave driven by an external parallel current.

(5.39) becomes

(cid:18)

1 +

(cid:88)

k

niq2
i
2Ti

Wϕi =

(cid:19)

|ϕk|2,

− Γ0i(k⊥)

Ti
Te

and the free energy balance (5.38) becomes

(Wgi + Wϕi) + T = C + D,

d
dt

(5.43)

(5.44)

In Figure 5.5(a) we plot the electrostatic potential against time, and in Figure 5.5(b),
(c) and (d) we plot the terms in the free energy balance (5.44) against time. We also plot
the error in the free energy balance E = ˙Wgi + ˙Wϕi + T − C − D. As with Figure 5.4(b),
the free energy is not conserved due to the truncation error in the Adams–Bashforth third
order timestepping algorithm. However as before, the error E is two orders of magnitude
smaller than its smallest contributing term, and decreases with decreasing timestep.

5.3.3 Antenna driving

In addition to previous unforced linear waves, we may also drive Alfv´en waves in SPEC-
TROGK by adding an external current Aext = A(cid:107)0e−iω0t to the left-hand side of the parallel
Amp`ere’s law (2.129b). In Figure 5.6 we plot the linear system with ˆB(cid:107) = 0 driven with
the same parameters as the example in NUMATA ET AL. [56, Figure 1]. We also plot
the Laplace–Fourier analytical solution given by NUMATA ET AL. [56]. This is a sce-
nario where SPECTROGK signiﬁcantly outperforms ASTROGK. Where ASTROGK uses
(Nz, Nλ, NE) = (32, 8, 32) = 8192 points to achieve comparable accuracy, SPECTROGK
uses a single Fourier–Hankel mode and requires around 12 Hermite modes.

124

020406080100024681012timeωAtApar2(arb.units)Antennadriving  SpectroGKModel Laplace−−Fourier5.3.4 Orszag–Tang vortex problem

To validate SPECTROGK in a nonlinear electromagnetic setting, we consider the Orszag–
Tang vortex problem [172], a standard test problem for MHD codes. ORSZAG & TANG
[172] solved the incompressible reduced MHD equations for ﬂux and stream functions in
the plane perpendicular to the mean magnetic ﬁeld. SCHEKOCHIHIN ET AL. [44] showed
that in the long wavelength limit ρik⊥ (cid:28) 1, the gyrokinetic-Maxwell system with B(cid:107) = 0
reduces to incompressible reduced MHD with a ﬂux function ϕ/B0 and stream function
A(cid:107). Therefore NUMATA ET AL. [56, §4.5] validated ASTROGK by simulating this regime
and comparing the results to those from a reduced MHD code.

We repeated this simulation in SPECTROGK using the same parameters. ASTROGK
and SPECTROGK share the same routines for perpendicular Fourier space, and as the
parallel direction is neglected, the codes only differ in their perpendicular velocity space
implementations—SPECTROGK’s discretization on a grid in perpendicular velocity space,
and ASTROGK’s pitch angle-energy-sign discretization (which cannot be separated into
parallel and perpendicular velocity). The simulations are in excellent agreement. In Fig-
ure 5.7 we show the contours of the stream and ﬂux function after one Alfv´en time for
ASTROGK and SPECTROGK simulations.

5.4 Performance

Finally, we study the performance of SPECTROGK measured in timesteps executed per
second of wall clock time. We compare the observed and theoretical complexity of the
algorithm in single-processor problems, and determine the weak and strong scalings of the
code’s parallel performance. We do this by running nonlinear, collisionless, antenna-driven
problems of varying resolution. For comparison with ASTROGK, we choose the same
problem parameters as in Ref. [56]: β = T0i/T0e = n0i/n0e = −qi/qe = 1, mi/me = 1836
and antenna driving at ρik⊥ = 1, the smallest wavenumber in the simulation.

5.4.1 Single processor scaling

We determine the scaling of the SPECTROGK algorithm with resolution using small non-
linear runs on a single processor, eliminating any loss in performance due to inter-processor
communication. We take a base resolution of (Nx, Ny, Nz, Nm, Np, Ns) = (4, 4, 8, 4, 2, 2)
and successively double the resolution of one dimension while keeping the resolution in
the other directions ﬁxed. The time per timestep is measured and the scalings for each
dimension are plotted in Figure 5.8. The scaling with the spatial resolutions Nx, Ny and Nz

125

(a)

(b)

(c)

(d)

Figure 5.7: Contour plots of (a,b) the electrostatic potential ϕ and (c,d) the parallel com-
ponent of the vector potential A(cid:107) for the Orszag–Tang test problem. Contours (a,c) were
computed by ASTROGK, while (b,d) were computed by SPECTROGK. Large contour val-
ues are due to ASTROGK’s normalization.

126

ϕ01x/(2πa)01y/(2πa)	25000	20000	15000	10000	50000500010000150002000025000ϕ01x/(2πa)01y/(2πa)	25000	20000	15000	10000	50000500010000150002000025000Ak01x/(2πa)01y/(2πa)	1500	1000	500050010001500Ak01x/(2πa)01y/(2πa)	1500	1000	500050010001500Figure 5.8: Single processor scaling on a 1.90GHz Intel i3-4030U CPU. The scaling with
spatial resolution follows N log N due to the fast Fourier transforms. The scaling is linear
with respect to perpendicular velocity and Hermite space resolution, as expected.

follow N log N, as expected since the Fast Fourier Transform in the nonlinear term domi-
nates the work. The algorithm is linear with respect to Hankel and Hermite space, which
we observe.

5.4.2 Parallel performance

Parallel performance is measured by a code’s agreement with the weak and strong scalings.
In the weak scaling, the problem size and number of processors are increased simultane-
ously such that the work done by each processor remains constant. Ideally, the wall clock
time per timestep should remain constant as the number of processors increases. In the
strong scaling, the number of processors is increased but the problem size is held ﬁxed.
Thus the number of points per processor is inversely proportional to the number of proces-
sors, and the ideal scaling is a linear decrease in wall clock time per timestep.

The weak and strong scalings for SPECTROGK are shown in Figure 5.9. Both scalings
are reasonably good, but the performance degrades as the number of cores approaches 103.

127

100101102103104N10-410-310-210-1100101time per timestep (sec)∝NNmNp100101102103104N10-410-310-210-1100101time per timestep (sec)∝Nlog2N∝NNxNyNz(a)

(b)

Figure 5.9: (a) SPECTROGK strong scaling for the 2.4GHz Intel Ivy Bridge Xeon proces-
sors on the Fionn machine at the Irish Centre for High-End Computing (ICHEC) and for
the 2.0GHz Intel Sandy Bridge Xeon processors on the ARCUS machine at the University
of Oxford Advanced Research Computing (ARC) facility, both using Inﬁniband intercon-
nects. (b) Weak scaling on the ARCUS machine.

128

102103Nproc10-1100101time per timestep (sec)FionnARCUSideal102103Nproc0.00.51.01.52.02.53.0time per timestep (sec)ARCUSidealPart III

Results

129

Chapter 6

Suppression of Landau damping in
saturated ion temperature gradient
driven turbulence

This chapter is based on PARKER ET AL. [173].

6.1

Introduction

Gyrokinetic turbulence (turbulence in weakly collisional, strongly magnetized plasmas) is a
phenomenon which is widely studied, owing to its ubiquitous occurrence both in magnetic-
conﬁnement-fusion experiments [54, 174, 175] and in astrophysical settings [44, 55]. Like
incompressible Navier–Stokes turbulence, gyrokinetic turbulence may be described as the
injection, cascade to small scales, and dissipation of some quadratic invariant (in gyrokinet-
ics, free energy). On spatial scales larger than the ion Larmor radius, gyrokinetic turbulence
incorporates two mechanisms for dissipating into heat the free energy injected into the sys-
tem (e.g., by a plasma instability). The ﬁrst is a ﬂuid-like nonlinear cascade which transfers
free energy from large spatial scales (the injection, or outer, scales) to smaller, sub-Larmor,
spatial scales (where the free energy is dissipated eventually by collisions [44, 152]). The
second is parallel phase mixing, the linear process studied in Chapter 3 which transfers
free energy from the ﬂuid moments (density, parallel ﬂow and temperature) to the kinetic
moments by creating perturbations to the velocity distribution on ever ﬁner scales (a ve-
locity space cascade), perturbations which are dissipated either by collisions, or by Landau
damping [39, 176]. In a linear plasma, the transfer and dissipation of free energy occurs at
a constant rate which is independent of collision frequency [89, 93].

The macroscopic properties of the turbulence (like transport) are directly affected by
the interaction of these two cascades; yet while each is understood in isolation, how they

130

interact is not clear. Recent work reveals some disquieting observations. Firstly, the ﬂuid-
like theory for the nonlinear cascade by BARNES ET AL. [165] is in excellent agreement
with the empirically-observed power law spectra of the electrostatic potential, but in its
derivation it is necessary to neglect free energy transfer by phase mixing, contrary to the
expected behaviour from linear plasma kinetic theory. Attempts to include the constant
ﬂux of free energy into velocity space lead to incorrect, exponentially-decaying spectra,
as illustrated by HOWES ET AL. [177] and PODESTA ET AL. [178] (while discussing a
different problem). However, a signiﬁcant proportion of injected free energy does indeed
cascade and dissipate in velocity space [176], albeit with a slower transfer rate than in the
linear case, and with a dissipation rate that depends on collision frequency [96]. These
observations suggest a complicated relationship between parallel phase mixing and the
nonlinear cascade; there is as yet no complete picture of free energy ﬂow and dissipation
in phase space.

In this Chapter, we provide this picture by describing the interaction between phase
mixing and the nonlinear cascade in electrostatic drift kinetic turbulence, a convenient limit
of gyrokinetics. We show that the net transfer of free energy from ﬂuid to kinetic modes
is strongly inhibited in a turbulent plasma, relative to a linear plasma. This is due to a
stochastic version of the plasma echo [179, 180] where the nonlinearity excites “anti-phase-
mixing” modes which transfer free energy from small to large scales, leading to statistical
cancellation of free energy transfer. The signiﬁcance of this effect depends on the relative
sizes of the phase-mixing and nonlinear terms, and we identify regions of wavenumber
space where either the echo effect dominates, or where there is phase-mixing at the usual
linear rate. The plasma’s energy-containing scales lie within the former echo-dominated
region. Therefore there is very little net transfer of free energy to ﬁne velocity-space scales
via linear phase-mixing, and consequently Landau damping is strongly suppressed as a
dissipation mechanism.

6.2 Drift kinetics

We study electrostatic ion-temperature-gradient driven drift kinetic turbulence in an un-
sheared slab with kinetic ions and adiabatic electrons. The drift kinetic equation for ions
is

(cid:82) d2v⊥ δf is the perturbed distribution function integrated over perpendic-

Here g = n−1
ular velocity space, with ni the background ion density; ϕ = Zeφ/Ti with electrostatic

(6.1)

+ v(cid:107)∇(cid:107) (g + ϕF0) + u⊥ · ∇⊥g = C[g] + χ.

∂g
∂t

i

131

/v2

−v2
(cid:107)

potential φ, electron charge e, ratio of ion to electron charge Z, and background ion tem-
√
perature Ti; F0(v(cid:107)/vth) = e
π is the one-dimensional Maxwellian, with vth the
th/
ion thermal velocity; u⊥ = (ρivth/2)ˆz × ∇⊥ϕ is the E × B velocity with ion gyrora-
dius ρi, and ˆz the unit vector in the direction of the magnetic ﬁeld line; the perpendicular
directions are denoted x and y. The source term from the ion temperature gradient in the
negative x-direction is

(cid:33)

(cid:32) v2(cid:107)

v2
th

χ = −ρivth
2LT

∂ϕ
∂y

− 1
2

F0,

(6.2)

where 1/LT = −d log Ti/dx is the constant imposed macroscopic temperature gradient.
Particle collisions C[g] are described shortly. The electrostatic potential is given by the
quasineutrality condition

(cid:90) ∞

−∞

(cid:90)

W =

(cid:90)

d3r

(cid:90) ∞

ϕ = α

dv(cid:107) g,

α = ZTe/Ti.

(cid:90)

ϕ2
2α

+

(cid:90) ∞

−∞

d3r

(cid:90)

g2
2F0

,

dv(cid:107)

(cid:90) ∞

d3r

dv(cid:107)

gχ
F0

+

−∞

d3r

dv(cid:107)

gC[g]

F0

.

−∞

(6.3)

(6.4)

(6.5)

The drift kinetic system conserves free energy

except for injection by the ion temperature gradient and dissipation by collisions:

dW
dt

=

6.3 Simulations

(cid:80)∞

√
m=0 gmHm(ˆv(cid:107))F0(ˆv(cid:107))/

We study the saturated nonlinear state of drift kinetic turbulence. We solve equations (6.1–
6.3) with SPECTROGK, which was described in Chapter 5. We use a Fourier represen-
tation in space, with 256 parallel wavenumbers, and 128 wavenumbers in each perpen-
dicular direction, with 8th order hyperviscosity (5.29) cutting off the distribution func-
tion at k⊥ρi ∼ 1. In parallel velocity space, we use the Hermite representation g(v(cid:107)) =
(cid:107)(−d/dˆv(cid:107))me
−ˆv2
√
(cid:107)
2mm! ∼
with ˆv(cid:107) = v(cid:107)/vth. For large m, Hermite polynomials behave like HmF 1/2
0 /
2m − mπ/2) so that each m represents a scale in velocity space. Low m rep-
cos(ˆv(cid:107)
resent “ﬂuid” quantities: g0 = ϕ/α, g1 =
2, where u(cid:107) is the
parallel bulk velocity and δT(cid:107) is the perturbed parallel temperature. In contrast, gm for
m ≥ 3 are “kinetic” modes representing ﬁner scales in velocity space. For collisions we
use the Kirkwood operator (the momentum and energy conserving version of the Lenard–
Bernstein operator, see §3.2.2 ): C[gm] = −mνgmIm≥3, where Im≥3 = 1 if m ≥ 3 and

2mm! for Hermite polynomials Hm(ˆv(cid:107)) = eˆv2

2u(cid:107)/vth, g2 = δT(cid:107)/Ti

√

√

√

132

is zero otherwise. In these simulations we use 256 Hermite modes, regularizing with 6th
order hypercollisions C[gm] = −νhm6gmIm≥3. As the linear growth rate in drift kinetics
increases indeﬁnitely with increasing k⊥, we damp the temperature gradient term by a fac-
tor ∼ e−100(k⊥/k⊥max)2 to separate the free energy injection and dissipation scales. Conse-
quently, we use very large temperature gradients, here presenting results for R/LT = 1600.
However due to the exponential factor this is representative of much smaller, but still above
marginal, temperature gradients.

We solve fully spectrally, but for presentation consider equations which are spectral in

the parallel directions only. The drift kinetic equation (6.1) becomes

(cid:32)(cid:114) m + 1

2

∂ˆgm
∂t

+ ik(cid:107)vth

(cid:33)

(cid:88)

(cid:114) m

2

ˆgm+1 +

ˆgm−1

+

ˆu⊥(p(cid:107)) · ∇⊥ˆgm(q(cid:107))

p(cid:107)+q(cid:107)=k(cid:107)
ˆϕδm1 = −νmˆgmIm≥3 + ˆχ,

(6.6)

+

ik(cid:107)vth√
2

√
where ˆχ = −(ρivth/2
2LT )(∂ ˆϕ/∂y)δm2, δ is the Kronecker delta, and a hat denotes a
function in (r⊥, k(cid:107)) space. Equation (6.6) neatly contains the two cascades present in the
turbulence: the ﬂuid cascade due to the nonlinearity (ˆu⊥ · ∇⊥ˆg), and linear streaming (the
mode coupling in m).

6.4 Free energy transfer

We ﬁrst study the transfer of free energy between ﬂuid and kinetic modes. We write the
free energy as

(cid:90)

(cid:88)

k(cid:107)

d2r⊥

(Wﬂuid + Wkin),

W =

where

Wﬂuid =

(1 + α)| ˆϕ|2

2α2

|ˆu(cid:107)|2
v2
th

|δ ˆT(cid:107)|2
4T 2
i

,

+

+

is the free energy contained in ﬂuid modes and

∞(cid:88)

m=3

Wkin =

1
2

|ˆgm|2,

(6.7)

(6.8)

(6.9)

is the free energy in kinetic modes. To derive evolution equations for these, we multiply
(6.6) by ˆg∗
m (the complex conjugate of ˆgm) and add the resulting equation to its complex

133

Figure 6.1: Free energy transfer from ﬂuid to kinetic modes in saturated turbulence, nor-
malized to its value in a linear plasma, (cid:104)T (cid:105) /TL. The diagonal black line marks the critical
balance determined from ϕ. Free energy transfer to ﬁne velocity-space scales is strongly
suppressed and hence the turbulence is ﬂuid-like.

conjugate to obtain

(cid:18)|ˆgm|2

(cid:19)

2

d
dt

+ Γm − Γm−1 + Im

(cid:18) k(cid:107)vth√

(cid:19)

ˆg∗
m ˆϕδm1

= −νm|ˆgm|2Im≥3 + Re (ˆg∗

m ˆχ) ,

2

(6.10)
where d/dt is the convective derivative ∂/∂t + u⊥ · ∇⊥ expressed in (r⊥, k(cid:107)) space, and
m+1ˆgm) is the free energy transfer from mode m to m + 1
Γm = k(cid:107)vth
[140].

(cid:112)(m + 1)/2 Im(ˆg∗

Summing (6.10) separately for m = 0, 1, 2 and m ≥ 3, we obtain

(cid:17)

dt

(cid:16)

(6.11)

dWkin

dt

= T − C,

√

3 Im

dWﬂuid

= S − T ,

ˆg∗
3δ ˆT(cid:107)

where S = Re

(cid:16)
ent and C = ν(cid:80)∞
δ ˆT ∗
(cid:17)
/2TiLT is the free energy source due to the temperature gradi-
(cid:107) ˆux
m=3 m|ˆgm|2 is the free energy sink due to collisions. The term T =
/2Ti = Γ2 is the transfer of free energy from ﬂuid to kinetic modes
k(cid:107)vth
due to streaming v(cid:107)∇(cid:107)g in (6.1). This is the only effect which transfers free energy be-
tween ﬂuid and kinetic modes. Streaming is linear and reversible, so T may be positive
or negative; however analytic theory for linear Landau damping, which sets T ≡ TL =
|k(cid:107)|vth
with numerically calculated spectra (see [89, 93], or Chapter 3).

(cid:112)(m + 1)/2|ˆgm|2), is in excellent agreement

(cid:112)3/2|ˆg2|2 (i.e. Γm ≡ ΓL

m = |k(cid:107)|vth

We now consider saturated plasma turbulence. Here the time average (denoted (cid:104)·(cid:105)) of
the free energy is constant, (cid:104)dWﬂuid/dt(cid:105) = (cid:104)dWkin/dt(cid:105) = 0, so that (cid:104)T (cid:105) = (cid:104)S(cid:105) = (cid:104)C(cid:105) ≥ 0.
For phase mixing (and Landau damping) to play a similar role in turbulent plasma as in the
linear case, one would expect T to be similar to the value from the linear case (cid:104)T (cid:105) ≈ TL. In

134

0.010.10.5k110100k0.00.20.40.60.81.0Figure 6.1 we plot the ratio (cid:104)T (cid:105) /TL for saturated drift kinetic turbulence. Across all phys-
ical scales, the transfer is strongly suppressed from its value in the linear case. Moreover,
across a large range of physical scales, the transfer is completely suppressed, (cid:104)T (cid:105) ≈ 0.
These have two important consequences. Firstly, the ﬂuid and kinetic modes are, statisti-
cally, very nearly energetically decoupled. Secondly, collisional dissipation (cid:104)C(cid:105) = (cid:104)T (cid:105) is
also strongly suppressed, so collisions are far less effective as a dissipation mechanism.

6.5 Phase-mixing and anti-phase-mixing modes

m, propagating modes in Hermite space: the “phase-mixing mode”, ˆg+

This suppression of free energy transfer via linear phase mixing is a nonlinear, kinetic ef-
fect. To understand its mechanism, we decompose the distribution function in terms of ˆg+
m
and ˆg−
m, propagates
forwards from low to high m, while the “anti-phase-mixing mode”, ˆg−
m, propagates back-
wards from high to low m [93, 145, 181]. These are the two modes already observed in the
linear problem, see Figure 3.11(a). The decomposition is

where

(cid:3) ,
ˆgm =(cid:0)i sgn k(cid:107)(cid:1)−m(cid:2)ˆg+
(cid:0)±i sgn k(cid:107)(cid:1)m(cid:0)ˆgm ± i sgn(k(cid:107))ˆgm+1

m + (−1)mˆg−

m

(cid:1) .

ˆg±
m =

1
2

(6.12)

(6.13)
m|2 [181],

∂
∂t

(cid:18)|ˆg±

m|2
2

= −Re

With these, the free energy contributions are approximately |ˆgm|2 ≈ |ˆg+
with ˆg±

m evolving as

m|2 + |ˆg−

∂
∂m

m|ˆg±

(cid:0)√

m|2(cid:1) + νm|ˆg±
(cid:104)

(cid:19)
± |k(cid:107)|vth√
(cid:16)(cid:88)
2
m(k(cid:107))]∗ ˆu⊥(p(cid:107)) · ∇⊥
[ˆg±
= (cid:2)1 ± sgn(k(cid:107)q(cid:107))(cid:3) /2, which is one if k(cid:107) and q(cid:107) have the same
p(cid:107)+q(cid:107)=k(cid:107)

m|2
m(q(cid:107)) + δ−
ˆg±
k(cid:107)q(cid:107)

ˆg∓
m(q(cid:107))

(cid:105)(cid:17)

δ+
k(cid:107)q(cid:107)

(6.14)

,

for m ≥ 3. Here δ±
k(cid:107)q(cid:107)
sign, and zero otherwise. We have also introduced a derivative approximation for the ﬁnite
difference in linear streaming which is valid as the modes ˆg±
m are smooth in the sense that
m ≈ ˆg±
ˆg±
0 )/2.
Further, the normalized free energy transfer from m to m + 1 is

m, the E × B velocity is ˆu⊥ = αρivthˆz ×∇⊥(ˆg+

m+1 [181]. In terms of ˆg±

0 + ˆg−

(cid:112)(m + 1)/2 Im(ˆg∗
(cid:112)(m + 1)/2 |ˆgm|2

k(cid:107)vth

m+1ˆgm)

¯Γm =

Γm
ΓL
m

=

k(cid:107)vth

m|2 − |ˆg−
≈ |ˆg+
m|2
|ˆg+
m|2 + |ˆg−
m|2

.

(6.15)

From this expression it follows that the suppression of free energy transfer, ¯Γm < 1, can
only be due to the presence of anti-phase-mixing modes, ˆg−

m (cid:54)= 0.

135

Figure 6.2: Free energy transfer from mode 100 to 101 in saturated turbulence, normalized
to its value in a linear plasma, ¯Γ100. The diagonal black line marks the critical balance
determined from ϕ. Free energy transfer is completely suppressed at the energy-containing
scales τ−1

, and hence Landau damping is strongly suppressed.

(cid:38) τ−1

s

nl

Let us now consider the linear and nonlinear cases in terms of ˆg±

m. In the linear case, we
neglect the right-hand side of (6.14). Taking an initial disturbance at large velocity space
scales (low m) that propagates forwards only, we seek solutions with ˆg−
m = 0.1 Solving the
differential equation in m for |ˆg+

m|2, we ﬁnd
e(−m/mc)3/2

|ˆg+
m|2 =

A(k(cid:107))√
m

(cid:18)3|k(cid:107)|vth

(cid:19)2/3

√
2

2ν

,

mc =

,

(6.16)

where A is a constant of integration, and mc is the collisional cutoff [89, 93]. For m < mc,
|ˆg+
m|2 has the m−1/2 spectrum of linear Landau damping, while for m > mc, the spectrum
is strongly damped. As ˆg−

m = 0, the normalized transfer (6.15) is ¯Γm = 1 everywhere.

0 in ˆu⊥ couples to the two ˆg−

To consider nonlinear drift kinetics, we reinstate the nonlinear term in (6.14). Now
m = 0 in the initial conditions, the nonlinear term acts as a source in the “−”
even with ˆg−
m modes
equation (the ˆg+
to increase, with the result that ¯Γm < 1, as in Figure 6.1. The effect is even clearer in the
inertial range of m, away from driving and dissipation scale effects, as we see in Figure 6.2
where we plot ¯Γ100. Now there are clear regions in wavenumber space where free energy
transfer is as in the linear case, ¯Γ100 = 1, and where free energy transfer is completely
suppressed, ¯Γ100 = 0.

m terms). This causes energy in the ˆg−

6.6 Critical balance

To understand the mechanism that leads to these distinct regions of wavenumber space, we
compare the sizes of the phase-mixing and nonlinear terms. We quantify these by compar-

1Any ˆg−m present in the initial conditions “reﬂects” off the hard-wall-like boundary condition at m = 0

and becomes forward propagating within one streaming time.

136

0.010.10.5k110100k0.00.20.40.60.81.0(a)

(b)

Figure 6.3: Hermite spectra at ﬁxed k in (a) the linear streaming dominated region (m−1/2)
and (b) the nonlinearity dominated region (m−5/2).

nl ∼ (vth/R)(k⊥ρi)4/3 [165]. When τ−1

s ∼ k(cid:107)vth and
ing the timescales for the two cascades, the characteristic streaming rate τ−1
the nonlinear eddy turnover rate τ−1
nl , stream-
ing dominates the nonlinearity, and the problem is essentially linear with ¯Γm = 1. When
s (cid:28) τ−1
τ−1
nl , the nonlinearity dominates streaming and ﬂux is suppressed. In Figure 6.2
we also plot the line of critical balance, τ−1
, with the constant of proportionality
determined by the critical balance of the electrostatic potential ϕ. The critical balance line
is in good agreement with the boundary of complete suppression ¯Γm = 0, indicating that
free energy transfer is suppressed wherever the nonlinear eddy turnover rate is comparable
with or faster than the linear streaming rate τ−1

nl ∼ τ−1

s (cid:29) τ−1

s

(cid:38) τ−1

.

s

nl

6.7 Hermite spectra and dissipation

The different free energy transfer behaviours in the phase-mixing and the nonlinearity dom-
inated regions give rise to two different Hermite spectra, as plotted in Figure 6.3. In the
phase-mixing-dominated region (Γm = 1), we observe the m−1/2 spectrum (6.16) obtained
by neglecting the nonlinear term. In the nonlinearity dominated region (Γm = 0), we ob-
serve the m−5/2 spectrum recently predicted by SCHEKOCHIHIN ET AL. [181] and derived
in Chapter 7.

These spectra exhibit different dissipation behaviours. The spectrum in the phase-

mixing region dissipates free energy at the usual Landau damping rate

(6.17)
which remains ﬁnite as ν → 0+. In contrast, the dissipation rate in the nonlinear region is

3

dm νmm−1/2 ∼ |k(cid:107)|vth,

Dnl ∼

dm νmm−5/2 ∼ ν4/3(|k(cid:107)|vth)−1/3,

(6.18)

(cid:90) mc

Ds ∼

(cid:90) mc

3

137

so Dnl → 0 as ν → 0+. Landau damping is thus suppressed in the nonlinear region.

Finally, one important property of critical balance is that most of the free energy is
contained in modes for which τs/τnl ∼ (k⊥ρi)4/3/(k(cid:107)R) (cid:38) 1 ([165], or note, e.g., that in
Figure 6.3 the amplitudes of the spectra are much larger for the nonlinear region). This is
exactly the nonlinearity-dominated region where ¯Γm = 0 and |gm|2 ∼ m−5/2. Therefore
the total dissipation in collisions tends to zero as ν → 0+, and the vast majority of free
energy cascades to dissipation at ﬁne physical space scales.

These spectra and dissipation patterns are in accordance with the earlier work of HATCH
ET AL. [96] which deduced similar properties based on the Hermite spectra summed over
all k. However we have shown that the Hermite spectrum has different behaviours in
different regions of Fourier space.

6.8 Discussion

In this Chapter we have shown that linear phase mixing and the nonlinear cascade, two
effects which one might have expected to be independent, are in fact strongly interacting.
The nonlinear term excites anti-phase-mixing modes, suppressing the net transfer of free
energy into kinetic modes in the inertial range in m. This has both theoretical and prac-
tical implications. Theoretically our results profoundly change our understanding of the
way that free energy is cascaded and dissipated in phase space. As there is only a small
net free energy ﬂux out of ﬂuid modes in the inertial range, it is legitimate to neglect par-
allel streaming when deriving physical space spectra from Kolmogorov arguments, as in
Ref. [165]. Moreover, the Hermite spectrum at dominant scales is a steep m−5/2 power
law which dissipates no free energy via Landau damping as ν → 0+. Therefore almost
all free energy cascades to sub-Larmor scales. The steep spectrum also means that free
energy dissipation is not independent of collisionality. This has the important practical
implication that enlarged collision frequencies cannot necessarily be used to compensate
for low v(cid:107) resolution in weakly collisional simulations. Conversely, this work suggests a
possible reﬁnement to existing gyroﬂuid models [39, 40] through incorporating free energy
ﬂux conditions into the gyroﬂuid closure.

Finally, this work has focused on ion-temperature-gradient-driven drift kinetic turbu-
lence. However, its conclusions depend on inertial range physics which do not depend on
details of the injection scale. The approach presented here will be applicable to other ki-
netic systems where a nonlinearity interacts with particle streaming. Indeed, the similar
suppression of streaming has already been observed due to a different nonlinearity in the
Vlasov–Poisson system [145, see also Appendix A].

138

Chapter 7

Phase space spectra for drift-kinetic
turbulence

In the previous Chapter, we showed that the transfer of free energy via linear streaming is
different in different regions of phase space. When the linear streaming term dominates
the nonlinear term, free energy is transferred at the same rate as in the linearized system.
However, when the nonlinearity dominates the streaming, the transfer to ﬁne velocity scales
In §7.1, we use these
is suppressed, and free energy cascades purely in Fourier space.
observations to construct a theory for the phase space spectra in drift-kinetic turbulence. In
§7.2, we verify these spectra using simulations of ITG-driven turbulence. However, there
is nothing in the theory which is speciﬁc to ITG turbulence, and it should apply equally
to the inertial range of electron temperature gradient driven turbulence [24, 25], or indeed
generic electrostatic drift-kinetic turbulence driven at long perpendicular wavelengths.

7.1 Derivation of scalings

SCHEKOCHIHIN, PARKER, HIGHCOCK, DELLAR, DORLAND & HAMMETT [181] gives
a detailed and careful derivation of the scaling laws for drift-kinetic turbulence. In this
Section, we give a concise derivation following their approach.

The spectra are derived making three assumptions. Firstly, the temperature gradient is
large, R/LT (cid:29) 1. This ensures scale separation between the energy injection scale and
the Larmor (i.e. dissipation) scale, and therefore allows an inertial range in k⊥ to develop.
The second assumption is that the turbulence is isotropic in the perpendicular plane, so that
kx ∼ ky ∼ k⊥. This assumption was introduced by BARNES ET AL. [165] based on the
conjecture that strong ITG turbulence generates zonal ﬂows, modes with ky = k(cid:107) = 0 and
kx much smaller than scales characteristic of the inertial range in k⊥ (see e.g. Figure 7.3).
Counterintuitively, zonal ﬂows tend to isotropise structures in the xy plane by shearing

139

nl

[20, 182], so that wavenumbers satisfy kx ∼ ky(SZFτ−1

apart anisotropies. The shearing rate SZF is comparable with the inverse nonlinear time
nl ) ∼ ky. The third assumption
τ−1
is “critical balance”, a causality argument discussed in §7.1.1. Critical balance is used to
relate parallel and perpendicular length scales; no relation can be found using dimensional
analysis, since the natural ratio ρi/L has been formally taken to zero in deriving the gy-
rokinetic (and drift-kinetic) equations. Perpendicular isotropy and critical balance will be
veriﬁed in §7.2.

7.1.1 Spectrum for the electrostatic potential

We begin by deriving the spectrum of the electrostatic potential, deﬁned as

Eϕ(k(cid:107), k⊥) = 2πk⊥(cid:104)|ϕk|2(cid:105),

(7.1)
where as before ϕk denotes the Fourier coefﬁcients of ϕ, and (cid:104)·(cid:105) denotes a time average
over the saturated turbulent state. We assume that Eϕ(k(cid:107), k⊥) will have different scalings
in the two regions of wavenumber space discussed in Chapter 6: the advection-dominated
region (τnl (cid:46) τs) and the streaming-dominated region (τs (cid:46) τnl). Since we will make local
cascade arguments, we assume separate power law spectra in the two regions:

ka(cid:107)kb⊥,

kc(cid:107)kd⊥,

Eϕ(k(cid:107), k⊥) =

τs (cid:46) τnl,
τs (cid:38) τnl,

(7.2)

where a, b, c and d are constants to be determined.

We ﬁrst ﬁnd the spectra in the advection-dominated region using critical balance, a
causality argument introduced for astrophysical magnetohydrodynamic turbulence [183–
185] which has since been used for strong turbulence in other wave-supporting systems
[44, 186, 187]. Critical balance states that two points along the mean ﬁeld can be cor-
related only if the time taken for information to pass between them (the streaming time
τs ∼ (k(cid:107)vth)−1) is less than the time taken for turbulence to decorrelate that information
in the perpendicular plane (the nonlinear time τnl ∼ (k2⊥ϕ)−1). Thus the turbulence is
uncorrelated in the parallel direction for τnl (cid:46) τs, and there Eϕ(k(cid:107), k⊥) has the spectrum
of uncorrelated perturbations (white noise), Eϕ(k(cid:107), k⊥) ∼ k0(cid:107)kd⊥. That is, c = 0 in (7.2).
Critical balance also implies that most of the free energy is contained in the scales τnl (cid:46) τs.
We determine the exponent d from a constant ﬂux argument in the advection-dominated
region. As seen in Figure 6.1, there is very little free energy ﬂux due to linear streaming

140

in τnl (cid:46) τs. We therefore argue that free energy has a constant ﬂux through wavenumber
space

=⇒

W
τnl

∼ ϕ2
τnl

∼ k2⊥ϕ3 ∼ constant,

(7.3)
where we have used the nonlinear time τnl ∼ (k2⊥ϕ)−1. We thus determine the nonlinear
time in terms of k⊥ only: τnl ∼ (k2⊥ϕ)−1 ∼ k
. We also determine the one-dimensional
perpendicular spectrum, deﬁned as E⊥
is dominated by the energy-containing scales with τnl (cid:46) τs, that is, k(cid:107) (cid:46) k4/3⊥ :

ϕ (k⊥) ≡(cid:82) dk(cid:107) Eϕ(k(cid:107), k⊥). By critical balance, this

−4/3⊥

,

ϕ ∼ k

−2/3⊥

(cid:90)

(cid:90) k4/3

⊥

0

ϕ (k⊥) ≡
E⊥

dk(cid:107) Eϕ(k(cid:107), k⊥) ∼

dk(cid:107) k0(cid:107)kd⊥ ∼ kd+ 4
3⊥ .

(7.4)

However, using the deﬁnition of the one-dimensional spectrum and the constant free energy
ﬂux argument (7.3), we may also deduce

(cid:82) dk(cid:107)dk⊥ 2πk⊥(cid:104)|ϕk|2(cid:105)

k⊥

∼ ϕ2
k⊥

∼ k

− 7
3⊥ ,

(7.5)

(cid:90)

ϕ (k⊥) ≡
E⊥

dk(cid:107) 2πk⊥(cid:104)|ϕk|2(cid:105) ∼

so that comparing (7.4) and (7.5) determines d = −11/3.

We still need two conditions to determine a and b, the remaining powers in (7.2). Firstly
we use the standard result based on the Corsin invariant in two-dimensional turbulence (and
derived in [181, Appendix A]) that spectra in a homogeneous isotropic system decay like
k3⊥ for long perpendicular wavelengths. We therefore have b = 3. The remaining exponent
a is found by imposing continuity in the spectrum across τnl ∼ τs, so that
a = −5.

∼ ka(cid:107)k3⊥ ∼ k
4a
3 +3
⊥

−11/3⊥

=⇒

(7.6)

k0(cid:107)k

7.1.2 Spectrum for the distribution function

We now derive spectra for the distribution function. These are more complicated since they
depend on m, as well as k⊥ and k(cid:107). Moreover, there are two sets of spectra, one each for
the forward and backward propagating modes ˜g±

m introduced in Chapter 6.

The spectrum of the electrostatic potential Eϕ is divided into two regions along the
critical balance line τnl ∼ τs. Critical balance also appears in the distribution function
spectra, but in addition there is a new dependence on the “phase-mixing threshold”, k(cid:107) ∼
√
mk4/3⊥ . The phase-mixing threshold is like a critical balance where the velocity scale in
the streaming time, vth, has been replaced by the velocity scale of the mth Hermite mode,
√
vth/

m (see (3.19)).

141

To ﬁnd the distribution function spectra, we introduce the new function

˜f (k(cid:107), k⊥, s) = m1/4

m(k(cid:107), k⊥), k(cid:107) ≥ 0,
˜g−
m(k(cid:107), k⊥), k(cid:107) < 0,

√

where s =

m. On substitution into the gyrokinetic equation, we ﬁnd ˜f satisﬁes

∂ ˜f
∂t

+

k(cid:107)vth√
2

∂ ˜f
∂s

u⊥(p(cid:107)) · ∇⊥ ˜f (k(cid:107) − p(cid:107)),

and the mean squared amplitude F = (cid:104)| ˜f|2(cid:105) satisﬁes

˜g+
= −(cid:88)
(cid:88)

p(cid:107)

(7.7)

(7.8)

(7.9)

 .

∂F
∂t

+

k(cid:107)vth√
2

∂F
∂s

= −2 Re

˜f∗(k(cid:107))u⊥(p(cid:107)) · ∇ ˜f (k(cid:107) − p(cid:107))

p(cid:107)
In this equation, both phase-mixing and anti-phase-mixing are represented as propagation
√
along the characteristics s = k(cid:107)vth(t− t0)/
2. The generation of echo ﬂux (i.e. conversion
m) is now represented by mode coupling between positive and negative parallel
from ˜g+
wavenumbers via the nonlinear term.

m to ˜g−

We ﬁrst consider the spectrum of forward propagating modes,

m(k(cid:107), k⊥) = 2πk⊥(cid:104)|˜g+
E+

m|2(cid:105).

(7.10)

Free energy streams linearly along characteristics until coupled to other wavenumbers by
the nonlinear term. Therefore, linear streaming lasts for at most one nonlinear time,

√

2
s
k(cid:107)vth

= (t − t0) (cid:46) τnl ∼ k

−4/3⊥

In this region ˜f, inherits its spectrum Ef ≡ 2πk⊥(cid:104)| ˜f|2(cid:105) =
Eϕ at k(cid:107) (cid:46) k4/3⊥ , so that

=⇒
√

s (cid:46) k(cid:107)
k4/3⊥

.

(7.11)

mE+

m from low s, that is, from

√

Ef =

mE+

m ∼ Eϕ ∼ k−5(cid:107) k3⊥.

(7.12)

Thus we have the spectrum in the streaming-dominated region:

m(k(cid:107), k⊥) ∼ k−5(cid:107) k3⊥m−1/2
E+

(7.13)
To ﬁnd the spectrum in the advection dominated region k(cid:107) (cid:46) k4/3⊥ , we note that there
is signiﬁcant echo ﬂux, so we may neglect linear streaming and treat (7.8) as a ﬂuid-like

in

√
mk4/3⊥ (cid:46) k(cid:107).

142

equation for each s. Repeating the constant free energy ﬂux argument used for Eϕ (7.3),
we obtain

˜f 2
τnl

∼ k2⊥ϕ ˜f 2 ∼ fn(s),

=⇒

˜f 2 ∼ k

−4/3⊥
−2/3⊥

,

(7.14)

. As in (7.5), we use

where fn(s) denotes a function of s only, and we have used ϕ ∼ k
this to ﬁnd the one-dimensional perpendicular spectrum,

(cid:82) dk(cid:107)dk⊥ E+

(cid:90)

m (k⊥) ≡
E+⊥

dk(cid:107) 2πk⊥(cid:104)|˜g+

m|2(cid:105) ∼

m(k(cid:107), k⊥)

k⊥

∼ ˜f 2
k⊥

∼ k

− 7
3⊥ ,

(7.15)

Unlike for Eϕ, the ﬂux is now an unknown function of s, and so the scaling with m is
undetermined. This yields the scaling the advection-dominated region:
k(cid:107) (cid:46) k4/3⊥ ,

m(k(cid:107), k⊥) ∼ k0(cid:107)k
E+

−11/3⊥ m−σ

(7.16)

in

where the exponent σ is unknown.

We now know E+

mk4/3⊥ (cid:46) k(cid:107) (7.13) and, except for
the m-dependence, in the advection-dominated region, k(cid:107) (cid:46) k4/3⊥ (7.16). We now need the
spectrum in the intermediate region between these two. To summarize,

m(k(cid:107), k⊥) in the streaming region,

√

E+

m(k(cid:107), k⊥) =

−11/3⊥ m−σ, k(cid:107) (cid:46) k4/3⊥ ,

k0(cid:107)k
ka(cid:48)(cid:107) kd(cid:48)⊥ m−σ(cid:48),
k−5(cid:107) k3⊥m−1/2,

k4/3⊥ (cid:46) k(cid:107) (cid:46) √
k(cid:107) (cid:38) √
mk4/3⊥ ,

mk4/3⊥ ,

(7.17)



for unknown exponents a(cid:48), d(cid:48), σ and σ(cid:48). Continuity of the spectrum across k(cid:107) ∼ k4/3⊥ and
k(cid:107) ∼ √

mk4/3⊥ gives the three constraints

a(cid:48) = −11 + 3d(cid:48)

σ(cid:48) = 3 +

a(cid:48)
2

,

σ = σ(cid:48),

,

4

(7.18)
where one of the four matching conditions is repeated. To determine d(cid:48), and hence the
other scalings, we consider the free energy cascade in the intermediate region. Unlike
previously, where the cascade is local in all wavenumbers, the rapid decay of ϕk with
parallel wavenumber (Eϕ ∼ k−5(cid:107) ) means the dominant coupling cannot be local in parallel
wavenumber space, as shown in SCHEKOCHIHIN ET AL. [181, Appendix B]. Instead the
dominant cascade is local in k⊥ but nonlocal in k(cid:107). Thus the free energy cascades in k⊥
only, so that

˜f 2
τnl

∼ k2⊥ϕ ˜f 2 ∼ fn(s, k(cid:107)),

=⇒

m(k(cid:107), k⊥) ∼ k
E+

−7/3⊥

,

(7.19)

143

where now it is the two-dimensional spectrum that behaves as k
, not the one-
dimensional spectrum as in (7.15). We therefore have d(cid:48) = −7/3, and so from (7.18),
we have a(cid:48) = −1 and σ = σ(cid:48) = 5/2.

−7/3⊥

Finally, we determine the spectrum of backwards propagating modes. The spectrum in
the advection region is determined in exactly the same way as the forward spectrum (7.16):
advection completely dominates streaming, and free energy cascades locally in Fourier
space, yielding the spectrum

k(cid:107) (cid:46) k4/3⊥ .

m(k(cid:107), k⊥) ∼ k0(cid:107)k
E−

−11/3⊥ m−σ(cid:48)(cid:48)

in

m spectrum, the E−

(7.20)
m spectrum only has one region for k(cid:107) (cid:38) k4/3⊥ .
However, unlike the E+
This is because there is no coupling of parallel wavenumbers in k(cid:107) (cid:38) k4/3⊥ , even in the
intermediate region where the nonlinear term is non-negligible. Thus there is no coupling
between the k(cid:107) > 0 and k(cid:107) < 0 modes which generates the backwards propagating modes
in (7.8). Therefore all we know in k(cid:107) (cid:38) k4/3⊥ , is that the spectrum decays like k3⊥ in the
limit k⊥ → 0, and we have

m(k(cid:107), k⊥) ∼ k3⊥ka(cid:48)(cid:48)(cid:107) m−σ(cid:48)(cid:48)(cid:48)
E−

in

k4/3⊥ (cid:46) k(cid:107).

(7.21)

The remaining coefﬁcients are all found by ensuring the spectrum in (7.20) and (7.21) is
continuous across k(cid:107) ∼ k4/3⊥ , yielding a(cid:48)(cid:48) = −5, σ(cid:48)(cid:48) = σ(cid:48)(cid:48)(cid:48) = 5/2.

In summary, we have derived the spectrum for the forward propagating modes,



E+

m(k(cid:107), k⊥) =

k(cid:107) (cid:46) k4/3⊥ ,

−11/3⊥ m−5/2,
−7/3⊥ m−5/2, k4/3⊥ (cid:46) k(cid:107) (cid:46) √
mk4/3⊥ ,

k0(cid:107)k
k−1(cid:107) k
k−5(cid:107) k3⊥m−1/2,

k(cid:107) (cid:38) √

mk4/3⊥ ,

(7.22)

(7.23)

(7.24)

backwards propagating modes,

E−
m(k(cid:107), k⊥) =

and for the electrostatic potential,

−11/3⊥ m−5/2, k(cid:107) (cid:46) k4/3⊥ ,
k(cid:107) (cid:38) k4/3⊥ ,

k−5(cid:107) k3⊥m−5/2,

Eϕ(k(cid:107), k⊥) =

−11/3⊥
k−5(cid:107) k3⊥,

, k(cid:107) (cid:46) k4/3⊥ ,
k(cid:107) (cid:38) k4/3⊥ .

k0(cid:107)k
k0(cid:107)k

144

(a)

(b)

Figure 7.1: The turbulence is isotropic in the perpendicular plane. (a) The spectrum of the
electrostatic potential summed over k(cid:107), against kx and ky; and (b) the electrostatic potential
summed over z, against x and y. In both plots there is no preferred direction.

7.2 Observed spectra

We now verify the above scaling laws using data from the same simulation introduced in
Chapter 6. We ﬁrst verify the assumptions used to derive the spectra—isotropy and critical
balance—and then present evidence for the scaling laws for Eϕ and E±
m.

7.2.1 Assumptions

We begin by verifying that the turbulence is isotropic. In Figure 7.1(a) we plot the electro-
static potential’s spectrum summed over k(cid:107) against kx and ky, and in Figure 7.1(b) we plot
the electrostatic potential averaged over z against x and y. The plots show no distinction
between the two perpendicular directions. The same behaviour is found throughout phase
space.

We next verify critical balance. As noted in §7.1.1, the consequence of the critical
balance causality argument is that the dominant k(cid:107) modes should satisfy k(cid:107) ∼ k4/3⊥ . In
Figure 7.2(a) we plot the amplitude of the electrostatic potential against k(cid:107) and (binned)
k⊥. To show the dominant scales, in Figure 7.2(b) we plot the amplitude of the electrostatic
|ϕk|2.
potential normalized to its maximum value at each ﬁxed k⊥, that is, |ϕk|2/ maxk(cid:107)
We also plot the line k(cid:107) = 100k4/3⊥ where the constant of proportionality was chosen to ﬁt
the dominant modes.

145

(a)

(b)

Figure 7.2: Critical balance for the electrostatic potential. (a) The electrostatic potential
against k(cid:107) and (binned) k⊥. (b) The same plot as (a), but normalized to the largest value for
each ﬁxed k⊥ (column). This selects the dominant k(cid:107) scale for each k⊥, which are marked
with crosses. The black line is the line of critical balance, k(cid:107) = 100k4/3⊥ , a ﬁt to these
dominant scales.

(a)

(c)

ϕ(k(cid:107)) = 2π(cid:80)

(cid:107)

(b)

(d)

ϕ (k⊥) = 2π(cid:80)

Figure 7.3: The spectra of the electrostatic potential Eϕ(k(cid:107), k⊥), summed over one di-
mension: (a) E
scaling; and (b)
E⊥
. Corresponding compensated
spectra are plotted in (c) and (d).

kx,ky k⊥ (cid:104)|ϕk|2(cid:105), showing the expected k−2(cid:107)

k(cid:107)

k⊥ (cid:104)|ϕk|2(cid:105), showing the expected k

−7/3⊥

146

7.2.2 Electrostatic potential

Having established isotropy, we now show spectra for the electrostatic potential as func-
tions of k(cid:107) and k⊥. We begin by deﬁning the one-dimensional spectra

E(cid:107)
ϕ(k(cid:107)) =

dk⊥ Eϕ(k(cid:107), k⊥),

E⊥
ϕ (k⊥) =

dk(cid:107) Eϕ(k(cid:107), k⊥).

(7.25)

Putting the theoretical spectrum (7.24) into these deﬁnitions and integrating over the
energy-containing advection-dominated region k(cid:107) (cid:46) k4/3⊥ gives
(cid:90) k4/3

(cid:90) ∞

ϕ(k(cid:107)) ∼
E(cid:107)

dk⊥ k0⊥k

−11/3⊥

∼ k−2(cid:107) ,

ϕ (k⊥) ∼
E⊥

dk(cid:107) k0⊥k

−11/3⊥

∼ k

.

−7/3⊥
(7.26)

(cid:90)

k3/4
(cid:107)

In Figure 7.3 we plot the discrete spectra

(cid:88)

kx,ky

E(cid:107)
ϕ(k(cid:107)) =

Eϕ(k(cid:107), k⊥),

E⊥
ϕ (k⊥) =

Eϕ(k(cid:107), k⊥),

(7.27)

which coincide with (7.25) on taking Eϕ(k(cid:107), k⊥) to be the piecewise constant function
obtained from simulations in a ﬁnite box. Both spectra are in excellent agreement with
their theoretical scaling (7.26).

We also plot the two-dimensional spectrum Eϕ(k(cid:107), k⊥) directly. Rewriting (7.24) in

terms of a single variable η = k4/3⊥ /k(cid:107), we obtain

(cid:90)

⊥

0

(cid:88)

k(cid:107)

and

k11/3⊥ Eϕ(k(cid:107), k⊥) =

k5(cid:107)k−3⊥ Eϕ(k(cid:107), k⊥) =

η5,

constant,
η−5,

constant,

1 (cid:46) η,
1 (cid:38) η,

1 (cid:46) η,
1 (cid:38) η.

(7.28)

(7.29)

Plotting these in Figure 7.4, we see two dimensional spectrum collapses onto a single line
with the expected scalings in η. This demonstrates that all points in the electrostatic poten-
tial satisfy the expected scalings.

7.2.3 Distribution function

We now verify the scaling laws for the spectra of the forwards and backwards propagat-
m (7.23). In the advection-dominated region, k(cid:107) (cid:46) k4/3⊥ , the
ing modes, E+

m (7.22) and E−

147

Figure 7.4: The two-dimensional spectrum Eϕ(k(cid:107), k⊥) as a function of the single variable
η = k4/3⊥ /k(cid:107). The whole spectrum collapses onto a single line, as predicted in (7.28) and
(7.29).

148

10-410-310-210-1η=k4/3/k10-910-810-710-610-510-410-310-210-1100101102103k11/3Eϕ(k,k)kη5η0048121620242832364010-410-310-210-1η=k4/3/k10410510610710810910101011101210131014k5k−3Eϕ(k,k)kη−5η00481216202428323640spectra have the same scalings, and indeed for there to be no free energy ﬂux, we must
m ≈ E−
m. However, in k(cid:107) (cid:38) k4/3⊥ the spectra differ. The forwards spectrum has
have E+
two regions: a phase-mixing dominated region k(cid:107) (cid:38) √
mk4/3⊥ , and an intermediate region
k4/3⊥ (cid:46) k(cid:107) (cid:46) √
mk4/3⊥ which bridges between the advection-dominated and phase-mixing
dominated regimes. This region becomes larger with increasing m. In contrast, the spec-
trum for backwards propagating modes only has one scaling in k(cid:107) (cid:38) k4/3⊥ .

7.2.3.1 Distribution function contours and normalized free energy transfer

m (in red) against k⊥ and k(cid:107) at
In Figure 7.5 we plot contours of E+
m = 2, m = 20 and m = 100. The contours are superimposed on the normalized free
energy transfer

m (in white) and E−

|ˆg+
m|2 − |ˆg−
m|2
m|2 + |ˆg−
|ˆg+
m|2

=

m − E−
≈ E+
m + E−
E+

m

m

.

(7.30)

(cid:112)(m + 1)/2 Im(ˆg∗
(cid:112)(m + 1)/2 |ˆgm|2

k(cid:107)vth

m+1ˆgm)

¯Γm =

Γm
ΓL
m

=

k(cid:107)vth

The plots in the left-hand column show computed spectra, while plots in the right-hand
column are produced using the theoretical spectra (7.22) and (7.23). The line of critical
balance k(cid:107) = 100k4/3⊥ that we determined earlier from the electrostatic potential is marked
in black. The expected behaviour is shown by the theoretical spectra in the right-hand
column. In the advection-dominated region k(cid:107) (cid:46) 100k4/3⊥ , the spectra are equal, E+
m = E−
m,
so ¯Γm = 0. Above the critical balance line, the contours separate with the contours of
E−
m slope upwards until
m immediately sloping downwards. In contrast, the contours of E+
mk4/3⊥ , and then slope downwards with
reaching the phase-mixing threshold, k(cid:107) = 100
the same gradient as E−
m so
¯Γm ≈ 1. As the theoretical spectra are discontinuous, all corners are sharp. Therefore
the contours separate rapidly at the critical balance line and there is a rapid transition from
¯Γm = 0 to ¯Γm ≈ 1. Notice that the theoretical spectra at small m (Figure 7.5(b)) also
predicts suppression of free energy transfer everywhere in phase space. This is because for
small m the contours do not fully separate so that ¯Γm is a constant that is noticeably less
than one.

m. Above the critical balance line, E+

m is much larger than E−

√

The computed spectra (in the left-hand column) replicate the key properties of the the-
oretical spectra, only now all transitions are slower since the computed spectra are smooth.
As before, the spectra coincide in the advection-dominated region, and separate at the line
of critical balance. The E−
m spectrum slopes downwards with the same gradient as the the-
oretical spectrum. The E+
m also has the correct downwards slope, but without the marked
upwards slope that appears in the theoretical spectrum. However this is the only difference
in their behaviours, which are otherwise in excellent agreement.

149

(a)

(b)

(c)

150

m (blue) and E−
m − E−
m)/(E+

m (green), superimposed on the nor-
Figure 7.5: Contours of the spectra E+
malized free energy transfer ¯Γm ≈ (E+
m + E−
m) for ﬁxed m: (a) m = 2,
(b) m = 20, (c) m = 100. Computed spectra are shown on the left, while theoretical
spectra from (7.22) and (7.23) are shown on the right. In the advection-dominated region
k(cid:107) (cid:46) 100k4/3⊥ (below the critical balance line in solid grey), contours of E+
m co-
incide and there is no free energy transfer, ¯Γm ≈ 0. Above the critical balance line, the
contours separate. Contours of E−
m slope downwards, while contours of E+
m continue up-
√
wards, before turning downwards at the phase-mixing threshold, k(cid:107) (cid:46) 100
mk4/3⊥ , the
m are not equal, there is a free energy transfer, ¯Γm (cid:54)= 0. For
dashed line. As E+
most m, the separation between contours is large, so that ¯Γm ≈ 1. For small m however
the separation is small, and ¯Γm < 1.

m and E−

m and E−

0.010.10.5k110100k1e-051e-041e-031e-021e-011e+001e+011e-051e-041e-031e-021e-011e+001e+01Computed, m=20.00.20.40.60.81.00.010.10.5k110100kTheoretical, m=20.00.20.40.60.81.00.010.10.5k110100k1e-051e-051e-041e-031e-021e-011e-051e-041e-031e-021e-01Computed, m=200.00.20.40.60.81.00.010.10.5k110100kTheoretical, m=200.00.20.40.60.81.00.010.10.5k110100k1e-051e-041e-031e-021e-051e-041e-031e-02Computed, m=1000.00.20.40.60.81.00.010.10.5k110100kTheoretical, m=1000.00.20.40.60.81.0We now verify the spectral exponents by plotting E+

m against one of k⊥, k(cid:107) and
m in Figures 7.6, 7.7 and 7.8 respectively, holding the other two variables ﬁxed. In each
m in the left- and right-hand columns respectively
Figure, we plot the spectra for E+
and, where possible, use the same axis limits for both plots.

m and E−

m and E−

7.2.3.2 E±

m versus k⊥

m and E−

In Figure 7.6, we plot E+
m against k⊥ at ﬁxed k(cid:107) and m. The colour indicates the
value of k(cid:107). The black lines are spectra at a ﬁxed k(cid:107) plotted against bin-averaged k⊥. From
top to bottom, the k(cid:107) values for these spectra are k(cid:107) = 4, k(cid:107) = 10, k(cid:107) = 20, k(cid:107) = 40 and
k(cid:107) = 60. The three rows show plots for m = 2, m = 100 and m = 160 respectively.

First consider the E−

−11/3⊥

m spectra (right column). The theoretical spectrum (7.23) has two
for k(cid:107) (cid:46) k4/3⊥ . While the
scalings, a spectrum like k3⊥ for k(cid:107) (cid:38) k4/3⊥ and like k
overall spectrum decreases like m−5/2, the shape of the spectrum in Fourier space does not
change with m. These properties are observed in the plots. The spectra are all alike, but
decrease in magnitude with m. All spectra behave like k3⊥ at low k⊥, and a there is a good
−11/3⊥
scaling at high k⊥ for the k(cid:107) = 4 and k(cid:107) = 10 spectra. Moreover, the maximum
k
points of these spectra agree well with their expected positions on the critical balance line,
k(cid:107) = 100k4/3⊥ .

m spectrum (7.22) is similar to E−

spectrum in the intermediate region k3/4(cid:107) m−3/8 (cid:46) k⊥ (cid:46) k3/4(cid:107)

m at low m, but at high m develops an additional
The E+
−7/3⊥
. We see this in the
k
calculated spectra in the left-hand column. At m = 2 (Figure 7.6(a)) the spectrum is
similar to that of E−
. As m increases, we no
longer see the k3⊥ behaviour at low k⊥, but rather see a k

2 , with two distinct scalings k3⊥ and k
−7/3⊥

−11/3⊥
spectrum develop.

7.2.3.3 E±

m versus k(cid:107)

k⊥. In each Figure we plot a selection of modes with different kx and ky with(cid:112)k2

We next plot the spectra against k(cid:107) at ﬁxed k⊥ and m in Figure 7.7. Colour denotes different
x + k2
y
approximately equal to the desired k⊥. For k⊥ = 0.01, we plot the mode (kx, ky) =
(0, 0.01), while for k⊥ = 0.2 and k⊥ = 0.4, we plot modes with wavenumbers in the range
[0.2, 0.21] and [0.4, 0.41] respectively. As before, different rows show different m: panel
(a) shows m = 2, (b) shows m = 20, and (c) shows m = 100.

The E−

m spectra (right column) exhibit the expected behaviour: each spectrum is ﬂat
for k(cid:107) (cid:46) k4/3⊥ , and has a k−5(cid:107) decay for k(cid:107) (cid:38) k4/3⊥ . As with Figure 7.6, only the overall
amplitude of each spectrum depends on m, and the three Figures in the right column are
essentially the same plots but with different amplitudes.

151

(a)

(b)

(c)

152

m (left column) and E−

Figure 7.6: Spectra of E+
m (right column) against k⊥ at ﬁxed k(cid:107) and
m: (a) m = 2, (b) m = 100, (c) m = 160. Values of k(cid:107) are shown in the colour bar. The ﬁve
black lines on each plot are bin-averaged spectra at ﬁxed k(cid:107): from top to bottom, k(cid:107) = 4,
k(cid:107) = 10, k(cid:107) = 20, k(cid:107) = 40 and k(cid:107) = 60. The E−
m spectrum (7.23) has the same scaling
in Fourier space for each m, so each row shows the same behaviour but with a different
overall amplitude. For k(cid:107) (cid:38) k4/3⊥ , E−
. The
m ∼ k3⊥
positive spectrum (7.22) also scales as E+
scaling is conﬁned to k(cid:107) (cid:38) √
mk4/3⊥ , we see
m ∼ k
E+

m ∼ k3⊥, while for k(cid:107) (cid:46) k4/3⊥ , E−
m ∼ k
mk4/3⊥ . Between these regions, k4/3⊥ (cid:46) k(cid:107) (cid:46) √

−11/3⊥
for k(cid:107) (cid:46) k4/3⊥ , but now the E+

m ∼ k

−11/3⊥

−7/3⊥

develop in the high m plots.

10-210-1k10-410-310-210-1100101102103104E+2=2πk|˜g+2|2kk−11/3k3E+m at m=20122436486010-210-1k10-410-310-210-1100101102103104E−2=2πk|˜g−2|2kk−11/3k3E−m at m=20122436486010-210-1k10-510-410-310-210-1100101E+100=2πk|˜g+100|2kk−11/3k−7/3E+m at m=1000122436486010-210-1k10-810-710-610-510-410-310-210-1100101E−100=2πk|˜g−100|2kk−11/3k3E−m at m=1000122436486010-210-1k10-610-510-410-310-210-1100E+160=2πk|˜g+160|2kk−11/3k−7/3E+m at m=1600122436486010-210-1k10-910-810-710-610-510-410-310-210-1E−160=2πk|˜g−160|2kk−11/3k3E−m at m=16001224364860(a)

(b)

(c)

m (left column) and E−

such that(cid:112)k2

Figure 7.7: Spectra of E+
m (right column) against k(cid:107) at ﬁxed k⊥ and
m: (a) m = 2, (b) m = 20, (c) m = 100. Colour denotes selections of modes with kx, ky
m (7.23)
m ∼ k0(cid:107)
mk4/3⊥ ,

y approximately equals the given k⊥. The negative spectrum E−
in k(cid:107) (cid:38) k4/3⊥ and E−
in k(cid:107) (cid:38) √
m ∼ k−5(cid:107)

m ∼ k−5(cid:107)

x + k2

has two scalings, shown by the dashed guidelines: E−
in k(cid:107) (cid:46) k4/3⊥ . The positive spectrum (7.22) has three regions: E+
m ∼ k−1(cid:107)
m ∼ k0(cid:107) in k(cid:107) (cid:46) k4/3⊥ .
E+

in k4/3⊥ (cid:46) k(cid:107) (cid:46) √

mk4/3⊥ , and E+

153

The E+

m spectra also have k0(cid:107) and k−5(cid:107)

in Figure 7.7. In addition, there should also be a k−1(cid:107)
k4/3⊥ (cid:46) k(cid:107) (cid:46) √

scalings at low and high k(cid:107) respectively, as shown
scaling in the intermediate region
mk4/3⊥ . Figures 7.7(b) and (c) are not inconsistent with this scaling, but the

spectra are too noisy to provide convincing evidence.

m versus m

7.2.3.4 E±
In Figure 7.8 we plot the spectra E±
m against m. As before, we group together by colour
spectra which have the same k⊥ (but different kx and ky). We show data for the perpen-
dicular wavenumbers k⊥ = 0.01, k⊥ = 0.2 and k⊥ = 0.4. Each row of ﬁgures is for a
different parallel wavenumber: panel (a) shows k(cid:107) = 4, (b) shows k(cid:107) = 20, and (c) shows
k(cid:107) = 40.

As expected from (7.22), the E+

m spectrum (left-hand column) has a m−5/2 scaling in
the intermediate and advection-dominated regions, and a m−1/2 scaling in the phase-mixing
region.

The E−

m spectrum should have a universal m−5/2 scaling. This is seen almost every-
where in the right-hand column of Figure 7.8. However a m−1/2 spectrum is also observed
above the phase-mixing threshold k(cid:107) (cid:38) √
mk4/3⊥ , at high k(cid:107), low m, and low k⊥. This may
be due to the fact that the decomposition into forwards and backwards propagating modes
˜g±
m is only asymptotic for large m, and hence less accurate at low m. Thus the scaling could
m ∼ m−1/2 spectrum in the phase-mixing region, particularly since
be an artifact from the E+
m (cid:29) E−
m in this region.
E+

7.2.3.5 E−

m versus η = k4/3⊥ /k(cid:107)

m = 2πk⊥(cid:104)|˜g−

Finally, we note from equations (7.23) and (7.24) that the spectrum of backwards propagat-
m = m−5/2Eϕ.
ing modes E−
Therefore, like Eϕ in (7.29), E−
m can be expressed in terms of the single variable η =
k4/3⊥ /k(cid:107) as

m|2(cid:105) is simply related to the spectrum of ϕ by E−

and

k11/3⊥ m5/2E−

m(k(cid:107), k⊥) =

k5(cid:107)k−3⊥ m5/2E−

m(k(cid:107), k⊥) =

154

η5,

constant,
η−5,

constant,

1 (cid:46) η,
1 (cid:38) η,

1 (cid:46) η,
1 (cid:38) η.

(7.31)

(7.32)

(a)

(b)

(c)

155

m (left column) and E−

x + k2

y approximately equals the given k⊥. The positive spectrum E+

Figure 7.8: Spectra of E+
m (right column) against m at ﬁxed k⊥ and
k(cid:107): (a) k(cid:107) = 4, (b) k(cid:107) = 20, (c) k(cid:107) = 40. Colour denotes selections of modes with kx, ky
m (7.22)
mk4/3⊥ , and
m (7.23) has a universal m−5/2
mk4/3⊥ . This may be an
m, as the decomposition into forwards and backwards propagating modes is

such that(cid:112)k2
has two scalings shown by the dashed guide lines: E+
m ∼ m−1/2 in k(cid:107) (cid:38) √
E+
scaling; however we observe regions where E−
artifact from E+
only asymptotic at large m and so less accurate at low m.

m ∼ m−5/2 in k(cid:107) (cid:46) √

mk4/3⊥ . The negative spectrum E−

m ∼ m−1/2 in k(cid:107) (cid:38) √

Figure 7.9: Spectrum of E−
m against η = k4/3⊥ /k(cid:107). These are similar spectra to those for Eϕ
in Figure 7.4, but now include all of velocity space. There is a collapse onto a single line
for m (cid:38) 40, indicating that for these m, the distribution function satisﬁes the scaling law
(7.23).

156

10-410-310-210-1η=k4/3/k10-1010-910-810-710-610-510-410-310-210-1100101102m5/2k11/32πk|˜g−m|2mη5η040506070809010011010-410-310-210-1η=k4/3/k10410510610710810910101011101210131014m5/2k5k−32πk|˜g−m|2mη−5η0405060708090100110We plot this in Figure 7.9 with colours denoting different m in the range [40, 110], i.e. above
the decomposition artifacts at low m, but below the dissipation range. The distribution
function collapses onto a single line, indicating that the computed spectrum satisﬁes the
scaling law (7.23).

7.2.3.6 Summary

In summary, the results presented support the theoretical spectra (7.22), (7.23) and (7.24)
derived by SCHEKOCHIHIN ET AL. [181]. The assumptions of the derivation—isotropy
and critical balance—are satisﬁed. The observed Eϕ spectrum is in strong agreement with
the theoretical spectrum (7.24). Indeed, the two-dimensional spectrum collapses onto a
single line as a function of the similarity variable η = k4/3⊥ /k(cid:107), showing that the whole
spectrum is in agreement with the expected scalings. The distribution function spectra E±
are also in good agreement with the theoretical spectra (7.22) and (7.23). The spectrum E−
m
for negative modes is in very good agreement with the scalings, and the whole spectrum
m for pos-
collapses onto the expected function of a single variable (7.31). The spectrum E+
itive modes is expected to have three distinct scaling regions. The results do not contradict
this picture, but we ﬁnd no clear evidence for the intermediate region. This is most likely
because computed spectra transition smoothly between the different scaling regions rather
than changing sharply as the theoretical spectra have been assumed to do. To see the inter-
mediate region, we would therefore require more resolution than available in these already
well-resolved simulations. Overall however these results are good evidence for the scalings
proposed by SCHEKOCHIHIN ET AL. [181].

m

157

Chapter 8

Conclusion

In this thesis we have developed the theory of a fully spectral Fourier–Hankel–Hermite
representation for the coupled gyrokinetic-Maxwell equations that describe a strongly mag-
netised fusion plasma in Cartesian slab geometry, implemented the resulting equations in
SPECTROGK, a code in Fortran 90 + MPI designed for efﬁciency on modern High Per-
formance Computing platforms, and used simulations with SPECTROGK to fundamentally
change our understanding of saturated drift-kinetic turbulence.

After deriving the gyrokinetic-Maxwell system in Chapter 2, we studied parallel veloc-
ity space in Chapter 3. The most important effect in this dimension is Landau damping,
a mechanism by which perturbations to the electric ﬁeld decay in the absence of explicit
dissipation. Landau damping is caused by particle streaming, the phase space shear v(cid:107)∂zg
which causes inﬁnitesimally ﬁne scales to form in the distribution function. While the dis-
tribution function itself does not decay, its velocity space moments, like the electrostatic
potential ϕ, do decay due to integrating over the distribution function’s ﬁne scale structure.
Landau damping is derived via a Laplace transform in time, so the distribution function is
not a time eigenmode of the system. Rather, the time eigenmodes are singular non-decaying
functions, called the Case–Van Kampen modes, which form a continuous spectrum.

The velocity space behaviour changes with the inclusion of any amount of collisions.
Fokker–Planck-type collision operators, like the Lenard–Bernstein and Kirkwood operators
discussed in §3.2.2, contain velocity space diffusion which smooths the ﬁnest scales in the
distribution function. Time eigenmodes of the collisional system are now square integrable
and smooth, unlike the eigenmodes of the collisionless system. Moreover, as ﬁner and ﬁner
scales form in velocity space, the effect of velocity space diffusion remains ﬁnite, even as
the diffusivity tends to zero. Landau’s choice of contour (see Figure 3.1(a)) captures this
limit without explicitly introducing collisions.

The velocity space behaviour changes again when the system is discretized, as dis-
cretization imposes a ﬁnest resolvable velocity scale. Now discrete analogues of smooth

158

solutions are found only if collisions are sufﬁciently strong to make the solution resolvable
on the discretization grid; otherwise the solutions are discrete approximations to the singu-
lar Case–Van Kampen modes. The Landau-damped solution is still found in the limit of
vanishing collisions, but only in the simultaneous limit of inﬁnite resolution.

The Hermite representation introduced in Chapter 3 provides a neat formalism for par-
allel velocity space. The mth order Hermite polynomial has a characteristic velocity scale
√
m, so that each coefﬁcient in the expansion represents a different velocity space
vth/
scale. The square of each coefﬁcient represents that scale’s contribution to the free energy.
Moreover, the electrostatic potential is proportional to the zeroth order coefﬁcient. Colli-
sions, which act preferentially at ﬁne velocity scales, are represented by a damping of the
high m coefﬁcients. The streaming term becomes a nearest neighbour mode-coupling in
m. The streaming results in a transfer of free energy in Hermite space, analogous to the
nonlinear cascade of free energy due to the u · ∇u term in hydrodynamic turbulence. Un-
like the nonlinear cascade, however, this transfer is linear and reversible. The linear Landau
damping solution corresponds to a forward cascade of free energy towards inﬁnitesimally
ﬁne scales. The forwards direction is set by the presence of some small collisionality that
dissipates free energy at sufﬁciently ﬁne scales. In contrast, the backwards cascade is only
observed in the linear gyrokinetic-Maxwell system which has been discretized (has a ﬁ-
nite range of m) and has an inadequate treatment of the cut-off at the highest m. Indeed,
the backwards cascade appears in recurrence, the unphysical scenario where free energy
reﬂects from the ﬁnest resolved scales and propagates backwards towards large scales, ul-
timately causing the damped electric ﬁeld to suddenly grow.

In Chapter 3, we develop the theory of the hypercollisional operator—an iterated ver-
sion of the Kirkwood collision operator (the momentum and energy conserving version of
the Lenard–Bernstein operator). It is particularly simple to apply in Hermite space, as the
Hermite functions are its eigenfunctions. The hypercollisional operator selectively damps
the high m which represent ﬁne velocity space scales, ensuring that there is no reﬂection
at the highest retained m and thus no recurrence. With this operator, accurate Landau
growth rates are calculated, even with modest resolution. Moreover, the operator exhibits
a “plateau” in parameter space, a region where the calculated result is accurate and in-
sensitive to changes in collision frequency, hypercollision exponent and resolution. This
not only makes the operator of great practical value—it is easy to ﬁnd suitable parame-
ter values—but it also provides a numerical analog of the plateau found in the analytical
solution of the collisionless limit of the weakly collisional problem.

Determining the electrostatic potential is straightforward in Fourier–Hermite space as
integrals over parallel velocity space become evaluations of the coefﬁcients of single modes

159

due to the orthogonality of the basis functions. Trying to achieve the same phase space
localization motivates the use of the Hankel representation in perpendicular velocity. In
Chapter 4 we show that Maxwell’s equations are local in Fourier–Hankel–Hermite space,
that is, ϕ, A(cid:107) and B(cid:107) are determined from single modes. Moreover in the linearized
gyrokinetic-Maxwell system there is no coupling at all between Fourier and Hankel modes;
the equations reduce to the one-dimensional problem in Hermite space studied in Chapter
3, parameterized by k and p = ρik⊥.

In the nonlinear gyrokinetic-Maxwell system there is coupling of Fourier and Hankel
modes through the nonlinear term. However there remains an interesting localization of
phase space, where the evolution of any one Fourier–Hankel mode depends on a limited
range of other Fourier–Hankel modes. We discussed methods of exploiting this property
in gyrokinetics, but concluded that these would not improve upon pseudospectral methods
for the drift-kinetic problem studied in Chapters 6 and 7.

In Chapter 5 we tested and veriﬁed SPECTROGK. SPECTROGK is the main practical
outcome of this thesis. It is a versatile code which runs and scales across many systems,
from laptops to High Performance Computing platforms. Because of its spectral approach,
it makes efﬁcient use of memory, and exactly conserves free energy transfers between
modes in the absence of explicit dissipation. SPECTROGK has proven useful for studying
Vlasov–Poisson turbulence, as in PARKER & DELLAR [145], and for drift-kinetic turbu-
lence, as in Chapters 6 and 7.

In drift-kinetic turbulence, there are two mechanisms by which free energy injected at
large scales (by forcing or an instability like a temperature gradient) can be transferred to
dissipation. Firstly, free energy may be transfered linearly by phase-mixing to dissipation
by collisions at ﬁne parallel velocity space scales, as discussed in Chapter 3. Alternatively,
it may cascade nonlinearly in Fourier space to dissipation by viscosity at ﬁne physical
scales, as in hydrodynamic turbulence. Each cascade was understood in isolation, but it was
unclear how they interacted. In particular, BARNES ET AL. [165] had derived the spectrum
for the electrostatic potential observed in simulations, but to do so had to neglect the transfer
of free energy to ﬁne velocity space scales. This is despite other authors observing ﬁne
velocity space structure, and so some free energy is indeed present at ﬁne scales [96, 140].
In Chapter 6 we showed the startling result that in saturated nonlinear turbulence, the
nonlinear term inhibits, and at energetically-dominant scales completely suppresses, the
transfer of free energy by linear phase-mixing. It does this by exciting backwards propa-
gating modes, like those observed in recurrence in Chapter 3. Here however the effect is
entirely physical and self-generated by the turbulence, rather than by an artiﬁcial numeri-
cal boundary condition. The suppression of net free energy ﬂux has two important conse-

160

quences. Firstly, the turbulence is largely ﬂuid, with free energy at the dominant scales only
cascading to ﬁne scales in physical space. Secondly, as little free energy reaches ﬁne scales
in velocity space, Landau damping is strongly suppressed as a dissipation mechanism.

In Chapter 7, we derived scaling laws for the spectra of the distribution function
and electrostatic potential
in drift-kinetic turbulence, verifying these scalings with
SPECTROGK. The most signiﬁcant feature of these results is that the spectra of the elec-
trostatic potential and the backwards propagating modes may both be written in terms of
the single variable η = k4/3⊥ /k(cid:107) = τs/τnl. Thus the ratio of timescales not only determines
whether linear or nonlinear behaviour is dominant in a region of phase space, it is itself a
similarity variable for much of the solution.

8.1 Future work

There are a number of exciting directions in which we will take this work. Firstly, in Chap-
ters 6 and 7 we studied the essentially four-dimensional case of drift-kinetic turbulence.
It is natural to next study ﬁve-dimensional gyrokinetic turbulence, i.e. extend the spatial
domain to include sub-Larmor scales. In addition to parallel phase-mixing and the non-
linear cascade in Fourier space, at sub-Larmor scales there is also a nonlinear cascade in
perpendicular velocity space. We will extend the scaling theory derived in Chapter 7 to
incorporate this cascade. As we noted in Chapter 4, there already exists a scaling theory
for “two-dimensional” gyrokinetic turbulence (turbulence in the perpendicular plane only,
with no parallel phase-mixing). This theory could be immediately applied to sub-Larmor
scales in ﬁve-dimensional gyrokinetics, provided there is signiﬁcant suppression of net free
energy transfer to ﬁne parallel velocity space scales. To determine if this is the case requires
simulations; but these simulations would be very costly due to the increased size of Fourier
space. However it seems likely that the same mechanism as in drift kinetics—the nonlinear
term exciting backwards propagating modes by coupling parallel wavenumbers—should
also apply at sub-Larmor scales. Indeed, the only difference in the nonlinear term between
drift-kinetics and gyrokinetics is a factor of J0(ρik⊥v⊥) from the gyroaverage of the elec-
trostatic potential (see equation (5.11a)). This will change the regions of phase space where
there is suppression of free energy transfer, but not the underlying mechanism. Indeed, in
this thesis we have developed the analytical framework required for determining the phase
space structure of gyrokinetics, and we will be able to make deductions about free energy
transfer and dissipation in gyrokinetics as we did for drift kinetics in Chapter 6.

We will also investigate ﬂuid models for the perpendicular velocity cascade. In Chapter
4, we discussed the importance of the phase space line p = ρik⊥; it is the peak of the

161

spectrum in two-dimensional gyrokinetics, and is likely also the peak in ﬁve-dimensional
gyrokinetics. By omitting grid points further away from p = ρik⊥ in (k⊥, p) phase space
than some distance r, we derived a family of ﬂuid-like models parameterized by r. We
will investigate if these low resolution (small r) models replicate the behaviour of the full
kinetic system (r → ∞). If so, the O(100) perpendicular velocity space grid points needed
in computing gyrokinetic turbulence may be reduced to just a few Hankel modes. This is
a novel approach to producing ﬂuid models, and we will compare the resulting family of
models to existing gyroﬂuid models.

Further, we will use the suppression of net free energy transfer as a parallel velocity
space closure condition for ﬂuid models. In parallel velocity space, we may think of a ﬂuid
model as replacing the O(100) “kinetic” (high m) Hermite modes with a closure which
deﬁnes g3 (the ﬁrst kinetic mode) in terms of the ﬂuid modes g0, g1 and g2. In its crudest
form, one might imagine imposing no net free energy ﬂux in the advection region and free
energy ﬂux as in the linear case in the phase-mixing region. That is, at each timestep setting
|g3| = |g2| with phases that satisfy Im(g∗
3g2) = 1 for
k(cid:107) (cid:38) Ak4/3⊥ , where A, the constant in the line of critical balance, is determined from full
kinetic simulations. This closure reduces parallel velocity space from the O(100) modes
of the kinetic system to a three mode ﬂuid system.

3g2) = 0 for k(cid:107) (cid:46) Ak4/3⊥ , and Im(g∗

Taken together, these two velocity space models may retain the key features of the

gyrokinetic system, while offering a reduction in resolution of O(104).

Finally, in this thesis we have studied electrostatic turbulence in slab geometry. To make
this work applicable for fusion, we need to include both electromagnetic effects and toroidal
geometry. SPECTROGK can treat electromagnetic problems in slab geometry (as described
in Chapter 5), but the Hankel space/perpendicular velocity space representation needs to be
amended to treat the trapped and passing particles which arise in toroidal geometry.

162

Part IV

Appendices

163

Appendix A

Fourier–Hermite spectral representation
for the Vlasov–Poisson system in the
weakly collisional limit
J. T. Parker and P. J. Dellar

This paper, Ref. [145], is omitted in the arXiv version.

164

Appendix B

Irreversible energy ﬂow in forced Vlasov
dynamics
G. G. Plunk and J. T. Parker

This paper, Ref. [94], is omitted in the arXiv version.

165

Bibliography

[1] U.S. ENERGY INFORMATION ADMINISTRATION (2015) International Energy
Statistics. http://www.eia.gov/cfapps/ipdbproject, accessed: 14-1-
2015.

[2] BP (2014) BP Statistical Review of World Energy. http://www.bp.

com/en/global/corporate/about-bp/energy-economics/
statistical-review-of-world-energy.html.

[3] ENVIRONMENTAL AUDIT COMMITTEE (2013) Energy subsidies. House of Com-

mons, Ninth Report of Session 2013-14, paper 61.

[4] COOK, I., MARBACH, G., DI PACE, L., GIRARD, C. & TAYLOR, N. P. (2001)
Safety and environmental impact of fusion. European Fusion Development Agree-
ment (EFDA) Report EFDA-S-RE-1. EUR (01) CCE-FU FTC .

[5] NUTTALL, W. J., CLARKE, R. H. & GLOWACKI, B. A. (2012) Resources: Stop

squandering helium. Nature 485, 573–575.

[6] IKEDA, K. (2010) ITER on the road to fusion energy. Nuclear Fusion 50, 014002.

[7] REBHAN, E. & VAN OOST, G. (2002) Thermonuclear burn criteria. Fusion Science

and Technology 41, 15–26.

[8] MAISONNIER, D., CAMPBELL, D., COOK, I., DI PACE, L., GIANCARLI, L.,
HAYWARD, J., PUMA, A. L., MEDRANO, M., NORAJITRA, P., ROCCELLA, M.
ET AL. (2007) Power plant conceptual studies in Europe. Nuclear Fusion 47, 1524.

[9] HIGHCOCK, E. G. (2012) The zero-turbulence manifold in fusion plasmas. Doctoral

thesis, University of Oxford.

[10] ONGENA, J. & VAN OOST, G. (2008) Energy for future centuries-prospects for

fusion power as a future energy source. Fusion Science and Technology 53, 3–15.

166

[11] HASTIE, R. J. (1995) Plasma particle dynamics. In Plasma Physics: An Introduc-

tory Course. Cambridge: Cambridge University Press.

[12] HELANDER, P. & SIGMAR, D. J. (2002) Collisional Transport in Magnetized Plas-

mas. Cambridge: Cambridge University Press.

[13] HINTON, F. L. & WONG, S. K. (1985) Neoclassical ion transport in rotating ax-

isymmetric plasmas. Physics of Fluids 28, 3082–3098.

[14] GALAMBOS, J. D., PERKINS, L. J., HANEY, S. W. & MANDREKAS, J. (1995)
Commercial tokamak reactor potential with advanced tokamak operation. Nuclear
Fusion 35, 551.

[15] COLAS, L., ZOU, X. L., PAUME, M., CHAREAU, J. M., GUIZIOU, L., HOANG,
G. T., MICHELOT, Y. & GR ´ESILLON, D. (1998) Internal magnetic ﬂuctuations and
electron heat transport in the tore supra tokamak: Observation by cross-polarization
scattering. Nuclear Fusion 38, 903.

[16] HORTON, W. & ESTES, R. D. (1980) Fluid simulation of ion pressure gradient

driven drift modes. Plasma Physics 22, 663.

[17] WALTZ, R. E. (1988) Three-dimensional global numerical simulation of ion tem-

perature gradient mode turbulence. Physics of Fluids 31, 1962–1967.

[18] FONCK, R. J., HOWELL, R., JAEHNIG, K., ROQUEMORE, L., SCHILLING, G.,
SCOTT, S., ZARNSTORFF, M. C., BUSH, C., GOLDSTON, R., HSUAN, H., JOHN-
SON, D., RAMSEY, A., SCHIVELL, J. & TOWNER, H. (1989) Ion thermal conﬁne-
ment in the enhanced-conﬁnement regime of the TFTR tokamak. Physical Review
Letters 63, 520–523.

[19] WOOTTON, A. J., CARRERAS, B. A., MATSUMOTO, H., MCGUIRE, K., PEE-
BLES, W. A., RITZ, C. P., TERRY, P. W. & ZWEBEN, S. J. (1990) Fluctuations
and anomalous transport in tokamaks. Physics of Fluids B 2, 2879–2903.

[20] COWLEY, S. C., KULSRUD, R. M. & SUDAN, R. (1991) Considerations of ion-

temperature-gradient-driven turbulence. Physics of Fluids B 3, 2767–2782.

[21] KOTSCHENREUTHER, M., DORLAND, W., BEER, M. A. & HAMMETT, G. W.
(1995) Quantitative predictions of tokamak energy conﬁnement from ﬁrst-principles
simulations with kinetic effects. Physics of Plasmas 2, 2381–2389.

167

[22] CARRERAS, B. A. (1997) Progress in anomalous transport research in toroidal mag-

netic conﬁnement devices. IEEE Transactions on Plasma Science 25, 1281–1321.

[23] DIMITS, A. M., BATEMAN, G., BEER, M. A., COHEN, B. I., DORLAND, W.,
HAMMETT, G. W., KIM, C., KINSEY, J. E., KOTSCHENREUTHER, M., KRITZ,
A. H. ET AL. (2000) Comparisons and physics basis of tokamak transport models
and turbulence simulations. Physics of Plasmas 7, 969.

[24] DORLAND, W., JENKO, F., KOTSCHENREUTHER, M. & ROGERS, B. N. (2000)
Electron temperature gradient turbulence. Physical Review Letters 85, 5579–5582.

[25] JENKO, F., DORLAND, W., KOTSCHENREUTHER, M. & ROGERS, B. N. (2000)
Electron temperature gradient driven turbulence. Physics of Plasmas 7, 1904–1910.

[26] DANNERT, T. & JENKO, F. (2005) Gyrokinetic simulation of collisionless trapped-

electron mode turbulence. Physics of Plasmas 12, 072309.

[27] ITER ORGANIZATION WEBSITE (2015) http://www.iter.org/, accessed:

16-1-2015.

[28] KROMMES, J. A. (2012) The gyrokinetic description of microturbulence in magne-

tized plasmas. Annual Review of Fluid Mechanics 44, 175–201.

[29] MIURA, Y. & JT-60 TEAM (2003) Study of improved conﬁnement modes with edge
and/or internal transport barriers on the Japan Atomic Energy Research Institute
Tokamak-60 Upgrade (JT-60U). Physics of Plasmas 10, 1809–1815.

[30] DE VRIES, P. C., JOFFRIN, E., BRIX, M., CHALLIS, C. D., CROMB ´E, K., ESPOS-
ITO, B., HAWKES, N. C., GIROUD, C., HOBIRK, J., L ¨ONNROTH, J., MANTICA,
P., STRINTZI, D., TALA, T., VOITSEKHOVITCH, I. & JET-EFDA CONTRIBU-
TORS TO THE WORK PROGRAMME (2009) Internal transport barrier dynamics with
plasma rotation in JET. Nuclear Fusion 49, 075007.

[31] HIGHCOCK, E. G., SCHEKOCHIHIN, A. A., COWLEY, S. C., BARNES, M.,
PARRA, F. I., ROACH, C. M. & DORLAND, W. (2012) Zero-turbulence manifold
in a toroidal plasma. Physical Review Letters 109, 265001.

[32] CHAPMAN, S. & COWLING, T. G. (1991) The Mathematical Theory of Non-

Uniform Gases. Cambridge: Cambridge University Press.

168

[33] BURNETT, D. (1935) The distribution of velocities in a slightly non-uniform gas.

Proceedings of the London Mathematical Society s2-39, 385–430.

[34] BURNETT, D. (1936) The distribution of molecular velocities and the mean motion
in a non-uniform gas. Proceedings of the London Mathematical Society s2-40, 382–
435.

[35] ABEL, I. G., PLUNK, G. G., WANG, E., BARNES, M., COWLEY, S. C., DOR-
LAND, W. & SCHEKOCHIHIN, A. A. (2013) Multiscale gyrokinetics for rotating
tokamak plasmas: ﬂuctuations, transport and energy ﬂows. Reports on Progress in
Physics 76, 116201.

[36] RUTHERFORD, P. H. & FRIEMAN, E. A. (1968) Drift instabilities in general mag-

netic ﬁeld conﬁgurations. Physics of Fluids 11, 569–585.

[37] TAYLOR, J. B. & HASTIE, R. J. (1968) Stability of general plasma equilibria—I

formal theory. Plasma Physics 10, 479–494.

[38] JOLLIET, S., BOTTINO, A., ANGELINO, P., HATZKY, R., TRAN, T. M., MCMIL-
LAN, B. F., SAUTER, O., APPERT, K., IDOMURA, Y. & VILLARD, L. (2007) A
global collisionless PIC code in magnetic coordinates. Computer Physics Commu-
nications 177, 409–425.

[39] HAMMETT, G. W., DORLAND, W. & PERKINS, F. W. (1992) Fluid models of
phase mixing, Landau damping, and nonlinear gyrokinetic dynamics. Physics of
Fluids B 4, 2052.

[40] DORLAND, W. & HAMMETT, G. W. (1993) Gyroﬂuid turbulence models with ki-

netic effects. Physics of Fluids B 5, 812–835.

[41] HAMMETT, G. W., BEER, M. A., DORLAND, W., COWLEY, S. C. & SMITH, S. A.
(1993) Developments in the gyroﬂuid approach to tokamak turbulence simulations.
Plasma Physics and Controlled Fusion 35, 973.

[42] HAMMETT, G. W. & PERKINS, F. W. (1990) Fluid moment models for Landau
damping with application to the ion-temperature-gradient instability. Physical Re-
view Letters 64, 3019–3022.

[43] BARNES, M., ABEL, I. G., DORLAND, W., G ¨ORLER, T., HAMMETT, G. W. &
JENKO, F. (2010) Direct multiscale coupling of a transport code to gyrokinetic tur-
bulence codes. Physics of Plasmas 17, 056109.

169

[44] SCHEKOCHIHIN, A. A., COWLEY, S. C., DORLAND, W., HAMMETT, G. W.,
HOWES, G. G., QUATAERT, E., & TATSUNO, T. (2009) Astrophysical gyrokinet-
ics: kinetic and ﬂuid turbulent cascades in magnetized weakly collisional plasmas.
Astrophysical Journal Supplement Series 182, 310–377.

[45] ALFV ´EN, H. & F ¨ALTHAMMAR, C.-G. (1950) Cosmical Electrodynamics. Oxford:

Clarendon Press.

[46] CATTO, P. J. (1978) Linearized gyro-kinetics. Plasma Physics 20, 719.

[47] ANTONSEN, T. M. & LANE, B. (1980) Kinetic equations for low frequency insta-

bilities in inhomogeneous plasmas. Physics of Fluids 23, 1205–1214.

[48] CATTO, P. J., TANG, W. M. & BALDWIN, D. E. (1981) Generalized gyrokinetics.

Plasma Physics 23, 639.

[49] FRIEMAN, E. A. & CHEN, L. (1982) Nonlinear gyrokinetic equations for low-
frequency electromagnetic waves in general plasma equilibria. Physics of Fluids 25,
502–508.

[50] CATTO, P. J., BERNSTEIN, I. B. & TESSAROTTO, M. (1987) Ion transport in

toroidally rotating tokamak plasmas. Physics of Fluids 30, 2784–2795.

[51] DUBIN, D. H. E. (1983) Nonlinear gyrokinetic equations. Physics of Fluids 26,

3524.

[52] HAHM, T. S., LEE, W. W. & BRIZARD, A. (1988) Nonlinear gyrokinetic theory

for ﬁnite-beta plasmas. Physics of Fluids 31, 1940.

[53] BRIZARD, A. J. & HAHM, T. S. (2007) Foundations of nonlinear gyrokinetic the-

ory. Reviews of Modern Physics 79, 421.

[54] GARBET, X., IDOMURA, Y., VILLARD, L. & WATANABE, T. H. (2010) Gyroki-

netic simulations of turbulent transport. Nuclear Fusion 50, 043002.

[55] HOWES, G. G., COWLEY, S. C., DORLAND, W., HAMMETT, G. W., QUATAERT,
E. & SCHEKOCHIHIN, A. A. (2006) Astrophysical Gyrokinetics: Basic Equations
and Linear Theory. The Astrophysical Journal 651, 590–614.

[56] NUMATA, R., HOWES, G. G., TATSUNO, T., BARNES, M. & DORLAND,
W. (2010) AstroGK: Astrophysical gyrokinetics code. Journal of Computational
Physics 229, 9347–9372.

170

[57] DORLAND, W., HIGHCOCK, E. G., BARNES, M., HAMMETT, G. W., NUMATA,
R., TATSUNO, T., ROACH, C., COLYER, G., BAUMGAERTEL, J. & DICKINSON,
D. (2009) Gyrokinetic simulations project. See http://gyrokinetics.sourceforge.net/.

[58] LANDAU, L. D. (1946) On the Vibrations of the Electronic Plasma. Journal of

Physics-U.S.S.R. 10.

[59] VAN KAMPEN, N. G. (1955) On the theory of stationary waves in plasmas. Physica

21, 949–963.

[60] CASE, K. M. (1959) Plasma oscillations. Annals of Physics 7, 349–364.

[61] TEMME, N. M. (1996) Special Functions: An Introduction to the Classical Func-

tions of Mathematical Physics. New York: Wiley.

[62] HIGHCOCK, E. G., BARNES, M., PARRA, F. I., SCHEKOCHIHIN, A. A., ROACH,
C. M. & COWLEY, S. C. (2011) Transport bifurcation induced by sheared toroidal
ﬂow in tokamak plasmas. Physics of Plasmas 18, 102304.

[63] DANNERT, T. & JENKO, F. (2004) Vlasov simulation of kinetic shear Alfv´en waves.

Computer Physics Communications 163, 67–78.

[64] KAMMERER, M., MERZ, F. & JENKO, F. (2008) Exceptional points in linear gy-

rokinetics. Physics of Plasmas 15, 052102.

[65] PEETERS, A., CAMENEN, Y., CASSON, F., HORNSBY, W., SNODIN, A.,
STRINTZI, D. & SZEPESI, G. (2009) The nonlinear gyro-kinetic ﬂux tube code
GKW. Computer Physics Communications 180, 2650–2672.

[66] PUESCHEL, M. J., DANNERT, T. & JENKO, F. (2010) On the role of numerical
dissipation in gyrokinetic Vlasov simulations of plasma microturbulence. Computer
Physics Communications 181, 1428–1437.

[67] VAN KAMPEN, N. G. & FELDERHOF, B. U. (1967) Theoretical Methods in Plasma

Physics. Amsterdam: North-Holland Publishing Company.

[68] FRIED, B. & CONTE, S. (1961) The Plasma Dispersion Function: The Hilbert

Transform of the Gaussian. New York and London: Academic Press.

[69] HUBA, J. D. (1994) NRL Plasma Formulary. NRL publication Naval Research Lab-

oratory.

171

[70] LENARD, A. & BERNSTEIN, I. B. (1958) Plasma oscillations with diffusion in

velocity space. Physical Review 112, 1456–1459.

[71] NG, C. S., BHATTACHARJEE, A. & SKIFF, F. (1999) Kinetic eigenmodes and dis-
crete spectrum of plasma oscillations in a weakly collisional plasma. Physical Re-
view Letters 83, 1974–1977.

[72] NG, C. S., BHATTACHARJEE, A. & SKIFF, F. (2004) Complete spectrum of kinetic
eigenmodes for plasma oscillations in a weakly collisional plasma. Physical Review
Letters 92, 065002.

[73] NG, C. S., BHATTACHARJEE, A. & SKIFF, F. (2006) Weakly collisional Landau
damping and three-dimensional Bernstein–Greene–Kruskal modes: New results on
old problems. Physics of Plasmas 13, 055903.

[74] MAXWELL, J. C. (1867) On the dynamical theory of gases. Philosophical Transac-

tions of the Royal Society of London 157, 49–88.

[75] ABRAMOWITZ, M. & STEGUN, I. A. (1972) Handbook of Mathematical Func-
tions: With Formulas, Graphs, and Mathematical Tables, 10th edn. New York:
Dover.

[76] GRAD, H. (1949) Note on N-dimensional Hermite polynomials. Communications

on Pure and Applied Mathematics 2, 325–330.

[77] GRAD, H. (1949) On the kinetic theory of rareﬁed gases. Communications on Pure

and Applied Mathematics 2, 331–407.

[78] GRAD, H. (1958) Principles of the kinetic theory of gases. In Thermodynamik der
Gase (ed. S. Fl¨ugge), Handbuch der Physik, vol. 12, pp. 205–294. Berlin: Springer.

[79] ARMSTRONG, T. P. (1967) Numerical studies of the nonlinear Vlasov equation.

Physics of Fluids 10, 1269–1280.

[80] GRANT, F. C. & FEIX, M. R. (1967) Fourier–Hermite solutions of the Vlasov equa-

tions in the linearized limit. Physics of Fluids 10, 696–702.

[81] JOYCE, G., KNORR, G. & MEIER, H. K. (1971) Numerical integration methods of

the Vlasov equation. Journal of Computational Physics 8, 53–63.

172

[82] GAGN ´E, R. R. J. & SHOUCRI, M. M. (1977) A splitting scheme for the numerical
solution of a one-dimensional Vlasov equation. Journal of Computational Physics
24, 445–449.

[83] DAWSON, J. M. (1983) Particle simulation of plasmas. Reviews of Modern Physics

55, 403–447.

[84] HOCKNEY, R. W. & EASTWOOD, J. W. (1981) Computer Simulation using Parti-

cles. New York; London: McGraw–Hill.

[85] BIRDSALL, C. K. & LANGDON, A. B. (2005) Plasma Physics via Computer Sim-

ulation. Bristol: Institute of Physics.

[86] FAN, J. & SHEN, C. (2001) Statistical simulation of low-speed rareﬁed gas ﬂows.

Journal of Computational Physics 167, 393–412.

[87] PEETERS, A. G., CAMENEN, Y., CASSON, F. J., HORNSBY, W. A., SNODIN,
A. P., STRINTZI, D. & SZEPESI, G. (2009) The nonlinear gyro-kinetic ﬂux tube
code GKW. Computer Physics Communications 180, 2650–2672.

[88] FAHEY, M. R. & CANDY, J. (2004) Gyro: A 5-D gyrokinetic-Maxwell solver.
In Proceedings of the 2004 ACM/IEEE conference on Supercomputing, pp. 26–33.
Washington, DC, USA: IEEE Computer Society.

[89] ZOCCO, A. & SCHEKOCHIHIN, A. A. (2011) Reduced ﬂuid-kinetic equations for
low-frequency dynamics, magnetic reconnection, and electron heating in low-beta
plasmas. Physics of Plasmas 18, 102309.

[90] HAMMETT, G. W., BEER, M. A., DORLAND, W., COWLEY, S. C. & SMITH, S. A.
(1993) Developments in the gyroﬂuid approach to tokamak turbulence simulations.
Plasma Physics and Controlled Fusion 35, 973.

[91] PARKER, S. E. & CARATI, D. (1995) Renormalized dissipation in plasmas with

ﬁnite collisionality. Physical Review Letters 75, 441–444.

[92] SCHEKOCHIHIN, A. A., KANEKAR, A., HAMMETT, G. W., DORLAND, W. &
LOUREIRO, N. F. (2015) Stochastic advection and phase mixing in a collisionless
plasma. In preparation.

[93] KANEKAR, A., SCHEKOCHIHIN, A. A., DORLAND, W. & LOUREIRO, N. F.
(2015) Fluctuation-dissipation theorems for a plasma-kinetic Langevin equation.
Journal of Plasma Physics 81, 305810104.

173

[94] PLUNK, G. G. & PARKER, J. T. (2014) Irreversible energy ﬂow in forced Vlasov

dynamics. European Physical Journal D 68, 296, reproduced in Appendix B.

[95] KOLMOGOROV, A. N. (1941) Dissipation of energy in locally isotropic turbulence.

In Akademiia Nauk SSSR Doklady, , vol. 32, p. 16.

[96] HATCH, D. R., JENKO, F., BA ˜N ´ON NAVARRO, A. & BRATANOV, V. (2013) Tran-
sition between saturation regimes of gyrokinetic turbulence. Physical Review Letters
111, 175001.

[97] LOUREIRO, N. F., SCHEKOCHIHIN, A. A. & ZOCCO, A. (2013) Fast collisionless
reconnection and electron heating in strongly magnetized plasmas. Physical Review
Letters 111, 025002.

[98] CAMPOREALE, E., DELZANNO, G. L., BERGEN, B. K. & MOULTON, J. D.
(2013) On the velocity space discretization for the Vlasov–Poisson system: compar-
ison between Hermite spectral and Particle-in-Cell methods. Part 1: semi-implicit
scheme. arXiv:1311.2098v2.

[99] HOLLOWAY, J. P. (1996) Spectral velocity discretizations for the Vlasov–Maxwell

equations. Transport Theory and Statistical Physics 25, 1–32.

[100] BOYD, J. P. (2001) Chebyshev and Fourier Spectral Methods. New York: Dover.

[101] TANG, T. (1993) The Hermite spectral method for Gaussian-type functions. Society
for Industrial and Applied Mathematics Journal on Scientiﬁc Computing 14, 594–
606.

[102] SCHUMER, J. W. & HOLLOWAY, J. P. (1998) Vlasov simulations using velocity-

scaled Hermite representations. Journal of Computational Physics 144, 626–661.

[103] LE BOURDIEC, S., DE VUYST, F. & JACQUET, L. (2006) Numerical solution of
the Vlasov–Poisson system using generalized hermite functions. Computer Physics
Communications 175, 528–544.

[104] OLVER, F. W. J., LOZIER, D. W., BOISVERT, R. F. & CLARK, C. W., ed. (2010)
NIST Handbook of Mathematical Functions. New York, NY: Cambridge University
Press, print companion to NIST Digital Library of Mathematical Functions, http:
//dlmf.nist.gov/. Equations 18.11.7, 18.11.8.

174

[105] GIL, A., SEGURA, J. & TEMME, N. (2007) Numerical Methods for Special Func-

tions. Philadelphia: Society for Industrial and Applied Mathematics.

[106] STOER, J. & BULIRSCH, R. (2002) Introduction to Numerical Analysis. New York:

Springer.

[107] WHITTAKER, J. M. (1928) The “Fourier” theory of the cardinal function. Proceed-

ings of the Edinburgh Mathematical Society 1, 169–176.

[108] MCNAMEE, J., STENGER, F. & WHITNEY, E. L. (1971) Whittaker’s cardinal func-

tion in retrospect. Mathematics of Computation 25, 141–154.

[109] STENGER, F. (1981) Numerical methods based on Whittaker cardinal, or sinc func-

tions. Society for Industrial and Applied Mathematics Review 23, 165–224.

[110] GAUTSCHI, W. (2004) Orthogonal Polynomials: Computation and Approximation.

Oxford: Oxford University Press.

[111] TOTIK, V. (2005) Orthogonal polynomials. Surveys in Approximation Theory 1, 70–

125.

[112] TREFETHEN, L. N. & BAU, D. (1997) Numerical Linear Algebra. Philadelphia:

Society for Industrial and Applied Mathematics.

[113] SHERMAN, J. & MORRISON, W. J. (1949) Adjustment of an inverse matrix corre-
sponding to changes in the elements of a given column or a given row of the original
matrix. The Annals of Mathematical Statistics 20, 620–624.

[114] BUNCH, J. R., NIELSEN, C. P. & SORENSEN, D. C. (1978) Rank-one modiﬁcation

of the symmetric eigenproblem. Numerische Mathematik 31, 31–48.

[115] ZHOU, Y. (2011) On the eigenvalues of specially low-rank perturbed matrices. Ap-

plied Mathematics and Computation 217, 10267–10270.

[116] SMITH, S. A. (1997) Dissipative closures for statistical moments, ﬂuid moments,

and subgrid scales in plasma turbulence. PhD thesis, Princeton University.

[117] MORRISON, P. J. & SHADWICK, B. A. (1994) Canonization and diagonalization
of an inﬁnite dimensional Hamiltonian system: Linear Vlasov theory. Acta Physica
Polonica A 85, 759–769.

[118] BOYD, J. P. (2001) Chebyshev and Fourier Spectral Methods. New York: Dover.

175

[119] LANDAU, L. D. (1936) The Transport Equation in the case of Coulomb Interactions.

Journal of Physics-U.S.S.R. 10.

[120] CERCIGNANI, C. (1966) The method of elementary solutions for kinetic models

with velocity-dependent collision frequency. Annals of Physics 40, 469–481.

[121] STRUCHTRUP, H. (1997) The BGK-model with velocity-dependent collision fre-

quency. Continuum Mechanics and Thermodynamics 9, 23–31.

[122] PASSOT, T. & POUQUET, A. (1988) Hyperviscosity for compressible ﬂows using

spectral methods. Journal of Computational Physics 75, 300–313.

[123] CERUTTI, S., MENEVEAU, C. & KNIO, O. M. (2000) Spectral and hyper eddy vis-
cosity in high-Reynolds-number turbulence. Journal of Fluid Mechanics 421, 307–
338.

[124] KNORR, G. & SHOUCRI, M. M. (1974) Plasma simulation as eigenvalue problem.

Journal of Computational Physics 14, 1–7.

[125] SHOUCRI, M. M. & GAGN ´E, R. R. J. (1977) Numerical solution of a two-

dimensional Vlasov equation. Journal of Computational Physics 25, 94–103.

[126] HAZELTINE, R. & MEISS, J. (2003) Plasma Conﬁnement. New York: Dover.

[127] CERCIGNANI, C. (1975) Theory and Application of the Boltzmann Equation. Edin-

burgh: Scottish Academic Press.

[128] ANDERSON, M. W. & O’NEIL, T. M. (2007) Eigenfunctions and eigenvalues of

the Dougherty collision operator. Physics of Plasmas 14, 052103.

[129] PAULI, W. (2000) Statistical Mechanics. New York: Dover.

[130] BARDOS, C., GOLSE, F. & LEVERMORE, C. D. (1993) Fluid dynamic limits of ki-
netic equations II convergence proofs for the Boltzmann equation. Communications
on Pure and Applied Mathematics 46, 667–753.

[131] LIONS, P.-L. & MASMOUDI, N. (2001) From the Boltzmann Equations to the
Equations of Incompressible Fluid Mechanics, I. Archive for Rational Mechanics
and Analysis 158, 173–193.

[132] GOLSE, F. & SAINT-RAYMOND, L. (2004) The Navier–Stokes limit of the Boltz-
mann equation for bounded collision kernels. Inventiones Mathematicae 155, 81–
161.

176

[133] BOUCHUT, F. (1993) Existence and uniqueness of a global smooth solution for the
Vlasov–Poisson–Fokker–Planck system in three dimensions. Journal of Functional
Analysis 111, 239–258.

[134] DOLBEAULT, J. (1999) Free energy and solutions of the Vlasov–Poisson–Fokker–
Planck system: external potential and conﬁnement (Large time behavior and steady
states). Journal de Math´ematiques Pures et Appliqu´ees 78, 121–157.

[135] KROMMES, J. A. & HU, G. (1994) The role of dissipation in the theory and sim-
ulations of homogeneous plasma turbulence, and resolution of the entropy paradox.
Physics of Plasmas 1, 3211–3238.

[136] HALLATSCHEK, K. (2004) Thermodynamic potential in local turbulence simula-

tions. Physical Review Letters 93, 125001.

[137] DESVILLETTES, L. & VILLANI, C. (2001) On the trend to global equilibrium
in spatially inhomogeneous entropy-dissipating systems: the linear Fokker–Planck
equation. Communications on Pure and Applied Mathematics 54, 1–42.

[138] KIRKWOOD, J. G. (1946) The statistical mechanics theory of transport processes I.

general theory. Journal of Chemical Physics 14, 180–201.

[139] HELANDER, P. & SIGMAR, D. J. (2002) Collisional Transport in Magnetized Plas-

mas. Cambridge: Cambridge University Press.

[140] WATANABE, T.-H. & SUGAMA, H. (2004) Kinetic simulation of steady states of ion
temperature gradient driven turbulence with weak collisionality. Physics of Plasmas
11, 1476–1483.

[141] MESINGER, F. & ARAKAWA, A. (1976) Numerical methods used in atmospheric
models, Global Atmospheric Research Program, vol. 1. Geneva: World Meteorolog-
ical Organization.

[142] STRIKWERDA, J. C. (2004) Finite Difference Schemes and Partial Differential
Equations, 2nd edn. Philadelphia: Society for Industrial and Applied Mathematics.

[143] HINCH, E. J. (1991) Perturbation Methods. Cambridge: Cambridge University

Press.

[144] HOU, T. Y. & LI, R. (2007) Computing nearly singular solutions using pseudo-

spectral methods. Journal of Computational Physics 226, 379–397.

177

[145] PARKER, J. T. & DELLAR, P. J. (2015) Fourier–Hermite spectral representation
for the Vlasov–Poisson system in the weakly collisional limit. Journal of Plasma
Physics doi:10.1017/S0022377814001287, reproduced in Appendix A.

[146] TREFETHEN, L. N. (1982) Group velocity in ﬁnite difference schemes. Society for

Industrial and Applied Mathematics Review 24, 113–136.

[147] WHITHAM, G. B. (2011) Linear and Nonlinear Waves. New York: Wiley-

Interscience.

[148] DAVIES, B. (2002) Integral Transforms and Their Applications. New York:

Springer.

[149] JOHNSON, H. F. (1987) An improved method for computing a discrete Hankel trans-

form. Computer Physics Communications 43, 181–202.

[150] PIESSENS, R. (2000) The Hankel transform. In The Transforms and Applications
Handbook, 2nd edn. (ed. A. D. Poularikas), chap. 9. Boca Raton, Fla.: CRC Press.

[151] FRAPPIER, C. & OLIVIER, P. (1993) A quadrature formula involving zeros of

Bessel functions. Mathematics of Computation 60, 303–316.

[152] TATSUNO, T., DORLAND, W., SCHEKOCHIHIN, A. A., PLUNK, G. G., BARNES,
M., COWLEY, S. C. & HOWES, G. G. (2009) Nonlinear phase mixing and phase-
space cascade of entropy in gyrokinetic plasma turbulence. Physical Review Letters
103, 015003.

[153] TATSUNO, T., BARNES, M., COWLEY, S. C., DORLAND, W., HOWES, G. G.,
NUMATA, R., PLUNK, G. G. & SCHEKOCHIHIN, A. A. (2010) Gyrokinetic sim-
ulation of entropy cascade in two-dimensional electrostatic turbulence. Journal of
Plasma and Fusion Research 9, 509–516.

[154] PLUNK, G. G., COWLEY, S. C., SCHEKOCHIHIN, A. A. & TATSUNO, T. (2010)
Two-dimensional gyrokinetic turbulence. Journal of Fluid Mechanics 664, 407–435.

[155] PLUNK, G. G. & TATSUNO, T. (2011) Energy transfer and dual cascade in kinetic

magnetized plasma turbulence. Physical Review Letters 106, 165003.

[156] COOLEY, J. W. & TUKEY, J. W. (1965) An algorithm for the machine calculation

of complex Fourier series. Mathematics of Computation 19, 297–297.

178

[157] ORSZAG, S. A. (1970) Transform method for the calculation of vector-coupled
sums: Application to the spectral form of the vorticity equation. Journal of the At-
mospheric Sciences 27, 890–895.

[158] AVERBUCH, A., COIFMAN, R. R., DONOHO, D. L., ELAD, M. & ISRAELI, M.
(2006) Fast and accurate polar Fourier transform. Applied and Computational Har-
monic Analysis 21, 145–167.

[159] SIEGMAN, A. E. (1977) Quasi fast Hankel transform. Optical Letters 1, 13–15.

[160] OGATA, H. (2005) A numerical integration formula based on the Bessel functions.

Proceedings of the Research Institute for Mathematical Sciences 41, 949–970.

[161] LAWSON, C. L., HANSON, R. J., KINCAID, D. R. & KROGH, F. T. (1979) Basic
linear algebra subprograms for Fortran usage. ACM Transactions of Mathematical
Software 5, 308–323.

[162] GRADSHTEYN, I. S. & RYZHIK, I. M. (2007) Table of Integrals, Series and Prod-

ucts. Amsterdam: Academic Press, Editors: A. Jeffrey and D. Zwillinger.

[163] HOWES, G. G., DORLAND, W., COWLEY, S. C., HAMMETT, G. W., QUATAERT,
E., SCHEKOCHIHIN, A. A. & TATSUNO, T. (2008) Kinetic simulations of magne-
tized turbulence in astrophysical plasmas. Physical Review Letters 100, 065004.

[164] TENBARGE, J. M. & HOWES, G. G. (2013) Current sheets and collisionless damp-

ing in kinetic plasma turbulence. Astrophysical Journal 771, L27.

[165] BARNES, M., PARRA, F. & SCHEKOCHIHIN, A. (2011) Critically balanced ion
temperature gradient turbulence in fusion plasmas. Physical Review Letters 107,
115003.

[166] KOTSCHENREUTHER, M., REWOLDT, G. & TANG, W. M. (1995) Comparison of
initial value and eigenvalue codes for kinetic toroidal plasma instabilities. Computer
Physics Communications 88, 128–140.

[167] DURRAN, D. R. (1991) The third-order Adams–Bashforth method: an attractive

alternative to leapfrog time-differencing. Monthly Weather Review 119, 702–720.

[168] DURRAN, D. R. (1999) Numerical Methods for Wave Equations in Geophysical

Fluid Dynamics. New York: Springer.

179

[169] FRIGO, M. & JOHNSON, S. G. (2005) The design and implementation of FFTW3.

Proceedings of the IEEE 93, 216–231.

[170] ORSZAG, S. A. (1971) On the elimination of aliasing in ﬁnite-difference schemes
by ﬁltering high-wavenumber components. Journal of the Atmospheric Sciences 28,
1074.

[171] BELLI, E, A. (2006) Studies of numerical algorithms for gyrokinetics and the effects

of shaping on plasma turbulence. Doctoral thesis, Princeton University.

[172] ORSZAG, S. A. & TANG, C.-M. (1979) Small-scale structure of two-dimensional

magnetohydrodynamic turbulence. Journal of Fluid Mechanics 90, 129–143.

[173] PARKER, J. T., HIGHCOCK, E. G., SCHEKOCHIHIN, A. A. & DELLAR, P. J.
(2015) Free energy ﬂow and dissipation in ion temperature gradient driven turbu-
lence. In preparation.

[174] CONNER, J. W. & WILSON, H. R. (1994) Survey of theories of anomalous trans-

port. Plasma Physics and Controlled Fusion 36, 719–795.

[175] DOYLE, E. J. ET AL. (2007) Chapter 2: Plasma conﬁnement and transport. Nuclear

Fusion 47, S18.

[176] WATANABE, T.-H. & SUGAMA, H. (2006) Velocity-space structures of distribution
function in toroidal ion temperature gradient turbulence. Nuclear Fusion 46, 24–32.

[177] HOWES, G. G., COWLEY, S. C., DORLAND, W., HAMMETT, G. W., QUATAERT,
E. & SCHEKOCHIHIN, A. A. (2008) A model of turbulence in magnetized plasmas:
Implications for the dissipation range in the solar wind. Journal of Geophysical Re-
search: Space Physics 113, doi:10.1029/2007JA012665.

[178] PODESTA, J. J., BOROVSKY, J. E. & GARY, S. P. (2010) A kinetic Alfv´en wave
cascade subject to collisionless damping cannot reach electron scales in the solar
wind at 1 AU. Astrophysical Journal 712, 685–691.

[179] GOULD, R. W., O’NEIL, T. M. & MALMBERG, J. H. (1967) Plasma wave echo.

Physical Review Letters 19, 219–222.

[180] MALMBERG, J. H., WHARTON, C. B., GOULD, R. W. & O’NEIL, T. M. (1968)

Plasma wave echo experiment. Physical Review Letters 20, 95.

180

[181] SCHEKOCHIHIN, A. A., PARKER, J. T., HIGHCOCK, E. G., DELLAR, P. J., DOR-
LAND, W. & HAMMETT, G. W. (2015) Phase mixing vs. nonlinear advection in
drift-kinetic plasma turbulence. ArXiv:1508.05988.

[182] ROGERS, B. N., DORLAND, W. & KOTSCHENREUTHER, M. (2000) Generation
and stability of zonal ﬂows in ion-temperature-gradient mode turbulence. Physical
Review Letters 85, 5336–5339.

[183] GOLDREICH, P. & SRIDHAR, S. (1995) Toward a theory of interstellar turbulence.

2: Strong Alfv´enic turbulence. Astrophysical Journal 438, 763–775.

[184] GOLDREICH, P. & SRIDHAR, S. (1997) Magnetohydrodynamic turbulence revis-

ited. Astrophysical Journal 485, 680.

[185] BOLDYREV, S. (2005) On the spectrum of magnetohydrodynamic turbulence. As-

trophysical Journal Letters 626, L37.

[186] CHO, J. & LAZARIAN, A. (2004) The anisotropy of electron magnetohydrodynamic

turbulence. Astrophysical Journal Letters 615, L41.

[187] NAZARENKO, S. V. & SCHEKOCHIHIN, A. A. (2011) Critical balance in mag-
netohydrodynamic, rotating and stratiﬁed turbulence: towards a universal scaling
conjecture. Journal of Fluid Mechanics 677, 134–153.

181

