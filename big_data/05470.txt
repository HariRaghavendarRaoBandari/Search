6
1
0
2

 
r
a

 

M
7
1

 
 
]
I
S
.
s
c
[
 
 

1
v
0
7
4
5
0

.

3
0
6
1
:
v
i
X
r
a

Predictive Functional Connectivity of Real-World
Systems
Anida Sarajli´c1,†, No¨el Malod-Dognin1,†, ¨Omer Nebil Yavero ˘glu2, and Nataˇsa Prˇzulj1,*

1Department of Computing, Imperial College London, SW7 2AZ London, United Kingdom
2Google UK, London, United Kingdom
†These authors contributed equally
*natasha@imperial.ac.uk

ABSTRACT

We are ﬂooded with large-scale dynamic networked data. Analyses requiring exact comparisons between networks are
computationally intractable, so new methodologies are sought. We extend the graphlet-based statistics to directed networks
and demonstrate that they are superior to other measures. We predict a country’s gross domestic product (GDP) solely
from its wiring patterns in the world trade network (WTN) that could inform policy makers on beneﬁts of trade agreements.
Surprisingly, we ﬁnd that it is not enough for a country to be in a densely connected core in the WTN to have a high GDP, as
was previously believed. In addition to being in the core, a country must also trade with peripheral countries, while only being
in the core and not trading with peripheral economies makes a country prone to debt. Furthermore, by tracking the dynamics
of a country’s positioning in the WTN over years, we predict success or failure of an emerging economy. We validate our
methodology on metabolic networks, yielding insights into preservation of enzyme function from the network wiring patterns
rather than sequence data. Overall, our methodology enables advanced analyses of directed networked data from any area
of science, allowing domain-speciﬁc interpretation of a directed network’s topology.

Supplementary material is available at http://bio-nets.doc.ic.ac.uk/Directed/Supplement.pdf

Introduction
Deciphering the wiring patterns (also called topology) of large-scale, dynamic, directed, networked data coming from all
domains of sciences is fundamental for understanding and predicting their functioning, emergent properties and controllabil-
ity1, 2. Topological analyses of networks are universal and provide insights in all areas of science that use network theory,
including social science3, politics4, biology5 and medicine6.

In economics, yearly trade relationships between countries are captured in the world trade network (WTN), in which nodes
represent countries and in which there is a directed edge from country u to country v if u exported some commodities (i.e.,
marketable items) to v in the considered year. In the literature, topological analyses of these directed networks focused on
characterizing their organization. Garlaschelli and Loffredo7 were the ﬁrst ones to hypothesise the modular organization of
WTN, due to its similarities with scale-free networks8. They showed that similar to scale free topology, WTN is characterized
by a sharp power-law distribution of directed edges (e.g., many countries are involved in a few trades but only few countries
are involved in large numbers of trades) and that trade relationships are disassortative (e.g., countries with many trade partners
are connected to countries with few partners and vice-versa). This modular organization of WTN was reﬁned by Kali and
Reyes9, who characterized the core-periphery organization10 of trades using in-degree centrality: in the WTN, some countries
are at the densely connected core (the central nodes in the WTN), forming rich-clubs of trading countries, while others (the
non-central ones) are at the sparsely connected periphery. The core-periphery organization was later observed by using various
statistics such as in-degree and betweenness centralities11, random walkers and k-shell decomposition12. It was also shown
to be affected by trade globalization and regionalization11. These studies also highlighted the link between the positioning
of a country in the WTN and its economy. For example, Garlaschelli and Loffredo7 proposed to predict the gross domestic
product (GDP) of a country by a derivative of its number of trading partners (i.e., node degree).

In systems biology, metabolism is the set of all life-sustaining chemical reactions in a cell. These reactions, in which
enzymes catalyse the transformation of substrates (input metabolites) into products (output metabolites), can be represented
by metabolite-centred and by enzyme-centred metabolic networks. In metabolite-centred metabolic networks, two metabolites
(nodes), u and v, are connected by a directed edge from u to v if there is an enzyme that catalyse a reaction having u as one of
its substrates and v as one of its products. In enzyme-centred metabolic networks, two enzymes (nodes), u and v, are connected
by a directed edge from u to v if some of the products of u are substrates of v. The topology of metabolic networks has been

the focus of many studies (e.g., the review of Lacroix et al.13). In these studies, a popular network statistic is network motifs14,
which are deﬁned as small partial sub-graphs that are over-represented in a network with respect to a given null model (partial
sub-graph means that when selecting a sub-set of nodes from the large network, we can select any edges between them).

Similar to WTN, many studies focused on characterizing the organization of metabolic networks. Zhu and Qin15 observed
that metabolic networks have scale free topology with highly modular organization, coming from their power law distributions
of in- and out-degrees. Recently, Shellman et al.16 showed that this modular organization is related to the cellular organization:
while the distributions of 3-node motifs in metabolic networks are similar across species, they are unique across organelles
(i.e., different cellular components). Furthermore, the topological similarities between the metabolic networks of different
species are shown to approximately reconstruct phylogenetic classiﬁcation of species17, 18, which suggests a link between the
divergence times between species and the dissimilarities between their metabolic networks. However, this observation must
be toned down by the fact that metabolic networks are reconstructed from homology19, 20. Recently, Pearcy et al.21 related
the similarities between the metabolic networks of 383 bacterial species, as measured by the similarity of their motif spectra,
with their phenotypic variability (e.g., aquatic or terrestrial species, aerobic or anaerobic environment), which suggests that
adaptation to environment during evolution may have shaped the topology of metabolic networks. Finally, motifs and their
spectra were used to relate the positioning of enzymes and metabolites in metabolic networks and their biological functions.
Shellman et al.16 showed that some motifs are characteristic to speciﬁc metabolic functions of enzymes, and going further,
Ganter et al.22 proposed a hidden markov model23 based framework for predicting metabolic functions from motif spectra.

Because exact comparison between complex networks has long been known to be computationally intractable24, the
topological analyses of complex networks use simple heuristics, commonly called network statistics, such as the in- and
out-degree distributions, to approximately say whether the structures of networks are similar25. Recently, the concept of
node roles, which associate nodes with well deﬁned topological features, has been proposed for analysing networked data.
For example, in control theory, the set of driver nodes that can control and move the networks into speciﬁc states, has been
identiﬁed and shown to be of low degree1. In the same vein, Yan et al.26 classify nodes in network as indispensable, neutral
or dispensable, if their removal from the networks results in increasing, similar, or decreasing number of driver nodes in the
resulting networks, respectively. In directed protein-protein interaction networks, indispensable proteins are shown to be the
primary targets of disease-causing mutations, and this observation was used to predict novel cancer-driver genes. However,
the limited number of controllability-based roles limits their interpretability. As seen above, nodes in metabolic networks can
be characterized by their motif spectra14. These motif-based roles are used to relate the positioning of enzymes in metabolic
networks with their biological functions16, 22. However, motifs and their spectra have limited usability27, as they are dependant
on the choice of a null model, which is generally unknown for real-world data.

For analysing undirected networks, Yavero˘glu et al.28 proposed a framework in which node roles are modelled by
graphlets29. Graphlets are deﬁned as small induced subgraphs of a large network that appear at any frequency; an induced
sub-graph means that once you pick the nodes in the large network, you must pick all the edges between them to form the
sub-graph. Within graphlets, symmetry groups of nodes called automorphism orbits are used to characterize different topolog-
ical positions that a node can participate in. Orbits are used to generalize the notion of node degree: the graphlet degrees of
a node are the numbers of times a node is found at each orbit position30. Graphlets with up-to ﬁve nodes and their degrees
characterize 73 different node roles, and their interpretability is independent of a null model. In the node role framework, the
dependencies between node roles (i.e., the correlations between the counts of graphlet orbits over all nodes in a network) are
encoded in a symmetric matrix called the graphlet correlation matrix (GCM), which is shown to ﬁnely describe the topology
of undirected networks28. GCMs have also been compared within the network statistics called graphlet correlation distance
(GCD), which has been shown to be the most accurate network statistic for classifying undirected networks. Finally, canonical
correlation analysis (CCA)31 allows translating node roles in network into domain speciﬁc languages. In economics, CCA
is used to relate the graphlet-based roles of countries in the undirected world trade network with their economic attributes28.
In systems biology, this framework is used to uncover biological functions that are performed through similar patterns of
protein-interactions across yeast and human (topologically orthologous biological functions)32.

However, graphlets, and by extension, the whole node role framework, are only deﬁned for undirected networks. Some
real-world data are inherently directed and cannot be represented by undirected networks without information loss. For
example, a trade between two countries is directed, from the exporting country towards the importing country, and these two
situations are not equivalent; the trade represents an income for the exporting country, while it represents an expense for the
importing country. When world trades are modelled as undirected networks, directionality is lost and the two situations are
treated equally.

To better analyse directed data and to avoid information loss from modelling directed data with undirected networks,
we extend the node role framework to directed networks. First, we deﬁne directed graphlets, and extend existing graphlet-
based statistics to directed networks. Among them, we show that the directed graphlet correlation distance is superior for
clustering directed networks. Second, we use our directed graphlets to extend the node role framework to directed networks,

2/17

and demonstrate its superior descriptive and predictive power on real-world data in two domains, economics and biology.

New methodology: node role descriptors for directed networks
To adapt the node role framework to directed networks, we ﬁrst generalize graphlets to directed ones as follows. We deﬁne
directed graphlets as small induced sub-graphs of a larger directed network, without anti-parallel directed edges (i.e., if a
graphlets contains a directed edge from node u to node v, it cannot contain the opposite directed edge from node v to node
u). The 40 two-to-four node directed graphlets are presented in Fig. 1 (panel a) and are denoted from G0 to G39; their 129
automorphism orbits are denoted from 0 to 128. Real-world directed networks may contain anti-parallel directed edges, which
we take into account in our counting strategy by inducing directed graphlets for each anti-parallel directed edge separately
(Fig. 1, panel c). Analogous to the graphlet degree vector33, a node in a directed network is described by its Directed Graphlet
Degree Vector (DGDV), which is a 129-dimensional vector encoding the two- to four-node graphlet degrees of the node in
the networks; e.g., the ith coordinate of the DGDV of node n, denoted by DGDVn[i] is the number of times a directed graphlet
touches node n at orbit i.

Directed graphlet-based statistics
Directed graphlets are like Lego pieces that assemble with each other to build large networks; any directed network can be
constructed by combining different directed graphlets at different directed-orbits (an example is given in Fig 1, panel b). We
exploit this observation to summarize the complex structures of networks and to compare them, by generalizing three graphlet-
based network statistics to directed networks: the Relative Graphlet Frequency Distribution Distance29, the Graphlet Degree
Distribution Agreement30 and the Graphlet Correlation Distance28. Directed Relative Graphlet Frequency Distribution Dis-
tance (DRGF) compares two networks according to their relative distributions of directed graphlet frequencies. Given the
directed graphlet frequency vectors of two networks, DRGFD ﬁrst normalizes these vectors based on the total number of
directed graphlets that appear in the networks. Then, it computes the sum of absolute differences between the normalized
directed graphlet frequencies. The resulting score measures the topological difference between the two networks (see Supple-
mentary material). Directed Graphlet Degree Distribution Agreement (DGDDA) compares two networks according to their
distributions of directed graphlet degrees (directed graphlet degree is number of times the node touches a speciﬁc directed
orbit). Given two networks, DGDDA method compares pairs of directed orbit degree distributions separately and quantiﬁes
the overall topological similarity between the two networks as an average over all comparisons (see Supplementary material).
In Directed Graphlet Correlation Distance (DGCD), dependencies between directed graphlet orbits inside a network are sum-
marized into an n × n Directed Graphlet Correlation Matrix (DGCM), where n is the number of considered directed graphlet
orbits. Each entry of this matrix quantiﬁes the dependency between two graphlet orbits in the network, which we measure by
Spearman’s correlation34 between the corresponding directed graphlet degrees over all nodes in the network. In addition to
in-depth examination of network topology that can be qualitatively interpreted (see section Results), we exploit the differences
in DGCMs to compare directed networks. DGCD measures the distance between networks as the Euclidean distance between
their DGCMs (see Supplementary material). Its superiority over other directed network distances is demonstrated in section
Evaluation. Note that we consider two versions of DGCD: DGCD-129, which uses the 129 two- to four-node directed graphlet
orbits, and DGCD-13, which uses only the 13 two- to three-node directed graphlet orbits.

Directed graphlets can also be used to measure the similarity between the positioning of nodes in directed networks; the
Directed Graphlet Degree Vector Similarity (DGDVS) measures the similarity between the positioning of two nodes by the
similarity of their directed graphlet degree vectors (see details in Supplementary material).

Directed node role framework
To bridge the gap between node roles (the wiring patterns around nodes that are captured by their directed graphlet degree) in a
network and their (real-valued) domain speciﬁc annotations, we adapt the canonical correlation analysis (CCA) methodologies
from Yavero˘glu et al.28 and from Davis et al.32 to uncover the linear relationships between them.

In our CCA framework, the node roles are encoded in a node role matrix, Rt, and the domain speciﬁc annotations in an
attribute matrix, R f . For both matrices, each row (called a variable vector) represents a speciﬁc node (for both matrices, the
same row index represents the node). In the node role matrix, values in a variable vector (a row) are the 129 directed graphlet
degrees of the node in the network, while in the attribute matrix, they correspond to the annotations of the node.

Given n pairs of variable vectors from Rt × R f for n nodes as an input, the CCA outputs two weight vectors, called a
canonical variate, so that the weighted sum of Rt is maximally correlated with the weighted sum of R f . The correlation
between the two weighted sums is called their canonical correlation. After ﬁnding the ﬁrst set of weights, CCA iterates
min {t , f } times to ﬁnd more weight vectors, such that the resulting canonical variates are not correlated with any of the
previous canonical variates. The weight matrices W1 and W2, for Rt and R f , respectively, are constructed by combining all of
the identiﬁed weight vectors. We refer the interested reader to Weenink35 for the mathematical aspects of CCA.

3/17

For a given canonical variate, the contribution of a variable (e.g., of a given directed graphlet degree) is measured by its
loading, which is the Pearson’s correlation36 between the values of the variable and of the linear combination of variables
that it participates in. For each canonical variate, the variables having the largest (positive or negative) loadings are the most
related to each others, which allows uncovering the strongest relationships between node roles and annotations.

Finally, the association matrix, which is constructed as W1 × S × W 2

+, where S is the diagonal matrix of canonical corre-
+ is the Moore-Penrose pseudoinverse37
lations that weights the variates according to their correlation strength and where W 2
of W2, is a multidimensional regression that allows predicting the domain speciﬁc annotations of a node from its directed
graphlet degrees in the network.

Evaluation of the methodology
We compare the performance of our novel directed graphlet-based network distances (DGCD-129, DGCD-13, DRGF and
DGDDA) used for clustering networks coming from six directed network models (ER, SFBA-Sink, SFBA-Source, GEO,
GEO-GD and SF-GD), which we deﬁne as follows.

• Directed Erd¨os-R`enyi random model, ER, represents uniformly distributed random interactions38. A directed ER net-
work is generated by ﬁxing the number of nodes in the network, and then by randomly adding directed edges between
uniformly chosen pairs of nodes.

• Scale free Barab`asi-Albert random model, also called preferential attachment, generate networks based on the “rich-gets-
richer” principle8. We use the directed preferential attachment model39 to generate two distinct scale free topologies.
In the ﬁrst one, SFBA-Sink, we favour adding directed edges towards nodes having already large numbers of incoming
edges, creating densely connected sink nodes. In the second one, SFBA-Source, we favour adding directed edges
outgoing from nodes having already large numbers of outgoing edges, creating densely connected source nodes.

• Directed scale-free random model with gene duplication and divergence, SF-GD, is a scale-free model which mimics
the gene duplication and the gene divergence processes from biology40. Starting from a small seed network, a node
in the network is selected at random and a new node is created together with the connections to/from nodes that the
“parent” node has (duplication step). A directed edge, whose directionality is randomly chosen, is added between the
new node and his parent with probability p. Then, each directed edge that the new node “inherited” from its parent node
is deleted with probability q (divergence step). This procedure is repeated until the desired number of nodes is achieved.
Probabilities p and q are tuned to achieve the desired number of directed edges.

• Directed geometric random model, GEO, represents the proximity relationship between uniformly randomly distributed
points in a d-dimensional metric space41. We generate GEO networks by putting points in 3-dimensional Euclidean unit
cube uniformly at random that correspond to nodes of the networks and two nodes are connected by a directed edge,
whose directionality is randomly chosen, if the Euclidean distance between the corresponding points in space is smaller
than a speciﬁed distance threshold, r, which is chosen to achieve the desired number of directed edges.

• Directed geometric random model with gene duplication, GEO-GD, is a geometric model that mimics the gene dupli-
cation and divergence processes in biology42. Starting from a small number of nodes randomly distributed in a metric
space, a new node is introduced as a copy of a randomly selected node in the network (duplication step); the new node
is moved randomly from its parent node in the metric space (divergence step), at a random distance smaller or equal
to 2 × r (where r is the distance threshold used to generate GEO networks). This process is repeated until the desired
number of nodes is achieved, and then directed edges between nodes are created following the rules of the directed
geometric network model.

We extend the methodology of Yavero˘glu et al43. We generate 10 networks for each model and for each of the following
three numbers of nodes and two directed edge densities that mimic the sizes and densities of real-world networks: 500,
1000 and 2000 nodes, and 0.5% and 1% directed edge densities. Hence, the total number of synthetic networks that we
consider is 10 × 6 × 3 × 2 = 360. We formally evaluate the performance of our directed graphlet-based network distances for
grouping networks from these models together and compare them to the performances of other commonly used directed
network distance measures:
the in- and out-degree distribution distances (note that we only present results of in-degree
distribution distance, as it produces almost identical results as its out-degree counterpart) and directed spectral distance44.
We assess how well a distance measure groups networks of the same type by using the standard Precision-Recall and ROC
curves45: for small increments of parameter e ≥ 0, if the distance between two networks is smaller than e , then the pair of
networks is declared to be similar (belong to the same cluster). For each e , four values are computed: the true positives (TP),
which are the numbers of correctly clustered pairs (i.e., that group together networks from the same model), the true negatives

4/17

(TN), which are the numbers of correctly non-clustered pairs (i.e., that do not group together networks from different models),
the false positives (FP), which are the numbers of incorrectly clustered pairs (i.e., that group together networks networks from
different models), the false negatives (FN), which are the numbers of incorrectly non-clustered pairs (i.e., that do not group
together networks from the same model). In Precision-Recall curves, for each e , the precision (PREC = T P
T P+FP ) is plotted
against the recall, also-called true-positive rate, (REC = T P
T P+FN ) and the quality of the grouping by a given distance measure
is measured with the area under the Precision-Recall curve (AUPR), which is the average precision of the distance measure.
In ROC curves, for each e , the true-positive rate is plotted against the false-positive rate (FPR = FP
FP+T N ) and the quality of
the grouping by a given distance measure is measured with the area under the ROC curve (AUC), which is the probability that
a randomly chosen pair of networks coming from the same model will have a distance smaller than a randomly chosen pair of
networks coming from different models.

AUPRs and AUCs show that DGCD-13 is the most accurate among all tested measures (Fig. 2, panel a), which is also
illustrated by its superior Precision-Recall curve (Fig. 2, panel b). The superiority of DGCD-13 over DGCD-129 may
come from the large number of dependencies between three-nodes and four-nodes directed graphlet degrees (listed in the
Supplementary material), which may blur the (dis)similarities between the DGCMs used by DGCD-129. Since the closest
objects are the ﬁrst to start forming clusters, we are interested in distance measures that optimize the number of correctly
clustered pairs of networks that are at the shortest distances and thus, that are retrieved ﬁrst by the distance measure46. Both
DGCD-13 and DGCD-129 show superiority in early retrieval over all measures (beginnings of the curves in Fig. 2, panel b).
Furthermore, we conﬁrm that such results could not have been achieved by undirected network measures by comparing the
performances of directed distance measures to the ones of their undirected counterparts (when applied on the same networks
but that are made undirected by removing the directionality of the edges). As expected, undirected network distances perform
poorly, as evidenced by smaller AUCs and AUPRs (Fig. 2, panel a) and Precision-Recall curves (Fig. 2, panel c).

Since real networks are incomplete and noisy, we evaluate the clustering quality of the above distance measures in the
presence of noise. To simulate noise, we randomly rewire up to 90% of the directed edges of model networks, in increments
of 10%. To account for the variability of randomizations, for each percentage of noise we repeat the randomisation process
30 times and report minimum, average and maximum AUPR for clustering networks from the same model. We follow the
same procedure to simulate missing data by randomly removing up to 90% of the directed edges from model networks, in
increments of 10%. These tests demonstrate robustness to noise and missing data and the superiority of DGCD over other
measures on this sample of different network topologies, sizes and densities (Fig. 2, panel d-e).

We further validate our methodology by assessing its ability to correctly group real-world metabolic networks. We re-
construct the directed metabolic networks of all Eukaryotes (299 species) using the metabolic reaction data from KEGG
database47 (collected in December 2014). For each species, we model its metabolic reactions as an enzyme-enzyme network
in which two enzyme-coding genes (nodes) are connected by a directed edge if the ﬁrst enzyme catalyses a reaction whose
product is a substrate for a reaction catalysed by the second enzyme. We obtain the taxonomic classiﬁcation of species from
KEGG database, which classiﬁes Eukaryotic species according to (from the most generic to the most speciﬁc) their Kingdom,
Sub-phylum and Class. We use the six directed distance measures to compare our 299 directed metabolic networks and use
Precision-Recall and ROC curve analyses to measure their agreement with their taxonomic classiﬁcation. Since the metabolic
reactions encoded in metabolic networks are mostly reconstructed from sequence homology relationships, we expect that the
similarity between the topologies of our directed metabolic networks will relate to the evolutionary relationships between the
corresponding species, validating our methodology. Indeed, as detailed in supplementary Fig. 3, DGCD-129 and DGCD-13
achieve the highest agreements with the taxonomic classiﬁcation of species. For example, DGCD-13 of directed metabolic
networks agree with their Class classiﬁcation with AUC of 0.945, validating the performance of the methodology.

Application to real-world networks

Economics: world trade network
Using trade data from the United Nations Commodity Trade Statistics (UN Comtrade) database (collected in August 2014,
from http://comtrade.un.org/), we generate 52 WTNs, one for each year between 1962 and 2013. To ﬁlter-out
insigniﬁcant trades, we only consider the largest trades accounting for 90% of the total trade amount of a given year. We
obtain the economic indicators of country wealth from PENN World Table (PENN, version 7.1, downloaded in July 2014
from https://pwt.sas.upenn.edu/) and International Monetary Fund (IMF) World Economic Outlook Database
(WEO, downloaded in July 2014 from http://www.imf.org/). For simplicity, we focus on the following nine economic
indicators of countries: population size, employed population size, gross domestic product (GDP), GDP per capita (i.e., GDP
of a country divided by its population size), debt, debt per capita (i.e., debt of a country divided by its population size), import
expenses, export incomes and capital stock. Because of the limited availability of economic indicators, we do our analyses
linking a country’s wiring patterns in the WTN to its economic indicators on the subset of 32 WTNs from 1980 to 2011.

5/17

Uncovering the directed core-broker-periphery structure of WTN. We use the descriptive power of the directed graphlet
correlation matrices (DGCMs) to analyse the structure of directed WTNs. Yavero˘glu et al.28 highlighted the importance of
broker positions in the undirected WTN, which mediate the trade between otherwise disconnected peripheral countries and
the core of densely connected countries, leading to the core-broker-periphery model of undirected WTN.

Each of graphlets G18 to G25 (Fig. 1, panel a) contains all three positions; the core is represented by the triangle’s nodes
(e.g., orbits 49, 50 and 51 on graphlet G18), the periphery is represented by the node hanging from the triangle (e.g., orbit 52
on graphlet G18), and the broker by the node from the core that is connected to the peripheral node (e.g., orbit 51 on graphlet
G18). We use these eight graphlets to assess if our directed WTN also possess the core-broker-periphery organization. To this
aim, we focus on the DGCMs that are obtained when considering three sets of orbits: the eight peripheral orbits (orbits 52, 56,
60, 64, 68, 72, 76 and 80); the eight broker orbits (orbits 51, 55, 59, 63, 67, 71, 75 and 79); and the 16 core orbits that are not
brokers (orbits 49, 50, 53, 54, 57, 58, 61, 62, 65, 66, 69, 70, 73, 74, 77 and 78). These orbits are illustrated in Fig. 3, panel a.
In our WTNs of each year, as presented in Fig. 3 (panels b, c and d), the broker orbits strongly correlate with the core
orbits, showing that core trading countries are very likely to be involved in trade brokerage. On the opposite, the peripheral
orbits are not correlated with core orbits and slightly anti-correlated with brokerage orbits, showing that in the WTN there
is a clear distinction between core/broker and peripheral countries. Thus, similar to the undirected case, our directed WTNs
are characterized by a core-broker-periphery structure. Moreover, we observe that peripheral countries form two subsets: the
peripheral countries that import from the broker countries (orbits 52, 60, 68 and 76) and peripheral countries that export to the
broker countries (orbits 56, 64, 72 and 80). The strong correlation within these two sets and the low correlation between them
show that the peripheral countries tend to specialize as either peripheral importer or as peripheral exporter, but not both. This
observation is only made possible by our new directed graphlet-based analysis and has eluded us thus far in undirected and
directed studies. Over time, the correlations between the peripheral roles and the core/broker roles slightly increases, showing
that peripheral countries are getting more integrated into the WTNs, which is likely to be an effect of globalization. However,
while the correlation within the two sets of peripheral orbits get stronger over time, the correlations between them get weaker,
which shows that peripheral countries became more specialised towards either import or export. Finally, the directed core-
broker-periphery structure of WTNs does not appear in random networks (e.g., see the DGCM of a directed Erd¨os-R`enyi
random network in Fig. 3 panel e).

Predictive power of directed wiring patterns. We use our new CCA framework to compute the association matrix trans-
forming the directed graphlet degrees of a country in the WTN into predicted economic indicators, using all countries and all
years from 1980 to 2011 simultaneously. We construct a single node role matrix, Rt, and a single economic attribute matrix,
R f , which encompass all countries and all years, as follows. For both matrices, each row represents a country for a given year;
e.g., their is one row for USA in 1980, one row for USA in 2000, one for UK in 2010... In the node role attribute matrix,
Rt, values in a variable vector are the 129 directed graphlet degrees of the country in the corresponding world trade network,
while in the economic attribute matrix, R f , they correspond to the nine economic attributes of the country in that year.

We apply our CCA framework on these two matrices, and ﬁrst assess the ability of the produced association matrix to
predict the economic attributes of the countries from their node roles in the WTNs, which we measure by the Pearson’s
correlations between predicted and observed economic indicator values for each year separately. As presented in Figure 4
(panel a), capital stock, import expenses, export incomes, and GDP are all consistently well-predicted from trade patterns over
the years. In contrast, debt and population-based economic indicators (population size, employment, GDP per capita, debt and
debt per capita) are not consistently predicted, showing that these indicators do not depend only on trade patterns, but also on
other geopolitical factors; for example, debt is worst predicted from WTN topology in 1991, which corresponds to the Gulf
War in the Middle East, the beginning of the Yugoslav Wars in eastern Europe and the Japanese asset price bubble collapse
(the starting point of the “Lost Decade” of stagnation of Japanese economy) in East Asia.

In the second step, we measure the quality of the predicted economic indicators by the Pearson’s correlations between
predicted and observed economic indicator values over all years simultaneously, and compare the quality of the obtained
predictions to the ones that are obtained when WTNs are made undirected (by removing directionality of the edges) and when
node roles are captured by undirected graphlet degrees. As presented in Figure 4 (panel b), using directed node roles always
results in better predictions of economic indicators, justifying the introduction of directed node roles methodology.

Among the many economic descriptors, GDP is of foremost importance, as it directly characterizes economic crises (e.g.,
the deﬁnition of global downturns48). Out of all directed orbits, orbit 71 correlates the most strongly with GDP, having Pear-
son’s correlation of 0.88. Using all directed orbits allows predicting GDP with Pearson’s correlation of 0.97! These results,
providing a strong evidence of the link between the GDP and a country’s wiring in the world trade network, cannot be obtained
by simpler, non-graphlet-based, measures of node wiring such as in- and out-degrees, or in- and out-edge closeness central-
ities that were previously used for analysing directed world trade networks11. In- and out-degrees correlate with GDP with
Pearson’s correlations of 0.71 and 0.72 respectively, and in- and out-edge closeness centralities with Pearson’s correlations of
0.39 and 0.40 respectively.

6/17

These demonstrate that our directed graphlet-based framework ﬁnds more reﬁned topological features than previously
used methods7, 11, 28, resulting in the best predictions of the economic attributes, such as GDP of a country, from its trade
wiring patterns in the WTN. Thus, our framework enables prediction of how the changes in the trade policies of a country
may affect its economy. However, despite the strong correlation between our predicted GDPs and the observed GDPs of the
countries, our predictions are still not accurate enough for predicting the exact GDP values (e.g., see Supplementary Fig. 2).
To further improve the quality of our predictions, additional non-trade related knowledge may be needed (e.g., external debt
relations, bank exchanges or geopolitical situations). Such knowledge can be incorporated directly into our CCA framework
by extending the node role matrix, Rt, with additional features, or by using data integration techniques, which are used in
systems biology for fusing molecular data produced by various omics studies49.

Economic interpretations of directed wiring patterns. We use the canonical variates (i.e., the linear combinations of
graphlet degrees and their corresponding linear combinations of economic indicators) to bridge the gap between the trade
patterns of the countries in the WTN and their economic attributes.

The ﬁrst canonical variate, presented in Fig. 4 (panel c), is statistically signiﬁcant, with canonical correlation of 0.987 and
p-value ≈ 0. It highlights eight positions in the WTN enabling a country to be a middle-man in trade between non-trading
countries (a broker position): orbits 55, 63, 71 and 79 correspond to countries mediating the trade between peripheral countries
exporting to trade-linked countries, and orbits 51, 59, 67 and 75 correspond to countries mediating the trade between peripheral
countries importing from trade-linked countries. In all these cases, the countries that are frequently seen in these broker
positions in WTN have high GDPs and low debts by making proﬁts from the transactions or added values by importing cheap
raw materials and exporting expensive ﬁnished products, as highlighted by high export incomes and low import expenses.
Also, there is a weak anti-correlation for the countries that are in peripheral positions (orbits 72, 80, 64, 56, 68, 76, 60 and 52;
we only display orbits 52 and 60 in Fig. 4 because of space limitations), indicating that these peripheral countries tend to have
low GDP, low export incomes, large debt and large import expenses.

The second canonical variate, presented in Fig. 4 (panel d), which is also statistically signiﬁcant with canonical correlation
of 0.95 and p-value≈ 0, sheds light onto an unexpected aspect of the core-broker-periphery organisation of the WTN: countries
that are in the core of the world trade but that do not trade with peripheral countries (that are not brokers, as characterized
by large counts of orbits 53, 61, 77 and 69, and with small counts orbits 30 and 37) tend to have debt. This observation has
completely eluded us in previous directed and undirected studies of WTN, in which being a core trading country has always
been considered as a sign of economic wealth. Our analysis suggest that in order to improve its economic wealth, a country
should not only try to increase its trade relationships with the core-trading countries, but should also maximize its brokerage
by trading with peripheral countries.

Tracking world trade dynamics. We demonstrated that the economy of a country is strongly related to its positioning in the
WTN, highlighting favourable (broker) and dis-favourable (peripheral and core non-broker) trade positions. To quantify the
strength of the brokerage position of a country in the WTN of each year, we extend the approach of Yavero˘glu et al.28 and
deﬁne the brokerage score of the country in a particular year as the weighted linear combination of broker graphlet degrees
(i.e., orbits 51, 55, 59, 63, 67, 71, 75 and 79) using the coefﬁcients obtained from the ﬁrst canonical variate. Similarly, we
quantify how peripheral a country is in the WTN of a particular year (by using orbits 52, 56, 60, 64, 68, 72, 76 and 80). The
formulas for these two scores are presented in the Supplementary material. These brokerage and peripheral scores enable us
to track the changes in the position of a country in the WTN over years. We analyse if the changes in brokerage and peripheral
scores of a country over years coincide with economic crises and other events impacting the economy of the country.

Indeed, we reconﬁrm previous observations obtained by undirected graphlet based analysis of WTN28. The ﬁrst example
is the loss of colonies of Great Britain (GBR), which was rivalling the USA as the world’s leading broker of trades before
decolonisation, that pushed it away from the world stage. The decline of trade brokerage position of Great Britain temporarily
stabilized in 1973 when the Conservative Prime Minister, Edward Heath, led it into the European Union (EU). However,
the downward trend induced by the dissolution of the colonial superpower has continued50. In contrast, the reuniﬁcation
of Germany (DEU) in 1991 transformed it to being the central economy of Europe51. Our scores also enable us to track
the evolution of the emerging economies (supplementary Fig. 1, panel b and c). The peripheral score of China drops after
integrating Hong-Kong in 1984, which was the hub of trade between China and the rest of the world. China stopped being a
peripheral trading country in 1995, after the adoption of the current foreign trade law in 1994, favouring international trade.
Starting in 1995, China progressively became a broker in trade, and surpassed America in 2009, possibly beneﬁting from
the fall of America’s trade due to the global ﬁnancial crisis. To reﬁne the above presented brokerage score, we exploit the
observation that in the WTN, peripheral countries are specialized towards export or import, and deﬁne import-speciﬁc and
export-speciﬁc variants of the brokerage score according to the directionality of the trade between the broker role and the
peripheral role (the formulas are presented in the Supplementary material). Import- and export-speciﬁc variants of brokerage
scores show that China’s dominance as a broker in trade in the WTN is strongly driven by its export power, which is expected

7/17

and hence validates our methodology (Supplementary Figure 1, panels c and d).

In addition, the success of China as an emerging economy can be placed in parallel with other potential emerging
economies, of Brazil (BRA), Russia (RUS), India (IND), Turkey (TUR) and Indonesia (IDN). All these countries have in-
creased their brokerage scores in the last decade, albeit not as much as China. However, they remain largely peripheral in the
WTN (Fig. 4, panel e and f). Moreover, import- and export-speciﬁc brokerage scores (Supplementary Fig. 1, panel e and f)
show that while these potentially emerging economies have increased their export-brokerage scores (with Russia and India
equalling or surpassing Great Britain), their import-brokerage scores remain far behind, which may prevent them from beneﬁt-
ing by buying (importing) commodities at low prices from peripheral exporting countries. Altogether, their peripherality in the
WTN and their lack of import-brokerage power may explain why these countries do not meet the economists’ expectations (see
http://www.businessinsider.com/why-china-was-the-only-bric-to-succeed-2013-10?IR=T).

Biology: metabolic networks
Linking wiring to function in metabolic networks. We use our directed metabolic networks and investigate if enzymes
involved in similar node roles (i.e., similar chains of metabolic reactions) perform similar biological functions. We use
Gene Ontology (GO)52 to annotate enzyme-coding genes with their biological functions. We downloaded the gene-to-GO
term mappings from NCBI (ftp://ftp.ncbi.nlm.nih.gov/gene/DATA/gene2go.gz) in March 2015 and only
use the experimentally conﬁrmed GO annotations. Each GO term represents either a biological process (BP), a molecular
function (MF) or a cellular component (CC).

We cluster nodes/enzymes of the human metabolic network using Chavl53, a publicly available hierarchical ascendant
classiﬁer, based on their directed graphlet degree vector similarity. Unlike other common clustering methods, Chavl also
proposes cuts of the classiﬁcation tree based on likelihood linkage analysis53. We use the GO term annotation of the enzymes
as a benchmark of their biological functions, cutting GO tree at level 5 to standardise GO annotation54–56. 781 enzyme coding
genes from human metabolic network have at least one GO annotation at level 5. For the clusterings proposed by Chavl, we
calculate GO term enrichment of the grouped genes using standard model of sampling without replacement57. We calculate
the p-value, corresponding to the probability of obtaining the same or higher enrichment by chance, using the cumulative
hyper-geometric function:

p = 1 −

X−1

i=0

(cid:0)K
i (cid:1)(cid:0)M−K
N−i (cid:1)
(cid:0)M
N(cid:1)

,

(1)

where N is the size of the cluster (only annotated genes from the cluster are taken into account), X is the number of genes in
the cluster that are annotated with the GO term in question, M is the number of all genes in the network that are annotated
with any GO term, and K is the number of genes in the network that are annotated with the GO term in question. A cluster
is signiﬁcantly enriched in a given GO term if the corresponding enrichment p-value is smaller than or equal to 0.01. As
presented in Fig. 5 (panel a), we obtain two clusterings: one having 4 clusters, and the other having 19 clusters. All these
clusters are signiﬁcantly enriched in GO terms, showing that enzymes involved in similar node roles in metabolic networks
perform similar biological functions. This suggest that, similar to proteins in undirected PPI networks33, the local wiring
patterns around the enzymes in a metabolic network can be used to predict their biological functions, by transferring GO
annotations among enzymes with similar directed graphlet degree vectors.

We use our CCA framework to uncover biological functions that are topologically orthologous (i.e., performed by enzymes
involved in similar node roles) between pairs of metabolic networks, of human and four commonly used model organisms:
baker’s yeast (Saccharomyces cerevisiae), fruit ﬂy (Drosophila melanogaster), thale cress (Arabidopsis thaliana) and mouse
(Mus musculus). For each species, we create its node role matrix, Rt, and its GO annotation matrix, R f , in the following
way. For both matrices, the same row index represents the same enzyme-coding gene. In the node role matrix, Rt, values
in a variable vector are the 129 directed graphlet degrees of the enzyme in the corresponding metabolic network, while in
the GO annotation matrix, R f , they are the Gene Ontology annotations of the corresponding gene (each column correspond
to a speciﬁc GO term, and the entry is set to 1 if the gene is annotated with the term and 0 otherwise). We considered
separately the GO terms describing biological processes, BP, molecular functions, MF, and cellular components, CC, so
each species has three different GO annotation matrices. We uncover topologically orthologous biological functions in two
steps.
In the ﬁrst step, we apply our CCA framework between the node role matrix and biological annotation matrix of
each species separately and use the corresponding association matrix (which predict the biological annotations of a gene
from the directed graphlet degrees of the corresponding enzyme in the metabolic network) to uncover biological functions
that are statistically signiﬁcantly predicted from topology (statistical signiﬁcance is computed according to 1,000 randomized
experiments in which rows in the node role matrix are randomly shufﬂed; a biological function is signiﬁcantly predicted if it’s
p-value, after Benjamini Hochberg correction, is lower than 0.05). In the second step, biological functions that are statistically

8/17

(cid:229)
signiﬁcantly predicted in the two species and that have predictions based on similar combinations of directed graphlet degrees,
are considered as topologically orthologous.

As presented in Fig. 5 (panel b), human and mouse have the largest number of biological functions that are topologically
orthologous. This is expected since human and mouse are the closest species among the ﬁve considered ones. A further
validation is that we show that DNA metabolic process, which is one of the essential process for all living organisms, is
topologically orthologous across all the considered species (appearing as topologically orthologous in eight out of the ten pairs
of species); its signiﬁcantly associated node roles (orbits) are presented in Fig. 5 (panel c). Our topologically orthologous
biological functions may be used to reﬁne the inter-species based function predictions that is currently based only on sequence
similarities. However, a deeper investigation on the meaning of the uncovered relationships between node roles and biological
functions is a subject of future research.

Other domains
Directed network data are abundant in many other domains, e.g. brain networks, e-mail communication networks, citation
networks, world wide web networks, and internet peer-to-peer networks, to name a few. Research on uncovering their organi-
zational principles and function will continue. Applying our new directed graphlet-based methods, or devising new methods
for their analyses58 are a subject of future research.

Concluding remarks
By generalising the graphlet-based node role framework to directed graphlets, we have enabled advanced descriptive and
predictive analyses of directed networked data that could not have been achieved by using undirected graphlets or other
directed network statistics. We have shown that correlations between directed graphlet based node roles, which we capture
in the directed graphlet correlation matrices, can be used to sensitively and robustly group networks from the same model
and separate those from different models. Analysing WTNs over years, our framework allows us to: (1) uncover the directed
core-broker-periphery organisation of the world trade, in which peripheral countries are specialized in either import or export
roles; (2) predict the economic attributes of countries from their positioning in the WTN better than by using traditional
directed descriptors or undirected graphlets that may inform regulators about beneﬁts of trade agreements and predict success
of an emerging economy; (3) identify relationships between the roles of countries in the WTN and their economic attributes;
(4) ﬁnely track the dynamics of the WTN, yielding insights into dominating in trade as brokers of import or export. Our
methodology is general and works in other domains. We observe that enzymes involved in similar patterns of metabolic
reactions in the metabolic network of human are also involved in similar biological functions, and we identify conserved
biological functions performed by enzymes that are similarly wired in metabolic reactions across species. Hence, our directed
graphlet based node role framework is universal and promises to deliver insights in the other domains of data science.

Acknowledgements
Funding: This work was supported by the European Research Council (ERC) Starting Independent Researcher Grant 278212,
the National Science Foundation (NSF) Cyber-Enabled Discovery and Innovation (CDI) OIA-1028394, the ARRS project J1-
5454, and the Serbian Ministry of Education and Science Project III44006.

Author contributions statement
A. S. generalized graphlets, network distances and network models to the directed case and performed the validation on model
networks and the study of metabolic networks. N. M-D. performed the validation against undirected distances and the study
of world trade data, and wrote the manuscript. O. N. Y. helped conducting computations. N. P. conceived and directed the
study. All authors analysed the results and reviewed the manuscript.

Additional information
Competing ﬁnancial interests: none declared.

References
1. Liu, Y.-Y., Slotine, J.-J. & Barab´asi, A.-L. Controllability of complex networks. Nature 473, 167–173 (2011).
2. Galbiati, M., Delpini, D. & Battiston, S. The power to control. Nature Physics 9, 126–128 (2013).
3. Scott, J. Social Network Analysis (Sage, 2012).

9/17

4. Ward, M. D., Stovel, K. & Sacks, A. Network analysis and political science. Annual Review of Political Science 14,

245–264 (2011).

5. Junker, B. H. & Schreiber, F. Analysis of Biological Networks, vol. 2 (John Wiley & Sons, 2011).
6. Barab´asi, A.-L., Gulbahce, N. & Loscalzo, J. Network medicine: a network-based approach to human disease. Nature

Reviews Genetics 12, 56–68 (2011).

7. Garlaschelli, D. & Loffredo, M. I. Structure and evolution of the world trade network. Physica A: Statistical Mechanics

and its Applications 355, 138–144 (2005).

8. Barab´asi, A.-L. & Albert, R. Emergence of scaling in random networks. Science 286, 509–512 (1999).
9. Kali, R. & Reyes, J. The architecture of globalization: a network approach to international economic integration. Journal

of International Business Studies 38, 595–620 (2007).

10. Borgatti, S. P. & Everett, M. G. Models of core/periphery structures. Social Networks 21, 375–395 (2000).
11. De Benedictis, L. & Tajoli, L. The world trade network. The World Economy 34, 1417–1454 (2011).
12. Della Rossa, F., Dercole, F. & Piccardi, C. Proﬁling core-periphery network structure by random walkers. Scientiﬁc

Reports 3, 1467 (2013).

13. Lacroix, V., Cottret, L., Th´ebault, P. & Sagot, M.-F. An introduction to metabolic networks and their structural analysis.

Computational Biology and Bioinformatics, IEEE/ACM Transactions on 5, 594–617 (2008).

14. Milo, R. et al. Network motifs: simple building blocks of complex networks. Science 298, 824–827 (2002).
15. Zhu, D. & Qin, Z. S. Structural comparison of metabolic networks in selected single cell organisms. BMC bioinformatics

6, 8 (2005).

16. Shellman, E. R., Burant, C. F. & Schnell, S. Network motifs provide signatures that characterize metabolism. Molecular

BioSystems 9, 352–360 (2013).

17. Heymans, M. & Singh, A. K. Deriving phylogenetic trees from the similarity analysis of metabolic pathways. Bioinfor-

matics 19, i138–i146 (2003).

18. Zhang, Y. et al. Phylophenetic properties of metabolic pathway topologies as revealed by global analysis. BMC Bioinfor-

matics 7, 252 (2006).

19. Francke, C., Siezen, R. J. & Teusink, B. Reconstructing the metabolic network of a bacterium from its genome. Trends

in Microbiology 13, 550–558 (2005).

20. Feist, A. M., Herrg˚ard, M. J., Thiele, I., Reed, J. L. & Palsson, B. Ø. Reconstruction of biochemical networks in

microorganisms. Nature Reviews Microbiology 7, 129–143 (2009).

21. Pearcy, N., Crofts, J. J. & Chuzhanova, N. Network motif frequency vectors reveal evolving metabolic network organisa-

tion. Molecular BioSystems 11, 77–85 (2015).

22. Ganter, M., Kaltenbach, H.-M. & Stelling, J. Predicting network functions with nested patterns. Nature Communications

5 (2014).

23. Ghahramani, Z. An introduction to hidden markov models and bayesian networks.

International Journal of Pattern

Recognition and Artiﬁcial Intelligence 15, 9–42 (2001).

24. Cook, S. A. The complexity of theorem-proving procedures. In Proceedings of the Third Annual ACM Symposium on

Theory of Computing, STOC ’71, 151–158 (ACM, New York, NY, USA, 1971).

25. Newman, M. Networks: An Introduction (Oxford University Press, Oxford, 2009).
26. Yan, G. et al. Spectrum of controlling and observing complex networks. Nature Physics 11, 779–786 (2015).
27. Artzy-Randrup, Y., Fleishman, S. J., Ben-Tal, N. & Stone, L. Comment on” network motifs: simple building blocks of

complex networks” and” superfamilies of evolved and designed networks”. Science 305, 1107–1107 (2004).

28. Yaveroˇglu, O. N. et al. Revealing the hidden language of complex networks. Scientiﬁc Reports 4 (2014).
29. Prˇzulj, N., Corneil, D. & Jurisica, I. Modeling interactome: Scale-free or geometric? Bioinformatics 20, 3508–3515

(2004).

30. Prˇzulj, N. Biological network comparison using graphlet degree distribution. Bioinformatics 23, 177–183 (2007).
31. Hair, J. F., Black, W. C., Babin, B. J., Anderson, R. E. & Tatham, R. L. Multivariate Data Analysis, vol. 6 (Pearson

Prentice Hall Upper Saddle River, NJ, 2006).

10/17

32. Davis, D., Yaveroˇglu, O. N., Malod-Dognin, N., Stojmirovic, A. & Prˇzulj, N. Topology-function conservation in protein-

protein interaction networks. Bioinformatics 31, 1632–1639 (2015).

33. Milenkovi´c, T. & Prˇzulj, N. Uncovering biological network function via graphlet degree signatures. Cancer Informatics

6, 257 (2008).

34. Spearman, C. The proof and measurement of association between two things. The American Journal of Psychology 15,

72–101 (1904).

35. Weenink, D. Canonical correlation analysis. In Proceedings of the Institute of Phonetic Sciences of the University of

Amsterdam, vol. 25, 81–99 (2003).

36. Pearson, K. Note on regression and inheritance in the case of two parents. Proceedings of the Royal Society of London

240–242 (1895).

37. Albert, A. Regression and the Moore-Penrose pseudoinverse (Elsevier, 1972).
38. Erd¨os, P. & R´enyi, A. On random graphs. Publicationes Mathematicae 6, 290–297 (1959).
39. Bollob´as, B., Borgs, C., Chayes, J. & Riordan, O. Directed scale-free graphs. In Proceedings of the Fourteenth Annual

ACM-SIAM Symposium on Discrete Algorithms, 132–139 (Society for Industrial and Applied Mathematics, 2003).

40. V´azquez, A., Flammini, A., Maritan, A. & Vespignani, A. Modeling of protein interaction networks. Complexus 1, 38–44

(2002).

41. Penrose, M. Random geometric graphs. Oxford Studies in Probability 5 (2003).
42. Prˇzulj, N., Kuchaiev, O., Stevanovic, A. & Hayes, W. Geometric evolutionary dynamics of protein interaction networks.

In Paciﬁc Symposium on Biocomputing, vol. 2009, 178–189 (World Scientiﬁc, 2010).

43. Yavero˘glu, ¨O. N., Milenkovi´c, T. & Prˇzulj, N. Proper evaluation of alignment-free network comparison methods. Bioin-

formatics btv170 (2015).

44. Wilson, R. C. & Zhu, P. A study of graph spectra for comparing graphs and trees. Pattern Recognition 41, 2833–2841

(2008).

45. Fawcett, T. An introduction to roc analysis. Pattern Recognition Letters 27, 861 – 874 (2006).
46. Yu, Y.-K., Gertz, E. M., Agarwala, R., Sch¨affer, A. A. & Altschul, S. F. Retrieval accuracy, statistical signiﬁcance and

compositional similarity in protein sequence database searches. Nucleic Acids Research 34, 5966–5973 (2006).

47. Kanehisa, M. Toward pathway engineering: a new database of genetic and molecular pathways. Science & Technology

Japan 59, 34–38 (1996).

48. Freund, C. L. The trade response to global downturns: historical evidence. World Bank Policy Research Working Paper

Series, Vol (2009).

49. Gligorijevi´c, V., Malod-Dognin, N. & Prˇzulj, N. Integrative methods for analysing big data in precision medicine. Pro-

teomics (2015).

50. Kindleberger, C. P. Government policies and changing shares in world trade. The American Economic Review 70, 293–

298 (1980).

51. Mundell, R. A. A reconsideration of the twentieth century. American Economic Review 90, 327–340 (2000).
52. Ashburner, M., Ball, C. A., Blake, J. A. et al. Gene ontology: tool for the uniﬁcation of biology. Nature Genetics 25,

25–29 (2000).

53. Lerman, I.-C. Foundations of the likelihood linkage analysis (lla) classiﬁcation method. Applied Stochastic Models and

Data Analysis 7, 63–76 (1991).

54. Singh, R., Xu, J. & Berger, B. Global alignment of multiple protein interaction networks with application to functional

orthology detection. Proceedings of the National Academy of Sciences 105, 12763–12768 (2008).

55. Liao, C.-S., Lu, K., Baym, M., Singh, R. & Berger, B.
protein networks. Bioinformatics 25, i253–i258 (2009).

IsorankN: spectral methods for global alignment of multiple

56. Alkan, F. & Erten, C. Beams: backbone extraction and merge strategy for the global many-to-many alignment of multiple

ppi networks. Bioinformatics 30, 531–539 (2014).

57. Kuchaiev, O., Milenkovi´c, T., Memiˇsevi´c, V., Hayes, W. & Prˇzulj, N. Topological network alignment uncovers biological

function and phylogeny. Journal of The Royal Society Interface 7, 1341–1354 (2010).

11/17

58. Trpevski, I., Dimitrova, T., Boshkovski, T. & Kocarev, L. Graphlet characteristics in directed networks, personal commu-

nication (2016).

12/17

(b)

(c)

(a)

Figure 1. Illustration of directed graphlets. (a) The 40 two- to four-node directed graphlets G0, . . . , G39. In each graphlet,
node belonging to the same automorphism orbit are of the same colour. The 128 automorphism orbits are labelled from 0 to
127. (b) Illustration of how directed graphlets assemble together to form complex networks. The whole network can be
created in three steps. First, we start with one graphlet G14 (nodes a,b,c and d, in black). Then, we add a graphlet G2 (in red)
by adding two new nodes, e and f , as heads of directed edges from node b. Finally, we add a graphlet G4 (in blue) by adding
a new node, g, as the head of a directed edge from node d and as the tail of a directed edge towards node c. Note that during
this process, many new graphlets are created, e.g., graphlet G3 (in green) between nodes b, c and g. (c) Illustration of our
anti-parallel directed edge counting strategy. The two anti-parallel directed edges in the input network (in blue and in
magenta) account for one graphlet G21 (when considering the magenta directed edge) and one graphlet G25 (when
considering the blue directed edge), among all other induced graphlets.

13/17

Classiﬁcation quality

Directed Distances
DGCD-13
DGCD-129

DRGF
DGDDA

In-Degree Distribution

Directed Spectral

AUPR AUC
0.944
0.845
0.917
0.786
0.899
0.725
0.688
0.819
0.670
0.463
0.300
0.586

Undirected Distances

GCD-15
GCD-73

RGF
GDDA

Degree Distribution

Spectral

AUPR AUC
0.850
0.545
0.820
0.518
0.832
0.503
0.503
0.795
0.656
0.417
0.300
0.584

(a)

Precision-Recall curves of directed distances

Precision-Recall curves of undirected distances

 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1

 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1

i

i

n
o
s
c
e
r
P

(b)

R
P
U
A

(d)

i

i

n
o
s
c
e
r
P

 0

 0.2

 0.4

 0.6

 0.8

 1

Recall

Precision-Recall Analysis

 0  10  20  30  40  50  60  70  80  90

Rewired edges (%)

(c)

R
P
U
A

(e)

 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1

 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2

 0

 0.2

 0.4

 0.6

 0.8

 1

Recall

Precision-Recall Analysis

 0  10  20  30  40  50  60  70  80  90

Missing edges (%)

Figure 2. Quality of clustering of the 360 model networks using directed or undirected distance measures (colour
coded in panel a). (a) For directed and undirected distance measures, the area under the ROC curves (AUC) and the area
under the precision-recall curve (AUPR) achieved by a distance measure. (b) Precision-Recall curves achieved by the six
directed distance measures. (c) Precision-Recall curves achieved by the six undirected distance measures. (d) For directed
distance measures, AUPR for different percentages of noise (randomly rewired directed edges in 10% increments, horizontal
axis) in model networks. (e) For directed distance measures, AUPR for different percentages of incompleteness (randomly
removed directed edges in 10% increments, horizontal axis) in model networks.

14/17

(a)

Directed WTN of 1962

Directed WTN of 1980

78
77
74
73
70
69
66
65
62
61
58
57
54
53
50
49
79
75
71
67
63
59
55
51
80
72
64
56
76
68
60
52

2
5

0
6

8
6

6
7

6
5

4
6

2
7

0
8

1
5

5
5

9
5

3
6

7
6

1
7

5
7

9
7

9
4

0
5

3
5

4
5

7
5

8
5

1
6

2
6

5
6

6
6

9
6

0
7

3
7

4
7

7
7

8
7

(b)

Directed WTN of 2013

78
77
74
73
70
69
66
65
62
61
58
57
54
53
50
49
79
75
71
67
63
59
55
51
80
72
64
56
76
68
60
52

2
5

0
6

8
6

6
7

6
5

4
6

2
7

0
8

1
5

5
5

9
5

3
6

7
6

1
7

5
7

9
7

9
4

0
5

3
5

4
5

7
5

8
5

1
6

2
6

5
6

6
6

9
6

0
7

3
7

4
7

7
7

8
7

1.0

0.8

0.6

0.4

0.2

0.0

 0.2

 0.4

 0.6

 0.8

 1.0

1.0

0.8

0.6

0.4

0.2

0.0

✂0.2

✂0.4

✂0.6

✂0.8

✂1.0

78
77
74
73
70
69
66
65
62
61
58
57
54
53
50
49
79
75
71
67
63
59
55
51
80
72
64
56
76
68
60
52

2
5

0
6

8
6

6
7

6
5

4
6

2
7

0
8

1
5

5
5

9
5

3
6

7
6

1
7

5
7

9
7

9
4

0
5

3
5

4
5

7
5

8
5

1
6

2
6

5
6

6
6

9
6

0
7

3
7

4
7

7
7

8
7

(c)

Directed Erd¨os-R`enyi random network

78
77
74
73
70
69
66
65
62
61
58
57
54
53
50
49
79
75
71
67
63
59
55
51
80
72
64
56
76
68
60
52

2
5

0
6

8
6

6
7

6
5

4
6

2
7

0
8

1
5

5
5

9
5

3
6

7
6

1
7

5
7

9
7

9
4

0
5

3
5

4
5

7
5

8
5

1
6

2
6

5
6

6
6

9
6

0
7

3
7

4
7

7
7

8
7

1.0

0.8

0.6

0.4

0.2

0.0

✁0.2

✁0.4

✁0.6

✁0.8

✁1.0

1.0

0.8

0.6

0.4

0.2

0.0

✄0.2

✄0.4

✄0.6

✄0.8

✄1.0

(d)

(e)

Figure 3. The directed Core-Broker-Periphery organization of WTN, with specialized peripheral importers and
exporters. (a) The peripheral importer, peripheral exporter, broker and core orbits that we use to build the presented DGCMs.
In the graphlets, bi-directional edges (in grey) mean that any directionality is allowed. The next panels present the
corresponding DGCMs for WTN of 1962 (panel b), WTN of 1980 (panel c), WTN of 2013 (panel d) and for a directed
Erd¨os-R`enyi random network (panel e).

15/17

(cid:17)(cid:12)(cid:8)(cid:30)(cid:15)(cid:28)(cid:10)(cid:15)(cid:20)(cid:25) (cid:31)(cid:23)(cid:14)(cid:24)(cid:15)(cid:10)(cid:26)

(cid:13)(cid:14)(cid:11)(cid:15)(cid:10)(cid:14)(cid:24) (cid:27)(cid:10)(cid:20)(cid:28)(cid:29)

(cid:21)(cid:19)(cid:11)(cid:24)(cid:20)(cid:26)(cid:19)(cid:8)(cid:25)(cid:10)

(cid:17)(cid:20)(cid:11)(cid:23)(cid:24)(cid:14)(cid:10)(cid:15)(cid:20)(cid:25)

(cid:21)(cid:22)(cid:11)(cid:20)(cid:12)(cid:10)

(cid:18)(cid:19)(cid:11)(cid:20)(cid:12)(cid:10)

(cid:16)(cid:7)(cid:17) (cid:11)(cid:8)(cid:12) (cid:13)(cid:14)(cid:11)(cid:15)(cid:10)(cid:14)

(cid:16)(cid:7)(cid:17)
(cid:7)(cid:8)(cid:9)(cid:10) (cid:11)(cid:8)(cid:12) (cid:13)(cid:14)(cid:11)(cid:15)(cid:10)(cid:14)

(cid:7)(cid:8)(cid:9)(cid:10)

(cid:4) (cid:2)(cid:4)

(cid:4) $(cid:5)

(cid:4) #(cid:4)

(cid:4) "(cid:5)

(cid:4) !(cid:4)

(cid:4) (cid:1)(cid:5)

(cid:4) (cid:4)(cid:4)

(cid:4) (cid:1)(cid:5)

(cid:4)
(cid:3)
(cid:2)
(cid:1)

(cid:5)
(cid:3)
(cid:2)
(cid:1)

(cid:4)
(cid:2)
(cid:2)
(cid:1)

(cid:5)
(cid:2)
(cid:2)
(cid:1)

(cid:4)
(cid:4)
(cid:4)
(cid:6)

(cid:5)
(cid:4)
(cid:4)
(cid:6)

(cid:4)
(cid:1)
(cid:4)
(cid:6)

(a)

(b)

Attribute

Undirected Directed

Prediction quality

Import
Export
GDP

Capital Stock

Debt

Employment
Population

GDP per Capita
Debt per Capita

0.970
0.970
0.958
0.952
0.791
0.648
0.621
0.599
0.357

0.983

0.977

0.970

0.970

0.910

0.763

0.730

0.682

0.535

(cid:1)(cid:2)(cid:3)(cid:4)(cid:5) (cid:6)(cid:7)(cid:8)(cid:9)(cid:8)(cid:2)(cid:6)(cid:7)(cid:10) (cid:11)(cid:7)(cid:3)(cid:2)(cid:7)(cid:5)(cid:12)

(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6) (cid:3)(cid:7)(cid:5)(cid:4)(cid:5)(cid:8)(cid:3)(cid:7)(cid:9) (cid:10)(cid:7)(cid:11)(cid:8)(cid:7)(cid:12)(cid:2)

(cid:21)(cid:22)(cid:23)(cid:9)(cid:3)(cid:5)

(cid:24)(cid:25)(cid:26)

(cid:27)(cid:7)(cid:23)(cid:2)(cid:5)(cid:7)(cid:10) (cid:28)(cid:5)(cid:9)(cid:6)(cid:29)

(cid:21)(cid:30)(cid:23)(cid:10)(cid:9)(cid:31)(cid:30)(cid:12)(cid:8)(cid:5)

(cid:26)(cid:9)(cid:23) (cid:10)(cid:7)(cid:5)(cid:2)(cid:9)(cid:8)

(cid:24)(cid:25)(cid:26)!(cid:27)(cid:7)(cid:23)(cid:2)(cid:5)(cid:7)

(cid:25)(cid:12)"(cid:5)!(cid:27)(cid:7)(cid:23)(cid:2)(cid:5)(cid:7)

(cid:25)(cid:12)"(cid:5)

#(cid:30)(cid:23)(cid:9)(cid:3)(cid:5)

$(cid:14)

(cid:19)

%(cid:14)

(cid:13)(cid:14)

(cid:13)(cid:15)

(cid:16)(cid:15)

(cid:16)(cid:16)

(cid:13)(cid:16)

(cid:16)(cid:14)

(cid:17)(cid:18)

(cid:17)(cid:13)

(cid:17)(cid:19)

(cid:16)(cid:20)

(c)

e
r
o
c
s
 

e
g
a
r
e
k
o
r
B

(e)

BRA
RUS
IND
TUR
IDN

 45000
 40000
 35000
 30000
 25000
 20000
 15000
 10000
 5000
 0

0
6
9
1

 

0
7
9
1

 

0
8
9
1

 

0
9
9
1

 

0
0
0
2

 

0
1
0
2

 

Year

$(cid:16)

(cid:20)

%(cid:16)

(cid:13)(cid:14)

(cid:15)(cid:16)

(cid:17)(cid:17)

(cid:15)(cid:18)

(cid:16)(cid:19)(cid:20)

(cid:16)(cid:19)(cid:21)

(cid:17)(cid:14)

(cid:13)(cid:17)

(cid:14)(cid:17)

(cid:14)(cid:20)

BRA
RUS
IND
TUR
IDN

(cid:22)(cid:2)(cid:23)(cid:12)

(cid:24)(cid:25)(cid:26)(cid:4)(cid:11)(cid:12)

(cid:24)(cid:27)(cid:26)(cid:9)(cid:4)(cid:28)(cid:27)(cid:2)(cid:5)(cid:12)

(cid:29)(cid:4)(cid:26)(cid:30)(cid:9)(cid:7)(cid:12)(cid:8)(cid:4)(cid:5)

(cid:22)(cid:2)(cid:23)(cid:12)(cid:31) (cid:7)(cid:26)(cid:8)(cid:12)(cid:7)

!(cid:22)(cid:29)(cid:31) (cid:7)(cid:26)(cid:8)(cid:12)(cid:7)

"(cid:27)(cid:26)(cid:4)(cid:11)(cid:12)

 (cid:7)(cid:26)(cid:8)(cid:12)(cid:7)(cid:9) (cid:1)(cid:12)(cid:4)(cid:3)#

!(cid:22)(cid:29)

 4500
 4000
 3500
 3000
 2500
 2000
 1500
 1000
 500
 0

0
6
9
1

 

0
7
9
1

 

0
8
9
1

 

0
9
9
1

 

0
0
0
2

 

0
1
0
2

 

Year

(d)

e
r
o
c
s
 
l

a
r
e
h
p
i
r
e
P

(f)

Figure 4. Analysis of directed world trade. (a) Yearly assessment of the predictive power of directed graphlets. Economic
attributes are predicted from the canonical correlation computed using all countries and all years from 1980 to 2011
simultaneously; the quality of the predictions is measured by Pearson’s correlation between the predicted and the real
economic attributes of the countries. (b) Predictive power of directed- and undirected graphlets. Predictions are computed as
in panel a, but the quality of the prediction is measured for each year separately. (c) and (d) The ﬁrst and second canonical
variates between economic attributes (on the left) and direct-graphlet orbits (on the right), computed using all countries and
all years from 1980 to 2011 simultaneously; the middle bar is colour-coded value of correlation (loading), from -1 (in red) to
+1 (in green). (e) and (f) Brokerage and peripheral scores of Brazil (BRA), Russia (RUS), India (IND), Turkey (TUR) and
Indonesia (IDN).

16/17

Enzyme clusters

#Enzymes : #Enriched GO terms

1st clustering
(4 clusters)

2nd clustering
(19 clusters)

190:5

225:14

220:23

146:13

25:11
30:23
54:18
22:5

19:16
50:16
57:9
27:11

18:11
78:28
57:27
49:7

35:9
24:5
23:13
66:20

38:34
57:15
52:9

(a)

BP

MF

CC

(b)

hsa
1
–
–
–
4
–
–
–
9
–
–
–

sce
16
2
–
–
19
9
–
–
5
11
–
–

ath
hsa
sce
dme
ath
hsa
sce
dme
ath
hsa
sce
dme

dme mmu

0
29
6
–
1
24
0
–
3
6
3
–

13
92
12
32
13
57
32
11
7
10
3
1

(c)

Figure 5. Analysis of metabolic networks. (a) GO term enrichment of the two node role based clusters of human enzymes.
For each of the two clustering, the GO terms enrichment of each cluster is presented as a pair x:y, where x is the number of
enzymes in the cluster and y is the number of enriched GO terms. (b) The number of topologically orthologous GO terms per
species pairs. (c) The signiﬁcant orbits (in red) for DNA metabolic process annotated enzymes; orbit numbers are presented
next to the nodes in red (there are many orbits because our methodology treats different edge directions in separate graphlets).

17/17

