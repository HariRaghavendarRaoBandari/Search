6
1
0
2

 
r
a

 

M
7
1

 
 
]
T
S
h
t
a
m

.

[
 
 

1
v
1
6
4
5
0

.

3
0
6
1
:
v
i
X
r
a

Bernoulli 22(3), 2016, 1331–1363
DOI: 10.3150/14-BEJ694

Goodness of ﬁt tests in terms of local levels
with special emphasis on higher criticism tests

VERONIKA GONTSCHARUK1,2,*, SANDRA LANDWEHR1,2,** and
HELMUT FINNER2,†
1Department of Statistics in Medicine, Faculty of Medicine, Heinrich-Heine-University, D¨usseldorf,
Germany.
E-mail: *veronika.gontscharuk@ddz.uni-duesseldorf.de; **sandra.landwehr@ddz.uni-duesseldorf.de
2Institute for Biometrics and Epidemiology, German Diabetes Center at the Heinrich-Heine-
University, D¨usseldorf, Germany. E-mail: †ﬁnner@ddz.uni-duesseldorf.de

Instead of deﬁning goodness of ﬁt (GOF) tests in terms of their test statistics, we present an
alternative method by introducing the concept of local levels, which indicate high or low local
sensitivity of a test. Local levels can act as a starting point for the construction of new GOF
tests. We study the behavior of local levels when applied to some well-known GOF tests such as
Kolmogorov–Smirnov (KS) tests, higher criticism (HC) tests and tests based on phi-divergences.
The main focus is on a rigorous characterization of the asymptotic behavior of local levels of
the original HC tests which leads to several further asymptotic results for local levels of other
GOF tests including GOF tests with equal local levels. While local levels of KS tests, which are
related to the central range, are asymptotically strictly larger than zero, all local levels of HC
tests converge to zero as the sample size increases. Consequently, there exists no asymptotic
level α GOF test such that all local levels are asymptotically bounded away from zero. Finally,
by means of numerical computations we compare classical KS and HC tests to a GOF test with
equal local levels.

Keywords: higher criticism statistic; Kolmogorov–Smirnov test; local levels; minimum p-value
test; Normal and Poisson approximation; order statistics

1. Introduction

Let X1, . . . , Xn be real-valued independently identically distributed (i.i.d.) random vari-
ables with continuous cumulative distribution function (c.d.f.) F . We are interested in
testing the null hypothesis

H≤0 : F (x) ≤ F0(x)

or H =

0 : F (x) = F0(x)

for all x ∈ R,

(1.1)

This is an electronic reprint of the original article published by the ISI/BS in Bernoulli,
2016, Vol. 22, No. 3, 1331–1363. This reprint diﬀers from the original in pagination and
typographic detail.

1350-7265

c(cid:13) 2016 ISI/BS

2

V. Gontscharuk, S. Landwehr and H. Finner

for a prespeciﬁed continuous c.d.f. F0. Since F0(Xi), i = 1, . . . , n, are i.i.d. uniformly
distributed on [0, 1] if F = F0, we restrict our attention to the case where

F0(x) = x

for all x ∈ [0, 1].

Consequently, we assume that Xi, i = 1, . . . , n, take values in [0, 1]. We focus on the
following class of goodness of ﬁt (GOF) tests in terms of order statistics X1:n, . . . , Xn:n
related to the underlying sample X1, . . . , Xn. For testing H≤0 we consider a one-sided test
ϕ : [0, 1] → {0, 1} based on critical values 0 ≤ c1,n < ··· < cn,n < 1 such that

ϕ = 1

iﬀ Xi:n ≤ ci,n

for at least one i = 1, . . . , n.

(1.2)

A two-sided test ˜ϕ : [0, 1] → {0, 1} for testing H =

0 is deﬁned by

˜ϕ = 1

iﬀ Xi:n ≤ ci,n

or Xi:n ≥ ˜ci,n

for at least one i = 1, . . . , n,

(1.3)

where 0 ≤ c1,n < ··· < cn,n < 1 and 0 < ˜c1,n < ··· < ˜cn,n ≤ 1 are the corresponding critical
values fulﬁlling ci,n < ˜ci,n, i = 1, . . . , n. Thereby, H≤0 is rejected if ϕ = 1, while H =
0 is
rejected if ˜ϕ = 1. The global level of the test ϕ and/or ˜ϕ is given by E0(ϕ) ≡ P(ϕ = 1|H =
0 )
and/or E0( ˜ϕ) ≡ P( ˜ϕ = 1|H =
We restrict attention to non-parametric tests only. Among the most famous non-
parametric GOF tests we ﬁnd the Kolmogorov–Smirnov (KS), Anderson–Darling (AD),
Cram´er–von Mises and Berk–Jones (BJ) tests, where KS and BJ tests and the supre-
mum form of AD tests can be rewritten in the form (1.2) and/or (1.3). In addition,
recently proposed GOF tests based on the so-called phi-divergences introduced in [19]
are non-parametric tests and can also be represented in the desired form.

0 ), respectively.

In Section 1.1, we brieﬂy discuss the union-intersection principle in relation to GOF
tests and local levels. Section 1.2 is concerned with the behavior of local levels of the
Kolmogorov–Smirnov test. Some further brief remarks concerning GOF tests in terms of
local levels are given in Section 1.3. In Section 1.4, we discuss the idea of GOF tests with
equal local levels, related ideas and relations to recent work. In Section 1.5, we switch to
higher criticism (HC) tests and some further tests based on phi-divergences and provide
some ﬁgures which roughly illustrate the behavior of the local levels of these tests. An
outline of the remaining part of the paper the focus of which is on the asymptotics of
local levels of the original HC statistic is given in Section 1.6.

1.1. The union-intersection principle and local levels

In multiple hypotheses testing local levels appear in a natural way, especially in the case of
multiple test procedures based on the union-intersection principle. Such tests accept the
global null hypothesis, that is, the intersection of a suitable set of elementary hypotheses
Hi, if and only if all elementary hypotheses are accepted. Roughly speaking, a local level
αi for Hi denotes the probability to reject Hi if it is true. Local levels tell us which
amount of the overall level α is attributed to each Hi. Often multiple test procedures

Goodness of ﬁt tests in terms of local levels

3

based on the union-intersection principle have equal local levels. Prominent examples
are the classical Bonferroni test, Tukey’s multiple range test for pairwise comparisons,
Dunnett’s test for multiple comparisons with a control or Scheﬀe’s multiple contrast
test. A further general example is the minimum p-value test which corresponds to the
minimum level attained test studied in [3]. The weighted Bonferroni test may serve as
an example with diﬀerent local levels.

GOF tests of the form (1.2) and (1.3) are related to the union-intersection principle
in the following way. Let U1, . . . , Un be i.i.d. uniformly distributed random variables and
U1:n, . . . , Un:n be the corresponding order statistics. For each i = 1, . . . , n consider null
i on the distribution of a single order statistic Xi:n such that H≤i
hypotheses H≤i and H =
is true if P(Xi:n ≤ x) ≤ P(Ui:n ≤ x) for x ∈ [0, 1], that is, if Xi:n is stochastically larger
than or equal to Ui:n and H =
is true if Xi:n is equal to Ui:n in distribution. Deﬁne tests
i
for H≤i by

ϕi = 1 iﬀ Xi:n < ci,n

and tests for H =

i by

˜ϕi = 1

Then H≤0 ⊆ Tn
Sn

iﬀ Xi:n ≤ ci,n

or Xi:n ≥ ˜ci,n.

i=1{ϕi = 1} and { ˜ϕ = 1} =
i=1{ ˜ϕi = 1} so that the GOF tests ϕ and ˜ϕ can be seen as union intersection tests. We
deﬁne local levels of a GOF test by

i , {ϕ = 1} = Sn

i=1 H≤i , H =

i=1 H =

0 ⊆ Tn
αi,n = P(ϕi = 1|H =

0 ) = P(Ui:n ≤ ci,n)

(1.4)

(1.5)

in the one-sided case and

α=
i,n = P( ˜ϕi = 1|H =

0 ) = P(Ui:n ≤ ci,n) + P(Ui:n ≥ ˜ci,n)

in the two-sided case. Noting that Ui:n is beta-distributed with parameters i and n− i + 1
and denoting the related c.d.f. by Fi,n−i+1, we get P(Ui:n ≤ x) = Fi,n−i+1(x).
Local levels can be viewed as an interesting characteristic of a GOF test and may be
interpreted as weights for testing the family of null hypotheses H≤i or H =
i , i = 1, . . . , n.
The larger a local level αi,n or α=
i,n, the higher the chance to reject the null hypothesis
corresponding to the ith smallest order statistic Xi:n at least under the null hypothesis. In
other words, local levels can be regarded as a tool to signify areas of high/low sensitivity
of a test. For example, if deviations from H≤0 and/or H =
0 are expected in the tails, one
would prefer a GOF test with larger local levels for indices i close to 1 and/or close
to n. However, we have to take into account that order statistics are dependent, see,
for example, [7] and [31]. This may inﬂuence the probability to reject null hypotheses
corresponding to a set of ith order statistics with indices i in several ranges.

1.2. Local levels of the Kolmogorov–Smirnov test

One of the most widely-used GOF tests, which can be written in terms of (1.2) and/or
(1.3), is the well-known Kolmogorov–Smirnov (KS) test. We consider a one-sided asymp-

4

V. Gontscharuk, S. Landwehr and H. Finner

Figure 1. Local levels αKS
i,n as a function of i/n for one-sided KS tests with α = 0.05 and
n = 100, 500, 1000 together with the corresponding asymptotic local levels (from top to bottom
in i/n = 0.8).

totic level α KS test, which rejects H≤0 if the KS test statistic

KS+ = max
1≤i≤n

√n(i/n − Xi:n)

is larger than the asymptotic critical value cα =p− log(α)/2 with α ∈ (0, 1). It holds
limn→∞ P(KS+ > cα|H =
0 ) = α, cf., for example, [31], page 11. Even for n ≥ 40, the prob-
ability P(KS+ > cα|H =
0 ) is approximately α. The one-sided KS test can be represented
i,n = max(0, i/n − cα/√n), i = 1, . . . , n. In ac-
in the form (1.2) with critical values cKS
i,n = Fi,n−i+1(cKS
cordance with (1.4), the corresponding local levels are given by αKS
i,n),
i = 1, . . . , n. Note that αKS
i,n can
be calculated numerically. Moreover, using the normal approximation, we get for i ≡ in
satisfying in/n → ζ ∈ (0, 1) that
αKS

i,n = 0 for i ≤ cα√n. For a ﬁnite n, the remaining αKS

in,n = 1 − Φ(q− log(α)/(2ζ(1 − ζ))),

lim
n→∞

where Φ(·) is the standard normal cumulative distribution function. The largest asymp-
totic local level is attained at ζ = 1/2 and equals 1 − Φ(√−2 log α). Figure 1 shows
asymptotic and exactly calculated local levels αKS
i,n as a function of i/n for various n-
values. For in/n in a central range of [0, 1], the limiting local levels are bounded away
from zero, whereas for in/n → ζ ∈ {0, 1} we get limn→∞ αKS
in,n = 0. This coincides with
the well-known fact that KS tests have higher power for alternatives that diﬀer from

Goodness of ﬁt tests in terms of local levels

5

the null distribution in the central range and low power against alternative distributions
which mainly deviate from the null in the tails. Alternatives of this kind, however, are
common in many applications, for example, in genome-wide association studies, in which
we face a very large number of hypotheses to test with only a small number of them
being non-null. For more practical applications see, for example, [6, 15] and [16].

Various modiﬁcations of the KS test have been proposed in the past. For example,
R´ev´esz [30] constructed a test based on a statistic which combines the advantages of the
classical and normalized KS statistics with regard to their sensitivity ranges. Mason and
Schuenemeyer [26] introduced a modiﬁed KS test by combining the classical KS with
R´enyi-type statistics and investigated the ﬁnite sample and asymptotic distribution of
this modiﬁcation. Test statistics that are determined by order statistics, in particular
tail order statistics, are studied by Lockhart in [24] with respect to asymptotic relative
eﬃciency against a certain class of alternatives. Bahadur eﬃciencies for a lot of non-
parametric GOF tests are extensively studied by Nikitin in [28]. More recently, Jager
and Wellner [19] proposed GOF tests based on phi-divergences. Their supremum- and
integral-type statistics cover various forms of Anderson–Darling and Berk–Jones statis-
tics.

1.3. GOF tests in terms of local levels

For many (non-parametric) GOF tests, there is a class of alternatives against which this
test is the most powerful. Hence, if we have some information about the range, where the
alternative distribution mainly deviates from the null distribution, it seems worthwhile
to apply such an appropriately tailored GOF test. However, from the viewpoint of test
statistics it is diﬃcult to determine whether the corresponding GOF test is sensitive for
a predeﬁned range of deviations. Fortunately, the construction of tailored GOF tests is
much easier by means of local levels. Thereby, the aim is to construct a GOF test with
larger local levels in the crucial area. For example, assuming sparse signals, a GOF test
with larger local levels for indices close to 1 and smaller local levels for the remaining
indices seems to be a reasonable choice.

In general, for a given suitable set of local levels αi,n, i = 1, . . . , n, we are able to
construct a corresponding GOF test of the form (1.2) and/or (1.3). In the one-sided case
the related critical values are given by ci,n = F −1
i,n−i+1
denotes the inverse function of the c.d.f. Fi,n−i+1. For a two-sided GOF test ˜ϕ we have to
decide how to split α=
i,n =
i,n and P(Ui:n ≤ ci,n) = α(1)
α=
i,n =
i,n/2, which leads to ci,n = F −1
α=
i,n/2). The latter
can be calculated at least numerically.

i,n−i+1(αi,n), i = 1, . . . , n, where F −1
i,n + α(2)
i,n = α(2)

i,n into two non-negative terms α(1)

i,n and α(2)

i,n such that α(1)
i,n. One possibility may be α(1)

i,n, P(Ui:n ≥ ˜ci,n) = α(2)

i,n−i+1(α=

i,n/2) and ˜ci,n = F −1

i,n−i+1(1 − α=

6

V. Gontscharuk, S. Landwehr and H. Finner

1.4. GOF tests with equal local levels

If we do not have any idea on alternatives, it seems natural to choose a GOF test with
equal local levels, that is,

α1,n = ··· = αn,n = αloc

n

and/or α=

1,n = ··· = α=

n,n = αloc
n

for some suitable αloc
n ∈ (0, 1). The idea behind this proposal is similar to the idea behind
the KS test, where the distance between the empirical c.d.f. ˆFn(x) and the underlying
c.d.f. F0(x), that is, ˆFn(x) − F0(x) for the one-sided test case and | ˆFn(x) − F0(x)| for
the two-sided case, is compared to the same critical value for each x. That is, the KS
test can be seen as a GOF test with equal distances for all feasible x-values. Considering
other measures of the distance between the theoretical and the corresponding empirical
distributions, one may construct various GOF tests with some quantities being equal.
For example, a family of GOF tests introduced in [19] can be seen as tests with equal
phi-divergences. A prominent example here is the Berk–Jones test which corresponds to
equal Kullback-Leibler divergences. Altogether, the idea of considering equal quantities
such as equal distances, critical values, test statistics and also local levels, is a natural
approach when constructing GOF tests.

GOF tests with local levels equal to some αloc

n ) (say) is deﬁned by (1.2) with ci,n = F −1

n ∈ (0, 1) are given as follows. The one-
i,n−i+1(αloc
n ),
n /2) and
n /2), i = 1, . . . , n. In order to get a level α test we have to choose
n )) = α. Unfortunately, it seems there
n as a function of n and α
n has to be calculated numerically. Nevertheless, we are able to provide some

sided version of the test ϕ(αloc
i = 1, . . . , n. The two-sided test ˜ϕ(αloc
˜ci,n = 1 − F −1
αloc
n
does not exist any analytically manageable formula for αloc
so that αloc
bounds for αloc

i,n−i+1(αloc
such that E0(ϕ(αloc

n ) is given by (1.3) with ci,n = F −1

n . For example, the Bonferroni inequality implies

n )) = α and/or E0( ˜ϕ(αloc

i,n−i+1(αloc

α/n < αloc

n < α,

n ∈ N.

Moreover, it can easily be seen that αloc
n lies between the smallest and largest local levels
for any (exact) level α GOF test of type (1.2) and (1.3), respectively. Thus, knowledge
of local levels corresponding to suitable GOF tests leads at least to upper and lower
bounds for αloc
n . For example, by means of the asymptotic KS local levels, we get for the
one-sided case

0 < αloc

n ≤ Φ(p−2 log(α)) + o(1),

n ∈ N,

which is, unfortunately, a very wide range. Thus, we have to study local levels related to
other level α GOF tests.

Once we have αloc

n , one may redeﬁne the corresponding GOF tests with equal local
levels as minimum p-value (minP) tests based on the one-sided p-values pi,n = Fi,n(Xi:n),
i = 1, . . . , n. Setting M +
n = min1≤i≤n pi,n and Mn = min1≤i≤n{pi,n, 1 − pi,n}, we get
n ≤ αloc
ϕ(αloc
n and ˜ϕ(αloc

n ) = 1 iﬀ Mn ≤ αloc

n ) = 1 iﬀ M +

n /2.

Goodness of ﬁt tests in terms of local levels

7

The minP statistics M +

n and Mn were already introduced by Berk and Jones in 1979
(cf. [4]) and they referred to these statistics as minimum level attained statistics. Im-
plicitly, Berk and Jones were the ﬁrst proposing the construction of equal local level
GOF tests (even though they did not use the term local levels). Among others, they
extensively studied M +
n and Mn with respect to optimality and Bahadur eﬃciency, see
also [3]. A further representation of GOF tests with equal local levels was provided in
the unpublished manuscript [5] in 2006. Moreover, such tests were recently provided by
several authors. At the 7th International Conference on Multiple Comparison Procedures
(MCP) 2011 we introduced the concept of local levels and proposed GOF tests with equal
local levels as an improvement of the higher criticism (HC) tests. At the MCP 2013 we
presented asymptotic as well as ﬁnite properties of GOF tests with equal local levels, cf.
[14]. In contrast to the formulation via local levels, the GOF test in [5] is formulated in
terms of bounding functions. This representation of the test is elaborated on in [1]. What
is more, the same test is provided in [25] in the HC framework. Finally, the test is also
considered in the preprints [20], [21] and [27].

1.5. Higher criticism and phi-divergence

In connection with high dimensional data and associated multiple testing issues, the so-
called higher criticism (HC) tests generated considerable interest during the last decade,
cf. for example, [8–10] and [16]. For example, Donoho and Jin proposed the use of HC
tests when testing the global null hypothesis in high-dimensional models with sparse
signals against some speciﬁc alternatives. Studying the HC test statistic they showed in
[8] that, asymptotically, HC related tests are successful throughout the same region of
amplitude sparsity where the corresponding oracle likelihood ratio test would succeed.
This means that a further speciﬁcation of an alternative is not necessary. Note that
HC tests can also be seen as GOF tests of the type (1.2) and/or (1.3). What is more,
it appears that studying local levels corresponding to HC tests is essential in order to
construct new GOF tests, which have a high power against alternative distributions that
mainly deviate from the null distribution in the considered range.

Alternatively, instead of HC tests one may consider other GOF tests which are based on
the phi-divergences introduced in [19]. Thereby, the family of these tests is parametrized
by s ∈ [−1, 2] so that the HC test corresponds to s = 2, the Berk–Jones test to s = 1, the
reversed Berk–Jones test to s = 0 and the studentized version of the HC test to s = −1. As
suggested by a referee, we compare local levels for some selected s-values. Figure 2 shows
two-sided local levels of the exact level α tests based on the phi-divergences for α = 0.05,
n = 1000 and s = 2, 1.5, 1, 0.5, 0,−0.5,−1. What these local levels have in common is
that they are large in the tails and small and approximately equal in the central range.
However, the range of the local level values is largest for the HC test and smallest for
the Berk–Jones test. Therefore, it looks that the Berk–Jones test leads to the narrowest
bounds for αloc
n while the HC test to the widest ones. Due to the fact that under the
null hypothesis statistics based on phi-divergences have the same asymptotic behavior
in a speciﬁc range relevant for the asymptotics, any of these tests will lead to the same

8

V. Gontscharuk, S. Landwehr and H. Finner

Figure 2. Two-sided local
s = 2, 1.5, 1, 0.5, 0, −0.5, −1 (from left to right) together with αloc
two-sided level α test ˜ϕ(αloc

level α GOF tests based on phi-divergences with
n = 0.001075 related to the

levels of

n ) for α = 0.05 and n = 1000.

asymptotic results for most local levels. Therefore, it does not matter which test we
consider. Since the tests with s = 2 (HC tests) and s = −1 (studentized HC tests) have
the simplest representation of the form (1.2) and/or (1.3), we prefer to restrict attention
to the original HC test, which has received a lot of attention during the past decade.

1.6. Outlook of the remaining part of the paper

In this paper, we calculate local levels of asymptotic level α HC tests and show that
these local levels converge to zero as n → ∞, which diﬀers drastically from the KS case,
cf. Figure 1. This implies for local levels of any asymptotic level α GOF test of the form
(1.2) and/or (1.3) that

lim
n→∞

min
1≤i≤n

αi,n = 0,

that is, there are no level α tests for which the local levels are all asymptotically bounded
away from zero. Finally, by a careful study of asymptotic HC local levels we get for
ϕ ≡ ϕ(αloc

n ) and/or ϕ ≡ ˜ϕ(αloc

n ) that

E0(ϕ) = α iﬀ

lim
n→∞

lim
n→∞

αloc
n ·

2 log(log(n)) log(n)

− log(1 − α)

= 1.

This result seems to be the most precise result concerning the asymptotics of the one- and
two-sided GOF tests with equal local levels. In general, there are only few other works,
in which asymptotics is investigated, cf. [20, 21] and [27]. Due to a long revision process,

Goodness of ﬁt tests in terms of local levels

9

some highlights of this paper have been already summarized in [14], where the focus lies on
the sensitivity range of the HC tests statistic, extremely slow HC asymptotics, relations
to the Ornstein–Uhlenbeck process, and power comparisons of the test with equal local
levels and the original HC test. The remaining part of the paper is organized as follows.
In Section 2, we study local levels of the HC test. We further derive the critical value
and rejection curves corresponding to asymptotic level α HC tests and provide a result
on the asymptotic behavior of the HC critical values. As zones of normal and Poisson
convergence play a crucial role in the derivation of asymptotic results, we provide some
basic results on these approximations for HC local levels in Section 3. Section 4 contains
explicit asymptotic expressions of the local levels αi,n of the one-sided HC test. They are
derived for various growth rates of i utilizing the approximation results from Section 3. In
Section 5, we investigate the asymptotic monotonicity of the local levels of one-sided HC
tests and provide some results concerning the asymptotic behavior of local levels related
to general level α GOF tests and tests with equal local levels. In Section 6, we compare
classical KS and HC tests to GOF tests with equal local levels by means of numerical
computations. Future investigations and open questions are discussed in Section 7. All
proofs mostly of technical nature are deferred to Appendices A, B and C.

2. Higher criticism tests and local levels

First, we introduce the version of the higher criticism GOF tests that we are dealing
with. Let

Gi,n(u) = √n

and

˜Gi,n(u) = √n

i/n − u

pu(1 − u)

u − (i − 1)/n

pu(1 − u)

,

u ∈ (0, 1).

A class of one-sided and two-sided HC test statistics can be expressed as

HC+ = max
1≤i≤n

Gi,n(Xi:n) and HC= = max

1≤i≤n{Gi,n(Xi:n), ˜Gi,n(Xi:n)},

respectively. A one-sided HC test based on a critical value d rejects H≤0 iﬀ HC+ > d and
0 iﬀ HC= > d. In accordance
a two-sided HC test with the same critical value rejects H =
with (1.4), local levels of a one-sided HC test based on a critical value d > 0 are given by

αi,n = P(Gi,n(Ui:n) > d),

i = 1, . . . , n.

(2.1)

Analogously, local levels of the corresponding two-sided HC test are given by

i,n = P({Gi,n(Ui:n) > d} ∪ { ˜Gi,n(Ui:n) > d}),
α=

i = 1, . . . , n.

(2.2)

Setting un = log(log(n)) and

dn(t) = (t + 2un + (log(un) − log(π))/2)/√2un,

(2.3)

10

V. Gontscharuk, S. Landwehr and H. Finner

the asymptotic distributions of HC+ and HC= are given by

lim
n→∞

P(HC+ ≤ dn(t)|H =

0 ) = exp(− exp(−t))

and

lim
n→∞

P(HC= ≤ dn(t)|H =

0 ) = exp(−2 exp(−t)),

respectively, cf. [11] and [18]. For t = tα or t = t=

α with

(2.4)

(2.5)

tα = − log(− log(1 − α))

and t=

α = − log(− log(1 − α)/2)

we get a one-sided or two-sided asymptotic level α HC test, respectively. Note that
and { ˜Gi,n(Ui:n) > d} = {Ui:n > ˜hi,n(d)},

{Gi,n(Ui:n) > d} = {Ui:n < hi,n(d)}

where

and

hi,n(d) =

d2 + 2i − dpd2 + 4i − 4i2/n

2(d2 + n)

˜hi,n(d) =

d2 + 2(i − 1) + dpd2 + 4(i − 1) − 4(i − 1)2/n

2(d2 + n)

.

(2.6)

(2.7)

Thereby, ˜hi,n(d) > hi,n(d), i = 1, . . . , n, for d large enough. Below, let d ≥ 1, which guar-
antees ˜hi,n(d) > hi,n(d) for all i = 1, . . . , n and {Ui:n < hi,n(d)} ∩ {Ui:n > ˜hi,n(d)} = ∅.
Thus, local levels can be expressed as

αi,n = P(Ui:n < hi,n(dn(t))),

i = 1, . . . , n,

for one-sided HC tests and

i,n = P(Ui:n < hi,n(dn(t))) + P(Ui:n > ˜hi,n(dn(t))),
α=

i = 1, . . . , n,

for two-sided HC tests. Assuming that Zn ( ˜Zn) is a binomially distributed random vari-
able with parameters n and hi,n(dn(t)) (˜hi,n(dn(t))), that is, Zn ∼ B(n, hi,n(dn(t))), and
˜Zn ∼ B(n, ˜hi,n(dn(t))), we get

αi,n = P(Zn ≥ i) and α=

i,n = P(Zn ≥ i) + P( ˜Zn < i).

(2.8)

Since ˜hi,n(d) = 1 − hn,n−i+1(d) for i = 1, . . . , n and n ∈ N, we obtain

α=
i,n = αi,n + αn−i+1,n,

i = 1, . . . , n.

Hence, two-sided local levels are symmetric in the sense α=
and can be easily calculated if one-sided local levels are known.

i,n = α=

n−i+1,n for i = 1, . . . , n,

Goodness of ﬁt tests in terms of local levels

11

Figure 3. For n = 1000 and d = 10 the critical value curve ρn(x, d) and the corresponding
rejection curve rn(x, d) are given by the lowest and highest curves in x = 0.8, respectively;
˜ρn(x, d) and ˜rn(x, d) are given by the highest and lowest curves in x = 0.2, respectively. The
straight line is the diagonal.

Note that the considered HC tests (and a lot of multiple tests) can be alternatively
deﬁned in terms of a rejection curve, which is a general inverse of the corresponding
critical value curve, cf. [13]. Critical value curves related to (2.6) and (2.7) are given by

ρn(x, d) =

d2 + 2xn − d√d2 + 4xn − 4x2n

2(d2 + n)

and

˜ρn(x, d) =

d2 + 2(xn − 1) + dpd2 + 4(xn − 1) − 4(xn − 1)2/n

2(d2 + n)

,

(2.9)

(2.10)

respectively, that is, hi,n(d) = ρn(i/n, d) and ˜hi,n(d) = ˜ρn(i/n, d). The corresponding re-
jection curves are given by

rn(x, d) = x + dr x(1 − x)

n

and ˜rn(x, d) = x +

1

n − dr x(1 − x)

n

,

respectively. It holds ρn(x, d) = 1− ˜ρn(1− x + 1/n, d) and rn(x, d) = 1− ˜rn(1− x, d) + 1/n.
Figure 3 shows critical value curves ρn, ˜ρn and the corresponding rejection curves rn, ˜rn
for n = 1000 and d = 10. For increasing n and/or decreasing d, the corresponding curves
tend to the diagonal.

12

V. Gontscharuk, S. Landwehr and H. Finner

The following lemma shows the asymptotic behavior of the critical values hin,n ≡

hin,n(dn(t)) for diﬀerent ranks i.

Lemma 2.1. Let n ∈ N and in ∈ N with in ≤ n. It holds:

(i) if in = o(un) as n → ∞, then

nhin,n

in

=

log(un) + 2t − log(π)

in

2un(cid:18)1 −
+ O(cid:18) in log(un)2 + i3

u3
n

n

2un

(cid:19);

in

un(cid:19)

−

(ii) if cn ≡ un/in → c for some c > 0 we obtain

nhin,n

in

= δ(cn)(cid:18)1 −

log(un) + 2t − log(π)

n + 2cn

2inpc2

n (cid:19),
(cid:19) + O(cid:18) log(un)2

u2

where δ(cn) = 1 + cn −pc2

n + 2cn ∈ (0, 1);

(iii) if in(1 − in/n)/un → ∞, that is, in/un → ∞ and (n − in)/un → ∞, then

(2.11)

(2.12)

nhin,n

in

= 1 −s 2un
+(cid:18)1 −

in (cid:18)1 −
n (cid:19) un

2in

in

in

n(cid:19) −
+ o(cid:18) un

in

log(un) + 2t − log(π)

2√2inun

1

√inunr1 −

+

r1 −
n(cid:19);

in

(iv) if cn ≡ (n − in)/un → c for some c ≥ 0 we obtain

nhin,n

in

= 1 −

un
in

log(un) + 2t − log(π)

(1 + √1 + 2cn) −
inun (cid:19).
√1 + 2cn(cid:19) + O(cid:18) log(un)2

1 + cn

2in

×(cid:18)1 +

in
n

(2.13)

(2.14)

In the next sections, we provide asymptotics of local levels αi,n of HC tests for all
growth rates of i. To be precise, we are considering so-called extreme ranks i, where i
or n − i are ﬁxed, and increasing ranks i = in → ∞ as n → ∞. We split the latter into
central ranks, which are such that in/n → ζ ∈ (0, 1) as n → ∞, and intermediate ranks,
which are such that in/n → ζ ∈ {0, 1}. For these concepts see, for example, [23].

3. Normal and Poisson approximations for local levels

Due to representation (2.8), we can approximate local levels of a HC test by applying
Poisson and/or normal approximations for the binomial distribution. Below, let Yn ∼

Goodness of ﬁt tests in terms of local levels

13

P(nhin,n) and ˜Yn ∼ P(n(1 − hin,n)), where P(λ) denotes the Poisson distribution with
parameter λ > 0. Thereby, hin,n = hin,n(dn(t)) is given in Lemma 2.1.
The following theorem shows that for large values of n local levels αin,n of HC tests
based on critical values hin,n, can be calculated by means of Poisson approximations for
a wide range of ranks in.

Theorem 3.1 (Poisson approximation of local levels). Let in ∈ N, in ≤ n, be a
sequence of non-decreasing numbers. For in such that in = o(un) we obtain

(3.1)

(3.2)

(3.3)

(3.4)

(3.5)

(3.6)

αin,n = P(Yn = in)[1 + o(1)],

for in such that un/in → c for some c > 0

and for in such that in/un → ∞ and in = o(pn/un)

αin,n = 1/(pc2 + 2c − c)P(Yn = in)[1 + o(1)]
αin,n =pin/(2un)P(Yn = in)[1 + o(1)].
αin,n = P( ˜Yn = n − in)[1 + o(1)],

Analogously, for in with n − in = o(un), we get

for in fulﬁlling (n − in)/un → c for some c > 0 we obtain

αin,n = (1 + c/(1 + √1 + 2c))P( ˜Yn = n − in)[1 + o(1)]

and if (n − in)/un → ∞ and n − in = o(pn/un), then

αin,n =p(n − in)/(2un)P( ˜Yn = n − in)[1 + o(1)].

The following theorem shows that local levels of HC tests corresponding to central
ranks and to intermediate ranks close to central ones can be calculated in terms of the
density of the standard normal distribution φ.

Theorem 3.2 (Normal approximation of local levels). Let in ∈ N be such that
in(1 − in/n)/u3
(in − nhin,n)/σn. Then xn → ∞, x3

n → ∞, σn =pnhin,n(1 − hin,n) with hin,n given in (2.13) and xn =

n/σn → 0 as n → ∞ and

αin,n = φ(xn)/xn[1 + O(x3

n/σn + 1/x2

n)].

(3.7)

Proof. We can derive (3.7) by following the proof in [32], where he considered the case
pn ≡ p. Since αin,n = P(Zn ≥ in), where Zn ∼ B(n, hin,n), it suﬃces to show x3
n/σn → 0
if in(1 − in/n)/u3
n → ∞. This can easily be proved by applying (2.13), which implies

σn =pin(1 − in/n)[1 + o(1)] and xn = √2un[1 + o(1)].

(cid:3)

14

V. Gontscharuk, S. Landwehr and H. Finner

Figure 4. Diagram of the sets of ranks as deﬁned in (4.2) and the corresponding lemmas in
Section 4 which provide expressions for the local levels αin ,n for the diﬀerent growth rates of in.

Remark 3.1. Note that for in satisfying in(1 − in/n)/u3
local levels of HC tests.

in/n) = o(pn/un), Theorems 3.1 and 3.2 provide two alternative approximations for

n → ∞ as n → ∞ and in(1 −

4. Asymptotic expressions of local levels of HC tests

By means of Theorem 3.1 and the Stirling formula

i! = √2πii+1/2 exp(−i)[1 + O(1/i)]

(4.1)

as well as Theorem 3.2, we are now able to calculate local levels αi,n for various ranks i.
Local levels αi,n of HC tests with critical values hi,n(dn(t)) are given in Lemmas 4.1–4.5.
For the sake of simplicity, we introduce the following notation for the diﬀerent growth
rates of in. We deﬁne the following sets of ranks in ≤ n, n ∈ N,

as n → ∞,

n → c > 0

as n → ∞,

n → 0
as n → ∞,

Ac b= in/un → c
B0 b= in/un → ∞ and in/u3
Bc b= in/u3
C b= in(1 − in/n)/u3
¯Bc b= (n − in)/u3
¯B0 b= (n − in)/un → ∞ and (n − in)/u3
¯Ac b= (n − in)/un → c

n → ∞ as n → ∞,
as n → ∞,

as n → ∞.

n → c > 0

(4.2)

as n → ∞,

n → 0

For example, for a sequence of ranks in, n ∈ N, corresponding to Ac with c = 0 we write
in ∈ A0. Figure 4 summarizes which ranks in correspond to each lemma. In the next two
lemmas, we state local levels of HC tests for extreme ranks and intermediate ranks close
to extreme ones, that is, in ∈ A0 ∪ ¯A0.
Lemma 4.1. For in ∈ A0, we obtain
in

1

√2πin(cid:18)γ

un(cid:19)in

exp(−invn)(cid:20)1 + O(cid:18) 1

in(cid:19) + o(1)(cid:21),

αin,n =

(4.3)

Goodness of ﬁt tests in terms of local levels

where γ = exp(1)/2 and

vn = (log(un) + 2t − log(π) + 3in)/(2un)[1 + o(1)].

Alternatively, for in ∈ A0 such that in = o(√un) we get

αin,n =(cid:18) i2

2un(cid:19)in 1

n

in!

[1 + o(1)].

Lemma 4.2. For in ∈ ¯A0 we obtain

αin,n =

√π exp(−2t)
p2(n − in)

1

un log(n)2(cid:18)

un

γ(n − in)(cid:19)n−in

exp((n − in)wn)

× [1 + O(1/(n − in)) + o(1)],

where γ = exp(1)/2 and

15

(4.4)

(4.5)

(4.6)

(4.7)

(4.9)

wn = (log(un) + 2t − log(π) + 3(n − in))/(2un)[1 + o(1)].

Moreover, for in ∈ ¯A0 such that n − in = o(√un) we get

αin,n =

π exp(−2t)

un log(n)2(cid:18) 2un

exp(2)(cid:19)n−in

1

(n − in)!

[1 + o(1)].

(4.8)

The following lemma contains an expression for local levels of HC tests for central

ranks and intermediates close to central ranks, that is, in ∈ C.
Lemma 4.3. Let in ∈ C. Then
exp(−t)

2un log(n)(cid:20)1 + O(cid:18) log(un)

αin,n =

un

+

u3/2

npin(1 − in/n)(cid:19)(cid:21),

that is, local levels αin,n with aforementioned in-values are asymptotically equal. More-
over, for a sequence kn ∈ {1, . . . , n} such that kn(1 − kn/n)/u3
n → ∞ as n → ∞ and all
in = kn, . . . , n − kn, local levels αin,n converge uniformly.

The next lemma provides local levels of HC tests corresponding to intermediate ranks

in ∈ B0 ∪ Bc, ¯B0 ∪ ¯Bc.
Lemma 4.4. Let in ∈ B0 ∪ Bc or in ∈ ¯B0 ∪ ¯Bc. Then
exp(cid:18)√2ζn

exp(−t)
2un log(n)

αin,n =

3

(un + o(un))(cid:19),

where ζn =pun/in if in ∈ B0 ∪ Bc and ζn = −pun/(n − in) if in ∈ ¯B0 ∪ ¯Bc.

(4.10)

16

V. Gontscharuk, S. Landwehr and H. Finner

Figure 5. The left graph: exact local levels curves calculated for one-sided HC-tests with
n = 1000 and d = 1.5, 2.5, 3.5, 4.736 (from top to bottom). The right graph is zoomed.

Finally, we give representations for local levels of HC tests for the remaining interme-

diate ranks in ∈ Ac and in ∈ ¯Ac.
Lemma 4.5. Let in ∈ Ac for a c > 0 and set cn ≡ un/in. Then

αin,n =

√cn

(1 − δ(cn))√2πun(cid:20) δ(cn) exp(1)
× [√π exp(−t)/√un](1−δ(cn))/√c2

exp(δ(cn)) (cid:21)un/cn

n+2cn [1 + o(1)]
with δ(c) = 1 + c − √c2 + 2c. If in ∈ ¯Ac, c > 0, and cn ≡ (n − in)/un, then
√2πcnun(cid:18) 1 + cn + √1 + 2cn
(cid:19)cnun
× (√π exp(−t)/√un)1+1/√1+2cn log(n)−(1+√1+2cn)
× [1 + o(1)].

1 + √1 + 2cn(cid:19)

αin,n =(cid:18)1 +

cn

1

cn

(4.11)

(4.12)

5. Monotonicity of HC local levels and related results

First, we brieﬂy illustrate the behavior of one-sided local levels of HC tests for ﬁnite
n-values. Figure 5 provides exactly calculated local levels αi,n = P(Ui:n < hi,n(d)) of
HC tests ϕHC (say) with critical values hi,n(d), i = 1, . . . , n, for n = 1000 and d =
1.5, 2.5, 3.5, 4.736. For d = 1.5, 2.5, 3.5, 4.736 we get E0(ϕHC) = 0.803, 0.322, 0.111, 0.05,

Goodness of ﬁt tests in terms of local levels

17

respectively. That is, the HC test based on d = 4.736 is a level α GOF test for α = 0.05.
Figure 5 illustrates that local levels are decreasing for larger d-values. Noting that our
asymptotic investigations are given for d ≡ dn tending to inﬁnity, it seems that asymp-
totic results related to HC tests should be in accordance with the corresponding ﬁnite
results for larger values of d.

Indeed, the following theorem shows that local levels αi,n of a HC test with critical
values hi,n(dn(t)), i = 1, . . . , n, are asymptotically (n → ∞) non-increasing in i in the
following sense. For non-decreasing sequences i(1)
for all
n
n ,n depends on the
n ∈ N, we get limn→∞ αi(2)
n − i(1)
diﬀerence i(2)
n ,
the smaller the ratio αi(2)

and i(2)
n
n ,n ≤ 1. More precisely, αi(2)

n . Typically, the larger the diﬀerence i(2)

fulﬁlling i(1)
n ,n/αi(1)

n and/or the ratio i(1)

n − i(1)

n ,n/αi(1)

n ,n/αi(1)

n < i(2)
n

n /i(2)

n ,n.

Theorem 5.1 (Asymptotic monotonicity of HC local levels). Let i(1)
non-decreasing sequences that satisfy i(1)
level corresponding to a HC test with critical values hi,n(dn(t)), i = 1, . . . , n. Then

n be
n for all n ∈ N. Let αi,n denote the ith local

n and i(2)

n < i(2)

if the tuple (i(1)

n , i(2)

n ) satisﬁes:

lim
n→∞

αi(2)

n ,n/αi(1)

n ,n = 1

(i) (i(1)
(ii) (i(1)
(iii) (i(1)
(iv) (i(1)
(v) (i(1)

n , i(2)
n , i(2)
n , i(2)
n , i(2)
n , i(2)

n ) ∈ C × C,
n ) ∈ Bc × Bc,
n ) ∈ ¯Bc × ¯Bc,
n ) ∈ B0 × B0 and i(1)
n /i(2)
n ) ∈ ¯B0 × ¯B0 and (n − i(2)

n = 1 + o(qi(1)
n )/(n − i(1)

n /u3

n),

n ) = 1 + o(q(n − i(2)

n )/u3

n).

Moreover, we have

0 < lim
n→∞

if one of the following conditions is satisﬁed:

αi(2)

n ,n/αi(1)

n ,n < 1

(5.1)

(5.2)

(vi) (i(1)
(vii) (i(1)
(vi) (i(1)
(vii) (i(1)
(viii) (i(1)

n , i(2)
n , i(2)
n , i(2)
n , i(2)
n , i(2)

(ix) (i(1)

n , i(2)

n ) ∈ Bc1 × (Bc2 ∪ C ∪ ¯Bc) with c1 < c2,
n ) ∈ (C ∪ ¯Bc1) × ¯Bc2 with c2 < c1,
n ) ∈ Bc1 × (Bc2 ∪ C ∪ ¯Bc) with c1 < c2,
n ) ∈ (C ∪ ¯Bc1) × ¯Bc2 with c2 < c1,
n = 1 − cnqi(1)
n ) ∈ B0 × B0 and i(1)
n /i(2)
n )/(n − i(1)
n ) ∈ ¯B0 × ¯B0 and (n − i(2)

c > 0,

n /u3

n with cn → c > 0,
n /u3

n ) = 1 − cnqn − i(2)

n, with cn →

18

V. Gontscharuk, S. Landwehr and H. Finner

Figure 6. Diagram of the sets of ranks as deﬁned in (4.2) and the corresponding regions covered
by Theorem 5.1.

(x) (i(1)
(xi) (i(1)

n , i(2)
n , i(2)

n ) ∈ Ac × Ac with c > 0 and i(2)
n ) ∈ ¯Ac × ¯Ac with c > 0 and i(2)

n − i(1)
n − i(1)

n ≡ m for an m ∈ N,
n ≡ m for an m ∈ N.

Finally,

lim
n→∞

αi(2)

n ,n/αi(1)

n ,n = 0

(5.3)

for all other tuples with i(1)

n < i(2)

n when this limit exists.

Figure 6 illustrates the regions of validity of (i)−(xi) in Theorem 5.1. Since α1,n → 0
as n → ∞, cf. (4.5), and local levels αi,n, i = 2, . . . , n are smaller than α1,n for n large
enough, cf. Theorem 5.1, the following result is obvious.

Theorem 5.2. For the local levels of the HC test it holds that

lim
n→∞

max
1≤i≤n

αi,n = 0.

Theorem 5.2 implies that local levels corresponding to a HC test show a completely
diﬀerent limiting behavior than the local levels corresponding to KS tests, cf. Figure 1.
Moreover, the statement of Theorem 5.2 on the local levels of HC tests vanishing asymp-
totically allows us to deduce a result on the more general case of asymptotic level α GOF
tests with prespeciﬁed local levels αi,n, i = 1, . . . , n.

Remark 5.1. For a level α GOF test with αi,n satisfying (1.4) or (1.5), we get

lim
n→∞

min
1≤i≤n

αi,n = 0 or

lim
n→∞

min
1≤i≤n

α=

i,n = 0,

respectively. Thus, it is impossible to construct an asymptotic level α GOF test with
local levels which are all asymptotically bounded away from zero.

Goodness of ﬁt tests in terms of local levels

19

Lemmas 4.1–4.5 and Theorem 5.1 lead to the next lemma that provides the asymptotics

of level α GOF tests with equal local levels.

Lemma 5.1. For one- or two-sided GOF tests with local levels equal to αloc
obtain an asymptotic level α test iﬀ

n , n ∈ N, we

lim
n→∞

αloc
n ·

2 log(log(n)) log(n)

− log(1 − α)

= 1.

The rather technical and straightforward proof will be presented in a forthcoming

paper.

Remark 5.2. Lemma 5.1 is up to now the most precise result concerning the asymptotics
of the test with equal local levels. For example, adapting Theorem 4.1 in the third version
of [27] leads to an asymptotic interval for αloc
n . Moreover, results in [20] and [21] can be
seen as a very rough approximation for the rate given in Lemma 5.1.

6. Comparison of GOF tests in the ﬁnite case

In this section, we compare one-sided versions of KS tests ϕKS, HC tests ϕHC and GOF
tests ϕ(αloc
n ) with equal local levels for a ﬁnite sample size n. In order to compare these
tests in a fair way, all considered tests will be of exact level α. That is, for ﬁxed n ∈ N
and α ∈ (0, 1) we determine parameters of the considered tests, that is, ﬁnd c for the KS
test with critical values i/n− c/√n, i = 1, . . . , n, a parameter d for the HC test based on
hi,n(d), i = 1, . . . , n, given in (2.6) and αloc
n for the GOF test with equal local levels, so
that

E0(ϕKS) = E0(ϕHC) = E0(ϕ(αloc

n )) = α.

Clearly, such parameters can be found numerically, for example, via some search algo-
rithm, whenever the probability to reject the true null hypothesis can be numerically cal-
culated. Thereby, the computation of the joint c.d.f. of the order statistics U1:n, . . . , Un:n,
that is, P(Ui:n ≤ ci, i = 1, . . . , n), plays the key role in the one-sided case, while the com-
putation of P(ci < Ui:n < ˜ci, i = 1, . . . , n) is crucial in the two-sided case. Probabilities of
the ﬁrst type can be calculated by Noe’s, Bolshev’s, Steck’s or Khmaladze’s recursions,
P(ci < Ui:n < ˜ci, i = 1, . . . , n) can be calculated by Noe’s, Ruben’s or Khmaladze’s recur-
sions, for example, cf. [22] and pages 357–370 in [31]. If the sample size n is so large that
exact computations are no longer possible, that is, n ≫ 104, the parameters d and αloc
can approximately be calculated via numerical simulations.
For example, for α = 0.05 and n = 100, 500, 1000 we get by numerical calculations
E0(ϕHC) = α for d = 4.725, 4.734, 4.736, respectively, E0(ϕKS) = α for c = 1.22387
and E0(ϕ(αloc
n = 0.00246, 0.00145, 0.00122, respectively. The asymptotic
local level in Lemma 5.1 is equal to 0.00365, 0.00226, 0.00192 for α = 0.05 and n =
100, 500, 1000, respectively, so that the asymptotic local level seems to be larger than the
ﬁnite counterpart αloc
n .

n )) = α for αloc

n

20

V. Gontscharuk, S. Landwehr and H. Finner

levels curves corresponding to HC tests ϕHC based on hi,n(d) with
Figure 7. Local
d = 4.725, 4.734, 4.736 (curves from top to bottom) for n = 100, 500, 1000, respectively, leading
to E0(ϕHC) = 0.05, and the corresponding local levels αloc
n = 0.00246, 0.00145, 0.00122 (straight
lines from top to bottom) that imply E0(ϕ(αloc
n )) = 0.05 for GOF tests with local levels equal
αloc

n . The right graph is zoomed.

Figure 7 shows local levels curves of the level α HC tests together with equal local levels
αloc
n (straight lines) for n = 100, 500, 1000. Local levels of the corresponding KS tests are
given in Figure 1. Note that almost all local levels of the HC tests are smaller than the
corresponding αloc
n and only the ﬁrst ones are larger, for example, for n = 100, 500, 1000
n if i ≤ 3, 4, 5, respectively, and αi,n < αloc
we get αi,n ≥ αloc
n else. This indicates higher
sensitivity of the GOF test with equal local levels in a speciﬁc intermediate range than
by the HC tests.

Now we consider the aforementioned level α GOF tests in terms of their rejection
curves. Figure 8 shows rejection curves for n = 100. Here, critical values induced by
ϕ(αloc
n ) are larger than the corresponding HC critical values for i ≥ 4 and only slightly
smaller than the KS critical values in a speciﬁc central range, while the latter are consid-
erably smaller in tails. Moreover, although all considered tests are level α tests, almost all
of the HC critical values are considerably smaller than the corresponding critical values
of the GOF test ϕ(αloc
n ) with equal local levels. It indicates that the smallest critical
values have the biggest impact on E0(ϕ) for any GOF test ϕ while other critical values
inﬂuence E0(ϕ) only slightly. Further exact calculation showed that a similar picture is
observed for various n-values.

Altogether, it seems that the level α GOF tests with equal local levels oﬀer a good
alternative to the classical GOF tests especially if it is not clear what kind of deviation
from the null hypothesis may occur. For power comparisons between GOF tests with
equal local levels and other GOF tests see [1, 14] and [21].

Goodness of ﬁt tests in terms of local levels

21

Figure 8. Rejection curves of the level α GOF tests ϕHC, ϕ(αloc
n ) and ϕKS together with the
diagonal (from top to bottom in 0.5, respectively) for n = 100, α = 0.05, ϕHC based on hi,n(d),
n = 0.00246 and ϕKS based on i/n − c/√n,
i = 1, . . . , n, with d = 4.725, ϕ(αloc
i = 1, . . . , n with c = 1.22387. The right graph is zoomed.

n ) based on αloc

7. Concluding remarks

In this paper, we introduced the concept of local levels αi,n for a certain class of GOF
tests. These quantities serve as an indicator of regions of high/low local sensitivity of
a test and thus provide a method to compare tests with respect to areas of sensitivity.
For example, the classical KS test has higher power for alternatives that diﬀer from the
null distribution in the central range. This coincides with the fact that local levels of
the KS tests are considerably larger in the central range and are even equal to zero for
extremes and smaller intermediates. In high-dimensional data with only sparse signals
that are to be detected, it would be advisable to perform a GOF test (or related multiple
tests) which is sensitive in the tails. In such situations performing HC tests, which are
asymptotically sensitive only in the moderate tails, would be an advantage. Due to the
fact that the number of local levels corresponding to central ranks is considerably higher
than the number of local levels corresponding to intermediate ranks, one may guess that
the HC local levels αin,n for central ranks are much smaller than their counterparts in
the moderate tails. Therefore, it is a rather striking result that central local levels are
indeed asymptotically as large as the ones in the moderate tails. The reason for this
may be hidden in the complex dependence structure of order statistics, so that a further
investigation in this direction is needed. In general, it seems to be an interesting issue
to analyze local levels of other multiple testing related GOF tests, thus gaining deeper
insight into their nature. Figure 2 suggests that the Berk–Jones test comes close to the
equal local levels test. It might be of interest to compare the asymptotic local levels
of these tests as outlined in this paper for the HC test. An additional diﬃculty is that

22

V. Gontscharuk, S. Landwehr and H. Finner

explicit critical values needed in (1.2) and (1.3) are hard to obtain for the Berk–Jones
test as well as for most of the other phi-divergence tests.

Furthermore, the concept of local levels may be used to construct new tailored GOF
tests if one has an idea in which region, that is, for which kinds of alternatives, a test
needs to be sensitive. Given a set of suitable local levels we illustrated a way how to
construct the corresponding GOF test. Moreover, by means of results related to the
HC tests we showed that there is no level α GOF tests with local levels asymptotically
uniformly bounded away from zero. In view of the fact that most of the HC local levels
are asymptotically equal and that the ﬁrst HC local levels are much too large so that
the remaining ones are too small in the ﬁnite case, the GOF test with equal local levels
αi,n ≡ αloc
n seems to be a good alternative for the classical HC test, which is known for
its extremely slow asymptotics. Although we do not have any explicit formula for the
local level αloc
n as a function of the sample size n and predeﬁned level α, we provide an
asymptotic rate for αloc

n leading to the asymptotic level α test.

Appendix A: Proofs of Sections 2 and 3

Proof of Lemma 2.1. Setting An = 4(d2
hin,n(dn(t)) can be represented as

n + n)i2

n/(n(d2

n + 2in)2), a critical value hin,n ≡

hin,n = (d2

n + 2in)(1 −p1 − An)/(2(d2
the Taylor series 1 − √1 − x = x/2 + O(x2) for x ∈ (0, 1), we get

(i) Let in be such that in = o(un). Since An = O(i2

n/u2

n + n)).

(A.1)

n), An → 0 as n → ∞. Applying

hin,n = (d2
= i2

n + 2in)/(2(d2
n/(n(d2

n + 2in)) + O(i4

n/(nu3

n))

n + n))[2(d2

n + n)i2

n/n/(d2

n + 2in)2 + O(i4

n/u4

n)]

and hence nunhin,n/i2

n + 2in) + O(i2

n = un/(d2
d2
n = 2un + log(un) + 2t − log(π) + O(log(un)2/un)

n). Noting that

n/u2

and 1/(2 + x) = 1/2 − x/4 + O(x2) for x ∈ (0, 1), we get
log(un) + 2t − log(π) + 2in

un

=

4un

d2
n + 2in

1
2 −

(A.2)

(cid:19)

+ O(cid:18) log(un)2 + i2

u2
n

n

and consequently (2.11) follows.

(ii) Let cn ≡ un/in → c as n → ∞ for some ﬁxed c > 0. Obviously, An = [(d2

n +
2in)/(2in)]−2(1 + O(un/n)). Since (1 + x)−2 = 1 − 2x + O(x2) for x ∈ (0, 1), (A.2) leads
to

(cid:20) d2

n + 2in

2in

(cid:21)−2

=(cid:20)(1 + cn) +

log(un) + 2t − log(π)

2in

+ O(cid:18) log(un)2

n (cid:19)(cid:21)−2

u2

Goodness of ﬁt tests in terms of local levels

23

=

1

(1 + cn)2(cid:20)1 −

log(un) + 2t − log(π)

in(1 + cn)

n (cid:19)(cid:21).
+ O(cid:18) log(un)2

u2

Since 1 −p1 − a(1 − x) = 1 − √1 − a − ax/(2√1 − a) + O(x2) for a > 0 and x ∈ (0, 1),

we get

1 −p1 − An = 1 −pc2

n + 2cn
1 + cn −

log(un) + 2t − log(π)
n + 2cn

2in(1 + cn)2pc2

+ O(cid:18) log(un)2
n (cid:19).

u2

= (d2

n + 2in)/(2n)[1 + O(d2

n/n)] = (in/n)[1 + d2

n/(2in) + O(un/n)]

log(un) + 2t − log(π)

2in

+ O(log(un)2/u2

n)(cid:21).

Furthermore,

d2
n + 2in
2(d2
n + n)

Formula (A.1) immediately leads to

= (in/n)(cid:20)1 + cn +
hin,n = in(cid:16)1 + cn −pc2

n + 2cn(cid:17)/n

×h1 + O(log(un)2/u2

n) − (log(un) + 2t − log(π))/(cid:16)2inpc2

n + 2cn(cid:17)i

and hence, we get (2.12).

(iii), (iv) Now, let un = o(in). Due to 1/(1 + x)2 = 1 − 2x + 3x2 + O(x3) for x ∈ (0, 1),

we get

An = (d2

n + n)/n[(d2

= 1 −

d2
n

in(cid:18)1 −

d2
n

n + 2in)/(2in)]−2 =(cid:18)1 +
n(cid:19)(cid:20)1 −
n(cid:19) + O(cid:18) d6
n(cid:19) +
n(cid:19).

n(cid:18) 3

4 −

d4
n
i2

n
i3

in

in

d2
n
in

+

3d4
n
4i2
n

n(cid:19)(cid:21)
+ O(cid:18) d6

n
i3

Hence, for in such that un = o(in(1 − in/n)) we arrive at

An = 1 − 2un(1 − in/n)/in − (log(un) + 2t − log(π))(1 − in/n)/in

+ O(u2

n/i2

n + log(un)2(1 − in/n)/(inun))

and for in such that n − in = O(un) we obtain
n(1 + 2(n − in)/un)/i2

An = 1 − u2

n − un(log(un) + 2t − log(π))/i2

n

× (1 + (n − in)/un) + O(log(un)2/i2
n).

Then

1 −p1 − An = 1 −s 2un

in (cid:18)1 −

in

n(cid:19) −

log(un) + 2t − log(π)

2√2inun

p1 − in/n

24

V. Gontscharuk, S. Landwehr and H. Finner

for in such that un = o(in(1 − in/n)) and

1 −p1 − An = 1 −

if n − in = O(un). Since

d2
n + 2in
2(d2
n + n)

log(un)2
√inu3/2

n p1 − in/n(cid:19)

log(un) + 2t − log(π)

2in

+ O(cid:18) log(un)2
inun (cid:19)

u3/2
n

+ O(cid:18)

+

un

i3/2

n − in
un −

1 + (n − in)/un

n p1 − in/n
inr1 + 2
p1 + 2(n − in)/un
2n(cid:19)(cid:20)1 −
n2(cid:19)(cid:21)
+ O(cid:18) u2
=(cid:18) in
n(cid:20)1 +(cid:18)1 −

d2
n
n

d2
n

×

in

=

+

n

n

2in

n (cid:19) 2un + log(un) + 2t − log(π)
n/(nin) + (1 − 2in/n) log(un)2/(unin))(cid:21)

2in

+ O(u2

for all in ≤ n, we get for in such that un = o(in(1 − in/n))

hin,n =

in (cid:18)1 −

in

n(cid:19) −

log(un) + 2t − log(π)

2√2inun

r1 −

in
n

+ (1 − 2in/n)(2un + log(un) + 2t − log(π))/(2in)

(A.3)

in

n(cid:20)1 −s 2un
+ O(cid:18)
n(cid:20)1 −
×(cid:18)1 +

un
in

in

u3/2
n

log(un)2
√inu3/2

n r1 −

in

n(cid:19)(cid:21)

+

i3/2

n p1 − in/n
(1 +p1 + 2(n − in)/un) −
inun (cid:19)(cid:21)
p1 + 2(n − in)/un(cid:19) + O(cid:18) log(un)2

1 + (n − in)/un

2in

log(un) + 2t − log(π)

and

hin,n =

for in with n − in = O(un).
Proof of Theorem 3.1. We only prove (3.1)–(3.3). The cases (3.4)–(3.6) can be handled
analogously. For n ≥ 4, hin,n ≤ 1/4 and |in − nhin,n| ≤ √n/2 we obtain
+ O(cid:18) (in − nhin,n)3

(in − nhin,n)2
2n(1 − hin,n)

P(Xn = in)
P(Yn = in)

n2(cid:19),

= 1 −

in
2n

i2
n

n2

+

+

(cid:3)

Goodness of ﬁt tests in terms of local levels

cf. formula (17) in [29]. Therefore, (2.11)–(2.13) in Lemma 2.1 lead to

αin,n = P(Yn ≥ in)[1 + o(1)]

Moreover, for in = o(pn/un) we get

αin,n = P(Yn = in) 1 +

1 < 1 +

∞Xk=1

kYj=1

nhin,n
in + j ≤

nhin,n

in + j![1 + o(1)],

at least for in = o(pn/un).
kYj=1
∞Xk=1
in + 1(cid:19)k
∞Xk=0(cid:18) nhin,n

in − nhin,n + 1

in + 1

=

cf. [31], page 485. Since nhin,n/in < 1 for larger n-values, we get

25

(A.4)

for in = o(pn/un). Hence, limn→∞(in + 1)/(in − nhin,n + 1) = 1 in case in = o(un), that

is, (3.1) follows. For in such that un/in → c > 0, n → ∞,
1

in + 1

and for a ﬁxed k ∈ N

n→∞  kYj=1

lim

lim
n→∞

in − nhin,n + 1

=

√c2 + 2c − c
in + j!.(cid:18) nhin,n
in + 1(cid:19)k

nhin,n

= 1,

which implies (3.2). Furthermore, from known asymptotic decompositions for the in-
[12, 17] and [2], page 140) and from the fact
complete gamma function (e.g., cf.

that for in = o(pn/un) such that un = o(in) it holds in → ∞, nhin,n → ∞ and
(in − nhin,n)/pnhin,n → ∞, n → ∞, we obtain

P(Yn ≥ in) = in/(in − nhin,n − 1)P(Yn = in)[1 + o(1)].

This together with (2.13) and (A.4) imply (3.3).

(cid:3)

Appendix B: Proofs of Section 4

Proof of Lemma 4.1. With respect to Theorem 3.1, it suﬃces to calculate P(Yn = in),
where Yn ∼ P(nhin,n). Obviously,
P(Yn = in) = (iin

n /in!)[(nhin,n/in) exp(−nhin,n/in)]in .

Since (2.11) implies nhin,n/in = o(1) and x exp(−x) = x − x2 + O(x3) for x ∈ (0, 1), we
obtain

P(Yn = in) = (iin

n /in!)[(nhin,n/in) − (nhin,n/in)2 + O(nhin,n/in)3]in .

26

V. Gontscharuk, S. Landwehr and H. Finner

Setting representation (2.11) for a critical value hin,n in the equation above, we get

P(Yn = in) = (Bn/in!)(i2

n/2un)in ,

(B.1)

where

2un

log(un) + 2t − log(π) + 3in

+ O(cid:18) log(un)2 + i2

Bn =(cid:18)1 −
= exp(in log(1 − (log(un) + 2t − log(π) + 3in)/(2un) + O((log(un)2 + i2
Since in/un → 0 as n → ∞ and log(1 − x) = −x + O(x2) as x → 0, it follows
Bn = exp(cid:18)−in(cid:20) log(un) + 2t − log(π) + 3in
(cid:19)(cid:21)(cid:19).

+ O(cid:18) log(un)2 + i2

(cid:19)(cid:19)in

2un

u2
n

u2
n

n

n

n)/u2

n))).

(B.2)

Particularly, for in = o(√un) we get Bn = 1 + o(1), so that (B.1) immediately leads to
(4.5). Finally, the Stirling formula (4.1), (B.1) and (B.2) imply (4.3).

(cid:3)

Proof of Lemma 4.2. Due to Theorem 3.1, we have to calculate

P( ˜Yn = n − in) = (n − nhin,n)n−in exp(−n + nhin,n)/(n − in)!.
n) and 1 + (1 + cn)/√1 + 2cn = 2 + O(c2

Setting cn ≡ (n− in)/un, we get cn → 0 as n → ∞. In order to simplify (2.14), we obtain
1 + √1 + 2cn = 2 + cn − c2

n/2 + O(c3

n). Then

nhin,n = in − un(2 + cn − c2

n/2) − log(un) − 2t + log(π)

n + log(un)2/un),

+ O(unc3

n + log(un)c2
π exp(−2t)

un log(n)2 exp(2(n − in))
× exp((n − in)[cn/2 + O(c2

[1 + O(log(un)2/un)]

n + cn log(un)/un)])

(B.3)

exp(−n + nhin,n) =

and

(n − nhin,n)n−in
= (2un)n−in exp((n − in) log((n − nhin,n)/(2un)))
= (2un)n−in exp(cid:18)(n − in) log(cid:18)1 + cn +

log(un) + 2t − log(π)

2un

+ O(c2

n + log(un)2/u2

n)(cid:19)(cid:19).

Taylor’s series log(1 + x) = x + O(x2) for x ∈ (0, 1) leads to

(n − nhin,n)n−in
= (2un)n−in exp(cid:18)(n − in)(cid:18)cn +

log(un) + 2t − log(π)

2un

+ O(c2

n + log(un)2/u2

n)(cid:19)(cid:19).

First, we have to calculate xn. From (2.13), we get

αin,n = exp(−x2

n + x3

n/2)/(√2πxn)[1 + O(1/x2

n/qnhin,n(1 − hin,n))].
nhin,n(1 − hin,n) = in(1 − in/n)[1 + O(qun/(in(1 − in/n)))]
qnhin,n(1 − hin,n) =pin(1 − in/n)[1 + O(qun/(in(1 − in/n)))].

and hence

Goodness of ﬁt tests in terms of local levels

27

Combining (3.4), (B.3) and the last expression we get (4.8) in case n − in = o(√un) and
applying Stirling’s formula (4.1) to (n − in)! we get (4.6).
Proof of Lemma 4.3. Formula (3.7) in Theorem 3.2 implies

(cid:3)

(B.4)

Regarding to (A.3), we arrive at

where εn(in) =pun/(in(1 − in)) + log(un)2/u2

in − nhin,n =p2in(1 − in/n)un[1 + (log(un) + 2t − log(π))/(4un) + O(εn(in))],
xn =p2in(1 − in/n)un[1 + (log(un) + 2t − log(π))/(4un) + O(εn(in))]
pin(1 − in/n)[1 + O(pun/(in(1 − in/n)))]
= √2un[1 + (log(un) + 2t − log(π))/(4un) + O(εn(in))]

n. Hence,

and

x2
n = 2un + log(un) + 2t − log(π) + O(unεn(in)).

This, the fact that 1/xn = 1/√2un[1 + O(log(un)/un)] and (B.4) lead to
αin,n = 1/(2√πun) exp(−un − log(un)/2 − t + log(π)/2)
n /pin(1 − in/n))]

× [1 + O(log(un)/un + u3/2

and hence (4.9) follows.

(cid:3)

Proof of Lemma 4.4. We restrict our attention to in ∈ B0 ∪ Bc. The other case can
be proved similarly. Combining (3.3) and (4.1), we get

αin,n = Cn/(2√πun)[1 + o(1)]

(B.5)

with Cn ≡ [(nhin,n/in) exp(1 − nhin,n/in)]in . It holds

Cn = exp(in log((nhin,n/in) exp(1 − nhin,n/in))).

28

V. Gontscharuk, S. Landwehr and H. Finner

From (2.13), we get 1− nhin,n/in = O(pun/in). Applying log((1− x) exp(x)) = −x2/2−

x3/3 + O(x4) for x ∈ (0, 1), we arrive at

Cn = exp(in{−(1 − nhin,n/in)2/2 − (1 − nhin,n/in)3/3 + O((un/in)2)}).

Lemma 2.1 leads to

1 − nhin,n/in =p2un/in +
(1 − nhin,n/in)2 =

2un
in

+

log(un) + 2t − log(π)

2√2inun
log(un) + 2t − log(π)

−

in

−

un
in
2√2u3/2

n
i3/2
n

+ o(un/in),

+ o(u3/2

n /i3/2
n )

and

Then

(1 − nhin,n/in)3 = 2√2u3/2

n /i3/2

n + o(u3/2

n /i3/2

n ).

Cn = exp(cid:18)−un −
= exp(−t)√π/(log(n)√un) exp(√2u3/2

log(un) + 2t − log(π)

2

n

√2u3/2
3√in

n√in(cid:19)(cid:19)
+ o(cid:18) u3/2
+
n /(3√in)(1 + o(1)))
n).

and hence (B.5) yields (4.10) for in fulﬁlling un = o(in) and in = O(u3

(cid:3)

Proof of Lemma 4.5. Formulas (3.2) and (3.5) provide that in order to ﬁnd αin,n we
have to calculate P(Yn = in) and P( ˜Yn = n − in).
for x ∈ (0, 1) and k ∈ N, formula (2.12) implies

We start with the case cn ≡ un/in → c > 0. Noting that (1 − x)k = exp(−kx + O(kx2))

(cid:18) nhin,n
in (cid:19)in

= (δ(cn))in exp(cid:18)−

log(un) + 2t − log(π)

n + 2cn

2pc2

+ O(cid:18) log(un)2

un (cid:19)(cid:19).

Applying the Stirling formula (4.1) and (2.12), we arrive at

P(Yn = in) = (nhin,n/in)in /√2πin exp(in − nhin,n)

= [δ(cn) exp(1 − δ(cn))]in /√2πin(√π exp(−t)/√un)(1−δ(cn))/√c2
× (1 + O(log(un)2/un)).

n+2cn

Therefore, (3.2) implies (4.11).

Now let in be such that cn ≡ (n − in)/un → c > 0. Similarly as above, (2.14) implies

n − in (cid:19)n−in
(cid:18) n − nhin,n

= [(1 + cn + √1 + 2cn)/cn]n−in
× exp(cn/√1 + 2cn(log(un) + 2t − log(π))/2 + O(log(un)2/un)).

Goodness of ﬁt tests in terms of local levels

Then

P( ˜Yn = n − in) =(cid:20) n − nhin,n

n − in

(cid:21)n−in.p2π(n − in) exp(nhin,n − in)
= [(1 + cn + √1 + 2cn)/cn]n−in /p2π(n − in)
× (√π exp(−t)/√un)1+1/√1+2cn log(n)−(1+√1+2cn)
× (1 + O(log(un)2/un))

and (3.5) lead to (4.12).

Appendix C: Proofs of Section 5

29

(cid:3)

Proof of Theorems 5.1. Formula (5.1) for the case (i) immediately follows from
Lemma 4.3. Here we prove (5.1) for (ii)–(v), (5.2) for (vi)–(ix), (5.3) for (i(1)
n ) ∈
B0 × B0 such that (iv), (viii) are not fulﬁlled and (5.3) for (i(1)
n ) ∈ ¯B0 × ¯B0
such that (v), (ix) are not fulﬁlled. Lemma C.2 shows (5.2) for (x), (xi), (5.3) for
n ) ∈ Ac × Ac, c > 0, such that (x) is not fulﬁlled and (5.3) for (i(1)
(i(1)
n , i(2)
n ) ∈ ¯Ac × ¯Ac,
c > 0 such that (xi) is not fulﬁlled. The remaining cases for (5.3) are proved in Lemmas
C.1, C.3, C.4, C.5 and C.6.

n , i(2)

n , i(2)

n , i(2)

For (i(1)

n , i(2)

n ) ∈ (B0 ∪ Bc) × (B0 ∪ Bc) Lemma 4.4 yields

αi(2)

n ,n/αi(1)

n ,n = exp(cid:16)−

√2u3/2

n /(cid:16)3qi(1)

n (cid:17)(cid:16)1 −qi(1)

n /i(2)

n (cid:17)[1 + o(1)](cid:17).

This implies (5.1) for (ii) and (5.2) for (i(1)
n ) ∈ Bc1 × Bc2 with c1 < c2, that is, (5.2)
for a partial case of (vi). Moreover, Lemmas 4.3 and 4.4 immediately yield the remaining
cases of (vi).

n , i(2)

n ). Clearly, we get (5.1) if bn → 0,

For i(1)

n ∈ B0 deﬁne bn ≡ u3/2

n /i(2)
(5.2) if bn → c > 0 and (5.3) in case bn → ∞. Note that

n (1 −qi(1)

n /qi(1)
n = 1 − bnqi(1)

n /i(2)
i(1)

n /u3/2

n (cid:16)2 + bnqi(1)

n /u3/2

n (cid:17).

If bn → 0 as n → ∞, that is, i(1)
get (5.2) for (viii), when bn → b for some b > 0 and (5.3) in case bn → ∞.

Finally, (iii), (v), (vii) and (ix) can be proved in a similar way.

n /u3/2

n /i(2)

n = 1 + o(qi(1)

n ), then we get (5.1) for (iv). We

(cid:3)

Lemma C.1. Let {i(1)
n , i(2)
(i(1)

n ) ∈ A0 × A0 or (i(1)

n }n∈N and {i(2)

n }n∈N be such that i(1)

n < i(2)
n ) ∈ ¯A0 × ¯A0. Then (5.3) is fulﬁlled.

n , i(2)

n , n ∈ N, and either

30

V. Gontscharuk, S. Landwehr and H. Finner

n ∈ A0, j = 1, 2. If i(2)

Proof. First, let i(j)
n ≡ i2 ∈ N for all n ∈ N and n is large enough,
representation (4.5) immediately yields αi2,n/αi1,n = O((2un)i1−i2 ), and hence (5.3) fol-
n → ∞ as n → ∞. Since 1/√2πi and exp(−ivn) in representation
lows. Furthermore, let i(2)
(4.3) decrease as i increases for a ﬁxed larger n, in order to prove (5.3) it suﬃces to show
that

n /un)i(2)
converges to −∞ as n → ∞. Setting xn ≡ i(2)

Bn ≡ log((γi(2)

n − i(1)

n /(γi(1)

n /un)i(1)
n )

n , we obtain

n ) log(i(2)

n ) − log(i(1)

n )].

n dn log(un/γ)(1 + o(1)), that

n [(−xn/i(1)

n ) log(un/γ) + (1 + xn/i(1)

Bn = i(1)
n → d for a d > 0 or d = ∞, we get Bn = −i(1)

If dn ≡ xn/i(1)
is, Bn → −∞ as n → ∞. Hence, (5.3) is fulﬁlled.
For i(j)

n , j = 1, 2, such that xn/i(1)

n = o(1) we get
Bn = −xn log(un/γ) + xn log(i(2)

n ) + i(1)

n log(1 + xn/i(1)
Applying log(1 + x) = x + O(x2) for x ∈ (0, 1) and the fact that i(2)
Bn = −xn log(un/γ)(1 + o(1)), and hence (5.3) follows.
Now, let i(j)
Lemma 4.2 immediately leads to the assertion. For the case n− i(1)

n ∈ ¯A0, j = 1, 2. For i(1)

n such that n − i(1)

n < i(2)

to (4.6) it suﬃces to consider

n ).

n = o(un), we obtain

n is ﬁxed, formula (4.8) in
n → ∞ as n → ∞, due

Dn ≡ (un/(γ(n − in)))n−in /√n − in exp((n − in)wn).

Since

Dn = exp((n − in)[− log(n − in)/(2(n − in)) + log(un/(γ(n − in))) + wn]),

log(un/(γ(n − in))) → ∞ as n → ∞, log(x)/x < 1 for x ≥ 1 and wn = o(1), we arrive at
Dn = exp((n − in) log(un/(γ(n − in)))[1 + o(1)]). Thus, it suﬃces to show that

log((un/(γ(n − i(2)

n )))n−i(2)

n /(un/(γ(n − i(1)

n )))n−i(1)
n )

n }n∈N and {i(2)

converges to −∞ for n → ∞. This can be proved similarly as before.
Lemma C.2. Let {i(1)
that either limn→∞ un/i(j)
but ﬁxed cj > 0. Moreover, let mn ≡ i(2)
and all n ∈ N, (5.2) is fulﬁlled and if mn → ∞ as n → ∞, (5.3) is fulﬁlled.
Proof. First, let cj,n ≡ un/i(j)

n }n∈N be such that i(1)
n = cj, j = 1, 2, or limn→∞(n− i(j)

n < i(2)
n for n ∈ N. We suppose
n ) = cj, j = 1, 2, for arbitrary
n , n ∈ N. If mn = m for some ﬁxed m ∈ N

n → cj > 0, j = 1, 2. For in such that cn ≡ un/in → c > 0

n − i(1)

(cid:3)

formula (4.11) in Lemma 4.5 implies

αin,n = exp(f1(cn)un + f2(cn) log(un) + f3(cn) + o(1)),

Goodness of ﬁt tests in terms of local levels

31

where

f1(c) = (1/c) log(δ(c)/ exp(δ(c) − 1)),

f2(c) = −1 + c/(2pc2 + 2c),
f3(c) = log(√c/((1 − δ(c))√2π)) + (1 − δ(c))/pc2 + 2c log(√π exp(−t)).

It follows

αi(2)

n ,n/αi(1)

n ,n = exp((f1(c2,n) − f1(c1,n))un + (f2(c2,n) − f2(c1,n)) log(un)

+ f3(c2,n) − f3(c1,n) + o(1)).

Since f1(·) is strictly increasing, (5.3) is fulﬁlled in case c1 > c2. Now, let c1 = c2. Hence,

n ,n

αi(2)
αi(1)

n ,n

= exp((f1(c2,n) − f1(c1,n))un + (f2(c2,n) − f2(c1,n)) log(un) + o(1)).

Setting xn ≡ i(2)

n − i(1)

n and noting that xn = o(un), we get

n ) = c2,n[1 + c2,nxn/un + O(x2

n/u2

n)],

c1,n = c2,n/(1 − xn/i(2)
f1(c1,n) = f1(c2,n) + c2,nhc2,n/qc2

and f2(c1,n) = f2(c2,n) + O(xn/un). Therefore,

n/u2
n)

2,n + 2c2,n − 1 − f1(c2,n)ixn/un + O(x2
2,n + 2c2,n + o(1)i(cid:17).

αi(2)

n ,n/αi(1)

n ,n = exp(cid:16)xnc2,nh1 + f1(c2,n) − c2,n/qc2

Since 1 + f1(c) − c/√c2 + 2c < 0 for c ∈ (0,∞), we get (5.2) if xn = x for some x ∈ N
and (5.3) if xn → ∞ as n → ∞.
The case cj,n ≡ (n − i(j)
Lemma C.3. Let {i(1)
n → ∞, for some c > 0. Then (5.3) is fulﬁlled.
Proof. Formulas (4.3) and (4.11) yield

n )/un → cj , j = 1, 2, can be proved similarly.

n = o(un) and cn ≡ un/i(2)

n }n∈N be such that i(1)

n }n∈N and {i(2)

n → c,

(cid:3)

log(cid:18) αi(2)

n ,n(cid:19) = un(cid:20)−(cid:18) 1

αi(1)

n ,n

2

+

1
cn

+

1 − δ(cn)

n + 2cn(cid:19) log(un)
2pc2
exp(δ(cn) − 1)(cid:19) −
log(cid:18)

δ(cn)

un

+

log(i(1)
n )
2un

+

i(1)
n
un

vn

i(1)
n
un

log(cid:18)γ

i(1)
n

un(cid:19) + o(1)(cid:21).

Since i(1)
(0,∞), we obtain log(αi(2)

n /un = o(1) and limx→0 x log(x) = 0 and log(δ(c)/ exp(δ(c) − 1)) < 0 for all c ∈

n ,n/αi(1)

n ,n) → −∞ as n → ∞ and hence (5.3) follows.

(cid:3)

32

V. Gontscharuk, S. Landwehr and H. Finner

Lemma C.4. Let {i(1)
some c > 0, i(2)
n = O(u3

n }n∈N and {i(2)
n) and un = o(i(2)

n }n∈N be such that cn ≡ un/i(1)
n ). Then (5.3) is fulﬁlled.

n → c, n → ∞, for

Proof. Formulas (4.10) and (4.11) imply

log(αi(2)

n ,n/αi(1)

n ,n) = −[1 + (1/cn) log(δ(cn)/ exp(δ(cn) − 1))]un + o(un).

Since cn → c > 0 as n → ∞ and log(δ(c)/ exp(δ(c) − 1))/c > −1 for all c ∈ (0,∞), we
immediately obtain (5.3).

(cid:3)

Lemma C.5. Let {i(1)
and cn ≡ (n − i(2)

n )/un → c, n → ∞, for some c > 0. Then (5.3) is fulﬁlled.

n }n∈N and {i(2)

n }n∈N be such that n− i(1)

n = O(u3

n), un = o(n− i(1)
n )

Proof. Formulas (4.10) and (4.12) lead to

log(cid:18) αi(2)

n ,n(cid:19) = −(cid:20)√1 + 2cn − cn log(cid:18) 1 + cn + √1 + 2cn

αi(1)

n ,n

cn

(cid:19)(cid:21)un + o(un).

Noting that √1 + 2c − c log((1 + c + √1 + 2c)/c) > 0 for all c ∈ (0,∞), we get (5.3). (cid:3)
Lemma C.6. Let {i(1)
n )/un → c, n → ∞, for
some c > 0 and n − i(2)

n }n∈N and {i(2)
n = o(un). Then (5.3) is fulﬁlled.

n }n∈N satisfy cn ≡ (n − i(1)

Proof. Formulas (4.6) and (4.12) lead to

log(cid:18) αi(2)

n ,n(cid:19) =(cid:20)−1 + √1 + 2cn − cn log(cid:18) 1 + cn + √1 + 2cn

αi(1)

n ,n

cn

(cid:19)(cid:21)un + o(un).

Since −1 + √1 + 2c − c log((1 + c + √1 + 2c)/c) < 0 for all c ∈ (0,∞), (5.3) is fulﬁlled. (cid:3)

Acknowledgements

The authors sincerely thank the referees for numerous helpful and constructive comments
and suggestions and several hints for additional references. Special thanks are due to the
Editor E. Moulines for his patience in handling the manuscript. This work was supported
by the Ministry of Science and Research of the State of North Rhine-Westphalia (MIWF
NRW) and the German Federal Ministry of Health (BMG).

References

[1] Aldor-Noiman, S., Brown, L., Buja, A., Rolke, W. and Stine, R. (2013). The power

to see: A new graphical test of normality. Am. Stat. 67 249–260. MR3280623

Goodness of ﬁt tests in terms of local levels

33

[2] Bateman, H. and Erdelyi, A. (1953). Higher Transcendental Functions, Vol. 2. New

York: McGraw-Hill.

[3] Berk, R.H. and Jones, D.H. (1978). Relatively optimal combinations of test statistics.

Scand. J. Stat. 5 158–162. MR0509452

[4] Berk, R.H. and Jones, D.H. (1979). Goodness-of-ﬁt test statistics that dominate the
Kolmogorov statistics. Z. Wahrscheinlichkeitstheor. Verw. Geb. 47 47–59. MR0521531
[5] Buja, A. and Rolke, W. (2006). Calibration for simultaneity: (Re)Sampling methods for
simultaneous inference with applications to function estimation and functional data.
Unpublished.

[6] Cai, T.T., Jin, J. and Low, M.G. (2007). Estimation and conﬁdence sets for sparse normal

mixtures. Ann. Statist. 35 2421–2449. MR2382653

[7] David, H.A. and Nagaraja, H.N. (2003). Order Statistics, 3rd ed. Wiley Series in Prob-

ability and Statistics. Hoboken, NJ: Wiley. MR1994955

[8] Donoho, D. and Jin, J. (2004). Higher criticism for detecting sparse heterogeneous mix-

tures. Ann. Statist. 32 962–994. MR2065195

[9] Donoho, D. and Jin, J. (2008). Higher criticism thresholding: Optimal feature selection
when useful features are rare and weak. Proc. Natl. Acad. Sci. USA 105 14790–14795.
[10] Donoho, D. and Jin, J. (2009). Feature selection by higher criticism thresholding achieves
the optimal phase diagram. Philos. Trans. R. Soc. Lond. Ser. A Math. Phys. Eng. Sci.
367 4449–4470. MR2546396

[11] Eicker, F. (1979). The asymptotic distribution of the suprema of the standardized empir-

ical processes. Ann. Statist. 7 116–138. MR0515688

[12] Ferreira, C., L´opez, J.L. and P´erez Sinus´ıa, E. (2005). Incomplete gamma functions

for large values of their variables. Adv. in Appl. Math. 34 467–485. MR2123546

[13] Finner, H., Dickhaus, T. and Roters, M. (2009). On the false discovery rate and an

asymptotically optimal rejection curve. Ann. Statist. 37 596–618. MR2502644

[14] Gontscharuk, V., Landwehr, S. and Finner, H. (2014). The intermediates take it all:
Asymptotics of higher criticism statistics and a powerful alternative based on equal
local levels. Biom. J. 57 159–180.

[15] Hall, P. and Jin, J. (2008). Properties of higher criticism under strong dependence. Ann.

Statist. 36 381–402. MR2387976

[16] Hall, P. and Jin, J. (2010). Innovated higher criticism for detecting sparse signals in

correlated noise. Ann. Statist. 38 1686–1732. MR2662357

[17] Ivchenko, G.I. (1974). On comparison of binomial and Poisson distributions. Theory

Probab. Appl. 19 584–587.

[18] Jaeschke, D. (1979). The asymptotic distribution of the supremum of the standardized

empirical distribution function on subintervals. Ann. Statist. 7 108–115. MR0515687

[19] Jager, L. and Wellner, J.A. (2007). Goodness-of-ﬁt tests via phi-divergences. Ann.

Statist. 35 2018–2053. MR2363962

[20] Kaplan,

D.M.

and

KS-type
http://economics.missouri.edu/working-papers/2008.shtml.

inference

on

Goldman,

M.
distributions.

(2014).

Evenly

Preprint.

Available

sensitive
at

[21] Kaplan, D.M. and Goldman, M. (2014). True equality (of pointwise sensitivity) at last:
A Dirichlet alternative to Kolmogorov–Smirnov inference on distributions. Preprint.
Avaliable at http://scholar.google.com/citations?user=c4yK72IAAAAJ&hl=en.

[22] Khmaladze, E. and Shinjikashvili, E. (2001). Calculation of noncrossing probabilities
for Poisson processes and its corollaries. Adv. in Appl. Probab. 33 702–716. MR1860097

34

V. Gontscharuk, S. Landwehr and H. Finner

[23] Leadbetter, M.R., Lindgren, G. and Rootz´en, H. (1983). Extremes and Related Prop-
erties of Random Sequences and Processes. Springer Series in Statistics. New York:
Springer. MR0691492

[24] Lockhart, R.A. (1991). Overweight tails are ineﬃcient. Ann. Statist. 19 2254–2258.

MR1135175

[25] Mary, D. and Ferrari, A. (2014). A non-asymptotic standardization of binomial counts
in higher criticism. In 2014 IEEE International Symposium on Information Theory
(ISIT) 561–565. Piscataway, NJ: IEEE.

[26] Mason, D.M. and Schuenemeyer, J.H. (1983). A modiﬁed Kolmogorov–Smirnov test

sensitive to tail alternatives. Ann. Statist. 11 933–946. MR0707943

[27] Moskovich Eiger, A., Nadler, B. and Spiegelman, C. (2014). The calibrated

Kolmogorov–Smirnov test. Preprint. Available at arXiv:1311.3190.

[28] Nikitin, Y. (1995). Asymptotic Eﬃciency of Nonparametric Tests. Cambridge: Cambridge

Univ. Press. MR1335235

[29] Prohorov, Yu.V. (1953). Asymptotic behavior of the binomial distribution [Russian].

Uspekhi Mat. Nauk 8 135–142. MR0056861

[30] R´ev´esz, P. (1982/83). A joint study of the Kolmogorov–Smirnov and the Eicker–Jaeschke

statistics. Statist. Decisions 1 57–65. MR0685588

[31] Shorack, G. and Wellner, J. (2009). Empirical Processes with Applications to Statistics.

Philadelphia: Society for Industrial and Applied Mathematics.

[32] Smirnov, N.V. (1933). On probabilities of greater deviations [Russian]. Mathem. Sb. 40

443–454.

Received February 2014 and revised October 2014

