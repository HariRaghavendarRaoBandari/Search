Nonlinear Frequency-Division Multiplexing

Mansoor I. Youseﬁ and Xianhe Yangzhang

1

6
1
0
2

 
r
a

 

M
4
1

 
 
]
T
I
.
s
c
[
 
 

1
v
9
8
3
4
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—Two signal multiplexing strategies for multi-user
optical ﬁber communication are considered: Wavelength-division
multiplexing (WDM) and nonlinear frequency-division multiplex-
ing (NFDM), based on the nonlinear Fourier transform (NFT).
The inverse NFT is implemented using an approach that is
dual of the forward NFT and does not require solving integral
equations. In contrast to prior work where NFDM is applied
to single-user channels or combined with WDM, in this paper
users’ signals are multiplexed in the nonlinear Fourier domain.
Furthermore, each user now sends a sequence of symbols.
NFDM orthogonalizes the nonlinear Schr¨odinger equation in a
generalized frequency and a generalized time. Thus all degrees-
of-freedom are (deterministically) independent. A data rate of
10.5 bits per complex degree-of-freedom is achieved in a 15-
user NFDM with 60 GHz overall bandwidth at average input
power P “ ´0.33 dBm. Data rate in a comparable 15-user
WDM with the same bandwidth and power is 5.26 bits per
complex degree-of-freedom. The ratio of the spectral efﬁciency
of NFDM and WDM is 2.23, taking into account bandwidth and
time duration of signals at channel input and output. Thus, as
a result of nonlinear multiplexing of users’ signals, an NFDM
spectral efﬁciency higher than the corresponding WDM spectral
efﬁciency is demonstrated at high input power.

Index Terms—Nonlinear Fourier

nonlinear
frequency-division multiplexing, ﬁber-optic networks, multi-user
communication.

transform,

I. INTRODUCTION

T HIS paper concerns data transmission using the nonlinear

Fourier transform (NFT) [Part I–III] [2]–[4].

It was recently pointed out that one factor contributing to
data rate limitation in current optical ﬁber systems is the
communication method [Part III, Section II]. Based on the
NFT, nonlinear frequency-division multiplexing (NFDM) was
introduced to address this limitation [Part I–III]. In this paper,
we make progress on NFDM.

In Sections II and III, we review the origin of data rate
limitation in current approaches in optical ﬁber networks,
introduce the nonlinear Fourier transform and NFDM. The
presentation is shortened to essentials.

Prior work illustrates how NFDM can be applied with
preliminary data rates. However, an NFDM spectral efﬁ-
ciency higher than the corresponding one in a comparable
wavelength-division multiplexing (WDM) has not yet been
demonstrated. To demonstrate high spectral efﬁciencies, we
consider the nonlinear Schr¨odinger (NLS) equation in the de-
focusing regime. In this case, the operator underlying channel
is self-adjoint, which simpliﬁes computations. The analyticity

The material in this paper was presented, in a poster presentation [1]
and a talk, at the 2015 Munich Workshop on Information Theory of Optical
Fiber. M. I. Youseﬁ is with the Communications and Electronics Department,
T´el´ecom ParisTech, Paris, France. X. Yangzhang is with the Institute for
Communications Engineering, Technical University of Munich, Munich, Ger-
many. Emails: mansoor.isvandyousefi@telecom-paristech.fr
and xianhe.yangzhang@tum.de.

of the log apλq, where apλq is a nonlinear Fourier coefﬁcient,
can be exploited to perform the inverse NFT without solving
integral equations. In Section IV, we simplify, test and apply
existing numerical methods in the defocusing regime. The
forward and inverse numerical algorithms are presented as dual
of one another, i.e., essentially the same algorithms (as in the
Fourier transform).

Multi-user data rates were presented in [Part III]. In par-
ticular,
in Section V. D, “Spectral Efﬁciencies Achievable
by Modulating the Continuous Spectrum,” information was
modulated in the continuous spectrum for each user. However,
in preliminary simulations [Part III, Fig. 9(b)], users’ signals
were still multiplexed linearly, so as to be able to carry out
computations. As a result, NFDM achieved spectral efﬁcien-
cies approximately equal to WDM rates. It was articulated
that, in order to improve existing data rates, NFDM should
eventually be applied to networks — where a “capacity
crunch” occurs [5, Section 6.7. 1], [Part III, Sections II.C,
V. D. and VI. A]. In Sections V and VI, we take the next step
and multiplex users’ signals in a nonlinear manner as required
in NFDM.

Users’ signals are orthogonal in NFDM. To have orthogonal
degrees-of-freedom within each user, a guard time is used
between multi-solitons. In the defocusing regime, NFT is a
one-dimensional function, similar to the Fourier transform.
This allows, as in the additive white Gaussian noise (AWGN)
channel, to pack users’ pulses optimally in a generalized time,
according to Nyquist-Shannon sampling theorem. As a result,
the channel is (deterministically) orthogonalized in a nonlinear
spectral, as well as a temporal domain. Thus, in the defocusing
regime,
the spectral efﬁciency loss due to guard times is
avoided.

In Section VI, we push numerical algorithms to high power
transmission and examine the inﬂuence of noise and stochastic
interference. We continue multi-user simulations in [Part III,
Fig. 9 (b)], with nonlinear multiplexing, and demonstrate
NFDM data rates higher than WDM rates subject to the same
constraints.

We review literature on using NFT for communication
in Section VIII. Here, we also comment on multi-soliton
communication, and explain the way that NFT could usefully
be applied to data transmission.

The above contributions bring NFDM closer to practice, so
that, in the defocusing regime, complexity and numerical accu-
racy remain as limiting factors. Similar results are anticipated
in the focusing regime. Defocusing regime was considered
because of the computational tractability and similarity of the
NFT and Fourier transform.

2

II. FIBER-OPTIC NETWORKS

In this section, we present the NLS model in a network
environment and summarize the origin of data rate limitation
in current approaches.

A. Network NLS Model

Bt2 ´ 2s|q|2q ` npt, zq,

Signal propagation in single-mode single-polarization opti-
cal ﬁber with distributed ampliﬁcation can be modeled by the
stochastic NLS equation. In normalized form, the equation
reads [Part I, Eq. 3]
Bz “ B2q
j Bq

where j “ ?´1, qpt, zq is the complex envelope of the signal
as a function of time t and distance z along the ﬁber, npt, zq
is white Gaussian noise with power spectral density σ2
0, and
s “ ˘1, where s “ 1 (respectively, s “ ´1) corresponds to
the defocusing (respectively, focusing) regime. The signal and
noise are bandlimited to B Hz for all 0 ď z ď L. We refer
the reader to [Part I, Section I] for further details about the
model.

In this paper, we consider a network environment. This
refers to a communication network with the following as-
sumptions [Part III, Section II. B. 3]: (1) There are multiple
transmitter (TX) and receiver (RX) pairs; (2) There are add-
drop multiplexers (ADMs) in the network. The signal of the
user-of-interest can co-propagate with the signals of the other
users in part of the link. The location and the number of ADMs
are unknown; (3) Each TX and RX pair does not know the
incoming and outgoing signals in the path that connects them;
see Fig. 1.

To make use of available bandwidth, data can be modulated
in distinct wavelengths. As a result of using more bandwidth,
data rates, measured in bits per second, were rapidly increased
with the introduction of the wavelength-division multiplexing
in 1990s. However, the communication efﬁciency of WDM,
measured in bits/s/HZ, is low. From a communications point
of view, WDM underlies transmitter strategy. At the receiver,
it is customary to apply some form of back-propagation (BP).
The achievable (per-user) rates of the WDM-BP strategy in
a network environment are shown in Fig. 2. It can be seen
that achievable rates (bits per complex degree-of-freedom)
saturate (or decrease depending on assumptions), as input
power is increased. Although numerous explanations exist
in the literature, inter-channel interference and inter-symbol
interference (ISI) resulting from nonlinearity [6] [Part III,
Section II], as well strong ﬁltering in the presence of spectral
broadening in WDM [7, Section VIII], are the primary reasons
for data rate limitation at high powers in WDM.

B. Origin of Data Rate Limitation in Current Methods

It was understood in the past few years that nonlinear
interactions do not limit capacity in deterministic integrable
optical networks. These interactions arise from methods of
communication, which disregard nonlinearity [Part I–III]. Af-
ter abstracting away non-essential aspects, current methods,

Fig. 2. Achievable rates of the WDM-BP strategy in a network environment.

in essence, modulate linear-algebraic modes of transmis-
sion. These linear multiplexing methods include WDM, time-
division multiplexing (TDM), orthogonal frequency-division
multiplexing (OFDM), space-division multiplexing (SDM),
and pulse-train transmission (see Fig. 3 (a)). When linear mul-
tiplexing is applied to nonlinear channels, interference and ISI
are inevitable. In a network environment interference cannot be
removed, while intra-channel ISI can partially be compensated
for using signal processing. The idea of sharing bandwidth
in WDM, and integration in SDM, conﬂict with nonlinearity.
Since the latter is ﬁxed by physics, it was proposed to replace
the approach [Part I–III].

Youseﬁ and Kschischang recently proposed nonlinear
frequency-division multiplexing which is fundamentally com-
patible with the channel [Part I–III]. NFDM is based on
observation that the NLS equation supports nonlinear eigen-
functions which have a crucial independence property, the key
to build a multi-user system. The tool necessary to reveal
independent signal degrees-of-freedom is the NFT. Based
on that, NFDM was constructed which can be viewed as a
generalization of OFDM to nonlinear optical ﬁber. Exploiting
the integrability property, NFDM modulates non-interacting
degrees-of-freedom. In the absence of noise, in contrast to
WDM, achievable rate of NFDM is inﬁnite (see Section VI).

III. SUMMARY OF NFDM

In this section, we brieﬂy review NFT and NFDM from

[Part I–III].

yptq “ hptq ˙ xptq ` nptq,

Consider linear convolutional waveform channel
x, y, n P L2pRq,

(1)
where xptq and yptq are input and output signals, nptq is white
Gaussian noise, hptq is channel ﬁlter, and ˙ denotes convo-
lution. The continuous-time channel (1) can be discretized by
projecting signals onto an orthonormal basis tenptqunPN of
L2pRq

8ÿ

(cid:32)

(cid:32)
xptq, yptq, nptq

(

(
ekptq,

“

xk, yk, nk

k“1

010203040502468101214log(1+SNR)nonlinearityimpact?SNR[dB]Achievablerate[bits/s/Hz]upperboundmodiﬁedlowerboundlowerboundYOUSEFI AND YANGZHANG

3

Fig. 1. Block diagram of a network environment. MUX denotes multiplexer, which in the current methods is ADM.

Fig. 3.

(a) Linear multiplexing methods. (b) Absolute value of the nonlinear Fourier transform as a 3-dimensional surface on the complex plane.

(a)

(b)

where xk, yk and nk are degrees-of-freedom. This results in
a discrete-time model

yk “ xkxh ˙ ek, eky `
ş

ÿ
looooooooomooooooooon
xixh ˙ ei, eky
xptqy˚ptqdt is the inner product.

interference or ISI

`nk,

i‰k

where qptq is signal. The eigenvalues λ of L are called gen-
eralized frequencies. They are complex numbers whose real
and imaginary parts have physical signiﬁcance. Let vpλ, tq “
rv1, v2sT be an eigenvector of L corresponding to λ. Nonlinear
Fourier coefﬁcients apt, λq and bpt, λq are components of the
normalized eigenvector

ˆ

˙

,

upt, λq “

apt, λq
bpt, λq

where u “ rejλtv1, e´jλtv2sT . Deﬁne apλq ∆“ ap8, λq
and bpλq ∆“ bp8, λq. The value of the NFT at generalized
frequency λ, called the spectral amplitude, is bpλq{apλq.
If λj is in the upper half complex plane C`, it can be
shown that apλjq “ 0, so that the ﬁrst term in Taylor series
of apλq at λj vanishes [Part I, Section IV. B]. As a result, b{a
reduces to b{a1, where prime denotes differentiation. It can be
shown that apλq is an analytic function of λ in C` [Part I,
Lemma 4]. Thus the set of generalized frequencies in C` is
discrete; j P N “ t1,¨¨¨ , Nu.
Deﬁnition 1 (Nonlinear Fourier Transform). The NFT of
signal qptq is

$’’&’’% bpλq

apλq
bpλjq
a1pλjq

,

λ P R,
, λj P C`,

j P N .

NFTpqqpλq “

(3)

where xxptq, yptqy “
Depending on the basis, interference and ISI could refer to
interaction among degrees-of-freedom in any of the methods
in Fig. 3(a).

The Fourier transform F maps convolution in (1) to a

multiplication operator

Y pωq “ Hpωq• Xpωq ` Npωq,

(2)
where Xpωq “ Fpxptqq with convention in [8, Eq. 1]. As a
result, the channel is decomposed into parallel independent
scalar channels. We refer to such independent degrees-of-
freedom as “orthogonal”. OFDM is an implementation of
the discrete version of (2), where information is encoded
in independent spectral amplitudes Xpωq. It follows that the
Fourier transform eliminates interference and ISI in (1). Note
that frequency ω is a conserved quantity in (2).

We explain NFDM in analogy with OFDM. First, we deﬁne

NFT as follows. Consider the operator

¨˚˝ B

L “ j

´qptq
Bt
sq˚ptq ´ B
Bt

˛‹‚,

TXAmpliﬁerspan1span2spanNFiberAmpliﬁerMUXFiberAmpliﬁerMUXFiberAmpliﬁerRXLinearmultiplexingTDMPulse-trainSDMOFDMWDM−4−2024−50501spectrumofL<λ=λ(cid:12)(cid:12)(cid:12)NFT(q)(λ)(cid:12)(cid:12)(cid:12)ba0ba4

A crucial property of the NFT is that, in the absence of

noise

NFTpqpt,Lqqpλq “ Hpλ,Lq NFTpqpt, 0qqpλq,

where H is the channel ﬁlter. For optical ﬁber, the channel
ﬁlter is Hpλq “ e4jsλ2L. If s “ 1, L is self-adjoint
(Hermitian); thus N is empty and frequencies are real.
In NFDM information is modulated in generalized frequen-
cies λ and their spectral amplitudes NFTpλq. In the time
domain, communication takes place over the nonlinear Fourier
basis, instead of plane waves exppjpωt´ kzqq as in OFDM or
WDM. This is a basis made of nonlinear waves: Each element
of the basis is the inverse NFT of one spectral component,
for example a soliton. Superposition of basis elements is
nonlinear, described by integral equations [Part I, Eq. 30].

scheme works if qptq « qpt ´ q as, e.g., in a piece-wise
constant approximation of qptq in Fig. 4 (a).
Equations in the focusing regime in [Part I] can often be
generalized by substitutions

to include the defocusing regime as well. For example, Parse-
val’s identity for the NFT is

ta, a˚u Ñ ta, a˚u,
tb, b˚u Ñ tb,´sb˚u,
8ż
´8 |qptq|2dt “ ´

E “

tq, q˚u Ñtq,´sq˚u,
tˆq, ˆq˚uÑtˆq,´sˆq˚u,
8ż
˘
`

s
π

log

´8

1 ´ s|ˆqpλq|2

dλ.

This implies that |ˆqpλq| ă 1 in the defocusing regime.

IV. INVERSE NFT IN THE DEFOCUSING REGIME

B. Continuous Layer-Peeling (CLP)

It is preferred to recover qptq through an integral represen-
tation instead of the differential representation (4). From [Part
I, Eq. 32]

8ż
8ż

´8

q˚ptq “
paq
“

s
π

s
π

ˆqpλqe2jλtV 1

2 pt, λqdλ

ˆqpt, λqe2jλtdλ,

´8

(8)

(9)

where ˆqpt, λq “ bpt, λq{apt, λq and V 1 is deﬁned in [Part I,
Eq. 27]. Step paq follows from the causality property in [Part
I, Section IV. D]: ˆqpt, λq is in one-to-one relation with qpτq in
τ ď t. Thus, in (8) we can assume qpτq “ 0 for τ ą t, which
gives boundary condition V 1
2 “ 1; see [Part I, Eq. 38 (4)] and
Fig. 4 (a).
For implementation, let qptq be supported on rT1, T2s, T “
T2´ T1. Consider a piece-wise constant approximation to qptq
on the mesh

(4)

(5)

(6)

In this section, we consider the NLS equation in the
defocusing regime. We present an approach to inverse NFT
which is the dual of the forward NFT, and implement it in a
continuous- and discrete-time model.

A. Inverse NFT

From the eigenvalue equation Lv “ λv for (3), qptq can be

read off as

q˚ptq “ sBtv2 ´ jλv2
“ se2jλtBtbpt, λq
apt, λq

v1

.

Equation (4) essentially constitutes the inverse transform.

From the unimodularity condition

we obtain

|apλq|2 ´ s|bpλq|2 “ 1,
˙ 1

ˆ

|apλq| “

1

1 ´ s|ˆqpλq|2

2

,

where ˆq “ b{a.
Since apλq is an analytic function of λ P C`, its real and
imaginary parts are Hilbert transforms of one another. In the
defocusing regime, log apλq is also analytic, thus amplitude
|apλq| and phase =apλq are also Hilbert transforms of one
another, i.e.,

=apλq “ Hplog|apλq|q ,

(7)
where H denotes Hilbert transform. We refer the reader to
Appendix B for proofs.
Having obtained a and b “ ˆqa, numerical methods in [Part
II], e.g., the layer-peeling (LP) method, can be run inversely in
time to obtain apt, λq and bpt, λq. Note that apt, λq and bpt, λq
depend on ˆqpλq, but also as on qpτq, τ ą t, which is yet
unknown. To resolve this, (4) is iterated between pa, bq and
q: From apt, λq and bpt, λq, qptq is obtained using (4). The
resulting qptq is then used to obtain apt´ , λq and bpt´ , λq
using inverse of (4), which is an inverse step in Zakharov-
Shabat system (eigenproblem Lv “ λv), namely (11). This

trks “ T1 ` k,

 “ T{N,

and set qrks “ qpT1 ` kq.
tion according to

Nonlinear Fourier coefﬁcients propagate in forward direc-

(10)

k “ 0,¨¨¨ , N ´ 1,
˙
ˆ

ur0s “

1
0

,

urk ` 1, λs “ Mrk, λ, qsurk, λs,

ˆ

˙
where the monodromy matrix is
¯yrks
¯xrks

∆“

M

,

xrks
yrks
sq˚rks

det M “ 1,
a

yrks “

in which xrks and ¯xrks are given in [Part II, Eq. 11],
sinp∆qe´jλptrks`trk´1sq,
ˆ

and ¯yrks “ sy˚pλ˚q, where ∆ “
urk, λs “ M´1rk, λ, qsurk ` 1, λs,

reverse direction

urN, λs “

˙
λ2 ´ s|qrks|2. In the

∆

, (11)

apλq
bpλq

C. Discrete Layer-Peeling (DLP)

5

In CLP xrks and yrks depend on cospDq and have to be
evaluated for every λ P rL1, L2s. A ﬁnite-dimensional repre-
sentation, where urk, λs depends on a ﬁnite set of parameters
is preferred. Even though hyperbolic functions and M can be
approximated in terms of z and z´1, it is equally good and
simpler to consider the Ablowitz-Ladik (AL) method [Part II,
Eq. 17]

ˆ
˙
sQ˚rks
a
where Qrks “ qrks, ck “ 1{
1 ´ s|Qrks|2, and k0 “ T1{.
Note that approximation 1 ´ 2jλ « expp´2jλq in [Part II,
Section III. E] makes vpt, λq in the AL method a periodic
function of λ with period L “ π{. This is in contrast with
CLP where L is arbitrary.

ˆ
vrk ` 1, zs “ ck
1
0

vrk, zs,
0 ď k ď N ´ 1,

˙
Qrks
z´ 1

vr0, zs “

(13)

k0
2 ,

z

z

1
2

2

Discretizing ˆqpλ, tq “ expp´2jλtqpv2{v1q using (10)
ˆqrk ` 1s “ zk`k0 v2rk ` 1s
v1rk ` 1s

1

“ zk`k0 sQ˚rksv1rks ` z´ 1
2 v2rks
2 v1rks ` Qrksv2rks
sQ˚rks ` z´ 1
“ zk`k0´ 1
1 ` Qrksz´ 1

2 pv2rks{v1rksq
2 pv2rks{v1rksq

z

2

.

By induction, we can see that degpv1q “ degpv2q ` 1{2,
where degpvq is the highest positive power of z in v. Thus
zÑ8 z´ 1
lim

2 ˆqrk ` 1s
brk ` 1, zs
ark ` 1, zs

2

2 v2rks{v1rks “ 0 and
zÑ8 z´k´k0` 1
Q˚rks “ s lim
zÑ8 z´k´k0` 1
“ s lim
Brk ` 1,8s
“ s
Ark ` 1,8s
B0rk ` 1s
“ s
.
A0rk ` 1s
M´1ÿ
M´1ÿ

Ark, zs “

m“0

Brk, zs “

m“0

Amrksz´m, A0rks “ 1,
Bmrksz´m,

(14)

(15a)

(15b)

YOUSEFI AND YANGZHANG

where

M´1rk, λ, qs “

ˆ

˙
¯xrks ´¯yrks
xrks
´yrks

.

From the rectangle example in [Part II, Section IV. C]
and the piece-wise constant approximation of qptq, we see
that computing apλq requires evaluating coshpxq, where x „
µptt : λ2´|qptq|2 ă 0uq, where µ denotes Lebesgue measure.
Consequently, a and b can involve large numbers exppxq,
x ą 25, leading to numerical error — which can further
accumulate. We thus update the ratio ˆq “ b{a to cancel large
numbers

ˆqrk, λs “ αrks

where

¯βrks ` ˆqrk ´ 1, λs
1 ` βrksˆqrk ´ 1, λs

,

ˆqr0, λs “ 0,

αrks “ e´2jλptrks´trk´1sq 1 ` jλ
1 ´ jλ
tanp∆q
βrks “ e2jλtrk´1s qrks
∆ tanp∆q
and ¯βrks “ sβ˚rkspλ˚q. The inverse iteration is

∆ tanp∆q
∆ tanp∆q
,

1 ´ jλ

∆

,

,

ˆqrk, λs ´ ¯βrksαrks
αrks ´ βrksˆqrk, λs

ˆqrN, λs “ ˆqpλq.

ˆqrk ´ 1, λs “
The discontinuity of qptq in the piece-wise constant ap-
proximation causes numerical error in the Fourier transform
relation (9) due to Gibbs phenomenon. The L eigenproblem is
still well-posed (for appropriate signals), unless qptq contains
delta functions, in which case vpt, λq is not differentiable in
t. At discontinuities, qptq in (9) is the average of qrks “
qpT1 ` pk ´ 1q ´ δq (δ Ñ 0`) and zero, therefore

qrks “

2s
π

ˆqrk, λse2jλtrksdλ.

(12)

8ż

´8

Integral (12) is evaluated on the mesh

λrms “ L1 ` mµ, µ “ L{M, m “ 0,¨¨¨ , M ´ 1,

where NFT is supported on (simulation) nonlinear band
rL1, L2s, L “ L2 ´ L1.
There are issues with CLP, discussed in Section IV-D. As a
result, we consider the discrete layer-peeling (DLP) algorithm.
Certain discretizations of the Zakharov-Shabat system are
captured by z “ expp´2jλq. Here u can be represented in
terms of powers of z. A polynomial approach to the Zakharov-
Shabat system is discussed in several papers by Wahls and
co-authors [9]–[12]. Polynomials make it easier to see places
where divide-and-conquer strategies can be devised. Discrete
algorithms are also accurate. Coefﬁcients of a polynomial ppzq
evaluated at z “ expp´2jλq are coefﬁcients of the Fourier
series of the π{-periodic function ppzpλqq. Thus CLP and
DLP can be viewed as frequency and time domain approaches
to integrating ﬁrst-order ordinary differential equations. We
refer the reader to [11, Section II] and references therein for
the fast DLP. Below, we consider the basic DLP and present
derivations and proofs omitted in [11, Section II].

Here

and

k0`k
ark, zs “z´ k`k0
(16a)
brk, zs “z
2 v2rk, zs,
2 v1rk, zs,
Brk, zs“z´pk0`kq` 1
2 brk, zs. (16b)
Ark, zs“ark, zs,
ˆ
ˆ
˙ˆ
˙
˙
From (13) and (16a)–(16b), we obtain forward DLP iterations
˙
˙
ˆ
Ark ` 1s
ArksBrks
sQ˚rks
Brk ` 1s
Ar0sBr0s

ˆ
“ ck
1
“
0

0 ď k ď N ´ 1,

Qrksz´1
z´1

1

.

,

6

8ş
´8 ˆqrk, λse2jλtrksdλ

qrks “ 2

π

tr0s

t

trN ´ 1s

trks

(a)

Fig. 4.

(a) CLP with piece-wise constant approximation. (b, c) Reconstructions for two amplitudes. Parameters are T “ L “ 64 and N “ M “ 2048.

(b)

(c)

ˆ

ˆ

˙
ArksBrks

˙ˆ
˙
and inverse iterations starting from k “ N ´ 1
´Qrks
Ark ` 1s
Brk ` 1s
Fourier coefﬁcients in (15a)–(15b) are computed as

“ ck

1

z

´sQ˚rksz
L2ż

. (17)

Amrks “

1
L

L1

Ark, e´2jλtrksse´2jmλdλ
L m 1
M

λ1

DFTpAqrm ` 1s,

“ e´2jπ
(18)
where DFTpAq is the discrete Fourier transform of the samples
of Ark, e´2jλtrkss in λ.
The unimodularity condition (5) in DLP is discretized to
Ak`1pzqA˚

1
z˚q

¸

˜

k`1p
´sBk`1pzqB˚

1
z˚q “
On the unit circle z “ 1{z˚ and

k`1p

k`1ź

i“1

signpc´2

i

q

, z P C.

|Akpzq|2 ´ s|Bkpzq|2 “ 1,

|z| “ 1,

where (21) is assumed, so that ci ą 0. In frequency domain
(19)
where δrms is Kronecker delta function, and (cid:126) is the ﬂip
BM´m`1. Identity
operator, i.e., (cid:126)
Am “ ¯
¯
(19) can be checked in iterations to ensure accuracy.

AM´m`1 and (cid:126)
Bm “ ¯
¯

B ˙ (cid:126)
B “ δrms,
¯
¯

A ˙ (cid:126)
A ´ s
¯
¯

DLP is summarized in Algorithm 1.

D. Remarks on LP Algorithms

The left hand side of (4) is independent of λ. Thus, one
can set, e.g., λ “ 8 in (4). As a result, (14) can be directly
obtained from (4) by substituting expp2jλtq with z´k´k0 and
Bt with z1{2{, and taking the zeroth-order term in the z

expansion of both sides.

The forward LP algorithm is a basic integration scheme
in numerical analysis. It applies well to differential equations
with time-varying coefﬁcients, which are exactly solvable in
the special case that coefﬁcients are constant. For the operator
(3), forward LP is discussed in [13] and [Part II]. The reverse
iterations are essentially same as forward iterations. Signal
recovery in the inverse LP is simply through Zakharov-Shabat

Algorithm 1 Discrete Layer-Peeling Algorithm

Use the Hilbert transform to obtain apλq and bpλq, using
(6) and (7).
Set arN, .s ∆“ apλq and brN, .s ∆“ bpλq and obtain ArN, .s
and BrN, .s from (16b), as functions of λ.
˘
Compute Fourier coefﬁcients in (15a)–(15b) using (18).
Deﬁne vector of Fourier coefﬁcients
˘
A1rNs,¨¨¨ , AMrNs
B1rNs,¨¨¨ , BMrNs

∆“
∆“
for k “ N,¨¨¨ , 1 do
Obtain Qrks from (14) or (32), and qrks “ Qrks{.
Update

`
`

B

A

,

.

A Ð
¯
B Ð
¯

1
Bq ,
A ´ QrKs¯
ck p¯
shiftp´sQ˚rks¯
1
ck

Bq ,
where shiftpxq “ px2,¨¨¨ , xn, 0q is left shift.

A ` ¯

end for

system via (4) or its discretization (14). Inverse CLP and
DLP are widely used in ﬁber Bragg grating design; see
[14]–[16] and references therein. For transmission application,
these algorithms should be optimized and tested so that they
withstand large amplitudes and signal variations.

In our evaluation, we found that CLP suffers from the

following problems:

uous in time. Consequently, (12) is inexact.

1) Piece-wise constant approximation of qptq is discontin-
2) Reconstruction is sensitive to spectral parameters L and
M and, to a less extent, temporal variables T and N. In
particular, integral (12) should be accurately evaluated.
3) Local errors resulting from ﬁniteness of L and M
and Gibbs phenomenon accumulate. The algorithm is
divergent at high signal amplitudes; see Figs. 4 (b–c).
In DLP, on the other hand, it should be ensured that apλq
and bpλq are represented by sufﬁcient number of Fourier
coefﬁcients in (15a)–(15b). Once apλq and bpλq are accurately
represented, the rest of the algorithm is exact. In particular,
(14), in contrast to its analogue in CLP, is exact. DLP can be

-4-2024012.5tqptqqptqINFT(NFT(q))-4-2024023.5tqptqqptqINFT(NFT(q))YOUSEFI AND YANGZHANG

7

NFTpqqpλq
¨¨¨

user ´1

user 1

¨¨¨
λ (frequency)

user 0

(a)

(b)

Fig. 5.
(a) Multi-user NFDM. (b) Interactions in linear multiplexing. Interactions that cannot be removed are identiﬁed with red. Interactions that can
partially be equalized using signal processing are shown by yellow. Grey terms are addressed by coding. SPM and XPM stand for self- and cross-phase
modulation, and FWM is four-wave mixing.

implemented directly in λ domain as well: Iterations (17) can
be run for each λ, instead of updating Fourier coefﬁcients. The
improved accuracy of DLP seems to stem from exactness of
(14), not from the temporal or frequency domain implemen-
tations.

Error in DLP can result from large numbers in polynomial
coefﬁcients. Unlike CLP, the ratio b{a is not a polynomial and
´
¯
cannot be similarly updated without approximation. Variables
in DLP grow with scale factor exppPq, where
1 ´ |Qrks|2
.

P “ ´

Nÿ

log

1
2

k“1

As N Ñ 8 for ﬁxed T , P Ñ 0. We require that

for a moderate Pmax, and

0 ď P ă Pmax

It can be shown that

|Qrks| ă 1.

d|Qrk ´ 1s|
d|Qrks| 9

It is thus desirable to have

1

p1 ´ s|Qrks|2q2 .

(20)

(21)

(22)
so that Qrk ´ 1s is not sensitive to error in Qrks. The
applicability conditions of DLP are (20), (21), and preferably
(22) as well.

|Qrks| ! 1,

Note that although det M “ 1, numerical error could per-
turb eigenvalues off the unit circle, so that for one eigenvalue
|λ1pMq| ă 1, and potentially upon further iterations λ1 Ñ 0.
That is to say, CLP and DLP iterations could still be non-
invertible for large signals, even as det M “ 1 analytically.

V. MULTI-USER NFDM

Multi-user NFDM is described in [Part I] in general.
However, simulations in [Part III] were performed in the
focusing regime. In the defocusing regime, multi-user NFDM
simpliﬁes, as shown in this section.

¨˝

8ż

1
π

´

´8

´

A. Signal Spaces
Let ˆQ be the space of signals ˆqpλq : W ÞÑ D, where W “
r´πW, πWs and D is the open unit disk, with “norm”

˛‚1

2

(cid:107)ˆqpλq(cid:107)˚ “

logp1 ´ |ˆqpλq|2qdλ

.

¯ 1

In the defocusing regime |ˆq| ă 1. We introduce a transfor-
mation F : ˆQ ÞÑ U so as to map the unit disk to the complex
plane. An appropriate choice is

Upλ, zq “

´ logp1 ´ |ˆqpλ, zq|2q

2

ej=ˆqpλ,zq,

(23)

where =ˆq is the phase of ˆq P ˆQ and U P U. The image U
of F is the vector space of ﬁnite-energy signals supported on
W. The domain ˆQ of F is not a vector space (over any ﬁeld)
with addition and multiplication.
Ť
As usual in communication theory of waveform channels
[17, Chapter 8], we expand a signal U P U onto an orthonor-
mal basis of U. In multi-user NFDM, we partition U “
k Uk
into user subspaces Uk. User k operates in subspace Uk
(cid:96)“´8. If there are Nu users, each
spanned by basis
having Ns degrees-of-freedoms (symbols), then

(cid:96)pλq
Φk

(cid:32)

(8
k2ÿ

(cid:96)2ÿ

(24)

where

Upλ, 0q “
Y
k1 “ ´

Nu
2

(cid:96)“(cid:96)1

k“k1

]

,

k2 “

Q

sk
(cid:96) Φk

(cid:96)pλq,
U

Nu
2

´ 1,

where txu and rxs denote, respectively, rounding x P R
to nearest integers towards minus and plus inﬁnity. Similar
relations hold for k1 and k2 in terms of Nu.

In general, user subspaces Uk can intersect. Interference in
K
k and can be projected
user k is in the orthogonal subspace U
out. As a special case, we consider non-overlapping users
operating in equally spaced nonlinear bands of width W0 Hz

interactionsdeterministicsignalØsignalinter-channelXPMFWMintra-channelSPMXPMFWMstochasticsignalØnoiseinter-channelintra-channelnoiseØnoisedeterministicinterferencedeterministicISIstochasticinterferencestochasticISInoise8

“

‰

W0
2

(in l “ λ{2π). User k is centered at l “ kW0 and operates in
the nonlinear band

W0
2

In this case, Φk

,

Wk “

k1 ď k ď k2.
kW0 ´
(cid:96)pλq “ Φ(cid:96)pλ ´ 2πkW0q and W “ NuW0.

¸
Taking the inverse Fourier transform F

, kW0 `
˜
k2ÿ
(cid:96)2ÿ
upτ, zq “ ?2F
´1pUpλ, zqq
“ ?2

(25)

(26)

ej2πkW0τ .

´1 of (24)

sk
(cid:96) φ(cid:96)pτq

k“k1

(cid:96)“(cid:96)1

Factor ?2 is introduced to balance energies in Section V-B.
Variable τ can be interpreted as a generalized time (measured
in seconds), in Fourier transform relation with generalized
frequency l “ λ{2π (measured in Hz). It coincides with
physical time 2t for small amplitude signals (cid:107)q(cid:107)L1 ! 1. As
in the spectral domain, basis functions can overlap in the
temporal domain. A typical choice is φ(cid:96)pτq “ φpτ ´ (cid:96)T0q,
T0 “ 1{W0. NFDM signal (26) is identical to the WDM
signal; see [Part III, Eq. 2]. It simply represents every sample
of Upλ, zq as a degree-of-freedom.
B. NFDM Transmitter

Modulation begins with selecting matrix of symbols rsk
(cid:96)s
according to a constellation Ξ and computing (24). This can
be done directly in the spectral domain (24), or starting in the
temporal domain (26). The transmitted signal in the spectral
domain is

´

¯ 1
where Upλ, 0q “ Fpupτ, 0qq{?2. Finally,
qpt, 0q “ INFTpˆqpλ, 0qq.

1 ´ e´|Upλ,0q|2

ˆqpλ, 0q “

2

ej=Upλ,0q,

(27)

The (linear) Fourier spectrum Qpf, 0q “ Fpqpt, 0qq has band-
width B Hz. When (cid:107)qpt, 0q(cid:107)L1 ! 1, qpt, 0q « ´?2u˚p2t, 0q
and W « 2B.

Equations (23) and (27) ensure that

ÿ
so that rsk
(cid:96)s, ˆqpλ, 0q and qpt, 0q have the same energies

|Upλ, 0q|2 “ ´ logp1 ´ |ˆqpλ, 0q|2q,
¯

8ż

´

1 ´ |ˆqpλ, 0q|2

dλ

l,k

1
π

log

´8

8ż
(cid:96)|2 “ ´
|sk
´8 |qpt, 0q|2dt.

“

C. NFDM Receiver

At the receiver, after NFT, Upλ,Lq is computed using (23).

The received symbol is

8ż

ˆsk
(cid:96) “

´8

Upλ,LqΦk

(cid:96)pλqdλ.

(28)

Alternatively, upτ,Lq can be computed using (25). The
received symbol at the output is obtained by match ﬁltering

8ż

ˆsk
(cid:96) “

´8

upτ,Lqφk

(cid:96)pτqdτ.

Remark 1. It is not necessary to ﬁlter out-of-band signals and
noise, as projection onto basis functions in (28) does that.

D. Uniform and Geometric Constellations

We choose a multi-ring constellation Ξ for symbols sk

(cid:96) in
τ domain. There are Nr uniformly-spaced rings with radii in
interval ra, bs and ring spacing ∆r, and Nφ uniformly spaced
phases. For Ns “ 1 and a “ 0, this leads to a geometric
constellation Ξ1 in λ domain with phases in Ξ and radii

,

r2

c “

1
2p∆rq2.

n “ 1 ´ e´cpn´1q2

(29)
Constellations are shown in Fig. 9(a)–(b). As rn Ñ 1, the
distance between rings in (29) decreases exponentially. In this
way, an inﬁnite number of choices is realized in the ﬁnite
interval 0 ď |ˆq| ă 1, such that signal energies are uniformly
separated.

VI. NFDM AND WDM ACHIEVABLE RATES

In this section, we compare NFDM and WDM data rates,
with the same bandwidth and power constraints. We demon-
strate the impact of interference and ISI in both methods and
their spectral efﬁciencies.

We ﬁrst illustrate the main ideas by a simple simulation,
without bothering with insigniﬁcant details. Let Nu “ 15
and φ1pτq be a root raised-cosine function with an excess
bandwidth factor denoted by r. We consider a 15-user NFDM
and a 15-user WDM with the same overall bandwidth B “ 60
GHz and power P “ E{T , where E and T are energy
and time duration of the (entire) multiplexed signal qpt, 0q.
In this paper, time duration and bandwidth are deﬁned as
intervals containing 99% of the signal energy [Part III]. The
per-user bandwidth in 15-user WDM is 4 GHz. In NFDM,
users can overlap in (linear) frequency and use the whole
bandwidth. In this illustrative simulation, noise is set to zero.
Fiber parameters are given in [Part III, Table I], with disper-
sion D “ ´17 ps/(nm-km). For numerical computations, a
simulation nonlinear bandwidth L ą W is chosen so that  is
small enough.
Figs. 7(a)–(b) show a sample 15-user WDM and NFDM
transmit signals at power P “ 0 dBm. These two signals
take the same bandwidth B “ 60 GHz and time duration
1.5 ns. The corresponding received signals at L “ 2000 km,
with one ADM at the receiver and in the absence of noise,
are shown in Figs. 6(a)–(b). It can be seen that WDM users
interfere with another at this power, while NFDM symbols can
be perfectly recovered. In WDM, part of distortion in Fig.6(b)
can be removed by back-propagation. The resulting mismatch
between signals in Fig.6(c) cannot be compensated for in a
network environment; we refer to this distortion as data rate
bottleneck in linear multiplexing (e.g., WDM). This distortion
is increased as Ns or number of ADMs is increased.

YOUSEFI AND YANGZHANG

9

Denote the matrix of transmit and received symbols by S “
(cid:96)s and ˆS “ rsk
(cid:96)s. We tested transmission of random data
rsk
at high powers P ď 3 dBm in NFDM and recovered the
matrix of transmit symbols nearly perfectly for various Nu ď
15 and Ns ď 15. The relative error e “ (cid:13)(cid:13)(cid:13) ˆS ´ S(cid:13)(cid:13)(cid:13){(cid:107)S(cid:107) «
10´3´10´9, arising from numerical errors, is quite small. This

supports that, in the absence of noise, large spectral efﬁciencies
may be achieved in NFDM. In principle, the achievable rate
is inﬁnite in deterministic bandlimited model: Inﬁnite number
of degrees-of-freedom exists in any ﬁnite bandwidth, e.g., in
(24), which can be perfectly recovered. Spectral broadening
approaches zero as input power tends to zero, or is ﬁnite at
ﬁnite powers, leading to inﬁnite spectral efﬁciency. In contrast,
the corresponding rate of WDM with the same constraints is
small (approaching zero with transmit power), as shown in
Fig. 2. Note that noise does not substantially inﬂuence WDM
rates at high powers in Fig. 2.

In the second simulation, we introduce distributed noise and
conduct several numerical studies. Constellation Ξ consists of
Nr “ 32 rings each with Nφ “ 128 phase points, with a “ 0.7
and b “ 1.6. We choose a ą 0 to operate at high power. The
value of b is twice of that in Fig. 6, so that on average a
behavior similar to Fig 6 is obtained. The excess bandwidth
in the root raised-cosine function is r “ 25%. Noise power
spectral density σ2
0 is based on realistic parameters in [Part
III, Table I]. We set Nu “ 15, while Ns “ 1 so that N is
not too large for several thousand simulations. The highest
energy signal is the one with sk
(cid:96) “ b, @k, (cid:96). We ﬁx noise
bandwidth for the entire simulation to be the maximum input
output bandwidth of the highest energy signal. The number of
signal samples is N “ M “ 16384. One nonlinear ADM
is implemented at L “ 2000 km. We calculate transition
probabilities sk
(cid:96) based on 4000 simulations of the
(cid:96)
stochastic NLS equation. Data rate in the memoryless model is
then numerically estimated by maximizing mutual information
subject to average power constraint. We obtain a data rate

ÞÑ ˆsk

(30)

2 “ 0.98, s0

bits per complex degree-of-freedom,

RNFDM “ 10.5,
at (total) average input power P “ ´0.33 dBm.
Received symbols corresponding to four transmit symbols
4 “ 1.6 are shown
1 “ 0.7, s0
s0
increase as
in Fig. 9 (c). The size of “clouds” does not
(cid:96)| is increased. In fact, the conditional entropy is nearly
|s0
constant as a function of transmit symbols; see Fig. 8 (a).
This, together with Fig. 8 (b) showing that the conditional
probability distribution is just shifted with input, could indicate
that
in the nonlinear Fourier domain behaves
approximately as an AWGN channel.

3 “ 1.2624, s0

the channel

We now consider a 15-user WDM system with the same
constraints as in NFDM, namely, 60 GHz bandwidth and
P “ ´0.33 dBm average input power. A constellation with
Nr “ 32 uniformly spaced rings, with a “ 0.73 and b “ 1.45,
and with Nφ “ 128 points on each ring is used. The excess
bandwidth in the root raised-cosine function is r “ 25%, and
Ns “ 1. One linear ADM is implemented at L “ 2000 km.
We calculate transition probabilities based on 4000 channel

3 “ 1.185, s0

2 “ 0.9575, s0

bits per complex degree-of-freedom.

simulations. We obtain data rate
(31)
RWDM “ 5.26,
Fig. 10 shows received symbols for four transmit symbols
1 “ 0.7527, s0
4 “ 1.458 in WDM.
s0
WDM “clouds” seem bigger than the corresponding ones in
NFDM in Fig. 9 (c). Note that in WDM, there is a constant
rotation of symbols, even after back-propagation. The rotation,
which is about γLP (γ being nonlinearity coefﬁcient), can be
explained from [8, Eq. 21]. Note also that received symbols
associated with s0
4 cluster around a ring with radius smaller
than 1.458. This can be explained via Fig. 6 (b): Signal
energy for the central user k “ 0 at the output is lower
than the corresponding energy at the input, because of the
spectral broadening. Back-propagation is energy-preserving,
giving rise to a received symbol with reduced absolute value.
This is in contrast with users k “ ˘7 on the boundaries
of spectral band. As the input amplitude tends to inﬁnity,
all energy could transfer to out of band, as a result of the
so-called forward cascade in (weak) wave turbulence theory
[8, Section V]. Spectral broadening occurs in NFDM too,
however, in NFDM users are not ﬁltered; they can interact
with one another in time and in (ordinary) frequency. The
overall spectral broadening beyond 60 GHz is small, and is a
little higher in WDM than in NFDM. This could be because
WDM spectrum varies rapidly; note the deep wells in the input
signal in Fig. 6 (b).

For comparison, the capacity of an AWGN channel with

signal-to-noise ratio SNR “ P{pσ2

0BLq is
CAWGN “ log2p1 ` SNRq

“ 13.78,
bits per complex degree-of-freedom.

The corresponding factor in the 15-user WDM is αWDM “ 7.6.
Since Tkp0q ą Ts, using 99%-energy time duration scales
down WDM spectral efﬁciencies in Fig. 2. To compare with
data rates in Fig. 2 in bits/s/Hz, one approach is to scale
NFDM spectral efﬁciency
αWDM
αNFDM

10.5 “ 11.77,

R1
NFDM “

bits/s/Hz.

If 99% time duration is used, spectral efﬁciencies are

R1
NFDM “
R1
WDM “

10.5
αNFDM “ 1.54,
5.26
αWDM “ 0.69,

bits/s/Hz,

bits/s/Hz.

We point out, however, that the 99%-energy time duration
is not an appropriate deﬁnition to use in the calculation of

Note that time duration in our simulations is according to
99%-energy deﬁnition, which is higher than Ts “ 1{B0, B0 “
B{Nu, that is often assumed in digital communication (e.g.,
in WDM). Let Tkpzq and Wkpzq be 99%-energy time duration
and (maximum input output) bandwidth of signal number k
that is sent over channel, at distance z. In NFDM

αNFDM “

NuNs pETkp0qq ˆ max

k

maxpWkp0q, WkpLqq

1

“ 6.78.

10

(a)

(b)

Fig. 7. Bandwidth and time comparison between the proposed 15-user WDM
and NFDM at the maximum power P “ 0 dBm. (a) Signals in frequency at
z “ 0. Bandwidths are B “ 60 GHz. (b) Signals in time at z “ 2000 km.
Time duration is 1.5 ns.

(a)

(b)

(a) Conditional entropy does not grow as s is increased. (b)
Fig. 8.
Conditional probability distribution of the amplitude for three input symbols.

spectral efﬁciency. The appropriate quantity is bits per two
real dimensions in a given bandwidth, which is (30) and (31).
For this, however, Ns Ñ 8, which is not the case in our
simulations. We leave reports of more comprehensive multi-
user NFDM and WDM simulations to another paper.
Remark 2 (Optimization). Comparing particular achievable
rates of two methods at power P is not conclusive; one has to
compare maximum achievable rates over all signal sets with
power P. To achieve high powers, constellations were chosen
in an interval a ď |s| ď b, away from origin. Another option
is 0 ď |s| ď a` b. In this case, data rate of NFDM and WDM
slightly increase, with RNFDM approaching CAWGN. Although
we have not optimized both methods, data rates did not change
much when we reﬁned constellations.
Remark 3 (Commercial WDM). The per-user WDM band-
width is 4 GHz in Section VI, which is smaller than that in
commercial systems. Simulations with higher bandwidth need
more resources and time. The per-user power, with Ts in the
deﬁnition of power, is -1.8 dBm. This is a rather high power
for a small bandwidth. It corresponds to about 8.2 dBm at 40
GHz per-user bandwidth.
Remark 4 (Peak-to-Average Power Ratio). Similar to OFDM,
as Ns Ñ 8, peak-to-average ratio of ˆqpλq could be large.
Better results may be obtained if data is directly modulated
in (24), or other transformations are considered in place of
(23).

Fig. 10. Received symbols for four transmit symbols in WDM.

VII. COMMENTS ON DISCRETE AND CONTINUOUS

SPECTRUM MODULATION

There are several ways that NFT can been used in commu-
nications. We review them here, so as to clarify the way that
NFT could usefully be applied to data transmission.

A. Multi-Soliton Communication

Inverse scattering transform is a soliton theory. Fundamental
soliton communication was developed in 1980s and 1990s.
ON-OFF keying soliton communication was generalized in
[18] so as to transmit more than one bit per fundamental
soliton. The observation was that eigenvalues are conserved,
while amplitude and phase change during the evolution. It is
thus natural to put information in invariant quantities, such
as eigenvalues. This approach can be extended to general N-
soliton communication.

Data rates of N-soliton communication are higher than data
rates of 1-soliton communication, but roughly equal to data
rates of any other N-bits signal set, for instance, Nyquist
signals modulated based on an N-bits QAM constellation [6].
Evolution of waveforms is not a limitation in communications,
since it is equalized at the receiver (as in radio channels).
Generally, changing pulse shapes does not change data rates
(other than minor optimization).

B. Discrete and Continuous Spectrum Modulation

Degrees-of-freedom in time and nonlinear Fourier domain
are in one-to-one correspondence. Thus, modulating both
discrete and continuous spectrum does not achieve a data rate
higher than existing WDM rates. Indeed, examining WDM
signals with vanishing rates in the literature [6], both spectra
are (indirectly) fully modulated within bandwidth and power
constraint. An approach is not improved by replacing its set
of degrees-of-freedom with another equivalent set.

C. NFT for Signal Multiplexing

NFT can be applied for signal multiplexing in multi-
user channels. In [Part I–III], a nonlinear frequency-division
multiplexing was designed for multi-user networks, in order
to address the recent capacity crunch problem arising from

´505012f|qpfq|WDMNFDM´5005000.20.40.6t|qptq|WDMNFDM0.811.21.41.60246shpˆs|sqNFDM0.510ˆspp|ˆs||sqs“0.72s“1.15s“1.6NFDM´1.42´0.7100.711.42¨1.41´0.7100.71¨1.41P“´0.33dBmWDM<ˆsr?mWs=ˆsr?mWsYOUSEFI AND YANGZHANG

11

(a)

(b)

(c)

Fig. 6. Deterministic interference in two 15-user methods with the same power, bandwidth and time constraints. (a) Perfect signal reconstruction in NFDM.
(b) Inter-channel interference in WDM (a). (c) Interference in WDM after back-propagation.

(a)

(b)

(c)

Fig. 9.

(a) Uniform constellation in τ domain. (b) Geometric constellation in λ domain. (c) Received symbols for four transmit symbols in NFDM.

interference and ISI in linear multiplexing. In this approach,
ADMs will eventually be replaced with nonlinear multiplexers.
By using NFT to construct nonlinear multiplexers, higher data
rates could be achieved.

It is important to note that NFDM is not soliton communi-
cation, or discrete and continuous spectrum modulation. Mod-
ulating both discrete and continuous spectrum and performing
linear multiplexing will not achieve a data rate higher than
existing WDM rates [6]. On the other hand, modulating users
signals in time domain, and performing nonlinear multiplex-
ing, can improve WDM data rates. NFDM is an approach
where users’ information is encoded in the nonlinear Fourier
domain (non-critical step) and multiplexed nonlinearly (critical
step).

VIII. RELATED WORK

Data transmission using the NFT has been studied in several
recent closely-related works [2]–[4], [9]–[12], [19]–[30]. In
this section, we review some of these papers, not discussed
earlier.

A. Review

Fast nonlinear Fourier transforms were introduced by Wahls
et al. in [10]–[12]. In addition to computation speed, discrete
algorithms presented in these papers are robust. Discrete

algorithms motivated the present paper and enabled nonlinear
multiplexing in Section VI.

In [19]–[21], Prilepsky, Le, Turitsyn and co-authors, pro-
posed nonlinear inverse synthesis based on NFT. They demon-
strated spectrum modulation and reported low bit error rates
[23].

Noise in the nonlinear Fourier domain is studied in [27],
[31]–[33]. Distribution of the spectral parameters for the
special case that channel is noise-free and input is a white
Gaussian stochastic process is calculated in [31]. A lower
bound on spectral efﬁciency of multi-solitons is obtained in
[32]. Noise models in the spectral domain, including models
for spectral amplitudes, are studied in [27], [33].

Transmission based on the nonlinear Fourier transform was
recently demonstrated in experiments [24]–[26], [28], [30],
[34]. B¨ulow [24]–[26], and subsequently Aref and others [30],
showed that one can recover information via eigenvalues and
other parts of the nonlinear spectrum. Dong et al. success-
fully demonstrated error-free transmission of three-eigenvalue
NFDM signals over 1800 km [28]. An important consequence
of these works is that, the end-to-end channel appears nearly
integrable in practice as indicated by the stability of eigenval-
ues.

´1001000.51λ|NFTpλq|inputoutputNFDM´6´4´20246012f|qpfq|inputoutputWDM´0.300.3012f|qpfq|z“0z“L,BPWDM<s=s1.7<ˆq=ˆq1´1.42´0.7100.711.42¨1.41´0.7100.71¨1.41P“´0.33dBmNFDM<ˆsr?mWs=ˆsr?mWs12

B. Note on Data Rates in Literature

For clarity, we note that, when calculating data rates, one
should pay attention to the bandwidth and time duration
of signal sets that are used (at
input and output). These
factors sometimes have not been (fully) taken into account
in the past. For example, it certainly does not make sense to
compare single-user spectral efﬁciencies with WDM spectral
efﬁciencies. Furthermore, capacity in bits per “symbol” does
not have much implication in communication. Some trivial
schemes for ﬁber channel achieve data rates in bits per symbol
growing logarithmically with input power.

ACKNOWLEDGMENTS

Financial support of the Institute for Advanced Study at the
Technical University of Munich, funded by the German Excel-
lence Initiative (and the European Union Seventh Framework
Programme under grant agreement no. 291763), as well as
Alexander von Humboldt Foundation, funded by the German
Federal Ministry of Education and Research, is acknowledged.
The authors thank Frank R. Kschischang and Gerhard

Kramer for helpful comments and discussion.

APPENDIX A

`
ˆ

1

T

˘
ˆ
˙
˙
´Q˚r0s

1

A AND B IN THE ABLOWITZ-LADIK SCHEME

In general, A and B are expanded in the basis

,

.

,

1
0

¨¨¨

z´1

ˆ

ˆ
ˆ

z´M`1
The ﬁrst few iterations of AL scheme are

˙
˙
Ar0sBr0s
“
Ar2sBr2s
“ c0c1
Ar3s “ c0c1c2
´ Q˚r0sQr2sz´2
˘
´ Q˚r0sz´2

˙
˙
m “
ˆ
Ar1sBr1s
`
1 ´ Q˚r0sQr1sz´1
´Q˚r1s ´ Q˚r0sz´1
1 ´ pQ˚r0sQr1s ` Q˚r1sQr2sqz´1
`
´Q˚r2s ` pQ˚r0sQr1sQ˚r2s ´ Q˚r1sqz´1

“ c0
˘

Br3s “ c0c1c2

In addition to (4), the following identity can be proved by
induction

.

,

,

Qrk ´ 1s “

AM´1rks
BM´1rks

.

APPENDIX B

KRAMERS-KRONIG RELATIONS

(32)

Given NFTpqqpλq, Riemann-Hilbert integral equations in
[Part I, Eq. 30] can be solved at t “ T to obtain V 1pT, λq “
rapλq, bpλqs. This requires solving one system of linear equa-
there is a simpler method, based on the
tions. However,
analyticity of apλq.
The real and imaginary parts of a complex analytic function
are strongly constrained via Cauchy-Riemann equations, or
their integral analogue, Kramers-Kronig relations.
Lemma 1 (Kramers-Kronig Relations). Let fpzq “ upx, yq`
jvpx, yq be a function of a complex variable z “ x ` jy,

where u and v are real-valued functions. Suppose that fpzq
is analytic in C` and fpzq Ñ 0 as |z| Ñ 8. Then

upx, yq “ Hxpvpx, yqq,

Notation Hx denotes Hilbert transform with respect to x

vpx, yq “ ´Hxpupx, yqq. (33)
8ż

Hxpfpx, yqq “

1
π

p.v.

dx1

fpx1, yq
x1 ´ x
´8
˙x fpx, yq,

1
πx

“

where ˙x is convolution with respect to x, and p.v. is principal
value.
Proof: Consider a point z “ x` jy P C` in the complex
plane ζ “ x1`jy1. Let C be a counter-clockwise semi-circular
contour, with diameter at y1 “ y, and passing slightly around
z from above. We apply Sokhotski-Plemelj formula [Part I,
Lemma 8] to fpzq in C. Since fpzq is analytic inside C, 1)
fpzq is differentiable inside C, thus satisﬁes a H¨older condition
there with α “ 1; 2) F ´pζq “ 0 in [Part I, Eq. 37]. Thus

ż
fpx1 ` jyq
8ż
x1 ´ x
fpx1 ` jyq
x1 ´ x

C

´8

dx1

dx1.

fpx ` jyq “

1
πj

p.v.

paq
“

1
πj

p.v.

Step paq follows because f vanishes on arc of C. Equating
real and imaginary parts of the above equation gives (33).
Corollary 2. Under the assumptions of Lemma 1 on apλq,
(34)

=apλq “ Hplog|apλq|q.

Proof: From unimodularity condition (5) in defocusing

regime

|a|2 “ 1 ` |b|2

ě 1,

λ P R.

Therefore log|a| ě 0 for λ P R. This may not hold in the
focusing regime.
We next analytically extend apλq to λ P C` [Part I,

Lemma 4]. From [Part I, Eq. 45],
1
λ2q,

8ş
E
apλq “ 1 `
2jλ ` Op
´8|qptq|2dt. Thus

where E “

as

|λ| Ñ 8,

log apλq Ñ

E
2jλ ` Op

1

|λ|2q

Ñ 0,

on the arc |λ| Ñ 8. It follows that log|a| ě 0 on the boundary
of C`. Since apλq is analytic in C`, log|apλq| is a harmonic
function there. From the Maximum Principle, log|apλq| ě 0,
everywhere in C`, thus

|apλq| ě 1,

@λ P C`.

YOUSEFI AND YANGZHANG

13

In particular, in the defocusing regime, apλq ‰ 0 in C`.
Using Faa di Bruno’s formula, derivatives of fpλq “
log apλq can be expressed in terms of derivatives of apλq.
Since a is analytic in C`, and a ‰ 0, fpλq “ log apλq is also
analytic in C`. Furthermore, since fpλq is differentiable, it
satisﬁes a H¨older condition with α “ 1; see [Part I, Lemma
8]. Applying Lemma 1 to fpλq we obtain (34) in C`. In
particular, (34) holds along the line λ “ x` j,  ą 0. Letting
 Ñ 0` and using continuity of apλq, we obtain (34) on the
real line.

REFERENCES

[1] X. Yangzhang

and M.

defocusing

Fourier
2015 Munich Workshop
transform at
on Information Theory of Optical Fiber, Dec. 2005, poster
presentation. [Online]. Available: https://www.lnt.ei.tum.de/ﬁleadmin/
lnt/events/MIO2015/mio2015poster Yangzhang Xianhe.pdf

I. Youseﬁ,

“Nonlinear

regime,”

in

I. Youseﬁ and F. R. Kschischang, “Information transmission
tools,”
Jul.
[Online]. Available:

using the nonlinear Fourier transform, Part I: Mathematical
IEEE Trans.
2014, Also published at arXiv, Feb. 2012.
http://arxiv.org/abs/1202.3653

Inf. Theory, vol. 60, no. 7, pp. 4312–4328,

[2] M.

[3] ——, “Information transmission using the nonlinear Fourier transform,
Part II: Numerical methods,” IEEE Trans. Inf. Theory, vol. 60, no. 7,
pp. 4329–4345, Jul. 2014, Also published at arXiv, Apr. 2012. [Online].
Available: http://arxiv.org/abs/1204.0830

[4] ——, “Information transmission using the nonlinear Fourier transform,
Part III: Spectrum modulation,” IEEE Trans. Inf. Theory, vol. 60,
no. 7, pp. 4346–4369, Jul. 2014, Also published at arXiv, Feb. 2013.
[Online]. Available: http://arxiv.org/abs/1302.2875

[5] M. I. Youseﬁ, “Information transmission using the nonlinear Fourier

transform,” Ph.D. dissertation, University of Toronto, Nov. 2012.

[6] R. J. Essiambre, G. Kramer, P. J. Winzer, G. J. Foschini, and B. Goebel,
“Capacity limits of optical ﬁber networks,” IEEE J. Lightw. Technol.,
vol. 28, no. 4, pp. 662–701, Feb. 2010.

[7] M. I. Youseﬁ and F. R. Kschischang, “On the per-sample capacity of
nondispersive optical ﬁbers,” IEEE Trans. Inf. Theory, vol. 57, no. 11,
pp. 7522–7541, Nov. 2011.

[8] M. I. Youseﬁ, F. R. Kschischang, and G. Kramer, “Kolmogorov-
Zakharov model for optical ﬁber communications,” ArXiv Preprints,
Dec. 2014, arXiv:1411.6550. [Online]. Available: http://arxiv.org/abs/
1411.6550

[9] S. Wahls and H. V. Poor, “Introducing the fast nonlinear Fourier
transform,” in 2013 IEEE Int. Conf. Acoustics, Speech and Signal
Process. (ICASSP), Vancouver, Canada, May 2013, pp. 5780–5784.

[10] ——, “Fast numerical nonlinear Fourier transforms,” IEEE Trans. Inf.
Theory, vol. 61, no. 12, pp. 6957–6974, Dec. 2015, also published at
arXiv, Feb. 2014. [Online]. Available: http://arxiv.org/abs/1402.1605

[11] ——, “Fast inverse nonlinear Fourier transform for generating multi-
solitons in optical ﬁber,” in IEEE Int. Symp. Info. Theory, Hong Kong,
China, Jun. 2015, pp. 1676–1680.

[12] S. Wahls, S. T. Le,

J. E. Prilepsky, H. V. Poor, and S. K.
Turitsyn, “Digital backpropagation in the nonlinear Fourier domain,”
in IEEE Int. Workshop on Signal Process. Advances in Wireless
Commun. (SPAWC), Stockholm, Sweden, Jun. 2015, pp. 445–449,
Also published at ArXiv on Apr. 2015, arXiv:1504.06598. [Online].
Available: http://arxiv.org/abs/1504.06598

[13] G. Boffetta and A. R. Osborne, “Computation of the direct scattering
transform for the nonlinear Schr¨odinger equation,” J. Comp. Phys., vol.
102, no. 2, pp. 252–264, Oct. 1992.

[14] A. M. Bruckstein, B. C. Levy, and T. Kailath, “Differential methods in
inverse scattering,” SIAM J. Appl. Math., vol. 45, no. 2, pp. 312–335,
Apr. 1985.

[15] J. Skaar and O. H. Waagaard, “Design and characterization of ﬁnite-
length ﬁber gratings,” IEEE J. Quantum Electron., vol. 39, no. 10, pp.
1238–1245, Oct. 2003.

[16] A. Rosenthal and M. Horowitz, “Inverse scattering algorithm for re-
constructing strongly reﬂecting ﬁber Bragg gratings,” IEEE J. Quantum
Electron., vol. 39, no. 8, pp. 1018–1026, Aug. 2003.

[17] R. G. Gallager, Information Theory and Reliable Communication. New

York, NY, USA: John Wiley & Sons, Inc., 1968.

[18] A. Hasegawa and T. Nyu, “Eigenvalue communication,” IEEE J. Lightw.

Technol., vol. 11, no. 3, pp. 395–399, Mar. 1993.

[19] J. E. Prilepsky, S. A. Derevyanko, and S. K. Turitsyn, “Nonlinear
spectral management: Linearization of the lossless ﬁber channel,” Opt.
Exp., vol. 21, no. 20, pp. 24 344–24 367, Oct. 2013.

[20] J. E. Prilepsky, S. A. Derevyanko, K. J. Bluw, I. Gabitov, and S. K. Tu-
ritsyn, “Nonlinear inverse synthesis and eigenvalue division multiplexing
in optical ﬁber channels,” Phys. Rev. Lett., vol. 113, no. 1, pp. 013 901
(1–5), Jul. 2014.

[21] S. T. Le, J. E. Prilepsky, and S. K. Turitsyn, “Nonlinear inverse synthesis
for high spectral efﬁciency transmission in optical ﬁbers,” Opt. Exp.,
vol. 22, no. 22, pp. 26 720–26 741, Nov. 2014.

[22] E. Meron, M. Feder, and M. Shtaif, “On the achievable communication
rates of generalized soliton transmission systems,” arXiv:1207.0297,
pp. 1–13, Jul. 2012. [Online]. Available: http://arxiv.org/abs/1207.0297
[23] S. T. Le, S. Wahls, D. Lavery, J. E. Prilepsky, and S. K. Turitsyn,
“Reduced complexity nonlinear inverse synthesis for nonlinearity com-
pensation in optical ﬁber links,” in The European Conf. Lasers Electro-
Optics (CLEO), Munich, Germany, Jun. 2015.

[24] H. B¨ulow, “Experimental assessment of nonlinear Fourier transforma-
tion based detection under ﬁber nonlinearity,” in European Conf. Opt.
Commun., Sep. 2014, pp. 1–3.

[25] H. B¨ulow, “Experimental demonstration of optical signal detection using
nonlinear Fourier transform,” IEEE J. Lightw. Technol., vol. 33, no. 7,
pp. 1433–1439, Apr. 2015.

[26] H. B¨ulow, “Nonlinear Fourier transformation based coherent detection
scheme for discrete spectrum,” in Opt. Fiber Commun. Conf. and
Exposition, Los Angeles, CA, United States, Mar. 2015, pp. 1–3.

[27] Q. Zhang, T. H. Chan, and A. Grant, “Spatially periodic signals for ﬁber
channels,” in 2014 IEEE Int. Symp. Info. Theory (ISIT 2014), Jun. 2014,
pp. 2804–2808.

[28] Z. Dong, S. Hari, T. Gui, K. Zhong, M. I. Youseﬁ, C. Lu, P.-K. A. Wai,
F. R. Kschischang, and A. P. T. Lau, “Nonlinear frequency division
multiplexed transmissions based on NFT,” IEEE Photon. Technol. Lett.,
vol. 27, no. 15, pp. 1621–1623, Aug. 2015.

[29] S. Civelli, L. Barletti, and M. Secondini, “Numerical methods for the
inverse nonlinear Fourier transform,” in Tyrrhenian Int. Workshop on
Digital Commun. (TIWDC), Florence, Italy, Sep. 2015, pp. 13–16.

[30] V. Aref, H. Buelow, K. Schuh, and W.

Idler, “Experimental
demonstration
division multiplexed
transmission,” in European Conf. Opt. Commun., Sep. 2015, pp.
1–3, Also published at ArXiv on Aug. 2015, arXiv:1508.02577.
[Online]. Available: http://arxiv.org/abs/1508.02577

frequency

nonlinear

[31] P. Kazakopoulos and A. L. Moustakas, “Nonlinear Schr¨odinger equation
with random Gaussian input: Distribution of inverse scattering data and
eigenvalues,” Phys. Rev. E, vol. 78, no. 1, pp. 016 603 (1–7), Jul. 2008.
[32] ——, “NLSE soliton spectral efﬁciency for Gaussian input,” Poster
presentation at 2015 Munich Workshop on Information of Optical Fiber,
Dec. 2015.

[33] Q. Zhang and T. H. Chan, “A spectral domain noise model for optical
ﬁbre channels,” in 2015 IEEE Int. Symp. Info. Theory (ISIT 2015), Jun.
2015, pp. 1660–1664.

[34] A. Maruta, A. Toyota, Y. Matsuda, and Y. Ikeda, “Experimental demon-
stration of long haul transmission of eigenvalue modulated signals,” in
Tyrrhenian Int. Workshop on Digital Commun. (TIWDC), Sep. 2015, pp.
28–30.

of

