6
1
0
2

 
r
a

 

M
5
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
1
3
8
4
0

.

3
0
6
1
:
v
i
X
r
a

Admissible morphisms for Shimura varieties with parahoric level

Dong Uk Lee

Abstract

In Shimuravariet¨aten und Gerben [LR87], Langlands and Rapoport developed the theory
of pseudo-motivic Galois gerb and admissible morphisms between Galois gerbs, with a view to
formulating a conjectural description of the ¯Fp-point set of the good reduction of a Shimura
variety with hyperspecial level, as well as to providing potential tools for its conﬁrmation. Here,
we generalize, and also improve to some extent, their works to parahoric levels when the group is
quasi-split at p. In particular, we show that every admissible morphism is conjugate to a special
admissible morphism, and, when the level is special maximal parahoric, that any Kottwitz triple
with trivial Kottwitz invariant, if it satisﬁes certain natural necessary conditions implied by the
conjecture, comes from an admissible pair. As applications, we give eﬀectivity criteria for elliptic
stable conjugacy classes and Kottwitz triples, and establish non-emptiness of Newton strata in
the relevant cases. Along the way, we ﬁll some gaps in the original work.

Contents

1 Introduction

2 Parahoric subgroups and µ-admissible set

2.1 Kottwitz maps and Newton map . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Parahoric subgroups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

7
7
9

3 Pseudo-motivic Galois gerb and admissible morphisms

12
3.1 Galois gerbs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.2 Pseudo-motivic Galois gerb . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.3 The morphism ψT,µ and admissible morphisms
. . . . . . . . . . . . . . . . . . . . . 22
3.4 The Langlands-Rapoport conjeture . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
. . . . . . . . . . . . . . . . . . . . . . . . . 31
3.5 Kottwitz triples and Kottwitz invariant
3.6 Admissible pairs and associated Kottwitz triples
. . . . . . . . . . . . . . . . . . . . 34

4 Every admissible morphism is conjugate to a special admissible morphism

38
4.1 Transfer of maximal tori and strategy of proof of Theorem 4.1.3 . . . . . . . . . . . . 38
4.2 Proof of Propositions 4.1.4, 4.1.5, and Theorem 4.1.3 . . . . . . . . . . . . . . . . . . 41

5 Admissible pairs and Kottwitz triples

57
5.1 Criterion for a Kottwitz triple to come from an admissible pair . . . . . . . . . . . . 66
5.2 Eﬀectivity criteria for stable conjugacy classes and Kottwitz triples . . . . . . . . . . 68

A The quasi-motivic Galois gerb

70

1

B Existence of elliptic tori inside special maximal parahoric group schemes

C Some facts on the Bruhat order of Coxeter groups

71

77

1

Introduction

The celebrated conjecture of Langlands and Rapoport, which was stated in [LR87] and a signif-
icant progress towards which was recently made by Kisin [Kis13], aims to give a group-theoretic
description of the set of ¯Fp-points of the mod-p reduction of a Shimura variety, as provided with
Hecke operators and Frobenius automorphism. To explain it, let (G, X) be a Shimura datum, and
Kp ⊂ G(Ap), Kp ⊂ G(Qp) compact open subgroups; set K := Kp × Kp ⊂ G(Af ). The original
conjecture mainly concerned the good reduction cases, where Kp is hyperspecial, i.e. Kp = GZp(Zp)
for a reductive Zp-group scheme with generic ﬁber GQp. We also choose a place ℘ of the reﬂex
ﬁeld E(G, X) dividing p, and let O℘, κ(℘) denote respectively the integer ring of the local ﬁeld
E(G, X)℘ and its residue ﬁeld. Then, Langlands and Rapoport conjectured that there exists an
integral model SKp(G, X) of ShK(G, X) over O℘, for which there is a bijection

S(φ)

(1.0.0.1)

SKp(G, X)(¯Fp) ∼→G[φ]

where

S(φ) = lim←−Kp

Iφ(Q)\Xp(φ) × X p(φ)/Kp.

To give an idea of what these objects are like, suppose that our Shimura variety ShKp(G, X) is
a moduli space of abelian varieties endowed with a certain prescribed set of additional structures
(called G-structures, for short), and that there exists an integral model whose reduction aﬀords
a similar moduli description (at least over ¯Fp). Then, roughly speaking, each φ is supposed to
correspond to an isogeny class of abelian varieties with G-structure, and the set S(φ) is to parame-
terize the isomorphism classes in the corresponding isogeny class. More precisely, Xp(φ) and X p(φ)
should correspond to the isogenies of p-power order and prime-to-p order (say, leaving from a ﬁxed
member in the isogeny class φ), respectively, and Xp(φ) can be also identiﬁed with a suitable aﬃne
Deligne-Lusztig variety X({µX}, b)Kp. The term Iφ(Q) is to be the automorphism group of the
isogeny class attached to φ, and thus acts naturally on Xp(φ) and X p(φ). Moreover, each of the
sets S(φ) carries a compatible action of G(Ap
f ) and the Frobenius Φ (in Gal(¯Fp/κ(℘))), and the
bijection (1.0.0.1) should be compatible with these actions.

When it comes to precise deﬁnition, the most tricky object is the parameter φ.

Its precise
deﬁnition makes use of the language of Galois gerbs: A Galois gerb is a gerb, in the sense of
Cohomologie non ab´elienne `a la Giraud, on the ´etale site of a ﬁeld (with choice of a neutralizing
object). This is motivated by the fact ([Mil94]) that there is a well-determined class of Shimura
varieties (i.e. Shimura varieties of abelian type) which, in characteristic zero, have a description of
their point sets similar to (1.0.0.1) with the parameter φ being an abelian motive. For ¯Fp-points, the
parameter φ, called an admissible morphism, is to represent “a motive over ¯Fp with G-structure”.
But, the Tannakian category of Grothendieck motives over ¯Fp, being non-neutral, is identiﬁed with
the representation category of a certain Galois gerb (“motivic Galois gerb”), not an aﬃne group
scheme, and “a motive over ¯Fp with G-structure” is then constructed as a morphism from this
motivic Galois gerb to the neutral Galois gerb attached to G.

2

The conjectural description (1.0.0.1) also determines the ﬁnite sets SK(G, X)(Fqm ) for each
ﬁnite extension Fqm of Fq = κ(℘), and eventually allows one to obtain a purely group-theoretic
formula for their cardinalities, whose knowledge amounts to that of the local zeta function of
It is also this formula which was attacked with success in some special cases
SKp(G, X)κ(℘).
of SK(G, X)(Fqm ) =
(mostly of PEL-type), e.g.
[SK(G, X)(¯Fp)]Φm
is grouped into further subsets indexed by a pair (φ, ǫ) consisting of an admissible
morphism φ and a Frobenius descent datum ǫ ∈ Aut(φ): such pair (φ, ǫ), when it satisﬁes certain
conditions, is supposed to correspond to an Fqm-isogeny class of abelian varieties. With such
admissible pair (φ, ǫ), one associates a triple of group elements (Kottwitz triple)

in [Kot92]. In more detail, each subset S(φ)Φm

(γ0; γ = (γl)6=p, δ) ∈ G(Q) × G(Ap

f ) × G(Ln)

(deﬁned up to some suitable equivalence relation), where Ln is the unramiﬁed extension of Qp
of degree n = m[κ(℘) : Fp]. The formula in question then takes the form of a sum, indexed by
(equivalence classes of) these triples, of a product of quantities:

X(γ0;γ=(γl),δ)

ι(γ0) · vol(I0(Q)ZK/I0(Af )) · Oγ(f p) · T Oδ(φp).

(1.0.0.2)

We refer the reader to [Kot84b], [Kot90] for detailed discussion of this formula. Here, the sum
runs only over the triples satisfying certain conditions (among which the most important one is the
vanishing of the so-called Kottwitz invariant).

A substantial part of the work [LR87] of Langlands and Rapoport is devoted to constructing
these objects and establishing their basic properties. The facts thus obtained are needed to carry
out the deduction of the formula (1.0.0.2), and were also important ingredients in the works on
the original conjecture itself, including the recent one by Kisin [Kis13]. The main results of [LR87]
assume that the level subgroup Kp is hyperspecial (so, in particular that GQp is unramiﬁed). Our
primary task in this article is to generalize their works to more general parahoric levels so as to
allow possibly bad reductions, in the case that GQp is quasi-split; some of the results will further
assume that Kp is special maximal parahoric. In this generality, the ﬁrst notable change occurs
in deﬁnitions (including that of admissible morphism), in some of which instead of a single aﬃne
Deligne-Lusztig variety X({µX}, b)Kp which deﬁned the term Xp(φ), one needs to use a ﬁnite union
of generalized aﬃne Deligne-Lusztig varieties X(w, b)Kp :

X({µX}, b)Kp :=

Gw∈Adm ˜Kp

(µX )

X(w, b)Kp

Here, Adm ˜Kp
datum (G, X). When Kp is hyperspecial, this reduces to the previous deﬁnition. Meanwhile, the
conjecture (1.0.0.1) itself was extended by Rapoport [Rap05] to cover general parahoric levels.

(µX ) is a certain subset of the extended Weyl group fW of GQp determined by the

To keep the statements short, we will call the following condition the Serre condition for the
Shimura datum (G, X)1 : the center Z(G) of G splits over a CM ﬁeld and the weight homomorphism
wX is deﬁned over Q.

1to distinguish this from two other similar conditions: ﬁrst, from the original Serre condition which is applied to
a Q-torus T endowed with a cocharacter µ ∈ X∗(T ) (cf. Lemma 3.3.1), and secondly from what Kisin calls the Serre
condition for a torus T ([Kis13, 3.7.3]).

3

Our ﬁrst main results are generalizations (sometimes, including improvements) of the key prop-

erties of the objects introduced above brieﬂy:

Theorem 1.0.1. Let p > 2 be a rational prime. Let (G, X) be a Shimura datum satisfying the
Serre condition. Assume that G is of classical Lie type, and that GQp is quasi-split and splits over
a tamely ramiﬁed extension of Qp. Let Kp be a parahoric subgroup of G(Qp). Then, we have the
followings.

(1) Any admissible morphism φ : P → GG is special, namely there exists a special Shimura
sub-datum (T, h) and g ∈ G(Q) such that Intg ◦ φ = i ◦ ψT,h, where i : GT → GG is the canonical
morphism of neutral Galois gerbs induced by the inclusion T ֒→ G.
If Kp is special maximal
parahoric, then every such morphism i ◦ ψT,h is admissible.
(2) Suppose that Kp is special maximal parahoric and Gder is simply connected. Let γ0 ∈ G(Q)
be a rational element, elliptic over R, and whose image in Gad(Ap
f ) lies in a compact open subgroup
of Gad(Ap
f ). Then, there exists an admissible pair (φ, ǫ) with ǫ stably conjugate to γ0 if and only if
there exists ǫ ∈ G(Q) stably conjugate to γ0 and satisfying the condition (∗(γ0)) of Subsec. 3.5.1. If
the latter condition holds, there exists a Kp-eﬀective admissible pair (φ, ǫ) with ǫ stably conjugate
to γt

0 for some t ∈ N.
(3) Under the same assumptions as (2), for every Kottwitz triple (γ0; (γl)l6=p, δ) with trivial
Kottwitz invariant (Def. 3.5.2) and such that γ0 (equiv. (γl)l) lies in a compact open subgroup of
G(Ap
f ) and X({µX}, δ)Kp 6= ∅, there exists an admissible pair (φ, ǫ) giving rise to it. There exists
an explicit cohomological expression for the number of non-equivalent pairs (φ, ǫ) producing a given
triple (γ0; (γl)l6=p, δ).

These statements (and their counterpart results in [LR87]) are found respectively in Theorem
4.1.3, Lemma 3.3.10 (for (1)), Theorem 5.0.16 (for (2)), and Theorem 5.1.1 (for (3)). Being gen-
eralizations, these facts are more or less known in the hyperspecial level case. But the statements
(2), (3) also contain some meaningful improvements: strengthening of the original assertions and
correction of gaps in the original arguments. More precisely, in (2) the condition (∗(γ0)) being used
is diﬀerent from the original condition appearing in [LR87, Satz 5.21], which we ﬁnd insuﬃcient for
that theorem (and the subsequent statements depending on it). Also, we will see that the fact (3)
is stronger and more natural than its counterpart result [LR87, Satz 5.25], which meantime suﬀers
from the same gap. For detailed discussions on these issues, we refer to the above theorems as well
as the remarks accompanying them.

The statement (1) is a fundamental fact about admissible morphisms, and underlies another
closely related conjecture (which was proved in the hyperspecial level case by Zink for PEL-types
and by Kisin ([Kis13, Thm. 0.4]) for Hodge-types) that every isogeny class in SKp(G, X)(¯Fp)
contains a point which is the reduction of a special(=CM) point.

On the other hand, according to the conjecture (1.0.0.1), to any Fpn-point (n being a multiple
of [κ(℘) : Fp]), one should be able to attach a Kottwitz triple (γ0; (γl)l6=p, δ) of level n (i.e. with
δ ∈ G(Ln)). For Hodge-type Shimura varieties with hyperspecial level, this was done by Kisin
([Kis13, Cor. 2.3.1]), but without having control on the level, one can still attach a Kottwitz triple
to any point which is the reduction of a CM point (thus in this case the triple is well-deﬁned only
up to powers). Now, the formula (1.0.0.2) implies that only those triples whose corresponding
summation term is non-zero are eﬀective, i.e. arises from an Fpn-point (where n is the level of the
triple). For that, we point out that in the formula the only possibly zero quantities are O(γl)(f p)
(orbital integral) and T Oδ(φp) (twisted orbital integral), and the non-vanishing of each of these

4

0; (γt

quantities can be translated into explicit conditions on, respectively, (γl)l6=p and δ. Then, a natural
question is whether such necessary conditions for eﬀectivity are also suﬃcient conditions. As an
application of Theorem 1.0.2, we verify a slightly weaker version of this, namely, we show that
if a Kottwitz triple (γ0; (γl)l6=p, δ) satisﬁes such eﬀectivity conditions, then indeed some power
(γt
l )l, δ) of it (where t ∈ N and δ is considered as an element of G(Ltn)) is the triple associated
with the reduction of a CM point.
Closely related questions are which (elliptic) stably conjugacy class in G(Q) and which σ-
conjugacy class in G(Ln) are “eﬀective” (i.e. can be the classes of the elements γ0 and δ attached
to some Fpn-point, respectively). This question for (the stable conjugacy class of) an elliptic rational
element γ0 ∈ G(Q) can be regarded as the Honda-Tate theorem in the context of Shimura varieties,
while the question for δ is known as the non-emptiness problem of Newton strata.
The next two theorems provide answers to both of these questions, while the aforementioned
eﬀectivity criteria is given in the ﬁrst one. Here, we consider Shimura varieties of Hodge type and
ﬁx an integral model SK over O℘ of the canonical model ShK(G, X)E℘ with the extension property
that every F -point of ShK(G, X) for a ﬁnite extension F of E℘ extends uniquely to SK over its
local ring (for example, a normal integral model); see [KP15] for a construction of such integral
model in general parhoric levels.

Theorem 1.0.2 (Thm. 5.2.2). Keep the assumptions of Theorem 1.0.1, and suppose further that
(G, X) is simply connected.

(1) Let C ⊂ G(Q) be a stable conjugacy class. Then, some power of C contains the relative
Frobenius of the reduction of a CM point of ShK(G, X)(C) if and only if a (possibly diﬀerent)
power of C contains some γ0 ∈ G(Q) which satisﬁes the condition (∗(γ0)) of Subsec. 3.5.1 and lies
in a compact open subgroup of G(Ap
(2) Let (γ0; (γl)l6=p, δ) be a Kottwitz triple with trivial Kottwitz invariant and such that γ0 (equiv.

f ).

(γl)l) lies in a compact open subgroup of G(Ap

f ) and
Yp := {x ∈ G(L)/ ˜Kp | σnx = x, inv ˜Kp

(x, δσx) ∈ Adm ˜Kp

({µX})} 6= ∅.

Then, there exists a special Shimura datum (T, h) such that the reduction of the CM point [h, 1·K] ∈
ShK(G, X)(Q) has the associated Kottwitz triple equal to (γ0; (γl)l6=p, δ), up to powers.

We point out that the conditions in (2) are the aforementioned conditions implied by non-

vanishing of the quantities Oγ(f p), T Oδ(φp) in the formula (1.0.0.2), (cf. [Kot84b, §1.5]).
Theorem 1.0.3 (Thm. 4.2.11). Keep the assumptions of Theorem 1.0.1, and further assume that
GQp splits over a cyclic tame extension of Qp. Let Kp be a (not necessarily special) parahoric
subgroup of G(Qp) and put K = KpKp for a compact open subgroup Kp of G(Ap

f ).

(1) Then, for any [b] ∈ B(GQp,{µX}) (Subsec. 2.1.4), there exists a special Shimura sub-datum
(T, h ∈ Hom(S, TR) ∩ X) such that for any gf ∈ Kp, the reduction in SK ⊗ ¯Fp of the special point
[h, gf · K] ∈ ShK(G, X)(Q) has the F -isocrystal represented by [b].
(2) The reduction SK(G, X) ⊗ ¯Fp has non-empty ordinary locus if and only if ℘ has absolute
height one (i.e. E(G, X)℘ = Qp).

These results generalize Theorem 4.3.1 and Corollary 4.3.2 of [Lee14] in the hyperspecial cases.
We make some comments on the various assumptions appearing in this article. The running
assumption, which will be eﬀective except in some general discussions, is that GQp is quasi-split.

5

Equally universal assumption, although it is not needed for the important Theorem 1.0.1, (1), is
that Kp is special maximal parahoric. These two assumptions are somewhat forced on us because
for proofs we follow closely the original line of arguments. The assumption that G is of classical Lie
type and splits over a tame extension of Qp is less serious, even though it appears in many places
(including all the statements of Theorem 1.0.1). It is imposed whenever we invoke Prop. B.0.6,
which assumes it. In turn, this assumption shows up in that proposition, simply because we were
only able to verify that proposition for classical groups that splits over a tamely ramiﬁed extension
of Qp. Therefore, if Prop. B.0.6 could be extended beyond such cases, we can relax that restriction
accordingly (or even purge that assumption of this paper).

Finally, we remark that our sign convention is the same as that of Langlands-Rapoport in

[LR87]; so for example, it is opposite to that of Kisin in [Kis13].

This article is organized as follows. The second section is of preliminary nature, devoted to
a review of some basic objects, including the Newton and Kottwitz maps (deﬁned for algebraic
groups over p-adic ﬁelds), parahoric groups (in the Bruhat-Tits theory), extended Weyl groups,
and the {µ}-admissible set. In the third section, we attempt to give a self-contained overview of
the notions of Galois gerbs, the pseudo-motivic Galois gerb, admissible morphisms, Kottwitz triples,
and admissible pairs, following closely the original source [LR87]. We also give a statement of the
Langlands-Rapoport conjecture, as formulated by Rapoport [Rap05, §8] so as to cover parahoric
levels. Along the way, we extend results on special admissible morphisms to (special maximal)
parahoric subgroups, under the assumption that GQp is quasi-split.
In the fourth section, we
prove Theorem 1.0.1, (1) above, namely that every admissible morphism is conjugate to a special
admissible morphism (in our case of general parahoric level), as well as the fact that every admissible
pair is nested in a special Shimura datum. For some other potential applications in mind, we spilt
the proof into a few steps and formalize each of them into a separate proposition (incorporating
slight improvements). The results in this section are in large part translations of the original
results, except for reorganization (with small improvements) and the non-trivial generalization of
[LR87, Lemma 5.11] in Lemma 4.2.4, which is also a key input in our proof of the non-emptiness
of Newton strata. In the ﬁnal section, we prove the remaining statements (2) and (3) of Theorem
1.0.1, and the eﬀectivity criteria of elliptic stable conjugacy classes and Kottwitz triples. Here, as
remarked before, we point out and ﬁx some gaps in the original proof of the corresponding results in
the hyperspecial level case. Throughout this article, we will mainly work with the pseudo-motivic
Galois gerb by assuming the aforementioned Serre condition for the Shimura datum (G, X). But
still some deﬁnitions use the quasi-motivic Galois gerb, so we provide its deﬁnition in the appendix.
Furthermore, in this work, a certain result in the Bruhat-Tits theory, whose hyperspecial case was
established in our previous work [Lee14, Lemma A.0.4], plays a key role. We provide its proof in
the appendix.

Acknowledgement This work was supported by IBS-R003-D1. The author would like to

thank M. Rapoport and C.-L. Chai for their interests in this work and encouragement.

Notations
Throughout this paper, Q denotes the algebraic closure of Q inside C.
For a (connected) reductive group G over a ﬁeld, we let Gsc be the universal covering of its
derived group Gder, and for a (linear algebraic) group G, Z(G), and Gad denote its center, and the
adjoint group G/Z(G), respectively.

For a group I and an I-module A, we let AI denote the quotient group of I-coinvariants:
AI = A/hia − a | i ∈ I, a ∈ Ai. For an element a ∈ A, we write a for the image of a in AI . In case

6

of need for distinction, sometimes we write aA.

For a ﬁnitely generated abelian group A, we denote by Ators its subgroup of torsion elements.
Also, for a locally compact abelian group A, we let X∗(A), X ∗(A), and AD denote the (co)character
groups Hom(C×, A), Hom(A, C×), and the Pontryagin dual group Hom(A, Q/Z), respectively.

In this article, the letter L denotes primarily the completion of the maximal unramiﬁed extension
(in a ﬁxed algebraic closure Qp) of Qp. On few occasions, it also denotes a ﬁnite CM extension of Q,
in which case, if one also needs a notation for the completion of the maximal unramiﬁed extension
of Qp, we will use the german letter k (the original notation of Langlands-Rapoport).

2 Parahoric subgroups and µ-admissible set

2.1 Kottwitz maps and Newton map In this section, we brieﬂy recall the deﬁnitions of
the Kottwitz maps and the Newton map. We refer to [Kot97], [Kot85], [RR96], and references
therein for further details.

2.1.1 The Kottwitz maps wG, vG, κG Let L be a strictly henselian discrete valued ﬁeld and
set I := Gal(L/L). For any connected reductive group G over L, Kottwitz ([Kot97, §7]) constructs
a group homomorphism

wG : G(L) → X ∗(Z(bG)I ) = π1(G)I .

Here, bG denotes the Langlands dual group of G, π1(G) = X∗(T )/Σα∈R∗ Zα∨ is the fundamental
group of G (`a la Borovoi) (i.e. the quotient of X∗(T ) for a maximal torus T over F of G by the
coroot lattice), and π1(G)I is the (quotient) group of coinvariants of the I-module π1(G). This
in [Rap05]. When Gder is simply connected (so that
map wG is sometimes denoted by eκG, e.g.
π1(G) = X∗(Gab) for Gab = G/Gder), wG factors through Gab: wG = wGab ◦ p, where p : G → Gab
is the natural projection ([Kot97, 7.4]).

There is also a homomorphism

vG : G(L) → Hom(X∗(Z(bG))I , Z)

sending g ∈ G(L) to the homomorphism χ 7→ val(λ(g)) from X∗(Z(bG))I = HomL(G, Gm) to Z,

where val is the usual valuation on L, normalized so that uniformizing elements have valuation 1.

There is the relation: vG = qG ◦ wG, where qG is the natural surjective map

qG : X ∗(Z(bG)I ) = X ∗(Z(bG))I → Hom(X∗(Z(bG))I , Z).

The kernel of qG is the torsion subgroup of X ∗(Z(bG))I , i.e. Hom(X∗(Z(bG))I , Z) ∼= π1(G)I /torsions;
in particular, qG is an isomorphism if the coinvariant group X ∗(Z(bG))I is free (e.g. the I-module
X ∗(Z(bG)) is trivial or more generally induced, i.e. has a Z-basis permuted by I).
For example, when G is a torus T , we have that hχ, wT (t)i = val(χ(t)) for t ∈ T (L), χ ∈ X ∗(T )I ,
where h , i is the canonical pairing between X ∗(T )I and X∗(T )I .
Now suppose that G is deﬁned over a local ﬁeld F , i.e. a ﬁnite extension of Qp (in a ﬁxed
algebraic closure Qp). Let L be the completion of the maximal unramiﬁed extension F ur of F in
Qp and let σ denote the Frobenius automorphism on L which ﬁxes F and induces x 7→ xq on the
residue ﬁeld of L (∼= ¯Fp), where the residue ﬁeld of F is Fq. In this situation, the maps vGL, wGL
each induce a notable map.

7

First, as vGL and wGL commute with the action of Gal(F ur/F ), by taking H 0(Gal(F ur/F ),−)

on both sides of vGL, we obtain a homomorphism

λG : G(F ) → Hom(X∗(Z(bG))I , Z)hσi ∼= (π1(G)I /torsions)hσi,

Next, let B(G) denote the set of σ-conjugacy classes:

denoted by the same symbol) when G is unramiﬁed over F , in which case the canonical action of

where I ∼= Gal(F /F ur). This is the map introduced in [Kot84b, §3] and used in [LR87] (there,
I on Z(bG) is trivial, so the target becomes X ∗(Z(bG))ΓF (ΓF := Gal(F /F )) (and also wGL = vGL).
σ∼ b2, if there exists
where two elements b1, b2 of G(L) are said to be σ-conjugate, denoted b1
g ∈ G(L) such that b2 = gb1σ(g)−1. Then, by taking H 1(Gal(F ur/F ),−), wGL induces a map of
sets

B(G) := G(L)/

σ∼,

κG : B(G) → X ∗(Z(bG)ΓF ) = π1(G)ΓF : κG([b]) = wGL(b)

Here, for b ∈ G(L), [b] denotes its σ-conjugacy class, and for x ∈ π(G)I , x denotes its image under
the natural quotient map π(G)I → π(G)ΓF . This map is functorial in G. For further details, see
[Kot97, 7.5].

2.1.2 The Newton map νG Let D denote the protorus lim←− Gm with the character group
Q = lim−→ Z. For an algebraic group G over a p-adic local ﬁeld F , we put

N (G) := (HomL(D, G)/Int(G(L)))σ

(the subset of σ-invariants in the set of G(L)-conjugacy classes of L-rational quasi-cocharacters
into GL). We will use the notation ν for the the conjugacy class of ν ∈ HomL(D, G).
For every b ∈ G(L), Kottwitz [Kot85, §4.3] constructs an element ν = νb ∈ HomL(D, G)
uniquely characterized by the property that there are an integer s > 0, an element c ∈ G(L) and a
uniformizing element π of F such that:

(i) sν ∈ HomL(Gm, G).
(ii) Int(c) ◦ sν is deﬁned over the ﬁxed ﬁeld of σs in L.
(iii) c · (b ⋊ σ)s · c−1 = c · (sν)(π) · c−1 ⋊ σs.
In (iii), the product (and the equality as well) take place in the semi-direct product group G(L)⋊hσi.
We call νb the Newton homomorphism attached to b ∈ G(L).
Q is “the average map”
X∗(T )I → X∗(T )ΓF → X∗(T )ΓF
1.15, (iii)]). Hence, it follows that if T is split by a ﬁnite Galois extension K ⊃ F , for b ∈ T (L),
[K : F ]νb ∈ X∗(T ) and that hχ, νbi = val(χ(b)) (especially ∈ Z) for every F -rational character χ of
T .

Q sending µ (µ ∈ X∗(T )) to |ΓF · µ|−1Pµ′∈ΓF ·µ µ′ (cf. [RR96, Thm.

When G is a torus T , νb = av ◦ wTL(b), where av : X∗(T )I → X∗(T )ΓF

The map b 7→ νb has the following properties.
(a) νσ(b) = σ(νb).
(b) gbσ(g)−1 7→ Int(g) ◦ ν, g ∈ G(L).

8

(c) νb = Int(b) ◦ σ(νb).
It follows from (b) and (c) that νG : G(L) → HomL(D, G) gives rise to a map νG : B(G) → N (G),
which we call the Newton map. This can be also regarded as a functor from the category of
connected reductive groups to the category of sets (endowed with partial orders deﬁned as below):

ν : B(·) → N (·) ; νG([b]) = νb,

b ∈ [b].

2.1.3 For a connected reductive group G over an arbitrary (i.e. not necessarily p-adic) ﬁeld F ,
let BR(G) = (X ∗, R∗, X∗, R∗, ∆) be the based root datum of G: we may take X ∗ = X ∗(T ),
X∗ = X∗(T ) for a maximal F -torus T of G and R∗ ⊂ X ∗(T ), R∗ ⊂ X∗(T ) are respectively the
roots and the coroots for the pair (G, T ) with a choice of basis ∆ of R∗ (whose choice corresponds
to that of a Borel subgroup B over F ). Let C ⊂ (X∗)Q denote the closed Weyl chamber associated
with the root base ∆. It comes with a canonical action of ΓF := Gal(F /F ) on C.

For a cocharacter µ ∈ HomF (Gm, G) lying in C, we set

µ := |ΓF · µ|−1 Xµ′∈ΓF ·µ

µ′ ∈ C.

Here, the orbit ΓF · µ is obtained using the canonical Galois action on C. Once a Weyl chamber
C (equivalently, a Borel subgroup B or a root base ∆) is chosen, µ depends only on the G(F )-
conjugacy class {µ} of µ.

Suppose that µ ∈ X∗(T ) ∩ C. As X∗(T ) = X ∗(bT ) for the dual torus bT of T , regarded as a
character on bT , we can restrict µ to the subgroup Z(bG)ΓF of bT , obtaining an element
Again, µ♮ depends only on the G(F )-conjugacy class {µ} of µ. Alternatively, µ♮ equals the image
(sometimes, also denoted by µ) of µ ∈ X∗(T ) under the canonical map X∗(T ) → π1(G)ΓF .

µ♮ ∈ X ∗(Z(bG)ΓF ) = π1(G)ΓF .

(2.1.3.1)

2.1.4 The set B(G,{µ}) Again, let us return to a p-adic ﬁeld F . We ﬁx a closed Weyl
chamber C (equiv. a Borel subgroup B over F ). Suppose given a G(F )-conjugacy class {µ} of
cocharacters into GF . Let µ be the representative of {µ} in C; so we have µ = µ(G,{µ}) ∈ C and

µ♮ ∈ X ∗(Z(bG)ΓF ). We deﬁne a ﬁnite subset B(G,{µ}) of B(G) (cf. [Kot97, Sec.6], [Rap05, Sec.4]):
where (cid:22) is the natural partial order on the closed Weyl chamber C deﬁned by that ν (cid:22) ν′ if ν′ − ν
is a nonnegative linear combination (with rational coeﬃcients) of simple coroots in R∗(T ) ([RR96],
Lemma 2.2). One knows ([Kot97, 4.13]) that the map

B(G,{µ}) :=n [b] ∈ B(G) | κG([b]) = µ♮,

νG([b]) (cid:22) µo ,

is injective, hence B(G,{µ}) can be identiﬁed with a subset of N (G).

(ν, κ) : B(G) → N (G) × X ∗(Z(bG)ΓF )

2.2 Parahoric subgroups Our main references here are [Rap05], [HR08], [HS10], as well as
[BT72], [BT84].

9

2.2.1 Let G be a connected reductive group G over a strictly henselian discrete valued ﬁeld L. Let
B(G, L) be the Bruhat-Tits building of G over L (cf. [Tit79], [BT72], [BT84]). Then, a parahoric
subgroup of G(L) is a subgroup of the form

Kf = Fix f ∩ Ker wG

for a facet f of B(G, L). Here, Fix f denotes the subgroup of G(L) ﬁxing f pointwise and wG is
the Kottwitz map (2.1.1). When f is an alcove of B(G, L) (i.e. a maximal facet), the parahoric
subgroup is called an Iwahori subgroup. A special maximal parahoric subgroup of G(L) is the
parahoric subgroup attached to a special point in B(G, L). More precisely, choose a maximal split
torus A of G and let A(A, L) be the associated apartment; let A(Aad, L) be the apartment in
B(Gad, L) corresponding to the image Aad of A in Gad. Then, there exists a canonical simplicial
isomorphism ([Tit79, 1.2])

A(A, L) ∼= A(Aad, L) × X∗(Z(G))ΓF ⊗ R.

The original deﬁnition of pararhoic subgroups by Bruhat-Tits ([BT84, 5.2.6], cf.

Then, every special point in A(A, L) is of the form {v}×x for a unique special vertex v of A(Aad, L)
(in the sense of [Tit79, 1.9]) and some x ∈ X∗(Z(G))ΓF ⊗ R.
[Tit79, 3.4])
uses group schemes. With every facet f of B(G, L) they associate a smooth group scheme Gf over
Spec(OL) with generic ﬁber G such that Gf (OL) = Fix f . Also, there exists an open subgroup
Go
f with the same generic ﬁber G and the connected special ﬁber. Then, the parahoric subgroup
attached to f by Bruhat-Tits is Go

f (OL). It is known ([HR08, Prop.3]) that they coincide:

Kf = Go

f (OL).

Now suppose that G is deﬁned over a local ﬁeld F , as before given as a ﬁnite extension of Qp
in Qp. Again, L denotes the completion of the maximal unramiﬁed extension of F in Qp and let
σ be the Frobenius automorphism. Let B(G, L) (resp. B(G, F )) be the Bruhat-Tits building of G
over L (resp. over F ); as G is deﬁned over F , B(G, L) carries an action of G(L) ⋊ hσi and B(G, F )
is identiﬁed with the set of ﬁxed points of B(G, L) under hσi ([BT84, 5.1.25]). This procedure of
taking σ-ﬁxed points f 7→ f σ gives a bijection from the set of σ-stable facets in B(G, L) to the set
of facets in B(G, F ).
f (OL)σ for a σ-stable facet f of B(G, L). A
f (OL)σ for a special point f ∈ B(G, F ) (see [Tit79,
special maximal parahoric subgroup of G(F ) is Go
1.9] for the deﬁnition of a special point).

A parahoric subgroup of G(F ) is by deﬁnition Go

2.2.2 Extended aﬃne Weyl group Let G be a connected reductive group G over a strictly
henselian discrete valued ﬁeld L. Let S be a maximal split L-torus of G and T its centralizer; T is
a maximal torus since GL is quasi-split by a well-known theorem of Steinberg. Let N = NG(T ) be
the normalizer of T . The extended aﬃne Weyl group (or Iwahori Weyl group) associated with S is
the quotient group

˜W := N (L)/T (L)1,

where T (L)1 is the kernel of the Kottwitz map wT : T (L) → X∗(T )I . As wT is surjective, it is an
extension of the relative Weyl group W0 := N (L)/T (L) by X∗(T )I :

0 → X∗(T )I → ˜W → W0 → 0.

(2.2.2.1)

10

The normal subgroup X∗(T )I is called the translation subgroup of ˜W , and any λ ∈ X∗(T )I , viewed
as an element in ˜W in this way, will be denoted by tλ (translation element).
This extension splits by choosing a special vertex v in the apartment corresponding to S, namely

if K = Kv ⊂ G(L) is the associated parahoric subgroup, the subgroup

˜WK := (N (L) ∩ K)/T (L)1
of ˜W projects isomorphically to W0, and thus gives a splitting

˜W = X∗(T )I ⋊ ˜WK.

For two parahoric subgroups K and K ′ associated with facets in the apartment corresponding

to S, there exists an isomorphism

K\G(L)/K ′ ∼= ˜WK\ ˜W / ˜WK ′.

(2.2.2.2)

Let Ssc (resp. T sc, N sc) be the inverse image of S (resp. T , N ) in the universal covering Gsc
of Gder; then, Ssc is a maximal split torus of Gsc and T sc (resp. N sc) is its centralizer (resp. the
normalizer of N sc). The natural map N sc(L) → N (L) induces an injection X∗(T sc)I ֒→ X∗(T )I
and presents the extended aﬃne Weyl group associated with (Gsc, Ssc)

Wa := N sc(L)/T sc(L)1

as a normal subgroup of the extended aﬃne Weyl group ˜W (attached to S) such that the translation
subgroup X∗(T )I maps onto the quotient ˜W /Wa with kernel X∗(T sc)I :
0 → Wa → ˜W → X∗(T )I /X∗(T sc)I → 0.

(2.2.2.3)

Note that the quotient group X∗(T )I /X∗(T sc)I is in a natural way a subgroup of π1(G)I . The
group Wa can be also regarded as an aﬃne Weyl group attached to some reduced root system.

This extension (2.2.2.3) also splits by the choice of an alcove in the apartment A(S, L) of S.
More precisely, the extended aﬃne Weyl group ˜W (resp. the aﬃne Weyl group Wa) acts transitively
(resp. simply transitively) on the set of alcoves in A(S, L), hence when we choose a base alcove a
in A(S, L),
(2.2.2.4)

˜W = Wa ⋊ Ωa,

where Ωa is the normalizer of a; Ωa will be often identiﬁed with X∗(T )I /X∗(T sc)I .

Finally, suppose that there is an automorphism σ of L such that L is the strict henselization of
its ﬁxed ﬁeld L♮ and that G is deﬁned over L♮. Then, we can ﬁnd a L♮-torus S such that SL becomes
maximal split L-torus and a maximal L♮-torus T which contains S; set N to be the normalizer of
T . Then σ acts on the extended Weyl group ˜W in the obvious way. Moreover, if Kv ⊂ G(L) is the
parahoric subgroup attached to a σ-stable facet v, then the subgroup ˜WKv is stable under σ. We
refer the reader to [HR08, Remark 9] for a “descent theory” in this situation.

2.2.3 The {µ}-admissible set As before, let G be a connected reductive group G over a
complete discrete valued ﬁeld L with algebraically closed residue ﬁeld. Let W = N (L)/T (L) be
the absolute Weyl group. Let {µ} be a G(L)-conjugacy class of cocharacters of G over L. We
use {µ} again to denote the corresponding W -orbit in X∗(T ). Let us choose a Borel subgroup B

11

over L containing T (which exists as GL is automatically quasi-split), and let µB be the unique
representative of {µ} lying in the associated absolute closed Weyl chamber in X∗(T )R. Then, the
W0-orbit of the image µB of µB in X∗(T )I is well-determined, since any two Borel subgroups over
L containing T are conjugate under G(L). We denote this W0-orbit by Λ({µ}):

Λ({µ}) := W0 · µB ⊂ X∗(T )I .

It is known ([Rap05, Lemma 3.1]) that the image of Λ({µ}) in the quotient group X∗(T )I /X∗(T sc)I
consists of a single element, which we denote by τ ({µ}).
Let us now ﬁx an alcove a in the apartment corresponding to S. This determines a Bruhat
order on the aﬃne Weyl group Wa which extends to the extended Weyl group ˜W = Wa ⋊ Ωa
(2.2.2.4), ([KR00, §1]). Also, when K ⊂ G(L) is a parahoric subgroup associated with a facet of a,
it induces a Bruhat order on the double coset space ˜WK\ ˜W / ˜WK ([KR00, §8]). We will denote all
these orders by ≤; this should not cause much confusion.
Deﬁnition 2.2.4. The {µ}-admissible subset of ˜W is

Adm({µ}) = {w ∈ ˜W | w ≤ tλ for some λ ∈ Λ({µ})},

and the {µ}-admissible subset of ˜WK\ ˜W / ˜WK is

AdmK({µ}) = {w ∈ ˜WK\ ˜W / ˜WK | w ≤ ˜WK tλ ˜WK for some λ ∈ Λ({µ})}.

One knows ([Rap05, (3.8)]) that AdmK ({µ}) is the image of Adm({µ}) under the natural map

˜W → ˜WK\ ˜W / ˜WK .
Proposition 2.2.5. Suppose that G splits over L (thus S = T ) and K is a special maximal
parahoric subgroup. Then,

AdmK ({µ}) = {ν ∈ X∗(S) ∩ C | ν

!

≤ µ},

where µ denotes the representative in C of {µ}.
consists of a single element, i.e. {µ} ∈ X∗(T )/W itself.

If furthermore {µ} is minuscule, AdmK ({µ})

!

Here, ν

≤ µ means that µ − ν is a sum of simple coroots with non-negative integer coeﬃcients.

See Prop. 3.11 and Cor. 3.12 of [Rap05] for a proof.

3 Pseudo-motivic Galois gerb and admissible morphisms

This section is devoted to a review of the theory of pseudo-motivic Galois gerbs and admissible
morphisms, as explained in [LR87]. In addition to this original source [LR87], our main references
are [Mil92], [Kot92], [Rei97].

12

3.1 Galois gerbs We review the notion of Galois gerbs as used by Langlands-Rapoport in
[LR87, §2] (cf. [Bre94, §4], [Rap05, §8], [Rei97, Appendix B]).
Let k be a ﬁeld of characteristic zero (which will be for us either a global or a local ﬁeld) and
k an algebraic closure. For an aﬃne group scheme G = SpecA over a Galois extension k′ ⊂ k
of k and σ ∈ Gal(k′/k), an automorphism κ of G(k′) is said to be σ-linear if there is a σ-linear
automorphism κ′ of the algebra A such that

κ′(f )(κ(g)) = σ(f (g)),

f ∈ A, g ∈ G(k′).

The simplest example is given by the natural action of Gal(k′/k) on G(k′), when G is deﬁned over
k. In this article, we will be concerned mainly with the following kind of Galois gerbs, which will
be called algebraic. For σ ∈ Gal(k′/k), let

σk′ : G(k′) → (σ∗G)(k′)

be the unique map for which f ⊗ 1(σk′(g)) = σ(f (g)) holds for f ∈ A, g ∈ G(k′), where f ⊗
1 ∈ A ⊗k′,σ k′. Then, for any algebraic isomorphism θ of k′-group schemes from σ∗G to G, the
automorphism θ ◦ σk′ of G(k′) is σ-linear, since then one can take κ := θ ◦ σk′ and κ′(f ) :=
∼→ A ⊗k′,σ k′ denotes the associated map on the structure sheaf).
(θ∗)−1(f ⊗ 1) (Here, θ∗ : A
We will call such σ-linear automorphism of G(k′) algebraic. Hence, one can identify an algebraic
∼→ G via κ(σ) = θ(σ)◦σk′.
σ-linear isomorphism κ(σ) with an algebraic k′-isomorphism θ(σ) : σ∗(G)
Deﬁnition 3.1.1. Let k′ ⊂ k be a Galois extension of k. A k′/k-Galois gerb is an extension of
topological groups

where G is an aﬃne smooth group scheme (i.e. a linear algebraic group) over k′ and G(k′) (resp.
Gal(k′/k)) has the discrete (resp. the Krull) topology, such that

1 −→ G(k′) −→ G −→ Gal(k′/k) −→ 1,

(i) for every representative gσ ∈ G of σ ∈ Gal(k′/k), the automorphism κ(σ) : g 7→ gσgg−1

σ

G(k′) is algebraic σ-linear.

of

(ii) for some ﬁnite sub-extension k ⊂ K ⊂ k′, there exists a continuous section

which is a group homomorphism.

Gal(k′/K) −→ G : σ 7→ gσ

In the presence of (i), the condition (ii) means that the family {θ(σ) : σ∗(G) ∼→ G} of isomor-
phisms associated with Int(gσ) is a k′/K-descent datum on G: the homomorphism property of (ii)
gives the cocycle condition of descent datum. Thus the section σ 7→ gσ (σ ∈ Gal(k′/K)) determines
a K-structure on G and accordingly an action of Gal(k′/K) on G(k′). This Galois action is nothing
other than θ(σ) ◦ σk′,2 namely, we have the relation

gσgg−1

σ = σ(g),

σ ∈ Gal(k′/K),

(3.1.1.1)

2Suppose that the K-structure is given by an isomorphism α : G0 ⊗K k′ ∼

Then, it gives rise to a descent isomorphism α ◦ σ∗(α−1) : σ∗(G) ∼
G(k′) = G0(k′). Since the descent isomorphism was θ(σ), we have σ(g) = α ◦ σ∗(α−1)(σk′ (g)) = θ(σ) ◦ σk′ (g).

→ G for an algebraic K-group G0.
→ G and a Galois action σ(g) = α ◦ σ(α−1(g)) on

13

where σ(g) is the just mentioned action of σ ∈ Gal(k′/K) on G(k′). In other words, the conditions
(i), (ii) imply that over some ﬁnite Galois extension K ⊂ k′ of k, there exists a group-theoretic
section σ 7→ ρσ, via which the pull-back to Gal(k′/K) of G becomes a semi-direct product G(k′) ⋊
Gal(k′/K), with the action of Gal(k′/K) on G(k′) (i.e. the conjugation action of Gal(k′/K) on
G(k′) via the section) being the natural Galois acton resulting from a K-structure on G.

We remark that our deﬁnition of Galois gerb is equivalent to that of aﬃne smooth gerb3 on the
´etale site Spec(k)´et equipped with a neutralizing object over Spec(K).4 For a detailed discussion of
this relation, we refer to [LR87, p.152-153], [Bre94, §4].
We call the group scheme G the kernel of G and write G = G∆. A morphism between k′/k-
Galois gerbs ϕ : G → G′ is a continuous map of extensions which induces the identity on Gal(k′/k)
and an algebraic homomorphism on the kernel groups. Two morphisms φ1 and φ2 are said to be
conjugate if there exists g′ ∈ G′(k′) with φ2 = Int(g′) ◦ φ1. With every linear algebraic group G
over k, the semi-direct product gives a gerb

GG = G(k′) ⋊ Gal(k′/k).

We call it the neutral gerb attached to G.

For two successive Galois extensions k ⊂ k′ ⊂ k′′ ⊂ k, any k′/k-Galois gerb G gives rise to a
k′′/k-Galois gerb G′, by ﬁrst pulling-back the extension G by the surjection Gal(k′′/k) ։ Gal(k′/k)
and then pushing-out via G(k′) → G(k′′). In this situation, we will call G′ the inﬂation to k′′ of the
k′/k-Galois gerb G; this terminology will be justiﬁed when we relate Galois gerbs with commutative
kernels to Galois cohomology. We also call a k/k-Galois gerb, simply a Galois gerb over k.
It
follows from deﬁnition that any Galois gerb over k is the inﬂation of a k′/k-Galois gerb for some
ﬁnite Galois extension k ⊂ k′ ⊂ k and that every morphism between k′/k-Galois gerbs induces a
morphism between their inﬂations to k′′ for any sub-extension k′′ ⊂ k.
For two morphisms of k′/k-Galois gerbs φ1, φ2 : G → G′, there exists a k-scheme Isom(φ1, φ2),
whose set of R-points, for a k-algebra R, is given by

Isom(φ1, φ2)(R) = {g ∈ G′∆(k′ ⊗k R) | Int(g) ◦ φ1 = φ2},

where the equality is considered in the push-out of G′ by G′∆(k′) → G′∆(k′ ⊗k R). When, φ1 = φ2,
this is a k-group scheme which we also denote by Iφ1 = Aut(φ1).

3.1.2 Galois gerbs deﬁned by 2-cocyles with values in commutative aﬃne group
schemes In our work (as well as in the work of Langlands-Rapoport), besides the neutral gerbs
attached to arbitrary algebraic groups, all the nontrivial Galois gerbs have as associated kernel
commutative aﬃne group schemes (in fact, (pro-)tori) deﬁned over base ﬁelds. In such cases, a
Galois gerb has an explicit description in terms of 2-cocycles (in the usual sense) on the absolute

3in the sense of Giruad, or in the sense of the theory of Tannakian categories, namely, a stack in groupoids over
an ´etale site which is locally nonempty and locally connected, cf. [Mil92, Appendix], [DMOS82, Ch.II], [Bre94, 2.2].
4The 2-category of such aﬃne gerbs endowed with a distinguished neutralizing object is equivalent to the 2-category
of aﬃne Spec(K)/Spec(k)-groupoid schemes, acting transitively on Spec(K), ([Mil92], Appendex, Prop. A.15). For
this reason, Milne insists to call Galois gerbs in our sense groupoids ([Mil92], [Mil03]). But any two neutralizing
local objects become isomorphic over k, thus a gerb G (as a stack) is uniquely determined by its associated groupoid
(G, x ∈ Ob(G(k))), up to conjugation by an element of Aut(x) = G∆(k). Hopefully, this justiﬁes our decision to stick
to the original terminology of Langlands-Rapoport.

14

Galois group of the base ﬁeld with values in the geometric points of given commutative aﬃne group
scheme endowed with the natural Galois action.

Recall that for a group H and an H-module A (i.e. an abelian group with H-action), a
normalized5 2-cocyle (or “factor set”) (eh1,h2) on H with values in A gives rise to an extension of
H by A:

with property

1 → A → E

p

→ H → 1

(3.1.2.1)
where the right action of p(e) on A is the given one. Explicitly, E is generated by A and {eh}h∈H
(a 7→ 0, eh 7→ h giving the projection E → H) with relations

(e ∈ E, a ∈ A),

e · a · e−1 = p(e)(a)

eh · a · e−1

h = h(a) (a ∈ A, h ∈ H),

eh1,h2 = eh1 · eh2 · e−1

h1h2

,

e1 = 1

(eh1,h2 ∈ Z 2(H, A) guarantees the associativity of the resulting composition law). Two extensions
E, E′ of H by A with the property (3.1.2.1) are said to be isomorphic if there exists an isomorphism
E ∼→ E′ which restricts to identity on A and also induces identity on H. Then, this construction
gives a bijection of pointed sets between H 2(H, A) and the set of isomorphisms classes of group
extensions of H by A with the induced conjugation action of H on A being the given one. Here, the
distinguished points are the cohomology class of the trivial 2-cocycle and the semi-direct product,
respectively. For two isomorphic extensions E, E′ with the property (3.1.2.1), we say that two
∼→ E′ which induce identities on A and H are equivalent (or conjugate) if
isomorphisms f1, f2 : E
f2 = Inta ◦ f1 for some a ∈ A, where Inta is the conjugation automorphism of E′. Then, there is a
natural action of H 1(H, A) on the set of equivalence classes of isomorphisms from E to E′, which
makes the latter set into a torsor under H 1(H, A).

Now, suppose that G is a separable commutative aﬃne group scheme over k: then G is the
inverse limit of a strict system of commutative algebraic groups indexed by (N,≤) (cf. [Mil03, 2.6]).
If k′ ⊂ k is a Galois extension of k, G(k′) is endowed with the inverse limit topology (for algebraic
group Q, Q(k′) is given the discrete topology) and we get a continuous action of Gal(k′/k) on G(k′)
provided by the k-structure of G. Then, for any continuous 2-cocycle (eρ,τ ) ∈ Z 2
cts(Gal(k′/k), G(k′)),
the resulting extension

1 → G(k′) → Ek′ → Gal(k′/k) → 1

is a k′/k-Galois gerb. Indeed, the condition (i) of Deﬁnition 3.1.1 is obvious, and for (ii), we note
cts(Gal(k′/k), G(k′)) lies in H 2(Gal(K/k), G(K))
that since G(k′) has discrete topology, any class in H 2
for a ﬁnite Galois extension K of k, so becomes trivial when restricted to Gal(k′/K). Furthermore,
by pulling-back along Gal(k/k) ։ Gal(k′/k) and push-out via G(k′) ֒→ G(k), we obtain a Galois
gerb E over k

1 → G(k) → E → Gal(k/k) → 1,

which we called the inﬂation of Ek′ to k. Now, one can verify that the corresponding cohomol-
ogy class in H 2
cts(Gal(k′/k), G(k′)) under the
inﬂation map H 2

cts(Gal(k/k), G(k)) is indeed the image of (eρ,τ ) ∈ H 2
cts(Gal(k′/k), G(k′)) → H 2

cts(Gal(k/k), G(k)).

3.2 Pseudo-motivic Galois gerb

5i.e. eh,1 = e1,h = 1 for all h ∈ H.

15

3.2.1 Local Galois gerbs Here, we deﬁne a Galois gerb Gv over Qv for each place v of Q.

For v 6= p,∞, we deﬁne Gv to be the trivial Galois gerb Gal(Qv/Qv):

1 → 1 → Gal(Qv/Qv) → Gal(Qv/Qv) → 1.

For v = ∞, the cocycle (dρ,γ) ∈ Z 2(Gal(C/R), C×)
d1,1 = d1,ι = dι,1 = 1,

dι,ι = −1,

where Gal(C/R) = {1, ι}, represents the fundamental class in H 2(Gal(C/R), C×) ([Mil13]). We set
G∞ to be the (isomorphism class of) Galois gerb deﬁned by this cocycle (or its cohomology class):

So, G∞ has generators C× and w = w(ι) (lift of ι) satisfying that

1 → C× → G∞ → Gal(C/R) → 1,

w(ι)2 = −1 ∈ C×, and wzw−1 = ι(z) = z (z ∈ C×).

For v = p also, for any ﬁnite Galois extension K of Qp in Qp, there is the fundamental class in
H 2(Gal(K/Qp), K ×) ([Mil13]). For unramiﬁed extension Ln/Qp, it is represented by the cocycle:
for 0 ≤ i, j < n,

dσi,σj =(p−1

1

if i + j ≥ n,
otherwise,

where σ ∈ Gal(Ln/Qp) is the arithmetic Frobenius.
gerb over Qp obtained from GK

p,K by inﬂation:6

We let GK

p,K be the corresponding (isomorphism class of) K/Qp-Galois gerb and GK

p the Galois

→

→

K ×

K ×

→

→

1

1

1

Gm(Qp)

→
p,K is the pull-back of GK
K GK

→

KGK

p,K along K × ֒→ Gm(Qp).

Here, π∗
push-out of π∗

homomorphism

GK

p,K

π∗
KGK
p,K

GK
p

→

→

→

Gal(K/Qp)

πK

Gal(Qp/Qp)

Gal(Qp/Qp)

→

→

→

p,K along πK : Gal(Qp/Qp) ։ Gal(K/Qp), and GK
p

(3.2.1.1)

1

1

1.

is the

For each K ⊂ K ′ ⊂ Qp (K ′ being a Galois extension of Qp containing K), there exists a

GK ′
p → GK

p

which, on the kernel, is given by z 7→ z[K ′:K] ([LR87, p.119], [Rei97, Remark B1.2]). By passing
to the inverse limit over K ⊃ Qp, we obtain a pro-Galois gerb Gp over Qp with kernel D = lim←− Gm
(the protorus over Qp with character group X ∗(D) = Q).

6Note that our notations for these gerbs diﬀer from those of [Kis13]: our GK

p,K (resp. GK

p ) is his GK

p (resp. ˜GK

p ).

16


_


O
O


O
O
O
O
For each Galois extension K ⊂ Qp of Qp, we make a choice of a normalized cocycle (dK

τ1,τ2)
to the projection

p,K, and ﬁx a section τ 7→ sK

τ

on Gal(K/Qp) with values in K × deﬁning GK
GK
p,K → Gal(K/Qp) with the property that
τ2 = dK

sK
τ1sK

τ1,τ2sK

τ1τ2,

sK
1 = 1.

p is obtained from GK

Since GK
p → Gal(Qp/Qp),
which we also denote by sK.7 By Hilbert 90, any such section sK is uniquely determined up to
conjugation by an element of K ×.

p,K by inﬂation, this gives rise to a section to GK

p of the Ln/Qp-Galois gerb GLn
p,Ln

3.2.2 Dieudonn´e gerb We also need an unramiﬁed version of the Galois gerbs GK
p,K, Gp.
Let Qur
p be the maximal unramiﬁed extension of Qp in Qp. For n ∈ N, we denote by Dn = DLn
the inﬂation to Qur
. As before, for every pair m|n, there exists a
homomorphism Dn → Dm which, on the kernel, is given by z 7→ zn/m (cf. [Rei97], Remark B1.2).
By passing to the inverse limit, we get a pro-Qur
p /Qp-Galois gerb D over Qp with kernel D. We call
D the Dieudonn´e gerb. Obviously, the Galois gerb GLn
(resp. the pro-Galois gerb Gp) is (equivalent
p
to) the inﬂation to Qp of Dn (resp. D). Again, a choice of a section to GLn
p,Ln → Gal(Ln/Qp) made
above gives us a section to Dn → Gal(Qur

p /Qp) which is again denoted by sLn.

3.2.3 Unramiﬁed morphisms For any (connected) reductive group H over Qp, there exists
a canonical map

(Gp, GH ) → B(H),
where B(H) is the set of σ-conjugacy classes of elements in H(L).

clsH : HomQp/Qp

τ1sK

τ1τ2 and sK

p,K as well as a section sK to the projection GK
τ1,τ2sK

Let K ⊂ Qp be a ﬁnite Galois extension. Recall that we ﬁxed a normalized cocycle (dK

τ1,τ2) ∈
Z 2(Gal(K/Qp), K ×) deﬁning GK
p,K → Gal(K/Qp)
with the property that sK
τ2 = dK
1 = 1; one uses the same notations for the induced
cocycle deﬁning GK
p . A morphism θ : GK
p and the induced section Gal(Qp/Qp) → GK
p → GH is said
to be unramiﬁed (with respect to the chosen section sK) if θ(sK
τ ) = 1 ⋊ τ for all τ ∈ Gal(Qp/Qur
p ).
Note that if K is unramiﬁed and θ∆ : Gm,Qp → HQp
p , this deﬁnition does not
depend on the choice of the section sK. A morphism θ : Gp → GH is then said to be unramiﬁed if θ
factors through GK
p → GH
is unramiﬁed in the just deﬁned sense.
p /Qp-Galois

For a connected reductive group H over Qp, we introduce the associated neutral Qur

p for some ﬁnite Galois extension K of Qp such that the induced map GK

is deﬁned over Qur

gerb by

Gur

H := H(Qur

p ) ⋊ Gal(Qur

p /Qp).

Lemma 3.2.4. (1) For any morphism θur : D → Gur
Gp → GH to Qp is an unramiﬁed morphism.
of Qur

(2) For every morphism θ : Gp → GH of Qp/Qp-Galois gerbs, there is a morphism θur : D → Gur
H
p /Qp-Galois gerbs whose inﬂation to Qp is conjugate to θ. More precisely, if θ factors through

p /Qp-Galois gerbs, its inﬂation θur :

H of Qur

7At the moment, we do not require that one can choose the sections τ 7→ sK
⊂ Qp, which will be however the case (cf. the proof of Theorem 3.2.10).

K ⊂ K ′

τ in a compatible way for extensions

17

is obtained from Qur

H with n = [K : Qp] whose

GK
p for a ﬁnite extension K of Qp, there is a morphism θur : Dn → Gur
inﬂation to Qp is conjugate to θ.
(3) A morphism θur in (2) is determined uniquely up to conjugation by an element of H(Qur
p ).
(4) For every unramiﬁed morphism θ : Gp → GH of Qp/Qp-Galois gerbs, if b ∈ H(Qp) is
p ) and b

deﬁned by θ(seσ) = b ⋊eσ for an element eσ ∈ Gal(Qp/Qp) lifting σ, we have that b ∈ H(Qur
does not depend on the choice of eσ.

Proof. (1) Suppose that θur factors through Dn so that θur factors through GLn
p . The Qp/Qp-
Galois gerb GLn
p /Qp-Galois gerb Dn by pull-back along π : Gal(Qp/Qp) ։
p
Gal(Qur
p ) ֒→ Gm(Qp). To show that θur is unramiﬁed,
we may consider the morphism π∗θur : π∗Dn → π∗Gur
H obtained by pull-back only, as the section
to GLn
p /Qp) lands in (the
p
image in the push-out of) the pull-back π∗Dn. But, the pull-back π∗Dn is also obtained as the
pull-back of the Ln/Qp-Galois gerb GLn
along the surjection Gal(Qp/Qp) ։ Gal(Ln/Qp), followed
p,Ln
by push-out along Gm(Ln) ֒→ Gm(Qur
is induced
from a section Gal(Ln/Qp) → GLn
τ = 1 for all τ ∈ Gal(Qp/Ln). This proves
the claim, since by deﬁnition π∗Dn ⊂ Dn × Gal(Qp/Qp) and the pull-back π∗θur is deﬁned on the
second factor Gal(Qp/Qp) as the identity.
(2) This is Lemma 2.1 of [LR87] (cf. ﬁrst paragraph on p.167 of loc.cit). The second assertion

p ). Then, as the section sLn : Gal(Qp/Qp) → GLn
, we have that sLn

։ Gal(Qp/Qp) induced, via inﬂation, from a section to Dn ։ Gal(Qur

p /Qp), followed by push-out along Gm(Qur

p,Ln

p

is shown in the proof of loc.cit.

(3) In general, for any two unramiﬁed morphisms θ, θ′ : Gp → GH , if θ′ = Int(gp) ◦ θ for some

gp ∈ H(Qp), then it must be that gp ∈ H(Qur
τ )g−1

τ ) = gpθ(sK

1 ⋊ τ = θ′(sK

p ), since for every τ ∈ Gal(Qp/Qur
p ),
p = gp(1 ⋊ τ )g−1
p ) ⋊ τ.

p = gpτ (g−1

H be a morphism of Qur

(4) Let θur : D → Gur

Here, K ⊂ Qp is some ﬁnite Galois extension of Qp for which both θ and θ′ factor through GK
p .
p /Qp-Galois gerbs whose inﬂation to Qp is conjugate
to θ. By the proof of (3), we have that θ = gpθurg−1
p ). So, if θur factors through
DLn for n ∈ N, θ(sLn
p ). Here, sLn denotes both the
section to DLn → Gal(Qur
p → Gal(Qp/Qp). The
second equality is easily seen to follow from the deﬁnition of the inﬂation θur of a morphism θur. If
p, θur′) is another pair with θ = g′
(g′

p /Qp) chosen before and the induced section to GLn

for some gp ∈ H(Qur
σ )g−1

eσ ) = gpθur(sLn

p)−1, then we have that

p ∈ H(Qur

p = gpθur(sLn

eσ )g−1

pθur′(g′

p

gpθur(sLn

σ )g−1

p = θ(sLn

eσ ) = g′

pθur′(sLn

σ )(g′

p)−1,

so θ(sLn

σ )g−1
p

eσ ) = gpθur(sLn

is independent of the choice ofeσ as well as that of the pair (gp, θur).

Remark 3.2.5. (1) For a morphism θ : Gp → GH of Qp/Qp-Galois gerbs, if one chooses a morphism
θur as in (2) and θur(sσ) = b ⋊ σ for b ∈ H(Qur
p ), then by (3) the σ-conjugacy class of b in H(L) is
uniquely determined by θ. Also, any other choice s′
σ of the preimage sσ gives the same σ-conjugacy
σ = usσσ(u−1) for some u ∈ O×
class, since s′

L (cf. [LR87], second paragraph on p.167).

(2) Suppose that θ is itself unramiﬁed, and let b1 ∈ H(Qur

some lift eσ ∈ Gal(Qp/Qp) of σ. Also, let b ∈ H(Qur

θur : D → Gur
classes of b and b1 are equal.

p ) be deﬁned as in (1) for some choice of
p /Qp-Galois gerb morphism). Then (again by Lemma 3.2.4, (3)) the σ-conjugacy

p ) be deﬁned by θ(seσ) = b1 ⋊eσ for

H (Qur

18

sσ ∈ D whose image sn
otherwise is 1),8 and one can check that indeed this element maps to σ under D → Gal(Qur

(3) In [Rei97, Remark B.12], Reimann uses some speciﬁc sσ ∈ D, namely there exists a unique
p ) ⊂ Dn (i.e. equals p−1 if n = 1, or
p /Qp).
Now, the map clsH in question is θ 7→ b(θ) ∈ B(H). Note that this map cls gives the same

σ in Dn, for every n, is p−[1/n] ∈ Gm(Qur

element in B(H) for all morphisms Gp → GH lying in a single equivalence class.
Lemma 3.2.6. Let H be a connected reductive group over Qp and θ : D → Gur
p /Qp-Galois gerbs. Let b ∈ H(Qur
Qur
that θ factors through DLn. Then, the Newton homomorphism νb attached to b ∈ H(Qur
sense of [Kot85], §4.3) is equal to the quasi-cocharcter

p ) be deﬁned by θ(seσ) = b ⋊eσ as in Lemma 3.2.4, (4). Suppose

H a morphism of

p ) (in the

∈ HomL(D, G),
where θ∆ denotes the restriction of θ to the kernel Gm of DLn.

−

1
n

θ∆

Proof. See Anmerkung on p.197 of [LR87].

3.2.7 The Weil-number protorus and the pseudo-motivic Galois gerb In [LR87],
Langlands and Rapoport work with two kinds of Galois gerbs, the quasi-motivic Galois gerb and
the pseudo-motivic Galois gerb. The latter is the Galois gerb whose associated Tannakian category
is supposed to be the Tannakian category of Grothendieck motives over ¯Fp ([LR87], §4). The
former’s major role in loc.cit.
is for formulation of the conjecture for the most general Shimura
varieties (beyond those with simply-connected derived groups). Here, we will work mainly with the
pseudo-motivic Galois gerb. According to [Rei97, Lemma B3.9], this is harmless, at least when the
Serre condition for (G, X) holds (i.e. Z(G) splits over a CM ﬁeld and the weight homomorphism
wX is deﬁned over Q), e.g. if the Shimura datum is of Hodge-type.

Since this hypothesis (†) will be eﬀective largely in most of the statements and our use of the
quasi-motivic Galois gerb will be limited to formulation of some deﬁnitions, here we discuss the
pseudo-motivc Galois gerb in detail and postpone the discussion of the quasi-motivic Galois gerb
to the appendix.

The pseudo-motivic Galois gerb is a Galois gerb over Q, which is also the projective limit of
Galois gerbs P(K, m) over Q, indexed by CM ﬁelds K ⊂ Q Galois over Q and m ∈ N. The kernel
P (K, m) of P(K, m) is a torus over Q whose character group consists of certain Weil numbers.
Here, we give a brief review of their constructions. We begin with P (K, m). As before, we ﬁx
embeddings Q ֒→ Ql, for every place l of Q.
Recall that for a power q of a rational prime p and an integer ν ∈ Z, a Weil q-number of weight
ν = ν(π) is an algebraic number π such that ρ(π)ρ(π) = qν for every embedding ρ : Q(π) ֒→ C.
When K is a ﬁeld containing π, then for every archimedean place v of K, one has

|π|v = | Yσ∈Gal(Kv/Q∞)

σπ|∞ = q

1

2 [Kv:R]ν.

(3.2.7.1)

Here, |x + √−1y|v = x2 + y2 if Kv = C, while if Kv = R = Q∞, |x|v is the usual absolute value
|x|∞ on R (hence the ﬁrst equality always holds for any π ∈ K).

8The deﬁnition of this element in [Kis13, (3.3.3)] is wrong: he asserts that the image of sn

σ in G

Qpn
p

is p−1

∈ G

Qpn ∆
p

,

but it must be p−[1/n]

∈ G

Qpn ∆
p

.

19

Deﬁnition 3.2.8. Let K ⊂ Q be a CM-ﬁeld which is ﬁnite, Galois over Q and m ∈ N.
with the following properties.

(1) The group X(K, m) consists of the Weil q = pm-numbers π in K (for some weight ν = ν1(π))

(a) For each prime v of K above p, there is ν2(π, v) ∈ Z with

|π|v = | Yσ∈Gal(Kv/Qp)

σπ|p = qν2(π,v).

(b) At all ﬁnite places outside p, π is a unit.

(2) Let X ∗(K, m) be the quotient of X(K, m) (which is ﬁnitely generated by Dirichlet unit
theorem) by the ﬁnite group of roots of unity contained therein (so that X ∗(K, m) is torsion free).
Let P (K, m) be the Q-torus whose character group X ∗(P (K, m)) is X ∗(K, m).

The point of the condition (a), while the ﬁrst equality is always true (for any π ∈ K), is that

|π|v is an integral power of q (which however may well depend on v). One also has

ν2(π, v) + ν2(π, v) = −[Kv : Qp]ν1(π),

since ππ = qν1 (K being a CM ﬁeld, the complex conjugation · of K lies in the center of Gal(K/Q)).
If necessary, to avoid any misunderstandings, we write χπ for the character of P (K, m) which
corresponds to a Weil number π ∈ X(K, m). Recall that we ﬁxed embeddings Q → Qp, Q → C.
Let K ⊂ Q be a Galois CM-ﬁeld and v1, v2 the thereby determined archimedean and p-adic
places of K, respectively. Then, one can readily see that there exist cocharacters νK
in
X∗(K, m) = X∗(P (K, m)) with following properties:

1 , νK
2

hχπ, νK
hχπ, νK

1 i = ν1(π),
2 i = ν2(π, v2).

(3.2.8.1)

1 and νK

A priori, νK
2 are deﬁned over respectively Kv1 = C and Kv2 ⊂ Qp, but one readily sees
from their deﬁnition that they are deﬁned over respectively Q and Qp. Furthermore, for K ⊂ K ′
and m|m′ (divisible), there exist maps of tori over Q

φK,K ′ : P (K ′, m) → P (K, m), φm,m′ : P (K, m′) → P (K, m)

i) = νi and φK,K ′(ν′

i) = [K ′
v′
i

K,K ′(π) = π and φ∗

m,m′(π) = πm′/m for π ∈ X ∗(K, m), and they satisfy that
induced by φ∗
: Kvi ]νi ([LR87, p.141]). Let P K := lim←−m|m′ P (K, m).
φm,m′(ν′
This protorus over Q is in fact a torus ([LR87], Lemma 3.8), with character group X ∗(P K) =
lim−→ X ∗(K, m) and which splits over K. Let νK
Lemma 3.2.9. (1) For every CM-ﬁeld K ⊂ Q which is Galois over Q, (P K , νK
2 ) is an initial
object in the category of all triples (T, ν∞, νp) where T is a Q-torus which splits over K, and, ν∞
and νp are cocharacters of T deﬁned over Q and Qp, respectively, and such that

2 ) is characterized by a universal property:

1 ,νK

2 be the induced cocharacters of P K .

The triple (P K, νK

1 , νK

1 , νK

where K0 is the totally real subﬁeld of K of index 2.

TrK/K0(νp) + [Kv2 : Qp]ν∞ = 0,

20

(2) There exists a set {δn} with m|n, n suﬃciently large, of distinguished elements in P (K, m)(Q)

such that for every π ∈ X ∗(K, m) = X ∗(P (K, m)),

χπ(δn) = π

n
m ,

( n
m should be divisible by the torsion order of X(K, m)) and that, when K ⊂ K ′ and m|m′ (divisible),

φm,m′(δn) = δn, φK,K ′(δn) = δn.

i

⊗ π∨

1 ,··· , π∨

m | k ∈ Z} is Zariski-dense in P (K, m).

Moreover, the set {δk
Proof. For (1), see [Rei97, B2.3]. For (2), if the subset {π1,··· , πr} ⊂ X(K, m) forms a basis
r } ⊂ X(K, m)∨ = X∗(P (K, m)), we set
of X ∗(K, m) (up to torsions) with dual basis {π∨
δn :=P πn/m
i ∈ Gm(Q) ⊗ X∗(P (K, m)) = P (K, m)(Q), then it clearly satisﬁes the required
properties, cf. [LR87, p.142]. The last property is Lemma 5.5 of [LR87]; it is stated for a diﬀerent
torus Q(K, m), but the proof carries over to P (K, m).
Set P := lim←−K

P K (protorus). It is equipped with two morphisms ν1 := lim←−K

: Gm → P
νK
2 : D → PQp (deﬁned over Qp). Often, ν1 and ν2 are also denoted

(deﬁned over Q), ν2 := lim←−K
by ν∞ and νp, respectively.
Theorem 3.2.10. (1) There exists a Galois gerb P over Q together with morphisms ζv : Gv → P(v)
for all places v of Q such that

νK
1

(i) (P∆, ζ ∆

∞, ζ ∆

p ) = (PQ, (ν1)C, (ν2)Qp

), the identiﬁcations being compatible with the Galois actions

of Gal(Q/Q), Gal(C/R), and Gal(Qp/Qp) respectively;

l

v

l

Ap

f );

f

all v, ζ ′

f ⊗Ap

(2) If (P′, (ζ ′

(ii) the morphisms ζv, for all v 6= ∞, p, are induced by a section of P over Spec(Ap
where Ap

f denotes the image of the map Q ⊗Q Ap
v is isomorphic to α ◦ ζv, and any to α’s arising in this way are isomorphic.

v)) is another such system, there exists an isomorphism α : P → P′ such that, for
is algebraically equivalent

(3) There is a surjective morphism π : Q → P such that, for all l, ζ P

f →Ql6=∞,p Ql.

([Rei97, Def. B1.1]), where Q is the quasi-motivic Galois gerb (cf. Appendix A).

v → PK (v) whose restrictions to the kernels are νK

to π ◦ ζ Q
Proof. (1) and (2): In [LR87, §3], Langlands and Rapoport ﬁrst deﬁne, for each CM Galois ﬁeld
K, a Galois gerb PK with kernel P K which, for every place v of Q, is equipped with morphisms
ζv = ζ Kw
v for v = ∞, p, where w is a place
of K above v. Then, they deﬁne P as the projective limit of PK ’s; this requires choosing a place
of Q above each place v of Q. The construction of PK is a direct consequence of their Satz 2.2,
but that of P is more delicate: for example, for a projective system of algebraic tori {Tn}n∈N over
a ﬁeld F , the natural map H 2
H 2(F, Tn) is not bijective in general (cf. [Mil03,
Prop. 2.8]). A proper treatment of the construction of P can be found in [Mil03], (see also the
proof of Theorem B 2.8 of [Rei97], where Reimann constructs the quasi-motivic Galois gerb Q, but
the whole arguments should carry over to P too, since all the corresponding cohomological facts
v be the image in H 2(Qv, P K ) of the fundamental
remain valid). In more detail, for v = p,∞, let dK
class of the ﬁeld extension Kv/Qv under the map νK
v , where Kv denotes (by abuse of notation) the

cts(F, lim←− Tn) → lim←−n

: GKw

21

completion of K at the place induced by the embedding Q ֒→ Qv (so, K∞ = C). Then, the Galois
gerb PK corresponds to a cohomology class in H 2(Q, P K ) with image

(0, dK

p , dK

∞) ∈ H 2(A{p,∞}, P K ) × H 2(Qp, P K ) × H 2(Q∞, P K ).

The same statement holds for P, too (cf. [Mil03, §4]). The work of Langland and Rapoport [LR87,
§3] and Milne [Mil03, (3.5b)] show that there exists a unique element in H 2(Q, P K) with that
property. Then, by showing that the canonical maps

H 2
cts(Q, P ) → lim←−K

H 2(Q, P K), H 1

cts(Q, P ) → H 1

cts(A, P )

are isomorphisms ([Mil03], Prop. 3.6, Prop. 3.10), Milne concludes the existence of P as required.
The statement (3) is proved in [Rei97], Theorem B 2.8.

Remark 3.2.11. (1) As was remarked in the proof, to construct ζv (for a place v of Q), we need to
choose a place a place w of K for each CM ﬁeld K Galois over Q, in a compatible manner. From
now on, when we talk about the pair (P, (ζv)v), we will understand that such choice was already
made. Clearly, it is enough to ﬁx an embedding Q ֒→ Qv.
of Q, by construction, ζv induces a morphism GKw
pre-chosen place of K above v (cf. [LR87, Satz 2.2]).

(2) As was also pointed out in the proof, for every CM ﬁeld K Galois over Q and each place v
p → PK (v) of Galois Qv-gerbs, where w is the
(3) The proof also establishes the existence of a (constinous) section to the projection P →

Gal(Q/Q). We ﬁx one and denote it by ρ 7→ qρ.
3.3 The morphism ψT,µ and admissible morphisms We consider the Q-pro-torus R :=
ResL/Q(Gm,L) (L running through the set of all Galois extensions of Q inside Q). Its character
lim←−L
group X ∗(R) is naturally identiﬁed with the set of all continuous maps f : Gal(Q/Q) → Z, where
the Galois action is given by ρ(f )(τ ) = f (ρ−1τ ), ∀ρ, τ ∈ Gal(Q/Q).
Lemma 3.3.1. (1) For any Q-torus T and every cocharacter µ of T , there exists a unique homo-
morphism ξ : R → T such that µ = ξ ◦ µ0, where µ0 ∈ X∗(R) is deﬁned by hf, µ0i = f (id) ∈ Z for
f ∈ X ∗(R).
We deﬁne

to be the composite of ψ : Q → GR (cf. Theorem A.0.5) and the morphism GR → GT induced by
ξ : R → T .
(2) ψT,µ factors through P if µ satisﬁes the Serre condition: if K is the ﬁeld of deﬁnition of µ,

ψT,µ : Q → GT

(ρ − 1)(ι + 1)µ = (ι + 1)(ρ − 1)µ = 0,

∀ρ ∈ Gal(K/Q)

(e.g. if T splits over a CM-ﬁeld and the weight µ · ι(µ) of µ is deﬁned over Q). If furthermore K
splits T , ψT,µ factors through PK .

(3) The restriction ψ∆

T,µ : Q∆ = QQ → G∆

T = TQ of ψT,µ to the kernels is deﬁned over Q.

22

Proof. For (1) and (2), see [Rei97], Deﬁnition B 2.10 and Remark B 2.11. The last statement of
(2) follows from the very construction of ψT,µ in Satz 2.2, 2.3 of [LR87] (which is equivalent to that
of Reimann, [Rei97], at least when it factors through P).

For (3), it is enough to show that the morphism ψ : Q → GR is deﬁned over Q. But, this
restriction is the homomorphism ψ∆ in (A.0.3.1) (Theorem A.0.5), from which the claim is obvious.

Let v a place of Q (mainly, one of p,∞), T a torus over Qv, and µ ∈ X∗(T ). Suppose that T

splits over a ﬁnite Galois extension F of Qv. Set

νF := Xτ ∈Gal(F/Qv)

τ µ,

and let

1 → F × → WF/Qv → Gal(F/Qv) → 1
be the Weil group extension of F/Qv (cf. [Tat79]); we ﬁx a section sF
Gal(F/Qv) so that dF

ρτ is a cocycle deﬁning WF/Qv.

ρ,τ := sρρ(sτ )s−1

ρ to the projection WF/Qv →

Deﬁnition 3.3.2. We deﬁne ξF

µ,F : WF/Qv → T (F ) ⋊ Gal(F/Qv) by
ξF
µ,F (z) = νF (z)
ξF
µ,F (sF

(z ∈ F ×),
ρτ µ(dF

ρ,τ ) ⋊ ρ.

ρ ) =

Yτ ∈Gal(F/Qv)

One easily checks that ξF

[LR87, p.134], [Mil92], Lemma 3.30 -
Example 3.32). By obvious pull-back and push-out, one gets a morphism of Galois gerbs over Qv:

µ,F is a homomorphism (cf.

ξF
µ : GF

v → GT ,

(where for v 6= p, we set GF
limit, a morphism of Galois gerbs over Qv:

v to be Gv = Gal(Qv/Qv)) and further, by passing to the projective

ξµ : Gv → GT ,

which does not depend on the choice of a ﬁeld F splitting T . These maps are independent, up to
conjugation by an element of T (Qv), of the choice of section sρ.

Lemma 3.3.3. (1) If v = p and F is unramiﬁed, ξµ is unramiﬁed (in the sense of Subsubsection
3.2.3), and if ξµ(sσ) = bµ ⋊ σ for bµ ∈ T (L), one has bµ = µ(p−1) in B(TQp).
(2) Suppose that T is a torus deﬁned over Q, split over a ﬁnite Galois extension K of Q. For
each v = ∞, p, let ξ±µ be the morphism deﬁned above for (TQv , F = Kw,±µ). Then, ψT,µ(∞) ◦ ζ∞
is conjugate to ξµ, and ψT,µ(p) ◦ ζp is conjugate to ξ−µ. For v 6= ∞, p, ψT,µ(∞) ◦ ζv is conjugate to
the canonical neutralization of GT (v).

Proof. (1) See Lemma 4.3 of [Mil92]. (2) This follows from the construction of ψT,µ and P(K, m),
cf. [LR87], Satz 2.3 and §3 (esp. (3.i)).

23

3.3.4 Shimura data Let (G, X) be a Shimura datum. For a morphism h : S → GR in X, the
associated Hodge cocharacter

µh : GmC → GC

is the composite of hC : SC → GC and the cocharacter of SC ∼= GmC × GmC corresponding to the
identity embedding C ֒→ C. Let {µX} denote the G(C)-conjugacy class of cocharacters of GC
containing µh (for any h ∈ X). For a maximal torus T of GQ, we can consider {µX} as an element
of X∗(T )/W . Alternatively, when we ﬁx a based root datum BR(G, T, B), c(G, X) has a unique
representative in the associated closed Weyl chamber C(T, B), hence will be also identiﬁed with
this representative:

{µX} ∈ C(T, B).

The reﬂex ﬁeld E(G, X) of a Shimura datum (G, X) is the ﬁeld of deﬁnition of c(G, X) ∈ CG(Q), i.e.
the ﬁxed ﬁeld of the stabilizer of c(G, X) in Gal(Q/Q); so a reﬂex ﬁeld, which is a ﬁnite extension
of Q, is always a subﬁeld of C. When T is a torus, the reﬂex ﬁeld E(T,{h}) is just the smallest
subﬁeld of Q ⊂ C over which the single morphism µh is deﬁned.
For each j ∈ N, we denote by Lj the unramiﬁed extension of degree j of Qp in Qp, and by Qur
p
the maximal unramiﬁed extension of Qp in Qp. We let L and σ denote the completion of Qur
p and
the absolute Frobenius on it, respectively.

3.3.5 Strictly monoidal categories G/eG(k), GG/ eG In order to have a satisfactory formal-

ism without the simply-connected derived group condition, Kisin [Kis13, (3.2)] introduced certain
strictly monoidal categories. Recall (cf. [Mil92, App. B]) that a crossed module is a group homo-
morphism α : ˜H → H together with an action of H on ˜H, denoted by h˜h for h ∈ H, ˜h ∈ ˜H, which
lifts the conjugation action on itself (i.e. α(h˜h) = hα(˜h)h−1 for h ∈ H, ˜h ∈ ˜H) and such that
the induced action of ˜H on itself is also the conjugation action (i.e. α(˜g)˜h = ˜g˜h˜g−1 for ˜g, ˜h ∈ ˜H).
A crossed module ˜H → H gives rise to a strictly monoidal category H/ ˜H.
Its underlying cat-
egory is the groupoid whose objects are the elements of H and whose morphisms are given by
Hom(h1, h2) = {˜h ∈ ˜H | h2 = α(˜h)h1}; thus the set of morphisms is identiﬁed with the set ˜H × H.
The monoidal structure ⊗ on this groupoid is given on the objects by the group multiplication on
H and on the set of morphisms ˜H × H by the semi-direct product for the action of H on ˜H:

(˜h1, h1) ⊗ (˜h2, h2) := (˜h1

h1 ˜h2, h1h2).

We may regard any group H as the strictly monoidal category H = H/{1}.
Let k be a ﬁeld with an algebraic closure k, and G a connected reductive group over k. Here,
we will use the notation ˜G for the simply connected cover of Gder (which was denoted previously
by Gsc). Then, the commutator map [ , ] : G × G → G factors through [ , ] : Gad × Gad → G. In
particular, as Gad = ˜Gad, we get a map [ , ] : Gad × Gad → ˜G ([Del77, 2.0.2]). It follows that the
conjugation action of ˜G on itself extends to an action of G, and thus the natural map ˜G → G has a
canonical crossed module structure. We write G/eG(k) for the resulting strictly monoidal category
G(k)/eG(k), and GG/ eG for the strictly monoidal category GG/ ˜G(k).
3.3.6 Admissible morphisms Let (G, X) be a Shimura datum with reﬂex ﬁeld E ⊂ C. We
ﬁx an embedding Q ֒→ Qv for every place v. Suppose given a parahoric subgroup Kp ⊂ G(Qp);
there exists a unique σ-stable parahoric subgroup ˜Kp of G(L) such that Kp = ˜Kp ∩ G(Qp).

24

Fix h ∈ X. Then, there exists a homomorphism of C/R-Galois gerbs

ξ∞ : G∞ → GG(∞)

deﬁned by ξ∞(z) = wh(z) = µh · µh(z), z ∈ C× and ξ∞(w) = µh(−1) ⋊ ι, where w = w(ι). Clearly,
its equivalence class depends only on X.

For v 6= ∞, p, we have the canonical section ξv to GG(v) → Gal(Qv/Qv):

ξv : Gv = Gal(Qv/Qv) → GG(v) : ρ 7→ 1 ⋊ ρ.

For a cocharacter µ of G, we consider the composite of morphisms of strictly monoidal categories

µ ˜ab : Gm(Q)

µ

→ G(Q) → G/ ˜G(Q).

For a cocharacter µ of G, the composite

ψµfab

: Q

i◦ψµ→ GG → GG/ ˜G(k).

(of morphisms of strictly monoidal categories) depends only on the G(Q) conjugacy class of µ; One
easily veriﬁes that this is equal to the morphism denoted by the same symbol in [Kis13, (3.3.1)].
Deﬁnition 3.3.7. [LR87, p.166-168] A morphism φ : Q → GG is called admissible if
(1) The composite

is conjugate to the composite Ψµfab

φfab : Q
: Q

φ

→ GG → GG/ ˜G(k)
i◦ψµ→ GG → GG/ ˜G(k).

(2) For every place v 6= p (including ∞), the composite φ ◦ ζv is conjugate to ξv (by an element

of G(Ql)).

(3) For some (equiv. any) b ∈ G(L) in the σ-conjugacy class cls(φ ◦ ζp) ∈ B(G) (3.2.3), the
following set (which is a union of aﬃne Deligne-Lusztig varieties) X({µX}, b)Kp is non-empty:

X({µX}, b)Kp := {g ∈ G(L)/ ˜Kp | inv ˜Kp
({µX}) is the {µX}-admissible subset (Def. 2.2.4) deﬁned for the parahoric

(g, bσ(g)) ∈ Adm ˜Kp

({µX})}.

Here, Adm ˜Kp
subgroup ˜Kp ⊂ G(L) attached to Kp, and

inv ˜Kp

: G(L)/ ˜Kp × G(L)/ ˜Kp → ˜Kp\G(L)/ ˜Kp ∼= ˜W ˜Kp\ ˜W / ˜W ˜Kp

is deﬁned by (g1 ˜Kp, g2 ˜Kp) 7→ ˜Kpg−1
Suppose that an admissible morphism φ : Q → GG factors through the pseudo-motivic Galois
gerb P. As G is an algebraic group, it further factors through P(K, m) for some CM ﬁeld K Galois
over Q and m ∈ N.

1 g2 ˜Kp, cf. (2.2.2.2).

25

Remark 3.3.8. This deﬁnition of admissible morphism is slightly diﬀerent from the original deﬁnition
by Langlands-Rapoport [LR87, p.166]. Instead of the condition (1) here, which was introduced by
Kisin [Kis13, (3.3.6)], they require the equality pr ◦ φ = pr ◦ i ◦ ψT,µ, where pr : GG → GGab is the
natural map; so, these conditions are identical if Gder is simply connected. This original condition
however turns out to be adequate only in their set-up, i.e. when Gder is simply connected. For
example, Satz 5.3 of [LR87] shows that for such G, every admissible morphism (in the original
sense) is conjugate to a special admissible morphism (in the sense of Lemma 3.3.10 below). But,
they also show ([LR87], §6, the ﬁrst example) that this fact is not true in general with the simply
connected condition, cf. [Mil92], Remark 4.20. In contrast, with the new condition, it turns out to
always hold (as shown by Kisin in the hyperspecial level case, and by Thm. 4.1.3 below for general
parahoric levels when GQp is quasi-split).

The following lemma was proved by Langlands-Rapoport for unramiﬁed T (cf. [Mil92, 4.3]).

Lemma 3.3.9. Let T be a torus over Qp, split by a ﬁnite Galois extension K of Qp, say of degree
n, and µ ∈ X∗(T ). Let K1 be the composite in Qp of K and Ln (the unramiﬁed extension of Qp in
Qp of degree n = [K : Qp]). Then, ξK1
p → GT be the resulting
µ
morphism. When ξ′

p is an unramiﬁed conjugate of ξLn
µ ,

factors through GLn

p : let ξLn

µ : GLn

ξ′
p(sLn

ρ ) = NmK/K0(µ(π−1)) ⋊ ρ,

up to conjugation by an element of T (Qur
p ). Here, K0 = K ∩ Ln ⊂ K is the maximal unramiﬁed
subextension of Qp, π is a uniformizer of K, and ρ is any element in Gal(Qp/Qp) whose restriction
to Ln is the Frobenius automorphism σ. Moreover, we have the equality in X∗(T )Γ(p):

κT (NmK/K0(µ(π−1))) = −µ,

where µ is the image of µ ∈ X∗(T ) in X∗(T )Γ(p) (Γ(p) = Gal(Qp/Qp)).
Proof. Let dLn
ρ,τ denote the canonical fundamental 2-cocycle deﬁned in (3.2.1.1) which represents the
fundamental class uLn/Qp = [1/n] ∈ H 2(Ln/Qp) ∼= 1
n Z/Z. Also, for F = K1 and Ln, ﬁx a section
ρ : Gal(F/Qp) → WF/Qp to 1 → F × → WF/Qp → Gal(F/Qp) → 1 which induces a 2-cocycle on
sF
Gal(F/Qp)

dF
ρ,τ := sF

ρτ )−1 ∈ F ×
representing the fundamental class uF/Qp ∈ H 2(F/Qp) ∼= 1
[F :Qp] Z/Z (for F = Ln, the induced
2-cocycle is required to be the canonical one). Thus there exists a function b : Gal(K1/Qp) → K ×
1
such that
(3.3.9.1)

ρ ρ(sF

τ )(sF

,

ρ,τ )[K1:Ln] · ∂(b)ρ,τ = dLn
(dK1

ρ|Ln ,τ |Ln

where ∂(b)ρ,τ := bρρ(bτ )b−1
deﬁned by

ρτ . In terms of these generators, the natural map pLn,K1 : GK1

Qp → GLn

Qp

is

Then, the morphisms ξK1
element of T (Qp).

µ , ξLn

z 7→ z[K1:K] (z ∈ Q×
p ),
µ ◦ pLn,K1 : GK1

sK1
ρ

7→ b−1

ρ sLn
ρ .

Qp → GT diﬀer from each other by conjugation with an

26

Recall that for (T, µ, K1), ξK1

µ : Gp → GT is induced, via obvious pull-back and push-out, from

a map ξK1

µ,K1

: WK1/Qp → T (K1) ⋊ Gal(K1/Qp): for a ∈ K ×
7→ νK1(a) · cK1
ρ = Qτ1∈Gal(K1/Qp)(ρτ1µ)(dK1

1 and ρ ∈ Gal(K1/Qp),
ρ ⋊ ρ,

where νK1 = NmK1/Qpµ ∈ HomQp(Gm, T ) and cK1
x ∈ T (Qp), if we deﬁne ψ′

: a · sK1

ξK1
µ,K1

ρ

ρ,τ1 ). Now, for any

x : GLn
z 7→ νK(z),

p → GT by
sLn
ρ

ρ

· x · ρ(x−1),
7→ νK(bρ) · cK1
x ◦ πK1,Ln = Int(x) ◦ ξK1

x = Intx ◦ ψ′

1, the second statement will follow if there exists x ∈ T (Qp) such that ψ′

where νK = NmK/Qpµ, then it is clear that ψ′
µ . This proves the ﬁrst claim.
x(sLn
Since ψ′
ρ )
equals NmK/K0(µ(π−1)) whenever ρ|Ln = σ. This means that the two elements νK(bρ) · cK1
ρ ,
∼→ X∗(T )Gal(Qp/K), where L′
NmK/K0(µ(π−1)) of T (L′) have the same image under κTK : B(TK)
is the completion of the maximal unramiﬁed extension of K in Qp and B(TK ) is the set of σ-
conjugacy classes in T (L′) (with respect to the Frobenius automorphism of L′/K). But, as κTK is
induced from wTL′ : T (L′) → X∗(T )Gal(L′/L′) = X∗(T ) (Subsec. 2.1.1), in turn it suﬃces to show
the equality of the images under wTL′ of cK1
ρ

· νK(bρ) and NmK/K0(µ(π−1)) when ρ|Qur

p = σ.

Choose a set of representatives Γ1 ⊂ Gal(K1/Qp) for the family of left cosets Gal(K1/Qp)/Gal(K1/Ln)

∼→ Gal(Ln/Qp)) and ρ ∈ Gal(K1/Qp) such that

(so that restriction to Ln gives a bijection Γ1
ρ|Ln = σ. Then, we get

Yτ1∈Gal(K1/Qp)

(ρτ1µ)(Inf K1
Ln

(ρτ γµ)(Inf K1
Ln

(dLn/Qp)ρ,τ γ)

(dLn/Qp)ρ,τ1) = Yτ ∈Γ1 Yγ∈Gal(K1/Ln)
= ρ Yτ ∈Gal(Ln/Qp)
= Y0≤i≤n−1

(τ (NmK1/Lnµ))(dLn

ρ|Ln ,τ )

(σi+1(NmK1/Lnµ))(dLn

σ,σi )

= (NmK1/Lnµ)(p−1) = (NmK/K0µ)(p−1).

both sides of (3.3.9.1), we obtain

Here, the last equality NmK1/Lnµ = NmK/K0µ (in X∗(T )) holds since µ is deﬁned over K and

restriction to K is a bijection Gal(K1/Ln) ∼→ Gal(K/K0). Then, by takingQτ ∈Gal(K1/Qp)(ρτ µ) on
· νK(bρ))[K1:K] · ρ(f )f −1 = (NmK/K0µ)(p−1),
where f =Qτ ∈Gal(K1/Qp) τ µ(eτ ). Now applying wTL′ to both sides, we get
· νK(bρ)) = wTL′ ((NmK/K0µ)(p−1))

[K1 : K]wTL′ (cK1

(cK1
ρ

ρ

(∗)
= [K : K0]wTL′ (NmK/K0(µ(π−1))).

Due to the property [Kot97, (7.3.2)] of the map w, the equality (∗) is deduced from the following
stronger formula (comparing the images under wTL, instead of wTL′ ):

wTL(NmK/K0(µ)(p)) = [K : K0]wTL(NmK/K0(µ(π))).

(3.3.9.2)

27

Here, NmK/K0(µ) ∈ X∗(T )Gal(K/K0) so NmK/K0(µ)(p) ∈ Im(K ×
0 → T (K0)), while NmK/K0(µ(π))
is the image of µ(π) ∈ T (K) under the norm map T (K) → T (K0). To show this formula, by
functoriality for tori T endowed with a cocharacter µ, it is enough to prove this formula in the
universal case T = ResK/QpGm and µ = µK, the cocharacter of TK = (Gm)⊕Hom(K,K) corresponding
to the identity embedding K ֒→ K. Note that in this case wTL = vTL as X∗(T ) is an induced
Gal(K/Qp)-module (Subsec. 2.1.1). For any extension E ⊃ K, Galois over Qp, there exists a
canonical isomorphism TE ∼= (Gm,E)⊕Hom(K,E) (product of copies of Gm,E, indexed by Hom(K, E))
such that τ ∈ Gal(E/Qp) acts on T (E) = (E×)⊕Hom(K,E) by τ (xρ)ρ∈Hom(K,E) = (τ (xρ))τ ◦ρ. Then,
µK = (fρ)ρ ∈Qρ∈Hom(K,K) X∗(Gm), where fρ = 1 ∈ X∗(Gm) = Z if ρ is the inclusion K ֒→ E, and
fρ = 0 otherwise. So, NmK/K0(µK) is (fρ)ρ ∈Qρ X∗(Gm), where fρ = 1 if ρ|K0 is the inclusion

K0 ֒→ K, and fρ = 0 otherwise, and similarly NmK/K0(µK (π)) = (xρ)ρ, where xρ = ρ(π) if
ρ|K0 = (K0 ֒→ K), and xρ = 1 otherwise. It follows that the element of T (K0)

NmK/K0(µK)(p) · NmK/K0(µK (π))−[K:K0],

lies in the maximal compact subgroup of T (K0), which is nothing but Ker(vTL) ∩ T (K0). This
proves the equation (3.3.9.2).
Finally, the equality κT (NmK/K0(µ(π−1))) = −µ = in X∗(T )Γ(p) is proved in [Kot85, 2.5] (be
careful that here we are considering κT , not κTK ). Or, as in the proof of the equation (3.3.9.2)
above, we reduce the proof to the universal case (T, µ) = (ResK/QpGm, µK ), in which case the claim
becomes a consequence of (3.3.9.2). This completes the proof.

Lemma 3.3.10. Suppose that GQp is quasi-split and Kp is a special maximal parahoric subgroup.
Then, for any special Shimura datum (T, h : S → TR) satisfying the Serre condition (e.g.
if T
splits over a CM ﬁeld and the weight homomorphism µh · ι(µh) is deﬁned over Q), the morphism
i ◦ ψT,µh : P → GT ֒→ GG (Lemma 3.3.1) is admissible, where i : GT → GG is the canonical
morphism deﬁned by the inclusion i : T ֒→ G.

Such admissible morphism i ◦ ψT,µh will be said to be special; in our use of this notation, i
will be often spared its explanation (or sometimes will be even omitted). This fact was proved in
[LR87, Lemma 5.2] for hyperspecial level subgroups.

Proof. The only nontrivial condition in Def. 3.3.7 is (3). Let L be a ﬁnite Galois extension of Q
splitting T and v2 the place of L induced by the chosen embedding Q ֒→ Qp. Put

νp := (ξ

Lv2

−µh)∆ = − Xσ∈Gal(Lv2 /Qp)

σµh

(∈ HomQp(Gm, TQp)),

and let J be the centralizer in GQp of the image of νp. Then, J is a Qp-Levi subgroup of GQp
which is also quasi-split as GQp is so (Lemma 4.2.3, (1)). Hence, according to Lemma 4.2.3, there
exists g ∈ G(Qp) such that gJ(L)g−1 ∩ ˜Kp is a special maximal parahoric subgroup of gJ(L)g−1,
where ˜Kp ⊂ G(L) is the special maximal parahoric subgroup associated with Kp:
it is enough
that for a maximal split Qp-torus S of GQp contained in J, the apartment A(Intg(S), Qp) contains
a special point in B(G, Qp) giving Kp. Set J ′ := Intg(J). Then, by Prop. B.0.6 (cf. Remark
B.0.7), there exists an elliptic maximal Qp-torus T ′ of J ′ such that T ′
is the
p -split Qur
centralizer of) a maximal Qur
and that the (unique) parahoric
of T ′(L) is contained in J ′(L) ∩ ˜Kp. Let µ′ be the cocharacter of T ′
subgroup T ′(L)1 = Ker wT ′

p -torus, say S′

contains (equiv.

Qur
p

1, of J ′

Qur
p

L

28

that is conjugate to Intg(µh) under J ′(Qp) and such that it lies in the closed Weyl chamber of
X∗(T ′) associated with a Borel subgroup of GL (deﬁned over L) containing T ′
L.

Then, Intg ◦ ξ−µh = ξ−Intg(µh) and ξ−µ′ are equivalent as homomorphisms from Gp to GJ ′. This
can be proved by the original argument in [LR87, Lemma 5.2], but one can also resort to Lemma
4.2.9 below as follows. First, we observe that when we take L to be large enough so that Lv2 splits
T ′ as well, the following two cocharacters Intg(νp) ∈ X∗(Intg(TQp)), ν′

p ∈ X∗(T ′) are equal:

σ(gµhg−1)

=

σµ′.

(3.3.10.1)

Intg(νp) := − Xσ∈Gal(Lv2 /Qp)

ν′

p := − Xσ∈Gal(Lv2 /Qp)

Indeed, they both map into the center of Intg(J): this is clear for Intg(νp) as J = Cent(νp), while
ν′
p maps into a split Qp-subtorus of T ′, so into Z(J ′) (as T ′ is elliptic in J ′). So, their equality
can be checked after composing them with the natural projection J ′ → J ′ab = J ′/J ′der, but this
is obvious since Intg(µh) is conjugate to µ′ under J ′(Qp). Next, we conclude by applying Lemma
4.2.9 to the two morphisms Int(vg) ◦ ξ−µh, ξ−µ′, where v ∈ J ′(Qp) satisﬁes Int(vg)(TQp ) = T ′.
we have that for invT ′(L)1 : T ′(L)/T ′(L)1 × T ′(L)/T ′(L)1 → T ′(L)/T ′(L)1 ∼= X∗(T ′)Gal(Qp/Qur
p ),

But, Lemma 3.3.9 tells us that for an unramiﬁed conjugate ξ′

p of ξ−µ′ : Gp → GT ′ under T ′(Qp),

invT ′(L)1 (1, ξ′

p(sρ)) = µ′,

where ρ ∈ Gal(Qp/Qp) is a lift of the Frobenius automorphism σ. Because T ′(L)1 ⊂ ˜Kp, it
in ˜WKp\ ˜W / ˜WKp ∼=
follows that inv ˜Kp
X∗(T ′)Gal(Qp/Qur

p(sρ)x0) (x0 := 1 · ˜Kp) is equal to the image of tµ′

p )/ ˜WKp. It remains to show that ˜WKptµ′ ˜WKp ∈ Adm ˜Kp

({µX}).

(x0, ξ′

p ) ⋊ ˜W ˜Kp

L contains a maximal split L-torus (S′

For that, let ˜W = N (L)/T ′(L)1 denote the extended aﬃne Weyl group, where N is the normal-
1)L). By our choice of T ′ (and as Kp
izer of T ′ (note that T ′
, where ˜Kp is the special maximal
is special), ˜W is a semi-direct product X∗(T ′)Gal(Qp/Qur
parahoric subgroup of G(L) corresponding to Kp and ˜W ˜Kp
= (N (L) ∩ Kp)/T ′(L)1 (which maps
isomorphically onto the relative Weyl group W0 = N (L)/T ′(L)). To ﬁx a Bruhat order on ˜W , we
choose a σ-stable alcove a in the apartment A(S′
1, L) containing a special point, say 0, correspond-
ing to Kp. The choice of a and 0 give the semi-direct product decomposition ˜W = Wa ⋊ Ωa, where
Wa is the (extended) aﬃne Weyl group of (Gsc, T ′sc) and Ωa ⊂ ˜W is the normalizer of a, and a
reduced root system 0Σ such that Wa is the aﬃne Weyl group Q∨(0Σ)⋊W (0Σ), (cf. Subsec. 2.2.2).
Also, the choice of a ﬁxes a set of simple aﬃne roots for Wa, in particular a set 0∆ of simple roots
for 0Σ, whose corresponding coroots {α∨ | α ∈ 0∆} form a basis of Q∨(0Σ) ∼= X∗(T ′sc)Gal(Qp/Qur
p ).
Then there exists a set ∆ ⊂ X ∗(T ′) of simple roots for the root datum of (G, T ′) with the prop-
erty that every α ∈ 0∆ is the restriction of some ˜α ∈ ∆. Let C a ⊂ X∗(S′
1)R and C ⊂ X∗(T ′)R
be the associated closed Weyl chambers. It follows that π(C) ⊂ C a, where π is the natural sur-
jection X∗(T ′)R → (X∗(T ′)Gal(Qp/Qur
1)R. Now, let µ0 ∈ X∗(T ′) be the conjugate of
p ))R = X∗(S′
µh lying in C (so its image µ0 in (X∗(T ′)Gal(Qp/Qur
p ))R lies in C a). Then, it suﬃces to show that
tµ′
≤ tµ0 in ˜W . But, as µ′ = wµ0 for some w ∈ N (Qp)/T ′(Qp) and µ0 ∈ C, we have that
µ0 − µ′ = P ˜α∈∆ n ˜α ˜α∨ ∈ X∗(T ′sc) with n ˜α ∈ Z≥0 (cf.
[RR96, 2.2]). Since for each ˜α ∈ ∆
a := {Pβ∈0∆ cββ∨ | cβ ∈ R≥0}, as
π(˜α∨) ∈ R≥0α∨ for some α ∈ 0∆, tµ0 − tµ′

= π(µ0) − π(µ′) ∈ C ∨

wanted.

29

3.4 The Langlands-Rapoport conjeture In this subsection, we give a formulation of the
Langlands-Rapoport conjecture for parahoric levels, following Kisin [Kis13, (3.3)] and Rapoport
[Rap05, §9].

For v 6= p,∞, set Xv(φ) := {gv ∈ G(Qv) | φ(v) ◦ ζv = Int(gv) ◦ ξv}, and

X p(φ) := Yv6=∞,p

′

Xv(φ),

where ′ denotes the restricted product of Xv(φ)’s as deﬁned in the line 15-26 on p.168 of [LR87].
By condition (2) of Def. 3.3.7, X p(φ) is non-empty (cf. [Rei97, B 3.6]), and is a right torsor under
G(Ap

f ).
p ) for the parahoric group scheme Go
To deﬁne the component at p, put Kp(Qur
p attached to Kp (Subsec. 2.2.1) and for b ∈ G(L), let ˜Kp· b· ˜Kp denote the invariant inv ˜Kp
Zur
We also recall that for θur
g
inﬂation to Qp, and sσ ∈ D is the lift of σ ∈ Gal(Qur
Xp(φ) := {gKp(Qur

p /Qp) chosen in (3.2.3). Then, we set
g : D → Gur

f over
(1, b).
g denotes its

p |Qp-Galois gerbs), θur

p ) ∈ G(Qp)/Kp(Qur
p )

(a morphism of Qur

: D → Gur

p ) := Go

f (Zur

s.t.

GQp

GQp

| φ(p) ◦ ζp = Int(g) ◦ θur
˜Kp · bg · ˜Kp ∈ Adm ˜Kp

g

for some θur
({µX}), where θur

There is also the following explicit description for Xp(φ). Choose g0 ∈ G(Qp) with g0Kp(Qur
Xp(φ). Then, using g0 as a reference point, we obtain a bijection

g (sσ) = bg ⋊ σ}.
p ) ∈

where bg0 ⋊ σ = θur
φ(p) ◦ ζp = Int(g−1
and

g0(sσ) for θur
0 h)−1 ◦ θur

Xp(φ)

∼→ X({µX}, bg0)Kp
g0 with φ(p) ◦ ζp = Int(g0) ◦ θur

: hKp(Qur

g0 is unramiﬁed, g := g−1

0 h ˜Kp,

p ) 7→ g−1
g0. Indeed, for h ∈ G(Qp), if Inth−1 ◦
p ) (cf. proof of Lemma 3.2.4, (3)),

(3.4.0.2)

bh ⋊ σ = θur

h (sσ) = Int(g−1) ◦ θur

0 h ∈ G(Qur
g0(sσ) = g−1bg0σ(g) ⋊ σ,

and by deﬁnition, g ˜Kp ∈ X({µX}, bg0)Kp if and only if ˜Kp · g−1bg0σ(g) · ˜Kp ∈ Adm ˜Kp
({µX}). So,
0 h ˜Kp ∈ X({µX}, bg0)Kp. Note that there are natural left (or right)
h ∈ Xp(φ) if and only if g−1
actions of Z(Qp) on Xp(φ) and X({µX}, bg0)Kp compatible with the above bijection: z ∈ Z(Qp)
sends g ∈ X({µX}, bg0)Kp (resp. gKp(Qur
g (sσ) on G(L) (sending g ∈ G(L) to bσ(g))
induces an action on G(L)/ ˜Kp as the facet in B(GL) deﬁning ˜Kp is stable under σ. To see that,
choose a maximal (Qp-)split Qp-torus S, and a maximal Qur
p -split Qp-torus S1 containing S (which
exists [BT84, 5.1.12]). With T , N being the centralizer of S1 and its normalizer as usual, the r-th
Frobenius automorphism

p ) ∈ Xp(φ)) to zg (resp. to zgKp(Qur

The absolute Frobenius automorphism F = θur

p )).

Φ = F r (r = [κ(℘) : Fp]) : g 7→ (bg0 ⋊ σ)r(g) = bg0σ(bg0)··· σr−1(bg0) · σr(g)

({µX}) is stable under the action of σr on ˜W ˜Kp\ ˜W / ˜W ˜Kp

leaves X({µX}, bg0 )Kp stable. Indeed, one easily checks that (Φg)−1 · bg0 · σ(Φg) = σr(g−1bg0σ(g))
since µ is deﬁned over
and that Adm ˜Kp
E℘. Obviously, Φ commutes with the action of Z(Qp). One readily sees that when translated to
an action on Xp(φ), Φ acts by Φ(gKp(Qur
p ); as bgk = k−1bgσ(k) for
k ∈ G(Qur

p ), this does not depend on the choice of a representative g in the coset gKp(Qur

p )) = g · NmLr/Qpbg · Kp(Qur

p ).

30

Let Iφ := Aut(φ); this is an algebraic group over Q such that

Iφ(Q) = {g ∈ G(Q) | Int(g) ◦ φ = φ}.

It naturally acts on X p(φ) from the left and commutes with the (right) action of G(Ap
acts on Xp(φ) via the map (which depends on the choice of g0 ∈ Xp(φ))
g0 )(Qp) = {g ∈ G(L)| Int(g) ◦ θur

Int(g0) : Iφ(Q) → Aut(θur

g0 = θur
g0}

f ). It also

which is given by α 7→ g−1
deﬁne

0 αg0, and clearly this action commutes with Z(Qp) × Φ, too. Finally, we

S(φ) := lim←−Kp

Iφ(Q)\(X p(φ)/Kp) × Xp(φ),

where Kp runs over the compact open subgroups of G(Qp). This set is equipped with an action of
G(Ap
f ) × Z(Qp) and a commuting action of Φ, and as such is determined, up to isomorphism, by
the equivalence class of φ.
Conjecture 3.4.1. Suppose that Kp ⊂ G(Qp) is a parahoric subgroup. Then, there exists an
integral model SKp(G, X) of ShKp(G, X) over OE℘ for which there exists a bijection

SKp(G, X)(¯Fp) ∼→G[φ]

S(φ)

compatible with the actions of Z(Qp) × G(Ap
f ) and Φ, where Φ acts on the left side as the r-th
(geometric) Frobenius. Here, φ runs over a set of representatives for the equivalence classes of
admissible morphisms Q → GG.
Remark 3.4.2. (1) The original conjecture was made under the assumption that Gder is simply
connected (due to the expectation that only special admissible morphisms are to contribute to the
¯Fp-points), cf. Remark 3.3.8.

(2) In [Rap05, Conj. 9.2], Rapoport gave another version of this conjecture, using a diﬀer-
ent deﬁnition of admissible morphisms, where the condition (3) of Def. 3.3.7 is replaced by the
more natural, from the group-theoretical viewpoint, and a priori weaker condition (3’) that the σ-
conjugacy class clsGQp (φ(p)) of bφ lies in B(G,{µX}). Our theorem 4.2.11 together with Theorem
A of [He15] establishes the equivalence of these two versions: before, it was known that (3) ⇒ (3’).

3.5 Kottwitz triples and Kottwitz invariant Our main references for the material cov-
ered here are [LR87, p.182-183], [Kot90, §2], and [Kot92]. Here, we make the assumption that
Gder is simply connected, one of whose consequences (of heavy use here) is that the centralizer of
a semisimple element is connected.

3.5.1 Kottwitz triple A Kottwitz triple is a triple (γ0; γ = (γl)l6=p, δ) of elements satisfying
certain conditions, where

(i) γ0 is a semi-simple element of G(Q) that is elliptic in G(R), deﬁned up to conjugacy in G(Q);
(ii) for l 6= p, γl is a semi-simple element in G(Ql), deﬁned up to conjugacy in G(Ql), which is

conjugate to γ0 in G(Ql);

31

(iii) δ is an element of G(Ln) (for some n), deﬁned up to σ-conjugacy in G(L), such that the norm

Nmnδ of δ is conjugate to γ0 under G(L), where Nmnδ := δ · σ(δ)··· σn−1(δ) ∈ G(Qp).

There are two conditions to be satisﬁed by such triple. To explain the ﬁrst one, put

(centralizer of γ0 in G); as Gder is simply connected, it is a connected group. Then, for every place
v of Q, we now construct an algebraic Qv-group I(v) and an inner twisting

I0 := CentG(γ0)

ψv : (I0)Qv → I(v)Qv

over Qv. First, for each ﬁnite place v 6= p of Q, set I(v) := CentGQv (γv). For any gv ∈ G(Qv) with
gvγ0g−1
v = γv, the restriction of Int(gv) to (I0)Qv gives us an inner twisting ψv : (I0)Qv → I(v),
which is well deﬁned up to inner automorphism of I0. For v = p, we deﬁne an algebraic Qp-group
I(p) by

I(p) := {x ∈ ResLn/Qp(GLn) | x−1δθ(x) = δ},

where θ is the Qp-automorphism of ResLn/Qp(GLn) induced by the restriction of σ to Ln. For more
details we refer to [Kot82], where θ and I(p) are denoted by s (on p. 801) and Isδ (on p. 802),
respectively. Then, Lemma 5.8 of loc. cit. provides an inner twisting ψp : (I0)Qp → (I(p))Qp
, which
is canonical up to inner automorphisms of I0; note that γ0 ∈ G(Qp) lies in the stable conjugacy class
of δ, as γ0 and NmLn/Qp(δ) are conjugate under G(Qp) (cf. loc.cit. §5). Finally, at the inﬁnite place,
we choose an elliptic maximal torus TR of GR containing γ0, as well as h ∈ X∩Hom(S, TR). We twist
I0 using the Cartan involution Int(h(i)) on I0/Z(G), and get an inner twisting ψ∞ : (I0)C → I(∞)C.
Here, I(∞)/Z(G) is anisotropic over R.
Deﬁnition 3.5.2. A triple (γ0; (γl)l6=p, δ) as in (i) - (iii) is called a Kottwitz triple of level n =
m[κ(℘) : Fp] (m ≥ 1) if it satisﬁes the following two conditions (iv), (∗(δ)):
(iv) There exists a triple (I, ψ, (jv)) consisting of a Q-group I, an inner twisting ψ : I0 → I and for
each place v of Q, an isomorphism jv : (I)Qv → I(v) over Qv, unramiﬁed almost everywhere,
such that jv ◦ ψ and ψv diﬀer by an inner automorphism of I0 over Qv.

(∗(δ)) the image of δ under the Kottwitz homomorphism κGQp : B(GQp) → π1(GQp)Γ(p) (2.1.1) is

equal to µ♮ (deﬁned in (2.1.3.1)).

l)l6=p, δ′) as in (3.5.1) with δ, δ′ ∈ G(Ln) for (iii)
Remark 3.5.3. 1) Two triples (γ0; (γl)l6=p, δ), (γ′
are said to be equivalent, if γ0 is stably conjugate to γ′
l in G(Ql) for each
l 6= p,∞, and δ is σ-conjugate to δ′ in G(Ln). Then, for two such equivalent triples, one of them is
a Kottwitz triple of level n if and only if the other one is so.
2) According to [Kot90, p.172], the condition (iv) is satisﬁed if the Kottwitz invariant α(γ0; γ, δ)

0, γl is conjugate to γ′

0; (γ′

(to be recalled below) is trivial.

We will also consider the following condition:

(∗(γ0)) Let H be the centralizer in GQp of the maximal Qp-split torus in the center of CentG(γ0)Qp.
Then, there exist a maximal Q-torus T of CentG(γ0), elliptic over R, and µ ∈ X∗(T ) ∩ {µX},

32

such that NmK/Qpµ maps into the center of CentG(γ0)Qp, where K is a ﬁnite Galois extension
of Qp over which µ ∈ X∗(T ) is deﬁned, and that

λH(γ0) = nµ

for some n ∈ N, where λH : H(Qp) → (π1(H)I /torsions)hσi is the map from Subsec. 2.1.1
(restriction of vHL to H(Qp)) and µ denotes the image of µ in π1(H)I /torsions.

Remark 3.5.4. 1) Note that H is a Qp-Levi subgroup of GQp with the center being the maximal
Qp-split torus in the center of CentG(γ0)Qp (H is the centralizer of its center).
In particular,
the ﬁrst sub-condition in (∗(γ0)) is the same as that NmK/Qpµ maps into the center of H, and
H ab = H/H der is Qp-split. So, as H der is simply-connected by assumption, the canonical action of
Gal(Qp/Qp) on π1(H) is trivial. Sometimes we will refer to the number n appearing in (∗(γ0)) as
the level of that condition (e.g., we will say that the condition (∗(γ0)) holds for γ0 with level n).
2) A similar condition also appears in [LR87, p.183] (in the hyperspecial case), where it is
denoted by (∗(ǫ)). There are two diﬀerences between their condition (∗(ǫ)) and ours (∗(γ0)). In
(∗(ǫ)), there is no requirement that NmK/Qpµ maps into the center of CentG(γ0)Qp, but instead it
demands that µ is deﬁned over the unramiﬁed extension Ln of E℘ of degree m. The main use of
the original condition in [LR87] is Satz 5.21 and the subsequent statements depending on it. This
theorem Satz 5.21 asserts that in order for a rational element γ0 ∈ G(Q) to admit an admissible pair
(φ, ǫ) with ǫ stably conjugated to γ0, it is necessary and suﬃcient that γ0 is elliptic at R and satisﬁes
their condition (∗(ǫ)). To the author’s opinion,9 their condition (∗(ǫ)) is insuﬃcient to prove this
claim. And, later we will prove this claim with our condition (∗(γ0)) (Thm. 5.0.16). But, this is
not the only value of the new condition. In fact, it is a quite natural condition, as it is satisﬁed
by every Kottwitz triple that is expected, by the conjecture of Langlands-Rapoport, to arise from
an ¯Fp-point (Thm. 5.0.16) and is also a crucial condition for an elliptic stable conjugacy class
which is l-adic unit for every l 6= p to fulﬁll, in order for it to contain the relative Frobenius of the
reduction of a CM-point (Thm. 5.2.2). In contrast, in Satz 5.25 of [LR87] (theorem corresponding
to the former statement), it is not made clear whether an eﬀective Kottwitz triple would satisfy
the original condition (∗(ǫ)).

3.5.5 Kottwitz invariant We recall the deﬁnition of the Kottwitz invariant, cf. [Kot90], §2.
Recall out convention for the notations X∗(A), X ∗(A), and AD: for a locally compact abelian group
A, they denote the (co)character groups Hom(C×, A), Hom(A, C×), and the Pontryagin dual group
Hom(A, Q/Z), respectively. Note that the centralizer I0 of γ0 in G is a connected group reductive
since γ0 is semisimple and Gder is simply connected. The exact sequence

induces a homomorphism ([Kot84a, Cor.2.3])

1 → Z(bG) → Z(bI0) → Z(bI0)/Z(bG) → 1
π0((Z(bI0)/Z(bG))Γ) → H 1(Q, Z(bG)),

where Γ := Gal(Q/Q). Let ker1(Q, Z(bG)) denote the kernel of the map H 1(Q, Z(bG)) →Qv H 1(Qv, Z(bG)),
and deﬁne K(I0/Q) to be the subgroup of π0((Z(bI0)/Z(bG))Γ) consisting of elements whose image

9although I will be happy to be pointed out to be wrong.

33

in H 1(Q, Z(bG)) lies in ker1(Q, Z(bG)). This is known to be a ﬁnite group. Also, since γ0 is elliptic,

there is an identiﬁcation

The Kottwitz invariant α(γ0; γ, δ) is then a certain character of K(I0/Q) (i.e.
X ∗(K(I0/Q)) = K(I0/Q)D). It is deﬁned as a product over all places of Q:

an element of

βv(γ0; γ, δ)|∩v Z(bI0)Γ(v)Z( bG),

K(I0/Q) =(cid:16)∩vZ(bI0)Γ(v)Z(bG)(cid:17) /Z(bG).
α(γ0; γ, δ) =Yv
βv|Z( bG) =

v = ∞
v = p
v 6= p,∞.

µ1
−µ1
trivial

if
if
if

Here, for each place v, βv(γ0; γ, δ) is a character on Z(bI0)Γ(v)Z(bG) which is the unique extension of
another character αv(γ0; γ, δ) on Z(bI0)Γ(v) with the restriction to Z(bG) being

Finally, αv(γ0; γ, δ) ∈ X ∗(Z(bI0)Γ(v)) is deﬁned as follows: For a place v 6= p,∞, choose g ∈ G(Qv)
with gγ0g−1 = γv. Then τ 7→ g−1τ (g) is a cocycle of Γ(v) in I0(Qv), and its cohomology class lies in
∼→ π0(Z(bI0)Γ(v))D,
ker[H 1(Qv, I0) → H 1(Qv, G)]. In view of the canonical isomorphism H 1(Qv, H)
this gives the desired character of Z(bI0)Γ(v). For v = p, choose c ∈ G(L) with cγ0c−1 = Nmn(δ),
and set b := c−1δσ(c). Then, one readily sees that b ∈ I0(L) and its σ-conjugacy class in B((I0)Qp)
is well-deﬁned (independent of the choice of c). Then, we deﬁne αp(γ0; γ, δ) be the image of this
class under the canonical map B((I0)Qp) → X ∗(Z(bI0)Γ(p)). For v = ∞, we let α∞(γ0; γ, δ) to be
the image of µh in π1(I0)Γ(∞) ∼= X ∗(Z(bI0)Γ(∞)) for some h ∈ X factoring through a maximal torus
all the choices made. One can check that the productQv βv(γ0; γ, δ) is trivial on Z(bG).

T of G containing γ0 and elliptic over R. Again, the character deﬁned this way is independent of

3.6 Admissible pairs and associated Kottwitz triples Recall that our parahoric sub-
group Kp ⊂ G(Qp) is deﬁned by a σ-stable facet a in the building B(G, L) which also gives rise to
a parahoric subgroup ˜Kp ⊂ G(L) with Kp = ˜Kp ∩ G(Qp). To formulate the deﬁnition of admis-
sible pair for general parahoric subgroups, we need to consider the orbit space G(L)/ ˜Kp endowed
with the obvious action of the semi-direct product G(L) ⋊ hσi, instead of the Bruhat-Tits building
B(G, L) that was used in the hyperspecial level case; note that unless Kp is hyperspecial (in which
case ˜Kp equals the whole stabilizer Stab(0) ⊂ G(L)), G(L)/ ˜Kp is not a subset of B(G, L) in any
natural manner.

Deﬁnition 3.6.1. ([LR87, p.189]) A pair (φ, ǫ) is called admissible (of level n = [κ(℘) : Fp]m) if

(1) φ : Q → GG is admissible in the sense of Def. 3.3.7.
(2) ǫ ∈ Iφ(Q)(= {g ∈ G(Q) | Int(g) ◦ φ = φ}).
(3) There are γ = (γ(v)) ∈ G(Ap

x0 := 1 · ˜Kp such that

f ), y ∈ X p(φ), and x in the G(L)-orbit G(L)/ ˜Kp of the point

ǫy = yγ

and

ǫx = Φmx.

34

Some comments on the condition (3) are in order. Recall (Lemma 3.2.4) that if ξ′

eσ ∈ Gal(Qp/Qp) is a (ﬁxed) lifting of the Frobenius automorphism σ of Qur

G(Qp)) is an unramiﬁed conjugate of ξp = φ(p) ◦ ζp : Gp → GG(p) and ξ′
p and τ 7→ sτ is the
chosen section to the projection Gp → Gal(Qp/Qp), then b and ǫ′ := uǫu−1 ∈ G(Qp) in fact belong to
p(sτ )·ǫ′ = τ (ǫ′)⋊τ
G(Qur
p )). Then, by existence of x in X({µX}, b)Kp satisfying ǫx = Φmx in (3), we
for all τ ∈ Gal(Qp/Qur
mean existence of u ∈ G(Qp) such that Intu ◦ ξp is unramiﬁed, for which there exists x in the orbit
space G(L)/ ˜Kp with

p(seσ) = b ⋊eσ, where

p(sτ ) = 1⋊τ for every τ ∈ Gal(Qp/Qur

p ), one has ǫ′⋊τ = ǫ′·ξ′

p(sτ ) = ξ′

p ) (as ξ′

p = Intu◦ξp (u ∈

ǫ′x = Φmx,

(3.6.1.1)

where Φ = F [κ(℘):Fp] for F = (Intu ◦ ξp)(seσ) = b ⋊eσ. Here, to deﬁne F , instead of ξ′

p /Qp-gerb morphism θur whose inﬂation to Qp is ξ′

use a Galois Qur
3.2.4).

p, we can also
p: it does not change b (Lemma

Remark 3.6.2. (1) Suppose that the anisotropic kernel of Z(G) (maximal anisotropic subtorus of
Z(G)) remains anisotropic over R (then Z(G)(Q) is discrete in Z(G)(Af )); take Kp to be small
enough so that Z(Q) ∩ Kp = {1} and also the condition (1.3.7) of [Kot84b] holds.
Then, the conjecture (3.4.1) provides the following description of the ﬁnite sets SK(G, X)(Fqm ) =
[SK(G, X)(¯Fp)]Φm
for each ﬁnite extension Fqm of Fq = κ(℘), where Φ := F [κ(℘):Fp] is the relative
Frobenius (cf. [Kot84b, 1.3-1.5], [Mil92, §5]): There exists a bijection (forming a compatible family
for varying Kp)

S(φ, ǫ),

(3.6.2.1)

∼→ G(φ,ǫ)
where S(φ, ǫ) = Iφ,ǫ(Q)\Xp(φ, ǫ) × X p(φ, ǫ)/K p with

SK(G, X)(Fqm )

Iφ,ǫ = centralizer of ǫ in Iφ(Q),

X p(φ, ǫ) = {xp ∈ X p(φ) | ǫxp = xp mod Kp},
Xp(φ, ǫ) = {xp ∈ X({µX}, b)Kp | ǫxp = Φmxp}.

(3.6.2.2)

In (3.6.2.1), (φ, ǫ) runs over a set of representatives for the conjugacy classes of pairs consisting of
an admissible morphism φ and ǫ ∈ Iφ(Q)(⊂ G(Q)).
SK(G, X)(Fqm ) if and only if in the condition (3) one can ﬁnd y ∈ X p(φ)(⊂ G( ¯Ap
x ∈ G(L)/ ˜Kp of the equation ǫx = Φmx, further satisfying that

(2) According to this conjecture (3.6.2.1), an admissible pair (φ, ǫ) will contribute to the set
f )) and a solution

y−1ǫy ∈ Kp, and x ∈ X({µX}, b)Kp

(3.6.2.3)

In regarding this, we emphasize that in the condition (3) of the deﬁnition of an admissible
pair, y ∈ X p(φ) and x ∈ G(L)/ ˜Kp are not demanded to satisfy this (seemingly natural) condition
(3.6.2.3); so, Def. 5.8 of [Mil92] is not correct. Indeed, Langlands and Rapoport made this point
explicit: “Es wird ¨ubrigens nicht verlangt, dass x in Xp liegt.” [LR87, p. 189, line +18]. We will
just remark that this deﬁnition of admissible pair plays an auxiliary role in [LR87] but serves well
the intended purpose.

(3) We will call an admissible pair (φ, ǫ) Kp-eﬀective, respectively Kp-eﬀective if there exist
y ∈ X p(φ), respectively x ∈ G(L)/ ˜Kp with ǫx = Φmx, satisfying the conditions (3.6.2.3). Note
that if (φ, ǫ) is Kp-eﬀective and ǫ ∈ G(Ap
f ) (cf.
proof of Lemma 5.0.15, (2)).

f ), ǫ itself lies in a compact open subgroup of G(Ap

35

Two admissible pairs (φ, ǫ), (φ′, ǫ′) are said to be equivalent (or conjugate) if there exists g ∈

G(Q) such that (φ′, ǫ′) = g(φ, ǫ)g−1.

3.6.3 Now, we explain how with any admissible pair (φ, ǫ), one can associate a Kottwitz triple
(γ0; (γl)l6=p, δ), cf. [LR87], p189. Thus, again we assume that Gder is simply connected; see Lemma
5.13 in [LR87] and the remarks preceding it where this assumption is really used.

First, we set γl

f )-conjugacy classes of (γ′

:= γ(l). As when we replace y by yh, h ∈ G(Ap

f ), γ goes over to h−1γh,
f )-conjugacy class of γ is well-determined by the pair (φ, ǫ). Also, one easily sees that if
l)l6=p, (γl)l6=p are

the G(Ap
(φ′, ǫ′) = g(φ, ǫ)g−1 (g ∈ G(Q)), the corresponding G(Ap
the same, since y 7→ gy gives a bijection X p(φ) ∼→ X p(Intg ◦ φ).
Next, to ﬁnd γ0, we use Lemma 4.2.10 below, which is a generalization of Lemma 5.23 of [LR87].
If an admissible pair (φ, ǫ) satisﬁes that φ = i ◦ ψT,µh and ǫ ∈ T (Q) for a special Shimura datum
(T, h), then we will say that it is nested 10 in (T, h). Hence, this lemma says that every admissible
pair is equivalent to an admissible pair that is nested in a special Shimura sub-datum of (G, X), in
particular to an admissible pair (φ, ǫ) such that ǫ ∈ G(Q). Then, we deﬁne γ0 to be any semi-simple
rational element of G which is stably conjugate to ǫ and also lies in a maximal Q-torus T ′ of G
which is elliptic at R, which we now know exists; note that T ′
R is elliptic (since Int(h(i)) deﬁnes a
Cartan involution of Gad
R/ZR as well), hence this γ0 given by Lemma 4.2.10 is also
semi-simple. By deﬁnition, this rational element is well-deﬁned up to stable conjugacy.

R and so of T ′

Finally, to deﬁne δ, choose u ∈ G(Qp) such that Intu ◦ ξp is unramiﬁed and also satisfying

the condition (3) of Def. 3.6.1. Let b ∈ G(L) be deﬁned by Intu ◦ ξp(seσ) = b ⋊eσ, and put
ǫ′ = uǫu−1 ∈ G(L).
Lemma 3.6.4. (1) Let Ψ = b ⋊ σn ∈ G(L) ⋊ hσi such that n 6= 0. Then, Ψ is conjugate under
G(L) to an element of hσi if and only if Ψ ﬁxes some point in the orbit space G(L)/ ˜Kp. .
(2) Let H be a quasi-split group over a p-adic ﬁeld, either a local ﬁeld F or the completion L
of its maximal unramiﬁed extension F ur in F . Then, the map vHL : H(L) → Hom(X∗(Z(bH))I , Z)

(Subsec 2.1.1) vanishes on any special maximal bounded subgroup of H(L) (not just on special
parahoric subgroups).

Proof. (1) This is Lemma 1.4.9 of [Kot84b] when x0 is a hyperspecial point, and its proof continues
to work in our setup: note that the parahoric group scheme over Zur
p attached to x0 has connected
special ﬁber, so the result of Greenberg [Gre63, Prop. 3] still applies.

(2) This is (stated and) proved in Lemma 3.3 of [Kot84a] when H is unramiﬁed and F is a
local ﬁeld, for the map λH (recall that in such case, the Kottwitz’s deﬁnition of λH coincides
with our deﬁnition and that λH is the restriction of vHL to H(F )). But again it is easily seen
to hold in general for any quasi-split H, for the map vHL and any special maximal bounded
subgroup. More explicitly, the relation (3.3.4) in loc. cit. continues to hold for any quasi-split
H over F or L, and one just need to note (in the last step of the original argument) that for any
maximal split L-torus S whose apartment contains a special point x0 ∈ B(G, L) and T = CentH(S),
T (L)0 := T (L) ∩ K (K := Fix(x0)) (the maximal bounded subgroup of T (L)) now equals Ker(vT )
([HR08]).

10This is our translation of the German word eingeschachtelt used by Langlands-Rapoport [LR87, p.190, line19].

36

Lemma 3.6.5. There exists c ∈ G(L) such that δ := cbσ(c−1) lies in G(Ln) and that NmLn/Qpδ
and γ0 are conjugate under G(Qur
Proof. By deﬁnition (cf. 3.6.1.1) and Lemma 3.6.4, there exists c′ ∈ G(L) such that c′(ǫ′−1F n)c′−1 =
σn. If we deﬁne δ ∈ G(L) by

p ).

δ ⋊ σ := c′F c′−1 = c′(b ⋊ σ)c′−1,

i.e. δ = c′bσ(c′−1), then it follows (as shown on p. 291 of [Kot84b]) that δ ∈ G(Ln) and σn =
c′(ǫ′−1F n)c′−1 = c′ǫ′−1c′−1(δ ⋊ σ)n = (c′ǫ′−1c′−1NmLn/Qpδ) ⋊ σn, i.e. NmLn/Qpδ = c′ǫ′c′−1, so that

NmLn/Qpδ = c′ǫ′c′−1 = c′uǫ(c′u)−1 = c′ugγ0(c′ug)−1,

(3.6.5.1)

where ǫ = gγ0g−1 for g ∈ G(Q). Namely, NmLn/Qpδ and γ0 are conjugate under G(Qp). As both
NmLn/Qpδ and γ0 belong to G(Qp), by the Steinberg’s theorem (H 1(Qur
p , G(γ0)) = 0), they are
conjugate under G(Qur

p ).

Choose δ ∈ G(Ln) as in Lemma 3.6.5: its σ-conjugacy class in G(Ln) is uniquely determined
by the given admissible pair (φ, ǫ). We will say that the triple (γ0; (γl)l6=p, δ) corresponds to the
admissible pair (φ, ǫ); then ǫ and γ0 are stably conjugate, among others. Also note that by deﬁ-
nition (cf. (3.2.3)), the σ-conjugacy class cls(φ) ∈ B(GQp) attached to φ(p) (the pull-back of φ to
Gal(Qp/Qp)) is nothing but δ ∈ B(GQp).
Remark 3.6.6. Choose c ∈ G(L) such that NmLn/Qpδ = cγ0c−1. Then as

δ−1cγ0c−1δ = σ(δ)··· σn(δ) = σ(cγ0c−1) = σ(c)γ0σ(c−1),

we see that b′ := c−1δσ(c) commutes with γ0. According to [LR87, Lem. 5.15], the σ-conjugacy of
b′ ∈ G(γ0)(L) is basic in B(G(γ0)), where G(γ0) denotes the centralizer of γ0 in G. In general, this
b′ (whose deﬁnition depends on c ∈ G(L) wtih NmLn/Qpδ = cγ0c−1) is diﬀerent from the b deﬁned
by ξur
p (sσ) = b⋊ σ (which, together with ǫ′, was the input data used to produce δ). But, when (φ, ǫ)
is well-located in a maximal Q-torus T , in the sense that ǫ, φ(δk) ∈ T (Q) and φ factors through
GT ⊂ GG, we can choose c so that b′ = b. Indeed, we can take ǫ for γ0 (as ǫ ∈ G(Q)) and also we
can choose u from T (Qp) (as φ(p) factors through GTQp ) so that ǫ′ = ǫ (as ǫ ∈ T (Q)). Then, we
have NmLn/Qpδ = c′ǫ′c′−1 = c′γ0c′−1 in (3.6.5.1) (note that c′ was determined by ξur
p (sσ) = b ⋊ σ
and ǫ′, cf. proof of Lemma 3.6.5). In other words, we can take c = c′, so b′ = (c′)−1δσ(c′) = b.

It is easy to see that equivalent admissible pairs give rise to equivalent Kottwitz triples. However,
non-equivalent admissible pairs can also give equivalent Kottwitz triples; there is a cohomological
expression for the number of non-equivalent admissible pairs corresponding to a given Kottwitz
triple, cf. Thm. 5.1.1.

We also remark that for a triple (γ0; (γl)l6=p, δ) constructed now from an admissible pair (φ, ǫ),
one can still deﬁne its Kottwitz invariant using the fact that (φ, ǫ) is nested in a torus (T, h), (cf.
proof of Satz 5.25 in [LR87]).

Proposition 3.6.7. The triple (γ0; (γl)l6=p, δ) is a Kottwitz triple of level n = [κ(℘) : Fp]m (Def.
3.5.2) whose Kottwitz invariant vanishes.

37

Proof. First, by construction, γ0 ∈ G(Q) lies in a maximal Q-torus T ′ which is elliptic at R; this
gives the condition (i). The condition (iii) follows from the condition (2) of Def. 3.3.7 (i.e. Xl 6= ∅).
We have already seen that NmLn/Qpδ is conjugate to γ0 under G(Qp). Therefore, the triple satisﬁes
the conditions (i) - (iii) of Def. 3.5.2. That the condition (∗(δ)) holds is a consequence of φ
being admissible (speciﬁcally, the condition (3) of Def. 3.3.7) in view of Theorem A of [He15].
Finally, it remains to verify vanishing of the Kottwitz invariant α(γ0; (γl)l6=p, δ); as observed before
([Kot90, p.172]), this will also establish the condition (iv) (alternatively, we can take Iφ,ǫ for I in
the condition (iv), ([Mil92, Lem6.10])). For this, we can assume that (φ, ǫ) is nested in a special
Shimura subdatum by Lemma 4.2.10. From this point, the original argument works almost word
for word with all the necessary ingredients being established in our situation of parahoric levels.

4 Every admissible morphism is conjugate to a special admissible

morphism

We make some comments on various assumptions called upon in this section. First, we remind
ourselves the running assumption that GQp is quasi-split. In this section the level subgroup can
be arbitrary parahoric subgroup. Also every statement involving the pseudo-motivic Galois gerb
P (instead of the quasi-motivic Galois gerb Q) will (for safety) assume that the Serre condition
holds for the Shimura datum (G, X) (i.e. the center Z(G) splits over a CM ﬁeld and the weight
homomorphism wX is deﬁned over Q). At some places (speciﬁcally, Thm. 4.1.3, (2), Prop. 4.1.5,
and Lemma 4.2.10), we require that Gder is simply-connected. Finally, when we prove non-emptiness
of Newton strata, we need to assume that GQp splits over a cyclic (tamely ramiﬁed) extension of
Qp. Of course, in every statement we will make explicit the assumptions that we impose.

4.1 Transfer of maximal tori and strategy of proof of Theorem 4.1.3

4.1.1 In the work of Langlands-Rapoport, a critical role is played by the notion of transfer (or
admissible embedding) of maximal torus. Recall ([Kot84b, §9]) that for a connected reductive group
∼→ GF is an inner-twisting and T is a maximal F -torus of H, an F -
G over a ﬁeld F , if ψ : HF
embedding i : T → G is called admissible if it is of the form Intg◦ ψ|T for some g ∈ G(F ) (equiv. of
the form ψ ◦ Inth|T for some h ∈ H(F )). Whether an F -embedding i : T → G is admissible or not
depends only on the conjugacy class of the inner-twisting ψ. We will also say that T transfers to G
∼→ GF understood) if there exists an admissible
(with a conjugacy class of inner twistings ψ : HF
F -embedding T → G (with respect to the same conjugacy class of inner twistings). Usually, this
notion is considered when H is a quasi-split inner form of G, due to the well-known fact ([PR94,
p.340]) that every maximal torus in a reductive group transfers to its quasi-split inner form, but
here we do not necessarily restrict ourselves to such cases. In fact, we will consider more often the
=→ GF is an admissible
identity inner twisting IdG : GF = GF , in which case if Intg : TF ֒→ GF
embedding, we will also let Intg denote both the Q-isomorphism T → Intg(T ) of Q-tori and the
induced morphism of Galois gerbs GT → GIntg(T ); of course the latter is also the restriction of Intg,
regarded as an automorphism of the Galois gerb GG, to GT .

38

4.1.2 We say that an admissible morphism φ : P → GG is well-located 11 if φ(δn) ∈ G(Q) for all
suﬃciently large n. Here, δn is the element in P (K, m)(Q) introduced in Lemma 3.2.9, (2), for any
P(K, m) which φ factors through: φ(δn) does not depend on the choice of such P(K, m) by the
compatibility property of δn (loc.cit.). More generally, for a Q-subgroup H of G, we will say that an
admissible morphism φ : P → GG is well-located in H if φ(δn) ∈ H(Q) (for all suﬃciently large n)
and φ maps into GH(֒→ GG); note the second additional requirement. For example, every special
admissible morphism i ◦ ψT,µh (for a special Shimura sub-datum (T, h)) is always well-located (in
T ). Indeed, δn ∈ P (K, m)(Q) (for suﬃciently large n divisible by m) and the restriction of i◦ ψT,µh
to kernels is deﬁned over Q ([LR87, p.143, second paragraph]).

For a well-located morphism φ : P → GG, we denote by
I := CentG(φ(δn))

the centralizer Q-group of φ(δn) ∈ G(Q) (for any suﬃciently large n: I does not depend on the
choice of n), and by Iφ the inner twisting of I deﬁned by φ. More precisely, if φ(qρ) = gρ ⋊ ρ for
the chosen section ρ 7→ qρ to P → Gal(Q/Q) (Remark 3.2.11, (3)), the map (ρ 7→ gρ) ∈ Z 1(Q, G)
is a cocycle deﬁning Iφ, namely, there is a natural inner twisting Q-isomorphism

ψ : IQ

∼→ (Iφ)Q,

(4.1.2.1)

under which

Iφ(Q) = {g ∈ I(Q) | gρρ(g)g−1

ρ = g} = {g ∈ G(Q) | Int(g) ◦ φ = φ}.

We will also say that an admissible pair (φ, ǫ) is well-located if φ is a well-located admissible
morphism and ǫ ∈ Iφ(Q) lies in G(Q) (a priori, ǫ ∈ Iφ(Q) is only an element of G(Q) via Iφ(Q) ⊂
Iφ(Q) = I(Q) ⊂ G(Q)). If φ is well-located in H and ǫ ∈ Iφ(Q) ∩ H(Q) for a Q-subgroup H of G,
the admissible pair (φ, ǫ) will be said to be well-located in H. Clearly, any admissible pair (φ, ǫ)
nested in some special Shimura datum (T, h) is well-located (in T ).

We also note that for any admissible morphism φ mapping into GT for a maximal Q-torus T ,
we have that T is also a Q-subgroup of Iφ (so T (Q) ⊂ Iφ(Q) = {g ∈ G(Q) | Int(g) ◦ φ = φ}).
Indeed, suppose that φ : P → GT factors through P(K, m) for a CM ﬁeld K Galois over Q and
m ∈ N. We need to check that ǫ commutes with φ(δn) and φ(qρ) (for all n ≫ 1 and ρ ∈ Gal(Q/Q)).
But, the ﬁrst is obvious since both ǫ,φ(δn) belong to T (Q)(⊂ GT = T (Q) ⋊ Gal(Q/Q)), and for the
second, in general, for x ∈ G(Q), we have

φ(qρ)xφ(qρ)−1 = (gρ ⋊ ρ)x(gρ ⋊ ρ)−1 = (gρ ⋊ ρ)x(ρ−1(g−1

ρ ) ⋊ ρ−1) = gρρ(x)g−1

ρ ⋊ 1.

So, ǫ ∈ T (Q) and gρ ∈ T (Q) together imply that ǫ ∈ Iφ(Q).
Theorem 4.1.3. Assume that GQp is quasi-split, and that the Serre condition for (G, X) holds.
Let Kp be a parahoric subgroup of G(Qp).

(1) Every admissible morphism φ : P → GG is conjugate to a special admissible morphism
i ◦ ψT,µh : P → GT ֒→ GG (for some special Shimura sub-datum (T, h ∈ Hom(S, TR) ∩ X) and
i : GT → GG the canonical morphism deﬁned by the inclusion i : T ֒→ G).
(2) Assume that Gder is simply connected. Let φ : P → GG be a well-located (i.e. φ(δn) ∈ G(Q))
admissible morphism. Then, for any maximal torus T of G, elliptic at R, such that

11This is our translation of the German word g¨unstig gelegen used by Langlands-Rapoport [LR87, p.190, line8].

39

(i) φ(δn) ∈ T (Q) for a suﬃciently large n (i.e. T ⊂ I := CentG(φ(δn))), and
(ii) TQp ⊂ IQp is elliptic,
φ is conjugate to a special admissible morphism ψT ′,µh′ , where T ′ = Intg′(T ) for some transfer of
maximal torus Intg′ : T ֒→ G (g′ ∈ G(Q)) (with respect to the identity inner twisting, i.e.
the
composite map TQ ֒→ GQ
(iii) If furthermore TQl ⊂ GQl is elliptic at some prime l 6= p,
we may ﬁnd such transfer of maximal torus Intg′ : T ֒→ G which is also conjugation by an element
of G(Qp) (i.e. Intg′ : TQp → GQp

equals Inty for some y ∈ G(Qp)).

Intg′

−→ GQ is deﬁned over Q).

The ﬁrst statement, in the hyperspecial level case, is Satz 5.3 of [LR87]. It does not oﬀer any
information on the special admissible morphisms that are conjugate to given admissible morphism,
especially on the tori T . In contrast, the point of the second statement, which is due to us in any
level case, is to shed light on such special admissible morphisms, focusing on the tori in the special
Shimura subdata.

To establish these statements, we will adapt the arguments from the proof of loc. cit., which

we now review brieﬂy. It can be divided into three steps:

I. The ﬁrst step is to replace a given admissible morphism φ by an equivalent one which is

well-located (i.e. when we denote the conjugate again by φ, we have φ(δn) ∈ G(Q)).

II. The second step is to show that there is a conjugate Intg ◦ φ : P → GG (g ∈ G(Q)) of φ in
the step I which factors through GT for some maximal Q-torus T (of G) that is elliptic over
R. Again, let us denote the conjugate Intg ◦ φ by φ.

III. The ﬁnal step is to ﬁnd an admissible embedding Intg′ : T ֒→ G (with respect to the identity
inner twisting id : GQ = GQ) with g′ ∈ I(Q) such that Intg′ ◦ φ : P → GIntg′(T ) becomes a
special admissible morphism.

We point out that while the ﬁrst two steps are established by arguments in Galois cohomology
which do not use level subgroups, we need to validate the third step for parahoric level subgroups:
see Lemma 4.2.4 below. For the ﬁner claim (2), it is also necessary to strengthen the second and
the third steps. For that purpose (and some other applications as well), we formalize (with some
improvements incorporated) these steps into two propositions respectively: Prop. 4.1.4, 4.1.5. We
ﬁrst introduce these propositions, postponing their proofs to the next subsection.
Proposition 4.1.4. Let φ : P → GG be an admissible morphism and T a maximal Q-torus of G,
elliptic over R, fulﬁlling the properties (i) and (ii) of Thm. 4.1.3, (2). Then, there exists g ∈ I(Q)
such that Intg ◦ φ maps P into GT (֒→ GG).

Notice that here we only modify φ (while keeping T ). This proposition can be regarded as a
soup-up version of the second step above, in the following sense. In the original second step (i.e.
[LR87], p. 176, from line 1 to -5), we are given an admissible morphism φ and want to ﬁnd a
maximal Q-torus T such that some conjugate of φ maps into GT ⊂ GG. There, φ is considered
somewhat as given and one looks for T with this property. As such, choice of T is restricted by
φ, namely, for arbitrary φ there is very little room of choice for such T . In our case, however, we

40

start with some ﬁxed torus T (notably, the tori T ′ as in Thm. 4.1.3, (2) and (3)), and demand
that a conjugate of φ factors through GT . It turns out that this becomes possible if T satisﬁes the
properties (i) and (ii) of Thm. 4.1.3, (2).

Also we note that the new pair (Intg ◦ φ, T ) still enjoys the properties (i) and (ii), since Intg ◦
The next proposition is also an enhanced version of the third step above.

φ(δn) = gφ(δn)g−1 = φ(δn) (as g ∈ I(Q)).

Proposition 4.1.5. Assume that Gder is simply connected. If an admissible morphism φ : P → GG
is well-located in a maximal Q-torus T of G that is elliptic over R, there exists an admissible
embedding of maximal torus Intg′|T : T ֒→ G such that Intg′ ◦ φ : P → GT ′ is special, where
T ′ := Intg′(T ) (a Q-torus), i.e. Intg′ ◦ φ = ψT ′,µh′ for some h′ ∈ X ∩ Hom(S, T ′
R).
If T further fulﬁlls the condition (iii) of Thm. 4.1.3, one can ﬁnd such transfer of maximal
torus Intg′ (i.e. Intg′ ◦ φ becomes special admissible) which also satisﬁes that
equals Inty|TQp : TQp ֒→ GQp for some y ∈ G(Qp).

• Intg′|TQp

֒→ GQp

: TQp

In particular, TQp and T ′

Qp are conjugate under G(Qp).

The ﬁrst statement of this proposition is proved in [LR87], for hyperspecial Kp, in the course of
proving Satz 5.3 (more precisely, in the part beginning from Lemma 5.11 until the end of the proof
of Satz 5.3). We remark that the idea of exploiting a transfer of maximal torus i : T ∼→ T ′ which
becomes G(Qp)-conjugacy ﬁrst appeared in our previous work ([Lee14, Thm. 4.1.1]), and will ﬁnd
similar application here later.

Finally, we point out that the three properties (i) - (iii) of Theorem 4.1.3 remain intact under
any transfer of maximal torus. Indeed, an inner automorphism does not interfere with the center
and a transfer of maximal torus i : T → G also restricts to a Q-isomorphism i : Z(CentG(t))
Z(CentG(i(t))) for any t ∈ T (Q).

In the next subsection, we present the proofs of Prop. 4.1.4, 4.1.5, and Theorem 4.1.3.12

∼→

4.2 Proof of Propositions 4.1.4, 4.1.5, and Theorem 4.1.3 Recall that we have ﬁxed
a continuous section ρ 7→ qρ to the projection P ։ Gal(Q/Q) (Remark 3.2.11, (3)).
Lemma 4.2.1. Let φ : P → GG be a well-located admissible morphism and T a maximal Q-torus
of G. Let I = CentG(φ(δn)) and Iφ the inner twist of I (4.1.2.1).
(1) Suppose that there exist a Q-subgroup T ′ of Iφ and a ∈ G(Q) such that Inta−1 : TQ ֒→ GQ
is a Q-isomorphism from T to T ′, where T ′ ⊂ Iφ is considered as a Q-subgroup of GQ via the inner
twisting IQ

∼→ (Iφ)Q (4.1.2.1). Then, Inta ◦ φ maps P to GT .

(2) If T is a Q-subgroup of I and a ∈ I(Q), then Inta ◦ φ maps P to GT if and only if
→ (Iφ)Q is deﬁned over Q (i.e., ψ ◦ Inta−1|T : T ֒→ Iφ is a transfer of maximal

−→ IQ

Inta−1

In other words, a conjugate of φ maps into GT if and only if T ⊂ I transfers to Iφ with respect

ψ

TQ ֒→ IQ
torus with respect to the inner twisting IQ
∼→ (Iφ)Q (4.1.2.1).

to the inner twisting IQ

∼→ (Iφ)Q).

12The original arguments in [LR87] use the quasi-motivic Galois gerb Q instead of the pseudo-motivic Galois gerb
P, but as we mentioned before, the deﬁnition of Q given there is wrong. However, the whole arguments remain valid
with Q replaced by P, as long as the (admissible) morphisms in question factor through P.

41

∼→ (Iφ)Q is an inner twist, it restricts to a Q-isomorphism Z(I)

∼→
Proof. (1) First, since ψ : IQ
Z(Iφ). So, if φ(δn) ∈ G(Q), φ(δn) ∈ Z(I)(Q) = Z(Iφ)(Q) ⊂ T ′(Q), that is, Inta ◦ φ(δn) ∈ T (Q).
This is equivalent to that (Inta ◦ φ)∆ maps P to T , as {δk
n}k∈N is Zariski-dense in P (K, n) (for any
suitable CM ﬁeld K) (Lemma 3.2.9 (2)). Next, via ψ we identify Iφ(Q) with I(Q) ⊂ G(Q) endowed
with the twisted Galois action g 7→ gρρ(g)g−1
ρ , where g 7→ ρ(g) is the original Galois action on
G(Q). Let φ(qρ) = gρ ⋊ ρ. Then, the condition means that

gρρ(a−1ta)g−1

ρ = a−1ρ(t)a

(4.2.1.1)

for all t ∈ T (Q), which is the same as that agρρ(a)−1 ∈ T (Q), as CentG(T ) = T . As aφa−1(qρ) =
agρρ(a)−1 ⋊ ρ, this implies the assertion.

(2) This is similar to (1).

∼→ (Iφ)Q the inner
4.2.2 Proof of Proposition 4.1.4. Let I = CentG(φ(δn)) and ψ : IQ
twisting deﬁned by φ (4.1.2.1). By Lemma 4.2.1, (2), it suﬃces to prove that T transfers to Iφ (with
respect to the conjugacy class of ψ). For this we choose a quasi-split inner-twisting ψ∗ : I ∗
Q → IQ,
where I ∗ is the quasi-split inner form of I. Then, it is well-known ([PR94, p.340]) that any maximal
torus of I (in particular, T ) always transfers to the quasi-split inner form I ∗. So by replacing ψ∗
is deﬁned over Q; let T ∗ be its image
by a conjugate of it, we may assume that (ψ∗)−1|T : TQ → I ∗
(so a maximal Q-subtorus of I ∗). Obviously, to prove Proposition 4.1.4, we only need to show that
T ∗ transfers to Iφ (with respect to the inner twisting ψ ◦ ψ∗ : I ∗
First, note that all of I, Iφ, and I ∗, being inner forms of each other, share the same center,
and by construction T ∗ ≈ T over Q. So, for v = ∞ and p, T ∗
Qv .
Indeed, as TQv is an elliptic maximal torus of IQv (which is the same as that Z(IQv ) contains the
maximal split Qv-subtorus of TQv ), Z(I ∗
) contains a split Qv-torus of same rank, which then must
Qv
be the maximal split subtorus of T ∗
Qv ≈ TQv Therefore, according to [LR87, Lemma 5.6], it suﬃces
to check that T ∗ transfers to Iφ everywhere locally. At v = ∞, p, this already follows from the fact
that T ∗
Qv ([LR87, Lemma 5.8, 5.9]). At a ﬁnite place v 6= p, since φ ◦ ζv
is conjugate to the canonical trivialization ξv : Gv → GG(v) (Def. 3.3.7, (2)), the inner-twisting
ψQl

(via ﬁxed embedding Q ֒→ Qv) descends to an Qv-isomorphism

Qv is an elliptic maximal torus of I ∗

Qv is an elliptic torus of I ∗

∼→ (Iφ)Q).

Q

Q

: IQv

∼→ (Iφ)Qv

IQv

∼→ (Iφ)Qv .

But, by our assumption that φ(δn) ∈ T (Q), T is a subgroup of I. Therefore, T ∗
to (Iφ)Qv with respect to the conjugacy class of ψQv

.

Qv ≈ TQv transfers

As was explained after the statement of Theorem 4.1.3, Proposition 4.1.5 is a strengthening of
the third step in the proof of Satz 5.3 in [LR87]. The proof of this step in loc. cit. itself proceeds
in three steps: Lemma 5.11, Lemma 5.12, and the rest of the proof of Satz 5.3 (p.181, line 1-19 of
[LR87]). Again we will prove our proposition along the same line. First, we need some facts from
the Bruhat-Tits theory.

Lemma 4.2.3. (1) Let G be a (connected) reductive group over a ﬁeld F . Then, for any F -split
F -torus AM in G, its centralizer M := CentG(AM ) is an F -Levi subgroup of G (i.e. a Levi factor
deﬁned over F of an F -parabolic subgroup of G). If G is quasi-split, then so is M .

42

From now on, we suppose that F is a complete discrete valued ﬁeld with perfect residue ﬁeld
(mainly, local ﬁelds or k = Frac(W (¯Fp))), and G a connected reductive group over F . As before,
let M = CentG(AM ) for a split F -torus AM , and ﬁx a maximal split F -torus S of G containing
AM . Let AG = AG(S, F ) and AM = AM (S, F ) denote respectively the apartments in the buildings
B(G, F ) and B(M, F ) corresponding to S.
(2) Every aﬃne root α of AG whose vector part a = v(α) ∈ Φ(G, S) is a root in Φ(M, S) is also
an aﬃne root of AM .
(3) For any special maximal parahoric subgroup K of G(F ) associated with a special point in
AG, the intersection K ∩ M (F ) is also a special maximal parahoric subgroup of M (F ).
Proof. (1) These are standard. For the ﬁrst claim, see [BT65, Thm. 4.15]. The second claim is
easily seen. We use the fact that for a (connected) reductive group H over a ﬁeld F , H is quasi-split
if and only if for a (equiv. any) maximal F -split torus of H, its centralizer in H is a (maximal)
torus (cf. proof of Prop. 16.2.2 of [Spr98]). Now, as any torus containing AM is a subgroup of
M = CentG(AM ), so is any maximal F -split torus of G containing AM ; choose one and call it S.
As G is quasi-split, the centralizer T := CentG(S) of S is a torus of G, thus is itself contained in
M . But, then T is also the centralizer of S in M .

(2) This also follows readily from deﬁnition. First, we recall that the relative root datum
Φ(M, S) = (X∗(S), R∗(M ), X ∗(S), R∗(M )) for (M, S) is a closed sub-datum of the root datum
Φ(G, S) = (X∗(S), R∗(G), X ∗(S), R∗(G)) deﬁned by a subset I of the set ∆ = {a1,··· , an} of
simple roots (for some ordering on R∗(G)) ([BT65, Thm. 4.15]):

R∗(M ) = R∗(G) ∩Xai∈I

Zai,

(4.2.3.1)

and AM = (∩α∈I Ker(α))0 (the largest split F -torus in the center Z(M )). Next, for an aﬃne
function α on A(S, F ) ∼= X∗(S)R (regarded as a common aﬃne space without any apartment
structure) whose vector part belongs to Φ, let X G
α be deﬁned as in [Tit79, 1.4] with respect to G,
i.e.

X G
α = {u ∈ Uv(α)(F ) | u = 1 or α(v(α), u) ≥ α}.

Here, for a ∈ R∗(G, S), Ua refers to the associated root group. This an unipotent F -group, which
was denoted by F Ua or U(a) in [BT65], 5.2.13 When a ∈ R∗(M, S), as Ua ⊂ M for a ∈ R∗(M ),
it follows from deﬁnition that this Ua is the same group as that deﬁned regarding a as a root for
(M, S). Similarly, if v(α) ∈ R∗(M ), the same is also true of the aﬃne function α(v(α), u). In more
detail, its deﬁnition uses only the properties of root (group) datum (of type some root system) in
the sense of [BT72, 6.1]. For S and Ua (a ∈ R∗(G, S)) as above, there exist certain S-right cosets
{Ma}a∈R∗(G,S) such that the family of subgroups

{S,{Ua, Ma}a∈Φ(G,S)}

becomes a root group datum of type Φ(G, S) (in G) (in fact Ma is then a subset of the group
generated by {S, Ua, U−a}, cf.
In particular, the element m(u) (for each
13In turn, this is the group that was denoted by G∗(S)
(a)

(a)) in loc. cit. 3.8. Namely, when we choose a
maximal F -torus T of GF containing S, it is the group generated by F Ub (the “absolute” root group in GF deﬁned
with respect to (GF , T )) for the absolute roots in R∗(GF , T ) whose restriction to S belong to (a), the set of relative
roots in R∗(G, S) that are positive integer multiples of a.

[BT72, (6.1.2), (9)]).

(or G∗

43

u ∈ Ua(F )\{1}) appearing in [Tit79, 1.4] belongs to Ma and is determined solely by the root group
datum {S,{Ua, Ma}a∈Φ(G,S)} ([BT72, (6.1.2), (2)]). But, as Φ(M, S) is (quasi-)closed in Φ(G, S)
and Ua ⊂ M for a ∈ R∗(M ), the subset {T,{Uα, Mα}α∈Φ(M,S)} is also a root datum of type Φ(M, S)
(in G), cf. [BT72, 7.6]. Hence we can drop the superscript G in X G
α without ambiguity. Now, we
recall the deﬁnition ([Tit79, 1.6]) that an aﬃne function α is an aﬃne root of G (relative to S and
F ) if Xα is not contained in Xα+ǫ · U2v(α) (= Xα+ǫ if 2v(α) /∈ Φ) for any strictly positive constant
ǫ. The claim in question is immediate from this deﬁnition and the above discussions.
(3) It is shown in [HS10, Lemma 4.1.1] that K ∩ M (F ) is a parahoric subgroup of M (F ). So we
just have to show that it is special maximal parahoric. Using the special point 0 ∈ AG(S, F ), we
may embed B(M, F ) into B(G, F ) such that 0 lies in the image ([BT72, 7.6.4], [BT84, 4.2.17-18]).
Let A((M der ∩ S)0, F ) be the apartment corresponding to the maximal split F -torus (M der ∩ S)0
of M der. As the aﬃne hyperplanes in AM form a subset of those in AG, it is obvious that 0 is
contained in a unique facet aM

0 in AM , i.e. in

0 ∼= X∗(Z(M ))R × {v0}.
aM

for some unique facet v0 in the apartment A((M der ∩ S)0, F ) (recall that M is the centralizer
of a split torus Z(M ) which then must be the center). Now, we claim that v0 is a vertex of
A((M der ∩ S)0, F ). Indeed, as 0 is a special point, we may identify the aﬃne space AG with the
vector space X∗(S)R (0 becoming the origin) so that the root hyperplanes {Hα}α∈R∗(G,S) are all
aﬃne hyperplanes. Clearly, 0 = ∩α∈R∗(G,S)Hα ∩ X∗((Gder ∩ S)0)R. Let I ⊂ ∆ be the subset
deﬁning the root datum Φ(M, S) as in (2); so, the center Z(M ) is equasl to ∩α∈I Hα (intersection
of root hyperplanes in X∗(S)R). But, by (2), {Hα}α∈I is also a subset of aﬃne hyperplanes in the
apartment AM of (M, S), and 0 is contained in the intersection of these linearly independent aﬃne
hyperplanes in A(M, S), whose dimension is thus equal to rank rM of Z(M ). Hence, 0 is contained
in a facet of AM of dimension at most rM , which implies that the facet v0 is of zero-dimension, i.e.
a vertex in the building for M der.
Once we know that v0 is a vertex, the fact that it is a special vertex also follows readily from
(2). Indeed, by deﬁnition ([Tit79, 1.9]), we need to check that every root of a ∈ Φ(M, S) is the
vector part of an aﬃne roof of (M, S) vanishing at v0(∈ AM der
). We know that a also belongs to
Φ(G, S), thus since 0 is special, there exists an aﬃne root α of (G, S) with vector part v(α) = a
and vanishing at 0. But, by (2), such α is also an aﬃne root of AM , and as such, it must vanish
on the facet in AM containing 0, i.e. on aM
Lemma 4.2.4. Let T1 ⊂ GQp be a maximal Qp-torus, split by a ﬁnite Galois extension K of
Qp, b ∈ T1(k), and {µ} a G(Qp)-conjugacy class of minuscule cocharacters of GQp
. Let Kp be a
(not necessarily special maximal) parahoric subgroup of G(Qp). If X({µ}, b)Kp 6= ∅, there exists
µ ∈ X∗(T1) ∩ {µ} such that
(4.2.4.1)

0 ∼= X∗(Z(M ))R × {v0}.

NmK/Qpµ = [K : Qp]νb,

where νb ∈ X∗(T1)Q is the Newton homomorphism attached to b.
In particular, if φ is an admissible morphism well-located in a maximal Q-torus T of G that is
elliptic over R, there exists a µ ∈ X∗(T ) ∩ {µX} such that φ and ψT,µ coincide on the kernel of P.

Here, i ◦ ψT,µ is not necessarily admissible, because µ may not be µh′ for some h′ ∈ X.

44

Lv2
p

: G

Lv2
p

Proof. This is proved in Lemma 5.11 of [LR87] when Kp is a hyperspecial subgroup. We will adapt
its argument for a general parahoric subgroup. We ﬁrst show how the ﬁrst statement implies the
second one. Since the kernel of the Galois gerb P is the projective limit of P (L, m)(Q), where
L runs through CM Galois extensions of Q and m ∈ N varies with respect to divisibility (cf.
Subsubsec. 3.2.7), we only need to show it after restricting φ, ψT,µ to P (L, m) (for all suﬃciently
large Galois CM ﬁeld L and m). Let L be a CM-ﬁeld splitting T . Then, the Galois-gerb morphisms
ψT,µ : P → GT and ζp : Gp → P(p) factor through PL and G
, respectively (Lemma 3.3.1, (2)
and Remark 3.2.11), where as usual v2 denotes (by abuse of notation) the place of L induced by the
Lv2
ﬁxed embedding L ֒→ Q. Let ζ
p → P(p) denote the induced morphism. Then, according
[LR87], p. 143-144), when µ + ιµ is deﬁned over Q, ψT,µ(δm) is the
to the deﬁnition of ψT,µ (cf.
unique element t in T (Q) such that for all λ ∈ X ∗(T ), λ(t) is a Weil number and

σλ(t)|p = q−hλ,NmLv2 /Qp µi

| Yσ∈Gal(Lv2 /Qp)
Lv2
holds with q = pm. Further, ψT,µ(p) ◦ ζp : G
−µ by an element of T (Qp)
Lv2
p → GT (p) is the morphism deﬁned in Deﬁnition 3.3.2 for
(Lemma 3.3.3, (2)), where ξ
(TQp, µ, Lv2 ). On the other hand, by enlarging L if necessary, we may assume that φ also factors
through PL, and that there exists a Galois Qur
whose inﬂation
to Qp is T (Qp)-conjugate to ξp = φ(p) ◦ ζp, where l := [Lv2 : Qp], (Lemma 3.2.4, (2), or Lemma
3.3.9). Then, for b ⋊ σ := ξ′

Lv2
p → GT is conjugate to ξ

p /Qp-gerb morphism ξ′

p : Dl → Gur

Lv2
−µ : G

σ), we have that

p(sl

TQp

−[Lv2 : Qp]νb = νp := φ(p)∆ ◦ (ζ

Lv2
p

)∆.

Next, recall (cf. Subsec. 3.2.7) that each character of P (L, m) is regarded as a Weil q = pm-number
in L, with the correspondence being realized in terms of δm by χ 7→ χ(δm) (Lemma 3.2.9, (2)),
and that for a Weil q-number π, χπ is the notation regarding it as a character of P (L, m). For
λ ∈ X ∗(T ), writing φ∗(λ)(δm) as πλ for short (so that χπλ = φ∗(λ)), we see that
σφ∗(λ)(δm)|p = | Yσ∈Gal(Lv2 /Qp)

σλ(φ(δm))|p = | Yσ∈Gal(Lv2 /Qp)

| Yσ∈Gal(Lv2 /Qp)

σπλ|p

Lv2
2

i = qhφ∗(λ),(ζ

Lv2
p

)∆i

= qhχπλ ,ν
= qhλ,νpi.

Here, the third equality is the property of ν
This shows that the ﬁrst statement implies the second claim.

Lv2
2 = (ζ

Lv2
p

)∆ (Def. 3.2.8, (3.2.8.1), cf. Subsec. 3.2.7).

Now, we establish the ﬁrst statement. We remark that we will reduce the general parahoric

1

Let T split

subgroup case to a situation involving only a special maximal parahoric subgroup.
be the maximal Qp-split subtorus of T1, M the centralizer of T split

; thus T1 ⊂ M ,
and M is a Qp-Levi subgroup (Lemma 4.2.3, (1)). Below, there will be given a special point 0
of the Bruhat-Tits building B(G, k). Then, one can ﬁnd a Qp-torus S′ of M whose extension to
p , and a M (k) ⋊ Gal(Qur
p becomes a maximal Qur
Qur
p /Qp)-equivariant embedding
B(M, k) ֒→ B(G, k) such that 0 lies in the image of the apartment AM
k ⊂ B(M, k) corresponding to

p -split torus of MQur

1

45

S′. Note that the centralizer T ′ := CentGQp (S′) is a maximal torus of GQp (thus, a maximal torus
of M as well), as Gk is quasi-split by a theorem of Steinberg.

We recall that for a facet f σ in B(GQp, Qp), there exists a unique σ-stable facet f in B(GQp, k)
f be the smooth Ok-group scheme canonically attached to f ,
f (Ok) ﬁxes f pointwise (cf. [BT84,
0(Ok)σ

with f hσi = f σ ([BT84, 5.1.28]). Let Go
so that it has connected geometric ﬁbers and the elements of Go
5.2]). Then,
f (Ok), Kf (Qp) := Go

Kf (k) := Go

are the pararhoric groups associated with the facet f (or f σ) (cf. [HR08], Prop. 3).

GQp
k

Let A

be the apartment corresponding to S′. By conjugation, we assume that the given
GQp
k

σ-stable facet f deﬁning Kp (i.e. Kp = Kf (Qp)) lies in A
whose closure contains f , and let Ka(k) be the corresponding Iwahoric subgroup of G(k). The alcove
a then must contain some (not necessarily σ-stable) special point 0 in its closure. If K0(k) ⊂ G(k)
denotes the associated special maximal parahoric subgroup, we have that Ka(k) ⊂ K0(k) since 0 is
in the closure of a. Now, as both a and f are σ-stable, according to [He15, Thm.1.1], the condition
X({µ}, b)Kf (Qp) 6= ∅ implies that X({µ}, b)Ka(Qp) 6= ∅. Let µB be a dominant representative of {µ},
where we choose the dominant Weyl chamber opposite to the unique Weyl chamber containing
the base alcove a with apex at the special vertex 0 (following the convention of [HR15]). Also,

. We ﬁx a σ-stable alcove a in A

GQp
k

the semidirect product Wa ⋊ Ωa of the aﬃne Weyl group Wa (attached to S′) with the normalizer

recall (2.2.2.4) that the choice of a base alcove a presents the extended aﬃne Weyl group fW as
subgroup Ωa ⊂fW of a, thereby ﬁxes a Bruhat order ≤ on fW as well.

Let g1 ∈ G(k) be such that g1Ka(k) ∈ X({µX}, b)Ka(k), i.e. if

invKa(k)(g1, bσ(g1)) =fWKa(k) · w1 ·fWKa(k)

(w1 ∈fW ),

under the isomorphism Ka(k)\G(k)/Ka(k) ≃fWKa(k)\fW /fWKa(k), there exists µ′ ∈ X∗(T ′) ∩ W0 · µB

that

(4.2.4.2)

(4.2.4.3)

fWKa(k) · w1 ·fWKa(k) ≤ fWKa(k) · tµ′

·fWKa(k).

Here, we used the notations from (2.2.3); namely, µ′ is the image of µ′ in X∗(T ′)Γk, and for

λ ∈ X∗(T ′)Γk, tλ denotes the corresponding element of fW via X∗(T ′)Γk ∼= T ′(k)/T ′(k)1 ⊂fW . Since

Ka(k) ⊂ K0(k), the same relations (4.2.4.2), (4.2.4.3) continue to hold with Ka(k) replaced by K0(k)
(see [Rap05, (3.5)] for (4.2.4.3)). Be warned that this does not mean that X({µ}, b)K0(k) 6= ∅: the
latter deﬁnition makes sense only when the point 0 is σ-stable.

Therefore, we are given a string of Qp-subgroups of GQp:
S′ ⊂ T ′ ⊂ M, T1 ⊂ M,

where

(a) M is a Qp-Levi subgroup of GQp (i.e. M is the centralizer of a Qp-split torus of GQp);

(b) S′ is a Qp-torus of M whose extension to Qur

p becomes a maximal Qur

p -split torus of MQur

p

(thus S′ is also such torus for GQp);

(c) T ′ = CentGQp (S′) (thus, a subgroup of M );

46

(d) T1 is an elliptic maximal torus of M which νb factors through.

These satisfy the following properties: There exists a special point 0 of B(G, k) which lies in
k ⊂ B(M, k) corresponding to S′, under a suitable embedding
the image of the apartment AM
B(M, k) ֒→ B(G, k). Also, the relations (4.2.4.2), (4.2.4.3) hold with Ka(k) replaced by K0(k)
(for some g1, w1, µ′ as in there). In this set up, we establish the existence of µ ∈ X∗(T1) ∩ {µ}
satisfying (4.2.4.1). We proceed in the following steps:

(1) Let Q be a Qp-parabolic subgroup of GQp of which M is a Levi factor. Then, by Iwasawa
decomposition G(k) = Q(k)K0(k), we may assume g1 ∈ Q(k): this follows from the classical
Iwasawa decomposition G(k) = Q(k)Fix(0) ([Tit79, 3.3.2]) and that Fix(0) ⊂ T ′(k) · K0(k).
Indeed, Fix(0) ⊂ G(k) = K0(k)T ′(k)K0(k), so any g ∈ Fix(0) is written as k1tk2 with k1, k2 ∈
K0(k) and t ∈ T ′(k)∩ Fix(0). But, as K0(k) is normal in Fix(0), we see that g ∈ T ′(k)· K0(k).
When one writes g1 = nm with m ∈ M (k) and n ∈ NQ(k) (NQ being the unipotent radical of
Q), one has that

where

g−1
1 bσ(g1) = m−1bσ(m)n′,

n′ = σ(m)−1b−1n−1bσ(n)σ(m).

One readily checks that n′ ∈ N (k).

(2) Deﬁne µ′′ ∈ X∗(T ′) by

m−1bσ(m) ∈ (K0(k) ∩ M (k)) tµ′′

(K0(k) ∩ M (k)),

using the Cartan decomposition for (M, K0(k)∩ M (k)) (as K0(k)∩ M (k) is a special maximal
parahoric subgroup of M (k), by Lemma 4.2.3, (3)). Note the equality:

wGk(tµ′′

) = wGk(m−1bσ(m)) = wGk(m−1bσ(m)n′) = wGk(w1) = wGk(tµ′

),

have the same component in Ωa and wGk is trivial on the image in GQp(k) of
Qp being the universal covering of Gder
Qp ) ([Kot97, 7.4]). It follows that the images

where the last equality holds since by deﬁnition of the Bruhat order on fW = Wa ⋊ Ωa,
w1 and tµ′
Qp(k) (Gsc
Gsc
of µ′, µ′′ ∈ X∗(T ′) in π1(G)Γk are the same.
On the other hand, if k1, k2 ∈ K0(k) ∩ M (k) are such that m−1bσ(m) = k1tµ′′
m−1bσ(m)n′ = k1tµ′′
n′′k2 for some n′′ ∈ N (k). Consequently, we see that

k2n′ = k1tµ′′

k2, then

K0(k) tµ′′

NQ(k) ∩ K0(k)w1K0(k) 6= ∅.

By (4.2.4.3), this implies that with respect to the Bruhat order on fWK0(k)\fW /fWK0(k),

fWK0(k) · tµ′′

·fWK0(k) ≤fWK0(k) · tµ′

·fWK0(k).

Indeed, the argument of the proof of [HS10], Lemma 10.2 establishes the following fact: for

x, y ∈fW , if K0(k)yNQ(k) ∩ K0(k)xK0(k) 6= ∅, then y ≤ x′ for some x′ ∈fWK0(k) · x ·fWK0(k).
Also, if x ≤ y in the Bruhat order onfW , thenfWK0(k) · x·fWK0(k) ≤fWK0(k) · y ·fWK0(k) ([KR00,

8.3]).

47

(3) Let µ′

, µ′′

0

denote the dominant representatives of W0·µ′, W0·µ′′ ⊂ X∗(T ′)I in X∗(T ′)I⊗R =

0

X∗(S′)R, where I = Γk = Gal(k/k). Then, we claim that

µ′′

0 ≤ µ′

.

0

for the dominance order on X∗(S′)R (determined by the choice of the alcove a).
Indeed, by ([Tit79, 1.7]), with our choice of the special vertex 0, the aﬃne space A(S′, k) is
identiﬁed with the real vector space V := X∗(S′)R = X∗(T ′)I ⊗ R (with the origin 0), and
there exists a reduced root system 0Σ such that Wa can be identiﬁed with its aﬃne Weyl
group

Wa = Q∨(0Σ) ⋊ W (0Σ)

(i.e. Q∨(0Σ) = X∗(T sc)I and W (0Σ) = W0). Also, the choice of the alcove a containing 0

determines a set Sa of simple aﬃne roots on A(S′, k), andfWK0(k) ≃ W0 is the subgroup of Wa
generated by the subset 0∆ consisting of the simple aﬃne roots whose corresponding aﬃne
hyperplanes pass through 0 (thus, 0∆ is a set of simple roots for 0Σ). In this set-up of the
Coxeter group Wa endowed with a set of generators Sa, the claim follows from Lemma C.0.8,
applied with the choice θ = 0, noting the following two facts: First, for w = tν ∈ Wa with
ν ∈ X∗(T sc)I , wθ is identiﬁed with ν ∈ V . Secondly, W0tµ′′
W0 if and only if
w′′ ≤ w′, where w′′ (resp. w′) is the (unique) element of minimal length in the coset W0tν′′
W0
W0) with ν′′ ∈ X∗(T sc)I being the component of µ′′ ∈ X∗(T )I (⊂fW = Wa ⋊ Ωa)
(resp. W0tν′
(resp. ν′ ∈ X∗(T sc)I being the component of µ′ ∈ X∗(T )I ).
Hence, by [RR96, Lemma 2.2], we have that

W0 ≤ W0tµ′

W0 · µ′′ ≤ µ′

.

0

But, as µ′ − wµ′′ ∈ X∗(T ′sc)I for any w ∈ W0, it follows from [Kot84b], Lemma 2.3.3 that

µ′′ ∈ W0 · µ′,

because µ′ is a minuscule coweight. Namely, there exist w ∈ W0 and µ1 ∈ hτ x − x | τ ∈
Gal(k/k), x ∈ X∗(T ′)i such that

µ′′ = wµ′ · µ1

(multiplicative notation).

(4) So far, we have not used T1 at all. Now, we will use the condition that T1 is elliptic in M .
Let µ ∈ X∗(T1) (arbitrary cocharacter for a moment). Let us put νp := [K : Qp]νb ∈ X∗(T1).
As NmK/Qpµ and νp are both Qp-rational, the required equation (4.2.4.1) holds if and only if

[K : Qp]hχ, µi = hχ, νpi

(4.2.4.4)

for every Qp-rational character χ of T1.
But, since T1 is elliptic in M , any Qp-rational character χ of T1 can be regarded as a Qp-
rational character χab of M ab = M/M der ∼= T1/(T1 ∩ M der), thus also as that of M (via the
canonical projection p : M → M ab) such that hχ, µi = hχab, p◦ µi (the ﬁrst pairing is deﬁned

48

for X ∗(T1) × X∗(T1) and the second one for X ∗(M ab) × X∗(M ab)). For a cocharacter ν of
M , we will often write hχab, p ◦ νi simply as hχab, νi.
Now, as T1, T ′ are both maximal tori of M , there exists g ∈ M (k) with T1 = gT ′g−1. Set

µ := gw(µ′)g−1 ∈ X∗(T1) ∩ W · {µ}

(4.2.4.5)

Then, as χ is Qp-rational, we have that hχ, gµ1g−1i = hχab, p ◦ gµ1g−1i = hχab, p ◦ µ1i = 0,
thus

hχ, µi = hχab, p ◦ µi = hχab, p ◦ gw(µ′)g−1 · gµ1g−1i = hχab, p ◦ µ′′i.

On the other hand, by deﬁnition of µ′′, for any Qp-rational character λ of M , we have that

|λ(m−1bσ(m))| = p−hλ,µ′′i.
Since |λ(b)| = p−hλ,νbi, we also get that wtih l := [K : Qp],

p−[K:Qp]hλ,µ′′i = |λ(m−1bσ(m)··· σ−(l−1)(m)σl−1(b)σl(m))| = p−hλ,νpi.

Thus by substituting λ = χab (for a Qp-rational character χ of T1) and using that hχab, νpi =
hχ, νpi, one obtains the equality (4.2.4.4).

This completes the proof.

Remark 4.2.5. (1) Suppose that ψT,µ(p) ◦ ζp factors through GK
p . Since ψT,µ(p) ◦ ζp is conjugate
to ξ−µ under T (Qp), their restrictions to the kernel Gm are the same (Lemma 3.3.3, (2)), i.e.
equals −NmK/Qpµ. So, the condition (4.2.4.1) means that the two Qp/Qp-Galois gerb morphisms
ψT,µ(p) ◦ ζp, φ(p) ◦ ζp have the same restrictions to the kernel. Then, by deﬁnition of ψT,µ (cf.
[LR87], p.143-144), this implies that (i ◦ ψT,µ)∆ = φ∆.
(2) In our proof, we had a maximal Qp-torus T ′ = CentGQp (S′). In the proof of [LR87], Lemma
5.11, there appears (on p. 177, line -5) a maximal torus of M which is also denoted by the same
symbol T ′. From our perspective, the role of their T ′ is that of providing a common aﬃne space
underlying the apartments B(GQp, k), B(M, k) (which contains the given (hyper)special point),
whose job in our situation is done by S′. Meanwhile, our T ′
k is the centralizer of a maximal k-split
torus S′
k and enters the proof as such, for example, via the Iwasawa and Cartan decompositions (cf.
[Tit79, 3.3.2]). On the other hand, when GQp is unramiﬁed, their T ′ is unramiﬁed and this is how
the unramiﬁed condition (or word) in their proof shows up.

The next lemma is our strengthening of Lemma 5.12 of [LR87]. Its proof does not involve the

level subgroup Kp.

Lemma 4.2.6. Let φ, ψT,µ be as in Lemma 4.2.4. Then, there exists an admissible embedding of
maximal torus Intg′ : T ֒→ G (g′ ∈ G(Q)) (with respect to the identity inner twisting GQ = GQ)
such that
(i) Intg′ ◦ φ equals ψT ′,µh′ on the kernel of P, for some h′ ∈ X∗(T ′) ∩ X.
Moreover, if TQl is elliptic in GQl for some prime l 6= p, there exist g′ ∈ G(Q) and h′ ∈ X satisfying,
in addition to (i), that

49

(ii) there exists y ∈ G(Qp) such that (T ′

Qp, µh′) = Inty(TQp, µ).

The ﬁrst statement, i.e. existence of a transfer of maximal torus Intg′ : T ֒→ G with the
property (i) is the assertion of Lemma 5.12 of [LR87] which we reproduce now, while the existence
of such element with the additional property (ii) (under the given assumption on TQl) is due to the
author.
Proof. Let T sc denote the inverse image of T ∩ Gder under the isogeny Gsc → Gder;
it is a
maximal torus of Gsc. Choose w ∈ NG(T )(C) such that µ = w(µh). We have the cocycle
α∞ ∈ Z 1(Gal(C/R), Gsc(C)) deﬁned by

α∞
ι = w · ι(w−1).

One readily checks that this has values in T sc(C). Indeed, according to [Sh, Prop. 2.2], the auto-
morphism Int(w−1) of T sc
C is deﬁned over R, so Int(w−1)(ι(t)) = ι(Int(w−1)t) = Int(ι(w−1))(ι(t))
for all t ∈ T sc(C), i.e. ι(w)w−1 ∈ CentGsc(T sc)(C) = T sc(C), and so is wι(w−1) = ι(ι(w)w−1). Let
φ, ψT,µ be as in Lemma 4.2.4. Then, according to Lemma 7.16 of [Lan83], one can ﬁnd a global
cocycle α ∈ Z 1(Q, T sc) mapping to α∞ ∈ H 1(Q∞, T sc). If furthermore TQl is elliptic in GQl for
some prime l 6= p, we can choose α ∈ Z 1(Q, T sc) mapping to α∞ ∈ H 1(Q∞, T sc) and having trivial
image in H 1(Qp, T sc), according to [Lee14, Lemma 4.1.2], which we now recall with its proof. It is
a variant of the original argument of [LR87, Lemma 5.12].

Lemma 4.2.7. [Lee14, Lemma 4.1.2] Let T be a maximal Q-torus of G which is elliptic at some
ﬁnite place l 6= p.

(1) The natural map (π1(T sc)Γ(l))tors → (π1(T sc)Γ)tors is surjective.
(2) The diagonal map H 1(Q, T sc) → H 1(R, T sc) ⊕ H 1(Qp, T sc) is surjective.

Proof. (1) This map equals the composite:

(π1(T sc)Γ(l))tors ֒→ π1(T sc)Γ(l)

։ π1(T sc)Γ ։ (π1(T sc)Γ)tors,

where the last two maps are obviously surjective. Therefore, it is enough to show that π1(T sc)Γ(l)
is a ﬁnite group, and so is π1(T sc)Γ(l) =
is a torsion group. But, as T sc
Ql
, C×).

is anisotropic, cT sc

(2) For every place v of Q, non-archimedean or not, there exists a canonical isomorphism

Γ(l)

Γ(l)

Γ(l)

X ∗(cT sc

([Kot84a, (3.3.1)])

) = Hom(cT sc
∼→ π0(cT sc

H 1(Qv, T sc)

and a short exact sequence ([Kot86, Prop.2.6])

Γ(v)

)D = Hom(π0(cT sc

Γ(v)

), Q/Z) ∼= X ∗(cT sc

Γ(v)

)tors ∼= (X∗(T sc)Γ(v))tors,

H 1(Q, T sc) → H 1(Q, T sc(A)) = ⊕vH 1(Qv, T sc)

where θ is the composite

θ→ π0(Z(cT sc)Γ)D = (π1(T sc)Γ)tors,

⊕vH 1(Qv, T sc) ∼→ ⊕vπ0(Z(cT sc)Γ(v))D → π0(Z(cT sc)Γ)D

50

(the second map is the direct sum of the maps considered in (1)). Let (γ∞, γp) ∈ H 1(R, T sc) ⊕
H 1(Qp, T sc). By (1), there exists a class γl ∈ H 1(Ql, T sc) with Pv=l,∞,p θ(γv) = 0. Then, the
element (βv)v ∈ H 1(Q, T sc(A)) such that βv = γv for v = l,∞, p and βv = 0 for v 6= l,∞, p goes to
zero in π0(Z(cT sc)Γ)D. By exactness of the sequence, we ﬁnd a class γ in H 1(Q, T sc) which maps
to the class (βv)v.
Now, by changing w (to another w′ ∈ NG(T )(C)) if necessary, we may further assume that
α∞ is equal (as cocycles) to the restriction of α to Gal(C/R). Then, since the restriction map
H 1(Q, Gsc) → H 1(Q∞, Gsc) is injective (the Hasse principle), α becomes trivial as a cohomology
class in Gsc(Q):

H 1(Q∞, T sc)

/ H 1(Q∞, Gsc)

ι = wι(w−1) ✤
α∞

H 1(Q, T sc)

H 1(Q, Gsc)

α❴

In other words, there exists u ∈ Gsc(Q) such that

αρ = u−1ρ(u),

/ 0

/ α′?

3 α′ = 0

for all ρ ∈ Gal(Q/Q). It then follows that Intu : (T )Q → GQ is an admissible embedding of maximal
torus with respect to the identity inner twisting of GQ (i.e. the homomorphism Intu and thus the
torus T ′ = Int(T ) as well are deﬁned over Q). We also note that since the restriction of Intu to
Z(G) is the identity, T ′
R is also elliptic in GR. When one replaces φ by φ′ = Intu ◦ φ and hence γn
by γ′
n = uγnu−1, for the corresponding cocharacter µ′ of T ′ and the homomorphism ψT ′,µ′, we have
ψT ′,µ′ = φ′ on the kernel. Furthermore, since

u−1ι(u) = αι = α∞

ι = wι(w−1)

for ι ∈ Gal(C/R), one has that uw ∈ Gsc(R) and µ′ = Intu(µ) = µh′ for h′ := Int(uw)(h) ∈ X.
This establishes the ﬁrst claim (existence of a transfer of maximal torus Intg′ : T ֒→ G with the
property (i)).
Next, when we assume that TQl is elliptic for some l 6= p, by Lemma 4.2.7, we may choose
α ∈ Z 1(Q, T sc) such that it maps to α∞ ∈ H 1(Q∞, T sc) and to zero in H 1(Qp, T sc). Then, by
repeating the argument above, we ﬁnd u ∈ Gsc(Q) such that αρ = u−1ρ(u) for all ρ ∈ Gal(Q/Q).
As α|Gal/Qp/Qp) is trivial, there exists x ∈ T (Qp) such that xρ(x−1) = αρ = u−1ρ(u) for all
ρ ∈ Gal(Qp/Qp), in other words. y := ux ∈ G(Qp). But, the homomorphism Intu : TQp → T ′
also
equals Intu = Inty; in particular, it is deﬁned over Qp. This proves (ii) and ﬁnishes the proof of
Lemma 4.2.6.

Qp

4.2.8 Proof of Proposition 4.1.5. We proceed in parallel with the arguments on p.181,
line 1-19 of [LR87]. By Lemma 4.2.4 and Lemma 4.2.6, after some transfer of tori (always with
respect to the identity inner twist IdG) whose restriction to the torus becomes a conjugation by an
element of G(Qp) when TQl is elliptic in GQl for some l 6= p, we may assume that φ coincide with

51

/
/
/
/
O
O
?

O
O
O
O
✤
/

O
O
+
i ◦ ψT,µh on the kernel for some h ∈ X factoring through TR. Then, one readily checks that the
map Gal(Q/Q) → T (Q) : ρ 7→ bρ deﬁned by

φ(qρ) = bρi ◦ ψT,µh(qρ)

is a cocycle, where ρ 7→ qρ is the chosen section to the projection P → Gal(Q/Q) (Remark 3.2.11).
We claim that its image in H 1(Q, G) under the natural map H 1(Q, T ) → H 1(Q, G) is trivial. As
before, a diagram helps to visualize the proof:

H 1(Q∞, G′)

7♦♦♦♦♦♦♦♦♦♦♦♦

H 1(Q∞, T )

/ H 1(Q∞, G)

0

=④④④④④④④④④④

0 = b∞
ρ

f (H 1(Q∞, Gder))

H 1(Q, T )

H 1(Q, G)

f (H 1(Q, Gder))

❴
bρ

/ 0

/ b′

ρ = 0

Here, G′ is the inner twist of G by φ (i.e. by the cocycle ρ 7→ gρ ∈ Z 1(Q, G) with φ(qρ) = gρ ⋊ ρ)
and f is the natural map H 1(Q, Gder) → H 1(Q, G). The restriction of [bρ] ∈ H 1(Q, T ) to R = Q∞
is trivial, since it maps to zero in H 1(Q∞, G′) and that map is injective ([LR87, Lemma 5.14]). The
image b′
ρ of bρ under the map H 1(Q, T ) → H 1(Q, G) lies in the image of H 1(Q, Gder) in H 1(Q, G).
But, the Hasse principle holds for such image ([LR87, Lemma 5.13]; this lemma assumes that Gder
is simply connected), so we deduce that b′

ρ ∈ H 1(Q, G) is zero. If

bρ = vρ(v−1),

v ∈ Gsc(Q),

then, Intv−1 : TQ ֒→ GQ is an admissible embedding of maximal torus (with respect to the identity
twisting GQ = GQ), i.e.
are
all deﬁned over Q. One has to check that µ′ is µh′ for some h′ ∈ X. This can be seen as
follows. Since the cohomology class [bσ] ∈ H 1(Q∞, T ) is trivial, there exists t∞ ∈ T (C) such that
∞ ι(t∞) = bι = vι(v−1), which implies that t∞v ∈ G(R). Then,
t−1

the image T ′ := v−1T v and the isomorphism Intv−1 : TQ ֒→ T ′

Q

µ′ = v−1µhv = (t∞v)−1 · µh · (t∞v) = µh′

for h′ := (t∞v)−1 · h · (t∞v) ∈ X.
Finally, by Lemma 4.2.9 below (applied to φ(p) ◦ ζp, i ◦ ψT,µh(p) ◦ ζp), there is x ∈ T (Qp) such
that i ◦ ψT,µh(p) ◦ ζp = x(φ(p) ◦ ζp)x−1 (as Qp/Qp-Galois gerb morphisms Gp → GTQp ). But, as φ
and i ◦ ψT,µh are the same on the kernel P , the two Qp/Qp-Galois gerb morphisms

i ◦ ψT,µh(p), xφ(p)x−1 : P(p) → GTQp

agree on the kernel PQp(Qp). It follows that i◦ ψT,µh(p) and xφ(p)x−1 are equal on the whole P(p).
In other words, the restriction of bρ to Gal(Qp/Qp) is zero:

x−1ρ(x) = bρ = vρ(v−1)

52

*


7
/
?
_
o
o
.

=
✤
/
/
/
O
O
O
O
?
_
o
o
?

O
O
O
O
✤
/
?

O
O
for all ρ ∈ Gal(Qp/Qp), and xv ∈ G(Qp). But, the homomorphism Intv−1 : TQp → T ′
also equals
Intv−1 = Int(xv)−1. It follows from this and the discussion in the beginning of the proof that if the
initial torus T satisﬁes that TQl ⊂ GQl is elliptic at some l 6= p, we may ﬁnd a transfer of maximal
torus Intg′ : T ֒→ G such that Intg′ ◦ φ is special admissible and that Intg′|TQp = Inty|TQp
for some
y ∈ GQp. This completes the proof of Proposition 4.1.5. (cid:3)
Lemma 4.2.9. Let T be a Qp-torus, and for i = 1, 2, θi : Gp → GT a morphism of Qp/Qp-Galois
gerbs. If the restrictions θ∆
i of θi to the kernel D are equal, then θ1 and θ2 are conjugate under
T (Qp).

Qp

1 = θ∆

For this, we may replace each θi by a morphism θur
i

Proof. By conjugating by elements of T (Qp), we may assume that each θi is unramiﬁed; we still
have that θ∆
2 . We claim that this equality implies that θ1 and θ2 are conjugate under T (Qp).
p /Qp-Galois gerbs such
i under T (Qp). To ease the notations, we continue to use
p ) with
2 tells us that cls(θ1) = cls(θ2)

that θi is conjugate to the inﬂation θur
θi for such θur
1 = θ∆
θi(sσ) = bi ⋊ σ. But, according to Lemma 3.2.6, the equality θ∆
in B(TQp), that is, there exists tp ∈ T (L) such that b2 = tpb1σ(t−1
p ).

i . By Lemma 3.2.4, clsTQp (θi) (i = 1, 2) is the σ-conjugacy class of bi ∈ T (Qur

: D → Gur

of Qur

TQp

We will show that there exists xp ∈ T (Qur

p ) with θ2 = Int(xp) ◦ θ1, i.e. such that

θ2(sτ ) = xpθ1(sτ )x−1
p

for all τ ∈ Gal(Qur

p /Qp). The map τ 7→ bτ : Gal(Qur

p /Qp) → T (Qur

p ) deﬁned by

θ2(sτ ) = bτ θ1(sτ )

1 = θ∆

p /Qp), T (Qur

p )) with bσ = b2b−1

is a cocycle in Z 1(Gal(Qur
p ); here, we have to use again
the condition that θ∆
2 . Let hσi be the inﬁnite cyclic group hσi generated by σ (endowed
with discrete topology) and W (L/Qp) the Weil group of continuous automorphisms of L which
ﬁx Qp pointwise and which induce on the residue ﬁeld of L an integral power of the Frobenius
automorphism. The exact sequence 1 → Gal(L/L) → W (L/Qp) → hσi → 1 gives rise, via inﬂation,
to a bijection ([Kot85, (1.8.1)])

1 = tpσ(t−1

B(TQp) = H 1(hσi, T (L))

∼→ H 1(W (L/Qp), T (L)).

(4.2.9.1)

Similarly, the restrictions W (L/Qp) → Gal(Qp/Qp) → Gal(Qur
T (Qur

p ) ֒→ T (Qp) ֒→ T (L) induce (again via inﬂation) maps

p /Qp) combined with the inclusions

H 1(Gal(Qur

p /Qp), T (Qur

p )) ֒→ H 1(Gal(Qp/Qp), T (Qp)) ֒→ H 1(W (L/Qp), T (L)),

which are all injective ([Kot85, (1.8.2)]). The image of our cohomology class [bτ ] ∈ H 1(Gal(Qur
under this composite map is equal to the image under the isomorphism (4.2.9.1) of its restriction
to hσi, hence is trivial. Therefore, its image in H 1(Gal(Qur
p )) is already trivial. Clearly,
this is the claimed statement.

p /Qp), T (Qur

p /Qp), T (Qur

p ))

Proof of Theorem 4.1.3. (1) By [Kis13, Lemma 3.7.7], we may assume that Gder is simply
connected (cf. proof of Thm. 3.7.8 of loc. cit.). We follow the original proof of Satz 5.3, as
explained after statement of Theorem 4.1.3. The ﬁrst step is to replace given φ by a conjugate

53

φ0 = Intg0 ◦ φ (g0 ∈ G(Q)) of it whose restriction to the kernel φ∆
0 : PQ → GQ is deﬁned over Q
(which amounts to that φ0(δn) ∈ G(Q) for all suﬃciently large n ∈ N, [LR87, Lemma 5.5]). This
is Lemma 5.4 of [LR87]. This lemma is a statement just concerned with the restriction φ∆, whose
proof only requires that GQp is quasi-split and does not use the level subgroup at all.

The second step is to ﬁnd a conjugate φ1 = Intg1 ◦ φ0 of φ0 (produced in the ﬁrst step) that
factors through GT1 for some maximal Q-torus T1 (elliptic over R, as usual). As discussed before
(after statement of Prop. 4.1.4), this is shown on p. 176, from line 1 to -5 of loc. cit., and the
arguments given there again do not make any use of the level (hyperspecial) subgroup and thus
carries over to our situation. The basic idea is, in view of Lemma 4.2.1, (2), to ﬁnd a maximal
torus T1 of I = CentG(φ0(δn)) that can transfer to Iφ. (An argument in similar style appears in
the proof of Prop. 4.1.4).

The ﬁnal step is to ﬁnd a conjugate φ : P → GT of φ1 : P → GT1 which becomes a special
admissible morphism i ◦ ψT,µh (for some special Shimura sub-datum (T, h) and the canonical mor-
phism i : GT → GG deﬁned by the inclusion i : T ֒→ G). This is accomplished by successive
admissible embeddings of maximal tori. It begins with showing existence of µ1 ∈ X∗(T1) lying in
the conjugacy class {µh} such that φ1 : P → GT1 coincides with ψT1,µ1 on the kernel of P. This
is done in Lemma 5.11 of loc. cit. This lemma is the only place in the original proof where the
level subgroup is involved in an explicit manner (through non-emptiness of the set Xp(φ)). But, as
stated in our Lemma 4.2.4, it continues to hold for general parahoric subgroup Kp with the new
condition X({µX}, b)Kp 6= ∅. After this, the rest of the proof is the same as the original one. In a
bit more detail, one performs two more admissible embeddings. First, we need to ﬁnd an admis-
sible embedding of maximal torus Intg2 : T1 ֒→ G such that Intg2 ◦ φ1 equals a special admissible
morphism ψT2,µh2
again on the kernel of P (here T2 = Intg2(T1) and (T2, h2) is a special Shimura
sub-datum); the diﬀerence from the previous step is that in the previous step, µ1 did not need to
be µh for some h ∈ X. This is shown in Lemma 5.12 of loc. cit., whose argument we adapted to
prove our Lemma 4.2.6 (which is a reﬁnement of that lemma). Let φ2 := Intg2 ◦ φ1 : P → GT2
be the admissible morphism just obtained. Then, one looks for a (last) admissible embedding of
maximal torus Int(g3) : T2 ֒→ G making ﬁnally Int(g3) ◦ φ2 : P → GIntg3(T2) special admissible.
This is carried out in loc. cit., from after Lemma 5.12 to the rest of the proof of Satz 5.3; this part
of the argument was adapted to prove our Prop. 4.1.5. Now, we see that

(T, φ) := (Intg3(T2), Int(g3) ◦ φ2) = (Int(

3Yi=2

gi)(T1), Int(

3Yi=0

gi) ◦ φ)

is a special admissible morphism which is a conjugate of φ.

(2) This is proved by the same argument from (1) with applying Prop. 4.1.4 in the second step
and then Prop. 4.1.5 in the third step. Note that as explained before, the three properties (i) - (iii)
continue to hold under any transfer of maximal torus. (cid:3)

Lemma 4.2.10. Retain the assumptions of Theorem 4.1.3, and assume that Gder is simply con-
nected. Then, for each admissible pair (φ, ǫ), ǫ ∈ Iφ(Q), one can ﬁnd an equivalent pair (φ′, ǫ′) and
T ′ and h′, such that (φ′, ǫ′) is nested in (T ′, h′).

Proof. In the original setting of [LR87], this is their Lemma 5.23. The proof given in loc. cit. works
in our situation without any signiﬁcant change. Most importantly, the level subgroup Kp enters
the proof only through Lemma 5.11 of [LR87] (which is generalized by our Lemma 4.2.4). Hence

54

here we only give a sketch of proof. We may assume that φ is well-located. It will suﬃce to ﬁnd a
maximal Q-torus T of Iφ containing ǫ (i.e. ǫ ∈ T (Q)) and g ∈ G(Q) such that

GQ

Intg

← GQ ←֓ TQ

∼→ (Iφ)Q
is deﬁned over Q. Here, TQ is regarded as a Q-subgroup of GQ via the inner twisting IQ
(4.1.2.1). Indeed, then T1 := Intg(T ) is a Q-subgroup of CentG(Intg(ǫ)) ⊂ G, and φ1 := Intg ◦ φ
maps into GT1 by Lemma 4.2.1, (1) (applied with (g, T1) in the place of (a, T )). Hence, Intg(ǫ) ∈
Iφ1(Q)∩ T1(Q) = T1(Q) (the equality holds since φ1 maps into GT1). Therefore, we can apply Prop.
4.1.5 to (Intg ◦ φ, Intg(T )) and obtain the desired pair (φ′ = ψT ′,µh′ , T ′) by another admissible
embedding; as ǫ ∈ Intg(T )(Q), we also have ǫ ∈ T ′(Q).
Now, to ﬁnd such torus T ⊂ Iφ and g ∈ G(Q), we choose an element ǫ1 of Iφ(Q)(⊂ G(Q)),
whose centralizers in Iφ, IQ ⊂ GQ are maximal tori of GQ containing ǫ. These centralizers are
then the same (via the inner twisting (4.1.2.1)) which will be our T ; T is a Q-subgroup of Iφ,
but only a Q-subgroup of IQ in general. The conjugacy class of ǫ1 in G(Q) is rational, as I is
an inner form of Iφ. So, according to a variant of Steinberg’s theorem [Kot82, Thm.4.4] (which
with G∗ being
assumes that Gder is simply connected), we can ﬁnd an inner twist ψ : GQ → G∗
quasi-split, such that ǫ∗
is Q-rational, where
1 in G∗. Indeed, if Gφ is the inner twist of G twisted by
T ∗(= ψ(T )) denotes the centralizer of ǫ∗
φ, i.e. deﬁned by Gφ(Q) = {g ∈ G(Q) | gρρ(g)g−1
ρ = g}, where φ(qρ) = gρ ⋊ ρ (so that TQ ⊂ GQ
becomes a Q-torus of Gφ and ǫ1 ∈ Gφ(Q)), the inner twist ψ : GQ
gives rise to an inner twist
1. So the claim follows the easily veriﬁed fact that for an inner
ψφ : (Gφ)Q
twist ψ : H1 → H2 with φ(ǫ1) = ǫ2 for some regular semisimple ǫi ∈ Hi(Q) (i = 1, 2), its restriction
to the centralizers Ii = CentHi(ǫi) becomes a Q-isomorphism. Now, by the proof of [LR87, Lemma
5.23] (more precisely by the argument in the last paragraph on p.190), there exists a transfer of
maximal torus Intg : T ∗ ֒→ G with respect to the inner twist ψ−1, namely

1 = ψ(ǫ1) is rational. This implies that ψ : TQ → T ∗

with ψφ(ǫ1) = ǫ∗

∼→ G∗

Q

Q

Q

∼→ G∗

Q

Intg ◦ ψ−1 : T ∗

Q ֒→ G∗

Q

ψ−1

→ GQ

Intg

→ GQ

is deﬁned over Q; here one uses the assumption that GQp is quasi-split. Therefore, T1 := Intg(T ) =
Intg ◦ ψ−1(T ∗) is a Q-torus of G, and TQ ֒→ GQ
→ GQ is a Q-rational homomorphism (where TQ
is regarded as a Q-subgroup of GQ via the inner twisting (Iφ)Q

∼→ IQ), as we wanted.

Intg

Now, as an application, we establish non-emptiness of Newton strata for general parahoric levels,
when GQp is quasi-split. To talk about the reduction at a prime, we need to choose an integral
model, i.e. a ﬂat model SK over OE℘ with generic ﬁber being the canonical model ShK(G, X)E℘ .
For the following result, it is enough to ﬁx an integral model over OE℘ having the extension property
that every F -point of ShK(G, X) for a ﬁnite extension F of E℘ extends uniquely to SK over its
local ring (for example, a normal integral model); see [KP15] for a construction of such integral
model.

Theorem 4.2.11. Suppose that GQp is quasi-split. Let Kp be a parahoric subgroup of G(Qp) and
K = KpKp for a compact open subgroup Kp of G(Ap

f ).

55

(1) Then, for any [b] ∈ B(GQp,{µX}) (Subsec. 2.1.4), there exists a special Shimura sub-datum
(T, h ∈ Hom(S, TR)∩ X) such that the Newton homomorphism νGQp ([b]) equals the G(L)-conjugacy
class of

1

[Kv2 : Qp]

NmKv2 /Qpµh

(∈ X∗(T )Q),

where Kv2 ⊂ Qp is any ﬁnite extension of Qp splitting T .
point [h, gf · K] ∈ ShK(G, X)(Q) has the F -isocrystal represented by

In particular, if (G, X) is of Hodge type, for gf ∈ G(Af ), the reduction in SK⊗ ¯Fp of the special

NmKv2 /K0(µh(π)),

where K0 ⊂ Kv2 is the maximal unramiﬁed subextension and π is a uniformizer of Kv2 .
(2) Suppose that Kp is special maximal parahoric. Moreover, assume that G splits over a tamely
ramiﬁed cyclic extension of Qp and is of classical Lie type. Then, one can choose a special Shimura
datum (T, h ∈ Hom(S, TR) ∩ X) as in (1) such that furthermore the unique parahoric subgroup of
T (Qp) is contained in Kp.
(3) Suppose that (G, X) is a Shimura datum of Hodge type. Then the reduction SK(G, X)⊗ ¯Fp

has non-empty ordinary locus if and only if ℘ has absolute height one (i.e. E(G, X)℘ = Qp).

Proof. (1) We follow the strategy of our proof of the corresponding result in the hyperspecial case
given in [Lee14], Thm. 4.1.1 and Thm. 4.3.1. Let [b] ∈ B(GQp,{µ}). Since GQp is quasi-split,
there exist a representative b ∈ G(L) of [b] and a maximal torus Tp of GQp such that the Newton
homomorphism νb : D → GQur
is Qp-rational and factors through Tp ([Kot86, Prop. 6.2]). By the
argument of Step 1 in the proof of [Lee14], Thm. 4.1.1, we may further assume that Tp = (T0)Qp
for a maximal Q-torus T0 of G such that (T0)Qv ⊂ GQv is elliptic maximal for v = ∞ and some
prime v = l 6= p. Then, Lemma 4.2.4 tells us that there exists µ′ ∈ X∗(T0) ∩ {µ} such that the
relation (4.2.4.1) holds in X∗(T0):

p

NmKv2 /Qpµ′ = [Kv2 : Qp] νb,

where K is a ﬁnite Galois extension of Q splitting T0 and v2 is the place of K induced by the
pre-chosen embedding Q ֒→ Qp (here, the sign is correct by Lemma 3.2.6). Next, by the argument
of Step 2 in loc. cit. (which corresponds to that of Lemma 4.2.6), we can ﬁnd a transfer of maximal
torus Intu : T0 ֒→ G such that Intu(µ′) = µh for some h ∈ X ∩ Hom(S, TR), where T = Intu(T0)
= Inty for some y ∈ G(Qp).
(again, be wary of the sign diﬀerence from [Lee14]), and that Intu|(T0)Qp
By the latter property, for (T, µh, Intu(b)) we still have that

NmKv2 /Qpµh = [Kv2 : Qp] νybσ(y)−1

(here, NmKv2 /Qp is taken on X∗(T )). This proves the ﬁrst statement of (1). According to Lemma
3.3.9 and [RR96, Thm. 1.15], the element of T (L)

bT := NmKv2 /K0(µh(π))

[Kv2 :Qp] NmKv2 /Qpµh = νybσ(y)−1 . As κTQp (bT ) = µ♮ ∈
has the Newton homomorphism νbT =
X∗(T )Gal(Qp/Qp) and (ν, κ) : B(GQp) → N (GQp) × π1(G)Gal(Qp/Qp) is injective ([Kot97, 4.13]), we

1

56

see the equality of isocrystals [b] = [bT ] ∈ B(GQp). Given this, the second statement is proved in
the same fashion as in the hyperspecial case, using [Lee14, Lem. 3.24].
(2) Let (T1, h1) be a special Shimura sub-datum produced in (1). Thanks to our additional
assumptions and Prop. B.0.6, in its construction, we could have started with a maximal torus Tp
of GQp such that the unique parahoric subgroup of Tp(Qp) is contained in a G(Qp)-conjugate of
Kp. Then, also by the ﬁne property of our methods (it uses only transfers of maximal tori which
become conjugacy by G(Qp)-elements), the torus T1 produced in (1) can be assumed to further
satisfy that the unique parahoric subgroup of T1(Qp) is contained in gpKpg−1
for some gp ∈ G(Qp).
As GQp splits over a cyclic extension of Qp, G(Q) is dense in G(Qp) by a theorem of Sansuc ([Mil94,
Lem. 4.10]), thus there exists g0 ∈ G(Q) ∩ Kp · g−1
p . Then, one easily checks that the new special
Shimura datum (T, h) := Int(g0)(T1, h1) satisﬁes the required properties.

p

(3) Again. the proof is the same as that in the hyperspecial case given in [Lee14, Cor. 4.3.2].
In more detail, as was observed in loc. cit., it suﬃces to construct a special Shimura sub-datum
(T,{h}) with the property that there exists a Qp-Borel subgroup B of GQp containing TQp such
that µh ∈ X∗(T ) lies in the closed Weyl chamber determined by (TQp, B). Indeed, then we have
E(T, h)p = E(G, X)℘, where p and ℘ denote respectively the places of each reﬂex ﬁeld induced by
the given embedding Q ֒→ Qp. We remark that this is the property (ii) found in the proof of loc.
cit., and for our conclusion one does not really need the property (i) from it. But, since GQp is
quasi-split, there exists a Borel subgroup B′ deﬁned over Qp. Moreover, by the same argument as
was used in (1) (i.e. Step 1 in the proof of [Lee14, Thm. 4.1.1]), we may assume that B contains
Qp for a maximal Q-torus T ′ of G such that T ′
T ′
Qv ⊂ GQv is elliptic for v = ∞ and some prime
v = l 6= p. Let µ′ ∈ {µX}∩ X∗(T ′) be the cocharacter lying in the closed Weyl chamber determined
, B′). Then, the argument in (1) again produces a special Shimura sub-datum (T,{h}) such
by (T ′
Qp
that (T, µh) = Inty(T ′, µh′) for some y ∈ G(Qp), and (T,{h}) is the looked-for special Shimura
sub-datum. Note that as we do not need the property (i) in the original proof of [Lee14, Thm.
4.1.1], the condition in (2) on splitting of GQp is no longer necessary.

Remark 4.2.12. (1) For more on the Newton stratiﬁcation, we refer to the recent survey article
[Vie15].

(2) As is obvious from the proof, the assumption that G splits over a tamely ramiﬁed (not
necessarily cyclic) extension of Qp and is of classical Lie type and the one that GQp splits over a
cyclic extension of Qp are needed only to invoke, respectively, Prop. B.0.6 and the fact that G(Q)
is dense in G(Qp). Therefore, any weaker assumption guaranteeing those facts could be used in
their places. On the other hand, when (G, X) is of abelian type, G is always of classical Lie type.

5 Admissible pairs and Kottwitz triples

Here. again our running assumption is that GQp is quasi-split. Otherwise, please refer to each
statement for precise assumptions made there.

Proposition 5.0.13. Assume that GQp is quasi-split. Let (φ, γ0) be an admissible pair that is
well-located in a maximal Q-torus T of G which is elliptic over R and such that the image of γ0
in Gad(Ap
in a compact open subgroup of
T /Z(G)(Ap

f ) lies in a compact open subgroup of Gad(Ap
f ) (equiv.
f )). Suppose that (φ, γ0) is of level n (cf. Def. 3.6.1).

57

of G.

(1) For suﬃciently large k ∈ N divisible by n, the element φ(δk)· γ
(2) Suppose further that φ = i ◦ ψT,µh for some h ∈ Hom(S, TR) ∩ X and let K ⊃ Qp be a ﬁnite
Galois extension splitting TQp. If H is the centralizer in GQp of the maximal Qp-spit torus A in
the center of CentG(γ0)Qp, then NmK/Qpµh maps into the center of H (which equals A).

of G(Q) lies in the center

− k
n
0

(3) Assume that the weight homomorphism wX = µh · ι(µh) (h ∈ X) is rational. If γ0 is a
Weil q = pn-number of weight w = wX, in the sense that for every character χ of T , χ(γ0) ∈ Q is
a Weil q = pn-number of weight hχ, wXi ∈ Z in the usual sense, then γ
0 = φ(δk) for suﬃciently
large k ∈ N.

(4) If the anisotropic kernel of Z(G) remains anisotropic over R and γ0 ∈ G(Ap

f ) lies in a

k
n

f ), then γ

0 = φ(δk) for suﬃciently large k ∈ N.

compact open subgroup of G(Ap

k
n

Proof. The ﬁrst statement (1) is asserted in [LR87], p.194 (line -8) - p.195 (line 12) with a sketchy
proof. Here we will give a detailed proof. To show the proposition, we need a fact which was stated
in [LR87], p.195, line 5-9, but without an explanation:
Lemma 5.0.14. (1) For an admissible morphism φ : P → GG well-located in a maximal Q-torus
T of G, elliptic over R, let ξ′
be an unramiﬁed conjugate of ξp = φ(p) ◦ ζp under
T (Qp), and b ∈ T (k) be deﬁned by ξ′
p(sσ) = b ⋊ σ. Then, the two Newton homomorphisms νφ(δk),
νb ∈ X∗(T )
such that NmLn/Qpδ = cǫc−1 for some c ∈ G(Qur
b′ := c−1δσ(c) belongs to G(ǫ)(Qur
are related by: νǫ = nνb′.

(2) Let ǫ ∈ TQp(Qp) for a maximal Qp-torus TQp of GQp and suppose there exists a δ ∈ G(Ln)
p ), where Ln = Frac(W (Fpn)); it follows that
GalQp
Q

p ). Then, the two Newton homomorphisms νǫ, νb′ ∈ X∗(T )

attached to φ(δk), b are related by: νφ(δk) = kνb.

p : D → Gur

GalQp
Q

TQp

(3) If (φ, ǫ ∈ Iφ(Q)) is an admissible pair well-located in a maximal Q-torus T of G that is

elliptic over R, the two Newton homomorphisms νb, νb′ in (1) and (2) are the same: νb = νb′.

For (1), recall that for an admissible morphism φ : P → GG factoring through GT for a maximal
p under T (Qp) of ξp = φ(p) ◦ ζp,
p is a

Q-torus T of G, b ∈ T (k) deﬁned by an unramiﬁed conjugate ξ′
its Newton homomorphism νb ∈ X∗(T )Γ(p)
Q
conjugate of ξp by an element of T (Qp)).
Proof. (1) Recall that if φ : P(L, m) → GT for some CM ﬁeld L Galois over Q and m ∈ N, for
λ ∈ X ∗(T ), the Q-character λ ◦ φ∆ is also a Weil pm-number π, in which case when we write
χπ := λ ◦ φ∆, we have χπ(δk) = π
m for every k ∈ N divisible by m. Next, when we regard any
λ ∈ X ∗(TQp)GalQp as a Q-character of T via the chosen embedding ιp : Q ֒→ Qp,

does not depend on the choice of ξ′

p (as long as ξ′

k

p

= |λ(φ(δk))|w = |χπ(δk)|w = |π|

|λ(φ(δk))|[Kw:Qp]
where ξ∆
p = φ(p)∆ ◦ ν2 and w is the place of K induced by ιp. (Notice that λ can be considered as
a Qp-character in the ﬁrst three expressions, while the 3rd equality makes sense only when χπ is a
GalQp
Q-character.) This shows ([Kot85, 2.8, 4.4]) that the Newton homomorphism νφ(δk) ∈ X∗(T )
Q
attached to φ(δk) ∈ T (Qp) is − k

w = pkν2(π,w) = pkhχπ,ν2i = pkhλ,ξ∆
p i,

[Kw:Qp] ξ∆
p .

k
m

58

On the other hand, if ξ′
p factors through Dn, the Newton homomorphism νb attached to b is
p)−1|Gm (Lemma 3.2.6, cf. [LR87], Anmerkung). In our case, we may assume that n = [Kw : Qp],
p)∆ = (ξp)∆ (restriction to the kernel
p , which proves the claim.
(2) This is proved in Lemma 5.15 of [LR87]. We brieﬂy sketch its arguments. First, we observe
(c) lies in any small neighborhood of 1 as n′ becomes
for the Newton

1
n (ξ′
by Remark 3.2.11, (2) and Lemma 3.2.4, (2). Also, we have (ξ′
∆ of Dn) as φ∆ maps to the torus T . Therefore, we get νb = − 1
that for any c ∈ G(k) and n′ ∈ N , cn′ := c−1σn′
large (in fact, even becomes 1 if c ∈ G(Qur
(quasi-)cocharacter νǫ of ǫ ∈ TQp(Qp) so that

p )). Secondly, set ν1 := 1

n νǫ ∈ X∗(T )

[Kw:Qp] ξ∆

GalQp
Q

|λ(ǫ)|p = p−hλ,nν1i

holds for every Qp-rational λ ∈ X∗(T ) ([Kot85, 4.4]). It follows from this equation that ν1 maps into
the center of G(ǫ) and that p−nν1ǫ ∈ TQp(Qp) lies in the maximal compact subgroup of TQp(Qp).
Especially, (p−nν1ǫ)k also lies in any small neighborhood of 1 as k becomes large. Therefore,
according to [Gre63, Prop. 3], for suﬃciently large k ∈ N, there exists d ∈ G(k) such that with
n′ = nk,

ǫkcn′ = pn′ν1d−1σn′
p admits a smooth OQur

(d).

Here, we used the fact that GQur
(e.g. parahoric group schemes, cf.
that b′ := c−1δσ(c) and cn′ = c−1σn′

p -integral model with connected special ﬁber
[HR08]). Finally, from NmLn/Qpδ = cǫc−1, one easily checks
(c) belong to G(ǫ)(Qur

p ), and the equality

NmLn′ /Qpb′ = ǫkcn′(= pn′ν1d−1σn′

(d))

holds. Therefore, the deﬁnition ([Kot85, 4.3]) tells us that the Newton homomorphism νb′ ∈
Homk(D, G) of b′ is equal to ν1.

(3) This follows from Remark 3.6.6.

Proof of Proposition 5.0.13 continued. (1) As δkd = δd

k, it is enough to show that for
in Gad(Q) is a torsion element. For that, we
some k ∈ N (divisible by n), the image of φ(δk) · γ
use the fact that for any linear algebraic group G over a number ﬁeld F , G(F ) is discrete in G(AF ),
so for any compact subgroup K ⊂ G(AF ), G(F ) ∩ K will be ﬁnite, particularly, a torsion group.
in T /Z(G)(Qv) lies in a compact (open) subgroup of
We will check that the image of φ(δk) · γ
T /Z(G)(Qv) for every place v of Q. Recall that for an F -torus T and any ﬁnite place v of F , a
subgroup H of T (Fv) is compact if and only if H is contained in

− k
n
0

− k
n
0

\

χ∈X ∗(T ), Fv−rational

Ker(valv ◦ χ),

where valv is the (normalized) valuation on Fv. For every ﬁnite place l 6= p, the image of γ0 in
T /Z(G)(Ql) is a unit (i.e. lies in a compact subgroup) by assumption, and so is φ(δk) by deﬁnition
of δk (in fact, φ(δk) is itself a unit in T (Ql) for every l 6= p). As T /Z(G) is anisotropic over R,
the claim is trivial for the archimedean place. Hence, it suﬃces to show that for every Qp-rational
0 )|p. In fact, we will show this for Qp-rational characters
character χ of T /Z(G), |χ(φ(δk))|p = |χ(γ
χ of T . Choose a ﬁnite Galois CM-extension L of Q and m ∈ N such that φ factors through P(L, m).

k
n

59

Then, for all suﬃciently large k ∈ N divisible by [L : Q]n and for any Qp-rational character χ of T ,
one has

|χ(φ(δk))|p = p−khχ,νbi = p− k

n hχ,nνb′ i = p− k

n hχ,νγ0 i = |χ(γ0)|

k
n
p .

Here, the ﬁrst (resp. the second, and the third) equality holds by Prop. 5.0.14, (1) (resp. (3), and
(2)).

(2) After enlarging K, if necessary, the Galois Qp/Qp-gerb morphisms ξp := ψT,µh(p) ◦ ζp,
−µ)∆ =
ξ−µ : Gp → GTQp factor through GK
−NmK/Qpµh. By (1), the centralizer CentG(γ0) equals that of φ(δk) ∈ T (Q) which is in turn
equal to the centralizer CentG(φ∆) of φ∆ (as {δn
k}n∈N is Zariski-dense in P ). But, obviously
p maps into a Qp-split torus in Im(φ∆)Qp, thus a posteriori
−NmK/Qpµh = (φ(p)◦ζp)∆ = (φ∆)Qp ◦ζ ∆
into a Qp-split torus in the center of CentG(φ∆)Qp, from which the claim follows.

p , and ξp is conjugate to ξK

−µ under T (Qp), so ξ∆

p = (ξK

(3) The additional assumption tells us that |χ(φ(δk))|∞ = |χ(γ

character χ of T , and also implies that γ0 ∈ G(Ap
Hence, by the argument of (1), φ(δk) · γ
(4) It is well-known that the stated condition implies that for any maximal Q-torus T0 of G,
elliptic over R, T0(Q) is discrete in T0(Af ); this is the condition what Kisin called the Serre condition
for T0, [Kis13, (3.7.3)]. Then, again we resort to the argument of (1).

− k
0 ∈ G(Q) is a torsion element.
n

0 )|∞ for every Q∞-rational
f ) itself lies in a compact open subgroup of G(Ap
f ).

k
n

Lemma 5.0.15. Let γ0, γ′

0 ∈ G(Q) be semi-simple elements.

0 is so.

(2) If γ′

0, T ′, µ′) := Intg(γ0, T, µ).

(1) If there exists a transfer of maximal tori Intg : T ֒→ G such that γ0 ∈ T (Q) and γ′

0 =
Intg(γ0), then the condition (∗(γ0)) in Subsec. 3.5.1 holds for (γ0, T ) and some µ ∈ X∗(T ) ∩ {µX}
if and only if it holds for (γ′
0 := Intg(γ0) for some g ∈ G(Q), for any place v of Q, the image of γ0 in Gad(Ql) lies

in a compact open subgroup of Gad(Ql) if and only if γ′
Proof. (1) Let K ⊃ Qp be a splitting ﬁeld of TQp (and thus of T ′
Qp ≈ TQp too). Then, using
∼→ T ′ is a Q-isomorphism, we see that Intg(NmK/Qpµ) = NmK/Qpµ′, which implies
that Intg : T
that NmK/Qpµ maps into the center of CentG(γ0) if and only if NmK/Qpµ′ does so for CentG(γ′
0).
Next, let H be the centralizer of the maximal Qp-split subtorus of the center of CentG(ǫ)Qp and
H ′ the similarly deﬁned group for γ′
0. Since H der is simply connected, λH (γ0) = λH ab(γ0), so
λH(γ0) = [K : Qp]µ if and only if λH ab (γ0) = [K : Qp]µ, where the latter µ is the image of µ
in X∗(H ab). But, Intg : CentG(γ0)Q
0)Q restricts to a Q-isomorphism between their
centers (as they are contained in T and T ′, respectively), so also induces a Qp-isomorphism between
the maximal Qp-split subtori of their base-change to Qp. Hence, Intg : HQp
and this induces
a Qp-isomorphism H ab = H/H der ∼→ H ′ab = H ′/H ′der. Clearly, this proves the claim.
0, respectively. Then, the Q-
∼→ P ′, thus if the image of γ0 in
isomorphism Intg : GQ
Gad(Ql) lies in a compact open subgroup of Gad(Ql), then as it also lies in a compact open subgroup
of Q(Ql), where Q is the image of P in Gad, the same property holds for γ′
0.

(2) Let P and P ′ be the Q-subgroups of G generated by γ0, γ′

∼→ GQ restricts to a Q-isomorphism P

∼→ CentG(γ′

∼→ H ′

Qp

Theorem 5.0.16. Suppose that GQp is quasi-split and tamely ramiﬁed, G is of classical Lie type
with simply connected Gder, and that the Serre condition for (G, X) holds. Let Kp be special
maximal parahoric.

60

(1) Let ǫ ∈ G(Q) be a rational element, elliptic over R, and whose image in Gad(Ql) lies in
a compact open subgroup of Gad(Ql) for every ﬁnite place l 6= p.
If there exists an admissible
morphism φ making (φ, ǫ) an admissible pair, then the stable conjugacy class of ǫ contains an
element γ0 ∈ G(Q) which satisﬁes the condition (∗(γ0)) of Subsec. 3.5.1 with the same level as
(φ, ǫ).
Conversely, if γ0 ∈ G(Q) satisﬁes the condition (∗(γ0)) (especially, γ0 is elliptic over R), there
exists an admissible pair (φ, ǫ) with ǫ stably conjugate to γ0. In fact, we can also ﬁnd a Kp-eﬀective
admissible pair (φ, ǫ) with ǫ stably conjugate to γt

0 for some t ∈ N (cf. Remark 3.6.2).

(2) Suppose that γ0 ∈ G(Q) is elliptic over R and that there exists δ ∈ G(Ln) such that cγ0c−1 =
NmLn/Qp(δ) for some c ∈ G(Qp) and X(δ,{µX})Kp 6= ∅. Then, the condition (∗(γ0)) of Subsec.
3.5.1 holds with level n = m[κ(℘) : Fp]. In particular, there exists an admissible pair (φ, ǫ) with ǫ
stably conjugate to γ0.

The claim (1) in the hyperspecial level case is Satz 5.21 of [LR87], except for two diﬀerences:
in the original theorem, there is no condition on ǫ ∈ Gad(Ap
f ) and a condition (denoted by (∗(ǫ)))
diﬀerent from our condition (∗(γ0)) here is used (cf. Remark 3.5.4, (2)). However, the proof
(especially, of the second implication) given in loc. cit. based on that condition seemed to us to
be incomplete: see Footnotes 14, 15, 16, and 17 for explanation of the points that we believe to
be gaps. On the other hand, hopefully the claim (2) (which is due to us) and thm. 5.1.1 (which
follows from it) should justify the introduction of the new condition, cf. Remark 5.1.2. Also, we
remark that the main point of the condition (∗(ǫ)) in the original work [LR87] was Satz 5.21, which
corresponds to this theorem.

Proof. To a large extent, we follow the original strategy, but using our condition (∗(γ0)) (instead
of the original one (∗(ǫ))) as well as some of those facts that were established in our general setting
of (special maximal) parhoric level, especially Prop. B.0.6 and Lemma 3.3.9.
Before entering into the proof, we discuss an explicit expression of the Frobenius automorphism
Φ = F n attached to a special admissible morphism. Let φ = i ◦ ψT,µh be a special admissible
morphism, where (T, h) is a special Shimura sub-datum and i : GT → GG is as usual the canonical
morphism induced by the inclusion T ֒→ G. Put ξp := φ(p) ◦ ζp; so ξp and ξ−µh are conjugate
under T (Qp) (and in particular, ξ∆
p ) of (the image of)
ξ∆
p : D → GQp is a quasi-split Qp-Levi subgroup of GQp. Suppose given an elliptic maximal torus
T ′ of J. We choose j ∈ J ′(Qp) with T ′ = Int(j)(TQp ), and set
µ′ := Int(j)(µh) ∈ X∗(T ′).

−µh). The centralizer J = CentGQp (ξ∆

p = ξ∆

Let K be a ﬁnite Galois extension of Qp splitting T ′, π a uniformizer of K, and K0 the maximal
unramiﬁed subextension of K. We take K to be big enough such that there exists a ﬁnite Galois
extension Kh of the same degree (over Qp) as K and splitting T . Note that in doing so, we can
always assume K to be an unramiﬁed extension of the splitting ﬁled of T ′. If K1 is the composite
of K and Ls with s = [K : Qp] and ξK1
p , according to Lemma 3.3.9,
there exists tp ∈ T ′(Qp) such that Int(tp)(ξK1
−µ′) is an unramiﬁed morphism mapping into GT ′ and
factors through GLs
p → GTQp denotes the
induced unramiﬁed Galois Qp/Qp-gerb morphism,

p . Moreover, we can choose tp further such that if ξ′

−µ′ is the pull-back of ξK

−µ′ to GK1

p : GLs

ξ′
p(sLs

σ ) = NmK/K0(µ′(π)) ⋊ σ.

61

From now on, we write ξ−µh, ξ−µ′ for ξKh
put

−µh, ξK

−µ′, respectively. In this set-up, we note that if we

(Qp-rational cocharacter of T ′), there holds the equality:

ν′
p := −NmK/Qpµ′

ν′
p = −NmKh/Qpµh.

(5.0.16.1)

This was already noted in our proof of Lemma 3.3.10. Indeed, ﬁrst we see that they both map
into the center of J: for NmKh/Qpµh, this is by deﬁnition of J (and as −NmKh/Qpµh = (ξKh
−µh)∆ =
p = −NmK/Qpµ′ maps into a Qp-split sub-torus of the elliptic maximal torus
(φ(p) ◦ ζp)∆), while ν′
T ′ of J, so factors through the center. But, also their projections into J ab = J/J der are the same,
as µ′ and µh are conjugate under J(Qp) and J ab is Qp-split (and since [K : Qp] = [Kh : Qp]).
Clearly this proves the claim.

Next, let [K : K0] = eK , [K0 : Qp] = fK. For any j ∈ N, if it is divisible by [K : Qp] = eK fK,

say j = t′[K : Qp], we have the following expression for F j in terms of ν′
p:

F j = (NmK/K0(µ′(π)) ⋊ σ)j = NmK/Qp(µ′(πeK ))t′

⋊ σj

(5.0.16.2)

= (pNmK/Qp µ′
p · ut′
= p−t′ν′

0 ⋊ σj

· NmK/Qp(µ′(u)))t′

⋊ σj

where πeK = pu for u ∈ O×

K and

u0 := NmK/Qp(µ′(u)).

A priori, u0 ∈ T ′(Qp)0(= Ker(vT ′
) ∩ T ′(Qp)) (maximal compact subgroup of T ′(Qp)), but in fact
it belongs to T ′(Qp)1(= Ker(wT ′
) ∩ T ′(Qp)). To see that, by funtoriality for tori T endowed
with a cocharacter µ ∈ X∗(T ), we can take T ′ = ResK/QpGm and µ′ = µK, the cocharacter of
K = GHom(K,K)
T ′
corresponding to the identity embedding K ֒→ K. But in this case, X∗(T ′) is an
induced Gal(K/Qp)-module, so wT ′

= vT ′

m

L

L

, and clearly u0 ∈ KervT ′

L

.

L

L

(1) Let us turn to the proof and ﬁrst establish the necessity of the condition (∗(γ0)). By a
suitable transfer of maximal tori (Lemma 4.2.10), we may assume that the admissible pair (φ, ǫ)
is nested in some Shimura sub-datum (T, h), i.e. φ = i ◦ ψT,µh and ǫ ∈ T (Q). We will verify the
condition (∗(γ0)) for (γ0 := ǫ, T, µh). First, according to Lemma 5.0.15, (2), this new ǫ still satisﬁes
the assumption, i.e. its image in T /Z(G)(Ql) is a unit (i.e.
lies in a compact open subgroup) for
every (ﬁnite) place l 6= p. Therefore, if K splits T , by Prop. 5.0.13, (2), NmK/Qpµh maps into the
center of CentG(ǫ). For the special admissible morphism φ = i ◦ ψT,µh, let ξp, J, T ′, µ′, ξ′
p, ... be
deﬁned as discussed in the beginning of the proof. It was shown in the proof of Lemma 3.3.10 (using
that T ′ ⊂ J is elliptic) that the two Galois Qp/Qp-gerb morphisms ξ−µh, ξ−µ′ are conjugate under
J(Qp). So, since ξp = i ◦ ψT,µh ◦ ζp and ξ−µh are conjugate under T (Qp), there exists v ∈ J(Qp)
such that

Int(v)(ξp) = ξ′

p(= Int(tp)(ξ−µ′)).

Moreover, we could choose v such that T ′ = Int(v)(TQp) (so that ǫ′ ∈ T ′(Qur
p )). Indeed, pick an
arbitrary v1 ∈ J(Qp) with this property. Here, we used the condition that ν′
p = −NmKh/Qpµh maps
into the center of CentG(ǫ)Qp, since then (T ⊂)H ⊂ J. By Lemma 4.2.9, we just need to show

62

that Int(v1)(ξp)∆ = (ξ′
−NmKh/Qpµh = −NmK/Qpµ′(= ξ∆

p)∆(= ξ∆

−µ′). But, Int(v1)(ξp)∆ = Int(v1)(ξ∆

−µ′) by (5.0.16.1). Using such v, we set

p ) = Int(v1)(−NmKh/Qpµh) =

ǫ′ := Int(v)(ǫ).

p ): a priori, this is only an element of T ′(Qp), but since it commutes

p = Int(v)(ξp), it belongs to T ′(Qur

p ).

This is an element of T ′(Qur
with an unramiﬁed morphism ξ′

Now, by deﬁnition of admissible pair, there exists x ∈ G(L)/ ˜Kp such that ǫ′x = Φmx. But then
(ǫ′)tx = Φtmx for every t ∈ Z, since ǫ′ commutes with Φ = F r (as ǫ commutes with ξp = φ(p) ◦ ζp).
Hence, for suﬃciently large t ∈ N such that trm is divisible by eKfK, say trm = t′[K : Qp], if
k ∈ G(L) is deﬁned by that k ⋊ σtn = (ǫ′)−tΦtm, i.e.
k = (ǫ′)−t · NmK/Qp(µ′(π))eK t′

= (ǫ′)−t · p−t′ν′

p · ut′
0 ,

(5.0.16.3)

k lies in the special maximal bounded subgroup Stab(x) of G(L). Moreover, k ∈ T ′(L) as both ǫ′
and NmK/Qp(µ′(π)) are so. Therefore, k lies in the maximal bounded subgroup T ′(L)0 = Ker(vT ′
)
of T ′(L), and so is ǫ′−t · p−t′ν′
.14 Since Int(v′) is an L-isomorphism from HL to its image
H ′ which must contain T ′, and v′ ∈ J(Qp) = CentGQp (ν′
p = v′−1(ǫ′−t · p−t′ν′

p) (5.0.16.1), it follows that

p)v′ ∈ Ker(vHL),

p = k · u−t′

ǫ−t · p−t′ν′

(5.0.16.4)

0

L

that is, λH(ǫ−t · p−t′ν′
trivial, i.e. π1(H)I = π1(H) = X∗(H ab) (H ab splits over Qp), we see that

p) = 0. Hence, noting that the canonical Γ(p)-action on π1(H) = X∗(H ab) is

tλH(ǫ) = λH (ǫt)

(5.0.16.4)

=

λH(p−t′ν′
p)

(5.0.16.1)

=

λH(pt′ PK/Qp µ′

) = t′NmK/Qpµ′ = tnµ′,

Here, as usual for a maximal torus T of H and x ∈ X∗(T ), x denotes the image of x in π1(H)GalQur
π1(H).15

p

=

Next, assume that γ0 ∈ G(Q) satisﬁes the two conditions in the statement of the theorem:
There exists a maximal Q-torus T0 of CentG(γ0) that is elliptic at R, and a cocharacter µ0 of T0
that satisﬁes the condition (∗(γ0)) of Subsec. 3.5.1 (with some level n divisible by [κ(℘) : Fp]).
Then, with such choice, one applies Lemma 4.2.6 (or Lemma 5.12 of [LR87]) to ﬁnd an admissible
embedding of maximal torus Intg0 : T0 ֒→ G such that Intg0◦i◦ψT0,µ0 equals i◦ψT,µh for some special
Shimura sub-datum (T, h). By Lemma 5.0.15, the condition (∗(γ0)) continues to hold for (ǫ :=
Intg0(γ0), T, µh). Now, we check that for the resulting pair (φ, ǫ ∈ Iφ(Q)) = (i ◦ ψT,µh, Intg0(γ0)),
14Noe that this is a consequence of our assumption that ν ′
p = −NmKh/Qp µh maps into the center of CentG(ǫ)Qp .
p ) = 0 for H ′ := v′(HL)v′−1. On the
Without such additional condition, it seems not clear whether vH ′ ((ǫ′)−t
other hand, in the original proof, Langlands and Rapoport deduce this condition by appealing to uniqueness of “a
kind of polar decomposition” (ǫ′)t = p−t′ν ′
p · k−1 in (5.0.16.3) (in the hyperspecial case, u0 = 1). By this they must
mean a Cartan decomposition for CentGL (ǫ′) (since ν ′
p is wanted to map into its center), which needs that k lies in
a special maximal bounded subgroup of CentGL (ǫ′)(L). But, this seems not quite obvious either: one only knows
that k lies in some maximal bounded subgroup of CentGL (ǫ′)(L). Since vH ′ vanishes on special maximal bounded
subgroups (Lemma 3.6.4), hence we see that the condition in question is in fact “equivalent” to the property we need.
15In [LR87, p.192, line 3-6], Langlands and Rapoport take up a G(Qp)-conjugate µ′′ of µ′ (equiv. of µh) factoring
through H and deﬁned over Ln (which exists, according to the deﬁnition of the reﬂex ﬁeld and [Kot84b, Lemma
. But this equality is questionable, since µ′ and µ′′ may not be conjugate
1.1.3]) and insist that µ′
under H. Fortunately, for our main application of the theorem at hand, this property does not play a signiﬁcant role.

· p−t′ν ′

= µ′′

π1(H)

π1(H)

63

p -split Qur

p -torus of gHQur

Qur
p

(φ, ǫt) is Kp-eﬀective admissible for some t ∈ N and admissible with t = 1 (Def. 3.6.1, Remark
3.6.2). As we are working with special maximal parahoric Kp, by Lemma 3.3.10, φ := Intg0◦i◦ψT,µh
is admissible. The condition (2) is obvious. So, it remains to establish the condition (3).
As H is a quasi-split Qp-Levi subgroup of GQp, there exists a G(Qp)-conjugate gH := Intg(H)
(g ∈ G(Qp)) of H such that gH(Qp) ∩ Kp is a special maximal parahoric subgroup of gH(Qp)
(Lemma 4.2.3, cf. proof of Lemma 3.3.10). Then, we apply Prop. B.0.6 to gH(Qp) ∩ Kg
p and
choose an elliptic maximal Qp-torus T ′ of gH such that T ′
contains (equiv. is the centralizer of)
p and that the (unique) parahoric subgroup T ′(L)1 of T ′(L)
a maximal Qur
is contained in T ′(L) ∩ ˜Kp (as usual, ˜Kp being the parahoric subgroup of G(L) corresponding
to Kp); in fact, T ′(L)1 = T ′(L) ∩ Kp. So, we are in the situation discussed in the beginning
of the proof. Let µ′, ξ′
p, K, K0, Kh, ... be deﬁned as before, except for the following changes,
caused by that T ′ is now an elliptic maximal torus of gH, not J: We take µ′ ∈ X∗(T ′) to be
a conjugate of gµh := Intg(µh)(∈ X∗(gT )) under gH(Qp). Then, because NmK/Qpµh maps into
the center of H by our assumption, the same argument above establishing (5.0.16.1) gives that
NmK/Qpµ′ = NmKh/Qp
gµh. Then, in turn using this equality, again the proof of Lemma 3.3.10
establishes that the two Galois Qp/Qp-gerb morphisms into Gg H, ξ−gµh and ξ−µ′, are conjugate
under gH(Qp), and so are gξp = gφ(p) ◦ ζp and ξ−µ′.16 Hence, there exists a u ∈ gH(Qp) such
that ξ′
p . As was noted
above, we can choose such u so as to satisfy further that T ′ = Int(ug)(TQp ) and ξ′
p maps into
GT ′; in particular, ǫ′ := Int(ug)(ǫ) ∈ T ′(Qur
p ) are conjugate
under gH(Qp), they are so under gH(Qur
p ), by a theorem of Steinberg; suppose ǫ′ = Int(u′g)(ǫ) for
u′ ∈ gH(Qur

p ). With this preparation, for j ∈ N, let us deﬁne bj ∈ T ′(K0) by

p := Int(ug)(ξp) is an unramiﬁed conjugate of gξp which factors through GLs

p ). Also, as ǫ′, gǫ := Intg(ǫ) ∈ gH(Qur

bj ⋊ σj := F j = (NmK/K0(µ′(π)) ⋊ σ)j.

So, we have that bn =Qn

that bj = (p−ν′
will also write b for b1.

p · u0)

j

i=1 σi(NmK/K0(µ′(π))). Also, if [K : Qp] divides j, by (5.0.16.2), we have
p = −NmK/Qpµ′ and u0 ∈ T ′(Qp)1; in particular, bj ∈ T ′(Qp). We

[K:Qp] , for ν′

Now, by assumption (∗(γ0)), we have that

[K : Qp]λH(ǫ) = [K : Qp]nµh = λH(pnNmKh/Qp µh),

and that NmKh/Qpµh lies in the connected center Zǫ of CentG(ǫ).
element of T (Qp) (⊂ H(Qp) ∩ CentG(ǫ)(Qp)):

k0 = ǫ−[K:Qp] · p−nNmKh/Qp µh
lies in Ker(λH) ∩ Z(CentG(ǫ)). We claim that for some a ∈ N,

ka
0 ∈ Ker(λZǫ),

It follows from this that the

0 lies in the maximal compact open subgroup of Zǫ(Qp) ⊂ T (Qp). First, take a1 ∈ N with

i.e. ka
ǫa1 ∈ Zǫ(Q), so that

ka1
0 ∈ Zǫ(Qp).

16This is the ﬁrst reason why we need the new assumption that NmKh/Qp µh maps into the center of CentG(ǫ):

without it, there is no gurantee that ξ−µ′ (which deﬁnes F ) is conjugate to ξ−gµh (so conjugate to ξp = φ(p) ◦ ζp).

64

As the natural map Z(H) ։ H ab is an isogeny of split tori, there exists a2 ∈ N such that H ab(Qp)a2
0
is contained in the image of Z(H)(Qp)0 under this isogeny (clearly, for a2 we can take the degree
of the isogeny). Then, since the kernel of the isogeny Zǫ ֒→ H ։ H ab is Zǫ ∩ H der, we can ﬁnd
x0 ∈ Z(H)(Qp)0(:= Ker(λZ(H))) and a3 ∈ N such that
0 )a3 ∈ Z ′

· x−1

ǫ(Qp),

(ka1a2

0

where Z ′
by deﬁnition of H, Z(H) is the maximal Qp-split sub-torus of (Zǫ)Qp, hence Z ′
kernel of (Zǫ)Qp (the maximal anisotropic subtorus of (Zǫ)Qp), and Z ′

ǫ := ((Zǫ)Qp ∩ H der)0 (it suﬃces that a3 kills the ﬁnite group π0((Zǫ)Qp ∩ H der)). But,
ǫ is the anisotropic
ǫ)).

ǫ(Qp)0(:= Ker(λZ ′

ǫ(Qp) = Z ′

Therefore, a :=Q3

i=1 ai satisﬁes that ka ∈ Ker(λZǫ).

It follows that for suﬃciently large t divisible by a[K : Qp], and for v′ := u′g, the element of
p ):

T ′(Qur

(ǫ′−1F n)t = v′ǫ−tv′−1 · (p−ν′

p · u0)

nt

[K:Qp] ⋊ σnt

(5.0.16.5)

= v′(ǫ−[K:Qp] · pnNmKh/Qp µh)
= v′k
[K:Qp]
0

v′−1 · (u0)

nt

t

[K:Qp] ⋊ σnt

t

[K:Qp] v′−1 · u

nt

[K:Qp]
0

⋊ σnt

lies in any given neighborhood of 1 in T ′(L), in particular in the unique (special maximal) parahoric
subgroup T ′(L)1 of T ′(L) which is, by our choice of gH and T ′, equal to T ′(L)∩ ˜Kp. Consequently
by [Gre63, Prop. 3], for suﬃciently large t, there exists h ∈ T ′(L) ∩ ˜Kp such that

(ǫ′−1Φm)t = h−1σtn(h) ⋊ σtn.
We note in passing that for suﬃciently large t with ν′ := − nt

[K:Qp] ν′

p ∈ X∗(T ′),

(5.0.16.6)

(ǫ′)t = pν′

· k

= v′(ǫ[K:Qp] · pnNmKh/Qp µh)

with k := (ǫ′)t · p−ν′
We ﬁx t ∈ N for which the equation (5.0.16.6) has a solution h ∈ T ′(L) ∩ ˜Kp. Then, ǫ′−tΦmt
ﬁxes hx0 = x0 (x0 = 1 · ˜Kp being the base point of G(L)/ ˜Kp). But, we have seen in the proof of
Lemma 3.3.10 that for our choice of F and x0, inv ˜Kp
({µX}). This proves that
(φ, ǫt) is Kp-eﬀective admissible.

v′−1 lying in Ker(vg HL).17

(x0, F x0) = Adm ˜Kp

[K:Qp]

t

− t
[K:Qp] v′−1 = v′k
0

Next, we show that there exists e ∈ G(L) such that

e−1(ǫ′)−1Φme = σn.

Obviously, this will establish the suﬃciency direction of the admissibility of (φ, ǫ). We ﬁrst claim
that there exists c ∈ T ′(L) such that

c−1(ǫ′)−1Φmc ∈ T ′der(L) × σn,

17In [LR87, p.193, line 9], Langlands and Rapoport state that this decomposition ǫ′t = pν ′

k is “a polar decompo-
belonging to the center (of gH); by this they must mean some Cartan decomposition and, as such,
p ). But it is not
(k) = 0. This is our

sition” with pν ′
claim that k lies in some (hyper)special subgroup, or at least in a compact open subgroup of gH(Qur
clear how to show this from their condition (∗(ǫ)) only, which just tells us that vg HL(k) = vg H ab
second reason for introducing the new assumption (∗(γ0)).

L

65

where T ′der := gH ∩ T ′ (which is connected, i.e. a torus, since H der is simply connected). Since T ′
splits over L, we make take K to be an unramiﬁed extension of Qp. So, by (3.3.9.2),

[K : K0]wT ′

L

(bn) = [K : K0]

σi(wT ′

L

(NmK/K0(µ′(π))))

nXi=1

=

=

nXi=1
nXi=1

σi(wT ′

L

(NmK/K0(µ′)(p)))

σi(NmK/K0(µ′)),

L

L

(bn) = nµ′ (as H ab is Qp-split). Then, since µ′ and µh are gH-conjugate,
thus we have that vg H ab
(ǫ′−1bn) = vg HL(ǫ′−1bn) = 0. So, there exists f ∈
by assumption (∗(γ0)), it follows that vg H ab
H ab(L)0 such that prH(ǫ′−1bn) = f σn(f −1), where prH : H → H ab is the natural projection.
Since T ′der is connected, the natural map T ′(L) → gH ab(L) is surjective, thus there exists a
c ∈ T ′(L) mapping to f . Then, we proceed as in the proof (on p. 193) of [LR87, Satz 5.21] to
ﬁnd d ∈ gH sc(L) ∩ ˜Kp such that d−1c−1ǫ′−1Φmcd = σn. By [Kot85, Prop. 5.4], It suﬃces to show
that c−1(ǫ′)−1Φmc ∈ gH der(L) ⋊ σn is basic, which is by deﬁnition ([Kot85, (4.3.3)]) the same as
the existence of d′ ∈ gH der(L) with c−1(ǫ′−1Φm)tc = d′σtn(d′−1) for some suﬃciently large t, which
obviously follows from the equation (5.0.16.5). Again, here we need that k (equiv. k0) lies in a
compact open subgroup of g(H)(Qur

p ).

(2) By Steinberg’s theorem, we can assume that c ∈ G(Qur

p ). Let b := c−1δσ(c). Then, as
was discussed before, one can readily check that b ∈ CentG(γ0)(Qur
[LR87, p.183]), and
that b ∈ CentG(γ0)(L) is a basic element ([LR87, Lemma 5.15]), namely νb maps into the center
of CentG(γ0)L. In fact, what that proof establishes is that the Newton homomorphisms νγ0, νb
attached to γ0, b are related by:

p ) (cf.

νγ0 = nνb,

from which follows the fact that b is basic in CentG(γ0)(L), cf. proof of Lemma 5.0.14, (2). Let
us choose a maximal Q-torus T0 of G that contains γ0 and elliptic over R. Then, thanks to our
assumption that X(b,{µX})Kp 6= ∅ and Lemma 4.2.4, we can ﬁnd µ ∈ X∗(T0) ∩ {µX} such that if
0 · p−tνγ0 ∈ T0(Qp)0
K is a ﬁnite Galois extension of Qp splitting T0, NmK/Qpµ = [K : Qp]νb. Also γt
for any t ∈ N with tνγ0 ∈ X∗(T0) by deﬁnition of νγ0. Hence, [K : Qp]νγ0 = nNmK/Qpµ ∈ X∗(T0),
so

[K : Qp]λT0(γ0) = [K : Qp]νγ0 = nNmK/Qpµ = n[K : Qp]µ,

and λH(γ0) = nµ. Therefore, the condition (∗(γ0)) of Subsec. 3.5.1 holds (with level n), and the
claim follows from (1). This completes the proof.

5.1 Criterion for a Kottwitz triple to come from an admissible pair In this sub-
section, it is assumed that Gder is simply connected, since we will work with Kottwitz triples. With
the works done so far, the proofs of the statements in this section are even closer to the original
proofs in the hyperspecial case, so from now on we will be contented with a sketch of the arguments.
We continue to work in the same set-up from the previous subsection.

66

Theorem 5.1.1. Keep the assumptions of Theorem 5.0.16. Let (γ0; (γl)l6=p, δ) be a Kottwitz triple
with trivial Kottwitz invariant and such that γ0 (equiv. (γl)l) lies in a compact open subgroup of
G(Ap
f ) and X(δ,{µX})Kp 6= ∅. Then, there exists an admissible pair (φ, ǫ) that gives rise to the
triple (γ0; (γl)l6=p, δ). In this case, there are exactly i(γ0) non-equivalent pairs corresponding to (γl)
and δ. Here, i(γ0) is the cardinality of the kernel of the natural map

H 1(Q, CentG(γ0)) → H 1(Q, Gab) ×Yv

H 1(Qv, CentG(γ0)).

Remark 5.1.2. This is essentially Satz 5.25 of [LR87] (in the hyperspecial level case), except for the
following diﬀerences: there, the triple (γ0; (γl)l6=p, δ) is still required to satisfy their condition (∗(ǫ))
while here we do not demand it, nor our condition (∗(γ0)) (recall that our deﬁnition of a Kottwitz
triple does not include any of these conditions). Instead in this theorem we added conditions at each
ﬁnite place l 6= p and replaced the original (∗(ǫ)) (a condition at p) by X(δ,{µX})Kp 6= ∅. This is not
only harmless but also more natural, because according to the conjecture of Langlands-Rapoport,
these conditions are a necessary condition for a triple to come from an admissible pair contributing
to SK(Fqm) for some m (cf. Remark 3.6.2), and are also a suﬃcient condition according to this
theorem.

Proof. By Theorem 5.0.16, (2), there exists an admissible pair (φ1, ǫ) with ǫ stably conjugate to γ0,
which we may further assume to be nested in a maximal Q-torus, elliptic over R, i.e. φ1 = ψT,µh
for a special Shimura sub-datum (T, h) and ǫ ∈ T (Q). Then, we have the important fact that
the restriction of φ to the kernel of P is determined by ǫ alone, and that its image Im(φ∆
1 ) lies in
the center of CentG(ǫ). With our assumption on γ0 ∈ G(Ap
f ), this follows from Prop. 5.0.13, (1),
since φab : P → GGab is uniquely determined (as Gder is simply connected). The next step in the
proof is to modify φ1 using a suitable cocycle, to get a new admissible morphism φ so that (φ, ǫ)
becomes an admissible pair which gives rise to the Kottwitz triple (γ0; (γl)l6=p, δ). This modiﬁcation
of an admissible morphism φ1 by a cocycle a in Z 1(Gal(Q/Q), G(ǫ)′) enjoys the crucial property
that it does not change the restriction of φ1 to the kernels (i.e. φ∆
1 : P → G). In other words,
φ = aφ1 coincides with φ1 on P , hence if φ1 is well-located in a maximal torus T , elliptic over R,
φ : P → GG is again well-located in T , i.e. φ(δn) = φ1(δn) ∈ T (Q). Such modiﬁcation is carried
out in the proof of Satz 5.25 in [LR87] which works for any kind of level subgroup, and we provide
its summary in the next lemma.

Lemma 5.1.3. Let (φ1, ǫ) be a well-located admissible pair. Let G(ǫ)′ be the twist of G(ǫ) :=
CentG(ǫ) deﬁned by φ1 (i.e. G(ǫ)′ is the inner form of G(ǫ) deﬁned by the cocycle [ρ 7→ φ1(qρ)] ∈
Z 1(Gal(Q/Q), CentG(ǫ))).
(1) For any cocycle a = {aσ} of Gal(Q/Q) with values in G(ǫ)′, the map φ : P → GG deﬁned
(2) (φ, ǫ) is admissible if and only if the images of a in H 1(Q, Gab) and in H 1(R, G(ǫ)′) are

by φ|P = φ1|P and φ(qρ) = aρφ1(qρ) is a morphism of Galois gerbs over Q; we write φ = aφ1.
trivial.

(3) If (ǫ, (γl), δ) is a Kottwitz triple with trivial Kottwitz invariant, there exists a cocycle a =

{aσ} such that the pair (φ = aφ1, ǫ) is an admissible pair corresponding to (ǫ, (γl), δ).
Proof. The ﬁrst statement is a straightforward veriﬁcation. The second one is Lemma 5.26 of
[LR87]. Finally, the third claim is established in the proof of Satz 5.25 of loc. cit., more precisely,
in the part from the third paragraph in p.195 to the end of the proof.

67

5.2 Eﬀectivity criteria for stable conjugacy classes and Kottwitz triples Let T be
a Q-torus and µ ∈ X∗(T ) a cocharacter deﬁned over a CM ﬁeld E ⊂ Q. Let p the prime ideal of OE
corresponding to the place v2 of E (the place determined by the chosen embedding Q ֒→ Qp). We
ﬁx an element π of E such that (π) = pr holds for some r ∈ N: it suﬃces that the class number of
OE divides r. Note that π is a unit in Ew for any ﬁnite place w 6= v2 of E, and |NmEp/Qpπ|p = p−m
with m = [Ep : Qp]r. Thus, for ﬁxed r, any two such numbers π, π′ diﬀer by a root of unity.
Then, with a choice of (E, π), we deﬁne a triple (γ0; (γl)l6=p, δ) ∈ T (Q)× T (Af )× T (Qur
p ) as follows:
Consider the reciprocity map (cf. [Del77, 2.2]):

N (µ) : E× = ResE/QGm

ResE/Qµ

−→ ResE/Q(TE)

NmE/Q−→ T.

First, we set

γ0 := N (µ)(π) = NmE/Q(µ(π)),

where NmE/Q is the norm map T (E) → T (Q), and γl := γ0 for l 6= p. For δ, let Ep,0 be the maximal

unramiﬁed subextension of Ep and n := [Ep,0 : Qp]. Then, NmE/Q(µ(π)) =Qw|p NEw/Qp(µ(π)) via
(NmE/Qp)Qp =Qw|p NEw/Qp : T (E ⊗ Qp) =Qw T (Ew) → T (Qp), and for each place w 6= v2 of E
above p, wTL(NEw/Qp(µ(π))) = 0 (this was seen in the proof of Thm. 5.0.16). Thus, we can ﬁnd
c ∈ T (L) such that cNEp/Qp(µ(π))σn(c)−1 = γ0. If we set

δ := c · NEp/Ep,0(µ(π)) · σ(c−1),

one easily checks that δ ∈ T (Ln) and NmLn/Qpδ = γ0. In the case of need for distinction, we write
γ0(T, µ) (or γ0(T, h) when µ = µh for a special Shimura subdatum (T, h)) for the γ0 deﬁned this
way (with a choice of (E, π) understood). It follows from the deﬁnition of ψT,µ ([LR87, p.144]) that

γ0(T, µ) = ψT,µ(δm),

when we use the same E and π in both deﬁnitions. Here, δm ∈ P (E, m) is as in Lemma 3.2.9. Note
that a diﬀerent choice (E ⊂ E′, π′|π) of (E, π) changes γ0(T, µ) to its power.
Next, let (G, X) be a Shimura datum meeting our running assumptions in this section (as
imposed in Thm. 5.0.16).

Lemma 5.2.1. When (T, µ) comes from a special Shimura subdatum (T, h) of (G, X) (i.e. µ = µh),
the triple (γ0; (γl)l6=p, δ) just constructed is a Kottwitz triple, i.e, satisﬁes the conditions (iv), (∗(δ))
of Subsec. 3.5.1. It also satisﬁes the condition (∗(γ0)) and its Kottwitz invariant is equal to 1.
Proof. By Remark 3.5.3, the condition (iv) will be implied by the vanishing of the Kottwitz invariant
α(γ0; (γl)l, δ), for which we refer to the proof of Thm. 5.3.1 of [Lee14] (more speciﬁcally, Step 4).
The condition (∗(δ)) is Lemma 3.3.9. Finally, (∗(γ0)) follows from Thm. 5.0.16, (3), in view of
Lemma 3.3.9 and Lemma 3.3.10.

Suppose that (G, X) is of Hodge type, endowed with an embedding ρ : G ֒→ GSp(V,h , i). Fix
a level subgroup K = Kp × Kp ⊂ G(Af ) and also an integral model SKp over OE(G,X)℘ with the
[KP15, Thm. 0.1]). Then, for a special Shimura sub-datum (T, h)
usual extension property (e.g.
and gF ∈ G(Af ), the corresponding CM point x = [(h, gf · K)] ∈ ShK(G, X)(C) is deﬁned over
Q(⊂ C), thus via the chosen embedding Q ֒→ Qp, reduces to a point x0 deﬁned over some ﬁnite
ﬁeld Fqm. Using ρ, we may ﬁnd a CM-algebra L of degree 2 dim V , containing ρ(T )(⊂ End(V )),

68

and an embedding L ֒→ End(Ax)Q. There is a natural CM type Φ of L determined by h. Then we
have the inclusions E(L, Φ) ⊂ E ⊂ E(x), where E(L, Φ) is the reﬂex ﬁeld of (L, Φ) and E(x) ⊂ Q
is a ﬁeld over which x is deﬁned (which can be uniquely determined by gf K from the canonical
model theory, cf. [Del77, 2.2]), and j◦ N (µ)◦ NmE(x)/E : E(x)× → L× is the usual reﬂex norm map
attached to the CM abelian variety Ax/E(x), where j : T ֒→ L× is the inclusion (cf.
[CCO14]).
Then, the theory of Complex Multiplication ([CCO14, A.2.5.7, A.2.5.8]) tells us that for large t ∈ N,
γ0(T, µh)t ∈ L× acts as the relative Frobenius on Ax0/Fpmt.
When Kp is hyperspecial, Kisin [Kis13, Cor. 2.3.1] also attaches a Kottwitz triple to any point
x ∈ SK(Fqm) over a ﬁnite ﬁeld, using his work on the Tate theorem and the CM-lifting theorem
([Kis13, Cor. 2.2.5]). This is equivalent to the one attached to (T, µh) when x is the reduction of
a CM point deﬁned by the datum (T, h) ([Kis13, Prop. 4.6.3]).

By deﬁnition, a stable conjugacy class in G(Q) is an equivalence class in G(Q) with respect to
the stable conjugation relation. For a stable conjugacy class C ⊂ G(Q) and t ∈ N, Ct is the stable
conjugacy class containing the set {gt | g ∈ C}.
Theorem 5.2.2. Keep the assumptions of Theorem 5.0.16. Assume further that (G, X) is of
Hodge type and the anisotropic kernel of the center Z(G) remains anisotropic over R. Fix a special
maximal parahoric subgroup Kp ⊂ G(Qp).
(1) Let C ⊂ G(Q) be a stable conjugacy class. Then, some power of C contains the relative
Frobenius of the reduction of a CM point of ShK(G, X)(C), i.e. a power of γ0(T, h) for some
special Shimura sub-datum (T, h), if and only if a power of C contains some γ0 ∈ G(Q) which
satisﬁes the condition (∗(γ0)) of Subsec. 3.5.1 and lies in a compact open subgroup of G(Ap
f ).
(2) Let (γ0; (γl)l6=p, δ) be a Kottwitz triple with trivial Kottwitz invariant and such that γ0 (equiv.
(γl)l) lies in a compact open subgroup of G(Ap

f ) and
Yp := {x ∈ G(L)/ ˜Kp | σnx = x, inv ˜Kp

(x, δσx) ∈ Adm ˜Kp

({µX})} 6= ∅.

Then, there exists a special Shimura datum (T, h) such that the reduction of the CM point [h, 1·K] ∈
ShK(G, X)(Q) has the associated Kottwitz triple equal to (γ0; (γl)l6=p, δ), up to powers.

Note that these facts are consequences of the Langlands-Rapoport conjecture and the conjecture

(3.6.2.1) derived from it.
Proof. (1) Suppose γ0(T, h)s ∈ Ct for some s, t ∈ N. Obviously (φ, ǫ) := (ψT,µh, ψT,µh(δm)) (for any
m ∈ N) is an admissible pair such that ǫ lies in a compact open subgroup of G(Ap
f ), so ψT,µh(δm)
satisﬁes the stated condition by Thm. 5.0.16, (1). But, γ0(T, h) = ψT,µh(δm). Now, the claim
follows since the condition (∗(γ0)) holds for γ0 if and only if it holds for γs
Conversely, if γ0 is an element in G(Q) ∩ Cr satisfying the condition (∗(γ0)) and lying in a
compact open subgroup of G(Ap
f ), by Thm. 5.0.16, there exists an admissible pair (φ, ǫ) with ǫ
stably conjugate to γ0, which we may further assume to be nested in some special Shimura sub-
datum (T, h), i.e. φ = ψT,µh and ǫ ∈ T (Q). Then, by Prop. 5.0.13, (4), ǫk = ψT,µh(δk)n for
0 ∈ Crkt is stably conjugate to ψT,µh(δk)nt, which is, for large t, the relative
some k, n ∈ N. So, γkt
Frobenius of the reduction of a CM point, as we have seen above.

0 for any s ∈ N.

(2) The same proof as in (1) works, using Thm. 5.0.16, (2).

This generalizes [Kot92, Lemma 18.1] which concerns the Shimura varieties of PEL-type whose
Lie types are either A or C and with hyperspecial level Kp. It says that a triple (γ0; (γl)l6=p, δ) as

69

in Def. 3.5.2 arises from a point over the ﬁnite ﬁeld Fpn if and only if it is a Kottwitz triple of level
n (in the same sense as ours) with γ0 being a Weil pn-number, has the trivial Kottwitz invariant,
and the aﬃne Deligne-Lusztig variety X({µX}, δ)Kp is non-empty.

A The quasi-motivic Galois gerb

As explained by Reimann, the original deﬁnition of the quasi-motivic Galois gerb contains errors.
He gave a correct construction in his book [Rei97, §B2]. We provide a review of it in loc. cit.
For every place l of Q, we ﬁx an embedding Q ⊂ Ql. For every Galois extension L ⊂ Q of Q,
we ﬁrst deﬁne a Q-torus QL which will serve as the kernel of the quasi-motivic Galois gerb to be
deﬁned later. We set

(intersection and composite in Ql, respectively). Let QL be the Q-torus deﬁned by the exact
sequence of Q-tori

L(l) := L ∩ Ql, Ll := L · Ql

1 −→ Gm

∆−→ L(∞)× × L(p)× −→ QL −→ 1

where ∆ is induced by the diagonal embedding of Q into L(∞) × L(p), and let

ψL : QL −→ L×

be the homomorphism of Q-tori induced by the natural inclusion of L(p)× into L× and the inverse of
the natural inclusion of L(∞)× into L×. On the other hand, the embedding L(l) ֒→ Ql determines
a place of L(l) and accordingly a factor of L(l) ⊗Q Ql isomorphic to Ql, namely a cocharacter of
L(l)× which is deﬁned over Ql. For l ∈ {∞, p}, let ν(l)L denote the resulting cocharacter of QL.
The Q-torus QL equipped with two cocharacters ν(∞)L, ν(p)L is also characterized by certain
universal property.
Lemma A.0.3. [Rei97, B2.2] For every Galois extension L ⊂ Q of Q, (QL, ν(∞)L, ν(p)L) is an
initial object in the category of all triples (T, ν∞, νp) where T is a Q-torus which splits over L, and,
for l ∈ {∞, p}, νl is a cocharacter of T which is deﬁned over Ql, and such that

Xl∈{∞,p}

[Ll : Ql]−1TrL/Q(νl) = 0.

The Q-torus QL satisﬁes the Hasse principle for H 1, i.e. the natural map

H 1(Q, QL) →Mall l

H 1(Ql, QL)

is injective.

Note that νl, being a cocharacter of T , is also deﬁned over L, which gives meaning to the

expression TrL/Q(νl).

For every successive Galois extensions L ⊂ L′ ⊂ Q of Q, there exists a surjective homomorphism
: QL′ → L′×, ψL : QL → L×, and
ωL′|L : QL′ → QL which commutes with the maps ψL′
NmL′|L : QL′ → QL, Hence, we get two projective systems {QL}L, {L×}L with respective transition

70

maps ωL′|L, NmL′|L, and the maps {ψL}L induce a homomorphism between the corresponding pro-
tori
(A.0.3.1)

L×.

ψ∆ : Q := lim←−L

QL → R := lim←−L

The character group of R can be naturally identiﬁed with the set of all continuous maps f :
Gal(Q/Q) → Z, the Galois action being given by ρ(f )(τ ) = f (ρ−1τ ) for all ρ, τ ∈ Gal(Q/Q).
Further easy properties of the system ωL′|L show that there exist a cocharacter

whose composite with Q → QL, for totally imaginary L, is ν(∞)L, and a cocharacter

ν(∞) : Gm,R → QR

Deﬁnition A.0.4. [Rei97, B2.7] A quasi-motivic groupoid is the data of a Galois gerb Q over Q
together with morphisms ζl = ζ Q
l

: Gv → Q(l) for all places l of Q such that

ν(p) : D → QQp.

(1) (Q∆, ζ ∆

∞, ζ ∆

p ) = (Q, ν(∞), ν(p)), the identiﬁcation Q∆ = Q(Q) being compatible with the

action of Gal(Q/Q).

(2) the morphisms ζl, for all l 6= ∞, p, are induced by a section of Q over Spec(Ap
where Ap

f denotes the image of the map Q ⊗Q Ap

f ⊗Ap

f

Ap

f );

f →Ql6=∞,p Ql.

For more concrete equivalent description of the condition (2), see (3.1.7) of [Kis13].

Theorem A.0.5. There exists a quasi-motivic Galois gerb (Q, (ζl = ζ Q
l )) is another
quasi-motivic Galois gerb, there is an isomorphism α : Q → Q′ such that, for all places l of Q, ζ ′
l
is algebraically equivalent to α ◦ ζl. Moreover, there is a morphism ψ : Q → GR, whose restriction
to the kernel is the homomorphism ψ∆ (A.0.3.1); ψ is unique up to algebraic equivalence.

l )). If (Q′, (ζ ′

B Existence of elliptic tori inside special maximal parahoric group

schemes

Proposition B.0.6. Let k be a local ﬁeld with residue characteristic not equal to 2 and L the
completion of the maximal unramiﬁed extension kur in an algebraic closure k of k with respective
rings of integers Ok and OL. Let G be a connected reductive group over k of classical Lie type.
Assume that G is quasi-split and splits over a tamely ramiﬁed extension of k.
Then, for any special parahoric subgroup K of G(k), there exists a maximal elliptic k-torus T
of G such that Tkur contains (equiv. is the centralizer of ) a maximal (kur-)split kur-torus S1 of Gkur
and that the unique parahoric subgroup of T (L) is contained in ˜K, the parahoric subgroup of G(L)
corresponding to K.

Remark B.0.7. (1) The unique parahoric subgroup of T (L) (resp. of T (k)) is T (L)1 := Ker(wTL)
(resp. T (k)1 := Ker(wTL) ∩ T (k)).
(2) With S1 and T as in the statement, the second property of T can be translated into a
statement about the Bruhat-Tits building: any special point v ∈ B(G, k) giving K (i.e. K =

71

StabG(F )(v) ∩ Ker(wGL)) lies in an apartment A(S1, L) attached to S1. Indeed, S1(L)1 ⊂ ˜K if
and only if v ∈ A(S1, L). This is because A(S1, L) is the full ﬁxed point set of the pararhoric
subgroup S1(L)1, which in turn is due to [Tit79, 3.6.1] since every relative root a of the root datum
(GL, (S1)L), being a non-trivial character (of a split torus), satisﬁes that a(S1(L)1) * 1 + πF (i.e.
¯a(S1(L)1) 6= 1), as the residue ﬁeld of OL is inﬁnite. But, S1(L)1 ⊂ ˜K if and only if T (L)1 ⊂ ˜K,
since T (L) = CentGL(S1)(L) acts on A(S1, L) via wTL ⊗ R : T (L) → X∗(T )Gal(L/L) ⊗ R = X∗(S1)R
([Tit79, 1.2.(1)]), so if S1(L)1 ⊂ ˜K, T (L)1 ﬁxes v(∈ A(S1, L)).
Proof. We reduce a general case to the case of absolutely almost-simple groups. First, under the
isomorphism

B(G, k) ≃ B(Gder, k) × X∗(A(G))R,

isomorphic to B(H, F ) (resp. Qσ∈Homk(F0,L) B(H, F ⊗F0,σ L)), where F0 is the maximal unamiﬁed

where A(G) is the maximal split F -torus in the center Z(G), a special point in A(G, k) corresponds
to (v, x) for a special vertex v in B(Gder) and a point x ∈ X∗(A(G))R. This implies that we
may assume that G is semisimple, and by the same reasoning further that G is simply-connected.
Then as G(= Gder) is a product of almost-simple groups of the same kind (by which we mean
quasi-split, tamely ramiﬁed, classical groups), we may also assume that G is almost-simple. Hence,
G = ResF/k(H) for an absolutely-(almost)simple, quasi-split, classical, tamely ramiﬁed, semi-
simple group H over a ﬁnite extension F of k. The building B(G, k) (resp. B(G, L)) is canonically
subextension of F ); this is true for any ﬁnite separable extension F of k ([Tit79, 2.1]). This shows
that the claim for G follows from the claim for H. Let L and OL now be the completion of the
maximal unramiﬁed extension F ur in an algebraic closure F of F and its ring of integers.
From this point, we prove the proposition case by case. We use the complete list of isomorphism
classes of quasi-split, tamely ramiﬁed, classical groups over local ﬁelds as provided in [Gro12], where
Gross gives a complete list of isomorphism classes of (not necessarily quasi-split or classical) tamely
ramiﬁed groups over local ﬁelds and it is fairly easy to determine the quasi-split, classical ones from
that list. There are totally ten such isomorphism classes, among which the ﬁrst seven are unramiﬁed
ones (including four split ones).
Am (m ≥ 1): H = SLm (split group).
2A′
2m (m ≥ 2): Let E be the unramiﬁed quadratic extension of F and let W be a non-degenerate
Hermitian space of odd rank n = 2m+1 over E (its Witt-index must be m). Then H = SU(W )
(non-split unramiﬁed group).

2A′

2m−1 (m ≥ 2): Let E be the unramiﬁed quadratic extension of F and let W be a non-degenerate
Hermitian space of even rank n = 2m over E which contains an isotropic subspace of dimen-
sion m. Then H = SU(W ) (non-split unramiﬁed group).

Bm (m ≥ 3): Let W be a non-degenerate orthogonal space of odd dimension 2m + 1 over F which

contains an isotropic subspace of dimension n. Then H = Spin(W ) (split group).

Cm (m ≥ 2): Let W be a non-degenerate symplectic space of dimension 2m over F . Then

H = Sp(W ) (split group).

Dm (m ≥ 4): Let W be a non-degenerate orthogonal space of dimension 2m over F which contains
a (maximal) isotropic subspace of dimension m. Then, the center of the Cliﬀord algebra is
the split ´etale quadratic extension E = F ⊕ F of F , and H = Spin(W ) is a split group.

72

2Dm (m ≥ 4): Let W be a non-degenerate orthogonal space of even dimension 2m over F where
the center of the Cliﬀord algebra is the unramiﬁed quadratic extension E of F . Then H =
Spin(W ) (non-split unramiﬁed group).

B - Cm (m ≥ 3): Let E be a tamely ramiﬁed quadratic extension of F and let W be a non-degenerate
Hermitian space of even rank n = 2m over E which contains an isotropic subspace of dimen-
sion m. Then H = SU (W ) (ramiﬁed group)

C - BCm (m ≥ 2): Let E be a tamely ramiﬁed quadratic extension of F and let W be a non-degenerate

Hermitian space of odd rank n = 2m + 1 over E. Then H = SU (W ) (ramiﬁed group).

C - Bm (m ≥ 2): Let W be a non-degenerate orthogonal space of even dimension 2m over F where
the center of the Cliﬀord algebra is a tamely ramiﬁed quadratic extension E of F . Then
H = Spin(W ) (ramiﬁed group).

Here, each heading is the name for the corresponding isomorphism class that is used in [Tit79],

tables 4.2 and 4.3.

Now, when the group is unramiﬁed and given special vertex is hyperspecial, the claim is known
([Lee14], Appendix 1.0.4). For convenience, we split these cases into three kinds. The ﬁrst kind
consists of the split groups, thus, all special vertices are automatically hyperspecial: these are
Am, Bm, Cm, Dm. The second case is when there are two special vertices and both of them are
hyperspecial: they consist of 2A′
2m−1, 2Dm. The remaining ones constitute the last case, i.e. there
is some non-hyperspecial, special vertex. So, we only need to take care of the last case:

2A′

2m, B - Cm, C - BCm, and C - Bm.

Note that except for the last one, all these are (special) unitary groups.

(1) First, we treat the special unitary groups of even absolute rank (i.e. HF ≃ SU(2m + 1) for
an algebraic closure F of F ). We will reduce the proof in this case to the special unitary groups
of odd absolute rank. For a moment, we let E be an arbitrary quadratic extension of F with
respective rings of integers OE, OF (we assume that the residue characteristic of OF is not 2). We
choose a uniformizer π of OE such that π + π = 0 for the non-trivial automorphism · of E/F . Let
(W, φ : W × W → E) be a non-degenerate Hermitian space of dimension n = 2m + 1 (m ≥ 1). As
is well-known, ψ has maximal Witt-index m, so there exists a Witt basis {e−m,··· , em}, i.e. such
that

For i = 0,··· , m, we deﬁne an OE-lattice in W :

φ(ei, ej) = δi,−j,

for − m ≤ i, j ≤ m.

Λi := spanOE{π−1e−m,··· , π−1e−i−1, e−i,··· , em}.

Set H = SU(W, φ) (algebraic group over F ). Its (minimal) splitting ﬁeld is E. For a non-empty

(here, Λm = spanOE{e−m,··· ,··· , em}.)
subset I of {0,··· , m}, we consider the subgroup of H(F )

PI := {g ∈ SU(W, φ) | gΛi ⊂ Λi, ∀i ∈ I}.

For each i = 0,··· , m, P{i} (stabilizer of a single lattice Λi) is also the stabilizer of a point vi of the
apartment A of a maximal F -split torus S of H, which in turn can be matched with the (i + 1)-th
vertex of the local Dynkin diagram [Tit79, 1.15, 3.11].

73

From this correspondence and the information found in loc. cit. (1.15 (9), 4.3 in the unramiﬁed

case, and 1.15 (10), 4.2 in the ramiﬁed case), we deduce the following facts.

Every PI is a parahoric subgroup of SU(W, φ) and any parahoric subgroup of SU(W, φ) is conju-
gate to PI for a unique subset I. If E is unramiﬁed (i.e. of type 2A′
2m), there are two special vertices,
one hyperspecial and one non-hyperspecial. The group P{0} (resp. P{m}) is the non-hyperspecial,
special (resp. the hyperspecial) parahoric subgroup. If E is ramiﬁed (i.e. of type C - BCm), there
are two special vertices, both non-hyperspecial, which correspond to I = {0} and I = {m}. The
corresponding parahoric subgroup ˜P{i} of H(L) is

˜P{i} = {g ∈ SU(W, φ)(L) | gΛi ⊗OF OL ⊂ Λi ⊗OF OL}.

The statement on ˜P{i} follows from the fact that the stabilizer OL-group scheme Gi of the vertex vi
(deﬁned by Bruhat-Tits [Tit79, 3.4.1]) equals the OL-structure on HL induced by the lattice ([Tit79,
3.11]), and the characterization of parahoric groups given by Haines-Rapoport [PR08] (SU(W, φ)
being a simply-connnected semi-simple group, the Kottwitz homomorphism wSU(W,φ)L is trivial).
2m: Suppose that E is unramiﬁed. Then, we only need to consider the non-
hyperspecial, special parahoric subgroup P{0}. The Hermitian space (W, φ) splits as the direct sum
of two Hermitian subspaces, that is, totally isotropic subspace and anisotriopic subspace:

(a) The case 2A′

where

(W, ψ) = (Wiso, φiso) ⊕ (Wan, φan),

Wiso := hel | l 6= 0i, Wan := E · e0,

and φiso = φ|Wiso and φan = φ|Wan. There is the corresponding lattice decomposition

Λ{0} = Λ′

{0} ⊕ Λ′′

{0},

{0} := spanOE{π−1e−m,··· , π−1e−1, e1,··· , em} and Λ′′

where Λ′
{0} := OE · e0. Using this decompo-
sition, we reduce the construction of the torus looked for into construction of similar tori for the
groups SU(W•, ψ•) (• = iso, an). Let us write for short SU• and U• for SU(W•, ψ•) and U(W•, ψ•)
respectively (• = iso, an). Suppose that Tiso is an F -torus of SUiso with the property in question
and let Ziso be the (connected) center of Uiso (so that the subgroup Tiso· Ziso generated by the two
groups is a maximal torus of Uiso, among others). This center is isomorphic to the anisotpropic
F -torus E×, whose set of R-points, for an F -algebra R, is

c (R) := Ker(NmE/F : (E ⊗ R)× → (F ⊗ R)×).
E×
This is also identiﬁed in a natural way with the group Uan. We claim that

T := S((Tiso · Ziso) × Uan) = (Tiso × {1}) · E×
c ,

where S(−) means the intersection of the group inside the parenthesis (subgroup of U(W, φ))
with SU(W, φ) and E×
is identiﬁed with S(Ziso × Uan) via x 7→ (x, x−2m), is a maximal torus of
c
H = SU(W, ψ) with the same required properties. First, clearly this is anisotropic, and TE is a
split maximal torus of HE. Next, we verify that T (L)1 maps into the parahoric subgroup ˜P{0} of
H(L). By the description of ˜P{0} above, we have to show that T (L)1 leaves stable Λ{0} ⊗OF OL.
But, T (L)1 = Tiso(L)1 · E×
{0} ⊗ OL through the map

{0} ⊗ OL ⊕ Λ′′

c (L)1, and E×

c (L)1 acts on Λ′

74

x 7→ (x, x−2m) above. So, clearly it suﬃces to checks that E×
c (L)1 leaves stable each rank-1 lattice
c (L)1 = {(x, x−1) ∈ O×
OL⊗OF (OE · ei). But in the case E is unramiﬁed over F , we have that E×
L ×
O×
L} under the isomorphism (E⊗L)× = L××L×, thus leaves stable OL⊗OF (OE·ei) = (OL⊕OL)·ei.
Next, the fact that Tiso(L)1 leaves stable Λ′
{0}⊗OL will be one of the deﬁning properties of the torus
2m−1 in the above list, and the stabilizer P ′
Tiso. Indeed, SU(Wiso, ψiso) is a group of type 2A′
{0}
of the lattice Λ′
[Tit79, 4.3]). So, we already
know that there exists an elliptic maximal F -torus Tiso of SUiso such that Tiso(L)1 is contained in
the parahoric subgroup ˜P ′
{0} which is the stabilizer in SUiso(L)
of the lattice Λ′

{0} is a hyperspecial subgroup of SU(Wiso, ψiso) (cf.

{0} of SUiso(L) corresponding to P ′

{0} ⊗ OL. This ﬁnishes the proof in the case E is unramiﬁed over F .

(b) The case C - BCm: When E is ramiﬁed, there are two cases: I = {0} and I = {m}. Then,
the same strategy just used (i.e. for unramiﬁed unitary groups of odd absolute rank) works again,
reducing proof to the ramiﬁed unitary groups of odd absolute rank 2m − 1 (the type B - Cm),
which will be discussed next. We just note that in this case with the same notations as above,
the (minimal) splitting ﬁelds of H, SUiso, Ziso, and Uan are all E, and that (E×
c )L is anisotropic,
so E×
c (L) is its own parahoric subgroup and, being a subgroup of (OE ⊗OF OL)×, leaves stable
OL ⊗OF (OE · ei).
(2) Let E, W , and n be as in the previous description (1)-(b), except that the parity of n is
even (i fact, it can be arbitrary for a moment). Let OE and OF be the integer rings of E and F ,
respectively. We ﬁx uniformizers πF , π = πE of OF and OE such that π2 = πF (so again π +π = 0).
Let φ : W × W → E be a non-degenerate Hermitian form and put H = SU(W, φ). Again we assume
(forced by the quasi-split condition, in the even dimensional case) that ψ has maximal Witt-index,
namely when one writes n = 2m (or n = 2m + 1), it is m. As E is ramiﬁed over F , the rank of H
is the same as that of HL.

{e1,··· , en} such that φ(ei, ej ) = δi,n+1−j for 1 ≤ i, j ≤ n.

Following [PR08], §4, we use a diﬀerent indexing in the coming discussion. Choose a Witt basis
Suppose that n = 2m. For i ∈ {1,··· , m − 2} ∪ {m}, we deﬁne an OE-lattice Λi:

Λi := spanOE{π−1e1,··· , π−1ei, ei+1,··· , en},

In the place of i = m − 1, we introduce a new lattice Λm′ deﬁned by:

Λm′ := spanOE{π−1e1,··· , π−1em−1, em, π−1em+1, em+2,··· , en}.

Here, m′ is regarded as a symbol like other numbers.

subgroup PI has the same deﬁnition as in the previous case.

Set H := SU(W, φ). For a non-empty subset I of {1,··· , m− 2, m′, m}, the associated stabilizer
When n = 2m, the group SU(W, φ) has the local Dynkin diagram B - Cm for m ≥ 3, and C - B2
for m = 2 (for m = 1, SU(W, ψ) ≃ SL2). Then, we have a similar statement ([PR08], §4), namely
that
the subgroup PI is a parahoric subgroup of SU(W, φ) and any parahoric subgroup of SU(W, φ)
is conjugate to PI for a unique subset I, and the special maximal parahoric subgroups are P{m},
P{m′}. The same description is true for the parahoric subgroup ˜PI of SU(W, φ)(L) associated with
PI .

(c) The case B - Cm: We have n = 2m. First, let us consider the case I = {m}. The Hermitian

space W is the direct sum of m hyperbolic subspaces

Hi := Ehei, en+1−ii ⊂ W (i = 1,··· , m).

75

Then, we claim that when we identify SU(Hi) with SU(Hi) × 1⊕j6=iHj ⊂ SU(W, φ),
SU(Hi)(F ) ∩ P{m} = {g ∈ SU(Hi)(F ) | g(Hi ∩ Λ{m}) = Hi ∩ Λ{m}}

is a special maximal parahoric subgroup of SU(Hi)(F ) ≃ SL2(F ) (recall that there are two SL2(F )-
conjugacy classes of special parahoric subgroups of SL2(F ), which are however conjugate under
GL2(F )). This can be proved, e.g. using an explicit isomorphism between SU(Hi) ≃ SL2,F , one
such being

g =(cid:18) a b

c d (cid:19) 7→(cid:18) a

πc

π−1b

d (cid:19)

(check that when g(ei) = aei + cen+1−i, g(en+1−i) = bei + den+1−i, φ(gv, gw) = φ(v, w) implies that
a, d ∈ F ×, b + b = c + c = 0). But, there is another (rather indirect) way of seeing this. Let Si be
a maximal (F -)split F -subtorus of SU(Hi) (so that S :=Qi SI is a maximal (F -)split F -torus of
SU(W, φ), and also of U(W, φ)); Si is contained in a unique maximal torus Ti(= CentU(Hi)(Si)) ≃
E× of U(Hi). The subgroup

Mi := U(Hi) ×Yj6=i

Tj

SMi is an F -Levi subgroup of SU(W ). Hence, by Lemma 4.2.3, (3), SMi(F ) ∩ P{m} is a special
maximal parahoric subgroup of Mi(F ). But, obviously one has that (as P{m} ⊂ SU(W )(F ))

of U(W, φ), being the centralizer of {1}×Qj6=i Sj, is an F -Levi subgroup of U(W, φ). For a subgroup
M of U(W, φ), let SM denote the intersection M ∩ SU(W, φ). Then, as {1} ×Qj6=i Sj ⊂ SU(W ),
SMi(F ) ∩ P{m} = (U(Hi)(F ) ×Yj6=i

Tj(F )) ∩ P{m} = (U(Hi)(F ) ∩ P{m}) ×Yj6=i

(Tj(F ) ∩ P{m}).

So, each SU(Hi)(F ) ∩ P{m} = U(Hi)(F ) ∩ P{m} is a special maximal parahoric subgroup of
SU(Hi)(F ) ≃ SL2(F ).
But, the two special vertices in the local Dynkin diagram of SL2,F are hyperspecial, hence we
know that there exists an anisotropic maximal torus S′
i of SU(Hi), splitting over F ur, such that the
i(L) is contained in SU(Hi)(L) ∩ ˜P{m}, i.e. leaves stable the
unique parahoric subgroup S′
OE ⊗OF OL-lattice (Hi ∩ Λ{m}) ⊗OF OL = spanOE⊗OF OL{π−iei, en+1−i} of Hi ⊗ L. Therefore, for
the center Zi ≃ E×

1(L)1 of S′

c of U(Hi),

T ′
i := S′

i · Zi

is an anisotropic maximal torus of U(Hi), whose L-rank equals 1 and whose group of L-points
also leaves stable the OE ⊗OF OL-lattice (Hi ∩ Λ{m})OL, as Zi remains anisotropic over L and
Zi(L) = (OE ⊗OF OL)1. Finally, the torus T := (Qi T ′
i )∩ SU(W, φ) is an anisotropic maximal torus
of SU(W, φ) with the same required property (its L-rank is m, equal to the L-rank of HL).
The case I = {m′} can be treated in a completely analogous way, once we switch the basis
vectors em and em+1; although such permutation does not lie in SU(W, ψ), obviously it is allowed
when applying the previous argument.

(d) We are left with the case C - Bm+1 (m ≥ 1). This is also similar to the above cases. Let E
be a (ramiﬁed) quadratic extension of F and W = F ⊕m ⊕ E ⊕ F ⊕m, viewed as a vector space over
F . We consider the quadratic form on W expressed in terms of a basis {e−m,··· , em} ∪ {e0} by

q( X1≤|i|≤m

xiei + x0e0) =

mXi=1

x−ixi + NmE/F x0,

(xi ∈ F, x0 ∈ E).

76

For i = 0,··· , m, we deﬁne a lattice Λi as before:

Λi := spanOF {π−1e−m,··· , π−1e−i−1, e−i,··· , ˇe0,··· , em} ⊕ OEe0,

where ˇe0 means as usual that it is omitted from the list (so, Λ0 = π−1spanOF {e−m,··· , e−1} ⊕
OEe0 ⊕ spanOF {e1,··· , em}).
It is obvious that the claim at hand holds for the special orthogonal group SO(W, q) if and
only if it does so for the universal covering of SO(W, q), i.e. the spin group Spin(W, q). We will
show that for any special maximal parahoric subgroup K of SO(W, q), there exists an anisotropic
maximal F -torus T such that TL contains a maximal (L-)split L-torus of SO(W, q) and T (L)1 is
contained in ˜K, the special parahoric subgroup of SO(W, q)(L) corresponding to K. Note that the
L-rank of H is m as E is ramiﬁed over F .

For a non-empty subset I of {0,··· , m}, let PI denote the stabilizer subgroup:

PI := {g ∈ SO(W, q)(F ) | gΛi ⊂ Λi, ∀i ∈ I}.

We know (deduced from [Tit79], 1.16, 4.2, cf. 3.12) that

the subgroup PI is a parahoric subgroup of SU(W, φ) and that any parahoric subgroup of SU(W, φ)
is conjugate to PI for a unique subset I, and that the special maximal parahoric subgroups are P{0}
and P{m}. The corresponding parahoric subgroup ˜P{i} of H(L) is

˜P{i} = {g ∈ SO(W, φ)(L) | gΛi ⊗OF OL ⊂ Λi ⊗OF OL}.

The idea used above for the ramiﬁed special unitary group of odd relative rank (i.e. of type
B - Cm) works here, too. Namely, the quadratic space W decomposes into the direct sum of
maximally isotropic subspaces Wiso = Fhei | 1 ≤ |i| ≤ mi and the anisotropic subspace (E ·
e0, NmE/F ). Then, SO(Wiso) is a split group, so for each j = 0, m, the parahoric subgroup P{j} ∩
SO(Wiso)(F ) is a a hyperspecial subgroup. Hence, there exists an anisotropic maximal torus T ′
j of
j(L)1 is contained in SO(Wiso)(L) ∩ ˜P{j}; the latter means that
SO(Wiso) of L-rank m, such that T ′
T ′
j(L)1 leaves stable the OL-lattice

(Wiso ∩ Λj) ⊗ OL

of Wiso⊗L. Now, it is easy to see that the anisotropic torus Tj := T ′
(which also has the L-rank m) with the same properties for Λj.

j is a maximal torus of SO(W, q)

This completes the proof of the proposition.

C Some facts on the Bruhat order of Coxeter groups

Our presentation here follows that of [Ste05], Ch. 1. Let (W, S) be a Coxeter system; so there exists
a real vector space V equipped with an inner product h , i such that W is a group of isometries
with a generating set S and a centrally-symmetric, W -invariant subset Φ ⊂ V − {0} (the root
system) such that the isometries in W are the reﬂections sβ = λ → hβ, λiβ∨ for varying β ∈ Φ,
where β∨ := 2β/hβ, βi (the coroot corresponding to β). We ﬁx a set ∆ of simple roots such that
S = {sα}α∈∆ and denote by Φ+ the set of positive roots (the set of roots in Φ which are linear
combinations of ∆ with positive coeﬃcients).

77

For w ∈ W , let l(w) denote the length of w, i.e. the minimal l ∈ N for which w = s1 ··· sl
for some si ∈ S. The Bruhat order <B of W (with respect to S) is the transitive closure of the
relations:

w <B sβw

for all w ∈ W and β ∈ Φ+ satisfying either of the following equivalent conditions:

l(w) < l(sβw) ⇔ w−1(β) ∈ Φ+.

For each J ⊂ S, we let WJ denote the (parabolic) subgroup of W generated by J, and ΦJ ⊂ Φ

the corresponding root subsystem. The subset

W J := {w ∈ W | l(w) < l(ws) for all s ∈ J}.

of W consists of the coset representatives of W/WJ of minimal length. The similarly deﬁned subset
J W of W has the same properties. We put

I W J := I W ∩ W J .

Lemma C.0.8. Suppose that θ ∈ V is dominant with stabilizer WJ . (1) The evaluation map

(W, <B) → (W θ, <B) : w 7→ wθ

is order-preserving and restricts to a poset isomorphism (W J , <B) → (W θ, <B).

(2) For any I ⊂ S, the evaluation map restricts to a bijection between I W J and

(W θ)I := {µ ∈ W θ | hα, µi > 0 for all α ∈ Φ+
I }.

The ﬁrst statement is Prop. 1.1 of [Ste05], and the second statement follows from Prop. 1.5

and Prop. 1.8.

References

[BT65] A. Borel, J. Tits. Groupes r´eductifs. Inst. Hautes ´Etudes Sci. Publ. Math. No. 27 1965

55-150.

[Bre94] L. Breen. Tannakian categories. Motives (Seattle, WA, 1991), 337-376, Proc. Sympos.

Pure Math., 55, Part 1, Amer. Math. Soc., Providence, RI, 1994.

[BT72] F. Bruhat, J. Tits. Groupes r´eductifs sur un corps local. I. Inst. Hautes ´Etudes Sci. Publ.

Math. No. 41 (1972), 5-251.

[BT84] F. Bruhat, J. Tits. Groupes r´eductifs sur un corps local. II. Sch´emas en groupes. Existence
d’une donn´ee radicielle valu´ee. Inst. Hautes ´Etudes Sci. Publ. Math. No. 60 (1984), 197-376.

[CCO14] C.-L. Chai, B. Conrad, F. Oort. Complex multiplication and lifting problems. Mathe-
matical Surveys and Monographs, 195. American Mathematical Society, Providence, RI, 2014.
x+387 pp.

78

[Del77] P. Deligne. Vari´et´es de Shimura: interpr´etation modulaire, et techniques de construction
de mod`eles canoniques. Automorphic forms, representations and L-functions (Proc. Sympos.
Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 2, 247-289, Proc. Sympos. Pure
Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[DMOS82] P. Deligne, J.S. Milne, A. Ogus, K-y. Shih. Hodge cycles, motives, and Shimura varieties.

Lecture Notes in Mathematics, 900. Springer-Verlag, Berlin-New York, 1982.

[Gir71] J. Giraud. Cohomologie non ab´elienne. Die Grundlehren der mathematischen Wis-

senschaften, Band 179. Springer-Verlag, Berlin-New York, 1971.

[Gre63] M. Greenberg. Schemata over local rings, II, Ann. Math. 78 (1963), 256-266.

[Gro12] B. Gross. Parahorics. http://www.math.harvard.edu/~gross/preprints/parahorics.pdf

[HR08] T. Haines, M. Rapoport. Appendix: On parahoric subgroups, Advances in Math. 219 (1),
(2008), 188-198. appendix to: G. Pappas, M. Rapoport, Twisted loop groups and their aﬃne
ﬂag varieties, Advances in Math. 219 (1), (2008), 118-198.

[HS10] T. Haines, S. Rostami. The Satake isomorphism for special maximal parahoric Hecke

algebras. Represent. Theory 14 (2010), 264-284.

[He15] X. He. Kottwitz-Rapoport conjecture on unions of aﬃne Deligne-Lusztig varieties.

http://arxiv.org/abs/1408.5838

[HR15] X. He, M. Rapoport.

Stratiﬁcations

in the

reduction of Shimura varieties.

http://arxiv.org/abs/1509.07752

[Kis13] M. Kisin. Mod p-points on Shimura varieties of abelian type. preprint available on

http://www.math.harvard.edu/~kisin/

[KP15] M. Kisin, G. Pappas. Integral models of Shimura varieties with parahoric level structure.

arXiv:1512.01149.

[Kot82] R. Kottwitz. Rational conjugacy classes in reductive groups. Duke Math. J. 49 (1982), no.

4, 785-806.

[Kot84a] R. Kottwitz. Stable Trace Formula: Cuspidal Tempered Terms, Duke Math. J. 51 (1984),

611-650.

[Kot84b] R. Kottwitz. Shimura Varieties and Twisted Orbital Integrals, Math. Ann. 269 (1984),

287-300.

[Kot85] R. Kottwitz. Isocrystals with additional structure. Compositio Math. 56 (1985), no. 2,

201-220.

[Kot86] R. Kottwitz, Stable Trace Formula: Elliptic Singular Terms, Math. Ann. 275 (1986),

365-399.

[Kot90] R. Kottwitz. Shimura varieties and λ-adic representations. Automorphic forms, Shimura
varieties, and L-functions, Vol. I (Ann Arbor, MI, 1988), 161-209, Perspect. Math., 10, Aca-
demic Press, Boston, MA, 1990.

79

[Kot92] R. Kottwitz. Points on some Shimura varieties over ﬁnite ﬁelds. J. Amer. Math. Soc. 5

(1992), no. 2, 373-444.

[Kot97] R. Kottwitz. Isocrystals with additional structure. II. Compositio Math. 109 (1997), no.

3, 255-339.

[KR00] R. Kottwitz, M. Rapoport. Minuscule alcoves for GLn and GSp2n. Manuscripta Math. 102

(2000), no. 4, 403-428.

[Lan83] R.P. Langlands, Les d´ebuts d’une formule des traces stable, Publ. Math. de l’Univ. Paris

VII 13, Paris 1983.

[LR87] R, P. Langlands, M. Rapoport. Shimuravariet¨aten und Gerben. J. Reine Angew. Math.

378 (1987), 113-220.

[Lee14] D.U. Lee Non-emptiness of Newton strata of Shimura varieties of Hodge type. preprint

CGP14010, available at http://cgp.ibs.re.kr/eng/preprints.ibs

[Mil92] J.S. Milne. The points on a Shimura variety modulo a prime of good reduction. The zeta

functions of Picard modular surfaces, Univ. Montral, Montreal, QC, 1992.

[Mil94] J.S. Milne. Shimura varieties and motives. Motives (Seattle, WA, 1991), 447–523, Proc.

Sympos. Pure Math., 55, Part 2, Amer. Math. Soc., Providence, RI, 1994.

[Mil03] J.S. Milne.

Gerbes

and

abelian motives.

manuscript

available

on

http://www.jmilne.org/math/articles/index.html#1990b

[Mil13] J.S. Milne.

Class ﬁeld theory.

course notes, version 4.02, 2013, available on

http://www.jmilne.org/math/CourseNotes/CFT.pdf

[PR08] G. Pappas, Rapoport, M. Twisted loop groups and their aﬃne ﬂag varieties. With an

appendix by T. Haines and Rapoport. Adv. Math. 219 (2008), no. 1, 118-198.

[PR09] G. Pappas, Rapoport, M. Local models in the ramiﬁed case. III. Unitary groups. J. Inst.

Math. Jussieu 8 (2009), no. 3, 507-564.

[PR94] V. Platonov, A. Rapinchuk. Algebraic groups and number theory. Pure and Applied

Mathematics, 139, Academic Press, Inc., Boston, MA, 1994.

[RR96] M. Rapoport, M. Richartz. On the classiﬁcation and specialization of F -isocrystals with

additional structure. Compositio Math. 103 (1996), no. 2, 153-181.

[Rap05] M. Rapoport. A guide to the reduction modulo p of Shimura varieties. Automorphic

forms. I. Ast´erisque No. 298 (2005), 271-318.

[Rei97] H. Reimann. The semi-simple zeta function of quaternionic Shimura varieties. Lecture

Notes in Mathematics, 1657. Springer-Verlag, Berlin, 1997. viii+143.

[Sh] D. Shelstad, Characters and inner forms of a quasisplit group over R, Comp. Math. 39 (1979),

11-45.

80

[Spr79] T. A. Springer. Reductive groups. Automorphic forms, representations and L-functions
(Corvallis, 1977), Proc. Sympos. Pure Math. XXXIII, Part 1, pp. 3?27, Amer. Math. Soc.,
1979.

[Spr98] T.A. Springer. Linear algebraic groups. Progress in mathematics, vol. 9, Birkh¨auser,

Boston, Mass., 1998.

[Ste05] J. R. Stembridge. Tight quotients and double quotients in the Bruhat order. Electron. J.

Combin. 11 (2004/06), no. 2.

[Tat79] J. Tate. Number theoretic background. Automorphic forms, representations and L-
functions (Corvallis, 1977), Proc. Sympos. Pure Math., XXXIII, Part 2, pp. 3-26, Amer.
Math. Soc. 1979.

[Tit79] J. Tits. Reductive groups over local ﬁelds. Automorphic forms, representations and L-
functions (Proc. Sympos. Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 1, pp.
29-69, Proc. Sympos. Pure Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[Vie15] E. Viehmann. On the geometry of the Newton stratiﬁcation. arXiv:1511.03156.

Center for Geometry and Physics, Institute for Basic Science (IBS),
Pohang 790-784, Republic of Korea
Email: dulee@ibs.re.kr

81

