Mon. Not. R. Astron. Soc. 000, 1–9 (2016)

Printed 8 March 2016

(MN LATEX style ﬁle v2.2)

The Missing Satellite Problem in 3D

A. M. Nierenberg1,2,3, T. Treu4,5, N. Menci6, Y. Lu7, Paul Torrey8,9, M. Vogelsberger8
1 Center for Cosmology and AstroParticle Physics, The Ohio State University, Columbus OH 43204, USA
2 nierenberg.1@osu.edu
3 CCAPP Fellow
4 UCLA Physics & Astronomy, 475 Portola Plaza, Los Angeles, CA 90095-1547, USA
5 Packard Fellow
6 NAF - Osservatorio Astronomico di Roma, via di Frascati 33, I-00040 Monteporzio, Italy
7 Carnegie Observatories, 813 Santa Barbara Street, Pasadena, California, 91101, USA
8 MIT Kavli Institute for Astrophysics and Space Research, 77 Massachusetts Ave. 37-241, Cambridge MA 02139,USA
9 California Institute of Technology, Pasadena, CA 91125, USA

Submitted to MNRAS

ABSTRACT
It is widely believed that the large discrepancy between the observed number of satel-
lite galaxies and the predicted number of dark subhalos can be resolved via a variety
of baryonic eﬀects which suppress star formation in low mass halos. Supporting this
hypothesis, numerous high resolution simulations with star formation, and associated
feedback have been shown to reproduce the satellite luminosity function around Milky
Way-mass simulated galaxies at redshift zero. However, a more stringent test of these
models is their ability to simultaneously match the satellite luminosity functions of
a range of host halo masses and redshifts. In this work we measure the luminosity
function of faint (sub-Small Magellanic Cloud luminosity) satellites around hosts with
stellar masses 10.5<Log10M∗/M(cid:12) < 11.5 to an unprecedented redshift of 1.5. This new
measurement of the satellite luminosity function provides powerful new constraining
power; we compare these results with predictions from four diﬀerent simulations and
show that although the models perform similarly over-all, no one model reproduces the
satellite luminosity function reliably at all redshifts and host stellar masses. This re-
sult highlights the continued need for improvement in understanding the fundamental
physics that governs satellite galaxy evolution.
Key words: dark matter – galaxies: dwarf – galaxies: evolution – galaxies: luminosity
function, mass function

1 INTRODUCTION

One of the signiﬁcant discrepancies between Λ cold dark
matter (CDM) and observation is the apparent lack of struc-
ture on sub-galactic scales. This ‘Missing Satellite Problem’
(Klypin et al. 1999; Moore et al. 1999), was ﬁrst observed in
the Local Group and has subsequently been observed in the
mass function of isolated ﬁeld galaxies (Papastergis et al.
2011).

One commonly adopted solution to the missing satel-
lite problem in the context of CDM, is that there are a large
number of low mass dark matter subhalos that do not have
detectable stars or gas. The key to this solution is devel-
oping a comprehensive understanding of star formation in
low mass halos. Simulations are now able to invoke a va-
riety of mechanisms including UV heating during reioniza-
tion, super-nova feedback, stellar winds, and tidal and ram
pressure stripping by the host halo in order to reproduce

c(cid:13) 2016 RAS

the observed luminosity function of Milky Way satellites
down to low masses at redshift zero (e.g Thoul & Wein-
berg 1996; Gnedin 2000; Kaufmann et al. 2008; Macciò et al.
2010; Springel 2010b; Guo et al. 2011a; Zolotov et al. 2012;
Brooks et al. 2013; Starkenburg et al. 2013; Wetzel et al.
2016). Presently, the baryonic solution to the missing satel-
lite problem around Milky Way-like galaxies is not unique,
with a variety of models all matching the data reasonably
well. Much more information can be gained by comparing
with observations of satellites around host galaxies of vary-
ing stellar mass and at a range of redshifts. Such a compari-
son can help distinguish between the roles of environmental
and internal processes in regulating star formation in satel-
lite galaxies.

It is also possible that the missing satellite prob-
lem is due to incorrect assumptions about dark matter.
For instance, if dark matter is warm or signiﬁcantly self-

6
1
0
2

 
r
a

M
4

 

 
 
]

.

A
G
h
p
-
o
r
t
s
a
[
 
 

1
v
4
1
6
1
0

.

3
0
6
1
:
v
i
X
r
a

2

Nierenberg et al.

interacting, small scale structure can be erased at early times
either due to ﬁnite particle velocities in the former case (e.g.
Colombi et al. 1996, and references therein), or via a combi-
nation of dark sector Silk-damping and acoustic oscillations
in the latter (Vogelsberger et al. 2015; Cyr-Racine et al.
2015). It is interesting to explore how diﬀerent dark mat-
ter scenarios aﬀect the star formation physics required to
reproduce the observed luminosity function relative to the
cold dark matter case.

Recent observations have generated a wealth of new in-
formation about satellite galaxies at low redshift, ﬁnding a
signiﬁcant dependence between the satellite luminosity func-
tion and host stellar mass and color (e.g. Guo et al. 2011a;
Liu et al. 2011; Lares et al. 2011; Strigari & Wechsler 2012;
Wang & White 2012; Nierenberg et al. 2012; Ruiz et al. 2015;
Sales et al. 2015; Lan et al. 2015). Simulations have had
varying success at reproducing these trends. For instance,
Wang & White (2012) found that the Guo et al. (2011b)
semi-analytic model applied to Millenium II halos matched
some of the trend of increasing satellite numbers with host
stellar mass, but signiﬁcantly over-predicted the number of
satellites around ∼1011.5M(cid:12) hosts relative to observations,
as well as the number of bright satellites around lower stellar
mass hosts.

In addition to host stellar mass and morphology, red-
shift provides another important dimension along which to
constrain star formation models, as diﬀerent star formation
processes occur on a broad range of time scales. Recent stud-
ies have begun to measure the number of satellites around
higher redshift hosts between z of 0.4 − 2 (Newman et al.
2012; Nierenberg et al. 2012; Tal et al. 2014). Nierenberg
et al. (2013b, (hereafter N13)) compared the measurement of
the satellite luminosity function in bins of both redshift from
0.1-0.8 and host stellar mass to theoretical predictions from
Guo et al. (2011b), Lu et al. (2012) and Menci et al. (2012),
ﬁnding that although all the models matched the luminosity
function of Milky Way satellites, they each predicted signif-
icantly diﬀerent luminosity functions in the other host mass
and redshift regimes, demonstrating the power of comparing
to observations outside of the Local Group.

In this work we extend our observation of the satel-
lite luminosity function to fainter satellites and higher red-
shifts using deep, near-IR imaging from Cosmic Assem-
bly Near-infrared Deep Extragalactic Legacy Survey (CAN-
DELS Grogin et al. 2011; Koekemoer et al. 2011). With the
power of near-IR images, we are able to double our redshift
baseline (from redshift 0.8 to 1.5) and reach an order of mag-
nitude fainter satellites at z 0.8, with respect to our previous
work. We combine the new measurement with lower red-
shift results from Nierenberg et al. (2012, (hereafter N12)),
and compare these results with four state-of-the-art simu-
lations. The models are: 1) a CDM merger tree simulation
with semi-analytic star formation(Menci et al. 2014), 2) a
WDM merger tree with the same semi-analytic star forma-
tion implementation as in the CDM case also by (Menci et al.
2014), 3) a CDM N-body simulation with Bayesian-tuned
semi-analytic star formation from Lu et al. (2014) and 4)
Illustris which is a CDM N-body simulation with hydrody-
namical star formation (Vogelsberger et al. 2014b).

For the observational results, we assume a ﬂat ΛCDM
cosmology with h = 0.7 and Ωm = 0.3. We note that al-
though these values are slightly diﬀerent from those used in

each of the simulations, the variations caused by adjusting
these parameters are much smaller than the measurement
uncertainties. All magnitudes are given in the AB system
(Oke 1974).

2 DATA
To study the properties of satellites at a wide range of red-
shifts, we combine data from the COSMOS ﬁeld (Scoville
et al. 2007)and the CANDELS ﬁelds. The relatively wide
COSMOS survey has ∼1.7 square degrees of HST F814
imaging, and is useful for constraining the satellite lumi-
nosity function at lower redshift and for higher stellar mass
hosts. All results from COSMOS I814 imaging in this work
are taken from N12 which contains a detailed discussion of
the data that was used.
CANDELS has ∼0.25 square degrees of deep, near-
infrared F160W, F140W and F125W HST imaging which
enables the detection of fainter satellite galaxies at higher
redshifts than COSMOS. To detect satellites in CANDELS,
we make extensive use of data products provided by the 3D-
HST team (Brammer et al. 2012; Skelton et al. 2014), which
include reduced HST imaging as well as photometric, stellar
mass and redshift catalogs.

2.1 Host galaxy selection
We study satellites around host galaxies with stellar masses
10.5< log10[M∗/M(cid:12)] < 11.5 between redshifts 0.1<z<1.5,
using the stellar mass and redshift catalogs from the 3D-
HST survey for CANDELS, and from Ilbert et al. (2009);
Lilly et al. (2007) for COSMOS. The host stellar mass lim-
its were selected to ensure suﬃcient signal of at least ∼ one
satellite per host on the low mass end, and a well constrained
halo-mass to stellar mass relation on the higher mass end.
The latter restriction is important because we select satel-
lites based on R200 of the hosts. Where possible, spectro-
scopic redshifts were used, otherwise photometric redshifts
were used from Ilbert et al. (2009) in COSMOS, and from
3D HST photometric catalogs in CANDELS for objects with
photometric redshift quality indicator Qz < 3 as recom-
mended by Brammer et al. (2008).

We require hosts to be isolated, deﬁned by being at least
R200 away from all galaxies more than twice as massive and
at the same redshift (z − zhost)/zhost < 0.007. We estimate
R200 from the stellar mass to halo mass relation from Dutton
et al. (2010).
In total, COSMOS contains 3038 host galaxies between
redshifts 0.1 − 0.8 which matched our criteria. Figure 1 of
N12 shows the stellar mass distribution in bins of redshift
for COSMOS hosts. The deeper and narrower CANDELS
has 1708 host galaxies between redshifts 0.4 to 1.5. Figure
1 shows the stellar mass distribution of CANDELS hosts in
bins of redshift.

2.2 CANDELS Satellite candidate selection
We use the 3D HST PSF-matched photometric catalogs to
select the majority of satellite candidates. These catalogs
were created with SourceExtractor (Bertin & Arnouts 1996,
hereafter SE) on PSF matched, variance weighted mean

c(cid:13) 2016 RAS, MNRAS 000, 1–9

Missing Satellites in 3D 3

3 STATISTICAL ANALYSIS

We detect satellites statistically in monochromatic F160W
data in CANDELS (F814 for COSMOS), as an increase
in the number density of objects relative to the back-
ground/foreground number density measured outside of the
host galaxy R200. The statistical model framework is de-
scribed in detail
in N11 and N12. The measurement is
made in two subdivided bins of host stellar mass 10.5<
log10[M∗/M(cid:12)] < 11, 11< log10[M∗/M(cid:12)] < 11.5 and three
bins of redshift 0.1 < z < 0.4, 0.4 < z < 0.8, 0.8 < z < 1.5.
Each redshift and host stellar mass bin, is treated as an inde-
pendent data set. Results for CANDELS and COSMOS are
inferred separately. Model parameter deﬁnitions and priors
are listed in Table 1 for CANDELS, and Table 1 in N12 for
the COSMOS.

In brief, the number density of objects around the host
galaxies is parametrised as the sum of a uniformly dis-
tributed number of background/foreground objects, and a
population of satellite galaxies with a power-law spatial dis-
tribution with projected slope γp, such that P (rsat) ∝ rγp
sat.
In this work, we update the model relative to N11 and
N12, by directly inferring the slope and bright end cutoﬀ
of the satellite luminosity function rather than iteratively
inferring the cumulative number of satellites brighter than
a ﬁxed δm = msat − mhost, for a series of δm values. We
model the luminosity function of satellites in units of δm as
a Schechter function with faint end slope αs and bright end
cutoﬀ of δm,o:

P (δm,sat|αs, δm,o) ∝ 10

αs+1

2.5 (δm,o−δm,sat)×
exp [−10(δm,o−δm,sat)]

(1)

The total model number of satellites per host, Ns,o be-
tween 0.07 <r/R200 < 0.5 is deﬁned between δm,min,o and
δm,max,o, the minimum and maximum values respectively
where the luminosity function can be measured reliably for
the majority of the sample. These values vary depending on
the average magnitude of the hosts in each redshift bin, as
δm,max,o for a given host is 25 − mhost, the satellite lumi-
nosity function of brighter hosts can be measured to lower
values of δm. Table 1 gives the values of the limits δm,min,o
and δdm,max,o selected for the inference in each host redshift
and stellar mass bin.

We adopt priors on the satellite spatial distribution,
the background/foreground number density, and the slope
of the background/foreground luminosity function. In N12
we found that γp = −1.1±0.3 over a wide range of redshifts,
satellite luminosities and host stellar masses and morpholo-
gies, so for this work we adopt a Gaussian prior on γp with
mean -1.1 and standard deviation 0.3. As we show in N12,
adopting this prior does not aﬀect the mean inferred num-
ber of satellites, but it does decrease the uncertainty, and
is useful for constraining the properties of satellites around
the much smaller sample of CANDELS host galaxies.

of

We

the

constrain

of
the
outside

back-
properties
ground/foreground galaxy in annuli
the
region where we detect satellite galaxies. This method
has been shown to accurately characterise the density of
both random line of sight structure, as well as correlated
structure which is not gravitationally bound to the host
galaxies (Chen 2008; Liu et al. 2011). We select annuli
between 1<R/R200,host < 2 to measure both the back-

Figure 1. The stellar mass distribution of host galaxies in CAN-
DELS divided into bins of redshift. Figure 1 of N12 shows the
corresponding distribution of host galaxies in COSMOS.

combined F160W, F140W and F125W images. Satellite can-
didates include all non-stellar 1 objects brighter than F160W
< 25 AB magnitudes between 0.07 <R/R200,host < 0.5
where R200,host is estimated based on the host stellar mass
and stellar mass to halo mass relation from Equation 3 of
Dutton et al. (2010) for early-type galaxies. The limit of
F160W<25 magnitude is chosen to ensure over 90% detec-
tion completeness in both the CANDELS deep and wide
imaging based on Figure 14 from (Skelton et al. 2014),
while the radial limits ensure accurate photometry near the
host galaxies, and a favorable ratio of satellites to back-
ground/foreground objects in the outer region.

As we demonstrated in Nierenberg et al. (2011, here-
after, N11) and N12, even with deep, high resolution
HST imaging, photometric accuracy and completeness suf-
fer within several eﬀective radii of a bright central galaxy.
To counter this, we empirically model and subtract the host
light proﬁle, and then perform our own object detection and
photometry in small regions near the host galaxies, using
SE parameters which match those used to create the 3D
HST catalogs. We then add the new object detections to
the full 3D HST catalogs, and update the photometry only
for the region near the host galaxies. This method improves
completeness and photometric accuracy very near the host
galaxies (N11, N12). We perform the empirical host subtrac-
tion separately in both the detection image, as well as in the
F160W science image. We then apply the same empirical
photometric correction to the F160W MAG_AUTOs as ap-
plied to make the 3DHST photometric catalogs (see Skelton
et al. 2014, Figure 10).

1 SE CLASS_STAR< 0.8 and 3D HST star_flag !=1

c(cid:13) 2016 RAS, MNRAS 000, 1–9

Host Log10[M∗/Mﬂ]Number10.510.710.911.111.311.50204060801001201400204060801001201400.4<z<0.80.8<z<1.54

Nierenberg et al.

ground/foreground number density, Σb, and the slope of
the number counts αb, where Nb(m) ∝ Σb10αbm. These
values do not depend strongly on the choice of the annuli
radius, given the measurement uncertainty. We include Σb
and αb as model parameters with Gaussian priors with
mean and standard deviations given by the values measured
in the outer annuli. This enables us to directly account for
the eﬀects of measurement uncertainties in Σb and αb in
the inferred satellite properties. The prior values for these
parameters are listed in Table 1.

4 RESULTS
The inferred median values and 1σ uncertainties for the
satellite luminosity function parameters in CANDELS are
given in Table 2 for the four host stellar mass and red-
shift bins. For all host stellar mass and redshift regimes, the
prior values for the projected number density radial proﬁle of
satellites γp, the number density of foreground/background
objects and the slope of the background/foreground num-
ber counts were recovered, with no tightening of the con-
straints. This was expected given that the prior on γp is
derived from the much larger COSMOS sample, while the
background/foreground number density is measured in a
much larger region than the region in which satellite prop-
erties are inferred. Figure 2 shows the inferred cumulative
satellite luminosity function for CANDELS (dark hatched
region) and COSMOS (black points) with satellite numbers
extrapolated to be between 0.07 <r/R200,host < 1 based on
the inferred value of the slope of the satellite number density
radial proﬁle γp.

For CANDELS we plot in black, regions which do not
overlap with COSMOS, and which had a signiﬁcant number
of hosts (> 10) with δm,max,i = 25−mhost, to ensure that the
luminosity function is well constrained by the data. In light
grey we show the extrapolation of the luminosity function
to fainter values of δm where the data is less constraining,
which is reﬂected in the increased uncertainty in the inferred
luminosity function at these values. We also extrapolate the
CANDELS results to brighter values of δm to demonstrate
the consistency with COSMOS results, and to show the over-
all shape of the luminosity function in the higher redshift
bin. The number of satellites is well constrained and con-
sistent with prior measurements of the luminosity function
from COSMOS. N12 gives a detailed comparison between
the lower redshift (0.1<z< 0.4) COSMOS results and other
results from the literature.
The inferred slope of the satellite luminosity function is
αs ∼ −1±0.5, consistent within the measurement uncertain-
ties for all the redshift and host stellar mass regimes. The
bright cutoﬀ, δm,o is approximately 1 ± 1, again consistent
between the four regimes.
This result is broadly consistent within the measure-
ment uncertainties with the low redshift z∼ 0.01 − 0.05 lu-
minosity function measurement of satellites brighter than
Mr ∼ −14 from Lan et al. (2015) which ﬁt a double
Schechter function to their satellites and found a slope of
∼ −1 for satellites with absolute magnitudes brighter than
-18 (corresponding to δm values of ∼ 2−3 depending on host
stellar mass), and slope of ∼ −1.6 for satellites fainter than
-18. Our result is also consistent with measurements of the

Log[M∗

host/M(cid:12)]

10.5-11.0
10.5-11.0
11.0- 11.0
11.0-11.5

zhost

0.4-0.8
0.8-1.5
0.4-0.8
0.8 -1.5

Ns,o

3+1−1 (3-6)
0.7+0.6−0.4 (2-4.5)
3+3−2 (2-5)
3+1−1 (2-5)

αs

-1.2+0.4−0.6
-0.8+0.5−0.7
-0.8+0.5−0.7
-1.1+0.6−0.5

δm,o

1+1−1
0.9+1−1
2+1−2
0.9+1−2

Table 2. Inferred median and one sigma conﬁdence intervals for
the parameters deﬁning the satellite luminosity function, in bins
of host galaxy stellar mass and redshift. Parameters are deﬁned
in Table 1. Note that the normalisation of the luminosity function
Ns,o, is deﬁned over diﬀerent intervals of δm = msat − mhost of
the luminosity function for each of the bins, shown in parentheses
to account for the fact that the completeness varies with redshift
and host stellar mass.

slope of the stellar mass function of ﬁeld galaxies and satel-
lites between redshifts ∼ 0− 4 which typically ﬁnd values of
α between -1 to -2 (Grazian et al. 2015; Duncan et al. 2014;
Baldry et al. 2012; Santini et al. 2012; Graus et al. 2016;
Lan et al. 2015, e.g.). Our data is not constraining enough
to test whether satellite galaxies follow the ﬁeld galaxy trend
of decreasing α with increasing redshift.

It is interesting to compare these new high redshift
satellite observations with local observations of Milky Way
mass hosts. Assuming the Milky Way has approximately
doubled in stellar mass since z∼ 1 (e.g. Behroozi et al. 2010;
Lehnert et al. 2014), Milky Way progenitors fall on the lower
end of the lower stellar mass hosts in the redshift bin 0.8-1.5.
Hosts in this stellar mass bin have ∼ 2±0.7 satellite galaxies
with δm > 4, and ∼ 0.8 ± 0.3 with δm > 2 corresponding to
the present day magnitude oﬀsets between the Small Magel-
lanic Cloud (SMC) and the Milky Way, and the Large Mag-
ellanic Cloud (LMC) and the Milky Way respectively. This
frequency is marginally higher, but still consistent within
the measurement uncertainties, with low redshift observa-
tions where Milky Way stellar mass hosts have about 0.3±
0.1 and 0.2 ± 0.1 SMCs and LMCs respectively (see also Liu
et al. 2011; Guo et al. 2011a; Lares et al. 2011).

5 COMPARISON WITH THEORETICAL

MODELS

This new measurement of faint satellites provides a new con-
straint for models of galaxy formation. We compare our
results with four theoretical predictions described below.
Three of the predictions are from either semi-analytic or
hydrodynamical models applied to cold dark matter cos-
mologies, and the fourth prediction is a semi-analytic model
applied to a warm dark matter cosmology.

5.1 Menci
The Menci model is a semi-analytic model applied to dark
matter merging trees. We include a summary of the dark
matter and semi-analytic models below, we refer the reader
to Menci et al. (2014) for a detailed description.

In this work we consider both a Cold and a Warm dark
matter merging tree. Both models track subhalos after they
have entered the virial radius of the main halo, enabling
them to coalesce with the central galaxy after orbital energy

c(cid:13) 2016 RAS, MNRAS 000, 1–9

Missing Satellites in 3D 5

Parameter Description

Prior

Ns,o
αs
δm,o
γp
Σb
αb

Integrated number of satellites with δm,min,o < δm < δm,max,o
U(0,100)a
Faint end slope of the satellite luminosity function (Equation 1) U(-2.9, 0)
Bright cutoﬀ of the satellite luminosity function (Equation 1)
Projected satellite number density radial proﬁle
Number of background/foreground galaxies per arcmin2
Slope of background/foreground magnitude number counts

U(-8, 4)
G(-1.1, 3)b
Gaussian, varies with host mass, redshift and ﬁeld.
G(0.28,0.01)

Table 1. Model parameter deﬁnitions and priors. (a) U(min,max) is a uniform prior between the min and max values. (b) G(mean, std)
is a Gaussian prior deﬁned by the mean and standard deviation.

loss due to dynamical friction, merge with another sub-halo,
or survive as a satellite halo. Cold Dark Matter halo merg-
ing trees are generated through a Monte Carlo procedure
adopting the merging rates given by the Extended Press
& Schechter (EPS, see Lacey & Cole 1993) formalism. The
WDM power spectrum is generated using the method de-
scribed by Menci et al. (2012), with some modiﬁcations for
the present work. First, we have included a sharp-k ﬁlter to
relate the power spectrum to the variance of density pertur-
bations (see Benson et al. 2013; Schneider et al. 2013). Sec-
ondly, we assume a thermal relic mass mX = 1.5 keV for the
WDM candidate which yields a power spectrum correspond-
ing to that produced by (non-thermal) sterile neutrinos with
mass msterile ≈ 6 − 12 keV, depending on the produc-
tion mechanism (see, e.g. Kusenko 2009; Destri et al. 2013).
Indeed, these constitute the simplest candidates (see e.g.
Abazajian 2014) for a dark matter interpretation of the ori-
gin of the recent unidentiﬁed X-ray line reported in stacked
observations of X-ray clusters (Bulbul et al. 2014; Boyarsky
et al. 2014). This particle mass is consistent with observa-
tional limits (mX (cid:38) 1.5 keV) from high redshift galaxies
Schultz et al. (2014) and ultra-faint dwarf galaxies (Lovell
et al. 2012, 2014; Horiuchi et al. 2014), although still in ten-
sion with Lyman-α forest constraints which yield mX (cid:38) 3.3
keV (Viel et al. 2013). A discussion of the various uncertain-
ties which may aﬀect the constraints is given in Abazajian
et al. (2011) and in Garzilli et al. (2015).

The processes aﬀecting baryons are connected in the
same way to the evolution of both Cold and Warm dark
matter halos. The baryonic model includes atomic cooling
into rotationally supported discs following Mo et al. (1998).
Star formation occurs quiescently over long time scales (∼ 1
Gyr), and in bursts (∼ 1 Myr) triggered by galaxy interac-
tions and disc instabilities. Star formation is suppressed via
feedback from supernova and active galactic nuclei as de-
scribed in Menci et al. (2008). The luminosity is computed
by convolving the star formation histories of the galaxy pro-
genitors with a synthetic spectral energy distribution, which
we take from Bruzual & Charlot (2003) assuming a Salpeter
IMF. The model includes tidal stripping of part of the stel-
lar content of each satellite galaxy following Henriques &
Thomas (2010).

5.2 Lu
The Lu model is a semi-analytic model applied to a set of
halo merger trees extracted from a large cosmological N-
body simulation, the Bolshoi Planck simulation, which is
same as the Bolshoi simulation (Klypin et al. 2011), but

c(cid:13) 2016 RAS, MNRAS 000, 1–9

with a cosmology favored by Planck data (Planck Collabo-
ration et al. 2015) with parameters Ωm,0 = 0.30711, ΩΛ,0 =
0.69289, Ωb,0 = 0.048, h = 0.7, n = 0.96, and σ8 = 0.82.
The mass resolution of the simulation allows the model to
track halos and subhalos with mass ∼ 7 × 109M(cid:12)h−1. The
prescriptions for the baryonic processes implemented in the
SAM are detailed in Lu et al. (2014). The model parameters
governing star formation and feedback are tuned using an
MCMC optimization to match the local galaxy stellar mass
function (Moustakas et al. 2013). Therefore, it is guaran-
teed to produce a global galaxy stellar mass function for the
stellar mass range between 109 and 1012M(cid:12) at redshift zero
within the observational uncertainty for the given parame-
terization of the model.

Illustris

5.3
The Illustris simulation (Vogelsberger et al. 2014b) mod-
eled a 106 Mpc3 volume including both dark matter and
baryons using the AREPO simulation code (Springel 2010a).
The Illustris model includes a range of physical processes
(including radiative gas cooling, star formation, stellar feed-
back, and AGN feedback) that have been tuned to produce
broad agreement with the cosmic star formation rate den-
sity and redshift z = 0 stellar mass function (Vogelsberger
et al. 2013; Torrey et al. 2014). For a full description of the
Illustris simulation setup, see Vogelsberger et al. (2014a)
and Genel et al. (2014). The galaxy luminosities used here
are assigned using the methods described in Torrey et al.
(2015).

5.4 Comparison Results
We compute the satellite luminosity function from the Lu
and Illustris simulations by including all objects within R200
of a host halo, where R200 is estimated using the same stel-
lar mass to halo mass relation as was applied to the ob-
servations (Dutton et al. 2010). We note that the number
of objects within R200 is signiﬁcantly lower than the total
number of subhalos identiﬁed by the FOF algorithm for both
Illustris and Lu models. However, the number does not de-
pend strongly on whether the Dutton et al. (2010) relation is
used to estimate the host virial radius, or whether the sim-
ulation value of Rvir is directly used. For the Menci CDM
and WDM merging trees, we directly use the simulation def-
inition of satellite membership which is determined by the
host virial radius.

We compute the χ2 between the model number of satel-
lites per host and the measured numbers as a function of

6

Nierenberg et al.

δm, for discrete values of δm spaced in intervals of 0.5 for
COSMOS data and 1 for CANDELS data. In regions where
both CANDELS and COSMOS data overlapped, the COS-
MOS data is used in the comparison with theory owing to its
higher precision. Although our data is composed of measure-
ments in both F814W and F160W, the luminosity function
of satellites as a function of δm = msat − mhost does not
have a signiﬁcant dependence on observed band in any of
the theoretical models for redshifts < 0.8.

We include the covariance between data points in our
χ2 estimate, which is signiﬁcant owing to the fact that we
are considering the cumulative numbers of satellites, and
thus the same host galaxy will contribute to the number
of satellites in multiple bins. The covariance matrix be-
tween data points was computed using 2500 draws from the
Markov Chain Monte Carlo results for CANDELS while for
COSMOS it was computed by bootstrap resampling the in-
put data and re-inferring the satellite numbers. The black
hatched region of the CANDELS measurement shows the
range of CANDELS data which was used to compute the
χ2.

Table 2 lists the χ2 values between the models and ob-
served luminosity for each bin in host stellar mass and red-
shift, along with the corresponding number of data points.
The χ2 values were 61, 72 and 59 for the Lu, Menci and
Illustris CDM models, and 54 for the Menci WDM model
for 53 degrees of freedom. Accounting for the number of
degrees of freedom, the χ2 goodness-of-ﬁt test gives an ap-
proximately ∼ 20%, 5%, 15% and 60% chance that the data
was drawn from each model respectively. These values are
approximately equivalent, with only the Menci CDM model
being somewhat disfavoured relative to the others, but at
less than a 2σ conﬁdence, and the Menci WDM model per-
forming the best.

6 DISCUSSION
This data provides an important new constraint for mod-
els of satellite galaxy formation and evolution. While over-
all there is not a strong preference for a particular model,
it is interesting to consider how the models performed in
the diﬀerent regimes. In particular, the Menci WDM model
provides the best overall match to the luminosity function
around higher mass hosts while the Lu and Illustris models
match the luminosity function of low-mass hosts at low red-
shifts. There is some tension between the numbers of faint
satellites in the redshift range 0.4−0.8 for lower stellar mass
hosts, for all of the models, which somewhat underestimate
the slope of the satellite luminosity function. Overall, mod-
els which produce accurate predictions for Milky Way mass
hosts at low redshifts tend to underestimate the number
satellite galaxies found around those hosts at higher red-
shifts and at higher stellar masses, and vice versa.

This measurement provides complementary constraints
to measurements of ﬁeld galaxy properties. In particular,
the Illustris and Menci CDM models both signiﬁcantly over-
predict the number of low mass log10M∗/M(cid:12) < 10 ﬁeld
galaxies at redshift zero by a factor of ∼ 3− 5 (Vogelsberger
et al. 2014a; Genel et al. 2014; Menci et al. 2012). While
stronger feedback might resolve this discrepancy, in the case
of Illustris, it would lead to a further suppression of the

satellite luminosity function relative to observation. The Lu
model matches the ﬁeld luminosity function well at redshift
zero but tends to under-predict the slope of the luminosity
function at higher redshift (Lu et al. 2014). As shown in Lu
et al. (2014) the model also underestimates the metallicities
of low mass galaxies owing to the strong feedback imple-
mentation. One possible solution to these discrepancies in
the context of a CDM cosmology may be in the form of a
diﬀerent feedback model such as the preventative feedback
model of (Lu et al. 2015), in which star formation is sup-
pressed due to the pre-heated intergalactic medium, rather
than via ejective feedback processes such as outﬂows. This
mode of suppression better reproduces the observed cold
gas fractions, star formation histories and sizes of low mass
galaxies for ﬁeld galaxies, although it has yet to be tested for
satellite galaxies. Preventative feedback may also impact the
simulated mass-metallicity relation by reducing fraction of
metals that are ejected from the galaxy (Zahid et al. 2014).
An interesting result of this comparison is that the vari-
ation between the predicted luminosity function in CDM
models with diﬀerent star formation models is as great as the
variation between the CDM and WDM models with ﬁxed
star formation. The Menci WDM model provided the clos-
est match to the data, but it under-predicted the slope of the
satellite luminosity function at higher redshifts around the
lower stellar mass host galaxies in a similar way to the CDM
models. In a future work it would be interesting to compare
observational results with a broader range of dark matter
models such as those generated by ETHOS (Vogelsberger
et al. 2015; Cyr-Racine et al. 2015). A direct measurement
of the low mass halo mass function via gravitational lensing
would provide a powerful constraint for these dark matter
models (Treu 2010, and references therein) and therefore
play an important role in constraining the star formation
physics in low mass halos. In order to understand how lu-
minous satellites populate the subhalos detected in gravi-
tational lensing studies, it is important to study luminous
satellites around gravitational-lens stellar mass hosts (see
also Nierenberg et al. 2013a; Fiacconi et al. 2016).

7 SUMMARY
Using CANDELS F160W imaging, we measure the lumi-
nosity function of faint satellites around hosts with stellar
masses between 10.5 <Log10M∗/M(cid:12) < 11.5 to a redshift of
1.5. The deep imaging enables us to detect satellites with
δm =msat-mhost = 4 (fainter than the SMC) to an unprece-
dented redshift of 1.5, and to detect δm = 7 satellites be-
tween redshifts 0.4-0.8. We combine these new results with
lower redshift (0.1-0.8) measurements from F814 COSMOS
imaging from Nierenberg et al. (2012). We compare these
results to predictions from four theoretical models (Menci
et al. 2012, 2014; Lu et al. 2014; Vogelsberger et al. 2014a).
While none of the models was signiﬁcantly ruled out, dif-
ferent models matched the observations more or less well
in diﬀerent regimes of redshift and host stellar mass, which
highlights the value of this data set in distinguishing between
models which performed similarly at redshift zero around
Milky-Way-mass host galaxies. This data provides impor-
tant new constraining power for future implementations of
feedback and dark matter physics in these models.

c(cid:13) 2016 RAS, MNRAS 000, 1–9

Missing Satellites in 3D 7

Log10[M∗
10.5- 11
11- 11.5
10.5- 11
11- 11.5
10.5- 11
11- 11.5

z
0.1 − 0.4
0.4 − 0.8
0.8 − 1.5

Total

13
13
9
11
4
4

host/M(cid:12)] # Data Points Menci CDM Menci WDM Lu
10
12
13
18
5
3

18
10
11
9
2
2

17
14
6
31
2
2

54

72

55

59

Illustris

9
11
12
20
5
2

61

Table 3. Model χ2 values, after accounting for covariance in the data, for each host stellar mass and redshift bin. We note that a
continuous luminosity function is inferred CANDELS data, but to compare with predictions from simulations we sample the luminosity
function values at discreet points spaced every 0.5 δm within the dark hatched region of Figure 2.

Figure 2. The cumulative luminosity function of satellite galaxies of hosts divided by bins of redshift (from left to right) and stellar mass
(from top to bottom) between 0.07<r/R200 < 1.0. Black points with error bars and hatched region show the one sigma conﬁdence interval
from COSMOS F1814W and CANDELS F160W imaging respectively. The black points and hatched region were used to compute χ2
values for the comparison with theory, while the gray region represents extrapolations of the inferred luminosity function. Blue, purple
and red lines lines are theoretical predictions with Cold Dark Matter from Lu et al. (2014), Menci et al. (2014), and Illustris (Vogelsberger
et al. 2014b). The green luminosity function is the same star formation model as for the Menci CDM model, but applied to a Warm
Dark Matter halo mass function (Menci et al. 2012).

Our conclusions are summarised as follows:

(i) We infer the parameters of the satellite luminosity
function faint end slope to be αs = −1± 0.5, and the bright
cutoﬀ relative to the host magnitude to be δm,o = 1 ± 1,
consistent over all redshift and stellar host stellar mass bins
within the measurement uncertainties.

(ii) We detect Small Magellanic Cloud-luminosity satel-
lite galaxies to a redshift of 1.5, and ﬁnd that Milky Way-
like progenitors at redshift ∼ 1 have consistent numbers of
LMC/SMC analogs with redshift zero galaxies. In general,
the cumulative number of satellites per host as a function of
the oﬀset between host and satellite magnitude is constant
as a function of redshift within the measurement uncertain-
ties, but is higher for hosts with higher stellar masses.

c(cid:13) 2016 RAS, MNRAS 000, 1–9

(iii) The theoretical models varied in their ability to pre-
dict the satellite luminosity function in diﬀerent regimes
of host stellar mass and redshift. Overall they performed
similarly, however, models which ﬁt the luminosity function
of the satellites of low stellar mass hosts tended to under-
predict the number of satellites around higher stellar mass
hosts. Future predictions will need an adjusted implemen-
tation of stellar feedback as a function of host stellar mass
and redshift in order to resolve this discrepancy.

ACKNOWLEDGMENTS
We thank R. Skelton and I. Momcheva for very helpful dis-
cussions and support with the 3D-HST data. Support for

mhost−msatN(<mhost−msat)3570.11.010.0357CANDELSNierenberg et al. 2012357Menci, CDMMenci, WDM0.11.010.0LuIllustris0.1<z<0.410.5<log10[M∗host/Mﬂ]<11.00.4<z<0.810.5<log10[M∗host/Mﬂ]<11.00.8<z<1.510.5<log10[M∗host/Mﬂ]<11.011.0<log10[M∗host/Mﬂ]<11.511.0<log10[M∗host/Mﬂ]<11.511.0<log10[M∗host/Mﬂ]<11.58

Nierenberg et al.

this work was provided by NASA through grant number
HST-AR 13732 from the Space Telescope Science Institute,
which is operated by AURA, Inc., under NASA contract
NAS 5-26555.

The Bolshoi and MultiDark simulations have been per-
formed within the Bolshoi project of the University of
California High-Performance AstroComputing Center (UC-
HiPACC) and were run at the NASA Ames Research Center.
The MultiDark-Planck (MDPL) and the BigMD simulation
suite have been performed in the Supermuc supercomputer
at LRZ using time granted by PRACE.

PT acknowledges support from NASA ATP Grant
NNX14AH35G. PT and MV acknowledge support through
an MIT RSC award. The Illustris simulation was run on the
CURIE supercomputer at CEA/France as part of PRACE
project RA0844, and the SuperMUC computer at the Leib-
niz Computing Centre, Germany, as part of project pr85je.
The analysis presented in this paper was run on the Har-
vard Odyssey and CfA/ITC clusters and though allocation
TG-AST150059 granted by the Extreme Science and Engi-
neering Discovery Environment (XSEDE) supported by the
NSF.

REFERENCES
Abazajian, K. N. 2014, Physical Review Letters, 112,
161303
Abazajian, K. N., Calabrese, E., Cooray, A., et al. 2011,
Astroparticle Physics, 35, 177
Baldry, I. K., Driver, S. P., Loveday, J., et al. 2012, MN-
RAS, 421, 621
Behroozi, P. S., Conroy, C., & Wechsler, R. H. 2010, ApJ,
717, 379
Benson, A. J., Farahi, A., Cole, S., et al. 2013, MNRAS,
428, 1774
Bertin, E., & Arnouts, S. 1996, A&AS, 117, 393
Boyarsky, A., Ruchayskiy, O., Iakubovskyi, D., & Franse,
J. 2014, Physical Review Letters, 113, 251301
Brammer, G. B., van Dokkum, P. G., & Coppi, P. 2008,
ApJ, 686, 1503
Brammer, G. B., van Dokkum, P. G., Franx, M., et al.
2012, ApJS, 200, 13
Brooks, A. M., Kuhlen, M., Zolotov, A., & Hooper, D. 2013,
ApJ, 765, 22
Bruzual, G., & Charlot, S. 2003, MNRAS, 344, 1000
Bulbul, E., Markevitch, M., Foster, A., et al. 2014, ApJ,
789, 13
Chen, J. 2008, A&A, 484, 347
Colombi, S., Dodelson, S., & Widrow, L. M. 1996, ApJ,
458, 1
Cyr-Racine, F.-Y., Sigurdson, K., Zavala, J., et al. 2015,
ArXiv e-prints
Destri, C., de Vega, H. J., & Sanchez, N. G. 2013, Phys.
Rev. D., 88, 083512
Duncan, K., Conselice, C. J., Mortlock, A., et al. 2014,
MNRAS, 444, 2960
Dutton, A. A., Conroy, C., van den Bosch, F. C., Prada,
F., & More, S. 2010, MNRAS, 407, 2
Fiacconi, D., Madau, P., Potter, D., & Stadel, J. 2016,
ArXiv e-prints

Garzilli, A., Boyarsky, A., & Ruchayskiy, O. 2015, ArXiv
e-prints
Genel, S., Vogelsberger, M., Springel, V., et al. 2014, MN-
RAS, 445, 175
Gnedin, N. Y. 2000, ApJL, 535, L75
Graus, A. S., Bullock, J. S., Boylan-Kolchin, M., & Weisz,
D. R. 2016, MNRAS, 456, 477
Grazian, A., Fontana, A., Santini, P., et al. 2015, A&A,
575, A96
Grogin, N. A., Kocevski, D. D., Faber, S. M., et al. 2011,
ApJS, 197, 35
Guo, Q., Cole, S., Eke, V., & Frenk, C. 2011a, MNRAS,
1278
Guo, Q., White, S., Boylan-Kolchin, M., et al. 2011b, MN-
RAS, 413, 101
Henriques, B. M. B., & Thomas, P. A. 2010, MNRAS, 403,
768
Horiuchi, S., Humphrey, P. J., Oñorbe, J., et al. 2014, Phys.
Rev. D., 89, 025017
Ilbert, O., Capak, P., Salvato, M., et al. 2009, ApJ, 690,
1236
Kaufmann, T., Bullock, J. S., Maller, A., & Fang, T. 2008,
in American Institute of Physics Conference Series, Vol.
1035, The Evolution of Galaxies Through the Neutral Hy-
drogen Window, ed. R. Minchin & E. Momjian, 147–150
Klypin, A., Kravtsov, A. V., Valenzuela, O., & Prada, F.
1999, ApJ, 522, 82
Klypin, A. A., Trujillo-Gomez, S., & Primack, J. 2011, ApJ,
740, 102
Koekemoer, A. M., Faber, S. M., Ferguson, H. C., et al.
2011, ApJS, 197, 36
Kusenko, A. 2009, Physics Reports, 481, 1
Lacey, C., & Cole, S. 1993, MNRAS, 262, 627
Lan, T.-W., Ménard, B., & Mo, H. 2015, ArXiv e-prints
Lares, M., Lambas, D. G., & Domínguez, M. J. 2011, AJ,
142, 13
Lehnert, M. D., Di Matteo, P., Haywood, M., & Snaith,
O. N. 2014, ApJL, 789, L30
Lilly, S. J., Le Fèvre, O., Renzini, A., et al. 2007, ApJS,
172, 70
Liu, L., Gerke, B. F., Wechsler, R. H., Behroozi, P. S., &
Busha, M. T. 2011, ApJ, 733, 62
Lovell, M. R., Frenk, C. S., Eke, V. R., et al. 2014, MNRAS,
439, 300
Lovell, M. R., Eke, V., Frenk, C. S., et al. 2012, MNRAS,
420, 2318
Lu, Y., Mo, H. J., Katz, N., & Weinberg, M. D. 2012, MN-
RAS, 421, 1779
Lu, Y., Mo, H. J., & Wechsler, R. H. 2015, MNRAS, 446,
1907
Lu, Y., Wechsler, R. H., Somerville, R. S., et al. 2014, ApJ,
795, 123
Macciò, A. V., Kang, X., Fontanot, F., et al. 2010, MNRAS,
402, 1995
Menci, N., Fiore, F., & Lamastra, A. 2012, MNRAS, 421,
2384
Menci, N., Gatti, M., Fiore, F., & Lamastra, A. 2014, A&A,
569, A37
Menci, N., Rosati, P., Gobat, R., et al. 2008, ApJ, 685, 863
Mo, H. J., Mao, S., & White, S. D. M. 1998, MNRAS, 295,
319

c(cid:13) 2016 RAS, MNRAS 000, 1–9

Missing Satellites in 3D 9

This paper has been typeset from a TEX/ LATEX ﬁle prepared
by the author.

Moore, B., Ghigna, S., Governato, F., et al. 1999, ApJL,
524, L19
Moustakas, J., Coil, A. L., Aird, J., et al. 2013, ApJ, 767,
50
Newman, A. B., Ellis, R. S., Bundy, K., & Treu, T. 2012,
ApJ, 746, 162
Nierenberg, A. M., Auger, M. W., Treu, T., Marshall, P. J.,
& Fassnacht, C. D. 2011, ApJ, 731, 44
Nierenberg, A. M., Auger, M. W., Treu, T., et al. 2012,
ApJ, 752, 99
Nierenberg, A. M., Oldenburg, D., & Treu, T. 2013a, MN-
RAS
Nierenberg, A. M., Treu, T., Menci, N., Lu, Y., & Wang,
W. 2013b, ApJ, 772, 146
Oke, J. B. 1974, ApJS, 27, 21
Papastergis, E., Martin, A. M., Giovanelli, R., & Haynes,
M. P. 2011, ApJ, 739, 38
Planck Collaboration, Ade, P. A. R., Aghanim, N., et al.
2015, ArXiv e-prints
Ruiz, P., Trujillo, I., & Mármol-Queraltó, E. 2015, MN-
RAS, 454, 1605
Sales, L. V., Vogelsberger, M., Genel, S., et al. 2015, MN-
RAS, 447, L6
Santini, P., Rosario, D. J., Shao, L., et al. 2012, A&A, 540,
A109
Schneider, A., Smith, R. E., & Reed, D. 2013, MNRAS,
433, 1573
Schultz, C., Oñorbe, J., Abazajian, K. N., & Bullock, J. S.
2014, MNRAS, 442, 1597
Scoville, N., Abraham, R. G., Aussel, H., et al. 2007, ApJS,
172, 38
Skelton, R. E., Whitaker, K. E., Momcheva, I. G., et al.
2014, ApJS, 214, 24
Springel, V. 2010a, MNRAS, 401, 791
—. 2010b, ARAA, 48, 391
Starkenburg, E., Helmi, A., De Lucia, G., et al. 2013, MN-
RAS, 429, 725
Strigari, L. E., & Wechsler, R. H. 2012, ApJ, 749, 75
Tal, T., Quadri, R. F., Muzzin, A., Marchesini, D., & Ste-
fanon, M. 2014, ArXiv e-prints
Thoul, A. A., & Weinberg, D. H. 1996, ApJ, 465, 608
Torrey, P., Vogelsberger, M., Genel, S., et al. 2014, MN-
RAS, 438, 1985
Torrey, P., Snyder, G. F., Vogelsberger, M., et al. 2015,
MNRAS, 447, 2753
Treu, T. 2010, ARAA, 48, 87
Viel, M., Becker, G. D., Bolton, J. S., & Haehnelt, M. G.
2013, Phys. Rev. D., 88, 043502
Vogelsberger, M., Genel, S., Sijacki, D., et al. 2013, MN-
RAS, 436, 3031
Vogelsberger, M., Zavala, J., Cyr-Racine, F.-Y., et al. 2015,
ArXiv e-prints
Vogelsberger, M., Genel, S., Springel, V., et al. 2014a, MN-
RAS, 444, 1518
—. 2014b, Nature, 509, 177
Wang, W., & White, S. D. M. 2012, MNRAS, 424, 2574
Wetzel, A. R., Hopkins, P. F., Kim, J.-h., et al. 2016, ArXiv
e-prints
Zahid, H. J., Torrey, P., Vogelsberger, M., et al. 2014,
Ap&SS, 349, 873
Zolotov, A., Brooks, A. M., Willman, B., et al. 2012, ApJ,
761, 71

c(cid:13) 2016 RAS, MNRAS 000, 1–9

