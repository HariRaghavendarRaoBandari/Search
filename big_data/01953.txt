6
1
0
2

 
r
a

M
7

 

 
 
]

.

R
S
h
p
-
o
r
t
s
a
[
 
 

1
v
3
5
9
1
0

.

3
0
6
1
:
v
i
X
r
a

Mon. Not. R. Astron. Soc. 000, 1–14 (2002)

Printed 8 March 2016

(MN LATEX style ﬁle v2.2)

The effect of a wider initial separation on common envelope binary
interaction simulations

Roberto Iaconi 1⋆, Thomas Reichardt 1, Jan Staff 1,2, Orsola De Marco 1,
Jean-Claude Passy 3, Daniel Price4 and James Wurster4
1Department of Physics & Astronomy, Macquarie University, Sydney, NSW 2109, Australia
2Department of Astronomy, the University of Florida, Gainesville, FL 32611, USA
3Argelander Institute f¨ur Astronomie, Bonn Universit¨at, Bonn, Germany
4Monash Centre for Astrophysics and School of Physics and Astronomy, Monash University, Clayton, VIC 3800, Australia

Submitted to MNRAS

ABSTRACT
We present hydrodynamic simulations of the common envelope binary interaction between a
giant star and a compact companion with an adaptive mesh reﬁnement and a smooth particle
hydrodynamics codes. These simulations mimic the parameters of one of the simulations by
Passy et al., but start with a wider orbital separation to assess the inﬂuence of a larger initial
orbital separation on the common envelope simulation outcome. We conclude that the post-
common envelope separation is somewhat larger and the amount of unbound mass slightly
greater when the initial separation is wide enough that the giant does not yet overﬂow or
just overﬂows its Roche lobe. By setting our simulations in the context of those carried out
in the past that contain at least one giant star, we conclude the following: the reason for the
larger ﬁnal orbital separation in simulations starting with a wider orbital separation has more
to do with the expanded giant at the time of in-spiral and less to do with a larger amount
of angular momentum. We also suggest that the large range in unbound mass for different
simulations is difﬁcult to explain and may have something to do with simulations that are not
fully converged.

Key words: stars: AGB and post-AGB - stars: evolution - binaries: close - hydrodynamics -
methods: numerical

1 INTRODUCTION

The common envelope (CE) interaction is a short phase of the in-
teraction between two stars in a binary system characterised by
the dense cores of the two objects orbiting inside their merged en-
velopes. It was ﬁrst described by Paczynski (1976), but see also
Ivanova et al. (2013) and references therein. During this phase, or-
bital energy and angular momentum are transferred to the gas of
the envelope, which can become unbound from the potential well
of the system, leaving behind a close binary. In cases when the en-
velope is not unbound, a merger results. The CE is thought to be
the main evolutionary channel that leads to all the evolved compact
binaries and also to mergers both inside the CE and after the CE
phase (i.e., type Ia supernovae). Unfortunately, due to its short du-
ration (≃ 1 yr; Paczynski 1976, Passy et al. 2012), the CE phase
is not readily observed (though see, e.g., Tylenda et al. 2011) and
numerical simulations are a major way to investigate its physics.

Past efforts have tried to reproduce numerically CE
interactions with different codes (e.g., Rasio & Livio 1996,
Sandquist et al. 1998, Passy et al. 2012, Ricker & Taam 2012,

⋆ E-mail:roberto.iaconi@students.mq.edu.au

Nandez et al. 2014), but failed to reproduce the post-CE systems
observed. Primarily, simulations fail to unbind the entire envelope.
While the envelope is lifted away from the in-spiralling binary,
the majority of it is not unbound (e.g., Passy et al. 2012). Recently
Ivanova et al. (2015) and Nandez et al. (2015) reported that adding
recombination energy in their simulations achieves the unbinding
of the envelope under at least a certain combination of parameters.
On the other hand, Ohlmann (in preparation and private commu-
nication) added recombination energy in their simulations, but did
not achieve a large increase in the fraction of unbound envelope.

Current simulations are limited in one way or another. The
range of physical phenomena taken into consideration is still very
limited (e.g., the effect of magnetic ﬁelds is still unaccounted
for but possibly important; Reg˝os & Tout 1995, Nordhaus et al.
2007, Tocknell et al. 2014). In addition, the initial conditions of
the simulations are often non-physical. For example, many sim-
ulations start with the companion on or close to the surface of
the primary (Passy et al. 2012 and Ricker & Taam 2012). De-
spite the growing number of simulations, binary parameter space
is still sparsely covered. Additionally, different numerical tech-
niques are used, e.g., unigrid (Passy et al. 2012), adaptive mesh
reﬁnement (AMR; Ricker & Taam 2012), smooth particle hy-

2

Iaconi et al.

drodynamics (SPH; Nandez et al. 2014) and unstructured mesh
(Ohlmann et al. 2016), but only seldom benchmark comparisons
exist (e.g., Passy et al. 2012). Finally, the resolution of the simu-
lations is always relatively low (but see the improvement in the
latest simulations by Ohlmann et al. 2016) and the available con-
vergence tests are never exhaustive enough, due to the substantial
computational demands of these simulations, to convince one that
resolution does not play a part in the outcome of the simulations.
Thus, determining the effect that individual aspects of the simula-
tions have on the results is a way to provide insight into which of
the effects has the largest impact on the simulation’s outcome.

Here we analyse the effect of the initial orbital separation on
the ﬁnal outcome of CE simulations by carrying out a set of simula-
tions that parallel one of the simulations carried out by Passy et al.
(2012, hereafter P12), where a 0.88 M⊙ red giant branch (RGB)
star interacts with its 0.6 M⊙ compact companion. In their simu-
lation the companion was initially placed near the surface of the
giant. In one of our simulations we place instead the companion at
the approximate largest distance from which an orbiting companion
is likely to be brought into Roche lobe contact with a our giant. It is
expected that prior to the start of the CE in-spiral phase, tidal forces
will redistribute orbital energy and angular momentum from the or-
bit to the primary. Eventually the primary would overﬂow its Roche
lobe and start mass transfer to the companion, eventually resulting
in the fast CE in-spiral. These phases are expected to induce en-
velope rotation and expansion, changing the overall distribution of
the envelope and lowering its binding energy. The envelope would
be lighter and easier to unbind, but the overall strength of the grav-
itational drag (Ostriker 1999) may be smaller because of relatively
lower densities and smaller velocity contrasts. It is therefore not
clear a priori what effect a larger initial separation would have on
the simulation.

The effect of a rotating giant on the CE outcome could only
be gauged by Sandquist et al. (1998) who carried out side-by-
side simulations with rotating and non-rotating giants and deter-
mined that the outcome do not vary much. Rasio & Livio (1996),
Ricker & Taam (2012) and Ohlmann et al. (2016) all used a rotat-
ing giant, but did not compare their results with a non-rotating case.
In addition, while Rasio & Livio (1996) stabilised the rotating gi-
ant, none of the other studies did, introducing doubts as to the im-
pact of the giant rotational expansion on the results. Finally, all
simulations started at a separation such that the giant was already
overﬂowing its Roche lobe and thus could not gauge the effects of
a more gradual expansion of the giant envelope.

In line with our previous work we carry out our simulations
with grid (in AMR mode) and SPH codes. In so doing we con-
tinue to compare different numerical techniques while making the
most of what each has to offer. The SPH code we use, PHANTOM
(Price & Federrath 2010; Lodato & Price 2010), has never been
used for CE interaction simulations before, hence this work serves
also to introduce PHANTOM to this problem.

This paper is organised as follows. In Section 2 we explain
the simulations’ setup. In Section 3 we analyse the outputs of the
simulation, focusing on the evolution of the orbital separation in
Section 3.1, the distribution of the envelope in Sections 3.2 and
3.3, the gravitational drag during the interaction in Section 3.4 and
the energetics and the numerical behaviour of the code in Section
3.5. In Section 4 we introduce a comparison of our grid simulations
and our new SPH simulations. In Section 5 we set our results in the
context of all previous simulations while in Section 6 we conclude.

2 ENZO SIMULATION SETUP

The code used to simulate our physical problem is ENZO, a paral-
lel 3D hydrodynamic code including self gravity, originally devel-
oped for cosmological simulations (O’Shea et al. 2004, Bryan et al.
2014), which has been adapted for CE simulations as described in
P12. The simulations of P12 were run with a static uniform grid.
ENZO had already AMR capabilities when P12 performed their
simulation, but they were not available for CE simulation. However,
given the most recent updates applied to ENZO (Passy & Bryan
2014) we used the AMR capabilities of the code, which guarantee
better resolution where needed and a better usage of computational
resources.

Our simulation has been run with a cubic box of 863 R⊙ =
4 AU on a side and a coarse grid resolution of 128 cells per side.
We adopt two levels of reﬁnement with a reﬁnement factor of two,
in this way the smaller cell size is 1.68 R⊙, as is the case in the sim-
ulation of P12. As we will explain in Section 2.1 and Section 2.2,
we use point-masses, interacting only gravitationally with both gas
and other particles, to model the primary core and the compan-
ion. This point-masses have a smoothing length associated with
them, according to the prescription of Ruffert (1993), and in this
work with the term “smoothing length” we refer to the smooth-
ing length only of the point-mass particles. To ensure a reasonable
degree of energy conservation in the simulations, we use a smooth-
ing length equal to 3 times the smallest cell size. This was found
to be the optimal value by Staff et al. (2016), who monitored the
energy conservation in their CE ENZO simulations as a function
of smoothing length. A smoothing length of 1.5 times the small-
est cell size, as used by Sandquist et al. (1998) and P12, results
in a non negligible energy non-conservation in our simulations for
this particular case. Obviously, increasing the smoothing length re-
duces the strength of the gravity over a larger volume around the
point masses. For this reason a balanced combination of resolution
and smoothing length must be used and tested. Our choice for the
smoothing length (3×[smallest cell size] ≃ 5 R⊙) yields a radius
inside which gravity is smoothed that is double that of P12’s 2563
simulations.

The methodology followed to simulate our CE interaction
consists of two main phases and is described in the following sec-
tions.

2.1 Single star setup and stabilisation

As in P12 we model our binary system as an RGB primary and
a smaller companion with comparable mass, identiﬁable with a
main sequence star or a compact object such as a white dwarf. The
resolution is not sufﬁcient to resolve the primary’s core, nor the
companion, so we model them as dimensionless point-masses. The
companion mass is M2 = 0.6 M⊙ (this choice will be discussed
in Section 2.2). The primary star is an extended object whose en-
velope is well resolved. We use the same initial model as in P12:
a star with an initial mass of 1 M⊙ evolved to the RGB with the
1D stellar evolution code EVOL (Herwig 2000). At this stage of
the evolution the star has a radius of R1 = 83 R⊙, a total mass of
M1 = 0.88 M⊙ and a core mass of Mc = 0.392 M⊙.

The relevant ENZO physical quantities are interpolated from
the 1D model to the 3D domain. Due to the limited resolution of
the 3D code the interpolation process results in a mass deﬁcit that
coincides almost exactly with the mass of the core. The addition of
a point mass representing the missing mass therefore completes the
stellar structure. Moreover, because of the limited resolution, the

Effect of initial separation on common envelope simulations

3

106

104

102

100

10-2

10-4

10-6

10-8

)

3
−
m

c
·
g
(
 
y
t
i
s
n
e
D

10-10

10-12

10-2

10-1

100
Radius (R ⊙)

101

102

Figure 1. Radial density proﬁles of the primary RGB star used in our sim-
ulation, calculated with the 1D EVOL code (blue curve), after mapping it
in the ENZO computational domain but before the stabilisation process (red
curve) and after stabilisation (green curve). The change in slope at a ra-
dius of 3 × 10−2 R⊙ marks the core-envelope boundary of the 1D model,
while the vertical line shows the size of an ENZO cell at the deepest level of
reﬁnement.

surface of the star is poorly matched to the typically steep gradients
of stellar atmospheres, therefore the part of the simulation box not
occupied by the star is ﬁlled by low density medium with a density
equal to 10−4 times the density of the surface layer of the primary.
To match the pressure of the stellar atmosphere this medium has
a high temperature (≃ 108 K). However the stellar model is not
in perfect hydrostatic equilibrium in the grid due to the higher res-
olution adopted by EVOL and its more realistic equation of state
that takes micro physics into account, while ENZO has an ideal gas
equation of state with γ = 5
3 . The primary therefore has to be sta-
bilised by damping at each time step the velocities that develop in
the grid. This stabilisation is carried out for 10 dynamical times.
The stability of the model in the new grid is then veriﬁed by letting
the simulation run without damping for 10 additional dynamical
times, where our RGB star dynamical time is 21 days.

At the end of this process the initial 3D stellar model is re-
laxed with respect to the 1D model as showed in Figure 1. The
sharp density jump at the edge of the star has been smoothed by the
stabilisation process, and the star is now sightly larger. The contour
of density of 10−11 g cm−3 has a radius 100 R⊙. The central den-
sity is also sightly reduced, but overall the original structure of the
star is mostly preserved.

To verify the stability of the model more quantitatively than
previously done (Sandquist et al. 1998, Ricker & Taam 2012, P12),
the velocities that develop have been compared to global and local
velocity scales, such as the local sound speed and the dynamical
velocity, vdyn,1 = R1/tdyn,1 ≃ R1(Ghρ1i)
2 , where tdyn,1 is
the dynamical time of the primary, G is the gravitational constant
and hρ1i is the average density of the star. Additionally, we also
compare the gas velocities in the frame of reference of the primary
to the orbital velocities of the binary system in the frame of refer-
ence of the center of mass (see Section 2.2). The star was relaxed
for 10 dynamical times and mostly maintained its internal structure
(Figure 1). At each step during the relaxation at most 7 per cent
of the cells had velocities exceeding the lowest of the velocity lim-

1

its discussed above. Hence we expect the contamination of the CE
interaction by the spurious motions of the primary envelope to be
negligible.

2.2 Binary system setup

The companion has a mass M2 = 0.6 M⊙, selected among those
simulated by P12, also based on the fact that their 0.6 M⊙ compan-
ion simulations were converged for the coarse grid resolutions we
are using. The orbital separation was the largest that would result in
the evolution of the orbital elements and eventually in a CE within
a reasonable computational time: a = 300 R⊙ (corresponding to a
period of 496 days = 1.36 yr). This value also corresponds to the
approximate maximum orbital separation from which a tidal cap-
ture of the companion may take place within the evolution of a star
similar to our primary (Madapattu, in preparation). The system was
placed in circular orbit, where we gave the RGB star a Keplerian
velocity v1 ≃ 12.4 km s−1 and the companion point particle a ve-
locity v2 ≃ 18.2 km s−1, with the point mass core of the primary
coinciding with the centre of the box. The initial conﬁguration of
the binary system is shown in Figure 2.

In our simulation the primary is driven into Roche lobe con-
tact (the Roche lobe radius of the primary is 124 R⊙ at an orbital
separation of 300 R⊙, using the approximation of Eggleton (1983),
but noting it to be valid in the case of synchronised orbits, which
is not our case) and eventually a CE interaction by the pre-contact
tidal interactions in a relatively short time-scale, much shorter than
realistic tidal interaction timescales. The reason for this difference
is that the strength of the interaction is sensitive to departures of
the stellar envelope distribution from spherical. Inserting the com-
panion in the computational domain generates a small distortion
of the primary’s envelope resulting in a set of oscillations, which
exert a relatively strong tidal force. Paradoxically, this larger than
average tide results in shortening of the orbital separation within
reasonable computational times, something that would not be so if
the tide were better reproduced.

We do not apply any initial rotation to the primary. However,
we achieve a spinning star by spin-orbit interaction. The initial or-
bital separation is the maximum that would allow a capture of the
companion into a CE interaction during this phase of the evolution
of the star. This means that the total angular momentum in the sys-
tem, which is increasingly transferred from the orbit to the envelope
of the giant, is approximately that which would be expected for this
system.

3 RESULTS

3.1 Orbital Separation

The separation between the point masses as a function of time and
the orbital decay rate are shown in Figure 3. To determine the time
when the mass transfer phase begins, we calculated the Roche lobe
surface around the primary using the total potential ﬁeld computed
in the simulation. Then, we checked whether the cells contained
within the primary’s Roche lobe, including the ﬁrst cell near the in-
ner Lagrangian point in the companion’s Roche lobe, have a density
greater than the vacuum’s density (6.93 × 10−12 g cm−3). Com-
puted in this way, the beginning of the contact phase takes place
after about 547 days ≈ 1.5 yr from the beginning of the simula-
tion. During this pre-contact phase, the orbital separation has been
reduced from 300 to 265 R⊙, at which point the primary’s Roche

4

Iaconi et al.

2

1

)
U
A
(

y

0

−1

−2

−2

−1

0

x (AU)

1

10-4

10-5

10-6

10-7

10-8

10-9

)

3

m
c
/
g
(

y
t
i
s
n
e
D

10-10

10-11

2

Figure 2. Density slice on the x − y plane at z = 0, showing the entire
computational domain with the initial setup of the binary simulation. The
arrows show the velocity ﬁeld; vectors are scaled to the maximum value of
the velocity (the orbital velocity of the companion or 18.2 km s−1). Note
that also the point-mass particles representing respectively the core of the
primary and the companion are given Keplerian velocities, even if arrows
are not present in the plot.

lobe radius is 108 R⊙, similar to the stellar radius at the start of the
simulation.

The mass transfer phase lasts until the companion is engulfed
in the envelope of the primary, at which point the rapid in-spiral
phase begins. We deﬁne the start of the rapid in-spiral phase as the
time when the equipotential surface passing through the outer La-
grangian point L2 has a density greater than the vacuum’s density
in each of its cells. This condition is satisﬁed after about 1515 days
or 4.2 yr from the beginning of the simulation.

The rapid in-spiral phase is observed as a steepening of the
the separation vs time curve which denotes a regime change. This
phase lasts 324 days and ends 1840 days, or 5.0 yr from the begin-
ning of the simulation, when the orbital separation stabilises. We
have used the same criterion as P12 and Sandquist et al. (1998),
who deﬁned the end of the rapid in-spiral phase when − ˙a <
0.1(− ˙amax), where ˙a = da/dt. This point is somewhat arbitrary
because it depends on how steep the in-spiral is. In our simulations,
the in-spiral is much steeper than that witnessed in the simulations
of Sandquist et al. (1998) and P12, as can be seen by comparing
our Figure 3, lower panel with their ﬁgures 4 and 5, respectively.

The rapid in-spiral phase in our simulation lasts approximately
10 per cent longer than for the equivalent simulation of P12, and
longer still if we acknowledge that at the end of the in-spiral phase
as deﬁned above, the separation is still reducing considerably. This
could be due to the fact that our donor star is puffed up by the inter-
actions in the previous phases, hence it is less dense. The delayed
rapid in-spiral and its longer duration are in line with the results ob-
tained by P12 in their simulations with the companion star slightly
away from the primary surface rather than in contact. The rapid

0
350

300

250

200

)

⊙

R
(
 
a

150

100

50

0

0

1

2

Time (years)
3
4

5

6

7

500

1000

1500

2000

2500

Time (days)

0
1.0

1

2

Time (years)
3
4

5

6

7

)

1
−
y
a
d
(
 
a
/
1
 
*
 
t
d
/
a
d
-

0.8

0.6

0.4

0.2

0.0

0

500

1000

1500

2000

2500

Time (days)

Figure 3. Upper panel: evolution of the separation, a, between the two parti-
cles representing the core of the primary and the companion, over the whole
simulation time. The blue line represents the actual separation computed
every 0.01 year. The red line represents the separation averaged over one
orbital cycle. The black vertical lines represent, from left to right, the be-
ginning of mass transfer, the beginning of the fast in-spiral phase and the
end of the fast in-spiral phase. Lower panel: evolution of the orbital decay,
computed on the separation averaged over one orbital cycle.

in-spiral time-scale is 65 per cent of the initial period, in line with
theoretical expectations (Paczynski 1976).

The orbit starts to become elliptical during the rapid in-spiral
phase. Using the maxima and minima in the orbital separation evo-
lution after the end of the rapid in-spiral phase, we obtain an eccen-
tricity e = 0.12, in agreement with what was obtained by P12.

The ﬁnal separation achieved (af ) is a crucial output of the CE
simulations. P12 identiﬁed that CE simulations have ﬁnal separa-
tions that not only tend to be larger than observed (Zorotovic et al.
2010 and De Marco et al. 2011), but that depend on the compan-
ion/primary mass ratio (q), a tendency not seen in the observations.
By using the average separation (red line in Figure 3) we estimated
the value of the separation reached at the end of the rapid in-spiral
phase to be 36 R⊙, using the criterion described above and 20 R⊙ if
we take the average value at the end of the simulation (see Table 1,
where we report the initial conditions and ﬁnal outcomes for all past
CE simulations including at least a giant). The separation at the end
of the simulation is ≃ 4 times the smoothing length, indicating that

Effect of initial separation on common envelope simulations

5

25

20

)

R
(
 
n
o
i
t
a
r
a
p
e
s
 
l
a
n
F

i

⊙

15

10

5

0
0.0

0.2

0.4

0.6
q

0.8

1.0

1.2

Figure 4. Final orbital separation vs mass ratio q = M2/M1 for observed post-CE systems (Zorotovic et al. 2010 and De Marco et al. 2011, black dots) and
for simulations (Sandquist et al. 1998, green circles; Ricker & Taam 2012, cyan triangle - note that here we report the separation of the simulations of Ricker
and Taam (2012) which is lower than reposted in Ricker and Taam (2008) where the in-spiral had not come to an end; the 2563 ENZO simulations of P12 are
shown as yellow squares; Rasio & Livio 1996, magenta pentagon; PHANTOM simulations, blue hexagons, see Section 4; Ohlmann et al. 2016, grey diamond,
Nandez et al. (2015), pink cross), together with the results of this our new ENZO simulation (yellow star). Note that for our work and for the simulations of
Sandquist et al. (1998) the deﬁnition of the ﬁnal separation may lead to a slightly larger value than for other simulations. See text and Table 1.

the end of the in-spiral is not affected by the smoothing-length and
resolution. Our values of the ﬁnal separation are larger than those
of P12, which were 19 and 16 R⊙, for the criterion-deﬁned and
ﬁnal separations, respectively. In other words, the ﬁnal separation
is larger by 25 per cent for the ENZO simulation starting with a
larger initial separation. We plot ﬁnal separations in Fig. 4, and we
defer further discussion on the issue of ﬁnal orbital separation to
Section 5.

3.2 Envelope ejection

To determine the extent to which the envelope is unbound we de-
termined whether gas has total energy larger than zero. The to-
tal energy can be calculated including or excluding thermal en-
ergy, where the former prescription results in more unbound gas.
Ivanova & Chaichenets (2011) discussed how it is the enthalpy
rather than the thermal energy that needs to be included when deter-
mining whether a gas parcel is bound or not. Using enthalpy instead
of thermal energy increases the unbound mass very marginally.

In Figure 5 we present density slices in the orbital and perpen-
dicular planes. In the ﬁrst and middle columns we compare the dis-
tribution of unbound gas both using thermal energy (left column)
and not (middle column), to distinguish between gas acceleration
and gas heating. The initial unbinding event (ﬁrst two rows, left

columns) happens because of heating of the gas falling into the po-
tential well of the companion during the mass transfer phase, which
is why this unbound material is not recorded on Figure 5, middle
column. This unbound material has very low mass. Later, during
the rapid in-spiral phase (Figure 5, last two rows, left and middle
columns) far more mass is unbound because it is accelerated above
the escape velocity as demonstrated by the similarity of the left and
central columns. The masses of the unbound gas inside the simu-
lation box obtained by including or excluding Etherm are listed in
Table 2.

The evolution of the unbound gas can be followed only in-
side the simulation box, due to the grid nature of ENZO. However,
we estimated whether the mass that leaves the box is bound or un-
bound in the following way. We calculated the fraction of unbound
gas contained within the box boundary (i.e., within the six, one cell
thick, box faces) and we assumed it to be representative of the frac-
tion of unbound gas between code outputs (which take place every
3.65 days = 0.01 yr). We then multiplied this fraction by the mass
that leaves the box between code outputs.

The estimate of the total unbound mass leaving the box is
shown in Figure 6 (lower panel). Our approximation is consistent
with the total amount of mass that leaves the box during the sim-
ulation, shown in Figure 6 (upper panel). The ﬁrst unbound mass
leaves the box at approximately 1500 days, at the onset of the rapid

6

Iaconi et al.

M1 M1,c
(M⊙)
(M⊙)

R1
(R⊙)

Giant M2
(M⊙)

q

ai/R1

Ω/ω1

R1/R1,RL

Code2

Resolution
(Part./R⊙)

τ 3
run
(day)

4
3
3
5
5
5

1.05
0.88
0.88
0.88
0.88
0.88
0.88
0.88
0.88
0.88
0.88
1.98
1.50
0.88
0.88
0.88

0.7
0.7
0.7
1.0
1.0
0.94
0.36
0.39
0.39
0.39
0.39
0.39
0.39
0.39
0.39
0.39
0.39
0.38
0.32
0.39
0.39
0.39

66
200
200
200
200
354
31
85
85
85
85
85
83
83
83
83
83
49
267
100.
93
91

RGB
AGB
AGB
AGB
AGB
AGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB
RGB

0.7
0.4
0.4
0.4
0.6
0.6
0.6
0.1
0.15
0.3
0.6
0.9
0.1
0.15
0.3
0.6
0.9
0.99
0.36
0.6
0.6
0.6

0.18
0.13
0.13
0.08
0.12
0.12
0.57
0.11
0.17
0.34
0.68
1.02
0.11
0.17
0.34
0.68
1.02
0.5
0.24
0.68
0.68
0.68

1.6
1.4
1.4
1.4
1.4
1.5
2.0
1 .0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
2.0
3
1.1
2.4

1(y)
1(n)

0

1(n)
1(n)

0

0.95(n)

0
0
0
0
0
0
0
0
0
0

0.95(n)

0
0
0
0

1.3
1.3
1.3
1.2
1.3
1.2
1.2
1.8
1.9
2.1
2.4
2.6
1.8
1.9
2.1
2.4
2.6
2.3
1.0
0.81
2.2
1.0

SPH
n-grid
n-grid
n-grid
n-grid
n-grid

a-grid(F)
u-grid(E)

u-grid

u-grid(E)
u-grid(E)
u-grid(E)
SPH(S)
SPH(S)
SPH(S)
SPH(S)
SPH(S)
m-mesh

SPH

a-grid(E)
SPH(P)
SPH(P)

500k
2.4
2.4
2.4
2.4
2.4
0.29
1.7

(E)1.7

1.7
1.7
1.7
500k
500k
500k
500k
500k

0.07-0.01

200k
1.7
2.3m
300k

124
800
800
800
800
800
60
1000
1000
1000
1000
1000
1050
950
750
950
600
120
(?)
2000
1850
5050

a4
f
(R⊙)

1(e)
4.4(a)
4.7(a)
4.4(a)
4.8(a)
8.9(a)
9(e)

5.7(a) / 4.2(e)
6.9(a) / 4.7(e)
11(a) / 9.0(e)
19(a) / 16(e)
26(a) / 22(e)
6.1(a) / 5.7(e)
7.3(a) / 7.8(e)
11(a) / 10(e)
21(a) / 18(e)
27(a) / 25(e)

4.9(e)
0.91(e)

36(a)/20(e)
21(a)/16(e)
29(a)/22(e)

M 5
Unb
(%)

Ref.6

10(?)
41(?)
46(?)
21(?)
45(?)
46(?)
26(t)

–
–
–
–
–
2(t)
6(t)
8(t)
10(t)
10(t)
8(t)

100(r)8
16(t)
12(t)
15(t)

1
2
2
2
2
2
3
4
4
4
4
4
4
4
4
4
4
5
6
7
7
7

1Stellar spin frequency as a function of orbital frequency, with an indication of whether the star was stabilised in its rotating conﬁguration (y) or not (n)
before the start of the simulation.
2SPH: smooth particle hydrodynamics; u-grid: uni-grid; n-grid: static nested grids; m-mesh: moving mesh; a-grid: adaptive mesh reﬁnement grid;
F: FLASH, E: ENZO, S: SNSPH, P: PHANTOM.
3 Information not provided (?).
4Rounded to 2 signiﬁcant ﬁgures, calculated either at the end of the simulation (e) or at a time deﬁned by the formula in Section 3.1 (a).
5 Calculated by including thermal energy (t), not including thermal energy (k), information not provided (?) or including recombination energy (r).
61: Rasio & Livio 1996. 2: Sandquist et al. 1998. 3: Ricker & Taam 2012. 4: Passy et al. 2012. 5: Ohlmann et al. 2016. 6: Nandez et al. 2015. 7: This work.
7 This is the Roche lobe radius also corresponding to the SPH radius in their simulation.
8 Note that the same simulation run without recombination energy unbinds 50 per cent of the envelope, although the authors of that simulations do not present data to illustrate their

Table 1. A comparison of initial conditions and ﬁnal outcomes of previous common envelope simulations that included at least one giant star.

Time Munb (Ekin + Epot + Etherm) Munb (Ekin + Epot)
(days)

(M⊙)

(M⊙)

887

1381

1669

1724

1.61 × 10−3
1.58 × 10−3
1.56 × 10−2
3.72 × 10−2

7.64 × 10−6
4.89 × 10−5
6.28 × 10−3
2.93 × 10−2

Table 2. Gas mass unbound inside the simulation box at various times and
for the two possible prescriptions, including thermal energy or not.

in-spiral, but the bulk of the mass ﬂows out during the rapid in-
spiral phase (between approximately 1750 and 1900 days). The to-
tal mass unbound in the simulation amounts to 8 × 10−2 M⊙, or 16
per cent of the initial envelope mass. The unbound mass is 14 per
cent, if we do not include thermal energy and 17 per cent, if we use
the enthalpy as suggested by Ivanova & Chaichenets (2011). P12
found that 10 per cent of the initial envelope mass was unbound,
which should be compared to our 16 per cent. This increase likely
represents the effect of a larger initial separation.

Most of the ejecta is expected to ﬂow away close to the or-
bital plane, where the gas is accelerated by the orbiting particles.
This was already borne out by the simulations of Sandquist et al.

(1998) and is clearly seen in Figure 5. Figure 7 demonstrates how
the envelope is ejected around the binary over time. We divide the
computational domain into six pyramids centred at the centre of the
box and whose bases are the six faces. We plot the mass in pairs of
pyramids aligned with each of the three directions, x, y and z. Ini-
tially the mass is equally distributed in the three pairs of pyramids
as the star resides at the centre of the box. Later the mass in the
pyramid pairs oscillates as the giant moves along its orbit. The de-
crease of the peaks in the green line during the fast in-spiral phase
in Figure 7 marking approximately the completion of a full orbital
revolution, demonstrating a decrease in the mass contained in the
z direction in favour of mass contained in the other two directions.
The decreasing amplitude of the oscillations over time indicates
that the gas distribution becomes more and more independent of
the orbital motion of the two particles, as the interaction proceeds.
Towards the end of the CE, as the oscillations cease, more mass is
being ejected out of the simulation box highlighting how the fast
in-spiral rapidly lifts the envelope, disrupting the primary star.

3.3 Tidal bulges

As explained in Section 2.2, the pre-contact phase in our simula-
tion takes place over much shorter timescales than it would in na-
ture. The short pre-contact timescale observed in our simulation

Effect of initial separation on common envelope simulations

7

)
U
A
(

y

)
U
A
(

y

)
U
A
(

y

)
U
A
(

y

2
1
0
−1
−2
2
1
0
−1
−2
2
1
0
−1
−2
2
1
0
−1
−2

−2 −1 0

1

2

−2 −1 0

1

2

)
U
A
(

z

)
U
A
(

z

)
U
A
(

z

)
U
A
(

z

2
1
0
−1
−2
2
1
0
−1
−2
2
1
0
−1
−2
2
1
0
−1
−2

−2 −1 0

)

3

m
c
/
g
(

y
t
i
s
n
e
D

10-5

10-6

10-7

10-8

10-9

10-10

10-11

1

2

x (AU)

x (AU)

y (AU)

Figure 5. Left panel, left column: density slices perpendicular to the z axis in the orbital plane after (from top to bottom) 887, 1381, 1669 and 1724 days from
the beginning of the simulation. The point-mass particles representing the core of the primary and the companion are shown as black dots, while the white
regions represent the unbound gas. The size of the black dots is not representative of any property of the point masses and is chosen only to highlight them.
Left panel, right column: same as the left column, but excluding thermal energy (Eth) in the computation of the bound/unbound mass elements. Right panel:
density slices perpendicular to the orbital plane at x = 0, taken at the same times as the left panels.

is due to deformations created on the primary by the insertion of
the companion into the computational domain that are likely larger
compared to those expected from the theory of equilibrium tides.

δM1 6 M2(cid:18) R1

a (cid:19)3

,

(1)

A simple analytical estimate of the mass, δM1, contained in
the tidal bulges of the primary , for equilibrium tides, can be ob-
tained from Zahn (2008):

where M1, M2, R1 and a are the masses of the primary, secondary,
the radius of the primary and the orbital separation, respectively.
For the purpose of this calculation we only vary a with time, while
leaving R1 constant. We compared this analytical estimate with the

8

Iaconi et al.

3.0

0.5

0.4

0.3

)

⊙
M

(
 
s
s
a
M

0.2

0.1

0.0

3.0

0.16

0.14

0.12

0.10

)

0.08

⊙
M

(
 
s
s
a
M

0.06

0.04

0.02

0.00

3.5

4.0

4.5

5.0

Time (years)

0

1

Time (years)

3

2

4

5

1200

1400

1600

Time (days)

1800

2000

3.5

4.0

4.5

5.0

Time (years)

0.5

0.4

)

⊙
M

0.3

(
 
s
s
a
M

0.2

0.1

0.0

0

500

1000

Time (days)

1500

2000

Figure 7. Gas mass inside the simulation domain vs time for the gas located
in six pyramids whose bases are the six faces and whose vertexes are at the
centre of the domain. The two pyramids along the x axis are in blue, along
the y axis are in red and along the z axis are in green. The cyan line shows
the sum of the x and y contributions to highlight the behaviour of the mass
ejection in the orbital plane. The black vertical lines show the estimated
beginning of the Roche lobe overﬂow phase and the beginning and end of
the fast in-spiral phase.

0.0

0.014

0.2

0.4

Time (years)

0.6

0.8

1.0

1.2

1.4

1200

1400

1600

Time (days)

1800

2000

0.012

0.010

Figure 6. Upper panel: evolution of the gas mass inside the simulation box
over time. The blue line represents the value of the initial gas mass con-
tained in the box and is plotted for comparison, while the green line shows
the evolution of the total mass contained inside the box. The red and cyan
lines show, respectively, the bound and unbound components of the mass.
Lower panel: cumulative mass of the gas ﬂowing out of the simulation box
over time. Line colours have the same meaning as for the upper panel. The
black vertical lines in both panels correspond to the beginning and end of
the rapid in-spiral and both the plots are limited to the part of the simulation
where signiﬁcant mass is lost from the box.

0.008

)

⊙
M

(
 
s
s
a
M
δ

0.006

0.004

0.002

0.000

0

100

200

300
Time (days)

400

500

bound mass residing outside the initial equilibrium radius of the
primary.
As shown in Figure 8 (solid blue line), the insertion of the compan-
ion into our ENZO simulation triggers some oscillations, on a time
scale of the order of the dynamical time of the star (≃21 days).
Over the pre-contact phase there is also a gradual expansion of the
star, seen as an increasing trend of the mass outside its original vol-
ume. Once mass transfer starts at ≃ 550 days, new forces are at
play that overwhelm the tidal torque. Figure 8 also shows that the
mass outside the original stellar volume in the ENZO simulations
does not exceed substantially the theoretical value (note that the
dashed dotted line is calculated using the PHANTOM simulations
presented in Section 4 and will be discussed at that time). Its distri-
bution is in the shape of two small opposite bulges that are initially
aligned with the direction of the companion, which disappear and
reappear at 90 degrees to the original direction. This generates the

Figure 8. Mass in the tidal bulges of the primary star overtime during the
pre-contact phase, estimated from the ENZO simulation data (solid blue
line), from the PHANTOM simulation data described in Section 4 (dashed
blue line) and from the analytical formula (dotted red line).

relatively strong torques that result in the fast decrease of the orbital
separation during the pre-contact phase.

3.4 Evolution of the gas velocities and density in proximity to

the companion: the end of the in-spiral

The mechanism behind the energy and angular momen-
tum exchange that drives the in-spiral
is gravitational drag
(Ricker & Taam 2012). Gravitational drag is caused by the gas
which ﬂows past the moving body (in our case the companion
star), forming a wake with higher density behind it that gravita-

Effect of initial separation on common envelope simulations

9

tional pulls on it, slowing the body down. The gravitational drag
experienced by a body immersed in a ﬂuid depends on the body’s
mass, the ﬂuid density, the velocity contrast between the body
and the ﬂuid and on the Mach number of the body. Approxima-
tions for the gravitational drag are given by Iben & Livio (1993,
s), for the subsonic motion regime)
Fdrag ∝ (M2ρv2
and by Ostriker (1999) who calculated a more detailed formula,
carefully considering the effects of the Mach number.

rel)/(v2

rel + c2

It is fundamental to determine whether simulations accurately
reproduce the effects of gravitational drag because this determines
in turn when the companion in-spiral terminates and, as a result,
the amount of orbital energy deposited. Is the end of the in-spiral
due to the decreasing density around the particles, the co-rotation
of the surrounding gas or a change in the Mach regime (as was the
case in the simulations of Staff et al. 2016b)? Does the density gra-
dient affect the force as questioned by MacLeod & Ramirez-Ruiz
(2015)? How does the interplay of resolution and smoothing length
affect the simulation (Staff et al. 2016)? It is well known that the
particles will not approach closer than approximately two smooth-
ing lengths, effectively because their potentials are ﬂat within that
distance. However, less clear are the effects that not resolving a
radius of the order of the Bondi radius (Bondi 1952) around the
particles will have on the drag force (Staff et al. 2016b). Finally,
the gas trapped in the potential of the particles and travelling with
them, gives the particles a larger mass and an effective “size” and
this could affect both the gravitational and hydrodynamic drags.

In Figure 9 we display the evolution of the density proﬁle be-
tween the two cores, showing only the part between the particles
(upper panel), or the entire computational domain (lower panel).
The density proﬁle changes smoothly at the beginning of the sim-
ulation, with the primary expanding, but it then transitions into
a phase of more rapid change at the onset of the rapid in-spiral
phase, when the proﬁle ﬂattens and then becomes U-shaped, show-
ing peaks at the locations of both the primary’s core and the com-
panion with densities of 2.8 × 10−6 g cm−3 for the primary and
4.6 × 10−6 g cm−3 for the companion. The underlying density is
of the order of 10−6 g cm−3 at 365 − 730 days after the start of
the simulation. These values are comparable to those of P12 (their
ﬁgure 13, middle panel).

The gas density in the proximity of the particles at the end
of the simulation is high, and is unlikely to be the cause of the
observed slowing down of the in-spiral. From the density proﬁles
Figure 9 (lower panel) it is clear that during the evolution of the
system some of the envelope accumulates around the companion.
The accumulation of mass is negligible until the beginning of the
rapid in-spiral phase, during which it starts to increase because the
companion is plunging into the denser parts of the envelope. The
companion local density is a factor of a few larger than the density
10-20 R⊙ away from it. The density gradient underlying the density
peak near the companion is small and likely unimportant to the in-
spiral.

In Figure 10 (upper and middle panels) we plot the compan-
ion’s speed, the average local gas velocity projected in the direc-
tion of motion of the companion and the average local gas velocity
projected in the direction perpendicular to the motion of the com-
panion. In the upper panel we show the smoothed data, while in the
lower panel we plot the companion’s Mach number and the nor-
malised average density near the companion. To calculate the par-
allel and perpendicular ambient gas velocities we averaged the re-
spective projections for all cells within a volume with radius 10 R⊙
from the companion. The local density was calculated by averag-

10-4

10-5

10-6

10-7

10-8

10-9

)
3
−
m

c
·
g
(
 
y
t
i
s
n
e
D

10-10

10-11

10-3

10-4

10-5

10-6

10-7

10-8

10-9

)
3
−
m

c
·
g
(
 
y
t
i
s
n
e
D

10-10

10-11

10-12

0

0
398
796
1194
1591
1989

50

100

150

200

250

300

Radius (R ⊙

)

0
398
796
1194
1591
1989

200

400

Radius (R ⊙

600
)

800

1000

Figure 9. Upper panel: density proﬁle between the the core of the primary
(located at zero in the abscissa) and the companion (each black dot repre-
sents the density at the location of the companion). The colour legend shows
the time, in days, corresponding to each line. Proﬁles are taken, for clarity,
every 110 dumps of the code. Lower panel: same as the top panel, but ex-
tended to the whole box. The primary’s core is represented by a large black
dot while the companion is marked as a smaller dot.

ing the density inside the same volume and the Mach number by
averaging the gas sound speed within the same volume.

As was the case for the simulation of P12, the entire journey of
the companion is subsonic, reaching at most a Mach number of 0.6.
This is different from the simulations of Staff et al. (2016b), where
the initial part of the in-spiral was supersonic and the end of the
in-spiral phase appeared to coincide with the transition between a
super-sonic and sub-sonic regimes. No such transition occurs here.
In our simulation no shocks are observed and no shock heating can
take place as was instead the case in the simulations of Sandquist
et al. (1998).

On the other hand, a regime change does take place at the
approximate time of the end of the in-spiral, at ∼1850 days. The
density peaks at that time, due to the fact that ﬁrst the companion
plunges into a region of higher density, but as the in-spiral stalls,
that volume is somewhat evacuated as gas ﬂows outwards. The ve-
locity of the companion, which increases during the in-spiral due
to the decreasing orbital separation, approximately levels off after
the in-spiral. The peaks and troughs are due to the orbit becoming

10

Iaconi et al.

eccentric early in the in-spiral. The local gas velocity parallel to
the companion’s motion increases as the local gas is dragged along
with the companion. Corresponding with the approximate end of
the in-spiral the local gas is spun up to almost co-rotate with the
companion, which greatly reduces the drag. At that time the gas
perpendicular velocity is seen to increase somewhat, as an outﬂow
takes place (which acts to decrease the local density). During the
in-spiral, the perpendicular gas velocity local to the companion de-
creases overall, as the companion plunges into layers that are harder
and harder to eject. The peak at 1700 days corresponds with the
high companion velocity peak taking place at the ﬁrst periastron of
the now-eccentric orbit. At the same time, much of the unbinding
is taking place at the location of the companion, as can be seen in
Figure 5 (third row).

To conﬁrm that this trend is not a result of the size of the
sphere used to estimate our quantities, we carried out the same test
with spheres of 5 R⊙and 20 R⊙. Both show results similar to Fig-
ure 10 with the only exception that the gas velocity parallel to the
companion direction of motion is overall larger and close to the
companion’s velocity for the smaller sphere, as expected. We also
note that at the beginning of the in-spiral the local gas has a rotation
velocity of 10-20 km s−1, which is a range of values expected for
giants spun up by a companion.

3.5 Angular momentum and energy conservation

Energy and angular momentum were excellently conserved by the
SPH simulations of P12 (to a 1 percent level). They did not check
the conservation level of their equivalent ENZO simulations, be-
cause of the grid nature of the code which leads to loss of mass
off the simulation box and because their ENZO simulations showed
similar results as the SPH ones, which implied a reasonable level
of energy conservation.

As introduced in Section 2, Staff et al. (2016) quantiﬁed the
level of energy non-conservation in grid based simulations using
ENZO and determined that conservation is improved by selecting
a larger smoothing length of 3 cells rather than what was used by
P12 (1.5 cells). The highest resolution in our AMR simulation is the
same as the resolution in the unigrid simulations of P12. However,
we have adopted the larger smoothing length of 3 cells, which must
have weakened the gravitational interaction somewhat compared to
the simulations of P12. To ensure that our results can be compared
with those of P12 despite the different smoothing lengths, we re-
peated the simulation of P12 with the current AMR setup, obtaining
the same results within excellent precision.

In Figure 11 and 12 we plot various components of the angular
momentum and energy, respectively, in the computational domain
as a function of time. The behaviour of some of the components is
driven by mass-loss out of the computational domain, which starts
at ∼260 days (some of the low density ambient medium outﬂows
before, but has negligible mass), but is particularly heavy during
the rapid in-spiral phase. In Figure 11 we see that, as expected, the
z component of the angular momentum dominates over the other
components and that most of the angular momentum resides in the
point masses, with an initial value of ∼ 3.5 · 1052 g cm2 s−1. Be-
fore 260 days from the beginning of the simulation, only negligi-
ble mass and angular momentum are leaving the simulation box.
The particles’ z angular momentum decreases during the in-spiral.
Some of that is transferred to the gas. Five percent of the angular
momentum is lost due to non-conservation, between the beginning
of the simulation and 260 days, while 10 percent is lost over the ﬁrst
3 years, a time at which substantial amount of mass starts leaving

4.5

5.0

Time (years)
5.5

6.0

6.5

7.0

50

45

40

35

)

1
−
s
·

30

m
k
(
 
y
t
i
c
o
e
V

l

25

20

15

10

5

1600

1800

2000

2200

2400

2600

Time (days)

4.5

5.0

Time (years)
5.5

6.0

6.5

7.0

1.0

0.8

0.6

o
i
t
a
R

0.4

0.2

0.0

1600

1800

2000

2200

2400

2600

Time (days)

Figure 10. Upper panel: companion velocity (thicker blue line), local av-
erage gas velocity projected on the direction of the companion velocity
((cid:10)vgas,k(cid:11), thick green line) and local average gas velocity perpendicular
to the direction of the companion velocity ((cid:10)vgas,⊥(cid:11), thin cyan line). The
three lines are smoothed with a Savitzky-Golay ﬁlter, using 31 coefﬁcients
and 7th order polynomials. Lower panel: companion Mach number (thick
blue line) and normalised average gas density in the companion’s proxim-
ity (hρi / hρimax, thin green line). All plots start at the onset of the rapid
in-spiral, the vertical solid lines represent the estimated end of the rapid
in-spiral and the dashed ones mark the point of maximum density.

leaves the box. This value is larger (as expected) than for the SPH
simulation of P12 and similar to the 8 per cent of Sandquist et al.
(1998), who estimated it over ≃ 1000 days of their simulation.
Estimating the level of conservation of energy is even more dif-
ﬁcult than for the angular momentum, because the low density
medium ﬁlling the volume outside the star has a very high thermal
energy, even if its total mass is negligible. Even before envelope
mass starts ﬂowing out of the computational domain at 260 days,
a small amount of this high energy gas ﬂows out of the box tak-
ing with it an energy of ≃ 1.3 × 1045 erg (or ≃ 11 percent of the
initial total energy). This behaviour is clear in Figure 12: the total
energy at the beginning of the simulation is dominated by the ther-
mal energy of the “vacuum” and by the potential energy between
the point mass particles and the gas, with the former continuously
decreasing as some of the low density medium outﬂows the box;
this decrease is mimicked by the total energy at times greater than

Effect of initial separation on common envelope simulations

11

0
5

1

Time (years)

3

2

4

5

4

3

2

1

0

)

1
−
s
·

2

m

c
·
g
·

2
5
0
1
(
 

m
u
t
n
e
m
o
m

l

 
r
a
u
g
n
A

−1
0

500

1000

Time (days)

1500

2000

Figure 11. Evolution of the angular momentum components with respect
to the center of mass of the system for gas, particles and their sum, inside
the simulation domain. The blue curves represent the x angular momenta,
the red curves the y angular momenta and the green curves the z angular
momenta. In all three cases the solid line represents the particles + gas, the
dashed lines the particles and the dotted line the gas. The black vertical
line represents the moment when the envelope mass starts leaving the box
(≃ 260 days).

1

Time (years)

3

2

4

5

0

6

4

2

0

)
s
g
r
e
·

6
4
0
1
(
 
y
g
r
e
n
E

−2

−4

−6
0

500

1000

Time (days)

1500

2000

Figure 12. Components of the energy as a function of simulation time in
the domain: total energy (thick black line), total kinetic energy (solid black
line), total potential energy (dashed black line), total (= gas) thermal en-
ergy (dotted black line), gas kinetic energy (solid red line), gas potential
energy (dashed red line), point-mass kinetic (solid yellow line), point-mass
to point-mass potential (dashed yellow line) and point-mass to gas potential
(dashed cyan line). The black vertical line represents the moment when the
envelope mass starts leaving the box (≃ 260 days).

4 COMPARISON WITH PHANTOM SIMULATIONS

Alongside the ENZO simulation we carried out a set of simu-
lations using the SPH code PHANTOM (Price & Federrath 2010;
Lodato & Price 2010). This is the ﬁrst time that PHANTOM is ap-
plied to the common envelope problem.

Our ﬁrst simulation, using 2.3 million particles, has similar
parameters to that carried out by P12 with a companion mass of
0.6 M⊙ and is used as a veriﬁcation step to ensure that PHANTOM
performs similarly to the other codes we have used. This simula-
tion’s outcomes were compared directly with the SPH simulation
“SPH2”, which in that study was carried out with the SPH code
SNSPH (Fryer et al. 2006) using 500 000 SPH particles. Compar-
isons were carried out for all energy and angular momentum quan-
tities (see ﬁgures 8 and 9 in P12), separation evolution (their ﬁg-
ure 4) and were found to be in all cases within 10 per cent of one
another. Small differences can be ascribed to different resolution,
differences in the codes and to a somewhat different stellar setup
(more below). We carried out a convergence test using 3 resolu-
tions. In Fig. 13 we show the evolution of the orbital separation
for simulations using 23, 000, 230, 000, and 2.3 million particles,
respectively. The factor of 10 difference between the resolutions is
just larger than the minimum resolution step needed for such a test.
While this test shows that we have not yet achieved formal con-
vergence, the change in orbital evolution with resolution is much
smaller between the higher two resolutions than between the lower
two, indicating converging behaviour.

The core of the giant was approximated using a sink par-
ticle which was made to accrete all SPH particles within a ra-
dius of 0.03 R⊙. This quickly generated a “core” with a mass of
Mc=0.392 M⊙. The giant was stabilised as was done for the ENZO
simulations. The companion particle was placed in the computa-
tion with a mass of 0.6 M⊙. Both core and companion particles
were given a softening length1 of 3 R⊙.

The ﬁnal separation we obtain with PHANTOM is 21 R⊙ at
∼ 180 days (the end of the dynamical in-spiral as deﬁned above),
16 R⊙ at 1000 days and 14 R⊙ at the end of the simulation at
1500 days. The ﬁrst two values can be compared to 21 R⊙ at the
end of the in-spiral and 18 R⊙ at 1000 days for simulation SPH2
of P12. The mass unbound in our PHANTOM simulation is ∼ 12
per cent of the envelope mass, compared to approximately 10 per
cent for SPH12 of P12. We think that these differences are mainly
due to the differences in resolution and the sightly different initial
separation of 100 R⊙ that we had to adopt because the relaxed star
in PHANTOM has a larger radius (R = 93 R⊙; deﬁned using the
volume-equivalent deﬁnition of Nandez et al. 2014) compared to
the radius of the star stabilised in simulation SPH2 of P12 (R =
83 R⊙).

We then carried out a second PHANTOM simulation with a
larger initial separation, to corroborate whether a larger initial sepa-
ration promotes a wider ﬁnal separation. Our new PHANTOM simu-
lation has an initial separation of 218 R⊙, the distance at which the
primary ﬁlls its Roche lobe. Ideally we would have used a larger
separation of 300 R⊙, like for the ENZO simulation discussed here.
However, the orbital evolution of a PHANTOM simulation with an
initial separation of 300 R⊙ was too slow to reach the common
envelope phase in reasonable computational times. This is due to

260 days. Before this threshold is passed the code conserves en-
ergy to the 4 percent level, similar to the result of Sandquist et al.
(1998).

1 The softening length in PHANTOM is equivalent to the smoothing length
in ENZO. PHANTOM reserves the term “smoothing length” for the size of
the smoothing kernel, such that each SPH particle has a smoothing length.

12

Iaconi et al.

0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

Time (years)

0
250

2

4

Time (years)
6
8

10

12

100

80

)

⊙

R
(
 
a

60

40

20

26

25

24

23

22

21

20

19
250 260 270 280 290 300 310 320

0

200

400

600

800
Time (days)

1000

1200

1400

Figure 13. Evolution of the separation, a, between the two particles repre-
senting the core of the primary and the companion, used to show the conver-
gence for the PHANTOM code. The simulation reproduces the one from P12
with the same companion’s mass as this work (M2 = 0.6 M⊙). The num-
ber of SPH particles used is: 2.3 × 104 (blue), 2.3 × 105 (red), 2.3 × 106
(yellow). The inset shows a 10× zoom on the end of the rapid in-spiral
phase.

the stability of SPH simulations to surface deformations (Springel
2010, ; see also our discussion in Section 3.3 and Fig. 8).

The ﬁnal separation of this simulation was 29 R⊙, using the
criterion above or 22 R⊙ at the end of the simulation (5050 days).
In Figure 14 we compare the evolution of the separations of our
two PHANTOM simulations by shifting the simulation starting at
100 R⊙ by 3096 days to a time when the other simulation, starting
at 218 R⊙ has a separation of 100 R⊙. We can therefore compare
compare 29 and 22 R⊙ for the “wide” simulation, with 21 R⊙and
16 R⊙, for the PHANTOM simulation starting with a smaller sepa-
ration.

The two PHANTOM simulations show an increase in the ﬁ-
nal orbital separation by 38 per cent, corroborating the conclusion
drawn from comparing the two ENZO simulations that the ﬁnal or-
bital separation increases by including phases before the fast in-
spiral. The mass unbound in the PHANTOM simulation starting at
218 R⊙ is 15 per cent, marginally larger than the 12 per cent for
the same simulation starting with a lower initial separation.

5 COMPARISON WITH PUBLISHED SIMULATIONS

least one giant

Here we carry out a comparison of CE simulations contain-
ing at
(Rasio & Livio 1996; Sandquist et al.
1998; Passy et al. 2012; Ricker & Taam 2012; Nandez et al. 2015;
Ohlmann et al. 2016), highlighting possible trends or aspects that
need further clariﬁcation. We do not include those simulations car-
ried out by Staff et al. (2016) that started with highly eccentric or-
bits. All the ﬁnal results of these simulations are summarised in
Table 1. All the simulations, except that of Nandez et al. (2015) are
carried out with codes that include similar physics and can be more
directly compared.

200

150

)

⊙

R
(
 
a

100

50

0

0

1000

2000

3000

4000

5000

Time (days)

Figure 14. Evolution of the separation, a, between the the two particles
representing the core of the primary and the companion for the PHANTOM
simulations with initial separations of 100 R⊙ (blue curve) and 218 R⊙
(red curve). For a clearer comparison of the ﬁnal separation the blue line
has been shifted forward in time by 3096 days, which is the time when the
orbital separation of that simulation reaches 100 R⊙.

5.1 Side-by-side code comparison; PHANTOM vs. ENZO

The only side-by-side code comparison that can be carried out is
between ENZO, SNSPH and PHANTOM for which almost identical
simulations were carried out. The comparison between the ﬁrst two
was already carried out by P12. Here we only add that SNSPH re-
sults in ﬁnal separations that are approximately 10 per cent larger
than for ENZO. The relative difference does however increase for
simulations with very low mass companions (0.1 M⊙).

The comparison between SNSPH (simulation SPH2 in P12)
and our own PHANTOM simulation shows that, at the criterion
point, the two values are the same within one solar radius, while at
1000 days the PHANTOM separations is 10 per cent smaller, but has
the same value as the ENZO simulation. We conclude that code-to-
code differences for these three codes and for this parameter space
are within 10 per cent for simulations with companions more mas-
sive than ∼0.3 M⊙.

5.2 The ﬁnal orbital separation as a function of M2/M1

Comparing the 5 ENZO simulations of P12 with each other, or their
5 SNSPH simulations with each other, or, to an extent, comparing
two of the simulations of Sandquist et al. (1998) for which only
M2 was changed, we conclude that the ﬁnal separation has a clear
relationship to the value of M2 for the same value of M1. It is dif-
ﬁcult to compare with the other simulations, because although two
simulations may have the same value of q, the binding energies of
the primaries’ envelope could be vastly different (but see Sec. 5.3).
Sandquist et al. (1998) also compared two simulations with
different primaries and the same q. The simulation with the more
extended, lower binding envelope energy primary has a much larger
ﬁnal separation (see Table 1), but we did not plot it because the ﬁnal
separation cannot decrease much below the resolution times the
particles’ smoothing length and in that simulation the two values
are almost they same.

The post-CE binary observations of Zorotovic et al. (2011)

Effect of initial separation on common envelope simulations

13

show that post-CE binaries with post-RGB primaries (identiﬁed by
a mass smaller than 0.5 M⊙) have systematically smaller separa-
tions than post-CE binaries with post-AGB primaries (which have
masses larger than 0.5 M⊙). They also show a marginal correlation,
though statistically “real”, between secondary mass and post-CE
orbital separation. The latter conclusion is in line with the simula-
tions, though clearly the signal in the data is diluted by the range in
primary masses for each secondary mass (see below).

5.3 The ﬁnal orbital separation as a function of primary

mass or envelope binding energy

The simulations of Rasio & Livio (1996), Nandez et al. (2015) and
Ohlmann et al. (2016) produce distinctly lower separations, even
accounting for their different values of M2. We ascribe this dif-
ference to heavier and/or more compact primaries, resulting in en-
velopes with larger binding energies. The P12 and Sandquist et al.
(1998) simulations with the most comparable values of q are ex-
tremely similar, despite the fact that the lower mass for the former
should promote a wider separation than the higher mass for the lat-
ter. On the other hand, Sandquist et al. (1998) simulated a more
extended AGB star, which could lead to a wider separation, coun-
tering the effect of the larger primary mass.

We do not think that the reason for the compact ﬁnal conﬁgu-
ration achieved by Nandez et al. (2015) is the extra energy source.
If anything, that should have contributed to a wider separation, be-
cause of a more prompt envelope ejection. The reason is likely the
more compact conﬁguration of their RGB giant.

5.4 The ﬁnal orbital separation as a function of giant spin at

the time of Roche lobe overﬂow

It could be argued that starting with a wider initial separation has,
primarily, the effect of spinning up the giant, by injecting the the
orbital angular momentum into the envelope. The farther the initial
separation (within the limits of tidal effectiveness) the more angu-
lar momentum is available. This may in turn reduce the velocity
contrast between the companion and the envelope and result in a
smaller gravitational drag. However, the rotating and non-rotating
simulations of Sandquist et al. (1998) reached the same ﬁnal sepa-
ration, indicating that the larger amount of angular momentum of
their rotating star does not inﬂuence the outcome of those CE sim-
ulations.

The simulations of Sandquist et al. (1998) did not stabilise
the star in the rotating frame. Neither did those of Ohlmann et al.
(2016). On the other hand those of Rasio & Livio (1996) stabilised
their rotating giant in the co-moving frame while slowly decreas-
ing the orbital separation to the moment of Roche lobe overﬂow.
Considering the lack of a difference between the rotating and non-
rotating results of Sandquist et al. (1998) we suggest that the lack
of stabilisation does not have an effect on the results.

If not by the presence of induced rotation, how can we explain
the slower plunge and the increase in the ﬁnal orbital separation by
between 25 (Section 3.1) and 38 per cent (Section 4) that resulted
from larger initial separations? Another cause for this difference
could be the envelope being more extended as an effect of simulat-
ing the entire Roche lobe overﬂow phase.

5.5 Unbound mass

The mass unbound at the end of the simulations listed in Table 1
ranges between 8 and 46 per cent (not counting the result of Nan-
dez et al. (2015)), something that cannot be accounting for the fact
that not all values were obtained with the same deﬁnition of bound
mass.

By looking at the outputs of the simulations of Sandquist et al.
(1998) and P12, one could deduce that
lower mass ratios
(M2/M1) lead to less unbound mass. However our work, that of
Rasio & Livio (1996), of Ricker & Taam (2012) and of P12 show
unbound gas masses that are overall lower than for the simulations
of Sandquist et al. (1998) or the simulations of Nandez et al. (2015)
that did not include recombination energy, which unbound 50 per
cent of the envelope (although this is only stated in the text of that
paper and no plots, nor other data are presented for that simulation).
The simulations of Staff et al. (2016) with a 3-M⊙ AGB star
in a common envelope with 0.6-3.0 M⊙ companions have not
been included in Table 1 because of their high initial eccentric-
ity, which makes them stand on their own. We note, however, that
resolution tests carried out in the context of those simulations show
that slightly unconverged simulations tend to unbind signiﬁcantly
more mass than better converged simulations. We therefore wonder
whether convergence, which is seldom formally achieved in this
type of time-consuming simulations, may impact the value of the
unbound mass.

The impact of the recombination energy on the unbound mass
was shown to be a promising avenue for further study by Nandez
et al. (2015), who derived unbound masses of almost 100 per cent,
compared to 50 per cent not including recombination energy. The
simulations by Ohlmann et al. (2016) repeated with recombination
energy (Ohlmann, private communication) also unbind twice the
mass as those carried out without recombination energy and pre-
sented in Ohlmann et al. (2016), but even so, still only unbinding a
small fraction of the total envelope.

6 CONCLUSIONS

In this work we have expanded on the results of Passy et al.
(2012) by repeating one of their common envelope simulations, an
0.88 M⊙, RGB primary and a 0.6 M⊙ companion, but increas-
ing the initial orbital separation from 1 to 3 times the initial stellar
radius. This is the approximate value of the orbital separation for
which a tidal capture can be expected and as such it is the approx-
imate value of the maximum angular momentum that can be deliv-
ered to the primary for such a system. We have also carried out a
parallel set of simulations using the SPH code PHANTOM aimed at
continuing code-code comparison while checking the concusions
obtained using the grid code.

We divided the evolution into a pre-contact phase, a mass
transfer phase and a rapid in-spiral phase. The pre-contact phase
is driven by tides. However, this phase is unrealistically short in
our simulation, due to small but tidally signiﬁcant oscillations of
the primary star envelope set in motion by the introduction of the
companion in the computational domain. Despite this unrealistic
timescale, a reasonable conservation of angular momentum ensures
that the primary absorbs the correct amount of angular momentum.
The mass transfer and the rapid in-spiral phases are in approximate
agreement with the theoretical expectations. Starting with a larger
initial separation results in a larger ﬁnal separation by between 25
and 38 per cent for the set of parameters tested in this work. Based

14

Iaconi et al.

on a comparison with simulations in the literature, we conclude
preliminarily that this to be due primarily to the stellar expansion
during the Roche lobe overﬂow phase, rather than the extra angular
momentum injected into the primary.

We observed that the unbinding of the mass happens in a short,
bursting event which begins shortly before the rapid in-spiral phase
and peaks early during it, as expected from previous work. All the
unbound mass is then rapidly pushed out of the simulation box.
The total amount of mass unbound during the interaction is 16 per
cent of the total envelope mass, while in the equivalent simulation
of Passy et al. (2012), 11 per cent of the envelope mass is unbound.
The companion could thus eject 60 per cent more mass than for a
simulation starting with a smaller orbit, probably because by tap-
ping the reservoir of orbital angular momentum in the wider orbit
the envelope has a lower binding energy. This increase is echoed by
comparing our two SPH simulations that started at different initial
separations.

By setting our results in the context of previous work, a new
picture seems to be emerging, indicating that the discrepancy be-
tween observed post-CE separations and simulation is not as deﬁni-
tive as when Passy et al. (2012) carried out their comparison, with
several simulations reproducing very small ﬁnal separations, even
for relatively large values of the M2/M1 ratio. The strong depen-
dence of ﬁnal separation on secondary mass can only assessed by
the P12 simulations, which carried out the necessary comparison.
The amount of unbound mass seems to cluster in two groups, with
low (.15 per cent) and high (&40 per cent) values, but the reason
for this difference is not clear.

Nandez et al. (2015) report to have resolved the problem of
unbinding the CE by including recombination energy in their sim-
ulations. However, there is an indication that in the different regime
of giant CE simulations, the inclusion of recombination energy is
not sufﬁcient to unbind the envelope (Ohlmann, private communi-
cation). It is also unclear whether the entire recombination energy
budget can also be used to unbind the envelope (as would be the
case in all adiabatic simulations) or whether it would partly radi-
ate away, decreasing its efﬁciency. This said, the pioneering work
of Nandez et al. (2015; see also Ivanova et al. 2015) constitutes
a step that will have to be considered and tested further in future
numerical simulations.

It is hoped that future simulations by different groups will at-
tempt to clarify some of the questions above by carrying out sim-
ilar simulations with a range of parameters. In this paper we have
also compared the simulations with the observations previously
used by P12. However additional observations, such as those by
Zorotovic et al. (2011) show new trends, which can guide parame-
ter choices of future simulations.

ACKNOWLEDGMENTS

JES acknowledges support from the Australian Research Council
Discovery Project (DP12013337) programme and the University
of Florida Theoretical Astrophysics Fellowship. OD gratefully ac-
knowledges support from the Australian Research Council Future
Fellowship grant FT120100452. JCP acknowledges funding from
the Alexander von Humboldt Foundation. This research was un-
dertaken, in part, on the National Computational Infrastructure fa-
cility in Canberra, Australia, which is supported by the Australian
Commonwealth Government, on the swinSTAR supercomputer at
Swinburne University of Technology and on the machine Kraken
through grant TG-AST130034, a part of the Extreme Science and

Engineering Discovery Environment (XSEDE), supported by NSF
grant number ACI-1053575. Computations described in this work
were performed using the ENZO code (http://enzo-project.org),
which is the product of a collaborative effort of scientists at many
universities and national laboratories.

REFERENCES

Bondi H., 1952, MNRAS, 112, 195
Bryan G. L., Norman M. L., O’Shea B. W., Abel T., Wise J. H.,
Turk M. J., Reynolds D. R., Collins D. C., Wang P., Skillman
S. W., Harkness R. P., Bordner J., Kim J.-h., Kuhlen M., Xu H.,
Goldbaum N., Hummels C., Kritsuk A. G., Tasker E., Skory S.,
et al., 2014, ApJ, 211, 19
De Marco O., Passy J.-C., Moe M., Herwig F., Mac Low M.-M.,
Paxton B., 2011, MNRAS, 411, 2277
Eggleton P. P., 1983, ApJ, 268, 368
Fryer C. L., Rockefeller G., Warren M. S., 2006, ApJ, 643, 292
Herwig F., 2000, A&A, 360, 952
Iben Jr. I., Livio M., 1993, Publications of the Astronomical Soci-
ety of the Paciﬁc, 105, 1373
Ivanova N., Chaichenets S., 2011, ApJ, 731, L36
Ivanova N., Justham S., Chen X., De Marco O., Fryer C. L.,
Gaburov E., Ge H., Glebbeek E., Han Z., Li X.-D., Lu G., Marsh
T., Podsiadlowski P., Potter A., Soker N., Taam R., Tauris T. M.,
van den Heuvel E. P. J., Webbink R. F., 2013, The Astronomy
and Astrophysics Review, 21, 59
Ivanova N., Justham S., Podsiadlowski P., 2015, MNRAS, 447,
2181
Lodato G., Price D. J., 2010, MNRAS, 405, 1212
MacLeod M., Ramirez-Ruiz E., 2015, ApJ, 803, 41
Nandez J. L. A., Ivanova N., Lombardi J. C., 2015, MNRAS, 450,
L39
Nandez J. L. A., Ivanova N., Lombardi Jr. J. C., 2014, ApJ, 786,
39
Nordhaus J., Blackman E. G., Frank A., 2007, MNRAS, 376, 599
Ohlmann S. T., R¨opke F. K., Pakmor R., Springel V., 2016, ApJ,
816, L9
O’Shea B. W., Bryan G., Bordner J., Norman M. L., Abel T.,
Harkness R., Kritsuk A., 2004, ArXiv Astrophysics e-prints
Ostriker E. C., 1999, ApJ, 513, 252
Paczynski B., 1976, in Eggleton P., Mitton S., Whelan J., eds,
Structure and Evolution of Close Binary Systems Vol. 73 of IAU
Symposium, Common Envelope Binaries. p. 75
Passy J.-C., Bryan G. L., 2014, The Astrophysical Journal Sup-
plement, 215, 8
Passy J.-C., De Marco O., Fryer C. L., Herwig F., Diehl S., Oishi
J. S., Mac Low M.-M., Bryan G. L., Rockefeller G., 2012, ApJ,
744, 52
Price D. J., Federrath C., 2010, MNRAS, 406, 1659
Rasio F. A., Livio M., 1996, ApJ, 471, 366
Reg˝os E., Tout C. A., 1995, MNRAS, 273, 146
Ricker P. M., Taam R. E., 2012, ApJ, 746, 74
Ruffert M., 1993, A&A, 280, 141
Sandquist E. L., Taam R. E., Chen X., Bodenheimer P., Burkert
A., 1998, ApJ, 500, 909
Springel V., 2010, ARA&A, 48, 391
Staff J. E., De Marco O., Macdonald D., Galaviz P., Passy J.-C.,
Iaconi R., Low M.-M. M., 2016, MNRAS, 455, 3511
Tocknell J., De Marco O., Wardle M., 2014, MNRAS, 439, 2014

Effect of initial separation on common envelope simulations

15

Tylenda R., Hajduk M., Kami´nski T., Udalski A., Soszy´nski
I., Szyma´nski M. K., Kubiak M., Pietrzy´nski G., Poleski R.,
Wyrzykowski Ł., Ulaczyk K., 2011, A&A, 528, A114
Zahn J.-P., 2008, in Goupil M.-J., Zahn J.-P., eds, EAS Publica-
tions Series Vol. 29 of EAS Publications Series, Tidal dissipation
in binary systems. pp 67–90
Zorotovic M., Schreiber M. R., G¨ansicke B. T., Nebot G´omez-
Mor´an A., 2010, A&A, 520, A86
Zorotovic M., Schreiber M. R., Gansicke B. T., Rebassa-
Mansergas A., Nebot Gomez-Moran A., Southworth J., Schwope
A. D., Pyrzas S., Rodriguez-Gil P., Schmidtobreick L., Schwarz
R., Tappert C., Toloza O., Vogt N., 2011, A&A, 536, L3

This paper has been typeset from a TEX/ LATEX ﬁle prepared by the
author.

1

Time (years)

3

2

4

5

0
0.0045

0.0040

0.0035

0.0030

)

⊙
M

0.0025

(
 
s
s
a
M

0.0020

0.0015

0.0010

0.0005

0.0000

0

500

1000

Time (days)

1500

2000

m
u
t
n
e
m
o
m

l

 
r
a
u
g
n
a
 
l
a
i
t
i
n
I
 
/
 

m
u
t
n
e
m
o
m

l

 
r
a
u
g
n
A

0
1.0

1

Time (years)

3

2

4

5

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1
0

500

1000

Time (days)

1500

2000

0
1e52
1.0

1

Time (years)

3

2

4

5

0.8

0.6

0.4

0.2

0.0

)

1
−
s
·

2

m

c
·
g
(
 

m
u
t
n
e
m
o
m

l

 
r
a
u
g
n
A

−0.2
0

500

1000

Time (days)

1500

2000

