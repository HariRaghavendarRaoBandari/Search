Quantum Holonomies from Spectral Networks and
Framed BPS States

Maxime Gabellaa

aInstitute for Advanced Study, Einstein Drive, Princeton, New Jersey 08540, USA

E-mail: gabella@ias.edu

Abstract: We propose a method for determining the spins of BPS states supported on
line defects in 4d N = 2 theories of class S. Via the 2d-4d correspondence, this translates to
the construction of quantum holonomies on a punctured Riemann surface C. Our approach
combines the technology of spectral networks, which decomposes ﬂat GL(K, C)-connections
on C in terms of ﬂat abelian connections on a K-fold cover of C, and the skein algebra
in the 3-manifold C × [0, 1], which expresses the representation theory of the quantum
group Uq(glK). With any path on C, the quantum holonomy associates a positive Laurent
polynomial in the quantized Fock-Goncharov coordinates of higher Teichm¨uller space. This
conﬁrms various positivity conjectures in physics and mathematics.

6
1
0
2

 
r
a

 

M
6
1

 
 
]
h
t
-
p
e
h
[
 
 

1
v
8
5
2
5
0

.

3
0
6
1
:
v
i
X
r
a

Contents

1 Introduction

2 Spectral networks

2.1 Abstract deﬁnition
2.2 Spectral networks in N = 2 theories
2.3 Fock-Goncharov spectral networks

3 Nonabelianization

3.1 From abelian to nonabelian ﬂat connections
3.2 Coordinates on moduli spaces of ﬂat connections
3.3 Relation to Fock-Goncharov coordinates

4 Quantum parallel transport

4.1 Detours
4.2 Homotopy invariance
4.3 Relation to snake matrices

5 Quantum dimension

5.1 Elevation
5.2 Split triangulation
Isotopy invariance: R-matrix
5.3
5.4
Isotopy invariance: cup/cap
5.5 Skein relations and junctions

6 Properties of quantum holonomies

6.1 Quantum holonomy
6.2 Left- and right-turns
6.3 Canonical lifts
6.4 Positivity
6.5
Invariance under inversion of q
6.6 Self-intersections and junctions

7 Examples

7.1 Punctured torus
7.2 Three-punctured sphere

– 1 –

2

6
6
7
9

10
10
12
14

15
15
17
18

24
24
24
25
27
28

29
30
30
30
31
32
34

34
34
36

1 Introduction

The maximally supersymmetric conformal ﬁeld theories in the maximum number of di-
mensions are the six-dimensional (2, 0) superconformal theories, which are labeled by a
simply-laced Lie algebra g. The (2, 0) theory with g = AK−1 can be realized in M-theory
as the low-energy limit of the worldvolume theory of K coincident M5-branes. Although
little is known about these theories, their existence leads to a geometric description of
many supersymmetric ﬁeld theories in lower dimensions. As a prime example, the twisted
compactiﬁcation of the six-dimensional (2, 0) theories on a Riemann surface C produces
a rich class of N = 2 supersymmetric theories in four dimensions (called class S ), whose
properties are encoded in the geometry of C [1–3].

The 6d (2, 0) theory contains dynamical strings, which arise from the two-dimensional
boundaries of open M2-branes stretched between M5-branes. In the limit where its tension
tends to inﬁnity, a dynamical string becomes a nonabelian surface defect S, which can pre-
serve some supersymmetry. After compactiﬁcation on C, a surface defect extending along
the time direction in 4d spacetime and wrapping a closed path ℘ on C deﬁnes a line defect
L℘ in the 4d N = 2 theory, such as a Wilson or ’t Hooft operator [4–6]. The expectation
value of a supersymmetric line defect L℘ is conjectured to admit a decomposition of the
form [7]

(cid:104)L℘(cid:105) =

Ω(℘, γ)Xγ ,

(1.1)

γ

where Xγ can be thought of as the expectation value of a line defect with electromagnetic
charge γ in the low-energy IR theory, in which the SU (K) gauge symmetry is broken to
the abelian subgroup U (1)K−1. The coeﬃcients Ω(℘, γ) are integers which count the BPS
states supported on L℘, called framed BPS states. It is possible to account for the spins
of framed BPS states by reﬁning this BPS index into the framed protected spin character
Ω(℘, γ; q), which is a function of a variable q. It is deﬁned as a trace over the Hilbert space
HL,γ of framed BPS states with charge γ:

Ω(℘, γ; q) = TrHL,γ q2J3(−q)2I3 ,

(1.2)

(cid:88)

where J3 and I3 are Cartan generators of the spatial rotations so(3) and of the su(2)R
symmetry (it reduces to the framed BPS index Ω(℘, γ) for q = 1). According to the “no
exotics conjecture,” all BPS states are in fact singlets of su(2)R with I3 = 0. The generating
function of framed protected spin characters is

(cid:88)

F (L℘) =

Ω(℘, γ; q) ˆXγ ,

where the noncommutative variables ˆXγ satisfy the relation

γ

ˆXγ1

ˆXγ2 = q(cid:104)γ1,γ2(cid:105) ˆXγ1γ2 ,

with (cid:104)·,·(cid:105) denoting the Dirac-Schwinger-Zwanziger antisymmetric product of charges.

– 2 –

(1.3)

(1.4)

A method for computing the framed BPS indices Ω(℘, γ) for 4d N = 2 theories of
class S was provided in [7]. The moduli space M of vacua of these theories on R3 × S1 is
isomorphic to the hyperk¨ahler moduli space of solutions to Hitchin’s equations on C with
singularities at the punctures [1, 8]. These equations concern a connection A and a 1-form
ϕ, and amount to the ﬂatness of the complex connections

A(ζ) = R

ϕ
ζ

+ A + Rζ ¯ϕ

(1.5)

for all values of ζ ∈ C×, where R is the radius of the compactiﬁcation circle S1. In fact,
in one of its complex structure, M can be identiﬁed with the moduli space of complex
ﬂat connections A(ζ) with certain monodromies around the punctures. The functions Xγ
in (1.1) are Darboux coordinates on M, closely related to the Fock-Goncharov coordinates
of higher Teichm¨uller theory, associated with ideal triangulations of C [9].

The expectation value of the line defect L℘ can then be expressed as the holonomy of

a ﬂat connection A along the path ℘ [7]:

(cid:104)L℘(cid:105) = Tr Hol℘A .

(1.6)

There is a well-known algorithm to expand these holonomies in terms of Fock-Goncharov
coordinates [9]. The decomposition (1.1) of UV line defects in terms of IR line defects thus
corresponds to a map from the space of paths ℘ on C to the space of Laurent polynomials
in the coordinates Xγ on the moduli space of ﬂat connections. The framed BPS indices
Ω(℘, γ) are the coeﬃcients in these polynomials.

In this paper, we propose a method for computing the framed protected spin char-
acters Ω(℘, γ; q) by constructing quantum holonomies of ﬂat P GL(K, C)-connections, ex-
pressed as Laurent polynomials in the quantized Fock-Goncharov coordinates. We achieve
this mainly by combining two recent developments: the “spectral networks with spin”
of Galakhov, Longhi, and Moore [10], and the SL(2) “quantum trace” of Bonahon and
Wong [11].

A quantum parallel transport along open paths on C was deﬁned in [10] using the
technology of spectral networks [12, 13]. In their simplest incarnation, spectral networks
are collections of trajectories (walls) starting from the branch points of a K-fold branched
covering Σ → C (the Seiberg-Witten curve or Hitchin spectral curve) and ending at the
punctures (section 2). They lead to a nonabelianization map, by which ﬂat GL(K, C)-
connections on C can be described in terms of ﬂat abelian connections on Σ (section 3).
The quantum parallel transport was constructed in [10] by identifying the spin 2J3 of a
framed BPS state of charge γ with the writhe, that is a signed sum over self-intersections,
of the corresponding path γ on Σ (section 4). This gives an expression like (1.3), where
(cid:104)·,·(cid:105) now denotes the intersection pairing on H1(Σ, Z). However, this quantum parallel
transport cannot be used as such to compute quantum holonomies for closed paths ℘
because the result would depend on the choice of basepoint. Indeed, moving the basepoint
across a self-intersection of a path γ in Σ changes its handedness, and hence its contribution
to the spin (it exchanges q and q−1).

– 3 –

The issue of the dependence on the choice of basepoint can be solved by thinking of ℘

as a closed path (a knot) in the 3-manifold

M3 = C × [0, 1] .

(1.7)

The elevation along the interval [0, 1] then corresponds to a quantum ordering. The algebra
of line defects in the N = 2 theory on R3×S1 is indeed quantized by twisting to the ﬁbered
product R×R2×q S1 such that the coordinates on R2 are rotated by q after going around S1.
BPS line defects on S1 then have a deﬁnite ordering along the axis R, which thus plays the
same role as the interval [0, 1] in (1.7). Moreover, motivated by the relation with Chern-
Simons theory [14, 15], Turaev showed that the Poisson algebra of paths on a surface C can
be quantized by the skein algebra of knots in M3 [16]. This 3-dimensional approach was
used successfully by Bonahon and Wong to deﬁne a quantum trace for SL(2, C) [11] (see
also [17, 18]), that is a homomorphism from the skein algebra to the quantum Teichm¨uller
space [19]. The quantum trace maps every isotopy class of knot in M3 to a Laurent
polynomial in the quantized shear coordinates associated with an ideal triangulation of
C. The isotopy invariance of the quantum trace is ensured by carefully controlling the
elevation of segments of the knot, which is achieved by inserting certain transformations
over the edges of the triangulation. These transformations are related to the R-matrix and
to the cup/cap matrices of the quantum group Uq(sl2), such as those used by Reshetikhin
and Turaev to construct isotopy invariants of knots [20]. The appearance of the quantum
R-matrix is natural from the perspective of Chern-Simons theory, where it corresponds to
a crossing of two Wilson lines [15].

Inspired by these developments, we construct a quantum holonomy for ﬂat P GL(K, C)-
connections which associates with every path ℘ on C a Laurent polynomial in the quantized
Fock-Goncharov coordinates ˆxα:

Tr Holq

℘ =

Ω(℘, γ; q) ˆXγ ,

(1.8)

(cid:88)

γ

where the coeﬃcients Ω(℘, γ; q) are the framed protected spin characters, and ˆXγ is of the
form

ˆXγ = q−(cid:80)

α<β aαεαβ aβ ˆxa1

1 ··· ˆxan

n

(1.9)

for some integers aα. The sum in (1.8) is over paths γ on the K-fold cover Σ that are
lifted from ℘ on C, with certain detours along the walls of the spectral network. The
strategy is to ﬁrst compute the quantum parallel transport along segments of ℘ on each
triangle of the ideal triangulation, and then to glue them together with Uq(glK)-matrices to
control their relative elevation along the interval [0, 1] (section 5). This guarantees that the
quantum holonomy is invariant under isotopy in M3, and so in particular under changes in
the choice of basepoint (thought of as the lowest point of ℘ along [0, 1]). By construction,
the coeﬃcients Ω(℘, γ; q) are Laurent polynomials in q. In section 6, we show that they
are in fact positive Laurent polynomials, and are invariant under inversion of q. This is
in agreement with the positivity conjectures by Gaiotto, Moore, and Neitzke [7], and with
the related conjectures by Fock and Goncharov [9, 21].

– 4 –

The properties of the quantum holonomy are clearest for a simple path ℘ (without
self-intersection), or more generally for a lamination, that is a collection of non-intersecting
simple paths. When ℘ has self-intersections, the invariance under inversion of q is spoiled.
However, skein relations such as those described in section 5.5 resolve intersections into
non-intersecting paths and pairs of trivalent junctions. The quantum holonomy for the
resulting network 1 with junctions enjoys the same nice properties as for a simple path.

Our results can be formalized in the following theorem:

Theorem 1:
and networks on a Riemann surface C to the quantized algebra X q
moduli space of ﬂat P GL(K, C)-connections on C:

There exists a quantum holonomy map from the space AK of simple paths
K of functions on the

It associates with any simple path or network ℘ on C a Laurent polynomial

Tr Holq : AK → X q
K .

(cid:88)

(1.10)

(1.11)

Tr Holq

℘ =

Ω(℘, γ; q) ˆXγ

with the following properties:

γ

1. It agrees with the classical trace of the holonomy of a ﬂat P GL(K, C)-connection

along ℘ when q = 1:

Tr Hol1

℘ = Tr Hol℘ .

2. Its highest term has a unit coeﬃcient:

Ω(℘, γhighest; q) = 1 ,

3. Its coeﬃcients are positive Laurent polynomials in q:
Ω(℘, γ; q) ∈ Z>0[q, q−1]

4. It is invariant under inversion of q:

Ω(℘, γ; q) = Ω(℘, γ; q−1) .

(1.12)

(1.13)

(1.14)

(1.15)

Property 3 conﬁrms the “weak positivity conjecture” in [7], and furthermore Property 4
brings support to the “strong positivity conjecture.” To make precise contact with the
conjectures of Fock and Goncharov (Conjecture 12.4 in [9] and Conjecture 4.8 in [21])
would require a better understanding of the relation between the space of tropical points of
the so-called A-space and the space of networks with junctions (see for example the “higher
laminations” of [22, 23] and the “charge/network dictionary” in [24, 25]). It should also

1 Such networks should not be confused with spectral networks!

– 5 –

be possible to relate exactly to the SL(2, C) quantum trace of Bonahon and Wong [11]
by introducing some normalizations, and to see that their application of Weyl quantum
ordering matches the pattern of intersections of detoured paths.

We illustrate our construction of quantum holonomies in section 7 by computing some
framed protected spin characters for 4d N = 2 theories associated with the punctured torus
and with the three-punctured sphere. They agree with the ones deduced in [26] from the
fact that the noncommutative algebra of line operators coincides with the skein algebra.
It would also be interesting to compare our method for computing framed protected spin
characters to the method based on representations of framed BPS quivers [27–29].

Note that the quantized algebra of functions on the moduli space of ﬂat P GL(K, C)-
connections was shown in [26] to match the algebra of Verlinde loop and network operators
in SU (K) Toda ﬁeld theory. This follows essentially from the observation that the braiding
matrix, from which the Verlinde operators are built, is related to the quantum R-matrix of
Uq(slK). Nonabelianization certainly has an interesting interpretation in Toda theory too.
Our three-dimensional construction of quantum holonomies should ﬁnd a natural envi-
ronment in the 3d-3d correspondence, which relates 3d N = 2 supersymmetric ﬁeld theories
to SL(K, C) Chern-Simons theory on a 3-manifold [30–32] (see [33] for a review). We also
anticipate exciting connections with the upcoming work on 3d spectral networks by Freed
and Neitzke [34].

2 Spectral networks
A spectral network is a collection of paths on a punctured Riemann surface C obeying
certain local conditions. Spectral networks were introduced in [12, 13] and shown to play a
fundamental role in understanding the spectrum of BPS states and wall-crossing in N = 2
supersymmetric ﬁeld theories of class S. They provide a relation between ﬂat GL(K, C)-
connections on C and abelian ﬂat connections on a K-fold branched cover Σ of C. We ﬁrst
present their abstract deﬁnition and then review the physical motivations behind it. We
also describe the special family of spectral networks on which we will focus in this paper,
because of their relation with ideal triangulations of C.

2.1 Abstract deﬁnition
Let C be an oriented Riemann surface with a non-empty set of marked points and a (possibly
empty) boundary. Marked points in the interior of C are referred to as punctures, and each
boundary component must contain at least one marked point. Let π : Σ → C be a K-fold
branched covering of C, which is unramiﬁed over the boundary and the punctures. It is
convenient to choose a set of branch cuts on C, on the complement of which the covering can
be trivialized and the sheets of Σ labeled by integers i = 1, . . . , K. The branch points are
assumed to be simple, so that a monodromy around a branch point of type (ij) exchanges
sheet i and sheet j.

A spectral network W subordinate to the covering Σ → C is a collection of oriented
paths on C, called walls, labeled by ordered pairs ij. Exactly three walls (of types ij or ji)
begin at each branch point of type (ij), and each wall ends at a puncture or at a marked

– 6 –

point on the boundary.
In degenerate cases, a pair of oppositely-oriented walls can be
stretched between two branch points. An ij-wall can also begin or end at the intersection
of an ik-wall and a kj-wall.
2.2 Spectral networks in N = 2 theories
Spectral networks arise naturally in N = 2 supersymmetric ﬁeld theories in four dimen-
sions. We focus on theories of class S associated with the Lie algebra AK−1, which describe
a system of K coincident M5-branes wrapping a punctured Riemann surface C. At a generic
point of the Coulomb branch of the 4d N = 2 theory, the gauge symmetry group is abelian
in the IR, and the M5-branes separate by wrapping a K-fold branched cover Σ of C. This
is the Seiberg-Witten curve, given by the spectral curve of an AK−1 Hitchin system:

Σ = {λ ∈ T ∗C : λK +

φrλK−r = 0} ,

(2.1)

K(cid:88)

r=2

(cid:104)
e−iϑ(cid:104)λij, v(cid:105)(cid:105)

where φr are meromorphic r-diﬀerentials on C with prescribed singularities at the punc-
tures. The restriction of the Liouville one-form to Σ gives a natural holomorphic one-form,
which we also denote by λ. Choosing a trivialization of Σ → C corresponds to labeling the
solutions of (2.1) as λi, with i = 1, . . . , K, so that the graph of λi in T ∗C is sheet i of Σ.
A branch point of type (ij) is a point z ∈ C where sheets i and j collide, λi(z) = λj(z).
An ij-trajectory with phase ϑ is a path p on C satisfying the diﬀerential condition

(2.2)
where λij = λi − λj, and v is a vector ﬁeld along p. It has a natural orientation, with the

positive direction corresponding to Re(cid:2)e−iϑ(cid:104)λij, v(cid:105)(cid:3) > 0. The walls of a spectral network

= 0 ,

Im

are certain ij-trajectories. Before giving a more precise deﬁnition, we review the relevance
of the condition (2.2) for various BPS states.

BPS states in the 4d theory arise from strings in the 6d theory that extend along
paths p on C, and hence look like point-particles. These paths p are labeled by pairs ij of
sheets and lift to closed paths γ on Σ, which can be thought of as boundaries of M2-branes
stretched between M5-branes. This implies that the paths p may be closed paths, or have
endpoints at branch points and at junctions with other strings. For example, an open path
p with label ij between two branch points on C lifts to a closed path γ = p(i)(p(j))−1 on
Σ, where p(i) denotes the lift of p to sheet i, and the minus sign means reverse orientation.
The homology class of γ in H1(Σ; Z) is the charge of the corresponding state, while its
central charge and mass are given by

(cid:90)

(cid:90)

p

Z =

1
π

λij ,

M =

1
π

p

|λij| .

(2.3)

The BPS bound |Z| ≤ M is saturated when λij has the same phase ϑ everywhere along p,
in which case Z = eiϑM . This is true if and only if the condition (2.2) is satisﬁed. BPS
states therefore correspond to webs of ij-trajectories. The value of of the parameter ζ = eiϑ
determines which supercharges are preserved.

– 7 –

Figure 1. Left: Soliton path p from a branch point of type (ij) to a point z on C, where a surface
defect Sz is located. Right: Lift of p to a 1-chain γij from z(i) to z(j) on Σ.

There is another kind of BPS states, called solitons (or 2d-4d BPS states), that are
bound to half-BPS surface defects Sz in the 4d theory. A surface defect Sz is parameterized
by a point z on C, and generically has K distinct massive vacua, which correspond to the
K lifts of z(i) to the sheets of Σ. Solitons interpolate between two distinct vacua z(i) and
z(j). They are realized geometrically as open webs paths? of strings on C in which one
of the strings ends at z. Their charges are given by relative homology classes of 1-chains
γij on Σ with endpoints z(i) and z(j). The basic example is a string extending along an
open path p between a branch point and z (ﬁgure 1). The central charge and the mass are
again given by (2.3), from which it follows that BPS solitons correspond to ij-trajectories
satisfying (2.2), for some ﬁxed phase ϑ.

A spectral network Wϑ with phase ϑ is a representation on C of all BPS solitons of

phase ϑ, that is a collection of ij-trajectories (2.2), for all ordered pairs ij:
{ij-trajectories supporting a soliton of phase ϑ} .

Wϑ =

(cid:91)

(2.4)

ij

This gives a network on C, made out of walls that start at branch points and asymptote to
punctures (walls can also appear or disappear at junctions). Letting z be a local coordinate
with z = 0 at a branch point, we have Z (cid:39) z3/2, which implies that there are three walls
emerging from the branch point. Note that for generic values of ϑ, the network Wϑ does
not contain any closed web of strings that correspond to 4d BPS states. This happens
however for critical values ϑc for which an ij-wall and a ji-wall collide, and the topology
of Wϑ changes.
There is one more type of BPS states that plays an important role, namely framed
BPS states. An open path ℘ from z1 to z2 on C determines a pair of surface defects Sz1 and
Sz2 as well as a supersymmetric interface L℘ between them. The line defect L℘ should only
depend on the homotopy class of ℘. The framed 2d-4d BPS states are the supersymmetric
states of this combined system. Geometrically, a framed 2d-4d BPS state is represented
by a path γ on Σ which is essentially a lift of ℘ from z(i)
2 . More precisely, at each
1
point where ℘ intersects a wall of the spectral network, the path γ can make a detour
along a soliton path γij from the intersection point to the branch point and back. In such
a case, the lifts of the segments of ℘ before and after the wall are on diﬀerent sheets. The
projection of γ to C was compared to a millipede in [7], with the body corresponding to ℘,
and the legs to the detours.

to z(j)

– 8 –

Figure 2. Examples of Fock-Goncharov spectral networks W on a triangle C for K = 2 and K = 3.
The walls (black arrows) of W begin at branch points (orange dots) of the K-fold covering Σ → C,
and end at the marked points (black dots) on the boundary. They are labeled by ordered pairs ij
of sheets of Σ. Branch cuts (dashed orange lines) are labeled by pairs (ij).

The case where ℘ is a closed path and Sz1 = Sz2 are the null surface defect at z1 = z2
corresponds to the line defect L℘ discussed in the introduction. The framed BPS states
supported on L℘ are associated with paths γ on Σ that are lifts of ℘ with possible detours
along the walls of Wϑ intersected by ℘.

2.3 Fock-Goncharov spectral networks

While general spectral networks for K > 2 can be very complicated, an interesting family
of tractable spectral networks was deﬁned in [13]. Their advantage is that they are closely
related to spectral networks for K = 2, which are simply dual to ideal triangulations of C
(with vertices at marked points). This provides a direct connection with the work of Fock
and Goncharov on higher Teichm¨uller theory [9]. For simplicity, we focus on this family of
Fock-Goncharov spectral networks in this paper. This will provide us with a nice way to
organize changes of relative elevation along [0, 1] in section 5. We leave the extension of
our approach to more general spectral networks for future work.

The idea used in [13] is to start with a Seiberg-Witten curve (2.1) for K = 2 and
apply to it a homomorphism ρ : SU (2) → SU (K) given by the K-dimensional irreducible
representation of SU (2). The resulting curve is reducible, but can be made irreducible by
a small perturbation. As an example, for K = 3, starting with λ2 + φ2 = 0 we obtain a
curve of the form

λ3 + (2φ2 + δφ2)λ + δφ3 = 0 .

(2.5)

Each of the branch points of the original curve splits into three slightly separated branch
points for the new curve. Far away from these branch points, the walls of the associated
spectral network align closely with the walls of the K = 2 spectral network. We show this
procedure in ﬁgure 2 for the case where C is simply a triangle (a disc with three marked
points on the boundary).

Although no branch cut is necessary in the case of a triangle (since it is contractible),
we choose a symmetric arrangement of three branch cuts at each branch point, which will

– 9 –

be convenient when gluing triangles to obtain more elaborate Riemann surfaces C. With
this choice of branch cuts, all the branch points are of type (12). Some triplets of branch
cuts of type (i, i + 1) meet at points in the middle of the triangle and continue as branch
cuts of type (i + 1, i + 2). This pattern is motivated by the requirement that the total
transformation when crossing all the branch cuts along an edge of the triangle be the
permutation {1, 2, . . . , K − 1, K} → {K, K − 1, . . . , 2, 1}.

For general K, each branch point of the 2-fold covering splits into 1

branch points of the K-fold covering. The corresponding spectral network has three walls
emerging from each branch point and ending at punctures. A collection of 1
walls that parallel a wall of the K = 2 spectral network is referred to as a cable. The labels
ij of the walls in each cable can be chosen such that there is one wall with label 12, two
with 23, three with 34, and so on (this was called a minimal spectral network of Yang type
in [13]). This choice ensures that no new wall is created at any of the intersections.

2 K(K − 1) nearby
2 K(K − 1)

3 Nonabelianization

Spectral networks lead to a process called nonabelianization [12], by which ﬂat GL(K, C)-
connections on a Riemann surface C are described in terms of ﬂat abelian connections on
a K-fold branched cover Σ of C. Nonabelianization provides coordinates on the moduli
space of ﬂat connections, which are closely related to the Fock-Goncharov coordinates and
admit a natural quantization.

3.1 From abelian to nonabelian ﬂat connections
Given a spectral network W subordinate to a K-fold covering Σ → C, the nonabelianization
map ΨW is deﬁned as follows. Consider a ﬂat abelian connection ∇ab in a line bundle L
over Σ(cid:48), where the prime indicates that the branch points of the covering π : Σ → C are
removed. The push-forward π∗(∇ab) gives a ﬂat connection in the rank-K vector bundle

E(cid:48) = π∗(L)

(3.1)
over C(cid:48). However, π∗(∇ab) cannot be extended to a ﬂat connection on all of C because
it has non-trivial monodromies around the branch points. These monodromies can be
eliminated by cutting C(cid:48) along the walls of the spectral network W and regluing the con-
nection with certain (non-diagonal) transition functions. This produces the desired ﬂat
GL(K, C)-connection

∇ = ΨW (∇ab)

(3.2)

in a rank-K vector bundle E over C.

A little more precisely (see section 10 of [12] for full detail), in each component of

C(cid:48)\W the rank-K vector bundle decomposes as

E(cid:48) =

Li ,

(3.3)

K(cid:77)

i=1

– 10 –

Figure 3. Detour γij along an ij-wall, starting at z(i) on sheet i and ending at z(j) on sheet j.

with Li denoting the restriction of the line bundle L to sheet i, and π∗(∇ab) is diagonal. In
each component we have simply ∇ (cid:39) π∗(∇ab), and we can construct a basis of ﬂat sections
s = (s1, s2, . . . , sK) solving ∇s = 0. The transition function between two components
separated by an ij-wall w ⊂ W is given by

Tij = 1 + Xγij ,

(3.4)
where Xγ denotes the parallel transport of ∇ab along the path γ. The path γij appearing
in (3.4) is a detour along the ij-wall w, that is a path that starts at the lift z(i) to sheet i
of a point z on w (any point), circles the branch point at the origin of w, and comes back
to the lift z(j) on sheet j (ﬁgure 3). As described in section 2.2, detours correspond to BPS
solitons (ﬁgure 1). The bundle E is obtained by gluing together the restrictions of E(cid:48) to
the components of C(cid:48)\W with the transformations Tij along the walls of W.

We can be more explicit by choosing arbitrary ﬂat sections sA
k ∈ LB

k in a component A
and sB
k in a component B, with k = 1, . . . , K. The transition function (3.4) relates
these sections at any point z on the ij-wall w. We note ﬁrst that when k (cid:54)= i we simply
have sB

k . In contrast, when k = i we have

k = sA

k ∈ LA

Given that sA

i Xγij ∈ LA

j , there must be a constant κ such that

sB
i = sA

i + sA

i Xγij .

i Xγij = κsA
sA

j

.

The transformation Tij thus corresponds to an upper-triangular matrix:





sA
1
...
sA
i
sA
j
...
sA
K

Tij
(cid:55)→

 =





sB
1
...
sB
i
sB
j
...
sB
K

 .





sA
1
...
sA
i
sA
j
...
sA
K

1

. . .

1 κ
0 1

. . .

1

(3.5)

(3.6)

(3.7)

This matrix can be expressed compactly as

Tij = ϕi ·

(cid:32)

(cid:33)

1 κ
0 1

,

(3.8)

where ϕi : SL(2, C) → GL(K, C) is the canonical embedding corresponding to the ith root.

– 11 –

Nonabelianization actually produces a bit of extra structure around the punctures. In
the simplest case of a puncture with walls of all possible types, the total gluing transfor-
mation is upper triangular, and thus preserves the subspaces

F i =

Lj ,

(3.9)

for i = 0, 1, . . . , K. This structure can be expressed as a ∇-invariant ﬂag:

j>i

0 = F K ⊂ F K−1 ⊂ F K−2 ⊂ ··· ⊂ F 0 = E ,

(3.10)
where F i has dimension K − i. This implies that ∇ is a framed ﬂat GL(K, C)-connection
on C.

We remark that in physical applications of spectral networks the relevant ﬂat connec-
tions are in SL(K, C) rather than GL(K, C) (slightly oversimplifying, see [7]). Moreover,
in [7, 12] the ﬂat connections are actually twisted, in the sense that they live in the unit tan-
gent bundle over C, such that the holonomy around each S1 ﬁber is −1. We will not address
these subtleties in this paper, and content ourselves with ﬂat P GL(K, C)-connections.

3.2 Coordinates on moduli spaces of ﬂat connections

Nonabelianization provides a map between the moduli space of ﬂat abelian connections
∇ab on Σ and the moduli space of framed ﬂat GL(K, C)-connections ∇ on C:

ΨW : M(Σ, GL(1, C)) → MF (C, GL(K, C)) .

(3.11)
In the case of a Riemann surface C of genus g with n punctures and no boundary, the moduli
space MF (C, GL(K, C)) can be represented as the space of GL(K, C)-matrices A1, . . . , Ag,
B1, . . . , Bg, and M1, . . . , Mn, subject to the relation

(cid:77)

g(cid:89)

n(cid:89)

AaBaA−1

a B−1

a =

Mb ,

(3.12)

and considered up to overall conjugation. The holonomies Mb around the punctures of C
have ﬁxed eigenvalues. We then get

a=1

b=1

dimM(C, GL(K, C)) = (2g + n)K2 − 2(K2 − 1) − nK .

On the other hand, the Riemann-Hurwitz formula gives

dimM(Σ, GL(1, C)) = 2gΣ = (2g − 2)K + B + 2 ,

(3.13)

(3.14)

where B is the number of branch points (assumed to be simple). The dimensions of these
two moduli spaces match when

B = (2g + n − 2)K(K − 1) ,

(3.15)

in which case the nonabelianization map ΨW is one-to-one and can be understood as
providing coordinate systems on MF (C, GL(K, C)). Condition (3.15) does hold for the

– 12 –

spectral curves (2.1) in theories of class S. In particular, the spectral curves associated
with ideal triangulations in section 2.3 have 1
2(2g + n − 2) triangles.

2 K(K − 1) branch points in each of their
Coordinates on MF (C, GL(K, C)) are given by holonomies of the ﬂat abelian connec-

tion ∇ab = Ψ−1W (∇):

Xγ = Holγ∇ab ,

(3.16)
where γ runs over a basis of H1(Σ(cid:48); Z) (see [35] for a discussion of the abelianization map
Ψ−1W for SL(2, C)). These coordinates only dependent on the homotopy class of γ. However,
as mentioned in section 3.1, the ﬂat abelian connection ∇ab cannot be extended smoothly
across the branch points. Instead, ∇ab picks up a minus sign as it moves through a branch
point on Σ (such a connection was called “almost-ﬂat” in [35]):

(3.17)
for paths γ and γ(cid:48) on diﬀerent sides of a branch point. The Poisson bracket is expressed
in terms of the intersection pairing (cid:104)·,·(cid:105) on H1(Σ(cid:48); Z):

Xγ = −Xγ(cid:48)

{Xγ1,Xγ2} = (cid:104)γ1, γ2(cid:105)Xγ1γ2 .

(3.18)
The Xγ consist of Darboux coordinates on the symplectic leaves of the moduli space to-
gether with central elements of the Poisson algebra.
The coordinates Xγ can be naturally quantized to noncommutative variables ˆXγ obey-

ing the relation

ˆXγ1

ˆXγ2 = q(cid:104)γ1,γ2(cid:105) ˆXγ1γ2 .

(3.19)

This means that a right-handed intersection corresponds to a factor of q, and a left-handed
one to q−1 (ﬁgure 4).

Figure 4. A right- or left-handed intersection corresponds to q or q−1.

This can be thought of as a manifestation of the abelian skein relations. A right- or
left-intersections is simply resolved into non-intersecting paths with a coeﬃcient of q or
q−1, while a contractible loop can be deleted (ﬁgure 5).

Figure 5. Abelian skein relations.

– 13 –

In analogy with (3.17), we impose that the noncommutative variables associated with

paths γ and γ(cid:48) on diﬀerent sides of a branch point on Σ (ﬁgure 6) are related by

ˆXγ = −q ˆXγ(cid:48) .

(3.20)
When drawn on C, the paths γ and γ(cid:48) diﬀer by a loop around the branch point (ﬁgure 7).
This reﬂects the fact that ∇ab has non-trivial monodromies around the branch points.
We will see in section 4.2 that the condition (3.20) leads to homotopy invariance of the
quantum parallel transport.

Figure 6. The noncommutative variable ˆXγ picks up a factor of −q when γ is moved across a
branch point on Σ.

Figure 7. When drawn on C, the move of ﬁgure 6 looks like looping or unlooping a path around
a branch point.

3.3 Relation to Fock-Goncharov coordinates
Fock and Goncharov deﬁned useful systems of coordinates for MF (C, GL(K, C)) associated
with ideal triangulations of C [9]. Each ideal triangle is itself decomposed into K2 small
triangles, which produces a so-called K-triangulation (ﬁgure 8). The Fock-Goncharov
coordinates xα are associated with the vertices of these small triangles (excluding the
2 (K−1)(K−2) coordinates
punctures of C). There are K−1 coordinates on each edge, and 1
inside each face.

The Poisson structure is encoded in a system of oriented arrows on the edges of the

small triangles of the K-triangulation:

{xα, xβ} = εαβxαxβ ,

(3.21)

with

εαβ = #(arrows from xα to xβ) − #(arrows from xβ to xα) .

(3.22)

The xα can be naturally quantized to noncommutative variables ˆxα satisfying

ˆxα ˆxβ = q2εαβ ˆxβ ˆxα .

(3.23)

– 14 –

Figure 8. K-triangulation of an ideal triangle into K 2 small black and white triangles (here for
K = 4). The Poisson structure ε is encoded in the arrows circulating clockwise around the small
black triangles.

The logarithmic coordinates Xα deﬁned via xα = exp Xα quantize to noncommutative
variables ˆXα satisfying

[ ˆXα, ˆXβ] = 2{Xα, Xβ} = 2εαβ ,

(3.24)

where q = exp .

The Fock-Goncharov coordinates xα can be identiﬁed with the coordinates Xγ provided
by nonabelianization, for certain choices of paths γ [7, 35]. A Fock-Goncharov coordinate x
on an edge of an ideal triangulation of C is a cross-ratio constructed from a quadruplet
of vectors coming from the four ﬂags at the vertices of the quadrilateral containing the
edge. It coincides with the abelian parallel transport along a loop γx surrounding a pair of
branch points, one on each side of the edge (ﬁgure 9):

Xγx = x .

(3.25)

Similarly, a Fock-Goncharov coordinate inside the face of a triangle is a triple ratio and
corresponds to a loop surrounding three branch points. The intersection matrix of all these
loops reproduces the Poisson tensor ε in (3.22).

4 Quantum parallel transport
Spectral networks provide a construction of the parallel transport F (℘) of the GL(K, C)-
connection ∇ along an open path ℘ on C in terms of abelian holonomies on the cover Σ [12].
It is invariant under homotopy of ℘ and relates naturally to Fock and Goncharov’s snake
matrices. The corresponding quantum parallel transport F (℘; q) was studied in [10].

4.1 Detours
The parallel transport of ∇ along an open path ℘ from z1 to z2 on C is deﬁned as a sum
over certain paths γ from z(i)
1

2 on Σ, for all sheets i and j:

to z(j)

F (℘) =

Ω(℘, γ)Xγ .

(4.1)

(cid:88)

γ

– 15 –

Figure 9. Edge coordinates correspond to loops around pairs of branch points, face coordinates to
loops around triplets of branch points (here for K = 4).

Here Xγ denotes the parallel transport of ∇ab = Ψ−1W (∇) along γ as in (3.16), and the
coeﬃcients Ω(℘, γ) are the framed BPS indices. The paths γ are lifts of ℘ to Σ that can
take all possible detours along walls of W that ℘ intersects. We have indeed seen that ∇
is obtained by gluing along the walls of W with the transition functions (3.4). For a path
℘ that intersects a single ij-wall, at which point it splits as ℘ = ℘1℘2, we can thus write

K(cid:88)

k=1

F (℘) =

X℘(k) + X

℘(i)
1

XγijX

,

℘(j)

2

(4.2)

1 γij℘(j)

where ℘(k) is the lift of ℘ to sheet k of Σ. The second term in (4.2) involves the concatenated
path ℘(i)
2 , that is the lift of ℘1 to sheet i, followed by a detour γij around the branch
point at the origin of the wall, and completed by the lift of ℘2 to sheet j. As mentioned in
section 2.2, the detour γij corresponds to a BPS soliton interpolating between two vacua
of a surface defect Sz. For the case of a path ℘ on C that intersects W multiple times,
F (℘) is deﬁned by breaking it into subpaths that intersect W once, and repeatedly using
the composition property

F (℘1℘2) = F (℘1)F (℘2) .

(4.3)

(cid:88)

This gives a concrete recipe for computing F (℘).

The quantum parallel transport is deﬁned by promoting the Xγ to the noncommutative

variables ˆXγ:

F (℘; q) =

Ω(℘, γ; q) ˆXγ ,

(4.4)

where the coeﬃcients Ω(℘, γ; q) are the framed protected spin characters (1.2) (this agrees
with the generating function (1.3)). It can again be computed by applying the detour rule

γ

– 16 –

Figure 10. Left: Paths ℘ and ℘(cid:48) on C related by a homotopy through an ij-wall. Right: Lifted
paths γ(cid:48)
2 has a
right-handed self-intersection.

2 on Σ, with detours around the branch point of type (ij). Note that γ(cid:48)

1 and γ(cid:48)

at each intersection with a wall of W:

K(cid:88)

k=1

F (℘; q) =

ˆX℘(k) + ˆX

℘(i)
1

ˆXγij

ˆX
℘(j)

2

.

(4.5)

Recall that the ˆXγ satisfy (3.19), which corresponds to the abelian skein relations of ﬁgure 5,
and that moving γ across a branch point produces a factor of −q, as in (3.20) (ﬁgures 7).

4.2 Homotopy invariance

An important property of the quantum parallel transport F (℘; q) is that it is invariant
under homotopy of ℘ on C, as we will now show (following [10, 12]). For any two paths ℘
and ℘(cid:48) related by homotopy we should have

(4.6)
Let us consider the case where ℘ and ℘(cid:48) are related by a homotopy through an ij-wall

F (℘; q) = F (℘(cid:48); q) .

(ﬁgure 10). The path ℘ does not cross any wall and we just have

K(cid:88)

k=1

K(cid:88)

F (℘; q) =

ˆX℘(k) .

(4.7)

On the other hand, the path ℘(cid:48) crosses the wall twice, say at z1 and z2, so the parallel
transport involves paths with a detour starting on sheet i and ending on sheet j:

F (℘(cid:48); q) =

ˆX℘(cid:48)(k) + ˆXγ(cid:48)

1

+ ˆXγ(cid:48)

2

,

(4.8)

k=1
(cid:48)(i)
(cid:48)(j)
1 γij(z1)℘
2

and γ(cid:48)

2 = ˜℘

1 = ℘

(cid:48)(i)
(cid:48)(j)
1 ˜γij(z2) ˜℘
2

where the detoured paths are γ(cid:48)
. The ﬁrst
term matches F (℘; q) since the abelian parallel transports Xγ and their quantizations ˆXγ
only depend on the homotopy class of γ. Homotopy invariance of F (℘; q) therefore requires
that the contributions from the two paths γ(cid:48)
2 cancel each other. To see this, we
ﬁrst apply the abelian skein relation to resolve the intersection of γ(cid:48)
2, which produces a
factor of q (ﬁgure 11). We obtain a contractible loop and a path that circles the branch
point counter-clockwise, which by the rule of ﬁgure 7 can be replaced by a straight path
homotopic to γ(cid:48)

1 with a factor of −q−1. The factors combine to give

1 and γ(cid:48)

ˆXγ(cid:48)

2

= − ˆXγ(cid:48)

1

,

– 17 –

(4.9)

Figure 11. The contributions from γ(cid:48)
applying the abelian skein relations and moving across the branch point.

1 and γ(cid:48)

2 on the right of ﬁgure 10 cancel each other upon

so that the homotopy invariance (4.6) indeed holds.

Another interesting case is when ℘ and ℘(cid:48) diﬀer by a homotopy across a branch point
(ﬁgure 12). In fact, it was the raison d’ˆetre of the gluing with detour (3.4) to ensure that
the connection ∇ extends smoothly across branch points. We again ﬁnd that a pair of
undesired paths γ(cid:48)
2 lifted from ℘(cid:48) cancel out via a combination of factors q−1 and
−q coming from a self-intersection and a loop around the branch point.

1 and γ(cid:48)

Figure 12. Left: Paths ℘ and ℘(cid:48) related by a homotopy across a branch point. Right: Lifted paths
1 and γ(cid:48)
γ(cid:48)

2 that cancel each other.

It is straightforward to see that a homotopy across a joint where two walls intersect

also leave the quantum parallel transport F (℘; q) invariant.

4.3 Relation to snake matrices

We now relate the parallel transport across walls, edges, cables, or branch cuts to the
snake matrices used by Fock and Goncharov to construct P GL(K, C) holonomies on a
triangulated surface C [9]. The general procedure to obtain the holonomy for a curve ℘ is
to decompose it into elementary matrices of two types corresponding to step-wise moves of
a snake, that is an oriented path in a triangle from a vertex to the opposite edge, through
small triangles of the (K − 1)-triangulation.

Across walls: The ﬁrst elementary snake matrix corresponds to moving through a small
black triangle clockwise and takes the form

Fi = ϕi

.

(4.10)

This agrees with the transition function (3.8) across an ij-wall, provided that we ﬁx the rel-
ative normalizations of sA
j in (3.6) such that κ = 1. The inverse of Fi, corresponding
to moving counter-clockwise, is

i and sA

(cid:33)

1 1
0 1

(cid:32)

(cid:32)

– 18 –

(cid:33)

1 −1
0 1

F −1
i = ϕi

,

(4.11)

and requires setting κ = −1. This is summarized graphically in ﬁgure 13.

Figure 13. Paths with detour along an ij-wall, corresponding to the oﬀ-diagonal components ±1
in the elementary snake matrices Fi and F −1

.

i

Across edges: The second elementary snake matrix is a diagonal matrix depending on
a coordinate x:

Hi(x) = diag(1,··· , 1

, x,··· , x) .

(cid:124) (cid:123)(cid:122) (cid:125)

i times

(4.12)

(4.13)

This matrix appears in particular when a snake moves across an edge of the triangula-
tion. For an edge with coordinates {x1, x2, . . . , xK−1}, in this order along the snake, the
transformation is given by

ME(x1, x2, . . . , xK−1) = H1(x1)H2(x2)··· HK−1(xK−1)

1



=

x1

x1x2

. . .

x1x2 ··· xK−1

 .

To understand how this relates to the parallel transport F (℘), recall that in each
component of C\W we are free to make a diagonal gauge transformation on the ﬂat sections.
Let us consider a component that contains an edge of the triangulation, and divide it along
the edge into two regions C and D. We apply a diagonal gauge transformation such that
the ﬂat sections in region D are proportional to the ones in region C:

sD
i = αisC
i

.

(4.14)

We are going to show that the αi are indeed products of Fock-Goncharov coordinates along
the edge, as in (4.13). We focus on the case K = 3 and compare parallel transports along
paths from sheet 1 in region A to sheet 2 in region F (ﬁgure 14). There are two such paths
with a detour along a 12-wall, one between regions A and B, and the other between regions
E and F . We know from (3.6) with κ = 1 that across these walls we have

1 XγAB
sA

12

= sB

2 ,

1 XγEF
sE

12

= sF

2 .

(4.15)

Completing these relations to parallel transports from region A to region F we obtain

α1sA

1 XγEF

12

= sF

2 ,

(4.16)

1 XγAB
sA

12

= α−1

2 sF

2 ,

– 19 –

Figure 14. The diagonal transition matrix across an edge of the triangulation can be determined
by comparing various parallel transports with detours (branch cuts and irrelevant parts of the
spectral network are omitted).

where α1 and α2 appeared when crossing the edge on sheet 1 and 2. We then ﬁnd

α2
α1

=

XγEF
12XγAB

12

= XγEF

12 (γAB

12 )−1 = x1 .

(4.17)

12 )−1 is homotopic to the loop γx1
In the last equality we used the fact that the path γEF
that corresponds to the edge coordinate x1 (section 3.3). A similar calculation comparing
paths from sheet 2 in A to sheet 3 in F gives

12 (γAB

Setting α1 = 1, we conclude that the transformation across the edge takes the form

α3
α2

= XγDE

23 (γBC

23 )−1 = x2 .

1

 ,

T (x1, x2) =

x1

x1x2

in agreement with the snake matrix (4.13) for K = 3.

In general, a path on sheet i that crosses an edge with coordinates {x1, x2, . . . , xK−1}
(in this order) picks up the ith eigenvalue of the matrix (4.13) (ﬁgure 15). This matrix is
deﬁned close to the extremity of the edge near x1, and crossing branch cuts will of course
permute its eigenvalues. Moving the path from one extremity of the edge to the other
extremity exchanges all the eigenvalues, which in P GL(K, C) is the same as taking the
inverse:

(4.18)

(4.19)

(4.20)

M−1
E (x1, x2, . . . , xK−1) (cid:39)

x1x2 ··· xK−1



 .

. . .

x1x2

x1

1

– 20 –

Figure 15. A path on sheet i that crosses an edge with coordinates {x1, . . . , xK−1} picks up the
product x1x2 ··· xi.

Across cables: An important transformation consists of moving a snake through a face
of a triangle, from one edge to next. For a clockwise rotation, the corresponding snake
matrix for K = 3 is

with x the face coordinate, while for a counter-clockwise rotation it is

 ,

0 1 1 + x
0 0

x

1

1 1
x −x
 (cid:39)

x

0 x −1 − x
0 0

1

 .

MF (x) = F2F1H2(x)F2 =

1 −1

1

0 1 −1 − x−1
0 0

x−1

M−1

F (x) =

(4.21)

(4.22)

Figure 16. Parallel transport across the three walls of a cable for K = 3.

We will now show how to match MF (x) with the transformation for crossing the three
walls of a cable (see section 6 in [13]).
It is already clear from our previous discussion
that the snake matrices F2 in (4.21) correspond to the transformations across the 23-walls
between regions A and B, and between regions C and D (ﬁgure 16). To describe the

– 21 –

Figure 17. The diﬀerence of the detours γ(23)
is equivalent, upon moving the segment
on sheet 3 through the top branch point of type (12) and using the relations in ﬁgure 7, to the path
γx corresponding to the face coordinate x.

and γ(23)

ab

cd

parallel transport from region B to region C across the 12-wall, we deﬁne the following
reference ﬂat sections at the point c:

sC
i (c) = sB
sC
3 (c) = αsB

i (b)X
γ(i)
bc
3 (b)X

γ(3)
bc

,

i = 1, 2 ,

,

(4.23)

where X
bc from b to c on sheet i. The
nonabelian parallel transport along a path ℘bc on C from b to c is performed with (4.1):

is the abelian parallel transport along the path γ(i)

γ(i)
bc

The detour rule (4.2) gives

sB
i (c) = sB

i (b)F (℘bc) .

1 (c) = sB
sB
sB
2 (c) = sB
sB
3 (c) = sB

1 (b)X
2 (b)X
3 (b)X
1 (b)X

γ(1)
bc

γ(2)
bc

γ(3)
bc

 =

sC

1
sC
2
sC
3

γ(12)
bc

1 1 0

0 1 0
0 0 α



sB

1
sB
2
sB
3

+ sB

1 (b)X

γ(12)
bc

,

.
= −sB

 = F1H2(α)

 .

sB

1
sB
2
sB
3

,

(4.24)

(4.25)

(4.26)

Comparing with (4.23) and setting sB

2 (c), we arrive at the transformation

cd . We ﬁnd
2 (a)X

αsA

= sA

2 (a)X

To determine α we compare the abelian parallel transports along two paths from a to d
with a detour γ(23)

or γ(23)

ab

(4.27)
ab )−1 (ﬁg-
Thus α corresponds to the abelian parallel transport along the path γ(23)
ure 17). This path is equivalent (for q = 1) to the closed cycle γx on Σ used in section 3.3
to deﬁne the face coordinate x, so we ﬁnally obtain the desired result

cd (γ(23)

γ(23)
ab γ(3)

γ(2)
ac γ(23)

cd

bd

.

α = Xγx = x .

(4.28)

A mnemonic for the way a path picks up face coordinates as it crosses a wall is given

in ﬁgure 18.

– 22 –

Figure 18. A path on sheet k crossing an ij-wall picks up the associated face coordinate x when
k > j or k ≤ j, depending on whether it rotates clockwise or counter-clockwise around the puncture.

Across branch cuts: The transformation that reverses the orientation of a snake along
an edge is given by an anti-diagonal matrix of alternating ±1:



S =

 .

··· 0 0 1
··· 0 −1 0
··· 1 0 0
...
. . .

...

...

(4.29)

Note that we have S2 = (−1)K−1.

This corresponds to crossing all the branch cuts along an edge. We reproduce the
snake matrix (4.29) by adopting the convention that crossing a branch cut of type (i, i± 1)
clockwise around its branch point produces a factor of ±1, and counter-clockwise a factor
of ∓1 (ﬁgure 19). This guarantees the invariance of parallel transport under a homotopy
through a branch cut (ﬁgure 20).

Figure 19. Crossing branch cuts for K = 2 and K = 3 and the associated snake matrices S. For
the reverse direction the signs are opposite.

Figure 20. Homotopy through a branch cut.

This convention is consistent with the signs of the oﬀ-diagonal entries in the transforma-
tions (4.10) and (4.11), since they correspond respectively to detours that circle clockwise
and counter-clockwise around a branch point.
It is also consistent with the minus sign
in (3.17) that appears when moving through a branch point.

– 23 –

5 Quantum dimension

In the previous section we have seen how to construct the quantum parallel transport
F (℘; q) along any open path ℘ on C. We want to complete this construction to obtain the
quantum holonomy Tr Holq
℘ along any closed path ℘. In this section we explain how this
requires the introduction of a third dimension to keep track of quantum ordering. Isotopy
invariance in three dimensions can then be implemented with the use of quantum group
matrices.

5.1 Elevation

Naively, we could view a closed path ℘ as an open path whose endpoints happen to coincide,
z1 = z2 = z, and compute the parallel transport as before. The problem is that the result
would then depend on the choice of basepoint z. We have indeed seen in section 3.2 that a
left-handed crossing on Σ contributes a factor of q while a right-handed crossing contributes
a factor of q−1. The handedness is determined by considering that the segment on top is
the one with the largest value of the parameter t ∈ [0, 1] along the path. However, as we
move the starting point t = 0 through a self-intersection, its handedness changes. Note
that even if ℘ itself has no self-intersection on C, a lift of ℘ to Σ can have intersecting
detours.

This issue can be resolved by thinking of the closed path ℘ on C as a knot in the

3-manifold

M3 = C × [0, 1] .

(5.1)

This idea was used by Turaev to show that the Poisson algebra generated by homotopy
classes of paths on a surface C can be quantized by the skein algebra of isotopy classes
of links in the 3-manifold M3 [16], and more recently by Bonahon and Wong to construct
the SL(2) quantum trace [11]. The ordering along the interval [0, 1] corresponds to the
quantum ordering. We require that the quantum holonomy Tr Holq
℘ be invariant under
isotopy of ℘ in M3, and so in particular under changes in the choice of basepoint (now
understood as the lowest point of the knot along [0, 1]). We will ﬁnd that the relative
elevation along [0, 1] of various parts of ℘ is controlled by matrices of the quantum group
Uq(glK), such as the R-matrix and the cup/cap matrices.

5.2 Split triangulation
The study of isotopy invariance for the quantum holonomy along a closed path ℘ in C×[0, 1]
can be reduced to a few simple conﬁgurations. The type of isotopy transformations that
we are concerned about are those that change the handedness of intersections of detoured
paths in Σ × [0, 1] (changing the handedness of a self-intersection of ℘ is not an isotopy).
Since detours can intersect only if they are in the same triangle, we may focus on isotopy
transformations taking place over a single triangle at a time. We may further focus on
changes of the relative elevation of a pair of segments of ℘ in the triangle, which can be
iterated to produce more complicated transformations involving arbitrarily many segments.

– 24 –

A useful way to organize changes of relative elevation is to require that they only take
place very close to the edges of the triangle. We can represent this nicely by considering
a split ideal triangulation, where the edges are thickened into ideal biangles. The relative
elevation of segments is then required to be ﬁxed over the triangles, and change only over
the biangles. This is inspired by the procedure of Bonahon and Wong [11].

5.3 Isotopy invariance: R-matrix

Let us consider two segments ℘1 and ℘2 that enter across the same edge of a triangle T
and exit across diﬀerent edges (the case where they exit through the same edge can be
treated similarly). We want to compare the case where the relative elevation of ℘1 and ℘2
in T × [0, 1] is everywhere the same to the case where it changes. We arrange the segments
such that the change of relative elevation takes place over the biangle of the split ideal
triangulation that corresponds to the common edge (ﬁgure 21).

Figure 21. Isotopic conﬁgurations of a pair of segments over a triangle (for K = 2). Left: The
thin blue segment ℘1 is lower along the interval [0, 1] than the thick red segment ℘2. Right: The
relative elevation of the segments changes over the biangle, as encoded by a transformation R.

This change of relative elevation is implemented by a transformation R which acts on
pairs of ﬂat sections si and sj. We determine R by requiring isotopy invariance of the
quantum holonomy Tr Holq
℘1,℘2. We ﬁnd that R acts essentially as the identity, apart from
an oﬀ-diagonal term that exchanges si and sj for i < j:

(cid:40)

R(si ⊗ sj) =

si ⊗ sj + (q−1 − q)sj ⊗ si
si ⊗ sj

i < j ,
i ≥ j ,

(5.2)

(of course, if we move the paths through the branch cut then the oﬀ-diagonal term is for
i > j). The role of the oﬀ-diagonal component R21
12 is merely to correct the change of the
handedness of the intersection of the detoured lifts of ℘1 and ℘2 (ﬁgure 22).

Correcting the elevation in the other direction (had we started with the other relative
elevation on the common edge) corresponds to the inverse transformation R−1, which

– 25 –

Figure 22. A relation required by isotopy invariance of Tr Holq
℘1 and ℘2. The oﬀ-diagonal component R21
intersections.

involving lifts of the segments
12 corrects the mismatch in the handedness of the detour

℘1,℘2

simply amounts to inverting q:

R−1(si ⊗ sj) =

(cid:40)

si ⊗ sj + (q − q−1)sj ⊗ si
si ⊗ sj

i < j ,
i ≥ j .

(5.3)

The transformation R looks similar to the ˆR-matrix of the quantum group Uq(glK),

which acts as (we omit an overall factor of q1/K)

 sj ⊗ si + (q−1 − q)si ⊗ sj

q−1sj ⊗ si
sj ⊗ si

ˆR(si ⊗ sj) =

i < j ,
i = j ,
i > j .

(5.4)

We can obtain a perfect match by considering a change of elevation that also crosses the
segments (ﬁgure 23). The segments cross again inside the triangle (without changing the
relative elevation), which produces a factor of q−1 via the abelian skein relation (ﬁgure 5)
when the lifted segments are on the same sheet. Isotopy invariance then imposes that the
transformation for a left-handed crossing with a change of relative elevation is precisely

Figure 23. The transformation corresponding to a crossing with a change of elevation is the
ˆR-matrix of Uq(glK) (here for K = 2).

– 26 –

the ˆR-matrix:

=

= ˆR(si ⊗ sj) .

(5.5)

A right-handed crossing corresponds to the inverse of the ˆR-matrix (obtained from ˆR by
inverting q):

=

= ˆR−1(si ⊗ sj) .

(5.6)

Although we have illustrated the calculation for K = 2, the procedure works for any
K. We show the general pattern of intersections of detours for K = 3 in ﬁgure 24, and a
sample relation imposed by isotopy invariance in ﬁgure 25.

Figure 24. Segments in the 3-fold cover Σ over a triangle and their possible detours. Intersections
are indicated.

Figure 25. A relation imposed by isotopy invariance of Tr Holq

℘1,℘2

for K = 3.

5.4

Isotopy invariance: cup/cap

We can also consider the case where two segments in a triangle are connected in a biangle.
We want to compare such a path ℘ that exits the triangle higher than it enters it, and a
path ℘(cid:48) that exits lower than it enters. Given the interpretation of the elevation as the

– 27 –

parameter t ∈ [0, 1] along a path, ℘ goes up naturally, and we can in fact use the homotopy
invariance of section 4.2 (as in ﬁgure 12) to deform it to a path going from one edge to
the next directly (ﬁgure 26). In contrast, ℘(cid:48) requires a correction that lowers its second
half compared to its ﬁrst half. We therefore apply a transformation Cij over the biangle
to correct the relative elevation of the two halves. We can determine Cij by imposing that
the quantum holonomy be invariant, Tr Holq
℘(cid:48). The paths shown on the top right
of ﬁgure 26 imply C21 = (S−1)21. The paths on the bottom right must cancel out, which
gives C12 = q2C21.

℘ = Tr Holq

Figure 26. Left: Isotopic paths ℘ and ℘(cid:48). Right: The matrix elements Cij are determined by
requiring isotopy invariance.

We conclude that the “cup” and “cap” transformations that lower the elevation of a

path over a biangle are given by the following matrices:

(cid:32)

(cid:33)

q2 0
0 1

=

For general K we ﬁnd

(cid:33)

(cid:32)

q−2 0
0 1

=

S .

(5.7)

S−1 ,

(cid:16)
(cid:16)

= diag

= diag

(cid:17)

q2(K−1), . . . , q2, 1

S−1 ,

(cid:17)

q−2(K−1), . . . , q−2, 1

S .

(5.8)

5.5 Skein relations and junctions
Crossings corresponding to the ˆR-matrices can be expressed, via the skein relation, in terms
of networks with junctions (see [24, 26] for reviews). The ˆR-matrix for the fundamental
representation (cid:3) of Uq(glK) can indeed be decomposed as

where I is the identity operator and Q acts on a basis si ⊗ sj of (cid:3) ⊗ (cid:3) as

ˆR = q−1I + Q ,

 sj ⊗ si − qsi ⊗ sj

0
sj ⊗ si − q−1si ⊗ sj

i < j ,
i = j ,
i > j .

Q(si ⊗ sj) =

(5.9)

(5.10)

– 28 –

The operator Q can be thought of as the projection π1,1→2 : (cid:3) ⊗ (cid:3) → ∧2(cid:3) on the second-
rank antisymmetric representation, composed with the embedding ι2→1,1 : ∧2(cid:3) → (cid:3) ⊗ (cid:3):
(5.11)

Q = ι2→1,1π1,1→2 .

The projection and the embedding are deﬁned by

π1,1→2 :
ι2→1,1 :

si ⊗ sj
si ∧ sj

(cid:55)→ si ∧ sj ,
(cid:55)→ −qsi ⊗ sj + sj ⊗ si

(5.12)
where the q-deformed wedge product satisﬁes si ∧ sj = −qsj ∧ si for i < j. It follows that
we can represent the ˆR-matrix graphically as the sum of a pair of parallel segments and a
network with two junctions:

i < j ,

We have absorbed a factor of q1/K in the crossing compared to the standard form of the
skein relation.

More generally, we can consider the projection from ∧a(cid:3) ⊗ ∧b(cid:3) to ∧a+b(cid:3):
πa,b→a+b :

(si1 ∧ ··· ∧ sia) ⊗ (sj1 ∧ ··· ∧ sjb) (cid:55)→ si1 ∧ ··· ∧ sia ∧ sj1 ∧ ··· ∧ sjb ,(5.14)

(5.13)

as well as the embedding

ιa+b→a,b :

sk1 ∧ ··· ∧ ska+b

(cid:55)→ (−q)ab (cid:88)

i1<···<ia
j1<···<jb

(−q−1)n(i,j;k)(si1 ∧ ··· ∧ sia) ⊗ (sj1 ∧ ··· ∧ sjb) ,(5.15)

where the sum is over disjoint splits of the indices k1 < ··· < ka+b, and n(i, j; k) is the
minimal number of adjacent permutations to bring the sequence i1, . . . , ia, j1, . . . , jb to
k1, . . . , ka+b. This allows us to construct general networks with trivalent junctions.

An oriented path carrying some representation can be replaced with a path of reverse
orientation carrying the complex conjugate representation. Using this procedure, we can
obtain junctions with only outgoing paths (source) or with only incoming paths (sink).
Classically (for q = 1), such junctions are associated with SL(K)-invariant antisymmetric
tensors i1···iK . This means that each of the K paths that meet at a junction lifts to a
diﬀerent sheet of Σ. In the case K = 3, we can for example replace a path labeled by
s1 ∧ s2 by the reverse path labeled by s3; however s2 ∧ s1 = −q−1s1 ∧ s2 should be replaced
by −q−1s3.

6 Properties of quantum holonomies

We are now ready to summarize the construction of the quantum holonomy Tr Holq
℘. We
then discuss some of its general properties, which should be compared with the conjec-
tured properties of the related “quantum canonical map” (Conjecture 12.4 in [9] and Con-
jecture 4.8 in [21]), as well as with the positivity conjectures for framed protected spin
characters in [7].

– 29 –

6.1 Quantum holonomy
Given an oriented closed path ℘ on an ideal triangulation of a Riemann surface C, the
℘ of a ﬂat P GL(K, C)-connection along ℘ can be constructed
quantum holonomy Tr Holq
from the following steps:

• choose a basepoint of ℘ on an edge of the triangulation,
• compute the quantum parallel transport F (℘; q) along ℘ with the basepoint removed

(using the associated Fock-Goncharov spectral network),

• close ℘ at its basepoint with R-matrices of the quantum group Uq(glK).

The result does not depend on the choice of basepoint.
If ℘ crosses the edge with the
basepoint m times, the last step involves (m − 1) R-matrices (in particular, it is trivial if
℘ crosses the edge only once). The quantum holonomy then takes the form

Tr Holq

℘ =

Ω(℘, γ; q) ˆXγ .

(6.1)

(cid:88)

γ

(cid:17)

= q−(cid:80)

Each lift γ of ℘ to the K-fold branched cover Σ corresponds to a classical monomial of
the form Xγ = xa1
n , whose quantization is most cleanly expressed in terms of the
logarithmic coordinates (3.24):

ˆXγ = exp

a1 ˆX1 + ··· + an ˆXn

α<β aαεαβ aβ ˆxa1

1 ··· ˆxan
n .

(6.2)

1 ··· xan
(cid:16)

The coeﬃcient Ω(℘, γ; q) of this monomial is a polynomial in q determined by the self-
intersections of γ and the contributions from quantum R-matrices.

6.2 Left- and right-turns
We can use the homotopy invariance of the quantum holonomy to put the path ℘ on C in an
orderly position (we assume for the moment that ℘ is a simple path and discuss intersections
and junctions in section 6.6). We require that every segment of ℘ in a triangle enters across
the leftmost part of an edge, and only crosses one cable of walls. Such a segment either
turns left in the triangle, in which case it does not cross any branch cut, or turns right, in
which case it crosses two collections of branch cuts (ﬁgure 27). We also require that there
is no cup or cap along ℘.

The matrix for crossing an edge with coordinates {x1, x2, . . . , xK−1} on its leftmost part
E (x1, . . . , xK−1) given in (4.20). The cable transformation is M−1
is M−1
F for a left-turn, and
MF for a right-turn. The transformations across branch cuts for a right-turn are given by
S−1. The classical holonomy is simply obtained by taking the trace of the product of snake
matrices along ℘, which gives a Laurent polynomial in the Fock-Goncharov coordinates.

6.3 Canonical lifts

A path ℘ decomposed into left- and right-turns has K canonical lifts of ℘ to Σ, namely
the lifted paths without any detour. A canonical lift crosses all the edges on the same

– 30 –

Figure 27. Left- and right-turning segments in a triangle (for K = 3). The transformation matrices
across edges, cables, and branch cuts are indicated.

sheet. We denote by ℘(i) the lift of ℘ that crosses all the edges on sheet i. The path ℘(1)
picks up the ﬁrst eigenvalue of M−1
E on each edge. It also picks up the maximal number of
face coordinates, since it crosses cables counter-clockwise (around the punctures) on sheet
1, and clockwise on sheet K (recall the rules in ﬁgure 18). The canonical lift ℘(1) thus
corresponds to the highest term, that is the monomial with the largest exponents aα, in
the expansion (6.1). Paths ℘(i) with increasing values of i involve fewer and fewer edge
and face coordinates, up to ℘(K) which corresponds to the term ±1.

The coeﬃcient of every term ˆX℘(i) in the quantum holonomy is given by

Ω(℘, ℘(i); q) = (−1)nL ,

(6.3)

where nL is the total number of left-turns along ℘.
Indeed, powers of q come from
self-intersections or from oﬀ-diagonal components of the R-matrix. But ℘(i) has no self-
intersection, and it only involves the diagonal component Rii
ii = 1 since it always crosses
edges on sheet i. The sign is determined by the pattern of branch cuts that are crossed
by ℘. Each left-turn crosses a pair of collections of branch cuts, and given that S−2 = −1,
the total sign is given by the parity of nL.
Note that it can happen that a detoured path γ gives the same contribution as ℘(i),
that is ˆXγ = ˆX℘(i). The combined coeﬃcient can then be a polynomial in q. However, the
highest term of the quantum holonomy is exactly (−1)nL ˆX℘(1). Indeed, ℘(1) is the unique
lift of ℘ that receives a maximal contribution from edge and face coordinates, since any
detour added to ℘(i) eliminates at least one face coordinate.

This should be compared to a conjecture by Fock and Goncharov, that the highest

term xa1

1 ··· xan

n of a classical holonomy quantizes to (6.2), with unit coeﬃcient [9, 21].

6.4 Positivity

All the paths γ contributing to the quantum holonomy (6.1) can be obtained by gradually
adding detours to the canonical lifts ℘(i). Note that in order for the modiﬁed paths to
close, detours must be added in pairs. Such a pair involves a detour γij on a left-turn and
a detour γK+1−j,K+1−i on a right-turn (ﬁgure 28). The edges between these two detours

– 31 –

Figure 28. Pair of detours γij and γK+1−j,K+1−i that modiﬁes ℘(i).

are now crossed on sheet j instead of sheet i, so the resulting monomial is a hybrid of the
canonical lifts ℘(i) and ℘(j). The collections of branch cuts between the two detours now
contribute an opposite sign (because in our conventions j = i + 1), and given that there is
an odd number of them, the total contribution is a minus sign. Another minus sign comes
from the detour on the left-turn (recall ﬁgure 13). These two signs cancel each other and
the overall sign of the new monomial is the same as for the original monomial. By recursion,
this implies that all monomials associated with detoured paths have the same sign (−1)nL,
as in (6.3). For paths with intersecting detours, the coeﬃcient of each monomial can be
a power of q. There can be diﬀerent paths leading to the same monomial, in which case
their coeﬃcients combine to produce a polynomial in q. Remark that the negative term
in the oﬀ-diagonal component (q−1 − q) of the R-matrix always cancels out against some
unwanted factors of q that can appear when shifting the basepoint.

We therefore conclude that all the coeﬃcients of the quantum holonomy are positive

Laurent polynomials in q:

Ω(℘, γ; q) ∈ Z>0[q, q−1]

(6.4)

(for nL even, otherwise they are all negative). This is in agreement with the “weak positivity
conjecture” of [7] and the conjectured positivity of the quantum canonical map in [9].

6.5

Invariance under inversion of q

Let us examine more closely the patterns in which powers of q appear in the coeﬃcients
Ω(℘, γ; q). We assume for simplicity that there is a choice of basepoint on ℘ such that
no R-matrix is required. This implies that all the powers of q come from intersections of
detours in the lifts of ℘ to Σ. The basic contribution is a factor of q coming from a right-
handed intersection of two detours along two segments of a lift γ in a triangle T . These
two segments cross (at least) one common edge, and hence share another triangle T (cid:48). Then
there is another lift γ(cid:48) of ℘ which gives the same monomial Xγ(cid:48) = Xγ, but has a left-handed
intersection of detours in T (cid:48) instead of a right-handed intersection in T (ﬁgure 29). The
segments of γ cross the common edge on sheets j and i, while the segments of γ(cid:48) cross it
on sheets i and j, so the contribution of the edge coordinates is the same in both cases.

– 32 –

The total contribution of these two paths to the coeﬃcient Ω(℘, γ; q) is q + q−1. The case
where the two segments turn in the same direction is shown in ﬁgure 30.

Figure 29. Parts of paths γ and γ(cid:48) with Xγ = Xγ(cid:48) but with diﬀerent self-intersections (the paths
γ and γ(cid:48) are identical away from the two triangles T and T (cid:48)).

Figure 30. Same phenomenon as in ﬁgure 29 but for segments turning in the same direction.

More complicated paths may have many detours and contribute higher powers of q,
but the essential phenomenon stays the same. An edge that is crossed by multiple segments
of ℘ gives rise to a family of lifted paths with detours contributing the same monomial to
the quantum holonomy. These lifted paths diﬀer by a choice of sheet for each segment
as it crosses the edge, such that there is always the same number of paths on each sheet.
Each path with intersections is accompanied by a path with intersections of the reverse
handedness (the detours are reﬂected over the edge). This implies that the quantum
holonomy is invariant under q → q−1:

Ω(℘, γ; q) = Ω(℘, γ; q−1) .

(6.5)

This lends partial support to the “strong positivity conjecture” in [7], according to which
the framed protected spin characters are linear combination of su(2) characters χn(q) with
nonnegative integral coeﬃcients. This is also related to the “self-duality” property of [9, 21].

– 33 –

6.6 Self-intersections and junctions
So far in this section we have assumed that the path ℘ on C had neither self-intersection nor
junction. If ℘ has a self-intersection, there are additional powers of q for the lifts of ℘ such
that the two segments at the self-intersection are on the same sheet. The coeﬃcients (6.3)
of the canonical lifts thus become

Ω(℘, ℘(i); q) = (−1)nLqw ,

(6.6)

for some integer w. The positivity of the quantum holonomy is not aﬀected by self-
intersections.

However, the invariance under inversion of q does not hold anymore for paths ℘ with
self-intersections, since some powers of q are shifted. One way to restore this invariance is
to apply skein relations such as (5.13) to trade paths with self-intersections for networks
with junctions (and simple paths). The ﬁrst term on the right-hand side of (5.13) accounts
for all the lifts of ℘ such that the self-intersection on C lifts to a self-intersection on some
sheet of Σ. This is equivalent, up to the overall factor of q−1, to a simple path without self-
intersection. The second term in (5.13) corresponds to lifts of ℘ such that the two segments
at the self-intersection are on diﬀerent sheets. Since these lifts do not self-intersect, the
factors of q−1 that ruin the invariance under q → q−1 are absent. This second term is
represented by a pair of junctions.

One might worry that the various minus signs that appear in the deﬁnition of junctions,
as in (5.15), could spoil the positivity of the quantum holonomy for a network. Fortunately
this is not the case, as we can see by rewriting the skein relation (5.13) as

(6.7)

and noting that although the right-hand side is the diﬀerence of two positive polynomi-
als, the second term is fully canceled by the ﬁrst term, leaving a positive polynomial. In
summary, for networks with junctions, both the positivity property (6.4) and the invari-
ance (6.5) under inversion of q hold.

7 Examples

We illustrate our construction by computing non-trivial framed protected spin characters
associated with a line defect on the punctured torus for K = 2, and with a pants network
on a three-punctured sphere for K = 3.

7.1 Punctured torus
For our ﬁrst example, we take C to be the torus with one puncture and set K = 2 (ﬁgure 31).
This corresponds to the so-called N = 2∗ SU (2) theory, obtained from a mass deformation
of N = 4 super Yang-Mills theory. The classical P GL(2, C) holonomy along a path ℘

– 34 –

that wraps once around the A-cycle and once around the B-cycle decomposes in terms of
Fock-Goncharov coordinates a, b, c on the edges of the triangulation as

trAB−1 = 1 + a + 2ab + ab2 + ab2c .

(7.1)

While the unit framed BPS indices are expected to give unit protected spin characters
(because of the invariance (6.5) under inversion of q), the coeﬃcient of 2 should quantize
in an interesting way.

Figure 31. Left: Torus with one puncture. The path ℘ goes once around the A-cycle and once
around the B-cycle. Right: triangulation and spectral network for K = 2. There are three Fock-
Goncharov coordinates a, b, c on the edges (the top and bottom edges are identiﬁed, as are the
left and right edges). Transformations across the walls of the spectral network, the edges, and the
branch cuts are indicated.

To compute the corresponding quantum holonomy, we choose a basepoint and control
the elevation with R-matrices in order to close the path in C × [0, 1]. Let us take the
basepoint on the a-edge, and always move up as we go along ℘. As we come back to
the a-edge, we can close the path by correcting the elevation with the R-matrix (5.2),
which in this trivial case is just the identity. We then consider all the possible lifted
paths with detours on the 2-fold cover Σ of the punctured torus (ﬁgure 32). The paths
without any detour match the lowest and highest terms 1 and e ˆA+2 ˆB+ ˆC. There are two
paths with detours that have self-intersections, one left-handed and the other right-handed.
Together they contribute (q + q−1)e ˆA+ ˆB to the quantum holonomy. The framed BPS index
Ω(℘, γ) = 2 is thus quantized to the framed protected spin character Ω(℘, γ; q) = q + q−1.
How does the computation change if we decide to put the basepoint on the b-edge?
In order to close the path on the b-edge, we need to change the relative elevation of the
two segments crossing it by inserting an R-matrix. The oﬀ-diagonal component R21
12 then
allows for a new path contributing (q−1 − q)e ˆA+ ˆB to the quantum holonomy (ﬁgure 33).
On the other hand, the two paths with self-intersections now contribute 2qe ˆA+ ˆB. Their
combination again gives the correct result.

– 35 –

Figure 32. Paths with detours contributing to the quantum holonomy along ℘ with basepoint on
the a-edge (for clarity, the spectral network is omitted).

Figure 33. Path contributing to the quantum holonomy when the basepoint is on the b-edge. The
change of relative elevation needed to close the path is implemented by the quantum R-matrix,
which has an oﬀ-diagonal component R21
12.

7.2 Three-punctured sphere

Another important example is the three-punctured sphere, also known as the pair of pants.
It corresponds to the theories TK, which can be used as fundamental building blocks for
general theories of class S [2]. Any simple closed curve on the three-punctured sphere is
homotopic to a loop surrounding a single puncture. However, for K = 3 we can con-
sider a pants network with two junctions [26], which can be thought of as arising from
the resolution via the skein relation (5.13) of a self-intersecting ﬁgure-8 loop around two
punctures (ﬁgure 34 left). Using the fact that we can reverse the direction of an arrow if we
simultaneously replace the representation it carries by its conjugate, we replace the small
segment between the junctions with the representation ∧2(cid:3) by a reverse segment with the
representation (cid:3).

– 36 –

Figure 34. Left: Pants network with two junctions on the three-punctured sphere. The relevant
edge and face matrices are indicated. Right: The two lifts of the pants network to Σ that contribute
to the framed protected spin character Ω(℘, γ; q) = q + q−1.

The classical holonomy for this network has one term with a coeﬃcient of 2. This term
corresponds to the two lifted networks with detours shown on the right of ﬁgure 34. Given
that their self-intersections have opposite handedness, we ﬁnd the framed protected spin
character Ω(℘, γ; q) = q + q−1, in agreement with [26].

Acknowledgments

It is a great pleasure to thank Dylan Allegretti, Francis Bonahon, Christopher Beem,
Clay C´ordova, Tudor Dimofte, Dmitry Galakhov, Mauricio Romo, and Andrew Neitzke for
enlightening discussions. I am very grateful to the organizers of the conference Curve 2015
at the Institut Math´ematiques de Jussieu, where the idea of this paper emerged. This work
was supported by the Swiss National Science Foundation (project P300P2-158440).

References

[1] D. Gaiotto, G. W. Moore, and A. Neitzke, Wall-crossing, Hitchin systems, and the WKB

approximation, Adv. Math. 234 (2013) 239–403.

[2] D. Gaiotto, N =2 dualities, JHEP 1208 (2012) 034, [arXiv:0904.2715].
[3] L. F. Alday, D. Gaiotto, and Y. Tachikawa, Liouville Correlation Functions from

Four-dimensional Gauge Theories, Lett.Math.Phys. 91 (2010) 167–197, [arXiv:0906.3219].

[4] N. Drukker, D. R. Morrison, and T. Okuda, Loop operators and S-duality from curves on

Riemann surfaces, JHEP 09 (2009) 031, [arXiv:0907.2593].

[5] L. F. Alday, D. Gaiotto, S. Gukov, Y. Tachikawa, and H. Verlinde, Loop and surface

operators in N=2 gauge theory and Liouville modular geometry, JHEP 01 (2010) 113,
[arXiv:0909.0945].

– 37 –

[6] N. Drukker, J. Gomis, T. Okuda, and J. Teschner, Gauge Theory Loop Operators and

Liouville Theory, JHEP 02 (2010) 057, [arXiv:0909.1105].

[7] D. Gaiotto, G. W. Moore, and A. Neitzke, Framed BPS States, Adv.Theor.Math.Phys. 17

(2013) 241–397, [arXiv:1006.0146].

[8] D. Gaiotto, G. W. Moore, and A. Neitzke, Four-dimensional wall-crossing via

three-dimensional ﬁeld theory, Commun.Math.Phys. 299 (2010) 163–224, [arXiv:0807.4723].

[9] V. Fock and A. Goncharov, Moduli spaces of local systems and higher Teichmuller theory,

Publ. Math. Inst. Hautes ´Etudes Sci. 103 (2006) 1211, [math/0311149].

[10] D. Galakhov, P. Longhi, and G. W. Moore, Spectral Networks with Spin, Commun. Math.

Phys. 340 (2015), no. 1 171–232, [arXiv:1408.0207].

[11] F. Bonahon and H. Wong, Quantum traces for representations of surface groups in SL2,

ArXiv e-prints (Mar., 2010) [arXiv:1003.5250].

[12] D. Gaiotto, G. W. Moore, and A. Neitzke, Spectral networks, Annales Henri Poincare 14

(2013) 1643–1731, [arXiv:1204.4824].

[13] D. Gaiotto, G. W. Moore, and A. Neitzke, Spectral Networks and Snakes, Annales Henri

Poincare 15 (2014) 61–141, [arXiv:1209.0866].

[14] E. Witten, Quantum ﬁeld theory and the jones polynomial, Comm. Math. Phys. 121 (1989),

no. 3 351–399.

[15] E. Witten, Gauge Theories and Integrable Lattice Models, Nucl. Phys. B322 (1989) 629.

[16] V. G. Turaev, Skein quantization of poisson algebras of loops on surfaces, Annales

scientiﬁques de l’Ecole Normale Superieure 24 (1991), no. 6 635–704.

[17] T. T. Q. Lˆe, Quantum Teichm¨uller spaces and quantum trace map, ArXiv e-prints (Nov.,

2015) [arXiv:1511.06054].

[18] D. G. L. Allegretti and H. K. Kim, A duality map for quantum cluster varieties from

surfaces, arXiv:1509.01567.

[19] L. Chekhov and V. V. Fock, Quantum Teichmuller space, Theor. Math. Phys. 120 (1999)

1245–1259, [math/9908165]. [Teor. Mat. Fiz.120,511(1999)].

[20] N. Y. Reshetikhin and V. G. Turaev, Ribbon graphs and their invariants derived from

quantum groups, Comm. Math. Phys. 127 (1990), no. 1 1–26.

[21] V. V. Fock and A. B. Goncharov, Cluster ensembles, quantization and the dilogarithm, ArXiv

Mathematics e-prints (Nov., 2003) [math/0311245].

[22] I. Le, Higher Laminations and Aﬃne Buildings, ArXiv e-prints (Sept., 2012)

[arXiv:1209.0812].

[23] D. Xie, Higher laminations, webs and N=2 line operators, arXiv:1304.2390.

[24] Y. Tachikawa and N. Watanabe, On skein relations in class S theories, arXiv:1504.00121.

[25] N. Watanabe, Wilson punctured network defects in 2D q-deformed Yang-Mills theory,

arXiv:1603.02939.

[26] I. Coman, M. Gabella, and J. Teschner, Line operators in theories of class S, quantized

moduli space of ﬂat connections, and Toda ﬁeld theory, JHEP 10 (2015) 143,
[arXiv:1505.05898].

– 38 –

[27] W.-y. Chuang, D.-E. Diaconescu, J. Manschot, G. W. Moore, and Y. Soibelman, Geometric

engineering of (framed) BPS states, Adv. Theor. Math. Phys. 18 (2014), no. 5 1063–1231,
[arXiv:1301.3065].

[28] M. Ciraﬁci, Line defects and (framed) BPS quivers, JHEP 11 (2013) 141,

[arXiv:1307.7134].

[29] C. C´ordova and A. Neitzke, Line Defects, Tropicalization, and Multi-Centered Quiver

Quantum Mechanics, JHEP 09 (2014) 099, [arXiv:1308.6829].

[30] T. Dimofte, D. Gaiotto, and S. Gukov, Gauge Theories Labelled by Three-Manifolds,

Commun. Math. Phys. 325 (2014) 367–419, [arXiv:1108.4389].

[31] S. Cecotti, C. Cordova, and C. Vafa, Braids, Walls, and Mirrors, arXiv:1110.2115.

[32] T. Dimofte, M. Gabella, and A. B. Goncharov, K-Decompositions and 3d Gauge Theories,

arXiv:1301.0192.

[33] T. Dimofte, 3d Superconformal Theories from Three-Manifolds, in New Dualities of

Supersymmetric Gauge Theories (J. Teschner, ed.), pp. 339–373. 2016. arXiv:1412.7129.

[34] D. Freed and A. Neitzke, in preparation.

[35] L. Hollands and A. Neitzke, Spectral networks and Fenchel-Nielsen coordinates,

arXiv:1312.2979.

– 39 –

