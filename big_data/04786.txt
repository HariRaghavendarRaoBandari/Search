6
1
0
2

 
r
a

 

M
5
1

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
6
8
7
4
0

.

3
0
6
1
:
v
i
X
r
a

PARABOLIC FREE BOUNDARY PRICE FORMATION MODELS

UNDER MARKET SIZE FLUCTUATIONS

PETER MARKOWICH, JOSEF TEICHMANN, AND MARIE-THERESE WOLFRAM

Abstract. In this paper we propose an extension of the Lasry-Lions price formation
model which includes ﬂuctuations of the numbers of buyers and vendors. We analyze the
model in the case of deterministic and stochastic market size ﬂuctuations and present
results on the long time asymptotic behavior and numerical evidence and conjectures on
periodic, almost periodic and stochastic ﬂuctuations. The numerical simulations extend
the theoretical statements and give further insights into price formation dynamics.

1. Introduction

This paper studies the impact of buyer and vendor number ﬂuctuations on the price
dynamics in an economic market in which a single good is traded. In general the formation
of the price is a complex process, which results from the interplay of various additional
factors such as trading behavior and rules, transaction costs, etc. Understanding these
complicated interactions is a central research question in the ﬁeld of market microstruc-
ture, which aims to explain “the process and outcome of exchanging assets under a speciﬁc
set of rules” (see for example O’Hara [19]).
In 2007 Lasry and Lions introduced a minimalistic mean-ﬁeld model (a one-dimensional
parabolic free-boundary partial diﬀerential equation) to describe the price, which enters
as the free boundary, of a single good traded between a large group of vendors and a large
group of buyers.
Here we study a dynamic trading model, which is motivated by the price formation model
proposed by Lasry and Lions. The original model considers a large group of buyers and
vendors trading a single good. Each buyer or vendor acts continuously in time with his/her
pre-trade price. If no trade takes place, the price diﬀuses instantaneously into its immedi-
ate neighborhood. When (through the diﬀusion around the pre-trade price) a buyer and
vendor transact at this price, trading takes place. The buyer becomes a vendor, at a price
which is the trading price plus the transaction cost, and the vendor becomes a buyer at a
price which is the trading price minus the transaction cost. The total number of buyers as
well as the total number of vendors is conserved in time. In reality however, buyers may
not want to resell immediately or sellers may decide to wait with their next purchase. As
a result temporal ﬂuctuations in the number of buyers and vendors arise naturally and
should be therefore included in the model. It is natural to expect that these ﬂuctuations
have independent increments and depend linearly on the total number of buyers and ven-
dors.
There is a plethora of stochastic models, often based on queuing theory, for price formation
(see for instance Lachapelle et al. [16] and the references therein), which deal in diﬀerent
degrees of accuracy with the many known phenomena of price formation on a microlevel.
The model, which we present here, fulﬁlls this requirement only in a very schematic con-
ceptual sense.
It stands out, however, due to its analytic tractability, a feature badly
missing in most of the other models. We believe that the stochastic version of the Lasry
and Lions model can serve as a building block for other price formation models with more

1

2

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

realistic description of the relaxation and ﬂuctuation mechanisms.
The Lasry and Lions model has been studied in a series of papers (see [8, 18, 15, 6, 7]).
Burger et al. [3, 4] identiﬁed the Lasry and Lions model as the asymptotic limit of a
kinetic model, in which trading events between buyers and vendors are described by col-
lisions, giving Boltzmann-type equations for the buyer and vendor densities. The Lasry
and Lions model corresponds to the high frequency trading regime, that is markets with
high volumes of trade and short holding periods. The short holding periods justify the
mass conservation property of both models. Kinetic models were also proposed for various
applications in ﬁnance, such as wealth and income distribution by D¨uring and Toscani,
Toscani, Brugna and Demichelis as well as Pareschi and Toscani in [12, 25, 20, 21], knowl-
edge growth in a society by Burger, Lorz and Wolfram [5] or opinion formation by Toscani
[24]. Degond, Liu and Ringhofer [11, 10] also proposed a kinetic mean-ﬁeld approach to
describe wealth evolution.
Here we generalize the Lasry and Lions model to account for ﬂuctuations in the number of
buyers and vendors. The ﬂuctuation are modeled either deterministically or stochastically,
and we aim to study their inﬂuence on the dynamics of the price. We discuss the long
time behavior in either case as well as conﬁrm and extend the analytic ﬁndings by several
numerical simulations.

The paper is organized as follows: The parabolic price formation model of Lasry and Lions
is introduced in Section 2.
In Section 3 we present our generalization, which includes
deterministic ﬂuctuations in the masses of buyers and vendors. We discuss the large time
asymptotics and periodic ﬂuctuations in Section 4. In Section 5 we illustrate the price
dynamics with numerical simulations. In Section 5.5 we conclude by studying the price
formation process in the case of stochastic mass ﬂuctuations.

2. The Lasry and Lions price formation model

Lasry and Lions [17] consider a market in which a large group of buyers and a large group
of vendors trade a certain good. If a buyer and a seller agree on a price, a transaction takes
place and the buyer immediately becomes a seller and vice versa. A transaction fee a has
to be paid by both parties. Buyers and vendors are modeled by densities, which describe
the (absolute) number of buyers (vendors) over the price variable x. Price formation is
modeled by buying at price x = p(t), paying – due to a transaction cost a – the price
p(t) + a and adding to the vendor distribution at p(t) + a. The same dynamics hold in the
case of selling (again with the transaction cost a). Non trivial dynamics are introduced
by allowing for diﬀusive changes of the buyer and seller distributions between two events
of price formation. The numbers of buyers and vendors remain unchanged at each time
of the price formation process.
The distribution of the agents is described in terms of a signed density function f . In
particular, the distribution of buyers over the price x ∈ R is the positive part f , that is,
f + = max(f, 0), while the negative part f− = − min(f, 0) is the distribution of vendors
again over the price x ∈ R. The distribution of buyers is supported to the left of the
formed price p(t), whereas the distribution of vendors is supported to the right of p(t)
reﬂecting the old principle “buy low and sell high”. The number of transactions at time
t is given by λ = λ(t) = −kfx(p(t), t). The impact of the trading events take place at
the agreed price shifted by the transaction cost a > 0. The diﬀusive changes in the buyer
and vendor distributions are modeled by second order derivatives with constant diﬀusivity
k = σ2
2 .

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

3

All the above are expressed by the following free boundary problem:

ft = kfxx + λ(t)(δ(x − p(t) + a) − δ(x − p(t) − a)) in R × R+
λ(t) = −kfx(p(t), t) and f (p(t), t) = 0 in R+
f (·, 0) = fI and p(0) = 0.

(1a)

(1b)

(1c)

Note that, without loss of generality, p(0) = 0.
translation. We assume that the initial distribution of buyers and vendors fI satisﬁes

since it can always be achieved by a

fI ∈ L∞(R) ∩ L1(R), xfI ∈ L1(R)
fI ≥ 0 in (−∞, 0), fI(0) = 0 and fI(x) ≤ 0 in (0, +∞).

(A1)

In the original model (1) the numbers of buyers M l and vendors M r are conserved in time
and are given by

M l =ZR
The ratio of these “masses” determines the large time asymptotic behavior of the price,
that is, if M l 6= M r, then (cf. [6])

I (x) dx and M r =ZR

f−I (x) dx.

f +

(2)

p(t) ∼

√tq∞ with erf(q∞) = √4k

M l − M r
M r + M l ,

(3)

where we use the usual deﬁnition for the error function erf(z) := 2√πR z
As a result the price increases asymptotically like √t if Ml > Mr (number of buyers is
larger than number of vendors) and decreases asymptotically like −√t if Mr > Ml (num-

ber of buyers smaller than the number of vendors). When Mr = Ml, the price stabilizes
to a constant.

0 e−r2

dr.

A very useful tool for the analysis and the numerics of the Lasry and Lions model is
the following nonlinear transformation (introduced in [6]), which changes (1a) to the heat
equation. Deﬁne

It follows that F = F (x, t) satisﬁes the heat equation

F (x, t) :=( P∞n=0 f +(x + na, t)
−P∞n=0 f−(x − na, t)
in R × R+,

Ft = kFxx

with the (transformed) initial datum

FI (x) =( P∞n=0 f +

−P∞n=0 f−I (x − na)

I (x + na)

if x < p(t),
if x > p(t).

if x < 0,
if x > 0.

(4)

(5)

(6)

(7)

Conversely, if F is a solution to (5), then, the density f in (1), is recovered by

f (x, t) = F (x, t) − F +(x + a, t) + F −(x − a, t).

Note that to obtain (7) it is necessary to ensure that the back-transformed function f is
positive to the left of the free boundary and negative to the right of it. This follows easily
from the structure of the transformed initial datum FI and the comparison principle for
the heat equation.

4

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

3. Deterministic market size fluctuations

We introduce deterministic time dependent changes (ﬂuctuations) of the size of the market
in the Lasry and Lions model. This setting is the ﬁrst step towards the development of a
proper stochastic formulation, where mass ﬂuctuations are modeled by typical trajectories
of semi-martingales.
Let bl = bl(t) and br = br(t) denote ﬂuctuations for the buyer and vendor densities and
assume that

(A2) bl, br be in C 0,1[0,∞) with bl(0) = br(0) = 0.

Note that bl(0) = br(0) = 0 can always be achieved by a constant shift bl, br, which will
not change the PDE model stated below.

Market size ﬂuctuations are introduced conceptually by the following time splitting scheme,
which corresponds to a numerical solution algorithm of a PDE:

(1) Given a signed buyer-vendor distribution f = f (x, t) at time t, solve the Lasry and

Lions model (1) from time t to t + ∆t.

(2) At the end of each time step modify the market by multiplying the distribution of

buyers f + and vendors f− by ebl(t+∆t)−bl(t) and ebr (t+∆t)−br (t) respectively.

This splitting scheme yields in the (formal) limit ∆t → 0, the problem
ft = kfxx + λ(t)(δ(x − p(t) + a) − δ(x − p(t) − a))

+(˙blf + − ˙brf−)
λ(t) = −kfx(p(t), t), f (p(t), t) = 0

f (·, 0) = fI and p(0) = p0.

in R × R+.
in R+

(8a)

(8b)

(8c)

Assuming that the free boundary p = p(t) is uniquely deﬁned by (8b), we can compute
the actual ﬂuctuations of the numbers of buyers and vendors by integrating (8a) over
(−∞, p(t)) and (p(t),∞), respectively and taking into account that f > 0 for x < p(t) and
f < 0 for x > p(t).
Let M l(t) :=RR f +(x, t)dx and M r(t) :=RR f−(x, t)dx. Using the deﬁnition of λ in (8b),

we obtain

M l(t) = ˙bl(t)M l(t),

M r(t) = ˙br(t)M r(t),

d
dt

d
dt
and, therefore, for t ≥ 0,

M l(t) = ebl(t)M l and Mr(t) = ebr(t)M r.

Hence the proposed time splitting results in exponential market size changes for the buyers
and vendors.
The rigorous justiﬁcation of the convergence of the splitting scheme to (8) follows easily
from the reformulation of the problem as the heat equation in each time interval (t, t +
∆t) after multiplying the initial datum at t from the left and right by the appropriate
exponential. We leave the details to the reader.
The results here are based on the transformation connecting the Lasry and Lions model
(1) in a one-to-one way to the heat equation (5). Since market size ﬂuctuations are

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

5

homogeneous in space the transformation yields

Ft = kFxx + ˙blF + − ˙brF −
F (·, 0) = FI

in R × R+
in R,

(9a)

(9b)

where the initial datum is given by (6); note that p = p(t) is the zero level set of the
function F . We can rewrite equation (9), using F + = F +|F|2

and F − = |F|−F

, as

2

Ft = kFxx + ˙blF + − ˙brF −
(˙bl + ˙br)F +

= kFxx +

1
2

1
2

(˙bl − ˙br)|F|.

Then the exponential transformation U = F e−(bl+br)/2 gives

Ut = kUxx +
U (·, 0) = FI

1

2(cid:16)˙bl − ˙br(cid:17) |U|

in R × R+
in R.

(10)

(11a)

(11b)

We now state the following existence and uniqueness result for (9).

Theorem 3.1. Assume (A1) and (A2). Then the initial value problem (9) has a unique
global-in-time classical solution and the free boundary p = p(t) is the graph of a locally
bounded continuous function of time.

Proof. From the Lipschitz continuity of the absolute value function we can deduce the
existence of a unique solution of (11). The free boundary p corresponds to the zero level
set of the function U , that is U (p(t), t) = 0. It follows from Angenent [1] that the function
U (·, t) has at most one zero p(t) for every t > 0, see also [14]. In the former reference
Angenent showed that the number of zeros of any solution u of

ut = kuxx + q u,

in ∈ R × R+,

(12)

with q = q(x, t) ∈ L∞ cannot increase in time. Since |U|U is bounded, Lemma 5.1 in [1]
guarantees that solutions to (11) cannot vanish identically on any interval (x0, x1). It is,
therefore, immediate that the free boundary has no “fat” parts.
Next we show that the free boundary cannot become unbounded in ﬁnite time. Let
2 (˙bl(t) − ˙br(t)), write (11a) in the form (12) with q(x, t) = b(t) sign U (x, t). We
b(t) := 1
write U = U1 − U2 where U1 and U2 are respectively the solutions of

∂2
∂x2 U1 + qU1

U1 = k

∂
∂t
U1(·, 0) = F +

I

and

in R × R+,
in R,

in R × R+,
in R.

∂2
∂x2 U2 + qU2

U2 = k

∂
∂t
U2(·, 0) = F −I

For any given T > 0 set AT := inf x∈R, t∈(0,T ) q(x, t), BT := supx∈R, t∈(0,T ) q(x, t). Since
U1, U2 ≥ 0, the comparison principle gives

eAT tR(x, t) ≤ U1(x, t) ≤ eBT tR(x, t) and eAttS(x, t) ≤ U2(x, t) ≤ eBT tS(x, t),

where R and S are solution of the initial value problems

Rt = kRxx
R(·, 0) = F +

I

in R × R+
in R

and

St = kSxx
S(·, 0) = F −I

in R × R
in R.

6

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

Expressing R and S in terms of the fundamental solution of the heat equation yields that,
for any δ > 0, all t ∈ (δ, T ], we have

R(x, t) → 0 as x → ∞ and S(x, t) → 0 as x → −∞,

while R(·, t) and S(·, t) remain bounded away from 0 as x → −∞ and x → ∞ respectively
see [6] for full details. We conclude that the signs of U in the far ﬁelds are determined by
the signs of the initial datum UI , which is positive on the left and negative on the right.
The continuity of U implies the existence of a zero in between and the free boundary p
stays locally bounded in time.
(cid:3)

It is also of interest to consider market size ﬂuctuation functions with jump discontinuities
bl and br, particularly with Levy-type random processes in hindsight. Assume for the
moment that, instead of (A2), we have:

(A2’) There is an increasing sequence {Tk}k∈N , T0 = 0, T −0

:= 0, Tk → ∞ as
k → ∞ such that, for all k ∈ N, bl, br ∈ W 1,∞(Tk, Tk+1) with bl(0) = br(0) = 0.
We are interested in the case where either br(T +
k ) is diﬀerent from br(T −k ) or
bl(T −k ) respectively. Then the limit ∆t → 0 of the splitting scheme has to be modiﬁed
even on the formal level as follows:
On every interval (Tk, Tk+1) we solve (8) subject to the initial datum

k ) or bl(T +

:= T +
0

fI (x, T +

k ) = fI(x, T −k )(exp(bl(T +

exp(br(T +

k ) − bl(T −k )),
k ) − br(T −k )),

if x < p(Tk)
if x > p(Tk).

Note that Theorem 3.1 applies on each interval (Tk, Tk+1) and that the free boundary
p = p(t) is globally continuous.
Standard results for the (obvious) time splitting scheme of semilinear parabolic equations
with smooth nonlinearities (see [13]) yield the convergence of the scheme. It is immediate
that the convergence is retained for less smooth nonlinearities (albeit possibly loosing
the convergence order). Applying ﬁrst the exponential transformation, which gives the
splitting scheme for (9) and equivalently for (8), and, consecutively, the transformation
(7), we conclude the convergence of the solution of the time spitting scheme.

4. The long time asymptotics

We now consider the asymptotic behavior of (8) for t → ∞. We use the super- and sub-
scripts l and r to refer to the left and right sides of the free boundary p = p(t) in the
following.
In what follows we assume that

(A3)

(i) Let b(t) := 1
(ii) limt→∞ bl(t) = b∞l and limt→∞ br(t) = b∞r ,
(iii) |bl(t) − b∞l
(iv) |bl(t) − b∞l

2 (bl(t) − br(t)) ∈ W 1,∞(0,∞) ∩ W 1,1(0,∞),
| + |br(t) − b∞r | = O(t−w) for all t > 0 with w > 1,
| + |br(t) − b∞r | = O((1 + t)−w) for all t > 0 with w > 3
2 .

or alternatively we shall use

To simplify the argument, we write

ebl(t) := l(t) and ebr(t) := r(t).

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

7

Next we consider the exponential transformation of the original problem (10) given by

G(x, t) :=(e−bl(t)F (x, t) if x < p(t)

e−br(t)F (x, t) if x > p(t).

It is immediate that G satisﬁes the following problem

Gt = kGxx

G(p(t), t) = 0

in {(x, t) | t > 0 and x 6= p(t)}
in R+,

l(t)Gx |x=p(t)− = r(t)Gx |x=p(t)+ in R+

G(·, 0) = GI = FI .

To determine the asymptotic behavior in case of deterministic market ﬂuctuations we use
the parabolic rescaling and deﬁne x = y

ε2 ) satisﬁes

Gτ = kGyy

Gε(qε(τ ), τ ) = 0

ε and t = τ

ε2 . Then G(y, τ ) := G( y
ε , τ
in {(x, τ ) | τ > 0 and x 6= qε(τ )}

in R+,

(13)

(14a)

(14b)

(14c)

(14d)

(15a)

(15b)

(15c)

(15d)

l(

τ
τ
ε2 )Gy |y=qε(t)+ ,
ε2 )Gy |y=qε(τ )− = r(
G(·, 0) = F ε
I .

We study the limit as ε → 0 and note that qε(τ ) = εp( τ
ε2 ). At ﬁrst we assume that
qε = qε(τ ) is known (and smooth) and solve (15) on the left and the right of the free
boundary respectively. Let Gl and Gr be the smooth solutions of

in (−∞, qε(τ )), τ > 0

in R+,

and

yy in (qε(τ ),∞), τ > 0

τ = kGr

Gr
Gr(qε(τ ), τ ) = 0
Gr(·, 0) = F ε

I

in R+,

in (qε(0),∞).

τ = kGl
yy

Gl
Gl(qε(τ ), τ ) = 0
Gl(·, 0) = F ε

I

in (−∞, qε(0))
Then Gl and Gr can be written as
Gl(y, τ ) =Z qε(0)
+Z τ
Gr(y, τ ) =Z qε(0)
−Z τ

−∞

−∞

0

0

e−bl( s

where F ε(y, τ ) := F ( y

ε , τ

ε2 ) and

F ε
I (ξ)K(y − ξ, τ )dξ
ε2 ) F ε,l

y (qε(s), s)K(y − qε(s), τ − s)ds,

F ε
I (ξ)K(y − ξ, τ )dξ
ε2 ) F ε,l

e−br( s

y (qε(s), s)K(y − qε(s), τ − s)ds,

K(x, t) :=

1

√4πkt

e− x2
4kt .

(16)

is the heat kernel.
Since Gl(qε(τ ), τ ) = e−bl( τ
we ﬁnd

ε2 )F ε(qε(τ ), τ ) = 0 and Gr(qε(τ ), τ ) = e−br( τ

ε2 )F ε(qε(τ ), τ ) = 0

0 = F ε(qε(τ ), τ ) =Z qε(0)
+Z τ

−∞

0

ebl( τ

ε2 )F ε

I (ξ)K(qε(τ ) − ξ, τ )dξ
ε2 )F ε

ebl( τ

ε2 )−bl( s

y (qε(s), s)K(qε(τ ) − qε(s), τ − s)ds

8

and

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

0 = F ε(qε(τ ), τ ) =Z qε(0)
−Z τ

−∞

0

ebr( τ

ε2 )F ε

I (ξ)K(qε(τ ) − ξ, τ )dξ
ε2 )F ε

ebr( τ

ε2 )−br ( s

y (qε(s), s)K(qε(τ ) − qε(s), τ − s)ds.

Adding the above equations gives I1,ε + I2,ε = 0 with

I1,ε :=

Z τ
0 (cid:2)ebl( τ

and

ε2 )−bl( s

ε2 ) − ebr ( τ

ε2 )−br( s

y (qε(s), s)K(qε(τ ) − qε(s), τ − s)ds

ε2 )(cid:3)F ε

I2,ε :=

Z qε(0)

−∞

ebl( τ

ε2 )F ε

I (ξ)K(qε(τ ) − ξ, τ )dξ +Z ∞

qε(0)

ebr( τ

ε2 )F ε

I (ξ)K(qε(τ ) − ξ, τ )dξ

(17a)

(17b)

We shall use the following estimate in order to compare I1,ε and I2,ε asymptotically for
ε → 0.
Lemma 4.1. Assume (A3)(i) and FI ∈ W 1,∞(R). Then
d
dx

U (·, t)kL∞(R) ≤ eR ∞

0 |˙b(s)|dsk

FIkL∞(R),

d
dx

k

where U solves (11).

Note that this implies, that for some C > 0, kFxkL∞(R×(0,∞)) ≤ C and thus gives the
L∞(0,∞)-bound of λ = λ(t) used in the proof of Theorem 4.3 and 4.5.

Proof. We write W = Ux and obtain by diﬀerentiating (11)

Wt = kWxx + ˙b(t) sign(U )W in R × R,

W (·, 0) =

d
dx

FI .

Multiplying (18) by W 2j−1 for some ﬁxed j > 1 and integrating over R yields

1
2j

d

dtZR

W 2jdx = −k(2j − 1)ZR

W 2

x W 2j−2dx + ˙b(t)ZR

sign(U )W 2jdx,

and, therefore,

and, hence,

W 2jdx,

d

dtZR
kW (·, t)kL2j (R) ≤ eR t

W 2jdx ≤ 2j|˙b(t)|ZR
0 |˙b(s)|dsk

d
dx

FIkL2j (R).

This results letting the limit j → ∞.

(18a)

(18b)

(cid:3)

We remark that FI ∈ W 1,∞(R) holds if, for example fI ∈ W 1,∞(R) has compact support.
Next we consider the rescaled initial datum in the limit ε → 0.

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

9

Proposition 4.2. Let FI = FI (x) be given by (6). Then the rescaled initial datum satisﬁes
FI ( x
where

I (z)dz +R ∞0 zf−I (z)dz)δ(x)+O(ε2) in D′(R),

ε ) = F 0

I (x)+ ε

zf +

−∞

a (R 0
2 (M l−M r)δ(x)+ ε
I (x) =( 1
a M l
− 1
a M r

F 0

for x < q(0) = 0
for x > q(0) = 0.

Proof. It is immediate from the deﬁnitions of FI that, for every test function ϕ ∈ C∞0 (R):

−∞" ∞Xn=0
Z ∞
εZ 0

−∞

y

f−I (

∞Xn=0
ϕ(ε(z − na))dz − εZ ∞

ε − na)# ϕ(y)dy =
∞Xn=0

f−I (z)

0

f +
I (

y
ε

+ na) −

f +
I (z)

∞Xn=0

ϕ(ε(z + na))dz.

(19)

(20)

It follows that

ε

∞Xn=0

ϕ(ε(z − na)) = ε

2

1

∞Xn=0
(ϕ(−εna) + εzϕx(−εna)) + O(ε2)
aZ εa
aZ 0

a Z εa

−∞
ϕ(0) +

ϕ(x)dx +

ϕ(x)dx +

εz
a

−∞

−∞

ε
2

εz

1

2

ϕx(x)dx + O(ε2)

ϕ(0) + O(ε2).

=

=

Note that we split both integrals in the second line of (20) into two parts. The ﬁrst one is
approximated by the rectangle integration rule, while the contributions from the second
interval over (0, εa

2 ) were included in the O(ε2) terms.

Similar calculations give εP∞n=0 ϕ(ε(z + na)) = 1

which concludes the proof.

aR ∞0 ϕ(x)dx + ε

2 ϕ(0) − εz

a ϕ(0) + O(ε2),
(cid:3)

Next we introduce the additional notation

l∞ = eb∞

l , r∞ = eb∞

r , αl =

l∞
a

M l and αr =

r∞
a

M r.

(21)

Theorem 4.3. Assume (A3)(i), (A3)(ii) and (A3)(iii). Let fI be such that FI ∈ W 1,∞(R).
Then, as t → ∞,

p(t) = (β1 + O(

1
√t

where β1 = √4k erf−1( αl−αr
αl+αr ).

)√t,

Proof. Note that since kF ε
yields,

y (qε(τ ), τ ) = 1

ε λ(t), the bound on λ that was obtained earlier

I1,ε .

c
εkλkL∞(0,∞)Jε,

with

Jε :=Z τ

0

1

√τ − s |ebl( τ

ε2 )−bl( s

ε2 ) − ebr( τ

ε2 )−br( s

ε2 )| ds.

10

Since

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

Jε = εZ t

0

1

√t − u |ebl(t)−bl(u) − ebr(t)−br (u)| du

:= εSt with t =

τ
ε2

we ﬁnd I1,ε . kλkL∞(0,∞)St.
Consider now the 1

2 -fractional integral

It is easy to verify that, if f (t) . t−w1 for w1 > 0

(I 1
2

f )(t) =Z t

0

f (s)

√t − s

ds.

Then the asymptotic assumption (A3)(iii) on bl and br implies

(I 1
2

f )(t) . t− 1

2 + |ln t|t−w1+ 1

2 .

and, therefore

I2,ε =Z qε(0)

−∞

eb∞

l F ε

Since, in view of Proposition (4.2),

l M l, x < 0

l M r, x < 0

qε(0)

eb∞

I (x), x < 0

1
a
1
eb∞
a

I (ξ)K(qε(τ ) − ξ, τ )dξ +Z ∞
I (x), x > 0) = 

K(qε(τ ) − ξ, τ )dξ − αrZ ∞
K(qε(τ ) − ξ, τ )dξ − αrZ ∞

−∞

0

0

( eb∞

eb∞

l F ε
r F ε

I2,ε = αlZ 0
αlZ 0

−∞

This yields together with (22) the equation for qε(τ ):

using that qε(0) = 0, we have

J1,ε = O(ε) as ε → 0.

(22)

eb∞

r F ε

I (ξ)K(qε(τ ) − ξ, τ )dξ + O(ε2).

+ O(ε) in D′(R),



K(qε(τ ) − ξ, τ )dξ + O(ε).

K(qε(τ ) − ξ, τ )dξ = O(ε).

Hence we obtain

αl
2

−

(1 + erf(

qε(τ )
√4kτ

)) +

αr
2

(1 − erf(

qε(τ )
√4kτ

)) = O(ε),

and thus

The claim now follows

erf(

qε(τ )
√4kτ

) =

αl − αr
αl + αr + O(ε).

qε(τ ) = β1√τ + O(ε)√τ ,

which, in view of the rescaling, yields
qε(ε2t)

p(t) =

ε

= β1√t + O(1) as t → ∞.

(cid:3)

For the case αl = αr we shall make use of the following auxiliary Lemma:

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

11

Lemma 4.4. Assume f ∈ W 1,∞(0,∞) and |f (t)| ≤ c
σ > 3

2 , there exists a function H ∈ L1

+(0,∞) ∩ L∞+ (0,∞) such that, for s ∈ (0, t)

(1+t)σ for t > 0 with σ > 0, c > 0. If

|f (t) − f (s)| ≤

H(s)
√t

√t − s.

(23)

Proof. We rewrite

|f (t) − f (s)| =p|f (t) − f (s)|p|f (t) − f (s)|
(1 + t)σ +

≤pLip(f )√t − s(cid:18)

c

c

(1 + s)σ(cid:19) .

Let α ∈ (0, 1) and consider s ∈ [αt, t]. Then

|f (t) − f (s)| ≤ cpLip(f )√t − s

√ab for all a, b > 0, we have for s ∈ [αt, t]

2

(1 + αt)σ .

Since min(a, b) ≤

|f (t) − f (s)| ≤ C√t − s

1

1

(1 + αt)

σ
2

(1 + s)

,

σ
2

and thus if t > 1 and s ∈ [αt, t]

|f (t) − f (s)| ≤ C1√t − s

1
√t

1

(1 + αs)σ− 1

2

.

Since, for all s ∈ [0, αt],

we have

√t − s
√t ∈ [√1 − α, 1],

|f (t) − f (s)| ≤

√t − s
√t

1

√1 − α

2c

(1 + s)σ .

The result follows with H(s) = C2

1

(1+αs)σ− 1

2

.

(cid:3)

The next result is about the long time asymptotics of p when αr = αl.

Theorem 4.5. Assume (A3)(i), (A3)(ii) and (A3)(iv) and let fI be such that FI ∈
W 1,∞(R). If αl = αr

p(t) = β2 + o(1) as t → ∞,

with

β2 =

1

2αa(cid:20)l∞Z 0

−∞

zf +

I (z)dz + r∞Z ∞

0

zf−I (z)dz − aZ ∞

0

ζ(∞, s)λ(s)ds(cid:21) .

(24)

12

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

Proof. We revisit the equation I1,ε + I2,ε = 0 and reﬁne the asymptotics for each term.
Recalling (17a) we ﬁnd:

I1,ε = −Z t
= −Z ∞

0

= −

1

0 (cid:16)ebl(t)−bl(s) − ebr(t)−br (s)(cid:17) λ(s)
p4kπ(t − s)
1{s<t}(cid:16)ebl(t)−bl(s) − ebr(t)−br (s)(cid:17)
}
e− (p(t)−p(s))2
p1 − s

|
√4kπtZ ∞

1{s<t}ζ(t, s)λ(s)

ε λ(t) and t = τ

y (qε(τ ), τ ) = − 1

{z

:=ζ(t,s)

λ(s)

1

1

0

t

1

p4kπ(t − s)

4k(t−s) ds,

where we used that kF ε
p(t) = O(1) as t → ∞ we have

e− (p(t)−p(s))2

4k(t−s) ds

e− (p(t)−p(s))2

4k(t−s) ds

ε2 . Since in view of Theorem 4.3

(p(t) − p(s))2
4k(t − s)

.

1

,

(t − s)

and, thus, pointwise for a.e. s > 0, as t → ∞ we get
e− (p(s)−p(t))2

1

1

{s<t}ζ(t, s)λ(s)

4k(t−s) → ζ(∞, s)λ(s).

Since Lemma 4.4 ensures that |ζ(t, s)| ≤p1 − s

1

1

{s<t}|ζ(t, s)|λ(s)

e− (p(t)−p(s))2

4k(t−s) ≤ kλkL∞ H(s),

t H(s) for 0 < s < t we have

and, by the Lebesgue dominated convergence, we ﬁnd that

I1,ε = −(cid:18) 1

ζ(∞, s)λ(s)ds + o(1)(cid:19) .

p1 − s

t

t

p1 − s
√4kπtZ ∞

0

To reﬁne the asymptotics of I2,ε given by (17b) we use Proposition 4.2 again with fI
replaced by l∞fI (x) for x < 0 and r∞fI(x) for x > 0. Letting α := αl = αr, we get

I2,ε = −
ε

+

α

α

2(cid:16)1 + erf(cid:18) qε(τ )
ahl∞Z 0

√4kτ(cid:19)(cid:17) +
I (z)dz + r∞Z ∞

zf +

−∞

0

√4kτ(cid:19)(cid:17)
2(cid:16)1 − erf(cid:18) qε(τ )

Hence I1,ε + I2,ε = 0 becomes

−α erf(cid:18) qε

√4kτ(cid:19) +

ε

a√4kπτ

−(qε(τ ))2

4kτ

e

(cid:20)l∞Z 0

−∞

We conclude

zf−I (z)dziK(qε(τ ), τ ) + o(ε).
zf−I (z)dz(cid:21)
I (z)dz + r∞Z ∞
√4kπτ Z ∞
−
ζ(∞, s)λ(s)ds = o(ε).

ε

0

0

zf +

qε(τ ) = (β2 + o(1))ε uniformly on compact intervals of τ as ε → 0,
I (z)dz + r∞R ∞0 zf−I (z)dz − aR ∞0 ζ(∞, s)λ(s)dsi.
2αahl∞R 0

−∞
we obtain the claim.

zf +

with β2 = 1
Since p(t) = qε(ε2t)

ε

(cid:3)

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

13

4.1. Periodic market size ﬂuctuations. We now discuss the price formation model in
case of periodic ﬂuctuations, that is we assume for all s ∈ [0,∞), there exist τl > 0 and
τr > 0 such that

bl(s) = bl(s + τl) and br(s) = br(s + τr).

At ﬁrst we study the highly oscillatory case on time intervals of length O(1), that is we
choose ε > 0 small and replace bl(t), br(t) in (8) (and (9), (10) and (11)) respectively by
l (t) := bl( t
bε
ε2 ). The PDE is then studied on the time interval (0, T ),
where 0 < T < ∞ is ε-independent.
Then the IVP (11) reads:

r(t) := br( t

ε2 ), and bε

1
2ε2 (˙bl(
U ε
t = kU ε
U ε(x, t = 0) = FI (x).

xx +

t
ε2 ) − ˙br(

t
ε2 ))|U ε| in R × [0, T ]

Note that the exponential transformation (13) of equation (11) gives:

Gε

t (x, t) = kGε

xx(x, t), x 6= pε(t)

Gε(pε(t), t) = 0,

t > 0

l(

t
ε2 )Gε

t
ε2 )Gε
x |x=pε(t)− = r(
Gε(x, t = 0) = FI (x).

x |x=pε(t)+

(25a)

(25b)

(26a)

(26b)

(26c)

(26d)

Assume that τl
τr
(26c) as

is rational, r is uniformly positive and l

r is not constant. Then, writing

=

Gε
Gε

x(pε(t)+, t)
x(pε(t)−, t)

l( t
ε2 )
r( t
ε2 )
We conclude that Gε
x(pε(t)−, t) converges weakly to a constant (the average
x(pε(t)−, t) cannot both converge
of
strongly. Therefore it is not possible to pass to the limit ε → 0 in (26c) directly, that is
the most basic formal argument fails.
Next we consider the problem

l(τ )
r(τ ) over the period) and thus Gε

x(pε(t)+, t) and Gε

x(pε(t)+, t)/Gε

.

xx +

U ε
t = kU ε
U ε(x, t = 0) = FI (x),

˙b(

1
ε2

t
ε2 )f(U ε)

in R × R+

(27)

with f = f(u) a smooth, non-negative function with f(0) = 0 and b a 1-periodic func-
0 b(τ )dτ = 0; here we do not assume b(0) = 0 but instead b(τ ) =

1

tion with hbi = R 1
2 (bl(τ ) − br(τ ) − (hbli − hbri)).
We make the following asymptotic ansatz

U ε = Φ(b(

t
ε2 ), V ) + ε2W (x, t,

t
ε2 ) + O(ε3),

with W being a 1 periodic function in τ = t

ε2 and Φ = Φ(s, ξ) solving

Φs = f(Φ)
Φ(s = 0, ξ) = ξ.

for s ∈ R

Noting that Φξ satisﬁes

(Φξ)s = f′(Φ)Φξ, and Φξ(s, 0, ξ) = 1 ,

(28)

(29a)

(29b)

14

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

and we conclude that, for all s > 0 and ξ ∈ R,
Φξ(s, ξ) = exp(Z s
Φξξ(s, ξ) = Φξ(s, ξ)Z s

and

0

0

f′(Φ(r, ξ))dr)

f′′(Φ(r, ξ))Φξ(r, ξ)dr .

Next we determine necessary conditions for the asymptotics (28) to hold. We start by
computing

U ε

1
ε2 Φs ˙b + ε2Wt + ˙W + O(ε3), U ε

t = ΦξVt +
xx = Φξξ(Vx)2 + ΦξVxx + ε2Wxx + O(ε3).
U ε

x = ΦξVx + ε2Wx + O(ε3)

Substituting U ε and its derivatives into (25) gives

Φξ(Vt − Vxx) − Φξξ(Vx)2 = − ( ˙W + ˙bW f′(Φ)) − ε2(Wt − Wxx − ˙b(W )f′′(Φ + σε2W )),

where we have used the Taylor expansion of the term f(Φ + ε2W ) and ignored the O(ε2)
term. Note that

(30a)

(30b)

(31)

(32)

˙W + ˙bW f′(Φ) =

1
g

d
dτ

(gW ),

˙b(ψ)f′(Φ(b(ψ), V (x, t)))dψ). Since

with g(τ, x, t) := exp(−R τ

0

we can rewrite g as

Z τ

0

˙b(ψ)f′(Φ(b(ψ), V (x, t)))dψ =Z b(τ )
g(τ, x, t) = exp(−Z b(τ )

b(0)

b(0)

f′(Φ(w, V (x, t)))dw)

f′(Φ(w, V (x, t)))dw

and deduce that τ → W g is 1-periodic as well. Now we take the mean. This gives

From (30a) we deduce that

hgΦξi(Vt − Vxx) − hgΦξξi(Vx)2 = 0.
g(τ,x,t) = Φξ(b(τ ),V )

Φξ(b(0),V ) , while (30b) gives

1

hgΦξξi = Φξ(b(0), V )∂ξZ 1

0 Z b(τ )

0

f′(Φ(r, V ))drdτ.

Substituting (32) in (31) and dividing by Φξ(b(0), V ) gives the necessary condition for
periodicity of W ε(x, t, τ ) in the τ -variable, that is

Vt = Vxx + ∂xhZ b

0

f′(Φ(r, V ))driVx = 0.

In the following we present a formal argument in the case f(U ) = 1
1
2 sign(U ) we have (as computed before)

2|U|. Since f′(U ) =

Φ(s, ξ) = e

1

2 s sign ξξ

and

Z b

0

f′(Φ(r, V ))dr =

1
2

b(τ ) sign V.

We formally obtain that Vt = Vxx. Thus
1
U ε(x, t) ∼ e

2 (b( t

ε2 )) sign V (x,t)V (x, t),

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

15

where V solves the heat equation with initial datum

V (x, t = 0) =(e− 1

e

4 (bl(0)−br (0)−hbli+hbri) UI (x) x < p(0)
4 (bl(0)−br (0)−hbli+hbri) UI (x)
x > p(0).

1

(33)

By using the nonlinear transformation (7) from the heat equation to (1) it follows that
the limiting free boundary of the Lasry-Lions model with periodic market ﬂuctuations is
given by the free boundary of the original Lasry-Lions model without market ﬂuctuations
I and f−I are multiplied by the
but with a changed initial buyer-vendor distribution. f +
same factors as UI in (33).
Note that the asymptotics presented here do not even hold formally if the periods τl and
τr of bl and br, respectively, are not rationally related.

Remark 4.6. A related problem is to study periodic mass-ﬂuctuations bl = bl(t) and
br = br(t) with O(1)-periods and look for the limits as t → ∞ of the free boundary p = p(t).
After the parabolic rescaling x = y
ε2 and the usual exponential transformation
the problem (25) with y and τ as independent variables is obtained, where the initial datum
FI (·) is replaced by FI ( ·ε ).

ε and t = τ

A rigorous proof of the homogenization result in the case of periodic market size ﬂuctua-
tions will be the subject of a future paper.

5. Numerical simulations:

We conclude the discussion about the long time asymptotic behavior in the case of
deterministic and periodic market size ﬂuctuations by presenting numerical experiments.
The numerical simulations are based on a ﬁnite diﬀerence discretization of (10) in space
and a Runge-Kutta time splitting scheme. We use the following Strang time splitting
scheme (with time step denoted by ∆t and ti = i∆t):

(1) Solve the ODE Ft(x, t) = ˙bl(t)F +(x, t)−˙br(t)F −(t) explicitly in time on the interval
t ∈ [ti, ti + 0.5∆t].
(2) Evolve F according to the heat equation Ft(x, t) = Fxx(x, t) for a full time step,
that is t ∈ [ti, ti+1], using an explicit 4-th order Runge Kutta time stepping scheme
and a classic ﬁnite diﬀerence discretization in space.
(3) Solve the ODE Ft(x, t) = ˙bl(t)F +(x, t)−˙br(t)F −(t) explicitly in time on the interval

t ∈ [ti + 0.5∆t, ti+1].

For the following simulations the computational domain is set to [−50, 50] (where pmax =
50 corresponds to the scaled maximum price) and is split into 104 equidistant subintervals if
not stated otherwise. Then (10) is solved with the following nonlinear boundary conditions

Fx(−pmax, t) = Fx(−pmax + a, t)

and

Fx(pmax, t) = Fx(pmax − a, t),

which correspond to homogeneous Neumann boundary conditions in the original Lasry
and Lions model. Note that we choose the computational domain suﬃciently large, to
ensure that the price dynamics are not inﬂuenced by the boundary conditions for a large
time. However it is not possible to neglect the inﬂuence on the numerical simulations as
we shall illustrate in the ﬁrst example.

16

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

Simulation L&L
Theoretical behavior

1.4

1.2

1

0.8

0.6

0.4

0.2

 

2.5

2

1.5

1

0.5

 

Relative error

O(1/√t)

0

 
0

20

40

60

80

100

Time t

120

140

160

180

200

0

 
0

20

40

60

80

100

Time t

120

140

160

180

200

(a) Evolution of the price

(b) Relative error η

Figure 1. Comparison of the price evolution for the classic L&L model (1).

5.1. Price evolution of the classic Lasry and Lions model. In the ﬁrst example
we compare the theoretical long time asymptotic behavior of the Lasry and Lions model
(1) with the simulation results. Note that (1) corresponds to the simulation of (9) with
˙bl(t) = ˙br(t) = 0, that is the simulations of the heat equation with an initial datum
of the form FI (x) = 1x<0 − 0.95 × 1x>0. Figure 1 illustrates the behavior of the free
boundary for the Lasry and Lions model (1) as a function of time. The relative error
η = | c√t−papprox(t)
| decays fast in a good agreement of the numerically computed price
papprox and the theoretical results. In fact the numerical results indicate that the relative
error decays like t− 1
The next example illustrates the inﬂuence of the boundary on the price dynamics. Note
that the stationary price p∞ in the classic Lasry and Lions model on a bounded domain
(−pmax, pmax) with Neumann boundary conditions is given by
pmax

2 , see Figure 1b).

c√t

p∞ =

2M lpmax − a(M l − M r)

2(M l + M r)

−

.

2

(34)

We choose an initial datum fI with equal masses of buyers and vendors, i.e.

1
−x
2
0

for − 5 ≤ x ≤ −1
for − 1 < x ≤ 2
for 2 < x ≤ 3.25
otherwise.

fI(x) =


While the asymptotic analysis on the unbounded domain postulates the convergence to-
wards the constant β2 given by (24), the stationary price on the bounded domain, given by
(34), corresponds to p∞ = 0. Figure 2 clearly illustrates the change of the price dynamics
for diﬀerently sized domains Ω = [−pmax, pmax]. The black line at p = −0.3475 corre-
sponds to the predicted analytic constant - we observe that the prices initially converge
to this value, but then reverse their dynamics towards p∞ = 0 due to the inﬂuence of
the boundary conditions. The smaller the computational domain the earlier the reversal
happens.

5.2. Price evolution for stabilizing market size ﬂuctuations. Next we compare the
simulated price dynamics for diﬀerent choices of bl and br with the theoretical results. We

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

17

0.05

0

−0.05

−0.1

−0.15

−0.2

−0.25

−0.3

−0.35

 
0

100

200

300

400

 

pmax = 10
pmax = 15
pmax = 20
pmax = 30

500
Time

600

700

800

900

1000

Figure 2. Evolution of the free boundary in the classic Lasry and Lions
model in the case of equal market size distribution for diﬀerent computa-
tional domains Ω = [−pmax, pmax].

consider the three cases:

linear: bl(t) = cl

t

t + 1

quadratic: bl(t) = cl

t2 + 1

,

t2

exponential: bl(t) = cl(1 − exp(−t2))
,

(35)

with cl = 1.12345. The ﬂuctuations of the vendor market size distribution have the
respectively same form with cr = 1.0. Hence b∞l = cl and b∞r = 1. We start with
simulations in the case of diﬀerent initial masses of buyers and vendors. The initial datum
is given by FI (x) = 1x<0 − 0.9 × 1x>0. Figure 3 compares the theoretical long time
asymptotics based on the results of Theorem 4.3 and the numerical simulations. We
observe that the convergence rate of the functions bl and br towards their asymptotic
value determines the constant o(1) - the faster the convergence the closer the behavior
with respect to the theoretical predictions. The relative errors for the respective cases
in Figure 3b) illustrate the fast convergence of the free boundary, they decay like t− 1
2
(the inset in Figure 3(b) corresponds to the enlarged view of the price dynamics for small
times).

Next we consider the case αl = αr, that is the number of buyers and vendors converge
to the same long-time limit. Theorem 4.5 states that the long time asymptotic behavior
is driven by the ﬁrst order moments of the initial data. We choose the following initial
datum:

Furthermore we set

40
−20x
−60

FI (x) =

bl(t) = cl(1 − e−5t)

if x < −2,
if − 2 ≤ x ≤ 3,
if x > 3.

and

br(t) = cr(1 − e−5t)

with cl = log(1.1) + log(1.5) and cr = log(1.1). Note that the functions bl and br satisfy
Assumption (A3)(iv) and that the parameter choices imply αl = l∞M l
a = αr. The

a = r∞M r

18

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

3

2.5

2

1.5

1

0.5

 

3.5

3

2.5

2

1.5

1

0.5

Linear
Quadratic
Exponential
Theoretical behavior

0.8

0.6

0.4

0.2

0

 

 

1

2

3

4

5

Time t

6

7

8

9

10

Rel. err. linear
Rel. err. quadratic
Rel. err. exponential

0

 
0

20

40

60

80

100

Time t

120

140

160

180

200

0

0

20

40

60

80

100

Time t

120

140

160

180

200

(a) Evolution of the price.

(b) Relative error

Figure 3. Simulations in the case of deterministic ﬂuctuations (35) with
αl 6= αr.

0.25

0.2

0.15

0.1

0.05

 

Relative error
O(1/ exp(5t))

 

0.25

0.2

0.15

0.1

0.05

0

 
0

2

4

6

8

10

Time t

Simulated price dynamics
β2

12

14

16

18

20

0

 
0

2

4

6

8

10

Time t

12

14

16

18

20

(a) Evolution of the price

(b) Relative error

Figure 4. Simulations in the case of deterministic ﬂuctuations (35) with
αl = αr.

evolution of the price is depicted in Figure 4. We observe the expected long time behavior
towards the theoretically predicted constant β2, but the decay is diﬀerent. It decreases
like exp−5t, illustrated in Figure 4b), and not like t− 1

2 as in the case αl 6= αr.

5.3. Price evolution in the case of periodic market size ﬂuctuations. Next we
consider periodic ﬂuctuations in the buyer and vendor market sizes. First we choose
ﬂuctuations of the form

bl(t) = cos(2πflt) and br(t) = cos(2πfrt).

(36)

Figure 5 illustrates the behavior of the free boundary on the time interval t ∈ [0, 1] for dif-
ferent values of fl and fr, when the ratio fl\fr is rational. We observe that the maximum
amplitude of the computed price from the theoretical predictions decreases as ε → 0, an
observation also conﬁrmed in Table 1.

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

19

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

 

 = 10
f
 = 5, f
l
r
f
 = 10, f
 = 20
r
l
 = 50, f
f
 = 100
l
r
Theoretical behavior

0

 
0

0.05

0.1

0.15

0.2

Time t

0.25

0.3

0.35

0.4

Figure 5. Simulations in the case of periodic ﬂuctuations (36) with zero mean.

fl/fr

5/10

20/40
amplitude 0.1389 0.1018 0.0777

10/20

50/100
0.0538

Table 1. Maximum deviation of the free boundary from the theoretical
prediction due to periodic mass ﬂuctuations of the form (36) in case of a
rational fraction fl
fr

.

Note that the functions bl = bl(t) and br = br(t) are one-periodic with zero mean in the
ﬁrst example and bl(0) = br(0) = 1. To illustrate the impact of mass ﬂuctuations with
non-zero mean we choose functions bl and br of the form:

bl(t) = cos(πt)2 and br(t) = cos(2πt).

(37)

For this setting the corresponding evolution is illustrated in Figure 6 (using the same sim-
ulation parameters as in the previous example). Again we observe a very good agreement

(a) Evolution of the price

(b) Relative error

Figure 6. Simulations in the case of periodic ﬂuctuations (37) with non-
zero mean.

with the predicted theoretical price dynamics (based on the modiﬁed initial datum (33)),
even though they are based on formal arguments.

20

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

Finally we study the eﬀect of periodic mass ﬂuctuations on the free boundary. We choose
an initial datum with equal mass, that is FI (x) = 1x<0 − 1x>0 to clearly distinguish
the inﬂuence of the market size ﬂuctuations from the price dynamics due to the market
imbalance of buyers and vendors. The functions bl and br are set to

bl(t) = cos(πf t)2 and br(t) = sin(2πf t).

(38)

Table 2 states the computed amplitude and frequency for the diﬀerent values of f . Note
that mass oscillations of order O(1) amplitude result in O(ε)-amplitude ﬂuctuations in
the free boundary and that we have ’numerical’ strong convergence of the free boundary.

f

5

10

20

100

amplitude 0.1415 0.10446 0.075766 0.03982
frequency 4.8832
99.9456

20.142

9.766

Table 2. Frequency and amplitude of the price ﬂuctuations for diﬀerent
values of f .

5.4. Almost periodic market size ﬂuctuations. We would like to argue numerically
that the formal asymptotic for the periodic case, i.e. that the limiting dynamics of the
price correspond to the dynamics of the original Lasry-Lions model with a changed initial
buyer-vendor distribution (33), holds also in the case of Besicovitch almost periodic market
size ﬂuctuations, cf.
[2]. Note that the space of Besicovitch almost periodic functions
corresponds to the closure of the trigonometric polynomials under the seminorm

kfkB,p = lim sup

x→∞ (cid:18) 1

2xZ x

−x|f (s)|pds(cid:19) 1

p

.

These functions have an expansion of the form Pn aneiλnt with P a2

their mean value is deﬁned by

n ﬁnite and λn ∈ R;

We set

hfi := lim
T→∞

1

T Z T

0

f (s)ds.

(39)

bl(t) = sin(2πflt) + sin(2πfltp(2)) and br(t) = cos(2πfrt)

2

with integer frequencies fl and fr and choose an initial datum of the form FI (x) =
1x<0 − 1
1x≥0. Figure 7 illustrates the price dynamics for the time interval t ∈ [0, 1]
and the frequencies fl = fr = 1, 5, 10, 20, 40. The black line corresponds to the theoret-
ical prediction computed as in the periodic case, using the parameters hbli = hbri = 0,
bl(0) = 0 and br(0) = 1. As already explained we observe convergence of the price towards
the formal theoretical prediction in the periodic case, see (33). The numerical results
indicate also the validity of the formal asymptotics in the almost periodic case.

We would like to remark that it is diﬃcult to determine if the discrete price dynamics
are almost-periodic functions. Figure 7 shows the approximation of the price in the case
fl = fr = 10, which is based on the leading 100 FFT coeﬃcients of the discrete price.

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

21

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

 

f
 = 1
l
f
=5
l
f
 = 10
l
f
 = 20
l
f
 = 40
l

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

 
0

0.1

0.2

0.3

0.4

0.5

Time t

0.6

0.7

0.8

0.9

1

−0.2

 
0

0.1

0.2

0.3

0.4

 

Computed price
FFT approximation

0.5

Time t

0.6

0.7

0.8

0.9

1

(a) Price dynamics

(b) Approximation of the price dynamics
for fl = fr = 10.

Figure 7. Price dynamics in case of almost-periodic market size ﬂuctuations.

5.5. Price formation with stochastic market size ﬂuctuations. Finally we consider
the Lasry and Lions model (1) with stochastic ﬂuctuations in the numbers of buyers and
vendors, which we model by two independent Brownian motions Bl = Bl(t) and Br = Br(t)
replacing the deterministic functions bl = bl(t) and br = br(t) in Section 3. Since under
suﬃcient regularity conditions (such that Wong-Zakai type theorems for SPDEs hold,
see [26]) stochastic partial diﬀerential equations (SPDE) involving the Stratonovich inte-
gral are obtained in the limit (in probability) when Brownian motions are (reasonably)
approximated by smooth functions. We shall use the Stratonovich version of the Lasry and
Lions model following the common convention that ◦B denotes Stratonovich integration
against B.
Notice that the Stratonovich formulation is well deﬁned when the Ito integral is well de-
ﬁned and the integrand is a semimartingale. In our case this can be guaranteed due to
the special structure of the SPDE’s characteristics if suﬃciently regular initial values are
chosen. Also the Stratonovich correction term has a simple expression, since F 7→ |F| and
F 7→ F lead at least formally to the correction term 1/2F . In the sequel we do not enter
too much into the stochastic details but assume enough regularity for the initial values
such that our considerations hold true.

Here we discuss the well posedness of the equation, but leave a more reﬁned analysis, that
is of long term limits, for future research. As a matter of fact we show that the inﬂuence of
multiplicative stochastic market size ﬂuctuations on the price evolution is relatively weak.
Using the same transformation (4) as in the beginning of Section 3 we obtain the sto-
chastic equivalent of (10), in particular a heat equation with a multiplicative Lipschitz
non-linearity in the stochastic term:

dF (x, t) = Fxx(x, t)dt +

+

1
F (x, t) ◦ (σldBl + σrdBr)
2
1
2|F (x, t)| ◦ (σldBl − σrdBr).

We apply the transformation

V (x, t) = F (x, t)e−

σl Bl+σr Br

2

,

(40)

(41)

22

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

and obtain using the Stratonovich chain rule that

dV (x, t) = Vxx(x, t) +

1
2|V (x, t)| ◦ (σldBl − σrdBr).

The corresponding Ito equation is given by

dV (x, t) = Vxx(x, t)dt +

l + σ2
σ2
r

8

V (x, t)dt

+

1
2|V (x, t)|(σldBl + σrdBr).

Another exponential transformation

U (x, t) = V (x, t)e−

(σ2

l +σ2
r )
8

t

yields, since Bl(0) = Br(0) = 0,

dU (x, t) = Uxx(x, t)dt +

U (x, t = 0) = FI (x).

1
2|U (x, t)|(σldBl − σrdBr) in R × R+,

(42)

(43)

(44a)

(44b)

This equation can be analyzed by the DaPrato-Zabczyk methodology (see [9]), which
roughly speaking says that on every Hilbert space H of real valued functions on R where

(1) the map F → |F| is globally Lipschitz on H, and
(2) the one-dimensional Laplacian F 7→ Fxx generates a strongly continuous semigroup

S (appropriately closed) on H,

there exists a unique mild solution of the SPDE. This process (U (t))t≥0, indexed in time t
and taking values in H, satisﬁes, for every initial value F (0) ∈ H, the Duhamel formulation
(45)

U (t) = StU (0) +

1

St−s|U (s)|(σldBl(s) − σrdBr(s)).

2Z t

0

As usual we suppress the space (price) variable in this notation. The uniqueness of the
solution of (44) is understood in the Banach space of cadlag processes with norm

U 7→rE(cid:2) sup

0≤s≤T kU (s)k2(cid:3) .

Note that the form is not restricted to independent Brownian motions. In fact (45) can
be solved for any two dimensional semi-martingale driving process (Sl, Sr), in particular
also for L´evy processes; see Protter [23] and, Peszat and Zabczyk [22] for more information.

From (45) we conclude that U is given by the Feyman-Kac formula

2Z t
U (x, t) = EhFI (x + √2Wt) × exp(cid:0) 1

0

sign(U (x, s))(σldBl(s) − σ2dBr(s))(cid:1)i.

This representation formula is justiﬁed by approximating the Brownian motions by piece-
wise constant interpolations and an application of the classical Feynman-Kac formula.
Diﬀerentiating (45) with respect to x, we ﬁnd

Ux(t) = StUx(0) +

1

2Z t

0

St−s sign (U (s)) Ux(s) (σldBl(s) − σrdBr(s)) − t(σ2

l + σ2

r )/8 .

(46)

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

23

which then gives the Feynman-Kac representation namely

Ux(x, t) = EhFI,x(x + √2Wt)×
2Z t
× exp(cid:0) 1

0

(sign(U (x + √2Ws, s))σldBl(s) − sign(U (x + √2Ws, s))σrdBr(s)) − t(σ2

l + σ2

r )/8(cid:1)i

It is an easy consequence of this representation that for monotonically decreasing non-
constant initial data FI positivity of Ux(t) holds instantaneously for t > 0. This implies
that, for such initial data, there exists at most one zero x = p(t) of U (t) for every t > 0,
that is the free boundary cannot turn back or develop fat parts in ﬁnite time. By smooth-
ing the Brownian processes Bl and Br in (44) we conclude for general initial data FI that
the zero level set of the solution U is the graph limit of a sequence of functions of time.
This excludes in particular that the free boundary can turn back but it does not exclude
the formation of fat parts.

Although the main focus of this paper was the long time behavior of the free boundary we
conclude with a short heuristic calculation which illustrates why we cannot expect very
volatile dynamics in the case of Brownian drivers: we consider an (exponential) Euler step
for a short period of time denoted by t > 0. Let S denote the heat semigroup and E0,t
the random operator deﬁned for x ≤ p(t) by

(47a)

(47b)

and for x ≥ p(t) by

E0,tU (x) := U (x) exp(cid:0)σlBl(t) −
E0,tU (x) := U (x) exp(cid:0)σrBr(t) −

σ2
l t

2 (cid:1),
2 (cid:1).

σ2
r t

We evaluate the concatenation of these operators for a C 1 function U with precisely one
zero at p with U′(p) < 0 for small times t and for x close to p. We have

StE0,tU (x) =Z ∞

−∞

φ(y)(cid:0)1

+1

{x+√2ty≤p}
{x+√2ty≥p}

κlU′(p)(x + √2ty − p)+
κrU′(p)(x + √2ty − p)(cid:1)dy ,

where φ is the standard normal density and

For small times t we obtain

κl/r = κl/r(t) = exp(cid:0)σl/rBl/r(t) −
+ U′(p)(−κl + κr)√2tφ(x − p) ,

σ2
l/rt

2 (cid:1) .

StE0,tU (x) = U′(p)κl(x − p)Φ(x − p) + U′(p)κr(x − p)(1 − Φ(x − p))

which implies that for small times p(t) is of the form:

2(κr − κl)
√π(κr + κl)

√t + O(t) .

p(t) ≈ p +

(48)
This formula implies that we do actually observe √t asymptotics weighted with factors
stemming from κr − κl for small times as well. The asymptotics are also of order of magni-
tude √t due to the Brownian increments in the exponent. This implies that the increments
of the price process p(t) − p(0) are O(t) even in the presence of Brownian drivers, and
therefore of ﬁnite total variation for t 7→ p(t). Hence the price process does not admit a
martingale part, which implies that even proportional ﬂuctuations of buyers and vendors

24

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

0.05

0

-0.05

-0.1

-0.15

-0.2

-0.25

-0.3

-0.35

0

Price evolution

Simulation
Asymptotic analysis

0.2

0.4

Time t

0.6

0.8

1

Figure 8. Short-time asymptotics in case of stochastic market size ﬂuctuations

densities by independent Brownian motions do not lead to price curves as observed in
realistic markets.
On the other hand the short time asymptotics give a hint how to introduce “more” ran-
domness to obtain a martingale price process p. This is that the densities of the buyer
and vendor must be perturbed on small intervals of length t by multiplicative noises of
O(1). This, however, does not lead to the type of SPDE (45) originally proposed in this
section.
Numerical simulations. In the ﬁrst example we would like to conﬁrm the small time as-
ymptotic behavior of the free boundary p(t) given by (48). We start with an initial datum
of the form

FI (x) = −x,

and set σr = σl = 1. We use the domain Ω to [−10, 10] and run the simulation on the
time interval t ∈ [0, 1]. The spatial discretization corresponds to equidistant intervals of
size h = 10−3, while the time steps are set to ∆t = 10−5. At time t = 0.5 we choose two
independent normally distributed random numbers ∆B1, ∆B2 with standard deviation
√∆t and multiply the distribution left of the price with exp(∆B1 − ∆t/2) and the right
of the price with exp(∆B2 − ∆t/2). Figure 8 illustrates the small time asymptotics - the
initial price up to time t = 0.5 equals to zero due to the same total number of buyers and
vendors. Then the stochastic ﬂuctuations in the buyer and vendor density initiate a new
price dynamic, which conﬁrms the estimated behavior given by (48). We conclude with an
example illustrating the necessity to add “more” randomness to the model. We start with
an initial datum of the form FI (x) = 1x<0 − 1x>0 and time steps of ∆t = 10−5. At time
t = 0.25, 0.5 and t = 0.75 we multiply the right and left distribution by two independent
normally distributed random numbers ∆B1 and ∆B2 with standard deviation √∆tslow,
where ∆tslow denotes the slow time scale, that is ∆tslow = 0.25. The corresponding price
dynamics are depicted in Figure 9, which depicts a sequence of square-root like curves.
Each one evolves according to the estimated behavior discussed in this subsection.

We are grateful to Panagiotis Souganidis for generously sharing his ideas with us during
the course of this research and for helpinng us substantially in improving the presentation.

Acknowledgment

FB PRICE FORMATION MODELS WITH MARKET SIZE FLUCTUATIONS

25

Figure 9. Price evolution under ’slow scale’ market size ﬂuctuations

MTW acknowledges ﬁnancial support from the Austrian Academy of Sciences ¨OAW via
the New Frontiers Group NFG-001. PES was partially supported by the NSF.

References

[1] S. Angenent. The zero set of a solution of a parabolic equation. J. Reine Angew. Math, 390:79–96,

1988.

[2] A. S. Besicovitch. Almost periodic functions. Dover Publications, Inc., New York, 1955.
[3] M. Burger, L. Caﬀarelli, P. Markowich, and M.-T. Wolfram. On a Boltzmann-type price formation

model. Proc. R. Soc. A, 469(2157), 2013.

[4] M. Burger, L. Caﬀarelli, P. A. Markowich, and M.-T. Wolfram. On the asymptotic behavior of a

Boltzmann-type price formation model. Commun. Math. Sci., 12(7):1353–1361, 2014.

[5] M. Burger, A. Lorz, and M.T. Wolfram. On a Boltzmann mean ﬁeld model for knowledge growth.

Technical report, arxiv, submitted, 2015.

[6] L. A. Caﬀarelli, P. A. Markowich, and J.-F. Pietschmann. On a price formation free boundary model

by Lasry and Lions. C. R. Math. Acad. Sci. Paris, 349(11-12):621–624, 2011.

[7] L. A. Caﬀarelli, P. A. Markowich, and M.-T. Wolfram. On a price formation free boundary model by

Lasry and Lions: the Neumann problem. C. R. Math. Acad. Sci. Paris, 349(15-16):841–844, 2011.

[8] L. Chayes, M. del Mar Gonz´alez, M. P. Gualdani, and I. Kim. Global existence and uniqueness of

solutions to a model of price formation. SIAM J. Math. Anal., 41(5):2107–2135, 2009.

[9] G. Da Prato and J. Zabczyk. Stochastic equations in inﬁnite dimensions, volume 152 of Encyclopedia
of Mathematics and its Applications. Cambridge University Press, Cambridge, second edition, 2014.
[10] P. Degond, J.-G. Liu, and C. Ringhofer. Evolution of wealth in a non-conservative economy driven
by local Nash equilibria. Philosophical Transactions of the Royal Society of London A: Mathematical,
Physical and Engineering Sciences, 372(2028), 2014.

[11] P. Degond, J.-G. Liu, and C. Ringhofer. Large-scale dynamics of mean-ﬁeld games driven by local

Nash equilibria. Journal of Nonlinear Science, 24(1):93–115, 2014.

[12] B. D¨uring and G. Toscani. Hydrodynamics from kinetic models of conservative economies. Physica A:

Statistical Mechanics and its Applications, 384(2):493–506, 2007.

[13] E. Faou. Analysis of splitting methods for reaction-diﬀusion problems using stochastic calculus. Math-

ematics of Computation, 78(267):1467–1483, 2009.

[14] V. A. Galaktionov. Geometric Sturmian theory of nonlinear parabolic equations and applications.
Chapman & Hall/CRC Applied Mathematics and Nonlinear Science Series, 3. Chapman & Hall/CRC,
Boca Raton, FL, 2004.

[15] M. del Mar Gonz´alez and M. P. Gualdani. Asymptotics for a symmetric equation in price formation.

Appl. Math. Optim., 59(2):233–246, 2009.

[16] A. Lachapelle, J.M. Lasry, C.A. Lehalle, and P.-L. Lions. Eﬃciency of the price formation process in
presence of high frequency participants: a mean ﬁeld game analysis. arXiv preprint arXiv:1305.6323,
2013.

26

P.A. MARKOWICH, J. TEICHMANN AND M.T. WOLFRAM

[17] J.M. Lasry and P.-L. Lions. Mean ﬁeld games. Jpn. J. Math., 2(1):229–260, 2007.
[18] P. A. Markowich, N. Matevosyan, J.-F. Pietschmann, and M.-T. Wolfram. On a parabolic free bound-

ary equation modeling price formation. Math. Models Methods Appl. Sci., 19(10):1929–1957, 2009.

[19] M. O’Hara. Market microstructure theory, volume 108. Blackwell Cambridge, MA, 1995.
[20] L. Pareschi and G. Toscani. Interacting Multiagent Systems: Kinetic equations and Monte Carlo

methods. OUP Oxford, 2013.

[21] L. Pareschi and G. Toscani. Wealth distribution and collective knowledge: a Boltzmann approach.
Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences,
372(2028):20130396, 2014.

[22] S. Peszat and J. Zabczyk. Stochastic partial diﬀerential equations with L´evy noise, volume 113 of
Encyclopedia of Mathematics and its Applications. Cambridge University Press, Cambridge, 2007. An
evolution equation approach.

[23] P. E. Protter. Stochastic integration and diﬀerential equations, volume 21 of Stochastic Modelling
and Applied Probability. Springer-Verlag, Berlin, 2005. Second edition. Version 2.1, Corrected third
printing.

[24] G. Toscani. Kinetic models of opinion formation. Communications in Mathematical Sciences, 4(3):481–

496, 2006.

[25] G. Toscani, C. Brugna, and S. Demichelis. Kinetic models for the trading of goods. Journal of Statis-

tical Physics, 151(3-4):549–566, 2013.

[26] N. Toshiyuki. Support theorem for mild solutions of SDE’s in Hilbert spaces. J. Math. Sci. Univ.

Tokyo, 11(3):245–311, 2004.

4700 King Abdullah University of Science and Technology, Thuwal 23955-6900, Kingdom

of Saudi Arabia

Department of Mathematics, ETH Z¨urich, R¨amistr. 101, 8092 Z¨urich, Switzerland

Mathematics Institute, University of Warwick, Coventry CV4 7TL, UK and Radon In-
stitute for Computational and Applied Mathematics, Austrian Academy of Sciences, Al-
tenbergerstr. 69, 4040 Linz, Austria. m.wolfram@warwick.ac.uk

