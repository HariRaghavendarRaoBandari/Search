6
1
0
2

 
r
a

M
9

 

 
 
]
T
R
h
t
a
m

.

[
 
 

1
v
8
7
7
2
0

.

3
0
6
1
:
v
i
X
r
a

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

HIDEYA WATANABE AND SATOSHI NAITO

Abstract. In 1980, Lusztig introduced the periodic Kazhdan-Lusztig polynomials, which are conjectured to
have important information about the characters of irreducible modules of a reductive group over a ﬁeld of
positive characteristic, and also about those of an aﬃne Kac-Moody algebra at the critical level. The periodic
Kazhdan-Lusztig polynomials can be computed by using another family of polynomials, called the periodic
R-polynomials. In this paper, we prove a (closed) combinatorial formula expressing periodic R-polynomials in
terms of the “doubled” Bruhat graph associated to a ﬁnite Weyl group and a ﬁnite root system.

1. Introduction

In [KL], Kazhdan and Lusztig introduced a family {Py,w(q)}y,w∈W of polynomials, which are called the
Kazhdan-Lusztig polynomials, for an arbitrary Coxeter system (W, S). It is well-known that these polynomials
have important representation-theoretic and geometric meanings. For example, it is known that the Kazhdan-
Lusztig polynomials associated to a ﬁnite Weyl group describe the intersection cohomology of Schubert varieties.
More precisely, let G be a complex semisimple algebraic group, B a Borel subgroup of G, and W the associated
(ﬁnite) Weyl group. Then the ﬂag variety X = G/B admits a decomposition (Bruhat decomposition)

X = Gw∈W

BwB/B.

For each w, let Xw denote the closure (with respect to the Zariski topology) of Cw := BwB/B in X; the Xw’s
are called the Schubert varieties. Then the Kazhdan-Lusztig polynomial Py,w(q) for y, w ∈ W is identical to
the Poincar´e polynomial

dim IH2i

Cy (Xw) qi;

Xi≥0

here, IH2i(Xw) denotes the 2i-th intersection cohomology sheaf on Xw, and IH2i
Cy (Xw) is its stalk at a point
of Cy. This equation also shows that the Kazhdan-Lusztig polynomials associated to an arbitrary ﬁnite Weyl
group have no negative coeﬃcients.

About the representation-theoretic side, we know that the Kazhdan-Lusztig polynomials describe the mul-
tiplicities of Verma modules in simple modules. Namely, let g be a ﬁnite-dimensional complex semisimple Lie
algebra, W its (ﬁnite) Weyl group, P the weight lattice of g, and P+ the set of dominant integral weights. It
is known that each ﬁnite-dimensional simple g-module is isomorphic to the unique simple quotient L(µ) of the
Verma module V (µ) for some µ ∈ P . Kazhdan and Lusztig conjectured that for λ ∈ P+ and w ∈ W , there
holds the equality

chL(w ◦ λ) = Xy∈W

(−1)ℓ(y,w)Py,w(1) chM (y ◦ λ),

where ℓ : W → Z≥0 denotes the length function on W , ℓ(y, w) := ℓ(w) − ℓ(y), and W acts on P by the
so-called dot (or shifted) action. This conjecture was proved independently by Beilinson-Bernstein [BeBe] and
Brylinski-Kashiwara [BK].

In the proof of the existence of the Kazhdan-Lusztig polynomials, another family of polynomials {Ry,w(q)}y,w∈W ,

which we call the R-polynomials, play a key role. The Kazhdan-Lusztig polynomials and the R-polynomials are

2010 Mathematics Subject Classiﬁcation. Primary 20F55; Secondary 20C08, 05E10, 05E15.
Key words and phrases. periodic Kazhdan-Lusztig polynomials, periodic R-polynomials, generic Bruhat order.

1

2

H. WATANABE AND S. NAITO

related by the following equation:

(1)

qℓ(y,w)P y,w(q) − Py,w(q) = Ry,w(q) + Xy<z<w

Ry,z(q)Pz,w(q) for y, w ∈ W.

Here, < denotes the Bruhat order on W , and f (q) = f (q−1) for f (q) ∈ Z[q, q−1]. Therefore, determining the
Kazhdan-Lusztig polynomials is equivalent to determining the R-polynomials. As for the R-polynomials, Dyer
proved the following combinatorial formula (in the notation of [BjBr, Chap. 5]).

Theorem 1.0.1 ([D, (3.4) Corollary], [BjBr, Theorem 5.3.4.]). Let < be a refection order on the set Φ+ of
positive roots of an arbitrary ﬁnite Weyl group W . For y, w ∈ W , let B<(y, w) be the set of all sequences ∆ =
(y, ysβ1, ysβ1sβ2, . . . , ysβ1sβ2 · · · sβℓ(∆) = w) of elements of W such that y < ysβ1 < . . . < ysβ1 · · · ysβℓ(∆) = w
and β1 < · · · < βℓ(∆), where for β ∈ Φ+, sβ denotes the reﬂection with respect to β ∈ Φ+. Then, we have

Ry,w(q) = X∆∈B<(y,w)

q

1

2(cid:0)ℓ(y,w)−ℓ(∆)(cid:1)(q − 1)ℓ(∆).

Remark 1.0.2. Dyer proved Theorem 1.0.1 in a more general setting of an arbitrary Coxeter group.

Also, in [L], Lusztig introduced a family {Qy,w(q)}y,w∈Waf of polynomials; here, Waf is the aﬃne Weyl group.
We call the Qy,w(q)’s the periodic Kazhdan-Lusztig polynomials. These polynomials are also conjectured to
have some representation-theoretic meaning. Let G be a reductive group over a ﬁeld of characteristic p ≫ h,
where h denotes the Coxeter number for the associated root system. By ﬁxing a maximal torus of G, we denote
its character group by X, and set

X+ := {λ ∈ X | λ(α∨) ≥ 0 for all simple coroots α∨} (the set of dominant weights),
X0 := {λ ∈ X | 0 < λ(α∨) < p for all simple coroots α∨}.

Then, Lusztig’s conjecture is the following:

Conjecture 1.0.3. Let w ∈ Waf , and let λ ∈ X+ be such that w ◦ λ ∈ X0. Then,

chL(w ◦ λ) = Xx∈Waf

x◦λ∈X0

(−1)ℓ(x,w)Px,w(1) chV (x ◦ λ),

where V (x ◦ λ) denotes the Weyl module of G with simple head L(x ◦ λ).

In addition, it is proved in [K] that Lusztig’s conjecture is equivalent to the equality:

chL(w ◦ λ) = Xx∈Waf

Qx,w(1) chV (x ◦ λ).

There is another conjecture concerning periodic Kazhdan-Lusztig polynomials, called the Feigin-Frenkel
conjecture. Let gaf be an aﬃne Kac-Moody algebra, haf its Cartan subalgebra, and Waf the associated aﬃne
Weyl group. For each λ ∈ h∗
af , let ∆(λ) denote the Verma module with highest weight λ over gaf . Then, the
restricted Verma module ∆(λ) is deﬁned to be the quotient module of ∆(λ) by a certain ideal of the Feigin-
Frenkel center (see [AF, §1.4] for details). Also, let L(λ) denote the irreducible quotient of ∆(λ). Now, the
Feigin-Frenkel conjecture is the following:

Conjecture 1.0.4. Let λ ∈ h∗
element of gaf and ρ ∈ h∗
dominant in the sense of [AF, §1.5]. Then,

af be a weight at the critical level, i.e., λ(K) = −ρ(K), where K is the central
af is regular and

af is the Weyl vector, and let y, w ∈ Waf . We also assume that λ ∈ h∗

where [∆(w ◦ λ) : L(y ◦ λ)] denotes the Jordan-H¨older multiplicity of L(y ◦ λ) in ∆(w ◦ λ).

When one considers the periodic Kazhdan-Lusztig polynomials, the role of the R-polynomials is replaced by

[∆(w ◦ λ) : L(y ◦ λ)] = Qy,w(1),

the periodic R-polynomials {Ry,w(q)}y,w∈Waf . Namely, Lusztig ([L, (7.3.1)]) proved that for y, w ∈ Waf ,

(2)

qℓ

2 (y,w)Qy,w(q) − Qy,w(q) = (−q)ℓ

∞

∞

2 (y,w)Ry,w(q) + Xy< ∞

2

z< ∞
2

∞

(−q)ℓ

2 (y,z)Ry,z(q)Qz,w(q);

w

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

3

∞

∞

∞

∞

2 denotes the semi-inﬁnite length, ℓ

here, ℓ
the semi-inﬁnite Bruhat order
(deﬁned later). Roughly speaking, arguments in the periodic case are parallel to those in the ordinary case if
one replaces the ordinary length and Bruhat order by the semi-inﬁnite length and semi-inﬁnite Bruhat order,
respectively. From this point of view, equation (2) seems to be diﬀerent from the equation obtained from
equation (1) by replacing P , R, ℓ, and < by Q, R, ℓ
, respectively. However, these two actually
agree because

2 (y), and < ∞

2 (y, w) := ℓ

2 , and < ∞

2 (w) − ℓ

∞

2

2

Ry,w(q) = (−q)ℓ(y,w)Ry,w(q).

for y, w ∈ Waf (see, for example, [BjBr, Chap. 5, Exerc. 1]).

The periodic R-polynomials can also be thought of as a generalization of the ordinary R-polynomials in the

following sense: if y, w ∈ W (and if we regard the ﬁnite Weyl group W as a subgroup of Waf ), then

Ry,w(q) = Ry,w(q).

Hence the periodic Kazhdan-Lusztig polynomials can be regarded as a generalization of the ordinary Kazhdan-
Lusztig polynomials in the following sense: if y, w ∈ W , then

Qy,w(q) = Py,w(q).

The purpose of this paper is to give a (closed) combinatorial formula expressing periodic R-polynomials,
which generalizes Theorem 1.0.1 in the following sense: if one applies our formula to elements of a ﬁnite Weyl
group, then it agrees with the one in Theorem 1.0.1. Namely, we prove the following theorem:

Theorem 1.0.5. Let y, w ∈ Waf . Then we have

Ry,w(q) = X∆∈P <(y,w)

qdeg(∆)(q − 1)ℓ(∆);

here, P <(y, w) consists of sequences ∆ = (y = y0 −→
β1

y1 −→
β2

· · · −−−→
βℓ(∆)

yℓ(∆) = w) such that y = y0 < ∞

2

· · · < ∞

2

yℓ(∆) = w, β1 < · · · < βℓ(∆), and some additional conditions (see Deﬁnition 2.4.2 for details).

If y, w ∈ W , then P <(y, w) agrees with B<(y, w) (in Theorem 1.0.1), and for each ∆ ∈ P <(y, w) = B<(y, w),
we obtain deg(∆) = 1
2 (ℓ(y, w)−ℓ(∆)). We prove Theorem 1.0.5 by constructing explicit bijections between (spe-
ciﬁc subsets of) P <(y, w), y, w ∈ Waf . In particular, we construct explicit bijections B<(sy, sw) ⊔ B<(sy, w) →
B<(y, w) for all y, w ∈ W, s ∈ S such that y < sy, sw < w, and bijections B<(sy, sw) → B<(y, w) for all
y, w ∈ W, s ∈ S such that sy < y, sw < w, where S denotes the set of simple reﬂections for W . We remark
that this also gives a new proof of Theorem 1.0.1.

This paper is organized as follows. In Section 2, we ﬁx our notation and recall the notions and basic properties
of aﬃne root systems, reﬂection orders, semi-inﬁnite Bruhat order, R-polynomials, and periodic R-polynomials.
Also, we state our main result (Theorem 2.4.4). Section 3 is devoted to the preparation for the proof of
Theorem 2.4.4. In Section 4, we complete the proof of Theorem 2.4.4. In Section 5, we introduce a directed
graph, which we call the double Bruhat graph, in order to describe Theorem 2.4.4 in a way more suitable for
actual computation.

In this section, we ﬁx our notation and state our main result (Theorem 2.4.4).

2. Setting and the main result

2.1. Aﬃne root systems and aﬃne Weyl groups. Let g be a ﬁnite-dimensional, complex simple Lie algebra
of rank l, and h a Cartan subalgebra of g. We denote by Φ ⊂ h∗ the set of roots of g with respect to h, by
Π = {α1, . . . , αl} a set of simple roots, by Φ+ the set of positive roots with respect to Π, and by {α∨
l } ⊂ h
the set of simple coroots. Also, we denote by h , i : h∗ × h → C the duality pairing. For each α ∈ Φ, let α∨ ∈ h
i , and let P ∨ = {µ ∈
+ = {µ ∈ P ∨ | hαi, µi ≥ 0 for all i = 1, . . . , l}

denote the coroot of α. Let Q∨ =Pl

h | hαi, µi ∈ Z for all i = 1, . . . , l} be the coweight lattice, with P ∨
the set of dominant coweights.

i be the coroot lattice, with Q∨

+ =Pl

i=1 Z≥0α∨

1 , . . . , α∨

i=1 Zα∨

4

H. WATANABE AND S. NAITO

Let W denote the (ﬁnite) Weyl group of g, with S = {s1, . . . , sl} the set of simple reﬂections. Then W and

Q∨ act on h on the left: for each i = 1, . . . , l, λ ∈ Q∨, and µ ∈ h,

si · µ = µ − hαi, µiα∨
i ,

tλ · µ = µ + λ,

where tλ is the image of λ ∈ Q∨ in the group Aut(h) of all aﬃne transformations on h. Since these actions are
faithful, we can regard W and Q∨ as subgroups of Aut(h). Also, let θ ∈ Φ+ denote the highest root, and set
s0 = sθt−θ∨ ∈ Aut(h), where sθ is the reﬂection with respect to θ. Then, Saf := {s0, s1, . . . , sl} generate the
aﬃne Weyl group Waf ≃ W ⋉ Q∨.

Now, let gaf := g ⊗ C[t, t−1] ⊕ CK ⊕ CD be the aﬃne Lie algebra associated to g, where K is the canonical

central element; the corresponding Cartan subagebra is

haf := h ⊕ CK ⊕ CD.

We extend the duality pairing h , i : h∗ × h → C to the duality pairing h , i : h∗
hh∗, CK ⊕ CDi = 0. Let δ ∈ h∗

af be the element deﬁned by

af × haf → C in such a way that

hδ, h ⊕ CKi = 0,
hδ, Di = 1.

af,+ of positive real roots of gaf can be written as Φre

Then, the set Φre
mδ | α ∈ Φ+, m ∈ Z>0}, and the set Φre
is {α0, α1, . . . , αl}, where α0 = −θ + δ. For each β ∈ Φre

af of real roots is Φre

af ,+ ⊔ (−Φre

af,+ = {α + mδ | α ∈ Φ+, m ∈ Z≥0} ⊔ {−α +
af,+). Also, the set of simple roots of gaf

af , let β∨ ∈ haf denote the coroot of β.

For each α ∈ Φ+ and m ∈ Z, let Fα,m ⊂ hR := R ⊗Z Q∨ be the hyperplane deﬁned by

Fα,m = {µ ∈ hR | hα, µi = m}.

With this notation, the reﬂection sβ ∈ Waf corresponding to a positive real root β = ±α + mδ ∈ Φre

reﬂection ﬁxing the hyperplane Fα,±m pointwise. An alcove is a connected component of hR\(Sα∈Φ+,m∈Z Fα,m).

The set A− := {λ ∈ hR | −1 < hα, λi < 0 for all α ∈ Φ+} is an alcove. It is known that the action of Waf
on h∗ deﬁned above induces a transitive and faithful action of Waf on the set of alcoves, that is, the map
w := cl(w)twt(w) 7→ A− · w := cl(w)−1A− + wt(w) is a bijection between Waf and the set of alcoves, where
cl(w) ∈ W, wt(w) ∈ Q∨. Through this bijection, we sometimes identify these two sets.

af,+ is the

For i = 1, . . . , l (resp., i = 0), the i-wall of A− is deﬁned to be the intersection of the hyperplane Fαi,0 (resp.,
Fθ,−1) and the closure A− of A−. The i-wall of an alcove A is the unique element of the orbit of the i-wall of
A− under the action of Waf that is contained in the closure A of A.

2.2. The semi-inﬁnite Bruhat order. The ﬁnite Weyl group W and the aﬃne Weyl group Waf are equipped
with a partial order <, which is known as the Bruhat order. Following [L], we introduce another partial order
on Waf , which we call the semi-inﬁnite Bruhat order. First, for each α ∈ Φ+ and m ∈ Z, we divide hR into
< ∞
2
three parts:

hR = F −

α,m ⊔ Fα,m ⊔ F +

α,m,

where F ±
α,m = {µ ∈ hR | ±(hα, µi − m) > 0}. Next, to each pair (A, B) of alcoves, we associate an integer
d(A, B) ∈ Z as follows. Let (A = A0, A1, . . . , Ar = B) be a sequence of alcoves such that Ai−1 and Ai have
a unique common wall for each i; there exists a unique βi ∈ Φ+ and mi ∈ Z such that Fβi,mi contains the
common wall. Then we deﬁne d(A, B) by:

d(Ai−1, Ai),

d(A, B) =

rXi=1
d(Ai−1, Ai) =(1

−1

if Ai ⊂ F +
if Ai ⊂ F −

βi,mi

βi,mi

(or equivalently, Ai−1 ⊂ F −
(or equivalently, Ai−1 ⊂ F +

βi,mi

βi,mi

),
).

For y, w ∈ Waf , we set ℓ
simply write ℓ
2 (e, w) = ℓ
ℓ

2 (w) − ℓ

2 (y).

∞

∞

∞

∞

2 (y, w) := d(A− · y, A− · w).
2 (w) and call it the semi-infnite length of w. By deﬁnition, we have ℓ

In particular, when y is the identity element e, we
2 (y, w) =

∞

∞

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

5

Example 2.2.1. In type A2:

tα∨
2

tθ∨

s1s2 w0

s2

s2s1

e

s1

tα∨
1

s0

2

4

2

3

1

2

0

1

2

−1

Figure 1. alcoves and elements of Waf

Figure 2. semi-inﬁnite lengths

Finally, we deﬁne the partial order < ∞
2

on Waf as follows:

for y, w ∈ Waf , we write y < ∞

2

w if there
af,+ and

exists a sequence (y = y0, y1, . . . , yr = w) of elements of Waf such that yi = yi−1sβi for some βi ∈ Φre
ℓ

w, then ℓ

2 (y) < ℓ

2 (w).

∞

∞

∞

2 (yi−1, yi) > 0 for each 1 ≤ i ≤ r. Note that if y < ∞
Let C+ denote the dominant Weyl chamber:

2

C+ = {µ ∈ hR | hαi, µi > 0 for all i = 1, . . . , l}.

About the semi-inﬁnite Bruhat order and the semi-inﬁnite length, we know the following.

Proposition 2.2.2 ([P, Lecture 13]).

(1) Let w = cl(w)twt(w) ∈ Waf (cl(w) ∈ W, wt(w) ∈ Q∨). Then

ℓ

∞

2 (w) = ℓ(cl(w)) + 2hρ, wt(w)i, where ρ is half the sum of positive roots of g.

(2) Let y, w ∈ Waf . Then y < ∞

2

C+.

w if and only if ytλ < wtλ for some λ ∈ Q∨

+ such that A− · ytλ, A− · wtλ ⊂

Lemma 2.2.3 ([P, Lecture 13, Proposition 1]). Let w ∈ Waf and µ ∈ Q∨

+. Then we have

w < ∞
2

wtµ.

Proof. It suﬃces to show the assertion when µ is a simple coroot, that is, when µ = α∨
i
We write w = cl(w)twt(w). Assume ﬁrst that cl(w) < cl(w)si. Then, we have

for some i = 1, . . . , l.

cl(w)sitwt(w) = cl(w)tsi (wt(w))si = cl(w)twt(w)−hαi,wt(w)iα∨

si
= cl(w)twt(w)sithαi,wt(w)iα∨

i

i

= wsαi+hαi,wt(w)iδ,

and

ℓ

∞

2 (cl(w)sitwt(W )) = ℓ(cl(w)si) + 2hρ, wt(w)i = ℓ(cl(w)) + 1 + 2hρ, wt(w)i = ℓ

∞

2 (w) + 1.

Therefore, we obtain w < ∞

2

cl(w)sitwt(w). Furthermore, we have

wtα∨

i

= cl(w)sisitwt(w)+α∨

i

= cl(w)sitwt(w)sit(hαi,wt(w)i+1)α∨

i

= cl(w)sitwt(w)sαi+(hαi,wt(w)i+1)δ,

and

ℓ

∞

2 (wtα∨

i

) = ℓ(cl(w)) + 2hρ, wt(w) + α∨

i i = ℓ(cl(w)) + 2hρ, wt(w)i + 2

= ℓ

∞

2 (w) + 2 = ℓ

∞

2 (cl(w)sitwt(w)) + 1.

From these, we deduce that cl(w)sitwt(w) < ∞

2

wtα∨

i

, and hence

w < ∞

2

wtα∨

i

.

Also, we obtain cl(w)sitwt(w) < ∞
implies the assertion when cl(w)si < cl(w). This proves the lemma.

cl(w)sitwt(w)+α∨

, since wtα∨

2

i

i

= cl(w)twt(w)+α∨

i

< ∞

2

cl(w)sitwt(w)+α∨

i

. This
(cid:3)

6

H. WATANABE AND S. NAITO

Lemma 2.2.4 ([P, Lecture 13, Proposition 2]). Let w = cl(w)twt(w) ∈ Waf , and β = α + mδ ∈ Φre
ℓ

2 (sβw) if and only if cl(w)−1(α) ∈ Φ+.

2 (w) < ℓ

∞

∞

af ,+. Then,

Proof. By direct calculation, we see that

sβw = cl(w)scl(w)−1(β)twt(w)

= cl(w)scl(w)−1(α)twt(w)+mcl(w)−1(α∨).

Hence it follows that

∞

2 (sβw) − ℓ

ℓ

∞

2 (w) = ℓ(cl(w)scl(w)−1(α)) + 2hρ, λ(w) + mcl(w)−1(α∨)i − (ℓ(cl(w)) + 2hρ, wt(w)i)

= ℓ(cl(w)scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i.

We ﬁrst prove the “only if” part. Assume that ℓ

∞

2 (w) < ℓ

∞

2 (sβw) and cl(w)−1(α) ∈ −Φ+. Then ℓ(scl(w)−1(α)) ≤

−2hρ, cl(w)−1(α∨)i − 1, and

0 < ℓ

∞

2 (sβw) − ℓ

∞

2 (w) = ℓ(cl(w)scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i

≤ ℓ(cl(w)) + ℓ(scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i
≤ −2hρ, cl(w)−1(α∨)i − 1 + 2mhρ, cl(w)−1(α∨)i
< 2(m − 1)hρ, cl(w)−1(α∨)i.

This implies that m = 0 since hρ, cl(w)−1(α∨)i < 0. Therefore, α = β ∈ Φre
follows that

af ,+, and hence α ∈ Φ+. Hence it

∞

2 (sβw) − ℓ

ℓ

∞

2 (w) = ℓ(sαcl(w)) − ℓ(cl(w)) < 0

(since α ∈ Φ+ and cl(w)−1(α) ∈ Φ+),

which is a contradiction.

Next we prove the “if” part. Assume that cl(w)−1(α) ∈ Φ+. From the above, we have

∞

2 (sβw) − ℓ

ℓ

∞

2 (w) = ℓ(cl(w)scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i;

note that hρ, cl(w)−1(α∨)i > 0. If α ∈ Φ+, then cl(w)scl(w)−1(α) = sαcl(w) > cl(w), and hence ℓ
ℓ

2 (w) > 0. If α ∈ −Φ+, then m > 0 and hence

∞

∞

2 (sβw) −

∞

2 (sβw) − ℓ

ℓ

∞

2 (w) = ℓ(cl(w)scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i

≥ ℓ(cl(w)) − ℓ(scl(w)−1(α)) − ℓ(cl(w)) + 2mhρ, cl(w)−1(α∨)i
≥ −2hρ, cl(w)−1(α∨)i + 1 + 2mhρ, cl(w)−1(α∨)i
= 2(m − 1)hρ, cl(w)−1(α∨)i + 1 > 0,

as desired. This proves the lemma.

(cid:3)

2.3. R-polynomials and periodic R-polynomials. Let H be the Hecke algebra of W , and Haf the Hecke
algebra of Waf , that is, H (resp., Haf ) is the associative algebra over Z[q, q−1] generated by {Ts | s ∈ S} (resp.,
{Ts | s ∈ Saf}) subject to the braid relations and the Hecke relation

T 2
s = q + (q − 1)Ts for s ∈ S (resp., s ∈ Saf ).

), where si1 · · · sik is a
For each x ∈ W (resp., w ∈ Waf ), we set Tx = Tsi1
reduced expression for x (resp., w). Let ¯ : H → H (resp., ¯ : Haf → Haf ) denote the involutive Z-algebra
automorphism that sends q to q−1 and Ts to T −1
Deﬁnition 2.3.1. Let u, v ∈ W . Then, the R-polynomial Ru,v(q) ∈ Z[q, q−1] is deﬁned by

s = q−1Ts + (q−1 − 1).

(resp., Tw = Tsi1

· · · Tsik

· · · Tsik

T v = q−ℓ(v) Xu∈W

(−1)ℓ(u,v)Ru,v(q)Tu.

It follows from the next proposition that Ru,v(q) is, in fact, an element of Z[q] of degree ℓ(u, v).

Proposition 2.3.2 ([BjBr, 5.3], [H2, 7.5]). The R-polynomials are uniquely determined by the following equa-
tions.

(1) Rv,v(q) = 1 for all v ∈ W .

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

7

(2) Ru,v(q) = 0 unless u ≤ v (u, v ∈ W ).

(3) Ru,v(q) =(Rsu,sv(q)

qRsu,sv(q) + (q − 1)Ru,sv(q)

for all u, v ∈ W and all s ∈ S.

Also, equation (3) can be replaced by

(3′) Ru,v(q) =(Rut,vt(q)

qRut,vt(q) + (q − 1)Ru,vt(q)

if sv < v and su < u,
if sv < v and u < su,

if vt < v and ut < u,
if vt < v and u < ut,

for all u, v ∈ W and all t ∈ S.

Now, following [K] (see also [L]), we deﬁne the periodic R-polynomials. For each λ ∈ Q∨, there exists

µ ∈ Q∨ ∩ P ∨

+ such that λ + µ ∈ Q∨ ∩ P ∨

+ . Then we set

it is known that this deﬁnition of X λ is independent of the choice of µ. Also, for each w = cl(w)twt(w)
(cl(w) ∈ W, wt(w) ∈ Q∨), we set

X λ := Ttλ+µT −1

tµ ∈ Haf ;

eTw := Tcl(w)X wt(w).

Then, {eTw | w ∈ Waf } forms a basis of Haf . With respect to this basis, we enlarge Haf as follows. We set

dHaf :=( Xw∈Waf

aweTw | {w ∈ Waf | aw 6= 0} is bounded from above) ,

where a subset Y ⊂ Waf is said to be bounded from above if there exists w ∈ Waf such that y < ∞

w for all

such that

y ∈ Y ; note that dHaf is no longer an algebra, but is still a left Haf -module.
Theorem 2.3.3 ([K, Proposition 2.8]). There exists a unique involutive Z-linear automorphism Ψ :dHaf →dHaf
(h ∈ Haf , m ∈dHaf ),
2 (w0tλ) Xx∈W eTxtλ

Ψ(cid:16)Xx∈W eTxtλ(cid:17) = q−ℓ

Ψ(h · m) = h · Ψ(m)

(λ ∈ Q∨).

Here, w0 ∈ W denotes the longest element.

and

∞

2

Deﬁnition 2.3.4. Let y, w ∈ Waf . Then the periodic R-polynomial Ry,w(q) is deﬁned by

Ψ(eTw) = q−ℓ

∞

2 (w) Xy∈Waf

(−1)ℓ

∞

2 (y,w)Ry,w(q)eTy.

It follows from the next proposition that Ry,w(q) is, in fact, an element of Z[q] of degree ℓ

∞

2 (y, w).

Proposition 2.3.5 ([L, Proposition 11.1]). The periodic R-polynomials are uniquely determined by the following
equations.

(R1) Rw,w(q) = 1 for all w ∈ Waf .
(R2) Ry,w(q) = 0 unless y < ∞

(R3) Ry,w(q) =(Rsy,sw(q)

for all y, w ∈ Waf and all s ∈ Saf .

(R4)

qRsy,sw(q) + (q − 1)Ry,sw(q)

w (y, w ∈ Waf ).

2

if sw < ∞
if sw < ∞

2

2

w and sy < ∞
w and y < ∞

2

y,
sy,

2

∞

(−1)ℓ

2 (y,xtλ)qℓ(xw0)Ry,xtλ(q) = δλ,λ(y)

for all λ ∈ Q∨, y ∈ Waf .

Xx∈W

8

H. WATANABE AND S. NAITO

Remark 2.3.6. Equation (R4) is equivalent to the second equation in Theorem 2.3.3:

Ψ(cid:16)Xx∈W eTxtλ(cid:17) = q−ℓ

∞

2 (w0tλ) Xx∈W eTxtλ

(λ ∈ Q∨).

2.4. Main result. In this subsection, we recall the notion of reﬂection orders and state our main result of this
paper.

Deﬁnition 2.4.1. A total order < on Φ+ (resp., Φre

af,+) is called a reﬂection order if it satisﬁes the following:

if a, b ∈ R>0, α, β, aα + bβ ∈ Φ+ (resp., Φre

af ,+) and α < β, then α < aα + bβ < β.

In the following, we take and ﬁx a reﬂection order < on Φ+.

Deﬁnition 2.4.2. Let y = cl(y)twt(y), w = cl(w)twt(w) ∈ Waf , and β ∈ Φ+.

(1) We write y m−→

2

w if either w = ytmβ∨ for some m ∈ Z>0, or w = cl(y)sβtwt(y)+mβ∨ for some m ∈ Z≥0

β
and y < ∞
w. In the former case, y and w diﬀer only by a translation, and in the latter case, w is
obtained from y by multiplying the reﬂection sβ+(m+hβ,wt(y)i)δ on the right, where β + (m + hβ, wt(λ)i)δ
is a (not necessarily positive) real root; we call an arrow y m−→
w of the former type a translation edge,
and one of the latter type a reﬂection edge. To each edge y m−→

w, we assign an integer d(y m−→

w) as

β

β

β

follows:

d(y m−→

β

w) =

1
2 ℓ
1

2(cid:0)ℓ
2(cid:0)ℓ

1

∞

2 (y, w) + m

∞

∞

2 (y, w) + 1(cid:1) + m
2 (y, w) − 1(cid:1) + m

m1−−→
β1

m2−−→
β2

· · · mk−−→
βk

if w = ytmβ∨,
if w = cl(y)sβtwt(y)+mβ∨ and cl(y) < cl(y)sβ,
if w = cl(y)sβtwt(y)+mβ∨ and cl(y)sβ < cl(y).

(2) A label-increasing path of length k from y to w with respect to the reﬂection order < is a sequence
yk = w) of elements of Waf and arrows such that β1 < · · · < βk; we

∆ = (y = y0

y1

simply call this a path from y to w. The length k of a path ∆ is denoted by ℓ(∆). Also, we denote by
P <(y, w) the set of all paths from y to w.

Let ∆ = (y = y0

m1−−→
β1

y1

m2−−→
β2

· · · mk−−→
βk

yk = w) ∈ P <(y, w). We set

e(∆) := {βj | j = 1, . . . , k},
r(∆) := {βj |

is a reﬂection edge},

t(∆) := {βj |

is a translation edge}, and

βj

mj−−→
mj−−→

βj

T (∆) := (mβ)β∈Φ+ , which is ordered in the (ﬁxed) reﬂection order <, where mβ is mj if β = βj, and
is zero otherwise.

Also, we deﬁne the degree of ∆ to be the integer:

deg(∆) =

ℓ(∆)Xj=1

d(yj−1

mj−−→

βj

yj) − ℓ(∆).

Remark 2.4.3. Since ℓ

indeed an integer.

∞

2 (y, w) is even (resp., odd) if w = ytmβ∨ (resp., w = cl(y)sβtwt(y)+mβ∨), d(y m−→

β

w) is

Now we are ready to state our main result of this paper.

Theorem 2.4.4. Let y, w ∈ Waf . Then we have

Ry,w(q) = X∆∈P <(y,w)

qdeg(∆)(q − 1)ℓ(∆).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

9

Example 2.4.5. In type A2, let y = e, w = w0tα∨
are as follows:

1 +α∨
2

, α1 < α1 + α2 < α2. Then, the elements of P <(y, w)

∆1 = (e

1−−−−→
α1+α2

w0tα∨

1 +α∨
2

),

∆2 = (e 0−→
α1
∆3 = (e 1−→
α1
∆4 = (e 1−→
α1

s1

tα∨

1

1−−−−→
α1+α2
0−−−−→
α1+α2
0−−−−→
α1+α2

1

s1tα∨

s2s1tα∨

1 +α∨
2

0−→
α2

w0tα∨

1 +α∨
2

),

w0tα∨

1

1−→
α2

w0tα∨

1 +α∨
2

),

s2s1tα∨

1

1−→
α2

w0tα∨

1 +α∨
2

).

In this case, we have

r(∆1) = {α1 + α2},
r(∆2) = Φ+,
r(∆3) = {α1 + α2},
r(∆4) = Φ+,

t(∆1) = ∅,
T (∆1) = (0, 1, 0), deg(∆1) = 4,
t(∆2) = ∅,
T (∆2) = (0, 1, 0), deg(∆2) = 3,
t(∆3) = {α1, α2}, T (∆3) = (1, 0, 1), deg(∆3) = 3,
t(∆4) = ∅,
T (∆4) = (1, 0, 1), deg(∆4) = 4,

ℓ(∆1) = 1,
ℓ(∆2) = 3,
ℓ(∆3) = 3,
ℓ(∆4) = 3.

Therefore, we have

Re,w0tα∨

1

+α∨
2

(q) = q4(q − 1) + 2q3(q − 1)3 + q4(q − 1)3.

3. Bijections between sets of paths

3.1. Deﬁnitions. We take and ﬁx a reﬂection order < on the set Φ+ of positive roots of g. For y, w ∈ Waf , let
r (y, w) denote the subset of P <(y, w) that consists of all those ∆ ∈ P <(y, w) having no translation edges; in
P <
v (u, v ∈ Waf , β ∈ Φ+) appearing in ∆ ∈ P <(y, w), we often drop the label
the following, from an edge u
m.

m−→

β

Deﬁnition 3.1.1. Let u, v ∈ Waf , s ∈ Saf , and let ∆ = (u = u0 −→
β1

u1 −→
β2

· · · −→
βk

uk = v) ∈ P <

r (u, v).

(1) The s-descent set of ∆ is deﬁned to be

Ds(∆) := {i ∈ {1, 2, . . . , k} | sui = ui−1}.

(2) The number d∆ (resp., d∆) is deﬁned to be the minimum (resp., maximum) element of Ds(∆). If the

s-descent set is empty, then we set d∆ = k + 1 and d∆ = 0.
0 (u, v) denote the subset {∆ ∈ P <
r (u, v) | Ds(∆) 6= ∅} of P <

r (u, v). Now, we deﬁne a map ΨL : P <

r (u, v) | Ds(∆) = ∅} of P <

Let P <
{∆ ∈ P <

ΨL(∆) = (su = su0 −→
β1

· · · −−−−→
βd∆−1

sud∆−1 = ud∆ −−−−→
βd∆+1

· · · −→
βk

Also, we deﬁne a map ΨR : P <

+ (u, v) → P <

r (u, sv) by:

r (u, v), and let P <

+ (u, v) denote the subset

+ (u, v) → P <

r (su, v) by
uk = v).

ΨL(∆) = (u = u0 −→
β1

· · · −−−−→
βd∆−1

ud∆−1 = sud∆ −−−−→
βd∆+1

· · · −→
βk

suk = sv).

r (su, v) for all ∆ ∈ P <

+ (u, v), and that ΨR(∆) ∈ P <

β

v is a reﬂection edge, with v 6= su, we have su < ∞

+ (u, v). For this, it suﬃces to show that for u < ∞

r (u, sv)
v ∈ Waf , s ∈ Saf , β ∈ Φ+ such that
sv. This is shown as follows. Let α be the simple

Remark 3.1.2. We need to check that ΨL(∆) ∈ P <
for all ∆ ∈ P <
u m−→
root corresponding to the simple reﬂection s. Since u m−→
v is a reﬂection edge, we have v = usβ ′, where
af,+ ∩ {±u(β′)},
β′ = β + m′δ for some m′ ∈ Z; note that v = usβ ′ = su(β ′)u. Let γ′ be the unique element of Φre
and write it as γ′ = γ + nδ for some n ∈ Z≥0. Then, by Proposition 2.2.4, we have (cl(u))−1(γ) ∈ Φ+.
Also, we have sv = su = ssγ ′u = ss(γ ′)u, and s(γ′) = s(γ) + nδ.
af,+ and
(scl(u))−1(s(γ)) = (cl(u))−1(γ) ∈ Φ+. Hence it follows from Proposition 2.2.4 that su < ∞
sv. If s(γ) ∈ −Φ+,
then γ = α and n 6= 0 since γ′
af,+. Hence it follows from the same
calculation as above that su < ∞

6= α. Therefore, we obtain s(γ′) ∈ Φre
sv.

If s(γ) ∈ Φ+, then s(γ′) ∈ Φre

β

2

2

2

2

10

H. WATANABE AND S. NAITO

3.2. Some properties of paths. By the proof of [BjBr, Proposition 5.2.1] (in which we order {α0} ⊔ Π so that
α0 is the smallest), we can show that there exists a reﬂection order on Φre
af,+ that extends the ﬁxed reﬂection
order < on Φ+; in what follows we take such a one and denote it by the same symbol. For three positive real
roots α, β, γ ∈ Φre

af,+, we say that α is between β and γ if either β < α < γ or γ < α < β holds.

For each β ∈ Φre

af , we set

Now we deﬁne two maps cl : Φre

|β| :=(β

−β
af,+ → Φ and cl+ : Φre

if β ∈ Φre
otherwise.

af,+,

af → Φ+ by
cl(α + mδ) = α,

cl+(α + mδ) = |α|.

Lemma 3.2.1. Let u, v ∈ Waf , s ∈ Saf , and β ∈ Φre
simple root corresponding to the simple reﬂection s.

af ,+ be such that v = usβ, and su < ∞

2

u. Let α denote the

(1) If sv < ∞

2

v, then exactly one of the following holds:
(a) cl+(u−1(α)) is between cl+(v−1(α)) and cl+(β);
(b) cl+(v−1(α)) is between cl+(u−1(α)) and cl+(β);
(c) cl+(u−1(α)) = cl+(v−1(α)) 6= cl+(β).

(2) If v < ∞
2

sv, then exactly one of the following holds:
(d) cl+(β) is between cl+(u−1(α)) and cl+(v−1(α));
(e) cl+(u−1(α)) = cl+(v−1(α)) = cl+(β).

Proof. (1) Take λ ∈ Q∨

+ such that utλ, vtλ, sutλ, svtλ ⊂ C+, and set z := utλ, x := vtλ. Then we have

sz < z,

sx < x, and x = zsβ ′ for some β′ ∈ Φre

af,+, with cl(β′) = cl+(β).

The ﬁrst two conditions imply that z−1(α), x−1(α) ∈ −Φre
cl(−x−1(α)) = cl+(v−1(α)). Also, we have

af,+; note that cl(−z−1(α)) = cl+(u−1(α)) and

−z−1(α) = −sβ ′x−1(α) = −x−1(α) − h−x−1(α), (β′)∨iβ′.

If h−x−1(α), (β′)∨i < 0, then

−z−1(α) = −x−1(α) + (−h−x−1(α), (β′)∨i)β′.

Applying the map cl to this equation, we obtain

cl+(u−1(α)) = cl+(v−1(α)) + (−h−x−1(α), (β′)∨i)cl+(β).

If cl+(v−1(α)) = cl+(β), then cl+(u−1(α)) must be cl+(v−1(α)). However, this contradicts that h−x−1(α), (β′)∨i 6=
0. Hence cl+(v−1(α)) 6= cl+(β). It follows from the deﬁnition of reﬂection orders that cl+(u−1(α)) is between
cl+(v−1(α)) and cl+(β). Thus, assertion (a) holds.

If h−x−1(α), (β′)∨i > 0, then by a similar argument, assertion (b) holds.
If h−x−1(α), (β′)∨i = 0, then cl+(u−1(α)) = cl+(v−1(α)). If, in addition, cl+(u−1(α)) = cl+(β), then

0 < hcl+(u−1(α)), cl+(β)i = h−x−1(α), (β′)∨i = 0,

which is a contradiction. Hence assertion (c) holds.

(2) We use the same notation as in the proof of (1).

cl+(v−1(α)). Then we have

In this case, x−1(α) ∈ Φre

af ,+ and cl(x−1(α)) =

−z−1(α) + x−1(α) = −h−x−1(α), (β′)∨iβ′.

Since the left-hand side is a sum of positive real roots, we deduce that a := −h−x−1(α), (β′)∨i > 0. Therefore,

Applying the map cl to this equation, we obtain

cl+(β) = a−1cl+(u−1(α)) + a−1cl+(v−1(α)).

β′ = a−1(−z−1(α)) + a−1x−1(α).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

11

If cl+(u−1(α)) 6= cl+(v−1(α)), then by the deﬁnition of reﬂection orders, cl+(β) is between cl+(u−1(α)) and
cl+(v−1(α)). This proves the lemma.
(cid:3)

In order to make arguments below easier to follow, we introduce some notation.

Deﬁnition 3.2.2. Let u, v ∈ Waf , s ∈ Saf , and β ∈ Φ+.

(1) We write u s−→

β

v,

v

, or u

to indicate that u −→
β

v and v = su.

s β

s β

u

v

(2) We write

v

to indicate that v = su and either u −→
β

v or v −→
β

u holds.

s β

u
(3) We write v

to indicate that v = u.

u

For example, the assumption of Lemma 3.2.1 (2) is written as:

u

cl+(β)

v

s cl+(u−1(α))

s cl+(v−1(α))

su

cl+(β)

sv.

Until the end of this subsection, we assume the following: y < ∞
2

ui, vi ∈ Waf (i ∈ Z≥0). For each i ∈ Z≥0, we deﬁne ζi and ξi by

w ∈ Waf , s ∈ Saf , y < ∞

2

sy, sw < ∞
2

w, and

i
where α is the simple root corresponding to the simple reﬂection s.

i

ζi = cl+(u−1

(α)),

ξi = cl+(v−1

(α)),

Lemma 3.2.3.

(1) Let ∆ = (sy = u0 −→
β1

· · · −→
βk

uk = w) ∈ P <

r (sy, w). Then there exists l ∈

{0, 1, . . . , d∆ − 1} such that sul < ∞
if l = k.

2

ul and βl < ζl < βl+1, where ζ0 < β1 if l = 0, and βk < ζk

(2) Let ∆ = (y = v0 −→
γ1

· · · −→
γk

vk = sw) ∈ P <

r (y, sw). Then there exists r ∈ {d∆, d∆ + 1, . . . , k} such that

vr < ∞

2

svr and γr < ξr < γr+1, where ξ0 < γ1 if r = 0, and γk < ξk if r = k.

Proof. We prove part (1); the proof of part (2) is similar. Assume ﬁrst that Ds(∆) 6= ∅. What we need to do
is to ﬁnd l for which the following diagram is commutative:

sy

u0

/ u1

/ · · ·

/ ul

βl

β2

β1

/ · · ·

βl+1

s

s ζ0

s ζ1

s ζl

y

su0

/ su1

/ · · ·

/ sul

βl

βl+1

/ · · ·

β2

β1

s

βd

/ ud∆

/ ud∆−1

βd∆−1

s ζd∆−1

✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆
✆

/ sud∆−1,

βd∆−1

with βl < ζl < βl+1. If ζ0 < β1, then there is nothing to prove. Assume now that β1 ≤ ζ0.

u1. By Lemma 3.2.1 (1), we have β1 < ζ0 < ζ1, β1 < ζ1 < ζ0, or ζ0 = ζ1 6= β1. In each

su1. By Lemma 3.2.1 (2), we have ζ1 < β1 < ζ0, or β1 = ζ0 = ζ1. In each case, we

2

Case 1: su1 < ∞
case, we obtain β1 < ζ1.
Case 2: u1 < ∞
obtain ζ1 < β2.

2

O
O



O
O
/
/
/
/
/


/
O
O
O
O
/
/
/
O
O
/
/
12

H. WATANABE AND S. NAITO

Case 2-1: su2 < ∞
Case 2-2: u2 < ∞
each case, we obtain ζ2 < β2, and hence ζ2 < β3.

u2. By Lemma 3.2.1 (2), we have ζ1 < β2 < ζ2.
su2. By Lemma 3.2.1 (1), we have ζ2 < ζ1 < β2, ζ1 < ζ2 < β2, or ζ1 = ζ2 6= β2. In

2

2

If we cannot ﬁnd a required l, then by applying the above argument repeatedly, we have either

with βd∆−1 < ζd∆−2, or

ud∆−2

/ ud∆−1

βd∆−1

s ζd∆−2

s ζd∆−1=βd∆

sud∆−2

/ sud∆−1,

βd∆−1

ud∆−2

ud∆−1

βd∆−1

s ζd∆−2

s ζd∆−1=βd∆

sud∆−2

/ sud∆−1,

βd∆−1

with ζd∆−2 < βd∆−1. In the former case, by Lemma 3.2.1 (2), we see that ζd∆−1 < βd∆−1 < ζd∆−2. Since
ζd∆−1 = βd∆ , this contradicts the assumption that βd∆−1 < βd∆ . In the latter case, by Lemma 3.2.1 (1), we
see that ζd∆−1 < ζd∆−2 < βd∆−1, ζd∆−2 < ζd∆−1 < βd∆−1, or ζd∆−2 = ζd∆−1. In each case, we deduce that
βd∆ = ζd∆−1 < βd∆−1, which is impossible since βd∆−1 < βd∆.

Next, we assume that Ds(∆) = ∅. If we cannot ﬁnd a required l among {0, 1, . . . , k − 1}, then by the same

argument as above, we have

with βk < ζk−1, or

uk−1

βk

/ uk

s ζk−1

s ζk

suk−1

uk−1

/ suk,

uk

βk

βk

s ζk−1

s ζk

suk−1

βk

/ suk,

with ζk−1 < βk. By Lemma 3.2.1, in each case we deduce that βk < ζk. Therefore, l = k = d∆ − 1 is a required
one. This proves the lemma.
(cid:3)

Remark 3.2.4. Under the assumption of Lemma 3.2.3 (1), we take an arbitrary l for which the assertion of
the lemma holds, and consider the path

ul

/ · · ·

βl+1

/ ud∆−1

βd∆−1

s
βd∆

/ ud∆ βd∆+1

/ · · ·

/ uk = w.

βk

s ζl

y = su0

/ su1

/ · · ·

/ sul

βl

β2

β1

Clearly, this path is an element of Ψ−1
ul and βl < ζl < βl+1 to the set Ψ−1
a bijection from the set of l ∈ {0, 1, . . . , d∆ − 1} such that sul < ∞
Similarly, by Lemma 3.2.3 (2), we obtain a bijection from the set of r ∈ {d∆, d∆ + 1, . . . , k} such that vr < ∞
and γr < ξr < γr+1 to the set Ψ−1

+ (y, w) → P <(sy, w). Moreover, this procedure gives
L (∆).
svr

L (∆), where ΨL : P <

2

R (∆).

2

/


O
O
/
/
/




/
/
O
O
/
O
O
/
/


/
O
O
/
/
/
/
/
/
/
/
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

Lemma 3.2.5. If we are given (ul1 −−−→
βl1+1

ul1+1 −−−→
βl1+2

· · · −−→
βl2

ul2) ∈ P <

0 (ul1, ul2) such that sul1 < ∞

2

13

ul1 ,

sul2 < ∞
βd < ζd < βd+1.

2

ul2 , ζl1 < βl1+1, and βl2 < ζl2 , then we can ﬁnd d ∈ {l1 + 1, . . . , l2 − 1} such that ud < ∞

sud and

2

Proof. We want to ﬁnd d for which the following diagram is commutative:

ul1 βl1+1

/ · · ·

/ ud

βd

βd+1

· · ·

βl2

/ ul2

s ζl1

s ζd

s

ζl2

sul1

βl1+1

/ · · ·

/ sud

βd

βd+1

/ · · ·

/ sul2,

βl2

with βd < ζd < βd+1. First, we prove that there exists d′ such that ud′ < ∞
have (by Lemma 3.2.1 (1)) ζl1+1 < βl1+1(< βl1+2), and inductively

2

sud′. If this does not hold, then we

ζl1+2 < βl1+2 < βl1+3,
ζl1+3 < βl1+3 < βl1+4,

...
ζl2 < βl2 .

However, the last inequality contradicts the assumption. Now, we proceed by induction on l2 − l1. If l2 − l1 = 2,
then we obtain the commutative diagram:

ul1

/ ul1+1

βl1+1

βl1+2

/ ul1+2

s ζl1

s ζl1 +1

s

ζl1+2

sul1

/ suli+1

βl1+1

βl1+2

/ sul1+2.

Note that by Lemma 3.2.1 (2), we have ζl1 < βl1+1 < ζl1+1 < βl1+2 < ζl1+2. Therefore, d := l1 + 1 is a
required one. When l2 − l1 > 2, take the minimum index d′ such that ud′ < ∞
sud′; it is easy to show (by using
Lemma 3.2.1) that βd′ < ζd′. If ζd′ < βd′+1, then d := d′ is a required one. If not, take the minimum index
l′ ∈ {d′ + 1, . . . , l2} such that sul′ < ∞
ul′ . Then, by using Lemma 3.2.1 again, we deduce that either ζl′ < βl′ ,
or there exists d′′ ∈ {d′ + 1, . . . , l′ − 1} such that ud′′ < ∞
sud′′ and βd′′ < ζd′′ < βd′′+1. Here, in the former
case, we obtain l′ 6= l2, and hence we can complete the proof by our induction hypothesis.
(cid:3)

2

2

2

Proposition 3.2.6. Let ∆ ∈ P <

+ (y, w). Then the following hold.

(1) (cid:12)(cid:12)Ψ−1
(2) (cid:12)(cid:12)Ψ−1

L (∆)(cid:12)(cid:12) =(cid:12)(cid:12){∆′ ∈ Ψ−1
R (∆)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12){∆′ ∈ Ψ−1

R (ΨR(∆)) | d∆′

L (ΨL(∆)) | d∆′ < d∆}(cid:12)(cid:12).
> d∆}(cid:12)(cid:12)(cid:12).

Proof. We prove part (1); the proof of part (2) is similar. Let us write

ΨL(∆) = (sy = u0 −→
β1

u1 −→
β2

· · · −→
βk

uk = w),

and {∆′ ∈ Ψ−1
L (ΨL(∆)) | d∆′ ≤ d∆} = {∆1, . . . , ∆p}, with d∆1 < · · · < d∆p . Observe that if ΨL(∆′) = ΨL(∆′′)
and d∆′ = d∆′′, then ∆′ = ∆′′. It follows from Remark 3.2.4 that ∆p = ∆. Also, from Lemma 3.2.3 (1) and
Remark 3.2.4, we have

sud∆i −1 < ∞

2

ud∆i −1 and βd∆i −1 < ζd∆i −1 < βd∆i

/
/
/
/


/
O
O
/
/
/
/
O
O
/


/
O
O
/
/
O
O
14

H. WATANABE AND S. NAITO

for all i = 1, . . . , p. Let i ≥ 2. Then the path

(ud∆i−1 −1 −−−−−→
βd∆i−1

· · · −−−−−→

βd∆i

−1

ud∆i −1)

satisﬁes the assumption of Lemma 3.2.5. Therefore, there exists di ∈ {d∆i−1, . . . , d∆i −2} for which the following
diagram is commutative:

· · ·

· · ·

/ ud∆i−1 −1

βd∆i−1

−1

βd∆i−1

/ · · ·

/ udi

βdi+1

/ · · ·

/ ud∆i −1

−1

βd∆i

βd∆i

/ · · ·

/ ud∆p −1

−1

βd∆p

βd∆p

βdi

/ · · ·

s ζd∆i−1

−1

s ζdi

s ζd∆i

−1

s ζd∆p

−1

/ sud∆i−1 −1

βd∆i−1

−1

βd∆i−1

/ · · ·

/ sudi βdi+1

/ · · ·

βdi

/ sud∆i −1

−1

βd∆i

βd∆i

/ · · ·

/ sud∆p −1

−1

βd∆p

βd∆p

/ · · · ,

with βdi < ζdi < βdi+1. If we set

∆′

i := (sy = u0 −→
β1

· · · −−→
βdi

sudi −−−−→
βdi+1

· · ·

udi

s−−→
ζdi
s−−−−−→
ζd∆p

−1

−−−−−→
βd∆p

−1

sud∆p −1

ud∆p −1 −−−→
βd∆p

· · · −→
βk

uk = w) ∈ P <(sy, w),

then we have ∆′
sud′
that ud′
· · · −−→
(sud′
βdi

< ∞
2
−−−−→
βd′
i

+1

i

i

i

i ∈ Ψ−1

L (∆p) = Ψ−1

and βd′

i

< ζd′

i

L (∆), with d∆′
< βd′

i

i+1, then we may assume that d′

= di + 1. If there exists another d′

i ∈ {d∆i−1, . . . , d∆i − 2} such
i < di. By applying Lemma 3.2.5 to the path
i + 1 < d∆′ < di + 1 < d∆i ≤ d∆p .

sudi), we obtain ∆′ ∈ Ψ−1

L (ΨL(∆)) such that d∆i−1 < d′

However, this is impossible because ∆′ ∈ {∆′ ∈ Ψ−1
This proves the proposition.

L (ΨL(∆)) | d∆′ ≤ d∆} = {∆1, . . . , ∆p} and d∆1 < · · · < d∆p .
(cid:3)

3.3. Bijections. Recall that we have assumed that y < ∞
2
ui, vi ∈ Waf (i ∈ Z≥0). Also, for each i ∈ Z≥0, ζi and ξi are deﬁned by
ξi = cl+(v−1

ζi = cl+(u−1

(α)),

i

(α)),

i

w ∈ Waf , s ∈ Saf , y < ∞

sy, sw < ∞
2

w, and

2

where α is the simple root corresponding to the simple reﬂection s.
P <

r (sy, w) → P <

r (sy, sw) ⊔ P <

r (y, w). If ∆ = (sy = u0 −→
β1

u1 −→
β2

· · · −→
βk

In the following, we deﬁne a map ϕ :
0 (sy, sw), then we

uk = sw) ∈ P <

deﬁne

ϕ(∆) := (y = su0 −→
β1

su1 −→
β2

· · · −→
βk

suk = w);

note that ℓ(ϕ(∆)) = ℓ(∆).

Let ∆ = (sy = u0 −→
β1

u1 −→
β2

· · · −→
βk

uk = w) ∈ P <

r (sy, w). By Remark 3.2.4, the set Ψ−1
L (∆) such that dϕ(∆) < d∆′ for all ∆′ ∈ Ψ−1

We deﬁne ϕ(∆) to be the unique element of Ψ−1
L (∆) \ {ϕ(∆)}; this
ϕ(∆) is realized by taking the smallest l for which the assertion of Lemma 3.2.3 (1) holds. Note that in this
case, we have ℓ(ϕ(∆)) = ℓ(∆) + 1.
v1 −→
γ2

+ (sy, sw). Let us write Ds(∆) = {d1, . . . , dm}, with

Let ∆ = (sy = v0 −→
γ1

vk = sw) ∈ P <

· · · −→
γk

L (∆) is not empty.

d1 < · · · < dm. For each i = 1, . . . , m, we have

vdi−1

svdi

γdi+1

svdi+1 γdi+2

/ · · · γdi+1−1

/ svdi+1−1

vdi+1

s γdi

s γdi

s ξdi +1

s γdi+1

s γdi+1

svdi−1

vdi

γdi+1

/ vdi+1 γdi+2

· · · γdi+1−1

/ vdi+1−1

svdi+1,

/
/
/


/
/
/
/
/
/
O
O
/
/
/
/
O
O
/
/
O
O
/


/
/


/
/
/
/
/
/
O
O
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

15

where dm+1 = k + 1 and vk+1 = w. By applying Lemma 3.2.3 (2) to the path (svdi

vdi+1−1), we can take the smallest ri ∈ {di + 1, di + 2, . . . , di+1 − 1} such that vri < ∞
Then, we have

2

vdi −−−→
γdi+1

s−−→
· · · −−−−−→
γdi
γdi+1−1
svri and γri < ξri < γri+1.

∆i := (vdi −−−→
γdi+1

· · · −−→
γri

vri

s−−→
ξri

svri −−−→
γri+1

· · · −−−−−→
γdi+1−1

svdi+1−1 = vdi+1) ∈ P <

r (vdi , vdi+1).

Also, we set ∆0 := (y = sv0 −→
γ1

sv1 −→
γ2

· · · −−−−→
γd1−1

svd1−1 = vd1) ∈ P <

0 (y, vd1). Now we deﬁne ϕ(∆) to be the

concatenation of the paths ∆0, ∆1, . . . , ∆m. Namely, we deﬁne ϕ(∆) = (y = u0 −→
β1

u1 −→
β2

· · · −→
βk

uk = w), as

follows:

(3)

(4)

uj =
βj =

svj
vj+1
svj

γj
γj+1
γj
ξri

(j = 0, 1, . . . , d1 − 1),
(j = di, di + 1, . . . , ri − 1, and i = 1, . . . , m),
(j = ri, ri + 1, . . . , di+1 − 1, and i = 1, . . . , m),

(j = 1, . . . , d1 − 1),
(j = di, di + 1, . . . , ri − 1, and i = 1, . . . , m),
(j = ri + 1, . . . , di+1 − 1, and i = 1, . . . , m),
(j = ri, and i = 1, . . . , m).

Note that in this case, we have ℓ(ϕ(∆)) = ℓ(∆).

Proposition 3.3.1. The map ϕ : P <

r (sy, sw) ⊔ P <

r (sy, w) → P <

Proof. We prove the assertion by constructing a map ϕ′ : P <
to be the inverse of ϕ. Let ∆′ = (y = u0 −→
β1

· · · −→
βk

uk = w) ∈ P <

r (y, w) → P <

r (y, w) is a bijection.
r (sy, sw) ⊔ P <
r (y, w). If ∆′ ∈ P <

r (sy, w), which turns out
0 (y, w), then ∆′ = ϕ(∆),

where

∆ := (sy = su0 −→
β1

su1 −→
β2

· · · −→
βk

suk = sw) ∈ P <

0 (sy, sw).

Hence we deﬁne ϕ′(∆′) := ∆.

Assume that ∆′ ∈ P <

+ (y, w).

If the set Ψ−1

L (∆′) is empty, then by Proposition 3.2.6, d∆′ ≤ d∆′′ for all

∆′′ ∈ Ψ−1

L (ΨL(∆′)). Therefore, by the deﬁnition of ϕ, we have
∆′ = ϕ(ΨL(∆′)).

Hence we deﬁne ϕ′(∆′) := ΨL(∆′).

Next, assume that ∆′ ∈ P <

m}, with
1 < · · · < d′
d′
1 − 2} such
that sul1 < ul1 and βl1 < ζl1 < βl1+1 (see Remark 3.2.3). For each i = 1, . . . , m − 1, we have the following
commutative diagram:

L (∆′) is not empty, we can take the maximum index l1 ∈ {1, . . . , d′

L (∆′) is not empty. Let us write Ds(∆′) = {d′

m. Since Ψ−1

+ (y, w) and Ψ−1

1, . . . , d′

ud′

i−1

sud′

i βd′
i

sud′

i+1

+1

βd′
i

+2

/ · · ·

βd′

i+1

/ sud′

−1

i+1−1

ud′

i+1

s βd′
i

s βd′
i

s ζd′
i

+1

s βd′

i+1

s βd′

i+1

sud′

i−1

ud′

i

/ ud′

i+1

βd′
i

+1

βd′
i

+2

· · ·

βd′

i+1

/ ud′

−1

i+1−1

sud′

i+1

.

By applying Lemma 3.2.3 (1) to the path (sud′

i−1 = ud′

i

−−−−→
βd′
i

+1

· · · −−−−−→

βd′

−1

i+1

ud′

i+1−1

s−−−−→
βd′

i+1

sud′

i+1−1 = ud′

i+1

), we

can take the maximum index li+1 ∈ {d′
Then, we have

i, d′

i + 1, . . . , d′

i+1 − 2} such that suli+1 < uli+1 and βli+1 < ζli+1 < βli+1+1.

∆′

i := (ud′

i−1 = sud′

i

−−−−→
βd′
i

+1

· · · −−−→

βd′
li

suli+1

s−−−→
ζli+1

uli+1 −−−→
βli+1

· · · −−−−−→

βd′

−1

i+1

ud′

i+1−1) ∈ P <

r (ud′

i−1, ud′

i+1−1).



/
/


/
/
/
/
/
/
O
O
O
O
16

H. WATANABE AND S. NAITO

Also, we set ∆′

(ud′

m−1 = sud′

0 = (sy = su0 −→
β1
· · · −→
βk
+ (sy, sw) of the paths ∆′

m −−−−→
m+1

βd′

· · · −−→
βl1

sul1

s−−→
ζl1

suk = sw) ∈ P <

· · · −−−−→

ul1 −−−→
βl1+1
m−1, sw). We deﬁne ϕ′(∆′) to be the concatenation

1−1) and ∆′

1−1) ∈ P <

r (sy, ud′

m :=

ud′

βd′
1

−1

0 (ud′

0, ∆′

1, . . . , ∆′

m. Namely, we deﬁne ∆ = (sy = v0 −→
γ1

v1 −→
γ2

· · · −→
γk

vk = sw) as

∆ ∈ P <

follows:

(5)

(6)

vj =
γj =

suj
uj−1
suj

βj
βj−1
βj
ζli+1

i + 1, . . . , li+1, and i = 0, 1, . . . , m − 1),

i, d′

(j = d′
(j = li+1 + 1, li+1 + 2, . . . , d′
(j = d′

m + 1, . . . , k),

m, d′

i+1 − 1, and i = 0, 1, . . . , m − 1),

i + 1, . . . , li+1, and i = 0, 1, . . . , m − 1),

(j = d′
(j = li+1 + 2, . . . , d′
(j = d′
(j = li+1 + 1, and i = 0, 1, . . . , m − 1),

m + 1, . . . , k),

i+1, and i = 0, 1, . . . , m − 1),

m, d′

where d′

0 := 0.

1 − 2 < d′

We show that ϕ(∆) = ∆′. By the deﬁnition of ∆, we have Ds(∆) = {l1 + 1, l2 + 1, . . . , lm + 1}, with
i coincides with the minimum
svri and γri < ξri < γri+1 for all i = 1, . . . , m (here we set

l1 ≤ d′
index ri ∈ {li + 2, li + 3, . . . , li+1} such that vri < ∞
lm+1 = k + 1). If this does not hold, then we obtain the following commutative diagram:

m − 2. We claim that d′

2 ≤ · · · ≤ lm ≤ d′

1 ≤ l2 ≤ d′

2 − 2 < d′

2

vli

svli+1

· · ·

/ svri

/ · · ·

/ svd′

i

/ · · ·

/ svli+1

vli+1+1

s

s

s ξri

s βd′
i

s

s

svli

vli+1

/ · · ·

/ vri

· · ·

/ vd′

i

· · ·

/ vli+1

svli+1+1.

By Lemma 3.2.5, there exists d ∈ {ri + 1, . . . , d′
ξd(= ζd−1) < γd+1βd. However, this contradicts the maximality of li. If we write ϕ(∆) = (y = u′
· · · −→ u′
i = 1, . . . , m) and (5).

0 −→ u′
k = w), then it is easy to see that ϕ(∆) = ∆′ by using equations (3) (with di = li + 1, ri = d′

vd = ud−1 and βd−1 = γd <
1 −→
i for

i − 1} such that sud−1 = svd < ∞

2

It remains to show that ϕ′(ϕ(∆)) = ∆ for all ∆ ∈ P <
0 (sy, sw) ⊔
r (sy, w). When ∆ ∈ P <
P <
+ (sy, sw), we deduce from the deﬁnition of ϕ(∆) (in particular, that of ∆0) that
Ψ−1
L (ϕ(∆)) is not empty. Based on this fact, we can show that ϕ′(ϕ(∆)) = ∆ in a way similar to the above.
This completes the proof of the proposition.
(cid:3)

r (sy, w). It is easy when ∆ ∈ P <

r (sy, sw) ⊔ P <

Now, we deﬁne a map ψ : P <
r (y, sw). When ∆ ∈ P <
P <

0 (y, sw), we deﬁne

r (y, sw) → P <

r (sy, w) as follows. Let ∆ = (y = v0 −→
γ1

· · · −→
γk

vk = sw) ∈

ψ(∆) := (sy = sv0 −→
γ1

sv1 −→
γ2

· · · −→
γk

svk = w) ∈ P <

0 (sy, w).

Assume that ∆ ∈ P <
for each i = 1, . . . , m, we can take the minimum index ri ∈ {di + 1, . . . , di+1 − 1} such that vri < ∞
γri < ξri < γri+1; hence we can deﬁne ∆i ∈ P <

+ (y, sw). We write Ds(∆) = {d1, . . . , dm}, with d1 < · · · < dm. As in the deﬁnition of ϕ,
svri and

r (vdi, vdi+1) by

2

∆i := (vdi −−−→
γdi+1

· · · −−→
γri

vri

s−−→
ξri

svri −−−→
γri+1

· · · −−−−−→
γdi+1−1

svdi+1−1 = vdi+1) ∈ P <

r (vdi , vdi+1),

where dm+1 = k + 1 and vk+1 = w. Also, we set ∆0 := (sy = sv0 −→
γ1

sv1 −→
γ2

P <

0 (sy, vd1). We deﬁne ψ(∆) to be the concatenation of the paths ∆0, ∆1, . . . , ∆m.

· · · −−−−→
γd1−1

svd1−1 = vd1) ∈



/
/


/
/
/
/
/
/
/
/
/
O
O
/
/
/
O
O
/
O
O
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

17

In a way similar to the deﬁnition of ϕ′ above, we deﬁne a map ψ′ : P <

r (sy, w) → P <

r (y, sw). Let ∆′ = (sy =

uk = w) ∈ P <

r (sy, w). If ∆′ ∈ P <

0 (sy, w), then ∆′ = ψ(∆), where

u0 −→
β1

· · · −→
βk

(7)

∆ := (y = su0 −→
β1

· · · −→
βk

suk = sw) ∈ P <

0 (y, sw).

Hence we deﬁne ψ′(∆′) := ∆.

Assume that ∆′ ∈ P <

+ (sy, w). By Lemma 3.2.3 and Remark 3.2.4, Ψ−1

L (∆′) is not empty. Let us write
m. For each i = 0, 1, . . . , m − 1, we have the following

Ds(∆′) = {d′
1, . . . , d′
commutative diagram:

m}, with 0 = d′

0 < d′

1 < · · · d′

ud′

i−1

sud′

i βd′
i

+1

sud′

i+1 γd′

/ · · ·

+2

βd′

i+1

i

/ sud′

−1

i+1−1

ud′

i+1

s βd′
i

s βd′
i

s ζd′
i

+1

s βd′

i+1

s βd′

i+1

sud′

i−1

ud′

i

/ ud′

i+1

γd′
i

+1

βd′
i

+2

· · ·

βd′

i+1

/ ud′

−1

i+1−1

sud′

i+1

,

where u−1 = y. By applying Lemma 3.2.3 (1) to the path (sud′

i−1 = ud′

i

−−−−→
βd′
i

+1

· · · −−−−−→

βd′

−1

i+1

ud′

i+1−1

s−−−−→
βd′

i+1

i+1−1 = ud′

sud′
γli+1 < γli+1 < γli+1+1. Then, we have

i+1

), we can take the maximum index li+1 ∈ {d′

i, d′

i + 1, . . . , d′

i+1 − 2} such that suli+1 < uli+1 and

∆′

i := (ud′

i−1 = sud′

i

−−−−→
βd′
i

+1

· · · −−→

γd′
li

suli+1

s−−−→
ζli+1

uli+1 −−−→
βli+1

· · · −−−−−→

βd′

−1

i+1

ud′

i+1−1) ∈ P <

r (ud′

i−1, ud′

i+1−1).

Also, we set ∆′

m := (ud′

m−1 = sud′

suk = sw) ∈ P <

0 (ud′

m−1, sw). We deﬁne ϕ′(∆′) to be the

concatenation ∆ ∈ P <

+ (y, sw) of the paths ∆′

m −−−−→
m+1

βd′

· · · −→
βk
1, . . . , ∆′
0, ∆′

m.

The proof of the following proposition is similar to that of Proposition 3.3.1.

Proposition 3.3.2. The map ψ : P <

r (y, sw) → P <

r (sy, w) is a bijection, with ψ′ its inverse.

We now summarize the results obtained in this section:

Corollary 3.3.3. Let y, w ∈ Waf , s ∈ Saf . Assume that sw < ∞
P <

w. Then, there exist bijections ϕ : P <
r (sy, w). Moreover, they have the following properties:

r (y, w) and ψ : P <

r (y, sw) → P <

r (sy, w) → P <

2

r (sy, sw)⊔

ℓ(ϕ(∆)) =(ℓ(∆)

ℓ(∆) + 1

(∆ ∈ P <
(∆ ∈ P <

r (sy, sw)),
r (sy, w)),

ℓ(ψ(∆)) = ℓ(∆).

4. Proof of Theorem 2.4.4

4.1. Recursion relations. Let y, w ∈ Waf , and let < be a (ﬁxed) reﬂection order on Φ+. Recall that P <
is deﬁned to be the set of all paths from y to w without translation edges. Also, we deﬁne P <
set of all paths from y to w without reﬂection edges.

r (y, w)
t (y, w) to be the

Deﬁnition 4.1.1. For y, w ∈ Waf , we deﬁne

r<

y,w(q) := X∆∈P <
y,w(q) := X∆∈P <

t<

r (y,w)

t (y,w)

q

1

2(cid:0)ℓ

∞

2 (y,w)−ℓ(∆)(cid:1)(q − 1)ℓ(∆),

qdeg(∆)(q − 1)ℓ(∆).

Proposition 4.1.2. Let y, w ∈ Waf , and s ∈ Saf . Assume that sw < ∞

2

w.



/
/


/
/
/
/
/
/
O
O
O
O
18

H. WATANABE AND S. NAITO

(1) It holds that

(2) It holds that

y,w(q) =(r<

r<

sy,sw(q)
qr<
sy,sw(q) + (q − 1)r<

sy,w(q)

(sy < ∞
(y < ∞

2

y),
sy).

2

t<
y,w(q) = t<

sy,sw(q).

Proof. (1) If sy < ∞
ℓ(ψ(∆)) = ℓ(∆) for all ∆ ∈ P <

2

y, then by Corollary 3.3.3, there exists a bijection ψ : P <

r (sy, sw) → P <

r (y, w) such that

r (sy, sw). Also, we have ℓ

∞

∞

2 (y, w) = ℓ

2 (sy, sw). Therefore, we see that

r (sy,sw)

r<

sy,sw(q) = X∆∈P <
= X∆′∈P <

= r<

y,w(q).

r (y,w)

q

1

∞

2 (sy,sw)−ℓ(∆)(cid:1)(q − 1)ℓ(∆)
2(cid:0)ℓ
2 (y,w)−ℓ(∆′)(cid:1)(q − 1)ℓ(∆′)
2(cid:0)ℓ

∞

1

q

Next, assume that y < ∞
such that ℓ(ϕ(∆)) = ℓ(∆) if ∆ ∈ P <
have ℓ

2 (sy, w) + 1 = ℓ

∞

∞

∞

2

2 (y, w) = ℓ
qr<

sy,sw(q) + (q − 1)r<

sy,w(q)

sy. By Corollary 3.3.3, there exists a bijection ϕ : P <

r (sy, sw) ⊔ P <

r (sy, sw), and such that ℓ(ϕ(∆)) = ℓ(∆) + 1 if ∆ ∈ P <
2 (sy, sw) + 2. Therefore, we see that

r (sy, w) → P <

r (y, w)
r (sy, w). Also, we

q

1

2(cid:0)ℓ

r (sy,sw)

=

= X∆∈P <
X∆′∈P <
= X∆′∈P <

ϕ−1(∆′)∈P <

r (y,w)

= r<

y,w(q),

r (y,w)

r (sy,sw)

q

1

2(cid:0)ℓ

1

∞

∞

q

2 (y,w)−ℓ(∆′)(cid:1)(q − 1)ℓ(∆′) +

2 (sy,sw)−ℓ(∆)(cid:1)+1(q − 1)ℓ(∆) + X∆∈P <
2(cid:0)ℓ
2 (y,w)−ℓ(∆′)(cid:1)(q − 1)ℓ(∆′)

∞

q

1

2(cid:0)ℓ

∞

2 (sy,s)−ℓ(∆)(cid:1)(q − 1)ℓ(∆)+1

q

1

2(cid:0)ℓ

∞

2 (y,w)−ℓ(∆′)(cid:1)(q − 1)ℓ(∆′)

r (sy,w)

X∆′∈P <

r (y,w)

ϕ−1(∆′)∈P <

r (sy,w)

as desired.

(2) Let ∆ = (y = u0

m1−−→
β1

u1

m2−−→
β2

· · · mk−−→
βk

uk = w) ∈ P <

2 (ui, ui+1) = ℓ

2 (sui, sui+1) for all i = 0, 1, . . . , k − 1. Hence we obtain a path (sy = su0

∞

suk = sw) ∈ P <

t (sy, sw). This procedure obviously gives a bijection from P <

t (y, w). Since every edge in ∆ is a translation edge, we
m2−−→
β2
t (sy, sw),

t (y, w) to P <

m1−−→
β1

su1

∞

have ℓ
· · · mk−−→
βk

which preserves both of degree and length of paths. Therefore, we see that

t<

y,w(q) = X∆∈P <
= X∆′∈P <

t (y,w)

= t<

sy,sw(q),

t (sy,sw)

qdeg(∆)(q − 1)ℓ(∆)

qdeg(∆′)(q − 1)ℓ(∆′)

as desired.

(cid:3)

Deﬁnition 4.1.3. For y, w ∈ Waf , we deﬁne

R<

y,w(q) := X∆∈P <(y,w)

qdeg(∆)(q − 1)ℓ(∆).

In order to prove Theorem 2.4.4, it suﬃces to show that the R<
(r1) R<

w,w(q) = 1 for all w ∈ Waf .

y,w(q)’s satisfy the following equations.

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

19

∞

2 w for all y, w ∈ Waf .

y,w(q) = 0 unless y ≤
sy,sw(q)
sy,sw(q) + (q − 1)R<

qR<

y,sw(q)

for all y, w ∈ Waf and all s ∈ Saf .

(r2) R<

(r3) R<

y,w(q) =(R<
(r4) Px∈W (−1)ℓ

∞

Equations (r1) and (r2) are obvious from the deﬁnition of R<
remaining equations.

2 (y,xtλ)qℓ(xw0)R<

y,xtλ(q) = δλ,λ(y) for all λ ∈ Q∨, y ∈ Waf .

if sw < ∞
if sw < ∞

2

2

w and sy < ∞
w and y < ∞

2

y,
sy,

2

y,w(q)’s. In the next two subsections, we prove the

4.2. Proof of equation (r3). In order to prove equation (r3), we need the equation

(8)

R<

y,w(q) = Xµ∈Q∨

+

y,wt−µ(q)t<
r<

wt−µ,w(q);

by using this, equation (r3) follows immediately from Proposition 4.1.2 (see Corollary 4.2.3). Note that the
right-hand side of equation (8) is actually a ﬁnite sum because by the deﬁnition of r<
y,wt−µ(q), it is equal to zero
unless y < ∞
wt−µ. The idea for the
proof of this equation is to divide a path ∆ ∈ P <(y, w) into two paths ∆1 ∈ P <
t (wt−µ, w)
for each µ ∈ Q∨

wt−µ, and because there are only ﬁnitely many µ ∈ Q∨

r (y, wt−µ) and ∆2 ∈ P <

+ satisfying y < ∞

2

2

+ as follows.

Let us take an arbitrary path ∆ = (y = u0

m1−−→
β1

· · · mk−−→
βk

uk = w) ∈ P <(y, w), and write T (∆) = (mβ)β∈Φ+ .

We deﬁne (m′

β)β∈Φ+ ∈ (Z≥0)|Φ+| by:

if β /∈ r(∆),
if β = βi ∈ r(∆), ui = cl(ui−1)sβi twt(ui−1)+miβ∨
if β = βi ∈ r(∆), ui = cl(ui−1)sβi twt(ui−1)+miβ∨

i

i

and cl(ui−1) < cl(ui−1)sβi,
and cl(ui−1)sβi < cl(ui−1),

m′

ββ∨ ∈ Q∨

+. Let (nβ)β∈Φ+ ∈ (Z≥0)|Φ+| be such that

nβ = m′
β
0 ≤ nβ ≤ m′
β

(β /∈ r(∆)), and

(β ∈ r(∆)).

m′

mβ
mi
mi − 1

β =
and set µ′ =Pβ∈Φ+
Then, for µ :=Pβ∈Φ+

(10)

(9)

nββ∨, there exists a unique pair (∆(nβ ),r, ∆(nβ ),t) ∈ P <

t (wt−µ, w) such
that r(∆(nβ ),r) = r(∆), T (∆(nβ ),t) = (nβ)β∈Φ+ , and T (∆) = T (∆(nβ ),r) + T (∆(nβ ),t), where the sum is
taken componentwise. More precisely, we deﬁne ∆(nβ ),r and ∆(nβ ),t as follows. If we write {1 ≤ i ≤ ℓ(∆) |
βi ∈ r(∆)} = {i1, i2, . . . , il} with i1 < · · · < il, and {1 ≤ j ≤ ℓ(∆) | nj 6= 0} = {j1, j2, . . . , jl′ } with
j1 < j2 < · · · < jl′ , then

r (y, wt−µ) × P <

∆(nβ ),r := (y

∆(nβ ),t := (wt−µ

· · ·

mβil
−−−−−−−→

−nβil
βil

wt−µ),

mβi1
−−−−−−−→

−nβi1
βi1
nβj1−−−→
βj1

· · ·

nβj
l′−−−→
βj

l′

w).

r (y, wt−µ)×P <

for some µ ∈ Q∨

Conversely, let (∆1, ∆2) ∈ P <

we have µ = Pβ∈Φ+

+. We write T (∆1) = (n1,β)β∈Φ+ and T (∆2) = (n2,β)β∈Φ+ . Since ∆2 ∈ P <

t (wt−µ, w) be such that r(∆1) = r(∆) and T (∆1)+T (∆2) = T (∆)
t (wt−µ, w),
n2,ββ∨. Also, T (∆1) + T (∆2) = T (∆) implies that (n2,β)β∈Φ+ satisﬁes condition (9)
and that 0 ≤ nβ ≤ mβ for all β ∈ r(∆). Moreover, if β = βi ∈ r(∆), ui = cl(ui−1)sβtwt(ui−1)+mβ∨, and
cl(ui−1)sβ < cl(ui−1), then by the deﬁnition, we have n1,βi ≥ 1. Hence (n2,β)β∈Φ+ satisﬁes condition (10).
Thefore, ∆(n2,β ),r and ∆(n2,β ),t deﬁned above agree with ∆1 and ∆2, respectively.

Thus we obtain a one-to-one correspondence between the set

A(∆) := {(nβ)β∈Φ+ ∈ (Z≥0)|Φ+| | (nβ)β∈Φ+ satisﬁes conditions (9) and (10)}

and the set B(∆) :=Fµ∈Q∨

B(∆)µ := {(∆1, ∆2) ∈ P <

+

B(∆)µ, where

r (y, wt−µ) × P <

t (wt−µ, w) | r(∆1) = r(∆) and T (∆1) + T (∆2) = T (∆)}.

20

H. WATANABE AND S. NAITO

Lemma 4.2.1. For each ∆ ∈ P <(y, w), we have

qdeg(∆)(q − 1)ℓ(∆) = Xµ∈Q∨

+ X(∆1,∆2)∈B(∆)

∆1∈P <

r (y,wt−µ)

q

1

2(cid:0)ℓ

∞

2 (y,wt−µ)−ℓ(∆1)(cid:1)+deg(∆2)(q − 1)ℓ(∆1)+ℓ(∆2).

Proof. We employ the notation above. Noting that (m′

β)β∈Φ+ ∈ A(∆), we set

a(q) = a(∆)(q) := q

1

2(cid:0)ℓ

∞

2 (y,wt−µ′ )−ℓ(∆(m′
β

),r )(cid:1)+deg(∆(m′

β

),t)

(q − 1)

ℓ(∆(m′
β

),r )+ℓ(∆(m′
β

),t)

.

For each (nβ)β∈Φ+ ∈ A(∆) withPβ∈Φ+

nββ∨ = µ, we see from the deﬁnitions of ∆(nβ ),r and ∆(nβ ),t that

(11)

(12)

ℓ(∆(nβ ),r) = |r(∆)| ,
ℓ(∆(nβ ),t) = |{β ∈ Φ+ | nβ 6= 0}| .

Also, we have

ℓ(∆(nβ ),t)

deg(∆(nβ ),t) =

(13)

=

1
2

+···+nβij−1

β∨

ij−1

nβij−−−→

βij

wt−µ+nβi1

β∨
i1

+···+nβij

β∨
ij

) − ℓ(∆(nβ ),t)

β∨
i1

d(wt−µ+nβi1

Xj=1
2 (wt−µ, w) + Xβ∈Φ+

∞

ℓ

nβ − ℓ(∆(nβ ),t).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

21

If we write r(∆) ∩ {β ∈ Φ+ | m′
follows:

β 6= 0} = {βi1 , . . . , βik′ } and m′

j = m′

βij

for 1 ≤ j ≤ k′, then we compute as

∞

2 (y,wt−µ)−ℓ(∆(nβ ),r )(cid:1)+deg(∆(nβ ),t)(q − 1)ℓ(∆(nβ ),r )+ℓ(∆(nβ ),t)

∞

1

q

1

q

q

q

),t)

β

∞

1
2 ℓ

),t)

β

(q − 1)

− Pβ (m′

Pβ nβ β∨=µ

Pβ nβ β∨=µ

Pβ nβ β∨=µ

β −nβ )−ℓ(∆(nβ ),t)+ℓ(∆(m′

2 (wt−µ′ ,wt−µ)+deg(∆(nβ ),t)−deg(∆(m′

2(cid:0)ℓ
+ X(nβ )∈A(∆)

2 (y,wt−µ)−ℓ(∆1)(cid:1)+deg(∆2)(q − 1)ℓ(∆1)+ℓ(∆2)
+ X(∆1,∆2)∈B(∆)µ
Xµ∈Q∨
2(cid:0)ℓ
= Xµ∈Q∨
+ X(nβ )∈A(∆)
= a(q) Xµ∈Q∨
+ X(nβ )∈A(∆)
= a(q) Xµ∈Q∨
+ X(nβ )∈A(∆)
= a(q) Xµ∈Q∨
m′2Xn2=0
k′Xnk′ =0
1Xn1=0
k′Xlk′ =0
2Xl2=0
1Xl1=0
k′Xlk′ =0
2Xl2=0
1Xl1=0
= a(q)1 +
k′Xj=1 X1≤i1<···<ij ≤k′

β −nβ )(cid:18) q
j −nj )(cid:18) q
q − 1(cid:19)k′−|{1≤j≤k′ | lj 6=mj }|
q − 1(cid:19)|{1≤j≤k′ | nj =mj }|
q−li1 −···−lij(cid:18) q
ijXlij =1

j=1 lj(cid:18) q
j=1 lj(cid:18) q
i1Xli1 =1

q− Pβ (m′

β

),t)

q − 1(cid:19)−ℓ(∆(nβ ),t)+ℓ(∆(m′
q − 1(cid:19)k′−|{1≤j≤k′ | nj 6=0}|

Pβ nβ β∨=µ

q− Pk′

j=1(m′

q− Pk′

q− Pk′

= a(q)

= a(q)

= a(q)

m′

m′

m′

m′

m′

m′

m′

m′

· · ·

· · ·

· · ·

· · ·

m′

m′

(q − 1)

ℓ(∆(nβ ),t)−ℓ(∆(m′

),t)

β

ℓ(∆(nβ ),t)−ℓ(∆(m′

),t)

(by (13))

β

(by changing nj with lj)

ir }| .
q − 1(cid:19)|{1≤r≤j | lir =m′

Here, by induction on j, we deduce that

m′

i1Xli1 =1

· · ·

m′

ijXlij =1

Indeed, when j = 1, we have

q−li1 −···−lij(cid:18) q

q − 1(cid:19)|{1≤r≤j | lir =m′

ir

}|

=(cid:18) 1

q − 1(cid:19)j

.

m′

i1Xli1 =1

q−li1(cid:18) q

q − 1(cid:19)δli1

,m′

i1 = q−m′

i1

q

q − 1

+

m′

i1

−1Xli1 =1

q−li1

i1

+1)

=

=

q−m′

i1

+1

q − 1

q−m′

i1

+1

q − 1

+

+

q−1(1 − q−m′
1 − q−1
+1

1 − q−m′
q − 1

i1

=

1

q − 1

.

22

H. WATANABE AND S. NAITO

When j ≥ 2, we obtain

ir }|

q − 1(cid:19)|{1≤r≤j | lir =m′
q−li2 −···−lij(cid:18) q
q−li2 −···−lij(cid:18) q

q − 1(cid:19)|{2≤r≤j | lir =m′
q − 1(cid:19)|{2≤r≤j | lir =m′

ir }|

ir }| m′

i1Xli1 =1

1

q − 1

(by our induction hypothesis)

m′

i1Xli1 =1

· · ·

m′

m′

m′

m′

=

· · ·

q−li1 −···−lij(cid:18) q
ijXlij =1
ijXlij =1
i1Xli2 =1
ijXlij =1
i1Xli2 =1
q − 1(cid:19)j−1
=(cid:18) 1
q − 1(cid:19)j
=(cid:18) 1

q − 1

· · ·

=

m′

1

.

q−li1(cid:18) q

q − 1(cid:19)δli1

,m′

i1

q − 1(cid:19)|{1≤r≤j | lir =m′

ir

}|

Therefore, we deduce that

m′

m′

· · ·

i1Xli1 =1

a(q)1 +
q−li1 −···−lij(cid:18) q
k′Xj=1 X1≤i1<···<ij ≤k′
ijXlij =1
= a(q)1 +
q − 1(cid:19)j
k′Xj=1 X1≤i1<···<ij ≤k′(cid:18) 1
q − 1(cid:19)j
= a(q)
k′Xj=1(cid:18)k′
j(cid:19)(cid:18) 1
q − 1(cid:19)k′
= a(q)(cid:18) q
),r )(cid:1)+deg(∆(m′
2(cid:0)ℓ

2 (y,wt−µ′ )−ℓ(∆(m′
β

(q − 1)

),t)+k′

= q

∞

β

1

ℓ(∆(m′
β

),r )+ℓ(∆(m′
β

),t)−k′

(by the deﬁnition of a(q)).

To ﬁnish the proof of the lemma, we need to show the following:

1

2(cid:0)ℓ

∞

2 (y, wt−µ′ ) − ℓ(∆(m′

β ),r)(cid:1) + deg(∆(m′

β ),r) + ℓ(∆(m′

ℓ(∆(m′

β ),t) + k′ = deg(∆),
β ),t) − k′ = ℓ(∆).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

23

These are veriﬁed as follows:

β ),r) + (ℓ(∆(m′

β ),t) − k′) = |r(∆)| + |t(∆)| = ℓ(∆)

(by (11) and (12)),

ℓ(∆(m′
1
2

(ℓ

∞

=

=

=

deg(∆) =

=

=

1
2

1
2

1
2

1
2

1
2

1
2

ℓ

ℓ

ℓ

ℓ

ℓ

2 (y, wt−µ′ ) − ℓ(∆(m′

β ),r)) + deg(∆(m′

β ),t) + k′

∞

2 (y, w) −

ℓ

ℓ(∆(m′

∞

2 (y, w) +

∞

2 (y, w) +

ℓ(∆(m′

ℓ(∆(m′

1
2

1
2

1
2

∞

∞

2 (y, w) + Xβ∈Φ+
2 (y, w) + Xβ∈Φ+
2 (y, w) + Xβ∈Φ+

∞

β ),t) − k′(cid:1)

m′

m′

β −(cid:0)ℓ(∆(m′
β −(cid:0)ℓ(∆(m′

β ),r) + Xβ∈Φ+
β ),r) + Xβ∈Φ+
β ),r) + Xβ∈Φ+
2(cid:12)(cid:12){β ∈ r(∆) | m′
β = mβ}(cid:12)(cid:12) −
|r(∆)| −(cid:12)(cid:12){β ∈ r(∆) | m′

β − ℓ(∆),

m′

1
2

1

mβ +

mβ +

m′

β +

ℓ(∆(m′

β ),r) − ℓ(∆).

1
2

β ),r) + ℓ(∆(m′

β ),t) − k′(cid:1)

β = mβ − 1}(cid:12)(cid:12) − ℓ(∆)

1

2(cid:12)(cid:12){β ∈ r(∆) | m′
β = mβ − 1}(cid:12)(cid:12) − ℓ(∆)

This completes the proof of the lemma.

Proposition 4.2.2. For each y, w ∈ Waf , we have

R<

y,w(q) = Xµ∈Q∨

+

Proof. We compute as follows:

y,wt−µ(q)t<
r<

wt−µ,w(q).

R<

y,w(q) = X∆∈P <(y,w)

qdeg(∆)(q − 1)ℓ(∆)

+ X(∆1,∆2)∈B(∆)µ
r (y,wt−µ) X∆2∈P <

= X∆∈P <(y,w) Xµ∈Q∨
+ X∆1∈P <
= Xµ∈Q∨
+ X∆1∈P <
= Xµ∈Q∨
= Xµ∈Q∨

+

q

1

2(cid:0)ℓ

∞

2 (y,wt−µ)−ℓ(∆1)(cid:1)+deg(∆2)(q − 1)ℓ(∆1)+ℓ(∆2)
2(cid:0)ℓ

2 (y,wt−µ)−ℓ(∆1)(cid:1)+deg(∆2)(q − 1)ℓ(∆1)+ℓ(∆2)

∞

1

q

(by Lemma 4.2.1)

t (wt−µ,w)

q

1

2(cid:0)ℓ

∞

2 (y,wt−µ)−ℓ(∆1)(cid:1)(q − 1)ℓ(∆1) X∆2∈P <

t (wt−µ,w)

r (y,wt−µ)
y,wt−µ(q)t<
r<

wt−µ,w(q)

(by the deﬁnitions).

qdeg(∆2)(q − 1)ℓ(∆2)

This proves the proposition.

Corollary 4.2.3. For each y, w ∈ Waf , we have

y,w(q) =(R<

qR<

R<

sy,sw(q)
sy,sw(q) + (q − 1)R<

y,sw(q)

if sw < ∞
if sw < ∞

2

2

w and sy < ∞
w and y < ∞

2

y,
sy.

2

(cid:3)

(cid:3)

Proof. By Proposition 4.1.2 (2), we have

t<
xt−µ,x(q) = t<

wt−µ,w(q)

for all x, w ∈ Waf and all µ ∈ Q∨. Hence the assertion follows from equation (8) and Proposition 4.1.2.

(cid:3)

24

H. WATANABE AND S. NAITO

4.3. Proof of equation (r4). In this subsection, we prove equation (r4):

∞

(−1)ℓ

2 (y,xtλ)qℓ(xw0)R<

y,xtλ(q) = δλ,λ(y) (λ ∈ Q∨, y ∈ Waf ).

Xx∈W

By translating all elements in a path by λ ∈ Q∨, we obtain a bijection P <(y, w) → P <(ytλ, wtλ) for all
y, w ∈ Waf . Hence we may assume that y ∈ W (or equivalently, λ(y) = 0).
In this subsection, we write
Φ+ = {β1, . . . , βn}, with β1 < · · · < βn ; here, < is the ﬁxed reﬂection order. To prove equation (r4), we will
prove stronger statements:

∞

(−1)ℓ

2 (y,x)qℓ(xw0)R<

y,x(q) = 1,

Xx∈W

(−1)ℓ

Xx∈W

∞

2 (y,xtλ)qℓ(xw0) X∆∈P <(y,xtλ)

βk≤e(∆)

qdeg ∆(q − 1)ℓ(∆) = 0 (λ ∈ Q∨ \ {0}, k ∈ {1, . . . , n}),

where βk ≤ e(∆) means that βk ≤ β for all β ∈ e(∆).

Proposition 4.3.1. If w ∈ W , then R<
λ = 0.

y,w(q) = Ry,w(q) for all y ∈ W . In particular, equation (r4) holds when

Proof. The polynomials Ry,w(q) for y, w ∈ W are uniquely determined by equations (R1), (R2), and (R3) (see
Proposition 2.3.5). Here, recall that we have proved that the polynomials R<
y,w(q) for y, w ∈ W satisfy the
corresponding equations (r1), (r2), and (r3). Therefore, it follows that R<
y,w(q) = Ry,w(q) for all y, w ∈ W . In
particular, equation (r4) with λ = 0 is just equation (R4) with λ = 0. Hence the second assertion follows from
Proposition 2.3.5.
(cid:3)

Lemma 4.3.2. For every z ∈ W and k ∈ {1, . . . , n}, we have

Xx∈W

(−1)ℓ(z,x)qℓ(xw0) X∆∈P <(z,x)

βk≤e(∆)

qdeg(∆)(q − 1)ℓ(∆) = q|{j | j<k and z<zsβj }|.

Proof. We prove the desired equation by descending induction on ℓ(z). When ℓ(z) = ℓ(w0), then z = w0 and
hence the desired equation follows immediately.

Now, we assume that ℓ(z) < ℓ(w0), and proceed also by induction on k. When k = 1, we have

(−1)ℓ(z,x)qℓ(xw0) X∆∈P <(z,x)

qdeg(∆)(q − 1)ℓ(∆)

(−1)ℓ(z,x)qℓ(xw0)R<

z,x(q) = 1

(by (r4) with λ = 0),

and

L.H.S. = Xx∈W
= Xx∈W

R.H.S. = q0 = 1.

Hence we assume that k ≥ 2. Here observe that since z, x ∈ W , every edge of a path in P <(z, x) is a reﬂection
edge, and hence mβl = 0 for all l = 1, . . . , n.

If zsβk−1 < z, then there does not exist any path beginning with an edge of the form z

0−−−→
βk−1
for each ∆ ∈ P <(z, x), we have βk ≤ e(∆) if and only if βk−1 ≤ e(∆). From this, we deduce that

. Therefore,

L.H.S. = Xx∈W

X∆∈P <(z,x), βk≤e(∆)

(−1)ℓ(z,x)qℓ(xw0)

qdeg(∆)(q − 1)ℓ(∆)

= q|{j | j<k−1 and z<zsβj }|
= q|{j | j<k and z<zsβj }|.

(by our induction hypothesis applied to k − 1)

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

25

If z < zsβk−1, then we see that

L.H.S. = Xx∈W

(−1)ℓ(z,x)qℓ(xw0)(cid:0) X∆∈P <(z,x)

βk−1≤e(∆)

qdeg(∆)(q − 1)ℓ(∆) − X∆∈P <(z,x)

βk−1≤e(∆) and βk−1∈e(∆)

qdeg(∆)(q − 1)ℓ(∆)(cid:1)

= q|{j | j<k−1 and z<zsβj }|

(−1)ℓ(zsβk−1

+ Xx∈W

,x)qℓ(xw0) X∆∈P <(zsβk−1

βk≤e(∆)

,x)

qdeg(∆)+ 1

2(cid:0)ℓ(z,zsβk−1 )−1(cid:1)(q − 1)ℓ(∆)+1

= q|{j | j<k−1 and z<zsβj }|

+ (q − 1)q

1

2(cid:0)ℓ(z,zsβk−1 )−1(cid:1)+|{j | j<k and zsβk−1

< zsβk−1

sβj }|,

where the second equality follows from our induction hypothesis applied to k − 1, and the third one follows from
the desired equality for zsβk−1. Therefore, if we show the equality

(cid:12)(cid:12){j | j < k − 1 and z < zsβj }(cid:12)(cid:12) =(cid:12)(cid:12){j | j < k and zsβk−1 < zsβk−1sβj }(cid:12)(cid:12) +

then we can complete the proof of the lemma. This equality will be shown in the next lemma.

1

2(cid:0)ℓ(z, zsβk−1) − 1(cid:1),

(cid:3)

Lemma 4.3.3. Let z ∈ W , and k ∈ {2, . . . , n} be such that z < zsβk−1. Then,

(cid:12)(cid:12){j | j < k − 1 and z < zsβj }(cid:12)(cid:12) =(cid:12)(cid:12){j | j < k and zsβk−1 < zsβk−1sβj }(cid:12)(cid:12) +

1

2(cid:0)ℓ(z, zsβk−1) − 1(cid:1).

Proof. Let i ∈ {1, . . . , n}. Then we easily deduce the following by using basic facts about the ordinary Bruhat
order and length function:

z < zsβi if and only if z(βi) ∈ Φ+;
zsβk−1 < zsβk−1sβi if and only if zsβk−1(βi) ∈ Φ+;
ℓ(z) = |{j | z(βj) ∈ −Φ+}|;

ℓ(zsβk−1) =(cid:12)(cid:12){j | zsβk−1(βj ) ∈ −Φ+}(cid:12)(cid:12).

following:

Now, let i′ ∈ {1, . . . , n} be such that sβk−1(βi) ∈ {βi′ , −βi′ }. Then, i ∈ {1, . . . , n} satisﬁes exactly one of the

[1] i < k − 1, z(βi) ∈ −Φ+, and zsβk−1(βi) ∈ −Φ+;
[2] i > k − 1, z(βi) ∈ −Φ+, and zsβk−1(βi) ∈ −Φ+;
[3] i < k − 1, z(βi) ∈ Φ+, and zsβk−1(βi) ∈ Φ+;
[4] i > k − 1, z(βi) ∈ Φ+, and zsβk−1(βi) ∈ Φ+;
[5] i = k − 1;
[6] i < k − 1, z(βi) ∈ −Φ+, zsβk−1(βi) ∈ Φ+, and sβk−1(βi) ∈ Φ+;
[7] i > k − 1, z(βi) ∈ −Φ+, zsβk−1(βi) ∈ Φ+, and sβk−1(βi) ∈ Φ+;
[8] i < k − 1, z(βi) ∈ Φ+, zsβk−1(βi) ∈ −Φ+, and sβk−1(βi) ∈ −Φ+;
[9] i > k − 1, z(βi) ∈ Φ+, zsβk−1(βi) ∈ −Φ+, and sβk−1(βi) ∈ −Φ+;
[10] i < k − 1, z(βi) ∈ −Φ+, zsβk−1(βi) ∈ Φ+, and sβk−1(βi) ∈ −Φ+;
[11] i > k − 1, z(βi) ∈ −Φ+, zsβk−1(βi) ∈ Φ+, and sβk−1(βi) ∈ −Φ+;
[12] i < k − 1, z(βi) ∈ Φ+, zsβk−1(βi) ∈ −Φ+, and sβk−1(βi) ∈ Φ+;
[13] i > k − 1, z(βi) ∈ Φ+, zsβk−1(βi) ∈ −Φ+, and sβk−1(βi) ∈ Φ+.

In the following, for each a = 1, 2, . . . , 13, we denote by ca the number of l, 1 ≤ l ≤ n, satisfying condition
[a]. If we are in case [6], then we have z(sβk−1(βi)) ∈ Φ+, zsβk−1(sβk−1 (βi)) ∈ −Φ+, sβk−1(sβk−1 (βi)) ∈ Φ+,
sβk−1 (βi) = βi′ , and sβk−1(βi) = βi − hβi, β∨
k−1iβk−1. Since i < k − 1 in this case, either i < i′ < k − 1 or
i′ < i < k − 1 holds. Hence case [12] holds for i′. Conversely, by a similar argument, case [12] for i implies case
[6] for i′. Therefore, we ﬁnd that c6 = c12. Similarly, we can show that c7 = c13, c8 = c9, and c10 = c11.

26

H. WATANABE AND S. NAITO

Finally, from the equalities above, we deduce by using the assertions at the beginning of the proof that

(cid:12)(cid:12){j < k − 1 | z < zsβj }(cid:12)(cid:12) = c1 + c8 + c12,
(cid:12)(cid:12){j < k | zsβk−1 < zsβk−1sβj }(cid:12)(cid:12) = c1 + c6 + c10,

= c5 + 2(c8 − c10),

ℓ(z, zsβk−1) = c1 + c2 + c5 + c8 + c9 + c12 + c13 − (c1 + c2 + c6 + c7 + c10 + c11)

c3 = 1.

These equalities, together with the equality c6 = c12, prove the lemma.

(cid:3)

Proposition 4.3.4. For every z ∈ W and k ∈ {1, 2, . . . , n} such that z < zsβk, we have

Xx∈W

(−1)ℓ(z,x)qℓ(xw0) X∆∈P <(z,x)

qdeg(∆)(q − 1)ℓ(∆)

βk<e(∆)
q

+

q − 1 Xx∈W

(−1)ℓ(z,x)qℓ(xw0)

X∆∈P <(z,x)

βk≤e(∆) and βk∈e(∆)

qdeg(∆)(q − 1)ℓ(∆) = 0.

Proof. We compute as follows:

L.H.S. = Xx∈W

(−1)ℓ(z,x)qℓ(xw0) X∆∈P <(z,x)
q − 1 Xx∈W

βk≤e(∆)

(−1)ℓ(z,x)qℓ(xw0)

1

+

= q|{j|j<k and z<zsβj }|

+

1

q − 1 Xx∈W

(−1)ℓ(z,x)qℓ(xw0)

qdeg(∆)(q − 1)ℓ(∆)

X∆∈P <(z,x)

βk≤e(∆) and βk∈e(∆)

X∆∈P <(z,x)

βk≤e(∆) and βk∈e(∆)

qdeg(∆)(q − 1)ℓ(∆)

qdeg(∆)(q − 1)ℓ(∆)

= q|{j|j<k and z<zsβj }|

−

1

q − 1 Xx∈W

(−1)ℓ(zsβk

,x)qℓ(xw0) X∆′∈P <(zsβk

βk+1≤e(∆′)

,x)

= q|{j|j<k and z<zsβj }| − q|{j|j<k+1 and zsβk
= 0 (by Lemma 4.3.3),

<zsβk

sβj }|+ 1

2(cid:0)ℓ(z,zsβk )−1(cid:1)

qdeg(∆′)+ 1

2(cid:0)ℓ(z,zsβk )−1(cid:1)(q − 1)ℓ(∆′)+1

where the second and fourth equalities follow from Lemma 4.3.2. This proves the proposition.

(cid:3)

Proposition 4.3.5. Let z ∈ W , λ ∈ Q∨ \ {0}, and k ∈ {1, . . . , n}. Then we have

(−1)ℓ

Xx∈W

∞

2 (z,xtλ)qℓ(xw0) X∆∈P <(z,xtλ)

βk≤e(∆)

qdeg ∆(q − 1)ℓ(∆) = 0.

Proof. If λ /∈ Q∨
λ ∈ Q∨

+ \ {0}.

+, then the set P <(z, xtλ) is empty since z (cid:2) ∞

2

xtλ for any x ∈ W . Hence we assume that

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

27

Since λ 6= 0, for each ∆ = (z = z0

m1−−→
βi1

· · · mr−−→
βir

zr = xtλ) ∈ P <(z, xtλ), we can take the largest j for which

zj ∈ W ; clearly, j < r. With this notation, we deﬁne b(∆) ∈ W tβ∨

by:

ij+1

If we set

ij+1

zjtβ∨
zjsβij+1

tβ∨

ij+1

if zj < zjsβij+1
if zj > zjsβij+1

,

.

b(∆) =

m1−−→
βi1

· · ·

mj−−→
βij
mj+2−−−→
βij+2

zj

1−−−→
βij+1
· · · mr−−→
βir
mj+2−−−→
βij+2

∆′ = (z = z0

b(∆)) ∈ P <(z, b(∆)),

∆′′ = (b(∆) = zj+1

zr = xtλ) ∈ P <(b(∆), xtλ),

∆′′′ = (b(∆)

mj+1−1
−−−−−→

βij+1

zj+1

· · · mr−−→
βir

zr = xtλ) ∈ P <(b(∆), xtλ),

then we can check by direct calculation that

qdeg(∆)(q − 1)ℓ(∆) =(qdeg(∆′)(q − 1)ℓ(∆′)qdeg(∆′′)(q − 1)ℓ(∆′′)

qdeg(∆′)(q − 1)ℓ(∆′) q

q−1 qdeg(∆′′′)(q − 1)ℓ(∆′′′)

if b(∆) = zj+1,
if b(∆) 6= zj+1.

Conversely, assume that we are given b = cl(b)twt(b) ∈ Waf , ∆′ ∈ P <(z, b), and ∆′′ ∈ P <(b, xtλ) satisfying

the following conditions:

(∗) wt(b) = β∨
i
(∗∗) βk ≤ e(∆′), and all elements of Waf appearing in ∆′ belong to W , except for b;

for some i ≥ k;

(∗ ∗ ∗) wt(b) < e(∆′′).
Then we can construct ∆ ∈ P <(z, xtλ) by concatenating ∆′ and ∆′′; this ∆ satisﬁes

b(∆) = b,

βk ≤ e(∆),

qdeg(∆)(q − 1)ℓ(∆) = qdeg(∆′)(q − 1)ℓ(∆′)qdeg(∆′′)(q − 1)ℓ(∆′′).

Similarly, if we are given b ∈ Waf , ∆′ ∈ P <(z, b), and ∆′′′ ∈ P <(b, xtλ) satisfying conditions (∗), (∗∗), and that
wt(b) ≤ e(∆′′′), wt(b) ∈ e(∆′′′), then we can construct ∆ ∈ P <(z, xtλ) by concatenating ∆′ and ∆′′′; this ∆
satisﬁes

b(∆) = b,

βk ≤ e(∆),

qdeg(∆)(q − 1)ℓ(∆) = qdeg(∆′)(q − 1)ℓ(∆′)

q

q − 1

qdeg(∆′′′)(q − 1)ℓ(∆′′′).

From the above, we see that

∞

2 (z,xtλ)qℓ(xw0) X∆∈P <(z,xtλ)

βk≤e(∆)

qdeg ∆(q − 1)ℓ(∆)

∞

(−1)ℓ

(−1)ℓ

Xx∈W
= Xb∈Waf
βk≤wt(b)∈Φ+ Xx∈W
βk≤wt(b)∈Φ+ X∆′∈P <(z,b)
= Xb∈Waf
·(cid:16) X∆′′∈P <(b,xtλ)

wt(b)<e(∆′′)

2 (z,xtλ)qℓ(xw0)

X∆∈P <(z,xtλ)
qdeg(∆′)(q − 1)ℓ(∆′) Xx∈W

βk≤e(∆) and b(∆)=b

(−1)ℓ

qdeg(∆)(q − 1)ℓ(∆)

∞

2 (z,xtλ)qℓ(xw0)

∆′ satisﬁes (∗∗)
qdeg(∆′′)(q − 1)ℓ(∆′′) +

q

q − 1

X∆′′′∈P <(b,xtλ)

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17).

equation

Now, let us write λ = Pl
Xx∈W

2 (z,xtλ)qℓ(xw0)

(−1)ℓ

∞

·(cid:16) X∆′′∈P <(b,xtλ)

wt(b)<e(∆′′)

28

H. WATANABE AND S. NAITO

i=1 niα∨

i ∈ Q∨

+, and set |λ| = Pl

i=1 ni. We complete the proof by showing the

qdeg(∆′′)(q − 1)ℓ(∆′′) +

q

q − 1

X∆′′′∈P <(b,xtλ)

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17) = 0

for all b ∈ Waf such that βk ≤ wt(b) ∈ Φ+ by induction on |λ|. When |λ| = 1, then λ is a simple coroot,
and hence either λ − wt(b) /∈ Q∨
+ or λ − wt(b) = 0 holds for each b ∈ Waf such that βk ≤ wt(b) ∈ Φ+. If
λ − wt(b) /∈ Q∨
+, then the sum in the parentheses above is equal to 0 since P <(b, xtλ) is empty. If λ − wt(b) = 0,
then we compute:

qdeg(∆′′)(q − 1)ℓ(∆′′) +

qdeg(∆′′)(q − 1)ℓ(∆′′) +

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

q

q − 1 X∆′′′∈P <(b,xtλ)
q − 1 X∆′′′∈P <(cl(b),x)

q

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17)
qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17)

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

qdeg(∆′′)(q − 1)ℓ(∆′′) +

q

q − 1 X∆′′′∈P <(cl(b),x)

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17)

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

∞

(−1)ℓ

wt(b)<e(∆′′)

2 (z,xtλ)qℓ(xw0)(cid:16) X∆′′∈P <(b,xtλ)
(−1)ℓ(z,x)qℓ(xw0)(cid:16) X∆′′∈P <(cl(b),x)

Xx∈W
= Xx∈W
= (−1)ℓ(z,cl(b)) Xx∈W

(−1)ℓ(cl(b),x)qℓ(xw0)

wt(b)<e(∆′′)

·(cid:16) X∆′′∈P <(cl(b),x)

wt(b)<e(∆′′)

= 0 (by Proposition 4.3.4),

∞

(−1)ℓ

2 (z,xtλ)qℓ(xw0)(cid:16) X∆′′∈P <(b,xtλ)

wt(b)<e(∆′′)

∞

(−1)ℓ

2 (z,xtλ)qℓ(xw0)

Xx∈W
= Xx∈W

·(cid:16)

X

∆′′∈P <(cl(b),xtλ−wt(b))

wt(b)<e(∆′′)

2 (z,xtλ) = (−1)ℓ(z,x)+2hρ,λi = (−1)ℓ(z,x), and the third equality follows
where the ﬁrst equality holds since (−1)ℓ
from Proposition 4.3.4 applied to cl(b) ∈ W and wt(b) ∈ Φ+ (note that we have cl(b) < cl(b)swt(b) by the
deﬁnitions of b and b(∆)). This proves the desired equation when |λ| = 1. When |λ| ≥ 2, we compute:

∞

qdeg(∆′′)(q − 1)ℓ(∆′′) +

q

q − 1 X∆′′′∈P <(b,xtλ)

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17)

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

qdeg(∆′′)(q − 1)ℓ(∆′′) +

q

q − 1 X

∆′′′∈P <(cl(b),xtλ−wt(b))

wt(b)≤e(∆′′′) and wt(b)∈e(∆′′′)

qdeg(∆′′′)(q − 1)ℓ(∆′′′)(cid:17)

= 0 (by our induction hypothesis applied to |λ| − wt(b)).

This completes the proof of the proposition.

(cid:3)

5. Another description of Theorem 2.4.4

In the actual computation of periodic R-polynomials for which Theorem 2.4.4 is used, it is sometimes diﬃcult
to determine whether or not a given path is an element of P <(y, w). Hence it would be convenient to describe
the paths in P <(y, w) in a diﬀerent way. For this purpose, we introduce a new ﬁnite directed graph, which we
call the double Bruhat graph (DBG). The idea is to take the “ﬁnite” part of a path.

5.1. The double Bruhat graph.

Deﬁnition 5.1.1. The double Bruhat graph associated to a ﬁnite Weyl group W and a ﬁnite root system
Φ is the directed graph with vertex set W , in which two vertices y′ and w′ are joined by a labeled arrow
y′ d−→

w′ (β ∈ Φ+, d ∈ Z>0) if and only if one of the following conditions holds:

β

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

29

(1) y′ < w′, w′ = y′sβ and d = 1
(2) y′ > w′, w′ = y′sβ and d = 1

2 (ℓ(y′, w′) + 1);
2 (ℓ(y′, w′) + 2hρ, β∨i + 1).

An edge that satisfy condition (1) (resp., (2)) is called a Bruhat edge (resp., quantum edge).

Example 5.1.2. In type A2, the DBG is as follows.

s1s2

α1

w0

α1 + α2

2

s2

α1 + α2

α2

α2

2

α2

α1

s2s1

α1 + α2

2

α1

e

s1

The Bruhat edges and quantum edges are indicated by the ordinary arrows and dotted arrows, respectively;
the labels 1 are omitted.

Fix a reﬂection order < on Φ+. Let y, w ∈ Waf , and write them as y = cl(y)twt(y) and w = cl(w)twt(w).

Deﬁnition 5.1.3. A label-increasing double Bruhat path of length k from y to w with respect to the reﬂection
d1−→
order < is a sequence ∆ = (cl(y) = y′
y′
k = cl(w)) of directed edges in DBG such that β1 ≤ · · · ≤ βk
0
β1
β∨
i = wt(w) − wt(y); we denote the length k of a path ∆ by ℓ(∆). Let

· · · dk−→
βk

and Pi∈{1,...,k | y′

di−→
βi

i−1

y′
i is quantum}

DBP<(y, w) denote the set of label-increasing double Bruhat paths from y to w.

Deﬁnition 5.1.4. Let ∆ = (y′ = y′
0

d1−→
β1

· · · dk−→
βk

k = w′) ∈ DBP<(y, w).
y′

(1) We set e(∆) := {βi | i = 1, 2, . . . , k}; the cardinality of this set is denoted by ℓ′(∆), which does not

necessarily agree with k = ℓ(∆).

(2) The degree of ∆ is deﬁned to be the integer

deg(∆) :=

di − ℓ′(∆).

kXi=1

5.2. Another description.
Proposition 5.2.1. For each y, w ∈ Waf , there exists a bijection DBP<(y, w) → P <(y, w), ∆ 7→ ˜∆, such that
deg(∆) = deg( ˜∆) and ℓ′(∆) = ℓ( ˜∆).
Proof. Let ∆ ∈ DBP<(y, w), and write it as:

∆ = (cl(y) = y′
0

d0,1−−→
β1

y′
0,1

d0,2−−→
β1

y′
0,2

d0,3−−→
β1

· · ·

d0,a1−−−→

β1

0,a1 = y′
y′

1

d1,1−−→
β2

y′
1,1

d1,2−−→
β2

· · ·

dk−1,ak
−−−−−→

βk

y′
k−1,ak = y′

k = cl(w)),

with β1 < β2 < · · · < βk. For each i = 1, . . . , k, we deﬁne ui = cl(ui)twt(ui) ∈ Waf as follows:

u0 = y,

ui =(ui−1tmiβ∨

i

cl(ui−1)sβi twt(ui−1)+miβ∨

i

(ai = 2mi),
(ai = 2mi ± 1),

30

H. WATANABE AND S. NAITO

where mi is the number of quantum edges in the path y′
then y′
ui−1

i−1 −→ y′
i−1,1 is a Bruhat edge, and if ai = 2mi − 1 then, y′

ui, and

i−1 −→ y′
mi−−→
βi

i−1,1 −→ · · · −→ y′
i−1 −→ y′

i−1,ai; note that if ai = 2mi + 1,
i−1,1 is a quantum edge. Then, we have

2 (ui−1, ui) − 2(cid:1) + mi
2 (ui−1, ui) − 1(cid:1) + mi
2 (ui−1, ui) − 1(cid:1) + mi − 1.

∞

(ai = 2mi),
(ai = 2mi + 1),
(ai = 2mi − 1).

deg(ui−1

mi−−→
βi

∞

∞

1

1

1

ui) =
2(cid:0)ℓ
2(cid:0)ℓ
2(cid:0)ℓ
e∆ := (y = u0

i−1

di−1,1−−−−→

βi

· · ·

di−1,ai
−−−−→

βi

u1

m1−−→
β1

m2−−→
β2

· · · mk−−→
βk

We now deﬁne e∆ to be
It is easy to see that e∆ ∈ P <(y, w) and ℓ′(∆) = ℓ(e∆).
In order to show that deg(∆) = deg(e∆), we need to compare the contribution of y′
yi to deg(e∆). If ai = 2mi, then the former is
aiXj=1

i to deg(∆) and that of yi−1

i−1,ai = y′
y′

di−1,j − 1,

uk = w).

mi−−→
βi

and the latter is

deg(ui−1

mi−−→
βi

ui) =

1
2

ℓ

∞

2 (ui−1, ui) + mi − 1.

= hρ, miβ∨

i i + mi − 1.

Here, by the deﬁnition of DBP<(y, w), we have

di−1,j−1 + di−1,j = hρ, β∨

i i + 1

for all j = 2, 4, . . . , ai. Therefore, we see that

aiXj=1

di−1,j − 1 =

1
2

ai(hρ, β∨

i i + 1) − 1

= mi(hρ, β∨
= mihρ, β∨

i i + 1) − 1
i i + mi − 1.

If ai = 2mi + 1, then the former is

and the latter is

deg(ui−1

mi−−→
βi

ui) =

=

=

∞

1

di−1,1 +

di−1,j − 1,

aiXj=2
2 (ui−1, ui) − 1(cid:1) + mi
2(cid:0)ℓ
2(cid:0)ℓ
2(cid:0)ℓ(cl(ui−1), cl(ui−1)sβi) + 1(cid:1) + hρ, miβ∨

2 (ui−1, cl(ui−1)sβitwt(ui−1)) + ℓ

i i + mi − 1.

1

1

∞

∞

= di−1,1 + mihρ, β∨

2 (cl(ui−1)sβitwt(ui−1), ui) − 1(cid:1) + mi

i i − 1 + mi

In a way similar to the case ai = 2mi, we deduce that

di−1,j = mihρ, β∨

i i + mi.

aiXj=2

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

31

If ai = 2mi − 1, then the former is

di−1,j − 1,

and the latter is
mi−−→
βi

deg(ui−1

ui) =

=

=

∞

1

di−1,1 +

aiXj=2
2 (ui−1, ui) − 1(cid:1) + mi − 1
2(cid:0)ℓ
2(cid:0)ℓ
2(cid:0)ℓ(cl(ui−1), cl(ui−1)sβi tβ∨

2 (ui−1, cl(ui−1)sβi twt(ui−1+β∨

i i + mi − 2.

1

1

∞

i

= di−1,1 + (mi − 1)hρ, β∨

i )) + ℓ

∞

2 (cl(ui−1)sβi twt(ui−1)+β∨

i

) + 1(cid:1) + hρ, (mi − 1)β∨

i i − 1 + mi − 1

, ui) − 1(cid:1) + mi − 1

In a way similar to the case ai = 2mi, we deduce that

di−1,j = (mi − 1)hρ, β∨

i i + mi − 1.

aiXj=2

Thus, in all cases above, the equality deg(∆) = deg(e∆) holds.
The correspondence ∆ 7→ e∆ is bijective. Indeed, its inverse is given as follows. Let e∆ = (y = u0

uk = w) ∈ P <(y, w). To each ui−1

ui, we assign a path

mi−−→
βi

m1−−→
β1

· · · mk−−→
βk

where

(y′

i−1

di−1,1−−−−→

βi

y′
i−1,1

di−1,2−−−−→

βi

· · ·

di−1,ai
−−−−→

βi

i−1,ai = y′
y′

i),

2mi

2mi + 1

2mi − 1

ai =

y′
i−1 = cl(ui−1),

i−1,j =(cl(ui−1)

cl(ui−1)sβi

y′

(ui−1

(ui−1

(ui−1

mi−−→
βi
mi−−→
βi
mi−−→
βi

ui is a translation edge),

ui is a reﬂection edge and cl(ui−1) < cl(ui−1)sβi),

ui is a reﬂection edge and cl(ui−1) > cl(ui−1)sβi),

(j is even),
(j is odd).

By concatenating the paths above, we obtain a path ∆ ∈ DBP<(y, w) such that deg(∆) = deg(e∆) and ℓ′(∆) =
ℓ(e∆). This completes the proof of the proposition.

Theorem 5.2.2. For each y, w ∈ Waf , we have

(cid:3)

Ry,w(q) = X∆∈DBP<(y,w)

qdeg(∆)(q − 1)ℓ′(∆).

Proof. This follows from Theorem 2.4.4 and Lemma 5.2.1

(cid:3)

Example 5.2.3. In type A2, let y = e, w = w0tα∨
as follows:

1 +α∨
2

, α1 < α1 + α2 < α2. The elements of DBP<(y, w) are

∆1 = (e

2−−−−→
α1+α2

w0

1−−−−→
α1+α2

e

s2s1

∆2 = (e 1−→
α1
∆3 = (e 1−→
α1
∆4 = (e 1−→
α1

s1

s1

s1

1−−−−→
α1+α2
1−→
α1
1−→
α1

e

2−−−−→
α1+α2

e 1−→
α1

s1

2−−−−→
α1+α2
2−−−−→
α1+α2

w0

1−→
α2
1−−−−→
α1+α2

w0),

s1

1−−−−→
α1+α2
1−→
α2
1−→
α2

s2s1

s2s1

s2s1

1−→
α2

w0),

w0),

w0

1−→
α2

s2s1

1−→
α2

w0).

32

H. WATANABE AND S. NAITO

In this case, we have

Therefore, we obtain

deg(∆1) = 4,
deg(∆2) = 3,
deg(∆3) = 3,
deg(∆4) = 4,

ℓ′(∆1) = 1,
ℓ′(∆2) = 3,
ℓ′(∆3) = 3,
ℓ′(∆4) = 3.

Re,w0tα∨

1 +α∨
2

(q) = q4(q − 1) + 2q3(q − 1)3 + q4(q − 1)3.

References

[AF] T. Arakawa and P. Fiebig, On the restricted Verma modules at the critical level, Trans. Amer. Math. Soc. 364 (2012), no. 9,

4683-4712.

[BeBe] A. Beilinson and J. Bernstein, Localisation de g-modules, C. R. Acad. Sci. Paris S´er. I Math. 292 (1981), no. 1, 15-18.
[BjBr] A. Bj¨orner and F. Brenti, Combinatorics of Coxeter Groups, Graduate Texts in Mathematics vol. 231, Springer, New York,

2005.

[BK] J. L. Brylinski and M. Kashiwara, Kazhdan-Lusztig conjecture and holonomic systems, Invent. Math. 64 (1981), no. 3,

387-410.

[D] M. J. Dyer, Hecke algebras and shellings of Bruhat intervals, Compositio Math. 89 (1993), no. 1, 91-115.
[H1] J. Humphreys, Introduction to Lie Algebras and Representation Theory: second printing, revised edition, Graduate Texts in

Mathematics vol. 9, Springer-Verlag, New York-Berlin, 1978.

[H2] J. Humphreys, Reﬂection Groups and Coxeter Groups, Cambridge Studies in Advanced Mathematics vol. 29, Cambridge

University Press, Cambridge, 1990.

[K] S. Kato, On the Kazhdan-Lusztig polynomials for aﬃne Weyl groups, Adv. in Math. 55 (1985), no. 2, 103-130.
[KL] D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math. 53 (1979), no. 2, 165-184.
[L] G. Lusztig, Hecke algebras and Jantzen’s generic decomposition patterns, Adv. in Math. 37 (1980), no. 2, 121-164.
[P] D. Peterson, Quantum Cohomology of G/P, Lecture Notes, Cambridge, MA, Massachusetts Institute of Technology, 1997.

(H. Watanabe) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku, Tokyo

152-8551, Japan

E-mail address: watanabe.h.at@m.titech.ac.jp

(S. Naito) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku, Tokyo

152-8551, Japan

E-mail address: naito@math.titech.ac.jp

