Weak and strong convergence of derivations and

stability of ﬂows with respect to MGH convergence

Luigi Ambrosio ∗

Federico Stra †

Dario Trevisan ‡

March 18, 2016

Abstract

This paper is devoted to the study of weak and strong convergence of derivations,
and of the ﬂows associated to them, when dealing with a sequence of metric measure
structures (X, d, mn), mn weakly convergent to m. In particular, under curvature as-
sumptions, either only on the limit metric structure (X, d, m) or on the whole sequence
of metric measure spaces, we provide several stability results.

6
1
0
2

 
r
a

 

M
7
1

 
 
]

.

G
M
h
t
a
m

[
 
 

1
v
1
6
5
5
0

.

3
0
6
1
:
v
i
X
r
a

Contents

1 Introduction

I Preliminary results

2 Notation

3 Derivations

II Weak/strong convergence of derivations

4 Weak convergence of derivations and compactness

5 Strong convergence of derivations

6 Convergence of gradient derivations under Mosco convergence

III Flows associated to derivations and their convergence

7 Continuity equations and ﬂows associated to derivations

8 Convergence of ﬂows under Ricci curvature bounds

Appendix

∗Scuola Normale Superiore, luigi.ambrosio@sns.it
†Scuola Normale Superiore, federico.stra@sns.it
‡Università di Pisa, dario.trevisan@unipi.it

1

2

5

5

10

14

15

17

21

24

24

30

31

A Minimal relaxed slopes and Cheeger energy

B An approximation result

1 Introduction

31

33

In this paper we study convergence of vector ﬁelds, more precisely derivations, and La-
grangian ﬂows with respect to measured Gromov-Hausdorﬀ convergence. The literature
on the topic of MGH convergence is very wide (see for instance [GMS13], [GR07], [St06],
[Sh], [Vi09]) and the convergence problems can be attacked from diﬀerent points of view,
depending also on the richness of the structure under consideration. Our motivations
come from two diﬀerent directions: the ﬁrst one is a deeper investigation of the conver-
gence of gradient derivations, particularly in the case when all spaces (Xn, dn, mn) belong
to the same class RCD(K,∞) of [AGS14b]. In this respect, our results provide a kind of
local version of the Mosco convergence of the 2-Cheeger energies estabilished in [GMS13].
This local version will play a role in a forthcoming paper [AH16], where Mosco conver-
gence is proved for all p-Cheeger energies, also with stability results for BV functions,
Cheeger constants and Hessians. The second motivation comes as a natural complement
of [AT14], where well-posedness of ﬂows associated to suﬃciently regular derivations b
(see Theorem 8.1) is proved for the ﬁrst time in a nonsmooth setting, which includes
RCD(K,∞) metric measure spaces (X, d, m). It is then natural to investigate the stability
question (as in the Euclidean theory [AC13]), assuming that the derivations depend on n
and that the reference measures mn are variable.

In this paper, when dealing with these problems, we systematically adopt the so-called
extrinsic point of view in MGH convergence. Namely, up to an isometric embedding, we
assume that neither X nor d depend on n. We assume then that mn are locally uniformly
ﬁnite and nonnegative Borel measures in (X, d) which weakly converge to m, namely

RX v dmn → RX v dm for all v ∈ Cbs(X), where Cbs(X) is the space of bounded continuous

functions with bounded support. As illustrated for instance in [GMS13] (where several
notions of convergence are carefully compared, for sequences of pointed metric measure
spaces), this point of view is not really restrictive, and basically unavoidable when treating
Lagrangian questions such as the convergence of ﬂows. Indeed, some coupling between
points in the diﬀerent spaces is necessary to prove convergence of paths to paths, and the
simplest way to achieve this is to embed all metric structures into a common one. Still in
connection with the metric structure (X, d), we assume only completeness and separability;
dropping local compactness assumptions is useful to include in the theory all RCD(K,∞)
spaces.
Now we pass to a more detailed description of the content of this paper. It consists
of a ﬁrst part where we recall the basic properties of derivations and two more parts, an
“Eulerian” one, dealing with the convergence of derivations and particularly of gradient
derivations, and a “Lagrangian” part, dealing with the convergence of ﬂows, that can be
read almost independently.

In the seminal paper [W00] the concept of derivation is used to build a good
Part I.
notion of tangent bundle in metric spaces, the main idea being to describe the bundle
implicitly through the collection of its (m-measurable) sections. These sections, called
derivations, are linear maps b : Lipb(X) → L0(X, m) which satisfy suitable continuity and
locality properties. In this paper we almost completely adopt the point of view of [G15b],

2

where besides linearity one assumes the validity of the inequality

|b(f )| ≤ h|Df|

m-a.e. in X, for all f ∈ Lipb(X).

(1.1)

The only diﬀerence is that, since we are dealing with a sequence of measures, we keep
Lipb(X) as domain of derivation, to have m-independent domains, instead of the Sobolev
space considered in [G15b].
In [G15b] a systematic analysis of ﬁrst and second order
calculus based on this notion is made, including in particular the L2 duality between
tangent and cotangent bundle, see Remark 3.5. The quantity |Df| in the right hand side
of (1.1) is the minimal relaxed slope of [Ch99], which provides integral representation to
Cheeger’s energy Ch, see Appendix A for a quick introduction to this concept. By duality,
the minimal h in (1.1) is denoted by |b| (strictly speaking, we should use the notation
Chm, |b|m to stress the dependence of these concepts on m). The L2 duality estabilished in
[G15b] is particularly useful for us to read the Hilbertian character of the norm |b| in terms
of the cotangent bundle, i.e. in terms of quadraticity of Cheeger’s energy. According to
the theory developed in [AGS14a] and [AGS14b], this is the analytically most convenient
formulation.

In order to treat weak convergence of derivations from the sequential point of view
it is technically useful to consider a countable algebra A ⊂ Lipb(X) of “test” functions.
In the spirit of Gromov’s reconstruction theorem [GR07] and many other results of the
theory (see also [KK] in connection with Cheeger’s coordinates in PI spaces and the more
recent work [CKS15]) it is natural to consider the algebra ﬁnitely generated by truncations
of distance functions. To make it separable, we consider a countable dense set D ⊂ X
and deﬁne A as in (2.3), also considering the subalgebra Abs of functions with bounded
support. In connection with this choice, denoting by H 1,2(X, d, m) the domain of Ch, we
shall also need this approximation result (where Lipa stands for the asymptotic Lipschitz
for all f in H 1,2(X, d, m), there exist fn ∈ Abs with fn → f and
constant, see (2.1)):
Lipa(fn) → |Df| in L2(X, m).
Its proof, given in Appendix B, is a further reﬁnement of the techniques and of the
results developed in [AGS14a] (see also [ACDM15]), where the approximating functions
where chosen, as in [Ch99], in the larger class Lipb(X) ∩ L2(X, m).

In this part we discuss weak convergence of derivations and criteria for strong
Part II.
convergence. Even though some of our results deal with time-dependent derivations (more
natural for the study of ﬂows, in Part III), we present in this introduction only the au-
tonomous case. We say that bn, derivations in (X, d, mn), weakly converge in duality with
Abs to b, derivation in (X, d, m), and write bn

Abs−−⇀ b, if

lim

n→∞ZX

bn(f )v dmn = ZX

b(f )v dm

∀f ∈ Abs, v ∈ Cb(X).

(1.2)

Recall that the divergence div b of a derivation is deﬁned by duality, via the formula
RX f div b dm = −RX
b(f ) dm for all f ∈ Lipbs(X) (as for Ch and |b|, we should use the no-
tation divm, to stress the dependence on m). In presence of uniform bounds on |bn| and on
their divergences, Theorem 4.1 provides a sequential compactness result totally indepen-
dent of regularity assumptions on the metric measure structures. Due to the close relation
between vector ﬁelds with bounds on divergence and normal currents (see in particular the
discussion in [PS14, Appendix A]), this result is reminiscent of the compactness result for
normal currents in [AK]. Notice that the above mentioned approximation result provided
in Appendix B is necessary to pass to the limit in the inequality |bn(f )| ≤ |bn|mn|Df|mn,

3

using as intermediate step the weaker inequality with the asymptotic Lipschitz constant
in the right hand side.

When we deal with gradient derivations the bounds on divergence correspond to Lapla-
cian bounds, which could be too restrictive for some applications. For this reason, under
suitable regularity assumptions (only) on the limit metric measure structure (X, d, m),
which are satisﬁed by all RCD(K,∞) spaces, it is technically convenient to replace in (1.2)
the algebra Abs by a more regular class of test functions, namely {Ptf : t ∈ Q+, f ∈ Abs},
letting v vary in Cbs(X) (since the support of Ptf may have inﬁnite measure, unless all
measures mn are ﬁnite). With this new notion of weak convergence, for which we use the
P Abs−−−⇀ b, we provide another sequential compactness result, see Theorem 4.4,
notation bn
free of divergence bounds; in Remark 4.5 we show that, under uniform bounds on diver-
gence, the two notions of convergence are equivalent.

In addition, for the convergence in duality with PtAbs, we provide a criterion for strong

convergence when there is no loss of norm in the limit, namely

lim sup

n→∞ ZX

Θ(|bn|) dmn ≤ ZX

Θ(|b|) dm < ∞

with Θ strictly convex and with more than linear growth at inﬁnity. The proof of this
criterion, given in Theorem 5.3, is probably the most technical part of our paper: its proof
follows closely ideas from the theory of Young measures ([Va90], [AGS08, Section 5.4]),
with the extra diﬃculties due to the fact that we don’t have a pointwise description of
the tangent bundle (but, via a suitable concept of pre-derivation, we provide a kind of
replacement for this).

Finally, we conclude this part by discussing the convergence of gradient derivations. If
fn ∈ H 1,2(X, d, mn) strongly converge in H 1,2 to f ∈ H 1,2(X, d, m) (i.e. lim supn
Chn(fn) ≤
Ch(f )) we prove in Theorem 6.4, under a Mosco convergence assumption (fulﬁlled by
sequences of RCD(K,∞) spaces as in [GMS13]) that the induced derivations bfn strongly
converge in L2 to bf , meaning that bfn(a) converge in L2 to bf (a) for all a ∈ PtAbs. These
results will play an important role in [AH16].

In this part we discuss the stability of ﬂows w.r.t. strong convergence of deriva-
Part III.
tions. As in [AT14], we say that X(t, x) is a regular ﬂow relative to a possibly time de-
pendent derivation bt, t ∈ (0, T ), if X(0, x) = x, X(· , x) is absolutely continuous in [0, T ]
for m-a.e. x and solves the ODE γ′ = bt ◦ γ in the following weak sense:

d
dt

f ◦ X(t, x) = bt(f )(X(t, x))

for L 1 × m-a.e. (t, x) ∈ (0, T ) × X,

(1.3)

for all f ∈ Lipb(X). The adjective “regular” refers, as in the Euclidean theory (see [AC13]
and the references therein) to the non-concentration condition X(t, · )#m ≤ C m for all
t ∈ (0, T ), with C = C(X, m). When the limit structure (X, d, m) is a RCD(K,∞) space
and the regularity assumptions on b of Theorem 8.1 hold (which ensure uniqueness of the
regular ﬂow X relative to bt), we are able to provide in Theorem 8.2 a convergence result
for regular ﬂows Xn relative to bn,t, assuming strong convergence of bn,t to bt, uniform
growth bounds and supn C(Xn, mn) < ∞. Here convergence is undertood as convergence
in measure, namely convergence of the C([0, T ]; X)-valued maps x 7→ Xn(· , x) to the map
x 7→ X(· , x); the notion of convergence in measure can be adapted to our case, where
even the reference measures are variable.
The strategy is to prove, via tightness estimates, convergence to a regular generalized
ﬂow π relative to bt (see Deﬁnition 7.4 for this more general concept of ﬂow) and then use

4

the regularity of bt to extract a “deterministic” ﬂow out of it. The key step, where strong
convergence of the derivations bn,t is involved, is that the ODE condition (1.3) passes
to the limit; in the proof of this we use a new principle (see Proposition 7.6) based on
the continuity equation which would lead also to the simpliﬁcation of some proofs of the
Euclidean theory (see for instance Theorem 12 of [AC13]).

Acknowledgments. The third author has been supported by project PRA_2016_41
from Pisa University. The ﬁrst and third authors are members of the GNAMPA research
group of the Istituto Nazionale di Alta Matematica (INdAM).

Part I
Preliminary results

2 Notation

In a metric space (X, d), we denote by Br(x) and ¯Br(x) the open
Metric concepts.
and closed balls respectively, by Cbs(X) the space of continuous functions with bounded
support, by Lipbs(X) ⊂ Cbs(X) the subspace of Lipschitz functions. We use the notation
Cb(X) and Lipb(X) for bounded continuous and bounded Lipschitz functions respectively.
For a function f : X → R we denote by Lip(f ) ∈ [0,∞] its Lipschitz constant. We

also deﬁne the asymptotic Lipschitz constant by

Lipa f (x) = inf
r>0

Lip(cid:16)f(cid:12)(cid:12)Br(x)(cid:17) = lim

r→0+

Lip(cid:16)f(cid:12)(cid:12)Br(x)(cid:17) ,

(2.1)

which is upper semicontinuous. If I ⊂ R is an interval, we denote by AC(I; X) ⊂ C(I; X)
the space of absolutely continuous maps w.r.t. d, satisfying

d(γ(s), γ(t)) ≤ Z t

s

g(r) dr

for all s, t ∈ I with s ≤ t

(2.2)

for some (nonnegative) g ∈ L1(I). We denote by evt : C(I; X) → X the evaluation map
at time t, i.e. evt(γ) = γ(t).

The metric derivative | ˙γ| : ˚I → [0,∞] of γ ∈ AC(I; X) is the Borel map deﬁned by

| ˙γ|(t) := lim sup

s→t

d(γ(s), γ(t))

|s − t|

and it can be proved (see for instance [AGS08, Theorem 1.1.2]) that the lim sup is a limit
L 1-a.e. in I, that | ˙γ| ∈ L1(I) and that | ˙γ| is the smallest L1 function with the property
(2.2), up to L 1-negligible sets.

The metric algebras A , Abs.
(X, d) a countable dense set D ⊂ X and the smallest set A ⊂ Lipb(X) containing

In the sequel we associate to any separable metric space

min{d(· , x), k} with k ∈ Q ∩ [0,∞], x ∈ D,

(2.3)

which is a vector space over Q and is stable under products and lattice operations. It is a
countable set and it depends only on the choice of D (we do not emphasize this dependence
in our notation). We shall also consider the subalgebra Abs of functions with bounded
support.

5

Measure-theoretic notation. The Borel σ-algebra of a metric space (X, d) is denoted
by B(X). The Borel signed measures with ﬁnite total variation are denoted by M (X),
while we use the notation M +(X), M +
loc(X), P(X) for nonnegative ﬁnite Borel measures,
Borel measures which are ﬁnite on bounded sets and Borel probability measures. For
E ∈ B(X) the restriction operator µ 7→ µ E is deﬁned by µ E(B) = µ(B ∩ E) for all
B ∈ B(X).
loc(X, m) for the Lp spaces when m is non-
negative, including also the case p < 1 (when p = 0 the spaces L0(X, m) = L0
loc(X, m) cor-
respond to the class of real-valued m-measurable functions). Notice that, in this context
where no local compactness assumption is made, Lp
loc means p-integrability on bounded
subsets.

We use the standard notation Lp(X, m), Lp

loc(X) to M +

Given metric spaces (X, dX ) and (Y, dY ) and a Borel map f : X → Y , we denote
by f# the induced push-forward operator, mapping P(X) to P(Y ), M +(X) to M +(Y )
and, if the preimage of bounded sets is bounded, M +
loc(Y ). Notice that, for
all µ ∈ M +(X), f#µ is well deﬁned also if f is µ-measurable.
Deﬁnition 2.1 (Metric measure space). A metric measure space is a triple (X, d, m),
where (X, d) is a complete and separable metric space and m ∈ M +
Convergence of functions and measures. We say that fn ∈ Lipb(X) converge in
the ﬂat sense to f ∈ Lipb(X) if fn → f pointwise in X and supn(sup|fn| + Lip(fn)) < ∞.
If pointwise convergence occurs only m-a.e., we say that fn → f in the m-ﬂat sense.
We say that mn ∈ Mloc(X) weakly converge to m ∈ Mloc(X) if RX v dmn → RX v dm
as n → ∞ for all v ∈ Cbs(X). When all the measures mn as well as m are probability
measures, this is equivalent to requiring that RX v dmn → RX v dm as n → ∞ for all
v ∈ Cb(X). We shall also use the following well-known proposition.
Proposition 2.2. If mn weakly converge to m in M +

loc(X).

loc(X) and if

lim sup

n→∞ ZX

Θ dmn < ∞

for some Borel Θ : X → [0,∞], then
lim

n→∞ZX

v dmn = ZX

v dm

(2.4)

for all v : X → R continuous with limd(x,¯x)→∞ |v|(x)/Θ(x) = 0 for some (and thus all)
¯x ∈ X. If Θ : X → [0,∞) is continuous and

lim sup

n→∞ ZX

Θ dmn ≤ ZX

Θ dm < ∞,

then (2.4) holds for all v : X → R continuous with |v| ≤ CΘ for some constant C.

For a sequence (mn) ⊂ M +

loc(X) that weakly converges to m ∈ M +

loc(X), we introduce
following [GMS13] the following notions of weak and strong convergence for a sequence of
Borel functions fn : X → R, n ≥ 1.
Weak convergence. For p ∈ (1,∞], we say that fn ∈ Lp(X, mn) converge to f ∈
Lp(X, m) weakly (weakly-* if p = ∞) in Lp if fnmn weakly converge to f m in Mloc(X),
with
(2.5)

lim sup
n→∞ kfnkLp(X,mn) < ∞.

6

In such a situation, one has kfkLp(X,m) ≤ lim inf n kfnkLp(X,mn). Moreover, if p ∈ (1,∞),
any sequence fn ∈ Lp(X, mn) such that (2.5) holds admits a subsequence weakly converg-
ing to some f ∈ Lp(X, m).
We notice that, if two sequences fn, gn ∈ Lp(X, mn) weakly converge in Lp respectively
to f , g ∈ Lp(X, m) and satisfy 0 ≤ fn ≤ gnh, mn-a.e. in X, where h : X → R+ is bounded
and upper semicontinuous, then f ≤ gh, m-a.e. in X. This follows from duality with
ϕ ∈ Cbs(X), ϕ ≥ 0, and the fact that h is the pointwise inﬁmum of bounded continuous
functions.

Strong convergence. For p ∈ (1,∞) we say that fn ∈ Lp(X, mn) converge to f strongly
in Lp if, in addition to weak convergence in Lp, one has lim supn kfnkLp(X,mn) ≤ kfkLp(X,m).
In such a situation, one can prove that weak convergence of fnmn ∈ Mloc(X) to f m
improves to

lim

n→∞ZX

vnfnmn =ZX

vf m,

∀vn ∈ Lp′

(X, mn) weakly converging in Lp′

to v,

(2.6)

where p′ is the conjugate exponent of p. Moreover, given two sequences fn, gn ∈ Lp(X, mn)
strongly converging in Lp respectively to f, g ∈ Lp(X, m), one can show that fn + gn
strongly converges in Lp to f + g. Other improvements, which also motivate the terminol-
ogy strong convergence, are discussed in Remark 2.6.

In the special case p = 1, we say that fn ∈ L1(X, mn) converge to f ∈ L1(X, mn)
weakly in L1 if fnmn weakly converge to f m in Mloc(X). Since in the context of variable
measures it seems not easy to formulate an adequate notion of equi-integrability, this
notion is strictly weaker than the classical weak L1 convergence when the measure is ﬁxed.
However, suﬃcient conditions for sequential compactness w.r.t. weak L1 convergence can
be stated also in the case of variable measures.

has subsequences (fn(k)) weakly convergent in L1.

Lemma 2.3. The following properties hold.
(i) If |fn| ≤ gnhn with gn bounded in L2 and hn strongly convergent in L2, then (fn)
(ii) If supnRX Θ(|fn|) dmn < ∞ for some Θ : [0,∞) → [0,∞] with more than linear

growth at inﬁnity, then (fn) has subsequences (fn(k)) weakly convergent in L1. In
addition, if Θ is convex and lower semicontinuous,

ZX

Θ(|f|) dm ≤ lim inf

k→∞ ZX

Θ(|fn(k)|) dmn(k).

Proof.

(i) Let h be the strong L2 limit of hn and L = supn kgnkL2(X,mn). It is easy to
check that any limit point µ of fnmn satisﬁes µ(C) ≤ L(cid:0)RC h2 dm)1/2 for all C ⊂ X closed
and bounded, hence µ ≪ m.

(ii) It follows by a classical duality argument, see for instance [AGS08, Lemma 9.4.3].

All such notions of weak and strong convergence have natural local analogues.

In
particular, we say that fn converge to f weakly in Lp
loc (resp. weakly-* if p = ∞) if fnv
converge to f v weakly in Lp (resp. weakly-* if p = ∞) for all v ∈ Cbs(X). In the case of
strong Lp
loc convergence, p ∈ (1,∞), we ask that fnmn weakly converge to f m in Mloc(X),
with

lim sup
n→∞ kfnkLp(BR(¯x),mn) ≤ kfkLp(BR(¯x),m) < ∞

7

for some ¯x ∈ X and arbitrarily large R. It follows immediately that (2.6) holds for all vn
weakly converging in Lp′
Even in the simplest case when mn = m, another natural notion of convergence for

to v with ∪n supp vn bounded in X.

metric-valued maps is convergence in measure.

Convergence in measure for metric space valued maps. Given a metric space
(Y, dY ), we say that Borel functions fn : X → Y (locally) converge in measure to a Borel
f : X → Y if, for every Φ ∈ Cb(Y ) one has that Φ(fn)mn weakly converge to Φ(f )m,
namely

lim

n→∞ZX

vΦ(fn) dmn = ZX

vΦ(f ) dm

∀v ∈ Cbs(X).

(2.7)

Notice that, choosing Φ to be constant, already (2.7) encodes the weak convergence of mn
to m, so strictly speaking this should be understood as a convergence of pairs (fn, mn),
where mn are reference measures for fn. It is also easy to check that, when mn = m is
ﬁxed, this requirement is equivalent to the usual notion of local convergence in m-measure.
In the following proposition we provide equivalent formulations of the convergence
in measure. To this aim, we introduce the following terminology: we say that a family
(µn) ⊂ M +
loc(X×Y ) is locally tight w.r.t. X if, for some ¯x ∈ X and all R > 0, the measures
µn BR(¯x) × Y are tight. Accordingly, we denote by Cbsx(X × Y ) the space

Cbsx(X × Y ) := {f ∈ Cb(X × Y ) : supp(f ) ⊂ BR(¯x) × F for some ¯x ∈ X, R > 0}

and we say that µn

Cbsx(X×Y )

−−−−−−−⇀ µ if µn → µ in the duality with Cbsx(X × Y ).

Proposition 2.4. Let (Y, dY ) be a metric space, let mn be weakly convergent to m in
M +

loc(X) and let fn, f : X → Y be Borel. The following conditions are equivalent:
(a) fn converge to f in measure;
(b) for any Φ ∈ Cb(Y ) and any vn ∈ L1(X, mn) weakly converging to v ∈ L1(X, m) in

L1 with ∪n supp(vn) ⊂ BR(¯x) for some ¯x ∈ X and R > 0, one has

lim

n→∞ZX

vnΦ(fn) dmn = ZX

vΦ(f ) dm;

(c) (Id× (Φ◦ fn))#mn converge in duality with Cbsx(X × R) to (Id× (Φ◦ f ))#m for any

Φ ∈ Cb(Y ).

Cbsx(X×Y )

−−−−−−−⇀ (Id × f )#m.

Under the assumption that (Id × fn)#mn are locally tight w.r.t. X, (a), (b), (c) are also
equivalent to (Id × fn)#mn
Proof. For ease of notation, write µn := (Id × fn)#mn, and µ = (Id × f )#m. It is obvious
that the convergence of µn to µ in duality with Cbsx(X × Y ) implies (c), and that (b)
implies (a).
We ﬁrst prove the implications (c) =⇒ (b) and (a) =⇒ (c), which provide the equiv-
alence between (a), (b), (c). In the proof of these two implications, without any loss of
generality we may assume that Y is a compact interval of R, say Y = [0, 1], and that Φ is
the identity map (it is suﬃcient to argue with ﬁxed Φ ∈ Cb(X) and replace fn with Φ◦ fn,
f with Φ ◦ f ).

8

(c) =⇒ (b). Let vn, v as in (b), with supn kvnkL1(X,mn) ≤ 1, and let w ∈ Cbs(X). By

weak convergence of the measures vnmn to vm,

lim

n→∞ZX

vnfn dmn = lim

n→∞ZX

vnw dmn +ZX

vn(fn − w) dmn = Z vw dm,

because

lim sup

= lim sup

ZX×Y

vn(x) (y − w(x)) dµn(x, y)(cid:12)(cid:12)(cid:12)(cid:12)

n→∞ (cid:12)(cid:12)(cid:12)(cid:12)
vn(fn − w) dmn(cid:12)(cid:12)(cid:12)(cid:12)
n→∞ (cid:12)(cid:12)(cid:12)(cid:12)
ZX
n→∞ (MZBR(¯x)∩{|vn|≤M } |y − w(x)| dµn(x, y) + mn ({|vn| > M}))
≤ lim sup
≤ MZ ¯BR(¯x)×Y |y − w(x)| dµ(x, y) +
= MZ ¯BR(¯x) |f (x) − w(x)| dm(x) +

1
M
1
M

,

loc( ¯BR(¯x), m), we may optimize the

and M > 0 is arbitrary. By density of Cbs(X) in L1
choice of w and then let M → ∞ to conclude.
(a) =⇒ (c). The family (µn) is locally tight w.r.t. X, thanks to the local tightness of
mn in X (recall that we are assuming that Y is compact). In addition, any weak limit
point σ of (µn) in duality with Cbsx(X × Y ) agrees with µ on test functions φ(x, y) of the
form ψ(x)Φ(y), with ψ ∈ Cbs(X) and Φ ∈ Cb(Y ). This class of functions is suﬃcient to
prove that σ = µ, hence µn weakly converge to µ in duality with Cbsx(X × Y ).
Finally, for general metric spaces (Y, dY ), if we assume that (µn) is locally tight w.r.t. X,
the argument used to prove that (a) implies (c) works and provides the weak convergence
of µn to µ in duality with Cbsx(X × Y ).
Remark 2.5 (The case of probability measures). In the study of ﬂows, we shall need
convergence in measure of C([0, T ]; X)-valued maps; in this case the reference measures for
our maps will be probability measures (actually marginal measures of probabilities deﬁned
on C([0, T ]; X)). In this simpler case the results of Proposition 2.4 can be strengthened.
Indeed when all mn as well as m are probability measures, an equivalent formulation of
the convergence in measure (2.7) is with test functions v ∈ Cb(X). In addition, stating (b)
without any bound on the support of vn and replacing Cbsx(X × Y ) with Cb(X × Y ), in
this modiﬁed form (a), (b), (c) are still equivalent; ﬁnally, assuming a priori the tightness
of µn, these notions are equivalent to the weak convergence of µn to µ in P(X × Y ).

In the following remark we compare strong convergence with convergence in measure.
Remark 2.6 (Convergence in measure versus strong Lp convergence). In the case Y = R it
is natural to compare strong convergence in Lp, p ∈ (1,∞), with convergence in measure.
As in the case of a ﬁxed measure, for sequences convergent in measure and uniformly
bounded in Lp
loc as in (2.5) for some p ∈ (1,∞), one can use the stability of convergence
in measure under truncations and property (b) to show strong convergence in Lq
loc for any
q ∈ (1, p) and then (thanks to weak Lp compactness), weak convergence in Lp if the bound
is uniform in Lp. Conversely, if fn converge strongly in Lp, strong convexity of the function
Θ(z) = |z|p and a detailed analysis of the limit points of the measures µ = (Id × fn)#mn
in the duality with Cbsx(X × R) (see for instance [AGS08, Section 5.4], [GMS13]) show
that fn → f in measure.

9

Normed L∞ modules. Recall that a (real) L∞(X, m)-module M is a real vector space
with the additional structure of bilinear multiplication by L∞(X, m) functions χ : m ∈
M 7→ χm ∈ M , with the associativity property χ(χ′m) = (χχ′)m; in addition, multipli-
cation by λ ∈ R corresponds to the multiplication by the L∞(X, m) function equal m-a.e.
to λ.
We say that L∞(X, m)-module M is a L2(X, m)-normed module if there exists a “point-

wise norm” | ·| : M → {f ∈ L2(X, m) : f ≥ 0} satisfying:
(a) |m + m′| ≤ |m| + |m′| m-a.e. in X for all m, m′ ∈ M ;
(b) |χm| = |χ||m| m-a.e. in X for all m ∈ M , χ ∈ L∞(X, m);
with the property that

kmk := (cid:18)ZX |m(x)|2 dm(x)(cid:19)

1/2

(2.8)

is a norm in M . Notice that the homogeneity and the subadditivity of k·k are obvious
consequences of (a), (b).
If M is a L2(X, m)-normed module, we can deﬁne M ∗ as the set of all continuous
L∞(X, m)-module isomorphisms L : M → L1(X, m), i.e. linear maps satisfying, for some
h ∈ L2(X, m) and all χ ∈ L∞(X, m), m ∈ M , the properties

L(χm) = χL(m),

|L(m)| ≤ h|m|

m-a.e. in X.

The set M ∗ can also be given the structure of L2(X, m)-module, deﬁning |L| as the least
function h (in the m-a.e. sense) satisfying the inequality above.
Finally, we say that a L2(X, m)-normed module M is an Hilbert module if (M,k ·k) is
The following result has been proved in [G15b]; see Proposition 1.2.21 and Theo-

a Hilbert space when endowed with the natural norm in (2.8).

rem 1.2.24 therein.

Theorem 2.7. Let (X, m) be a measure space and let M be a L2(X, m)-normed Hilbert
module. Then the following facts hold.

(i) The map

hm, m′ix := |m + m′|(x)2 − |m − m′|(x)2

4

provides a L∞(X, m)-bilinear and continuous map from M × M to L1(X, m), with
k|m|k2

L2(X,m) = khm, mikL1(X,m).

(ii) (Riesz theorem) For all L ∈ M ∗ there exists mL ∈ M such that |L| = |m| m-a.e. in

X) (in particular kLk = kmLk) and

L(m)(x) = hmL, mix

for m-a.e. x ∈ X, for all m ∈ M.

3 Derivations

The following deﬁnition is inspired by Weaver [W00], but in the statement of the quanti-
tative locality property we follow more closely the point of view systematically pursued in
[G15b]. Recall that |Df| denotes the minimal relaxed slope, as deﬁned in Appendix A.

10

Deﬁnition 3.1 (Derivations). A derivation on a metric measure space (X, d, m) is a linear
functional b : Lipb(X) → L0(X, m) which, for some h ∈ L0(X, m), satisﬁes the quantitative
locality property

|b(f )| ≤ h|Df|

m-a.e. in X, for all f ∈ Lipb(X).

The m-a.e. smallest function h with this property is denoted by |b| and is called (local)
norm of b. We denote by Der(X, d, m) the space of derivations. For p ∈ [1,∞], we denote
by Derp(X, d, m) (resp. Derp
loc(X, d, m)) the space of derivations b such that |b| ∈ Lp(X, m)
(resp. Lp

loc(X, m)).

Notice that, thanks to the locality of the minimal relaxed slope |Df| on Borel sets,
the choice of Lipb(X) instead of Lipbs(X) is not so relevant, because any functional b :
Lipbs(X) → L0(X, m) satisfying the locality property can be canonically extended to a
derivation ˜b, without increasing the norm, by setting

˜b(f )(x) = b(fR)(x)

m-a.e. in BR(¯x)

where fR ∈ Lipbs(X) coincide with f in BR(¯x). As a matter of fact, when integrals are
involved, we shall more often work with Lipbs(X).
As illustrated in details in [G15b], arguments analogous to [AK] provide the chain rule

(with ϕ : R → R Lipschitz)

b(ϕ ◦ f ) = (ϕ′ ◦ f )b(f )

m-a.e. in X for every f ∈ Lipb(X)

and the Leibniz rule

b(f g) = b(f )g + f b(g)

m-a.e. in X for every f, g ∈ Lipb(X)

as a consequence of additivity and locality (see also, in connection with the Leibniz prop-
erty, Remark 3.3 below).

Any b ∈ Der2(X, d, m) can be canonically extended to H 1,2(X, d, m) if Ch is quadratic,
retaining the condition |b(f )| ≤ |b||Df| using the existence, for all f ∈ H 1,2(X, d, m),
of Lipschitz functions fn with |D(f − fn)| → 0 in L2(X, m) (so that b(fn) is a Cauchy
sequence in L1(X, m)). More generally, this extension is possible whenever H 1,2(X, d, m)
is reﬂexive.

We can now deﬁne pre-derivations by restricting the domain to Abs and imposing a
weaker locality condition, with Lipa(f ) in place of |Df| in the right hand side. As for
derivations, thanks to locality on open sets of Lipa, there is essentially no diﬀerence in
considering A or Abs as the domain of a pre-derivation.

Deﬁnition 3.2 (Pre-derivations). A pre-derivation on a metric measure space (X, d, m)
is a Q-linear functional b : Abs → L0(X, m) which, for some h ∈ L0(X, m), satisﬁes the
locality property

|b(f )| ≤ h Lipa(f )

m-a.e. in X, for all f ∈ Abs.

Remark 3.3. Any pre-derivation satisﬁes the Leibniz rule as a consequence of additivity
and locality. Indeed, it is suﬃcient to optimize over rational λ, µ the m-a.e. inequality

|b(f g) − λb(g) − µb(f )| ≤ h Lipa(cid:0)f g − λg − µf(cid:1) = h Lipa(cid:0)(f − λ)(g − µ)(cid:1)

≤ h[|f − λ| Lipa(g − µ) + |g − µ| Lipa(f − λ)].

11

Remark 3.4 (Diﬀerent axiomatizations). Assume that b : Lipb(X) → L0(X, m) is a linear
map satisfying the weaker locality condition

|b(f )| ≤ h Lipa(f )

m-a.e. in X.

for some h ∈ L1

loc(X, m) and the continuity w.r.t. ﬂat convergence
fn → f in Lipb(X) implies b(fn) → b(f ) weakly in L1

loc(X, m).

(3.1)

loc, see Lemma 3.9.

Then, b ∈ Der1(X, d, m) and |b| ≤ h.
Indeed, the inequality can be improved, getting
|Df| in the right hand side, using the continuity property and Theorem A.1. Notice that
an even weaker locality property will be considered in Lemma 5.2 (ii), and that (3.1) is
satisﬁed when div b ∈ L1
Remark 3.5 (Derivations as duals of the cotangent bundle). Notice that Der(X, d, m) has
a natural structure of L∞(X, m)-module, and that Der2(X, d, m) has the structure of
L2(X, m)-normed module, provided by the map b 7→ |b(x)|. More speciﬁcally, we shall use
at some stage that, if H 1,2(X, d, m) is reﬂexive (this assumption is not needed in [G15b]
because Gigli’s derivations are already deﬁned on H 1,2(X, d, m)), Der2(X, d, m) can be
canonically and isometrically identiﬁed with the dual of the cotangent bundle T ∗(X, d, m)
introduced in [G15b]; in this respect, Der2(X, d, m) can be thought as the collection of all
L2 sections of the tangent bundle of (X, d, m).

Let us recall ﬁrst the construction of T ∗(X, d, m) from [G15b]. It arises as the com-
pletion of the L2(X, m) normed pre-module consisting of ﬁnite collections (Ei, fi) with
Ei ∈ B(X) partition of X and fi ∈ H 1,2(X, d, m). Two collections (Ei, fi) and (Fj, gj ) are
identiﬁed if fi = gj m-a.e. in Ei ∩ Fj. The sum of (Ei, fi) and (Fj, gj ) is deﬁned in the nat-
ural way by taking the collection (Ei ∩ Fj, fi + gj) and the local norm |(Ei, fi)| ∈ L2(X, m)
of (Ei, fi) is deﬁned by

|(Ei, fi)|(x) := |Dfi|(x).

Thanks to the locality properties of the minimal relaxed slope, this deﬁnition does not
depend on the choice of the representative. Multiplication by Borel functions χ taking
ﬁnitely many values is deﬁned by

χ(Ei, fi) = (Ei ∩ Fj, zjfi)

with χ =

N

Xj=1

zjχFj

and satisﬁes |χ(Ei, Fi)| = |χ||(Ei, Fi)|. By completion of this structure we obtain the
L2(X, m) normed module T ∗(X, d, m).

Now, given any b ∈ Der2(X, d, m) we can deﬁne
Lb([Ei, fi]) := Xi
χEi

b(fi)

to obtain a L1(X, m)-valued functional on the pre-module which satisﬁes

|Lb([Ei, fi])| ≤ |b||[Ei, fi]|

m-a.e. in X

and is easily seen to be linear w.r.t. multiplications by Borel functions χ with ﬁnitely
many values. By completion, ˆb extends uniquely to a continuous L∞(X, m)-module ho-
momorphism from T ∗(X, d, m) to L1(X, m) with |Lb| ≤ |b|. From the deﬁnition of |b| we
immediately obtain that |Lb| = |b|. Conversely, it is immediately seen that any continuous
L∞(X, m)-module homomorphism L : T ∗(X, d, m) → L1(X, m) induces b ∈ Der2(X, d, m),
via the formula b(f ) := L([X, f ]).

12

In the following lemma we make the assumption that Ch is quadratic, which amounts
to say that the cotangent bundle is an Hilbert L2(X, m) module, to derive a strict convexity
property of the norm of derivations. Of course this convexity could be equally well be taken
as an assumption, but we preferred this path (and the use of Remark 3.5) because the
quadraticity condition on Ch is the most estabilished assumption in the recent literature
on RCD spaces.
Lemma 3.6. If Ch is quadratic, for all c, c′ ∈ Der(X, d, m) the condition

|c + c′| = |c| + |c′|

m-a.e. in X

(3.2)

implies

c(f ) = λ(c + c′)(f )

m-a.e. in X for all f ∈ Lipb(X),

with λ = |c|/(|c + c′|) on {|c + c′| > 0} (thus independent of f).
Proof. Let E = {min{|c|,|c′|} > 0}. We obviously need only to show that c(f ) = λ(c +
c′)(f ) m-a.e. in E for all f ∈ Lipb(X). Possibly multiplying c and c′ by a positive Borel
function χ with RX χ(|c|2 + |c′|2) dm < ∞ we see that it is not restrictive to assume that
both c and c′ belong to Der2(X, d, m). Now, the assumption that Ch is quadratic yields
that the cotangent bundle T ∗(X, d, m) described in Remark 3.5 is a L2(X, m)-normed
Hilbert module. By the identiﬁcation described in the same remark, the same holds for
Der2(X, d, m). Hence, we can use the bilinear map h· , ·ix on Der2(X, d, m)2 provided by
Theorem 2.7 to write the assumption (3.2) in the form

hc, c′ix = |c(x)||c′(x)|

m-a.e. in X.

Fix ¯x ∈ X, deﬁne now En = {x ∈ E : min{|c|,|c′|} ≥ 1/n} and set
1
|c′|

c′
n,R := χBR(¯x)∩En

cn,R := χBR(¯x)∩En

c,

1
|c|

c′.

Using L∞(X, m) bilinearity gives
hcn,R, c′

n,Rix = χBR(¯x)∩En

m-a.e. in X.

By integration we obtain

ZX |cn,R − c′

n,R|2 dm = 0,

hence cn,R = cn,R′. By approximation with respect to the parameters n and R, this gives
|c′|c(f ) = |c|c′(f ) m-a.e. on E for all f ∈ Lipb(X) and thus, with a simple algebraic
manipulation, the result.
Deﬁnition 3.7 (Divergence of derivations and pre-derivations). We say that b ∈ Der1
has divergence in L1

loc(X, m) satisfying

loc(X, d, m)

loc if there exists g ∈ L1
−ZX
f g dm

b(f ) dm = ZX

for all f ∈ Liploc(X).
The function g is uniquely determined and it will be denoted by div b.

(3.3)

The case of a pre-derivation is analogous: the only diﬀerence is that Liploc(X) has to

be replaced in (3.3) by Abs ⊂ A .
Lemma 3.8. Let b be a pre-derivation with h ∈ L2
there exists a unique extension to ˜b ∈ Der2

loc(X, m). Then
loc(X, d, m), with |˜b| ≤ h (and same divergence).

loc(X, m) and div b ∈ L1

13

Proof. By the locality property, it is suﬃcient to build b on Lipbs(X). Given f ∈ Lipbs(X),
let fn ∈ Abs be an approximating sequence as provided by Theorem B.1, i.e. such that
Lipa(fn) → |Df| in L2(X, m). Actually, up to truncating fn, we may assume that |fn| ≤
kfk∞, for n ≥ 1. By the bound |b(fn)| ≤ h Lipa(fn) and Lemma 2.3 (i), the family b(fn)
has weak limit points in L1

loc(X, m) and any weak limit point, denoted ˜b(f ), satisﬁes

|˜b(f )| ≤ h|Df|.

We only have to show that such limit is uniquely determined by the formula

ZX

ϕ˜b(f ) dm = −ZX

f ϕ div b dm −ZX

f b(ϕ) dm

∀ϕ ∈ Abs,

so that the whole family b(fn) will be weakly convergent and this will give that ˜b extends b
and that the map f 7→ ˜b(f ) is linear. Indeed, by deﬁnition of divergence, for any ϕ ∈ Abs
one has fnϕ ∈ Abs and thus

ZX

ϕb(fn) dm = −ZX

fnϕ div b dm −ZX

fnb(ϕ) dm.

By convergence of both sides, the same identity holds with f in place of fn and ˜b(f ) in
place of b(fn).
Lemma 3.9 (Continuity criterion w.r.t. ﬂat convergence). Let b ∈ Der1
assume that either b ∈ Div1
Proof. Let fn → f in Lipb(X). If b has divergence in L1

loc(X, d, m), or H 1,2(X, d, m) is reﬂexive. Then (3.1) holds.

loc, we can use the formula

loc(X, d, m) and

ZX

b(f )φ dm = −ZX

b(φ)f dm −ZX

f φ div b dm

φ ∈ Lipbs(X),

derived from the Leibniz rule to show that the continuity property. In the case when the
Sobolev space is reﬂexive, assuming (by locality) that the supports of fn are equibounded,
we obtain that fn → f weakly in H 1,2(X, d, m); hence, if w is any weak L1 limit point
of b(fn), we can obtain w as the limit of b(gn), with gn ﬁnite convex combinations of
fn convergent to f strongly in H 1,2(X, d, m). If follows that b(gn) → b(f ), hence w =
b(f ).

In the sequel we shall use the notation

Divq(X, d, m) := nb ∈ Der1

loc(X, d, m) : div b ∈ Lq(X, m)o

and the analogous notation Divq

loc(X, d, m).

Part II
Weak/strong convergence of derivations

loc(X) weakly convergent to m ∈ M +
Given (mn) ⊂ M +
consider notions of local convergence of bn to b ∈ Der1
strong one. We study these two concepts in the next two sections.

loc(X) and bn ∈ Der1

loc(X, d, mn), we
loc(X, d, m), two weak ones and a

14

4 Weak convergence of derivations and compactness

We say that bn ∈ Der1
Abs, and write bn
i.e.

loc(X, d, mn) weakly converge to b ∈ Der1

loc(X, d, m) in duality with
Abs−−⇀ b if, for all f ∈ Abs, bn(f )mn weakly converge to b(f )m as measures,
n→∞ZX

bn(f )v dmn = ZX

lim

b(f )v dm

∀v ∈ Cb(X).
Theorem 4.1 (Weak compactness of derivations). Let bn ∈ Der2
satisfying for some ¯x ∈ X and all R > 0 the conditions
n ZBR(¯x)

n ZBR(¯x) |bn|2 dmn < ∞,

sup

sup

Θ(| div bn|) dmn < ∞

loc ∩ Div1

loc(X, d, mn)

n(k) weakly convergent to b ∈ Der2

for some function Θ = ΘR : [0,∞) → [0,∞] with more than linear growth at inﬁnity.
Then there exists a subsequence b
Proof. Let ϕ ∈ Abs. Since |bn(ϕ)| is bounded in L2, up to a subsequence there exists a
weak L2 limit, that we denote by b(ϕ). By a diagonal argument, we may assume that
bn(ϕ) weakly converge in L2 to b(ϕ) for every ϕ ∈ Abs. We show that ϕ 7→ b(ϕ) deﬁnes
a pre-derivation with div b ∈ L1
Since Q-linearity is preserved by weak limits we only have to notice that locality of b
follows from

loc(X, m), hence by Lemma 3.8 we conclude.

loc ∩ Div1

loc(X, d, m).

|bn(ϕ)| ≤ |bn| |Dnϕ| ≤ |bn| Lipa(ϕ), mn-a.e. on X,

where ϕ ∈ Abs and |Dnϕ| denotes the minimal relaxed gradient of ϕ with respect to the
measure mn. Hence, by weak convergence in L2
loc(X, m) (possibly
taking a further subsequence) and upper semicontinuity of Lipa(ϕ), we conclude that

loc of |bn| to some h ∈ L2

|b(ϕ)| ≤ h Lipa(ϕ), m-a.e. on X.

Finally, a similar limiting argument proves that div bn has limit points w.r.t. the weak
L1

loc convergence, and that limit points correspond to div b.

Our second notion of weak convergence depends somehow on structural assumptions
on the metric measure structures, and actually only on the limit one. Let us assume that
the limit metric measure structure (X, d, m) satisﬁes the following regularity assumptions:

(a) Ch is quadratic;

(b) the linear semigroup Pt maps L∞(X, m) into Cb(X) (the so-called strong Feller

property);

(c) there exists ω : (0,∞) → [0,∞) such that ω(0+) = 1 and

Lipa(Ptf ) ≤ ω(t)qPt|Df|2 pointwise in X for all f ∈ L2(X, m)

for all t > 0.

(4.1)

spaces, in particular (4.1) holds with with ω(t) = e−Kt.

As illustrated in Appendix A, all these assumptions hold in RCD(K,∞) metric measure
In view of (4.1) it is natural to consider the countable class

Notice that, thanks to Theorem B.1, PQ+

PQ+

Abs := {Psf : f ∈ Abs, , s ∈ Q+} ⊂ Lipb(X).
Abs is dense in H 1,2(X, d, m).

(4.2)

15

Lemma 4.2. Under assumptions (a), (b), (c), any b ∈ Der(X, d, m) is uniquely deter-
mined by its values on PQ+
Proof. We need to prove that b ≡ 0 on PQ+
Abs implies b = 0. It is not restrictive to
assume b ∈ Der2(X, d, m). Since Psf → f in H 1,2(X, d, m) as s ↓ 0, we obtain that b ≡ 0
on Abs. Then, Theorem B.1 can be applied.

Abs.

Motivated by Lemma 4.2, we can deﬁne another notion of weak convergence.

Deﬁnition 4.3. We say that bn ∈ Der1(X, d, mn) weakly converge to b ∈ Der1(X, d, m)
Abs, bn(f )mn weakly
in duality with PQ+
converge to b(f )m as measures, i.e.

P Abs−−−⇀ b if, for all f ∈ PQ+

Abs, and write bn

lim

n→∞ZX

bn(f )v dmn = ZX

b(f )v dm

∀v ∈ Cbs(X).

With this new notion of weak convergence we can remove the bounds on divergence
and, at the same time, consider more general growth conditions (not necessarily quadratic)
on bn.

Theorem 4.4. Assume that (X, d, m) satisﬁes the regularity assumptions (a), (b), (c) and
let bn ∈ Der(X, d, mn) be satisfying

lim inf

n→∞ ZX

Θ(|bn|) dmn < ∞

for some function Θ : [0,∞) → [0,∞] with more than linear growth at inﬁnity. Then there
P Abs−−−⇀ b. In addition, if Θ is convex
exist a subsequence bn(k) and b ∈ Der(X, d, m) with bn
and lower semicontinuous, one has

k→∞ ZX

Θ(|b|) dm ≤ lim inf

Θ(|bn(k)|) dmn(k) < ∞.

ZX
Proof. Let a ∈ PQ+
Abs. Since |bn(a)| satisﬁes the assumptions of Lemma 2.3 (ii), up to a
subsequence there exists a weak L1 limit, that we denote by b(ϕ). By a diagonal argument,
we may assume that bn(a) weakly L1
Abs. For the
loc converge to b(a) for every a ∈ PQ+
same reason is also not restrictive to assume that |bn| weakly converge in L1
loc to h.
it is suﬃcient to prove

Since Q-linearity is preserved by weak local limits, taking Lemma 5.2 (ii) into account

|b(a)| ≤ h Lipa(a)

m-a.e. in X, for all a ∈ PQ+

Abs.

This can be achieved as in the proof of Theorem 4.1 passing to the limit in the inequality
|bn(a)| ≤ |bn| Lipa(a) and using the upper semicontinuity of the asymptotic Lipschitz
constant.

Abs−−⇀ b and bn

P Abs−−−⇀ b). Assume that we are in the setting of
Remark 4.5 (Comparison of bn
both Theorem 4.1 and Theorem 4.4, namely with uniform local equi-integrability bounds
on the divergences of bn and assumptions (a), (b), (c) on the limit metric measure structure.
Under this assumption, since both notions of convergence are sequentially compact, we
immediately get from Lemma 3.9 that bn

Abs−−⇀ b if and only if bn

P Abs−−−⇀ b.

16

5 Strong convergence of derivations

Still under the assumptions (a), (b), (c) of the previous section on the metric measure
structure, we want to study conditions under which weak convergence in duality with
PQ+ Abs improves to strong convergence, deﬁned as follows.
Deﬁnition 5.1 (Strong convergence of derivations). We say that bn ∈ Der1
strongly converge to b ∈ Der1
to b(f ). For p ∈ (1,∞), if for all f ∈ PQ+

loc(X, d, mn)
loc(X, d, m) if, for all f ∈ PQ+ Abs, bn(f ) converge in measure

Abs the stronger condition

lim sup

n→∞ ZBR(¯x) |bn(f )|p dmn ≤ ZBR(¯x) |b(f )|p dm < ∞

holds for inﬁnitely many R, we say that bn converge strongly in Lp

loc to b. Analogously, if

lim sup

n→∞ ZX |bn(f )|p dmn ≤ ZX |b(f )|p dm < ∞

we say that bn → b strongly in Lp.

Abs. As discussed in Remark 2.6, under uniform Lp

The terminology is a bit misleading, because strong convergence of bn should be un-
derstood as a “componentwise” strong convergence, where the components of the “vector
ﬁeld” are given by PQ+
loc bounds on
bn(f ) for some p > 1, the convergence in measure of bn(f ) to b(f ) yields convergence in
Lq
loc for all q ∈ (1, p) and therefore bn
The main goal of this section is to provide a suﬃcient condition for strong convergence.
To this aim, it is convenient to extend Abs to A∗, deﬁned as follows: A∗ is the smallest
Abs in (4.2). The
algebra, lattice and vector space over Q containing A and the set PQ+
set A∗ is still countable and we denote by a the generic element of A∗.

P Abs−−−⇀ b.

In the following lemma we show how to to build a derivation from a functional c :
A∗ → L0(X, m) satisfying a (very) weak locality property and a growth bound with the
global Lipschitz constant, see (5.1).

Lemma 5.2. Assume that (X, d, m) satisﬁes the regularity assumptions (a), (b), (c).
(i) Let c : A∗ → L0(X, m) be a linear functional satisfying the locality property c(a) = 0

m-a.e. in any open set U where a is constant, and

|c(a)| ≤ h Lip(a)

m-a.e. in X, for all a ∈ A∗

(5.1)

for some h ∈ L0(X, m). Then c is a pre-derivation, more precisely, (5.1) holds with
Lipa(a) in the right hand side.

(ii) If c : PQ+

Abs → L0(X, m) is Q-linear and satisﬁes

|c(a)| ≤ h Lipa(a)

m-a.e. in X, for all a ∈ PQ+

Abs,

for some h ∈ L0(X, m), then there exists a derivation b satisfying |b| ≤ h which
extends c.

Proof. (i) Let D be as in (2.3). We want to improve the bound on |c(a)| to |c(a)| ≤
h Lipa(a) m-a.e. in X for all a ∈ A∗. To this aim, we ﬁx a ∈ A∗ and a bounded open
set U ⊂ X and deﬁne LU to be the Lipschitz constant of the restriction of a to U . For
x0 ∈ U , choose x′
0) ⊂ Br(x0) ⊂ U ,

0 ∈ D and r > 0 suﬃciently small, such that Br/2(x′

17

rLU /2 ∈ Q. Then, for k ∈ Q+ larger than r/2 and a0 ∈ Q, a0 6= a(x0), we consider the
function A = max{A1, A2} ∈ A∗, with
r
A1(x) := min{|a(x) − a0|,
2

A2(x) := LU min{d(x, x′

0), k}.

LU},

Since Lip(A1|U ) ≤ LU , Lip(A2) ≤ LU and the set {A = A1} is contained in Br/2(x′
0), which
is contained in Br(x0) and in U , we obtain that Lip(A) ≤ LU . Choosing a0 suﬃciently
close to a(x0) we obtain that A1 = |a − a0| in a neighbourhood V of x0, and choosing x′
with

0

LU d(x0, x′

0) < |a(x0) − a0|

we obtain that A = |a − a0| in a neighbourhood V of x0. Hence, locality in V ∩ {a > a0}
and in V ∩ {a < a0} give

|c(a)| = |c(A)| ≤ h Lip(A) ≤ hLU

m-a.e. in V \ {a = a0}.

With two diﬀerent choices of a0, this proves that for any x0 ∈ U there exists a neighbour-
hood V of x0 such that |c(a)| ≤ hLU m-a.e. in V . Since x0 ∈ U is arbitrary, and since m
is concentrated on a σ-compact set, it follows that |c(a)| ≤ hLU m-a.e. in U . If {Ui} is a
countable basis for the open sets of (X, d) we can ﬁnd a m-negligible set N such that

|c(a)|(x) ≤ h(x)LUi

∀x ∈ Ui \ N, ∀i.

Since Lipa a(x) = inf Ui∋x LUi for all x ∈ X we conclude.

(ii) First we improve the upper bound (5.1) to

|c(a)| ≤ h|Da|

m-a.e. in X, for all a ∈ PQ+ Abs.

(5.2)

Indeed, one has

and, writing a = Pta′, taking the limit as Q+ ∋ s → 0+ of the inequality

m-a.e. in X, for all s ∈ Q+, a ∈ Abs

|c(Psa)| ≤ ω(s)h(cid:0)Ps|Da|2(cid:1)1/2
|c(Psa) − c(a)| = |c(Pt(Psa′ − a′))| ≤ ω(t)hPt(cid:0)|D(Psa′ − a′)|2(cid:1)1/2

provides the result. Then, we build b on Lipbs(X) by approximation, as a simple conse-
quence of (5.2) and the density of PQ+ Abs in H 1,2(X, d, m), arguing as in Lemma 3.8: if
f ∈ Lipbs(X) and an ∈ PQ+ Abs satisfy |D(an − f )| → 0 in L2(X, m) and m-a.e., thanks to
(5.2) the sequence b(an) converges m-a.e. and we deﬁne b(f ) as its limit. This provides a
derivation b with |b| ≤ h and b ≡ c on PQ+ Abs.

Abs, to strong convergence.

In the following theorem we show how to improve weak convergence, in the duality
In connection with the theory of ﬂows, we shall
with PQ+
also consider time-dependent derivations and therefore a time averaged version of weak
convergence, deriving as a consequence strong convergence in measure, with L 1 × mn
and L 1 × m as reference measures. Of course in the simpler autonomous case we get the
improvement from weak to strong convergence.

Theorem 5.3. Assume that (X, d, m) satisﬁes the regularity assumptions (a), (b), (c),
that bn,t ∈ Der1

loc(X, d, m) satisfy

loc(X, d, mn), bt ∈ Der1
n→∞Z T

χ(t)ZX

lim

0

bn,t(a)v dmn dt = Z T

0

χ(t)ZX

bt(a)v dm dt

18

for all χ ∈ Cc(0, T ), v ∈ Cbs(X), a ∈ PQ+

Abs, and that

lim sup

n→∞ Z T
0 ZX

Θ(|bn,t|) dmn dt ≤ Z T
0 ZX

Θ(|b|t) dm dt < ∞

(5.3)

with Θ : [0,∞) → [0,∞) strictly convex and having more than linear growth at inﬁnity.
Then bn,t converge strongly to bt and, if Θ(z) = |z|p for some p > 1, bn converge to b
strongly in Lp.

Proof. Step 1: the dual A ′
∗ of A∗. The Q-linear functionals from A∗ to R can be considered,
in some sense, as “pointwise” tangent vectors. More precisely, we denote by A ′
∗ the class
of Q-linear functionals L : A∗ → R satisfying |L(a)| ≤ C Lip(a) for all a ∈ A∗, for some
C ∈ [0,∞). The smallest C will then be denoted by kLk. We endow A ′
∗ with the coarser
topology that makes all maps L 7→ L(a), a ∈ A∗, continuous, so that L 7→ kLk is lower
semicontinuous in A ′
∗ : kLk ≤ c} are compact for all c ≥ 0. Since
A is countable we can easily ﬁnd a bounded distance in A ′
∗ which induces this topology.
Step 2: limit of bn,t in the sense of Young. Let us consider the maps Σn : (0, T )× X → A ′
∗
induced by bn,t, namely

∗ and the sets {L ∈ A ′

Σn(t, x)(a) := bn,t(a)(x)

and the push forward measures

σn := (Id × Σn)#L 1 × mn ∈ M +((0, T ) × X × A ′
∗).

Notice that, since A∗ is countable, σn is independent of the choice of Borel representatives
of bn,t(a), a ∈ A∗, and that kΣn(t, x)k ≤ |b|n,t(x) for L 1 × mn-a.e. (t, x). Since L 1 × mn
weakly converge to L 1× m, they are tight on bounded subsets, hence thanks to Prokhorov
theorem and the uniform bound onR Θ(kLk) dσn, we can assume with no loss of generality
that σn weakly converge to σ in (0, T ) × X × A ′
∗. Using test functions of the form ψ(t, x)
we can represent σ = σt,x ⊗ (L 1 × m), i.e.
ϕ(t, x, a) dσ = Z T

Z(0,T )×X×A ′

ϕ(t, x, a) dσt,x(a) dx dt.

∗

0 ZX ZA ′

∗

From now on, for simplicity of notation, we shall omit the integration domain (0, T )× X ×
A ′
∗.
Let a ∈ A∗ be constant in an open set A ⊂ X. Using test functions of the form
(t, x, L) 7→ χ(t)v(x)|L(a)| with v ∈ Cbs(X) null on X \ A we see immediately that σt,x
satisfy the following locality property: for L 1 × m-a.e. (t, x) ∈ (0, T )× A one has L(a) = 0
σt,x-a.e. in A ′

∗. Thanks to this property, deﬁning

˜bt(a)(x) := ZA ′

∗

L(a) dσt,x(L)

(5.4)

using the inequality |˜bt(a)(x)| ≤ Lip(a)RA∗ kLk dσt,x(L) and invoking Lemma 5.2 (ii) we

obtain

|˜bt(a)(x)| ≤ Lipa(a)ZA∗ kLk dσt,x(L)

m-a.e. in X, for all a ∈ A∗

(5.5)

for L 1-a.e. t ∈ (0, T ).
Set now Σ(t, x)(a) := bt(a)(x), a ∈ A∗. Our goal is to show that σt,x is a Dirac mass at
Σ(t, x) for L 1× m-a.e. (t, x). To this aim, we ﬁrst observe the following characterization of
Dirac masses in A ′
∗ ) concentrated on {L : kLk = c} for some c ≥ 0 is a Dirac

∗: ν ∈ P(A ′

19

mass if and only if, for all a ∈ A∗, ν is supported in one of the “halfspaces” {L : L(a) ≥ 0},
{L : L(a) ≤ 0}. Since A∗ is countable, this characterization follows by the implication

L(a)L′(a) ≥ 0 ∀a ∈ A∗ =⇒ L = λL′

for some λ ≥ 0.

In turn, the implication above follows by this elementary argument:
if a ∈ A∗ with
L′(a) 6= 0 and λ = L(a)/L′(a), for all a′ ∈ A∗ the functions s 7→ L(a+sa′), s 7→ λL′(a+sa′)
coincide at s = 0 and have the same sign if and only they coincide, i.e. L(a′) = λL′(a′).

Now, notice that (5.3) gives

Z Θ(kLk) dσ ≤ lim inf

n→∞ Z Θ(kLk) dσn ≤ ZX

Θ(|b|) dm.

(5.6)

On the other hand, using test functions (t, x, L) 7→ χ(t)v(x)L(a) with χ ∈ C∞
v ∈ Cbs(X) and a ∈ PQ+
and the convergence of bn,t to bt, passing to the limit as n → ∞ in the identity

c (0, T ),
Abs (notice that here we use the more than linear growth of Θ)

Z χ(t)v(x)L(a) dσn(t, x, L) = Z T

0

χ(t)ZX

bn,t(a)(x)v(x) dmn(x) dt

and using the arbitrariness of χ and v we obtain (with ˜bt as in (5.4))

˜bt(a)(x) = bt(a)(x)

∀a ∈ PQ+

Abs

(5.7)

for L 1 × m-a.e. (t, x) ∈ (0, T ) × X. From (5.5) it follows that

|bt(a)|(x) ≤ Lipa(a)ZA ′

∗ kLk dσx(L)

∀a ∈ PQ+

Abs

for L 1 × m-a.e. (t, x) ∈ (0, T ) × X, so that Lemma 5.2 (ii) gives

|bt|(x) ≤ ZA ′

∗ kLk dσx,t(L)

for L 1 × m-a.e. (t, x) ∈ (0, T ) × X.

Combining this information with (5.6) and the strict convexity of Θ we obtain that for
L 1 × m-a.e. (t, x) one has

kLk = |bt|(x)

for σt,x-a.e. L ∈ A ′
∗.

Now, let E be a closed set of A ′

∗ and deﬁne ci

c1

t (a)(x) := ZE

L(a) dσt,x(L),

t : A∗ → L0(X, m) by
t (a)(x) := ZA ′

∗\E

c2

L(a) dσt,x(L),

t + c2

t coincides with bt on A∗. Notice also that ci

so that ct := c1
property (thanks to the locality of σt,x) and (5.1) with h1
h2
t which coincide with ci
bi

∗\E kLk dσt,x(X). From Lemma 5.2 (i,ii) we obtain that ci

t on PQ+ Abs and satisfy

t satisfy the weak locality

t (x) = RE kLk dσt,x(X) and

t induce derivations

t (x) = RA ′
t|(x) ≤ ZE kLk dσt,x(L),
|b1

t|(x) ≤ ZA ′
|b2

∗\E kLk dσt,x(L) L 1 × m-a.e. in (0, T ) × X.

Since, thanks to Lemma 5.2 (ii), bt is uniquely determined by its values on PQ+ A∗, it
t| ≤ |bt| L 1 × m-a.e. in (0, T ) × X. Therefore
follows that bt = b1
t,x(a) ≥ 0 L 1 × m-a.e. for
we can invoke the strict convexity Lemma 3.6 to obtain b1

t and that |b1

t| + |b2

t,x(a)b2

t + b2

20

all a ∈ A∗; by letting E vary in a countable family of closed sets generating the σ-algebra
of A ′
∗, it follows that L 1 × m-a.e. measure σt,x is concentrated on {L : kLk = |bt,x|} and
satisﬁes the above mentioned criterion for being a Dirac mass. Coming back to (5.4) and
(5.7) we obtain that σt,x = δΣ(t,x).
Step 3. We proved that (Id×Σn)#L 1×mn weakly converge to (Id×Σ)#L 1×m. Recalling
the deﬁnitions of Σn and Σ, if we consider the continuous map (t, x, L) 7→ (t, x, L(a)) for
a ∈ PQ+ Abs ﬁxed, from Proposition 2.2 we obtain that strong convergence of bn,t(a) to
bt(a). In addition, if Θ(z) = |z|p for some p > 1, from the second part of Proposition 2.2
we get the strong Lp convergence of bn,t(a) to bt(a).

6 Convergence of gradient derivations under Mosco conver-

gence

In this section we use the typical notation of Γ-calculus, namely

Γ(f, g) := lim
ǫ↓0

|D(f + ǫg)|2 − |Df|2

2ǫ

f, g ∈ H 1,2(X, d, m).

Under the assumption that Ch is quadratic, this is a symmetric and L1(X, m)-valued
bilinear form, with Γ(f, f ) = |Df|2 m-a.e. in X. This fact, proved ﬁrst in [AGS14b], can
now be seen as a particular case of Theorem 2.7. We can canonically associate to any
f ∈ H 1,2(X, d, m) a gradient derivation bf = bf,m ∈ Der2(X, d, m), deﬁned by

bf (g) := Γ(f, g)

g ∈ H 1,2(X, d, m)

(we already consider, as for all derivations in L2, the extended domain H 1,2(X, d, m)).
Lemma 6.1. Assume that Ch is quadratic, let f ∈ H 1,2(X, d, m), b ∈ Der2(X, d, m) and
assume that RX |b|2 dm ≤ RX |Df|2 dm and that RX(b(g) − bf (g)) dm = 0 for all g ∈
H 1,2(X, d, m). Then b = bf .
Proof. Since, by the deﬁnition of |b|, b(f ) ≤ |Df||b| and since Hölder’s inequality gives

ZX

b(f ) dm = ZX

Γ(f, f ) dm ≥ ZX |Df||b| dm

we obtain that

(6.1)
Now, given any g ∈ H 1,2(X, d, m), the pointwise equalities (6.1) in combination with the
pointwise inequalities

b(f ) = |Df|2 = |b|2

m-a.e. in X.

|b(f )|2+2εb(f )b(g)+o(ε) = |b(f +εg)|2 ≤ |b|2|D(f +εg)|2 = |b|2|Df|2+2ε|b|2Γ(f, g)+o(ε)
give the result.

Deﬁnition 6.2 (Mosco convergence). We say that the Cheeger energies Chn = Chmn
Mosco converge to Ch if both the following conditions hold:
(a) (Weak-lim inf). For every fn ∈ L2(X, mn) L2-weakly converging to f ∈ L2(X, m),

one has

Ch(f ) ≤ lim inf

n→∞

Chn(fn).

21

(b) (Strong-lim sup). For every f ∈ L2(X, m) there exist fn ∈ L2(X, mn), L2-strongly

converging to f with

Ch(f ) = lim
n→∞

Chn(fn).

c1ec2r2

, see [GMS13, Theorem 6.8].

Such a convergence holds for example if (X, d, mn) are RCD(K,∞) spaces with mn(Br(¯x)) ≤
In the sequel we also say that fn ∈ H 1,2(X, d, mn) are weakly convergent in H 1,2 to
Chn(fn) is ﬁnite. Strong convergence in H 1,2
f ∈ H 1,2(X, d, m) if fn → f in L2 and supn
is deﬁned by requiring that Ch(f ) = limn Chn(fn). We are going to use this well-known
consequence of Mosco convergence:

lim

n→∞ZX

Γn(fn, gn) dmn = ZX

Γ(f, g) dm

(6.2)

for any fn strongly convergent in H 1,2 to f and all gn weakly convergent in H 1,2 to g.

Indeed, since fn + tgn weakly converge in H 1,2 to f + tg for all t > 0, by Mosco

convergence we have

Ch(f ) + 2tZX

Γ(f, g) dm + t2Ch(g) = Ch(f + tg)

n→∞

≤ lim inf
= lim inf
n→∞

Chn(fn + tgn)

Chn(fn) + 2tZX
n→∞ ZX

≤ Ch(f ) + 2t lim inf

Γn(fn, gn) dmn + t2Chn(gn)

Γn(fn, gn) dm + t2 lim sup

Chn(gn).

n

Chn(gn) is ﬁnite, we may let t ↓ 0 to deduce the lim inf inequality in (6.2);
The following simple example shows that even when the functions fn, gn are ﬁxed,

Since supn
replacing g by −g gives (6.2).
(6.2) might not hold.

Example 6.3. Take X = R2 endowed with the Euclidean distance, f (x1, x2) = x2 and
let

Then, it is easily seen that Γn(f, f ) = 1, while Γ(f, f ) = 0.

mn = nL 2 (cid:0)[0, 1] × [0, 1
n ](cid:1),

m = H 1

[0, 1] × {0}.

The next theorem shows that any sequence (fn) strongly convergent in H 1,2 to f
induces gradient derivations which are strongly converging to the gradient derivation of
the limit function.

Theorem 6.4 (Strong convergence of gradient derivations). Assume (a), (b), (c) of
Section 4 on the limit structure (X, d, m), that Chn are quadratic and that Mosco con-
verge to Ch. Let fn ∈ H 1,2(X, d, mn) be strongly convergent in H 1,2 to f ∈ H 1,2(X, d, m).
Then the derivations bfn strongly converge in L2 to bf . In addition, bfn(gn) weakly con-
verge in L2 to bf (g) whenever gn → g in Lipb(X) with ∪n supp(gn) bounded in X.
Proof. Set bn = bfn, b = bf , and let Γn be the bilinear form associated to Chn. From (6.2)
we get

lim

n→∞ZX

bn(g) dmn = ZX

b(g) dm

∀g ∈ Lipbs(X).

(6.3)

22

By Theorem 4.4 with Θ(z) = z2 there exist a subsequence bn(k) and c ∈ Der2(X, d, m)
such that b

n(k)

P Abs−−−⇀ c and

ZX |c|2 dm ≤ lim inf

k→∞ ZX |bn(k)|2 dmn(k) ≤ ZX |b|2 dm.

We ﬁx a sequence of cut-oﬀ functions χR ∈ Lipbs(X) with 0 ≤ χR ≤ 1, Lip(χR) ≤ 2
Abs and let us notice that the

and χR ≡ 1 on BR(¯x). To show that b = c, let h ∈ PQ+
Young inequality and the L2(X, m) integrability of h easily give

n→∞ ZX

lim sup

lim sup
R→∞

h|Γn(fn, χR)| dmn = lim sup

h|Γn(fn, χR)| dmn = 0.
(6.4)
Now, taking (6.3) with g = hχR and (6.4) into account, we can pass to the limit as n → ∞
in the identity

R→∞

lim sup

n→∞ ZX\ ¯BR(¯x)

ZX

bn(h)χR dmn = ZX

Γn(fn, hχR) dmn −ZX

hΓn(fn, χR) dmn

c(h)χR dm = RX

to get RX
w.r.t. R, we obtain RX

by the density of PQ+
b = c.

c(h) dm for every h ∈ PQ+

b(hχR) dm + ωR, with ωR → 0 as R → ∞. Taking the limit
b(h) dm = RX
Abs. This identity extends,
Abs, to any h ∈ H 1,2(X, d, m); then, Lemma 6.1 applies and gives
P Abs−−−⇀ b. Strong convergence ﬁnally

By sequential compactness, this proves that bn

follows from Theorem 5.3, with Θ(z) = z2.

In order to prove the ﬁnal part of the statement it is suﬃcient to apply the Leibniz

formula, passing to the limit as n → ∞ in

ZX

bn(gn)a dmn =ZX

Γn(fn, gna) dmn −ZX

bn(a)gn dmn

a ∈ PQ+

Abs

and using (6.2) and the L2 convergence of bn(a) to b(a). This proves that bfn(gn) weakly
converge to bf (g) in the duality with PQ+ Abs, and since this class of test functions uniquely
determines the limit, we are done.

We conclude this section by providing two examples.

Example 6.5 (Convergence of resolvents). Under the assumptions of the previous the-
orem, let fn ∈ L2(X, mn) be strongly convergent in L2 to f ∈ L2(X, m), let λ > 0 and
set un = (λ − ∆n)−1fn ∈ D(∆n), so that ∆nun = λun − fn, and consider the gradient
derivations bun.
It is then known (see e.g., [GMS13, Corollary 6.10]) that Mosco convergence entails
L2-strong convergence of un to u = (λ − ∆)−1f ∈ D(∆), as well as limn Chn(un) = Ch(u).
We may choose Θ(z) = z2, to fulﬁl the assumptions of Theorem 6.4 and we deduce strong
convergence of bun to bu.

Example 6.6 (Laplacian eigenvalues). Let us assume that (X, d, mn) are RCD(K,∞)
spaces, so that in particular the assumptions of the previous theorem hold. In this case, let
us consider normalized eigenfunctions of (minus) the Laplacian operators, i.e. un ∈ D(∆n)
n dmn = 1, and −∆nun = λnun, for some λn ∈ R+. Assuming in addition
which satisfyRX u2
that either K > 0 or all mn are probability measures, using min-max arguments and Mosco
convergence of the Cheeger energies, it has been proved in [GMS13, Theorem 7.8] that,
representing the discrete spectra of −∆n as (λk
n)k≥0 (in non-decreasing order), for each

23

n converge as n → ∞ to the k-th eigenvalue of λk of −∆, and that
k ≥ 0 the eigenvalues λk
the associated eigenfunctions uk
n L2-strongly converge to a corresponding eigenfunction uk,
possibly extracting a subsequence (there is no need to extract subsequences if the limit
eigenvalue is simple).

Since Chn(uk

gradient derivations b

n) = λk
uk
n

n → λk, by Theorem 6.4 we deduce the strong convergence of the
.

Part III
Flows associated to derivations and their
convergence

7 Continuity equations and ﬂows associated to derivations
Given (bt)t∈(0,T ) ⊂ Der1

loc(X, d, m), we now consider the continuity equation

µt + div(btµt) = 0,

d
dt
µ0 = ¯µ

(CE)




and its weak formulation in the space of probability measures µt = utm absolutely contin-
uous w.r.t. m.

Deﬁnition 7.1 (Weak solutions to the continuity equation). Let µt = utm ∈ P(X),
t ∈ (0, T ), and ¯µ ∈ P(X). We say that µt is a solution to (CE) if

Z T
0 ZX |bt(f )| dµt dt < ∞

∀f ∈ Lipbs(X)

(7.1)

and for every f ∈ Lipbs(X) and χ ∈ C 1
f dµt dt = Z T

χ′(t)ZX

0

−Z T

0

c ([0, T )) one has

χ(t)ZX

bt(f ) dµt dt + χ(0)ZX

f d¯µ.

(7.2)

Remark 7.2 (Diﬀerent classes of integrability and test functions). Under the stronger as-
sumption µt ≤ C m, the weak formulation of (CE) makes sense for all test functions
f ∈ Lipb(X) assuming the condition

Z T
0 kbt(f )kL1+L∞(X,m) dt < ∞

∀f ∈ Lipb(X),

(7.3)

somehow weaker than (7.1) (a weaker norm, but a larger class of functions). If one has

Z T
0 ZX

Θ(|bt|) dm dt < ∞

(7.4)

for some Θ : [0,∞) → [0,∞] with more than linear growth at inﬁnity, then the inequality
z ≤ c(1 + Θ(z)) immediately yields that (7.3) holds. Furthermore, if we assume (7.4) and
µt ≤ C m, it is easy by a truncation argument to pass in the weak formulation of (CE)
from Lipbs(X) to Lipb(X).

24

We say that a solution µt to (CE) is weakly continuous if t 7→ RX f dµt is continuous in
(0, T ) for all f ∈ Lipbs(X); under this assumption, because of (7.1), the map is absolutely
continuous and (7.2) can be written in the equivalent form

d

dt ZX

f dµt = ZX

bt(f ) dµt

for L 1-a.e. t ∈ (0, T ),

lim

t↓0 ZX

f dµt = ZX

f d¯µ.

A natural class of examples of weakly continuous solutions to (CE) is given by µt = (evt)#π
with π ∈ P(C([0, T ]; X)), see Remark 7.5 below for more details.
Deﬁnition 7.3 (Regular ﬂow relative to b). Let X : [0, T ]× X → X be a Borel map. We
say that X is a regular ﬂow relative to bt if:

(a) for some constant C = C(X, m), one has X(t, · )#m ≤ C m for all t ∈ [0, T ];
(b) X(· , x) ∈ AC([0, T ]; X) and X(0, x) = x for m-a.e. x ∈ X and, for all f ∈ Lipbs(X),

one has

d
dt

f ◦ X(t, x) = bt(f )(X(t, x))

for L 1 × m-a.e. (t, x) ∈ (0, T ) × X.

The property of being a regular ﬂow is independent of the choice of representatives
bt(f ); to see this, notice that the condition X(t, · )#m ≪ m for L 1-a.e. t ∈ (0, T ), weaker
than (a), and Fubini’s theorem give that the set

{(t, x) ∈ (0, T ) × X : (t, X(t, x)) ∈ N}

is L 1 × m-negligible for any L 1 × m-negligible set N ⊂ (0, T ) × X.
In connection with the stability analysis, the previous deﬁnition needs to be extended
in order to cover generalized ﬂows, namely ﬂows where a priori the branching behaviour
is allowed.

Deﬁnition 7.4 (Regular generalized ﬂow relative to b). Let π ∈ P(C([0, T ]; X)). We
say that π is a regular ﬂow relative to bt if:

(a) for some constant C = C(π, m), one has (evt)#π ≤ C m for all t ∈ [0, T ];
(b) π is concentrated on AC([0, T ]; X) and for all f ∈ Lipbs(X) one has

d
dt

f ◦ γ(t) = bt(f )(γ(t)) for L 1 × π-a.e. (t, γ) ∈ (0, T ) × C([0, T ]; X).

(7.5)

As for Deﬁnition 7.3, it is the regularity condition (a), even in the weakened form
(evt)#π ≪ m for L 1-a.e.
t ∈ (0, T ), that ensures that property (b) above is independent
of the choice of representatives of bt(f ). Obviously any regular ﬂow X induces regular
generalized ﬂows π, given by Σ#(f m), where f is the density of a probability measure and
Σ : X → C([0, T ]; X) is given by Σ(x) = X(· , x). The converse holds if m ≪ (ev0)#π
and if the conditional probability measures πx in C([0, T ]; X) induced by ev0 are Dirac
masses m-a.e. in X; indeed, if this is the case, setting πx = δ{X( · ,x)}, we recover X.
Remark 7.5. Under the mild integrability assumption (7.1) on bt, property (7.5) in Deﬁnition 7.4
and the continuity equation are closely related. More precisely, if π ∈ P(C([0, T ]; X)) sat-
isﬁes (evt)#π ≪ m for L 1-a.e. t ∈ (0, T ) (weaker than (a)) and (7.5), then its marginals
µt = (evt)#π, t ∈ [0, T ], are weakly continuous in time and satisfy (CE).
Indeed, ﬁx

25

f ∈ Lipbs(X); it is clear that t 7→ RX f dµt is continuous. Moreover, by the Fubini-Tonelli
theorem, for L 1-a.e. t ∈ (0, T ) one has

d
dt

f ◦ γ(t) = bt(f )(γ(t))

for π-a.e. γ ∈ C([0, T ]; X)

and, by integration, one obtains

d

dtZX

f dµt =

d

dtZ f (γ(t)) dπ(γ) = Z bt(f )(γ(t)) dπ(γ) = ZX

bt(f ) dµt.

The following elementary criterion will be useful and provides a converse to Remark 7.5;
roughly speaking, it links the validity of the continuity equations for arbitrary modiﬁca-
tions gπ, g ∈ Cb(C([0, T ]; X)), to the property of being concentrated on solutions to the
ODE, in the weak sense expressed by condition (b).
Proposition 7.6 (Concentration criterion). Let π ∈ P(C([0, T ]; X)) be concentrated on
AC([0, T ]; X) with (evt)#π ≪ m for L 1-a.e. t ∈ (0, T ) and assume that bt satisfy (7.1).
Then, the following properties are equivalent:
(a) for all f ∈ Lipbs(X), (7.5) holds;
(b) for all g ∈ Cb(C([0, T ]; X)), with gπ ∈ P(C([0, T ]; X)), the curve

t ∈ [0, T ],
solves the continuity equation (CE) with ¯µ = µg
0.

µg
t := (evt)#(gπ),

Proof. We already proved the implication from (7.5) to the continuity equation. To show
the converse, ﬁx g as in (b). For all g ∈ Lipbs(X), by integration in an interval [s, t] ⊂ [0, T ]
we get

f dµg

f dµg

br(f ) dµg

r dr,

ZX

t −ZX

s = Z t
s ZX
Z f (γ(t)) − f (γ(s)) dgπ(γ) = Z Z t

s

so that

br(f )(γ(r)) dr dgπ(γ),

br(f )(γ(r)) dri g(γ) dπ(γ) = 0. Since g varies in a suﬃ-
i.e., R hf (γ(t)) − f (γ(s)) −R t
ciently large class, we obtain that f (γ(t)) − f (γ(s)) = R t
br(f )(γ(r)) dr for π-a.e. γ, for s
and t ﬁxed. Since f ◦ γ ∈ AC([0, T ]) for π-a.e. γ, by letting s and t vary in Q ∩ [0, T ] we
obtain, via a density argument

s

s

f (γ(t)) − f (γ(s)) = Z t

s

br(f )(γ(r)) dr

for all s, t ∈ [0, T ] with s ≤ t, for π-a.e. γ,

which yields (7.5).
Remark 7.7 (Metric speed of a generalized ﬂow). Let us recall that |bt| provides an upper
bound for the metric speed of curves selected by a generalized ﬂow: indeed, [AT14, Lemma
7.4] gives the inequality | ˙γ| (t) ≤ |bt| (γ(t)) L 1-a.e. in (0, T ), for π-a.e. γ.
Proposition 7.8 (Tightness for generalized ﬂows). Assume that πn ∈ P(C([0, T ]; X))
are regular generalized ﬂows relative to bn,t such that

lim
R→∞

sup

n

(ev0)#πn(cid:0)X \ BR(¯x)(cid:1) = 0

26

(7.6)

for some ¯x ∈ X,
sup

n

C(πn, mn) < ∞ and

sup

n Z T
0 ZX

Θ(|bn,t|) dmn dt < ∞,

with Θ : [0,∞) → [0,∞] having more than linear growth at inﬁnity. Then the family {πn}
is tight in P(C([0, T ]; X)), and any limit point π ∈ P(C([0, T ]; X)) is concentrated on
AC([0, T ]; X).
Proof. In order to prove the tightness, we build a coercive functional Ψ : C([0, T ]; X) →
[0,∞] (i.e., a map with relatively compact sublevel sets) such that

sup

n ZC([0,T ];X)

Ψ(γ) dπn(γ) < ∞.

¯BRi(¯x) to m ¯BRi(¯x) we

Let Ri ↑ ∞ with m(∂BRi(¯x)) = 0. From the convergence of mn
obtain coercive functions ψi : ¯BRi(¯x) → [0,∞] such that
ψi dmn ≤ 2−i.
Setting ψi = 0 on X \ ¯BRi(¯x) and ψ = Pi≥1 ψi, we obtain

n Z ¯BRi (¯x)

sup

sup

n ZX

ψ dmn ≤ 1

and, since ψ ≥ ψi and Ri → ∞, all sets {ψ ≤ t} ∩ ¯BR(¯x) are relatively compact in
X. Using (7.6) we can also ﬁnd ϕ : X → [0,∞] with ϕ(x) → ∞ as d(x, ¯x) → ∞ and
supnRX ϕ(γ(0)) dπn(γ) < ∞.

Now ﬁx a countable dense set {tj} in [0, T ] and deﬁne
2−jψ(γ(tj)) +Z T

Ψ(γ) = ϕ(γ(0)) +Xj∈N

0

Θ(| ˙γ| (t)) dt

if γ ∈ AC([0, T ]; X), Ψ(γ) = ∞ otherwise. Thanks to the above-mentioned local compact-
ness property of the sublevel sets of ψ, it is easily seen (as in Ascoli-Arzelà’s theorem) that
Ψ is coercive. It is now clear, using the condition (evtj )#πn ≤ C(πn, mn)mn, that

sup

n ZC([0,T ];X)(cid:20)ϕ(γ(0)) +Xj∈N

2−jψ(γ(tj ))(cid:21) dπn(γ) < ∞.

In addition

ZC([0,T ];X)Z T

0

Θ(| ˙γ| (t)) dt dπn(γ) ≤ Z T

0 ZC([0,T ];X)
Θ(|bn,t| (γ(t))) dπn(γ) dt
≤ C(πn, mn)Z T
0 ZX

Θ(|bn,t|) dmn dt,

where the ﬁrst inequality above follows from Remark 7.7.

In the following proposition we prove that limits of ﬂows relative to bn,t are ﬂows
relative to bt, if bn,t strongly converge according to (7.7). This condition, stated in the
minimal form needed for the validity of the proof, is in many cases implied by the notion
of strong convergence of the previous sections, for instance in RCD(K,∞) spaces the class
D = PQ+ Abs is dense w.r.t. m-ﬂat convergence and one can use the convergence in measure
of bn,t(f ) to bt(f ) for f ∈ D, together with uniform bounds in L1 + L∞, to prove (7.7).
We do not discuss in generality this point, referring to the speciﬁc examples discussed in
Section 8.

27

Proposition 7.9 (Closure theorem). Assume that πn ∈ P(C([0, T ]; X)) are regular gen-
eralized ﬂows relative to bn,t and that:
(i) supn C(πn, mn) < ∞ and πn weakly converge to π ∈ P(C([0, T ]; X)), with π con-

centrated on AC([0, T ]; X);

(ii) for all f in a class D ⊂ Lipb(X), dense w.r.t. m-ﬂat convergence, one has

lim

n→∞Z T
0 ZX

bn,t(f )vn dmn dt = Z T
0 ZX

bt(f )v dm dt

(7.7)

Lipb(X);

0 kbn,t(f )kL1+L∞(X,mn) dt < ∞ for all f ∈

whenever 0 ≤ vn ≤ C < ∞ and vn(t, · )mn ∈ P(X) weakly converge to v(t, · )m ∈
P(X) for all t ∈ (0, T );
0 kbt(f )kL1+L∞(X,m) dt < ∞ and supnR T

(iii) R T
(iv) either H 1,2(X, d, m) is reﬂexive, or R T
Proof. Fix g ∈ Cb(C([0, T ]; X)) with gπ ∈ P(C([0, T ]; X)), set gn = g/R g dπn, so that,
n := gnπn ∈ P(C([0, T ]; X)) are well-deﬁned and
n,t := (evt)#πgn
n
n,0, have uniformly bounded (w.r.t. t ∈ [0, T ] and n suﬃciently

0 RBR(¯x) | div bt| dm dt < ∞ for all R > 0.

By Proposition 7.6, applied with πn and gn, the marginal measures µgn

for n large enough, the measures πgn
weakly converge to πg := gπ.

Then π is a regular generalized ﬂow relative to bt.

solve (CE) with ¯µ = µgn
large) densities w.r.t. mn,

ugn
n,t ≤ sup

n

C(πn, mn)kgnk∞

:= (evt)#πg, since evt is a continuous map. Passing to the

and weakly converge to µg
t
limit as n → ∞ in the weak formulation
n,t dt = Z T

χ′(t)ZX

−Z T

n,t dmn dt + χ(0)ZX
with f ∈ D and using the convergence assumption with vn(t, x) = T −1ugn

χ(t)ZX

bn,t(f )ugn

f dµgn

0

0

f dµgn
n,0.

n,t(x) we get

−Z T

0

χ′(t)ZX

f dµg

t dt = Z T

0

χ(t)ZX

bt(f ) dµg

t dt + χ(0)ZX

f dµg
0.

for all f ∈ D. By an easy approximation based on assumption (iv) and Lemma 3.9, the
density of D gives that µg
0. Again by Proposition 7.6, we obtain
that π is a regular generalized ﬂow relative to b.

t solve (CE) with ¯µ = µg

Remark 7.10. In Proposition 7.9 the strong convergence property of bn,t expressed by (7.7)
can not be replaced, in general, by weak convergence together with convergence of the
norms. In fact, we have the following simple counterexample. Consider in (R3,k·k∞ , L 3)
the vector ﬁelds

bn(x) = wn(x1)e2 + e3

with (weak convergences are meant in the weak-∗ topology of L∞)
w+

wn ⇀ 0,

wn : R → R,

|wn| = 1,

n ⇀

1
2

.

28

For instance, we can take wn(t) = sign sin(2nt). Then we have that bn ⇀ e3 and limn |bn| =
|e3|. Let us call Xn the ﬂow relative to bn. Then, given any probability density u, we have
the following convergence of the associated generalized ﬂows ηn = Xn(· , x)#(u(x)L 3):

ZR3

δXn( · ,x)u(x) dx

P(C([0,T ]; R3))

−−−−−−−−−−⇀ ZR3

1

2 (cid:16)δγ+( · ,x) + δγ−( · ,x)(cid:17) u(x) dx

where

γ±(t, x) = (cid:0)x1, x2 ±

t, x3 + t(cid:1).

1
2

Therefore, we have that the generalized ﬂows converge in P(C([0, T ]; R3)) to a probability
measure that is not a generalized ﬂow relative to the weak limit e3.

This example raises a problem about possible extensions of Theorem 5.3 to the case
when the norm on derivations is not strictly convex, since oscillations in the vector ﬁelds
might not be detected by the convergence of the norms.

We end this section with the following stability result for regular ﬂows, under the
assumption that for the limit vector ﬁeld any regular generalized ﬂow is induced by a
regular ﬂow, see (7.8). Notice that with a similar proof a similar convergence result holds
if we replace Xn by regular generalized ﬂows πn.

Proposition 7.11 (Stability for regular ﬂows, general case). Assume that Xn are regular
ﬂows relative to bn,t with bn,t strongly convergent to bt according to (7.7) of Proposition 7.9,

sup

n

C(Xn, mn) < ∞ and

sup

n Z T
0 ZX

Θ(|bn,t|) dmn dt < ∞,

and Θ : [0,∞) → [0,∞] having more than linear growth at inﬁnity. Assume also that any
regular generalized ﬂow π relative to b is induced by a regular ﬂow X relative to b, i.e.

π = ZX

X(· , x) d(ev0)#π.

(7.8)

Then, Xn : X → C([0, T ]; X) converge in measure towards X : X → C([0, T ]; X).
Proof. To deduce convergence in measure, we rely on Proposition 2.4, with Y = C([0, T ]; X).
Let v ∈ Cbs(X) nonnegative with RX v dm = 1, let ¯x ∈ X and ¯R > 0 large enough so that
supp(v) ⊂ B ¯R(¯x). We deﬁne cn := RX v dmn, which converge to 1 as n → ∞, and, for
n large enough, πn := c−1
X(· , x)v(x) dmn ∈ P(C([0, T ]; X)). Then, πn is a regular
generalized ﬂow, relative to bn, with C(πn, mn) ≤ c−1
n C(Xn, mn) sup|v|, hence uniformly
bounded in n.
indeed, the only
non trivial condition to check is (7.6), but that expression is 0 for R > ¯R. Next, by
Proposition 7.9, any limit point π is a regular generalized ﬂow relative to b: in this case,
we have to check condition (iii) only, which follows from the inequality

By Proposition 7.8, the family {πn} is tight, in P(C([0, T ]; X)):

n RX

|bn,t(f )| ≤ |bn,t| Lip(f ) ≤ c Lip(f )(1 + Θ(|bn,t|),

where c > 0 is some constant such that |z| ≤ c(1 + Θ(z)) for all z ∈ [0,∞). Hence, our
assumptions entail then that π can be written as in (7.8).

29

bounded and continuous functions. Then,

To apply Proposition 2.4 with Y = C([0, T ]; X), let Φ : Y → R and g : X → R be
ZX×Y

g(x), Φ(Xn(x, · ))v(x) dmn(x)
g(Xn(x, 0))Φ(Xn(x, · ))v(x) dmn(x)
g(ev0(γ))Φ(γ) dπn(γ)

(since Xn(x, 0) = x mn-a.e. on X)

g(x)Φ(γ) d(Id × Xn)#(vmn)(x, γ) = ZX
= ZX
= ZY
→ ZY
= ZX
= ZX×Y

(as n → ∞)
(by the representation (7.8))

g(ev0(γ))Φ(γ) dπ(γ)

g(X(x, 0))Φ(X(x, · ))v(x) dm(x)

g(x)Φ(γ) d(Id × X)#(vm)(x, γ),

where the limit as n → ∞ follows from the fact that g(ev0)Φ is a bounded continuous
function on Y .

8 Convergence of ﬂows under Ricci curvature bounds

Let us recall the following well-posedness result, from [AT14], that we report here in a
form suitable for our purposes. A crucial assumption, leading to well-posedness of the
continuity equation, and then to the existence and uniqueness of the regular ﬂow, is on
the “deformation” Dsymb of b (corresponding to the symmetric part of derivative in the
Euclidean case), which can be deﬁned in a suitable weak sense [AT14, Deﬁnition 5.2]. For
example, if b(· ) = (ω + c)Γ(f, · ), for f ∈ D(∆), ω ∈ H 1,2(X, d, m) ∩ L∞(X, m), c ∈ R,
then [AT14, Theorem 6.7] gives kDsymbk4,4 < ∞.
Theorem 8.1 (Well-posedness of ﬂows). Let (X, d, m) be a RCD(K,∞) space, for some
K ∈ R and let b = (bt)t∈(0,T ) be a Borel time-dependent derivation with

|b|, div b ∈ L1

t (L2(X, m) + L∞(X, m)),

(div b)− ∈ L1

t (L∞(X, m)),

Then, there exists a unique regular ﬂow X relative to b and every regular generalized ﬂow
π relative to b is induced by X as in (7.8).

and

kDsymbtk4,4 ∈ L1(0, T ).

Proof. By [AT14, Theorem 4.3, Theorem 5.4], the continuity equation (CE) associated to
b has existence and uniqueness of solutions in the class of weakly continuous solutions µt =
utm ∈ P(X), t ∈ [0, T ], with kutkL∞(X,m) bounded in [0, T ], so that [AT14, Theorem 8.3]
applies, providing existence and uniqueness of a regular ﬂow X relative to b. The last
statement follows from [AT14, Theorem 8.4].

We state and prove our main result concerning stability of ﬂows on converging RCD(K,∞)

metric measure spaces. Let us stress the fact that bounds on divergence and deformation
are assumed only for the limit derivation.
Theorem 8.2 (Stability of regular ﬂows under curvature assumptions). Let b = (bt)t∈(0,T ) ∈
t (Der1
L1
loc(X, d, mn))
and assume that

loc(X, d, m)) as in Theorem 8.1. For n ≥ 1, let bn = (bn,t)t∈(0,T ) ∈ L1

t (Der1

lim

n→∞Z T

0

χ(t)ZX

bn,t(a)v dmn dt = Z T

0

χ(t)ZX

bt(a)v dm dt

30

for all χ ∈ Cc(0, T ), v ∈ Cbs(X), a ∈ PQ+

Abs, and

lim sup

n→∞ Z T
0 ZX

Θ(|bn,t|) dmn dt ≤ Z T
0 ZX

Θ(|b|t) dm dt < ∞

with Θ : [0,∞) → [0,∞) strictly convex and having more than linear growth at inﬁnity.
Let Xn be regular ﬂows relative to bn, and X be the (m-a.e. unique) regular ﬂow
relative to b. If supn C(Xn, mn) < ∞, then Xn : X → C([0, T ]; X) converge in measure
towards X : X → C([0, T ]; X).
Proof. The thesis follows from Proposition 7.11, with D = PQ+ Abs. Indeed, it is suﬃcient
to notice that, by Theorem 4.4 and Theorem 5.3 we obtain strong convergence of bn to b,
and by Theorem 8.1, we deduce that the representation (7.8) holds true for any generalized
ﬂow π relative to b.

Example 8.3 (Convergence of ﬂows associated to resolvents). In the setting of Example 6.5,
since the operator (λ−∆n)−1 are Markovian, if for some constant c one has |fn| ≤ c mn-a.e.
then it follows |un| ≤ c mn-a.e. and therefore div bun = λ(un− fn) ∈ L∞(X, mn) uniformly
w.r.t. n. Now, by [AT14, Theorem 6.7], one has kDsymbunk4,4 < ∞. We are in a position
to deduce that there exist the mn-a.e. unique regular ﬂows Xn relative to bun and that,
as n → ∞, Xn converge in measure in C([0, T ]; X) to the m-a.e. unique ﬂow X relative
to bu.

Example 8.4 (Convergence of ﬂows associated to Laplacian eigenfunctions). In the set-
uk. From [AT14, Theorem 6.7]
ting of Example 6.6, for k ﬁxed set bn = b
we obtain kDsymbnk4,4 < ∞, but in order to obtain the validity of the assumption
(div bn)− ∈ L∞(X, m) in Theorem 8.1, the RCD(K,∞) assumption is not suﬃcient, e.g.,
in case of Gaussian space where the eigenfunctions are Hermite polynomials. To obtain
non trivial examples, we may restrict ourselves to metric measure spaces (X, d, mn) where
the heat semigroup P n
is ultracontractive, i.e., mapping for t > 0 the space L2(X, mn)
t
into L∞(X, mn). Under this assumption, for t > 0 one has

and b = b

uk
n

∆nuk

n = −λk

neλk

ntP n

t uk

n ∈ L∞(X, mn).

If we assume that quantitative ultracontractive bounds hold uniformly w.r.t. n, then a
unique regular ﬂow Xn relative to bn is deﬁned and we deduce convergence in measure to
the natural limit ﬂow X, as n → ∞.

Appendix

A Minimal relaxed slopes and Cheeger energy

In this section we recall basic facts about minimal relaxed slopes, Sobolev spaces and
heat ﬂow in metric measure spaces, see [AGS14a] and [G15a] for a more systematic treat-
ment of this topic. The Cheeger energy Ch : L2(X, m) → [0,∞] is the convex and lower
semicontinuous functional deﬁned as follows:
Ch(f ) := inf(cid:26)lim inf
a(fn) dm : fn ∈ Lipb(X) ∩ L2(X, m), kfn − fk2 → 0(cid:27) .

2ZX

Lip2

n→∞

1

The Sobolev space H 1,2(X, d, m) is simply deﬁned as the ﬁniteness domain of Ch. It can be
proved that H 1,2(X, d, m) is Hilbert if Ch is quadratic, and reﬂexive if (X, d) is doubling.
(see [ACDM15]).

31

In connection with the deﬁnition of Ch, for all f ∈ H 1,2(X, d, m) one can consider the
collection RS(f ) all functions in L2(X, m) larger than a weak L2(X, m) limit of Lipa(fn),
with fn → f in L2(X, m). This collection describes a convex, closed and nonempty set,
whose element with smallest L2(X, m) norm is called minimal relaxed slope and denoted
by |Df|. Because of the minimality property, |Df| provides an integral representation to
Ch and it is not hard to improve weak to strong convergence.
Theorem A.1. For all f ∈ D(Ch) one has
1
Ch(f ) =

2ZX |Df|2 dm

and there exist fn ∈ Lipb(X)∩ L2(X, m) with fn → f in L2(X, m) and Lipa(fn) → |Df| in
L2(X, m). In particular, if H 1,2(X, d, m) is reﬂexive, there exist fn ∈ Lipb(X) ∩ L2(X, m)
satisfying fn → f in L2(X, m) and |D(fn − f )| → 0 in L2(X, m).

Most standard calculus rules can be proved, when dealing with minimal relaxed slopes.

For the purposes of this paper the most relevant ones are:
Locality on Borel sets. |Df| = |Dg| m-a.e. on {f = g} for all f, g ∈ H 1,2(X, d, m);
Pointwise minimality. |Df| ≤ g m-a.e. for all g ∈ RS(f );
Degeneracy. |Df| = 0 m-a.e. on f −1(N ) for all f ∈ H 1,2(X, d, m) and all L 1-negligible

N ⊂ R Borel;

Chain rule. |D(φ◦ f )| = |φ′(f )||Df| for all f ∈ H 1,2(X, d, m) and all φ : R → R Lipschitz

with φ(0) = 0.

Another object canonically associated to Ch and then to the metric measure structure
is the heat ﬂow Pt, deﬁned as the L2(X, m) gradient ﬂow of Ch, according to the Brezis-
Komura theory of gradient ﬂows of lower semicontinuous functionals in Hilbert spaces, see
for instance [B70]. This theory provides a continuous contraction semigroup. We shall use
Pt only in the case when Ch is quadratic, as a regularizing operator. In this special case
Pt is also linear (and this property is equivalent to Ch being quadratic) and it is easily
seen that

lim
t↓0

Ptf = f

for all f ∈ H 1,2(X, d, m).

Finally, we describe the class of RCD(K,∞) metric measure spaces of [AGS14b], where
thanks to the lower bounds on Ricci curvature even stronger properties of Pt can be
proved. We say that a metric measure space (X, d, m) satisfying the growth bound (for
some constants c1, c2 and some ¯x ∈ X)

is a RCD(K,∞) metric measure space, with K ∈ R, if Ch is quadratic and if, setting

m(cid:0)Br(¯x)(cid:1) ≤ c1ec2r2

∀r > 0

(A.1)

d2(¯x, x) dm(x) < ∞(cid:27) ,
the Relative Entropy Functional Ent(µ) : P2(X) → R ∪ {∞} given by

P2(X) := (cid:26)µ ∈ P(X) : ZX

Ent(µ) := (RX ρ log ρ dm if µ = ρm ≪ m,

otherwise

∞

32

is K-convex along Wasserstein geodesics in P2(X). See [AGS14b] (dealing with ﬁnite
reference measures), [AGMR15] (for the σ-ﬁnite case) and [AGS15] for various characteri-
zations of this class of spaces. We quote here the following result, which essentially derives
from the identiﬁcation of Pt as the gradient ﬂow of Ent w.r.t. the Wasserstein distance
and the contractivity properties with respect to that distance.
Proposition A.2. In RCD(K,∞) spaces (X, d, m), for all t > 0 the semigroup Pt maps
L2 ∩ L∞(X, m) to Cb(X) and

Lipa(Ptf ) ≤ e−KtqPt|Df|2

pointwise in X.

B An approximation result

In this section we improve Theorem A.1 by showing that the approximating sequence can
be chosen in the “canonical” algebra A generated by the distance functions, and even in
the subalgebra Abs. The deep reason why this is possible is the fact that this is the class
of functions appearing in the Hopf-Lax formula, see (B.8).
Theorem B.1. For all f ∈ D(Ch) there exist fn ∈ Abs with fn → f in L2(X, m) and
In particular, if H 1,2(X, d, m) is reﬂexive, one has the
Lipa(fn) → |Df| in L2(X, m).
existence of fn ∈ Abs satisfying fn → f in L2(X, m) and |D(fn − f )| → 0 in L2(X, m).
Proof. The proof follows closely the strategy developed in [AGS14a]. We ﬁrst build a
variant of Cheeger’s energy by restricting the approximation to functions in Abs; this
construction provides a new minimal relaxed slope, that we denote by |Df|A and that we
prove to coincide with |Df| passing through the notion of minimal 2-weak upper gradient
|Df|w. Let us outline the main steps, quoting them also from [ACDM15], whose context
is closer to the one of the present paper (indeed, in [AGS14a] more general metric measure
structures, with possibly inﬁnite distances, are allowed).
Step 1. (Construction of ChA , |Df|A and calculus rules). For all f ∈ L2(X, m) we deﬁne

ChA (f ) := inf(cid:26)lim inf

n→∞

1

2 ZX

Lip2

a(fn) dm : fn ∈ Abs, fn → f in L2(X, m)(cid:27) .

It is immediate to check that ChA is a convex and L2(X, m)-lower semicontinuous func-
tional in L2(X, m), with a dense domain (here we use that Abs is dense in L2(X, m)). It
is also obvious by the deﬁnition that

Ch ≤ ChA

(B.1)

where Ch is Cheeger’s functional considered in the previous section.

As in [ACDM15, Section 4], for all f ∈ D(ChA ) one can deﬁne RSA (f ) as the collection
of all functions g ∈ L2(X, m) which are larger than a weak L2(X, m) limit of Lipa(fn), with
fn ∈ Abs and fn → f in L2(X, m). By weak L2-compactness, this set is not empty and
it is not hard to show that it is closed and convex. Its element with minimal L2(X, m)
norm is deﬁned to be |Df|A . Since RSA (f ) ⊂ RS(f ) for all f ∈ D(ChA ), we can use the
pointwise minimality property of |Df| to reﬁne (B.1) to a pointwise inequality:

|Df| ≤ |Df|A

m-a.e. in X for all f ∈ D(ChA ).

(B.2)

As we already mentioned in the previous section, in connection with |Df|, several

properties of |Df|A stem from the variational deﬁnition, in particular,

33

(a) there exist fn ∈ Abs with fn → f in L2(X, m) and Lipa(fn) → |Df|A strongly in

L2(X, m);

(b) locality on Borel sets, pointwise minimality, degeneracy and chain rule;

(c) for all g ∈ D(ChA ) where ChA has nonempty subdiﬀerential one has

−ZX

f ∆A g dm ≤ ZX |Df|A |Dg|A dm,

where −∆A g is the element with smallest norm in the subdiﬀerential of ChA (g),
with equality if f = ϕ(g) with ϕ Lipschitz, nondecreasing, ϕ(0) = 0.

Notice that the proof of properties (b), which rests on the decomposability property

of RSA

χg1 + (1 − χ)g2 ∈ RSA (f )

for all g1, g2 ∈ RSA (f ), χ ∈ A , 0 ≤ χ ≤ 1,

depends on the fact that the class of functions χ ∈ A with values in [0, 1] is dense in
L∞(X, [0, 1]), w.r.t. convergence in m-measure. Here the assumption that A is a lattice
plays a role.

Because of property (a), the proof of the theorem will be achieved if we show that, for
all f ∈ D(Ch), one has f ∈ D(ChA ) and |Df|A = |Df| m-a.e. in X. Notice that, because
of (B.1) and (B.2), one has D(ChA ) ⊂ D(Ch) and |Df| ≤ |Df|A m-a.e. in X for all
f ∈ D(ChA ), so our main concern will be to prove the converse inclusion and inequality.
For the proof of this statement we can easily reduce ourselves to the case when the
support of m has ﬁnite diameter and m(X) < ∞. Indeed, notice that A contains cut-oﬀ
functions hn : X → [0, 1], n ≥ 1, with Lip(hn) ≤ 2, hn ≡ 1 in Bn−1(¯x) and hn ≡ 0 in
X \ Bn(¯x). Now, ﬁx f ∈ D(Ch). Denoting by mn the measures χBn(¯x)m, and by Chn,
|Df|n, ChA ,n, |Df|A ,n the corresponding relaxed energies and slopes, we obviously have
f ∈ D(Chn) and |Df|n ≤ |Df| mn-a.e. in X. If we are able to show that f ∈ D(ChA ,n)
and |Df|A ,n ≤ |Df|n mn-a.e. in X for all n, we are then able to ﬁnd functions fk,n ∈ Abs
with fk,n → f in L2(X, mn) as k → ∞
Lip2

lim sup

k→∞ ZX

a(fk,n) dmn ≤ ZX |Df|2 dmn.

Using the inequality Lipa(hg) ≤ Lipa(g) + Lip(h)gχsupp(1−h), with h : X → [0, 1] and
Lip(h) ≤ 1, it is now immediate to build, by a diagonal argument, fkn,nhn → f in
L2(X, m) with

lim sup

n→∞ ZX

Lip2

a(fkn,nhn) dm = lim sup

n→∞ ZX

Lip2

a(fkn,nhn) dmn ≤ ZX |Df|2 dm.

Since fkn,nhn ∈ Abs, this proves that f ∈ D(ChA ); in addition, by lower semicontinuity,
A dm ≤ RX |Df|2 dm, whence the equality of the relaxed slopes follows.
we obtain RX |Df|2
So, from now on, we assume m(X) < ∞ and (possibly replacing X by the support of
m) that (X, d) has ﬁnite diameter.
Step 2. (Gradient ﬂow of ChA and computation of the energy dissipation rate). Thanks
to the convexity and lower semicontinuity properties of ChA we can deﬁne a (possibly
nonlinear) continuous semigroup Pt in L2(X, m) by considering the L2(X, m) gradient
ﬂow of ChA , as we did in the previous section for Ch. Notice that it is the density of

34

D(ChA ) that enables to the deﬁne Pt on the whole of L2(X, m). Speciﬁcally, t 7→ Ptf is
locally absolutely continuous in (0,∞) and satisﬁes

d
dtPtf = ∆A (Ptf )

L 1-a.e. in (0,∞).

Then, using the chain rule, an approximation argument (since z 7→ z log z is not Lipschitz)
and property (c) one can prove the entropy dissipation formula

−

d

dtZX

ft log ft dm = Z{ft>0}

|Dft|2
ft

A

dm

with ft = Ptf , for all f ∈ L2(X, m) nonnegative with RX f log f dm < ∞.
Notice that the sign condition is preserved by Pt, as well as the integral of f , namely
RX Ptf dm = RX f dm. This last property crucially depends on the ﬁniteness assumption of
m (the ﬁniteness assumption can be relaxed to (A.1), still suﬃcient for the mass-preserving
property). Because of this, if f is a probability density also Ptf is a probability density
and we shall consider the path of measures

µt = ftm = Ptf m

t ≥ 0.

(B.3)

Step 3.

(Minimal 2-weak upper gradient |Df|w and energy dissipation estimate with

|Df|w). We say that g ∈ L2(X, m) is a 2-weak upper gradient if the inequality

|f (γ(1)) − f (γ(0))| ≤ Z 1

0

g(γ(s))| ˙γ|(s) ds

(B.4)

holds π-a.e. for all 2-test plans π. Recall that a 2-test plan is a probability measure π in
C([0, 1]; X) concentrated on AC 2([0, 1]; X) and satisfying, for some C = C(π) ≥ 0,

(evt)#π ≤ C m

∀t ∈ [0, 1].

(B.5)

Because of the non-concentration condition (B.5), the property of being a 2-weak upper
gradient is independent of the choice of the representative of g in L2(X, m); furthermore,
the class of 2-weak upper gradients is a convex closed set and we can identify, as we did
for |Df|A , the element with minimal L2(X, m) norm. This distinguished element, the so-
called minimal 2-weak upper gradient, will be denoted by |Df|w. The stability property
of 2-weak upper gradients (a variant of the so-called Fuglede’s lemma), the fact that the
asymptotic Lipschitz constant is a (2-weak) upper gradient and Theorem A.1 then give

|Df|w ≤ |Df|

m-a.e. in X for all f ∈ D(Ch).

(B.6)

For all probability density f0 ∈ L2(X, m) having a 2-weak upper gradient, by integrating
(B.4) with f = f0 and g = |Df0|w with respect to a suitable test plan provided by
Lisini’s superposition theorem [L07], we obtain an estimate on the entropy dissipation
rate involving |Df0| (see [AGS14a, Lemma 5.17]):
2Z t
0 Z{f0>0}
ZX

2 Z t
0 | ˙µ|2(s) ds (B.7)

f0 log f0 dm −ZX

ft log ft dm ≤

w

|Df0|2
f 2
0

1

fs dm ds +

1

for all t > 0. Here µt = ftm is any curve in AC 2
metric derivative.

loc([0,∞); (P(X), W2)) and | ˙µ|(t) is its
Using this sharper energy dissipation estimate we will prove that f ∈ D(ChA ) for all
f having a 2-weak upper gradient as well as the inequality |Df|w = |Df|A in the next,

35

ﬁnal, step. In combination with (B.6) this provides the converse inequality to (B.2) and
then the result.
Step 4. (The equality |Df|A = |Df|w). Given h ∈ L2(X, m) having a 2-weak upper
gradient, we want to prove that h ∈ D(ChA ) and that |Dh|A = |Dh|w m-a.e. in X.
By the local property of this statement, we can consider with no loss of generality only
h ∈ L∞(X, m) with RX h2 dm = 1, h ≥ c > 0 and we set f = h2. Then we consider the
path of measures µt = ftm in (B.3), noticing that still ft ≥ c2 > 0.
The reﬁned subsolution property (B.9) of Lemma B.2 can be used together with the
integration by parts formula (d) to obtain the so-called Kuwada’s lemma (see for instance
[ACDM15, Lemma 34]), which yields µt ∈ AC 2([0,∞); (P(X), W2)) and

| ˙µ|(s) ≤ ZX

|Dfs|2
fs

A

dm

for L 1-a.e. s ∈ (0,∞).

This, in combination with (B.7) with f0 = f , gives
|Df|2
f 2 fs dm ds +

ft log ft dm ≤

f log f dm −ZX

2Z t
0 ZX

ZX

1

w

1

2Z t
0 ZX

|Dfs|2
fs

A

dm ds.

Hence we deduce

0

1

Z t

|Dfs|2
fs

4ChA (pfs) ds =

2 Z t
2Z t
0 ZX
0 ZX
Letting t ↓ 0, taking into account the L2
ft → f in L2(X, m), we get ChA (h) = ChA (√f ) ≤ lim inf t↓0
other hand, since |Df|2
(which entails weak∗ convergence in L∞(X, m)) yields

loc-lower semicontinuity of ChA and the fact that
ChA (√fs) ds. On the
w/f 2 belongs to L1(X, m), the L2(X, m) convergence of fs to f

|Df|2
f 2 fs dm ds.

w

dm ds ≤

t R t

1

A

1

0

t Z t
0 ZX
In summary, we proved that h ∈ D(ChA ) and that

dm = lim
t↓0

|Df|2
f

ZX

1

|Df|2
f 2 fs dm ds.

w

2ZX |Dh|2

A dm ≤

1

2 ZX

|Df|2
f

w

dm = 2ZX |Dh|2

w dm,

where we used the chain rule once once. Taking the inequality |Dh| ≤ |Dh|A into account,
this integral inequality proves the coincidence m-a.e. in X.
Lemma B.2 (Subsolution property). If m(X) < ∞, X has ﬁnite diameter and f ∈ Cb(X),
the function

(B.8)

(B.9)

Qt(f ) := inf
y∈X

f (y) +

1
2t

d2(x, y)

is locally Lipschitz in (0,∞) × X and

d
dt

Qtf +

1
2|DQtf|2

A ≤ 0

L 1 × m-a.e. in (0,∞) × X.

Proof. Let D = {xk} be as in (2.3). Let n ≥ 1 and deﬁne

Qn

t f (x) := min
1≤i≤n

f (xi) +

1
2t

d2(x, xi)

x ∈ X, t > 0.

36

Then x 7→ Qn

t f (x) ∈ A for all t > 0, Qn

t f is locally Lipschitz in (0,∞) × X and

d
dt

Qn

t f +

1
2

Lip2

a(Qn

t f ) ≤ 0

L 1 × m-a.e. in (0,∞) × X.

The proof of this inequality is elementary, see for instance [ACDM15, Theorem 14].

In order to obtain (B.9), we notice that the density of D in X yields that the family Qn
t f
c (0, T )

monotonically converges to Qtf from above. Given ζ(t, x) = χ(t)ψ(x), with χ ∈ C 1
nonnegative and ψ ∈ Cb(X), inf ψ > 0, we can pass to the limit in the inequality

to get

t f

Z T
0 ZX(cid:18)−Qn
Z T
0 ZX(cid:18)−Qtf

d
dt

ζ +

ζ
2

Lip2

a(Qn

t f )(cid:19) dm dt ≤ 0

d
dt

ζ +

ζ
2|DQtf )|2

A(cid:19) dm dt ≤ 0

which provides, by the arbitrariness of ζ, (B.9). In this limiting argument we used the
lower semicontinuity property

ZX

ψ|Dg|2

A dm ≤ lim inf

n→∞ ZX

ψ Lip2

a(gn) dmn

whenever gn ∈ A and gn → g in L2(X, m), which is a simple consequence of the m-a.e.
minimality property of the minimal relaxed slope.

References

[AK]

[AC13]

[AGS08]

L. Ambrosio, B. Kirchheim: Currents in metric spaces, Acta Math. 185
(2000), 1–80.

L. Ambrosio, G. Crippa: Continuity equations and ODE ﬂows with non-
smooth velocity. Proc. Roy. Soc. Edinburgh Sect. A 144 (2014), 1191–1244.

L. Ambrosio, N. Gigli, G. Savaré: Gradient ﬂows in metric spaces and
in the space of probability measures, Lectures in Mathematics, ETH Zürich,
Birkhäuser (2008).

[AGS14a] L. Ambrosio, N. Gigli, G. Savaré: Calculus and heat ﬂow in metric mea-
sure spaces and applications to spaces with Ricci bounds from below, Inven-
tiones Mathematicae, 195 (2014), 289–391.

[AGS14b] L. Ambrosio, N. Gigli, G. Savaré: Metric measure spaces with Rieman-
nian Ricci curvature bounded from below, Duke Math. J. 163 (2014), 1405–
1490.

[AGS15]

L. Ambrosio, N. Gigli, G. Savaré: Bakry-Émery curvature-dimension
condition and Riemannian Ricci curvature bounds, Annals of Probability, 43
(2015), 339–404.

[AGMR15] L. Ambrosio, N. Gigli, A. Mondino, T. Rajala: Riemannian Ricci cur-
vature lower bounds in metric measure spaces with σ-ﬁnite measure. Transac-
tions of the AMS, 367 (2015), 4661–4701.

37

[ACDM15] L. Ambrosio, M. Colombo, S. Di Marino: Sobolev spaces in metric mea-
sure spaces: reﬂexivity and lower semicontinuity of slope. Advanced Studies
in Pure Mathematics, 67 (2015), 1–58.

[AT14]

L. Ambrosio, D. Trevisan: Well posedness of Lagrangian ﬂows and conti-
nuity equations in metric measure spaces, Analysis and PDE 7 (2014), 1179–
1234.

[AH16]

L. Ambrosio, S. Honda: In preparation.

[B70]

[Ch99]

H. Brezis: Opérateurs maximaux monotones et semi-groupes de contractions
dans les espaces de Hilbert. North-Holland Publishing Co., 1973.

J. Cheeger: Diﬀerentiability of Lipschitz functions on metric measure spaces.
Geom. Funct. Anal., 9 (1999), 428–517.

[CKS15]

J. Cheeger, B. Kleiner, A. Schioppa: Inﬁnitesimal structure of diﬀeren-
tiability spaces, and metric diﬀerentiation. ArXiv 1503.07348.

[GMS13] N. Gigli, A. Mondino, G. Savaré: Convergence of pointed non-compact
metric measure spaces and stability of Ricci curvature bounds and heat ﬂows.
ArXiv 13111.4907, to appear on the Proceedings of the London Mathematical
Society.

[G15a]

[G15b]

N. Gigli: On the diﬀerential structure of metric measure spaces and applica-
tions. Mem. Am. Math. Soc., 236 (2015), no. 1113.

N. Gigli: Nonsmooth diﬀerential geometry – An approach tailored for spaces
with Ricci curvature bounded from below. ArXiv preprint 1407.0809. To appear
on Mem. Am. Math. Soc.

[GR07]

M. Gromov: Metric structures for Riemannian and non-Riemannian spaces.
Modern Birkhäuser Classics, Birkhäuser, Boston, MA, english ed., 2007.

[KK]

[L07]

[PS14]

[Sh]

[St06]

[Va90]

[Vi09]

[W00]

S. Keith: A diﬀerentiable structure for metric measure spaces. Adv. Math.,
183 (2004), 271–315.

S. Lisini: Characterization of absolutely continuous curves in Wasserstein
spaces. Calc. Var. Partial Diﬀerential Equations, 28 (2007), 85–120.

E. Paolini, E. Stepanov: Flows of measures generated by vector ﬁelds.
Preprint, 2014 (http://cvgmt.sns.it/paper/2339/).

T. Shioya: Metric measure geometry – Gromov’s theory of convergence and
concentration of metrics and measures. IRMA series of the European Mathe-
matical Society, to appear. ArXiv e-prints 1410.0428 (2014), 1–172.

K.-T. Sturm: On the geometry of metric measure spaces. Acta Math. 196
(2006), 65–131.

M. Valadier: Young measures. Springer, 1990.

C. Villani, Optimal transport. Old and new, vol. 338 of Grundlehren der
Mathematischen Wissenschaften, Springer-Verlag, Berlin, 2009.

N. Weaver: Lipschitz algebras and derivations. II. Exterior diﬀerentiation,
J. Funct. Anal., 178 (2000), 64–112.

38

