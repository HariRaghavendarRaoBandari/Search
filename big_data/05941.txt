Uplink FBMC/OQAM-based

Multiple Access Channel: Distortion Analysis

under Strong Frequency Selectivity

David Gregoratti*, Senior Member, IEEE, and Xavier Mestre, Senior Member, IEEE

6
1
0
2

 
r
a

 

M
8
1

 
 
]
T
I
.
s
c
[
 
 

1
v
1
4
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Abstract

This paper computes the distortion power at the receiver side of an FBMC/OQAM-based OFDMA
uplink channel under strong frequency selectivity and/or user timing errors. More precisely, it provides
a distortion expression that is valid for a wide class of prototype pulses (not necessarily perfect-
reconstruction ones) when the number of subcarriers is sufﬁciently large. This result is a valuable
instrument for analyzing how users interfere to one another and to justify, formally, the common
choice of placing an empty guard band between adjacent users. Interestingly, the number of out-band
subcarriers contaminated by each user only depends on the prototype pulses and not on the channel
nor on the equalizer. To conclude, the distortion analysis presented in this paper, together with some
simulation results for a realistic scenario, also provide convincing evidence that FBMC/OQAM-based
OFDMA is superior to classic circular-preﬁx OFDMA in the case of asynchronous users.

Index Terms

Filterbank, FBMC/OQAM, OFDMA, Multiple Access Channel, Strong Frequency Selectivity.

I. INTRODUCTION

Multicarrier techniques are based on the idea that a frequency-selective channel can be split into a

number of ﬂat orthogonal subchannels. As a result, sophisticated channel equalization schemes can

be replaced by simple (typically one-tap) per-subcarrier equalizers. For this reason, both wired (e.g.,

digital subscriber line, powerline communications) and wireless (e.g., WiFi, WiMAX) communications

systems have long been employing multicarrier strategies in order to control Intersymbol Interference

(ISI) while limiting complexity [1].

* Contact author. D. Gregoratti and X. Mestre are with the Centre Tecnol`ogic de Telecomunicacions de Catalunya
(CTTC), Parc Mediterrani de la Tecnologia, 08860 Castelldefels, Barcelona (Spain), e-mails: {david.gregoratti,
xavier.mestre}@cttc.es. Part of the contents of the paper was presented at IEEE SPAWC 2015.

2

Recently, established communications standards like LTE have based also their multiple access

features on a multicarrier approach [2]. Besides simple equalization, multicarrier transmission offers

a ﬂexible mechanism to dynamically allocate variable portions of the spectrum to users, according

to their throughput requirements and the channel response. Theoretically, it consists in a trivial

assignment of subcarriers to users. In practice, however, things may become substantially more

complicated, depending on the synchronization requirements between users and Base Station (BS)

and, especially, among different users.

In [3], M. Morelli et al. analyze the synchronization problem for the Orthogonal Frequency Division

Multiple Access (OFDMA) scheme, which is probably the most common multicarrier multiple-access

strategy based on an extension of the well-known Circular Preﬁx Orthogonal Frequency Multiplexing

(CP-OFDM) scheme. The authors highlight the fact that, similarly to CP-OFDM, OFDMA suffers

from poor spectrum containment and is hence very sensitive to frequency offsets. The issue is

exacerbated in the uplink, since synchronism is needed among signals at the receiver side (and

not at the transmitters). Timing- and frequency-tracking algorithms are presented in [3], together with

interference-cancellation procedures that are required to remove residual interference. The resulting

receiver is thus a complex system and the inherent efﬁciency loss caused by the presence of the CP

is not justiﬁed anymore.

Filterbank Multicarrier (FBMC) modulation is an old technique (see, e.g., [4]) that is regaining

popularity in the last few years as a potential solution to the efﬁciency and synchronization limitations

of CP-OFDM and CP-OFDMA [5], [6]. In FBMC, orthogonality among subchannels is obtained by

means of well-designed ﬁlters with low side lobes, and is much less sensitive to frequency offsets as

shown in, e.g., [7]. Furthermore, no CP is needed, thus improving the spectral efﬁciency. One should

be aware, however, that one-tap per-subcarrier equalizers are not ideal anymore (especially in highly

frequency selective channels) and more sophisticated solutions are often needed [8]–[11]. For this

reason, and because of FBMC architectures being more complex than their CP-OFDM counterparts,

FBMC is still not very popular in point-to-point communications. On the other hand, the complexity

gap cancels out (or possibly reverses) in multiple-access scenarios, as discussed above (see, e.g., [12],

[13]). For instance, users do not need to be synchronized since the timing at each subcarrier can be

corrected separately.

This paper considers a frequency selective multiple-access uplink channel as the one depicted in

Fig. 1 and characterizes the distortion of the received symbols assuming a FBMC/OQAM-based

OFDMA scheme. Users are not synchronized and their channels towards the BS are highly frequency

selective. No particular hypothesis is formulated about the FBMC prototype pulses, while a single-

tap per-subcarrier equalizer is implemented. We mentioned before that this equalizer is suboptimal;

however, a rigorous mathematical analysis of more sophisticated receiver architectures would result

March 21, 2016

DRAFT

3

Fig. 1. An uplink frequency selective multiple-access channel with two users.

in extremely complex derivations. Moreover, single-tap equalizers are often used in real practical

systems due to their simplicity.

The resulting distortion is thus the joint effect of suboptimal equalization and a “poor” ﬁlter choice1.
As opposed to other works, where an empirical approach is preferred [12], [14], the analysis below

is based on a tight approximation that accurately represents the received signal when the number of

subcarriers is large enough. This approximation is based on the results of [11] and follows similar

lines. It is worth remarking, however, that the problem at hand presents some speciﬁc difﬁculties that

cannot be seen as simple extensions of [11]. Indeed, important properties of the involved operations

[e.g., of the Discrete Fourier Transform (DFT)] do not hold when the spectrum is not considered in

its integrity, but is split among the different users.

A ﬁne characterization of the distortion brings valuable help with the design of a FBMC-based
OFDMA system. Each user contributes not only to the distortion at its assigned subcarriers (in-band
distortion), but also at other users’ subcarriers (out-band distortion). Indeed, the interference caused
by frequency selective channels, inherent to FBMC schemes, is exacerbated in the multiple user

case since all users undergo different channels, whose combined effect may be unpredictable. The

purpose of this analysis is to conﬁrm the intuition that, with sharp prototype pulses, leaving one empty

subcarrier as a guard-band is sufﬁcient [14], [15]. Moreover, it also applies to prototype pulses that are

not so frequency selective, like those used in double-dispersive channels and designed to optimize

the time–frequency localization of the waveform [7], [16]–[18]. Luckily, according to the results

below, the number of subcarriers affected by the out-band leakage only depends on the prototype

pulses at both sides of the FBMC links. Conversely, channel responses, equalizer and synchronization

misalignments only affect the distortion magnitude. This means that no channel state information is

needed to choose the prototype pulses that minimize the leakage effect or to decide whether one or

more empty guard-bands are needed between users.

The rest of the paper is organized as follows. Section II provides the model for the FBMC-based

1In some application, system designers may decide to relax the perfect reconstruction constraints as long as the resulting

distortion is negligible with respect to the equalization one and/or the noise level.

March 21, 2016

DRAFT

BSH1(ω)U1H2(ω)U24

Fig. 2. Block diagram of an FBMC/OQAM-based OFDMA receiver assuming that subcarriers are equally split between
two users. Blocks labeled “de-stag.” represent the de-staggering operation (see, e.g., [11]). The coefﬁcients of the polyphase

ﬁlters Qm(z−2) =(cid:80)κ

n=1 qN [m + 2(n − 1)M ]z−2(n−1) are given by the m-th row of matrix Q.

OFDMA channel under consideration while recalling basic concepts of FBMC modulation. Then, the

derivation and the interpretation of the distortion approximation are reported in Section III. Finally,

Section IV contains some numerical assessment of the results and Section V concludes the paper.

Notation: Hereafter, lowercase (respectively, uppercase) boldface letters denote column vectors
(respectively, matrices). Occasionally, matrices that are functions of other matrices are denoted by
uppercase calligraphic letters. Superscripts (·)∗, (·)T and (·)H represent complex conjugate, transpose
and complex (Hermitian) transpose, respectively. For a generic matrix A, [A]k,l is its (k, l) entry.
Also, borrowing from Matlab R(cid:13) notation, [A]:,l and [A]k,: denote the l-th column and the k-th row of
A, respectively. The entries of the diagonal matrix diag{a} (respectively, diagn=1,...,N{an}) are the
elements of vector a (respectively, of the sequence a1, . . . , aN ). tr A stands for the trace of matrix A.
Re{A} and Im{A} are the real and imaginary parts of A, so that A = Re{A} + j Im{A}, with j the
imaginary unit. The operators ⊗, (cid:12) and (cid:126) stand for Kronecker product, Hadamard (element-wise)
product and row-wise convolution, respectively (matrix dimension restrictions apply), while E[·] is the
expected value. Symbol 0m,n (respectively, 1m,n) denotes an m × n matrix with all entries equal to
0 (respectively, to 1). For simplicity, subscripts may be removed (i.e., 0 and 1) from column vectors
whose length can be clearly determined by the context. Finally, Ik and Jk represent the k× k identity
and anti-identity (with one-valued entries only on the main anti-diagonal) matrix, respectively.

II. SIGNAL MODEL

In this paper we focus on an OFDMA channel obtained by means of an FBMC modulation based

on Offset Quadrature Amplitude Modulation (FBMC/OQAM, also known as staggered modulated

multitone). More precisely, we are interested in the uplink channel where a common sink (e.g., a

March 21, 2016

DRAFT

ΦFH2M↓MQ1(z2)↓MQ2(z2)↓MQ2M(z2)z−1z−1z−1Y(pN,qN)Z(pN,qN)de-stag.W2Mde-stag.WM+1de-stag.WMde-stag.W1user2user15

BS) receives data from K users (the case of two users is depicted in Fig. 1): each user is assigned

Ik denote the set of subcarrier indices reserved for user k, so that (cid:83)K

a subset of the available 2M equally spaced subcarriers, according to some allocation policy. Let
k=1 Ik = {1, . . . , 2M} and
Ik ∩Ik(cid:48) = ∅ for all k(cid:48) (cid:54)= k. Since channel and receiver are linear systems, the received signal can be
written as the sum of user contributions. Then, for user k, let Ak = Bk + jCk be the 2M × Ns matrix
representing a block of Ns multicarrier QAM symbols: for all n = 1, . . . , Ns and all m ∈ Ik, entries
[Bk]m,n and [Ck]m,n are independent (of one another and across k, m and n) real-valued bounded
random variables with zero mean and ﬁnite variance. Conversely, for m /∈ Ik, the entries of Ak are
identically null.

A. Memoryless Channel

Let pN [n] and qN [n] be the real prototype pulses at the transmitter side and at the receiver side,
respectively. The length of both pulses is N = 2M κ taps, where the overlapping factor κ is an integer

value. From the prototype pulses we can build matrices

P1 (cid:126) JM Q2
P2 (cid:126) JM Q2

P2 (cid:126) JM Q1

P1 (cid:126) JM Q1




R(pN , qN ) =

S(pN , qN ) =

(1)

(2)

where P1 and P2 gather the top half and the bottom half rows, respectively, of matrix

P1

 =

P2

 pN [1]

...

pN [2M ]

P =

 .

···

···

(cid:104)

pN [2M (κ − 1) + 1]

pN [2M κ]

...
(cid:105)T

Note that the m-th row of P contains the coefﬁcients of the m-th Type-I polyphase component of
the prototype pulse pN [n]. Equivalently, matrix Q =
the receiver prototype pulse qN [n].

is the polyphase representation of

1 QT
2

QT

For an ideal (memoryless and noiseless) channel, the output of the analysis ﬁlterbank corresponding

to signal Ak (see Fig. 2) can be written as

Yk(pN , qN ) = Yeven

k

(pN , qN ) ⊗ [1, 0] + Yodd

k (pN , qN ) ⊗ [0, 1]

March 21, 2016

DRAFT

where

Yeven

k

6

(3a)

(3b)

and

+ 2ΦFH
2M

Yodd

k (pN , qN ) = 2ΦFH
2M

(pN , qN ) = 2ΦFH
2M

(cid:16)
(cid:32)0, jG2Φ∗Ck, 0
(cid:16)
(cid:32)0, G2Φ∗Bk, 0

(cid:17)
 (cid:126) S(pN , qN )
(cid:33)
[F2M Φ∗Bk, 0, 0] (cid:126) R(pN , qN )
(cid:17)
jG1Φ∗Ck, 0, 0
 (cid:126) S(pN , qN )
(cid:33)
[0, jF2M Φ∗Ck, 0] (cid:126) R(pN , qN )
(cid:104)−jπ M +1
(cid:110)
(cid:104)
and where we have introduced the diagonal matrix Φ = diagm=1,...,2M
exp
the 2M × 2M Fourier matrix F2M with entries [F2M ]m,n = (2M )−1/2 exp
. The
(cid:104)
upper (respectively, lower) M rows of F2M are denoted by G1 (respectively, G2), so that F2M =
. Equation (3) is the input–output FBMC/OQAM signal model according to the efﬁcient

(cid:105)(cid:111)
(cid:105)
2M (m− 1)
2M (m− 1)(n− 1)
j 2π

1 GT
2

GT
polyphase implementation [11], [16]. It is worth remarking that, even though based on the polyphase

G1Φ∗Bk, 0, 0

+ 2ΦFH
2M

(cid:105)T

,

.

formulation, the results below characterize the distortion for all the equivalent implementations of

the FBMC/OQAM architecture, namely the classical transmultiplexer implementation with complex

modulated prototype pulses [16], the frequency-spreading formulation [19], [20] and, in some extent,

the fast-convolution based FBMC [21].

As it can be evinced from (3), there exists a complex relationship between the transmitted symbols

and the received ones. However, as proven in [11], [16], [22], for instance, message recovery is

possible since

[Ak]m,n = Re [Yodd

k (pN , qN )]m,n+κ−1 + j Im [Yeven

k

(pN , qN )]m,n+κ

whenever the prototype pulses meet the Perfect Reconstruction (PR) constraints

U+R(pN , qN ) = I
U−S(pN , qN ) = 02M×(2κ−1).

Matrices U+ and U− are deﬁned as

while I = [02M×(κ−1), 1, 02M×(κ−1)].

B. Frequency-Selective Channel

U± = I2 ⊗ (IM ± JM )

(4)

(5a)

(5b)

(6)

As mentioned above, multicarrier modulations ﬁnd their main application when the communication

channel is frequency selective. In such a situation, however, the memoryless model in (3) does not hold

anymore. Indeed, due to the delay spread, the received signal can be seen as a weighted combination

March 21, 2016

DRAFT

7

of a number of delayed replicas. The delay and the weight of each replica depend on the channel

impulse response. Note that timing errors between transmitter and receiver are covered by this model,

since they are equivalent to a phase shift in the channel frequency response. Conversely, frequency

offsets need a more sophisticated analysis that is not treated in this paper in order to avoid further

complexity. In other words, we are assuming that channel estimations are refreshed often enough to

neglect the Doppler effect.

Under a frequency selectivity assumption, a more useful approximation for the output of the analysis

ﬁlterbank in Fig. 2 is given by [11]

Z(∗)
k (pN , qN ) = WΛHkY(∗)

k (pN , qN ) − j

2M

(cid:16)

pN , q(1)
N

(cid:17)

WΛH (2)

k

Y(∗)
k

Y(∗)
k

k

WΛH (1)
− 1
8M 2

(cid:16)

pN , q(2)
N

(cid:17)

+ o(cid:0)M−2(cid:1) (7)

where (∗) ∈ {odd, even} and where

• the diagonal matrix W collects the 2M coefﬁcients of a channel equalizer with a single tap per

subcarrier;

is H (r)

k

(cid:16)

• the m-th entry of the diagonal matrix ΛH (r)

k (ωm), that is the value of the r-th derivative of
the channel frequency response Hk(ω) computed at ω = ωm, the central frequency of subcarrier
m;
• the symbols Y(∗)
pN , q(r)
N
with its r-th derivative q(r)
N (see below);

• o(cid:0)M−2(cid:1) represents a matrix of appropriate size whose entries decay faster than M−2 as M →

are built as in (3) after substituting the receiver prototype pulse qN

(cid:17)

k

+∞.

The approximation in (7) is derived for an asymptotically large number 2M of subcarriers under

the following assumptions.

AS1 The coefﬁcients of pN [n] and qN [n] are uniformly bounded for M → +∞.
AS2 The pulse qN [n] = q(0)

N [n] and its derivatives q(r)

(cid:18)(cid:18)

(cid:19) Ts

(cid:19)

N [n] are obtained according to
n − N + 1

,

2

2M

q(r)
N [n] = T r

s q(r)

where Ts is the multicarrier symbol period in time units and where q(t) is a twice con-
tinuously differentiable real function deﬁned over [−κTs/2, κTs/2]. Moreover, the func-
tion and its ﬁrst two derivatives null out at the boundary points of the domain, that is
q(±κTs/2) = q(1)(±κTs/2) = q(2)(±κTs/2) = 0. An example is depicted in Fig. 3.

Recall that the subcarrier bandwidth, and hence the multicarrier symbol duration, are kept constant.

This means that, by increasing the number of subcarriers, we are considering a wider spectrum (or,

equivalently, a higher sampling frequency). This assumption may seem not very practical; neverthe-

March 21, 2016

DRAFT

8

Prototype pulse deﬁned by the EU-funded project PHYDYAS [23] with overlapping factor κ = 4: it is a good

Fig. 3.
approximation of a prototype pulse satisfying the required assumptions.

less, numerical results will show how asymptotic expressions ﬁnely approximate real systems with

reasonable total bandwidth and number of subcarriers.

Even though the expansion in (7) can be easily extended to any order higher than two, the

extra terms would not bring any signiﬁcant contributions to the analysis below. Numerical results

in Section IV will conﬁrm this statement and the fact that (7) is representative of practical systems

with a sufﬁciently large number of subcarriers. Similarly, more sophisticated equalizers (e.g., single-

tap minimum mean square error or even more complex schemes like those described in [8]–[11])

could be considered and included in our study. However, this choice would make the mathematical

derivations extremely complicated and hard to follow.

A. Preliminary considerations

III. DISTORTION ANALYSIS

Before delving into the analysis of the distortion affecting the considered system, we need to
clarify how distortion is deﬁned. Let us focus on subcarrier m assigned to user (cid:96), i.e. m ∈ I(cid:96).
Then, ideally, the symbols received on this subcarrier would be WmH(cid:96)(ωm)[A(cid:96)]m,n, where Wm
[respectively, H(cid:96)(ωm)] is the m-th entry of the equalizer matrix W (respectively, of the channel
matrix ΛH(cid:96)) and where n = 1, . . . , Ns. Note that we consider the general case where the equalizer
does not necessarily invert the channel, i.e. we do not necessarily ﬁx Wm = [H(cid:96)(ωm)]−1. Nevertheless,
since both channel and equalizer are assumed to be known, symbols [A(cid:96)]m,n can be readily recovered.

After the de-staggering operation, the receiver output corresponding to subcarrier m is [cf. (4)]

(cid:17)

K(cid:88)

(cid:16)Re [Zodd

k=1

˜am,n =

k (pN , qN )]m,n+κ−1 + j Im [Zeven

k

(pN , qN )]m,n+κ

.

(8)

It is important to remark that the contributions of all users must be taken into account. Indeed, similarly

to the single-user case (see, e.g., [11], [16], [22]), the inherent structure of FBMC modulations [see (3)]

and the channel delay spread [see (7)] produce Intercarrier Interference (ICI), regardless of whether

March 21, 2016

DRAFT

012340.00.5MulticarrierSymbolPeriodthe prototype pulses satisfy the PR conditions. The ICI due to each user is not conﬁned within

the subcarriers assigned to the user itself (in-band distortion), but leaks into other users’ subcarriers

9

(out-band distortion), as proven later.

For the symbol estimates ˜am,n in (4), we deﬁne the distortion at subcarrier m ∈ I(cid:96) as

Pe(m) = E(cid:12)(cid:12)(cid:12)˜am,n − WmH(cid:96)(ωm)[A(cid:96)]m,n

(cid:12)(cid:12)(cid:12)2

.

Recalling that [Ak]m,n = 0 for all k (cid:54)= (cid:96) (since m ∈ I(cid:96)), we can further write

(cid:12)(cid:12)(cid:12)2

Hk(ωm)[Ak]m,n

Pe(m) = E(cid:12)(cid:12)(cid:12)˜am,n − Wm
K(cid:88)
(cid:12)(cid:12)(cid:12)(cid:12)Re[Zodd

K(cid:88)

= 2 E

k=1

k=1

k (pN , qN )]m,n+κ−1 − WmHk(ωm)[Bk]m,n

(cid:12)(cid:12)(cid:12)(cid:12)2

.

The second equality holds after assuming that the entries of the real part (i.e. Bk) and of the imaginary
part (i.e. Ck) of Ak are independent and identically distributed, apart from being independent
across the user index k. If this were not the case, we would need to consider also the difference
between Im[Zeven
(pN , qN )]m,n+κ and WmHk(ωm)[Ck]m,n. Such extension is straightforward and
not developed here.

k

To simplify notation, let us write zodd

k,m = [Zodd

k ]m,n and bk,m = [Bk]m,n. Then, the last equation

tells us that each user k contributes to the distortion at subcarrier m with a term

Pe,k(m) = 2 E(cid:12)(cid:12)(cid:12)Re[zodd

(cid:12)(cid:12)(cid:12)2

k,m] − WmHk(ωm)bk,m

.

(9)

Note that all user contributions take the same form and it does not matter whether subcarrier m is
assigned to user k (that is, m ∈ Ik and bk,m (cid:54)= 0) or to another user (i.e., m /∈ Ik and bk,m = 0). In
other words, according to the value of m, (9) represents either the in-band or the out-band distortion

due to user k.

B. Symmetric PR-compliant Prototype Pulses

By plugging (7) into (9), one can compute the distortion corresponding to a prototype pulse with
generic time and frequency responses, as long as it satisﬁes assumptions AS1 and AS2. However, as
shown in Appendix A, the resulting expression is cumbersome and offers no hints for interpretation.

For this reason, hereafter we look for insight into the special simple case where the prototype pulse

is symmetric and compliant with the PR conditions in (5). Note that prototype pulses meeting all

these requirements can be actually designed, as shown in [11].

Proposition 1: Consider the FBMC/OQAM-based OFDMA channel described above. Apart from
satisfying assumptions AS1 and AS2, choose two prototype pulses pN [n] and qN [n] that meet PR

March 21, 2016

DRAFT

conditions (5) and are symmetric (e.g., pN [n] = pN [N − n + 1]). Then, the contribution of user k to
the distortion at subcarrier m can be written as

Pe,k(m) = 2

η0,0(m) +

η0,1(m) +

η0,2(m) +

η1,1(m)

2
2M

1

4M 2

1

4M 2

where terms ηx,y(m) are given by

(cid:21)

+ o(cid:0)M−2(cid:1)
(cid:21)

10

(10)

(11a)

(11b)

(11c)

(11d)

(12)

(13)

(cid:20)

× Im tr

η0,0(m) = 2 Im2[WmHk(ωm)] Re tr
η0,1(m) = −2 Im[WmHk(ωm)] Im

2

2

I

I,R

I,R

k (ωm)

k (ωm)

(cid:21)
(cid:21)

(cid:20)
(cid:105)
(p,q,p,q) + U+Fk(m)X S(p,q,p,q)
U−Fk(m)X R− 1
(cid:105)

(cid:104)
(cid:20)
WmH (1)
(cid:104)
U+Fk(m)X R− 1
(p,q,p,q(cid:48)) + U−Fk(m)X S(p,q,p,q(cid:48))
(cid:20)
WmH (2)
(cid:20)
(p,q,p,q(cid:48)(cid:48)) + U+Fk(m)X S(p,q,p,q(cid:48)(cid:48))
U−Fk(m)X R− 1
(cid:105) Re tr
(cid:20)
U+Fk(m)X R(p,q(cid:48),p,q(cid:48)) + U−Fk(m)X S(p,q(cid:48),p,q(cid:48))
(cid:105) Re tr
U−Fk(m)X R(p,q(cid:48),p,q(cid:48)) + U+Fk(m)X S(p,q(cid:48),p,q(cid:48))
(cid:3)F2M (cid:12) f (m)f H (m),
I(cid:17)(cid:16)R(pN , qN ) − 1
I(cid:17)RT (pN , q(r)

I(cid:17)T

k (ωm)

k (ωm)

(cid:21)

2

,

N ),

η0,2(m) = −2 Im[WmHk(ωm)] Im

2

× Re tr

WmH (1)

WmH (1)

η1,1(m) = 2 Im2(cid:104)
+ 2 Re2(cid:104)
E(cid:2)bkbH
(cid:16)R(pN , qN ) − 1
(cid:16)R(pN , qN ) − 1


Fk(m) = FH
X R(p,q(cid:48),p,q(cid:48)) = R(pN , q(cid:48)N )RT (pN , q(cid:48)N ),
X R− 1
(p,q,p,q) =
I,R
X R− 1
(p,q,p,q(r)) =

2
S1(pN , q(r)

X S(p,q(r),p,q(s)) =

N )S T

2M

2

k

I

2

2

N )][S2(pN , q(s)
T
N ), 0]
N )S T
2 (pN , q(s)
N )
where bk is a generic column of Bk and f (m) is the m-th column of F2M .

1 (pN , q(s)
N )
N ), 0][0,S1(pN , q(s)
T
N )]

[0,S1(pN , q(r)
S2(pN , q(r)

[S2(pN , q(r)

The new matrices used in the deﬁnition of terms ηx,y(m) are

(cid:21)

.



Proof: The distortion expression for the considered special case is derived in Appendix A as a

particularization of the general one.

When comparing (10) with [11, Eq. (35)], i.e. with the distortion expression for the single-user
case2, one readily sees an important difference: as we increase the number of subcarriers, the distortion
decays as M−2 in the single-user case whereas terms of order O(M−1) and O(1) appear in the
multi-user case. Fortunately, as explained hereafter, cross-user interference is concentrated only at the

users’ boundaries. Thus, as we increase the total number of subcarriers 2M, the fraction of interfered

spectrum becomes proportionally smaller even though the interference magnitude does not fade out.

2More properties on the relationship between (10) and [11, Eq. (35)] are given in Appendix A.

March 21, 2016

DRAFT

11

(cid:104)

I

2

(cid:105)

ζ(m) = Re tr

Fig. 4.
power Ps. The prototype pulse of Fig. 3 is employed at both the transmitter and the receiver side.

(p,q,p,q) + U+Fk(m)X S(p,q,p,q)

U−Fk(m)X R− 1

for a user transmitting on subcarriers 1 to 64 with

1) Interpretation: Even in the special case of Proposition 1, the interpretation of the distortion

expression in (10) is not straightforward. We will now try to guide the reader through this task.

A closer look at (11) reveals that functions ηx,y(m) are built from two types of factors. The ﬁrst
type of factors depends on the equalizer and on the channel of the considered user. It is straightforward
k (ωm), we have Im[WmHk(ωm)] = 0 for m ∈ Ik
to notice that, for the classic equalizer Wm = H−1
and, thus, functions η0,0(m), η0,1(m) and η0,2(m) bring no contribution to the in-band distortion,
but only to the out-band one, where the equalizer is tuned on a different user’s channel. Conversely,
η1,1(m) only depends on the ﬁrst derivative of the channel response and, thus, it contributes to the
in-band distortion (compare also with [11, Eq. (35)]). It is also worth remarking that these factors

show a strong dependence on the derivatives of the channel frequency response. We have thus another

evidence that it is generally incorrect to assume that subcarrier channels are frequency ﬂat.

The second type of factors, on the other hand, corresponds to system design variables, namely the

prototype pulses, the user’s assigned subcarriers and its transmit power. Fig. 4 depicts the behavior
of the design factor of η0,0(m), namely

(cid:105)

(cid:104)

ζ(m) = Re tr

U−Fk(m)X R− 1

(p,q,p,q) + U+Fk(m)X S(p,q,p,q)

2

I

for a user transmitting on subcarriers 1–64 with power Ps and where the prototype pulse of Fig. 3
is used on both sides. As we can see, factor ζ(m) is almost constant on the user subcarriers Ik =
{1, . . . , 64}, while it decays abruptly outside Ik. More speciﬁcally, the loss is about 7 dB at the
ﬁrst out-band subcarrier (i.e., number 65 and 128) and 58 dB at the second out-band subcarrier

(i.e., number 66 and 127). In other words, the out-band interference is negligible except for the ﬁrst

subcarrier on both sides of the user’s assigned spectrum.

The behavior of ζ(m) is closely related to the frequency response of the prototype pulses employed

in the FBMC system. To see this, consider the case where the overlapping factor is set to κ = 1 (all
other constraints, namely AS1, AS2, PR and symmetry, still hold). Also, let pN [n] = qN [n], that is

March 21, 2016

DRAFT

164128−150−100−500Subcarrierζ(m)/Ps[dB]626466−40−20012

Fig. 5. Circular cross-correlation of two vectors with few nonzero entries. Recall that −m0 ≡ 2M − m0 modulo 2M.

the same pulse is used on both sides. Then, matrix R(pN , qN ) in (1) is actually a vector, namely

(cid:104)

(cid:105)T

p2
2M [2M ]

.

R(p2M , p2M ) = r =

···
Denote by ρ = [ρ1 ··· ρ2M ]T the DFT of r, that is ρ = FH
M(cid:88)
the ﬁrst term of ζ(m) as

p2
2M [1]

(cid:104)

(cid:105)

Re tr

U−Fk(m)X R− 1

2

(p,q,p,q)

I

2M r. Simple algebra allows us to rewrite

|ρ2n|2βk,2n−m+1

= 2

n=1

(14)

where βk,n = E[b2
k,n]/(2M ). For well designed prototype pulses, we will now prove that the right-
hand side of (14) is identically null for most m /∈ Ik. Indeed, without loss of generality, we can
assume that Ik = {mmin, . . . , mmax} and, thus, βk,n (cid:54)= 0 ⇔ mmin ≤ n ≤ mmax. On the other hand,
if the prototype pulses are low-pass ﬁlters, the number of nonzero Fourier coefﬁcients is limited.
More speciﬁcally, there exists an integer value m0 (typically m0 ≈ 2κ, see, e.g., [24]) such that
ρn (cid:54)= 0 if and only if 1 ≤ n ≤ m0 + 1 or 2M − m0 + 1 ≤ n ≤ 2M (recall that, since r is real,
ρn = ρ2M−n+2 for n = 2, . . . , 2M). Then, a careful inspection of the indices (Fig. 5 may help in this
purpose) shows that ζ(m) is not zero if and only if3 mmin−m0 ≤ m ≤ mmax +m0. Similar reasoning
holds for the second term of ζ(m) and for all the other distortion terms ηx,y(m). Conversely, by a
similar reasoning, it is readily seen that the distortion terms ηx,y(m) may be signiﬁcantly different
than zero for most m if the spectrum containment property of the prototype pulses is not as strict and

the number of nonzero Fourier coefﬁcients is high. In this category we ﬁnd pulses for time-limited

orthogonal multicarrier modulation schemes [25] and some pulses maximizing the time–frequency

localization of the signal [7], [16]–[18].

Summarizing the above discussion, an accurate design of the prototype pulses permits the out-

band distortion to be conﬁned within few subbands at the boundaries of the user of interest. A
proper equalization (e.g. zero forcing), conversely, reduces the in-band distortion, since terms η0,0(m),

3Index algebra is modulo 2M.

March 21, 2016

DRAFT

−m0m0mminmmaxmmin−m0mmax+m0nullentrynonzeroentry13

η0,1(m) and η0,2(m) can be easily canceled out. Unfortunately, with the considered single-tap-per-
subcarrier equalizer, no degrees of freedom are left to further minimize η1,1(m), which depends on
the ﬁrst derivative of the channel frequency response.

IV. NUMERICAL ANALYSIS

In this section, the theoretical results above are veriﬁed against numerical ones obtained by sim-

ulating a realistic FBMC-based OFDMA channel. More speciﬁcally, we consider a scenario with

2M = 128 subcarriers, spaced by 15 kHz. The resulting total bandwidth of 1.920 MHz is thus

compliant with the LTE standard [2]. The overlapping factor is set to κ = 4 and the prototype

pulse proposed by the EU-funded project PHYDYAS [23], depicted in Fig. 3, is used at both the

transmitter side and the receiver side. Note that this pulse is not PR-compliant and, thus, the full

distortion expression of Appendix A shall be used. We also assume that two users are accessing

the channel and that each of them is assigned 64 subcarriers (subcarrier 1 to 64 to User 1 and

subcarrier 65 to 128 to User 2). The equalizer is tuned according to the zero-forcing principle on
k (ωm) for all m ∈ Ik. All subcarrier are subject to a white
each user’s subband, i.e. Wm = H−1
Gaussian noise process with variance σ2. Finally, the transmitted symbols are uniformly drawn from
a 4QAM constellation with power Ps.

A. Theory Assessment

In order to test the above results with different degrees of channel frequency selectivity, we assume

that the channels of the two users follow either the ITU Extended Pedestrian A (EPA) model or the

ITU Extended Vehicular A (EVA) model [26]. More speciﬁcally, for the channel instances depicted in

Fig. 6 and Fig. 7, we compute the subcarrier Signal-to-Noise-and-Distortion Ratio (SNDR) according

to

where Pe(m) = (cid:80)2
Pw(m) = σ2|Wm|2M−1(cid:80)N

SNDR(m) =

Ps

Pe(m) + Pw(m)

k=1 Pe,k(m) is the total distortion, sum of users’ contributions as in (10), and
N [n] is the noise power at the output of the ﬁlterbank. For both
channel cases and for a Signal-to-Noise Ratio (SNR = Ps/σ2) of either 20 dB or 40 dB, the
results are depicted in Fig. 8 and compared to the empirical values obtained by averaging over 2000

n=1 q2

multicarrier symbols. As one can observe, the two curves match perfectly.

It is interesting to note that, when increasing the transmit power from 20 dB to 40 dB over the

noise level, the SNDR improves by a mere 6 dB and saturates at around 23 dB. This is indeed the
inverse of the distortion level Pe(m)/Ps, as one can appreciate from Fig. 9. The curves of Fig. 9
also conﬁrm that the in-band distortion (the one generated by a user in its own subband) is the main

cause of signal degradation at high SNR. The out-band distortion, on the other hand, is signiﬁcant

March 21, 2016

DRAFT

14

Fig. 6. Two example realizations of EPA channel.

Fig. 7. Two example realizations of EVA channel.

Fig. 8. Theoretical (line) and empirical (markers) SNDR for the two-user case. The ratio Ps/σ2 is set to 20 dB (left) and
40 dB (right). Reported examples correspond to EPA channel model (top) and EVA channel model (bottom).

March 21, 2016

DRAFT

−4−202Magnitude[dB]channel1channel2164128−π0πSubcarrierPhase[rad]−40−200Magnitude[dB]channel1channel2164128−π0πSubcarrierPhase[rad]16412810152025SubcarrierSNDR[dB]EPA,SNR=20dB16412810152025SubcarrierSNDR[dB]EPA,SNR=40dB164128−20020SubcarrierSNDR[dB]EVA,SNR=20dB164128−20020SubcarrierSNDR[dB]EVA,SNR=40dB15

Fig. 9. Normalized distortion power for the two users. Example of EPA channel model (top) and of EVA channel model
(bottom).

TABLE I

PULSE FOURIER COEFFICIENTS

Index

1

2

3

4

5–256

Magnitude

4.000

3.888

2.828

0.940

0

only in the ﬁrst subcarrier outside the user’s subband, as evinced from the peaks in Fig. 9 (and from

the dips in Fig. 8). This could be predicted according to Section III-B1, keeping in mind that the

Fourier coefﬁcients of the prototype pulse in use are those reported in Table I (only M coefﬁcients

are needed since the pulse is real-valued).

B. Delay Channels

In order to conﬁrm the interest for FBMC/OQAM as an enabler technology for OFDMA, we

compare the performances of the considered scheme with those of CP-OFDMA in a simple study

case: the channels of both users do not introduce other impairment than a delay. More speciﬁcally,

we consider the receiver to be perfectly synchronized with User 1, while User 2 is received with a

delay equal to an integer number of samples. In what follows, we focus on how the delay of User 2

affects the SNDR of User 1. Note that, analogously, we could have focused on User 2. Indeed, even

though the two users cannot synchronize to one another, it is realistic to assume that the BS is able

March 21, 2016

DRAFT

164128−100−500user1user2SubcarrierDistortion[dB]EPAChanneluser1user2164128−100−500user1user2SubcarrierDistortion[dB]EVAChanneluser1user216

Fig. 10. Comparison between FBMC-based OFDMA and CP-OFDMA: SNDR of User 1 for different delay values of
User 2. The transmit SNR is set to 40 dB.

to synchronize alternatively to both of them in order to retrieve their transmitted signal. The ability

of FBMC to deal with the timing of each subcarrier (and hence of each user) separately is a strong

advantage of this multicarrier multiple-access scheme when compared to classical CP-OFDM.

Fig. 10 shows the SNDR corresponding to the subcarriers of User 1 for different delays between the

two users. The transmission scheme is either the FBMC/OQAM-based one described in the previous

sections or a classic CP-OFDMA scheme with a cyclic preﬁx of 32 samples (25% of the number of

subcarriers). Both users are assumed to transmit with a power that is 40 dB above the noise level.

When the delay is shorter than the CP, CP-OFDMA is capable of compensating it perfectly and no

distortion is introduced (see Fig. 10a corresponding to a delay of 16 samples). However, as soon

as the delay between the two users is larger than the CP (see graphs b, c and d of Fig. 10) the

performances of CP-OFDMA decay catastrophically, with a drop of 20 dB. A detailed analysis of

the distortion generated in a CP-OFDMA system is reported in Appendix B.

Conversely, FBMC-based OFDMA proves itself robust to user asynchronicities: User 1 is received

with the same SNDR in all the considered examples. More speciﬁcally, for all delay values, the

quality of the received signal is approximately the same as the one obtained by CP-OFDMA in the

short delay case (see Fig. 10a). Only the ﬁrst and the last subcarriers show a signiﬁcant degradation,

due to the leakage effect discussed before.

March 21, 2016

DRAFT

0102030405060010203040SubcarrierSNDR[dB]16-sampledelayFBMCCP-OFDM0102030405060010203040SubcarrierSNDR[dB]33-sampledelay0102030405060010203040SubcarrierSNDR[dB]50-sampledelay0102030405060010203040SubcarrierSNDR[dB]64-sampledelay17

C. Symbol Error Rate

To conclude our study and the comparison between the two multiple-access techniques, Fig. 11

reports some Symbol-Error-Rate (SER) curves obtained simulating the transmission of 1000 bursts

of 100 multicarrier symbols. For each burst, the users’ channels are drawn independently according
to the EVA model. SER is reported as a function of the received energy per bit Eb, normalized with
respect to the noise spectral density N0. A single guard band separates the users (subcarriers 64 and
128 are switched off).

Two different synchronization assumptions are considered. In the ﬁrst one (top graphs), the transmis-

sions of the two users are synchronized. In this case, CP-OFDMA follows the theoretic performance

of the chosen QAM constellation (4QAM for the left graphs and 16QAM for the right ones [27,

Chapter 5]) with a 1-dB loss, approximately, due to the CP overhead. Indeed, the length of the

channel (around 14 taps for the EVA model with a 1.92-MHz bandwidth) is perfectly compensated
by the 32-sample CP. Conversely, FBMC is closer to the theoretic curve at low Eb/N0 values, but
its performance worsens as we increase the SNR due to the inherent interference discussed above, as

suggested by the curve ﬂoor visible in the 16QAM case. (In the 4QAM case, the SER ﬂoor of the

FBMC curve falls outside the depicted range.)

The bottom graphs, on the other hand, are obtained introducing a delay between the two users.

This delay is equal to an integer number of samples, varies at each burst and is uniformly distributed

between 0 and 127 samples (i.e. one multicarrier symbol). As we can see from Fig. 11, asynchronous

transmissions do not imply a signiﬁcant performance loss for the FBMC conﬁguration. This is not the

case for the scheme based on CP-OFDM: since the CP is too short to compensate the total length of
the channel (delay plus impulse response), the SER does not improve as desired for Eb/N0 > 10 dB
and the performance is much worse than for the FBMC scheme.

V. CONCLUSIONS

In this paper we have rigorously analyzed the interaction between users in an FBMC/OQAM-based

OFDMA system. More speciﬁcally, for a reasonably high number of subcarriers, we have been able

to express the per-subcarrier interference as the sum of users’ terms. It is important to remark that,

in general, the distortion at a given subcarrier does not depend exclusively on the user transmitting

on that subcarrier, but also on all other users. Our analysis shows that, when the prototype pulses are

well designed, the distortion caused by a given user decays steeply outside the user’s subband and

can be neglected after few subcarriers (or even after a single subcarrier, as in the example of Fig. 9).

This result supports the choice of placing a single empty guard band between users. To the best of

our knowledge, such a choice was only empirically justiﬁed until now. Moreover, the spread of the

March 21, 2016

DRAFT

18

Fig. 11.
Symbol error rate as a function of Eb/N0 (measured at the receiver side) for FBMC-based OFDMA and CP-
OFDMA. Users’ transmissions are either synchronized (top) or not (bottom) and the transmitted symbols belong either to
a 4QAM constellation (left) or to a 16QAM constellation (right).

out-band interference depends neither on the channel responses (of any user) nor on the equalizer

coefﬁcients, thus simplifying the task of designing the prototype pulses.

As for the comparison to the more classical CP-OFDMA scheme, the ideal case with synchronized

users suggests that the FBMC approach is not worth the complexity. Indeed, the CP causes a loss in

the order of 1 dB at low-to-medium SNR, but avoids performance ﬂoors at high SNR (see Fig. 11,

top graphs). However, in more practical scenarios where users’ transmissions are not synchronized,

the length of the equivalent channel (delay plus impulse response) can easily exceed the CP. In this

situation, the performance of CP-OFDMA drops abruptly, whereas the FBMC scheme proves to be

very robust, showing no signiﬁcant degradation and without need for any extra signal processing (see

Fig. 11, bottom graphs).

Summarizing, ﬁlterbank modulations offer a convenient solution to the multiple-access channel

problem, since they can deal with asynchronous users without increasing complexity. Furthermore,

the tools presented in this paper allow the designer to choose the prototype pulses that minimize

both inter-user interference and number of guard bands. Remarkably, no channel state information is

needed to carry out this task.

March 21, 2016

DRAFT

−505101510−310−1Eb/N0[dB]SER4QAM,synchronoususers0510152010−310−1Eb/N0[dB]SER16QAM,synchronoususers−505101510−310−1Eb/N0[dB]SER4QAM,asynchronoususers0510152010−310−1Eb/N0[dB]SER16QAM,asynchronoususersFBMCCP-OFDMQAMTheoryAPPENDIX A

PROOF OF PROPOSITION 1

19

In this appendix we show how the terms in (11) are derived. To do so, we ﬁrst obtain a general

expression for the distortion generated by user k at subcarrier m. Then, the simpliﬁed form in (11)

is obtained by particularizing to the the special case considered in Proposition 1.

A. The General Case

For practical reasons, let us deﬁne the following matrices and vectors:

(cid:16)
(cid:16)

yodd
k

yodd

k

pN , q(r)
N

pN , q(r)
N

=

=

(cid:17)
(cid:17)

(cid:17)(cid:105)

pN , q(r)
N

(cid:16)
(cid:16)

yodd

k
yodd

k

pN , q(r)
N
pN , q(r)
N

:,n+κ−1

(cid:17)(cid:111)

(cid:17)(cid:111)

Yodd

(cid:104)
(cid:16)
 Re
(cid:110)
(cid:110)

k

− Im
(−j)i
i!

WmH (i)

tk,m(i) =
Tk(i) = diagm=1,...,2M {tk,m(i)}

k (ωm),

i = 0, 1, 2

=

tk,m(i) =



(−j)i
i!

WΛH (i)

k

0m−1

Re{tk,m(i)}

02M

Im{tk,m(i)}
02M−m−1

,



i = 0, 1, 2

(15)

and, for a generic column vector u ∈ C2M ,

2M diag(cid:8)F2M Φ∗u(cid:9)
2M diag(cid:8)(J2 ⊗ IM )F2M Φ∗u(cid:9).

M(u) = ΦFH

(cid:102)M(u) = ΦFH

Then, denoting by bk(r) [ck(r), respectively] the r-th column of Bk (Ck, respectively), from (3)
one can write

(cid:16)

(cid:17)

Ns(cid:88)

M(cid:0)bk(i)(cid:1)[R(pN , q(r)

yodd
k

pN , q(r)
N

= 2

i=1

March 21, 2016

N )]:,n+κ−i

Ns(cid:88)

i=1

+ 2

(cid:102)M(cid:0)jck(i)(cid:1)[S1(pN , q(r)

[S2(pN , q(r)

N ]:,n+κ−1−i
N ]:,n+κ−i

 (16)

DRAFT

(cid:20)(cid:12)(cid:12)(cid:12)Re[zodd

E

where

20

η1,1(m) + o(cid:0)M−2(cid:1)
2M ]T(cid:17)T(cid:21)

tk,m(0)

where all column vectors are intended identically null when the column index is negative or higher
than 2κ − 1. Moreover, keeping (7) and (15) in mind, the distortion can be expressed as follows:

(cid:12)(cid:12)(cid:12)2(cid:21)

k,m] − tk,m(0)bk,m

= η0,0(m) +

2
2M

η0,1(m)

(cid:20)(cid:16)
(cid:20)(cid:16)
(cid:20)(cid:16)
(cid:20)(cid:16)

η0,0(m) = tT

k,m(0) E

η0,1(m) = tT

k,m(0) E

η0,2(m) = tT

k,m(0) E

η1,1(m) = tT

k,m(1) E

k (pN , qN ) − [bT
yodd
k (pN , qN ) − [bT
yodd
k (pN , qN ) − [bT
(cid:17)(cid:16)
yodd

yodd
k (pN , q(cid:48)N )

k (n), 0T

k (n), 0T

k (n), 0T

+

1

4M 2

η0,2(m) +

1

4M 2

2M ]T(cid:17)(cid:16)
2M ]T(cid:17) ×(cid:16)
2M ]T(cid:17)(cid:16)
(cid:17)T(cid:21)

(cid:17)T(cid:21)
k (pN , qN ) − [bT
yodd
(cid:17)T(cid:21)

yodd
k (pN , q(cid:48)N )

yodd
k (pN , q(cid:48)(cid:48)N )

k (n), 0T

tk,m(1)

tk,m(2)

yodd
k (pN , q(cid:48)N )

tk,m(1).

Before taking the next step, we need to introduce the following result, whose proof follows the

same lines as [11, Lemma 2].

Lemma 1: Let u ∈ R2M be a real-valued random vector of independent entries with zero mean
and diagonal covariance matrix Qu. Recalling the deﬁnitions of U+ and U− in (6), and for m =
1, . . . , 2M, we can write

(cid:20)(cid:2)MRe(u)(cid:3)T
(cid:20)(cid:2)MIm(u)(cid:3)T
(cid:20)(cid:2)MRe(u)(cid:3)T
(cid:20)(cid:2)MIm(u)(cid:3)T

E

E

E

E

m,:

m,:

m,:

m,:

(cid:2)MRe(u)(cid:3)
(cid:2)MIm(u)(cid:3)
(cid:2)MIm(u)(cid:3)
(cid:2)MRe(u)(cid:3)

(cid:21)
(cid:21)
(cid:21)
(cid:21)

m,:

m,:

m,:

m,:

U+ Re{Fu(m)}

U− Re{Fu(m)}

=

=

1
2

1
2

U+ Im{Fu(m)}

=

1
2
= − 1
2

U− Im{Fu(m)}

where Fu(m) = FH
Im{M(u)}.

2M QuF2M (cid:12) f (m)f H (m), together with MRe(u) = Re{M(u)} and MIm(u) =

The same results hold when M(u) is replaced everywhere by (cid:102)M(u).
Given (16), a direct application of this lemma to η1,1(m) yields (17d) at the top of next page.
Recall that X R(p,q(cid:48),p,q(cid:48)) and X S(p,q(cid:48),p,q(cid:48)) are deﬁned in (12) and (13), respectively, and that Fk(m) =
2M QkF2M (cid:12) f (m)f H (m), with Qk = E[bk(r)bT
FH
Similar expressions can be found for the other three terms η0,0(m), η0,1(m) and η0,2(m), also [see
k (pN , qN ) by

(17a)–(17c)]. Indeed, it is enough to realize that (16) holds true even if we replace yodd
k (pN , qN ) − bk(n) and R(pN , qN ) by R(pN , qN ) − 1
yodd

k (r)], for any r = 1, . . . , Ns.

k (r)] = E[ck(r)cT

I.

2

March 21, 2016

DRAFT

(cid:104)

I

(p,q,p,q) + U−Fk(m)X S(p,q,p,q)

(cid:105)
(p,q,p,q) + U+Fk(m)X S(p,q,p,q)

I

2

(cid:105)

η0,0(m) = 2 Re2[tk,m(0)] Re tr

(cid:104)
U+Fk(m)X R− 1
+ 2 Im2[tk,m(0)] Re tr
− 4 Re[tk,m(0)] Im[tk,m(0)]

U−Fk(m)X R− 1

2

η0,1(m) = 2 Re[tk,m(0)] Re[tk,m(1)] Re tr

η0,2(m) = 2 Re[tk,m(0)] Re[tk,m(2)] Re tr

2

2

2

2

I

2

(cid:104)

(cid:104)

× Im tr

I,R
I,R
I,R

(cid:105)
(p,q,p,q(cid:48)) + U−Fk(m)X S(p,q,p,q(cid:48))

(I2 ⊗ JM )Fk(m)X R− 1
(p,q,p,q) − (I2 ⊗ JM )Fk(m)X S(p,q,p,q)
(cid:104)
U+Fk(m)X R− 1
(cid:104)
+ 2 Im[tk,m(0)] Im[tk,m(1)] Re tr
(cid:104)
+ 2 Re[tk,m(0)] Im[tk,m(1)] Im tr
(cid:104)
− 2 Im[tk,m(0)] Re[tk,m(1)] Im tr
(cid:104)
U+Fk(m)X R− 1
(cid:104)
+ 2 Im[tk,m(0)] Im[tk,m(2)] Re tr
(cid:104)
+ 2 Re[tk,m(0)] Im[tk,m(2)] Im tr
− 2 Im[tk,m(0)] Re[tk,m(2)] Im tr

(cid:105)
I,R
U−Fk(m)X R− 1
(p,q,p,q(cid:48)) + U+Fk(m)X S(p,q,p,q(cid:48))
U−Fk(m)X R− 1
(p,q,p,q(cid:48)) + U+Fk(m)X S(p,q,p,q(cid:48))
(cid:105)
U+Fk(m)X R− 1
(p,q,p,q(cid:48)) + U−Fk(m)X S(p,q,p,q(cid:48))
I,R
(p,q,p,q(cid:48)(cid:48)) + U−Fk(m)X S(p,q,p,q(cid:48)(cid:48))
U−Fk(m)X R− 1
(p,q,p,q(cid:48)(cid:48)) + U+Fk(m)X S(p,q,p,q(cid:48)(cid:48))
(p,q,p,q(cid:48)(cid:48)) + U+Fk(m)X S(p,q,p,q(cid:48)(cid:48))
U−Fk(m)X R− 1
U+Fk(m)X R− 1
(p,q,p,q(cid:48)(cid:48)) + U−Fk(m)X S(p,q,p,q(cid:48)(cid:48))

(cid:105)
U−Fk(m)X R(p,q(cid:48),p,q(cid:48)) + U+Fk(m)X S(p,q(cid:48),p,q(cid:48))

(cid:104)
U+Fk(m)X R(p,q(cid:48),p,q(cid:48)) + U−Fk(m)X S(p,q(cid:48),p,q(cid:48))
+ 2 Im2[tk,m(1)] Re tr
− 4 Re[tk,m(1)] Im[tk,m(1)]

I,R
I,R
I,R

(cid:104)

(cid:105)

2

2

2

2

(cid:105)
(cid:105)
(cid:105)
(cid:105)
(cid:105)
(cid:105)

× Im tr

(I2 ⊗ JM )Fk(m)X R(p,q(cid:48),p,q(cid:48)) − (I2 ⊗ JM )Fk(m)X S(p,q(cid:48),p,q(cid:48))

(cid:105)

η1,1(m) = 2 Re2[tk,m(1)] Re tr

(cid:104)

21

(17a)

(17b)

(17c)

(17d)

B. The Special Case of Proposition 1

In the previous section we have derived a general expression for the distortion caused by user k at

subcarrier m and shown how it depends on 1) the power/resource allocation policy through matrix
Fk(m), 2) the channel and the chosen equalizer through coefﬁcients tk,m(i), and 3) the prototype
pulses through matrices R(pN , q(r)
N ). It is worth remarking that the expression is
as general as possible and holds for any choice of prototype pulses pN [n] and qN [n] that fulﬁll
assumptions AS1 and AS2. More speciﬁcally, there are no requirements about symmetry or perfect
reconstruction. In what follows, we show how the distortion terms simplify to (11) when the prototype
pulses are symmetric (e.g. pN [n] = pN [N − n + 1]) and meet PR conditions (5).

N ) and S(pN , q(r)

To that purpose, we need the two following results. Proofs are omitted to due to space constraints,

March 21, 2016

DRAFT

but are straightforward consequences of the fact that Fk(m) is a circulant matrix.

Lemma 2: For any 2M × 2M complex matrix A the following identities hold true (note the

22

commuting signs in the second equation):
U±Fk(m)A
U±Fk(m)A

Im tr

Re tr

(cid:104)
(cid:104)

Lemma 3: Let A be a 2M × 2M complex matrix such that

(cid:105)
(cid:104)Fk(m)U±AU±
(cid:104)Fk(m)U∓AU±
(cid:105)
 .

.

=

=

1
2
1
2

Re tr

Im tr

(cid:105)
(cid:105)
 A1 A2
(cid:105)
(cid:104)Fk(m)A
(cid:105)

−A2 −A1

tr

= 0.

A =

Then

Lemma 2, together with (5), implies that most of the terms in (17) cancel out when the prototype

pulses meet the PR conditions. Take, for instance, the ﬁrst term of η0,0(m). We have

(p,q,p,q)U+(cid:105)
where we have used the fact that (5a) can be rewritten as U+(cid:16)R(pN , qN ) − 1

(cid:104)Fk(m)U+X R− 1

U+Fk(m)X R− 1

= Re tr

2 Re tr

I(cid:17)

(p,q,p,q)

(cid:104)

= 0

I

I

2

2

= 0.

Assume now that the prototype pulses are also symmetric, besides PR-compliant. Note that if qN [n]
is symmetric (i.e. qN [n] = qN [N−n+1]), then so is its second derivative (i.e. q(cid:48)(cid:48)N [n] = q(cid:48)(cid:48)N [N−n+1]),
while the ﬁrst derivative is anti-symmetric (i.e. q(cid:48)N [n] = −q(cid:48)N [N − n + 1]). In this case, other terms
null out as a consequence of Lemma 3. For example, for the second term of η0,1(m), we have

2 Re tr

U−Fk(m)X R− 1

I,R
(p,q,p,q(cid:48))

2

= Re tr

(cid:105)

(cid:104)Fk(m)U−X R− 1

2

I,R

(p,q,p,q(cid:48)) U−

= 0

(cid:104)

since the symmetry properties of pN [n] and qN [n], together with U−I = 0, imply that product matrix
U−X R− 1

(p,q,p,q(cid:48)) U− meets the hypothesis of Lemma 3.

I,R

2

We have thus proven how the general distortion terms in (17) simplify into those of (11) when the

prototype pulses are symmetric and satisfy the PR conditions.

C. The Single-User Case

The distortion formula (10) with terms ηx,y(m) given by (17) holds for all prototype pulses and
for any number of users. In particular, for K = 1, it allows computing the distortion of a single-user

2

(cid:105)

FBMC/OQAM link with a one-tap equalizer per subcarrier. The resulting expression

(cid:104)

Pe(m) =

Ps
M

tr

U+X R− 1

2

I

(p,q,p,q)

(cid:105)

+
− Ps
4M 3

WmH (1)(ωm)

(cid:104)
(cid:105)
(cid:105)
(cid:104)
(cid:12)(cid:12)(cid:12)WmH (1)(ωm)
(cid:12)(cid:12)(cid:12)2

tr

2

(cid:105)

I,R
U+X R− 1
(p,q,p,q(cid:48))
I,R

(cid:104)
(cid:20)
U+X R(p,q(cid:48),p,q(cid:48)) + U−X S(p,q(cid:48),p,q(cid:48))

tr
U+X R− 1

(p,q,p,q”)

(cid:105)

tr

2

WmH (2)(ωm)

Im

(cid:104)

Ps
M 2
Re

+

Ps
4M 3

is thus a generalization of [11, Eq. (35)], which refers to the PR case.

March 21, 2016

(cid:21)

(18)

DRAFT

APPENDIX B

DISTORTION IN CP-OFDM

23

This appendix derives an expression for the signal distortion in a CP-OFDMA system where the

length of the channel is larger than the cyclic preﬁx. More speciﬁcally, we consider a CP of length
L and a channel of length L + LT with taps {hk,(cid:96)}(cid:96)=1,...,L+LT (for simplicity, we assume here that
LT < L < 2M). The resulting distortion expression was used to draw the CP-OFDM curves in
Fig. 10.

Maintaining the same notation as in Section II, the contribution to the output signal due to user k

can be written as

Z(CP)
k = WFH

2M ΨHkΨF2M [Ak 0] + WFH

2M ΨHk,T ΨF2M [0 Ak]

(19)

where matrices

Ψ =

0L×(2M−L) IL



I2M

(cid:104)

Ψ =

(cid:105)

02M×L I2M

apply and remove the CP of length L, respectively. The (2M + L)× (2M + L) channel matrix Hk is
a lower triangular Toeplitz matrix whose ﬁrst column is [hk,1 ··· hk,L+LT 01×(2M−LT )]T . Similarly,
the (2M + L) × (2M + L) matrix Hk,T is a upper triangular Toeplitz matrix whose ﬁrst row is
[01×(2M−LT +1) hk,L+LT ··· hk,2].
It is straightforward to realize that (19) corresponds to the classic OFDM model when LT = 1 and

the CP covers the entire channel length. Indeed, LT = 1 implies Hk,T = 0. Also, we have

ΛHk = FH

2M ΨHkΨF2M

where ΛHk is the diagonal matrix ﬁlled with the channel frequency response deﬁned in Section II.
Thus, for channels not longer than L+1 taps, it is enough to set W = Λ−1
Hk to recover the transmitted
symbols perfectly, namely Z(CP)

k = [Ak 0].

Conversely, when LT > 1, matrix ΨHkΨ is not diagonalizable anymore and an extra term appears.

March 21, 2016

Namely

where we introduced the 2M × 2M matrix

2M − (cid:101)Hk

ΨHkΨ = F2M ΛHkFH

(cid:101)Hk =

0(LT−1)×(2M−L−LT +1) Tk 0(LT−1)×L

 .
0(LT−1)×(2M−LT +1) Tk

0(2M−LT +1)×2M

(cid:101)Hk,T = ΨHk,T Ψ =

0(2M−LT +1)×2M

and where Tk is a (LT − 1) × (LT − 1) upper triangular Toeplitz matrix with [hk,L+LT ··· hk,L+2]
as its ﬁrst row. Furthermore, let us denote

(20)

(21)

DRAFT

Then, for a generic one-tap-per-subcarrier equalizer W, (19) can be rewritten as

k = WΛHk[Ak 0] − WFH
Z(CP)

2M(cid:101)HkF2M [Ak 0]WFH

2M(cid:101)Hk,T F2M [0 Ak].

24

(22)

Proposition 2: Let ak be a generic column of matrix Ak and let σk = (2M )− 1

2 FH diag E[akaH
k ]
(independent of the choice of ak since all entries of Ak are i.i.d.). In other words, the elements
{σk,i}i=1,...,2M of σk are the normalized Fourier coefﬁcients associated to the power levels assigned
to the subcarriers by user k. Next, denote by Xk the Toeplitz upper triangular matrix whose ﬁrst row
is σT

k . Then, the contribution of user k to the total distortion at subcarrier m is

e,k (m) = E(cid:12)(cid:12)(cid:12)(cid:2)Z(CP)

k

P (CP)

(cid:3)

= 2|Wm|2 Re

− WmHk(ωm)(cid:2)Ak

(cid:3)
(cid:26)
f H (m)(2Xk − σk,1I2M )

m,n

m,n

(cid:12)(cid:12)(cid:12)2
(cid:104) TkTH

k 0
0

0

(cid:105)

(cid:27)

f (m)

.

(23)

Proof: From (22), and since all the columns of Ak are i.i.d., we have

e,k (m) = |Wm|2f H (m)(cid:101)HkF2M E|akaH

P (CP)

k f (m)

2M(cid:101)HH
k |2FH
+ |Wm|2f H (m)(cid:101)Hk,T F2M E|akaH
(cid:17)T(cid:21)
2M(cid:88)

(cid:16)T 2M−i+1

T i−1
2M +

(cid:20)

σk,i

2M

i=1

2M(cid:101)HH

k |2FH

k,T f (m).

Also, we can write

F2M E|akaH

k |2FH

2M =

(cid:101)HkF2M E|akaH

where T2M is a 2M × 2M shift matrix, with ones in the superdiagonal (i.e. [T2M ]i,i+1 = 1 for all
Noting from (20) and (21) that (cid:101)Hk and (cid:101)Hk,T are shifted versions of the same matrix and recalling
i = 1, . . . , 2M − 1) and zeros elsewhere.
that σk,i = σ∗k,2M−i+2 for all i = 2, . . . , 2M, we can write
k = (cid:101)Hk,T F2M E|akaH
2M(cid:101)HH
(cid:104) TH
k |2FH
k |2FH
(cid:104) TkTH
(cid:105)
2M(cid:88)
σk,iT i−1
(cid:104) TkTH
(cid:105)
(cid:105)

(cid:105)
(cid:104) TkTH

(cid:105)(cid:16)T i−1

2M(cid:101)HH

F2M E|akaH

k |2FH

(cid:17)T

k 0
0 0

σ∗k,i

k 0
0

k 0
0

i=2

2M

2M

2M

k,T

=

=

+

0

0

+

k 0
0

0

(XH

k − σk,1I2M )

= Xk

0 0

(cid:105)

(cid:104) Tk 0
2M(cid:88)
(cid:104) TkTH
2M(cid:88)

i=1

0

Xk =

k 0
0

σk,iT i−1
2M .

since

i=1
Hence, expression (23) follows straightforwardly.

An example of how the length of the CP affects performances is given by Fig. 12, where both

theoretical (line) and empirical (markers, averaged over 2000 multicarrier symbols) values of SNDR

are reported for two different CP lengths. More speciﬁcally, for channel impulse responses of 14 taps

March 21, 2016

DRAFT

25

Fig. 12. Theoretic (line) and empirical (markers) SNDR for a CP-OFDMA channel with two users. The SNR for both
users is set to 40 dB. The channel impulse responses are 14-tap long and correspond to the realizations of Fig. 7. The
length of the cyclic preﬁx is either 32 samples (top) or 5 samples (bottom).

(corresponding to the two EVA model realizations of Fig. 7), we compare the SNDR obtained by

the ideal case (CP of 32 samples, top) with the one obtained by a CP of 5 samples (bottom): some

subcarriers experience losses of approximately 20 dB.

As a ﬁnal remark, it is interesting to see that (23) takes the form

P (CP)
e,k (m) = Ps

|Wm|2
2M 2

mmax(cid:88)

(cid:96)=mmin

sin2(cid:2) π
2M (m − (cid:96))(LT − 1)(cid:3)
2M (m − (cid:96))(cid:3)
sin2(cid:2) π

when User k transmits over subcarriers {mmin, . . . , mmax} at power Ps and when its channel is a
delay of LT − 1 samples (i.e., the channel impulse response is δ[n − LT ]). Note that this is the case
considered in Section IV-B.

REFERENCES

[1] A. Goldsmith, Wireless Communications. New York, NY, USA: Cambridge University Press, 2005.
[2] 3rd Generation Partnership Project, “LTE; Evolved Universal Terrestrial Radio Access (E-UTRA); Physical Channels

and Modulation,” ETSI, Tech. Spec. TS36.211 v12.5.0 release 12, 2015.

[3] M. Morelli, C.-C. J. Kuo, and M.-O. Pun, “Synchronization techniques for orthogonal frequency division multiple

access (OFDMA): A tutorial review,” Proc. IEEE, vol. 95, no. 7, pp. 1394–1427, Jul. 2007.

[4] S. B. Weinstein and P. M. Ebert, “Data transmission by frequency-division multiplexing using the discrete Fourier

transform,” IEEE Trans. Commun. Technol., vol. COM-19, no. 5, pp. 628–634, Oct. 1971.

March 21, 2016

DRAFT

16412802040SubcarrierSNDR[dB]CP:32samples16412802040SubcarrierSNDR[dB]CP:5samples26

[5] P. P. Vaidyanathan, “Filter banks in digital communications,” IEEE Circuits Syst. Mag., vol. 1, no. 2, pp. 4–25, Second

Quarter 2001.

[6] B. Farhang-Boroujeny, “OFDM versus ﬁlter bank multicarrier,” IEEE Signal Process. Mag., vol. 28, no. 3, pp. 92–112,

May 2011.

[7] D. Roque, C. Siclet, and P. Siohan, “A performance comparison of FBMC modulation schemes with short perfect

reconstruction ﬁlters,” in Proc. IEEE ICT 2012, Jounieh, Lebanon, Apr. 23–25 2012.

[8] T. Ihalainen, T. H. Stitz, M. Rinne, and M. Renfors, “Channel equalization in ﬁlter bank based multicarrier modulation

for wireless communications,” EURASIP J. Adv. Signal Process., vol. 2007, 2007.

[9] D. S. Waldhauser, L. G. Baltar, and J. A. Nossek, “MMSE subcarrier equalization for ﬁlter bank based multicarrier

systems,” in Proc. IEEE SPAWC 2008, Recife, Brazil, Jul. 6–9 2008.

[10] G. Ndo, H. Lin, and P. Siohan, “FBMC/OQAM equalization: Exploiting the imaginary interference,” in Proc. IEEE

PIMRC 2012, Sydney, Australia, Sep. 9–12 2012.

[11] X. Mestre, M. Majoral, and S. Pﬂetschinger, “An asymptotic approach to parallel equalization of ﬁlter bank based

multicarrier signals,” IEEE Trans. Signal Process., vol. 61, no. 14, pp. 3592–3606, Jul. 2013.

[12] H. Saeedi-Sourck, Y. Wu, J. W. M. Bergmans, S. Sadri, and B. Farhang-Boroujeny, “Complexity and performance
comparison of ﬁlter bank multicarrier and OFDM in uplink of multicarrier multiple access networks,” IEEE Trans.
Signal Process., vol. 59, no. 4, pp. 1907–1912, Apr. 2011.

[13] D. Mattera, M. Tanda, and M. Bellanger, “Performance analysis of some timing offset equalizers for FBMC/OQAM

systems,” Signal Processing, vol. 108, pp. 167–182, 2015.

[14] T. Ihalainen, A. Viholainen, T. H. Stitz, M. Renfors, and M. Bellanger, “Filter bank based multi-mode multiple access

scheme for wireless uplink,” in Proc. EUSIPCO 2009, Glasgow, Scotland, Aug. 24–28 2009.

[15] D. Mattera, M. Tanda, and M. Bellanger, “Analysis of an FBMC/OQAM scheme for asynchronous access in wireless

communications,” EURASIP J. Adv. Signal Process., vol. 2015, no. 23, 2015.

[16] P. Siohan, C. Siclet, and N. Lacaille, “Analysis design of OFDMA/OQAM systems based on ﬁlterbank theory,” IEEE

Trans. Signal Process., vol. 50, no. 5, pp. 1170–1183, May 2002.

[17] C. Siclet, P. Siohan, and D. Pinchon, “Perfect reconstruction conditions and design of oversampled DFT-modulated

transmultiplexers,” EURASIP Journal on Advances in Signal Processing, vol. 2006, no. 1, pp. 1–15, 2006.

[18] P. Amini, R.-R. Chen, and B. Farhang-Boroujeny, “Filterbank multicarrier communications for underwater acoustic

channels,” IEEE J. Ocean. Eng., vol. 40, no. 1, pp. 115–130, Jan. 2015.

[19] M. Bellanger, “FS-FBMC: An alternative scheme for ﬁlter bank based multicarrier transmission,” in Proc. IEEE

ISCCSP 2012, Rome, Italy, May 2–4 2012.

[20] D. Mattera, M. Tanda, and M. Bellanger, “Frequency-spreading implementation of OFDM/OQAM systems,” in Proc.

IEEE ISWCS 2012, Paris, France, Aug. 28–31 2012.

[21] M. Renfors, J. Yli-Kaakinen, and fredric j. harris, “Analysis and design of efﬁcient and ﬂexible fast-convolution based

multirate ﬁlter banks,” IEEE Trans. Signal Process., vol. 62, no. 15, pp. 3768–3783, Aug. 2014.

[22] B. Farhang-Boroujeny, “Filter bank spectrum sensing for cognitive radios,” IEEE Trans. Signal Process., vol. 56, no. 5,

pp. 1801–1811, May 2008.

[23] A. Viholainen et al., “Prototype ﬁlter and structure optimization,” Project PHYDYAS ICT-211887, Deliverable D5.1,

Jan. 2009.

[24] S. Mirabbasi and K. Martin, “Overlapped complex-modulated transmultiplexer ﬁlters with simpliﬁed design and

superior stopbands,” IEEE Trans. Circuits Syst. II, vol. 50, no. 8, pp. 456–469, Aug. 2003.

[25] R. Li and G. Stette, “Time-limited orthogonal multicarrier modulation schemes,” IEEE Trans. Commun., vol. 43, no.

2/3/4, pp. 1269–1272, Feb. 1995.

March 21, 2016

DRAFT

[26] 3rd Generation Partnership Project, “Evolved Universal Terrestrial Radio Access (E-UTRA); User Equipment (UE)

Radio Transmission and Reception,” ETSI, Tech. Rep. TR36.803 v1.1.0 release 8, 2008.

[27] S. Benedetto and E. Biglieri, Principles of Digital Transmission: With Wireless Applications. New York, NY, USA:

Kluwer Academic / Plenum Publishers, 1999.

27

March 21, 2016

DRAFT

