THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER

MEASURES. PART 1: THE PROBLEM ON A TORUS

HITOSHI ISHII∗, HIROYOSHI MITAKE AND HUNG V. TRAN

Abstract. We develop a variational approach to the vanishing discount problem for
fully nonlinear, degenerate elliptic, partial diﬀerential equations. Under mild assump-
tions, we introduce viscosity Mather measures for such partial diﬀerential equations,
which are natural extensions of the Mather measures. Using the viscosity Mather mea-
sures, we prove that the whole family of solutions vλ of the discount problem with the
factor λ > 0 converges to a solution of the ergodic problem as λ → 0.

6
1
0
2

 
r
a

M
3

 

 
 
]
P
A
h
t
a
m

.

[
 
 

1
v
1
5
0
1
0

.

3
0
6
1
:
v
i
X
r
a

Contents

Introduction and Main Result

1.
1.1. Assumptions
1.2. Main results
Outline of the paper
Notation
2. Compact control set
2.1. Viscosity Mather measures
2.2. Discounted Mather measures
2.3. Convergence with vanishing discount
3. Proof of Theorem 1.4
4. Examples
4.1. First order Hamilton-Jacobi equations with linear growth in the gradient

variable

4.2. Viscous Hamilton-Jacobi equations with superlinear growth in the gradient

variable

2
3
4
4
5
5
6
7
10
11
18

18

19

4.3. Fully nonlinear, uniformly elliptic equations with linear growth in the

gradient variable

19
4.4. Fully nonlinear equations with superquadratic growth in the gradient variable 20
21
Appendix
References
22

Date: March 4, 2016.
2010 Mathematics Subject Classiﬁcation. 35B40, 35J70, 49L25 .
Key words and phrases. additive eigenvalue problem, fully nonlinear, degenerate elliptic PDE, Mather

measures, vanishing discount.

The work of HI was partially supported by the JSPS grants: KAKENHI #23244015, #26220702,
#23340028, the work of HM was partially supported by the JSPS grants: KAKENHI #15K17574,
#26287024, #23244015, and the work of HT was partially supported in part by NSF grant DMS-1615944.

∗ Corresponding author.

1

2

H. ISHII, H. MITAKE, H. V. TRAN

1. Introduction and Main Result

We study the fully nonlinear, possibly degenerate, elliptic partial diﬀerential equation

(PDE for short)

(DP)

λu(x) + F (x, Du(x), D2u(x)) = 0

in Tn,

where λ is a given positive constant, which we call a discount factor in view of stochastic
optimal control and diﬀerential games, F : Tn × Rn × Sn → R is a given continuous
function. Here, Tn and Sn denote the standard n-dimensional torus, i.e., Tn = Rn/Zn,
and the space of n × n real symmetric matrices, respectively. The function u represents a
real-valued unknown function on Tn, and Du and D2u denote the gradient and Hessian of
u, respectively. We are always concerned here with viscosity solutions of fully nonlinear,
possibly degenerate, elliptic PDE, and the adjective “viscosity” is omitted throughout the
paper.

In this paper, we study the vanishing discount problem for (DP), that is, for solutions
vλ of (DP), with λ > 0, we investigate the asymptotic behavior of {vλ}λ>0 as λ → 0.
Associated with the vanishing discount problem for (DP) is the ergodic problem (or the
additive eigenvalue problem):

F (x, Du(x), D2u(x)) = c

(EP)
where the unknown is a pair of a function u ∈ C(Tn) and a constant c ∈ R such that u is
a solution of (EP). If (u, c) ∈ C(Tn) × R is a solution of (EP), then c is called a critical
value (or an additive eigenvalue).

in Tn,

There are many results in the literature on the vanishing discount problem and the

following classical observation is fundamental and well-known.

Observation 1.1. Under appropriate hypotheses on F , for each λ > 0, (DP) has a
unique solution vλ ∈ C(Tn), (EP) has a solution (u, c) ∈ C(Tn) × R, and the constant c
is determined uniquely. Furthermore,

(1.1)

c = − lim
λ→0+

λvλ(x) in C(Tn),

and, for any sequence {λj}j∈N ⊂ (0, ∞) converging to zero such that {vλj − minTn vλj }j∈N
converges in C(Tn), the pair of the function

(1.2)

u(x) := lim
j→∞

(vλj (x) − min
Tn

vλj ) ∈ C(Tn),

and the constant c is a solution of (EP).

This was ﬁrst formulated in this generality in [17], in the context of periodic homog-
enization of ﬁrst order Hamilton-Jacobi equations. Unstated assumptions for the obser-
vation above include the validity of the comparison principle for solutions (subsolutions,
and supersolutions) of (DP) and the equi-continuity of the family {vλ}λ>0 on Tn, which
will be clearly stated later.

One of current interests in the vanishing discount problem is the question of the con-
vergence of the whole family {vλ} of (DP) to a unique limit. That is, the question is
whether the whole family {vλ}λ>0 (after a normalization) converges, or not, to a function
in C(Tn) as λ → 0. The real diﬃculty comes from the fact that (EP) in general has many
solutions even up to additive constants (see [?, Remark 1.2; ?] BCD1997, [17, Remarks],
[20, Example 1] for example) and a priori, the limit (1.2) might depend on the subse-
quence {λi}. The convergence results of the whole family {vλ} were recently established
for convex Hamilton-Jacobi equations in [8] (ﬁrst order case), [1] (ﬁrst order case with

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

3

Neumann-type boundary condition), [20] (degenerate viscous case). In the case of ﬁrst
order equations [1, 8], optimal control formulae are used and the Mather measures, intro-
duced and developed in [18, 19], play a central role. The proof in [20] for a degenerate
viscous case is based on the nonlinear adjoint method, stochastic Mather measures and
a regularization procedure by molliﬁcations to handle the delicate viscous term using a
commutation lemma.

In this paper, we ﬁrst establish a new variational formula for the critical value c, based
on a minimax theorem due to Sion [21], which is inspired by the duality principle in [12],
and prove, in the line of [8], the convergence of whole family {vλ} for fully nonlinear,
(possibly degenerate) elliptic PDEs. In order to present our approach to the vanishing
discount problem in a simple way, we consider the equations on the torus Tn.
In a
forthcoming paper [14], we investigate the vanishing discount problem for fully nonlinear
PDEs in a bounded domain under various boundary conditions.

1.1. Assumptions. We ﬁrst specify the function F here, and state the precise assump-
tions. Let A be a non-empty, σ-compact and locally compact metric space and F :
Tn × Rn × Sn → R be given by

(F1)

F (x, p, X) = sup
α∈A

(− tr a(x, α)X − b(x, α) · p − L(x, α)),

+, b : Tn × A → Rn and L : Tn × A → R are continuous. Here,
where a : Tn × A → Sn
Sn
+ denotes the set of all non-negative deﬁnite matrices A ∈ Sn, tr A and p · q designate
the trace of n × n matrix A and the Euclidean inner product of p, q ∈ Rn, respectively.

Next, we assume

(F2)

F ∈ C(Tn × Rn × Sn).

It is clear under (F1) and (F2) that F is degenerate elliptic in the sense that for all
(x, p, X) ∈ Tn × Rn × Sn, if Y ∈ Sn
+, then F (x, p, X + Y ) ≤ F (x, p, X) and that, for each
x ∈ Tn, the function (p, X) 7→ F (x, p, X) is convex on Rn × Sn. The equations (DP),
(EP), with F of the form (F1), are called Bellman equations, or Hamilton-Jacobi-Bellman
equations in connection with the theory of optimal control. In this viewpoint, the set A
is called a control set or region.

In Section 4, we give some examples of PDEs, to which our main results (Theorems
1.4 and 2.1 below) apply. All PDEs taken up there have the form (F1) and the control
sets A are closed subsets of Euclidean spaces. We, however, believe that it is useful to
formulate our results without assuming the Euclidean structure of A. For instance, in the
application to relaxed controls, the space of probability measures takes the place of the
control set.

We here describe the fundamental settings which we use throughout the paper, and put

labels on these for convenience later.

The comparison principle holds for (DP). More precisely, let λ > 0, φ ∈
C(Tn × A), and U be any open subset of Tn. If v ∈ USC(U), w ∈ LSC(U)
are a subsolution and a supersolution of λu + F (x, Du, D2u) = 0 in U,
respectively, and v ≤ w on ∂U, then v ≤ w in U.

(CP) 
(EC) (cid:26) For λ > 0,

continuous on Tn.

let vλ be a solution of (DP). The family {vλ}λ>0 is equi-

4

H. ISHII, H. MITAKE, H. V. TRAN

There exists a non-empty compact set K0 ⊂ A such that

inf

Tn×(A\K0)

L ≥ L0,

where L0 = max
x∈Tn

inf
α∈A

L(x, α) = − min
x∈Tn

F (x, 0, 0).

(L) 

Condition (L) is always satisﬁed when A is compact. Indeed, if A is compact and if we

set K0 := A and L0 := maxx∈Tn minα∈K0 L(x, α), then we have

max
x∈Tn

min
α∈K0

L(x, α) = L0 ≤

inf

Tn×(A\K0)

L = inf
∅

L = +∞.

Secondly, in case A is not compact, the coercivity of L implies (L). Let us recall that L
is coercive if

L = +∞ at inﬁnity.

Sometimes, we normalize the critical value c to be zero and we put this as an assumption

to conveniently recall later.

(Z)

Problem (EP) has a solution (w, c) ∈ C(Tn) × R and c = 0.

1.2. Main results. We ﬁrst state the fundamental results.

Proposition 1.2. Assume (F1), (F2) and (CP). (i) Let λ > 0. Problem (DP) has a
unique solution in C(Tn). Moreover, there exists a constant M0 > 0 such that λ|vλ| ≤ M0
on Tn for all λ > 0. (ii) Let c1, c2 ∈ R and U be an open subset of Tn. Let v, w ∈
C(U) be, respectively, a subsolution of F (x, Dv, D2v) = c1 in U and a supersolution of
F (x, Dw, D2w) = c2 in U. If c1 < c2 and v ≤ w on ∂U, then v ≤ w in U.

Proposition 1.3. Assume (F1), (F2), (CP), and (EC). Then the conclusions of Obser-
vation 1.1 hold.

These results are quite classical, but we give proofs in Appendix for the self-completeness.

We then address our main result.

Theorem 1.4. Assume (F1), (F2), (CP′′), (EC) and (L). Let c be the critical value of
(EP) and, for each λ > 0, let vλ ∈ C(Tn) be the unique solution of (DP). Then, the
family {vλ + λ−1c}λ>0 converges to a function u ∈ C(Tn) as λ → 0. Furthermore, the
pair (u, c) is a solution of (EP).

We note that we need to assume (CP′′), a comparison principle which is similar to but
stronger than (CP), in Theorem 1.4. Assumption (CP′′) will be stated precisely in Section
3.

Outline of the paper. We ﬁrst consider the case where the control set A is compact
to demonstrate the key ideas of our approach in Section 2 and prove the main result of
the section, Theorem 2.1, which is a simpler version of Theorem 1.4. We then study the
general case and give the proof of Theorem 1.4 in Section 3. Finally, some examples,
which satisfy all assumptions of Theorem 1.4 or Theorem 2.1, are discussed in Section 4.
In Appendix, the proofs of Propositions 1.2 and 1.3 are given, which are quite standard
in the theory of viscosity solutions.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

5

Notation. We often write F [u] to denote the function x 7→ F (x, Du(x), D2u(x)). Given
a metric space E, Lip(E) denotes the space of Lipschitz continuous functions on E. Also,
let USC(E) (resp., LSC(E)) denote the set of all upper semicontinuous (resp., lower
semicontinuous) functions on E, and let Cc(E) denote the space of continuous functions
on E with compact support.

In this section, in order to present the main ideas of the variational approach in a simple

2. Compact control set

way we assume further that

(F3)

the control set A is compact.

We will remove this assumption in the next section.

Before stating the main theorem of this section we give some notions. For φ ∈ C(Tn ×

A), we deﬁne Fφ ∈ C(Tn × Rn × Sn) by

Fφ(x, p, X) = max
α∈A

(− tr a(x, α)X − b(x, α) · p − φ(x, α)),

and consider the problems

(DPφ)

and

(EPφ)

λu(x) + Fφ(x, Du(x), D2u(x)) = 0 in Tn,

Fφ(x, Du(x), D2u(x)) = 0 in Tn.

Note that, since Tn × A is compact, the function Fφ is continuous in Tn × Rn × Sn. We
write Fφ[u] to denote the function x 7→ Fφ(x, Du(x), D2u(x)).

Here is the main theorem of this section.

Theorem 2.1. Assume (F1), (F2), (F3), and (EC). Moreover, we assume

(CP′) 

the comparison principle holds for (DPφ). More precisely, let λ > 0, φ ∈
C(Tn × A), and U be any open subset of Tn. If v ∈ USC(U), w ∈ LSC(U)
are a subsolution and a supersolution of λu + Fφ[u] = 0 in U, respectively,
and v ≤ w on ∂U, then v ≤ w in U.

Let c be the critical value of (EP) and, for each λ > 0, let vλ ∈ C(Tn) be a (unique)
solution of (DP). Then, the family {vλ + λ−1c}λ>0 is convergent in C(Tn) as λ → 0.
Furthermore, if we set

u(x) = lim
λ→0+

(vλ(x) + λ−1c)

for x ∈ Tn,

then (u, c) is a solution of (EP).

Note that assumption (CP′) implies (CP), and thus by Proposition 1.3 that (EP) has
a solution (u, c) ∈ C(Tn) × R and the critical value c is unique. Let vλ be the solution
of (DP) for each λ > 0.

If we set eF = F − c on Tn × Rn × Sn, then the function
v := vλ + λ−1c is a solution of λv + eF [v] = 0 in Tn. Moreover, if u is a solution of (EP),
then u is a solution of eF [u] = 0 in Tn. These observations allow us to assume, without

loss of generality, that the critical value c is zero in Theorem 2.1. In short, we can assume
(Z) without loss of generality.

6

H. ISHII, H. MITAKE, H. V. TRAN

2.1. Viscosity Mather measures. Inspired by the generalization of Mather measures
to second order elliptic PDEs in [12], we introduce viscosity Mather measures for (EP)
and (DP). In the following discussion, we implicitly assume that (Z) holds.

We deﬁne the sets F0 ⊂ C(Tn × A) × C(Tn), G0 ⊂ C(Tn × A), respectively, by

F0 := {(φ, u) ∈ C(Tn × A) × C(Tn) : u is a subsolution of (EPφ)},
G0 := {φ ∈ C(Tn × A) : (φ, u) ∈ F0 for some u ∈ C(Tn)}.

Note that the deﬁnition of F0 depends on a and b, but not on L. Moreover, F0 6= ∅, G0 6= ∅
in view of (Z).

Next, let R denote the space of Radon measures on Tn × A and P denote the space of
Radon probability measures on Tn × A. The Riesz representation theorem ensures that
the dual space of C(Tn × A) is identiﬁed with R. In this viewpoint, we write

hµ, φi =ZTn×A

φ(x, α) µ(dxdα)

for φ ∈ C(Tn × A) and µ ∈ R.

Note that Tn × A can be regarded as a separable metric space, and by the Prokhorov
theorem that, due to the compactness of A, P is sequentially compact, that is, given a
sequence {µj} ⊂ P, we can choose a subsequence of {µj} which converges to some µ ∈ P
weakly in the sense of measure.

Lemma 2.2. Under hypotheses (F1), (F2) and (CP′), the set G0 is a closed convex cone
in C(Tn × A), with vertex at the origin.

Formally, it is easy to see that G0 is convex. Indeed, for any (φ0, u0), (φ1, u1) ∈ F0 such
that u0, u1 ∈ C 2(Tn), setting φt := tφ1 + (1 − t)φ0, ut := tu1 + (1 − t)u0 for t ∈ [0, 1], we
have in the classical sense that

Fφt[ut] ≤ (1 − t)Fφ0[u0] + tFφ1[u1] ≤ 0.

We give a rigorous proof in the next subsection (see the proof of Lemma 2.8).

Let G0

′ ⊂ R denote the dual cone of G0, that is, we set

G0

′ := {µ ∈ R : hµ, φi ≥ 0 for all φ ∈ G0} .

Proposition 2.3. Let µ ∈ G0

′. Then,

(2.1)

Lαψ(x)µ(dxdα) = 0

for all ψ ∈ C 2(Tn),

ZTn×A

where Lα : C 2(Tn) → C(Tn), with α ∈ A, denotes the linear operator given by

Lαψ(x) = − tr a(x, α)D2ψ(x) − b(x, α) · Dψ(x).

Proof. Let ψ ∈ C 2(Tn).
If we set φ(x, α) = Lαψ(x) for (x, α) ∈ Tn × A, then we
have Fφ[ψ] = 0 in Tn in the classical sense and, hence, (φ, ψ) ∈ F0. Similarly, we have
(−φ, −ψ) ∈ F0. These imply that ±φ ∈ G0. Thus, we have hµ, ±φi ≥ 0 and, therefore,
hµ, φi = 0.
(cid:3)

The main claim in this subsection is the following.

Theorem 2.4. Assume (F1), (F2), (CP′) and (Z). Then,

(2.2)

min

µ∈P ∩ G0

L(x, α)µ(dxdα) = 0.

′ZTn×A

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

7

We give a proof of Theorem 2.4 in the next subsection (see the proof of Theorem 2.9).
′,
Note that the minimizing problem (2.2) has a minimizer over the convex cone P ∩ G0
′ is compact in the topology of weak convergence in
since L ∈ C(Tn × A) and P ∩ G0
measure.

In the general case where (Z) is not assumed, the proposition below, which is a direct

consequence of Theorem 2.4, gives a formula for the critical value c.

Corollary 2.5. Assume (F1), (F2), (CP′), and that (EP) has a solution (u, c) ∈ C(Tn)×
R. Then,

(2.3)

c = − min
µ∈P ∩ G0

L(x, α)µ(dxdα).

′ZTn×A

The variational formula above for the additive eigenvalue c (see also Corollary 3.4
below) can be considered as an additive version of a variational formula [2, 9, 10] for the
principal “multiplicative” eigenvalue for second order elliptic operators.

Deﬁnition 2.6 (Viscosity Mather measure). We deﬁne ML,0 ⊂ P as the set of all
′ which solves minimizing problem (2.2). We call any measure
measures µ ∈ P ∩ G0
µ ∈ ML,0 a viscosity Mather measure.

Remark 2.1.

(i) The variational problem (2.2) can be considered as a natural extension of Mather’s
minimizing problem (see [19]) for second order PDEs. This kind of extension was
ﬁrst addressed in [12].

(ii) The identity (2.1) corresponds to the closedness property for the original Mather
measures. A measure satisfying (2.1) is sometimes called a closing measure or a
holonomic measure. This is a “weak” ﬂow invariance condition for the associated
Euler-Lagrange ﬂow for the ﬁrst-order Hamilton-Jacobi equations (see [18]).

2.2. Discounted Mather measures. It is convenient in what follows that the discount
factor λ in (DP) or (DPφ) can be taken as zero. For λ ≥ 0, we deﬁne Fλ ⊂ C(Tn × A) ×
C(Tn) by

Fλ := {(φ, u) ∈ C(Tn × A) × C(Tn) : u is a subsolution of (DPφ)}.

Lemma 2.7. Let λ ∈ [0, ∞). Under hypotheses (F1), (F2) and (CP′), the set Fλ is
convex.

Proof. Let (φ0, u0), (φ1, u1) ∈ Fλ and t ∈ (0, 1), and set φt
ut := tu1 + (1 − t)u0. We prove that λut + Fφt[ut] ≤ 0 in Tn in the viscosity sense.

:= tφ1 + (1 − t)φ0 and

Let ψ ∈ C 2(Tn) and z ∈ Tn be such that ut − ψ has a strict maximum at z. We may
assume that maxTn(ut −ψ) = 0. Then, ut(z) = ψ(z). Suppose that λut(z)+Fφt[ψ](z) > 0,
and show a contradiction.

We choose δ > 0 and an open neighborhood U of z so that

(2.4)

Set

λψ(x) + Fφt[ψ](x) > δ

for all x ∈ U.

w(x) = −t−1(1 − t)u1(x) + t−1ψ(x)

for x ∈ Tn,

and intend to show that w is a supersolution of

(2.5)

λw + Fφ0[w] = t−1δ

in U.

8

H. ISHII, H. MITAKE, H. V. TRAN

Once this is done, we easily get a contradiction. Indeed, we apply the comparison principle
(CP′) to u0 and w, to ﬁnd that

sup
U

(u0 − w) ≤ max
∂U

(u0 − w),

but this is a contradiction since t(u0 − w) = ut − ψ attains a strict maximum at z ∈ U.
To prove the viscosity property (2.5) of w, we ﬁx η ∈ C 2(U) and y ∈ U, and assume

that w − η takes a minimum at y. This implies that the function

−t(1 − t)−1(w − η) = u1 − (1 − t)−1ψ + t(1 − t)−1η

takes a maximum at y. By the viscosity property of u1, we get

(2.6)

λu1(y) + Fφ1[(1 − t)−1ψ − t(1 − t)−1η](y) ≤ 0.

We compute that for any α ∈ A,

Lαψ(y) − tφ0(y, α) − (1 − t)φ1(y, α)

= t(cid:0)Lαη(y) − φ0(y, α)(cid:1) + Lαψ(y) − tLαη(y) − (1 − t)φ1(y, α)
= t(cid:0)Lαη(y) − φ0(y, α)(cid:1)
+ (1 − t)(cid:8)(1 − t)−1Lαψ(y) − t(1 − t)−1Lαη(y) − φ1(y, α)(cid:9) ,

from which we deduce that

Fφt[ψ](y) ≤ tFφ0[η](y) + (1 − t)Fφ1[(1 − t)−1ψ − t(1 − t)−1η](y).

Thus, using (2.4), we get

δ ≤ λψ(y) + tFφ0[η](y) + (1 − t)Fφ1[(1 − t)−1ψ − t(1 − t)−1η](y)

= λ(tw(y) + (1 − t)u1(y)) + tFφ0[η](y) + (1 − t)Fφ1[(1 − t)−1ψ − t(1 − t)−1η](y)

= t {λw(y) + Fφ0[η](y)} + (1 − t)(cid:8)λu1(y) + Fφ1[(1 − t)−1ψ − t(1 − t)−1η](y)(cid:9) .

Combining this with (2.6) yields

t−1δ ≤ λw(y) + Fφ0[η](y).

This shows that w is a supersolution of (2.5), which completes the proof.

(cid:3)

For (z, λ) ∈ Tn × [0, ∞), we deﬁne Gz,λ ⊂ C(Tn × A) by

Gz,λ := {φ − λu(z) : (φ, u) ∈ Fλ for some u ∈ C(Tn)}.

Note that G0 = Gz,0 for all z ∈ Tn.

Lemma 2.8. Let λ ∈ [0, ∞). Under hypotheses (F1), (F2) and (CP′), the set Gz,λ is a
closed convex cone in C(Tn × A), with vertex at the origin.

We note that the lemma above includes Lemma 2.2 as the special case λ = 0.

Proof. The convexity of Gz,λ is an immediate consequence of Lemma 2.7. To see the cone
property of Gz,λ, it is enough to show that Fλ is a cone with vertex at the origin. Fix any
(φ, u) ∈ Fλ and t ≥ 0, and observe that w := tu satisﬁes, at least in a formal level,

λw + Lαw = t(λu + Lαu) ≤ t(λu + Fφ[u] + φ) ≤ tφ(x, α)

for all (x, α) ∈ Tn × A, which can be stated as λ(tu) + Ftφ[tu] ≤ 0 in Tn. Thus, (tφ, tu) ∈
Fλ. This computation is easily justiﬁed in the viscosity sense and ensures that Fλ is a
cone with vertex at the origin.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

9

The closedness of Gz,λ is an easy consequence of that of Fλ. To see that Fλ is closed in
C(Tn × A) × C(Tn), we ﬁx any sequence {(φj, uj)}j∈N ⊂ Fλ and assume that (φj, uj) →
(φ, u) in C(Tn × A) × C(Tn) as j → ∞ for some (φ, u) ∈ C(Tn × A) × C(Tn). Noting that
Fφj → Fφ locally uniformly on Tn × Rn × Sn as j → ∞, we deduce, by the stability of
subsolutions under (locally) uniform convergence, that u is a subsolution of (DPφ), which
ensures that (φ, u) ∈ Fλ. Thus, we ﬁnd that Fλ is closed, which completes the proof. (cid:3)

Our choice of the term, the viscosity Mather measures, comes from the fact that the

stability property of viscosity solutions is crucial in establishing Lemma 2.8.

Let Gz,λ

′ denote the dual cone of Gz,λ, that is,

Gz,λ

′ := {µ ∈ R : hµ, f i ≥ 0 for all f ∈ Gz,λ}.

Theorem 2.9. Assume (F1), (F2) and (CP′). Assume, in addition, (Z) if λ = 0. Let
λ ≥ 0 and vλ ∈ C(Tn) be a solution of (DP). Then

(2.7)

λvλ(z) = min

µ∈P ∩ Gz,λ

L(x, α) µ(dxdα).

′ZTn×A

Notice that formula (2.2) can be seen as the special case of (2.7), with λ = 0. Thus,
the proof of Theorems 2.4 is included in that of Theorem 2.9 below. Note also that vλ is
unique for λ > 0, and is not unique in general for λ = 0.

Proof. We ﬁx (z, λ) ∈ Tn × [0, ∞). We note ﬁrst that (L, vλ) ∈ Fλ and observe by the
deﬁnition of Gz,λ

′ that for any µ ∈ P ∩ Gz,λ

′,

which yields

(2.8)

0 ≤ hµ, L − λvλ(z)i = hµ, Li − λvλ(z),

λvλ(z) ≤ inf

µ∈P ∩ Gz,λ

hµ, Li.

′

To show the reverse inequality, we argue by contradiction. The ﬁrst step is to suppose

that

and select ε > 0 so that

(2.9)

λvλ(z) <

inf

µ∈P ∩ Gz,λ

hµ, Li,

′

λvλ(z) + ε <

inf

µ∈P ∩ Gz,λ

hµ, Li.

′

Now, since Gz,λ is a closed convex cone with vertex at the origin, we deduce that

inf

f ∈Gz,λ

Accordingly, we get

hµ, f i =(0

if µ ∈ P ∩ Gz,λ
′.

−∞ if µ ∈ P \ Gz,λ

′

inf

µ∈P ∩ Gz,λ

′

hµ, Li = inf

µ∈P(cid:18)hµ, Li − inf

f ∈Gz,λ

hµ, f i(cid:19)

= inf
µ∈P

sup
f ∈Gz,λ

hµ, L − f i.

Observe that P is a compact convex subset of R, with topology of weak convergence
of measures, Gz,λ is a convex subset of C(Tn × A), the functional µ 7→ hµ, L − f i is
continuous and linear on R, again with topology of weak convergence of measures, for
any f ∈ C(Tn × A), and the functional f 7→ hµ, L − f i is continuous and aﬃne on

10

H. ISHII, H. MITAKE, H. V. TRAN

C(Tn × A) for any µ ∈ R, and then invoke Sion’s minimax theorem (see [21, Corollary
3.3] and also [22]), to ﬁnd that

Thus, we have

inf
µ∈P

sup
f ∈Gz,λ

hµ, L − f i = sup
f ∈Gz,λ

inf
µ∈P

hµ, L − f i.

inf

µ∈P ∩ Gz,λ

hµ, Li = sup
f ∈Gz,λ

′

inf
µ∈P

hµ, L − f i.

The above identity and (2.9) ensures that there is (φ, u) ∈ Fλ such that

λvλ(z) + ε < inf
µ∈P

hµ, L − φ + λu(z)i.

Since the Dirac measure δ(x,α) is in P for all (x, α) ∈ Tn × A, from the above, we get

λvλ(z) + ε < L(x, α) − φ(x, α) + λu(z)

for all (x, α) ∈ Tn × A,

which reads

F ≤ Fφ + λ(u − vλ)(z) − ε on Tn × Rn × Sn.

This implies that u satisﬁes

(2.10)

λu + F [u] ≤ λu + Fφ[u] + λ(u − vλ)(z) − ε ≤ λ(u − vλ)(z) − ε

in Tn.

If λ > 0, then we observe that u − (u − vλ)(z) + λ−1ε is a subsolution of (DP) and
use (CP′), to obtain u − (u − vλ)(z) + λ−1ε ≤ vλ on Tn, which, evaluated at z, gives a
contradiction, λ−1ε ≤ 0. If λ = 0, then, since u + C is a subsolution of (2.10) for any
C ∈ R, by Proposition 1.2 (ii), we get u + C ≤ vλ on Tn for all C ∈ R, which is a
contradiction.
(cid:3)

Deﬁnition 2.10 (Discounted Mather measure). For (z, λ) ∈ Tn × [0, ∞), let ML,z,λ be
the set of minimizers µ ∈ P ∩ Gz,λ

′ of the minimizing problem

min

µ∈P ∩ Gz,λ

′ZTn×A

L(x, α) µ(dxdα).

We call any µ ∈ ML,z,λ with z ∈ Tn and λ > 0 a discounted Mather measure.

Since P is sequentially compact in the weak topology of measures, it is easily seen that,
under the hypotheses of Theorem 2.9, ML,z,λ 6= ∅. Note that ML,z,0 is identical to ML,0
and does not depend on z.

2.3. Convergence with vanishing discount. We begin with two lemmas.

Lemma 2.11. Assume (F1), (F2), (CP′) and (Z). For each λ > 0, let vλ ∈ C(Tn) be
the unique solution of (DP). Then {vλ}λ>0 is uniformly bounded on Tn.

Proof. Let u ∈ C(Tn) be a solution of (EP), with c = 0. Observe that the functions
u + kukC(Tn) and u − kukC(Tn) are, respectively, a supersolution and a subsolution of
(DP), with any λ > 0, and, by the comparison principle, (CP′), that |vλ| ≤ 2kukC(Tn) on
Tn for all λ > 0. This completes the proof.
(cid:3)

Lemma 2.12. Let z ∈ Tn and {µj}j∈N ⊂ R be such that, as j → ∞, µj → µ weakly in
′ for all j ∈ N and for some
the sense of measure for some µ ∈ R and such that µj ∈ Gz,λj
{λj} ⊂ (0, ∞) converging to zero. Then µ ∈ G0

′.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

11

Proof. Let (φ, u) ∈ F0. Fix any j ∈ N, set φj := φ + λju ∈ C(Tn × A), and observe
that λju + Fφj [u] ≤ 0 in Tn in the viscosity sense. That is, we have (φj, u) ∈ Fλj . Since
µj ∈ Gz,λj

′, we get

0 ≤ hµj, φj − λju(z)i = hµj, φi + λjhµj, ui − λju(z).

Sending j → ∞ in the above yields hµ, φi ≥ 0. Thus, we see that µ ∈ G0

′.

(cid:3)

Proof of Theorem 2.1. By Proposition 1.3, problem (EP) has a solution (u, c) ∈ C(Tn) ×
R. Also, for each λ > 0, there exists a (unique) solution vλ ∈ C(Tn) of (DP).

We treat ﬁrst the case where c = 0. Let U be the set of accumulation points, as λ → 0,
in C(Tn) of {vλ}λ>0. By Lemma 2.11, (EC) and the Arzela-Ascoli theorem, we see that
the family {vλ}λ>0 is relatively compact in C(Tn) and, hence, U is non-empty.

Next, we show that U is a singleton by showing that

(2.11)

v ≥ w on Tn

for all v, w ∈ U.

To prove (2.11), we ﬁx any v, w ∈ U and z ∈ Tn, and choose sequences {λj}j∈N, {δj}j∈N ⊂
(0, 1), converging to zero as j → ∞, so that vλj → v and vδj → w in C(Tn) as j → ∞. By
Theorem 2.9, there exists a sequence {µj}j∈N ⊂ P such that µj ∈ ML,z,λj for all j ∈ N.

We may assume by passing to a subsequence of {µj} that for some µ, as j → ∞,
′, and, since
µj → µ weakly in the sense of measure. By Lemma 2.12, we have µ ∈ G0
λjvλj (z) = hµj, Li, we get, in the limit as j → ∞, hµ, Li = 0. Hence, we ﬁnd that
µ ∈ ML,0.

Noting that (L − δjvδj , vδj ) ∈ F0 and (L + λjw, w) ∈ Fλj and that µ ∈ ML,0 ⊂ G0

′ and

µj ∈ ML,z,glj ⊂ Gz,λj

′, we obtain

0 ≤ hµ, L − δjvδj i = −δjhµ, vδji,

and

Dividing the above inequalities by δj and λj, respectively, and sending j → ∞, we get

0 ≤ hµj, L + λjw − λjw(z)i = λj(cid:0)vλj (z) + hµj, wi − w(z)(cid:1) .

hµ, wi ≤ 0 and w(z) ≤ v(z) + hµ, wi.

These together yield w(z) ≤ v(z). Since z ∈ Tn is arbitrary, we conclude that (2.11) holds
and, hence, that U is a singleton. Now, it is easy to see that, as λ → 0+, vλ converges to
a unique element of U.

In the general case when c may not be zero, if u is a solution of (EP), then u is a solution
of FL+c[u] = 0 in Tn. Also, the function vλ + λ−1c is a solution of λu + FL+c[u] = 0 in Tn.
In view of this simple change of the unknown functions, we ﬁnd that (F1), (F2), (CP′)
and (EC) hold, with F replaced by FL+c. By applying the previous observation for the
case of c = 0, we conclude that

lim

λ→0+(cid:0)vλ + λ−1c(cid:1) = u in C(Tn)

for some u ∈ C(Tn) and u is a solution of (EP).

(cid:3)

3. Proof of Theorem 1.4

In this section we will give the proof of Theorem 1.4. Before going into the details,
we note that if our equation has the form of (F1) and A is compact, then the function
F (x, p, X) has at most linear growth in |p| and |X|. Therefore, the function F (x, p, X),
deﬁning our PDE, which has a higher order growth in |p| is not handled yet in Section 2.

12

H. ISHII, H. MITAKE, H. V. TRAN

More precisely, let us consider, for example, the equation

λu(x) − tr σt(x)σ(x)D2u(x) +

1
m

|Du(x)|m = f (x)

in Tn,

where m > 2, λ is a non-negative constant, σ ∈ Lip(Tn, Rk×n) for some k ∈ N, and
f ∈ C(Tn) is a given function. Since

if we set

F (x, p, X) := sup

m

1
m

m − 1

|p|m = max

q∈Rn(cid:18)−q · p −

m−1(cid:19) ,
q∈Rn(cid:18)− tr σt(x)σ(x)X − q · p − f (x) −

|q|

m

m − 1

m

|q|

m

m−1(cid:19) ,

then the equation above has the same form as (DP). Note that the control set A here is
Rn, which is not compact, and the functions b(x, q) = q and L(x, q) = f (x) + m−1
play the roles of those b and L in the previous sections, respectively. We will address
examples in more details in Section 4.

m |q|

m−1

m

In this section, we consider the general case where A may not be compact. We ﬁrst

notice that the function

Fφ(x, p, X) = sup
α∈A

(− tr a(x, α)X − b(x, α) · p − φ(x, α))

may neither be continuous nor well-deﬁned as a real-valued function in Tn × Rn × Sn for
some φ ∈ C(Tn × A). Therefore, we need to be careful in using the strategy in Section 2.
Fortunately, reviewing the arguments in the previous section carefully, we realize that
the cone Fλ can be replaced by a smaller convex cone. With this idea in mind, we
introduce Φ+ as the convex cone consisting of functions φ ∈ C(Tn × A) of the form

φ(x, α) = tL(x, α) + χ(x), with t > 0 and χ ∈ C(Tn),

and we observe that, for any φ ∈ Φ+, if φ = tL + χ, then

Fφ(x, p, X) = sup
α∈A
= t sup

(− tr a(x, α)X − b(x, α) · p − tL(x, α) − χ(x))

α∈A(cid:0)− tr a(x, α)t−1X − b(x, α) · t−1p − L(x, α)(cid:1) − χ(x)

= tF (x, t−1p, t−1X) − χ(x).

This shows that if F ∈ C(Tn × Rn × Sn), then
Fφ ∈ C(Tn × Rn × Sn)

for all φ ∈ Φ+.

In this section, the following hypothesis replaces the role of (CP′) in the previous

section.

(CP′′) 

The comparison principle holds for λu + F [u] = η, with η ∈ C(Tn). More
precisely, let λ > 0, η ∈ C(Tn), and U be any open subset of Tn. If v ∈
USC(U), w ∈ LSC(U) are a subsolution and a supersolution of λu+F [u] = η
in U, respectively, and v ≤ w on ∂U, then v ≤ w in U.

This is obviously a stronger assumption than (CP).

Lemma 3.1. Under (CP′′), the following comparison principle holds: Let λ > 0, η ∈
C(Tn), φ ∈ Φ+, and U be any open subset of Tn. If v ∈ USC(U), w ∈ LSC(U) are a
subsolution and a supersolution of λu + Fφ[u] = η in U, respectively, and v ≤ w on ∂U,
then v ≤ w in U.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

13

Proof. Let v ∈ USC(U), w ∈ LSC(U) be a subsolution and a supersolution of λu+Fφ[u] =
η in U, respectively, and let t > 0 and χ ∈ C(Tn) be such that φ = tL + χ. Thanks to the
above observation, Fφ(x, p, X) = tF (x, t−1p, t−1X) − χ(x), the functions v/t and w/t are
a subsolution and a supersolution of λu + F [u] = t−1(χ + η) in U, respectively. Obviously,
we have v/t ≤ w/t on ∂Ω. Hence, by (CP′′), we get v/t ≤ w/t in U. That is, we have
v ≤ w in U.
(cid:3)

Now, for z ∈ Tn and λ ≥ 0, we deﬁne the sets Fλ ⊂ Φ+ × C(Tn), Gλ ⊂ C(Tn × A),

respectively, by

Fλ := {(φ, u) ∈ Φ+ × C(Tn) : u is a subsolution of (DPφ)},
Gz,λ := {φ − λu(z) : (φ, u) ∈ F λ for some u ∈ C(Tn)}

as in Section 2, where F λ denotes the closure of Fλ in the space C(Tn × A) × C(Tn).
Since the set Gz,0 are independent of z, we write also G0 for Gz,0. We note that we use
here the same notation in Section 2 by abuse of notation, although the symbols F0 and
Gz,λ denote the sets of functions diﬀerent from those deﬁned in Section 2.

Lemma 3.2. Assume (F1), (F2) and (CP′′). For any (z, λ) ∈ Tn × [0, ∞), the set Gz,λ
is a closed convex cone with vertex at the origin.

We can prove Lemma 3.2 in a similar way to that of Lemma 2.8, so we omit the proof.
It is however important pointing out that in general (0, 0) /∈ Fλ but (0, 0) ∈ F λ, since
(tL, tvλ) ∈ Fλ for all t > 0. This yields that 0 ∈ Gz,λ.

Let RL denote the space of all Radon measures µ on Tn ×A such that h|µ|, 1+|L|i < ∞,
where |µ| denotes the total variation of µ, and, for any Borel subset K of A, let PK denote
the subset of all probability measures µ in RL that have support in Tn × K. That is,
PK = {µ : µ is a Radon probability measure on Tn × A, µ(Tn × K) = 1}.
′ ⊂ RL (denoted also by G0

For (z, λ) ∈ Tn × [0, ∞), we deﬁne the set Gz,λ

′ if λ = 0) by

Gz,λ

′ := {µ ∈ RL : hµ, f i ≥ 0 for all f ∈ Gz,λ},

and a key ingredient for our proof of Theorem 1.4 is stated as follows.

Theorem 3.3. Assume (F1), (F2), (L), (CP′′), (EP), and, if λ = 0, (Z) as well. Let
(z, λ) ∈ Tn × [0, ∞) and vλ be a solution of (DP). Let K0 be the compact set given by
(L). If K is a Borel subset of A such that either K ) K0 or K = A, then

(3.1)

λvλ(z) =

inf

µ∈PK ∩ Gz,λ

L(x, α)µ(dxdα).

′ZTn×A

In the theorem above, it is always possible to choose a compact set K ⊂ A so that either
K = A or K ) K0. Indeed, if A is compact, we may just choose K = A. Otherwise, we
may choose α1 ∈ A \ K0 and set K := K0 ∪ {α1}. Clearly, K is compact and satisﬁes
K ) K0.

A natural question is whether it is possible or not to replace K by K0 in formula (3.1).
For instance, if A is connected, then (3.1) holds with K0 in place of K. (See Remark 3.1)
In the general situation where normalization (Z) is dropped, we have the following

formula for the critical value c.

Corollary 3.4. Assume (F1), (F2), (L), (CP′′), and that (EC) has a solution (u, c) ∈
C(Tn) × R. Let K0 be the compact subset of A from (L). Then, for any Borel set K ⊂ A

14

H. ISHII, H. MITAKE, H. V. TRAN

such that either K ) K0 or K = A, we have

(3.2)

c = − inf

µ∈PK ∩ G0

L(x, α)µ(dxdα).

Conceding Theorem 3.3, we give a proof of Corollary 3.4.

′ZTn×A

Proof. Set Lc := L + c and note that FLc = F − c and u is a solution of (EPφ), with
φ = Lc. Note that hypotheses (F1), (F2), (L) and (CP′′) hold, with (F, L) replaced by
(F − c, Lc). Concerning (L), we note that the inequality

implies

inf

Tn×(A\K0)

L ≥ L0 = max
Tn

inf
α∈K0

L(x, α)

inf

Tn×(A\K0)

Lc ≥ L0 + c = max
Tn

inf
α∈K0

Lc(x, α).

Fix any Borel subset K of A such that K ) K0. Observe that, if we set Φ+

L := Φ, then

Φ+

L = {tL + χ : t > 0, χ ∈ C(Tn)} = {tLc + χ : t > 0, χ ∈ C(Tn)} = Φ+
Lc,

and, similarly, that RL = RLc. The deﬁnitions of F0, G0, G0
through Φ+ and RL, which assures that F0, G0, G0
Thus, we ﬁnd from Theorem 3.3 that

′, and PK depend on L only
′, and PK are the same as those for Lc.

0 = inf

µ∈PK ∩G

′

0

hµ, Lci,

which shows (3.2).

The next lemma is similar to Lemma 2.12.

(cid:3)

Lemma 3.5. Let K be a compact subset of A and {µj}j∈N ⊂ PK. Then there exists a
subsequence {µjk}k∈N of {µj}j∈N that converges to some µ ∈ PK weakly in the sense of
′
measure as k → ∞ such that hµjk, Li → hµ, Li as k → ∞. Furthermore, if µj ∈ Gz,λj
for all j ∈ N and some z ∈ Tn and {λj}j∈N ⊂ [0, ∞) and if λj → λ as j → ∞ for some
λ ∈ [0, ∞), then µ ∈ Gz,λ
Proof. Due to the obvious tightness of {µj}j∈N, there exists its subsequence {µjk}k∈N that
converges, weakly in the sense of measure, to a Radon probability measure µ on Tn × A.
It is clear that µ ∈ PK.

′.

Observe next that, for any η ∈ Cc(A) such that η = 1 on K,

hµjk, Li = hµjk, ηLi → hµ, ηLi = hµ, Li as k → ∞.

Now, we ﬁx z ∈ Tn and {λj}j∈N ⊂ [0, ∞), and assume that λj → λ as j → ∞ for
′ for all j ∈ N. Let (tL + χ, u) ∈ Fλ, where t > 0 and

some λ ∈ R and that µj ∈ Gz,λj
χ ∈ C(Tn), and observe that (tL + χ + (λj − λ)u, u) ∈ Fλj for all j ∈ N.

Since µjk ∈ Gz,λjk

′ and (tL + χ + (λjk − λ)u, u) ∈ Fλjk
hµjk, tL + χ + (λjk − λ)u − λjku(z)i ≥ 0

, we get

(3.3)
We have already seen that hµjk, Li → hµ, Li as k → ∞. Also, since the functions χ+(λjk −
λ)u are bounded and continuous as a function on Tn × A and converge to χ uniformly on
Tn × A, we see that, as k → ∞,

for all k ∈ N.

hµjk, χ + (λjk − λ)ui → hµ, χi.

Hence, we ﬁnd from (3.3), in the limit as k → ∞, that hµ, tL + χ − λu(z)i ≥ 0, which
implies that µ ∈ Gz,λ

′.

The proof is now complete.

(cid:3)

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

15

By Lemma 3.5, the set PK ∩ Gz,λ

′ is compact for any compact set K ⊂ A, and, under
the hypotheses of Theorem 3.3, according to Theorem 3.3 and the consecutive remark, if
′
the compact set K ⊂ A is large enough in the sense of inclusion, then the set PK ∩ Gz,λ
is non-empty and the functional

PK ∩ Gz,λ

L(x, α)µ(dxdα)

′ ∋ µ 7→ZTn×A

has a minimizer achieving the minimum value λvλ(z). With an abuse of notation, we
denote the set of such minimizers again by ML,z,λ or, if λ = 0, by ML,0. We call any
µ ∈ ML,0 (resp., µ ∈ ML,z,λ if λ > 0) a viscosity Mather measure (resp., a discounted
Mather measure) associated with (DP). We point out that ML,0 and ML,z,λ may depend
on our choice of Φ+ a priori. The authors do not know whether these are independent of
the choice of Φ+ or not.

Proof of Theorem 3.3. Since (L, vλ) ∈ Fλ, for any µ ∈ PA ∩ Gz,λ

′, we have

0 ≤ hµ, L − λvλ(z)i = hµ, Li − λvλ(z),

and, consequently,

(3.4)

λvλ(z) ≤

inf

µ∈PA ∩ Gz,λ

hµ, Li.

′

Next, to prove (3.1), we ﬁx any Borel set K ⊂ A such that either K = A or K ) K0,

and show

(3.5)

λvλ(z) ≥

inf

µ∈PK ∩ Gz,λ

hµ, Li,

′

which, together with (3.4), yields (3.1).

We set K1 = A if K0 = A. Otherwise, we ﬁx a point α1 ∈ K \ K0 and set K1 =

K0 ∪ {α1}. Notice that K1 is a compact set and K1 ⊂ K.

To show (3.5), it is enough to prove

(3.6)

λvλ(z) ≥

inf

µ∈PK1 ∩ Gz,λ

We argue by contradiction, suppose that

λvλ(z) <

inf

µ∈PK1 ∩ Gz,λ

hµ, Li.

hµ, Li,

′

′

select ε > 0 so that

(3.7)

λvλ(z) + ε <

inf

µ∈PK1 ∩ Gz,λ

hµ, Li,

′

and will get a contradiction.

We note by the cone property of Gz,λ (Lemma 3.2) that

inf

f ∈Gz,λ

and, moreover, that

inf

µ∈PK1 ∩ Gz,λ

′

hµ, Li = inf

hµ, f i =(0
µ∈PK1(cid:18)hµ, Li − inf

f ∈Gz,λ

if µ ∈ PK1 ∩ Gz,λ
′,

−∞ if µ ∈ PK1 \ Gz,λ

′,

hµ, f i(cid:19) = inf

µ∈PK1

hµ, L − f i.

sup
f ∈Gz,λ

16

H. ISHII, H. MITAKE, H. V. TRAN

Noting by Lemma 3.5 that PK1 is a convex compact space, we apply Sion’s minimax
theorem, to get

Hence, we have

inf

µ∈PK1

sup
f ∈Gz,λ

hµ, L − f i = sup
f ∈Gz,λ

inf

µ∈PK1

hµ, L − f i.

inf

µ∈PK1 ∩ Gz,λ

hµ, Li = sup
f ∈Gz,λ

′

inf

µ∈PK1

hµ, L − f i.

Combining the above with (3.7) yields

(3.8)

λvλ(z) + ε < sup
f ∈Gz,λ

inf

µ∈PK1

hµ, L − f i.

Hence, we may choose (φ, u) ∈ Fλ such that

(3.9)
and, moreover, t > 0 and χ ∈ C(Tn) so that φ = tL + χ.

λvλ(z) + ε < hµ, L − φ + λu(z)i

for all µ ∈ PK1,

We show that we can choose a constant θ > 0 such that w := θu is a subsolution of

λw + F [w] = λ(w − vλ)(z) − θε

(3.10)
Once this is done, we easily get a contradiction. Indeed, if λ > 0, then ζ := w + λ(vλ −
w)(z) + λ−1θε is a subsolution of λζ + F [ζ] = 0 in Tn and comparison principle (CP′′)
yields ζ ≤ vλ in Tn, which, after evaluation at z, gives λ−1θε ≤ 0. This is a contradiction.
On the other hand, if λ = 0, then, by Proposition 1.2 (ii), we get w + C ≤ vλ in Tn for
all C ∈ R, which is a contradiction.

in Tn.

To show (3.10), we divide our argument into two cases. The ﬁrst case is that when

K1 = A. Then, we have δ(x,α) ∈ PK1 for all (x, α) ∈ Tn × A, and, from (3.8), we get

λvλ(z) + ε < L − φ + λu(z) on Tn × A,

which yields

F (x, p, X) ≤ Fφ(x, p, X) + λ(u − vλ)(z) − ε

for all (x, p, X) ∈ Tn × Rn × Sn.

Thus, we see that w := u is a subsolution of (3.10), with θ = 1.

The second case is that when K1 = K0 ∪ {α1} for some α1 ∈ K \ K0. By assumption

(L), we have

(3.11)

Tn×(A\K0)
Since δ(x,α) ∈ PK1 for all (x, α) ∈ Tn × K1, from (3.9), we get

max
x∈Tn

min
α∈K0

L(x, α) =: L0 ≤

inf

L.

(3.12)

(t − 1)L(x, α) + χ(x) < λ(u − vλ)(z) − ε

for all (x, α) ∈ Tn × K1.

We split our further argument into two cases. Consider ﬁrst the case when t ≤ 1, and,

maximizing the both sides of (3.12) in α ∈ K0 yields

(t − 1) min
α∈K0

L(x, α) + χ(x) < λ(u − vλ)(z) − ε

for all x ∈ Tn,

and, furthermore,

for all x ∈ Tn.
Combining this with (3.11), we ﬁnd that for all (x, α) ∈ Tn × (A \ K0),

(t − 1)L0 + χ(x) < λ(u − vλ)(z) − ε

(t − 1)L(x, α) + χ(x) ≤ (t − 1)L0 + χ(x) < λ(u − vλ)(z) − ε,

which shows, together with (3.12), that

(t − 1)L(x, α) + χ(x) < λ(u − vλ)(z) − ε

for all (x, α) ∈ Tn × A.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

17

Hence, we get

φ = L + (t − 1)L + χ < L + λ(u − vλ)(z) − ε on Tn × A,

and ﬁnd that w := u is a subsolution of (3.10), with θ = 1. Notice that the choice of α1
is of no use so far.

Secondly, we consider the case when t > 1 and observe by the viscosity property of vλ

that, for any maximum point x0 ∈ Tn of vλ, which always exists, we have

0 ≥ λvλ(x0) + F (x0, 0, 0) = λvλ(x0) + sup
α∈A

(−L(x0, α))

≥ λvλ(x0) − max
x∈Tn

inf
α∈A

L(x, α) ≥ λvλ(x0) − L0,

and, hence,

(3.13)

By (3.11) and (3.12), we have

λvλ(z) ≤ λvλ(x0) ≤ L0.

L(x, α1) ≥ L0

and (t − 1)L(x, α1) + χ(x) < λ(u − vλ)(z) − ε

for all x ∈ Tn,

which shows that

(t − 1)L0 + χ(x) < λ(u − vλ)(z) − ε

for all x ∈ Tn.

Hence, using (3.13), we get

(t − 1)λvλ(z) + χ ≤ (t − 1)L0 + χ < λ(u − vλ)(z) − ε,

which yields

and moreover

χ < −tλvλ(z) + λu(z) − ε on Tn,

φ = tL + χ < tL + tλ(u/t − vλ)(z) − ε

in Tn × A.

Thus, we get formally

λu + Lαu ≤ φ < tL + tλ(u/t − vλ)(z) − ε

in Tn × A.

From this, we deduce that w := u/t is a subsolution of (3.10), with θ = 1/t. This
completes the proof.
(cid:3)

Remark 3.1. In the proof above, the real requirement on the choice of α1 is that the
inequality L(x, α1) ≥ L0 should hold for all x ∈ Tn. A trivial suﬃcient condition for this
is the condition that α1 ∈ K \ K0. If there exists α1 ∈ K0 such that L(x, α1) ≥ L0 for
all x ∈ Tn, then we can perform the proof above, with K1 = K0 ∪ {α1} = K0, which
yields formula (3.1) with K0 in place of K. For instance, if A is connected, then (L)
guarantees the existence of such α1 ∈ K0. To see this, one deﬁnes the continuous function
l on A by setting l(α) = minx∈Tn L(x, α) and observes that l(A) is an interval of R,
l(A \ K0) ⊂ [L0, ∞) and l(K0) is compact, which is impossible if l(K0) ⊂ (−∞, L0).

The following proof of Theorem 1.4 is parallel to that of Theorem 2.1, but we still give

it here for the reader’s convenience.

Proof of Theorem 1.4. Let (u0, c) ∈ C(Tn) × R be a solution of (EP). The existence of
such a solution and the uniqueness of the critical value c is assured by Proposition 1.3.

As we have seen in the proof of Theorem 2.1, the proof in the general case regarding c
is easily reduced to the special case when c = 0. Henceforth, we are thus only concerned
with the case when c = 0.

18

H. ISHII, H. MITAKE, H. V. TRAN

As in the proof of Theorem 2.1, we see that |vλ| ≤ 2ku0kC(Tn) on Tn for all λ > 0. This
together with (EC) guarantees that {vλ}λ>0 is relatively compact in C(Tn). Therefore, it
is enough to show that

(3.14)

lim sup
λ→0+

vλ(x) = lim inf
λ→0+

vλ(x)

for all x ∈ Tn.

To check the above convergence, we ﬁx any z ∈ Tn and select two sequences {λj}j∈N ⊂

(0, 1) and {δj}j∈N ⊂ (0, 1), converging to zero, so that

lim inf
λ→0+

vλ(z) = lim
j→∞

vλj (z)

and

lim sup
λ→0+

vλ(z) = lim
j→∞

vδj (z).

By passing to subsequences if needed, we may assume that for some v, w ∈ C(Tn),

vλj = v

and

lim
j→∞

lim
j→∞

vδj = w in C(Tn).

Fix z ∈ Tn, and, for each j ∈ N, thanks to Theorem 3.3, we choose a discounted Mather
measure µj ∈ ML,z,λj, so that hµj, Li = λjvλj (z). We may assume that {µj}j∈N ⊂ PK for
some compact set K ⊂ A. We deduce by Lemma 3.5 that we may assume, after passing
to a subsequence if necessary, that {µj} converges to some µ ∈ ML,0.

By the stability property of the viscosity solutions under uniform convergence, w is a
solution of F [u] = 0 in Tn. Hence, we ﬁnd that (L−δj vδj , vδj ) ∈ F0 and (L+λjw, w) ∈ Fλj ,
and, consequently, we get

0 ≤ hµ, L − δjvδj i = −δjhµ, vδji,

and

0 ≤ hµj, L + λjw − λjw(z)i = λj(vλj − w)(z) + λjhµj, wi.

From these, we get, in the limit as j → ∞,

hµ, wi ≤ 0 and 0 ≤ (v − w)(z) + hµ, wi,

which yields w(z) ≤ v(z), Since z ∈ Tn is arbitrary, we get w ≤ v in Tn. This shows that
(3.14) holds.
(cid:3)

4. Examples

Theorems 2.1 and 1.4 can be applied under the structure conditions given in [3, 6, 7].

Let us give some representative examples here.

4.1. First order Hamilton-Jacobi equations with linear growth in the gradient
variable. Consider the case that

F (x, p, X) := max
|α|≤1

{−c(x)α · p − L(x, α)},

where A = B(0, 1), c ∈ C(Tn) with c > 0, and L(x, α) ∈ C(Tn × A). Then (DP), (EP)
are ﬁrst order Hamilton-Jacobi equations with linear growth which arises in the context
of front propagations, crystal growth, and optimal control problems. We can easily check
that (F1)–(F3), (CP′), (EC) hold, and so the conclusion of Theorem 2.1 is valid in this
case.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

19

4.2. Viscous Hamilton-Jacobi equations with superlinear growth in the gradi-
ent variable. Consider the function F of the form

F (x, p, X) := − tr σt(x)σ(x)X + H(x, p)

where σ ∈ Lip(Tn, Rk×n) for some k ∈ N and the Hamiltonian H : Tn × Rn → R satisﬁes

• p 7→ H(x, p) is convex for all x ∈ Tn,
• there exist m > 1 and Λ ≥ 1 such that, for every x, y ∈ Tn and p, q ∈ Rn,

(4.1)

(4.2)

(4.3)

|p|m − Λ ≤ H(x, p) ≤ Λ(|p|m + 1),

1
Λ
|H(x, p) − H(y, p)| ≤ Λ(|p|m + 1)|x − y|,
|H(x, p) − H(x, q)| ≤ Λ(|p| + |q| + 1)m−1|p − q|.

Let L(x, q) be the Legendre transform of H(x, p), i.e., L(x, q) := supp∈Rn{p · q − H(x, p)}.
We can rewrite F as

F (x, p, X) = sup

q∈Rn(cid:0)− tr σt(x)σ(x)X − q · p − L(x, q)(cid:1) .

Note that this general situation includes ﬁrst-order Hamilton-Jacobi equations with su-
perlinear growth (the case where σ ≡ 0).

It is clear that F satisﬁes (L) because of assumption (4.1) with m > 1. The comparison
principle (CP′′) holds in light of [3, Theorem 2.1]. Assumption (EC) holds thanks to
[3, Theorem 3.1]. In fact, we have further that {vλ}λ>0 is equi-Lipschitz continuous with
Lipschitz constant dependent only on Λ, Lip(σ), kH(·, 0)kC(Tn) (see also [6]). It is worth
mentioning that (4.2) is a bit more general than the classical condition (3.14) in [7]. For
example, if H(x, p) = c(x)|p|2 with c ∈ Lip(Tn) and c > 0, then (4.1)–(4.3) hold, but not
(3.14) in [7].

4.3. Fully nonlinear, uniformly elliptic equations with linear growth in the
gradient variable. Assume A is compact and

F (x, p, X) := max
α∈A

(− tr a(x, α)X − b(x, α) · p − L(x, α)) ,

where a ∈ Lip(Tn × A, Sn), b ∈ Lip(Tn × A, Rn), L ∈ C(Tn × A, R). We assume further
that there exists θ > 0 such that

1
θ

I ≤ a(x, α) ≤ θI

for all (x, α) ∈ Tn × A.

Here, I denotes the identity matrix of size n.

Clearly (F1)–(F3) hold. Comparison, (CP′), is a consequence of [13, Theorem III.1 (1)].
The Lipschitz continuity of a and b is assumed as a suﬃcient condition that (CP′) holds.
This Lipschitz continuity assumption on a and b can be replaced by a weaker assumption
as in [13, Theorem III.1 (1)].

In view of the Krylov-Safonov estimate (see [16]and also [5,23]), we have that {vλ}λ>0 is
equi-H¨older continuous, which implies (EC). Here are some details on this H¨older estimate.
According to Proposition 1.2 (i), there exists a constant M0 > 0 such that λ|vλ| ≤ M0 on
Tn, which implies that vλ satisﬁes, in the viscosity sense,

F [vλ] ≤ M0

and

F [vλ] ≥ −M0

in Tn.

20

H. ISHII, H. MITAKE, H. V. TRAN

According to [23, (2.14)], there exist constants γ ∈ (0, 1) and C > 0, depending only on
n, θ and kbkC(Tn×A), such that

(4.4)

osc

Bτ R(x)

vλ ≤ Cτ γ(cid:18) osc

BR(x)

vλ + θM0R2(cid:19) for all τ ∈ (0, 1), x ∈ Rn and R > 0,

where vλ is regarded as a periodic function on Rn and oscBr(x) vλ := supBr(x) vλ −
inf Br(x) vλ. We select τ0 ∈ (0, 1) so small that Cτ γ
2, then select R0 > 0 so large
that [− 1

2]n ⊂ Bτ0R0, and note that

0 ≤ 1

2 , 1

osc
Tn

vλ = osc
Bτ0R0

vλ = osc
BR0

vλ,

to ﬁnd from (4.4) that

and hence

Thus, (4.4) yields

vλ ≤

osc
Tn

1

2(cid:16)osc

Tn

vλ + θM0R2

0(cid:17)

vλ ≤ θM0R2
0.

osc
Tn

osc

Bτ R0 (x)

vλ ≤ C1τ γ

for all τ ∈ (0, 1) and x ∈ Rn,

where C1 := 2CθM0R2

0, which shows that {vλ}λ>0 is equi-H¨older continuous on Tn.

Owing to the Evans-Krylov theorem (see [11, 15]), if F is locally H¨older continuous on
Tn × Rn × Sn, then (DP) has a unique classical solution. This allows us to formulate
“Mather measures” based on classical solutions (see also [12]). For instance, we may
replace F0 of Section 2 by

{(φ, u) ∈ C(Tn × A) × C 2(Tn) : u is a subsolution of (EPφ)}.

We leave a further discussion of this approach to the interested readers.

4.4. Fully nonlinear equations with superquadratic growth in the gradient vari-
able. Assume that F has the form

F (x, p, X) := sup

q∈Rn(cid:0)− tr σt(x, q)σ(x, q)X − q · p − L(x, q)(cid:1)

and

• there exist m > 2 and Λ > 0 such that, for every x ∈ Tn, p ∈ Rn and X ∈ Sn,

F (x, p, X) ≥

1
Λ

|p|m − Λ(|X| + 1),

• the structural condition [7, (3.14)] holds, that is, there exists a modulus of conti-

nuity ω : [0, ∞) → [0, ∞] satisfying ω(0+) = 0 such that

F (y, α(x − y), Y ) − F (x, α(x − y), X) ≤ ω(α|x − y|2 + |x − y|)
whenever x, y ∈ Tn, α > 0, X, Y ∈ Sn, and

−3α(cid:18) I 0

0 I (cid:19) ≤(cid:18) X 0

0 −Y (cid:19) ≤ 3α(cid:18) I −I
I (cid:19) .

−I



THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

21

Since m > 2, (L) holds true. The comparison principle (CP′′) follows from the comparison
principle in [7]. The family {vλ}λ>0 is equi-H¨older continuous with H¨older exponent
γ = m−2

m−1 in view of [6, Theorem 1.1], [3, Lemma 3.2].

We refer the reader to [7, Example 3.6] for some further examples of F satisfying
(3.14) there. Let us also point out that, because of the a priori γ-H¨older estimates for
subsolutions, we can relax [7, (3.14)] a bit more. More precise, we can replace it by
[7, (5.1)], that is, there exist a modulus of continuity ω : [0, ∞) → [0, ∞] satisfying
ω(0+) = 0 and some θ > 2 − γ such that

F (y, α(x − y), Y ) − F (x, α(x − y), X) ≤ ω(α|x − y|θ + |x − y|)
whenever x, y ∈ Tn, α > 0, X, Y ∈ Sn, and



−3α(cid:18) I 0

0 I (cid:19) ≤(cid:18) X 0

0 −Y (cid:19) ≤ 3α(cid:18) I −I
I (cid:19) .

−I

Appendix

We here provide proofs of Propositions 1.2 and 1.3 in Introduction.

Proof of Proposition 1.2. (i) We set M0 = maxx∈Tn |F (x, 0, 0)|, observe that the constant
functions M0/λ and −M0/λ are a supersolution and a subsolution of (DP), and apply the
Perron method, to ﬁnd a solution vλ of (DP) which satisﬁes |vλ| ≤ M0/λ on Tn. Here, by
solution, we mean that the upper semicontinuous envelope (vλ)∗ and the lower semicon-
tinuous envelope (vλ)∗ of vλ are a subsolution and a supersolution of (DP), respectively.
Then, by the comparison principle, (CP), we get (vλ)∗ ≤ (vλ)∗ on Tn, which implies
that vλ ∈ C(Tn). The uniqueness of solutions of (DP) in C(Tn) is also an immediate
consequence of (CP). Clearly we have λ|vλ| ≤ M0 for all λ > 0.

(ii) Assume that c1 < c2 and v ≤ w on ∂U, set c = (c1 + c2)/2, and choose δ > 0 small
enough so that v and w are a subsolution and a supersolution of δu + F [u] = c in U,
respectively. Then, we observe that the functions v − δ−1c and w − δ−1c are a subsolution
and a supersolution of δu + F [u] = 0 in U, respectively, and we use (CP) to deduce that
v ≤ w in U.
(cid:3)

Proof of Proposition 1.3. The existence and uniqueness of vλ ∈ C(Tn) has already been
established in Proposition 1.2 (i). Moreover, we have λ|vλ| ≤ M0 on Tn for all λ > 0 and
for M0 = maxx∈Tn |F (x, 0, 0)|.

Now, we set mλ := minTn vλ and uλ := vλ − mλ and note by assumption (EC) that
the family {uλ}λ>0 is equi-continuous and uniformly bounded on Tn. The Arzela-Ascoli
theorem assures that there is a sequence {λj}j∈N of positive numbers converging to 0 such
that uλj → u in C(Tn) as j → ∞ for some u ∈ C(Tn). Since λ|vλ| ≤ M0 for all λ > 0,
the sequence {λjmλj }j∈N ⊂ R is bounded and, hence, has a convergent subsequence.
Replacing {λj}j∈N by such a subsequence, there exists a constant c ∈ R such that

lim
j→∞

λjmλj = −c.

Noting that uλ is a solution of λuλ + F [uλ] = −λmλ in Tn, we deduce by the stability
of viscosity properties under uniform convergence that u is a solution of F [u] = c in Tn.
That is, (u, c) is a solution of (EP).

To see the uniqueness of critical value for (EP), let (v, d), (w, e) ∈ C(Tn) × R be two
solutions of (EP), suppose that d 6= e and get a contradiction. We may assume without
loss of generality that d < e. Noting that, for any constant C ∈ R, (v + C, d) is a solution

22

H. ISHII, H. MITAKE, H. V. TRAN

of (EP) and applying Proposition 1.2 (ii), we see that v + C ≤ w on Tn for all C ∈ R.
This is a contradiction, which shows that the critical value c for (EP) is unique.

What remains is to show (1.1). By the equi-continuity, (EP), we infer that

sup

λ>0(cid:16)max

Tn

vλ − min
Tn

vλ(cid:17) < ∞.

lim
j→∞

λj max
Tn

vλj = lim
j→∞

λjmλj = −c.

c = − lim
j→∞

λjvλj (x)

in C(Tn).

Consequently,

Thus we ﬁnd that

Arguing as above, we see that every sequence {δj}j∈N of positive numbers convergent
to 0 has a subsequence, which we denote again by the same symbol, a constant d ∈ R
and a function w ∈ C(Tn) such that

d = − lim
j→∞

δjvδj

in C(Tn),

w = lim

j→∞(cid:16)vδj − min

Tn

vδj(cid:17) in C(Tn),

and (w, d) is a solution of (EP). Here, because of the uniqueness of the critical value c,
we ﬁnd that d = c. We now easily deduce that (1.1) holds, and the proof is complete. (cid:3)

References

[1] E. S. Al-Aidarous, E. O. Alzahrani, H. Ishii, and A. M. M. Younas, A convergence result for the
ergodic problem for Hamilton-Jacobi equations with Neumann-type boundary conditions, Proc. Royal
Soc. Edinburgh 146A (2016), 1-18 (2016).

[2] Scott N. Armstrong, The Dirichlet problem for the Bellman equation at resonance, J. Diﬀerential

Equations 247 (2009), no. 3, 931–955.

[3] S. N. Armstrong and H. V. Tran, Viscosity solutions of general viscous Hamilton-Jacobi equations,

Math. Ann. 361 (2015), no. 3-4, 647–687.

[4] M. Bardi and I. Capuzzo-Dolcetta, Optimal control and viscosity solutions of Hamilton-Jacobi-
Bellman equations, Systems & Control: Foundations & Applications, Birkh¨auser Boston, Inc.,
Boston, MA, 1997. With appendices by Maurizio Falcone and Pierpaolo Soravia.

[5] Luis A. Caﬀarelli, Interior a priori estimates for solutions of fully nonlinear equations, Ann. of Math.

(2) 130 (1989), no. 1, 189–213.

[6] I. Capuzzo-Dolcetta, F. Leoni, and A. Porretta, H¨older estimates for degenerate elliptic equations

with coercive Hamiltonians, Trans. Amer. Math. Soc. 362 (2010), no. 9, 4511–4536.

[7] M. G. Crandall, H. Ishii, and P.-L. Lions, User’s guide to viscosity solutions of second order partial

diﬀerential equations, Bull. Amer. Math. Soc. (N.S.) 27 (1992), no. 1, 1–67.

[8] A. Davini, A. Fathi, R. Iturriaga, and M. Zavidovique, Convergence of the solutions of the discounted

equation, (Preprint is available in arXiv:1408.6712).

[9] Monroe D. Donsker and S. R. S. Varadhan, On a variational formula for the principal eigenvalue

for operators with maximum principle, Proc. Nat. Acad. Sci. U.S.A. 72 (1975), 780–783.

[10] M. D. Donsker and S. R. S. Varadhan, On the principal eigenvalue of second-order elliptic diﬀerential

operators, Comm. Pure Appl. Math. 29 (1976), no. 6, 595–621.

[11] Lawrence C. Evans, Classical solutions of fully nonlinear, convex, second-order elliptic equations,

Comm. Pure Appl. Math. 35 (1982), no. 3, 333–363.

[12] D. A. Gomes, Duality principles for fully nonlinear elliptic equations, Trends in partial diﬀer-
ential equations of mathematical physics, Progr. Nonlinear Diﬀerential Equations Appl., vol. 61,
Birkh¨auser, Basel, 2005, pp. 125–136.

[13] H. Ishii and P.-L. Lions, Viscosity solutions of fully nonlinear second-order elliptic partial diﬀerential

equations, J. Diﬀerential Equations 83 (1990), no. 1, 26–78.

[14] H. Ishii, H. Mitake, and H. V. Tran, work in progress.

THE VANISHING DISCOUNT PROBLEM AND VISCOSITY MATHER MEASURES. PART 1

23

[15] N. V. Krylov, Boundedly inhomogeneous elliptic and parabolic equations, Izv. Akad. Nauk SSSR Ser.

Mat. 46 (1982), no. 3, 487–523, 670 (Russian).

[16] N. V. Krylov and M. V. Safonov, An estimate for the probability of a diﬀusion process hitting a set

of positive measure, Dokl. Akad. Nauk SSSR 245 (1979), no. 1, 18–20 (Russian).

[17] P.-L. Lions, G. Papanicolaou, and S. R. S. Varadhan, Homogenization of Hamilton–Jacobi equations,

unpublished work (1987).

[18] R. Ma˜n´e, Generic properties and problems of minimizing measures of Lagrangian systems, Nonlin-

earity 9 (1996), no. 2, 273–310.

[19] J. N. Mather, Action minimizing invariant measures for positive deﬁnite Lagrangian systems, Math.

Z. 207 (1991), no. 2, 169–207.

[20] H. Mitake and H. V. Tran, Selection problems for a discounted degenerate viscous Hamilton–Jacobi

equation, submitted, (Preprint is available in arXiv:1408.2909).

[21] M. Sion, On general minimax theorems, Paciﬁc J. Math. 8 (1958), 171–176.
[22] F. Terkelsen, Some minimax theorems, Math. Scand. 31 (1972), 405–413 (1973).
[23] Neil S. Trudinger, On regularity and existence of viscosity solutions of nonlinear second order, elliptic
equations, Partial diﬀerential equations and the calculus of variations, Vol. II, Progr. Nonlinear
Diﬀerential Equations Appl., vol. 2, Birkh¨auser Boston, Boston, MA, 1989, pp. 939–957.

(H. Ishii) Faculty of education and Integrated Arts and Sciences, Waseda University

1-6-1 Nishi-Waseda, Shinjuku, Tokyo 169-8050 Japan

E-mail address: hitoshi.ishii@waseda.jp

(H. Mitake) Institute for Sustainable Sciences and Development, Hiroshima University

1-4-1 Kagamiyama, Higashi-Hiroshima-shi 739-8527, Japan

E-mail address: hiroyoshi-mitake@hiroshima-u.ac.jp

(H. V. Tran) Department of Mathematics, 480 Lincoln Dr, Madison, WI 53706, USA
E-mail address: hung@math.wisc.edu

