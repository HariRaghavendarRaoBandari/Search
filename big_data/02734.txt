IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

1

Codebook Design for Millimeter-Wave Channel

Estimation with Hybrid Precoding Structure

Zhenyu Xiao, Member, IEEE, Pengfei Xia, Senior Member, IEEE, and Xiang-Gen Xia, Fellow, IEEE

6
1
0
2

 
r
a

M
8

 

 
 
]
T
I
.
s
c
[
 
 

1
v
4
3
7
2
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—In this paper, we study hierarchical codebook design
for channel estimation in millimeter-wave (mmWave) communi-
cations with a hybrid precoding structure. Due to the limited
saturation power of mmWave power ampliﬁer (PA), we take the
per-antenna power constraint (PAPC) into consideration. We ﬁrst
propose a metric, i.e., generalized detection probability (GDP),
to evaluate the quality of an arbitrary codeword. This metric not
only enables an optimization approach for mmWave codebook
design, but also can be used to compare the performance of two
different codewords/codebooks. To the best of our knowledge,
GDP is the ﬁrst metric particularly for mmWave codebook design
for channel estimation. We then propose an approach to design
a hierarchical codebook exploiting BeaM Widening with Multi-
RF-chain Sub-array technique (BMW-MS). To obtain crucial
parameters of BMW-MS, we provide two solutions, namely a
low-complexity search (LCS) solution to optimize the GDP metric
and a closed-form (CF) solution to pursue a ﬂat beam pattern.
Performance comparisons show that BMW-MS/LCS and BMW-
MS/CF achieve very close performances, and they outperform
the existing alternatives under the PAPC.

Index Terms—Millimeter wave, mmWave, mmWave beam-
forming, mmWave precoding, codebook design, hybrid precoding,
hierarchial search.

I. INTRODUCTION

M ILLIMETER-WAVE (mmWave) communication is a

promising technology for next-generation wireless
communication owing to its abundant frequency spectrum
resource, which promises a much higher capacity than the
existing wireless local area networks (WLANs) [1]–[9] and
the current cellular mobile communication [10]–[17]. In order
to bridge the link budget gap due to the extremely high path
loss in mmWave band, beamforming with large antenna arrays
are generally required in mmWave communications. Subject
to the expensive radio-frequency (RF) chains, analog beam-
forming/combining structure is usually preferred, where all the
antennas share a single RF chain and have constant-amplitude
(CA) constraint on their weights [3], [4], [9]. Meanwhile, a

This work was partially supported by the National Natural Science Foun-
dation of China (NSFC) under grant Nos. 61571025, 91338106, 91538204,
and 61231013, National Basic Research Program of China under grant
No.2011CB707000, and Foundation for Innovative Research Groups of the
National Natural Science Foundation of China under grant No. 61221061.

Z. Xiao is with the School of Electronic and Information Engineering, Bei-
jing Key Laboratory for Network-based Cooperative Air Trafﬁc Management,
and Beijing Laboratory for General Aviation Technology, Beihang University,
Beijing 100191, P.R. China.

P. Xia is with the School of Electronics and Information Engineering and
the Key Laboratory of Embedded System and Service Computing, Tongji
University, Shanghai, P.R. China.

X.-G. Xia is with the Department of Electrical and Computer Engineering,

University of Delaware, Newark, DE 19716, USA.

Corresponding Author: Dr. Z. Xiao with Email: xiaozy@buaa.edu.cn.

hybrid analog/digital precoding/combining structure was also
proposed to realize multi-stream/multi-user transmission [11],
[13], [14], where a small number of RF chains are tied to a
large antenna array.

Subject to the hardware constraint, i.e., the number of RF
chains is far less than the number of antennas in general, the
conventional multiple-input multiple-output (MIMO) channel
estimation is basically infeasible in mmWave communications
either due to high pilot overhead or high computational cost,
and new channel estimation methods need to be tailored to
mmWave systems [18]. For the hybrid precoding structure,
as mmWave channel is generally sparse in the angle domain,
different compressed sensing (CS) based channel estimation
methods were proposed to estimate the steering angles of
multipath components (MPCs) [11], [17]–[20]. For the analog
beamforming structure, a switched beamforming approach was
usually adopted [9], [21], where the beam search space (at
the transmitter and receiver side, respectively) is represented
by a codebook containing multiple codewords, and the best
transmit/receive beams are found by searching through their
respective codebooks.

In practical mmWave channel estimation, a coarse sub-
codebook may be deﬁned with a small number of coarse
sectors (or low-resolution beams) covering the intended angle
range, while a ﬁne sub-codebook may be deﬁned with a large
number of ﬁne (or high-resolution) beams covering the same
intended angle range, and that a coarse sector may have the
same coverage as that of multiple ﬁne beams together [6]–[9].
A divide-and-conquer search may then be carried out across
the hierarchical codebook, by ﬁnding the best sector ﬁrst on
the low-resolution codebook level, and then ﬁnding the best
beam on the high-resolution codebook level, while the best
high-resolution beam is encapsulated in the best sector [6]–
[9]. Such a hierarchical codebook structure and the associated
multi-stage beam search have been adopted in many recent
works [9], [11], [17]–[21].

Performances of the search schemes, including the search
time and detection rate of desired MPCs, are highly dependent
on the codebook design. With an analog beamforming struc-
ture, [9] proposed to use wider beams to speed up beam search,
but design approaches to broaden the beams were not studied.
In [22], a binary-tree structured hierarchical codebook was
designed by using brute-force antenna deactivation (DEACT),
where wider beams were generated by turning off part of the
antennas. In [23], a hierarchical codebook was also designed,
where beam widening is achieved via sub-array technique.
Although it was shown to outperform DEACT [23], half of
antennas may still need to be turned off for some codewords.

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

2

In brief, to design a full codebook with an analog beamforming
structure, antenna deactivation is basically needed, which not
only reduces the total transmission power, but also requires an
analog switch in each antenna branch, leading to additional
cost and power consumption [24].

In contrast, a hybrid precoding structure with multiple
RF chains (typically a few) cannot only enable multi-stream
transmission, but also offer higher ﬂexibility for codebook
design; hence antenna deactivation and analog switches can be
avoided. In [18], the hybrid precoding structure was (maybe
ﬁrstly) adopted to shape wider beams by exploiting the
sparse reconstruction approach (SPARSE), but high-quality
wide beams can be shaped only when the number of RF
chains is large enough and deep sinks within the angle range
appear otherwise. In addition, a phase-shifted discrete Fourier
Transform (PS-DFT) method was also proposed in [25], where
wider beams are shaped by steering multiple RF chains to
adjacent equally spaced angles; thus a large number of RF
chains are required to shape a very-wide codeword. Although
these works [18], [25] are theoretically feasible, they basically
need a lot of RF chains for very-wide codewords, which may
make them unappropriate for devices with only a few RF
chains.

On the other hand, with multiple RF chains the output
powers of the antennas may be signiﬁcantly different from
each other due to combining signals of multiple RF chains,
and the power ﬂuctuation is expected to be more severe
when the number of RF chains is greater. Since in mmWave
integrated circuits the saturation power of a PA is usually
limited [26], [27], the output power ﬂuctuation may limit the
total transmission power. In these parallel works [18], [25], the
per-antenna power constraint (PAPC), caused by the limited
saturation power of PA in each antenna branch, was not taken
into account.

In this paper, we target at designing a codebook for
mmWave channel estimation with a hybrid precoding structure
(typically with a few RF chains), and we take the PAPC into
account in the design. We ﬁrst propose a metric, called gener-
alized detection probability (GDP), to evaluate the quality of
an arbitrary codeword. This metric not only enables a general
optimization approach for mmWave codebook design, but also
can be used to compare the performance of two different
codewords/codebooks. To the best of our knowledge, GDP is
the ﬁrst metric particularly for mmWave codebook design. We
then propose an approach to design a hierarchical codebook
for the hybrid structure, where BeaM is Widened via Multi-
RF-chain Sub-array technique (BMW-MS). To obtain crucial
parameters of BMW-MS, we provide two solutions, namely
a low-complexity search (LCS) solution to optimize the GDP
metric and a closed-form (CF) solution to pursue a ﬂat beam
pattern. Performance comparisons show that BMW-MS/LCS
and BMW-MS/CF achieve almost equivalent performances,
and they (with only 2 RF chains) outperform the existing
alternatives under the PAPC.

The rest of this paper is as follows. In Section II, the
system and channel models are introduced. In Section III, the
channel estimation method is proposed, and the problem of
codebook design is formulated. In Section IV, the GDP metric

is proposed. In Section V, the hierarchical codebook design is
presented. In Section VI, performance evaluation is conducted.
The conclusions are drawn lastly in Section VII.

Symbol Notations: a, a, A, and A denote a scalar variable,
a vector, a matrix, and a set, respectively. (·)∗, (·)T and
transpose and conjugate transpose,
(·)H denote conjugate,
respectively. E(·) denotes expectation operation. [a]i and [A]ij
denote the i-th entry of a and the i-row and j-column entry of
A, respectively. [a]i:j, [A]:,j, and [A]j,: denote a vector with
entries being the i-th to j-th entries of [a], the j-th column of
A and the j-th row of A, respectively. | · |, k · k and k · k∞
denote the absolute value, two-norm and ∞-norm respectively.

Without

II. SYSTEM AND CHANNEL MODELS
loss of generality, we consider a point-to-
point mmWave system with a hybrid digital/analog precod-
ing/combining structure, as shown in Fig. 1, where multiple
RF chains are tied to a half-wave spaced uniform linear array
(ULA) at both the Tx and Rx. While extending the channel
estimation method and the codebook design to a downlink
multiuser scenario is straightforward. Relevant parameters are
listed below, where NST is the number of data streams.

The number of RF chains at the Tx.
The number of antennas at the Tx.
The number of RF chains at the Rx.
The number of antennas at the Rx.

MRF
MAN
NRF
NAN
FBB MRF × NST digital precoding matrix at the Tx.
FRF MAN × MRF analog precoding matrix at the Tx.
WBB NRF × NST digital combining matrix at the Rx.
WRF NAN × NRF analog combining matrix at the Rx.

A Tx composite codeword, F , (FRF, FBB).
A Tx codeword, f

f
i
W A Rx composite codeword, W , (WRF, WBB).
w

, (FRF, [FBB]:,i).

i

F

i

A Tx codeword, w

, (WRF, [WBB]:,i).

i

Basically, we have MRF ≤ MAN and NRF ≤ NAN, but in
practical mmWave systems, MRF and NRF are small, basically
far less than MAN and NAN, respectively.

In this paper, we propose a channel estimation method
based on a hierarchical codebook, and design the codebook
with the hybrid structure in Fig. 1. A Tx codebook is
a collection of composite codewords, and a Tx composite
codeword is in fact a precoding matrix pair (FRF, FBB),
which can be seen as the composite of MRF Tx codewords
{(FRF, FBB:,i)}i=1,2,...,MRF. The constitution of the Rx
codebook is similar to the Tx codebook. We emphasize that
in this paper we use underline to mark a codeword and a
composite codeword, respectively, as shown in the above list.
Note that the Tx/Rx codebooks are predesigned, and thus they
are irrelevant to an instantaneous channel response. However,
they are designed based on the steering feature of mmWave
channel, and they are used to reduce the training overhead in
channel estimation.

We emphasize that there is a single PA in each antenna
branch right before the antenna at the Tx. Since in practice
the saturation power of a mmWave PA is basically limited
[26], [27], we have the PAPC in our model, i.e., the saturation

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

3

F

BB

F

RF

PAs

LNAs

W

RF

W

BB

RF 
Chain

Data/ 

Training 
Symbols

Digital 
Precoding

.
.
.

RF 
Chain

M

RF

.
.
.

.
.
.

.
.
.

H

.
.
.

RF 
Chain

.
.
.

.
.
.

Digital 
Combinin

g

Data/ 

Training 
Symbols

M

AN

N

AN

Antennas

Antennas

.
.
.

RF 
Chain

N

RF

RF Chains

Analog Precoding

Analog Combining

RF Chains

Tx

Rx

Fig. 1.

Illustration of a hybrid analog/digital precoding and combing structure with PAs.

power of a PA is PPEP, which was not considered in [18]
and [25]. In addition, similar to [18] and [25], the analog pre-
coding/combining matrices are with constant-amplitude (CA)
elements, because they are controlled by phase shifters. Note
that there is no switch in each antenna branch.

Without loss of generality, we adopt the same channel model

as that in [18], [22], [23], [28]–[30], which is given by

L

(1)

Xℓ=1

λℓa(NAN, Ωℓ)a(MAN, ψℓ)H,

H =pMANNAN
where λℓ is the complex coefﬁcient of the ℓ-th path, L is
the number of MPCs, a(·) is the steering vector function,
Ωℓ and ψℓ are cos(AoD) and cos(AoA) of the ℓ-th path,
respectively. Let θℓ and ϕℓ denote the physical AoD and AoA
of the ℓ-th path, respectively; then we have Ωℓ = cos(θℓ)
and ψℓ = cos(ϕℓ). Therefore, Ωℓ and ψℓ are within the
range [−1 1]. For convenience, in the rest of
this paper
the cosine angles Ωℓ and ψℓ are called AoDs and AoAs,
respectively. Without particular statement, the angle domain
implicitly means cosine angle domain. Similar to [18], [31],
λℓ can be modeled to be complex Gaussian distributed, while
Ωℓ and ψℓ can be modeled to be uniformly distributed within
[−1, 1]. a(·) is a function of the number of antennas and
AoD/AoA, and can be expressed as

a(N, Ω) =

1
√N

[ejπ0Ω, ejπ1Ω, ..., ejπ(N−1)Ω]T,

(2)

where N is the number of antennas (N is MAN at
the
transmitter and MR at the receiver), Ω is AoD or AoA. It
is easy to ﬁnd that a(N, Ω) is a periodical function which
satisﬁes a(N, Ω) = a(N, Ω + 2). The channel matrix H also

has power normalization PL

ℓ=1

E(|λℓ|2) = 1.

III. CHANNEL ESTIMATION AND THE PROBLEM OF

CODEBOOK DESIGN

A. Channel Estimation

Subject to the hardware constraint, i.e., the number of RF
chains is far less than that of the antennas, mmWave channel
estimation is generally to search the AoDs/AoAs of several
strong MPCs one by one via beam search in the angle domain
[9], [17]–[21]. In this subsection, we propose an improved
beam search method to search one MPC with the hybrid
precoding structure in Fig. 1.

In order to estimate the AoD/AoA of an MPC, signal
measurements must be carried out based on transmission
of training sequences. In each measurement, multi-stream
orthogonal training sequences are transmitted from Tx to Rx,
with precoding matrices selected from a Tx codebook and
combining matrices selected from a Rx codebook, respectively.
Hence, we have the following signal model for a measurement:

Y = √P WH

BB

WH

RF

HFRFFBBS + WH
BB

WH

RF

Z,

(3)

where P is the transmission power per stream, H is the chan-
nel matrix, Z is a white Gaussian noise matrix with average
power N0, [S]j,: is the j-th transmitted training sequence with
a length of LS at Tx, [Y]i,: is the received sequence at the
i-th RF chain at Rx, (FRF, FBB) and (WRF, WBB) are a
selected Tx composite codeword and a selected Rx composite
codeword, respectively. We have [S]m,:[S]H
n,: = 0 when i 6= j
m,: = LS. Let us omit the noise for simplicity.
and [S]m,:[S]H
Then we have
[Y]i,: = √P [WBB]H

FRF[FBB]:,m[S]m,:

WH

(4)

H

:,i

RF

WH

RF

HFRF[FBB]:,j

(5)

MRF

Xm=1

Thus,

ρi,j = [Y]i,:[S]H
j,:

= LS√P [WBB]H
:,i
, LS√P wH
Hfj,

i

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

4

Cosine Angle 

-1

+1

The 0-st Layer

(cid:127)(0,1)

The 1-st Layer

(cid:127)(1,1)

The 2-nd Layer

(cid:127)(2,1)

…

(cid:127)(2,  )

…

…

(cid:127)(1,  )

(cid:127)(2,  !
−   + 1)

…

(cid:127)(2,  !)

…

Fig. 2. Beam coverage of a hierarchical codebook.

where i = 1, 2, ..., NRF, and j = 1, 2, ..., MRF, wi =
WRF[WBB]:,i and fj = FRF[FBB]:,j correspond to the i-
, (WRF, [WBB]:,i) of the selected
th Rx codeword w
Rx composite codeword and the j-th Tx codeword f
,
(FRF, [FBB]:,j) of the selected Tx composite codeword, re-
spectively.

j

i

Afterwards, Rx obtains the optimal Tx/Rx codeword pair as

(j⋆, i⋆) = arg max

(j,i)

|ρi,j|2,

(6)

and feeds back j⋆ to Tx. Hence, in each measurement, Rx
in fact ﬁnds the best Tx/Rx codeword pair with the highest
signal power. If the Tx/Rx codewords are pre-designed to
cover different angle ranges, then the AoD/AoA of the MPC
will be within the angle coverage of the best Tx/Rx codewords,
respectively.

To reduce the training overhead, a hierarchical Tx or Rx
codebook, which is a collection of codewords f or w, is
deﬁned as Fig. 2, The codebook has logM (N ) + 1 layers with
indices from k = 0 to k = logM (N ), where M and N are the
number of RF chains and antennas, respectively. The number
of codewords in the k-th layer is M k, and

CV(w(k, n)) = [−1 +

2n
M k ],
k = 0, 1, ..., logM (N ), n = 1, 2, ..., M k,

2n − 2
M k ,−1 +

(7)

where CV(w) denotes the beam coverage in the angle domain
of codeword w, w(k, n) denotes the n-th codeword in the k-
th layer. Note that a set of M adjacent codewords in the same
layer, i.e., {w(k, (i − 1)M + j)}j=1,2,...,M (i = 1, ..., M k−1),
constitute a composite codeword W(k, i).
Based on a hierarchical codebook, an efﬁcient divide-and-
conquer search, as shown in Algorithm 1, is launched to fast
estimate the response of an MPC. It is noteworthy that a
codebook shown in Fig. 2 and designed in this paper cannot
only used in Algorithm 1, but also in other beam search
methods. On the other hand, only one MPC is searched out by
launching Algorithm 1 once. For the case that multiple MPCs
are needed to be searched out, Algorithm 1 must be launched
multiple times to estimate different MPCs, one MPC at a time
with new training sequences transmitted. However, extending
the one-MPC search to multiple-MPC search is not trivial,
because the contribution of the already searched MPC must
be subtracted when searching a new MPC. Details may refer
to [18], [32].

Another comment we want to make here is as follows.

Algorithm 1: Beam Search Algorithm Based on a Hier-
archical Codebook with a Hybrid Structure.
1) Initialization:
k = 1. /∗The layer index.∗/
kM = max{logMRF (MAN), logNRF(NAN)}. /∗The
maximal layer.∗/
Predeﬁne Tx codebook F and Rx codebook W.
jT = iR = 1. /∗Indices of Tx/Rx composite
codewords.∗/
2) Iteration:
for k = 1 : kM do

Tx/Rx, respectively, selects a composite codeword
F(k, jT)/W(k, iR) from F/W, and sets the matrices
in the composite codewords to the corresponding
precoding/combining matrices.
Tx sends parallel orthogonal sequences S as (3), and
Rx receives and computes ρi,j as (5).
Rx computes the optimal Tx/Rx index pair (j⋆, i⋆) as
(6), and sets iR = NRF ∗ (iR − 1) + i⋆. Rx feeds back
j⋆ to Tx, and Tx sets jT = MRF ∗ (jT − 1) + j⋆.

3) Result:
The response of the estimated MPC is given by
H1 = ρi⋆,j⋆ a(NAN,−1 + 2iR−1

)a(MAN,−1 + 2jT−1

MAN

NAN

H.

)

There is another dimension reduced channel estimation in
massive MIMO system. It is to add a digital dimension reduced
precoding matrix to feed Tx antennas [33], [34]. However,
this approach needs to decide which precoding matrix to use,
which is, in fact, the main issue to address here.

Let us next evaluate the training overhead of Algorithm 1.
We adopt the duration of a training symbol as a unit to count
the training overhead, which is the same as that in regular
MIMO systems [33], [34]. To guarantee the orthogonality
between different training sequences, we have LS ≥ MRF.
It is noted that in regular MIMO systems LS is usually set
equal to MRF to save overhead [33], [34], but in mmWave
communications LS is usually set much greater than MRF to
provide spreading gain for channel estimation, because Tx/Rx
array gains are not yet available before channel estimation
[18], [23].

For a fair comparison with the alternatives, i.e., [23] and
[18], we assume that the length of the training sequence is
the same (LS) in these algorithms. In each measurement of
Algorithm 1, MAN training sequences {[S]j,:}j=1,2,...,MAN
are transmitted in parallel; so the training overhead is LS.
Suppose MRF = NRF and MAN = NAN. The total training
overhead of Algorithm 1 is LS logMRF(MAN), signiﬁcantly
less than that of the beam search algorithm with an analog
beamforming structure in [23] (2LSMRF logMRF (MAN)), as
well as that of the beam search algorithm with a hybrid
precoding structure in [18] (Algorithm 1 therein, which needs
LSMRF logMRF (MAN) units if K = MRF). In brief, Algo-
rithm 1 reduces the training overhead by a factor of the number
of RF chains compared with the alternatives, which beneﬁts

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

5

from the parallel transmission of multiple training sequences.
However, the cost of this beneﬁt is that the codewords within
a composite codeword must share the same analog precoding
matrix, which will be considered in the codebook design.

B. The Problem of Codebook Design

As we can see, a codebook is critical to Algorithm 1. In
this paper we want to design a hierarchical codebook with the
beam coverage shown in Fig. 2 based on the hybrid structure
shown in Fig. 1. We emphasize that we have both the PAPC on
PAs and the CA constraint on the analog precoding/combining
matrices. Since a Rx codebook design can be the same as a
Tx codebook design, we proceed with Tx codebook design.

According to (5), with the hybrid structure an arbitrary
codeword w , (FRF, FBB:,i) shapes an antenna weight vector
(AWV) w = FRFFBB:,i, and the beam steering and coverage
of w are in fact reﬂected by w. Hence, codebook design in
this paper is to design w(k, n) such that w(k, n) has the beam
coverage CV(w(k, n)) = CV(w(k, n)). For convenience, we
also call w a codeword in the remaining of this paper, but we
emphasize that we want to design w , (FRF, FBB:,i) rather
than just w itself, because w is solely determined by w but
not vice versa.

Consequently, a codeword w has the following structure:

MRF

[fBB]j[FRF]:,j,

w = FRFfBB =

Xj=1
where fBB = FBB:,i, |[FRF]:,j| =
1 (the CA con-
straint). Note that the codewords belong to the same composite
codeword share the same FRF, which must be considered in
the design.

1√MAN

(8)

Given the target beam pattern of w(k, n) shown in Fig.
2, we need to design (FRF, fBB) for each w(k, n), which
is challenging due to the CA constraint on FRF. In [18],
this problem is solved by exploiting the sparse reconstruction
approach (SPARSE). While in [25], the problem is further
constrained by letting |fBB = 1|, i.e., the transmission power
of each RF chain is the same, i.e., |[fBB]j|2k[FRF]:,jk2 = 1.
In such a case, a codeword is a combination of multiple RF
vectors with equal power, and it is intuitive that by steering
these RF vectors to equally spaced angles, a wide beam can be
shaped. This is just the PS-DFT codebook proposed in [25].
In this paper, we also let |fBB| = 1 to simplify the problem,
just the same as [25]. However, we will propose different
methods to design the codewords. In the following, we will
ﬁrst establish a general metric, i.e., the GDP metric, to evaluate
the quality of an arbitrary Tx codeword w. We emphasize
that the metric is applicable for codewords with both analog
and hybrid structures. Then we will design a hierarchical
codebook with the target beam coverage shown in Fig. 2 with
the codeword structure (8).

IV. THE GDP METRIC

Given an arbitrary target codeword to cover an angle range
[ψ0, ψ0 + B], there are many approaches to design it. It is
clear that the best codeword should have constant absolute

beam gain within the covered angle range (i.e., a totally ﬂat
beam pattern) [25]. However, due to the CA constraint on the
analog precoding/combining matrices, an ideal codeword can
be hardly designed. Hence, suboptimal designs are of interest,
and there have been many approaches to design a hierarchical
codebook [18], [25]. To the best of our knowledge, however,
there is no particular metric to directly evaluate the quality of a
codeword in the regime of mmWave communications. We can
only judge the quality of a codeword by numerical simulation.
Hence, in this subsection, we establish a general metric and
introduce its properties and signiﬁcance.

A. The GDP Metric

Let us ﬁrst deﬁne the beam gain of an arbitrary codeword

w along angle Ω (Ω ∈ [−1, 1]), i.e., A(w, Ω):

A(w, Ω) = √N a(N, Ω)Hw =

[w]ne−jπ(n−1)Ω.

(9)

N

Xn=1

Intuitively, good codewords should have ﬂat beam patterns,
and mean square error (MSE) can be adopted to measure how
ﬂat a beam pattern is. Moreover, in mmWave communications,
the saturation power of PA is limited. Hence, good codewords
should also allow as high as possible maximal transmission
power (MTP), which is limited by the saturation power of
PA in each antenna branch. For instance, DEACT is not with
high quality, because a lot of antenna elements are turned off,
which signiﬁcantly lowers the MTP. In fact, under the PAPC,
the MTP of an arbitrary codeword w is given by

PMAX(w) =

PPER

max({|[w]n|2}N

n=1)

, PPER
kwk2
∞

,

(10)

where PPER is the PAPC in this paper, i.e., the saturation
power of PA in each antenna branch. It is clear that given
ﬁxed PPER, PMAX(w) is maximized when w (with unit 2-
norm) has CA elements.

As we can see, both MSE and MTP may affect the quality
of a codeword and their effects are different. In fact, these
two metrics are basically contradictory to each other, i.e., a
codeword may have a small MSE but meanwhile also a small
MTP. In general, we want small MSE along with large MTP.
It is not favorable to deﬁne a metric with simple operations
between the MSE and MTP. For rigorousness, we directly
bridge the metric to the detection performance in beamforming
training, because the codebook is particularly designed for it.
During beamforming training, many Tx/Rx codeword pairs
will be selected to detect the AoD/AoA of an MPC. When
the AoD/AoA of the MPC locate within the coverage of the
codewords, the detection probability (DP) is a direct and exact
metric. Hence, we can derive the average DP, and generalize
a metric based on the average DP for the Tx codewords.

Suppose that Tx transmits a training sequence with code-
word wT, and Rx receives with codeword wR, i.e., wT and
wR are ﬁxed. The target beam coverage of wT is [ψ0, ψ0 +B].
We want to develop a metric to evaluate the Tx codeword wT
based on the average DP of a single MPC.

Let H0 denote the channel response for the MPC to be

6

(17)

(18)

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

detected, and it can be deﬁned as

H0 =pMANNANλa(NAN, Ω)a(MAN, ψ)H,

where λ, Ω and ψ denote the gain, AoA and AoD of the
MPC, respectively. Without loss of generality, we assume λ ∼
CN (0, 1), Ω and ψ are uniformly distributed within [−1, 1].
Given H0 the detection problem can be formulated as binary

hypothesis testing given by [25]

R

R

R

(12)

√P wH

n ∼ CN (0, N0),
H0wTs + wH
R

H0
n ∼ CN (S, N0), H1

y =( wH
where H0 and H1 represent the cases when the AoD does
locate and locates within [ψ0, ψ0 + B], respectively,
not
S = √P wH
H0wTs denotes the received pure signal. Given
a threshold ΓN0, the instantaneous DP is given by
pD(Γ) = Pr{|(y|H1)|2 > ΓN0} = Pr{|S + n|2 > ΓN0},
(13)
where n = wH
n. To derive the average DP, we need to average
R
pD(Γ) on all the random variables. Note that S depends on H0
and H0 depends on λ, Ω and ψ. Hence, we need to average
pD(Γ) on n, λ, Ω and ψ.

R

Let us ﬁrst ﬁx Ω and ψ and average pD(Γ) on n and λ.
Since S = √P wH
H0wTs, when Ω and ψ are ﬁxed, H0 has
only one random parameter λ ∼ CN (0, 1). In such a case, S
can be seen as a zero-mean complex Gaussian variable, and
(S + n) ∼ CN (0, (1 + γ)N0), where γ denotes the average
received SNR given by
√P wH
γ = Eλn|
R
P MANNAN

H0wTs|2/N0o
|wH

R

a(NAN, Ω)a(MAN, ψ)HwT|2

(14)

=

N0

=

P
N0|A(wT, ψ)|2|A(wR, Ω)|2,

where |A(wT, ψ)| and |A(wR, Ω)| are in fact Tx and Rx array
gains depending on ψ and Ω, respectively. According to [35,
Chapter 2], |S + n|2/N0 obeys Chi-square distribution with
2 degrees, and its cumulative distribution function (CDF) is
F (y) = 1 − e−y/(1+γ). Thus, we have

¯pD0(Γ) = 1 − F (Γ) = e−Γ/(1+γ).

(15)

(15) is the result of averaging DP on λ and n. We need
to further average ¯pD0(Γ) in (15) on Ω and ψ to obtain the
ultimate average DP. Note that as we only want to evaluate
the quality of the Tx codeword wT with angle coverage
[ψ0, ψ0 + B], we can ﬁrst get rid of the effects of the Rx
codeword wR and AoA Ω. Consequently, we assume the RX
gain is ﬁxed for simplicity, and without loss of generality we
let |A(wR, Ω)|2 = 1. Although the assumption may lead to
inaccuracy, it simpliﬁes the ultimate GDP metric, which does
not require an accurate average DP expression. As a result, γ
reduces to

γ =

P
N0|A(wT, ψ)|2.

(16)

And considering the MTP of wT, the maximal received SNR

is

(11)

γMAX =

PMAX

|A(wT, ψ)|2
∞N0|A(wT, ψ)|2
|A(wT, ψ)|2,

N0
PPER
=
kwTk2
, γPER
kwTk2
∞

where γPER denotes the per-antenna received SNR under the
PAPC.

Consequently, the average DP is given by

1

ψ0

B Z ψ0+B
exp −

¯pD(Γ) =

e−Γ/(1+γMAX)dψ

=

1

B Z ψ0+B

ψ0

Γ

∞ |A(w, ψ)|2! dψ.

1 + γPER
kwTk2

We can see that ¯pD(Γ) depends on both Γ and γPER
in addition to the codeword wT itself. Hence, it cannot be
directly used as a general metric to evaluate the quality of
a codeword. However, we can deﬁne one based on ¯pD(Γ).
Firstly, the threshold Γ affects only the tradeoff between DP in
hypothesis H1 and false-alarm probability (FAP) in hypothesis
H0 [36]. When Γ is smaller, DP is higher, but meanwhile FAP
is also higher. In fact, the threshold itself does not affect the
detection capability which involves both DA and FAP [36].
Based on this fact, we can just set Γ = 1 without loss of
generality. When Γ is larger/smaller, DP will be lower/higher,
but the comparison result of average DP between two different
codewords basically maintains.

On the other hand, γPER may affect the comparison result
of average DP between two different codewords. Intuitively,
when γPER is sufﬁciently high, the beam pattern (reﬂected
by |A(w, ψ)| in (18)) is dominant, but when γPER is small,
in (18)) is
the maximal received SNR (reﬂected by kwTk2
∞
dominant. Hence, different system should set different γPER.
A possible way is to set a typical value of γPER based on the
system settings. For instance, the saturation power of a PA can
be set to 15 dBm [26], [27]. According to the Friis formula,
when the wavelength of the carrier frequency is 1 centimeter
(30 GHz), and the Tx/Rx distance is 100 meters, PPER will
be 15− 20 log10(4π× 10000) = −87 dBm. Besides, when the
bandwidth B = 100 MHz, the noise power can be computed as
N0 = 10 log10(κT B) = 10 log10(1.38× 10−23× 300× 108×
103) = −74 dBm, where κ and T are the Boltzmann constant
and ambient temperature, respectively. Hence, the per-antenna
received SNR is (−76) − (−87) = −11 dB. However, in the
computation the spreading gain of the training sequence, that
equals to the length of the training sequence, is not taken into
account. If the length of the training sequence is LS = 128,
the spreading gain is 10 log10 128 = 21 dB. If the possible
propagation loss due to reﬂection, blockage etc. is 0 to 15
dB, γPER will have a dynamic range from (21 − 11 − 15)
dB to (21 − 11 − 0) dB, i.e., [−5, 10] dB, according to the
above evaluation. In this paper we prefer to set γPER = 0 dB
for conciseness, but it should be clariﬁed that other typical
values close to 0 dB are also applicable. It will be shown in
Section VI that a small change of γPER does not affect the
comparison result of two codewords. For mmWave PA that

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

7

provides a higher/lower saturation power, γPER can be set to
(η− 15) dBm, where η is the saturation power with unit dBm.
Based on the above discussions, we propose the metric of
generalized detection probability (GDP) for an arbitrary N -
entry Tx codeword w with unit 2-norm and target coverage
[ψ0, ψ0 + B]:

kwk2
∞ + |A(w, ψ)|2(cid:19) dψ,
∞

(19)

kwk2

ξ(w, ψ0, B) =

1

B Z ψ0+B

exp(cid:18)−
∞ = max({|[w]n|2}N

ψ0

n=1).

where kwk2
Note that although (19) is deﬁned for Tx codewords, it also
can be used for Rx codewords, because small input ﬂuctuation
of low-noise ampliﬁer (LNA) is also favored in mmWave
communications, where the linearity of LNA may be not
perfect due to the high frequency and large signal bandwidth.
In the case that the linearity of LNA is good enough, (19)
with constant 1 for Rx
can be modiﬁed by replacing kwk2
∞
codewords. In this paper, we use (19) for both Tx/Rx codeword
designs.

B. Properties and Signiﬁcance

The GDP metric has the following properties.
Property 1: (Phase-shift invariance) ξ(w, ψ0, B) is in-

variant to phase shift, i.e., ξ(w ◦ √N a(N, Ω), ψ0 + Ω, B) =
ξ(w, ψ0, B), where ◦ represents entry-wise product (a.k.a.
Hadamard product) and all angles are in the cosine angle
domain.

Proof: See Appendix A.

kwk2

∞

kwk2

1

ψ0

decreases,

Property 2:

exp(cid:16)−

decreases. In addition,

decreases. Thus ξ(w, ψ0, B) increases with

Proof: It is clear that exp(cid:16)−

(In favor of CA weights) ξ(w, ψ0, B)
and ξ(w, ψ0, B) ≤
1+N|A(w,ψ)|2(cid:17) dψ, where the equality holds
∞+|A(w,ψ)|2(cid:17) increases

increases with kwk2
∞
B R ψ0+B
1
only when |[w]n|2 = 1/N .
with kwk2
∞
kwk2
∞
n=1) ≥ mean({|[w]n|2}N
kwk2
∞ = max({|[w]n|2}N
where the equality holds only when |[w]n|2 = 1/N .
Property 3: (In favor of ﬂat beam pattern) ξ(w, ψ0, B) ≤
exp(cid:16)− kwk2
∞+2/B(cid:17), and the equality holds only when w has
|A(w, ψ)|2 =( 2/B, ψ ∈ [ψ0, ψ0 + B],

an ideal beam pattern, i.e.,

Others.

∞

kwk2

(20)

0,

n=1) = 1/N,

Proof: See Appendix B.

These properties of GDP offer guidance on codebook
design. Property 1 shows that if a codeword w has been
designed with coverage [ψ0, ψ0 + B], another codeword with
target coverage [ψ, ψ + B] can be immediately obtained as

w ◦ √N a(N, ψ − ψ0) without re-launching the designing

process. Property 2 implies that a good codeword should have
elements with close amplitudes, such that the MTP will be
higher. Property 3 shows that a good codeword should have
equivalent beam gains along different angles (i.e., ﬂat beam
pattern); thus deep sinks with the beam pattern should be
avoided.

Moreover, one signiﬁcance of GDP lies in that it enables
a general optimization approach to design the codewords. In
particular, if we want to design an arbitrary codeword w with
target beam coverage [ψ0, ψ0 + B], we can formulate the
following problem

maximize

b

ξ(w(b), ψ0, B),

subject to Constraints on (b),

(21)

where b is a parameter vector to be determined, and the
constraints can include other desired structure constraints
to simplify the search complexity in addition to the CA
constraint. The proposed BMW-MS/LCS codebook is just
obtained with the optimization approach (cf. (26)). Note that
the GDP metric and the optimization approach can be used for
codebook design with both analog beamforming and hybrid
precoding structures.

Another signiﬁcance of GDP lies in that it provides an
additional way to compare two different codewords/codebooks
besides simulation. With the same target beam coverage, a
codeword with higher GDP has better performance. For two
different codebooks with the same coverage structure,
its
performance is basically determined by the codewords with the
widest beams. Hence, by comparing the GDAs of the widest
codewords of two different codebooks, we can evaluate which
one is better. In Section VI we show that the results of GDP
comparison agree with those of the success rate and achievable
rate comparisons.

V. HIERARCHICAL CODEBOOK DESIGN

In this section we propose the BMW-MS approach to design
a Tx hierarchical codebook based on multi-RF-chain sub-array
technique1. In order to obtain the coefﬁcients for each sub-
array, we propose two candidate solutions. The ﬁrst one is a
low-complexity search (LCS) solution to optimize the GDP
metric, and the second one is a closed-form (CF) solution
which is based on Property 3 to pursue ﬂat beam patterns.
Hence, the BMW-MS approach with the two solutions are
termed as BMW-MS/LCS and BMW-MS/CF, respectively.

It is noteworthy that when letting |fBB| = 1 in (8) the

structure of the Tx codeword can be further written as

MRF

w =

vi,

(22)

where vi = [FRF]:,i is the RF weight vector (RWV) of the
i-th RF chain, and the phases of fBB have been absorbed into
those of vi; thus we have in fact let fBB = 1 here.

Xi=1

A. The BMW-MS Approach

A critical challenge to design the hierarchical codebook
shown in Fig. 2 is beam widening, i.e., to design the low-
layer codewords which have wide beam widths. Intuitively,
if MRF is sufﬁciently large, wide beams can be shaped by
steering these RF RWVs towards equally spaced angles within
the beam coverage. This is just the PS-DFT approach [25].

1Rx codebook design is similar.

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

8

However, in practice MRF may be rather small. In such a
case, we consider to use the sub-array technique to shape a
wide beam. In particular, a large RWV of each RF chain can
be divided into multiple sub-vectors (called sub-arrays), and
these sub-arrays can point at different directions, such that a
wider beam can be shaped.

To illustrate this,

let us separate the N -element RWV
of each RF chain into MS sub-arrays with NS elements
in each sub-array, which means N = MSNS. In addi-
tion, letting fi,m = [vi](m−1)NS+1:mNS, we have [fi,m]n =
[vi](m−1)NS+n, m = 1, 2, ..., MS, n = 1, 2, ..., NS, and
i = 1, 2, ..., MRF. fi,m can be seen as the sub-RWV of the
m-th sub-array of the i-th RF chain. Therefore, the beam gain
of w writes

A(w, ω) =

N

MRF

N

MRF

Xn=1

[

Xi=1

vi]ne−jπ(n−1)ω

i

 

n
a
G
m
a
e
B

2

1.5

1

0.5

 
0
−1

 

f1,1, ω
f2,1, ω
f1,2, ω
f2,2, ω

1,1=−1+0.5∆θ
2,1=−1+1.5∆θ
1,2=−1+2.5∆θ
2,2=−1+3.5∆θ

Different
    RF

Different
    RF

Different
    RF

ω

1,1

ω

2,1

ω

1,2

ω

2,2

ν
1,1

ν
2,1

ν
1,2

Same
  RF

Same
  RF

−0.5

Angle (π rad)

0

0.5

Fig. 3. The beam patterns of the sub-arrays, where NS = 8, MRF = MS =
2, ∆θ = 2/NS = 0.25, B = 1, and Ω0 = −1.

[vi]ne−jπ(n−1)ω

MRF

=

=

=

=

MS

MRF

Xn=1
Xm=1
Xi=1
Xi=1

MRF

NS

MS

Xi=1
Xn=1
Xm=1
Xm=1

MS

[vi](m−1)NS+ne−jπ((m−1)NS+n−1)ω

(23)

e−jπ(m−1)NSω[fi,m]ne−jπ(n−1)ω

NS

Xi=1
Xn=1

e−jπ(m−1)NSωA(fi,m, ω),

in Fig. 3, where NS = 8, MRF = MS = 2, ∆θ = 2/NS =
0.25, B = 1, and Ω0 = −1. The intuition of this approach is
explained as follows. As we want to cover an angle interval
of B, and there are MRFMS controllable sub-arrays in total,
we can evenly steer these sub-arrays with an angle gap ∆θ =
B/(MRFMS) over the desired angle range. Moreover, in order
to reduce the coupling effect between adjacent sub-arrays of
the same RF chain, we set their angle gap as wide as possible.

where we can ﬁnd that the beam coverage of w can be
controlled by controlling the MRFMS sub-arrays fi,m. It is
noteworthy that the coefﬁcient between different sub-arrays
is e−jπ(m−1)NSω. As the coefﬁcient depends on m and ω,
it induces coupling effect between different sub-arrays of the
same RF chain. When the angle gap of two adjacent sub-arrays
of the same RF chain is not wide enough, the coupling effect
will be signiﬁcant. In contrast, the coefﬁcient does not depend
on i. Hence, there is no coupling effect between different sub-
arrays of different RF chains, which means that the steering
angles of two sub-arrays of different RF chains can be close
without affecting each other.

Based on the above observation, we propose the BMW-MS
approach for beam widening, i.e., to cover an arbitrary angle
range [Ω0, Ω0 +B] with MRF RF chains, where each RF chain
is decomposed into MS sub-arrays, and the sub-RWVs fi,m are
set to steer along the angles

ωi,m = Ω0 + (i − 1/2)∆θ + (m − 1)MRF∆θ,

where ∆θ = B/(MRFMS), i.e., fi,m satisﬁes

(24)

fi,m =r NS

N

ejθi,m a(NS, ωi,m),

(25)

where θi,m are phase parameters (in the angle domain instead
of cosine angle domain) to be determined. Since the beam
width of a sub-array is 2/NS, ∆θ should be no larger than
2/NS; otherwise there will be sink between two adjacent sub-
arrays.

An example of the beam patterns of the sub-arrays is shown

B. Low-Complexity Search and Closed-Form Solutions

A remaining critical issue is to determine the coefﬁcients
θi,m for the BMW-MS approach in (25). We propose two
solutions as follows, i.e., a low-complexity search (LCS) and
a closed-form (CF) solutions.

1) A Low-Complexity Search Solution: According to (21),

the following optimization problem can be formulated:

maximize

θi,m

ξ(w, Ω0, B),

subject to [vi](m−1)NS+1:mNS = fi,m =

(26)

r NS

N

ejθi,m a(NS, ωi,m),

which is a non-convex problem. Although the exhaustive grid
search can be directly adopted to search over the feasible
domains of θi,m, it has a high computational complexity which
grows exponentially with the total number of the sub-arrays.
To lower the search complexity, we assume equal-difference
phase sequences for the sub-arrays of the same RF chain and
the sub-arrays of different RF chains, respectively, i.e., we let

θi,m = mφ1 + iφ2,

(27)

where φ1 ∈ [0, 2π]
is the phase difference of the phase
sequence for the sub-arrays of the same RF chain, and
φ2 ∈ [0, 2π] is the phase difference of the phase sequence for
the sub-arrays of different RF chains. With this assumption, the
problem (26) reduces to a 2-parameter search problem, which

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

9

does not grow with the total number of sub-arrays. Thus, the
computational complexity becomes affordable.

2) A Closed-Form Solution: According to (24), the sub-
arrays are set to steer along ωi,m with an angle gap ∆θ. This
can only guarantee that the beam gains along these directions
are high. According to Property 3, we also hope that the beam
gains along the other angles between adjacent ωi,m are high,
such that the beam pattern is ﬂatter. Thus, we can design
θi,m to maximize the beam gains along the middle angles
of adjacent ωi,m, i.e.,

beam gain of w along angles νi,m can be derived as

νi,m = Ω0 + i∆θ + (m − 1)MRF∆θ,

(28)
where im 6= MRFMS. Fig. 3 also shows the locations of νi,m.
Since fi,m =q NS
N ejθi,m a (NS, ωi,m), according to (23) the
NS√N
a(NS, νk,n)Ha (NS, ωi,m) .

e−jπ(m−1)NSνk,n ejθi,m

A(w, νk,n) =

Xm=1

Xi=1

(29)

MRF

MS

It

that

is clear

to determine eθi,m by optimizing the
absolute beam gain in (29) is still complicated. However,
since we want to obtain a low-complexity solution, we do
not directly solve the optimization problem. Noticing that
|a(NS, ω1)Ha(NS, ω2)| becomes smaller when |ω1 − ω2| be-
comes greater from 0 to 2/NS, and can be neglected when
|ω1 − ω2| > 2/NS. This means that the two sub-arrays with
steering angles closest to νk,n have the most signiﬁcant effects
on the beam gain along νk,n, while the sub-arrays with steering
angles far from νk,n have a little effect on the beam gain along
νk,n, which can also be observed from Fig. 3. This motivates
us to consider only the two close sub-arrays when optimizing
the beam gain for simplicity. With this idea, we can ﬁnally
obtain

θi,m = πm(m − 1)NSMRF∆θ/2−

π(mMRF + i)(NS − 1)∆θ/2,

(30)

where ∆θ = B/(MRFMS), i = 1, 2, ..., MRF, and m =
1, 2, ..., MS. The detailed derivation can be found in Appendix
B.

C. Codebook Generation

Up to now we have assumed that MRF, MS and NS are
known in priori. However, in practice MRF is given by the
system setting, while MS and NS are in fact determined by
the beam width B of the codeword to be designed. In other
words, MS and NS may be different for different codewords
with different beam widths. Since when MS is smaller NS will
be bigger and a higher beam gain can be provided, MS should
be as small as possible. As ∆θ = B/(MRFMS) ≤ 2/NS and
N = MSNS, we can obtain

MS =lpBN/(2MRF)m ,

(31)

where ⌈·⌉ is the ceiling operation.
that we need to design w(k, n) instead of just
w(k, n) itself. By exploiting the BMW-MS approach we can

Recall

design w(k, n) , (FRF(k,n), fBB(k,n) = 1). Recall again
that different codewords within the same composite codeword
share the same FRF, i.e., the same {vi}i=1,2,...,MRF. This
can be satisﬁed by using Property 1 as follows. According
to Property 1,

w(k, n) = w(k, 1) ◦

√N a(N,

√N a(N,

= FRF(k,1)1 ◦
= FRF(k,1)√N a(N,

)

RF

2(n − 1)
M k
2(n − 1)
M k
RF
2(n − 1)
M k

),

RF

)

(32)

which means all the codewords within the same layer can share
the same FRF.

In summary, the codebook is generated as follows, where

k = 1, ..., logMRF (MAN), N = MAN.

RF. Let the number of antennas

arrays, where Bk = 2/M k
of each sub-array be NS = N/MS.

• Split each RF chain into MS =lpBkN/(2MRF)m sub-
• Compute w(k, 1) as (FRF(k,1) = {vi}i=1,2,...,MRF, 1),
where [vi](m−1)NS+1:mNS = q NS
N ejθi,m a(NS, ωi,m).
ωi,m is computed as (24) (Ω0 = −1, B = 2/2k). θi,m
can either be computed by solving (26) with the low-
complexity search method (BMW-MS/LCS) or according
to the closed-form expression (30) (BMW-MS/CF).
• Compute w(k, n) (n = 2, 3, ..., M k
erty 1 as (FRF(k,1),√N a(N, 2(n−1)

RF) according to Prop-

)).

M k

RF

Interestingly, BMW-MS happens to be a generalization of
the PS-DFT method in [25]. With the PS-DFT method, a wide
beam is constructed by exploiting multiple RF chains, which
steer toward adjacent angles with a gap 2/N , and the shaped
beam width is B = 2MRF/N . To lower the search complexity,
the CA coefﬁcients corresponding to the RWVs of all the RF
chains are modeled as an equal-difference sequence in terms
of the phase, and thus there is only one single parameter to
determine. A drawback of the PS-DFT method lies in that
the number of RF chains is proportional to the beam width.
To generate very-wide beam, e.g., the codeword w(0, 1), the
number of RF chains would be too many for implementation.
In BMW-MS MRF is assumed small. However, in the case
that the number of available RF chains is large enough, e.g.,
equal to N , to shape a codeword with a beam width of B,
we can determine the number of RF chains to generate this
codeword as MRF = BN/2. Then according to (31), we
obtain MS = 1, and thus NS = N . In such a case, BMW-
MS/LCS becomes almost the same as PS-DFT except the
objective function. Moreover, according to (30) for BMW-
is just an
MS/CF,
increasing sequence, which has a good accordance with [25]
and BMW-MS/LCS. Therefore, we say BMW-MS can be seen
as a generalization of PS-DFT.

in the case of MS = 1, {θi,m}MRF

i=1

However, we emphasize that the main purpose of BMW-MS
is to design a full hierarchical codebook shown in Fig. 2 with
as less as possible RF chains, because in reality the number
of available RF chains in a mmWave device would be small,
e.g., typically only 2, 4 or 8. In fact, we recommend to select

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

i

 

n
a
G
m
a
e
B

3

2.5

2

1.5

1

0.5

 
0
−1

10

 

 

iLayer = 3, BMW−MS/LCS
iLayer = 2, BMW−MS/LCS
iLayer = 1, BMW−MS/LCS
iLayer = 0, BMW−MS/LCS
iLayer = 3, BMW−MS/CF
iLayer = 2, BMW−MS/CF
iLayer = 1, BMW−MS/CF
iLayer = 0, BMW−MS/CF

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

F
D
C

Average Power
1/N = 0.03

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (16 RFs)
SPARSE (16 RFs)

−0.5

0

cos(Angle)

0.5

1

0

 
0

0.1

0.2
Per−Antenna Power

0.3

0.4

0.5

Fig. 4. Beam pattern comparison between BMW-MS/LCS and BMW-MS/CF,
where N = 8, MRF = 2, iLayer is the layer index. The dashed red line
superpositions the solid red line.

Fig. 5. CDF comparison between different codebooks. N = 32.

MRF = 2 to realize BMW-MS, because fewer RF chains help
to reduce the input/output ﬂuctuation of the PAs, and with 2 RF
chains BMW-MS can already achieve promising performance
as we shall see from simulations later, but a larger number of
RF chains can improve the efﬁciency of channel estimation as
shown in Section III.

VI. PERFORMANCE EVALUATION

In this section we evaluate the performance of BMW-MS.
We will ﬁrst show the beam patterns of BMW-MS and com-
pare them with those of the alternatives. Afterwards, we will
perform extensive performance comparisons between these
candidates in terms of the GDP metric, success (detection)
rate and achievable rate.

Fig. 4 shows the beam pattern comparison between BMW-
MS/LCS and BMW-MS/CF, where N = 8, MRF = 2 and
iLayer is the layer index. From this ﬁgure we can observe
that both approaches have realized the beam coverage shown
in Fig. 2. In addition, BMW-MS/CF basically provides similar
beam patterns to BMW-MS/LCS, which means that the closed-
form solution is also promising.

Next, we compare the performances of different codebooks.
We know that when the saturation power of a PA is limited, the
input ﬂuctuation signiﬁcantly affects the average output power.
Basically the less the ﬂuctuation is, the higher the average
output power is. Hence, we ﬁrst evaluate the ﬂuctuation of
the input power of the antennas with different codebooks.
To do so, as each codebook has log2(N ) + 1 layers, we
select one codeword from each layer of a codebook except
the 0th layer, because SPARSE did not provide the 0th layer
in [18]. Since each codeword has N elements, we now have
N log2(N ) elements in total. Hence, we can calculate the
statistics on these elements and obtain the CDF curve. Fig.
5 shows the CDF comparison between different codebooks,
where N = 32. Note that in this ﬁgure all the codewords
the PAPC is not applied yet. We
have unit 2-norm, i.e.,

can ﬁnd that for BMW-MS/LCS and BMW-MS/CF, most
of the elements locate around the average power 1/N , and
the strongest element has a power about 0.06 (corresponding
in (10)). However, for PS-DFT and SPARSE, the
to kwk2
∞
power of the elements disperses within a large range from 0
to more than 0.5. Hence, it is clear that BMW-MS/LCS and
BMW-MS/CF have lower power ﬂuctuation than PS-DFT and
SPARSE, and according to (10) we can deduce that under the
PAPC BMW-MS/LCS and BMW-MS/CF have higher MTP
than PS-DFT and SPARSE.

Fig. 6 shows beam pattern comparison between different
schemes with/without PAPC, where N = 32 and the codeword
is w(1, 1) with coverage [−1, 0] for all the schemes. When
without PAPC the 2-norm of a codeword is normalized to 1,
while when with PAPC the entry with the largest absolute
value of the codeword is normalized to 1 according to (10).
From this ﬁgure we can ﬁnd that without PAPC, PS-DFT
and SPARSE have ﬂatter beam patterns than BMW-MS/LCS
and BMW-MS/CF (the upper ﬁgure), but with PAPC, BMW-
MS/LCS and BMW-MS/CF have higher beam gains than PS-
DFT and SPARSE (the bottom ﬁgure).

Fig. 7 shows the beam pattern comparison between BMW-
MS/CF and PS-DFT with/without PAPC, where N = 64. (a)
and (b) are without PAPC, and the beam patterns match the
results in [25, Fig.4 (b: Level 1) and (b: Level 2)]. (c) and
(d) are with PAPC. From this ﬁgure we can ﬁnd that PS-DFT
outperforms BMW-MS when there is no PAPC, because PS-
DFT has ﬂatter beam patterns. Note that PS-DFT achieves the
superiority at the cost of a larger number of RF chains. The
numbers of RF chains are N/2iLayer and 2 for PS-DFT and
BMW-MS, respectively. In contrast, when PAPC is considered,
which is practically reasonable in mmWave communications
due to the limited performance of PA, BMW-MS/CF can offer
an higher beam gain.

Fig. 8 shows the GDP comparison between different
schemes under PAPC. The codewords of the 1st
layer is
considered, because the performance of a codebook is ba-

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

11

90o

10.7 dB
9.5 dB

90o

14.5 dB
13 dB

90o

25.7 dB

18.6 dB

90o

31.7 dB

24.6 dB

PS−DFT
BMW−MS/CF

0o

0o

0o

0o

−90o
(a) iLayer=3, Without PAPC

−90o
(b) iLayer=4, Without PAPC

−90o
(c) iLayer=3, With PAPC

−90o
(d) iLayer=4, With PAPC

Fig. 7. Beam pattern comparison between BMW-MS/CF and PS-DFT with/without PAPC. N = 64. (a) and (b) are without PAPC, while (c) and (d) are
with PAPC.

2

C
P
A
P

1.5

 
t

u
o
h

t
i

i

 

w
n
a
G
m
a
e
B

 

1

0.5

 
0
−1

10

8

6

4

2

 
0
−1

C
P
A
P
h

 

t
i

i

 

w
n
a
G
m
a
e
B

 

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (16 RFs)
SPARSE (16 RFs)

−0.5

0

cos(Angle)

0.5

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (16 RFs)
SPARSE (16 RFs)

−0.5

0

cos(Angle)

0.5

 

1

 

1

Fig. 6. Beam pattern comparison between different schemes with/without
PAPC. N = 32, and the codeword is w(1, 1) with coverage [−1, 0] for all
the schemes.

sically determined by the widest codeword2. Both cases of
γPEP = 0 dB (the left hand side ﬁgure) and γPEP = 2
dB (the right hand side ﬁgure) are considered. From them
we can observe that BMW-MS/LCS and BMW-MS/CF have
equivalent GDP performance, which is signiﬁcantly better than
PS-DFT and SPARSE. For SPARSE, there is a peak GDP as
N increases. This is because when N is small the received
SNR plays a cardinal role to determine the GDP, and thus
the GDP increases with N , which increases the beam gain.

2The 0th layer codeword was not provided in [18]. Hence we prefer to

compare the 1st-layer codewords.

1

0.95

0.9

P
D
G

0.85

0.8

0.75

0.7

0

P
D
G

1

0.98

0.96

0.94

0.92

0.9

0.88

0.86

0.84

0.82

0.8

 
0

 

γ
PEP = 2 dB

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (N/2 RFs)
SPARSE (16 RFs)

50

100

150

N

γ
PEP = 0 dB

50

100

150

N

Fig. 8.
schemes under PAPC.

GDP comparison of the 1st layer codewords between different

However, when N is large, the received SNR is already high
enough. In such a case, the beam pattern plays a cardinal
role instead. Since the number of RF chains is ﬁxed, there
will appear sinks as N increases according to [18]. Thus,
the GDP decreases on the contrary as N increases. Moreover,
although the GDP grows when γPEP = 2 dB compared with
the case of γPEP = 0 dB, the comparison results maintain,
which demonstrates that the GDP metric in (19) is reasonable
and robust.

Figs. 9 and 10 show the comparisons of success rate and
achievable rate between different schemes under PAPC, where
MAN = NAN = 32. L = 1 in the simulations, and similar
results can be observed when L is set to other values. Success
rate refers to the rate that an MPC is successfully acquired by
Algorithm 1, while achievable rate is computed by using the
best Tx/Rx precoding/combining codewords with Algorithm
1. These two ﬁgures show again that BMW-MS/LCS and
BMW-MS/CF have similar overall performances, which are

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

12

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e

t

a
R
 
s
s
e
c
c
u
S

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (16 RFs)
SPARSE (16 RFs)

 
0
−30

−20

−10
SNR Per Antenna (dB)

0

10

20

Fig. 9. Comparison of success rate between different schemes under PAPC,
where MAN = NAN = 32.

/

)
z
H
d
n
o
c
e
s
 
r
e
p

 
s
t
i

l

 

t

b
(
 
e
a
R
e
b
a
v
e
h
c
A

i

BMW−MS/LCS (2 RFs)
BMW−MS/CF (2 RFs)
PS−DFT (16 RFs)
SPARSE (16 RFs)

 

16

14

12

10

8

6

4

2

 
0
−20

−15

−10

−5
SNR Per Antenna (dB)

0

5

10

15

20

Fig. 10. Comparison of achievable rate between different schemes under
PAPC, where MAN = NAN = 32.

signiﬁcantly better than PS-DFT and SPARSE. The results of
these two ﬁgures have a good agreement with the GDP results
shown in Fig. 8, which again demonstrates the rationality of
the established GDP metric in (19).

VII. CONCLUSIONS

In this paper we design a hierarchical codebook taking
the per-antenna power constraint into account for mmWave
channel estimation with a hybrid precoding/combining struc-
ture, where multiple RF chains are available. We have ﬁrst
established the GDP metric to particularly measure the perfor-
mance of an arbitrary codeword. The metric not only enables a
general optimization approach for codebook design, but also
provides an additional way to compare the performance of
different codewords/codebooks. Besides, GDP turns out to
have a good accordance with the simulated performances of
success (detection) rate and the achievable rate. To the best of

 

our knowledge, GDP is the ﬁrst metric that has been explicitly
proposed for codebook design in mmWave communications.
Then BWM-MS/LCS and BMW-MS/CF have been proposed
to design a hierarchical codebook by exploiting the multi-RF-
chain sub-array technique, where BWM-MS/LCS optimizes
the GDP metric using a simpliﬁed search method under the
sub-array structure, while BMW-MS/CF provides closed-form
codewords to pursue ﬂat beam patterns. Performance com-
parisons show that BMW-MS/LCS and BMW-MS/CF achieve
very close performances, and they (with only 2 RF chains)
outperform PS-DFT and SPARSE under the per-antenna power
constraint.

Firstly, we have

APPENDIX A

PROOF OF PROPERTY 1

√N a(N, ψ), Ω)

√N a(N, ψ))

(a)

N

(b)
=

A(w ◦
=√N a(N, Ω)H(w ◦
Xn=1
Xn=1
= A(w, Ω − ψ),

=

(c)

N

[w]ne−jπ(n−1)(Ω−ψ)

[w]nejπ(n−1)ψe−jπ(n−1)Ω

(33)

where (a) and (c) are according to (9), while (b) is according
to deﬁnition of the entry-wise product. Besides, we have

∞

√N a(N, ψ)k2

k(w ◦
√N a(N, ψ)]n|2}N
=max({|[w ◦
=max({|[w]nejπ(n−1)ψ|2}N
n=1)
=max({|[w]n|2}N
n=1) = kwk2
∞.
√N a(N, Ω), ψ0 + Ω, B)

Hence,

n=1)

(34)

ξ(w ◦
B Z ψ0+Ω+B
1
B Z ψ0+B

ψ0+Ω

ψ0

1

=

=

=ξ(w, ψ0 + Ω, B).

kwk2
∞

exp(cid:18)−
exp(cid:18)−
kwk2

∞ + |A(w, ψ − Ω)|2(cid:19) dψ
kwk2
kwk2
∞ + |A(w, α)|2(cid:19) dα
∞

(35)

APPENDIX B

PROOF OF PROPERTY 3

According to (19), w can be written as the following

summation form:

NB

1
B

Xi=1

ξ(w, ψ0, B) =

exp(cid:18)−
= mean(cid:18)exp(cid:18)−
where ∆ψ is small, C , kwk2
∞
B/∆ψ.

C

C + |A(w, ψi)|2(cid:19) ∆ψ
C + |A(w, ψi)|2(cid:19)(cid:19) ,

C

(36)

, ψi = ψ0 + i∆ψ, and NB =

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

13

Let f (x) = exp(− C

C+x ). Since f′(x)|x≥0 > 0, f (x) is a

concave function [37], and thus we have

next page, where we have used

N

ej(i−1)θ =

Xi=1
=ej(N−1)θ/2 sin(N θ/2)
sin(θ/2)

.

(37)

1 − ejN θ
1 − ejθ =

ejN θ/2(e−jN θ/2 − ejN θ/2)

ejθ/2(e−jθ/2 − ejθ/2)

(42)
From (40) we can ﬁnd that to optimize the absolute gain, we
have

θk+1,n − θk,n = −π(NS − 1)∆θ/2.

(43)

In addition, the beam gain of the other type of νk,n is derived
as in (41) on the top of the next page, where we can ﬁnd that
to optimize the absolute gain, we have

θ1,n+1 − θMRF,n
= − π(NS − 1)∆θ/2 + πNS(MRF∆θ + (n − 1)MRF∆θ)
= − π(NS − 1)∆θ/2 + πNSnMRF∆θ
(44)
Based on (43) and (44), we ﬁnally obtain (30).

REFERENCES

[1] K.-C. Huang and Z. Wang, Millimeter Wave Communication Systems.

Hoboken, New Jersey, USA: Wiley-IEEE Press, 2011.

[2] E. Perahia, C. Cordeiro, M. Park, and L. L. Yang, “IEEE 802.11 ad:
deﬁning the next generation multi-Gbps Wi-Fi,” in IEEE Consumer
Communications and Networking Conference (CCNC). Las Vegas, NV:
IEEE, Jan. 2010, pp. 1–5.

[3] S. K. Yong, P. Xia, and A. Valdes-Garcia, 60GHz Technology for Gbps
WLAN and WPAN: from Theory to Practice. West Sussex, UK: Wiley.
[4] P. Xia, H. Niu, J. Oh, and C. Ngo, “Practical antenna training for
millimeter wave MIMO communication,” in IEEE Vehicular Technology
Conference (VTC) 2008. Calgary, Canada: IEEE, Oct. 2008, pp. 1–5.
[5] P. Xia, S. K. Yong, J. Oh, and C. Ngo, “Multi-stage iterative antenna
training for millimeter wave communications,” in IEEE GLOBECOM
Conference 2008. New Orleans, LA, USA: IEEE, Dec. 2008, pp. 1–6.
[6] P. Xia and C. Ngo, “System and method for multi-stage antenna training

of beamforming vectors,” US Patent 8165595 B2, April 2012.

[7] S. K. Yong, H.-R. Shao, X. Qin, P. Xia, and C. Ngo, “System and
method for antenna training of beamforming vectors by selective use of
beam level training,” US Patent 8280445 B2, Oct. 2012.

[8] L. I. K. S. and Y. S. X. P., “Millimeter wave multi-resolution beam-

forming,” DOC. IEEE 802.15-08-0182-00-003c, Jan. 2008.

[9] J. Wang, Z. Lan, C. Pyo, T. Baykas, C. Sum, M. Rahman, J. Gao, R. Fu-
nada, F. Kojima, and H. Harada, “Beam codebook based beamforming
protocol for multi-Gbps millimeter-wave WPAN systems,” IEEE Journal
on Selected Areas in Communications, vol. 27, no. 8, pp. 1390–1399,
Oct. 2009.

[10] F. Khan and J. Pi, “Millimeter-wave mobile broadband: unleashing 3–
300GHz spectrum,” in IEEE Wireless Commun. Netw. Conf., Cancun,
Mexico, March 2011.

[11] A. Alkhateeb, J. Mo, N. Gonz´alez-Prelcic, and R. Heath, “MIMO
precoding and combining solutions for millimeter-wave systems,” IEEE
Communications Magazine, vol. 52, no. 12, pp. 122–131, Dec. 2014.

[12] S. Han, I. Chih-Lin, Z. Xu, and C. Rowell, “Large-scale antenna systems
with hybrid analog and digital beamforming for millimeter wave 5G,”
IEEE Communications Magazine, vol. 53, no. 1, pp. 186–194, Jan. 2015.
[13] W. Roh, J.-Y. Seol, J. Park, B. Lee, J. Lee, Y. Kim, J. Cho, K. Cheun, and
F. Aryanfar, “Millimeter-wave beamforming as an enabling technology
for 5G cellular communications: theoretical feasibility and prototype
results,” IEEE Communications Magazine, vol. 52, no. 2, pp. 106–113,
Feb. 2014.

[14] S. Sun, T. S. Rappaport, R. Heath, A. Nix, and S. Rangan, “MIMO for
millimeter-wave wireless communications: beamforming, spatial multi-
plexing, or both?” IEEE Communications Magazine, vol. 52, no. 12, pp.
110–121, Dec. 2014.

[15] Y. Niu, Y. Li, D. Jin, L. Su, and A. V. Vasilakos, “A survey of millimeter
wave communications (mmwave) for 5g: opportunities and challenges,”
Wireless Networks, vol. 21, no. 8, pp. 2657–2676, 2015.

C

mean(cid:18)exp(cid:18)−
≤ exp(cid:18)−

C + |A(w, ψi)|2(cid:19)(cid:19)
C + mean (|A(w, ψi)|2)(cid:19) ,

C

where the equality holds only when |A(w, ψi)|2 = µ, i.e., a
constant. In the following we will show that this constant is
µ = 2/B.

Given an arbitrary codeword w with unit 2-norm,

the

average power of its beam gain in the angle domain is

1

1

1

1

N

N

N

N

=

=

=

−1

[w]H

[w]H

¯PA =

2Z 1
−1 |A(w, Ω)|2dΩ
−1  N
[w]ne−jπ(n−1)Ω!
2Z 1
Xn=1
2Z 1
Xm=1
Xn=1
2Z 1
Xn=1
Xm=1
−1
2Z 1
=kwk2 +
Xn=1
Xn=1

Xm=1,m6=n
Xn=1
Xm=1,m6=nZ 1
Xm=1,m6=n

1
=kwk2 +
2
=kwk2 = 1,
where in (a) we have used

=kwk2 +

−1
N

[w]H

−1

1
2

(a)

N

N

N

N

1

N

H

  N
Xn=1

[w]ne−jπ(n−1)Ω! dΩ

n ejπ(n−1)Ω[w]me−jπ(m−1)ΩdΩ

n [w]mejπ(n−m)ΩdΩ

[w]H

n [w]mejπ(n−m)ΩdΩ

[w]H

n [w]mejπ(n−m)ΩdΩ

n [w]mZ 1

−1

ejπ(n−m)ΩdΩ

(38)

−1

ejπ(n−m)ΩdΩ =

2j sin(π(n − m))

Z 1
Since |A(w, ψ)|2 = µ when ψ ∈ [ψ0, ψ0 + B], and
|A(w, ψ)| = 0 when ψ /∈ [ψ0, ψ0 + B], we have µB/2 = 1.
Hence µ = 2/B, which completes the proof.

(cid:12)(cid:12)(cid:12)m6=n

jπ(n − m)

= 0.

(39)

APPENDIX C

DERIVATION OF (30)

As shown in Fig. 3, there are two different types of positions
of νk,n. The ﬁrst one is νk,n with k = 1, 2, ..., MRF − 1.
The closest steering angles to it are ωk,n and ωk+1,n, i.e.,
the two corresponding sub-arrays have adjacent RF indices
and the same sub-array index. The other one is νMRF,n. The
closest steering angles to it are ωMRF,n and ω1,n+1, i.e., the
two corresponding sub-arrays have adjacent sub-array indices
but the RF index switches from MRF to 1. The beam gain of
the ﬁrst type of νk,n is derived as in (40) on the top of the

IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. X, NO. X, XXX 20XX

14

MRF

MS

NS√N

Xi=1

e−jπ(n−1)NSνk,n ejθk,n a(NS, νk,n)Ha (NS, ωk,n) +

e−jπ(m−1)NSνk,n ejθi,m a(NS, νk,n)Ha (NS, ωi,m)
Xm=1
NS√N
e−jπ(n−1)NSνk,n ejθk,n e−jπ(NS−1)∆θ/4 sin(−π∆θNS/4)
sin(−π∆θ/4)

A(w, νk,n)|k<MRF, fi,m=ejθi,m a(NS,ωi,m) =
NS√N
1
√N
1
√N

e−jπ(n−1)NSνk,n ejθk,n e−jπ(NS−1)∆θ/4(cid:16)1 + ej(θk+1,n−θk,n+π(NS−1)∆θ/2)(cid:17) .

sin(π∆θNS/4)

sin(π∆θ/4)

1
√N

+

e−jπ(n−1)NSνk,n ejθk+1,n a(NS, νk,n)Ha (NS, ωk+1,n)

e−jπ(n−1)NSνk,n ejθk+1,n ejπ(NS−1)∆θ/4 sin(π∆θNS/4)
sin(π∆θ/4)

(40)

≈

=

=

MRF

MS

NS√N

Xi=1

Xm=1

e−jπ(n−1)NSνk,n ejθk,n a(NS, νk,n)Ha (NS, ωk,n) +

e−jπ(m−1)NSνk,n ejθi,m a(NS, νk,n)Ha (NS, ωi,m)
NS√N
e−jπ(n−1)NSνk,n ejθk,n e−jπ(NS−1)∆θ/4 sin(−π∆θNS/4)
sin(−π∆θ/4)

A(w, νMRF,n)|fi,m=ejθi,m a(NS,ωi,m) =
NS√N
1
√N
1
√N

e−jπ(n−1)NSνk,n ejθk,n e−jπ(NS−1)∆θ/4(cid:16)1 + ej[(θ1,n+1−θk,n+π(NS−1)∆θ/2)−πNSνk,n](cid:17) .

e−jπnNSνk,n ejθ1,n+1 a(NS, νk,n)Ha (NS, ω1,n+1)

sin(π∆θNS/4)

sin(π∆θ/4)

1
√N

e−jπnNSνk,n ejθ1,n+1 ejπ(NS−1)∆θ/4 sin(π∆θNS/4)
sin(π∆θ/4)

+

≈

=

=

(41)

sparse precoding in millimeter wave MIMO systems,” IEEE Transac-
tions on Wireless Communications, vol. 13, no. 3, pp. 1499–1513, March
2014.

[29] S. Hur, T. Kim, D. J. Love, J. V. Krogmeier, T. A. Thomas, and
A. Ghosh, “Millimeter wave beamforming for wireless backhaul and
access in small cell networks,” IEEE Transactions on Communications,
vol. 61, no. 10, pp. 4391–4403, Oct. 2013.

[30] J. Nsenga, W. Van Thillo, F. Horlin, V. Ramon, A. Bourdoux, and
R. Lauwereins, “Joint transmit and receive analog beamforming in 60
GHz MIMO multipath channels,” in IEEE International Conference on
Communications (ICC). Dresden, Germany: IEEE, June 2009, pp. 1–5.
[31] Z. Xiao, X.-G. Xia, D. Jin, and N. Ge, “Iterative eigenvalue decomposi-
tion and multipath-grouping Tx/Rx joint beamformings for millimeter-
wave communications,” IEEE Transactions on Wireless Communica-
tions, vol. 14, no. 3, pp. 1595–1607, March 2015.

[32] Z. Xiao, P. Xia, and X.-G. Xia, “Low complexity hybrid precoding
and channel estimation based on hierarchical multi-beam search for
millimeter-wave MIMO systems,” arXiv Preprint arXiv:1603.01634,
Submitted to IEEE Transactions on Vehicular Technology.

[33] E. Larsson, O. Edfors, F. Tufvesson, and T. Marzetta, “Massive MIMO
for next generation wireless systems,” IEEE Communications Magazine,
vol. 52, no. 2, pp. 186–195, 2014.

[34] L. You, X. Gao, X.-G. Xia, N. Ma, and Y. Peng, “Pilot reuse for massive
MIMO transmission over spatially correlated rayleigh fading channels,”
IEEE Transactions on Wireless Communications, June 2015.

[35] J. G. Proakis, Digital communications 5th Edition. McGraw Hill Higher

Education.

[36] Z. Xiao, C. Zhang, D. Jin, and N. Ge, “GLRT approach for robust burst
packet acquisition in wireless communications,” IEEE Transactions on
Wireless Communications, vol. 12, no. 3, pp. 1127–1137, March 2013.
Cambridge

[37] S. Boyd and L. Vandenberghe, Convex optimization.

university press, 2004.

[16] P. Wang, Y. Li, X. Yuan, L. Song, and B. Vucetic, “Tens of gigabits
wireless communications over e-band los MIMO channels with uniform
linear antenna arrays,” IEEE Transactions on Wireless Communications,
vol. 13, no. 7, pp. 3791–3805, July 2014.

[17] P. Wang, Y. Li, L. Song, and B. Vucetic, “Multi-gigabit millimeter wave
wireless communications for 5g: from ﬁxed access to cellular networks,”
IEEE Communications Magazine, vol. 53, no. 1, pp. 168–178, Jan. 2015.
[18] A. Alkhateeb, O. El Ayach, G. Leus, and R. Heath, “Channel estimation
and hybrid precoding for millimeter wave cellular systems,” IEEE
Journal of Selected Topics in Signal Processing, vol. 8, no. 5, pp. 831–
846, Oct. 2014.

[19] A. Alkhateeb, G. Leus, and R. W. Heath Jr, “Compressed sensing
based multi-user millimeter wave systems: How many measurements
are needed?” arXiv preprint arXiv:1505.00299, May 2015.

[20] Y. Peng, Y. Li, and P. Wang, “An enhanced channel estimation method
for millimeter wave systems with massive antenna arrays,” IEEE Com-
munications Letters, vol. 19, no. 9, pp. 1592–1595, Sept. 2015.

[21] M. Kokshoorn, P. Wang, Y. Li, and B. Vucetic, “Fast channel estimation
for millimetre wave wireless systems using overlapped beam patterns,”
in IEEE International Conference on Communications (ICC). London,
UK: IEEE, June 2015, pp. 1304–1309.

[22] T. He and Z. Xiao, “Suboptimal beam search algorithm and codebook
design for millimeter-wave communications,” Mobile Networks and
Applications, vol. 20, no. 1, pp. 86–97, Jan. 2015.

[23] Z. Xiao, T. He, P. Xia, and X.-G. Xia, “Hierarchical codebook design
for beamforming training in millimeter-wave communication,” arXiv
preprint arXiv:1511.02128, To appear in IEEE Transactions on Wireless
Communications, 2016.

[24] E. Adabi Firouzjaei, “mm-wave phase shifters and switches,” Ph.D.

dissertation, UC Berkeley, 2010.

[25] S. Noh, M. D. Zoltowski, and D. J. Love, “Multi-resolution codebook
based beamforming sequence design in millimeter-wave systems,” in
IEEE Global Telecommunications Conference, San Diego, CA, USA,
Dec. 2015, pp. 1–6.

[26] Y. Jin, M. A. Sanduleanu, E. A. Rivero, and J. R. Long, “A millimeter-
wave power ampliﬁer with 25dB power gain and +8dBm saturated output
power,” in European Solid State Circuits Conference (ESSCIRC).
IEEE,
2007, pp. 276–279.

[27] Y. Zhao and J. R. Long, “A wideband, dual-path, millimeter-wave power
ampliﬁer with 20 dBm output power and pae above 15% in 130 nm
SiGe-BiCMOS,” IEEE Journal of Solid-State Circuits, vol. 47, no. 9,
pp. 1981–1997, 2012.

[28] O. El Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. Heath, “Spatially

