6
1
0
2

 
r
a

 

M
2
1

 
 
]

.

R
P
h
t
a
m

[
 
 

1
v
2
0
9
3
0

.

3
0
6
1
:
v
i
X
r
a

The transition density of Brownian motion killed on a bounded set

Kˆohei UCHIYAMA

Department of Mathematics, Tokyo Institute of Technology

Oh-okayama, Meguro Tokyo 152-8551
e-mail: uchiyama@math.titech.ac.jp

AMS Subject classiﬁcation (2010): Primary 60J65; Secondary 35K20

key words: heat kernel; exterior domain; transition probability

Abstract

We study the transition density of a standard two-dimensional Brownian motion
killed when hitting a bounded Borel set A. We derive the asymptotic form of the
density, say pA
t (x, y), for large times t and for x and y in the exterior of A valid
uniformly under the constraint |x|∨|y| = O(t). Within the parabolic regime |x|∨|y| =
O(√t) in particular pA
t (x, y) is shown to behave like 4eA(x)eA(y)(lg t)−2pt(y − x) for
large t, where pt(y−x) is the transition kernel of the Brownian motion (without killing)
and eA is the Green function for the ‘exterior of A’ with a pole at inﬁnity normalized so
that eA(x) ∼ lg |x|. We also provide fairly accurate upper and lower bounds of pA
t (x, y)
for the case |x| ∨ |y| > t as well as corresponding results for the higher dimensions.

1

Introduction and main results

Let A ⊂ Rd, d ≥ 2 be a bounded and non-polar Borel set and Ar the set of all regular
points of A. Denote the unbounded (ﬁne) component of Rd \ Ar by ΩA. Let pA
t (x, y),
t > 0, x, y ∈ ΩA be the transition density of a d-dimensional standard Brownian motion in
ΩA killed when it hits A. In this paper we obtain an exact asymptotic form of pA
t (x, y) as
t → ∞ that holds true uniformly for x, y subject to the constraint |x|,|y| = O(t). It is
shown by Collet, Martinez and Martin [4] (in which A is assumed to be compact) that as
t → ∞

pA
t (x, y) ∼

2u(x)u(y)
π(lg t)2t

if d = 2

(1)

and

pA
t (x, y) ∼

u(x)u(y)
(2πt)d/2 (1 + o(1))

if d ≥ 3

(2)

uniformly for x, y in any compact set of ΩA. Here u(x) is the unique harmonic function
in ΩA that tends to zero as x approaches Ar and is asymptotically equivalent to lg |x| or
1 as |x| → ∞ according as d = 2 or d ≥ 3; and the symbol ∼ designates the asymptotic
equivalence: the ratio of two sides of it approaches unity in any speciﬁed limit. On the other
hand it is readily veriﬁed that if both x and y are large enough (depending on t when d = 2)
and not located in the opposite direction relative to the origin (in a loose sense), then

t (x, y) ∼ p(d)
pA

t (|y − x|),

(3)

1

where

p(d)
t (x) =

1

(2πt)d/2 e−x2/2t,

x = |x|.

In the case d ≥ 3 formula (2) would be naturally extended to (3) for unbounded x and y
since u(x) → 1 as x := |x| → ∞ (although there still remains a problem, the validity of
(3) being not obvious when x and y is in the opposite direction), whereas in the case d = 2
there is a serious gap between (1) and (3) and it is not clear how they are linked together.
Our result stated below extends formula (1) by allowing x or y to become indeﬁnitely large
with t and makes precise a regime of t, x, y for which (3) is valid, and thereby ﬁll the gap
between (1) and (3). The asymptotic form in the parabolic regime x = O(√t) and/or
y =: |y| = O(√t) would particularly be both interesting and important for an obvious
at a large time t, inside the annulus M < |x| < M√t with a high probability if the constant

reason: our killed Brownian motion starting at any ﬁxed point outside A must be located,

M is large.

For the study of heat equation in ΩA a fundamental role is played by the caloric measure
(the harmonic measure of the heat operator 1
2 ∆ − (∂/∂t) in the space-time cylinder ΩA ×
[0,∞)), which consists of two parts: one is the transition probability pA
t (x, y)|dy|, the part
on the initial boundary ΩA×{0} and the other, the lateral part, is the hitting distribution in
space-time of the boundary ∂A. (∂A denotes the Euclidean boundary of A.) The asymptotic
form of the latter one is computed in [12] and our present result together with it identiﬁes
the explicit asymptotic form of the caloric measure for large time valid uniformly at least in
the regime x ∨ y = o(t ). (Here x ∨ y = max{x, y}).

Let U(a) ⊂ Rd denote the d-dimensional open ball about the origin of radius a > 0.
Px denotes the law of a Brownian motion Bt started at x. For a bounded Borel set A,
σA denotes the ﬁrst hitting time of A by Bt, namely σA = inf{t > 0 : Bt ∈ A}, and Ar
the set of all regular points of A, namely the set of y such that Py[σA = 0] = 1. Put
RA = sup{|z| : z ∈ Ar}. The set ΩA is then deﬁned by

ΩA = {x ∈ Rd : Px[σ∂U (R) < σA] > 0}

with any R > RA, and the transition density pA

t (x, y), x, y ∈ ΩA by

pA
t (x, y) = Px[Bt ∈ dy, σA > t]/|dy|,

where | · | designates the Lebesgue measure on R2. (Readers may refer to [1] (Section 2.4)
for the existence and the properties of pA
t (x, y).) The set Ar is Borel and A \ Ar is polar, so
that Px[σA = σAr ] = 1 and Px[Bσ(A) ∈ Ar|σA < ∞] = 1 for all x (see e.g. [1], [2]). Denote by
nbdε(Ar) the open ε-neighborhood of Ar in Rd. The expression x /∈ nbdε(Ar) is understood
to be an abbreviation for x ∈ ΩA \ nbdε(Ar).
Let d = 2 and eA(x) be the Green function for ΩA with a pole at inﬁnity normalized so
that it agrees with lg x (where x := |x| > 1) when A is a unit disc (see (11) for a deﬁnition).
The following theorem is stated only in the case x ≤ y which gives rise to no loss of generality,
for pA

t (x, y) is symmetric in x and y as is well known (cf. e.g., [1], [3]).

Theorem 1. Let d = 2. For any M > 1 and ε > 0, uniformly for x, y /∈ nbdε(Ar) with

2

x ≤ y < Mt, as t → ∞

pA
t (x, y)
p(2)

t (y − x) ∼




4eA(x)eA(y)

(lg t)2

2eA(x)
lg(t/y)
1

if

if

if

y ≤ √t,
y > √t, xy ≤ t and y/t → 0,
xy ≥ t and x → ∞.

(4)

The function eA agrees with u appearing in (1) (a veriﬁcation is given in [4]), so that

Theorem 1 improves (1) by extending the range of validity to the regime x∨ y < M√n. The
condition x, y /∈ nbdε(Ar) can be relaxed to x, y ∈ ΩA under some regularity condition on
∂A (smoothness is suﬃcient), but not in general.
The case when y > δt and x < 1/δ for a constant δ > 0 is excluded from the condition
x ≤ y < Mt in Theorem 1. In this case relation (4) breaks down without the condition
y/t → 0 (in the second case) or x → ∞ (in the third): in fact the second and third relations
in (4) the right side is complemented by the following result: there is a continuous function
cA(x; v) taking values in (0, 1) such that under the constraints y ≍ t and x ≍ 1, as t → ∞

t (x, y) ∼ cA(x; y/t) p(2)
pA

t (y − x)

(Proposition 2.1), which combined with Theorem 1 in particular entails that if t > 1, x, y /∈
nbdε(Ar) and x ∨ y < Mt and xy > t/M, then
t (x, y) ≍ p(2)
pA

t (y − x).

(5)

Here the expression f (t) ≍ g(t) means that the ratio f (t)/g(t) is bounded away from both
zero and inﬁnity (provided that f (x)g(x) > 0). Relation (5) is a lower bound since the
upper bound is trivial and virtually follows if we show it with A replaced by a disc U(a) that
includes A.

Let e = (1, 0), the ﬁrst coordinate vector of R2. The next theorem provides upper and
lower bounds for each x, y and t virtually in the case when A = U(a) and x ∨ y >> t. (Here
and in the sequel the expression a << b, used in informal expository passages, means b is
much larger than b in a vague sense.) We have only to consider y = −ye. Write x = (x1, x2)
and if x1 > 0, put

ρ =

x1

,

x1 + y

If x ≥ a(1 + δ), 1 < t < δy for a positive constant δ and either x1 ≤ 0 or |x2| ≥ a, then (5)
is true as is readily shown (see proof of Lemma 3.2), and we concentrate on the case when
x1 > 0 and |x2| < a.
Theorem 2. Let d = 2, t > a2, x ≥ a(1 + δ) and x ≤ y. Suppose y = −ye, x1 > 0 and
0 ≤ x2 < a.

(i) For each δ > 0, (5) holds if A ⊂ U(a), x /∈ U(a(1 + δ)) and

ρt ≥ δ ∧ (a − x2)2;

(ii) For any δ > 0 there exist constants c′ = c′δ and c′′ = c′′δ (depending only on δ) such

that if x /∈ U(a + δ√ρt ) and a − x2 ≥ δ√ρt, then
pU (a)
t
p(d)

exp(cid:26) − k(x)(cid:16) a − x2√ρt

+ δ(cid:17)2(cid:27) ≤

c′′ √ρt
a − x2

(x, y)

t (x − y) ≤

c′ √ρt
a − x2

exp(cid:26) − k∗(x)

(a − x2)2

ρt

(cid:27)

3

with some (universal) functions k(x) and k∗(x) that satisfy

√2 − 1

2

< k∗(x) <

1
2

< k(x) < 1,

lim
x1→∞

k(x) = lim
x1→∞

k∗(x) = 1
2 .

Higher dimensional analogues of Theorems 1 and 2 will be given in Sections 2.4 and 3.3,

respectively, the proofs being almost the same as for the two dimensional case.
Remark 1. In the regime x ∨ y = O(t) the asymptotic behavior of pA
t (x, y) is almost the
same as that of pU (a)
(x, y) if x∧y is large enough that eA(x) and eA(y) are well approximated
by lg x and lg y, respectively. The situation becomes quite diﬀerent when (x ∨ y)/t → ∞:
e.g., if the length of preA (the projection to the line perpendicular to e) is zero and ∂A is
smooth, then pA
t (x, ye) ∼ pt(ye− x) as y/t → ∞ for all x ∈ ΩA \ nbdε(Ar), while if it is not
zero, statements analogous to (ii) of Theorem 2 may be advanced.

t

In [4] Collet, Martinez and Martin use the compactness argument as a basic method of
as given

the proof, by employing the Harnack inequality and the classical expression of pU (1)
in [5] to obtain a proper upper bound of pA.

t

Our approach is quite diﬀerent. If restricted to the ﬁrst case of (4), our proof is based

on the upper bounds

Px[σU (1) ∈ dt, Bt ∈ dξ]

dt|dξ|

C

t lg t

≤

(1 < x < √t , dξ ⊂ ∂U(1))

(|dξ| designates the length of dξ) and

Px[σU (1) < t] = o(1)

if (and only if)

lim inf

lg x
lg t ≥

1
2

(6)

(7)

(as t, x → ∞) and the following relation: for each ε > 0, uniformly for x ∈ U(r)\nbdε(Ar),

Px[σ∂U (r) < σA] =

eA(x)
lg r

(1 + o(1))

as

r → ∞.

(8)

t (x, y) ∼ p(2)

Relations (6), (7) and (8) are taken from [9], [11] and [12], respectively. Roughly speaking

we ﬁrst obtain, by using (6) and (7), the formula of (4) under the condition x ∼ y ∼ √t/ lg t,
which signiﬁes that the Brownian bridge that connects x and y visits A with so small a
probability that pA
t (0) in this speciﬁc situation. Next we consider the case
x << y and y ∼ √t/ lg t and the event that the process starting at x escapes A before exiting
the disc U(√t/ lg t) with the exiting time = o(t). Formula (8) says that the probability of
this escape from A is asymptotic to eA(x)/ lg √t, which fact combined with the preceding
t (0). For the case x ∨ y << √t/ lg t, we have only
result shows pA
to apply the latter case result to the Brownian motion started afresh at the time of exiting
the disc U(√t/ lg t).

t (x, y) ∼ 2(lg t)−1eA(x)p(2)

The proofs for the other cases of (4) need some results from [11] and [12] in addition to

those mentioned above. The same method as described above applies to random walks.

The ratio on the left side of (4) equals

Px[Bs /∈ A for ≤ s ≤ t| Bt = y],

the probability that the Brownian bridge joining x and y in the time interval [0, t] avoids
A. Thus formula (4) may be considered as giving the asymptotic form of this provability.

4

In view of Theorem A.2 of Section 4 we have Px[σA > t] ∼ 2eA(x)/ lg t if lim sup lg x
lim sup lg(x∨y)

2, the right side of (4) is therefore asymptotic to

lg t ≤ 1

2. If

lg t ≤ 1

Px[σA > t]Py[σA > t],

(9)

the probability that two independent Brownian motions starting at x and y both avoid A
until the time t. Collet et al. [4] points out (for their case) that (1) is interpreted as stating
the coincidence of the asymptotic forms of these two probabilities for x and y restricted to
a compact set of ΩA. Formula (4) entails that this coincidence extends over the regime in
which lim sup lg(x∨y)
2 but not necessarily beyond it. It may be worth noting that since
the law of the Brownian Bridge is not aﬀected by a constant drift term, for any constant
vector v the transition density of the process B v
s := Bs + vs killed upon hitting A is given
by

lg t ≤ 1

pA
t (x, y)
p(d)
t (y − x)

p(d)
t (y − vt − x).

We separate Theorem 1 into three theorems corresponding to the three cases in (4),

namely cases x ∨ y ≤ √t, xy ≤ t and xy > t, and deal with them in Sections 2.1, 2.2 and
2.3, respectively. The problem in the higher dimensions d ≥ 3, the result corresponding
to Theorem 1 and its proof being much simpler, will be brieﬂy discussed in Section 2.4.
Theorem 2 is proved in Section 3. The higher dimensional result for it is given in Section
3.3; the result itself somewhat diﬀers from the two dimensional one although its proof is
similar. In Section 4 we collect the results from [9], [10], [11] and [12] that are applied in
this paper.

2 Asymptotic forms in the regime x ∨ y = O(t)
For x ∈ ΩA, deﬁne

HA(x, t; dξ) =

Px[Bσ(A) ∈ dξ, σA ∈ dt]

dt

(dξ ⊂ ∂A, t > 0),

(10)

the hitting distribution of A in space-time, which in addition to the things introduced in
Section 1 will be of fundamental use throughout the rest of the paper.

Let d = 2. The function eA(x), x ∈ ΩA may be deﬁned by

eA(x) = π lim
|y|→∞

gΩA(x, y),

(11)

where gΩA(x, y) =R ∞
t (x, y)dt (x, y ∈ ΩA), the Green function for the set ΩA; in particu-
lar eA is harmonic in the interior of ΩA. Let err∗(x, t) stand for any function satisfying that
err∗(x, t) = 0 if x := |x| ≥ 2RA and

0 pA

|err∗(x, t)| ≤ CPxhσA∪∂U (2RA) > √t/ lg ti

if x < 2RA. It is noted that the right side above is dominated by Ce−λ√t/R2
universal constant λ > 0 (∗ is attached to distinguish from the notation err(x, t) of [12]).
We denote the points of Rd by x, y, and z and their Euclidean norm by x, y and z,
respectively. Except for a few occasions d is supposed to be equal to two and we simply

A lg t with a certain

5

t (x) and pt(x) for p(d)

write pt(x) for p(2)(x); if the higher dimensions d ≥ 3 are involved, the super script (d) is
never dropped. We often write p(d)
t (|x|) and pt(|x|), respectively, for
convenience sake; also write σ(A) for σA for typographical reason; x ∨ y and x ∧ y denote
the maximum and minimum of real numbers x, y, respectively.
2.1 The case x ∨ y = O(√t ), d = 2
Theorem 3. For any M > 1, uniformly for x, y ∈ ΩA subject to the constraint x∨y < M√t,
as t → ∞
pA
t (x, y) =

The following theorem reﬁnes the ﬁrst case of (4).

4eA(x)eA(y)

pt(y − x)(cid:18)1 + O(cid:18)lg lg t

lg t (cid:19)(cid:19) + err∗(x, t) + err∗(y, t).

(lg t)2

(12)

The proof of this theorem will be given at the end of this subsection after showing Lemmas
2.1 and 2.2. Lemmas 2.1 and 2.2 improve the ﬁrst relation of (4) by giving error estimates

and extending the range of validity of the formula beyond the restriction x ∨ y < √t. In

order to include the improvement we shall apply certain reﬁned versions of (6), (7) and (8);
if restricted to the ﬁrst relation of (4), we do not need such reﬁned ones. We suppose d = 2
throughout this subsection unless stated otherwise explicitly.
Lemma 2.1. For any M ≥ 1, as x ∧ y ∧ t → ∞ under the constraints lg x ∼ lg y ∼ 1
and xy ≤ Mt,

2 lg t

pA

t (x, y) = pt(y − x)(cid:20)1 + O(cid:18) 1

lg th1 ∨ lg

t

x2 ∧ y2i(cid:19)(cid:21).

Proof. This proof rests on the identity

pt(y − x) − pA

t (x, y) =Z t

0

dsZ∂A

HA(x, s; dξ)pt−s(y − ξ),

or, what it obviously entails,

pt(y − x) − pA

t (x, y) ≤Z t

0

dsZ∂U (RA)

HU (RA)(x, s; dξ)pt−s(y − ξ).

(13)

(14)

Let I[a,b] denote the latter integral above restricted to the interval [a, b], 0 ≤ a < b ≤ t.
Suppose RA = 1 for simplicity. Let xy < Mt. We may suppose x ≤ y, so that x < √Mt.
On noting pt−s(y − ξ) ≤ Cpt(y) (ξ ∈ ∂U(1), s < t/2),

We deduce from Theorem A.2 of Section 4 (with U(1) in place of A) that if lg x ∼ 1

2 lg t

I[0,t/2] ≤ Cpt(y)Px[σU (1) ≤ t/2].

Px[σU (1) ≤ t/2] ≤

C[1 ∨ lg(t/x2)]

lg t

;

we also have pt(y) ≤ pt(y − x)e2M . Putting these together we obtain

I[0,t/2] ≤ Ce2M 1 ∨ lg(t/x2)

lg t

pt(y − x).

(15)

6

For the other part I[t/2,t] we apply Theorems A.1 and A.4 to see that if lg x ∼ lg y ∼ 1
then

2 lg t,

pt−s(y − ξ)ds.

I[t/2,t] ≤

Cpt(x)

lg t Z∂U (1) |dξ|Z t

t/2

Observing for r > 0

Z t

t/2

pt−s(r)ds =

we infer that

1

2π Z ∞

r2/t

e−u
u

du ≤ Che−r2/t ∨ lg

t

r2i ≤ C′e−r2/th1 ∨ lg

t

r2i,

I[t/2,t] ≤ CeM pt(y − x)

1 ∨ lg(t/y2)

lg t

.

(16)

Combined with (15) this concludes the proof of the lemma.

Lemma 2.2. For M ≥ 1, if x /∈ Ar, x < M√t/ lg t, y < M√t and lg y ∼ 1

2 lg t, then

pA
t (x, y) =

2eA(x) + err∗(x, t)

lg t

pt(y)(1 + o(1));

moreover if, in addition, y ≥ √t/(lg t)δ for some δ > 0, the error term o(1) above can be

replaced by

O((lg lg t)/ lg t).

Proof. Let x < r := M√t/ lg t, y < M√t and T := 2t/ lg t and decompose

pA

t (x, y) = ZZ[0,T ]×∂U (r)

+ ε(t, x, y),

Px[σ∂U (r) ∈ ds, σA > s, Bσ∂U (r) ∈ dξ ] pA

t−s(ξ, y)

(17)

where

It holds that

ε(t, x, y) =ZU (r)∩ΩA

Px[σ∂U (r) ∧ σA > T, BT ∈ dz] pA

t−T (z, y).

Px[σ∂U (r) ∧ σA > T ] ≤ Ce−λT /r2

[eA(x) + err∗(x, t)]

(18)

with some universal constant λ > 0. Indeed, this is trivial if x > RA for which eA(x) > lg 2,
whereas by applying strong Markov property at the time of the ﬁrst exit from U(2RA) ∩ ΩA
one readily verify, with the help of Theorem A.3, that for x ∈ U(2RA) \ Ar,
Px[σ∂U (r) ∧ σA > T ] ≤ Ce−λr2/T(cid:16)eA(x) + Px[σ∂U (2RA) ∧ σA > 1
2T ](cid:17)

(cf. [12](proof of Lemma 3.2)), showing (18). By y ≤ M√t we have

ry/t ≤ M 2/ lg t.

Then, noting pA

t−T (z, y) ≤ pt−T (y − z) ≤ cM pt(y) for z ≤ r, we observe

ε(t, x, y) ≤ c′M e−λT /r2

[eA(x) + err∗(x, t)]pt(y),

hence ε(t, x, y) is absorbed into the error terms since T /r2 ≥ M−2 lg t.

7

(19)

(20)

For s < T, ξ ∈ ∂U(r), by Lemma 2.1 we have

pA
t−s(ξ, y) = pt−s(y − ξ)(1 + o(1));

observing T|y − ξ|2/t2 ≤ 2M 2/ lg t, from (19) we deduce
pt−s(y − ξ) = pt(y)(cid:16)1 + O(cid:16) 1

lg t(cid:17)(cid:17).

On using Theorem A.3 of Section 4 as well as (18)

Px[σ∂U (r) < T ∧ σA] = Px[σ∂U (r) < σA] − Px[T < σ∂U (r) < σA]

eA(x) + err∗(x, t)

=

lg r

(cid:18)1 + O(cid:18) 1

lg r(cid:19)(cid:19).

(21)

(22)

(23)

Now the double integral in (17) may be written as

Px[σ∂U (r) < T ∧ σA] pt(y)(1 + o(1)) =

eA(x) + err∗(x, t)

lg r

pt(y)(1 + o(1)).

(24)

Since lg r = 1

2 lg t + O(lg lg t), this veriﬁes the ﬁrst half of the lemma.

If y ≥ √t/(lg t)δ, then in (21) o(1) can be replaced by O((lg lg t)/ lg t) according to
Lemma 2.1 (note by (19) we also have |y · ξ|/t ≤ ry/t = O(1/ lg t)). This permits replacing
o(1) by O((lg lg t)/ lg t) in (24), and thereby yields the required error bound.
Proof of Theorem 3. The case y ≥ x ≥ √t/ lg t is covered by Lemma 2.1 (see (53) in
Section 4 for the error arising from the replacement of eA(x) by lg x). If x ≤ y ≤ M√t/ lg t,

by Lemma 2.2 we see in the double integral in (17)

pA
t−s(ξ, y) = pA

t−s(y, ξ) =

2eA(y) + err∗(y, t)

lg t

pt(ξ)(cid:18)1 + O(cid:18)lg lg t

lg t (cid:19)(cid:19).

Since pt(ξ) = pt(0)(1 + O(1/(lg t)2)), we may write (17) as

2eA(y) + err∗(y, t)

pA
t (x, y) = Px[σ∂U (r) < T ∧ σA]

lg t (cid:19)(cid:19) + ε(t, x, y).
The evaluation of the term ε(t, x, y) given in (20) and that of Px[σ∂U (r) < T ∧ σA] in (23)
are valid (in the latter o(1) may be replaced by O(1/ lg t) as mentioned at the end of the
preceding proof). Thus we conclude the required relation of the Theorem 3. Finally in the
case x ≤ √t/ lg t ≤ y, we have xy ≤ Mt/ lg t, so that pt(y) = pt(y − x) + O(1/ lg t) and

pt(0)(cid:18)1 + O(cid:18)lg lg t

applying the second half of Lemma 2.2 ﬁnishes the proof.

lg t

2.2 The case xy = O(t), d = 2
Theorem 4. Let d = 2. For each M ≥ RA and ε > 0, uniformly for x /∈ nbdε(Ar) and y
subject to the constraints y > √t and xy < Mt, as y/t → 0 and t → ∞

pA
t (x, y) =

eA(x)
lg(t/y)

pt(y − x)(1 + o(1)).

(25)

8

Proof. The case when y/√t is bounded is covered by Lemmas 2.1 and 2.2 in conjunction.
Hence we suppose that y/√t → ∞ as well as y/t → 0 in addition to the constraint put in
the lemma. From xy < Mt it then follows that x/√t → 0 and x → ∞.
t (x, y) by computing the right side of
(13). Since Px[σA > t/2] ≤ CeA(x)/ lg t (see (27) below) and pt−s(y−ξ), ξ ∈ ∂A is O(pt/2(y))
for s > t/2, the integral restricted to [t/2, t] is negligible. Because of the condition y/t → 0,
pt−s(y − ξ) may be replaced by pt−s(y). It therefore suﬃces to identify the asymptotic form
of

We are to ﬁnd the asymptotic form of pt(y− x)− pA

Z t/2

0

pt−s(y)Px[σA ∈ ds].

We shall write J[a,b] for this integral restricted to an interval [a, b], 0 ≤ a < b ≤ t/2. Put

η = (t/y)2.

Then η → ∞ and η/t → 0 in our present setting. Expanding 1/(t− s) into the Taylor series
of s/t yields

pt−s(y) =

For any constant α > 1

1
1 − s

t

pt(y) exp(cid:26) −

s

2η(cid:18)1 +

s
t

+

s2

t2 + · · ·(cid:19)(cid:27).

(26)

J[αη,t/2] =Z t/2

αη

pt−s(y)Px[σA ∈ ds] ≤ 2pt(y)Z ∞

αη

e−s/2ηPx[σA ∈ ds]

≤ 2pt(y)Px[σA > αη]e−α/2.

Let x /∈ nbdε(Ar). Then Theorem A.2 entails that for each α′ > 0, uniformly for s > α′x2
(27)

Px[σA > s] =

2eA(x)

lg s (cid:20)1 + O(cid:18) 1

lg s(cid:19)(cid:21).

Note that the condition xy < Mt is written as x2 < M 2η and then deduce

J[αη,t/2]

pt(y) ≤ Ce−α/2 eA(x)

lg η

.

For 0 < δ < 1, using (27) we also deduce that

J[δη,αη]
pt(y) ≤ 2Px[δη < σA < αη] ≤

4eA(x)
(lg η)2 [lg(α/δ) + O(1)]

(28)

(29)

and

J[0,δη]
pt(y)

= Px[σA < δη](1 + O(δ)) =(cid:18)1 −

2eA(x)
lg(δη)

(1 + o(1))(cid:19)(1 + O(δ)).

Now we take δ = (lg η)−2, for which lg(δη) ∼ lg η and (29) is still valid. Then, since x2 < M 2η
and α in (28) may be arbitrarily large, we obtain

2eA(x)

J[0,t/2] =(cid:18)1 −

(1 + o(1))(cid:19)pt(y).
Remembering that the left side equals pt(y−x)−pA
t (x, y)−J[t/2,t] and J[t/2,t] is negligible, we
conclude (25), for if x2/η → 0 (namely, xy/t → 0), then pt(y) ∼ pt(y−x), whereas if x2 > α′η
for some constant a′ > 0, then 2eA(x)/ lg η → 1, so that J[0,t/2] = o(pt(y)) = o(pt(y − x)).
The proof of Theorem 4 is complete.

(30)

lg η

9

2.3 The case xy > t/M , d ≥ 2
Theorem 5. Let d ≥ 2. For each M ≥ 1, uniformly for x and y subject to the constraint
xy > t/M and x ∨ y < Mt, as x ∧ y ∧ t → ∞
t (x, y) = p(d)
pA

t (y − x)(1 + o(1)).

For the proof we need the following

Lemma 2.3. Let d ≥ 2. If (x + z)z > t > 1 and 0 < θ < 1, then for a universal constant C,

s (x)p(d)
p(d)

t−s(z)ds ≤ Cθ−d/2p(d)

t (x + z)(cid:18) x + z

tz (cid:19)νs t

(x + z)z

,

θt

Z t
2d − 1.

where ν = 1

Proof. The computation is based on the identity

s (x)p(d)
p(d)

t−s(z) = p(d)
t (z − x)p(d)
s (x) is written for p(d)

T (cid:16) t − s

t

x +

s
t

z(cid:17)

(31)

t (x)). Our task will be to evaluate the

where T = (t − s)s/t (recall p(d)
integral
T (cid:16)t − s

J :=Z t

p(d)

θt

t

t

z(cid:17)ds =Z t

θt

s
t

T (cid:16)t − s

x +

p(d)

from above. Choose the directions of x and z so that z is a negative multiple of x; the value
is unaltered by this choice, for so is the left side of (31). Then p(d)
t (x + z) and
the integrand becomes p(d)

(x − z) + z(cid:17)ds
t (z − x) = p(d)
t (x + z) − z(cid:17), so that after substitution of t − s = u

T (cid:16) t−s
J =Z (1−θ)t
Write the identity R ∞
0 exp{− 1
Z ∞
2 d − 1 and Kν is the usual modiﬁed Bessel function of order ν. Then,

T (cid:16) u
(x + z) − z(cid:17)du, T =
2 α2u − 1
2β2u−1}u−ν−1du = 2(α/β)νKν(αβ) (cf. [6], p.146) as

p(d)
u (αu − β)du = 2(2π)−d/2(α/β)νKν(αβ)eαβ,

where αβ > 0, ν = 1
noting θu < T < u, we have

u(t − u)

p(d)

(32)

t

t

.

0

0

1

p(d)

θd/2 Z ∞
u (cid:18)x + z
J ≤
2πθ(cid:19)d/2(cid:18)x + z
tz (cid:19)ν
= 2(cid:18) 1

u − z(cid:19)du
Kν(cid:18) (x + z)z

t

t

0

(cid:19)e(x+z)z/t.

(33)

Combining with the following asymptotic formula:

(for every ν ≥ 0) (cf. [7]) this yields the desired result.

Kν(η)eη ∼pπ/2η

as

η → ∞

10

Proof of Theorem 5. Let RA = 1 and 1 < y ≤ x < Mt. We evaluate the diﬀerence
t (x, y) by means of (14). As before the integral in (14) restricted on [a, b] is

pt(y − x) − pA
denoted by I[a,b].

Let d = 2. Using Theorems A.1 and A.4 (of Section 4) we have

I[t/4,t] = Z t

t/4

dsZ∂U (1)

HU (1)(x, s; dξ)pt−s(y − ξ)

≤

CeM

1 ∨ lg(t/x)Z∂U (1) |dξ|Z t

t/4

ps(x)pt−s(y − ξ)ds.

We apply Lemma 2.3 with z = y − ξ. Noting pt(y − ξ − x) ≤ Ce2M pt(y − x) we deduce the
bound

I[t/4,t]

pt(y − x) ≤

cM

1 ∨ lg(t/x)r t

xy

,

(34)

Let y → ∞ and xy > t. Then, by considering each case of t/x being bounded from below
or not, we infer that the right side above approaches zero. For s ∈ [0, t/4] and ξ ∈ ∂U(1),
we have pt−s(y − ξ) ≤ Cpt(y), and using Theorem A.2 we deduce

I[0,t/4] ≤ Cpt(y)Px[σU (1) < t/4] ≤ cM pt(y)

1

1 ∨ lg(t/x)

t
x2 e−2x2/t.

Since x2 ≥ t and pt(y)e−2x2/t = e−y2/2tpt(2x) ≤ e−x2/2tpt(x + y), we obtain

I[0,t/4] ≤

cM

1 ∨ lg(t/x)

e−x2/2tpt(x + y).

(35)

Thus I[0,t/4] is negligible and for d = 2, the assertion of the theorem follows.
For d ≥ 3 we apply Theorem A.1 to see that Px[σU (1) < t] ≤ Cx−2t−νp(d)

and the same arguments as above yield

t (x− 1) if x2 ≥ t

I[t/4,t]

p(d)

t (y − x) ≤

cM

yν (cid:18) x

t(cid:19)νr t

xy

and

I[0,t/4]
t (x + y) ≤
p(d)

cM
tν e−x2/2t

in place of (34) and (35), respectively. The right sides tending to zero in both inequalities
above, the theorem is thus proved.

2.4 The higher dimensions I

Let d ≥ 3 and put

uA(x) = Px[σA = ∞].

Theorem 6. Let d ≥ 3. For each ε > 0, uniformly for x, y /∈ nbdε(Ar), as t → ∞ and
(x ∨ y)/t → 0
(36)
moreover for each M ≥ 1, this equality still holds true as t → ∞ and x ∧ y → ∞ under the
constraint M−1t < x ∨ y < Mt.

t (x, y) = uA(x)uA(y)p(d)
pA

t (y − x)(1 + o(1));

11

Under the additional restriction xy > t the assertion of Theorem 6 follows from Theorem
5. The other case xy ≤ t is easily disposed of by examining the proofs of Lemmas 2.1 and
2.2. Indeed in the proof of Lemma 2.1 (assuming x ≥ y diﬀerently from therein) we obtain
that if 1 < y ≤ √t ≤ x ≤ t, then

I[0,t/2] ≤ Cx−(d−2)p(d)

t (y − x)

in place of (15) since Px[σU (1) < t/2] ≤ Px[σU (1) < ∞] = 1/xd−2 and

latter). Thus

I[t/2,t] ≤ Cy−(d−2)p(d)

t (y − x)
in place of (16) owing to Theorems A.1 and A.4 (observe R t/2
t (y − x)(1 + o(1))
if x ∧ y → ∞ under xy ≤ t. The case when x ∧ y < M is now easily dealt with by looking
at (17) with r suitably chosen so that r → ∞ subject to (x ∨ y)r < Mt, and arguing as in
the proofs of Lemma 2.2 and 2.3. This shows Theorem 6.
In (36) the error estimate of the order o(t−η) with some η > 0 in place of o(1) can be

p(d)
s (r)ds ≤ Cr−(d−2) for the

t (x, y) = p(d)
pA

0

derived in a way analogous to the proof of Theorem 3.

2.5 Case y ≍ t and x = O(1), d ≥ 2
Here we consider the case when x ∨ y ≍ t and x ∧ y = O(1), which eludes the results stated
so far.

Proposition 2.1. Let d ≥ 2. For each ε > 0 and M > 1, uniformly for x ∈ ΩA \ nbdε(Ar)
and v ∈ Rd \ {0} satisfying x < M and ε < |v| < M, as t → ∞ and y/t → v

where cA(x; v) is jointly continuous in x, v, positive and less than unity.

t (x, y) ∼ cA(x; v)p(d)
pA

t (y − x),

The next lemma provides a lower bound, which we need for the proof of Proposition 2.1.

It also prepares for the proof of Lemma 3.2 of the next section.

Lemma 2.4. For any 0 < δ < 1 and M > 1, there exists a constant c = cδ,M such that if
δt < RAy < Mt, x < MRA and x /∈ nbdRAδ(Ar), then pA
Proof. Suppose RA = 1. By the conditions x /∈ nbdδ(Ar) and x < M we have pA
s (ξ, x) >
c′ = c′δ,M for 1 < s < 2, ξ ∈ U(1 + δ). Hence, putting qa(y, t; a) = Py[σU (a) ∈ dt]/dt, we have

t (x, y) ≥ cp(d)

t (y − x).

q(y, t − s; 1 + δ)

inf

pA
s (x − ξ)

pA

t (x, y) ≥ Z t

0

≥ c′δ,MZ 2

1

ξ∈∂U (1+δ)
q(y, t − s; 1 + δ)ds.

But by δt < y < Mt we have q(y, t − s; 1 + δ) ≥ c′′p(d)
x < M according to Theorem A.1. Thus the lemma is veriﬁed.

t (y) ≥ c′′′p(d)

t (y − x) for s < 2 and

12

Proof of Proposition 2.1. In [12] it is shown that there exists a measure λA

∂A such that λA

v (dξ) depends on v continuously, the total measure λA

v (dξ) on
v (∂A) is positive, and

(37)

(cid:12)(cid:12)(cid:12)(cid:12)

HA(y, t;·)
t (y)Λν(y/t) − λA
p(d)

v (·)(cid:12)(cid:12)(cid:12)(cid:12)t.var −→ 0

(as y/t → v, t → ∞), where Λν(y/t) is given by (52) and | · · ·|t.var designates the total
variation of a signed measure. Using this formula we are to compute the integral on the
right side of (13) with x and y interchanged to show that for a constant c∗ > 0,

t (y − x).
To this end we ﬁrst see that this integral restricted to (0, t/2] is

p(d)
t (y − x) − pA

t (x, y) ∼ c∗ p(d)

(38)

Z t/2

0

dsZ∂A

HA(y, s : dξ)p(d)

t−s(x − ξ) ≤

C
td/2 Py[σA < t/2],

0 p(d)

hence negligible, for Py[σA < t/2] ≤ p(d)
t (y) × o(1), provided y ≍ t. For the rest of the
integral we recall identity (31) and consider the integral J in the proof of Lemma 2.3 with
θ = 1/2 and with x and z replaced by y and x − ξ (ξ ∈ ∂A), respectively. On putting
˜x = x− ξ , observe that the integral tends to concentrate on [t− tα, t] for any α ∈ (0, 1) and
u (cid:16)t−1(y − ˜x)u + ˜x(cid:17)du (provided that y ≍ t, x < M and ˜x 6= 0). As
is asymptotic to R ∞
T (cid:16) t − s

t|˜x| (cid:19)ν
(2π)d/2(cid:18)|y − ˜x|
t (˜x− y) = p(d)
t (y− x)e−y·ξ/t(1 + O(1/t)), we then readily

in (32) we derive an explicit expression of this integral, which immediately leads to

(cid:19)e−(y−˜x)·(x−ξ)/t.

Kν(cid:18)|y − ˜x||˜x|

t

Now apply formula (37). Noting p(d)
ﬁnd that formula (38) holds with

Z t

t/2

s
t

˜x(cid:17)ds ∼

p(d)

y +

t

2

c∗ =

e−v·x

Kν(|v|)Z∂A

Kν(|v||x − ξ|)

|x − ξ|ν

λA
v (dξ).

Thus, in view of Lemma 2.4, the asymptotic formula of the proposition holds true with
cA(x; v) := 1 − c∗ ∈ (0, 1).

3 Upper and lower bounds in the regime x ∨ y > t
Let e = (1, 0, . . . , 0) ∈ Rd and suppose y = −ye and x < y. Let x = (x1, x′), where
x1 = x · e ∈ R and x′ = prex := x − x1e. Given a > 0, put

W = Wa,e = {z ∈ Rd \ U(a) : z · e > 0,|prez| < a}

and, when x1 > 0,

ρ =

x1

y + x1

.

We shall be concerned almost exclusively with the case x ∈ W . For h ∈ R, put Lh =
{(h, z′) : z′ ∈ Rd−1}, the plane perpendicular to the vector e and passing through the point
he. We shall decompose pA

t (x, y) by means of the ﬁrst hitting of Lh for h ∈ [0, a].

13

We are primarily interested in the case when x1/y << 1 and we may replace ρ by x1/y in
all the result given below. Our choice above however is natural in view of the next lemma;
its proof implies that for 0 ≤ b < x1 < y, the ﬁrst hitting time of Lb by the Brownian motion
Bt started at x and conditioned to be in y(= −ye) at time t concentrates in a relatively
small interval about ρt with a high probability if ρ is small and (x1 − b)y/t is large. To make
the next lemma cover all the cases 1 < x1 < y, 1 < t < y its assertion is not strong like this.

Lemma 3.1. Let Yt be a (standard) linear Brownian motion and Tb its ﬁrst passage time
of b ∈ R. Let 0 < b < ℓ and put ρ = b/ℓ. Then for any δ > 0 there exists a constant cδ
depending only on δ such that if ρ ≤ 1/2 and bℓ > δt, then

P [ 1

2ρt < Tb < ρt| Y0 = 0, Yt = ℓ] > cδ.

(39)

Proof. Let k = ℓ/t and T = (t − s)s/t. As in the proof of Lemma 2.3 the conditional
probability in (39) is written as

Denote this integral by J and observe that

Z ρt

ρt/2

p(1)
T (ks − b)

b
s

ds.

Changing the variable of integration by u = (k/b)s = s/ρt we have

.

b

ks − 2(cid:17)(cid:27) bs−3/2ds
p2π(1 − s/t)
u − 2(cid:17)(cid:27) u−3/2du
√1 − ρu

1

.

J =Z ρt

ρt/2

exp(cid:26) −

kb

2(1 − s/t)(cid:16) k

b

s +

J =

√kb
√2πZ 1

1/2

exp(cid:26) −

kb

2(1 − ρu)(cid:16)u +

Since u + u−1 − 2 = (1 − u)2/u ≤ 2(1 − u)2 for u > 1/2, we conclude that J > cδ if
kb = bℓ/t > δ and ρ < 1/2 as desired.

In the sequel we suppose t ≥ a2 and let cδ, c′δ, c′′δ etc. denote constants that depend only

on δ and d and may vary in each occurrence of them.

3.1 A lower bound for the case ρt > 1, d ≥ 2
Lemma 3.2. For any δ > 0, there exists a constant cδ such that if x > (1 + δ)a and if either
x /∈ W or x ∈ W with ρt > a2δ, then pU (a)
Proof. Suppose x ∈ W and x > (1 + δ)a with ρt > a2δ, the case x /∈ W being easier (see
Proposition 3.2 if necessary). We can also suppose x1 > 2a, for otherwise we have 2t ≥ δay
so that the result follows from Lemma 2.4. Let La = {(a, z′) : z′ ∈ Rd−1}. For simplicity we
suppose x′ = 0 and ρ < 1/4, entailing in particular p(d)
t (y + x1) and 2ρt < t/2.
Make decomposition

t (y − x) = p(d)

(x, y) ≥ cδ p(d)

t (y − x).

t

pU (a)
t

(x, y) =Z t
0 ZLa

pU (a)
t−s (ξ, y)Px[Bσ(La) ∈ dξ, σLa ∈ ds],

(40)

and note that

Px[Bσ(La) ∈ dξ, σLa ∈ ds]/ds = µx1−a(ds)P [B′s ∈ dξ′ | B′0 = 0]

(ξ = (a, ξ′))

(41)

14

where B′
is a d− 1 dimensional Brownian motion and µr(ds) denotes the distribution of the
·
ﬁrst passage time of r for the linear Brownian motion started at the origin. Owing to the
assumption ρt/a2 > δ, there exists a constant c′δ > 0 such that

P [2a < |B′s| < 4√t| B′0 = 0] > c′δ

It also holds that if s < 2ρt(< t/2) and 2a ≤ |ξ′| < 4√t,
t−s(y + a)p(d−1)

t−s(y − ξ) = c p(1)

pU (a)
t−s (ξ, y) > c p(d)
for some c, c′ > 0. Hence

if

2−1ρt < s < 2ρt.

t−s (ξ′) ≥ c′p(1)

t−s(y + a)p(d−1)

t

(0)

(x, y)

pU (a)
t
p(d)

t (y − x) ≥

t

(0)

c′′δ p(d−1)
p(d)

t (y + x1)Z 2ρt
2ρt < Tx1−a < 2ρt| Y0 = 0, Yt = y + x1]

p(1)
t−s(y + a)µx1−a(ds)

ρt/2

= c′′δ P [ 1
> c′′′δ ,

where the notation and the assertion of Lemma 3.1 are used for the conditional probability
expression and the last inequality, respectively. This concludes the proof.

3.2 Proof of Theorem 2

Theorem 2 follows immediately by combining Propositions 3.1 and 3.2 given below. (k(x) is

1 + (a − |x′|)2 − x1)x1.)

given by (50), while k∗(x) = (px2
Proposition 3.1. Let d = 2. For any δ > 0 there exists a constant cδ such that if x ∈ W ,
y > δt/a and a − |x′| ≥ δ√ρt, then
cδ√ρt
a − |x′|

(cid:27).
Proof. Let L = {(0, ξ′) : ξ′ ∈ Rd−1}, the vertical axis of the plane. Then,

exp(cid:26) − px2

1 + (a − |x′|)2 − x1)x1

t (x − y) ≤

pU (a)
t
p(2)

(x, y)

ρt

pU (a)
t

(x, y) ≤ Z t
≤ Z t

0

p(2)
t−s(y − ξ)Px[Bσ(L) ∈ dξ, σL ∈ ds]

0 ZL\U (a)
p(2)
t−s(y)Px[Bσ(L) ∈ L \ U(a), σL ∈ ds],

(42)

where we have used |y − ξ| ≥ y (ξ ∈ L) for the second inequality. Note that

x1
Px[Bσ(L) ∈ L \ U(a), σL ∈ ds]/ds =
s
· denotes the second component of Bt, and

where B′

p(1)
s (x1)Px[|B′s| > a],

Px[|B′s| > a] ≤ P0h|B′s| > a − |x′|i ≤ C1

√s

a − |x′|

e−(a−|x

′|)2/2s.

(43)

Then, putting b =px2

1 + (a − |x′|)2, we have
x1
pU (a)
t

(x, y) ≤ C2

a − |x′|Z t

0

15

p(2)
t−s(y)p(2)

s (b)ds.

(44)

t−s(y)p(2)

By (31) p(2)
that b < cδy/t, and we see that the integral in (44) restricted on [t/2, t] is negligible (in fact
for any α > 0, that on [α, t] is negligible). On the other hand by (32) we have

T ([(y + b)/t]s− b). The condition a−|x′| ≥ δ√ρt entails

t (y + b)p(2)

s (b) = p(2)

Z t/2

0

Note that

p(2)
t−s(y)p(2)

s (b)ds ≤ Cp(2)

t (y + b)K0(cid:16)b(y + b)

t

(cid:17)eb(y+b)/t.

(45)

(y + b)2 − |x − y|2 = 2(b − x1)y + O(1) = 2(b − x1)(y + x1) + O(1)

and that since x1 ≥ a − |x′|,

x1(y + x1)/t = x2

1/ρt ≥ δ2.

Then, using the asymptotic formula K0(λ) ∼pπ/2λe−λ as (λ → ∞) together with x1/pb(y + b)/t ≤
√ρt, we conclude

(x, y)

e−(b−x1)(y+x1)/t,

pU (a)
t
p(2)

t (x − y) ≤ cδ

√ρt
a − |x′|

hence the assertion of the proposition since (y + x1)/t = x1/ρt.

(x, y)

pU (a)
t
p(2)

Proposition 3.2. Let d = 2. For any δ > 0 there exists a constant cδ such that if x ∈
W \ U(a + δ√ρt) and a − |x′| ≥ δ√ρt, then

t (x − y) ≥

exp(cid:26) − k(x)(cid:16) a − |x′|√ρt

+ δ(cid:17)2(cid:27)
2 < k(x) < 1 and limx1→∞ k(x) = 1
2.

cδ √ρt
a − |x′|
with a function k(x), x ∈ W such that 1
Proof. The proof is a modiﬁcation of the preceding one. For simplicity write x = (x1, x2).
We may suppose x2 ≥ 0. Let L be as in the preceding proof. Let u be the point of intersection
where the horizontal line {(η, a) : η ∈ R} meets the half line in the upper half plane that
is issuing from x and tangential to the circle ∂U(a). Let u1 be the ﬁrst coordinate of u (so
that u = (u1, a)) and L∗ be the shift of L by u1e: L∗ = Lu1 = {(u1, ξ2) : ξ2 ∈ R} (see Figure
1). We decompose pU (a)(x, y) by means of the ﬁrst hitting of L∗:

pU (a)
t

(x, y) =Z t

0 ZL∗\U (a)

pU (a)
s

(ξ, x)PyhBσ(L∗) ∈ dξ, σL∗ ∈ t − ds, σU (a) > t − si.

(Here the starting site is not x but y; this choice is made since our estimation of the
hitting distribution of L∗ under Px becomes crude as x gets close to ae.) For the present
purpose of obtaining a lower bound we restrict the range of integration to the square (s, ξ2) ∈
[0, 4ρt] × [a + δ√ρt, 2√t].

If Yt is a linear Brownian motion, then for each λ ∈ R, the conditional probability

P [Ys′ > 0, 0 ≤ s′ ≤ s|Y0 = η0, Ys = η] = 1 − e−2η0η/s

(η0 > 0, η > 0, s > 0)

(46)

is bounded away from zero if (and only if) so is y0y/s. ((46) is immediate from the expression
of transition density for Yt killed at the origin.) Using this fact we deduce that there exists
a constant c′δ such that

pU (a)
s

(ξ, x) ≥ c′δp(2)

s (x − ξ)

16

rr

y

L L∗

ξ
◗
u
◗
◗◗
✡
✡

qr
✬✩s
r
✫✪

x

0

✲

e

Figure 1: u is a point of intersection where the half line {(η, a) : η > 0} meets

a line passing through x and tangential to the circle ∂U(a).

for s ≤ 4ρt and ξ ∈ L∗ with ξ2 > a + δ√ρt. Hence

pU (a)
t

(x, y) ≥ c′δZ 4ρt

0

Z 2√t

a+δ√ρt

p(2)

s (x − ξ)PyhB′t−s ∈ dξ2, σL∗ ∈ t − ds, σU (a) > t − si,

(47)

where ξ = (u1, ξ2) and B′s denotes the second component of Bs. On considering the hitting of
the plane L−a if necessary, by the same reasoning as above (as well as the independence of two
components of B·) the condition σU (a) > t − s can be discarded from the probability in (47)
if the constant factor is replaced by a smaller one. Observe that for s < 4ρt, 0 < ξ2 < 2√t,

Py[B′t−s ∈ dξ2, σL∗ ∈ t − ds] ≥ c1

y
t

p(2)
t−s(y + u1)dξ2ds,

so that the inner integral of the repeated integral in (47) is bounded below by

c′′δ

y
t

p(2)
t−s(y + u1)p(1)

s (x1 − u1)Z 2√t

a+δ√ρt

p(1)
s (x2 − ξ2)dξ2.

Under the condition a − x2 + δ√ρt > δ√s, which is satisﬁed for s < 4ρt if a − x2 ≥ δ√ρt,

we have

Z 2√t

a+δ√ρt

and hence, putting

we have

pU (a)
t

c′′δ s

s (a − x2 + δ√ρt )

p(1)

a − x2 + δ√ρt

p(1)
s (ξ2 − x2)dξ2 ≥
b∗ :=q(x1 − u1)2 + (a − x2 + δ√ρt )2,
p(2)
t−s(y + u1)p(2)

a − x2 + δ√ρtZ 4ρt

(c′′′δ )y/t

(x, y) ≥

0

s (b∗)sds.

Using identity (31) we infer that the integral on the right side is bounded below by

p(2)

t (y + u1 + b∗)Z 4ρt

0

p(2)

s (cid:18)

1

√1 − 4ρ(cid:20)y + u1 + b∗

t

s − b∗(cid:21)(cid:19)sds.

(48)

The condition a−x2 > δ√ρt entails |x− u| < b∗ < 2|x− u| and a simple geometric argument

2x1 < |x − u| < 2x1. Obviously u1 + b∗ > x1 ≥ a − x2 and these together verify

leads to 1

1
2

x1 ≤ b∗ ≤ 4x1,

(y + u1 + b∗)b∗

t

≥ δ2

and

b∗t

y + u1 + b∗

< 4ρt.

17

Because of the last two inequalities the integral in (48) is comparable to the same integral
but with the range extended to the whole half line s > 0 (cf. proof of Lemma 3.1). We apply
the formula

Z ∞

0

p(d)

s (cid:18) z + b

t

s − b(cid:19)sds =

2

(2π)d/2(cid:18)z + b

tb (cid:19)ν−1

Kν−1(cid:18)(z + b)b

t

(cid:19)e(z+b)b/t

(ν = (d − 2)/2) with d = 2 (see (32)). Using K−1(λ) = K1(λ) ≥ cδe−λ/√λ for λ > δ we
infer that the integral in (48) is bounded below by a constant multiple of (t/y)ptb∗/y. Since
b∗ ≥ x1/2, we conclude that
pU (a)
t

p(2)
t (y + u1 + b∗).

cδ√ρt

(49)

(x, y) ≥

a − x2 + δ√ρt

Put

k(x) =

x1

.

(50)

Then

x1 − u1 +p(x1 − u1)2 + (a − x2)2
(y + u1 + b∗)2 − (y + x1)2 = 2y(b∗ − x1 + u1) + O(1) = 2y

(a − x2 + δ√ρt)2
x1 − u1 + b∗
(a − x2 + δ√ρt)2

,

+ O(1)

≤ 2k(x)

ρ

hence p(2)
with (49) yields the lower bound of pU (a)

t (y + u1 + b∗)/pt(y + x1) ≥ C exp{−k(x)(a − x2 + δ√ρt)2/ρt}, which combined
shows that (2x1)−1 < u1 ≤p(x1 − u1)2 + (a − x2)2 (with the equality only if |x| = a), hence

1
2 < k(x) < 1, which completes the proof.

(x, y) asserted in the lemma. Elementary geometry

t

3.3 The higher dimensions II

In higher dimensions d ≥ 3 there arises a diﬀerence in the estimation of the probability

Px[|B′s| > a] :

for small s this behaves diﬀerently depending on whether a|x′| is larger than s or not as is
exhibited in Lemma 3.3 below and we accordingly need to break the results into two cases.
Let k(x) be the function given in (50).

Theorem 7. Let y > t. For any δ > 0, there exist constants cδ > 0 and Cδ such that

(i) if x ∈ W \ U(a + δ√ρt), a − |x′| ≥ δ√ρt and a|x′| < ρt , then
cδ(cid:16) a
t (x − y) ≤ Cδ(cid:16) a
√ρt(cid:17)d−3
√ρt(cid:17)d−3
(ii) if x ∈ W \ U(a + δ√ρt), a − |x′| ≥ δ√ρt and a|x′| ≥ ρt, then

+ δ(cid:17)2(cid:27) ≤

pU (a)
t
p(d)

(x, y)

exp(cid:26) − k(x)(cid:16) a
√ρt
|x′|(cid:17)(d−1)/2 √ρt
cδ(cid:16) a

exp(cid:26) − k(x)(cid:16) a − |x′|√ρt

a − |x′|
pU (a)
t (x − y) ≤ Cδ(cid:16) a
t
≤
p(d)

(x, y)

+ δ(cid:17)2(cid:27)
|x′|(cid:17)(d−1)/2 √ρt
a − |x′|

18

e−(√x2

1+a2−x1)x1/ρt;

e−(√x2

1+(a−|x

′|)2−x1)x1/ρt.

a2µe−(r2+a2)/2s

Lemma 3.3. Let Xt be a Bessel process of order µ > −1 and Pr the probability law of X
started at r ≥ 0. Then for 0 ≤ r < a and 0 < s ≤ (a − r)2,
a2(cid:17)(cid:19)
(ar) ∧ (a − r)2(cid:17)(cid:19)

2µΓ(µ + 1)sµ (cid:18)1 + O(cid:16)a2r2
s2 ∨
r(cid:17)µ+1/2√s e−(a−r)2/2s
(cid:18)1 + O(cid:16)
(cid:16)a

Pr[Xs > a] =


Proof. Let Iµ be the modiﬁed Bessel function of the ﬁrst kind of order µ. Then

if ar ≥ s.

if ar < s,

a − r

s

s

where for r > 0,

Qs(r, η)dη,

(51)

a

Pr[Xs > a] =Z ∞
Iµ(cid:18) rη

r(cid:19)µ η

Qs(r, η) =(cid:18) η

s

s (cid:19)e−(r2+η2)/2s

and Qs(0, η) = limr↓0 Qs(r, η) (cf. [[8]). Substitution from the formula

2(cid:19)µ
Iµ(y) =(cid:18)z

1

Γ(µ + 1)

(1 + O(z2))

(0 < y < 1); =

ey
√2πy

(1 + O(1/y))

(y > 1),

yields for r < a < η and s < a2,

Qs(r, η) =


η2µ+1e−(r2+η2)/2s

2µΓ(µ + 1)sµ+1 (cid:18)1 + O(cid:18)(rη)2
s2 (cid:19)(cid:19)
r(cid:19)µ+1/2
rη(cid:19)(cid:19)
s (η − r)(cid:18)1 + O(cid:18) s
(cid:18)η

p(1)

if ar < s, η < 2a,

if ar ≥ s,

and an elementary computation of the integral in (51) leads to the formulae of the lemma.

Proof of Theorem 7. For both the upper and lower bounds the proofs of Propositions
3.1 and 3.2 are readily adapted. Indeed as for the proof of upper bound we have only to
apply Lemma 3.3 (with µ = (d − 3)/2) and the following inequality
Kν(cid:16) b(y + b)

t (y + b)(cid:16) y + b
bt (cid:17)ν

s (b)ds ≤ π−d/2p(d)

(cid:17)eb(y+b)/t

p(d)
t−s(y)p(d)

Z t

t

0

in place of (43) and (45), respectively, with the rest being virtually unchanged. A similar
remark is applied for the lower bound.

4 Hitting distributions

Here we collect several results from [10], [11] and [12], the original theorems which they

are taken or adapted from being indicated in the square brackets.

In the ﬁrst theorem we put ν = 1

2d − 1 and

Λν(y) :=

(2π) ν+1
2yνKν(y)

=

2π

4πu y2)e−πuuν−1du

R ∞
0 exp(− 1

19

,

y > 0,

(52)

where Kν is the modiﬁed Bessel function of the second kind of order ν. There exists Λν(0) :=
limy↓0 Λν(y) ≤ ∞; Λ0(y) ∼ −π/ lg y as y ↓ 0, whereas 0 < Λν(0) < ∞ for ν > 0.
Theorem A.1 [10, Theorem 2]. Uniformly for x > a, as t → ∞,

Px[σU (a) ∈ dt]

dt

t (x)(cid:20)1 −(cid:18) a

4π lg(x/a)

(lg t)2

x(cid:19)2ν(cid:21)
(x ≤ √t ),
(x > √t ),

t (cid:19)p(d)
∼ a2νΛν(cid:18) ax



∼ p(2)

t (x) ×

Λ0(cid:18) ax
t (cid:19)
Let d = 2 and ε > 0. Then, uniformly for x ∈

if d ≥ 3,

if d = 2.

Theorem A.2 [12, Proposition 6.7].
ΩA \ nbdε(Ar), as t → ∞ and x/t → 0
2eA(x)

(i)

Px[σA > t] =

(ii)

Px[σA ≤ t] =

lg t (cid:18)1 + O(cid:16) 1
2 lg(t/x)Z ∞

x2/2t

1

lg t(cid:17)(cid:19) for x ≤

e−yy−1dy(1 + o(1))

√t,
for x ≥pt/ lg t.

Of the results above Theorem A.1 and (i) of Theorem A.2 are applied in the proofs of
Proposition 2.1 and Theorem 5, respectively; for all the other applications we need only
the upper bounds implied by Theorem A.1 and (ii) of Theorem A.2; for the latter only the
special case when A is a disc (hence the assertion is essentially a corollary of Theorem A.1)
is relevant. It is noted that

eA(x) = lg(x/R) + Ex[eA(BσU (R))]

(x ≥ R ≥ RA)

(53)

(cf.

[12, Lemma 6.1]) and (i) provides a better estimate than (ii) in the range pt/ lg t ≤

x ≤ √t.
Theorem A.3 [12, Proposition 6.1]. Let d = 2. For r > RA and x ∈ ΩA ∩ U(r),

In the following two theorems ma denotes the uniform probability measure on ∂U(a).

Px[σ∂U (r) < σA] =

eA(x)

lg(r/RA)(cid:18)1 +

mRA(eA)
lg(r/RA)

(1 + δ)(cid:19)−1

(54)

A r + 1)−1 ≤ δ ≤ 2(R−1

with −2(R−1
Theorem A.4 [11, Theorems 2.2 and 2.3]. Let d ≥ 2. For v ≥ 0, as x/t → v and t → ∞,

A r − 1)−1. Here mR(eA) =R∂U (R) eA(ξ)mR(dξ).

Px[Bσ(U (1)) ∈ dξ | σU (1) = t]

m1(dξ)

=( 1 + O(ℓd(x, t)x/t)
ψv(Ryξ)(1 + o(1))

if

if

v = 0,

v > 0

(55)

uniformly for (ξ, v) ∈ ∂U(1) × [0, M] for each M > 1. Here ℓd(x, t) ≡ 1 for d ≥ 3 and

ℓ2(x, t) = (lg t)2/lg(2 ∨ x)

(x < √t); = lg(t/x)

√t);

(x ≥

ψv(ξ) is a continuous function of (v, ξ) ∈ [0,∞)×∂U(1) that is positive for v > 0 and ψ0 ≡ 1;
Ry denotes the rotation that sends y/y to the unit vector e = (1, 0, . . . , 0) and leaves the
plane spanned by e and y invariant.

20

References

[1] R. F. Bass, Probabilistic techniques in analysis, Springer, 1995

[2] R. M. Blumenthal and R. K. Getoor, Markov processes and potential theory, Academic

Press, 1968

[3] K. L. Chung and J. B. Walsh, Markov processes, Brownian motion, and time symmetry,

2nd ed., Springer, 2005.

[4] P. Collet, S. Martinez and J. Martin, Asymptotic behaviour of a Brownian motion on

exterior domains, Probab. Theo. Rel. F. 116 (2000), 303-116.

[5] H.S. Carslaw and J.C. Jaeger, Conduction of heat in solids, Clarrendon press, Oxford,

1992.

[6] A. Erd´elyi, Tables of Integral Transforms, vol. I, McGraw-Hill, Inc. (1954)

[7] N.N. Lebedev, Special functions and their applications, Prentice-Hall, Inc. (1965)

[8] D. Revuz and M. Yor, Continuous martingales and Brownian motion, 3rd ed., Springer.

1999.

[9] K. Uchiyama, Asymptotic estimates of the distribution of Brownian hitting time of a
disc., J. Theor. Probab., 25 (2012), 450-463. / Erratum, J. Theor. Probab. 25 (2012),
issue 3, 910-911 .

[10] K. Uchiyama, Asymptotics of the densities of the ﬁrst passage time distributions of

Bessel diﬀusion, Trans. Amer. Math. Soc. 367 (2015), 2719-2742.

[11] K. Uchiyama, Density of space-time distribution of Brownian ﬁrst hitting of a disc and

a ball, to appear in Potential Theory; available at: http://arxiv.org/abs/1404.4745v3

[12] K. Uchiyama, The Brownian hitting distributions in space-time of bounded sets and
the expected volume of the Wiener sausage for a Brownian bridge, available at:
http://arxiv.org/abs/1406.1307v3

21

