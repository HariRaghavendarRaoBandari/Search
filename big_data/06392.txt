6
1
0
2

 
r
a

 

M
1
2
 
 
]

.

A
C
h
t
a
m

[
 
 

1
v
2
9
3
6
0

.

3
0
6
1
:
v
i
X
r
a

LOCAL COMPARABILITY OF MEASURES, AVERAGING AND

MAXIMAL AVERAGING OPERATORS

J. M. ALDAZ

Abstract. We explore the consequences for the boundedness properties of averaging and
maximal averaging operators, of the following local comparabiliity condition for measures:
Intersecting balls of the same radius have comparable sizes. Since in geometrically doubling
spaces this property yields the same results as doubling, we study under which circumstances
it is equivalent to the latter condition, and when it is more general. We also study the concrete
case of the standard gaussian measure, where this property fails, but nevertheles averaging
operators are uniformly bounded, with respect to the radius, in L1. However, such bounds
grow exponentially fast with the dimension, very much unlike the case of Lebesgue measure.

1. Introduction

In the development of analysis in metric spaces, the doubling condition on a measure has
played a considerable role, cf. for instance [He], [HKST] and the references contained therein.
However, the existence of a doubling measure imposes severe restrictions on the growth of the
spaces under consideration: They must be geometrically doubling (of homogeneous type in
the terminology of [CoWe1], cf. Deﬁnition 2.7 below). This excludes many spaces of interest
such as, for instance, hyperbolic spaces, as well as several other manifolds with negative
curvature.

Hence, there have been eﬀorts to remove or at least weaken the doubling condition when-
ever possible. A considerable amount of work has been made in this area, regarding singular
integrals and Calder´on-Zygmund operators cf., for instance, [To] and the references contained
therein. Here we are interested in the boundedness properties of the Hardy-Littlewood max-
imal function deﬁned by a Borel measure µ. Good boundedness results appear to be related
to the following property, studied in this paper: Intersecting balls with the same radius have
a comparable size (cf. Deﬁnition 3.1 below for the precise statement). Since this hypothesis
does not apply (at least, not directly) to balls that fail to intersect, we shall say that µ satisﬁes
a local comparability condition, even though it applies to balls both large and small, and not
just to small balls.

The idea of using local comparabilitiy instead of doubling is suggested by [NaTa], where
this “uniformity condition” (as is called there, cf. p. 737) is combined with the notion of
microdoubling to deﬁne “strong microdoubling”. But local comparability by itself is worthy

2000 Mathematical Subject Classiﬁcation. 42B25.
The author was partially supported by Grant MTM2015-65792-P of the MINECO of Spain, and also by

by ICMAT Severo Ochoa project SEV-2015-0554 (MINECO).

1

2

J. M. Aldaz

of study, independently of any microdoubling conditions. In geometrically doubling spaces,
this more precise hypothesis yields the same results as doubling, and is sometimes equivalent
to it. But in general, it is satisﬁed by a wider class of measures.

A second source of interest comes from attempts to understand which factors inﬂuence
the size of bounds for averaging and maximal averaging operators. This leads us to consider
measures for which local comparability is missing. But even for a doubling measure, if one
is interested in quantitative aspects of the bounds, one may want to keep track of the local
comparability constant, which often will be much smaller than the doubling constant (for
instance, 1 and 2d for d-dimensional Lebesgue measure).

This paper is organized as follows.

In Section 2 we review some standard deﬁnitions
and facts, introducing also the terminology of blossoms. The r-blossom of a set is the just
its r-neighborhood, but we ﬁnd the new terminology more convenient when talking about
properties of measures. In particular, to carry out the usual Vitali covering argument, instead
of doubling it is enough to assume that the measure blossoms boundedly (cf. Deﬁnition 2.4
below).

It is natural to ask which properties of the measure determine, or have an inﬂuence, in
the behaviour of the bounds satisﬁed by averaging and maximal averaging operators.
In
this regard, Section 3 contains the deﬁnition of local comparability, and Section 4 considers
averaging operators when local comparability is missing. In general metric spaces, without
local comparability averaging operators may fail to be bounded for all p < ∞. Nevertheless, in
the special case of Rd with the standard gaussian measure, we show that supr>0 kArkL1→L1 ≤
(1 + o(1))(3/2)d. However, lack of local comparability makes itself felt in the fact that these
bounds grow exponentially fast with the dimension, for all 1 ≤ p < ∞. Using an argument
of A. Criado and P. Sj¨ogren, we show that for every p in [1,∞) and every d suﬃciently large,
the weak type (p, p) constants satisfy kA √3d−3

2 kLp→Lp,∞ > 1.019d/p.

In the case of Lebesgue measure in Rd, E. M. Stein showed that for the centered maximal
function M associated to euclidean balls, the best strong type (p, p) bounds are independent
of d, and hence of the doubling constant 2d ([St1], [St2], [StSt], see also [St3]). In fact, for

p ≥ 2, P. Auscher and M. J. Carro gave the explicit bound kMkLp→Lp ≤ (2+√2)2/p ([AuCa]).

Comparing the situation with the gaussian measure, we see that taking the supremum over
radii can have a much smaller impact on the size of constants than considering measures
without local comparability.

Stein’s result was generalized to the maximal function deﬁned using an arbitrary norm by
J. Bourgain ([Bou1], [Bou2]) and A. Carbery ([Ca]) when p > 3/2. For ℓq balls, 1 ≤ q < ∞,
D. M¨uller [Mu] showed that uniform bounds again hold for every p > 1 (given 1 ≤ q < ∞,
the ℓq balls are deﬁned using the norm kxkq := (|x1|q + |x2|q + · · · + |xd|q)1/q). Finally, in
[Bou3], Bourgain proved that for cubes (balls with respect to the ℓ∞ norm) the uniform
bounds hold for every p > 1. Since for cubes it is known that the weak type (1,1) constants
diverge to inﬁnity (cf. [A], and for the highest lower bounds currently known, cf. [IaSt]) this
is the only case where a fairly complete picture is available. Now if the local comparability
constant is a key factor here, then one would expect that maximal functions deﬁned using

Local comparability of measures

3

Lebesgue measure and diﬀerent balls, would all behave in a similar way, both regarding weak
and strong type constants. But I have made no progress in this direction.

Since in geometrically doubling metric spaces local comparability yields the same bound-
edness results as doubling, it is natural to enquire what to what extent the ﬁrst property is
more general than the second. This is done in Section 4, where among other results, it is
proven that for geometrically doubling spaces that are quasiconvex, or have the approximate
midpoint property, or where all the balls are connected, local comparability is equivalent to
doubling. In particular, this is the case for euclidean spaces. However, we shall also see that
there is an arc-connected, geometrically doubling metric space, with a non-doubling measure
satisfying a local comparability condition. Generally speaking, in spaces with poor conectiv-
ity properties, or with large gaps (as is often the case, for instance, with fractals), or where
the “intrinsic” and “ambient” metrics are not comparable, the two classes of measures can
be quite diﬀerent.

While the existence of a doubling measure imposes restrictions on the growth of the space,
this is not the case with local comparability, which is just a uniformity condition. It may well
be that local comparabity can yield positive results beyond geometrically doubling spaces,
but I have made no progress in this direction.

2. Notation and background material

We will use B(x, r) := {y ∈ X : d(x, y) < r} to denote open balls, B(x, r) to denote their
topological closures, and Bcl(x, r) := {y ∈ X : d(x, y) ≤ r} to refer to closed balls (consider
B(0, 1) in Z to see the diﬀerence).

Deﬁnition 2.1. We say that (X, d, µ) is a metric measure space if µ is a Borel measure on
the metric space (X, d), such that for all balls B(x, r), µ(B(x, r)) < ∞, and furthermore,
µ is τ -smooth. A Borel measure is τ -smooth if for every collection {Uα : α ∈ Λ} of open
sets, µ(∪αUα) = sup µ(∪n
i=1Uαi), where the supremum is taken over all ﬁnite subcollections
of {Uα : α ∈ Λ}.

In separable metric spaces, arbitrary unions of open sets can be reduced to countable unions,
so τ -smoothness is an immediate consequence of countable additivity; trivially also, all Radon
measures are τ -smooth. The hypothesis of τ -smoothness is rather weak, since it is consistent
with standard set theory (Zermelo-Fraenkel with Choice) that in every metric space, every
Borel measure which assigns ﬁnite measure to balls is τ -smooth (cf. [Fre, Theorem (a), pg.
59]). Thus, in standard mathematical practice we will never encounter an example where X
is metric and µ fails to be τ -smooth.

Deﬁnition 2.2. Let (X, d, µ) be a metric measure space and let g be a locally integrable
function on X. For each ﬁxed r > 0 and each x ∈ X such that 0 < µ(B(x, r)), the averaging
operator Ar,µ is deﬁned as

(1)

Ar,µg(x) :=

1

µ(B(x, r))ZB(x,r)

gdµ.

4

J. M. Aldaz

In addition, the centered Hardy-Littlewood maximal operator Mµ is given by

(2)

Mµg(x) := sup
r>0

Ar,µ|g|(x),

while the uncentered Hardy-Littlewood maximal operator M u

µ is deﬁned via

(3)

M u

µ g(x) :=

sup

{r>0,y∈X: d(x,y)<r}

Ar,µ|g|(y).

According to our convention, averaging operators are deﬁned almost everywhere (since by
τ -smoothness the complement of the support has measure zero) while maximal operators
are deﬁned everywhere, for given any x ∈ X there exists an r > 0 such that µB(x, r) > 0.
Also, maximal operators can be deﬁned using closed balls instead of open balls, and this does
not change their values, since open balls can be approximated from within by closed balls,
and closed balls can be approximated from without by open balls. When the measure is
understood, we will omit the subscript µ from Ar,µ, Mµ, and M u
µ .

For a given p with 1 ≤ p < ∞, an operator T satisﬁes a weak type (p, p) inequality if there

exists a constant c > 0 such that

µ({T g ≥ α}) ≤(cid:18)ckgkLp(µ)

α

(cid:19)p

,

(4)

(5)

(6)

(7)

where c = c(p, µ) depends neither on g ∈ Lp(µ) nor on α > 0. The lowest constant c
that satisﬁes the preceding inequality is denoted by kTkLp→Lp,∞. Likewise, if there exists a
constant c > 0 such that

kT gkLp(µ) ≤ ckgkLp(µ),

we say that T satisﬁes a strong type (p, p) inequality. The lowest such constant (the operator
norm) is denoted by kTkLp→Lp.
Deﬁnition 2.3. A Borel measure µ on (X, d) is doubling if there exists a C > 0 such that
for all r > 0 and all x ∈ X, µ(B(x, 2r)) ≤ Cµ(B(x, r)) < ∞.

The following deﬁnition comes essentially from [NaTa, p. 739], but the terminology is new.

Deﬁnition 2.4. Given a set S we deﬁne its s-blossom as the enlarged set

and its uncentered s-blossom as the set

Bl(S, s) := ∪x∈SB(x, s),

Blu(S, s) := ∪x∈S ∪ {B(y, s) : x ∈ B(y, s)}.

When S = B(x, r), we simplify the notation and write Bl(x, r, s), instead of Bl(B(x, r), s),
and likewise for uncentered blossoms. In the latter case, we allow r = 0:

(8)
We say that µ blossoms boundedly if there exists a K ≥ 1 such that for all r > 0 and all
x ∈ X, µ(Blu(x, r, r)) ≤ Kµ(B(x, r)) < ∞.

Blu(x, 0, s) := ∪{B(y, s) : x ∈ B(y, s)}.

Local comparability of measures

5

Remark 2.5. Note that Bl(S, s) is just the s-neighborhood of S, and the uncentered blossom
is just an abbreviation for the iterated blossom: Blu(S, s) = Bl(Bl(S, s), s). The introduction
of the new notation is motivated by the fact that often we will be blossoming balls B(x, r),
and it will be convenient to keep track both of r and s.

Remark 2.6. Blossoms can be deﬁned using closed instead of open balls, in an entirely
analogous way. We mention that in the euclidean case there is no diﬀerence between Bl(x, r, r)
and B(x, 2r), nor between Blu(x, r, r) and B(x, 3r); but in general balls are larger.

Geometrically doubling spaces have received many names.

In the book [CoWe1], these
spaces are called (in french) spaces of homogenous type. However, in the paper [CoWe2], the
authors switched notation and started calling spaces of homogenous type to those endowed
with a doubling measure, after which this became the more common terminology. Both
kinds of spaces (geometrically doubling and with a doubling measure) have also been called
“doubling spaces”, which is why I am avoiding this expression.

Deﬁnition 2.7. A metric space is D-geometrically doubling if there exists a positive integer
D such that every ball of radius r can be covered with no more than D balls of radius r/2.

Of course, metric spaces endowed with a doubling measure, and geometrically doubling
spaces, are closely related, the latter being a generalization of the former.
If µ on X is
doubling, then X is geometrically doubling, cf.
[CoWe1, Remarque, p. 67] (but this is
not necessarily the case for measures that blossom boundedly, see Theorem 6.1 below). For a
trivial example of a geometrically doubling space which does not carry any doubling measure,
just consider Q. For a less trivial example, there are open subsets of R which do not carry
any doubling measures (cf. [He, Remark 13.20 (d)]). But if the geometrically doubling space
is complete, then a doubling measure can be deﬁned on it (cf. [LuSa]).

Arguments in analysis that rely on covering theorems often extract a disjoint collection
from the original cover, in such a way that not too much measure is disregarded. Now the
doubling condition gives us control on the size of all balls contained in B(x, 2r), regardless of
whether they intersect B(x, r) or not. Since to disjointify we only need to consider balls that
do intersect B(x, r), it is advantageous to use Bl(x, r, r) and Blu(x, r, r) instead of B(x, 2r)
and B(x, 3r). The idea of using blossoms can be found in [Li], for locally compact amenable
groups (where in principle there are no balls); and in the metric setting, it comes from [NaTa].
Next we rewrite, for the reader’s convenience, a well known argument, using the terminology
of blossoms.

Given a ball B(xi, ri) we shall sometimes use Bi as an abbreviation. It is understood not
only that Bi = B(xi, ri) as a set, but also that xi and ri are a selected center and a selected
radius of Bi (recall that in arbitrary metric spaces, neither the center nor the radius of a ball
are in general unique). In particular, it might happen that Bi = Bj for some pair i 6= j.
holds.

When a measure blossoms boundedly, the following version of the Vitali covering lemma

Theorem 2.8. Vitali covering lemma. Let (X, d, µ) be a metric measure space. Assume
there exists a constant K ≥ 1 such that for every x ∈ X and every r > 0, µ(Blu(x, r, r)) ≤

6

J. M. Aldaz

K µ(B(x, r)). Then, for every ﬁnite collection of balls B(x1, r1), . . . , B(xn, rn), there exists a
disjoint subcollection B(xi1, ri1), . . . , B(xim, rim) with
i=1B(xi, ri)) ≤ K µ(∪m

j=1B(xij , rij )).

µ(∪n

(9)

Proof. We may assume that the original collection, which we will abbreviate by B1, . . . , Bn,
is ordered by decreasing radii. Let Bi1 := B1, select Bi2 to be the ﬁrst ball in the list not
intersecting Bi1, and in general, choose Bik as the ﬁrst ball in the list not intersecting any of
the previously selected balls. Then the process ﬁnishes after a ﬁnite number of steps with,
let’s say, the ball Bim.

We need to control the mass lost with the balls not chosen. Let B1

ik be the
collection of all balls intersecting Bi1. Then ∪k
s=1B1
is) ≤
µ(Blu(x1, r1, r1)) ≤ K µ(B(x1, r1)). Repeating this argument with the other balls, we obtain
(9).

j1, . . . , B1
is ⊂ Blu(x1, r1, r1), so µ(∪k

s=1B1

(cid:3)

The preceding theorem entails the weak type (1,1) of the maximal operator, and by inter-
polation, the corresponding strong type bounds. One also has the Lebesgue Diﬀerentiation
Theorem for measures that blossom boundedly, as in the case of doubling measures.

Regarding the strong type bounds, we mention that once an averaging or maximal averaging
operator is bounded in Lr for some r > 0, it is bounded in Lp for all p > r, with operator
norm that approaches 1 (something that is not always observed in published results). There
is no need to use Riesz-Thorin (for positive sublinear operators) to obtain this, it immediately
follows from Jensen’s inequality.

Theorem 2.9. Let (X,A, µ) be a measure space, let 0 < r < ∞, and let T be an averaging
or maximal averaging operator, bounded on Lr(X, µ) and with operator norm cr. Then T is
bounded on Lp for all p ≥ r, with operator norm cp ≤ cr/p
Proof. For all p such that r < p < ∞, and all f ∈ Lp, f ≥ 0, we have f p/r ∈ Lr, so by
Jensen’s inequality,

.

r

Z [T (f )]pdµ ≤Z [T (f p/r)]rdµ ≤ cr

rZ f pdµ,

and the result follows by taking p-th roots.

(cid:3)

3. Local comparability

Deﬁnition 3.1. We say that a measure µ satisﬁes a local comparability condition for the
radius r if there exists a constant C ∈ [1,∞) such that for all pairs of points x, y ∈ X,
whenever d(x, y) < r, we have

If the constant C can be chosen to be independent of r, then we say that µ satisﬁes a C local
comparability condition. We denote the smallest such C by C(µ) or Cµ.

µ(B(x, r)) ≤ Cµ(B(y, r)).

Local comparability of measures

7

Interchanging x and y in the preceding deﬁnition leads to

1
C ≤

µ(B(x, r))
µ(B(y, r)) ≤ C,

provided µ(B(x, r)) > 0 (of course, µ(B(x, r)) = 0 if and only if µ(B(y, r)) = 0). While it is
always possible to assume that µ has full support, by disregarding, if needed, a measure zero
set, this can lead to substantial changes in the geometry of the resulting space, since many
properties are not inherited by subsets. So even though we will always suppose that µ is not
identically 0, full support will not be assumed.

Example 3.2. Suppose (X, d) is an ultrametric space (so the triangle inequality is replaced
by the stronger condition d(x, y) ≤ max{d(x, z), d(z, y)}). It follows that B(x, r) = B(y, r)
whenever d(x, y) < r, so for every measure µ on X, the local comparability oscillation condi-
tion is trivially satisﬁed, with C(µ) = 1.

In order to use uncentered blossoms, the following obvious estimate is useful.

Lemma 3.3. Let (X, d, µ) be a metric measure space, and let µ satisfy a C local comparability
condition. If µ(B(x, r)) ∩ µ(B(y, r)) 6= ∅, then µ(B(x, r)) ≤ C 2
Proof. Let z ∈ B(x, r) ∩ B(y, r). Since d(x, z) < r and d(z, y) < r, we have that

µ µ(B(y, r)).

µ(B(x, r)) ≤ Cµ µ(B(z, r)) ≤ C 2

µ µ(B(y, r)).

(cid:3)

The local comparability condition can be equivalently stated in terms of closed balls.

Lemma 3.4. A measure µ satisﬁes a C local comparability condition if and only if for every
r > 0 and all pairs of points x, y ∈ X, whenever d(x, y) ≤ r, we have

µ(Bcl(x, r)) ≤ Cµ(Bcl(y, r)).

Proof. Suppose µ satisﬁes a C local comparability condition, and let d(x, y) ≤ r. Then for
every n ≥ 1, µ(B(x, r + n−1)) ≤ Cµ(B(y, r + n−1)). Taking the limit as n → ∞ we obtain
µ(Bcl(x, r)) ≤ Cµ(Bcl(y, r)). For the other direction, suppose that 0 < d(x, y) < r, select
N >> 1 such that d(x, y) ≤ r − N−1, and use µ(Bcl(x, r − n−1)) ≤ Cµ(Bcl(y, r − n−1))
whenever n ≥ N. Letting n → ∞ we obtain µ(B(x, r)) ≤ Cµ(B(y, r)).

(cid:3)

It is easy to see (and we prove it below) that in geometrically doubling spaces local com-
parability implies boundedness of blossoms. Thus, it is interesting to see how close, or how
far away, is local comparability from doubling.

But before we do so, we consider the behavior of averaging operators when local compara-

bility is missing, with special emphasis in the case of the standard Gaussian measure.

8

J. M. Aldaz

4. Averaging operators without local comparability

As noted in [NaTa, p. 737], if µ satisﬁes a C local comparability condition, then, a simple
application of Fubini’s Theorem yields, for all averaging operators Ar, r > 0, the uniform
bound kArkL1→L1 ≤ C. We recall the argument: Suppose that for a ﬁxed radius s, and all
x, y ∈ X with 0 < d(x, y) < s, we have µ(B(x, s)) ≤ Cµ(B(y, s)). If 0 ≤ f ∈ L1(µ), then
(10)

f (y) dµ(y) dµ(x)

1B(x,s)(y)
µB(x, s)

kAsfkL1 =ZXZX
f (y)ZX

1B(y,s)(x)
µB(x, s)

=ZX

(11)

dµ(x) dµ(y) ≤ CZX

f (y) dµ(y),

so kAskL1→L1 ≤ C, and hence local comparability for s entails the bound C for the corre-
sponding averaging operator, while local comparability (for all radii) entails uniform bounds
for all the averaging operators.
Example 4.1. The bound kAskLp→Lp ≤ C, for a speciﬁc radius s, may fail for all p ∈ [1,∞),
if µ lacks local comparability for balls of radius s. We deﬁne next a path connected subset
B ⊂ R2, on which we use the path metric d instead of the ambient space metric:
the
distance between two points is the length of the shortest path joining them. Start with the
positive x-axis. For each n ≥ 1, select n points from the circunference of radius 1 centered at
(3n, 0): zn,1 . . . , zn,n ∈ {(x, y) ∈ R2|(x − 3n)2 + y2 = 1}. Join the points zn,1 . . . , zn,n to the
center (3n, 0) using straight line segments (radii), let B be the union of the positive x-axis
with all the “spikes” attached to the centers (3n, 0), and let µ be the counting measure on
the points (3n, 0) and zn,1 . . . , zn,n, for every n ≥ 1 (clearly, all balls have ﬁnite measure).
Now d(zn,k, (3n, 0)) = 1, while if m 6= n, d(zn,k, zm,j) ≥ 5. Thus, µB(zn,k, 3/2) = 2 and
µB((3n, 0), 3/2) = n + 1, so local comparability fails for s = 3/2. Let fn = 1{(3n,0)}, and
ﬁx n, p ≥ 1 with n >> 2p. Then (A3/21{(3n,0)})(zn,k) = 1/2, from whence it follows that
kA3/2kp
Lp→Lp ≥ n2−p. For the same reason (or by interpolation) A3/2 satisﬁes no weak (p,p)
type bounds.

It is nevertheless possible to have uniform Lp bounds for Ar without local comparability. For
instance, in Rd, because of the Besicovitch covering theorem, the centered maximal function
deﬁned by an arbritraty measure is of weak type (1,1), and by interpolation, bounded on
Lp for all 1 < p < ∞ (with bounds that grow exponentially with the dimension). Thus,
averaging operators satisfy Lp bounds independent of r, for p > 1. We shall see later that
exponential growth with d can actually happen for As with suitably chosen s.

Regarding L1 bounds, it may happen, even in the absence of local comparability, that the

term

in the left hand side of (11) can still be controled, if the ratio µB(y,s)
µB(x,s) becomes large on sets
of suﬃciently small measure. Next we consider the standard exponential distribution in one

1B(y,s)(x)
µB(x, s)

dµ(x)

ZX

Local comparability of measures

9

dimension, and the standard gaussian measure in all dimensions. By way of comparison with
the results that follow, recall that for Lebesgue measure in Rd, for every r > 0 and d ≥ 1,
kArkL1→L1 = 1 (using (10)-(11)), kArkL∞→L∞ ≤ 1 (this is obvious), and kArkLp→Lp ≤ 1 for
1 < p < ∞, by interpolation or by Theorem 2.9.
Theorem 4.2. Consider Ω = (0,∞) with the standard exponential distribution, given by
dP (t) = e−tdt. Then P satisﬁes a local comparability condition for each radius r, with optimal
C(r) ∈ [er, max{2, er}]; thus, it fails to satisfy a local comparability condition. However, the
averaging operators are uniformly bounded, with 1.27 < kA1kL1→L1 ≤ supr>0 kArkL1→L1 ≤ 2.
Proof. For convenience we extend P to R by setting P (−∞, 0] = 0. Fix r > 0. First we check
that for every x, y > 0 such that |x − y| ≤ r, P ((x − r, x + r)) ≤ max{2, er}P ((y − r, y + r)),
and the bound max{2, er} cannot be lowered. We may assume, without loss of generality,
that x < y, which leads to the consideration of the following three cases: x ≥ r, x < r ≤ y,
and y < r. In the ﬁrst case, P ((x − r, x + r)) ≥ P ((y − r, y + r)), and a computation shows
that P ((x− r, x + r))/P ((y − r, y + r)) ≤ er, with equality when y = x + r. In the third case,
P ((0, x+r)) ≤ P ((0, y+r)), and P ((0, y+r))/P ((0, x+r)) ≤ (1−e−2r)/(1−e−r) ≤ 2, since for
any decreasing function h ≥ 0, we haveR 2r
0 h, and furthermore limr→0(1− e−2r)/(1−
e−r) = 2, so we get arbitrarily close to 2 by letting x → 0, y → r, and then r → 0. Finally,
when x < r ≤ y, we have e−r = (1 − e−2r)/(er − e−r) ≤ P ((y − r, y + r))/P ((x − r, x + r)) ≤
(1 − e−2r)/(1 − e−r) ≤ 2.
Next, note that for every w ∈ (0,∞) and every r > 0, P (B(w, r)) =R w+r
e−tdt, so if
w ≥ r, by the convexity of e−t we have
(12)

0 h ≤ 2R r

max{0,w−r}

P (B(w, r)) ≥ e−w2r,

(13)

Z ∞

e−tdt = 1 − e−r−w ≥ 1 − e−r. In order to bound
1B(y,r)(x)
P (B(x, r))

while if w < r, then P (B(w, r)) =R w+r
f (y)Z ∞
we break up the outer integral into R ∞
|x − y| ≤ r, both B(x, r) = (x − r, x + r) and B(y, r) = (y − r, y + r) so
dx ≤Z y+r
dP (x) =Z y+r
dx
2r

0 = R 2r
P ((x − r, x + r))

1B(y,r)(x)
P (B(x, r))

0 +R ∞

2r . On the region where y ≥ 2r, since

dP (x) dP (y),

Z ∞

0

dx = 1.

0

0

e−x

y−r

y−r

0

If 0 < y < 2r,

Z ∞

0

1B(y,r)(x)
P (B(x, r))

Now

Z r

max{0,y−r}

dP (x) =Z y+r
dx ≤Z r

e−x

P ((x − r, x + r))

max{0,y−r}

e−x

1 − e−r dx =

e−x

max{0,y−r}

P ((x − r, x + r))

max{0,y−r}

dx =Z r
e− max{0,y−r} − e−r

1 − e−r

r

.

+Z y+r
1 − e−r
1 − e−r = 1,

≤

10

while

by (12). Hence,

Z y+r

r

J. M. Aldaz

e−x

P ((x − r, x + r))
dP (x) dP (y) = 2Z 2r

0

dx ≤Z y+r

r

dx
2r

dx ≤ 1,

f (y)Z ∞

(14) Z ∞
f (y) dP (y) ≤ 2kfk1.
Next, take r = 1. We show that 1.27 < kA1kL1→L1. Recall that when the centered maximal
operator acts on a measure ν, it is deﬁned via

f (y) dP (y) +Z ∞

1B(y,r)(x)
P (B(x, r))

2r

0

0

Mµν(x) :=

sup

{r>0:µ(B(x,r))>0}

ν(B(x, r))
µ(B(x, r))

.

By a standard approximation argument, instead of a function, we consider a Dirac delta
placed at 1. If x ∈ (0, 1), then

while if x ∈ [1, 2), then

A1δ1(x) =

A1δ1(x) =

1

1 − e−1−x ,

ex

e − e−1 .

Using the change of variables u = ex and integrating explicitly, we obtain

kA1kL1(P )→L1(P ) ≥ kA1δ1kL1(P ) =Z 2
= e log(cid:18) e − e−1

A1δ1(x) e−x dx =Z 1
e − e−1 > 1.27.

1

1 − e−1(cid:19) − e +

0

0

dx

ex − e−1 +Z 2

1

dx

e − e−1

(cid:3)

Next we consider the case of the standard Gaussian measure γd in Rd. Here local compara-
bility fails for every single radius r > 0, but nevertheless, the averaging operators Ar deﬁned
d)1/2 to denote the
by γd satisfy uniform L1-bounds (in r). We use kxk2 := (x2
euclidean distance in Rd. Recall that the standard gaussian measure is given by

2 + · · · + x2

1 + x2

dγd(x) =

2

2

e− kxk2
(2π)d/2 dx

Theorem 4.3. Let (Ω, d, P ) be (Rd,kxk2, γd), where γd is the standard gaussian measure.
Given any r > 0, γd does not satisfy a local comparability condition for r. However, for all
p ≥ 1,

sup

r>0 kArkLp→Lp ≤ (cid:18)3
2(cid:19)d

+pπ(d + 1)(cid:18) 2

√3(cid:19)d+1!1/p

= (1 + o(1))(cid:18)3

2(cid:19)d/p

.

Local comparability of measures

11

Furthermore, for every p in [1,∞) and every d suﬃciently large, the weak type (p, p) constants

> 1.019d/p.

satisfy (cid:13)(cid:13)(cid:13)

A √3d−3

2 (cid:13)(cid:13)(cid:13)Lp→Lp,∞

The next obvious lemma tells us that the normalizing constants (2π)−d/2 in the probabilities

Of course, for p > 1 the fact that the operators Ar are uniformly bounded in Lp follows
from the corresponding bounds for the maximal operators. But the boundedness of Ar for
p = 1 in the preceding result is new, and for p close to 1, the bounds obtained by interpolation
do not blow up when p → 1, unlike the case of the maximal function inequalities.
can be omitted from certain formulas.
Lemma 4.4. Given a measure µ and a constant c > 0, for all r > 0, all f ∈ L1, and all
x ∈ X, we have Ar,µf (x) = Ar,cµf (x), and kAr,µkL1(µ)→L1(µ) = kAr,cµkL1(cµ)→L1(cµ).

For the next lemma it will be more convenient to use closed balls. Of course, from the
viewpoint of the gaussian measure this makes no diﬀerence, since the boundaries of balls have
measure zero.
Lemma 4.5. Let µ be a rotationally invariant measure on Rd, let r > 0, and let kvk = r.
Then µ(Bcl(0, r)) ≤ ((3/2)d − 1)µ(Bcl(v, r)).
Proof. First we recall a well known volumetric argument giving upper bounds on the size
of r-nets on the r-sphere. Since for this part we only use Lebesgue measure λd, we can
take r = 1. Let {v1, . . . , vM} be a maximal set of unit vectors in Rd, subject to the
condition that for i 6= j, kvi − vjk2 ≥ 1. Then all balls Bcl(vi, 1/2) have disjoint interi-
1 Bcl(vi, 1/2) ⊂ Bcl(0, 3/2) \ B(0, 1/2), so PM
1 λdBcl(vi, 1/2) ≤ λdBcl(0, 3/2) −
ors, and ∪M
λdB(0, 1/2) = ((3/2)d − 1)λdBcl(0, 1/2), from which it follows that M ≤ (3/2)d − 1. Fur-
thermore, the maximality of the set of unit vectors entails that Bcl(0, 1) ⊂ ∪M
1 Bcl(vi, 1), as
the following argument shows. Suppose y ∈ Bcl(0, 1) \ ∪M
1 Bcl(vi, 1). Then y 6= 0, because
the origin belongs to all the balls under consideration, so v := y/kyk2 lies on the unit sphere.
Now if v ∈ Bcl(vi, 1) for some index i, then y ∈ Bcl(vi, 1) by the convexity of the ball, so
v ∈ Bcl(0, 1) \ ∪M
1 Bcl(vi, 1). But then kvi − vk2 > 1 for i = 1, . . . , M, contradicting the
maximality of {v1, . . . , vM}.
Let us now return to the original µ and r > 0. By invariance under rotations, for all i we
have µBcl(rvi, r) = µBcl(rv1, r). Since Bcl(0, r) ⊂ ∪M
1 Bcl(rvi, r), it follows that µBcl(0, r) ≤
1 Bcl(rvi, r) ≤PM
µ ∪M
Corollary 4.6. Let µ be a radial, radially decreasing measure on Rd. That is, dµ(x) =
f (x)dx, where f is a locally integrable, radial and radially decreasing function. Then for
every g ∈ L1(µ), k1B(0,r)Ar,µgkL1(µ) ≤ ((3/2)d − 1)k1B(0,2r)gkL1(µ), where Ar,µ is deﬁned using
the closed balls Bcl(x, r).

1 µBcl(rvi, r) ≤ ((3/2)d − 1)µ(Bcl(rv1, r)).

(cid:3)

Proof. Note that of all balls Bcl(x, r) containing the origin, the ones with smallest measure
are those for which kxk2 = r, since for every t ∈ [0, 1), for all z ∈ Bcl(x, r) \ Bcl(tx, r), and

12

J. M. Aldaz

all y ∈ Bcl(tx, r) \ Bcl(x, r), f (z) < f (y). Now if x ∈ B(0, r) \ {0} and 0 ≤ g ∈ L1(µ), then

so the result follows from the previous lemma.

Ar,µg(x) ≤ k1B(0,2r)gkL1(µ)
µBcl(rx/kxk2, r)

,

(cid:3)

For the rest of this section, we use µ to denote the non-normalized gaussian dµ(x) = e− kxk2

2

2

.

Occasionally we will write µd to specify the dimension d.
Lemma 4.7. Let r > 0 and let x ∈ Rd \ B(0, r). Then
2 λdB(0, r)

e− kxk2

2

µB(x, r) ≥

pπ(d + 1)  √3
2 !d+1

.

Proof. When needed, we will distinguish between balls in Rd and Rd−1 by writing Bd and
Bd−1 respectively. Using rotational invariance, we may assume that x = se1, with s ≥ r.
Since

µB(se1, r) ≥ µ (B(se1, r) ∩ B(0, s)) ≥ e−s2/2λd (B(se1, r) ∩ B(0, s)) ,

all we need to do is to show that

(15)

λd (B(se1, r) ∩ B(0, s))

λd (B(0, r))

≥

1

pπ(d + 1) √3
2 !d+1

.

First of all, note that the ratio in the left hand side of the preceding inequality is minimized
when s = r, so we suppose this is the case. Second, dividing all radii by s and cancelling the
factors sd, we may take s = 1. Now

λd(B(0, 1) ∩ B(e1, 1)) = 2λd(Bd(0, 1) ∩ {x1 ≥ 2−1})

= 2λd−1(Bd−1(0, 1))Z 1

dx1

1(cid:19)d−1
1/2(cid:18)q1 − x2
d + 1 √3
2 !d+1

2

≥ 2λd−1(Bd−1(0, 1))Z π/2

π/6

cosd t sin tdt =

λd−1(Bd−1(0, 1)).

Using λd(Bd(0, 1)) = πd/2

Γ(1+d/2) , together with the following Gamma function estimate (con-

sequence of the log-convexity of Γ on (0,∞), cf. Exercise 5, pg. 216 of [Web])
(16)

,

2(cid:19)1/2
(cid:18)d

Γ(1 + d/2)
Γ(1/2 + d/2)

≤

we get

(17)

λd (B(e1, 1) ∩ B(0, 1))

λd (B(0, 1))

≥

1

pπ(d + 1) √3
2 !d+1

.

(cid:3)

Local comparability of measures

13

Proof of Theorem 4.3. Fix r > 0 and take kxk2 >> 1+r. To see that µ does not satisfy a lo-
cal comparability condition for r, we consider the balls B(x, r) and B((1+3r/kxk2)x, r). Since
their centers are at distance 3r, they are disjoint. However, B(x, r), B((1 + 3r/(2kxk2))x, r)
and B((1 + 3r/kxk2)x, r) form an intersecting chain of balls of length 3, so applying Lemma
3.3 twice, local comparability for r would imply that the measures of B(x, r) and B((1 +
3r/kxk2)x, r) are comparable, for every x. However,

µ(B((1 + 3r/kxk2)x, r))

µ(B(x, r))

lim
x→∞

≤ lim
t→∞

2

e− (kxk2+2r)2
e− (kxk2+r)2

2

λdB(0, r)

λdB(0, r)

= 0.

In order to prove that supr>0 kArkL1→L1 ≤ (1 + o(1))(3/2)d, we split Ar,µ into Ar,µ =

1B(0,r)Ar,µ + 1B(0,r)cAr,µ. Let 0 ≤ g ∈ L1(µ). The bound

k1B(0,r)Ar,µgkL1(µ) ≤ ((3/2)d − 1)k1B(0,2r)gkL1(µ)

is a special case of Corollary 4.6, together with the fact that open and closed balls have the
same gaussain measure. Regarding the second term,

(18)

(19)

k1B(0,r)cAr,µgkL1(µ) =ZRdZRd

1B(x,r)(y)1B(0,r)c(x)

µB(x, r)

g(y) dµ(y) dµ(x)

=ZRd

g(y)ZRd

1B(y,r)(x)1B(0,r)c(x)

µB(x, r)

dµ(x) dµ(y).

Now ﬁx y. By Lemma 4.7 we have

1B(y,r)(x)1B(0,r)c (x)

µB(x, r)

ZRd

dµ(x) =ZB(0,r)c∩B(y,r)

2

e− kxk2
2 dx
µB(x, r)

≤pπ(d + 1)(cid:18) 2

√3(cid:19)d+1 ZB(y,r)

dx

λdB(0, r)

=pπ(d + 1)(cid:18) 2

√3(cid:19)d+1

.

Therefore

and from Theorem 2.9 we conclude that for every p ≥ 1,

kAr,µgkL1(µ) = k1B(0,r)Ar,µgkL1(µ) + k1B(0,r)cAr,µgkL1(µ)

≤ (cid:18)3
2(cid:19)d

+pπ(d + 1)(cid:18) 2

√3(cid:19)d+1!kgkL1(µ),

kAr,µkLp(µ)→Lp(µ) ≤ (cid:18)3
2(cid:19)d

+pπ(d + 1)(cid:18) 2

√3(cid:19)d+1!1/p

.

Regarding the lower bounds for the weak type constants, the argument we use is the same as
in [CriSjo], together with gaussian concentration. The basic idea is that since the standard
gaussian measure in Rd behaves essentially as normalized area on the sphere Sd−1(√d), cen-
tered at 0 and of radius √d, a single well chosen radius is enough to witness the exponential

14

J. M. Aldaz

growth of constants with the dimension. So the argument given by Criado and Sjogr¨en for
the maximal operator essentially yields the same result for certain averaging operators. Of
course, since the standard gaussian measure is not singular, but absolutely continuous, one
still has to show that small changes in the center of a ball lead to small changes in the average.

First, we estimate from below the measure of the region bounded between Sd−1(√d − 1 −
1/√d − 1) and Sd−1(√d − 1) (the region between the radii √d and √d − 1 could be used in
than to redo them, and they use √d − 1 as the largest radius, so do we). Denote by

an entirely analogous way, but since we want to cite estimates from [CriSjo] directly, rather

σd−1(Sd−1) :=

d πd/2

Γ(1 + d/2)

the area of the unit sphere Sd−1.
In what follows we utilze Stirling’s formula, as well as
approximations to e, so the inequality below holds for d large enough. Since g(r) := rd−1e−r2/2

is increasing for 0 < r < √d − 1,

(20)

(21)

ZB(0,√d−1)\B(0,√d−1−1/√d−1)

dγd(x) =

d πd/2

(2π)d/2Γ(1 + d/2)

≥

g(√d − 1 − 1/√d − 1)Z

√d−1
√d−1−1/√d−1

σd−1(Sd−1)
(2π)d/2 Z
√d−1
√d−1−1/√d−1

g(r)dr

dr >

1

(πe3d)1/2

for d large. We want to obtain a good estimate from below for

on the region D := B(0,√d − 1)\ B(0,√d − 1− 1/√d − 1). Let 1 ≤ p < ∞, let 0 < r, R < 1,

and let c > 0 satisfy, for all α > 0, the inequality

A √3d−3

2

1

B(0,

√3d−3

)

2

γd({AR√d−1,γd1B(0,r√d−1) ≥ α}) ≤(cid:18)ck1B(0,r√d−1)kLp(γd)

α

(cid:19)p

,

(22)

or equivalently

(23)

αγd({AR√d−1,γd1B(0,r√d−1) ≥ α})1/p

γd(B(0, r√d − 1))1/p

≤ c.

To ﬁnd a (suﬃciently high) uniform lower bound α for

(24)

AR√d−1,γd1B(0,r√d−1)(x) =

γd(B(0, r√d − 1) ∩ (B(x, R√d − 1))

,

γd(B(x, R√d − 1))

whenever x ∈ D, we use the following facts, taken from [CriSjo, Proof of Lemma 5.1] (note
that we have chosen a diﬀerent, more common normalization for the gaussian measure, but
this makes no essential diﬀerence; for the justiﬁcation of the assertions below we refer the

Local comparability of measures

15

reader to the original paper). Criado and Sj¨ogren show that if kxk2
R ∈ (0, 1), an r ∈ (0, 1) can be chosen in such a way that
γd(B(0, r√d − 1) ∩ B(x, R√d − 1))
≥ Θ(cid:18) 1
(25)

γd(B(x, R√d − 1))

√d − 1(cid:19) ,

2 = √d − 1, then for each

where Θ denotes exact order. In view of this bound and of the denominator in (23), we want
to select r as small as possible, which is where the choice r = R = √3/2 comes from, as we
shall see next. Let

F (t, R) :=(cid:18)t −

(1 + t − R2)2

4

(cid:19) e−t,

t(R) := 2 + R2 −

√1 + 4R2,

G(R) := F (t(R), R).

let

and let

(28)

(29)

(30)

For each ﬁxed R, t(R) maximizes F , so F (t, R) ≤ G(R). Set r(R) :=pt(R) (cf. [CriSjo] for
justiﬁcations). Since R = √3/2 is the only zero of t′ in (0, 1) and t′′(√3/2) > 0, the function
t(R) has a local minimum there, which is easily seen to be the unique global minimum (for
instance, by checking the endpoints). Hence, for 0 < R < 1, t(R) ≥ t(√3/2) = 3/4, and we
choose r = √3/2 = R. Given x ∈ D, by rotational invariance we may suppose that x = ue1,
where √d − 1 − 1/√d − 1 ≤ u ≤ √d − 1, and as before, e1 is the ﬁrst vector in the standard

basis of Rd. Criado and Sj¨ogren show that

R

G(R)

d−1
2 =: V (R).

(26)

γdB(√d − 1 e1, R√d − 1)) ≤

Using this, for ue1 ∈ D we have
γd(B(0,

(27)

2σd−2(Sd−2)(cid:0)√d − 1(cid:1)d
(d − 1)√1 − R2
√d − 1) ∩ B(ue1,
√d − 1))
√d − 1) ∩ B(√d − 1 e1,

√3
2
γd(B(ue1,

√3
2

√3
2

√3
2

√d − 1))

√d − 1))

γd(B(0,

√3
2

≥

≥

γd(B(√d − 1 e1, (

√3
2 + 1

d−1)√d − 1))

γd(B(0,

√3
2

√d − 1) ∩ B(√d − 1 e1,

√3
2

√d − 1))

V (

√3
2 + 1

d−1)

=

V (

√3
2 )
V (
√3
2 + 1
d−1)

γd(B(0,

√3
2

√d − 1) ∩ B(√d − 1 e1,

√3
2

√d − 1))

.

√3
2 )

V (

(31)

(32)

c0√d − 1

,

√3
V (
2 )
√3
2 + 1
d−1)

,

V (

d−1 instead of



d−1
2

G(cid:16)√3
2 (cid:17)
G(cid:16)√3
d−1(cid:17)

2 + 1




16

J. M. Aldaz

The last factor in the preceding line is bounded below (cf. [CriSjo]) by

where c0 is a strictly positive constant (in particular, it is independent of d; it may depend
on the choices of R and r, which are equal to √3/2 in our case). Regarding

as d becomes large, the changes that R and R2 undergo in the fraction of formula (26), when
√3
R takes the value
2 , become vanishingly small, so all we need to do is
to bound

√3
2 + 1

from below. A computation shows that G′′(√3/2) < 0, so G is locally concave at √3/2, and
thus, for d suﬃciently high, G(√3/2) + 1/(d − 1)) ≤ G(√3/2) + G′(√3/2)/(d − 1). Since
G(√3/2) = 1/(2e3/4) and G′(√3/2) = √3/(2e3/4), we have that
d−1!

≥  1

> e−1

(33)

1 +

d−1
2

d−1
2

√3




G(cid:16)√3
2 (cid:17)
G(cid:16)√3
d−1(cid:17)

2 + 1




for d large enough.

Finally, since g(r) := rd−1e−r2/2 is increasing for 0 < r < √d − 1,
√d−1

√3
2

g(r) dr

γd(B(0,

√3
2

√d − 1)) =
√d−1

√3
2

σd−1(Sd−1)
(2π)d/2 Z

0

dr =

σd−1(Sd−1)

(2π)d/2 g √3

2

≤

√d − 1!Z

0

σd−1(Sd−1)

(2π)d/2  √3

2

√d − 1!d

e− 3d−3

8

.

Using Stirling’s formula, for d large the right hand side of the preceding equality can be
bounded above by

Putting together in formula (23) the bounds (20)-(21), (25)-(33), and the last estimate, we
conclude that for d suﬃciently large,

√d(cid:18)3e1/4
4 (cid:19)

d
2

.

kA√3d−3/2kLp→Lp,∞ ≥(cid:18) 2

31/2e1/8(cid:19)

d
p

Θ(cid:18)

1

d1/2+1/(2p)(cid:19) .

Local comparability of measures

17

2

Now
exponential, and we get

31/2e1/8 > 1.019, so for d large enough the factor Θ(cid:0)

1

d1/2+1/(2p)(cid:1) can be absorbed in the

(cid:13)(cid:13)(cid:13)

A √3d−3

2 (cid:13)(cid:13)(cid:13)Lp→Lp,∞

> 1.019d/p.

(cid:3)
I do not know whether the uniform L1 boundedness of the operators Ar in the two preceding
cases (exponential and gaussian) are instances of a more general result in euclidean spaces,
or whether there are measures ν in Rd for which supr>0 kAr,νkL1→L1 = ∞. Curiously, for the
one-directional averaging operators in R, examples of such measures are easy to ﬁnd.
Given µ on R and s > 0, deﬁne, for all x ∈ R such that µ([x, x + s]) > 0, the right

directional averaging operator as

Ar

s,µf (x) :=

1

µ([x, x + s])ZR

f (y)1[x,x+s](y) dµ(y).

Theorem 4.8. There exists a measure ν on R such that kAr

1,νkL1→L1 = ∞.

By way of comparison, for p > 1 and denoting by M r the right directional Hardy-Littlewood

maximal operator, given any µ on R we have that
s,µkLp→Lp ≤ kM r

s>0 kAr
sup
(cf. [Gra, p. 102, Exercise 2.1.11]).
Proof. Let B := ∪n≥0[2n, 2n+ 1), and let dν(x) := (1B(x) + e−x)dx. Again by approximation,
we can use Dirac deltas instead of functions. For x ∈ [2n, 2n + 1) we have that

µkLp→Lp =

p
p − 1

2n + 1 − x + e−2n .
Since dν(x) > 1 on [2n, 2n + 1), we conclude that limn→∞ kAr

Ar
1,νδ2n+1(x) ≥

1

1,νδ2n+1kL1 = ∞.

(cid:3)

5. Local comparability vs doubling

Next we study the local comparability condition and its relationship to doubling. Recall
that any such comparison must be made in geometrically doubling spaces, the only ones that
support doubling measures.

Example 5.1. For a very simple example of a nondoubling locally comparable measure, on
a geometrically doubling space, just take the space X of 2 points x and y at distance 1, and
let µ := δx. Then balls are either disjoint or the whole space (when r > 1), so C(µ) = 1.
Actually, the same argument shows that C(ν) = 1 for every measure ν on X. A variant of
the preceding example, but admitting nondoubling measures with full support, is given by
N with d(m, n) = 1 when m 6= n. If µ is any ﬁnite Borel measure on N, then C(µ) = 1.
Alternatively, one can just recall Example 3.2, noting that the preceding spaces are (discrete)
ultrametric.

18

J. M. Aldaz

Example 5.1 shows that a nontrivial locally comparable measure, can assign measure zero
to some balls. For another diﬀerence between doubling and local comparability, note that if
µ is doubling and µ{x} > 0, then x is an isolated point of X. This need not be the case
when we only have local comparability, as can be seen by choosing a measure with atoms in
an ultrametric space without isolated points.

Speaking loosely, the better the connectivity properties of the space, and the smaller the
“gaps” or “holes” in it, the more similar to doubling are the measures satisfying local com-
parability. For instance, if X is connected, then the local comparability of µ entails that no
ball has measure 0, and furthermore, µ is continuous, that is, for every x ∈ X, µ{x} = 0.
The next result does not require X to be geometrically doubling.

Theorem 5.2. If a metric measure space (X, d, µ) is connected and µ satisﬁes a local compa-
rability condition, then all balls have strictly positive measure, and for every x ∈ X, µ{x} = 0.
Proof. If for some r > 0 and some x ∈ X, µB(x, r) = 0, then by local comparability, for every
y ∈ B(x, r), µB(y, r) = 0, and by τ -smoothness, µBl(x, r, r) = 0. Deﬁne Bl1 := Bl(x, r, r)
and for n ≥ 1, Bln+1 := Bl(Bln, r). Again by τ -smoothness, for all n ≥ 1, µBln = 0, so
µ ∪n Bln = 0. But ∪nBln = X (this is well known and it follows from the fact that ∪nBln is
nonempty, open, and closed, so it is X; in topological terminology, connected metric spaces
are chainable). Thus, the nontriviallty of µ is contradicted.

Next, suppose that for some x ∈ X we have µ{x} > 0. Select n ∈ N \ {0} and r > 0 such
that µ(B(x, r)) < (1+1/n)µ{x}. Since x is not isolated there exists a y ∈ B(x, r/3)\{x}. Now
if B(x, d(x, y))∩ B(y, d(x, y)) 6= ∅, we can use these two balls to conclude that a local compa-
rability condition cannot hold, since µB(x, d(x, y))/µB(y, d(x, y)) ≥ µ{x}/µB(y, d(x, y)) > n
for n arbitrary. So assume that B(x, d(x, y)) ∩ B(y, d(x, y)) = ∅. By connectivity, the closed
ball Bcl(x, d(x, y)) is not open, whence there exists a z ∈ Bcl(x, d(x, y)) and a sequence
in (cid:0)Bcl(x, d(x, y))(cid:1)c such that limn d(zn, z) = 0. Select zN ∈ B(z, d(x, y)/3). Then
{zn}∞1
d(x, zN ) > d(x, z) = d(x, y) and 2d(x, zN ) < r, so z ∈ B(x, d(x, zN )) ∩ B(zN , d(x, zN )) and as
before, µB(x, d(x, zN ))/µB(zN , d(x, zN )) > n.

(cid:3)

Lemma 5.3. Let (X, d, µ) be a metric measure space, D-geometrically doubling, and such
that µ satisﬁes a local comparability condition. Then µ(Bl(x, r, r)) ≤ D C 3
µ µ(B(x, r)), and
µ(Blu(x, r, r)) ≤ D2 C 4
Proof. Cover the ball B(x, 2r) with at most D balls of radius r, and disregard all such balls
having empty intersection with Bl(x, r, r). Since Bl(x, r, r) ⊂ B(x, 2r), this yields a cover
B(yi, r), . . . , B(yM , r) of Bl(x, r, r) with M ≤ D, and by Lemma 3.3, such that for every
1 ≤ k ≤ M, µB(yk, r) ≤ C 3
The second inequality is proven in the same way: Blu(x, r, r) ⊂ B(x, 3r); cover B(x, 3r)
with at most D2 balls of radius r, and disregard all such balls having empty intersection
with Blu(x, r, r). This yields a cover B(yi, r), . . . , B(yM , r) of Blu(x, r, r) with M ≤ D2, and
(applying Lemma 3.3 twice) such that for every 1 ≤ k ≤ M, µB(yk, r) ≤ C 4
µ µB(x, r). Hence
µBlu(x, r, r) ≤ D2 C 4
(cid:3)

µ µB(x, r). Hence µBl(x, r, r) ≤ D C 3

µ µ(B(x, r)).

µ µ(B(x, r)).

µ µB(x, r).

Local comparability of measures

19

It is obvious that in an arbitrary metric measure space, boundedness of blossoms entails
local comparability, since whenever d(x, y) < r, B(x, r) ⊂ Bl(y, r, r) and B(y, r) ⊂ Bl(x, r, r).
If additionally the space is geometrically doubling, then the conditions are equivalent.

Corollary 5.4. Let (X, d, µ) be a geometrically doubling metric measure space. The following
are equivalent:

a) µ satisﬁes a local comparability condition.
b) There exists a constant K1 ≥ 1 such that for every x ∈ X and every r > 0, µ(Bl(x, r, r)) ≤
c) There exists a constant K2 ≥ 1 such that for every x ∈ X and every r > 0, µ(Blu(x, r, r))

K1 µ(B(x, r)).

≤ K2 µ(B(x, r)).

In a certain sense, it could be said that from the viewpoint of the maximal operator the
doubling condition is irrelevant, since in geometrically doubling spaces it can be replaced by
local comparability (by the preceding corollary together with the Vitali covering lemma) and
oﬀ geometrically doubling spaces, there are no doubling measures. However, if nearby points
can always be joined by bounded chains of intersecting balls with the same radius, then in
a geometrically doubling space, local comparability implies doubling. Hence, in many spaces
of interest both conditions are equivalent.

Lemma 5.5. Let (X, d, µ) be a metric measure space, D-geometrically doubling, and such
that µ satisﬁes a local comparability condition. Suppose there exists a K > 1 such that for
all x, z ∈ X and all r > 0, whenever d(x, z) < 2r there exists a chain of balls B(x, r) =
B(y0, r), . . . , B(ym, r) satisfying m ≤ K, z ∈ B(ym, r) and for j = 0, . . . , m − 1, B(yj, r) ∩
B(yj+1, r) 6= ∅. Then µ is D C 2K+3
Proof. Cover B(x, 2r) with at most D balls of radius r. Of course, any ball that does not
intersect B(x, 2r) can be disregarded, so suppose B(w, r) is one of the balls in the cover, and
let z ∈ B(w, r)∩ B(x, 2r). Since d(x, z) < 2r, there is an intersecting chain of balls B(x, r) =
B(y1, r), . . . , B(ym, r) such that m ≤ K and z ∈ B(ym, r). By repeated application of Lemma
3.3, together with the fact that d(ym, z) < r, we conclude that µ(B(z, r)) ≤ C 2K+1
µ(B(x, r)),
so µ(B(w, r)) ≤ C 2K+3
(cid:3)

µ(B(x, r)), and the result follows.

- doubling.

µ

µ

µ

Next we indicate some conditions ensuring that the hypothesis of the previous lemma holds.

Deﬁnition 5.6. A metric space has the approximate midpoint property if for every ε > 0 and
every pair of points x, y, there exists a point z such that d(x, z), d(z, y) < ε + d(x, y)/2.
Deﬁnition 5.7. A metric space is quasiconvex if there exists a constant C ≥ 1 such that for
every pair of points x, y, there exists a curve with x and y as endpoints, such that its length
is bounded above by Cd(x, y).

We say that B(y0, r), . . . , B(ym, r) form an intersecting chain of balls if for j = 0, . . . , m−1,

B(yj, r) ∩ B(yj+1, r) 6= ∅.

20

J. M. Aldaz

Corollary 5.8. Let (X, d, µ) be a metric measure space, D-geometrically doubling, and such
that µ satisﬁes a local comparability condition.
If either all balls are connected, or X is
quasiconvex, or it has the approximate midpoint property, then µ is doubling.

Proof. Whenever we have a cover, we assume that all sets in it intersect the set to be covered;
otherwise, we disregard those not satisfying the condition.

Fix B0 := B(x, r). Suppose ﬁrst that all the balls of X are connected. Let the collection
C := {B(x1, r), . . . , B(xM , r)} be a cover of B(x, 2r) with M ≤ D, and write Bi := B(xi, r).
Let C′ be the collection of all balls Bi in C for which there is an intersecting chain of balls
starting at B0 and ﬁnishing with Bi. Then C = C′, for otherwise the union of all balls in C′
and the union of all balls in C \ C′ would form a disconnection of B(x, 2r). Adding B0 to the
balls in the cover, we see that the maximal lenght of any chain is M + 1 ≤ D + 1.
Suppose next that X is quasiconvex with constant CX (any constant satisfying Deﬁniton
5.7; there might not be a smallest one). Choose y with d(x, y) < 2r. Then there exists a
curve c : [0, 1] → X starting at x and ﬁnishing at y (that is, c(0) = x, c(1) = y) such that its
length L(c) satisﬁes L(c) < CX2r. Let K = [L(c)/r] + 1, where [L(c)/r] denotes the integer
part of L(c)/r. Divide c into K subsegments of equal length, with endpoints x0 = x, x1, ...,
xK−1, xK = y. Then the balls {B(x0, r), . . . , B(xK−1, r)} form an intersecting chain of length
K ≤ [2CX] + 1.
The argument for the case where X has the approximate midpoint property is similar and
simpler, so we omit it.
(cid:3)

If none of the conditions in the preceding result hold, the equivalence between local com-

parability and doubling can fail, even for arc-connected spaces.

Theorem 5.9. There exists an arc-connected, geometrically doubling metric measure space
(X, d, µ), such that X ⊂ R2, d is deﬁned by the restriction of the ℓ∞-norm to X, and µ
satisﬁes a local comparability condition but is not doubling.
Proof. On R set dν(x) = dx for x ≤ 1, and dν(x) = xdx for x ≥ 1 (we mention that ν
does not satisfy a local comparability condition, since limx→∞ ν([0, x])/ν([−x, 0]) = ∞, so
in particular it is not doubling). Next we deﬁne an embedding f : R → R2 as follows:
f : (−∞,−1] → [0,∞) × {0} is given by f (t) = (−1 − t, 0), f : [−1, 0] → {0} × [0, 1] is
given by f (t) = (0, 1 + t), and f : [0,∞) → [0,∞) × {1}, by f (t) = (t, 1). Then we set
X := f (R) ⊂ R2, with d on X deﬁned by the ℓ∞ norm on the plane: d((a, b), (c, d)) =
max{|a − c|,|b − d|}. Let µ be the pushforward measure f∗ν, so µA := ν(f−1(A)). Then
limx→∞ µ(B((x, 0), 2)/µ(B((x, 0), 1) = ∞, so µ is not doubling. However, since B((x, 0), t) =
B((x, 1), t) for t > 1, while B((x, 0), t) ∩ B((x, 1), t) = ∅ for 0 < t ≤ 1 and x ≥ 1, it
is not diﬃcult to see that µ satisﬁes a local comparability condition. More precisely, let
S := f (−∞, 1] and note that on S, µ is just length. Thus, for balls centered at points
x = (t, 0) or x = (0, t) with r ≤ 1, the result is clear, while if r > 1, then x = (t, 1) is also a
center of B((t, 0), r)), so it is enough to consider the case x = (t, 1), t ≥ 0. Since

µ(S ∩ B((t, 1), r)) ≥ µ(S ∩ B((t + r, 1), r)),

Local comparability of measures

we have

µ(B((t + r, 1), r))

µ(B((t, 1), r))

=

µ(S ∩ B((t + r, 1), r)) + µ(Sc ∩ B((t + r, 1), r))

µ(S ∩ B((t, 1), r)) + µ(Sc ∩ B((t, 1), r))

udu
udu ≤ 4.
(A more involved argument yields the optimal constant C(µ) = 2).

µ(Sc ∩ B((t, 1), r)) ≤ R t+2r
µ(Sc ∩ B((t + r, 1), r))
R t+r

≤

t

t

21

(cid:3)

Note that in the space X = f (R) deﬁned above, if x ≥ 2, then Blu((x, 0), 1, 1) does not
contain any ball strictly larger than B((x, 0), 1); in particular, for all t > 0, B((x, 0), 1 + t) 6⊂
Blu((x, 0), 1, 1). So even in arc-connected spaces, blossoms and balls can be rather diﬀerent.
On the other hand, if there exists a ﬁxed t > 0 such that for every x ∈ X and every r > 0,
B(x, (1 + t)r) ⊂ Bl(x, r, r), then boundedness of blossoms entails doubling.

6. Remarks on spaces that may fail to be geometrically doubling

Boundedness of blossoms does not imply that X is geometrically doubling.

Theorem 6.1. There exists a metric measure space (X, d, µ), such that (X, d) is not geomet-
rically doubling, µ satisﬁes a local comparability condition, and blossoms boundedly. Further-
more, µ can be chosen to have full support.
Proof. We use the inﬁnite broom B ⊂ R2, B := ∪n∈N{nx : x ≥ 0}, with d the path metric.
Now for n ≥ 1, let xn ∈ {nx : x ≥ 0} be the only point that satisﬁes d(0, xn) = 1/n. Set
X := {0} ∪ {xn : n ≥ 1} ⊂ B, with the distance inherited from B. To see that (X, d) is not
geometrically doubling, note that B(0, 1/n) contains the following disjoint balls: B(0, 1/(2n)),
B(xn+1, 1/(2n)), . . . , B(x2n, 1/(2n)). Next, let µ = δ0 be the point mass at the origin. It two
balls B1, B2 centered at points of X intersect, they both must contain 0, so µB1 = µB2 = 1,
and hence C(µ) = 1. Blossoming at 0 does not change the mass, while blossoming at other
points leads to either not increasing the original ball, or not increasing its measure: If 0 /∈
B(xk, r), then Blu(xk, r, r) = B(xk, r), and if 0 ∈ B(xk, r), then µBlu(xk, r, r) = µB(xk, r) =
1.
One can easily modify µ so that it also has full support: In addition to the Dirac delta at
(cid:3)

the origin, give mass 2−n to each xn, and argue essentially as before.

Beyond geometrically doubling metric spaces, it is unclear to me whether or not local com-
parability suﬃces to obtain boundedness results for the Hardy-Littlewood maximal operator.
Of course, if blossoms are bounded, then the usual Vitali covering argument works. Neverthe-
less, in speciﬁc and natural examples, such as volume in hyperbolic spaces (cf. [Str], [LiLo]),
blossoms are not bounded, and still weak type (1, 1) bounds hold for the centered maximal
operator (the uncentered operator is in general unbounded, as can be seen by considering
just one Dirac delta in the hyperbolic plane). A rather diﬀerent instance of this phenomenon
is presented in [NaTa, Theorem 1.5], where boundedness of the maximal operator is obtained
for the inﬁnite, rooted k-ary tree with the standard graph metric. In these examples, however,

22

J. M. Aldaz

one not only has local, but global comparability with constant 1, since the measure of balls
only depends on the radius, and not the center.

While writing this paper I found [SoTr], where local comparability is considered, under the
name of “equidistant comparability property”, in the speciﬁc case of connected graphs with
all vertices having ﬁnite degree. Here X is the set of vertices V of a graph, d(x, y) is deﬁned
as the smallest number of edges one needs to traverse in order to go from x to y, and µ is the
counting measure. Since all vertices have ﬁnite degree, the measure of all balls is ﬁnite, and
we are within the general framework considered in the present paper. For instance, it is easy
to check that for the metric measure spaces considered here, the centered maximal operator
acting on just one Dirac delta is weak (1,1) bounded, with bound Cµ (this is so even if the
Dirac delta is placed at a point outside the support of µ). The special case of this result for
graphs appears in [SoTr, Proposition 2.10].

References

[A]

J.M. Aldaz, The weak type (1, 1) bounds for the maximal function associated to cubes grow to inﬁnity
with the dimension, Ann. of Math. (2) 173 (2011), no. 2, 1013–1023.

[AuCa] P. Auscher and M.J. Carro, Transference for radial multipliers and dimension free estimates, Trans.

[Bou1]

[Bou2]

[Bou3]

[Ca]

Amer. Math. Soc. 342 (1994), no. 5, 575–593.
J. Bourgain, On high-dimensional maximal functions associated to convex bodies, Amer. J. Math.
108 (1986), no. 6, 1467–1476.
J. Bourgain, On the Lp-bounds for maximal functions associated to convex bodies in Rn. Israel J.
Math. 54 (1986), no. 3, 257–265.
J. Bourgain, On the Hardy-Littlewood maximal function for the cube, Israel J. Math. 203 (2014), no.
1, 275–293.
A. Carbery, An almost-orthogonality principle with applications to maximal functions associated to
convex bodies, Bull. Amer. Math. Soc. (N.S.) 14 (1986), no. 2, 269–273.

[CriSjo] A. Criado and P. Sj¨ogren, Bounds for maximal functions associated with rotational invariant mea-

sures in high dimensions, J. Geom. Anal. 24 (2014), 595–612.

[CoWe1] R. R. Coifman, . G. Weiss, Analyse harmonique non-commutative sur certains espaces homog`enes.
´Etude de certaines int´egrales singuli`eres. Lecture Notes in Mathematics, Vol. 242. Springer-Verlag,
Berlin-New York, 1971.

[CoWe2] R. R. Coifman, . G. Weiss, Extensions of Hardy spaces and their use in analysis. Bull. Amer. Math.

[Fre]
[Gra]

Soc. 83 (1977), no. 4, 569–645.
D.H. Fremlin, Real valued measurable cardinals. Version of 19.9.09.
L. Grafakos, Classical Fourier analysis. Third edition. Graduate Texts in Mathematics, 249.
Springer, New York, (2014).

[GraB] L. Grafakos, Modern Fourier analysis. Second edition. Graduate Texts in Mathematics, 250.

Springer, New York, 2009.
[He]
J. Heinonen, Lectures on analysis on metric spaces. Universitext. Springer-Verlag, New York, 2001.
[HKST] J. Heinonen, P. Koskela, N. Shanmugalingam, J. T Tyson, Sobolev spaces on metric measure spaces.
An approach based on upper gradients. New Mathematical Monographs, 27. Cambridge University
Press, Cambridge, 2015.
A.S. Iakovlev and J.-O. Str¨omberg, Lower bounds for the weak type (1, 1) estimate for the maximal
function associated to cubes in high dimensions, Math. Res. Letters 20 (2013) no. 5, 907–918.
E. Lindenstrauss, Pointwise theorems for amenable groups. Invent. Math. 146 (2001), no. 2, 259295.

[IaSt]

[Li]

Local comparability of measures

23

[LiLo]

[LuSa]

[Mu]

H.-Q. Li and N. Lohou´e, Fonction maximale centr´ees de Hardy-Littlewood sur les espaces hyper-
boliques, Ark. f¨or Mat. 50 (2012), no. 2, 359–378.
J. Luukkainen, E. Saksman, Every complete doubling metric space carries a doubling measure. Proc.
Amer. Math. Soc. 126 (1998), no. 2, 531–534.
D. M¨uller, A geometric bound for maximal functions associated to convex bodies, Paciﬁc J. Math.
142 (1990), no. 2, 297–312.

[NaTa] A. Naor and T. Tao, Random martingales and localization of maximal inequalities, J. Funct. Anal.

[St1]

[St2]

[St3]

[SoTr]

259 (2010), no. 3, 731–779.
J. Soria and P. Tradacete, Geometric properties of inﬁnite graphs and the Hardy-Littlewood maximal
operator. arXiv:1602.01029
E.M. Stein, The development of square functions in the work of A. Zygmund. Bull. Amer. Math.
Soc, (N.S.) 7 (1982), no. 2, 359–376.
E.M. Stein, Three variations on the theme of maximal functions, Recent progress in Fourier analysis
(El Escorial, 1983), 229–244, North-Holland Math. Stud., 111, North-Holland, Amsterdam, 1985.
E.M. Stein, Harmonic analysis:
Princeton University Press, Princeton, NJ, 1993.
E. M. Stein, J. O. Str¨omberg, Behavior of maximal functions in Rn for large n. Ark. Mat. 21 (1983),
no. 2, 259–269.
J. O. Str¨omberg, Weak type L1 estimates for maximal functions on noncompact symmetric spaces.
Ann. of Math. (2) 114 (1981), no. 1, 115–126.
X. Tolsa, Analytic capacity, the Cauchy transform, and non-homogeneous Calder´on-Zygmund theory.
Progress in Mathematics, 307. Birkhauser/Springer, 2014.
[Web] Webster, R. J. Convexity (Oxford University Press, 1997).

real-variable methods, orthogonality, and oscillatory integrals,

[StSt]

[Str]

[To]

Instituto de Ciencias Matem´aticas (CSIC-UAM-UC3M-UCM) and Departamento de Matem´aticas,

Universidad Aut´onoma de Madrid, Cantoblanco 28049, Madrid, Spain.

E-mail address: jesus.munarriz@uam.es
E-mail address: jesus.munarriz@icmat.es

