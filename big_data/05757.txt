6
1
0
2

 
r
a

 

M
8
1

 
 
]

.

A
O
h
t
a
m

[
 
 

1
v
7
5
7
5
0

.

3
0
6
1
:
v
i
X
r
a

Equilibrium states on graph algebras

Astrid an Huef and Iain Raeburn

Abstract We consider operator-algebraic dynamical systems given by actions of
the real line on unital C∗-algebras, and especially the equilibrium states (or KMS
states) of such systems. We are particularly interested in systems built from the
gauge action on the Toeplitz algebra and graph algebra of a ﬁnite directed graph,
and we describe a complete classiﬁcation of the KMS states obtained in joint work
with Laca and Sims. We then discuss applications of these results to Cuntz-Pimsner
algebras associated to local homeomorphisms, obtained in collaboration with Afsar.
Thomsen has given bounds on the range of inverse temperatures at which KMS
states may exist. We show that Thomsen’s bounds are sharp.

1 Introduction

There has recently been a renewal of interest in the equilibrium states (the KMS
states) of operator-algebraic dynamical systems consisting of an action of the real
line (the dynamics) on a C∗-algebra. There has been particular interest in systems
involving graph algebras and their Toeplitz extensions [7, 11, 18, 3].

Very satisfactory results have been obtained for sytems associated to ﬁnite di-
rected graphs, and we now have concrete descriptions of the simplices of KMSb
states on the Toeplitz algebras at all inverse temperatures b
[9, 10]. Here we review
these results, and discuss some surprising applications to work of Thomsen on sys-
tems involving the Cuntz-Pimsner algebras of local homeomeorphisms [17]. One
main conclusion of our recent work with Afsar [1] is that lower and upper bounds
for the possible inverse temperatures given by Thomsen are sharp. For these appli-

Astrid an Huef and Iain Raeburn
Department of Mathematics and Statistics, University of Otago, PO Box 56, Dunedin 9054, New
Zealand.
e-mail: {astrid, iraeburn}@maths.otago.ac.nz

1

2

Astrid an Huef and Iain Raeburn

cations we do not need the full strength of the general results in [10], and in this
article we describe a more direct approach.

2 The Toeplitz algebra of a graph

We suppose that E = (E0,E1,r,s) is a ﬁnite directed graph. A Toeplitz-Cuntz-
Krieger E-family consists of mutually orthogonal projections {Pv : v ∈ E0} and par-
tial isometries {Se : e ∈ E1} in a C∗-algebra such that S∗
eSe = Ps(e) for every e ∈ E1
and

Pv ≥ (cid:229)

SeS∗

e for every v ∈ E0

(1)

r(e)=v

(where we interpret an empty sums as 0). Since the vertex projections are mutually
orthogonal, the relation (1) implies that the range projections SeS∗
e are also mutually
orthogonal. (See [9, Corollary 1.2], for example.)

For n ≥ 2, we write

En :=(cid:8)m = m 1m 2 · · · m n : s(m i) = r(m i+1) for 1 ≤ i < |m | := n(cid:9)

for the set of paths of length n in E, and note that Sm

isometry for every m ∈ En. We write E ∗ :=Sn≥0 En for the set of ﬁnite paths. Then

for m ,n ,a ,b ∈ E ∗ we have the product formula

:= Sm 1Sm 2 · · ·Sm n is a partial

′S∗b

′

(Sm S∗n )(Sa S∗b ) =


Sma
Sm S∗bn
0

′

if a = na
if n = an
otherwise.

′

(2)

The Toeplitz algebra T C∗(E) of E is the C∗-algebra generated by a universal
Toeplitz-Cuntz-Krieger E-family (p,s). The product formula (2) implies that the
elements {sm s∗n

: m ,n ∈ E ∗} span a ∗-subalgebra of T C∗(E), and hence we have

T C∗(E) = span{sm s∗n

: m ,n ∈ E ∗}.

The quotient of T C∗(E) by the ideal generated by the gap projections

npv − (cid:229)

r(e)=v

ses∗

e : v ∈ E0o

is the usual graph algebra or Cuntz-Krieger algebra C∗(E).

For every graph E there is a canonical Toeplitz-Cuntz-Krieger E-family (Q,T )
on the ﬁnite-path space ℓ2(E ∗), characterised by the following actions on the usual
orthonormal basis {hm

: m ∈ E ∗}:

Equilibrium states on graph algebras

3

Qvhm =(hm

0

if v = r(m )
otherwise

and Tehm =(hem

0

if s(e) = r(m )
otherwise.

The universal property of T C∗(E) then gives a representation p T = p Q,T of T C∗(E)
on ℓ2(E ∗) such that p T (pv) = Qv and p T (se) = Te; we call p T the ﬁnite-path rep-
resentation. The gap projections Qv − (cid:229)
e are the projections on Chv, and
hence are all nonzero. Thus the uniqueness theorem for Toeplitz algebras [8, Corol-
lary 4.2] implies that p T is faithful.

r(e)=v TeT ∗

There is a gauge action g : T → Aut T C∗(E) such that g z(pv) = pv and g z(se) =
zse, and this induces the usual gauge action on the quotient C∗(E). We are interested
in the dynamics a
eit , and its analogue on C∗(E).
In particular, we wish to study the KMS states for this dynamics.

: R → Aut T C∗(E) given by a t = g

3 KMS states on the Toeplitz algebra

The spanning elements sm s∗n for T C∗(E) are are all analytic for the action a . Hence
if f

is a KMSb state on (T C∗(E),a ), we have

f (sm s∗n ) = f (s∗n a ib (sm )) = e−b |m |f (s∗n sm )

= e−b (|m |−|n |)f (sm s∗n ).

So f (sm s∗n ) 6= 0 =⇒ |m | = |n |, and then

f (sm s∗n ) 6= 0 =⇒(cid:0)s∗n sm

6= 0 and |m | = |n |(cid:1) =⇒ m = n .

Now a routine computation using the product formula (2) gives the following:

Lemma 3.1 [9, Proposition 2.1] A state f on T C∗(E) is KMSb

for a

if and only if

f (sm s∗n ) = d m ,n e−b |m |f (ps(m )).

Suppose f

is a KMSb state on (T C∗(E),a ). Then for each v ∈ E0 the Toeplitz-

Cuntz-Krieger relation gives
f (pv) ≥ (cid:229)

f (ses∗

e) = (cid:229)

e−b f (ps(e)),

(3)

r(e)=v

r(e)=v

where we interpret the empty sum as 0 if v is a source. The vertex matrix of E is the
E0 × E0 integer matrix A with entries

A(v,w) = |r−1(v) ∩ s−1(w)|.

We can rewrite the inequality (3) as

4

b f (pv) ≥ (cid:229)

e

f (pw) = (cid:229)

Astrid an Huef and Iain Raeburn
A(v,w)f (pw),

(4)

w∈E0

r(e)=v, s(e)=w

w∈E0

so m = (mv) := (f (pv)) ∈ [0,¥ )E0 satisﬁes Am ≤ eb m; we say that m is a subinvari-
ant vector for A.
If f factors through a KMSb state of C∗(E), then we have equality throughout (3)
and (4), and m satisﬁes Am = eb m. If E is strongly connected, A is irreducible and
eb has to be the Perron-Frobenius eigenvalue of A. The Perron-Frobenius theorem
then says many things: thus in particular we know that the eigenvalue is the spectral
radius r (A), that the eigenspace is one-dimensional, and that there is an eigenvector
with positive entries (see [4, Theorem 2.6] or [16, Theorem 1.6]). Since f
is a state,
we have

1 = f (1) = (cid:229)

f (pv) = (cid:229)

v

mv,

v

and hence m =(cid:0)f (pv)(cid:1)v∈E0 is the unique eigenvector in (0,¥ )E0 with kmk1 = 1.

The formula in Lemma 3.1 says that f (sm s∗n ) = d m ,n e−b |m |ms(m ) for all m ,n ∈ E ∗,
so the vector m completely determines the state f . Thus we recover the following
elegant result of Enomoto, Fujii and Watatani [5]:

Theorem 3.2. Suppose that E is a strongly connected graph with vertex matrix A.
Then (C∗(E),a ) has at most one KMS state. This state has inverse temperature
lnr (A), where r (A) is the spectral radius of A.

They proved existence of the KMSlnr (A) state too, but we’ll get to that.
For states on T C∗(E), the vector m only satisﬁes the subinvariance relation
Am ≤ eb m, but when A is irreducible Perron-Frobenius theory has things to say
about this too. For example:
• If Am ≤ eb m and b = lnr (A), then Am = eb m, so that m is the Perron-Frobenius

eigenvector.

• Suppose that Am ≤ eb m. Then Am 6= eb m ⇐⇒ b > lnr (A).
This suggests that we look more carefully at b
perature b c := lnr (A).

larger than the critical inverse tem-

So we consider b > lnr (A). We ﬁnd it interesting that, although we were moti-
vated to do so by the Perron-Frobenius theory, which applies only when E is strongly
connected, the following analysis does not require any connectivity hypothesis on
E. Thus we consider an arbitrary ﬁnite directed graph E, which could have sinks or
sources, and a KMSb state f on T C∗(E).

> r (A), eb

Take m =(cid:0)f (pv)(cid:1) as before. Then e := (1 −e−b A)m has nonnegative entries, not

all 0. Since eb
is not in the spectrum of A, and 1 − e−b A is invertible.
Thus we can recover m as (1 − e−b A)−1e . Our main point is that we can describe
geometrically the set of e ∈ [0,1]E0 which arise from unit vectors m in ℓ1(E0). For
v ∈ E0, deﬁne yb

∈ [1,¥ )E0 by

(cid:229)
Equilibrium states on graph algebras

b
v :=

y

n=0

w∈E0

e−b nAn(w,v) = (1 − e−b

A)−1d v;

5

(5)

the series converges because (cid:229) n e−b nAn converges in the operator norm with sum
(1 − e−b A)−1. Then m := (1 − e−b A)−1e has kmk1 = 1 if and only if

1 = e · y

b

:= (cid:229)

v∈E0

e vy

b
v

(see Theorem 3.1(a) of [9]).

Then the main theorem of [9] says:

Theorem 3.3. Suppose E is a ﬁnite graph with vertex matrix A, and b > lnr (A).
Suppose e · yb

= 1. Then there is a KMSb state f e of T C∗(E) such that

f e (pv) =(cid:0)(1 − e−b

A)−1e (cid:1)v

is an isomorphism of D b = {e

The map e
KMSb states of (T C∗(E),a ).

7→ f e

for all v ∈ E0.

: e · yb

= 1} onto the simplex of

We proved existence of the KMS state f e

in [9, Theorem 3.1(b)] by a spatial
argument using the ﬁnite-path representation p T of T C∗(E) on ℓ2(E ∗). Then sur-
jectivity of e
7→ f e amounts to our earlier observation that the subinvariant vector

m =(cid:0)f (pv)(cid:1)v∈E0 determines a KMS state f .

The set D b = {e : e · yb

= 1} parametrising the KMSb states is a simplex in the
positive cone [0,¥ )E0 of RE0 with extreme points on the coordinate axes, and the
vector yb
is normal to this simplex. As b decreases to the critical value b c = lnr (A),
the terms in the series on the right-hand side of (5) get larger, and the simplex
contracts towards the origin.

The preceding analysis does not apply when b = b c = lnr (A) is critical, because
then the matrix 1 − e−b A need not be invertible. However, we can take a sequence
b n decreasing to lnr (A), and use weak* compactness of the state space to get a
KMSlnr (A) state of T C∗(E) [9, Proposition 4.1]. When E is strongly connected,
this is the only KMSlnr (A) state, and we can deduce from Perron-Frobenius that it
factors through the graph algebra C∗(E). In particular, we recover the existence of
the KMSlnr (A) state, ﬁrst established by other methods in [5].

We can sum up our discussion as follows:

Corollary 3.4 Suppose that E is a directed graph with vertex matrix A, and that
b ∈ (0,¥ ) satisﬁes b ≥ lnr (A). Then the map f
the set of KMSb states of (T C∗(E),a ) onto the unit vectors m in [0,¥ )E0
satisfying the subinvariance relation Am ≤ eb m.

:=(cid:0)f (pv)(cid:1) is a bijection of

⊂ ℓ1(E0)

7→ mf

For b > lnr (A), Theorem 3.3 is stronger, because it describes the solutions of
the subinvariance relation. But for some applications, such as those in §4, we can
deal directly with the subinvariance relation in an ad hoc manner.

¥
(cid:229)
(cid:229)
6

4 Dumbbell graphs

Astrid an Huef and Iain Raeburn

We say that a graph E is reducible if it is not strongly connected, or equivalently if
its vertex matrix A is not irreducible. For v,w ∈ E0, we write v ≤ w to mean that

vE ∗w := {m ∈ E ∗ : r(m ) = v and s(m ) = w}

is nonempty (or in other words, that there is a path from w to v). Then we deﬁne a
relation ∼ on E0 by

v ∼ w ⇐⇒ v ≤ w and w ≤ v.

This is an equivalence relation (it is reﬂexive because v ∈ vE ∗v), and we write E0/∼
for the set of equivalence classes.

For each C ∈ E0/∼, we deﬁne AC to be the C ×C matrix obtained by deleting all
rows and columns involving vertices not in C. We can view AC as the vertex matrix
of the subgraph EC := (C,E1 ∩ r−1(C) ∩ s−1(C),r,s). Each AC is either a 1 × 1 zero
matrix (if C is a singleton set {v} and there is no loop at v) or an irreducible matrix
(in which case we call EC a strongly connected component of E). It is possible to
order the set E0 so that the vertex matrix A is block upper-triangular with diagonal
blocks AC (see [10, §2.3]), and it follows that r (A) = maxC r (AC).

Now we consider the KMS states on T C∗(E) when E is reducible. There are

three situations that we have to deal with:
• For b > lnr (A), Theorem 3.3 applies, and we have a (|E0| − 1)-dimensional

simplex of KMSb states on T C∗(E).

• For b = lnr (A), we focus on the critical components C ∈ E0/ ∼ that have
r (AC) = r (A). The relation ≤ descends to a well-deﬁned relation on the set of
critical components, and then a critical component C is minimal if D critical and
D ≤ C imply D = C. The behaviour of the KMSlnr (A) states of T C∗(E) depends
on the location of the minimal critical components.

• Recall that a subset H of E0 is hereditary if v ∈ H and v ≤ w imply w ∈ H, and

that the Toeplitz algebra T C∗(E\H) of the graph

E\H := (E0\H,E1 ∩ s−1(E0\H),r,s)

is a quotient of T C∗(E) [10, Proposition 2.1]. For b < lnr (A), we consider the
hereditary subset H of E0 generated by the critical components (which is also
generated by the minimal critical components). If H is not all of E0, then we can
apply Theorem 3.3 to E\H and get KMSb states of T C∗(E) for lnr (AE\H) <
b < lnr (A) which factor through the quotient map onto T C∗(E\H).
The ﬁrst and third situations both require straightforward applications of The-
orem 3.3, and the interesting things happen when b = lnr (A) is critical. Then
the phrase “depends on the location of the minimal critical components” needs
clariﬁcation. We illustrate its meaning with some examples, which fortunately are
enough for the main applications in [1]. The key feature of these examples is that

Equilibrium states on graph algebras

7

the strongly connected components have just one vertex each. We call such graphs
dumbbell graphs.

Example 1. We consider the following graph E:

v

w

for which r (A) = 3. In this example, the hereditary closure of the critical component
{w} is all of E0, and hence the third situation does not arise.

If we list E0 = {w,v}, then A =(cid:0) 3 1

and the subinvariance relation Am ≤ eb m says

0 2(cid:1). For b = lnr (A) = ln 3 we have eb

= 3,

0 2(cid:19)(cid:18)mw

Am =(cid:18)3 1
The only unit vector in [0,¥ )E0
⊂ ℓ1(E0) which satisﬁes this relation is m = (1,0).
Thus Corollary 3.4 says there is a unique KMSln3 state on T C∗(E). This state
factors through C∗(E).

3mv (cid:19) ≤ 3(cid:18)mw
mv(cid:19) .

mv(cid:19) =(cid:18)3mw + mv

Example 2. Next we switch the horizontal arrow, so E is

v

w

With E0 = {v,w}, A =(cid:0) 2 1

This graph also has just one critical component {w}, but this time {w} is hereditary,
and the graph E\H has vertex set {v}, so the third situation kicks in.

0 3(cid:1), and subinvariance for b = ln 3 reduces to mv ≤ mw.

We ﬁnd:

• For b > ln 3, we have a one-dimensional simplex of KMSb states on T C∗(E),

none of which factor through C∗(E).

• The simplex of KMSln3 states on T C∗(E) has extreme points f v (mv = mw = 1
2 )
• For ln 2 ≤ b < ln 3, there is a unique KMSb state f v on T C∗(E) which factors

and f w (mv = 0); only f w factors through a state of C∗(E).

through the quotient map corresponding to the hereditary set {w} ⊂ E0.

• For b = ln 2, the state f v factors through C∗(E).
• For b < ln 2, there are no KMSb states on T C∗(E).

When a minimal strongly connected component EC has more than one vertex,
we organise the block form for A in three pieces: we take the hereditary closure H
of the critical components, and decompose E0 = (E0\H) ∪C ∪ (H\C). The Perron-
Frobenius eigenvector for AC gives a KMSlnr (A) state y C that has f (pv) = 0 for

8
Astrid an Huef and Iain Raeburn
v ∈ H\C, but has f (pv) 6= 0 for vertices v such that vE ∗C 6= /0: the precise formula
is given in [10, Theorem 4.3(a)]. Since r (AE\H) < r (A), we can also use Theo-
rem 3.3 to ﬁnd KMSlnr (A) states on T C∗(E\H), and lift them to KMSlnr (A) states
of T C∗(E). Again the formulas and the complete classiﬁcation are given in [10,
Theorem 4.3].

To construct KMS states on the usual graph algebra C∗(E), we need to know
which states on T C∗(E) factor through C∗(E). Here we hit another subtlety: distinct
hereditary sets give distinct ideals in T C∗(E) but not necessarily in C∗(E), where
the ideal in C∗(E) associated to a hereditary subset H of E0 depends only on the
saturation of H. This problem is solved in [10, Theorem 5.3], which gives a recipe
for ﬁnding all the KMSb states of T C∗(E) and C∗(E) for ﬁxed b .

5 C∗-algebras from local homeomorphisms

We consider a compact Hausdorff space Z and a surjective local homeomorphism
h : Z → Z. In our main examples in the next section, Z will be the inﬁnite-path space
E¥ of a ﬁnite directed graph with the topology inherited from the product space
(E1)

, and h will be the backward shift s deﬁned by
s (e1e2e3 · · · ) = e2e3 · · · .
If E has no sources, then s
is a homeomorphism on each cylinder set Z(m ), and
hence is a local homeomorphism; if E has no sinks, then s
is also surjective. So
we shall suppose in the rest of this paper that E is a ﬁnite graph with no sinks or
sources, and then s
is a good example to bear in mind for this section.
We can view C(Z) as a Hilbert bimodule X over the C∗-algebra C(Z), by setting

→ E¥

: E¥

(a · x · b)(z) = a(z)x(z)b(h(z)) and
hx,yi(z) = (cid:229)

h(w)=z

x(w)y(w)

for x,y ∈ X.

This Hilbert bimodule has both a Toeplitz algebra T (X) and a Cuntz-Pimsner al-
gebra O(X): the Toeplitz algebra is generated by a representation (y ,p ) charac-
terised by y (a · x · b) = p (a)y (x)p (b) and p (hx,yi) = y (x)∗y (y), and the Cuntz-
Pimsner algebra [14] is a quotient of T (X). For our purposes, all the necessary
background material is in Chapter 8 of [15]. The Cuntz-Pimsner algebra O(X) is an
example of Katsura’s topological-graph algebras: in the conventions of [15, Chap-
ter 9] (which are a little different from those in Katsura’s original paper [12]), the
graph is (Z,Z,id,h).

The Toeplitz algebra T (X) carries a gauge action g of the circle characterised
by g z(y (x)) = zy (x) and g z(p (a)) = p (a), and this lifts to a dynamics a
eit .
The kernel of the quotient map onto O(X) is invariant under g , and hence we also
get a dynamics on O(X) (still denoted by a ).

: t 7→ g

¥
Equilibrium states on graph algebras

9
Thomsen [17] has studied the KMS states of the quotient system (O(X),a ) (and
he worked with much more general systems (Z,h) ). He showed that the possible
inverse temperatures of the KMS states all lie in a ﬁnite interval [b l,b c], and gave
formulas for upper and lower bounds:

b c = lim sup

n→¥

b l = lim sup

n→¥

z∈Z

(cid:16)n−1 ln(cid:16) max
(cid:16)n−1 ln(cid:16) min

z∈Z

|h−n(z)|(cid:17)(cid:17), and
|h−n(z)|(cid:17)(cid:17)

(applying [17, Theorem 6.8] with the function F ≡ 1; see [1, Remark 6.3] for the
connections with Thomsen’s notation). We are not aware that Thomsen has dis-
cussed the extent to which these bounds might be sharp.

In our recent work with Afsar [1], we have studied the KMS states of the
Toeplitz system (T (X),a ). We viewed C(Z) as a continuous analogue of the (ﬁnite-
dimensional) space C(E0), and followed the strategy of [9]. We found that, for in-
larger than Thomsen’s b c, the KMSb states are parametrised
verse temperatures b
by a simplex S b of ﬁnite measures e on Z satisfying a normalisation condition of
the form

Z fb de = 1,

where fb
is a ﬁxed continuous function deﬁned by summing a series like that deﬁn-
in (5) [1, Theorem 5.1]. At b c, there is a phase transition: we can see by
ing yb
passing to limits as b decreases to b c+ that there exist KMSb c states on T (X), and
can argue by mimicking our earlier results in [9] that at least one of them factors
through O(X). (This is Theorem 6.1 in [1].) So, in our generality at least, Thom-
sen’s upper bound is sharp.

If E is a ﬁnite graph, then there is a natural Hilbert bimodule X(E) over the
commutative C∗-algebra C(E0), and the Toeplitz algebra T (X(E)) was the original
model of the Toeplitz-Cuntz-Krieger algebra T C∗(E) (see [8] and [15, Chapter 8]).
This bimodule is not given by a local homeomorphism, so it does not quite ﬁt the
set-up of the present section, but the analysis of [1] was inspired by analogy with
that of [9]. As we mentioned earlier, we can also directly apply the results of [1] to
the shift s on the compact path space E¥
, and this gives another connection to the
results of [9] and [10].

6 Shifts on path spaces

→ E¥

. Then E¥

is a compact Hausdorff space and the backward shift s

We consider again a ﬁnite directed graph E with no sinks or sources, and the inﬁnite-
path space E¥
:
E¥
is a surjective local homeomorphism. So as in §5, we can consider the
Hilbert bimodule over the commutative C∗-algebra C(E¥
) with underlying space
X = C(E¥
) for X to emphasise that this is
not the graph bimodule X(E) studied in [8] and [15, Chapter 8].

). At this point we choose to write X(E¥

10

Astrid an Huef and Iain Raeburn

The topology on E¥
¥ of the ﬁnite set E1, and the cylinder sets

(E1)

arises from viewing it as a subset of the inﬁnite product

Z(m ) = {x ∈ E

: xi = m i for i ≤ |m |}

. Then a straightforward calculation shows:

associated to ﬁnite paths m ∈ E ∗ form a basis of compact-open sets for the topology
on E¥
Lemma 6.1 The elements Pv := p (c Z(v)) and Se := y (c Z(e)) of T (X(E¥
Toeplitz-Cuntz-Krieger E-family.

)) form a

The universal property of the Toeplitz algebra T C∗(E) now gives a homomor-
phism p P,S : T C∗(E) → T (X(E¥
)). Corollary 4.2 of [8] implies that this homo-
morphism is injective, and it is equivariant for the gauge actions, and hence for
the various dynamics a studied in §3 and §5. So composing with p P,S takes KMSb
states of (T (X(E¥
)),a ) to KMSb states of (T C∗(E),a ). Now we have KMSb
states of T (X(E¥
larger than Thomsen’s b c, and KMSb states of T C∗(E)
)) for b
for b > lnr (A), where A is the vertex matrix of E. We reconcile this in the following
reassuring lemma, which is Proposition 7.3 of [1]. (Note that the condition on E is
there to ensure that r (A) > 0, so that lnr (A) makes sense.)

Lemma 6.2 Suppose that E is a directed graph with at least one cycle. Then

1
n

ln(cid:16) max

x∈E¥

|s −n(x)|(cid:17) → lnr (A) as n → ¥

.

in Theorem 3.3
is a

Thus Thomsen’s b c is our lnr (A), and the range of possible b

is the the same as that in [1, Theorem 5.1]. Suppose that b > lnr (A), that m
measure on E¥
f m
f m

satisfying the hypothesisR fb dm = 1 of [1, Theorem 5.1], and that
is the corresponding state of T (X(E¥
)). Then Proposition 7.4 of [1] says that
◦ p P,S is the state f e of [9, Theorem 2.1] associated to the vector e = e (m ) =

Every state f e of (T C∗(E),a ) has the form f m

(cid:0)m (Z(v))(cid:1) in [0,¥ )E0.
◦p P,S for some measure m on E ∗
satisfyingR fb dm = 1 [1, Corollary 7.6]. In the proof of this result, such a measure m
is constructed as a measure on the inverse limit E¥
←−n En, and an examination of
the construction shows that there is considerable leeway in building such a measure.
Indeed, for each e satisfying the normalisation relation yb

· e = 1 of [9],

= lim

nl ∈ M(E

)+ :Z fb dl = 1 and l (Z(l )) = e v for v ∈ E0o

is a simplex of codimension |E0| + 1 in the cone M(E¥
Thus there are many more KMSb states on T (X(E¥

)+ of positive measures.

)) than on T C∗(E).

The injection p P,S : T C∗(E) → T (X(E¥

)) is certainly not surjective — if for no
other reason, because T (X(E¥
)) has many more KMS states. However, Proposi-
tion 7.1 of [1] says that p P,S induces an isomorphism of the Cuntz-Krieger algebra
C∗(E) onto O(X(E¥
))! (This observation is essentially due to Exel [6] and Brown-

¥
¥
Equilibrium states on graph algebras

11

lowe [2].) Since this isomorphism also intertwines the dynamics of [9] and that of
[1], the latter algebra has effectively the same KMS states as C∗(E).

We now return to the dumbbell graph E

v

w

which we discussed in Example 2 of §4. The system (C∗(E),a ) has KMSb states
for b = ln 3 = lnr (A) and b = ln2 = lnr (A{v}). Thus so does O(X(E¥
)). We have
already seen in Lemma 6.2 that b c = lnr (A) in general. For this E and x ∈ E¥
, we
can compute

|s −n(x)| = |Enr(x)| =(2n

3n + (cid:229) n−1

j=0 3 j2n−1− j

if r(x) = v
if r(x) = w.

Thus minx |s −n(x)| = 2n is attained when r(x) = v, and Thomsen’s b l is ln 2. So for
the local homeomorphism s
, the lower bound b l in [17, Theorem 6.8]
is also sharp.

→ E¥

: E¥

It is easy to see with dumbbell graphs that there can be KMSb states at inverse
temperatures strictly between b l and b c. For example, with E the following graph

u

v

w

both C∗(E) and O(X(E¥
ln 4.

)) have KMS states at inverse temperatures ln 2, ln 3 and

There are, however, interesting constraints on the possible inverse temperatures
b . First, since eb has to be the spectral radius of an irreducible integer matrix, it
has to be an algebraic number. But there are also other, more subtle constraints. The
issue is discussed, along with relevant results of Lind [13], in [10, §7.1].

Acknowledgements This research was supported by the Marsden Fund of the Royal Society of
New Zealand. We also thank our collaborators Zahra Afsar, Marcelo Laca and Aidan Sims, the ref-
eree for some constructive suggestions, and the organisers of the Abel symposium for a marvellous
experience.

References

1. Z. Afsar, A. an Huef and I. Raeburn, KMS states on C∗-algebras associated to local homeo-

morphisms, Internat. J. Math. 25 (2014), article no. 1450066 (28 pages).

12

Astrid an Huef and Iain Raeburn

2. N. Brownlowe, I. Raeburn and S.T. Vittadello, Exel’s crossed product for non-unital C∗-

algebras, Math. Proc. Camb. Phil. Soc. 149 (2010), 423–444.

3. T.M. Carlsen and N.S. Larsen, Partial actions and KMS states on relative graph C∗-algebras,

arXiv:1311.0912.

4. J. Ding and A. Zhou, Nonnegative Matrices, Positive Operators, and Applications, World

Scientiﬁc, Singapore, 2009.

5. M. Enomoto, M. Fujii and Y. Watatani, KMS states for gauge action on OA, Math. Japon. 29

(1984), 607–619.

6. R. Exel, A new look at the crossed-product of a C∗-algebra by an endomorphism, Ergodic

Theory Dynam. Systems 23 (2003), 1733–1750.

7. R. Exel and M. Laca, Partial dynamical systems and the KMS condition, Comm. Math. Phys.

232 (2003), 223–277.

8. N.J. Fowler and I. Raeburn, The Toeplitz algebra of a Hilbert bimodule, Indiana Univ. Math.

J. 48 (1999), 155–181.

9. A. an Huef, M. Laca, I. Raeburn and A. Sims, KMS states on the C∗-algebras of ﬁnite graphs,

J. Math. Anal. Appl. 405 (2013), 388–399.

10. A. an Huef, M. Laca, I. Raeburn and A. Sims, KMS states on the C∗-algebras of reducible

graphs, Ergodic Theory Dynam. Systems 35 (2015), 2535–2558.

11. T. Kajiwara and Y. Watatani, KMS states on ﬁnite-graph C∗-algebras, Kyushu J. Math. 67

(2013), 83–104.

12. T. Katsura, A class of C∗-algebras generalizing both graph algebras and homeomorphism

C∗-algebras I. Fundamental results, Trans. Amer. Math. Soc. 356 (2004), 4287–4322.

13. D. Lind, The entropies of topological Markov shifts and a related class of algebraic integers,

Ergodic Theory Dynam. Systems 4 (1984), 283–300.

14. M.V. Pimsner, A class of C∗-algebras generalizing both Cuntz-Krieger algebras and crossed

products by Z, Fields Institute Comm. 12 (1997), 189–212.

15. I. Raeburn, Graph Algebras, CBMS Regional Conference Series in Math., vol. 103, Amer.

Math. Soc., Providence, 2005.

16. E. Senata, Nonnegative Matrices and Markov Chains, Second Edition, Springer-Verlag,

Berlin, 1973.

17. K. Thomsen, On the C∗-algebra of a locally injective surjection, Comm. Math. Phys. 302

(2011), 403–423.

18. K. Thomsen, KMS weights on groupoid and graph C∗-algebras, J. Funct. Anal. 266 (2014),

2959–2988.

