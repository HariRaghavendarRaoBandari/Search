Large scale ﬂow visualization and anemometry applied to lab on chip models of

porous media

Johan Paiola, 1,2, Harold Auradou,1,∗ and Hugues Bodiguel 2, 3

1 Laboratoire FAST, Univ. Paris Sud, CNRS, Universit´e Paris-Saclay, F-91405, Orsay, France.

2 Univ. Bordeaux, CNRS, Solvay, LOF UMR5258, Pessac, France.

3 Univ. Grenoble Alpes, CNRS, Lab. LRP UMR5520, F-38000 Grenoble, France.

The following is a report on an experimental technique allowing to quantify and map the velocity
ﬁeld with a very high resolution and a simple equipment in large 2D devices. A simple Shlieren
technique is proposed to reinforce the contrast in the images and allow you to detect seeded particles
that are pixel-sized or even inferior to it. The velocimetry technique that we have reported on is
based on auto-correlation functions of the pixel intensity, which we have shown are directly related
to the magnitude of the local average velocity. The characteristic time involved in the decorrelation
of the signal is proportional to the tracer size and inversely proportional to the average velocity. We
have reported on a detailed discussion about the optimization of relevant involved parameters, the
spatial resolution and the accuracy of the method. The technique is then applied to a model porous
media made of a random channel network. We show that it is highly eﬃcient to determine the
magnitude of the ﬂow in each of the channels of the network, opening the road to the fundamental
study of the ﬂows of complex ﬂuids. The latter is illustrated with yield stress ﬂuid, in which the
ﬂow becomes highly heterogeneous at small ﬂow rates.

INTRODUCTION

One of the challenges of microﬂuidic technology is the
development of tools to characterize ﬂow properties with
a suitable resolution [1]. For nearly twenty years, the PIV
(Particle Image Velocimetry), the PTV (Particle Track-
ing Velocimetry) or the LIF (Laser Induced Fluorescence)
methods have been successfully adapted to get informa-
tion about the ﬂow at the microscale [2, 3]. Recent de-
velopments have even enabled us to get 3D visualizations
of the ﬂows allowing an enriched description of the pro-
cesses [4, 5]. However, these techniques are developed in
order to have an accurate description of the ﬂow ﬁeld at
the smallest possible scale - the single cell [6] or bacteria
scale [7] for instance - but they only cover a limited range
of scales. Complex microﬂuidic devices typically involve
tens to hundreds of channels, and therefore ask for a ve-
locimetry, or at least, anemometry technique having a
super-high spatial resolution.

In the past decades, micromodels obtained using trans-
parent microﬂuidics technology have been widely used
[8–21] to model ﬂows in porous media. Because, this
technique allows to study at the relevant length scales
and with a precise control of the geometry ﬂow in porous
media and it has permitted signiﬁcant progress on the un-
derstanding and on the description of the ﬂows in those
media. However, characterizing ﬂows in micromodels
represent a technical challenge, as one need to perform
measurements over length scales ranging from the pore
scale up to a scale for which the macroscopic properties
of the porous media are reached. For porous media mod-
elled by a disordered channel network, it is assumed that
a typical number of a hundred parallel channels is a min-

∗ auradou@fast.u-psud.fr

imum value to be statiscally representative. Under this
condition, a single pore only represents from 0.1 to 0.5%
of the full scale. As few pixels per pore are necessary
to characterize the ﬂow, the resolution rapidly reaches
the limit of standard cameras: a few thousands pixels
per dimension. Therefore, ﬂow characterization requires
a very good resolution over a wide ranges of scales, which
is in practice diﬃcult to achieve. This issue is likely to
be the reason why most of the past studies either were
restricted to qualitative observations[13, 21], either were
limited to the measurement of the saturation [12, 15], or
were considering ﬂow at the scale of a few pore[11]. Only
a few studies report quantitative velocity measurements
[10, 17]. Yet, they toke advantage of the good contrast
existing in biphasic ﬂows. Yet, this technique gives solely
access to menisci velocity, and does not give information
about the ﬂow inside the ﬂuids.

The purpose of this work is go beyond these limita-
tions, and to propose an anemometry technique having
an extra-high resolution. Although it has been developed
to tackle the technical issue of mapping the velocity in
a micromodel of porous media, the technique is versatile
and could be directly applied to complex microﬂuidics
networks.

When the acquisition device does not capture the full
image, one solution is to combine a mosaic of images to
reconstruct the complete velocity ﬁeld. Yet, this proce-
dure is only adapted to steady ﬂows and requires the use
of adapted equipments and of a reconstruction software
to combine the images. In this work, by pushing the res-
olution limit two its minimal value: the pixel size, we
were able to avoid reconstruction procedures. To do so,
we use the time variation of the light intensity on each
pixel rather than space correlation of successive images.
The decay of the autocorrelation function of the light in-
tensity is - in the high P´eclet limit - related to the local
velocity. As compared to PTV or to PIV, only the mag-

6
1
0
2

 
r
a

 

M
1
2
 
 
]
n
y
d
-
u
l
f
.
s
c
i
s
y
h
p
[
 
 

1
v
6
5
4
6
0

.

3
0
6
1
:
v
i
X
r
a

nitude of the velocity can be measured.
In a network,
velocity direction is known a priori from channel orien-
tation, so that this disadvantage is not highly relevant in
these applications. The main advantage of time autocor-
relation is that it does not require particle detection as in
PTV, neither uniform and good quality images as in stan-
dard PIV. We show in this work that it could be applied
on images of poor quality, where particle displacement is
hardly seen by eyes.

The second issue is to use tracers that do not perturb
the ﬂow: particle size should thus not exceed a tenth of
the channel width. On the other hand, tracers have to
be in the order of the pixel size. This last requirement
makes particle detection diﬃcult. One solution is to use
ﬂuorescent particles, but their use at the centimeter scale
or above is not straighforward, and is not accessible by
standard ﬂuorescence microscopy equipments. By taking
advantage of the Schlieren eﬀect[22, 23], our technique
avoids the use of ﬂuorescent tracers and only required a
standard bright ﬁeld illumination. The Schlieren eﬀect
is obtained by simply placing a grid between the device
and the light source. The grid enhances the contrast of
the images allowing particle detection even if the particle
size is below the pixel size. Despite the contrast enhance-
ment, the images are of poor quality but suﬃcient for a
time autocorrelation analysis of the light intensities.

In this paper, we present in detail the principles and
the validation of the autocorrelation particle imaging
anemometry. The technique is applied to map the ve-
locity ﬁeld in a complex and wide microﬂuidic network
of channels. We show that the method is simple, fast
and importantly leads to an high-resolved determination
of the mean velocity in all the channels simultaneously.
These results and validation are obtained for Newtonian
ﬂuids. In order to illustrate the potential use of the tech-
nique, we present some results obtained with a the yield
stress ﬂuid.

DESCRIPTION OF METHODS AND

MATERIALS

System overview

Two microﬂuidic devices were developed using classical

soft lithography technique.

The ﬁrst one is a channel of constant depth (h =
340µm) but of gradually increasing width. The widths
are respectivelty W = 150, 200, 300, 400 and 500µm and
the total length of the channel is 10 mm. This device is
used to calibrate and validate the autocorrelation tech-
nique at the pore scale.

The second one, displayed in Fig. 1, is a square lattice
of 110 by 110 channels of rectangular cross sections. The
height of the channels is uniform equal to 200 µm, while
their widths are set randomly according to a log-normal
distribution of mean value 200 µm and standard devi-
ation 50 µm (see ﬁg. 1b). The lattice is orientated at

2

45◦, and N = 110 channels are connected to the inlet. A
tree-like geometry made of channels of width 2000 µm is
used at the inlet and at the outlet to impose a parallel
ﬂow (see Fig. 1a).

The inlet of the device is connected to a syringe pump
and the outlet to a waste reservoir. We used either pure
glycerol or yield stress ﬂuid obtained by mixing 0.7 g of
carbopol EDT2050 in water (See reference 24 for a com-
plete description of the preparation procedure). The ﬂow
curve of the carbopol solution has been determined using
standard rheometry and is well described by a Hershel-
Buckley law: σ = 15+5.1 ˙γ0.5. The ﬂuids are seeded with
transparent beads of PMMA. Two diameters are used: 6
and 20µm. The concentration is 0.5% for the bead 6µm
and 0.3% for the bead 20µm.

A JAI BM 500 GE video camera is positioned above
the setup.
Its CMOS sensor consists of 2456 by 2058
pixels and its maximum rate of capture is 7 frames per
second in full resolution. The spatial resolution of the
camera has been varied to test the limitation of the tech-
nique, but for the anemometry mapping of the channel
network, it is about 25 µm per pixels. This resolution
doesnot permit to visualize and track single particles,
but, as detailed in the next section, contrast enhance-
ment by a Schlieren technique allow to detect intensity
ﬂuctuations due to tracers displacement.

Contrast enhancement

To enhance the contrast we adapted the synthetic
Schlieren technique [22] developed in the 90’s to measure
density ﬂuctuations in two-dimensional stratiﬁed ﬂows.
In that case, density ﬂuctuations are revealed through
small optical refraction index variations enhanced by
placing a grid between the light source and the obser-
vation ﬁeld. Our technique uses the refraction index
contrast between particles suspended in the ﬂuid and
the ﬂuid. Schlieren techniques also require an optimized
light. Here, this is achieved by placing a grid between
a light panel and the device. The grid produces a uni-
form ﬁeld of dotted sources of light and the light passing
through the beads is refracted, thus reducing the light
intensity at that position. The grid is a sieve of mesh
sized 20 or 40 µm. By doing so, we immediately observe
light intensity ﬂuctuations due to particle displacement,
as illustrated in Fig. 2a. These ﬂuctuations are hardly
distinguishable from noise in the absence of the grid (dot-
ted line in Fig. 2a) but are enhanced when a grid is placed
between the light and the device (solid line in Fig. 2a).
Before demonstrating the correlation between the light
intensity variations and the displacement of the beads, it
worth analyzing in more details the contrast enhance-
ment due to the grid. For that purpose, we approached
the camera to get magniﬁed views of the particles. Fig. 3
displays examples of pictures obtained with and without
the grid. The contrast diﬀerence is striking, as the beads
become highly visible when the grid is present. This con-

3

FIG. 1. (a) mask used for the lithography. The microﬂuidic chip consists of a 2D network made of 110 by 110 channels. The
average channel width (W ), length (l) and depth (h) are respectively: W = 200, l = 700 and h = 600µm. (b) Close-up view of
the network. (c) Size distribution of the width W of the channels. (d) Photograph of the assembled microﬂuidic device ﬁlled
with a dyed ﬂuid. (e) Schematic view of the experimental set-up: 1- camera with a 12.5mm lens, 2- microﬂuidic chip, 3- grid
with a square mesh, 4- light panel, 5- connections.

trast enhancement requires that the grid is placed close
to the observation plane, and that the mesh wavelength is
in the order of the that of the beads. The physical origin
of this eﬀect is related to light refraction by the beads.
Without the grid, the diﬀuse nature of light prevents a
good contrast. The grid creates an array of point light
sources and deviations of light beams directly modiﬁes
the light intensity in the ﬁeld of view.

In the presence of a ﬂow, particle displacement leads to
intensity modulation on a given pixel. Examples are dis-
played in Figure 3d. We note that the intensity changes
depend on the location. When it is calculated on a bright
pixel taken inside a hole of the grid, the intensity is lower
when a particle is present. However, when the pixel is
chosen in a darker area, the modulation is more com-
plex. In the example shown in Fig. 3d, the intensity is
ﬁrst lower and then higher than the baseline. This comes
from complex light refraction by the beads in the vicinity
of the meshes.

When the camera is moved backwards, the detail of
the diﬀraction pattern due to the grid is no more visible
but the light intensity contrast between the bead and the
ﬂuid is still suﬃcient to be seen with this lower spatial
resolution. The complex intensity modulations which de-
pends on the pixel location using a magniﬁed view are no
more visible in the sense that when the pixel size is about
that of grid wavelength, all the pixel are equivalents. The
ﬁnal signal - as the one displayed in Fig.2a - is composed
of a succession of individual signals corresponding to the
passage of beads on and between meshes.

FIG. 2.
a) Variation of the light intensity I(x, y, t) with
time. Solid and dotted lines are measurements done with
V = 4.8µm.s−1 respectively with and without the grid. b)
Auto-correlation function C(∆t) in relation with the time lag
∆t for V = 23.8 (solid line), 4.8 (dashed line), 1.6 (dotted
line) and 0.48µm.s−1 (dash-dotted). For these experiments,
the beads diameter is 20µm and we used a grid of 40µm mesh
size. Spatial resolution is 22µm/pixel. In insert the charac-
teristic time τ0 is plotted as a function of the mean velocity
(see text).

Time (s)0102030405060I120140160180τ (s)0246810C(τ)00.51V (µm/s)  1101/τ0 (s-1)0.111a)b)4

of the centered intensity of single pixel. It is deﬁned by

(cid:80)
t [I(x, y, t) − (cid:104)I(x, y)(cid:105)t] [I(x, y, t + ∆t) − (cid:104)I(x, y)(cid:105)t]

(cid:80)
t [I(x, y, t) − (cid:104)I(x, y)(cid:105)t]2

C(x, y, ∆t) =

,

(1)
where ∆t is the time lag and I the pixel intensity. By
construction, these functions decay and eventually vanish
at long times. The correlation functions are calculated
thanks to Fourrier transforms of the intensity, since the
computation time is signiﬁcantly decreases. Examples
are displayed in Fig. 2b for diﬀerent ﬂow rates. Clearly,
the autocorrelation function decreases faster for high ﬂow
rates.

The anemometry technique that is proposed in this ar-
ticle is based on this observation, and consists in measur-
ing the characteristic time of the autocorrelation function
decay. The latter is estimated as the time τ0 at which
C(τ ) = 0.5, and we use linear interpolation of the auto-
correlation function to get a better time resolution. The
inset in Fig. 2 shows the value of 1/τ0 obtained from the
measurements of the correlation functions for diﬀerent
mean velocity V in the channel, deﬁned by V = Q/S,
where Q is the ﬂow rate and S the channel cross-section.
A linear relation between the two quantities is observed
suggesting it is possible to obtain a local measurement of
the ﬂuid velocity from the measurement of the autocor-
relation function of the light intensity.

RESULTS

Flow in a single channel

We ﬁrst applied the technique to experiments per-
formed in straight channels. Fig. 4 shows one of the
maps of the inverse of τ0 that we obtained. At the center
of the channel τ0 is small indicating the beads travel
faster in the central region of the ﬂow. On the sides, the
time is large (and 1/τ0 is small); in these regions the
beads travel more slowly. From these maps, we estimate
the velocity proﬁles by averaging 1/τ0 along the ﬂow
direction. The proﬁles are shown on Fig. 4b. They are
very well adjusted over the full width of the channels
by a parabolic proﬁle as expected for Poiseuille ﬂows
in slits. It should be noted that the slit approximation
is not strictly valid since the channel cross-section
is rectangular, with an aspect ratio ranging between
W/h = 0.44 and 1.5[? ]. If we assume that the measured
velocity is averaged over the entire thickness of the
channel, the diﬀerence between the parabolic proﬁle in a
slit and the averaged proﬁle in a rectangular channel is
rather small. The two are are displayed in Fig. 4b, and
the diﬀerence remains smaller than the measurement
uncertainty. Near the surfaces, ﬂuctuations of the in-
verse of the time are larger, emphasizing the diﬃculty to
achieve good measurements close to a surface. The fact
that we used beads that are smaller than the pixel size
allow to achieve spatial resolution of 1 pixel: as shown

FIG. 3. (a) close-up view of a single channel. The width of
the channel is 250µm. The channel is ﬁlled with glycerol con-
taining PMMA beads of diameter 20µm. (b,c) Same view but
with a grid added between the light pad and the microﬂuidic
device. The mesh of the grid is 40µm. The grey circles are
beads.(d) Light intensity measured on two particular pixels
in relation with time. The dotted red and solid blue lines
are the signals recorded for respectively the beads shown by
the red (b) and blue (c) arrows. The spatial resolution is
1.15µm/pixel and the mean ﬂow velocity V = 16µm.s−1.

Image treatment

To demonstrate that the ﬂuctuations observed with a
grid are due to the passage of the beads on that pixel, we
compute the normalized time auto-correlation function

100µma)b)c)d)Time (s)050100150200250Intensity6080100120140160in Fig. 4b, a remarkable velocity proﬁle is measured in a
channel which is only 10 pixels wide.

5

channel is needed to achieve a precise measurement. It
might also be extended for velocimetry application, but
one would need to achieve a better optical vertical reso-
lution using for instance confocal microscopy.

FIG. 4. Top: Color map of 1/τ0(x, y) measured on each
pixel of a channel of width 500µm and length 10mm. V =
1.3µm.s−1. Bottom: proﬁles of (cid:104)1/τ0(x, y)(cid:105)x where x is the
coordinate along the ﬂow direction and y the coordinate nor-
mal to the ﬂow. The left and right ﬁgures show the result for
channels of width 150 and 500µm respectively. The spatial
resolution is here 15µ m/pixel. The diameter of the beads
is 6µm and the grid mesh size is 20µm. The solid lines are
the best parabolic ﬁt to the data, and the dashed lines corre-
sponds to the expected velocity proﬁle calculated for channels
of rectangular cross-section, averaged over the depth of the
channel.

The experiment was repeated for diﬀerent ﬂow rates
and the average value of 1/τ0 was calculated on all the
sub-parts of constant width of the channel. Fig. 5 shows
the average value of 1/τ0 in relation to the correspond-
ing average ﬂow velocity. The data fall on a single line
passing through the origin. The slope 1/a is used to de-
termine the relation between the time τ0 measured and
the current velocity. We ﬁnd a value of a which is about
10 µm. This length is in the order of both the bead size
and the pixel size, this will be discussed later. This re-
sult proves the ability of the auto-correlation technique to
be used to measure local ﬂow velocity, after calibration.
This study also allows us to estimate the experimental
uncertainty in the measurements of the magnitude of the
velocity (approx. 5%).

We ﬁnd that the calibration factor 1/a does not de-
pend on the aspect ratio of the channel, as evidenced in
Fig. 5. Note that we have signiﬁcantly varied the chan-
nel aspect ratio W/h from 0.4 to 3.3. This indicates that
the local velocity measured in one pixel is averaged along
the channel depth. If the measurement was sensitive to
tracer located in the center (for example), the calibration
factor would have been diﬀerent. Therefore, we conclude
that the auto-correlation technique could serve as a lo-
cal anemometry technique, which is of great interest in
complex microﬂuidic networks since only a few pixels per

FIG. 5. Each symbol represents the average value of 1/τ0
estimated from each experiment (diﬀerent ﬂow velocity V and
channel widths w) in relation to the average ﬂow velocity V .
The solid line is the linear regression of the measurements. Its
slope is 1/a with a = 10.18 ± 0.25µm. The spatial resolution
here is 15µm/pixel. The diameter of the beads is 6µm and the
grid mesh size is 20µm. The diamonds are the measurements
performed in the injection channels of the network displayed
on Fig.6. The conditions are the same (bead diameter 6µm /
mesh size 20µm) except for the spatial resolution 25µm/pixel
instead of 15.

Flow in a complex channel network

We next applied the method to the network of channels
of random width depicted in Fig. 1. In this case, the spa-
tial resolution is 25µm per pixel and the goal is to mea-
sure the velocity over the full size of the chip. The spatial
resolution is four times the beads diameter, which means
they are not visible, preventing any tracking. Moreover,
each channel contains in average only ten pixels, making
it diﬃcult to determine a ﬂow proﬁle precise enough for
a good estimation of the average ﬂow velocity using the
classical techniques.

Despite these obstacles, we were able to obtain a map
of the magnitude of the velocities with a good resolution
(see Fig.6, using the calibration displayed in Fig. 5. To
quantitatively test our estimation of the ﬂow velocities,
we performed experiments at diﬀerent ﬂow rates, and
computed the mean value of the velocity in the entire
network. The results are shown in Fig. 7a. As for the
single channel, the average ﬂow velocity obtained by our
technique varies linearly with the average imposed ﬂow
velocity V = Q/N S, where N is the number of chan-
nels and S the average cross-section. We note that the
mean measured velocity is about 15% higher than V .

00.511.5h1/τ0i(s−1)05y(pxl)-15-10-5051015h1/τ0i(s−1)05y(pxl)-15-10-5051015V (µm.s-1)010203040<1/τ0> (s-1)012345W = 150 µmW = 200 µmW = 300 µmW = 400 µmW = 500 µmW = 2000 µm10010110-1100This over-estimation is not measured when the analy-
sis is performed on the straight channels connecting the
pump to the network (See Fig.7a) and we obtained a
satisfying agreement between these measurements and
the calibration curve obtained from the measurement in
straight channels (See diamonds in Fig.5). Several argu-
ments might be proposed to explain the over-estimation
of the ﬂuid velocity. First, the velocity V = Q/N S does
not account for the contribution of the nodes of the net-
work, while they represent about 20% of the total vol-
ume. Since one node connects two channels, the velocity
in the nodes is higher and the mean velocity measured is
then higher than V . Second, we cannot exclude that the
poor resolution prevent correct measurements of the low
ﬂow velocity near the walls, which would also lead to an
overestimation of the ﬂow velocity.

FIG. 6. a) Color scale map of the ﬂow velocity measured
on each pixel. Pure glycerol containing beads of diameter
6µm is injected at an average ﬂow velocity V = 6.3µm.s−1
in the micromodel. For this experiment, we used a grid of
20µm.s−1. The spatial resolution is 25 µm/pixel. b) Close
up of the injection section and of a part of the network.

To make the potential of our method even clearer, we
made a close up of the inlet sections and of a small part

6

FIG. 7. Left: Mean velocity in the porous medium (circles)
determined for various ﬂow rates Q = N SV . The calibra-
tion factor a comes from the single channel experiment. The
data are averaged over all the pore space of the micromodel.
The solid line, of slope 1.15, corresponds to the best linear
ﬁt to the data. The slope of the dotted line is 1. Diamonds
correspond the averaged velocity in the injection channels.
Right: Probability density functions of the normalized veloc-
ity in the porous medium. The thin solid line corresponds
to the pore network simulations.
It is well adjusted by a
gaussian function of mean value 1 and of standard deviation
0.34. The other lines (dotted, dashed, solid and dash-dotted)
are obtained from experiments carried at various ﬂow rates
(1.1 × 10−10 m3/s, 1.4 × 10−10 m3/s, 2.2 × 10−10 m3/s and
2.8 × 10−10 m3/s, respectively).

of the network, shown in Fig. 6b. The inlet consists of
straight channels dividing into two equal channels in
order to distribute the ﬂuid equally over the full length
of the chip. This part is thus made of branches with
right angle corners: the method clearly highlights the
low ﬂow region appearing in this area. Likewise, in the
area where the ﬂow divides into two, the ”jets” in the
vertical walls can easily be distinguished. On the scale of
a few pores, we see that the method makes the velocity
contrast between the pores visible.

We also compared the velocity probability density
functions (PDF). Due to the Newtonian nature of glyc-
erol, once normalized by the average ﬂow velocity V =
Q/N S, the distribution should remain unaﬀected by any
change in the average ﬂow velocity. The results are shown
in Fig.7b. The collapse of the PDF obtained at various
ﬂow rates is excellent, which demonstrates the good qual-
ity of our measurement. The PDF are well described by
gaussian functions of standard deviations around 0.35.
The experimental results are compared to numerical sim-
ulation of the ﬂow using a pore-network model approach.
This method consists in assuming a developped laminar
Poiseuille ﬂow proﬁle in each of the channels, and to solve
the linear system of equations obtained by writing mass
conservation in each node of the network (see appendix
for details). This allows to calculate the PDF of the ve-
locity for the network used experimentally. The PDF
is displayed in Fig. 7b, together with the experimental

5 mm×10-50123451 mm1 mma)b)V(µm/s)01020ah1/τi(µm/s)0510152025v/V012p(v/V)00.20.40.60.811.2data. As already discussed, the experimental mean value
is slightly higher than the theoretical one, but one could
see that the agreement on the standard deviation of the
PDF is excellent.

We conclude that the auto-correlation technique com-
bined with contrast reinforcement is well adapted to char-
acterize ﬂows in complex geometries.

Flow of a non-Newtonian liquid in a complex

channel network

In order to illustrate the potential

interest of our
method, we used it to determine the ﬂow structure of
a complex ﬂuid in the micromodel. Contrary to Netwo-
nian ﬂuids ﬂows which could be easily predicted or mod-
eled, characterizing the ﬂow of non-Newtonian ﬂuids in
complex geometries is far more challenging because of
the strong coupling between the geometry and the ﬂuid
properties. We choose to use a yield stress ﬂuid, a car-
bopol gel. The main characteristic of this ﬂuid is the
existence of a yield stress σy (approx. 15 P a). Conse-
quently the ﬂow in a single channel only occurs when the
pressure gradient at the pore scale ∆p/l overcomes the
strain on its surface 2σy/W . In a network of heteroge-
neous channels, one thus expects that for low ﬂow rates,
the ﬂow will is localized along a few paths, the other
channels being below the yield stress. The existence and
characteristics of preferential paths have been predicted
numerically[26, 27] but yet not tested experimentally.
One of the practical consequence of these preferential
paths is to aﬀect the global pressure drop/ﬂow rate rela-
tion. The current scientiﬁc challenge is to determine the
equivalent Darcy law for yield stress ﬂuids. While most
of present studies focus on the macroscopic average ﬂow
velocity [28], we see on Fig.8 that our method makes it
possible to study the details of the local ﬂow structure.
The two velocity maps displayed on Fig. 8 are obtained
with pressure ∆P close to the theoretical macroscopic
yield stress pressure. As compared to the ﬂow of a New-
tonian ﬂuid displayed in Fig. 6, the ﬂow of the carbopol
solution is much more heterogeneous. They both reveal
the localization of the ﬂow structure and the existence
of preferential at low ﬂow rate. The ﬂow heterogeneity
due to the coupling between the network geometry and
the non-linear ﬂow properties of the carbopol solution is
better evidenced by looking at the PDF of the velocity
displayed in Fig. 8. They contrast with the ones obtained
with the Newtonian ﬂuid. The Gaussian distribution pre-
viously observed becomes an exponentially declining dis-
tribution, and the standard deviation increases when the
ﬂow rate is decreased. These distributions demonstrate
that in some channels the ﬂow is close to zero and is much
larger than the average velocity in others. The quantita-
tive analysis of such distributions is undoubtedly a rel-
evant tool to study the evolution of the localization of
the ﬂow, but a quantitative and detailed study of this
phenomenon is beyond the scope of the present article.

7

FIG. 8. Top and middle: Velocity maps obtained with a
aqueous carbopol solution. The two maps correspond to two
diﬀerent degrees of pressure applied ∆P = 7000 Pa (averaged
velocity: V = 3.2µm.s−1) and 5000 P a (V = 1.4µm.s−1).
Bottom: distributions of the normalized velocity v/V in the
two experiments shown above (solid and dashed line) and of
a Newtonian ﬂuid (dotted line).

v/V01234p(v/V)00.20.40.60.811.2DISCUSSION

In the previous sections, we have shown the validity
and the potentiality of the auto-correlation method com-
bined with Schlieren contrast enchancement to map the
velocity ﬁeld in a complex microﬂuiﬁc device. Let us now
discuss and details a few technical aspects which could
beneﬁt to future users.

Let us ﬁrst emphasize that the Schlieren contrast
enhancement is a powerful costless alternative to ﬂu-
orescence optical methods. Although ﬂuorescence mi-
croscopy is now a standard technique, it has some tech-
nical drawbacks and contraints. For instance, it requires
suitable illumination devices and ﬁlters. The Schlieren
contrast enhancement only requires a grid and a standard
camera, and can achieve particle detection even when the
tracer size is smaller than that of the pixel. Of course,
the presence of the grid alters the quality of the raw im-
age, and induces some optical aberration as discussed in
the experimental section. On the opposite, if the grid
size becomes too small or if the spatial resolution is low
in comparison with the mesh size, all the light deﬂected
by the presence of the bead will be collected by the same
pixel, thus cancelling the contrast enhancement eﬀect.
We therefore recommend to use a grid which wavelength
is in the order of the pixel size. By doing so, the images
are more uniform and do not suﬀer from the above men-
tioned aberration. Standard sieves are good solutions to
obtain grids of various wavelength.

The auto-correlation method is very robust, as it could
be used on poor quality images, contrary to PIV or PTV
methods. The second advantage is related to the spatial
resolution which is 1 pixel. Although the other methods
could achieve this high resolution, they required averag-
ing over a long period of time.
In this paper, we use
3000 successive images to reach a precision of about 5%.
The precision is reduced when using less images, but we
obtain satisfactory results with only 500 images. As for
other velocimetry methods, the frame-rate needs to be
adjusted to the magnitude of the velocity. Indeed, the
characteristic time measured is inversely proportional to
the velocity.
In order for the auto-correlation function
decay to be measured correctly, we recommend to adapt
the frame rate at about a few times 1/τ0. Higher values
would lead to a better precision, but would required a
larger number of images. Although we restrict this study
to low velocities (around 10 µm/s), the method could be
applied without additional diﬃculties to larger velocities
Tracer size should also be adapted to the experiments.
Although large tracers lead to better optical constrast,
they also reduce the spatial resolution and induce ﬁnite
size bias when their size approaches a fraction of that of
the channels. In this work, we used tracer sizes that are
much smaller (6 µm or 20 µm beads) than the channel
width, and smaller or around the pixel size. The tracer
concentration should also be adjusted since low concen-
trations requires long acquisition time, and high concen-
trations inﬂuences the decorrelation time due to multiple

8

particles. We thus recommend to adjust the concentra-
tions so that the mean distance between tracers is ap-
prox. the channel height. Finally, the refractive index of
the particles has a strong inﬂuence on the contrast and on
the amplitude of the intensity ﬂuctuations. Using water
with a small amount of carbopol (n1 = 1.33[29]) instead
of glycerol (n1 = 1.47[30]), we increased the diﬀerence
between the refraction index of the tracer (n2 = 1.49
for PMMA [31]) and of the ﬂuid. We then observed an
increase in the light intensity contrast that made it con-
siderably easier to analyze the signals of the experiment
displayed on Fig.6 as opposed to the data displayed on
Fig.4.

The main drawback of the autocorrelation technique is
that it requires a calibration procedure. The calibration
factor a is a length scale which depends on the experimen-
tal parameters. Since the measured characteristic time
corresponds to the passage of a tracer in front a pixel. it
should be - in principle - for tracers larger than the pixel
size close to the tracer diameter or to the pixel size other-
wise. For the data presented in this paper, we used 6µm
beads and pixel size of about 20µm. The characteristic
size a found from velocity calibration is 10 µm which is
around both the bead and pixel sizes, which is thus coher-
ent with the previous argument. We have tested several
other experimental conditions. When the pixel size is
much smaller than the beads, the value of a is clearly
close to the bead diameter: we obtain a = 25.3µm, with
20 µm beads and a pixel size of 0.17 µm.
Increasing
the pixel size leads to a more complex picture. With
6 µm beads, we have increased the pixel size, starting
from 20µm. We ﬁnd that a increases from 10 to 18 µm
when the pixel size is 40µm, but then saturates when
the pixel size is increased further. Possibly the reason
for saturation is related to the fact that for large pixel
sizes, multiple beads could be observed at the same time
on the same pixel. As the precise value of a depends
on experimental conditions in addition to the details of
characteristic time deﬁnition (here, τ0 has been deﬁned
as C(τ0) = 0.5), we think the calibration step could not
be avoided to achieve quantitative measurements. How-
ever, the value of the bead size could serve as an a priori
estimation for the characteristic time.

CONCLUSION

In this work, we have shown that large scale anemome-
try with high resolution could be achieved eﬃciently and
using time auto-correlation of the light intensity. The
method is robust since it does not require high quality
imaging of the tracer particles.
In this work, we have
used a Schlieren technique to reinforce the contrast of
the image and to achieve velocity mapping in bright ﬁeld
with beads smaller than the pixel size. The combination
of the two methods is thus of great interest to map ve-
locity ﬁelds in large complex microﬂuidic network. We
have applied it to ﬂows in micromodels of porous media,

where high resolution velocimetry is required to achieve
quantitative description of the phenomena. In addition
to the experimental validation of the method using New-
tonian ﬂuids, we report preliminary results obtained with
yield stress ﬂuids which unambiguously shows that the
ﬂow concentrates at low ﬂow rates in preferential paths.
The technique reported here thus opens the road to-
wards quantitative studies of complex ﬂuid ﬂows in model
porous media.

Beyond the applications just mentioned, we are also
convinced that this technique may be useful to study
the ﬂow structure of active ﬂuids [32–34]. For instance,
bacteria are characterized by refractive index (n2 ≈ 1.39
[35, 36]) slightly diﬀerent from the suspending ﬂuid (often
a water solution with n1 = 1.33, and have a typical size
of a few microns. Our technique may then be useful to
study the spatial organization of the velocity ﬁeld of these
ﬂuids without the need to add tracer particles.

9

APPENDIX

The pore network modelling used to compute the theo-
retical PDF of the velocity inside the heterogeneous chan-
nel network consists in assuming developpped ﬂow pro-
ﬁles in all the rectangular channels. We use a similar
network as for the experiments, i.e. rectangular channels
of uniform h but of heterogeneous width wij. These are
set randomly according to a log-normal distribution hav-
ing the same standard deviation as for the experiments.
The channels are connected through nodes of the net-
work where mass conservation written for node labelled
i simply reads

Qij = 0,

(2)

where Qij is the ﬂow rate in the channel connecting node
i and j, and where the summation is made on the neigh-
boring nodes. The ﬂow rate Qij is given for a Newtonian
ﬂuid by[37]

(cid:88)

j

∞(cid:88)

Qij =

Pi − Pj

ηl

8h4
π3

wij

hπn4 − 2

π2n5 tanh

n=1,3,5,...

(cid:16) nπwij

(cid:17)

,

2h

ACKNOWLEDGEMENTS

The authors would like to thank J.-P. Hulin, D. Salin,
L. Talon and T. Chevalier for useful discussions and the
Agence Nationale de la Recherche for ﬁnancial support
of the project LaboCothep No. ANR-12-MONU-0011.

(3)
where η is the ﬂuid viscosity, l the length of the channel
and Pi the pressure at node i. This forms a complete set
of linear equations of unknown Pi that we solve numeri-
cally using matlab.

Knowing the pressure ﬁeld, we then compute the mean
velocities in all the channels to obtain the PDF displayed
in Fig. 7.

[1] H. Stone, A. Stroock and A. Ajdari, Ann. Rev. Fluid

[13] K. Ma, R. Liontas, C. A. Conn, G. J. Hirasaki and

Mech., 2004, 36, 381–411

S. Biswal, Soft Matter, 2012, 8, 10669

[2] J. Santiago, S. Wereley, C. Meinhart, D. Beebe and

[14] H. Lee, S. G. Lee and P. S. Doyle, Lab Chip, 2015, 15,

R. Adrian, Exp. Fluids, 1998, 25, 316–319

3047–3055

[3] D. Sinton, Microﬂuidics Nanoﬂuidics, 2004, 1, 2–21
[4] C. Cierpka and C. J. K¨ahler, J. Visual., 2012, 15, 1–31
[5] K. Hyoungsoo, J. Westerweel and G. E. Elsinga, Meas.

[15] M. Romano, M. Chabert, A. Cuenca and H. Bodiguel,

Phys. Rev. E, 2011, 84, 065302

[16] W. Song and A. R. Kovscek, Lab Chip, 2015, 15, 3314–

Sci. Technol., 2013, 24, 024007

3325

[6] Y. Zheng, J. Nguyen, Y. Weia and Y. Sun, Lab Chip,

[17] J. Beaumont, H. Bodiguel and A. Colin, Soft Matter,

2013, 13, 2464–2483

2013, 9, 10174–10185

[7] K. Drescher, J. Dunkel, L. H. Cisneros, S. Ganguly and
R. E. Goldstein, Proc. Natl. Acad. Sci. U.S.A., 2011,
108, 10945

[18] N. K. Karadimitriou, P. Nuske, P. J. Kleingeld, S. M.
Hassanizadeh and R. Helmig, Lab Chip, 2014, 14, 2515–
2524

[8] D. Crandall, G. Ahmadi, D. Leonard, M. Ferer and D. H.

[19] M. Wu, F. Xiao, R. M. Johnson-Paben, S. T. Retterer,

Smith, Rev. Sci. Instrum., 2008, 79, 044501

[9] C. Perrin, P. Tardy, K. Sorbie and J. Crawshaw, J. Col-

loid Interface Sci., 2006, 295, 542–550

[10] C. Cottin, H. Bodiguel and A. Colin, Phys. Rev. E, 2010,

82, 046315

[11] A. Clarke, A. M. Howe, J. Mitchell, J. Staniland,
L. Hawkes and K. Leeper, Soft Matter, 2015, 11, 3536–
3541

X. Yin and K. B. Neeves, Lab Chip, 2012, 12, 253–261

[20] N. S. K. Gunda, B. Bera, N. K. Karadimitriou, S. K.
Mitra and S. M. Hassanizadeh, Lab Chip, 2011, 11, 3785–
3792

[21] J. Gauteplass, K. Chaudhary, A. R. Kovscek and M. A.
Fernø, Coll. Surf. A: Physicochem. Eng. Aspects, 2015,
468, 184

[22] B. R. Sutherland, S. B. Dalziel, G. O. Hughes and P. F.

[12] C. A. Conn, K. Ma, G. J. Hirasaki and S. L. Biswal, Lab

Linden, J. Fluid Mech., 1999, 390, 93–126

Chip, 2014, 14, 3968

[23] S. B. Dalziel, O. H. Graham and B. R. Sutherland, Exp.

10

Fluids, 2000, 28, 322–35

[32] J. Gachelin, A. Rousselet, A. Lindner and E. Cl/’ement,

[24] C. B. B. Geraud, L. Bocquet, Eur. Phys. J. E, 2013, 36,

New J. Phys., 2014, 16, 02

30

[33] H. M. Lopez, J. Gachelin, C. Douarche, H. Auradou and

[25] F. M. White, Fluid Mechanics, McGraw-Hill, New York,

E. Cl´ement, Phys. Rev. Lett., 2015, 115, 028301

2003

[26] L. Talon and D. Bauer, Eur. Phys. J. E, 2013, 36, 139
[27] T. Chevalier and L. Talon, Phys. Rev. E, 2015, 91,

023011

[28] T. Chevalier, C. Chevalier, X. Clain, J. Dupla, J. Canou,
S. Rodts and P. Coussot, J. Non-Newtonian Fluid Mech.,
2013, 195, 57–66

[29] A. Harvey, J. S. Gallagher and J. M. H. L. Sengers, J.

Phys. Chem. Ref. Data, 1998, 27, 761

[30] L. F. Hoyt, Ind. Eng. Chem., 1934, 26, 329–332
[31] P. Michela, J. Dugasa, J. M. Carioua and L. Martina, J.

Macromol. Sci. Part B: Physics, 1985, 379–394

[34] A. Creppy, O. Praud, X. Druart, P. Kohnke and

F. Plourabou´e, Phys. Rev. E, 2015, 92, 032722

[35] A. E. Balaev, K. N. Dvoretski and V. A. Doubrovski,
Proc. SPIE 5068, Saratov Fall Meeting 2002: Optical
Technologies in Biophysics and Medicine IV, 375 (Oc-
tober 14, 2003); doi:10.1117/12.518853

[36] P. Y. Liu, L. K. Chin, W. Ser, T. C. Ayi, P. H. Yap,
T. Bourouina and Y. Leprince-Wang, Proc. Eng., 2014,
87, 356–359

[37] N. Mortensen, F. Okkels and H. Bruus, Phys. Rev. E,

2005, 71, 057301

