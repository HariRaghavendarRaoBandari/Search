6
1
0
2

 
r
a

M
4

 

 
 
]
s
a
g
-
t
n
a
u
q
.
t
a
m
-
d
n
o
c
[
 
 

1
v
1
0
4
1
0

.

3
0
6
1
:
v
i
X
r
a

Bosonic self-energy functional theory

Dario H¨ugel,1 Philipp Werner,2 Lode Pollet,1 and Hugo U. R. Strand2, ∗

1Department of Physics, Arnold Sommerfeld Center for Theoretical Physics and Center for NanoScience,

Ludwig-Maximilians-Universit¨at M¨unchen, Theresienstrasse 37, 80333 Munich, Germany

2Department of Physics, University of Fribourg, 1700 Fribourg, Switzerland

(Dated: March 7, 2016)

We derive the self-energy functional theory for bosonic lattice systems with broken U (1) symme-
try by parametrizing the bosonic Baym-Kadanoﬀ eﬀective action in terms of one- and two-point
self-energies. The formalism goes beyond other approximate methods such as the pseudoparticle
variational cluster approximation, the cluster composite boson mapping, and the Bogoliubov+U the-
ory. It simpliﬁes to bosonic dynamical-mean ﬁeld theory when constraining to local ﬁelds, whereas
when neglecting kinetic contributions of non-condensed bosons it reduces to the static mean-ﬁeld
approximation. To benchmark the theory we study the Bose-Hubbard model on the two- and three-
dimensional cubic lattice, comparing with exact results from path integral quantum Monte Carlo.
A reference system comprising a single bosonic state, corresponding to three variational parame-
ters, is suﬃcient to quantitatively describe phase-boundaries and thermodynamical observables. On
the basis of these ﬁndings we propose self-energy functional theory as the omnibus framework for
treating bosonic lattice models, in particular, in cases where path integral quantum Monte Carlo
methods suﬀer from severe sign problems (e.g., in the presence of non-trivial gauge ﬁelds). Self-
energy functional theory enables the construction of diagrammatically sound approximations that
are quantitatively precise and controlled in the number of optimization parameters, but nevertheless
remain computable by modest means.

PACS numbers: 71.10.Fd, 05.30.Jp, 05.30.-d, 05.50.+q

I.

INTRODUCTION

During the last century interest in strongly correlated
bosonic systems was driven by experimental work on su-
perﬂuid Helium [1], giving rise to a number of theoreti-
cal advances in the ﬁeld of interacting symmetry broken
bosonic systems [2]. Recent experimental advances in
cold atom systems [3, 4] have revived this ﬁeld, espe-
cially for strongly correlated bosonic systems described
by the Bose-Hubbard model [5, 6]. Theoretically, simple
lattice boson models with real Hamiltonians are solvable
using numerically exact path integral quantum Monte
Carlo (QMC) methods [7]. However, one of the fore-
fronts of cold atom research is the exploration of artiﬁcial
gauge ﬁelds [8–10], synthetic spin-orbit interactions [11–
13], and non-local interactions [14, 15]. Handling com-
plex valued terms such as gauge ﬁelds is a challenge for
QMC due to the resulting sign-problem [7, 16], motivat-
ing the need for development of new theoretical methods
for strongly correlated bosons.

One interesting approach is the self-energy functional
theory (SFT) [17–20], originally developed for fermionic
systems. While the formalism contains the dynamical
mean-ﬁeld theory (DMFT) [21, 22] in the limit of local
ﬁelds (with retardation eﬀects) [17] it has also been ex-
tended to non-local correlations [23] and disorder [24].
The bosonic generalization of SFT, incorporating super-
ﬂuidity, was recently pursued [25]. However, in Ref. 25
no attempt was made to connect SFT to previous works
on diagrammatic theory and the bosonic eﬀective-action
formalism [26, 27]. To remedy this, we will put bosonic
SFT on ﬁrm diagrammatic, functional, and variational

grounds, paying special attention to the intricacies of
bosonic U (1) symmetry breaking. The result will be a
functional which diﬀers in a subtle, but signiﬁcant way
from the one proposed in Ref. 25.

We derive a self-energy eﬀective action ΓSE for
symmetry-broken interacting lattice bosons starting from
De Dominicis and Martin’s generalization [26, 27] of the
Baym-Kadanoﬀ eﬀective action ΓBK [28, 29]. In analog to
the fermionic formulation by Potthoﬀ [17], this involves a
Legendre transform of the universal part of ΓBK, the two
particle irreducible (2PI) Luttinger-Ward functional ΦLW
[30]. The transform changes the functional dependence
from the one- and two-point response functions, Φ and
G, to their respective self-energies Σ1/2 and Σ, produc-
ing a universal self-energy functional F ≡ F[Σ1/2, Σ].
Using the self-energy eﬀective action ΓSE we formu-
late the self-energy functional theory (SFT) approxi-
mation by exploiting the universality of F, which en-
ables an exact evaluation of ΓSE in the sub-space of self-
energies of any reference system having the same inter-
actions as the original lattice system [17]. By constrain-
ing the variational principle of ΓSE to this subspace we
arrive at the bosonic generalization of the SFT func-
tional ΓSFT. We show that for a local reference sys-
tem with a completely general imaginary-time depen-
dent hybridization function ∆(τ ) the variations of ΓSFT
yield the self-consistency equations of bosonic dynami-
cal mean-ﬁeld theory (BDMFT) [31–36]. On the other
hand, when omitting the hybridization function com-
pletely and neglecting the kinetic energy contributions
of non-condensed bosons, static mean-ﬁeld theory [5, 37]
is recovered.

As a proof of concept, we use SFT to study the Bose-

Hubbard model [5] at ﬁnite temperature on the two-
and three-dimensional cubic lattice with nearest neighbor
hopping. For this purpose we make use of the simplest
imaginable Hamiltonian reference system comprising a
single bosonic state and three variational parameters:
a symmetry-breaking ﬁeld F (cid:48) coupling to the particle-
creation/annihilation operators (b and b†) and the two
ﬁelds ∆00 and ∆01 that are coupled with the density (b†b)
and pair-creation/annihilation operators (bb and b†b†),
respectively. Hence, the ﬁelds ∆00 and ∆01 enter as an in-
stantaneous imaginary-time Nambu hybridization func-
tion ∆(τ ) = δ(τ )∆ in the reference system action. This
reference system Hamiltonian has also been used in the
recently developed Bogoliubov+U theory (B+U) [38].

We compare our SFT results, employing the mini-
mal reference system, to exact lattice quantum Monte
Carlo (QMC) results [39] and ﬁnd quantitative agree-
ment on the location of phase-boundaries, energetics, and
local observables throughout the normal and superﬂuid
phases. We also compare with BDMFT results [34, 36],
corresponding to the local SFT approximation with an
inﬁnite number of variational parameters. The deviation
of the three parameter SFT from QMC (and BDMFT) is
surprisingly small and only noticeable close to the normal
to superﬂuid phase transition, where kinetic quantum
ﬂuctuations become prominent. The B+U calculations
in Ref. 38 use the same reference system Hamiltonian
and show excellent agreement with QMC at zero temper-
ature. The SFT method presented here, however, gives
quantitative agreement with QMC also at ﬁnite temper-
ature.

While the calculations presented here employ a local
self-energy approximation, SFT trivially extends to non-
local self-energies and cluster reference systems [23]. The
great promise of the SFT formalism lies in its ability to
treat systems with gauge ﬁelds [8–10] and other com-
plex terms such as spin-orbit coupling [11–13], where lat-
tice quantum Monte Carlo approaches suﬀer from a sign
problem. The fermionic version of SFT has also been ex-
tended to systems out of equilibrium [40, 41]. This makes
bosonic SFT an interesting alternative to the recently de-
veloped real-time dynamical mean-ﬁeld theory [42] and
its bosonic generalization [43], for studies of, e.g., the su-
perﬂuid to normal phase transition in quenched or driven
non-equilibrium systems.

This paper is organized as follows. In Sec. II we present
a general derivation of the SFT formalism for bosons. We
discuss the Baym-Kadanoﬀ eﬀective-action ΓBK derived
by De Dominicis and Martin [26, 27] in Sec. II A and
show how the self-consistency conditions of BDMFT can
be derived from it in Sec. II B. In Sec. II C we derive the
self-energy eﬀective action ΓSE as a Legendre transform
of ΓBK. The SFT formalism is then developed in Sec. II D
for a general bosonic lattice system (Sec. II D 1), and a
general reference system (Sec. II D 2). We further show
how BDMFT (Sec. II D 3) and the mean-ﬁeld approxima-
tion (Sec. II D 4) are obtained as limits of SFT. In Sec.
III we introduce the Bose-Hubbard model, and the min-

2

imal reference system (Sec. III A). Sec. IV is devoted to
numerical results, in particular phase boundaries (Sec.
IV A) and thermodynamical observables (Sec. IV B). We
also discuss the superﬂuid phase transition in Sec. IV C
and the Hugenholtz-Pines relation in Sec. IV D. Finally
in Sec. V we conclude and give an outlook on future ap-
plications.

II. THEORY

(cid:88)

(cid:88)

Consider a general system of lattice bosons with local

interactions having the Hamiltonian

H =

(b†i Fi + F †i bi ) +

tijb†i bj + ˆV3 + ˆV4 ,

(1)

i

ij

where b†i (bi) creates (annihilates) a boson at site i, tij
is the single-particle hopping, F is an external ﬁeld,
which couples linearly to the bosonic operators, and
ˆV3 and ˆV4 are general interactions with three and four
legs, respectively. Using Einstein summation and the
Nambu operators b†α = b†iν = (b†i , bi )ν with commu-
tator [bα, b†β] = (1 ⊗ σz)α
β , where α is a composite in-
dex comprising the site and Nambu indices i and ν, the
Hamiltonian can be written compactly as

H = F†αbα +
ˆV3 = V (3)

1
2

b†αtα

β bβ + ˆV3 + ˆV4 ,

αβγ bαbβbγ ,

ˆV4 = V (4)

αβγδ bαbβbγbδ .

(2)

(3)

β = tiη

where tα
jν = tij ⊗ 1ην, up to an irrelevant constant.
For brevity in the following we will drop all tensor indices
whenever contractions are well deﬁned.

The partition function Z is given by the trace of
the imaginary-time-ordered exponential Z = Tr[TCe−S],
where S is the action

(cid:90) β

(cid:90) β

0

+

1
2

(cid:90)(cid:90) β

0

S[b] =

dτ ( ˆV3[b(τ )] + ˆV4[b(τ )]) +

dτ F†b(τ )

0

dτ dτ(cid:48)b†(τ )[−G−1

0 (τ, τ(cid:48))]b(τ(cid:48)) ,

(4)

β is the inverse temperature, and the hopping tij is ab-
sorbed in the non-interacting propagator

G−1
0 (τ, τ(cid:48)) = δ(τ − τ(cid:48))(−[1 ⊗ σz]∂τ(cid:48) − t) .

(5)

The partition function Z’s functional dependence on
F and G−1
0 ], make the free energy
Ω[F, G−1
0 ] ≡ − ln[Z]/β a generating functional for the
propagators

0 , Z = Z[F, G−1

β

δΩ
δF†

δΩ
0 (τ(cid:48), τ )

δG−1

2β

= (cid:104)b(cid:105) ≡ Φ ,
= −(cid:104)b(τ )b†(τ(cid:48))(cid:105) = G(τ, τ(cid:48)) − ΦΦ† ,

(6)

(7)

where Φ is the expectation value of the bosonic Nambu
annihilation operator b, G is the connected single-
particle Green’s function, and the expectation value of
an operator ˆO(τ ) is deﬁned as the time-ordered trace
(cid:104) ˆO(τ )(cid:105) = Tr[T e−S ˆO(τ )]/Z.

A. Baym-Kadanoﬀ eﬀective action

The eﬀective action formulation is a useful starting
point for approximations to the many-body system. It is
based on a Legendre transform of the free energy func-
tional Ω in both F and G−1
to the interacting system
propagators Φ and G, see Refs. [44, 45] for an overview.
The resulting functional ΓBK = ΓBK[Φ, G] was derived
by Baym and Kadanoﬀ [28, 29] for fermions and general-
ized to bosons by De Dominicis and Martin [26, 27] and
later to relativistic systems [46]. The functional has the
form

0

ΓBK[Φ, G] = S0[Φ] +

+

0 G]

Tr[G−1

1
2
1
Tr ln[−G−1] + ΦLW[Φ, G],
2

(8)

where S0 is the non-interacting part of the system action,
S0[Φ] = F†Φ − 1
0 Φ. For explicit deﬁnitions of
the products and traces, see Appendix A. The Baym-
Kadanoﬀ functional ΓBK is stationary in Φ and G at the
physical solution

2 Φ†G−1

δΓBK
δΦ†

= 0 ,

δΓBK
δG

= 0 .

(9)

In Eq. 8, the whole complexity of the many-body
system is contained in the Luttinger-Ward functional
ΦLW[Φ, G] ≡ ΦLW[Φ, G, ˆν3, ˆV4] [30] which contains all
two-particle irreducible diagrams (2PI) in G with the
three- and four-point vertices ˆν3 = ˆV3 + ˆV4Φ and ˆV4, re-
spectively [47]. Note that the Luttinger-Ward functional
ΦLW is a universal functional, in that it depends only on
the interacting one- and two-point propagators (Φ and
G respectively) and the three- and four-point interaction
vertices ( ˆV3 and ˆV4).
In particular, ΦLW does not de-
pend on the free propagator G0 of the system. Using the
diagrammatic notation

(10)

the lowest order diagrams in ΦLW can be written as

ΦLW =

, (11)

3

when omitting constant prefactors [44]. The functional
derivative δΦ†ΦLW amounts to removing one Φ† term
in the ﬁrst order terms and in the eﬀective three point
vertex ˆν3 = ˆV3+ ˆV4Φ, which yields a one-point 2PI vertex

δΦLW
δΦ†

=

,

(12)

while δGΦLW corresponds to cutting one propagator line
G, which yields a two-point 2PI vertex

δΦLW
δG

=

.

(13)

The explicit form of the stationary condition [Eq. (9)]
gives the equations of motion for the propagators

δΓBK
δΦ†
δΓBK
δG

= F − G−1
0 −
=

G−1

1
2

0 Φ +

δΦLW
δΦ†
G−1 +

1
2

δΦLW
δG

= 0 ,

(14)

= 0 .

(15)

In the last equation we directly identify the two-point
2PI vertex as the self-energy δGΦLW = −Σ/2. The one-
point vertex is less renowned, and will be denoted here as
δΦ†ΦLW = −Σ1/2. Hence, the stationary condition yields
the Dyson equations

G−1

0 Φ = F − Σ1/2 ,
G−1 = G−1
0 − Σ .

(16)

(17)

Recently,

The power of the eﬀective action formalism is that
approximations of the Luttinger-Ward functional ΦLW
produce non-perturbative approximations, i.e., sums to
all orders in the interactions ˆV3 and ˆV4 and the non-
interacting propagator G0, that still obey the symmetries
of the original system. In particular the approximations
conserve total energy, density, and momentum [28, 29].
In (relativistic) quantum ﬁeld theory it is common to
make consistent approximations in ΦLW to a given “loop-
order” in the 2PI diagrams [48].
interesting issues

regarding the single-
valuedness of the Luttinger-Ward functional ΦLW have
been raised within the framework of truncated (but high-
order) expansions using diagrammatic Monte Carlo, dy-
namical mean-ﬁeld theory, and the GW-approximation
[49, 50]. The ﬁndings show that particular self-consistent
schemes to sum the boldiﬁed diagrams to inﬁnite order
can produce non-physical solutions, where a solution is
given by the resulting propagator(s) G (and Φ) and self-
energy(s) Σ (and Σ1/2). This should come as no surprise
as the construction of the Baym-Kadanoﬀ functional ΓBK
is a Legendre-transform of the free energy Ω. Thus, while
ΓBK and Ω have the same stationary points, there is no
guarantee that maximas and inﬂection points of Ω do
not become minimas of ΓBK. In such a case a stationary
point of Ω, which is not a local minimum, can very well
become a local minimum of ΓBK and hence an attractive
ﬁx-point for self-consistent calculations of ΓBK through
the evaluation of ΦLW.

Φ=,G=,ˆV3=,ˆV4=,ˆν3==ˆV3+,+++++++++O(ˆV4)++++O(V2)+++O(V2)B. Dynamical mean-ﬁeld theory

An interesting class of approximations to the eﬀec-
tive action amounts to evaluate the exact Luttinger-Ward
functional, but only for a selected subset of propagators.
One example is the local real-space approximation

ΦLW[Φ, G] ≈ ΦLW[Φ, Gii] ,

(18)

which accounts for all diagrams with site-local propaga-
tors Gii of the lattice. For number conserving systems
(Φ = F = 0), Eq. (18) becomes an equality in the limit
of inﬁnite dimensions [21, 51] yielding the exact solution.
Only accounting for local diagrams in ΦLW trivially gen-
erates a site-local self-energy

− 2δGij ΦLW[Φ, Gll] = δijΣii .

(19)

This approximation is not interesting per se as the cal-
culation of ΦLW[Φ, Gii] remains a formidable problem.
The ingenuity of dynamical mean-ﬁeld theory (DMFT),
however, is the observation that there exists a simpler
and exactly solvable many-body system with the same
local Luttinger-Ward functional. In fact, there is a refer-
ence system (here denoted with primed quantities) with
the same propagators Φ and Gii, and thus the same
Luttinger-Ward functional ΦLW[Φ, Gii], but with a pri-
ori unknown local sources F(cid:48)i and G(cid:48)0,ij = δijG(cid:48)0. The
corresponding reference-system eﬀective action,

Γ(cid:48)BK = S(cid:48)0[Φ] +

1
2

Tr[G(cid:48)−1

0 Gii]

+

1
2

Tr ln[−G−1

ii ] + ΦLW[Φ, Gii] ,

(20)

is also stationary at Φ and Gii, δΦ†Γ(cid:48)BK = δGiiΓ(cid:48)BK = 0.
The DMFT eﬀective action can be constructed as the
diﬀerence, ΓDMFT = ΓBK−Γ(cid:48)BK, which remains stationary,
δΦΓDMFT = δGiiΓDMFT = 0, and whose variations give

(cid:88)

j

δΓDMFT
δΦ†i
δΓDMFT

δGii

4

“the impurity problem” in DMFT, has a general (re-
tarded) non-interacting propagator G(cid:48)−1
, and exact solu-
tions can only be obtained by inﬁnite summations of dia-
grams using, e.g., continuous-time quantum Monte Carlo
[52, 53].

0

C. Self-energy eﬀective action

An interesting reformulation of the Baym-Kadanoﬀ
functional ΓBK has been devised by Potthoﬀ [17] for
fermions. The starting point is a Legendre transform of
the Luttinger-Ward functional ΦLW, changing the func-
tional dependence from the dressed propagators Φ and G
to the one- and two-point vertices Σ1/2 and Σ. Here we
generalize this procedure for the bosonic action. Using
the Dyson equations [Eqs. (16) and (17)] we can write
ΓBK [Eq. (8)] as

ΓBK[Φ, G] =

1
2

0 Φ +

Φ†G−1

1
2
+ ΦLW[Φ, G] + Σ†1/2Φ +

Tr ln[−G−1]
1
2

Tr[ΣG],

(23)

where the last line can be viewed as a Legendre transform
of ΦLW [54]. This is possible because the two last terms
are in fact derivatives of ΦLW, i.e., the last line can be
replaced by the universal functional

F[Σ1/2, Σ] = ΦLW[Φ, G]− (δΦΦLW)Φ− Tr[(δGΦLW)G]
(24)

= ΦLW[Φ, G] + Σ†1/2Φ +

Tr[ΣG] ,

1
2

that depends only on the one- and two-point self-energies
Σ1/2 and Σ, having (by construction) the variations

†
δΣ

1/2F = Φ ,

δΣF = G/2 .

(25)

In terms of F the Baym-Kadanoﬀ functional ΓBK[Φ, G]
can be rewritten as a self-energy eﬀective action ΓSE
parametrized by the self-energies of Σ1/2 and Σ

=

G−1
0,ijΦj − G(cid:48)−1

0 Φi − Fi + F(cid:48)i = 0 , (21)

= [G−1
= [Gii]−1 + Σii − G(cid:48)−1

0 ]ii + [−G−1]ii − G(cid:48)−1
0 = 0 .

0 − [−Gii]−1

ΓSE[Σ1/2, Σ] =

(F − Σ1/2)†G0(F − Σ1/2)

(22)

+

1
2

0 − Σ)] + F[Σ1/2, Σ],

(26)

1
2
Tr ln[−(G−1

These stationarity conditions are equivalent to the
DMFT self-consistency equations [21] which are used to
determine the reference system’s source ﬁelds F(cid:48) and
G(cid:48)−1
; Eq. (22) ﬁxes the reference system’s Weiss ﬁeld
G(cid:48)0 [21] and Eq. (21) determines the eﬀective symmetry
breaking ﬁeld F(cid:48) of the reference system in the bosonic
generalization of DMFT [31–36].

0

Solving the reference system while imposing these re-
lations yields a non-trivial and non-perturbative solution
of the original lattice system, including all local diagrams
in ΦLW. Note that the reference system, commonly called

which remains stationary at the physical solution, as the
variations with respect to Σ1/2 and Σ still yield the
Dyson equations [Eqs. (16) and (17)]

δΓSE
δΣ†1/2
δΓSE
δΣ

2

= −G0(F − Σ1/2) + Φ = 0 ,

= −(G−1

0 − Σ)−1 + G = 0 .

(27)

(28)

This self-energy eﬀective action ΓSE = ΓSE[Σ1/2, Σ]
can be used to construct generalized approximations in

the spirit of dynamical mean-ﬁeld theory. The result-
ing class of approximations is commonly denoted as self-
energy functional theory (SFT) approximations [17].

We note that the self-energy eﬀective action ΓSE de-
rived here in Eq. (26) diﬀers from the one previously
derived in Ref. 25. The diﬀerence lies in the one-point
Dyson equation [Eq. (27)] obtained at stationarity of the
self-energy functional ΓSE. The result we arrive at in
Eq. (27) is a direct consequence of the bosonic Baym-
Kadanoﬀ eﬀective action ΓBK [Eq. (8)] and its one-point
Dyson equation [Eq. (16)], while Ref. 25 uses an ansatz
for the one-point Dyson equation that is inconsistent with
ΓBK, see Appendix H for a detailed discussion.

D. Self-energy functional theory

As pointed out in the seminal work of Potthoﬀ [17], the
universality of the self-energy functional F = F[Σ1/2, Σ]
can be used to construct a generalized class of approxima-
tions to interacting many-body systems. It is instructive
to recall the main steps in the construction of the dynam-
ical mean-ﬁeld theory approximation in Section II B. It
was based on (i) an initial approximation of the universal
part of the eﬀective action [Eq. (18)] (the Luttinger-Ward
functional ΦLW), (ii) the introduction of an exactly solv-
able reference system with the same universal functional
[Eq. (20)], and (iii) the use of the variational principle
of the eﬀective action to obtain self-consistent equations
for the reference system [Eqs. (21) and (22)]. In the con-
struction of self-energy functional theory the approxima-
tion is moved from the functional to the variational prin-
ciple.

Σ1/2 = Σ(cid:48)1/2 and Σ = Σ(cid:48) is given by

ΓSE[Σ(cid:48), Σ(cid:48)1/2] = βΩ(cid:48) +

1
2

1
2

−

(F(cid:48)− Σ(cid:48)1/2)†G(cid:48)0(F(cid:48)− Σ(cid:48)1/2) +

(cid:20) G−1

(cid:21)
(F− Σ(cid:48)1/2)†G0(F − Σ(cid:48)1/2)
0 − Σ(cid:48)
0 − Σ(cid:48)
G(cid:48)−1

Tr ln

1
2

5

,

(31)

In solving the reference system exactly,

where we have replaced F in Eq. (26) using the equations
of the reference system [Eqs. (29) and (30)].
the self-
energies Σ(cid:48)1/2 and Σ(cid:48) are parametrized by F(cid:48) and G(cid:48)0,
i.e., Σ(cid:48)1/2 = Σ(cid:48)1/2[F(cid:48), G(cid:48)0] and Σ(cid:48) = Σ(cid:48)[F(cid:48), G(cid:48)0] and we
can formally construct the self-energy functional theory
approximation ΓSFT to the self-energy eﬀective action ΓSE
according to

ΓSFT[F(cid:48), G(cid:48)0] = ΓSE[Σ(cid:48)1/2[F(cid:48), G(cid:48)0], Σ[F(cid:48), G(cid:48)0]] .

(32)

In terms of ΓSFT we can now approximate the self-energy
eﬀective action variational principle δΣ1/2 ΓSE = δΣΓSE =
0 [Eqs. (27) and (28)] by constraining the variations to
the subspace of self-energies spanned by the reference
system, giving the Euler equations

δΓSFT
δF(cid:48)†

= 0 ,

δΓSFT
δG(cid:48)−1

0

= 0 .

(33)

If we explicitly perform the variations, using the varia-
tional relations of the free energy [Eq. (6) and (7)], only
the self-energy dependent variations are nonzero, and the
Euler equations take the form

1. Functional formulation

0 =

δΓSFT
δF(cid:48)†

=

δΓSE
δΣ(cid:48)1/2

δΓSE
δΣ(cid:48)

δΣ(cid:48)
δF(cid:48)†

= (Φ(cid:48) − Φ)

+

1
2

(G(cid:48) − G)

δΣ(cid:48)
δF(cid:48)†

,

(34)

+

δΣ(cid:48)1/2
δF(cid:48)†
δΣ(cid:48)1/2
δF(cid:48)†

0

δΣ(cid:48)1/2
δG(cid:48)−1
δΣ(cid:48)1/2
δG(cid:48)−1

0

Let us again introduce an (analytically or numerically)
exactly solvable reference system, with linear ﬁeld F(cid:48) and
free propagator G(cid:48)0. The self-energy eﬀective action Γ(cid:48)SE
of the reference system is then given by

Γ(cid:48)SE[Σ1/2, Σ] =
1
2

+

1
2
Tr ln[−(G(cid:48)−1

(F(cid:48) − Σ1/2)†G(cid:48)0(F(cid:48) − Σ1/2)

0 − Σ)] + F[Σ1/2, Σ] ,

which, at the physical solution Σ1/2 = Σ(cid:48)1/2 and Σ = Σ(cid:48),
Γ(cid:48)SE[Σ(cid:48)1/2, Σ(cid:48)] = δΣ(cid:48)Γ(cid:48)SE[Σ(cid:48)1/2, Σ(cid:48)] = 0,
is stationary, δΣ(cid:48)
and equal to the reference system’s free energy

1/2

Γ(cid:48)SE[Σ(cid:48)1/2, Σ(cid:48)] = βΩ(cid:48)[F(cid:48), G(cid:48)0] .

(30)

We can now use the universality of F to evaluate
the self-energy eﬀective action ΓSE of the original lat-
tice system at the physical solution (Σ(cid:48)1/2 and Σ(cid:48)) of
the reference system. The ΓSE functional evaluated at

0 =

δΓSFT
δG(cid:48)−1

0

=

δΓSE
δΣ(cid:48)1/2

+

δΓSE
δΣ(cid:48)

δΣ(cid:48)
δG(cid:48)−1

0

(29)

= (Φ(cid:48) − Φ)

+

1
2

(G(cid:48) − G)

δΣ(cid:48)
δG(cid:48)−1

0

,

(35)

where the self-energy variations of ΓSE are obtained using
Eq. (31). From the form of these equations one can see
that the approximate variational principle for ΓSFT [Eq.
(33)] corresponds to ﬁnding the stationary point of ΓSE
with respect to Σ1/2 and Σ projected onto the plane of
reference-system representable self-energies Σ1/2 = Σ(cid:48)1/2
and Σ = Σ(cid:48).

The self-energy functional theory approximation ΓSFT
of the self-energy eﬀective action [Eqs. (31) and (32)]
and its corresponding variational principle [Eqs. (34) and
(35)] are the two main results of this paper.

6

can be located using, e.g., a multi-dimensional root
solver. This general formalism will be applied to the
canonical model for interacting lattice bosons, the Bose-
Hubbard model, in Sec. III.

3. Dynamical mean-ﬁeld theory limit

The self-energy functional theory approximation con-
tains the bosonic version [31–36] of dynamical mean-ﬁeld
theory [21] as a special limit, in direct analogy to the
fermionic case [17]. When allowing the reference sys-
tem to have a completely general (retarded) but local
free propagator G(cid:48)0,ij = δijG(cid:48)0,ii, the Euler equations of
SFT [Eqs. (34) and (35)] simplify to the DMFT self-
consistency equations [Eqs.
In terms
of the reference system parametrization of the previous
section, this amounts to taking the limit of an inﬁnite
number of bath sites.

(21) and (22)].

With G(cid:48)0 being local, also the reference system’s self-
energy is local, Σ(cid:48)ij = δijΣ(cid:48)ii, and the Σ(cid:48)-variation in
the SFT Euler equation [Eq. (35)] reduces to 2δΣ(cid:48)
iiΓSE =
G(cid:48)ii − Gii. Furthermore, the retardedness of G(cid:48)0 provides
suﬃcient freedom to fulﬁll the SFT Euler equations [Eqs.
(34) and (35)] by enforcing that the local Green’s func-
tions and the symmetry breaking order parameters of the
physical and reference systems are identical

Φ(cid:48) − Φ = 0 , G(cid:48)ii − Gii = 0 .

(40)

Using the Dyson equation [Eq. (17)] on the last relation
directly gives the DMFT self-consistency equation for the
0 = [Gii]−1 + Σ(cid:48)ii [Eq.
reference system’s Weiss ﬁeld G(cid:48)−1
(22)]. The analogous relation for the symmetry break-
ing order parameters requires the insertion of the Dyson
equation for Σ(cid:48)1/2 [Eq.
In terms of the
imagnary-time products deﬁned in Appendix A this reads

(16)] twice.

0 Φ(cid:48) − G(cid:48)−1

0 = Φ(cid:48) − Φ = G0
where the relation in brackets is equal to zero, in direct
agreement with the DMFT self-consistency relation for
the symmetry breaking ﬁeld F(cid:48) [Eq. (21)].

(41)

(cid:2)G−1

0 Φ(cid:48) − F + F(cid:48)(cid:3) ,

4. Static mean-ﬁeld theory limit

FIG. 1. (Color online) Schematic examples of a physical sys-
tem and two types of reference-system constructions. Left:
A two-dimensional square lattice with correlated sites (big
blue circles). Center: Reference systems with local non-
interacting Green’s functions G(cid:48)
0,i and additional
non-interacting bath sites (small green circles). Right: Two-
by-two plaquette reference system, with a non-local free-
propagator G(cid:48)

0 and non-local self-energy Σ(cid:48).

0,ij = δijG(cid:48)

2. Reference system

The versatility of the self-energy functional theory ap-
proach lies in the freedom of constructing the reference
system. While keeping a subset of lattice sites i with the
same interaction vertices as the physical system [ ˆV3 and
ˆV4 in Eq. (3)] the reference system’s free propagator G(cid:48)0
can be parametrized by hybridizing the interacting lat-
tice sites with non-interacting “bath sites”. In the case
of a two-dimensional square lattice, two such choices of
reference systems are shown schematically in Fig. 1. In
general G(cid:48)0,ij can be written as

G(cid:48)−1
0,ij(iωn) = σziωn − 1(µ − t(cid:48)ij) − ∆ij(iωn) ,

(36)

where ∆(iωn) = ∆ij(iωn) is the reference system hy-
bridization function, parametrized by the non-interacting
bath sites. Labeling the bath sites with Greek indices
and denoting the reference-system hopping with t(cid:48) the
hybridization function can be expressed as

∆ij(iωn) =

1
2

t(cid:48)iα

˜G0,αβ(iωn)t(cid:48)βj ,

(37)

(cid:88)

αβ

(cid:88)

where ˜G−1
0,αβ(iωn) = σziωn − 1t(cid:48)αβ is the free propagator
restricted to the bath sites. Under these assumptions the
reference system can be written in Hamiltonian form

H(cid:48)[F(cid:48), t(cid:48)] = ˆV3 + ˆV4 +

(b†i F (cid:48)i + F (cid:48)∗i bi ) + b†t(cid:48)b , (38)

i

where b† is a Nambu vector in both correlated and bath
sites. As H(cid:48) comprises a ﬁnite number of bosonic states
the reference system free energy Ω(cid:48) and self-energies Σ(cid:48)1/2
and Σ(cid:48) can be calculated using exact diagonalization, see
Appendix D. With these results the SFT functional ΓSFT
[Eq. (31)] can be evaluated and its stationary points with
respect to variations in F(cid:48) and t(cid:48),

δΓSFT
δF(cid:48)†

= 0 ,

δΓSFT

δt(cid:48)

= 0 ,

(39)

While dynamical mean-ﬁeld theory is a speciﬁc limit of
self-energy functional theory, the static mean-ﬁeld theory
(MFT) approximation [5, 37] can only be obtained by
making one further approximation. Contrary to SFT,
the static mean-ﬁeld theory only accounts for the kinetic
energy of the bosonic condensate, and neglects all kinetic
energy contributions from non-condensed bosons. Hence,
to arrive at MFT from SFT one has to drop the trace log
term in the SFT functional [Eq. (31)], which accounts
for the kinetic energy contributions from non-condensed
bosons. Upon dropping the trace log terms the variations

of ΓSFT [Eqs. (34) and (35)] reduce to

(cid:0)Φ − Φ(cid:48)(cid:1) δΣ(cid:48)1/2

δF(cid:48)†

= 0 ,

(cid:0)Φ − Φ(cid:48)(cid:1) δΣ(cid:48)1/2

δG(cid:48)−1

0

7

= 0 ,

(42)

which are trivially fulﬁlled if the lattice and reference
systems’ one-point propagators are equal, Φ = Φ(cid:48). As
the only variational parameter in mean-ﬁeld theory is
the symmetry breaking ﬁeld F(cid:48) the reference-system free
propagator is ﬁxed to G(cid:48)−1
0 = σziωn + µ1. Thus, station-
arity Φ = Φ(cid:48) amounts to inserting G(cid:48)0 in Eq. (41), which
for a homogeneous lattice system with nearest-neighbor
hopping J and coordination number z, reduces to

F(cid:48) = F − (G−1

0 − G(cid:48)−1

0

)Φ(cid:48) = F − zJΦ(cid:48) .

(43)

The resulting equation for the reference-system linear
symmetry breaking ﬁeld F(cid:48)
is identical to the self-
consistency relation of the static mean-ﬁeld approxima-
tion [5, 37].

III. THE BOSE-HUBBARD MODEL

(cid:88)

i

(cid:88)

i

(cid:88)

(cid:104)i,j(cid:105)

To test our generalization of self-energy functional the-
ory to bosons we apply it to the canonical model for inter-
acting lattice bosons, the Bose-Hubbard model [5], which
is described by the Hamiltonian

H = −J

(b†i bj + b†jbi ) +

U
2

b†i b†i bi bi − µ

ˆni ,

(44)
with nearest neighbor hopping J, local pair interaction
U , and chemical potential µ, where b†i (bi) creates (an-
nihilates) a boson at site i and ˆni = b†i bi is the den-
sity operator. We will consider the model on the two-
and three-dimensional square lattice and study its phase
boundaries, observables, and energetics at ﬁnite temper-
ature.

A. Minimal reference system

For the reference system we focus on the simplest pos-
sible construction, and use a single bosonic state with the
Hamiltonian

H(cid:48)[F(cid:48), ∆] =

U
2

b†b†b b − µˆn + F(cid:48)†b +

1
2

b†∆b ,

(45)

where b† = (b† b) is a Nambu operator, and F(cid:48) and ∆
are deﬁned as

F(cid:48) =(cid:0)F (cid:48) F (cid:48)∗(cid:1) , ∆ =

(cid:19)

(cid:18)∆00 ∆01

∆∗01 ∆00

.

(46)

Hence, the reference system is parametrized by the three
parameters F (cid:48), ∆00, and ∆01. The linear symmetry

FIG. 2. (Color online) Flow chart for the evaluation of the
SFT functional ΓSFT ≡ ΓSFT[F (cid:48), ∆00, ∆01] for given values of
F (cid:48), ∆00 and ∆01. The functional ΓSFT is used to numerically
locate stationary points ∇ΓSFT = 0.

breaking ﬁeld F (cid:48) is the conjugate variable to the anoma-
lous expectation value (cid:104)b(cid:105) while ∆00 and ∆01 are conju-
gate to the density (cid:104)b†b(cid:105) and the anomalous density (cid:104)bb(cid:105),
respectively. In the normal phase the number of varia-
tional parameters reduces to only ∆00 as the absence of
symmetry breaking requires F (cid:48) = ∆01 = 0. Henceforth,
we will denote this three parameter self-energy functional
theory approximation as SFA3.

Clearly, the restriction of the reference system to a sin-
gle bosonic state is a drastic approximation. Temporal
retardation eﬀects can be treated by adding additional
non-interacting bath sites to the reference system, pro-
ducing additional variational parameters, where in the
limit of inﬁnite number of bath-sites the BDMFT so-
lution [34, 36] is obtained. However, as we will show,
already SFA3 quantitatively describes the Bose-Hubbard
model, both deep in the superﬂuid and the Mott/normal
phase.

Note that the SFA3 minimal reference system Hamilto-
nian in Eq. (45) has the same variational degrees of free-
dom as the reference system employed in Bogoliubov+U
theory (B+U) [38].

InputparametersF0,∆00,∆01HamiltonianH0[F0,∆00,∆01],Eq.(45)Propagators&free-energyG0,Φ0,Ω0,App.DSelf-energiesΣ01/2,Σ0,App.DLatticesystempropagatorsΦ,G,App.EΦ†G−10Φ,Φ0†G0−10Φ0,App.ATrace-logTrln[G0G−1],App.CSelf-energyfunctional,ΓSFT[F0,G00]≡ΓSE[Σ01/2,Σ0](a)(b)(c)(d)(e)(f)(g)ReferencesystemB. Numerical implementation

are shown in Figs. 3a and 3b, respectively.

8

To ﬁnd stationary solutions of the SFT functional ΓSFT
[Eq. (31)] for the Bose-Hubbard model [Eq. (44)] and the
reference system [Eq. (45)] we implement a direct eval-
uation of ΓSFT and use a root ﬁnder [55] in combination
with numerical evaluation of the gradient ∇ΓSFT to locate
stationary solutions ∇ΓSFT = 0. The procedure for eval-
uating ΓSFT is shown schematically in Fig. 2 and consists
of the steps: (a) starting from given values of F (cid:48), ∆00 and
∆01, (b) construct the reference systems Hamiltonian H(cid:48)
using Eq. (45), (c) compute the free-energy Ω(cid:48) and the
one- and two-point propagators Φ(cid:48) and G(cid:48) of the refer-
ence system using Eqs. (D1) to (D7) in Appendix D, (d)
compute the reference system self-energies Σ(cid:48)1/2 and Σ(cid:48)
using the one- and two-point Dyson Equations (D9) and
(D10) in Appendix D, (e) compute the lattice system one-
and two-point propagators Φ and G using the relations
in Appendix E, (f) calculate the products Φ†G−1
0 Φ and
Φ(cid:48)†G(cid:48)−1
0 Φ(cid:48) using the algebraic rules in Appendix A and
the trace log Tr ln[G(cid:48)G−1] using Eq. (C9) in Appendix
C, and ﬁnally (g) evaluate the self-energy functional ΓSFT
using Eq. (31).

In order to achieve high accuracy in the evaluation
of ΓSFT, the trace log term in Eq. (31) is evaluated us-
ing Eq. (C9) and third-order high-frequency tail coeﬃ-
cients. Calculations at temperatures T /J ∼ 1 – 10 then
require 103 – 104 Matsubara frequencies in order to reach
a relative accuracy of 10−9, for details see Appendix C.
Once as stationary point of ΓSFT is located in terms of
the reference system parameters F (cid:48), ∆00 and ∆01 (i.e.
∇ΓSFT[F (cid:48), ∆00, ∆01] = 0), lattice system observables can
be computed as described in Appendix E.

IV. RESULTS

The Bose-Hubbard model is and ideal model for bench-
marking SFA3 as ample numerical results are already
available on the two- and three-dimensional cubic lat-
tices. In particular, since the model is free of sign prob-
lems, quantum Monte Carlo (QMC) [39] provides nu-
merically exact results (after ﬁnite size scaling). How-
ever, since SFT is inherently an approximate method we
also compare with other local and semi-local approximate
schemes:
static mean-ﬁeld theory (MFT) [5], Bogoli-
ubov+U theory (B+U) [38], bosonic dynamical mean-
ﬁeld theory (BDMFT) [34, 36], the pseudo-particle based
variational cluster approximation (VCA) [56, 57], and the
cluster composite boson mapping method (CCBM) [58].

for

results

At zero temperature mean-ﬁeld is already expected
to give qualitatively correct
the three-
dimensional lattice [37]. Quantitatively, however, kinetic
ﬂuctuation corrections beyond mean-ﬁeld stabilize the
Mott phase and strongly shift the tip of the unit-ﬁlling
Mott-lobe to larger J/U , see Fig. 3a. However, as shown
in previous BDMFT studies [34, 36], local self-energy
approximations are suﬃcient to quantitatively capture
these kinetic ﬂuctuations. Surprisingly our SFA3 results,
where kinetic eﬀects are tuneable by only two variational
parameters (∆00 and ∆01), yield the same level of accu-
racy as BDMFT. We expect the SFA3 phase-boundary,
see inset in Fig. 3a, to move towards the BDMFT re-
sult when extending the reference system with additional
bath sites.

The Bose-Hubbard model on the two-dimensional lat-
tice is an even greater challenge for local approxima-
tions such as SFA3, as non-local correlations grow in
importance with reduced dimension. For this model in-
teresting results are available from the two semi-local
schemes VCA [56, 57] and CCBM [58]. The VCA re-
sults employ an eight-site cluster comprising three edge
sharing two-by-two plaquettes and determine the phase-
boundary from the closing of the Mott gap [56], while the
CCBM calculations are performed using a single two-by-
two plaquette cluster. Hence, both methods require the
solution of much more complex eﬀective models than the
single-site SFA3 reference system. However, while SFA3
yields quantitatively correct results, see Fig. 3b, apart
from a narrow region at the tip of the Mott-lobe (see
inset), VCA and CCBM show large deviations in this
region, even though both methods are semi-local and in-
corporate short-ranged non-local correlations. This be-
havior indicates that for the phase transition at the tip
of the Mott-lobe treating all kinetic ﬂuctuations with an
approximate local self-energy (as in SFA3 and BDMFT)
is more important than treating short ranged non-local
ﬂuctuations exactly (as in VCA and CCBM).

On the three-dimensional lattice we further present
results on the temperature driven normal to superﬂuid
phase transition at unit-ﬁlling ((cid:104)ˆn(cid:105) = 1), see Fig. 3c.
Also in this case the phase boundary of SFA3 lies on
top of both the BDMFT and QMC results, while MFT
and B+U deviates substantially. SFA3 also captures the
weakly interacting Bose gas (WIBG) limit, indicated by
a downturn in the critical temperature at low U/J. For
a detailed discussion in the context of BDMFT see Ref.
36.

B. Energetics and observables

A. Superﬂuid phase boundaries

The zero-temperature SFA3 results for the phase
boundary between the superﬂuid and the Mott-insulator
at unit-ﬁlling on the three- and two-dimensional lattice

To further characterize SFA3 we study local observ-
ables and energy components of the Bose-Hubbard model
on the three-dimensional lattice as a function of tempera-
ture at ﬁxed interaction U/J = 20 and chemical potential
µ/U = 0.4, see Fig. 4.

9

FIG. 3. (Color online) Phase boundaries for the Bose-Hubbard model, at temperature zero on the three-dimensional [panel (a)]
and two-dimensional [panel (b)] cubic lattices, and for unit-ﬁlling (n = 1) in three dimensions at ﬁnite temperature [panel (c)].
The SFA3 results (red triangles) are compared with MFT (dashed gray line), B+U [38] (blue dots), QMC [39] (diamonds),
BDMFT [34, 36] (circles), VCA [56, 57] (green crosses), and CCBM [58] (dashed brown line). The B+U results are suppressed
in panel (a) and (b), since they overlap with the QMC data within 1%, for the same reason the BDMFT results are only
partially shown [insets in panel (a) and (b)].

perature Tc/J ≈ 4.39778, to be compared to BDMFT
(Tc/J ≈ 4.365(3)) and QMC (Tc/J ≈ 4.43(3)) [36]. Note
that the QMC results for φ in Fig. 4 are computed for
a ﬁnite system with 403 sites, yielding a crossover rather
than the (thermodynamical limit) phase transition. The
QMC critical temperature Tc, however, is extrapolated to
the thermodynamical limit using ﬁnite size scaling [36].
We further note that MFT and ﬁnite-temperature B+U
are not precise in locating the phase transition, as they
both over-estimate Tc by more than 20%, see Fig. 4.

For the average local density n = (cid:104)ˆn(cid:105), shown in Fig.
4b, we ﬁnd that SFA3 agrees quantitatively with QMC in
both phases, with slight deviations only in the immediate
proximity of the phase transition, improving signiﬁcantly
on the MFT and B+U results.

The kinetic energy Ekin and total energy Etot are
shown in Fig. 4c and 4d respectively. The SFA3 result
for Etot is again in quantitative agreement with QMC
(and BDMFT). For the kinetic energy Ekin on the other
hand we ﬁnd a small but discernible deviation of SFA3
from QMC (and BDMFT) close to the phase transition
in the normal phase. This deviation directly shows the
diﬀerence between accounting for kinetic ﬂuctuations in
the normal phase (where ∆01 = F (cid:48) = 0) using a com-
pletely general imaginary-time dependent hybridization
function ∆(τ ) (as in BDMFT) and using a single varia-
tional parameter ∆00 (as in SFA3). However, from Fig.
4c it is evident that the major contribution to the kinetic
energy in the normal phase is accounted for by the in-
stantaneous SFA3 variational parameter ∆00. This can
be understood from the tremendous diﬀerence between
SFA3 and the MFT result, where the latter contains zero
variational parameters in the normal phase, and thereby
produces the atomic limit with zero kinetic energy.

While we ﬁnd the SFA3 approximation to be quantita-
tively predictive, the extremely limited variational space

FIG. 4.
(Color online) Local observables and energies vs.
temperature T for the Bose-Hubbard model on the three di-
mensional cubic lattice with U/J = 20 µ/U = 0.4 (n ≈ 1).
Panel (a): condensate order parameter φ, panel (b):
local
density n, panel (c): kinetic energy Ekin, and panel (d): to-
tal energy Etot. Results for SFA3 (red line), MFT (dashed
gray line), B+U [38] (blue dots), QMC [39] (diamonds), and
BDMFT [34, 36] (circles) are shown. The systematic errors
are smaller than the marker size.

The SFA3 superﬂuid order parameter φ = (cid:104)b(cid:105) repro-
duces the BDMFT results quantitatively, see Fig. 4a.
The phase transition occurs at the SFA3 critical tem-

(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)00.010.020.0300.20.40.60.81.JUΜUa(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)0.0330.0340.0350.350.40.45(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)00.020.040.0600.20.40.60.81.JUΜUbcomp.bos.(cid:180)VCA(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:180)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)0.0580.060.0590.40.35(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)051015202530350123456UJTJc(cid:230)B(cid:43)U(cid:237)QMC(cid:231)BDMFT(cid:242)SFA3MF(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)0246800.20.40.60.8TJΦa(cid:237)QMC(cid:231)BDMFTSFA3(cid:230)B(cid:43)UMF(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)02468100.920.961.1.041.08TJnb(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)0246810(cid:45)4(cid:45)3(cid:45)2(cid:45)10TJEkinJc(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:230)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:237)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)0246810(cid:45)10(cid:45)8(cid:45)6(cid:45)4TJEtotJdis not suﬃcient to adiabatically connect the weak and
deep superﬂuid, for an indepth discussion see Appendix
G. However, as this phenomenon has not been observed
for BDMFT we expect it to diminish when adding bath-
sites to the reference system.

C. Superﬂuid Phase Transition

At the stationary points of the SFT functional ΓSFT
[Eq. (31)], the free energy Ω is directly given by the value
of the functional ΓSFT itself, i.e., Ω = ΓSFT : δΓSFT = 0.
The SFA3 free energy Ω as a function of temperature T
for the same parameters as in Fig. 4 is shown in Fig. 5a.
At low temperatures, SFA3 displays both superﬂuid and
normal-phase stationary points, with the superﬂuid so-
lution yielding the lowest free energy Ω. At the phase
transition (Tc ≈ 4.39778) the free energies of the two
solutions cross, with the superﬂuid solution vanishing
at slightly higher temperatures, whence the transition is
weakly ﬁrst order, for a detailed discussion see Appendix
G. While the phase transition in the Bose-Hubbard model
is expected to be second order, the description of the
symmetry breaking using a classical ﬁeld F (cid:48) is known
to change the phase-transition order, see Ref. 59 for a
discussion of the issue in the context of EDMFT.

A map of the stationary points of the SFT functional
ΓSFT as a function of F (cid:48) and ∆00 can be obtained from
the gradient-two-norm-logarithm − log ||∇ΓSFT||2 which
diverges at the stationary points where ∇ΓSFT = 0. As
seen in Fig. 5b, deep in the superﬂuid phase (T /J = 1)
ΓSFT shows both a normal-phase stationary point (with
F (cid:48) = 0) and two symmetry-breaking superﬂuid station-
ary points. The symmetry breaking solutions are both
part of the same class of U (1) symmetry breaking so-
lutions with F (cid:48) = |F (cid:48)|eiθ, where only θ = 0, π are
seen in Fig. 5c, as F (cid:48)
is restricted to be real. Fur-
thermore, the mirror symmetry F (cid:48) → −F (cid:48) in Fig. 5c
is a direct result of the global U (1) symmetry of ΓSFT,
ΓSFT[F (cid:48)] = ΓSFT[F (cid:48)eiθ], ∀θ ∈ (cid:60).

D. Hugenholtz-Pines relation

In the superﬂuid phase of the Bose-Hubbard model
the broken U (1) symmetry imposes a constraint on the
zero-frequency single-particle Green’s function, or equiv-
alently the self-energy. In the continuum this constraint
is the well known Hugenholtz-Pines relation [60, 61],

µ = Σ00(k = 0, iω0) − Σ01(k = 0, iω0) ,

valid in the symmetry-broken superﬂuid phase. On
the lattice the Hugenholtz-Pines relation is shifted to
µ = Σ00(k = 0, iω0) − Σ01(k = 0, iω0) − zJ [62], and
is known to be weakly broken by local approximations
such as MFT, SFT, and BDMFT [36]. The relative
deviation δ/Σ00(k = 0, iω0) of SFA3 from the shifted

10

Hugenholtz-Pines relation is shown in Fig. 5c, where
δ = µ − Σ00(k = 0, iω0) + Σ01(k = 0, iω0) + zJ. The
deviation is small and comparable to what is observed
within BDMFT [36]; starting from the critical tempera-
ture Tc and going into the superﬂuid phase it shows an
initial increase and then starts to decrease with temper-
ature.

V. CONCLUSION AND OUTLOOK

We derived the self-energy eﬀective action ΓSE [Eq.
(26)] for lattice bosons with U (1) symmetry breaking by
Legendre-transforming the bosonic generalization of the
Baym-Kadanoﬀ functional ΓBK [Eq. (8)] of De Dominicis
and Martin [26, 27]. Our resulting functional ΓSE diﬀers
from the previously derived self-energy eﬀective action in
Ref. 25 on the level of the one-point Dyson equation.

Using the self-energy eﬀective action ΓSE we derived
the generalization of self-energy functional theory (SFT)
[17–20] to bosonic systems. As for fermions, SFT en-
ables to construct non-trivial variational approximations
of the self-energy functional using a exactly solvable aux-
iliary reference system. We showed that SFT simpliﬁes
to bosonic dynamical mean-ﬁeld theory (BDMFT) [31–
34, 36] in the limit of a local reference system with an in-
ﬁnite number of local degrees of freedom, while the static
mean-ﬁeld approximation can be obtained by neglecting
kinetic contributions of non-condensed bosons.

We apply SFT to the Bose-Hubbard model [5, 6], with
a minimal reference system comprising a single site with
three variational parameters, denoted as “SFA3”, which
was also used in Bogoliubov+U theory [38].

The SFA3 groundstate phase diagrams in two and
three dimensions show quantitative agreement with nu-
merically exact quantum Monte Carlo (QMC) [39] and
BDMFT results [31–34, 36]. The accuracy of SFA3 is
remarkable, considering the radically restricted varia-
tional space. In fact, while the SFA3 phase-boundaries
are in quantitative agreement with QMC, computation-
ally much more demanding cluster based schemes, such
as the pseudoparticle variational cluster approximation
(VCA) [56, 57] and the cluster composite boson map-
ping (CCBM) [58], show substantial deviations at the
tip of the Mott-lobe in two dimensions. Within SFA3 we
also study local observables and energetics throughout
the temperature driven normal phase to superﬂuid tran-
sition in three dimensions, ﬁnding excellent agreement
with QMC.

While the benchmark results are very encouraging, the
promise of SFT lies in its application to systems that
cannot be treated with QMC. Prime examples of such
systems are experimentally realized models with artiﬁ-
cial gauge ﬁelds [8–10] and spin-orbit interaction [11–13],
where QMC suﬀers from a severe sign problem.

Another interesting venue are bosonic non-equilibrium
problems in real time. While SFT already has been ex-
tended to real time for fermionic models [40, 41], the

11

points. To discern the two solutions we subtract a ﬁxed asymptotic model f (T ) = −T /2−(cid:112)0.3 + (T − 4.3)2/4− 10.85 from Ω

FIG. 5. (Color online) Panel (a): Free energy Ω vs. temperature T of the Bose-Hubbard model on the three-dimensional cubic
lattice at U/J = 20 and µ/U = 0.4 (n ≈ 1), showing the SFA3 normal-phase (circles) and superﬂuid (red triangles) stationary
and show Ω(cid:48) = Ω − f (T ). A detailed view of the crossing (dashed red line) of the free energies is shown in the inset. Panel (b):
Gradient map of ΓSFT as a function of ∆00 and F (cid:48) with ∆01 = 0 and T /J = 1 (deep in the superﬂuid phase). Panel (c):
Relative breaking of the Hugenholtz-Pines relation δ/Σ00(k = 0, iω0) vs. temperature T . The systematic error is smaller than
the marker size.

bosonic generalization to non-equilibrium would provide
an interesting alternative to the recently developed non-
equilibrium extension of BDMFT [43, 63].

In a broader context the SFT formalism is based on
the Baym-Kadanoﬀ eﬀective-action, constructed through
two successive Legendre transforms of the free energy
[26, 27]. The eﬀect of the transformation is to change
the functional dependence from bare to bold one- and
two-point propagators. However, as already shown by De
Dominicis and Martin [26, 27], this procedure can be con-
tinued to higher orders, by boldifying also the three-point
and four-point propagators. A very interesting venue for
future research is to extend SFT to the three-point irre-
ducible vertex. Such a theory should contain the recently
proposed local approximation of the dynamical three-leg
interaction vertex [64] as a special limit.

(cid:90) β

(cid:88)

γ

0

(cid:90) β

(cid:88)

γ

0

(cid:90)(cid:90) β

(cid:88)

αβ

0

α(τ, τ(cid:48)), C = AB, is deﬁned as the sum over one

and Bβ
super-index and an integration in imaginary time

Cα

β (τ, τ(cid:48)) =

d¯τ Aα

γ (τ, ¯τ )Bγ

β(¯τ , τ(cid:48)) ,

(A1)

while the product Rα(τ ) of a ﬁrst-order tensor Fα(τ ) and
α(τ, τ(cid:48)), R = AF, is deﬁned as
a second order tensor Aβ

Rα(τ ) =

d¯τ Aα

γ (τ, ¯τ )Fγ(¯τ ) .

(A2)

Hence, the scalar S, given by the sandwiched product
S = R†AF of two ﬁrst-order tensors R†α(τ ) and Fα(τ )
with a second order tensor Aα

β (τ, τ(cid:48)), becomes

ACKNOWLEDGMENTS

S = R†AF =

dτ dτ(cid:48) R†α(τ )Aα

β (τ, τ(cid:48))Fβ(τ(cid:48)) .

The authors would like to acknowledge fruitful dis-
cussions with E. Arrigoni, T. Ayral, L. V. Boehnke, D.
Golez, A. Herrmann, F. Hofmann, M. Knap, J. Panas,
and M. Potthoﬀ. Part of the calculations have been per-
formed on the UniFr cluster. HS and PW are supported
by FP7/ERC starting grant No. 278023. DH and LP
by FP7/ERC starting grant No. 306897 and FP7/Marie-
Curie CIG grant No. 321918.

Appendix A: Imaginary time tensor products

The eﬀective action formalism involves imaginary-time
ﬁrst and second order tensors, such as F and G0. The
α(τ, τ(cid:48))
product Cα

β (τ, τ(cid:48)) of two second-order tensors Aβ

(A3)
In equilibrium ﬁrst-order tensors are time indepen-
dent, Fα(τ ) = Fα, while second-order tensors are time-
translation invariant, A(τ, τ(cid:48)) = A(τ−τ(cid:48)). Thus, second-
order tensors can be transformed to Matsubara frequency
space using the relations [65–67]

Aα

β (iωn) =

Aα

β (τ ) =

dτ eiωnτ Aα

β (τ ) ,

e−iωnτ Aα

β (iωn) ,

(A4)

(A5)

(cid:90) β

0
1
β

∞(cid:88)

n=−∞

where ωn = π
β (2n + ϑ) with ϑ = (1− ξ)/2 and ξ = ±1 for
bosons and fermions, respectively [68]. Correspondingly

(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:231)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)123456(cid:45)0.100.10.20.30.40.5TJ(cid:87)'a4.34.44.50.0000.0020.0040.0060.006(cid:242)Superfluid(cid:231)MottNormalMottNormalSuperfluid(cid:45)4(cid:45)2024(cid:45)0.5(cid:45)1.(cid:45)1.5(cid:45)2.(cid:45)2.5F'(cid:68)00b(cid:45)log(cid:209)(cid:71)SFT4.345.586.828.06(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)(cid:242)01234500.0080.0160.0240.024TJ∆(cid:83)00Ω0(cid:45)1cﬁrst-order tensors transform like second-quantization op-
erators [69]

Fα(iωn) =

Fα(τ ) =

1
√β
1
√β

(cid:90) β
∞(cid:88)

0

n=−∞

dτ eiωnτ Fα(τ ) ,

(A6)

e−iωnτ Fα(iωn) ,

(A7)

Tr[A] = βN

(cid:88)

µ

which simpliﬁes to Fα(τ ) = Fα and Fα(iωn) =
√βδn,0Fα.

For spatially translation-invariant systems, ﬁrst-order
tensors are position independent, Fα(τ ) = Fri,η(τ ) ≡
Fη(τ ), while second-order tensors are invariant under si-
multaneous translations of the lattice vectors ri and rj
ν(ri − rj, τ − τ(cid:48)) . (A8)
Hence, in momentum space, A is diagonal and given by
the transforms

β (τ − τ(cid:48)) = Ari,η
Aα

rj ,ν(τ − τ(cid:48)) = Aη

Aη

ν(k, τ ) =

Aη

ν(r, τ ) =

e−ik·rAη

ν(r, τ ) ,

(A9)

eik·rAη

ν(k, τ ) ,

(A10)

(cid:88)
(cid:88)

r
1
N

k

where N is the number of lattice sites. Accordingly, ﬁrst-
order tensors only contribute at zero momentum

Fη(k, τ ) = δk,0√N Fη(τ ) ,

(A11)

as they again transform as [69]

Fη(k, τ ) =

Fη(r, τ ) =

e−ik·rFη(r, τ ) ,

(A12)

eik·rFη(k, τ ) .

(A13)

12

where δγ(τ ) is the Nambu kernel δα(τ ) = δri,η(τ ) =
δ(τ − (−1)η0+) enforcing normal ordering (with Nambu
index η = 0, 1). Imposing time- and spatial-translational
invariance in Eq. (B1) yields

(cid:88)
µ(r = 0, τ = (−1)µ0−)
Aµ

eiωn(−1)µ0+

Aµ

=

µ(k, iωn) .

(B2)

µkn

Note that the trace deﬁnition obeys the cyclicity condi-
tions Tr[AB] = Tr[BA] and S = R†AF = Tr[AFR†].

The fact that the Nambu-kernel δ(τ − (−1)η0+) is
necessary to yield normal ordering can be understood
by taking the trace of a Nambu Green’s function G,
given by the time-ordered expectation value Gη
ν(τ ) =
−(cid:104)bη(τ )b†ν(cid:105),
Tr[G] = −β

(cid:88)
(cid:104)bµ((−1)µ0−)b†µ(cid:105) = −2β(cid:104)b†b(cid:105) .

(B3)

µ

Here the factor β comes from the integrals over imagi-
nary time, see Eq. (B1), and the factor of two comes from
the sum over Nambu indices. Thus, the Nambu kernel
δγ(τ − τ(cid:48)) in the imagnary-time trace Tr[·] is normal-
ordering both diagonal Nambu components of G, pro-
ducing the second quantization normal ordered result.
This property is central for obtaining the correct free en-
ergy contribution from the 1
2 Tr ln[−G−1] terms in the
Baym-Kadanoﬀ functional [Eq. (8)], as will be shown in
Appendix C.

1. Reformulation using Matsubara asymptotic form

(cid:88)
(cid:88)

r

k

1
√N
1
√N
(cid:88)
(cid:88)

µ

(cid:90)(cid:90) β

(cid:88)

γ

0

(cid:88)

µk,n

Thus, in momentum- and Matsubara frequency-space the
product relations [Eqs. (A1), (A2) and (A3)] simplify to

One possible route for the numerical evaluation of the
trace is to compute the sum over Matsubara frequencies
in Eq. (B2)

Cη

ν(k, iωn) =

Rη =

Aη

(cid:88)

µ

S = βN

Aη

µ(k, iωn)Bµ

ν (k, iωn) ,

µ(k = 0, iω0)Fµ ,

(A14)

(A15)

R†ηAη

ν(k = 0, iω0)Fν .

(A16)

ην

Appendix B: Imaginary time tensor traces

Also the trace of a second-order tensor appears in the
Baym-Kadanoﬀ eﬀective action and can be deﬁned as the
trace over super-indices and a double integral in imagi-
nary time

Tr[A] =

eiωn(−1)µ0+

Aµ

µ(k, iωn) .

(B4)

However, in general, second-order tensors decay slowly
with respect to |ωn|, with the asymptotic behavior Aµ
µ ∼
(iωn)−1 whenever A has a discontinuity at τ = 0. For
a Green’s function G = −(cid:104)b(τ )b†(cid:105) this is generated by
the time-ordering operator T in the expectation value
(cid:104)·(cid:105) = Z−1Tr[T e−S·] and the (equal time) commutation
relation [b, b†] = σz.
To improve the convergence properties of the Mat-
subara frequency sum we introduce A, the N th or-
der high-frequency expansion of A(iωn) = A(iωn) +
O([iωn]−(N +1)) given by

Tr[A] =

dτ dτ(cid:48) δγ(τ − τ(cid:48))Aγ

γ(τ, τ(cid:48)) ,

(B1)

A(iωn) =

apQp(iωn) ,

(B5)

N(cid:88)

p=1

where ap are the high-frequency expansion coeﬃcients of
A and Qp(iωn) are the high frequency basis functions

(cid:26) (iωn)−p, ωn (cid:54)= 0

ωn = 0

0,

Qp(iωn) =

,

(B6)

with the zeroth frequency mode removed.

(cid:88)

(cid:16)(cid:88)

Given A the trace of A can be written as
[A(k, iωn) − A(k, iωn)]µ
Tr[A] =

µ

µk

n

+ βAµ

µ(k, τ = (−1)µ0−)

(cid:17)

,

(B7)

where the summand in Matsubara frequency sum on the
µ ∼ (iωn)−N . Hence,
ﬁrst row now decays as [A − A]µ
the regularizing exponent factor exp(iωn(−1)µ0+) is no
longer needed. The improved decay in the sum comes at
the price of having to evaluate A in imaginary time

[ap(k)]µ

µ(k, τ = (−1)µ0−) =
Aµ

µQp(τ = (−1)µ0−) ,
(B8)
which can be done analytically using the imaginary time
form of Qp derived in Appendix B 2, see Eq. (B17).

p=1

The asymptotic form can be used for constructing nu-
merical approximants and to derive alternate analytic
formulas for the trace. For the latter, only the ﬁrst-order
term of the expansion is needed. Given A(k, iωn) and
the ﬁrst expansion coeﬃcient a1(k), Eq. (B7) gives

N(cid:88)

µk

Aµ

µ(k, iωn) +

(cid:16)(cid:88)
(cid:88)
n A(k, iωn) = a1(k)(cid:80)

n

β
2

is zero, (cid:80)

where we have used that the Matsubara sum over the
asymptotic form including only the ﬁrst order term
n Q1(iωn) = 0, and
µ Q1(τ =

that a1(k) is diagonal, which gives [a1(k)]µ
(−1)µ0−) = [a1(k)σz/2]µ
To numerically calculate tensor traces given A(iωn) at
a ﬁnite number Nω of Matsubara frequencies and N high-
frequency expansion coeﬃcients ap, the trace is readily
approximated as the ﬁnite frequency sum

µ, see Eq. (B17).

Tr[A] =

[a1(k)σz]µ
µ

,

(B9)

(cid:17)

Tr[A] ≈

(cid:88)

µk

+

Aµ

(cid:32)
Nω(cid:88)(cid:48)
N(cid:88)

p=1

n=−Nω

+ β

µ(k, iω0)

(cid:20)
(cid:2)ap(k)(cid:3)µ

N(cid:88)

(cid:21)µ
(cid:33)
µQp(τ = (−1)µ0−)

ap(k)
(iωn)p

A(k, iωn) −

p=1

µ

,

(B10)

which converges asymptotically as ∼ 1/N N +1
and where
the primed sum excludes the zeroth term (n = 0). For
the SFA3 calculations presented here we use second order
tail corrections (N = 2) see Appendix C.

ω

2. High-frequency basis functions in imaginary

time

13

The imaginary time form of the high-frequency basis
functions Qp in Eq. (B6) is given by the Fourier transform
[Eq. (A5)]

∞(cid:88)(cid:48)

n=−∞

Qp(τ ) =

1
β

e−iωnτ
(iωn)p =

∞(cid:88)(cid:48)

n=−∞

(cid:20) e(β−τ )z

zp

Res

f (z), iωn

,

(cid:21)

where the summand has been rewritten as a residue and
f (z) is the distribution function f (z) = (eβz − ξ)−1. The
(cid:21)
(cid:73)
sum of residues is related to the contour integral

(cid:20) ξe(β−τ )z

∞(cid:88)

ξe(β−τ )z

f (z) =

Res

f (z), iωn

,

0 =

C

dz
2πi

zp

whence Qp is given by the n = 0 term

n=−∞

(cid:20) e(β−τ )z

zp

(cid:21)

Qp(τ ) = −Res

zp

f (z), 0

.

(B11)

To evaluate the residue, bosons and fermions must be
separated, as f (z) contains a simple pole in the Bosonic
case. For Fermions (with ξ = −1) Eq. (B11) becomes

(cid:18) d

(cid:19)p−1

e(β−τ )zf (z)

,

(B12)

Qp(τ ) = −

1

(p − 1)!

dz

(cid:12)(cid:12)(cid:12)(cid:12)z→0

whose ﬁrst orders are Q1(τ ) = −1/2, Q2(τ ) = (2τ−β)/4,
and Q3(τ ) = τ (β − τ )/4 for τ ∈ (0, β]. While on τ ∈
[−β, β] the functions are anti-periodic, and the ﬁrst order
is a step function, see the upper panel in Fig. 6. For
bosons one obtains

(cid:18) d

(cid:19)p

dz

Qp(τ ) = −

1
p!

ze(β−τ )zf (z)

,

(B13)

(cid:12)(cid:12)(cid:12)(cid:12)z→0

yielding the ﬁrst order terms

Q1(τ ) = (−β + 2τ )/(2β) ,
Q2(τ ) = (−β2 + 6βτ − 6τ 2)/(12β) ,
Q3(τ ) = τ (β2 − 3βτ + 2τ 2)/(12β) .

(B14)

(B15)

(B16)

The bosonic functions are periodic on τ ∈ [−β, β] and
the ﬁrst order term is a saw-tooth function, see lower
panel in Fig. 6. From the bosonic basis functions Qp(τ )
we readily obtain the zero-time limits

Q1(τ = (−1)η0−) = (−1)η/2 ,
Q2(τ = (−1)η0−) = −β/12 ,
Q3(τ = (−1)η0−) = 0 ,

(B17)

which are used in the Matsubara sum asymptotic expan-
sion in Eqs. (B7), (B8), and (B10).

14

To get rid of the exponential convergence factor we use
the high-frequency expansion of the logarithm

ln[(σziωn)G(k, iωn)] =

σzc2(k)

iωn

+

σzc3 − (σzc2)2/2

(iωn)2

+ O([iωn]−3) ,

(C4)

where c1 = σz, c2 and c3 are the three ﬁrst coeﬃcients
in the high-frequency expansion of G [Eq. (B5)].

Using the ﬁrst order correction and Eq. (B9) therefore

yields Λ[G] as

βΛ[G] = −

ln[−G(k, iω0)/β]

(cid:88)

(cid:16)

µk

1
2

(cid:88)(cid:48)

n

(cid:17)µ

µ

β
2

.

(C5)

FIG. 6. (Color online) High-frequency basis functions Qp(τ )
for Fermions (upper panel) and Bosons (lower panel).

+

ln[(σziωn)G(k, iωn)] + c2(k)

Appendix C: Matsubara trace logarithm

Apart from direct traces of second order tensors the
Baym-Kadanoﬀ functional in Eq. (8) also contains the
term Tr ln[−G−1], i.e., the trace of the functional loga-
rithm of the interacting Green’s function.
In the non-
interacting limit only this term remains and yields the
free energy up to an inﬁnite regularization factor.

To derive a closed formula for the trace log and the reg-
ularization factor reproducing the non-interacting limit
we introduce the trace log functional Λ[G],

1
2

βΛ[G] =

Tr ln[−G−1] − C∞ ,
where C∞ is an inﬁnite constant, C∞ = 1
2 Tr ln[−R−1],
deﬁned in terms of the regularizing second-order tensor

(C1)

 −β1, ωn = 0

, ωn (cid:54)= 0

σz
iωn

R(iωn) =

.

(C2)

As we will see (Eq. (C8)), this deﬁnition of C∞ imposes
that the trace log functional Λ[G] correctly yields the
free energy in the non-interacting case. Since C∞ is con-
stant it will have no eﬀect on the variations of the SFT
functional.

Using Eq. (B2) to write the logarithm trace in

momentum- and Matsubara-frequency-space gives

eiωn(−1)µ0+(cid:16)

(cid:88)
(cid:16)

µkn

1
2

(cid:88)

µk

βΛ[G] = −

1
2

= −

(cid:88)(cid:48)

n

(cid:17)µ

µ

ln[−G(k, iω0)/β] +

eiωn(−1)µ0+

× ln[(σziωn)G(k, iωn)]

.

(C3)

To show that the trace log functional βΛ[G] is correctly
regularized as to reproduce the non-interacting limit we
consider the free Green’s function G0(iωn) = [σziωn −
1k]−1, and its high-frequency expansion

G0(iωn) =

σz
iωn

+

1k
(iωn)2 + O([iωn]−3) .

(C6)

Hence, G0 yields c2(k) = 1k and G0(k, iω0) = −1/k
which inserted in Eq. (C5) gives

(cid:16)
(cid:89)(cid:48)

(cid:88)

k
βk

2

e
βk

(cid:34)

iωn

n

iωn − k

(cid:88)(cid:48)
(cid:35)

n

ln

(cid:20)
(cid:88)

k

=

(cid:21)

(cid:17)

iωn

+

βk
2

iωn − k
ln(1 − e−βk ) ,

(C7)

βΛ[G] = −

− ln[βk] +

iωn

where in the last step we have used the relation
iωn− = [2 sinh(β/2)]−1, see e.g. Ref. [70].
Thus, for a free Green’s function G0 the regularized
trace log functional Λ[G0] is equal to the non-interacting
bosonic free energy Ω0 [66]

ln

= −

(cid:88)
(β)−1(cid:81)(cid:48)n

k

βΛ[G0] =

ln(1 − e−βk ) = βΩ0 ,

(C8)

(cid:88)

k

(cid:17)µ

µ

conﬁrming the ansatz in Eq. (C2) for the regularizing
tensor R. An intuitive understanding of R can be ob-
tained by rewriting βΛ[G] in Eq. (C1) using functional
determinants

(cid:35)

(cid:34)

(cid:34)

det√−G−1
det√−R−1

(cid:35)

.

det√−G−1
β−1 det(cid:48) √σz∂τ

I.e., the regularization det√−R−1 corresponds to the
det√−R−1 = β−1 det(cid:48) √σz∂τ , where the primed deter-

functional determinant of the free inverse propagator,

minant indicates removal of all nullspace-eigenmodes of
the argument.

ln[R−1(iωn)G(k, iωn)]

βΛ[G] = ln

= ln

1.00.50.00.51.0τ/β0.60.40.20.00.20.40.6Qp(τ)Fermions, ξ=−11.00.50.00.51.0τ/β0.60.40.20.00.20.40.6Qp(τ)Bosons, ξ=1p=1p=2p=3peatedly using the closure relation 1 =(cid:80)

then determine the partition function Z,
e−βEn ,

] =

(cid:48)

Z = Tr[e−βH

(cid:88)

n

n |n(cid:105)(cid:104)n| one can

15

(D1)

the reference system free energy Ω(cid:48) = − ln[Z]/β, static
expectation values such as

Φ(cid:48) = (cid:104)b(cid:105) =

1
Z

Tr[e−βH

(cid:48)

b] =

1
Z

e−βEn(cid:104)n|b|n(cid:105) , (D2)

and the full single particle Green’s function ˜G(cid:48),

(cid:88)

n

˜G(cid:48)η
ν (τ ) = −(cid:104)bη(τ )b†ν(cid:105) = −
= −

(cid:88)

nm

1
Z

1
Z

e−βEn+τ (En−Em)(cid:104)n|bη|m(cid:105)(cid:104)m|b†ν|n(cid:105) .

(D3)

Tr[e−βH

(cid:48)

(cid:48)

eτ H

bηe−τ H

(cid:48)

b†ν]

In the last equation, the time dependent operators
are deﬁned in the Heisenberg representation b(τ ) =
. Given ˜G(cid:48) and Φ(cid:48) the connected Green’s
eτ H
function G(cid:48), deﬁned in Eq. (7), is obtained as

be−τ H

(cid:48)

(cid:48)

G(cid:48)(τ ) = ˜G(cid:48)(τ ) + Φ(cid:48)Φ(cid:48)† .

(D4)

To solve the Dyson equations [Eqs. (16) and (17)]
we use the Matsubara frequency representation of the
Green’s functions. Transforming the τ dependence in
Eq. (D3) then gives

(cid:90) β

0

− e

(cid:88)

nm
1
Z

and the full Matsubara frequency Green’s function can
be expressed by the generalized Lehmann [66] expression

˜G(cid:48)η

ν (iωn) =

1
Z

(cid:104)n|bη|m(cid:105)(cid:104)m|b†ν|n(cid:105)
(cid:88)
iωn + En − Em

(e−βEn−ξe−βEm )

− βδωn,0

n

e−βEn(cid:104)n|bη|n(cid:105)(cid:104)n|b†ν|n(cid:105) ,

(D6)

where we have assumed no accidental degeneracies En (cid:54)=
Em, ∀ m (cid:54)= n, in the last zero-frequency term. Note that
the connected Green’s function G(cid:48)(iωn) has an additional
zero-frequency contribution, as seen in Eq. (D4), which
becomes

G(cid:48)(iωn) = ˜G(cid:48)(iωn) + βδωn,0Φ(cid:48)Φ(cid:48)†

(D7)

in Matsubara frequency space.

Apart from Φ(cid:48) and G(cid:48) the evaluation of the SFT func-
tional [Eq. (31)] also requires the non-interacting Green’s
function G(cid:48)0 and self-energies Σ(cid:48)1/2 and Σ of the reference

where q2 is the second-order coeﬃcient in Eq. (C4),
q2 = σzc3 − (σzc2)2/2. Equation (C9) converges cubi-
cally with N−3
ω , such that for the lattice Green’s function
trace log in both the normal and super-ﬂuid phase at the
parameters used in Fig. 4 we reach a precision of 10−9
with Nω = 103 and 104 respectively, see Fig. 7.

e−βEn

(cid:40)

=

dτ eτ (iωn+En−Em)
−βEn−ξe
−βEm
iωn+En−Em
βe−βEn ,

, iωn + En − Em (cid:54)= 0
iωn + En − Em = 0

,

(D5)

FIG. 7.
(Color online) Convergence of the lattice Green’s
function trace log Λ[G, Nω] in Nω at U = 20 and µ/U = 0.4
(with baseline ¯Λ = Λ[G, Nω] with Nω = 5 · 104) for both the
superﬂuid at T /J = 1 (blue squares) and the normal phase
at T /J = 10 (green circles), for reference N−3
is also shown
(black line).

ω

In the SFT calculations presented here we use a sec-
ond order high-frequency expansion and a ﬁnite number
Nω of Matsubara frequencies [Eq. (B10)] which from Eq.
(C5) gives the trace log functional Λ[G] as

(cid:16)

1
2

(cid:88)
(cid:2) ln[(σziωn)G(k, iωn)] −

ln[−G(k, iω0)/β]+

µk

β
2

c2(k)−

β2
12

q2(k)

(cid:3)(cid:17)µ

µ

q2(k)
(iωn)2

,

(C9)

βΛ[G] ≈ −

Nω(cid:88)(cid:48)

+

n=−Nω

Appendix D: Reference system

To compute properties of the reference system with
the Hamiltonian H(cid:48)
in Eq. (45) we use the occupa-
tion number states |ψn(cid:105) of the single bosonic state,
where n ≥ 0. Annihilating and creating a boson yields
b|ψn(cid:105) = √n|ψn−1(cid:105) and b†|ψn(cid:105) = √n + 1|ψn+1(cid:105), respec-
tively. In this basis we generate matrix representations of
H(cid:48) and the bosonic second quantization operators b and
b†. However, as the occupation number n of a bosonic
state is not bound from above we introduce an occupation
number cut-oﬀ Nmax, as to obtain a ﬁnite matrix rep-
resentation, and disregard all occupation number states
|ψn(cid:105) with n > Nmax. All reference system calculations
thus have to be converged in Nmax. For the calculations
presented here we ﬁnd that 10 - 20 states suﬃce.

To calculate static observables and dynamic response
functions we ﬁrst diagonalize H(cid:48) to determine its eigen-
values En and eigenstates |n(cid:105), where H(cid:48)|n(cid:105) = En|n(cid:105). Re-

101102103104Nω10-1110-1010-910-810-710-610-510-410-310-210-1|(Λ[G,Nω]−¯Λ)/¯Λ|T=1T=10N−3ωsystem. Setting the interaction U to zero in the reference
system Hamiltonian in Eq. (45), G(cid:48)0 is obtained as

Finally the interaction energy can be obtained from the
trace of the Green’s function and self-energy [66]

16

G(cid:48)−1

0

(iωn) = σziωn + 1µ − ∆ ,

(D8)

and the self-energies are determined by Dyson’s equa-
tions [Eq. (16) and (17)]

Σ(cid:48)1/2 = F(cid:48) − G(cid:48)−1

0

(iω0)Φ(cid:48) ,

Σ(cid:48)(iωn) = G(cid:48)−1

0

(iωn) − G−1(iωn) .

(D9)

(D10)

Appendix E: Lattice system

To compute the response functions of the Bose-
Hubbard model deﬁned in Eq. (44) at the self-energies
Σ(cid:48)1/2 and Σ(cid:48) of the reference system we transform to
momentum space. The nearest neighbor single particle
hopping in Eq. (44) gives the dispersion

d(cid:88)

i=1

k = −2J

cos(ki) ,

(E1)

where d is the dimension of the hypercubic lattice (d = 2,
3). Thus the free lattice Green’s function can be written
in Nambu form as

G−1

0 (k, iωn) = σziωn + 1(µ − k) ,

(E2)

and using the Dyson equation [Eq. (17)] the interacting
lattice Green’s function evaluated at the reference system
self-energy Σ(cid:48) is given by

G−1(k, iωn) = G−1

0 (k, iωn) − Σ(cid:48)(iωn) .

(E3)

Further, by using Σ(cid:48)1/2 we can determine the condensate
of the lattice system by

Φ = −G0(k = 0, iω0)Σ(cid:48)1/2 ,

(E4)

where we have used the fact that there is no symmetry-
breaking ﬁeld on the lattice system, F = 0. From the
connected lattice Green’s function Gk and the one-point
propagator Φ we can compute a number of observables
for the lattice system. The momentum space single-
particle density matrix ρk of non-condensed bosons is
given by the trace of G at ﬁxed momentum k

ρk = (cid:104)ˆnk(cid:105) =

1
2β

(cid:88)

Tr[−G(k)]
1
2β

µn

= −

eiωn(−1)µ0+

Gµ

µ(k, iωn) ,

(E5)

while the condensate density ρc is given by the one-point
2 Φ†Φ and the total density n and the
propagator ρc = 1
kinetic energy Ekin is obtained by integrating k over the
Brillouin zone,

n = Tr[ρk] + ρc ,

Ekin = Tr[kρk] + k=0ρc .

(E6)
(E7)

Eint = −

1
4β

Tr[Σ(cid:48)G] .

(E8)

Appendix F: High frequency tail expansions

To evaluate the self-energy functional to high precision
we use tail-corrected Matsubara traces as described in
Appendix B. This procedure requires the high-frequency
tail coeﬃcients of all Green’s functions and self-energies.
The details on how to obtain these coeﬃcients for the
reference system and the lattice system are detailed in
this Appendix.

1. Hamiltonian reference system

For a reference system which is given by a ﬁnite-
dimensional Hamiltonian the expansion can be calculated
exactly. Formally, the high frequency tail of a Matsub-
ara Green’s function, i.e. the 1/(iωn)k expansion, can be
obtained from the imaginary-time Green’s function by
partial integration of the Fourier transform expression

(cid:90) β

0

∞(cid:88)

k=0

=

G(iωn) =

dτ G(τ )eiωnτ

(−1)k ξ∂k

τ G(β−) − ∂k
(iωn)k+1

τ G(0+)

∞(cid:88)

k=0

=

ck+1

(iωn)k+1 ,

(F1)

where the ck are the high-frequency tail expansion coef-
ﬁcients. Derivatives of the Green’s function can be ob-
tained directly from the imaginary-time expression

G(τ ) = −(cid:104)b(τ )b†(0)(cid:105) = −

Tr[e−βH eτ H be−τ H b†] ,

(F2)
or, equivalently, from the equation of motion of the op-
erator b(τ ), ∂τ b(τ ) = [H, b(τ )]. The ﬁrst and kth order
derivatives take the form

1
Z

∂τ G(τ ) = −(cid:104)[H, b(τ )], b†(cid:105) ,
τ G(τ ) = −(cid:104)[[H, b(τ )]](k), b†(cid:105) ,
∂k

(F3)

where [[H, b(τ )]](k) = [H, ...[H, [H, b(τ )]] is the kth order
left side commutator of H with b(τ ). For the speciﬁc
imaginary times τ = 0+ and β− the time ordering can
be made explicit yielding the static expectation values

τ G(0+) = −(cid:104)[[H, b]](k)b†(cid:105) ,
∂k
τ G(β−) = −(cid:104)b†[[H, b]](k)(cid:105) .
∂k

(F4)

Combining these two relations the coeﬃcients ck of the
high-frequency tail expansion can be written in terms of

the static expectation value

17

ck+1 = (−1)k[ξ∂k

τ G(0+)]

τ G(β−) − ∂k
= (−1)k+1(cid:104)[ [[H, b]](k), b†]−ξ(cid:105) .

(F5)

2. Lattice system

Consider the free Nambu Green’s function G−1

0 (z) =
σzz−1h (with z = iωn, for brevity). Inversion and Taylor
expansion gives

(cid:35)−1

(cid:34) ∞(cid:88)

(cid:18) σzh

(cid:19)p(cid:35)

G0(z) =

σzh

z

σz
z

=

σz
z

z

p=0

σzhσzhσz

σzhσz
z2 +

high frequency expansion G(z) = (cid:80)∞p=1

Similarly, for a general Nambu Green’s function G with
cp
zp , the inverse

z3

+ O(z−4) .

(F6)

(cid:34)

1 −
σz
z

=

+

(cid:1)

is given by

(cid:34)

G−1(z) =

1 + σzz

(cid:35)−1

σzz

∞(cid:88)

p=2
1
z

cp
zp

(cid:0)

(cid:1)

(cid:0)

+

1
z2

−σzc3σz + (σzc2)2σz

= σzz − σzc2σz +
−σzc4σz + σzc2σzc3σz + σzc3σzc2σz − (σzc2)3σz
(F7)

+ O(z−3) ,

frequency expansion of the self energy, Σ(z) =(cid:80)∞p=0

where we have used the fact that c1 = σz. Combin-
ing these relations allows us to write down the high-
sp
zp ,
in terms of the high-frequency expansion coeﬃcients cp
of the Green’s function

Σ(z) = G−1

(cid:32)
0 (z) − G−1(z)
= −h −

(cid:34) ∞(cid:88)
(cid:0)

q=1

1
z

−σzz

∞(cid:88)

p=2

cp
zp

(cid:33)q(cid:35)
(cid:1) + O(z−2) .

σzz

= −h + σzc2σz −

−σzc3σz + [σzc2]2σz

(F8)

Hence, the lattice Green’s function G(k, z) with a mo-
mentum independent self energy Σ, G−1(k, z) = σzz −
Ek − Σ(z), has the tail expansion

G(k, z) =

+

1
z3

+

σz
z

σz(Ek + s0)σz

(cid:0)σzs1σz + [σz(Ek + s0)]2σz

z2

(cid:1) + O(z−4) ,

(F9)

where Ek = 1(k − µ).

FIG. 8. (Color online) Superﬂuid order parameter (cid:104)b(cid:105) from
SFA3 (red line), B-DMFT (circles), and QMC (diamonds) [36]
(upper panel) and SFA3 variational parameters ∆00, ∆01 and
F (lower panel) as a function of temperature T in the vicinity
of the superﬂuid to normal phase transition for the 3d cubic
lattice with U/J = 20 and µ/U = 0.4, cf. Fig. 4. The location
of the B-DMFT and QMC phase transitions are indicated (left
and right vertical dotted line respectively). The QMC data
were computed for a ﬁnite size system with 403 sites, leading
to a crossover, while the phase transition line is calculated
with ﬁnite-size scaling.

Appendix G: SFA3 stationary points

and order of the superﬂuid phase transition

In our SFA3 calculations on the Bose-Hubbard model
we ﬁnd several symmetry breaking stationary points with
F (cid:48)
(cid:54)= 0. Most solutions can be discarded by requiring
that the single-particle Green’s function should fulﬁll the
physical constraints G00(k, iω0) < 0 and det G(k, iω0) >
0 at the zeroth Matsubara frequency ω0 = 0.

After discarding unphysical stationary points we still
ﬁnd two symmetry broken solutions in the deep super-
ﬂuid phase. This occurs for temperatures T /J < 3.7 for
U/J = 20 and µ/J = 0.4. The two solutions are dis-
tinguished by the relative phases of the linear symmetry
breaking ﬁeld F (cid:48) and the anomalous pairing ﬁeld ∆01
variational parameters. One solution has the ﬁelds in-
phase, arg ∆01 = arg F (cid:48), and the other solution has the
ﬁelds in anti-phase, arg ∆01 = arg F (cid:48) + π, see thin and
thick lines respectively for T < 3.7 in the lower panel of
Fig. 8.

The anti-phase solution disappears through a saddle-
node bifurcation [71] with one of the unphysical station-
ary points at T /J ≈ 3.7, while the in-phase solution pre-

3.54.04.55.0T0.00.10.20.30.40.50.60.7›bﬁSFA3B-DMFTQMC3.54.04.55.0T43210∆00,∆01,F0∆00∆01F0vails up to the normal-phase to superﬂuid phase transi-
tion temperature at Tc ≈ 4.39778. However, when com-
paring free energies it turns out that the anti-phase so-
lution, when present, has the lowest free energy. Thus
within SFA3 when increasing temperature the system
jumps from the anti-phase (deep superﬂuid) to the in-
phase (weak) superﬂuid solution at T ≈ 3.7. The jump
between stationary points causes weak discontinuities in
observables, e.g., the superﬂuid order parameter φ = (cid:104)b(cid:105),
see the upper panel of Fig. 8.
The appearance of this spurious “phase-transition” in
the SFA3 calculations might at ﬁrst be considered a de-
ﬁciency of the SFT scheme. However, rather than a gen-
eral SFT issue it is the extremely simplistic SFA3 varia-
tional ansatz, with only three parameters that causes this
behavior. In SFA3 the retarded hybridization is reduced
to an instantaneous pairing ﬁeld ∆01(τ ) = δ(τ )∆01. This
one parameter degree-of-freedom is simply not enough to
interpolate between the two regimes and instead gener-
ates a discontinuity. As the SFA3 reference system is
extended with additional bath sites the SFT calculation
is expected to become continuous within the superﬂuid
phase, as is the case for BDMFT.

The upper panel of Fig. 8 also shows the detailed
behavior of the order parameter φ = (cid:104)b(cid:105) around the
normal-phase to superﬂuid phase transition for SFA3,
BDMFT, and QMC. The superﬂuid critical temperature
within SFA3 is in quantitative agreement with BDMFT
and QMC. The phase transition, however, is weakly ﬁrst
order with an accompanying narrow hysteresis region.
The thermodynamical ground state solution is accompa-
nied by an unstable superﬂuid solution that disappears
through a saddle-node bifurcation with another station-
ary point (higher in free energy) that adiabatically con-
nects the superﬂuid to the normal-phase solution (dotted
red line). The phase transition within SFA3 is located be-
tween the BDMFT and QMC results (horizontal dotted
lines), and is expected to shift to the BDMFT result as
bath sites are added to the SFT reference system.

The existence of three solutions within a hysteresis re-
gion is a general feature of ﬁrst order transitions, not lim-
ited to SFA3. It has also been observed e.g. in DMFT for
the paramagnetic Mott to metal transition in the single-
band Fermionic-Hubbard model [72], and for Gutzwiller
variational calculations on two-band generalized Fermi-
Hubbard models [73].

Appendix H: Comparison with Ref. 25

As discussed in the main text self-energy functional
theory has already been applied to bosons including U (1)
symmetry breaking in Ref. 25. In this appendix we show
how the self-energy functional ΓSE [Eq. (26)] derived in
Section II C diﬀers from the result in Ref. 25.

The self-energy functional ˜ΓSE of Ref. 25 is built around

18

FIG. 9. (Color online) Condensate order-parameter (cid:104)b(cid:105) of the
2d lattice as a function of chemical potential µ for β = 6.4 and
U = 20. Both results using the SFT formalism presented here
(blue dash-dotted line) and the formalism of Ref. 25 (solid red
line) are shown. Inset: Logarithmic vertical axis with original
data from Ref. 25 (red markers).

the Dyson equation ansatz

G−1Φ = F − D ,
G−1 = G−1
0 − Σ ,

(H1)

(H2)

where the ﬁrst-order tensor quantity D corresponds to
a “self-energy like” object for the one-point propagator
Φ. This ansatz diﬀers from the one-point propagator
Dyson equation, G−1
0 Φ = F − Σ1/2 [Eq. (16)] obtained
from the stationarity of the Baym-Kadanoﬀ functional
ΓBK in Eq. (8). The diﬀerence being the appearance of
the interacting propagator G in Eq. (H1) instead of the
non-interacting propagator G0.

Using the Dyson equation ansatz in Eqs. (H1) and (H2)
the authors of Ref. 25 derive the self-energy eﬀective ac-
tion

˜ΓSE[D, Σ] =

1
2

+

(F − D)†(G−1
1
Tr ln[−(G−1
2

0 − Σ)−1(F − D)
0 − Σ)] + ˜F[D, Σ] ,

(H3)

through a series of transforms of the free energy Ω, where
the functional ˜F ≡ ˜F[D, Σ] is assumed to be a universal
functional in D and Σ with variations δD ˜F = Φ and

0.00.10.20.30.40.50.60.70.8µ/U0.00.20.40.60.81.01.2›bﬁSFA Σ1/2SFA D0.00.10.20.30.40.50.60.70.8µ/U10-210-1100›bﬁδΣ ˜F = [G−ΦΦ†]/2, such that the stationarity condition
δ ˜ΓSE = 0 reproduces the Dyson equation ansatz of Eqs.
(H1) and (H2)

δ ˜ΓSE
δD
δ ˜ΓSE
δΣ

1
2

= −

= −G(F − D) + Φ = 0 ,
1
2

0 − Σ)−1 +

(G−1

G = 0 .

(H4)

(H5)

We have performed additional calculations employing
the self-energy eﬀective action ˜ΓSE [Eq. (H3)] in the con-
struction of the SFT approximation [Eq. (31)] (here de-
noted by SFA-D) comparing with the SFT results using
the self-energy eﬀective action ΓSE [Eq. (26)] derived in
this work (here denoted by SFA-Σ1/2), see Fig. 9. The
system parameters are chosen to also enable comparison
with numerical results published in Ref. 25 (Fig. 3b.2),
see the inset in Fig. 9. The quantitative agreement in-
dicates that our SFA-D calculations are consistent with

19

Ref. 25.

When sweeping the chemical potential µ through the
unit-ﬁlling Mott-lobe at ﬁnite temperature and study-
ing the superﬂuid order parameter (cid:104)b(cid:105), we ﬁnd that
SFA-Σ1/2 displays a superﬂuid to normal-phase transi-
tion, while SFA-D only yields a crossover (in the range
0.25 < µ/U < 0.52). This is the result of the presence
of a superﬂuid solution (F (cid:48) (cid:54)= 0) with lower free-energy
than the normal solution throughout the entire sweep
in µ.
In SFA-D the free energies of the two solutions
therefore never cross, in contrast to SFA-Σ1/2 (see Fig. 5
a). The good agreement between the two methods deep
in the superﬂuid phase can be understood from the fact
that in this limit G ≈ G0, and therefore Eq. (H1) is
essentially equivalent to our symmetry-breaking Dyson
equation (16). However, the absence of a ﬁnite temper-
ature superﬂuid to normal-phase transition in SFA-D is
unphysical.

∗ hugo.strand@unifr.ch
[1] J. C. Wheatley, Rev. Mod. Phys. 47, 415 (1975).
[2] P. W. Anderson, Rev. Mod. Phys. 38, 298 (1966).
[3] O. Morsch and M. Oberthaler, Rev. Mod. Phys. 78, 179

(2006).

[19] M. Potthoﬀ, Cond. Mat. Phys. 9, 557 (2006).
[20] A. Avella and F. Mancini, eds., Strongly Correlated Sys-
tems Theoretical Methods, Springer Series in Solid-State
Sciences, Vol. 171 (Springer, 2012).

[21] A. Georges, G. Kotliar, W. Krauth, and M. J. Rozen-

[4] I. Bloch, J. Dalibard, and W. Zwerger, Rev. Mod. Phys.

berg, Rev. Mod. Phys. 68, 13 (1996).

80, 885 (2008).

[5] M. P. A. Fisher, P. B. Weichman, G. Grinstein, and D. S.

Fisher, Phys. Rev. B 40, 546 (1989).

[22] G. Kotliar, S. Y. Savrasov, K. Haule, V. S. Oudovenko,
O. Parcollet, and C. A. Marianetti, Rev. Mod. Phys. 78,
865 (2006).

[6] D. Jaksch, C. Bruder, J. I. Cirac, C. W. Gardiner, and

[23] M. Potthoﬀ, M. Aichhorn, and C. Dahnken, Phys. Rev.

P. Zoller, Phys. Rev. Lett. 81, 3108 (1998).

Lett. 91, 206402 (2003).

[7] L. Pollet, Rep. Prog. Phys. 75, 094501 (2012).
[8] J. Struck, C. ¨Olschl¨ager, M. Weinberg, P. Hauke, J. Si-
monet, A. Eckardt, M. Lewenstein, K. Sengstock, and
P. Windpassinger, Phys. Rev. Lett. 108, 225304 (2012).
[9] S. Greschner, G. Sun, D. Poletti, and L. Santos, Phys.

Rev. Lett. 113, 215303 (2014).

[24] M. Potthoﬀ and M. Balzer, Phys. Rev. B 75, 125112

(2007).

[25] E. Arrigoni, M. Knap, and W. von der Linden, Physical

Review B 84, 014535 (2011).

[26] C. De Dominicis and P. C. Martin, Journal of Mathemat-

ical Physics 5, 14 (1964).

[10] N. Goldman and J. Dalibard, Phys. Rev. X 4, 031027

[27] C. De Dominicis and P. C. Martin, Journal of Mathemat-

(2014).

[11] Y.-J. Lin, K. Jim´enez-Garc´ıa, and I. B. Spielman, Nature

471, 83 (2011).

[12] J. Struck, J. Simonet, and K. Sengstock, Phys. Rev. A

90, 031601 (2014).

[13] K. Jim´enez-Garc´ıa, L. J. LeBlanc, R. A. Williams, M. C.
Beeler, C. Qu, M. Gong, C. Zhang, and I. B. Spielman,
Phys. Rev. Lett. 114, 125301 (2015).

[14] S. Baier, M. J. Mark, D. Petter, K. Aikawa, L. Chomaz,
Z. Cai, M. Baranov, P. Zoller, and F. Ferlaino, ArXiv
e-prints (2015), arXiv:1507.03500 [cond-mat.quant-gas].
[15] J. Zeiher, R. van Bijnen, P. Schauß, S. Hild, J.-y. Choi,
T. Pohl, I. Bloch, and C. Gross, ArXiv e-prints (2016),
arXiv:1602.06313 [cond-mat.quant-gas].

[16] M. Troyer and U.-J. Wiese, Phys. Rev. Lett. 94, 170201

(2005).

[17] M. Potthoﬀ, The European Physical Journal B - Con-

densed Matter and Complex Systems 32, 429 (2003).

[18] M. Potthoﬀ, The European Physical Journal B - Con-

densed Matter and Complex Systems 36, 335 (2003).

ical Physics 5, 31 (1964).

[28] G. Baym and L. P. Kadanoﬀ, Phys. Rev. 124, 287 (1961).
[29] G. Baym, Phys. Rev. 127, 1391 (1962).
[30] J. M. Luttinger and J. C. Ward, Phys. Rev. 118 (1960).
[31] K. Byczuk and D. Vollhardt, Phys. Rev. B 77, 235106

(2008).

[32] A. Hubener, M. Snoek, and W. Hofstetter, Phys. Rev.

B 80, 245109 (2009).

[33] W.-J. Hu and N.-H. Tong, Phys. Rev. B 80, 245110

(2009).

[34] P. Anders, E. Gull, L. Pollet, M. Troyer, and P. Werner,

Phys. Rev. Lett. 105, 096402 (2010).

[35] M. Snoek and W. Hofstetter, ArXiv e-prints

(2010),

arXiv:1007.5223 [cond-mat.quant-gas].

[36] P. Anders, E. Gull, L. Pollet, M. Troyer, and P. Werner,

New J. Phys. 13, 075013 (2011).

[37] S. Sachdev, Quantum Phase Transitions (Cambridge
University Press, The Edinburgh Building, Cambridge
CB2 2RU, UK, 1999).

[38] D. H¨ugel and L. Pollet, Phys. Rev. B 91, 224510 (2015).
[39] B. Capogrosso-Sansone, N. V. Prokof’ev, and B. V. Svis-

20

tunov, Phys. Rev. B 75, 134302 (2007).

[56] M. Knap, E. Arrigoni, and W. von der Linden, Phys.

[40] F. Hofmann, M. Eckstein, E. Arrigoni, and M. Potthoﬀ,

Rev. B 81, 024301 (2010).

Phys. Rev. B 88, 165124 (2013).

[57] M. Knap, E. Arrigoni, and W. von der Linden, Physical

[41] F. Hofmann, M. Eckstein, and M. Potthoﬀ, ArXiv e-

Review B 83, 134507 (2011).

prints (2015), arXiv:1510.05866 [cond-mat.str-el].

[58] D. Huerga, J. Dukelsky, and G. E. Scuseria, Physical

[42] H. Aoki, N. Tsuji, M. Eckstein, M. Kollar, T. Oka, and

Review Letters 111, 045701 (2013).

P. Werner, Rev. Mod. Phys. 86, 779 (2014).

[59] S. Pankov, G. Kotliar, and Y. Motome, Phys. Rev. B

[43] H. U. R. Strand, M. Eckstein, and P. Werner, Phys. Rev.

66, 045117 (2002).

X 5, 011038 (2015).

[60] N. M. Hugenholtz and D. Pines, Phys. Rev. 116, 489

[44] H. Kleinert, Fortschritte der Physik 30, 187 (1982).
[45] J. Berges, S. Bors´anyi, U. Reinosa, and J. Serreau, An-

(1959).

[61] G. Rickayzen, Green’s functions and condensed matter

nals of Physics 320, 344 (2005).

(Academic Press Inc., 1980).

[46] J. M. Cornwall, R. Jackiw, and E. Tomboulis, Phys. Rev.

[62] Here specialized for lattices with cosine-dispersion, e.g.,

D 10, 2428 (1974).

[47] Note that the Luttinger-Ward functional ΦLW for sym-
metry broken bosons with only a four-particle interac-
tion vertex ( ˆV3 = 0, ˆV4 (cid:54)= 0) still acquires an eﬀective
three-particle vertex [44] (ˆν3 = ˆV4Φ).

[48] H. Kleinert and V. Schulte-Frohlinde, Critical properties
of Phi4-Theories (World Scientiﬁc Publishing Co. Pte.
Ltd., 2001).

[49] E. Kozik, M. Ferrero, and A. Georges, Phys. Rev. Lett.

114, 156402 (2015).

[50] A. Stan, P. Romaniello, S. Rigamonti, L. Reining, and
J. A. Berger, New Journal of Physics 17, 093045 (2015).
[51] W. Metzner and D. Vollhardt, Phys. Rev. Lett. 62, 324

(1989).

[52] P. Werner, A. Comanac, L. de’ Medici, M. Troyer, and

A. J. Millis, Phys. Rev. Lett. 97, 076405 (2006).

[53] E. Gull, A. J. Millis, A. I. Lichtenstein, A. N. Rubtsov,
M. Troyer, and P. Werner, Rev. Mod. Phys. 83, 349
(2011).

[54] S. Boyd and L. Vandenberghe, Convex Optimization

(Cambridge University Press, 2004).

hypercubic lattices with nearest-neighbor hopping.

[63] H. U. R. Strand, M. Eckstein, and P. Werner, Phys. Rev.

A 92, 063602 (2015).

[64] T. Ayral and O. Parcollet, Phys. Rev. B 92, 115109

(2015).

[65] A. L. Fetter and J. D. Walecka, Quantum Theory of
Many-Particle Systems (Dover Publications Inc., 2003).
[66] J. W. Negele and H. Orland, Quantum Many-Particle

Systems (Westview Press, 1998).

[67] G. D. Mahan, Many-Particle Physics, 2nd ed. (Plenum

Press, 1990).

[68] T. Matsubara, Prog. Theor. Phys. 14, 351 (1955).
[69] A. Atland and B. Simons, Condensed Matter Field The-

ory (Cambridge University Press, 2006).

[70] H. Kleinert, Path Integrals in Quantum Mechanics,
Statistics, Polymer Physics, and Financial Markets, 5th
ed. (World Scientiﬁc Publishing Co. Pte. Ltd., 2009).

[71] J. D. Crawford, Rev. Mod. Phys. 63, 991 (1991).
[72] H. U. R. Strand, A. Sabashvili, M. Granath, B. Hellsing,

and S. ¨Ostlund, Phys. Rev. B 83, 205136 (2011).

[73] N. Lanat`a, H. U. R. Strand, X. Dai, and B. Hellsing,

[55] The hybrd and hybrj methods of MINPACK as wrapped

Phys. Rev. B 85, 035133 (2012).

in SciPy [74].

[74] E. Jones, T. Oliphant, P. Peterson, et al., “Scipy: Open

source scientiﬁc tools for Python,” (2001–).

