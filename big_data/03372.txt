6
1
0
2

 
r
a

 

M
0
1

 
 
]

Y
S
.
s
c
[
 
 

1
v
2
7
3
3
0

.

3
0
6
1
:
v
i
X
r
a

Output Regulation for Systems on

Matrix Lie-group

Simone de Marco ∗1, Lorenzo Marconi †1, Tarek Hamel‡2 and

Robert Mahony§3

1CASY-DEI, Universit´a di Bologna, Bologna, 40133, Italy

2I3S, University of Nice, Sophia Antipolis, France

3Centre of Excellence in Robotic Vision, Research School of

Engineering, Australian National University, Canberra, Australia

Abstract

This paper deals with the problem of output regulation for
systems deﬁned on matrix Lie-Groups. Reference trajectories
to be tracked are supposed to be generated by an exosystem, de-
ﬁned on the same Lie-Group of the controlled system, and only
partial relative error measurements are supposed to be available.
These measurements are assumed to be invariant and associated
to a group action on a homogeneous space of the state space.
In the spirit of the internal model principle the proposed con-
trol structure embeds a copy of the exosystem kinematic. This
control problem is motivated by many real applications ﬁelds
in aerospace, robotics, projective geometry, to name a few, in
which systems are deﬁned on matrix Lie-groups and references
in the associated homogenous spaces.

1 Introduction

Regulating the output of a system in such a way to achieve asymptotic track-
ing of a reference trajectory is a central topic in control. Among the diﬀerent
approaches proposed so far in the related literature, the output regulation un-
doubtedly plays a central role. The main peculiarity of output regulation is the
fact of considering references to be tracked as belonging to a family of trajec-
tories generated as solutions of an autonomous system (typically referred to as

∗simone.demarco2@unibo.it
†lorenzo.marconi@unibo.it
‡thamel@i3s.unice.fr
§Robert.Mahony@anu.edu.au

exosystem). Tackling this problem in error feedback contexts typically leads
to solutions in which the regulator embeds a copy of the exosystem properly
updated by means of error measurements. The problem has been intensively
studied in the linear context in the mid seventies by Davison, Francis and Won-
ham [8],[7],[6], and then extended to a quite general nonlinear context by Isidori
and Byrnes [10].
In both the linear and nonlinear framework the developed
theory has led to the celebrated internal model principle. Assumptions of the
aforementioned pioneering works were weakened recently [5], [21] thanks to the
observation that the problem of output regulation can be cast as the problem
of nonlinear observers design.
In fact, the many tools available in literature
for designing nonlinear observers, such as high-gain and adaptive nonlinear ob-
servers, have been used in the design of internal model-based regulators by thus
widening the class of systems that can dealt with. It is worth noting, however,
that most of the frameworks considered so far for output regulation deal with
systems and exosytems deﬁned on real state space and not much eﬀorts have
been done to extend the results of output regulation to systems and exosystems
whose states live in more general manifolds.

Regarding control and observation of systems deﬁned in more general man-
ifolds, the synthesis of nonlinear observers for invariant systems on Lie-groups
has recently played an important role. Many physical systems, such as aerial
vehicles, mobile robotic vehicles, robotic manipulators, can be described by ge-
ometric models with symmetries. Symmetric structures reﬂect the fact that the
behavior of a symmetric system in one point in the space is independent from
the choice of a particular set of conﬁguration coordinates. That is, the laws of
motion of a symmetric system are invariant under a change of the conﬁguration
space. Preserving such a symmetry is undoubtedly a key point in the observer
design. Aghannan and Rouchon [1] ﬁrst had pointed out the main role of in-
variance in the observer design for mechanical systems with symmetries. More
recent works, based on the aforementioned paper, take advantage of the symme-
try of left invariant systems on Lie-groups to deﬁne invariant error coordinates
in order to build an invariant observer [2], [3], [9], [23]. Lageman et. al [13],
[14] exploit the invariance properties of the system in order to have autonomous
invariant error dynamics.

This paper presents an attempt to extend the idea of internal model-based
control to systems deﬁned on more general state spaces, precisely systems de-
ﬁned on matrix Lie-Groups. This control problem is motivated by a wide range
of real world applications in which both the controlled system and the exosystem
are modeled on matrix Lie-groups. For example, the attitude control problem
for satellite [4], in which the system and the exosystem are deﬁned on the group
of rigid-body rotations SO(3) or the control [11] of VTOL (Vertical Takeoﬀ and
Landing), whose kinematic equations are described by the group of rigid-body
translation SE(3). The relevance of this control problem is motivated also by
projective geometry problem such as image homographies. This geometry can
be modeled by the special linear group SL(3) [16], [18] and in this context the
control problem is to continuously warp a reference image of a reference scene
in such a way the “controlled” homography matches an image sequence taken

by a moving camera.

In this paper, we consider reference trajectories to be tracked modelled on the
same Lie-group of the controlled system. The exosystem (the reference system)
is assumed to be right invariant while the controlled system is assumed to be left
invariant. We assume that only partial relative error information are available
for measurements. The measurements are assumed to be associated with a left
group action on a homogeneous space of the state space. The paper extends
preliminary results presented in [17] where the problem of output regulation for
systems deﬁned on matrix Lie-Group was tackled under the assumption that
the exosystem has constant velocity. Here we remove the limitations of [17] by
considering a generic exosystem structure. The main result of the paper is to
propose a general structure of the regulator that depends only on relative mea-
sures in homogenous space such that the closed-loop system tracks homogenous
references generated by the exosystem with a certain domain of attraction. This
is achieved by means of a regulator embedding a copy of the exosystem fed by
a non-linear function of the measured output along with a stabilising control
action. Going further, a control design based on back-stepping techniques, in
the special case of systems deﬁned on the special orthogonal group SO(3), is
presented for the fully actuated dynamic model.

The paper has six sections and it’s organised as follow. Section 2 presents
mathematical preliminaries, notation and the problem formulation. Section 3
presents the main result of the paper, a theorem for kinematic systems on matrix
Lie-Groups with invariant relative error measurements and its proof. In Section
4 a stability analysis is provided for the speciﬁc case of systems deﬁned on the
special orthogonal group extending local results of Section 3 to almost global
results. In the same section is also proposed a regulator design, based on back-
stepping techniques, for fully actuated dynamic systems whose kinematic state
space is posed on the Lie-Group of orthogonal rotations SO(3). An illustrative
example with simulations is shown in Section 5.

2 Notation and Problem Formulation

2.1 Notation and basic facts

Let G be a general matrix Lie-group. For X ∈ G, the group inverse element is
denoted by X −1, and I is the identity element of G. Let g be the Lie-algebra
associated to the Lie-group G. For X ∈ G and U ∈ g, the AdX U denotes the
adjoint operator, namely the mapping AdX : G × g → g deﬁned as

AdX U := XU X −1, with X ∈ G, U ∈ g .

Let tr (A) denote the trace operator and note that for any A, B ∈ Rn×n,

tr(cid:0)A⊤B(cid:1) deﬁnes an inner product on Rn×n. For any A ∈ Rn×n and B ∈ Rn×n

tr(cid:0)A⊤B(cid:1) = vec(A)⊤vec(B)

where vec(A) ∈ Rn2
columns of the matrix A as follows

is the column vector obtained by the concatenation of

vec(A) = [a1,1, ..., an,1, a1,2, ..., an,2, ..., a1,n, ..., an,n]⊤.

For all A ∈ Rn×n let P
g(A) denote the orthogonal projection of A onto g with
respect to the trace inner product. For any U ∈ g and any A ∈ Rn×n, one has

tr(cid:0)U ⊤A(cid:1) = tr(cid:0)U ⊤P

g(A)(cid:1) .

We denote by mrp (matrix representation) the mapping mrp : Rn → g that maps
the vector v ∈ Rn in an element of the algebra. Let vrp (vector representation)
denote the inverse of mrp operator, namely

vrp(mrp(v)) = v,
vrp(U ) = Uv,

v ∈ Rn
U ∈ g .

With Ω ∈ R3 we denote by Ω× the matrix representation of Ω in the Lie-algebra
so(3) associated to the Lie-group SO(3). Namely, if Ω = [Ω1, Ω2, Ω3]⊤, then

−Ω3 Ω2
−Ω1

0
Ω3
0
−Ω2 Ω1

0 
 .

Ω× =


Let U ∈ g be an n × n matrix and let Uv ∈ Rk with n2 ≥ k. Then, it is
straightforward to verify that vec(U ) is a linear combination of the vectorial
representation vrp(U ) and there exists a duplication matrix D ∈ Rn2×k such
that

vec(U ) = DUv .

With U ∈ g and V ∈ g elements of the same Lie-algebra one has

where Qg = DT D and D is the duplication matrix deﬁned above.

tr(cid:0)U ⊤V(cid:1) = vrp⊤(U )Qg vrp(V )

2.2 Problem formulation

In this paper we consider the left invariant kinematic system

˙X = XU, X(0) ∈ G

(1)

X ∈ G the state of the system and U ∈ g the control input. We consider a right
invariant exosystem on G of the form

˙Xd = ◦UdXd

◦Ud = mrp(Cw)

˙w = Sw

(2a)

(2b)

(2c)

where Xd ∈ G and ◦Ud ∈ g are n × n matrices, vrp(◦Ud) ∈ Rκ,w ∈ Rm,
C ∈ Rκ×m, and S ∈ Rm×m with m ≥ κ and S = −S⊤. The input w models
exogenus signals that represent velocity references to be tracked. Note that
U ∈ g in (1) is associated to a body-ﬁxed velocity while ◦Ud ∈ g of the exosystem
(2) is associated with an inertial velocity input. Consider a linear left group
action1 of G on Rn, (X, y) 7→ Xy and reference vectors in the form

yi = X −1Xd˚yi,

i = 1, 2, ..., ν

where ˚yi are known constant reference vectors, elements of the homogenous
space associated to the Lie-group X. Let

E = X −1Xd

(3)

denotes the state error of the system as an element of the group G. Let Xr ∈ G
be a constant “reference” element of the group. Xr can be applied to ˚yi to
generate constant reference vectors

Deﬁne an “error vector” ei by

yr
i = Xr˚yi .

ei = yr

i − yi = yr

i − Eryr

i , where Er = EX −1

r

.

(4)

The control problem considered is the design of a feedback control action U as a
function of X and yi, in such a way the error ei converges to zero with a certain
domain of attraction.

To have a physical intuition of those reference and error vectors we address
the speciﬁc case of SE(2). In particular (see Figure 1), we consider two mobile
robots modeled as kinematic systems. The ﬁrst one, the exosystem, is moving
along a certain trajectory while the controlled vehicle measures its relative po-
sition with respect to the exosystem. In this context ˚yi is a known point in the
frame associated to the exosystem mobile robot (for example the coordinate of
˚y1 = [1, 0, 1]⊤) in its own body-ﬁxed frame with an oﬀset given by Xr. The
known vector Xd˚y1 is the inertial representation of ˚y1, while Er˚y1 expresses the
vector ˚y1 in the frame associated to the actual robot. In this context the control
objective is to drive the actual mobile robot with the velocity as control input in
order to track the exosystem (the desired one) in such a way the error yr
1 − Eryr
1
converges to zero with a certain domain of attraction.

The following assumptions will be used in the next sections and they are

instrumental for stability analysis.

Assumption 1. There are suﬃcient independent measurements yi with i =
1, . . . , ν such that

ℓ(E) :=

kek2

i =

1
2

ν

Xi=1

1
2

ν

Xi=1

kyr

i − Eryr

i k2

(5)

1In the paper a linear left group action is considered since it is the natural action for the
Lie-groups SO(n) and SE(n). All results presented, however, hold also for a generic left group
action.

e

x

o

-

s

y
s

tem

s y stem

Figure 1: Reference vectors and error vectors in SE(2).The Inertial reference
frame is represented with dotted lines.

is locally positive deﬁnite in Er ∈ G around the identity matrix Er = I.

Assumption 2. There exist a compact set Wd ⊂ G × g which is invariant for
(2).

3 A General Output Regulation Result

The main goal of this section is to present a general structure of the regulator
that solves the problem of output regulation formulated above.

Theorem 1. Consider system (1) along with exosystem (2). Let the controller
be given by the control law

U = AdX −1 ∆ − kp

∆ = mrp(Cδ)

ν

Xi=1

P(cid:0)ei(yr

i − ei)⊤(cid:1)

˙δ = Sδ + C ⊤ Q vrp(β)

β = −kI

ν

Xi=1

P(X −⊤ei(yr

i − ei)⊤X ⊤)

(6a)

(6b)

(6c)

(6d)

with kp and kI some positive gains.
compact set

If Assumptions 1 and 2 hold then the

S = {(X, δ, (Xd, w)) ∈ G × Rm × Wd :

X −1Xd = Xr, δ = w}

is locally asymptotically stable for the closed-loop system. Furthermore

(X, δ, (Xd, w)) ∈ S ⇒ ei = 0 ∀i = 1, . . . , ν .

(7)

Note that in the speciﬁc case of exosystem constant velocity, namely S =
0, C = I, the control law proposed in (6) is reduced to the PI control action
presented in [17] Theorem 3.1.

Remark 1. Local properties of Theorem 1 can be extended to global ones ex-
ploiting the particular structure of the Lie Group considered. We will show in
the next section that, for the speciﬁc case of systems posed on the special or-
thogonal group SO(3), the control law in (6) achieve almost global stability of
the error system dynamics. In the special orthogonal group of rotation there is
a topological obstruction that deny the possibility to have global results with a
smooth control action [22]. To overcame this topological constraint an hybrid
control law is needed [20].

Proof. It’s straightforward to verify that condition (7) follows from the deﬁnition
of the set S and of ei’s. In what follow we prove that S is locally asymptotically
stable. Consider the following candidate Lyapunov function

keik2

+

˜w⊤ ˜w

(8)

L =

1
2

ν

Xi=1
{z

L1

|

}

1
2kI

|

L2

{z

}

where ˜w = w − δ, which, by assumption, is positive deﬁnite around Er = I.
Taking the derivatives along the solution of (1) and (2) one obtains

The ﬁrst element of the equation above can be written as

˙L = ˙L1 + ˙L2.

˙L1 =

d
dt

1
2

ν

Xi=1

kyr

i − Eryr

i k2 = −

e⊤
i

˙Eryr
i .

ν

Xi=1

(9)

(10)

Bearing in mind the deﬁnition of Er in (3), it turns out that the time derivative
of Er is given by

˙Er =

(X −1XdX −1
r )

d
dt

r + X −1 ˙XdX −1

= (X −1(− ˙X)X −1)XdX −1
= −X −1XU X −1XdX −1
= −(U X −1 − X −1◦UdXX −1)XdX −1
= −(U − AdX −1

◦Ud)Er

r − X −1◦UdXdX −1

r

r

r

and, substituting ˙Er into (10), one obtains

˙L1 =

=

ν

ν

Pi=1
Pi=1

e⊤
i (U − AdX −1

◦Ud)Eryr
i

i (U − AdX −1 ˜∆ − AdX −1 ∆)Eryr
e⊤

i

(11)

(12)

where

˜∆ = ◦Ud − ∆ .

Now let’s focus on the i’th term of (12). It follows

e⊤

i (cid:16)U − AdX −1 ˜∆ − AdX −1 ∆(cid:17) Eryr
= tr(cid:16)(U − AdX −1 ∆)⊤
P(cid:16)(cid:0)Eryr

i = tr(cid:16)e⊤
i (cid:1)⊤(cid:17)(cid:17)−tr(cid:16) ˜∆⊤P(cid:16)X −⊤(cid:0)Eryr

i(cid:17)
i (cid:16)U − AdX −1 ˜∆ − AdX −1 ∆(cid:17) Eryr
X ⊤(cid:17)(cid:17)

i (cid:1)⊤

where in the last equation above it has been introduced the projection P asso-
ciated with the Lie-algebra. Recalling ˙L1 one has

i e⊤

i e⊤

˙L1 =

ν

Xi=1

tr(cid:16)(U − AdX −1 ∆)⊤

i e⊤

i (cid:1)⊤(cid:17)(cid:17)

P(cid:16)(cid:0)Eryr
Xi=1

−

ν

tr(cid:16) ˜∆⊤P(cid:16)X −⊤(cid:0)Eryr

i e⊤

i (cid:1)⊤

X ⊤(cid:17)(cid:17) .

(13)

The second term of (9) can be written as

˙L2 =

1
kI

˜w⊤ ˙˜w =

1
kI

˜w⊤(Sw − ˙δ)

and, substituting ˙δ from (6c) into the above equation, one obtains

1
kI

˜w⊤(Sw − ˙δ) =

1
kI

˜w⊤S ˜w −

1
kI

˜w⊤C ⊤Q vrp(β).

Bearing in mind that S is a skew-symmetric matrix and hence ˜w⊤S ˜w = 0, one
gets

1
kI

˜w⊤S ˜w −

1
kI

˜w⊤C ⊤Q vrp(β)

= −

= −

= −

1
kI
1
kI
1
kI

(C ˜w)⊤Q vrp(β)

vrp⊤( ˜∆)Q vrp(β)

tr( ˜∆⊤β) .

and, recalling the expression of

˙L2 and the “innovation term” β (6d), one has

˙L2 =

ν

Xi=1

tr(cid:16) ˜∆⊤P(cid:16)X −⊤(cid:0)Eryr

i e⊤

i (cid:1)⊤

X ⊤(cid:17)(cid:17) .

(14)

Finally, substituting (13) and (14) into (9) and introducing the expression of U
(6a), it yields

˙L =

=

ν

ν

Pi=1
Pi=1

= −kp

tr(cid:16)(U − AdX −1 ∆)⊤
P(cid:16)(cid:0)Eryr
tr(cid:18)−kpP(cid:16)(cid:0)Eryr
i (cid:1)⊤(cid:17)⊤
Pi=1(cid:12)(cid:12)(cid:12)
i (cid:1)⊤(cid:17)(cid:12)(cid:12)(cid:12)
P(cid:16)(cid:0)Eryr

i e⊤

i e⊤

2

.

ν

i e⊤

i (cid:1)⊤(cid:17)(cid:17)
P(cid:16)(cid:0)Eryr

i e⊤

i (cid:1)⊤(cid:17)(cid:19)

Since L is positive deﬁnite in the error state and since the exosystem state
(Xd, w) lies in a compact set, it follows that the whole state is globally bounded
and solutions exist for all time. From this, using similar LaSalle arguments to
Theorem 3.1 in [17], it is possible to conclude that the set S is locally asymp-
totically stable.

4 The Special Case of SO(3)

In this section we consider the speciﬁc case of systems deﬁned in SO(3). By
changing the notation used in the previous sections to a more classical notation
we denote by R ∈ SO(3) the rotation matrix of the system and by Ω ∈ R3 its
angular velocity. In this section we consider the case in which the kynematic
system (1) is completed with the dynamics equation of motion

˙R = RΩ×
J ˙Ω = −Ω ∧ JΩ + Γ.

(15a)

(15b)

Thus modelling a rigid body with control input Γ ∈ R3 and J the inertia matrix.
In this context the rotation velocity Ω is a state component of the system. In
this framework the exosystem is described by

˙Rd = ◦Ωd×Rd
◦Ωd× = (Cw)×

˙w = Sw

(16)

where Rd is the desired orientation and ◦Ωd is the desired angular velocity in the
inertial reference frame. In order to deal with the new control input Γ, we split
the problem into two sub-problems following the backstepping paradigm [12].
In the ﬁrst sub-problem, Section 4.1, we consider Ω as control input instead of
a state component of the system and we solve the output regulation problem
providing the stability analysis. In the second one, Section 4.2, we consider the
control input Ω ≡ Ωc as virtual velocity reference. The virtual control input
Ωc, then, is backstepped in order to get the real torque input Γ.

4.1 Angular velocity Ω× as control input

In this context it turns out that the control law (6) reads as (with Re := Er)

Ωc

× = AdR⊤ ∆× +

∆× = (Cδ)×

kp
2

ν

Xi=1

(ei ∧ yr

i )×

˙δ = Sδ + C ⊤ Qso(3)β

β =

kI
2

R

ν

Xi=1

(ei ∧ yr
i )

(17a)

(17b)

(17c)

(17d)

where Ωc is the desired virtual input mentioned earlier. We continue the analysis
under the following assumption.

Assumption 3. There are two or more linear independent measurements yi
(i = 1, . . . , ν; ν ≥ 2) and the symmetric matrix

Y =

i yr⊤
yr

i

kp
2

ν

Xi=1

has three distinct eigenvalues.

Note that Assumption 3 specializes Assumption 1 in the speciﬁc case of
systems posed on SO(3). Indeed, it is straightforward to verify that two is the
minimum number of measurements such that the cost function (5) is positive
deﬁnite around the identity element of the group.

Theorem 1 ensures the local attractiveness of the compact set S in (18),
exploiting the structure of the special orthogonal group one can shown further
properties of the set, namely almost global stability and local exponential sta-
bility. The extensions of the local properties of Theorem 1 in the special case
of SO(3) are stated in the following Proposition.

Proposition 1. Consider the system (15a) along with exosystem (16) and let
the controller be given by (17). Let Assumption 3 holds. Then the set

S = {(R, δ, (Rd, w)) ∈ SO(3) × Rm × (SO(3) × Rm) :

R⊤Rd = Xr, δ = w}

(18)

is almost globally asymptotically and locally exponentially stable for the closed-
loop system.

Note that Assumption 2 is no more needed in Proposition 1 since the special

orthogonal group SO(3) is a compact manifold.

Proof. It is straightforward to verify that, under Assumption 3, the Lyapunov
function (8) is positive deﬁnite and L(0, 0) = 0.

In what follows we proceed by steps showing that:

1. The dynamic of the group error for the closed-loop system has only four

isolated equilibrium points (Re, ∆) = (R∗

ej , 0), j = 1, . . . , 4.

2. The equilibrium point (R∗

e1, ∆) = (I3, 0) is locally exponentially stable.

3. The three equilibria with (R∗

ej , ∆) 6= (I3, 0), j = 2, . . . , 4 are unstable.

Consider the dynamic of the group error for the closed-loop system

˙Re = AdR⊤ ˜∆× +

kp
2

ν

Xi=1

(Reyr

i ∧ yr

i )×! Re .

As consequence of Theorem 1 for ˙Re = 0 one has that ˜∆ = 0, which implies

0 =

kp
2

= R∗
e

(R∗

eyr

i ∧ yr
i )

i yr⊤
yr

i −

kp
2

ν

ν

Pi=1
Pi=1

kp
2

ν

Pi=1

i yr⊤
yr

i R∗⊤

e = R∗

eY − Y R∗⊤
e .

(19)

Proceeding like in the proof of Theorem 5.1 in [19] one has that R∗
implies either R∗
matrix and there are only four possible values of R∗
namely

e ) = −1. As consequence, R∗

e = I3 or tr(R∗

e that satisfy eq.

eY = Y R∗⊤
e is a symmetric
(19),

e

R∗
R∗
R∗
R∗

e1 = I3
e2 = u1u⊤
e3 = −u1u⊤
e4 = −u1u⊤

1 − u2u⊤

2 − u3u⊤
3

1 + u2u⊤
1 − u2u⊤

2 − u3u⊤
3
2 + u3u⊤
3




where u1, u2, u3 are the eigenvectors of Y associated to the eigenvalues λ1, λ2, λ3
ordered in ascending order. This, in turn, proves step 1. Hereafter we prove item
2 (namely local exponential stability of the set S). Without loss of generality
consider Xr = I3, C = I3. The dynamics of the error and velocity error for the
closed-loop system can be written as

˜∆ +

˙Re = (cid:18)ReR⊤
˙˜∆× = (cid:18)S ˜∆ + kI

d

ν

Pi=1

kp
2

ν

Pi=1

(Reyr

i ∧ yr

RdR⊤

e (Reyr

i ∧ yr

Re

i )(cid:19)×
i )(cid:19)×

and, denoting

where R ∈ SO(3), one gets

˜∆ = R ˜∆ ,

˙R = −RS

˙Re = (cid:18)ReR⊤
Pi=1

˙˜∆ = kI

ν

d R⊤ ˜∆ +

kp
2

ν

Pi=1

RRdR⊤

e (Reyr

i ∧ yr

i ) .

(Reyr

i ∧ yr

i )(cid:19)×

Re

(20)

where

˙θ(cid:21) =(cid:20) A(t) B(t)⊤
(cid:20) ˙x

0 (cid:21)(cid:20)x
θ(cid:21)

−C(t)

yi×yi×,

B(t) := RRd,

A(t)

:=

kp
2

ν

Pi=1

C(t)

:= −kI RRd

yi×yi×.

ν

Pi=1

Consider a ﬁrst order approximation of (Re, ˜∆) of equation (20) around the
equilibrium point (R∗
e1, 0). It suﬃces to show that the origin of the linearized
system is uniformly exponentially stable in order to prove that the equilibrium
(R∗
e1, 0) is locally exponentially stable. To this purpose consider the approxi-
mation Re = I + x× and ∆ = θ, with x, θ ∈ R3. By neglecting high order terms
one obtains

(21)

The proof follows the results derived from Theorem 1 in [15] which establish
suﬃcient conditions for the uniform exponential stability of the origin of a linear
time-varying system having the standard form in (21). As a matter of fact, the
i× and Q =
I kpP 2 satisfy the conditions PB⊤ = C ⊤ and −Q = A⊤P + PA + ˙P in
k−1
Assumption 2 of [15]. Furthermore, it is straightforward to verify that the term
B is uniformly persistently exciting, namely for any positive constant ε there
exists T > 0 such that

constant symmetric positive deﬁnite matrices P = kIPν

i=1 yi×y⊤

Z t+T

B(τ )B(τ )⊤dτ =Z t+T

t

t

RRdR⊤

d R⊤dτ = T I3 > εI3.

∂B(t)

Moreover from Theorem 1 one has that |B(t)| and (cid:12)(cid:12)(cid:12)(cid:12)

remain bounded for all
time. Hence all conditions of Theorem 1 in [15] are satisﬁed, thus the claim
in item 2 holds.
ej , 0),
j ∈ {2, 3, 4}, are unstable, it suﬃces to prove that the origin of the linearized
time-varying system is unstable. To this purpose consider the ﬁrst order ap-
ej(I3 + x×), ∆ = θ with x, y ∈ R3 around an equilibrium
proximation Re = R∗
point (R∗

In order to prove that the others three equilibria (R∗

ej, 0). The linearization of (20) is given by

(cid:12)(cid:12)(cid:12)(cid:12)

∂t

˙xj = Υjxj + R⊤

d R⊤θ

˙θj = 2

kI
kp

RRdΥjxj

(22)

where Υj :=

kp
2

ν

Pi=1

R∗

ej yi×R∗

ejyi×, with j = 2, . . . , 4.

The proof follows results derived from the Chataev’s theorem [12]. In par-

ticular, consider the functions

Vj(xj , θj) =

kI
2kp

j Υ⊤
x⊤

j xj −

1
4

|θj|2 ,

j = 2, . . . , 4

and, for an arbitrarily small radius r > 0, deﬁne the set

Uj,r := {(xj, θj)⊤ | Vj(xj , θj) > 0, |xj , θj| < r}.

Following the Chateav’s theorem, we show now that Υj is not singular, at least
one of its eigenvalues is positive and that Uj,r is non-empty for each j ∈ {2, 3, 4}
and r > 0. As a matter of fact, consider the characteristic polynomial of the
matrix Υj. One has

det(Υj − ¯λI3) = det(Y R∗

ν

ej − kp

i R∗
y⊤
q Rq ¯RjR⊤

Pi=1

= det(RqλqR⊤

ejyiI3 − ¯λI3)

q − tr(cid:0)λq ¯Rj(cid:1) I3 − λI3)

(23)

= det(λq ¯Rj − tr(cid:0)λq ¯Rj(cid:1) I3 − λI3)
= det(λq ¯Rj − tr(cid:0)λq ¯Rj(cid:1) I3 − ¯λI3).

where we have used the fact that the matrices Y and R∗
as Y = RqλqR⊤

ej = Rq ¯RjR⊤

q and R∗

q with λq = diag(λ1, λ2, λ3) and

ej can be decomposed

¯R2 = diag(1, −1, −1),

¯R3 = diag(−1, 1, −1),

¯R4 = diag(−1, −1, 1).

From equation (23) one gets

λ(Υ2) = [λ2 + λ3; λ3 − λ1; λ2 − λ1]⊤
λ(Υ3) = [λ3 − λ2; λ3 + λ1; λ1 − λ2]⊤
λ(Υ4) = [λ2 − λ3; λ1 − λ3; λ1 + λ2]⊤.

Since, by Assumption 3, the eigenvalues λ1, λ2, λ3 are distinct and

0 ≤ λ1 < λ2 < λ3

it is straightforward to verify that the matrix Υj is not singular and at least one
of its eigenvalues is positive. As consequence the set Uj,r is non-empty. Consider
now the derivatives of Vj along the trajectories of the system. One has

˙Vj(xj , θj) =

kI
kp

x⊤
j Υ⊤

j Υjxj.

Since the matrix Υj is full rank it is straightforward to verify that Υ⊤
j Υj > 0,
with j = 2, . . . , 4. As consequence ˙Vj is positive for each (x, θ) ∈ Uj,r. From
this we conclude that all the conditions of Chateav’s Theorem are satisﬁed and
thus the origin of the system (22) is unstable for j ∈ {2, 3, 4}. This completes
the proof.

4.2 Backstepping procedure

In order to deal with the new control input Γ starting with the virtual input
Ωc, a backstepping procedure is developed. Deﬁne ˜Ω as

˜Ω = Ω − Ωc.

Consider (6b), (6c) completed with the following control law

Γ = Ω×JΩ − JΩ×R⊤∆ + J R⊤ ˙∆ + 2

(ei ∧ yr
i )

(24a)

ν

Xi=1

yr
i× (yr

i − ei)× ( ˜Ω + α) − kD ˜Ω

ν

+ J kp

Xi=1
Xi=1(cid:16)kpR (yr

β =

kI

2   ν

i − ei)× yr

i×J ⊤ ˜Ω + R (ei ∧ yr

(24b)

i )(cid:17)!

with α = kpPν

i ) and kD a positive arbitrary gain. By backstepping
˜Ω it turns out that control law (24) solves the stabilization problem as stated
in the following proposition.

i=1 0.5 (ei∧yr

Proposition 2. Consider system (15a), (15b) along with exosystem (16) and
let the controller be given by (24), (6b), (6c). Let Assumption 3 holds.Then the
set

S1 = {((R, Rd), (δ, w), (Ω×, ◦Ωd×)) :

∈ SO(3)2 × R2m × so(3)2 : R⊤Rd = Xr, δ = w , Ω = ◦Ωd}

is almost globally asymptotically stable and locally exponentially stable for the
closed-loop system.

Proof. Consider the following function

Lbs = L +

˜Ω⊤J ˜Ω

1
2

where L is the Lyapunov function deﬁned in (8). It is straightforward to verify
that under assumption 3 the function Lbs is deﬁnite positive respect to the
compact set S1. Diﬀerentiating Lbs along the solutions of the closed-loop system
and bearing in mind the expression of Ωc, one has

˙Lbs = −

+

−

ν

ν

kp
4
1
2
1
2

Pi=1(cid:12)(cid:12)(Reyr
tr(cid:18) ˜Ω⊤
Pi=1
tr(cid:18) ˜∆⊤

×

×AdR

i ∧ yr

i )×(cid:12)(cid:12)
Pi=1

ν

(Reyr

i ∧ yr

2

+

1
kI

i )×(cid:19)

˜w⊤(cid:16)Sw − ˙δ(cid:17)
i )×(cid:19) + ˜Ω⊤(cid:16)−Ω×JΩ + Γ − J ˙Ωc(cid:17) .

(Reyr

i ∧ yr

× in vectorial form and diﬀerentiating it, one ob-

Recalling the expression of Ωc
tains

˙Ωc = −Ω×R⊤∆ + R⊤ ˙∆ +

yr
i× (Reyr

kp
2

ν

Pi=1

yr
i× (Reyr

i )× R⊤ ˜∆.

i )×(cid:16) ˜Ω + α(cid:17)

−

kp
2

ν

Pi=1

Substituting the expression of
expression of Γ (24a) and ˙δ (6c), one has

˙Ωc in the Lyapunov function and recalling the

˙Lbs = −

i ∧ yr

2

− kD ˜Ω2

ν

kp
4

Pi=1(cid:12)(cid:12)(Reyr
Pi=1

+ ˜∆⊤ kp

ν

i )×(cid:12)(cid:12)

R (Reyr

i )× yr

i×J ⊤ ˜Ω − R

(Reyr

i ∧ yr

i ) −

2
kI

β!.

ν

Pi=1

Introducing the expression of β (24b) in the above expression one obtains

˙Lbs = −

kp
4

i ∧ yr

2

− kD ˜Ω2.

ν

Xi=1(cid:12)(cid:12)(Reyr

i )×(cid:12)(cid:12)

It follows that the compact set S1 is stable in the sense of Lyapunov and that
˜Ω converges to zero. The proof can be completed using similar arguments to
Proposition 1.

5 Simulation Results

As illustrative example we consider two rigid bodies posed on SO(3). The ﬁrst
one, the simulated system, is modeled as fully actuated dynamic system (15b)
while the second one, the simulated exosystem, is modeled as kinematic system
(16). The reference directions considered in the simulations are ˚y1 = [1, 0, 0]⊤
and ˚y2 = [0, 1, 0]⊤. Initial states of the simulated system are chosen as R(0) =
I3, Ω(0) = 0 while the controller gains are chosen to be kp = kd = 2 and
kI = 0.4. The inertia matrix in the body-ﬁxed frame of the system is that of an
non-axisymmetric rigid body J = diag(2, 1.5, 1)[kg m2]. The desired velocity in
the inertial frame was chosen as ◦Ωd = (cos(t), 2 cos(5t), 3 cos(7t))[rad s−1]. The
initial yaw, pitch and roll of the simulated exosystem are chosen respectively as
180◦, 45◦ and 45◦. Figure 2 and Figure 3 show the evolution of tr (I − Re) and

the simulated system Ω converges to Ωc and the relative error Re converges to
the identity element of the group.

˜Ω(cid:12)(cid:12)(cid:12). Plots show that, in steady state, the velocity of

the relative velocity error (cid:12)(cid:12)(cid:12)

4

3

2

1

0

 
0

4

3

2

1

0

 
0

]
s
/

d
a
r
[

 

t r( I − R e)

25

 

˜Ω

-
-
-

-
-
-

15

20

25

5

10

15

20

t

t

5

10

Figure 2: Evolution of the relative Error Re and velocity error ˜Ω in SO(3). Case
of perfect knowledge of the Inertia matrix.

x 10−12

6.5

6

5.5

5

 

t r( I − R e)

262

264

266

268

t

270

272

274

276

 

˜Ω

-
-
-

-
-
-

4.5

 

260

x 10−6

1.5

]
s
/

d
a
r
[

1

0.5

 

0
260

262

264

266

268

t

270

272

274

276

Figure 3: Evolution of the relative Error Re and velocity error ˜Ω in SO(3) after
260 seconds. Case of perfect knowledge of the Inertia matrix.

A second simulation was run, considering a slight unknown variation in the
inertia tensor, to have a numerical hint on the robustness properties of the pro-
posed control law. The inertia matrix of the implemented control law is chosen
as Jnom = diag(2, 1.5, 1)[kg m2] while the real value is Jreal = diag(2.2, 1.3, 1.1)[kg
m2]. Figure 4 and Figure 5 show that only practical regulation can be achieved

in presence of uncertainties in the inertia tensor.

4

3

2

1

0

 
0

4

3

2

1

0

 
0

]
s
/

d
a
r
[

 

t r( I − R e)

25

 

˜Ω

-
-
-

-
-
-

15

20

25

5

10

15

20

t

t

5

10

Figure 4: Evolution of the relative Error Re and velocity error ˜Ω in SO(3). Case
of uncertainties in the Inertia.

0.02

0.015

0.01

0.005

 

0
260

262

264

266

0.8

0.6

0.4

0.2

]
s
/
d
a
r
[

 

0
260

262

264

266

 

t r( I − R e)

268

t

268

t

270

272

274

276

 

˜Ω

-
-
-

-
-
-

270

272

274

276

Figure 5: Evolution of the relative Error Re and velocity error ˜Ω in SO(3) after
260 second. Case of uncertainties in the Inertia.

6 Conclusion

In this paper, the problem of output regulation for systems deﬁned on matrix
Lie-Groups with invariant measurements was considered. The proposed control
law structure embeds a copy of the exosystem kinematic updated by means of
error measurements. A rigorous stability analysis was provided for both the
general case and the particular case of systems posed on the special orthogonal
group SO(3). Future works will consider the problem of robustness with respect
to uncertainties in the parameters (for instance, in the inertia tensor) and ex-
ternal unknown disturbances. Note, in fact, that the control law proposed in
(24) assumes a perfect knowledge of them.

Acknowledgement

This research was supported by integrated project SHERPA (G.A. 600958) sup-
ported by the European Community under the 7th Framework Programme, and
by the Australian Research Council and MadJInnovation through the Linkage
grant LP110200768.

References

[1] N. Aghannan and P. Rouchon. An intrinsic observer for a class of lagrangian

systems. IEEE Trans. on Automatic Control, 48(6):936–945, 2003.

[2] S. Bonnabel, P. Martin, and P. Rouchon. Symmetry-preserving observers.

IEEE Trans. on Automatic Control, 53(11):2514–2526, 2008.

[3] S. Bonnabel, P. Martin, and P. Rouchon. Non-linear symmetry-preserving
observers on lie groups. IEEE Trans. on Automatic Control, 54(7):1709–
1713, 2009.

[4] F. Bullo. Nonlinear Control of Mechanical Systems: A Riemannian Geom-

etry Approach. PhD thesis, California Istitute of Technology, 1999.

[5] C. I. Byrnes and A. Isidori. Nonlinear internal model for output regulation.

IEEE Trans. on Automatic Control, 49(12):2244–2247, 2004.

[6] E.J. Davison. The robust control of a servomechanism problem for linear
time-invariant multivariable systems. IEEE Trans. on Automatic Control,
1976.

[7] B.A. Francis. The linear multivariable regulator problem. SIAM J. Contr.

Optimiz., 1977.

[8] B.A. Francis and W.M. Wonham. The internal model principle of control

theory. Automatica, 1976.

[9] Minh-Duc Hua, Mohammad Zamani, Jochen Trumpf, Robert Mahony, and
Tarek Hamel. Observer design on the special euclidean group SE(3). De-
cision and Control and European Control Conference, 2011.

[10] A. Isidori and C.I. Byrnes. Output regulation for nonlinear systems. IEEE

Trans. on Automatic Control, 1990.

[11] A. Isidori, L. Marconi, and A. Serrani. Robust Autonomous Guidance. An

internal model approach. Springer, 2003.

[12] H. Khalil. Non linear systems. Prentice-Hall, 1996.

[13] C. Lageman, J. Trumpf, and R. Mahony. Observers for systems with in-
variat outputs. Proceedings of the European Control Conference, pages
4587–4592, 2009.

[14] C. Lageman, J. Trumpf, and R. Mahony. Gradient-like observers for invari-
ant dynamics on lie group. IEEE Trans. on Automatic Control, 55(2):367–
377, 2010.

[15] A. Loria and E. Panteley. Uniform exponential stability of linear time-

varying system: revisited. Systems & Control Letters, 2002.

[16] Y. Ma, S.Soatto, J. Kosecka, and S. Sastry. An Invitation to 3-D Vision:

From Images to Geometric Models. SpringerVerlag, 2003.

[17] R. Mahony, T. Hamel, and L. Marconi. Adding an integrator for output
regulation of systems with matrix lie-group states. American Control Con-
ference, 2015.

[18] R. Mahony, T. Hamel, P. Morin, and E. Malis. Non-linear complementary
ﬁlters on the special linear group. International Journal of Control, 2012.

[19] R. Mahony, T. Hamel, and J. M. Pﬂimlin. Non-linear complementary ﬁlters

on the special orthogonal group. International Journal of Control, 2012.

[20] C. Mayhew, R. Sanfelice, and A. Teel. Quaternion-based hybrid control
for robust global attitude tracking. IEEE Trans. on Automatic Control,
56(11):2555–2566, 2011.

[21] F. Delli Priscoli, L. Marconi, and A. Isidori. A new approach to adaptive

nonlinear regulation. SIAM J. Contr. Optimiz., 2006.

[22] D. S. Bernstein S. P. Bath. A topological obstruction to continuous global
stabilization of rotational motion and the unwinding phenomenon. Systems
& Control Letters, 39:63–70, 2000.

[23] J. Trumpf, R. Mahony, T. Hamel, and C. Lageman. Analysis of non-linear
attitude observers for time-varying reference measurements. IEEE Trans.
on Automatic Control, pages 2789–2800, 2012.

