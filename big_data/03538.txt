6
1
0
2

 
r
a

 

M
1
1

.

 
 
]
F
M
n
i
f
-
q
[
 
 

1
v
8
3
5
3
0

.

3
0
6
1
:
v
i
X
r
a

Asymptotic Optimal Strategy for Portfolio Optimization in a

Slowly Varying Stochastic Environment

Jean-Pierre Fouque∗

Ruimeng Hu†

March 14, 2016

Abstract

In this paper, we study the portfolio optimization problem with general utility functions and when
the return and volatility of underlying asset are slowly varying. An asymptotic optimal strategy is
provided within a speciﬁc class of admissible controls under this problem setup. Speciﬁcally, we ﬁrst
establish a rigorous ﬁrst order approximation of the value function associated to a ﬁxed zeroth order
suboptimal trading strategy, which is given by the heuristic argument in [J.-P. Fouque, R. Sircar and
T. Zariphopoulou, Mathematical Finance, 2016]. Then, we show that this zeroth order suboptimal
strategy is asymptotically optimal in a speciﬁc family of admissible trading strategies. Finally, we
show that our assumptions are satisﬁed by a particular fully solvable model.

Keywords: Portfolio allocation, stochastic volatility, regular perturbation, asymptotic optimality

1

Introduction

The portfolio optimization problem was ﬁrst introduced and studied in the continuous-time framework in
Merton [1969, 1971], which provided explicit solutions on how to trade stocks and/or how to consume so as
to maximize one’s utility, with risky assets following the Black-Scholes-Merton model (that is, geometric
Brownian motions with constant returns and constant volatilities), and when the utility function is of
speciﬁc types (for instance, Constant Relative Risk Aversion (CRRA)). Following these pioneer works, ad-
ditional constraints were added in this model to mimic real-life investments. This includes transaction cost
originally considered by Magill and Constantinides [1976] and a user’s guide by Guasoni and Muhle-Karbe
[2013], and investments under drawdown constraint for instance by Grossman and Zhou [1993], Cvitanic and Karatzas
[1995] and Elie and Touzi [2008], just to name a few. In the meantime, general models for risky assets
have been also considered, among which, Cox and Huang [1989] and Karatzas et al. [1987] ﬁrst studied
the incomplete market case, Zariphopoulou [1999] studied the case where the drift and volatility terms are
non-linear functions of the asset price, and Chacko and Viceira [2005] gave a closed-form solution under a
particular one-factor stochastic volatility model.

Recently, multiscale factor models for risky assets were considered in the portfolio optimization problem
in Fouque et al. [2016], where return and volatility are driven by fast and slow factors. Speciﬁcally, the
authors heuristically derived the asymptotic approximation to the value function and the optimal strategy
for general utility functions. In this paper, we shall focus on the risky asset modeled by only slowly varying
stochastic factor, and the reason is twofold: Firstly, slow factor is particularly important in long-term
investment, because the eﬀect of fast factor is approximately averaged out in the long time as studied in
[Fouque et al., 2016, Section 2]. Secondly, analysis under the model with fast mean-reverting stochastic
factor requires singular asymptotic techniques, and more technique details in combining the fast and slow
factors, and thus, this will be presented in another paper in preparation (Fouque and Hu [2016]).

We describe the model as below, with dynamics of the underlying asset and slowly varying factor

denoted as St and Zt respectively,

dSt = µ(Zt)St dt + σ(Zt)St dWt,
dZt = δc(Zt) dt + √δg(Zt) dW Z
t ,

(1.1)

(1.2)

∗Department of Statistics & Applied Probability, University of California, Santa Barbara, CA 93106-3110,

fouque@pstat.ucsb.edu. Work supported by NSF grant DMS-1409434.

†Department of Statistics & Applied Probability, University of California, Santa Barbara, CA 93106-3110,

hu@pstat.ucsb.edu.

1

where the standard Brownian motions(cid:0)Wt, W Z

t (cid:1) are correlated,

d(cid:10)W, W Z(cid:11)t = ρ dt,

|ρ| < 1.

Assumptions on the coeﬃcients µ(z), σ(z), c(z), g(z) of the model will be speciﬁed in Section 2.4. In (1.2),
= Z (1)
δt ,
δ is a small positive parameter that characterizes the slow variation of the process Z. Note that Zt
where the diﬀusion process Z (1) has the following inﬁnitesimal generator, denoted by M

D

M =

1
2

g(z)2∂2

zz + c(z)∂z.

(1.3)

Denote by X π

We refer to Fouque et al. [2011] for more details of this model, where asymptotic results in the limit δ → 0
are derived for linear problems of option pricing.
t the wealth process associated to the Markovian strategy π, and in this strategy, the
amount of money π(t, x, z) is invested in stock at time t, when the stock price is x, and the level of the slow
factor Zt is z, with the remaining money held in money market earning a risk-free interest of r. Assuming
that the portfolio is self-ﬁnancing, then X π
t

follows

dX π

t = π(t, X π

t , Zt)

+ r(X π

dSt
St
t + π(t, X π
t , Zt)(µ(Zt) − r)) dt + π(t, X π

t − π(t, X π

t , Zt)) dt

= (rX π

t , Zt)σ(Zt) dWt.

For simplicity and without loss of generality, we assume r = 0 for the rest of paper, and then

dX π

t = π(t, X π

t , Zt)µ(Zt) dt + π(t, X π

t , Zt)σ(Zt) dWt.

(1.4)

An investor aims at ﬁnding an optimal strategy π which maximizes her terminal expected utility

E [U (X π

T )], where U (x) is in a general class of utility functions. Denote by V δ(t, x, z) the value function

(1.5)

(1.6)

(1.7)

V δ(t, x, z) = sup

π∈A(t,x,z)

E [U (X π

T )|X π

t = x, Zt = z] ,

where the supremum is taken over all admissible strategies A(t, x, z),

A(t, x, z) = {π : X π

s in (1.4) stays nonnegative ∀s ≥ t, given Xt = x, and Zt = z} .

The Hamilton-Jacobi-Bellman (HJB) equation for V δ is given by

π∈A(cid:18) 1
V δ
t + δMV δ + max

2

σ(z)2π2V δ

xx + π(cid:16)µ(z)V δ

x + √δρg(z)σ(z)V δ

xz(cid:17)(cid:19) = 0.

As in Fouque et al. [2016], we shall assume that V δ is the unique classical solution of (1.7). Maximizing

in π and plugging in the optimizer gives the following nonlinear equation,

t + δMV δ −(cid:16)λ(z)V δ

xz(cid:17)2
x + √δρg(z)V δ

2V δ
xx

V δ

= 0,

(1.8)

where the optimizer (optimal control) is given in the feedback form by

V δ(T, x, z) = U (x),

π⋆ = −

λ(z)V δ
x
σ(z)V δ

xx −

√δρg(z)V δ
σ(z)V δ
xx

xz

,

and the Sharpe ratio is λ(z) = µ(z)/σ(z).

The HJB equation (1.7) is fully nonlinear and not explicitly solvable in general. In Fouque et al. [2016],
a regular perturbation approach is used to derive an approximation for V δ up to the ﬁrst order, namely,
the value function V δ is formally expanded as follows:

V δ = v(0) + √δv(1) + δv(2) + ··· ,

2

(1.9)

with v(0) and v(1) identiﬁed by asymptotic equations. It is also observed in [Fouque et al., 2016, Section
3.2.1] that the zeroth order suboptimal strategy

π(0)(t, x, z) = −

λ(z)
σ(z)

v(0)
x (t, x, z)
v(0)
xx (t, x, z)

,

(1.10)

not only gives the optimal value up to the principal term v(0), but also up to ﬁrst order √δ correction
v(0) + √δv(1).
)i is v(0) + √δv(1), where
Main result. We ﬁrst prove that the ﬁrst order approximation of EhU (X π(0)
the optimality of π(0) in the class of admissible controls of the formeπ0(t, x, z) + δαeπ1(t, x, z), with precise

properties given in Section 4. We also solve and analyze a concrete model that satisﬁes all the assumptions
in order to demonstrate that they are reasonable. We remark that the optimality of π(0) in the full class
of controls (1.6) remains open.

X π(0)
is the terminal value of the wealth process associated to the strategy π(0) given by (1.10), and U (x)
is in a general class of utility functions with precise assumptions given in Section 2.3. Then we establish

T

T

Organization of the paper. In Section 2, we brieﬂy review the classical Merton problem and heuristic
results in Fouque et al. [2016]. We also list all the assumptions needed for our theoretical proofs.
In
Section 3, we apply the regular perturbation technique to the value function associated to the strategy
π(0), and we prove its ﬁrst order accuracy. Then we show π(0) is asymptotically optimal in a smaller class
of admissible controls in Section 4. A fully solvable example with a closed-form solution is presented in
Section 5, which satisﬁes all the assumptions listed in Section 2. We make conclusive remakrs in Section 6.

2 Preliminaries and assumptions

In this section, we review the classical Merton problem, summarize the heuristic results in Fouque et al.
[2016], and list the assumptions on the utility function and the state processes needed for later proofs.

2.1 Merton problem with constant coeﬃcients

We ﬁrst discuss the case of µ and σ being constant in (1.1), which plays a crucial role in interpreting the
leading order value function v(0) in (1.9) and analysis of the regular perturbation. This problem has been
widely studied and completely solved, and we start with some background results.

Let Xt be the solution to

dXt = π⋆(t, Xt)µ dt + π⋆(t, Xt)σ dWt,

where π⋆(t, x) is the optimal trading strategy, then, Xt stays nonnegative up to time T , and

Z T

0

|σπ⋆(t, Xt)|2 dt < ∞, almost surely.

(2.1)

(2.2)

We refer to [Karatzas and Shreve, 1998, Chapter 3] for details.

Following the notations in Fouque et al. [2016], we denote by M (t, x; λ) the Merton value function,

then, one also has the following regularity results.
Proposition 2.1. If the investor’s utility U (x) is C2(0,∞), strictly increasing, strictly concave, and
satisﬁes the Inada and Asymptotic Elasticity conditions:

U ′(0+) = ∞, U ′(∞) = 0, AE[U ] := lim

x→∞

x

U ′(x)
U (x)

< 1,

then, the Merton value function is strictly increasing, strictly concave in the wealth variable x, and decreas-
ing in the time variable t, and it is the unique C1,2([0, T ] × R+) solution to the HJB equation

Mt + sup

π (cid:26) 1

2

σ2π2Mxx + µπMx(cid:27) = Mt −

1
2

λ2 M 2
x
Mxx

= 0, M (T, x; λ) = U (x),

(2.3)

3

where λ = µ/σ is the constant Sharpe ratio. It is also continuously diﬀerentiable with respect to λ = µ/σ,
and π⋆ = − λ

Mx
Mxx

σ

.

The proof is referred to [Fouque et al., 2016, Section 2.1] where these properties were stated and it was

also mentioned that they have been established primarily using Fenchel-Legendre transformation.

The following relation between partial derivatives of M (t, x; λ) is provided in [Fouque et al., 2016,

Lemma 3.2].

Lemma 2.2. The Merton value function M (t, x; λ) satisﬁes the “Vega-Gamma” relation

where

is the risk-tolerance function.

Mλ = −(T − t)λR2Mxx,

R(t, x; λ) = −

Mx(t, x; λ)
Mxx(t, x; λ)

,

(2.4)

(2.5)

Note that R(t, x; λ) is continuous, strictly positive due to the regularity, concavity and monotonicity of

M (t, x; λ). As introduced in Fouque et al. [2016], we recall the notation

Dk = R(t, x; λ)k∂k
x ,

k = 1, 2,··· ,

Lt,x(λ) = ∂t +

1
2

λ2D2 + λ2D1.

(2.6)

(2.7)

Note that the coeﬃcients of Lt,x(λ) depend on R(t, x; λ), and then on M (t, x; λ), and the Merton PDE
(2.3) can be re-written as

Lt,x(λ)M (t, x; λ) = 0.

(2.8)

The following proposition regarding the linear operator Lt,x(λ) will be used repeatedly in Sections 3 and
4.

Proposition 2.3. Let Lt,x(λ) be the operator deﬁned in (2.7), and assume that the utility function U (x)
satisﬁes the conditions in Proposition 2.1 and U (0+) = 0 (or ﬁnite), then

Lt,x(λ)u(t, x; λ) = 0,
u(T, x; λ) = U (x).

(2.9)

has a unique nonnegative solution.

Proof. First, observe that M (t, x; λ) is a solution of (2.9). To show uniqueness, we use the following
transformation in Fouque et al. [2016],

(cid:26) ξ = − log Mx(t, x; λ) + 1

t′ = t,

2 λ2(T − t),

(2.10)

which is one-to-one since the Jacobian(cid:12)(cid:12)(cid:12) −Mxx

Mx (cid:12)(cid:12)(cid:12) stays positive. Deﬁne w(t′, ξ; λ) = u(t, x; λ), then w solves:

λ2wξξ = 0, w(T, ξ; λ) = U (I(e−ξ)).

Hw = wt′ +

1
2

Uniqueness of the nonnegative solution then follows from classical results for the heat equation [John, 1982,
Chapter 7.1(d)].

4

2.2 Existing results under slowly varying stochastic factor

In this subsection, we summarize the results in Fouque et al. [2016] that will be used in later sections.
Recall the formal expansion of V δ:

V δ = v(0) + √δv(1) + δv(2) + ··· ,

then:

(i) The leading order term v(0) is the unique solution to

x (cid:17)2
λ(z)2(cid:16)v(0)

v(0)
xx

1
2

v(0)
t −

= 0,

v(0)(T, x, z) = U (x),

(2.11)

and is the Merton value function associated with the current (or frozen) Sharpe ratio λ(z) = µ(z)/σ(z):

(ii) The ﬁrst order correction v(1) solves the linear PDE:

v(0)(t, x, z) = M(cid:0)t, x; λ(z)(cid:1).

(2.12)

v(1)
t +

λ(z)2  v(0)
xx!2

x
v(0)

1
2

v(1)

xx − λ(z)2 v(0)

x
v(0)
xx

v(1)
x = ρλ(z)g(z)

v(0)
x v(0)
xz
v(0)
xx

,

v(1)(T, x, z) = 0.

Using the notations (2.6)-(2.7), v(1) satisﬁes

Lt,x(λ(z))v(1) = −ρλ(z)g(z)D1v(0)
z ,

v(1)(T, x, z) = 0.

(2.13)

The linear equation (2.13) with zero terminal condition v(1)(T, x, z) = 0 has a unique solution. As a
consequence, the following equation:

Lt,x(λ(z))u(t, x, z) = 0,

u(T, x, z) = 0,

(2.14)

has a unique the solution u ≡ 0.

(iii) By the “Vega-Gamma” relation stated in Lemma 2.2, the z-derivative of the leading order term v(0)

satisﬁes:

and v(1) is explicitly given in term of v(0) by

v(0)
z = −(T − t)λ(z)λ′(z)D2v(0),

v(1) = −

1
2

(T − t)ρλ(z)g(z)

v(0)
x v(0)
xz
v(0)
xx

.

(2.15)

(2.16)

2.3 Assumptions on the utility U(x)

Assumption 2.4. Throughout the paper, we make the following assumptions on the utility U (x):
(i) U(x) is C7(0,∞), strictly increasing, strictly concave and satisfying the following conditions (Inada

and Asymptotic Elasticity):

U ′(0+) = ∞, U ′(∞) = 0, AE[U ] := lim

x→∞

x

U ′(x)
U (x)

< 1.

(2.17)

(ii) U(0+) is ﬁnite. Without loss of generality, we assume U(0+) = 0.

5

(cid:12)(cid:12)∂2
xR2(x)(cid:12)(cid:12) ≤ K,

and

R′(x) ≤ C

R(x) ≤ Cx,

(2.21)

then

where C =pK/2.

(iii) Denote by R(x) the risk tolerance,

R(x) := −

U ′(x)
U ′′(x)

.

(2.18)

Assume that R(0) = 0, R(x) is strictly increasing and R′(x) < ∞ on [0,∞), and there exists K ∈ R+,
such that for x ≥ 0, and 2 ≤ i ≤ 5,
(2.19)

(iv) Deﬁne the inverse function of the marginal utility U ′(x) as I : R+ → R+, I(y) = U ′(−1)(y), and

assume that, for some positive α, I(y) satisﬁes the polynomial growth condition:

(cid:12)(cid:12)∂i
xRi(x)(cid:12)(cid:12) ≤ K.

I(y) ≤ α + κy−α.

(2.20)

Note that the risk tolerance R(x) given by (2.18) is in fact the risk tolerance function R(t, x; λ) at
terminal time T , and that the assumption (2.19) holds for the case i = 1 as a consequence stated in the
following lemma, although it is made for 2 ≤ i ≤ 5,
Lemma 2.5 (K¨allblad and Zariphopoulou [2014], Proposition 14). Assume that the risk tolerance R(x)
satisﬁes: R(0) = 0, R(x) is strictly increasing and R′(x) < ∞ on [0,∞), and there exists K ∈ R+ such
that

Lemma 2.6. The Asymptotic Elasticity condition (2.17) is implied by the following condition:

R(x) ≤ Cx.

Proof. It follows directly from Proposition B.3 in Schachermayer [2004], which we recall here for complete-
ness.

If lim inf
x→+∞

AP [U ] = a > 0, then AE[U ] ≤ (1 − a)+,

where AP [U ] is the Arrow-Pratt risk aversion given by:

AP [U ] = −x

U ′′(x)
U ′(x)

.

(2.22)

Now this lemma follows by:

a = lim inf

x→+∞(cid:18) x

R(x)(cid:19) ≥ lim inf

x→+∞

x
Cx

=

1
C

> 0.

Remark 2.7. Assumption 2.4 (ii) is a suﬃcient assumption, in fact, there are cases where U(0+) is not
ﬁnite, but our main Theorem 3.1 still holds. For example, power utility U (x) = xγ
γ with γ < 0, and
logarithmic utility U (x) = log(x). For the ﬁrst case, the fully non-linear accuracy problem is completely
solved in Fouque et al. [2016] by distortion transformation, which linearizes the problem.

By expending ∂i

xRi(x) in (2.19) and Lemma 2.5 , it is easily shown that Assumption 2.4 (iii) is equivalent
to the following conditions on the risk tolerance R(x): a) R(0) = 0, and R(x) is strictly increasing on [0,∞);

and b)(cid:12)(cid:12)Rj(x)(cid:0)∂j+1
(i) Average of powers: U (x) =RE xy ν(dy), where ν(dy) is a ﬁnite positive measure, and the support E

x R(x)(cid:1)(cid:12)(cid:12) ≤ K, ∀0 ≤ j ≤ 4.

is compact, contained in [0, 1) and ν({0}) = 0. Two special cases are:

Proposition 2.8. The following classes of utility functions satisfy Assumption 2.4:

6

a) Power utility U (x) = 1

b) Mixture of power utilities U (x) = c1

γ xγ, with γ ∈ (0, 1);
+ c2

xγ1
γ1

xγ2
γ2

, with γ1, γ2 ∈ (0, 1) and c1, c2 > 0.

In both cases, ν(dy) is a counting measure of point(s) in [0,1).

(ii) U(x) is given by positive inverse of the marginal utility I(y) = U ′(−1)(y) : R+ → R+,

I(y) =Z N

0

y−s ν(ds),

(2.23)

with ν being ﬁnite and positive on compact support (N < +∞). This is Example 18 in K¨allblad and Zariphopoulou
[2014].

The proof of Proposition 2.8 is left to Appendix A.

Remark 2.9. In the ﬁrst class of utilities, 1 /∈ E in general , unless further assumptions are prescribed on
ln(x)−1
ν(dy). For instance if ν(dy) = dy and E = [0, 1], then, AE[U ] = limx→+∞
ln(x) = 1 which does satisfy
(2.17).

Remark 2.10. For the power utility U (x) = xγ
risk tolerance function (2.5) is linear, given by

γ , the Arrow-Pratt risk aversion (2.22) is constant and the

AP [U ] = −x

U ′′(x)
U ′(x)

= 1 − γ,

R(x) =

x
1 − γ

.

Compared to above, general utilities, such as the mixture of two powers

U Mix(x) = c1

xγ1
γ1

+ c2

xγ2
γ2

,

0 < γ1 ≤ γ2 < 1,

produce nonlinear risk aversion functions:

AP [U Mix] =

c1(1 − γ1)xγ1−γ2 + c2(1 − γ2)

c1xγ1−γ2 + c2

,

as well as nonlinear risk tolerances,

R(x) =(cid:18)

c1xγ1−γ2 + c2

c1(1 − γ1)xγ1−γ2 + c2(1 − γ2)(cid:19) x ∼(cid:26) x

x

1−γ2

1−γ1

, as x → ∞,
, as x → 0.

(2.24)

(2.25)

This is illustrated in Figure 1. Therefore, working with general utility enables us to model nonlinear relation
between the relative risk aversion and the wealth (middle plot), and makes our model closer to results from
empirical studies on how AP [U ] varies with wealth.

14

12

10

8

6

4

2

 

0
0

UTILITIES

 

γ
1 = 0.25
γ
2 = 0.75
Mixture

ARROW−PRATT RISK AVERSION

γ
1 = 0.25
γ
2 = 0.75
Mixture

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

5

10

Wealth x

15

 

0.2
0

20

5

10

Wealth x

15

 

80

70

60

50

40

30

20

10

20

 

0
0

RISK TOLERANCE

 

γ
1 = 0.25
γ
2 = 0.75
Mixture

5

10

Wealth x

15

20

Figure 1: Mixture of power utilities with γ1 = 0.25, γ2 = 0.75 and c1 = c2 = 1/2.

7

2.4 Assumptions on the state processes (X π(0)
Note that z is only a parameter in the function v(0)(t, x, z) given by (2.11), and for ﬁxed z and t, v(0)
is a concave function that has a linear upper bound. For t = 0, there exists a function G(z), so that
v(0)(0, x, z) ≤ G(z) + x,∀(x, z) ∈ R+ × R.
Assumption 2.11. We make the following assumptions on the state processes (X π(0)

, St, Zt)

, St, Zt):

t

t

(i) For any starting points (s, z) and ﬁxed δ, the system of stochastic diﬀerential equations (1.1) - (1.2)
has a unique strong solution (St, Zt). Moreover, λ(z) is a C3(R) function, g(z) is a C2(R) function,
and the coeﬃcients g(z), c(z), λ(z) as well as their derivatives g′(z), g′′(z), λ′(z), λ′′(z) and λ′′′(z)
are at most polynomially growing.

(ii) The process Z (1) with inﬁnitesimal generator M deﬁned in (1.3) admits moments of any order uni-

formly in t ≤ T :

(iii) The process G(Z·) is in L2([0, T ] × Ω) uniformly in δ, i.e.,

t

sup

t≤T(cid:26)E(cid:12)(cid:12)(cid:12)Z (1)
E(0,z)"Z T

k(cid:27) ≤ C(T, k).
(cid:12)(cid:12)(cid:12)
G2(Zs) ds# ≤ C1(T, z),

0

(2.26)

(2.27)

(2.28)

where C1(T, z) is independent of δ and Zs follows (1.2) with Z0 = z.

(iv) The wealth process X π(0)

·

is in L2([0, T ] × Ω) uniformly in δ , i.e.,

E(0,x,z)"Z T

0 (cid:16)X π(0)
s (cid:17)2

ds# ≤ C2(T, x, z),

where C2(T, x, z) is independent of δ and X π(0)

s

follows

dX π(0)
X π(0)

s = π(0)(s, X π(0)
0 = x.

s

, Zs)µ(Zs) ds + π(0)(s, X π(0)

s

, Zs)σ(Zs) dWs,

s > 0;

(2.29)

Remark 2.12. Note that in Assumption 2.11 (i), the word “polynomially growing” is interpreted in dif-
ferent ways depending on the domain of g(z), c(z) and λ(z). If a function h(z) : R → R, for instance, when
Z is an Ornstein–Uhlenbeck process, then polynomial growth means that there exists a integer k and a > 0,
such that

|h(z)| ≤ a(1 + |z|k).

|h(z)| ≤ a(1 + zk + z−k).

Otherwise if h(z) : R+ → R, for example when Z is a Cox–Ingersoll-Ross process, then it means that there
exists a k ∈ N and a > 0, such that

In Assumption 2.11 (iii), if the diﬀusion process Z has exponential moments, then at-most exponential

growth of G(z) ensures (2.27). An explicit example will be given in Section 5.

Now we are ready to present the following estimate, which will be used in the rest of the paper.

Lemma 2.13. Under Assumption 2.11 (iii) - (iv), the process v(0)(·, X π(0)
in δ, i.e. ∀(t, x, z) ∈ [0, T ] × R+ × R:

·

, Z·) is in L2([0, T ]×Ω) uniformly

E(t,x,z)"Z T

t (cid:16)v(0)(s, X π(0)

s

, Zs)(cid:17)2

ds# ≤ C3(T, x, z),

(2.30)

where v(0)(t, x, z) is deﬁned in Section 2.2 and satisﬁes equation (2.11).

8

Proof. It follows by the straightforward computation:

E(t,x,z)"Z T

s

t (cid:16)v(0)(s, X π(0)
≤ E(t,x,z)"Z T
≤ 2 E(t,x,z)"Z T
≤ 2 E(0,z)"Z T

0

t

, Zs)(cid:17)2
s (cid:17)2
t (cid:16)G(Zs) + X π(0)

ds# ≤ E(t,x,z)"Z T
ds#

t (cid:16)v(0)(0, X π(0)

s

ds#

, Zs)(cid:17)2

G2(Zs) ds# + E(t,x,z)"Z T
G2(Zs) ds# + E(0,x,z)"Z T

t (cid:16)X π(0)
s (cid:17)2
0 (cid:16)X π(0)
s (cid:17)2

ds#!
ds#!

= 2 (C1(T, z) + C2(T, x, z))

.
= C3(T, x, z),

where we have successively used the monotonicity (decreasing property) of v(0) in t, the concavity of v(0)
in x and Assumptions 2.11 (iii)-(iv).

3 First order approximation of the value function V π(0),δ

In this section, we assume π(0) = − λ(z)
is given, and analyze the value function associated to it by
perturbation methods. Assume π(0) is admissible, and recall the dynamics of the wealth process associated
to the strategy π(0) and the slow factor Zt:
t = π(0)(t, X π(0)

, Zt)µ(Zt) dt + π(0)(t, X π(0)

, Zt)σ(Zt) dWt,

σ(z)

t

v(0)
x
v(0)
xx

dX π(0)
dZt = δg(Zt) dt + √δc(z) dW Z
t .

t

Then one deﬁnes the value function as the expected utility of terminal wealth:

V π(0),δ(t, x, z) = EnU (X π(0)

T

t = x, Zt = zo ,
)|X π(0)

where U (·) is a general utility function satisfying Assumption 2.4.

Our main result of this section is:

(3.1)

Theorem 3.1. Under assumptions 2.4 and 2.11, the residual function E(t, x, z) deﬁned by

E(t, x, z) := V π(0),δ(t, x, z) − v(0)(t, x, z) −

√δv(1)(t, x, z),

is of order δ. In other words, ∀(t, x, z) ∈ [0, T ]×R+×R, there exists a constant C, such that E(t, x, z) ≤ Cδ,
where C may depend on (t, x, z) but not on δ.

We recall that a function f δ(t, x, z) is of order δk, denoted by f δ(t, x, z) ∼ O(δk), if ∀(t, x, z) ∈ [0, T ]×

R+ × R, there exists C such that (cid:12)(cid:12)f δ(t, x, z)(cid:12)(cid:12) ≤ Cδk, where C may depned on (t, x, z), but not on δ.

Similarly, we denote f δ(t, x, z) ∼ o(δk), if lim supδ→0 |f δ(t, x, z)|/δk = 0.
3.1 Estimate of risk tolerance function R(t, x; λ(z)) and leading order term v(0)

In this subsection, we derive several properties of the risk tolerance function R(t, x; λ(z)), which will be
needed in the proof of Theorem 3.1. Some of the proofs involve lengthy calculations which we put in the
appendix.
Proposition 3.2. Let I : R+ → R+ be the inverse of marginal utility, and assume it satisﬁes the growth
condition in Assumption 2.4 (iv). Also, deﬁne H : R × [0, T ] × R → R+ by

1
2

λ2(z)(T − t)},

(3.2)

where M (t, x; λ(z)) is the Merton value function. Then:

Mx(t, H(x, t, λ(z)); λ(z)) = exp{−x −

9

(i) For each λ(z), H(x, t, λ(z)) is the unique solution to the heat equation,

with the terminal condition H(x, T, λ(z)) = I(e−x).

Ht +

1
2

λ2(z)Hxx = 0,

(ii) Moreover, for each t ∈ [0, T ] and λ(z) ∈ R, H(x, t, λ(z)) is strictly increasing and of full range,

lim

x→−∞

H(x, t, λ(z)) = 0 and

lim
x→∞

H(x, t, λ(z)) = ∞.

(iii) Deﬁne the inverse function H −1(y, t, λ(z)) : R+ × [0, T ] × R → R:
H(H −1(y, t, λ(z)), t, λ(z)) = y,

then, for (t, x, z) ∈ [0, T ] × R+ × R, the risk tolerance function R(t, x; λ(z)) is given by

R(t, x; λ(z)) = Hx(cid:16)H (−1)(x, t, λ(z)), t, λ(z)(cid:17) .

(3.3)

(3.4)

(3.5)

Proof. Similar results under constant λ with multiple assets are presented in [K¨allblad and Zariphopoulou,
2014, Propositions 4 and 6], and here we generalize the statement to our case.

Direct computation shows that H(x, t, λ(z)) satisﬁes (3.3). The existence and uniqueness of the solution

to (3.3) follows from the nonnegativeness of H(x, t, λ(z)).

The function H is strictly increasing in x since Hx(x, t, λ(z)) solves the same heat equation (3.3) with
a diﬀerent terminal condition Hx(x, T, λ(z)) = −e−xI ′(e−x) > 0 which is positive. Standard comparison
principle gives the positiveness of Hx(x, t, λ(z)) for previous time t < T . Equation (3.4) follows by using
the deﬁnition of H(x, t, λ(z)) in (3.2) and the fact that the value function M (t, x; λ(z)) satisﬁes the Inada
conditons for all t < T (see Karatzas et al. [1987] for more details).

Therefore the inverse function H (−1)(y, t, λ(z)) is well deﬁned for any y ≥ 0, and (3.5) is implied by

(3.2) and (2.5).

Proposition 3.3. Suppose the risk tolerance R(x) = − U ′(x)
U ′′(x) is strictly increasing for all x in [0,∞)
(this is part of Assumption 2.4 (iii)), then, for each t ∈ [0, T ) and λ(z) ∈ R, the risk tolerance function
R(t, x; λ(z)) is strictly increasing in the wealth variable x.

Proof. The proof follows the idea in the case of constant λ presented in [K¨allblad and Zariphopoulou, 2014,
Proposition 9], which we generalize to the case of variable λ(z) here.

Using the relation in (3.5), when t = T , we deduce:

Since R(x) and H(x, T, λ(z)) are strictly increasing, we claim that H(x, T, λ(z)) is strictly convex, namely,
Hxx(x, T, λ(z)) > 0. Standard comparison argument gives the positiveness of Hxx(x, t, λ(z)), for t < T .
Therefore, ∀t ∈ [0, T ], Rx(t, x; λ(z)) satisﬁes

R′(x) =

.

Hxx(y, T, λ(z))

Hx(y, T, λ(z))(cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,T,λ(z))
Hx(y, t, λ(z))(cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z))

Hxx(y, t, λ(z))

Rx(t, x; λ(z)) =

> 0,

and R(t, x; λ(z)) is strictly increasing in x.

Proposition 3.4. Under Assumption 2.4, the risk tolerance function R(t, x, λ(z)) satisﬁes: ∀0 ≤ j ≤ 4,
∃Kj > 0, such that ∀(t, x, z) ∈ [0, T ) × R+ × R,

(3.6)

(cid:12)(cid:12)Rj(t, x; λ(z))(cid:0)∂j+1

x R(t, x; λ(z))(cid:1)(cid:12)(cid:12) ≤ Kj.

10

Or equivalently, ∀1 ≤ j ≤ 5, there exists eKj > 0, such that ∀(t, x, z) ∈ [0, T ) × R+ × R,

(cid:12)(cid:12)∂j
xRj(t, x; λ(z))(cid:12)(cid:12) ≤ eKj.

Moreover, for (t, x, z) ∈ [0, T ) × R+ × R,

R(t, x; λ(z)) ≤ K0x.

Proof. The proof of Proposition 3.4 is left to Appendix B.

Proposition 3.5. The risk tolerance function R(t, x; λ(z)) satisﬁes the relation:

Proof. Diﬀerentiating (2.15) with respect to x gives:

Rλ = (T − t)λ(z)R2Rxx.

(3.7)

(3.8)

v(0)
xz = (T − t)λλ′(Rxv(0)
v(0)
xxz = (T − t)λλ′(Rxxv(0)

x + Rv(0)

xx ),

x + 2Rxv(0)

xx + Rv(0)

xxx).

The deﬁnition (2.5) of R(t, x; λ(z)) and equation (2.12) imply:

Diﬀerentiating (2.5) with respect to z, and using the above three equations produces

Rx = −1 +

v(0)
x v(0)
xxx

xx(cid:17)2 .
(cid:16)v(0)

Rz = −v(0)

xx v(0)

xz + v(0)

x v(0)
xxz

(cid:16)v(0)
xx(cid:17)2

xx

x − Rv(0)
v(0)
xx

= (T − t)λλ′ −Rxv(0)
= (T − t)λλ′(cid:0)RxR − R + R2Rxx − 2RxR + R(Rx + 1)(cid:1) = (T − t)λλ′R2Rxx.

xx(cid:17)2 (Rxxv(0)
(cid:16)v(0)

+ (T − t)λλ′

x + 2Rxv(0)

v(0)
x

xx + Rv(0)

xxx)

Then, the chain-rule relation Rz = Rλλ′(z) implies the conclusion.

Proposition 3.6. Under Assumption 2.4 (iii) and Assumption 2.11, there exist functions di,j(z) and

edi,j(z) at most polynomially growing such that the following inequalities are satisﬁed:

(cid:12)(cid:12)(cid:12)v(0)
z (t, x, z)(cid:12)(cid:12)(cid:12) ≤ d01(z)v(0)(t, x, z),
(cid:12)(cid:12)(cid:12)v(0)
xxz(t, x, z)(cid:12)(cid:12)(cid:12) ≤ d21(z)(cid:12)(cid:12)(cid:12)v(0)
xx (t, x, z)(cid:12)(cid:12)(cid:12) ,
(cid:12)(cid:12)(cid:12)v(0)
zz (t, x, z)(cid:12)(cid:12)(cid:12) ≤ d02(z)v(0)(t, x, z),
(cid:12)(cid:12)(cid:12)v(0)
xzz(t, x, z)(cid:12)(cid:12)(cid:12) ≤ d12(z)v(0)
(cid:12)(cid:12)(cid:12)v(0)
xxzz(t, x, z)(cid:12)(cid:12)(cid:12) ≤ d22(z)(cid:12)(cid:12)(cid:12)v(0)
xx (t, x, z)(cid:12)(cid:12)(cid:12) ,

x (t, x, z),

x (t, x, z),

(cid:12)(cid:12)(cid:12)v(0)
xz (t, x, z)(cid:12)(cid:12)(cid:12) ≤ d11(z)v(0)
|Rz(t, x; λ(z))| ≤ ed01(z)R(t, x; λ(z)),
|Rxz(t, x; λ(z))| ≤ ed11(z),
|Rzz(t, x; λ(z))| ≤ ed02(z)R(t, x; λ(z)),
(cid:12)(cid:12)(cid:12)v(0)
xzzz(t, x, z)(cid:12)(cid:12)(cid:12) ≤ d13(z)v(0)

x (t, x, z).

Proof. The proof of Proposition 3.6 is given in Appendix C where we use Propositions 3.4 and 3.5.

11

3.2 Proof of Theorem 3.1
The value function V π(0),δ deﬁned in (3.1), satisﬁes the following PDE:

V π(0),δ

1
+ δMV π(0),δ +
t
2
V π(0),δ(T, x, z) = U (x).

σ2(z)(cid:16)π(0)(cid:17)2

V π(0),δ
xx

+ π(0)(cid:16)µ(z)V π(0),δ

x

+ √δρg(z)σ(z)V π(0),δ

xz

(cid:17) = 0,

(3.9)

In the regime δ small, this is a regular perturbation problem, and the natural expansion takes the form

V π(0),δ = vπ(0),(0) + √δvπ(0),(1) + δvπ(0),(2) + ··· ,

where vπ(0),(0) is the leading order term and vπ(0),(1) is the ﬁrst order √δ correction of V π(0),δ. Collecting
terms of O(1) in (3.9) gives the linear parabolic equation satisﬁed by vπ(0),(0),
+ π(0)µ(z)vπ(0),(0)

vπ(0),(0)

(3.10)

= 0,

+

vπ(0),(0)
xx

x

σ2(z)(cid:16)π(0)(cid:17)2

t
vπ(0),(0)(T, x, z) = U (x).

1
2

Using the linear operator Lt,x deﬁned in (2.7) and π(0) deﬁned in (1.10), (3.10) becomes:

Lt,x(λ(z))vπ(0),(0) = 0,

vπ(0),(0)(T, x, z) = U (x).

By (2.8) and (2.12), we know that v(0) is a solution to (3.10) and the uniqueness result obtained in
Proposition 2.3 implies vπ(0),(0) ≡ v(0).
Next, collecting terms of O(√δ) yields
σ2(z)(cid:16)π(0)(cid:17)2

+ ρπ(0)g(z)σ(z)vπ(0),(0)

+ π(0)µ(z)vπ(0),(1)

vπ(0),(1)
xx

vπ(0),(1)

(3.11)

= 0,

1
2

+

xz

x

t
vπ(0),(1)(T, x, z) = 0.

Replacing vπ(0),(0) by v(0) in the above equation gives the same equation (2.13) for v(1). As mentioned in
Section 2.2, (2.13) has a unique solution v(1), thus vπ(0),(1) ≡ v(1). Therefore, the heuristic expansion of
V π(0),δ up to the ﬁrst order is identiﬁed as:

V π(0),δ = v(0) + √δv(1) + ··· .

Recall the residual function E(t, x, z) introduced in Theorem 3.1,
√δv(1).

E = V π(0),δ − v(0) −

Subtracting (3.10) and (3.11) from (3.9) and using the relations vπ(0),(0) ≡ v(0), vπ(0),(1) ≡ v(1), one has

Et +

1
2

σ(z)2(cid:16)π(0)(cid:17)2
+ δM(v(0) + √δv(1)) + δρσ(z)g(z)π(0)v(1)

Exx + π(0)µ(z)Ex + δME + √δρσ(z)g(z)π(0)Exz

xz = 0,

E(T, x, z) = 0.

(3.12)

Feynman–Kac formula givesthe following probabilistic representation for E(t, x, z)

E(t, x, z) =δE(t,x,z)(cid:20)Z T

t Mv(0)(s, X π(0)

s

:=δI + δ3/2II + δρIII,

, Zs) + ρσ(Zs)g(Zs)π(0)v(1)

xz (s, X π(0)

s

, Zs) ds(cid:21)

, Zs) + √δMv(1)(s, X π(0)

s

12

where E(t,x,z)[·] = E[·|Xt = x, Zt = z] and

t

I := E(t,x,z)"Z T
II := E(t,x,z)"Z T
III := E(t,x,z)"Z T

t

t

, Zs) ds# ,
, Zs) ds# ,
, Zs) ds# .

(3.13)

(3.14)

(3.15)

c(Zs)v(0)

z (s, X π(0)

s

g2(Zs)v(0)

zz (s, X π(0)

s

c(Zs)v(1)

z (s, X π(0)

s

g2(Zs)v(1)

zz (s, X π(0)

s

, Zs) +

1
2

, Zs) +

1
2

λ(Zs)g(Zs)R(s, X π(0)

s

; λ(Zs))v(1)

xz (s, X π(0)

s

In order to show that E is of order δ, it suﬃces to show that I, II and III are uniformly bounded in δ. The
derivation of these bounds are given in the appendix D.

4 Asymptotic Optimality of π(0)

deﬁned by

Further conditions will be given in Assumption 4.1.

For a ﬁxed choice of (eπ0,eπ1, α > 0), we introduce the family of admissible trading strategies A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3)
every family A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3) as precisely stated in our main Theorem 4.5 in Section 4.3.
Denote byeV δ the value function associated to the trading strategy π :=eπ0+δαeπ1 ∈ A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3):

A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3) =(cid:8)eπ0 + δαeπ1(cid:9)0≤δ≤1 .

The goal of this section is to show that the strategy π(0) deﬁned in (1.10) asymptotically outperforms

t = x, Zt = z] ,

(4.1)

(4.2)

where X π
t

is the wealth process following the strategy π, and Zt is slowly varying with the same δ:

eV δ = E [U (X π

T )|X π

t = π(t, X π

dX π
dZt = δc(Zt) dt + √δg(Zt) dW Z
t .

t , Zt)µ(Zt) dt + π(t, X π

t , Zt)σ(Zt) dWt,

(4.3)

(4.4)

is given in Section 4.2. Asymptotic optimality of π(0) is obtained in Section 4.3.

We need to compare eV δ with V π(0),δ deﬁned in (3.1), for which we have established the ﬁrst order approx-
imation v(0) + √δv(1) in Theorem 3.1. This comparison is asymptotic in δ up to order √δ, and our ﬁrst
step is to obtain the corresponding approximation for eV δ. This is done heuristically in Section 4.1 in the
two caseseπ0 ≡ π(0) andeπ0 6≡ π(0), and depending on the value of the parameter α. The proof of accuracy
Assumption 4.1. For a ﬁxed choice of (eπ0, eπ1, α > 0), we require:
(i) The whole family (in δ) of strategies {eπ0 + δαeπ1} is contained in A(t, x, z);
(ii) Functions eπ0(t, x, z) and eπ1(t, x, z) are continuous on [0, T ] × R+ × R;
(iii) Let (eX t,x

s )t≤s≤T be the solution to:

(4.5)

deXs = µ(z)eπ0(s, eXs, z) ds + σ(z)eπ0(s, eXs, z) dWs,

starting at x at time t.

s

By (i), eX t,x

is nonnegative and we further assume that it has full support R+ for any t < s ≤ T .

Remark 4.2. Notice that π(0) deﬁned in (1.10) is continuous on [0, T ] × R+ × R, thus it is natural to
is the optimal trading strategy for the Merton problem when δ = 0, in which case Zt is frozen at its initial

require that eπ0 and eπ1 have the same regularity as π(0), that is (ii). Regarding (iii), from Section 2, π(0)
position z. The associated wealth process bX t,x

starting at x at time t is the solution to

s

dbXs = µ(z)π(0)(s, bXs, z) ds + σ(z)π(0)(s, bXs, z) dWs,

bXt = x.

13

Then, from [K¨allblad and Zariphopoulou, 2014, Proposition 7], one has

s = H(cid:0)H −1(x, t, λ(z)) + λ2(z)(s − t) + λ(z)(Ws − Wt), s, λ(z)(cid:1) ,
bX t,x

s

s

has

α > 0.

has full support R+, that is (iii).

where H : R × [0, T ] × R → R+ is deﬁned in Proposition 3.2 and is of full range. Consequently, bX t,x
full support R+, and thus, it is natural to require that eX t,x
Remark 4.3. We have A0(t, x, z)(cid:2)eπ0,eπ1, 0(cid:3) = A0(t, x, z)(cid:2)eπ0 +eπ1, 0, α(cid:3), so that it is enough to consider
4.1 Heuristic Expansion of the Value Function eV δ
We look for an expansion of the value function eV δ deﬁned in (4.2) of the form
eV δ =ev(0) + δαevα + δ2αev2α + ··· + δnαevnα + √δev(1) + ··· ,

where n is the largest integer such that nα < 1/2. Note that in the case α > 1/2, n is simply zero. In

the derivation, we are interested in identifying the zeroth order term ev(0) and the ﬁrst non-zero term up
to order √δ. The term followingev(0) will depend on the value of α.

Denote by L the inﬁnitesimal generator of the state processes (X π

t , Zt) given by (4.3) - (4.4)

(4.6)

L := δM +

1
2

σ2(z)(cid:0)eπ0 + δαeπ1(cid:1)2

∂xx +(cid:0)eπ0 + δαeπ1(cid:1) µ(z)∂x + √δρg(z)σ(z)(cid:0)eπ0 + δαeπ1(cid:1) ∂xz,

then, the value function eV δ deﬁned in (4.2) satisﬁes
eV δ(T, x, z) = U (x).
∂teV δ + LeV δ = 0,
Collecting terms of order one yields the equation satisﬁed byev(0)
σ2(z)(cid:0)eπ0(cid:1)2
ev(0)
ev(0)
xx + µ(z)eπ0ev(0)
ev(0)(T, x, z) = U (x).

x = 0,

t +

1
2

(4.7)

(4.8)

In this case, from the deﬁnition (1.10) of π(0), equation (4.8) becomes (2.9) which is also satisﬁed by v(0)

The order of approximation will depend oneπ0 being identical to π(0) or not.
4.1.1 Case eπ0 ≡ π(0)
by (2.12). By Proposition 2.3, we deduce ev(0) ≡ v(0). To identify the term of next order, one needs to
(i) α = 1/2. The next order term isev(1) and it satisﬁes
x (cid:17) = 0,

discuss case by case:

ev(1)
xx + π(0)µ(z)ev(1)

x + π(0)ρg(z)σ(z)ev(0)

xz +eπ1(cid:16)σ2(z)π(0)ev(0)

xx + µ(z)ev(0)

1
2

t +

σ2(cid:16)π(0)(cid:17)2
ev(1)
ev(1)(T, x, z) = 0.

It reduces to equation (2.13) since we have the relations

ev(0) = v(0)

and

σ2(z)π(0)ev(0)

xx = −µ(z)ev(0)

x ,

from the deﬁnition (1.10) of π(0). From Section 2.2 item (ii), v(1) is the unique solution to (2.13) and

therefore, we obtainev(1) ≡ v(1).
(ii) α > 1/2. The next order is of O(δ1/2). By collecting all terms of order δ1/2, we also obtain thatev(1)
satisﬁes (2.13), andev(1) ≡ v(1).

(4.9)

14

(iii) α < 1/2. The next order correction is O(δα). Collecting all terms of order δα in (4.7) yields

The last two terms cancel via the relation (4.9), and (4.10) becomes (2.14), which only has the trivial

1
2

t +

σ2(z)(cid:16)π(0)(cid:17)2

x +eπ1(cid:16)σ2(z)π(0)ev(0)

evα
xx + π(0)µ(z)evα

evα
evα(T, x, z) = 0.

xx + µ(z)ev(0)
solution, namelyevα ≡ 0. Therefore, we need to identify the next non-vanishing term.
• 1/4 < α < 1/2. The next order is of O(δ1/2), andev(1) satisﬁes

x (cid:17) = 0,

xz = 0,

(4.10)

1
2

σ2(z)(cid:16)π(0)(cid:17)2

t +

ev(1)
ev(1)(T, x, z) = 0.

ev(1)
xx + π(0)µ(z)ev(1)

x + ρπ(0)g(z)σ(z)ev(0)

1
2

x +

t +

σ2(z)(cid:16)π(0)(cid:17)2

ev(1)
xx + π(0)µ(z)ev(1)

It coincides with (2.13) and we deduceev(1) = v(1).
• α = 1/4. The next order is of O(δ1/2), and the PDE satisﬁed byev(1) becomes
σ2(z)(cid:0)eπ1(cid:1)2
ev(1)
ev(0)
xx + π(0)ρg(z)σ(z)ev(0)
ev(1)(T, x, z) = 0,
which will be used later when we compare v(1) andev(1).
ev2α
xx + π(0)µ(z)ev2α

• 0 < α < 1/4. The next order is of O(δ2α) since 2α < 1/2, and

σ2(z)(cid:16)π(0)(cid:17)2

xx = 0,

x +

1
2

1
2

xz = 0,

Feynman–Kac formula gives:

(4.11)

(4.12)

(4.13)

(4.15)

t +

ev2α
ev2α(T, x, z) = 0.
ev2α(t, x, z) = E"Z T

t

1
2

σ2(z)(cid:0)eπ1(cid:1)2

(s, eXs, z)ev(0)

1
2

ev(0)

σ2(z)(cid:0)eπ1(cid:1)2
xx (s, eXs, z) ds(cid:12)(cid:12)eXt = x# ,
2 σ2(z)(cid:0)eπ1(cid:1)2
ev(0)

with eXs following (4.5). Notice that, for ﬁxed z, if the source term 1
zero after some time t1, then,ev2α(t1, x, z) is zero. Therefore, further analysis is needed in order
to ﬁnd the ﬁrst non-zero term afterev(0) at point (t, x, z). Note that both σ(z) and (−ev(0)
strictly positive (ev(0) = v(0) is strictly concave), hence,eπ1 is the problematic term. Accordingly,

t1(z) = inf{t ∈ [0, T ] :eπ1(u, x, z) = 0,∀(u, x) ∈ [t, T ] × R+},

where we use the convention inf{∅} = T . Based on t1(z), the following two regions are deﬁned:
(4.14)

xx is identically

we deﬁne

xx ) are

K1 =(cid:8)(t, x, z) : 0 ≤ t < t1(z), x ∈ R+, z ∈ R(cid:9) ,
C1 =(cid:8)(t, x, z) : t1(z) ≤ t ≤ T, x ∈ R+, z ∈ R(cid:9) ,

which form a partition of [0, T ] × R+ × R.
– For any (t, x, z) ∈ K1, since t < t1(z), there exists a point (t′, x′, z) ∈ [t, t1(z))×R+×{z} such

thateπ1(t′, x′, z) 6= 0. By continuity ofeπ1, there exist η > 0 and a set A := [t′, t′+ǫ]×[x′, x′+ǫ]
with 0 < ǫ < t1(z) − t′ such that |eπ1| ≥ η on A × {z}. By (4.13) and denoting by µs the

15

distribution of eX t,x

s , we deduce that

1
2

ev2α(t, x, z) ≤

t′

x′

1
2

σ2(z)Z x′+ǫ
Z t′+ǫ
(cid:0)eπ1(cid:1)2
(s, y, z)ev(0)
σ2(z)η2Z x′+ǫ
Z t′+ǫ
[−ev(0)
xx (s, y, z)]Z t′+ǫ
[−ev(0)

σ2(z)η2 inf
A

1
2

x′

t′

t′

≤ −

≤ −
< 0.

xx (s, y, z) ds µs( dy)

xx (s, y, z)] ds µs( dy)

 Z x′+ǫ

x′

µs( dy)! ds

(4.16)

s .

largest integer such that nα < 1/2 and we are in the case 0 < α < 1/4.

The conclusion ev2α(t, x, z) < 0 follows from ev(0) ≡ v(0), strict concavity and continuity of
v(0), and the full-support assumption on the distribution µs of eX t,x
– For any (t, x, z) ∈ C1, equation (4.12) becomes (2.14) (sinceeπ1 ≡ 0 in C1), and consequently,
ev2α(t, x, z) ≡ 0. Therefore, we need to analyze the next order term. Recall that n is the
∗ If n = 2, collecting terms of order δ1/2 and using the facts thatev2α ≡ 0 in C1 andevα ≡ 0,
yields (2.13) forev(1), and therefore,ev(1) = v(1).
∗ For n ≥ 3, namely, the next order is δ3α and α < 1/6, thenev3α satisﬁes
ev3α
xx + µ(z)eπ1ev2α
ev3α(T, x, z) = 0.
[t1(z), T ] × R+,ev2α(t, x, z) ≡ 0 and the above equation reduces to (2.14) again. There-
fore,ev3α(t, x, z) ≡ 0 in the region C1. Repeating this argument untilevnα, we obtain
and, as in the case n = 2, we concludeev(1) = v(1).

Notice that in the above PDE, z is simply a parameter. For ﬁxed z, on the region

x + σ2(z)π(0)eπ1ev2α

ev3α
xx + π(0)µ(z)ev3α

eviδ(t, x, z) ≡ 0,

σ2(z)(cid:16)π(0)(cid:17)2

∀(t, x, z) ∈ C1,

2 ≤ i ≤ n,

x = 0,

(4.17)

t +

1
2

We summarize the above discussion in the following table:

Value of α

α = 1/2
α > 1/2

1/4 < α < 1/2

α = 1/4

0 < α < 1/4

Table 1: Expansion of eV δ wheneπ0 ≡ π(0).

Remark

Expansion
v(0) + √δv(1)

v(0) + √δev(1)

Region K1: v(0) + δ2αev2α
Region C1: v(0) + √δv(1)

ev(1) satisﬁes equation (4.11)

ev2α satisﬁes equation (4.12) and (4.16)

4.1.2 Case eπ0 6≡ π(0)
Recall that the leading order termev(0) satisﬁes (4.8):
ev(0)
ev(0)
xx +eπ0µ(z)ev(0)

σ2(z)(cid:0)eπ0(cid:1)2

For z ∈ R, we introduce

ev(0)(T, x, z) = U (x).
t0(z) = infnt ≥ 0 :eπ0(u, x, z) ≡ π(0)(u, x, z),∀(u, x) ∈ [t, T ] × R+o ,

x = 0,

t +

1
2

16

inf{∅} = T.

Deﬁne the regions:

K = {(t, x, z) : 0 ≤ t < t0(z), x ∈ R+, z ∈ R},
C = {(t, x, z) : t0(z) ≤ t ≤ T, x ∈ R+, z ∈ R}.

(4.18)

(4.19)

the next non-varnishing term.

We claim that in the region K,eπ0 and π(0) diﬀer, while in the region C,ev(0) ≡ v(0) and we need to identify
In order to compare v(0) andev(0), we rewrite the equation (2.11) satisﬁed by v(0) as:
where we have used the relation −σ2(z)π(0)v(0)

σ2(z)(cid:16)eπ0 − π(0)(cid:17)2

xx +eπ0µ(z)v(0)

x −
xx = µ(z)v(0)
x .

σ2(z)(cid:0)eπ0(cid:1)2

Now, let f (t, x, z) be the diﬀerence of the two leading order terms:

v(0)
xx = 0,

v(0)
t +

v(0)

1
2

1
2

It satisﬁes

By the Feymann-Kac formula, one has:

1
2

ft +

f (T, x, z) = 0.

σ2(z)(cid:0)eπ0(cid:1)2
f (t, x, z) = −E"Z T

t

1
2

f (t, x, z) = v(0)(t, x, z) −ev(0)(t, x, z).
σ2(z)(cid:16)eπ0 − π(0)(cid:17)2
fxx +eπ0µ(z)fx −
σ2(z)(cid:16)eπ0 − π(0)(cid:17)2

(s, eXs, z)v(0)

1
2

v(0)
xx = 0,

xx (s, eXs, z) ds(cid:12)(cid:12)(cid:12)eXt = x# ,

(4.20)

that the right-hand side in (4.20) is strictly positive. Consequently f (t, x, z) > 0, and

where eXs follows (4.5). Using the argument given in Section 4.1.1 for the case 0 < α < 1/4, we deduce
Thus, in that case, the next term will not play a role when comparingeV δ and V π(0),δ = v(0) +√δv(1) +O(δ).
For any (t, x, z) ∈ C, since we have eπ0 ≡ π(0) on C, we can apply here the whole discussion in Section

4.1.1 (on the partition {C ∩ K1,C ∩ C1} in the case 0 < α < 1/4). The expansion results are summarized
in the table:

ev(0)(t, x, z) < v(0)(t, x, z),

∀(t, x, z) ∈ K.

(4.21)

Region

K

C

C ∩ K1
C ∩ C1

Value of α

all

α = 1/2
α > 1/2

1/4 < α < 1/2

α = 1/4

0 < α < 1/4

Table 2: Expansion of eV δ wheneπ0 6≡ π(0).

Expansion

Remark

v(0) + √δv(1)

ev(0)
v(0) + √δev(1)
v(0) + δ2αev2α

v(0) + √δv(1)

ev(0) satisﬁes (4.8) and (4.21)
ev(1) satisﬁes equation (4.11)

ev2α satisﬁes equation (4.12) and (4.16)

4.2 Accuracy of Approximations

In order to make rigorous the above expansions, we need additional assumptions listed in Appendix E. They

are technical integrability conditions, uniformly in δ, on the strategies in the class A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3)

deﬁned in (4.1) and their associated wealth processes.

17

Proposition 4.4. Under Assumption 2.4 (i)-(ii), 4.1 and E.1, we obtain the following accuracy results:

Case

eπ0 ≡ π(0)

eπ0 6≡ π(0)

Region

Table 3: Accuray of approximations of eV δ.
Approximation
v(0) + √δv(1)

α = 1/2
α > 1/2

Value of α

all

K1
C1
K

C

C ∩ K1
C ∩ C1

1/4 < α < 1/2

α = 1/4

0 < α < 1/4

all

α = 1/2
α > 1/2

1/4 < α < 1/2

α = 1/4

0 < α < 1/4

v(0) + √δv(1)

v(0) + √δv(1)

v(0) + √δev(1)
v(0) + δ2αev2α
ev(0)
v(0) + √δev(1)
v(0) + δ2αev2α

v(0) + √δv(1)

Accuracy

O(δ3α∧(1/2))
O(δα∧(1/2))

O(δ)
O(δ)
O(δ2α)
O(δ3/4)
O(δ)
O(δ)
O(δ)
O(δ2α)
O(δ3/4)
O(δ)

O(δ3α∧(1/2))

where we the meaning of O is as in Theorem 3.1.

Proof. Recall that eV δ satisﬁes

eV δ
t + δMeV δ +
eV δ(T, x, z) = U (x).

1
2

σ2(z)(cid:0)eπ0 + δαeπ1(cid:1)2eV δ

x xx +(cid:0)eπ0 + δαeπ1(cid:1) µ(z)eV δ

x + √δρg(z)σ(z)(cid:0)eπ0 + δαeπ1(cid:1)eV δ

xz,

The proofs of accuracy for the approximations given in Tables 1 and 2 are quite standard, and we

approximation.

sketch them following the order of Table 3. In each case, E denotes the diﬀerence between eV δ and its
We start with the caseeπ0 = π(0).

(i) α = 1/2. Subtracting equation (2.11) and (2.13) from (4.7), we obtain the PDE satisﬁed by E(t, x, z):

Et + LE + δM(v(0) + √δv(1)) +

δ
2

x + δρg(z)σ(z)(cid:16)π(0)v(1)

E(T, x, z) = 0.

+ δµ(z)eπ1v(1)
E(t, x, z) = δE(t,x,z)Z T

Then, Feynman–Kac formula produces

t (cid:20)Mv(0)(s, X π

s , Zs) +

+ δ3/2E(t,x,z)Z T
+ δE(t,x,z)Z T
+ δρE(t,x,z)Z T
+ δ3/2ρE(t,x,z)Z T

t (cid:20)Mv(1)(s, X π
t hσ2(Zs)π(0)eπ1v(1)
t hg(Zs)σ(Zs)π(0)v(1)
g(Zs)σ(Zs)eπ1v(1)

t

18

Under Assumption E.1 (ia), one has E = O(δ).

xx(cid:17) + δσ2(z)π(0)eπ1v(1)
xz(cid:17) = 0,

xx

1
2

xx + √δv(1)

xz + √δeπ1v(1)

σ2(cid:0)eπ1(cid:1)2(cid:16)v(0)
xz +eπ1v(0)
σ2(Zs)(cid:0)eπ1(cid:1)2
σ2(Zs)(cid:0)eπ1(cid:1)2
s , Zs) + µ(Zs)eπ1v(1)
s , Zs) + g(Zs)σ(Zs)eπ1v(0)

s , Zs)(cid:21) ds

v(0)
xx (s, X π

xx (s, X π
v(1)

xz (s, X π

xx (s, X π

x (s, X π

s , Zs) +

1
2

xz (s, X π

s , Zs) ds.

s , Zs)(cid:21) ds
s , Zs)i ds

xz (s, X π

s , Zs)i ds

(ii) α > 1/2. Similarly, we have

Et + LE + δM(v(0) + √δv(1)) +

δ2α
2

x + δρg(z)σ(z)(cid:16)π(0)v(1)

σ(z)2(cid:0)eπ1(cid:1)2(cid:16)v(0)

xx + √δv(1)
xz + δα−1/2eπ1v(0)

xx(cid:17) + δ1/2+ασ2(z)π(0)eπ1v(1)
xz + δαeπ1v(1)

xz(cid:17) = 0,

xx

+ δ1/2+αµ(z)eπ1v(1)

E(T, x, z) = 0.

By Feynman–Kac formula and Assumption E.1 (ia), we deduce E = O(δ).

(iii) 1/4 < α < 1/2. We have

Et + LE + δM(v(0) + √δv(1)) +

+ δ1/2+αµ(z)eπ1v(1)

E(T, x, z) = 0,

δ2α
2

xx + √δv(1)
x + δ1/2+αρg(z)σ(z)(cid:16)δ1/2−απ(0)v(1)

σ(z)2(cid:0)eπ1(cid:1)2(cid:16)v(0)

xx(cid:17) + δ1/2+ασ2(z)π(0)eπ1v(1)
xz(cid:17) = 0,
xz + √δeπ1v(1)
xz +eπ1v(0)

xx

and by Assumption E.1 (ia), we have E = O(δ2α).

(iv) α = 1/4. Subtracting equation (2.11) and (4.11) from (4.7) yield

δ3/4

Et + LE + δM(v(0) + √δev(1)) +
+ δ3/4ρg(z)σ(z)(cid:16)eπ1v(0)

E(T, x, z) = 0,

xz + √δeπ1ev(1)

σ(z)2(cid:16)2π(0)eπ1 + δ1/4(eπ1)2(cid:17)ev(1)
xz + δ1/4π(0)ev(1)

xz(cid:17) = 0,

2

xx + δ3/4µ(z)eπ1ev(1)

x

and Assumption E.1 (ic) implies E = O(δ3/4).

(v) 0 < α < 1/4. In the region K1, subtracting (2.11) and (4.12) from (4.7) produces

Et + LE + δM(v(0) + δ2αev2α) +
+ √δρg(z)σ(z)(cid:16)π(0) + δαeπ1(cid:17)(cid:16)v(0)

E(T, x, z) = 0,

σ(z)2(cid:16)2π(0)eπ1 + δα(eπ1)2(cid:17)ev2α
xz + δ2αev2α

xz(cid:17) = 0,

δ3α
2

xx + δ3αµ(z)eπ1ev2α

x

and by Assumption E.1 (ib), one concludes that E = O(δ3α∧(1/2)).
In the complementary region C1, E satisﬁes:

δ2α
2

Et + LE + δM(v(0) + √δv(1)) +

σ(z)2(cid:0)eπ1(cid:1)2(cid:16)v(0)
x + √δρg(z)σ(z)(cid:16)√δπ(0)v(1)

xx + √δv(1)
xz + δαeπ1v(0)
Note that in the region C1,eπ1 ≡ 0, and the above equation reduces to:
Et + LE + δM(v(0) + √δv(1)) + δρg(z)σ(z)π(0)v(1)

+ δ1/2+αµ(z)eπ1v(1)

E(T, x, z) = 0.

E(T, x, z) = 0,

xz = 0,

xx(cid:17) + δ1/2+ασ2(z)π(0)eπ1v(1)
xz(cid:17) = 0,
xz + δα+1/2eπ1v(1)

xx

and then, Assumption E.1 (ib) implies E = O(δ).

Now, we turn to the case eπ0 6≡ π(0). In the region K, we know by (4.21) that ev(0) < v(0). Therefore,
eV δ − v(0) is asymptotically of order one and negative. Thus, the next term will not play a role and we

19

deﬁne E = eV δ −ev(0). Subtracting equation (4.8) from (4.7) gives
Et + LE + δMev(0) + √δ(cid:0)eπ0 + δαeπ1(cid:1) ρg(z)σ(z)ev(0)

xz +

E(T, x, z) = 0.

1
2

σ2(z)(cid:0)δαeπ1(cid:1)2
+ σ2(z)eπ0δαeπ1ev(0)

xx + δαeπ1µ(z)ev(0)

xx

ev(0)

x = 0,

By Assumption E.1 (ii), we conclude that E = O(δα∧(1/2)).
here, except that the case 0 < α < 1/4, where the accuracy results hold in the partition {C ∩ K1,C ∩ C1}
of C. This complete the proof.

Remark thateπ0 ≡ π(0) in the region C. Therefore, the whole analysis of caseeπ0 ≡ π(0) can be applied

4.3 Asymptotic Optimality

Our main result in this section is the following:

Theorem 4.5. For ﬁxed (t, x, z) and any family of trading strategies A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3), then,

(4.22)

lim

δ→0 eV δ(t, x, z) − V π(0),δ(t, x, z)

√δ

≤ 0.

lim

cally better at order one:

That is, the strategy π(0) which generates V π(0),δ, performs asymptotically better up to order √δ than the

δ→0eV δ(t, x, z) =ev(0)(t, x, z) < v(0)(t, x, z) = lim

family(cid:8)eπ0 + δαeπ1(cid:9) which generates eV δ.
Additionally, if eπ0 6≡ π(0), and in the region K deﬁned by (4.18), the strategy π(0) performs asymptoti-
Proof. To compare the asymptotic performance of π(0) with the family of trading strategies A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3),
we are essentially comparing the approximations of eV δ summarized in Table 3 with the ﬁrst order approx-
imation v(0) +√δv(1) of V π(0),δ obtained in Theorem 3.1. In each case in Table 3 where the approximation
of eV δ is v(0) + √δv(1), it is easy to check that (4.22) is satisﬁed and the limit is zero. The remaining ﬁve
cases are: (a) eπ0 ≡ π(0) and α = 1/4; (a’)eπ0 6≡ π(0), in C, and α = 1/4; (b) eπ0 ≡ π(0) and 0 < α < 1/4 in
the region K1; (b’)eπ0 6≡ π(0), in C ∩ K1, and 0 < α < 1/4; and (c)eπ0 6≡ π(0) in the region K.
(a) In the case eπ0 ≡ π(0) and α = 1/4, the approximation of eV δ up to order √δ is v(0) + √δev(1), and it
suﬃces to show thatev(1) ≤ v(1) for all (t, x, z) ∈ [0, T ] × R+ × R. Let f (t, x, z) be the diﬀerence

V π(0),δ(t, x, z).

(4.23)

δ→0

where eXt follows (4.5). The concavity of v(0) implies f (t, x, z) ≥ 0 and therefore, (4.22) holds.

20

Subtracting (4.11) from (2.13) produces

1
2

fxx + π(0)µ(z)fx −

f (t, x, z) = v(1)(t, x, z) −ev(1)(t, x, z).
σ2(z)(cid:0)eπ1(cid:1)2
xx (s, eXs, z) ds(cid:12)(cid:12)(cid:12)eXt = x# ,

σ2(z)(cid:0)eπ1(cid:1)2

(s, eXs, z)v(0)

v(0)
xx = 0,

1
2

ft +

1
2

σ2(z)(cid:16)π(0)(cid:17)2

f (T, x, z) = 0,

f (t, x, z) = −E"Z T

t

and the representation

(b) In the caseeπ0 ≡ π(0) and 0 < α < 1/4, the approximation of eV δ is v(0) + δ2αev2α + o(δ3α∧1/2), where
ev2α is strictly negative by (4.16). Consequently,
δ→0 eV δ(t, x, z) − V π(0),δ(t, x, z)

δ2αev2α − √δv(1) + o(δ3α∧1/2)

= −∞,

= lim
δ→0

√δ

√δ

lim

and (4.22) holds.

(c) In the caseeπ0 6≡ π(0) and (t, x, z) ∈ K, the approximation of eV δ isev(0) + o(1), and (4.21) shows that
ev(0) is strictly less than v(0). Thus, we deduce (4.23).

The proof for the case (a’) (resp. (b’)) is essentially the same as in (a) (resp. (b)) but in the region C (resp.
C ∩ K1).

5 A Fully-Solvable Example

In this section, we consider a model studied in Chacko and Viceira [2005] where explicit solutions are
derived for the consumption problem over inﬁnite horizon, and in Fouque et al. [2016] where expansions
for the terminal wealth problem are derived and accuracy of approximation is proved under power utility
with one factor. Our goal is to show that this model satisﬁes the various assumptions we have made in
this paper and, therefore, justify that they are reasonable. The underlying asset St and the slowly varying
factor Zt are modeled by:

dSt = µSt dt +r 1
dZt = δ(m − Zt) dt + √δβpZt dW Z

St dWt,

Zt

t ,

(5.1)

(5.2)

with β > 0 and µ > 0. The standard Feller condition β2 ≤ 2m is assumed to ensure that Zt stays positive.
In this example, we consider power utilities:

U (x) =

xγ
γ

,

0 < γ < 1,

for which Assumption 2.4 is satisﬁed by Proposition 2.8.

This model ﬁts in the class of models (1.1)-(1.2) by identifying the coeﬃcients µ(z), σ(z), c(z) and g(z)

as follows:

µ(z) = µ,

σ(z) =p1/z,

c(z) = m − z,

g(z) = β√z.

For Assumption 2.11 (i)-(ii) of (with state space (0,∞)), we notice that (Zt) is the unique strong
solution to (5.2) and it has ﬁnite moments of any order uniformly in δ ≤ 1 and t ≤ T , see for instance
[Fouque et al., 2011, Chapter 3].
The process (St) is given by:

St = S0 exp(cid:18)Z t

0 (cid:18)µ −

1

2Zs(cid:19) ds +Z t

0 r 1

Zs

dWs(cid:19) .

For Assumption 2.11 (iii)-(iv), we ﬁrst solve (2.11) to obtain v(0) and π(0):

µ2z(cid:16)v(0)
x (cid:17)2

v(0)
xx

1
2

v(0)
t −

= 0,

v(0)(T, x, z) =

xγ
γ

.

The ansatz v(0)(t, x, z) = xγ

γ f (t, z) gives the following ODE for f (t, z):

ft(t, z) +

1
2

µ2γ
1 − γ

zf (t, z) = 0,

f (T, z) = 1,

21

which admits the explicit solution

f (t, z) = e

µ2 γ
2(1−γ) z(T −t).

By Proposition 2.3, we deduce the unique solution

v(0)(t, x, z) =

µ2 γ
2(1−γ) z(T −t).

e

xγ
γ

Consequently, the zeroth order strategy π(0) and the risk tolerance function R(t, x; λ(z)) are given by

π(0)(t, x, z) =

µxz
1 − γ

,

and

R(t, x; λ(z)) =

x
1 − γ

.

(5.3)

Note that in this case, the relations on the derivatives of v(0) in Proposition 3.6 can be veriﬁed by direct
computation. The veriﬁcation of Assumption 2.11 (iii)-(iv) will be presented in the next two sections.

5.1

Integrability of the Process G(Z·)

As in Andersen and Piterbarg [2007], one can compute the left-hand sides of (2.27) and (2.28) by solving
Riccati equations. For convenience and notations, we recall the classical result:

Lemma 5.1. Let y(τ ) be the solution to the constant coeﬃcient Riccati equation:

y′(τ ) = q0 + q1y(τ ) + q2y(τ )2,

y(0) = 0.

Then y(τ ) is given by one of the following forms, depending on the sign of ∆ = q2

1 − 4q0q2:

(i) ∆ > 0

where

(ii) ∆ < 0

where

(iii) ∆ = 0

y(τ ) = α−

1 − e−ατ
1 − α−

α+

e−ατ ,

(5.4)

α = √∆,

α+ = −q1 + α

2q2

,

α− = −q1 − α

2q2

.

y(τ ) =

,

(5.5)

q0 sin(bτ )

b cos(bτ ) − a sin(bτ )
b = √−∆/2.

a = q1/2,

y(τ ) =

a2τ

q2(1 − aτ )

.

(5.6)

As mentioned in Section 2.4, v(0)(0, x, z) is a concave function, and it has a linear upper bound G(z)+x.

To obtain G(z), we derive: ∀x0 ∈ R+,

v(0)(0, x, z) ≤ v(0)(0, x0, z) +

=

xγ
0
γ

e

µ2 γz

∂
∂x
2(1−γ) T − xγ−1
γ − 1(cid:19) xγ

0 e

0

=(cid:18) 1

v(0)(0, x0, z)(x − x0)
µ2γz
2(1−γ) T x0 + xγ−1
e
e

0

µ2 γz
2(1−γ) T x

µ2 γz
2(1−γ) T + xγ−1

µ2 γz
2(1−γ) T x.

e

0

22

Let x0 = e

µ2 γz
2(1−γ)2 T

so that the coeﬃcient in front of x is 1, and G(z) can be chosen as:

Then, we shall show that

uniformly in δ. We have

where

solves

µ2γz

2(1−γ)2 T

.

µ2 γz

µ2γT

0 e

G(z) =(cid:18) 1
G(Z·) =(cid:18) 1
E(0,z)"Z T

γ − 1(cid:19) e

γ − 1(cid:19) xγ
γ − 1(cid:19) e
G2(Zs) ds# =(cid:18) 1
f δ(t, z; s) = E(cid:20)e

2(1−γ) T =(cid:18) 1
2(1−γ)2 Z· ∈ L2([0, T ] × Ω),
γ − 1(cid:19)2Z T
(1−γ)2 Zs(cid:12)(cid:12)(cid:12)(cid:12)Zt = z(cid:21) ,

µ2 γT

0

0

β2zf δ

zz + δ(m − z)f δ

z = 0,

t ∈ [0, s),

f δ
t +

δ
2

f δ(0, z; s) ds,

f δ(s, z; s) = ewz, with w =

This equation admits the solution

µ2γT

(1 − γ)2 .

f δ(t, z; s) = ewz+Aδ(s−t)z+Bδ (s−t),

where Aδ(τ ) satisﬁes the Riccati equation:

Aδ(τ )′ =

δ
2
Aδ(0) = 0,

and Bδ(τ ) solves

β2Aδ(τ )2 +(cid:0)δβ2w − δ(cid:1) Aδ(τ ) +(cid:18) δ

2

β2w2 − δw(cid:19) ,

τ ∈ (0, s],

Bδ(τ )′ = δm(w + Aδ(τ )), Bδ(0) = 0.

In this case, the discriminant ∆ = δ2 is positive, and Aδ(τ ) follows case (i) in Lemma 5.1:

Aδ(τ ) = −w(cid:0)1 − e−δτ(cid:1)

1 − w

e−δτ ,

w− 2
β2

τ ∈ [0, τ ⋆(δ)),

(5.7)

(5.8)

(5.9)

(5.10)

(5.11)

(5.12)

(5.13)

(5.14)

where [0, τ ⋆(δ)) is the domain where Aδ(τ ) stays ﬁnite.
It remains to show that Aδ(τ ) and Bδ(τ ) are
uniformly bounded in (δ, τ ) ∈ [0, δ] × [0, T ] for some δ ≤ 1. Note that the boundedness of Bδ(τ ) is a
consequence of that of Aδ(τ ) via equation (5.13). Since Aδ(τ ) is continuous on (0, 1]× [0, τ ⋆(δ)), it suﬃces
to show that i) there exists δ, such that τ ⋆(δ) > T for δ ≤ δ, and ii) limδ→0 Aδ(τ ) exists. To this end, we
examine the following cases:

(a) w < 2

(b) w > 2

β2 . The denominator of (5.14) stays above 1, τ ⋆(δ) = ∞, and limδ→0 Aδ(τ ) = 0.
β2 . Here τ ⋆(δ) = − 1
β2 . This case gives the trivial solution Aδ(τ ) ≡ 0.

w (cid:19), limδ→0 τ ⋆(δ) = ∞, and limδ→0 Aδ(τ ) = 0.

(c) w = 2
In all cases, Aδ(τ ) is uniformly bounded in [0, δ] × [0, T ]. Denoting by C(T) the uniform bound

δ ln(cid:18) w− 2

β2

then, following (5.13), we obtain a uniform bound for Bδ(τ ):

(cid:12)(cid:12)Aδ(τ )(cid:12)(cid:12) ≤ C(T ),

∀(δ, τ ) ∈ [0, δ] × [0, T ],

Bδ(τ ) ≤ δm(w + C(T ))T ≤ m(w + C(T ))T.

Therefore, combined with (5.8) and (5.10), we deduce that Assumption 2.11 (iii) is satisﬁed.

23

5.2 Moments of the Wealth Process X π(0)

t

First, using the explicit formula (5.3) for π(0), equation (2.29) becomes

In order to control E(0,x,z)hR T

µ2Zs
1 − γ

µ√Z s
1 − γ

0 X 2

s dsi, we introduce
f δ(t, x, z; s) = E(cid:20)(cid:16)X π(0)

s (cid:17)2(cid:12)(cid:12)(cid:12)(cid:12)Xt = x, Zt = z(cid:21) ,

dX π(0)

s =

X π(0)

s

ds +

X π(0)

s

dWs,

s ≥ t.

(5.15)

which solves

f δ
t +

µ2z
1 − γ

1
2
f δ(s, x, z; s) = x2.

xf δ

x +

µ2z

(1 − γ)2 x2f δ

xx + δ(m − z)f δ

z +

δ
2

β2zf δ

zz + ρ

√δµβ
1 − γ

zxf δ

xz = 0,

(5.16)

(5.17)

The solution is of the form

f δ(t, x, z; s) = x2eAδ(s−t)z+Bδ (s−t),

where Aδ(τ ) satisﬁes the Riccati equation:

Aδ(τ )′ =

β2Aδ(τ )2 +  2√δρµβ

1 − γ − δ! Aδ(τ ) +

δ
2

(3 − 2γ)µ2
(1 − γ)2 ,

τ ∈ (0, s], Aδ(0) = 0,

(5.18)

and Bδ(τ ) solves

Bδ(τ )′ = δmAδ(τ ), Bδ(0) = 0.

(5.19)

By a similar argument used in Section 5.1, the veriﬁcation of the uniform bound

E(0,x,z)"Z T

0

X 2

s ds# =Z T

0

f δ(0, x, z; s) ds ≤ C2(T, x, z),

reduces to i) there exists δ, such that τ ⋆(δ) > T for δ ≤ δ, (recall that τ ⋆(δ) is deﬁned to be the explosion
time) and ii) limδ→0 Aδ(τ ) exists. The details are given in Appendix F.

6 Conclusion

In this paper, we have considered the portfolio allocation problem in the context of a slowly varying
stochastic environment and when the investor tries to maximize her terminal utility in a general class of
utility functions. We proved that the zeroth order strategy identiﬁed in Fouque et al. [2016] is in fact
asymptotically optimal up to the ﬁrst order within a speciﬁc class of strategies. We have made precise the
assumptions needed in order to rigorously establish this asymptotic optimality. These assumptions are on
the coeﬃcients of the model, on the utility function, and on the zeroth order value function, that is the
solution to the classical Merton problem with constant coeﬃcients. Finally, we analyzed a fully solvable
example in order to demonstrate that our assumptions are reasonable.

In an ongoing work, we are establishing the same type of results in the case of a fast varying stochastic
environment, and, ultimately, in the case of a model with two factors, one slow and one fast. We also plan
to analyze the eﬀect of the ﬁrst order correction in the strategy on the second order correction of the value
function.

Our analysis deals with classical solutions of the partial diﬀerential equations involved in the problem,
HJB equations for the value functions and linear equations with source for the following terms. A full
optimality result would require working with viscosity solutions, and that is also part of our future research.

24

A Proof of Proposition 2.8

Proof of (i). Without loss of generality, we assume E = [a, b] ⊂ [0, 1). Notice that a can be zero, but b is
strictly less than 1. Deﬁne f (x, y) = xy, since f (7)
x (x, y) is continuous in [x0 − δ, x0 + δ] × E, ∀x0 ∈ (0,∞)
and f (7)

x (x, y) is integrable on E,

U (x) =ZE

f (x, y) ν(dy)

is C7(0,∞), Moreover, we have

U (i)(x) =ZE

f (i)
x (x, y) ν(dy), for i ≤ 7.

(A.1)

The monotonicity and concavity follows by the sign of U ′(x) and U ′′(x) in (A.1). U (0+) = 0 follows by
Dominated Convergence Theorem (DCT). We have:

lim
x→0+

U ′(x) ≥ lim

lim

x→+∞

U ′(x) = lim

AE[U ] = lim

x→+∞

a+δ

x→0+Z b
x→+∞Z b
xR b
R b

a

yxy−1 ν(dy) ≥ lim
y(cid:18) 1
x(cid:19)1−y

x→0+

ν(dy) ≤ lim

(a + δ)(cid:18) 1
x(cid:19)1−b
x(cid:19)1−b
b(cid:18) 1
x→+∞R b
a yxy ν(dy)
a xy ν(dy) ≤ b < 1,
R b

x→+∞

a yxy−1 ν(dy)
a xy ν(dy)

= lim

ν([a + δ, b]) = +∞, for a given δ;

ν([a, b]) = 0;

which shows the Inada and Asymptotic Elasticity conditions (2.17). To show Assumption 2.4 (iii) is
satisﬁed, we follow Remark 2.7, and prove the following: a) R(0) = 0, R(x) is strictly increasing on [0,∞);

x R(x)(cid:1)(cid:12)(cid:12) ≤ K, ∀0 ≤ j ≤ 4. For convenience, we introduce the short-hand notation

and b)(cid:12)(cid:12)Rj(x)(cid:0)∂j+1

f (y)xy ν(dy),

hf (y)ix =ZE

and in the sequel, we shall omit the subscript x when there is no confusion.

Following from (A.1) and using the short-hand notation, R(x) is given by

Since 1 − y is bounded by 1 − b and 1 − a, we deduce

R(x) =

= x

hyi

hy(1 − y)i

.

RE yxy−1 ν(dy)
RE y(1 − y)xy−2 ν(dy)
1 − a ≤ R(x) ≤

x

x
1 − b

,

R′(x) = hy(y + 1)ihy(1 − y)i − hyi(cid:10)y2(1 − y)(cid:11)

(A.2)

(A.3)

.

and obtain R(0) = 0 by letting x → 0. Taking derivative in (A.2) gives

The positiveness of R′(x) on [0,∞) follows by

R′(x) = hyi(cid:10)y3(cid:11) + hyi2 −(cid:10)y2(cid:11)2
hy(1 − y)i2
hyi

hyi

=

hy(1 − y)i ≥

(1 − a)hyi

hy(1 − y)i2
− hyi(cid:10)y2(cid:11)

=

1

1 − a

,

≥ hyi2 − hyi(cid:10)y2(cid:11)
hy(1 − y)i2

R(x) is strictly increasing for x ≥ 0. To show R′(x) < K, we derive the upper bound as follows:

. Thus, R′(x) is bounded below by 1

1−a on [0,∞), and consequently,

where we have used hyi(cid:10)y3(cid:11) ≥(cid:10)y2(cid:11)2
R′(x) ≤

(b + 1)(1 − a)hyi2

(1 − b)2 hyi2

=

(b + 1)(1 − a)

(1 − b)2

.

25

(A.4)

U ′(x) ≤ xb−1ZE
⇒ U ′ (cid:18)

⇒ I(y) ≤ κy−γ,

y ν(dy),

∀x ≥ 1,

t

RE y ν(dy)(cid:19)1/(b−1)! ≤ t,

y ν(dy),

∀y ≤ZE

∀t ≤ZE

y ν(dy)

where κ =(cid:16)

1

RE y ν(dy)(cid:17)1/(b−1)

two cases, we have I(y) ≤ α + κy−α.
U (x) can be recovered by:

is a constant depending solely on ν(dy), and α = 1

1−b > 1. Combining the

To show |R(x)R′′(x)| ≤ K, we ﬁrst compute R′′(x):

R′′(x) =

1

x (cid:10)y2(y + 1)(cid:11)

hy(1 − y)i

+

2(cid:10)y2(1 − y)(cid:11)2
hy(1 − y)i3

hyi

−(cid:10)y2(cid:11)(cid:10)y2(1 − y)(cid:11) + hyi(cid:10)y3(1 − y)(cid:11) +(cid:10)y2(1 − y)(cid:11)hy(y + 1)i

hy(1 − y)i2

! .

Then, the upper bound and lower bound of R(x)R′′(x) are computed as follows:

R(x)R′′(x) ≤

R(x)R′′(x) ≥ −

hyi

hy(1 − y)i  (b + 1)(cid:10)y2(cid:11)
(1 − a)(cid:10)y2(cid:11)2

(1 − b)hyi

hy(1 − y)i

hyi

+

hyi

(1 − b)3 hyi3 ! ≤
2(1 − b)2(cid:10)y2(cid:11)2
+ (1 − a)hyi(cid:10)y3(cid:11) + (1 − a)(1 + b)(cid:10)y2(cid:11)hyi

b + 3
1 − b

1
1 − b

(1 − b)2 hyi2

;

≥ −

(b + 3)

(1 − b)2 .

Combine the above bounds, we have the desired results |R(x)R′′(x)| ≤ K. Similar arguments works for
j = 2, 3, 4 by straightforward calculations.

The last step is to show the growth condition of I(y) = U ′(−1)(y). For y ≥ U ′(1) =RE y ν(dy), we have

I(y) ≤ 1. The other case y = U ′(x) ≤ U ′(1), where x ≥ 1,

Proof of (ii). This class of utility functions is deﬁned via the inverse of marginal utility I(y), where

U (x) =Z x

0

U ′(t) dt =Z x

0

I (−1)(t) dt.

(A.5)

Then U (0+) = 0 is automatically satisﬁed. By deﬁnition of I(y), I(y) ∈ C∞(0,∞), so does U (x). The
strictly monotonicity and strictly concavity are given by:

U ′(x) = I (−1)(x) > 0,

U ′′(x) =

1

I ′(I (−1)(x))

= Z N

0 −s(cid:16)I (−1)(x)(cid:17)−s−1

ν(ds)!−1

< 0.

By DCT, one has

I(+∞) = lim

I(0) = lim

y→+∞Z N
y→0Z N

0

0

y−s ν(ds) = 0,

y→0Z N

y−s ν(ds) ≥ lim
U ′(x)
U (x)

= lim

x

x→+∞

AE[U ] = lim

x→+∞

y−s ν(ds) ≥ lim

y→0

y−δν[δ, N ] = +∞,

δ
U ′(x) + xU ′′(x)

U ′(x)

= lim

x→+∞

1 −

x

R(x)

= 1 − lim

x→+∞

1

R′(x) ≤ 1 −

1
N

,

where we have used the fact that R′(x) ≤ N derived below.

From Proposotion 3.2, H(x, T, λ(z)) = I(e−x) =R N

R(x) = −

U ′(x)
U ′′(x)

= Hx(H (−1)(x, T, λ(z)), T, λ(z)) =Z N

0

0 exs ν(ds), and the risk tolerance R(x) is given by:

seH(−1)(x,T,λ(z))s ν(ds).

26

The fact that R(0) = 0 follows by DCT and H (−1)(0+, T, λ(z)) = −∞. R(x) has bounded derivative,
since:

R′(x) =

Hxx(H (−1)(x, T, λ(z)), T, λ(z))
Hx(H (−1)(x, T, λ(z)), T, λ(z))

= R N
0 eH(−1)(x,T,λ(z))ss2 ν(ds)
0 eH(−1)(x,T,λ(z))ss ν(ds) ≤ N.
R N

R(x) is strictly increasing, since the numerator stay positive for x > 0, i.e. 0 < R′(x) ≤ N . To show
|R(x)R′′(x)| ≤ K, one needs
1
2

Hxxx(H (−1)(x, T, λ(z)), T, λ(z))
Hx(H (−1)(x, T, λ(z)), T, λ(z))

R(x)R′′(x) + (R′(x))2 =

(R2(x))′′ =

= R N
0 eH(−1)(x,T,λ(z))ss3 ν(ds)
0 eH(−1)(x,T,λ(z))ss ν(ds) ≤ N 2.
R N

Since (R2(x))′′ and R′(x) are bounded, so does R(x)R′′(x). Similar arguments works for j = 2, 3, 4 by
using the following identities:

R2R′′′ + R′3 + 4RR′R′′ =

∂4
xH(H (−1)(x, T, λ(z)), T, λ(z))
Hx(H (−1)(x, T, λ(z)), T, λ(z))

R3R(4) + 7R2R′R′′′ + R′4 + 11RR′2R′′ + 4R2R′′2 =

= R N
0 eH(−1)(x,T,λ(z))ss4 ν(ds)
0 eH(−1)(x,T,λ(z))ss ν(ds) ≤ N 3
R N

∂5
xH(H (−1)(x, T, λ(z)), T, λ(z))
Hx(H (−1)(x, T, λ(z)), T, λ(z)) ≤ N 4,

12R′5 + 32R2R′2R′′′ + 57RR′3R′′ + R4R(5) + 15R3R′′R′′′ + 11R3R′R(4) + 54R2R′R′′2

=

xH(H (−1)(x, T, λ(z)), T, λ(z))
∂6
Hx(H (−1)(x, T, λ(z)), T, λ(z)) ≤ N 5.

Notice that I(y) satisﬁes the polynomial growth condition due to the following: denote by κ = ν([0, N ]),

if y ≥ 1, I(y) ≤ κ, otherwise when y < 1

I(y) ≤ κy−N .

Therefore, combining the two cases and deﬁning α = max{N, κ} yields the inequality (2.20).

B Proof of Proposition 3.4

To show (3.6), we use the relation (3.5) between the risk tolerance function R(t, x; λ(z)) and the function
H(x, t, λ(z)) (which is deﬁned in Proposition 3.2), namely

R(t, x; λ(z)) = Hx(H (−1)(x, t, λ(z)), t, λ(z)).

(B.1)

Diﬀerentiating (B.1) with respect to x, and letting t = T produces:

Notice that for ﬁxed λ(z), both Hxx(x, t, λ(z)) and Hx(x, t, λ(z)) satisfy the heat equation (3.3). Compar-
ison Principle ensures that the inequality is preserved for t < T , i.e. for (x, t, z) ∈ R × [0, T ] × R,

.

R′(x) =

Hxx(y, T, λ(z))

Hx(y, T, λ(z))(cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,T,λ(z))
Using R′(x) ≤ C =pK/2 (proved in Proposition 2.5) gives, for all x, z ∈ R,
|Hxx(x, T, λ(z))| ≤pK/2Hx(x, T, λ(z)).
|Hxx(x, t, λ(z))| ≤pK/2Hx(x, t, λ(z)).
Hx(y, t, λ(z))(cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z)) ≤pK/2 := K0.

Using (B.1) again, we obtain:

∂xR(t, x; λ(z)) =

Hxx(y, t, λ(z))

27

(B.2)

Thus, we have shown (3.6) with j = 0.

To complete the proof in the case j = 1, we ﬁrst obtain a relation between derivatives of R(t, x; λ(z))

and derivatives of H(x, t, λ(z)):

R2

x(t, x; λ(z)) + RRxx(t, x; λ(z)) =

1
2

∂2
xR2(t, x; λ(z)) =

Hxxx(y, t, λ(z))

Hx(y, t, λ(z)) (cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z))

.

(B.3)

Let t = T in the above identity, then, the middle quantity is reduced to 1
xR2(x) and is bounded by K/2
as assumed in (2.19), so does the ratio of Hxxx(x, T, λ(z)) over Hx(x, T, λ(z)) for all x ∈ R. Standard
Comparison Principle applies and the ratio remains bounded for t < T . This results in the boundedness

2 ∂2

of(cid:12)(cid:12)R2

x(t, x; λ(z)) + RRxx(t, x; λ(z))(cid:12)(cid:12). Combining with (B.2), we achieve:

|RRxx(t, x; λ(z))| ≤ K/2 + K 2

0 := K1.

To deal with j = 2, we ﬁrst obtain the identity:

R2Rxxx(t, x; λ(z)) + R3

x(t, x; λ(z)) + 4RRxRxx(t, x; λ(z)) =

∂4
xH(y, t, λ(z))

Hx(y, t, λ(z)) (cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z))

.

(B.4)

At terminal time T, each term on the left-hand side is bounded (cf. Remark 2.7), therefore, the right-hand
side is bounded. Then a similar argument based on Comparison Principle gives the following estimate:

The remaining cases are completed by replacing (B.4) by the following

(cid:12)(cid:12)R2Rxxx(t, x; λ(z))(cid:12)(cid:12) ≤ K2.

R3R(4)(t, x; λ(z)) + 7R2RxRxxx(t, x; λ(z)) + R4

x(t, x; λ(z)) + 11RR2

xRxx(t, x; λ(z)) + 4R2R2

xx(t, x; λ(z))

and repeating the same argument.

xRj(t, x; λ(z)) and using (3.6). To show (3.7), we
notice that R(t, x; λ(z)) is shown to be strictly increasing in Proposition 3.3, and R′(t, x; λ(z)) ≤ K0,
integrating on both sides with respect to x yields the desired result.

The bounds eKj are easily obtained by expanding ∂j

C Proof of Proposition 3.6

In the sequel, to shorten the notation, we shall omit the argument of v(0)(t, x, z) and its derivatives as well
as the arguments of the risk tolerance function R(t, x; λ(z)) and use R when there’s no confusion (note
that this is not the risk tolerance R(x) introduced in Assumption 2.4 (iii)). In what follows, we repeatedly
use the results in Proposition 3.4 and concavity of v(0).

(1) Recall the “Vega-Gamma” relation in (2.15). A direct calculation gives:

(cid:12)(cid:12)(cid:12)v(0)
z (cid:12)(cid:12)(cid:12) = (T − t)|λ(z)λ′(z)| Rv(0)

= d01(z)v(0),

x ≤ (T − t)|λ(z)λ′(z)| K0xv(0)

x ≤ K0(T − t)|λ(z)λ′(z)| v(0)

where d01(z) = K0(T − t)|λ(z)λ′(z)|.

28

=

∂5
xH(y, t, λ(z))

Hx(y, t, λ(z)) (cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z))

x(t, x; λ(z)) + 32R2R2

,

12R5

+ 11R3RxR(4)(t, x; λ(z)) + 54R2RxR2

xx(t, x; λ(z)) =

xRxxx(t, x; λ(z)) + 57RR3

xRxx(t, x; λ(z)) + R4R(5)(t, x; λ(z)) + 15R3RxxRxxx(t, x; λ(z))

∂6
xH(y, t, λ(z))

Hx(y, t, λ(z)) (cid:12)(cid:12)(cid:12)(cid:12)y=H(−1)(x,t,λ(z))

,

(2) Diﬀerentiating (2.15) with respect to z brings:

(cid:12)(cid:12)(cid:12)v(0)
xz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)Rxv(0)
≤ (T − t)|λ(z)λ′(z)|(cid:16)K0v(0)

= d11(z)v(0)
x ,

x + Rv(0)

x + v(0)

xx(cid:17)(cid:12)(cid:12)(cid:12)
x (cid:17) = (K0 + 1)(T − t)|λ(z)λ′(z)| v(0)

x

where d11(z) = (K0 + 1)(T − t)|λ(z)λ′(z)|.

(3) Diﬀerentiating v(0)

xz with repsect to x again produces:

x + 2Rxv(0)

(cid:12)(cid:12)(cid:12)v(0)
xxz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)Rxxv(0)
= (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)−RxxRv(0)
≤ (T − t)|λ(z)λ′(z)| (K1 + K0 + 1)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12)
= d21(z)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ,

xx + Rv(0)

xxx(cid:17)(cid:12)(cid:12)(cid:12)

xx + 2Rxv(0)

xx − (Rx + 1)v(0)

xx(cid:17)(cid:12)(cid:12)(cid:12)

where d21(z) = (K1 + K0 + 1)(T − t)|λ(z)λ′(z)|.

(4) Results in Proposition 3.5 gives:

where ed01(z) = K1(T − t)|λ(z)λ′(z)|.

(5) Diﬀerentiating equation (2.15) with respect to z yields:

|Rz| = (T − t)(cid:12)(cid:12)λ(z)λ′(z)RxxR2(cid:12)(cid:12) ≤ (T − t)|λ(z)λ′(z)| K1R = ed01R,
(cid:12)(cid:12)(cid:12)v(0)
zz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)(λ(z)λ′(z))zRv(0)
xz(cid:12)(cid:12)(cid:12)
≤ (T − t)(cid:16)|(λ(z)λ′(z))′| + |λ(z)λ′(z)| (ed01(z) + d11(z))(cid:17) Rv(0)
≤ (T − t)(cid:16)|(λ(z)λ′(z))′| + |λ(z)λ′(z)| (ed01(z) + d11(z))(cid:17) K0v(0)

x + λ(z)λ′(z)Rzv(0)

x + λ(z)λ′(z)Rv(0)

= d02(z)v(0),

x

where d02(z) = K0(T − t)(cid:16)|(λ(z)λ′(z))′| + |λ(z)λ′(z)| (ed01(z) + d11(z))(cid:17).

(6) Diﬀerentiating equation (3.8) with respect to x gives:

(7) Diﬀerentiating v(0)

x + Rv(0)

|Rxz| = (T − t)(cid:12)(cid:12)λ(z)λ′(z)(cid:0)R2Rxx(cid:1)x(cid:12)(cid:12) = (T − t)|λ(z)λ′(z)|(cid:12)(cid:12)RxxxR2 + 2RRxRxx(cid:12)(cid:12)

≤ (T − t)|λ(z)λ′(z)| (K2 + 2K1K0) = ed11(z),

xz given in (2) with respect to z, one has:

where ed11(z) = (K2 + 2K1K0)(T − t)|λ(z)λ′(z)|.
xx(cid:17)(cid:12)(cid:12)(cid:12)z
(cid:12)(cid:12)(cid:12)v(0)
xzz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)Rxv(0)
xxz(cid:17)(cid:12)(cid:12)(cid:12)
= (T − t)(cid:12)(cid:12)(cid:12)(λ(z)λ′(z))′(cid:16)Rxv(0)
xx(cid:17) + λ(z)λ′(z)(cid:16)Rxzv(0)
x (cid:17)
≤ (T − t)|(λ(z)λ′(z))′|(cid:16)K0v(0)
xx(cid:12)(cid:12)(cid:12) + Rd21(z)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12)(cid:17)
+ (T − t)|λ(z)λ′(z)|(cid:16)ed11(z)v(0)
= (T − t)n|(λ(z)λ′(z))′| (K0 + 1) + |λ(z)λ′(z)| (ed11(z) + K0d11(z) +ed01(z) + d21(z))o v(0)
where d12(z) = (T − t)n|(λ(z)λ′(z))′| (K0 + 1) + |λ(z)λ′(z)| (ed11(z) + K0d11(z) +ed01(z) + d21(z))o.

x +ed01(z)R(cid:12)(cid:12)(cid:12)v(0)

x + K0d11(z)v(0)

= d12(z)v(0)
x ,

x + Rxv(0)

xz + Rzv(0)

xx + Rv(0)

x + Rv(0)

x + v(0)

x

29

(8) Diﬀerentiating (3.8) with respect to z gives:

|Rzz| = (T − t)(cid:12)(cid:12)(λ(z)λ′(z))′R2Rxx + λ(z)λ′(z)(R2Rxxz + 2RRzRxx)(cid:12)(cid:12)
≤ (T − t)n|(λ(z)λ′(z))′| K1R + |λ(z)λ′(z)| (eK1(z)R + 2K1ed01(z)R)o
= (T − t)n|(λ(z)λ′(z)′)| K1 + |λ(z)λ′(z)| (eK1(z) + 2K1ed01(z))o R
= ed02(z)R,

where ed02(z) = (T − t)n|(λ(z)λ′(z))′| K1 + |λ(z)λ′(z)| (eK1(z) + 2K1ed01(z))o. Here eK1(z) is the bound

of RRxxz, i.e. ∀(t, x, z) ∈ [0, T ] × R+R,

and is computed by diﬀerentiating (3.8) with respect to x twice:

|RxxzR| ≤ eK1(z),

(C.1)

|RxxzR| = (T − t)|λ(z)λ′(z)|(cid:12)(cid:12)RxxxxR3 + 4R2RxRxxx + 2RR2

≤ (T − t)|λ(z)λ′(z)| (K3 + 4K0K2 + 2K 2

0 K1 + 2K 2

xx(cid:12)(cid:12)

xRxx + 2R2R2

1 ) = eK1(z).

(9) Diﬀerentiating v(0)

xzz with respect to x again, we achieve:

xx + Rv(0)

x + Rv(0)

x + Rxv(0)

xz + Rzv(0)

x + 2Rxv(0)

xx + Rxxv(0)

xx(cid:17)x

x + 2Rxzv(0)

(cid:12)(cid:12)(cid:12)v(0)
xxzz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)(λ(z)λ′(z))′(cid:16)Rxv(0)
+ λ(z)λ′(z)(cid:16)Rxzv(0)
≤ (T − t)|(λ(z)λ(z))′|(cid:12)(cid:12)(cid:12)Rxxv(0)
xxx(cid:12)(cid:12)(cid:12)
+ (T − t)|λ(z)λ′(z)|(cid:12)(cid:12)(cid:12)Rxxzv(0)
≤ (T − t)|(λ(z)λ′(z))′| (RxxR + 2K0 + (K0 + 1))(cid:12)(cid:12)(cid:12)v(0)
·(cid:16)(cid:12)(cid:12)(cid:12)RxxzRv(0)
xx(cid:12)(cid:12)(cid:12) + 2ed11(z)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) + d11(z)(cid:12)(cid:12)(cid:12)Rxx(z)v(0)
≤ (T − t)|(λ(z)λ′(z))′| (K1 + 3K0 + 1)(cid:12)(cid:12)(cid:12)v(0)
·(cid:16)eK1(z) + 2ed11(z) + d11(z)K1 + 2d21(z)K0 +ed01(z)(K0 + 1) + eK31(z)(cid:17)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12)
= d22(z)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ,

xx(cid:12)(cid:12)(cid:12) + (T − t)|λ(z)λ′(z)|
x (cid:12)(cid:12)(cid:12) + 2d21(z)(cid:12)(cid:12)(cid:12)Rxv(0)

xx(cid:12)(cid:12)(cid:12) + (T − t)|λ(z)λ′(z)|

xz + 2Rxv(0)

xxz + Rzv(0)

xx + Rv(0)

xxx + Rv(0)

xxz(cid:17)x(cid:12)(cid:12)(cid:12)
xxxz(cid:12)(cid:12)(cid:12)
xx(cid:12)(cid:12)(cid:12) + ed01(z)(cid:12)(cid:12)(cid:12)Rv(0)
xxx(cid:12)(cid:12)(cid:12) +(cid:12)(cid:12)(cid:12)Rv(0)
xxxz(cid:12)(cid:12)(cid:12)(cid:17)

where

d22(z) =(T − t)n|(λ(z)λ′(z))′| (K1 + 3K0 + 1) + |λ(z)λ′(z)|(cid:16)eK1(z) + 2ed11(z) + d11(z)K1 + 2d21(z)K0

During the derivation we have used the inequalities:

+ed01(z)(K0 + 1) + eK31(z)(cid:17)o .
xx(cid:12)(cid:12)(cid:12) ≤ K1(cid:12)(cid:12)(cid:12)v(0)
(cid:12)(cid:12)(cid:12)Rxxv(0)
xx(cid:12)(cid:12)(cid:12) ,
x (cid:12)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12)RxxRv(0)
(cid:12)(cid:12)(cid:12)Rv(0)
xxx(cid:12)(cid:12)(cid:12) = (Rx + 1)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ≤ (K0 + 1)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ,
(cid:12)(cid:12)(cid:12)Rv(0)
xxxz(cid:12)(cid:12)(cid:12) ≤ eK31(z)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ,
xx(cid:12)(cid:12)(cid:12) ≤ (K1 + 2K 2

0 + 3K0 + 1)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) ,

xx + 2(Rx + 1)2v(0)

x − (Rx + 1)v(0)

30

(C.2)

(C.3)

(C.4)

To obtain the last one, we ﬁrst claim:

xxxx(cid:12)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12)Rxxv(0)
(cid:12)(cid:12)(cid:12)R2v(0)

and then, the last inequality (C.4) follows by:

xx + 3RRxv(0)

x + 3RRxxv(0)

(cid:12)(cid:12)(cid:12)Rv(0)
xxxz(cid:12)(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)RRxxxv(0)
≤ (T − t)|λ(z)λ′(z)|(cid:16)(cid:12)(cid:12)R2Rxxx(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) + 3K0(cid:12)(cid:12)(cid:12)Rv(0)
≤ (T − t)|λ(z)λ′(z)|(cid:0)K2 + 3K1 + 3K0(K0 + 1) + K1 + 2K 2
where eK31(z) = (T − t)|λ(z)λ′(z)|(cid:0)K2 + 4K1 + 5K 2

xx(cid:12)(cid:12)(cid:12) + 3K1(cid:12)(cid:12)(cid:12)v(0)
0 + 6K0 + 1(cid:1).

xzz with respect to z again and obtain:

(10) Finally, we diﬀerentiate v(0)

xxxx(cid:17)(cid:12)(cid:12)(cid:12)
xxx(cid:12)(cid:12)(cid:12) +(cid:12)(cid:12)(cid:12)R2v(0)
xxxx(cid:12)(cid:12)(cid:12)(cid:17)
0 + 3K0 + 1(cid:1)(cid:12)(cid:12)(cid:12)v(0)
xx(cid:12)(cid:12)(cid:12) = eK31(z),

xxx + R2v(0)

v

(0)

xzzz = (T − t)n(λ(z)λ′(z))′′ (cid:16)Rxv

(0)
x + Rv

(0)

xx (cid:17) + 2(λ(z)λ(z)′ )′ (cid:16)Rx v

(0)
x + Rv

(0)

xx (cid:17)z

+ λ(z)λ′(z) (cid:16)Rxz v

(0)
x + Rxv

(0)
xz + Rz v

(0)
xx + Rv

(0)

xxz(cid:17)zo

Taking absolute value on both sides,

x + Rxv(0)

xz + Rzv(0)

xx + Rv(0)

xx + 2Rzv(0)

xxz + Rv(0)

xz + Rxv(0)

xzz + Rzzv(0)

x + 2Rxzv(0)

xxzz)o

≤ (T − t)v(0)

+ λ(z)λ′(z) ·(Rxzzv(0)

x + 2(cid:12)(cid:12)(cid:12)(λ(z)λ′(z))′(Rxzv(0)

(cid:12)(cid:12)(cid:12)v(0)
xzzz(cid:12)(cid:12)(cid:12) ≤ (T − t)n|(λ(z)λ′(z))′′| (K0 + 1)v(0)

xxz)(cid:12)(cid:12)(cid:12)
x n|(λ(z)λ′(z))′′| (K0 + 1) + 2 |(λ(z)λ′(z))′| (ed11(z) + K0d11(z) +ed01(z) + d21(z))
+ λ(z)λ′(z) ·(eK12(z) + 2ed11(z)d11(z) + K0d12(z) +ed02(z) + 2ed01(z)d21(z) + d22(z))o .
d13(z) is easy to identify from the above inequality, in which eK12(z) is a bound uniform in t and x
Such eK12(z) exists by the following derivation:
Rxzz = (T − t)(λ(z)λ′(z))′(cid:0)R2Rxxx + 2RRxRxx(cid:1)

|Rxzz| ≤ eK12(z).

Every term is bounded (by a function of z) by previous results, except R2Rxxxz. For this term, we
derive:

+ (T − t)λ(z)λ′(z)(cid:0)R2Rxxxz + 2RRzRxxx + 2RRxRxxz + 2RxRzRxx + 2RRxzRxx(cid:1) .
xx(cid:17)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)R2Rxxxz(cid:12)(cid:12) = (T − t)(cid:12)(cid:12)(cid:12)λ(z)λ′(z)(cid:16)R4R(5) + 8R3RxxRxxx + 6R2R2

≤ (T − t)|λ(z)λ′(z)| (K4 + 8K1K2 + 6K 2

xRxxx + 6R3RxR(4) + 6R2RxR2

0 K2 + 6K0K3 + 6K0K 2

(C.5)

1 ).

D Proof of Boundedness for Theorem 3.1

We ﬁrst analyze term I in (3.13). The boundedness for the z-derivatives of v(0) is given by Proposition 3.6.
To bound the L2 norm of v(0)(·, X π(0)
, Z·) we rely on Lemma 2.13. In the following we omit the arguments
of v(0)(s, X π(0)
, Zs) and its derivatives.

·

s

c(Zs)v(0)

= I(1) +

1
2

I(2).

t

I = E(t,x,z)"Z T
(cid:12)(cid:12)(cid:12)I(1)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

c2(Zs)d2

≤ E
≤ C(T, z)C3(T, x, z).

t

(cid:12)(cid:12)(cid:12)c(Zs)v(0)

1
2

z +

g2(Zs)v(0)

zz ds# .
z (cid:12)(cid:12)(cid:12) ds# ≤ E(t,x,z)"Z T
(t,x,z)"Z T
01(Zs) ds# E

1/2

t

|c(Zs)d01(Zs)| v(0) ds#
t (cid:16)v(0)(cid:17)2

ds#

31

In the calculation above, v(0)
is replaced by its bound d01(z)v(0) derived in Proposition 3.6. By Cauchy-
Schwarz inequality, it suﬃces to bound two expectations. For the ﬁrst one, we have used the facts that
c(z) and d01(z) have at most polynomial growth and Zt admits moments of any order uniformly in δ.
Proposition 2.13 gives the bound for the second expectation.

z

The bounds of remaining terms are obtained by the same procedure, and we will sketch the calculation

without detailed explanation. Also, in what follows, we omit the arguments of R(s, X π(0)

s

; λ(Zs)).

(cid:12)(cid:12)(cid:12)I(2)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

g2(Zs)(cid:12)(cid:12)(cid:12)v(0)

zz(cid:12)(cid:12)(cid:12) ds# ≤ E(t,x,z)"Z T
(t,x,z)"Z T
02(Zs) ds# E
t (cid:16)v(0)(cid:17)2

1/2

t

g4(Zs)d2

≤ E
≤ C(T, z)C3(T, x, z).

t

ds#

g2(Zs)d02(Zs)v(0) ds#

Term II in (3.14) and term III in (3.15) contain derivatives in z of v(1). To deal with it, we recall the

following relation between v(1) and v(0) given by equation (2.16):

v(1) = −

1
2

(T − t)ρλ(z)g(z)

x v(0)
v(0)
xz
v(0)
xx

=

1
2

(T − t)ρλ(z)g(z)Rv(0)
xz .

Diﬀerentiating the above equation with respect to z, we are able to rewrite v(1)
zz in terms of
the risk tolerance function R and the leading order term v(0). Then, as before, the derivations are mainly
based on Proposition 3.6 and Lemma 2.13, and given as follows:

and v(1)

xz , v(1)

z

II = E(t,x,z)"Z T

t

c(Zs)v(1)

z +

1
2

g2(Zs)v(1)

zz ds#

(T − t)ρE(t,x,z)"Z T
(T − t)ρE(t,x,z)"Z T

ds#
c(Zs)(cid:16)λ(Zs)g(Zs)Rv(0)
xz(cid:17)z
xz(cid:17)zz
g2(Zs)(cid:16)λ(Zs)g(Zs)Rv(0)

1
4

t

t

ds#

(T − t)ρ II(1) +

(T − t)ρ II(2).

1
4

=

1
2

+

.
=

1
2

II(1) = E(t,x,z)"Z T
+ E(t,x,z)"Z T

c(Zs) (λ(Zs)g(Zs))z Rv(0)

xz ds#
c(Zs)λ(Zs)g(Zs)(cid:16)Rzv(0)

t

t

.
= II(1,1) + II(1,2) + II(1,3).

xz + Rv(0)

xzz(s, X π(0)

s

, Zs)(cid:17) ds#

where they are uniformly bounded since

(cid:12)(cid:12)(cid:12)II(1,1)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

≤ K0E

1/2

t

t

|c(Zs) (λ(Zs)g(Zs))z| K0X π(0)

s

d11(Zs)v(0)

c2(Zs)d2

11(Zs) (λ(Zs)g(Zs))2

x ds#
(t,x,z)"Z T

1/2

z ds# E

t (cid:16)v(0)(cid:17)2

ds# ≤ C(T, z)C3(T, x, z).

32

t

t

t

1/2

≤ K0E

(cid:12)(cid:12)(cid:12)II(1,2)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T
(cid:12)(cid:12)(cid:12)II(1,3)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T
II(2) = E(t,x,z)"Z T
+ 2E(t,x,z)"Z T
+ E(t,x,z)"Z T

≤ K0E

1/2

t

t

t

01(Zs)d2

x ds#
|c(Zs)λ(Zs)g(Zs)|ed01(Zs)Rd11(Zs)v(0)
(t,x,z)"Z T
11(Zs)λ2(Zs)g2(Zs) ds# E
c2(Zs)ed2
x ds#
|c(Zs)λ(Zs)g(Zs)| K0X π(0)
(t,x,z)"Z T

d12(Zs)v(0)

c2(Zs)d2

1/2

1/2

s

t

t (cid:16)v(0)(cid:17)2

g2(Zs) (λ(Zs)g(Zs))zz Rv(0)

12(Zs)λ2(Zs)g2(Zs) ds# E
xz ds#
g2(Zs) (λ(Zs)g(Zs))z(cid:16)Rzv(0)
g2(Zs)λ(Zs)g(Zs)(cid:16)Rzzv(0)

.
= II(2,1) + 2II(2,2) + 2II(2,3) + II(2,4) + 2II(2,5) + II(2,6).

t (cid:16)v(0)(cid:17)2

ds# ≤ C(T, z)C3(T, x, z).

ds# ≤ C(T, z)C3(T, x, z).

xz + Rv(0)

xzz(s, X π(0)

s

xz + 2Rzv(0)

xzz + Rv(0)

xzzz(s, X π(0)

s

, Zs)(cid:17) ds#

, Zs)(cid:17) ds#

(cid:12)(cid:12)(cid:12)II(2,1)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

g2(Zs)|(λ(Zs)g(Zs))zz| K0X π(0)

s

d11(Zs)v(0)

g4(Zs)d2

11(Zs) (λ(Zs)g(Zs))2

x ds#
(t,x,z)"Z T

1/2

zz ds# E

t (cid:16)v(0)(cid:17)2

ds#

(cid:12)(cid:12)(cid:12)II(2,2)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

g2(Zs)|(λ(Zs)g(Zs))z|ed01(Zs)R(x, X π(0)
z ds# E
g4(Zs)ed2

11(Zs) (λ(Zs)g(Zs))2

01(Zs)d2

s

; λ(Zs))d11(Zs)v(0)

x ds#
ds#
t (cid:16)v(0)(cid:17)2

1/2

(t,x,z)"Z T

(cid:12)(cid:12)(cid:12)II(2,3)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

g2(Zs)|(λ(Zs)g(Zs))z| K0X π(0)

s

d12(Zs)v(0)

g4(Zs)d2

12(Zs) (λ(Zs)g(Zs))2

x ds#
(t,x,z)"Z T

1/2

z ds# E

t (cid:16)v(0)(cid:17)2

ds#

33

(cid:12)(cid:12)(cid:12)II(2,4)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

x ds#
g2(Zs)|λ(Zs)g(Zs)|ed02(Zs)Rd11(Zs)v(0)
(t,x,z)"Z T
11(Zs)λ2(Zs)g2(Zs) ds# E
g4(Zs)ed2

02(Zs)d2

1/2

t (cid:16)v(0)(cid:17)2

(cid:12)(cid:12)(cid:12)II(2,5)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

x ds#
g2(Zs)|λ(Zs)g(Zs)|ed01(Zs)Rd12(Zs)v(0)
(t,x,z)"Z T
12(Zs)λ2(Zs)g2(Zs) ds# E
g4(Zs)ed2

01(Zs)d2

1/2

t (cid:16)v(0)(cid:17)2

ds#

ds#

(cid:12)(cid:12)(cid:12)II(2,6)(cid:12)(cid:12)(cid:12) ≤ E(t,x,z)"Z T
(t,z)"Z T

1/2

t

≤ K0E
≤ C(T, z)C3(T, x, z).

t

g2(Zs)|λ(Zs)g(Zs)| K0X π(0)

s

d13(Zs)v(0)

g4(Zs)d2

13(Zs)λ2(Zs)g2(Zs) ds# E

x ds#
(t,x,z)"Z T

1/2

t (cid:16)v(0)(cid:17)2

ds#

Similarly the term III deﬁned in (3.15) becomes:

III = E(t,x,z)(cid:20)Z T

t

λ(Zs)g(Zs)R(cid:18) 1

t

t

=

=

≡

1
2

1
2

+

1
2

(T − t)ρE(t,x,z)(cid:20)Z T
(T − t)ρE(t,x,z)(cid:20)Z T
(T − t)ρE(t,x)(cid:20)Z T
(T − t)ρ(cid:16)III(1) + III(2)(cid:17) +

1
2

t

2

(T − t)ρλ(Zs)g(Zs)Rv(0)

xz (cid:19)xz
xz + λ(Zs)g(Zs)(cid:16)Rzv(0)
λ(Zs)g(Zs)R(cid:16)(λ(Zs)g(Zs))′ Rv(0)
xzz(cid:17)(cid:17)x
λ(Zs)g(Zs) (λ(Zs)g(Zs))′ RRxv(0)
xz + λ(Zs)g(Zs) (λ(Zs)g(Zs))′ RRv(0)

xz + Rv(0)

ds(cid:21)

ds(cid:21)
xxz ds(cid:21)

λ2(Zs)g2(Zs)(cid:16)RRxzv(0)

xz + RRzv(0)

xxz + RRxv(0)
(T − t)ρ(cid:16)III(3) + III(4) + III(5) + III(6)(cid:17) .

1
2

xzz + R2v(0)

xxzz(cid:17) ds(cid:21)

Now we analyze them one by one:

(cid:12)(cid:12)(cid:12)
III(1)(cid:12)(cid:12)(cid:12)

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T

t

t

ds(cid:21)

λ(Zs)g(Zs)(λ(Zs)g(Zs))′RRxv(0)

xz (cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)λ(Zs)g(Zs)(λ(Zs)g(Zs))′(cid:12)(cid:12) K0X π(0)
(cid:0)λ(Zs)g(Zs)(λ(Zs)g(Zs))′d11(Zs)(cid:1)2 ds(cid:21) E1/2
t (cid:16)v(0)(t, X π(0)

, Zs)(cid:17)2

s K0d11(Zs)v(0)

s

t

≤ K 2

(t,x,z)(cid:20)Z T
0 E1/2

≤ C(T, z)E1/2

(t,x,z)(cid:20)Z T

x ds(cid:21) (Propositions 3.4 and 3.6)
(t,x,z)(cid:20)Z T

t (cid:16)X π(0)

x (cid:17)2

v(0)

s

ds(cid:21) (CS inequality)

ds(cid:21) (Bounded moments of Zs and concavity of v(0))

≤ C(T, z)C3(T, x, z) (Lemma 2.13) .

34

(cid:12)(cid:12)(cid:12)

III(2)(cid:12)(cid:12)(cid:12)

t

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T
(t,x,z)(cid:20)Z T

≤ CE1/2

t

t

ds(cid:21)

λ(Zs)g(Zs)(λ(Zs)g(Zs))′RRv(0)

xxz(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)(cid:12)
(cid:12)(cid:12)λ(Zs)g(Zs)(λ(Zs)g(Zs))′(cid:12)(cid:12) CX π(0)
(cid:0)λ(Zs)g(Zs)(λ(Zs)g(Zs))′d(Zs)(cid:1)2 ds(cid:21) E1/2
t (cid:16)v(0)(cid:17)2

s Rd(Zs)v(0)

ds(cid:21)

xx ds(cid:21)
(t,x,z)(cid:20)Z T

t (cid:16)X π(0)

s

≤ C(T, z)E1/2

(t,x,z)(cid:20)Z T

≤ C(T, z)C3(T, x, z).

(cid:12)(cid:12)(cid:12)
III(3)(cid:12)(cid:12)(cid:12)

t

(cid:12)(cid:12)(cid:12)

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T
(t,x,z)(cid:20)Z T

≤ CE1/2

t

t

≤ C(T, z)E1/2

λ2(Zs)g2(Zs)RRxzv(0)

ds(cid:21)

xz (cid:12)(cid:12)(cid:12)

λ2(Zs)g2(Zs)CX π(0)

s

d(Zs)Rxd(Zs)v(0)

x ds(cid:21)
t (cid:16)X π(0)

s Cv(0)

x (cid:17)2

(t,x,z)(cid:20)Z T

λ4(Zs)g4(Zs)d4(Zs) ds(cid:21) E1/2
t (cid:16)v(0)(cid:17)2

ds(cid:21)

(t,x,z)(cid:20)Z T

≤ C(T, z)C3(T, x, z).

v(0)

x (cid:17)2

ds(cid:21)

ds(cid:21)

(cid:12)(cid:12)(cid:12)
III(4)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

III(5)(cid:12)(cid:12)(cid:12)

t

(cid:12)(cid:12)(cid:12)

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T
(t,x,z)(cid:20)Z T

≤ CE

1/2

t

t

≤ C(T, z)E1/2

λ2(Zs)g2(Zs)RRzv(0)

ds(cid:21)

xxz(cid:12)(cid:12)(cid:12)

λ2(Zs)g2(Zs)CX π(0)

s

d(Zs)Rd(Zs)v(0)

λ4(Zs)g4(Zs)d4(Zs) ds(cid:21) E
t (cid:16)v(0)(cid:17)2

ds(cid:21)

(t,x,z)(cid:20)Z T

xx ds(cid:21)
t (cid:16)X π(0)

s

1/2

(t,x,z)(cid:20)Z T

v(0)

x (cid:17)2

ds(cid:21)

≤ C(T, z)C3(T, x, z).

t

(cid:12)(cid:12)(cid:12)

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T
(t,x,z)(cid:20)Z T

≤ C 2E1/2

t

≤ C(T, z)E1/2

λ2(Zs)g2(Zs)RRxv(0)

ds(cid:21)

xzz(cid:12)(cid:12)(cid:12)

λ2(Zs)g2(Zs)CX π(0)

s Cd2(Zs)v(0)
λ4(Zs)g4(Zs)d4(Zs) ds(cid:21) E1/2
t (cid:16)v(0)(cid:17)2

ds(cid:21)

t

(t,x,z)(cid:20)Z T

x ds(cid:21)
(t,x,z)(cid:20)Z T

t (cid:16)X π(0)

s

v(0)

x (cid:17)2

ds(cid:21)

≤ C(T, z)C3(T, x, z).

35

(cid:12)(cid:12)(cid:12)
III(6)(cid:12)(cid:12)(cid:12)

t

(cid:12)(cid:12)(cid:12)

≤ E(t,x,z)(cid:20)Z T
≤ E(t,x,z)(cid:20)Z T
(t,x,z)(cid:20)Z T

≤ CE1/2

t

t

≤ C(T, z)E1/2

λ2(Zs)g2(Zs)RRv(0)

ds(cid:21)

xxzz(cid:12)(cid:12)(cid:12)

λ2(Zs)g2(Zs)CX π(0)

s Rd2(Zs)v(0)
λ4(Zs)g4(Zs)d4(Zs) ds(cid:21) E1/2
t (cid:16)v(0)(cid:17)2

ds(cid:21)

xx ds(cid:21)
(t,x,z)(cid:20)Z T

(t,x,z)(cid:20)Z T

t (cid:16)X π(0)

s

v(0)

x (cid:17)2

ds(cid:21)

≤ C(T, z)C3(T, x, z).

E Assumptions in Section 4.2

x ds,

xz ds.

v(1)

v(0)
xx ds,

E(t,x,z)R T
E(t,x,z)R T
E(t,x,z)R T

This set of assumptions is used in deriving Proposition 4.4 where we establish the accuracy of approximation

notation, we systematically omit the argument (s, X π
we further require:

of eV δ summarized in Table 3.
Assumption E.1. Let A0(t, x, z)(cid:2)eπ0,eπ1, α(cid:3) be the family of trading strategies deﬁned in (4.1). Recall that
X π is the wealth generated by the strategy π = eπ0 + δαeπ1 as deﬁned in (4.3). In order to condense the
(i) If eπ0 ≡ π(0),

(a) If α > 1/4, the following quantities are uniformly bounded in δ:

s , Zs) in what follows. According to the diﬀerent cases,

(b) In the case 0 < α < 1/4, if (t, x, z) ∈ K1, we need

xx ds, E(t,x,z)R T
xz ds, E(t,x,z)R T

t µ(Zs)eπ1v(1)
t g(Zs)σ(Zs)eπ1v(1)

t Mv(0) ds, E(t,x,z)R T
t σ2(Zs)(cid:0)eπ1(cid:1)2

t g(Zs)σ(Zs)π(0)v(1)

case 0 < α < 1/4, and satisﬁes the linear PDE (4.12).
Otherwise if (t, x, z) ∈ C1, we only need

Here, recall that v(0) and v(1) are the leading order term and ﬁrst order correction of V δ as well
as of V π(0),δ, and they satisfy (2.11) and (2.13) respectively.

t Mv(0) ds, E(t,x,z)R T
t σ2(Zs)π(0)eπ1ev2α
t g(Zs)σ(Zs)π(0)ev2α
t Mv(0) ds, E(t,x,z)R T

t σ2(Zs)(cid:0)eπ1(cid:1)2
t Mv(1) ds, E(t,x,z)R T
xx ds, E(t,x,z)R T
t σ2(Zs)π(0)eπ1v(1)
xz ds, E(t,x,z)R T
t g(Zs)σ(Zs)eπ1v(0)
E(t,x,z)R T
t σ2(Zs)(cid:0)eπ1(cid:1)2
t Mev2α ds, E(t,x,z)R T
ev2α
E(t,x,z)R T
xx ds, E(t,x,z)R T
x ds, E(t,x,z)R T
t µ(Zs)eπ1ev2α
xz ds, E(t,x,z)R T
E(t,x,z)R T
t g(Zs)σ(Zs)eπ1v(0)
t g(Zs)σ(Zs)eπ1ev2α
to be uniformly bounded in δ, where ev2α is the coeﬃcient of δ2α in the expansion of eV δ in the
E(t,x,z)R T
t Mv(1) ds, E(t,x,z)R T
1/4, except the sixth one which is not needed. Then, the term ev2α becomes ev(1), which is the
coeﬃcient of √δ in the expansion and satisﬁes (4.11).
(ii) If eπ0 6≡ π(0),
E(t,x,z)R T
E(t,x,z)R T

ev(0)
x ds, whereev(0) is the leading order solution
(b) For (t, x, z) in the region C, whereeπ0 and π(0) are identical, requirements are the same as in part

t g(Zs)σ(Zs)(cid:0)eπ0 + δαeπ1(cid:1)2
t µ(Zs)eπ1ev(0)

(a) For (t, x, z) in the region K, the following quantities need to be uniformly bounded in δ:

t Mev(0) ds, E(t,x,z)R T
t σ2(Zs)eπ0eπ1ev(0)

xz ds, E(t,x,z)R T
ev(0)

t σ2(Zs)(cid:0)eπ1(cid:1)2

(c) For the critical case α = 1/4, we need all the above assumptions in part (ib) with α replaced by

(i) with (t, x, z) restricted to be in C.

xx ds, E(t,x,z)R T

xz ds, E(t,x,z)R T

xx ds,
t g(Zs)σ(Zs)π(0)v(0)

xz ds,

t g(Zs)σ(Zs)π(0)v(1)

xz ds, to be uniformly

that satisﬁes (4.8).

bounded.

xz ds,

xx ds,

36

F Uniform Bound for Aδ(τ ) Solution of (5.18)

In order to apply Lemma 5.1 to (5.18), we identify q0, q1, q2 as follows and compute ∆:

q0 =

∆ =

q1 =

2√δρµβ
(3 − 2γ)µ2
1 − γ − δ,
(1 − γ)2 ,
(1 − γ)2(cid:0)2ρ2 − 3 + 2γ(cid:1) − 4δ3/2 ρµβ

2δβ2µ2

1 − γ

q2 =

δ
2

β2,

+ δ2.

(F.1)

(F.2)

Note that if ∆ > 0, by Lemma 5.1 (i), we have α+α− > 0 and α+ + α− = sgn(−ρ) if ρ 6= 0 and positive
otherwise. It remains to prove i) there exists δ, such that τ ⋆(δ) > T for δ ≤ δ, (recall that τ ⋆(δ) is deﬁned
to be the explosion time) and ii) limδ→0 Aδ(τ ) exists. This is done in the various cases depending on the
values of the exponent γ of the power utility and the correlation coeﬃcient ρ.

Denote by δ0 a constant such that when δ < δ0, the ﬁrst term of ∆ is dominant, and in case the ﬁrst

term is zero, the second term is dominant. Recall that 0 < γ < 1, we now examine the following cases:

A) 1

2 ≤ γ < 1.
a) −1 ≤ ρ < −√1.5 − γ. If γ = 1

2 , this case is empty.

In this case, ∆ is positive, Aδ(τ ) lies in type (5.4), and τ ⋆(δ) = ∞ for δ ∈ (0, δ0]. The last claim
follows by α+ > α− > 0 and 1 − α−
e−ατ > 0,∀ τ ∈ [0, T ]. Therefore we could deﬁne δ to be δ0,
and the limit of Aδ(τ ) is obtained by straightforward calculation:

α+

Aδ(τ ) = −q1 − α

2q2

(−q1 − α)

=

2q2

ατ + O(δ)

−q1+α (1 − ατ + O(δ))

1 − −q1−α
(−q1 + α)ατ + O(δ)

2α + O(δ)

→ q0τ, as δ → 0.

(F.3)

(F.4)

Under the situation ρ = −√1.5 − γ, the ﬁrst term in ∆ vanishes and the second term is dominant,
which still gives the positiveness of ∆. So this case is similar to the previous one: positive ∆, α+ >
.
= δ, except for a slight diﬀerence in computing limδ→0 Aδ(τ ) =
α− > 0 and τ ⋆(δ) = ∞ for δ ≤ δ0
q0τ .

b) ρ = −√1.5 − γ.

c) −√1.5 − γ < ρ < 0.

In case c) - f), ∆ is negative, thus Aδ(τ ) lies in type (5.5). In addition, discussion in e)-f) are parallel
to case c) and d). For ρ negative, we have a = q1/2 negative, and τ ⋆(δ) = π
further restrict the value of δ to [0, δ], so that τ ⋆(δ) > T . In other words, for suﬃcient small δ ≤ δ,
Aδ(τ ) and Bδ(τ ) still stay ﬁnite on [0, T ]. To this end, it suﬃces to show limδ→0 τ ⋆(δ) = +∞:

a(cid:1). Now we

b arctan(cid:0) b

b + 1

arctan(cid:18) b

τ ⋆(δ) = lim

a(cid:19) = arctan p2(3 − 2γ − 2ρ2)
a(cid:19)(cid:27) = lim
δ→0(cid:26) π

arctan(cid:18) b

1
b

2ρ

+

b

! ,

lim
δ→0

lim
δ→0

δ→0(cid:26) π + arctan(b/a)

b

(F.5)

(F.6)

(cid:27) = +∞.

Therefore Aδ(τ ) is continuous on [0, T ] × (0, δ], and the problem is reduced to show the ﬁniteness
of limδ→0 Aδ(τ ). Straightforward calculation yields:

lim
δ→0

Aδ(τ ) = lim
δ→0

q0

3

bτ + O(δ
2 )
b + O(δ)

= q0τ.

(F.7)

d) ρ = 0.

37

If ρ = 0, a = −δ/2 is still negative, and we still have τ ⋆(δ) = π
is the same as in case c) except calculations in (F.5) and (F.6).

b + 1

b arctan(cid:0) b

a(cid:1). The argument here

arctan(cid:18) b

τ ⋆(δ) = lim

a(cid:19) = arctan(cid:18)−δ−1/2 2βµ
δ→0(cid:26) π

1 − γp2(3 − 2γ − 2ρ2))(cid:19) = −π/2,
(cid:27) = +∞.
a(cid:19)(cid:27) = lim

δ→0(cid:26) π + arctan(b/a)

arctan(cid:18) b

1
b

+

b

b

lim
δ→0

lim
δ→0

(F.8)

(F.9)

(F.10)

The last step follows by that the top converge to π/2 and the bottom converges to 0.

Now both a and b are positive, and τ ⋆(δ) = 1
yields limδ→0 τ ⋆(δ) = +∞. So we could still choose δ, such that τ ⋆(δ) > T for δ ∈ (0, δ]. Then the
problem is still reduced to the ﬁniteness of limδ→0 Aδ(τ ), which is proved by (F.7).

a(cid:1). Similar calculation as (F.5) and (F.6)

b arctan(cid:0) b

e) 0 < ρ < √1.5 − γ.

f) ρ = √1.5 − γ.

(F.11)

(F.12)

3

4 )(cid:19)(cid:27) = +∞.

In this case the ﬁrst term of ∆ vanishes and the second term is dominant. Therefore ∆ is negative,
and solutions to Aδ(τ ) and Bδ(τ ) lie in type (5.5). This case is similar to case e), where both a and
b are positive and τ ⋆(δ) = 1

a(cid:1), except the calculation in (F.5) and (F.6).

3

=

=

q1

b
a

√−∆

4 + O(δ
1−γ − δ

b arctan(cid:0) b
2q ρµβ
1−γ δ
√δ 2ρµβ
arctan(cid:18) b
δ→0(cid:26) 1
g) √1.5 − γ < ρ ≤ 1. If γ = 1
α ln(cid:16) α+

The last step holds since b is of order δ

τ ⋆(δ) = lim

lim
δ→0

b

1

δ

5
4 )

ρµβ

=r 1 − γ
δ→0(cid:26) 1
a(cid:19)(cid:27) = lim
4 and arctan(cid:0) b

3

4 + O(δ

3
4 ),

4 + O(δ

1

δ

ρµβ

b(cid:18)r 1 − γ
a(cid:1) is of order δ

1
4 .

2 , this case is empty.

In this case, ∆ becomes positive again, and Aδ(τ ) is of type (5.4). However here α− < α+ < 0,
and τ ⋆(δ) = − 1
computation of limδ→0 Aδ(τ ) in a), we still capable to achieve the conclusion that Aδ(τ ) is bounded
on [0, T ] × [0, δ]. Such δ exists since

α−(cid:17). If we could pick δ, such that τ ⋆(δ) > T , for δ ≤ δ, then combining the

τ ⋆(δ) = −

1
α

−q1 − α(cid:19) =
ln(cid:18)−q1 + α

κ + O(δ1/2)

α

→ +∞, as δ → 0

(F.13)

where κ is a positive constant free of δ deﬁned as:

κ = lim
δ→0

α−(cid:19) .
ln(cid:18) α+

B) 0 ≤ γ < 1

2 , where ∆ is always negative.

a) −1 ≤ ρ < 0. The discussion here is the same as A)c).
b) ρ = 0. The discussion here is the same as A)d).
c) 0 < ρ ≤ 1. The discussion here is the same as A)e).
We have shown that for all cases Aδ(τ ) is uniformly bounded in [0, δ] × [0, T ], say by C(T), then again

via (5.19), we achieve the uniform bound for Bδ(τ ):

That concludes the veriﬁcation of Assumption 2.11 (iv).

Bδ(τ ) ≤ δmC(T )T ≤ mC(T )T.

38

References

L. B. Andersen and V. V. Piterbarg. Moment explosions in stochastic volatility models. Finance and

Stochastics, 11(1):29–50, 2007.

G. Chacko and L. M. Viceira. Dynamic consumption and portfolio choice with stochastic volatility in

incomplete markets. Review of Financial Studies, 18(4):1369–1402, 2005.

J. C. Cox and C. Huang. Optimal consumption and portfolio policies when asset prices follow a diﬀusion

process. Journal of economic theory, 49:33–83, 1989.

J. Cvitanic and I. Karatzas. On portfolio optimization under ”drawdown” constraints. IMA volumes in

mathematics and its applications, 65:35–35, 1995.

R. Elie and N. Touzi. Optimal lifetime consumption and investment under a drawdown constraint. Finance

and Stochastics, 12:299–330, 2008.

J.-P. Fouque and R. Hu. Asymptotic methods for portfolio optimization problem in multiscale stochastic

enviroments, 2016. In preparation.

J.-P. Fouque, G. Papanicolaou, R. Sircar, and K. Solna. Multiscale Stochatic Volatility for Equity, Interest-

Rate and Credit Derivatives. Cambridge University Press, 2011.

J.-P. Fouque, R. Sircar, and T. Zariphopoulou. Portfolio optimization & stochastic volatility asymptotics.

Mathematical Finance, 2016.

S. J. Grossman and Z. Zhou. Optimal investment strategies for controlling drawdowns. Mathematical

Finance, 3:241–276, 1993.

P. Guasoni and J. Muhle-Karbe. Portfolio choice with transaction costs: a users guide. In Paris-Princeton

Lectures on Mathematical Finance 2013, pages 169–201. Springer, 2013.

F. John. Partial diﬀerential equations, volume 1 of Applied Mathematical Sciences. Springer-Verlag, New

York, 1982.

S. K¨allblad and T. Zariphopoulou. Qualitative analysis of optimal investment strategies in log-normal

markets. Available at SSRN 2373587, 2014.

I. Karatzas and S. E. Shreve. Methods of Mathematical Finance. Springer Science & Business Media, 1998.

I. Karatzas, J. P. Lehoczky, and S. E. Shreve. Optimal portfolio and consumption decisions for a “small

investor” on a ﬁnite horizon. SIAM journal on control and optimization, 25(6):1557–1586, 1987.

M. J. Magill and G. M. Constantinides. Portfolio selection with transactions costs. Journal of Economic

Theory, 13:245–263, 1976.

R. C. Merton. Lifetime portfolio selection under uncertainty: The continuous-time case. Review of Eco-

nomics and statistics, 51:247–257, 1969.

R. C. Merton. Optimum consumption and portfolio rules in a continuous-time model. Journal of economic

theory, 3(4):373–413, 1971.

W. Schachermayer. Portfolio optimization in incomplete ﬁnancial markets. Cattedra Galileiana, 2004.

T. Zariphopoulou. Optimal investment and consumption models with non-linear stock dynamics. Mathe-

matical Methods of Operations Research, 50(2):271–296, 1999.

39

