6
1
0
2

 
r
a

 

M
2
1

 
 
]
T
G
.
s
c
[
 
 

1
v
6
5
9
3
0

.

3
0
6
1
:
v
i
X
r
a

Asymptotically Optimal Distributed Channel
Allocation: a Competitive Game-Theoretic

Approach

Ilai Bistritz

Department of Electrical Engineering-Systems

Tel-Aviv University, Israel
Email: ilaibist@gmail.com

Amir Leshem

Faculty of Engineering

Bar-Ilan university, Ramat-Gan, Israel

Email: leshema@eng.biu.ac.il

Abstract—In this paper we consider the problem of dis-
tributed channel allocation in large networks under the
frequency-selective interference channel. Performance is mea-
sured by the weighted sum of achievable rates. First we present
a natural non-cooperative game theoretic formulation for this
problem. It is shown that, when interference is sufﬁciently
strong, this game has a pure price of anarchy approaching
inﬁnity with high probability, and there is an asymptotically in-
creasing number of equilibria with the worst performance. Then
we propose a novel non-cooperative M Frequency-Selective
Interference Game (M-FSIG), where users limit their utility
such that it is greater than zero only for their M best channels,
and equal for them. We show that the M-FSIG exhibits, with
high probability, an increasing number of optimal pure Nash
equilibria and no bad equilibria. Consequently, the pure price
of anarchy converges to one in probability in any interference
regime. In order to exploit these results algorithmically we
propose a modiﬁed Fictitious Play algorithm that can be
implemented distributedly. We carry out simulations that show
its fast convergence to the proven pure Nash equilibria.

I. INTRODUCTION

Channel allocation, the problem of assigning frequency
bands to users, is a fundamental element in wireless net-
works. Channel allocation is necessary when channel access
is through frequency division techniques such as FDMA
or the more recent bandwidth efﬁcient technique OFDMA.
Other approaches, based on iterative water ﬁlling (IWF, see
[1]), allow users to allocate their power over the spectrum as
a whole. It is well-known that IWF leads to a FDMA solu-
tion for strong interference, and hence is more suitable for
weak interference and is generally considered more complex.
When splitting the channel into sub-channels, the question
of how to assign these sub-channels to users arises. In
the frequency-selective interference channel, different users
experience different conditions in each channel due to fading
and interference, so different allocations will result in varying
levels of performance.

At ﬁrst glance, it may seem that channel allocation is
a special case of resource allocation and as such can be
solved as an optimization problem. If N is the number
of users and resources, the optimal permutation between
them can be found with a complexity of O(N 3), using the
famous Hungarian Algorithm [2]. The basic problem with
this approach is the information required to compute the

optimal solution. To do so, some network entity (the base
station, access point, etc) needs to know the preferences for
all nodes. This entity should compute the optimal solution
and transmit it back to the nodes. In a wireless environment,
these preferences are not constant so this central knowledge
involves signiﬁcant communication overhead on the network.
As networks grow larger, this requirement becomes less rea-
sonable. Furthermore, future networks (like ad-hoc networks
and cognitive radio) are envisioned to be more distributed in
nature and less dependent on central entities. This leads to
the need for a distributed channel allocation algorithm.

Recently,

it has been shown that

the optimal solution
to the channel allocation problem can be achieved using
a distributed algorithm [3], [4], [5]. This algorithm is a
distributed version of the auction algorithm [6] and relies on
a CSMA protocol. Although it has a very slow convergence
rate, this result serves as a proof of concept and suggests that
other approaches may achieve close to optimal performance
in a distributed fashion. In [7],
the authors designed an
algorithm based on the stable matching concept that also
uses a CSMA protocol. This algorithm has a much faster
convergence rate and a good sum-rate performance. Due to
their dependence on CSMA, both algorithms are vulnerable
to the hidden terminal and exposed terminal problems. In
order to avoid these problems, a RTS/CTS mechanism has
to be implemented. Besides causing delays, RTS/CTS imple-
mentation requires some central network entities, and thus
negatively impact the network scalability. Additionally, both
algorithms have strong user synchronization requirements.
Last, but not
these algorithms ignore the inherent
possibility of sharing channels between users.

least,

There has been a considerable amount of work designed
to apply game theory as a framework for distributed chan-
nel allocation algorithms (see [8], [9]). While game theory
addresses the distribution requirement naturally, it does not
guarantee good global performance. For example, it is well-
known that the ﬁxed points for the IWF algorithm are the
Nash equilibrium points of the Gaussian interference game.
For a two-user Gaussian interference game, a prisonerâ ˘A ´Zs
dilemma may occur which leads to a suboptimal solution
[10]. To overcome this obstacle, some form of cooperation
can be added using different game theoretic concepts. In

[11] the authors proposed a potential game theoretic for-
mulation that requires each user to know the interference
he causes to other users. In [12] the authors used the Nash
bargaining solution and coalitions to enhance the fairness
of the allocation at the price of a centralized architecture.
In [13] and [14], a more stable algorithm to obtain the
Nash bargaining solution was proposed, based on convex
optimization techniques. Although cooperation can indeed
enhance performance, it may be extremely complicated to
achieve cooperative game-theoretic solution concepts in the
general case without communication between users, which
limits the distributed nature of the network.

The rest of this paper is organized as follows. In section
II we formulate our wireless network scenario and present
our approach. In section III we present a natural game
formulation for this problem and show that it suffers from
major drawbacks. In section IV we propose an enhanced
game and provide its equilibria analysis. Section V suggests
an algorithm each user can implement in a distributed fashion
to converge to these equilibria. In section VI we present
simulations of our proposed algorithm that show fast conver-
gence to the proven equilibria. Finally, we draw conclusions
in section VII.

II. PROBLEM FORMULATION

Consider a wireless network consisting of N transmitter-
receiver pairs (users) and K frequency bands (channels).
Each user forms a link between his transmitter and receiver
using a single frequency band. The channel between each
transmitter and receiver is Gaussian frequency-selective and
we assume that each frequency band is smaller than the
coherence bandwidth of the channel. We also assume that
the coherence time is large enough so that the channel gains
can be considered static for a sufﬁciently long time.

The channel gains (fading coefﬁcients) are modeled as
N 2K independent random variables - one for each channel,
each transmitter and each receiver. The coefﬁcient between
user ns transmitter and user ms receiver in channel k is
denoted hn,m,k. We also assume that hm,n,1, ..., hm,n,K are
identically distributed for each m, n = 1, ..., N .

Note that N K of these coefﬁcients serve as channel
coefﬁcients between a transmitter and receiver pair and are
denoted for convenience by hn,k for user n in channel k.
The other N K(N − 1) coefﬁcients serve as interference
coefﬁcients between transmitters and unintended receivers.
In this paper we assume N = K for simplicity.

Each user has some preferred order of the K channels.
Due to the independence of the channel coefﬁcients between
users, these preference lists are different and independent
between users. Note that this preference order considers only
the absolute value of the channel coefﬁcient and not the
interference (which indeed affects the achievable rate). We
denote by hn,(N −i+1) the i-th best channel coefﬁcient for
user n (so hn,(1) is the worst channel).

We assume that each user has perfect channel state in-
formation (CSI) of all his K channel coefﬁcients, which he
can achieve using standard estimation techniques. In addition

we assume that each user can sense the exact interference
he experiences in each channel. Nevertheless, users do not
have any knowledge about the channel coefﬁcients of other
users or about any of the interference coefﬁcients. There is no
central entity of any sort that knows the channel coefﬁcients
of all users. Note that, in contrast to [4] and [7], we do not
prohibit two or more users in the same channel.

Our global performance metric is the weighted sum of
achievable rates while treating interference as noise. Denote
by a the allocation vector (soon to be called the strategy
proﬁle), s.t. an = k if user n is using channel k. We want
to maximize the following performance function over all
possible allocations

W (a) =

N

Xn=1

wn log2(cid:18)1 +

Pn|hn,an|2

N0 + In,an (a−n)(cid:19)

where N0 is the Gaussian noise variance which is assumed
to be the same for all users, Pn is user ns transmission power
|hm,n,k|2Pm is the interference

and In,k (a−n) = Pm|am=k

user n experiences in channel k. We assume that the weights
satisfy wmin ≤ wn ≤ wmax for some wmin, wmax > 0, for
all n.

We want to ﬁnd a fully distributed way to achieve close
to optimal solutions for our channel allocation problem.
Hence we need to analyze the interaction that results from
N independent decision makers and ensure that the outcome
is desirable. The natural way to tackle this problem is by
applying game theory.

Deﬁnition 1. A normal-form game is deﬁned as the tuple

G =< N , {An}n∈N , {un}n∈N >

where N is the set of players, An is the set of pure strategies
of player n and un : A1 ×...×AN → R is the utility function
of player n.

Game theory aims at analyzing the possible outcomes of
a given interaction using solution concepts. The best known
solution concept is the celebrated Nash Equilibrium (NE).

Deﬁnition 2. A strategy proﬁle (a∗
is called a pure Nash equilibrium (PNE) if un(a∗
un(an, a∗

−n) for all an ∈ An and all n ∈ N .

n, a∗

−n) ∈ A1 × ... × AN
−n) ≥

n, a∗

This means that for each player n, if the other players act
according to the equilibrium, player n can not improve his
utility with another strategy. A game may exhibit multiple
pure NE or none at all.

A more general notion of an equilibrium is the mixed Nash
equilibrium, which is a probability assignment on the pure
strategies set. It is well known that in any game with a ﬁnite
number of players and ﬁnite strategy spaces, there exists a
mixed NE [15]. We choose to avoid the notion of mixed NE
due to its lack of practical meaning as a solution for the
channel allocation problem.

In our case, the players are users (through their receiver)
and the set of strategies for each player is the set of channels.
The choice of the utility function is a more delicate issue.

One of our goals in this work is to show that this degree of
freedom in the choice of the utility function can be exploited
to achieve better global performance without inducing co-
ordination between the users. Thus we distinguish between
the global performance metric and the utility function each
user aims to maximize, and we view the dynamic of the game
solely as an algorithmic tool to converge to the desired steady
state point (NE) in terms of global performance.

Unfortunately, not every game formulation has nice equi-
libria in terms of both tractability and performance. The
notion of NE helps us predict the outcome of the result-
ing interaction between programmed distributed agents. The
problem of tuning the dynamics to a desired equilibrium
among all existing NE (equilibrium selection) is generally
difﬁcult and may require some coordination between the
users. For this reason, a game formulation that results in a
simple and robust equilibrium is desirable. The cost of this
uncertainty on the resulting NE is often measured by the
price of anarchy, deﬁned as follows.

Deﬁnition 3. The pure price of anarchy (PPoA) of a game
G =< N , {An}n∈N , {un}n∈N > with the performance
, where
function W : A1 × ... × AN → R is
Ep is the set of PNE.

a∈A1 ×...×AN

min
a∈Ep

W (a)

W (a)

max

It is not hard to think of special cases of interference
networks that have bad equilibria or no pure equilibria at all.
We are interested in the vast majority of networks as dictated
by the fading distribution, especially in large networks.
Therefore, our approach is probabilistic and asymptotic in
the number of users N (i.e. will produce results in the “with
high probability” sense).

III. THE NAIVE FREQUENCY-SELECTIVE INTERFERENCE

GAME

Given our performance metric, a natural choice for the
utility of each user is his achievable rate. This choice makes
the weighted sum-rate the weighted social welfare of the
game. This means that in this game we do not exploit the
degree of freedom when choosing the utility function and
hence we call this the “naive game”. This naivetÃl’ can be
interpreted as selﬁshness of the users and we will show that
it may lead to poor global performance.

Deﬁnition 4. The Naive Frequency-Selective Interference
Game (Naive-FSIG) is a normal-form game with N users
as players, where each has An = {1, 2, ..., K} as a strategy
space. The utility function for player n is

un (a) = log2(cid:18)1 +

Pn|hn,an|2

N0 + In,an (a−n)(cid:19)

In this section we analyze the PNE of the Naive-FSIG
for strong interference and evaluate the PPoA. Trivially,
a user who obtained his best channel without interference
cannot improve his utility. On the other hand, a user who
is not in his best channel (with the best channel coefﬁcient)
cannot necessarily improve his utility if there are users in his
more preferable channels. The inﬂuence of other users in the

channel of user n on his utility is caused by the interference.
Consequently, the strength of the interference has a crucial
effect on the identity of the NE.

If the interference is strong enough, users in the same
channel achieve negligible utility and the interference game
becomes a “collision game”.

Lemma 5. If 1
N0

min

k

|hn,k|2 > max

l

|hn,l|2

N0+min

m (|hm,n,l|2Pm)

for

each n, then the set of PNE of the Naive-FSIG is the set of
permutations between users and channels, with cardinality
N !.

Proof: The inequality condition means that for every
strategy proﬁle that is a permutation of users to channels,
a user who deviates gets lower utility. Consequently, ev-
ery permutation is an equilibrium. Conversely, every pure
equilibrium must be a permutation because all users prefer
an empty channel over a shared one (i.e. with positive
interference).

The lemma above implies that in strong enough interfer-
ence, a PNE of the Naive-FSIG may assign some users a bad
channel. The next lemma shows that a bad channel can be
asymptotically useless.

MN

lim
N→∞

Lemma 6. Assume that |hn,1| , ..., |hn,N | are i.i.d for each
n, with continuous distribution Fn (x), s.t. Fn (x) > 0 for all
x > 0. Let MN be a sequence s.t.
N = 0. If m ≤ MN
then max

n (cid:12)(cid:12)hn,(m)(cid:12)(cid:12) → 0 in probability as N → ∞.

Proof: Let ε > 0. Due to the i.i.d assumption, the
number Nε,n of r.v. from |hn,1| , ..., |hn,N | that are smaller
than ε has a binomial distribution with pn = Pr (|hn,1| < ε).
We use the Chernoff-Hoeffding Theorem [16] as a tail bound
for MN
N < pn holds
for all N > N1 for some large enough N1, and so

N < pn. By the assumption on MN , MN

Pr (Nε,n ≤ MN ) ≤ exp(cid:18)−N D(cid:18) MN

N

kpn(cid:19)(cid:19)

where D(qkp) = q ln q

p + (1 − q) ln 1−q

1−p , and in our case

D(cid:18) MN

N

kpn(cid:19) =

MN
N

ln

MN
N pn

+(cid:18)1 −

MN

N (cid:19) ln

1 − MN
N
1 − pn

for which

ln N
MN
N
MN

lim
N→∞

D(cid:18) MN

N

N→∞

MN
N

kpn(cid:19) = − lim
+ ln(cid:18) 1
N (cid:19) ln(cid:18)1 −

MN

MN

+ lim

− ln pn lim
N→∞

N→∞(cid:18)1 −

1 − pn(cid:19) lim

N→∞(cid:18)1 −
N (cid:19) = ln(cid:18) 1
So for large enough N the inequality D(cid:0) MN
ln(cid:16) 1

N (cid:19)
1 − pn(cid:19)
N kpn(cid:1) ≥
n(cid:17) holds and hence we get the following

1−pn(cid:17)−ln(cid:16) 1

MN

1−p2

upper bound

Pr (Nε,n ≤ MN ) ≤ exp(cid:18)−N D(cid:18) MN

N

≤ (1 − pn)N(cid:18) 1

1 − p2

n(cid:19)N

kpn(cid:19)(cid:19)
1 + pn(cid:19)N

=(cid:18) 1

Pr (deg(k) < 2) =(cid:18)1 −

MN

N (cid:19)N

+N

MN

N (cid:18)1 −

MN

N (cid:19)N −1

So by the union bound on the channel vertices and for MN ≥
(1 + ε) ln(N ) with some ε > 0 we get, for δ > 0 and large
enough N , that

→ 0

Clearly, if there are at least MN successes then the MN
smallest variables among |hn,1| , ..., |hn,N | are smaller than
ε. Consequently, using the union bound we get

N

1

N→∞

lim
N→∞

lim
N→∞

Xn=1

Pr(cid:16)max
n (cid:12)(cid:12)hn,(m)(cid:12)(cid:12) > ε(cid:17) =
Pr  N
[n=1(cid:8)(cid:12)(cid:12)hn,(m)(cid:12)(cid:12) > ε(cid:9)! ≤ lim
N Pn wnun ≤ wmaxmax

(1 + pn)N = 0
for each m ≤ MN and each ε > 0, and we reached our
conclusion.
Since 1

un, it follows from the
lemma above that the users that are assigned one of their
MN worst channel coefﬁcients have an average utility that
converges to zero in probability. To evaluate the performance
of the worst PNE of the Naive-FSIG, we need to know how
many users can be assigned such a bad channel. Unfortu-
N = 0, for which there
nately, there is an MN s.t.
exists a permutation between users and channels such that
each user gets one of his MN worst channel coefﬁcients.
Even worse, there are actually many such permutations. Our
result is based on the following theorem.

lim
N→∞

MN

n

Theorem 7 (Frieze & Melsted [17]). Let Γ be a bipartite
graph chosen uniformly from the set of graphs with biparti-
tion L, R, |L| = n, |R| = m s.t. each vertex of L has degree
d ≥ 3 and each vertex of R has degree at least two. Then
with high probability the maximum matching in Γ is with
size min {m, n} .

Lemma 8. Assume that {hn,m,k} are independent and
hn,1, ..., hn,N are identically distributed for each n. Let

Mn = (cid:8)k | |hn,k| ≤(cid:12)(cid:12)hn,(MN )(cid:12)(cid:12)(cid:9). If MN ≥ (1 + ε) ln(N )

for some ε > 0, then the probability that a perfect matching
exists between users and channels s.t. each n ∈ N gets a
channel from Mn approaches 1 as N → ∞.

Proof: The degree of each user node is exactly MN . We
want to bound the probability of the event that there exists
a channel with degree zero or one. Due to the i.i.d channel
coefﬁcients of each user, the probability that user n is not
connected to channel k is given by

MN (cid:19)
Pr (k /∈ Mn) = (cid:18) N − 1
MN (cid:19)
(cid:18) N

=

(N −1)!

(N −1−MN )!

N !

(N −MN )!

= 1 −

MN
N

Since channel coefﬁcients of different users are independent,
the probability that the degree of vertex k is less than two
is given by the binomial distribution of the number of users
who prefer channel k, with p = MN
N

deg(k) < 2(cid:19) ≤

k

Pr(cid:18)min
N(cid:18)1 −

MN

MN

+ N MN(cid:18)1 −

N (cid:19)N −1
N (cid:19)N
(1 + δ)(cid:0)N e−MN + N MN e−MN(cid:1)

≤ (1 + δ)

≤

(1 + ε) ln(N ) + 1

N ε

which goes to zero as N → ∞. We know from Theorem 7
that given min
(deg(k)) ≥ 2, the probability that a perfect
matching exists approaches 1 as N → ∞ so by combining
these results we obtain our conclusion.

k

The condition MN ≥ (1 + ε) ln(N ) was necessary to
ensure that with high probability, no channel node degree
is smaller than two. This large user nodes degree has its own
major effect on the equilibria as well.

Theorem 9 (Marshall Hall Jr [18, Theorem 2]). Suppose that
A1, A2, ..., AN are the ﬁnite sets of desirable resources, i.e.
user n desires resource a if and only if a ∈ An. If there
exists a perfect matching between users and resources and
|An| ≥ M for n = 1 , ..., N where M < N , then the number
of perfect matchings is at least M !.

Joining together Theorem 9, Lemma 5, Lemma 6 and
Lemma 8 we arrive at the following theorem, by choosing
MN = N µ for some µ < 1.
Theorem 10. Assume that {hn,m,k} are independent and
|hn,1| , ..., |hn,N | are identically distributed for each n, with
continuous distribution Fn (x), s.t. Fn (x) > 0 for all
x > 0. Also assume that there exist wmin, wmax > 0,
|hn,k|2 >
s.t. wmin ≤ wn ≤ wmax for all n. If

min

1
N0

k

there are at least (N µ)! PNE s.t.
probability as N → ∞. Speciﬁcally, The PPoA of the Naive-
FSIG approaches inﬁnity in probability as N → ∞.

N Pn wnun → 0 in

1

IV. THE M FREQUENCY-SELECTIVE INTERFERENCE

GAME

In this section, we want to exploit the degrees of freedom
in choosing the utility function. Inspired by the hazards
demonstrated by the naive game, we propose a new game
formulation. The greediness of the users is moderated by
an a-priori agreement to limit the utility of each user to be
greater than zero only for his M best channels, and equal
for them.

Deﬁnition 11. The M Frequency-Selective Interference
Game (M-FSIG) is a normal-form game with parameter

|hn,l|2

max

l

N0+min

m (|hm,n,l|2Pm)

holds for each n, then for all µ < 1,

M > 0, N users as players, where each has An =
{1, 2, ..., K} as a strategy space. The utility function for
player n is

0

|hn,k|

≥ 1

else

|hn,an |

|hn,(N −M +1)|

|hn,(N −M +1)|

Deﬁne the set of indexes of the M best channel coefﬁcients

un (a) =( log2(cid:16)1 + Pn|hn,(N −M +1)|2
N0+In,an (a−n) (cid:17)
of user n by Mn = (cid:26)k |
≥ 1(cid:27) . Note that
because (cid:12)(cid:12)hn,(N −M+1)(cid:12)(cid:12) > 0 for each n ∈ N with probability

1, user n will never choose a channel outside Mn. Also
note that due to the replacement of hn,an by hn,(N −M+1)
in the utility, maximizing un is equivalent to minimizing
In,an . Hence in the M-FSIG each user n ∈ N accesses only
channels in Mn and prefers those with smaller interference.
The identiﬁcation of Mn is superior both in performance
and practice over evaluating all the channels that are better
than some threshold as was done in [3], [4]. If this threshold
is constant with respect to N a signiﬁcant rate loss may
occur due to truncation, because the expected value of the
best channel coefﬁcients grows with N . If the threshold is
dependent on N , this dependence is dictated by the fading
distribution, which is not known to the users.

We will show that the M-FSIG has asymptotically only
good PNE in any interference regime. For this reason, in this
game, the convergence to some PNE is sufﬁcient to provide
good global performance. Furthermore, it only requires each
user to track a small number of channels (e.g. O (ln N )
instead of N ).

A. Existence of an Asymptotically Optimal Permutation
Equilibrium

In this subsection we establish that as N → ∞ the proba-
bility that an asymptotically optimal PNE exists approaches
1.

The existence result in Lemma 8 (and Theorem 9) of
permutations where each user n gets a channel from Mn
is of course unaffected by how we choose the M members
of the set Mn. With Mn as deﬁned for the M-FSIG we get
the following corollary.

Corollary 12. Assume that {hn,m,k} are independent and
hn,1, ..., hn,N are identically distributed for each n. If the
M-FSIG parameter is chosen s.t. M ≥ (1+ε) ln(N ) for some
ε > 0, then the probability that the M-FSIG has at least M !
PNE that are permutations of users to channels, s.t. user n
gets a channel from Mn for each n ∈ N , approaches 1 as
N → ∞.

Finally, we state the result that shows that this set of
permutation equilibria are indeed asymptotically optimal.
This result depends on the statistics of the fading coefﬁcients,
and here we choose to present the common case of Rayleigh
fading, although the same is true for a broad class of fading
distributions. Details will be given in [19].

Theorem 13. Assume that {hn,m,k} are independent and
|hn,1|, ..., |hn,N | are i.i.d Rayleigh distributed variables for

M = ∞,
each n. If
then there exist at least M ! PNE for the M-FSIG for which

N µ = 0 for µ < 1 and lim
N→∞

lim
N→∞

M

min
n∈N

log2(cid:16)1+ Pn
log2(cid:16)1+ Pn

N0

N0

|2(cid:17)
|hn,a∗
n
|hn,(N )|2(cid:17)

→ 1 in probability as N → ∞.

B. Non-Existence of Bad Equilibria

It turns out that the asymptotically optimal permutation
PNE are typical equilibria for this game; in other words all
other equilibria are almost a permutation and hence have the
same asymptotic performance. This property eases the re-
quirements for the dynamics and allows simpler convergence
with good performance. We deﬁne a sharing user as a user
who is in the same channel with at least one more user.

Theorem 14. Assume that {hn,m,k} are independent and
hn,1, ..., hn,N are identically distributed for each n. Suppose
that M ≥ (1+ε) ln(N ) for some ε > 0. If a∗ is a PNE of the
M-FSIG with Nc sharing users, then Nc
N → 0 in probability
as N → ∞.

Proof: The proof is based on the fact that the larger
the number of sharing users, the larger the number of empty
channels and hence the probability that none of these empty
channels is in Mn for some n decreases with N . Details are
omitted due to page constraints and will be given in [19].

The weighted sum-rate of

the non-sharing users ap-
proaches the optimal one, and almost all users are non-
sharing users. Nevertheless, the sharing users do not neces-
sarily suffer from poor conditions - they are in their minimal
interference channel out of an increasing (with N ) amount
of good channels.

This result, aided by the existence of an asymptotically
good permutation PNE from the last section, leads to the
following satisfactory property of the M-FSIG that holds for
any interference regime.

Corollary 15. Assume that {hn,m,k} are independent and
|hn,1|, ..., |hn,N | are i.i.d Rayleigh r.v. for each n, and that
wmin ≤ wn ≤ wmax with some wmin, wmax > 0, for each
n. If M = (1 + ε) ln (N ) for some ε > 0, then each PNE
a∗satisﬁes

n=1 wn log2(cid:18)1 +
PN
n=1 wn log2(cid:16)1 + Pn
PN

n|2
Pn|hn,a∗
N0+In,a∗

n (cid:19)
2(cid:17)
N0 (cid:12)(cid:12)hn,(N )(cid:12)(cid:12)

→ 1

in probability as N → ∞. Consequently, the PPoA of the
M-FSIG converges to 1 in probability as N → ∞.

Note that because for M = (1 + ε) ln (N ) some of the
PNE of the M-FSIG are permutations, the above corollary
suggests that the ratio of the weighted sum-rate of the optimal

permutation toPN

to 1 in probability as N → ∞.

n=1 wn log2(cid:16)1 + Pn

N0 (cid:12)(cid:12)hn,(N )(cid:12)(cid:12)

2(cid:17) converges

V. MODIFIED FICTITIOUS PLAY

In order to apply game theory algorithmically, an equilib-
rium analysis, although necessary, is not enough. A learn-
ing algorithm that each user can implement that leads to

convergence to equilibrium is a crucial element. It should
be emphasized that the performance of such an algorithm
is already known from the equilibrium analysis. Therefore
the algorithm that we are looking for is not tailored to
our speciﬁc problem but rather has general properties of
convergence to NE. One of the best known candidates for this
task is the Fictitious Play (FP) algorithm [20]. In FP, each
player keeps the empirical mean vectors of the frequencies
each other player has played his actions, and plays his best
response to this ﬁctitious strategy. Alternatively a player can
keep one empirical mean vector of the frequencies each
strategy proﬁle of its rivals has been played (joint strategy
ﬁctitious play). The simple relation of FP convergence to NE
is summarized in the following proposition.

Proposition 16 ([21]). Let N players play according to the
FP algorithm.

1) If a PNE is attained at t0 it will be played for all t > t0

and the frequency vectors will converge to it.

2) If FP frequency vectors converge, they must converge

to some NE (maybe mixed).

3) If a ∈A1×...×AN is played for every t > t1 then a is

a PNE.

Although its strong connection to NE, FP is not guaranteed
to converge at all. Convergence has been proven only for
some special games that do not include our game. Even if FP
converges, it may be to a mixed NE and this is undesirable as
was mentioned above. Furthermore, a common problem with
implementing FP is the information it requires. In a wireless
network, not only does a user have hardly any information
about the previous action of each other user, but he also
barely knows how many users there are. Fortunately, in our
game the effect of the other users on the utility can be
measured by measuring the interference.

To adjust the FP to the wireless environment we propose
to modify it such that each user keeps track of a ﬁctitious
utility vector instead of the empirical mean vector of the
rivals strategy proﬁles. We denote the ﬁctitious utility for user
n in channel k at time t by U n,k(t). The ﬁctitious utility is
updated according to the following rule

U n,k(t) = (1 − α)U n,k(t − 1) + αun,k(t)

with some step size 0 < α ≤ 1. To prevent mixed NE we
suggest a constant step size instead of the common α = 1
t+1
that makes U n,k the empirical mean utility. Note that α = 1
corresponds to the best-response dynamics.

Additionally, we provide a simple mechanism to improve
the chances of convergence to a PNE. The strategy proﬁle
determines the interference, but knowing the interference will
not reveal the strategy proﬁle. Nevertheless, the continuity
of the random channel gains suggests that for each user, the
interference vector is different for different strategy proﬁles
with probability 1. Hence users can detect that two strategy
proﬁles are different based on their measured interference. If
a PNE is reached it is played repeatedly, so we can exploit
this fact and let the users check for convergence to a PNE

after enough time, and set their ﬁctitious utility to zero if a
PNE has not been reached.

The Modiﬁed FP is described in detail in the Algorithm 1
table, and its properties are summarized in the next proposi-
tion.

Proposition 17. Let N players play according to the Modi-
ﬁed FP algorithm.

1) If α = 1

t+1 , then the dynamics of the joint strategy FP
where each player has perfect information are identical
to those of the Modiﬁed FP.

2) Assume a constant α. If a PNE is attained at t0 then it
will be played for all t > t0 and if the ﬁctitious utility
vectors converge, then the resulting strategy proﬁle is
a PNE.

t=1

I(a−n(t)=ai,−n)

Proof: Assume we are at

pi = PT

turn t = T and deﬁne
for the rivals strategy proﬁle
ai,−n, where I is the indicator function. For α = 1
t+1 the
equivalence of the algorithms follows immediately from the
identity

T

piun(an, ai,−n) =

Xi

pi log2(cid:18)1 +

Pn|hn,(N −M+1)|2

N0 + In,an (ai,−n)(cid:19)

Xi

T

=

1
T

Xt=1

Pn|hn,(N −M+1)|2

log2(cid:18)1 +

N0 + In,an (a−n (t))(cid:19)
becausePi piun(an, ai,−n) is the mean empirical utility for

an according to the ﬁctitious rivals proﬁle. Consider next
the case of a constant α. If a PNE a∗ is attained at t0 then
a∗
U n,k(t0 −
n(t0) = arg max
1) for each n ∈ N . Considering the update rule and because
un,k(t0)1 we get
a∗
n(t0) = arg max

U n,k(t0 − 1) = arg max

n(t0) = arg max

un,k(t0) and a∗

k

k

k

k

arg max

k

(1 − α)U n,k(t0 − 1) + arg max

k

αun,k(t0) =

arg max

k

U n,k(t) = a∗

n(t0 + 1)

and so on, for each t > t0. If the ﬁctitious utility vectors con-
U n,k(t) exists and is ﬁnite for each k and n.
verge, then lim
t→∞
From the update rule we get α lim
U n,k(t) = α lim
un,k(t)
t→∞
t→∞
for each n, k which means lim
un,k(t) for
t→∞
constant α. Consequently, for all t > t1 for some large
un,k(t) for
enough t1, an(t) = arg max
each n ∈ N and hence a is a PNE.

U n,k(t) = lim
t→∞

U n,k(t) = arg max

k

k

In the next section we show that in our case there is indeed

convergence to PNE, and a very fast one.

1For the proof it is enough to break ties in U n,k(t) by choosing the
previous action if it is maximal, otherwise break ties arbitrarily. For t = 0
step (d) of the Modiﬁed FP suggests breaking ties at random.

Algorithm 1 Modiﬁed Fictitious Play

1) Initialization - Choose some 0 < α ≤ 1 and τ > 0.
Each user initializes his ﬁctitious utility - ¯Un,k(0) = 0
for each k ∈ Mn, where Mn is the set of his M best
channels (interference free).

2) For t=1,...T and for each user n=1,...N do

a) Choose a transmission channel

an(t) = arg max

k

U n,k(t − 1)

b) Sense the interference. For each k ∈ Mn

In,k(t) = Xm|am(t)=k

|hm,n,k|2Pm

c) Update ﬁctitious utilities. For each k ∈ Mn

U n,k(t) = (1 − α)U n,k(t − 1) + αun,k(t)

where

un,k(t) = log2(cid:18)1 +

Pn|hn,(N −M+1)|2

N0 + In,k(t) (cid:19)

d) (optional) Check for convergence to a PNE. If
t = τ and In,k(t) 6= In,k(t − 1) for some k ∈ An
then return to step 1, i.e. t = 0.

VI. SIMULATION RESULTS

Our analysis is probabilistic and asymptotic with the
number of users. Thus, we carried out some simulations to
ensure that the asymptotic effects take place for reasonable
N values. In fact, the situation for some ﬁnite N tends to
be much more optimistic than the lower bounds we used in
most of our proofs.

In our simulations we used a Rayleigh fading network;
i.e. {|hm,n,k|} are i.i.d Rayleigh random variables. Hence

n|hm,n,k|2o are i.i.d exponential random variables with pa-

rameter λ, which is chosen to be λ = 1 so all the exponential
variables have unit variance. Unless speciﬁed otherwise, the
transmission powers were chosen such that the mean SNR
for each link, in the absence of interference, is 20[dB]. Users
play according to the Modiﬁed FP algorithm from last section
including step (d) with τ = 60 and α = 0.5.

In Fig. 1 we present the convergence of the Modiﬁed FP
in two different network realizations, for N = K = 100. We
can see that convergence is very fast and occurs within 100
iterations. The upper ﬁgure is for M = 9, where the ratio of
the sum of achievable rates to that of an optimal allocation
is close to 1, and the ratio of the minimal achievable
rate is a bit smaller. This corresponds to a convergence to
one of the permutation PNE; hence, there are no sharing
users. The lower ﬁgure shows another realization for both
M = 7, 14. The sum-rate ratio to optimal is still close to
1, as predicted by the converging PPoA, but the minimal
rate is signiﬁcantly lower. The minimal rate is experienced
by one of the four sharing users in this case. Nevertheless,
choosing M = 14 results in a negligible reduction in the

sum-rate but signiﬁcantly improves the minimum rate due
to the convergence to a permutation with no sharing users.
We can also see the beneﬁts of step (d) of the Modiﬁed FP,
which leads to a detection of non-convergence by the users
at t = 60. This indeed results in a convergence to a PNE
after the users selected initial channels at random again.

In Fig. 2 we show the effect of the number of users on
the rates, with M = ⌈3 ln (N )⌉. We present the average and
minimal achievable rates, compared to the sum-rate optimal
permutation allocation and random permutation allocation
average and minimal achievable rates. The beneﬁt over a
random permutation is signiﬁcant, especially in terms of
the minimal rate. The rates increase is due to the growing
expected value of the best channel coefﬁcients for each
user. This phenomenon (multi-user diversity) of course does
not
take place for a random permutation. In a random
permutation the average user gets his median channel co-
efﬁcient, and the minimal allocated channel coefﬁcient has a
decreasing expectation. The standard deviations of the mean
rates are small as expected from the similarity of all NE,
and the standard deviations of the minimal rate are higher
due to changing number of sharing users between different
realizations.

In Fig. 3 we show the effect of the mean SNR on the
gain of our algorithm over a random permutation alloca-
tion, compared to the optimal permutation allocation. This
simulation is for N = 200 and M = ⌈3 ln (N )⌉. As the
mean SNR grows larger, the logarithmic behavior of the
achievable rate causes the rate difference between two given
channel coefﬁcients to be smaller. At the same time, the
rate difference between an occupied channel and a free one
grows and hence the number of sharing users drops (7.68 at
SN R = −10[dB] and 1.2 at SN R = 25[dB]).

VII. CONCLUSION

In this paper we analyzed, using asymptotic probabilistic
tools,
two game formulations for the distributed channel
allocation problem in the frequency-selective interference
channel. The performance metric was the weighted sum of
achievable rates when treating interference as noise.

First we presented a naive non-cooperative game (Naive-
FSIG) and showed that with strong enough interference it
has Ω ((N µ)!), for all µ < 1, bad pure NE, where N is the
number of users.

We then proposed an enhanced non-cooperative game for-
mulation (M-FSIG) based on an a-priori agreement between
users to limit their utility to be greater than zero only for their
M best channels, with the same value for those channels. We
proved that for many fading distributions (including Rayleigh
fading), our game has a pure price of anarchy that approaches
1 as N → ∞ in any interference regime. For some ﬁxed N
the introduced parameter M can be chosen to compromise
between sum-rate and fairness. This game enables a fully
distributed implementation that achieves close to optimal
performance without resorting to coordinated solutions.

Due to the almost completely orthogonal transmissions in
equilibria our allocation algorithm is more suitable for the

 

Sum−Rate Ratio to Optimal Permutation
Min−Rate Ratio to Optimal Permutation

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

20

40

60

80

100

t

0.2

 

−10

 

Mean Rate Ratio to Optimal
Random Allocaiton Mean Rate
Ratio to Optimal

−5

0

5

10

15

20

25

30

SNR [dB]

Sum−Rate Ratio, M=14
Min−Rate Ratio, M=14
Sum−Rate Ratio, M=7
Min−Rate Ratio, M=7

 

Figure 3. Mean rates as a function of the mean SNR, averaged over 50
realizations

[3] O. Naparstek and A. Leshem, “A fast matching algorithm for asymp-
totically optimal distributed channel assignment,” in Digital Signal
Processing (DSP), 2013 18th International Conference on, 2013.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 
0

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 
0

20

40

60

80

100

t

Figure 1.
allocation sum-rate for two different realizations

Sum-rate and min-rate compared to the optimal permutation

e
s
U

 
l

e
n
n
a
h
C

 
/
 
t
i

B

10

9

8

7

6

5

4

3

2

1

0

 
0

 

Optimal Permutation Mean Rate
Mean Rate
Min Rate
Random Permutation Mean Rate
Random Permutation Min Rate

50

100

150

200

250

300

350

400

450

Number of Players (N)

Figure 2. Rates as a function of N averaged over 50 realizations

medium-strong interference regime.

We also proposed a modiﬁed Fictitious Play algorithm and
showed through simulations that it converges very fast to the
proven pure NE. The fast convergence enables frequent runs
of the algorithm in the network, which results in maintaining
the multi-user diversity in a dynamic fading environment.

The simplicity and high performance of our algorithm
make it an appealing base for a dynamic channel access
protocol for distributed networks.

ACKNOWLEDGMENT

This research was supported by the Israeli Science Foun-

dation, under grant 903/2013.

REFERENCES

[1] W. Yu, G. Ginis, and J. M. Ciofﬁ, “Distributed multiuser power control
for digital subscriber lines,” Selected Areas in Communications, IEEE
Journal on, vol. 20, no. 5, pp. 1105–1115., 2002.

[2] C. H. Papadimitriou and K. Steiglitz, Combinatorial optimization:

algorithms and complexity. Courier Corporation, 1998.

[4] ——, “Fully distributed optimal channel assignment for open spectrum
access,” Signal Processing, IEEE Transactions on, vol. 62, no. 2, pp.
283–294., 2014.

[5] ——, “Expected time complexity of the auction algorithm and the push
relabel algorithm for maximum bipartite matching on random graphs,”
in Random Structures & Algorithms. Wiley Online Library, 2014.

[6] D. Bertsekas, “The auction algorithm: A distributed relaxation method
for the assignment problem,” Annals of operations research, vol. 14,
no. 1, pp. 105–123, 1988.

[7] A. Leshem, E. Zehavi, and Y. Yaffe, “Multichannel opportunistic
carrier sensing for stable channel access control in cognitive radio
systems,” vol. 30, no. 1, pp. 82–95, January 2012.

[8] E. G. Larsson, E. Jorswieck, J. Lindblom, R. Mochaourab et al.,
“Game theory and the ﬂat-fading Gaussian interference channel,”
Signal Processing Magazine, IEEE, vol. 26, no. 5, pp. 18–27, 2009.
[9] G. Scutari, D. P. Palomar, and S. Barbarossa, “Competitive design
of multiuser MIMO systems based on game theory: A uniﬁed view,”
Selected Areas in Communications, IEEE Journal on, vol. 26, no. 7,
pp. 1089–1103., 2008.

[10] A. Laufer and A. Leshem, “Distributed coordination of spectrum and
the prisoner
s dilemma,” in New Frontiers in Dynamic Spectrum
Access Networks, 2005. DySPAN 2005. 2005 First IEEE International
Symposium on, 2005.

[11] N. Nie and C. Comaniciu, “Adaptive channel allocation spectrum
etiquette for cognitive radio networks,” in New Frontiers in Dynamic
Spectrum Access Networks, 2005. DySPAN 2005. 2005 First IEEE
International Symposium on, 2005.

[12] Z. Han, Z. J. Ji, and K. Liu, “Fair multiuser channel allocation for
OFDMA networks using Nash bargaining solutions and coalitions,”
vol. 53, no. 8, pp. 1366–1376, August 2005.

[13] A. Leshem and E. Zehavi, “Cooperative game theory and the Gaus-
sian interference channel,” Selected Areas in Communications, IEEE
Journal on, vol. 26, no. 7, pp. 1078–1088., 2008.

[14] A. Leshem and E. Zehavi., “Smart carrier sensing for distributed com-
putation of the generalized Nash bargaining solution,” in International
Conference on Digital Signal Processing, 2011.

[15] J. Nash, “Non-cooperative games,” Annals of mathematics, vol. 54,

no. 2, pp. 286–295, 1951.

[16] W. Hoeffding, “Probability inequalities for sums of bounded random
variables,” Journal of the American statistical association, vol. 58, no.
301, pp. 13–30, 1963.

[17] A. Frieze and P. Melsted, “Maximum matchings in random bipartite
graphs and the space utilization of cuckoo hash tables,” Random
Structures & Algorithms, vol. 41, no. 3, pp. 334–364, 2012.

[18] M. Hall Jr, “Distinct

the
American Mathematical Society, vol. 54, no. 10, pp. 922–926, 1948.
[19] I. Bistritz and A. Leshem, “Game theoretic dynamic spectrum alloca-

representatives of subsets,” Bulletin of

tions for frequency-selective interference channels,” in preparation.

[20] G. W. Brown, “Iterative solution of games by ﬁctitious play,” Activity
analysis of production and allocation, vol. 13, no. 1, pp. 374–376,
1951.

[21] J. Levin, “Learning in games,” http://web.stanford.edu/~jdlevin/Econ%20286/Learning.pdf

