6
1
0
2

 
r
a

 

M
3
1

 
 
]

.

M
Q
o
i
b
-
q
[
 
 

1
v
3
2
0
4
0

.

3
0
6
1
:
v
i
X
r
a

Resolving coiled shapes reveals new reorientation behaviors in C. elegans

Onno D. Broekmansa, Jarlath B. Rodgersb,c, William S. Ryub,c,d, Greg J. Stephensa,e∗

aDepartment of Physics and Astronomy, VU University Amsterdam, 1081 HV Amsterdam, The Netherlands

bDonnelly Centre, University of Toronto, Toronto, ON M5S3E1, Canada

cDepartment of Cell and Systems Biology, University of Toronto, Toronto, ON M5S 3G5, Canada

dDepartment of Physics, University of Toronto, Toronto, ON M5S1A7, Canada

eOIST Graduate Univeristy, Onna, Okinawa 904-0495, Japan

We exploit the reduced space of C. elegans postures to develop a novel tracking algorithm which
captures both simple shapes and also self-occluding coils, an important, yet unexplored, component
of worm behavior. We apply our algorithm to show that visually complex, coiled sequences are
a superposition of two simpler patterns: the body wave dynamics and a head-curvature pulse.
We demonstrate the precise coiled dynamics of an escape response and uncover new behaviors in
spontaneous, large amplitude coils; deep reorientations occur through classical Ω-shaped postures
and also through larger, new postural excitations which we label here as δ-turns. We ﬁnd that omega
and delta turns occur independently, the serpentine analog of a random left-right step, suggesting
a distinct triggering mechanism. We also show that omega and delta turns display approximately
equal rates and adapt to food-free conditions on a similar timescale, a simple strategy to avoid
navigational bias.

Introduction

Much of our fascination with the living world, from
molecular motors to the dynamics of entire societies, is
with emergence — where the whole is surprisingly dif-
ferent than the sum of its parts (see, e.g., [1]). Yet,
the existence of such collective organization also sug-
gests that living systems, despite their enormous poten-
tial complexity, often inhabit only a much smaller re-
gion of their potential ‘phase space’ and evidence for this
lower-dimensional behavior is ubiquitous. For example,
the motor control system produces movements that are
far less complex than what the musculoskeletal system
allows [2] and this hints at the presence of an organiza-
tional principle. In a typical daily movement like walk-
ing, the central nervous system is thought to produce
the full walking gait by combining low-level ‘locomotory
modules’, some of which appear to be universal among
species [3]. Similarly, the dynamics in brain networks are
organized in low-dimensional activity patterns [4, 5] and
these patterns —not individual neurons — might be the
carriers of information and computation [6, 7].

The emergent dynamics of behavior, how animals move
and interact, is particularly important as the ultimate
function of the system [8] and the scale on which evolu-
tion naturally applies. Yet, our quantitative understand-
ing of behavior is substantially less advanced than the
microscopic processes from which it is produced, even as
recent eﬀorts have expanded this frontier [9–11]. How
do we analyze high-resolution behavioral dynamics and
what does this reveal about an animal’s movement strat-
egy? How do we build eﬀective models on the behavioral
level where a ‘bottom-up’ approach is daunting? How do
we connect analysis on the organism-scale to the proper-
ties of molecules, cells and circuits? We approach these

∗ Corresponding author: g.j.stephens@vu.nl

questions through the postural movements of the nema-
tode C. elegans.

In C. elegans, the 2D space of body postures can be
captured precisely and is also low-dimensional [12] so that
the worm’s motor behavior is fully quantiﬁed using a time
series of only four variables. These ‘eigenworms’ are col-
lective coordinates in the space of natural worm shapes
and provide a notable reduction in complexity. However,
an important limitation of previous work is the inability
to deduce the geometry of self-occluding body shapes.
In navigation, self-occluding body postures occur dur-
ing ‘omega turns’ (a maneuver during which the worm’s
body brieﬂy resembles the Greek letter Ω) and are a gen-
eral part of the worm’s behavioral repertoire, ranging
from foraging [13, 14], and chemotaxis [15], to escape
from noxious stimuli [16]. For example, during escape
behaviors worms use coiled shapes to reorient precisely
by 180◦ and the beneﬁt seems obvious: it steers the worm
back to safety. But how does a ‘blind’ organism achieve
this result without any visual reference to the outside
world? While some of the neural and molecular mecha-
nisms driving omega turns have been uncovered [17, 18]
and there has been previous work on crossed shapes [19–
22], a quantitative analysis of such self-occluded posture
dynamics is lacking.

Here, we exploit low-dimensionality to develop a novel
and conceptually simple posture tracking algorithm able
to unravel the worm’s self-occluding body shapes. We
apply our approach to analyze coiled shapes during two
important behavioral conditions: the escape response in-
duced by a brief heat shock to the head and spontaneous
turns while foraging on a featureless agar plate. We ﬁnd
that, in general, complex deep turn sequences can be
viewed as a simpler superposition of body wave phase
dynamics with a bimodal head swing followed by a uni-
modal curvature pulse. In the escape response we show
that while turning accounts for much of the ∼ 180◦ re-
orientation, the full distribution of reorientation angles

is shaped by signiﬁcant contributions from the reversal,
turn and post-turn behaviors, a result consistent with the
presence and action of the monoamine tyramine during
the entire response. In natural crawling, the peak am-
plitudes of the curvature pulse reveal two distinct coiling
behaviors — the classical omega turn accomplishing large
ventral-side reorientations and a previously uncharacter-
ized ‘delta’ turn which produces dorsal reorientations by
overturning through the ventral side. The omega and
delta turns occur independently in time suggesting a sep-
arate triggering process but have similar rates, producing
little overall bias in the trajectories.

Tracking posture with low-dimensional worm

shapes

Previously, we analyzed movies of C. elegans freely
crawling on an agar plate (Fig. 1A) [12]. For each movie
frame, we identiﬁed the body of the worm, and applied a
thinning algorithm to ﬁnd the centerline. The worm’s 2D
body posture was characterized as a 100-dimensional vec-
tor of tangent angles along this centerline. (Fig. 1B–C).
Principal Component Analysis revealed that more than
95% of the variance in naturally-occurring body postures
was captured by just four eigenvectors of the posture co-
variance matrix (Fig. 1D). As a result, any worm pos-
ture can be decomposed as a linear combination of these
‘eigenworms’ (Fig. 1E). Worm behavior then becomes
a smooth, low-dimensional trajectory through posture
space (Fig. 1F). As an example, forward and backward
crawling appear as approximately circular trajectories in
the (a1, a2) plane, and correspond to limit-cycle attrac-
tors [12]. However, for coiled shapes such as shown in
Fig. 1H, the thinning algorithm does not produce a faith-
ful reconstruction of the worm’s actual posture (Fig. 1G).
The above procedure can also be implemented in re-
verse to generate worm images. For any point p in pos-
ture space (Fig. 1F), we can reconstruct the shape of
the backbone (G). Knowing the thickness of the worm at
each point along the body (which we estimate by averag-
ing over many worm images), we are then able to draw
a reconstructed body image (H ; see Methods). We then
track the posture by ﬁnding, for each movie frame, the
point in posture space (and thus the correct centerline)
for which the reconstituted worm image is the most sim-
ilar to the original image. This approach works for all
worm postures — in contrast to image thinning, which
fails for self-overlapping shapes (Fig. 1H, inset).

Our ‘inverse’ tracking algorithm consists of three ba-
(i) An image error function ferr quanti-
sic elements.
ﬁes how well a reconstituted worm image ˜W(p) matches
the movie frame W (Fig. 2A); (ii) an eﬃcient optimiza-
tion scheme to search for a global error minimum over
all postures and; (iii) a method to resolve ambiguity as
diﬀerent self-occluding body shapes can give rise to the
same image. We measure image similarity using two spe-
ciﬁc shape metrics [23]: outline shape, and coarse-grained
pixel density (Fig. 2B). By mapping this error function

(cid:16)

(cid:17)

2

W, ˜W(p)

onto posture space: ferr(p) = ferr
, we create
a ﬁtness landscape, in which the position of the global
minimum corresponds to the tracking solution and we
ﬁnd this minimum using a pattern search algorithm (a
form of direct search [24]). We retain multiple minima
for each frame until a ﬁnal step which minimizes total se-
quence error and we sketch this process for a single mode
in Fig. 2C.

Tracking reproduces both simple and

self-occluding worm shapes with small errors

Tracking results for a typical movie that includes com-
plex, self-occluding shapes, are shown in Fig. 2D (see also
Supporting Movie 1 and 2). In the gray rows at the top
are the original movie frames; the reconstituted images
from our inverse algorithm are below. While some mi-
nor inaccuracies are visible by eye, the overall result is
remarkably similar. To quantify posture tracking accu-
racy, we ﬁrst compared the results of our algorithm to
image thinning which allows for veriﬁcation based on a
large dataset. We used image thinning to construct a
100-dimensional vector of tangent angles θ, deﬁned the

tracking error as δθ = (cid:13)(cid:13)θinv − θthinning

(cid:13)(cid:13), and we plot

the distribution of these errors in Fig. 2E (black). We
also show the error in θ that results from dimensionality
reduction to the postural eigenmodes (black). Addition-
ally, we show euclidean distances between tangent angle
vectors of consecutive frames in a 16 Hz movie, repre-
senting limited time resolution (gray). For this dataset
of non-crossed frames, our algorithm provides excellent
performance, with tracking errors bounded by time res-
olution and dimensionality reduction. Even for errors in
the tail of the distribution (δθ = 3 rad), backbones from
the thinning and the ‘inverse’ algorithm are quite similar
(inset, gray backbones).

A more relevant quantity for low-dimensional trajec-
tories is the mode error δai which is negligible for simple
shapes as shown in Fig. 2F (yellow). Finally, we created
a dataset of self-overlapping body shapes for which back-
bones were manually drawn. In Fig. 2F (blue) we show
that for the majority of crossed frames, the mode error
is less than 10% of the total range of naturally occurring
mode values. As a visual reference, the reconstituted
worm shapes corresponding to mode errors of δai = 1
are shown in gray: these are noticeably ﬂat.

Coiled dynamics in the escape response reveal
precise reorientations and the superposition of

the body wave and a head-curvature pulse

We ﬁrst applied our postural tracking algorithm to
quantify the full shape dynamics of the C. elegans ‘es-
cape response’. This is a stereotyped behavioral se-
quence, consisting of a pause, a reversal and an Ω-turn,
that quickly moves the worm away from a threatening
stimulus. Featuring only relatively simple coiled shapes,
the escape response provided a useful test of our algo-

rithm. While recent work has connected the escape re-
sponse with genetic, molecular, and neural mechanisms
[18], the behavior itself has been described only quali-
tatively. Here, we elicited an escape response by using
an infrared laser pulse administered to the head of the
worm, which raised the temperature by ∼ 0.5 ◦C. 10
seconds of pre-stimulus behavior and 20 seconds of post-
stimulus behavior were recorded at 20 Hz. Each worm
was only assayed once, to prevent adaptation. In total,
N = 92 worms were recorded, of which N = 91 successful
trackings were used in the ﬁnal analysis.

A schematic of the response is shown in Fig. 3A, with
the associated postural mode dynamics in Figs. 3(B,C).
During normal, forward locomotion (i in Fig. 3A , t < 10 s
in Fig. 3C), the worm crawls by propagating a sine-like
wave through its body. This is reﬂected as a pair of
phase-locked sinusoidal oscillations in a1 and a2 and we
deﬁne the body wave phase angle ϕ = − arctan(a2/a1),
where the minus sign ensures that dϕ/ dt is positive dur-
ing forward crawling. When the worm is stimulated by
the infrared pulse (ii in Fig. 3A, pink line in Fig. 3C at
t = 10 s), it immediately backs up (iii), seen as a de-
crease in ϕ. The end of this reversal and the beginning
of the Ω-turn is marked by a head-swing, visible as a
bimodal pulse in a4. The Ω-turn itself (iv) occurs as a
large, unimodal pulse in a3, and propagates head-to-tail.
This implies another switch of the direction of the body
wave, and hence a return to increasing ϕ. Finally, as the
turn is ﬁnished, the worm resumes forward crawling (v).
The mode dynamics outlined above illustrate that the
complexity of the escape sequence can be seen as a su-
perposition of two simpler patterns: the body wave phase
dynamics in (a1, a2), and the head-curvature dynamics of
(a3, a4). A movie of these mode dynamics is available as
Supporting Movie 3.

A notable feature of the escape response is how closely
the worm controls its reorientation and our tracking al-
gorithm also makes it possible to track the overall ori-
entation continuously, across the diﬀerent phases of the
escape response. In Fig. 3(D-E), we calculate how much
each of the three response segments reorients the worm.
The distribution of reorientations for the full escape re-
sponse is largely similar to the distribution during the
omega-turn but includes contributions from the reversal
and post-turn segments.
In the trial-averaged reorien-
tation Fig. 3(E), we ﬁnd (cid:104)∆θ(cid:105) = −0.89π ± 0.05π rad
for the full response. The omega turn itself results
in (cid:104)∆θ(cid:105) = −0.90π ± 0.04π rad while pre- and post-
omega phases show smaller but signiﬁcant contributions,
(cid:104)∆θ(cid:105) = 0.13π±0.03π rad and (cid:104)∆θ(cid:105) = −0.12π±0.03π rad,
respectively (errors are calculated using bootstrap across
trials and are equivalent to standard errors in the mean).
Remarkably, the mean reorientation in the reversal and
post-turn segments precisely cancel, suggesting a cor-
rection mechanism at the level of the average response
so that the mean overall reorientation is entirely deter-
mined by the omega-turn. No such precision is apparent
in the variance where we ﬁnd δθ2 = 0.69π ± 0.16π rad2

3

for the full response compared to the smaller δθ2 =
0.45π ± 0.16π rad2 for the turn segment. Thus, while the
omega turn is an eﬀective maneuver for turning away
from the stimulus, the full response orientation change
is broadened by the reversal (δθ2 = 0.23π ± 0.05π rad2 )
and post-omega (δθ2 = 0.19π ± 0.04π rad2) behaviors.

These observations allow us to hypothesize a subtle
link between the behavior of the worm and the escape
response at the neurotransmitter level [18]. As the worm
enters the reversal phase, release of tyramine sets up an
asymmetry in the worm’s body and this appears as a
baseline shift in the ﬂuctuations of the third mode (see
also Supporting Figure 1) leading to a positive bias in
the reorientation, Fig. 3(D,E) (reversal). After the turn,
lingering eﬀects of the tyramine produce a similar base-
line shift but as the worm is moving forward instead of
backward, this now leads to an opposite orientation bias,
Fig. 3(D,E) (post-omega).

Coiled dynamics during foraging reveal distinct,

large-amplitude turns

To analyze more complex coiled shapes we applied our
posture algorithm to foraging worm behavior on a ﬂat
agar plate (see Methods). Under these conditions, worms
navigate using a combination of maneuvers, including
short and long reversals, pirouettes and even more contin-
uous turns. We are particularly interested in the pirou-
ettes as they involve deep coils. Such body bends are
primarily encoded in the third postural eigenmode (a3)
and, as discussed in the previous section, peaks in a3 are
a characteristic feature of omega turns, and have a known
role in reorientation of the worm [13].

In Fig. 4A, we show the full distribution of postural
mode a3 for all local extrema and note that the modes
have been normalized so that negative a3 amplitudes cor-
respond to dorsal turns; ventral turns have strictly pos-
itive amplitudes. A clear asymmetry can be observed so
that on top of a symmetric background distribution of
shallow turns in both directions, we see, on the ventral
side, two distinct additional peaks. Drawing reconsti-
tuted worm images for the center values of these two
peaks, it is clear that the peak at a3 ∼ 15 corresponds to
a ‘classic’ Ω shape. The second peak, at a3 ∼ 23, shows
a body shape with a much higher characteristic curva-
ture. In Fig. 4A (right), we have ‘folded’ the dorsal side
of the distribution over the ventral side, highlighting the
ventral asymmetry at high a3 amplitudes. As noted in
the ﬁgure, we refer to turns in the lower-amplitude peak
as omega turns and distinguish these from the higher-
amplitude delta (δ) turns in the second peak. As for the
omega turn, the name delta turn is chosen to reﬂect the
δ-like shape of the worm during a typical sequence.

Returning to the original tracking movies, the presence
of these two classes of turns is clearly visible. In Fig. 4B
we display movie stills for two example turns: one omega
turn, and one delta turn. During the classical omega
turn, the worm slides its head along its body, similar
to the escape response, ending up with large, primarily

ventral reorientation. A delta turn, on the other hand, is
much deeper: the worm completely crosses its head over
its body, resulting in an dorsal reorientation by ‘over-
turning’ across the ventral side.

Delta and omega turns are complementary

components of a navigational strategy

In postural dynamics, the delta and omega turns diﬀer
primarily in their a3 pulse amplitude; their turn kine-
matics are otherwise very similar (Supporting Figure 2).
However, when turns do occur, they result in a dramat-
ically diﬀerent change of overall orientation. As in the
escape response we use our posture algorithm to track
the worm’s overall body reorientation and in Fig. 4C, we
show how the worm reorients using both omega (orange)
and delta (blue) turns. Simply put, omega turns reori-
ent the worm by large, ventral angles, while delta turns
reorient the worm dorsally by ‘over-turning’ through the
ventral side. The diﬀerence in reorientation angle may
provide a hint as to why these two behaviors exist. Ear-
lier, we saw that the neural mechanisms that produce
the escape-response omega turn are fundamentally asym-
metric, producing only ventral turns (through disinhibi-
tion of the VD motor neurons) [18].
If the worm uses
the same neural infrastructure during free crawling, this
would only ever allow it to reorient itself towards its ven-
tral side. Lacking a dorsal ‘copy’ of the same neural in-
frastructure, the worm could instead hyper-activate the
existing infrastructure to produce ventral ‘over-turning’.
These ‘over-turns’ are what we call delta turns, and en-
able the worm to also reorient towards its dorsal side.
We also ﬁnd that delta and omega turns occur seemingly
independently; the mutual information between time-
binned, time-shifted series for both turning event time
series has a maximum of less than a few percent (see
Methods and Supporting Figures 3-4). On the other
hand, evidence that the turns can be jointly controlled is
shown in Fig. 4D. Here, we plot the frequency of turning
events over the course of the experiment (see Methods).
As the worm searches for food in a larger area, the turn
frequency decreases signiﬁcantly — a well-known phe-
nomenon [17, 25, 26]- and both omega and delta turns
show similar frequencies and adaptation.

Discussion

The ability to track self-overlapping shapes of C. ele-
gans together with the eigenworm projection of postures,
provides a complete and quantitive accounting of the
worm’s locomotory behavior in 2D. Among living sys-
tems with a nervous system, such an exact behavioral
description is unique and is likely to be especially im-
portant as new techniques emerge for the simultaneous
imaging of a substantial fraction of the worm’s neurons
during free behavior [27, 28]. Our posture tracking algo-
rithm itself is conceptually simple and relies on an op-
timized image search within the low-dimensional space
of worm shapes. Indeed, while the identiﬁcation of low-

4

dimensionality occupies an important role in quantitative
approaches to living systems (see e.g.
[29–31]), here we
have leveraged these dimensions to elucidate important
and previously unknown aspects of C. elegans coils. In-
terestingly, we were able to apply the characterization of
body postures found previously for non–self-overlapping
body shapes [12], to capture shapes that do self-overlap;
even the simpler eigenworm space allows for substantial
posture diversity.

We applied our tracking algorithm to two important
behaviors, an evoked escape response and the deep, spon-
taneous turns that occur during foraging. Viewing the
coiled turn as a trajectory through the low-dimensional
posture space, a simple model emerges: a superposition
of the body wave (a circular trajectory in posture space
corresponding to simple forward and backward crawling),
and coupled pulses along the third and forth mode (cor-
responding to the deep coil and a preceding head oscilla-
tion). This model is consistent with the molecular mech-
anisms found to orchestrate the escape response [18]. Our
results also hint at a possible answer to how precise re-
orientations of 180◦ are accomplished: the worm could
use its own body as a ‘guide’ for reorientation. During
the omega-turn, the distribution of a3 peak amplitudes
(Fig. 3D (Omega turn, inset)) lies close to a value of 15:
the lowest a3 value that generates a self-touching body
shape. This suggests that the worm might have evolved
to coil until it just intersects its own body, which it then
slides along to ﬁnd its way back.

While the omega turn has previously been considered
as a single class of C. elegans behavior, our analysis of
the amplitudes of the curvature mode a3 pulses asso-
ciated with deep coils reveals the presence of two dis-
tinct subpopulations.
‘Classic’ omega turns, featuring
the signature Ω body shape, reorient the worm to the
ventral side while delta turns reorient the worm dorsally
by over-turning through the ventral side. We show that
these deep dorsal and ventral reorientations occur inde-
pendently in time with approximately equal rates, which
is important if there is to be no overall bias in the forag-
ing trajectories.

While distinct in visual appearance, omega and delta
turns diﬀer only in the amplitude of the curvature mode
and we have shown that these behaviors are discretely
separable during foraging. However, coiling is also ob-
served in other contexts, including a variety of mutants
[22, 32]. We expect our methods will be useful in analyz-
ing such shapes and as a guide for uncovering neural and
molecular mechanisms underpinning coiling behavior.

Deep turns and reorientations form an important com-
ponent of the taxis strategy of C. elegans [13–15, 17]. Un-
der foraging and chemotaxis conditions, these behaviors
are seemingly stochastic [26, 33], producing a broad dis-
tribution of reorientation angles analogous to tumbling
in the bacteria E. coli [34]. However, unlike bacterial
tumbling (which occurs through an instantaneous switch
in the rotation direction of a molecular motor and the
resulting unbundling of the ﬂagellar tail, see e.g [35]) the

worm’s reorientation is driven by a long, controlled se-
quence of stereotyped postural changes. Thus an impor-
tant question is how does the worm eﬀectively randomize
its direction? We have shown here that half the variabil-
ity in C. elegans foraging reorientations is due simply to
the initial random choice of delta or omega turns. How-
ever, even the level of stochasticity can be modulated,
as evidenced by the largely deterministic reorientation
in the escape response, diﬀering response variability de-
pending on the strength of a thermal stimulus [16] and
the slow adaptation of the reversal rate [17, 36]. Overall,
such a combination of behaviors, ﬂexible and stochastic
combined with patterned and deterministic is likely to
observed even in more complex organisms, including hu-
mans.
In initiating the detailed analysis of C. elegans
turning behavior we hope that our work here oﬀers ﬁrst
step towards a general understanding of these processes.

Methods

Data: We used two datasets encompassing both foraging
and escape response behavioral conditions. The foraging
data was explored previously [36] and for more details
on data collection see also [12]. In short, C. elegans N2-
strain worms were imaged with a video tracking micro-
scope at f = 32 Hz. Worms were grown at 20 ◦C under
standard conditions [37]. Before imaging, worms were re-
moved from bacteria-strewn agar plates using a platinum
worm pick, and rinsed from E. coli by letting them swim
for 1 minute in NGM buﬀer. They were then transferred
to an assay plate (9-cm Petri dish) that contained a cop-
per ring (5.1-cm inner diameter) pressed into the agar
surface, preventing the worm from reaching the side of
the plate. Recording started approximately 5 min after
the transfer, and lasted for 2 100 s (35 min).
In total,
data from N = 12 worms was recorded. The second
dataset, the ‘escape response’ condition, was recorded
following procedures as described in ref. [16]. In short,
worm recordings took place in a temperature-controlled
room (22.5 ◦C ± 1 ◦C). A 100-ms, 75-mA infrared laser
pulse from a diode laser (λ = 1 440 nm) was adminis-
tered to the head of the worm, raising the temperature
in a FWHM-radius of 220 µm by ∼ 0.5 ◦C. 10 seconds
of pre-stimulus behavior and 20 seconds of post-stimulus
behavior were recorded at a frame rate of 20 Hz. Each
worm was only assayed once, to prevent adaptation. In
total, N = 92 worms were recorded, of which N = 91
successful trackings were used in the ﬁnal analysis.

Image processing and shape reconstruction: All
movie frames were converted to binary mages and
cropped, using standard image processing functions in
MATLAB (R2014b, The Mathworks, Natick, MA) [12].
For faster processing, before analysis with the inverse
tracking algorithm, the foraging data was down-sampled
to 16 Hz by dropping every second frame. To reconstitute
an image of a worm with a body posture p = (a1, . . . , a5),
we ﬁrst calculated the vector of backbone tangent angles
i pi ˆei, with ˆei the i’th eigenworm. Knowing

from θ =(cid:80)

5

the total arc length l of the worm, we could calculate the
position of each of the 100 points along the backbone. At
each backbone point j, we then drew a ﬁlled circle with
radius rj to capture the worm’s body thickness (see also
Fig. 1g,h) and thus create the worm image. Circle radii
rj for a particular worm were computed from movies of
uncrossed worm postures for that speciﬁc worm. In each
such frame, after ﬁnding the centerline (backbone) and
outline of the worm [12], we could ﬁnd rj as the mini-
mum distance between backbone point and outline. This
was averaged across all frames. Similarly, the total arc
length l of the worm was computed by averaging across
frames. For the error function described below, the over-
all orientation of the worm in the image is important and
we generate images of worms in all possible orientations
by adding an overall orientation value (cid:104)θ(cid:105) ∈ [0, 2π) to
the backbone tangent angle vector. This gives us a full

backbone vector θF = (cid:104)θ(cid:105) +(cid:80)5

i=1 ai ˆei.

Image error function and inverse algorithm: The
shape error function compares two binary worm images
W1 and W2 and is computed as ferr = foutline · fpixel.
For foutline we calculate a set of tangent angles ψ to the
perimeter of the worm shape (Fig. 2b, left). We ﬁnd
the 4-connected outline of the worm in the binary image
Wi, ﬁt a spline through these points, and discretize it
into 201 segments sampled at equal arc length. The 200
resulting angles between the segments form a vector ψi =
(ψi,1, ψi,2, . . . , ψi,200); the total length of the segments is
(cid:96)i. foutline is now foutline = C0|ψ1 − ψ2|2 + C1 ((cid:96)1 − (cid:96)2)2,
for arbitrary constants C0 and C1. Note that the value
of foutline is sensitive to the choice of starting points
for tracing the 4-connected outline in each image; this
is resolved by choosing the pair of starting points that
minimizes foutline. For fpixel, we ﬁrst align the images
W1 and W2 so that their centroids overlap. Each im-
age is then divided into a grid of 10x10-pixel ‘blocks’
(Fig. 2b, right). For each block (j, k) (j = 1, . . . , n;
k = 1, . . . , m) in image Wi, the fraction di(j, k) of black
pixels in the block is calculated. This coarse-graining
into blocks allows for, e.g., minor inaccuracies in the
generation of worm images from mode values, without
aﬀecting the error function. We then calculate fpixel as
fpixel = 1
. In earlier trials,
nm
we found that using ﬁve postural eigenmodes gave us
signiﬁcantly better tracking results than only using four.
Since our error function is sensitive to the overall rotation
of the worm, we amended the ﬁve-dimensional posture
space with an extra dimension for the overall orienta-
tion (cid:104)θ(cid:105). This means that the search space for our algo-
rithm is six-dimensional, with 5 postural dimensions, and
1 rotational dimension. To ﬁnd a tracking solution for
a frame, we ran 580 pattern searches (using MATLAB’s
patternsearch function) from randomly distributed start-
ing points in search space, with the error function de-
scribed above as objective function. Only solutions with
an error value less than 1.0, a threshold value obtained
through trial-and-error, were kept. Solutions within a

(cid:0)d1(j, k) − d2(j, k)(cid:1)2

(cid:80)

j,k

given hypercube of dimensions [3.0, 3.0, 3.0, 3.0, 2.5] were
merged, leaving only the solution with the lowest error
value. This ﬁnally resulted in zero, one, or more po-
tential tracking solutions per movie frame. To speed up
the optimization, we applied two additional constraints.
Firstly, we bounded the absolute value of the eigenmodes
to (18, 18, 34, 12, 6), for each of the ﬁve modes respec-
tively. We veriﬁed that the distributions of eigenvalues
ai found in our tracking data tailed oﬀ before reaching
these limits. Secondly, we set a limit to the maximum lo-
cal curvature of the worm’s backbone so that elements in
the resulting theta vector that are 10 indices apart must
not be diﬀerent by more than 1.95 rad. This limit rules
out body shapes that were unnaturally coiled.

Importantly, we note that our inverse problem is fun-
damentally ill-posed: multiple body postures may pro-
duce the same two-dimensional worm image (e.g. Fig. 2B,
bottom) and for each movie frame j = 1, . . . , N , we gen-
erally ﬁnd multiple potential solutions which we label
{pk
j}, with k = 1, . . . , Mj. Even for simple, non-crossed
postures, there can be two solutions (Mj = 2) corre-
sponding to the swapped locations of the head and tail.
Across the movie, we label the indices of the correct so-
lutions as a vector b = (b1, . . . , bN ) . We explicitly allow
bj = 0 in case the optimization process fails and use a
cubic spline to interpolate across any such gaps. Let us
call the point in posture space for movie frame j, result-
ing from this interpolation step, ˜pj(b). To ﬁnd b
for
the full, correct tracking solution of the movie we seek
that minimizes the total sequence
the solution vector, b

∗

∗

(cid:16)

(cid:17)(cid:21)

error E(b) = (cid:80)N

(cid:20)

j=1 ferr

Wj, ˜W

˜pj(b)

and we con-

strain the distance between two successive frames to be
below vmax, a continuity constraint which simply reﬂects
the fact that the worm can only change its posture by a
maximum amount between two movie frames.

Tracking Pipeline: In a ﬁrst pass of the data, the ‘clas-
sic’ worm tracking algorithm based on image skeletoniza-
tion was used on all frames [12]. This fast algorithm
yields high-accuracy tracking results for frames with sim-
ple, non–self-overlapping body shapes. It also automat-
ically labeled crossed frames. For the foraging dataset,
the data was cut into smaller segments to allow for faster
parallel processing. Each segment consisted of a series of
non-crossed frames, followed by a series of crossed frames,
followed by more non-crossed frames. This eﬀectively
segmented the data by omega turn (936 segments in to-
tal for the 12 worm trajectories). For the escape response
dataset, such segmentation was not necessary, due to the
smaller size of the data for each worm. Frames that were
previously labeled as ‘crossed’ were tracked using the in-
verse algorithm described above. The result was an inter-
polated, smooth trajectory through posture space. When
using this pipeline as-is, the algorithm would occasion-
ally swap the locations of head and tail between frames.
To resolve head/tail orientation correctly throughout a
segment, we implemented four steps. (1) During the ﬁl-

6

tering and interpolation step, we allowed the algorithm
to pick, for each non-crossed frame, not just the solution
given by the ‘classic’ algorithm; it could also pick an al-
ternative version in which head and tail were swapped
(this version can be trivially computed). (2) We explic-
itly included a limit for the maximum change of overall
orientation (cid:104)θ(cid:105) between frames of ∼ π rad per second in
the maximum velocity vector vmax. Any head/tail swaps
between frames violate such a maximum change of (cid:104)θ(cid:105).
(3) After the ﬁltering and interpolation step had pro-
duced a full tracking solution, we computed the error for
both that tracking solution, as well as a version in which
the head and tail were swapped for all frames in the seg-
ment. This ﬁxed the overall head/tail orientation for the
full segment. (4) As a ﬁnal check, we manually veriﬁed
and, if necessary, corrected head/tail orientations during
post-processing.

5(cid:80)

Tracking quality:
In total, 92 escape responses and
936 free-crawling segments (each containing one self-
overlapping turn; see Methods) were analyzed. The es-
cape response tracking results were inspected manually,
and 91 trackings (99%) were considered successful, as
they were visually close to the appearance of the orig-
inal worm. For the free crawling dataset,instead, after
inspection of a representative sample of 236 segments
across multiple worms, 96% were estimated to be suc-
cessful. First, we assessed the quality of our tracking al-
gorithm for non-crossed worm shapes (Fig. 2D). We used
both the ‘classic’ algorithm and the ‘inverse’ algorithm
to track N = 15433 non-crossed frames from the foraging
dataset. For each frame, we calculated the euclidean dis-
tance between the two resulting θ vectors giving the ‘inv.
tracking’ distribution in Fig. 2a (black). In the same ﬁg-
ure, the ‘dim. reduct.’ distribution (blue) was calculated
from euclidean distances between the full θ vector from

the classic algorithm, and θreduct =

ai ˆei, where ˆei are

i=1

the eigenworms. This represents the information lost in
only using the ﬁrst ﬁve postural eigenmodes (which cap-
ture >95% of the shape variance [12]). The ‘time res.’
distribution (yellow) represents the euclidean distance
between θ vectors from consecutive frames in a movie.
In Fig. 2(E), we additionally collected a dataset of four
movies, featuring visually distinct types of omega turns.
For the N = 348 crossed frames in these four movies,
backbones were hand-drawn on the worm images, inde-
pendently from the tracking results. We considered these
manual tracking results a ‘gold standard’, and compared
them to the ﬁnal results of our inverse tracking / ﬁltering
and interpolation algorithms. The resulting mode errors
δai are plotted as the blue/dark distributions. We also
incude the mode errors for the set of 15433 non-crossed
frames (yellow).

Deﬁnition of large-amplitude turns: For the escape
response data, the largest peak in a3 between t = 10 s
(the time of the stimulus) and t = 29 s was identiﬁed as

the apex of the omega turn. To locate the end of the
omega turn, the ﬁrst zero of a4 after the apex was found;
any point after that root that had a3 < 3 was considered
to be the end of the omega turn. This ensured that the
negative peak in a4, representing a high-curvature state
of the tail at the end of the omega turn, had ﬁnished,
and that the worm had reached a relatively ‘straight’
shape. For such straight shapes, the overall orientation
(cid:104)θ(cid:105) has a straightforward, intuitive interpretation. The
same criterion was used, in the opposite direction, to ﬁnd
the start of the omega turn. If no starting point and/or
end point of the omega turn could be found, the recording
was excluded from the analysis. (In the escape response
dataset, this was the case for 15 out of 91 recordings).
We used the same criterion to ﬁnd both omega and delta
turns in the foraging condition. For detection of local
extrema in a3, a standard peak-ﬁnding algorithm was
used to detect both minima and maxima (based on the
MATLAB ﬁndpeaks function, which deﬁnes a peak as
a data point with a greater value than its immediate
neighbors). Only extrema with a minimum prominence
of 0.5 were kept. Some a3 peaks featured smaller sub-
peaks in their shoulders; such sub-peaks were discarded.

Orientation: Orientation changes were computed by
comparing the overall orientation (cid:104)θ(cid:105) between two refer-
ence points around each omega or delta turn. The apex
of each deep turn was the largest a3 peak identiﬁed pre-
viously. The ﬁrst reference point was the last frame be-
fore the turn’s apex that featured a ‘straight’ body shape
— i.e., a body shape with a low maximum local curva-
ture. Only for such relatively ‘ﬂat’ worm shapes does the
overall orientation (cid:104)θ(cid:105) correspond directly to the intuitive
orientation assigned to the worm. Similarly, the second
reference point was the ﬁrst frame after the turn’s apex
with such a straight body shape. Importantly, our pos-
tural tracking algorithm allows us to continuously follow
the orientation angle through coiled shapes and this is
important for identifying the ’overturning’ reorientation
eﬀects of delta turns. For the analysis of the worm’s reori-
entation during the escape response (Fig. 3 D,E), N = 91
escape responses were analyzed. Each 30-second record-
ing was segmented by ﬁrst ﬁnding the omega turn. After
identiﬁcation of the omega turn, the reversal phase was
simply deﬁned as the ﬁrst frame after the stimulus with
a negative body wave phase velocity dϕ/ dt, up until the
start of the omega turn. The ‘post-omega’ phase was any
data after the end of the omega turn until the end of the
recording at t = 30 s.
If any of the chosen recordings
did not have a successfully detected omega turn, it was
skipped.

Mutual information between omega and delta-

7

turn event time series: To calculate the mutual infor-
mation between the omega and delta turns during for-
aging, we created binary event time series by ﬁrst iden-
tifying the time of the a3 peak and then binning these
times into bins of width 2, 4, 10, or 20 s. We then calcu-
lated the mutual information between these binary time
series as in ref. [38]. The mutual information was cal-
culated for diﬀerent relative shifts, ranging from −60 to
+60 s. Mutual information across time shifts never ex-
ceeded ∼ 3% of the maximum entropy of each time series
indicating that these turns occur independently. See also
Supporting Figure 3.

Omega and delta turn frequency adaptation: In
Fig. 4D, we show how the average turn frequencies for
omega and delta turns change over the course of the 35-
minute foraging experiments. Turns were detected by
using the peak detection algorithm outlined above. Us-
ing the amplitude boundaries identiﬁed in Fig. 4b, a3
extrema with an absolute value between 10 and 20 were
classiﬁed as ‘omega turns’, while extrema with an abso-
lute value greater than 20 were considered to be ‘delta
turns’. We also distinguished between ventral turns, with
a positive amplitude, and dorsal turns, with a negative
amplitude. We counted the average number of turns per
unit time, across the 12 experiments, in a 10-minute slid-
ing window, shifted across the data in 5-minute steps.
The ﬁrst 200 seconds of each experiment were discarded.
The total of these extrema consists of three-populations:
a tail of the symmetric distribution of ‘shallow turns’,
and two types of ventral deep turns, the delta and omega
turns. To ﬁnd the number of omega turns we therefore
counted the number of a3 peaks with an amplitude be-
tween −20 and −10 in each time window, and subtracted
this from the total number of a3 peaks with an ampli-
tude between +10 and +20. An identical procedure with
|a3| > 20 gives the number of delta turns which is in ex-
cellent agreement with the number of omega turns, dif-
fering only to the extent expected from Poisson number
ﬂuctuations.

Acknowledgments

We thank GJ Berman, AEX Brown and TS Shimizu
for discussions and SURFsara (www.surfsara.nl) for help
with the Lisa Compute Cluster. ODB was supported by
start-up funds from the Department of Physics and As-
tronomy, Vrije Universiteit Amsterdam. GJS acknowl-
edges funding from the Department of Physics and As-
tronomy, Vrije Universiteit and The Okinawa Institute
of Science and Technology Graduate University. WSR
and JBR thank The National Science and Engineering
Council of Canada (NSERC).

[1] Laughlin RB (2014) A Perspective: Robert B Laughlin.

[2] D’Avella A, Saltiel P, Bizzi E (2003) Combinations of

Physical Biology 11(5):053003.

muscle synergies in the construction of a natural motor
behavior. Nature Neuroscience 6(3):300–308.

[3] Dominici N et al. (2011) Locomotor Primitives in
Science

Newborn Babies and Their Development.
334(6058):997–999.

[4] Tkacik G et al. (2014) Searching for Collective Behavior
in a Large Network of Sensory Neurons. PLoS Compu-
tational Biology 10(1):e1003408.

[5] Gao P, Ganguli S (2015) On simplicity and complexity in
the brave new world of large-scale neuroscience. Current
Opinion in Neurobiology 32:148–155.

[6] Hopﬁeld JJ (1982) Neural networks and physical sys-
tems with emergent collective computational abilities.
Proceedings of the National Academy of Sciences of the
United States of America 79(8):2554–2558.

[7] Yoon K et al. (2013) Speciﬁc evidence of low-dimensional
continuous attractor dynamics in grid cells. Nature Neu-
roscience 16(8):1077–1084.

[8] Tinbergen N (2005) On aims and methods of ethology.

(Animal Biology) Vol. 55.

[9] Mirat O, Sternberg JR, Severi KE, Wyart C (2013) Ze-
braZoom: an automated program for high-throughput
behavioral analysis and categorization. Frontiers in Neu-
ral Circuits 7.

[10] Berman GJ, Choi DM, Bialek W, Shaevitz JW (2014)
Mapping the stereotyped behaviour of freely moving
fruit ﬂies.
the Royal Society Interface
11(99):20140672–20140672.

Journal of

[11] Cavagna A, Giardina I (2014) Bird Flocks as Condensed
Matter. Annual Review of Condensed Matter Physics
5(1):183–207.

[12] Stephens GJ, Johnson-Kerner B, Bialek W, Ryu WS
(2008) Dimensionality and dynamics in the behavior of
C. elegans. PLoS Computational Biology 4(4):e1000028.
[13] Stephens GJ, Johnson-Kerner B, Bialek W, Ryu WS
(2010) From modes to movement in the behavior of
Caenorhabditis elegans. PLoS ONE 5(11):e13914.

[14] Salvador LCM, Bartumeus F, Levin SA, Ryu WS
(2014) Mechanistic analysis of the search behaviour of
Caenorhabditis elegans. Journal of the Royal Society In-
terface 11(92):20131092.

[15] Pierce-Shimomura JT, Morse TM, Lockery SR (1999)
The fundamental role of pirouettes in Caenorhabditis el-
egans chemotaxis. Journal of Neuroscience 19(21):9557–
69.

[16] Mohammadi A, Byrne Rodgers J, Kotera I, Ryu WS
(2013) Behavioral response of Caenorhabditis elegans to
localized thermal stimuli. BMC Neuroscience 14(1):66.

[17] Gray JM, Hill JJ, Bargmann CI (2005) A circuit for nav-
igation in Caenorhabditis elegans. Proceedings of the Na-
tional Academy of Sciences of the United States of Amer-
ica 102(9):3184–91.

[18] Donnelly JL et al. (2013) Monoaminergic orchestration of
motor programs in a complex C. elegans behavior. PLoS
Biology 11(4):e1001529.

[19] Huang KM, Cosman P, Schafer WR (2006) Machine vi-
sion based detection of omega bends and reversals in
C. elegans. Journal of Neuroscience Methods 158(2):323–
36.

[20] Wang Q, Ronneberger O, Schulze E, Baumeister R,

8

Burkhardt H (2009) Using lateral coupled snakes for
modeling the contours of worms. Lecture Notes in Com-
puter Science 5748 LNCS:542–551.

[21] Roussel N, Sprenger J, Tappan SJ, Glaser JR (2014)
Robust tracking and quantiﬁcation of C. elegans body
shape and locomotion through coiling, entanglement, and
omega bends. Worm 3(4):e982437.

[22] Nagy S, Goessling M, Amit Y, Biron D (2015) A Gen-
erative Statistical Algorithm for Automatic Detection
of Complex Postures.
PLoS Computational Biology
11(10):e1004517.

[23] Yang M, Kpalma K, Ronsin J (2008) A Survey of Shape
Feature Extraction Techniques in Pattern Recognition,
ed. Yin PY. (IN-TECH), pp. 43–90. 38 pages.

[24] Kolda TG, Lewis RM, Torczon V (2003) Optimization
by Direct Search: New Perspectives on Some Classical
and Modern Methods. SIAM Review 45(3):385–482.

[25] de Bono M, Villu Maricq A (2005) Neuronal Substrates
of Complex Behaviors in C. elegans. Annual Review of
Neuroscience 28(1):451–501.

[26] Srivastava N, Clark DA, Samuel ADT (2009) Tempo-
ral analysis of stochastic turning behavior of swimming
C. elegans. Journal of Neurophysiology 102(2):1172–9.

[27] Nguyen JP et al. (2015) Whole-brain calcium imaging
with cellular resolution in freely behaving Caenorhabditis
elegans. Proceedings of the National Academy of Sciences
pp. 201507110–46.

[28] Venkatachalam V et al. (2015) Pan-neuronal imaging in
roaming Caenorhabditis elegans. Proceedings of the Na-
tional Academy of Sciences pp. 201507109–44.

[29] Machta BB, Chachra R, Transtrum MK, Sethna
JP (2013) Parameter Space Compression Underlies
Emergent Theories and Predictive Models.
Science
342(6158):604–607.

[30] Daniels BC, Nemenman I (2015) Automated adaptive
inference of phenomenological dynamical models. Nature
Communications 6:8133–8.

[31] Ganguli S, Sompolinsky H (2012) Compressed Sensing,
Sparsity, and Dimensionality in Neuronal Information
Processing and Data Analysis. Annual Review of Neuro-
science 35(1):485–508.

[32] Yemini E, Jucikas T, Grundy LJ, Brown AEX, Schafer
WR (2013) A database of Caenorhabditis elegans behav-
ioral phenotypes. Nature methods 10(9):877–879.

[33] Gallagher T, Bjorness T, Greene R, You YJ, Avery L
(2013) The Geometry of Locomotive Behavioral States
in C. elegans. PLoS ONE 8(3).

[34] Berg H, Brown D (1972) Chemotaxis in Escherichia coli

analysed by three-dimensional tracking. Nature.

[35] Berg HC (2006) Marvels of bacterial behavior.
[36] Stephens GJ, Bueno de Mesquita M, Ryu WS, Bialek W
(2011) Emergence of long timescales and stereotyped be-
haviors in Caenorhabditis elegans. Proceedings of the Na-
tional Academy of Sciences of the United States of Amer-
ica 108(18):7286–9.

[37] Sulston JE, Brenner S (1974) The DNA of Caenorhabditis

elegans. Genetics 77(1):95–104.

[38] Strong SP, Koberle R, Bialek W (1998) Entropy and in-
formation in neural spike trains. Physical Review Letters
80:197.

9

FIG. 1: Inverting posture analysis to generate worm images. (A-E) We previously showed that the space of
C. elegans body postures is low-dimensional. (A) For a set of images of a freely moving worm, (B ) we ﬁnd the centerline of
the body using image thinning (black point indicates the head). (C ) At equidistant points along the centerline, we measure
the direction θ(s) of the tangent ˆt. After subtracting (cid:104)θ(cid:105), this gives a description of the worm’s shape that is intrinsic to the
worm itself. (D) Principal Component Analysis reveals that only four eigenvectors of the shape covariance matrix are needed
to account for ∼ 95% of the variance in θ(s). (E ) Hence, any body shape can be decomposed as a linear combination of
postural ‘eigenworms’. (F ) Alternatively, we can think of any body posture as a point in a low-dimensional ‘posture space’,
spanned by the eigenworms (gray). Forward crawling is then represented by clockwise progression along a circular trajectory
in the (a1, a2) plane (blue oval, body wave phase angle ϕ). (G) For any point in this space, we can easily calculate the shape
of the backbone. (H ) A series of ﬁlled circles with radii representing the worm’s thickness, are used to draw an image of the
worm’s body, inverting the original postural analysis to generate an image. For self-overlapping shapes such as in H, image
thinning (H, magenta) does not produce an accurate reconstruction of the posture (G, red).

sθt̂a1a2a3φa1a2a3a4+++=1234567801σK2K01−π0π/2π−π/2θ (rad)sθt̂sABCDEFGH10

FIG. 2: Tracking coiled shapes by searching for image matches in posture space. Top: tracking algorithm
sequence. (A) For each movie frame W and reconstituted worm image ˜W(p) for posture p we apply two metrics, one based
on the shape of the boundary (left), and one based on a coarse-grained pixel density matrix (right). (B ) An error function
ferr based on these two shape metrics generates a ﬁtness landscape (schematically shown). The position of the global
minimum of ferr corresponds to the tracking solution; if a frame is ambiguous, multiple minima may be present. (C ) For
non-crossed body postures, a simple image thinning algorithm suﬃces to obtain time series of the modes ai (blue line,
schematically shown). For crossed frames, we use the procedure outlined in A–B. Due to the inherent ambiguity of such
images, multiple solutions are generally found for each frame (light gray points). Using the ﬁltering algorithm described in
the main text, we identify the correct solutions (dark gray points). The resulting smooth trajectory (magenta, dotted line)
forms the full tracking solution. (D) Sample tracking results (bottom, while background), contrasted with original images
(top, gray background) for a turning sequence. Bottom: the inverse algorithm accurate tracks both simple and
coiled worm shapes with small error. (E ) Histogram of tracking errors for non–self-overlapping worm shapes, quantiﬁed
as the euclidean distance δθ between the tangent angle vector θ from our algorithm, and θ found by image thinning
(magenta). For scale, the error due to dimensionality reduction to the postural eigenmodes is shown in black. We also show
the euclidean distance between θ in consecutive frames, representing the conﬁdence in θ due to the ﬁnite time resolution of
the movie (gray). Even for an extreme value of δθ = 3 rad (gray arrow), backbones from the ‘classic’ algorithm (top) and our
algorithm (bottom) are nearly indistinguishable by eye (inset). (F ) Tracking error in eigenmode values for the ﬁrst four
modes. For uncrossed worm shapes (yellow/light), our algorithm shows negligible tracking errors. For a smaller set of crossed
frames, we compare to a manually found solution (blue/dark). For scale, we show reconstituted images for worms with a
single nonzero mode value of ai = 1; these ‘error worms’ are essentially ﬂat.

Non-crossedCrossed00.20.40.600.20.40.601230123Mode error δaiδa1δa3δa2δa4Dim. reduct.Inv. trackingTime res.00.020.040.060.080.10.12Tracking error δθ (rad)01234P(δθ)P(δθ)taicrosseda1a2ferrferrψt̂pshape metrics:,WW(p)~AEFBCt = 0 st = 0.25 st = 0.50 st = 0.75 st = 1.00 st = 1.25 st = 1.50 sDoriginal imagereconstruction11

FIG. 3: Tracking coiled postures and reorientation in the escape response. (A) Schematic overview [18] with worm
body shapes extracted from tracking data: i forward locomotion and exploratory head motions; ii infrared laser stimulus;
iii reversal phase; iv omega turn; v resumption of forward locomotion in the opposite direction. (B ) Trajectory through
posture space; ϕ indicates direction of increasing body wave phase angle and color encodes time with blue for t = 0 and red at
t = 30 s. The reorientation coil is evident as a large excursion along the third mode, starting at the red arrow. (C ) The same
trajectory as in B, in terms of the body wave phase angle ϕ and the postural modes (a3, a4). The heat shock occurs at
t = 10 s (pink bar). The omega turn is initiated by a head swing as seen in a4 followed by a large pulse in a3 and is linked to
a ‘re-reversal’, a return to forward movement. (D) An important feature of the escape response is the change in the worm’s
overall orientation and we apply our algorithm to track this reorientation for each response segment. While turning accounts
for much of the reorientation, the full response distribution is shaped by signiﬁcant contributions from all three segments. In
particular, the small but biased reorientations of the reversal and post-turn segments originate in the a3 ﬂuctuations outside
of the turn (see the time series in C and also Supporting Figure 1) and are consistent with the release and presence of the
monoamine tyramine during the entire response. (E ) The precision of the escape response is evident in the trial-mean
reorientation (cid:104)∆θ(cid:105). The mean reorientation in the reversal and post-turn segments closely cancel, suggesting a correction
mechanism at the level of the average response. In the inset to (D, Omega turn) we also show the distribution of a3
amplitudes and this is peaked near coiled shapes in which the worm barely touches-perhaps indicative of a strategy in which
the worm uses it’s own body to achieve ∼ 180◦ reorientations.

a3 ampl.1020‒2π‒π0π00.10.20.3Full response‒2π‒π0π0.100.20.3Post-omega‒2π‒π0π00.10.20.30.40.5Omega turn‒2π‒π0π00.10.20.3ReversalProbabilityOrientaƟon change Δθ (rad)ReversalTurnPost-omegaFull response−π0π/6⟨Δθ⟩ (rad)50‒5a420100‒10a34π8π0φTime (s)051015202530a3a2a11φt(i)(ii)(iii)(iv)(v)DCBAE12

FIG. 4: Unraveling coiled shapes during foraging reveals two distinct ventrally-biased classes of
large-amplitude turns. (A) (left) Probability of the amplitude of all local extrema in the time series of the third postural
eigenmode a3. Colors represent the sign of the a3 amplitude, and hence the dorsal (gray) or ventral (blue) direction of the
resulting turn. (A) (right) As previously, with all negative a3 amplitudes now plotted as positive. The peaked excess in the
distribution for large ventral bends correspond to ‘classic’ Ω (omega) shapes, and previously undescribed deeper δ (delta)
turns. Insets in A (left) show reconstructed worm shapes for the indicated a3 amplitudes. In B we show stills from a movie of
a worm making a classical omega turn (left, yellow), and a deep ‘delta’ turn (left, blue). The head is marked with a red dot
and the dashed lines indicate postures determined from our inverse tracking algorithm . The dynamics of δ-turns are largly
similar to Ω-turns diﬀering primarily in the the amplitude of the bending mode a3 and the overall time to complete the
maneuver (see Supporting Figure 2). (C ) Histogram of orientation change (∆(cid:104)θ(cid:105)) due to ventral omega turns (yellow/light)
and ventral delta turns (blue/dark). Ventral reorientations are accomplished through omega-turns. To reorient to the the
dorsal side, however, C. elegans employs delta-turns which ‘over-turn’ through the ventral side. (D ) Average turning rate
during the tracking experiment. Ventral omega and delta turns are temporally independent, suggesting a separate triggering
mechanism, but occur with approximately equal rates that adapt similarly with time spent away from food, a simple strategy
to avoid any dorsal-ventral navigational bias.

Time (103 s)Mean turning rate (10−3 s−1)51015202530δΩ0.51.01.52.012.515ventraldorsal180°0°90°270°Ω (omega):δ (delta):ta3 local extremum0102030Ωδa3 local extremumProbability00.020.040.060.080.1−30−20−100102030BCDA13

Supplementary Figure 1: Bias in the turning mode a3 and resulting reorientation occurs during all behaviors of the escape
response. From previous work on the interpretation of the postural eigenmodes, we know that the third eigenmode (an overall
bending of the worm) is linked to reorientation of the worm [12, 13]. We therefore tested if any asymmetry in the ﬂuctuations
of a3 during the reversal phase could be linked to the observed reorientations. Such asymmetry is also visible in Fig. 3C as a
baseline shift of the third mode during the reversal. (top) The mean a3 value, versus the resulting orientation change, during
the reversal and post-omega behaviors, respectively. The orientation change is strongly correlated with the mean a3 value.
(bottom) Peak amplitude of the a3 peak corresponding to the omega turn, versus the resulting orientation change. Histogram
of mean a3 values, during the reversal phase and post-omega phase, respectively, showing similarly asymmetric distributions.
Histogram of a3 peak amplitudes during the omega turn. We also show a reconstituted worm image for an a3 value of 15, for
which the worm is barely self-occluded.

Supplementary Figure 2: Omega and delta turns follow similar kinematics; while visually quite distinct, the primary
diﬀerence is the amplitude of the curvature pulse a3. (a) Typical time series for the postural eigenmodes a1..4 during a deep
delta turn; ϕ is the body wave phase angle, as deﬁned in Fig. 1F. Shaded area indicates the delta turn, as deﬁned in the
Methods. (b) Average eigenmode time series during a delta turn (blue, N = 348). Gray lines indicate SD. For comparison,
the average escape response omega turn is also shown (red dotted line). Time has been normalized with respect to the total
length of the turn: 6 s ± 2 s (mean ± SD) for delta turns, 7 s ± 3 s for escape-response omega turns.

Probability00.20.40.6a3 peak amplitude510152025‒π‒π/20π/2π‒505a3 meanProbability00.10.20.3‒505a3 mean‒3π/2‒π‒π/20π/2π0102030a3  peak amplitude‒π‒π/20π/2π‒505a3 meanProbability00.10.20.30.4a3 mean‒505reversalturnpost-turna450−5Normalized time00.10.20.30.40.50.60.70.80.91a320100−10010a2−10010a1−3π−πφTime (s)567891011121314−505a410020a3−10010a2−10010a1(a)(b)14

Supplementary Figure 3: The shifted mutual information between δ-turn and Ω-turn time series. Events are localized by
the large amplitude peaks in the curvature mode and bins from 2 to 20 seconds are used to convert these timings into a
binary event series. The mutual information is very small in all cases (for scale the entropy of either event series is ∼ 1 bit)
indicating that the two diﬀerent turn types occur independently. Dashes are estimated errors from ﬁnite sampling and red
lines denote the mutual information between shuﬄed time series which would be zero in the inﬁnite data limit.

Supplementary Figure 4: (left) Location of one of the 12 tracked worms over the course of a 35-minute tracking
experiment (oﬀ-food), starting at (0, 0) (black arrow). Ω-turns (orange) and δ-turns (blue) are highlighted. (right) An
enlargement of the area marked in gray. While both turns occur more frequently at early times, there is no correlated pattern
as consistent with their independence.

Supplementary Movies:
(1) https://dl.dropboxusercontent.com/u/26988873/LeveragingLowDimensions/EscapeResponse.avi. Tracking results for the
escape response. Left images are data while at the right are reconstructed images from our tracking algorithm.
(2) https://dl.dropboxusercontent.com/u/26988873/LeveragingLowDimensions/SpontaneousComplex.avi. Tracking results for
a complex, spontaneous coil. Left images are data while at the right are reconstructed images from our tracking algorithm.
(3) https://dl.dropboxusercontent.com/u/26988873/LeveragingLowDimensions/EescapeResponseModes.mp4. The dynamics
of the escape response in the space of the ﬁrst three eigenworms. On the right we show the full body posture which turns red
at the moment of the thermal impulse. On the left are the dynamics in mode space. The large-amplitude omega turn is
visible as a ‘ﬁgure-8’ trajectory. Note that even during the turn the body wave is advancing. In general, turning behavior is a
superposition of the body wave and curvature dynamics.

0-60delay Ɵme (s)6000.030-60delay Ɵme (s)6000.03I(δ,Ω) (bits)2-s bins10-s bins0-60delay Ɵme (s)6000.03I(δ,Ω) (bits)20-s binsI(δ,Ω) (bits)0-60delay Ɵme (s)6000.03I(δ,Ω) (bits)4-s bins−16−1481012X (mm)Y (mm)X (mm)Y (mm)−1001001020δΩ