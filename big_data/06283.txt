6
1
0
2

 
r
a

 

M
0
2

 
 
]
h
p
-
d
e
m

.
s
c
i
s
y
h
p
[
 
 

1
v
3
8
2
6
0

.

3
0
6
1
:
v
i
X
r
a

ConformingDiscretizationsofBoundaryElementSolutionsoftheElectroencephalographyForwardProblemL.Rahmounia,S.B.Adriana,b,K.Coolsc,F.P.AndriulliaaInstitutMines-Télécom/TélécomBretagne,TechnopoleBrest-Iroise,29238,Brest,FrancebTechnischeUniversitätMünchen,Arcisstr.21,80333Munich,Germany.cTheUniversityofNottingham,UniversityPark,Nottingham,NG72RD,UKAbstractInthispaperwepresentanewdiscretizationstrategyfortheboundaryelementformulationoftheElectroencephalography(EEG)forwardproblem.Boundaryintegralformulations,classicallysolvedwiththeBoundaryElementMethod(BEM),arewidelyusedinhighresolutionEEGimagingbecauseoftheirrecognizedadvantages,inseveralrealcasescenarios,intermsofnumericalstabilityandeﬀectivenesswhencomparedwithotherdiﬀerentialequationbasedtechniques.Unfortunatelyhowever,itiswidelyreportedinliteraturethattheaccuracyofstandardBEMschemesfortheforwardEEGproblemisoftenlimited,especiallywhenthecurrentsourcedensityisdipolaranditslocationapproachesoneofthebrainboundarysurfaces.Thisisaparticularlylimitingproblemgiventhatduringanhigh-resolutionEEGimagingprocedure,severalEEGforwardproblemsolutionsarerequiredforwhichthesourcecurrentsarenearorontopofaboundarysurface.ThisworkwillﬁrstpresentananalysisofstandardlyandclassicallydiscretizedEEGforwardproblemoperators,reportingonatheoreticalissueofsomeoftheformulationsthathavebeenusedsofarinthecommunity.WereportonthefactthatseveralstandardlyuseddiscretizationsoftheseformulationsareconsistentonlywithanL2-framework,requiringtheexpansiontermtobeasquareintegrablefunction(i.e.,inaPetrov-Galerkinschemewithexpansionandtestingfunctions).Instead,thosetechniquesarenotconsistentwhenamoreappropriatemappingintermsoffractionalorderSobolevspacesisconsidered.Suchamappingallowstheexpansionfunctiontermtobealessregularfunction,thussensiblyreducingtheneedformeshreﬁnementsandlow-precisionshandlingstrategiesthatarecurrentlyrequired.Thesemorefavorablemappings,however,requireadiﬀerentandconformingdiscretizationwhichmustbesuitablyadaptedtothem.Inordertoappropriatelyfulﬁllthisrequirement,weadoptamixeddiscretizationbasedondualboundaryelementsresidingonasuitablydeﬁneddualmesh.Wedevotealsoaparticularattentiontoimplementation-orienteddetailsofournewtechniquethatwillallowtherapidincorporationofourﬁndinginone’sownEEGforwardsolutiontechnology.WeconcludebyshowinghowtheresultingforwardEEGproblemsshowfavorablepropertieswithrespecttopreviouslyproposedschemesandweshowtheirapplicabilitytorealcasemodelingscenariosobtainedfromMagneticResonanceImaging(MRI)data.Keywords:EEG,InverseProblem,ForwardProblem,MixedDiscretizationsStateofthearthighresolutionElectroencephalography(EEG)canrighteouslybeconsideredafullyﬂedgedimagingtechniqueforthebrain(Acaretal.,2016).Itshightemporalresolution,to-getherwiththecompatibilityandcomplementaritywithotherimag-Emailaddresses:lyes.rahmouni@telecom-bretagne.eu(L.Rahmouni),simon.adrian@tum.de(S.B.Adrian),Kristof.Cools@nottingham.ac.uk(K.Cools),francesco.andriulli@mines-telecom.fr(F.P.Andriulli)ingstrategies(Magnetoencephalography(MEG),PositronEmis-sionTomography(PET),andMagneticResonanceImaging(MRI))(Siemsetal.,2016;Pengetal.,2016;Dabeketal.,2015;Bénaretal.,2007),explainsthesteadyinterestthatEEGisattractinginneuroimaging(Huangetal.,2015;Jorgeetal.,2015;Fiedereretal.,2016).ThepeculiarityofhighresolutionEEGs,withrespecttothetraditionalanalysesbasedongrapho-elements,isthereconstructionofthevolumebrainsourcesbasedonscalppotentialdata(Phillipsetal.,2002;Koessleretal.,2010).ThisistheEEGinversesourceproblem,whichis,asitiswell-known,ill-posed(Grechetal.,2008).ThesolutionoftheEEGinversesourceproblemreliesonmultipleiteratedsolutionsoftheEEGforwardproblemwhere,knowntheconﬁgurationofbrainsources,theelectricpotentialisrecoveredatthescalp(Pascual-Marqui,1999).TheaccuracyinthesolutionoftheEEGforwardproblemclearlyimpactsandlimitstheaccuracyoftheassociatedEEGinverseproblem:alowaccuracyofthesolutionsoftheEEGforwardproblemtranslatesinalowaccuracyoftheinverseproblemsolution(AcarandMakeig,2013).ThisresultsinthepressingneedtokeeptheaccuracyoftheEEGforwardproblemashighaspossible.AmongthetechniquestosolvetheEEGforwardproblem,BoundaryElementMethod(BEM)isawidelyusedone(Hallezetal.,2007a).Thisnumericalstrategyisbasedonanintegralformu-lationequivalenttothePoissonequationand,whencomparedwithothernumericalapproachesliketheFiniteElementMethod(FEM)ortheFiniteDiﬀerenceMethod(FDM)(Hallezetal.,2007b),BEMbasedsolversonlydiscretizethesurfacesenclosingthediﬀerentbrainregionsanddonotrequiretheuseofboundaryconditionstoterminatethesolutiondomain.Thisresultsininteractionma-tricesofasmallerdimensionality(Heetal.,1987)andexplainsthepopularityoftheBEMapproachinthescientiﬁccommunity.Unfortunately,standardBEMmethodsarenopanacea.Itiswidelyreported,infact,thattheaccuracyofstandardBEMschemesfortheforwardEEGproblemisoftenlimited,especiallywhenthecur-rentsourcedensityisdipolaranditslocationapproachesoneofthebrainboundarysurfaces(Fuchsetal.,2001;Heetal.,1999).ThisisaparticularlylimitingproblemgiventhatduringthesolutionoftheEEGinversesourceproblem,severalforwardEEGproblemso-lutionsarerequiredforwhichthetheprimarycurrentdensitytermsarenearorontopofaboundarysurface(Cosandier-Riméléetal.,2008;Fuchsetal.,1998).Threemainstrategieshavebeenreportedinliteraturetolimittheimpactofaccuracylosses:(i)theavoidanceofbrainsourcemodelingnearboundaries(Yvertetal.,2001),(ii)theuseofglobalorlocalmeshreﬁnementsthatcanbetterhandlethesingularityofthedipolarsourceterm(Meijsetal.,1989;ZanowandPeters,1995;Fuchsetal.,1998),and(iii)theintroductionofasymmet-ricboundaryelementformulation(Addeetal.,2003;Kybicetal.,2005).Alltheabovementionedtechniquescansensiblyimprovesource-relatedprecisionissues,butatthesametimetheypresentsomeundesirabledrawbacks:(i)avoidingthepositioningofdipo-larsourcesnearboundariesononehandrepresentsalimitationoncorrectmodeling(Cosandier-Riméléetal.,2008)andontheotherhanditincreasestheill-posednessoftheinverse-sourceproblem(Scherzer,2011).(ii)Theuseofmeshreﬁnementsincreasesthecomputationalburden,duetothehigherdimensionalityofthere-ﬁnedmodelsandthiscanresultinsubstantialineﬃciencies(Yvertetal.,2001;Woltersetal.,2007).Thisisespeciallytrueinthecon-textofinversesourceproblemsolutions,wheresourcesareoftenequallydistributedneartheboundariesofbrainlayers(Cosandier-Riméléetal.,2008).(iii)Theuseofsymmetricformulations,thatarebasedonacleverandcompleteexploitationoftherepresenta-tiontheorem,resultsinthesimultaneoussolutionoftwointegralequationsintwounknownsandsensiblyimprovestheaccuracyofBEMmethodbasedEEGimaging.However,theseformulationsresultsinmoreunknowns,whichincreasesthecomputationalcom-plexityoftheEEGforwardandinversesolutions.Moreover,thesymmetricformulationin(Addeetal.,2003;Kybicetal.,2005)presentsaconditioningthatisdependentandgrowingwiththenumberofunknowns(orequivalentlywiththeinverseofthemeshparameter).Thisill-conditioningresultsinharder-to-obtainnumer-icalsolutionsforrealisticproblemsasthematrixinversionbecomesanincreasinglyunstableoperation(SauterandSchwab,2011).Tocircumventtheabovementionedlimitations,thisworkpro-posesadiﬀerentapproach.Weﬁrststartfromanalyzingthemap-pingpropertiesofstandardEEGforwardproblemoperators(dou-bleandadjointdoublelayer).WereportonthefactthatstandardlyuseddiscretizationsoftheseoperatorsareconsistentonlywithanL2-formulation,requiringtheexpansiontermtobeasquareinte-grablefunction.Instead,thosetechniquesarenotconsistentwhenamappingintermsoffractionalorderSobolevspacesisconsidered.Suchamapping,inthecaseoftheadjointdoublelayeroperator,wouldallowtheexpansiontermtobealessregularfunction,sen-2siblyreducingtheneedformeshreﬁnementsandlow-precisionshandlingstrategiescurrentlyrequired.Thesemorefavorablemap-pings,however,requireadiﬀerentandconformingdiscretizationwhichmustbesuitablyadaptedtothem.SomeoftheauthorsofthisworkpresentedinthepastastrategytocomplywithproperSobolevspacemappingsbasedondualelements.Thisapproachwasintroducedin(Coolsetal.,2009)andnamed“mixeddiscretiza-tion”.MixeddiscretizationsareconformingwithrespecttoSobolevpropertiesofsecondkindoperators.Thisapproachhasbeensub-sequentlyappliedtoseveralproblemsinelectromagnetics(Coolsetal.,2011;Yanetal.,2011)andacoustics(Ylä-Oijalaetal.,2015).Inthisworkwehaveappliedthemixeddiscretizationconcepttothecaseofmulti-layeredEEGoperatorsusedtosolvepiecewiseho-mogeneousandisotropicnestedheadmodels.Thisdiscretizationstrategycanbeextendedtononnestedtopologies.TheresultingforwardEEGproblemsshowfavorablepropertieswithrespecttopreviouslyproposedschemes.Ascomplementtothetheoreticalandnumericaltreatments,aparticularattentionhasbeendevotedtoimplementation-orienteddetailsthatwillallowthespecializedpractitionertoeasilyincorporatetheseﬁndingsinhisEEGfor-wardsolutiontechnology.Verypreliminaryandpartialresultsofthiscontributionhavebeenpresentedinaconferencecontribution(RahmouniandAndriulli,2014).Thispaperisorganizedasfollows:inSection1weﬁrstre-viewclassicalEEGdiscretizationsandweanalyzetheirconsistencywithrespecttofractionalorderSobolevspacemappings;wethenintroducedualbasisfunctionsandthenewforwardEEGmixeddiscretizedformulationsweproposeinthiswork.InSection2,wepresentacompletenumericalstudyofthenewtechniquestocomparativelytesttheirperformanceagainstthestateoftheart.Thiswillbedoneonbothcanonicalsphericalmodels(forwhichbenchmarkingagainstanalyticsolutionsispossible)andonrealisticmodelsarisingfromMRIdata.Section3presentsourdiscussionoftheseresultsandourconclusions.1.Methods1.1.StandardIntegralEquationFormulationsoftheElectroen-cephalographyForwardProblemLetσbeasmooth,isotropicconductivitydistributionandletjbeaquasi-staticelectricvolumecurrentdensitydistributioninR3.Thecurrentdensityjgeneratestheelectricpotentialφ,arelationshipthatismathematicallyexpressedbythePoisson’sequation∇·σ∇φ=f=∇·j,inR3.(1)Whenσmodelstheconductivitydistributionofahumanhead,theproblemofﬁndingtheelectricpotentialφisdenotedastheEEGforwardproblem(Hallezetal.,2007a;Grechetal.,2008).InBEMtechniques,theheadisusuallymodeledbydomainsofdiﬀerentareasofconstantconductivity.TheconductivityσisapiecewiseconstantfunctiondividingthespaceR3inanestedsequenceofregionsasdepictedinFig.1.ThediﬀerentdomainscorrespondingtotheregionswhereσisconstantandequaltoσiarelabeledΩiwithi=1,...,N+1.ThedomainΩN+1istheexteriorregion,extendingtoinﬁnity,withσN+1=0.InΩN+1nocurrentsourcesarepresent.ThesurfacesseparatingthediﬀerentregionsofconductivityarelabeledΓiwithi=1,...,NasshowninFig.1.Inordertoaccountforpiecewisecontinuousσ,Eq.(1)mustbecomplementedbytransmissionandboundaryconditionsresultingin(Pruisetal.,1993)σi∆φ=finΩi,foralli=1,...,N,(2)∆φ=0inΩN+1,(3)(cid:2)φ(cid:3)j=0onΓj,forallj=1,...,N,(4)(cid:2)σ∂ˆnφ(cid:3)j=0onΓj,forallj=1,...,N.(5)Theexpression(cid:2)g(cid:3)jdenotesthejumpofthefunctiongatthesurfaceΓj,thatis,(cid:2)g(cid:3)j=g|−Γj−g|+Γj,(6)withg|−Γjandg|+ΓjtheinteriorandexteriorlimitsofgatthesurfaceΓj,respectively.Theselimitsaredeﬁnedasg|±Γj(r):=limα→0±g(r+αˆn)forallronΓj,(7)whereˆndenotesthenormalateachsurface(seeFig.1).3Ω1Γ1Γ2ΓNΩ2σ1σ2ΩNσNΩN+1σN+1=0ˆnˆnˆnFigure1:Nestedsequencesofregionswithconstantconductivity.1.1.1.BoundaryIntegralOperatorsBoundaryelementmethodsprovideanumericalapproximationofthepotentialφ(Huiskampetal.,1999;Steinbach,2008)whentheforwardEEGproblemiscastinanintegralequationformulation.Inthefollowing,weintroducetheintegraloperatorsandtheirmappingproperties,andwereviewthestandardintegralformulationsoftheEEGforwardproblem.Deﬁnition1(BoundaryIntegralOperators).LetΩ⊂R3beaboundedLipschitzdomainwithboundaryΓ:=∂Ω.WedeﬁnethesinglelayeroperatorS:H−1/2(Γ)→H1/2(Γ),(Su)(r)=ZΓG(r−r0)u(r0)dS(r0),(8)thedoublelayerandadjointdoublelayeroperatorD:H1/2(Γ)→H1/2(Γ),(Du)(r):=ZΓ∂ˆn0G(r−r0)u(r0)dS(r0),(9)D∗:H−1/2(Γ)→H−1/2(Γ),(D∗u)(r)=ZΓ∂ˆnG(r−r0)u(r0)dS(r0),(10)andthehypersingularoperatorN:H1/2(Γ)→H−1/2(Γ),(Nu)(r)=ZΓ∂ˆn,ˆn0G(r−r0)u(r)dS(r0).(11)Inthedeﬁnitionsabove,thefunctionG(r−r0)=14π|r−r0|(12)isthefree-spaceGreen’sfunction.TheSobolevspacesHx,x∈{−1/2,1/2},appearinginthemappingpropertiesarebrieﬂydeﬁnedinAppendixA.Remark.Thereadershouldbewarnedthatthereisnoconsistentnamingoftheoperatorsaboveintheliteratureandthenamingchoicemadehereistheoneclassicallyadoptedinpotentialtheory(seeforexample(SauterandSchwab,2011)).SourceModelingandInhomogeneousSolution.CurrentdipolesareacommonapproximationofbrainelectricsourcesmakingthemawidelyusedmodelintheforwardandinverseEEGproblem(DeMuncketal.,1988;Sarvas,1987;Schimpfetal.,2002).Thecurrentdipoleisdeﬁnedbyjdip(r)=qδr0(r)(13)whereqrepresentsthedipolemomentandδr0theDiracdeltafunction.Thecorrespondingpotentialinaninﬁnitehomogeneousdomainisvdip(r)=14πq·(r−r0)|r−r0|3.(14)Throughoutthefollowingsections,weusevs,Ωi=vdipforr0∈Ωi.(15)Moreover,whenevertwounderscoreindicesj,iareaddedtoanoperatorsymbolwemeanthat,indeﬁningtheoperator,theinte-grationisconstrainedtotheithsurfaceandtheintegralisevaluatedonlyonthejthsurface.Forexample,Sjiisdeﬁnedas(Sjip)(r)=ZΓiG(r−r0)p(r0)dS(r0),r∈Γj.(16)1.1.2.BoundaryIntegralFormulationsThreeintegralformulationsarecommonlyusedforcomputingtheelectricpotentialφinEq.(1)(Kybicetal.,2005;StenroosandSarvas,2012;Gramfortetal.,2014;Birotetal.,2014).Allofthemleveragethesameprinciple:theelectricpotentialφisdecomposedintoφ=vs+vh(17)4suchthatσi∆vs=finΩiforalli=1,...,N(seeEq.(2))andsuchthatvhisapiecewiseharmoniccorrectionensuringthatφwillsatisfytheboundaryconditions(4)and(5).Forsettingthenotationandforthesakeofself-consistency,welisttheseformulationsbelow;foramoredetailedderivation,wereferthereaderto(Kybicetal.,2005)andreferencestherein.Theadjointdoublelayerformulation.Inthisformulation,theansatzforvs1hasthefollowingform:vs1=NXi=1vs,Ωiσi.(18)ThischoicesatisﬁesEq.(2)andEq.(3),andinaddition,[vs1]j=0and[∂ˆnvs1]j=0.Theorem1inAppendixBisthenusedtoconstructaharmonicfunctionavh1suchthataNeumann’sboundaryconditionissatisﬁed.Itisobtainedthat∂ˆnvs1|Γj=σj+σj+12(σj+1−σj)qΓi−NXi=1D∗jiqΓifori=1,...,N.(19)Thedoublelayerformulation.Thefollowingparticularsolutionisputforward(see,forexample,Kybicetal.(2005)orStenroosandSarvas(2012))vs2=NXi=1vs,Ωi,(20)whichsatisﬁesEq.(2),[vs2]=0,and[∂ˆnvs2]=0.Aftercomple-mentingitwithaharmonicsolutionvh2thatsatisfy[∂ˆnvh2]=0,itisobtainedvs2|Γj=σj+σj+12φΓi−NXi=1(σi+1−σi)DjiφΓi.(21)ThesymmetricFormulation.Diﬀerentlyfromtheprevioustwoapproaches,inthesymmetricformulation,theharmonicfunctionvh3isconstructedasfollows(Kybicetal.,2005)vh3,Ωi=φ−vs,Ωiσi,inΩi,−vs,Ωiσi,inR3\Ωi.(22)Then,itcanbeshownthatσ−1i+1(vs,Ωi+1)(cid:12)(cid:12)Γi−σ−1i(vs,Ωi)(cid:12)(cid:12)Γi=Di,i−1φΓi−1−2DiiφΓi+Di,i+1φΓi+1−σ−1iSi,i−1dΓi−1+(σ−1i+σ−1i+1)SiidΓi−σ−1i+1Si,i+1dΓi+1(23)and(cid:0)∂ˆnvs,Ωi+1(cid:1)(cid:12)(cid:12)Γi−(cid:0)∂ˆnvs,Ωi(cid:1)(cid:12)(cid:12)Γi=σiNi,i−1φΓi−1−(σi+σi+1)NiiφΓi+σi+1Ni,i+1φΓi+1−D∗i,i−1dΓi−1+2D∗iidΓi−D∗i,i+1dΓi+1(24)holdfori=1,...,N.HerewehaveusedthenotationdΓi=σi∂ˆnφ|−ΓiIsolatedSkullApproach.Inthepresenceofalayeroflowcon-ductivity,thedoublelayerformulationsuﬀersfromnumericalin-accuracies.Toovercomethisproblem,HamalainenandSarvas(1989)proposedanumericalstrategynamedIsolatedSkullAp-proach.ThisschemewasﬁrstformulatedforathreelayeredheadmodelandthengeneralizedtoanarbitrarynumberoflayersbyMeijsetal.(1989);GençerandAkalin-Acar(2005).Theprincipleofthisapproachistowritethetotalpotentialasasumoftwoterms:φ=φISA+φcorr.(25)TheﬁrsttermφISAisthepotentialcomputedassuminganisolatedmodelconsistingofonlythecompartmentswhichareundertheskull.Thesecondpartφcorrisacorrectiontermcomputedasinthestandarddoublelayerformulationwitharighthandsideequal,forathreelayersmodel,tovs3=σskull(vs2+φISA),(26)whereσskullistheconductivityoftheskull.WenotethatφISAisdiﬀerentfromzeroonlyonsurfacescorrespondingtotissueslocatedundertheskull.Theisolatedskullapproachandthedoublelayerformulationusethesameoperator,namelyD;hence,bothschemeshavethesamerequirementsintermofmappingproperties.1.2.AnalysisoftheMainDrawbacksofStandardDiscretizationsToevidencethedrawbacksofstandard(currentlyusedinlitera-ture)BEMdiscretizationsoftheEEGforwardproblem,wehavetoconsiderPetrov-Galerkintheory,whichprovidestheconvergencepropertiesofanumericalboundaryelementsolutioninthecaseofasymmetricdiscretizations(Steinbach,2008).51.2.1.Petrov-GalerkinMethodReviewedLetXandYbeHilbertspaces,andA:X→Y0abounded,linearoperator.WecanassociatewithAabilinearforma:X×Y→Rthatsatisﬁes|a(x,y)|≤CkxkXkykYwithC>0.Wearefacedwiththevariationalproblemtoﬁndu∈Xsuchthata(u,v)=hf,viY0×Yforallv∈Ywithf∈Y0.Tosolvethisvariationalformulation,wecastthisproblemintoamatrix-vectorequationbyusingﬁnite-dimensionalsubspacesXh⊂XandYh⊂Ywithdim(Xh)=dim(Yh)=M.Thetaskistoﬁnduh∈Xhsuchthata(uh,vh)=hf,vhiY0h×Yhforallvh∈Yh.ThefunctionuhisanapproximationofuandthisapproachiscalledPetrov-Galerkinmethod(Steinbach,2008).ThekeyingredientofthePetrov-GalerkinmethodisthatthetestingisalwaysperformedinthedualspaceoftherangeofA,wherewenoticethatY00=YbecauseofthereﬂexivityofY.1.2.2.StandardDiscretizationsTheclassicalintegralequationspresentedinSection1.1.2arediscretizedusingaBEMapproach.ThediﬀerentregionsΩioftheheadareapproximatedwithpolygonaldomains.Onthesedo-mains,meshesaregeneratedbyusingatriangulartessellation.Thepotentialφisapproximatedbyalinearcombinationofexpansionfunctionsαi∈Xα,i.e.φ≈NαXj=1cjαjforr∈[iΓi,(27)wherecjarethe(unknown)expansioncoeﬃcients,andNα=dimXαisthedimensionalityofthefunctionspaceXα.Commonlyusedfunctionsarethepiecewiseconstantfunctions(PCFs)pj(alsoreferredtoaspatchfunctions)andPiecewiseLin-earFunctions(PLFs)λj(alsoreferredtoaslinearLagrangianorpyramidfunctions).Thesefunctionsformtheboundaryelementspacesspan(cid:40)pj(cid:41)Npj=1=:Xpandspan(cid:40)λj(cid:41)Nλj=1=:XλanditholdsthatXp⊂H−1/2andXλ⊂H1/2(Steinbach,2008).BoththePCFsandthePLFsformapartitionofunity.WedenotethesystemmatrixthatstemsfromthediscretizationofanoperatorXwiththeexpansionfunctionsαjandtestingfunctionsβiasXβαwith(cid:102)Xβα(cid:103)ij=(cid:16)βi,Xαj(cid:17)L2.(28)Thisnotationisnecessary,assomeoperatorsarediscretizedwithdiﬀerentexpansionandtestingfunctions.AstandarddiscretizationinliteraturefortheadjointdoublelayeranddoublelayerformulationistheonewherePCFsareusedasexpansionandtestingfunctions(Kybicetal.,2005;StenroosandSarvas,2012).UsingthenotationofEq.(28),suchadiscretizationfortheadjointdoublelayerformulationwouldreadIk,pp−D∗kl,pp=vs1,k,pk,l=1,...,N(29)where(cid:20)Ik,pp(cid:21)ij=σk+σk+12(σk+1−σk)(cid:16)p(k)i,p(k)j(cid:17)L2(Γk),(30)(cid:20)D∗kl,pp(cid:21)ij=(cid:16)p(k)i,D∗klp(l)j(cid:17)L2(Γk),(31)(cid:20)vs1,k,p(cid:21)i=(cid:16)p(k)i,∂ˆnvs1(cid:17)L2(Γk),(32)andqΓk≈Pi(cid:20)qk,p(cid:21)ip(k)i.ThePetrov-Galerkintheoryreviewedintheprevioussection,however,prohibitstheuseofPCFsastestingfunctionssinceontheright-hand-sidewehavethesumoftheidentityoperatorIandtheadjointdoublelayeroperatorD∗terms.SinceI:H−1/2→H−1/2,theentirerighthandsideisa(bijective)mappingfromH−1/2toH−1/2.ThedualspaceoftherangeisH1/2.AsXp*H1/2,wecannotusePCFsastestingfunctions:theyarenotregularenoughandthusthecommonlyuseddiscretizationoftheoperatorinEq.(29)isincompatiblewiththemappingH−1/2→H−1/2oftheoperator.Alsotheclassicaldiscretizationforthedoublelayerformulation(Eq.(21))isleveragingonPCFbothasexpansionandtestingfunctions,i.e.Jk,pp+ζlDkl,pp=vs2,k,pk,l=1,...,N(33)where(cid:20)Jk,pp(cid:21)ij=σk+σk+12(cid:16)p(k)i,p(k)j(cid:17)L2(Γk),(34)(cid:20)Dkl,pp(cid:21)ij=(cid:16)p(k)i,Dklp(l)j(cid:17)L2(Γk),(35)(cid:20)vs2,k,p(cid:21)i=−(cid:16)p(k)i,vs2(cid:17)L2(Γ)k,(36)andφΓk≈Pi(cid:20)φk,p(cid:21)ip(k)iandζl=−(σl+1−σl).ForthedoublelayerformulationEq.(33),weﬁndthattheoperatoronthe6left-handsideisamappingH1/2→H1/2,sinceImapsfromH1/2toH1/2.TherelationshipXp*H1/2impliesthattheuseofPCFsasexpansionfunctionsisforbidden.Moreregularexpansionfunctionsmustbeused.Thestandarddiscretizationofthesymmetricformulationreads(Kybicetal.,2005)−σkNkk−1,λλ+D∗kk−1,λp+ηkNkk,λλ−2D∗kk,λp−σk+1Nkk+1,λλ+D∗kk+1,λp=vsym,k,λ(37)Dkk−1,pλ−σ−1kSkk−1,pp−2Dkk,pλ+θkSkk,pp+Dkk+1,pλ−σ−1k+1Skk+1,pp=psym,k,p(38)where(cid:20)Nkl,λλ(cid:21)ij=(cid:16)λ(k)i,Nklλ(l)j(cid:17)L2(Γk),(39)(cid:20)Skl,pp(cid:21)ij=(cid:16)p(k)i,Sklp(l)j(cid:17)L2(Γk),(40)(cid:20)Dkl,pλ(cid:21)ij=(cid:16)p(k)i,Dklλ(l)j(cid:17)L2(Γk),(41)(cid:20)D∗kl,λp(cid:21)ij=(cid:16)λ(k)i,D∗klp(l)j(cid:17)L2(Γk),(42)(cid:20)vsym,k,λ(cid:21)i=(cid:16)λ(k)i,σ−1k+1(vs,Ωk+1)(cid:12)(cid:12)Γk−σ−1k(vs,Ωk)(cid:12)(cid:12)Γk(cid:17)L2,(43)(cid:20)psym,k,p(cid:21)i=(cid:16)p(k)i,(cid:0)∂ˆnvs,Ωk+1(cid:1)(cid:12)(cid:12)Γk−(cid:0)∂ˆnvs,Ωk(cid:1)(cid:12)(cid:12)Γk(cid:17)L2,(44)withηi=σi+σi+1,θi=σ−1i+σ−1i+1,φΓk≈Pi(cid:20)φk,λ(cid:21)iλ(k)i,anddΓk≈Pi(cid:20)φk,p(cid:21)ip(k)i.Incontrasttotheclassicaldiscretizationsofthedoublelayerandadjointdoublelayeroperators,thesymmet-ricformulationin(Kybicetal.,2005)isdiscretizedinawaythatiscompletelyconformingwithrespecttothefractionalorderSobolevspacemappings.ThesinglelayeroperatorSijmapsfromH−1/2toH1/2andthusthedualofitsrangeisthespaceH−1/2allowingtheuseofPCFsasexpansionandtestingfunctions(seeEq.(43)).ThehypersingularoperatorNijisdiscretizedwithPLFsasbothexpan-sionandtestingfunctions,sincethederivativesrendertheusageofPCFsimpossible(seeEq.(37)).ThisisaconformingchoicegiventhatalowerregularitywouldnotbeallowedsinceNijisamappingfromH1/2toH−1/2andthusbothexpansionandtestingfunctionsshouldbelongatleasttoH1/2.SimilarargumentscanbeusedtoshowtheconformityoftheexpansionandtestingfunctionchoicesforDijandD∗ijinEq.(41)andEq.(42),respectively.Furthermore,whilethedoublelayerandtheadjointdoublelayerapproachesgiverisetoadensematrices,thematricesobtainedfromthesymmetricapproacharebanddiagonal.Theentriesofthematrixofthesymmetricapproachincludeonlytheinteractionbetweenadjacentcompartments,whichconsequentlyreducesthecomputationalcost.Yet,thesymmetricapproachhastwodrawbacks:Itsdiscretiza-tiongivesrisetoamatrixwhichisoneandhalftimesthesizeofthematricesoftheprevioustwoapproachesandsincethesymmet-ricformulationoperatorisoftheﬁrstkind,theresultingmatrixisill-conditioned(whenthenumberofunknownsisincreasedbydecreasingtheaverageedgelengthh,theconditionnumbergrowsunbounded(SteinbachandWendland,1998).WenotethatthedoublelayerandadjointdoublelayerformulationsareFredholmintegralequationsofthesecondkind(Hackbusch,2012).Thiskindofequationsgivesrisetowell-conditionedsystems.Higherorderfunctionscouldbeusedtosolvetheabovemen-tionedproblemsinstandarddiscretizationsofthedoubleandadjointdoublelayeroperator.Forexample,giventhatthePLFsbelongtothespaceH1/2andthisspaceitselfisasubsetofthespaceH−1/2,onecouldthinkofusingPLFsasexpansionandtestingfunctionsinEq.(29)andEq.(33).Althoughthisleadstoaconformingtesting,itresultsinschemesthathaveeitherexpansionortestingfunctionsmoreregularthannecessary,whichcanslowdowncon-vergenceoftheapproximatesolutiontotheexactsolutionashdecreases;thiseﬀectisespeciallynotableinthepresenceofirregu-largeometriessuchashighlyrealisticphantomsofthehumanhead.Moreover,theusageofPLFsincreasesthecomputationalburden:thehandlingofthesingularityoftheGreen’sfunction(Graglia,1987,1993;DeMunck,1992)intheintegrationroutinesbecomescomputationallymoreexpensiveandmorediﬃculttoimplement.Summarizing,thestandardloworderdiscretizationsoftheEEGforwardproblemdonotcomplywiththeEEGoperatorsrequire-mentsintermsofregularityandcanleadtoerroneoussolutions,whilethesymmetricformulationiscorrectlydiscretizedbutre-quiresfourtimesthememoryspaceanditisanill-conditioned7Table1:Theabbreviationsanddiscretizationsofthestandardformulations.LabelFormulationFunctionDrawbacksExpansionTestingStandardDiscretizations1AaAdj.doublelayerppURfortesting1AbAdj.doublelayerλλERforexpansion1BaDoublelayerppURforexpansion1BbDoublelayerλλERfortesting1Bb-ISAISAλλERfortesting1CSymmetricp,λp,λDouble-sizedandill-conditionedsystemmatrixER:ExcessiveregularityUR:InsuﬃcientregularityISA:Isolatedskullapproachformulation.Theproblemcouldbeamelioratedbyhigherorderfunctions,butthisincreasesthecomputationalburden,anditismorecomplicatedtoimplement.TheaboveconsiderationsaresummarizedinTab.1.1.3.NewMixedDiscretizedEEGFormulationsAjointapplicationofPCFsandPLFsisnotpossiblewithoutgettingarectangularmatrix–owingtothefactthatthenumberofPCFsNpequalsthenumberofcellsofthemeshNCells,whilethenumberofPLFsNλequalsthenumberofinnernodesNNodesofthemesh.WemustuseanewsetofPCFsandPLFswhosespanhastherightdimension.Suchfunctionscanbeconstructedbyusingthedualmesh,thatis,themeshwherethenodesoftheoriginalmeshbecomecellsandviceversa.Inthefollowing,werefertothesefunctionsasDualPiecewiseConstantFunctions(DPCFs)(cid:72)piandDualPiecewiseLinearFunctions(DPLFs)(cid:72)λi,andtheyformthespacesX(cid:72)pandX(cid:72)λ.α1α2α3α4α5α6α7α8α9α10α11α12Figure2:Thestandard(thicklines)andthebarycentricallyreﬁned(thinlines)mesh.Thegreyareaisadualcell.Thedualmeshisobtainedbybarycentricallyreﬁningastandardtriangularmesh:eachtriangleissplitintosixsub-trianglesbyconnectingthemidpointsofeachedgewiththeoppositenode.ThisisshowninFig.2,wheretheoriginalcellsarethosewithboldedges.Theunionofthegreyedcellsaroundthecenternodeofthisﬁgureformthedualcell.Inthefollowing,amixeddiscretizationschemefortheEEGbasedforwardproblemisproposed.TheoperatorsarediscretizedandtestedinaconformingwaywithrespecttoSobolevspacemap-pingproperties.Mixedandconformingdiscretizationtechniqueswereintroducedby(Coolsetal.,2009)inthecontextoffullwavesolutionsofscatteringproblems.Thesediscretizationsmakeuseofsuitablychosendualfunctions.Thereareseveralwaystodeﬁnethesedualfunctions.Inthisworkweadoptthefunctionspro-posedin(BuﬀaandChristiansen,2007)inthecontextofCalderonpreconditioningofscatteringproblems.1.3.1.DualFunctionsThedeﬁnitionoftheDPCFsissimple.ThesupportoftheDPCF(cid:72)pjisgivenbythecellsonthebarycentricallyreﬁnedmeshthatareattachedtothejthnode(Fig.2showsthesupportofaDPCF).Whenrisinthesupportof(cid:72)pj,thefunctionvalue(cid:72)pj(r)=1andiszerowhenrisnotinthesupportof(cid:72)pj.LetpbaribethestandardPCFsdeﬁnedonthebarycentricallyreﬁnedmesh.FortheexamplegiveninFig.2,weﬁnd(cid:72)pj=12Xi=1αipbari,(45)8β1β2β5β4β7β3β6Figure3:Transformationmatrixcoeﬃcientwhereαi=1foralli=1,...,12.Thefunction(cid:72)λjisattachedtothecelljanditcanberepresentedasalinearcombinationofsevenstandardPLFsλbarjdeﬁnedonthebarycentricallyreﬁnedmesh.Fig.3showsthegeneralcase,wherethenodesofthesevenrelevantPLFsarelabeledwiththecoeﬃcientsβithatarechosensuchthat(cid:72)λj=7Xi=1βiλbari.(46)Fortheﬁrstcoeﬃcient,whichisassociatedwiththecenterPLF,wealwayshaveβ1=1,whileforthenextthreecoeﬃcients,whichareassociatedwiththePLFsdeﬁnedonthemidpointsoftheedgesoftheprimalcell,wealwayshaveβi=1/2withi=2,...,4.Thelastthreecoeﬃcientsβ5,β6andβ7,whichareassociatedwithPLFsdeﬁnedonnodesoftheprimalcell,theirweightsaregivenby1/NCells,iwithi=5,...,7andNCells,ibeingthenumberofcellsoftheprimalmeshthatareattachedtotherespectivenode.Intheexamplegiven,thecoeﬃcientsareα5=1/5,α6=1/6,andα7=1/6.ItcanbeshownthattheseDPLFsformapartitionofunity(BuﬀaandChristiansen,2007).Fig.4visualizesanexampleofaDPLFfunction.1.3.2.NewFormulationsFollowingtheconsiderationsoftheprevioussections,wepro-posenewmixeddiscretizationstrategiesfortheadjointdoublelayer,doublelayerandsymmetricapproaches.Fortheadjointdou-blelayerapproach,weusestandardPCFsasexpansionandDPLFsFigure4:AnexampleofatypicalBCpiecewiselinearfunction.astestingfunctions.ThisresultsinI1,(cid:72)λp−D∗11,(cid:72)λp−D∗12,(cid:72)λp−D∗13,(cid:72)λp−D∗21,(cid:72)λpI2,(cid:72)λp−D∗22,(cid:72)λp−D∗23,(cid:72)λp−D∗31,(cid:72)λp−D∗32,(cid:72)λpI3,(cid:72)λp−D∗33,(cid:72)λp·q1,pq2,pq3,p|{z}qp=vs1,1,(cid:72)λvs1,2,(cid:72)λvs1,3,(cid:72)λ,(47)where(cid:20)Ik,(cid:72)λp(cid:21)ij=σk+σk+12(σk+1−σk)(cid:16)(cid:72)λ(k)i,p(k)j(cid:17)L2(Γ),(48)(cid:20)D∗kl,(cid:72)λp(cid:21)ij=(cid:16)(cid:72)λ(k)i,D∗klp(l)j(cid:17)L2(Γ),(49)(cid:20)vs1,k,(cid:72)λ(cid:21)i=(cid:16)(cid:72)λ(k)i,∂ˆnvs1(cid:17)L2(Γ),(50)andqΓk≈Pi(cid:20)qk,p(cid:21)ip(k)i.Forthedoublelayerapproach,ontheotherhand,weusestandardPLFsasexpansionandDPCFsastestingfunctions.ThesystemwehavetosolveisJ1,(cid:72)pλ+ζ1D11,(cid:72)pλζ2D12,(cid:72)pλζ3D13,(cid:72)pλζ1D21,(cid:72)pλJ2,(cid:72)pλ+ζ2D22,(cid:72)pλζ3D23,(cid:72)pλζ1D31,(cid:72)pλζ2D32,(cid:72)pλI3,(cid:72)pλ+ζ3D33,(cid:72)pλ·φ1,λφ2,λφ3,λ|{z}φp=vs2,1,(cid:72)pvs2,2,(cid:72)pvs2,3,(cid:72)p,(52)9Table2:Theabbreviationsanddiscretizationsofthenewformulations.LabelFormulationFunctionExpansionTestingMixedDiscretizations(Thiswork)2AAdjointdoublelayerp(cid:72)λ2BDoublelayerλ(cid:72)p2B-ISAIsolatedskullapproachλ(cid:72)p2CNewSymmetricp,λ(cid:72)p,λwhere(cid:20)Jk,(cid:72)pλ(cid:21)ij=σk+σk+12(cid:16)(cid:72)p(k)i,λ(k)j(cid:17)L2(Γ),(53)(cid:20)Dkl,(cid:72)pλ(cid:21)ij=(cid:16)(cid:72)p(k)i,Dklλ(l)j(cid:17)L2(Γ),(54)(cid:20)vs2,k,(cid:72)p(cid:21)i=−(cid:16)(cid:72)p(k)i,vs2(cid:17)L2(Γ),(55)andφΓk≈Pi(cid:20)φk,λ(cid:21)iλ(k)iandζl=−(σl+1−σl).Forthesakeofcompleteness,wealsoconsideramixeddis-cretizationforthesymmetricformulation.Whenamixeddis-cretizationisappliedtoEq.(23)andEq.(24),weobtainarectan-gularsystemmatrix.Toobtainasquaresystemmatrix,weproposeaslightlymodiﬁedsymmetricformulationgivenby(vs,Ωi+1)(cid:12)(cid:12)Γi−(vs,Ωi)(cid:12)(cid:12)Γi=σiDi,i−1φΓi−1−(σi+σi+1)DiiφΓi−(σi−σi+1)φΓi+σi+1Di,i+1φΓi+1−Si,i−1dΓi−1+2SiidΓi+Si,i+1dΓi+1(56)and(cid:16)σ−1i∂ˆnvs,Ωi+1(cid:17)(cid:12)(cid:12)(cid:12)Γi−(cid:16)σ−1i+1∂ˆnvs,Ωi(cid:17)(cid:12)(cid:12)(cid:12)Γi=Ni,i−1φΓi−1−2NiiφΓi+Ni,i+1φΓi+1−σ−1iD∗i,i−1dΓi−1+(cid:16)σ−1i+σ−1i+1(cid:17)D∗iidΓi−(cid:16)σ−1i−σ−1i+1(cid:17)dΓi−σ−1i+1D∗i,i+1dΓi+1(57)Inthecaseofthreelayers,theexplicitexpressionoftheresultinglinearsystemisgiveninEq.(51),whereweuse(cid:20)Nkl,(cid:72)λλ(cid:21)ij=(cid:16)(cid:72)λ(k)i,Nklλ(l)j(cid:17)L2(Γk),(58)(cid:20)Skl,(cid:72)pp(cid:21)ij=(cid:16)(cid:72)p(k)i,Sklp(l)j(cid:17)L2(Γk),(59)(cid:20)Dkl,(cid:72)pλ(cid:21)ij=(cid:16)(cid:72)p(k)i,Dklλ(l)j(cid:17)L2(Γk),(60)(cid:20)D∗kl,(cid:72)λp(cid:21)ij=(cid:16)(cid:72)λ(k)i,D∗klp(l)j(cid:17)L2(Γk),(61)(cid:20)vsym,k,(cid:72)p(cid:21)i=(cid:16)(cid:72)p(k)i,(vs,Ωk+1)(cid:12)(cid:12)Γk−(vs,Ωk)(cid:12)(cid:12)Γk(cid:17)L2,(cid:20)psym,k,(cid:72)λ(cid:21)i=(cid:18)(cid:72)λ(k)i,(cid:16)σ−1k∂ˆnvs,Ωk+1(cid:17)(cid:12)(cid:12)(cid:12)Γk−(cid:16)σ−1k+1∂ˆnvs,Ωk(cid:17)(cid:12)(cid:12)(cid:12)Γk(cid:19)L2,withcoeﬃcientsαi=(σi+σi+1),βi=(σi−σi+1)/2,γi=(cid:16)σ−1i+σ−1i+1(cid:17),δi=(cid:16)σ−1i+1−σ−1i(cid:17)/2,.AnimportantpointtonoteisthattheBEMequationsmentionedabovecorrespondtotheinteriorNeumannproblem.Therefore,thepotentialisonlydetermineduptoanadditiveconstant.Thisgivesrisetosingularmatrices.Hence,anadditionalconditionisneededtosolvethesesystems.ThemostcommonlyusedoneisRΓφdS(r)=0whichcorrespondstoasurfacepotentialofzeromean.Wedonotfurtherdetailthispointgiventhatthisisastandardprocedurewhichiswidelydocumented(RaholaandTissari,2002;Chan,1984).β1I(cid:72)pλ+α1D11,(cid:72)pλ−2S11,(cid:72)pp−σ2D12,(cid:72)pλS12,(cid:72)pp−2N11,(cid:72)λλδ1I(cid:72)λ(cid:72)p+γ1D∗11,(cid:72)λpN12,(cid:72)λλ−σ−12D∗12,(cid:72)λp−σ2D21,(cid:72)pλS21,(cid:72)ppβ2I(cid:72)pλ+α2D22,(cid:72)pλ−2S22,(cid:72)pp−σ3D23,(cid:72)pλN21,(cid:72)λλ−σ−12D∗21,(cid:72)λp−2N22,(cid:72)λλδ2I(cid:72)λp+γ2D∗22,(cid:72)λpN23,(cid:72)λλ−σ3D32,(cid:72)pλS32,(cid:72)ppβ3I(cid:72)pλ+α3D33,(cid:72)pλφ1,λd1,pφ2,λd2,pφ3,λ=vsym,1,(cid:72)ppsym,1,(cid:72)λvsym,2,(cid:72)ppsym,2,(cid:72)λvsym,3,(cid:72)p,(51)10TheintegralsfoundintheoperatorsDandD∗arecomputednumericallyusingGaussquadrature(Dunavant,1985)withsevenpointswhentheexpansionandtestingtrianglearefarfromeachother.Whentheexpansionandtestingtrianglesaretooclosesuchthatthesingularkernelcannotbenumericallyintegratedaccuratelyenough,weemployasingularityextractiontechnique(Graglia,1993)fortheinnerintegrations.FortheintegrationoftheNoper-ator,wefollowastandardapproachbyusingitsweakformulationsuchthatthederivativesareplacedonthetestingandexpansionfunctions(Steinbach,2008).Theidentityoperatorsarealwayscomputedanalytically.2.ResultsToshowthepracticalimpactofournewlyproposedschemes,wecomparedthemwithsomeofthemostcommonBEMformulations.Aﬁrstsetofcomparisonshasbeenobtainedonthetraditionalmulti-layeredsphericalmodel(DeMunck,1988;MunckandPeters,1993;Zhang,1995).Thereasonforthischoiceisthattheanalyticsolutionavailableforsuchamodelprovidesarigorousreferenceforsolidlyassessingthenumericalperformanceofalldiﬀerentformulations.ThissetofcomparisonsisthencomplementedbyasecondonewhereweshowthatournewmethodsarenaturallyapplicabletoMRI-obtainedmodelsandthatalsointhiscasetheirperformancecomparesquitefavourablywiththeexistingtechniques.2.1.NumericalExperimentsonaLayeredSphericalHeadModelTheradiioftheconcentricspheresofthemodel(Fig.5)are0.87dm,0.92dm,and1dm.Eachsphereistriangulatedwithanaverageedgelengthh=0.17dmresultingin700elementsonﬁrstlayer,796elementsonthesecondlayerand920elementsonthethirdlayer.Thetriangulationisuniformdeliveringameshofap-proximatelyequallysizedandshapedelements.Thecorresponding(normalized)conductivitiesareσ1=1,σ2=1/15,andσ3=1,whichweabbreviatewiththeratio1:1/15:1(Oostendorpetal.,2000).Thesourceismodeledbyacurrentdipoleofmagnitudeoneandoforientation(cid:20)101(cid:21)T.InTabs.1and2,wesummarizethediﬀerentdiscretizationstrate-giesand,accordingly,wereferencethesestrategiesinthelegends0.87dm0.92dm1dmσ1=1σ2σ3=1σ4=0Γ1Γ2Γ3Figure5:Themulti-layeredsphericalstructurethatisusedfortheevaluationofthediﬀerentdiscretizations.Note,thattheconductivityσ2wasvariedinpartsofthesimulations.oftheplots.Inthisscenario,weconductedthreesimulationswherethepo-sitionofthedipolewasthevaryingfactor.Intheﬁrstexperiment(Fig.6),thedipolewasmovedalongthelinebetweenthecenterofthesphericalmodelandatrianglevertexlocatedontheinnermostsphere,inthesecondexperiment(Fig.7),thedipolewasmovedalongthelinebetweenacentroidofatrianglelayingonthein-nermostsphereandthecenterofthespheres.Finally,inthethirdexperiment(Fig.8),thedipolewasmovedalongalinebetweenthecenterofthesphericalmodelandapointthatdoesnotcorrespondtocentroidnortoanode.Allﬁgures6to8show,fordiﬀerentfor-mulations,therelativeerrorwithrespecttotheanalyticsolutionasafunctionofthesourcedipole’sradialdistancefromthecenterofthespheres.Weseethattherelativeerrordependsonthepositionofcurrentsourcewithrespecttothenearestvertex.Wealsoseethat,ingeneral,therelativeerrorincreaseswhenthedipoleapproachesthesurfaceΓ1.However,theformulationsproperlydiscretizedarelessaﬀectedbythisphenomenonthanotherformulations.Thedualadjointdoublelayerandthesymmetricformulationspresentsmoreaccurateresultsinallcases.110.750.80.850.90.95110−1100Relativepositionrin%Relativeerror1Aa1Ab1Ba1Bb1C2A2B2C1Bb-ISA2B-ISAFigure6:relativeerrorasafunctionofthedipolepositioninsidethesphereΓ1withtheconductivityσ2=1/15Sm−1.Thedipoleisunderavertex.ItiswellknownthattheBEMformulationsdependonthequalityofmeshthatdiscretizesthecomputationaldomain.Thereforewehaverunnedanothersetofsimulationswherethesphericalmodelwasdiscretizednonuniformly.Thismeansthatthetriangle’snodesarearbitrarilylocatedoverthethreespheresandthenumberofcellsconnectedtoaparticularnodevaryfromnodetonode.ThetotalnumberoftrianglesoneachlayerwasN=900.Aftercomputingthescalppotentialfordiﬀerentcurrentsourcepositions,wereportedtherelativeerrorinfig.9,whereananalyticalsolutionwasusedasreference.Weobservethatthebehaviorofthediﬀerentformulationsissimilartothepreviouscaseinwhichthedualadjointdoublelayerprovidesthehighestaccuracy.ThebehavioraswellastheaccuracyofthediﬀerentBEMfor-mulationsdependontheconductivityratioofthediﬀerentcom-partmentsofthehead.ThisaspecthasbeeninvestigatedandtheresultsareshowninFig.10displayingtherelativeerrorasafunc-tionoftheelectricresistivity1/σ2whenthedipoleispositionedat0.83dmalongthex-axis.Weobservethatthestandardnon-conformingdiscretizationsofdoublelayerandadjointdoublelayeroperator(1Aaand1Ba)aremorestronglyimpactedbythechangeoftheconductivityσ2thantheotherformulations.Inaddition,we0.750.80.850.90.95110−1100Relativepositionrin%Relativeerror1Aa1Ab1Ba1Bb1C2A2B2C1Bb-ISA2B-ISAFigure7:relativeerrorasafunctionofthedipolepositioninsidethesphereΓ1withtheconductivityσ2=1/15Sm−1.Thedipoleisunderacentroid.observethatthemixedadjointdoublelayerformulationissuperiorwhenthenormalizedelectricresistivity1/σ2isbelow45.Theiso-latedskullapproach(ISA)isoftenusedinliteratureinthepresenceofalayeroflowconductivitytomitigateitsimpactonthesolutionerrorHamalainenandSarvas(1989);Meijsetal.(1989);GençerandAkalin-Acar(2005).Figure10showsalsotheimpactoftheuseoftheISAtechniqueonbothstandardformulationsandonthemixeddiscretizedschemesthatweproposeinthiswork.ItisfoundthatthebeneﬁtsoftheISAandofthediscretizationtechniqueweproposearecumulativeandthatthetwotechniquescanbeperfectlyusedtogether.FunctionalassessmentandcerebraldiagnosticofbrainactivityofnewbornshasmotivatedanincreasedinterestinneonatalEEGsourcelocalization(Patrizietal.,2003;Watanabeetal.,1999).Theskullconductivityofinfantsdiﬀersfromtheskullconductivityofadults(Ernstetal.,2011)andaheadmodelofonecompartmentisoftenusedtoobtainareliablesourcelocalization(Odabaeeetal.,2012;Silauetal.,1994;Odabaeeetal.,2014).Thusweusedasinglespherewithhomogeneousconductivitytomodelthissce-nario(Despotovicetal.,2013).Fig.11showstherelativeerrorofthediﬀerentEEGforwardproblemmethodsforthisscenario.The120.750.80.850.90.95110−1100Relativepositionrin%Relativeerror1Aa1Ab1Ba1Bb1C2A2B2C1Bb-ISA2B-ISAFigure8:relativeerrorasafunctionofthedipolepositioninsidethesphereΓ1withtheconductivityσ2=1/15Sm−1.Thedipoleisnotunderavertexnorunderacentroid.mixedadjointdoublelayerapproachshowsthebestperformancecomparedwithanyotherformulation.2.2.NumericalexperimentsonanMRI-obtainedheadmodelAlthoughsphericalmodels(andassociatedanalyticalsolutions)arefundamentalforarobustassessmentofanynewlyproposedforwardsolutionstrategy,itisoffundamentalimportancetoshowtheapplicabilityandperformanceofthetechniqueproposedhereonrealisticMRI-obtainedheadmodels.Thesemodelsallowforanindividual-basedheadmodeltobeusedinsolvingtheforwardproblemandtranslatesinmoreprecisesourcelocalizationHuangetal.(2015).Diﬀerentwell-establishedmethodsexistinthelit-eratureforextractingthecerebralinterfacesandareavailableinseveralcommercialandacademicpackagesincludingCurry,Sca-nIP,ASA,BESA,FieldTripOostenveldetal.(2010),FMRIBSmith(2002),FreeSurferFischletal.(2004),BrainVISAGeﬀroyetal.(2011),BrainSuiteShattuckandLeahy(2002),3DSlicerFedorovetal.(2012),andBrainVoyagerGoebel(2012).InournumericalexperimentwehaveleveragedonBrainSuitetoobtainanautomaticsegmentationofthebrain,CSF,skullandscalp.TheMRIimagesusedhereareaT1-weightedscansof256×256×256cubicvoxels0.750.80.850.90.95110−210−1100Relativepositionrin%Relativeerror1Aa1Ab1Ba1Bb1C2A2B2C1Bb-ISA2B-ISAFigure9:relativeerrorasafunctionofthedipolepositioninsidethesphereΓ1withtheconductivityσ2=1/15Sm−1.Nonuniformmeshing.(refertoFig.12).Afterfollowingthestandardpipelinetorecon-structthesurfacesofheadtissues,theobtainedmodelismadeof97338,50398and40634cellsforthebrain,theskullandthescalprespectively.Theconductivityofthebrain,CSF,skullandthescalpisσ1=1,σ2=5.42,σ2=1/15,andσ3=1respectively.Aftertheforwardproblemhasbeensolved,theresultingsurfacepotentialcanbevisualizedinFig.13.Sincetheexactsolutionisunavailableinthiscase,FEMservedasareference.Itwassolvedonreﬁnedmodelhaving6milliontetrahedronsandtherelativeerrorwascalculatedatthepositionof128electrodespositionedaccordingtoanEGIsystem(seeFig.14).TheresultsofthisbenchmarkingcanbeseeninFig.15,whereadipolarsourcewasmovedfromthecenteroftherighthemispherealongthezaxisandtherelativeerrorwithrespecttothereferencesolutionhasbeencomputedforallapproachespresentedintheprevioussection.Weobservethatthedualadjointdoublelayerandthesymmetricformulationsdeliversthemostaccurateresults.Tab.3summarizesthemeasurementofthememoryandcompu-tationaltimetosolvetheforwardproblem.Timingmeasurementsconcernsonlytheadjointdoublelayerandthedoublelayerformu-lationswithdiﬀerentdiscretizationschemes.Themachineusedis132030405060708010−1.510−110−0.5Normalizedelectricresistivity1/σ2Relativeerror1Aa1Ab1Ba1Bb1C2A2B2C1Bb-ISA2B-ISAFigure10:relativeerrorasafunctionofthenormalizedelectricresistivity1/σ2whenthedipoleispositionedat0.83dmalongthex-axis.aDellserverR920workingunderwindowssystem.Fromthetableweconcludethatproposedmixeddiscretizationisnotmorecom-putationaldemandingwhilecomplyingwiththeoperatorsmappingproperties.3.DiscussionandconclusionsNumericalresultsconﬁrmthatclassical,commonlyused,dis-cretizationsoftheintegraloperatorsDandD∗resultinsubstan-tiallylowerlevelofaccuracythanthoseachievablewiththeirmixeddiscretizedcounterpartsweproposehere(Figs.6to9).Ifwethenlookforthebestpossibleforwardproblemformulationsacrossalldiﬀerentoperators,dependingonthescenario(positionofthedipole,conductivity),eitherthemixeddiscretizationorthepiece-wiselinearPLFsdiscretizationoftheadjointdoublelayeroperator(2Aand1Ab)providetheoverallbestaccuracy.Thereadershouldrememberhowever,thatthePLFdiscretizationalwayscomesatthepriceofanincreaseinthecomputationalburden.Moreover,everytimethedipolarbrainsourcecomesclosetoabrainlayerinterface,weﬁndthatthemixeddiscretizationyieldsalwaysthebestaccuracy.Wevariedtheconductivityoverawiderangeofvalues.Inrecentreportstheconductivityratioofbrain,skull,andscalpis405060708010−310−210−1Positionalongtheradiusofthespherein%Relativeerror1Aa1Ab1Ba1Bb1C2A2BFigure11:Singlecompartmentsphere:relativeerrorasafunctionofthedipoleposition.Figure12:MRI-basedheadmodel:Scalp,skull,brain,andCSF.estimatedfromin-vivomeasurementstobebetween1:1/15:1and1:1/25:1,andtheratio1:1/80:1arisingfrominvitromeasurementsandwhichuntilrecentlyhasbeenusedinneuroimagingapplicationsiscurrentlyquestioned(Gonçalvesetal.,2003;Zhangetal.,2006;Oostendorpetal.,2000;Clercetal.,2005).Wehaveobservedthatfortherelevantrangeofinvivomeasuredconductivities,themixedadjointdoublelayerformulationyieldsthehighestaccuracycomparedwithothermethods.Thisisalsothecaseforthescenariowhereaheadofanewbornismodelled(seeFig.11):themixeddiscretizationoftheadjointdoublelayerformulationobtainsthehighestaccuracy.Fromourexperimentsitisevidentthatalsothesymmetricfor-mulationperformsquitewellwhenthedipoleisnearthesurface(seeFigs.6to9).Thisisconsistentwiththetheoreticalconsider-14Figure13:MRI-basedheadmodel:surfacepotentialFigure14:MRI-basedheadmodel:electrodes’positionsationthatthesymmetricformulationisaconforminglydiscretizedscheme.However,itshouldbenotedthatthesymmetricformu-lationcomesatthecostofaconsiderablecomputationalburden.Thedimensionofthesystemmatrixisoneandahalftimesthesizeofthematricesofthemixeddiscretization.Thusthesymmetricformulationiscomparativelylesscompetitiveinthesourcelocal-izationprocess,wherethepropagationmodelneedstobecalculatedmanytimes.Forthesakeofcompleteness,wealsopresentedamixeddis-cretizationofthesymmetricformulation.Noadvantageswereobserved,sincetheoriginalsymmetricformulationwasalreadydiscretizedconformingly,andtheobtainedsystemisplaguedwiththesamedrawbacksastheoriginalsymmetricformulation.Wenotealsothattheapplicationoftheisolatedskullapproachim-provestheaccuracyofthesolution,especiallyforshallowdipoles.Theimprovement,however,comesatthecostofsomeadditionalcomputations.Inconclusion,thenumericalresultsconﬁrmwhatcanbetheo-0.60.650.70.750.810−210−1100Normalizedelectricresistivity1/σ2Relativeerror1Aa1Ab1Ba1Bb1C2A2B1Bb-ISA2B-ISAFigure15:Head:Relativeerrorasafunctionofthenormalizedelectricresistivity1/σ2whenthedipoleispositionedat0.83dmalongthex-axis.reticallyexpected,i.e.thatmixedandconformingdiscretizationsprovideformulationswithahigherlevelofaccuracyoftheirstan-dardcounterparts.Moreovertheadjointdoublelayeroperatorprovidesoftentheglobaloptimumacrossalloperatorsanddis-cretizations.Takingintoaccountthatthecomputationalcostsofthemixeddiscretizationislowerthanthoseofhigherorderalter-natives,thediscretizationsschemesproposedherecanbeaverycompetitivenewoptionamongallEEGforwardformulations.AcknowledgementThisworkwassupportedinpartbytheAgenceNationaledelaRechercheunderProjectFASTEEG-ANR-12-JS09-0010,inpartbytheEuropeanUnionProjectNEUROIMAGEEG,andinpartbytheHPCresourcesthroughtheGENCI-TGCCProjectunderGrant2015-gen6944.AppendixA.RelevantSobolevSpacesThisappendixcontainsthedeﬁnitionsoftheSobolevspacesusedinthispaper.Thepresentationisconciseforthesakeofbrevity;theinterestedreadercouldreferto(Tartar,2007)forfurtherdetailsonthetopic.15Table3:Memoryandtimeconsumptionforthedoublelayerandadjointdoublelayerdiscretizations.FunctionCPUMemoryTimeExpansionTestingCGTotal(#)(GB)(s)(s)AdjointDoubleLayerDiscretizationspp5464235019790p(cid:72)λ5464240825786λλ5416010337672DoubleLayerDiscretizationspp5464234018486λ(cid:72)p5416012024210λλ5416010035321TheSobolevspaceH1(Ω)isdeﬁnedasH1(Ω)=(cid:26)f:Ω→R|f∈L2(Ω)∧∇f∈(cid:16)L2(Ω)(cid:17)3(cid:27).ThespaceL2isthesetofallequivalenceclassesoffunctionsthataresquareintegrableintheLebesguesense:L2(Ω)=(cid:40)f:Ω→R|kfkL2(Ω)<∞(cid:41),(A.1)withtheL2-normdeﬁnedaskfkL2(Ω)= ZΩ|f(r)|2dr!1/2.(A.2)FromthespaceH1(Ω)wecandeﬁnethefractionalorderSobolevspaceH1/2(Γ)asH1/2(Γ)=(cid:40)f:Γ→R|∃g∈H1(Ω)sothatg|Γ=f(cid:41).ThespaceH−1/2(Γ)isthetopologicaldualspaceofH1/2(Γ),thatis,thespacethatcontainsallthelinearandcontinuousfunctionalsthatmapthefunctionsofH1/2(Γ)toR(Tartar,2007).AppendixB.TheRepresentationTheoremTherepresentationtheoremallowstorepresentthesolutionuoftheLaplace’sequationonadomainΩintermsofitsboundaryvalues(Nédélec,2001).Theorem1.LetΩ−⊂R3beanopen,connectedsetwithsmoothboundaryΓ,Ω+=R3\Ω−itscomplement.Let∆u=0inΩ=Ω+∪Ω−,andletusatisfytheconditionslimr→∞r|u(r)|<∞,(B.1)limr→∞r∂u∂r(r)=0,(B.2)wherer=krk.Wedeﬁnep=∂ˆnu.Thenitholds−p=+N[u]−D∗(cid:2)p(cid:3),forr∈Ω,(B.3)u=−D[u]+S(cid:2)p(cid:3),forr∈Ω,(B.4)−p|±Γ=+N[u]+(cid:0)±I/2−D∗(cid:1)(cid:2)p(cid:3),forr∈Γ,(B.5)u|±Γ=(∓I/2−D)[u]+S(cid:2)p(cid:3),forr∈Γ,(B.6)whereIistheidentityoperatorandtheoperatorsS,D,D∗,andNaredeﬁnedineqs.(8)to(11).Whenever[u]or[p],respectively,arezero,weobtainp|±Γ=∓(cid:2)p(cid:3)/2+D∗(cid:2)p(cid:3),forr∈Γ,(B.7)andu|±Γ=∓[u]/2−D[u],forr∈Γ.(B.8)Therepresentationtheoremholdsalsointhepresenceofmultilay-eredstructuresasdepictedinfig.1.LetξΓiandµΓibefunctionsde-ﬁnedontheithsurface.Wedeﬁnethepotentialsuh1=PNi=1SξΓianduh2=PNi=1DµΓi.Thenweobtain∂ˆnu±h1(r)=∓ξΓj/2+NXi=1D∗jiξΓiforr∈Γj,(B.9)u±h2(r)=±µΓj/2+NXi=1DjiµΓiforr∈Γj.(B.10)ReferencesAcar,Z.A.,Acar,C.E.,Makeig,S.,2016.Simultaneousheadtissueconductivityandeegsourcelocationestimation.NeuroImage124,168–180.Acar,Z.A.,Makeig,S.,2013.EﬀectsofforwardmodelerrorsonEEGsourcelocalization.Braintopography26(3),378–396.Adde,G.,Clerc,M.,Faugeras,O.,Keriven,R.,Kybic,J.,Papadopoulo,T.,2003.SymmetricBEMformulationforthem/EEGforwardproblem.In:InformationProcessinginMedicalImaging.Springer,pp.524–535.16Bénar,C.-G.,Schön,D.,Grimault,S.,Nazarian,B.,Burle,B.,Roth,M.,Badier,J.-M.,Marquis,P.,Liegeois-Chauvel,C.,Anton,J.-L.,2007.Single-trialanalysisofoddballevent-relatedpotentialsinsimultaneousEEG-fMRI.Humanbrainmapping28(7),602–613.Birot,G.,Spinelli,L.,Vulliémoz,S.,Mégevand,P.,Brunet,D.,Seeck,M.,Michel,C.M.,2014.Headmodelandelectricalsourceimaging:astudyof38epilepticpatients.NeuroImage:Clinical5,77–83.Buﬀa,A.,Christiansen,S.,2007.Adualﬁniteelementcomplexonthebarycentricreﬁnement.MathematicsofComputation76(260),1743–1769.Chan,T.F.,1984.Deﬂateddecompositionofsolutionsofnearlysingularsystems.SIAMjournalonnumericalanalysis21(4),738–754.Clerc,M.,Adde,G.,Kybic,J.,Papadopoulo,T.,Badier,J.-M.,2005.Invivocon-ductivityestimationwithsymmetricboundaryelements.InternationalJournalofBioelectromagnetism7,307–310.Cools,K.,Andriulli,F.,DeZutter,D.,Michielssen,E.,2011.Accurateandcon-formingmixeddiscretizationofthemﬁe.AntennasandWirelessPropagationLetters,IEEE10,528–531.Cools,K.,Andriulli,F.P.,Olyslager,F.,Michielssen,E.,2009.Improvingthemﬁe’saccuracybyusingamixeddiscretization.In:AntennasandPropagationSocietyInternationalSymposium,2009.APSURSI’09.IEEE.IEEE,pp.1–4.Cosandier-Rimélé,D.,Merlet,I.,Badier,J.-M.,Chauvel,P.,Wendling,F.,2008.TheneuronalsourcesofEEG:modelingofsimultaneousscalpandintracerebralrecordingsinepilepsy.NeuroImage42(1),135–146.Dabek,J.,Kalogianni,K.,Rotgans,E.,vanderHelm,F.C.,Kwakkel,G.,vanWegen,E.E.,Daﬀertshofer,A.,deMunck,J.C.,2015.Determinationofheadconductivityfrequencyresponseinvivowithoptimizedeit-eeg.NeuroImage.DeMunck,J.,1988.Thepotentialdistributioninalayeredanisotropicspheroidalvolumeconductor.JournalofappliedPhysics64(2),464–470.DeMunck,J.,1992.Alineardiscretizationofthevolumeconductorboundaryintegralequationusinganalyticallyintegratedelements.IEEEtransactionsonbio-medicalengineering39(9),986–990.DeMunck,J.,VanDijk,B.,Spekreijse,H.,1988.Mathematicaldipolesareadequatetodescriberealisticgeneratorsofhumanbrainactivity.BiomedicalEngineering,IEEETransactionson35(11),960–966.Despotovic,I.,Vansteenkiste,E.,Philips,W.,2013.Arealisticvolumeconductormodeloftheneonatalhead:Methods,challengesandapplications.In:Engineer-inginMedicineandBiologySociety(EMBC),201335thAnnualInternationalConferenceoftheIEEE.IEEE,pp.3303–3306.Dunavant,D.,1985.Highdegreeeﬃcientsymmetricalgaussianquadraturerulesforthetriangle.Internationaljournalfornumericalmethodsinengineering21(6),1129–1148.Ernst,L.M.,Ruchelli,E.D.,Huﬀ,D.S.,2011.Coloratlasoffetalandneonatalhistology.Springer.Fedorov,A.,Beichel,R.,Kalpathy-Cramer,J.,Finet,J.,Fillion-Robin,J.-C.,Pujol,S.,Bauer,C.,Jennings,D.,Fennessy,F.,Sonka,M.,etal.,2012.3dslicerasanimagecomputingplatformforthequantitativeimagingnetwork.Magneticresonanceimaging30(9),1323–1341.Fiederer,L.,Vorwerk,J.,Lucka,F.,Dannhauer,M.,Yang,S.,Dümpelmann,M.,Schulze-Bonhage,A.,Aertsen,A.,Speck,O.,Wolters,C.,etal.,2016.Theroleofbloodvesselsinhigh-resolutionvolumeconductorheadmodelingofeeg.NeuroImage128,193–208.Fischl,B.,vanderKouwe,A.,Destrieux,C.,Halgren,E.,Ségonne,F.,Salat,D.H.,Busa,E.,Seidman,L.J.,Goldstein,J.,Kennedy,D.,etal.,2004.Automaticallyparcellatingthehumancerebralcortex.Cerebralcortex14(1),11–22.Fuchs,M.,Drenckhahn,R.,Wischmann,H.,Wagner,M.,1998.Animprovedboundaryelementmethodforrealisticvolume-conductormodeling.BiomedicalEngineering,IEEETransactionson45(8),980–997.Fuchs,M.,Wagner,M.,Kastner,J.,2001.Boundaryelementmethodvolumecon-ductormodelsforEEGsourcereconstruction.Clinicalneurophysiology112(8),1400–1407.Geﬀroy,D.,Rivière,D.,Denghien,I.,Souedet,N.,Laguitton,S.,Cointepas,Y.,2011.Brainvisa:acompletesoftwareplatformforneuroimaging.In:PythoninNeuroscienceWorkshop.EuroscipyParis.Gençer,N.G.,Akalin-Acar,Z.,2005.Useoftheisolatedproblemapproachformulti-compartmentbemmodelsofelectro-magneticsourceimaging.Physicsinmedicineandbiology50(13),3007.Goebel,R.,2012.Brainvoyager—past,present,future.Neuroimage62(2),748–756.Gonçalves,S.,DeMunck,J.C.,Verbunt,J.,Bijma,F.,Heethaar,R.M.,LopesdaSilva,F.,etal.,2003.Invivomeasurementofthebrainandskullresistivitiesusinganeit-basedmethodandrealisticmodelsforthehead.BiomedicalEngineering,IEEETransactionson50(6),754–767.Graglia,R.D.,1987.Staticanddynamicpotentialintegralsforlinearlyvaryingsourcedistributionsintwo-andthree-dimensionalproblems.AntennasandProp-agation,IEEETransactionson35(6),662–669.Graglia,R.D.,1993.Onthenumericalintegrationofthelinearshapefunctionstimesthe3-dgreen’sfunctionoritsgradientonaplanetriangle.AntennasandPropagation,IEEETransactionson41(10),1448–1455.Gramfort,A.,Luessi,M.,Larson,E.,Engemann,D.A.,Strohmeier,D.,Brodbeck,C.,Parkkonen,L.,Hämäläinen,M.S.,2014.Mnesoftwareforprocessingmegandeegdata.Neuroimage86,446–460.Grech,R.,Cassar,T.,Muscat,J.,Camilleri,K.P.,Fabri,S.G.,Zervakis,M.,Xan-thopoulos,P.,Sakkalis,V.,Vanrumste,B.,2008.ReviewonsolvingtheinverseprobleminEEGsourceanalysis.Journalofneuroengineeringandrehabilitation5(1),25.Hackbusch,W.,2012.Integralequations:theoryandnumericaltreatment.Vol.120.Birkhäuser.Hallez,H.,Vanrumste,B.,Grech,R.,Muscat,J.,DeClercq,W.,Vergult,A.,D’Asseler,Y.,Camilleri,K.P.,Fabri,S.G.,VanHuﬀel,S.,etal.,2007a.ReviewonsolvingtheforwardprobleminEEGsourceanalysis.Journalofneuroengineeringandrehabilitation4(1),46.Hallez,H.,Vanrumste,B.,Grech,R.,Muscat,J.,DeClercq,W.,Vergult,A.,D’Asseler,Y.,Camilleri,K.P.,Fabri,S.G.,VanHuﬀel,S.,etal.,2007b.ReviewonsolvingtheforwardprobleminEEGsourceanalysis.Journalofneuroengineeringandrehabilitation4(1),46.Hamalainen,M.S.,Sarvas,J.,1989.Realisticconductivitygeometrymodelofthehumanheadforinterpretationofneuromagneticdata.BiomedicalEngineering,17IEEETransactionson36(2),165–171.He,B.,Musha,T.,Okamoto,Y.,Homma,S.,Nakajima,Y.,Sato,T.,1987.Electricdipoletracinginthebrainbymeansoftheboundaryelementmethodanditsaccuracy.BiomedicalEngineering,IEEETransactionson(6),406–414.He,B.,Wang,Y.,Wu,D.,1999.EstimatingcorticalpotentialsfromscalpEEGsinarealisticallyshapedinhomogeneousheadmodelbymeansoftheboundaryelementmethod.BiomedicalEngineering,IEEETransactionson46(10),1264–1268.Huang,Y.,Parra,L.C.,Haufe,S.,2015.Thenewyorkhead—aprecisestan-dardizedvolumeconductormodelforeegsourcelocalizationandtestargeting.NeuroImage.Huiskamp,G.,Vroeijenstijn,M.,vanDijk,R.,Wieneke,G.,vanHuﬀelen,A.C.,1999.TheneedforcorrectrealisticgeometryintheinverseEEGproblem.BiomedicalEngineering,IEEETransactionson46(11),1281–1287.Jorge,J.,Grouiller,F.,Gruetter,R.,VanDerZwaag,W.,Figueiredo,P.,2015.Towardshigh-qualitysimultaneouseeg-fmriat7t:Detectionandreductionofeegartifactsduetoheadmotion.NeuroImage120,143–153.Koessler,L.,Benar,C.,Maillard,L.,Badier,J.-M.,Vignal,J.P.,Bartolomei,F.,Chauvel,P.,Gavaret,M.,2010.SourcelocalizationofictalepilepticactivityinvestigatedbyhighresolutionEEGandvalidatedbysEEG.Neuroimage51(2),642–653.Kybic,J.,Clerc,M.,Abboud,T.,Faugeras,O.,Keriven,R.,Papadopoulo,T.,2005.AcommonformalismfortheintegralformulationsoftheforwardEEGproblem.MedicalImaging,IEEETransactionson24(1),12–28.Meijs,J.W.,Weier,O.W.,Peters,M.J.,vanOosterom,A.,1989.Onthenumer-icalaccuracyoftheboundaryelementmethod(EEGapplication).BiomedicalEngineering,IEEETransactionson36(10),1038–1049.Munck,d.J.,Peters,M.J.,1993.Afastmethodtocomputethepotentialinthemultispheremodel.IEEEtransactionsonbiomedicalengineering40(11),1166–1174.Nédélec,J.-C.,2001.Acousticandelectromagneticequations:Integralrepresenta-tionsforharmonicproblems.Vol.144.Springer.Odabaee,M.,Layeghy,S.,Mesbah,M.,Azemi,G.,Boashash,B.,Vanhatalo,S.,etal.,2012.EEGamplitudeandcorrelationspatialdecayanalysisforneonatalheadmodelling.In:InformationScience,SignalProcessingandtheirApplica-tions(ISSPA),201211thInternationalConferenceon.IEEE,pp.882–887.Odabaee,M.,Tokariev,A.,Layeghy,S.,Mesbah,M.,Colditz,P.B.,Ramon,C.,Vanhatalo,S.,2014.NeonatalEEGatscalpisfocalandimplieshighskullconductivityinrealisticneonatalheadmodels.NeuroImage96,73–80.Oostendorp,T.F.,Delbeke,J.,Stegeman,D.F.,2000.Theconductivityofthehumanskull:resultsofinvivoandinvitromeasurements.BiomedicalEngineering,IEEETransactionson47(11),1487–1492.Oostenveld,R.,Fries,P.,Maris,E.,Schoﬀelen,J.-M.,2010.Fieldtrip:opensourcesoftwareforadvancedanalysisofMEG,EEG,andinvasiveelectrophysiologicaldata.Computationalintelligenceandneuroscience2011.Pascual-Marqui,R.D.,1999.ReviewofmethodsforsolvingtheEEGinverseproblem.Internationaljournalofbioelectromagnetism1(1),75–86.Patrizi,S.,Holmes,G.L.,Orzalesi,M.,Allemand,F.,2003.Neonatalseizures:characteristicsofEEGictalactivityinpretermandfullterminfants.BrainandDevelopment25(6),427–437.Peng,K.,Nguyen,D.K.,Vannasing,P.,Tremblay,J.,Lesage,F.,Pouliot,P.,2016.Usingpatient-speciﬁchemodynamicresponsefunctioninepilepticspikeanalysisofhumanepilepsy:astudybasedoneeg–fnirs.NeuroImage126,239–255.Phillips,C.,Rugg,M.D.,Friston,K.J.,2002.SystematicregularizationoflinearinversesolutionsoftheEEGsourcelocalizationproblem.NeuroImage17(1),287–301.Pruis,G.,Gilding,B.H.,Peters,M.,1993.Acomparisonofdiﬀerentnumeri-calmethodsforsolvingtheforwardprobleminEEGandMEG.Physiologicalmeasurement14(4A),A1.Rahmouni,L.,Andriulli,F.,April2014.MixeddiscretizationformulationsforthedirectEEGproblem.In:AntennasandPropagation(EuCAP),20148thEuropeanConferenceon.pp.3183–3185.Rahola,J.,Tissari,S.,2002.IterativesolutionofdenselinearsystemsarisingfromtheelectrostaticintegralequationinMEG.Physicsinmedicineandbiology47(6),961.Sarvas,J.,1987.Basicmathematicalandelectromagneticconceptsofthebiomag-neticinverseproblem.Physicsinmedicineandbiology32(1),11.Sauter,S.A.,Schwab,C.,2011.Boundaryelementmethods.Springer.Scherzer,O.,2011.HandbookofMathematicalMethodsinImaging:Vol.1.SpringerScience&BusinessMedia.Schimpf,P.H.,Ramon,C.,Haueisen,J.,2002.DipolemodelsfortheEEGandMEG.BiomedicalEngineering,IEEETransactionson49(5),409–418.Shattuck,D.W.,Leahy,R.M.,2002.Brainsuite:anautomatedcorticalsurfaceidentiﬁcationtool.Medicalimageanalysis6(2),129–142.Siems,M.,Pape,A.-A.,Hipp,J.F.,Siegel,M.,2016.Measuringthecorticalcorrela-tionstructureofspontaneousoscillatoryactivitywitheegandmeg.NeuroImage.Silau,A.M.,Fischer,H.B.,Kjær,I.,1994.Normalprenataldevelopmentofthehumanparietalboneandinterparietalsuture.Journalofcraniofacialgeneticsanddevelopmentalbiology15(2),81–86.Smith,S.M.,2002.Fastrobustautomatedbrainextraction.Humanbrainmapping17(3),143–155.Steinbach,O.,2008.Numericalapproximationmethodsforellipticboundaryvalueproblems.FiniteandBoundaryElements.Steinbach,O.,Wendland,W.L.,1998.Theconstructionofsomeeﬃcientprecon-ditionersintheboundaryelementmethod.AdvancesinComputationalMathe-matics9(1-2),191–216.Stenroos,M.,Sarvas,J.,2012.Bioelectromagneticforwardproblem:isolatedsourceapproachrevis(it)ed.Physicsinmedicineandbiology57(11),3517.Tartar,L.,2007.AnIntroductiontoSobolevSpacesandInterpolation.Springer.Watanabe,K.,Hayakawa,F.,Okumura,A.,1999.NeonatalEEG:apowerfultoolintheassessmentofbraindamageinpreterminfants.BrainandDevelopment21(6),361–372.Wolters,C.H.,Köstler,H.,Möller,C.,Härdtlein,J.,Grasedyck,L.,Hackbusch,W.,2007.NumericalmathematicsofthesubtractionmethodforthemodelingofacurrentdipoleinEEGsourcereconstructionusingﬁniteelementheadmodels.SIAMJournalonScientiﬁcComputing30(1),24–45.18Yan,S.,Jin,J.-M.,Nie,Z.,2011.Improvingtheaccuracyofthesecond-kindfredholmintegralequationsbyusingthea-christiansenfunctions.AntennasandPropagation,IEEETransactionson59(4),1299–1310.Ylä-Oijala,P.,Kiminki,S.P.,Järvenpää,S.,2015.Conformingboundaryelementmethodsinacoustics.EngineeringAnalysiswithBoundaryElements50,447–458.Yvert,B.,Crouzeix-Cheylus,A.,Pernier,J.,2001.Fastrealisticmodelinginbio-electromagnetismusinglead-ﬁeldinterpolation.Humanbrainmapping14(1),48–63.Zanow,F.,Peters,M.,1995.IndividuallyshapedvolumeconductormodelsoftheheadinEEGsourcelocalisation.Medicalandbiologicalengineeringandcomputing33(4),582–588.Zhang,Y.,vanDrongelen,W.,He,B.,2006.Estimationofinvivobrain-to-skullconductivityratioinhumans.Appliedphysicsletters89(22),223903.Zhang,Z.,1995.Afastmethodtocomputesurfacepotentialsgeneratedbydipoleswithinmultilayeranisotropicspheres.Physicsinmedicineandbiology40(3),335.19