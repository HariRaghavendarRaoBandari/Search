The mathematics of non-linear metrics for nested networks

Rui-Jie Wu, Gui-Yuan Shi, Yi-Cheng Zhang & Manuel Sebastian Mariani

Department of Physics, University of Fribourg, 1700 Fribourg, Switzerland

Numerical analysis of data from international trade and ecological networks has shown that the
non-linear ﬁtness-complexity metric is the best candidate to rank nodes by importance in bipartite
networks that exhibit a nested structure. Despite its relevance for real networks, the mathematical
properties of the metric and its variants remain largely unexplored. Here, we perform an analytic and
numeric study of the ﬁtness-complexity metric and a new variant, called minimal extremal metric.
We rigorously derive exact expressions for node scores for perfectly nested networks and show
that these expressions explain the non-trivial convergence properties of the metrics. A comparison
between the ﬁtness-complexity metric and the minimal extremal metric on real data reveals that
the latter can produce improved rankings if the input data are reliable.

6
1
0
2

 
r
a

 

M
1
2

 
 
]

.

C
E
n
i
f
-
q
[
 
 

1
v
7
0
4
6
0

.

3
0
6
1
:
v
i
X
r
a

I.

INTRODUCTION

Network-based iterative algorithms are being applied to a broad range of problems, such as ranking search results in
the WWW [1], predicting the traﬃc in urban roads [2], recommending the items that an online user might appreciate
[3], measuring the competitiveness of countries in world trade [4, 5], ranking species according to their importance
in plant-pollinator mutualistic networks [6, 7], assessing scientiﬁc impact [8, 9], identifying inﬂuential spreaders [10],
and many others. While linear algorithms are applied to a broad range of real systems [11, 12], it has been recently
shown that the non-linear ﬁtness-complexity metric introduced in ref.
[5] markedly outperforms linear metrics in
ranking the nodes by their importance in bipartite networks that exhibit a nested architecture [7, 13]. The ﬁtness-
complexity metric has been originally introduced to rank countries and products in world trade according to their
level of competitiveness and quality, respectively [5]. The basic idea of the metric is that while the competitiveness of
a country is mostly determined by the diversiﬁcation of its exports, the quality of a product is mostly determined by
the score of the least competitive exporting countries. The metric has been shown to be economically well-grounded
[5, 14], to be highly eﬀective in ranking countries and products by their importance in the network [13], to be
informative about the future economic development [15] and the future exports of a country [16]. The metric has
been recently applied beyond its original scope and has been shown to be the most eﬃcient method among several
network-based methods in ranking species according to their importance in mutualistic ecological networks [7]. In
particular, the metric reveals the nested structure of the system much better than the methods used by standard
nestedness calculators. Several real systems exhibit a nested structure [5, 17–21], which suggests that the metric has
a potentially broad range of application.

Despite the relevance of the ﬁtness-complexity metric for nested networks, its mathematical properties and its
variants remain largely unexplored. In contrast with linear algorithms such as Google’s PageRank [11, 12, 22] and
the method of reﬂections [23], the convergence properties of the metric cannot be studied through linear algebra
techniques. This article provides new insights into the mathematics behind the metric. We study here both the
ﬁtness-complexity metric (FCM) and a novel variant, called minimal extremal metric (MEM), that is simpler to be
treated analytically. The only input of the metrics is the binary adjacency matrix M of the underlying bipartite
network; we perform here exact computations for perfectly nested matrices, i.e., binary matrices such that a unique
border separates all the elements equal to one from the elements equal to zero. For both the MEM and the FCM, we
ﬁnd the exact analytic formulas that relate the ratios of node scores to the shape of the underlying nested matrix.
While real nested matrices are not perfectly nested, the expressions derived here for perfectly nested matrices explain
the non-trivial convergence properties the metrics found in real matrices [24]. In particular, we analytically determine
the condition such that all node scores converge to a nonzero value, which is crucial for the discriminative power of
the metrics. This condition has been also found in ref.
[24] (the only previous work that studied the convergence
properties of the FCM); diﬀerently from the analytic study of ref. [24] where exact formulas were derived for matrices
with two values of node score, in this work we derive by mathematical induction expressions valid for any perfectly
nested matrix.

Finally, we contrast the two metrics in real data and show that the MEM can outperform the FCM in packing the
adjacency matrix, i.e., ordering its rows and columns in such a way that a sharp curve separates the occupied and
empty regions of the matrix [7]. On the other hand, the MEM is more sensitive to noisy data, and, as a consequence,
its rankings may be unreliable in the presence of a signiﬁcant amount of mistakes in the original data [25].

This article is organized as follows: In section II, we deﬁne the Fitness-Complexity metric (FCM) and the Minimal

(cid:88)
1(cid:80)
i Miα

α

˜F (n)

i =

˜Q(n)

α =

MiαQ(n−1)

α

1

F (n−1)

i

,

,

(1)

(2)

Extremal Metric (MEM); In section III, we analytically compute the ratios between MEM and FCM node scores
for perfectly nested matrices and discuss the dependence of the metrics’ convergence properties on the shape of the
nested matrix; In section IV, we compare the rankings by the FCM and the MEM in real data of world trade.

2

II. NON-LINEAR METRICS FOR BIPARTITE NETWORKS

In this section, we deﬁne the ﬁtness-complexity metric (FCM) and the minimal extremal metric (MEM) for bi-
partite networks. While the results obtained in this paper hold for any nested matrix, we use the terminology of
economic complexity: rows and columns of the N × M adjacency matrix M are referred to as countries and products,
respectively; the matrix M is consequently referred to as the country-product matrix [4]. We label countries by Latin
letters (i = 1, . . . , N ), products by Greek letters (α = 1, . . . , M ); the number of countries and products are denoted
by N and M , respectively. The number of products exported by country i and the number of countries that export
product α are referred to as the diversiﬁcation Di of country i and the ubiquity Uα of product α, respectively [4].
In the ﬁtness-complexity metric (FCM), the ﬁtness scores F = {Fi} of countries and complexity scores Q = {Qα}

of products are deﬁned as the components of the ﬁxed point of the following non-linear map [5]

where scores are normalized after each step according to

i = ˜F (n)
F (n)
α = ˜Q(n)
Q(n)

i
α / Q(n),

/ F (n),

with the initial condition F (0)

i = 1 and Q(0)

α = 1.

Eq. (1) implies that the largest contribution to the complexity Q of a product α is given by the ﬁtness of the
least-ﬁt exporter of product α. On the other hand, also the ﬁtness scores of the other exporting countries contribute
to Qα; in this sense, the FCM is a quasi-extremal metric [14]. A natural question arises: how would the rankings
change when modifying Eq. (1), without changing the main idea behind the metric? A generalized version of the
metric where the harmonic terms 1/F are replaced by 1/F γ, with γ > 0, has been introduced in ref. [24] and studied
in refs. [13, 24]. Here, we introduce a simpler variant of the algorithm, called minimal extremal metric (MEM), where
the complexity of a product is equal to the ﬁtness of the least-ﬁt country that exports product α. This metric is
extremal, which means that only mini:Miα=1 {F (n)
˜F (n)

} contributes to Qα. In formulas

(cid:88)

MiαQ(n−1)

,

i

i =

α

α

/F (n),

F (n)
i = ˜F (n)
Q(n)
α = min

i

i:Miα=1

{F (n)

i

}.

(3)

Note that the generalized FCM studied in Ref. [13] reduces to the MEM in the limit γ → ∞.

III. ANALYTIC RESULTS

A. Perfectly nested matrix

We focus here on perfectly nested matrices [26], i.e., binary matrices where each country exports all those products
that are also exported by the less diversiﬁed countries plus a set of additional products. Perfectly nested matrices are
also known as stepwise matrices [27], and networks with a perfectly nested adjacency matrix are also referred to as
threshold networks [28]. An example of perfectly nested matrix is shown in Fig. 1. In the following, we label countries
and products in order of increasing diversiﬁcation (Di+1 ≥ Di) and decreasing ubiquity, respectively (Uα+1 ≤ Uα).
We denote by ∆i := Di − Di−1 the number of additional products that are exported by country i but not by country
i − 1, with ∆1 = D1.

3

FIG. 1. Illustration of the geometrical meaning of the variables D, d, e in a 10 × 20 perfectly nested matrix. In this example,
there are m = 5 groups of countries, which correspond to the diversiﬁcation values d1, . . . , d5, and m = 5 groups of products,
which correspond to the ubiquity values N, N − e1, . . . , N − e4. Due to the perfectly nested structure of the matrix, the groups
of countries and products are in one-to-one correspondence: the countries that belong to group i are the least-ﬁt exporters of
the products belonging to group i, i.e., of the products whose ubiquity is N − ei−1.

According to Eqs. (1) and (3), countries with the same level of diversiﬁcation have the same ﬁtness score, and
it is thus convenient to group them together. By doing this, we obtain m groups of countries, with m ≤ N ; we
denote by di the diversiﬁcation of countries that belong to group i, where groups are labeled in order of increasing
diversiﬁcation and i = 1, . . . , m. In addition, we denote by ei the number of countries whose diversiﬁcation is smaller
or equal than di. This notation will turn out to be useful for the computations for the FCM. We also deﬁne the
number δi := di − di−1 of additional products that are exported by countries that belong to group i but not by those
belonging to group i − 1, and the number i := ei − ei−1 of countries that belong to group i (i = 1, . . . , m, and
e0 = d0 = 0). Also products are divided into m groups according to their level of ubiquity. Since the number of
country and product groups are the same and are equal to m, we use Latin letters (i = 1, . . . , m) to label both groups.
Product groups are labeled in order of decreasing ubiquity; we denote by ui = N − ei−1 the ubiquity of the products
that belong to group i. The geometrical interpretation of the variables d, D, e is shown in Fig. 1. Note that country
and product groups are in one-to-one correspondence: countries that belong to group i are the least-ﬁt exporters of
the products that belong to group i.

B. Results for the MEM

For a perfectly nested matrix, the ﬁtness of a country i + 1 at iteration n is given by the ﬁtness of country i at
iteration n, plus the complexity of the additional products that are exported by country i + 1 but not by country i;
for the MEM, this property reads

˜F (n+1)
i+1 = F (n+1)

i

+ F (n)

i+1 × ∆i+1,

(4)

where F (n)
i+1 is the complexity of the additional products. Our aim is to compute the ratios between the ﬁtness scores.
We start by considering the two least-ﬁt countries and compute the ratio F (n+1)
between their scores. Since we
are only interested in the ratios between the ﬁtness values, we do not normalize the variables F , Q in the computation;
we have then F (n)

1 and, starting from Eq. (4)

/F (n+1)

1 = ∆n

1

2

˜F (n+1)

2

1

1

= F (n+1)
= F (n+1)
= F (n+1)
= ∆n+1

1

2

+ ∆2 × F (n)
+ ∆2 × (F (n)
+ ∆2 × F (n)

1 + ∆2 × F (n−1)
2 × (F (n−1)
1 + ∆2
1 + ∆2

2 × ∆n−1

1

2

1 + ∆2 × ∆n

1 + ··· + ∆n

2 × ∆1,

)
+ ∆2 × F (n−2)

2

)

(5)

which can be rewritten as

If ∆1 = ∆2,

1

F (n+1)
F (n+1)

2

=

1 + ∆2
∆1

+ ( ∆2
∆1

1
)2 + ··· + ( ∆2

∆1

.

)n

1

F (n+1)
F (n+1)

2

=

1

n + 1

−→
n→∞ 0 :

the ratio converges to zero as 1/n. The ratio converges to zero also if ∆2 > ∆1, but with an exponential rate:

(cid:32)

(cid:33)n

1

F (n+1)
F (n+1)

2

(cid:39)

∆1
∆2

−→
n→∞ 0.

By contrast, using the geometric series we can show that the ratio is ﬁnite if ∆2 < ∆1:

1

F (n+1)
F (n+1)

2

−→
n→∞ 1 − ∆2

∆1

.

4

(6)

(7)

(8)

(9)

Interestingly, the three diﬀerent asymptotic behaviors (7), (8), and (9) correspond to the asymptotic behaviors found
in ref. [24] for the FCM ﬁtness scores with a model matrix where there are only two values F1 and F2 of ﬁtness score.
We will now use this result as the starting point of a rigorous derivation of the analytic expression for the ﬁtness
ratios in an arbitrary perfectly nested matrix.

First, we note that Eqs. (9) and (8) can be summarized as

lim
n→∞

1

F (n)
F (n)

2

= 1 −

∆2

max{∆1, ∆2} .

Starting from Eq. (4) and using mathematical induction, we can show that (see Appendix A)

lim
n→∞

i

F (n)
F (n)
i+1

= 1 −

∆i+1

maxj∈[1,i+1] {∆j} .

(10)

(11)

Note that Eq. (11) relates the score ratios F (n)
i+1 to the shape of the perfectly nested matrix, which is encoded
in the set of the ∆ values. Eq. (11) implies that for any perfectly nested matrix M, all MEM ﬁtness scores converge
to a nonzero value if and only if ∆i < ∆1 ∀ i > 1. If the gap ∆i+1 between the diversiﬁcations of countries i and
i + 1 is the largest gap among the gaps ∆j of the countries j ≤ i + 1, then the ratio between the score of country i
and the score of country i + 1 converges to zero. The derivation of Eq. (11) is a ﬁrst example of how the behavior of
non-linear metrics can be completely understood for perfectly nested matrices; in the next section, we will derive an
analogous expression for the FCM.

/F (n)

i

Eq. (11) suggests that for a matrix that is not too diﬀerent from a perfectly nested matrix, the score ratios could
be used to assess the convergence of the metric. In particular, one can decide to halt iterations when the following
criterion is met:

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) F (n)

F (n)
i+1

i

N(cid:88)

i=1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) < ,

i

− F (n+1)
F (n+1)

i+1

(12)

where  is a predeﬁned accuracy threshold. We refer to E for the results of the application of this criterion to real
data, and to F for a numerical study of the dependence of the convergence iteration on the size of the system. As ﬁrst
suggested by ref. [24], if some score ratios converge to zero, countries can be naturally separated in diﬀerent groups
for which all ﬁtness ratios converge to a nonzero value within a set. We refer to G for a real example from world trade
of country separation implied by the existence of zero ﬁtness ratios.

C. Results for the FCM

5

The FCM score of a certain product is determined by the scores of all the exporting countries, which makes the
analytical computations for the FCM more diﬃcult than those for the MEM. For the computations with the FCM,
it is convenient to group together countries with the same level of diversiﬁcation. In agreement with the deﬁnitions
provided in paragraph III A, we denote by fi the ﬁtness of countries that belong to group i, i.e., of those countries
whose diversiﬁcation is equal to di. Analogously, we denote by qi the complexity of the products whose least-ﬁt
exporting countries belong to group i. We have then m ﬁtness scores {f (n)
m } and m complexity scores
{q(n)

m }. With this notation, we rewrite Eq. (1) as

, . . . , f (n)

, . . . , q(n)

1

1

i(cid:88)
δj q(n−1)
1(cid:80)m

j=1

j

j=i j/f (n)

j

,

˜f (n)
i =

˜q(n)
i =

,

(13)

where in the r.h.s. of the second line we replaced 1/f (n−1)
limit n → ∞. Note that in the r.h.s. of the second line, the factor j of the terms 1/f (n)
represents the number of
countries that belong to group j. Now we transform Eqs. (13) into a set of equivalent equations for the ﬁtness ratio
x(n)
i+1. The equation that relates the scores of two consecutive
i
countries i and i + 1 is

i+1 and the complexity ratio y(n)

, which does not aﬀect the results in the

with 1/f (n)

i /q(n)

:= f (n)

i /f (n)

:= q(n)

j

j

j

i

In terms of the x variables, Eq. (14) is equivalent to

f (n+1)
i+1 = f (n+1)

i

+ q(n)

i+1 × δi+1.

which implies

1
x(n)
i

= 1 +

δi+1 q(n−1)

i+1
˜f (n)
i+1

,

1/x(n)
1/x(n)

i − 1
i−1 − 1

=

δi+1
δi

x(n)
i−1
y(n−1)

i

;

reshuﬄing the terms of this equation, we get

x(n)
i =

δi y(n−1)

i

δi y(n−1)
+ δi+1 (1 − x(n)
i−1)

i

.

For the least-ﬁt country (i = 1), from Eq. (15) we directly obtain
δ1 y(n−1)

x(n)
1 =

1

δ1 y(n−1)

1

.

+ δ2

(14)

(15)

(16)

(17)

(18)

Starting from the second line of Eq. (13) and proceeding in a similar way, we obtain the analogous equations for the
y variable:

y(n)
i =

and

i+1x(n)
i + i(1 − y(n)
i+1)

i

i+1x(n)

y(n)
m−1 =

mx(n)
m−1
m−1 + m−1

mx(n)

.

(19)

(20)

The set formed by Eqs. (17), (18), (19), (20) is exactly equivalent to the original ﬁtness-complexity equations (Eq.
(13)). The uniform initial condition f (0)

i = 1 ∀i implies the initial conditions

6

x(0)
i = 1,

y(0)
i =

em − ei
em − ei−1

(21)

(22)

for the variables x and y. Using Eqs. (17)-(20), we prove the following lemma:
Lemma 1 (Convergence). The sequences {x(n)
Proof. To prove the convergence, we ﬁrst prove that the sequences {x(n)
(18), we have

i } and {y(n)

i } are convergent in the limit n → ∞.

i } and {y(n)

i } are decreasing in n. From Eq.

x(1)
1 =

δ1 y(1)
0
δ1 y(1)
0 + δ2

< 1 = x(0)
1 ;

by combining inequality (23) with Eq. (17), we get x(1)

2 < x(0)

2 ; we can repeat the same for all i and get

x(1)
i < x(0)

i

∀i.

(23)

(24)

Analogously, by combining inequality (24) with Eq. (20) we get y(1)
that

m−1 < y(0)

m−1, from which we can iteratively show

Now, we use mathematical induction on n to prove that x(n+1)
Suppose that x(n)

and y(n)

i < x(n−1)

i < y(n−1)

i

i

i

. From Eq. (18), the former inequality directly implies

y(1)
i < y(0)

i

∀i.

< x(n)

i

and y(n+1)

i

< y(n)

i

(25)
, for all i = 1, . . . , m − 1.

x(n+1)
1

=

δ1 y(n)
1 + δ2

1
δ1 y(n)

<

δ1 y(n−1)

1

δ1 y(n−1)

1

+ δ2

= x(n)
1 .

(26)

To prove the inequality x(n+1)
x(n+1)
i−1 < x(n)

i−1 implies x(n+1)

i

i

< x(n)

i

< x(n)

i

. We obtain

for all i, we use mathematical induction on i. To do this, we show that

x(n+1)
i

=

δi y(n)

i

δi y(n)

i + δi+1 (1 − x(n+1)
i−1

<

)

δi y(n−1)

i

δi y(n−1)
+ δi+1 (1 − x(n+1)
i−1

i

)

<

δi y(n−1)

i

δi y(n−1)
+ δi+1 (1 − x(n)
i−1)

i

= xi,

(27)

where we used the induction hypothesis on n in the ﬁrst inequality, and the induction hypothesis on i in the last
inequality. A similar proof can be carried out to get y(n+1)
are decreasing sequences in n
and x(n)

converge when n → ∞.

i > 0 ∀n, then x(n)

i > 0, y(n)

. Since x(n)

and y(n)

and y(n)

< y(n)

i

i

i

i

i

i

1. Score ratios when the diagonal does not cross the empty region of M

The lemma ensures the convergence of the non-linear map deﬁned by Eq. (13). We use now the lemma to prove
the theorem that guarantees the convergence of the score ratios to a unique ﬁxed point. The theorem holds when the
diagonal of the matrix does not cross the empty region of the matrix M, i.e., the region whose elements are zero. In
formulas, this condition reads

di > ei

dm
em

∀i = 1, . . . , m − 1.

(28)

We will also discuss then the procedure to compute the ﬁtness ratios when condition (28) is false. We emphasize that
Ref. [24] found this property through an analytic computation on theoretical matrices where two values F1 and F2 of
ﬁtness score are present, conjectured its validity for any nested matrix and veriﬁed this hypothesis through numerical
simulations on several datasets. Here, we demonstrate its validity for any perfectly nested matrix.

7

FIG. 2. Illustration of the formulas (36)-(37) for computing the score ratios in a 5 × 8 matrix where the diagonal never crosses
the empty region of the matrix. We denote by δij := Dj − Pix the distance between the point Pi where the diagonal of the
matrix intersect the line y = i and the line x = Dj. We have then F3/F4 = δ33/δ43. Analogously, we denote by ij := Riy − Ej
the distance between the point Ri where the diagonal of the matrix intersect the line x = i and the line y = Ej = N − Uj We
have then Q6/Q7 = 76/66.

FIG. 3. Illustration of the procedure for computing the score ratios in a 5 × 8 matrix where the diagonal crosses the empty
region of the matrix. In this case, we have to ﬁnd the most-ﬁt country jmax such that condition (38) holds. In this example,
jmax (cid:54)= 5 and jmax (cid:54)= 4, because the diagonal from (0, 0) to (dj, j) crosses the empty region of the matrix for j = 4, 5 (left
panel). We ﬁnd jmax = 3. We can then compute the score ratios for all the countries i ≤ 3 and all the products α ≤ d3 = 6.
To do this, we use the same geometrical construction of Fig. 2, but restricted to the submatrix that contains only the three
least-ﬁt countries and the d3 most-ubiquitous products, which corresponds to the block delimited by red border in the right
panel. We can then remove from the matrix the countries i ≤ 3 and the products α < d3 = 6. and compute the score ratios
for the countries and products in the residual matrix, which corresponds to the block delimited by orange border in the right
panel.

Theorem 2. If condition (28) holds, then

lim
n→∞

f (n)
i
f (n)
i+1

= ai,

lim
n→∞

q(n)
i
q(n)
i+1

= bi,

(29)

(30)

where

ai =

bi =

di − dm
ei
di+1 − dm
ei

em

em

em
dm

di − ei
di − ei−1

em
dm

,

.

8

(31)

(32)

We refer to Appendix B for the details of the proof. The components of the limit vectors (a, b) have a simple

geometrical interpretation. To see this, we rewrite Eqs.(29)-(30) in terms of the original variables F, Q, D, U :

lim

n→+∞

i

F (n)
F (n)
i+1

=

Di − M
N i
Di+1 − M
N i

,

lim

n→+∞

i

Q(n)
Q(n)
i+1

=

N

M i − Ei+1
M i − Ei

N

,

(33)

(34)

where we deﬁned Ei = N − Ui. In term of the original variables, condition (28) reads

(35)
The solution (33)-(34) has a simple geometric interpretation when considering the representation of the matrix M in
the euclidean plane.

Di >

i

M
N

If we denote by Pix the x-coordinate of the point Pi where the diagonal of the matrix – i.e., the diagonal from
(0, 0) to (M, N ) – intersects the horizontal line y = i, we have exactly Pix = i M/N (see Fig. 2). As a consequence,
assuming Di > i M/N is equivalent to assuming that the diagonal of the matrix never crosses the empty region of
the matrix. Eq. (36) can thus be rewritten as

Fi
Fi+1

=

Di − Pix
Di+1 − Pix

.

(36)

As shown in Fig. 2, the numerator and the denominator can be interpreted as the distances of the point Pi from
the vertical lines x = Di and x = Di+1, respectively. One can also show that condition (35) implies M Ei+1 < i N
(i = 1, . . . , M − 1), If we denote by Riy the y-coordinate of the point Ri where the diagonal from (0, 0) to (M, N )
intersects the line x = i, we have Riy = i N/M . Eq. (37) can be rewritten as:

Qi
Qi+1

=

Riy − Ei+1
Riy − Ei

,

(37)

which has a simple geometrical interpretation as well (see Fig. 2).

2. Score ratios when the diagonal does cross the empty region of M

If the diagonal of the matrix crosses the empty region of the matrix – i.e., if there exists some i such that di ≤
ei dm/em – we cannot directly use Eqs. (29), (30). In this case, the procedure to compute the ﬁtness and complexity
ratios is the following:

1. We ﬁnd the most-ﬁt country jmax such that
Di − i
jmax

Djmax > 0∀ i ≤ jmax.

(38)

When considering the matrix M in the euclidean plane, the country jmax corresponds to the most-ﬁt country
such that the diagonal from (0, 0) to (djmax , jmax) never crosses the empty region of the reduced matrix that
contains only the countries j < jmax, as shown in Fig. 3.

9

FIG. 4. Country-product matrices resulting from the FCM and the MEM (1996). Both matrices are nested, but the border
between the ﬁlled and the empty region of the matrix is sharper for the MEM than for the FCM.

2. Once the value of jmax has been determined, we can compute all the ﬁtness ratios for the countries i < jmax as

Fi
Fi+1

=

Qi
Qi+1

=

Di − iDjmax/jmax
Di+1 − iDjmax /jmax
ijmax/Djmax − Ei+1
ijmax/Djmax − Ei

,

.

(39)

(40)

for all i < jmax, and Fjmax /Fjmax+1 = 0, Qjmax/Qjmax+1 = 0. Note that this formula has the same geometrical
interpretation of Eqs. (29)-(30), but the geometrical construction is carried out in a submatrix of the matrix
M (see Fig. 3).

3. We remove from the matrix all the countries i ≤ jmax and all the products α ≤ djmax, and restart from point

1, until all the ratios are computed.

The interpretation of this procedure is simple: if the diagonal line crosses the empty region of the matrix, there is
at least one pair of countries for which the score ratio converges to zero. In this case, the matrix should be split in
blocks such that the score ratios are all nonzero within each block; the score ratios can then be computed inside each
block according to Eqs. (39)-(40). A graphical illustration of this procedure is shown in Fig. 3.

IV. RESULTS IN REAL NETWORKS

A. Revealing the nested structure of country-product matrices

The MEM has been introduced in section II as a minimal metric based on the same assumptions of the ﬁtness-
complexity metric. In this section, we explore its behavior on real data and compare its rankings with those produced
by the FCM. In real data, the ﬁtness-complexity metric has been used to reveal the nested structure of a given network.
This is achieved by ordering the rows and the columns of the matrix M according to their ranking by the metric
[5, 7]. In particular, the ﬁtness-complexity metric outperforms other existing network centrality metrics and standard
nestedness calculators in packing nested matrices [7]. Here, we use the NBER-UN international trade data to compare
the matrices produced by the FCM and the MEM; we refer to Appendix C for a detailed description of the dataset.
We show here results for the year 1996; results for the diﬀerent years are in qualitative agreement. We ﬁrst observe
that the rankings of countries by the two metrics are highly correlated (ρ = 0.994), and both country scores are highly
correlated with country diversiﬁcation [ρ = 0.963 for the FCM, ρ = 0.955 for the MEM]. With respect to the matrix
produced by the FCM, the matrix produced by the MEM exhibits a sharper border between the empty and the ﬁlled
parts of the matrix (see Fig. 4). This result suggests that the MEM could be used to produce optimally packed
matrices for networks that exhibit a nested structure [7]. In agreement with the convergence criterion introduced in
Section III B, to obtain the results shown in the Fig. 4, we performed 107 and 6700 iterations for the FCM and the
MEM, respectively. We refer to E and F for more details on the convergence properties of the two metrics in real and
artiﬁcial data.

 20 40 60 80 100 120 0 100 200 300 400 500 600 700ranked countriesranked productsFCM 20 40 60 80 100 120 0 100 200 300 400 500 600 700ranked countriesranked productsMEM10

FIG. 5. Robustness against noise of the rankings as a function of the fraction η of reverted bits in the matrix M (year 1996).
Robustness is measured by the Spearman’s correlation between the rankings before and after the inversion.

B. Sensitivity with respect to noisy input data

An important issue for any data-driven variable is its stability with respect to perturbations in the system [25, 29, 30].
Following Refs. [13, 25], in order to study the robustness of the rankings with respect to noise, we randomly revert
a fraction η of bits in the binary matrix M and compute the Spearman’s correlations of the scores computed before
and after the reversal. Fig. 5 shows that the rankings by the FCM are more stable than the rankings by the MEM;
the gap between the two methods is particularly large for the ranking of products. On the other hand, the diﬀerent
robustness of the two methods is mostly due to the region of the matrix M whose elements correspond to the most
complex products and the least-ﬁt countries. This can be proved by perturbing only the submatrix M(bottom−right)
of M that contains the M/2 most complex products and the N/2 least-ﬁt countries according to the ranking by the
MEM, and compare the outcome with that obtained when perturbing only the submatrix M(top−lef t) that contains
the M/2 least-complex products and the N/2 most ﬁt countries. The diﬀerence is striking: for M(bottom−right), we
ﬁnd ρ(Q, Q(0.1)) = 0.420 and ρ(Q, Q(0.1)) = −0.142 for the FCM and the MEM, respectively; for M(top−lef t), we
ﬁnd ρ(Q, Q(0.1)) = 0.994 and ρ(Q, Q(0.1)) = 0.999 for the FCM and the MEM, respectively. These ﬁndings indicate
that the ranking of products by the MEM is not reliable when the data are subject to mistakes and noise, as is the
case for world trade data [25], and that the major contribution to the ranking instability comes from the exports of
the least-ﬁt countries.

V. CONCLUSIONS

Understanding the mathematics behind a network-based ranking algorithm is crucial for its real-world applications.
This article moves the ﬁrst step toward a rigorous understanding of the mathematical properties of the ﬁtness-
complexity metric for nested networks. We exactly computed country and product scores for perfectly nested matrices.
Our analytic ﬁndings are in agreement with the analytic and numeric ﬁndings of Ref.
[24] on the relation between
the convergence properties of the metric and the shape of the underlying nested matrix. We stress again that while
we have used the terminology of economic complexity throughout this work, our ﬁndings hold for any network that
exhibit a nested architecture. For the application of the metric to mutualistic networks, only the meaning of the
variables change: F and Q represent active species importance and passive species vulnerability, respectively [7].

In this work, we have also introduced and studied the MEM, a novel variant of the FCM that is simpler to be
analytically treated. Our ﬁndings on real data indicate that the MEM can order rows and columns of nested matrices
even better than the FCM. The high correlation between the country scores obtained with the FCM and the MEM
suggests that the MEM and the FCM are similarly informative about the competitiveness of a country in international
trade and its future growth potential [15]. On the other hand, the rankings of products by the MEM turn out to be
much less stable under a random perturbation in the country-product binary matrix. To conclude, while the MEM
can produce more packed nested matrices with respect to those produced by the FCM, its ranking of products is
reliable only for high-quality data.

 0.94 0.96 0.98 1 0.005 0.02 0.04 0.06 0.08 0.1ρ(F, F(η))ηFCMMEM 0 0.2 0.4 0.6 0.8 1 0.005 0.02 0.04 0.06 0.08 0.1ρ(Q, Q(η))ηFCMMEMAppendix A: Proof of Eq. (11)

11

We assume that Eq. (11) holds for i = k, and show that this assumption implies that it holds also for i = k + 1. In

formulas, we assume that in the limit n → ∞

where Hk+1 = maxj∈[1,k+1] {∆j}, and we want to prove that Eq. (A1) implies

k

F (n)
F (n)
k+1

= 1 − ∆k+1
Hk+1

,

Using Eq. (4), we obtain

F (n)
k+1
F (n)
k+2

= 1 − ∆k+2
Hk+2

.

k+2

F (n+1)
F (n+1)

k+1

=

k+1 + F (n)
F (n+1)
F (n+1)

k+1

k+2 ∆k+2

= 1 +

F (n)

k+2 ∆k+2
F (n+1)

k+1

(A1)

(A2)

(A3)

.

We want to express the denominator F (n+1)

k+1

in terms of F (n)

k+1 in order to transform this equation into a recurrence

relation for

F (n)
k+2
F (n)
k+1

. To do this, we use Eq. (4) and obtain

k+1 = F (n+1)
F (n+1)

k

+ F (n)

k+1 ∆k+1 = F (n)

k+1 ∆k+1

1 +

We now use the hypothesis (A1):

F (n+1)
k+1 = F (n)

k+1 ∆k+1

(cid:32)
(cid:32)

1 +

= F (n)

k+1 ∆k+1

1 +

Plugging Eq. (A5) into Eq. (A3) we get

= F (n)

k+1 ∆k+1

1 +

/F (n+1)

k+1
/F (n+1)

k+1

k

F (n+1)
1 − F (n+1)
Hk+1 − ∆k+1

k

(cid:33)

∆k+1

= F (n)

k+1 Hk+1.

(cid:32)

(cid:33)

(cid:32)

= F (n)

k+1 ∆k+1

1 +

k

F (n+1)
∆k+1 F (n)
k+1

(cid:33)

F (n+1)

k

k
k+1 − F (n+1)
F (n+1)
(cid:33)

1 − ∆k+1/Hk+1
∆k+1/Hk+1

(cid:32)

Eq. (A6) is a recurrence equation for

k+2

F (n+1)
F (n+1)

k+1

= 1 +

∆k+2
Hk+1

F (n)
k+2
F (n)
k+1

,

. We distinguish two cases:

k+2

F (n+1)
F (n+1)

k+1

(cid:33)

.

(A4)

(A5)

(A6)

• If ∆k+2

Hk+1

≥ 1, then limn→∞ F (n)

k+2/F (n)

k+1 = ∞ and limn→∞ F (n)

k+1/F (n)

k+2 = 0. In this case Hk+2 = ∆k+2 by deﬁnition

and Eq. (A2) (i.e., the thesis) is satisﬁed.

• If ∆k+2

Hk+1

< 1, then we can ﬁnd the stationary point x of equation (A6) by posing x =

that in this case Hk+2 = Hk+1 and, as a result, we obtain Eq. (A2).

This proves the thesis.

k+2

F (n+1)
F (n+1)

k+1

=

F (n)
k+2
F (n)
k+1

. We notice

We denote by (x, y) the pair of vectors that solve the Eqs. (17)-(20) in the limit n → ∞, which read

Appendix B: Proof of Theorem 2

xi =

δi yi

δi yi + δi+1 (1 − xi−1)

, (i = 2, . . . , m − 1)

(B1)

x1 =

δ1 y1

δ1 y1 + δ2

,

yi =

i+1xi

i+1xi + i(1 − yi+1)

, (i = 1, . . . , m − 2)

ym−1 =

mxm−1

mxm−1 + m−1

.

12

(B2)

(B3)

(B4)

To prove that (x, y) = (a, b) is a solution of the Eqs. (B1)-(B4), it is suﬃcient to check that an identity is obtained
when replacing xi and yi with ai and bi in the Eqs. (B1)-(B4). If em di > ei dm, we can easily use mathematical
i > bi for all i = 1, . . . , m − 1 and for all n ≥ 0. The proof is similar to the
induction to prove that x(n)
proof of Lemma 1. We are then interested only in solutions of the Eqs. (B1)-(B4) that satisﬁes

i > ai and y(n)

and

ai ≤ xi < 1

bi ≤ yi <

em − ei
em − ei−1

;

(B5)

(B6)

solutions that do not satisfy conditions (B5) and (B6) cannot be reached through the iterative process deﬁned by
Eqs. (17)-(20), and will not be considered in the following. In the following, always imply conditions (B5) and (B6)
for the studied solutions. To show that the solution of Eqs. (B1)-(B4) is unique, we use a reductio ad absurdum: we
assume that a diﬀerent solution x = ˜a and y = ˜b exists, and show that this assumption leads to an absurd result.
Before doing this, we state two useful properties of the solutions of Eqs. (B1)-(B4).

Property 3. For a solution (x, y) of Eqs. (B1)-(B4), if there exist an integer j such that xj > aj or yj > bj, then
xi > ai and yi > bi for all i = 1, . . . , m.

Proof. Suppose that xj > aj for a certain component j. Then

yj =

j+1 xj

j+1 xj + j (1 − yj+1)

>

j+1 aj

j+1 aj + j (1 − yj+1)

≥

j+1 aj

j+1 aj + j (1 − bj+1)

= bj.

(B7)

In a similar way, one can use Eq. (B1) to prove the thesis for all i > j, and Eq. (B3) to prove the thesis for all
i < j.

In order to have a solution (˜a, ˜b) such that ˜a (cid:54)= a and ˜b (cid:54)= b, there must exist at least one component j such
that ˜aj (cid:54)= aj or ˜bj (cid:54)= bj; from the inequalities (B5)-(B6) and Property 3, we also have ai < ˜ai < 1 or bi < ˜bi <
(em − ei)/(em − ei−1) for i = 1, . . . , m.
Property 4. If yi > 0∀i = 2, 3, ..., m − 1, for each solution (x, y) of the Eqs. (B1)-(B4), the value of ym−1 uniquely
determines the values of all the other components {xi}m−1
i=1 of the solution. On the other hand, ym−1 is
uniquely determined by the other components {xi}m−1
Proof. The former statement of the Property follows from the fact that if yi (cid:54)= 0∀i = 2, ..., m− 1 and we know the last
component ym−1 of the solution, we can then compute all the other components of the solution and they uniquely
depend on ym−1. Suppose indeed that we know the value of ym−1. We can then invert Eq. (B4) and compute
xm−1 = m−1ym−1/m(1 − ym−1), and then plug the obtained xm−1 value into Eq. (B1) to compute xm−2, and then
plug the obtained xm−2 into Eq. (B3) to compute ym−2, and so on. The latter statement follows from Property 3 (or
equivalently, from the invertibility of all the relations involved in Eqs. (B1)-(B4)).

i=1 and {yi}m−2

i=1 and {yi}m−2

i=1 of the solution.

As a consequence of this property, proving that the solution (x, y) = (a, b) is unique is equivalent to proving that

for a solution, the only acceptable value of ym−1 is ym−1 = bm−1.

We will now prove the theorem in two steps:

1. We transform Eqs. (B1)-(B4) into a set of equations, hereafter referred to as the transformed equations.

2. We use a reductio ad absurdum and assume that there exists a solution y = ˜b of the original equations such
that ˜bN−1 > bN−1. We use then the transformed equations to show that the solution y = ˜b cannot be a solution
of the original equations, which proves the thesis.

1. Step 1: Deriving a set of transformed equations

First, we merge the equations (B1)-(B4) into two equations

xi =

yi + δi+1
δi

yi
(1 − xi−1)

, (i = 1, . . . m − 1)

yi =

xi
(1 − yi+1)

xi + i
i+1

, (i = 1, . . . m − 1)

13

(B8)

(B9)

with x0 = 0 and ym = 0. Consider a generic solution (¯x, ¯y) of Eqs. (B8)-(B9). Instead of the variables {x1, . . . , xm−1}
and {y1, . . . , ym−1}, we consider the transformed variables {x(cid:48)
m} deﬁned by the transforma-
tion

m} and {y(cid:48)

1, . . . , x(cid:48)

1, . . . , y(cid:48)

x(cid:48)
i = xi−1
y(cid:48)
i = yi−1

for i = 2, . . . , m;
for i = 2, . . . , m.

We consider the transformed equations
x(cid:48)
i =

y(cid:48)
i +

i

y(cid:48)
(1 − x(cid:48)

i−1)

, (i = 1, . . . m),

i+1

δ(cid:48)
δ(cid:48)

i

y(cid:48)
i =

i

x(cid:48)
(1 − y(cid:48)

i+1)

i + (cid:48)
x(cid:48)
(cid:48)

i

i+1

, (i = 1, . . . m),

0 = 0 = y(cid:48)

m+1 = 0, δ(cid:48)

i = δi−1 and (cid:48)

with x(cid:48)
1 are new
variables; for a solution (¯x, ¯y) of Eqs, (B8)-(B9), the pair of transformed vectors (¯x(cid:48), ¯y(cid:48)) satisﬁes the following set of
transformed equations only if ¯x(cid:48)
1 only aﬀect the values of x(cid:48)
1, which must be equal to zero for the transformed (¯x(cid:48), ¯y(cid:48)) of a solution (¯x, ¯y) of the original equations. This
and y(cid:48)
allows us to let δ(cid:48)
1 be arbitrary parameters in the Eqs. (B11)-(B12). Eqs. (B11)-(B12) have the same form of
Eqs. (B8)-(B9). It is possible to show by substitution that a possible solution of Eqs. (B11)-(B12) is

i = i−1 for i = 2, . . . , m + 1. In the tranformed equations, x(cid:48)

1 = 0 for a solution (¯x, ¯y). The values of δ(cid:48)

1 and (cid:48)

1 and y(cid:48)

1 and (cid:48)

1 = ¯y(cid:48)

1

¯x(cid:48)
i =

¯y(cid:48)
i =

e(cid:48)
m+1 d(cid:48)
m+1 d(cid:48)
e(cid:48)
e(cid:48)
m+1 d(cid:48)
e(cid:48)
m+1 d(cid:48)

i − e(cid:48)
i d(cid:48)
i+1 − e(cid:48)
i d(cid:48)
i − e(cid:48)
i d(cid:48)
i − e(cid:48)
i−1 d(cid:48)

m+1

m+1

m+1

m+1

,

,

where d(cid:48)

i = δ(cid:48)

j and e(cid:48)

i = (cid:48)

1 +(cid:80)i

j=2 (cid:48)

1 +(cid:80)i

j=2 δ(cid:48)
¯y(cid:48)
m =

e(cid:48)
m+1d(cid:48)
e(cid:48)
m+1d(cid:48)

m − e(cid:48)
m − e(cid:48)

md(cid:48)
m−1d(cid:48)

m+1

m+1

j. The m-th component of this solution is
1 + em−1)(δ(cid:48)
1 + em−2)(δ(cid:48)

1 + dm−1) − ((cid:48)
1 + dm−1) − ((cid:48)

((cid:48)
1 + em)(δ(cid:48)
((cid:48)
1 + em)(δ(cid:48)

=

1 + dm)
1 + dm)

We are interested in the solutions (¯x(cid:48), ¯y(cid:48)) of Eqs. (B11)-(B12) such that (¯x, ¯y) is solution of Eqs. (B8)-(B9), where
the transformation (¯x(cid:48), ¯y(cid:48)) → (¯x, ¯y) is given by Eq. (B10). We can then pose ¯y(cid:48)

m = ¯ym−1 and (cid:48)

1 = 1, and obtain

(B10)

(B11)

(B12)

(B13)

(B14)

.

(B15)

(B16)

δ(cid:48)
1 =

(1 + em) δm (1 − ¯ym−1)
m − (m + m−1) ¯ym−1

− dm.

2. Step 2: Reductio ad absurdum

Up to now, we have proven for a solution (¯x(cid:48), ¯y(cid:48)) of the Eqs. (B11)-(B12) in the form given by Eqs. (B13)-(B14), the
pair of vectors (¯x, ¯y) obtained by the transformation (B10) is a solution of Eqs. (B8)-(B9) if and only if ¯x(cid:48)
1 = 0,
δ(cid:48)
1 satisﬁes Eq. (B16) and (cid:48)
1 = 1. We will now show that if we consider a solution of the transformed equations such
that ¯y(cid:48)
m = ˜bm−1 > bm−1 and assume that (˜a, ˜b) is a solution of the original equations, then the ﬁrst component
˜a(cid:48)
1 of the solution is diﬀerent from zero, which is absurd. As a consequence, (¯x, ¯y) = (a, b) is the only solution of Eqs.
(B8)-(B9).

m = ˜b(cid:48)

1 = ¯y(cid:48)

Proof. We assume that there exists a solution ¯ym−1 = ˜bm−1 > bm−1; from Property 4, all its components (˜a, ˜b)
are uniquely determined by ˜bm−1. Using the solution (B13)-(B14) of the transformed equations, from ˜bm−1 > bm−1
and Eq. (B16) it follows that δ(cid:48)
m+1. For
i = 2, 3, ...m, we have

1 > dm/em. To prove the thesis, we start by showing that e(cid:48)

m+1 d(cid:48)

i > e(cid:48)

i d(cid:48)

14

e(cid:48)
m+1d(cid:48)

i − e(cid:48)
id(cid:48)
m+1 = (1 + em)(di−1 + δ(cid:48)
= (1 + em)di−1 + (em − ei−1)δ(cid:48)

1) − (1 + ei−1)(δ(cid:48)
1 − (1 + ei−1)dm

1 + dm)

For i = 1, e(cid:48)
m+1d(cid:48)
a consequence, a(cid:48)

1 + emδ(cid:48)

1 = δ(cid:48)
1 > 0, which is absurd.

ei−1
em
1 + dm = d(cid:48)

> (1 + em)
1 > δ(cid:48)

dm + (em − ei−1)
m+1 = e(cid:48)

1d(cid:48)

dm
em

− (1 + ei−1)dm = 0.
id(cid:48)
i > e(cid:48)
m+1 for all i = 1, 2, ..., m; as

m+1d(cid:48)

m+1, which implies e(cid:48)

Appendix C: The dataset

We use the NBER-UN dataset which has been cleaned and further described in [31]. We take into account the
same list of N = 132 countries described in [32]. For products, we used the same cleaning procedure of ref.
[16]:
we removed aggregate product categories and products with zero total export volume for a given year and nonzero
total export volume for the previous and the following years. Products and countries with no entries after year 1993
have been removed as well. After the cleaning procedure, the dataset consists of M = 723 products. To decide if we
consider country i to be an exporter of product α or not, we use the Revealed Comparative Advantage (RCA) [33]
which is deﬁned as

RCAiα =

,

(C1)

(cid:44)(cid:80)
j ejα(cid:80)

jβ ejβ

eiα(cid:80)

β ejβ

where eiα is the volume of product α that country i exports measured in thousands of US dollars. RCA characterizes
the relative importance of a given export volume of a product by a country in comparison with this product’s exports by
all other countries. We use the bipartite network representation introduced in [4], where two kinds of nodes represent
countries and products, respectively. All country-product pairs with RCA values above a threshold value–set to 1
here–are consequently joined by links between the corresponding nodes in the bipartite network.

Appendix D: Spearman’s correlation coeﬃcient ρ

Given two variables X = {X1, . . . , Xn} and Y = {Y1, . . . , Yn}, we rank them in decreasing order and denote by
x = {x1, . . . , xn} and y = {y1, . . . , yn} their corresponding ranking scores. Equal scores are assigned equal ranking
positions given by their average ranking position: for instance, if the fourth and the ﬁfth scores in the ranking are
equal to each other, then they are both assigned ranking score equal to (4 + 5)/2 = 4.5. The Spearman’s correlation
coeﬃcient ρ(X, Y) is then deﬁned as the linear correlation coeﬃcient between the ranking scores, which reads [34]

(cid:80)n
(cid:112)(cid:80)n
i=1(xi − x)2 (cid:80)n
i=1(xi − x)(yi − y))

i=1(yi − y)2

ρ(X, Y) =

,

(D1)

where x = n−1(cid:80)n

i=1 xi denotes the mean of x.

Appendix E: Convergence of the metrics in real data

In a perfectly nested matrix, the score ratios converge to a ﬁnite value both for the MEM (Eq. (11)) and for the
FCM (Eq. (39)). While real matrices are not perfectly nested, one can conjecture that if the matrix is not too sparse,
the convergence behavior of a real matrix will be similar. Motivated by this assumption, we deﬁne a convergence
criterion based on the score ratio, and decide to halt iterations when the following criterion is satisﬁed

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) F (n)

F (n)
i+1

i

N(cid:88)

i=1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) <  = 10−5.

i

− F (n+1)
F (n+1)

i+1

d(n) =

(E1)

15

FIG. 6. d(n) as a function of the iteration number for the country-product matrix represented in Fig. 4.

For the country-product matrix shown in Fig. 4, condition (E1) is satisﬁed after 107 and 6700 iterations for the FCM
and the MEM, respectively (see Fig. 6). For the FCM, we ﬁnd that no ﬁtness ratios converge to zero. This is in
agreement with our analytic results (see condition (28)) and with the results of ref.
[24], since the diagonal of the
matrix never crosses the empty region of the matrix, as shown in the left panel of Fig. 4. For the MEM, we ﬁnd that
three ﬁtness ratios converge to zero[? ], which slows down the convergence of the metric.

Appendix F: Dependence of the convergence iteration of the metrics on network size

FIG. 7. Convergence iteration n∗ as a function of size N for artiﬁcial matrices generated according to Model A described in F.

FIG. 8. An illustration of model B described in F.

In this section, we build artiﬁcial nested matrices to study the dependence of the convergence iteration of the
metrics on network size. The convergence iteration n∗ is deﬁned as the smallest iteration such that condition (E1)
holds. We focus on perfectly nested matrices where the diagonal never crosses the empty region of the matrix, as is

 1e-07 1e-06 1e-05 0.0001 0.001 0.01 0.1 1 10 10 100 1000 10000distanceiteration numberFCMMEM 10 20 30 40 50 60 70 80 90 100 10 100 1000n*Nα=0.4FCMMEM 20 40 60 80 100 120 140 160 180 200 10 100 1000n*Nα=0.6FCMMEM 0 100 200 300 400 500 600 700 800 900 1000 10 100 1000n*Nα=0.8FCMMEM16

FIG. 9. Convergence iteration n∗ as a function of size N for artiﬁcial matrices generated according to Model B described in
F and illustrated in Fig. 7. The panels show that for the MEM, the dependence of convergence speed on system size strongly
depends on the parameters chosen to construct the matrix.

the case for the real matrix showed in Fig. 4. We label the countries in order of increasing diversiﬁcation and the
products in order of decreasing ubiquity. To generate the matrices, we use two models:

• Model A: This model has a single parameter α which determines the shape of the matrix. In order to have
the same ratio M/N as in the real data from world trade analyzed in the main text, we set M = 5.48 N . For
country i, we ﬁll the elements corresponding to products α ∈ [1, 1 + (cid:98)M iα/N α(cid:99)], where α is a parameter of the
matrix that determines the shape of the border which separates the empty and the ﬁlled regions of the matrix,
and (cid:98)x(cid:99) denotes the largest integer smaller or equal than x. We restrict our analysis to α < 1 which corresponds
to matrices for which the diagonal does not cross the empty region.
• Model B: This model has four parameters x, α, k1, k2 which determine the shape of the matrix. Fig. 8 shows an
illustration of a matrix produced with model B. Country 1 has diversiﬁcation equal to x + k1. For the countries
i ∈ [2,(cid:98)α (N − 1)(cid:99)], di+1 = di + k1 holds; for the remaining countries, di+1 = di + k2 holds. For each value of
N , the number of products M is determined by the parameters of the model.

Within this framework, we can study the dependence of the convergence speed of the metrics on network size for a
given shape of the matrix’s border. For Model A, we ﬁnd that the convergence speed of the MEM does not strongly
depend on system size, as opposed to the convergence speed of the FCM which grows approximately as log (N ) for
suﬃciently large N (see Fig. 7). For Model B, we ﬁnd again a logarithmic growth of the convergence iteration for
the FCM for suﬃciently large N , whereas the behavior of the MEM can be very diﬀerent with respect to that found
for Model A (see Fig. 9). In particular, for some parameter settings the convergence of the MEM is slower than
that of the FCM, as found in the real data. Figs. 7 and 9 indicate that the convergence behavior of the MEM
is strongly dependent on the details of the border of the matrix M, as opposed to the FCM which always exhibit
asymptotic logarithmic dependence of n∗ on N . We did not attempt to investigate the convergence behavior of the
metric on alternative matrix models. We envision that suitable modiﬁcations of the equations that deﬁne the two
metrics would mitigate the dependence of convergence speed on system size; however, designing new metrics with
improved convergence properties goes beyond the scope of this article.

Appendix G: Dividing the matrix M into submatrices based on ﬁtness ratio

When some ﬁtness score ratios converge to zero, the matrix M can be separated into diﬀerent groups of countries
such that the score ratios between countries within the same group are always larger than zero. For the FCM, one

 0 100 200 300 400 500 600 10 100 1000n*Nx=3, k1=2, k2=1, α=0.2FCMMEM 0 100 200 300 400 500 600 10 100 1000n*Nx=3, k1=2, k2=1, α=0.5FCMMEM 0 100 200 300 400 500 600 700 800 900 1000 10 100 1000n*Nx=3, k1=2, k2=1, α=0.8FCMMEM 20 40 60 80 100 120 140 10 100 1000n*Nx=0.1 N, k1=2, k2=1, α=0.5FCMMEM17

FIG. 10. Left: Country-product matrices resulting from the MEM (1996); horizontal and vertical blue lines separate groups of
countries and products, respectively. Right: Country ﬁtness score F vs. diversiﬁcation D for the FCM and the MEM.

or more ﬁtness ratios converge to zero when the diagonal of the matrix crosses the empty region of the matrix M
[24]). For the MEM and for a perfectly nested matrix M, one or more ﬁtness ratios
(see section III C 2 and ref.
converge to zero when the diversiﬁcation gap between two countries i + 1 and i is equal or larger than the maximum
diversiﬁcation gap of the lower ranked countries, as directly results from Eq. (11). While the criterion for the MEM
is not directly applicable to real matrices that are not perfectly nested, we empirically observe in the dataset used for
Fig. 4 that the ﬁtness ratios of two pairs of countries converge to zero. As suggested in ref. [24], we can then separate
the countries into three groups such that the ﬁtness ratios are nonzero between any two countries that belong to the
same group. The three resulting groups are composed of 103, 2 and 27 countries, respectively (see Fig. 10, left panel).
The right panel of Fig. 10 shows that the separation of countries into diﬀerent groups is signaled by discontinuous
jumps in the relation between country MEM ﬁtness and country diversiﬁcation D, which happens for D < 100. We
emphasize that while the deviation between the trends observed for the FCM and the MEM is relatively small for
highly diversiﬁed countries, it becomes wide for little diversiﬁed countries, which might be relevant for the study of
the economic complexity dynamics of developing countries [15].

ACKNOWLEDGEMENTS

This work was supported by the EU FET-Open Grant No. 611272 (project Growthcom), by the Swiss National
Science Foundation (Grant No. 200020-143272), by the China Scholarship Council (CSC) scholarship and by the
National Natural Science Fundation of China (Grant No. 61503140). We wish to thank Alexandre Vidmer for his
careful proofreading of the manuscript and his useful suggestions. We acknowledge useful discussions with Mat´uˇs
Medo, Emanuele Pugliese, Andrea Zaccaria.

[1] S. Brin, L. Page, The anatomy of a large-scale hypertextual web search engine, Computer Networks and ISDN Systems

30 (1) (1998) 107–117.

[2] B. Jiang, S. Zhao, J. Yin, Self-organized natural roads for predicting traﬃc ﬂow: a sensitivity study, Journal of statistical

mechanics: Theory and experiment 2008 (07) (2008) P07008.

[3] L. L¨u, M. Medo, C. H. Yeung, Y.-C. Zhang, Z.-K. Zhang, T. Zhou, Recommender systems, Physics Reports 519 (1) (2012)

1–49.

[4] C. A. Hidalgo, R. Hausmann, The building blocks of economic complexity, Proceedings of the National Academy of Sciences

106 (26) (2009) 10570–10575.

[5] A. Tacchella, M. Cristelli, G. Caldarelli, A. Gabrielli, L. Pietronero, A new metrics for countries’ ﬁtness and products’

complexity, Scientiﬁc Reports 2.

[6] S. Allesina, M. Pascual, Googling food webs: can an eigenvector measure species’ importance for coextinctions?, PLoS

Computational Biology 5 (9) (2009) e1000494.

[7] V. Dom´ınguez-Garc´ıa, M. A. Mu˜noz, Ranking species in mutualistic networks, Scientiﬁc Reports 5.
[8] D. Walker, H. Xie, K.-K. Yan, S. Maslov, Ranking scientiﬁc publications using a model of network traﬃc, Journal of

Statistical Mechanics: Theory and Experiment 2007 (06) (2007) P06010.

 20 40 60 80 100 120 0 100 200 300 400 500 600 700ranked countriesranked productsMEM 1e-16 1e-14 1e-12 1e-10 1e-08 1e-06 0.0001 0.01 1 100 10 100FDFCMMEM18

[9] F. Radicchi, S. Fortunato, B. Markines, A. Vespignani, Diﬀusion of scientiﬁc credits and the ranking of scientists, Physical

Review E 80 (5) (2009) 056103.

[10] Z.-M. Ren, A. Zeng, D.-B. Chen, H. Liao, J.-G. Liu, Iterative resource allocation for ranking spreaders in complex networks,

EPL (Europhysics Letters) 106 (4) (2014) 48005.

[11] D. F. Gleich, Pagerank beyond the web, SIAM Rev. 57 (3) (2015) 321–363.
[12] L. Ermann, K. M. Frahm, D. L. Shepelyansky, Google matrix analysis of directed networks, Reviews of Modern Physics

87 (4) (2015) 1261.

[13] M. S. Mariani, A. Vidmer, M. Medo, Y.-C. Zhang, Measuring economic complexity of countries and products: which

metric to use?, The European Physical Journal B 88 (11) (2015) 1–9.

[14] M. Cristelli, A. Gabrielli, A. Tacchella, G. Caldarelli, L. Pietronero, Measuring the intangibles: A metrics for the economic

complexity of countries and products, PLoS ONE 8 (8) (2013) e70726.

[15] M. Cristelli, A. Tacchella, L. Pietronero, The heterogeneous dynamics of economic complexity., PLoS ONE 10 (2) (2015)

e0117174.

[16] A. Vidmer, A. Zeng, M. Medo, Y.-C. Zhang, Prediction in complex systems: The case of the international trade network,

Physica A: Statistical Mechanics and its Applications 436 (2015) 188–199.

[17] J. Bascompte, P. Jordano, C. J. Meli´an, J. M. Olesen, The nested assembly of plant–animal mutualistic networks, Pro-

ceedings of the National Academy of Sciences 100 (16) (2003) 9383–9387.

[18] S. Jonhson, V. Dom´ınguez-Garc´ıa, M. A. Mu˜noz, Factors determining nestedness in complex networks, PloS one 8 (9)

(2013) e74025.

[19] G. Cimini, A. Gabrielli, F. S. Labini, The scientiﬁc competitiveness of nations, PLoS ONE 9 (12) (2014) e113470.
[20] J. Borge-Holthoefer, R. A. Ba˜nos, C. Gracia-L´azaro, Y. Moreno, The nested assembly of collective attention in online

social systems, arXiv preprint arXiv:1501.06809.

[21] A. Garas, C. Rozenblat, F. Schweitzer, The network structure of city-ﬁrm relations, arXiv preprint arXiv:1512.02859.
[22] P. Berkhin, A survey on pagerank computing, Internet Mathematics 2 (1) (2005) 73–120.
[23] G. Caldarelli, M. Cristelli, A. Gabrielli, L. Pietronero, A. Scala, A. Tacchella, A network analysis of countries export ﬂows:

ﬁrm grounds for the building blocks of the economy, PLoS ONE 7 (10) (2012) e47278.

[24] E. Pugliese, A. Zaccaria, L. Pietronero, On the convergence of the ﬁtness-complexity algorithm, arXiv preprint

arXiv:1410.0249.

[25] F. Battiston, M. Cristelli, A. Tacchella, L. Pietronero, How metrics for economic complexity are aﬀected by noise, Com-

plexity Economics 1 (1) (2014) 1–22.

[26] W. Ulrich, N. J Gotelli, Disentangling community patterns of nestedness and species co-occurrence, Oikos 116 (12) (2007)

2053–2061.

[27] M. D. K¨onig, C. J. Tessone, Network evolution based on centrality, Physical Review E 84 (5) (2011) 056108.
[28] A. Hagberg, P. J. Swart, D. A. Schult, Designing threshold networks with given structural and dynamical properties,

Physical Review E 74 (5) (2006) 056116.

[29] L. L¨u, Y.-C. Zhang, C. H. Yeung, T. Zhou, Leaders in social networks, the delicious case, PLoS ONE 6 (6) (2011) e21202.
[30] J.-G. Liu, L. Hou, X. Pan, Q. Guo, T. Zhou, Stability of similarity measurements for bipartite networks, Scientiﬁc reports

6.

[31] R. C. Feenstra, R. E. Lipsey, H. Deng, A. C. Ma, H. Mo, World trade ﬂows: 1962-2000, NBER Working Paper (11040).
[32] C. A. Hidalgo, B. Klinger, A.-L. Barab´asi, R. Hausmann, The product space conditions the development of nations, Science

317 (5837) (2007) 482–487.

[33] B. Balassa, Trade liberalisation and revealed comparative advantage1, The Manchester School 33 (2) (1965) 99–123.
[34] C. Spearman, The proof and measurement of association between two things, The American journal of psychology 15 (1)

(1904) 72–101.

