6
1
0
2

 
r
a

 

M
5
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
9
6
8
4
0

.

3
0
6
1
:
v
i
X
r
a

Reaction Time for Trimolecular Reactions in

Compartment-based Reaction-Diﬀusion Models

Fei Li∗ and Minghan Chen†

Department of Computer Science, Virginia Tech,

Blacksburg, VA 24061, USA

Radek Erban‡

Mathematical Institute, University of Oxford

Radcliﬀe Observatory Quarter, Woodstock Road,

Oxford, OX2 6GG, United Kingdom

Department of Computer Science, Virginia Tech,

Yang Cao§

Blacksburg, VA 24061, USA

(Dated: March 17, 2016)

Trimolecular reaction models are investigated in the compartment-based (lattice-based) framework
for stochastic reaction-diﬀusion modelling. The formulae for the ﬁrst collision time and the mean
reaction time are derived for the case where three molecules are present in the solution.

PACS numbers:

I.

INTRODUCTION

Trimolecular reactions are important components of bio-
chemical models which include oscillations [1], multi-
stable states [2] and pattern formation [3]. Considering
their reactant complexes, trimolecular reactions can be
subdivided into the following three forms

3U −→ ∅,
2U + V −→ ∅,
U + V + W −→ ∅,

(1)
(2)
(3)

where U , V and W are distinct chemical species (reac-
tants) and symbol ∅ denotes products. In what follows,
we will assume that product complexes ∅ do not include
U , V and W . Let us denote by u the concentration of
U . Then the conventional reaction-rate equation for tri-
molecular reaction (1) can be written as

du
dt

= −k(t) u3,

(4)

where k(t) denotes (in general, time-dependent) reaction
rate constant [4]. Using mass-action kinetics, rate k(t)
is assumed to be constant and equation (4) becomes an
autonomous ordinary diﬀerential equation (ODE) with a
cubic nonlinearity on its right-hand side. Cubic nonlin-
earities signiﬁcantly enrich the dynamics of ODEs. For
example, ODEs describing chemical systems with two
chemical species which do not include cubic or higher

∗Electronic address: felix@cs.vt.edu
†Electronic address: cmhshirl@cs.vt.edu
‡Electronic address: erban@maths.ox.ac.uk
§Electronic address: ycao@cs.vt.edu

nonlinearites cannot have any limit cycles [5]. On the
other hand, it has been reported that, by adding cubic
nonlinearities to such systems, one can obtain chemi-
cal systems undergoing homoclinic [5] and SNIC bifur-
cations [6], i.e. oscillating solutions are present for some
parameter regimes.

Motivated by the developments in systems biology [7,
8], there has been an increased interest in recent years
in stochastic methods for simulating chemical reaction
networks. Such approaches provide detailed information
about individual reaction events. Considering well-mixed
reactors, this problem is well understood. The method
of choice is the Gillespie algorithm [9] or its equivalent
formulations [10, 11]. These methods describe stochastic
chemical reaction networks as continous-time discrete-
space Markov chains. They are applicable to mod-
elling intracellular reaction networks in relatively small
domains which can be considered well-mixed by diﬀu-
sion. If this assumption is not satisﬁed, then stochastic
simulation algorithms for spatially distributed reaction-
diﬀusion systems have to be applied [12, 13]. The most
common algorithms for spatial stochastic modelling in
systems biology can be classiﬁed as either Brownian
dynamics (molecular-based) [14, 15] or compartment-
based (lattice-based) approaches [16, 17]. Molecular-
based models describe a trajectory of each molecule in-
volved in a reaction network as a standard Brownian mo-
tion. This can be justiﬁed as an approximation of interac-
tions (non-reactive collisions) with surrounding molecules
(heat bath) on suﬃciently long time scales [18, 19]. It is
then often postulated that bimolecular or trimolecular
reactions occur (with some probability) if the reactant
molecules are suﬃciently close [4, 20–22].

Brownian dynamics treatment of bimolecular reactions
is based on the theory of diﬀusion-limited reactions,
which postulates that a bimolecular reaction occurs if

two reactants are within distance R (reaction radius)
from each other. The properties of this model depend
on the physical dimension of the reactor. Considering
one-dimensional [23] and two-dimensional problems [24],
diﬀusion-limited reactions lead to mean-ﬁeld models with
time-dependent rate constants which converge to zero
for large times. This qualitative property is in one spa-
tial dimension shared by trimolecular reactions. It has
been shown that the mean-ﬁeld model (4) can be ob-
tained with time-dependent rate constant k(t) satisfying
for large times

k(t) ≈ Cr log t

t

,

(5)

where C is a constant [4, 25]. Considering three-
dimensional problems, the reaction radius of a diﬀusion-
limited bimolecular reaction can be related with a (time-
independent) reaction rate of the corresponding mean-
ﬁeld model [20]. Trimolecular reaction (1) can then be
incorporated into three-dimensional Brownian dynamics
simulations either directly [22] or as a pair of bimolecular
reactions U + U −→ Z and Z + U −→∅, where Z denotes
a dimer of U [26].
Compartment-based models divide the simulation do-
main into compartments (voxels) and describe the state
of the system by numbers of molecules in each compart-
ment. Compartments can be both regular (cubic lat-
tice) or irregular (unstructured meshes) [17]. Consider-
ing that the simulation domain is divided into cubes of
side h, the diﬀusive movement of molecules of U is then
modelled as jumps between neighbouring compartments
with rate du = Du/h2, where Du is the diﬀusion con-
stant of the chemical species U . In this paper, we will
consider compartment-based stochatic reaction-diﬀusion
models of the trimolecular reactions (1)–(3) in a narrow
domain [0, L]× [0, h]× [0, h] where L ≫ h. Such domains
are useful for modelling ﬁlopodia [27], but they can also
be viewed as a simpliﬁcation of a real three-dimensional
geometry when there is no variation in y and z directions.
Then the mean-ﬁeld model of trimolecular reaction (1)
can be formulated in terms of spatially varying concen-
tration u(x, t), where x ∈ [0, L] and t ≥ 0, which satisﬁes
partial diﬀerential equation (PDE)

∂u
∂t

= Du

∂2u
∂x2 − k u3,

(6)

where k is the macroscopic rate constant of the tri-
molecular reaction. To formulate the compartment-based
stochastic reaction-diﬀusion model, we divide the domain
[0, L] × [0, h] × [0, h] into K = L/h cubic compartments
[(i − 1)h, ih] × [0, h] × [0, h], i = 1, 2, . . . , K. Denoting
Ui the number of molecules of U in the i-th compart-
ment, the diﬀusion of U can be written as the chain of
“chemical reactions” [12]

2

Diﬀusion of V and W , which appear in trimolecular re-
actions (2) or (3), is described using the chains of “chem-
ical reactions” of the form (7) with the jump rates given
by dv = Dv/h2 and dw = Dw/h2, where Dv and Dw
are the diﬀusion constant of the chemical species V and
W , respectively. Trimolecular chemical reactions are lo-
calized in compartments, i.e. each of trimolecular reac-
tions (1)–(3) is replaced by K reactions:

3Ui

2Ui + Vi

Ui + Vi + Wi

k−→ ∅,
k−→ ∅,
k−→ ∅,

(8)

(9)

(10)

where i = 1, 2, . . . , K, and k denotes the macroscopic re-
action rate constant with units [m6 s−1]. Compartment-
based modelling postulates that each compartment is
well-mixed.
In particular, chemical reactions (7)–(10)
can be all simulated using the Gillespie algorithm [9]
(or other algorithms for well-mixed chemical systems [10,
11]) and the system can be equivalently described using
the reaction-diﬀusion master equation (RDME) [12]. In
particular, the probability that a trimolecular reaction
occurs in time interval [t, t + ∆t) in a compartment con-
taining one triplet of reactants is equal to α1 ∆t where

α1 =

k
h6

(11)

and ∆t is chosen suﬃciently small, so that α1 ∆t ≪ 1.
The standard scaling of reaction rates (11) is considered
in this paper when we investigate the dependence of tri-
molecular reactions on h. It has been previously reported
for bimolecular reactions that the standard RDME scal-
ing leads to large errors of bimolecular reactions [20]. One
of the goals of the presented manuscript is to investigate
the eﬀect of h on trimolecular reactions.

Diﬀusive chain of reactions (7) is formulated using a
narrow three-dimensional domain [0, L] × [0, h] × [0, h].
It can also be interpretted as a purely one-dimensional
simulation.
In this case, the simulated domain is one-
dimensional interval [0, L], divided into K = L/h inter-
vals [(i− 1)h, ih], i = 1, 2, . . . , K, where Ui is the number
of molecules of U in the i-th interval. Trimolecular re-
actions (8)–(10) are then written with one-dimensional
rate constant

k1D =

k
h4 ,

(12)

which have physical units [m2 s−1]. Then the probability
that a trimolecular reaction occurs in time interval [t, t +
∆t) in an interval containing one triplet of reactants is
equal to α2 ∆t where

α2 =

k1D
h2 ,

(13)

U1

du−→←−du

U2

du−→←−du

U3

du−→←−du

. . .

du−→←−du

UK.

(7)

and ∆t is chosen suﬃciently small, so that α2 ∆t ≪ 1.
In particular, two interpretations of the simulated diﬀu-
sive reaction chain (7) considered in this paper diﬀer by

physical units of k and k1D, and by the corresponding
scaling of reaction rate with h: compare (11) and (13).
The simulated model can also be used to verify the cor-
responding Brownian dynamics result (5), provided that
we appropriately relate h and R, and postulate that the
trimolecular reaction occurs (for sure) whenever a com-
partment contains one triplet of reactants [4].

The rest of the paper is organized as follows. In Sec-
tion II, we summarize recent results for bimolecular re-
actions in two spatial dimensions for periodic bound-
ary conditions and generalize them to reﬂective (no-ﬂux)
boundary conditions. These results are useful for inves-
tigating compartment-based stochastic reaction-diﬀusion
modelling of trimolecular reactions (1)–(3) as we will
show in Section III. Computational experiments illustrat-
ing the presented results are given in Section IV.

II. BIMOLECULAR REACTIONS IN TWO

DIMENSIONS

In this paper, we will focus on a special case where there
is only one combination of reactants present in the sys-
tem and we study the times for trimolecular reactions
(1)–(3) to ﬁre. A similar problem for a bimolecular reac-
tion U +V −→ ∅ with one U molecule and one V molecule
is investigated in Hellander et. al. [28] for both two-
dimensional and three-dimensional compartment-based
models. Dividing two-dimensional domain [0, L] × [0, L]
into square compartments of size h, the mean time until
the two molecules react is [28]

τbimol =

h2(1 + N 1

steps)

kb

+

h2Nsteps

4(Du + Dv)

,

(14)

where kb is the bimolecular reaction rate with units [m2
s−1], and N 1
steps is the mean number of diﬀusive jumps
until U and V are in the same compartment, given that
they are initially one compartment apart. Nsteps is the
mean number of steps, until U diﬀuses to V ’s location
for the ﬁrst time. The quantities Nsteps and N 1
steps can
be estimated using the theorem in Montroll [29]:

Theorem 1. Assume that the molecule U has a uni-
formly distributed random starting position on a ﬁnite
two-dimensional square lattice with periodic boundary
conditions. Then the following holds:

Nsteps = π−1N log(N ) + 0.1951N + O(1),

(15)

where N = L2/h2 is the number of lattice points (com-
partments) in the domain. Furthermore, N 1
steps = N − 1.

Using Theorem 1 and (14), we have [28]

τbimol =

L2
kb

+ τcoll,

(16)

where τcoll
molecules U and V , which can be approximated by

is the mean time for the ﬁrst collision of

τcoll ≈

L2 log(L h−1)
2π(Du + Dv)

+ 4.878×10−2

L2

Du + Dv

,

(17)

3

as h −→ 0. Using (16)–(17), we see that the reaction time
for the bimolecular reaction U + V −→ ∅ tends to inﬁn-
ity when the compartment size h tends to zero [28]. In
particular, equations (16)–(17) imply that the bimolec-
ular reaction is lost from simulation when h tends to
zero. Thus there has to be a lower bound for the com-
partment size. This has also been shown using diﬀerent
methods in three-dimensional systems and improvements
of algorithms for h close to the lower bound have been
derived [20, 28].

Equations (16)–(17) give a good approximation to
the mean reaction time of bimolecular reaction for two-
dimensional domains, provided that the periodic bound-
ary conditions assumed in Theorem 1 are used. How-
ever, the chain of chemical reactions (7) implicitly as-
sumes reﬂective boundary conditions. Such boundary
conditions (together with reactive boundary conditions)
are commonly used in biological systems whenever the
boundary of the computational domain corresponds to a
physical boundary (e.g. cell membrane) in the modelled
system [13]. In Figure 1, we show that formula (17) is
not an accurate approximation to the mean collision time
for reﬂective boundary conditions. Reﬂective boundary
conditions mean that a molecule remains in the same lat-
tice point when it hits the boundary. We plot results for
Du = Dv, for Du > Dv and for Du < Dv in Figure 1.
In each case, we see that formula (17) matches well with
numerical results for periodic boundary conditions.
In
order to ﬁnd a formula that matches with numerical ex-
periment results for reﬂective boundary conditions, we ﬁx
the coeﬃcient of the ﬁrst term in (17) and perform data
ﬁtting on the second coeﬃcient. We obtain the following
formula for the reﬂective boundary condition:

τcoll ≈

L2 log(L h−1)
2π(Du + Dv)

+ 1.4053

L2

Du + Dv

.

(18)

The average times for the ﬁrst collision of U and V given
by (18) are plotted in Figure 1 corresponding to diﬀerent
sets of diﬀusion rates. It can be seen that formula (18)
matches well with numerical experiment results with re-
ﬂective boundary conditions. In Figure 2, we show an-
other comparison between formula (18) and numerical
experiment data with reﬂective boundary conditions.

III. MEAN REACTION TIME FOR

TRIMOLECULAR REACTION

In this paper, we will ﬁrst consider periodic boundary
conditions and generalize formula (16) to all cases of tri-
molecular reactions (1)–(3) in one spatial dimension, us-
ing both scalings (11) and (13) of reaction rates.

Both trimolecular reactions (1) and (2) are special
cases of (3). Since we will focus on the simpliﬁed sit-
uation where there is only one molecule for each reac-
tant of (3), we may consider (1) as the special case of (3)
where diﬀusion rates for all three molecules are the same,
and (2) as the special case where at least two of the three

Formula (17)
Experiment (periodic boundary)
Formula (18)
Experiment (reflective boundary)

 

(a)

(b)

(c)

0.8

0.7

0.6

0.5

0.4

0.3

0.2

e
m

i
t
 

n
o
s

i

i
l
l

o
c
 

n
a
e
M

0.1

 
 23

 24

 25

 26

 28

 29

210

211

 27
L/h

FIG. 1: Comparison of the original formula (17) and our
revised formula (18) with mean collision time from numer-
ical simulations with periodic and reﬂective boundary condi-
tions. The two molecules diﬀuse freely in the 2D domain, with
the initial position uniformly distributed in the computational
domain. Three parameter sets: (a) Du = 1, Dv = 1; (b)
Du = 2, Dv = 1; (c) Du = 1, Dv = 3.

Formula (18)
Experiment (reflective boundary)

 

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
m

i
t
 

n
o
s

i

i
l
l

o
c
 

n
a
e
M

0

 

10−1

100

101
Du

102

103

FIG. 2: Mean collision times with reﬂective boundary con-
dition corresponding to diﬀerent Du values when Dv = 1 is
ﬁxed. We use L = 1.0 and h = 0.01.

molecules have the same diﬀusion rates. We will denote
the value of mean reaction time by τtrimol. We will de-
compose τtrimol into two parts:

τtrimol = τreact + τcoll,

(19)

where τreact gives the mean time for reaction given that
the molecules are initially located in the same compart-
ment, and τcoll is the mean time for the ﬁrst collision,
i.e. the average time to the state of the system which
has all molecules in the same compartment, given that
they were initially uniformly distributed. Note that the
bimolecular formula (14) was written in the form of a
similar decomposition like (19). We will call τcoll a colli-

sion time.

4

A. Special case where Du = Dv and Dw = 0

We will start with a simple case with Du = Dv and
Dw = 0. Then the only W molecule will be ﬁxed at its
initial location. Under the periodic boundary condition
assumption, without loss of generality, we assume that
this W molecule is located at the center of the interval

[0, L], or speciﬁcally, in the compartment (cid:2) K+1

[x] represents the largest integer that is smaller than x.
The U and V molecules diﬀuse according to (7) from
their initial compartments. The reaction can ﬁre only
when both U and V molecules jump to the center since
the only W molecule is at the center. Let τcoll be the
mean time for these two molecules (U and V ) to be both
at the center for the ﬁrst time, which requires that their

2 (cid:3), where

compartment number is equal to(cid:2) K+1
2 (cid:3).

Instead of trying to develop a formula for the collision
time of two molecules diﬀusing to a ﬁxed compartment
in the one-dimensional lattice, we consider an equivalent
problem: Imagine a Z molecule jumps with a diﬀusion
rate Du within an K × K grid in the two-dimensional
space and let its compartment index be z = (x1, x2).
Then the two independent random walks by the two U
and V molecules in one-dimensional lattice can be viewed
equivalently as the random walk of the Z molecule in
the two-dimensional square lattice with diﬀusion rate Du.
Collision time τcoll is then equal to the mean time for
the pseudo molecule Z to jump to the center for the ﬁrst
time, which is the case discussed in Section II. Therefore,
the formula (16) can also be applied to the trimolecular
reaction (3) when Dw = 0 and Du = Dv and periodic
boundary conditions are considered.

B. Special case where Du 6= Dv and Dw = 0

Formula (16) cannot be directly applied to (3) if Du 6=
Dv even if Dw = 0. We can still assume W is in the cen-
ter and consider the equivalent problem of a Z molecule
jumps with a diﬀusion rate Du in the x axis and Dv
in the y axis within an K × K grid in the 2D space.
The two independent random walks by the two U and V
molecules in 1D space can be viewed equivalently as the
random walk of the Z molecule in the 2D space with dif-
fusion rate Du and Dv. We thus introduce the following
theorem. The proof can be found in Appendix A.

Theorem 2. Assume that the molecule Z has a uni-
formly distributed random starting position in a 2D lat-
tice and that the molecules can move to nearest neigh-
bours only. Assume Z diﬀuses with diﬀusion rate Du in
the x direction, Dv in the y direction, and Du ≥ Dv.

Then the following holds:

L2

log(cid:16) L

h(cid:17) + L2
2πpDuDv
4πpDuDvh2(cid:16)γ + log(cid:16) 2

12Dv

L2

+

τcoll =

where

γ = lim(cid:18)1 +

1
2

+

1
3

+ ··· +

Dv(cid:17)i ,
π(cid:17)(cid:17) − log(cid:16)1 + Du
n − log n(cid:19) ≈ 0.5772.

(20)

1

C. Collision time for the general trimolecular

reaction

In this subsection we consider the trimolecular reaction
(3) with corresponding diﬀusion rates Du, Dv and Dw.
Without loss of generality, we assume Du ≥ Dv ≥ Dw >
0.
We consider one pseudo molecule Z = (z1, z2), where
z1 and z2 are expressed in terms of locations xu, xv and
xw of three molecules by

z1 = xu − xw,

and z2 = xv − xw.

(21)

When U , V and W diﬀuses with rates Du, Dv and Dw,
the pseudo molecule Z jumps on the 2D lattice corre-
sponding to (21). When Z jumps to the origin, U , V
and W will be in the same grid, and vice versa. Thus the
collision time of the trimolecular reaction in 1D is again
converted to the corresponding collision time of the bi-
molecular problem in 2D. The actual grid and jumps are
illustrated in Figure 3.

FIG. 3: Illustration of the 2D structure for the jumps of Z
based on (21). When U molecule jumps, the corresponding Z
jumps (shown in red) the direction (z1, z2) −→ (z1, z2 ± 1).
When V molecule jumps, the corresponding Z jumps (shown
in green) the direction (z1, z2) −→ (z1 ± 1, z2); When W
molecule jumps, the corresponding Z jumps (shown in blue)
the direction (z1, z2) −→ (z1 ± 1, z2 ± 1). The whole domain
has a similar shape and is not square.

The diﬃculty of the mapping (21) is that the resulted
domain is not square. So we cannot apply the theoretical
results presented in the Appendix. In order to apply an

5

estimation on a square lattice, we need to further modify
the mapping (21). We will take

z1 = |xu − xw|,

and z2 = |xv − xw|.

(22)

Then the molecule Z with coordinates (z1, z2) will jump
in an K × K 2D square lattice, where K = L/h. Of
course, the jumps at the boundary will be diﬀerent from
the illustration in Figure 3, but that is just symmetric
reﬂection. It does not change the validity of the formula
derived in the Appendix, which is based on the assump-
tion of periodic lattices. The domain resulted from the
mapping (22) is shown in Figure 4. We have the following

FIG. 4: Illustration of the 2D square domain resulted from
(22). The original domain (dotted line) resulted from (21) is
not square. With (22), the shadowed domain is square and
the theoretical analysis in Appendix can be applied.

approximation formula for the mean jump time.

τcoll =

where

and

π(cid:19)(cid:17) − log (1 + η′)(cid:21) .

+

L2

L2

L2

12 (Dv + Dw)

log(cid:18) L
h(cid:19) +
2πbD
4πbD(cid:20)2(cid:16)γ + log(cid:18) 2
bD =pDuDv + DuDw + DvDw,

(23)

(24)

(25)

η′ =

.

D2
u

bD2

Remark: Formula (23) also implies an estimation of the
collision time of bimolecular reaction in a 1D domain.
In (23), if we let Du −→ ∞, the formula leads to an
estimation of the mean collision time of a bimolecular
reaction V + W → ∅ in a 1D domain [0, L], which is
independent of h

τcoll =

L2

12(Dv + Dw)

.

(26)

D. Formula under reﬂective boundary conditions

IV. NUMERICAL RESULTS

6

As shown in Section IV, formula (23) matches with the
result computed by stochastic simulations for periodic
boundary condition very well. However, when we con-
sider a reﬂective boundary condition, we see a mismatch.
In order to ﬁnd a formula that matches with the reﬂec-
tive boundary condition results, we performed numerical
experiments and collected the mean collision time with
reﬂective boundary conditions. Then with data ﬁtting,
we managed to ﬁnd the formula that matches with nu-
merical results corresponding to reﬂective boundary con-
ditions. (See Appendix B for derivation of the coeﬃcient
of 0.140.) Equation (27) gives an estimation of the mean
ﬁrst collision time of 1D trimolecular reaction

+

L2

L2

L2

τcoll =

Dv + Dw

h(cid:19) + 0.140
log(cid:18) L
2πbD
4πbD(cid:20)2(cid:18)γ + log(cid:18) 2

π(cid:19)(cid:19) − log(cid:18)0.125 +

4(cid:19)(cid:21) ,
where bD is deﬁned in Equation (24) and η′ is deﬁned in

Equation (25).
Remark: When we let Du → ∞, we have

(27)

η′

τcoll = 0.14

.

(28)

L2

Dv + Dw

E. Mean Reaction Time

Formula (23) gives the estimation for the mean col-
lision time τcoll of trimolecular reactions. For the ﬁrst
reaction time τtrimol, since our derivation is based on
corresponding analysis on 2D grids, an estimation simi-
lar to the equation (14) can be applied. We have

τtrimol ≈

h2(1 + N 1

steps)

k1D

+ τcoll,

(29)

as h −→ 0, where k1D is the reaction rate for the tri-
molecular reaction as deﬁned in (12) and (13).
For biochemical reactions with reﬂective boundary
conditions, we have the formula for the corresponding
mean reaction time:

τtrimol =

takes the form

τtrimol =

(30)
Correspondingly, if we use the scaling in (11), (30)

L2
k1D

+

+

L2

L2

log(cid:18) L
2πbD
4πbD(cid:20)2(cid:18)γ + log(cid:18) 2
log(cid:18) L
2πbD
4πbD(cid:20)2(cid:18)γ + log(cid:18) 2

k
L2

L2

+

L2h4

+

L2

h(cid:19) + 0.140
π(cid:19)(cid:19) − log(cid:18)0.125 +

Dv + Dw

η′

4(cid:19)(cid:21) .

L2

h(cid:19) + 0.140
π(cid:19)(cid:19) − log(cid:18)0.125 +

Dv + Dw

η′

4(cid:19)(cid:21) .

(31)
We can see that as h → 0, the reaction time will be
dominated by the collision time in either case.

We test the collision time of the general trimolecular re-
action (3). Figure 5 shows the comparison of the nu-
merical results of the mean ﬁrst collision time with pe-
riodic and reﬂective boundary conditions with the two
formulas (23) and (27). Figure 5 demonstrates that for-
mula (23) matches well with computational results ob-
tained by stochastic simulations corresponding to peri-
odic boundary conditions, justifying our analysis. It also
shows that formula (27) matches well with experimental
results corresponding to reﬂective boundary conditions.
Figure 6 shows the plot of numerical results of the mean
ﬁrst collision time with periodic and reﬂective boundary
conditions corresponding to diﬀerent Du when we ﬁx L,
Dv and Dw. We can see that the two formulas match
with the numerical results very well. We also present an-
other comparison and analysis for the special case when
Du → ∞ in Appendix B.

Experiment (reflective boundary)
Experiment (periodic boundary)
Formula (26)
Formula (23)

8

7

6

5

4

3

2

1

e
m

i
t
 

n
o
s

i

i
l
l

o
c
 

n
a
e
m

 

(a)

(b)

(c)

0

 

 23

 24

 25

 27

 28

 29

210

 26
L/h

FIG. 5: The mean ﬁrst collision time of three molecules in the
1D domain (for periodic and reﬂective boundary conditions).
The solid lines plot the mean colision time with periodic and
reﬂective boundary conditions corresponding to Formula (23)
and Formula (27), while dash lines show the numerical re-
sults by stochastic simulations. For the same color from top
to bottom, the three sets of diﬀusion rate parameters are (a)
Du = Dv = Dw = 0.1; (b) Du = 0.5, Dv = 0.2, Dw = 0.1
and (c) Du = 2.5, Dv = 0.5, Dw = 0.1.

For the mean reaction time comparison, we focus only
on reﬂective boundary condition. In Figure 7, we show
the comparison of mean reaction time with formula (30)
corresponding to a ﬁx set of diﬀusion rates and diﬀerent
reaction rates k1D.

V. DISCUSSION

The important consequence of Formula (23) and For-
mula (27) is that when h −→ 0, τcoll −→ ∞. Since tri-
molecular reaction time τtrimol > τcoll, the reaction time

e
m

i
t
 

l

a
u
m
r
o
f
 
d
n
a

 

e
m

i
t
 
n
o
s

i

i
l
l

 

o
c
n
a
e
m

2

1.8

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

0

 

 

Formula (26)
Formula (23)
Experiment (reflective boundary)
Experiment (periodic boundary)

100

101

D
u

102

103

FIG. 6: The plot of mean trimolecular collision time (for peri-
odic and reﬂective boundary conditions) against diﬀusion rate
Du. Other parameters are given as Dv = 0.2, Dw = 0.1 and
N = 20. The 1D domain size is ﬁxed at L = 1.0.

Formula (31)
Numerical Experiment

 

← (a)

← (b)
← (c)

4.5

4

3.5

3

2.5

2

1.5

e
m

i
t
 

n
o

i
t

a
e
r
 

n
a
e
m

1

 

23

24

25

26
L/h

27

28

29

FIG. 7: The plot of mean trimolecular reaction time for re-
ﬂective boundary condition against log(L/h). The parameters
for the plot are L = 1.0, Du = 0.5, Dv = 0.2, Dw = 0.1. For
the same color, the reaction rates from top to bottom are (a)
k1D = 1.0, (b) k1D = 5.0, (c) k1D = 25.0, respectively.

7

also tends to inﬁnity.
In particular, our analysis con-
ﬁrms the observations made in [4, 25] that the diﬀusion-
limited three-body reactions do not recover mean-ﬁeld
mass-action results in 1D. The rate constant in (4) for
such problems is time dependent, given by (5), and con-
verges to zero as t → ∞. In the limit h → 0, the average
collision time goes to inﬁnity and the rate constant k(t)
in (4) converges to zero for any ﬁnite time. It is given
by (5), where C ≡ C(h) converges to zero as h → 0.
In recent years, this topic has been discussed for the bi-
molecular reaction in the 2D and 3D cases as well. This
limitation is a great challenge for spatial stochastic sim-
ulation.

Acknowledgments. The research leading to these
results has received funding from the European Re-
search Council under the European Community’s Seventh
Framework Programme (FP7/2007-2013)/ERC grant
agreement n◦ 239870. Radek Erban would like to thank
the Royal Society for a University Research Fellowship
and the Leverhulme Trust for a Philip Leverhulme Prize.
This work was carried out during the visit of Radek Er-
ban to the Isaac Newton Institute. This work was par-
tially supported by a grant from the Simons Foundation.

[1] J. Schnakenberg. Simple chemical reaction systems with
limit cycle behaviour. Journal of Theoretical Biology,
81:389–400, 1979.

[2] F. Schl¨ogl. Chemical reaction models for non-equilibrium
phase transitions. Zeitschrift f¨ur Physik, 253(2):147–161,
1972.

[3] L. Qiao, R. Erban, C. Kelley, and I. Kevrekidis. Spa-
tially distributed stochastic systems: Equation-free and
equation-assisted preconditioned computation. Journal
of Chemical Physics, 125:204108, 2006.

[4] G. Oshanin, A. Stemmer, S. Luding, and A. Blumen.
Smoluchowski approach for three-body reactions in one
dimension. Physical Review E, 52(6):5800–5805, 1995.

[5] T. Plesa, T. Vejchodsk´y, and R. Erban. Chemical
an

reaction systems with a homoclinic bifurcation:

inverse problem.
submitted to Mathematical Mod-
els and Methods in Applied Sciences, available as
http://arxiv.org/abs/1510.07205 , 2015.

[6] R. Erban, S. J. Chapman, I. Kevrekidis, and T. Vejch-
odsky. Analysis of a stochastic chemical system close to
a SNIPER bifurcation of its mean-ﬁeld model. SIAM
Journal on Applied Mathematics, 70(3):984–1016, 2009.
[7] J. Paulsson, O. Berg, and M. Ehrenberg. Stochastic fo-
cusing: Fluctuation-enhanced sensitivity of intracellular
regulation. Proceedings of the National Academy of Sci-
ences USA, 97(13):7148–7153, 2000.

[8] M. Elowitz, A. Levine, E. Siggia, and P. Swain. Stochas-
tic gene expression in a single cell. Science, 297:1183–
1186, 2002.

[9] D. Gillespie. Exact stochastic simulation of coupled

chemical reactions.
81(25):2340–2361, 1977.

Journal of Physical Chemistry,

[10] M. Gibson and J. Bruck. Eﬃcient exact stochastic simu-
lation of chemical systems with many species and many
channels. Journal of Physical Chemistry A, 104:1876–
1889, 2000.

[11] Y. Cao, H. Li, and L. Petzold. Eﬃcient formulation of the
stochastic simulation algorithm for chemically reacting
systems. Journal of Chemical Physics, 121(9):4059–4067,
2004.

[12] R. Erban, S. J. Chapman, and P. Maini. A practical guide
to stochastic simulations of reaction-diﬀusion processes.
35 pages, available as http://arxiv.org/abs/0704.1908,
2007.

[13] R. Erban and S. J. Chapman. Reactive boundary condi-
tions for stochastic simulations of reaction-diﬀusion pro-
cesses. Physical Biology, 4(1):16–28, 2007.

[14] S. Andrews and D. Bray. Stochastic simulation of chem-
ical reactions with spatial resolution and single molecule
detail. Physical Biology, 1:137–151, 2004.

[15] K. Takahashi, S. Tanase-Nicola, and P. ten Wolde.
Spatio-temporal correlations can drastically change the
response of a mapk pathway. PNAS, 107:19820–19825,
2010.

[16] J. Hattne, D. Fange, and J. Elf. Stochastic reaction-
Bioinformatics,

diﬀusion simulation with MesoRD.
21(12):2923–2924, 2005.

[17] S. Engblom, L. Ferm, A. Hellander, and P. L¨otstedt.
Simulation of stochastic reaction-diﬀusion processes on
unstructured meshes. SIAM Journal on Scientiﬁc Com-
puting, 31:1774–1797, 2009.

[18] R. Erban. From molecular dynamics to Brownian dynam-
ics. Proceedings of the Royal Society A, 470:20140036,
2014.

[19] R. Erban. Coupling all-atom molecular dynamics simu-
lations of ions in water with Brownian dynamics. Pro-
ceedings of the Royal Society A, Volume 472, Number
2186, 20150556 (2016).

[20] R. Erban and S. J. Chapman. Stochastic modelling of
reaction-diﬀusion processes: algorithms for bimolecular
reactions. Physical Biology, 6(4):046001, 2009.

[21] I. Agbanusi and S. Isaacson. A comparison of bimolecular
reaction models for stochastic reaction-diﬀusion systems.
Bulletin of Mathematical Biology, Volume 76, Number 4,
pp. 922-946 (2014).

[22] M. Flegg.

Smoluchowski reaction kinetics for re-
available as

submitted,

actions of any order.
http://arxiv.org/abs/1511.04786, 2015.

[23] D. Torney and H. McConnell. Diﬀusion-limited reac-
tions in one dimension. Journal of Physical Chemistry,
87(11):1941–1951, 1983.

[24] D. Torney and H. McConnell. Diﬀusion-limited reaction
rate theory for two-dimensional systems. Proceedings of
the Royal Society A, 387:147–170, 1983.

[25] D. ben Avraham. Diﬀusion-limited three-body reactions
in one dimension. Physical Review Letters, 71(24):3733–
3735, 1993.

[26] D. Gillespie. Markov Processes, an introduction for phys-
ical scientists. Academic Press, Inc., Harcourt Brace Jo-
vanowich, 1992.

[27] R. Erban, M. Flegg, and G. Papoian. Multiscale stochas-
tic reaction-diﬀusion modelling: application to actin dy-
namics in ﬁlopodia. Bulletin of Mathematical Biology,
76(4):799–818, 2014.

8

[28] S. Hellander, A. Hellander, and L. Petzold. Reaction-
diﬀusion master equation in the microscopic limit. Phys-
ical Review E, 85:042901, 2012.

[29] E. Montroll. Random walks on lattices. III. Calculation
of ﬁrst-passage times with application to exciton trap-
ping on photosynthetic units. Journal of Mathematical
Physics, 10(4):753–765, 1969.

Appendix A: Formula of Nonuniform Random Walk

on a 2D Lattice

We consider the random walk problem on a square 2D
lattice. The estimation procedure we present here is gen-
eralized from the original idea in Montroll [29]. Following
the notations in Montroll [29], let Fn(s) be the probabil-
ity that a lattice walker which starts at the origin arrives
at a lattice point s for the ﬁrst time after n steps and

F (s, z) =

znFn(s)

∞Xn=1

be the generating function of the set {Fn(s)}. Montroll
showed that

F (s, z) = [P (s, z) − δs,0]/P (0, z),

where P (s, z) is the generating function

P (s, z) =

znPn(s),

∞Xn=0

where Pn(s) is the probability that a walker starting from
the origin attires at s for the ﬁrst time after n steps, no
matter how many previous visits he already had at s.
The generating function for the probability that a walker
will be trapped at the origin in a given number of steps
is

Gs(z) =

=

F (s, z)

1

N − 1Xs6=0
N − 1(Xs

1

F (s, z) − F (0, z)) ,

where N = m2 (with m = L
h ) is the total number of
grids in the square 2D lattice. The average number [29]
of steps required to reach the origin for the ﬁrst time is

hni = ∂Gs/∂z|z=1

=

1

N − 1

∂

∂z(cid:26)

1

(1 − z)P (0, z)(cid:27)z=1

.

(A1)

In order to ﬁnd the formula for P (0.z), the structure
function is deﬁned as

λ(θ) =Xs

p(s) exp(iθs),

where p(s) is the probability that at any step a random

walker makes a displacement s. Ps p(s) = 1. In this 2D

square lattice, we consider a general problem. Suppose
the random walk can jump to left and right with rate
Du/h2, to up and down with rate Dv/h2, and to the di-
agonal directions with rate Dw/h2. Let σ2
,
σ2
2 =

1 =
Du+Dv +Dw
, We thus have

, and σ2

3 =

Du+Dv +Dw

Du+Dv +Dw

Dw

Du

Dv

σ2
1 + σ2

2 + σ2

3 = 1.

There are some special cases. In a uniform diﬀusion case,
σ1 = σ2 = σ3 = √3/3. In the case Dw = 0, σ3 = 0 and
then when σ1 = σ2, that will be the simple case discussed
in Montroll [29]. Here we will simply derive the general
formula and then discuss diﬀerent special cases. For the
probability p(s) we have p(1, 0) = p(−1, 0) = σ2
1/2 and
p(0, 1) = p(0,−1) = σ2
3/2
and

2/2, p(1, 1) = p(−1,−1) = σ2

λ(σ) = c1σ2

1 + c2σ2

2 + σ2

3(c1c2 + s1s2),

where θ = (θ1, θ2), ci = cos θi and si = sin θi. Then

P (0, z) = m−2

m−1Xk1=0

m−1Xk2=0

[1 − zλ(2πk1/m, 2πk2/m)]−1 .

In order to obtain hni, we need to estimate P (0, z). Fol-
lowing Montroll’s work [29],

1z(cid:3)−1

f (z, θ1),

Thus

[1 − c2w1 − w2s2]−1 ,

P (0, z) =

1
m

f (z, θ1) =

where

with

and

m−1Xk1=0(cid:2)1 − c1σ2
m−1Xk2=0

1
m

w1 =

2 + c1σ2
z(σ2
3
1 − zc1σ2

1

,

w2 =

z(σ2
3s1
1 − zc1σ2

1

,

Now we estimate P (0, z) as

P (0, z) =

1
m

m−1Xk1=0((cid:0)1 − zc1σ2
1(cid:1)−1
p1 − ρ2

9

1 − 2xm cos mφ + x2m) .

1 − x2m

First, when k1 = 0, c1 = 1, s1 = 0, w2 = 0 and φ = 0.
Then

ρ = w1 = z(1 − σ2

(1 − σ2
1)z
1 − σ2
1z
The corresponding term in P (0, z) is given by

1z)−1(σ2

2 + σ2

3) =

.

(A3)

2

2

2

1

1

1

1+xm

1+xm

1)−1 1+xm

m (1 − zσ2

= 1
m
= 1
m
= 1
m

1 )
1−zσ2
1)2 − z2(1 − σ2

)2o− 1
1−xmn1 − ( z(1−σ2
1−xm(cid:8)(1 − zσ2
1)2(cid:9)− 1
1(cid:9)− 1
2(cid:8)1 + z − 2zσ2
1−xm (1 − z)− 1
α(cid:8)2(1 − σ2
1)(cid:9)− 1
2(cid:2)1 − β2(1 − 2σ2
1+xm
1−xm
where α = √1 − z and β =
α√2(1−σ2
x = [1 −p1 − ρ2]/ρ

1−√1−z√1+z−2σ2
1β2 − (2σ2
When m is large, we have estimate

=
z(1−σ2
1 )
= 1 − 2β + 2σ2

x deﬁned as in equation (A2).

1−zσ2

1 z

1 )

1 − 3)β3 + ··· .

2 ,

1)(cid:3)− 1

. Now we estimate

xm = 1 − 2mβ + 2m2β2 − 4/3m3β3 + ··· .
m2β2 + O(β3)(cid:19) .

2mβ(cid:18)1 + mβ +

1
3

1

(1 − xm)−1 =

Then the k1 = 0 term is given by

1

[m2(1 − z)]−1 +

6(1 − σ2
1)
For other values of k1 as z −→ 1,

+ O(1 − z)1/2.

3)2 − (σ2

2 + c1σ2

1)2 − (σ2

1(cid:1)p1 − ρ2
(cid:0)1 − c1σ2
= (cid:2)(1 − c1σ2
= √1 − c1(cid:0)1 − σ4
= √1 − c1p2(σ2
= 2pσ2
×(cid:2)1 + η sin2(πk1/m)(cid:3)1/2

2 + σ2

1σ2

2 − σ4
3 − c1σ4
1σ2
2 + σ2
1σ2
3 + σ2
2σ2
3 + σ2
1σ2
3 sin(πk1/m)

2σ2

1(cid:1)1/2

,

3s1)2(cid:3)1/2

3) + σ4

1(1 − c1)

where

Following Appendix A of Montroll [29], we deﬁne w1 +
iw2 = ρeiφ. Thus

ρ2 = w2

1 + w2
2.

Then (equation (A7) in Montroll [29])

f (z, θ1) =

1 − x2m

1 − 2xm cos mφ + x2m ,

1

p1 − ρ2
x2 − 2x/ρ + 1 = 0.

η =

Thus

σ4
1
1σ2
2 + σ2

1σ2
σ2

3 + σ2

2σ2
3

.

(A4)

(A2)

P (0, z) = [m2(1−z)]−1+

1

2(1 − σ2

1)(cid:20) 1

3

+

φ(0, 1)

r

(cid:21)+O(1−z)1/2,

where x is the smaller root of the equation

with

,

(A5)

ˆσ =qσ2

1σ2

2 + σ2

1σ2

3 + σ2

2σ2
3,

10

γ = lim(cid:18)1 +

1
2

+

1
3

+ ··· +

1

n − log n(cid:19) ≈ 0.5772,

and η =

1

σ4
1 σ2

σ2

1 σ2

2 +σ2

3 +σ2

2 σ2

3

. According to (A1), we have

hni = c1N log N + c2N + c3 + O(cid:18) 1
N(cid:19) .

(A7)

Now consider the special case Dw = 0. Then σ3 = 0
and the domain is really a square lattice. In this case,
we have

S2 = −

1
π

log(1 + η) +

ηπ
12m2 + ··· .

and

where

r = pσ2

1σ2
2 + σ2
1 − σ2
and φ(0, 1) = S1 + S2 + S3 with

1σ2

1

3 + σ2

2σ2
3

S1 =

S2 =

S3 =

,

1

1
m

1
m

m−1Xk=1
m−1Xk=1
m−1Xk=1
1
m
×[1 + η sin2(πk/m)]−1/2.

sin(πk/m)
[1 + η sin2(πk/m)]−1/2 − 1
sin(πk/m)(cid:26) 2xm(cos φm − xm)
1 − 2xm cos φm + x2m(cid:27)

sin(πk/m)

1

,

Following the Appendix A in Montroll [29], there are es-
timates for S1, S2.

S1 =

2

π(cid:26)log m + [γ + log(2/π)] −

π2

72m2 + ···(cid:27) .

The estimation for S3 is complicated. But fortunately
S3’s contribution to P (0, z) can be considered small r,
deﬁned in (A5), is not too small. Note that we can obtain
an estimation (see Appendix in Montroll [29])

x = [1 −p1 − ρ2]/ρ ≈ 1 − 2rs + 2r2s2 + ··· ,

where s = sin πk/m and r is given in (A5). Thus

xm ≈ e−2rsk(1 + O(1/m2)).

If r is close to zero, xm will be close to one. Then xm
1−xm
will be very large, and so will S3. But if r is large, xm
will be close to zero (except for the term k = 0) and
S3 will be small. In order to control the error from the
S3 term, we always choose Du, Dv and Dw such that

Du ≥ Dv ≥ Dw. In this way r ≥h σ2

√2
2 and
S3 will remains relatively small, when m is large. Thus
we will simply disregard the S3 term in our formula.

3i1/2

2 +σ2

≥

σ2

1

To sum it up, when we choose σ1 ≥ σ2 ≥ σ3 and con-
sidering N = m2, we disregard S3 and have an estimate
of P (0, z) as

P (0, z) ≈ [N (1 − z)]−1 + {c1 log N + c2 + c3/N}

+O(N−2) + O((1 − z)1/2),

ˆσ = σ1σ2,

η =

σ2
1
σ2
2

,

r =

σ1
σ2

.

If we select Du ≥ Dv (thus σ1 ≥ σ2), r ≥ 1, the S3
term will be relatively small. Then multiply (A7) with
the average time for each jump 1/k, where k = 2(Du +
Dv)/h2, apply N = (L/h)2, and disregard lower order
terms, we obtain

τcoll =

L2

2π√DuDv
+ L2

log(cid:0) L

h(cid:1) + L2

12Dv

4π√DuDvh2(γ + log(2/π)) − log(cid:16)1 + Du
Dv(cid:17)i .

(A8)
If we assume further that Du = Dv, the equation (A8) is
close to (16) except a small diﬀerence due to the S3 term.
Note that in this case, the formula (A8) is a rigorous
estimate.

If Dw 6= 0, and assume the 2D lattice is square, we let
2(Du+Dv +Dw) , we end

h2 and multiply (A7) with

N = L2
up with a similar estimation

h2

τcoll = L2
2π ˆD
+ L2
4π ˆD

log(cid:0) L
h(cid:1) +

L2

12(Dv +Dw)

[2(γ + log(2/π)) − log (1 + η′)] .

(A9)

(A6)

where

where

c1 =

c2 =

c3 =

1

2πˆσ

,

1

6(1 − σ2
1)
π
24ˆσ

(η − 1/3),

+

1

2πˆσ

[2(γ + log(2/π)) − log(1 + η)] ,

and

ˆD =pDuDv + DuDw + DvDw,

η′ =

D2
u
ˆD2

.

Appendix B: Special case: Du → ∞

Next, we deﬁne a probability function

11

When the diﬀusion rate of U approaches to inﬁnity,
the trimolecular system becomes a bimolecular collision
model of V and W . The formula (27) gives the mean
time for bi-molecular collisions, when Du → ∞:

τcoll = 0.14

lim

Du→∞

L2

Dv + Dw

.

(B1)

In this subsection, we investigate the mean bi-molecular
collision time and derive the formula for bi-molecular col-
lision time when the other two molecules have a same
diﬀusion rate Dv = Dw.

FIG. 8: The conversion of the 1D collision model to the ﬁrst
exit time model in 2D domain. (a) The collision model of two
molecules V and W freely diﬀuse in 1D. (b) The diﬀusion
model of one molecule in 2D domain. (c) The ﬁrst exit model
of on molecule in 2D square domain.

Assume a 1D domain of length Lθ, two molecules V
and W diﬀuse freely with the rate Dv and Dw respec-
tively. The 1D diﬀusion model of two molecules is equiv-
alent to the 2D model in which one molecule diﬀuses
freely with diﬀusion rates Dv and Dw in the two direc-
tions, independently. The ﬁrst time for the two molecules
to collide in the same position is equivalent to the ﬁst
time when the molecule in the 2D domain comes across
the diagonal line. With the reﬂective boundary condi-
tion, the triangle domain divided by the diagonal line
can be extended into a square domain with the length
L = √2Lθ. The ﬁrst encounter time of two molecules on
the 1D domain of size Lθ is now converted to a ﬁrst exit
time of on molecule on a 2D domain of size L = √2Lθ.
In the following, we derive the formula for the ﬁrst exit
time on the 2D domain. For simplicity, we assume the
diﬀusion rate in the two directions are the same D =
Dv = Dw. The Plank-Fokker equation for the diﬀusion
in the 2D domain is given by

∂
∂t

P (x, t|x0, t0) = D(cid:16) ∂2

∂x2 +

∂2

∂y2(cid:17)P (x, t|x0, t0),

(B2)

with P (x, t|x0, t0) being the state density function, de-
ﬁned as the probability density that the molecule stays
in position x at time t given it starts from x0 at time t0.

G(x0, t; Ω) ≡Z L
0 Z L

0

dxdyP (x, t|x0, t0),

(B3)

which describes the probability that the molecule stays
in the domain Ω = (0, L) × (0, L) at time t, given it
starts from x0 at time t = 0. Then, we integrate the
Plank-Fokker equation (B2) over the 2D interval Ω and
we have the equation for G:

∂
∂t

G(x0, t; a, b) = D(cid:16) ∂2

∂x2 +

∂2

∂y2(cid:17)G(x0, t; a, b).

The initial condition for the PDE (B4) is given as

(B4)

G(x0, 0; Ω) = 1.

(B5)

The four boundaries of the square domain Ω are all ab-
sorbing. Hence, we have the boundary conditions for
PDE (B4) as

G((0, y), t; Ω) = 0;
G((x, 0), t; Ω) = 0;

G((L, y), t; Ω) = 0;
G((x, L), t; Ω) = 0;

(B6)

Following the deﬁnition of G(x0, t; Ω) (B3), 1 −
G(x0, t; Ω) gives the probability that the molecule exits
Ω before time t, which is exactly the distribution function
of the ﬁrst exit time T (x0; Ω). In addition, the density
function of T (x0; Ω) is given by

p(t, x0; Ω) =

∂
∂t

[1−G(x0, t; Ω)] = −

∂
∂t

G(x0, t; Ω), (B7)

And the n-th moment Tn(x0; Ω) of the random variable
T (x0; Ω) is therefore given by

∂
∂t

0

G(x0, t; Ω)idt, (n ≥ 0). (B8)

tnh −

For n = 0, the formula gives

Tn(x0; Ω) =Z ∞
T0(x0; Ω) = −(cid:0)G(x0,∞; Ω) − G(x0, 0; Ω)(cid:1) = 1.
Z ∞

Integrating (B8) by parts, we get the formula

tn−1G(x0, t; Ω)dt =

(B10)
With equation (B7) and (B10) we can formulate the mo-
ments of Tn(x0; Ω) as coupled ordinary diﬀerential equa-
tions. Multiply the Plank-Fokker equation (B2) through
by tn−1, integrating the result over all t and substitute
from equation (B7) and (B10), we have the equation

(n ≥ 1).

Tn(x0; Ω)

(B9)

0

1
n

− Tn−1(x0, Ω) = D(cid:16) ∂2

∂x0

2 +

∂2
∂y0

2(cid:17)(

1
n

Tn(x0; Ω)). (B11)

The boundary conditions for these diﬀerential equations
follows the simple derivation from (B6) and we have

Tn((0, y), t; Ω) = 0;
Tn((x, 0), t; Ω) = 0;

Tn((L, y), t; Ω) = 0;
Tn((x, L), t; Ω) = 0;

(B12)

With the equations ready, we can solve for the mo-
ments of the ﬁrst passage time. Here we are only inter-
ested in the ﬁrst moment and the solution to the PDE of
the ﬁrst moment equation yields

T1(x, y) =

4L2
Dπ3

2D −

x(L − x)

∞Xk=1,oddn sin(kπx/L)
×(cid:0) sinh(kπy/L) + sinh(kπ(L − y)/L)(cid:1)o(B13)

k3 sinh(kπ)

If initially the molecule is homogeneously presented in
the square domain, we can calculate the mean ﬁrst exit
time as

< T1 > =

=

1

L2Z l
0 Z 1

L2
12D −

D

0
16L2

≈ 0.0351

L2
D

T1(x, y)dxdy

∞Xk=1,odd

cosh(kπ) − 1
π5k5 sinh(kπ)

(B14)

Therefore, the mean ﬁrst time when the ﬁrst two
molecules encounter in the 1D domain of size Lθ is ex-

12

actly the same as the mean ﬁrst exit time above and the
mean ﬁrst encounter time is given by

< Tcoll >≈ 0.0702

(Lθ)2

D

.

(B15)

Figure 9 and Figure 10 show the numerical results of
the mean ﬁrst collision time for two molecules with the
same diﬀusion rates and for the general situations. The
linear data ﬁtting shows the excellent match with the for-
mula (B15). Furthermore, although our derivation is only
for the case Dv = Dw, the numerical results show that
the ﬁrst collision time for the general situation, where
Dv 6= Dw, follows the similar formula. This formula is
given as

< Tcoll >≈ 0.140

(L)2

Dv + Dw

.

(B16)

For comparison purpose, Figure 11 gives the numeri-
cal results of the mean ﬁrst collision time, under periodic
boundary condition, for two molecules with diﬀerent dif-
fusion rates Dv 6= Dw. We can see that the numerical
results match with (26) very well.

13

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
m

i
t
 
r
e
t
n
u
o
c
n
e
 
t
s
r
i
f
 
n
a
e
m

 

0
0

experiments
data fit y = 0.072x−0.005

 

2

4

L2/D

6

8

10

FIG. 9: The mean ﬁrst collision time of two molecules in the
1D domain with reﬂective boundary condition, while the two
molecules have the same diﬀusion rate D = Dv = Dw. Other
parameters are N = 64 and L = 0.1.

0.25

0.2

0.15

e
m

i
t
 
r
e

t

n
u
o
c
n
e

 
t
s
r
i
f
 

n
a
e
m

0.1

 

0.5

experiments
data fit y = 0.144x−0.0016

1

L2/(Dv+Dw)

1.5

 

2

FIG. 10: The mean ﬁrst collision time of two molecules in
the 1D domain with reﬂective boundary condition, while the
two molecules have diﬀerent diﬀusion rates Dv 6= Dw. Other
Parameters are N = 64 and L = 0.1.

0.2

0.15

0.1

0.05

 

0
0

experiments
data fit y = x/12

 

0.5

1

1.5

2

FIG. 11: The mean ﬁrst collision time of two molecules in
the 1D domain with periodic boundary condition, while the
two molecules have diﬀerent diﬀusion rates Dv 6= Dw. Other
Parameters are N = 128 and L = 0.1.

