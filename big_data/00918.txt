March 4, 2016

Prepared for submission to JCAP

Combining cluster number counts
and galaxy clustering

Fabien Lacasa,a Rogerio Rosenfelda
aICTP South American Institute for Fundamental Research
Instituto de Física Teórica, Universidade Estadual Paulista, São Paulo, Brazil
E-mail: fabien@ift.unesp.br, rosenfel@ift.unesp.br

Abstract. We present a detailed modelling of the joint covariance matrix between cluster
number counts and the galaxy angular power spectrum. To this end, we use a Halo Model
framework complemented by a Halo Occupation Distribution model (HOD), and we work
in full-sky. We demonstrate the importance of accounting for non-Gaussianity to produce
accurate covariance predictions, as the Gaussian part of the covariance can in fact become
subdominant in certain conﬁgurations. We discuss in particular the case of the super-sample
covariance (SSC), including the eﬀects of galaxy shot-noise, halo second order bias and non-
local bias, and demonstrating interesting mathematical properties. Using the joint covariance
matrix and a Fisher matrix methodology, we examine the prospects of combining these two
probes to constrain cosmological and HOD parameters. We ﬁnd that the combination indeed
results in noticeable better constraints, in particular because the cross-covariance introduces
a synergy between the probes on small scales. We conclude that accounting for all non-
Gaussian eﬀects is important to best extract information from galaxy surveys with these two
observables.

6
1
0
2

 
r
a

M
2

 

 
 
]

.

O
C
h
p
-
o
r
t
s
a
[
 
 

1
v
8
1
9
0
0

.

3
0
6
1
:
v
i
X
r
a

Contents

1 Introduction

2 Notations, inputs and conventions

3 Cluster number counts and its covariance

4 Galaxy angular power spectrum

5 Cross-covariance between cluster counts and galaxy power spectrum

6 Super-sample covariance

7 Covariance of the galaxy angular power spectrum

8 Joint covariance and consequences for parameter constraints

8.1 Joint covariance
8.2 Fisher matrix constraints on cosmological parameters
8.3 Fisher constraints on HOD parameters

9 Conclusion

A 3D halo-galaxy-galaxy bispectrum in the Halo Model

B From the 3D hgg bispectrum to the cross-covariance

B.1 Angle-independent bispectrum
B.2 Angle dependent bispectrum

C SSC inequalities

D Multipole binning

1

Introduction

1

3

5

8

11

15

17

19
19
22
24

25

26

29
30
32

35

37

The unexpected discovery of the cosmic acceleration at the end of last century motivated the
introduction of the so-called dark energy which turned out to be the dominant component of
today’s Universe. The simplest model for dark energy is that of a cosmological constant Λ.
A concordance ΛCDM model including also cold dark matter in addition to baryons has so
far passed all observational tests [1]. However, there are a few conceptual problems with the
cosmological constant, such as the explanation of its smallness in the context of a quantum
ﬁeld theory, that motivates the search for deviations from this simple picture.

The large scale distribution of matter in the Universe is sensitive to the presence and
speciﬁc properties of dark energy (for a review see, e.g., [2]). One of the purposes of large
galaxy surveys, such as the Dark Energy Survey (DES1), is to provide data which can be
used to infer the best model that describes our Universe. These surveys will use diﬀerent

1http://www.darkenergysurvey.org

– 1 –

observational probes to test the nature of dark energy, such as weak gravitational lensing,
correlations in the distribution of galaxies, statistics of galaxy clusters, and type Ia supernovae.
These observables have diﬀerent sensitivities to cosmological parameters and in principle
are not independent. Combining them can help to break some degeneracies present when only
single probes are used. In order to estimate the cosmological parameters and the correspond-
ing accuracy of the estimation from the data obtained in these large surveys it is necessary to
have a careful understanding of the statistical properties of the probes used, including their
cross-covariance.

In this work we will be interested in the combination of two probes, namely the galaxy
2-point correlation function and the number counts of clusters of galaxies. In particular, we
will focus on the impact of including the cross-covariance between these two observables in
the statistical analysis.

Cluster counts can be used to test cosmological models [3–5] since diﬀerent dark energy
models can aﬀect the formation of dark matter haloes [6, 7]. Likewise, measurements of the
angular correlation function can be used to estimate cosmological parameters (for a recent
example using the SDSS-III DR8 photometric luminous galaxies see [8]).

Cluster counts and galaxy-galaxy correlations probe the same density ﬁeld, albeit at
diﬀerent scales. Density ﬂuctuations are thought to be created by quantum ﬂuctuations in
the inﬂationary phase of the Universe and are nearly gaussian. The linear growth of these
perturbations maintain their gaussian character. However, the scales we are interested in
today are mostly in the nonlinear regime, where non-gaussian contributions are important.
In this case the diﬀerent Fourier modes of the density perturbations are no longer independent,
leading to correlations that must be taken into account.

In order to determine the statistical power of combining cluster counts and 2-point
galaxy correlation functions (or the power spectrum in Fourier space), we need to model
the covariance of these observables as well as the cross-covariance between them. We will
do so in the context of the halo model framework to describe the nonlinear density ﬁeld
(see, e.g., [9]). The auto-covariance of cluster counts and of the 2-point galaxy correlation
function are described by 2-point and 4-point correlation functions of the matter distribution
respectively, whereas the cross-covariance is related to a 3-point correlation function. The
necessary ingredients for the modelling are the halo mass function, the halo density proﬁle
and a model to describe how galaxies populate dark matter halos. We will use the so-called
Tinker mas function [10], the Navarro-Frenk-White (NFW) density proﬁle [11] and a halo
occupation distribution (HOD) model [12, 13].

The power spectrum covariance was modelled in the context of the halo model by Cooray
and Hu [14], where a comparison was made with simulations. The full covariance between
cluster counts and cosmic shear power spectrum was studied by Takada and Bridle [15]. The
importance of the so-called super-sample covariance involving long wavelength modes outside
the volume of the survey was discussed by Takada and Hu [16]. A joint likelihood analysis
involving cluster counts and n-point correlation functions in 3 dimensions was developed in
[17] and very recently a framework to extract cosmological constraints using a joint covariance
involving several observational probes for photometric surveys in the ﬂat sky approximation
was implemented in [18].

Here we will develop a uniﬁed framework to treat cluster number counts and the galaxy-
galaxy correlation function applied to large galaxy surveys with photometric redshifts, such
as DES, that can be used to perform this analysis in data, either simulated or real, in the
near future. We pay particular attention to the nonlinear eﬀects at small scales and to a

– 2 –

careful modelling of the cross-covariance. In the case of photometric surveys one typically
divides up the survey into redshift bins and study correlation functions projected into these
bins. Therefore we will have to deal with angular correlation functions or angular power
spectra, which we will model in full sky. This work is a ﬁrst step towards this goal, with
several simplifying assumptions made along the way that can be lifted in a more realistic
study. Within this framework we estimate the relevance of accounting for the cross-covariance
between cluster counts and the galaxy power spectrum using a Fisher matrix approach.

Our goal can be easily stated as follows. We will consider grouping the data from cluster

counts and angular power spectrum into a single data vector X:

(cid:18) Ncl

(cid:19)

Cgal

(cid:96)

X =

(1.1)

(1.2)

where Ncl is the number of clusters in a given mass and redshift bin and Cgal
is the angular
power spectrum of galaxies in a given redshift bin (we will also bin in multipoles (cid:96), see e.g.
appendix D). We are ommiting for the moment the dependence on mass and redshift bins.
We want to model the full covariance matrix

(cid:96)

(cid:32)

(cid:33)

Cov( ˆX, ˆX) =

Cov( ˆNcl, ˆNcl) Cov( ˆCgal
(cid:96)
) Cov( ˆCgal
Cov( ˆNcl, ˆCgal

, ˆNcl)
, ˆCgal
)

(cid:96)

(cid:96)

(cid:96)

This covariance matrix will be used to study the statistical power of these observables in
estimating parameters. The main focus is to investigate the eﬀect of including the cross-
covariance represented by the oﬀ-diagonal terms in the covariance matrix eq. (1.2), particu-
larly at small scales, which will be estimated using a Fisher matrix approach.

The cross-covariance is related to a bispectrum involving a halo-galaxy-galaxy correlator.
This bispectrum is modelled in detail, with the estimation of six terms arising from the halo
model and HOD. In particular we include the eﬀects of second order bias as well as nonlocal
bias and shot noise. We are able to show explicitly how the super-sample covariance appears
naturally in the bispectrum, in a framework that incorporates it in a systematic way.

This paper is organized as follows. In the next section we set the notations and conven-
tions that will be used throughout the paper. In section 3 we describe the cluster number
counts and its covariance. Next we model the galaxy angular power spectrum. In section 5
we describe the modelling of the cross-covariance between cluster counts and galaxy angular
power spectrum. In section 6 we propose a uniﬁed framework to treat the super-sample co-
variance among diﬀerent probes. In section 7 we discuss the covariance of the galaxy angular
power spectrum. In section 8 we perform a Fisher matrix analysis to determine the impact
of including the cross covariance in the estimation of parameters, binning the sample in two
ways appropriate to test cosmological and HOD parameters . Finally, we conclude in section
9. Several appendices are presented with details of the computations and proofs of assertions
from the main text.

2 Notations, inputs and conventions

As stated in the Introduction, we will base our analysis on the halo model framework. In this
framework, all galaxies are located in halos and one can write the number density of halos as:

nh(x) =

δ3(x − xi)

(2.1)

(cid:88)

i

– 3 –

where the index i denotes halos, with center located at xi and mass Mi.

In particular the halo mass function, giving the comoving number density of halos per

unit mass is given by the ensemble average [9]:

where

dnh
dM

Ncl(x|M, z) =

= (cid:104)Ncl(x|M, z)(cid:105) ,

(cid:88)

i

δ3(x − xi)δ(M − Mi).

(2.2)

(2.3)

Galaxies inhabit the dark matter halos and their number density can thus be written as:

(cid:88)

Ngal(i)(cid:88)

i

j=1

ngal(x) =

δ3(x − xj),

(2.4)

where the index j refers to galaxies in a given halo i with Ngal(i) galaxies. We further assume
that within a halo, the galaxies are distributed independently following the normalized halo
density proﬁle

(2.5)

(2.6)

(2.8)

u(x − xi|Mi) =

ρ(x − xi|Mi).

1
Mi

We will adopt the spherically symmetric NFW proﬁle [11]

u(r|Mi) =

1
M

ρs

r/rs(1 + r/rs)2 ,

with rs the scale radius and ρs is the scale density. They are speciﬁed as in, e.g. [19, 20].
The normalization enforces in particular that the Fourier transform u(k|M, z) obeys

u(k|M, z) → 1 when k → 0.

(2.7)

For the mass function, we use the one from Tinker et al. [10], which is a ﬁt to the
number density of halos obtained from simulations in cold dark matter scenarios. The halo
bias relating ﬂuctuations in the halo density ﬁeld δh and those of the dark matter ﬁeld δm
are parametrized via the local bias ansatz:

(cid:88)

bi(M, z)(cid:0)δi

m −(cid:10)δi

m

(cid:11)(cid:1) ,

δh =

i

where (cid:104)δh(cid:105) = 0 by construction and the biases are consistently related to the chosen mass
function. We will use both the ﬁrst [21] and second order bias [22] in this work, neglecting
higher order terms.

Galaxies are introduced using a HOD model which speciﬁes how galaxies populate halos.
In this model, the probability distribution of galaxies is a function of the halo mass only and
is composed of two populations: a central galaxy drawn from a binomial distribution, and
satellite galaxies drawn from a Poisson distribution conditioned to the presence of a central
galaxy (we will not consider the issue of sample selection here). More speciﬁcally, one writes
the average number of galaxies in a halo as

(cid:104)Ng(cid:105) = (cid:104)Ncen(cid:105) + (cid:104)Nsat(cid:105)

(2.9)

– 4 –

and we will adopt [23–25]

(cid:104)Ncen(cid:105) =

1
2

(cid:20)

(cid:20)

1 + erf

(cid:18) log M − log Mmin
(cid:19)(cid:21)
(cid:19)(cid:21)(cid:18) M

(cid:18) log M − log 2Mmin

σlog M

σlog M

Msat

(cid:19)αsat

(2.10)

(2.11)

and

(cid:104)Nsat(cid:105) =

1
2

1 + erf

This parametrization has 4 parameters: a mass threshold above which a halo has a large
probability of containing a central galaxy (Mmin), the width of the transition of the central
probability (σlog M), the typical mass above which a halo contains satellite galaxies (Msat)
and the index of the power law for the number of satellites at large halo masses (αsat).

Finally, we use the following mathematical notations. Estimators of a given quantity
are noted with an overhat, and overbar denote the corresponding average. We also use the
comoving volume per solid angle, deﬁned as

dV = r2(z)

dr
dz

dz,

(2.12)

as integration element for simplicity, with r(z) being the comoving distance.
We may also denote only with indices the multiplication of some quantities, e.g.:

(cid:12)(cid:12)(cid:12)(cid:12)z1

(cid:12)(cid:12)(cid:12)(cid:12)z2

dV12 = dV1 dV2 = r2(z1)

dr
dz

r2(z2)

dr
dz

dz1 dz2.

(2.13)

Otherwise stated, we will adopt a ﬂat ΛCDM model with the cosmological parameters
Ωbh2 = 0.022, Ωcdmh2 = 0.12, h = 0.67, ns = 0.962, σ8 = 0.834 and use the parametrization
of Eisenstein and Hu [26] to generate the linear matter power spectrum. For HOD parameters
we use αsat = 1.3, Mmin = 1012.2M(cid:12) and Msat = 1013.2M(cid:12) and σlog M = 0.2 [24].

3 Cluster number counts and its covariance

Cluster number counts is an important cosmological observable that is sensitive to both
the background evolution as well as the growth of perturbations. Cluster counts are also
independent of the cluster density proﬁle and HOD modelling, depending exclusively on the
cluster mass function.

The estimator of the binned cluster number counts per unit of solid angle is simply the
number of clusters in a given mass and redshift bin divided by the survey area, which we take
to be the full sky from now, ΩS = 4π. It can be written as:

ˆNcl(iM , iz) =

1
4π

d2ˆn dM dz

δ(M − Mj) δ2(ˆn − ˆnj) δ(z − zj),

(3.1)

(cid:90)

(cid:88)

j

where the mass and redshift integrals run over the bins deﬁned by iM and iz and the index
j runs over all halos in the universe with mass Mj and centered at (cid:126)xj = r(zj)ˆnj. We assume
that all clusters can be detected without fake detections and that both their mass and redshift
can be measured perfectly. The eﬀects of the spread in the mass-observable relation for the
cluster mass, the purity and completeness of the cluster catalogue and of the photometric
redshift errors will be considered in future works.

– 5 –

Eq. (3.1) can be rewritten as:

ˆNcl(iM , iz) =

d2ˆn dM dV Ncl(x = rˆn|M, z)

and hence the average of the cluster number count is given by

1
4π

(cid:90)
(cid:68) ˆNcl(iM , iz)

(cid:69)

(cid:90)

¯Ncl(iM , iz) =

=

dM dV

dnh
dM

(3.2)

(3.3)

where the mass and redshift integrals implicitly run over the corresponding bins. The resulting
cluster counts are shown in ﬁgure 1.

Figure 1. Cluster number counts in ﬁve representative redshift bins. The mass bins have width
∆ log M = 0.5 and the points are drawn at the start of the mass bin.

Eq. (3.2) can be rewritten in harmonic space as

ˆNcl(iM , iz) =

(cid:90) d3k
(cid:90) d3k
(2π)3 d2ˆn dM dV Ncl(k|M, z) eik·x
(2π)3 dM dV j0(kr)Ncl(k|M, z)

1
4π

=

(cid:96)m i(cid:96)j(cid:96)(kr) Y ∗
integral over the sphere leaves only the monopole ((cid:96) = 0) contribution.
From eq. (3.5), the covariance of cluster number counts is given by

where we used the plane wave expansion eik·x = 4π(cid:80)
(cid:16) ˆNcl(iM , iz), ˆNcl(jM , jz)

(cid:90) d3k

(2π)3 dM12 dV12 j0(kr1) j0(kr2)

dnh
dM

Cov

(cid:17)

=

(cid:96)m(ˆk) Y(cid:96)m(ˆn) , and the

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

(cid:12)(cid:12)(cid:12)(cid:12)M2,z2

dnh
dM

Pcl(k|M12, z12)

(3.4)

(3.5)

– 6 –

where the cluster power spectrum

Pcl(k|M12, z12) = (2π)3δ3(k1 − k2)(cid:104)δh(k1|M1, z1)δh(k2|M2, z2)(cid:105)

(3.6)

has contributions from the 1- and 2-halo terms and we have introduced the halo density
contrast δh such that

δh(k|M, z).

(3.7)

The 1-halo term contribution is diagonal in the mass and redshift bins and is inversely

proportional to the survey area. It’s contribution to the covariance is given by:

Ncl(k|M, z) =

(cid:12)(cid:12)(cid:12)(cid:12)M,z
(cid:17)
(cid:16) ˆNcl(iM , iz), ˆNcl(jM , jz)

dnh
dM

Cov1h

The 2-halo contribution to the number counts covariance can be written as:

and it represents a Poissonian shot-noise error.

(cid:17)
(cid:16) ˆNcl(iM , iz), ˆNcl(jM , jz)

=

(cid:90)

Cov2h

b1(M1, z1) b1(M2, z2)

= δiM ,jM δiz,jz

¯Ncl(iM , iz)

4π

,

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

(cid:12)(cid:12)(cid:12)(cid:12)M2,z2

dM12 dV12

dnh
dM

dnh
dM

(cid:90) d3k
(2π)3 j0(kr1) j0(kr2) Plin(k|z12)

×

(3.8)

(3.9)

(3.10)

(3.11)

where Plin(k|z12) is the linear matter power spectrum and we have assumed that halos are
linearly biased with respect to matter.

Cov2h

with

and

This equation can be rewritten as:

(cid:16) ˆNcl(iM , iz), ˆNcl(jM , jz)
(cid:17)

=

dV12

(iM , z1)

∂nh
∂δb

∂nh
∂δb

(cid:90)
(cid:90)
(cid:90) d3k
(2π)3 j0(kr1) j0(kr2) Plin(k|z12).

M∈bin(iM )

b1(M, z),

dnh
dM

dM

(iM , z) ≡

∂nh
∂δb

proj(z1, z2) ≡
σ2

(jM , z2) σ2

proj(z1, z2)

The signiﬁcance of this form of writing the result and its relation to sample variance will
become clear in the discussion presented in section 6.

This 2-halo contribution is oﬀ-diagonal:

it couples diﬀerent mass bins and diﬀerent
redshift bins. Figure 2 shows the normalised cluster counts covariance, in absolute value,
obtained with the following set up: three mass bins of width ∆ log M = 0.5 between 1014M(cid:12)
and 1015.5M(cid:12) and nine redshift bins of width ∆z = 0.1 between z = 0.1 and 1. We plotted
the absolute value of the covariance for clarity, as the cross-covariance between neighbouring
redshift bins is negative due to the behaviour of σ2
proj(z1, z2) (shown in ﬁgure 6 of section
6). The covariance shows signiﬁcant correlation between the two lowest mass bins, and the
oﬀ-diagonality increases at lower redshift, to the left, as expected from the larger nonlinear
eﬀects.

– 7 –

(cid:90)

(cid:90)

(cid:90)

ngal(z) =

dV dM

(cid:104)Ng(cid:105),

dnh
dM

iz

(4.1)

(4.2)

(4.3)

Figure 2. Cluster number counts covariance for 3 mass bins and 9 redshift bins. See text for details.

4 Galaxy angular power spectrum

The projected galaxy density contrast2 in the direction ˆn in a redshift bin iz, δgal(ˆn, iz) is:

δgal(ˆn, iz) =

dV

ngal(z)

∆Ngal(iz)

δgal(x = rˆn, z)

iz

where we denote as ngal(z) the 3D average galaxy density at redshift z modelled by

and where the number of galaxies per steradian in the redshift bin iz is given by

∆Ngal(iz) =

dV ngal(z).

iz

2Note that we normalise the contrast by the theoretical average ngal not by the empirical average over the
survey. This is formally equivalent to using the power spectrum of the empirical absolute diﬀerence ngal − ngal
(up to an unimportant monopole) and normalising it for practical purposes by the model average ngal. We
note that normalising by the empirical average yields an ill-deﬁned statistical quantity, as a ratio of estimators,
and leave this question for future works.

– 8 –

After spherical harmonic decomposition, the harmonic coeﬃcients are:

(cid:90)
(cid:90)

agal
(cid:96)m(iz) =

=

d2ˆn δgal(ˆn, iz) Y ∗

(cid:96)m(ˆn)

(cid:90)

dV

(cid:90)

ngal(z)

∆Ngal(iz)
ngal(z)

= i(cid:96)

dV

∆Ngal(iz)

The galaxy power spectrum estimator is then:

ˆCgal

(cid:96)

(iz, jz) =

agal
(cid:96)m(iz)

agal
(cid:96)m(jz)

(cid:88)

m

2(cid:96) + 1

1

(cid:90)

= 4π

dV12

(cid:96)m(ˆn)

d3k

d2ˆn

(cid:90) d3k
(2π)3 δgal(k, z) eik·rˆn Y ∗
2π2 j(cid:96)(kr) δgal(k, z) Y ∗
(cid:96)m(ˆk)
(cid:16)

(cid:17)∗

(cid:90) d3k12

ngal(z1) ngal(z2)

∆Ngal(iz) ∆Ngal(jz)

× P(cid:96)(ˆk1 · ˆk2) δgal(k1, z1) δ∗

gal(k2, z2)

(2π)6 j(cid:96)(k1r1) j(cid:96)(k2r2)

It’s average is

¯Cgal

(cid:96)

(iz, jz) = 4π

(cid:90)
(cid:90)

dV12

dV12

ngal(z1) ngal(z2)

∆Ngal(iz) ∆Ngal(jz)

ngal(z1) ngal(z2)

∆Ngal(iz) ∆Ngal(jz)

(cid:90)

dV ngal(z)2 Pgal(k(cid:96)|z)

2
π

=

(cid:39)

δiz,jz

∆Ngal(iz)2

(cid:90) d3k
(cid:90)
(2π)3 j(cid:96)(kr1) j(cid:96)(kr2) Pgal(k|z12)
k2 dk j(cid:96)(kr1) j(cid:96)(kr2) Pgal(k|z12)

where in the last step we have used Limber’s approximation, taking the power spectrum at
the maximum of the Bessel functions, k(cid:96) = (cid:96)+1/2
r(z) , and performing the integration of the
Bessel functions that yields a Dirac delta function in redshift (for more details on the Limber
approximation for polyspectra at any order, see appendix E of [29]). The 3-d galaxy power
spectrum is deﬁned in the usual manner

Pgal(k|z12) = (2π)3δ3(k − k(cid:48))(cid:104)δgal(k, z1) δ∗

gal(k(cid:48), z2)(cid:105).

(4.11)

We can use the Halo Model to write the galaxy power spectrum as a sum of a 2-halo, a

1-halo and a shot-noise term:

Pgal(k|z12) = P 2h

gal(k|z12) + P shot

gal (k|z12)

with

gal(k|z12) + P 1h
(cid:90)

1

(k, z1) bgal,eﬀ

(k, z2) PDM(k|z12)
dnh
dM

dM

(cid:104)Ngal(Ngal − 1)(M )(cid:105) u(k|M, z1)2

1

gal(k|z12) = bgal,eﬀ
P 2h
gal(k|z12) =
δz1,z2
P 1h
gal (k|z12) =
P shot

ngal(z1)2
δz1,z2
ngal(z1)

(cid:90)

where bgal,eﬀ

1

is the (ﬁrst-order) eﬀective galaxy bias:

bgal,eﬀ
1

(k, z) =

dM

dnh
dM

(cid:104)Ngal(M )(cid:105)
ngal(z)

u(k|M ) b1(M, z).

(4.4)

(4.5)

(4.6)

(4.7)

(4.8)

(4.9)

(4.10)

(4.12)

(4.13)

(4.14)

(4.15)

(4.16)

(cid:12)(cid:12)(cid:12)(cid:12)M,z

– 9 –

Note that on large scales, u(k|M ) → 1 and the eﬀective bias goes to a constant, the usual
galaxy bias: bgal

(cid:104)Ngal(M )(cid:105)

b1(M, z).

1 (z) =(cid:82) dM dnh

dM

ngal(z)

The resulting galaxy power spectrum and its diﬀerent terms are shown in ﬁgure 3. The
shot-noise term reaches at best 8% of the total spectrum on these scales. On the other hand,
the 1-halo term becomes fairly important at low redshift, dominating at the (relatively) small
scales, as expected.

Figure 3. Galaxy angular power spectrum and its diﬀerent terms on large scales (cid:96) = 30 − 300. Each
subplot represent a redshift bin of width ∆z = 0.1, starting at z = 0.1 − 0.2 at the upper left and
ending at z = 0.9 − 1 at the bottom right.

– 10 –

5 Cross-covariance between cluster counts and galaxy power spectrum

We now turn to the modelling of the cross-covariance between the number counts studied in
section 3 and the galaxy spectrum studied in section 4. It is indeed the main goal of this study
to estimate the impact of including this cross-covariance in the extraction of cosmological and
astrophysical parameters from large galaxy surveys.

Following eq. (3.5) and eq. (4.8), the covariance between the number counts and the

(jz, kz)

= 4π

× j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3) (cid:10)Ncl(k1|M1, z1) δgal(k2, z2) δ∗

(2π)9 dM1 dV123

P(cid:96)(ˆk2 · ˆk3)

ngal(z2) ngal(z3)

∆Ngal(jz)2

gal(k3, z3)(cid:11)

(5.1)

.

c

galaxy power spectrum estimators is:

(cid:16) ˆNcl(iM , iz), ˆCgal

(cid:96)

Cov

(cid:17)

(cid:90) d3k123

Therefore the cross covariance is related to a 3-point function involving one halo/cluster

and two galaxies, the so-called bispectrum deﬁned by:

(cid:104)δh(k1|M1, z1) δg(k2, z2) δg(k3, z3)(cid:105)c = (2π)3 δ3(k1 + k2 + k3) Bhgg(k123|M1, z123),

(5.2)

where we used the halo density contrast δh deﬁned in eq. (3.7).

As done for the galaxy power spectrum, we model this halo-galaxy-galaxy bispectrum
using the halo model coupled with a Halo Occupation Distribution. There are six terms
involved and they can be easily visualised with simple diagrams, as ﬁrst proposed by Lacasa
et al. [25], which are shown in ﬁgure 4.

The ﬁrst three diagrams (upper row) can couple number counts and galaxy spectrum
in diﬀerent redshift bins, and we will later identify with super-sample covariance. They are
described as:

a) the 3h term (upper left diagram) quantiﬁes how halo counts and the 2-halo part of the
galaxy spectrum ﬂuctuate together with large scale structure. It involves the halo bis-
pectrum, which has three contributions : the dark matter bispectrum from second order
perturbation theory (2PT term), second order halo bias (b2 term), and non-local halo bias
(s2 term).

b) the 2h-1h2g term (upper central diagram) quantiﬁes how halo counts and the 1-halo part

of the galaxy spectrum ﬂuctuate together with large scale structure.

c) the 2h-1h1g term (upper right diagram) quantiﬁes how halo counts and the shot-noise part

of the galaxy spectrum ﬂuctuate together with large scale structure.

The three diagrams in the bottom row contribute only when the number count and the

galaxy spectrum are in the same redshift bin and are described as:

d) the 2h-2h term (bottom left diagram) quantiﬁes how the halos in that bin of mass source

the 2-halo part of the galaxy power spectrum.

e) the 1h2g term (bottom central diagram) quantiﬁes how the halos in that bin of mass source

the 1-halo part of the galaxy power spectrum.

f) the 1h1g term (bottom right diagram) quantiﬁes how the halos in that bin of mass source

the shot-noise part of the galaxy power spectrum.

– 11 –

Figure 4. Diagrams for the halo-galaxy-galaxy bispectrum. From left to right and top to bottom :
3h, 2h-1h2g, 2h-1h1g, 2h-2h, 1h2g, 1h1g.

Therefore we can write:

Bhgg(k123, z123|M1, z123) = B3h + B2h−2h + B2h−1h2g + B2h−1h1g + B1h2g + B1h1g

(5.3)

with

B3h = B2P T + Bb2 + Bs2.

(5.4)

The expressions for each of these terms are given in appendix A.

With these notations, we show in appendix B that the cross covariance reduces in the

Limber approximation to

(cid:16) ˆNcl(iM , iz), C(cid:96)(jz, kz)

(cid:17)

=

Cov

(cid:90) dM1 dV12

∆Ngal(jz)2

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

dnh
dM

ngal(z2)2

δjz,kz
4π

(cid:90)

× 2
π

1dk1 Bhgg(k1, k(cid:96), k(cid:96)|M1, z122) j0(k1r1) j0(k1r2)
k2

(5.5)

– 12 –

abcdefand the diﬀerent cross covariance terms are:

(cid:96)

(cid:96)

(cid:96)

(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal
(cid:16) ˆNcl(iM , iz), ˆCgal

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(cid:96)

(jz)

(jz)

(jz)

(jz)

(jz)

(jz)

(jz)

=

=

=

4π

(cid:90)
(cid:90)

δiz,jz
4π
δiz,jz
4π

(cid:17) ≈ δiz,jz
(cid:17)
(cid:17)
(cid:17)
(cid:17)
(cid:17)
(cid:17)
(cid:17)

(cid:90)
(cid:90)

= 0

=

=

(jz)

=

Cov1h1g

Cov1h2g

Cov2h−2h

Cov2h−1h1g

Cov2h−1h2g

Covs2

Covb2

Cov2PT

(cid:90)
(cid:90)
(cid:90)

ngal(z1|iM )
∆Ngal(iz)2
ngal(z1)2 P 1h

gal(k(cid:96), z1|iM )

dV1

dV1

∆Ngal(iz)2
(k(cid:96), z1|iM ) bgal,eﬀ

1

1

dV1 2 bgal,eﬀ
× ngal(z1)2

∆Ngal(iz)2 PDM(k(cid:96), z1)

(5.6)

(5.7)

(5.8)

(k(cid:96), z1)

∂nh
∂δb

1
∂nh
∂δb

dV12

∆Ngal(jz)2

(iM , z1)

× ngal(z2) bgal,eﬀ
dV12

∆Ngal(jz)2

(iM , z1)
× ngal(z2) bgal,eﬀ−2

1

(z2) σ2

proj(z1, z2)

(5.9)

(k(cid:96), z2) σ2

proj(z1, z2)

(k(cid:96), z2) bgal,eﬀ

2

(k(cid:96), z2)

dV12

1

∆Ngal(jz)2 2 ngal(z2)2 bgal,eﬀ
(iM , z1) PDM(k(cid:96)|z2) σ2
dV12

× ∂nh
∂δb
∆Ngal(jz)2 4 Favg ngal(z2)2 bgal,eﬀ

1

proj(z1, z2)

× ∂nh
∂δb

(iM , z1) PDM(k(cid:96)|z2) σ2

proj(z1, z2),

(k(cid:96), z2)2

(5.10)

(5.11)

(5.12)

(5.13)

(5.14)

(5.15)

(5.16)

(5.17)

(5.18)

where we re-used notations of the previous sections, and introduced the following additional
short-hand notations (notice that some of the integrals are on a given mass bin) :

ngal(z|iM ) =

gal(k, z|iM ) =
P 1h

bgal,eﬀ
1,2

(k, z|iM ) =

bgal,eﬀ−2

1

(k, z) =

Favg =

(cid:90)

(cid:90)
(cid:90)
(cid:90)

1
n2
gal(z)
1

ngal(z)

1

ngal(z)
17
21

dM

M∈bin(iM )

dnh
dM

(cid:104)Ngal(M )(cid:105)

dM

M∈bin(iM )

dM

M∈bin(iM )
dnh
dM

dM

(cid:104)Ngal(Ngal − 1)(M )(cid:105) u2(k|M, z)

dnh
dM
dnh
dM
(cid:104)Ngal(Ngal − 1)(M )(cid:105) b1(M, z) u(k|M, z)2

(cid:104)Ngal(M )(cid:105) b1,2(M, z) u(k|M, z)

The resulting cross-covariance is shown in ﬁgure 5 as a function of multipole (cid:96), with
three plots for diﬀerent cases of mass bin and redshift bin. In these plots we take iz = jz for
simplicity and because this is where the cross-covariance is maximal.

We see from ﬁgure 5 that diﬀerent terms become important depending on scale, mass
and redshift. In particular HOD terms are far from negligible, being dominant in some cases,

– 13 –

Figure 5. Cross-covariance between cluster counts and the galaxy spectrum, depending on the
multipole of the spectrum. Top: low redshift low mass case, z ∈ [0.1, 0.2] log M ∈ [14, 14.5]. Center:
low redshift high mass case, z ∈ [0.1, 0.2] log M ∈ [15, 15.5]. Bottom: high redshift low mass case,
z ∈ [0.8, 0.9] log M ∈ [14, 14.5].

– 14 –

while the 2PT term can become negligible in some cases. We note that the 2PT term is the
only term that one would have considered from a model with only linear bias and perturbation
theory. We thus conclude that it is critical to use a fully non-linear model, such as the halo
model combined with HOD that we have been using here, in order to estimate accurately the
cross-covariance.

6 Super-sample covariance

We can unify the equations (5.9,5.10,5.12,5.13) for the 2h-1h1g, 2h-1h2g, b2 and 2PT terms
involvong the super-sample covariance, into a single equation:

(cid:17) ≡ Cov2h−1h1g + Cov2h−1h2g + Covb2 + Cov2PT
(cid:90)

∂Pgal(k(cid:96)|z2)

ngal(z2)2
∆Ngal(jz)2

∂nh
∂δb

(iM , z1)

=

dV12

(6.1)

σ2
proj(z1, z2)

(6.2)

∂δb

(cid:16) ˆNcl(iM , iz), ˆCgal

(cid:96)

(jz)

CovSSC

if we deﬁne

∂Pgal(k|z)

∂δb

≡ 4Favg

(cid:124)(cid:123)(cid:122)(cid:125)

= 68
21

bgal,eﬀ
1

(k, z)2 PDM(k|z) + bgal,eﬀ−2

1

(k, z)/ngal(z)

+ 2bgal,eﬀ

1

(k, z) bgal,eﬀ

2

(k, z) PDM(k|z) + bgal,eﬀ

1

(z)/ngal(z).

(6.3)

These terms correspond to the diagrams in the top row of ﬁgure 4 and represent how cluster
counts and the galaxy power spectrum ﬂuctuate together due to the large scale structure.

By analogy with previous literature results for the 3D matter power spectrum [16],
eq. (6.3) can be interpreted as the reaction of the galaxy power spectrum to a change of
background density and hence the notation ∂Pgal
, deﬁned in eq. (3.10)
∂δb
as the reaction of the cluster number counts to a change of background density.

. We also interpret ∂nh
∂δb

The ﬁrst two terms in eq. (6.3) correspond to the expression found in [16]. However,
in contrast to [16] we have here derived our equations without any Taylor expansion nor
approximation, except for Limber’s approximation. Furthermore, we have derived here the
contributions from second order bias (third term), galaxy shot-noise (fourth term), and we
have shown that non-local tidal eﬀects give a zero contribution (see appendix B for details).
In our framework, eq. (6.2) can be interpreted physically as the fact that both cluster counts
and the galaxy spectrum react to a change of background, so their covariance is related to
the covariance of the background density σ2

σ2
proj(z1, z2) =

(cid:90) d3k
proj(z1, z2). Indeed:
(2π)3 j0(kr1) j0(kr2) PDM(k|z12)
= (cid:104)δavg(z1) δavg(z2)(cid:105)c with δavg(z) =

(cid:90) d2ˆn

4π

δ(rˆn, z).

(6.4)

(6.5)

This source of covariance has been dubbed “super-sample covariance" in the literature,
as it gives a non-diagonal covariance due to modes larger than the survey. In our case the
survey is the whole sphere and the Bessel function j0 indicates that the contributing Fourier
modes are those associated with the monopole. Eq. (3.9) for the 2-halo term of the covariance

– 15 –

of cluster counts can also be interpreted as a super-sample covariance contribution, though it
is more often more simply called “sample variance" in the cluster literature.
As a generalisation, it is natural to expect that the covariance of two observables O1
and O2 will have a contribution of the form:

CovSSC (O1,O2) =

dV12

∂O1
∂δb

(z1)

∂O2
∂δb

(z2) σ2

proj(z1, z2)

(6.6)

(cid:90)

Our framework also extends the work of [16] (see their appendix A) since we ﬁnd that
the SSC covariance of projected observables involves an integral over two redshifts instead
of a single redshift. If we were able to use Limber’s approximation, then σ2
proj(z1, z2) would
collapse to a Dirac delta function of redshifts and we would indeed end up with a single
redshift integral. However, as is evident from ﬁgure 6, this covariance does have a redshift
width.

Figure 6. Covariance of the background density: σ2

proj(z1, z2) for diﬀerent redshifts.

Physically, this means that the background density of two neighbouring slices of the past
light cone are correlated. As the redshift separation increases, this correlation decreases with
oscillations, asymptoting to zero. This behaviour is the reason why neighbouring redshift
bins have some anti-correlation in ﬁgure 2. We note that this behaviour would be even more
important for ﬁner redshift bins, e.g.
for analysis of a spectroscopic or semi-spectroscopic
survey.

Finally in appendix C, we show that super-sample covariance obeys the following math-

ematical inequality:

CovSSC (O1,O2) ≤(cid:112)CovSSC (O1,O1) × CovSSC (O2,O2)

(6.7)

for any observables O1 and O2.

– 16 –

As an example, for number counts this implies

Cov2h (Ncl(iM , iz), Ncl(jM , jz)) ≤(cid:16)

Cov2h (Ncl(iM , iz), Ncl(iM , iz))
× Cov2h (Ncl(jM , jz), Ncl(jM , jz))

(cid:17)1/2

(6.8)

for any bins of redshifts and mass iz, jz, iM , jM.
In our case, we found inequality eq. (6.7) to be saturated by some terms of the joint covariance
matrix which will be described in section 8, and could even be sometimes violated at the
percent level due to numerical errors. As such, enforcing inequality eq. (6.7) a posteriori
would help to regularize the covariance matrix in cases where it was highly degenerate (low
redshifts, small angular scales).

More generally we show in appendix C that super-sample covariance is positive. That
is, even in the absence of the other covariance terms, the covariance matrix is certain to have
positive eigenvalues.

7 Covariance of the galaxy angular power spectrum

Let us recall the equation for the galaxy power spectrum estimator eq. (4.8):

(cid:90)

(cid:90) d3k12

ˆCgal

(cid:96)

(iz) = 4π

dV12

ngal(z1) ngal(z2)

∆Ngal(iz)2

(2π)6 j(cid:96)(k1r1) j(cid:96)(k2r2)

× P(cid:96)(ˆk1 · ˆk2) δgal(k1, z1) δ∗

gal(k2, z2)

Taking the covariance of this estimator will involve the quantity

gal(k2, z2) δgal(k3, z3) δ∗

gal(k4, z4)(cid:11)

The unconnected part of this average yields the usual Gaussian C(cid:96) covariance:

(cid:10)δgal(k1, z1) δ∗
(cid:16) ˆCgal

(cid:96)

Cov

(cid:17)

(iz), ˆCgal

(cid:96)(cid:48) (jz)

=

=

2 Cgal

(iz, jz)2

(cid:96)
2(cid:96) + 1
(iz)2

(cid:96)

2 Cgal

2(cid:96) + 1

δ(cid:96),(cid:96)(cid:48)

δ(cid:96),(cid:96)(cid:48) δiz,jz

(7.1)

(7.2)

(7.3)

(7.4)

where the second equality is a consequence of Limber’s approximation forcing iz = jz.
The connected part of eq. (7.2) is

(cid:10)δgal(k1, z1) δ∗

gal(k2, z2) δgal(k3, z3) δ∗

gal(k4, z4)(cid:11)

c

= (2π)3 δ(3)(k1 − k2 + k3 − k4)

× Tgal(k1,−k2, k3,−k4)

(7.5)

where Tgal is the galaxy 3D trispectrum. Such term yields in principle the power spectrum
covariance [30]

Cov

(iz), ˆCgal

(cid:96)(cid:48) (jz)

=

1
4π

(cid:96)(cid:96) ((cid:96)diag = 0|iz, jz)
T (cid:96)(cid:48)(cid:96)(cid:48)

(7.6)

(cid:16) ˆCgal

(cid:96)

(cid:17)

where T (cid:96)3(cid:96)4
(cid:96)1(cid:96)2
2 of [30] for details).

((cid:96)diag) is the 2D (projected) trispectrum (see the derivation of eq. (2.80) in chapter

– 17 –

The galaxy 3D trispectrum is a complicated beast with the contribution from many
terms: there are 14 diﬀerent diagrams, given e.g.
in ﬁgure 7 of [29], with non-trivial per-
mutations and some diagrams splitting into contributions from perturbation theory, both at
second and third order, from halo quadratic and cubic local bias as well as from non-local
bias eﬀects. A complete census of these terms is beyond the scope of this article and left
to a future work. Furthermore, there is no analytical solution known to the authors for the
2D projection of a 3D trispectrum with a general momentum dependence. This projection is
known to us only for the diagonal-independent case, i.e. Tgal depending only on the moduli
(k1, k2, k3, k4). In that case, the projection is given in appendix E of [29] and recast here for
convenience for the case of interest:

(cid:96)(cid:96) ((cid:96)diag|iz, jz) = δiz,jz
T (cid:96)(cid:48)(cid:96)(cid:48)

dV

ngal(z)4

∆Ngal(iz)4 Tgal(k(cid:96), k(cid:96), k(cid:96)(cid:48), k(cid:96)(cid:48)|z)

(7.7)

This is the case of the 1-halo term of the galaxy trispectrum, that is when the four points of
the correlation function hit four diﬀerent galaxies inside the same halo:

(cid:90)

(cid:90)

gal(k1, k2, k3, k4|z) =
T 1h

dnh
dM

(cid:104)N (N − 1)(N − 2)(N − 3)(cid:105) (M )

dM
× u(k1|M, z) u(k2|M, z) u(k3|M, z) u(k4|M, z).

n4

gal

(7.8)

We also found this to be the case of 1-halo shot-noise terms, that is when two or more points
of the correlation function hit the same galaxies, and all galaxies are in the same halo. How-
ever we found these shot-noise terms to be negligible in all our tests.

An important covariance contribution which does not ﬁt the previous criterion (diagonal-
independence) is the super-sample covariance (SSC) discussed in section 6. By analogy with
the SSC of the cross-covariance and following the discussion of section 6, we take:

(cid:16)

(cid:90)

(cid:17)

=

Cgal

(iz), Cgal

(cid:96)

CovSSC

(cid:96)(cid:48) (jz)

σ2
proj(z1, z2)
(7.9)
where all terms have been deﬁned previously. We leave a rigorous derivation of this equation
for a future work.

∆Ngal(iz)2 ∆Ngal(jz)2

dV12

∂δb

∂δb

ngal(z1)2 ngal(z2)2

∂Pgal(k(cid:96), z1)

∂Pgal(k(cid:96)(cid:48), z2)

In realistic data analysis, multipoles of the power spectrum are binned together. The
binning and its eﬀect on the covariance is discussed in detail in appendix D. This aspect is
√
critical to produce realistic covariance matrices.
Indeed, the Gaussian diagonal error bars
decrease as 1/
∆(cid:96) with binning, whereas other terms like, in particular SSC, decrease much
slower because of their large oﬀ-diagonal contribution.
Figure 7 shows the resulting correlation matrix (in absolute value) of the binned galaxy
spectrum on large scales (cid:96) = 30 − 300 with 9 bins of width ∆(cid:96) = 30 and 9 redshift bins
of width ∆z = 0.1 starting at z = 0.1. Small scales will also be considered in the next
section. We see that the covariance matrix of the galaxy spectrum is highly oﬀ-diagonal at
low redshift, and still has ∼ 10% oﬀ-diagonal elements in the highest redshift bin. Due to
super-sample covariance, there is also some negative covariance between the neighbouring
redshift bins at low redshift, which is plotted in absolute value in ﬁgure 7 and reaches ∼ 10%
for 0.1 < z < 0.3.

– 18 –

Figure 7. Covariance of the galaxy angular power spectrum for nine multipole bins and nine redshift
bins. Similar to ﬁgure 2 but for the galaxy spectrum instead of cluster counts. See text for details.

8 Joint covariance and consequences for parameter constraints

This section presents the main results of the paper, showing the outcome of our modelling
of the joint covariance of cluster counts and the galaxy angular power spectrum developed
in the previous sections. The diﬀerent contributions to the covariance matrix are analysed
and the dominance of non-gaussian eﬀects at low redshifts and small scales is emphasized.
A Fisher matrix study is used to evaluate the importance of combining these observables
in the determination of cosmological and HOD parameters using diﬀerent binnings in the
angular scale to reﬂect large scales (mostly sensitive to cosmological parameters) or small
scales (mostly sensitive to HOD parameters).

8.1 Joint covariance

As before, we consider nine redshift bins of width ∆z = 0.1 between zmin = 0.1 and zmax = 1,
and three logarithmic mass bins for the cluster counts of width ∆ log M = 0.5 between
Mmin = 1014M(cid:12) and Mmax = 1015.5M(cid:12).
The angular multipoles are binned in order to follow the more realistic procedure performed

– 19 –

on real data. The issue and the eﬀects of binning are explained in more details in Appendix
D. We consider two case studies for the binning scheme:

• a “cosmological” case focusing on large angular scales, with nine regular multipole bins

between (cid:96)min = 30 and (cid:96)max = 300 (9 bins of width ∆(cid:96) = 30);

• a “HOD” case focusing on smaller angular scales, with seven regular multipole bins

between (cid:96)min = 300 and (cid:96)max = 1000 (7 bins of width ∆(cid:96) = 100).

As implied by the names, the ﬁrst case is expected to be representative of a cosmological
constraint by focusing on linear scales, while the second is expected to be representative of a
constraint on the Halo Occupation Distribution parameters by focusing on small non-linear
scales. It is not, however, the purpose of this article to study rigorously the separation of the
linear and non-linear regimes. The inclusion of external priors and a detailed investigation of
a cosmological study are left for future work.

The joint correlation matrix of the galaxy power spectrum and the cluster counts can
be seen in ﬁgure 8, with the cosmological case on the left panel and the HOD case on the
right panel.

, Ncl) in nine redshift shells, in the cosmological case
Figure 8. Joint correlation matrix of (C gal
(left panel) and in the HOD case (right panel). The auto-covariance of C gal
is the upper left block
(respectively 9x9 in the cosmological case and 7x7 in the HOD case), the auto-covariance of Ncl is
the 3x3 bottom right block, and the cross-covariance is given in the rectangular blocks. See text for
details.

(cid:96)

(cid:96)

This ﬁgure is one of the main results of this article. One can clearly see the importance
of non-Gaussian oﬀ-diagonal terms at low redshift. As expected, their signiﬁcance decreases
at higher redshifts, as perturbations become smaller and linear theory becomes a better
approximation. Note however that even at redshift z = 0.9 − 1 and large angular scales (left
panel), the oﬀ-diagonal elements reach ≥ 20% in the cross-covariance, showing how important
it is to account for non-Gaussianity.

Furthermore, one sees that non-Gaussianity becomes dramatic at small angular scales
(right panel), to the point that it reaches total and irremediable domination at low redshift.

– 20 –

Properly accounting for these eﬀects is thus absolutely critical to analyse the small scale power
spectrum, as they saturate the information content of the galaxy power spectrum alone.

To make more evident the diﬀerent contributions to the covariance matrix arising from
standard terms (Gaussian for Cgal
and Poissonian for Ncl), super-sample covariance and other
non-Gaussian terms, we show in ﬁgure 9 their separate contributions in the cosmological (large
scales) case. We see that standard covariance terms only contribute to the diagonal of the
covariance matrix, as expected, and that they dominate at high redshift. As redshift decreases
and the universe gets more structured, their relative contribution decreases and they end up
being important only for Cgal

on the largest scales and for Ncl at the highest mass bin.

(cid:96)

(cid:96)

Figure 9. Separate contributions to the joint covariance matrix in the cosmological case: standard
terms (left panel), super-sample covariance (middle panel) and other non-Gaussian terms (right panel).
All matrix elements are normalised to the total variance, so that the sum of these three matrices gives
the left panel of Fig. 8.

Super-sample covariance gives a relatively smooth contribution across the elements of the
covariance matrix, being higher at low redshift though still reaching 10-20% at high redshift.
For the cross-covariance, it correlates the cluster counts at the lowest mass with all the galaxy
spectrum, though more importantly with the smallest scales.

The other non-Gaussian terms have a more complex behaviour, with strong dependence
on scale, redshift and mass. It is mostly negligible at high redshifts, especially in the auto-
covariances, but become very important ar small redshifts. It increases strongly with multipole
as the non-linear part of the galaxy spectrum becomes important. For the cross-covariance, it
correlates mostly the cluster counts at the highest masses with the galaxy spectrum on small
scales, even reaching large scales in the lowest redshifts.

One measure of the importance of the probes is the so-called signal-to-noise ratio (SNR).
The SNR of an observable O with covariance matrix C is computed through the standard
equation:

(SN R)2 = OT · C−1 · O.

(8.1)

Using our computed covariance matrices in the cosmological and HOD cases, we show in table
1 the SNR for each probe and the joint combination.

The two probes have comparable SNR, and as expected the combined analysis yields a
larger value, being even higher in the hypothetical independent case than in the case where
the cross-covariance is properly accounted for. In the next subsections we present a more
detailed analysis of this comparison.

– 21 –

case / probe(s)
cosmological

HOD

(cid:96)

Cgal
141.09
161.55

Ncl

162.18
171.63

joint
194.35
235.70

independent

214.96
237.61

Table 1. Signal-to-noise ratios of the diﬀerent probes and their combination, in the two case studies.

8.2 Fisher matrix constraints on cosmological parameters
In this subsection, we compare the strength of cosmological parameter constraints that can
be reached by using the galaxy angular power spectrum, the cluster number counts, and their
combination. We also consider the hypothetical case where the galaxy spectrum and the
number counts are independent, in order to isolate the particular eﬀect of properly including
their cross-covariance. We emphasize that these constraints are not meant to be completely
realistic, as we did not include a number of experimental eﬀects in the modelling developed
here (in particular photometric redshift errors, purity and completeness of cluster detections,
and scatter in the cluster mass determination). That said, the choices of redshift binning,
mass binning and mass range that we made are suﬃciently conservative to mitigate some
experimental errors, so that we expect the inclusion of experimental eﬀects to be a correction
to our results that will not change qualitatively our conclusions.
The strength of parameter constraints are evaluated by a standard Fisher matrix for-
malism. Speciﬁcally for a vectorized observable O and model parameters θi, the element (i, j)
of the Fisher matrix is given by:

(cid:18) ∂O

∂θi

(cid:19)T · C−1 · ∂O

∂θj

Fi,j =

(8.2)

(8.3)

and F −1 is the covariance matrix of the Gaussian likelihood of parameters.

In this article, the parameter of interest are both cosmological (σ8, Ωmh2, wDE) and
HOD parameters (αsat, Mmin, Msat), with ﬁxed σlog M = 0.2. For this subsection we are
concentrating on cosmological parameters by marginalising over HOD parameters without
priors.
In the framework of Fisher matrices, through properties of Gaussian multivariate
probabilities, this corresponds simply to extracting the appropriate block of the inverse Fisher
matrix. Given

(cid:32)

(cid:33)

F −1 =

c,c F −1
F −1
H,c F −1
F −1

c,H

H,H

where c stands for cosmology and H for HOD, F −1
parameters after HOD marginalisation. 3

c,c is the covariance matrix of cosmological

With this setup, ﬁgure 10 shows the constraint on cosmological parameters in the cos-
mological case explained in section 8.1 In this ﬁgure, the red lines give the Fisher ellipses
and 1-dimensional probability distribution function (pdf) for the constraints coming from the
galaxy power spectrum alone, the blue lines are for the constraints from the cluster number
counts alone, orange is for the joint analysis, and ﬁnally green corresponds to the hypothetical
case where the two probes were independent (i.e. setting the cross-covariance to zero).

3It turns out to be important to marginalise over HOD parameters, instead of ﬁxing them to their ﬁducial
values, as that can signiﬁcantly increase the cosmological error bars. An important example is σ8 for which
the error bars are increased by a factor larger than 6 with C gal
in the cosmological study case, due to its high
degeneracy with galaxy bias.

(cid:96)

– 22 –

Figure 10. 1-dimensional pdfs and 3σ 2-dimensional contours for cosmological parameter constraints
in the cosmological study case. Red lines give the constraints from C gal
, blue from Ncl, orange from
the joint analysis, green from the hypothetical independent case.

(cid:96)

Table 2 summarizes the marginalised error bars on each parameter that may be achieved

in each case.

observable/parameter

Cgal
(cid:96)
Ncl
joint

independent

σ8

Ωmh2

wDE
10.1 % 8.67 % 36.1 %
1.17 % 4.10 % 7.48 %
0.90 % 3.08 % 6.16 %
0.86 % 2.96 % 5.87 %

Table 2. 1σ marginalised error bars on cosmological parameters in the cosmological case study.

From ﬁgure 10 and table 2, one sees that constraints from the galaxy angular power
spectrum are weaker than cluster counts constraints for the case studied. We emphasize that
this is partly due to the choice of angular scales considered and that a study being able

– 23 –

to reliably push the cosmological analysis to smaller scales would ﬁnd better galaxy power
spectrum constraints. In our case though, the diﬀerence of constraints between the galaxy
spectrum and cluster counts is partly due to the small diﬀerence in SNR (see table 1), the
degeneracy with HOD parameters, and the higher sensitivity of cluster counts to cosmology.
In the case of σ8, for instance, the galaxy constraints are weakened by a factor larger than 6
due to the degeneracy with galaxy bias, while it is well-known that cluster abundances are
exceptionally sensitive to σ8.

Due to the higher sensitivity of cluster counts to cosmology as compared to the galaxy
angular power spectrum, the joint cosmological constraints are close to the cluster counts
constraints, as can be seen in ﬁgure 10. An improvement of 17-25% is still to be noted.
Additionally, we see that the joint constraints are slightly worse than in the hypothetical
independent case, so the inclusion of the cross-covariance slightly degrades the constraints.

8.3 Fisher constraints on HOD parameters

This subsection mirrors section 8.2, but focusing on HOD parameters instead of cosmological
ones. We follow the same Fisher equations, and HOD constraints are achieved after marginal-
isation over cosmology, which corresponds to extracting the block F −1
Contrary to section 8.2 however, number counts alone do not produce any parameter con-
straints, as by deﬁnition cluster counts do not depend on HOD. Number counts however help
in a combination with the galaxy angular power spectrum in two ways: ﬁrst they reduce
the error on cosmology, which helps when marginalising over it, and second they break the
degeneracy between the mass function and HOD parameters, by ﬁxing the former.

H,H in eq. (8.3).

Figure 11 shows the forecasted constraints on HOD parameters, in the HOD case study.
Red lines show the constraints from the galaxy power spectrum alone, green lines for the joint
analysis and blue corresponds to the hypothetical independent case.

A quantitative assessment of the constraints is given in table 3 which lists the marginalised

1σ error bars on each HOD parameter in the diﬀerent cases.

observable / parameter

Cgal
joint

(cid:96)

independent

log Mmin
αsat
7.20 % 0.52 %
1.49 % 0.20 %
2.14 % 0.23 %

log Msat
0.46 %
0.32 %
0.36 %

Table 3. 1σ marginalised error bars on HOD parameters in the HOD case study.

From ﬁgure 11 and table 3, one sees that the galaxy HOD constraints are clearly improved
by including the information from cluster counts. The improvement is the most spectacular
for αsat where the errors bars are decreased by a factor larger than 4. This can be understood
through the following reasoning. Since αsat governs the number of galaxies in massive haloes
and massive haloes are rare, there can be important variations in their number due to cosmic
variance. The eﬀect of αsat on the galaxy power spectrum is thus highly degenerate with
the mass function. Hence including cluster counts measurement breaks this degeneracy and
allows for a much stronger αsat constraint.

Furthermore, the parameter constraints are this time improved in the combined realistic
case compared to the naive independent hypothesis, despite the joint probe having a lower
SNR (see table 1). This is the opposite of the results on the cosmological constraints in the

– 24 –

Figure 11. 1-dimensional pdfs and 3σ 2-dimensional contours for HOD parameter constraints in the
HOD study case. Red lines give the constraints from C gal
, green from the joint analysis, blue from
the hypothetical independent case.

(cid:96)

cosmology case, as reported in section 8.2 4. This is evidence for a synergy of the probes and
the breaking of degeneracies. Indeed, in the independent hypothesis, the increased HOD con-
straints, compared to Cgal
alone, come only from the improvement of cosmological constraints
which are then marginalised over.

(cid:96)

9 Conclusion

As new large scale surveys such as DES start to deliver an enormous amount of data, the
joint analysis of observables become important to determine the best model that describes
our universe. In this work we take the ﬁrst steps in the development of a framework to study

4In fact we checked that the improvement scenario (i.e. constraints being better in the realistic case than in
the hypothetical independent case) is the most frequent. For instance, HOD constraints are also improved in
the cosmological study case and the same goes for cosmological constraints in the HOD study case. However
we refrain from reporting those results as they are unrealistic for actual data analysis.

– 25 –

in a consistent manner two such observables: cluster number counts and the galaxy angular
power spectrum. This framework uses several elements such as the halo mass function, the
halo proﬁle and the Halo Occupation Distribution model to construct a coherent modelling
including for the ﬁrst time a detailed modelling of the cross-covariance between these two
observables, taking into account second order bias, non-local bias and shot noise terms. In
particular, we suggest a uniﬁed framework for the inclusion of the super-sample covariance in
combined probes.

We use our model to construct a joint covariance matrix for both observables in two
cases, which we call comological and HOD cases, involving large and small scales respectively.
In both cases we ﬁrst point out some characteristics of the covariance matrix, emphasizing
the dominance of non-gaussian eﬀects at low redshift and small angular scales. Hence a ﬁrst
conclusion is that an accurate modelling of these eﬀects, as performed here, is essential if one
wants to extract useful information in this regime.

We next use our estimated covariance matrix to analyse the consequences of combining
both observables. A simple signal-to-noise ratio study is followed by a more detailed Fisher
matrix estimation of the probability distribution functions of the parameters. A set of cosmo-
logical parameters is studied in the cosmological case (marginalizing over HOD parameters)
and in the HOD case the HOD parameters are estimated (marginalizing over the cosmological
parameters).

We demonstrated the critical importance of combining these observables in deriving
constraints in both cosmological and HOD parameters. In the cosmological case, improve-
ments of the order of 20% can be expected by including the combination. For the HOD
case, we showed that even if cluster number counts are independent of HOD parameters, they
must be included since they provide important information that leads to a breaking of some
degeneracies and can dramatically improve the bounds on HOD parameters.

We also show that the consistent inclusion of the cross-correlation can lead to a few
percent degradation in the cosmological constraints but has a larger eﬀect, up to 50% in the
case of αsat, this time improving the constraints due to the breaking of degeneracies.

As mentioned before, we did not consider a number of experimental eﬀects in the mod-
elling developed here, such as photometric redshift errors, purity and completeness of cluster
detections, and scatter in the cluster mass determination. The inclusion of these eﬀects in a
more realistic study is left for future work, where we plan to apply the techniques developed
here to real data. However, we chose in our analysis conservative redshift binning, cluster
mass binning and mass range that can mitigate some experimental errors. At the moment
we are comparing our theoretical modelling with measurements on realistic simulations. We
expect that the inclusion of experimental eﬀects necessary for a realistic analysis to be a
correction to our results and should not change qualitatively our conclusions.

A 3D halo-galaxy-galaxy bispectrum in the Halo Model

The diﬀerent terms of the halo-galaxy-galaxy bispectrum can be derived from eq. (2.1) &
eq. (2.4) through lengthy and error-prone calculations. Alternatively, [29] have shown that
the galaxy polyspectra equations can be derived via an elegant diagrammatic formalism with
‘Feynman’-like rules. Here we follow this approach and extend it to cross-polyspectra with
halo statistics in given mass bins.
For the halo-galaxy-galaxy bispectrum, the ﬁrst step is to draw all the diagrams involving
one halo for the cluster count, labeled "1", and two possibly merged galaxies for the galaxy

– 26 –

spectrum, labeled "2" and "3". Merging occurs for shot-noise diagrams. These diagrams are
shown in Fig. 4.
Then a diagram contributes as a term to the hgg bispectrum given by:

• a prefactor 1/(ngal(z2) ngal(z3))

• a possible Kronecker of redshifts if some halos coincide, e.g. δz1,z2 if the ﬁrst galaxy

(labeled "2") is in the halo of the number count (labeled "1").

• integrals over the halo mass(cid:82) dM dnh

that is the halo of the number count (since that one has a ﬁxed mass M1).

dM for the halos containing the galaxies, except if

• average number of uplet of galaxy given by the HOD, e.g. (cid:104)Ngal(M )(cid:105) for a single galaxy

in a halo, (cid:104)N (N − 1)(cid:105) for a pair.

• for each galaxy, halo proﬁle u(k|M ) at the mass of the host halo, with k being the norm
of the sum of Fourier wavevectors over the galaxy labels, i.e. if the galaxy has label "2"
k = k2, but for a shot-noise diagram k = |k2 + k3| = k1

• the halo polyspectrum of the considered halos, conditionned to their mass and redshift

• a possible permutation of indices to account for symmetries. e.g. in the 2h-2h diagram
of Fig. 4, we have put galaxy "2" in the halo "1" of counts, but there is the symmetric
diagram where galaxy "3" is in the halo "1".

Note that this diagrammatic formalism and these rules allow to compute any polyspectrum
of halos and galaxies, though we just need the hgg bispectrum in this article. We note that
the complexity increases very quickly with the polyspectrum order considered, with e.g. the
hggg trispectrum requiring 14 diﬀerent terms, so that this diagrammatic becomes increasingly
useful with order to avoid lengthy and cumbersome calculations.

– 27 –

B3h(k123, z123|M1, z1) =

B2h−2h(k123, z123|M1, z1) =

B2h−1h2g(k123, z123|M1, z1) =

B2h−1h1g(k123, z123|M1, z1) =

(cid:90)

(cid:90)

(cid:90)
(cid:90)

(cid:12)(cid:12)(cid:12)(cid:12)M3,z3

(cid:12)(cid:12)(cid:12)(cid:12)M2,z2
(cid:12)(cid:12)(cid:12)(cid:12)M3,z3

1

ngal(z2) ngal(z3)

dM23

d2nh
dM

d2nh
dM

× (cid:104)Ngal(M2)(cid:105) (cid:104)Ngal(M3)(cid:105) u(k2|M2) u(k3|M3)

× Bhalo(k123|M123, z123)

(A.1)

δz1,z2

(cid:104)Ngal(M1)(cid:105)(cid:104)Ngal(M3)(cid:105)
ngal(z2) ngal(z3)
× u(k2|M1) u(k3|M3) Phalo(k3 |M13, z13) + perm. (2 ↔ 3)
(A.2)

d2nh
dM

dM3

dM

d2nh
dM

(cid:104)Ngal(Ngal − 1)(M )(cid:105)

ngal(z2) ngal(z3)
× u(k2|M ) u(k3|M ) Phalo(k1|M1, M, z1, z2)

δz2,z3

δz2,z3

dM

d2nh
dM

(cid:104)Ngal(M )(cid:105)

ngal(z2) ngal(z3)
× u(k1 |M ) Phalo(k1|M1, M, z1, z2)

Applying this diagrammatic formalism to the hgg bispectrum, we get 6 diﬀerent dia-

grams/terms with the following expressions:

(A.3)

(A.4)

(A.5)

(A.6)

B1h2g(k123, z123|M1, z1) =

δz1,z2,z3

ngal(z2) ngal(z3)

(cid:104)Ngal(Ngal − 1)(M1)(cid:105) u(k2|M1) u(k3|M1)

B1h1g(k123, z123|M1, z1) =

δz1,z2,z3

ngal(z2) ngal(z3)

(cid:104)Ngal(M1)(cid:105) u(k1|M1)

where δz1,z2,z3 = δz1,z2 δz2,z3.
Note that the 2h − 1h1g and 1h1g terms are shot-noise terms and are thus irrelevant for the
covariance with the real-space ACF (as shot-noise, corresponding to θ = 0, is explicitly not
considered), but they are relevant for the covariance with the power spectrum.

Eq. A.1 involves the halo bispectrum, which we compute at tree-level using the following

equation for the halo density:
δh(x|M, z) = b1(M, z) δDM(x, z)+

b2(M, z)

2!

(cid:0)δDM(x, z)2 −(cid:10)δ2

DM

(cid:11)(cid:1)+bs2(M, z)(cid:0)s2(x, z) −(cid:10)s2(cid:11)(cid:1)

(cid:90)

where s2 is the square of the tidal tensor and we have [27]:

s2(k, z) =

dk(cid:48)
(2π)3 S2(k(cid:48), k−k(cid:48)) δDM(k(cid:48), z) δDM(k−k(cid:48), z) with S2(k1, k2) =

(A.7)

(k1 · k2)2

k2
1 k2
2

− 1
3
(A.8)

The resulting halo bispectrum has the expression :

Bhalo(k123|M123, z123) = b1(M1, z1) b1(M2, z2) b1(M3, z3) BDM(k123, z123)

+(cid:2)b2(M1, z1) b1(M2, z2) b1(M3, z3)
× PDM(k2|z12) PDM(k3|z13) + 2 perm.(cid:3)
+(cid:2)2 bs2(M1, z1) b1(M2, z2) b1(M3, z3)
× S2(k2, k3) PDM(k2|z12) PDM(k3|z13) + 2 perm.(cid:3)

(A.9)

– 28 –

where the dark matter bispectrum is given at second-order in perturbation theory :

BDM(k123, z123) = 2F 2PT(k1, k2) Plin(k1|z1, z3) Plin(k2|z2, z3) + 2 perm.

(A.10)

(adapted from [28] for diﬀerent redshifts)
with

F 2PT(kα, kβ) =

+

cos θαβ

5
7

1
2

(cid:19)

(cid:18) kα

kβ

+

kβ
kα

+

2
7

cos2 θαβ.

(A.11)

B From the 3D hgg bispectrum to the cross-covariance

From Eq. 5.1, the deﬁnition of the halo density contrast and the halo-galaxy-galaxy (hgg)
bispectrum comes:

(cid:16)

Cov

Ncl(iM , iz), Cgal

(cid:96)

(jz)

= 4π

dM1 dV123

ngal(z2) ngal(z3)

(cid:90)
(cid:90) d3k123
(2π)9 j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3) P(cid:96)(ˆk2 · ˆk3)
× (2π)3 δ3(k1 + k2 − k3) Bhgg(k123|M1, z123)

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

∆Ngal(jz)2

dnh
dM

(B.1)

(cid:16)

We note that this can also be written as:

Cov

Ncl(iM , iz), Cgal

(cid:96)

(jz)

= 4π

dM1 dV123

dnh
dM

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

(cid:17)

×

(cid:90)

(cid:17)

ngal(z2) ngal(z3)

∆Ngal(jz)2

bhgg
0(cid:96)(cid:96) (M1, z123)

(B.2)

where bhgg is the halo-galaxy-galaxy angular bispectrum per comoving volumes and unit
mass. This bispectrum is involved in the squeezed conﬁguration (cid:96)1 (cid:28) (cid:96)2, (cid:96)3, in fact the most
squeezed possible : (cid:96)1 = 0. Hence we will have contributions in the integral only from triplets
of Fourier modes satisfying k1 (cid:28) k2 ≈ k3.

Now the thirteen integrals of Eq. B.1 are not numerically tractable and thus need to be
simpliﬁed analytically. To shorten further equations, we are going to ﬁrst concentrate on the
simpliﬁcation of bhgg

0(cid:96)(cid:96) (M1, z123) :

bhgg
0(cid:96)(cid:96) (M1, z123) =

(cid:90) d3k123
(2π)9 j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3) P(cid:96)(ˆk2 · ˆk3)
× (2π)3 δ3(k1 + k2 − k3) Bhgg(k123|M1, z123)

(B.3)

We are ﬁrst going to complexify this equation by writing the Legendre polynomial as as sum
of spherical harmonics with the addition theorem, introduce the Fourier representation of
the dirac, and expand the resulting Fourier modes in terms of Bessel functions and spherical
harmonics :

(cid:90) d3k123

bhgg
0(cid:96)(cid:96) (M1, z123) =

(2π)9 j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3)

(cid:90)

d3x (4π)3(cid:88)

4π

Y ∗
(cid:96)m(ˆk2) Y(cid:96)m(ˆk3)

m

2(cid:96) + 1
i(cid:96)1+(cid:96)2−(cid:96)3 j(cid:96)1(k1x)j(cid:96)2(k2x)j(cid:96)3(k3x)

× Bhgg(k123|M1, z123)
× Y1(ˆk1) Y2(ˆk2) Y ∗

1,2,3

3 (ˆk3) Y ∗

1 (ˆx) Y ∗

2 (ˆx) Y3(ˆx)

(B.4)

(cid:88)

– 29 –

which sure looks better.

Now we are faced with an alternative depending on the bispectrum term considered :
either the bispectrum term only depends on the moduli (k1, k2, k3) (case of most bispectrum
terms), or it also depends on the angles between the Fourier vectors (ˆk1 · ˆk2, ˆk1 · ˆk3, ˆk2 · ˆk3)
(case of the 2PT and s2 terms). We are going to treat these cases in separate subsections.

B.1 Angle-independent bispectrum
We ﬁrst note that the derivation below is essentially a copy of the derivation of Appendix E
of [29] in the particular case of the bispectrum in the squeezed limit 0(cid:96)(cid:96), except that we will
not apply a Limber approximation on k1.

In the angle-independent case, Bhgg(k123|M1, z123) = Bhgg(k123|M1, z123).

Inputting
this in Eq. B.4, we see that the integrals over the unit vectors ˆk1, ˆk2, ˆk3, ˆx can be trivially
√
performed as they only involve spherical harmonics. Speciﬁcally the integrals over ˆk1, ˆk2, ˆk3
force ((cid:96)1, m1) = (0, 0), ((cid:96)2, m2) = ((cid:96), m) and ((cid:96)3, m3) = ((cid:96), m). Taking care that Y00 = 1/
4π,
the integral over ˆx, ˆk1 and the sum over m are trivial and we get:

bhgg
0(cid:96)(cid:96) (M1, z123) =

ngal(z2) ngal(z3)

k2
123 dk123 4π x2 dx j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3)

∆Ngal(jz)2
× j0(k1x) j(cid:96)(k2x) j(cid:96)(k3x) Bhgg(k123|M1, z123)

2π2

(B.5)

We now apply the Limber approximation on k2 and k3, that is to assume that the bispectrum
varies slowly with these arguments compared to the oscillations of the corresponding Bessel
functions. We can thus take out the bispectrum of these integrals, evaluating it at the Bessel
peak ((cid:96) + 1/2)/r2/3, and use the identity:

(cid:18) 1

(cid:19)3(cid:90)

k2 dk j(cid:96)(kr) j(cid:96)(kx) =

π

2r2 δ(r − x)

(B.6)

bhgg
0(cid:96)(cid:96) (M1, z123) =

1 dk1 x2 dx j0(k1r1) j0(k1x) Bhgg(k1, k(cid:96), k(cid:96)|M1, z123)
k2

This greatly simpliﬁes the bispectrum:

ngal(z2) ngal(z3)

(cid:90)
× δ(r2 − x) δ(r3 − x)

∆Ngal(jz)2

(2π)3

1

r2
2 r2
3

where k(cid:96) = ((cid:96) + 1/2)/r2 (since r2 = r3 = x).
Inputting this in Eq. B.2 for the covariance gives:

Cov

Ncl(iM , iz), Cgal

(cid:96)

(jz)

= 4π

dM1 dV123 dVx

(cid:16)

(cid:90)

(cid:17)

(cid:90)

(cid:90)

× 1
(2π)3

(cid:90)

(cid:90)

× 1
2π2

(B.7)

δ(r2 − x) δ(r3 − x)

r2
2 r2
3
(B.8)

dnh
dM

(cid:12)(cid:12)(cid:12)(cid:12)M1,z1
(cid:12)(cid:12)(cid:12)(cid:12)M1,z1

ngal(z2) ngal(z3)

∆Ngal(jz)2

k2 dk j0(kr1) j0(kx) Bhgg(k, k(cid:96), k(cid:96)|M1, z123)

=

dM1 dV1 dVx

dnh
dM

ngal(zx)2
∆Ngal(jz)2

k2 dk j0(kr1) j0(kx) Bhgg(k, k(cid:96), k(cid:96)|M1, z1, zx, zx) (B.9)

where x has been considered has the comoving distance to a redshift zx, k(cid:96) = ((cid:96) + 1/2)/x and
the integral over zx implicitly runs over the redshift bin jz.

– 30 –

This equation allows to compute the cross-covariance from the 2h-1h1g, and 2h-1h2g bispec-
trum terms (Eq. A.4-A.3), giving explicitely:

(cid:16)
(cid:16)

Cov2h−1h1g

Cov2h−1h2g

Ncl(iM , iz), Cgal

(cid:96)

Ncl(iM , iz), Cgal

(cid:96)

(jz)

(jz)

(cid:17)
(cid:17)

1

∆Ngal(jz)2

=
× ngal(z2) bgal,eﬀ

(cid:90)
(cid:90)
=
× ngal(z2) bgal,eﬀ−2

∆Ngal(jz)2

1

1

dV12

(z2) σ2

dV12

(iM , z1)

∂nh
∂δb
proj(z1, z2)
∂nh
∂δb

(iM , z1)

(B.10)

(B.11)
where in the 2h-1h1g term, we approximated u(k1|M ) ≈ 1, as k1 gets aliased into the
monopole. That is, no considered halo takes up the whole sky. This seems a fair approxima-
tion as none of our observables is sensitive to the local group.

(k(cid:96), z2) σ2

proj(z1, z2)

1

Eq. B.9 also allow to compute the cross-covariance from the b2 subterm of the 3h

bispectrum. Recalling

halo(k123|M123, z123) = b2(M1, z1) b1(M2, z2) b1(M3, z3) PDM(k2|z12) PDM(k3|z13) + 2 perm.
Bb2
(B.12)
and given that k1 (cid:28) k2, k3 and that P (k) is decreasing over the range of interest, we can
assume that P (k2)P (k3) (cid:28) P (k1)P (k2), P (k1)P (k3) and neglect the corresponding term.
This yields:

Covb2

Ncl(iM , iz), Cgal

(cid:96)

(jz)

2

dV12

∆Ngal(jz)2

=
× bgal,eﬀ

2

(k(cid:96), z2) bgal,eﬀ

1

∂nh
(iM , z1) ngal(z2)2
∂δb
(k(cid:96), z2)PDM(k(cid:96)|z2) σ2

proj(z1, z2)

(B.13)

Some bispectrum terms do not depend on k1 (2h-2h and 1h2g terms), or only through
In that case, the

u(k1|M, z) (1h1g term) that we approximate as 1 as argued previously.
integral over k in Eq. B.9 can be performed analytically and yields:

(cid:17)

(cid:90)

Cov

Ncl(iM , iz), Cgal

(cid:96)

(jz)

= δiz,jz

dM1 dV

dnh
dM

ngal(z)2

∆Ngal(jz)2

1
4π

Bhgg(k, k(cid:96), k(cid:96)|M1, z)
(B.14)

This equation allows to compute the cross-covariance from the 2h-2h, 1h2g and 1h1g bispec-
trum terms (Eq. A.2-A.5-A.6), giving:

(cid:16)

(cid:16)

(cid:17)

(cid:90)

(cid:17)
(cid:17)
(cid:17)

=

=

=

(cid:12)(cid:12)(cid:12)(cid:12)M1,z

(cid:90)
(cid:90)
(cid:90)

δiz,jz

4π ∆Ngal(jz)2

δiz,jz

4π ∆Ngal(jz)2

δiz,jz

4π ∆Ngal(jz)2
× bgal,eﬀ

1

– 31 –

(cid:16)
(cid:16)
(cid:16)

Cov1h1g

Cov1h2g

Cov2h−2h

Ncl(iM , iz), Cgal

(cid:96)

(jz)

Ncl(iM , iz), Cgal

(cid:96)

(jz)

Ncl(iM , iz), Cgal

(cid:96)

(jz)

dV ngal(z|iM )

dV ngal(z)2 P 1h

gal(k(cid:96), z|iM )

dV 2 ngal(z)2 bgal,eﬀ

1

(k(cid:96), z)

(k(cid:96), z|iM ) PDM(k(cid:96), z)

(B.15)

(B.16)

(B.17)

(cid:90)

with

ngal(z|iM ) =

gal(k, z|iM ) =
P 1h

bgal,eﬀ
1

(k, z|iM ) =

(cid:90)
(cid:90)

dM

M∈bin(iM )

dnh
dM

(cid:104)Ngal(M )(cid:105)

1
n2
gal(z)
1

ngal(z)

dM

M∈bin(iM )

dM

M∈bin(iM )

dnh
dM
dnh
dM

(cid:104)Ngal(Ngal − 1)(M )(cid:105) u2(k|M, z)

(cid:104)Ngal(M )(cid:105) b1(M, z) u(k|M, z)

(B.18)

(B.19)

(B.20)

being the contribution of the iM mass bin to the number of galaxy, 1-halo power spectrum
and eﬀective galaxy bias.

Now are left only the 2PT and s2 bispectrum terms which both depend on the angle

between the Fourier modes and are thus the subject of the next subsection.

B.2 Angle dependent bispectrum
As a foreword, one could think that the bispectrum could be parametrised only by the moduli
k1, k2, k3. Indeed the angles between the vectors can be computed from the moduli, given
that (k1, k2, k3) form a triangle. This proves not to be a safe bet, because angles are fast
varying functions of the moduli in the squeezed limit k1 (cid:28) k2, k3, so we would never be in
the position to apply the Limber’s approximation used previously. Thus in the following, we
keep the angle-dependence of the bispectrum in the equations.
The 2PT and s2 bispectrum terms are of the general form:

Bhalo(k123|M123, z123) = bα(M1, z1) b1(M2, z2) b1(M3, z3) K(k2, k3) PDM(k2|z12) PDM(k3|z13)
(B.21)

+ 2 perm.

with α = 1, s2 and K = 2F 2PT, S2 for the 2PT and s2 terms respectively.
As already noted previously for the b2 term, P (k2)P (k3) (cid:28) P (k1)P (k2), P (k1)P (k3) so we
can neglect the corresponding term in the permutation.
The dimensionless kernel K is a function of the angle between the Fourier modes and

can be decomposed onto Legendre polynomials:

For example for the F 2P T kernel the sum runs over (cid:96)F = 0, 1, 2 and we have

F 2P T

0

=

17
21

F 2P T

1

=

1
2

+

k2
k1

F 2P T

2

=

2
7

while for the S2 kernel, the sum runs only over (cid:96)S = 2, all other terms being zero, and we
have

(B.24)
Now we need to compute the eﬀect of the K(cid:96)k term. Before diving into this, let us
ﬁrst note that the case of (cid:96)K = 0 is in fact simple : as P0 = 1, we are in fact back to the
angle-independent case. Through Sect. B.1 we know how to tackle this, and we get:

S2,2 = 1

(cid:16)

(cid:17)

CovK0

Ncl(iM , iz), Cgal

(cid:96)

(jz)

2

∆Ngal(jz)2

=
× K0 bgal,eﬀ

α

dV12

∂nh
(iM , z1) ngal(z2)2
∂δb
(k(cid:96), z2)PDM(k(cid:96)|z2) σ2

(k(cid:96), z2) bgal,eﬀ

1

proj(z1, z2)

(B.25)

K(k1, k2) =

K(cid:96)k P(cid:96)k (cos θ12)

(cid:19)

(B.22)

(B.23)

(cid:88)

(cid:96)k

(cid:18) k1

k2

(cid:90)

– 32 –

For the s2 term K0 = 0 while for the 2PT term K0 = 2 × 17

21. Thus:

(cid:16)
(cid:16)

Covs2,0

Cov2PT,0

Ncl(iM , iz), Cgal

(cid:96)

(jz)

Ncl(iM , iz), Cgal

(cid:96)

(jz)

(cid:17)
(cid:17)

(cid:90)

= 0

=

1

∆Ngal(jz)2

dV12

× 68
21

bgal,eﬀ
1

(k(cid:96), z2) bgal,eﬀ

1

∂nh
(iM , z1) ngal(z2)2
∂δb
(k(cid:96), z2)PDM(k(cid:96)|z2) σ2

(B.26)

proj(z1, z2)

(B.27)

which correspond to the results stated in the main text for the s2 and 2PT terms.

The rest of this subsection is devoted to argue that the contribution of higher (cid:96)K is

negligible (compared to the 2PT,0 term).
To do this we need to go back to the full generality of Eq. B.4 for the angular bispectrum :

(cid:90) d3k123

K(cid:96)k
0(cid:96)(cid:96) (M1, z123) =
b

(cid:88)

× B

(cid:90)

d3x (4π)3(cid:88)

(2π)9 j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3)
K(cid:96)k
hgg (k123|M1, z123)
× Y1(ˆk1) Y2(ˆk2) Y ∗

3 (ˆk3) Y ∗

1 (ˆx) Y ∗

1,2,3

4π

Y ∗
(cid:96)m(ˆk2) Y(cid:96)m(ˆk3)

m

2(cid:96) + 1
i(cid:96)1+(cid:96)2−(cid:96)3 j(cid:96)1(k1x)j(cid:96)2(k2x)j(cid:96)3(k3x)

2 (ˆx) Y3(ˆx)

(B.28)

Now we will drop integrals over masses in the bispectrum, as the argument is based on the
integrals of spherical harmonics and spherical bessel function, and the equations are already
long enough. We also drop the permutation 2 ↔ 3 and some redshift dependences for clarity.
Basically the angular bispectrum contains:

(cid:90) d3k123

K(cid:96)k
0(cid:96)(cid:96) (M1, z123) (cid:51)
b

(2π)9 j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3)

(cid:88)
i(cid:96)1+(cid:96)2−(cid:96)3 j(cid:96)1(k1x)j(cid:96)2(k2x)j(cid:96)3(k3x)

Y ∗
(cid:96)m(ˆk2) Y(cid:96)m(ˆk3)

m

(B.29)

× P(cid:96)K (cos θ12) P (k1) P (k2)

× Y1(ˆk1) Y2(ˆk2) Y ∗

Now we can expand the Legendre polynomial onto spherical harmonics:

(cid:90)

4π

2(cid:96) + 1

d3x (4π)3(cid:88)

1,2,3

2 (ˆx) Y3(ˆx)

3 (ˆk3) Y ∗
1 (ˆx) Y ∗
(cid:88)

4π

Y ∗

2(cid:96)K + 1

mK

P(cid:96)K (cos θ12) =

(cid:96)K ,mK

(ˆk1) Y(cid:96)K ,mK (ˆk2)

(B.30)

(cid:90)

Then we can perform the integrals over ˆk1, ˆk2, ˆk3. First the integral over ˆk3 forces ((cid:96)3, m3) =
((cid:96), m) by orthogonality of spherical harmonics. In the same way, the integral over ˆk1 forces
((cid:96)1, m1) = ((cid:96)K, mK). Finally the integral over ˆk2 is non-trivial and yields a Gaunt coeﬃcient:

G((cid:96), m, (cid:96)K, mK, (cid:96)2, m2) =

d2ˆk2 Y ∗

(cid:96)m(ˆk2) Y(cid:96)K ,mK (ˆk2) Y(cid:96)2,m2(ˆk2)

(B.31)

This forces −m + mK + m2 = 0 and |(cid:96) − (cid:96)K| ≤ (cid:96)2 ≤ (cid:96) + (cid:96)K with (cid:96) + (cid:96)K + (cid:96)2 even.
The integral over ˆx yields the same Gaunt coeﬃcient (more precisely its complex conjugate,

– 33 –

but Gaunt coeﬃcients are real anyway). Thus:

K(cid:96)k
0(cid:96)(cid:96) (M1, z123) (cid:51) (4π)5
b
(2π)9

1

(2(cid:96) + 1)(2(cid:96)K + 1)

2,m,mK

(cid:88)

(cid:90)

k2
123 dk123 x2 dx j0(k1r1) j(cid:96)(k2r2) j(cid:96)(k3r3)

× P (k1) P (k2) i(cid:96)K +(cid:96)2−(cid:96) j(cid:96)K (k1x)j(cid:96)2(k2x)j(cid:96)(k3x)G2((cid:96), m, (cid:96)K, mK, (cid:96)2, m2)

The sum over m2, m, mK can be carried out analytically and yields

G2((cid:96), m, (cid:96)K, mK, (cid:96)2, m2) =

(2(cid:96)2 + 1)(2(cid:96) + 1)(2(cid:96)K + 1)

4π

(cid:88)

m2,m,mK

(B.32)

(B.33)

(cid:18)(cid:96) (cid:96)2 (cid:96)K

(cid:19)2

0 0 0

The integral over k3 is the already-used identity of integral of spherical Bessel functions and
yields a dirac of redshifts z3 and zx.
Now comes the pitch. For the cases of interest (2PT and s2 bispectrum terms), (cid:96)K = 1
or 2. Thus, (cid:96)2 = (cid:96) − 1, (cid:96) + 1 or (cid:96)2 = (cid:96) − 2, (cid:96), (cid:96) + 2 respectively. Let’s compare the k1 and k2
integrals to the (cid:96)K = 0 case. In the (cid:96)K = 0 case we have

(cid:90)
(cid:90)

while for a general (cid:96)K we have(cid:90)
(cid:90)

k2
1 dk1 j0(k1r1) j0(k1x) P (k1)

k2
2 dk2 j(cid:96)(k2r2) j(cid:96)(k2x) P (k2)

k2
1 dk1 j0(k1r1) j(cid:96)K (k1x) P (k1)

k2
2 dk2 j(cid:96)(k2r2) j(cid:96)2(k2x) P (k2)

(B.34)

(B.35)

(B.36)

(B.37)

We expect both integrals to be small compared to their relative counterparts in the (cid:96)K = 0
case.
Indeed, the Bessel functions will have destructing interferences. They will not have
the same frequency, unless z1 = zx for the ﬁrst integral (z2 = zx for the second) where the
integrals of the (cid:96)K = 0 case are maximal. And in the z1 = zx (resp. z2 = zx) case, the Bessel
interferences will still be destructive because:

• j0 and j(cid:96)K do not peak at the same location. And the same is true for j(cid:96) and j(cid:96)2.
• the asymptotic oscillations5 are out of phase.

We thus conclude that these terms are negligible compared to the (cid:96)K = 0 case. Thus
(2PT,2)(cid:28)(2PT,0) and (2PT,1)(cid:28)(2PT,0). Given that the F 2PT and S2 kernels are both of
order 1 and that the corresponding biases will also be of the same order6, we also conclude
that (s2,2)(cid:28)(2PT,0).

5jn(y) ∼ sin(y − nπ
6In fact bs2 = − 2

2 )/y for y (cid:29) n.
7 (b1 − 1) following [27].

– 34 –

C SSC inequalities

This appendix contains the mathematical proof of the SSC inequalities stated in the main
text, as well as a discussion of their consequences.

Deﬁnition: A bivariate symmetric function κ(x, y) is said positively separable if it is of the
form

(cid:88)

κ(x, y) =

Ψi(x) Ψi(y)

for some family of univariate functions Ψi.

i

Lemma: If κ(x, y) is positively separable, the bivariate form

(cid:90)

< f, g >=

dx dy f (x) g(y) κ(x, y)

is a semi-inner product over real-valued functions.

Proof:
The form is obviously bilinear, and symmetric because of the symmetry of κ(x, y).
Let’s prove positivity, i.e. < f, f >≥ 0:

< f, f > =

=

dx dy f (x) f (y) κ(x, y)

dx dy f (x) f (y) Ψi(x) Ψi(y)

(cid:90)
(cid:88)
(cid:88)

i

(cid:90)
(cid:18)(cid:90)

=
≥ 0

i

(cid:19)2

f Ψi

Note: < f, f >= 0 ⇔(cid:82) f Ψi ∀i. Thus we have positive deﬁniteness, i.e. < f, g > is a strict

inner product, iﬀ the family (Ψi) is a basis of real-valued functions.

(C.1)

Consequence: We have the Cauchy-Schwarz inequality [34]

| < f, g > | ≤ (cid:107)f(cid:107) · (cid:107)g(cid:107)

Application: Recall the equations for super-sample covariance of Cgal

(iz) and Ncl(iM , iz):

(cid:96)

CovSSC (Ncl(iM , iz), Ncl(jM , iz))) =

CovSSC

Ncl(iM , iz), Cgal

(jz)

(cid:96)

∂nh(iM , z1)

∂nh(jM , z2)

∂δb

ngal(z2)2
∆Ngal(jz)2

∂δb

∂nh(iM , z1)

∂Pgal(k(cid:96), z2)

∂δb

∂δb

σ2
proj(z1, z2)

(C.2)

(cid:16)

(cid:16)

CovSSC

Cgal

(cid:96)

(iz), Cgal

(cid:96)(cid:48) (jz)

(cid:90)
(cid:90)
(cid:90)

(cid:17)
(cid:17)

=

=

dV12

dV12

dV12

σ2
proj(z1, z2)
(C.3)
∂Pgal(k(cid:96)(cid:48), z2)

∂δb

(C.4)

σ2
proj(z1, z2)

ngal(z1)2 ngal(z2)2

∂Pgal(k(cid:96), z1)

∆Ngal(iz)2 ∆Ngal(jz)2

∂δb

– 35 –

where dV = r2(z) dr
bins, and

dz dz, the redshift integrals are implicitly over the corresponding redshift

σ2
proj(z1, z2) =

1
2π2

k2dk j0(kr1) j0(kr2) P (k|z12)

Given that P (k|z12) = G(z1) G(z2)P (k, z = 0) with G(z) the growth function, σ2

proj(z1, z2) is

(cid:90)

positively separable with(cid:88)

(cid:90)

→ 1
2π2

i

k2dk and Ψi → j0 (kr(z)) G(z) (P (k, z = 0))1/2

(cid:17)(cid:12)(cid:12)(cid:12) ≤(cid:104)

(cid:17)(cid:12)(cid:12)(cid:12) ≤(cid:104)

We are thus in position to apply the lemma, with e.g.

f (z) = r2(z)

dr
dz

∂nh(iM , z)

∂δb

1[z∈bin(iz)]

and g(z) = r2(z)

dr
dz

∂nh(jM , z)

∂δb

1[z∈bin(jz)]

giving

|CovSSC (Ncl(iM , iz), Ncl(jM , jz)))| ≤ [VarSSC (Ncl(iM , iz)) · VarSSC (Ncl(jM , jz))]1/2

(C.5)

In particular, for a given redshift slice iz = jz, this inequality ensures that the correlation ma-
trix of cluster counts has oﬀ-diagonal elements ≤ 1 even in the deep SSC domination regime.
The same process can be applied to the auto-covariance of the galaxy power spectrum, yield-
ing:

Cgal

(cid:96)

(iz), Cgal

(cid:96)(cid:48) (jz))

VarSSC

Cgal

(cid:96)

(iz)

Cgal

(cid:96)(cid:48) (jz)

(C.6)

(cid:16)

(cid:17) · VarSSC

(cid:16)

(cid:17)(cid:105)1/2

(cid:12)(cid:12)(cid:12)CovSSC

(cid:16)

Again ensuring that the auto correlation matrix of the galaxy spectrum has oﬀ-diagonal
elements ≤ 1 in the SSC dominated regime.
Finally we can apply the Cauchy-Schwarz inequality to the cross-covariance, with

f (z) = r2(z)

dr
dz

∂nh(iM , z)

∂δb

1[z∈bin(iz)]

and g(z) = r2(z)

dr
dz

ngal(z)2

∂Pgal(k(cid:96), z)

∆Ngal(jz)2

∂δb

1[z∈bin(jz)]

yielding(cid:12)(cid:12)(cid:12)CovSSC

(cid:16)

(cid:16)

Cgal

(cid:96)

(cid:17)(cid:105)1/2

(jz)

(C.7)

Ncl(iM , iz), Cgal

(cid:96)

(jz))

VarSSC (Ncl(iM , iz)) · VarSSC

ensuring that the normalised joint correlation matrix has oﬀ-diagonal elements ≤ 1.

These inequalities are most useful when iz = jz.
proj(z1, z2) decreases
quickly when z1 becomes diﬀerent from z2, thus the SSC covariance decreases quickly for
diﬀerent redshift bins.

Indeed the kernel σ2

Consequence 2: The SSC joint covariance is a positive matrix.

Note: This statement is in fact more general and implies in particular the Cauchy-Schwarz
inequality

Proof: The proof simply amounts to showing that the covariance C is a semi-inner product.

We have Cij =(cid:82) dV12

∂Oi
∂δb

∂Oj
∂δb

σ2
proj(z1, z2)

– 36 –

with observable i Oi being in our case either nh(iM , z) or
Thus:

ngal(z)2
∆Ngal(jz)2 Pgal(k(cid:96), z).

TX · C · X =

(cid:90)

(cid:88)
(cid:90)

ij

k2dk

=
≥ 0

(cid:34)(cid:90)

dV12 k2dk j0(kr1) j0(kr2) P (k|z12) xi

dV j0(kr) G(z)(cid:0)P (k, z = 0)(cid:1)1/2(cid:88)

∂Oi
∂δb

∂Oj
∂δb

xj

(cid:35)2

xi

∂Oi
∂δb

i

So that C deﬁnes a semi-inner product.

(C.8)

(C.9)

(C.10)

(C.12)

(C.13)

Is C deﬁnite ?

To investigate deﬁniteness, we have to examine the case of equality in Eq. C.10.

(cid:90)

(cid:88)

TX · C · X = 0 ⇔ ∀k

j0(kr) = sin(kr)/kr so we have basically (cid:82) dr sin(kr) f (r) = 0 ∀k so f (r) = 0 (except an

dV j0(kr) G(z)

= 0

xi

i

(C.11)

∂Oi
∂δb

unphysical dirac at r=0). Thus

TX · C · X = 0 ⇔ ∀z G(z)

xi

∂Oi
∂δb

= 0

(cid:88)

i

∂(cid:80)

⇔ ∀z

i xi Oi
∂δb

= 0

So the covariance is not deﬁnite iﬀ there is some linear combination of observables which
does not react to any change of background at any redshift.
This would happen for instance if we included twice the same observable in the data vector,
which we obviously do not do, or if two observables reacted exactly in the same way to a
background change, in which case we would see a 100% SSC correlation for them. From the
ﬁgures given in the text, this is not the case of the cluster counts ; however it does appear
to be the case for the galaxy power spectrum, to the limit of numerical precision. Hence C
may have some zero eigenvalues, or at least eigenvalues small enough to blow up its condition
number. Numerical regularization, e.g. with Principal Component Analysis (PCA), would
thus be required to analyse observables deep in the SSC dominated regime.

D Multipole binning

A binning scheme can be deﬁned by its stakes (cid:96)b, such that the bin with index b contains
the multipoles (cid:96)b ≤ (cid:96) < (cid:96)b+1, with the center of the bin noted as (cid:96)cent and its width as ∆(cid:96).
A weighting is usually applied to the power spectrum to make the binned elements closer to
constant so as to lose less information :

(cid:88)

D(cid:96) = w(cid:96) C(cid:96)

Db =

1
∆(cid:96)

(cid:96)∈[(cid:96)b,(cid:96)b+1[

D(cid:96)

(D.1)

(D.2)

– 37 –

2π

in CMB studies. In our case, the galaxy power spectrum

where the weight w(cid:96) is usually (cid:96)((cid:96)+1)
behaves approximately as C(cid:96) ∝ 1/ell so that a weight w(cid:96) = (cid:96) is more adapted.
The binned Db can optionally be transformed back into a spectrum-like quantity with Cb =
Db/w(cid:96)cent. The information content in Db and Cb is the same but the latter is useful for
visualization purpose when performing actual data analysis.
We can thus deﬁne the binning operator

(cid:40) w(cid:96)

w(cid:96)cent ∆(cid:96)
0

(cid:96) ∈ [(cid:96)b, (cid:96)b+1[

if
otherwise

(D.3)

(D.4)
(D.5)

Pb,(cid:96) =

so that

Cb = Pb,(cid:96) C(cid:96)

Cov(Cb, Cb(cid:48)) = Pb,(cid:96) Pb(cid:48),(cid:96)(cid:48) C(cid:96),(cid:96)(cid:48)

To apply these equations in our case, we need predictions of the power spectrum and
more diﬃcultly of its covariance for all multipoles in the range considered. Exact analyt-
ical prediction however proves too numerically-intensive to be achieved. Nevertheless the
power spectrum and its covariance prove remarkably smooth when considered in the ade-
quate space. Thus we employ interpolation. More precisely we use spline interpolation in the
space (log (cid:96), log C(cid:96)), which works very accurately for the power spectrum. For the covariance,
there are two small problems to overcome : the covariance can be negative, and the Gaussian
term is a sharp peak on the diagonal. The sign of the covariance is fortunately constant with
multipoles for a given couple of redshift bin, so that we can factor out the sign and interpolate

log(cid:12)(cid:12)C(cid:96),(cid:96)(cid:48)(cid:12)(cid:12). The diagonal of the Gaussian covariance is then interpolated separately from the

other terms which have a smooth oﬀ-diagonal behaviour.

Figure 12 shows the results of the diﬀerent steps : ﬁrst the covariance on the original
eight multipoles computed, then the interpolated covariance on the full multipole range, and
ﬁnally the binned covariance matrix.

Figure 12. Correlation matrix of the galaxy power spectrum in nine redshift bins. Left: Correlation
matrix of eight particular multipoles between (cid:96)min = 30 and (cid:96)max = 300. Center: after interpolation,
correlation matrix of all multipoles in 30 ≤ (cid:96) ≤ 300. Right: correlation matrix after binning of
multipoles with a constant width ∆(cid:96) = 30.

One sees that binning increases the oﬀ-diagonality of the matrix, and makes thus more
evident the importance of non-Gaussianity on the information content of the galaxy power
spectrum. Indeed, the Gaussian covariance being diagonal, its contribution decreases with the

– 38 –

bin width as Var(Cb) ∼ Var(C(cid:96)cent)/∆(cid:96), while non-Gaussian terms decrease much more slowly.
For example in the case of super-sample covariance, multipoles are nearly 100% correlated
together if SSC is the only covariance contributor, meaning the correlation matrix has value
1 everywhere. After binning, the bins remain obviously nearly 100% correlated together so
that the binned SSC correlation matrix is as oﬀ-diagonal as the unbinned one.

We note that this result might be seen as counter-intuitive at ﬁrst sight, since averaging
should Gaussianize a variable by the central limit theorem. But the paradox is only at ﬁrst
sight : the central limit theorem ensures that the likelihood of Cb becomes closer to Gaussian
as ∆(cid:96) increases, but it tells nothing about the evolution of the covariance matrix of Cb.
Physically, the constant eﬀect of mode-coupling (due to non-linearity) becomes more evident
as the error bars on mode determination shrink (via binning).

Acknowledgments

This work was supported by the São Paulo Research Foundation (FAPESP) under grants
#2011/11973 and #2013/19936-6. R.R. was partially supported by a CNPq research grant.
The authors acknowledge useful discussions with Michel Aguena, Scott Dodelson, Enrique
Gaztañaga, Kai Hoﬀmann, Benjamin Joachimi and Elisabeth Krause.

References

[1] P. A. R. Ade et al. [Planck Collaboration], arXiv:1502.01589 [astro-ph.CO].
[2] J. Frieman, M. Turner and D. Huterer, Ann. Rev. Astron. Astrophys. 46 (2008) 385

[arXiv:0803.0982 [astro-ph]].

[3] W. Hu and A. V. Kravtsov, Astrophys. J. 584, 702 (2003) [astro-ph/0203169].
[4] S. Majumdar and J. J. Mohr, Astrophys. J. 613, 41 (2004) [astro-ph/0305341].
[5] M. Lima and W. Hu, Phys. Rev. D 72, 043006 (2005) [astro-ph/0503363].
[6] L. Liberato and R. Rosenfeld, JCAP 0607, 009 (2006) [astro-ph/0604071].
[7] L. R. Abramo, R. C. Batista, L. Liberato and R. Rosenfeld, JCAP 0711, 012 (2007)

[arXiv:0707.2882 [astro-ph]].

[8] F. de Simoni, F. Sobreira, A. Carnero, A. J. Ross, H. O. Camacho, R. Rosenfeld, M. Lima and

L. A. N. da Costa et al., Mon. Not. Roy. Astron. Soc. 435, 3017 (2013) [arXiv:1308.0630
[astro-ph.CO]].

[9] A. Cooray and R. K. Sheth, Phys. Rept. 372, 1 (2002) [astro-ph/0206508].
[10] J. L. Tinker, A. V. Kravtsov, A. Klypin, K. Abazajian, M. S. Warren, G. Yepes, S. Gottlober

and D. E. Holz, Astrophys. J. 688, 709 (2008) doi:10.1086/591439 [arXiv:0803.2706 [astro-ph]].

[11] J. F. Navarro, C. S. Frenk and S. D. M. White, Astrophys. J. 490, 493 (1997)

[astro-ph/9611107].

[12] R. Scoccimarro, R. K. Sheth, L. Hui and B. Jain, Astrophys. J. 546, 20 (2001)

[astro-ph/0006319].

[13] U. Seljak, Mon. Not. Roy. Astron. Soc. 318, 203 (2000) [astro-ph/0001493].
[14] A. Cooray and W. Hu, Astrophys. J. 554, 56 (2001) [astro-ph/0012087].
[15] M. Takada and S. Bridle, New J. Phys. 9, 446 (2007) [arXiv:0705.0163 [astro-ph]].
[16] M. Takada and W. Hu, Phys. Rev. D 87, no. 12, 123504 (2013) [arXiv:1302.6994 [astro-ph.CO]].

– 39 –

[17] E. Schaan, M. Takada and D. N. Spergel, Phys. Rev. D 90, no. 12, 123523 (2014)

doi:10.1103/PhysRevD.90.123523 [arXiv:1406.3330 [astro-ph.CO]].

[18] E. Krause and T. Eiﬂer, arXiv:1601.05779 [astro-ph.CO].
[19] J. S. Bullock, T. S. Kolatt, Y. Sigad, R. S. Somerville, A. V. Kravtsov, A. A. Klypin,

J. R. Primack and A. Dekel, Mon. Not. Roy. Astron. Soc. 321, 559 (2001) [astro-ph/9908159].

[20] E. Komatsu and U. Seljak, Mon. Not. Roy. Astron. Soc. 336, 1256 (2002)

doi:10.1046/j.1365-8711.2002.05889.x [astro-ph/0205468].

[21] J. L. Tinker, B. E. Robertson, A. V. Kravtsov, A. Klypin, M. S. Warren, G. Yepes and

S. Gottlober, Astrophys. J. 724, 878 (2010) doi:10.1088/0004-637X/724/2/878
[arXiv:1001.3162 [astro-ph.CO]].

[22] K. Hoﬀmann, J. Bel and E. Gaztanaga, Mon. Not. Roy. Astron. Soc. 450, no. 2, 1674 (2015)

doi:10.1093/mnras/stv702 [arXiv:1503.00313 [astro-ph.CO]].

[23] J. L. Tinker and A. R. Wetzel, Astrophys. J. 719 (2010) 88 [arXiv:0909.1325 [astro-ph.CO]].
[24] A. Pénin, F. Lacasa and N. Aghanim, Mon. Not. Roy. Astron. Soc. 439, no. 1, 143 (2014)

[arXiv:1312.1252 [astro-ph.CO]].

[25] F. Lacasa, A. Pénin and N. Aghanim, Mon. Not. Roy. Astron. Soc. 439, 123 (2014)

[arXiv:1312.1251 [astro-ph.CO]].

[26] D. J. Eisenstein and W. Hu, Astrophys. J. 496, 605 (1998) doi:10.1086/305424

[astro-ph/9709112].

[27] Baldauf, T. and Seljak, U. and Desjacques, V. and McDonald, P., Phys. Rev. D 86, 083540

(2012) [astro-ph/1201.4827].

[28] Fry, J. N., Astrophys. J. 279 (1984) pp 499-510.
[29] F. Lacasa, A. Pénin, N. Aghanim Mon. Not. Roy. Astron. Soc. 439, 123-142 (2014)
[30] F. Lacasa arXiv:1406.0441
[31] F. Lacasa Proceedings of the International Astronomical Union, IAU Symposium, 306, 216-218

(2014)

[32] J. Barriga and E. Gaztanaga, Mon. Not. Roy. Astron. Soc. 333, 443 (2002) [astro-ph/0112278].
[33] A. G. Sanchez, C. M. Baugh and R. Angulo, Mon. Not. Roy. Astron. Soc. 390, 1470 (2008)

[arXiv:0804.0233 [astro-ph]].

[34] H. A. Schwarz, “Über ein Flächen kleinsten Flächeninhalts betreﬀendes Problem der

Variationsrechnung”, Acta Societatis scientiarum Fennicae XV: 318,
http://www-stat.wharton.upenn.edu/~steele/Publications/Books/CSMC/Schwarz.pdf

– 40 –

