6
1
0
2

 
r
a

M
 
3

 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
8
3
9
0
0

.

3
0
6
1
:
v
i
X
r
a

{0,±1}-vectors and 𝑠-cross-intersecting families

Peter Frankl, Andrey Kupavskii*

Abstract

𝑘−1

)︀.
in which any two sets intersect, has cardinality at most(︀𝑛−1

In this paper we study two directions of extending the classical Erd˝os-Ko-Rado
theorem which states that any family of 𝑘-element subsets of the set [𝑛] = {1, . . . , 𝑛}
In the first part of the paper we study the families of {0,±1}-vectors. Denote by
ℒ𝑘 the family of all vectors v from {0,±1}𝑛 such that ⟨v, v⟩ = 𝑘. For any 𝑘 and 𝑙 and
sufficiently large 𝑛 we determine the maximal size of the family 𝒱 ⊂ ℒ𝑘 such that for
any v, w ∈ 𝒱 we have ⟨v, w⟩ ≥ 𝑙. We find some exact values of this function for all 𝑛
for small values of 𝑘.
In the second part of the paper we study cross-intersecting pairs of families. We
say that two families are 𝒜,ℬ are 𝑠-cross-intersecting, if for any 𝐴 ∈ 𝒜, 𝐵 ∈ ℬ we have
|𝐴 ∩ 𝐵| ≥ 𝑠. We also say that a set family 𝒜 is 𝑡-intersecting, if for any 𝐴1, 𝐴2 ∈ 𝒜 we
have |𝐴1 ∩ 𝐴2| ≥ 𝑡. For a pair of nonempty 𝑠-cross-intersecting 𝑡-intersecting families
𝒜,ℬ of 𝑘-sets, we determine the maximal value of |𝒜| + |ℬ| for 𝑛 sufficiently large.
If the nonempty families 𝒜,ℬ are 𝑠-cross-intersecting (and the 𝑡-intersecting condi-
tion is omitted), then we determine the maximum of |𝒜|+|ℬ| for all 𝑛. This generalizes
a result of Hilton and Milner, who determined the maximum of |𝒜| +|ℬ| for nonempty
1-cross-intersecting families.

𝑘

1

Introduction

Let [𝑛] = {1, . . . , 𝑛} be an 𝑛-element set and for 0 ≤ 𝑘 ≤ 𝑛 let(︀[𝑛]
Theorem (Erd˝os-Ko-Rado theorem [2]). If 𝒜 ⊂ (︀[𝑛]
|𝒜| ≤(︀𝑛−1

all its 𝑘-element subsets. Let further 2[𝑛] denote the power set. Any subset ℱ ⊂ 2[𝑛] is called
a set family or family for short. The following classical result is one of the cornerstones of
extremal set theory. If 𝐹 ∩ 𝐹 ′ ̸= ∅ for all 𝐹, 𝐹 ′ ∈ ℱ, then ℱ is called intersecting.

)︀ denote the collection of
)︀ is intersecting and 𝑛 ≥ 2𝑘, then

)︀ holds.

𝑘

𝑘−1

*Moscow Institute of Physics and Technology, ´Ecole Polytechnique F´ed´erale de Lausanne; Email:
Research supported in part by the Swiss National Science Foundation Grants
kupavskii@yandex.ru
200021-137574 and 200020-14453 and by the grant N 15-01-03530 of the Russian Foundation for Basic Re-
search.

1

This is one of the first results in extremal set theory and probably the first result about

intersecting families.

Numerous results extended the Erd˝os-Ko-Rado theorem in different ways. One of the
directions was to study non-trivial intersecting families, that is, excluding the obvious exam-
ples of intersecting families of sets that all contain a fixed element. Note that the family of
all sets containing a single element has the size matching the bound from the EKR theorem.
Probably, the most known result in this direction is the Hilton-Milner theorem [11], which
gives the maximum size of a non-trivial intersecting family.
In the same paper Hilton and Milner dealt with pairs of cross-intersecting families. We
call 𝒜,ℬ ⊂ 2[𝑛] cross-intersecting, if for every 𝐴 ∈ 𝒜 and 𝐵 ∈ ℬ we have 𝐴 ∩ 𝐵 ̸= ∅. They
proved the following inequality:

Theorem (Hilton and Milner [11]). Let 𝒜,ℬ ⊂(︀[𝑛]
)︀ be non-empty cross-intersecting families
with 𝑛 ≥ 2𝑘. Then |𝒜| + |ℬ| ≤(︀𝑛
)︀ + 1.
This inequality was generalized by Frankl and Tokushige [9] to the case 𝒜 ⊂ (︀[𝑛]
)︀,
ℬ ⊂ (︀[𝑛]
)︀ with 𝑎 ̸= 𝑏, and with more general constraints on the sizes of 𝒜,ℬ. A simple

)︀ −(︀𝑛−𝑘

𝑎

𝑘

𝑘

𝑘

𝑏

proof of the theorem above may be found in [8].

Another natural direction of the generalizations is to put numerical restraints on the
size of the intersections. A family is called 𝑡-intersecting if any two of its sets overlap in at
least 𝑡 elements. The Complete Intersection Theorem due to Alswede and Khachatrian [1],
continuing previous work done by Frankl [3] and Frankl and F¨uredi [6], gave the complete
answer to the question how big a 𝑡-intersecting family can be. We discuss it in more detail
in Section 3.

It states that, if 𝑛 is a prime power and 𝒜 ⊂ (︀[4𝑛−1]
elements, then the size of 𝒜 is at most(︀4𝑛−1

)︀ and no two sets intersect in 𝑛 − 1
)︀, which is exponentially smaller than(︀4𝑛−1
)︀.

One more example of a result of such kind is a theorem due to Frankl and Wilson [10].

2𝑛−1

2𝑛−1

𝑛−1

This theorem has several applications in geometry.

The third direction is to generalize the EKR theorem to more general classes of objects.
Out of the numerous generalizations of such kind we are going to talk only about the ones
concerned with {0,±1}-vectors, that is, vectors that have coordinates from the set {−1, 0, 1}.
In this case a natural replacement for the size of the intersection is the scalar product. A
generalization of [10] to the case of {0,±1}-vectors due to Raigorodskii [15] led to improved
bounds in several geometric questions, such as Borsuk’s problem and the chromatic number
of the space. However, it seems plausible to improve Raigorodskii’s result, once one achieves a
better understanding of “intersecting” families of {0,±1}-vectors. Partly motivated by that,
in our recent work [7] we managed to extend EKR theorem to the case of {0,±1}-vectors
with fixed number of 1’s and −1’s.
The contribution of this paper is two-fold. First, we determine in several scenarios the
maximal size of a family of {0,±1}-vectors of fixed length and with restrictions on the scalar
product. The main results are stated in Section 2.2. Second, we prove results analogous to
the Hilton-Milner theorem stated above, but for pairs of families that are 𝑠-cross-intersecting
and 𝑡-intersecting. For details and precise definitions see Section 3.

2

{0,±1}-vectors

2
Denote by ℒ𝑘 the family of all vectors v from {0,±1}𝑛 such that ⟨v, v⟩ = 𝑘. Note that

)︀. This section is mostly devoted to the study of the quantity below.

|ℒ𝑘| = 2𝑘(︀𝑛

𝑘

𝐹 (𝑛, 𝑘, 𝑙) = max{|𝒱| : 𝒱 ⊂ ℒ𝑘,∀ v, w ∈ 𝒱 ⟨v, w⟩ ≥ 𝑙}.

(1)

Recall the following theorem of Katona:

Theorem (Katona, [12]). Let 𝑛 > 𝑠 > 0 be fixed integers. If 𝒰 ⊂ 2[𝑛] is a family of sets
such that for any 𝑈, 𝑉 ∈ 𝒰 we have |𝑈 ∪ 𝑉 | ≤ 𝑠 then

|𝒰| ≤ 𝑓 (𝑛, 𝑠) :=

⎧⎪⎪⎪⎪⎪⎨⎪⎪⎪⎪⎪⎩

(︂𝑛
)︂
𝑠/2∑︁
(︂𝑛 − 1
)︂
(𝑠−1)/2∑︁

𝑖=0

𝑖

2

𝑖=0

𝑖

if 𝑠 is even,

if 𝑠 is odd.

(2)

Moreover, for 𝑛 ≥ 𝑠 + 2 the equality is attained only for the following families: the family
𝒰 𝑠 of all sets of size at most 𝑠/2 for 𝑠 even, and the family 𝑈 𝑠
𝑖 of all sets that have at most
(𝑠 − 1)/2 elements in [𝑛] − {𝑖}, 1 ≤ 𝑖 ≤ 𝑛, when 𝑠 is odd.

Given two sets 𝑈, 𝑉 , by 𝑈△𝑉 we denote the symmetric difference of these two sets, that
is, 𝑈∖𝑉 ∪ 𝑉 ∖𝑈 . A theorem due to Kleitman states that the bound (2) holds for more general
families:
Theorem (Kleitman, [13]). If 𝒰 ⊂ 2[𝑛] is a family of sets such that for any 𝑈, 𝑉 ∈ 𝒰 we
have |𝑈△𝑉 | ≤ 𝑠 then the bound (2) holds for 𝒰.

Note that there is no uniqueness counterpart in Kleitman’s theorem.

2.1 Simple properties of 𝐹 (𝑛, 𝑘, 𝑙)

First we state and prove some simple observations concerning 𝐹 (𝑛, 𝑘, 𝑙).

Proposition 1. Fix any 𝑛 ≥ 𝑘 ≥ 1. Then 𝐹 (𝑛, 𝑘,−𝑘 + 1) = 2𝑘−1(︀𝑛

)︀ = |ℒ𝑘|/2.

𝑘

Proof. We split vectors from ℒ𝑘 in pairs v, w so that ⟨v, w⟩ = −𝑘. We can take exactly one
vector out of each pair in the family.

For any v = (𝑣1, . . . , 𝑣𝑘) and any vector family 𝒱 define 𝑆(v) = {𝑖 : 𝑣𝑖

𝒱(𝑆) = {v ∈ 𝒲 : 𝑆(v) = 𝑆}. We also define 𝑁 (v) = {𝑖 : 𝑣𝑖 = −1}.
Proposition 2. We have 𝐹 (2𝑡, 2𝑡, 2𝑠) = 𝐹 (2𝑡, 2𝑡, 2𝑠 − 1) = 𝑓 (2𝑡, 𝑡 − 𝑠) and 𝐹 (2𝑡 + 1, 2𝑡 +
1, 2𝑠) = 𝐹 (2𝑡 + 1, 2𝑡 + 1, 2𝑠 + 1) = 𝑓 (2𝑡 + 1, 𝑡 − 𝑠).

̸= 0} and

3

Proof. For any v, w ∈ ℒ2𝑡 we have ⟨v, w⟩ = 2𝑡 − 2|𝑁 (v)△𝑁 (w)|. Therefore, the statement
of the proposition follows from Kleitman’s Theorem.

We say that a family 𝒱 ⊂ ℒ𝑘 of vectors is homogeneous, if for every 𝑖 ∈ [𝑛] the 𝑖’th

coordinates of vectors from 𝒱 are all non-negative or all non-positive.
Proposition 3. For 𝑛 > 𝑘 𝐹 (𝑛, 𝑘, 𝑘 − 1) = max{𝑘 + 1, 𝑛 − 𝑘 + 1} holds.
Proof. First of all note that 𝑢𝑖𝑣𝑖 = −1 forces ⟨u, v⟩ ≤ 𝑘 − 2. Thus 𝒱 is homogeneous and
the condition translates into |𝑆(u) ∩ 𝑆(v)| ≥ 𝑘 − 1.
Since the only (𝑘− 1)-intersecting 𝑘-graphs are the star around a (𝑘− 1)-element set and

subsets of(︀[𝑘+1]

)︀, we are done.

𝑘

Given a vector family 𝒱, for any 𝑖 ∈ [𝑛] we denote by 𝑑𝑖 the degree of 𝑖, that is, the

number of vectors from 𝒱 that have a nonzero coordinate on position 𝑖.
Proposition 4. For 𝑛 > 𝑘 ≥ 2 the following holds:
(i) 𝐹 (3, 2, 0) = 4.

)︀ if 𝑛 = 𝑘 + 2 or 𝑘 ≥ 3 and 𝑛 = 𝑘 + 1.
)︀, 𝑘(𝑛 − 𝑘) + 1}︀ for 𝑛 ≥ 𝑘 + 3.

(ii) 𝐹 (𝑛, 𝑘, 𝑘 − 2) =(︀𝑛
(iii) 𝐹 (𝑛, 𝑘, 𝑘 − 2) = max{︀(︀𝑛−𝑘+2
|𝒱| ≤ 2 + 2 = 4. Thus we may assume that 𝒱 is homogeneous. Consequently, |𝒱| ≤(︀𝑘+1
)︀ for
𝑘 ≥ 3, as desired. Since(︀𝑘+2
)︀ ≥ 2 for 𝑘 ≥ 2, the same argument works for 𝑛 = 𝑘 + 2

Proof. The first part is very easy to verify. As for the other parts, again, 𝑢𝑖 = −𝑣𝑖 forces
𝑆(u) = 𝑆(v) and u and v must agree in the remaining coordinate positions. Thus 𝑑𝑖 = 2
in this case. Since 𝐹 (𝑘, 𝑘, 𝑘 − 2) = 2, for 𝑛 = 𝑘 + 1 a vertex of degree 2 would force

)︀−(︀𝑘+1

𝑘

𝑘

2

as well.
If 𝑛 > 𝑘 + 2, the same argument gives that the family {𝑆(u) : u ∈ 𝒱} is (𝑘 − 2)-
intersecting. If |𝒱| is maximal, then it is homogeneous. The bound then follows from the
Complete Intersection Theorem (see Section 3).

𝑘

𝑘

2.2 Results
Our main result concerning {0,±1}-vectors is the following theorem, which determines
𝐹 (𝑛, 𝑘, 𝑙) for all 𝑘, 𝑙 and sufficiently large 𝑛 and which shows the connection of 𝐹 (𝑛, 𝑘, 𝑙)
with the above stated theorems of Katona and Kleitman.
Theorem 5. For any 𝑛 ≥ 𝑛0(𝑘) we have

1.

2.

𝐹 (𝑛, 𝑘, 𝑙) =

𝑘 − 𝑙
𝐹 (𝑛, 𝑘,−𝑙) = 𝑓 (𝑘, 𝑙)

)︂

for 0 ≤ 𝑙 ≤ 𝑘.

for 0 ≤ 𝑙 ≤ 𝑘.

(︂𝑛 − 𝑙

)︂
(︂𝑛

𝑘

4

Note that 𝑓 (𝑘, 0) = 1 and so the values for 𝑙 = 0 in part 1 and 𝑙 = 0 in part 2 coincide.
We remark that the statement of part 2 of the theorem for 𝑙 = 𝑘 is obvious and for 𝑙 = −𝑘 +1
it was already derived in Proposition 1.

Using the same technique, we may extend the result of part 2 of Theorem 5 in the

following way:
Theorem 6. Let 𝒱 ⊂ ℒ𝑘 be the set of vectors such that for any v, w ∈ 𝒱 we have ⟨v, w⟩ ̸=
−𝑙 − 1 for some 0 ≤ 𝑙 < 𝑘. Then we have

(︂𝑛
)︂

𝑘

|𝒱| = 𝑓 (𝑘, 𝑙)

+ 𝑂(𝑛𝑘−1).

max𝒱

For 𝑘 = 3 the values not covered by Propositions 1, 3, 4 and Theorem 5 are 𝐹 (𝑛, 3, 0)
and 𝐹 (𝑛, 3,−1) for 𝑛 not too large. We determine 𝐹 (𝑛, 3, 0) in the following theorem, but
first we need some preparation.
Let us use the notation (𝑎, 𝑏, 𝑐) for a set {𝑎, 𝑏, 𝑐} if we know that 𝑎 < 𝑏 < 𝑐. Also for
(𝑎, 𝑏, 𝑐) ⊂ [𝑛] let u(𝑎, 𝑏, 𝑐) = (𝑢1, . . . , 𝑢𝑛) with 𝑢𝑖 = 1 for 𝑖 ∈ {𝑎, 𝑏, 𝑐} and 𝑢𝑖 = 0 otherwise.
Further let v(𝑎, 𝑏, 𝑐) = (𝑣1, . . . , 𝑣𝑛) be the vector with 𝑣𝑎 = 𝑣𝑏 = 1, 𝑣𝑐 = −1 and 𝑣𝑖 = 0
otherwise.

Let us show two lower bounds for 𝐹 (𝑛, 3, 0). Taking all non-negative vectors gives

(︂𝑛

)︂

.

3

𝐹 (𝑛, 3, 0) ≥

The other one is based on the following family:

𝒱(𝑛) = {u(𝑎, 𝑏, 𝑐), v(𝑎, 𝑏, 𝑐) : |(𝑎, 𝑏, 𝑐) ∩ [3]| ≥ 2}.

Note that ⟨v, v′⟩ ≥ 0 for all v, v′ ∈ 𝒱(𝑛) and the first few values of |𝒱(𝑛)| are |𝒱(3)| =
2,|𝒱(4)| = 8,|𝒱(5)| = 14,|𝒱(6)| = 20.

Theorem 7. We have
(1) 𝐹 (𝑛, 3, 0) = |𝒱(𝑛)| for 𝑛 = 3, 4, 5.
(2) 𝐹 (6, 3, 0) = 21.

(3) 𝐹 (𝑛, 3, 0) =(︀𝑛

)︀ for 𝑛 ≥ 7.

3

As we will see, the proof of (2) is the most difficult.

3 Cross-intersecting families
We say that two families 𝒜,ℬ ⊂ 2[𝑛] are 𝑠-cross-intersecting, if for any 𝐴 ∈ 𝒜, 𝐵 ∈ ℬ we
have |𝐴 ∩ 𝐵| ≥ 𝑠. In the proof of Theorem 5 we need to estimate the sum of the size of
two 𝑡-intersecting families that are 𝑠-cross-intersecting. For the proof some relatively crude
bounds are sufficient but we believe that this problem is interesting in its own right. As a

5

matter of fact the case of non-uniform families was solved by Sali [16] (cf. [4] for an extension
with a simpler proof).

To state our results for the 𝑘-uniform case let us make some definitions.

Definition 1. For 𝑘 ≥ 𝑠 > 𝑡 ≥ 1 and 𝑘 ≥ 2𝑠 − 𝑡 define the Frankl-family 𝒜𝑖(𝑘, 𝑠, 𝑡) by

𝒜𝑖(𝑛, 𝑘, 𝑡) = {𝐴 ⊂

: |𝐴 ∩ [𝑡 + 2𝑖]| ≥ 𝑡 + 𝑖},

0 ≤ 𝑖 ≤ 𝑠 − 𝑡.

(︂[𝑛]

)︂

𝑘

Note that for 𝐴, 𝐴′ ∈ 𝒜𝑖(𝑘, 𝑠, 𝑡) one has |𝐴 ∩ 𝐴′ ∩ [𝑡 + 2𝑖]| ≥ 𝑡, in particular, 𝒜𝑖(𝑘, 𝑠, 𝑡) is

𝑡-intersecting. Also, for 𝑖 < 𝑠 − 𝑡 every vertex of [𝑘] is covered by some 𝐴 ∈ 𝒜𝑖(𝑘, 𝑠, 𝑡).

The following result was conjectured by Frankl [3] and nearly 20 years later proved by

Ahlswede and Khachatrian.

Theorem (Complete Intersection Theorem ([1])). Suppose that 𝒜 ⊂(︀[𝑘]

)︀ is 𝑡-intersecting,

𝑠

𝑘 ≥ 2𝑠 − 𝑡. Then

|𝒜| ≤ max
0≤𝑖≤𝑠−𝑡

|𝒜𝑖(𝑘, 𝑠, 𝑡)| =: 𝑚(𝑘, 𝑠, 𝑡)

holds.

(3)

Moreover, unless 𝑘 = 2𝑠, 𝑡 = 1 or 𝒜 is isomorphic to 𝒜𝑖(𝑘, 𝑠, 𝑡), the inequality is strict.
Definition 2. For 𝑘 ≥ 2𝑠 − 𝑡, 0 ≤ 𝑖 < 𝑠 − 𝑡 define

ℳ𝑖(𝑘, 𝑠, 𝑡) = {𝐴 ⊂ [𝑘] : |𝐴| ≥ 𝑠,|𝐴 ∩ [𝑡 + 2𝑖]| ≥ 𝑡 + 𝑖} ∪ {𝐴 ⊂ [𝑘] : |𝐴| ≥ 𝑘 − 𝑠 + 𝑡}.

)︀ : 𝐴 ∈ ℳ𝑖(𝑘, 𝑠, 𝑡)} = 𝒜𝑖(𝑘, 𝑠, 𝑡) for 𝑘 > 2𝑠 − 𝑡 and that ℳ𝑖(𝑘, 𝑠, 𝑡) is
)︀ : 𝐴 ∩

Note that {𝐴 ∈(︀[𝑘]
For fixed 𝑘, 𝑠, 𝑡 and 0 ≤ 𝑖 < 𝑠 − 𝑡 let us define the pair 𝒜𝑖 = {𝐴 ∈ (︀[𝑛]
Note that 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡) =(︀[2𝑠−𝑡]

𝑡-intersecting.
[𝑘] ∈ ℳ𝑖(𝑘, 𝑠, 𝑡)}, ℬ𝑖 = {[𝑘]}. Then these non-empty 𝑡-intersecting families are 𝑠-cross-
intersecting.

𝑘

𝑠

)︀. For 𝑖 = 𝑠 − 𝑡 we define
(︂[𝑛]
)︂
)︂
(︂[𝑛]

: |𝐴 ∩ [2𝑠 − 𝑡]| ≥ 𝑠}

: [2𝑠 − 𝑡] ⊂ 𝐵}.

𝑘

𝑘

𝑠

𝒜𝑠−𝑡 ={𝐴 ∈

ℬ𝑠−𝑡 ={𝐵 ∈

and

Again the non-empty 𝑡-intersecting families 𝒜𝑠−𝑡 and ℬ𝑠−𝑡 are 𝑠-cross-intersecting.

Theorem 8. Let 𝑘 > 𝑠 > 𝑡 ≥ 1 be integers, 𝑘 ≥ 2𝑠 − 𝑡. Suppose that 𝒜,ℬ ⊂ (︀[𝑛]

With this terminology we prove

non-empty 𝑡-intersecting families which are cross 𝑠-intersecting. Then for 𝑛 ≥ 𝑛0(𝑠, 𝑡, 𝑘) we
have

)︀ are

𝑘

(4)
Moreover, unless 𝑘 = 2𝑠, 𝑡 = 1 or 𝒜,ℬ are isomorphic to 𝒜𝑖,ℬ𝑖, the equality above transforms
into a strict inequality.

max𝒜,ℬ |𝒜| + |ℬ| = max
0≤𝑖≤𝑠−𝑡

|𝒜𝑖| + |ℬ𝑖|.

6

Remark The assumption 𝑘 ≥ 2𝑠 − 𝑡 is in fact not restricting, since if 𝐴 ∈ 𝒜 and 𝐵 ∈ ℬ
then any two sets from 𝒜 intersect in at least 2𝑠 − 𝑘 elements inside 𝐵 (and analogously for
ℬ and 𝐴). If this quantity is greater than 𝑡, we may enlarge 𝑡 so that the equality 𝑘 = 2𝑠− 𝑡
holds, and the considered families would remain 𝑡-intersected.
We also remark that the problem makes sense only in case 𝑠 > 𝑡. Otherwise, we just
take both 𝒜 and ℬ to be the same 𝑡-intersecting family of maximal cardinality. Thus, in
case 𝑡 ≥ 𝑠 the problem reduces to a trivial application of the Complete Intersection Theorem.

Finally, we prove the following generalization of the Hilton-Milner theorem. Define the

𝑘

family 𝒞 = {𝐶 ⊂(︀[𝑛]
Theorem 9. Let 𝑘 > 𝑠 ≥ 1 be integers. Suppose that 𝒜,ℬ ⊂(︀[𝑛]

)︀ : |𝐶 ∩ [𝑘]| ≥ 𝑠}.

intersecting families. Then for 𝑛 > 2𝑘 − 𝑠 we have

)︀ are non-empty 𝑠-cross-

𝑘

max𝒜,ℬ |𝒜| + |ℬ| = |𝒞| + 1.

(5)

We note that for 𝑛 ≥ 𝑛0(𝑘, 𝑡) the result of the theorem can be obtained using the same

proof as that of Theorem 8, although it is not stated explicitly.

4 Preliminaries

We start with the following auxiliary statement, which is of independent interest. We use
it in the proof of Theorem 9. Consider a bipartite graph 𝐻 with parts 𝑉1, 𝑉2 and a group
of automorphisms Γ, where Γ is acting on 𝑉1 and 𝑉2 but respects the parts (that is, ∀𝛾 ∈ Γ
and 𝑣 ∈ 𝑉𝑖 𝛾(𝑣) ∈ 𝑉𝑖 holds). Let 𝑇1, . . . , 𝑇𝑝 and 𝑆1, . . . , 𝑆𝑞 be the orbits of the action of Γ,
with 𝑉1 = 𝑇1 ⊔ . . . ⊔ 𝑇𝑝 and 𝑉2 = 𝑆1 ⊔ . . . ⊔ 𝑆𝑞.

Lemma 10. There exists an independent set 𝐼 in 𝐻 of maximal cardinality, such that for
any 𝑖 either 𝐼 ⊃ 𝑇𝑖 or 𝐼 ∩ 𝑇𝑖 = ∅ and for any 𝑗 either 𝐼 ⊃ 𝑆𝑗 or 𝐼 ∩ 𝑆𝑗 = ∅.

Make an auxiliary bipartite graph 𝑊 on the set of vertices {𝑇1, . . . , 𝑇𝑝} and {𝑆1, . . . , 𝑆𝑞}
and with edges between 𝑇𝑖 and 𝑆𝑗 iff there is at least one edge connecting a vertex of 𝑇𝑖 to
a vertex of 𝑆𝑗.
Let 𝐵 ⊂ 𝑉1 ∪ 𝑉2 be an independent set in 𝐻 and define 𝛽𝑖 = |𝐵 ∩ 𝑇𝑖|/|𝑇𝑖|, 𝛽𝑝+𝑗 =
|𝐵 ∩ 𝑆𝑗|/|𝑆𝑗| for 𝑖 = 1, . . . , 𝑝, 𝑗 = 1, . . . , 𝑞.

Claim 11. If there is an edge between 𝑇𝑖 and 𝑆𝑗 in 𝑊 then

𝛽𝑖 + 𝛽𝑝+𝑗 ≤ 1.

(6)

Proof. Just note that Γ is transitive on both 𝑇𝑖 and 𝑆𝑗. Therefore, 𝑇𝑖, 𝑆𝑗 induce a regular
(on each side) bipartite graph and (6) follows easily from Hall’s theorem.

7

We call any nonnegative vector (𝛽1, . . . , 𝛽𝑝+𝑞) satisfying (6) a fractional independent set.
Note that each vector corresponding to an independent set in 𝑊 is also a fractional inde-
pendent set.

size∑︀𝑝

𝑖=1 𝛽𝑖|𝑇𝑖| +∑︀𝑞

Proof of Lemma 10. We take a fractional independent set v = (𝛽1, . . . , 𝛽𝑝+𝑞) maximizing its

𝑗=1 𝛽𝑝+𝑗|𝑆𝑗| and among such the one minimizing |{𝑖 : 𝛽𝑖 ̸= 0}|.

Assume that there are coordinate positions of v that are neither 0 or 1 and let 𝜖 be the
minimum value among such positions. Consider the subgraph of 𝐻 that is spanned by the
orbits that correspond to the coordinates of v equal to 𝜖 and (1 − 𝜖).

Case 1. 𝜖 < 1/2. Define

𝑚𝜖

𝑑𝑒𝑓=

∑︁

∑︁
∑︁

𝛽𝑖=𝜖

|𝑇𝑖| +

|𝑆𝑗|

∑︁

𝛽𝑝+𝑗 =𝜖

|𝑇𝑖| +

and

|𝑆𝑗|.

𝑚1−𝜖

𝑑𝑒𝑓=

𝛽𝑖=1−𝜖

𝛽𝑝+𝑗 =1−𝜖

Assume 𝑚𝜖 > 𝑚1−𝜖. Suppose that max{𝛽𝑖 : 𝛽𝑖 < 1 − 𝜖} = 1 − 𝜖 − 𝜌 for some 𝜌 > 0.

Consider the vector

v′ = (𝛽′

1, . . . , 𝛽′

𝑝+𝑞),

𝛽′
𝑖 =

𝜖 + 𝜌,
1 − 𝜖 − 𝜌,

⎧⎪⎨⎪⎩𝛽𝑖,
⎧⎪⎨⎪⎩𝛽𝑖,

0,
1,

iff 𝛽𝑖 /∈ {𝜖, 1 − 𝜖},
iff 𝛽𝑖 = 𝜖,
iff 𝛽𝑖 = 1 − 𝜖.

iff 𝛽𝑖 /∈ {𝜖, 1 − 𝜖},
iff 𝛽𝑖 = 𝜖,
iff 𝛽𝑖 = 1 − 𝜖.

Then v′ is a fractional independent set for 𝐻 and it has a weight, which is bigger than the
weight of v by 𝜌(𝑚𝜖 − 𝑚1−𝜖), a contradiction.

Assume next that 𝑚𝜖 ≤ 𝑚1−𝜖. Consider the vector

v′′ = (𝛽′′

1 , . . . , 𝛽′′

𝑝+𝑞),

𝛽′′
𝑖 =

Then v′′ is a fractional independent set for 𝐻 and it has a weight not smaller than the weight
of v and that has less nonzero coordinates, a contradiction.

Case 2. 𝜖 = 1/2. Consider the subgraph of a weighted graph 𝑊 , formed by vertices
having weight 1/2. Note that there is no edge from them to the vertices having weight 1.
The weight that this subgraph is contributing to the fractional independent set is

∑︁

(︀ ∑︁
𝛽𝑝+𝑗 =1/2 |𝑆𝑗| is not smaller than 𝑚1/2. W.l.o.g. assume

|𝑆𝑗|)︀.

|𝑇𝑖| +

𝛽𝑝+𝑗 =1/2

𝛽𝑖=1/2

1
2

Is clear that one of ∑︀
that∑︀

𝑑𝑒𝑓=

𝑚1/2

𝛽𝑖=1/2 |𝑇𝑖|, ∑︀

𝛽𝑖=1/2 |𝑇𝑖| ≥ 𝑚1/2. Consider the vector

8

^v = ( ^𝛽1, . . . , ^𝛽𝑝+𝑞),

^𝛽𝑖 =

⎧⎪⎨⎪⎩𝛽𝑖,

0,
1,

iff 𝛽𝑖 ∈ {0, 1},
iff 𝑖 ≥ 𝑝 + 1, 𝛽𝑖 = 1/2,
iff 𝑖 ≤ 𝑝, 𝛽𝑖 = 1/2.

It is a vector, corresponding to an independent set in the graph 𝐻 of the desired type, and
it has weight at least as big as v.

In the proof of Theorem 5 we use two types of shifting. The first one pushes bigger
coordinates to the left. For a given pair of indices 𝑖 < 𝑗 ∈ [𝑛] and a vector v = (𝑣1, . . . , 𝑣𝑛) ∈
{0,±1}𝑛 we define an (𝑖, 𝑗)-shift 𝑆𝑖,𝑗(v) of v in the following way. If 𝑣𝑖 ≥ 𝑣𝑗, then 𝑆𝑖,𝑗(v) = v.
If 𝑣𝑖 < 𝑣𝑗, then 𝑆𝑖,𝑗(v) = (𝑣1, . . . , 𝑣𝑖−1, 𝑣𝑗, 𝑣𝑖+1, . . . , 𝑣𝑗−1, 𝑣𝑖, 𝑣𝑗+1, . . . , 𝑣𝑛), that is, it is obtained
from v by interchanging its 𝑖-th and 𝑗-th coordinate.

Next, we define an (𝑖, 𝑗)-shift 𝑆𝑖,𝑗(𝒲) of a family of vectors 𝒲 ⊂ {0,±1}𝑛:

𝑆𝑖,𝑗(𝒲) = {𝑆𝑖,𝑗(v) : v ∈ 𝒲} ∪ {v : v, 𝑆𝑖,𝑗(v) ∈ 𝒲}.

The second is the up-shift: 𝑆𝑖(𝑣1, . . . , 𝑣𝑛) = (𝑣1, . . . , 𝑣𝑛) if 𝑣𝑖 = 0 or 1 and 𝑆𝑖(𝑣1, . . . , 𝑣𝑛) =

(𝑣1, . . . , 𝑣𝑖−1, 1, 𝑣𝑖+1, . . . , 𝑣𝑛) if 𝑣𝑖 = −1. The shift 𝑆𝑖(𝒲) is defined similarly to 𝑆𝑖,𝑗(𝒲):

𝑆𝑖(𝒲) = {𝑆𝑖(v) : v ∈ 𝒲} ∪ {v : v, 𝑆𝑖(v) ∈ 𝒲}.

We call a system 𝒲 shifted, if 𝒲 = 𝑆𝑖,𝑗(𝒲) for all 𝑖 < 𝑗 ∈ [𝑛] and 𝒲 = 𝑆𝑖(𝒲) for
all 𝑖 ∈ [𝑛]. Any system of vectors may be made shifted by means of a finite number of
(𝑖, 𝑗)-shifts and 𝑖-up-shifts. Moreover, it was shown in [7] and [13] (and is easy to verify
directly) that (𝑖, 𝑗)-shifts and up-shifts do not decrease the minimal scalar product in 𝒲.

5 Proof of Theorems 5 and 6

Part 1 of Theorem 5

First we show that there is such a family of vectors for which the inequality is achieved. We
take the set of vectors 𝒱 = {v = (𝑣1, . . . , 𝑣𝑛) : 𝑣1 = . . . = 𝑣𝑙 = 1, 𝑣𝑖 ∈ {0, 1}}. It clearly
satisfies the condition ⟨v, w⟩ ≥ 𝑙 for any v, w ∈ 𝒱 and has the desired cardinality.

We proceed to the upper bound. Take any family 𝒱 of {0,±1}-vectors having minimal

scalar product at least 𝑙 and define its subfamilies 𝒱𝑖(𝜖) = {w ∈ 𝒱 : 𝑤𝑖 = 𝜖} for 𝜖 = ±1.
Claim 12. If for some 𝑖 both 𝒱𝑖(−1) and 𝒱𝑖(1) are nonempty, then

(︂𝑘 − 1

)︂(︂𝑛 − 𝑙 − 2
)︂

𝑘 − 𝑙 − 2

= 𝑂(𝑛𝑘−𝑙−2).

|𝒱𝑖(1)| + |𝒱𝑖(−1)| ≤ 2𝑘

We call any such 𝑖 ∈ [𝑛] bad.

𝑙 + 1

9

Proof. Consider the set families 𝒜+ = {𝑆 ∈ (︀[𝑛]−{𝑖}
{𝑖}} and 𝒜− = {𝑆 ∈ (︀[𝑛]−{𝑖}
Let 𝐴 ∈ 𝒜+, 𝐵 ∈ 𝒜−. Then |𝐴 ∩ 𝐵| ≥ 𝑙 + 1 for all 𝐵 ∈ 𝒜− implies |𝒜−| ≤(︀|𝐴|
and similarly |𝒜+| ≤(︀|𝐵|

)︀ : ∃w ∈ 𝒱𝑖(1) such that 𝑆(w) = 𝑆 ∪
)︀ : ∃w ∈ 𝒱𝑖(−1) such that 𝑆(w) = 𝑆 ∪ {𝑖}}. Both 𝒜+,𝒜−
)︀
)︀(︀𝑛−𝑙−2
)︀(︀𝑛−𝑙−2
)︀.

are nonempty. Each of them is (𝑙 − 1)-intersecting, moreover, they must be (𝑙 + 1)-cross-
intersecting, since otherwise we would have two vectors in 𝒱 that have scalar product at
most 𝑙 − 1.

𝑘−𝑙−2
The statement of the claim follows from the trivial inequalities |𝒱𝑖(1)| ≤ 2𝑘−1|𝒜+|,

𝑘−𝑙−2

𝑘−1

𝑘−1

𝑙+1

𝑙+1

|𝒱𝑖(−1)| ≤ 2𝑘−1|𝒜−|.

𝒱𝑔 = 𝒱−𝒱𝑏. Since 𝒱𝑔 is homogeneous on [𝑛]−𝐼 and is 𝑙-intersecting, we have |𝒱𝑔| ≤(︀𝑛−|𝐼|−𝑙

Consider the set 𝐼 ⊂ [𝑛] of all bad coordinate positions and define a subfamily 𝒱𝑏 of all
vectors that have non-zero values on the bad positions: 𝒱𝑏 = {v ∈ 𝒱 : ∃𝑖 ∈ 𝐼 : 𝑣𝑖 ̸= 0}. Put
for 𝑛 ≥ 𝑘2 due to the result of [3]. Therefore,

)︀

𝑘−𝑙

|𝒱| ≤

)︂
(︂𝑛 − |𝐼| − 𝑙
− |𝐼|(︁(︂𝑛 − |𝐼| − 𝑙
)︂

𝑘 − 𝑙

𝑘 − 𝑙 − 1

)︂

(︂𝑛 − 𝑙

𝑘 − 𝑙

≤

+ |𝐼|𝑂(𝑛𝑘−𝑙−2) ≤

− 𝑂(𝑛𝑘−𝑙−2)

)︁ ≤

(︂𝑛 − 𝑙

𝑘 − 𝑙

)︂

,

for 𝑛 large enough, with the last inequality strict in case |𝐼| > 0.

𝑘

Part 2 of Theorem 5 and Theorem 6

each 𝑆 ⊂(︀𝑛

)︀ we take in 𝒱 all the vectors from ℒ𝑘(𝑆) that have at most 𝑙/2 −1’s in case 𝑙

First we show that there is such a family of vectors for which the inequality is achieved. For
is even and the sets that have at most (𝑙 − 1)/2 −1’s among the first (𝑘 − 1) nonzero coor-
dinates in case 𝑙 is odd (in other words, take the families of vectors w whose corresponding
sets 𝑁 (w) duplicate the examples 𝒰 𝑙, 𝒰 𝑙
𝑘 from the formulation of Katona’s Theorem). It is
not difficult to see that 𝒱 satisfies the requirements of both Theorems 5 and 6 on the size
and on the scalar product.

Now we prove the upper bound. The proof is somewhat similar to the previous case.
Take any vector family satisfying the conditions of Theorem 5 or Theorem 6. For any set
𝑋 ⊂ [𝑛] and any vector w of length 𝑛 denote by w|𝑋 the restriction of w to the coordinates
𝑖, 𝑖 ∈ 𝑋. Obviously w|𝑋 is a vector of length |𝑋|. We look at all vectors v ∈ {±1}𝑙+1 and
split them into groups of antipodal vectors v, ¯v, that is, vectors that satisfy ⟨v, ¯v⟩ = −𝑙− 1.
Fix a set of coordinates 𝐼 = {𝑖1, . . . , 𝑖𝑙+1} and define 𝒱(𝐼, v) = {w ∈ 𝒱 : w|𝐼 = v}.
Claim 13. If both 𝒱(𝐼, v) and 𝒱(𝐼, ¯v) are nonempty, then

(︂𝑛 − 𝑙 − 2
)︂

𝑘 − 𝑙 − 2

= 𝑂(𝑛𝑘−𝑙−2).

|𝒱(𝐼, v)| + |𝒱(𝐼, ¯v)| ≤ 2𝑘−𝑙−1(𝑘 − 𝑙)

10

such “bad” subfamilies is 𝑂(𝑛𝑘−1).

We call any such 𝐼 bad. In particular, the claim gives that the total cardinality of all

Proof. Consider the set families 𝒜 = {𝑆 ∈(︀ [𝑛]−𝐼
and ¯𝒜 = {𝑆 ∈(︀ [𝑛]−𝐼
(︂ 𝑛 − 𝑘

)︀ : ∃w ∈ 𝒱(𝐼, v) such that 𝑆(w) = 𝑆 ∪ 𝐼}
)︀ : ∃w ∈ 𝒱(𝐼, ¯v) such that 𝑆(w) = 𝑆 ∪ 𝐼}. Both 𝒜, ¯𝒜 are nonempty.
)︂
(︂𝑛 − 𝑙 − 1
)︂

Moreover, they must be cross-intersecting, since otherwise we would have two vectors in 𝒱
that have scalar product exactly −𝑙 − 1. Therefore, by Hilton-Milner theorem,

(︂𝑛 − 𝑙 − 2
)︂

𝑘−𝑙−1

𝑘−𝑙−1

𝑘 − 𝑙 − 2

.

|𝒜| + | ¯𝒜| ≤

𝑘 − 𝑙 − 1

𝑘 − 𝑙 − 1

−

+ 1 ≤ (𝑘 − 𝑙)

The statement of the claim follows from the trivial inequalities |𝒱(𝐼, v)| ≤ 2𝑘−𝑙−1|𝒜|, |𝒱(𝐼, ¯v)| ≤
2𝑘−𝑙−1| ¯𝒜|.

Define 𝒱𝑏 = {w ∈ 𝒱 : ∃𝐼 ⊂(︀ [𝑛]
we fix 𝑆 ∈(︀[𝑛]

)︀ : 𝒱(𝐼, v|𝐼) ̸= ∅,𝒱(𝐼, ¯v|𝐼) ̸= ∅}. Consider the remaining
)︀ and consider the family of sets 𝒜 = {𝑁 (w) : 𝑤 ∈ 𝒱𝑔(𝑆)}, then 𝒜 satisfies

First we finish the proof of Theorem 6. The family 𝒱𝑔 is good in the following sense. If

family of “good vectors” 𝒱𝑔 = 𝒱 − 𝒱𝑏.

𝐴1 △ 𝐴2 ≤ 𝑙 for any 𝐴1, 𝐴2 ∈ 𝒜. Therefore, |𝒱𝑔(𝑆)| ≤ 𝑓 (𝑘, 𝑙) by Kleitman’s theorem and

𝑙+1

𝑘

|𝒱| ≤ ∑︁

𝑆∈([𝑛]
𝑘 )

𝑓 (𝑘, 𝑙) + |𝒱𝑏| = 𝑓 (𝑘, 𝑙)

+ 𝑂(𝑛𝑘−1).

(︂𝑛
)︂

𝑘

The proof of Theorem 6 is complete.
From now on we suppose that the family 𝒱 is shifted. Note that, since shifting may
increase scalar products, it is impossible to use it in the case of Theorem 6. It is not difficult
to see that the family 𝒱𝑏 is up-shifted, since if we deleted some w ∈ 𝒱, then we would have
deleted all u ∈ 𝒱 with 𝑆(u) = 𝑆(w), 𝑁 (u) ⊃ 𝑁 (w). One can see in a similar way that 𝒱𝑏 is
shifted.

)︀ the family 𝒱𝑔(𝑆) satisfies 𝑁 (w) ∪ 𝑁 (v) ≤ 𝑙 for all v, w ∈

Claim 14. For every 𝑆 ∈(︀[𝑛]

𝒱𝑔(𝑆).
Proof. Suppose for contradiction 𝑁 (w)∪ 𝑁 (u) ≥ 𝑙 + 1. Consider any set 𝐼 ⊂ 𝑁 (w)∪ 𝑁 (u),
|𝐼| = 𝑙 + 1. Since 𝒱𝑔 is up-shifted, there is a vector u′ in 𝒱𝑔(𝑆) such that ⟨w|𝐼, u′
|𝐼⟩ = −𝑙 − 1,
which means that for v = w|𝐼 both 𝒱𝑔(𝐼, v) and 𝒱𝑔(𝐼, ¯v) are nonempty, a contradiction.

𝑘

Claim 15. If 𝐼 ⊂(︀ [𝑛]

)︀ is bad, then for any 𝑆 ⊃ 𝐼, 𝑆 ∈(︀[𝑛]

)︀, we have |𝒱𝑔(𝑆)| ≤ 𝑓 (𝑘, 𝑙) − 1.

𝑙+1

𝑘

Proof. Consider the family 𝒜 ⊂ 2𝑆 of subsets of 𝑆, that is defined in the following way:
𝒜 = {𝑁 (w) ∩ 𝑆 : w ∈ 𝒱𝑔(𝑆)}. For simplicity, we identify 𝑆 with [𝑘], preserving the order of
elements. In view of the uniqueness part of Katona’s theorem, it is sufficient to show that
𝒜 does not contain one of the sets from the extremal families: from 𝒰 𝑙 in case 𝑙 is even and
from any of 𝒰 𝑙

𝑖 , 𝑖 = 1, . . . , 𝑘 in case 𝑙 is odd.

11

First consider the case when 𝑙 is even. If 𝐼 is bad, it means that there exists a vector
v of length 𝑙 + 1, such that both 𝒱(𝐼, v),𝒱(𝐼, ¯v) are nonempty. Therefore, all vectors from
these families are not present in 𝒱𝑔. Assume w.l.o.g. that |𝑁 (v)| ≤ 𝑙/2. Then the set 𝑁 (v)
is not present in 𝒜, but at the same time it belongs to 𝒰 𝑙.
From now on, assume that 𝑙 is odd. We remark that, due to the fact that 𝒱𝑔 is shifted,
the family 𝒜 is shifted to the right, and, therefore, out of the extremal families 𝒜 may
𝑘 only. We argue similarly to the previous case. If |𝑁 (v)| ≤ (𝑙 − 1)/2 or
coincide with 𝒰 𝑙
|𝑁 (¯v)| ≤ (𝑙 − 1)/2, then we are done as in the previous case. The only remaining case is
when |𝑁 (v)| = (𝑙 + 1)/2. If 𝑘 ∈ 𝐼, then we are done again: one of 𝑁 (v), 𝑁 (¯v) then contains
𝑘 and therefore belongs to 𝒰 𝑙
𝑘.
Suppose from now on that 𝑘 /∈ 𝐼. Fix some 𝑖 ∈ 𝑁 (v) and take any w ∈ 𝒱 such that
w|𝐼 = ¯v. Since 𝒱 is shifted, there is a vector u ∈ 𝒱 such that u|𝐼−{𝑖} = w|𝐼−{𝑖}, 𝑢𝑘 = 1.
Assume that 𝒜 contains the set 𝑁′ = 𝑁 (v) − {𝑖} ∪ {𝑘}, and take v′ ∈ 𝒱𝑔(𝑆) such that
𝑁 (v′) = 𝑁′. Then, putting 𝐼′ = 𝐼 − {𝑖} ∪ {𝑘}, we get that both 𝒱(𝐼′, v′) and 𝒱(𝐼′, ¯v′) are
nonempty: the first family due to the assumption that 𝑁′ ∈ 𝒜, and the second one due to
the fact that u|𝐼′ = ¯v′. Therefore, 𝑁′ /∈ 𝒜. But 𝑁′ ∈ 𝒰 𝑙
𝑘, and thus 𝒜 does not coincide with
𝒰 𝑙
𝑘.

Assume now that there are 𝑡 bad sets 𝐼 ⊂(︀ [𝑛]
)︀. Then the number of sets 𝑆 ⊂(︀[𝑛]
contain one of the bad sets 𝐼 is at least 𝑡(︀𝑛−𝑙−1
)︀/(︀ 𝑘
)︀. Therefore, we have
(︀𝑛−𝑙−1
)︀
∑︁
∑︁
)︀ +
(︀ 𝑘
(︁(︀𝑛−𝑙−1
)︀
(︂𝑛 − 𝑙 − 2
)︂)︁
(︀ 𝑘
)︀ − 2𝑘(𝑘 − 𝑙)
)︀. We remark that taking 𝑛 > 4𝑘𝑘2 makes the choice of 𝑛 from

provided 𝑛 > 2𝑘𝑘2(︀ 𝑘

|𝒱(𝐼, v)| + |𝒱(𝐼, ¯v)| ≤

)︀ that

|𝒱| − 𝑓 (𝑘, 𝑙)

≤ −𝑡

𝑘−𝑙−1

(︂𝑛

)︂

𝑘

𝑘 − 𝑙 − 2

𝑙+1

𝑘−𝑙−1

𝑙+1

𝑙+1

𝑣∈{±1}𝑙+1

bad 𝐼

≤ −𝑡

𝑘−𝑙−1

𝑙+1

𝑘

1
2

< 0,

which the proof works independent of 𝑙.

𝑙+1

6 Proof of Theorem 7
Let 𝒲 ⊂ {0,±1}𝑛 satisfy ⟨w, w⟩ = 3, ⟨w, v⟩ ≥ 0 for all w, v ∈ 𝒲 and suppose that 𝒲 is
shifted.
Claim 16. If 𝑆(w) = (𝑎, 𝑏, 𝑐) for w ∈ 𝒲 then either w = u(𝑎, 𝑏, 𝑐) or w = v(𝑎, 𝑏, 𝑐) holds.

Proof. Assume the contrary and let (𝑥, 𝑦, 𝑧) be the non-zero coordinate values of the vector
w (at positions 𝑎, 𝑏, 𝑐). Using the up-shift w.l.o.g. (𝑥, 𝑦, 𝑧) = (−1, 1, 1) or (1,−1, 1). In both
cases by shifting (1, 1,−1) is also in 𝒲. However it has scalar product −1 with both, a
contradiction.

12

From the claim 𝐹 (3, 3, 0) ≤ 2, and 𝐹 (4, 3, 0) ≤(︀4
Set 𝒢 = {(𝑎, 𝑏) ∈ (︀[𝑛−1]
ℋ is non-empty, since otherwise |𝒲| ≤(︀𝑛

)︀ × 2 = 8 follow.
)︀ : u(𝑎, 𝑏, 𝑛) ∈ 𝒲}, ℋ = {(𝑎, 𝑏) ∈ (︀[𝑛−1]
)︀ holds due to shiftedness.

From now on 𝑛 ≥ 5 and we use induction on 𝑛 to prove the statement of the theorem.
shiftedness ℋ ⊂ 𝒢 and by ⟨v, w⟩ ≥ 0, 𝒢 and ℋ are cross-intersecting. We may assume that

)︀ : v(𝑎, 𝑏, 𝑛) ∈ 𝒲}. By

2

3

2

Claim 17. If v(2, 3, 𝑛) ∈ 𝒲 then |ℋ| = |𝒢| = 3.
Proof. By shiftedness {(1, 2), (1, 3), (2, 3)} ⊂ ℋ ⊂ 𝒢. The statement follows from the fact
that no other 2-element set can intersect those three sets.

3

Since 𝒲(¯𝑛) 𝑑𝑒𝑓= {w ∈ 𝒲 : 𝑤𝑛 = 0} satisfies |𝒲(¯𝑛)| ≤ 𝐹 (𝑛 − 1, 3, 0), v(2, 3, 𝑛) ∈ 𝒲 and

Claim 17 imply

|𝒲| ≤ 𝐹 (𝑛 − 1, 3, 0) + 6,
|𝒲| ≤ 8 + 6 = 14
|𝒲| ≤ 14 + 6 < 21
|𝒲| ≤

(︂𝑛 − 1
)︂

+ 6 <

(︂𝑛

3

3

which gives
for 𝑛 = 5,
for 𝑛 = 6, and
for 𝑛 ≥ 7.

)︂

Consequently, we may suppose that the degree of 𝑛 in 𝒲 is at least 7, in particular, ℋ is
the star, ℋ = {(1, 2), (1, 3), . . . , (1, 𝑝)} for some 𝑝 ≤ 𝑛 − 1.

The following lemma is obvious.

𝑝 = 2, |ℋ| = 1, |𝒢| ≤ (𝑛 − 2) + (𝑛 − 3) = 2𝑛 − 5

Lemma 18. One of the following holds.
(i)
(ii) 𝑝 = 3, |ℋ| = 2, |𝒢| ≤ (𝑛 − 2) + 1 = 𝑛 − 1
(iii) 𝑝 ≥ 4, |ℋ| ≤ |𝒢| ≤ 𝑛 − 2.

for 𝑛 ≥ 7, the induction step works fine in this case too.

Since for 𝑛 = 5 in all cases |ℋ| +|𝒢| ≤ 6 holds, the proof of part (1) of Theorem 7 is com-

plete. Also, for 𝑛 ≥ 7 it follows that |ℋ| + |𝒢| ≤ 2𝑛 − 4. Since(︀𝑛
Define ℬ = {(𝑏, 𝑐) ∈ (︀[2,6]

)︀ −(︀𝑛−1
)︀ =(︀𝑛−1
)︀ > 2𝑛 − 4
)︀ : u(𝑎, 𝑏, 𝑐) ∈
)︀ : v(1, 𝑏, 𝑐) ∈ 𝒲} and 𝒟 = {(𝑑, 𝑒, 𝑓 ) ∈ (︀[2,6]

v(𝑎, 𝑏, 𝑛) ∈ 𝒲 it follows that 𝑎 = 1 holds for all (𝑎, 𝑏, 𝑐) with v(𝑎, 𝑏, 𝑐) ∈ 𝒲.
𝒲}. Note that (𝑏, 𝑐) ∈ ℬ and 𝐷 ∈ 𝒟 cannot satisfy 𝐷 ∩ {𝑏, 𝑐} = {𝑐}, since otherwise
⟨u(𝑑, 𝑒, 𝑓 ), v(1, 𝑏, 𝑐)⟩ = −1. Let us note that one can put into 𝒲 all the vectors u(1, 𝑏, 𝑐)
with 2 ≤ 𝑏 < 𝑐 ≤ 6 because all the vectors with a −1 position have 1 in the first coordinate.

The only case that remains is 𝑛 = 6. Using shiftedness and 𝑎 = 1 for all (𝑎, 𝑏, 𝑛) with

2

3

3

3

2

Therefore |𝒲| = 10 + |ℬ| + |𝒟| holds. We have to prove

|ℬ| + |𝒟| ≤ 11.

(7)

Let us first exhibit the system with 21 vectors showing 𝐹 (6, 3, 0) ≥ 21.
𝒰6 = {u(1, 𝑏, 𝑐), v(1, 𝑏, 𝑐) : (𝑏, 𝑐) ⊂ [2, 6]} ∪ {u(2, 3, 4)}.

13

⟨v(1, 𝑏, 𝑐), u(2, 3, 4)⟩ ≥ 0.
𝑏 ∈ {2, 3} making the scalar product equal to 0 as desired.

2

We have |𝒰6| = 2 ×(︀5
element set {𝐷 ∈(︀[2,6]

)︀ + 1 = 21 and the only non-trivial scalar product to check is that
)︀ : 𝐷 ̸= (2, 3, 4)} into the 10-element set {(𝑏, 𝑐) : 2 ≤ 𝑏 < 𝑐 ≤ 6} such

It is true automatically if 𝑐 ≥ 5. For 𝑐 = 3, 4 it follows that

To avoid a tedious case by case analysis it is simplest to give a matching from the 9-
that whenever 𝐷 and (𝑏, 𝑐) are matched, 𝐷 ∩ (𝑏, 𝑐) = {𝑐} holds. This will prove (7). An
example of the desired matching is exhibited below.

3

(2, 3, 5) − (4, 5)
(2, 4, 6) − (5, 6)
(3, 4, 6) − (2, 4)

(2, 4, 5) − (3, 5)
(2, 5, 6) − (3, 6)
(3, 5, 6) − (2, 5)

(2, 3, 6) − (4, 6)
(3, 4, 5) − (2, 3)
(4, 5, 6) − (2, 6)

A careful analysis shows that 𝒰6 is the only extremal configuration. The proof is complete.

7 Proof of Theorem 8
We may assume that the families 𝒜,ℬ are shifted and, thus, both contain [𝑘]. We define
𝒜(𝑇 ) = {𝐴∖𝑇 : 𝐴 ∈ 𝒜, 𝐴 ⊃ 𝑇}. Note that we had a similar notation for families of vectors,
but now we are working with sets only, so it should not cause any confusion. We call a set

)︀ a kernel for a set family 𝒮, if 𝒮(𝑇 ) contains 𝑘 + 1 pairwise disjoint edges. An

𝑇 ∈ (︀[𝑛]

𝑠

inequality proved in [5] states that

(︂𝑛 − 𝑠 − 1
)︂

𝑘 − 𝑠 − 1

,

|𝒜(𝑇 )| ≤ 𝑘

(8)

if 𝑇 is not a kernel for 𝒜, and similarly for ℬ(𝑇 ).

The following claim is an easy application of the pigeon-hole principle.

Claim 19. Suppose that 𝐶0, . . . , 𝐶𝑘 form a sunflower with center 𝑇 , i.e. 𝐶𝑖 ∩ 𝐶𝑗 = 𝑇 for all
0 ≤ 𝑖 < 𝑗 ≤ 𝑘. Suppose 𝐷 is a 𝑘-element set. Then there exists an 𝑖 such that 𝐷∩𝐶𝑖 = 𝐷∩𝑇
holds.

We immediately get the following corollary:

Corollary 20. If |𝑇| = 𝑠 and |𝐷 ∩ 𝐶𝑖| ≥ 𝑠 for all 0 ≤ 𝑖 ≤ 𝑘, then 𝑇 ⊂ 𝐷.
Lemma 21. If 𝑇1 and 𝑇2 are kernels for 𝒜 and ℬ respectively, then 𝑇1 = 𝑇2 holds.
Proof. From Corollary 20 it follows that for any 𝐵 ∈ ℬ we have 𝑇1 ⊂ 𝐵. Applying it for
𝐵1, 𝐵2 ∈ ℬ, 𝐵1 ∩ 𝐵2 = 𝑇2, we get that 𝑇1 ⊂ 𝐵1 ∩ 𝐵2 = 𝑇2, but since |𝑇1| = |𝑇2|, we have
𝑇1 = 𝑇2.

|𝒜| + |ℬ| ≤ 2(︀𝑛−𝑠
any kernel of 𝒜 must be a subset of [𝑘]. Let 𝒥 ⊂(︀[𝑘]

)︀, which is smaller then the bound in (4). From now on we may w.l.o.g.
)︀ be the family of kernels of 𝒜. Define

From Corollary 20 and Lemma 21 it follows that if both 𝒜 and ℬ have kernels, then
assume that ℬ does not have a kernel and that ℬ contains the set [𝑘] as an element. Then
˜𝒜 = {𝐴 ∈ 𝒜 : (cid:64)𝑇 ∈ 𝒥 , 𝐴 ⊃ 𝑇}.

𝑘−𝑠

𝑠

14

Claim 22. We have | ˜𝒜| = 𝑂(𝑛𝑘−𝑠−1). Analogously, we have |ℬ| = 𝑂(𝑛𝑘−𝑠−1).

Proof. Any set from ˜𝒜 must intersect [𝑘] in at least 𝑠 elements. Thus, | ˜𝒜| ≤∑︀
which by inequality (8) is at most (︀[𝑘]

)︀ = 𝑂(𝑛𝑘−𝑠−1). The same proof works for
𝑠 ) | ˜𝒜(𝑇 )|,

)︀𝑘(︀𝑛−𝑠−1

𝑇∈([𝑘]

𝑠

𝑘−𝑠−1

ℬ.

Due to Claim 19 and the fact that 𝒜 is 𝑡-intersecting, for any set 𝐴 ∈ 𝒜 and any 𝑇 ∈ 𝒥
we have |𝐴 ∩ 𝑇| ≥ 𝑡. Moreover, repeating the proof of Lemma 21, it is easy to see that for
any 𝑇1, 𝑇2 ∈ 𝒥 we have |𝑇1 ∩ 𝑇2| ≥ 𝑡. Therefore, |𝒥 | ≤ 𝑚(𝑘, 𝑠, 𝑡) (see the formulation of the
Complete Intersection Theorem). Due to Claim 22, we have

(︂𝑛 − 𝑘

)︂

|𝒜| + |ℬ| ≤ |𝒥 |

+ 𝑂(𝑛𝑘−𝑠−1).

𝑘

𝑘−𝑠

𝑘 − 𝑠

)︀. For that

)︀ : ∃𝑇 ∈ 𝒥 ′ : 𝐴 ∩ [𝑘] = 𝑇}.

and is 𝑠-cross-intersecting with {[𝑘]}, and which has cardinality 𝑚(𝑘, 𝑠, 𝑡)(︀𝑛−𝑘
𝒜 = {𝐴 ∈(︀[𝑛]

(9)
Indeed, the only additional thing one has to note is that the number of sets from 𝒜 that
intersect [𝑘] in at least 𝑠 + 1 elements is 𝑂(𝑛𝑘−𝑠−1).
On the other hand, it is easy to exhibit an example of a family 𝒜 that is 𝑡-intersecting
one just has to take a maximum 𝑡-intersecting family 𝒥 ′ of 𝑠-element sets in [𝑘] and put
Therefore, if |𝒥 | < 𝑚(𝑘, 𝑠, 𝑡), then by (9) and the previous construction |𝒜| +|ℬ| cannot
be maximal for large 𝑛. Therefore, from now on we may assume that 𝒥 = 𝒜𝑖(𝑘, 𝑠, 𝑡) for
some 0 ≤ 𝑖 ≤ 𝑠 − 𝑡, where |𝒜𝑖(𝑘, 𝑠, 𝑡)| = 𝑚(𝑘, 𝑠, 𝑡).
We remark that out of 𝒜𝑗(𝑘, 𝑠, 𝑡) the only family that satisfies |𝒜𝑗(𝑘, 𝑠, 𝑡)| = |𝒜𝑗(𝑘 +
1, 𝑠, 𝑡)| is the family 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡).
Indeed, it consists of all the sets that have all their 𝑠
elements among the first 2𝑠 − 𝑡 elements and does not use elements 𝑗 with 𝑗 > 2𝑠 − 𝑡. For
all the other families, as we have already mentioned, the degree of each 𝑗 ∈ [𝑘] is positive.
Suppose first that 0 ≤ 𝑖 < 𝑠− 𝑡 and that |𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡)| < 𝑚(𝑘, 𝑠, 𝑡). Most importantly for
us, it means that 𝑚(𝑘 − 1, 𝑠, 𝑡) < 𝑚(𝑘, 𝑠, 𝑡) due to the discussion in the previous paragraph.
Then it is easy to see that |ℬ| = 1. Indeed, if 𝐵1, 𝐵2 ∈ ℬ, then due to Corollary 20 we know
that 𝑇 ⊂ 𝐵1 ∩ 𝐵2 for each 𝑇 ∈ 𝒥 . Since |𝐵1 ∩ 𝐵2| ≤ 𝑘 − 1, we have |𝒥 | ≤ 𝑚(𝑘 − 1, 𝑠, 𝑡) <
𝑚(𝑘, 𝑠, 𝑡).
We showed that the extremal pair of families satisfies ℬ = {[𝑘]}. To complete the proof
in this case and to show that the pair of extremal families is one of 𝒜𝑖,ℬ𝑖 for 0 ≤ 𝑖 < 𝑠 − 𝑡,
we have to verify that {𝐴 ∩ [𝑘] : 𝐴 ∈ 𝒜} ⊂ ℳ𝑖(𝑘, 𝑠, 𝑡) provided that 𝒥 = 𝒜𝑖(𝑘, 𝑠, 𝑡).
Take any set 𝐴 such that 𝐴 /∈ ℳ𝑖(𝑘, 𝑠, 𝑡), that is, |𝐴∩[𝑘]| < 𝑘−𝑠+𝑡 and |𝐴∩[𝑡+2𝑖]| < 𝑡+𝑖.
The following claim completes the proof in the case 𝑚(𝑘, 𝑠, 𝑡) is attained on ℳ𝑖(𝑘, 𝑠, 𝑡) with
𝑖 < 𝑠 − 𝑡.
Claim 23. In the notations above, there is 𝑇 ∈ 𝒥 = 𝒜𝑖(𝑘, 𝑠, 𝑡) such that |𝑇 ∩ 𝐴| ≤ 𝑡 − 1.
Proof. W.l.o.g., let 𝐴 = [1, 𝑙] ∪ [𝑚 + 1, 𝑘], where 𝑙 ≤ 𝑡 + 𝑖 − 1 and 𝑙 + 𝑚 < 𝑘 − 𝑠 + 𝑡. Set
𝑇 = [𝑙′, 𝑙′ + 𝑠 − 1] with 𝑙′ ≤ 𝑖 + 1 and with 𝑙′ chosen in such a way that |𝑇 ∩ 𝐴| is minimized.
It is easy to see that, first, 𝑇 ∈ 𝒥 and, second, |𝒯 ∩ 𝐴| = max{𝑙 − 𝑖, 𝑙 + 𝑚 + 𝑠 − 𝑘} < 𝑡.

15

If the only maximal family is 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡), then 𝒥 = 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡) and 𝒜 cannot contain
a set 𝐴 that satisfy |𝐴 ∩ [2𝑠 − 𝑡]| < 𝑠. Indeed, then 𝐴 intersects one of the 𝑇 ∈ 𝒥 in less
than 𝑡 elements, which by Claim 19 means that there exists 𝐴′ ∈ 𝒜 such that |𝐴′ ∩ 𝐴| < 𝑡,
a contradiction. Therefore, the family 𝒜 is contained in 𝒜𝑠−𝑡, and we are only left to prove
that ℬ ⊂ ℬ𝑠−𝑡. Assume that ℬ contains 𝐵, such that 𝐵 (cid:43) [2𝑠 − 𝑡]. But then there is 𝑇 ∈ 𝒥
such that |𝐵 ∩ 𝑇| ≤ 𝑠 − 1, a contradiction.

The last case that remains to verify is when both 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡) and 𝒜𝑠−𝑡−1(𝑘, 𝑠, 𝑡) have
size 𝑚(𝑘, 𝑠, 𝑡). But either 𝒥 = 𝒜𝑠−𝑡−1(𝑘, 𝑠, 𝑡) or 𝒥 = 𝒜𝑠−𝑡(𝑘, 𝑠, 𝑡) and we end up in one of
the two scenarios described above.

It is clear from the proof that the families that we constructed are the only possible
extremal families (excluding the case 𝑛 = 2𝑘, 𝑠 = 1), which is mostly due to the uniqueness
in the formulation of the Complete Intersection Theorem.

8 Proof of Theorem 9

We recall that 𝒞 = {𝐶 ⊂ (︀[𝑛]

)︀ : |𝐶 ∩ [𝑘]| ≥ 𝑠}. W.l.o.g. we assume that 𝒜,ℬ are shifted

and thus both contain [𝑘]. It is obvious that in any case |𝒜| + |ℬ| ≤ 2|𝒞|, since 𝒜,ℬ ⊂ 𝒞.
Consider a bipartite graph 𝐺 = (𝒞 − {[𝑘]},𝒞 − {[𝑘]}, 𝐸) with two copies 𝒞1,𝒞2 of 𝒞 − {[𝑘]}
as parts and with two sets 𝐶1, 𝐶2 ∈ 𝒞 from different parts being connected by an edge if and
only if |𝐶1 ∩ 𝐶2| < 𝑠. Our goal is to show that the maximum independent set in 𝐺 has size
|𝒞| − 1. Indeed, it is clear that |𝒜 − {[𝑘]}| + |ℬ − {[𝑘]}| ≤ 𝛼(𝐺) and in that case we get the
desired bound |𝒜| + |ℬ| ≤ |𝒞| + 1.

𝑘

One way to show that 𝐺 does not have independent sets larger than its parts is to exhibit
a perfect matching in 𝐺. We were unable to do it in general. We are going to circumvent
this problem by doing something different. We cover the vertices of a certain weighted graph
directly related to 𝐺 by disjoint edges and paths of even vertex length in such a way that
the total weight of any independent set in any of these graphs is at most half of the total
weight of the set of vertices of that subgraph.

We consider the following group of isomorphisms Γ, acting on [𝑛] (and on the vertex set
of 𝐺). Γ is a product of two groups, one consists of all permutations of [𝑘] and the other one
consists of all permutations of [𝑘 + 1, 𝑛]. Each of the parts of 𝐺 splits into orbits 𝒞𝑗
𝑖 , where
𝑗 = 1, 2 and corresponds to the number of the part, and 𝑖 = 𝑠, . . . , 𝑘 − 1 and indicates the
𝑖 with [𝑘]: 𝒞𝑗
size of the intersection of sets from 𝐶 𝑗
these orbits as 𝒞𝑖 if we think of them as set families.
Take an independent set 𝐵 in 𝐺 of largest size. Using Lemma 10, we may w.l.o.g. assume
𝑖 = ∅. Consider an auxiliary weighted graph 𝑊 almost
that for each 𝑗, 𝑖 either 𝐵 ⊃ 𝒞𝑗
as in the proof of Lemma 10. That is, the vertices of 𝑊 are 𝒞𝑗
𝑖 and the vertices from different
parts are connected iff there are two sets from the corresponding orbits that intersect in less
than 𝑠 elements. We also put weights on each vertex of 𝑊 equal to the cardinality of the

)︀ : |𝐶 ∩ [𝑘]| = 𝑖}. We refer to

𝑖 = {𝐶 ∈(︀[𝑛]

𝑖 or 𝐵∩𝒞𝑗

𝑘

16

Put 𝑛 = 2𝑘 − 𝑠 + 1 + 𝑙, where 𝑙 ≥ 0.

corresponding orbit. Thus, in view of Lemma 10, it is enough for us to show that one part
of 𝑊 has the same weight as the heaviest independent set in 𝑊 .
is connected to 𝒞2
with 𝑡 ∈ {𝑘 − 𝑖 − 𝑙, . . . , 𝑘 − 𝑖 + 𝑠 − 1} ∩ {𝑠, . . . , 𝑘 − 1}. Next we study the weights of the
interconnected vertices. We need the following technical lemma.
Lemma 24. 1. |𝒞𝑖| ≥ |𝒞𝑘−𝑖+𝑠−1| iff 𝑖 ≤ (𝑘 + 𝑠 − 1)/2.
2. |𝒞⌈ 𝑘−𝑙

It is easy to check that 𝒞1

2 ⌉−𝑖| ≤ |𝒞⌈ 𝑘+𝑠−1

Proof. 1. Assume 𝑖 ≤ (𝑘 + 𝑠 − 1)/2. We have |𝒞𝑖| =(︀𝑘

)︀(︀𝑛−𝑘
⌉+𝑖| for all meaningful values of 𝑖 ≥ 1.

)︀, |𝒞𝑘−𝑖+𝑠−1| =(︀

)︀(︀ 𝑛−𝑘

)︀.

𝑘

𝑡

𝑖

2

𝑘−𝑖+𝑠−1

𝑖−𝑠+1

𝑘−𝑖

𝑖

Therefore,

|𝒞𝑖|

|𝒞𝑘−𝑖+𝑠−1| =

(𝑘 − 𝑖 + 𝑠 − 1)··· (𝑘 − 𝑖 + 1)

𝑖··· (𝑖 − 𝑠 + 2)

(𝑖 − 𝑠 + 1)!2(𝑘 − 𝑖 + 𝑠 − 1)!(𝑛 − 𝑘 − 𝑖 + 𝑠 − 1)!

(𝑘 − 𝑖)!2𝑖!(𝑛 − 2𝑘 + 𝑖)!
· (𝑛 − 𝑘 − 𝑖 + 𝑠 − 1)··· (𝑛 − 2𝑘 + 𝑖 + 1)

(𝑘 − 𝑖)··· (𝑖 − 𝑠 + 2)

=

≥ 1,

because 𝑘−𝑖+𝑠−1 ≥ 𝑖 since 𝑖 ≤ (𝑘+𝑠−1)/2 and 𝑛−𝑘−𝑖+𝑠−1 ≥ 𝑘−𝑖 since 𝑛 ≥ 2𝑘−𝑠+1.
2. Assume first that 𝑙 ≤ 𝑠 − 1. We have

⌋+𝑖|

|𝒞⌊ 𝑘+𝑠−1
|𝒞⌊ 𝑘−𝑙

2

2 ⌋−𝑖| =
2 ⌋ − 𝑖)··· (⌈ 𝑘−𝑠+1
⌋ + 𝑖)··· (⌈ 𝑘+𝑙

2

(⌈ 𝑘+𝑙
(⌈ 𝑘−𝑠+1
⌉ − 𝑖 + 1)
2 ⌉ + 𝑖 + 1)

·

2

2 ⌉ + 𝑖)!2(⌊ 𝑘−𝑙
⌉ − 𝑖)!2(⌊ 𝑘+𝑠−1
(⌈ 𝑘+𝑙

2

2 ⌋ − 𝑖)!(𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2 ⌉ − 𝑖)!

⌋ + 𝑖)!(𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
2 ⌉ + 𝑖)··· (⌈ 𝑘−𝑠+1

⌉ − 𝑖 + 1)
⌉ + 𝑖)··· (𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2

2

(⌊ 𝑘−𝑙
(⌊ 𝑘+𝑠−1
We note that 𝑛 = 2𝑘 − 𝑠 + 1 + 𝑙, and therefore 𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
(⌈ 𝑘+𝑙

(𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1

2 ⌉ + 𝑖) − ⌈ 𝑠−1−𝑙

⌉.

2

2

2

2

⌉ + 𝑖)!

=

2 ⌉ − 𝑖 + 1)

= (*).
⌋ + 𝑙 + 𝑖 ≤

⌉ + 𝑖 = ⌊ 𝑘−𝑠+1

2

(*) ≥ (⌊ 𝑘−𝑙
(⌊ 𝑘+𝑠−1

2 ⌋ − 𝑖)··· (⌈ 𝑘−𝑠+1
⌋ + 𝑖)··· (⌈ 𝑘+𝑙

2

2 ⌉ + 𝑖 − ⌈ 𝑠−1−𝑙
⌉ + 1)
⌉ − 𝑖)··· (𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2

2 ⌉ − 𝑖 + 1)

≥

2

)︃⌈ 𝑠−1−𝑙

⌉ − 𝑖 + 1)
2 ⌉ + 𝑖 + 1)
(︃⌈ 𝑘−𝑠+1
⌉ − 𝑖
(︃
2 ⌉ + 𝑖
⌈ 𝑘+𝑙

2

2

·

⌉(︃

2

(⌈ 𝑘+𝑙
(𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2 ⌉ + 𝑖)··· (⌈ 𝑘+𝑙
2 ⌉ + ⌈ 𝑠−1−𝑙
⌈ 𝑘+𝑙
2 ⌉ + 𝑖
)︃⌈ 𝑠−1−𝑙
2 ⌉ + ⌈ 𝑠−1−𝑙
𝑛 − 𝑘 − ⌈ 𝑘+𝑙

⌉ − 𝑖
⌉

2

2

⌈ 𝑘−𝑠+1
𝑘 − 𝑠 + 𝑙 + 1 − ⌈ 𝑘+𝑙

⌉ − 𝑖
2 ⌉ + ⌈ 𝑠−1−𝑙

2

2

⌉ − 𝑖

)︃⌈ 𝑠−1−𝑙

2

⌉

=

≥ 1.

The last inequality holds since without integer parts the denominator is equal to the enumer-
ator, and the possible gain because of the integer parts in the denominator is at most 1/2.
However, both numbers are integer, thus the denominator is not bigger than the enumerator.

Assume now that 𝑙 > 𝑠 − 1.

17

⌋+𝑖|

|𝒞⌊ 𝑘+𝑠−1
|𝒞⌊ 𝑘−𝑙

2

2 ⌋−𝑖| =
2 ⌉ + 𝑖)··· (⌊ 𝑘+𝑠−1
⌉ − 𝑖)··· (⌊ 𝑘−𝑙

2

(⌈ 𝑘+𝑙
(⌈ 𝑘−𝑠+1
⌋ + 𝑖 + 1)
2 ⌋ − 𝑖 + 1)

·

2

2 ⌉ + 𝑖)!2(⌊ 𝑘−𝑙
⌉ − 𝑖)!2(⌊ 𝑘+𝑠−1
(⌈ 𝑘+𝑙

2

2 ⌋ − 𝑖)!(𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2 ⌉ − 𝑖)!

⌋ + 𝑖)!(𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
2 ⌉ + 𝑖)··· (⌈ 𝑘−𝑠+1

⌉ − 𝑖 + 1)
⌉ + 𝑖)··· (𝑛 − 𝑘 − ⌈ 𝑘+𝑙

2

2

(⌈ 𝑘+𝑙
(⌈ 𝑘−𝑠+1
We note that 𝑛 = 2𝑘 − 𝑠 + 1 + 𝑙, and therefore 𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
2 ⌉ + 𝑖) + ⌊ 𝑙−𝑠+1

(𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1

⌋.

2

2

2

2

(⌈ 𝑘+𝑙

⌉ + 𝑖)!

=

2 ⌉ − 𝑖 + 1)

⌉ + 𝑖 = ⌊ 𝑘−𝑠+1

2

= (*).
⌋ + 𝑙 + 𝑖 ≤

(*) ≥ (⌈ 𝑘+𝑙
(⌈ 𝑘−𝑠+1

2 ⌉ + 𝑖)··· (⌊ 𝑘+𝑠−1
⌉ − 𝑖)··· (⌊ 𝑘−𝑙

2

2

⌋ + 𝑖 + 1)
·
2 ⌋ − 𝑖 + 1)
(⌈ 𝑘−𝑠+1
(𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
⌋(︃
)︃⌊ 𝑙−𝑠+1

2

2

2

⌉ + ⌊ 𝑙−𝑠+1
⌋ − 𝑖)··· (⌈ 𝑘−𝑠+1
⌉ + 𝑖)··· (𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1

⌉ − 𝑖 + 1)
⌉ − ⌊ 𝑙−𝑠+1

2

2

2

≥

2

)︃⌊ 𝑙−𝑠+1

2

⌋ + 𝑖 + 1)
⌋

=

(︃ ⌈ 𝑘+𝑙

⌈ 𝑘−𝑠+1

2 ⌉ + 𝑖 + 1
(︃
⌉ − 𝑖 + 1

2

2

⌈ 𝑘−𝑠+1
𝑛 − 𝑘 − ⌈ 𝑘−𝑠+1
2 ⌉ + 𝑖 + 1
⌈ 𝑘+𝑙

2

⌉ − 𝑖 + 1
⌉ − ⌊ 𝑙−𝑠+1

2

⌋ + 𝑖 + 1

)︃⌊ 𝑙−𝑠+1

2

⌋

≥ 1.

𝑘 − 𝑠 + 𝑙 + 1 − ⌈ 𝑘−𝑠+1

⌉ − ⌊ 𝑙−𝑠+1

⌋ + 𝑖 + 1

2

2

As in the previous case, in the last fraction the denominator is equal to the enumerator if one
removes all integer parts, and as in the previous case we conclude that the last inequality is
valid.

The next crucial step is to decompose the graph 𝑊 into symmetric chains of even length.
𝑘−𝑖 for all 𝑖. We call these
. We call these
⌉+𝑖 for each meaningful

Let (𝑗, ¯𝑗) = (1, 2) or (2, 1). We know that 𝒞𝑗
edges edges of the first type. Next, 𝒞𝑗
edges edges of the second type. Finally, 𝒞𝑗
𝑖 ≥ 1. We call these edges edges of the third type.

is connected to 𝒞⌈ 𝑘+𝑠−1

𝑖 is connected to 𝒞¯𝑗

is connected to 𝒞¯𝑗

2 ⌉ ≤ 𝑖 ≤ 𝑘+𝑠−1

𝑖 if ⌈ 𝑘−𝑙

2 ⌉−𝑖

⌈ 𝑘−𝑙

2

𝑖

2

We claim that the graph 𝑊 is decomposed into paths of even length using the three types
of edges above. See Fig. 1, where the two parts are represented by two horizontal lines of
points, and the values near the points indicate the size of the intersection of the corresponding
family with [𝑘]. The middle vertical line corresponds to the size of the intersection with [𝑘]
in both parts. The two dashed lines correspond to the intersection size ⌈ 𝑘−𝑙
2 ⌉
equal to 𝑘+𝑠−1
for one of the parts. The vertical edges are the edges of the first type, the edges intersecting
the black line are the edges of the second type and the other edges are the edges of the third
type.

2

18

Figure 1. Decomposition of the graph 𝑊 into symmetric chains.

In the middle of each path 𝑃 there is an edge of the second type, connecting two vertices
of the same weight. Due to Lemma 24, for each path the weight of the vertex does not
decrease as we move along the path towards the middle edge of the second type. Therefore,
it is easy to see that any independent set in 𝑃 has weight, less than or equal to the half of
the weight of 𝑃 . This means that any independent set in 𝑊 cannot have weight bigger than
the half of the weight of 𝑊 . This concludes the proof of Theorem 9.

References

[1] R. Ahlswede, L. Khachatrian, The complete intersection theorem for systems of finite

sets, Eur. J. Comb. 18 (1997), N2, 125–136.

[2] P. Erd˝os, C. Ko, R. Rado, Intersection theorems for systems of finite sets, The Quarterly

Journal of Mathematics, 12 (1961) N1, 313–320.

[3] P. Frankl, The Erdos-Ko-Rado theorem is true for n=ckt, Combinatorics (Proc. Fifth
Hungarian Colloq., Keszthely, 1976), Vol. I, 365–375, Colloq. Math. Soc. Janos Bolyai,
18, North-Holland.

[4] P. Frankl, On cross-intersecting families, Discrete Math. 108 (1992), 291-295.

[5] P. Frankl, The shifting technique in extremal set theory, Surveys in combinatorics, Lond.
Math. Soc. Lecture Note Ser. 123 (1987), 81–110, Cambridge University Press, Cambridge.

[6] P. Frankl, Z. F¨uredi, Beyond the Erdos-Ko-Rado theorem, Journal of Combinatorial The-

ory, Ser. A 56 (1991) N2, 182–194.

[7] P. Frankl, A. Kupavskii, Erd˝os-Ko-Rado theorem for {0,±1}-vectors,

submitted.

arXiv:1510.03912

19

[8] P. Frankl, A. Kupavskii, A size-sensitive inequality for cross-intersecting families, sub-

mitted.

[9] P. Frankl, N. Tokushige, Some best possible inequalities concerning cross-intersecting

families, Journal of Combinatorial Theory, Ser. A 61 (1992), N1, 87–97.

[10] P. Frankl, R. Wilson, Intersection theorems with geometric consequences, Combinatorica

1 (1981), 357–368.

[11] A.J.W. Hilton, E.C. Milner, Some intersection theorems for systems of finite sets, Quart.

J. Math. Oxford 18 (1967), 369–384.

[12] G. Katona, Intersection theorems for systems of finite sets, Acta Math. Acad. Sci. Hung.

15 (1964), 329–337.

[13] D. Kleitman, On a combinatorial conjecture of Erd˝os, J. Combin. Theory 1 (1966)

209–214.

[14] J. Matouˇsek, J. Neˇsetˇril, Invitation to discrete mathematics, Oxford University Press,

1998.

[15] A.M. Raigorodskii, Borsuk’s problem and the chromatic numbers of some metric spaces,

Russian Math. Surveys, 56 (2001), N1, 103 - 139.

[16] A. Sali, Some intersection theorems, Combinatorica 12 (1992), 351–361.

20

