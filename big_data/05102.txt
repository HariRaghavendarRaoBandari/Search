6
1
0
2

 
r
a

 

M
6
1

 
 
]
h
c
e
m

-
t
a
t
s
.
t
a
m
-
d
n
o
c
[
 
 

1
v
2
0
1
5
0

.

3
0
6
1
:
v
i
X
r
a

δ-exceedance records and random adaptive walks

Su-Chan Park1 and Joachim Krug2
1Department of Physics, The Catholic University of Korea, Bucheon 14662, Republic
of Korea
2Institut f¨ur Theoretische Physik, Universit¨at zu K¨oln, K¨oln 50937, Germany

17 March 2016

Abstract. We study a modiﬁed record process where the k’th record in a series of
independent and identically distributed random variables is deﬁned recursively through
the condition Yk > Yk−1 − δk−1 with a deterministic sequence δk > 0 called the
handicap. For constant δk ≡ δ and exponentially distributed random variables it has
been shown in previous work that the process displays a phase transition as a function
of δ between a normal phase where the mean record value increases indeﬁnitely and a
stationary phase where the mean record value remains bounded and a ﬁnite fraction
of all entries are records [S.-C. Park et al., Phys. Rev. E 91:042707 (2015)]. Here we
explore the behavior for general probability distributions and decreasing and increasing
sequences δk, focusing in particular on the case when δk matches the typical spacing
between subsequent records in the underlying simple record process without handicap.
We ﬁnd that a continuous phase transition occurs only in the exponential case, but
a novel kind of ﬁrst order transition emerges when δk is increasing. The problem
is partly motivated by the dynamics of evolutionary adaptation in biological ﬁtness
landscapes, where δk corresponds to the change of the deterministic ﬁtness component
after k mutational steps. The results for the record process are used to compute the
mean number of steps that a population performs in such a landscape before being
trapped at a local ﬁtness maximum.

Keywords:
ﬁtness landscape

record process, extreme value theory, evolutionary dynamics, epistasis,

Submitted to: J. Phys. A: Math. Theor.

1. Introduction

1.1. Record processes

The mathematical theory of records is concerned with the statistics of extremes in a
time series of random observations. In the standard setting, an entry Xn in the series
is a (upper) record if it exceeds all previous entries, i.e. if Xn > max{X1, X2, .., Xn−1}.
When the Xn’s are independent and identically distributed (i.i.d.) random variables,

δ-exceedance records and random adaptive walks

2

the properties of the sequence of record times and record values have been studied in
great detail and are now well understood [1, 2, 3]. If the common distribution function
F of Xn is continuous, the statistics of record times is completely universal regardless
of the choice of F . In particular, the number of records up to time n is asymptotically
equal to ln(n) [1, 2, 3].

In many applications of record theory the observations are subject to uncertainty
and the deﬁnition of record occurrence needs to be modiﬁed [4]. Two basic situations
are conceivable. On the one hand, to make sure that spurious records caused by
measurement error are not counted, one demands that the new record should exceed
the old one at least by an amount δ > 0. On the other hand, to avoid missing any
potential events of interest, one relaxes the record condition and includes observations
in the record sequence that are smaller than the previous record by at most δ. Both
situations have been invoked to motivate the study of δ-records deﬁned by the condition
[5, 6]

Xn > max{X1, X2, ..., Xn−1} + δ.

(1)

Speciﬁcally, for δ < 0 the events satisfying (1) are referred to as near-records [7]. An
immediate consequence of introducing the parameter δ is that the strong universality of
the statistics of record times is lost and replaced by an explicit dependence on the tail
properties of the underlying distribution F , similar to other modiﬁed record processes
involving discreteness [8, 9], rounding eﬀects [10] or trends [11, 12].

Importantly, according to (1) the threshold that the new record has to exceed
is deﬁned in terms of the “true” record sequence, the maximum process Mn ≡
max{X1, X2, .., Xn}, which (under the conditions of measurement uncertainty described
above) may not even be observable. A more faithful representation of the measurement
error scenario, in which the next record occurs conditional on the previous observed
record, was introduced twenty years ago by Balakrishnan et al. under the name of δ-
exceedance records [13]. They considered the case δ > 0 and derived several results for
the case when the underlying distribution F is of exponential or Gumbel form. Mainly
for reasons of mathematical tractability [4], subsequent work has however focused on
the problem of δ-records deﬁned by (1).

A qualitative diﬀerence between δ-records and δ-exceedance records arises in the
case when δ < 0; see ﬁgure 1. Because δ-records are coupled to the maximum process
Mn, the exceedance threshold for a new record deﬁned in (1) increases monotonically
in time. Although the records themselves do not necessarily grow monotonically, the
growing threshold ensures that the record values increase on average and are pushed into
the tail of F . By contrast, in the δ-exceedance record process (to be deﬁned in precise
mathematical terms in section 2) the threshold may decrease when δ < 0. This entails
the possibility that a ﬁnite fraction of entries in the time series are counted as records
and the expected record value remains asymptotically bounded even for an unbounded
distribution. We will refer to this behavior as the stationary phase of the record process.
In a recent publication we showed that this scenario is indeed realized and leads to

δ-exceedance records and random adaptive walks

3

X

8

7

6

5

4

3

2

1

0

records
δ-records
δ-exceedance records

0

100

200

300

400

500

n

Figure 1. Comparison of sample paths of the standard record process (red solid line),
δ-records (green dot-dashed line), and δ-exceedance records (blue dotted line) for the
same realization of the background process. Random variables of the background
process drawn from an exponential distribution with unit mean are shown as symbols.
In this example, δ is set to −1, which corresponds to the critical point of the δ-
exceedance process. Note the cascades of decreasing record values which signal the
incipient stationary phase that emerges when δ < −1.

a novel kind of phase transition as a function of δ when the underlying distribution has
an exponential tail [14]. Our results were obtained in the context of adaptive walks in
biological ﬁtness landscapes, which we explain next.

1.2. Adaptive walks

Adaptive walks are simple evolutionary dynamics deﬁned on a space of genotypes
[15, 16, 17, 18, 19, 20, 14]. In the most common setting genotypes are encoded by binary
sequences of length L, where each letter denotes the presence of one of two alleles (say, 0
or 1) at a given genetic locus or nucleotide position. Genotypes are assigned real ﬁtness
values which quantify the reproductive potential of the corresponding individuals. In
one step of the walk, neighboring genotypes of higher ﬁtness are sampled and one of
them is chosen as the next position of the walker. Here two genotypes are deﬁned to be
neighbors if they diﬀer by a single point mutation, that is, at one site of the sequence.
If no ﬁtter neighbors exist the population has reached a local ﬁtness maximum and the
walk stops. Quantities of interest in the theory of adaptive walks are the number of
steps required to reach a local maximum and the ﬁtness value that has been reached at
this point.

In the present work we focus on the conceptually simplest case of the random
adaptive walk (RAW) where the next genotype along the walk is chosen at random
among the neighbors of higher ﬁtness. Let us assume that the ﬁtness values of diﬀerent

δ-exceedance records and random adaptive walks

4

random variables and consider the limit L → ∞.

genotypes are i.i.d.
In this limit
there are no local ﬁtness maxima and the walk progresses indeﬁnitely. At each step the
walk moves to a new ﬁtness value which is a random draw from the underlying ﬁtness
distribution conditioned on being larger than the previous value. Thus, the ﬁtness values
encountered along the walk form a series of records.

To estimate the number of steps that the RAW takes when L is ﬁnite, we note that
the walker will stop when the ﬁtness value that it has reached exceeds the maximum
among L i.i.d. random variables. In the record picture this means that the time at which
the RAW stops is of order L. At this point the number of records, that is, the number
of RAW steps, is of order ln(L), in agreement with the detailed analysis [16, 17]. In fact,
the sequence length L and the time n in the i.i.d. record problem are exactly equivalent
in a variant of the RAW model where the set of available neighboring genotypes is kept
ﬁxed throughout the walk [18, 19].

In [14] we considered RAW’s in a setting where i.i.d. random ﬁtness values are
added to a deterministic ﬁtness proﬁle. The walker is assumed to start in a state of
low ﬁtness and every step brings it closer to a high ﬁtness peak. Denoting the genotype
that has been reached after k steps by Ck and the corresponding ﬁtness by W (Ck), the
model is deﬁned by

W (Ck) = gk + ηCk ,

(2)

where gk is a deterministic, monotonically increasing function of k and the ηC’s are i.i.d.
random variables associated with genotypes. The condition for a genotype C ′ to be a
possible target for the next step of the RAW then reads W (C ′) = gk+1 + ηC ′ > W (Ck)
or, in terms of the i.i.d. random variables,

ηC ′ > −(gk+1 − gk) + ηCk .

(3)

For the special case of a linear ﬁtness gradient gk = ck, also known as the Rough Mount
Fuji model [14, 21], the L → ∞ RAW is thus seen to be equivalent to the δ-exceedance
record problem with δ = −c.

1.3. Goal and outline of the paper

It was shown in [14] that the phase transition in the δ-exceedance record process with
δ < 0 occurs only when the common distribution of the i.i.d. random variables has
an exponential tail. The special role of the exponential distribution reﬂects the well-
known fact that record values from exponentially-tailed distributions are asymptotically
equally spaced [2]. Correspondingly, phase-transition like phenomena can be expected
for other tail shapes if the constant δ < 0 is replaced by an oﬀset that varies with the
number of records, and some preliminary results along these lines were reported in [14].
The purpose of this paper is to provide a comprehensive analysis of the generalized
δ-exceedance record problem with a monotonically varying, negative oﬀset.
For
notational convenience, we will denote the oﬀset associated with the k’th record by
−δk (δk > 0). Moreover, because the oﬀset facilitates the establishment of new records,

δ-exceedance records and random adaptive walks

5

δk will be referred to as the ‘handicap’. Results covering all three extreme value classes
of random variables and decreasing as well as increasing handicap will be presented.

In the context of adaptive walks, the variation of δk = gk+1 − gk with k implies
that the deterministic eﬀect of a mutation depends on where it occurs along the
evolutionary trajectory, a phenomenon known as epistasis [22].
In particular, a
pattern of diminishing returns epistasis where mutational eﬀect sizes decrease with the
number of adaptive steps is commonly observed in evolution experiments with microbial
populations [23, 24, 25, 26, 27].

In the next section we deﬁne the generalized δ-exceedance record problem
considered in this work, and we specify the probability distributions of the underlying
random variables that will be used. The case of decreasing handicaps is examined in
section 3 and the case of increasing handicaps in section 4. In section 5 we use the results
for the record process to obtain estimates for the length of adaptive walks. Finally, in
section 6 we summarize our ﬁndings and provide some conclusions in the contexts of
record statistics as well as evolutionary dynamics.

2. Statement of the problem

Consider a sequence {Xi, i ≥ 0} of i.i.d. random variables with a common distribution
function F and probability density f . From this sequence, we construct recursively
the generalized δ-exceedance record process {Yk, k ≥ 0} and the corresponding record-
occurrence-time process, {nk, k ≥ 0}, as follows. We ﬁrst deﬁne Y0 = X0 and n0 = 0.
Suppose that Yl and nl up to l = k − 1 (k = 1, 2, . . . , ) have been determined. We then
deﬁne nk as

nk = min{i|Xi > Yk−1 − δk−1, i > nk−1},

(4)

where δk is a deterministic k-dependent sequence that will be called the handicap. Once
nk is determined, we set Yk = Xnk. For later purposes, {Xi, i ≥ 0} will be referred to
as the background process.
In the following, we set

δk = c(k + 1)b−1

(5)

with b > 0. If b > 1 (b < 1), the handicap δk increases (decreases) with k. An epistatic
ﬁtness landscape model of the form (5) has been considered in [28].

The following three kinds of distributions with parameters a, r, α, ν, µ > 0 will be

considered for the background process:
Fg(x) = 1 − exp(−xα/a),
Fw(x) = 1 − (1 − x/r)1/ν,
Ff (x) = 1 − (1 + x/a)−µ.

(6)

The subscripts g, w, f refer to the Gumbel, Weibull, and Fr´echet classes of extreme
value theory, respectively [29]. The corresponding densities fg and ff have semi-inﬁnite
support x > 0 and the support of fw is the interval 0 < x < r.

δ-exceedance records and random adaptive walks

6

As in Ref. [14], the mean value zl of the l’th record will turn out to play an
important role in understanding the record process. To derive a recursion relation for zl
we consider the probability density of Yl, which is denoted by Ql. It is a straightforward
generalization of the case with b = 1 [14] to obtain the recursion relation

with Q0(y) = f (y). As a consequence, zl satisﬁes (see Appendix A for the derivation)

dx,

(7)

−∞

Ql+1(y) = f (y)Z y+δl
zl+1 =(cid:28) 1
+Z R

h(cid:29)l+1

h(y) ≡

f (y)

1 − F (y)

Ql(x)

1 − F (x − δl)

(x − δl)Ql(x)dx,

δl

d
dy

= −

ln [1 − F (y)] ,

where h is the hazard function deﬁned as

(8)

(9)

R is the supremum of the support, and h. . .il stands for the average with respect to Ql.
The hazard functions corresponding to the distributions (6) are

hg(x)−1 = ax1−α/α,
hw(x)−1 = ν(r − x),
hf (x)−1 = (a + x)/µ.

(10)
Note that (8) remains valid for R = ∞ and hence can be used for the distributions Fg
and Ff . Moreover, it can be shown that the last term in (8) becomes zl − δl when the
support of f is unbounded on both sides and the recursion reduces to that considered
in [14] (see Appendix A). The analyses in the following sections will be largely based on
(8).

Before embarking on the detailed investigation, it can be instructive to develop a
heuristic picture based on the behavior of the mean record value for the standard case.
It is plausible to expect that the handicap δk will be relevant (irrelevant) to the record
process if they are asymptotically larger (smaller) than the mean diﬀerence between
subsequent record values in the standard setting.

1
α

Consider ﬁrst the Gumbel-type distributions Fg, for which the mean value of the
l’th (standard) record is asymptotically equal to (al)1/α [2] and hence the diﬀerence
−1. Comparing to (5) it follows
between subsequent record values is proportional to l
that the handicap should be relevant (irrelevant) for b > 1/α (b < 1/α). The value
b = 1/α is thus of special interest as it is the only case where an extension of the phase
transition scenario described in [14] can be expected to arise. For the Fr´echet class
distributions Ff the mean (standard) record value grows exponentially with l, whereas
it approaches the upper boundary of the support exponentially fast for the Weibull class
distributions Fw [2]. Correspondingly, one expects the record statistics to always be
asymptotically modiﬁed (unmodiﬁed) by the handicaps for distributions in the Weibull
(Fr´echet) classes. We will see below that these expectations are largely conﬁrmed by
the detailed analysis, but in addition several unanticipated features emerge.

δ-exceedance records and random adaptive walks

7

3. Decreasing handicap

When b = 1 and R = ∞, zl either increases indeﬁnitely with l or saturates to a ﬁnite
value, depending on the tail behavior of F [14]. Expecting a similar behavior, we
focus on determining the conditions under which zl diverges with l when b < 1. To
this end, we ﬁrst assume that zl indeed diverges. Another crucial assumption is that
Ql(x) is sharply peaked around zl when l is suﬃciently large. Because this amounts to
neglecting ﬂuctuations around zl, it will be referred to as the mean-ﬁeld approximation
(MFA). Under these assumptions, we can approximate the integral in (8) as zl − δl and,
in turn, we arrive at the approximate equation

zl+1 − zl ≈

1

h(zl+1) − δl.

(11)

When R is ﬁnite, the above assumptions are clearly not applicable and we will use a
diﬀerent approach.

3.1. Gumbel class

We ﬁrst consider the distribution Fg(x). Using the corresponding hazard function in
(10), we get

zl+1 − zl ≈

a
α

z1−α
l+1 − c(l + 1)b−1.

(12)

Assuming that zl is a slowly varying function of l in the sense that (zl+1 − zl)/zl → 0 as
l → ∞, we can rewrite the above equation as a diﬀerential equation

zα−1lb−1,

(13)

d

dl(cid:18) zα

a(cid:19) = 1 − c

α
a

where z is now meant to be a continuous function of l. Since we are interested in the
asymptotic solution, we set zα ≈ a(Al)γ, which yields
a1/α (Al)γ(1−1/α)+b−1 ,

= 1 − A1−b cα

Aγγlγ−1 .

.
where
= means that the equality holds only for the leading behavior on both sides. Thus,
the asymptotic behavior of zl can be consistently determined by comparing powers, γ−1
and γ(1 − 1/α) + b − 1, in (14) with 0.

If γ(1 − 1/α) + b − 1 > 0, the right hand side (RHS) of (14) will eventually become
negative while the left hand side (LHS) is positive for any l. Accordingly, any consistent
solution requires γ(1− 1/α) + b− 1 ≤ 0. Likewise, if γ > 1, no consistent solution exists
because the LHS increases to inﬁnity while the RHS cannot. Hence, we can conclude
that only solutions with γ ≤ 1 and γ(1 − 1/α) + b − 1 ≤ 0 are possible.

Let us ﬁrst consider what will happen if the solution is γ = 1. With this assumption,

(14)

we rewrite (14) as
.

A

= 1 − A1−b cα

a1/α (Al)b−1/α .

(15)

δ-exceedance records and random adaptive walks

8

If b < 1/α, we get A = 1, which corresponds to the behavior of the standard record
values (that is, c = 0). If b = 1/α, A is the solution of equation

Ab−1 − Ab =

c
abb

.

(16)

Note that as long as b < 1 a positive solution of (16) uniquely exists in the interval
0 < A ≤ 1 for any c ≥ 0. In the following, we will denote this solution by Ab(c).

Now we investigate if a solution with γ < 1 exists.

Since the LHS of (14)
approaches 0 in this case, the RHS should also approach zero. Thus, we require that
γ = (1 − b)/(1 − 1/α) and we get

A =(cid:16) cα

a1/α(cid:17)1/(b−1)

by equating the right hand size of (14) to zero. Note that for γ to be smaller than 1,
b > 1/α should be satisﬁed.

Actually, the LHS of (14) with γ < 1 gives rise to a subleading correction. To see
this, let us set zα = a(Al)γ(1 + Bl−β),where A and γ are the solutions for γ < 1 in the
above and β > 0. Then we get
α − 1

Aγγlγ−1 .

Bl−β

(18)

= −

α

(17)

(19)

and hence

zα
l

a ≈ (Al)γ(cid:20)1 −

αγ
α − 1

Aγlγ−1(cid:21) .

Since we neglect the eﬀect of ﬂuctuation of Ql, the subleading term in (19) should
however not be taken seriously.

To sum up, (12) has solutions of diverging zl for any α as long as b < 1. The leading

behavior of zl is
zα
l
a

= (Al)γ,

where

and

1,

A =
γ =( 1,

Ab(c),
(cα/a1/α)1/(b−1),

(1 − b)/(1 − 1/α),

α < 1/b,

α = 1/b,

α > 1/b,

α ≤ 1/b ,
α > 1/b.

(20)

(21)

(22)

These results conﬁrm the heuristic considerations of section 2. For α < 1/b the record
values behave asymptotically as in the standard case, i.e. the handicaps are irrelevant,
whereas for α > 1/b the behavior is modiﬁed qualitatively and the record values grow
more slowly than the standard record process. On the ‘critical line’ α = 1/b the mean
record value grows with the same power as in the standard case but with a reduced
prefactor Ab(c) which interpolates smoothly between the limits Ab(c = 0) = 1 and

δ-exceedance records and random adaptive walks

9

100

c
/

l

ζ
ν

10−2

101

l

σ
/

l

ζ

100

100

10−4

100

ν = 1, c = 1
ν = 1, c = 2
ν = 1
2 , c = 1
ν = 1
2 , c = 2
ν = 1
8 , c = 1
ν = 1
8 , c = 2
l−0.5

103
l
102

106

l

104

106

l for b = 1

2 , ν = 1, 1

Illustration of the approach of the mean record value zl to the upper
Figure 2.
boundary r of the support for Weibull-class distributions. The ﬁgure shows νζl/c
8 with c = 1 and 2 on a double logarithmic scale.
vs.
Here ζl = r − zl. For comparison, we plot the predicted behavior l−1/2.
Inset:
Double-logarithmic plots of ζl/σl against l for various ν. The horizontal lines show the
predicted valuep2/ν.

2 , and 1

Ab(c → ∞) = 0. Thus, in contrast to the case b = 1, there is no phase transition as a
function of c in the sense of [14]. For b = 1 the solution of (16) is A1(c) = 1− c/a which
reﬂects the phase transition at c = a and is conﬁrmed by the exact solution presented
in [14].

In order to self-consistently check the validity of the MFA we need to investigate
the behavior of Vl, the variance of Ql(x). Speciﬁcally, the MFA is justiﬁed if it can be
shown that Vl/z2
l → 0 as l → ∞. The detailed analysis in Appendix B shows that this is
indeed the case. Moreover, although we only used the speciﬁc form 1 − Fg(x) = e−xα/a,
the above conclusions about the leading asymptotic behavior remain valid as long as
− ln[1 − F (x)] = −xα/a + o(xα), that is, the asymptotic behavior is universal in that
the leading behavior of − ln[1 − F (x)] determines the behavior of δ-exceedance record
values.

3.2. Weibull class

Now we consider Fw(x). It turns out that it is possible to ﬁnd the generating function

where Gl is deﬁned in (A.1). From (A.11) with 1/hw(x) = ν(r − x), we obtain the
recursion relation for Gl in the asymptotic regime as

,

(24)

Gl+1 = e−λδlGl − νλ

dGl+1
dλ

Gl(λ) =Z r

0

eλ(x−r)Ql(x)dx = e−rλGl(−λ),

(23)

where

Ein(x) ≡Z x

0

1 − e−t

t

dt = −

∞Xn=1

(−x)n
n!n

,

(26)

(27)

δ-exceedance records and random adaptive walks

10

where we neglect the contribution of the integral in the domain (0, δl). If we assume
Gl+1 ≈ Gl, (24) becomes a ﬁrst order diﬀerential equation

(25)

with the ‘initial’ condition Gl(λ = 0) = 1. Within this approximation scheme, we get

νλ

dGl
dλ

+(cid:0)1 − e−λδl(cid:1)Gl = 0

lnGl ≈ −

1
ν

Ein(λδl),

which is an entire function (this function is also found in Ref. [17]). Since lnGl is the
n/(nν). For example,
generating function of cumulants, the n’th cumulant is equal to δl

ζl ≡ r − zl =

δl
ν

,

σl =

δl√2ν

.

(28)

In ﬁgure 2, we present simulation results for b = 1
excellent agreement with (28).

2 and for various ν, observing an

We conclude that in this case the approach of the mean record value zl to the upper
boundary r is completely determined by the behavior of the handicaps. The approach
is algebraic rather than exponential as in the standard case, conﬁrming our expectation
that the handicaps dominate the record statistics for any c > 0 when the background
process belongs to the Weibull class.

The full distribution of record values Ql(x) can be obtained by inverse Laplace

transformation of Gl such that
1

Ql(r − x) =

where

g(z) =

−i∞

2πiZ i∞
exp(cid:20)tz −

1

2πiZ i∞

−i∞

1
ν

Ein(t)(cid:21) dt.

exp(cid:20)λx −

1
ν

Ein(λδl)(cid:21) dλ =

1
δl

g(x/δl),

(29)

Since Ein(t) ∼ ln|t| for |t| ≫ 1 (|Arg(t)| < π), we ﬁnd Gl(λ) ≈ (λδl)−1/ν for λδl ≫ 1,
which implies that Ql(r − x) behaves as x1/ν−1 for small x, just like fw(x).

3.3. Fr´echet class

Now we consider Ff (x) with 1/hf (x) = (a + x)/µ. Neglecting the contribution from the
integral over the domain (0, δl), we get the recursion relation of zl for large l as

(cid:18)1 −
µ − 1(cid:19)l

1

µ(cid:19) (zl+1 + a) ≈ (zl + a) − δl
µ − 1(cid:19)l−k

l−1Xk=0(cid:18) µ

(z0 + a) +

whose solution is

zl + a =(cid:18) µ

δk ≈(cid:18) µ

µ − 1(cid:19)l

(31)

(z0 + a + C0),

(32)

(30)

δ-exceedance records and random adaptive walks

11

where C0 =P∞

k=0(1 − 1/µ)kδk. The above solution is exact when c = 0. Recall that µ
should be larger than 1 in order to have a ﬁnite mean zl. The exponential growth of zl
is identical to the known result for the i.i.d. record process [2]. We conclude that the
asymptotics is not aﬀected by δl if b < 1 and the background process belongs to the
Fr´echet class.

4. Increasing handicap

This section analyzes the case b > 1. A trivial conclusion for distributions with bounded
support such as Fw is immediate: As soon as δl > r, all random variables are records.
The eﬀects for unbounded distributions are more subtle and will be discussed in the
following, mostly focusing on the Gumbel class distributions Fg.

4.1. Mean ﬁeld analysis for the Gumbel class

As in the previous section, we ﬁrst look for a solution with diverging zl, assuming
Ql(x) ≈ δ(x − zl). The recursion relation for zl under the MFA is

zl+1 − zl =

z1−α
l+1 − δl + (δl − zl)Θ(δl − zl),

(33)

a
α

where Θ is the Heaviside step function with Θ(x) = 1 if x > 0 and 0 otherwise. Since
δl also diverges with l, we cannot simply neglect the integral over the domain (0, δl). If
δl > zl, the above recursion has the solution

zl = (a/α)1/α

(34)

which is of the order of the mean of fg and does not depend on l. This shows that it is not
possible to have a diverging solution that increases more slowly than the handicaps for
b > 1. Furthermore, if zl saturates to a ﬁnite number, Ql(x) cannot be approximated
as a δ-function and the MFA does not apply. Rather, if zl ≪ δl all events would
asymptotically be records with probability 1 and Ql(y) → f (y) as l → ∞. We will
return to this scenario in the next subsection.

For now, let us assume that zl > δl and ask when a diverging solution can exist.
We start from (12) with b > 1. If α ≥ 1, diverging zl implies z1−α
l ≪ δl, which leads to
the contradictory relation zl+1 < zl. Thus, for α ≥ 1 no diverging solution is possible
and asymptotically all random variables in the background process are records.

The analysis for the case α < 1 is similar to that in section 3.1, except that now
b > 1. Assuming zα
l ≈ a(Al)γ, we arrive at (14). By the same reasoning as in section 3.1,
γ cannot be larger than 1. If γ = 1, we have either α < 1/b with A = 1 or α = 1/b with
A being the solution of (16) with b > 1. In contrast to the case b < 1, however, (16) for
b > 1 does not have a positive solution if c is larger than a ‘threshold’

ct = ab(cid:0)1 − b−1(cid:1)b−1

.

(35)

Thus we expect that zl diverges as l1/α for c < ct and to saturates to a ﬁnite value for
c > ct. On the other hand, assuming γ < 1 as in section 3.1, we get γ = (1−b)/(1−1/α).

δ-exceedance records and random adaptive walks

12

However, the condition γ < 1 implies α < 1/b, and we have seen above that for this
case a solution with γ = 1 exists. Hence the solution with γ < 1 can at best describe
the subleading behavior.

To summarize, the asymptotic behavior of zl as predicted by the MFA for α 6= 1/b

is,

zα
l
a

and for α = 1/b,

zα
l
a

ﬁnite,

=( l − o(l),
=( Ab(c)l − o(l),

ﬁnite,

α < 1/b,

α > 1/b,

c ≤ ct,
c > ct.

(36)

(37)

4.2. Stochastic bistability

The value of the amplitude Ab(c) in (37) is ﬁnite at c = ct, which is suggestive of a
ﬁrst order phase transition as a function of c. We will see in this subsection that such a
transition indeed exists, but its character is importantly modiﬁed by ﬂuctuations that
have been neglected in the MFA. To make the point clear, we limit ourselves to the
distribution Fg(x) = 1 − exp(−x1/b) with a = 1 which was anticipated to exhibit a
phase transition at c = ct. As before, we consider only the asymptotic regime.

Suppose that the l’th record happens to be smaller than δl, Yl < δl. As a
consequence of the deﬁnition (4) and the fact that the support of the distribution F (x)
is limited to the positive real line, the next background event following the l’th record
is then a record with probability 1. Since its value Yl+1 is an unconstrained draw from
the background distribution, the probability that Yl+1 is larger than δl+1 is

P >
l+1 = 1 − Fg(δl+1) ≈ exp(−c1/bl(b−1)/b),

(38)

which is very small for large l. Thus we see that the process is eﬀectively trapped in the
state Yk < δk, where all events are ‘records’ drawn from the background distribution.
As δk increases with k, the corresponding probability P >
k decreases further for k > l + 1,
and the expected time until the process for the ﬁrst time reverts to Yk > δk is larger than
1/P >
l+1 ∼ exp(c1/bl(b−1)/b) ≫ l. On the other hand, if Yl ∼ zl ∼ lb for suﬃciently large l
as predicted by the MFA in section 4.1, Yl remains larger than δl with high probability
because δl only increases as lb−1.

We conclude that the sample paths of the process segregate into two subpopulations,
a stationary population in which all events of the background process are records and a
diverging population where Yl grows more rapidly than δl. Figure 3 shows a realization
of the segregation phenomenon due to initial ﬂuctuations.

To account for this behavior, we approximate the distribution Ql(x) by a sum of

two contributions,

Ql(x) ≈ Q(s)fg(x) +(cid:0)1 − Q(s)(cid:1) δ(x − ˜zl),

(39)

δ-exceedance records and random adaptive walks

13

X

4

2

0

0

50

40

30

20

10

0

1

exceedance
standard
δl

2

4

6

8

10

10

100

1000

n

Figure 3. A sample path of δ-exceedance records (blue dotted line) for b = 1/α = 2
and c = 0.4 on a semi-logarithmic scale. There are 9 new records in the ﬁgure.
For comparison, the corresponding standard records (green dot-dashed line) and the
handicaps δl (black solid line) are also drawn. The random variables of the background
process are represented by open squares. In this case, the δ-exceedance records are
very close to the standard records. Inset: Another sample path for the same parameter
sets. In this path, the δ-exceedance records are smaller than δl. As in the main ﬁgure,
there are 9 δ-exceedance records which however occur on a much shorter time scale
(n = 9, all events are records).

where ˜zl should diverge faster than δl and Q(s) is the limiting value of the probability
Q(s)

l

that Yl is smaller than δl,
Q(s)
l ≡ lim

Q(s) = lim
l→∞

l→∞

P[Yl < δl].

(40)

This quantity measures the relative weight of the stationary subpopulation of sample
paths and will serve as an order parameter for the phase transition in the following.

Plugging (39) into (11) and keeping the leading terms, we get

˜zl+1 − ˜zl =

a
α
0 (δl − x)Ql(x)dx ≈ Q(s)δl. Hence, the diverging solution found
in section 4.1 actually describes the behavior of ˜zl. Note that the mean zl and standard
deviation σl of Ql(x) are related to ˜zl by (0 < Q(s) < 1)

where we approximateR δl

˜z1−α
l+1 − δl,

(41)

(42)

(43)

which yields the relation

zl ≈ ˜zl(cid:0)1 − Q(s)(cid:1) ,
σl ≈s 1

Q(s)

zl

l

− 1 ≡ Rl.

σl ≈ ˜zlqQ(s) (1 − Q(s)),

In this context, the absence of a solution for the prefactor A for c > ct can be interpreted
as Q(s) = 1. Since the prefactor A at c = ct is A∗ = (1 − b−1)bab, we expect that Q(s)

δ-exceedance records and random adaptive walks

14

1

)
s
(

l

Q

0.6

0.52

0.51

0.50

0.49

0.48

0.2

100

105

l

1010

Figure 4. Semi-logarithmic plot of Q(s)
around the threshold value ct = 1
2 .

l

vs. l for b = 1/α = 2 and δl = c(l + 1) for c

is strictly smaller than 1 even at c = ct. Hence we can conclude that a discontinuous
transition in terms of Q(s) occurs at c = ct.

To support the above theory, we numerically studied the case with b = 1/α = 2.

For this case, ct = 1

2 and
1 + √1 − 2c

2

A =

,

(44)

which is the solution of A− A2 = c/2. Note that we have only taken the larger solution,
expecting that A is a continuous function of c for 0 ≤ c < ct. We ﬁrst check if Q(s) shows
a discontinuity at the threshold value ct = 1
is depicted as a function
of l for c around the threshold value. Each curve is the result of 104 independent runs.
As anticipated, there is a clear indication of a discontinuous jump at c = ct = 1
2.

2 . In ﬁgure 4, Q(s)

l

Next, we check if (39) is a valid assumption by comparing zl/σl with Rl in ﬁgure 5.
The asymptotic behaviors of both quantities are indeed in good agreement with each
other. The inset of ﬁgure 5 compares ˜zl ≡ zl/(1− Q(s)
l ) with the anticipated asymptotic
behavior (Al)2 with A given by (44). This also shows an excellent agreement. Although
we only present data for c = 0.2, similar agreement is observed in a wide range of c for
c ≤ 1
2.
As can be seen from ﬁgure 5, Rl saturates in a rather short time. This indicates
that the asymptotic behavior of Q(s)
is almost determined by the ﬂuctuation of Yl when
l is small; see also ﬁgure 3. That is, the analysis of the asymptotic behavior of Ql(x)
and corresponding quantities cannot give much information about Q(s), and we do not
think Q(s) is universal in the sense that it is only determined by the leading behavior
of δl. For example, if δl = c(l + l0)b−1 with very large l0, δl for small l is at least clb−1
which means Q(s)
is almost 1 for any α. Hence, we have to resort to numerical analysis
to ﬁnd Q(s).

0

l

l

δ-exceedance records and random adaptive walks

15

Rl

8

l

σ
/

l

z

5

2

101

108

l

˜z

104

100

100

103
l

(Al)2

102
l

104

105

Figure 5. Semi-logarithmic plot of zl/σl (symbols) vs.
l for b = 1/α = 2 and
δl = c(l + 1) with c = 0.2. For comparison, Rl deﬁned in (43) is also drawn (top
curve).
l for
b = 1/α = 2 and c = 0.2. The straight line is a plot of (Al)2 against l with A given by
(44).

Inset: Double logarithmic plot of ˜zl ≡ zl/(1 − Q(s)

) (symbols) vs.

l

Since Q(s) = 0 when c = 0, it is an interesting question how Q(s) approaches zero
as c → 0. We investigated the behavior of Q(s) for small c via simulations. As ﬁgure 6
shows, Q(s) decreases quite fast for small c, which suggests a form

Q(s)(c) ∼ χ1 exp(−χ2/c)

(45)
with two parameters χ1 and χ2. If this is the case, a plot of − ln Q(s) as a function of 1/c
should be well ﬁtted by a straight line. Indeed, as the inset of ﬁgure 6 shows, a linear
function well approximates the data with parameter values ln χ1 ≈ 1.9 and χ2 ≈ 1.15.
It should be clear from the above discussion that the stochastic bistability scenario
with a nonzero Q(s) is not restricted to α = 1/b but should apply also for α < 1/b,
where the MFA predicts standard record behavior with zα
l ≈ al. In contrast to the case
α = 1/b, however, for α < 1/b we expect Q(s) to be smoothly increasing function of
c that approaches unity only asymptotically for large c. We have checked numerically
that this is indeed the case, and found that the behavior of Q(s) for small c is again well
described by the functional form (45).

4.3. Fr´echet class

For Q(s) to remain zero for c > 0, the probability that Yl > δl under the condition that
Yl−1 < δl−1 should not be negligibly small for large l. For the Gumbel (and Weibull)
classes, this scenario is clearly not feasible as we have seen and only the Fr´echet class
might allow for such a possibility. Let us consider Ff (x) with a = 1. The probability of
interest is P >
l ∼ l−µ(b−1), hence such an event would happen after m ∼ lµ(b−1) records. If

δ-exceedance records and random adaptive walks

16

100

)
s
(

l

Q

10−5

0.08
0.07
0.06
0.05

10−10

100

)
s
(

Q
n

l

−

22

16

10

10

22

16

1/c

101

102

103

l

Figure 6. Plots of Q(s)
l for various values of c on a double-logarithmic scale.
Inset: Plot of − ln Q(s) vs. 1/c. The straight line is the result of a linear ﬁt. The
number of independent runs for each data set is 2.5 × 1012.

vs.

l

)
s
(

l

Q

100

10−1

10−2

10−3

µ = 0.5

1.5

1.2

1.0

0.8

10−4

100

101

102

103

104

105

l

l

Figure 7. Plots of Q(s)
vs. l for b = 2 and c = 1 on a double-logarithmic scale for
Fr´echet class distributions. The values of the power law exponent µ in this ﬁgure are
0.5, 0.8, 1.0, 1.2, and 1.5 (bottom to top), respectively. As predicted by the theory,
Q(s)

saturates to a ﬁnite value when µ > 1/(b − 1) = 1.

l

µ(b−1) < 1, l ≫ m for suﬃciently large l and the process can escape from the stationary
regime before P >

l changes substantially. Thus, we expect Q(s) = 0 if µ < 1/(b − 1).

To conﬁrm this argument, we performed simulations for b = 2 and various µ. For
as a function of l for µ = 0.5, 0.8,

convenience, we ﬁx c = 1. Figure 7 depicts Q(s)

l

δ-exceedance records and random adaptive walks

17

1.0, 1.2, and 1.5. As anticipated, the long time behavior of Q(s)
at µc = 1/(b − 1) = 1. As a ﬁnal remark, Q(s)
µ = µc with a power close to 0.5.

changes qualitatively
seems to exhibit a power-law decay at

l

l

5. Length of adaptive walks

Using the results of the previous sections, we analyze the length of adaptive walks when
a population starts from a low ﬁtness genotype C0. As was extensively discussed in
Ref. [14], we can assume that every step increases the mutational distance to C0, and
that all possible neighboring genotypes of higher ﬁtness from genotype Ck are located in
the ‘forward’ direction at distance k + 1. In the initial state C0 the number of forward
neighbors is L, and after l steps it reduces to L − l. Let Ql(y, L) denote the probability
density that the random part, i.e., ηCl in (2) is y provided that the walker takes at least
l steps. Then the recursion relation for Ql(y, L) is found to be
1 − F (x − δl)L−l
1 − F (x − δl)

Ql+1(y, L) = f (y)Z y+δl

where the term F (x − δl)L−l accounts for the possibility that the walker stops because
none of the L − l forward neighbors is of higher ﬁtness [14]. This term is absent in
the corresponding recursion relation (7) for the distribution Ql(x) of the δ-exceedance
record process, and hence the two distributions are related by

Ql(x, L)

(46)

dx,

−∞

Ql(x) = lim
L→∞

Ql(x, L).

(47)

Denoting by Hl and Pl the probability that the walker takes at least l steps and that
the walker stops at the l’th step, respectively, we can write

Ql(x, L)dx,

Hl =Z ∞
Pl ≡ Hl − Hl+1 =Z ∞

−∞

−∞

Ql(x, L)F (x − δl)L−ldx,

(48)

(49)

(50)

which are used to calculate the mean walk distance

DRAW =

lPl.

LXl=0

5.1. Gumbel class

In this subsection, we will calculate DRAW for the Gumbel class using the results of
section 3 and section 4. When b > 1, we have shown that the record process gets
trapped in a state where all entries are records with a non-zero probability Q(s). For
the adaptive walk this means that every randomly chosen neighboring genotype in the
forward direction is of higher ﬁtness, and the walk therefore attains the maximal possible
length l = L. On the other hand, with probability 1−Q(s) the walk behaves similar to the
case b < 1 where, as we will show below, the walk length increases only logarithmically

δ-exceedance records and random adaptive walks

18

with L. Thus the distribution of walk lengths for b > 1 is bimodal, with the mean walk
length being dominated by the peak at l = L and hence DRAW ∼ O(L).

To calculate DRAW with b < 1, we employ the following approximation scheme.
Since Ql(x) can be understood as the density of the random part at the l’th step
conditioned on the walker taking at least l steps irrespective of L, we approximate
Ql(x, L) as HlQl(x), which in turn gives

Pl ≈ HlZ ∞
Ql(x)F (x − δl)L−ldx.
In particular, when Ql(x) ≈ δ(x − zl), Pl becomes
Pl = Hl − Hl+1 = HlF (zl − δl)L−l.

−∞

(52)
We have shown in section 3 that F (zl − δl) can generally be approximated as
exp[−e−(Al)γ ], with certain numbers A > 0 and γ ≤ 1. Since Hl is not expected to
be signiﬁcantly diﬀerent from Hl+1, we can treat Hl as a diﬀerentiable function of l.
Hence, for suﬃciently large l and L ≫ l we get

dl
with the solution

where

Since Pl ≈ − dH

dH(l)

= −H(l) exp(cid:2)−Le−(Al)γ(cid:3)
H(l) ≈ exp(cid:20)−Z l
0 eP (x)dx(cid:21) ,
eP (x) = exp(cid:2)−Le−(Ax)γ(cid:3) .
yeP (y) exp(cid:20)−Z y
0 eP (x)dx(cid:21) dy,
DRAW ≈Z ∞
+ w(cid:21) exp(cid:20)−e−w/K −Z w

dw(cid:20)(ln L)1/γ

dl , we arrive at

A

−∞

0

exp[−e−z/K]dz(cid:21) ,

where we have assumed that Pl is negligible if l = O(L).

By the change of variables y = w + (ln L)1/γ/A and x = z + (ln L)1/γ/A, we get

(51)

(53)

(54)

(55)

(56)

(57)

(58)

(59)

(60)

where K = (ln L)1/γ−1/(Aγ). After further substitutions e−w/K = x and e−z/K = t, we
obtain

dx(cid:20)(ln L)1/γ

A

− K ln x(cid:21) d

dx

exp [−KE1(x)] ,

DRAW ≈Z ∞

−∞

where

0

DRAW ≈Z ∞
E1(x) =Z ∞

x

e−t
t

dt

is the exponential integral function. Thus, we have

DRAW ≈

(ln L)1/γ

A

+

1
Aγ

(ln L)1/γ−1K(K),

δ-exceedance records and random adaptive walks

19

c = 2
c = 1
c = 0.5

(a)

104

W
A
R
D

103

102

c = 2
c = 1
c = 0.5

(b)

105

104

W
A
R
D

103

102

c = 2
c = 1
c = 0.5

(c)

108

W
A
R
D

107

106

105

104

101

101

102

103

104

ln L

101

101

102
ln L

103

103

102

103
ln L

104

ln L for
2 and Gumbel-class random variables with (a) α = 1, (b) α = 2, and (c) α = 4.

Figure 8. Double-logarithmic plots of the adaptive walk length DRAW vs.
b = 1
Straight lines are the predicted leading term in (60).

where

K(K) ≡ −Z ∞

0

ln x

d
dx

exp [−KE1(x)] dx.

(61)

For A = γ = 1 the numerical value of K(K) is 1.099 124 which coincides with the exact
result for c = 0 [17]. However, since our analysis neglects the eﬀect of ﬂuctuations,
the subleading behavior of (60) cannot generally be expected to be exact. The leading
order behavior DRAW ≈ (ln L)1/γ/A with A and γ given in (21) and (22), respectively,
is compared to simulations in ﬁgure 8, showing excellent agreement.

5.2. Weibull class

Now we consider the bounded distribution of Weibull type Fw. Since the case b > 1
is trivial, we limit ourselves to the case b < 1. For a rough estimate of the adaptive
walk length, we ask at which value of l the stopping probability F (x− δl)L−l in (46) has
an appreciable magnitude when evaluated near the mean record value zl [14]. We have
seen in section 3.2 that the approach of zl towards the upper boundary r is determined
by the behavior of the handicaps, in the sense that r − zl ∼ δl. Thus using (28) we have

Fw(zl − δl)L−l ≈ exp"−(cid:18) (1 + ν)c

l(1−b)/ν# .
νr (cid:19)1/ν L − l

(62)

Let us ﬁrst assume that l ∼ Lξ for some ξ < 1. If 1 − b > ν the right hand side of (62)
becomes of order unity for L → ∞ if ξ = ν/(1 − b), leading to the prediction that

DRAW ∼ Lν/(1−b).

(63)
On the other hand, if 1 − b < ν the right hand side will vanish with L → ∞ for any
ξ < 1, which implies that the walk length must be O(L) to leading order. Indeed, taking
L−l = Lξ ′ we see that (62) approaches a nonzero limit if ξ ′ = (1−b)/ν, and we conclude
that DRAW = L − O(L(1−b)/ν ) for any c > 0 once ν > 1 − b.

When x ≫ 1, the integral will be dominated by small y, so we can approximate

(1 + y)1/ν g(y)dy.

P(x) ≈ 1 − x(1−b)/νZ ∞
P(x) ≈ exp(cid:2)−x(1−b)/ν(cid:3)Z ∞

0

0

∼ exp(cid:2)−x(1−b)/ν(cid:3) x−(1−b)/ν 2

dy exp(cid:20)−

ν1/ν,

x(1−b)/ν

ν

y(cid:21) g(y)

(64)

(65)

(66)

(67)

(68)

δ-exceedance records and random adaptive walks

20

For the case of 1 − b > ν our simulations show a rather systematic, though small,
deviation from the prediction (63), which indicates the need for a more careful analysis.
To get a more accurate expression of DRAW for ν < 1−b, we start from the approximation
(51), which now takes the form

where K = (cLν/r)1/(1−b),

0

Pl

Hl ≈Z r
P(x) =Z ∞

l (cid:19) ,
dxFw(r − x − δl)LQl(r − x) ≈ P(cid:18)K
dy exp(cid:2)−x(1−b)/ν (1 + y)1/ν(cid:3) g(y)dy

0

and the function g(y) was deﬁned in (30). Since we expect DRAW ∼ o(L), we dropped
the l in F L−l.

Although we do not know an explicit form for g(y), we can still obtain the
asymptotic behavior of P for small and large x. When x ≪ 1, we can approximate
P(x) as

where we have used that Gl(z/δl) ∼ z−1/ν for large z (see section 3.2).

Following the same line of reasoning as in section 5.1, we obtain the approximate

formula

DRAW ≈Z ∞
= KZ ∞

0

0

dyyP(cid:18)K

y(cid:19) exp(cid:20)−Z y
exp(cid:20)−KZ ∞

dz
z

0 P(cid:18)K

x(cid:19) dx(cid:21)

z F (t)dt + ln{KF (z)}(cid:21) ,

for the walk length, where F (x) = P(x)/x2. To estimate the integral, we look for the
saddle point zc that maximizes the argument of the exponential function, which satisﬁes
the equation

0 =

d

dz(cid:20)KZ ∞

z F (t)dt − lnF (z)(cid:21)(cid:12)(cid:12)(cid:12)(cid:12)z=zc

= −KF (zc) −

d lnF (z)

dz

. (69)

(cid:12)(cid:12)(cid:12)(cid:12)z=zc

Since K is large, zc should be either very small or very large. Let us assume that
zc is very small. Approximation of P for small x in (66) gives F (z) ∼ z−2, which
suggests −K/z2
c + 2/zc = 0 or zc ∼ K. Thus, assuming that zc is very small leads to a
contradiction.

Let us now investigate if large zc solution exists. When z is large, F (z) ≈
C0z−v exp(−zǫ) with ǫ = (1 − b)/ν, v = 2 + (1 − b)/ν2, and C0 = ν1/ν. Thus, we
can approximate F ′(zc)/F (zc) ≈ −ǫzǫ−1
c exp(−zǫ

c which, together with (69), gives

KF (zc) ≈ KC0z−v

c) ≈ ǫzǫ−1

(70)

.

c

δ-exceedance records and random adaptive walks

21

W
A
R
D

1011

108

105

102

1
2

1

4

1
8

1010

1020
L

1030

1040

Figure 9. Double-logarithmic plots of the adaptive walk length DRAW vs. L for b = 1
2
and distributions belonging to the Weibull class with ν = 1
4 (triangles),
and 1

8 (squares). For comparison, the prediction (73) is shown as straight lines.

2 (circles), 1

Thus, we ﬁnd the leading behavior of zc as

zc ∼ (ln K)ν/(1−b) ,

which is consistent with the large zc assumption.

Using (71), we can now ﬁnd DRAW. Since

and the exponential function is dominated by the region around z = zc, we approximate

d
dz

exp(cid:20)−KZ ∞

z F (t)dt(cid:21) ,

exp(cid:20)−KZ ∞
z F (t)dt + ln{KF (z)}(cid:21) =
exp(cid:20)−KZ ∞
zcZ ∞
(ln K)ν/(1−b) =(cid:18)1 − b

DRAW ≈

d
dz

dz

K

=

0

z F (t)dt(cid:21)

K

K
zc ∼
0 F (t)dt = ∞ (recall that F (t) ∼ t−2 for small t).

ln L(cid:19)ν/(1−b)

L

ν

.

(71)

(72)

(73)

where we have usedR ∞

To conﬁrm this asymptotic behavior, we performed numerical simulations for b = 1
2.

Figure 9 shows that the asymptotic behavior for large L is well described by (73).

6. Summary and conclusions

In this paper we have investigated a modiﬁed record process deﬁned on sequences of
i.i.d. random variables in which the occurrence threshold for record events is reduced
by a handicap δk that is a function of the record number k. This modiﬁcation obviously
increases the rate of record occurrence and decreases the magnitude of record values.

Ql(x) = Q(s)ρ(x) +(cid:2)1 − Q(s)(cid:3) ˜ρl(x − ˜zl).

(74)

δ-exceedance records and random adaptive walks

22

However, similar to other cases where the standard record process is modiﬁed by
rounding eﬀects or trends [12, 10], the degree to which the record statistics are altered
by the handicaps depends strongly on the tail properties of the background process. By
allowing the handicaps to depend on the record number, we are able to tune their
size to match the increments between the standard record values corresponding to
a given background distribution. Building on the results obtained in [14], we have
thus uncovered a rich variety of phase-transition like phenomena that emerge from the
interplay of the stochastic record process with the deterministic handicap function δk.
When the handicaps increase or decrease according to the power law (5) with
exponent b − 1, the distributions whose record increments match this behavior are
the representatives Fg of the Gumbel class with exponent α = 1/b.
In ﬁgure 10 we
summarize our ﬁndings for this class of distributions in the form of a phase diagram
in the (α, b)-plane. There are four distinct regions separated by the lines b = 1/α and
b = 1. For b > 1 (increasing handicap) we have seen that the sample paths of the record
process display a kind of stochastic bistability, which leads to the decomposition of the
distribution of record values Ql(x) into the general form

is a
Here ρ(x) is a probability density with ﬁnite mean, ˜zl diverges with l and ˜ρl
distribution with zero mean and a standard deviation that grows more slowly than
˜zl, such that the diverging part of (74) becomes concentrated around ˜zl for large l.
The emergence of a stationary component with weight Q(s) in a record process that
by nature is non-stationary is perhaps the most remarkable feature of our work.
It
is well known that records from i.i.d. sequences with an added linear trend become
asymptotically stationary [11], but the scenario of a ﬁrst-order-like phase transition in
the population of sample paths that we have described in section 4 does not appear to
have any counterpart in previous studies of record processes.
In region I of the phase diagram (b > 1 and α < 1/b), ˜zα

l = l − o(l) and Q(s) is an
increasing function of c that satisﬁes 0 < Q(s) < 1 for all c > 0. For small c we have
found that Q(s) is well approximated by the function (45) which displays an essential
singularity at c = 0. Region II (b > 1 and α > 1/b) is characterized by Q(s) = 1,
which means that almost all i.i.d. random variables become records when the number
of record events is large. In both regions I and II, ρ(x) in (74) is asymptotically equal
to the density of the background process.

On the borderline between regions I and II which is depicted by the red solid curve
in ﬁgure 10, Q(s) found to exhibit a discontinuous transition as c increases. That is,
there is a number ct > 0 such that Q(s) is strictly smaller than 1 if c ≤ ct while Q(s) = 1
if c > ct. When c ≤ ct, ˜zα
l ≈ Ab(c)l, where Ab(c) is the (larger) positive solution of (16)
with b > 1. Again, along this curve ρ(x) is the density of the background process when
Q(s) > 0.

The behavior along the line b = 1 (blue dot-dashed line in ﬁgure 10) was the topic of
[14], but for completeness we include a discussion of this case in terms of Q(s). For α < 1,

δ-exceedance records and random adaptive walks

23

b

1

0

I

II

Q(s) < 1

Q(s) = 1

zα
l ∼ l

III

  

  

  

  


1

b = 1

zα
l ∼ lγ

IV

b = 1/α

α

Figure 10. Phase diagram summarizing our results for Gumbel class distributions.
Four diﬀerent regions I, II, III, and IV are identiﬁed, depending on the behavior of ˜zl
and Q(s) in (74).

l = ˜zα

Q(s) = 0 and zα
l = l− o(l) , whereas Q(s) = 1 for α > 1. At α = b = 1 (represented
as a green ﬁlled circle in ﬁgure 10), Q(s) changes its behavior discontinuously from 0
(c ≤ a) to 1 (c > a) similar to the behavior along the line b = 1/α with b > 1. Unlike
the case of b > 1, however, ρ(x) is not equal to the density of the background process
when Q(s) = 1. Moreover, at the critical point c = a, the mean record value increases

anomalously slowly as zl ∼ √l. For further details we refer the reader to [14].

In both regions III and IV (b < 1), Q(s) = 0 and zl = ˜zl diverges. The diﬀerence
between region III and IV is characterized by the asymptotic behavior of zα
l . In region
III zα
l = l − o(l) like in the standard record process, while in region IV zα
l ∼ lγ with
γ = (1 − b)/(1 − 1/α) < 1. On the borderline between regions III and IV, which is
represented by a black dashed line in ﬁgure 10, zα
l = Al − o(l) with a c-dependent
constant A which is the positive solution of (16) and decreases continuously from A = 1
at c = 0 to A = 0 for c → ∞. The point α = b = 1 is again special in that here the
amplitude A vanishes at a ﬁnite value c = a [14]. When interpreted in terms of the
amplitude A of the diverging component in (74), the transition to the stationary phase
is continuous at α = b = 1 but discontinuous for α = b > 1.

The behavior for distributions in the Fr´echet and Weibull classes corresponds
roughly to that of Gumbel-class distributions with very heavy (α → 0) and light
(α → ∞) tails, respectively. Speciﬁcally, for the Fr´echet class distributions the handicap
is irrelevant when b < 1. For b > 1 the stochastic bistability scenario observed for the
Gumbel class applies and Q(s) is generally nonzero. An exception are heavy tailed

δ-exceedance records and random adaptive walks

24

distributions with tail exponent µ < 1/(b− 1), where the ﬂuctuations of the background
process are suﬃciently strong to overcome the increasing handicap and Q(s) = 0. This
is reminiscent of the problem of records from i.i.d. sequences with a linear trend, where
the record process becomes asymptotically stationary only if the underlying distribution
has a ﬁnite ﬁrst moment [11]. For distributions with bounded support belonging to the
Weibull class, all but a ﬁnite number of random variables become records for b > 1.
When b < 1, the approach of the mean record value to the boundary r of the support
is dominated by the handicap in the sense that r − zl ∼ δl, and the tail behavior of
the density of record values is found to be the same as that of the density fw of the
background process.

An important motivation for our study comes from the connection to adaptive walks
in rugged ﬁtness landscapes with deterministic epistasis in the sense of [28]. In section 5
the results obtained for the δ-exceedance records were used to quantify the increase in the
mean walk length that is caused by the increasing deterministic ﬁtness proﬁle gk in (2).
For b > 1 the stochastic bistability of the record process implies that the distribution of
walk lengths becomes bimodal. With a ﬁnite probability Q(s), walks traverse the entire
ﬁtness landscape and reach the maximal possible length O(L). In the case b < 1 which
corresponds to the biologically important scenario of diminishing returns epistasis, the
eﬀect on the walk length is more subtle and depends sensitively on the distribution of the
random ﬁtness component. In the Fr´echet class and in the Gumbel class with α < 1/b
the asymptotic behavior is DRAW ∼ ln L as on an uncorrelated landscape, whereas for
light-tailed Gumbel class distributions with α > 1/b there is a slight increase in the
walk length which now grows as (ln L)1/γ with γ < 1. By contrast, the walk length for
the Weibull class grows at least as a power law in L and is given by

DRAW ∼( L

(L/ ln L)ν/(1−b)

if ν > 1 − b
if ν ≤ 1 − b.

(75)

We note that these results are potentially relevant for the interpretation of microbial
evolution experiments, where examples of ﬁtness distributions belonging to each of the
three EVT classes have been identiﬁed empirically [30, 31, 32, 33].

The analysis of adaptive walk length also provides some insight into the statistics of
record occurrence times in the δ-exceedance record process, which we have not explicitly
addressed in this work. As was explained in section 1.2, the walk length DRAW(L) is
expected to be of the same order as the number of records events up to time n = L, a
relation that can be made precise for a particular variant of the adaptive walk problem
called ‘simple’ adaptive walk in [18]. This relation reproduces the fact that a ﬁnite
fraction of random variables are records when DRAW(L) ∼ L, and can be used to
estimate the rate of record occurrence in the other cases analyzed in this paper. A
detailed analysis of the temporal statistics of the δ-exceedance process, including in
particular the question of correlations between record events [34, 35], appears to be an
interesting problem for future study.

δ-exceedance records and random adaptive walks

25

Acknowledgments

We thank Satya Majumdar for useful discussions. S-CP acknowledges the support
by the Basic Science Research Program through the National Research Foundation of
Korea (NRF) funded by the Ministry of Science, ICT and Future Planning (Grant No.
2014R1A1A2058694); and by The Catholic University of Korea, Research Fund, 2016.
JK acknowledges the support of DFG within SPP 1590, and the kind hospitality of the
University of Florence during the completion of this work.

Appendix A. Derivation of (8)

In this appendix, we derive the recursion relations for the mean zl and the variance Vl
of Ql(x) from (7). We consider a bounded density f (x) with the support 0 < x < R,
and the case with unbounded support will be obtained by taking the limit R → ∞.

We ﬁrst introduce the moment generating function

e−λxQl(x)dx,

0

Gl(λ) =Z R
dλ(cid:12)(cid:12)(cid:12)(cid:12)λ=0

zl = −

dGl

which gives

,

Vl =

d2 ln Gl

dλ2

.

(cid:12)(cid:12)(cid:12)(cid:12)λ=0

For convenience, we introduce
Fc(x) = 1 − F (x),

˜F (x) = e−λxFc(x),

and we deﬁne F (x) = 0 if x < 0. Later, we will also use the following identity,

d ˜F (x)
dx − λ ˜F (x).
Note that Ql+1(y) for y > R − δl is given by

e−λxf (x) = −

Ql+1(y) = I0f (y),

where

I0 ≡Z R

0

Ql(x)

1 − F (x − δl)

dx,

which does not depend on y.

(A.1)

(A.2)

(A.3)

(A.4)

(A.5)

(A.6)

We now insert (A.1) into the recursion (7). After separating the integration domain

followed by integration by parts, Gl+1(λ) can be written as

0

e−λyQl+1(y)dy +Z R
Gl+1(λ) =Z R−δl
=Z R−δl
dye−λyf (y)Z y+δl
= I1 + I0 ˜F (R − δl) − λI0Z R

0

0

R−δl

e−λyQl+1(y)dy

R−δl

Ql(x)

Fc(x − δl)

+ I0Z R

R−δl

dye−λyf (y)

dy ˜F (y),

(A.7)

δ-exceedance records and random adaptive walks

26

with

0

0

0

dye−λyf (y)Z y+δl
I1 ≡Z R−δl
e−λyf (y)dyZ δl
=Z R−δl
=(cid:20)1 − ˜F (R − δl) − λZ R−δl
+Z R−δl
dye−λyf (y)Z y

0

0

0

0

Ql(x)

dx

Fc(x − δl)

Ql(x)dx +Z R−δl
dy ˜F (y)(cid:21)Z δl

0

0

Ql(x + δl)

Fc(x)

dye−λyf (y)Z y+δl

δl

Ql(x)

Fc(x − δl)

dx

Ql(x)dx

where we have changed the variable x 7→ x + δl. Changing the order of integration and
then integrating by parts, the last integral in (A.8), to be denoted by I2, becomes

dx,

(A.8)

The last integral in (A.9), to be denoted by I3, can be written as

Z R−δl

x

dye−λyf (y)

e−λ(x−δl)Ql(x)dx − ˜F (R − δl)Z R

δl

dy ˜F (y)Z y+δl

δl

Ql(x)

Fc(x − δl)

Ql(x + δl)

0

δl

dx

Fc(x)

I2 =Z R−δl
=Z R
− λZ R−δl
I3 = −λZ R−δl
e−λ(x−δl)Ql(x)dx +Z δl

0

0

0

e−λy Ql+1(y)
h(y)

0

dy + λZ R−δl
Ql(x)dx − λZ R
dx +Z δl

0

= eλδlGl(λ) − λZ R

0

e−λx Ql+1(x)
h(x)

dx

Ql(x)

Fc(x − δl)

dy ˜F (y)Z δl

0

e−λx Ql+1(x)
h(x)

dx

where h(x) = f (x)/Fc(x) is the hazard function. Hence we get

Gl+1(λ) =Z R

δl

dx.

(A.9)

Ql(x)dx,

(A.10)

where we have used (A.5) for y > R − δl. Note that even if R = ∞ the above relation
is still valid.

For the ﬁrst moment, if it exists, we get

0 (cid:0)1 − e−λ(x−δl)(cid:1) Ql(x)dx,

(A.11)

Ql+1(x)

h(x)

dx −Z δl

0

(x − δl)Ql(x)dx

= zl − δl +Z R
dx +Z R

δl

0

(x − δl)Ql(x)dx

(A.12)

and for the second moment ξl, if it exists, we get

= ξl − 2δlzl + δl

2 + 2Z R

0

x

Ql+1(x)

h(x)

which gives the recursion relation for the second cumulant, or variance, Vl = ξl − z2
Vl+1 − Vl = (zl − δl)2 − z2

Ql+1(x)

h(x)

x

(A.14)

dx −Z δl

0

(x − δl)2Ql(x)dx, (A.13)
l as

0

dx −Z δl
(x − δl)2Ql(x)dx.

dGl+1

zl+1 = −

=Z R

0

ξl+1 =

d2Gl+1

dy2

h(x)

Ql+1(x)

dy (cid:12)(cid:12)(cid:12)(cid:12)λ=0
(cid:12)(cid:12)(cid:12)(cid:12)λ=0
l+1 + 2Z R

0

δ-exceedance records and random adaptive walks

27

If the support is unbounded on both sides, we get

Gl+1(λ) =Z ∞

−∞

e−λyQl+1(y)dy =Z ∞

−∞

dx

Ql(x)

Fc(x − δl)Z ∞

x−δl

e−λyf (y)dy

= eλδlGl(λ) − λZ ∞
= eλδlGl(λ) − λZ ∞

−∞

−∞

dx

Ql(x)

Fc(x − δl)Z ∞

x−δl

e−λx Ql+1(x)
h(x)

dx,

˜F (y)dy

which is (A.11) without the last integral.

Appendix B. Analysis of the variance for decreasing handicaps in the
Gumbel class

In this appendix, we will show that the MFA used in section 3 is valid in the sense that
Vl/z2
l → 0 as l → ∞. Since the variance Vl is not neglected, we relax the MFA in such
a manner that Ql(x) = q[(x − zl)/σl]/σl, where σl ≡ √Vl is the standard deviation and

q(y) is supposed to be independent of l. Note that the mean and variance of q(y) are
0 and 1, respectively. We are still assuming that Ql(x) has a well-deﬁned steady state
distribution when x is appropriately rescaled. Recalling that the hazard function for
the Gumbel class distributions is h(x) = αxα−1/a, see (10), we may thus approximate
the integral terms on the right hand sides of (A.12) and (A.14) as

Z dxxn−αQl+1(x) =Z dt(zl+1 + σl+1t)n−αq(t)

l+1 (cid:20)1 +
≈ zn−α

(n − α)(n − 1 − α)

2

Vl+1
z2

l+1(cid:21) ,

(B.1)

(B.2)

(B.3)

where we have assumed σl/zl ≪ 1. Note that (B.1) is exact when n = α or n = α + 1.

From (A.12) and (A.14) along with (B.1), we get

a
α

z1−α

l+1 (cid:20)1 +
zl+1 − zl =
Vl+1 − Vl = (zl − δl)2 − z2

α(α − 1)

2

l+1 +

2a
α

Vl+1
z2

l+1(cid:21) − δl,
l+1 (cid:20)1 +

z2−α

(2 − α)(1 − α)

2

Vl+1
z2

l+1(cid:21) .

Using the result (20) of the MFA, we see that Vl contributes at best to the subleading
behavior in (B.2) if Vl ≈ (Clǫ)2 with ǫ < γ/α. The leading behavior of Vl, or the value
of ǫ, will be determined from (B.3).

Before ﬁnding ǫ, we rewrite (B.3) using (B.2) as

Vl+1 − Vl ≈ (zl − δl)2 − z2

l+1 + 2zl+1(zl+1 − zl + δl)(cid:20)1 + (1 − α)

= (zl+1 − zl + δl)2 + 2(1 − α)(zl+1 − zl + δl)
=

Vl+1

1

h(zl+1)2 − 2(α − 1)

zl+1h(zl+1)

,

where we have used (11) and only kept the leading terms.

Vl+1
zl+1

Vl+1
z2

l+1(cid:21)

(B.4)

δ-exceedance records and random adaptive walks

28

101

100

10−1

10−2

10−3

|
2l
z
/
V
γ
l

l

B
−
1
|

10−4

101

α = 1.5

α = 2

α = 2.5

103

105

107

l

b = 1

2 , a = c = 1. All curves decays to zero with diﬀerent power.

Figure B1. Double logarithmic plots of (cid:12)(cid:12)1 − BlγVl/z2

l(cid:12)(cid:12) vs l for α = 1.5, 2, 2.5 with
For α ≤ 1/b we have h(zl) = αAl/zl = α(Al)1−1/α/a1/α, and assuming Vl ≈ C 2l2ǫ

we obtain

2ǫC 2l2ǫ−1 .
=

which gives

a2/α

α2 (Al)−2+2/α − 2C 2 α − 1

αA

l2ǫ−1,

(B.5)

ǫ =

1
α −

1
2

,

C =

(Aa)1/α

αAp1 + 2(A−1 − 1)(1 − 1/α)

.

(B.6)

Since A = 1 if α < 1/b and A < 1 if 1/α = b < 1, C is positive.

Next we consider

the case α > 1/b, where h(zl)−1 = zl(Al)−γ/α =

a1/α(Al)(1/α−1)γ /α, and hence

2ǫC 2l2ǫ−1 .
=

a2/α(Al)2(1/α−1)γ

α2

− 2C 2 α − 1

αAγ l2ǫ−γ.

(B.7)

Since γ < 1, the left hand side can at most contribute to the subleading behavior. Thus,
we get

.

with

ǫ =

γ
α −

γ
2

,

C =(cid:20) (aAγ)2/α

2α(α − 1)Aγ(cid:21)1/2

.

To sum up, we found that

Vl
l ≈
z2

l−γ
B

B =( α2(cid:2)A2 + 2A(1 − A)(1 − 1/α)(cid:3) ,

2α(α − 1)Aγ,

α ≤ 1/b,
α > 1/b,

(B.8)

(B.9)

(B.10)

δ-exceedance records and random adaptive walks

29

where γ and A are given in (22) and (21). Hence, the MFA becomes exact as l → ∞.
To conﬁrm the above prediction, we performed Monte Carlo simulations for various
values of b, α, and c. In ﬁgure B1, we depict the deviation |1 − BVllγ/z2
l | from (B.9)
against l for b = 1
2, c = 1, and α = 1.5, 2, 2.5 on a double-logarithmic scale. As predicted,
all curves approach zero.

References

[1] Glick N 1978 Amer. Math. Monthly 85 2–26
[2] Arnold B, Balakrishnan N and Nagaraja H 1998 Records (New York: Wiley)
[3] Wergen G 2013 J. Phys. A: Math. Theor. 46 223001
[4] Edery Y, Kostinski A B, Majumdar S N and Berkowitz B 2013 Phys. Rev. Lett. 110 180602
[5] Gouet R, L´opez F J and Sanz G 2007 Bernoulli 13 754–781
[6] Gouet R, L´opez F J and Sanz G 2012 Test 21 188–214
[7] Balakrishnan N, Pakes A and Stepanov A 2005 Adv. Appl. Probab. 37 765–780
[8] Vervaat J 1973 Stochastic Process. Appl. 1 317–334
[9] Gouet R, L´opez F J and Sanz G 2005 Adv. Appl. Probab. 37 781–800

[10] Wergen G, Volovik D, Redner S and Krug J 2012 Phys. Rev. Lett. 109 164102
[11] Ballerini R and Resnick S I 1987 Adv. Appl. Probab. 19 801
[12] Franke J, Wergen G and Krug J 2010 J. Stat. Mech.:Theory Exp. P10013
[13] Balakrishnan N, Balasubramanian K and Panchapakesan S 1996 J. Appl. Stat. Sci. 4 123–132
[14] Park S C, Szendro I G, Neidhart J and Krug J 2015 Phys. Rev. E 91 042707
[15] Kauﬀman S and Levin S 1987 J. Theor. Biol. 128 11–45
[16] Macken C A and Perelson A S 1989 Proc. Nat. Acad. Sci. USA 86 6191–6195
[17] Flyvbjerg H and Lautrup B 1992 Phys. Rev. A 46 6714–6723
[18] Orr H A 2002 Evolution 56 1317–1330
[19] Neidhart J and Krug J 2011 Phys. Rev. Lett. 107 178102
[20] Seetharaman S and Jain K 2014 Phys. Rev. E 90 032703
[21] Neidhart J, Szendro I G and Krug J 2014 Genetics 198 699–721
[22] de Visser J A G M, Cooper T F and Elena S F 2011 Proc. R. Soc. Lond. Ser. B 278 3617–3624
[23] Chou H H, Chiu H C, Delaney N F, Segr`e D and Marx C J 2011 Science 332 1190–1192
[24] Khan A I, Dinh D M, Schneider D, Lenski R E and Cooper T F 2011 Science 332 1193–1196
[25] Wiser M J, Ribeck N and Lenski R E 2013 Science 342 1364–1367
[26] Berger D and Postma E 2014 Genetics 198 1417–1420
[27] Couce A and Tenaillon O 2015 Frontiers in Genetics 6 99
[28] Wiehe T 1997 Genet. Res. Camb. 69 127–136
[29] de Haan L and Ferreira A 2006 Extreme Value Theory (Berlin: Springer)
[30] Kassen R and Bataillon T 2006 Nat. Gen. 38 484–488
[31] Rokyta D, Beisel C, Joyce P, Ferris M, Burch C and Wichman H 2008 J. Mol. Evol. 67 368–376
[32] Schenk M, Szendro I, Krug J and de Visser J 2012 PLoS Genet. 8 e1002783
[33] Bank C, Hietpas R, Wong A, Bolon D and Jensen J 2014 Genetics 196 841–852
[34] Wergen G, Franke J and Krug J 2011 J. Stat. Phys. 144 1206–1222
[35] Franke J, Wergen G and Krug J 2012 Phys. Rev. Lett. 108 064101

