Millimetre Wave MIMO Channel Estimation using

Overlapped Beam Patterns and Rate Adaptation

Matthew Kokshoorn, He (Henry) Chen, Peng Wang, Yonghui Li, and Branka Vucetic

1

Abstract—This paper is concerned with the channel estimation
problem in millimetre wave (mmWave) wireless systems with
large antenna arrays. By exploiting the inherent sparse nature of
the mmWave channel, we ﬁrst propose a fast channel estimation
(FCE) algorithm based on a novel overlapped beam pattern
design. Compared to the existing non-overlapped beam pattern
design, the overlap among multiple pilot beam patterns can
increase the amount of information carried by each channel
measurement and thus reduce the required channel estimation
time. We develop a maximum likelihood (ML) estimator to
optimally extract the path information from the channel measure-
ments. Then, we propose a novel rate-adaptive channel estimation
(RACE) algorithm, which can dynamically adjust the number
of channel measurements based on the expected probability
of estimation error (PEE). The performance of both proposed
algorithms is analyzed. For the FCE algorithm, an approximate
closed-form expression for the PEE is derived. For the RACE
algorithm, a lower bound for the minimum signal energy-to-noise
ratio required for a given number of channel measurements is
developed based on the Shannon-Hartley theorem. Simulation
results show that the FCE algorithm signiﬁcantly reduces the
number of channel estimation measurements compared to the
existing algorithms using non-overlapped beam patterns. By
adopting the RACE algorithm, we can achieve up to a 6dB gain
in signal energy-to-noise ratio for the same PEE compared to the
existing algorithms.

I. INTRODUCTION

Millimetre wave (mmWave) communication has been shown
to be a promising technique for next generation wireless sys-
tems due to a large expanse of available spectrum [1]–[3]. This
spectrum, ranging from 30GHz to 300GHz, offers a potential
200 times the bandwidth currently allocated in today’s mobile
systems [4]. However, a critical challenge in exploiting the
mmWave frequency band is its severe signal propagation loss
compared to that over conventional microwave frequencies
[5]–[7]. To compensate for such a loss, large antenna arrays
can be employed to achieve a high power gain. Fortunately,
owing to the small wavelength of mmWave signals, these
arrays can be packed into small areas at the transmitter and
receiver [8], [9]. For such mmWave systems, channel state
information (CSI) is essential for effective communication and
precoder design. However, the use of large antenna arrays
results in a large multiple-input multiple-output (MIMO) chan-
nel matrix. This makes the channel estimation of mmWave
systems very challenging due to the large number of channel
parameters to be estimated. Moreover, owing to the high
frequency, it is often not feasible to obtain digital samples

6
1
0
2

 
r
a

M
7

 

 
 
]
T
I
.
s
c
[
 
 

1
v
6
2
9
1
0

.

3
0
6
1
:
v
i
X
r
a

The material in this paper was presented in part at the IEEE International

Conference on Communications, London, England, June 2015.

M. Kokshoorn, H. Chen, P. Wang, Y. Li, and B. Vucetic are with School
of Electrical and Information Engineering, The University of Sydney, Syd-
ney, NSW 2006, Australia (email: {matthew.kokshoorn, he.chen, peng.wang,
yonghui.li, branka.vucetic}@sydney.edu.au).

from each antenna [1]. To resolve this high frequency sampling
problem, analog beamforming techniques have been proposed
and widely adopted in open literature (see [8], [10]–[12] and
references therein). The main idea of analog beamforming is
to control the phase of the signal transmitted or received by
each antenna via a network of analog phase shifters.

Using analog beamforming techniques, the most straightfor-
ward channel estimation method is to exhaustively search in
all possible angular directions. Speciﬁcally, consider a system
with N transmit antennas and N receive antennas. If we
aim at achieving a minimum angular resolution of π/N, an
exhaustive search-based channel estimation would then require
a set of N transmit beamforming vectors at the transmitter
designed to span all possible beam directions and likewise with
N receive beamforming vectors at the receiver. By searching
all possible N 2 combinations, an N × N matrix can be
formed whose entries represent the channel gains between
the N transmit and the N receive beams. This matrix is
commonly referred to as the virtual channel matrix [13]–[17].
Despite the large number of entries expected for the mmWave
MIMO channel matrix, it has been shown in recent measure-
ments [18], [19] that the mmWave channel exhibits sparse
propagation characteristics in the angular domain. That is,
there are only a few dominant propagation paths in mmWave
channels. This sparsity can be seen in the virtual channel
matrix, as only a limited number of transmit and receive
direction combinations have a non-zero gain [13]. Therefore,
the key objective of mmWave channel estimation is to identify
these paths so that the transceiver can align the transmit and
receive beams along these paths.

Recently, some compressed sensing based channel estima-
tion algorithms have been proposed to explore the channel
sparsity in mmWave systems, e.g., [5], [8], [20], [21]. The
fundamental idea in some of these approaches is to search
multiple transmit/receive directions in each measurement, by
creating initial beam patterns that span a wider angular range
than those used by the exhaustive search. Similar adaptive
beamforming algorithms and multi-stage codebooks were
proposed in [12], [22]–[24]. By initially using wider beam
patterns,
these approaches are able to reduce the number
of measurements required for channel estimation. However,
this introduces a loss of directionality gain,
leading to a
lower signal-to-noise ratio (SNR) at the receiver and a higher
probability of estimation error (PEE). In this sense, there exists
a challenging trade-off between estimation time and accuracy
for mmWave channel estimation.

As one of the seminal works on multi-stage codebook
approaches, [5] developed a “divide and conquer” search type
algorithm to estimate sparse mmWave channels. As shown in
Fig. 1, in each stage of this algorithm, the possible ranges

of angles of departure (AODs) and angles of arrival (AOAs)
are both divided into K << N non-overlapped angular sub-
ranges. Correspondingly, K non-overlapped beam patterns
are designed at both the transmitter and receiver such that
each transmit (receive) beam pattern exactly covers one AOD
(AOA) sub-range. The channel estimation carried out in each
stage consists of K 2 time slots. In each time slot, the pilot
signal is transmitted using one of the K beam patterns at
the transmitter, and then collected by one of the K beam
patterns at the receiver. The corresponding channel output
for each pair of transmit-receive beam patterns can then be
obtained. These K 2 time slots span all the combinations of
transmit-receive beam patterns. By comparing the magnitudes
of the corresponding K 2 channel outputs, the transmit/receive
sub-ranges that
likely belong to are
determined. The receiver can then feed back the AOD infor-
mation for use at the transmitter. Afterwards, the algorithm
will limit the estimation to the angular sub-range identiﬁed
at each link end in the previous stage and further divide
it into K sub-ranges for the channel estimation in the next
stage. This process continues until the smallest beam width
resolution is reached. It is shown in [5] that the algorithm
requires estimation time proportional to K 2(cid:100)logK(N )(cid:101) per
path. Despite the signiﬁcant improvement when compared to
the exhaustive search approach, such a channel estimation
algorithm still might not be quick enough to track the fast
channel variations, especially for mmWave mobile channels
with rapidly changing parameters. Furthermore, at high SNR
it may not be necessary to perform so many measurements,
which would consume some unnecessary energy.

the AOD/AOA most

Motivated by this, in this paper we develop a fast mmWave
MIMO channel estimation framework by designing a set of
novel overlapped beam patterns that can signiﬁcantly reduce
the number of channel estimation measurements. In order
to improve estimation accuracy, we then introduce a novel
rate-adaptive channel estimation approach, where the average
number of channel measurements is adapted to channel con-
ditions. The main contributions of this paper are summarized
as follows:

• Relying on novel overlapped beam pattern design, we
ﬁrst present a fast channel estimation (FCE) algorithm
for mmWave systems. In this algorithm, we develop a
maximum likelihood (ML) detector to optimally extract
the channel AOD/AOA information from the measure-
ments. We also design a linear minimum mean squared
error (LMMSE) channel estimator to estimate the channel
coefﬁcients by optimally combining the selected measure-
ments in all stages.

• We then develop a rate-adaptive channel estimation
(RACE) algorithm, in which additional measurements are
permitted when the current measurements are found to
have an inadequate probability of success. In this way,
the number of measurements can adapt to the channel
conditions and the channel estimation accuracy can be
signiﬁcantly improved with minimal measurements.

• We analyze the probability of channel estimation error
for the FCE algorithm. In particular, we derive a closed-
form approximation, lower bound and upper bound for
the PEE. Based on the Shannon-Hartley theorem, we

2

Fig. 1.
Illustration of the beam patterns adopted in the ﬁrst (a) and second
(b) stages of the channel estimation algorithm of [5] when K = 3. The
three sub-ranges in the ﬁrst stage are, [0, π/3), [π/3, 2π/3) and [2π/3, π),
respectively. By assuming that the possible AOAs/AODs are reduced to the
sub-range [0, π/3) in the ﬁrst stage, this sub-range is further divided into
[0, π/9), [π/9, 2π/9) and [2π/9, π/3), respectively, in the second stage.

also provide some theoretical analysis for the minimum
energy required to estimate the channel using the RACE
algorithm.

• Finally, we compare the performance of the proposed
algorithms to that of the algorithm in [5] with non-
overlapped beam patterns. Simulation results show that
both of the proposed algorithms can signiﬁcantly reduce
the number of channel measurements compared to [5].
We show that the FCE algorithm achieves a guaranteed
reduction of channel measurements, at the expense of
estimation accuracy. On the other hand, the RACE algo-
rithm can achieve the same average reduction of channel
measurements as the FCE algorithm, but using up to 6dB
less signal energy compared to the algorithm in [5] under
the same PEE.
Notation : A is a matrix, a is a vector, a is a scalar, and A
is a set. ||A||2 is the 2-norm of A, det(A) is the determinant
of A and |A| represents the cardinality of A. AT , AH and
A∗ are the transpose, conjugate transpose and conjugate of
A, respectively. For a square matrix A, A−1 represents its
inverse. We use diag(a) to denote a diagonal matrix with
entries of a on its diagonal. I N is the N × N identity matrix,
1N is an N ×1 all 1 column vector and (cid:100)·(cid:101) denotes the ceiling
function. CN (m, R) is a complex Gaussian random vector
with mean m and covariance matrix R. E[a] and Cov[a]
denote the expected value and covariance of a, respectively.
A ⊗ B denotes the Kronecker product of A and B whereas
A(cid:12) B denotes the row-wise Kronecker product of A and B.

II. SYSTEM MODEL

Consider a mmWave MIMO system composed of Nt trans-
mit antennas and Nr receive antennas. We consider that
both the transmitter and receiver are equipped with a limited
number of radio frequency (RF) chains. Following [5], we
further assume that these RF chains, at one end, can only be
combined to form a single beam pattern, indicating that only
one pilot signal can be transmitted and received at one time.
To estimate the channel matrix, the transmitter sends a pilot
signal x, with unit energy (||x||2 = 1), to the receiver. Denote
by f and w (||f||2 = ||w||2 = 1), respectively, the Nt × 1

√

beamforming vector at the transmitter and Nr×1 beamforming
vector at the receiver. The corresponding channel output can
be represented as

y =

P wH Hf x + wH q,

(1)
where H denotes the Nr × Nt MIMO channel matrix, P
is the transmit power and q is an Nr × 1 complex additive
white Gaussian noise (AWGN) vector following distribution
CN (0, N0I Nr ).

In this paper we follow [25] and adopt a two-dimensional
(2D) sparse geometric-based channel model. Speciﬁcally, we
consider an L path channel between the transceiver, with
the lth path having steering AOD, φt
l where
l = 1, ..., L. Then the corresponding channel matrix can be
expressed in terms of the physical propagation path parameters
as

l, and AOA, φr

(cid:112)

L(cid:88)

H =

NtNr

αlar(φr

l )aH

t (φt
l)

(2)

l=1

l) and ar(φr

where αl is the fading coefﬁcient of the lth propagation path,
and at(φt
l ) respectively denote the transmit and
receive spatial signatures of the lth path. To simplify the
analysis, we assume that the transmitter and receiver have the
same number of antennas (i.e., Nt = Nr = N). However, it is
worth pointing out that the developed schemes can be easily
extended to a general asymmetric system. If uniform linear
antenna arrays (ULA) are employed at both the transmitter and
receiver, we can deﬁne at(φt
l ),
respectively, where

l) and ar(φr

l ) = u(φr

l) = u(φt

u() (cid:44) 1√
N

[1, ej2π,··· , ej2π(N−1)]T .

(3)

Here, the steering angle, φt
l, is related to the physical angle
l ∈ [0, π) by φt
with λ denoting the signal
θt
wavelength1. A similar expression can be written for φr
l at the
receiver. With half-wavelength spacing, the distance between
antenna elements becomes d = λ/2.

l = d sin(θt
l )

λ

From (2), we can see that the overall channel state informa-
tion of each path includes only three parameters, i.e., the AOD
l , and the fading coefﬁcient αl. We assume
l , the AOA φr
φr
that the fading coefﬁcient of each path follows a complex
Gaussian distribution with zero mean and variance PR and
that both φt
l can only take some discrete values from
l and φr
N ,··· , π(N−1)
N }. We aim to ﬁnd an efﬁcient
the set UN = {0, π
way to estimate these three parameters for each path. The key
challenge here is how to design a sequence of f(cid:48)s and w(cid:48)s
in such a way that the channel parameters can be quickly and
accurately estimated.

We consider M pairs of beam patterns that are designed to
span all possible transmit-receive combinations. Denote by f m
and wm, respectively, the transmit and receive beamforming
vectors adopted in the mth channel measurement time slot
such that ||f m||2 = ||wm||2 = 1, ∀ m = 1,··· , M. Similarly
to [5], we assume the same pilot symbol x is transmitted

1Note that the use of ULA results in no distinguishable difference between
l . Hence, only AODs and

AODs θt
AOAs in the range [0, π) need to be considered.

l or between AOAs θr

l and −θr

l and −θt

during the M time slots. Then, after M time slots, we can
obtain a sequence of M measurements represented as

√
y =

P xhv + n,

(4)

where hv describes the channel input-output relationship for a
given set of transmit and receive beamforming vectors deﬁned
by

3

(5)

(6)

hv =

and

1 Hf 1
2 Hf 2
...

M Hf M

wH

 wH
 wH

wH

1 q1
wH
2 q2
...
wH
M qM





n =

is an M × 1 vector of the corresponding noise terms. Note
that since ||wm||2 = 1, ∀ m, the vector n follows the same
distribution as that of qm, i.e., n ∼ CN (0, N0IM ).

Motivated by the geometric sparsity of the mmWave chan-
nel, in the following two sections, we propose to use a set
of overlapped beam patterns that are able to estimate the
AOD/AOA information very quickly. We then extend the algo-
rithm to use a rate-adaptive estimation approach. The adaptive
nature of the algorithm permits additional measurements to be
performed under poor channel conditions. This allows the fast
channel estimation to be carried out with signiﬁcant accuracy
and energy efﬁciency.

III. FAST CHANNEL ESTIMATION WITH OVERLAPPED

BEAM PATTERNS

In this section, we develop a fast channel estimation frame-
work for mmWave systems using overlapped beam patterns.
Speciﬁcally, we design a set of beam patterns that, in different
measurement intervals, are overlapped with one another in
the angular domain. A maximum likelihood based estimation
algorithm is then proposed to accurately retrieve the channel
state information from the set of measurements. The proposed
channel estimation algorithm also works in a similar multi-
stage manner as that in [5] where each stage reduces the
possible sub-ranges in which the AOD/AOA are expected to
be found.

A. An Example of Overlapped Beam Pattern Design

We will ﬁrst explain the design principle of overlapped
beam patterns using a simple example. Following Fig. 1, we
divide the AOD/AOA angular spaces into K = 3 sub-ranges
in the ﬁrst stage, denoted by S1 = { ∈ UN|0 ≤  < π/3},
S2 = { ∈ UN|π/3 ≤  < 2π/3} and S3 = { ∈ UN|2π/3 ≤
 < π}, respectively. However,
instead of using 3 beam
patterns to cover them at each transceiver end as in Fig. 1(a),
we propose to use only 2 overlapped beam patterns to achieve
this. Fig. 2(a) illustrates our designed beam patterns in the
ﬁrst stage. We can see that the ﬁrst and second beam patterns
cover S1, S2 and S2, S3, respectively, and are overlapped in

b1 =(cid:2) b1,1,

the whole range of S2. Intuitively, if a path is observed in
two measurements using adjacent beam patterns, the AOD or
AOA must belong to the overlapped sub-range of these two
beam patterns. It is also seen that each beam pattern can have
different amplitudes in different sub-ranges. We represent the
amplitudes of each beam pattern in different sub-ranges by a
vector. For beam pattern 1 and 2 in Fig. 2(a), these vectors
are respectively deﬁned as

b1,2,

b1,3

b2,2,

b2,3

(7)
where bi corresponds to the ith beam pattern with bi,k de-
noting the amplitude of the ith beam pattern in sub-range
Sk, ∀ k = 1, ..., K. By using M = 4 measurement time
slots, we can then span all beam pattern combinations between
the transceiver. We denote the sequential set of beam patterns
respectively adopted at the transmitter and receiver by

(cid:3) , b2 =(cid:2) b2,1,

(cid:3)

 b1
 b1

b1
b2
b2

b2
b1
b2

 =
 =

 b1,1,
 b1,1,

b1,1,
b2,1,
b2,1,

b2,1,
b1,1,
b2,1,

B(M )

T =

B(M )

R =

 ,
 .

b1,2,
b1,2,
b2,2,
b2,2,
b1,2,
b2,2,
b1,2,
b2,2,

b1,3
b1,3
b2,3
b2,3
b1,3
b2,3
b1,3
b2,3

(8)

(9)

We refer to these as the beam pattern design matrices, with
their mth row denoting the beam pattern adopted in the mth
measurement time slot, where m = 1, ..., M. The efﬁcient
design of these beam patterns can lead to many solutions.
However, one desirable property is that the same quantity of
signal energy is transmitted/received via each sub-range over
all measurements, i.e., the energy of each column of (8)-(9)
should have the same Euclidean norm. This provides the same
accuracy for each possible sub-range combination. Another
desirable property is that the transmit/receive beamforming
gains of all measurement patterns are equal, i.e., the energy
of each rows of (8)-(9) should be the same.

and B(M )

One possible way to make the beam pattern sub-range
amplitudes in (7) follow the aforementioned properties, is to
normalize B(M )
to have unit energy in each row
and have equal energy in each column. For the beam patterns
in Fig. 2, we have b1,3 = b2,1 = 0, as beam patterns 1 and 2
do not cover, respectively, the third and ﬁrst sub-ranges. Due
to the symmetry between the two beam patterns, we further
have b1,1 = b2,3 = β1 and b1,2 = b2,2 = β2. This leads to
β1 = 1√

, and the matrices in (8)-(9) become

and β2 =

R

T

√
2√
3

3



√
2√
√
3
2√
3
0

0

 , B(M )

R =



√
2√
3
0
√
2√
3
0

1√
3
1√
3
1√
3
1√
3

1√
3
1√
3
1√
3
1√
3

0

0
√
2√
√
3
2√
3

B(M )

T =

 .

0
√
2√
3
0
√
2√
3
(10)

In order to observe the resultant amplitude gains (i.e., the
transceiver gain) over each of the K 2 = 9 sub-range combina-
tions, we introduce another matrix referred to as the generator
matrix. We deﬁne this as the row-wise Kronecker product

4

Fig. 2.
Illustration of the overlapped beam patterns adopted in the ﬁrst (a)
and second (b) stages of the proposed algorithm when K = 3. By assuming
that the possible AOAs/AODs are reduced to the sub-range [0, π/3) in the
ﬁrst stage, this sub-range is further divided into [0, π/9), [π/9, 2π/9) and
[2π/9, π/3), respectively, in the second stage.

between the transmit beam pattern design matrix and the
receive beam pattern design matrix such that

 b1 ⊗ b1

b1 ⊗ b2
b2 ⊗ b1
b2 ⊗ b2



G(M ) = B(M )

T (cid:12) B(M )

R =

 2

0
0
0

=

1
3

√
√

2
2
0
0

0
2
0
0

√
2
√
0
2
0

1
1
1
1

√
0
2
√
0
2

0
0
1
0

0
0
√
0
0
√
2 0
2 1

(11)

 ,

(12)
recalling that (cid:12) and ⊗ represent the row-wise Kronecker
and Kronecker product operations respectively. By denoting
b(m,kt)
as the entry on the ktth and krth column
T
on the mth row in B(M )
R , respectively, we can
express the dth column of G(M ) as

and b(m,kr)

and B(M )

R

T

 b(1,kt)

b(1,kr)
R...
b(M,kr)
b(M,kt)

T

R

T



G(M )

d =

(13)

where the relationship d = K(kt − 1) + kr is a result of the
Kronecker product operation.

The columns of generator matrix describe the M = 4 re-
ceived measurement gains over each of the K 2 = 9 sub-range
combinations. For example, if a path were present between the
transmit sub-range kt = 3 and the receive sub-range kr = 1,
the measurement vector y would be expected to be a scalar
multiple of column d = 7 of G(M ), expressed as G(M )
. It is
important to note that the sets of beam patterns used in this
paper are not unique. We later show that their performance,
in terms of PEE, depends only on the Euclidean distance
between each column of G(M ), which directly determines
the probability that one column corresponding to a certain
sub-range is to be mistaken for another. In the example set
shown in (11), each column has the same equal minimum
Euclidean distance when compared with all other columns,

7

although some have more spatial neighbours at this minimum
distance than others.

B. Beamforming Vector Design

To generate the beam patterns illustrated in Fig. 2(a) and
the transmit and receive beamforming
described in (10),
vectors should be designed as follows. Denote by f m and
wm, respectively, the transmit beamforming vector and receive
beamforming vector corresponding to the mth pair of beam
patterns in B(M )
R . We then design the product of
the transmit array response and transmit beamforming vector
to have

and B(M )

T

uH ()f m = Cb(m,k)

T

, if ∃ k ∈ {1, 2, ..., K},  ∈ Sk,

(14)

and the product of the receiver array response and receive
beamforming vector to have

R

, if ∃ k ∈ {1, 2, ..., K},  ∈ Sk,

uH ()wm = Cb(m,k)

(15)
where u() has been deﬁned in (3) and C is a scalar constant
that ensures ||f m||2 = ||wm||2 = 1. Physically, C corre-
sponds to the average directivity gain of each beam pattern and
is the same for all m = 1,··· , M due to the normalization
of the rows in (10). Eqs. (14) and (15) can be expressed in a
matrix form as

T

 (cid:44) z(m)
 (cid:44) z(m)

R

1|S1|

1|SK|

1|S1|

T

T

...
Cb(m,K)

 Cb(m,1)
 Cb(m,1)
(cid:16) π(N−1)

...
Cb(m,K)

R

R

N

(16)

(17)

U H f m =

and

U H wm =

(cid:16) π
(cid:2)u(0), u

N

(cid:17)

,··· , u

where |S| denotes the cardinality of set S and U =

1|SK|

(cid:17)(cid:3) is a matrix whose columns

describe the antenna array response at each angle. Therefore
f m and wm can be designed as

and

f m = (U U H )−1U z(m)

T

wm = (U U H )−1U z(m)

R

(18)

(19)

where (U U H )−1U is the pseudo inverse of U.

C. Channel Measurements

We now perform channel estimation in the ﬁrst stage using
the previously designed transmit and receive beamforming
vectors {f m} and {wm}. In each time slot, the beamforming
vectors f m and wm are adopted to transmit/receive the pilot
signal x. If we substitute the channel in (2) into (5), we get

L(cid:88)

 (aH

h(M )

v = xN

αl

 .

(20)

r (φr

l )w1)H aH

t (φt

l)f 1

l=1

r (φr

(aH
loss of generality,
l ∈ Skt

and AOA, φr

l)f M

t (φt

l )wM )H aH
let us consider the case with
l ∈ Skr
l are

, where kt

l and kr

l

Without
AOD, φt

...

l

respectively, the transmit and receive sub-range indices of the
lth propagation path. By recalling (14)-(15) we write
l )wm = Cb(m,kr
l )

l)f m = Cb(m,kt
l )

and uH (φr

uH (φt

(21)

R

T

which leads to

h(M )
v = xN C 2

L(cid:88)

l=1

αl

 b(1,kt

T

l )

b(M,kt
l )

T

b(1,kr
l )
R...
b(M,kr
l )

R

 .

5

(22)

We can see from (13) that the vector term in (22) is the
weighted sum of the columns of G(M ) i.e., the weighted sum
l , ∀ l = 1, ..., L, in G(M ).
of columns dl = K(kt
Therefore we can express hv by the generator matrix as

l − 1) + kr

h(M )
v = xN C 2G(M )vT

(23)
where v is a 1 × K 2 sparse row vector that describes the
channel gain at each of the K 2 sub-range combinations by

vdl = αl, ∀ l = 1, ..., L

(24)

and zero otherwise. For example with K = 3, a single path
(i.e., L = 1) with coefﬁcient α1, exists on the ﬁrst transmit
sub-range (i.e., kt
1 = 1) and second receive sub-range (i.e.,
1 = 2) leads to d1 = K(kt
kr

1 − 1) + kr

1 = 2 and

v = {0, α1, 0, 0, 0, 0, 0, 0, 0}.

(25)

Finally by using (23), we can re-write the received channel
output vector deﬁned in (1), after M measurements, as

√

y(M ) =

P N C 2xG(M )vT + n(M ).

(26)

D. Maximum Likelihood Detection of AOD/AOA Information
We now require an efﬁcient means of detecting v given that
a generator matrix G(M ) has been used to obtain the channel
outputs in (26). Due to its optimal detection properties, this
subsection elaborates how to implement a maximum likelihood
detection [26] method to extract the AOD/AOA information
from the received measurements. We begin by considering the
distribution of y(M ). From (26), this can be expressed as

√
y(M ) ∼ CN (
P N 2C 4x E[G(M )vT ] + E[n(M )],
P N 2C 4||x||2 Cov[G(M )vT ] + Cov[n(M )]).
Recall that n(M ) ∼ CN (0, N0I M ), where I M is the M × M
identity matrix. Also recall that the pilot signal x has unit
energy, i.e., ||x||2 = 1. For the signal component, as each
of the path coefﬁcients αl have zero mean we can write
E[G(M )vT ] = 0 and

(27)

Cov[G(M )vT ] = E[G(M )vT (G(M )vT )H ]

= N 2C 4G(M )E[vT v](G(M ))H .

(28)
(29)

(cid:40)

By deﬁning a binary version of v, denoted by ¯v, with elements
deﬁned by

¯vd =

1, if ||vd||2 > 0, ∀ d = 1, ..., K 2 ;
0, otherwise

(30)

we can separate the AOD/AOA information in ¯v from each
of the path coefﬁcient variances, PR. As each path coefﬁcient

has variance E[αlα∗
PR¯vT ¯v. We can then re-write the distribution of y(M ) as

l ] = PR, ∀ l, this then gives E[vT v] =

y(M ) ∼ CN (0, Σv)

(31)

where

Σv = P N 2C 4PR G(M )¯vT ¯v(G(M ))H + N0I M .

(32)

It can now be seen that y(M ) follows a zero mean, circularly
symmetric complex Gaussian (CSCG) distribution with corre-
sponding probability density function (PDF) deﬁned as [27]
f (y(M )|¯v, G(M )) =

exp(−(y(M ))H Σ−1

1

πM det(Σv)

v y(M )).
(33)

Now let us ﬁnd the conditional probability of ¯v, given the
receive measurement vector y(M ) and knowledge of G(M ),
denoted by p(¯v|y(M ), G(M )). Deﬁne V as the set of all
possible binary channel realizations such that ¯v ∈ V. We also
deﬁne |V| to represent the cardinality of this set. Following
the principle of maximum likelihood detection and based on
Bayes rule [28], we can express the probability of ¯v for all
possible ¯v ∈ V as

p(¯v|y(M ), G(M )) =

where the term

p(y(M )|G(M )) =

(cid:88)

¯v∈V

f (y(M )|¯v, G(M ))p(¯v)

p(y(M )|G(M ))

(34)

f (y(M )|¯v, G(M ))p(¯v)

(35)

is independent of a particular channel realization. We assume
that each channel realization is equiprobable, therefore

p(¯v) =

1

|V| , ∀ ¯v ∈ V.

(36)

We then denote the probability that the dth element of ¯v has
a path by p(¯vd = 1), ∀ d = 1, ..., K 2. We can express this
probability as the sum of all p(¯v|y(M ), G(M )) in (34) in which
¯vd = 1 by
p(¯vd = 1|y(M ), G(M )) =

p(¯v|y(M ), G(M )).

(cid:88)

(37)

¯v ∈ V
¯vd = 1

Following the maximum likelihood approach we then ﬁnd the
most likely sub-range combination by

ˆd = argmax

[p(¯vd = 1|y(M ), G(M ))].

d

(38)

Finally by ﬁnding the most likely transmitter and receiver
subranges through

(cid:108) ˆd

(cid:109)

K

ˆkt =

, ˆkr = ˆd − K(ˆkt − 1)

(39)

we can reduce the ranges of possible AOD and AOA to,
respectively, the ˆktth transmit and ˆkrth receive angular sub-
ranges. Each of these two sub-ranges will be further divided
into another K sub-ranges for the channel estimation in the
next stage.

6

Algorithm 1: Fast channel estimation (FCE) algorithm for
mmWave channels using overlapped beam patterns
Input : Transmitter and receiver both know, N, K
and have B(s,M )
Initialization : Set initial sub-ranges,
S (1)
t,k ,S (1)
for s ≤ S do

, B(s,M )
.
r,k , ∀ k = 1,··· , K

R

T

// Calculate:
{f (s)
m } based on S (s)
{w(s)
m } based on S (s)
for m = 1 to M do

t,k , ∀ k = 1,··· , K and B(s,M )
r,k , ∀ k = 1,··· , K and B(s,M )

R

T

Transmitter transmits using f (s)
m
Receiver measures using w(s)
m

v

+ n(s,M )

end
// After M measurements:
y(s,M ) =
ˆd(s) = argmax

P xh(s,M )

√

(cid:108) ˆd(s)

[p(¯vd = 1|y(s,M ), G(s,M ))]
t − 1)
r = ˆd(s) − K(ˆk(s)
ˆk(s)
t =
// Reﬁne sub-ranges based on ˆk(s)
and ˆk(s)
S (s+1)
, ∀ k = 1,··· , K.

,S (s+1)

, ˆk(s)

(cid:109)

K

d

r

t

t,k

r,k

S(cid:80)

end
Output :
ˆφt = π
N
ˆα = PR ˆrH (ˆrPR ˆrH + N0I|ˆr|)−1r

t − 1)K S−s, ˆφr = π
(ˆk(s)

s=1

N

S(cid:80)

s=1

r − 1)K S−s

(ˆk(s)

E. Multi-stage Generalization

r,2 , . . . ,S (s)
t,1 ,S (s)

In general the proposed channel estimation algorithm works
in [5], requiring
in a similar multi-stage manner as that
S = (cid:100)logKN(cid:101) stages. In the sth stage, we initially divide
the possible AOA angular space into K non-overlapped sub-
r,1 ,S (s)
ranges S (s)
r,K and divide the possible AOD angu-
lar space into S (s)
t,2 ,··· ,S (s)
t,K. Then only M overlapped
beam pattern pairs will be designed at the transmitter and
receiver to cover these K sub-ranges. The designed M beam
patterns are characterized by the M × K beam pattern design
matrices B(s,M )
. These should be generated
to maximize the minimum Euclidean distance between the
columns of the corresponding generator matrix G(s,M ).
and B(s,M )
, we can then generate both
the transmit beamforming vectors {f (s)
m } and receive beam-
forming vectors {w(s)
m } respectively in the same way as in
(18)-(19). For example, to generate f (s)
m , the corresponding
vector z(m)
for rigorous-
ness, should be designed such that its ith entry, denoted by
[z(s,m)

in (16), which is redeﬁned as z(s,m)

Given B(s,M )

and B(s,M )

R

R

T

T

T

T

(cid:40)

]i, ∀ i = 1, ..., N, satisﬁes
if πi
if πi

Csb(m,kt)
0,

]i =

T

,

N ∈ S (s)
N /∈ S (s)

t,kt

t,kt

T

[z(s,m)

T

, ∃ kt ∈ {1,··· , K};
, ∀ kt ∈ {1,··· , K}
(40)

where Cs is a scalar constant for the sth stage to guarantee
that f (s)
]i describes

m ||2 = 1. Physically, [z(s,m)

m satisﬁes ||f (s)

T

the desired beam pattern amplitude at angle πi
used. Each receive beamforming vector w(s)
in the same way.

N when f (s)

m is
m can be designed

The channel output on the sth estimation stage can then be

obtained after M time slots by

y(s,M ) =

Psxh(s,M )

v

+ n(s,M )

where

h(s,M )

v

=

(cid:112)





(w(s)
(w(s)

1 )H Hf (s)
2 )H Hf (s)

1

2

...

(w(s)

M )H Hf (s)

M

(41)

(42)

and Ps denotes the transmit power of the pilot signal in the
sth stage. Similar to that in [5], we prefer that all the stages
have an equal probability of failure, indicating that we should
allocate power among stages inversely proportional
to the
beamforming gains of these beam patterns, i.e.,

Ps =

PT
C 4
s

, ∀ s = 1, 2,··· , S

(43)

where PT is a constant. Similar to (38) we then ﬁnd the most
likely sub-range combination of the sth stage by

ˆd(s) = argmax

[p(¯vd = 1|y(s,M ), G(s,M ))]

(44)

d

(cid:108) ˆd(s)

(cid:109)

with the corresponding most likely transmitter and receiver
sub-ranges given by

t

r

K

(45)

ˆk(s)
t =

and S (s)
r,ˆk(s)

r = ˆd(s) − K(ˆk(s)

t − 1).
, ˆk(s)
The selected sub-ranges, S (s)
are then used for
t,ˆk(s)
the channel estimation in the next stage. This process continues
N is reached requiring
until the minimum angle resolution π
S = (cid:100)logK(N )(cid:101) stages. It is worth pointing out that although
the proposed algorithms are elaborated based on the estimation
process of a single path, their implementation in multi-path
scenario is actually feasible by following the same procedure
as in [5, Algorithm 2]. More speciﬁcally, multiple paths are
estimated sequentially, with the ﬁrst path being estimated using
the multi-stage algorithms described above. Subsequent paths
can then be found by returning to the ﬁrst stage and repeating
the estimation. Moreover, in each stage’s measurements, the
expected contributions from all previously estimated paths can
be subtracted to reveal new paths.

F. Estimation of the Fading Coefﬁcient

Once all estimation stages described in the previous sub-
section have been performed, we estimate the identiﬁed path
fading coefﬁcient α. In [5], the value of α was estimated based
on the measurement of the ﬁnal stage only. To improve the
estimation accuracy, we estimate α by using all measurements
in all stages of the algorithm. Denote by r and ˆr, respectively,
the vector of all received measurements and the vector of their
estimates such that

 y(1,M )

...

y(S,M )

r =

 , ˆr =

 x

x

√

√

P1N C 2
...
PSN C 2

1 G(1,M )

ˆd(1)

SG(S,M )

ˆd(S)



(46)

7

i

where G(s,M )
denotes the ith column of G(s,M ). Provided
that the AOD/AOA estimation is correct in each stage, we can
write

r = ˆrα + w

(47)
where w is the SM × 1 vector of corresponding noise terms.
In the case where the AOD/AOA estimation is incorrect, the
estimation of the fading coefﬁcient is not important as there
will be a beam misalignment between the transmitter and
receiver. Following the LMMSE principle [29], we can then
estimate the fading coefﬁcient α as

ˆα = PR ˆrH (ˆrPR ˆrH + N0I|ˆr|)−1r

(48)
where I|ˆr| is an |ˆr|×|ˆr| identity matrix. Now we can formally
describe the proposed fast channel estimation algorithm using
overlapped beam patterns in Algorithm 1.
Remark 1. It can be seen that, compared with the channel
estimation algorithm in [5] with the same value of K, our
proposed algorithm also requires S = (cid:100)logKN(cid:101) stages, but
the number of measurement time slots required in each stage
reduces to M, instead of K 2. In general, this yields a K2
M
reduction in measurement time slots. For the example of K =
3 discussed earlier with M = 4, a K2
M 2 = 225% increase in
estimation rate can be achieved.

IV. RATE ADAPTIVE CHANNEL ESTIMATION ALGORITHM
The proposed channel estimation scheme explained in the
previous section uses a ﬁxed G(s,M ) where the detector is
forced to make a decision after M measurements, irrespective
of what the computed probability p(¯v ˆd(s) = 1|y(s,M ), G(s,M ))
may be. Leveraging the detection method developed in the pre-
vious section, we now propose a novel rate-adaptive channel
estimation (RACE) algorithm.

We ﬁrst introduce a target maximum probability of estima-
tion error (PEE), denoted by Γ. The basic principle of the
RACE algorithm is that after the M initial measurements
are completed in any given stage, if the most likely sub-
range combination probability does not satisfy p(¯v ˆd(s) =
1|y(s,M ), G(s,M )) > (1 − Γ), then additional measurements
will be performed. To this end, the receiver will feedback
the current most
, and also
the information indicating whether more measurements are
required or not.

likely transmit sub-range, ˆk(s)

Note that the non-overlapped algorithm proposed in [5] also
feeds back a sub-range number to the transmitter, however
we include an additional bit corresponding to whether more
measurements in this stage are required or not. This feedback
only requires (cid:100)log2(K) + 1(cid:101) bits, which will be shown to be
negligible at high signal-to-noise ratio (SNR) as the average
number of additional measurements required is close to zero.
If the speciﬁed probability threshold was not met after the
Mth measurement,
instead of the transmitter and receiver
further dividing sub-ranges corresponding to ˆk(s)
r , an
additional measurement is taken on their sub-range combina-
tion. The associated beamforming vectors are designed to cor-
and B(s,M )
respond to a newly added row to each of B(s,M )
−→
yielding B(s,M +1)
b K
as a 1 × K sparse binary row vector with a single 1 in its
i

R
, respectively. We deﬁne

and B(s,M +1)

and ˆk(s)

R

T

T

t

t

generator matrix corresponding to (49) can be described by

G(s,M +1) = B(s,M +1)

T

(cid:12) B(s,M +1)

T

=

8

(cid:34)

(cid:35)

G(s,M )
−→
b K2
ˆd(s)

.

(50)

The estimation parameters can then be updated based on
the updated G(s,M +1) and y(s,M +1) and the ML detector
developed in the previous section. We can generalize this
to G(s,M +R) where R = 0, 1, ...
indexes the additional
measurements.

The proposed RACE algorithm is formally described in
Algorithm 2. As can be seen from the algorithm description,
this process then repeats until either the threshold condition
has been met (i.e., p(¯v ˆd = 1|y(s,M ), G(s,M )) > (1 − Γ)) or
a maximum number of measurements, denoted by Mmax, has
been reached (i.e., M + R = Mmax). Under fading channel
conditions, there always exists a non-zero probability of an
‘outage’ occurring when the path coefﬁcient is close to zero.
By imposing the upper limit to the number of measurements
we reduce the time and energy expended in this case. As
the RACE algorithm is able to compute the probability of
successful estimation during the estimation process, it can
minimize the number of measurements required for successful
estimation and therefore reduce the associated energy.

V. PERFORMANCE ANALYSIS

In this section, we focus on the performance analysis of the
proposed algorithms when a single path is present between the
transmitter and receiver. Speciﬁcally, we derive two analytical
expressions. The ﬁrst is an expression for the PEE (i.e., an
incorrect estimation of the AOA or AOD), whereas the second
expression is for the minimum energy-to-noise ratio required
by the RACE algorithm for a speciﬁed average number of
measurement, M + R.

Algorithm 2: Rate-adaptive channel estimation (RACE)
algorithm for mmWave channels
Input : Transmitter and receiver both know, N, K
and have B(s,M )
Initialization : Set initial sub-ranges,
S (1)
t,k ,S (1)
for s ≤ S do

, B(s,M )
.
r,k , ∀ k = 1,··· , K

R

T

// Calculate:
{f (s)
m } based on S (s)
{w(s)
m } based on S (s)
for m = 1 to M do

t,k , ∀ k = 1,··· , K and B(s,M )
r,k , ∀ k = 1,··· , K and B(s,M )

R

T

Transmitter transmits using f (s)
m
Receiver measures using w(s)
m

end
// After M measurements:
y(s,M ) =
ˆd(s) = argmax

P xh(s,M )

√

v

(cid:108) ˆd(s)

d

(cid:109)

+ n(s,M )

[p(¯vd = 1|y(s,M ), G(s,M ))]
t − 1)
r = ˆd(s) − K(ˆk(s)

K

, ˆk(s)

ˆk(s)
t =
// Carry out additional measurements if required:
R = 0
while p(¯v ˆd(s) = 1|y(s,M +R), G(s,M +R)) < (1 − Γ)
and (M + R < Mmax) do

t,k , ∀ k and

R = R + 1 // Increment re-measurement index
Transmitter transmits with:
M +R based on S (s)
f (s)
Receiver measures with:
M +R based on S (s)
w(s)
Update:
ˆd(s) = argmax

−→
b K
ˆk(s)
t
−→
b K

r,k , ∀ k and

[p(¯vd = 1|y(s,M +R), G(s,M +R))]
r = ˆd(s) − K(ˆk(s)

(cid:108) ˆd(s)

t − 1)

ˆk(s)
t =

, ˆk(s)

(cid:109)

ˆk(s)
r

d

K

end
// Reﬁne sub-ranges based on ˆk(s)
S (s+1)
, ∀ k = 1,··· , K.

,S (s+1)

t

t,k

r,k

S(cid:80)

end
Output :
ˆφt = π
N
ˆα = PR ˆrH (ˆrPR ˆrH + N0I|ˆr|)−1r

t − 1)K S−s, ˆφr = π
(ˆk(s)

s=1

N

and ˆk(s)

r

A. Probability of AOD/AOA Estimation Error

S(cid:80)

r − 1)K S−s

(ˆk(s)

s=1

−→
b K

(cid:34)

(cid:35)

B(s,M )
R−→
b K

ˆk(s)
r

. (49)

As the RACE algorithm seeks to achieve a ﬁxed error rate
by means of an adaptive G(s,M +R), we ﬁrst need to ﬁnd the
PEE for a ﬁxed generator matrix, G(s,M +R), ∀ s = 1, ..., S.
Note that this is also the case in Algorithm 1 with a ﬁxed
generator matrix, G(s,M ), ∀ s = 1, ..., S. We begin by
deﬁning the PEE in a given stage s, assuming all previous
stages have been correct, as

pEE|G(s,M +R),¯v(s) = p(¯v(s) (cid:54)= ˆv(s))

(51)
where the term p(¯v(s) (cid:54)= ˆv(s)) represents the probability that
the estimated AOD/AOA information ˆv(s) is not equal to the
physical channel, ¯v(s).

If we treat

the channel vector ¯v(s) as information be-
ing encoded by the generator matrix G(s,M +R), we can
this estimation error event as a maximum likeli-
model
(cid:54)= ˆv(s)
hood decoding error. We can then say that ¯v(s)
occurs when the received measurement vector y(s) =
is incorrectly ’de-
coded’ to another received measurement vector y(cid:48)(s) =

αx(cid:112)PsN 2C 4

s G(s,M +R)(¯v(s))T + n(s),

ith entry and 0 otherwise such that
i = [0i−1, 1, 0K−i]
where 0i is a 1 × i all zeros row vector. The updated beam
pattern design matrices B(s,M +1)
can then be
expressed as

and B(s,M +1)

R

T

(cid:35)

(cid:34) B(s,M )

T−→
b K

ˆk(s)
t

B(s,M +1)

T

=

, B(s,M +1)

R

=

The (M + 1)th transmit and receive beamforming vectors can
then be calculated from the new row in these matrices and be
used to measure the channel, obtaining y(s,M +1). The updated

9

(a)

(b)

Fig. 3. Comparison of the AOA/AOD probability of estimation error numerical results with the derived analytical expression. Fig. (a) uses shows the PEE
for a single stage system, whereas Fig. (b) shows a system with S = 3. Both systems use PR = 1 and are compared to the total energy per noise ratio,

By substituting these terms into (51) and averaging over each
¯v(s) we get

and the set of vectors causing it as

calculated by ET = M(cid:80)S
αx(cid:112)PsN 2C 4

s=1 Ps.

s G(s,M +R) ¯v(cid:48)T , ∀ ¯v(cid:48) ∈ V and ¯v(cid:48)

(cid:54)= ¯v(s). We

then express the probability of this event as

p(¯v(s) (cid:54)= ˆv(s)) =

p(y(s) → y(cid:48)(s)).

(52)

(cid:91)

¯v(cid:48) ∈ V
¯v(cid:48) (cid:54)= ¯v

As the decoding approach used in this paper is based upon
maximum likelihood, we can calculate such an error prob-
ability from the Euclidean distance between the received
measurement sets. With reference to [30], we can then express
the pairwise error probability of this decoding error over a
fading channel with coefﬁcient α ∼ CN (0, PR) as

(cid:34)

(cid:115)

(cid:35)

p(y(s) → y(cid:48)(s)) =

1 −

1
2

¯γ2

¯γ2 + 2

(53)

(cid:115)

where

¯γ =

PsC 4

s N 2PR
2N0

||G(s,M +R)(¯v(s) − ¯v(cid:48))T||

(54)

pEE|G(s,M +R) =

=

p(¯v)pEE|G(s,M +R),¯v(s)

(cid:91)

(cid:34)

(cid:115)

(55)

(cid:35)

.

(56)

¯γ2

¯γ2 + 2

p(¯v)

2

1 −

(cid:88)
(cid:88)

¯v∈V

¯v∈V

¯v(cid:48) ∈ V
¯v(cid:48) (cid:54)= ¯v

Expressing the exact probability of the union term in (56) is
quite difﬁcult due to complicated boundaries between each
column in G(s,M +R). This is a direct result of the generator
matrix not containing a full set of normalized (M + R) × 1
vectors. For example, (11) does not contain the scaled ver-
[1, 0, 1, 1]T ,
sions of the vectors [0, 1, 1, 0]T ,

[1, 1, 0, 1]T ,

[1, 1, 1, 0]T , [0, 1, 1, 1]T or [0, 0, 0, 0]T . This is an inherent
property of the generator matrix being constructed from two
smaller matrices B(s,M +1)
that do not contain
the all-zero column vector. We can, however, ﬁnd an upper
bound of expression in (56) by replacing the union term with
a summation to get

and B(s,M +1)

R

T

(cid:34)

(cid:115)

(cid:35)

p(¯v)

2

1 −

¯γ2

¯γ2 + 2

.

(57)

pEE|G(s,M +R) <

(cid:88)

(cid:88)

¯v∈V

¯v(cid:48) ∈ V
¯v(cid:48) (cid:54)= ¯v

The resulting upper bound in (57) is found to be quite
loose in most cases. Motivated by this, we ﬁnd a much
tighter approximation by only considering ¯v(cid:48) that minimizes
||G(s,M +R)(¯v(s)− ¯v(cid:48))T|| (i.e., only considering spatially adja-
cent columns of G(s,M +R)). We deﬁne this minimum distance
for each ¯v(s) by

||G(s,M +R)(¯v(s) − ¯v(cid:48))T||

(58)

dmin(¯v(s)) = min
¯v(cid:48) ∈ V
¯v(cid:48) (cid:54)= ¯v

(cid:110)

Vmin(¯v(s)) =

argmin
¯v(cid:48) ∈ Vmin
¯v(cid:48) (cid:54)= ¯v

||G(s,M +R)(¯v(s) − ¯v(cid:48))T||(cid:111)

.

We therefore approximate pEE|G(s,M +R) by

pEE|G(s,M +R) ≈ (cid:88)

(cid:88)

p(¯v)

2

1 −

(cid:34)

¯v∈V

¯v(cid:48) ∈ Vmin
¯v(cid:48) (cid:54)= ¯v

(59)

(cid:35)

.

(cid:115)

¯γ2

¯γ2 + 2

(60)
We also provide a greatly simpliﬁed lower bound for Al-
gorithm 1 when R = 0, by only considering a single one

510152025303540455010-410-310-210-1100ET /N0  (dB)PEE  Simulation of FCE Algorithm: K=3, S=1, N=3Analytical Approximation (59): K=3, S=1, N=3Analytical Lower Bound (60): K=3, S=1, N=3Analytical Upper Bound (56): K=3, S=1, N=3510152025303540455010-410-310-210-1100ET /N0  (dB)PEE  Simulation of FCE Algorithm: K=3, S=1, N=27Analytical Approximation (59) into (62): K=3, S=3, N=27Analytical Upper Bound (63): K=3, S=3, N=27of these ¯v(cid:48) that cause a minimum distance. Recall that the
generator matrix is designed such that all paths have the
√
same minimum Euclidean distance, which we deﬁne here as
Emin = dmin(¯v(s)), ∀ ¯v(s). By assuming each channel
realization is equiprobable, this leads to

(cid:34)

(cid:115)

pEE|G(s,M ) >

1
2

1 −

s N 2PREmin

PsC 4
s N 2PREmin + 4N0

PsC 4

(61)

Finally, we upper bound the probability of an error occurring
in any of the S stages as

(cid:35)

pEE = 1 − S(cid:89)
S(cid:88)
S(cid:88)

(cid:88)

s=1

s=1

<

<

(1 − pEE|G(s,M +R))
(cid:34)

(cid:88)

p(¯v)

pEE|G(s,M +R)

s=1

¯v∈V

2

¯v(cid:48) ∈ V
¯v(cid:48) (cid:54)= ¯v(s)

(62)

(63)

.

(64)

(cid:115)

(cid:35)

¯γ2

¯γ2 + 2

1 −

In order to validate our analysis, Figs. 3 (a) and (b) compare
the derived analytical expressions with their corresponding
Monte Carlo simulations for a single stage system and three
stage system, respectively. As we can observe from Fig. 3(a),
the given in (60) is actually quite tight. Focusing on the three
stage system in Fig. 3(b), we see that the substitution of the
approximation in (60) into the upper bound (63) causes some
disparity, however still provides a tighter approximation than
(64). A lower bound is not presented in Fig. 3(b) as the use
of (61) in the upper bound (63) would not be mathematically
correct.

B. Minimum Energy and Time Requirement for the RACE
Algorithm

We now present an expression for the minimum signal
energy-to-noise ratio required by the RACE algorithm for an
average number of measurements in a given stage. From an
information theory standpoint, we can describe the RACE
algorithm as the information process that a 1 × K 2 binary
vector ¯v(s) is encoded into M + R symbols by the generator
matrix G(s,M +R). This information transfer has an equivalent
modulation rate of C = K 2/(M + R) information bits per
measurement time slot duration. The Shannon-Hartley theorem
[31] tells us that the minimum received SNR required for error
free detection at this rate is

SN Rr ≥ 2C − 1

K2

M +R − 1

= 2

(65)

where from (26), for a given ¯v(s), G(s,M +R) and α, we know
the average received SNR can be expressed as

SN Rr =

||α||2PsC 4

s N 2

||G(s,M +R)(¯v(s))T||2

N0

(M + R)

.

(66)

Substituting (66) into (65) gives

||α||2PsC 4

s N 2

||G(s,M +R)(¯v(s))T||2

N0

(M + R)

≥ 2

K2

(M +R) − 1.

(67)

By denoting the total energy used in stage s by Es = Ps(M +
R), we can re-write (67) as

10

(M + R)2(2

K2

(M +R) − 1)

≥

Es
N0

(68)

.

||α||2C 4

s N 2||G(s,M +R)(¯v(s))T||2
into how
The expression in (68) gives a good insight
to minimize the amount of energy required for successful
channel estimation. For example, one intuitive approach to
reduce the energy requirement
is to maximize the term,
s N 2||G(s,M +R)(¯v(s))T||2 which directly determines the
C 4
amount of energy that arrives at the receiver. Furthermore,
as we have a minimum number of M initial measurements
that have been designed such that they propagate non-zero
energy over each sub-range combination (i.e., each col-
umn of G(s,M +R) has a non-zero norm), we ensure that
||G(s,M +R)(¯v(s))T||2 > 0, ∀ ¯v(s). This then guarantees that
Es/N0 always takes on a ﬁnite value.

As G(s,M +R) is adaptive and based on feedback, it becomes
quite difﬁcult to determine the exact energy requirement for
various R > 0. However, if we let g(s,M +R)
denote the tth row
of G(s,M +R), we can expand the term ||G(s,M +R)(¯v(s))T||2
by splitting it into the sum of received energy in each measure-
ment time slots. The row/column energy normalization, seen
in the design of (10), leads to the generator matrix having
||G(s,M )(¯v(s))T||2 = M
K2 ∀ ¯v(s). Expanding this expression
we then get

t

||G(s,M +R)(¯v(s))T||2

(cid:0)g(s,M +R)

t

M +R(cid:88)

t=1

=

= ||G(s,M )(¯v(s))T||2 +

(¯v(s))T(cid:1)2
M +R(cid:88)
(cid:0)g(s,M +R)
(¯v(s))T(cid:1)2
(cid:0)g(s,M +R)

t=M +1

.

t

t

M +R(cid:88)

t=M +1

=

M
K 2 +

(¯v(s))T(cid:1)2

(69)

t

Following the RACE algorithm, we can also deduce that the
term g(s,M +R)
(¯v(s))T in (69) results in either unit energy or
no energy, depending on whether the most likely sub-range
combination from the previous measurement
timeslot was
correct or not. If we denote the probability of this information
being incorrect as pEE|G(s,M +R−1) we can then write the
average energy contribution from this term as

||G(s,M +R)(¯v(s))T||2 =

M
K 2 +

(1 − pEE|G(s,M +R(cid:48)−1) ).
(70)

Substituting (70) back into (68), we have

≥

Es
N0

s N 2||α||2
C 4

(cid:104) M

(M + R)2(2

K2 +

R(cid:48)=1

R(cid:80)

K2

(cid:105) .
M +R − 1)
(1 − pEE|G(s,M +R(cid:48)−1) )

(71)
Unfortunately, the probability in (71) still depends on previous
sub-range estimates determined from the previous measure-
ment and is thus difﬁcult to obtain a closed-form. We can

R(cid:88)

R(cid:48)=1

11

Nr receive antenna, each equipped with a limited number of
RF chains such that they can only transmit and receive with
a single beam pattern.

1) Selection of number of sub-ranges in each stage, K:
In general, by using a smaller value of K, a faster channel
estimation can be achieved at a greater energy efﬁciency and
a more computationally efﬁcient ML detection. The main
drawback of setting a smaller K lies in the wider beam
patterns and the resultant loss of directionality gain. From
an energy efﬁciency point of view, this loss is outweighed
by the speed advantage. However, if a peak power constraint
were imposed, more directionality may be required in the early
stages and this can be achieved by increasing K. Selection of
K may also depend on the number of antennas being equipped
at each link end. For example, it is generally accepted that a
mmWave mobile link will have more antennas at a base station
(BS) than at the mobile station (MS) [3], [32]. For such a
general asymmetric system, it is possible to use different K in
each stage and at each transceiver end. This grants ﬂexibility to
achieve the same number of estimation stages for each system.
Then it is only important that the product of the K’s over all
stages equals to the antenna number. An alternative approach
is to simply use more stages at the BS than at the MS. In
this case, once the MS has reached its ﬁnal stage before the
transmitter, it can continue its role in the estimation procedure
by utilizing the already estimated AOA.

2) Selection of M and resultant design of G(s,M ) : For
a given number of sub-ranges K, M pairs of initial beam
patterns can then be designed to span them. The use of a lower
M value leads to a faster estimation of the stage, however,
generally requires a higher SNR. As mentioned in subsection
III-A, there exist many combinations of B(s,M )
and B(s,M )
that can be used for a given M and K. Effective design should
consider the resulting generator matrix G(s,M ), and ensure
that all columns have the same minimum Euclidean distance.
In addition to this, each column of G(s,M ) should have the
same energy. The equal-power criterion for each row/column is
not as important as the Euclidean distance property, however,
may simplify any power requirements by proving uniform
transmit/receive power within a stage.

3) Selection of Mmax and Γ : Finally, the selection of the
maximum number of measurements per stage Mmax should be
selected based upon any maximum timing constraints. Increas-
ing Mmax will signiﬁcantly increase the energy efﬁciency at
medium to high SNR regime, although the average number of
measurements per stage will still converge to M at high SNR.
We ﬁnd that, for a fading channel with Gaussian distributed
channel coefﬁcients, the selection of Γ is not as important as
Mmax. This is due to the non-zero probability of an outage
condition. In general, increasing Γ will reduce the PEE by
increasing the average number of measurements and therefore
expending more energy. In contrast, at high SNR, increasing
Mmax will allow more measurements to be carried out in the
unlikely event that it needs them. Therefore the later uses less
average energy.

R

T

VI. NUMERICAL RESULTS

We now provide some numerical examples to verify the per-
formance of our proposed algorithms. We consider a mmWave

Fig. 4.
Comparison of the minimum number of measurements required
for channel estimation in a single stage, using the RACE algorithm, to the
analytical expression in (72) with pF B = 1 and pF B = 1/K2. Here we use
N = 3, K = 3, ||α|| = 1 and Mmax = ∞.

however, consider a few extreme cases where we assume a
ﬁxed probability of correct feedback information. That is, we
use pF B = 1 − pEE|G(s,M +R−1), ∀ R > 0. Finally, we can
express the average minimum energy to noise ratio required for
successful channel estimation in a given stage with a certain
number of measurements to be

≥

Es
N0

(M + R)2(2
s N 2||α||2
C 4

K2

(cid:104) M
M +R − 1)
K2 + R × pF B

(cid:105) .

(72)

To validate this expression, Fig. 4 shows the average number of
measurements required to estimate the AOD/AOA information
in a single stage for a range of different signal energy to noise
ratios. Here we also plot (72) for two special cases. The ﬁrst is
when pF B = 1, representing the best case scenario where the
previous sub-range estimate is always correct. The second is
the worst case scenario where the previous sub-range estimate
is random (i.e., no feedback) giving pF B = 1/K 2.

As we can see from Fig. 4, (72) provides a bound for the
best case scenario pF B = 1, and for the worst case scenario
pF B = 1/K 2. To make the simulation results match the
bounds, here we do not limit the number of measurements
(i.e., Mmax = ∞). Although pF B = 1/K 2 still gives a
mathematical lower bound for the energy requirement, the
condition that pF B = 1/K 2 describes a system that performs
far worse than the RACE algorithm. As such, we see the
two lines intercept at high SNR. We can also observe from
this ﬁgure that the RACE algorithm falls between these two
curves and converges to R = 0 at high SNR. Finally, the
asymptotic nature of the results in Fig. 4 supports the need
to set Mmax << ∞ so that measurements do not continue
indeﬁnitely.

C. Discussion of System Performance Parameters

We end this section by brieﬂy discussing the performance
parameter selection for the proposed algorithms for a gener-
alized mmWave MIMO system with Nt transmit antenna and

-50510152010203040506070Average Es /N0  (dB)Average Number of Channel Measurements  RACE Algorithm Simulation: Target PEE = 10-2Best Case, pFB=1Worst Case, pFB=1/K212

(a)

(b)

Fig. 5. Numerical performance results of the proposed algorithms compared to the algorithm presented in [5] for (a) probability of estimation error (PEE)
and (b) average number of measurements required for channel estimation.

l ∈ UN , and AOA, φt

system with N = 27 antennas at both the transmitter and
receiver. We use a single path channel with fading coefﬁcient,
α, assumed to follow a complex Gaussian distribution with
zero mean and variance PR = 1. We assume the corresponding
l ∈ UN , to follow a random
AOD, φt
uniform distribution. We set K = 3 for both of our algorithms
and the algorithm in [5], all requiring S = 3 stages. K 2 = 9
measurements are required in each stage of [5]. However,
in our proposed algorithms, only M = 4 time slots are
involved in each stage the FCE algorithm and a minimum
of M = 4 for the RACE algorithm. The performance of the
RACE algorithm is shown for a number of different values
of maximum measurements, Mmax, and uses a target PEE of
Γ = 10−2. Power allocation among S = 3 stages is applied
to all algorithms as (43).

(cid:80)S

Fig. 5(a) shows the probability of an incorrect AOD/AOA
estimate after the S stages of estimation have been carried out
and Fig. 5(b) shows the average total number of measurements
required for the same estimation. The total energy required in
the overall channel estimation process is calculated by ET =
s=1 Ps(M + R). We can see that, to achieve the same PEE
as that in [5], the FCE algorithm requires 2.5dB more energy
for a given noise power N0. However, the number of required
channel measurements is decreased by a factor of 2.25.

For the RACE algorithm, we can also see that with Mmax =
5, while still signiﬁcantly faster than [5], it has an improved
energy gain for a given PEE compared to Mmax = 4, but still
worse than than [5] by about 1dB. When Mmax is increased
to Mmax = K 2 = 9, we can observe from Fig. 5(a) that
the required energy in this case is around 2.5dB better than
[5]. From Fig. 5(b) we see that when Mmax = K 2 = 9 is
used, the RACE algorithm is always faster than [5] and, at
medium to high SNR (i.e., ET /N0 > 25), the average number
of channel measurements converges to SM. That is, using the
proposed RACE algorithm with Mmax = K 2 achieves 2.25
factor reduction of channel measurements while also achieving
an energy gain of 2.5dB for a given probability of error.

Further increasing the maximum number of measurements to
Mmax = 2K 2 = 18 (i.e., the algorithm at most requires
twice the measurements required of [5]) we see that
the
RACE algorithm achieves an energy gain of 6dB compared
to [5] at medium to high SNR, while requiring an average
of 2.25 times less channel measurements. Furthermore, we
can observe from SNR’s greater than 10.5dB that the average
number of measurements required in the RACE algorithm is
also less than that required by the algorithm in [5].
Finally, Fig. 6 shows the relative MSE in dB of the fading
coefﬁcient α, i.e., | ˆα−α|
. As can be seen, the LMMSE estima-
|α|
tor proposed in section III-F is compared to the one only using
measurements from ﬁnal stage estimation. We can see that
the multi-stage LMMSE estimator improves the performance
accuracy of the fading coefﬁcient estimation for all algorithms.
Interestingly, we also see that the proposed FCE algorithm
has slightly worse estimation accuracy when compared to [5]
at medium SNR range. This is predominantly caused by the
FCE algorithm having a worse PEE for the same SNR. This
performance loss diminishes at high SNR due to the design of
the overlapped beam patterns. For example, in the event that
the FCE algorithm selects an incorrect angular range in the
ﬁnal stage, the next most likely sub-range will still contain
information of α. Fig. 6 also shows that the RACE algorithm
with Mmax = K 2 = 9 is able to estimate the fading coefﬁcient
more accurately at medium SNR when compared to both the
FCE algorithm and the algorithm in [5]. This is because after
the initial M measurements have been made, the algorithm
is more likely to spend additional measurements with beam
patterns directed onto the propagation path.

VII. CONCLUSION

In this paper we have proposed a novel fast channel estima-
tion algorithm for mmWave communication systems based on
a novel overlapped beam pattern design. In general, our pro-
posed algorithm can speed up the channel estimation process
by a factor of K 2/M when compared to existing algorithms

5101520253035404510-310-210-1100Average ET /N0  (dB)PEE  FCE Algorithm, M=4RACE Algorithm, Mmax=5RACE Algorithm, Mmax=9RACE Algorithm , Mmax=18[5, Algorithm 1], K=305101520253010152025303540455055Average ET /N0  (dB)Average Number of   Channel Measurements  FCE Algorithm, M=4RACE Algorithm , Mmax = 5RACE Algorithm , Mmax = 9RACE Algorithm , Mmax = 18[5, Algorithm 1], K = 313

[8] S. Hur, T. Kim, D. Love, J. Krogmeier, T. Thomas, and A. Ghosh,
“Millimeter wave beamforming for wireless backhaul and access in
small cell networks,” IEEE Trans. Commun., vol. 61, no. 10, pp. 4391–
4403, Oct. 2013.

[9] B. Biglarbegian, M. Fakharzadeh, D. Busuioc, M.-R. Nezhad-Ahmadi,
and S. Safavi-Naeini, “Optimized microstrip antenna arrays for emerging
millimeter-wave wireless applications,” IEEE Trans. Antennas Propag.,
vol. 59, no. 5, pp. 1742–1747, 2011.

[10] “Wireless medium access control (MAC) and physical layer (PHY)
speciﬁcations for high rate wireless personal area networks (WPANs),
amendement 2: Millimeter-wave-based alternative physical layer exten-
sion,” IEEE Std 802.15.3c, pp. c1–187, Oct 2009.

[11] J. Wang, Z. Lan, C.-W. Pyo, T. Baykas, C.-S. Sum, M. Azizur Rahman,
R. Funada, F. Kojima, I. Lakkis, H. Harada, and S. Kato, “Beam
codebook based beamforming protocol for multi-gbps millimeter-wave
WPAN systems,” in IEEE J. Select. Areas Commun., 2009, pp. 1390–
1399.

[12] L. Chen, Y. Yang, X. Chen, and W. Wang, “Multi-stage beamforming
codebook for 60GHz WPAN,” in Proc. 6th Int. ICST Conf. Commun.
Network. China, Aug. 2011, pp. 361–365.

[13] A. Sayeed, “Deconstructing multiantenna fading channels,” IEEE Trans.

Sig. Process., vol. 50, no. 10, pp. 2563–2579, Oct. 2002.

[14] Z. Hong, K. Liu, R. W. Heath Jr, and A. M. Sayeed, “Spatial multiplex-
ing in correlated fading via the virtual channel representation,” IEEE J.
Select. Areas Commun.,, vol. 21, no. 5, pp. 856–866, 2003.

[15] J. C. Lagarias, J. A. Reeds, M. H. Wright, and P. E. Wright, “Conver-
gence properties of the nelder–mead simplex method in low dimensions,”
SIAM J. Optim., vol. 9, no. 1, pp. 112–147, 1998.

[16] J. Mo, P. Schniter, N. Gonzalez Prelcic, and R. Heath, “Channel
estimation in millimeter wave mimo systems with one-bit quantization,”
in Proc. Conf. Signals, Syst. Comput., Nov 2014, pp. 957–961.

[17] J. Seo, Y. Sung, G. Lee, and D. Kim, “Pilot beam sequence design
for channel estimation in millimeter-wave MIMO systems: A POMDP
framework,” in Proc. IEEE Signal Process. Adv. Wireless Commun., June
2015, pp. 236–240.

[18] G. MacCartney and T. Rappaport, “73 GHz millimeter wave propagation
measurements for outdoor urban mobile and backhaul communications
in New York City,” in IEEE Int. Conf. on Commun. (ICC), June 2014,
pp. 4862–4867.

[19] M. Akdeniz, Y. Liu, M. Samimi, S. Sun, S. Rangan, T. Rappaport,
and E. Erkip, “Millimeter wave channel modeling and cellular capacity
evaluation,” IEEE J. Select. Areas Commun., vol. 32, no. 6, pp. 1164–
1179, June 2014.

[20] M. Kokshoorn, P. Wang, Y. Li, and B. Vucetic, “Fast channel estimation
for millimetre wave wireless systems using overlapped beam patterns,”
in IEEE Int. Conf. on Commun. (ICC), June 2015, pp. 1304–1309.

[21] W. Bajwa, J. Haupt, A. Sayeed, and R. Nowak, “Compressed channel
sensing: A new approach to estimating sparse multipath channels,” Proc.
IEEE, vol. 98, no. 6, pp. 1058–1076, June 2010.

[22] “Wireless medium access control (mac) and physical layer (phy) speciﬁ-
cations for high rate wireless personal area networks (WPAN)s, amende-
ment 2: Millimeter-wave-based alternative physical
layer extension,
IEEE standard 802.15.3c,” Oct. 2009.

[23] Y. Tsang, A. Poon, and S. Addepalli, “Coding the beams: Improving
beamforming training in mmwave communication system,” in Proc.
IEEE Global Telecomm. Conf., Dec 2011, pp. 1–6.

[24] X. Zhang, A. Molisch, and S.-Y. Kung, “Variable-phase-shift-based RF-
baseband codesign for mimo antenna selection,” IEEE Trans. Signal
Process., vol. 53, no. 11, pp. 4091–4103, Nov 2005.

[25] A. Sayeed and V. Raghavan, “The ideal MIMO channel: Maximizing
capacity in sparse multipath with reconﬁgurable arrays,” in Proc. ISIT,
July 2006, pp. 1036–1040.

[26] J. G. Proakis, Digital communications. New York, NY, USA: McGraw-

[27] R. G. Gallager, “Circularly-symmetric gaussian random vectors,”

Hill, 1995.

preprint, pp. 1–9, 2008.

[28] R. D. Bock and M. Aitkin, “Marginal maximum likelihood estimation
of item parameters: Application of an em algorithm,” Psychometrika,
vol. 46, no. 4, pp. 443–459, 1981.

[29] L. L. Scharf, Statistical signal processing. Addison-Wesley Reading,

[30] G. L. St¨uber, Principles of mobile communication.

Springer Science

MA, 1991, vol. 98.

& Business Media, 2011.

[31] C. E. Shannon, “A mathematical theory of communication,” Bell Syst.

Tech. J., vol. 27, p. 379–423, 1948.

[32] T. Bai, A. Alkhateeb, and R. Heath, “Coverage and capacity of
millimeter-wave cellular networks,” IEEE Commun. Mag., vol. 52, no. 9,
pp. 70–77, 2014.

Fig. 6. Numerical performance results of the proposed algorithms compared
to the algorithm presented in [5] for estimation of the fading coefﬁcient, α.
Results are shown for estimation using just the ﬁnal stage of estimation and
for the the multi-stage approach shown in III-F. The average estimation error
is expressed in dB as | ˆα−α|
|α|

.

with non-overlapped beam patterns. Using a ﬁxed number of
measurements, we show that this reduction of measurements
comes at an energy-to-noise ratio expense of 2.5dB in order
to achieve the same probability of estimation error (PEE).
For channels with rapidly changing channel information, this
cost may be justiﬁed in order to improve the estimation
speed. We have also proposed a novel rate-adaptive channel
estimation algorithm, in which additional measurements are
carried out when a high probability of estimation error is
expected. We show that by taking this approach, the channel
can be estimated more efﬁciently, yielding signiﬁcant gains of
up to 6dB when compared to the algorithm in [5], while still
converging to the same average number of measurements as
the fast channel estimation (FCE) algorithm at high SNR.

REFERENCES

[1] Z. Pi and F. Khan, “An introduction to millimeter-wave mobile broad-
band systems,” IEEE Commun. Mag., vol. 49, no. 6, pp. 101–107, June
2011.

[2] T. S. Rappaport, S. Sun, R. Mayzus, H. Zhao, Y. Azar, K. Wang, G. N.
Wong, J. K. Schulz, M. Samimi, and F. Gutierrez, “Millimeter wave
mobile communications for 5G cellular: It will work!” IEEE Access,
vol. 1, pp. 335–349, May 2013.

[3] W. Hong, K.-H. Baek, Y. Lee, Y. Kim, and S.-T. Ko, “Study and
prototyping of practically large-scale mmwave antenna systems for 5g
cellular devices,” Communications Magazine, IEEE, vol. 52, no. 9, pp.
63–69, 2014.

[4] S. Rangan, T. Rappaport, and E. Erkip, “Millimeter-wave cellular
wireless networks: Potentials and challenges,” Proc. IEEE, vol. 102,
no. 3, pp. 366–385, March 2014.

[5] A. Alkhateeb, O. El Ayach, G. Leus, and R. Heath, “Channel estimation
and hybrid precoding for millimeter wave cellular systems,” IEEE J. Sel.
Topics Signal Process., vol. 8, no. 5, pp. 831–846, Oct. 2014.

[6] H. Zhang, S. Venkateswaran, and U. Madhow, “Channel modeling and
MIMO capacity for outdoor millimeter wave links,” in Proc. Wireless
Commun. Netw. Conf. (WCNC), Apr. 2010, pp. 1–6.

[7] E. Torkildson, H. Zhang, and U. Madhow, “Channel modeling for
IEEE,

millimeter wave mimo,” in Proc. Inf. Theory Appl. Workshop.
2010, pp. 1–8.

05101520253035404550-50-40-30-20-10010Average ET/N0 (dB)MSE (dB)  FCE Algorithm, M=4, Multi-stage EstimationFCE Algorithm, M=4, Final-stage EstimationRACE Algorithm, Mmax=9, Multi-stage EstimationRACE Algorithm, Mmax=9, Final-stage Estimation[5, Algorithm 1], M=9, Multi-stage Estimation[5, Algorithm 1], M=9, Final-stage Estimation