6
1
0
2

 
r
a

 

M
5
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
3
6
5
4
0

.

3
0
6
1
:
v
i
X
r
a

Non-emptiness of Newton strata of Shimura varieties of Hodge type

Dong Uk Lee

Abstract

For a Shimura variety of Hodge type with hyperspecial level at a prime p, the Newton
stratiﬁcation on its special ﬁber at p is a stratiﬁcation deﬁned in terms of the isomorphism class
of the Dieudonne module of parameterized abelian varieties endowed with a certain ﬁxed set
of Frobenius-invariant crystalline cycles (“F -isocrystal with GQp -structure”). There has been a
conjectural group-theoretic description of the F-isocrystals that are expected to show up in the
special ﬁber. We conﬁrm this conjecture by two diﬀerent methods. More precisely, for any F -
isocrystal with GQp -structure that is expected to appear (in a precise sense), ﬁrst we construct
a special point which has good reduction and whose reduction has associated F -isocrystal equal
to given one. Secondly, we produce a Kottwtiz triple (with trivial Kottwitz invariant) with
the F -isocrystal component being the given one. According to a recent result of Kisin which
establishes the Langlands-Rapoport conjecture, such Kottwitz triple arises from a point in the
reduction.

Contents

1 Introduction

2 F -isocrystals and Newton maps for reductive groups over p-adic ﬁelds

2.1 Preliminaries
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Newton maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

6
6
7

3 Newton stratiﬁcation on good reduction of Shimura variety

9
9
3.1
3.2 Newton stratiﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

Integral canonical model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Construction of special Shimura datum with prescribed F -isocrystal

18

4.1 Construction of special Shimura datum with prescribed F -isocrystal satisfying con-

dition (†)

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
4.2 Aﬃne Deligne-Lusztig varieties and veriﬁcation of the assumption (†)
. . . . . . . . 21
4.3 First proof of non-emptiness of Newton strata . . . . . . . . . . . . . . . . . . . . . . 27

5 Construction of Kottwitz triple with prescribed F -isocrystal

29
5.1 Kottwitz triples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
5.2 Kottwitz invariant
5.3 Second proof of non-emptiness of Newton strata
. . . . . . . . . . . . . . . . . . . . 32

A A lemma on algebraic groups over p-adic ﬁelds

36

1

1

Introduction

Fix a prime p > 0, and for g ≥ 1, let Ag be the moduli space of principally polarized abelian
varieties of dimension g in characteristic p. Then, the Newton stratiﬁcation on Ag is the stratiﬁ-
cation such that each stratum consists of points x = (Ax, λx) whose associated p-divisible group
(Ax[p∞], λx[p∞]) with quasi-polarization is quasi-isogenous to a ﬁxed one. The Dieudonn´e module
D(X) of a p-divisible group X over a perfect ﬁeld k of characteristic p > 0 provides an equiv-
alence of categories between the isogeny category of (quasi-polarized) p-divisible groups and the
category of (quasi-polarized) F -isocrystals. An F -isocrystal (or simply isocrystal) over a perfect
ﬁeld k of chark = p is a ﬁnite-dimensional L(k)-vector space M with a σ-linear bijective operator
Φ : M → M , where L(k) := Frac(W (k)) and σ is its Frobenius automophism. According to the
Dieudonn´e-Manin classiﬁcation, an isocrystal over an algebraically closed ﬁeld is determined by the
slope sequence of Φ. The latter combinatorial datum in turn can be faithfullly represented by a
lower-convex (piecewise-linear) polygon with integral break points lying in the ﬁrst quadrant of Z2,
which will be called Newton polygon hereafter. In other words, the Newton polygon of D(Ax[p∞])
determines the quasi-isogeny class of Ax[p∞]. The existence of a quasi-polarization forces the New-
ton polygon of D(Ax[p∞]) to be “symmetric”. Then, a natural question arises which symmetric
Newton polygon can be the Newton polygon of a point of Ag. In fact, the Newton polygons arising
from points of Ag in the just described way meet two more restrictions. First, when the initial
point is located at the origin, the end point is always (2g, g) ∈ Z2. Secondly, it “lies above” the
ordinary Newton polygon, which by deﬁnition is the Newton polygon having two slopes (0, 1) with
same multiplicities g. And, it has long been known (after it was conjectured by Manin) that any
Newton polygon subject to these two restraints is the Newton polygon of a point on Ag; a proof can
be found e.g. in [Oor13, Cor.7.8], which uses the Honda-Tate theory, thus gives examples deﬁned
over ﬁnite ﬁelds.

The main result of this article is a generalization of this fact to more general moduli spaces of

abelian varieties, namely to Shimura varieties of Hodge type.

Let (G, X) be a Shimura datum of Hodge type. This means that there exists an embedding of
Shimura data (G, X) ֒→ (GSp(W, ψ), H±
g ) into a Siegel Shimura datum, in the sense that there exists
an embedding ρW : G ֒→ GSp(W, ψ) of Q-groups which sends each morphism in X to a member
of H±
g ; we ﬁx such an embedding. For a compact open subgroup K ⊂ G(Af ) (which will be tacitly
assumed suﬃciently small), the associated (canonical model over the reﬂex ﬁeld E(G, X) of the)
Shimura variety ShK(G, X) parameterizes polarized abelian varieties endowed with a ﬁxed set of
(absolute) Hodge cycles and a K-level structure, and carries a universal family of abelian varieties
A → SK := ShK(G, X) equipped with a similar set of (absolute Hodge) tensors on H 1
dR(A/SK ).
To study its reduction modulo p, we ﬁx a prime ℘ of E := E(G, X) and let O := O(℘) be the
localization at ℘ of the ring of integers of E with residue ﬁeld κ(℘). To obtain an integral model
over O with good reduction, we assume that G ⊗Q Qp is unramiﬁed, which is the same as that there
exists a reductive group scheme GZp over Zp with generic ﬁbre G ⊗ Qp. We choose one such model
GZp and set Kp := GZp(Zp) (such compact open subgroups of G(Qp) are called hyperspecial).
For K, we take K = Kp × K p for a (suﬃciently small) compact open subgroup K p ⊂ G(Ap
f ).
Then, by Vasiu ([Vas99]) and Kisin ([Kis10]), it is known that there exists a smooth integral model
SK := SK(G, X) over O with generic ﬁbre SK, which is furthermore uniquely characterized by
a “Neron-extension property”, and has a universal abelian scheme A over it by construction (see
§3.1 for details). To deﬁne the F -isocrystal attached to a point of the reduction SK ⊗O κ(℘), we

2

ﬁx (for simplicity) an algebraically closed ﬁeld k of ﬁnite transcendence degree over ¯Fp. Let z be a
point of SK ⊗O κ(℘) deﬁned over k. By smoothness of SK and the moduli interpretation of SK,
the Dieudonne module D(Az) is supplied with a set of Frobnius-invariant tensors {tα,z}α∈J , and
there exists an L(k)-isomorphism between the dual space W ∨ ⊗ L(k) and the Dieudonne module
D(Az) which matches the G-invariant tensors on W ∨ and the tensors {tα,z}α∈J on D(Az), which
is thus canonically determined up to the action of GL(k) on W ∨
L(k) (cf. §3.2). Choosing such an
isomorphism, we transport the Frobenius operator Φ to W ∨
L(k) and get an element b ∈ G(L(k)) by
Φ = ρW ∨(b)(idW ∨ ⊗ σ), where ρW ∨ : G ֒→ GL(W ∨) is the contragredient representation of the
symplectic representation ρW ﬁxed above. Recall that two elements g1, g2 of G(L(k)) are called
σ-conjugate if there exists h ∈ G(L(k)) with g2 = hg1σ(h)−1. Then, the σ-conjugacy class b of b is
independent of the choice of an isomorsphim W ∨
L(k) → D(Ax) just explained, and the isomorphism
class of the F -isocrystal (D(Az), Φ) equipped with the Frobenius-invariant tensors {tα,z}α∈J , called
F -isocrystal with GQp-structure, corresponds to a unique σ-conjugacy class of elements of G(L(k)).
If B(GQp) denotes the set of the σ-conjugacy classes of elements of G(L(k)), there exists a subset
B(GQp, X) of B(GQp) which is expected to be the set of isocrystals with GQp-structure coming
from points on SK ⊗O κ(℘). We remark that this is a subset of B(GQp) deﬁned by certain two
conditions that are analogues of those discussed above in the Siegel case, and it is easy to see that
for any point of SK ⊗O κ(℘), its associated F -isocrystal with GQp-structure belongs to this subset
B(GQp, X). A detailed presentation of the discussion in this paragraph is given in Section 3.

For b ∈ B(GQp, X), let S

b be the subset of points of SK ⊗O κ(℘) whose associated F -isocrystal
with GQp-structure is b. The main result of this paper is then that for every b ∈ B(GQp, X),
b is non-empty. We present two proofs. The main idea of the ﬁrst proof is to ﬁnd a special
S
point with required reduction property. We recall that a point [h, gf · K] ∈ ShK(G, X)(C) =
G(Q)\X × G(Af )/K is called special if h ∈ X factors through TR for some maximal Q-torus T
of G. Special points are known to be deﬁned over Q ⊂ C and correspond to abelian varieties
with complex multiplication. More precisely, in the ﬁrst proof, we construct a special point which
extends to a point SK(Oιp), where Oιp is the valuation ring of Q deﬁned by chosen embedding
ιp : Q ֒→ Qp (in which case, we will say that it has good reduction at ιp) and such that the isocrystal
of its reduction in SK(¯Fp) is the given isocrystal.

Theorem 1.0.1 (Thm. 4.3.1). Let (G, X) be a Shimura datum and p a rational prime. Assume
that GQp is unramiﬁed. Fix a hyperspecial subgroup Kp of G(Qp) and a suﬃciently small compact
open subgroup K p ⊂ G(Ap
f ); put K = Kp × K p. Choose a prime ℘ of E(G, X) above p, and an
embedding ιp : Q ֒→ Qp inducing ℘.

Then, for every b ∈ B(GQp, X), there exists a special sub-Shimura datum (T, h ∈ Hom(S, TR) ∩
X) such that TQp is unramiﬁed and the (unique) hyperspecial subgroup of T (Qp) is contained in
Kp, and that the σ-conjugacy class of µ−1

p ) equals b.

h (p) ∈ G(Qur

In particular, if (G, X) is of Hodge type, for every gf ∈ G(Af ), the special point [h, gf ]K ∈

ShK(G, X)(Q) has good reduction at ιp and the F -isocrystal of its reduction in SK (¯Fp) is b.

The non-emptiness of Newton strata has been conjectured by Fargues [Far04, Conjecture 3.1.1]
and Rapoport [Rap05, Conjecture 7.1]. And, some partial cases conﬁrming this conjecture were
known.
In this introduction, we only mention previous works in two directions. For PEL-type
Shimura varieties (which form a subclass of Hodge-type Shimura varieties), this conjecture (i.e.
non-emptiness of all Newton strata in B(GQp, X)) was proved by C.-F. Yu [Yu05] in the Lie-type

3

C cases, then by Viehmann-Wedhorn [VW13, Thm.1.6] in general cases, and by Kret [Kre13] for
some simple groups of Lie type A or C. For a general Hodge-type Shimura variety, to the best of the
author’s knowledge, there are two partial results. First, Wortmann [Wor13] showed non-emptiness
of µ-ordinary locus; the µ-ordinary locus is a generalization of the (usual) ordinary locus in Ag.
And, for projective Shimura varieties of Hodge type, Koskivirta [Kos14] proved the conjecture
(non-emptiness of all Newton strata).

While all these previous results on the non-emptiness of Newton strata, except for that of Kret,
are obtained by characteristic-p geometric methods, which are often of limited applicability for
Hodge-type Shimura varieties, we draw reader’s attention to that the ﬁrst claim of our theorem
above is a purely group-theoretic statement on Shimura data without any reference to geometry of
Shimura variety. When the Shimura datum is of Hodge type, this group-theoretic statement carries
a geometric meaning of the second claim (by Lemma 3.2.4). In this geometric interpretation of
the group-theoretic statement of the ﬁrst claim, the only geometric property that we use about the
canonical integral model SK is the Neron-extension property, which is in the end a consequence of
smoothness of SK .

We also point out that our method of proof of the theorem, more precisely that of constructing
a special point with certain prescribed properties, allows us to obtain some ﬁner results. First,
as already apparent, we prove more than just non-emptiness of Newton strata, namely we show
existence of a special point whose reduction lying in any given Newton stratum. As another
example, we also prove a generalization of a result of Wedhorn [Wed99, (1.6.3)] (the next result in
the PEL-type cases of Lie type A or C) (by argument diﬀerent from the original one of Wedhorn,
cf. Remark 4.3.3).

Corollary 1.0.2. (Cor. 4.3.2) Let (G, X) be a Shimura datum of Hodge type. Suppose that GQp is
unramiﬁed and choose a hyperspecial subgroup Kp of G(Qp). Let ℘ be a prime of E(G, X) above p.
Then the reduction SKp(G, X) × κ(℘) has non-empty ordinary locus if and only if ℘ has absolute
height one (i.e. E(G, X)℘ = Qp).

Our second proof of the non-emptiness of Newton strata is by construction of a Kottwtiz triple.

A Kottwitz triple is a triple of elements in the product

(γ0; γ = (γl)l6=p, δ) ∈ G(Q) × G(Ap

f ) × G(Qur
p ),

satisfying certain compatibility conditions among themselves and some other conditions.
It has
been expected that one can attach such triple to every point of SK over a ﬁnite ﬁeld, such that
γl(l 6= p) is the (relative) Frobenius acting on the l-adic etale cohomology and δ is the (absolute)
Frobenius on the crystalline cohomology of the abelian variety corresponding to the point. This
was established by Kisin in the course of his proof of the Langlands-Rapoport conjecture ([Kis13]).
In fact, this Langlands-Rapoport conjecture implies that every Kottwitz triple meeting suitable
conditions (especially, vanishing of the Kottwitz invariant) also comes from a point over a ﬁnite
ﬁeld. Therefore, in view of this, our second proof is deduced from the following result:

Theorem 1.0.3 (Thm. 5.3.1, Cor. 5.3.3). Keep the assumptions and notations from the above
theorem, and assume further that the derived group Gder of G is simply connected.

Then, for every b ∈ B(GQp, X), there exists a Kottwitz triple (γ0; γ, δ) ∈ G(Q × Ap

p ) with
δ ∈ b and having trivial Kottwitz invariant. In particular, there exists a point x ∈ ShKp(G, X)(¯Fp)
whose associated F -isocrystal is b, where ¯Fp is an algebraic closure of κ(℘).

f × Qur

4

We refer readers to §6 for the deﬁnitions of Kottwitz triple and Kottwitz invariant, and also to

Theorem 5.3.1 for a more precise statement of the result in this theorem.

Our two proofs of the non-emptiness of Newton strata are not unrelated. Both are based on
the fact that for every b ∈ B(GQp, X), the condition (†) in Theorem 4.1.1 holds. We verify this
in Proposition 4.2.4 in two ways. In fact, this was proved in [LR87], Lemma 5.11. However, we
also present our own proof which was found before the proof of Langalnds-Rapoport came to our
attention. Our proof is similar to theirs, but also diﬀers in details.

Finally, we remark that since our methods of proof of the above results are purely group-
theoretic (making heavy use of Galois cohomology of algebraic groups), they are very likely to
apply to more general Shimura varieties, particularly to Shimura varieties of abelian-type and/or
with non-hyperspecial level. We did not pursue such ideas in this article, though.

This article is organized as follows. In Section 2, we give a brief account of the theory of Newton
map for reductive groups over p-adic ﬁelds and provide a collection of some basic facts. In Section
3, we review the construction of the canonical integral model SKp(G, X) of a Hodge-type Shimura
variety ShKp(G, X) with hyperspecial level, due to Vasiu and Kisin, and the Newton stratiﬁcation
on its (good) reduction SKp(G, X) ⊗ κ(℘). Here, we give a criterion when a special point on
ShK(G, X) has good reduction at given embedding ιp : Q ֒→ Qp, and identiﬁes the F -isocrystal of
its reduction in terms of the deﬁning special Shimura datum. Section 4 is devoted to the ﬁrst proof
of the non-emptiness of Newton strata, by constructing a special point with good reduction at ιp
and with prescribed F -isocrystal. Our construction is carried out, assuming that given isocrystal
b ∈ B(GQp) satisﬁes the condition (†) in Theorem 4.1.1. Then, we verify that the condition (†)
holds for every isocrystal b ∈ B(GQp). We ﬁrst present the proof of Langlands-Rapoport [LR87,
Lemma5.11] of this, and then our own argument. Combining these results, we get our ﬁrst proof
of non-emptiness of Newton strata. As a corollary, we also obtain a criterion of when the good
reduction of a Shimura variety with hyperspecial level has an ordinary point. In the ﬁnal section,
Section 5, we give our second proof of the non-emptiness of Newton strata, by constructing a
Kottwtiz triple with prescribed isocrystal component. We begin by a review of the deﬁnitions
of Kottwitz triple and Kottwitz invariant. Our construction of such Kottwitz triple (with trivial
Kottwitz invariant) also uses the aforementioned fact that every isocrystal b ∈ B(GQp, X) satisﬁes
the condition (†).

Acknowledgements This work was supported by IBS-R003-D1. Also, parts of this research
were conducted during the author’s stay at PMI (Pohang Mathematics Institute), Postech, and
ASARC (Algebraic Structures and Applications Research Center), Kaist, with support from the
National Research Foundation of Korea (NRF) funded by the Korea government (MSIP) (No.
2011-0030749 and No. 2012-0000798).

Notations
Throughout this paper, Q denotes the algebraic closure of Q inside C (so Q has a previliged

embedding into C).

For a (connected) reductive group G over a ﬁeld, we let Gsc be the universal covering of its
derived group Gder, and for a (general linear algebraic) group G, Z(G) and Gad denote its center
and the adjoint group G/Z(G), respectively.

5

2 F -isocrystals and Newton maps for reductive groups over p-adic

ﬁelds

In this section, we give a brief review of the Newton map which is deﬁned for connected reductive
groups over p-adic ﬁelds. For more details on the material discussed in this section, see, e.g. [Kot85],
[RR96], [Rap05] and references therein.

2.1 Preliminaries Let G be a connected reductive group over an arbitrary ﬁeld F of charac-
teristic zero.

2.1.1 Any Borel pair (T, B) of GF (i.e. T is a maximal torus of GF and B is a Borel subgroup of
GF containing T ) determines a based root datum

BR(G, T, B) = (X ∗(T ), R∗(T ), X∗(T ), R∗(T ), ∆(T, B)),

where R(G, T ) = (X ∗(T ), R∗(T ), X∗(T ), R∗(T )) is the root datum of (G, T ) (the usual notation)
and ∆(T, B) is the root base of R∗(T ) determined by B. A based root datum of G has a canonical
Galois action τ : Gal(F /F ) → Aut(BR(G, T, B)) [Spr98, 15.5] such that for x ∈ X ∗(T ), σ ∈
Gal(F /F ),

τ (σ)x = gσ(x)g−1,

where g ∈ G(F ) satisﬁes gσ(T, B)g−1 = (T, B); this action can be also understood as a natural
action of Gal(F /F ) on the orbit space X∗(T )/Ω(G, T ), where Ω(G, T ) = NG(T )/ZG(T ) is the Weyl
group of G, i.e. NG(T ) (resp. ZG(T )) is the normalizer (resp. centralizer) of T in G.

2.1.2 Let C(T, B) ⊂ X∗(T )Q be the closed Weyl chamber corresponding to a root base ∆(T, B)
of R∗(T ):

C(T, B) = {x ∈ X∗(T )Q | hα, xi ≥ 0, ∀α ∈ ∆(T, B)}.

This is a fundamental domain for the action of the Weyl group on X∗(T )Q and is stable under
the action of Gal(F /F ) just deﬁned. Note that when T is deﬁned over F , we also have a “naive”
Galois action on X∗(T ) deﬁned in terms of the F -structure of T only.
In this article, we call
the former action on C(T, B) canonical action, to distinguish it from the naive action on X∗(T ).
When G is quasi-split, i.e. when there is a Borel subgroup B of G deﬁned over F , the naive action
on X∗(T ) restricts to the canonical action on C(T, B). For any other Borel pair (T ′, B′), there
is g ∈ G(F ) such that (T ′, B′) = g(T, B)g−1 and the resulting isomorphism of based root data
∼→ BR(G, T ′, B′) is independent of the choice of g and is Gal(F /F )-equivariant. The
BR(G, T, B)
based root datum BR(G) = (X ∗, R∗, X∗, R∗, ∆) of G is the projective limit of all such based root
data BR(G, T, B) (where (T, B) runs through the set of Borel pairs of GF ). This is equipped with
a canonical Galois action Gal(F /F ) → Aut(BR(G)).

2.1.3 For an algebraically closed extension K of F , let CG(K) denote the set of G(K)-conjugacy
classes of (algebraic group) homomorphisms Gm,K → GK . Then, for any maximal torus T of GF ,
we have a canonical identiﬁcation

CG(K) ∼= X∗(T )/Ω.

In particular, we have CG(K) = CG(F ) for any algebraically closed extension K of F .

6

2.2 Newton maps Next, we review the deﬁnition of Newton map. Let k be an algebraically
closed ﬁeld of characteristic p, and let W (k) (resp. K0 = L(k)) be its Witt vector ring (resp. the
fraction ﬁeld of W (k)). Fix an algebraic closure K0 of K0. In this subsection, let F be a ﬁnite
extension of Qp in K0, and let L be the composite of K0 and F in K0; for our application to
Shimura varieties, the most interesting case is when k = ¯Fp, F = Qp so that L = L(¯Fp). Denote
by σ the Frobenius automorphism on K0 (and its extension to an element of Aut(L/F )). Let G be
a connected reductive group G over F . Let GalF := Gal(F /F ).

2.2.1 Let B(G) be the set of σ-conjugacy classes in G(L):

B(G) = G(L)/ ∼,

where two elements x, y of G(L) are σ-conjugated, denoted by x ∼ y, if x = gyσ(g)−1 for some
g ∈ G(L). An element of B(G) is called (F -)isocrystal with G-structure.

2.2.2 Let D be the pro-algebraic torus with character group Q. We deﬁne N (G) to be the set of
σ-invariants in the set of conjugacy classes of homomorphisms DL → GL:

N (G) = (Int G(L) \ HomL(D, G))hσi,

where hσi denotes the inﬁnite cyclic group generated by σ (and is endowed with the discrete
topology). For example, when G = T is a torus, we have N (T ) = X∗(T )GalF ⊗ Q.

If T ⊂ G is a maximal F -torus with (absolute) Weyl group Ω, there is a natural identiﬁcation

N (G) = (X∗(T )Q/Ω)GalF .

In particular, if G is quasi-split and T is a maximal F -torus contained in a Borel subgroup B
deﬁned over F , N (G) can be identiﬁed with the subset of GalF -invariants in C(T, B).

Theorem 2.2.3. [RR96, Theorem 1.8] For b ∈ G(L), there exists a unique element ν = νb ∈
HomL(D, G) for which there are an integer s > 0, an element c ∈ G(L) and a uniformizing element
π of F such that:

(i) sν ∈ HomL(Gm, G).
(ii) Int(c) ◦ sν is deﬁned over the ﬁxed ﬁeld of σs in L.
(iii) c · b · σ(b) · · · σs−1(b) · σs(c)−1 = c · (sν)(π) · c−1.

The map b 7→ νb has the following properties.

(a) νσ(b) = σ(νb).
(b) gbσ(g)−1 7→ Int(g) ◦ ν, g ∈ G(L).
(c) νb = Int(b) ◦ σ(νb).

By the properties (b) and (c), we obtain a well-deﬁned map νG : B(G) → N (G). The induced
functorial map ν, deﬁned on the category of connected reductive groups, is called the Newton map:

ν : B(·) → N (·) ; νG(b) = νb,

b ∈ b.

Here, b (resp. νb) is the σ-conjugacy class of b (resp. the conjugacy class of νb). When G = GLh,
B(G) classiﬁes the isomorphism classes of σ − L-spaces of height h, and the Newton map sends a
σ − L-space of height h to its Newton polygon which is represented in N (G) by the corresponding
slope homomorphism (cf. Example 1.10 of [RR96]).

7

2.2.4 Recall the canonical action of GalF on a based root datum BR(G, T, B) (cf. Subsection
2.1). The induced action of GalF on

π1(G, T ) := X∗(T )/Σα∈∆(G,T )Zα∨

is independent of the choice of B, where Φ(G, T ) denotes the set of roots of T and for α ∈ Φ(G, T ),
α∨ is the coroot of α. Moreover, for another maximal torus T ′ of G, we have a canonical isomorphism
π1(G, T ) = π1(G, T ′) of GalF -modules. The algebraic fundamental group π1(G) of G is deﬁned
to be this common GalF -module; The functor is an exact functor from the category of connected
reductive groups over F to the category of ﬁnitely generated discrete ΓF -modules, cf. [RR96, 1.13].
For a torus T = G, we have

π1(T ) = X∗(T ).

The functor π1(·)GalF ⊗ Q deﬁnes an exact functor from the category of connected reductive groups
over F to the category of ﬁnite-dimensional Q-vector spaces. There is a canonical isomorphism

X ∗(Z(bG)GalF ) = π1(G)GalF ,

where Z(bG) denotes the center of the Langlands dual group of G and

π1(G)GalF = π1(G)/hτ x − x | τ ∈ GalF , x ∈ π1(G)i

is the group of coinvariants of π1(G) for the canonical action of GalF .

Theorem 2.2.5 ([RR96], Theorem 1.15). (i) There exists a unique natural transformation1

κ : B(·) → π1(·)GalF

of set-valued functors on the category of connected reductive groups over F such that on Gm we
have

κGm(b) = ordL(b) (b ∈ L×),

where the valuation on L is normalized by ordL(πL) = 1 for a uniformizer πL, and for tori it is an
isomorphism.

(ii) There is a unique natural transformation of functors on the category of connected reductive

groups

such that for a torus this is the natural identiﬁcation

δ : N (·) → π1(·)GalF ⊗ Q

N (T ) = X∗(T )GalF ⊗ Q = π1(T )GalF ⊗ Q.

(iii) The following diagram is functorial (in the sense of pointed sets)

νG

B(G)

κG

N (G)

δG

π1(G)GalF

αG/

/ π1(G)GalF ⊗ Q.

1In [RR96], Theorem 1.15, this map is denoted γ, but here we changed it to κ, a notation which seems to be more

popular in recent literatures.

8

/
/




Here, the map αG in the bottom is given by

µ 7→ |GalF · µ|−1 X

µ′.

µ′∈GalF ·µ

For a detailed discussion of this theorem, we refer to [Kot85].

3 Newton stratiﬁcation on good reduction of Shimura variety

In this section, we give an account of the construction of the Newton stratiﬁcation on the reduction
of the integral canonical model of a Hodge-type Shimura variety. For the theory of the integral
canonical model of Shimura variety of Hodge type, we follow [Vas99], [Kis10] (see also [Vas08],
[Kis09] for a survey of the main results).

3.0.6 Let (G, X) be a Shimura datum. For a morphism h : S → GR in X, the associated Hodge
cocharacter

µh : GmC → GC

is the composite of hC : SC → GC and the cocharacter of SC ∼= QC֒→C GmC corresponding to the

identity embedding C ֒→ C. Let c(G, X) denote the G(C)-conjugacy class of cocharacters of GC
containing µ−1
(not µh), for an arbitrary h ∈ X. For a maximal torus T of GQ, we can consider
h
c(G, X) as an element of X∗(T )/Ω. Alternatively, when we ﬁx a based root datum BR(G, T, B),
c(G, X) has a unique representative in the associated closed Weyl chamber C(T, B). We will also
identify the conjugacy class c(G, X) with this representative:

c(G, X) ∈ C(T, B).

The reﬂex ﬁeld E(G, X) of a Shimura datum (G, X) is the ﬁeld of deﬁnition of c(G, X) ∈ CG(Q),
the ﬁxed ﬁeld of the stabilizer of c(G, X) in Gal(Q/Q); so a reﬂex ﬁeld, which is a ﬁnite
i.e.
extension of Q, is always a subﬁeld of C, cf.
[Del77, Lemme1.2.4]. When T is a torus, the reﬂex
ﬁeld E(T, {h}) is just the smallest subﬁeld of Q ⊂ C over which the single morphism µh is deﬁned.

3.1
Integral canonical model Let (G, X) be a Shimura datum of Hodge type provided with
an embedding ρ : (G, X) → (GSp(W, ψ), H±). Consider a compact open subgroup K of G(Af ) of
the form K = KpK p, where Kp (resp.K p) is a compact open subgroup of G(Qp) (resp. of G(Ap
f )).
Lemma 3.1.1. Suppose p > 2.
If Kp is a hyperspecial subgroup (i.e. Kp = GZp(Zp) inside
G(Qp) for a reductive group scheme GZp over Zp with generic ﬁber GQp := G ⊗Q Qp), for every
suﬃciently small K p, there exist a lattice WZ of W , compact open subgroups Hp ⊂ GSp(W, ψ)(Qp),
H p ⊂ GSp(W, ψ)(Ap
embedding (of weakly canonical models of Shimura varieties)

f ), such that H := HpH p leaves WbZ := WZ ⊗ bZ stable and that ρ induces an

ShK (G, X) ֒→ ShH(GSp(WZ, ψ), H±) ⊗Q E(G, X).

Proof. This is shown in [Kis10, (2.3)]. We give a brief summary of it (also see the introduction
of [Vas08]). According to [Kis10, Lem.(2.3.1)], there exists a lattice WZ of W such that ρQp : GQp ֒→
GL(WQp) is induced by a closed embedding ρZp : GZp ֒→ GL(WZp), where WZp := WZ ⊗Z Zp. Fix

such a WZ. Then, for K p small enough, K p leaves WZ ⊗Z bZ(p) as well. Finally, when we take

Hp ⊂ GSp(W, ψ)(Qp) to be the stabilizer of WZp, the existence of H p with the required property
is established in (2.1.2) of [Kis10] (cf. [Noo96, Lem. 3.3]).

9

3.1.2 For suﬃciently small compact open subgroup H of GSp(Af ), let Ag,d,H denote the ﬁne
moduli scheme over Z(p) representing the functor which, with any Z(p)-scheme T , associates the
isomorphism classes of an abelian scheme equipped with a polarization of degree d and a level
H-structure (cf. [Kot85]). Choose a prime ℘ of E(G, X) above p and let O(℘) be the localization
at ℘ of the ring of integers OE(G,X) of E(G, X). After modifying WZ by a scalar multiple, we may
assume that ψ is Z-valued on WZ. Let W ∨
Z be the dual lattice of WZ (with respect to ψ). If we
take a compact open subgroup H of GSp(Af ) as in Lemma 3.1.1 and d := [W ∨
Z : WZ], there is a
natural embedding of O(℘)-schemes

We denote by SK(G, X) the normalization of the closure of ShK (G, X) in Ag,d,H ⊗Z(p) O(℘). Set

ShK(G, X) ֒→ Ag,d,H ⊗Z(p) O(℘).

SKp(G, X) = lim←−
K p

SKpK p(G, X),

where K p runs over suﬃciently small compact open subgroups of G(Ap

f ).

The following theorem was conjectured by Langlands, Milne (cf. [Mil92], Conjecture 4.25), and

was established by Vasiu ([Vas99], [Vas07], [Vas08]) and Kisin ([Kis09], [Kis10]).

Theorem 3.1.3. Retain previous assumptions (particularly, p > 2 and Kp is hyperspecial).

(1) The scheme SKp(G, X) is an inverse limit of smooth O(℘)-schemes with ﬁnite ´etale transi-

tion maps, whose restriction to E(G, X) can be G(Ap

f )-equivariantly identiﬁed with ShKp(G, X).

(2) The scheme SKp(G, X) has the following extension property:

for any regular, formally
smooth O(℘)-scheme S, every E(G, X)-morphism SE(G,X) → ShKp(G, X) extends uniquely over
O(℘).

In particular, SKp(G, X) itself is regular and formally smooth over O(℘). We call the O(℘)-
(pro)schemes SK (G, X) and SKp(G, X) integral canonical model of ShK (G, X) and ShKp(G, X),
respectively.
Remark 3.1.4. This deﬁnition of the extension property is due to Kisin ([Kis10], Thm. (2.3.8)). It
diﬀers slightly from that of Vasiu, who uses, as test schemes, healthy regular schemes over O(℘)
([Vas99, 3.2]) instead of regular, formally smooth O(℘)-schemes. But, when GQp is unramiﬁed,
every regular, formally smooth scheme over O(℘) is also healthy regular over O(℘), because O(℘)
is unramiﬁed over Z(p) ([Mil94], Cor. 4.7 (a)) and over any d.v.r unramiﬁed over Z(p), every
regular, formally smooth scheme is healthy regular (if p > 2), according to a lemma of Faltings
([Moo98, 3.6]). Consequently, this diﬀerence (and related other minor diﬀerences) will not aﬀect our
arguments involving the integral canonical models, since our use of the integral canonical models
will be only restricted to its extension property for discrete valuation rings unramiﬁed over O(℘).

3.2 Newton stratiﬁcation We keep the notations and assumptions from the previous subsec-
tion. In particular, we are given a hyperspecial subgroup Kp of G(Qp), and accordingly a reductive
group scheme GZp over Zp with generic ﬁbre GQp and such that GZp(Zp) = Kp. Also, choose a
lattice WZ of W and a closed embedding

ShK(G, X) ֒→ ShH(GSp(WZ, ψ), H±) ⊗Q E(G, X)

as in Lemma 3.1.1. Further, we ﬁx an embedding ιp : E(G, X) ֒→ Qp inducing ℘ on E(G, X). Let
SK ⊗ κ(℘) and SKp ⊗ κ(℘) be the reductions of SK and SKp at ℘, respectively. In this subsection,
we deﬁne the Newton stratiﬁcation on these schemes, following [Rap05], [Vas08], [Wor13].

10

3.2.1 For a vector space or a free module over a d.v.r V , let T (V ) be the tensor space attached
to V , i.e. T (V ) = ⊕s,t∈Z≥0V ⊗s ⊗ (V ∨)⊗t. Let {sα}α∈J be the set of tensors on WQ ﬁxed under the
extended action of GQ ֒→ GL(W ) on T (W ).

Let (π : A → ShK , λA) be the pull back to ShK = ShK(G, X) of the universal abelian scheme
with a polarization of degree d over Ag,d,H, where as usual we assume K p to be suﬃciently small for
this to make sense. We have the local system W := R1(πan)∗Q of Q-vector spaces and the (analytic)
vector bundle Wan
with Gauss-Manin connection (which is an integrable
connection with regular singularities); by Deligne’s theorem, the latter is the analytiﬁcation of
a unique algebraic vector bundle W := R1π∗Ω•
with integrable connection over ShK. Each
tensor sα deﬁnes a global section sα,B of the local system T (W) and also a global section sα,dR of
the vector bundle T (W) ([Kis10, (2.2)]).

C := R1(πan)∗Ω•

AC/ShK

A/ShK

dR(Ax/F ) and H m

Now, let F ⊃ E(G, X) be an extension which can be embedded in C; we ﬁx an embedding
σ∞ : F ֒→ C which extends the given embedding E(G, X) ֒→ C. For x ∈ ShK(G, X)(F ), let Ax
be the corresponding abelian variety over F , and let H m
´et (Ax ⊗F F , Qp) denote
respectively the de Rham cohomology of Ax/F and the ´etale cohomology of Ax⊗F F . For each tensor
sα ∈ T (W ), let sα,B,σ∞(x) ∈ T (H 1
B(σ∞(Ax), Q)) denote the ﬁbre of sα,B at σ∞(x) ∈ ShK(G, X)(C);
by the moduli interpretation of the complex points of ShK (G, X) ([Mil94, Prop.3.9]), there is an
isomorphism W ∨ ∼→ H 1
B(Aσ∞(x), Q), uniquely determined up to action of G(Q), where G acts on
W ∨ by the contragredient representation, and sα,B,σ∞(x) is the image of sα by any such isomorphism
(so, does not depend on the choice of such isomorphism). For each prime l, let sα,l,σ∞(x) be the
tensor in T (H 1
´et(Ax ⊗F F , Ql)) which is the preimage of sα,B,σ∞(x) under the canonical isomorphism
´et (Ax ⊗F F , Ql) ∼→ H m

´et (σ∞(Ax ⊗F F ), Ql) = H m

B (σ∞(Ax), Q) ⊗ Ql,

(3.2.1.1)

H m

where the ﬁrst isomorphism σ∞ is the proper base change isomorphism in ´etale cohomology. Also,
it is known ([DMOS82, Cor.2.8]) that the image of sα,B,σ∞(x) under the comparison isomorphism

H m

B (σ∞(Ax), Q) ⊗ C = H m

dR(Ax ⊗F,σ∞ C)

dR(Ax)) ⊗F,σ∞ σ∞(F ), i.e. equals σ∞(sα,dR,σ∞(x)), for some sα,dR,σ∞(x) ∈ T (H 1

lies in T (H 1
dR(Ax ⊗F
F )). The element (sα,dR,σ∞(x), sα,´et,σ∞(x) := (sα,l,σ∞(x))l) of the tensor space T (H 1
A(Ax), Q(1)) is
an absolute Hodge cycle on Ax, where H 1
[DMOS82]),
´et(Ax, Ql) (cf.
from which it follows ([Kis10, (2.2.1)]) that sα,´et,σ∞(x) is ﬁxed under the canonical Galois action of
Gal(F /F ), hence in fact, sα,dR,σ∞(x) belongs to the subspace T (H 1

dR(Ax) × Q H 1

A(Ax) := H 1

dR(Ax/F )).

3.2.2 We show how every geometric point z ∈ SK ⊗ ¯Fp(k) (k = k, chark = p) gives rise to an
F -isocrystal over k with GQp-structure; here, we assume that L(k) can embed in C, for example,
it suﬃces if k has ﬁnite transcendence degree over ¯Fp. The p-divisible group (Az[p∞], λAz [p∞])
with quasi-polarization gives rise to an F -isocrystal over k equipped with a non-degenerate al-
ternating pairing. More precisely, the crystalline cohomology M = H 1
cris(Az/W (k)) of Az with
quasi-polarization λz is a quasi-polarized F -crystal (M, φ, h , i): M is a free W (k)-module of
rank equal to 2 dim Az, φ ∈ EndZp(M ) is a σ-linear endomorphism such that pM ⊂ φ(M ), and
h , i : M × M → W (k) is an alternating form with the property that hφ(v1), φ(v2)i = phv1, v2iσ for
v1, v2 ∈ M .

To show that the F -isocrystal (M ⊗ L(k), φ, ψ) has GQp-structure, let x : Spec(W (k)) → SK be
a lift of z, which exists since SK(G, X) is smooth over O(℘) and O(℘) is unramiﬁed over Z(p) ([Mil94,

11

Cor.4.7]), and set (Ax, λx) := x∗(A, λA); here we identiﬁed E℘ = L(Fq) for the residue ﬁeld Fq of
O(℘). Let {tβ,dR,x, tβ,´et,x}β∈Jx ∈ T (H 1
A(Ax), Q(1)) be the set of absolute Hodge cycles on Ax (see
[DMOS82] for the notations appearing here), and for each β ∈ Jx, let tβ,z ∈ T (M ⊗W (k)L(k)) denote
the image of tβ,dR,x under the canonical isomorphism H 1
cris(Az/W (k)) ⊗ L(k).
Then, one can identify J as a subset of Jx (see below for a proof) and the triple

dR(Ax/L(k)) = H 1

(M ⊗ F, φ, (tβ,z)β∈J )

dR(Ax/L(k)) = H 1

cris(Az/W (k)) ⊗ L(k) = H 1

depends only on z, not on the lift x: this is basically because for any two lifts x, x′ of z, the composite
map H 1
dR(Ax′/L(k)) is given by parallel transport with
respect to the Gauss-Manin connection ([BO83, (2.9)]). Also, the cycle tβ,z is crystalline, namely
tβ,z belongs to the F 0-ﬁltration of T (M ⊗ L(k)) and is ﬁxed under the Frobenius φ (originally,
this was proved when x is deﬁned over a number ﬁeld, by Wintenberger and Blasius [Bla94, §5], as
a consequence of the fact that the Hodge cycles on an abelian variety over a number ﬁeld are de
Rham and the compatibility of the crystalline and the de Rham comparison isomorphisms [Bla94,
5.1(5)]. Then, Vasiu [Vas08, Sec.8] generalized it to arbitrary ﬁelds). Moreover, there exists an
L(k)-isomorphism

W ∨ ⊗Q L(k) ∼→ M ⊗W (k) L(k)

(3.2.2.1)

which maps sα, for every α ∈ J , to tβ,z for some β = β(α) ∈ Jx. Indeed, as before we choose
an embedding σ∞ : L(k) ֒→ C which extends the given embedding E(G, X) ֒→ C. Then, for each
β ∈ Jx, as tβ,dR,x is the de Rham component of an absolute Hodge cycle on Ax, there exists a
tensor vβ ∈ T (W ) such that σ∞(tβ,dR,x) is the image of vβ under the comparison isomorphism

W ∨ ⊗ C

∼→ H 1

B(σ∞(Ax), Q) ⊗ C

∼→ H 1

dR(Ax/L(k)) ⊗L(k),σ∞ C,

(3.2.2.2)

where as noted above the ﬁrst isomorphism exists and is unique up to the action of G(Q) on W ∨.
Because for each α ∈ J , σ∞(sα,dR,σ∞(x)) is the image of sα of the same isomorphism and also is
the de Rham component of an absolute Hodge cycle on Ax, for every α ∈ J , sα equals vβ for some
β = β(α) ∈ Jx (which gives an injection J ֒→ Jx mentioned above), i.e. the set {vβ}β∈Jx contains
the set {sα}α∈J . Then, the functor deﬁned on L(k)-schemes

R 7→ HomR((W ∨

L(k) ⊗ R, {vβ ⊗ 1}), (H 1

dR(Ax/L(k)) ⊗ R, {tβ,dR,x ⊗ 1}))

of isomorphisms between W ∨⊗QL(k) and H 1
dR(Ax/L(k)) taking vβ to tβ,dR,x for every β ∈ J (⊂ Jx)
is represented by a scheme which is non-empty as it has a C-valued point, and thus is a torsor over
L(k) under GL(k). Since H 1(L(k), GL(k)) = {0} (Steinberg’s theorem), this torsor is trivial, namely
has an L(k)-valued point.

Therefore, when one chooses an isomorphism as in (3.2.2.1) to transport the σ-linear map φ to

W ∨, there exists an element b ∈ G(L(k)) with

φ = ρW ∨(b)(idW ∨ ⊗ σ),

where ρW ∨ : G ֒→ GL(W ∨) denotes the contragredient representation: indeed, ρW ∨(b)(idW ∨ ⊗ σ)
ﬁxes each vβ ⊗1 ∈ T (W ∨ ⊗L(k)). Although b depends on the choice of an isomorphism (3.2.2.1), its
σ-conjugacy class b ∈ B(GQp) is independent of such choice. This shows that the F -isocrystal over
k attached to z is an F -isocrystal with GQp-structure. For arbitrary point z of SK(G, X)⊗κ(℘), we

12

deﬁne the F -isocrystal attached to z to be the F -isocrystal of the geometric point in SK(G, X)(k)
induced from z for any algebraically closed ﬁeld k containing the residue ﬁeld κ(z) of z: the
resulting F -isocrystal does not depend on the choice of k′ (cf. [VW13, §8]). Therefore, we obtain
a (set-theoretic) map

Θ : SK(G, X) ⊗ κ(℘) → B(G).

We note that the same argument also establishes that if x ∈ ShK(G, X)(F ) is a special point
corresponding to a special Shimura datum (T, h ∈ Hom(S, TR) ∩ X), the associated isocrystal has a
representative in T (L). Indeed, by the moduli interpretation, there is an isomorphism of polarized
Q-Hodge structures W ∨ ∼→ H1(σ∞(Ax), Q), where on the left side the Hodge structure is given by
h, so T ⊂ GL(W ) is the stabilizer of the Hodge tensors {vβ}β∈Jx ⊂ T (W ), and according to the
above discussion, the associated element b ∈ G(L(k)) ﬁxes all of the tensors {vβ}β∈Jx.

Finally, we remark that although our deﬁnition of the F -isocrystal attached to a point of
SK(G, X)(k) uses cohomology spaces, one can equally work with homology spaces, as adopted by
other people (such as [VW13]). This does not alter the deﬁnition of the map Θ.

3.2.3 We recall that for a torus T over a non-archimedean local ﬁeld F , there exists a unique
maximal compact subgroup of T (F ) (which is also open). In fact, T has a canonical integral form
T over OF such that for every ﬁnite extension F ′ of F , the maximal compact subgroup of T (F ′)
is T (OF ′). If E is a ﬁnite Galois extension of F splitting T , the maximal compact subgroup of
T (E) = Hom(X ∗(T ), F ×)(≃ (E×)dim T ) is T (OE ) = Hom(X ∗(T ), O×
E )dim T ); furthermore
we have T (OF ) = HomGal(E/F )(X ∗(T ), O×
If T is unramiﬁed over F , T (OF ) is the unique
hyperspecial subgroup of T (F ) (cf. Thm. 1 and the discussion after Prop. 2 in §10.3 of [Vos98],
[Tit79]). We will also write simply T (OF ) for T (OF ).

E )(≃ (O×

E ).

Lemma 3.2.4. Choose an embedding ιp : Q ֒→ Qp inducing given prime ℘ of E ⊂ Q. Let Kp be
a hyperspecial subgroup of G(Qp) and K p a compact open subgroup of G(Ap
f ). Let x = [h, kf ] ∈
ShK(G, X)(Q) be a special point, where h ∈ Hom(S, TR) ∩ X for a maximal Q-torus T of G and
kf ∈ G(Af ). Suppose that T is unramiﬁed over Qp and the (unique) hyperspecial subgroup T (Zp)
of T (Qp) is contained in Kp. Then,

(1) x ∈ ShK (G, X)(Qp) is deﬁned over an unramiﬁed extension F of E(G, X)℘, thus extends

over OF , and

(2) the F -isocrystal with GQp-structure of its reduction z ∈ ShK (G, X)(¯Fp) is represented by
is

p ). In particular, the associated Newton point νTQp (µh(p)) ∈ N (TQp) = X∗(T )Γ(p)

µ−1
h (p) ∈ T (Qur

Q

−

1
r

NmL(Fq)/Qp(µh),

where L(Fq) = Frac(W (Fq)) is any splitting ﬁeld of TQp (q = pr).

A special point of ShK will be said to have good reduction at ιp if it extends to an Oιp-valued

point of SK for the valuation ring Oιp of Q deﬁned by ιp.

Proof. (1) The statement on the ﬁeld of deﬁnition is an easy consequence of the reciprocity
law chararcterizing the canonical model of Shimura varieties ([Del71, §3]) and the local class ﬁeld
theory. For any compact open subgroup K ′ contained in T (Af ) ∩ K, there is a natural map
ShK ′(T, {h}) → ShK(G, X) ⊗E(G,X) E(T, {h}) of weakly canonical models of Shimura varieties
([Del71, (3.13)]). Hence, it suﬃces to show that for the compact open subgroup K ′ = T (Zp) × K ′p

13

for any K ′p ⊂ T (Ap) ∩ K p, the connected components of the ﬁnite scheme ShK ′(T, {h}) over
E(T, {h}) are deﬁned over an (abelian) extension E′ of E := E(T, {h}) such that the prime p′ of E′
induced by ιp is unramiﬁed over ℘ ([Del71, 3.15]). The action of Gal(Q/E) (which factors through
the abelianization Gal(Eab/E)) on the group ShK ′(T, {h})(Q) = T (Q)\T (Af )/K ′ is given by (the
adelic points of) the reciprocity map ([Del71, 3.9])

rT,µh : ResE/Q(GmE)

ResE/Q(µh)

−→ ResE/Q(TE)

NE/Q−→ T

(3.2.4.1)

via class ﬁeld theory: for ρ ∈ Gal(Eab
one has

℘ /E℘) = E×

℘ and [t]K ′ ∈ ShK ′(T, {h})(E℘) = T (Q)\T (Af )/K ′,

ρ[t] = [t · rT,µ(ρ)−1],

℘ /Eur

where one uses the convention on the class ﬁeld theory that under the identiﬁcation Gal(Eab
℘ /E℘) =
E×
℘ , the geometric Frobenius corresponds to a uniformizer of E℘. But, the image in T (Qp) of the
unit group (OE ⊗ Zp)× is obviously contained in the maximal compact open subgroup T (Zp). Since
Gal(Eab
℘ ⊂ (OE ⊗ Zp)×, this proves the claim. Then, by the Neron extension
property (Thm. 3.1.3, (2) and Remark 3.1.4) of the integral canonical model, x extends to an
OF -valued point of SK.

℘ ) = (OE)×

(2) Set L := L(¯Fp); by (1), we may regard L as an extension of F . The statement on the
Newton point follows from the ﬁrst statement and Theorem 2.2.5. The claim that the F -isocrystal
of z is represented by µ−1
h (p) ∈ T (L) is Lemma 13.1 of [Kot92]; as was observed above, we already
know that it is represented by an element of T (L). More precisely, this lemma is a corollary of
Lemma 12.1 of loc.cit., which is a statement purely for a torus over a non-archimedean local ﬁeld
and a cocharacter of it (in particular, in Lemma 12.1 it is not required that the torus is deﬁned
by a PEL-datum), and the argument in [Kot92] of deducing Lemma 13.1 from Lemma 12.1 still
works in our situation of a general Hodge-type. To see that in detail, we reproduce the Kottwitz’s
argument here, pointing out necessary modiﬁcations explicitly along the way.

We ﬁx an embedding σ∞ : L ֒→ C which extends the given embedding E(G, X) ֒→ C. The mod-
B(σ∞(Ax), Q), determined
, Qp)
the con-
, Qp). Then, the Galois representation Gal(Qp/F ) →
p ) = Gal(Qp/F ur) of the

uli interpretation of ShK(G, X)(C) provides an isomorphism W ∨ ∼→ H 1
uniquely up to action of G; we ﬁx one. Accordingly, we get an isomorphism W ∨
Qp
by the isomorphism (3.2.1.1), via which we transport the action of TQp on W ∨
tragredient representation) to H 1
GL(H1((Ax)Qp
resulting representation equals the homomorphism

, Qp)) factors through TQp and the restriction to Gal(Qp/Qur

∼→ H 1
Qp (i.e.

´et((Ax)Qp

´et((Ax)Qp

ρTQp ,µh : Gal(Qp/Qur

p ) → TQp

(3.2.4.2)

attached to (TQp, µh) by the procedure of §12 of [Kot92] (just as in the PEL-type case); in particular,
it is a crystalline representation. Indeed, as we have seen from [Kis10, (2.2.1)], the absolute Hodge
cycles on Ax are invariant under Gal(F /F ), which proves the ﬁrst claim. The second claim holds
because we can reduce our case to the Siegel case by means of the symplectic embedding G ֒→
GSp(W, ψ).

Next, we need three Qp-linear Tannakian categories: RE P(TQp) is the neutral Qp-linear Tan-
nakian category of ﬁnite-dimensional representations of the torus TQp, C R(F ) is the neutral Qp-
linear Tannakian category of ﬁnite-dimensional crystalline representations of Gal(Qp/F ur), and

14

C RY S denotes the Qp-linear Tannakian category of F -isocrystals (U, Φ), where U is a ﬁnite di-
mensional vector space over L and Φ is a σ-linear bijection Φ : U → U . Then, to any cocharacter
µ ∈ X∗(TQp), there is attached a (composite) tensor functor

Ξµ : RE P(TQp)

ρ∗
µh→ C R(F )

D→ C RY S .

(3.2.4.3)

Here, the ﬁrst functor ρ∗
p ) → TQp
(3.2.4.2) and the second functor D is the Dieudonn´e functor in the Fontaine-Messing theory: for a
ﬁnite unramiﬁed extension E(⊂ Qur

µh is dual to the homomorphism ρµh := ρTQp ,µh : Gal(Qp/Qur

p ) of F and a crystalline representation V of Gal(Qp/E),

D(V ) = (Bcris ⊗Qp V )Gal(Qp/E),

where Bcris is the crystalline period ring of Fontaine-Messing ([FM87]). On the other hand, if for a
ﬁeld K, V E C K denotes the category of ﬁnite-dimensional K-vector spaces, from the ﬁbre functor
C RY S → V E C L : (U, Φ) 7→ U , we get a non-standard ﬁbre functor ω1 : RE P(TQp) → V E C L.
By Steinberg’s theorem (H 1(L, TL) = {0}), this ﬁbre functor is isomorphic to the standard ﬁbre
∼→ ω0 of ﬁbre
functor ω0 : RE P(TQp) → V E C L : (ρ, V ) 7→ V ⊗Qp L. We ﬁx an isormophsm f : ω1
functors.

Now, it follows from the above discussion (on the homomorphism ρTQp ,µh) that for the natural
representation WQp of TQp, the associated crystalline representation ρ∗
uh(WQp) is the natural repre-
sentation of Gal(Qp/Qur
, Qp), hence Ξµh(WQp) is canonically isomorphic to the dual
cris(Az/W (¯Fp)) ⊗ L (cf. proof of [Kot92, Lemma13.1]); here, by
of the F -isocrystal H 1
deﬁnition, the F -isocrystal dual to H 1
cris(Az/L), L)
equipped with the Frobenius operator Φ1(f )(v) := p−1 · σf (V v) for f ∈ H cris
cris(Az/L)
(V being the Verschiebung). Then, Lemma 12.1 of [Kot92] says that if one transports the Frobenius
operator Φ1 on Ξµh(WQp) = H cris

p ) on H1((Ax)Qp
cris(Az/L) = H 1

cris(Az/L) is the linear dual H cris

to W ⊗ L via the isomorphism

:= HomL(H 1

1

and v ∈ H 1

1

1

f (WQp) : ω1(WQp) = H cris

1

∼→ ω0(WQp) = WQp ⊗ L,

and writes (H cris

1

, Φ1) ≃ (W ⊗ L, ρW (b)(idW ⊗ σ)), then one has an equality

in B(TQp). It also holds that

b = µ−1

h (p)

H 1

cris(Ax/L) ≃ (W ∨ ⊗ L, ρW ∨(b)(idW ∨ ⊗ σ)).

∼→ H 1

∼→ ω0
Therefore, to prove the statement (2), we only need to show that for any identiﬁcation f : ω1
∼→ WL induces an isomorphism as in (3.2.2.1), namely f (WQp)∨ :
of ﬁbre functors, f (WQp) : H cris
W ∨
cris(Az/L) sends sα, for every α ∈ J , to tβ,z for some β = β(α) ∈ Jx. We remark that in
L
the PEL-type setting, the tensors involved are morphisms in tensor categories, so this was obvious.
In a general Hodge-type case, the proof of this fact requires more sophisticated argument and also
a non-trivial fact ([Bla94]) that the Hodge cycles on abelian varieties over number ﬁelds are de
Rham.

1

In more detail, we consider each tensor sα as a morphism sα : 1 → W ⊗
Qp

in RE P(TQp), where
1 is the trivial representation Qp (which is an identity object of the tensor category RE P(TQp))

15

and W ⊗
Qp
α : Ξµ(1) → Ξµ(W ⊗
t′
Qp
equivalently regarded as a crystalline tensor on Ξµ(WQp) = H cris
isomorphism of ﬁbre functors, we have a commutative diagram of L-vector spaces

denotes some speciﬁc object of RE P(TQp). Apply the functor Ξµ, we get a morphism
) in C RY S . But, as Ξµ(1) is the trivial F -isocrystal (L, σ), again this is
. Moreover, as f : ω1 → ω0 is an

1

ω1(1)

f (1) ≃

t′
α /

ω1(W ⊗
Qp

)

≃ f (W ⊗
Qp

)

ω0(1)

sα /

/ ω0(W ⊗
Qp

).

under ρ∗

α on H cris

µh is just the image of it under our chosen identiﬁcation W ∨
Qp

As the isomorphism f (1) is the multiplication by an element of L, by modifying f , we may assume
that f (1) is the identity on 1 = Qp. This implies that under f (WQp)−1, the tensor sα on WQp =
ω0(WQp) maps to a crystalline tensor t′
1 = ω1(WQp). So, it remains to check that the tensor
t′
α is the de Rham component of an absolute Hodge cycle on Ax. But, the image of the tensor sα :
1 → W ⊗
, Qp),
Qp
hence equals the ´etale component sα,p,σ∞(x) : 1 → H´et
, Qp)⊗ of a Hodge cycle sα,B,σ∞(x)
on σ∞(Ax) by the moduli interpretation of ShK (G, X)(C). In turn, the image of sα,p,σ∞(x) under
dR(Ax/L), L)⊗, because the
the second functor D is sα,dR,σ∞(x) : 1 → H dR
etale and the de Rham component of an absolute Hodge cycle on an abelian variety over a number
ﬁeld match under the p-adic comparison isomorphism from which the functor D is induced ([Bla94,
Thm.0.3]). So, we have just proved that t′
α = Ξµh(sα) = sα,dR,σ∞(x), and consequenty the statement
(2).

1 (Ax/L)⊗ := HomL(H 1

∼→ H 1

´et((Ax)Qp

1 ((Ax)Qp

3.2.5 We ﬁx an embedding ιp : Q ֒→ Qp for an algebraic closure Qp of Qp, thereby an inclusion

Γ(p) := Gal(Qp/Qp) ֒→ Γ := Gal(Q/Q).

This allows us to consider c(G, X) as an element of CG(Qp). As such, the ﬁeld of deﬁnition of
c(G, X) is equal to the ℘-adic completion E(G, X)℘ of E(G, X), where ℘ is the prime of E(G, X)
induced by ιp.

Let BR(GQp) = (X ∗, R∗, X∗, R∗, ∆) be the based root datum of GQp and C ⊂ (X∗)Q the closed
Weyl chamber associated with the root base ∆. Denoting also by c(G, X) its (unique) representative
in C, we set

µ(G, X) := |Γ(p) · c(G, X)|−1 X

µ′

∈ C

µ′∈Γ(p)·c(G,X)

= [Γ(p) : Γ(p)c]−1 X

γ∈Γ(p)/Γ(p)c

γ(c(G, X)),

Here, the action of Γ(p) on C is the canonical action and Γ(p)c := Gal(Qp/E(G, X)℘), i.e. the
stabilizer of c(G, X) in Γ(p).

16

/




3.2.6 As X∗(T ) = X ∗(bT ) for the dual torus bT of T , regarded as a character on bT , we can restrict
c(G, X) ∈ C(T, B) to the subgroup Z(bG)Γ(p) of bT , obtaining an element

µ♮ ∈ X ∗(Z(bG)Γ(p)).

This depends only on the pair (G, X) (more precisely, on the pair (GQp, c(G, X) ∈ CG(Qp))).

Alternatively, under the identiﬁcation X ∗(Z(bG)Γ(p)) = π1(G)Γ(p), the element µ♮ equals the image
of µ ∈ X∗(T ) under the canonical map X∗(T ) → π1(G)Γ(p) = (X∗(T )/Σα∈Φ(G,T )Zα∨)Γ(p), where µ
is any cocharacter of TQp

that lies in the conjugacy class c(G, X) of cocharacters of GQp

.

3.2.7 We deﬁne a ﬁnite subset B(GQp, X) of B(GQp) (following Kottwitz [Kot97, Sec.6] and
Rapoport [Rap05, Sec.4]):

B(GQp, X) := n b ∈ B(GQp) | κGQp (b) = µ♮,

νGQp (b) (cid:22) µ(G, X) o ,

where κGQp is as deﬁned in Theorem 2.2.5 and (cid:22) is the natural partial order on the closed Weyl
chamber C(T, B) deﬁned by that ν (cid:22) ν′ if ν′ − ν is a nonnegative linear combination with real
coeﬃcients of simple coroots in R∗(T ) ([RR96], Lemma 2.2).

One knows ([Kot97, 4.13]) that the map (ν, κ) : B(GQp) → N (GQp) × X ∗(bZ(G)Γ(p)) is injective,

hence B(GQp, X) can be identiﬁed with a subset of N (GQp).

Proposition 3.2.8. Suppose G is unramiﬁed over Qp and K = KpK p is hyperspecial at p.

(1) The image of Θ : SK(G, X)(κ(℘)) → B(G) is contained in B(GQp, X).
(2) For b ∈ B(GQp), the subset

is locally closed inside SK(G, X) ⊗ ¯Fp.

Sb := Θ−1(b)

For (1), see e.g. [RR96]. The second statement (2) is due to [Vas11, 5.3.1].
Endowed with reduced induced subscheme structure, the subvarieties Sb of SK (G, X) ⊗ ¯Fp are

called the Newton strata of SK(G, X).

In [Rap05], Conjecture 7.1, Rapoport conjectures

Conjecture 3.2.9.

Im(Θ) = B(GQp, X).

Remark 3.2.10. (1) As mentioned brieﬂy in the introduction, this non-emptiness conjecture of New-
ton strata was proved for PEL-type Shimura varieties by C.-F. Yu [Yu05] in Lie-type C cases and
by Viehmann-Wedhorn [VW13] in general cases. Their methods of proof are both characteristic-p
geometric, which are not applicable for Hodge-type Shimura varieties.

(2) It is known (cf.

[RR96], [Cha00]) that with respect to the partial order (cid:22) on B(GQp, X),
there exist a unique maximal element, called µ-ordinary element, and a unique minimal element,
called basic element. The µ-ordinary element is nothing other than (the σ-conjugacy class in
it is clear from deﬁnition that µ(G, X) ∈ B(GQp, X).
B(GQp, X) with Newton point) µ(G, X):
Previously, non-emptiness of these two special strata have been known. For the µ-ordinary locus,
this was ﬁrst proved by Wedhorn ([Wed99]) in the PEL-type cases, using an equi-characteristic
deformation argument (which is thus yet unavailable for Hodge type Shimura varieties) and by

17

Wortmann [Wor13] for general Hodge-type cases, along the line of Viehmann-Wedhorn [VW13]
comparing the Newton stratiﬁcation with the Ekedahl-Oort stratiﬁcation. As such, Wortmann’s
work makes an essential use of the Kisin’s results on the integral p-adic comparison between the etale
cohomology with Zp-coeﬃcients and the crystalline cohomology with integral coeﬃcients, endowed
with tensors (which is also established by [Vas12]). There was also a group-theoretic approach of
Bultel [Bul01]. The µ-ordinary locus is also known to be dense and open. In the PEL-type cases,
non-emptiness of the basic locus was shown by Fargues [Far04].

(3) There is a conjectural formula for the (co)dimension of each Newton stratum, given by Chai
[Cha00]. The result of Kret [Kre13], alluded in the introduction, in fact proves this formula in the
simple PEL-type cases of Lie type A or C. His result depends on the resolution of Kisin [Kis13]
of the Langlands-Rapoport conjecture and the stabilization of the twisted trace formula. We also
mention the work of Scholze-Shin [SS13, Cor.8.4] of similar ﬂavor.

(4) Originally, Conjecture 3.2.9 was formulated for general parahoric subgroup Kp. But, if Kp
is not hyperspecial, the µ-ordinary locus may not be dense, as the example of Stamm [Sta97] shows
(the Hilbert-Blumenthal surfaces with Iwahoric level structure at p). Still, our result (the ﬁrst
method of proof) proves that if there exists an integral model for which a suitable Neron-extension
property similar to Theorem 3.1.3 holds, then the Newton strata (parametrized by the same set
B(GQp, X)) on the reduction of such model are all non-empty.

(5) We do not know yet that our deﬁnition of the isocrystal with GQp-structure is an isocrystal
with GQp-structure on SK ⊗κ(℘) in the sense of [RR96, §3]. Due to this ﬂaw, some basic properties
on Newton stratiﬁcation that are known for PEL-type Shimura varieties, such as the Grothendieck
specialization theorem, are not yet established for Hodge type Shimura varieties. For some known
properties, we refer to [Rap03], [Vas08].

4 Construction of special Shimura datum with prescribed F -isocrystal

Suppose given a Shimura datum (G, X) of Hodge type such that GQp is unramiﬁed. Fix a hyper-
special subgroup Kp of G(Qp) and a prime ℘ of E(G, X). We choose embeddings ι∞ : Q ֒→ C and
ιp : Q ֒→ Qp inducing ℘ on E(G, X). Let SKp(G, X) be the canonical integral model of the Shimura
variety ShKp(G, X). The goal of this section is to prove the fact that for any F -isocrystal with GQp-
structure b lying in B(GQp, X), there exists a special Shimura sub-datum (T, h ∈ Hom(S, TR) ∩ X)
such that TQp is unramiﬁed and the unique hyperspecial subgroup is contained in a G(Qp)-conjugate
of Kp, and that the σ-conjugacy class of µ−1

p ) equals b.

h (p) ∈ G(Qur

Later, from such special Shimura datum, we will ﬁnd a special Shimura sub-datum (T ′, h′)
Qp and T ′(Zp) ⊂ Kp, and further such that for any gf ∈ G(Af ), the special
with unramiﬁed T ′
point x = [h′, gf ] ∈ SKp(G, X)(Q) has good reduction at ιp and the associated F -isocrystal with
GQp-structure of its reduction is b.

4.1 Construction of special Shimura datum with prescribed F -isocrystal satis-
fying condition (†) We will use the following notation in the remaining of this section. Let M
be a reductive group over a ﬁeld F (of characteristic zero) and T a maximal F -torus of M . For
any µ ∈ X∗(T ), we let [µ]M denote its image under the natural map

X∗(T ) → π1(M )Gal(F /F ) = (X∗(T )/ X

Zα∨)Gal(F /F ).

α∈∆(T,M )

18

(Although the ﬁeld F does not enter the notation, in most cases, this will not cause confusion; F
will be the natural ﬁeld over which M is to be considered.)

Remember that we had ﬁxed two embeddings Q ֒→ C, Q ֒→ Qp, and using these we will
regard every conjugacy class of cocharacters of GC (for example, c(G, X)) as a conjugacy class of
cocharacters of GQp

. Suppose that

Theorem 4.1.1. Let (G, X) be a Shimura datum. Let p be a rational prime such that GQp is
unramiﬁed, and b′ ∈ B(GQp). Suppose that

(†) there exists a pair (T ′, µ′), where T ′ is an unramiﬁed maximal Qp-torus of GQp, and µ′ ∈

X∗(T ′) ∩ c(G, X) such that the Newton point νGQp (b′) of b′ ∈ B(GQp) equals the image of

1
r

NmLr/Qp(µ′) ∈ N (T ′) = X∗(T ′)Γ(p)

Q

under the canonical map N (T ′) → N (GQp), where T ′ splits over Lr := L(Fpr ).

Then, there exists a special Shimura datum (T, h ∈ X ∩ Hom(S, TR)) such that (TQp, µh) =
p ). Moreover,

Intgp(T ′, µ′) for some gp ∈ G(Qp) and that b′ is σ-conjugate in G(L) to µ−1
for any ﬁnite prime l 6= p of Q, we can choose such (T, h) with TQl being elliptic in GQl

h (p) ∈ G(Qur

We note that when b′ ∈ B(GQp, X), the equality νGQp (b′) = 1

r NmLr/Qp(µ′) of elements in

N (GQp) (i.e. the condition in (†)) is equivalent to the equality

b′ = µ′(p)

of elements in B(GQp), because of Lemma 3.2.4 and the fact that the map

(ν, κ) : B(GQp) → N (GQp) × π1(G)Γ(p)

is injective ([Kot97, 4.13]).

Proof. Our proof consists of two steps. Fix a rational prime l diﬀerent from p.
Step 1. First, we claim that if the assumption (†) holds, then it holds with T ′ = (T0)Qp for
some maximal Q-torus T0 of G which is elliptic at both R and l. More precisely, we ﬁnd a maximal
Q-torus T0 of G such that (T0)Qv is elliptic in GQv for v = ∞, l and that (T0)Qp = Int(gp)(T ′) for
some gp ∈ G(Qp). To that end, we consider the following three sets:

Xv = {x ∈ Gsc(Qv) | x is regular semisimple and

Xp = {x ∈ Gsc(Qp) | x is regular semisimple and

CentG(x) is elliptic in GQv } (v = ∞, l);

CentG(x) = Int(gp)(T ′) for some gp ∈ G(Qp) },

for v = ∞, this follows from the Deligne’s condition on Shimura
These sets are all non-empty:
data ([Del77, (2.1.1.2)]), and for v = l, from [PR94, Thm. 6.21]. They are also open in the real,
l-adic, and p-adic topology, respectively: “for suﬃciently close two regular semisimple elements,
their centralizers are conjugated” (cf.
[Bul01], proof of Lemma 3.1). So, by weak approximation
theorem, there exists an element x ∈ Gsc(Q) which lies in all of them. Its centralizer T0 := CentG(x)
is then the desired maximal torus.

19

Clearly, for any g ∈ G(Qp) (especially, g ∈ G(Qp) with (T0)Qp = gT ′g−1), the new pair (T1, µ1) =
(gT ′g−1, gµ′g−1) still satisﬁes the condition (†). Hence, in the rest of our proof, we may and do
assume that the condition (†) holds for a pair (µ′, T ′) such that T ′ = (T0)Qp for some maximal
Q-torus T0 of G which is elliptic at R and at our chosen prime l 6= p.

Step 2. Next, for any maximal Q-torus T0 of G, elliptic at R, and each cocharacter µ′ ∈ X∗(T0),

we claim that there exists u ∈ G(Q) such that

(i) Intu : (T0)Q ֒→ GQ is deﬁned over Q and the Q-torus T := Intu(T0) is elliptic in G over R,

(ii) Intu(µ′) equals µ−1
h

for some h ∈ Hom(S, TR) ∩ X.

Moreover, if (T0)Ql is elliptic in GQl for some l 6= p, there exist such u ∈ G(Q), h ∈ X satisfying,
in addition to these properties, that

(iii) there exists y ∈ G(Qp) such that (TQp, µ−1

h ) = Inty((T0)Qp, µ′).

Our proof is an adaptation of the argument of [LR87], Lemma 5.12. Let T sc

0 be the inverse
image of (T0 ∩ Gder)0 under the canonical isogeny Gsc → Gder, and pick any morphism h0 ∈ X
factoring through (T0)R, which exists since (T0)R is elliptic in GR. Choose w ∈ NG(T0)(C) such
that µ′ = w(µ−1
h0

),2 and consider the cocycle α∞ ∈ Z 1(Gal(C/R), Gsc(C)) deﬁned by

α∞
ι = w · ι(w−1).

As a mater of fact, this has values in T sc
Int(w−1) of (T sc
t ∈ T sc
Lemma 7.16 of [Lan83], there exists a global cocycle

0 (C). Indeed, by [Sh79, Prop. 2.2], the automorphism
0 )C is deﬁned over R, so Int(w−1)(ι(t)) = ι(Int(w−1)t) = Int(ι(w−1))(ι(t)) for all
0 (C), and so is wι(w−1) = ι(ι(w)w−1). Then, by

0 (C), i.e. ι(w)w−1 ∈ CentGsc(T sc

0 )(C) = T sc

α ∈ Z 1(Q, T sc
0 )

mapping to α∞ ∈ H 1(Q∞, T sc
lemma ensures the existence of a cocycle α ∈ Z 1(Q, T sc
to zero in H 1(Qp, T sc
torsion elements.

0 ). When (T0)Ql is elliptic in GQl for some l 6= p, then the following
0 ) and further
0 ). For a ﬁnitely generated abelian group A, let Ators be the subgroup of its

0 ) mapping to α∞ ∈ H 1(Q∞, T sc

Lemma 4.1.2. (1) For a maximal Q-torus T of G which is elliptic at l 6= p, the natural map
(π1(T sc)Γ(l))tors → (π1(T sc)Γ)tors is surjective.

(2) There exists α ∈ Z 1(Q, T sc

0 ) mapping to α∞ ∈ H 1(Q∞, T sc

0 ) and to zero in H 1(Qp, T sc

0 ).

Proof of lemma. (1) This is equal to the composite:

(π1(T sc)Γ(l))tors ֒→ π1(T sc)Γ(l) ։ π1(T sc)Γ ։ (π1(T sc)Γ)tors,

where the last two maps are clearly surjective. Hence, it suﬃces to prove that π1(T sc)Γ(l) is a
torsion group. But, since T sc
Ql

is a ﬁnite group, and so is

Γ(l)

2Recall our convention that c(G, X) is the conjugacy class of cocharcters into GC containing µ−1

h for some h ∈ X.

is anisotropic, cT sc
π1(T sc)Γ(l) = X ∗(cT sc

Γ(l)

) = Hom(cT sc

Γ(l)

, C×).

20

(2) For any place v of Q, there exists a canonical isomorphism ([Kot84a, (3.3.1)], [RR96, 1.14])

H 1(F, T sc)

Γ(v)

)D)tors ∼= (π1(T sc)Γ(v))tors,

Γ(v)

∼→ Hom(π0(cT sc

), C×) = ((cT sc

and a short exact sequence ([Kot86, Prop.2.6])

Γ

Γ

H 1(Q, T sc) → H 1(Q, T sc(A)) := ⊕vH 1(Qv, T sc) θ→ π0(cT sc
)D → π0(cT sc

Here, θ is the composite ⊕vH 1(Qv, T sc) ∼→ ⊕vπ0(cT sc

)D, of which the second map
is the one considered in (1) for T = T0. Hence, by (1), there exists a class αl ∈ H 1(Ql, T sc) such
that θ(αl) = −θ(α∞), and thus the element (βv)v ∈ H 1(Q, T sc(A)) deﬁned by that βv = αv for
)D. By exactness of the sequence, we

v = ∞, l and βv = 0 for v 6= l, ∞ maps to zero in π0(cT sc

conclude existence of α ∈ Z 1(Q, T sc) whose cohomology class maps to (βv)v.

)D = (π1(T sc)Γ)tors,

Γ(v)

Γ

Now, by changing α∞ and w further, we may assume that α∞ is the restriction of α to Gal(C/R).
Then, since the restriction map H 1(Q, Gsc) → H 1(Q∞, Gsc) is injective (the Hasse principle), we
see that α becomes trivial as a cocycle with values in Gsc(Q). We summarize this discussion in the
diagram:

H 1(Q∞, T sc
0 )

/ H 1(Q∞, Gsc)

α∞
ι = wι(w−1) ✤

H 1(Q, T sc
0 )

H 1(Q, Gsc)

∃ α❴

So there exists u ∈ Gsc(Q) such that for all ρ ∈ Gal(Q/Q),

αρ = u−1ρ(u).

/ 0

/ α′❴

⇒ α′ = 0.

Then, the homomorphism Intu : (T0)Q → GQ : t → t′ = utu−1 is deﬁned over Q; in particular,
T := uT0u−1 is a torus deﬁned over Q, and as the restriction of Intu to Z(G) is the identity, TR is
also elliptic in GR. Moreover, since u−1ι(u) = wι(w−1) for ι ∈ Gal(C/R), one has that uw ∈ Gsc(R)
and

Intu(µ′) = Int(uw)µ−1
h0

= µ−1
h

for h := Int(uw)(h0) ∈ X ∩ Hom(S, T ). This establishes the claims (i), (ii). The proof of the
claim (iii) is similar. As the restriction of α to Gal(Qp/Qp) is trivial, there exists x ∈ T (Qp) such
that xρ(x−1) = αρ = u−1ρ(u) for all ρ ∈ Gal(Qp/Qp), i.e. ux ∈ G(Qp). But, the homomorphism
Intu : (T0)Qp

also equals Intu = Intux. This proves (iii).

→ GQp

To ﬁnish the proof, we observe that for the pair ((T0)Qp, µ′) produced at the end of Step 1,
if (T, h) is the special Shimura datum obtained from (T0, µ′) by the procedure of Step 2, by the
property (iii), b′ equals the σ-conjugacy class of µ−1

h (p) ∈ T (Qur
p ).

4.2 Aﬃne Deligne-Lusztig varieties and veriﬁcation of the assumption (†) In
this subsection, we prove that in fact, the assumption (†) of Theorem 4.1.1 always holds (i.e. holds
for every b ∈ B(GQp, X)). For that, we use the fact (due to Witenberger [Win05])) that for any
b ∈ B(G, {µ}), the aﬃne Deligne-Lusztig variety Xµ(b) is non-empty. From the latter fact, we give
two ways of verifying the assumption (†).

21

/
/
/
/
O
O
?

O
O
O
O
✤
/
O
O
4.2.1 Let L be the completion of the maximal unramiﬁed extension of a non-archimedean local
ﬁeld F in an algebraic closure F of F and σ ∈ Aut(L/F ) the relative Frobenius. Let G be an
unramiﬁed reductive group over F .For a conjugacy class {µ} of cocharacters of G deﬁned over L,
we have the ﬁnite set B(G, {µ}) deﬁned in (3.2.7). Let S be a maximal F -split torus of G and T its
centralizer (so T is a maximal torus of G, since G is quasi-split); corresponding to S, there exists
an apartment a in the Bruhat-Tits building B(G, L) of the reductive group GL over L (cf. [Tit79]).

Let eK = Stab(x) be the (hyper)special subgroup of G(L) corresponding to a (hyper)special vertex

x of a. Fix a uniformizer ̟ of F . The aﬃne Deligne-Lusztig variety associated with µ ∈ X∗(T )/Ω
and b ∈ G(L) is deﬁned to be the set

When b′ ∈ G(L) is σ-conjugate to b, say b′ = h−1bσ(h), the map g 7→ g′ = h−1g induces a bijection

Xµ(b) = {g eK ∈ G(L)/eK | g−1bσ(g) ∈ eKµ(̟)eK}.

Xµ(b) ∼→ Xµ(b′).

(4.2.1.1)

Recall that a cocharacter µ′ ∈ X∗(T ′) of a maximal torus T ′ of GF is said to be minuscule if
hα, µ′i ∈ {−1, 0, 1} for all simple roots α ∈ ∆(G, T ′). It is well-known ([Del77, 1.2.5]) that any
Hodge cocharacter µ = µ−1
h

(h ∈ X) is minuscule.

Theorem 4.2.2. [Win05, Corollare 3] Suppose µ is minuscule. Then for any b ∈ B(G, {µ}), the
set Xµ(b) is non-empty.

Lemma 4.2.3. For a connected reductive group G over a p-adic ﬁeld F and a G(F )-conjugacy
class C of cocharacters, the assumption (†) of Theorem 4.1.1 holds if there exists a quadruple

(M ′, b′, T ′, µ′),

where M ′ is a Levi subgroup of GQp, b′ is a representative in M ′(L) of b′ whose σ-conjugacy
class in B(M ′) is basic (cf.
[Kot85]), T ′ is an unramiﬁed elliptic maximal Qp-torus of M ′, and
µ′ ∈ X∗(T ′) ∩ C such that

κM ′(b′) = [µ′]M ′
(here, b′ denoting the σ-conjugacy class of b′ in B(M ′)).

Proof. It suﬃces to show that b′ ∈ M ′(L) is σ-conjugate (in M ′(L)) to µ′(p) ∈ T ′(L). Since
T ′ is an elliptic maximal torus of M ′, the image of B(T ′) in B(M ′) equals the subset B(M ′)b of
basic elements ([Kot85], Prop. 5.3), and there is a commutative diagram of natural maps with
bijective vertical maps ([Kot85], Prop. 5.6)

B(T ′)

κT ′

∼=

B(M ′)basic

κM ′

∼=

X∗(T ′)Γ(p)

/ π1(M ′)Γ(p).

(4.2.3.1)

Denoting again (by abuse of notation) by µ′(p) the class of µ′(p) in B(T ′), we have

κT ′(µ′(p)) = [µ′]T ′

22

/
/




/
([RR96], Thm. 1.15 (ii)). So, since the elements µ′(p), b′ of B(M ′) are both basic, their equality
can be checked after applying κM ′. Then, the equality κM ′(b′) = κM ′(µ′(p)) is just the assumption
κM ′(b′) = [µ]M ′.

Recall that for a Levi subgroup M of G, an element b of M (L) is said to be G-regular basic for
M if the σ-conjugacy class of b in B(M ) is basic (so that νb is deﬁned over Qp, cf. [Kot85, (4.4.3)])
[Kot85, §6]). A Levi subgroup of G is said to be standard if
and CentGQp (νb) is equal to M (cf.
it contains the centralizer CentG(S) of a maximal Qp-split torus S of G (CentG(S) is a maximal
torus since G is quasi-split).

Proposition 4.2.4. Let G be an unramiﬁed connected reductive group over Qp and C be a G(Qp)-
. Let GZp be a
conjugacy class of cocharacters, containing a minuscule one µ0 : GmQp
reductive Zp-group scheme with generic ﬁbre GZp ⊗Zp Qp = G and put Kp := GZp(Zp). Let B(G, C)
be the subset of B(G) as deﬁned in (3.2.7).

→ GQp

(1) For any b ∈ B(G, C), there exists a pair (T, µ) satisfying the assumption (†) of Theorem

4.1.1 and furthermore such that the unique hyperspecial subgroup of T (Qp) is contained in Kp.

(2) Suppose that one of the following two conditions holds:
(i) Gder is simply connected;
(ii) there exists a representation ρ : GQp

every weight of ρ ◦ µ0 is either 0 or 1;

→ GL(V ) over Qp with ﬁnite kernel and such that

Then, for every triple

(M, b, T ),

where M is a standard Levi Qp-subgroup of GQp splitting over L, b ∈ M (L) is a basic element (i.e.
b ∈ B(M )basic), and T is a maximal torus of M , there exists µ ∈ X∗(T ) ∩ C such that

κM (b) = [µ]M .

(3) Under the assumption of (2), for any b ∈ B(G, C), there exists a quadruple (M, b, T, µ) as in
(2), which further satisﬁes that b ∈ M (L) is GQp-regular basic, T is an unramiﬁed elliptic maximal
torus of M , and that the unique hyperspecial subgroup of T (Qp) is contained in a G(Qp)-conjugate
of Kp.

Note that clearly the condition (ii) of (2) is satisﬁed when (G, C) arises (via obvious base-change

from Q to Qp) from a Hodge-type Shimura datum.

Proof.

In the cases of the assumptions of (2), by Lemma 4.2.3, (2) and (3) together give another proof
of the fact that the condition (†) as well as the claim on the hyperspecial subgroup hold for every
b ∈ B(G, C), with certain simpliﬁcation (i.e. simple proof of (4.2.4.3)) in the Hodge-type case (ii).
(1) This is what is established in the proof of Lemma 5.11 of [LR87]; a (slightly
diﬀerent) account of this proof is also given in [Kis13, Lem. (2.2.2)]. From the start, Langlands-
Rapoport considers only isocrystals b ∈ B(GQp) with non-empty Xµ(b). Also, in their argument,
T can be any (unramiﬁed) maximal Qp-torus of GQp. So in our case, we can simply take T to be
an unramiﬁed maximal Qp-torus of GQp such that the unique hyperspecial subgroup of T (Qp) is
contained in Kp (which exists by Lemma A.0.4). Here, for the convenience of readers, we give a
sketch of the argument of [LR87, Lem. 5.11]; we also use the notations of loc.cit.

Let M be the centralizer of a maximal Qp-split sub-torus of T .

It is a Levi subgroup of a
parabolic subgroup Q of G deﬁned over Qp. Note that T is an elliptic maximal torus of M and
M is unramiﬁed (since T is assumed to be unramiﬁed). We may assume that M (L) ∩ GZp(OL)

23

is a special subgroup of M (L) ([Tit79]). Then, choose an unramiﬁed maximal Qp-torus T ′ of M
such that T ′ contains a maximal Qp-split torus whose corresponding apartment in the Bruhat-Tits
building contains the hyperspecial point corresponding to Kp = GZp(Zp) (so that the hyperspecial
subgroup of T ′(Qp) is contained in Kp); from the beginning, one can assume that T is such a torus
and take T ′ = T (Lemma A.0.4). Choose representatives b ∈ M (L) of b and µ′ ∈ X∗(T ′) of C.
Then, the following facts are established step by step:

(i) There exist m ∈ M (L) and n′ ∈ N (L), where N is the unipotent radical of Q, such that

m−1bσ(m)n′ ∈ KLµ′(p)KL

(KL := GZp(OL)).

(ii) Let µ′′ ∈ X∗(T ′) be deﬁned, via the Cartan decomposition for M ([Tit79, 3.3.3]), by that

m−1bσ(m) ∈ (KL ∩ M (L))µ′′(p)(KL ∩ M (L)).

(4.2.4.1)

Then, µ′′ is conjugate to µ′.

(iii) Let νb be a Qp-rational representative of νb ∈ N (G) = (IntG(L)\HomL(D, GL))hσi that
factors through T (which exists by Prop. 6.2 of [Kot85]) and let µ be a cocharacter of T
that is conjugated to µ′′ in M . Then for any Lr = L(Fpr ) splitting T , we have an equality in
X∗(T )

rνb = NmLr/Qp(µ)

The statement (i) is a consequence of that Xµ′(b) 6= ∅.

The claim (ii) is the technical heart of the proof. It is proved using [Kot84b], Lemma 2.3.3 and
2.3.7: the latter lemma uses Satake transform, and the former lemma can be given a simple proof
in Hodge-type situation (the case (ii) of the statement (2) of this proposition, cf. proof of (4.2.4.3)
below). We note that the equation (4.2.4.1) implies

λM (m−1bσ(m)) = [µ′′]M .

(4.2.4.2)

Here, λM : M (L) → X ∗(Z(cM )) is the map deﬁned in [Kot84b, Lem.3.3] (strictly speaking, the

is obtained from this map by taking Galois invariants, i.e. H 0(Qp, −)), and [−]M
map in loc.cit.
denotes (by abuse of notation) the natural map X∗(T ′) → π1(M ). Also, λM induces the map κM
of Theorem 2.2.3 by taking H 1(Qp, −).

The proof of (iii) goes as follows: clearly, the equality in (iii) is equivalent to the statement that

for each Qp-rational character χ of T , one has that

hχ, µi = hχ, νbi

(this is the same as (5.n) on p.178 of [LR87]: νp in (5.n) equals rνb = [Lr : Qp]νb in our notation,
and the sign diﬀerence is due to that our sign convention of c(GQp, X) is diﬀerent from that of
Langlands-Rapoport). But because T is elliptic in M , each Qp-rational character of T can be also
regarded as a character of M (equivalently, of the maximal abelian quotient M ab of M ), and as
hχ, µi = hχ, µ′′i for any character χ of M , the claim (iii) is the same as that for every Qp-rational
character χ of M

hχ, µ′′i = hχ, νbi,

24

and this is a direct consequence of the equation (4.2.4.1), as shown in [LR87, p.178-179]. Alter-
natively, assuming that T is an unramiﬁed and taking T ′ = T , µ = µ′′, we can also proceed as
follows: as T is elliptic in M , νb is central in M (i.e. m−1bσ(m) ∈ M (L) is basic), hence in view of
the equation (4.2.4.2), (M, m−1bσ(m), T, µ′′) satisﬁes the conditions of Lemma 4.2.3, which gives
that the two Qp-rational cocharacters rνb, NmLr/Qp(µ′′) of T are conjugated in M (L), so their
projections to M ab are equal. But, they factor through the maximal Qp-split sub-torus T1 of T ,
and as T is elliptic in M , the natural map T1 → M ab induces an injection X∗(T1) ֒→ X∗(M ab).
So, we must have that rνb = NmLr/Qp(µ′′).

(3) Let us ﬁrst prove (3) assuming (2). Let S be any maximal Qp-split Qp-torus of G. According
to [Kot85, Prop.6.2], there exist a standard Levi subgroup M of G and b ∈ M (L) with b ∈ b such
that b is basic G-regular for M . In fact, M can be taken to be the centralizer of any Qp-rational
representative νp ∈ HomQp(D, G) of the Newton point νG(b) ∈ N (G) = (IntG(L)\HomL(D, GL))hσi
(proof of Prop. 6.2 of [Kot85]). Furthermore, there exists an unramiﬁed elliptic maximal Qp-torus
T of M (Lemma A.0.4). So far these discussions concern Qp-groups.

For Zp-groups, we can choose a maximal Qp-split Qp-torus S such that in the Bruhat-Tits
building B(G, Qp), the hyperspecial point x ﬁxed by Kp is contained in the apartment associated
with S. For such S, let SZp be the reductive Zp-group scheme with generic ﬁber being S and
such that SZp(Zp) is the (unique) hyperspecial subgroup of S(Qp). We claim that SZp and T ′
:=
Zp
CentGZp (SZp) are smooth, closed subschemes of GZp. To see that SZp is a closed subscheme of GZp,
we ﬁrst observe that SZp(OL) maps to GZp(OL) under the embedding S ֒→ G, where OL is the ring
of integers of L. This follows from the two facts: ﬁrst, the hyperspecial point x of B(G, Qp) is also
a hyperspecial point of B(G, L) with the associated OL-group scheme being (GZp )OL ([Tit79, 3.4,
3.8]), and secondly, for a maximal L-split torus S1 of G containing S and deﬁned over Qp (which
exists since G is quasi-split), x ∈ B(G, L) lies in the apartment corresponding to S1 ([Tit79, 1.10]).
So, x is ﬁxed under the maximal bounded subgroup S1(OL) of S1(L), and thus under SZp(OL)
as well. Then, according to [Vas99, 3.1.2.1], this implies that the Qp-embedding S ֒→ G extends
to a Zp-embedding SZp ֒→ GZp. The fact that T ′
:= CentGZp (SZp) is a smooth closed group
Zp
Zp-subscheme of GZp is well-known ([SGA3, XI, 5.3], [Con11, 2.2]). Moreover, one knows that it
represents the functor on Zp-schemes:

R′ 7→ {g ∈ G(R′) | g(SZp )R′g−1 = (SZp)R′},

and its generic ﬁbre T ′ := CentG(S) is a maximal torus of G which splits over L, since GQp is quasi-
split ([Tit79, 1.10]). Next, there exists a Qp-rational representative νp of νG(b) ∈ HomQp(D, G)hσi
which factors through S ([Kot84b, (1.1.3)]). Suppose that N νp (N ∈ N) is a morphism from Gm
to S ⊂ T ′ (not just a quasi-cocharacter). Then, the image of N νp is a Qp-split subtorus of T ′,
and since T ′ extends over Zp, this image extends uniquely to a Zp-subtorus U of T ′
Zp (use the
equivalence between the category of Qp-tori and the category of free Z-modules with Γ(p)-action,
under which Zp-tori correspond to unramiﬁed Γ(p)-modules). The morphism U → T ′
is a closed
Zp
embedding ([SGA3, IX.2.5]).

Now, as mentioned above, we may take CentG(N ν) for M . It is the generic ﬁbre of MZp :=
CentGZp (U ), which is a reductive group scheme over Zp ([SGA3, XI, 5.3], [Con11, 2.2]). Therefore,
by Lemma A.0.4, there exists a maximal torus TZp deﬁned over Zp of MZp whose generic ﬁbre
T = TZp ⊗ Qp is elliptic in M = MZp ⊗ Qp (and thus is unramiﬁed over Qp). Finally, the claim
follows since the unique hyperspecial subgroup of T (Qp) is TZp(Zp) (which is also the unique
maximal compact subgroup of T (Qp)).

25

(2) Following [Kot03], §4.2, for arbitrary µ ∈ X∗(T ), we put

Pµ := {ν ∈ X∗(T ) | [ν]G = [µ]G, ν ∈ Conv(ΩG · µ)},

where Conv(ΩG · µ) denotes the convex hull in X∗(T )R of the orbit ΩG · µ, ΩG being the absolute
Weyl group of T in G. In the original deﬁnition of Pµ, instead of our T , Kottwitz used a maximal
torus of M containing a maximal Qp-split torus of GQp, but there is an obvious bijection between
Pµ’s obtained using two diﬀerent maximal tori of M . We also remark that when Gder is simply-
connected, the ﬁrst condition [ν]G = [µ]G in the deﬁnition of Pµ is implied by the second one (under

this assumption, the second condition implies that µ − ν lies in the coroot lattice Pα∈∆ Zα∨ =

X∗(T ∩ Gder); see below for a proof).

Let Pµ,M denote the subset of π1(M )Γ(p) (which was denoted by YM in [Kot03]) obtained as
the image of Pµ under the canonical surjection [ · ]M : X∗(T ) → π1(M )Γ(p). Then, Kottwitz
shows ([Kot03, Thm. 4.3]) that for every standard Levi subgroup M and any basic b′ ∈ M (L) and
µ′ ∈ X∗(T ), we have that

κM (b′) ∈ Pµ′,M if and only if Xµ′(b′) 6= ∅.

On the other hand, the result of Wintenberger (Theorem 4.2.2) tells us that for any minuscule
cocharacter µ′ and any b′ ∈ G(L),

Xµ′(b′) 6= ∅

if and only if

ν(b′) ∈ B(G, {µ′}).

Hence, it follows from these together that for any b′ ∈ B(G, {µ′}), κM (b′) lies in Pµ′,M .

Finally, it remains to show that

In turn, since one has [ν]G = [µ′]G for any ν ∈ ΩG · µ′, it suﬃces to show that

Pµ′,M (= [Pµ′ ]M ) = [ΩG · µ′]M ,

X∗(T ) ∩ Conv(ΩG · µ′) = ΩG · µ′.

(4.2.4.3)

First, suppose that Gder is simply connected. Then, for any minuscule cocharacter µ′ ∈ X∗(T ),
one has

X∗(T ) ∩ Conv(ΩG · µ′)

(a)
= (µ′ + Q∨) ∩ Conv(ΩG · µ′)

(b)
= ΩG · µ′,

2.2]) that when one ﬁxes a set ∆ of simple roots and µ′ lies in the associated closed Weyl chamber

where Q∨ = Pα∈∆ Zα∨ is the coroot lattice. The equality (a) is due to the fact ([RR96, Lemma
C ⊂ X∗(T )R, µ ∈ Conv(ΩG · µ′) implies that µ′ − wµ ∈ C ∨ := Pα∈∆ R≥0α∨ ⊂ X∗(T der)R for every

w ∈ Ω, and the fact that

Q∨ = X∗(T der) = X∗(T ) ∩ X∗(T der)R

(⊂ X∗(T )R)

for simply connected Gder. To see the second equality, we note that since Gder is simply connected,
(T ∩ Gder)0 = T ∩ Gder, thus the submodule X∗(T der) of X∗(T ) is a direct summand (as follows,
for example, by applying [Kot84b, Cor. 2.3] to the exact sequence of diagonalizable groups 1 →
T ∩ Gder → T → Gab → 1, to get an exact sequence of free Z-modules).3 The equality (b) is
[Kot84b, Lemma 2.3.3].

3We also note the fact that when Gder is simply connected, for x, x′ ∈ X∗(T ), if x − x′ ∈ X∗(T der)R, one has that

x′ ≥ x (x′ (cid:23) x in our notation) if and only if x′ − x ∈ Pα∈∆ Z≥0α∨.

26

Next, suppose that we are in the situation of case (ii). Fix a maximal torus T ′ of GL(V )

containing ρ(T ). Since the induced map ρ∗ : X∗(T ) → X∗(T ′) is linear, we have the inclusion

ρ∗(X∗(T ) ∩ Conv(ΩG · µ′)) ⊂ X∗(T ′) ∩ Conv(ρ∗(ΩG · µ′)).

Also, since ρ has ﬁnite kernel, ρ∗ is injective. Let {e1, · · · , en} be the weights of the representation
T ′ → GL(V ); clearly, these form a basis X ∗(T ), giving an identiﬁcation X ∗(T ′) = Zn, X∗(T ′) = Zn.
Likewise, the set {e1 ◦ ρ, · · · , en ◦ ρ} consists of weights of (T, ρ|T ), and for any µ ∈ X∗(T ), each
ei ◦ ρ∗(µ) ∈ Z (i = 1, · · · , n) is also a weight of ρ ◦ µ : Gm → GL(V ). So, by assumption (which
also implies that for any µ ∈ ΩG · µ, every weight of ρ ◦ µ is either 0 or 1), the set ρ∗(ΩG · µ′) ⊂ Zn
is contained in the set of vertices of the hypercube Bn := {(xi) ∈ Rn | 0 ≤ xi ≤ 1}; in particular,
Conv(ρ∗(ΩG · µ′)) ⊂ Rn is contained in the hypercube Bn. Then, since X∗(T ′) = Zn ⊂ Rn, the
intersection X∗(T ′) ∩ Conv(ρ∗(ΩG · µ′)) must be equal to the vertex set of Conv(ρ∗(ΩG · µ′)), and
thus a subset of ρ∗(ΩG · µ′). Since ρ∗ is injective, this proves (4.2.4.3).
Remark 4.2.5. (1) The main ideas of the two proofs of the condition (†) are quite similar. But, the
details are still diﬀerent. For example, the Levi subgroup M in the proof of (1) is in general diﬀerent
(albeit related) from the Levi subgroup appearing in (2) and (3): the latter is the centralizer of a
Qp-rational representative of the conjugacy class νb, while the former is not necessarily so.

(2) In fact, the claim of (2) holds more generally for any Levi subgroup splitting over L (not

just for standard Levi subgroups). Indeed, we only need to check that for such Levi subgroup,

κM (b′) ∈ Pµ′,M if Xµ′(b′) 6= ∅.

Indeed, this direction of Theorem 4.3 of [Kot03] follows from Lemma 4.5, Lemma 4.6 there; this
part does not use Lemma 4.4 of loc. cit., whose proof seems to require the group to be unramiﬁed,
and Lemma 4.6 is Lemma 4.5 of [KR03]. Both of these lemmas (and the mathematical facts used
for their proofs, such as the Iwasawa (resp. Cartan) decompositions for GL (resp.
for ML)) are
statements about either reductive groups deﬁned over F and splitting over L (Lemma 4.5), or split
reductive groups over L (Lemma 4.6 of [Kot03], i.e. Lemma 4.5 of [KR03]); one also notes that
the same argument in fact establishes the stronger fact that if Xµ′ (b′) 6= ∅, the subset λM (b′) of

π1(M ) = X ∗(Z(cM )) equals the image of Pµ′ under the canonical surjection X∗(T ) → π1(M ) (in

the introduction of [Kot03], λM was denoted by wM : G(L) → π1(M )).

4.3 First proof of non-emptiness of Newton strata We now give our ﬁrst proof of the
main theorem.

Theorem 4.3.1. Let (G, X) be a Shimura datum. Let p be a rational prime such that GQp is
unramiﬁed, and ﬁx a hyperspecial subgroup Kp of G(Qp). Choose a prime ℘ of E(G, X) above p
and an embedding ιp : Q ֒→ Qp inducing ℘.

Then, for every b ∈ B(GQp, X), there exists a special sub-Shimura datum (T, h : S → TR) such
that TQp is unramiﬁed and the unique hyperspecial subgroup of T (Qp) is contained in Kp, and that
the σ-conjugacy class of µ−1

h (p) ∈ G(Qur

p ) equals b.

In particular, if (G, X) is of Hodge type, for every gf ∈ G(Af ), the special point [h, gf ]Kp ∈

ShKp(G, X)(Q) has good reduction at ιp and the F -isocrystal of its reduction in SKp(¯Fp) is b.

27

Recall that a special point of ShK is said to have good reduction at ιp if it extends as a point in

SK(Oιp) for the valuation ring Oιp of Q deﬁned by ιp.

Proof. We can apply Theorem 4.1.1 and Proposition 4.2.4, to obtain a special Shimura datum
(T1, h1 : S → (T1)R) such that (T1)Qp is unramiﬁed and the unique hyperspecial subgroup of T1(Qp)
is contained in Int(gp)(Kp) for some gp ∈ G(Qp) and that the σ-conjugacy class of µ−1
(p) ∈ G(Qur
p )
h1
equals b. Since G(Q) is dense in G(Qp) ([Mil94, Lem. 4.10]), there exists g ∈ G(Q) ∩ Kp · g−1
p .
Then, the new special Shimura datum (T, h) := Int(g)(T1, h1) still enjoys the same properties and
further satisﬁes that the unique hyperspecial subgroup of T (Qp) is contained in Kp. If moreover
(G, X) is of Hodge type, according to Lemma 3.2.4, for every gf ∈ G(Af ), the special point
[h, gf ]Kp ∈ ShKp(G, X)(Q) has good reduction at ιp : Q ֒→ Qp and the F -isocrystal of its reduction
in SKp(G, X)(¯Fp) is b.

Corollary 4.3.2. Let (G, X) be a Shimura datum of Hodge type. Choose an embedding ιp : Q ֒→ Qp
and let ℘ be the prime of E(G, X) induced by ιp. Suppose that GQp is unramiﬁed and choose a
hyperspecial subgroup Kp of G(Qp). Then the reduction SKp(G, X) × κ(℘) has non-empty ordinary
locus if and only if ℘ has absolute height one (i.e. E(G, X)℘ = Qp).

Proof. The necessity of E(G, X)℘ = Qp was proved in [Bul01, Section3]. For suﬃciency, we

note that it suﬃces to ﬁnd a special Shimura sub-datum (T, {h}) with the following properties:

(i) TQp is unramiﬁed and the unique hyperspecial subgroup of T (Qp) is contained in Kp;
(ii) there exists a Borel subgroup B over Qp of GQp containing TQp and such that µh ∈ X∗(T )

lies in the closed Weyl chamber determined by (TQp, B).

Indeed, then the canonical Galois action of Γ(p) on X∗(T ) coincides with the naive Galois action,
hence one has that E(G, X)℘ = E(T, h)p, where p is the prime of E(T, h) induced by ιp. Given
this, the corollary then follows from the fact ([Bul01, Lem.2.2]) that for a CM-abelian variety A
over Q(⊂ C) with CM-type (F, Φ), where F is a CM-algebra and Φ is a subset of Hom(F, C)) with
Φ ⊔ ι ◦ Φ = Hom(F, C), the reduction of A at ιp : Q ֒→ Qp is an ordinary abelian variety if and
only if the prime of the reﬂex ﬁeld E = E(F, Φ) induced by ιp is of absolute height one; when A is
deﬁned by a special Shimura datum (T, h), the reﬂex ﬁeld E(F, Φ) equals the reﬂex ﬁeld E(T, h)
deﬁned earlier.

:= CentGZp (SZp) are smooth, closed subschemes of GZp, and thus T ′ := T ′
Zp

Now, to prove the claim, let Kp = GZp(Zp) for a reductive Zp-group scheme model GZp of
GQp and S a maximal Qp-split torus of GQp such that in the Bruhat-Tits building B(G, Qp),
the hyperspecial point x ﬁxed by Kp is contained in the apartment associated with S. For such
S, let SZp be the reductive Zp-group scheme with generic ﬁber S and such that SZp(Zp) is the
(unique) hyperspecial subgroup of S(Qp). Then the proof of Prop. 4.2.4, (3) shows that SZp and
T ′
⊗ Qp is unramiﬁed.
Zp
Moreover, since GQp is quasi-split, T ′ is a maximal torus of GQp, and by construction the unique
hyperspecial subgroup of T ′(Qp), i.e. T ′
Zp(Zp) is contained in Kp. Since GQp is quasi-split, there
exists a Borel subgroup B′ deﬁned over Qp which contains T ′. Let µ′ be the cocharacter in c(G, X)
factoring through T ′ and lying in the closed Weyl chamber determined by (T ′, B′). Let (T, {h})
be a special Shimura sub-datum produced from (T ′, µ′) as in the proof of Theorem 4.3.1 using
Theorem 4.1.1 (so, in particular T (Zp) ⊂ Kp). Then, as (TQp, µh) is conjugate to (T ′, µ′) under
G(Qp), the claim is now clear.

Remark 4.3.3. (1) In fact, for any special Shimura sub-datum (T, h) with the properties (i), (ii) in
the proof, every special point of ShKp(G, X) deﬁned by it has µ-ordinary reduction at ιp. So, we

28

get a more direct proof of non-emptiness of µ-ordinary locus (without invoking a Levi subgroup as
in Proposition 4.2.4, etc).

(2) This corollary was proved in the PEL-type cases of Lie type A or C by Wedhorn [Wed99].
His argument was to ﬁrst establish non-emptiness of the µ-ordinary locus, and then to check that
the µ-ordinary locus equals the (usual) ordinary locus when E(G, X)℘ = Qp (in the PEL-type
cases of Lie type A or C). But to check the second statement, he relied on a case-by-case analysis.
In contrast, we observe that in view of (1), the equality of the µ-ordinary Newton point and the
ordinary Newton point when E(G, X)℘ = Qp is a consequence of the existence of a special Shimura
sub-datum (T, h) with the properties (i), (ii) in the proof (since the reduction of such special point
attains simultaneously the two Newton points when E(G, X)℘ = Qp).

5 Construction of Kottwitz triple with prescribed F -isocrystal

In this section, assuming that Gder is simply-connected, we construct a Kottwitz triple (γ0; (γ)l6=p, δ)
(see below for its deﬁnition) such that the F -isocrystal with GQp-structure attached to δ ∈ G(L)
equals the given one. According to the Langlands-Rapoport conjecture [LR87], which is now
conﬁrmed by Kisin [Kis13], such a triple corresponds to an ¯Fp-valued point in the reduction
of SKp(G, X), if it satisﬁes certain additional condition, and under this correspondence the F -
isocrystal of the abelian variety corresponding to the point is identiﬁed with the F -isocrystal de-
ﬁned by the σ-conjugacy class of δ in the triple. The Kottwitz triple that we will construct in this
section will satisfy the additional condition just mentioned. Therefore, combined with the result of
Kisin, we will get another proof of the non-emptiness of Newton strata for Shimura varieties with
simply connected derived group.

5.1 Kottwitz triples Our two main references for the material covered here are [LR87], pp.
182-183 and [Kot88], §2. Let (G, X) be a Shimura datum. Throughout this section, we assume
that Gder is simply connected. Let p be a rational prime. We ﬁx a prime ℘ of E(G, X) that is
unramiﬁed above p. Recall that Q is given as the algebraic closure of Q in C and E(G, X) is by
deﬁnition a subﬁeld of Q ⊂ C (thus the embedding Q ֒→ C determines an inﬁnite place E ֒→ C) .
For every place v of Q, we ﬁx an embedding Q ֒→ Qv, such that for v = p, ∞ this should induce
the above places of E(G, X). For each r ∈ N, let Lr denote the unramiﬁed extension of degree r of
Qp in Qp (i.e. L(Fpr ) in our previous notation), and denote by L = L(¯Fp) the completion of Qur
p ,
the maximal unramiﬁed extension of Qp in Qp. Let σ be the absolute Frobenius on L; so, Lr is the
subﬁeld of L of elements ﬁxed under σr.

5.1.1 We consider a triple (γ0; γ = (γl)l6=p, δ), where

(i) γ0 is a semi-simple element of G(Q) that is elliptic in G(R), deﬁned up to conjugacy in G(Q);

(ii) for l 6= p, γl is a semi-simple element in G(Ql), deﬁned up to conjugacy in G(Ql), which is

conjugate to γ0 in G(Ql);

(iii) δ is an element of G(Ln) (for some n), deﬁned up to σ-conjugacy in G(L), such that the norm

Nmnδ of δ is conjugated to γ0 under G(L), where Nmnδ := δ · σ(δ) · · · σn−1(δ) ∈ G(Qp).

29

There are some conditions to impose on such triple. Let I0 be the centralizer CentG(γ0) of
γ0 in G. For every place v of Q, we will deﬁne an algebraic Qv-group I(v) and an inner twisting
ψv : I0 → I(v) over Qv. First, for each ﬁnite place v 6= p of Q, let I(v) be the centralizer of γv in
GQv . If one chooses gv ∈ G(Qv) such that gvγ0g−1
v = γv, then Int(gv), restricted to I0, gives an
inner twisting ψv : I0 → I(v), well deﬁned up to inner automorphism of I0. Next, for v = p, deﬁne
an algebraic Qp-group I(p) by

I(p) := {x ∈ ResLn/Qp(GLn) | x−1δθ(x) = δ},

Here, θ is the Qp-automorphism of ResLn/Qp(GLn ) induced by the restriction of σ to Ln; for more
details, we refer to [Kot82], where θ and I(p) are denoted by s (on p. 801) and Isδ (on p. 802),
respectively. Then, Lemma 5.8 of loc.cit. gives us an inner twisting ψp : I0 → I(p), canonical up to
inner automorphisms of I0; since γ0 and NmLn/Qp(δ) are G(Qp)-conjugated, γ0 ∈ G(Qp) lies in the
stable conjugacy class of δ (cf. loc.cit. §5). Finally, at the inﬁnite place, choose an elliptic maximal
torus T of GR containing γ0. When we pick h ∈ X such that h factors through TR, by deﬁnition of
Shimura datum, Int(h(i)) induces a Cartan involution on I0/Z(G), which we use to twist I0 over
R, obtaining an inner twisting ψ∞ : I0 → I(∞) with I(∞)/Z(G) being anisotropic over R.

Then we consider the following condition on the triple (γ0; γ = (γl)l6=p, δ) as above; let ψv :

I0 → I(v) be inner twistings as just described.

(iv) There exists a triple (I, ψ, (jv )) consisting of a Q-group I, an inner twisting ψ : I0 → I and
for each place v of Q, an isomorphism jv : I → I(v) over Qv, unramiﬁed almost everywhere,
such that jv ◦ ψ and ψv diﬀer by an inner automorphism of I0 over Qv.

Deﬁnition 5.1.2. A Kottwitz triple is a triple (γ0; (γl)l6=p, δ) satisfying (i) - (iv), and the following
two conditions (∗(δ)), (∗(γ0)):

(∗(δ)) the image of (the σ-conjugacy class of) δ under the map κGQp : B(GQp) → π1(GQp)Γ(p) =

X ∗(Z(bG)Γ(p)) (Thm. 2.2.5) is equal to µ♮ (where µ♮ was deﬁned in (3.2.6)).

(∗(γ0)) Let H be the centralizer in GQp of the maximal Qp-split torus in the center of (ZG(γ0))Qp.
Then, there exists µ ∈ X∗(H) which is deﬁned over Ln and lies in c(G, X) (via the given
embeddings Q ֒→ C, Q ֒→ Qp), and such that

λH (γ0) = NmLn/Qpµ,

where λH is the homomorphism λH : H(Qp) → π1(H)Γ(p) = X ∗(Z(bH))Γ(p) deﬁned (for

quasi-split Qp-groups) in [Kot84b], §3.

Remark 5.1.3. 1) Following Kisin [Kis13], we will say that a Kottwitz triple (γ0; (γl)l6=p, δ) is of
level n if δ ∈ G(Ln).

2) Two triples (γ0; (γl)l6=p, δ), (γ′

l)l6=p, δ′) as in (5.1.1) with δ, δ′ ∈ G(Ln) for (iii) are said to
be equivalent, if γ0 is stably conjugate to γ′
l in G(Ql) for each l 6= p, ∞, and
δ is σ-conjugate to δ′ in G(Ln). Then, for two such equivalent triples, one of them is a Kottwitz
triple of level n if and only if the other one is so (cf. see [LR87, Lemma 5.17] for the condition
(∗(γ0))).

0; (γ′

0, γl is conjugate to γ′

3) As noted in [Kot88], p.172, the condition (iv) holds if the Kottwitz invariant α(γ0; γ, δ) (to

be recalled below) is trivial.

30

4) The two conditions (∗(δ)), (∗(γ0)) are from [LR87], p.182-183. Some authors do not include
these (especially, (∗(γ0))) in their deﬁnition of Kottwitz triple. This will be partly a matter of
taste. It is, however, necessary to point out [LR87] that a triple (γ0; (γl)l6=p, δ) satisfying (i)-(iv)
can correspond to an ¯Fp-valued point of the Shimura variety only if it further satisﬁes these two
conditions, so from the viewpoint of the question of ﬁnding an ¯Fp-valued point of given Shimura
variety using such triple (as in the current work), it is natural to include these conditions (∗(δ)),
(∗(γ0)) in the deﬁnition of Kottwitz triple.

5) In view of our sign convention of c(G, X) in (3.0.6), our formulation (especially the sign) of

the condition (∗(δ))) is the same as that of Kottwitz appearing in [Kot88, p.165].

[Kot88], §2.
5.2 Kottwitz invariant We recall the deﬁnition of the Kottwitz invariant, cf.
Note that the centralizer I0 of γ0 in G is connected and reductive since γ0 is semisimple and the

derived group of G is simply connected. There is a natural embedding Z(bG) → Z(bI0), and the

exact sequence

induces a homomorphism ([Kot84a, Cor.2.3])

1 → Z(bG) → Z(bI0) → Z(bI0)/Z(bG) → 1

π0((Z(bI0)/Z(bG))Γ) → H 1(Q, Z(bG)),

where Γ := Gal(Q/Q). Let ker1(Q, Z(bG)) be the kernel of the map H 1(Q, Z(bG)) → Qv H 1(Qv, Z(bG)),
and let K(I0/Q) denote the subgroup of π0((Z(bI0)/Z(bG))Γ) consisting of elements whose image in
H 1(Q, Z(bG)) lies in ker1(Q, Z(bG)). Since γ0 is elliptic, we have an identiﬁcation

K(I0/Q) = (cid:16)∩vZ(bI0)Γ(v)Z(bG)(cid:17) /Z(bG),

and this is known to be a ﬁnite group. The Kottwitz invariant α(γ0; γ, δ) is then a character of
K(I0/Q) (i.e. an element of Hom(K(I0/Q), C×)), deﬁned as a product, over all places v of Q,

of local components, where the v-component is the restriction to ∩vZ(bI0)Γ(v)Z(bG) of a character
βv(γ0; γ, δ) on Z(bI0)Γ(v)Z(bG):

α(γ0; γ, δ) = Y

v

βv(γ0; γ, δ)|∩v Z( bI0)Γ(v)Z( bG).

This product is trivial on Z(bG). The character βv(γ0; γ, δ) itself is the unique extension of another
character αv(γ0; γ, δ) on Z(bI0)Γ(v) with the restriction of βv to Z(bG) being

βv|Z( bG) =

µ1
−µ1
trivial

if
if
if

v = ∞
v = p
v 6= p, ∞.




Here, µ1 is the negative of the restriction to Z(bI0) of the Weyl group orbit in X ∗(bT ) dual to the

Weyl group orbit X∗(T ) ∩ c(G, X).4 For the deﬁnition of the character αv(γ0; γ, δ), here we will be
just contented with directing readers to the reference [Kot88], §2.

4This µ1 is identical to the character denoted by the same symbol in [Kot88, p.165].

31

5.3 Second proof of non-emptiness of Newton strata

Theorem 5.3.1. Let (G, X) be a Shimura datum such that Gder is simply connected and GQp is
unramiﬁed. Fix a hyperspecial subgroup Kp of G(Qp). Then, for any b ∈ B(GQp, C), there exist

• a maximal Q-torus T of G which is elliptic at R and unramiﬁed over Qp, and such that the

unique hyperspecial subgroup of T (Qp) is contained in a G(Qp)-conjugate of Kp,

• a Kottwitz triple (γ0; γ, δ) ∈ T (Q) × G(Ap

f ) × T (Qur

p ) with δ ∈ b and having trivial Kottwitz

invariant, and

• a cocharacter µ ∈ X∗(T ) ∩ c(G, X) such that the condition (∗(γ0)) of Deﬁnition 5.1.2 holds

for (T, µ) and that δ is σ-conjugate to µ(p) in T (L).

The Newton point νT (δ) ∈ N (TQp) = X∗(TQp)Γ(p)

Q

of δ ∈ B(TQp) equals

ν :=

1
r

NmLr/Qp(µ),

where Lr is a splitting ﬁeld of TQp, and TQp is an elliptic maximal torus of the centralizer J =
CentGQp (ν). Moreover, for any rational prime l 6= p, we can ﬁnd such object (T, µ, (γ0; γ, δ)) such
that TQl is elliptic in GQl.

Here, the statement that the condition (∗(γ0)) of Deﬁnition 5.1.2 holds for (T, µ) means that

λTQp (γ0) = NmLr/Qpµ ∈ X∗(T )Γ(p) (note that µ must be deﬁned over Lr).

Proof. Our construction of T , µ, and (γ0; δ, (γv)v6=p) ∈ T (Q × L) × G(Af ) proceeds in three
f ) in these

steps: we will ﬁnd (T, µ), the pair (γ0; δ) ∈ T (Q × L), and the elements (γv)v6=p ∈ G(Ap
orders.

Step 1. According to Proposition 4.2.4 and the ﬁrst step of the proof of Theorem 4.1.1, there
exists a maximal Q-torus T of G which is elliptic at R and at any given prime l 6= p and is unramiﬁed
over Qp, and a triple (M, b ∈ M (L), µ ∈ X∗(TQp) ∩ c(G, X)) satisfying the condition (†) combined
with TQp (particularly, κM (b) = [µ]M ).

Step 2. Choose r ∈ N such that TQp splits over Lr = L(Fpr ). Pick any µ ∈ X∗(T ) such that
κM (b) = [µ]M . In this step, we construct (γ0, δ) ∈ T (Q × L), but for this construction itself, we
will not need the condition µ ∈ c(G, X), yet; that property will be invoked later when we construct
the prime-to-p components (γv)v6=p (especially, the l-component) and verify that the associated
Kottwitz invariant is zero.

We claim that there exists v ∈ T (OLr ) (the unique maximal compact open subgroup of T (Lr))

such that the element

δ := µ(p)v ∈ T (Lr),

has the following three properties:

(a) its norm Nmr(δ) ∈ T (Qp) belongs to T (Q);

(b) δ and µ(p) are σ-conjugate in T (L);

(c) µ(b) and b are σ-conjugate in M (L).

32

It follows from (b) that the Newton point νTQp (δ) of δ ∈ B(TQp) equals 1

r NmLr/Qp(µ) ∈

N (TQp) = X∗(T )Γ(p)
Q .

We will see that as long as v ∈ T (OLr ), the property (b) always holds and the property (c)
is equivalent to that κM (b) = [µ]M . Then, it is the property (a) for which we have to make a
restricted choice of v; interestingly, µ does not play any signiﬁcant role in such choice of v.

Lemma 5.3.2. Let T be a torus over Qp.

(1) For every s ∈ N, the image of T (OLs) under the norm map Nms : T (Ls) → T (Qp) : t 7→

t · σ(t) · · · σs−1(t) is open.

(2) If T is unramiﬁed, the σ-conjugacy class of any u ∈ T (OL) is trivial.

Proof of lemma. (1) The composition of the natural maps of algebraic tori over Qp

TQp ֒→ ResLs/Qp(TLs)

Ns→ TQp

is an isogeny, so the image of the maximal compact subgroup of T (Qp) is open in T (Qp) ([PR94,
Ch.3, Cor.1]).

(2) We recall (Theorem 2.2.5 (i)) the natural transformation κ : B(·) → X∗(·)Γ(p) of set-
valued functors on the category of connected reductive groups over Qp which gives isomorphisms
for tori. For an unramiﬁed Qp-torus T , this isomorphism κT : B(T ) ∼→ X∗(T )Γ(p) is obtained
as follows [Kot85, 2.9]: tensor the normalized valuation L× → Z with X∗(T ) to get a canonical
surjection T (L) → X∗(T ). The isomorphism κT is obtained by applying the functor H 1(hσi, ·)
to this surjection; on Gm, we have κGm(b) = ordL(b) for b ∈ L×. Now, it is obvious that any
u ∈ T (OL) = Hom(X ∗(T ), O×
L is a linear combination of elements of X∗(T ) with
coeﬃcients in O×

L , hence maps to zero under the surjection T (L) → X∗(T ).

L ) = X∗(T ) ⊗Z O×

We now prove the claims. Since TQp is unramiﬁed over Qp, T (Q) is dense in T (Qp) ([Mil92,
Lemma 4.10] or [Vos98, Theorem in §11.5]). So, by Lemma 5.3.2 (1), there exists v ∈ T (OLr ) such
that

Namely, for such v, the element

Nmr(µ(p)) · Nmr(v) ∈ T (Q).

δ := µ(p) · v ∈ T (Lr)

satisﬁes the property (a). Also, by Lemma 5.3.2 (2), δ is σ-conjugated to µ(p) in T (L), which
proves (b).

Step 3. Finally, we assume that our µ ∈ X∗(T ) further satisﬁes that µ ∈ c(G, X). Fix h ∈ X
which factors through TR and let µh be the associated Hodge cocharacter. We will ﬁnd an element
γl ∈ T (Ql) which is conjugate to γ0 in G(Ql), characterized by certain cohomological property. In
general, if an element γl ∈ G(Ql) is conjugate to γ0 in G(Ql), say, γl = glγ0g−1
(gl ∈ G(Ql)), one
has that τ (glγ0g−1
(γ0)(Ql), for all τ ∈ Gal(Ql/Ql). In this
way, one obtains a bijection between the set of Ql-rational conjugacy classes of elements γl ∈ G(Ql)
which are conjugate to γ0 in G(Ql) and the set

l τ (gl) ∈ CentGQl

) = glγ0g−1

l

, i.e. g−1

l

l

Ker[H 1(Ql, I0) → H 1(Ql, G)].

33

On the other hand, we have a commutative diagram (for any ﬁnite place v) [Kot84a, Prop. 6.4]

H 1(Qv, T )

H 1(Qv, I0)

H 1(Qv, G)

(5.3.2.1)

∼=

∼=

∼=

π0(Z(bT )Γ(v))D

/ π0(Z(bI0)Γ(v))D

/ π0(Z(bG)Γ(v))D,

and for any connected reductive Qv-group H, π0(Z(bH)Γ(v))D is the subgroup of X ∗(Z(bH)Γ(v)) =
Hom(Z(bH)Γ(v), C×) of torsion elements ([RR96, 1.14]). Hence, if the image αl of the cocharacter
−(µh + µ) ∈ X∗(T ) in X ∗(Z(bI0)Γ(l)) = π1(I0)Γ(l) (via the map X∗(T ) → π1(I0)) is a torsion element
and furthermore maps to zero in X ∗(Z(bG)Γ(l)) = π1(G)Γ(l), it will belong to Ker[H 1(Ql, I0) →
H 1(Ql, G)] and accordingly we will get an element γl ∈ G(Ql) that is Ql-conjugate to γ0. But,
the cocharacter −(µh + µ) ∈ X∗(T ) in fact belongs to the subgroup X∗(T der), where T der :=
is an
h under the Weyl group

(T ∩ Gder)0(= T ∩ Gder), and X∗(T der)Γ(l) = X ∗(dT der
action, −(µh + µ) lies in the coroot lattice Pα∈∆(T,G) α∨, hence maps to zero in π1(G).

anisotropic torus by our choice of T . Moreover, as µ is an image of µ−1

) is a torsion group since T der
Ql

Γ(l)

Now, we claim that when we put

γ0 := Nmr(δ),

γv := γ0 (v 6= p, l),

γl = αl

the triple (γ0; (γv)v6=p, δ) forms a Kottwitz triple.

First, we check the two conditions (∗(δ)), (∗(γ0)) of Deﬁnition 5.1.2. For the condition (∗(δ)),

we recall the identity (from (3.2.6))

µ♮ = [µ]GQp ∈ π1(G)Γ(p),

as µ ∈ X∗(T )∩c(G, X). As δ belongs to T (L) and TQp is also a maximal torus of M , the functoriality
of the natural transformation κ : B(·) → π1(·)Γ(p) allows us to replace, in our veriﬁcation, GQp by
M , in which case the condition (∗(δ)) is our assumption κM (δ) = [µ]M .

For the condition (∗(γ0)), recall that we introduced the centralizer H of the maximal split Qp-
subtorus of the center of (ZG(γ0))Qp; since γ0 ∈ T (Q) and TQp is an unramiﬁed maximal torus of
GQp, TQp is also an unramiﬁed maximal torus of H. Hence, by the functoriality of the natural
transformation λH : H(Qp) → π1(H)Γ(p) ([Kot84b], Lemma 3.3), we may replace H by TQp, in

which case λT : T (Qp) → X∗(T )Γ(p) = X ∗(bT )Γ(p) is obtained by tensoring the normalized valuation
p )× → Z with X∗(T ) and taking invariants under Γ(p), ([Kot84b, §3]).

It follows from this

(Qur
deﬁnition that λ(T (Zp)) = 0 and thus

λTQp (γ0) = λTQp (Nmr(δ)) = λTQp (Nmr(µ)(p)) = Nmr(µ),

as required.

It remains to show the vanishing of the Kottwitz invariant α(γ0; γ, δ); recall from Subsection

5.2 that it is a product, over all places v of Q, of the restriction to ∩vZ(bI0)Γ(v)Z(bG) of characters
βv(γ0; γ, δ) on Z(bI0)Γ(v)Z(bG), which itself is a unique extension of another character αv(γ0; γ, δ)
on Z(bI0)Γ(v). For v 6= l, p, since γ0 = γv it is obvious from the deﬁnition (cf.

[Kot88, §2]) that
αv(γ0; γ, δ) and thus βv(γ0; γ, δ) as well are trivial. Also, by deﬁnition ([Kot88, §2]), αl(γ0; γ, δ) is the

34

/
/


/
/




/
/
cohomology class [g−1

l τ (gl)], regarded as an element of π0(Z(bI0)Γ(v))D via the vertical isomorphism

H 1(Qv, I0) ∼= π0(Z(bI0)Γ(v))D of (5.3.2.1), where γl = glγ0g−1
l τ (gl) ∈ I0(Ql),
hence is nothing but −[µh + µ]I0Ql
by the very deﬁnition of γl. Working out the deﬁnitions (ﬁrst
and second paragraphs on p.167 in §2 of [Kot88]) for v = p, ∞ in a similar way, we get that
αv(γ0; γ, δ) ∈ X ∗(Z(bI0)Γ(v)) = π1(I0)Γ(v) is given by
κ(I0)Qp

for gl ∈ G(Ql) with g−1

if v = p

l




(δ)
[µh]I0 R

−[µh + µ]I0Ql

αv(γ0; γ, δ) =

if v = ∞,
if v = l

See the remark at the end of Subsection 5.2 for our sign convention.

Recall that for v = p, we have (as a consequence of δ ∈ µ(p) · T (OLr )) that κTQp (δ) = [µ]TQp .

Hence, when we ﬁx embeddings bT ֒→ bI0 ֒→ bG, we see that βp(γ0; γ, δ) is equal to the restriction of
the character µ ∈ X∗(T ) = X ∗(bT ) of bT to
and similarly β∞(γ0; γ, δ) is the restriction of µ−1

h ∈ X∗(T ) = X ∗(bT ) to Z(bI0)Γ(∞)Z(bG) ֒→ bT . It
follows that the product of the restrictions of β∞(γ0; γ, δ) and βp(γ0; γ, δ) to Tv=∞,p Z(bT )Γ(v)Z(bG)
is the pull-back of the character µ + µh ∈ X∗(T ) = X ∗(bT ) to

Z(bI0)Γ(p)Z(bG) ֒→ bT Γ(p)Z(bG) ֒→ bT

\

v=∞,p

Z(bI0)Γ(v)Z(bG) ֒→ \

v=∞,p bT Γ(v)Z(bG) ֒→ bT .

As clearly βl(γ0; γ, δ) is the restriction of −(µh + µ) ∈ X∗(T ) = X ∗(bT ) to Z(bI0)Γ(l)Z(bG) ֒→ bT , we
see that the Kottwitz invariant α(γ0; γ, δ) = Qv βv(γ0; γ, δ)|∩v Z( bI0)Γ(v)Z( bG) vanishes.

It remains to show that TQp is elliptic in J. According to Proposition 4.2.4, there exist a Levi
Qp-subgroup M of GQp and a representative b of b in M (L) with νb ∈ HomQp(D, GQp) such that
M = CentGQp (νb). Then, since b = δ in B(GQp), it follows that νb = gνg−1 for some g ∈ G(L) so
that M is an inner form of J (indeed, M = Int(g)(J). On the other hand, since ν, νb are deﬁned
over Qp, g−1σ(g) ∈ CentG(L)(ν) = J(L)).
In particular, Int(g) induces a Qp-isomorphism from
Z(J) to Z(M ). Now, let T be as in Theorem 4.1.1 where the Levi subgroup M ′ in the assumption
(†) is M just chosen, so that a G(Qp)-conjugate of TQp is an elliptic maximal torus of M . But, as
TQp ⊂ J, Z(J) ⊂ TQp. Then, TQp contains a subtorus Z ′ ≈ Z(M ) such that TQp/Z ′ is anisotropic.
But, since TQp ⊂ J, Z(J) ⊂ TQp. As Z ′ ≈ Z(J), thus TQp/Z(J) is also anisotropic, i.e. TQp is
also an elliptic maximal torus of J (the maximal split subtorus S of TQp is contained in Z ′, so
Z(J) ≈ Z ′ contains a split subtorus of TQp of same rank, which then must be S). This ﬁnishes our
proof of the theorem.

Now, we can give another proof of the non-emptiness of Newton strata of Shimura varieties of

Hodge type, using the resolution of the Langlands-Rapoport conjecture by Kisin [Kis13].
Corollary 5.3.3. Let (G, X) be a Shimura datum of Hodge type such that Gder is simply-connected.
Let p be a rational prime such that GQp is unramiﬁed. Fix a prime ℘ of E(G, X) unramiﬁed over
p and a hyperspecial subgroup Kp of G(Qp). Let ¯Fp be an algebraic closure of the residue ﬁeld κ(℘)
of ℘.

Then, for every b ∈ B(GQp, X), there exists a point x ∈ ShKp(G, X)(¯Fp) whose associated

F -isocrystal is b.

35

Proof. This follows from Theorem 5.3.1 and [Kis13], Theorem 0.3. The statement of this
theorem of Kisin is formulated in terms of the notion of Galois gerbs and admissible morphisms,
but it is known (cf. [Mil92, §5], [Mil09]) that this implies that for any Kottwitz triple with trivial
Kottwitz invariant, there exists a point in ShKp(G, X)(¯Fp) which has that Kottwitz triple as the
associated Kottwitz triple.

A A lemma on algebraic groups over p-adic ﬁelds

The goal of this appendix is to give a proof of the following fact, which is perhaps well-known (for
example, it is mentioned without proof in the last paragraph on p. 172 of [LR87]). But, since we
could not ﬁnd its proof in literatures, we present a proof here.

Lemma A.0.4. Let H be an unramiﬁed semi-simple group deﬁned over a p-adic ﬁeld F with ring
of integers OF . Then H admits a maximal F -torus which is anisotropic and unramiﬁed. If K
is a hyperspecial subgroup of H(F ), there exists a such maximal F -torus T ′ (i.e. aniostropic and
unramiﬁed) such that the (unique) hyperspecial subgroup of T ′(F ) is contained in K.

Proof. We ﬁrst review some constructions in the general theory of reductive group schemes

over S = Spec(OF ).

Let us use H (by abuse of notation) again to denote the reductive group scheme over S which is
an integral model of the given F -group in question and such that H(OF ) = K. We ﬁx a maximal
S-torus T of H; by deﬁnition ([Con11, 3.2.1]), it is a S-torus T ⊂ H whose every geometric ﬁber Ts
is a maximal torus of Gs in the usual sense. Let N = NH(T ) be the normalizer scheme of T in H
([Con11, 2.1.1]): it is a (ﬁnitely presented) closed subscheme of G, smooth over S ([Con11, 2.1.2]).
Also, let W := NH(T )/ZH (T ) be the Weyl group scheme of T , where ZH (T ) is the centralizer
scheme of T in H ([Con11, 2.2]). It is a ﬁnite ´etale scheme over O [Con11, 3.2.8]). Let X be the
scheme of maximal tori of H: this is the scheme representing the functor on S-schemes

TorH/S : S′ 7→ { maximal tori in HS′}

(which is a sheaf of sets in the fppf topology, [Con11, 3.2.6]), and is a smooth aﬃne scheme ([SGA3,
XII, 5.4]). Moreover, this also represents the quotient sheaf H/N ([Con11], Thm. 2.3.1 and proof
of Thm. 3.2.6). Now, to prove the lemma, it is enough to show the existence of an anisotropic
maximal torus of the special ﬁbre Hκ = H ⊗OF κ, where κ is the residue ﬁeld of OF . Indeed, since
TorH/S is smooth over the henselian base OF , then there exists a maximal torus T ′ over OF whose
special ﬁbre is anisotropic. But, since T ′ is a torus over OF , the π1(S, η)-module attached to the
´etale sheaf X ∗(T ′) = HomS´et(T ′, Gm) is unramiﬁed (η is a geometric generic point of S), hence the
κ. Also, since T ′ is a subscheme of H, the unique hyperspecial
F -rank of T ′
subgroup T ′(OF ) of T (F ) is contained in K = H(OF ).

F equals the κ-rank of T ′

For the closed point s of S and a (ﬁxed) algebraic closure κ = κ(s) of its residue ﬁeld κ = κ(s),

there exists a canonical diagram

X(κ)

δ /

H 1(κ, Nκ)

H 1(κ, Hκ)

%❑❑❑❑❑❑❑❑❑❑

ϕ:=j◦δ

j

H 1(κ, Wκ)

/ H 1(κ, AutTκ)

36

/
%
/
/


/
Here, the upper sequence of pointed sets is exact and δ is deﬁned as follows: for a maximal κ-torus
T ′ of Hκ, the image of T ′ ∈ X(κ) under δ is the cohomology class of the cocycle

σ 7→ aσ := g−1 · σ(g) ∈ N (κ),

where g ∈ H(κ) satisﬁes T ′ = gT g−1. The lower horizontal map is induced from the injection
W ֒→ AutT . On the other hand, the pointed set H 1(κ, AutT ) classiﬁes the κ-isomorphism classes
of κ-forms of Tκ, and for any T ′ ∈ X(κ), its corresponding class in H 1(κ, AutTκ) is the image
of [ϕ(T ′)] under the natural map H 1(κ, Wκ) → H 1(κ, AutTκ), namely, T ′ is the twist of T by
(a cocycle in W (κ) representing) ϕ(T ′). Therefore, to prove the lemma, it will suﬃce to ﬁnd a
cohomology class ξ ∈ H 1(κ, Wκ) which lies in the image of ϕ and such that the twist ξT of Tκ by
ξ is anisotropic. But, since H 1(κ, Hκ) = H 2(κ, Tκ) = {1} (Lang’s theorem), ϕ is always surjective,
hence we only need to ﬁnd a cohomology class ξ ∈ H 1(κ, Wκ) such that the twist ξTκ is anisotropic.
This is also well-known. More explicitly, recalling the fact that every reductive group over a
ﬁnite ﬁeld is quasi-split, choose a Borel pair (T1, B1) deﬁned over κ, and let ∆ be the associated
set of simple roots of (Hκ, T1), and N (T1) the normalizer of T1; thus, the Frobenius automorphism
σ of κ acts on X ∗(T1), leaving ∆ stable. Then, what one needs is an element w ∈ N (T1) such
that wσ ∈ H(κ) ⋊ Gal(κ/κ) does not have a ﬁxed vector in X∗(T )R. In this case, it is shown in
[Spr74, Lemma 7.4] that if {α1, · · · , αm} is a set of representatives of the Gal(κ/κ)-orbits in ∆, the
product ω (in any order) of the corresponding simple reﬂections ri (i = 1, · · · , m), called “twisted
Coxeter element”, has such property.

References

[BO83] P. Berthelot, A. Ogus, F-isocrystals and de Rham cohomology. I. Invent. Math. 72 (1983),

no. 2, 159-199.

[Bla94] D. Blasius, A p-adic property of Hodge classes on abelian varieties. Motives (Seattle, WA,
1991), 293-308, Proc. Sympos. Pure Math., 55, Part 2, Amer. Math. Soc., Providence, RI,
1994.

[BT84] F. Bruhat, J. Tits. Groupes r´eductifs sur un corps local. II. Sch´emas en groupes. Existence
d’une donn´ee radicielle valu´ee. Inst. Hautes ´Etudes Sci. Publ. Math. No. 60 (1984), 197-376.

[Bou05] N. Bourbaki. Lie groups and Lie algebras. Chapters 4-6, Chapters 7-9. Elements of

Mathematics (Berlin). Springer-Verlag, Berlin, 2002, 2005.

[Bul01] O. B¨ultel. Density of the ordinary locus. Bull. London Math. Soc. 33 (2001), no. 2, 149-156.

[Cha00] C.-L. Chai. Newton polygons as lattice points. Amer. J. Math. 122 (2000), no. 5, 967-990.

[Con11] B. Conrad. Reductive group schemes. Notes for “SGA3 summer school”, 2011, available

at http://math.stanford.edu/~conrad/papers/luminysga3smf.pdf

[Del71] P. Deligne. Travaux de Shimura. Seminaire Bourbaki, 23eme annee (1970/71), Exp. No.

389, 123-165. Lecture Notes in Math., Vol. 244, Springer, Berlin, 1971.

37

[Del77] P. Deligne. Vari´et´es de Shimura: interpr´etation modulaire, et techniques de construction
de mod`eles canoniques. Automorphic forms, representations and L-functions (Proc. Sympos.
Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 2, 247-289, Proc. Sympos. Pure
Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[DMOS82] P. Deligne, J.S. Milne, A. Ogus, K-Y. Shih. Hodge cycles, motives, and Shimura vari-

eties. Lecture Notes in Math., 900. Springer-Verlag, Berlin-New York, 1982.

[SGA3] M. Demazure, A. Grothendieck. Sch´emas en groupes I, II, III. Lecture Notes in Math.,

151, 152, 153, Springer-Verlag, New York, 1970.

[Far04] L. Fargues. Cohomologie des espaces de modules de groupes p-divisibles et correspondances
de Langlands locales. Vari´et´es de Shimura, espaces de Rapoport-Zink et correspondances de
Langlands locales. Ast´erisque No. 291 (2004), 1-199.

[FM87] J.-M. Fontaine, W. Messing. p-adic periods and p-adic ´etale cohomology. Current trends
in arithmetical algebraic geometry (Arcata, Calif., 1985), 179-207, Contemp. Math., 67, Amer.
Math. Soc., Providence, RI, 1987.

[Kis09] M. Kisin. Integral canonical models of Shimura varieties. J. Th´eor. Nombres Bordeaux 21

(2009), no. 2, 301-312.

[Kis10] M. Kisin. Integral models for Shimura varieties of abelian type. J. Amer. Math. Soc. 23

(2010), no. 4, 967-1012.

[Kis13] M. Kisin. Mod p-points on Shimura varieties of abelian type. preprint available on

http://www.math.harvard.edu/~kisin/

[Kos14] J.-S. Koskivirta Sections of the Hodge bundle over Ekedahl-Oort strata of Shimura varieties

of Hodge type. http://arxiv.org/abs/1410.1317.

[Kot82] R. Kottwitz. Rational conjugacy classes in reductive groups. Duke Math. J. 49 (1982), no.

4, 785-806.

[Kot84a] R. Kottwitz. Stable Trace Formula: Cuspidal Tempered Terms. Duke Math. J. 51 (1984),

611-650.

[Kot84b] R. Kottwitz. Shimura Varieties and Twisted Orbital Integrals. Math. Ann. 269 (1984),

287-300.

[Kot85] R. Kottwitz. Isocrystals with additional structure. Compositio Math. 56 (1985), no. 2,

201-220.

[Kot86] R. Kottwitz. Stable Trace Formula: Elliptic Singular Terms. Math. Ann. 275 (1986),

365-399.

[Kot88] R. Kottwitz. Shimura varieties and λ-adic representations. Automorphic forms, Shimura
varieties, and L-functions, Vol. I (Ann Arbor, MI, 1988), 161-209, Perspect. Math., 10, Aca-
demic Press, Boston, MA, 1990.

38

[Kot92] R. Kottwitz. Points on some Shimura varieties over ﬁnite ﬁelds. J. Amer. Math. Soc. 5

(1992), no. 2, 373-444.

[Kot97] R. Kottwitz. Isocrystals with additional structure. II. Compositio Math. 109 (1997), no.

3, 255-339.

[KR03] R. Kottwitz, M. Rapoport. On the existence of F-crystals. Comment. Math. Helv. 78

(2003), no. 1, 153-184.

[Kot03] R. Kottwitz. On the Hodge-Newton decomposition for split groups. Int. Math. Res. Not.

2003, no. 26, 1433-1447.

[Kre13] A. Kret. The trace formula and the existence of PEL type Abelian varieties modulo p.

http://arxiv.org/abs/1209.0264.

[Lan83] R. P. Langlands. Les d´ebuts d’une formule des traces stable. Publ. Math. de l’Univ. Paris

VII 13, Paris 1983.

[LR87] R. P. Langlands, M. Rapoport. Shimuravariet¨aten und Gerben. J. Reine Angew. Math.

378 (1987), 113-220.

[Mil92] J.S. Milne. The points on a Shimura variety modulo a prime of good reduction. The zeta

functions of Picard modular surfaces, Univ. Mont´eal, Montr´eal, QC, 1992.

[Mil94] J.S. Milne. Shimura varieties and motives. Motives (Seattle, WA, 1991), 447–523, Proc.

Sympos. Pure Math., 55, Part 2, Amer. Math. Soc., Providence, RI, 1994.

[Mil09] J.S. Milne. Points on Shimura varieties over ﬁnite ﬁelds: the conjecture of Langlands and

Rapoport. http://arxiv.org/abs/0707.3173.

[Moo98] B. Moonen. Models of Shimura varieties in mixed characteristics. Galois representations
in arithmetic algebraic geometry (Durham, 1996), 267-350, London Math. Soc. Lecture Note
Ser., 254, Cambridge Univ. Press, Cambridge, 1998.

[Noo96] R. Noot. Models of Shimura varieties in mixed characteristic. J. Algebraic Geom. 5 (1996),

no. 1, 187-207.

[Oor13] F. Oort. Moduli of abelian varieties in mixed and in positive characteristic. Handbook of

moduli. Vol. III, 75-134, Adv. Lect. Math. (ALM), 26, Int. Press, Somerville, MA, 2013.

[PR94] V. Platonov, A. Rapinchuk. Algebraic groups and number theory. Pure and Applied

Mathematics, 139, Academic Press, Inc., Boston, MA, 1994.

[RR96] M. Rapoport, M. Richartz. On the classiﬁcation and specialization of F -isocrystals with

additional structure. Compositio Math. 103 (1996), no. 2, 153-181.

[Rap03] M. Rapoport. On the Newton stratiﬁcation.

S´eminaire Bourbaki. Vol. 2001/2002.

Ast´erisque No. 290 (2003), Exp. No. 903, viii, 207-224.

[Rap05] M. Rapoport. A guide to the reduction modulo p of Shimura varieties. Automorphic

forms. I. Ast´erisque No. 298 (2005), 271-318.

39

[SS13] P. Scholze, SW. Shin. On the cohomology of compact unitary group Shimura varieties at

ramiﬁed split places. J. Amer. Math. Soc. 26 (2013), no. 1, 261-294.

[Sh79] D. Shelstad. Characters and inner forms of a quasisplit group over R. Comp. Math. 39

(1979), 11-45.

[Spr74] T.A. Springer. Regular elements of ﬁnite reﬂection groups. Invent. Math. 25 (1974), 159-

198.

[Spr98] T.A. Springer. Linear algebraic groups. Progress in mathematics, vol. 9, Birkh¨auser,

Boston, Mass., 1998.

[Sta97] H. Stamm. On the reduction of the Hilbert-Blumenthal-moduli scheme with Γ0(p)-level

structure. Forum Math. 9 (1997), no. 4, 405-455.

[Tit79] J. Tits. Reductive groups over local ﬁelds. Automorphic forms, representations and L-
functions (Proc. Sympos. Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 1, pp.
29-69, Proc. Sympos. Pure Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[Vas99] A. Vasiu. Integral canonical models of Shimura varieties of preabelian type. Asian J. Math.

3 (1999), no. 2, 401-518.

[Vas07] A. Vasiu. Good Reductions of Shimura Varieties of Hodge Type in Arbitrary Un-
http://arxiv.org/abs/0707.1668 and

ramiﬁed Mixed Characteristic, Parts I and II.
http://arxiv.org/abs/0712.1572.

[Vas08] A. Vasiu. Geometry of Shimura varieties of Hodge type over ﬁnite ﬁelds. Proceedings
of the NATO Advanced Study Institute on “Higher dimensional geometry over ﬁnite ﬁelds”,
G¨ottingen, Germany (June 25 - July 06, 2007), 197-243, IOS Press, 2008.

[Vas11] A. Vasiu. Manin problems for Shimura varieties of Hodge type. J. Ramanujan Math. Soc.

26 (2011), no. 1, 31-84.

[Vas12] A. Vasiu. A motivic conjecture of Milne. J. Reine Angew. Math. 685 (2013), 181-247.

[VW13] E. Viehmann, T. Wedhorn. Ekedahl-Oort and Newton strata for Shimura varieties of

PEL-type. Math. Ann. 356 (2013), 1493-1550.

[Vos98] V. E. Voskresenskii. Algebraic groups and their birational invariants. Translations of Math-

ematical Monographs, 179. American Mathematical Society, Providence, RI, 1998. xiv+218.

[Wed99] T. Wedhorn. Ordinariness in good reductions of Shimura varieties of PEL-type. Ann. Sci.

´Ecole Norm. Sup. (4) 32 (1999), no. 5, 575-618.

[Win05] J.-P. Wintenberger. Existence de F-cristaux avec structures suppl´ementaires. Adv. Math.

190 (2005), no. 1, 196-224.

[Wor13] D. Wortmann.

The µ-ordinary locus

for Shimura varieties of Hodge

type.

http://arxiv.org/abs/1310.6444.

40

[Yu05] C.-F. Yu. On the slope stratiﬁcation of certain Shimura varieties. Math. Z. 251 (2005), no.

4, 859-873.

Center for Geometry and Physics, Institute for Basic Science (IBS),
Pohang 790-784, Republic of Korea
Email: dulee@ibs.re.kr

41

