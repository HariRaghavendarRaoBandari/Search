6
1
0
2

 
r
a

 

M
5
1
 
 
]

.

O
C
h
t
a
m

[
 
 

1
v
6
3
8
4
0

.

3
0
6
1
:
v
i
X
r
a

The chromatic number of dense random graphs

Annika Heckel ∗

March 16, 2016

Abstract

The chromatic number χ(G) of a graph G, deﬁned as the minimum number of colours
required for a vertex colouring where no two adjacent vertices are coloured the same, is
one of the central topics in graph theory in general, and in the study of random graphs in
particular. Despite being intensively studied since the 1970s, the exact value of the chro-
matic number χ(G) of the dense random graph G ∼ G(n, p) where p ∈ (0, 1) is constant
remains open. In this paper, new upper and lower bounds for χ(G) are established. These
bounds are the ﬁrst ones that match each other up to a o(1)-term in the denominator:
They narrow down the colouring rate n/χ(G) of G ∼ G(n, p) to an explicit interval of
length o(1).

1

Introduction and results

For p ∈ [0, 1], we denote by G ∼ G(n, p) the Erd˝os–R´enyi random graph with n labelled
vertices where each of the(cid:0)n
2(cid:1) possible edges is present independently with probability p. The
chromatic number χ(G) of a graph G is deﬁned as the minimum number of colours required for
a proper colouring of the vertices of G, which is a colouring where no two adjacent vertices are
coloured the same. The chromatic number is one of the central topics both in graph theory in
general and in the study of random graphs in particular, and has a wide range of applications
including scheduling and resource allocation problems.

We say that an event E = E(n) holds with high probability (whp) if limn→∞ P(E) = 1.
For two functions f, g : N → R, we write f = o(g) if f (n)/g(n) → 0 as n → ∞. The order
of magnitude of the chromatic number of the dense random graph G ∼ G(n, p) with constant
p ∈ (0, 1) was ﬁrst established by Grimmett and McDiarmid in 1975, who showed that whp,

(1 + o(1))

n

2 logb n

6 χ(G) 6 (1 + o(1))

n

logb n

,

where b = 1
1−p . They also conjectured that the asymptotic value of χ(G) lies near the lower
bound. Establishing the asymptotic behaviour of χ(G) remained one of the major open
problems in random graph theory until it was settled by a breakthrough result of Bollob´as in
1987 [5], who showed that whp,

χ(G) = (1 + o(1))

n

2 logb n

.

∗Mathematical Institute, University of Oxford, Andrew Wiles Building, Woodstock Road, Oxford OX2 6GG,

UK. E-mail: heckel@maths.ox.ac.uk

1

The same result was obtained independently by Matula and Kuˇcera [21].

Reﬁning Bollob´as’ approach, more accurate bounds were given by McDiarmid [22], who

showed in particular that whp,

χ(G) =

n

2 logb n − 2 logb logb n + O(1)

.

The current best upper bound was obtained by Fountoulakis, Kang and McDiarmid [13]
through a very accurate analysis of Bollob´as’ general approach, whereas the best lower bound
comes from a ﬁrst moment argument due to Steger and Panagiotou [24]: Let

γ = γp(n) = 2 logb n − 2 logb logb n − 2 logb 2,

then whp,

n

γ + o(1)

6 χ(G) 6

n

.

γ − 1 + o(1)

(1)

(2)

As observed in [13], considering the above in terms of the colouring rate ¯α(G) = n/χ(G),
which is the average colour class size of a proper colouring with the minimum number of
colours, these inequalities give an explicit interval of length 1 + o(1) which contains ¯α(G)
whp. In [17], Kang and McDiarmid remark that it is a natural problem to determine the
value of ¯α(G) up to an error of size o(1).

The following result settles this question, giving new upper and lower bounds for χ(G)

which match up to the o(1) term in the denominator.

Theorem 1. Let p ∈ (0, 1) be constant, and consider the random graph G ∼ G(n, p). Let
q = 1 − p, b = 1
q , γ = γp(n) = 2 logb n − 2 logb logb n − 2 logb 2 and ∆ = ∆p(n) = γ − ⌊γ⌋.
Then whp,

where x0 > 0 is the smallest nonnegative solution of

χ(G) =

n

,

γ − x0 + o(1)

(1 − ∆ + x) logb(1 − ∆ + x) +

(∆ − x)(1 − ∆)

2

6 0.

(3)

As ∆ > 0 is a solution of (3), x0 is well-deﬁned, and 0 6 x0 6 ∆. We will see in Section 3.2
that for p 6 1−1/e2, the smallest nonnegative solution of (3) is x0 = 0, while for p > 1−1/e2,
the solutions of (3) depend not only on p but also on n, and we have 0 6 x0 6 1 − 2
log b (in
fact, the values of x0 are dense in the interval [0, 1 − 2
log b ]). Therefore, we can derive the
following simpler bounds:
Corollary 2. Let p ∈ (0, 1) be constant, b = 1
graph G ∼ G(n, p).
a) If p 6 1 − 1/e2, then whp,

1−p and deﬁne γ as in (1). Consider the random

n

χ(G) =

.

γ + o(1)

b) If p > 1 − 1/e2, then whp,

n

γ + o(1)

6 χ(G) 6

n
γ − 1 + 2
log b + o(1)

.

2

n

γ+o(1) colours.

For p 6 1 − 1/e2, the lower bound in Theorem 1 is simply the known lower bound (2)
due to Steger and Panagiotou, which was obtained by estimating the ﬁrst moment of the
number of vertex partitions which induce proper colourings. The ﬁrst moment threshold of
this random variable, i.e., the point where the ﬁrst moment changes from tending to 0 to
tending to ∞, occurs at about

For p > 1− 1/e2, we shall also employ the ﬁrst moment method to establish our new lower
bound, although a diﬀerent ﬁrst moment threshold will take precedence. The independence
number α(G) is deﬁned as the size of the largest independent set in G, i.e., the largest set
of vertices without any edges between them. In a proper colouring, each colour class forms
an independent set, and so no colour class can be larger than α(G). It will turn out that
for p > 1 − 1/e2, γ is so close to α(G) that the hardest part in colouring G is ﬁnding a
suﬃcient number of disjoint independent sets of size ⌈γ⌉ or larger. If we colour G with about
γ−x colours for some x > 0, then the average colour class size is about γ − x. In every such
colouring, there must be a certain minimum number of colour classes of size at least ⌈γ⌉.
Therefore, a partial colouring with this number of colour classes of size ⌈γ⌉ must exist if G
n
γ−x –colourable. Condition (3) describes the ﬁrst moment threshold of the number of such
is
partial colourings.

n

The upper bound in Theorem 1 is much harder to prove. In contrast to previous upper
bounds, it will not be obtained through a variant of Bollob´as’ method but through the second
moment method; and our approach will be outlined in Section 2. Analysing the second
moment of the number of colourings of a random graph is a notoriously hard problem, as
it involves examining the joint behaviour of all pairs of possible colourings, which varies
considerably depending on how similar they are to each other. Therefore, we will distinguish
three diﬀerent ranges of “overlap” between diﬀerent pairs of colourings; each range requires
diﬀerent tools and ideas which will be outlined in Section 5.1.

Related work

Regarding concentration, Shamir and Spencer [26] showed that for any function p = p(n), the
chromatic number of G(n, p) is whp concentrated on an interval of length about √n, and for
constant p, this can be improved to an interval of length about √n/ log n (this is an exercise
in Chapter 7.3 of [4], see also [25]). For smaller functions p = p(n), much more is known.
Shamir and Spencer showed that for p = n−c where c > 1/2 is constant, the chromatic
number of G(n, p) is concentrated on an interval of constant length.  Luczak [20] improved this
to an interval of length 2 for c > 5/6, and ﬁnally Alon and Krivelevich [3] showed two-point
concentration for all c > 1/2.

None of these concentration results gives any information about the location of the in-
 Luczak [19] determined the asymptotic value of the chromatic number of
tervals, however.
G ∼ G(n, p) whenever d0/n 6 p = o(1) for some large enough constant d0. For p = d/n,
where d is constant, Achlioptas and Naor [2] gave two explicit values which the chromatic
number of G(n, p) may take whp, and determined the chromatic number exactly for roughly
half of all values d. Recently, Coja-Oghlan and Vilenchik [11] extended this result to almost
all constant values d. For p = n−c where 3/4 < c 6 1, Coja-Oghlan, Panagiotou and Steger
[12] gave three explicit values for the chromatic number.

In another direction, the search for sharp thresholds for k-colourability has received a
lot of attention. Achlioptas and Friedgut [1] showed that for every ﬁxed k there is a sharp
threshold sequence dk(n)
such that for any ε > 0, if p = (dk − ε)/n, then whp G ∼ G(n, p) is

n

3

k-colourable, and if p = (dk + ε)/n, then whp G ∼ G(n, p) is not k-colourable. It is unknown
whether the sequence dk(n) converges, but it follows from the results of Achlioptas and Naor
[2] that if it does, it lies in an explicit interval of length of order O(log k). Recently, there has
been considerable progress in this area by Coja-Oghlan and Vilek [10] and Coja-Oghlan [9],
who used ideas inspired by statistical physics to narrow down the length of this interval to
roughly 0.39.

2 Outline

From now on, let p ∈ (0, 1) be constant and G ∼ G(n, p).

Independence number, ﬁrst moment method and the lower bound

The chromatic number χ(G) is closely linked to the independence number α(G), and the
behaviour of the independence number of random graphs is very well understood. Recall that
b = 1/(1 − p), and let

α0 = 2 logb n − 2 logb logb n + 2 logb (e/2) + 1.

For p constant, Bollob´as and Erd˝os showed in 1976 ([8], see also Chapter 11 in [6]) that whp,

α(G) = ⌊α0 + o(1)⌋ =(cid:22)γ +

2

log b

+ 1 + o(1)(cid:23) ,

(4)

pinning down α(G) to at most two values whp.

In a proper colouring each colour class forms an independent set, so for any graph G,
χ(G) > n/α(G). For a long time, the best known lower bound for the chromatic number of
dense random graphs was obtained from this simple fact, until Panagiotou and Steger [24]
used a ﬁrst moment argument instead.

The ﬁrst moment method is a simple yet powerful tool, and is based on the observation
that for any integer random variable X > 0, if the ﬁrst moment E[X] tends to 0, then by
Markov’s inequality, so does P(X > 0) = P(X > 1). In [24], X is the number of all vertex
γ+o(1) colours.
partitions of G which induce valid colourings (i.e., unordered colourings) with
Since E[X] → 0 for an appropriate choice of the o(1)-term in the denominator, it follows that
whp no proper colouring with this number of colours exists, and the lower bound (2) follows.
It turns out, however, that for p > 1 − 1/e2, the chromatic number of G(n, p) can not in
general be found near n
γ colours, the average
colour class size γ gets so close to α(G) that there are simply not enough disjoint independent
sets of size at least a := ⌈γ⌉.
log b + 1 < 2, so it follows from (4) that α(G) = a or
α(G) = a + 1 whp as shown in Figure 1. In particular, there are whp no independent sets
larger than a+1. Therefore, any colouring with average colour class size about γ must contain
a certain proportion of colour classes of size at least a (and at most a + 1).

γ . This is because for colourings with about n

n

Note that in this case α0 − γ = 2

In Section 4, we shall consider the number of such partial colourings with large colour
classes (or rather, the number of sets of disjoint large independent sets inducing them) which
are required for colourings with average colour class size of a little more than γ − x0, where
x0 is the solution of (3). We will show that their expected number is o(1), so whp no such
partial colouring and hence no such complete colouring of G exists.

4

x0

γ − x0

γ

α(G)

1 + 2
log b

∆

x0

γ − x0

γ

α0

α0

α(G)

∆

1 + 2
log b

If p > 1 − 1/e2, whp either α(G) = a = ⌈γ⌉ (top picture) or α(G) = a + 1 (bottom
Figure 1:
picture). In the ﬁrst case, there are only o (n/ log n) independent sets of size ⌈γ⌉, and so the colouring
rate n/χ(G) drops back to the next smaller integer ⌊γ⌋, i.e., x0 = ∆. In the second case, there are
enough independent sets of size ⌈γ⌉, but not necessarily enough disjoint ones, and we have to correct
the colouring rate n/χ(G) by x0 ∈ [0, 1 − 2

log b ] to reﬂect this.

The second moment method and the upper bound

The upper bound in Theorem 1 is harder to prove and requires a more sophisticated tool,
namely the second moment method. Fix an arbitrary ε ∈ (0, 1). If we can show that whp,

χ(G) 6

n

(5)

P (Zk > 0) >

E[Zk]2
E[Z 2
k ]

> exp(cid:18)−

n

log7 n(cid:19)

5

this suﬃces to establish the upper bound in Theorem 1. Letting

,

γ − x0 − 2ε
γ − x0 − ε(cid:25) ,

n

k = k(n) =(cid:24)

we shall study k-colourings of G. For simplicity, we only consider balanced k-colourings where
the sizes of the colour classes diﬀer by at most 1.

We call a vertex partition into k parts a k-equipartition if the part sizes diﬀer by at most 1.
We call an ordered partition an ordered k-equipartition if the parts sizes diﬀer by at most 1

and decrease in size (so the parts of size (cid:6) n

Denote by Zk the number of ordered k-equipartitions which induce proper colourings, i.e.,
where all parts form independent sets. Then our goal will be to bound the second moment
of Zk in terms of E[Zk]2. More speciﬁcally, our aim will be to show that for n large enough,

k(cid:7) come ﬁrst, followed by the parts of size (cid:4) n
k(cid:5)).

E[Z 2
k ]

E[Zk]2 6 exp(cid:18) n

log7 n(cid:19) .

(6)

Let us brieﬂy discuss why (6) suﬃces to prove (5). By the Paley–Zygmund inequality, (6)
implies that

for large enough n. Therefore, for n large enough,

P(χ(G) 6 k) > P (Zk > 0) > exp(cid:18)−

n

log7 n(cid:19) .

(7)

The term on the right-hand side of course tends to 0, so it may at ﬁrst seem that (7) is not
particularly helpful in proving (5). However, as ﬁrst noted by Frieze in [14], all is not lost in
cases like these where we have a lower bound on a probability which tends to 0 suﬃciently
slowly. Using martingale inequalities, we will see that the chromatic number of random graphs
is concentrated so tightly around its mean that by adding only a few additional colours, we
can boost the lower bound (7) to a bound which tends to 1.

Indeed, for G ∼ G(n, p), consider the vertex exposure martingale (for more details see [22],
or Chapter 2.4 in [16]): Arbitrarily modifying the edges incident with any particular vertex of
G can change the value of χ(G) by at most 1. Therefore, if we consider the martingale which
is deﬁned by the conditional expectation of χ(G) given the edges between the ﬁrst n′ 6 n
vertices, it follows from the Azuma–Hoeﬀding or McDiarmid inequality that for all t > 0,

P(cid:18)|χ(G) − E (χ(G)) | > t(cid:19) 6 2 exp(cid:18)−

t2

2n(cid:19) .

(8)

This implies that k > E (χ(G))− n
would contradict (7). But then again by (8), if we let ˆk = k + 2n
log3 n

log3 n

,

for n large enough, because otherwise (8) with t = n

log3 n

P(cid:16)χ(G) > ˆk(cid:17) 6 P(cid:18)χ(G) > E (χ(G)) +

n

log3 n(cid:19) → 0

as n → ∞. Therefore, whp

χ(G) 6 ˆk = k +

2n

log3 n

6

n

γ − x0 − 2ε

,

as required.

So to prove the upper bound in Theorem 1, it remains to show (6). Note that as

Zk =

π an ordered k-equipartition

X

1{π induces a proper colouring},

by linearity of the expectation,

E[Z 2

k ] =

π1,π2 ordered k-equipartitions

X

P (both π1 and π2 induce proper colourings) ,

(9)

where the joint probability that both π1 and π2 induce proper colourings of course depends
critically on how similar they are.

Classifying the amount of overlap between π1 and π2 and splitting up the calculation into
manageable cases will be the main challenge of the proof. In Section 5, we will ﬁrst quantify
the amount of overlap between two partitions, and in Sections 5.2–5.4, we will proceed to
distinguish three diﬀerent ranges of overlap and bound their respective contributions to (6).
Each range will be tackled through a diﬀerent approach. A more detailed overview of the
diﬀerent ideas and tools for each range is given in Section 5.1.

6

As described in the outline, we are going to show that for any ε > 0, whp χ(G) > l, and

n

γ − x0 + ε(cid:23) .

and let

n

γ − x0 − ε(cid:25) and l =(cid:22)
k =(cid:24)
that P (χ(G) 6 k) > exp(cid:16)− n
log7 n(cid:17).
k −j n
kk ,

k1 = δk

Letting

n

δ =

a k-equipartition consists of exactly k1 parts of size (cid:6) n
in an ordered k-equipartition, the ﬁrst k1 parts are of size (cid:6) n
of size (cid:4) n
k(cid:5).

3 Preliminaries and notation

From now on, we will always assume that n is large enough so that various bounds and
approximations hold, even when this is not stated explicitly.

For two functions f = f (n), g = g(n), we say that f is asymptotically at most g, denoted
by f . g, if f (n) 6 (1 + o(1))g(n) as n → ∞. Analogously, f & g means that f (n) >
(1 + o(1))g(n). We write f = O(g) if there are constants C and n0 such that |f (n)| 6 Cg(n)
for all n > n0. Furthermore, we say that f = Θ(g) if f = O(g) and g = O(f ).
Recall that γ = 2 logb n − 2 logb logb n − 2 logb 2 and that we ﬁxed an arbitrary ε ∈ (0, 1),

and

k(cid:7) and exactly k2 parts of size (cid:4) n

k2 = (1 − δ)k,
k(cid:5), and
k(cid:7) and the remaining k2 parts are

Let P denote the total number of ordered k-equipartitions of the n vertices, then

P =

n!

.

k(cid:5)!k2
Since by Stirling’s approximation, n! = Θ(cid:0)nn+1/2e−n(cid:1),

(cid:6) n
k(cid:7)!k1(cid:4) n

P = kn exp(o(n)).

Given a k-equipartition, there are exactly

f = k1 ·(cid:18)⌈n/k⌉

2 (cid:19) + k2 ·(cid:18)⌊n/k⌋

2 (cid:19) =

n(cid:0) n
k − 1(cid:1)

2

+

δ(1 − δ)

2

· k

(10)

(11)

(12)

forbidden edges which are not present in G if the partition induces a proper colouring. There-
fore, the probability that a given ordered k-equipartition induces a proper colouring is exactly
qf , so

µk := E[Zk] = P qf .

(13)

Considering the known upper bound for χ(G) in (2), we may assume that

n
k

= γ − x0 − ε + o(1) > γ − 1,

since we can simply use (2) instead for all n where this is not the case. Recalling that

a = ⌈γ⌉ = γ + 1 − ∆,

then by our assumption (cid:6) n
For easier notation, we will also assume that γ is not an integer, and that therefore
⌊γ⌋ = a − 1. We may replace γ by γ − 1/n, say, for all n where this is not the case (if there
are any such n at all), and the statement of the theorem and its proof remain unchanged.

k(cid:7) ∈ {a − 1, a}.

7

3.1 List of key facts and relations

an integer.

number and a = ⌈γ⌉ (as remarked in Section 2).

Below is a list of some facts, bounds and approximations so that we can conveniently refer
back to them later on.
(A) If p > 1 − 1/e2, then whp α(G) ∈ {a, a − 1}, where α(G) denotes the independence
(B) By our assumption, (cid:6) n
k(cid:7) ∈ {a, a − 1}, where a = ⌈γ⌉. We may also assume that γ is not
(C) In a k-equipartition, there are k1 = δk parts of size (cid:6) n
k(cid:7) and k2 = (1 − δ)k parts of size
k −(cid:4) n
k(cid:5).
(D) γ ∼ a ∼ n
l ∼ 2 logb n = Θ (log n)
log n(cid:17)
2 logb n = Θ(cid:16) n
(E) k ∼ l ∼ n
a ∼ n
(F) q−γ/2 = bγ/2 = n
2 logb n ∼ k ∼ l

k(cid:5), where δ = n
(cid:4) n
k ∼ n
γ ∼ n

(G) k

1
n/k = O(1) and k

1

log n = O(1).

(H) f ∼ n logb n.
(J) For any integer function ϕ = ϕ(n) = o(n), (cid:0)n

(K)

µk
k1!k2! > bεn/4.

ϕ(cid:1) 6 exp (o(n)).

2 logb n , so with Stirling’s formula, k! = kk(1+o(1)) = nk(1+o(1)) = bn( 1

Proof. Note that k1!k2! = k! exp (o(n)), since (cid:0) k
k ∼ n
the deﬁnition (12) of f , we can see that qf = b−f = b− n2
(11) and (13),

k1(cid:1) 6 2k. Furthermore, by (E) we have

2 exp(o(n)). Therefore, from

2 +o(1)). From

2k + n

=

exp (o(n)) .

Note that n

µk

=

knqf
k!

P qf
k1!k2!

k1!k2!

2k(cid:17)n
exp (o(n)) =(cid:16)kb− n
k = γ − x0 − ε + o(1) 6 γ − ε + o(1), so by (F),
∼ bε/2,

2k > kb

kb− n

−γ+ε+o(1)

2

and therefore, for n large enough,

µk
k1!k2! > bεn/4 as required.

3.2 On the solutions of (3)

In this section we will explore the solutions of the inequality (3) in Theorem 1, and prove some
technical lemmas which will be needed later. All the proofs in this sections are straightforward
analytical arguments, so the reader might wish to skip the details.

Let

f (x) = fn(x) = (1 − ∆ + x) logb(1 − ∆ + x) + (1 − ∆)(∆ − x)/2.

8

Then x0 is deﬁned in Theorem 1 as the smallest nonnegative solution of f (x) 6 0. Since
f (∆) = 0, x0 is well-deﬁned and x0 ∈ [0, ∆]. Note that
1
log b −
> 0.

f ′(x) = logb(1 − ∆ + x) +
f ′′(x) =

1 − ∆

2

1

(1 − ∆ + x) log b

Therefore, f is convex and there are three diﬀerent possible cases for the location of x0 as
shown in Figure 2. In the ﬁrst case, f (0) 6 0 and therefore x0 = 0. In the second and third
case, f (0) > 0, so x0 > 0. In the second case, x0 lies strictly between 0 and ∆, and in the
third case, x0 = ∆, which happens if and only if f ′(∆) 6 0, or equivalently 1 − ∆ > 2
log b .
This case corresponds to the upper picture in Figure 1.

We will ﬁrst prove the two lemmas needed to obtain Corollary 2 from Theorem 1.

1

6

∆
2

Lemma 3. If p 6 1 − 1/e2, then x0 = 0.
Proof. Note that p 6 1 − 1/e2 is equivalent to log b 6 2, and therefore,
2(cid:0) log(1 − ∆) + ∆(cid:1) 6 0,

logb(1 − ∆) +

since log(1 − y) 6 −y for all y ∈ [0, 1). Hence, f (0) 6 0.
Lemma 4. If p > 1 − 1/e2, then 0 6 x0 6 1 − 2
Proof. Of course x0 > 0 is true by deﬁnition, and if ∆ 6 1 − 2
So suppose ∆ > 1 − 2
f(cid:16)1 − 2

log b − ∆(cid:17) 6 0, where
2 (cid:18)y +
Note that g′(y) = log y − y log b + log b and g′′(y) = 1

log b(cid:17) 6 0 is equivalent to g(cid:16)2 − 2

log b − 1(cid:19) (1 − y).
y − log b.

log b , then the claim follows if we can show f(cid:16)1 − 2

g(y) = y log y +

log b .

log b

2

log b , then x0 6 ∆ 6 1 − 2
log b .
log b(cid:17) 6 0. Note that

The function g has no maximum in (cid:16)1 − 2

log b , 1(cid:17): Suppose we have y ∈(cid:16)1 − 2

g′(y) = 0 and g′′(y) 6 0. It follows that 0 = log y + (1 − y) log b > log y + 1−y
contradiction since log z + 1−z
log b and y = 1, we have g(y) 6 0. Since 1− 2
log b , 1(cid:17), and therefore g(cid:16)2 − 2

In the boundary cases y = 1− 2
log b − ∆ ∈h1 − 2

z > 0 for all z ∈ (0, 1).

follows that 2 − 2

We now proceed with the technical lemmas which we will need later on.

log b − ∆(cid:17) 6 0 as required.

log b , 1(cid:17) with

y , but this is a

log b < ∆ 6 1, it

Lemma 5. Suppose p > 1 − 1/e2, and ﬁx ε′ > 0. Then there is a constant c1 = c1(ε′) > 0
such that if x0 > ε′, then

f (x0 − ε′) > c1.

Proof. Since x0 > 0, the deﬁnition of x0 implies that f (x) > 0 for all x ∈ [0, x0), so by
continuity f (x0) = 0 and furthermore f ′(x0) 6 0. As f ′′ > 1
log b on [0, ∆] for all n, f ′′ is
strongly convex on [0, ∆] with parameter at least

1
log b for all n, and the claim follows.

9

x0 = 0

∆

x0

∆

x0 = ∆

Figure 2: The three possible cases for the function f (x). In the ﬁrst case, f (0) 6 0, so x0 = 0. In
the second case, x0 ∈ (0, ∆). In the third case, ∆ is the smallest nonnegative solution of f (x) 6 0, so
x0 = ∆.

Lemma 6. There is a constant c2 = c2(ε) ∈ (0, 1) such that if x0 6 ∆ − ε, then

1 − ∆ 6

2c2
log b

.

Proof. As f (∆) = 0 and f (x0) 6 0, there cannot be an x ∈ (x0, ∆) such that f (x) > 0,
otherwise there would have to be a local maximum which is impossible since f ′′ > 0.

So f (∆ − ε) 6 0 and rearranging terms gives

1 − ∆ 6 −

(1 − ε) log(1 − ε)

ε

2

log b

,

·

so we can let c2 = − (1−ε) log(1−ε)
Lemma 7. Fix ε′ > 0. There is a constant c3 = c3(ε, ε′) > 0 such that if ε′ 6 y 6 ∆− x0 − ε,
then

∈ (0, 1) as ε ∈ (0, 1).

ε

f (∆ − y) 6 −c3.

Proof. Let

c3 = min(cid:18) ε2

4 log b

,

ε′2

4 log b(cid:19) > 0.

Note that x0 + ε 6 ∆ − y 6 ∆ − ε′. As f ′′ > 0, f has no internal maxima in (x0 + ε, ∆ − ε′),
so

We distinguish two cases:

f (∆ − y) 6 max(cid:0)f (x0 + ε), f (∆ − ε′)(cid:1) .

• Case 1: f (x0 + ε) > f (∆ − ε′)

Then as f ′ is increasing, f ′(x0 + ε) = logb(1 − ∆ + x0 + ε) + 1
z1, z2 > 0 with z1 + z2 < 1, we have log(z1 + z2) > log(z1) + z2, so

log b − 1−∆

2 6 0. For any

f ′(cid:16)x0 +

ε

2(cid:17) 6 f ′(x0 + ε) −

ε

2 log b

ε

2 log b

.

6 −

10

As f ′ is increasing, f ′(x) < 0 for all x ∈ [x0, x0 + ε], and since by deﬁnition f (x0) 6 0,
f (x0 + ε) 6Z x0+ε

f ′(x) dx 6Z x0+ε/2

f ′(x) dx 6

6 −c3.

4 log b

f ′(cid:16)x0 +

2(cid:17) 6 −

ε
2

ε2

x0

x0

ε

• Case 2: f (x0 + ε) < f (∆ − ε′)

Then as f ′ is increasing, f ′(∆ − ε′) = logb(1 − ε′) + 1
with z1 + z2 < 1, we have log(z1 + z2) > log(z1) + z2, so

log b − 1−∆

2 > 0. For any z1, z2 > 0

f ′(cid:18)∆ −

ε′

2(cid:19) > f ′(∆ − ε′) +

ε′

2 log b

>

ε′

2 log b

.

As f ′ is increasing, f ′(x) > 0 for all x > ∆ − ε, and since f (∆) = 0,

f (∆ − ε′) = −Z ∆

∆−ε′
ε′2

6 −

4 log b

f ′(x) dx 6 −Z ∆
6 −c3.

∆−ε′/2

f ′(x) dx 6 −

ε′
2

f ′(cid:18)∆ −

ε′

2(cid:19)

Lemma 8. Fix ε′ > 0. There is a constant c4 = c4(ε, ε′) > 0 such that if ε′ 6 ∆ − x0 − ε 6
y 6 1, then

(1 − y) logb(1 − y) +

(1 − y) −

2

6 −c4.

x0 + ε

∆
2

Proof. Let

h(x) = (1 − x) logb(1 − x) +

∆
2

(1 − x) −

x0 + ε

2

.

Note that h(∆−x0−ε) = f (x0 +ε). Furthermore, limx→1 h(x) = − x0+ε
2 . Since h′′(x) =
(1−x) log b > 0 for x ∈ (0, 1), h has no internal maxima in (0, 1), so since ∆ − x0 − ε 6 y 6 1,

2 6 − ε

1

h(y) 6 max(cid:16)h(∆ − x0 − ε),−

2(cid:17) 6 max(cid:16)f (x0 + ε),−

ε

ε

2(cid:17) .

Applying Lemma 7 to y′ = ∆ − x0 − ε, we can see that f (x0 + ε) 6 −c3(ε, ε′). Letting

c4 = min(cid:16)c3(ε, ε′),
it follows that h(y) 6 −c4 for all ∆ − x0 − ε 6 y 6 1.

ε

2(cid:17) > 0,

4 Proof of the lower bound

We may assume that p > 1− 1/e2, because otherwise x0 = 0 and the lower bound in Theorem
γp(n)−x0+εk for an
1 is simply the known lower bound (2). Recall that we deﬁned l = j
arbitrary ﬁxed ε ∈ (0, 1). We may assume x0 − ε > 0, because we can just use the known
bound (2) instead for all n where this is not the case. We will show that any l-colouring must
contain a certain proportion of large colour classes of size a = ⌈γ⌉, and then prove that the

n

11

expected number of unordered partial colourings with just these large colour classes tends to
0, which means that whp no such partial and therefore no complete l-colouring exists.

As x0 6 ∆ (see Section 3.2),

⌈γ⌉ > ⌈γ − x0 + ε⌉ > ⌈γ⌉ ,

so ⌈γ − x0 + ε⌉ = ⌈γ⌉ =: a. This is very close to the independence number α(G) : By (A)
from Section 3.1, whp α(G) = a or α(G) = a + 1. In particular, whp there are no independent
sets of size a + 2 in G.

Recall that α0 = γ + 1 + 2

log b . Standard calculations show that for any t = t(n) = O(1)
such that α0 − t is an integer, the expected number of independent sets of size α0 − t in G is
nt+o(1) (see also 3.c) in [22]). Therefore, as a = ⌈γ⌉ = γ + 1 − ∆ = α0 − 2

log b − ∆,

2) = n

2
log b +∆+o(1)

(cid:18)n
a(cid:19)q(a
(cid:18) n
a + 1(cid:19)q(a+1
log b < 1 and by (E), l = Θ(cid:16) n
log b + ∆ − 1 6 2

log b +∆−1+o(1).

2 ) = n

2

2

A valid l-colouring consists of l disjoint independent sets of average size n

Note that as
inequality that whp only o(l) independent sets of size a + 1 exist in G.

log n(cid:17), it follows from Markov’s
l > γ − x0 + ε.
Whp there are no independent sets of size a + 2 and only o(l) independent sets of size a + 1
in G, so a certain proportion of the l colour classes must be of size a in order to obtain an
average colour class size of at least γ − x0 + ε. More speciﬁcally, given an l-colouring, if we
let y ∈ [0, 1] be the proportion of colour classes of size a in the colouring, and let z = o(1) be
such that there are exactly zl independent sets of size a + 1 in G, then adding up the number
of vertices in each colour class yields

(14)

n 6 ayl + (a + 1)zl + (a − 1)(1 − y − z)l.

Therefore, since n/l > γ − x0 + ε,

As a = γ + 1 − ∆ and z = o(1), it follows that

γ − x0 + ε 6 y + a − 1 + 2z.

Hence, as l ∼
particular G must contain at least

n

2 logb n by (E), if a proper l-colouring exists and n is large enough, then in

y > ∆ − x0 + ε + o(1).

s :=(cid:24) (∆ − x0 + ε/2) n

2 logb n

(cid:25)

disjoint independent sets of size a. We shall call such an (unordered) collection of s disjoint
independent sets of size a a precolouring, and denote by ¯Z the number of precolourings in G.

Since for all m ∈ N, mm/em 6 m! 6 mm+O(1)/em,
2) =
E[ ¯Z] =

1

s!(cid:18)n
a(cid:19)(cid:18)n − a
a (cid:19)···(cid:18)n − (s − 1)a
ea−1sa!!s
= nO(1)  naq(a
n − as(cid:19)n−as
(cid:18) n

2)

a

(cid:19)qs(a

.

12

n!qs(a
2)

s!a!s(n − as)!

6

es−asnn+O(1)qs(a
2)
ssa!s(n − as)n−as

2

log b +o(1). Therefore, since n1−o(1) 6 s 6 n,

By (E), a ∼ 2 logb n, so it follows from (14) that na
more, ea−1 = n
n (cid:17)−n(1− as

E[ ¯Z] 6 nO(1)(cid:16)n∆+o(1)s−1(cid:17)s(cid:16)1 −
As as/n ∼ ∆ − x0 + ε/2, this gives

n )

as

a! q(a

E[ ¯Z] 6 eo(n)n−s(1−∆)(cid:16)1 − ∆ + x0 −

2 ) logb(1−∆+x0− ε

= b−((1−∆+x0− ε

2

log b +∆+o(1). Further-

n )

as

n (cid:17)−n(1− as

.

2) = n

a(cid:1)q(a

2) ∼ (cid:0)n
6 eo(n)n−s(1−∆)(cid:16)1 −
2(cid:17)−(1−∆+x0− ε

2 )n

ε

2 )+(1−∆)(∆−x0+ ε

2 )/2+o(1))n.

Note that with the exception of the o(1) term, the expression in the exponent is now simply
the left-hand side of condition (3) in Theorem 1 with x = x0 − ε/2. As ε/2 < ε 6 x0, we may
apply Lemma 5 with ε′ = ε/2 to conclude that

E[ ¯Z] 6 b−(c1+o(1))n = o(1).

By Markov’s inequality, whp no precolouring and consequently no proper l-colouring exists.

5 Bounding the second moment

We now proceed to the main part of the proof. Recall that to prove Theorem 1, it remains

to show that for an arbitrary ﬁxed ε ∈ (0, 1) and k = k(n) =l
log7 n(cid:19) .

k 6 exp(cid:18) n

k ]/µ2

E[Z 2

n

γ−x0−εm, if n is large enough,

By (9), in order to bound E[Z 2

Because of the known upper bound (2), we may assume that n

k > γ − 1 and that x0 + ε 6 1.
k ], we need to study the joint probability that two partitions
both induce proper colourings, a quantity which of course depends on how similar the two
partitions are. To quantify the amount of overlap between two partitions, we deﬁne the
overlap sequence r. For 2 6 i 6 a := ⌈γ⌉, given two ordered k-equipartitions π1, π2, denote
by ri the number of pairs of parts (the ﬁrst being a part in π1 and the second being a part in
π2) which intersect in exactly i vertices. Denote by

r = (r2, r3, . . . , ra)

the overlap sequence of the two ordered k-equipartitions π1, π2. If the intersection of two
parts contains at least two vertices, we call the intersection an overlap block. If there is only a
single vertex in the intersection of two parts, we call that vertex a singleton. Note that since

no overlap block is larger than a.

l n
km 6 ⌈γ⌉ = a,

Conversely, given an overlap sequence r, denote by Pr the number of ordered pairs of

ordered k-equipartitions with overlap sequence r. Let

v = v(r) =

iri

a

Xi=2

13

be the number of vertices involved in the overlap, and let

ρ = v/n 6 1

denote the proportion of those vertices in the graph. Furthermore, denote by

d = d(r) =

a

Xi=2

ri(cid:18)i
2(cid:19)

(15)

the number of common forbidden edges that two ordered k-equipartitions π1, π2 with overlap
sequence r share. Since the number of forbidden edges in one partition is exactly f , where f
was deﬁned in (12), both π1 and π2 induce proper colourings if and only if none of exactly
2f − d forbidden edges are present. Therefore, from (9) and (13),
Pr
P 2 bd.

Prq2f −d = µ2

E[Z 2

k] =Xr

kXr

Let

then our goal is to show that for n large enough,

Qr =

Pr
P 2 ,

E[Z 2
k]
µ2
k

=Xr

Qrbd 6 exp(cid:18) n

log7 n(cid:19) .

(16)

(17)

Since the summands in (17) vary considerably for diﬀerent types of overlap sequences r, we
split up our calculations into three parts in Sections 5.2 – 5.4. The behaviour of the summands
is rather diﬀerent in each case, and so diﬀerent methods and ideas will be required bound
them.

5.1 Outline

Typical case

In Section 5.2, we ﬁrst discuss the typical type of overlap between pairs of partitions.
If
a partition is chosen uniformly at random from all possible ordered k-equipartitions, then
the probability that two given vertices are in the same part is roughly 1
k . Consequently, if
two ordered k-equipartitions are sampled independently and uniformly at random, then the
expected number d of forbidden edges they have in common, i.e., pairs of vertices which are in
the same part in both partitions, is of order n2
k2 = O(log2 n). In particular, we do not expect
the number v of vertices involved in the overlap to be much larger than 2d = O(log2 n).

Furthermore, the expected number of triangles which the two partitions have in common,

i.e., triples of vertices that are in the same part in both partitions, is of order n3
o(1). Therefore, typically two partitions have no triangles or larger cliques in common, and
overlap in about O(log2 n) disjoint pairs of vertices.

k4 = O(cid:16) log4 n

n (cid:17) =

In fact, we will cover a much larger range of overlap sequences r in Section 5.2, namely
those r where at most a constant fraction of all vertices are involved in the overlap, i.e., where
v = v(r) 6 cn for a constant c which will be deﬁned in (18).

14

k(cid:7) or (cid:4) n
k(cid:5).

To bound the number of such pairs of partitions, we will count the number of corresponding
overlap matrices. The overlap matrix between two partitions π1 and π2 is deﬁned as the matrix
M = (Mxy), where Mxy denotes the number of vertices that are in part number x in π1 and
in part number y in π2. If π1 and π2 overlap according to a given overlap sequence r, then
the entries of M are exactly ri instances of the number i for all 2 6 i 6 (cid:6) n
k(cid:7), as well as
n − v instances of the number 1, with the remaining entries 0. As π1 and π2 are ordered
k-equipartitions, all rows and columns of M sum to (cid:6) n
Since there are typically few pairs and very few triangles or larger cliques in the overlap,
one crucial idea is that we can count the number of overlap matrices by ﬁrst placing the
entries 2, 3, . . . ,(cid:6) n
k(cid:7) in the matrix separately, and then treating the rest of the matrix as a
0 − 1 matrix with given row and column sums close to n
k . An important tool is Theorem 9,
due to McKay, which gives an estimate for the number of 0 − 1 matrices with prescribed row
and column sums.
After some fairly accurate calculations, we will see that the contribution from each r in
ri
T
this case is bounded by an expression of the form Qa
ri! , where the terms Ti still depend
i
on ρ(r) = v/n. We will then show that if ρ 6 c, the terms Ti are small enough so that the
overall contribution to (17) is bounded by exp(cid:16) n
k⌉ will
Let us remark that if we work with G(n, m) instead of G(n, p) and conduct a much more
detailed analysis, it is possible to show that if p < 1 − 1/e, the contribution from this range
of r is in fact asymptotically equal to e∆(1−∆) 6 e1/4, where ∆ = γ − ⌊γ⌋. The bulk of this
contribution comes from overlap sequences of the form r = (r2, 0, 0, . . . , 0) with r2 = O(log2 n).
However, only the coarser bound is needed for our result.

log8 n(cid:17). The bound for the term T⌈ n

require condition (3) from Theorem 1 to hold.

i=2

Many small overlap blocks

An intermediate degree of overlap is examined in Section 5.3, where at least a constant
fraction cn of vertices are involved in the overlap between the two partitions, but there are
either still many small overlap blocks, or many vertices not involved in the overlap at all.
More speciﬁcally, for an arbitrary constant c′ > 0, we will consider all r with ρ = v/n > c
and

X26i60.6γ

iri > c′n or ρ 6 1 − c′,

i.e., those r where there are either at least c′n vertices not in the overlap, or at least c′n
vertices in overlap blocks of size at most 0.6γ.

Let us assume for the moment that n

k is an integer in order to simplify notation. It will
be useful to deﬁne a simple parameter β which measures how close the overlap of two ordered
k-equipartitions is to consisting entirely of complete parts of size n
k (with the remaining n− v
vertices being singletons not involved in the overlap).
k vertices. Therefore, if we view the overlap blocks of
two k-equipartitions as cliques making up a graph, then each vertex has degree at most n
k − 1
within this overlap graph. Hence, given the number v of vertices involved in the overlap and
the number d of common forbidden edges, we know that 2d 6 ( n

Any overlap block contains at most n

k − 1)v, and we let

β =

2d
( n
k − 1)v

6 1.

15

If β is close to 1, then the overlap consists almost entirely of very large overlap blocks which
are almost entire parts.

In Section 5.3.2, we will ﬁrst consider the case where β is not too close to 1 (so there are
enough small overlap blocks). Thereafter, in Section 5.3.3, we will study the case where β is
close to 1 (so the overlap of the pairs of partitions consists almost exclusively of very large
overlap blocks), but there are still many vertices which are not involved in the overlap at all,
i.e., n − v is large enough.
In both cases, we will bound the number Pr of pairs of ordered k-equipartitions with
overlap sequence r according to the same strategy. We ﬁx the ﬁrst ordered k-partition π1
arbitrarily, and then we generate the second partition in the following way:

We ﬁrst subdivide the parts of π1 into overlap parameter blocks and singletons according
to r.
In the ﬁrst case, a fairly slack bound on the number of ways to do this will suﬃce
(Lemma 13). In the second case, we need to be more careful, and so we will show that this
can be done in subexponentially many ways (Lemma 15).

Thereafter, we sort the overlap blocks and singletons into k parts in order to form the new
partition π2. In the ﬁrst case the number of ways to do this is simply bounded by kR+n−v,
where R denotes the number of overlap blocks. Bounding R in terms of β in (29) and (30),
we will see that the overall contribution from the ﬁrst case to the sum (17) is o(1).

In the second case we again need a better bound for the number of ways to sort the overlap
blocks into the k parts in order to form π2. Note that in this case, almost the entire overlap
consists of very large overlap blocks. If we sort these large overlap blocks into the k parts
ﬁrst, then they occupy their assigned parts almost completely. As there are v = ρn vertices
in the overlap, this means that roughly ρk of the k parts are now ﬁlled or almost ﬁlled. The
remaining smaller overlap blocks and singletons, of which there are roughly (1 − ρ)n, do not
have k parts to pick from. Instead, their choice is limited to about (1 − ρ)k parts. Therefore,
in this case we get an additional factor of roughly (1 − ρ)(1−ρ)n.
As almost everything else turns out to be subexponential in the second case, this would
be the end of the story if n
k were indeed an integer: As long as c < ρ < 1 − c′, the overall
contribution to the sum (17) would decrease exponentially, and in particular it would be o(1).
k is not in general an integer is not purely

Perhaps surprisingly, however, the fact that n

a notational inconvenience. When we do distinguish between parts of size (cid:6) n
k(cid:5) (or
rather, for technical reasons, between parts of size a = ⌈γ⌉ and of size at most a − 1) then
there is an additional factor of size about bv1(1−∆)/2, where v1 denotes the number of vertices
in the overlap which are in parts of size a within the ﬁrst partition π1.

k(cid:7) and (cid:4) n

As v1 6 v = ρn, this means that overall, in equation (36), we arrive at an expression

which is roughly

(1 − ρ)(1−ρ)nbρ(1−∆)n/2 = bn((1−ρ) logb(1−ρ)+ρ(1−∆)/2).

Noting in (37) that the proportion of vertices in sets of size a in a k-equicolouring is roughly
∆ − x0 − ε, it is now not very hard, but slightly tedious, to compare this last exponent to
condition (3) in Theorem 1 in order to show that this expression is exponentially decreasing
in n. We will need to consider several cases, and we will also use the technical Lemmas 7 and
8 from Section 3.2.

This suﬃces to show that the overall contribution from the second case to the sum (17)

is o(1).

16

Figure 3:

In the high overlap case, the second partition is largely generated by permuting the

exceptional vertices and then permuting the parts of size (cid:6) n
(shown on the right). Exceptional vertices may also jump to smaller parts of size (cid:4) n
k(cid:5).

k(cid:7) (shown on the left) and of size (cid:4) n
k(cid:5)

High overlap

Finally, in Section 5.4 we will study those r where the corresponding pairs of partitions are
very similar to each other. In this range, most of the overlap consists of almost entire parts
which are merely permuted, with a few exceptional small overlap blocks and singletons.
We will show that the contribution to (17) from this range of overlap is O( k1!k2!

· 2k).
Since we are suﬃciently far above the ﬁrst moment threshold for the number of colourings,
this is o(1), and summing up the contributions from each of the three cases yields (17) and
thereby concludes the proof of Theorem 1.

µk

It is helpful to ﬁrst consider the extreme case of those pairs of partitions π1, π2 which are

simply permutations of each other: As there are k1 parts of size (cid:6) n

there are exactly P k1!k2! such (ordered) pairs of partitions, where P is deﬁned in (10) as the
total number of k-equipartitions. The number of overlapping edges is maximal, so d = f .
Therefore, from (13), the overall contribution to (17) is exactly

k(cid:7) and k2 parts of size (cid:4) n
k(cid:5),

P k1!k2!

P 2

bf =

k1!k2!
P qf =

k1!k2!

µk

.

More generally, we will consider pairs of partitions which are largely just permutations of
each other, but where there are also a few exceptional vertices which are essentially permuted
amongst themselves ﬁrst, as shown in Figure 3. As the part sizes may vary by 1, however,
the number of ‘available slots’ for exceptional vertices in each of the k parts may vary by 1.
We will bound these variations with an additional factor 2k.

From Section 5.3, we can assume that there are at most 2c′n exceptional vertices, where
we can make the constant c′ as small as we like. We will distinguish three diﬀerent types of
exceptional vertices. Starting with the ﬁrst partition π1, we will ﬁrst select the exceptional
vertices of each type, and bound the number of choices in Lemma 17. Then we generate π2
and bound the number of ways to do this in Lemma 18. Finally, we examine how much each
exceptional vertex subtracts from the maximum number f of shared forbidden edges between
π1 and π2 in Lemma 19. Summing over the number of exceptional vertices, we will see that
the overall contribution to (17) is of order O( k1!k2!

· 2k) if c′ is chosen small enough.

µk

17

5.2 Typical overlap range

We will ﬁrst consider all those overlap sequences r where the proportion ρ = v/n of the
vertices which are involved in the overlap is at most

c =

1 − c2

2

∈ (0, 1),

(18)

where c2 is the constant from Lemma 6. So let

R1 = {r | ρ = ρ(r) 6 c} .

The vast majority of all pairs of partitions overlap in a parameter sequence r ∈ R1, and this
is also where the bulk of the sum (17) comes from. We will show that the contribution of the
overlap sequences r ∈ R1 to (17) is at most exp(cid:16) n
log8 n(cid:17). To do this, we will ﬁnd a bound for
the contribution from each r of the form Qi
Any pair of ordered k-equipartitions π1 and π2 deﬁnes a k× k overlap matrix M = (Mxy),
where Mxy is the number of vertices that are in part x in π1 and in part y in π2. Since π1
and π2 are ordered k-equipartitions, the ﬁrst k1 rows and columns of M sum to (cid:6) n
k(cid:7) and the
remaining k2 rows and columns sum to (cid:4) n
k(cid:5). If π1 and π2 overlap according to the overlap
sequence r, this means that for every 2 6 i 6 a, exactly ri of the entries of the overlap matrix
are i, exactly n − v = n − v(r) entries are 1, and the remaining entries are 0.
titions is given by the multinomial coeﬃcient

Conversely, given such a matrix, the number of corresponding pairs of ordered k-equipar-

ri
T
ri! , and then bound the terms Ti.
i

n!
i=2 i!ri

.

Qa

This is because, given the matrix and n vertices, we must pick ri sets of i vertices that
correspond to the i-entries in the matrix for each i, as well as n − v single vertices for each of
the 1-entries, and then this exactly deﬁnes the two ordered k-equipartitions. Given r, denote
by Mr the number of corresponding matrices, then

Pr =

n!
i=2 i!ri · Mr.
Qa

To bound Qr = Pr/P 2, we will count the number Mr of corresponding overlap matrices in
the following way. Take an empty k × k-matrix, and write the number 2 in r2 empty slots,
write the number 3 in r3 empty slots, and so on. There are at most

(19)

(20)

r2(cid:19)(cid:18)k2
(cid:18)k2

r3(cid:19) . . .(cid:18)k2

ra(cid:19) 6

k2Pa

i=2 ri
i=2 ri!

Qa

ways to do this. The rest of the matrix has entries 0 and 1, and the number of ways to ﬁll in
these entries is bounded by the total number of k × k 0-1 matrices where the row and column
sums are given by(cid:6) n
k(cid:5) minus the values of the entries that are already written in these
rows and columns. Note that we are of course overcounting Mr, since not all placements of
the numbers 2, 3, . . . , are valid, and not all 0-1 matrices are possible afterwards, but this will
be insigniﬁcant.

k(cid:7) or(cid:4) n

To estimate the number of 0-1 matrices with prescribed row and column sums, we use the

following result of McKay ([23], see also [15]).

18

Theorem 9. Let N (s, t) be the number of m× n 0-1 matrices with row sums s = (s1, . . . , sm)
and column sums t = (t1, . . . , tn). Let S = Pm
x=1 sx, s = maxx sx, t = maxy ty, S2 =
Pm
x=1 sx(sx − 1) and T2 =Pn
If S → ∞ and 1 6 max{s, t}2 < cS for some constant c < 1
Qm
x=1 sx! Qn

2S2 + O(cid:18) max{s, t}4

y=1 ty(ty − 1).

exp(cid:18)−

(cid:19)(cid:19) .

N (s, t) =

6 , then

y=1 ty!

S2T2

S!

S

(21)

N (s, t) =

.

i=2 iri factors.

y=1 ty(ty − 1)

y=1 ty!

.

y=1 ty!

exp −Pk

i=2 ri 6 k1, the product of these factors is

k(cid:7), (cid:6) n
k(cid:7)!k1(cid:4) n

x=1 sx(sx − 1)Pk
2(n − v)2

the sequence, the number 3 from r3 members of the sequence, and so on.

placed so that the rows sum to s = (s1, . . . , sk), and the columns sum to t = (t1, . . . , tk),

Having written the numbers 2, . . . ,(cid:6) n

k(cid:7)2 = O(log2 n) = o(S), so we can apply Theorem 9:

k(cid:7) in the matrix, the remaining 0-1 entries must be
where sx, ty 6(cid:6) n
k(cid:7) for all x, y. The exact values for sx and ty depend on the placement of the
numbers 2, . . . ,(cid:6) n
k(cid:7). In the terminology of Theorem 9, we have S = n − v > (1 − c)n → ∞
and 1 6 max{s, t}2 6(cid:6) n
n (cid:19)!
+ O(cid:18) log4 n
(n − v)!
Qk
x=1 sx! Qk
(n − v)!
Qk
x=1 sx! Qk
k(cid:7), . . . , (cid:4) n
Now the sequence s1, . . . , sk can be obtained from the sequence (cid:6) n
k(cid:5) (k1
times (cid:6) n
k(cid:7) and k2 times (cid:4) n
k(cid:5)) by successively subtracting the number 2 from r2 members of
The product Qk
x=1 sx! can then be obtained from the product (cid:6) n
k(cid:5)!k2 by removing
If Pa
the corresponding v = Pa
maximal if sx = (cid:6) n
k(cid:7) − i for exactly ri values x for all i > 2. For all remaining values x,
sx =(cid:6) n
k(cid:7) or sx =(cid:4) n
k(cid:5). Therefore, in this case
km!k1j n
Note that the above remains valid if Pa
(cid:6) n
k(cid:7) < a = ⌈γ⌉ (so by our assumptions (cid:6) n
The corresponding inequality of course also holds for Qk
(cid:6) n
k(cid:7)!2ri
(cid:0)(cid:6) n
k(cid:7) − i(cid:1)!2ri
k2ri(cid:6) n
k(cid:7)!2ri
i!riri!(cid:0)(cid:6) n
k(cid:7) − i(cid:1)!2ri
n(cid:17)n−v

kk!k2 ·
k(cid:7) = a − 1), there are no parts of size at least a in

(n − v)!
(cid:6) n
k(cid:7)!2k1(cid:4) n
k(cid:5)!2k2
(n − v)!n!
(cid:6) n
k(cid:7)!2k1(cid:4) n
k(cid:5)!2k2
(n − v)n−vev

Note that by Stirling’s formula n! ∼ √2πnnn/en, and using 1 + x 6 ex,

the partitions, so ra = 0 and the above is still well-deﬁned as there are no terms for i = a.

Yi=2(cid:0)(cid:6) n
k(cid:7) − i(cid:1)!ri
(cid:6) n
k(cid:7)!ri

i=2 ri > k1 — it is just not tight in this case.

= n−v(cid:16)1 −

ev 6 n−vev2/n = n−veρv.

k

Yx=2

sx! >l n

Using (19) and (20), this gives

(n − v)!

.

n!

nn

y=2 ty!. Therefore,

.

.

.

a

a

Yi=2

If

(22)

N (s, t) .

Pr .

a

Yi=2

19

v

a

Qr =

Pr
P 2 .

i=2 iri, this gives

Together with (16), (22) and (10), and as v =Pa

Yi=2  1

k(cid:7) − i(cid:1)!2!ri! .
ri!  eρik2(cid:6) n
k(cid:7)!2
nii!(cid:0)(cid:6) n
Recalling that d =Pa
i=2(cid:0)i
2(cid:1)ri, and that by (B) from Section 3.1, (cid:6) n
ri! 6
ri!  eρib(i
ri!  eρib(i
Yi=2  1
Yi=2  1
nii!(cid:0)(cid:6) n

2)k2(cid:6) n
k(cid:7) − i(cid:1)!2!
k(cid:7)!2

Qrbd .

a

a

6 a!

(a−i)! for all i. Therefore, letting

as

⌈ n
k⌉!
(⌈ n
k⌉−i)!

k(cid:7) 6 a,
nii! (a − i)!2!ri!

2)k2a!2

we have

Ti :=

eρib(i
2)k2a!2
nii! (a − i)!2 ,

Qrbd .

T ri
i
ri!

.

a

Yi=2

By (B), either (cid:6) n

ra = 0. Therefore,

k(cid:7) = a or (cid:6) n

k(cid:7) = a − 1. In the latter case, there are no parts of size a, so

Qrbd .

⌈ n
k⌉
Yi=2

T ri
i
ri!

.

(23)

Note that the terms Ti still depend on r, but only on ρ(r). The next lemma ensures that the
terms Ti are small enough as long as ρ 6 c. Let

c5 = min(cid:26) 1

10

,

c

2 log b

,

2 log b(cid:27) ∈ (0, 1),
1 − c

where c is deﬁned in (18).

Lemma 10. If r ∈ R1 and n is large enough, then for all 3 6 i 6(cid:6) n
and for i ∈(cid:8)2,(cid:6) n
k(cid:7)(cid:9),

Ti 6 n1−c5.

Ti 6 n−c5,

k(cid:7) − 1,

Proof. As usual, we assume throughout that n is large enough for our various bounds to hold.
First, note that

.

(24)

=

Ti+1
Ti

2 ) (a − i)!2

eρb(i+1
b(i
2)n(i + 1) (a − i − 1)!2
Now consider i = 2: Since a ∼ n
k = O(log n) by (D) in Section 3.1,
e2ρb(2
n22! (a − 2)!2 6

2)k2a!2

e2bk2a4

T2 =

eρbi(a − i)2
n(i + 1)

2n2 = O(cid:0)log2 n(cid:1) 6 n1−c5.

=

20

By (24), for i 6 5,

so in particular for all 3 6 i 6 6,

Ti+1 = O(cid:18) log2 n

n (cid:19) · Ti 6 n−1+o(1)Ti,

Ti 6 T3 6 n−1+o(1)O(log2 n) 6 n−c5.

For 7 6 i 6 1.2 logb n, note that as a 6 2 logb n,

Ti 6

eib

i2
2 n2a2i
ni

= n2  eb

i

2 a2

n !i

6 n2(cid:18)4eb0.6 logb n log2

n

b n

6 n2−0.3i 6 n−0.1 6 n−c5.

(cid:19)i

Next, we take a look at the special case i = a. Since a = γ + 1 − ∆, by (F),

b(a

2) = b(γ−∆)(γ+1−∆)/2 = b

γ

2 (γ+1−2∆)no(1) = ((1 + o(1))k)γ+1−2∆no(1) = ka−∆no(1),

so by Stirling’s formula,

Ta =

eρab(a
2)k2a!
na

∼

eρaka−∆+2no(1)√2πaaa

naea

n (cid:19)a
6(cid:18) ka

n2−∆e−(1−ρ)ano(1).

Since by (D), a ∼ n

k ∼ 2 logb n and as r ∈ R1, this gives

Ta 6 n2−∆−(1−ρ) 2

log b +o(1) 6 n2−∆−(1−c) 2

log b +o(1).

For i ∈ {a − 1, a − 2}, by (24) and (F) and since a = ⌈γ⌉,
= n1+o(1).

no(1)bi

6

Ti+1
Ti

n

Therefore,

Ta−1 = Tan−1+o(1) 6 n1−∆−(1−c) 2

log b +o(1).

(25)

and γ is not an integer.

To bound T⌈ n
• Case 1: (cid:6) n

Since n

k⌉, we need to distinguish between two cases. By (B),(cid:6) n
k(cid:7) = a.

k 6 γ − x0 − ε, a = ⌈γ⌉ and ∆ = γ − ⌊γ⌋, we have x0 + ε 6 ∆. By Lemma 6,

k(cid:7) = a or(cid:6) n

k(cid:7) = a−1,

1 − ∆ <

2c2
log b

.

By the deﬁnition (18) of c, c2 = 1 − 2c and since c5 6 c
log b +o(1) 6 n1− 2c

k⌉ = Ta 6 n2−∆−(1−c) 2
T⌈ n

2 log b ,

log b +o(1) 6 n1−2c5.

• Case 2: (cid:6) n

k(cid:7) = a − 1.

By the deﬁnition of c5 6 1−c

2 log b ,

k⌉ = Ta−1 6 n1−(1−c) 2
T⌈ n

log b +o(1) 6 n1−2c5.

21

k⌉ 6 n1−2c5 6 n1−c5. By (25), this gives
So in both cases we have T⌈ n
k⌋ 6 n−1+o(1)T⌈ n
T⌊ n
Finally, for i > 1.2 logb n, by (24),

k⌉ 6 n−c5.

Ti+1
Ti

=

eρbi(a − i)2
n(i + 1)

> n0.2+o(1) > 1,

so for all 1.2 logb n 6 i 6(cid:4) n
k(cid:5),

Ti 6 T⌊ n

k⌋ 6 n−c5.

Let

a

denote the total number of overlap blocks. The following lemma gives a bound for the quantity
appearing in (23) in terms of R instead of the individual ri’s.

R =

ri

Xi=2

Lemma 11. If n is large enough, then for all r ∈ R1,
Qrbd . n−c5R/2 exp(cid:18) n

log9 n(cid:19) ,

where c5 > 0 is the constant from Lemma 10.

(26)

Proof. For 3 6 i 6(cid:4) n

k(cid:5), the previous lemma gives

1
ri!

T ri
i 6 n−c5ri 6 n−c5ri/2.

Now suppose i ∈(cid:8)2,(cid:6) n

k(cid:7)(cid:9). If ri 6 n

log11 n

, then

1
ri!

T ri

i 6 n(1−c5)ri 6 n−c5ri/2 exp(cid:18) n

2 log9 n(cid:19) .

Otherwise, if ri > n

log11 n

, then since ri! > rri

i /eri,

1
ri!

T ri

ri (cid:19)ri
i 6(cid:18)en1−c5

Together with (23), this gives the result.

6(cid:0)en−c5 log11 n(cid:1)ri 6 n−c5ri/2.

Now we are ﬁnally ready to sum (26) over all r ∈ R1. For this, note that if n is large
enough, then given R, there are at most (2e logb n)R ways to select r2, . . . , ra such that
i=2 ri = R. This is because there are

Pa

(cid:18)R + a − 2

R

(cid:19) 6(cid:18) e (R + a − 2)

R

(cid:19)R

22

6 (e (1 + a − 2))R 6 (2e logb n)R

Using this and Lemma 11, if n is large enough, we can now simply take the sum over R:

∞

Qrbd .

Xr∈R1

ways to write R as an ordered sum with a − 1 nonnegative summands.
log9 n(cid:19)(cid:19)
log9 n(cid:19) ∞
6 2 exp(cid:18) n
log8 n(cid:17) for n large enough as required.

XR=0(cid:18)(2e logb n)R n−c5R/2 exp(cid:18) n
nc5/2 (cid:19)R
XR=0(cid:18) 2e logb n
= exp(cid:18) n
Therefore, Pr∈R1 Qrbd 6 exp(cid:16) n

5.3 Pairs of partitions with many small overlap blocks

log9 n(cid:19) .

In this section, we will bound the contribution to the sum (17) from those overlap sequences
r with ρ = ρ(n) := v/n > c, but where there are either still many singletons which are not
involved in the overlap (so n − v is large) or many vertices in ‘small’ overlap blocks of size at
most 0.6γ. More speciﬁcally, ﬁx a constant 0 < c′ < 1 and consider only those r with ρ > c
such that there are at least c′n singletons or at least c′n vertices in overlap blocks of size at
most 0.6γ:

r | ρ > c ∧

Rc′

2 =


iri > c′n ∨ ρ 6 1 − c′


.




We will prove that for any ﬁxed c′ ∈ (0, 1), the contribution to the sum (17) from these
overlap sequences is negligible:

 X26i60.6γ
Xr∈Rc′

2

Qrbd = o(1).

To do this, we will generate all pairs of partitions in this range by taking the ﬁrst partition,
grouping the vertices into subsets of its parts which will form the singletons and overlap
blocks, and rearranging them into k sets to get the new partition. If we do this according to
some r ∈ Rc′
2 , then we can bound the number of ways to generate another partition and show
that the number of overlapping edges d between the two partitions is small enough.

5.3.1 Preliminaries

We ﬁrst need some notation and preliminary results. Since some of our bounds need to be
extremely accurate, we distinguish between parts of size a and parts of size at most a − 1.
Since by (B), (cid:6) n
k(cid:7) ∈ {a, a − 1}, there may of course not be any parts of size a at all. Fix an
arbitrary ordered k-equipartition π1, and let
2o .
2 =nordered k-equipartitions π2 such that r(π1, π2) ∈ Rc′
P c′
2 , let

Given π2 ∈ P c′

V1 = set of vertices in the overlap of π1 and π2 that are in parts of size a in π1
V2 = set of vertices in the overlap of π1 and π2 that are in parts of size at most a − 1

in π1

D1 = set of overlapping forbidden edges between vertices in V1
D2 = set of overlapping forbidden edges between vertices in V2.

23

For i ∈ {1, 2}, let vi = |Vi| and di = |Di|, so v1 + v2 = v and d1 + d2 = d.
Given π1 and π2, we deﬁne the overlap graph of π1 and π2 as the union of all the vertices
in overlap blocks together with all the joint forbidden edges. By deﬁnition, the overlap graph

is a disjoint union of cliques, each containing between 2 and (cid:6) n
vertex set is exactly V1 ∪ V2 and the edge set exactly D1 ∪ D2. Denote by g = (gj)v1
degree sequence in the overlap graph of the vertices in V1. Then gj 6 a − 1 for all j, so

k(cid:7) vertices. Note that the

j=1 the

Similarly,

Let

2d1 =

v1

Xj=1

gj 6 v1 (a − 1) .

2d2 6 v2 (a − 2) .

β1 =

β2 =

2d1

v1 (a − 1)

2d2

v2 (a − 2)

6 1

6 1.

For x ∈ (0, 1), denote by wx,1 the proportion of vertices in V1 which have degree at most
x (a − 1) within the overlap graph, i.e.,

wx,1 =

# j with gj 6 x (a − 1)

v1

.

Then, as gj 6 a − 1 for all j, for any x ∈ (0, 1),

β1v1 (a − 1) = 2d1 =

v1

Xj=1

so

gj 6 wx,1v1x (a − 1) + (1 − wx,1)v1 (a − 1) ,

wx,1 6

.

(27)

Similarly, deﬁne wx,2 as the proportion of vertices in V2 that have degree in the overlap graph
of at most x (a − 2). Analogously, we have

wx,2 6

1 − β2
1 − x

.

Next, we need a bound for the total number of overlap blocks. As in the previous section,

let

a

R =

ri

(28)

1 − β1
1 − x

Xi=2

denote the number of overlap blocks. Let R1 and R2 denote the number of overlap blocks in
parts of size a and of size at most a − 1 in π1, respectively, so R = R1 + R2.

Note that

R1 =

1

gj + 1

,

v1

Xj=1

24

as every overlap block of s vertices contributes exactly s instances of the summand 1
s . For
any 0 < x < y < 1, there are wx,1v1 values i such that 1 6 gi 6 x (a − 1), at most wy,1v1
values i such that x (a − 1) < gi 6 y (a − 1), and for the remaining values i, gi > y (a − 1).
Therefore,

R1 6

wx,1v1

2

+

Using (27), it follows that

wy,1v1

x (a − 1) + 1

+

v1

y (a − 1) + 1

6

wx,1v1

2

+

wy,1v1

xγ

+

v1
yγ

.

R1 6

Similarly, we can see that

(1 − β1)v1
2(1 − x)

+

(1 − β1)v1
x(1 − y)γ − 1

+

v1

yγ − 1

R2 6

(1 − β2)v2
2(1 − x)

+

(1 − β2)v2
x(1 − y)γ − 1

+

v2

yγ − 1

.

.

(29)

(30)

We will now give some weaker conditions for π2 which are more convenient to work with,

and show that any π2 ∈ P c′
Lemma 12. If π2 ∈ P c′
conditions applies:

2 meets these conditions.
2 and n is large enough, then at least one of the following three

I) v1 >

II) v2 >

n

n

(log log n)2 and β1 6 1 − (log log n)4
(log log n)2 and β2 6 1 − (log log n)4

log n

log n

.

.

III) Neither I nor II holds, and c < ρ 6 1 − c′.
Proof. By the deﬁnition of Rc′
2 , it suﬃces to show that if P26i60.6γ iri > c′n, then I) or II)
holds. So suppose that P26i60.6γ iri > c′n. Of those vertices that are in overlap blocks of
size at most 0.6γ, either at least c′n/2 are in parts of size a or at least c′n/2 are in parts of
size a − 1 in π1.
In particular, v1 > c′n/2 >
(log log n)2 . Furthermore, if we denote by ˆri the number of overlap blocks of size i in parts of
size a in π1, then

So say that at least c′n/2 of them are in parts of size a.
n

d1 =

a

Xi=2(cid:18)i

2(cid:19)ˆri 6 0.3γ X26i60.6γ

iˆri +

a − 1
2 X0.6γ<i6a

iˆri.

2 and P26i60.6γ iˆri > c′n/2 and γ 6 ⌈γ⌉ = a, this is at most

0.3γc′n

c′n

+

2 (cid:18)v1 −
a − 1

2 (cid:19) 6

a − 1

2

v1 − 0.05ac′n.

Since 0.3γ 6 a−1

Therefore,

2

As v1 6 n, this is at most

β1 =

2d1

v1 (a − 1)

6 1 − (0.1 + o(1))

c′n
v1

.

1 − 0.05c′ < 1 −

(log log n)4

log n

,

so I) holds if n is large enough.

The second case is analogous and implies II).

25

Still ﬁxing the arbitrary ordered k-equipartition π1, let

(log log n)4

log n (cid:27)
log n (cid:27)

(log log n)4

P I =(cid:26)ordered k-equipartitions π2 such that v1 >
P II =(cid:26)ordered k-equipartitions π2 such that v2 >
P III =(cid:8)ordered k-equipartitions π2 such that c < ρ 6 1 − c′(cid:9) \ P I \ P II,

n

n

(log log n)2 and β1 6 1 −

(log log n)2 and β2 6 1 −

where vi, βi and ρ refer to the overlap of π1 and π2. Then by Lemma 12 for n large enough,

P c′
2 ⊂ P I ∪ P II ∪ P III.
For an overlap sequence r, denote by P ′
r the number of ordered k-equipartitions with overlap
r with π1. Then by the deﬁnition (16) of Qr,

Using (11) in the last step, if n is large enough,

Qr =

Pr
P 2 =

r

P ′
P

.

Xr∈Rc′

2

Qrbd = Xr∈Rc′

2

r

P ′
P

bd = Xπ2∈P c′

2

P −1bd(π1,π2) 6 Xπ2∈P I∪P II∪P III

P −1bd(π1,π2)

= Xπ2∈P I∪P II∪P III

k−nbd(π1,π2) exp(o(n)),

(31)

(32)

where d(π1, π2) := d(r) if r is the overlap sequence of π1 and π2.

We will now generate and count all π2 ∈ P I ∪ P II ∪ P III. Starting with π1, we ﬁrst
subdivide the parts into overlap blocks and singletons. Then we arrange those overlap blocks
and singletons into k new parts to generate π2, and sum the resulting bd(π1,π2).

5.3.2 Contribution from Cases I and II

We start by generating the partitions in P I ∪ P II. The strategy is as follows. We group the
vertices into subsets of the parts of π1 which form the overlap blocks and singletons for the
overlap with π2, and give a bound for the number of ways this can be done in Lemma 13.
Then we sort the overlap blocks and singletons into the k parts of π2. If there are R overlap
blocks and n− v singletons, then there are at most kn−v+R choices for this. Considering (32),
the term kn cancels out with k−n, leaving just k−v+Rbd multiplied by the bound from Lemma
13 as an upper bound for (32). If Cases I or II apply and we also use the bounds (29) and
(30) for R, then di will be small enough in comparison to vi for at least one i ∈ {1, 2} so that
k−v+R is much smaller than bd, allowing us to bound the total contribution from Cases I and
II to (32) and thereby to (17) by o(1).

Lemma 13. Denote by S the number of ways the n vertices can be grouped into subsets (of
any size and number) of the parts of π1. Then

S 6 exp (O (n log log n)) .

26

Proof. If we sort the n vertices into a containers, this deﬁnes a subdivision of π1 by letting
all vertices be in the same set that are in the same part of π1 and in the same container.
Conversely, any possible subdivision of π1 can be obtained in this way, since every part can
only be partitioned into at most a non-empty sets. Therefore, as a = O(log n),

S 6 an = exp (O (n log log n)) .

We are now ready to show that the contribution to (32) from all ordered k-equipartitions

in P I ∪ P II to (32) is o(1).

Lemma 14.

k−nbd(π1,π2) exp(o(n)) = o(1).

Xπ2∈P I∪P II

Proof. Fix v1, v2, d1 and d2 so that I) or II) holds. Let

P(v1, v2, d1, d2) =(cid:8)π2 ∈ P I ∪ P II | vi(π1, π2) = vi, di(π1, π2) = di, i = 1, 2(cid:9) .

Arrange the n vertices into singletons and overlap blocks that are subsets of the parts of π1
in accordance with v1, v2, d1 and d2. Now that we know the R overlap blocks and n − v
singletons, the number of ordered k-equipartitions π2 with these overlap blocks with π1 is at
most kn−v+R, since we need to sort n − v singletons and R overlap blocks into k parts.
log log n , then with (29), (30) and Lemma 13,

Therefore, if we let x = 1

4 and y = 1 − 1
−n+n−v+P2

k−nbd(π1,π2) 6 Sk

Xπ2∈P(r1,r2,d1,d2)

i=1(cid:16) 2(1−βi)vi

3

+ 4(1−βi)vi

(1−y)γ−4 + vi

yγ−1(cid:17)bd1+d2 exp (o(n))

6 kP2

i=1(cid:16)−vi+ 2(1−βi)vi

3

+ 4(1−βi)vi

(1−y)γ−4 + vi

yγ−1(cid:17)bd1+d2 exp (O(n log log n)) .

(33)

Note that as by (F) from Section 3.1, b
γ + 1,

γ

bd1+d2 = bβ1v1· a−1
vi

2 +β2v2· a−2

2 ∼ k, and since βivi 6 n for i ∈ {1, 2} and a = ⌈γ⌉ 6
2 6 b(β1v1+β2v2)· γ

2 6 kβ1v1+β2v2 exp(o(n)).

By (G) and since vi 6 n, k

yγ−1 6 exp(O(n)) for i ∈ {1, 2}, and therefore (33) becomes
(1−y)γ−4(cid:17)(cid:17) exp (O(n log log n)) .

i=1(cid:16)vi(1−βi)(cid:16) 1

− P2

3 −

4

k−nbd(π1,π2) 6 k

Xπ2∈P(r1,r2,d1,d2)
Recall that y = 1 −
enough. Since I) or II) holds, there is an i ∈ {1, 2} such that (1 − βi)vi > n(log log n)2

log log n , so (1 − y)γ → ∞, and we have 1

(1−y)γ−4 > 1

3 −

log n

1

4

4 for n large
, so by

(G),

k−nbd(π1,π2) 6 k− n(log log n)2

4 log n

exp (O(n log log n)) .

Xπ2∈P(r1,r2,d1,d2)

27

As f = O(n log n) by (H), and since vi 6 n and di 6 f for i ∈ {1, 2}, there are only at most
O(n4 log2 n) choices for the values of vi 6 n and di for i ∈ {1, 2}. Hence,

k−nbd(π1,π2) exp(o(n)) 6 k− n(log log n)2

4 log n

exp (O(n log log n))

Xπ2∈P I∪P II

= exp(cid:0)−Θ(cid:0)n(log log n)2(cid:1)(cid:1) = o(1).

5.3.3 Contribution from Case III

We have to be a bit more careful in the case where neither I) nor II) holds. We will proceed
similarly as in the proof of Lemma 14: We subdivide π1 into subsets and then sort the
singletons and overlap blocks into the k parts to form the new partition π2. Since for both
i ∈ {1, 2}, βi is either close to 1 or vi is negligibly small, most of the overlap blocks will be
almost entire parts of π1. If we place those large overlap blocks ﬁrst, they occupy a constant
fraction of about ρk of the k parts almost entirely, so the remaining roughly (1− ρ)n vertices
and smaller overlap blocks have fewer choices left, namely only about (1 − ρ)k choices each.
This will give an additional factor of about (1− ρ)(1−ρ)n. Almost everything else will turn out
to be subexponential, except for a term which is about b(1−∆)v/2. As v = ρn, this will result
in a total bound which is roughly of the form b−((1−ρ) logb(1−ρ)−(1−∆)ρ/2)n. Comparing the
exponent of this expression with condition (3) from Theorem 1 (using the technical lemmas
we proved in Section 3.2), we will show that the sum is o(1) for c < ρ < 1 − c′.
Instead of Lemma 13, which gave a fairly slack bound on the number of ways the vertices
may be arranged into subsets of the parts of π1, we now need a more accurate bound. The
following lemma ensures that if Condition III) applies, the number of ways to subdivide π1
is subexponential.

Lemma 15. Fix integers v1, v2, d1, d2 so that I) and II) do not hold as above. Denote by
S(v1, v2, d1, d2) the number of ways the vertices can be arranged into subsets of the parts of
π1 which form overlap blocks and singletons according to vi and di, i ∈ {1, 2}. Then there is
a constant S′ = S′(n) which does not depend on vi or di, i = 1, 2, such that

S(v1, v2, d1, d2) 6 S′ 6 exp (o(n)) .

Proof. We ﬁrst split up the parts of size a. Since I) does not hold, either v1 <
β1 > 1 − (log log n)4

log n

.

n

In the ﬁrst case, select the v1 <

(log log n)2 = o(n) vertices which form the overlap blocks

n

(log log n)2 or

in parts of size a. Using (J) from Section 3.1, there are at most

v1(cid:19) 6(cid:18)
(cid:18) n

n
n

(log log n)2k(cid:19) 6 exp(o(n))

j

ways to do this. All the other vertices in parts of size a must be singletons. To ﬁnd out how
the v1 vertices are arranged into overlap blocks, we can proceed as in the proof of Lemma 13:
Sort the v1 vertices into a containers, and let those vertices be in the same overlap block that
are in the same container and in the same part of π1. There are

av1 6 a

n

(log log n)2 = exp(cid:18)O(cid:18)

n

log log n(cid:19)(cid:19) 6 exp(o(n))

28

possibilities for this, so altogether there are exp(o(n)) ways to split up the parts of size a in
the case v1 <

n

(log log n)2 .

In the second case, we have β1 > 1 − (log log n)4

overlaps with π1 according to vi and di, then

log n

. Let x = 1 − (log log n)2

(log n)1/2 , then by (27), if π2

wx,1 6

(log log n)4

log n

(log log n)2
(log n)1/2

=

(log log n)2
(log n)1/2

=: ˆwx → 0.

This means that almost all of the v1 vertices in the overlap must be arranged into large overlap
blocks of size greater than x (a − 1) + 1. As x → 1, we can assume x > 1/2. Therefore, any
part of π1 contains at most one such large overlap block, and we can group the vertices in
parts of size a into overlap blocks and singletons in the following way.

• First we select the parts which contain large overlap blocks. There are at most

2k = exp (O (n/ log n)) = exp(o(n))

choices.

• Next, given these k′ 6 k parts, we pick the vertices within the parts that are not in the

large overlap blocks. Since x → 1, there are at most

such vertices. Therefore, there are at most

k′(a − x(a − 1) − 1) 6 (1 − x)ak′ = o(cid:0)ak′(cid:1) = o(n)
l (cid:19) 6(cid:0)(1 − x)ak′ + 1(cid:1) ·(cid:18)

⌊(1 − x)ak′⌋(cid:19) 6 n ·(cid:18)

ak′

n

Xl6(1−x)ak′(cid:18)ak′

(1 − x)n(cid:19) 6 exp(o(n))

possibilities for this.

• Now we know all the large overlap blocks in V1. From the remaining vertices, we choose
those vertices that are not singletons, i.e., which are in overlap blocks of size at least
2, but not in big overlap blocks. There cannot be more than ˆwxv1 6 ˆwxn = o(n) such
vertices. Therefore, there are at most

Xj6 ˆwxn(cid:18)n

j(cid:19) 6 ( ˆwxn + 1)(cid:18) n

⌊wxn⌋(cid:19) 6 exp(o(n))

choices.

• We have determined all of the large overlap blocks and which of the remaining vertices
are singletons and which are in overlap blocks. It only remains to group the vertices that
are in overlap blocks into subsets of the parts of π1. As in the proof of Lemma 13, each
such partition into subsets can be obtained by sorting the vertices into a containers,
and since there are at most ˆwxv1 6 ˆwxn vertices left, this can be done in at most

a ˆwxn = exp [O (n ˆwx log log n)] = exp(o(n))

ways.

29

Multiplying everything, and noting that none of the bounds depend on the speciﬁc choice of
vi and di, gives the bound exp(o(n)) for the number of ways we can subdivide the parts of
size a in the second case, and hence in both cases.

The bound exp(o(n)) for subdividing the parts of size at most a − 1 can be proved anal-

ogously. Multiplying those two bounds gives S′ = S′(n) such that

S(v1, v2, d1, d2) 6 S′ 6 exp(o(n)).

Now we are ready to show that the contribution to (32) from Case III is o(1).

Lemma 16.

k−nbd(π1,π2) exp(o(n)) = o(1).

Xπ2∈P III

Proof. Suppose we have ﬁxed v1, v2, d1 and d2 in such a way that I) and II) do not hold but
III) does. Let

P ′(v1, v2, d1, d2) =(cid:8)π2 ∈ P III | vi(π1, π2) = vi, di(π1, π2) = di, i = 1, 2(cid:9) .

log n → 1. Recall that ρ = v/n = (v1 + v2)/n.

Let u = 1 − (log log n)5
Claim. For any π2 ∈ P ′(v1, v2, d1, d2), there are (1 + o(1))ρk ‘large’ overlap blocks of size at
least u(a − 2) in the overlap of π1 and π2.
Proof. Of course there are asymptotically at most
to show that there are asymptotically at least ρk of them.

u(a−2) ∼ ρk such blocks, so we only need
(log log n)2 for i ∈ {1, 2}, then as I) and II) do not hold, βi > 1− (log log n)4

log n

n

v

,

Note that if vi >

and therefore,

1 − βi
1 − u

6

1

log log n → 0.

(34)

If π2 ∈ P ′(v1, v2, d1, d2), then by (27), there are at least

(1 − wu,1)v1 + (1 − wu,2)v2 >

2

Xi=1(cid:18)1 −

1 − u(cid:19) vi
1 − βi

vertices in large overlap blocks of size at least u(a − 2). Since no overlap block contains more
than a vertices, there are at least

2

Xi=1(cid:18)1 −

1 − u(cid:19) vi
1 − βi

a

(35)

n

such large overlap blocks. As III) holds, v1 + v2 = v > cn, so there can be at most one
i ∈ {1, 2} with vi <
(log log n)2 . If this is the case and j is the other element of {1, 2}, then
vi ≪ vj ∼ v ∼ ρn, so together with (34), (35) is
1 − u (cid:19) vj
1 − βj

a(cid:17) +(cid:18)1 −
o(cid:16) n

= o(k) + (1 + o(1))ρ

n
a ∼ ρk,

a

30

as n

a ∼ k by (E). Otherwise, if for both i ∈ {1, 2}, vi >

n

(log log n)2 , (35) and (34) give

2

Xi=1(cid:18)1 −

1 − u(cid:19) vi
1 − βi

a

>(cid:18)1 −

1

log log n(cid:19) v1 + v2

a

v1 + v2

a

∼

∼ ρk.

So in both cases, there are asymptotically at least ρk large overlap blocks of size at least
u (a − 2).

Having subdivided the partition π1 into overlap blocks and singletons according to v1, v2,
d1, d2, we now generate all π2 ∈ P ′(v1, v2, d1, d2). Recall that R was deﬁned in (28) as the
total number of overlap blocks.

Claim. There are at most

(1 − ρ)(1−ρ)nkn−v+R exp(o(n))

other ordered k-equipartitions with the given overlap blocks with the original partition π1.

Proof. We sort the overlap blocks and singletons into k parts to create a new ordered k-
equipartition π2, and start with the large sets of size at least u (a − 2). By the previous
claim, there are (1 + o(1))ρk of them, and each has at most k choices. As u → 1, we can
assume u > 0.6, so no two large overlap blocks can be assigned to the same part.
After we are ﬁnished with the large overlap blocks, the remaining vertices can either be
sorted into the small remainder of the (1 + o(1))ρk parts of π2 which have been assigned a
large block, or they can be sorted into the remaining (1 − ρ + o(1))k parts of π2.
of the parts of π2 with large overlap blocks. Therefore, by (J) there are at most

As u → 1, we can ﬁt at most (1+o(1))ρk·(a − u (a − 2)) = o(n) vertices into the remainder

(cid:18) n
o(n)(cid:19) 6 exp(o(n))

ways of picking these vertices, and for each there are at most k choices for which part of π2
it is assigned to.

There are now at least n − v − o(n) = (1 − ρ + o(1))n singletons and overlap blocks left
to be assigned to the remaining (1 − ρ + o(1))k parts. For each of these there are at most
(1 − ρ + o(1))k choices.
We have now sorted R overlap blocks and n − v singletons into the k parts, and bounded
the number of choices for each by at most k, and for (1− ρ + o(1))n of them by (1− ρ + o(1))k.
Therefore, in total there are at most

(1 − ρ + o(1))(1−ρ+o(1))n kn−v+R 6 (1 − ρ)(1−ρ)nkn−v+R exp(o(n))
ways to build a new partition π2 from the given overlap blocks and singletons.

Now as in the previous part, let x = 1
15, (29) and (30), and since R = R1 + R2,

4 and y = 1 − 1

log log n . Then as in (33), by Lemma

k−nbd(π1,π2)

Xπ2∈P ′(v1,v2,d1,d2)
6 S(v1, v2, d1, d2)(1 − ρ)(1−ρ)nk
i=1(cid:16)−vi+ 2(1−βi)vi
6 (1 − ρ)(1−ρ)nkP2

3

i=1(cid:16) 2(1−βi)vi

3

+ 4(1−βi)vi

(1−y)γ−4 + vi

yγ−1(cid:17)bd1+d2 exp(o(n))

−n+n−v+P2
+ 4(1−βi)vi

(1−y)γ−4 + vi

yγ−1(cid:17)

· bd1+d2 exp (o(n)) .

31

Note that as by (F), b

γ

2 ∼ k, and as a = ⌈γ⌉ = γ + 1 − ∆,
2 = b(β1v1+β2v2)· γ

2 +β2v2· a−2

bd1+d2 = bβ1v1· a−1

2 − 1

2 (∆β1v1+(1+∆)β2v2)

6 kβ1v1+β2v2b− 1

2 (∆β1v1+(1+∆)β2v2) exp(o(n)).

Since I) and II) do not hold, vi(1 − βi) = o(n) for i = 1, 2, and therefore,

bd1+d2 6 kβ1v1+β2v2b− 1

2 (∆v1+(1+∆)v2) exp(o(n)).

Hence,

Xπ2∈P ′(v1,v2,d1,d2)

k−nbd(π1,π2) 6(1 − ρ)(1−ρ)nk

−P2

i=1(cid:16)vi(1−βi)(cid:16) 1

3 −

4

(1−y)γ−4(cid:17)(cid:17)k

v1+v2
yγ−1

2 (∆v1+(1+∆)v2) exp (o(n))

· b− 1
6(1 − ρ)(1−ρ)nk

v1+v2
yγ−1 b− 1

2 (∆v1+(1+∆)v2) exp (o(n))

as 1

3 −

4

(1−y)γ−4 > 0 because (1 − y)γ → ∞. Since γ ∼ 2 logb n and y → 1,

v1+v2
yγ−1 b− 1

2 (∆v1+(1+∆)v2) 6 n

k

2 (∆v1+(1+∆)v2) = b

v1+v2
2+o(1) − 1

2 (∆v1+(1+∆)v2)

v1+v2
yγ−1 b− 1
2 ·v1− ∆

1−∆

6 b

2 ·v2 exp(o(n)).

Hence,

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 bn(1−ρ) logb(1−ρ)+ v1

2 − ∆v

2 exp(o(n)).

(36)

We will show that this last expression is exponentially decreasing in n, and need to dis-
tinguish three cases, depending how large ∆ − x0 − ε is in comparison to ρ. Note that since
γ is not an integer by (B),

n
k

= γ − x0 − ε + o(1) = ⌊γ⌋ + ∆ − x0 − ε + o(1) = a − 1 + ∆ − x0 − ε + o(1).

(37)

Roughly speaking, ∆ − x0 − ε is the proportion of parts of size a in a k-equipartition, and
we need to distinguish between Case 1 where there are few (or no) such parts, Case 2 where
there are more such parts but still not so many that all of the v = ρn vertices in the overlap
can be in parts of size a, and ﬁnally Case 3 where there are enough parts of size a that the
overlap blocks between π1 and π2 can all be in parts of size a in π1. In the ﬁrst case, we shall
only need the condition that c < ρ < 1 − c′; the second and third cases are where condition
(3) from Theorem 1 is crucial.

• Case 1: ∆ − x0 − ε < ∆ρ.

Recall that by (C) in Section 3.1, k1 = δk where δ = n
are no parts of size a in π1. If n
it follows from (37) that δ = ∆ − x0 − ε + o(1) 6 ∆ρ + o(1). Therefore, if n

k −(cid:4) n
k > a − 1, then by (B), (cid:6) n

k(cid:5). If n
k(cid:7) = a and (cid:4) n

k 6 a − 1, then there
k(cid:5) = a − 1, so
k 6 a − 1,

32

there are k1 = δk 6 ∆ρk + o(k) parts of size a in π1, so v1 6 k1a 6 ∆ρn + o(n). In
both cases, from (36),

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 bn(1−ρ) logb(1−ρ)+ ∆ρn

2 − ∆

2 ·ρn exp(o(n))

= bn(1−ρ) logb(1−ρ) exp(o(n)) 6 b−c6n exp(o(n)),

(38)

where c6 := min (−(1 − c) log(1 − c),−c′ log c′) > 0, since c < ρ 6 1 − c′.

• Case 2: ∆ρ 6 ∆ − x0 − ε 6 ρ.

Note that ∆ρ > cε since ρ > c, and ∆ > ε + x0 + ∆ρ > ε. Therefore, by (37) and as
∆ 6 1,

a − 1 + cε 6

+ o(1) 6 a − ε + o(1),

n
k

so in particular (cid:4) n
k(cid:5) = a − 1. By (C) and (37), π1 has k1 = δk = (∆ − x0 − ε + o(1))k
parts of size a. Therefore, v1 can be at most (∆ − x0 − ε + o(1))ka, and as ka ∼ n,
(cid:21) + o(n).
∆ − x0 − ε

ρn + o(n) = n(cid:20) ∆

(1 − ρ) −

v1
2 −

· n −

∆v
2

6

∆
2

x0 + ε

2

2

2

Hence, by (36),

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 b

nh(1−ρ) logb(1−ρ)+ ∆

2 (1−ρ)− x0+ε

2

i exp(o(n)).

As remarked above, ∆ρ > cε, so ∆ − ε − x0 > cε. Therefore, we can apply Lemma 8
with ε′ = cε and c4 = c4(ε, cε) to conclude that

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 b−c4n exp(o(n)).

(39)

• Case 3: ∆ − x0 − ε > ρ.

Noting that v1 + v2 = v = ρn, we proceed from (36):

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 bn(1−ρ) logb(1−ρ)+ 1−∆

2 v exp(o(n))

= bn·[(1−ρ) logb(1−ρ)+ 1−∆

2 ρ] exp(o(n)).

Since c 6 ρ 6 ∆ − x0 − ε, we can use Lemma 7 with ε′ = c to see that this expression
is exponentially decreasing in n:

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 b−c3n exp(o(n)).

(40)

By (38), (39) and (40), if we let c7 = min(c3, c4, c6) > 0, then

Xπ2∈P ′(r1,r2,d1,d2)

k−nbd(π1,π2) 6 b−c7n exp(o(n)).

33

Since there are only O(n4 log2 n) choices for the values of vi 6 n and di 6 f = O(n log n) for
i = 1, 2, this implies

k−nbd(π1,π2) exp(o(log n)) = o(1).

Xπ2∈P III

From Lemmas 14 and 16 together with (32), it follows that

Qrbd = o(1),

Xr∈Rc′

2

as required.

5.4 Very high overlap

We are left with those overlap sequences r where ρ = v/n > 1 − c′ and P26i60.6γ iri 6 c′n
for any constant c′ ∈ (0, 1) of our choosing. This means that all but at most c′n vertices
are involved in the overlap, and of those vertices involved in the overlap, all but at most
c′n are in large overlap blocks of size at least 0.6γ. Roughly speaking, in this case the large
overlap blocks are mostly just permuted amongst themselves, and there are a small number
of exceptional vertices which need to be studied in more detail. Let

Rc′

3 =


r | ρ > 1 − c′, X26i60.6γ

.

iri 6 c′n


We will show that if we pick c′ > 0 small enough, then the contribution from Rc′
3 to the sum
(17) is o(1). We will pick c′ > 0 later in this section, and to ensure this is not circular, we
will take care that none of the implicit constants in our O-notation depend on c′.

As in the previous section, let π1 be an arbitrary ﬁxed ordered k-equipartition. Recall
r the number of ordered k-equipartitions with

that for an overlap sequence r, we denote by P ′
overlap r with π1, and that by (31), Qr = P ′

r

P . Let

3o ,
P3 =nordered k-equipartitions π2 such that r(π1, π2) ∈ Rc′

and recall that µk = P qf by (13). Then

Xr∈Rc′

3

Qrbd = Xr∈Rc′

3

r

P ′
P

bd =

bf

P Xr∈Rc′

3

P ′
r · bd−f =

1

µk Xr∈Rc′

3

P ′
r · b−(f −d) =

1

µk Xπ2∈P3

b−(f −d(π1,π2)),

(41)

where d(π1, π2) := d(r) if r is the overlap sequence of π1 and π2.

Starting with π1, we will generate, and count the number of choices for, π2 ∈ P3. Since
v = ρn > (1 − c′)n and P26i60.6γ iri 6 c′n, most of the overlap between π1 and π2 consists
of large overlap blocks which are merely permuted. More speciﬁcally, given π2 ∈ P3, we call
an overlap block large if it contains at least 0.53γ vertices, and let

L = set of large overlap blocks of size at least 0.53γ.

34

No part of π1 can contain more than one large overlap block, and some parts may not contain
any large overlap block at all. It will be more important later to talk about the latter type
of part, so given π2 ∈ P3, let

T = set of parts of π1 containing no large overlap block.

We call a vertex exceptional if it is either not in the overlap at all or not in a large overlap
block. If π2 ∈ P3, then by deﬁnition there are at most 2c′n exceptional vertices. We shall
distinguish between three types of exceptional vertices. Again given π2 ∈ P3, let

S = set of exceptional vertices
S1 = set of exceptional vertices not in parts in T , i.e., in parts containing a large overlap

block

S2 = set of exceptional vertices in parts in T which are either not in the overlap at all or

in overlap blocks of size at most 100

S3 = set of exceptional vertices in parts in T which are in overlap blocks of size greater

than 100

g = number of overlap blocks of vertices in S3.

Let s = |S|, si = |Si|, and t = |T|. Then, as the vertices in parts in T are exactly those in
S2 ∪ S3, and since by (B), a − 2 6(cid:4) n

k(cid:5) 6(cid:6) n

(42)

k(cid:7) 6 a,

6 t 6

s2 + s3
a − 2

.

s2 + s3

a

The vertices in S3 are arranged in blocks of size between 100 and 0.53γ, so

s3

0.53γ

6 g 6

s3
100

.

(43)

Fix s = (s1, s2, s3), g, and t such that s = s1 + s2 + s3 6 2c′n and (42) and (43) hold, and let

Note that

P(s, t, g) =(cid:8)π2 ∈ P3 | s(π1, π2) = s, t(π1, π2) = t, g(π1, π2) = g(cid:9).

P3 = [s,t,g:s62c′n

P(s, t, g).

(44)

Starting with the ﬁxed partition π1 and given s, g, t, we will generate all π2 ∈ P(s, t, g)
and sum b−(f −d(π1,π2)) to bound the contribution to (41). We will proceed in the following
way: First, we choose all three sets of exceptional vertices, bounding the number of choices in
Lemma 17. Next, we generate π2 by permuting the exceptional vertices amongst themselves

and then permuting all the parts, taking into account that part sizes may vary between (cid:6) n
k(cid:7)
and (cid:4) n
k(cid:5). The number of ways to generate π2 in this way is bounded in Lemma 18. Finally,
in Lemma 19, we will examine how much each exceptional vertex of each type subtracts from
the maximum possible number f of shared forbidden edges between π1 and π2, and we obtain
a lower bound for f − d(π1, π2) which will be used afterwards to bound b−(f −d(π1,π2)) from
above.

35

Lemma 17. For ﬁxed s = (s1, s2, s3), g and t and the ﬁxed partition π1, there are at most

ns1kt2s3tgas3

s1!g!

ways to choose the sets S1, S2 and S3 and arrange the vertices in S3 into g overlap blocks.

Proof. We ﬁrst choose the vertices in S1 and the parts in T . For this there are at most

(cid:18) n
s1(cid:19)(cid:18)k

t(cid:19) 6

ns1kt
s1!

possibilities. Next, we pick the vertices in S3 from within the parts in T along with the g
overlap blocks they make up. Since we do not know the exact sizes of these overlap blocks, we

ﬁrst write s3 as an ordered sum of g positive summands, which can be done in (cid:0)s3−1

Next, we decide which of the parts in T each of the g blocks is in, for which there are at most
tg choices, and then we pick the vertices that belong to each of the g blocks. We know which
part of size at most a each such vertex is in, and we choose s3 vertices in total, so there are at
most as3 possibilities for this. Finally, since we do not care about the order of the g overlap
blocks, we can divide by g!. So overall, there are at most

g−1(cid:1) ways.

(cid:18)s3 − 1
g − 1(cid:19)tgas3 1

g!

6

2s3tg

g!

as3

ways of selecting the vertices in S3 along with the g overlap blocks they are arranged in. The
remaining vertices in the parts in T must be exactly those in S2.

Let

τ = max(cid:18)1, Γ(cid:16) s2

t (cid:17)t(cid:19) ,

(45)

where Γ(·) denotes the gamma function.
Lemma 18. Given π1, S1, S2, S3 and the overlap blocks that the vertices in S3 are arranged
in, there are at most

possibilities for π2.

2k (s1 + s2 + g)!

τ

k1!k2!

Proof. Note that each part in π1 and π2 contains at most one large overlap block from L,
since one such block occupies more than half of a part. Therefore, since we know S1, S2 and
S3, we also know L. In each part of π1, there are a certain number of ‘slots’ for exceptional
vertices, with the rest of the part occupied by at most one block from L. The numbers of slots
for exceptional vertices in parts of π2 are essentially just a permutation of the numbers of
slots in π1, because the remainders of the parts in π2 are again occupied by at most one block

from L. However, as total part sizes vary between (cid:6) n

slots in each part may also increase or decrease by 1.

k(cid:7) and (cid:4) n

k(cid:5), the numbers of available

Therefore, starting with π1, we can generate every possible partition π2 in the following
way. Each of the k parts of π1 contains a certain number of exceptional vertices, and for
each part we decide whether or not to increase or decrease the number of available slots for
exceptional vertices by 1, for which there are at most 2k possibilities. We write the vertices in

36

S1 and S2 along with the g blocks comprising the vertices in S3 as a list and permute them,
which can be done in

(s1 + s2 + g)!

ways. Now we divide up the list successively according to the number of available slots in
each of the k parts (discarding the cases where this is not possible because one of the g blocks
would have to be divided), and move the vertices from each division to the corresponding

for which there are

part. Finally, we permute all k1 parts of (new) size (cid:6) n
possibilities, and re-order the parts so that those of size (cid:6) n
size (cid:4) n

k(cid:5), yielding the new ordered k-equipartition π2.

k1!k2!

k(cid:7) and all k2 parts of (new) size (cid:4) n
k(cid:5),
k(cid:7) come ﬁrst, followed by those of

However, we have overcounted the number of ways to generate π2: Each possible partition
π2 was counted at least τ times, where τ is deﬁned in (45). To see this, suppose we have
generated a partition π2. Note that the number of available slots for exceptional vertices in
the parts in T is at least s2 + s3− t, since there were initially s2 + s3 exceptional vertices in the
parts in T , and at most t slots can be ‘lost’. So at least s2 + s3 − t vertices were moved to the
available slots in T , and of these, at most s3 were in one of the g overlap blocks. Therefore,
there were at least s2 − t vertices which were permuted and then moved to the parts in T as
singletons. Denote the number of such singletons assigned to each of the parts in T by l1,
l2, ..., lt, where Pt
i=1 li > s2 − t. Then, since we do not care about the order of the vertices
within the parts, we counted π2 at least Qt
Note that li! = Γ(li + 1), where Γ(·) denotes the gamma function. By the Bohr–Mollerup
Theorem (see for example §13.1.10 in [18]), log Γ(·) is a convex function on the positive reals,
so from Jensen’s inequality,

i=1 li! times.

t

log  t
li!! =
Xi=1
Yi=1
t + 1(cid:1)t
and therefore Qt
i=1 li! > Γ(cid:0) s2−t
Lemma 19. If π2 ∈ P(s, t, g), then

log(Γ(li + 1)) > t log Γ 1
= Γ(cid:0) s2

t

li + 1!! ,

t

Xi=1

t (cid:1)t. Hence, we may divide our result by τ .

f − d(π1, π2) > 0.53γs1 + (γ/2 − 51) s2 + 0.23γs3.

Proof. Note that the number d(π1, π2) of shared forbidden edges is exactly the number of
pairs of vertices which are in the same part in both π1 and π2, and f is the number of pairs
of vertices which are in the same part of π1. Therefore, if we let

E =(cid:8){v, w} | v and w are in the same part of π1 but in diﬀerent parts of π2(cid:9),

then f − d(π1, π2) = |E|. Each exceptional vertex v ∈ S contributes at least a certain amount
to |E| according to its type.
If v is in S1, then v is in a part of π1 which contains a large overlap block. Therefore,
there are at least 0.53γ vertices w /∈ S such that {v, w} ∈ E. Therefore, the contribution
from S1 to |E| is at least 0.53γs1.
Since the vertices in S2 are in overlap blocks of size at most 100, for each v ∈ S2, there
are at least (cid:4) n
k(cid:5) − 100 > γ − 102 vertices w such that {v, w} ∈ E. As the vertices in S3 are

37

exceptional and therefore in overlap blocks of size at most 0.53γ, for each v ∈ S2, there are at
least (cid:4) n
k(cid:5) − 0.53γ > 0.46γ vertices w such that {v, w} ∈ E. However, we have counted each
such pair {v, w} twice, and must therefore divide the total number by 2. So the contribution
from S2 ∪ S3 to |E| is at least (γ/2 − 51) s2 + 0.23γs3.
By (F) from Section 3.1, b−γ ∼ k−2, so if π2 ∈ P(s, t, g), from Lemma 19,

b−(f −d(π1,π2)) 6 k−1.06s1−s2−0.46s3 exp (O (s)) 6 n−1.05s1k−s2−0.46s3 exp (O (s)) .

Together with Lemmas 17 and 18, this gives

Xπ2∈P(s,t,g)

b−(f −d(π1,π2))

6

ns1kt2s3tgas3

s1!g!

2k (s1 + s2 + g)!

τ

k1!k2!n−1.05s1k−s2−0.46s3 exp (O (s))

= k1!k2!2kn−0.05s1tgas3 (s1 + s2 + g)!

s1!g!τ

kt−s2−0.46s3 exp (O (s))

= k1!k2!2kn−0.05s1tgas3 (s1 + s2 + g)!s2!

s1!s2!g!τ

kt−s2−0.46s3 exp (O (s)) .

Note that (s1+s2+g)!
with (43),

s1!s2!g! 6 3s1+s2+g = exp (O (s)) and by (42), s2! 6 ss2

2 6 ts2as2, so together

Xπ2∈P(s,t,g)

b−(f −d(π1,π2)) 6k1!k2!2kn−0.05s1ts2+s3/100as2+s3 1
τ
6k1!k2!2kn−0.05s1ts2+s3/100as2+s3 1
τ

kt−s2−0.46s3 exp (O (s))

k−s2−0.46s3 exp (O (s)) ,

(46)

as kt 6 k(s2+s3)/(a−2) 6 exp(O(s2 + s3)) by (G) from Section 3.1. Let

T (s2, s3) = ts2+s3/100as2+s3 1
τ

k−s2−0.46s3 exp (C2(s2 + s3)) ,

where C2 > 0 is the constant implicit in the term O (s) above. We distinguish two cases:

• Case 1: s3 > 100s2.

By (42), s3 6 s2 + s3 6 at, so s2 6 0.01at. Since again by (42), s2 + 0.46s3 >
0.46(s2 + s3) > 0.46(a − 2)t, and t 6 k and τ > 1,

k0.45 (cid:19)at
T (s2, s3) 6 t0.02ataatk−0.46(a−2)t exp(O(s2 + s3)) 6(cid:18) k0.02a

6 n−0.4at exp(O(s2 + s3)) 6 n−0.3(s2+s3)

exp(O(s2 + s3))

if n is large enough.

• Case 2: s3 < 100s2.

Then by (42), t 6 101s2
Gamma function,

a−2 6 51s2

logb n , so s2

t > logb n

51 . By the Stirling approximation of the

τ > Γ (s2/t)t >(cid:18) s2

e (cid:19)s2−t
t − 1

> (log n)s2 exp(O(s2)).

38

Furthermore, t 6 s2+s3
for n large enough. So since a 6 2 logb n = 2 log n/ log b,

a−2 6 2c′n

a−2 6 s

a−2 6 3c′k if n is large enough, and therefore t

k 6 3c′

T (s2, s3) 6(cid:18) ta
6(cid:18) 6c′

k0.46 (cid:19)s3
k log n(cid:19)s2(cid:18) t0.01a
k0.46 (cid:19)s3
log b(cid:19)s2(cid:18) t0.01a

exp(O(s2 + s3))

2(cid:19)s2
exp(O(s2 + s3)) 6(cid:18) 1

n−0.3s3

for n large enough if c′ > 0 is picked small enough. Pick the constant c′ > 0 small
enough for this.

Therefore in both cases, from (46) if n is large enough,

Xπ2∈P(s,t,g)

b−(f −d(π1,π2)) 6 k1!k2!2kn−0.05s12−s2n−0.3s3 exp(O(s1))

6 k1!k2!2kn−0.04s12−s2n−0.3s3.

If we sum over s1, s2 and s3 and recall that g 6 s3/100 and t 6 s2 + s3, by (44) we get a
bound for (41):

Qrbd 6

Xr∈Rc′

3

k1!k2!2k

µk Xs1,s2,s3(cid:18)0.01s3(s2 + s3)n−0.04s12−s2n−0.3s3(cid:19) = O(cid:18) k1!k2!

µk

· 2k(cid:19) .

As k = O(cid:16) n

µk
k1!k2! > bεn/4, we can see that this
last expression is exponentially decreasing in n, and in particular it is o(1) as required. This
concludes the proof of Theorem 1.

log n(cid:17), and since by (K) from Section 3.1,

6 Outlook

Recall from the introduction that the chromatic number of random graphs is highly concen-
trated, and that in particular for constant p, there is an interval of length roughly √n/ log n
which contains χ(G) whp. The proof of this concentration result gives no clue about the
location of this interval, however. While our new explicit bounds match each other up to the
o(1)-term, the gap between them which is implicit in the proof is still at least n log log n
, which
is of course larger than √n/ log n.

log3 n

Therefore, a more detailed result about the size of the o(1)-term would be interesting. For
p 6 1 − 1/e2, where the lower bound comes from the ﬁrst moment threshold for the number
of partitions which induce proper colourings [24], this gap is unavoidable as long as the upper
bound is obtained through the study of partitions which induce balanced colourings, since the
ﬁrst moment thresholds of colourings and balanced colourings are separated by this distance.
Recall also from the introduction that for small p = p(n) ≪ n−1/2, the chromatic number
of G(n, p) is concentrated on two values whp [3], and this is generally the smallest possible
interval one can hope for. In contrast, the question of the concentration of the chromatic
number of dense random graphs is wide open. Even the most basic non-concentration results,
such as showing that we do not in general have two-point concentration, would be interesting
(see also [7]).

39

Acknowledgements

I am grateful to my supervisor Oliver Riordan for many helpful discussions and for his com-
ments on several earlier versions of this paper.

References

[1] D. Achlioptas and E. Friedgut. A sharp threshold for k-colorability. Random Structures

and Algorithms, 14(1):63–70, 1999.

[2] D. Achlioptas and A. Naor. The two possible values of the chromatic number of a random

graph. Annals of Mathematics, 162:1335–1351, 2005.

[3] N. Alon and M. Krivelevich. The concentration of the chromatic number of random

graphs. Combinatorica, 17(3):303–313, 1997.

[4] N. Alon and J. Spencer. The probabilistic method. Wiley, 4th edition, 2015.

[5] B. Bollob´as. The chromatic number of random graphs. Combinatorica, 8(1):49–55, 1988.

[6] B. Bollob´as. Random Graphs. Cambridge University Press, second edition, 2001.

[7] B. Bollob´as. How sharp is the concentration of the chromatic number? Combinatorics,

Probability and Computing, 13(01):115–117, 2004.

[8] B. Bollob´as and P. Erd˝os. Cliques in random graphs. In Mathematical Proceedings of
the Cambridge Philosophical Society, volume 80, pages 419–427. Cambridge Univ Press,
1976.

[9] A. Coja-Oghlan. Upper-bounding the k-colorability threshold by counting covers. The

Electronic Journal of Combinatorics, 20(3):P32, 2013.

[10] A. Coja-Oghlan and D. Vilenchik. Chasing the k-colorability threshold. In 2013 IEEE
54th Annual Symposium on Foundations of Computer Science (FOCS), pages 380–389,
2013.

[11] A. Coja-Oghlan and D. Vilenchik. The chromatic number of random graphs for most

average degrees. International Mathematics Research Notices, rnv333, 2015.

[12] A. Coja-Oghlan, K. Panagiotou, and A. Steger. On the chromatic number of random

graphs. Journal of Combinatorial Theory B, 98(5):980–993, 2008.

[13] N. Fountoulakis, R. Kang, and C. McDiarmid. The t-stability number of a random graph.

The Electronic Journal of Combinatorics, 17(1):R59, 2010.

[14] A. Frieze. On the independence number of random graphs. Discrete Mathematics, 81

(2):171–175, 1990.

[15] C. Greenhill, B. McKay, and X. Wang. Asymptotic enumeration of sparse 0–1 matrices
with irregular row and column sums. Journal of Combinatorial Theory, Series A, 113
(2):291–324, 2006.

40

[16] S. Janson, T.  Luczak, and A. Ruci´nski. Random Graphs. Wiley, New York, 2000.

[17] R. Kang and C. McDiarmid. Colouring random graphs. In Topics in Chromatic Graph
Theory, volume 156 of Encyclopedia of Mathematics and Its Applications, chapter 10,
pages 199–229. Cambridge University Press, 2015.

[18] S Krantz. Handbook of Complex Variables. Birkh¨auser, Boston, 1999.

[19] T.  Luczak. The chromatic number of random graphs. Combinatorica, 11(1):45–54, 1991.

[20] T. Luczak. A note on the sharp concentration of the chromatic number of random graphs.

Combinatorica, 11(3):295–297, 1991.

[21] G. Matula and L. Kuˇcera. An expose-and-merge algorithm and the chromatic number
of a random graph. In Random Graphs ’87 (Pozna´n 1987), pages 175–187. Wiley, 1990.

[22] C. McDiarmid. On the method of bounded diﬀerences. Surveys in Combinatorics, 141

(1):148–188, 1989.

[23] B. McKay. Asymptotics for 0-1 matrices with prescribed line sums. Enumeration and

Design, pages 225–238, 1984.

[24] K. Panagiotou and A. Steger. A note on the chromatic number of a dense random graph.

Discrete Mathematics, 309(10):3420–3423, 2009.

[25] A. Scott. On the concentration of the chromatic number of random graphs. arXiv

preprint arXiv:0806.0178, 2008.

[26] E. Shamir and J. Spencer. Sharp concentration of the chromatic number on random

graphs Gn,p. Combinatorica, 7(1):121–129, 1987.

41

