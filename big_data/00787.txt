6
1
0
2

 
r
a

M
2

 

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
7
8
7
0
0

.

3
0
6
1
:
v
i
X
r
a

COMPUTING JUMPING NUMBERS IN HIGHER DIMENSIONS

HANS BAUMERS AND FERRAN DACHS-CADEFAU

Abstract. The aim of this paper is to generalize the algorithm to compute jumping
numbers on rational surfaces described in [AAD14] to varieties of dimension at least
3. Therefore, we introduce the notion of π-antieﬀective divisors, generalizing antinef
divisors. Using these divisors, we present a way to ﬁnd a small subset of the ‘classical’
candidate jumping numbers of an ideal, containing all the jumping numbers. Moreover,
many of these numbers are automatically jumping numbers, and in many other cases, it
can be easily checked.

1. Introduction

To an ideal sheaf a on a smooth algebraic variety X, one can associate its multiplier
ideals J (X, ac), where c ∈ Q>0. They form a nested family of ideals in OX , which
decreases when c increases. The values of c where the ideal changes are called the jumping
numbers of the pair (X, a). They are very interesting geometric invariants, that were
studied in [ELSV04], but also appeared earlier in [Lib83], [LV90], [Vaq92] and [Vaq94].
The jumping numbers determine in some sense how bad a singularity is. For example,
if a is the ideal corresponding to a smooth hypersurface, then the jumping numbers are
just the positive integers. When the ideal represents a more singular variety - or when
it takes more blow-ups to obtain a log resolution - the jumping numbers are in general
smaller and more numerous.

The smallest jumping number is called the log canonical threshold. Koll´ar (see [Kol97])
proved that, if a is a principal ideal, it corresponds to the smallest root of the Bernstein-
Sato polynomial. Ein, Lazarsfeld, Smith and Varolin (see [ELSV04]) generalized this
result for all jumping numbers in the interval (0,1].

We are interested in ways to compute jumping numbers. For monomial ideals, Howald
([How01]) showed a combinatoric description of the multiplier ideal, which also allows to
determine the jumping numbers. In [Tuc10], Tucker presents an algorithm to compute
jumping numbers on surfaces with rational singularities. Alberich-Carrami˜nana, `Alvarez
Montaner and the second author ([AAD14]) introduce another algorithm in that setting.
Shibuta ([Shi11]) constructed an algorithm to compute multiplier ideals and jumping
numbers in arbitrary dimensions using D-modules, which was simpliﬁed by Berkesch and
Leykin ([BL10]).

The ﬁrst author is supported by a PhD fellowship of the Research Foundation - Flanders (FWO). The
second author was partially supported by Generalitat de Catalunya SGR2014-634 project, Spanish Min-
isterio de Econom´ıa y Competitividad MTM2015-69135-P and by the KU Leuven grant OT/11/069.

1

2

H. BAUMERS AND F. DACHS-CADEFAU

In this paper, we present an algorithm that can be used for computing jumping numbers
in arbitrary dimensions, based on the algorithm in [AAD14]. The idea is to start with
computing the so-called supercandidates, and then checking whether they are jumping
numbers. The supercandidates can be computed in arbitrary dimensions, as long as we
have enough understanding of the Picard groups of the exceptional divisors in a chosen
resolution of a. For checking that they are jumping numbers, we give some possible
criteria. Although we do not present a technique that works in full generality, we are able
to compute jumping numbers of ideals where previous algorithms seemed to be insuﬃcient
(or got stuck while computing them).

In Section 2 we introduce the basics on multiplier ideals and jumping numbers, together
with some elementary results that we need. We also recall some of the notions introduced
by Tucker in [Tuc10].

In Section 3, we deﬁne the π-antieﬀective divisors, which are a generalization of the
notion of antinef divisors. We also construct a method to compute the π-antieﬀective
closure of a divisor, generalizing the unloading procedure presented in [Lau72] and [EC15].
Lipman’s correspondence between antinef divisors and integrally closed ideals (see [Lip69])
does not hold anymore in higher dimensions, but we present a weaker alternative in Section
3.2.

Section 4 contains the core of the paper. Here we present our algorithm to compute

the supercandidates, and ways to check whether they are jumping numbers.

Finally, in Section 5 we present some illustrative examples.

2. Preliminaries

Through this section, let X be a smooth algebraic variety with dim X = n > 2 over
an algebraically closed ﬁeld k of characteristic zero. Let a be a sheaf of ideals on X. We
deﬁne a log resolution of the pair (X, a) as a birational morphism π : Y → X, such that

• Y is smooth,
• the pre-image of a is locally principal, i.e., a · OY = OY (−F ) for some eﬀective

Cartier divisor F , and

• F + Exc(π) is a simple normal crossing divisor.

By Hironaka’s resolution of singularities (see [Hir64]), log resolutions always exist.Note
that if a = OX (−D) for an eﬀective divisor D, then F = π∗D, and π will be called a log
resolution of (X, D) instead of (X, OX (−D)).

Given a birational morphism π : Y → X, the relative canonical divisor measures in

some way the diﬀerence between X and Y .

Deﬁnition 2.1. Let π : Y → X be a birational morphism of smooth varieties, the relative
canonical divisor of π is the divisor class

Kπ := KY − π∗KX .

It is important to notice that, even though KX and KY are only deﬁned as divisor
classes, the relative canonical divisor can be chosen to be an eﬀective divisor, supported

on the exceptional locus of π. Indeed, if X and Y are smooth, there is a unique way to
write

with ki ∈ Z>0, where the Ei are the irreducible components of Exc(π).

Kπ =X kiEi ,

Another notion that we need to introduce is Q-divisors.

Deﬁnition 2.2. A Q-divisor D on an algebraic variety Y is a formal ﬁnite sum D =

3

P aiDi, where the Di are irreducible codimension one subvarieties of Y , and ai ∈ Q.
For any Q-divisor D =P aiDi, one denotes its round-down and round-up as

and

respectively.

⌊D⌋ =X⌊ai⌋Di

⌈D⌉ =X⌈ai⌉Di ,

2.1. Multiplier Ideals. Having introduced these basic notions, we deﬁne multiplier
ideals.

Deﬁnition 2.3. Let a be a sheaf of ideals on X, π : Y → X a log resolution of a, and
F the divisor satisfying a · OY = OY (−F ). For c ∈ Q>0, we deﬁne the multiplier ideal
associated to a with coeﬃcient c as

where Kπ is the relative canonical divisor.

J (X, ac) := π∗OY (Kπ − ⌊cF ⌋) ,

If a = OX (−D) for an eﬀective divisor D on X, we will denote the multiplier ideals by
J (X, cD). For simplicity, if no confusion can arise, we will simply write J (ac) or J (cD).

Remark 2.4. It is clear from the deﬁnition of Kπ that π∗OY (Kπ) = OX , and therefore
for any eﬀective divisor N, we have

π∗OY (Kπ − N) ⊆ OX .

It is due to this fact that J (ac) ⊆ OX are subsheaves of OX, which justiﬁes the name
multiplier ideal.

It is easy to see that J (ac) ⊆ J (ac′) if c > c′, and that J (a(c+ε)) = J (ac) if 0 6 ε ≪ 1.

This yields the following result.

Proposition-Deﬁnition 2.5. Let a be an ideal sheaf on X. There exists an increasing
sequence of rational numbers

0 = λ0 < λ1 < λ2 < λ3 < . . .

satisfying

• J (aλi) ! J (aλi+1) for i ∈ N,
• J (ac) = J (aλi) for c ∈ [λi, λi+1).

The numbers λi, i > 0, are called the jumping numbers of a.

4

H. BAUMERS AND F. DACHS-CADEFAU

The jumping numbers of a divisor D are deﬁned analogously. The smallest jumping
number is called the log canonical threshold of a or D, and is denoted by lct(X, a) or
lct(X, D), respectively. This is a very important invariant of the pair (X, a) or (X, D),
that appears in diﬀerent branches of algebraic geometry. For a nice overview, we refer to
[Kol97].

Now we ﬁx some notations. For a pair (X, a), we ﬁx a log resolution π : Y → X. We
denote by F the divisor satisfying a · OY = OY (−F ). The irreducible components of F
are denoted Ei, i ∈ I, and we write

eiEi ,

F =Xi∈I

where ei ∈ Z>0. The divisor F has an exceptional part and a non-exceptional part, also
called the aﬃne part. The aﬃne part is sometimes denoted Faf f , and the exceptional
components are denoted E1, . . . , Er. So we also have

Note that Faf f = 0 whenever the support of a has codimension at least 2.

F = Faf f +

eiEi .

r

Xi=1

Let a ⊆ OX be an ideal on X, D be an eﬀective divisor on X, F the divisor on Y
deﬁned as before and c a positive rational number. The multiplier ideals associated to a
or D and c satisfy the following properties (see [Laz04]).

• The deﬁnition of multiplier ideal does not depend on the resolution (Esnault-

Viehweg in [EV92]).

• (Local Vanishing) Riπ∗OY (Kπ − ⌊cF ⌋) = 0 for all i > 0 and c > 0.
• We have that J (ac) is integrally closed for all c > 0.
• The integers are jumping numbers for the pair (X, D).
• For c > 0, we have that

J ((c + 1)D) = π∗OY (Kπ − ⌊cπ∗D⌋ − π∗D)

= J (cD) ⊗OX OX (−D).

It follows that λ > 0 is a jumping number if and only if λ + 1 is a jumping number.

• (Skoda’s theorem) If m ∈ N with m > n, then

J (am) = aJ (am−1) .

Therefore, for any λ > n, one has that λ is a jumping number if and only if λ − 1
is a jumping number.

• From the proof of Skoda’s theorem, one can actually deduce a stronger result. If a

is an ideal generated by ℓ elements and m > ℓ, then

J (am) = aJ (am−1) .

Therefore, for any λ > ℓ, one has that λ is a jumping number if and only if λ − 1
is a jumping number.

5

Remark 2.6. Lipman and Watanabe (see [LW03]), and independently Favre and Jonsson
(see [FJ05]), proved that every integrally closed ideal in a two-dimensional regular local
ring is a multiplier ideal. However, this is no longer true in higher dimensions. Lazarsfeld
and Lee showed in [LL07] that if dim X > 3, integrally closed ideals need to satisfy certain
conditions in order to be realized as multiplier ideals. The conditions allow them to give
examples of integrally closed ideals that cannot be realized as multiplier ideals.

2.2. Contributing divisors. One can easily see from the deﬁnition of multiplier ideals
that, with the notations above, the jumping numbers are contained in the set

(cid:26) ki + n

ei

i ∈ I, n ∈ Z>0(cid:27) .

(cid:12)(cid:12)(cid:12)(cid:12)

These numbers are the candidate jumping numbers. It is important to notice that the
smallest candidate is always a jumping number, and hence it equals the log canonical
threshold. So we have

and similar for a divisor D.

Furthermore, if Ei is not exceptional, then ki = 0 and the candidates

lct(X, a) = min(cid:26) ki + 1

ei

i ∈ I(cid:27) ,

(cid:12)(cid:12)(cid:12)(cid:12)
m ∈ Z>0(cid:27)

(cid:26) m

ei

(cid:12)(cid:12)(cid:12)(cid:12)

are always jumping numbers. For the exceptional ones, in general many candidate jumping
numbers are not a jumping number.

Deﬁnition 2.7. Let G be a reduced divisor supported on the exceptional part of π and
λ a positive rational number. We will say that λ is a candidate jumping number for G if
and only if λ can be expressed as ki+ni

for each Ei 6 G with ni ∈ Z>0.

ei

A notion that is stronger and more interesting than being a candidate for a divisor, is
being contributed by a divisor. This notion was introduced by Smith and Thompson in
[ST07], and developed further by Tucker in [Tuc10].

Deﬁnition 2.8. [Tuc10, Deﬁnition 3.1] Let G be a reduced divisor supported on the
exceptional part of π, and λ a candidate jumping number for G. We say that G contributes
λ as a jumping number if

π∗OY (Kπ − ⌊λF ⌋ + G) ! J (X, aλ) .

We will say that this contribution is critical if moreover for any non-zero divisor G′ < G
one has

π∗OY (Kπ − ⌊λF ⌋ + G′) = J (X, aλ) .

As an illustration of these concepts, we consider some examples in dimension two.

6

H. BAUMERS AND F. DACHS-CADEFAU

Example 2.9. Let X be the aﬃne plane and D = {y2 = x3}. Let π : Y → X be the
minimal log resolution of D, and E1, E2 and E3 the exceptional divisors. Then we have
π∗D = Daf f + 2E1 + 3E2 + 6E3, where Daf f is the strict transform of D. Moreover, we
have that Kπ = E1 + 2E2 + 4E3, so the candidate jumping numbers are

Hence

(cid:26) 0 + n

1

,

1 + n

2

,

2 + n

3

,

4 + n

6

lct(X, D) =

5
6

n ∈ Z>0(cid:27) .

(cid:12)(cid:12)(cid:12)(cid:12)

is the smallest jumping number. Moreover, since we are in the case of a divisor, the
integers are always jumping numbers, and the jumping numbers are periodic. Then one
concludes that

(cid:26) 5

6

, 1,

, 2,

11
6

17
6

, 3, . . .(cid:27)

is the set of jumping numbers. Clearly, all jumping numbers of the form 5
are contributed by E3, and all integers are contributed by Daf f .

6 + m for m ∈ N

Example 2.10. [AAD14, Example 3.9] Let X be the aﬃne plane again and consider the
ideal a = (x2y2, x5, y5, xy4, x4y) ⊆ OX . Let π : Y → X be its minimal log resolution.
Then Kπ = E1 + 2E2 + 4E3 + 2E4 + 4E5, and a · OY = OY (−F ), where F = 4E1 +
5E2 + 10E3 + 5E4 + 10E5. Using the fact that the log canonical threshold is the minimal
candidate jumping number, one can see that lct(X, a) = 1
2. In order to compute all the
jumping numbers in this case, we use the algorithm presented in [AAD14]. This yields
that the set of jumping numbers associated to a is

We can see that 7
by E3 and also by E5, 7

10 is contributed by E3 + E5. However, since it is (critically) contributed

10 is not critically contributed by E3 + E5.

,

(cid:26) 1

2

7
10

,

n > 9(cid:27) .

n

10(cid:12)(cid:12)(cid:12)(cid:12)

The following result is a nice characterization of contribution which will be used in the
following sections. It appears in [ST07] and [Tuc10, Proposition 4.1] for surfaces, but it
holds in a more general setting. We repeat it here for completeness. First, we introduce
a notation.

Notation 2.11. If E is a subscheme of a scheme Y , ι : E → Y is the embedding, and F
is a sheaf of OY -modules, then we denote by F |E the OE-module ι∗F . Sometimes, if G
is a sheaf of OE-modules, we will consider it as a sheaf on Y by simply writing G instead
of ι∗G.

Proposition 2.12. Suppose λ is a candidate jumping number for the reduced divisor G.
Suppose that G is mapped onto an aﬃne subscheme of X. Then λ is realized as a jumping
number for (X, D) or (X, a) contributed by G if and only if

H 0(G, OY (Kπ − ⌊λF ⌋ + G)|G) 6= 0 .

7

Furthermore, this contribution is critical if and only if we have

H 0(G′, OY (Kπ − ⌊λF ⌋ + G′)|G′) = 0

for all divisors G′ on Y with 0 6 G′ < G.

Proof. Consider the exact sequence

0 → OY (Kπ − ⌊λF ⌋) → OY (Kπ − ⌊λF ⌋ + G) → OY (Kπ − ⌊λF ⌋ + G)|G → 0 .

After pushing forward through π, we get

0 → J (X, aλ) → π∗OY (Kπ − ⌊λF ⌋ + G) → π∗(OY (Kπ − ⌊λF ⌋ + G)|G) → 0 ,

since by local vanishing we have R1π∗OY (Kπ − ⌊λF ⌋) = 0. So we see that λ is a jumping
number contributed by G if and only if π∗(OY (Kπ −⌊λF ⌋+ G)|G) 6= 0. Since G is mapped
onto an aﬃne scheme, this is equivalent to H 0(G, OY (Kπ −⌊λF ⌋+ G)|G) 6= 0. The second
statement follows immediately from the deﬁnition of critical contribution.
(cid:3)

Remark 2.13. The condition that G is mapped onto an aﬃne subscheme of X is a gener-
alization of the two-dimensional case, where all the exceptional divisors are contracted to
a point, and is also suﬃcient for our purposes, since we will only consider aﬃne varieties
X.

Corollary 2.14 ([Tuc10, Corollary 4.2]). If G critically contributes a jumping number λ,
then G is connected.

Proof. Suppose that G is disconnected, so G = G′ + G′′ with 0 < G′, G′′ < G and G′ and
G′′ disjoint. Then

H 0(G, OY (Kπ − ⌊λF ⌋ + G)|G)

= H 0(G′, OY (Kπ − ⌊λF ⌋ + G′)|G′) ⊕ H 0(G′′, OY (Kπ − ⌊λF ⌋ + G′′)|G′′) .

So if λ is contributed by G, it is also contributed by G′ or G′′, contradicting critical
contribution.
(cid:3)

3. π-antieffective divisors and integrally closed ideals

From now on, we consider a regular local ring R over k of dimension at least 2, such that
X = Spec R is the germ of a smooth algebraic variety over k. Let a be an ideal sheaf on X,
ﬁx a log resolution π : Y → X, and let F be the divisor satisfying a · OY = OY (−F ). We
denote the relative canonical divisor by Kπ, this divisor is supported over the exceptional
divisors Ei for i = 1, ..., r.

If dim X = 2, recall the following deﬁnition.

Deﬁnition 3.1. If Y is a surface, then a divisor D on Y is called antinef (or π-antinef )
if −D · Ei > 0 for all i ∈ {1, . . . , r}.

8

H. BAUMERS AND F. DACHS-CADEFAU

This notion is introduced in [Lip69], and is also explained in [Tuc09]. A generalization

of this concept to higher dimensions is given in [CGL96].

In section 3.1, we deﬁne π-antieﬀective divisors, which is a generalization to higher
dimensions of antinef divisors. It is diﬀerent from the one in [CGL96], but more useful
for our purposes. We prove the existence of the π-antieﬀective closure and present a way
to compute it.

Lipman proved that in the two-dimensional case there is a one-to-one correspondence
between antinef divisors on Y and integrally closed ideals in R deﬁning invertible sheaves
on Y . In higher dimensions, this correspondence does not hold anymore. We will prove a
weaker version in Section 3.2.

Before introducing π-antieﬀective divisors, we give a deﬁnition.

Deﬁnition 3.2. We say that two divisors D1 and D2 on Y are equivalent if and only if
they deﬁne the same ideal in R, i.e., if and only if π∗OY (−D1) = π∗OY (−D2).

From now on, if we want to refer to linear or numerical equivalence, we will state it

clearly, so no confusion will arise.

3.1. Unloading. The following deﬁnition is the generalization we want of the notion of
antinef divisor.

Deﬁnition 3.3. Let D be a divisor on Y with integral coeﬃcients. We say that D is
π-antieﬀective if and only if H 0(E, OY (−D)|E) 6= 0 for every π-exceptional prime divisor
E, i.e., if and only if −D|E is a divisor class on E containing an eﬀective divisor.

In general, for any divisor, we can ﬁnd a π-antieﬀective divisor equivalent to the given

divisor.

Theorem 3.4. Let D be a divisor on Y , then there exists a unique integral eﬀective
π-antieﬀective divisor ˜D satisfying

• ˜D > D, and
• for any π-antieﬀective divisor D′ such that D′ > D, we have D′ > ˜D.

Moreover, this divisor is equivalent to D.

This leads us to the following deﬁnition.

Deﬁnition 3.5. The π-antieﬀective divisor ˜D satisfying

• ˜D > D, and
• for any π-antieﬀective divisor D′ such that D′ > D, we have D′ > ˜D,

is called the π-antieﬀective closure of D.

The proof of the theorem will be divided in several results. In the forthcoming lemma,
we prove that such a minimal divisor exists. Later on (see Propositions 3.7 and 3.8), we
prove that a divisor and its π-antieﬀective closure are equivalent.

9

Lemma 3.6. Let D be a divisor, then there exists a unique integral π-antieﬀective divisor
˜D satisfying

• ˜D > D, and
• for any π-antieﬀective divisor D′ such that D′ > D, we have D′ > ˜D.

Moreover, ˜D − D is supported on the exceptional locus of π.

Proof. This proof is based partially on Paragraph 2.2 in [Tuc09].

Let D be the set of all π-antieﬀective divisors D′ such that D′ > D. In the ﬁrst part of
the proof, we show that D is non-empty, while the second part is devoted to prove that
D has a unique minimal element.

We start with showing that D is non-empty. Take g ∈ R such that νi(g) > 0 for all
divisorial valuations νi associated to one of the exceptional divisors Ei. Let G be the
exceptional part of div(g), and take D0 := π∗π∗D + mG for suﬃciently large m ∈ N.
We claim that D0 ∈ D. Clearly D0 > D. Moreover, D0 is π-antieﬀective.
Indeed, it
equals π∗(π∗D + mdiv(g)) − mGaf f , where Gaf f is the aﬃne part of π∗div(g), and hence,
since Pic X = 0, we have that −D0|E is linearly equivalent to mGaf f |E, which is clearly
eﬀective.

In order to check the unicity of a minimal element in D, assume that there exist
i Ei in D. Now, deﬁne
i }. Take an exceptional divisor E, and suppose that

two diﬀerent minimal divisors D1 = Pi d1
D′ = Pi diEi with di = min{d1

d1
E 6 d2

E. Then

If Ei 6= E, then Ei|E is an eﬀective divisor on E, and therefore PEi6=E(d1

i − di)Ei|E =
D1|E − D′|E is an eﬀective divisor on E. Since D1 is π-antieﬀective, −D1|E deﬁnes the
class of an eﬀective divisor, so also −D′|E deﬁnes an eﬀective divisor class. By repeating
this argument for any E, we conclude that D′ is also π-antieﬀective and satisﬁes D′ 6 D1
and D′ 6 D2, contradicting the minimality in D of D1 and D2.

Finally, since D0 − D is supported on the exceptional locus of π, where D0 is the divisor
constructed above, the same holds for ˜D − D, where ˜D is the unique minimal element of
D.
(cid:3)

The following result tells us how to ﬁnd equivalent divisors.

Proposition 3.7. Let D be a divisor on Y and E an exceptional divisor of π.
H 0(E, OY (−D)|E) = 0, then

If

π∗OY (−D − E) = π∗OY (−D) .

Proof. Denote by ι : E → Y the embedding of E in Y . Consider the short exact sequence

0 → OY (−E) → OY → ι∗OE → 0 .

After tensoring with OY (−D) and pushing forward through π, we get the exact sequence

(3.1)

0 → π∗OY (−D − E) → π∗OY (−D) → π∗(ι∗OE ⊗OY OY (−D)) .

i , d2

−D′|E = −d1

i Ei and D2 = Pi d2
EE|E − XEi6=E

diEi|E .

10

H. BAUMERS AND F. DACHS-CADEFAU

By the projection formula, we know that

ι∗OE ⊗OY OY (−D) = ι∗(OE ⊗OE ι∗OY (−D))

= ι∗ι∗OY (−D) .

Denote the image of E through π by C, and name the morphisms as follows.

E

ι−−−→ Y

π′=π|Ey

C

πy

ιC−−−→ X

∗ι∗OY (−D). Since OY (−D) is
Then we obtain that the last sheaf in (3.1) equals ιC∗π′
invertible, we know that π′
∗ι∗OY (−D) is a quasi-coherent OC-module (see [Har77, Propo-
sition II.5.8]). Hence, since C is aﬃne, this OC-module is determined by its global sections.
Since by assumption ι∗OY (−D) has no global sections, also ιC∗π′
∗ι∗OY (−D) has no global
sections so we conclude that the sheaf equals to the zero sheaf. Hence by (3.1),

π∗OY (−D − E) = π∗OY (−D) .

(cid:3)

This result gives a constructive way to ﬁnd the π-antieﬀective closure of a divisor D,
called the unloading procedure. It goes as follows. Let D be a non-π-antieﬀective divi-
sor. Then there exists at least one π-exceptional divisor E such that H 0(E, OY (−D)|E) =
0. We replace D by D′ := D + E and repeat until the obtained divisor is π-antieﬀective.
Note that we cannot accidentally ‘miss’ the π-antieﬀective closure by chosing a speciﬁc
order, since the order of adding Ei’s does not matter. Indeed, if −D|E1 and −D|E2 are
both not linearly equivalent to an eﬀective divisor, then −(D + E1)|E2 = −D|E2 − E1|E2 is
not an eﬀective divisor class either, so E2 still has to be added somewhere in the process.
Therefore, we obtained the following proposition.

Proposition 3.8. Let D be a divisor, then after ﬁnitely many steps of unloading we reach
the π-antieﬀective closure of D.

Together with the fact that we only encounter equivalent divisors during the unloading

procedure, this ﬁnishes the proof of Theorem 3.4.

Our unloading procedure is based on work of Enriques in [EC15]. It is also Laufer’s
It has also been described by
algorithm to compute the fundamental cycle [Lau72].
Casas-Alvero [CA00] and Reguera [Reg97]. An improved version of it is used in [AAD14]
to compute jumping numbers on surfaces with rational singularities. Here, we generalized
the algorithm in [Lau72] to higher dimensions. The main diﬀerence is that checking
positivity of an intersection number is replaced by checking eﬀectivity of a divisor class.
In Section 4, the unloading procedure will be used in an algorithm to compute jumping
numbers.

11

3.2. A correspondence between globally generated invertible sheaves and in-
tegrally closed ideals. The main goal of this section is to generalize the results of
Lipman about the correspondence between integrally closed ideals and antinef divisors
(see [Lip69, §18]). Lipman proves that in the two-dimensional case there is a one-to-
one correspondence between antinef divisors and m-primary integrally closed ideals that
determine invertible sheaves on Y .

A ﬁrst generalization of this result to higher dimensions is [CGL96, Proposition 1.20]. In
this paper, the authors prove a similar relation between ﬁnitely supported integrally closed
ideals and globally generated divisors on varieties obtained by ﬁnitely many point blow-
ups. They also prove that if −D is globally generated, then −D·C > 0 for any exceptional
curve C, as well as a counterexample for the reverse implication in dimensions higher than
2. We will prove a similar relation, which works for ideals that are not necessarily ﬁnitely
supported, but which determine an invertible sheaf in a ﬁxed birational morphism. The
proof is essentially the same as the corresponding part of Lipman’s proof in the two-
dimensional setting. We repeat it here for completeness.

Theorem 3.9. The mapping D 7→ ID = Γ(Y, OY (−D)) is a one-to-one correspondence
between the set of eﬀective divisors D on Y such that OY (−D) is generated by its global
sections, and integrally closed ideals I of R such that I · OY is an invertible sheaf. The
inverse is given by I 7→ DI, where DI is the divisor satisfying I · OY = OY (−DI ).

Proof. If D is an eﬀective divisor, then D = Pi diEi, where Ei runs over all prime

divisors on Y . Moreover, di > 0 for all i, and di = 0 for all but ﬁnitely many i. We have
OY (−D) ⊆ OY , and hence

ID = Γ(Y, OY (−D)) ⊆ Γ(Y, OY ) = R .

So ID is an ideal of R. Moreover, since OY (−D) is generated by its global sections,
ID · OY = OY (−D) is invertible.

Now we prove that ID is integrally closed. It is clear that

ID = {f ∈ R | ∀i : νi(f ) > di} ,

where νi is the divisorial valuation corresponding to Ei. Take f ∈ R and suppose f
satisﬁes an equation

f n + a1f n−1 + · · · + an−1f + an = 0 ,

where aj ∈ (ID)j for j = 1, . . . , n. Then for any i the properties of valuations yield

nνi(f ) > min

j

{νi(aj) + (n − j)νi(f )} .

So there exists j0 ∈ {1, . . . , n} such that

nνi(f ) > νi(aj0) + (n − j0)νi(f ) ,

and hence j0νi(f ) > νi(aj0) > j0di, meaning that f ∈ ID. This implies that ID is integrally
closed.

Conversely, take an integrally closed ideal I such that I · OY is invertible. Then DI
is such that I · OY = OY (−DI), so OY (−DI) is clearly generated by its global sections.

12

H. BAUMERS AND F. DACHS-CADEFAU

Indeed, a set of generators of I determines global sections of I · OY , and their restrictions
generate the stalks.

By [Lip69, Proposition 6.2], IDI = Γ(Y, OY (−DI)) = I, since I is integrally closed.
Conversely, if OY (−D) is generated by its global sections, then OY (−D) = ID · OY , and
also ID · OY = OY (−DID ), which implies DID = D.
(cid:3)

In our setting we are interested in the relation between π-antieﬀective divisors and
integrally closed ideals. However, no one-to-one correspondence between them is known.
We do know that the set of π-antieﬀective divisors contains the set of divisors associated
to an integrally closed ideal.

Proposition 3.10. If OY (−D) is generated by global sections, then D is π-antieﬀective.

Proof. Let E ⊂ Y be an exceptional divisor, and denote ι : E → Y and L = OY (−D).
We have to show that H 0(E, ι∗L) 6= 0. Since L is globally generated, there exists an exact
sequence

of sheaves on Y . Pulling back by ι, we get an exact sequence

0 → K → Om

Y → L → 0

ι∗K → Om

E → ι∗L → 0

on E, so ι∗L is also generated by its global sections. In particular, H 0(E, ι∗L) 6= 0.

(cid:3)

The converse of the previous proposition is true in dimension 2 (see [Lip69, §18]), but
in higher dimensions it does not hold anymore, as is clear from the following example,
which is inspired heavily on Remark 1.24 in [CGL96].

Example 3.11. Let X = Spec R be a smooth aﬃne three-dimensional variety. Consider
the blowing-up at a point 0 on X, followed by blowing up at nine points on the exceptional
divisor E0 in general position. This means that they lie on a non-singular cubic curve C0,
and that C0 is the only cubic curve on E0 passing through these nine points. Denote the
new exceptional divisors by E1, . . . E9, and the morphism by π : Y → X. We will show
i=1 Ei is π-antieﬀective, but that OY (−D) is not generated by its

that D := 3E0 + 4P9

global sections.

Since −D|E0 is linearly equivalent to the strict transform of the curve C0, it is eﬀective
in Pic E0. Furthermore, −D|Ei for i ∈ {1, . . . , 9} is the class of a line on Ei, hence is also
eﬀective in Pic Ei. So we see that D is π-antieﬀective.

If OY (−D) would be globally generated, then also its restriction to E0 should be globally
generated, as is clear from the proof of Proposition 3.10. But this is the sheaf deﬁned by
the strict transform of the curve C0. Since this is the only cubic curve on P2 through the
nine points, this divisor cannot be moved, and hence the sheaf is not globally generated.

4. An algorithm to compute jumping numbers

In this section, we discuss a technique that can be used to compute jumping numbers,
based on the algorithm of Alberich-Carrami˜nana, `Alvarez Montaner and the second author
described in [AAD14].

ei (cid:12)(cid:12)(cid:12)
minn ki+1

will be

(4.1)

where Dλ =Pi∈I eλ

min(cid:26) ki + 1 + eλ

ei

i

i ∈ I(cid:27) ,

(cid:12)(cid:12)(cid:12)(cid:12)

i Ei is the π-antieﬀective closure of ⌊λF ⌋ − Kπ.

4.1. Computation of supercandidates. We will construct a set S ⊂ Q that contains
all the jumping numbers, but is in general much smaller than the set of candidate jumping
numbers. Following [AAD14], we work as follows. Let S be the empty set. One by
one, we will add numbers to this set. First, we add the log canonical threshold λ1 =

i ∈ Io to S. Assume that we added the value λ, then the next value we add

13

Deﬁnition 4.1. The elements of the set S are called supercandidates.

Following Deﬁnition 4.3 in [AAD14], we deﬁne the minimal jumping divisor.

Deﬁnition 4.2. If λ is a supercandidate, then the minimal jumping divisor associated
to λ is the reduced divisor Gλ, supported on those components Ei where the minimum in
(4.1) is reached.

Remark 4.3. The name minimal jumping divisor is in contrast to the maximal jumping
divisor, which is the reduced divisor supported on all the Ei for which λ is a candidate.
We will not use this notion in this paper.

Theorem 4.4. All jumping numbers are supercandidates.

Proof. Suppose λ is a jumping number, which is not a supercandidate. Let λ′ be the
largest supercandidate smaller than λ. Note that this λ′ always exists since lct(X, a) is
a supercandidate smaller than λ, and the supercandidates are a discrete set. Then λ

is strictly smaller then the supercandidate following λ′, i.e., λ < minn ki+1+eλ′
where Dλ′ =Pi∈I eλ′

is the π-antieﬀective closure of ⌊λ′F ⌋ − Kπ. But then

−Dλ′ 6 Kπ − ⌊λF ⌋ 6 Kπ − ⌊λ′F ⌋ ,

ei

i

i

i ∈ Io,

(cid:12)(cid:12)(cid:12)

and hence1

J (X, aλ) = J (X, aλ′

) ,

contradicting the fact that λ is a jumping number.

(cid:3)

Remark 4.5. Note that we cannot conclude as in [AAD14] that every supercandidate is
a jumping number, since there is no correspondence between π-antieﬀective divisors and
integrally closed ideals in higher dimensions. However, no examples are known where not
all supercandidates are actual jumping numbers.

In the next subsection, we discuss some techniques to check whether supercandidates

are jumping numbers.

1Indeed, if D1 6 D2, then OY (D1) ⊆ OY (D2), pushing forward preserves inclusion, and Dλ′ and ⌊λ′F ⌋ −
Kπ are equivalent.

14

H. BAUMERS AND F. DACHS-CADEFAU

4.2. Checking supercandidates. Once we have our supercandidates, we have to check
whether they are actual jumping numbers. An important tool is the following proposition.

Proposition 4.6. If λ is a jumping number, then Gλ contributes λ. In particular, there
is a divisor G critically contributing λ, satisfying G 6 Gλ. Moreover, if λ′ is the super-
candidate previous to λ, we have

π∗OY (Kπ − ⌊λF ⌋ + Gλ) = J (aλ′

) .

Kπ − ⌊λF ⌋ + Gλ > −Dλ′. In fact, for any ﬁxed Ei, one has by formula (4.1) that

i Ei be the π-antieﬀective closure of ⌊λ′F ⌋ − Kπ. We claim that

Proof. Let Dλ′ =Pi∈I eλ′

so

λ 6

ki + 1 + eλ′
i

ei

,

ki − λei + 1 > −eλ′
i

.

If Ei 6 Gλ, this is an equality. Otherwise the inequality is strict, and then, since −eλ′
i
an integer, after rounding up we get

is

⌈ki − λei + 1⌉ > −eλ′

i + 1 ,

and hence

ki − ⌊λei⌋ > −eλ′
i
We conclude that indeed Kπ − ⌊λF ⌋ + Gλ > −Dλ′.

.

Note that also Kπ − ⌊λF ⌋ + Gλ 6 Kπ − ⌊λ′F ⌋, because λ is a candidate for Gλ, and

hence

π∗OY (−Dλ′) ⊆ π∗OY (Kπ − ⌊λF ⌋ + Gλ) ⊆ π∗OY (Kπ − ⌊λ′F ⌋) .

By Theorem 3.4, all these ideals must be the same, and equal to J (aλ′). Since λ is a
jumping number, we can conclude that

J (aλ)   π∗OY (Kπ − ⌊λF ⌋ + Gλ) ,

so Gλ contributes λ.

In particular, there exists a G 6 Gλ critically contributing λ.

(cid:3)

Remark 4.7. Here it is important to notice that Gλ is not necessarily connected, unlike
the critically contributing divisors (see Corollary 2.14).

So in order to check whether a supercandidate λ is a jumping number, it suﬃces to
check whether some G 6 Gλ contributes λ. By Corollary 2.14, we know that if we can
ﬁnd such a G, we can even ﬁnd a connected one.

The following proposition shows that a supercandidate is a jumping number if its min-

imal jumping divisor has an irreducible connected component.

Proposition 4.8. If λ is a supercandidate such that Gλ has a connected component that
is irreducible, then λ is a jumping number.

Proof. From the proof of the previous proposition, using the same notations, we see that

15

Kπ − ⌊λF ⌋ + Gλ = −Dλ′ + XEi66Gλ

aiEi ,

where ai > 0. So for E 6 Gλ we have

(Kπ − ⌊λF ⌋ + Gλ)|E = −Dλ′|E + XEi66Gλ

ai Ei|E ,

which is eﬀective in Pic E because Dλ′ is π-antieﬀective and E is diﬀerent from the Ei
that appear in the sum.

Now if E is an irreducible connected component of Gλ, we have

(Kπ − ⌊λF ⌋ + Gλ)|E = (Kπ − ⌊λF ⌋ + E)|E ,

so the fact that this divisor is eﬀective implies by Propositon 2.12 that λ is a jumping
number contributed by E.
(cid:3)

So if Gλ has an irreducible connected component, there is nothing to check anymore.
This is actually a very important case, since in general many supercandidates have an
irreducible minimal jumping divisor. In the other case, it would suﬃce to check whether
Gλ contributes λ as a jumping number. However, in practice, this seems to be hard.
Therefore, we suggest the following approach, which is more likely to work. Start by
checking contribution by an irreducible E 6 Gλ. This can be done using Proposition
2.12, if we have enough understanding of Pic E. If this does not give a positive answer,
check the connected G 6 Gλ consisting of two irreducible components, and proceed in
this manner up to the maximal connected divisors G 6 Gλ. As soon as we ﬁnd a G 6 Gλ
contributing λ, we know that λ is a jumping number. If there is no such (connected) G,
λ is not a jumping number.

If G is reducible it is not very clear how to check whether it contributes a supercandidate

λ as a jumping number. However, we have some tools that can be useful.

Proposition 4.9. Suppose that λ is a supercandidate, such that λ is a candidate for
∼= OEi for i ∈ {1, 2}. Then OY (Kπ −
G = E1 + E2. Suppose that OY (Kπ − ⌊λF ⌋ + G)|Ei
⌊λF ⌋ + G)|G

∼= OG, and hence λ is a jumping number contributed by E1 + E2.

Proof. By Corollary 2.14, we can assume that E1 and E2 intersect transversally. Then by
the following lemma, we see that

OY (Kπ − ⌊λF ⌋ + G)|G

∼= OG,

and hence H 0(G, OY (Kπ − ⌊λF ⌋ + G)|G) 6= 0. By Proposition 2.12, this means that G
contributes λ as a jumping number.
(cid:3)

Lemma 4.10. Let G = E1 ∪ E2 be a closed reducible connected subvariety of a variety Y
such that E1 and E2 intersect transversally, and D := E1 ∩ E2 is connected. Let L be a
sheaf of OY -modules such that L|Ei

∼= OEi for i ∈ {1, 2}. Then L|G

∼= OG.

16

H. BAUMERS AND F. DACHS-CADEFAU

Proof. Consider the short exact sequence

0 → OG → OE1 ⊕ OE2 → OD → 0

on G. Here we consider sheaves OE, where E is equal to E1, E2 or D, as a sheaf on G
by the pushforward through the inclusion morphism E ⊂ G. After tensoring with the
restriction of L to G, we get

0 → L|G → L|E1 ⊕ L|E2 → L|D → 0.

To compute the second and third term, we used the projection formula: if ι : E → G is the
inclusion, where E is again equal to E1, E2 or D, then ι∗OE ⊗OG L|G = ι∗(OE ⊗OE L|E) =
ι∗L|E.

By assumption, there are isomorphisms φi : OEi → L|Ei for i ∈ {1, 2}, and restricting
D ◦ φ2|D is an automorphism of
D) = k∗. Composing

to D gives isomorphisms φi|D : OD → L|D. Hence φ1|−1
OD, so it corresponds to multiplication with an element c ∈ Γ(D, O∗
φ1 with multiplication with this constant yields φ1|D = φ2|D.

This means that we have a commutative diagram

0 −−−→ OG −−−→ OE1 ⊕ OE2 −−−→ OD −−−→ 0

0 −−−→ L|G −−−→ L|E1 ⊕ L|E2 −−−→ L|D −−−→ 0.

φ1⊕φ2y

φDy

Then we see that L|G must be isomorphic to OG, since they are the kernel of the same
morphism.
(cid:3)

Remark 4.11. The condition in Proposition 4.9 seems quite special, but it is the gener-
alization of the analogous result in the two-dimensional case ([Tuc10, Proposition 4.1]).
Moreover, we did not spot any other behaviour in concrete examples.

Proposition 4.12. If G = E1 + · · · + Em is a connected divisor critically contributing λ
as a jumping number, then

H 0(Ei, OY (Kπ − ⌊λF ⌋ + G)|Ei) 6= 0

for all i ∈ {1, . . . , m}.

Proof. It suﬃces to prove the statement for E1. Denote G′ = E2+· · ·+Em, and D = E1|G′.
Then we have a short exact sequence

0 → OG′(−D) → OG → OE1 → 0.

As before, we consider all the sheaves as sheaves on G by the pushforward. After tensoring
with OY (Kπ − ⌊λF ⌋ + G)|G, we get

0 → OY (Kπ − ⌊λF ⌋ + G′)|G′ → OY (Kπ − ⌊λF ⌋ + G)|G

→ OY (Kπ − ⌊λF ⌋ + G)|E1 → 0,

17

and taking global sections gives

0 → H 0(G′, OY (Kπ − ⌊λF ⌋ + G′)|G′) → H 0(G, OY (Kπ − ⌊λF ⌋ + G)|G)

→ H 0(E1, OY (Kπ − ⌊λF ⌋ + G)|E1

Since G contributes critically, H 0(G′, OY (Kπ − ⌊λF ⌋ + G′)|G′) = 0 and H 0(G, OY (Kπ −
⌊λF ⌋ + G)|G) 6= 0. Therefore

H 0(E1, OY (Kπ − ⌊λF ⌋ + G)|E1) 6= 0,

which proves the proposition.

(cid:3)

Remark 4.13. This proposition can be used to decide that a divisor G 6 Gλ does not
contribute λ as a jumping number.

Remark 4.14. Our algorithm does not work in general, since we need to have enough
understanding of the Picard groups of the exceptional divisors, and it is not always clear
how to check the existence of global sections of sheaves on reducible varieties. However, it
appears to be not realistic to develop a practical algorithm in full generality, since there
is a wide range of possible singularities. Nonetheless, our technique seems to suﬃce in
many situations.

Remark 4.15. One could also determine the jumping numbers by computing all the
candidate jumping numbers, and checking whether they are jumping numbers or not.
This can be done by checking whether they are contributed by some divisor for which
they are a candidate. However, our algorithm is more eﬃcient in general, since if there are
many exceptional divisors in a resolution, the set of candidate jumping numbers is much
bigger than the set of supercandidates. Moreover, the minimal jumping divisor can be
much smaller than the maximal one, which reduces the amount of possible contributing
divisors. Also, Proposition 4.8 implies that several supercandidates do not need to be
checked anymore.

On the other hand, algorithms as [BL10] and [Shi11] have to pass by computations of

generalized Bernstein-Sato polynomials, which is not easy in general.

5. Examples

5.1. Example 1. Let D be the germ of the surface given by x(yz − x4)(x4 + y2 − 2yz) +
yz4 − y5 = 0 in the local ring at the origin in A3. We consider an embedded resolution
given by six point blow-ups. We start by blowing up at the origin. Then we blow up
at the singular point of the strict transform of D.
In a third step we blow up at the
singular point of the strict transform of D on the intersection of E1 and E2, followed by
the intersection point of E2, E3 and the strict transform of D. The last step consists of
blowing up at the two remaining singular points.
Denoting the resolution by π : Y → X, we have

Kπ = 2E1 + 4E2 + 8E3 + 14E4 + 6E5 + 6E6

and

F = π∗D = Daf f + 5E1 + 9E2 + 16E3 + 27E4 + 11E5 + 11E6.

18

H. BAUMERS AND F. DACHS-CADEFAU

All the exceptional divisors are projective planes, blown up at at most 4 additional points,
so one can completely understand their Picard groups and eﬀective cones. Applying the
algorithm of section 4, we ﬁnd the following supercandidates and their minimal jumping
divisors.

Gλ

E2 + E4
E2 + E4

λ
5
9
2
3
20
27
7
9
23
27
8
9
25
27
26
27
1 E1 + E2 + E3 + E4 + E5 + E6 + Daf f .

E2 + E4

E2 + E4

E4

E4

E4
E4

We verify one supercandidate to illustrate the algorithm. It is easy to see that lct(X, D) =

5

9. We have to compute the π-antieﬀective closure of (cid:4) 5

First, note that E1 is isomorphic to P2 blown up at two additional points, the second
one inﬁnitely near to the ﬁrst one. As generators of the Picard group, we denote the
pullback of a line by ℓ, the pullback of the ﬁrst exceptional curve by e1, and the second
exceptional curve by e2. Then −(E2 + E4)|E1 = −e1 + e2, which is not eﬀective. Hence,
in the next step of the unloading, we consider E1 + E2 + E4.

9 F(cid:5) − Kπ = E2 + E4.

Now we see that E3 is isomorphic to P2 blown up at one point.

If we denote the
generators of the Picard group by ℓ (pullback of a line) and e (the exceptional curve), we
ﬁnd −(E1 + E2 + E4)|E3 = −2ℓ. Since E3|E3 = −ℓ−e, we see that we need to add E3 twice
to achieve an eﬀective divisor on E3. So in the next step, we consider E1 + E2 + 2E3 + E4.
Continuing in this manner, we add E4 twice, E5 and E6, and we can check that the
obtained divisor E1 + E2 + 2E3 + 3E4 + E5 + E6 is π-antieﬀective. This implies that the
next supercandidate is

min(cid:26)0 + 1 + 0

1

,

2 + 1 + 1

5

,

4 + 1 + 1

9

,

8 + 1 + 2

16

,

14 + 1 + 3

27

,

6 + 1 + 1

11

(cid:27) =

6
9

=

18
27

=

2
3

,

and this minimum is achieved for the terms coming from E2 and E4.

All the supercandidates with irreducible minimal jumping divisor are jumping numbers
contributed by E4, by Proposition 4.8. For the numbers 7
9 , one can see that
(Kπ −⌊λF ⌋+E2)|E2 is eﬀective, so these numbers are jumping numbers contributed by E2.
One can check that the supercandidates λ = 5
3 are not contributed by a single
exceptional divisor. However, for these numbers, we have (Kπ − ⌊λF ⌋ + E2 + E4)|Ei = 0
in Pic Ei for i ∈ {2, 4}, so, by Proposition 4.9, they are jumping numbers contributed

9 and λ = 2

9 and 8

19

by E2 + E4. Note that in fact we didn’t need to check whether 5
9 is a jumping number,
since this is the log canonical threshold. Finally, since we are in the case of a divisor, 1 is
always a jumping number.

Existing implemented algorithms ([BL10]) did not give a result after several days of

computation.

5.2. Example 2. In this example we show that we don’t need to understand the Picard
groups and eﬀective cones of all exceptional divisors completely in order to compute the
jumping numbers.

Take X = Spec C[x, y, z](x,y,z) and D the zero locus of

(xd + yd + zd)2 + g(x, y, z),

with d > 3 and g(x, y, z) a generic homogeneous polynomial of degree 2d + 1.

In the ﬁrst step of the resolution, we blow up at the origin of X. We denote the
exceptional divisor by E1. Step 2 consists in blowing up at k = d(2d + 1) singular points
of the strict transform of D; the exceptional divisors are denoted by Ep
i . In step 3, we
blow up at C, the intersection of E1 and Daf f . This is a curve of genus g = 1
2(d−1)(d−2).
The exceptional divisor is denoted by E2. The ﬁnal step of the resolution is blowing up
at the intersection of E1, E2 and Daf f , which is also isomorphic to C. We denote the
exceptional divisor by E3. We denote the composition of these blow-ups by π : Y → X.
We have

π∗D = Daf f + 2dE1 + (2d + 2)

k

k

Xi=1

Ep

i + (2d + 1)E2 + (4d + 2)E3,

Kπ = 2E1 + 4

Ep

i + 3E2 + 6E3.

Xi=1

In order to compute the jumping numbers using the unloading procedure, we need
to know the mutual intersections of all components of π∗D in the Picard groups of the
exceptional divisors, as well as the self-intersections of the exceptional divisors, and we
need to determine when a divisor of the form

− a1E1 + ap

k

Xi=1

Ep

i + a2E2 + a3E3!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)E

is eﬀective in Pic E, where E varies over all the exceptional divisors. (Note that we take
one coeﬃcient for all the Ep
i , since everything we will encounter will be symmetrical in
the Ep
i .) In order to do this, we have to know more about the exceptional divisors. The
divisor E1 ⊂ Y is a projective plane, blown up at k = d(2d + 1) additional points. The
Ep
i are projective planes, blown up at two additional points, the second center lying on
the exceptional curve of the ﬁrst blow-up. The divisors E2 and E3 are ruled surfaces over
C.

We show how we can obtain conditions on the aj from the information on E3. The

other exceptional divisors are treated similarly.

20

H. BAUMERS AND F. DACHS-CADEFAU

Since E3 is a ruled surface over C, its Picard group equals Z ⊕ p∗(Pic C), where Z is
generated by a section, say C ′. Here p denotes the canonical morphism E3 → C. It is not
obvious to give a complete description of the eﬀective cone, but we know that aC ′ + p∗d
is eﬀective if a > 0 and d is eﬀective, or if a > 0 and deg d > d − 2 (in fact the ﬁrst one
suﬃces for our purposes), and that it is not eﬀective if a < 0. It will turn out that this is
enough information. We denote

E1|E3 = C1,
Ep
i |E3 = fi,
E2|E3 = C2,
Daf f |E3 = C0,

where all of the Cj’s are sections, and the fi are ﬁbres. From [Vey91, Proposition 2.1] we
know that

(4d + 2)E3|E3 = −Daf f |E3 − 2dE1|E3 − (2d + 2)

Ep

i |E3 − (2d + 1)E2|E3

k

Xi=1

= −C0 − 2dC1 − (2d + 2)

k

Xi=1

fi − (2d + 1)C2.

In order to have more information about the self-intersection of E3, we compute the
pullbacks of some additional divisors. First, if D1 is the divisor given by the zero locus of
i + (2d + 1)E3.
Analogously, for a generic plane H through the origin, we have π∗H = Haf f + E1 + E2 +
i + 2E3. Since D1,af f does not intersect E3, and Haf f intersects E3 in d ﬁbers, we

xd + yd + zd, we see that π∗D = D1,af f + dE1 + (d + 1)E2 + (d + 1)Pk
Pk

i=1 Ep

i=1 Ep

ﬁnd

(2d + 1)E3|E3 = −dC1 − (d + 1)C2 − (d + 1)

k

d

fi,

k

Xi=1

fi −

f ′
j,

2E3|E3 = −C1 − C2 −

Xi=1
i=1 fi − (2d + 1)Pd
j are ﬁbres. One easily veriﬁes that Pk

where the f ′
j = 0 in Pic E3,
since it is the pullback of the principal divisor on C deﬁned by the rational function g
ℓ2d+1 ,
where ℓ is the linear polynomial deﬁning H. (We considered the curve C embedded in the
projective plane E1, before the other blow-ups, with its standard coordinates.) From this
observation, together with the equalities above, one can conclude that C0 = C1 = C2 in
j is the pullback of adivisor of degree

Xj=1

j=1 f ′

j=1 f ′

Pic E3 and hence that E3|E3 + C1 = −(d + 1)Pd

−d(d + 1).

So the remarks about the eﬀective divisors on E3 above yield that a divisor

21

− a1E1 + ap

k

Xi=1

Ep

i + a2E2 + a3E3!(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)E3

is eﬀective if a3 > a1 + a2 and (d + 1)a3 > (2d + 1)ap, and that it is not eﬀective if
a3 < a1 + a2.

A similar analysis on the other divisors yields the following conclusions. For E1 we

obtain suﬃcient conditions

(cid:26) (2d + 1)a1 > da3,

(d + 1)a1 > dap,

the ﬁrst of which is a necessary condition.

For the Ep

i we obtain suﬃcient and necessary conditions

The exceptional divisor E2 is also a ruled surface. Here we have suﬃcient conditions

ap > a1,
ap > a2,
2ap > a3.



(cid:26) 2a2 > a3,

2(d + 1)a2 > (2d + 1)ap,

the ﬁrst of which is necessary.

All together, this gives the following set of suﬃcient conditions for a divisor

 a1E1 + ap

k

Xi=1

Ep

i + a2E2 + a3E3!

to be π-antieﬀective:

a1 6

1
2

a3 6 a2 6 ap

a3 6 2a1 +

a3 > a1 + a2
1
d
1
d

ap 6 a1 +

a1

a1

ap < a2 +

2ap < a3 +

1

2d + 1

1

2d + 1

a2

a3.




The ﬁrst three inequalities are necessary.

Proposition 5.1. In this example, the set of jumping numbers in (0, 1] is

A := A1 ∪ A2 ∪ A3,

22

where

H. BAUMERS AND F. DACHS-CADEFAU

A1 =n n
2d(cid:12)(cid:12)(cid:12)
3 6 n < do ,
4d + 2 (cid:12)(cid:12)(cid:12)(cid:12)
d 6 n 6 2d(cid:27) ,
A2 =(cid:26) 2n + 1
A3 =n n
2d(cid:12)(cid:12)(cid:12)
d + 3 6 n 6 2do .

Proof. Since d > 3, the log canonical threshold is

λ1 = min(cid:26) 3

2d

,

5

2d + 2

,

4

2d + 1

,

7

4d + 2

, 1(cid:27) =

3
2d

.

This is indeed the minimal value in A. Moreover, Gλ1 = E1 if d > 3, and E1 + E3 if d = 3,
in which case λ1 = 1
2.

The rest of the proof goes by inductively computing the next supercandidates. Given
a supercandidate λ in one of the three sets, we compute ⌊λπ∗D⌋ − Kπ, and we unload
using the set of necessary and suﬃcient conditions on the coeﬃcients given above. Then
the formula (4.1) gives the next supercandidate.

We treat the case where λ ∈ A1 to show how the proof works. The other cases are

similar. Suppose we know that λ = n

2d is a supercandidate, where 3 6 n < d. We have

⌊λπ∗D⌋ − Kπ = (n − 2)E1 + (n − 4)

Ep

i + (n − 3)E2 + (2n − 6)E3.

k

Xi=1

Using the conditions for π-antieﬀective divisors described above, we ﬁnd that the π-
antieﬀective closure is

(n − 2)E1 + (n − 2)

Then the next supercandidate is

Ep

i + (n − 2)E2 + (2n − 4)E3.

k

Xi=1

λ′ = min(cid:26) n + 1

2d

,

n + 3
2d + 2

,

n + 2
2d + 1

,

2n + 3
4d + 2

, 1(cid:27) =

n + 1

2d

,

which is indeed the next value in A.

For the minimal jumping divisor, we have

2 or λ = 1,

E1 + E3 if λ = 1
E1 if λ ∈ A1 or A3,
E3 otherwise.

Gλ =


By Proposition 4.8 and checking that (cid:0)Kπ −(cid:4) 1

supercandidates are jumping numbers contributed by E1 or E3.

2 π∗D(cid:5) + E3(cid:1)(cid:12)(cid:12)E3

is eﬀective in Pic E3, all
(cid:3)

References

23

[AAD14] Maria Alberich-Carrami˜nana, Josep Alvarez Montaner, and Ferran Dachs-Cadefau, Mul-
local rings with rational singularities, ArXiv e-prints,

tiplier ideals in two-dimensional
arXiv:1412.3605 (to appear in Michigan Math. J.) (2014).
Christine Berkesch and Anton Leykin, Algorithms for Bernstein-Sato polynomials and multi-
plier ideals, ISSAC 2010—Proceedings of the 2010 International Symposium on Symbolic and
Algebraic Computation, ACM, New York, 2010, pp. 99–106. MR 2920542
Eduardo Casas-Alvero, Singularities of plane curves, London Mathematical Society Lecture
Note Series, vol. 276, Cambridge University Press, Cambridge, 2000.

[BL10]

[CA00]

[CGL96] Antonio Campillo, G´erard Gonzalez-Sprinberg, and Monique Lejeune-Jalabert, Clusters of

[EC15]

inﬁnitely near points, Math. Ann. 306 (1996), no. 1, 169–194. MR 1405323 (97k:14004)
Federigo Enriques and Oscar Chisini, Lezioni sulla teoria geometrica delle equazioni e delle
funzioni algebriche, N. Zanichelli, 1915.

[ELSV04] Lawrence Ein, Robert Lazarsfeld, Karen E. Smith, and Dror Varolin, Jumping coeﬃcients of

[EV92]

[FJ05]

multiplier ideals, Duke Math. J. 123 (2004), no. 3, 469–506.
H´el`ene Esnault and Eckart Viehweg, Lectures on vanishing theorems, DMV Seminar, vol. 20,
Birkh¨auser Verlag, Basel, 1992.
Charles Favre and Mattias Jonsson, Valuations and multiplier ideals, J. Amer. Math. Soc. 18
(2005), no. 3, 655–684.

[Har77] Robin Hartshorne, Algebraic geometry, Springer-Verlag, New York, 1977, Graduate Texts in

[Hir64]

[How01]

[Kol97]

Mathematics, No. 52.
Heisuke Hironaka, Resolution of singularities of an algebraic variety over a ﬁeld of character-
istic zero. I, II, Ann. of Math. (2) 79 (1964), 109–203; ibid. (2) 79 (1964), 205–326.
Jason A. Howald, Multiplier ideals of monomial ideals, Trans. Amer. Math. Soc. 353 (2001),
no. 7, 2665–2671.
J´anos Koll´ar, Singularities of pairs, Algebraic geometry—Santa Cruz 1995, Proc. Sympos.
Pure Math., vol. 62, Amer. Math. Soc., Providence, RI, 1997, pp. 221–287. MR 1492525
(99m:14033)

[Lau72] Henry B. Laufer, On rational singularities, Amer. J. Math. 94 (1972), 597–608. MR 0330500

[Laz04]

[Lib83]

[Lip69]

[LL07]

[LV90]

[LW03]

(48 #8837)
Robert Lazarsfeld, Positivity in algebraic geometry. II, Ergebnisse der Mathematik und ihrer
Grenzgebiete., vol. 49, Springer-Verlag, Berlin, 2004.
Anatoly S. Libgober, Alexander invariants of plane algebraic curves, Singularities, Part 2
(Arcata, Calif., 1981), Proc. Sympos. Pure Math., vol. 40, Amer. Math. Soc., Providence, RI,
1983, pp. 135–143. MR 713242 (85h:14017)
Joseph Lipman, Rational singularities, with applications to algebraic surfaces and unique fac-
torization, Inst. Hautes ´Etudes Sci. Publ. Math. (1969), no. 36, 195–279. MR 0276239 (43
#1986)
Robert Lazarsfeld and Kyungyong Lee, Local syzygies of multiplier ideals, Invent. Math. 167
(2007), no. 2, 409–418.
Fran¸cois Loeser and Michel Vaqui´e, Le polynˆome d’Alexander d’une courbe plane projective,
Topology 29 (1990), no. 2, 163–173. MR 1056267 (91d:32053)
Joseph Lipman and Kei-ichi Watanabe, Integrally closed ideals in two-dimensional regular local
rings are multiplier ideals, Math. Res. Lett. 10 (2003), no. 4, 423–434.

[Reg97] Ana-Jos´e Reguera, Curves and proximity on rational surface singularities, J. Pure Appl. Al-

[Shi11]

gebra 122 (1997), no. 1-2, 107–126. MR 1479350 (99g:14046)
Takafumi Shibuta, Algorithms for computing multiplier ideals, J. Pure Appl. Algebra 215
(2011), no. 12, 2829–2842.

24

[ST07]

H. BAUMERS AND F. DACHS-CADEFAU

Karen E. Smith and Howard M. Thompson, Irrelevant exceptional divisors for curves on a
smooth surface, Algebra, geometry and their interactions, Contemp. Math., vol. 448, Amer.
Math. Soc., Providence, RI, 2007, pp. 245–254.

[Tuc09] Kevin Tucker, Integrally closed ideals on log terminal surfaces are multiplier ideals, Math. Res.

Lett. 16 (2009), no. 5, 903–908. MR 2576706 (2011c:14055)

[Tuc10]

, Jumping numbers on algebraic surfaces with rational singularities, Trans. Amer. Math.

Soc. 362 (2010), no. 6, 3223–3241.

[Vaq92] Michel Vaqui´e, Irr´egularit´e des revˆetements cycliques des surfaces projectives non singuli`eres,

Amer. J. Math. 114 (1992), no. 6, 1187–1199. MR 1198299 (94d:14015)

[Vaq94]

, Irr´egularit´e des revˆetements cycliques, Singularities (Lille, 1991), London Math.
Soc. Lecture Note Ser., vol. 201, Cambridge Univ. Press, Cambridge, 1994, pp. 383–419.
MR 1295085 (95f:14030)

[Vey91] Willem Veys, Congruences for numerical data of an embedded resolution, Compositio Math.

80 (1991), no. 2, 151–169. MR 1132091 (93d:14027)

KU Leuven, Department of Mathematics, Celestijnenlaan 200B box 2400, BE-3001 Leu-

ven, Belgium

E-mail address: Hans.Baumers@wis.kuleuven.be, Ferran.DachsCadefau@wis.kuleuven.be

