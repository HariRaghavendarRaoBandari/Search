6
1
0
2

 
r
a

 

M
3
1

 
 
]

C
S
.
s
c
[
 
 

1
v
7
8
9
3
0

.

3
0
6
1
:
v
i
X
r
a

Binomial Diﬀerence Ideals

Xiao-Shan Gao, Zhang Huang, Chun-Ming Yuan

KLMM, Academy of Mathematics and Systems Science
The Chinese Academy of Sciences, Beijing 100190, China

Abstract

In this paper, binomial diﬀerence ideals are studied. Three canonical representations
for Laurent binomial diﬀerence ideals are given in terms of the reduced Gr¨obner basis
of Z[x]-lattices, regular and coherent diﬀerence ascending chains, and partial characters
over Z[x]-lattices, respectively. Criteria for a Laurent binomial diﬀerence ideal to be
reﬂexive, prime, well-mixed, and perfect are given in terms of their support lattices.
The reﬂexive, well-mixed, and perfect closures of a Laurent binomial diﬀerence ideal
are shown to be binomial. Most of the properties of Laurent binomial diﬀerence ideals
are extended to the case of diﬀerence binomial ideals. Finally, algorithms are given to
check whether a given Laurent binomial diﬀerence ideal I is reﬂexive, prime, well-mixed,
or perfect, and in the negative case, to compute the reﬂexive, well-mixed, and perfect
closures of I. An algorithm is given to decompose a ﬁnitely generated perfect binomial
diﬀerence ideal as the intersection of reﬂexive prime binomial diﬀerence ideals.

Keywords. Laurent binomial diﬀerence ideal, binomial diﬀerence ideal, Z[x]-lattice,
diﬀerence characteristic set, Gr¨obner basis of Z[x]-module, generalized Hermite normal
form.

1

Introduction

A polynomial ideal is called binomial if it is generated by polynomials with at most two
terms. Binomial ideals were ﬁrst studied by Eisendbud and Sturmfels [7], which were further
studied in [1, 6, 19, 16, 23] and were applied in algebraic statistics [22], chemical reactions
[20], and error-correcting codes [25].

In this paper, we initiate the study of binomial diﬀerence ideals and hope that they will
play similar roles in diﬀerence algebraic geometry to their algebraic counterparts. Diﬀerence
algebra and diﬀerence algebraic geometry were founded by Ritt [24] and Cohn [4], who
aimed to study algebraic diﬀerence equations in the way polynomial equations were studied
in commutative algebra and algebraic geometry [4, 13, 17, 26].

We now describe the main results of this paper. In Section 3, we prove basic properties
of Z[x]-lattices. By a Z[x]-lattice, we mean a Z[x]-module in Z[x]n. Z[x]-lattices play the
same role as Z-lattices do in the study of binomial ideals. Here, x is used to denote the
diﬀerence operator σ. For instance, a3σ(a)2 is denoted as a2x+3. Since Z[x] is not a PID,
the Hermite normal form for a matrix with entries in Z[x] does not exist. In this section,
we introduce the concept of generalized Hermite normal form and show that a matrix is a

1

generalized Hermite normal form if and only if its columns form a reduced Gr¨obner basis for
a Z[x]-lattice.

In Section 4, we give three canonical representations for Laurent binomial diﬀerence
ideals in terms of reduced Gr¨obner bases of Z[x]-lattices, diﬀerence characteristic sets, and
partial characters. Gr¨obner bases play an important role in the study of binomial ideals [7].
In general, a binomial diﬀerence ideal is not ﬁnitely generated and does not have a ﬁnite
Gr¨obner basis. Instead, the theory of characteristic set for diﬀerence polynomial systems [9]
is used for similar purposes. It is shown that any Laurent binomial diﬀerence ideal can be
written as [A], where A is a regular and coherent diﬀerence ascending chain consisting of
binomial diﬀerence polynomials.
Let I be a proper Laurent binomial diﬀerence ideal and L = {f ∈ Z[x]n | Yf − cf ∈ I}
the support lattice of I, which is a Z[x]-lattice. In Section 5, we give criteria for a Laurent
binomial diﬀerence ideal to be prime, reﬂexive, well-mixed, and perfect in terms of its support
lattice. The criterion for prime ideals is similar to the algebraic case, but the criteria for
reﬂexive, well-mixed, and perfect diﬀerence ideals are unique to diﬀerence algebra and are
ﬁrst proposed in this paper. Furthermore, it is shown that the reﬂexive, well-mixed, and
perfect closures of a Laurent binomial diﬀerence ideal I with support lattice L are still
binomial, whose support lattices are the x-, M -, and the P -saturation of L, respectively. It
is further shown that any perfect Laurent binomial diﬀerence ideal I can be written as the
intersection of Laurent reﬂexive prime binomial diﬀerence ideals whose support lattices are
the x-Z-saturation of the support lattice of I.

In Section 6, binomial diﬀerence ideals are studied. It is shown that a large portion of the
properties for binomial ideals proved in [7] can be easily extended to the diﬀerence case. We
also identify a class of normal binomial diﬀerence ideals which are in a one to one correspon-
dence with Laurent binomial diﬀerence ideals. With the help of this correspondence, most
properties proved for Laurent binomial diﬀerence ideals are extended to the non-Laurent
case.

In Section 7, algorithms are given to check whether a Z[x]-lattice L is Z-, x-, M-, or P-
saturated, or equivalently, whether a Laurent binomial diﬀerence ideal I is prime, reﬂexive,
If the answer is negative, we can also compute the Z-, x-, M-,
well-mixed, or perfect.
or P-saturation of L and the reﬂexive, well-mixed, or perfect closures of I. Based on these
algorithms, we give an algorithm to decompose a ﬁnitely generated perfect binomial diﬀerence
ideal as the intersection of reﬂexive prime binomial diﬀerence ideals. This algorithm is
stronger than the general decomposition algorithm in that for general diﬀerence polynomials,
it is still open on how to decompose a ﬁnitely generated perfect diﬀerence ideal as the
intersection of reﬂexive prime diﬀerence ideals [9].

A distinctive feature of the algorithms presented in this paper is that problems about
diﬀerence binomial polynomial ideals are reduced to problems about Z[x]-lattices which are
pure algebraic and have simpler structures.

2

2 Preliminaries about diﬀerence algebra

In this section, some basic notations about diﬀerence algebra will be given. For more details
about diﬀerence algebra, please refer to [4, 9, 13, 17, 26].

2.1 Diﬀerence polynomial and Laurent diﬀerence polynomial

An ordinary diﬀerence ﬁeld, or simply a σ-ﬁeld, is a ﬁeld F with a third unitary operation
σ satisfying: for any a, b ∈ F, σ(a + b) = σ(a) + σ(b), σ(ab) = σ(a)σ(b), and σ(a) = 0 if
and only if a = 0. We call σ the transforming operator of F. If a ∈ F, σ(a) is called the
transform of a and is denoted by a(1). For n ∈ Z>0, σn(a) = σn−1(σ(a)) is called the n-th
transform of a and denoted by a(n), with the usual assumption a(0) = a. If σ−1(a) is deﬁned
for each a ∈ F, F is called inversive. Every σ-ﬁeld has an inversive closure [4]. A typical
example of inversive σ-ﬁeld is Q(λ) with σ(f (λ)) = f (λ + 1).

use σ- as the abbreviation for diﬀerence or transformally.

In this paper, F is assumed to be inversive and of characteristic zero. Furthermore, we
p =Ps

i=0 cixi ∈ Z[x]. For a in any σ-over ﬁeld of F, denote

We introduce the following useful notation. Let x be an algebraic indeterminate and

ap =

(σia)ci.

sYi=0

For instance, ax2−1 = a(2)/a. It is easy to check that for p, q ∈ Z[x], we have

ap+q = apaq, apq = (ap)q, (ab)p = apbp.

j

By a[n] we mean the set {a, a(1), . . . , a(n)}. If S is a set of elements, we denote S[n] = ∪a∈Sa[n].
Let S be a subset of a σ-ﬁeld G which contains F. We will denote respectively by F[S],
F(S), F{S}, and FhSi the smallest subring, the smallest subﬁeld, the smallest σ-subring,
and the smallest σ-subﬁeld of G containing F and S. If we denote Θ(S) = {σka|k ≥ 0, a ∈ S},
then we have F{S} = F[Θ(S)] and FhSi = F(Θ(S)).
Now suppose Y = {y1, . . . , yn} is a set of σ-indeterminates over F. The elements of
F{Y} = F[y(k)
: j = 1, . . . , n; k ∈ N] are called σ-polynomials over F in Y, and F{Y} itself
is called the σ-polynomial ring over F in Y. A σ-polynomial ideal, or simply a σ-ideal, I
in F{Y} is an ordinary algebraic ideal which is closed under transforming, i.e. σ(I) ⊂ I.
If I also has the property that a(1) ∈ I implies that a ∈ I, it is called a reﬂexive σ-ideal.
A prime σ-ideal is a σ-ideal which is prime as an ordinary algebraic polynomial ideal. For
convenience, a prime σ-ideal is assumed not to be the unit ideal in this paper. A σ-ideal I
is called well-mixed if f g ∈ I implies f gx ∈ I for f, g ∈ F{Y}. A σ-ideal I is called perfect
if for any a ∈ N[x] \ {0} and p ∈ F{Y}, pa ∈ I implies p ∈ I. If S is a subset of F{Y}, we
use (S), [S], hSi, and {S} to denote the algebraic ideal, the σ-ideal, the well-mixed σ-ideal,
and the perfect σ-ideal generated by S.

An n-tuple over F is an n-tuple of the form η = (η1, . . . , ηn) where the ηi are selected
from a σ-overﬁeld of F. For a σ-polynomial f ∈ F{Y}, η is called a σ-zero of f if when
substituting y(j)

in f , the result is 0.

i by η(j)

i

3

i=1 yfi

i . Yf

For f = (f1, . . . , fn)τ ∈ Z[x]n, we deﬁne Yf = Qn
is called a Laurent σ-
monomial in Y and f is called its support. A nonzero vector f = (f1, . . . , fn)τ ∈ Z[x]n is said
to be normal if the leading coeﬃcient of fs is positive, where s is the largest subscript such
that fs 6= 0.

A Laurent σ-polynomial over F in Y is an F-linear combination of Laurent σ-monomials in
Y. Clearly, the set of all Laurent σ-polynomials form a commutative σ-ring under the obvious
sum, product, and the usual transforming operator σ, where all Laurent σ-monomials are
invertible. We denote the σ-ring of Laurent σ-polynomials with coeﬃcients in F by F{Y±}.
Let p be a Laurent σ-polynomial in F{Y±}. An n-tuple (a1, . . . , an) over F with each ai 6= 0
is called a nonzero σ-solution of p if p(a1, . . . , an) = 0.

2.2 Characteristic set for a diﬀerence polynomial system

i

Let f be a σ-polynomial in F{Y}. The order of f w.r.t. yi is deﬁned to be the greatest
number k such that y(k)
appears eﬀectively in f , denoted by ord(f, yi). If yi does not appear
in f , then we set ord(f, yi) = −∞. The order of f is deﬁned to be maxi ord(f, yi), that is,
ord(f ) = maxi ord(f, yi).
The elimination ranking R on Θ(Y) = {σkyi|1 ≤ i ≤ n, k ≥ 0} is used in this paper:
σkyi > σlyj if and only if i > j or i = j and k > l, which is a total order over Θ(Y). By
convention, 1 < θyj for all θyj ∈ Θ(Y).

Let f be a σ-polynomial in F{Y}. The greatest y(k)

j w.r.t. R which appears eﬀectively
in f is called the leader of f , denoted by ld(f ) and correspondingly yj is called the leading
variable of f , denoted by lvar(f ) = yj. The leading coeﬃcient of f as a univariate polynomial
in ld(f ) is called the initial of f and is denoted by If .

Let p and q be two σ-polynomials in F{Y}. q is said to be of higher rank than p if

ld(q) > ld(p) or ld(q) = ld(p) = y(k)

and deg(q, y(k)

) > deg(p, y(k)

).

j

j

j

Suppose ld(p) = y(k)

. q is said to be reduced w.r.t. p if deg(q, y(k+l)

j

) < deg(p, y(k)

j

) for

j

all l ∈ N.

A ﬁnite sequence of nonzero σ-polynomials A = A1, . . . , Am is said to be a diﬀerence
ascending chain, or simply a σ-chain, if m = 1 and A1 6= 0 or m > 1, Aj > Ai and Aj is
reduced w.r.t. Ai for 1 ≤ i < j ≤ m.

A σ-chain A can be written as the following form

A : A11, . . . , A1k1, . . . , Ap1, . . . , Apkp

(1)

where lvar(Aij) = yci for j = 1, . . . , ki and ord(Aij, yci) < ord(Ail, yci) for j < l. The
following are two σ-chains

A1 = yx
A2 = y2

1y2
1 − 1, y2
1 − 1, yx
1 − y1,

2 − 1, yx
2 − 1
y2
2 − 1, yx

2 + y2

(2)

Let A = A1, A2, . . . , At be a σ-chain with Ii as the initial of Ai, and f any σ-polynomial.
Then there exists an algorithm, which reduces f w.r.t. A to a polynomial r that is reduced

4

w.r.t. A and satisﬁes the relation

tYi=1

Iei
i

· f ≡ r, mod [A],

(3)

where the ei ∈ N[x] and r = prem(f,A) is called the σ-remainder of f w.r.t. A [9].

A σ-chain C contained in a σ-polynomial set S is said to be a characteristic set of S,
if S does not contain any nonzero element reduced w.r.t. C. Any σ-polynomial set has a
characteristic set. A characteristic set C of a σ-ideal J reduces to zero all elements of J .

Let A : A1, . . . , At be a σ-chain, Ii = I(Ai), y(oi)

is invertible w.r.t A [9] in the sense that [A1, . . . , Ai−1, I xj

= ld(Ai). A is called regular if for any
j ∈ N, I xj
] contains a nonzero
σ-polynomial involving no y(oi+k)
, k = 0, 1, . . .. To introduce the concept of coherent σ-
chain, we need to deﬁne the ∆-polynomial ﬁrst. If Ai and Aj have distinct leading variables,
we deﬁne ∆(Ai, Aj) = 0.
If Ai and Aj (i < j) have the same leading variable yl, then
oi = ord(Ai, yl) < oj = ord(Aj, yl). Deﬁne

li

i

i

li

∆(Ai, Aj) = prem((Ai)xoj −oi , Aj).

(4)

Then A is called coherent if prem(∆(Ai, Aj),A) = 0 for all i < j [9].

Let A be a σ-chain. Denote IA to be the minimal multiplicative set containing the initials

of elements of A and their transforms. The saturation ideal of A is deﬁned to be

sat(A) = [A] : IA = {p ∈ F{Y} : ∃h ∈ IA, s.t. hp ∈ [A]}.

The following result is needed in this paper.

Theorem 2.1 [9, Theorem 3.3] A σ-chain A is a characteristic set of sat(A) if and only if
A is regular and coherent.

3 Z[x]-lattice

In this section, we prove basic properties of Z[x]-lattices, which will play the role of lattices
in the study of binomial ideals.

For brevity, a Z[x]-module in Z[x]n is called a Z[x]-lattice. Since Z[x] is a Noetherian

ring, any Z[x]-lattice L has a ﬁnite set of generators f = {f1, . . . , fs} ⊂ Z[x]n:

A matrix representation of f or L is

L = SpanZ[x]{f1, . . . , fs} , (f1, . . . , fs).

M = [f1, . . . , fs]n×s,

with fi to be the i-th column of M . We also denote L = (M ). The rank of a Z[x]-lattice L
is deﬁned to be the rank of any matrix representation of L, which is clearly well deﬁned.

5

We list some basic concepts and properties of Gr¨obner bases of modules. For details,

please refer to [5].

Denote ǫi to be the i-th standard basis vector (0, . . . , 0, 1, 0, . . . , 0)τ ∈ Z[x]n, where 1
lies in the i-th row of ǫi. A monomial m in Z[x]n is an element of the form axk ǫi ∈ Z[x]n,
where a ∈ Z and k ∈ N. The following monomial order > of Z[x]n will be used in this paper:
axαǫi > bxβ ǫj if i > j, or i = j and α > β, or i = j, α = β, and |a| > |b|.
With the above order, any f ∈ Z[x]n can be written in a unique way as a linear combi-
nation of monomials, f =Pl
i=1 hi, where hi 6= 0 and h1 > h2 > ··· > hl. The leading term
of f is deﬁned to be LT(f ) = h1. For any G ⊂ Z[x]n, we denote by LT(G) the set of leading
terms of G.
The order > can be extended to elements of Z[x]n as follows: for f , g ∈ Z[x]n, f < g if
Let G ⊂ Z[x]n and f ∈ Z[x]n. We say that f is G-reduced with respect to G if any

monomial of f is not a multiple of LT(g) by an element in Z[x] for any g ∈ G.
Deﬁnition 3.1 A ﬁnite set f = {f1, . . . , fs} ⊂ Z[x]n is called a Gr¨obner basis for the Z[x]-
lattice L generated by f if for any g ∈ L, there exists an i, such that LT(g)|LT(fi). A
Gr¨obner basis f is called reduced if for any f ∈ f, f is G-reduced with respect to f \ {f}. In
this paper, it is always assumed that f1 < f2 < ··· < fs.

and only if LT(f ) < LT(g).

Let f be a Gr¨obner basis. Then any f ∈ Z[x]n can be reduced to a unique normal form

by f, denoted by grem(f , f), which is G-reduced with respect to f.

Deﬁnition 3.2 Let f , g ∈ Z[x]n, LT(f ) = axkei, LT(g) = bxsej, s ≤ k. Then the S-
polynomial of f and g is deﬁned as follows: if i 6= j then S(f , g) = 0; otherwise S(f , g) =

f − a
b xk−sg,
b
a f − xk−sg,
uf + vxk−sg,

if b| a;
if a| b;
if a ∤ b and b ∤ a, where gcd(a, b) = ua + vb.

(5)




The following basic property for Gr¨obner basis is obviously true for Z[x]-lattices and a
polynomial-time algorithm to compute G¨obner bases for Z[x]-lattices is given in [15].

Theorem 3.3 (Buchberger’s Criterion) The following statements are equivalent.

1) f = {f1, . . . , fs} ⊂ Z[x]n is a Gr¨obner basis.
2) grem(S(fi, fj), G) = 0 for all i, j.

3) f ∈ (f) if and only if grem(f , f) = 0.

We will study the structure of a Gr¨obner basis for a Z[x]-lattice by introducing the

concept of generalized Hermite normal form. First, we consider the case of n = 1.

Lemma 3.4 Let B = {b1, . . . , bk} be a reduced Gr¨obner basis of a Z[x]-module in Z[x],
b1 < ··· < bk, and LT(bi) = cixdi ∈ N[x]. Then

6

1) 0 ≤ d1 < d2 < ··· < dk.
2) ck|··· |c2|c1 and ci 6= ci+1 for 1 ≤ i ≤ k − 1.
ck|bi for 1 ≤ i < k. Ifeb1 is the primitive part of b1, theneb1|bi for 1 < i ≤ k.
3) ci
4) The S-polynomial S(bi, bj) can be reduced to zero by B for any i, j.

Proof: 1) and 4) are consequences of Theorem 3.3. To prove 2), assume that there exists an
l such that cl−1|··· |c2|c1 but cl 6 |cl−1. Let r = gcd(cl, cl−1) = p1cl + p2cl−1, where p1, p2 ∈ Z.
Then |r| < |cl−1| and |r| < |cl|. Since cl−1|··· |c2|c1, we have |r| < |ci|, i = 1, . . . , l. Let
g = p1bl + p2xdl−dl−1bl−1. Then LT(g) = rxdl which is reduced w.r.t. B and g ∈ (B),
contradicting to the deﬁnition of Gr¨obner bases.
We prove 3) by induction on k. When k = 2, let b1 = c1xd1 + s11xd1−1 + ··· + s1d1
and b2 = c2xd2 + s21xd2−1 + ··· + s2d2. Then, c2|c1 and d1 < d2. Let c1 = c2t, we need
to show t|b1. Since the S-polynomial S(b1, b2) = tb2 − xd2−d1b1 can be reduced to zero by
b1, we have tb2 − xd2−d1b1 = u(x)b1, where u(x) ∈ Z[x] and deg(u(x)) < d2 − d1. Then,
tb2 = (xd2−d1 + u(x))b1, and t|b1 follows since xd2−d1 + u(x) is a primitive polynomial in
Z[x]. The claim is true. Assume that for k = l − 1, the claim is true, then eb1|bi for
1 ≤ i ≤ l − 1. We will prove the claim for k = l. Since S(b1, bl) = c1
bl − xdl−d1b1
bl − xdl−d1b1 = Pl−1
can be reduced to zero by B. We have c1
i=1 fibi with fi ∈ Z[x] and
cl
i=1 fibi. By induction, eb1 is a factor of the
deg(fibi) ≤ dl − 1. Then, c1
right hand side of the above equation. Thus eb1|bl. Let bi = sib′
1 for 1 ≤ i ≤ l, we have
sl = xdl−d1s1 +Pl−1
i=1 fisi where deg(si) = di− d1 and s1 ∈ Z. Since deg(fisi) ≤ dl − d1− 1,
cl |b1. For any 1 ≤ i < j < l, assume ci
cl |s1 and c1
cl |bj. Since
bj − xdj −dj−1bj−1 = Pj−1
is a factor of the right hand
cl |bj. The claim is

c1
cl
we have c1
i=1 fibi, we have cj−1
S(bj−1, bj) = cj−1
cj
cl
side of the above equation, for cj−1|cj−2|··· |c1. Then, cj−1

bl = xdl−d1b1 +Pl−1

cl|bi. We will show that cj

bj and cj

| cj−1

cj

cl

cl

cl

proved.

Example 3.5 Here are three Gr¨obner bases in Z[x]: {2, x}, {12, 6x + 6, 3x2 + 3x, x3 + x2},
{9x + 3, 3x2 + 4x + 1}.

To give the structure of a reduced Gr¨obner basis similar to that in Example 3.5, we

introduce the concept of generalized Hermite normal form. Let

C =





c1,1
. . .
cr1 ,1
0
. . .
0
. . .
0
. . .
0

. . .
. . .
. . .
. . .
. . .
. . .
. . .
. . .

. . .
. . .

c1,l1
. . .
cr1 ,l1
0
. . .
0
. . .
0
. . .
0

c1,l1 +1
. . .
cr1 ,l1+1
cr1 +1,1
. . .
cr2 ,1
. . .
0
. . .
0

. . .
. . .
. . .
. . .
. . .
. . .
. . .
. . .

. . .
. . .

. . .
. . .
. . .
cr1+1,l2
. . .
cr2 ,l2
. . .
0
. . .
0

. . .
. . .
. . .
. . .
. . .
. . .
. . .
. . .

. . .
. . .

. . .
. . .
. . .
. . .
. . .
. . .
. . .
0
. . .
0

. . .
. . .
. . .
. . .
. . .
. . .
. . .
crt−1 +1,1
. . .
crt ,1

. . .
. . .
. . .
. . .
. . .
. . .
. . .
. . .

. . .
. . .

. . .
. . .
. . .
. . .
. . .
. . .
. . .
crt−1 +1,lt
. . .
crt ,lt





m×s

(6)

whose elements are in Z[x]. It is clear that m = rt and s =Pt
be the column of the matrix C whose last nonzero element is
cri,j = ci,j,0xdij + ··· + ci,j,dij .

Then the leading monomial of cri,j is cri,j,0xdri,j ǫri. It is clear that rk(L) = t.

7

i=1 li. We denote by cri,j to

(cid:3)

(7)

Deﬁnition 3.6 The matrix C in (6) is called a generalized Hermite normal form if it satisﬁes
the following conditions:

1) 0 ≤ dri,1 < dri,2 < ··· < dri,li for any i.
2) cri,li,0|··· |cri,2,0|cri,1,0.
3) S(cri,j1, cri,j2) = xdri,j2 −dri ,j1 cri,j1 −

cri,j1,0
cri,j2,0

cri,j2 can be reduced to zero by the column

vectors of the matrix for any 1 ≤ i ≤ t, 1 ≤ j1 < j2 ≤ li.

4) cri,j is G-reduced w.r.t. the column vectors of the matrix other than cri,j, for any 1 ≤

i ≤ t, 1 ≤ j ≤ li.

It is clear that {cri,1, . . . , cri,li} is a reduced Gr¨obner basis in Z[x]. Then, as a consequence

of Theorem 3.3 and Lemma 3.4, we have

Theorem 3.7 f = {f1, . . . , fs} ⊂ Z[x]n is a reduced Gr¨obner basis such that f1 < f2 < ··· <
fs if and only if [f1, . . . , fs] is a generalized Hermite normal form.

Example 3.8 The following matrices are generalized Hermite normal forms

M1 =(cid:20) x 2 0

0 2 x (cid:21) , M2 =(cid:20) 2 x − 1 0 0

0 0

2 x − 1 (cid:21)

whose columns constitute the reduced Gr¨obner bases of the Z[x]-lattices.

Let f = {f1, . . . , fs} be a reduced Gr¨obner basis. Let S(fi, fj) = mijfi − mjifj be the
S-polynomial of fi, fj and grem(S(fi, fj), f) = Pk ckfk be the normal representation of in
terms of the Gr¨obner basis f. Then the syzygy polynomial eS(fi, fj)

eS(fi, fj) = mij ǫi − mjiǫj −Xk

ck ǫk,

is an element in Z[x]s, where ǫk is the k-th standard basis vector of Z[x]s. Deﬁne an order
in Z[x]s as follows: axαǫi ≺ bxβ ǫj if LT(axαfi) > LT(bxβfj) in Z[x]n. By Schreyer’s
Theorem [5, p. 212], we have

Theorem 3.9 Let F = [f1, . . . , fs]n×s ∈ Z[x]n×s be a generalized Hermite normal form.
Then the syzygy polynomials eS(fi, fj) form a Gr¨obner basis of the Z[x]-lattice ker(F ) =
{X ∈ Z[x]s|F X = 0} under the newly deﬁned order ≺.
Let C be deﬁned in (6) and k ∈ N. Introduce the following notations:

i=1 ∪li−1
C− = ∪t
i=1 ∪∞
C+ = ∪t
C∞ = C− ∪ C+

k=1 {cri,k, xcri,k, . . . , xdeg(cri,k+1)−deg(crt,k)−1cri,k},
k=0 {xkcri,li}.

(8)

8

6 3x x3 + x (cid:21) .

2x

0 0

Example 3.10 Let C =(cid:20) 6 3x 0 3
Then C− =(cid:20) 6 0 3
0 6 3x 3x2 (cid:21) and
C∞ =(cid:20) 6 3x 3x2 3x3
···
···

0 0

3x

0

0

3x

0 3
6 3x 3x2 x3 + x x4 + x2

2x

2x2

···

··· (cid:21) .

We need the following properties about C∞. By saying the inﬁnite set C∞ is linear
independent over Z, we mean any ﬁnite subset of C∞ is linear independent over Z. Otherwise,
C∞ is said to be linear dependent.
Lemma 3.11 The columns of C∞ in (8) are linear independent over Z.
Proof: Suppose C is given in (6). The leading term of c ∈ C∞ is LT(c) = axl ǫri for i = 1, . . . , t
and l ∈ N. Furthermore, for two diﬀerent c1 and c2 in CS such that LT(c1) = axl1 ǫri
and LT(c2) = bxl2 ǫri, we have l1 6= l2. Then LT(C∞) = {ailixli ǫri | i = 1, . . . , t; li =
di1, di1 + 1, . . . ; aili ∈ Z} are linear independent over Z, where di1 is from (7). Then C∞ are
also linear independent over Z.

(cid:3)

Lemma 3.12 Let C be a generalized Hermite normal form. Then any g ∈ (C) can be written
uniquely as a linear combination of ﬁnitely many elements of C∞ over Z.
Proof: g ∈ (C) can be written as a linear combination of elements of C∞ over Z by the
procedure to compute grem(g,C) = 0 [5]. The uniqueness is a consequence of Lemma 3.11.(cid:3)

4 Canonical Representations for Laurent binomial σ-ideal

In this section, we will give three canonical representations for a proper Laurent binomial
ideal.

4.1 Laurent binomial σ-ideal

In this section, several basic properties of Laurent binomial σ-ideals will be proved.

By a Laurent σ-binomial in Y, we mean a σ-polynomial with two terms, that is, aYg +bYh
where a, b ∈ F ∗ = F \ {0} and g, h ∈ Z[x]n. A Laurent σ-binomial of the following form is
said to be in normal form

p = Yf − cf

where cf ∈ F ∗ = F \ {0} and f ∈ Z[x]n is normal. The vector f is called the support of p.
For p = Yf − cf , we denote bp = −c−1
f which is called the inverse of p. It
is clear that any Laurent σ-binomial f can be written uniquely as f = aM (Yf − cf ) where
a ∈ F ∗, M is a Laurent σ-monomial, and Yf − cf is in normal form. Since aM is a unit

f Y−f p = Y−f − c−1

9

in F{Y±}, we can use the normal σ-binomial Yf − cf to represent f , and when we say a
Laurent σ-binomial we always use its normal representation.

A Laurent σ-ideal is called binomial if it is generated by Laurent σ-binomials.

Lemma 4.1 Let Yfi − ci, i = 1, . . . , s be contained in a Laurent binomial σ-ideal I and
f = a1f1 + ··· + asfs, where ai ∈ Z[x]. Then Yf −Qs
Proof: It suﬃces to show that if p1 = Yf1 − c1 ∈ I and p2 = Yf2 − c2 ∈ I, then Ynf1 − cn
for n ∈ N, Y−f1 − c−1
since Ynf1 − cn
Yxf1 − σ(c1) = σ(Yf1 − c1) ∈ I, and Yf1+f2 − c1c2 = Yf1(Yf2 − c2) + c2(Yf1 − c1) ∈ I.

1 ∈ I
1 ∈ I, Yxf1 − σ(c1) ∈ I, and Yf1+f2 − c1c2 ∈ I, which are indeed true
1 Y−f1(Yf1 − c1) ∈ I,

1 contains p1 as a factor, Y−f1 − c−1

1 = (Yf1)n − cn

1 = −c−1

is in I.

i=1 cai

(cid:3)

i

As a direct consequence, we have

Proposition 4.2 Let I be a proper Laurent binomial σ-ideal and

L(I) := {f ∈ Z[x]n |∃cf ∈ F ∗ s.t. Yf − cf ∈ I}.

(9)

Then L(I) is a Z[x]-lattice, which is called the support lattice of I. Furthermore, Let
L(I) = (f1, . . . , fs). Then I = [Yf1 − cf1, . . . , Yfs − cfs]. That is, a Laurent binomial σ-ideal
is ﬁnitely generated and [f1, . . . , fs] is called a matrix representation for I
Proof: Let I1 = [Yf1 − cf1, . . . , Yfs − cfs]. It suﬃces to show I ⊂ I1. Since I is Laurent
binomial, it has a set of generators of the form fh = Yh − ch. Then h ∈ L(I) = (f1, . . . , fs).
By Lemma 4.1, there exists aech ∈ F such that efh = Yh−ech ∈ I1. Then fh−efh =ech−ch ∈ I.
Since I is proper, we have fh − efh = 0 or fh ∈ I1 and hence I ⊂ I1.
Corollary 4.3 Let I = [Yf1 − c1, . . . , Yfs − cs] be a proper Laurent binomial σ-ideal and
let h1, . . . , hr be another set of generators of (f1, . . . , fs), and hi =Ps
k=1 ai,kfk, i = 1, . . . , r,
where ai,k ∈ Z[x]. Then I = [Yh1 −Qs

, . . . , Yhr −Qs

Similarly, we can prove

i=1 ca1,i

i=1 car,i

(cid:3)

i

].

i

We now show to check whether a Laurent binomial σ-ideal is proper.

Proposition 4.4 Let I = [Yf1 − c1, . . . , Yfs − cs] be a Laurent binomial σ-ideal and M =
[f1, . . . , fs] ∈ Z[x]n×s. Let ker(M ) = {h ∈ Z[x]s | M h = 0} be generated by u1, . . . , ut, where
ui = (ui,1, . . . , uis). Then I 6= [1] if and only if Qs
Proof: “⇒” Let fi = Yfi − ci. Suppose c = Qs
Yfi − fi in the above equation and noting that ul ∈ ker(M ), we have c = Qs
i=1(yfi − fi)ul,i =Qs
Qs
“⇐” Suppose the contrary. Then there exist gi ∈ F{Y±} such that

6= 1 for some l. Replacing ci by
ul,i
i =
i=1 YM ·ul + g = 1 + g where g ∈ I. Then 0 6= c − 1 ∈ I and I = [1], a

ul,i
i = 1 for l = 1, . . . , t.

contradiction.

ul,i
i=1 c
i

i=1 c

i=1 c

g1f1 + ··· + gsfs = 1.

(10)

10

c

k=1deg(fk, y(o)

Let l be the maximal c such that y(k)
occurs
in some fk, and d = maxs
l − ck. Since (10) is an
identity about the algebraic variables yxj
l = ck/Ik in (10) to obtain a new
i
identity. In the new identity, fk becomes zero and the left hand side of (10) has at most s− 1
summands. We will show that this procedure can be continued for the new identity. Then
the left hand side of (10) will eventually becomes zero, and a contradiction is obtained and
the lemma is proved.

occurs in some fi, o the largest j such that y(j)
). Let fk = Yfk − ck = Ikydxo
, we can set ydxo

l

l

If ord(fi, yl) < o or ord(fi, yl) = o and deg(fi, yxo

l ) < d for some i, then fi is not
l ) = d and

changed in the above procedure. Let us assume that for some v, deg(fv, yxo
l − cv. Then after the substitution, fv = ckIv/Ik − cv = ckefv where
fv = Yfv − cv = Ivydxo
efv = Iv/Ik − cv/ck. We claim that either efv = 0 or Iv/Ik is a proper monomial, and as a
consequence, the above substitution can continue. To prove the claim, it suﬃces to show
that if Iv = Ik then cv = ck. If Iv = Ik, then fv = fk, that is fv − fk = 0 is a syzygy among
fi and let ǫvk be the corresponding syzygy vector. Then ǫvk ∈ ker(M ) can be written as a
linear combination of u1, . . . , us. Let c = (c1, . . . , cs)τ . Then cvc−1
k = cǫvk can be written as
a product of cul =Qs
(cid:3)

ul,i
i = 1, and thus cvc−1

k = 1.

i=1 c

4.2 Characteristic set of Laurent binomial σ-ideal

We show how to modify the characteristic set method presented in section 2.2 in the case of
Laurent binomial σ-ideals. First, assume that all Laurent σ-binomials are in normal form,
which makes the concepts of order and leading variables unique.

j ) by |deg(p, y(o)

Second, when deﬁning the concepts of rank and q to be reduced w.r.t. p, we need to re-
place deg(p, y(o)
)| <
|deg(p, y(k)
y2 − 1 is not reduced w.r.t.
y2
1 − 1. With these changes, the concepts of σ-chain and characteristic set can be deﬁned
in the Laurent σ-binomial case. For instance, the σ-chain A2 in (2) becomes the following
Laurent normal form:

j )|. Precisely, q is said to be reduced w.r.t. p if |deg(q, y(k+l)

)| for all l ∈ N, where ld(p) = y(k)

. For instance, y−2x

1

j

j

j

eA2 = y2

1 − 1, y−1

1 yx

1 − 1, y2

2 − 1, y−1

2 yx

2 − 1

(11)

Third, the σ-remainder for two Laurent σ-binomials need to be modiﬁed as follows. We
ﬁrst consider how to compute prem(f, g) in the simple case: o = ord(f, yl) = ord(g, yl),
where yl = lvar(g). Let g = Ig(y(o)
) and Ig is the initial of
g. As mentioned above, g is in normal form, that is d > 0. Let df = deg(f, y(o)
) and
f = If (y(o)

)d − cg, where d = deg(g, y(o)

)df − cf . We consider two cases.

In the ﬁrst case, let us assume df ≥ 0. If df < dg, then set r = prem1(f, g) to be f .

l

l

l

l

Otherwise, perform the following basic step

r := prem1(f, g) = (f − g

If
Ig

(y(o)

l

)df −dg )/cg =

If
Ig

(y(o)

l

)df −dg −

cf
cg

.

Let hr, hf , fg be the supports of r, f, g, respectively. Then

hr = hf − hg.

11

(12)

(13)

Set f = r and repeat the procedure prem1 for f and g. Since df decreases strictly after each
iteration, the procedure will end and return prem(f, g) = r which satisﬁes

r =

f
g − hg =
ck
hr = hf − khg

If
I k
g

(y(o)

l

)df −kdg −

cf
ck
g

(14)

(15)

dg ⌋ and h ∈ F{Y±}.

where k = ⌊ df
the ﬁrst case. Instead of g, we consider bg = (Ig)−1(y(o)

In the second case, we assume df < 0. The σ-remainder can be computed similar to
g . If |df| < dg, then set

)−dg − c−1
r = prem1(f, g) to be f . Otherwise, perform the following basic step

l

r := prem1(f, g) = cg(f −bgIgIf (y(o)

l

)df +dg ) = If Ig(y(o)
lg

)df +dg − cf cg.

In this case, equation (13) becomes hr = hf + hg. To compute prem(f, g), repeat the above
basic step for f = r until |df| < dg.

For two general σ-binomials f and g, prem(f, g) is deﬁned as follows:

if f is reduced
w.r.t g, set prem(f, g) = f . Otherwise, let yl = lvar(g), of = ord(f, yl), and og = ord(g, yl).
Deﬁne

prem(f, g) = prem(. . . , prem(prem(f, g(of −og)), g(of −og−1)), . . . , g).

Let A : A1, . . . , As be a Laurent binomial σ-chain and f a σ-binomial. Then deﬁne

prem(f,A) = prem(. . . , prem(prem(f, As), As−1), . . . , A1).

In summary, we have

Lemma 4.5 Let A = A1, . . . , As be a Laurent binomial σ-chain, f a σ-binomial, and r =
prem(f,A). Then r is reduced w.r.t. A and satisﬁes
cf ≡ r, mod [A],

(16)

where c ∈ F ∗. Furthermore, let the supports of r and f be hr and hf , respectively. Then
hf − hr is in the Z[x]-lattice generated by the supports of Ai.

Similar to section 2.2, the concepts of coherent and regular σ-chains can be extended to
the Laurent case. Since any σ-monomial is a unit in F{Y±}, the concept of regular σ-chain
need to be strengthened as follows. A σ-chain A is called Laurent regular if A is regular and
any σ-monomial is invertible w.r.t A. Then, following [9], Theorem 2.1 can be extended to
the following Laurent version straightforwardly.

Theorem 4.6 A Laurent σ-chain A is a characteristic set of sat(A) if and only if A is
coherent and Laurent regular.

For Laurent binomial σ-chains, we have

Lemma 4.7 Any Laurent binomial σ-chain A is Laurent regular.

12

Proof: Since the initials of A are σ-monomials, it suﬃces to show that any σ-monomial is
invertible w.r.t A. By [9, p.248], a σ-monomial M is invertible w.r.t A is M is invertible
w.r.t an extension AM of A when both M and AM are treated as algebraic polynomials in
yxj
, where AM is an algebraic Laurent binomial chain. By [10, p.1150], M is invertible w.r.t
i
AM if the successive Sylvester resultant Resl(M,AM ) of M and AM is nonzero. Since A
is Laurent binomial, B ∈ AM has the form B = I(yxo
k )m + U , where I is the initial of B
and U a σ-monomial does not contain yxo
k )n be any σ-monomial with J as
the initial. Then the Sylvester resultant of M and B w.r.t yxo
is J mU n which is a nonzero
k
σ-monomial. As a consequence, Resl(M,AM ) is also a nonzero σ-monomial and hence A is
Laurent regular.

k . Let N = J(yxo

(cid:3)

We now give the ﬁrst canonical representation for Laurent binomial σ-ideals.

Theorem 4.8 I is a proper Laurent binomial σ-ideal if and only there exists a Laurent
coherent σ-chain A such that I = sat(A) = [A].
Proof: Let I 6= [1] and A the characteristic set of I. Then [A] ⊂ I ⊂ sat(A). From (16),
we have sat(A) ⊂ [A] and then I = sat(A) = [A]. By Theorem 4.6, A is coherent. To prove
the other side of the theorem, let A be a Laurent coherent σ-chain. By Lemma 4.7, A is
also Laurent regular. By Theorem 4.6, A is a characteristic set of I = sat(A). Then I is
proper.

(cid:3)

Corollary 4.9 Let I be a Laurent reﬂexive prime binomial σ-ideal in F{Y±}. Then dim(I) =
n − rk(L(I)).
Proof: By Theorem 4.8, I = [A], where A : Yc1 − c1, . . . Ycs − cs. Let C = [c1, . . . , cs] is
the matrix representation for I and in the form of (6). Since I is reﬂexive and prime, by
Theorem 4.3 of [9], dim(I) = n − t = n − rk(L(I)).

(cid:3)

Corollary 4.10 A Laurent binomial σ-ideal is radical.

Proof: By Theorem 4.8, I = [A], where A : Yh1 − c1, . . . , Yhr − cr is the characteristic set
of I. Let Ai = Yhi − ci and y(oi)
= ld(Ai). A is also saturated in the sense that its separant
are σ-monomials and hence units in F{Y±}. Then similar to the diﬀerential case [2],

li

∂Ai
(oi)
∂y
li

it can be shown that sat(A) = [A] is a radical σ-ideal.

Let f1 < f2 < ··· < fs be elements in Z[x]n, ci ∈ F ∗, and

f = {f1, . . . , fs} ⊂ Z[x]n
Af = {A1, . . . , Aa} ⊂ F{Y±} with Ai = Yfi − ci, i = 1, . . . , s

(17)

In the rest of this section, we will establish a connection between f and Af. From Deﬁnition
3.6, we have

Lemma 4.11 For i < j, Aj is reduced w.r.t. Ai if and only if fj is G-reduced w.r.t. fi.

13

Lemma 4.12 For f and Af in (17) and a Laurent σ-binomial f = Yf − c, if prem(f,Af) =
Yg − cg, then g = grem(f , f).
Proof: Let us ﬁrst consider prem1 in (12) for f and Ai = Yfi − ci = Ii(y(oi)
)di − ci, where
ld(Ai) = yli and Ii is the initial of Ai. From (13), the support of r = prem1(f, Ai) is f − fi. It
is clear that LT(fi) = dixoi ǫli. Let fi = dixoi ǫli + f i. Similarly, write f = df xoi ǫli + m where
df xoi ǫli is the leading term of f w.r.t. ǫli and df ≥ di ≥ 0. Then a basic step to compute
grem(f , fi) is to compute grem1(f , fi) = f − fi = (df − di)xoi ǫli + f − f i, which is the support
of prem1(f, Ai).

li

Using the basic step grem1 to compute grem(f , f), we have a sequence of elements in
Z[x]n: g0 = f , g1, . . . , gt = grem(f , f). Correspondingly, using the basic step prem1 to
compute prem(f ,Af ), we have a sequence of σ-binomials f0 = f, f1, . . . , ft = prem(f,Af)
such that the support of fi is gi for i = 1, . . . , t.

(cid:3)

Lemma 4.13 If f in (17) is a reduced Gr¨obner basis and [Af ] 6= [1], then Af is a coherent
σ-chain.

Proof: By Lemma 4.11, Af is a σ-chain. Let Ai = Yfi − ci and Aj = Yfj − cj (i < j) have
the same leading variable yl, and Ai = Iiydixoi
− cj. From Deﬁnition 3.6,
we have oi < oj and dj|di. Let di = tdj where t ∈ N. According to (14), we have

− ci, Aj = Ijydj xoj

l

l

∆(Ai, Aj) = prem((Ai)xoj −oi , Aj) =

(Ii)xoj −oi

(ci)xoj −oi

I t
j

−

ct
j

.

(18)

Then the support of ∆(Ai, Aj ) is xoj−oifi − di

dj

fj.

Since LT(Ai) = dixoi ǫl and LT(Aj) = djxoj ǫl, we have N = lcm(dixoi, djxoj ) = dixoj .

According to Deﬁnition 3.2, the S-vector of fi and fj is

S(fi, fj) = xoj −oifi −

di
dj

fj.

Since f is a Gr¨obner basis, we have g = grem(S(fi, fj), f) = 0. Since the support of ∆(Ai, Aj)
is S(fi, fj), by Lemma 4.12, R = prem(∆(Ai, Aj),Af ) = Yg − c = 1− c for some c ∈ F. Since
[Af] is proper and R = 1 − c ∈ [Af], we have R = 0 and hence Af is coherent.

(cid:3)

We now give the main result of this section.

Theorem 4.14 For f and Af deﬁned in (17), Af is a coherent σ-chain if and only if f is a
reduced Gr¨obner basis and [Af] 6= [1].
Proof: Lemma 4.13 proves one side of the theorem. For the other direction, let Af be a coher-
ent σ-chain. By Lemma 4.11, fi is G-reduced to fj for i 6= j. By Theorem 4.8, [Af ] is proper.
Use the notations introduced in the proof of Lemma 4.13. Since S(fi, fj) is the support of
∆(Ai, Aj), by Lemma 4.12, fij = grem(S(fi, fj), f) is the support of prem(∆(Ai, Aj),Af ).
Since Af is coherent, prem(∆(Ai, Aj),Af ) = Yfij − c = 0 for any i and j, and this is possible
only when fij = grem(S(fi, fj), f) = 0 and c = 1 due to the fact [Af ] 6= [1]. Hence f is a
reduced Gr¨obner basis.

(cid:3)

14

4.3 Partial character and Laurent binomial σ-ideal

In this section, we will show that proper Laurent binomial σ-ideals can be described uniquely
with their partial characters.

Deﬁnition 4.15 A partial character ρ on Z[x]n is a homomorphism from a Z[x]-lattice Lρ
to the multiplicative group F ∗ satisfying ρ(xf ) = (ρ(f ))x = σ(ρ(f )) for f ∈ Lρ.

Let ρ be a partial character over Z[x]n and Lρ = (f1, . . . , fs), where f = {f1, . . . , fs} is a

reduced Gr¨obner basis. Deﬁne

I(ρ)
A(ρ)

:= [Yf − ρ(f )| f ∈ Lρ].
:= Yf1 − ρ(f1), . . . , yfs − ρ(fs).
The Laurent binomial σ-ideal I(ρ) has the following properties.
Lemma 4.16 I(ρ) = [A(ρ)] 6= [1] and A(ρ) is a characteristic set of I(ρ).
Proof: By Lemma 4.1 and the property of partial character, I(ρ) = [A(ρ)]. By Proposition
4.4, in order to prove I(ρ) 6= [1], it suﬃces to show that for any syzygy Pi aifi = 0 among
fi, we have Qi ρ(fi)ai = 1. Indeed, ρ(Pi aifi) = Qi ρ(fi)ai = 1, since ρ is a homomorphism
from the Z[x]-module Lρ to F ∗. Since f is a reduced Gr¨ober basis, by Theorem 4.14, A is a
characteristic set of I(ρ).

(cid:3)

(19)

(20)

Lemma 4.17 A Laurent σ-binomial Yf − cf is in I(ρ) if and only if f ∈ Lρ and cf = ρ(f ).
Proof: By Lemma 4.16, A(ρ) is a characteristic set of I(ρ). Since f = yf − cf is a σ-binomial
in I(ρ), we have r = prem(f,A) = 0. By Lemma 4.5, f is in the Z[x]-module Lρ. The other
side is obviously true and the lemma is proved.

(cid:3)

We now show that all Laurent binomial σ-ideals are deﬁned by partial characters.

Theorem 4.18 The map ρ ⇒ I(ρ) gives a one to one correspondence between the set of
proper Laurent binomial σ-ideals and partial characters on Z[X]n.

Proof: By Lemma 4.16, a partial character deﬁned a proper Laurent binomial σ-ideal. For
the other side, let I ⊆ F{Y±} be a proper Laurent binomial σ-ideal. I is generated by its
members of the form yf − cf for f ∈ Z[x]n and cf ∈ F ∗. Let Lρ = L(I) which is deﬁned
in (9) and ρ(f ) = cf . Since I is proper, cf
is uniquely determined by f . By Lemma 4.1
and Proposition 4.2, ρ is a partial character which is uniquely determined by I. It is clear
I(ρ) = I. To show the correspondence is one to one, it suﬃces to show ρ(I(ρ)) = ρ which
is a consequence of Lemma 4.17. The theorem is proved.

(cid:3)

As a summary of this section, we have the following canonical representations for a proper

Laurent binomial σ-ideal, which follows directly from Theorems 4.8, 4.14, 4.18.

Theorem 4.19 I is a proper Laurent binomial σ-ideal if and only if

15

(1) I = [A], where A is a coherent Laurent binomial σ-chain.
(2) I = [A], where A = Yf1 − c1, . . . , Yfs − cs, fi ∈ Z[x]n, ci ∈ F ∗, f = {f1, . . . , fs} is a

reduced Gr¨obner basis of a Z[x]-lattice, and [A] 6= [1].

(3) I = I(ρ) = [A], where ρ is a partial character on Z[x]n and A = A(ρ).
Furthermore, A is a characteristic set of I and (f) is the support lattice of I.

5 Criteria for prime, reﬂexive, and perfect Laurent binomial

σ-ideals

In this section, we give criteria for a Laurent binomial σ-ideal to be prime, reﬂexive, well-
mixed, and perfect in terms of its support lattice.

5.1 Reﬂexive and prime Laurent binomial σ-ideals

In this section, we ﬁrst give criteria for reﬂexive and prime Laurent binomial σ-ideals and
then give a decomposition theorem for perfect Laurent binomial σ-ideals.

For the σ-indeterminates Y = {y1, . . . , yn} and t ∈ N, we will treat the elements of Y[t]
as algebraic indeterminates, and F[Y[±t]] is the Laurent polynomial ring in Y[t]. Let I be a
Laurent binomial σ-ideal in F{Y±}. Then it is easy to check that

It = I ∩ F[Y[±t]]

Denote Z[x]t to be the set of elements in Z[x] with degree ≤ t. Then Z[x]n

is a Laurent binomial ideal in F[Y[±t]].
is the Z-
module generated by xi ǫl for i = 0, . . . , t, l = 1, . . . , n. It is clear that Z[x]n
t is isomorphic to
Zn(t+1) as Z-modules by mapping xiǫl to the ((l − 1)(t + 1) + i + 1)-th standard basis vector
in Zn(t+1). Hence, we treat them as the same in this section. Let L be a Z[x]-lattice and
t ∈ N. Then

t

Lt = L ∩ Z[x]n

t = L ∩ Zn(t+1)

is a Z-module in Zn(t+1). Similarly, it can be shown that when restricted to Z[x]n
character ρ on Z[x]n becomes a partial character ρt on Zn(t+1).

t , a partial

Lemma 5.1 With the notations introduced above, we have It = I ∩ F[Y[±t]] = I(ρt).
Proof:
Yf − cm ∈ It if and only if f ∈ L ∩ Z[x]n
equivalent to f ∈ Lt.

It suﬃces to show that the support lattice of It is Lρt = Lt. By Lemma 4.17,
t , or equivalently, maxm∈f deg(m, x) ≤ t, which is

(cid:3)

Deﬁnition 5.2 Let L be a Z[x]-module in Z[x]n.

• L is called Z-saturated if, for any a ∈ Z and f ∈ Z[x]n, af ∈ L implies f ∈ L.

16

• L is called x-saturated if, for any f ∈ Z[x]n, xf ∈ L implies f ∈ L.
• L is called saturated if it is both Z- and x- saturated.

Theorem 5.3 Let ρ be a partial character over Z[x]n.
inversive, then

If F is algebraically closed and

(a) Lρ is Z-saturated if and only if I(ρ) is prime;
(b) Lρ is x-saturated if and only if I(ρ) is reﬂexive;
(c) Lρ is saturated if and only if I(ρ) is reﬂexive prime.
Proof: It is clear that (c) comes from (a) and (b). Let I = I(ρ) and L = Lρ.

(a): I is a Laurent prime σ-ideal if and only if It is a Laurent prime ideal for all t. From
Lemma 5.1, the support of It is Lt. Then by [7, Thm 2.1], It is a Laurent prime ideal if and
only if Lt is a Z-saturated Z-module. Furthermore, a Z[x]-lattice L is Z-saturated if and
only if Lt is a Z-saturated Z-module for all t. Thus, (a) is valid.

(b): Suppose I is reﬂexive. For xf ∈ L, by Lemma 4.17, there is a Yxf − c ∈ I. Since F
is reﬂexive, c = dx for d ∈ F. Then σ(Yf − d) ∈ I and hence Yf − d ∈ I since I is reﬂexive.
By Lemma 4.17 again, f ∈ L and L is x-saturated. To prove the other direction, assume L
is x-saturated. For f x ∈ I, we have an expression

f x =

sXi=1

fi(Yfi − ci)

(21)

1 by c1/M1 in (21). Since (21) is an identity for the variables y(j)

where Yfi−ci ∈ I and fi ∈ F{Y±}. Let d = maxs
i=1deg(Yfi−ci, y1) and assume Yf1 = M1yd
1.
Replace yd
, this replacement
is meaningful and we obtain a new identity. Yf1 − c1 becomes zero after the replacement.
Due to the way to chose d, if another summand, say Yf2 − c2, is aﬀected by the replacement,
then Yf2 = M2yd
1. After the replacement, Yf2 − c2 becomes c1(M2/M1 − c2/c1) which is also
in I by Lemma 4.17. In summary, after the replacement, the right hand side of (21) has
less than s summands and the left hand side of (21) does not changed. Repeat the above
procedure, we will eventually obtain a new indenity

i

f x =

¯sXi=1

¯fi(Yxgi − ¯ci)

(22)

where Yxgi − ¯ci ∈ I and ¯fi ∈ F{Y±}. We may assume that any yi does not appear in ¯fi.
Otherwise, by setting yi to be 1, the left hand side of (22) is not changes and a new identity
for ei ∈ F and gi ∈ F{Y±}. By
is obtained. Since F is inversive, ¯ci = ex
Lemma 4.17, Yxgi − ex
i ∈ I implies xgi ∈ L. Since L is x-saturated, xgi ∈ L implies gi ∈ L
and hence Ygi − ei ∈ I by Lemma 4.17 again. From (22), σ(f −P¯s
i=1 gi(Ygi − ei)) = 0 and
hence f =P¯s

i=1 gi(Ygi − ei) ∈ I. (b) is proved.

(cid:3)

i and ¯fi = gx

i

17

Deﬁnition 5.4 Let L ⊂ Z[x]n be a Z[x]-lattice. The Z-saturation of L is satZ(L) = {f ∈
Z[x]n |∃a ∈ Z s.t. af ∈ L}. The x-saturation of L is satx(L) = {f ∈ Z[x]n | xf ∈ L}. The
saturation of L is sat(L) = {f ∈ Z[x]n |∃a ∈ Z,∃k ∈ N s.t. axkf ∈ L}.
It is clear that the Z-saturation (x-saturation) of L is Z-saturated (x-saturated) and

sat(L) = satZ(satx(L)) = satx(satZ(L)).

Theorem 5.5 Let I be a Laurent binomial σ-ideal and L the support lattice of I. If F is
inversive, then the reﬂexive closure of I is also a Laurent binomial σ-ideal whose support
lattice is the x-saturation of L.

Proof: Let Ix be the reﬂexive closure of I and Lx = satx(L). Suppose I = [f1, . . . , fr], where
fi = Yfi − ci. Then L = (f1, . . . , fr). If L is x-saturated, by Theorem 5.3, I is reﬂexive.
Otherwise, there exist k1 ∈ N, bi ∈ Z[x], and h1 ∈ Z[x]n such that h1 6∈ L and

i=1 cbi

xk1h1 =

rXi=1
By Lemma 4.1, Yxk1 h1 −ea is in I, whereea =Qr

bifi ∈ L.
i . Since F is inversive, a = σ−k1(ea) ∈ F.
Then, σk1(Yh1 − a) ∈ I, and hence Yh1 − a ∈ Ix. Let I1 = [f1, . . . , fr, Yh1 − a].
It
is clear that L1 = (f1, . . . , fr, h1) is the support lattice of I1. Then I   I1 ⊂ Ix and
L   L1 ⊂ Lx. Repeating the above procedure for I1 and L1, we obtain I2 and L2 =
(f1, . . . , fr, h1, h2) such that h2 6∈ L1 and xk2h2 ∈ L1. We claim that L2 ⊂ Lx. Indeed, let
xk2h2 =Pr
i=1 eifi+e0(xk1h1) =
xk1Pr
i=1 eifi + e0Pr
Continuing the process, we have I   I1   ···   It ⊂ Ix and L   L1   ···   Lt ⊂ Lx
such that Li is the support lattice of Ii. The process will terminate, since Z[x]n is Northerian.
The ﬁnal Z[x]-lattice Lt is x-saturated and hence It is reﬂexive by Theorem 5.3. Since Lx is
the smallest x-saturated Z[x]-lattice containing L and L ⊂ Lt ⊂ Lx, we have Lt = Lx and
It = Ix.
Corollary 5.6 Let L ⊂ Z[x]n be a Z[x]-lattice. Then rk(L) = rk(satx(L)) and rk(L) =
rk(satZ(L)).

i=1 eifi+e0h1. Then by (23), xk1+k2h2 = xk1(xk2h2) = xk1Pr

i=1 bifi ∈ L and the claim is proved. As a consequence, I2 ⊂ Ix.

(23)

(cid:3)

Proof: From the proof of Theorem 5.5, satx(L) = (L, h1, . . . , ht) and for each hi, there is
a positive integer ni such that xnihi ∈ L. Let A be a representation matrix of L. Then
a representation matrix B of Lx can be obtained by adding to A a ﬁnite number of new
columns which are linear combinations of columns of A divided by some xd. Therefore,
(cid:3)
rk(A) = rk(B). We can prove rk(L) = rk(satZ(L)) similarly.

We now give a decomposition theorem for perfect σ-ideals.

Theorem 5.7 Let I be a Laurent binomial σ-ideal, L the support lattice of I, and LS the
saturation of L. If F is algebraically closed and inversive, then {I} is either [1] or can be
written as the intersection of Laurent reﬂexive prime binomial σ-ideals whose support lattice
is LS.

18

Proof: Let Ix be the reﬂexive closure of I and Lx = satx(L). By Theorem 5.5, Lx is the
support lattice of Ix. Suppose Ix = [f1, . . . , fr], fi = Yfi − ci, i = 1, . . . , r, and Lx =
(f1, . . . , fr). If Lx is Z-saturated, then by Theorem 5.3, Ix is reﬂexive prime. Otherwise,
there exist k1 ∈ N, ai ∈ Z[x], and h1 ∈ Z[x]n such that h1 6∈ Lx and

k1h1 = a1f1 + ··· + arfr ∈ Lx.

(24)

By Lemma 4.1, Yk1h1 −ea ∈ I, whereea =Qr
k1Yl=1
Yk1h1 −ea =

i=1 cai

i . Since F is algebraically closed,
(Yh1 −eal) ∈ Ix

where eal, l = 1, . . . , k1 are the k1 roots of ea. By the diﬀerence Nullstellensatz [4, p.87], we

have the following decomposition

{I} = ∩k1

l1=1{I1l1}

where I1l = [f1, . . . , fr, Yh1 −eal]. Check whether I1l1 = [1] with Proposition 4.4 and discard
those trivial ones. Then the support lattice for any of I1l is L1 = (f1, . . . , fr, h1). Similar to
the proof of Theorem 5.5, we can show that Ix   I1l and Lx   L1 ⊂ LS.
Repeating the process, we have Ix   I1l1   ···   Itlt for li = 1, . . . , ki and Lx   L1  

L2   ···   Lt ⊂ LS such that Li is the support lattice of Iili for li = 1, . . . , ki and

{I} = ∩ki

li=1{Iili}, i = 1, . . . , t.

The process will terminate, since Z[x]n is Northerian. Since LS is the smallest Z-saturated
Z[x]-lattice containing Lx and Lx ⊂ Lt ⊂ LS, we have Lt = satZ(Lx) = satZ(satx(L)) = LS.
Then Itlt is reﬂexive prime and the theorem is proved.

(cid:3)

Since the reﬂexive prime components of I have the same support lattice, by Corollary

4.9, they also have the same dimension.

Corollary 5.8 Any Laurent binomial σ-ideal I is dimensionally unmixed.

5.2 Well-mixed and perfect Laurent binomial σ-ideals

In this section, we give criteria for a Laurent binomial σ-ideal to be well-mixed and perfect
in terms of its support lattice and show that the well-mixed and perfect closures of a Laurent
binomial σ-ideal are still binomial.

For S ⊂ F{Y±}, let S′ = {f gx|f g ∈ S}. We deﬁne inductively: S0 = S, Sn = [Sn−1]′, n =
1, 2, . . .. The union of the Sn is clearly a well-mixed σ-ideal and is contained in every well-
mixed σ-ideal containing S. Hence this union is hSi. If I ⊂ F{Y±} is a Laurent σ-ideal, then
hIi ia called the well-mixed closure of I. We ﬁrst prove some basic properties of well-mixed
σ-ideals. Note that these properties are also valid in F{Y}.
Lemma 5.9 Let I1, . . . ,Is be prime σ-ideals. Then I = ∩s

i=1Ii is a well-mixed σ-ideal.

19

Proof: It is obvious.

(cid:3)

1 and t = f2gx

Lemma 5.10 Let S1, S2 be two subsets of F{Y±} which satisfy a ∈ Si implies σ(a) ∈ Si, i =
1, 2. Then [S1]n[S2]n ⊂ [S1S2]n.
Proof: Let s ∈ [S1]1 and t ∈ [S2]1. Then s = f1gx
2 where f1g1 ∈ [S1], f2g2 ∈ [S2].
Then, f1g1f2g2 ∈ [S1S2], and st = f1f2(g1g2)x ∈ [S1S2]1. Hence, [S1]1[S2]1 ⊂ [S1S2]1. By
induction, [S1]n[S2]n ⊂ [S1S2]n.
Lemma 5.11 Let S1, S2 be two subsets of F{Y±} which satisfy a ∈ Si implies σ(a) ∈ Si, i =
1, 2. Then p[S1S2]n =p[S1]n ∩ [S2]n for n ≥ 1, and phS1i ∩phS2i =phS1S2i.
Proof: The last statement is an immediate consequence of the ﬁrst one. Since [S1S2] ⊂ [Si],
we have [S1S2]n ⊂ [Si]n for i = 1, 2, and [S1S2]n ⊂ [S1]n ∩ [S2]n follows. Hence, p[S1S2]n ⊂
p[S1]n ∩ [S2]n. Let a ∈ [S1]n ∩ [S2]n we have a2 ∈ [S1]n[S2]n. By Lemma 5.10, a2 ∈ [S1S2]n.
Hence a ∈p[S1S2]n, and p[S1]n ∩ [S2]n ⊂p[S1S2]n follows.
Lemma 5.12 Let I1, . . . ,Im be Laurent σ-ideals.
i=1phIii.
Then ph∩m
i=1Ii. Then √I = p[Qm
Proof: Let I = ∩m
qQn−1
i=1 hIii ∩phIni = . . . = ∩m
i=1 Ii ⊂ I, we have phQm
Qm
phI mi ⊂phQm
i=1 Iii, and hence phIi =phQm
Now, we prove a basic property for a σ-ﬁeld F.

i=1 Ii]. By Lemma 5.11, we have phQm
i=1phIii. Now we show that phIi = phQm
i=1phIii.

i=1 Iii =
i=1 Iii. Since
i=1 Iii ⊂ phIi. By Lemma 5.11, phIi = phIi ∩ ··· ∩phIi =

i=1 Iii. Then, phIi = ∩m

i=1Iii = ∩m

m be the primitive m-th root of unity, where i = √−1 and m ∈
Lemma 5.13 Let ζm = e
Z≥2. If F is algebraically closed, then there exists an om ∈ [0, m−1] such that gcd(om, m) = 1
and σ(ζm) = ζ om

m . Furthermore, the perfect σ-ideal {ym − 1} in F{y} is

(cid:3)

2πi

(cid:3)

(cid:3)

where y is a σ-indeterminate.

{ym − 1} = [ym − 1, yx − yom]

(25)

Proof: Since F is algebraically closed, ζm is in F. From ym−1 =Qm−1
σ(y)m − 1 =Qm−1
By the diﬀerence Nullstellensatz [4, p.87], we have {ym − 1} = ∩m−1

m) = 0, we have
m) = 0. Then, there exists an om such that 0 ≤ om ≤ m − 1 and
m . Suppose gcd(om, m) = d > 1 and let om = dk, m = ds, where s ∈ [1, m − 1].
m) = ζ oms

j=0 (σ(y) − ζ j
m = ζ dks

m = 1, which implies ζ s

σ(ζm) = ζ om
Then σ(ζ s

m = 1, a contradiction.

j=0 [y − ζ j

j=0 (y−ζ j

m = ζ km

m)x + ζ xj

to show (25), it suﬃces to show ∩m−1
(y − ζ j
we have yx − yom ∈ ∩m−1
f ∈ ∩m−1

m − yom = (y − ζ j
j=0 [y − ζ j
m]. Since yx − yom ∈ [y − ζ j

j=0 [y− ζ j

j=0 [y − ζ j
m)x + ζ jom
m] and hence [ym − 1, yx − yom] ⊂ ∩m−1

m]. In order
m] = [ym − 1, yx − yom]. Since yx − yom =
m] for any 0 ≤ j ≤ m − 1,
m]. Let
m], we have

m − yom ∈ [y − ζ j
m], for j = 0, . . . , m− 1, from f ∈ [y − ζ j

j=0 [y − ζ j

20

j=0 [y − ζ j

j=0 (gj (y − ζ j

m) +
j=0 gj(ym−1)+p, where p ∈ [yx−yom]. Hence, f ∈ [ym−1, yx−yom]

m) +Pk hjk(yx − yom)xk , where gj, hjk ∈ Q{y}. Then f m =Qm−1
m] ⊂ [ym − 1, yx − yom]. The lemma is proved.

f = gj(y − ζ j
Pk hjk(yx−yom)kx) =Qm−1
and ∩m−1
The number om introduced in Lemma 5.13 depends on F only and is called the m-th
transforming degree of unity. In the following corollaries, F is assumed to be algebraically
closed and hence om is ﬁxed for any m ∈ N. From the proof of Lemma 5.13, we have
Corollary 5.14 yx − yom ∈ ∩m−1
Corollary 5.15 For n, m, k in N, if n = km then on = om mod m.

j=0 [y − ζ j
m].

(cid:3)

Proof: By deﬁnition, ζ k
have ζ on

m = ζ om

m . Then on = om mod m.

n = ζm. Then, σ(ζ k

n) = ζ kon

n = ζ on

m . From, σ(ζ k

n) = σ(ζm) = ζ om

m , we
(cid:3)

Lemma 5.16 hym − 1i = {ym − 1} = [ym − 1, yx − yom].
Proof: By Lemma 5.13, it suﬃces to show yx− yom ∈ hym− 1i. Since ym− 1 =Qm−1
j=0 (y− ζ j
m)
and (y − ζ i
m) ∈ hym − 1i for
i = 0, . . . , m − 1. We will show that yx − yom ∈ (f0, . . . , fm−1). To show this, we need the
formula

m )Q0≤j≤m−1,j6=i(y − ζ j

from [11, p. 494]. We have

1

ζ i
m
y−ζ i
m

i=0

Let g(y) = 1

mPm−1
m − ζ j

ym−1
ζ (om+1)i
m
y−ζ i
m
Q0≤i≤m−1,i6=j (ζ i
m ζ (om+1)j
m) = 1
deg(g(y)) ≤ m − 1 and g(ζ j
m) = (ζ j
yx − yom ∈ (f0, . . . , fm−1) ⊂ hym − 1i.

m

m) = 1

m ζ (om+1)j
ζ j(m−1)
m)om. Since
m
m)om for j = 0, . . . , m − 1, we have g(y) = yom. Hence

m ζ (om+1)j
m − 1) = 1

Q1≤i≤m−1(ζ i

= 1
m |y=ζ j
m m = (ζ j

ym−1
y−ζ j
m ζ omj

m

m

m

(cid:3)

Corollary 5.17 For m ∈ N, a ∈ F ∗, and f ∈ Z[x]n, we have Y(x−om)f −ax−om ∈ hYmf −ami.
Proof: Let z = Yf
a and I = [Ymf − am]. Then zm − 1 ∈ I. By Lemma 5.16, zx−om − 1 ∈
hzm − 1i ⊂ hIi. Then ( Yf

a )x−om − 1 ∈ hIi or Y(x−om)f − ax−om ∈ hIi.

(cid:3)

The following example shows that the generators of a well-mixed or perfect ideal depend

on the diﬀerence ﬁeld F.

21

m)x = (yx − ζ omi
ym−1 =Pm−1
m−1Xi=0

1
m

i=0

m(ζ i

ζ i
mfi =

1

i=0

ζ i
m

1
m

m)m−1(y−ζ i

m ), we have fi = (yx − ζ omi
mPm−1
ym − 1
y − ζ i
ym − 1
y − ζ i
m−1Xi=0

m) = 1
m−1Xi=0
m−1Xi=0
= yx −

ym − 1
y − ζ i
. Then, g(ζ j

1
m

1
m

ζ i
m

=

m

m

m

(yx − ζ omi
m )
m−1Xi=0

yx −

1
m

ζ (om+1)i
m

.

ζ i
m

ym − 1
y − ζ i

m

ζ omi
m

Example 5.18 Let F = Q(√−3) and p = y3
√−3, we have o3 = 1 and hpi = {p} = [p, yx
hpi = {p} = [p, yx

1 − y2
1].

1 − 1. Following Lemma 5.13, if σ(√−3) =
1 − y1]. If σ(√−3) = −√−3, we have o3 = 2 and

Motivated by Corollary 5.17, we have the following deﬁnition.

Deﬁnition 5.19 If a Z[x]-lattice L satisﬁes

mf ∈ L ⇒ (x − om)f ∈ L

(26)

where m ∈ N, f ∈ Z[x]n, and om is deﬁned in Lemma 5.13, then it is called M-saturated.
For any Z[x]-lattice L, the smallest M-saturated Z[x]-lattice containing L is called the M-
saturation of L and is denoted by satM (L).

The following result gives an eﬀective version for condition (26).

Lemma 5.20 A Z[x]n-lattice L is M-saturated if and only if the following condition is true:
Let L1 = satZ(L) = (g1, . . . , gs) such that migi ∈ L for mi ∈ N. Then (x − omi)gi ∈ L.
Proof: We need only to show (x − omi)gi ∈ L implies (26). For any mf ∈ L, we have
f ∈ L1 and hence f =Pr
i=1 qigi, where qi ∈ Z[x]. Let t = lcm(m, m1, . . . , ms). By Corollary
5.15, we have ot = omi + cimi, where ci ∈ Z. Then (x − ot)f = Pr
i=1 qi(x − ot)gi =
Pr
i=1 qi(x − omi)gi −Pr
i=1 qicimigi ∈ L. By Corollary 5.15, ot = om + cm, where c ∈ Z.
Then (x − om)f = (x − ot)f + cmf ∈ L.

(cid:3)

We now give a criterion for a Laurent binomial σ-ideal to be well-mixed.

Theorem 5.21 Let ρ be a partial character and F an algebraically closed and inversive σ-
ﬁeld. If I(ρ) is well-mixed, then Lρ is M-saturated. Conversely, if Lρ is M-saturated, then
either hI(ρ)i = [1] or I(ρ) is well-mixed.
Proof: Suppose that I(ρ) is well-mixed. If there exists an m ∈ N such that mf ∈ Lρ, then by
Lemma 4.17, there exists a c ∈ F ∗ such that Ymf − c ∈ I(ρ). Since F is algebraically closed,
there exists an a ∈ F ∗ such that c = am. Then, Ymf − am ∈ I(ρ). Since I(ρ) is well-mixed,
by Corollary 5.17, Y(x−om)f − ax−om ∈ I(ρ), and by Lemma 4.17 again, (x − om)f ∈ Lρ
follows and Lρ is M-saturated.

Conversely, let Lρ be M-saturated.

If Lρ is Z-saturated, then by Theorem 5.3, I(ρ)
is prime and hence well-mixed by Lemma 5.9. Otherwise, there exists an m1 ∈ N, and
f ∈ Z[x]n such that f 6∈ Lρ and m1f ∈ Lρ. By Lemma 4.17, there exists an a ∈ F ∗ such that
Ym1f − am1 ∈ I(ρ). We claim that either hI(ρ)i = [1] or

I(ρ) = ∩m1−1

l1=0 Il1

(27)

where Il1 = [I(ρ), Yf − aζ l1
m1 . By (26), (x − om1)f ∈ Lρ. By Lemma
4.17, there exists a b ∈ F ∗ such that Y(x−om1 )f − b ∈ I(ρ). Since Ym1f − am1 ∈ I(ρ), by
m1] for any l1. Then b − ax−om1 =
Corollary 5.14, we have Y(x−om1 )f − ax−om1 ∈ [Yf − aζ l1

m1] and ζm1 = e

2πi

22

l1=0 Il1. From f ∈ Il1, we have f = fl1 +Ps

Y(x−om1 )f − ax−om1 − (Y(x−om1 )f − b) ∈ Il1 for any l1. If b 6= ax−om1 , Il1 = [1] for all l1,
and hence 1 ∈ ∩m1−1
l1=0 Il1 ⊂ hI(ρ)i by Lemma 5.16 and hI(ρ)i = [1] follows. Now suppose
b = ax−om1 or ax = baom1 . To prove (27), it suﬃces to show ∩m1−1
l1=0 Il1 ⊂ I(ρ). Let
f ∈ ∩m1−1
m1), where fl1 ∈ I(ρ). By
Lemma 5.13, σ(ζm1) = ζ
σ(Yf − aζ l1

om1
m1 . We thus have
m1) = Yxf − bYom1 f + bYom1 f − σ(aζ l1
m1)
) + (baom1 − σ(a))ζ

= Yom1 f (Y(x−om1 )f − b) + b(Yom1 f − aom1 ζ

j=0 pjσj(Yf − aζ l1

l1om1
m1

l1om1
m1

.

m1) =
m1), where gl1 ∈ I(ρ). Using the above equation repeatedly, we have
m1)) =
l1=0 pl1 ∈ I(ρ), where s is in I(ρ). By

Since Y(x−om1 )f − b ∈ I(ρ) and baom1 − σ(a) = baom1 − ax = 0, we have σ(Yf − aζ l1
gl1 + ql1(Yf − aζ l1
m1), where hl1 ∈ I(ρ). Then, f m1 = Qm1−1
l1=0 (hl1 + pl1(Yf − aζ l1
f = hl1 + pl1(Yf − aζ l1
m1) = s + (Ym1f − am1)Qm1−1
s +Qm1−1
l1=0 pl1(Yf − aζ l1
Corollary 4.10, we have f ∈ I(ρ). The claim is proved.
The support lattice for any of [Il1] is L1 = (Lρ, f ). Similar to the proof of Theorem 5.5,
we can show that I(ρ)   Il1 and Lρ   L1. If L1 is not Z-saturated, there exists a k > 1 and
g ∈ Z[x]n such that g 6∈ L1 and kg ∈ L1. Let m2 = km1. We have m2g = km1g ∈ Lρ and
there exists a c ∈ F ∗ such that Ym2g − cm2 ∈ I(ρ). Hence, (x − om2)g ∈ Lρ ⊂ L1 and there
exists a d ∈ F ∗, such that Y(x−om2 )g−d ∈ I(ρ). Let L2 = (L1, g) and Il1,l2 = [Il1, Yg−cζ l2
m2],
l2 = 0, . . . , m2 − 1. Then L1   L2 and L2 is the support lattice for all Il1,l2 provided
Il1,l2 6= [1]. Similar to the above, it can be shown that d − cx−om2 ∈ Il1,l2 for any l1, l2.
If d − cx−om2 6= 0, then Il1,l2 = [1] for any l1, l2 and hIl1i = [1] by Lemma 5.16. Since
Laurent binomial σ-ideals are radical, hI(ρ)i = ∩m1−1
l1=0 hIl1i = [1] by Lemma 5.12 and (27). If
d−cx−om2 = 0, it can be similarly proved that Il1 = ∩m2−1
l2=0 Il1,l2 for any l1. As a consequence,
l1=0 ∩m2−1
l1=0 Il1 = ∩m1−1
we have either hI(ρ)i = [1] or I(ρ) = ∩m1−1
Repeating the process, we have either hI(ρ)i = [1] or

l2=0 Il1,l2.

I(ρ) = ∩m1−1

l1=0 Il1 = ··· = ∩m1−1

l1=0 ··· ∩mt−1

lt=0 Il1,...,lt

where Lρ   L1   ···   Lt ⊂ satZ(Lρ). Since Z[x]n is Notherian, the procedure will terminate
and Lt is Z-saturated. Since each Il1,...,lt is either [1] or a prime σ-ideal, and hence either
hI(ρ)i = [1] or I(ρ) is well-mixed by Lemma 5.9.

(cid:3)

The following example shows that hI(ρ)i = [1] can indeed happen in Theorem 5.21.

1 + 1, yx

2 − yx

Example 5.22 Let I = [A], where A = {y2
support lattice of I is M-saturated. We have y2
Corollary 5.17, y1yx
1 y2 ∈ hIi. From yx
1 ∈ hIi. This also shows that a binomial σ-ideal is generally not well-mixed.
Theorem 5.23 Let F be an algebraically closed and inversive σ-ﬁeld and I = I(ρ) a Laurent
binomial σ-ideal. Then the well-mixed closure of I is either [1] or a Laurent binomial σ-ideal
whose support lattice is satM (Lρ).

1 − y1, y2
2 + y2} is a σ-chain. The
1 = y2
2 − y2
1 + 1) ∈ I. Then by
2 + y2 ∈ I, we have y1y2 ∈ hIi and hence

2 + 1, yx
2 + 1 − (y2

1 − y1, yx

23

Proof: Suppose that hI(ρ)i 6= [1]. If L is not M-saturated, then there exists an m ∈ N and
f ∈ Z[x]n such that f 6∈ L, mf ∈ L, and (x − om)f 6∈ L. By Lemma 4.17, there exists a
c ∈ F ∗ such that Ymf − cm ∈ I(ρ). Let I1 = [I, Y(x−om)f − cx−om] and L1 = (L, (x − om)f ).
By Corollary 5.17, Y(x−om)f − cx−om ∈ hI(ρ)i. Let LM = satM (L). Then I   I1 ⊂ hIi
and L   L1 ⊂ LM . Repeat the procedure to construct Ii and Li for i = 2, . . . , t such that
I   I1   ···   It ⊂ {I} and L   L1   ···   Lt ⊂ LM . Since Z[x]n is Notherian, the
procedure will terminate at, say t. Then Lt = LM is M-saturated. By Lemma 5.27, Lt is
(cid:3)
also x-saturated. By Theorem 5.21, It ⊂ hIi is well-mixed and hence It = hIi.

By the proof of Theorem 5.23, we have

Corollary 5.24 A Z[x]-lattice and its M-saturation have the same rank.

Example 5.25 Let p = y2
2 − 1, y1−x
hpi = {p} = [y−2

1 y2

1

1 y2].

2 − y2
1. Following the proof of Theorem 5.23, it can be shown that
yx−1
2 − 1] = [y2

2 − yx

2 − y2

1, y1yx

In the rest of this section, we prove similar results for the perfect closure of Laurent

binomial σ-ideals. We ﬁrst give a deﬁnition.

Deﬁnition 5.26 If a Z[x]-lattice is both x-saturated and M-saturated, then it is called P-
saturated. For any Z[x]-lattice L, the smallest P-saturated Z[x]-lattice containing L is called
the P-saturation of L and is denoted by satP (L).

Lemma 5.27 For any Z[x]-lattice L, satP (L) = satx(satM (L)) = satM (satx(L)).

Proof: Let L1 = satx(satM (L)) and L2 = satM (satx(L)). It suﬃces to show L1 = L2. We
claim that L1 is P-saturated. Let mf ∈ L1 for m ∈ N. Then mxaf ∈ satM (L) for some
a ∈ N, which implies (x − om)xaf ∈ L ⊂ satx(satM (L)) = L1. Since L1 is x-saturated,
(x − om)f ∈ L1 and the claim is proved. Since L ⊂ satM (L), satx(L) ⊂ satx(satM (L)) = L1.
From the claim, L1 is P-saturated and hence L2 ⊂ satM (L1) = L1.

For the other direction, we claim that L2 is x-saturated. Let xf ∈ satM (satx(L)) ⊂
satZ(satx(L)). Then there exists an m ∈ N, such that mf ∈ satx(L) which implies (x −
om)f ∈ satM (satx(L)) and hence omf = xf − (x − om)f ∈ satM (satx(L)) follows. By Lemma
5.13, gcd(om, m) = 1. Then f ∈ satM (satx(L)), and the claim is true. Since satM (L) ⊂
satM (satx(L)) = L2 = satx(satM (satx(L))), we have L1 ⊂ L2.

(cid:3)

It is easy to check that a σ-ideal I is perfect if and only if I is reﬂexive, radical, and
well-mixed. Since a Laurent binomial σ-ideal I is always radical, I is perfect if and only if I
is reﬂexive and well-mixed. From this observation, we can deduce the following result about
perfect Laurent binomial σ-ideal ideals.

Theorem 5.28 Let ρ be a partial character and F an algebraically closed and inversive σ-
ﬁeld. If I(ρ) is perfect, then Lρ is P-saturated. Conversely, if Lρ is P-saturated, then either
{I(ρ)} = [1] or I(ρ) is perfect. Furthermore, the perfect closure of I(ρ) is either [1] or a
Laurent binomial σ-ideal whose support lattice is satP (Lρ).

24

Proof: If I(ρ) is perfect, then it is well-mixed and reﬂexive. By Theorems 5.21 and The-
orem 5.3, Lρ is M-saturated and x-saturated, and hence P-saturated. Conversely, if Lρ is
P-saturated, it is M-saturated and x-saturated. By Theorem 5.21, either hI(ρ)i = [1] or I(ρ)
is well-mixed. If hI(ρ)i = [1], {I(ρ)} = [1]. Otherwise, by Theorem 5.3, I(ρ) is reﬂexive.
By Corollary 4.10, I(ρ) is radical. Then I(ρ) is perfect.

By Lemma 5.27, Lp = satP (Lρ) = satM (satx(Lρ)). Then the perfect closure of I(ρ) is
the well-mixed closure of the reﬂexive closure of I(ρ), and then is either [1] or a Laurent
binomial σ-ideal whose support lattice is LP by Theorems 5.5 and 5.23.

(cid:3)

6 Binomial σ-ideal

6.1 Basic properties of binomial σ-ideal

In this section, it is shown that certain results from [7] can be extended to the diﬀerence
case using the theory of inﬁnite Gr¨obner basis.

A σ-binomial in Y is a σ-polynomial with at most two terms, that is, aYa + bYb where
a, b ∈ F and a, b ∈ N[x]n. For f ∈ Z[x]n, let f +, f − ∈ Nn[x] denote the positive part and
the negative part of f such that f = f + − f −. Consider a σ-binomial f = aYa + bYb, where
a, b ∈ F ∗. Without loss of generality, assume a > b according to the order deﬁned in Section
3. Then f has the following canonical representation

(28)
a , f = a − b ∈ Z[x]n is a normal vector, and g = a − f + ∈ N[x]. The normal

f = aYa + bYb = aYg(Yf + − cYf −

where c = −b
vector f is called the support of f . Note that gcd(Yf +, Yf −

) = 1.

)

A σ-ideal in F{Y} is called binomial if it is generated by, possibly inﬁnitely many, σ-

binomials.

i

In this section, F{Y} is considered as a polynomial ring in inﬁnitely many algebraic
variables Θ(Y) = {yxj
, i = 1, . . . , n; j ≥ 0} and denoted by S = F[Θ(Y)]. A theory of
Gr¨obner basis in the case of inﬁnitely many variables is developed in [14] and will be used
in this section. For any m ∈ N, denote Θhmi(Y) = {yxj
, i = 1, . . . , n; j = 0, 1, . . . , m} and
Shmi = F[Θhmi(Y)] is a polynomial ring in ﬁnitely many variables.

A monomial order in S is called compatible with the diﬀerence structure, if yxk1

i

i < yxk2

i

for k1 < k2. Only compatible monomial orders are considered in this section.

Let I be a σ-ideal in F{Y}. Then I is an algebraic ideal in S. By [14], we have

Lemma 6.1 Let I be a binomial σ-ideal in F{Y}. Then for a compatible monomial order,
the reduced Gr¨obner basis G of I exists and satisﬁes
m=0Ghmi

(29)

G = ∪∞

where Ghmi = G ∩ Shmi is the reduced Gr¨obner basis of I hmi = I ∩ Shmi in Shmi.

Contrary to the Laurent case, a binomial σ-ideal may be inﬁnitely generated, as shown

by the following example.

25

Example 6.2 Let I = [yxi
ﬁnite set of generators and hence a ﬁnite Gr¨obner basis. The Gr¨obner basis of

2 : 0 ≤ i < j ∈ N]. It is clear that I does not have a

2 − yxj

1 yxi

1 yxj

I hmi = I ∩ Q[y1, y2; yx

1 , yx

2 ; . . . ; yxm

1 , yxm

2

]

1

2

1 yxj

1 yxi

1 < yx

2 − yxi
1 < yxm

1 yxi
2 . Then {yxi

2 : 0 ≤ i < j ≤ m} with a monomial order satisfying y1 < y2 < yx

2 <
2 : 0 ≤ i < j ∈ N} is an inﬁnite reduced Gr¨obner basis
and yxm
are treated as independent algebraic variables.

1 yxj
is {yxi
2 − yxj
··· < yxm
for I in the sense of [14] when yxm
Remark 6.3 The above concept of Gr¨obner basis does not consider the diﬀerence structure.
The concept may be reﬁned by introducing the reduced σ-Gr¨obner basis [12]. A σ-monomial
M1 is called reduced w.r.t. another σ-monomial M2 if there do not exist a σ-monomial M0
and a k ∈ N such that M1 = M0M xk
2 . Then the reduced σ-Gr¨obner basis of I in Example
6.2 is {y1yxi
1 y2 : i ∈ Z≥1} which is still inﬁnite. Since the purpose of Gr¨obner basis
in this paper is theoretic and not computational, we will use the version of inﬁnite Gr¨obner
basis in the sense of [14].

2 − yxi

With Lemma 6.1, a large portion of the properties for algebraic binomial ideals proved
by Eisenbud and Sturmfels in [7] can be extended to the diﬀerence case. The proofs follow
the same pattern: to prove a property for I, we ﬁrst show that the property is valid for I
if and only if it is valid for all I hmi, and then the corresponding statement from [7] will be
used to show that the property is indeed valid for I hmi. We will illustrate the procedure in
the following corollary. For other results, we omit the proofs.

Corollary 6.4 Let I ⊂ F{Y} be a binomial σ-ideal. Then the Gr¨obner basis G of I consists
of σ-binomials and the normal form of any σ-term modulo G is again a σ-term.

Proof: By a σ-term, we mean the multiplication of an element from F ∗ and a σ-monomial.
By (29), it suﬃces to show that corollary is valid for all Ghmi, that is, the Gr¨obner basis
Ghmi of I hmi consists of binomials and the normal form of any term modulo Ghmi is again
a term. Since Ghmi is the Gr¨obner basis of I hmi = I ∩ Shmi and I hmi is a binomial ideal in
a polynomial ring with ﬁnitely many variables, the corollary follows from Proposition 1.1 in
(cid:3)
[7].

Corollary 6.5 A σ-ideal I is binomial if and only if the reduced Gr¨obner basis for I consists
of σ-binomials.

Corollary 6.6 If I is a binomial σ-ideal, then the elimination ideal I ∩ F{y1, y2, . . . , yr} is
binomial for every r ≤ n.

The following lemma can be proved similar to its algebraic counterpart.

Lemma 6.7 If I and J are binomial σ-ideals in F{Y} then we have I ∩ J = [tI + (1 −
t)J ] ∩ F{Y} where t is a new σ-indeterminate.

The intersection of binomial σ-ideals is not binomial in general, but from Lemma 6.7 and

[7] we have

26

′

Corollary 6.8 If I and I
σ-monomials, then [I + I
Corollary 6.9 Let I be a binomial σ-ideal and let J1, . . . ,Js be monomial σ-ideals.

are binomial σ-ideals and J1, . . . ,Js are σ-ideals generated by

] ∩ [I + J1] ∩ . . . ∩ [I + Js] is binomial.

′

(a) The intersection [I + J1] ∩ ··· ∩ [I + Js] is generated by σ-monomials modulo I.
(b) Any σ-monomial in the sum I + J1 + ··· + Js lies in one of the σ-ideals I + Ji.

Corollary 6.10 If I is a binomial σ-ideal, then for any σ-monomial M , the σ-ideal quo-
tients [I : M ] and [I : M ∞] are binomial.
Corollary 6.11 Let I be a binomial σ-ideal and J a monomial σ-ideal. If f ∈ I + J and
g is the sum of those terms of f that are not individually contained in I + J , then g ∈ J .

From [7, Theorem 3.1], we have

Theorem 6.12 If I is a binomial σ-ideal, then the radical of I is binomial.

Finally, we consider the reﬂexive closure of binomial σ-ideals.

Lemma 6.13 A binomial σ-ideal I is reﬂexive if and only if bx ∈ I ⇒ b ∈ I for any
σ-binomial b ∈ F{Y}.
Proof: It suﬃces to prove one side of the statement, that is, if bx ∈ I ⇒ b ∈ I for any
σ-binomial b then I is reﬂexive. Let p be a σ-polynomial such that px ∈ I. Then, there
exists an m ∈ N such that px ∈ I hmi = I ∩ Shmi. Let G be the (ﬁnite) reduced Gr¨obner basis
of I hmi in Shmi under the variable order yxj
i < yk for any i, k, j > 0. By Proposition 1.1 in
[7], G consists of binomials. px can be reduced to zero by G. Due to the chosen variable
order, we have px =Pi ex
i are
σ-binomials in I, we have gi ∈ I. Then, p =Pi eigi ∈ I and I is reﬂexive.
(cid:3)
Theorem 6.14 If I is a binomial σ-ideal, then the reﬂexive closure of I is binomial.
Proof: Let I1 be the σ-ideal generated by the σ-binomials p such that pxk ∈ I for a k ∈ N.
We claim that I1 is the reﬂexive closure of I and it suﬃces to show that I1 is reﬂexive. Let
= pxs+1 ∈ I. Thus p ∈ I1
p be a σ-binomial such that px ∈ I1. Then for some s ∈ N, (px)xs
and I1 is reﬂexive by Lemma 6.13.

is a σ-binomial in Shmi. Since gx

i ∈ Shmi and gx

(cid:3)

i gx

i , where ex

i

6.2 Normal binomial σ-ideal

In this section, most of the results about Laurent binomial σ-ideals proved in Sections 4 and
5 will be extended to normal binomial σ-ideals.

Let  be the multiplicative set generated by yxj
i

for i = 1, . . . , n, j ∈ N. A σ-ideal I is

called normal if for M ∈  and p ∈ F{Y}, M p ∈ I implies p ∈ I. For any σ-ideal I,

I :  = {f ∈ F{Y}|∃M ∈  s.t. M f ∈ I}

27

is a normal σ-ideal. For any σ-ideal I in F{Y}, it is easy to check that

F{Y±}I ∩ F{Y} = I : .

(30)

We ﬁrst prove a property for general normal σ-ideals.

Lemma 6.15 A normal σ-ideal I in F{Y} is reﬂexive (radical, well-mixed, perfect, prime)
if and only if F{Y±}I is reﬂexive (radical, well-mixed, perfect, prime) in F{Y±}.
Proof: Let I = F{Y±}I be a Laurent σ-ideal. Since I is normal, from (30) we have
I ∩ F{Y} = I. If I is reﬂexive, it is clear that I is reﬂexive. For the other direction, if
f x ∈ I, then by clearing denominators of f x, there exists a σ-monomial M x in Y such that
M xf x ∈ I ∩F{Y} = I. Since I is reﬂexive, M f ∈ I and hence f ∈ I, that is, I is reﬂexive.
The results about radical and perfect σ-ideals can be proved similarly.

We now show that I is prime if and only if I is prime. If I is prime, it is clear that I is
also prime. For the other side, let f g ∈ I. Then there exist σ-monomials N1, N2 such that
N1f ∈ F{Y}, N2g ∈ F{Y}, and hence N1f N2g ∈ I. Since I is prime, N1f or N2g is in I
that is f or g is in I. The result about well-mixed σ-ideals can be proved similarly.

(cid:3)

Given a partial character ρ on Z[x]n, we deﬁne the following binomial σ-ideal in F{Y}
(31)

I +(ρ) = [Yf +

− ρ(f )Yf −

| f ∈ Lρ].

We will show that any normal binomial σ-ideal can be written as the form (31).

Lemma 6.16 Let ρ be a partial character on Z[x]n and I(ρ) deﬁned in (19). Then I +(ρ) =
I(ρ) ∩ F{Y}. As a consequence, I +(ρ) is proper and normal.
Proof: It is clear that I +(ρ) ⊂ I(ρ)∩ F{Y}. If f ∈ I(ρ)∩F{Y}, then f =Ps
i=1 fiMi(Yfi −
ρ(fi)) where fi ∈ F, fi ∈ Lρ, and Mi are Laurent σ-monomials in Y. There exists a σ-
monomial M in Y such that

M f =

sXi=1

fiNi(Yf +

i − ρ(fi)Yf

−

i ) ∈ I +(ρ),

(32)

i − ρ(fi)Yf

, i = 1, . . . , n, k ∈ N. If Ni contains yxo

i ) to the left hand side of (32) and let f1 = f − Fi/yxo

where Ni is a σ-monomial in Y. We will prove f ∈ I +(ρ) from the above equation. Without
loss of generality, we may assume that M = yxo
for some c and o ∈ N. Note that (32) is
c
an algebraic identity in yxk
c as a factor, we move
i
Fi = fiNi(Yf +
−
c . Then
f ∈ I +(ρ) if and only if f1 ∈ I +(ρ). Repeat the above procedure until no Ni contains yxo
c
as a factor.
i ) = 1, yxo
c
i be the largest σ-monomial in (32) not
is the largest σ-monomial
c , the proving process is similar. There must exists another σ-
j . Let Ni = Ypi, Nj = Ypj . Then

cannot be a factor of both Yf +
containing yxo
in (32) not containing yxo
binomial fjNj(Yf +
j − ρ(fj)Yf

If s = 0 in (32), then f = 0 and the lemma is proved. Since gcd(Yf +

i , Yf

c under a given σ-monomial total order .

−

j ) such that NiYf +

i = NjYf

i and Yf −

i . Let Yf +

−

If Yf

−
i

−

28

−

j ) = fi

−

−

−

−

i + f +

i +pi = Yf

−

c , move the term fi

i or Yf

−

i not containing yxo

j +pj and f +
ρ(fj ) (Yf +
i + pi) = f +

i + pi = f −

j + pj. We have p = fiNi(Yf +

i ) + fjNj(Yf +

j −
j ). Since f =

i − ρ(fi)Yf
j − ρ(fj)Yf
j +pj − ρ(fi)ρ(fj)Yf

ρ(fj ) )Nj(Yf +
i +pi) + (fj − fi
j = fi + fj ∈ Lρ, we have Yf +

j +pj − ρ(fi)ρ(fj)Yf
i − f −
j − f −
ρ(fj ) N (Yf + − ρ(f )Yf −

Yf +
ρ(fj)Yf
f +
j + pj − (f −
i +pi =
N (Yf + − ρ(f )Yf −
) ∈ I +(ρ), where N is a σ-monomial. As a consequence, p ∈ I +(ρ). If
N contains yxo
) to the left hand side of (32) as we
did in the ﬁrst phase of the proof. After the above procedure, equation (32) is still valid.
Furthermore, the number of σ-binomials in (32) does not increase, no Ni contains yxo
c , and
the largest σ-monomial Yf +
c becomes smaller. The above procedure
will stop after a ﬁnite number of steps, which means s = 0 in (32) and hence yxo
c f = 0 which
means the original f is in I +(ρ). Then I +(ρ) = I(ρ) ∩ F{Y}.
I +(ρ) = I(ρ) ∩ F{Y} is proper. For otherwise I(ρ) = [1], contradicting to Lemma 4.16.
Note that I +(ρ)F{Y±} = I(ρ). Then I +(ρ) = I(ρ) ∩ F{Y} = I +(ρ)F{Y±} ∩ F{Y} =
I +(ρ) : , and I +(ρ) is normal.
Lemma 6.17 Let ρ be a partial character over Z[x]n. Then Yf + − cYf −
if f ∈ Lρ and c = ρ(f ).
Proof: By Lemma 6.16, Yf + − cYf −
to f ∈ Lρ and c = ρ(f ) by Lemma 4.17.

∈ I +(ρ) if and only if Yf − c ∈ I(ρ) which is equivalent

∈ I +(ρ) if and only

(cid:3)

(cid:3)

Lemma 6.18 If I is a normal binomial σ-ideal, then there exists a unique partial character
ρ on Z[x]n such that I = I +(ρ) and Lρ = {f ∈ Z[x]n | Yf + − ρ(f )Yf −
∈ I} which is called
the support lattice of I.
Proof: We have I·F{Y±}∩F{Y} = I : . By Theorem 4.18, there exists a partial character
ρ such that I · F{Y±} = I(ρ). Then by Lemma 6.16, I = (I : ) = I · F{Y±} ∩ F{Y} =
I(ρ) ∩ F{Y} = I +(ρ). By Lemma 6.17, we have Lρ = {f ∈ Z[x]n | Yf + − ρ(f )Yf −
∈ I =
I +(ρ)}. The uniqueness of ρ comes from the fact that Lρ is uniquely determined by I. (cid:3)

By Lemmas 6.16 and 6.18, we have

Theorem 6.19 The map I(ρ) ⇒ I +(ρ) gives a one to one correspondence between Laurent
binomial σ-ideals in F{Y±} and normal binomial σ-ideals in F{Y}.

Due to Lemma 6.16 and Theorem 6.19, most properties of Laurent binomial σ-ideals can
be extended to normal binomial σ-ideals. As a consequence of Corollary 4.10, Lemma 6.15,
and Lemma 6.16, we have

Corollary 6.20 A normal binomial σ-ideal is radical.

As a consequence of Theorem 5.5, Lemma 6.15, and Theorem 6.19.

Corollary 6.21 If F is inversive, then the reﬂexive closure of I +(ρ) is also a normal bino-
mial σ-ideal whose support lattice is the x-saturation of Lρ.

29

Corollary 6.22 If F is algebraically closed and inversive, then
(a) Lρ is Z-saturated if and only if I +(ρ) is prime;
(b) Lρ is x-saturated if and only if I +(ρ) is reﬂexive;
(c) Lρ is saturated if and only if I +(ρ) is reﬂexive prime.
Proof: It is easy to show that I(ρ) = I +(ρ)F{Y±}. Then the corollary is a consequence of
Theorem 5.3, Lemma 6.15, and Lemma 6.16.

(cid:3)

For properties related with perfect σ-ideals, it becomes more complicated. Direct exten-
sion of Theorems 5.7, and 5.28 to the normal binomial case is not correct as shown by the
following example.

1, yx

0

2 + y2] which is a normal binomial σ-ideal whose

Example 6.23 Let I = [yx
2 − y2
1 − y1, y2
representation matrix is L = (cid:20) x − 1 −2
x − 1 (cid:21). Since o2 = 1, L is P -saturated. Also,
2
0
Ls = sat(L) = (cid:20) x − 1 −1
1 (cid:21). We have {I} = {I, y2 − y1} ∩ {I, y2 + y1} = [y1, y2]. Then
{I} 6= [1] and I is not perfect and hence Theorems 5.28 are not correct. Theorem 5.7 is also
not correct, since the supporting lattice of the prime component of I is not Ls. This example
also shows that the perfect closure of a normal binomial σ-ideal is not necessarily normal.

0

It can be seen that the problem is due to the occurrence of σ-monomials. For any partial

character ρ, it can be shown that

We thus have the following modiﬁcations for Theorems 5.28 and 5.7.

{I +(ρ)} :  = {I(ρ)} ∩ F{Y}.

(33)

Corollary 6.24 Let F be an inversive and algebraically closed σ-ﬁeld. If I +(ρ) is perfect,
then Lρ is P -saturated. Conversely, if Lρ is P -saturated, then either {I} :  = [1] or I is
perfect. For any ρ, either {I +(ρ)} :  = [1] or {I +(ρ)} :  is a binomial σ-ideal whose
support lattice is the P -saturation of Lρ.
Proof: If I is perfect, by Lemma 6.15, I(ρ) = IF{Y±} is also perfect. By Theorem 5.28,
Lρ is P -saturated. If Lρ is P -saturated and x-saturated, by Theorem 5.28, either I(ρ) = [1]
or I(ρ) is perfect. If I(ρ) = [1], by (33), {I} :  = [1]. If I(ρ) is perfect, by Lemma 6.15,
I = I +(ρ) is also perfect.

(cid:3)

Similar results hold for normal well-mixed σ-ideals.

In the rest of this section, we give decomposition theorems for perfect binomial σ-ideals.
We ﬁrst consider normal binomial σ-ideals. By Corollary 6.20 and Example 5.22, a normal
binomial σ-ideal is radical but may not be perfect.

Theorem 6.25 Let I = I +(ρ) be a normal binomial σ-ideal and F an inversive and alge-
braically closed σ-ﬁeld. Then {I} :  is either [1] or can be written as the intersection of
reﬂexive prime binomial σ-ideals whose support lattice is the saturation lattice of Lρ.

30

Proof: By Theorem 5.7, either {I(ρ)} = [1] or {I(ρ)} =Ts
i=1 I(ρi), where I(ρi) are reﬂexive
prime σ-ideals whose support lattices are sat(Lρ). By (33) and Lemma 6.16, either {I +(ρ)} :
 = [1] or {I +(ρ)} :  = {I(ρ)} ∩ F{Y} = (Ts
i=1(I(ρi) ∩ F{Y}) =
Ts
i=1 I +(ρi). By Corollary 6.22, I +(ρi) is reﬂexive and prime whose support lattices are the
saturation of Lρ.

i=1 I(ρi)) ∩ F{Y} = Ts

(cid:3)

Now, consider general binomial σ-ideals.

Lemma 6.26 I ⊂ F{Y} is a reﬂexive prime binomial σ-ideal if and only if I = [yi1, . . . , yis]
+I1, where {yi1, . . . , yis} = Y ∩I, {z1, . . . , zt} = Y\I, and I1 is a normal binomial reﬂexive
prime σ-ideal in F{z1, . . . , zt}.
Proof: If I is reﬂexive and prime, then (yxj
i )d ∈ I if and only if yi ∈ I. Let I1 = I ∩
F{z1, . . . , zt}. Then I = [yi1, . . . , yis] + I1. I1 is clearly reﬂexive and prime. We still
need to show that I1 is normal. Let N f ∈ I1 for a σ-monomial N in {z1, . . . , zt} and
f ∈ F{z1, . . . , zt}. N cannot be in I1. Otherwise, some zi is in I1 since I1 is reﬂexive and
prime, which contradicts to {z1, . . . , zt} = Y\I. Therefore, f ∈ I1 and I1 is normal. The
other direction is trivial.

(cid:3)

The σ-ideal I in Lemma 6.26 is said to be quasi-normal. The following result can be

proved similarly to Theorem 5.7.

Theorem 6.27 Let I be a binomial σ-ideal.
If F is algebraically closed and inversive,
then the perfect σ-ideal {I} is either [1] or the intersection of quasi-normal reﬂexive prime
binomial σ-ideals.

Proof: We prove the theorem by induction on n. Let I1 = {I} : . Then {I} = I1 ∩
∩n
i=1{I, yi}. It is easy to check I1 = {I : } : . Since I :  is normal, by Theorem 6.25,
I1 is either [1] or intersection of normal reﬂexive prime σ-ideals. If n = 1, then {I, yi} must
be either [y1] or [1]. Then the theorem is proved for n = 1. Suppose the theorem is valid for
n = 1, . . . , k − 1. Still use {I} = I1 ∩ ∩n
i=1{I, yi}. Let Ii be the σ-ideal obtained by setting
yi to 0 in I. By the induction hypothesis, Ii can be written as intersection of quasi-normal
reﬂexive prime σ-ideals in F{Y \ {yi}}. So the theorem is also valid for {I, yi} = {Ii, yi}.
The theorem is proved.

(cid:3)

6.3 Characteristic set for normal binomial σ-ideal

The theory of characteristic set given in Section 4.2 will be extended to the normal σ-binomial
case.

Let ρ be a partial character over Z[x]n, Lρ = (f1, . . . , fs) where f = {f1, . . . , fs} is a

reduced Gr¨obner basis, and

A+(ρ) : Yf +

1 − ρ(f1)Yf

−

1 , . . . , Yf +

s − ρ(fs)Yf

−

s .

(34)

We have the following canonical representation for normal binomial σ-ideals.

31

Theorem 6.28 Use the notations in (34). Then I +(ρ) = sat(A+(ρ)). Furthermore, A+(ρ)
is a regular and coherent σ-chain and hence is a characteristic set of I +(ρ).
Proof: Let I1 = [A+(ρ)] : . We claim I1 = sat(A+(ρ)). It is clear that sat(A+(ρ)) ⊂
[A+(ρ)] :  = I1. For the other direction, let p ∈ I1 and p1 = prem(p,A+(ρ)) which
is reduced w.r.t. A+(ρ). By (3), p1 ∈ I1. As a consequence, p1 ∈ [A(ρ)] as Laurent σ-
polynomials in F{Y±}. By Lemma 4.16, A(ρ) is a characteristic set of [A(ρ)]. Since p1 is
reduced w.r.t. A+(ρ), it is also reduced w.r.t. A(ρ). Then p1 = 0 and hence the claim is
proved.
We now prove I +(ρ) = sat(A+(ρ)). By the above claim, Lemma 4.16, and Lemma 6.16,
sat(A+(ρ)) = [A+(ρ)] :  = [A+(ρ)]F{Y±} ∩ F{Y} = [A(ρ)] ∩ F{Y} = I(ρ) ∩ F{Y} =
I +(ρ).
It remains to prove that A+(ρ) is a characteristic set of I1 = [A+(ρ)] : . By deﬁnition,
it suﬃces to show that if p ∈ I1 is reduced w.r.t. A+(ρ) then p = 0. Let Ai = Yfi − ρ(fi)
i − ρ(fi)Yf −
and A+
i . Since p ∈ I1, there exist a σ-monomial M and fi,j ∈ F{Y}
i )xj . Then in F{Y±}, we have p =Pi,j gi,jAxj
such that M p =Pi,j fi,j(A+
i ∈ [A(ρ)], where
gi,j ∈ F{Y±}. Since p is reduced w.r.t. A+(ρ), it is also reduced w.r.t. A(ρ). By Lemma
4.16, A(ρ) is a characteristic set of [A(ρ)] and hence p = 0. The claim is proved.
Since I1 = sat(A+(ρ)), A+(ρ) is also a characteristic set of sat(A+(ρ)). By Theorem 2.1,
A+(ρ) is regular and coherent.
Example 6.29 Let L = ([1− x, x− 1]τ ) be a Z[x]-module and ρ the trivial partial character
on L, that is, ρ(f ) = 1 for f ∈L. By Theorem 6.28, I +(ρ) = sat[y1yx
1 y2] ⊆ Q{y1, y2}.
By Theorem 6.16, I +(ρ) is a reﬂexive prime σ-ideal. We can show that I +(ρ) = [yxi
2 −
1 yxi
yxj

2 | 0 ≤ i < j ≤ m], which is an inﬁnitely generated σ-ideal.
As a consequence of Theorem 6.19, Theorem 6.28, and Lemma 4.16, we have

i = Yf +

2 − yx

(cid:3)

1 yxj

Corollary 6.30 Let A(ρ) and A+(ρ) be deﬁned in (20) and (34), respectively. Then
([A(ρ)]F{Y±}) ∩ F{Y} = sat(A+(ρ)).

As a consequence of Theorem 5.3, Corollary 6.22, and Theorem 6.28.

Corollary 6.31 [A(ρ)] is a reﬂexive (prime) σ-ideal in F{Y±} if and only if sat(A+(ρ)) is
a reﬂexive (prime) σ-ideal in F{Y}.

We now prove the converse of Theorem 6.28. Let fi ∈ Z[x]n and ci ∈ F ∗, i = 1, . . . , s.

Consider the following σ-chains

A : Yf1 − c1, . . . , Yfs − cs
1 , . . . , YYf +
A+ : Yf +

1 − c1Yf

−

s − csYf

−
s

(35)

in F{Y±} and F{Y}, respectively. Notice that, when talking about A+ (or A), all operations
are performed in F{Y} (or F{Y±}). Since fi are assumed to be normal, A+ is a σ-chain if
and only if A is a Laurent σ-chain.

32

−

i = I +
i y

dixo
i

ci − cI −

Suppose Ai = Yf +

Lemma 6.32 Use the notations in (35). Let p = aYa + bYb = aN (Yf − c) ∈ F{Y}, where
a, b ∈ N[x]n, f ∈ Z[x]n, N is a σ-monomial, c ∈ F ∗. If A+ is coherent and regular, then
prem(p,A+) = 0 implies prem(Yf − c,A) = 0.
Proof: Since prem(p,A+) = 0, there exists a σ-monomial M1 such that M1p ∈ [A+]. Let
p1 = Yf − c. Since r1 = prem(p1,A) = Yg − cg, by Lemma 4.5, there exists a c1 ∈ F ∗ such
that r1− c1p1 ∈ [A]. Then, there exists a σ-monomial M2 such that M2N r1, M2N p1 ∈ F{Y}
and M2N (r1 − c1p1) ∈ [A+] and hence M2M1N (r1 − c1p1) = M2M1N r1 − c1
a M2M1p ∈ [A+].
Let M = M1M2N . From M1p ∈ [A+], we have M r1 ∈ [A+] ⊂ sat(A+).

i − cYf
i , where yci is the leading variable of Ai. A
variable like yxoi+k
for k ∈ N is called a main variable of A+. A variable yxj
is called a
parameter of A+ is it is not a main variable. If M contains a main variable of A+ as a factor.
Then let z = yxoi+k
be the largest one appearing in M under the variable ordering induced
by the lexicographical of the index (ci, oi +k). Let s = deg(M, z) and M1 = M/(zs). We may
assume that di is a factor of s. Otherwise, let s1 = ⌊ s
di⌋, s0 = s − s1di, and M = M zdi−s0 =
M1zdi(s1+1). We still have M r1 ∈ sat(A+). We may use Ai = 0 to eliminate z from M as
ci − Ai)xk
follows: M1zs−di(cI −
r1 ∈
i )xk , z) = s − di. Repeat the above procedure, we may
sat(A+). Note that deg(M1zs−di(cI −
ﬁnd a σ-monomial N such that N r1 ∈ sat(A+), N does not contain z as a factor, and any
variable yxj
in M is smaller than z in the given variable ordering. Repeat the procedure, we
i
may ﬁnally obtain a σ-monomial L such that L does not contain main variables of A+ as
factors and Lr1 ∈ sat(A+). Since L contains only parameters of A+ and r1 is reduced w.r.t.
A+, Lr1 is also reduced w.r.t. A+. Since A+ is regular and coherent, by Lemma 3.4, it is
the characteristic set of sat(A+). Therefore, Lr1 = 0, and r1 = 0.

r1 − M1zs−di(Ai)xk

r1 = M1zs−di(I +
i y

r1 = M (I +

ci

ci

i )xk

dixo
i

i )xk

i

(cid:3)

1 ) =

1 = y2

2 − 1, and A+

The following example shows that if prem(p,A+) 6= 0 then the relation between prem(p,

A+) and prem(Yf − c,A) may be complicated, where p = aYa + bYb = aN (Yf − c).
2 − y1. Then prem(p, A+
Example 6.33 Let p = y2(y2− 1), A1 = y−1
1 y2
y1 − y2 in F{y2}. But in F{y±
2 }, p is represented as ep = y2 − 1 and prem(ep, A1) = y2 − 1.
Lemma 6.34 Use the notations in (35). A is a regular and coherent σ-chain in F{Y±} if
and only if A+ is a regular and coherent σ-chain in F{Y}.
Proof: If A is regular and coherent, by Theorem 4.18 and Corollary 4.19, there exists a
partial character ρ over Z[x]n such that Lρ = (f1, . . . , fs), ρ(fi) = ci, and I(ρ) = [A]. By
Theorem 6.28, A+ = A+(ρ) is regular and coherent.
Assume that A+ is regular and coherent. We ﬁrst show that [A] 6= [1] in F{Y±}.
It suﬃces to show that sat(A+) does not contain a σ-monomial. Suppose the contrary,
there is a σ-monomial M ∈ sat(A+). Since A+ is a regular and coherent chain, we have
prem(M,A+) = 0. Now consider the procedure of prem, it can be shown that the pseudo-
remainder of a nonzero σ-monomial w.r.t. a binomial σ-chain is still a nonzero σ-monomial,
a contradiction.

Note that A is always regular since σ-monomials are invertible in F{Y±}. Then, it

suﬃces to prove that A is coherent.

33

i = Yf +
i ydixoi

l

i = I +

i − ciYf
− ciI −

i . Assume A+
j ydj xoj
i , A+

j = I +

Let Ai = Yfi − ci and A+

j (i < j) have the same
leading variable yl, and A+
j , where I −
i . From
Deﬁnition 3.6, we have oi < oj and di|dj. Let di = tdj where t ∈ N. From (4),
i )xoj −oi .
j )t(ciI +
jM (Yh+ − cf Yh−

j )t(Ii)xoj −oi − (I +

i and A+
− cjI −

i )xoj −oi , A+

j ) = ct

∆(A+

i , A+

j ) = prem((A+

Comparing to (18), if ∆(Ai, Aj) = Yh − cf , then ∆(A+
M is a σ-monomial. Since A+ is coherent, prem(∆(A+
prem(∆(Ai, Aj),A) = 0 which implies that A is coherent.

i , A+
i , A+

j ) = ct
), where
j ),A+) = 0. By Lemma 6.32,

(cid:3)

i = Yf −

−

l

j(I −

We now prove the converse of Theorem 6.28.

Theorem 6.35 Use the notations in (35). If A+ is a regular and coherent σ-chain, then
there is a partial character ρ over Z[x]n such that Lρ = (f1, . . . , fs), ρ(fi) = ci, I(ρ) = [A],
and I +(ρ) = sat(A+)
Proof: By Lemma 6.34, A is regular and coherent. By Theorem 4.14, f is a reduced Gr¨obner
basis for a Z[x]-lattice and [A] ⊂ F{Y±} is proper. By Theorem 4.18 and Corollary 4.19,
there exists a partial character ρ such that Lρ = (f1, . . . , fs), ρ(fi) = ci, and I(ρ) = [A]. By
Theorem 6.28, I +(ρ) = sat(A+(ρ)) = sat(A+).

(cid:3)

As a consequence of Theorem 6.35 and Lemma 6.16, we have the following canonical

representation for a normal binomial σ-ideal.

Corollary 6.36 I is a normal binomial σ-ideal if and only if I = sat(A+), where A+ is a
regular and coherent chain given in (35).

6.4 Perfect closure of binomial σ-ideal and binomial σ-variety

In this section, we will show that the perfect closure of a binomial σ-ideal is also binomial.
We will also give a geometric description of the zero set of a binomial σ-ideal. For the perfect
closure of a binomial σ-ideal, we have

Theorem 6.37 Let F be an algebraically closed and inversive σ-ﬁeld. Then the perfect
closure of a binomial σ-ideal I is binomial.

We ﬁrst remark that it is not known wether the well-mixed closure of a binomial σ-ideal
is still binomial. Before proving Theorem 6.37, we ﬁrst prove several lemmas. In the rest of
this section, we assume that I ⊆ S = F{Y} and  the set of σ-monomials in S.
Lemma 6.38 If I is a binomial σ-ideal, then {I} :  is either [1] or a binomial σ-ideal.
Proof: It is easy to check {I}F{Y±} = {IF{Y±}}. By (30), {I} :  = {I}F{Y±}∩F{Y} =
{IF{Y±}} ∩ F{Y}. Now the lemma follows from Theorem 5.28.

(cid:3)

34

Lemma 6.39 If I is a σ-ideal in F{Y}, then

{I} = {I} :  ∩ {I + y1} ∩ ··· ∩ {I + yn}

(36)

(cid:3)

Proof: The right hand side of (36) clearly contains {I}.
It suﬃces to show that every
reﬂexive prime P containing I contains one of the σ-ideals on the right-hand side of (36).
If {I} :  ⊆ P , we are done. Otherwise, there exists an element f ∈ ({I} : ) \ P which
implies that there exists a σ-monomial M such that M f ∈ {I} ⊆ P . This implies yi ∈ P
for some i. Thus, P contains {I + yi} as required.
Lemma 6.40 Let I be a binomial σ-ideal in S = F{Y} and S′ = F{y1, . . . , yn−1}.
I ′ = I ∩ S′, then [I + yn] is the sum of [I ′S + yn] and a monomial σ-ideal in S′.
Proof: Every σ-binomial involving yxk
n is either contained in [yn] or is congruent modulo [yn]
to a σ-monomial in S′. Thus, all generators of I which are not in I ′ may be replaced by
σ-monomials in S′ when forming a generating set for [I + yn].
Lemma 6.41 Let I be a perfect binomial σ-ideal in S = F{Y}. If M is a σ-monomial
σ-ideal, then {I + M} = [I + M1] for some monomial σ-ideal M1.
Proof: If 1 ∈ M, then the lemma is obviously valid. Otherwise, [I + M] :  = [1]. Lemma
6.39 yields {I + M} = Ti=n
i=1{I + M + yi}. By Corollary 6.9, we need only to show that
{I + M + yi} is the sum of I and a monomial σ-ideal. For simplicity, let i = n and write
S′ = F{y1, y2, . . . , yn−1}. Since I is perfect, the σ-ideal I ′ = I ∩ S′ is perfect as well. By
Lemma 6.40, [I + M + yn] = [I ′S + M′S + yn] where M′ is a monomial σ-ideal in S′. By
induction on n, the perfect closure of I ′ + M′ in S′ has the form I ′ + M′
1 is a
monomial σ-ideal of S′. Putting this together, we have

1, where M′

If

(cid:3)

{I + M + yn} = {I ′S + M′S + yn} = [I ′S + M′
1S + yn] ⊆ {I + M + yn}.

⊆ [I + M′

1S + yn]

(cid:3)

1S + yn] is I plus a monomial σ-ideal, as required.

So {I + M + yn} = [I + M′
Proof of Theorem 6.37: We will prove the theorem by induction on n. By Lemma 6.38,
I1 = {I} :  is binomial. For n = 1, by Lemma 6.39, {I} = I1 ∩ {I + y1}. If {I + y1} = 1
then {I} = I1 is binomial. Otherwise {I + y} = [y] and hence I ⊂ [y]. Since I ⊂ I1,
{I} = I1 ∩ [y] = [I + I1] ∩ [I + y] is binomial by Lemma 6.8. Suppose the lemma is valid
for n − 1 variables and let I be a binomial σ-ideal in S = F{Y}. Let Ij := I ∩ Sj, where
Sj = F{y1, . . . , yj−1, yj+1, . . . , yn}. By the induction hypothesis, we may assume that the
perfect closure of each Ij is binomial. Adding these binomial σ-ideals to I, we may assume
that each Ij is perfect begin with. By Lemma 6.38, I1 = {I} :  is binomial. Then
there exists a binomial σ-ideal I ′, say I ′ = I1, such that I1 = [I + I ′]. By Lemma 6.40,
[I + yj] = [IjS +JjS + yj], where Jj is a monomial σ-ideal in Sj. Since Ij is perfect, the σ-
ideal IjS is perfect, so we can apply Lemma 6.41 with M = [JjS +yi] to see that there exists
a monomial σ-ideal Mj in S such that {I +yj} = {IjS +JjS +yj} = [IjS +Mj] = [I +Mj].
By Lemma 6.39 and Corollary 6.8, {I} = [I + I ′]T∩n

j=1[I + Mj] is binomial.

(cid:3)

35

2

1

2 − y2

1 y2, y1+xj

1. Following the proof of Theorem 6.37, {p} = ({p} : ) ∩
1 y2] =

Example 6.42 Let p = y2
[y1, y2]. By Example 5.25 and Corollary 6.30, I1 = {p} :  = sat[y2
[y1yxi
| i, j ∈ N]. Thus, {p} = I1 ∩ [y1, y2] = I1.

2 − yxi
In the rest of this section, we give a geometric description of the zero set of a binomial
σ-ideal, which is a generalization of Theorem 4.1 in [7] to the diﬀerence case. The basic idea
of the proof also follows [7], except we need to consider the distinction between the perfect
σ-ideals and radical ideals.

− y1+xj

2 − yx

2 − y2

1, y1yx

We decompose the aﬃne n-space (A)n into the union of 2n σ-coordinate ﬂats:

(A∗)Ω := {(a1, a2, . . . , an)| ai 6= 0, i ∈ Ω; ai = 0, i /∈ Ω}

where Ω runs over all subsets of {1, 2, . . . , n}. The Cohn closure of (A∗)Ω in (A)n is deﬁned
by the σ-ideal

M (Ω) := [yi|i /∈ Ω] ⊂ F{Y}.

The σ-coordinate ring of (A∗)Ω is the Laurent polynomial σ-ring F{Ω±} := F{yi, y−1
We can deﬁne a coordinate projection (A∗)Ω′
setting all those coordinates not in Ω to zero.

, i ∈ Ω}.
−→ (A∗)Ω whenever Ω ⊆ Ω′ ⊆ {1, 2, . . . , n} by
If X is any σ-variety of (A)n and I = I(X) ⊆ F{Y}, then the Cohn closure of the

intersection of X with (A∗)Ω corresponds to the σ-ideal

i

where Ω = {Qi∈Ω ymi(x)

[4, p.87]

i

IΩ := [I + M (Ω)] : Ω ⊂ F{Y}

|mi(x) ∈ N[x]}. Since I is perfect, by the diﬀerence Nullstellsatz

I =\Ω

{IΩ}.

If I is binomial, then by Corollary 6.10 the σ-ideal IΩ is also binomial.
Lemma 6.43 Let R := F{z1, z−1
, y1, . . . , ys} be
a Laurent polynomial σ-ring and a polynomial σ-ring over it. If B ⊂ R′ is a binomial σ-
ideal and M ⊂ R′ is a monomial σ-ideal such that [B + M ] is a proper σ-ideal in R′, then
[B + M ] ∩ R = B ∩ R.
Proof: This is a σ-version of [7, Lemma 4.2], which can be proved similarly.

t } ⊂ R′ := F{z1, z−1

1 , . . . , zt, z−1

1 , . . . , zt, z−1

(cid:3)

t

We can make a classiﬁcation of all binomial σ-varieties X by intersecting X with (A∗)Ω,

since by Theorem 6.37, the perfect closure of a binomial σ-ideal is still binomial.

Theorem 6.44 Let F be any algebraically closed and inversive σ-ﬁeld. A σ-variety X ⊂ An
is generated by σ-binomials if and only if the following three conditions hold.

(1) For each (A∗)Ω, the σ-variety X ∩ (A∗)Ω is generated by σ-binomials.
(2) The family of sets U = {Ω ⊆ {1, 2, . . . , n}|X ∩ (A∗)Ω 6= ∅} is closed under taking

intersections.

36

(3) If Ω1, Ω2 ∈ U and Ω1 ⊂ Ω2, then the coordinate projection (A∗)Ω2 −→ (A∗)Ω1 maps

X ∩ (A∗)Ω2 onto a subset of X ∩ (A∗)Ω1.

The above theorem can be reduced to the following algebraic version.

Theorem 6.45 Let F be any algebraically closed and inversive σ-ﬁeld. A perfect σ-ideal
I ⊂ F{Y} is binomial if and only if the following three conditions hold.
(1) For each Ω ⊆ {1, . . . , n}, IΩ is binomial.
(2) U = {Ω ⊆ {1, 2, . . . , n}|{IΩ} 6= [1]} is closed under taking intersections.
(3) If Ω1, Ω2 ∈ U and Ω1 ⊂ Ω2, then IΩ1 ∩ F{Ω1} ⊂ IΩ2, where F{Ω1} = F{yi | yi ∈ Ω1}.
Proof: Suppose I is a perfect σ-ideal in F{Y}. Since I is binomial, by Lemma 6.10 IΩ is
also binomial and (1) is proved. To prove (2) by contradiction, assume that for Ω1, Ω2 ∈ U ,
{IΩ1} 6= [1],{IΩ2} 6= [1],{IΩ1∩Ω2} = [1]. We consider two cases. If IΩ1∩Ω2 = [1], then for
some m(x) ∈ N[x] we have (Qi∈Ω1∩Ω2
yi)m(x) ∈ [I + M (Ω1) + M (Ω2)]. By Corollary 6.9,
(Qi∈Ω1∩Ω2 yi)m(x) is either in [I + M (Ω1)] or [I + M (Ω2)], so IΩ1 or IΩ2 is [1]. For the second
case, we have IΩ1∩Ω2 6= [1] and {IΩ1∩Ω2} = [1]. Then there exist a ﬁnite number of proper
σ-binomials B1, . . . , Bs and σ-monomials m1, . . . , ms in F{Ω1 ∩ Ω2} such that miBi ∈ I
and {B1, . . . , Bs, yi, i /∈ Ω1 ∩ Ω2} = [1]. We thus have {B1, . . . , Bs} = [1]. Since miBi ∈
I ∩ F{Ω1 ∩ Ω2}, we have Bi ∈ IΩ1 and Bi ∈ IΩ2 and thus {IΩ1} = {IΩ2} = [1]. To prove
(3), given Ω1, Ω2 ∈ U and Ω1 ⊂ Ω2, we have IΩ2 = [IΩ2 : Ω1]. Set R′ = F{Ω±
1 }{{yi}i /∈Ω1},
then

[I + M (Ω1)]R′ ∩ F{Ω±

1 } ⊆ IΩ2R′.

′

Since Ω1 ∈ U , the σ-ideal [I +M (Ω1)]R
F{Ω±

1 } ⊂ IΩ2R′ ∩ F{Ω±

is proper. By Lemma 6.43, we have [I +M (Ω1)]R′∩
1 }. So IΩ1 ∩ F{Ω1} ⊂ IΩ2.

1 } = IR′ ∩ F{Ω±
To prove the other driection, let I be a perfect σ-ideal satisfying the three conditions.
By the diﬀerence Nullstellensatz, I = ∩Ω∈U{IΩ}. By condition (2), U is a partially ordered
set under the inclusion for subsets of {1, . . . , n}. For each Ω ∈ U , we set J (Ω) = [IΩ ∩
F{Ω}]F{Y} with the properties that if Ω1 ⊂ Ω2, {J (Ω1)} ⊂ {J (Ω2)}. Note that [MΩ1∩Ω2] ⊂
[MΩ1 + MΩ2]. Then we have

I = ∩Ω∈U{IΩ} = ∩Ω∈U{J (Ω) + M (Ω)}.

Now we will prove that

∩Ω∈U {J (Ω) + M (Ω)} = {∩Ω∈U M (Ω) + XΩ∈U

{J (Ω) ∩ (∩Ωη+ΩM (Ωη))}}.

(37)

If Ω2 ⊇ Ω1, then {J (Ω2) + M (Ω2)} ⊇ {J (Ω2)} ⊇ {J (Ω1)} ⊇ {J (Ω1) ∩ ∩Ωη+Ω1M (Ωη)}.
If Ω2 + Ω1, we have {J (Ω2) + M (Ω2)} ⊇ M{Ω2} ⊇ {J (Ω1) ∩ ∩Ωη+Ω1M (Ωη)}. So the
left hand side contains the right hand side of (37). For the other direction, consider a
reﬂexive prime σ-ideal P ⊇ [∩Ω∈U M (Ω) + PΩ∈U{J (Ω) ∩ ∩Ωη+ΩM (Ωη)}] and set V =
{Ω ∈ U|M (Ω) ⊂ P}. Then V is a ﬁnite partially order set and nonempty since P ⊇

37

∩Ω∈U M (Ω) and {MΩ1∩Ω2} ⊂ {MΩ1 + MΩ2}. Let Ω0 be the smallest element of V such that
P ⊇ MΩ0. At the same time, P ⊃ J (Ω0) ∩ ∩Ωη+Ω0M (Ωη), then P ⊇ J (Ω0). Therefore,
P ⊇ J (Ω0) + M (Ω0) and P contains the left hand side of (37) and (37) is proved. Since
∩Ω∈U M (Ω) +PΩ∈U{J (Ω) ∩ ∩Ωη+ΩM (Ωη)} is binomial, the theorem follows from (37). (cid:3)

7 Algorithms

In this section, we give algorithms for most of the results in the preceding sections.
In
particular, we give an algorithm to decompose a ﬁnitely generated perfect binomial σ-ideal
as the intersection of reﬂexive and prime binomial σ-ideals. The following basic algorithms
will be used.

• Algorithm GHNF. Let f be a ﬁnite set of Z[x]n. The algorithm computes the
generalized Hermite normal form of [f], or equivalently, the reduced Gr¨obner basis of
the Z[x]-module (f) [5, p. 197]. A polynomial-time algorithm is given in [15].

• Algorithm GKER. For a matrix M ∈ Z[x]n×s, compute a set of generators of the
Z[x]-lattice: kerZ[x](M ) = {X ∈ Z[x]s | M X = 0}. This can be done by combining
Algorithm GHNF and Theorem 3.9.

Let D be Z, Q[x], Zp[x], or Q[x]/(q(x)), where q(x) is an irreducible polynomial in Q[x].

Then D is either a PID or a ﬁeld. The following algorithms will be used.

• Algorithm HNF. For M ∈ Dn×s, compute the Hermite normal form of M [3, p.68].
• Algorithm KER. For a matrix M ∈ Dn×s, compute a basis for the D-module:

kerD(M ) = {X ∈ Ds | M X = 0} [3, p.74].

7.1

x-saturation of Z[x]-lattice

In this section, we give algorithms to check whether a Z[x]-lattice L is x-saturated and in
the negative case to compute the x-saturation of L.

Let f1, . . . , fs ∈ Z[x]n and L = (f1, . . . , fs).
gi ∈ Z[x] such that Ps
h −Ps
i=1egi(x)fi, we have

i=1 gifi = xh and h 6∈ L. Setting gi(x) = gi(0) + xegi(x) and eh =

If L is not x-saturated, then there exist

(38)

where eh 6∈ L. Setting x = 0 in the above equation, we have

sXi=1

gi(0)fi = xeh

sXi=1

gi(0)fi(0) = 0,

38

that is, G = (g1(0), . . . , gs(0))τ is in the kernel of the matrix F = [f1(0), . . . , fs(0)] ∈ Zn×s,
which can be computed eﬃciently [3, page 74]. From G and (38), we may compute eh. This
observation leads to the following algorithm.

Algorithm 1 — XFactor([f1, . . . , fs])
Input: A generalized Hermite normal form [f1, . . . , fs] ⊂ Z[x]n×s.
Output:∅, if the Z[x]-lattice L = (f1, . . . , fs) is x-saturated; otherwise, a ﬁnite
set {(hi, ei)| i = 1, . . . , r} such that ei = (ei1, . . . , eis)τ ∈ Zs, hi 6∈ L,
and xhi =Ps

l=1 eilfl ∈ L, i = 1, . . . , r.

1. Set F = [f1(0), . . . , fs(0)] ∈ Zn×s.
2. Compute a basis E ⊂ Zs of the Z-module kerZ(F ) with Algorithm KER.
3. Set H = ∅.
4. While E 6= ∅

4.1. Let e = (e1, . . . , es)τ ∈ E and E = E \ {e}.
4.2. Let h = (e1f1 + ··· + esfs)/x.
4.3. If grem(h,{f1, . . . , fs}) 6= 0, then add (h, e) to H.

5. Return H.

We now give the algorithm to compute the x-saturation of a Z[x]-lattice.

Algorithm 2 — SatX(f1, . . . , fs)
Input: A ﬁnite set f = {f1, . . . , fs} ⊂ Z[x]n.
Output:A set of generators of satx(f1, . . . , fs) .

1. Compute the generalized Hermite normal form g of f with Algorithm GHNF.
2. Set H = XFactor(g).
3. If H = ∅, then output g; otherwise set f = Col(g) ∪ {h| (h, f ) ∈ H} and goto step 1.

Note. Col(g) is the set of columns of g.

Example 7.1 Let C be the following generalized Hermite normal form.

In XFactor(C), the kernel of the following matrix [f1(0), f2(0), f3(0)] = 

generated by e1 = (0,−1, 1)τ and e2 = (1,−2, 0)τ .
h = (−f2 + f3)/x = (0, 2, x − 2)τ . One can check that (0, 2, x − 2)τ 6∈ (C).

In step 4.2 of XFactor, we have
In SatX,

2 1 1
2 1 1
0 0 0


 is

C = [f1, f2, f3] =


−x + 2 1
1
3x + 2
2x x2
0

1
2x + 1


 .

39

computing the generalized Hermite normal form of C ∪ {(0, 2, x − 2)τ}, we have


 .
XFactor(C1) returns ∅. So, (C1) is the x-saturation of (C).
Proposition 7.2 Algorithms SatX and XFactor are correct.

−x + 2 1
0
3x + 2 −3 2
4
0

C1 =


x − 2

Proof: From the output of Algorithm XFactor, in step 3 of SatX, we have (g) ( (g ∪
{h| (h, f ) ∈ H}) ⊆ satx(f). Since Z[x]n is a Noetherian Z[x]-module, SatX will terminate
and return the x-saturation of (f). So, it suﬃces to show the correctness of Algorithm
XFactor.

We ﬁrst explain step 4.2 of Algorithm XFactor. Since e ∈ kerZ(F ), h(0) = [f1(0), . . . ,
fs(0)]e = [0, . . . , 0]τ . Therefore, x is a factor of e1f1 + ··· + esfs and thus h = (e1f1 + ··· +
esfs)/x ∈ Z[x]n.

To prove the correctness of Algorithm XFactor, it suﬃces to show that L = satx(L) if

and only if for each e ∈ E, e1f1 + ··· + esfs = xh implies h ∈ L.

i=1 ci(x)fi, where ci(x) ∈ Z[x].

i=1 ci(x)fi, we obtain Ps

Let E = {e1, . . . , ek} where ei ∈ Zs. If L = satx(L), then it is clear that (f1, . . . , fs)ei =
xhi implies hi ∈ L. To prove the other direction, let [f1, . . . , fs]ei = xhi for 1 ≤ i ≤
k, where hi ∈ L. Let xf ∈ L. Then xf = Ps
If for
each i, x|ci(x), then we have f = Ps
i=1(ci(x)/x)fi ∈ L, and the lemma is proved. Oth-
erwise, set x = 0 in xf = Ps
i=1 ci(0)fi(0) = 0. Hence Q =
[c1(0), . . . , cs(0)]τ ∈ kerZ(F ) and hence there exist ai ∈ Z, i = 1, . . . , k such that Q =
Pk
[f1, . . . , fs]Q = Pk
i=1 ai[f1, . . . , fs]ei =Pk
i=1 aixhi = xeh, where eh =
i=1 aiei. Then,
Pk
i=1 aihi ∈ L. Then,
i=1 ci(0)fi +Ps
i=1 ci(x)fi =Ps
i=1 ci(x)fi = xeh + xPs
= [f1, . . . , fs]Q + xPs
where ci(x) = (ci(x) − ci(0))/x ∈ Z[x]. Hence, f = eh +Ps

i=1 ci(x)fi ∈ L and the lemma is

xf = Ps

proved.

i=1 xci(x)fi

i=1 ci(x)fi,

(cid:3)

7.2 Z-saturation of Z[x]-lattice
The key idea to compute satZ(L) for a Z[x]-lattice L ∈ Z[x]n is as follows. Let f =
{f1, . . . , fs}. Then (f) is not Z-saturated if and only if a linear combination of fi contains a
nontrivial prime factor in Z, that is, Pi gifi = pf , where p is a prime number and f 6∈ (f).
Furthermore,Pi gifi = pf with gi 6= 0 mod p is valid if and only if f1, . . . , fs are linear depen-

dent over Zp[x]. The fact that Zp[x] is a PID allows us to compute such linear relations using
methods of Hermite normal forms [3]. The following algorithm is based on this observation.

40

Algorithm 3 — ZFactor
Input: A generalized Hermite normal form C = [c1, . . . , cs] ⊂ Z[x]n of form (6).
Output:∅, if L = (C) is Z-saturated; otherwise, a ﬁnite set {(hi, ki, ei)| i =
1, . . . , r}, such that hi ∈ Z[x]n, ki ∈ N, ei = (ei1, . . . , eis)τ ∈ Z[x]s,
hi 6∈ L and kihi =Ps

l=1 eilcl ∈ L for i = 1, . . . , r.

1. Read the numbers t, ri, li, cri,1,0, i = 1, . . . , t from (6).

with Algorithm KER.

i=1 cri,1,0 ∈ N.

3. For any prime factor p of q do

2. Set q =Qt
3.1. Set F = [cr1,l1, cr2,l2, . . . , crt,lt] ∈ Zp[x]n×t.
3.2. Compute a basis G ⊂ Zp[x]s of the Zp[x]-module kerZp[x](F )
3.3. If G 6= ∅, for each g = [g1, . . . , gt]τ ∈ G, let Pt
Return the set of (h, p, e), where e = [e1, . . . , es]τ ∈ Z[x]s such that
esk = gk, sk =Pk
3.4. Compute the Hermite normal form B = {b1, . . . , bt}
of {cr1,l1, . . . , crt,lt} in Zp[x]n with Algorithm HNF.
3.5. Let C− = {f1, . . . , fl} be given in (8) andefi = grem(fi,B) = fi +Pt
in Zp[x]n, where ai,k ∈ Zp[x].
3.6. Ifefi = 0 for some i, then fi +Pt
Return the set of (hi, p, ei) where ei is a vector in Z[x]s such that
(c1, . . . , cs)ei = fi +Pt

i=1 li, k = 1, . . . , t and ej = 0 for other j.

k=1 ai,kbk = phi in Z[x]n.

k=1 ai,kbk = phi.

i=1 gicri,li = ph in Z[x]n.

k=1 ai,kbk,

3.7. Set E = [ef1, . . . ,efl] ∈ Zp[x]n×l.
3.8. Compute a basis D of {X ∈ Zl
3.9. If D 6= ∅, for each b = [b1, . . . , bl]τ ∈ D, Pl
(c1, . . . , cs)e =Pl
4. Return ∅.

i=1 biefi = ph.

p | EX = 0} as a vector space over Zp.

i=1 biefi = ph in Z[x]n.

Return the set of (h, p, e) where e is a vector in Z[x]s such that

can be treated similarly.

Remark 7.3 In steps 3.6 and 3.9, we need to compute ei or e. Since B = {b1, . . . , bt} is
the Hermite normal form of c = {cr1,l1, . . . , crt,lt} in Zp[x]n, there exists an invertible matrix
Mt×t such that [b1, . . . , bt] = [cr1,l1, . . . , crt,lt]M . In Step 3.6, ei can be obtained from the
relation fi +Pt
k=1 ai,kbk = phi and the relation [b1, . . . , bt] = [cr1,l1, . . . , crt,lt]M . Step 3.9
Remark 7.4 In step 3.8, we need to compute a basis for the vector space {X ∈ Zl
p | EX = 0}
over Zp. We will show how to do this. A matrix F ∈ Zp[x]m×s is said to be in standard form
if F has the structure in (6) and deg(cri,k1, x) < deg(cri,k2, x) for i = 1, . . . , t and k1 < k2.
The matrix E ∈ Zp[x]n×l can be transformed into standard form using the following
operations: (1) exchange two columns and (2) add the multiplication of a column by an
element from Zp to another column. Equivalently, there exists an inversive matrix U ∈ Zl×l

p

41

such that E · U = S is in standard form. Suppose that the ﬁrst k columns of S are zero
vectors. Then the ﬁrst k columns of U constitute a basis for ker(E). This can be proved
similarly to that of the algorithm to compute a basis for the kernel of a matrix over a PID
[3, page 74].

We now give the algorithm to compute the Z-saturation.

Algorithm 4 — SatZ(f0, . . . , fs)
Input: A set of vectors f = {f0, . . . , fs} ⊂ Z[x]n.
Output:A reduced Gr¨obner basis g such that (g) = satZ(f).

1. Compute generalized Hermite normal form g of f.
2. Set S =ZFactor(g).
3. If S = ∅, return g; otherwise set f = Col(g) ∪ {h| (h, k, f ) ∈ S} and goto step 1.

Example 7.5 Let C be the following generalized Hermite normal form:

C =(cid:20) x2 + 2x − 2 x + 2 1

2x (cid:21) .

4

0

Then, t = 2, r1 = 1, l1 = 1, r2 = 2, l2 = 2, q = 4, c1,1 = [x2 + 2x − 2, 0]τ , c2,1 = [x + 2, 4]τ ,
c2,2 = [1, 2x]τ . Apply algorithm ZFactor to C. We have p = 2.
In steps 3.1 and 3.2,
F = (cid:20) x2 1
0 (cid:21) and ker(F ) is generated by G = {[−1, x2]τ}. In step 3.3, x2c22 − c11 =
2(1 − x, x3)τ and return (1 − x, x3)τ .

0

In Algorithm SatZ, (1 − x, x3)τ is added into C and
C1 =(cid:20) x2 + 2x − 2 x + 2 1

0

4

(cid:21) ,

1 − x

2x x3

which is also a generalized Hermite normal form.

(cid:21). In step 3.5, C− =(cid:20) x + 2 1

Applying Algorithm ZFactor to C1. We have p = 2 and t = 2. In steps 3.1-3.3, G = ∅.
In step 3.4, B =(cid:20) x2 1 − x
2x 2x2 (cid:21) and efi 6= 0 for all i.
0 0 0 (cid:21) . In Step 3.8, D = {b}, where b = [1, 0,−1]τ . In Step 3.9,
In step 3.7, E = (cid:20) x 1 x
(x + 2, 4)τ − (x, 2x2)τ = 2(1, 2 − x2)τ . Add (1, 2 − x2)τ into C1 and compute the generalized
Hermite normal form, we have

x3

x

0

4

C2 =(cid:20) x2 + 2x − 2 x + 2 1 −1

2x x2 − 2 (cid:21) .

0

4

Apply Algorithm ZFactor again, it is shown that C2 is Z-saturated.

We will prove the correctness of the algorithm. We denote by satp(L) the set {f ∈
Z[x]n | pf ∈ L} where p ∈ Z is a prime number. An inﬁnite set S is said to be linear indepen-
dent over a ring R if any ﬁnite set of S is linear independent over R, that is Pk
i=1 aigi = 0
for ai ∈ R and gi ∈ S implies ai = 0, i = 1, . . . , k.

42

i=1 bihi. Hence Pr

Lemma 7.6 Let C be a generalized Hermite normal form and L = (C). Then satp(L) = L
if and only if C∞ is linear independent over Zp, where C∞ is deﬁned in (8).
Proof: “ ⇒ ” Assume the contrary, that is, C∞ = {h1, h2, . . .} deﬁned in (8) is linear
dependent over Zp. Then there exist ai ∈ Zp not all zero, such that Pr
i=1 aihi = 0 in Zp[x]n
and hence Pr
i=1 aihi = pg in Z[x]n. By Lemma 3.11, hi are linear independent over Zp and
hence g 6= 0. Since satp(L) = L, we have g ∈ L. By Lemma 3.12, there exist bi ∈ Z such
that g = Pr
i=1(ai − pbi)hi = 0 in Z[x]n. By Lemma 3.11, ai = pbi and
hence ai = 0 in Zp[x], a contradiction.
“ ⇐ ” Assume the contrary, that is, there exists a g ∈ Z[x]n, such that g 6∈ L and pg ∈ L.
By Lemma 3.12, pg = Pr
i=1 aihi, where ai ∈ Z. p cannot be a factor of all ai. Otherwise,
g = Pr
i=1 aihi = 0 is
(cid:3)
nontrivial linear relation among Ci over Zp, a contradiction.
From the “ ⇒ ” part of the above proof, we have
Corollary 7.7 Let Pr
ai ∈ Zp. Then, in Z[x]n, Pr
Lemma 7.8 Let C = [c1, . . . , cs] be a generalized Hermite normal form and L = (C). Then
satp(L) = L if and only if C∞ is linear independent over Zp for the prime factors of q deﬁned
in step 2 of Algorithm ZFactor.

p hi ∈ L. Then some of ai is not zero in Zp, which means Pr

i=1 aihi = 0 be a nontrivial linear relation among hi in Zp[x]n, where

i=1 aihi = ph and h 6∈ (C).

ai

i=1

If p is coprime with Qt

Proof: By Deﬁnition 3.6, the leading monomial of xkcri,j ∈ C∞ is of the form cri,j,0xk+dri,j ǫri
i=1 cri,1,0, then cri,j,0 6= 0 mod p for
and cri,li,0| . . . |cri,2,0 |cri,1,0.
1 ≤ j ≤ li. Therefore, the leading monomials of the elements of C∞ are linear independent
over Zp, and hence C∞ is linear independent over Zp. Therefore, it suﬃces to consider prime
factors of Qt
To check whether C∞ is linear independent over Zp, we ﬁrst consider a subset of C∞ in

i=1 cri,1,0.

(cid:3)

the following lemma.

Lemma 7.9 Let C be the generalized Hermite normal form given in (6). Then C+ deﬁned in
(8) is linear independent over Zp if and only if {cr1,l1, cr2,l2, . . . , crt,lt} are linear independent
over Zp[x].
Proof: This is obvious since PiPj ai,jxjcri,li = Pi picri,li, where ai,j ∈ Z and pi =
Pj ai,jxj.
Lemma 7.10 Let B be a Hermite normal form in Zp[x]n and g = {g1, . . . , gr} ⊂ Zp[x]n.
Then g ∪ B∞ is linear dependent over Zp if and only if
• either egi = grem(gi,B) = 0 in Zp[x]n for some i, or
• the residue set {grem(gi,B)| i = 1, . . . , r} are linear dependent over Zp.

(cid:3)

43

Proof: We may assume that grem(gi,B) = 0 does not happen, since it gives a nontrivial
linear relation of g∪B∞. By Lemma 3.12, egi = gi modB∞. g∪B∞ is linear dependent over
Zp if and only if there exist ai ∈ Zp not all zero such that Pi aigi = 0 mod B∞ over Zp,
which is valid if and only ifPi aiegi = 0 mod B∞. Since egi are G-reduced with respect to B,
Pi aiegi = 0 mod B∞ if and only if Pi aiegi = 0, that is egi are linear dependent over Zp. (cid:3)

Proposition 7.11 Algorithm SatZ is correct.

Proof: Since Z[x]n is Notherian, the algorithm terminates and it suﬃces to show that
Algorithm ZFactor is correct. Let C = [c1, . . . , cs]. By Lemma 7.6, to check whether
satZ(c1, . . . , cs) is Z-saturated, it suﬃces to check for any prime p, C∞ is linear independent
on Zp. Furthermore, by Lemma 7.8, it suﬃces to consider prime factors of Qt
i=1 cri,1,0 in
step 3. This explain why only prime factors of q are considered in Step 3.
In steps 3.1 and 3.2, we check whether C+ in (8) is linear independent over Zp. By Lemma
7.9, we need only to consider whether C1 = {cr1,l1, cr2,l2, . . . , crt,lt} is linear independent over
Zp[x]. It is clear that C1 is linear independent over Zp[x] if and only if G = ∅, where G is
given in step 3.2.
If G 6= ∅ for any g = [g1, . . . , gt]τ ∈ G,
In step 3.3, C1 is linear dependent over Zp.
Pt
i=1 gicri,li = 0 in Zp[x]. Hence Pt
i=1 gicri,li = ph where h ∈ Z[x]n. By Corollary 7.7,
h 6∈ L. The correctness of Algorithm ZFactor is proved in this case.
In steps 3.4 - 3.10, we handle the case where C+ is linear independent over Zp. In step
3.4, we compute the Hermite normal form of C1 in Zp[x]n, which is possible because Zp[x]n
is a PID [3]. Furthermore, we have [3]

[cr1,l1, . . . , crt,lt]N = [b1, . . . , bt]

where {b1, . . . , bt} is a Hermite normal form and N is an inversive matrix in Zp[x]t×t. Then
C∞ = C− ∪ C+ is linear independent over Zp if and only if

eC = C− ∪ B∞ = C− ∪ ∪∞

j=0{xjb1, . . . , xjbt} is linear independent over Zp.

(39)

By Lemma 7.10, property (39) is valid if and only if grem(c,B) 6= 0 for all c ∈ C− and the
residue set eC− is linear independent over Zp, which are considered in step 3.7 and steps 3.8-
3.10, respectively. Then we either prove L is Z-saturated or ﬁnd a nontrivial linear relation
for elements in C∞ over Zp. By Corollary 7.7, such a relation leads to an h ∈ satZ(L) \ L.
The correctness of the algorithm is proved.

(cid:3)

As a direct consequence of Lemma 5.20 and Algorithm ZFactor, we have the algorithm

to compute the M -saturation.

44

Algorithm 5 — SatM(f0, . . . , fs)
Input: A set of vectors f = {f0, . . . , fs} ⊂ Z[x]n.
Output:A generalized Hermite normal form g such that satM (f) = (g).
1. Using Algorithm ZFactor, we can compute mi ∈ N and gi ∈ Z[x]n, i = 1, . . . , s
2. Let S = ∅ and for i = 1, . . . , s, if mi 6= 1 then S = S ∪ {(x − omi)gi}.
3. Compute the generalized Hermite normal form g of f ∪ S and return g.

such that satZ(f) = (g1, . . . , gs) and migi ∈ (f).

Notices that if mi = 1 then omi = 0 and gi ∈ (f). The numbers mi need not to be
unique for the following reasons. Suppose mi = nik and nigi ∈ (f). Then by Corollary 5.15,
omi = oni + cni and hence (x − oni)gi = (x − omi)gi + cnigi ∈ (f). That is, we can replace
mi by its factor ni.

Proposition 7.12 Algorithm SatM is correct.

Proof: Let L1 = (f) and L2 = (f, (x − om1)g1, . . . , (x − oms)gs). We claim that satZ(L1) =
satZ(L2). Since L1 ⊂ L2, satZ(L1) ⊂ satZ(L2). Since satZ(L1) = (g1, . . . , gs), we have L2 ⊂
satZ(L1) and hence satZ(L2) ⊂ satZ(L1). The claim is proved. Then satZ(L2) = (g1, . . . , gs)
and migi ∈ L1 ⊂ L2. Since (x − omi)gi ∈ L2, i = 1, . . . , s, L2 is M -saturated by Lemma
5.20.

(cid:3)

7.3 Algorithms for Laurent binomial and binomial σ-ideals

In this section, we will present several algorithms for Laurent binomial and binomial σ-ideals,
and in particular a decomposition algorithm for binomial σ-ideals. We ﬁrst give an algorithm
to compute the characteristic set for a Laurent binomial σ-ideal.

Algorithm 6 — CharSet
Input: F : a ﬁnite set of Laurent σ-binomials in F{Y±}.
Output:∅, if [F ] = [1]; otherwise, a regular and coherent Laurent binomial σ-
chain A such that [A] = [F ] and A is a characteristic set of the σ-ideal
[F ].

1. Let F = {Yf1 − c1, . . . , Yfr − cr} and f = {f1, . . . , fr}.
2. Compute a set of generators H ⊂ Z[x]r of kerZ[x]([f1, . . . , fr]) with Algorithm GKER.
3. If for any h = (h1, . . . , hr)τ ∈ H, Qr
6= 1, then return ∅.
5. Let g = {g1, . . . gs} and gi =Pr
6. Return A = {g1, . . . , gs}, where gi = Ygi − di and di =Qr

k=1 ai,kfk, where ai,k ∈ Z[x], i = 1, . . . , s.

4. Compute the reduced Gr¨obner basis g of f with Algorithm GHNF.

i=1 chi

i

ai,k
k=1 c
k

, i = 1, . . . , s.

Proposition 7.13 Algorithm CharSet is correct.

45

Proof: Steps 1-3 uses Proposition 4.4 to check whether [F ] = [1]. Note that (f) and (g)
are the support lattices of the binomial σ-ideals [F ] and [G], respectively. By Corollary 4.3,
[F ] = [G]. By Theorem 4.14, A is a regular and coherent σ-chain and hence a characteristic
set of [A].

(cid:3)

We now show how to compute the reﬂexive closure for a Laurent binomial σ-ideal.

Algorithm 7 — Reﬂexive
Input: P : a ﬁnite set of Laurent σ-binomials in F{Y±}, where F is inversive.
Output:A: a regular and coherent Laurent binomial σ-chain such that [A] is the

reﬂexive closure of [P ].

1. Let G = CharSet(P ). If G = ∅, return 1.
2. Let G = {g1, . . . , gs}, gi = Ygi − di, and g = [g1, . . . , gs] ∈ Z[x]n×s.
3. H =XFactor(g).
4. If H = ∅, return G.
5. Let H = {(hi, ei)| i = 1, . . . , r} and ei = (ei1, . . . , eis)τ .
6. Let P := G ∪ {Yhi − σ−1(Qs

), i = 1, . . . , r}, and go to step 1.

j=1 dei,j

j

Proposition 7.14 Algorithm Reﬂexive is correct.

Proof: The algorithm basically follows the proof of Theorem 5.5. By CharSet, [P ] = [G]
and G is a regular and coherent σ-chain. In step 4, if H = ∅, then (g) is x-saturated, and by
Theorem 5.3, [G] is reﬂexive and the theorem is proved. Otherwise, we execute steps 5 and
6. Let I1 = [P ], L1 = (f), I2 = [G ∪ {Yhi − σ−ki(Qs
), i = 1, . . . , r}], and L2 = L(I2).
Then, we have I1   I2 ⊂ Ix and L1   L2 ⊂ Lx, where Lx = satx(L1) and Ix is the reﬂexive
closure of I1. Similar to the proof of Theorem 5.5, the algorithm will terminate and output
the reﬂexive closure of [P ].

bi,j
j=1 d
j

(cid:3)

Remark 7.15 Similar to Algorithm Reﬂexive, we can give algorithms to check whether
a Laurent binomial σ-ideal I is well-mixed, perfect, or prime, and in the negative case to
compute the well-mixed or perfect closures of I. The details are omitted.

We give a decomposition algorithm for perfect Laurent binomial σ-ideals.

46

Algorithm 8 — DecLaurent
Input: P : a ﬁnite set of Laurent σ-binomials in F{Y±}, where F is inversive
Output:∅, if {P} = [1] or regular and coherent binomial σ-chains C1, . . . ,Ct such
i=1[Ci] is a

that [Ci] are Laurent reﬂexive prime σ-ideals and {P} = ∩t
minimal decomposition.

and algebraically closed.

1. Let F =Reﬂexive(P ). If F = 1, return ∅.
2. Set R = ∅ and F = {F}.
3. While F 6= ∅.

3.1. Let F = {Yf1 − c1, . . . , Yfr − cr} ∈ F, F = F \ {F}.
3.2. Let G = CharSet(F ). If G = ∅, goto step 3.
3.3. Let G = {g1, . . . , gs}, gi = Ygi − di, and g = [g1, . . . , gs] ∈ Z[x]n×s.
3.4. H =ZFACTOR(g).
3.5. If H = ∅, add G to R.
3.6. Let H = {(hi, ki, ei)| i = 1, . . . , r} and ei = (ei1, . . . , eis)τ .
3.7. For i = 1, . . . , t, let ri,1, . . . , ri,ki be the ki-th roots of Qs
3.8. For l1 = 1, . . . , k1,. . . ,lt = 1, . . . , kt, add G ∪ {Yh1 − r1,l1, . . . , Yht − rt,lt} to F.

j=1 dei,j

.

j

4. Return R.

Example 7.16 Let P = {g1, g2, g3}, where g1 = y−2
3−
1, and k ≥ 2.
[P ] is already reﬂexive, so step 1 does nothing. P is already a regular and
coherent chain, so G = P . Let g1 = [xk − 2, 0, 0]τ , g2 = [0, xk − 2, 0]τ , g3 = [1,−x, 2]τ be
the supports of g1, g2, and g3, respectively. Then [g1, g2, g3] is already a generalized Hermite
normal form.

2 −1, g3 = y1y−x
2 y2

1 −1, g2 = y−2

1 yxk

2 yxk

In Steps 3.4-3.6, H = {(h1, k1, e1)}, where h1 = [1,−x, xk]τ , k1 = 2, e1 = [−1, x, xk]τ .
In Step 3.7, r1,1 = 1 and r1,2 = −1. In Step 3.8, P1 = y1y−x
3 + 1
are added to G to obtain C1 = {g1, g2, g3, P1} and C2 = {g1, g2, g3, P2}. Both [C1] and [C2] are
reﬂexive and prime, and are returned.
To see why the algorithm is correct, from e1 = [−1, x, xk], we have (g1 +1)−1(g2 +1)x(g3 +
= y2

3 − 1 and P2 = y1y−x

y2xk
3 = 1 mod[P ]. Hence, P1P2 = y2

2 yxk

2 yxk

1y−2x

1)xk

1y−2x

2

2

y2xk
3 − 1 ∈ [P ].

Proposition 7.17 Algorithm DecLaurent is correct.

Proof: The algorithm basically follows the proof of Theorem 5.7. The proof is similar to that
(cid:3)
of Theorem 7.14. By the proof of Theorem 5.7, we obtain a minimal decomposition.

In the rest of this section, we give a decomposition algorithm for binomial σ-ideals. Before
giving the main algorithm, we give a sub-algorithm DecMono which treats the σ-monomials.
Basically, it gives the following decomposition

V(

nYi=1

yfi
i ) = V(y1) ∪ V(y2/y1) ∪ ··· ∪ V(yn/{y1, . . . , yn−1})

where 0 6= fi ∈ N[x] and V(yc/S) is the set of zeros of yc = 0 not vanishing any of the
variables in S. The correctness of the algorithm comes directly from the above formula.

47

Algorithm 9 — DecMono

Input: (Y0, B, Y1): Y0, Y1 are disjoint subsets of Y and B a ﬁnite set of σ-

Output:(Y0i, Bi, Y1i): Y0i, Y1i are disjoint subsets of Y, Bi consists of proper

binomials or σ-monomials in F{Y}.
σ-binomials, and V(Y0 ∪ B/Y1) = ∪r

i=1V(Y0i ∪ Bi/Y1i).

1. Set R = ∅ and F = {(Y0, B, Y1)}.
2. While F 6= ∅.

2.1. Let C = (Y0, B, Y1) ∈ F, F = F \ {C}.
2.2. For all yc ∈ Y0, let B1 = Byc=0 (replace yxk
2.3. If B1 contains no σ-monomials, add (Y0, B1, Y1) to R and goto step 2.
2.4. Let M =Qk
ci ∈ B1, where 0 6= fi ∈ N[x]. B1 = B1 \ {M}.
2.5. Let Y2 := {yc1, . . . , yck} \ Y1. If Y2 = ∅, go to step 2; else let Y2 = {yt1 , . . . , yts}.
2.6. For i = 1, . . . , s, add (Y0 ∪ {yti}, B1, Y1 ∪ {yt1, . . . , yti−1}) to F.

c by 0) and delete 0 from B1.

i=1 yfi

3. Return R.

We now give the main algorithm. The algorithm basically follows the proof of Theorem
6.27. The main modiﬁcation is that instead of the perfect ideal decomposition {F} = ({F} :
)T∩n

i=1{F, yi}, we use the following zero decomposition

V(F ) = V({F} : )[∪n

i=1V(F ∪ {yi}/{y1, . . . , yi−1}).

The purpose of using the later decomposition is that many redundant components can be
easily removed by the following criterion V(F/D) = ∅ if F ∩ D 6= ∅, which is done in step
2.5 of Algorithm DecMono.

Algorithm 10 — DecBinomial
Input: F : a ﬁnite set of σ-binomials in F{Y}.
Output:∅, if {F} = [1] or (C1, Y1), . . . , (Cr, Yr), where Yi ⊂ Y and Ci are regular
and coherent σ-chains containing σ-binomials or variables in Y\ Yi such
that sat(Ci) are reﬂexive prime σ-ideals and {F} = ∩r

i=1sat(Ci).

1. Set R = ∅ and F =DecMono(∅, F,∅).
2. While F 6= ∅.

2.1. Let C = (Z0, B, Z1) ∈ F, F = F \ {C}.
2.2. If B = ∅, add (Z0, Z1) to R.
2.3. Let E = DecLaurent(B) in F{Z±}, where Z = Y \ Z0 and m = |Z|.
2.4. If E = ∅ goto step2.
2.5. Let E = {E1, . . . , El} and El = {Zfl,1 − cl,1, . . . , Zfl,sl − cl,sl}, where fl,k ∈ Z[x]m.
l,sl − cl,slZf −
2.7. Add ({Z0, Zf +
2.8. Let Z = {yc1, . . . , ycs}. For i = 1, . . . , s, do

l,sl}, Z1) to R, l = 1, . . . , k.

l,1 − cl,1Zf

l,1, . . . , Zf +

−

F = F∪ DecMono(Z0 ∪ {yci}, B, Z1 ∪ {yc1, . . . , yci−1}).

3. Return R.

48

Example 7.18 Let A = {A1, A2, A3}, where A1 = yxk
3 − yx
2 ,
and k ≥ 2. In Step 1, we have F = {(∅,A,∅)}. From Example 7.16, in Step 2.3, we have
E = {C1,C2}, where C1 and C2 are given in Example 7.16. In Step 2.7, (E1,∅) and (E2,∅) are
added to R, where E1 = {A1, A2, A3, Q1}, E2 = {A1, A2, A3, Q2}, and Q1 = y1yxk
2 , Q2 =
y1yxk
2 . In Step 2.8, Z = {y1, y2, y3} and ({y1, y2},∅,∅), ({y2, y3),{A1},{y1}) are added to
F. Finally, we have the following decomposition {A} = [y1, y2]∩[A1, y2, y3]∩sat(C1)∩sat(C2),
where all components are reﬂexive and prime.

2, A3 = y1y2

1, A2 = yxk

2 − y2

1 − y2

3 −yx

3 +yx

Remark 7.19 Using the algorithm in [9], the following decomposition is obtained: {A} =
[y1, y2] ∩ sat(A). From Example 7.16, sat(A) is not prime. Then, Algorithm DecBinomial
is stronger than the general decomposition algorithm given in [9].

Proposition 7.20 Algorithm DecBinomial is correct.

Proof: In step 1, σ-monomials in F are treated. In step 2, we will treat the components of
F one by one. In step 2.1, the component (Z0, B, Z1) is taken from F. In step 2.3, {B} is
decomposed as {B} = ∩k
l=1[El] in F{Z±}, where El are regular and coherent σ-chains and
[El] are reﬂexive prime ideals. By (30) and Corollary 6.30, we have
l=1([El]F{Z±}) ∩ F{Y} = ∩k

{B} :  = {B} ∩ F{Z} = ∩k

l=1sat(E+

(40)

l ),

−

l = {Zf +

l,1 − cl,1Zf
where E+
coherent, by Lemma 6.34, E+
l
by Corollary 6.31, sat(E+
only if [B] contains a σ-monomial.

l,sl}, l = 1, . . . , k. Since El is regular and
is also regular and coherent. Since [El] is reﬂexive and prime,
l ) is also reﬂexive and prime. Note that E = ∅ in step 2.4 if and

l,1, . . . , Zf +

l,sl − cl,slZf −

Since B ⊂ F{Z}, we have the following decomposition
V(Z0 ∪ B/Z1) = V(Z0 ∪ ({B} : )/Z1) ∪s

i=1 V(Z0 ∪ B ∪ {yci}/{yc1, . . . , yci−1} ∪ Z1),

where V(Z0∪ B∪{yci}/{yc1 , . . . , yci−1}∪ Z1) is further simpliﬁed with Algorithm DecMono
in step 2.8. From (40),

l=1V(sat(Z0, E+

V(Z0 ∪ {B} : /Z1) = ∪k

l )/Z1) = ∪k
l } is a regular and coherent σ-chain since E+

where {Z0, E+
The above formula explains why ({Z0, E+
V(F ) = ∪k
the Cohn closure of V(sat(Ci)/Yi) is V(sat(Ci)) and hence

Let the algorithm returns R = {(Ci, Yi); i = 1, . . . , m}. From the above proof, we have
l=1V(sat(Ci)/Yi). Since Yi ∩ Ci = ∅ and sat(Ci) is a reﬂexive and prime σ-ideal,

l=1V([Z0, sat(E+

l )]/Z1),

l does not contain variables in Z0.

l }, Z1) is added to R in steps 2.5-2.7.

V(F ) = ∪k

l=1V(sat(Ci)/Yi) = ∪k

l=1V(sat(Ci)).
l=1{sat(Ci)} = ∩k

By the diﬀerence Hilbert Nullstellensatz, {F} = ∩k
l=1sat(Ci). The algorithm
terminates, since after each execution of step 2, in the new components (Y0l, Bl, Y1l) added
(cid:3)
to F in step 2.8, Bl contains at least one less variables than B.

49

8 Conclusion

In this paper, we initiate the study of binomial σ-ideals. Two basic tools used to study
binomial σ-ideals are the Z[x]-lattice and the characteristic set instead of the Z-lattice and
the Gr¨obner basis used in the algebraic case [7].

For Laurent binomial σ-ideals, two main results are proved. Canonical representations
for proper Laurent binomial σ-ideals are given in terms of Gr¨obner basis of Z[x]-lattices,
regular and coherent σ-chains in F{Y±}, and partial characters over Z[x]n, respectively. It
is also shown that a Laurent binomial σ-ideal is radical and dimensionally un-mixed. We also
give criteria for a Laurent binomial σ-ideal to be reﬂexive, well-mixed, perfect, and prime in
terms of its support lattice. It is shown that the reﬂexive, well-mixed, and perfect closures
of a Laurent binomial σ-ideal I is still binomial whose support lattices are the x-, M-, and
P-saturation of the support lattice of I .

For binomial σ-ideals, we show that certain properties of algebraic binomial ideals given
in [7] can be extended to the diﬀerence case using the theory of Gr¨obner basis in the case of
inﬁnitely many variables. It is shown that most properties of Laurent binomial σ-ideal can
be extended to the normal binomial σ-ideals.

Algorithms are given for the key results of the paper. We give algorithms to check whether
a given Laurent binomial diﬀerence ideal I is reﬂexive, prime, well-mixed, or perfect, and
in the negative case, to compute the reﬂexive, well-mixed, and perfect closures of I. An
algorithm is given to decompose a ﬁnitely generated perfect binomial diﬀerence ideal as the
intersection of reﬂexive prime binomial diﬀerence ideals.

Finally, we make a remark about diﬀerential binomial ideals. The study of binomial
diﬀerential ideals is more diﬃcult, because the diﬀerentiation of a binomial is generally
not a binomial. Diﬀerential toric varieties were deﬁned in [18] and were used to connect
the diﬀerential Chow form [8] and diﬀerential sparse resultant [18]. But, contrary to the
diﬀerence case, the deﬁning ideal for a diﬀerential toric variety is generally not binomial.

References

[1] M. Barile, M. Morales, A. Thoma. Set-theoretic Complete Intersections on Binomials,

Proc. AMS, 130(7), 1893-1903, 2001.

[2] D. Bouziane, A. Kandri Rody, H. Maˆarouf. Unmixed-dimensional Decomposition of a
Finitely Generated Perfect Diﬀerential Ideal, Journal of Symbolic Computation, 31(6),
631-649, 2001.

[3] H. Cohen. A Course in Computational Algebraic Number Theory, Springer-Verlag,

Berlin, 1993.

[4] R. M. Cohn. Diﬀerence Algebra, Interscience Publishers, New York, 1965.

[5] D. Cox, J. Little, D. O’Shea. Using Algebraic Geometry, Springer-Verlag, New York,

1998.

50

[6] A. Dickenstein, L. F. Matusevich, E. Miller. Combinatorics of Binomial Primary De-

composition, Mathematische Zeitschrift, 264(4), 745-763, 2010.

[7] D. Eisenbud and B. Sturmfels. Binomial Ideals, Duke Math. J., 84(1), 1-45, 1996.

[8] X. S. Gao, W. Li, C. M. Yuan. Intersection Theory in Diﬀerential Algebraic Geometry:
Generic Intersections and the Diﬀerential Chow Form, Trans. of Amer. Math. Soc.,
365(9), 4575-4632, 2013.

[9] X. S. Gao, Y. Luo, C. M. Yuan. A Characteristic Set Method for Ordinary Diﬀerence

Polynomial Systems, Journal of Symbolic Computation, 44(3), 242-260, 2009.

[10] X.S. Gao, J. Van der Hoeven, C.M. Yuan, G.L. Zhang, Characteristic Set Method for
Diﬀerential-diﬀerence Polynomial Systems, Journal of Symbolic Computation, 44(9),
1137-1163, 2009.

[11] K. O. Geddes, S. R. Czapor, G. Labahn. Algorithms for Computer Algebra, Kluwer

Academic Publishers, Boston, MA, 1992.

[12] V. P. Gerdt and D. Robertz. Computation of Diﬀerence Gr¨obner Bases, Computer

Science Journal of Moldova, 20(2), 203-226, 2012.

[13] E. Hrushovski. The Elementary Theory of the Frobenius Automorphisms, Available

from http://www.ma.huji.ac.il/˜ ehud/, July, 2012.

[14] K. I. Iima and Y. Yoshino. Gr¨obner Bases for the Polynomial Ring with Inﬁnite Variables

and Their Applications, Communications in Algebra, 37:10, 3424-3437, 2009.

[15] R. J. Jing, C. M. Yuan, X. S. Gao. A Polynomial-time Algorithm to Compute General-

ized Hermite Normal Form of Matrices over Z[x], arXiv:1601.01067, 2016.

[16] U. Koppenhagen and E. W. Mayr. An Optimal Algorithm for Constructing the Reduced

Gr¨obner Basis of Binomial Ideals, Proc. ISSAC’96, ACM Press, 55-62, 1996.

[17] A. Levin. Diﬀerence Algebra, Springer-Verlag, New Work, 2008.

[18] W. Li, C. M. Yuan, X. S. Gao. Sparse Diﬀerential Resultant for Laurent Diﬀerential

Polynomials, Foundations of Computational Mathematics, 15(2), 451-517, 2015.

[19] I. O. Mart´inez de Castilla, R. P. S´anchez. Cellular Binomial Ideals. Primary Decom-

position of Binomial Ideals, Journal of Symbolic Computation, 30(4), 383-400, 2000.

[20] M. P. Mill´an, A. Dickenstein, A. Shiu, C. Conradi. Chemical Reaction Systems with

Toric Steady States, Bull. Math. Biol., 74, 1027-1065, 2012.

[21] E. Miller and B. Sturmfels. Combinatorial Commutative Algebra, Springer-Verlag, New

York, 2005.

[22] L. Pachter and B. Sturmfels (eds). Algebraic Statistics for Computational Biology, Cam-

bridge University Press, 2005.

51

[23] I. Peeva and B. Sturmfels. Syzygies of Codimension 2 Lattice Ideals, Mathematische

Zeitschrift, 229(1), 163-194, 1998.

[24] J. F. Ritt and J. L. Doob. Systems of Algebraic Diﬀerence Equations, American Journal

of Mathematics, 55(1), 505-514, 1933.

[25] M. Saleemi and K. H. Zimmermann. Linear Codes as Binomial Ideals, International

Journal of Pure and Applied Mathematics, 61(2), 147-156, 2010.

[26] M. Wibmer. Algebraic Diﬀerence Equations, Preprint, 2013.

52

