6
1
0
2

 
r
a

M
1

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
1
6
1
0
0

.

3
0
6
1
:
v
i
X
r
a

SMALLEST IRREDUCIBLE OF THE FORM x2 − dy2

SHANSHAN DING

Abstract. It is a classical result that prime numbers of the form x2 + ny2 can be
characterized via class ﬁeld theory for an inﬁnite set of n. In this paper we derive the
function ﬁeld analogue of the classical result. Then we apply an eﬀective version of
the Chebotarev density theorem to bound the degree of the smallest irreducible of the
form x2 − dy2, where x, y, and d are elements of a polynomial ring over a ﬁnite ﬁeld.

1. Introduction and Statement of Results

Mathematicians since Fermat have studied primes of the form x2 + ny2. This is a
seemingly simple topic that quickly taps into some of the deepest subjects in number
theory. In his book ﬁttingly titled Primes of the Form x2 + ny2, David Cox [1] applied
extensive concepts from class ﬁeld theory and complex multiplication to address this
topic in the number ﬁeld setting. A particularly important result is the following:
Theorem (Cox 5.26). Suppose n > 0 is a square-free integer such that n 6≡ 3 (mod 4).
If p is an odd prime not dividing n, then p is of the form x2 + ny2 for some x, y ∈ Z
if and only if the ideal in Z generated by p splits completely in the Hilbert class ﬁeld of
Q(√−n).

This is a special case of a well-known general result in class ﬁeld theory for Dedekind
domains. In Theorem 2.4, we adapt it to function ﬁelds to characterize irreducibles that
generate ideals of the form (x2 − dy2), where x, y, and d are elements of a polynomial
ring over a ﬁnite ﬁeld. The objective of this paper is to bound the degree of the smallest
irreducible of the form x2 − dy2 in terms of deg d and the size of the constant ﬁeld. We
will accomplish this by applying an eﬀective version of the Chebotarev density theorem
to Theorem 2.4.

Throughout this paper, Fq will denote a ﬁnite ﬁeld of q elements, where q is a power
of an odd prime. Let A = Fq[T ] be the polynomial ring over Fq, F = Fq(T ) be the

quotient ﬁeld of A, K = F (√d) for some d ∈ A be a quadratic extension of F , and L
be the Hilbert class ﬁeld of K. We have F ⊂ K ⊂ L as a tower of global function ﬁelds.
Finally, let BK and BL denote the integral closures of A in K and L, respectively, and
observe that BK = A[√d] if d is square-free.

We now state our main result. Unless otherwise speciﬁed, we will work within the

setting outlined in the previous paragraph.

2000 Mathematics Subject Classiﬁcation. Primary 11R37; Secondary 11R29.
Key words and phrases. Global function ﬁelds; Hilbert class ﬁeld; Chebotarev density theorem; class

numbers.

1

2

SHANSHAN DING

Theorem 1.1. Suppose d /∈ Fq is square-free, and suppose further that if deg d is even,
then the leading coeﬃcient of d is a square in F×q . Under these conditions, there is an
irreducible p ∈ A of the form x2 − dy2 for some x, y ∈ A such that

deg p ≤& 4 log(2ˆr(cid:6) deg d
where ˆr =((√q + 1)deg d−1

2(√q+1)deg d−2

log q

deg d

2 (cid:7) + 2)

' ,

if deg d is odd

if deg d is even.

Let hK denote the divisor class number of K. We can derive from Theorem 1.1 a

non-trivial lower bound for hK.

Corollary 1.2. If deg d is odd, then

hK >

deg d−1

4 − 2
q
deg d + 1

.

2. Preliminaries

Every ﬁnite prime of F is of the form A(p), the discrete valuation ring (DVR) obtained
by localizing A at some non-zero prime ideal (p) of A. The inﬁnite prime of F , p∞, is
the localization of the ring Fq[T −1] at the prime ideal generated by T −1. Its degree is
deﬁned to be 1. For a quadratic extension K = F (√d) of F , the ramiﬁcation behavior
of p∞ in K can be easily determined (see 14.6 of [5]). If deg d is odd, then p∞ ramiﬁes
in K. If deg d is even, then p∞ splits completely in K if the leading coeﬃcient of d is
a square in F×q and remains a prime in K otherwise. Let S∞ be the set of primes in K
that lie above p∞.
Deﬁnition 2.1. The Hilbert class ﬁeld L of K, with respect to BK , is the maximal
unramiﬁed abelian Galois extension of K in the separable closure of K in which every
element of S∞ splits completely.
Remark. The extension L/F is Galois (see 2.3 of [4]).

Let E1 and E2 be function ﬁelds. The extension E2/E1 is geometric if E1 and E2
have the same constant ﬁeld. It is easy to see that in order for K/F to be a geometric
extension, d cannot be a non-square constant. Assuming that Fq is indeed the constant
ﬁeld of K, then the constant ﬁeld of L is δ-dimensional over Fq, where δ is the gcd of
the degrees of elements in S∞ (see 1.3 of [4]). Because δ = 1 if p∞ either ramiﬁes or
splits completely in K and δ = 2 if p∞ remains a prime in K,
(2.1)

L/K is geometric ⇐⇒ p∞ ramiﬁes or splits completely in K.

Notice the conditions of Theorem 1.1 ensure that L/F is geometric.

If p is a prime ideal of BK that is unramiﬁed in L, then there exists a unique σ ∈

Gal(L/K) such that for all α ∈ BL,
(2.2)

σ(α) ≡ α|BK /p| (mod P),

SMALLEST IRREDUCIBLE OF THE FORM x2

− dy2

3

P that lie above p form a conjugacy class in Gal(L/K), we denote the Artin symbol by

where P is a prime ideal in BL that lies above p. The unique σ ∈ Gal(L/K) is called
the Artin symbol and denoted by (cid:0)L/K
P (cid:1). Because the Artin symbols of all prime ideals
(cid:0)L/K
p (cid:1) instead to emphasize the underlying prime. It is a well-known fact that the order
of each element in the conjugacy class (cid:0)L/K
p (cid:1) is equal to the degree of the extension
BK/p ⊂ BL/P (the proof in the number ﬁeld case can be found in 5.21 of [1], and the
proof in the function ﬁeld case is completely analogous). Consequently,

(2.3)

p splits completely in L ⇐⇒ (cid:18)L/K

p (cid:19) = 1.

We note here that the Artin symbol is well-deﬁned for any ﬁnite Galois extension.
Everything in this paragraph would still hold if we replaced K by F .

Next, let IK be the set of fractional ideals of BK and PK be the set of principal
fractional ideals in IK. The quotient group IK/PK is the ideal class group of K. It is
a standard result that IK/PK is ﬁnite. We now state another famous result about the
ideal class group, the proof of which can be found in 1.3 of [4]. Its corollary follows
immediately.

Theorem 2.2. The Artin symbol induces an isomorphism between the ideal class group
of K and Gal(L/K).
Corollary 2.3. If p is a prime ideal in BK , then

p splits completely in L ⇐⇒ p is principal.

Observe that since [L : K] = |Gal(L/K)| = |IK/PK|, we know [L : K] is ﬁnite. We
call |IK/PK| the ideal class number of K and denote it by hBK , which is not to be
confused with the divisor class number of K, denoted by hK. The relationship between
hBK and hK (see 14.7 of [5]) depends on the ramiﬁcation behavior of p∞ in K and can
be summarized as the following:

hK
hK
deg g
2hK

hBK =


if p∞ ramiﬁes
if p∞ splits completely
if p∞ remains a prime,

(2.4)

(2.5)

where in the second case g ∈ A and g + h√d for some h ∈ A is a fundamental unit in

BK. We will use (2.4) to bound the ideal class number in Section 3.

A detailed proof of Cox 5.26 is presented in [1]; here we outline the proof to motivate
the function ﬁeld analogue of the theorem. Let OK denote the ring of algebraic integers
in K = Q(√−n).
If n is a positive, square-free integer and n 6≡ 3 (mod 4), then
OK = Z[√−n]. Furthermore, if p ∤ n, then (p) is unramiﬁed in K. Because (x2 +ny2) =
(x + y√−n)(x − y√−n) in OK,

(p) = (x2 + ny2) ⇐⇒ pOK = p¯p, p 6= ¯p, and p is principal in OK

⇐⇒ pOK = p¯p, p 6= ¯p, and p splits completely in L
⇐⇒ (p) splits completely in L,

4

SHANSHAN DING

where L is the Hilbert class ﬁeld of Q(√−n). Recall that for a quadratic function ﬁeld
extension K = F (√d) of F , if d is square-free, then the integral closure of A in K is
A[√d]. Note also that if BK = A[√d] and p ∤ d, then the equivalences in (2.5) hold in
the function ﬁeld setting. Thus we state the following theorem without proof, for its
proof is completely analogous to that of Cox 5.26.
Theorem 2.4 (Analogue of Cox 5.26). Let d ∈ A be square-free (d 6= 0, 1). If p ∈ A is
an irreducible not dividing d, then

(p) = (x2 − dy2) for some x, y ∈ A ⇐⇒ (p) splits completely in L.
3. Chebotarev Density Theorem and Proof of Theorem 1.1

then the Dirichlet density of the set {p ⊂ E1 | p unramiﬁed in E2,(cid:0)E2/E1

Let p be a prime ideal in a number ﬁeld E1. The classical Chebotarev density theorem
states that for a Galois extension E2/E1, if C is a conjugacy class in G = Gal(E2/E1),
.
|G|
One could use this result to approximate the number of unramiﬁed primes of a given
degree whose Artin symbols are in the same conjugacy class. Eﬀective versions of the
Chebotarev density theorem bound the error term of this approximation, which in the
number ﬁeld case was addressed by Lagarias and Odlyzko [2]. Murty and Scherk [3]
provided analogues of their results for function ﬁelds, where the Riemann hypothesis is
known to be true.

p (cid:1) = C} is |C|

Suppose E1 and E2 are function ﬁelds. Let F be the constant ﬁeld of E1, ¯F be the

algebraic closure of F in E2, and let m denote [¯F : F]. Deﬁne

π(n) := #{p ⊂ E1 | p unramiﬁed in E2, deg p = n} and
πC(n) := #{p ⊂ E1 | p unramiﬁed in E2, deg p = n,(cid:18)E2/E1

p (cid:19) = C}.

Murty and Scherk showed that

πC(n) − m|C|
|G|

(3.1) (cid:12)(cid:12)(cid:12)(cid:12)
where gEi is the genus of Ei, q = |F|, and |DE2/E1| = Pp⊂E1

≤ 2gE2 |C|
|G|

+ 2(2gE1 + 1)|C|

π(n)(cid:12)(cid:12)(cid:12)(cid:12)

qn/2
n

qn/2
n

ram. in E2

+(cid:18)1 + |C|

n (cid:19)|DE2/E1|,

deg p is the degree of

the diﬀerent of E2 over E1. Note here that πC(n) is certain to be positive as soon as
m|C|
|G|
Now let E1 = F , E2 = L, and C = 1. By (2.3) and Theorem 2.4, if d is square-free

π(n) > RHS of (3.1).

and p is an irreducible in A not dividing d, then

(3.2)

(p) = (x2 − dy2) ⇐⇒ (cid:18)L/F

(p) (cid:19) = C.

Since DVRs that arise from non-zero prime ideals of A exhaust the ﬁnite primes of
F , πC(n) represents the number of prime ideals of degree n (n > 0) in A of the form
(x2 − dy2), plus possibly 1 for the inﬁnite prime p∞ if n = 1. Thus the smallest positive

SMALLEST IRREDUCIBLE OF THE FORM x2

− dy2

5

p

integer n such that m|C|
π(n) > RHS of (3.1) + 1 is an upper bound for the degree of the
|G|
smallest (p) in A of the form (x2 − dy2). Because we can always multiply p by the unit
x2−dy2
, this is equivalent to an upper bound for the degree of the smallest irreducible
in A of the form x2 − dy2.
π(n) >
RHS of (3.1) + 1 in terms of deg d and q. To do this, we must ﬁrst decipher the terms
that appear in (3.1). Clearly, |C| = 1 and |G| = 2r, where r = [L : K] will be addressed
later. It is a well-known fact (see p.49 of [5]) that the genus of F is 0. To ﬁnd gL and
|DE2/E1| we resort to the Riemann-Hurwitz theorem for function ﬁelds (see 7.16 of [5]),
which states that if E2/E1 is a ﬁnite, separable, geometric extension, then

Our goal therefore is to ﬁnd an upper bound for the ﬁrst n such that m|C|
|G|

2gE2 − 2 = [E2 : E1](2gE1 − 2) + |DE2/E1|.

(3.3)
Because the condition of the Riemann-Hurwitz theorem requires F ⊂ K ⊂ L to be
geometric extensions, we require that d /∈ Fq, and if deg d is even, we also require the
leading coeﬃcient of d to be a square in F×q .
To ﬁnd gL, we will apply (3.3) twice, ﬁrst to K/F to solve for gK, then to L/K.
Having solved for gL, we can then apply (3.3) once more to L/F to ﬁnd |DL/F|. The
following proposition will help us with the ﬁrst step.

Proposition 3.1. If d satsiﬁes the hypotheses of Theorem 1.1, then

|DK/F| = deg d +(1

0

if deg d is odd
if deg d is even.

ram. in K

Proof. Given that |DK/F| = Pp⊂F
deg p, let d = ud1d2 · · · dl be the factorization of d
into unit and monic irreducibles in A, then (d) = (d1)(d2) · · · (dl) = (√d)2 as ideals in
F (√d) = K. Since d1, d2, . . . , dl are pairwise coprime, the complete factorization of (d)
in K must be (√d1)2(√d2)2 · · · (√dl)2, so the ﬁnite primes of F that ramify in K are
precisely the DVRs that arise from (d1), (d2), . . . , (dl). Thus |DK/F| =Pdi
plus 1 if p∞ ramiﬁes in K, i.e. if deg d is odd.
Since |DL/K| = 0 by deﬁnition of the Hilbert class ﬁeld, we compute from the

deg di = deg d,

(cid:3)

Riemann-Hurwitz theorem that

(3.4)

2 (cid:25) − 1,
gK =(cid:24)deg d
gL = r(cid:18)(cid:24)deg d
2 (cid:25) − 2(cid:19) + 1, and
2 (cid:25) .
|DL/F| = 2r(cid:24)deg d

Next we deal with the term m|C|
|G|

π(n). Since L/F is geometric, m = 1.

6

SHANSHAN DING

Proposition 3.2. As it appears in (3.1),

π(n) ≥

qn
n −

qn/2
n − qn/3 −

2r(cid:6) deg d
2 (cid:7)n

.

Proof. Deﬁne γn to be the number of monic irreducibles in A and εn the number of
primes in F that ramify in L, both of degree n. Observe that π(n) = γn − εn, plus
n + qn/3, so
1 if p∞ ramiﬁes.
γn ≥ qn
(cid:3)

It is well-known (see p.14 of [5]) that |γn − qn

n | ≤ qn/2
2r⌈ deg d
2 ⌉

deg p, εn ≤ |DL/F |

n − qn/2

n =

n

.

n − qn/3. Since |DL/F| = Pp⊂F

ram. in L

We are now ready to bound the smallest positive integer n such that m|C|
|G|

RHS of (3.1) + 1 in terms of deg d, q, and r.

π(n) >

Proof of Theorem 1.1. After substituting and collecting terms, we need to bound the
smallest n such that

qn −(cid:18)3 + 2r(cid:24)deg d

(3.5)

2 (cid:25)(cid:19) qn/2 − nqn/3 −(cid:18)4r2(cid:24)deg d
−(cid:18)4r2(cid:24)deg d

2 (cid:25) + 2r(cid:19) n
2 (cid:25) + 2r(cid:24)deg d

2 (cid:25)(cid:19) > 0.

Note that qn/2 > n for all (q, n) and 2qn/2 ≥ nqn/3 for all (q, n)6=(3, 5). If (q, n)=(3, 5),
then nqn/3 − 2qn/2 < (qn/2 − n)(cid:0)4r2(cid:6) deg d
2 (cid:7) + 2r(cid:1). These observations show that we can
reasonably bound n by solving for it in the equation
(3.6)
qn −(cid:18)4r2(cid:24)deg d
2 (cid:25)(cid:19) = 0,

2 (cid:25) + 2r + 5(cid:19) qn/2 −(cid:18)4r2(cid:24)deg d

2 (cid:25) + 2r(cid:24)deg d

2 (cid:25) + 2r(cid:24)deg d

to which we can apply the quadratic formula and conclude that the smallest n in
question satisﬁes

(3.7)

Since n is a positive integer,

(3.8)

.

qn/2 <(cid:18)2r(cid:24)deg d
n ≤& 4 log(2r(cid:6) deg d

2 (cid:25) + 2(cid:19)2
' .
2 (cid:7) + 2)

log q

All that remains is ﬁnding an upper bound for r in terms of deg d and q, which we
denote by ˆr to emphasize the fact that [L : K] itself may be much smaller. In particular,
if the inﬁnite prime of F splits completely in K, it could very well be the case that
[L : K] = 1.

By (2.4), if deg d is odd, then r = hK, where hK is the divisor class number of K.
Since we have excluded the possibility that p∞ remains a prime in K, if deg d is even,
deg g , where g + h√d is a fundamental unit in BK. Observe that g2− dh2 ∈ F×q ,
then r = hK

SMALLEST IRREDUCIBLE OF THE FORM x2

− dy2

7

so deg g ≥ deg d
(see 5.11 of [5]) is (√q − 1)2gK ≤ hK ≤ (√q + 1)2gK , hence

2 , and consequently r ≤ 2hK
r ≤((√q + 1)deg d−1

if deg d is odd

if deg d is even,

deg d if deg d is even. A well-known bound on hK

(3.9)

2(√q+1)deg d−2

deg d

and we are done.

(cid:3)

Remark. Given large enough q, Theorem 1.1 suggests we can expect the degree of the
smallest irreducible polynomial of the form x2 − dy2 to be bounded by roughly 2 deg d.
Proof of Corollary 1.2. If deg d is odd, then the degree of the smallest irreducible of the
form x2 − dy2 must be at least deg d, thus we obtain Corollary 1.2 by rearranging the
terms in (3.8).

(cid:3)

Remark. If q is small, Corollary 1.2 actually gives a better lower bound on hK than

(√q − 1)deg d−1 does for large degrees of d. For q = 3, this happens if deg d ≥ 11, and
for q = 5, if deg d ≥ 17.
Example. Let q = 5 and d = T 19 + 3T 8 + 2. The smallest irreducible in F5[T ] of the
form x2 − dy2 is
(3.10)
Its degree is 19, which is less than our upper bound of 60 by Theorem 1.1. Furthermore,
we computed in Magma that the class number of F5(T,√d) is 1348408, which is larger
than our lower bound of 70 by Corollary 1.2. In comparison, the lower bound for hK
given by (√q − 1)deg d−1 is 46.

(T + 2)2 − (T 19 + 3T 8 + 2) = 4T 19 + 2T 8 + T 2 + 4T + 2.

Acknowledgements

The author would like to thank Jeremy Rouse for his unfailing guidance throughout
every stage of this project, Ken Ono for his insight and support, and the referee for
numerous helpful comments. This research was generously funded through the NSF-
REU program.

References

[1] D. A. Cox, Primes of the Form x2 + ny2, Wiley, New York, 1989.
[2] J. C. Lagarias and A. M. Odlyzko, Eﬀective versions of the Chebotarev density theorem, in Alge-

braic Number Fields, Academic Press, London, 1977, pp. 409-464.

[3] K. Murty and J. Scherk, Eﬀective versions of the Chebotarev density theorem for function ﬁelds,

C. R. Acad. Sci. (Paris), 319 (1994), 523-528.

[4] M. Rosen, The Hilbert class ﬁeld in function ﬁelds, Expo. Math., 5 (1987), 365-378.
[5] M. Rosen, Number Theory in Function Fields, Springer-Verlag, New York, 2002.

2994 Lerner Hall, Columbia University, New York, NY 10027
E-mail address: sd2204@columbia.edu

