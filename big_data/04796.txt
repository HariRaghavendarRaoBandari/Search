DIFFRACTION THEORY AND ALMOST PERIODIC

DISTRIBUTIONS

NICOLAE STRUNGARU AND VENTA TERAUDS

Abstract. We introduce and study the notions of translation bounded tempered
distributions, and autocorrelation for a tempered distrubution. We further intro-
duce the spaces of weakly, strongly and null weakly almost periodic tempered
distributions and show that for weakly almost periodic tempered distributions the
Eberlein decomposition holds. For translation bounded measures all these no-
tions coincide with the classical ones. We show that tempered distributions with
measure Fourier transform are weakly almost periodic and that for this class, the
Eberlein decomposition is exactly the Fourier dual of the Lesbegue decomposition,
with the Fourier-Bohr coeﬃcients specifying the pure point part of the Fourier
transform. We complete the project by looking at few interesting examples.

6
1
0
2

 
r
a

 

M
5
1
 
 
]
h
p
-
h
t
a
m

[
 
 

1
v
6
9
7
4
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

Diﬀraction is a key tool in the study of non-periodic long-range order, and the
mathematical theory of almost periodic measures and almost periodic functions
that underpins this is well-developed [9]; see [15] for a recent overview of the theory.
Physical structures that possess a diﬀraction pattern are generally represented by
translation bounded measures. Any translation bounded measure has at least an
autocorrelation and hence a diﬀraction [10]; see [2] for a comprehensive introduction
and overview of the subject.

Essential to the study of diﬀraction is the theory of the Fourier transform in the
setting of tempered distributions. In many of the established results, the proofs rely
on the fact that the original translation bounded measure is tempered as a distribu-
tion and that the autocorrelation is positive deﬁnite. Therefore, it is natural to ask
whether some results about the diﬀraction of translation bounded measures can be
extended to tempered distributions. In [17] it was proven that given any diﬀraction
measure supported on an inﬁnite point set, one may construct non-measure tem-
pered distributions with that diﬀraction. Via this inverse problem technique [13]

1

2

NICOLAE STRUNGARU AND VENTA TERAUDS

one obtains plenty of non-trivial tempered distributions with a diﬀraction, but not
a general theory in which they ﬁt.

In this paper we consider when and how one may deﬁne autocorrelation (and hence
diﬀraction) for a tempered distribution, and whether known results about the diﬀrac-
tion of translation bounded measures can be extended to tempered distributions.
We note that the constructions given in [17] all have (translation bounded) measure
autocorrelation. However, the autocorrelation of a tempered distribution need not,
in general, be a measure. As long as a tempered distribution is positive deﬁnite, the
Bochner Schwartz theorem ensures that its Fourier transform is a positive tempered
measure and thus can be understood as a diﬀraction.

The concept of translation boundedness for tempered distributions is formally de-
ﬁned in the second section. Here we consider some examples of such distributions
and show that they have some properties analogous to those of translation bounded
measures. In fact a translation bounded measure is always a translation bounded
tempered distribution, although of course the converse does not hold.

In the third section, we give a formal deﬁnition of autocorrelation for a tempered
distribution, and some suﬃcient conditions for existence of an autocorrelation. The
properties of positive deﬁnite tempered distributions are considered in Section 4,
and in Section 5 we introduce the concept of weak almost periodicity for tempered
distributions. We here construct the Eberlein decomposition for tempered distri-
butions: as for measures, a weakly almost periodic tempered distribution may be
uniquely decomposed into the sum of a null weakly almost periodic and a strongly
almost periodic tempered distribution.

A tempered distribution whose Fourier transform is a measure is necessarily weakly
almost periodic. In Section 6, we show that for such a distributions, the Fourier
transform carries the Eberlein decomposition of the distribution precisely into the
Lebesgue decomposition of the Fourier dual measure. In Section 7, by extending
the concept of mean to weakly almost periodic distributions, we further show that
for distributions with measure Fourier transform, the Fourier Bohr coeﬃcients of
the distribution correspond to the intensity of the atoms in the pure point part of
the measure. We thus give a simple characterisation of null weakly almost periodic
tempered distributions with measure Fourier trasnform, and subsequently, in Section
8 use this to show that if a weakly almost periodic distribution has a diﬀraction,
it is necessarily pure point. In the ﬁnal section, we apply the results of the paper

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

3

in the consideration of several examples, and describe several classes of tempered
distributions for which an autocorrelation exists.

Throughout the paper we use S to denote the space of Schwartz functions on Rd
and S ′ for its dual, the space of tempered distributions on Rd. When we wish
to emphasise a particular Rd, we write S (Rd). By Cc(Rd), we mean the space of
all continuous functions of compact support, and D = S ∩ Cc(Rd) is the space
of inﬁnitely diﬀerentiable functions of compact support on Rd. The space of all
bounded, uniformly continuous functions on Rd is denoted by Cu(Rd).

Recall that for ψ ∈ S ′, f ∈ S , the function ψ ∗ f ∈ C ∞(Rd) is deﬁned by

where f-(s) := f (−s), s ∈ Rd. We use λ to denote Lesbegue measure on Rd.

ψ ∗ f (t) = ψ(Ttf-) ,

2. Translation Boundedness for Tempered Distributions

In this section we introduce and study the notion of translation boundedness for
tempered distributions, based on the existing concept for measures. Tempered dis-
tributions, with Schwartz functions as test functions, are the natural objects to work
with here, as for many applications we need to work with Fourier transforms. In any
case, most of the results in this section can be extended to distributions by working
with functions in D. We plan to study this in a future project.

In the case of measures, there are two equivalent deﬁnitions for translation bound-
edness: a measure µ on Rd is said to be translation bounded if the function µ ∗ f
is bounded for each f ∈ Cc(Rd), if and only if the set {|µ|(K + x) : x ∈ Rd} is
bounded for each compact K ⊆ Rd. We shall use a version of the ﬁrst condition
to deﬁne translation boundedness for tempered distributions. Although the lat-
ter condition does not have a direct analogue in this setting, we will show that as
for measures, there are several equivalent conditions that may be used to test for
translation boundedness.

Let us start by recalling that the topology on the space of test functions S is given
by the family of norms k · kM,N , deﬁned for M, N ∈ Z+ and f ∈ S by

kf kM,N :=

sup

|α|≤M,|β|≤N

|xαDβf (x)| .

sup
x∈Rd

We may sometimes write kxαDβf k∞ as shorthand for supx∈Rd |xαDβf (x)|. The
topology on S ′ is the weak-∗ topology, that is, the topology induced by the linear

4

NICOLAE STRUNGARU AND VENTA TERAUDS

functionals {Lf : f ∈ S } on S ′, where for ψ ∈ S ′, Lf (ψ) := ψ(f ). We are now
ready to deﬁne the notion of translation boundedness for a tempered distribution.

Deﬁnition 2.1. A tempered distribution ψ is said to be translation bounded on S
if for all f ∈ S the convolution ψ ∗ f is a bounded function.

The next result shows that, as for measures, a tempered distribution is transla-
tion bounded if and only if its convolution with every test function is uniformly
continuous and bounded.

Proposition 2.1. For a tempered distribution ψ ∈ S ′, the following are equivalent.

(i) ψ is translation bounded on S .
(ii) For all f ∈ S we have ψ ∗ f ∈ Cu(Rd).
(iii) There exist M, N ∈ Z+ and C > 0 such that for all f ∈ S

(iv) The functionals {Ttψ : t ∈ Rd} are equi-continuous on S .

kψ ∗ f k∞ ≤ Ckf kM,N .

Proof. (i) =⇒ (ii): Let ψ be translation bounded and take f ∈ S . Recall that for
any multi-index α, we have

Dα(ψ ∗ f ) = ψ ∗ Dαf .

As for each f ∈ S and multi-index α we have Dαf ∈ S , translation boundedness
provides for each f and α a constant C = Cf,α such that

kDα(ψ ∗ f )k∞ ≤ C .

This implies that all the partial derivatives of ψ ∗ f exist and are bounded, and thus
that ψ ∗ f is uniformly continuous.

(ii) =⇒ (i) and (iii) =⇒ (i) are trivial.

(ii) =⇒ (iii): We follow here the argument of [1, Thm. 1.1]. By (ii), the mapping
F (f ) = ψ ∗ f is a linear transformation from S into Cu(Rd), which (as is easy to
check) has closed graph. Therefore it is continuous. Thus there exist M, N and C
such that for all f ∈ S ,

kψ ∗ f k∞ ≤ Ckf kM,N .

(iii)⇔(iv): Using the standard boundedness condition equivalent to equi-continuity
for functionals in locally convex topological vector spaces, {Ttψ : t ∈ Rd} is equi-
continuous if and only if there exist some M, N and C such that for all t ∈ Rd and

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

5

all f ∈ S we have

|Tt(f )| ≤ Ckf kM,N .

Replacing f by f−, this becomes exactly the equivalence (iii)⇔(iv).

(cid:3)

Proposition 2.1 (iii) implies that for each ψ ∈ S ′
C such that for all f ∈ S , f 6= 0,

∞, there exist constants M, N and

kψ ∗ f k∞
kf kM,N

≤ C .

This suggests the following deﬁnition of a norm for translation bounded tempered
distributions.

Deﬁnition 2.2. For M, N ∈ Z+, we deﬁne k · kM,N : S ′ → R+ by

and

kψkM,N := sup

f ∈S ,f 6=0

kψ ∗ f k∞
kf kM,N

, ψ ∈ S ′

S ′

M,N := {ψ ∈ S ′ : kψkM,N < ∞} .

When M = N we shall simply write k · kN and S ′

N instead of k · kN,N and S ′

N,N .

The following lemma summarises the properties of k · kM,N and S ′

M,N .

Lemma 2.1.

(i) If M1 < M2 and N1 < N2 then

kψkM2,N2 ≤ kψkM1,N1

for all ψ ∈ S ′

M1,N1 ,

and

S ′

M1,N1 ⊆ S ′

M2,N2 .

(ii) If M, N ∈ Z+ and P = min{M, N}, Q = max{M, N} then

S ′

P ⊆ S ′

M,N ⊆ S ′
Q .

(iii)

S ′

∞ = [M,N ∈Z+

S ′

M,N = [N ∈Z+

S ′
N

(iv) For any M, N ∈ Z+, k · kM,N is a norm on S ′
(v) For any M, N ∈ Z+, the norm k · kM,N deﬁnes a topology stronger than the

M,N .

weak-∗ topology on S ′

M,N .

(vi) For any M, N ∈ Z+, if {ψn} is a Cauchy sequence in (S ′

M,N , k · kM,N ) then

there exists some ψ ∈ S ′

M,N such that for all f ∈ S we have

ψn ∗ f → ψ ∗ f in (Cu(Rd), k · k∞)

6

NICOLAE STRUNGARU AND VENTA TERAUDS

Proof. (i) follows from Deﬁnition 2.2 and the observation that for f ∈ S we have

kf kM1,N1 =

sup

kxαDβf k∞ ≤

sup

kxαDβf k∞ = kψkM2,N2 .

|α|≤M1,|β|≤N1

|α|≤M2,|β|≤N2

(ii) is an immediate consequence of (i).

(iii): The equality

S ′

∞ = [M,N ∈Z+

S ′

M,N

follows from Proposition 2.1. The second equality follows from (ii).

(iv): It is trivial to check that k · kM,N is a norm.

(v): This follows immediately from

|ψ(f )| ≤ kψ ∗ f−k∞ ≤ kψkM,Nkf kM,N .

(vi): Let {ψn} be a Cauchy sequence in (S ′
M,N , k · kM,N ). Then there exists a
constant C such that kψnkM,N ≤ C for all n. By (v), {ψn} is also a vague Cauchy
sequence in S ′ and thus converges vaguely to some ψ ∈ S ′.

Let f ∈ S . We show that the sequence {ψn ∗ f } converges uniformly to ψ ∗ f .
Firstly, as ψn → ψ in the weak-∗ topology, we see that {ψn ∗ f } converges pointwise
to ψ ∗ f .

Moreover, for all m, n we have

k(ψn − ψm) ∗ f k∞ ≤ kψn − ψmkM,N kf kM,N .

Then {ψn ∗ f } is a Cauchy sequence in (Cu(Rd), k · k∞) and must converge uniformly
to some g ∈ Cu(Rd). As ψn ∗ f → g uniformly it follows that ψn ∗ f → g pointwise.

We have that ψn ∗ f converges pointwisely to both g and ψ ∗ f . Thus

ψ ∗ f = g ∈ Cu(Rd) ,

that is, ψn ∗ f converges uniformly to ψ ∗ f ∈ Cu(Rd).

Finally, as for all n,

the limit ψ ∗ f must also satisfy this inequality: we have

kψn ∗ f k∞ ≤ Ckf kM,N ,

kψ ∗ f k∞ ≤ Ckf kM,N ,

and see that ψ ∈ S ′

M,N .

(cid:3)

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

7

From the lemma, we see that it is suﬃcient to consider the case M = N. Accordingly,
for the remainder of the paper we shall work with the spaces S ′
N and norms k · kN .

It is easy to ﬁnd examples of translation bounded tempered distibutions. For exam-
ple, as with measures, all compactly supported tempered distributions are transla-
tion bounded. This is a direct consequence of the following lemma.

Lemma 2.2. Let f ∈ S and φ ∈ S ′ be a distribution with compact support. Then
φ ∗ f ∈ S .

Proof. We know that φ ∗ f ∈ S ′ ∩ C ∞(Rd) [11, Thm. 4.1.1 and Thm. 7.1.15], and
that

[φ ∗ f = bφbf .

Also, we have bf ∈ S and bφ ∈ C ∞(Rd) [11, Thm. 7.1.14].
Now, since bφ ∈ C ∞(Rd) is tempered as a distribution and bf ∈ S , it follows imme-
diately that bφbf ∈ S (see for example the proof of [11, Thm. 7.1.14]). Therefore, its

inverse Fourier Transform, φ ∗ f , is also in S .

Proposition 2.2. Let φ ∈ S ′ have compact support. Then φ is translation bounded
on S .

(cid:3)

Proof. Let f ∈ S . By Lemma 2.2, φ ∗ f ∈ S and is therefore bounded.

(cid:3)

Applying Lemma 2.2 again, we see that the class of translation bounded tempered
distributions is closed under convolution with compactly supported distributions.

Proposition 2.3. Let ψ ∈ S ′
φ ∗ ψ ∈ S ′

∞.

∞ and φ be a distribution with compact support. Then

Proof. Let f ∈ S be arbitrary. Then, as φ has compact support, we have

(φ ∗ ψ) ∗ f = ψ ∗ (φ ∗ f ) ,

and by Lemma 2.2 φ ∗ f ∈ S . Therefore, as ψ is translation bounded, the function
(φ ∗ ψ) ∗ f = ψ ∗ (φ ∗ f ) is bounded. This completes the proof.
(cid:3)

The class of translation bounded tempered distributions is also closed under taking
derivatives.

Proposition 2.4. Let ψ ∈ S ′

∞. Then for any multi-index α, Dαψ ∈ S ′

∞.

8

NICOLAE STRUNGARU AND VENTA TERAUDS

Proof. Recall that for a multi-index α, Dαψ is the tempered distribution deﬁned for
f ∈ S by Dαψ(f ) := (−1)|α|ψ(Dαf ). Then for any f ∈ S , we have

kDαψ ∗ f k∞ = kψ ∗ Dαf k∞ ,

which is ﬁnite as Dαf ∈ S and ψ is translation bounded.

(cid:3)

We now examine the relationship between the two types of translation boundedness
available to a tempered measure and see that, somewhat counter-intuitively, it is
harder for a measure to be translation bounded as a measure than as a tempered
distribution.
It is well known that a translation bounded measure is tempered;
we further show that such a measure must be translation bounded as a tempered
distribution. However, there exist tempered measures that are translation bounded
as tempered distributions but not as measures.

Proposition 2.5. For a measure µ on Rd, the following are equivalent.

(i) µ is a translation bounded measure.
(ii) |µ| is a translation bounded measure.
(iii) |µ| is a tempered distribution, which is translation bounded on S .

Proof. (ii) ⇒ (i) is obvious and (i) ⇒ (ii) is standard; see for example [4, Proposition
1.12].

(iii) ⇒ (ii): For each compact K ⊆ Rd we pick some f ∈ S with f− ≥ 1K. Then,
for all t ∈ Rd we have

|µ| (t + K) ≤ |µ| (Ttf−) ≤ k|µ| ∗ f k∞ .

By assumption, |µ| ∗ f is bounded, so that {|µ| (t + K) : t ∈ Rd} is bounded and
thus µ is a translation bounded measure.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

9

(ii) ⇒ (iii): Let f ∈ S . Firstly, any translation bounded measure is a tempered
distribution [1, Thm. 7.1]. Then for all t ∈ Rd we have

||µ| ∗ f (t)| =(cid:12)(cid:12)(cid:12)(cid:12)ZRd

f (s)d |µ| (t − s)(cid:12)(cid:12)(cid:12)(cid:12)

|f (s)| d |µ| (t − s)

2 , 1

2 ]d

2 , 1

2 ]d

2 , 1

2 ]d

≤ Xn∈ZdZn+[− 1
≤ Xn∈ZdZn+[− 1
≤ Xn∈Zd
≤ Xn∈Zd

sup
s∈n+[− 1

sup
s∈n+[− 1

2 , 1

2 ]d

{|f (s)|}d |µ| (t − s)

{|f (s)|} |µ| (t − n − [−

1
2

,

1
2

]d)

{|f (s)|}! kµk[− 1

2 ]d .

2 , 1

sup
s∈n+[− 1

2 , 1

2 ]d

Now, since f is rapidly decaying,

Therefore

Xn∈Zd
k |µ| ∗ f k∞ ≤ Xn∈Zd

sup
s∈n+[− 1

2 , 1

2 ]d

{|f (s)|} < ∞ .

{|f (s)|}! kµk[− 1

2 ]d < ∞ .

2 , 1

sup
s∈n+[− 1

2 , 1

2 ]d

(cid:3)

Corollary 2.1. If µ is a translation bounded measure then µ is a tempered distri-
bution which is translation bounded on S .

Proof. Since µ is translation bounded, it is tempered as a distribution. Also for all
f ∈ S we have

|µ ∗ f (t)| ≤ |µ| ∗ |f |(t) .

To complete the proof, we repeat the computation of Proposition 2.5, (ii) ⇒ (iii)
with f replaced by |f |, and obtain

|µ| ∗ |f | (t) ≤ Xn∈Zd

sup
s∈n+[− 1

2 , 1

2 ]d

{|f (s)|}! kµk[− 1

2 ]d .

2 , 1

10

NICOLAE STRUNGARU AND VENTA TERAUDS

Exactly as in the proof of Proposition 2.5, (ii) ⇒ (iii), this implies that

kµ ∗ f k∞ ≤ ∞ .

(cid:3)

Remark 2.1. The converse of Corollary 2.1 is not true. In [1, Prop. 7.1], the authors
introduce a positive deﬁnite measure µ on R which which is a tempered distribution,
but is not translation bounded as measure. Corollary 4.2 below will show that this
measure µ is, however, translation bounded as a tempered distribution.

Directly from Corollary 2.1 and Proposition 2.4, we have the following.

Corollary 2.2. If µ is a translation bounded measure on Rd, then for any multi-
index α, Dαµ is a translation bounded tempered distribution.

Example 2.1. One can easily compute directly that ψ ∈ S ′(R) deﬁned by

ψ(f ) :=Xk∈Z

f ′(k) , f ∈ S (R) ,

is a translation bounded tempered distribution. Alternatively, by observing that
ψ = −DδZ, we may simply apply the above result.

We shall present some further examples of translation bounded tempered distribu-
tions in the subsequent sections.

3. Autocorrelation

As with translation boundedness, our deﬁnition of autocorrelation for a tempered
distribution will be based on that for measures. Recall that the autocorrelation of

g ∈ Cc(Rd),

a measure µ on Rd is deﬁned as the volume averaged convolution µ ⊛eµ, where for
Here, µR is the restriction of µ to the ball BR := BR(0), eµ(g) := µ(eg) andeg := g-.

The restriction of a measure to a set makes sense due to regularity; that is, regularity
ensures that µR(g) = µ(1BRg) is well-deﬁned for any g ∈ Cc(Rd). For an arbitrary
tempered distribution ψ and g ∈ S , however, ψ(1BRg) is not deﬁned, so to generalise
the deﬁnition of autocorrelation, we need a diﬀerent approach to restriction.

vol(BR)(µR ∗eµR)(g) .

1

(µ ⊛eµ)(g) := lim

R→∞

Deﬁnition 3.1. We say that {hR}R≥1 is a smooth approximate van Hove family if
for each R,

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

11

(i) hR ∈ D and
(ii) 1BR ≤ hR ≤ 1BR+1.

Given ψ ∈ S ′ and such a family {hR}, each tempered distribution hRψ, deﬁned for
f ∈ S by hRψ(f ) := ψ(hRf ), has support contained in BR+1 and agrees with ψ on
the set {f ∈ S : supp(f ) ⊆ BR}. Using this, we can deﬁne the autocorrelation of
a tempered distribution just as for a measure.

Deﬁnition 3.2. Given a tempered distribution ψ, we say that φ is an autocorrelation
of ψ if there exists a smooth approximate van Hove family {hR} and a positive
sequence {Rn} → ∞ such that

(1)

φ = lim
n→∞

1

vol(BRn)

(hRnψ) ∗ (]hRnψ)

in the weak-∗ topology in S ′.

It is not clear to us if every translation bounded tempered distribution possesses
an autocorrelation. We can show that any translation bounded tempered distribu-
tion would have an autocorrelation in the weak-* topology of D ′, but then the limit
would be a distribution that is not necessarily tempered, and hence we could not use
the Fourier transform. We will show later that every translation bounded measure
possesses autocorrelations in the tempered distribution sense, and that the auto-
correlations as tempered distribution and translation bounded measures coincide.
Anyhow, for tempered distributions in general the existence of an autocorrelation is
still an open problem.

We shall return to such considerations presently.
existence of an autocorrelation.

In general we shall assume the

As with measures, a tempered distribution may have many autocorrelations, each
being a cluster point when R → ∞ of the set

in S ′, for some smooth van Hove family {hR}.

vol(BR) (hRψ) ∗ (ghRψ) : R ≥ 1o
n 1

Lemma 3.1. Let ψ ∈ S ′ and let {hR} be a smooth approximate van Hove family.
Then ψ has an autocorrelation with respect to {hR} if and only if there exists some
sequence {Rn} → ∞ such that the set

is pre-compact in the weak-∗ topology.

n

1

vol(BRn ) (hRnψ) ∗ (]hRnψ) : n ∈ No

12

NICOLAE STRUNGARU AND VENTA TERAUDS

Proof. The proof is straightforward, and we will skip it.

(cid:3)

This lemma suggests the following deﬁnition.

Deﬁnition 3.3. Given a tempered distribution ψ and a smooth approximate van
Hove family {hR}, we say that {hR} is a strong smooth approximate van Hove family
for ψ if the set

is weak-∗ pre-compact in S ′.

n 1
vol(BR) (hRψ) ∗ (ghRψ) : R ≥ 1o

If a tempered distribution admits a strong smooth approximate van Hove family,
then it has an autocorrelation. We will show that the autocorrelation(s) of a tem-
pered distribution are independent of the choice of strong smooth van Hove family.
The following lemma allows us to work with functions of the form f ∗ g, f, g ∈ D.

Lemma 3.2. Let X ⊆ S ′ be weak-∗ compact, {ψn} ⊆ X and ψ ∈ S ′ be such that

for all f in a dense set D ⊆ D. Then ψ ∈ X and for all f ∈ S , we have

ψn(f ) → ψ(f )

ψn(f ) → ψ(f ) .

Proof. We ﬁrst prove that ψn(g) → ψ(g) for all g ∈ S .

Indeed, assume by contradiction that for some g ∈ S , {ψn(g)} does not converge to
ψ(g). Then we can ﬁnd an open set U ∋ ψ(g), and some increasing sequence {kn}
such that {ψkn(g)} * U. Since {ψkn} ⊆ X, which is weak-∗ compact, we can ﬁnd
a subsequence {ψln} that converges weak-∗ to some ψ′ ∈ X. In particular, {ψln(g)}
converges to ψ′(g). As {ψln(g)} * U and U is open, it follows that ψ′(g) /∈ U, so
that ψ′(g) 6= ψ(g).

Now for all f ∈ D we have

ψ(f ) = lim
n

ψn(f ) = lim
n

ψln(f ) = ψ′(f ) .

But D is dense in D and hence also in S , so as ψ, ψ′ ∈ S ′, by continuity we get
ψ = ψ′, which contradicts ψ′(g) 6= ψ(g).

This shows that ψn → ψ in the weak-* topology of S ′. By compactness of X we
also get ψ ∈ X.
(cid:3)

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

13

Lemma 3.3. Let ψ ∈ S ′ and {hR}, {h′
Then

R} be smooth approximate van Hove families.

lim

R→∞(cid:16) 1

for all f, g ∈ D.

vol(BR) (hRψ) ∗ ^(hRψ) − 1

vol(BR)(h′

Rψ) ∗ ^(h′

Rψ)(cid:17) (f ∗ g) = 0 .

Proof. Let f, g ∈ D and choose R0 > 1 large enough such that the supports of
both f and g lie within BR0. For R > R0, we have supp(Ttf ) ∩ BR+1 = ∅ for all
t 6∈ BR0+R+1 and supp(Ttf ) ⊆ BR for all t ∈ BR−R0. Hence

(hRψ − h′

Rψ) ∗ f (t) = 0

for

t /∈ BR+R0+1\BR−R0 ,

for

t /∈ BR+R0+1\BR−R0 .

Now, these functions are continuous and hence bounded on the compact set
BR+R0+1\BR−R0, and we have

and, similarly,

Rψ(cid:17) ∗ g(t) = 0

(cid:16)ghRψ − gh′
(cid:16)(hRψ ∗ ghRψ) − (h′
Rψ ∗ gh′
=(cid:16)(hRψ ∗ f ) ∗ (ghRψ − gh′

Rψ)(cid:17) ∗ (f ∗ g)
Rψ) ∗ g(cid:17) +(cid:16)(hRψ − h′

Rψ) ∗ f ∗ (gh′

Rψ ∗ g)(cid:17) .

Therefore, by the van Hove property of BR, we have for all t ∈ Rd that

1

vol(BR) (hRψ) ∗ ^(hRψ) ∗ f ∗ g(t) − 1

vol(BR) (h′

Rψ) ∗ ^(h′

Rψ) ∗ f ∗ g(t) = 0 .

lim
R

In particular (taking t = 0), we have

lim

R (cid:16) 1

vol(BR)(hRψ) ∗ ^(hRψ) − 1

vol(BR) (h′

Rψ) ∗ ^(h′

Rψ)(cid:17) (f ∗ g) = 0 .

(cid:3)

Lemma 3.4. Let {hR}, {h′
hR is strong for ψ ∈ S ′
respect to h′
choice of sequence Rn → ∞.

R} be smooth approximate van Hove families such that
∞. Then any autocorrelation φ of ψ that is calculated with
R is also an autocorrelation with respect to hR, and is given by the same

Proof. We need to show that

implies

lim
n

lim
n

1

vol(BRn )(cid:0)h′

Rnψ(cid:1) ∗ (]h′

Rnψ) = φ in S ′

1

vol(BRn ) (hRnψ) ∗ (]hRnψ) = φ in S ′ .

14

As

NICOLAE STRUNGARU AND VENTA TERAUDS

X :=n 1

vol(BR) (hRψ) ∗ (ghRψ) : R ≥ 1o
vol(BRn )(cid:0)h′

Rnψ(cid:1) ∗ (]h′

Rnψ)|n}

1

{

is weak-∗ compact in S ′, and by the existence of the limit the set

is also pre-compact, the claim follows immediately by combining Lemmas 3.2 and
3.3.
(cid:3)

Proposition 3.1. Let {hR}, {h′
for ψ. If {Rn} → ∞, then

R} be strong smooth approximate van Hove families

lim
n

1

vol(BRn)

(hRnψ) ∗ (]hRnψ) exists

if and only if

lim
n

and in this case they are the same.

1

vol(BRn)(cid:0)h′

Rnψ(cid:1) ∗ (]h′

Rnψ) exists ,

Proof. The claim follows immediately by applying Lemma 3.4 twice.

(cid:3)

The previous result shows us that whenever when we deal with strong smooth ap-
proximate van Hove families, the autocorrelation is independent of this choice.

If a tempered distribution does not admit an autocorrelation, it cannot have a
strong smooth approximate van Hove sequence. It is presently unclear to us if the
converse is true, and we do not have a nice characterisation of the distributions that
admit strong smooth approximate van Hove families. However, we will show that
for translation bounded measures, all smooth approximate van Hove families are
strong, and the autocorrelations that they give rise to correspond to those arising
from the standard deﬁnition for measures.

For the rest of the paper all the smooth approximate van Hove families will be
assumed to be strong. This allows us to use the following convention: whenever
ψ ∈ S ′

∞ and {hR} is a smooth van Hove family, we deﬁne

for simplicity.

ψR := hRψ

Proposition 3.2. Let µ ∈ M∞(Rd) and {hR} be a smooth approximate van Hove
family. Then {hR} is strong for µ.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

15

Proof. Let f ∈ S . Without loss of generality we can assume that f ≥ 0, otherwise
we can replace f by g ∈ S such that g ≥ |f |.

As µ is translation bounded, |µ| is translation bounded as a tempered distribution
by Proposition 2.5 and thus there exist some M, N and C such that

k|µ| ∗ f k∞ ≤ Ckf kM,N .

Then we have

k

1

vol(BR) (hRµ) ∗ (ghRµ) ∗ f k∞

= 1

= 1

vol(BR) sup

≤ 1

vol(BR) sup

|(hRµ) ∗ f | (x − t) d ]|hRµ|(t)

vol(BR)k(ghRµ) ∗(cid:0)(hRµ) ∗ f(cid:1)k∞
x∈Rd(cid:12)(cid:12)(cid:12)(cid:12)ZRd(cid:0)(hRµ) ∗ f(cid:1)(x − t)dghRµ(t)(cid:12)(cid:12)(cid:12)(cid:12)
x∈RdZRd
x∈RdZRd
x∈RdZRd
x∈RdZRd

|hRµ| ∗ f (x − t)d ]|hRµ|(t)

|µ| ∗ f (x − t) d ]|hRµ|(t)

Ckf kM,N d ]|hRµ|(t)

vol(BR) sup

≤ 1

vol(BR) sup

≤ 1

vol(BR) sup

≤ 1

= 1

vol(BR)Ckf kM,N ]|hRµ|(Rd)

≤ 1

vol(BR)Ckf kM,Nf|µ|(BR+1) .

Now, a simple computation shows that for any translation bounded measure there
exists a constant C0 such that for all R > 1 we have

1

vol(BR)

|µ| (BR+1) ≤ C0 .

Therefore, for each f ∈ S we have for all R > 1 that

and thus the set

≤ C0Ckf kM,N

(cid:13)(cid:13)(cid:13)

1

vol(BR) (hRµ) ∗ (ghRµ) ∗ f(cid:13)(cid:13)(cid:13)∞
n 1
vol(BR) (hRµ) ∗ (ghRµ) : R ≥ 1o

is weak-∗ precompact, as required.

(cid:3)

16

NICOLAE STRUNGARU AND VENTA TERAUDS

Next, we show that derivatives of translation bounded measures also admit strong
smooth van Hove sequences.

Proposition 3.3. Let {hR} be a smooth approximate van Hove family and let κ ∈
Zd

+. If there exists a constant C such that for all α ≤ κ and all R ≥ 1 we have

kDαhRk∞ < C ,

then for each µ ∈ M∞(Rd), the family {hR} is strong for the tempered distribution
Dκµ.

Proof. In this proof we will use the notation

0 := (0, 0, 0, ..., 0) and 2 := (2, 2, 2, ..., 2) ∈ Zd

in order to diﬀerentiate between these vectors and the numbers 0, 2 ∈ Z. We begin
by noting that since hR ≡ 1 on BR and hR ≡ 0 outside BR+1 we have for all non-zero
α ∈ Zd
+

DαhR(x) = 0 for all x /∈ BR+1\BR .

Moreover, for α = 0 ∈ Zd

+ we have kDαhRk∞ = 1 for all R.

Now let µ ∈ M∞(Rd) and f ∈ S . Since ^hRDM µ is a distribution with compact
support and f ∈ S , by Lemma 2.2 we have

Then for all x ∈ Rd,

g :=(cid:0) ^hRDκµ(cid:1) ∗ f ∈ S .

(cid:12)(cid:12)(cid:12)

1

vol(BR) (hRDκµ) ∗ g(x)(cid:12)(cid:12)(cid:12) = 1

= 1

vol(BR) |hhRDκµ, Txg−i|
vol(BR) |hDκµ, hRTxg−i|

= 1

= 1

vol(BR)(cid:12)(cid:12)hµ, Dκ(cid:0)hRTxg−(cid:1)i(cid:12)(cid:12)
Dκ(cid:0)hRTxg−(cid:1)(t)dµ(t)(cid:12)(cid:12)(cid:12)(cid:12) .
vol(BR)(cid:12)(cid:12)(cid:12)(cid:12)ZRd
β(cid:19)(cid:0)DβhR(cid:1)(cid:0)Dκ−βTxg−(cid:1)(t) .
Dκ(cid:0)hRTxg−(cid:1)(t) =Xβ≤κ(cid:18)κ

Now, by the multivariate Leibnitz product rule we have

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

17

Since for all β 6= 0 we have DβhR ≡ 0 outside BR+1\BR, we also have

Dβ(cid:0)hR Txg−(cid:1)(t)dµ(t)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ZRd

1

(cid:12)(cid:12)(cid:12)

+ 1

≤ 1

Dβ(cid:0)hR Txg−(cid:1)(t)dµ(t)

Dκ(cid:0)hRTxg−(cid:1)(t)dµ(t) = X0<β≤κ(cid:18)κ

β(cid:19)ZBR+1\BR
+ZRd
hR(cid:0)DκTxg−(cid:1)(t)dµ(t) .
β(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
vol(BR) X0<β≤κ(cid:18)κ
ZBR+1\BR
vol(BR) (hRDκµ) ∗ g(x)(cid:12)(cid:12)(cid:12) ≤ 1
vol(BR)(cid:12)(cid:12)(cid:12)(cid:12)ZRd
hR(cid:0)DκTxg−(cid:1)(t)dµ(t)(cid:12)(cid:12)(cid:12)(cid:12)
α(cid:19)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
(DαhR)(cid:0)Dβ−αTxg−(cid:1)(t)dµ(t)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
β(cid:19)Xα≤β(cid:18)β
vol(BR) X0<β≤κ(cid:18)κ
ZBR+1\BR
vol(BR)ZBR+1
α(cid:19)CZBR+1\BR(cid:12)(cid:12)Dβ−αTxg−(cid:12)(cid:12) (t)d|µ|(t)
β(cid:19)(cid:18)β
vol(BR) X0<β≤κXα≤β(cid:18)κ
vol(BR)ZBR+1
vol(BR)ZBR+1
γ≤κZBR+1\BR
α(cid:19)(cid:1)
β(cid:19)(cid:18)β
C1 := C ·(cid:0) X0<β≤κXα≤β(cid:18)κ

|DγTxg−(t)| d|µ|(t) + 1

|DκTxg−(t)| d|µ|(t)

+ 1

|DκTxg−(t)| d|µ|(t)

≤ C1

vol(BR) sup

Therefore we get

(2)

+ 1

≤ 1

where

|DκTxg−(t)| d|µ|(t) .

is a constant which only depends on C and κ.

To complete the proof we will show that there exists a constant C4 which depends
only on κ and µ, but it is independent of R and f , such that for all γ ≤ κ we have

kDγgk∞ < C4kf k2d,2|κ| .

Let us emphasize here that while g ∈ S , g depends on R so should be seen as a
family of functions, not a single function.

18

NICOLAE STRUNGARU AND VENTA TERAUDS

Now, for all γ ≤ κ we have

|Dγg(t)| =(cid:12)(cid:12)(cid:12)Dγ(cid:0) ^hRDκµ(cid:1) ∗ f(cid:12)(cid:12)(cid:12) (t)
=(cid:12)(cid:12)(cid:12)(cid:0) ^hRDκµ(cid:1) ∗ Dγf(cid:12)(cid:12)(cid:12) (t)
=(cid:12)(cid:12)(cid:12)h ^hRDκµ, Tt(Dγf )−i(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)hhRDκµ, T−t(Dγf )i(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)hDκµ, hRT−t(Dγf )i(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)hµ, DκhRT−t(Dγf )i(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
β(cid:19)(DβhR)T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
hµ,Xβ≤κ(cid:18)κ
β(cid:19)(cid:12)(cid:12)(cid:12)hµ, (DβhR)T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12)
≤Xβ≤κ(cid:18)κ
=(cid:12)(cid:12)(cid:12)hµ, hRT−t(Dκ+γf )i(cid:12)(cid:12)(cid:12) + X0<β≤κ(cid:18)κ
=(cid:12)(cid:12)(cid:12)hhRµ, T−t(Dκ+γf )i(cid:12)(cid:12)(cid:12) + X0<β≤κ(cid:18)κ
(cid:12)(cid:12)(cid:12)hhRµ, T−t(Dκ+γf )i(cid:12)(cid:12)(cid:12) ≤ Xn∈Zd
≤ Xn∈Zd
(cid:12)(cid:12)(cid:12)h(DβhR)µ, T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12) ≤ Xn∈Zd
≤ Xn∈Zd

sup
s∈n+[− 1

sup
s∈n+[− 1

sup
s∈n+[− 1

sup
s∈n+[− 1

2 , 1

2 , 1

2 , 1

2 , 1

2 ]d

2 ]d

Next, exactly as in the proof of Proposition 2.5 we get

β(cid:19)(cid:12)(cid:12)(cid:12)hµ, (DβhR)T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12)
β(cid:19)(cid:12)(cid:12)(cid:12)h(DβhR)µ, T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12) .
{(cid:12)(cid:12)Dκ+γf (s)(cid:12)(cid:12)}! khRµk[− 1
{(cid:12)(cid:12)Dκ+γf (s)(cid:12)(cid:12)}! kµk[− 1
{(cid:12)(cid:12)(Dκ−β+γf )(s)(cid:12)(cid:12)}! k(DβhR)µk[− 1
{(cid:12)(cid:12)(Dκ−β+γf )(s)(cid:12)(cid:12)}! C · kµk[− 1

2 ]d ,

2 , 1

2 , 1

2 , 1

2 ]d

2 ]d

2 ]d

2 ]d .

2 , 1

2 ]d

and similarly, using also that |(DβhR)µ| ≤ C|µ|, we get

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

19

Finally, using the convergence of the series

Xn∈Zd\0

we get

sup
s∈n+[− 1

2 , 1

2 ]d

{

1
s2 } ,

1

2 ]d

2 ]d

2 , 1

2 , 1

2 , 1

s∈[− 1

sup
s∈n+[− 1

sup
s∈n+[− 1

Xn∈Zd
{(cid:12)(cid:12)(Dκ−β+γf )(s)(cid:12)(cid:12)} = sup
{(cid:12)(cid:12)(cid:12)(cid:12)
s2(cid:0)s2(Dκ−β+γf(cid:1)(s)(cid:12)(cid:12)(cid:12)(cid:12)}
+ Xn∈Zd\0
{(cid:12)(cid:12)(cid:12)(cid:12)
≤ kf k0,|κ−β+γ| + Xn∈Zd\0
C3 = 1 + Xn∈Zd\0

sup
s∈n+[− 1

sup
s∈n+[− 1

2 , 1

2 ]d

where

{(cid:12)(cid:12)(Dκ−β+γf )(s)(cid:12)(cid:12)}

2 ]d

1

s2(cid:12)(cid:12)(cid:12)(cid:12) kf k2d,|κ−β+γ|} ≤ C3kf k2d,2|κ| ,

{

1
s2 } .

2 , 1

2 ]d

Combining, we get

|Dγg(t)| =(cid:12)(cid:12)(cid:12)Dγ(cid:0) ^hRDκµ(cid:1) ∗ f(cid:12)(cid:12)(cid:12) (t)

≤(cid:12)(cid:12)(cid:12)hhRµ, T−t(Dκ+γf )i(cid:12)(cid:12)(cid:12) + X0<β≤κ(cid:18)κ
2 ]d + X0<β≤κ(cid:18)κ

≤ C3kf k2d,2|κ|kµk[− 1

2 , 1

β(cid:19)(cid:12)(cid:12)(cid:12)h(DβhR)µ, T−t(Dκ−β+γf )i(cid:12)(cid:12)(cid:12)
β(cid:19)C3kf k2d,2|κ|Ckµk[− 1

2 , 1

2 ]d

= C4kf k2d,2|κ| .

Thus by (2), we have

1

(cid:12)(cid:12)(cid:12)

vol(BR) (hRDκµ) ∗ ^hRDκµ ∗ f (x)(cid:12)(cid:12)(cid:12)

vol(BR) C4kf k2d,2|κ| |µ| (BR+1\BR) + 1

≤ C1

vol(BR)C4kf k2d,2|κ| |µ| (BR+1) .

By translation boundedness of µ the sets

and

{

1

vol(BR) |µ| (BR+1\BR) | R ≥ 1}

{

1

vol(BR) |µ| (BR+1) | R ≥ 1}

20

NICOLAE STRUNGARU AND VENTA TERAUDS

are bounded. Therefore, there exists a constant C5, which depends only on κ and
µ, such that, for all R ≥ 1 and all f ∈ S we have

k

1

vol(BR) (hRDκµ) ∗ ^hRDκµ ∗ f k ≤ C5kf k2d,2|κ| .

This completes the proof.

(cid:3)

By the observations at the start of the proof, we see that the boundedness con-
dition in the statement Proposition 3.3 is needed only for the coronas BR+1\BR.
The existence of such van Hove families is easy to prove. Therefore, all deriva-
tives of translation bounded measures admit strong smooth approximate van Hove
sequences.

We complete the section by showing that for a translation bounded measure µ, the
autocorrelations calculated for the tempered distribution µ coincide with those for
the measure µ.

Proposition 3.4. Let µ ∈ M∞(Rd), let {hR} be a smooth approximate van Hove
family, and let φ be an autocorrelation of µ calculated for µ as a tempered distribution
with respect to the sequence {Rn}. Then the measure autocorrelation

exists and

γ = lim
n

1

vol(BRn ) (µRn) ∗ (gµRn)

γ = φ .

In particular, φ is a translation bounded measure.

Proof. Exactly as in the proof of Lemma 3.3, we can prove that

(3)

lim
n→∞

1

vol(BRn)(cid:0)(hRnµ) ∗ (ghRnµ) − (µRn) ∗ (gµRn)(cid:1)(f ∗ g) = 0 .

for all f, g ∈ D. As µ is a translation bounded measure, the sequence

1

is precompact in the vague topology and thus has a cluster point. We show that the
sequence is convergent by showing that the cluster point is unique.

n
Let γ1, γ2 be two cluster points ofn

vol(BRn ) (µRn) ∗ (gµRn)o
vol(BRn ) (µRn) ∗ (gµRn)o. By using (3) on the two

subsequences which give γ1 and γ2, we get

1

γ1(f ∗ g) = φ(f ∗ g) = γ2(f ∗ g) ,

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

21

for all f, g ∈ D. As the set {f ∗ g : f, g ∈ D} is dense in Cc(Rd), this shows that
γ1 = γ2. Thus there exists a measure γ ∈ M∞(Rd) such that

in the vague topology of measures. Using again (3), we get for all f, g ∈ D that

γ = lim
n

1

vol(BRn ) (µRn) ∗ (gµRn) ,

φ(f ∗ g) = γ(f ∗ g) .

As γ is also a tempered distribution, and {f ∗ g : f, g ∈ D} is dense in S , we see
that γ = φ as tempered distributions. This completes the proof.
(cid:3)

4. Positive definite tempered distributions

In this section we prove some basic results about positive deﬁnite tempered distri-
butions. As any autocorrelation of a tempered distribution is positive deﬁnite by
construction, the results of this section are important to the study of diﬀraction of
tempered distributions. We begin with a pretty standard result (see, for example,
[16, Theorem 7.19]).

Lemma 4.1. Let ψ ∈ S ′ and f ∈ S . Then the function ψ ∗ f has (at most)

is bounded and uniformly continuous.

polynomial growth, that is, ψ ∗ f ∈ S ′, and [ψ ∗ f = bψbf .
Proposition 4.1. Let ψ ∈ S ′ such that bψ is a measure and let f ∈ S . Then ψ ∗ f
Proof. As bf ∈ S and bψ is a tempered measure, bψbf is also a tempered measure. But
which is ﬁnite, so bψbf is a ﬁnite measure and thus, as the Fourier transform of a ﬁnite

measure, ψ ∗ f is uniformly continuous and bounded. In particular, for all x ∈ Rd,

(cid:12)(cid:12)(cid:12)bψbf (Rd)(cid:12)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12)(cid:12)ZRd bf (x) dbψ(x)(cid:12)(cid:12)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12)bψ(bf )(cid:12)(cid:12)(cid:12) ,
|ψ ∗ f (x)| =(cid:12)(cid:12)(cid:12)(bψ · bf )∨(x)(cid:12)(cid:12)(cid:12)
χ(x)bf (χ) dbψ(χ)(cid:12)(cid:12)(cid:12)(cid:12)
=(cid:12)(cid:12)(cid:12)(cid:12)ZcRd
≤ZcRd(cid:12)(cid:12)(cid:12)bf (χ)(cid:12)(cid:12)(cid:12) d|bψ|(χ) ,
kψ ∗ f k∞ ≤Z cRd(cid:12)(cid:12)(cid:12)bf (χ)(cid:12)(cid:12)(cid:12) d|bψ|(χ) = |bψ|(|bf|) .

so that

(cid:3)

22

NICOLAE STRUNGARU AND VENTA TERAUDS

Corollary 4.1. Let ψ ∈ S ′ such that bψ is a measure. Then ψ is translation bounded

on S .

Another way to state this is that the Fourier transform of any tempered measure is
a tempered distribution that’s translation bounded on S . This is another fruitful
source of examples of translation bounded tempered distributions. The following
example ﬁrst appeared in [18].

Example 4.1. Let

δ2.4nZ ∗ (δ4n−1 + δ1−4n) .

ω := δ2Z +Xn≥1

+Xn≥1

bω = 1

One may easily verify that ω is a translation bounded measure, and thus tempered.
The Fourier transform of ω has formal expression

2δ Z

2

cos(2π(4n − 1)(·))

4n

δ Z
2.4n ,

and is a non-measure tempered distribution. By Corollary 4.1, it is translation
bounded.

Example 4.2. The tempered distribution ψ = −DδZ of Example 2.1 has Fourier
transform

\−DδZ = 2πi id δZ ,

where id is the identity function on R, id(x) = x. That is, ψ is the Fourier transform
of a tempered (not translation bounded) measure.

Recall that, from the Bochner Schwartz theorem, the Fourier transform of a pos-
itive deﬁnite tempered distribution is a tempered measure. Then the following is
immediate from Corollary 4.1.

Corollary 4.2. Let ψ ∈ S ′ be positive deﬁnite. Then ψ is translation bounded on
S .

To conclude this section, we further examine the connection between positive deﬁnite
tempered distributions and those whose Fourier transform is a measure.

Proposition 4.2. Let ψ ∈ S ′.

i) If ψ is a linear combination of 4 positive deﬁnite tempered distributions, then

bψ is a tempered measure.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

23

ii) If bψ is a translation bounded measure, then ψ is a linear combination of 4

positive deﬁnite tempered distributions.

Proof. (i) is clear.

(ii) Let f ∈ S . As bψ is a translation bounded measure, we can take its canonical

decomposition

.

bψ =(cid:16)bψ(cid:17)+

−(cid:16)bψ(cid:17)−

+ i(cid:16)bψ(cid:17)i+

− i(cid:16)bψ(cid:17)i−

Then each of the four measures is a positive translation bounded measure, hence a
positive tempered measure. Taking the inverse Fourier transform of both sides, we
have the result.
(cid:3)

Remark 4.1. In [9, Prop. 7.1], the authors introduce a tempered measure µ such
that the measure |µ| is not tempered.

Note that in this case, if we take ψ = ˇµ, the distribution ψ is tempered and has
measure Fourier transform, but it cannot be a linear combination of ﬁnitely many
positive deﬁnite tempered distributions.

Indeed if we would have

ψ =

with ψi positive deﬁnite, then

cibψi ,
where each bψi is a positive tempered measure. Then
|ci|bψi

µ = bψ =
NXi=1

and as the RHS is tempered so must be the LHS too.

|µ| ≤

ciψi ,

NXi=1
NXi=1

In summary, we have

{ψ ∈ S ′ : bψ is a translation bounded measure}

( span{ψ ∈ S ′ : ψ is positive deﬁnite}

( {ψ ∈ S ′ : bψ is a tempered measure} .

24

NICOLAE STRUNGARU AND VENTA TERAUDS

5. Almost periodic Distributions

It is well known [5] that the Fourier transform of a ﬁnite measure µ is a weakly
almost periodic function f and that, under the Fourier transform, the Lebesgue
decomposition of µ into its pure point and continuous parts corresponds to the
Eberlein decomposition of the weakly almost periodic function f [6].

Based on the above results, Argabright and deLamadrid extended the notion of
almost periodicity from functions to measures via convolution, and showed that the
correspondence of the respective decompositions under the Fourier transform can
be extended to translation bounded Fourier transformable measures [9].

We shall show that the same approach also works for tempered distributions. In
this section we deﬁne the Eberlein decomposition for tempered distributions and in
the next section, we prove the equivalence of the decompositions under the Fourier
transform. As usual, we denote the spaces of weakly almost periodic, strongly
almost periodic and null weakly almost periodic functions by W AP (Rd), SAP (Rd)
and W AP0(Rd) respectively. For the deﬁnitions of these spaces and a review of the
existing theory in the setting of measures, we refer the reader to [15].

Deﬁnition 5.1. A tempered distribution ψ is called respectively weakly, strongly
or null weakly almost periodic if and only if for all f ∈ S (Rd) the function ψ ∗ f is
respectively weakly, strongly or null weakly almost periodic. We shall denote the cor-
responding spaces of tempered distributions by WAP(Rd), SAP(Rd) and WAP0(Rd)
respectively.

Remark 5.1. As almost periodic functions must be uniformly continuous and
bounded, it is implicitly assumed in the deﬁnition that ψ ∗ f ∈ Cu(Rd) for all
f ∈ S (Rd). Therefore WAP(Rd), SAP(Rd) and WAP0(Rd) are subspaces of S ′
∞(Rd).

Remark 5.2. In [8], Lagarias introduced a notion of uniformly almost periodic
distributions which is similar to our deﬁnition, but uses D as the space of test
functions instead of S . All of the results we prove about translation boundedness
and Eberlein convolution can be shown with either D or S as test functions. We
will show next in Lemma 5.2 that for translation bounded tempered distributions
the two deﬁnitions are equivalent.

Let us recall that if f, g ∈ S then f ∗ g ∈ S . This allows us look at convolutions
of the form

ψ ∗ (f ∗ g) ; ψ ∈ S ′, f, g ∈ S .

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

25

Recall from the previous section that for ψ ∈ S ′, f ∈ S , we have ψ ∗ f ∈ S ′.
Further, we have the following (see for example [16, Theorem 7.19]).

Lemma 5.1. Let ψ ∈ S ′ and f, g ∈ S . Then (ψ ∗ f ) ∗ g and ψ ∗ (f ∗ g) are well
deﬁned and

(ψ ∗ f ) ∗ g = ψ ∗ (f ∗ g) .

Lemma 5.2. Let ψ ∈ S ′. Then

i) ψ ∈ WAP(Rd) if and only if ψ ∈ S ′

∞(Rd) and for all f ∈ D we have

ψ ∗ f ∈ W AP (Rd).

ii) ψ ∈ SAP if and only if ψ ∈ S ′

∞(Rd) and for all f ∈ D we have ψ ∗ f ∈

SAP (Rd).

iii) ψ ∈ WAP0 if and only if ψ ∈ S ′

∞(Rd) and for all f ∈ D we have ψ ∗ f ∈

W AP0(Rd).

Proof. We prove (i), the other two are identical.

The forward implication is obvious as WAP ⊂ S ′

∞(Rd) and D ⊂ S .

For the reverse implication, let f ∈ S . By translation boundedness we know that
ψ ∗ f ∈ Cu(Rd). Now, let gα ∈ D be an approximate identity for (Cu(Rd), ∗).
Then we have ψ ∗ gα ∈ W AP (Rd) and hence, as f ∈ L1(Rd) we also have [9]
(ψ ∗ gα) ∗ f ∈ W AP (Rd). By Lemma 5.1 we thus have

(ψ ∗ f ) ∗ gα = (ψ ∗ gα) ∗ f ∈ W AP (Rd) .

As (ψ ∗ f ) ∗ gα converges uniformly to ψ ∗ f and W AP (Rd) is closed in Cu(Rd), we
get ψ ∗ f ∈ W AP (Rd)
(cid:3)

We now show that every tempered distribution with measure Fourier transform is
weakly almost periodic. This class will thus always contain the subclass of positive
deﬁnite tempered distributions, and hence all of our autocorrelations.

Proof. Let f ∈ S . Then, by Proposition 4.1, the function ψ ∗ f is the inverse

Theorem 5.1. Let ψ ∈ S ′. If bψ is a measure, then ψ ∈ WAP(Rd).
Fourier transform of the ﬁnite measure bfbψ. The claim now follows from the fact

that the Fourier transform of a ﬁnite measure is a weakly almost periodic function
(see [6]).
(cid:3)

Corollary 5.1. Let ψ ∈ S ′(Rd) be positive deﬁnite. Then ψ ∈ WAP(Rd).

26

NICOLAE STRUNGARU AND VENTA TERAUDS

We are now ready to construct the Eberlein decomposition for the space of weakly
almost periodic distributions.

Theorem 5.2.

For ψ ∈ WAP(Rd), we will denote this decomposition by

WAP(Rd) = SAP(Rd)M WAP0(Rd) .

Moreover, for all f ∈ S we have

ψ = ψs + ψ0 .

(ψ ∗ f )s = ψs ∗ f ; (ψ ∗ f )0 = ψ0 ∗ f .

Proof. For ψ ∈ WAP(Rd) and f ∈ S , the function ψ ∗ (f-) ∈ W AP (Rd) and we
may decompose ψ ∗ (f-) into the functions (ψ ∗ (f-))s ∈ SAP (Rd) and (ψ ∗ (f-))0 ∈
W AP0(Rd).

Therefore, for ﬁxed ψ ∈ WAP(Rd), the following functions are continuous:

and

S (Rd) → W AP (Rd) → SAP (Rd) → C

f 7→ ψ ∗ (f-) 7→ (ψ ∗ (f-))s 7→ (ψ ∗ (f-))s (0)

S (Rd) → W AP (Rd) → W AP0(Rd) → C

f 7→ ψ ∗ (f-) 7→ (ψ ∗ (f-))0 7→ (ψ ∗ (f-))0 (0) .

Therefore, we can deﬁne continuous mappings S, T : S (Rd) → C via

and

T (f ) = (ψ ∗ (f-))s (0)

S(f ) = (ψ ∗ (f-))0 (0) .

These mappings deﬁne two tempered distributions ψs and ψ0. It follows immediately
from the construction that

and that for all f ∈ S ,

ψ = ψs + ψ0

(ψ ∗ f )s = (ψ)s ∗ f ; (ψ ∗ f )0 = (ψ)0 ∗ f .

To complete the proof, we need to show the uniqueness of the decomposition. For
this it suﬃces to prove that

This follows immediately from the fact that SAP (Rd) ∩ W AP0(Rd) = {0} (see [7]).

SAP(Rd) ∩ WAP0(Rd) = {0} .

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

27

If ψ ∈ SAP(Rd) ∩ WAP0(Rd), then for all f ∈ S we have ψ ∗ f ∈ SAP (Rd) ∩
W AP0(Rd) and therefore ψ ∗ f = 0. In particular ψ(f-) = 0 for all f ∈ S .
(cid:3)

Proposition 5.1. Let ψ, ϕ ∈ S ′ be such that ϕ has compact support.

(i) If ψ ∈ WAP(Rd) then ψ ∗ ϕ ∈ WAP(Rd).
(ii) If ψ ∈ SAP(Rd) then ψ ∗ ϕ ∈ SAP(Rd).
(iii) If ψ ∈ WAP0(Rd) then ψ ∗ ϕ ∈ WAP0(Rd).

Proof. The claim follows immediately from the observation that for f ∈ S , ϕ ∈ S ′
with compact support, we have by Lemma 2.2 that ϕ ∗ f ∈ S and

(ψ ∗ ϕ) ∗ f = ψ ∗ (ϕ ∗ f ) .

(cid:3)

Example 5.1. Let α be a multi-index on Rd and consider the tempered distribution

ψ := Xx∈Zd

Dαδz = DαδZd = Dαδ0 ∗ δZd .

As Dαδ0 has compact support and δZd ∈ SAP(Rd), we see that ψ ∈ SAP(Rd).

Corollary 5.2. Let α be a multi-index on Rd.

(i) If ψ ∈ WAP(Rd) then Dαψ ∈ WAP(Rd).
(ii) If ψ ∈ SAP(Rd) then Dαψ ∈ SAP(Rd).
(iii) If ψ ∈ WAP0(Rd) then Dαψ ∈ WAP0(Rd).

We complete the section by proving that for translation bounded measures the
notions of almost periodicity as measures and tempered distributions coincide.

Theorem 5.3. Let µ ∈ M(Rd). Then

(i) µ ∈ WAP(Rd) ⇔ µ ∈ WAP(Rd).
(ii) µ ∈ SAP(Rd) ⇔ µ ∈ SAP(Rd).
(iii) µ ∈ WAP0(Rd) ⇔ µ ∈ WAP 0(Rd).

Proof. The proof follows immediately from the density of D in both Cc(Rd) and
S . Since the measure µ is translation bounded, it is also translation bounded as a
tempered distribution and we have

µ ∗ f ∈ Cu(Rd) for all f ∈ Cc(Rd) ∪ S .

28

NICOLAE STRUNGARU AND VENTA TERAUDS

We now prove (i). The other two results can be shown identically. We start by
picking some {gα} ⊆ D which is an approximate identity for (Cu(Rd), ∗).

(⇒) Let f ∈ S . As f ∈ L1(Rd) we have µ ∗ f ∈ WAP(Rd) [9, Cor. 5.1]. Moreover,
as µ ∗ f ∈ Cu(Rd) we get µ ∗ f ∈ WAP(Rd) ∩ Cu(Rd) = W AP (Rd) [9, Cor. 5.2].
This proves the claim.

(⇐) Let f ∈ Cc(Rd). As gα ∗ µ ∈ W AP (R) and f ∈ Cc(Rd) we have, for all α, that

(gα ∗ µ) ∗ f ∈ W AP (Rd)

Therefore gα ∗ (µ ∗ f ) ∈ W AP (Rd). We know that µ ∗ f ∈ Cu(Rd). Therefore
{gα ∗ (µ ∗ f )} converges uniformly to µ ∗ f . As gα ∗ (µ ∗ f ) ∈ W AP (Rd), and
W AP (Rd) is closed in Cu(Rd), it follows that µ ∗ f ∈ W AP (Rd).
(cid:3)

6. Tempered distributions with measure Fourier transform

To consider the diﬀraction of a tempered distribution, we take, as usual, the Fourier
transform of the autocorrelation. As we have stated, if the autocorrelation exists,
it is a positive deﬁnite tempered distribution, and thus its Fourier transform is a
positive measure (the diﬀraction measure).

Our primary goal is to relate the Lebesgue decomposition of the diﬀraction measure
to the Eberlein decomposition of the autocorrelation, and we do this in this section.
In fact, the positivity of the diﬀraction measure plays no role in our proofs. Thus
we here consider the larger class of tempered distributions whose Fourier transform
is a measure.

Deﬁnition 6.1. We deﬁne S cM to be the space of tempered distributions whose
Fourier Transform is a measure, that is:

S cM := {ψ ∈ S ′ : bψ is a measure } .

Remark 6.1.

(i) Any positive deﬁnite tempered distribution is in S cM. The
connection between positive deﬁniteness and the space S cM is explained by
Proposition 4.2 or by the Bochner Schwartz theorem.

(ii) By Theorem 5.1 we have

S cM ⊆ WAP(Rd) .

As is the case for measures, the discrete and continuous parts of the Fourier trans-
form of a positive deﬁnite distribution are exactly the Fourier transforms of the
strongly and null weakly almost periodic parts of the distribution respectively.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

29

Theorem 6.1. Let ψ ∈ S cM. Then

(cid:16)bψ(cid:17)pp

= bψs and (cid:16)bψ(cid:17)c

=cψ0 .

Proof. Let f ∈ S . Then, by Proposition 4.1, bψbf is a ﬁnite measure whose inverse
Fourier transform is f ∗ ψ. Accordingly, the pure point and continuous parts of bψbf ,
(cid:16)bfbψ(cid:17)pp
of (cid:16)bfbψ(cid:17)pp

and(cid:16)bfbψ(cid:17)c
and (cid:16)bfbψ(cid:17)c

, are ﬁnite measures. Then by [6], the inverse Fourier transforms

are respectively strongly and null weakly almost periodic

functions.

As

by the uniqueness of the Eberlein decomposition and Theorem 5.2 we must have

This proves the claim.

(cid:3)

Theorem 6.1 can be used to obtain a simple characterisation of tempered distribu-
tions with a pure point measure as a Fourier transform. While the characterisation
is via test functions in S , we can easily extend this to D and obtain a condition
which is easier to test.

Proposition 6.1. Let ψ ∈ S cM. Then the following are equivalent:

(i) bψ is a discrete measure.

(ii) ψ ∈ SAP(Rd).
(iii) ψ ∗ f ∈ SAP (Rd) for all f ∈ D.

(4)

Therefore, as(cid:16)bfbψ(cid:17)pp

forms we get

= (f ∗ ψ)s = f ∗ (ψs) ;

= (f ∗ ψ)0 = f ∗ (ψ0) .

+h(cid:16)bfbψ(cid:17)ci∨

,

f ∗ ψ =(cid:20)(cid:16)bfbψ(cid:17)pp(cid:21)∨
(cid:20)(cid:16)bfbψ(cid:17)pp(cid:21)∨
h(cid:16)bfbψ(cid:17)ci∨
= bf(cid:16)bψpp(cid:17) and(cid:16)bfbψ(cid:17)c
bf(cid:16)bψpp(cid:17) = \f ∗ (ψs) = bfbψs ;
bf(cid:16)bψc(cid:17) = \f ∗ (ψ0) = bfcψ0 .

= bf(cid:16)bψc(cid:17), by taking the Fourier trans-

30

NICOLAE STRUNGARU AND VENTA TERAUDS

(iv) ψ ∗ f ∗ g ∈ SAP (Rd) for all f, g ∈ D.

(v) ψ ∗ f ∗ ef ∈ SAP (Rd) for all f ∈ D.

Proof. (i) ⇔ (ii) follows immediately from Theorem 6.1 and the uniqueness of the
Eberlein decomposition of Theorem 5.2.

(ii) ⇒ (iii) is obvious as D ⊆ S .

(iii) ⇒ (iv) ⇒ (v) are obvious.

2

As for each R > 0 we can ﬁnd some f ∈ D which is non-vanishing on BR(0), it

bψ is a pure point measure.

(v) ⇒ (i) : Let f ∈ D. Since bψ is a tempered measure, it follows that(cid:12)(cid:12)(cid:12)bf(cid:12)(cid:12)(cid:12)
bψ is a
ﬁnite measure. As the Fourier transform of this measure is (ψ ∗ f ∗ef )− ∈ SAP (Rd),
it follows [6] that(cid:12)(cid:12)(cid:12)bf(cid:12)(cid:12)(cid:12)
follows that the restriction of bψ to BR(0) is pure point for each R > 0. This implies
that bψ is pure point.
describing the pure point measure bψ.

Note that in the situation of Proposition 6.1, Theorem 7.2 will give us a way of

2

(cid:3)

In exactly the same way, we can prove the following.

Proposition 6.2. Let ψ ∈ S cM. Then the following are equivalent:

(ii) ψ ∈ WAP0(Rd).
(iii) ψ ∗ f ∈ W AP0(Rd) for all f ∈ D.
(iv) ψ ∗ f ∗ g ∈ W AP0(Rd) for all f, g ∈ D.

(i) bψ is a continuous measure.
(v) ψ ∗ f ∗ ef ∈ W AP0(Rd) for all f ∈ D.

As the proof is almost identical to the one of Proposition 6.1, we omit it.

7. The mean of a weakly almost periodic distribution

Fourier analysis is a very powerful tool in the study of L1 functions and ﬁnite mea-
sures. If we want to extend some of the ideas of this theory to bounded functions
and translation bounded measures, we cannot use integration anymore, as the in-
tegrals will be inﬁnite. In any case, the translation boundedness of the measures,

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

31

or boundedness of the functions, implies that we may still be able to integrate on
average, meaning dividing the integral over BR by the volume of BR and taking the
limit as R → ∞. We will refer to this limit, when it exists, as the mean of the
function.

As Eberlein showed [5], for weakly almost periodic functions the mean always exists
and is uniform in translates of the function. Moreover,

hf, gi := M(f ¯g)

deﬁnes a semi-inner product on the space of weakly almost periodic functions, which
becomes an inner product when we restrict to the class of strongly almost periodic
functions. The space (SAP (Rd), h·, ·i) becomes a Hilbert space, and the set {χx(y) =
e2πix·y : x ∈ Rd} of characters on Rd is an orthogonal basis which is complete for
this inner product. For more details we refer the reader to [15].

Eberlein also showed that given a ﬁnite measure µ, the function f = ˇµ is weakly
almost periodic, and the (Fourier-Bohr) coeﬃcients ax(f )M(χxf ) of f with respect
to this complete orthogonal set are exactly the intensities of the atoms in the pure
point part (µ)pp of the measure µ.

The notion of the mean was extended to weakly almost periodic measures by Ar-
gabright and deLamadrid [9]. They further showed that for a Fourier transformable
measure, the Fourier Bohr coeﬃcients of the measure give exactly the intensity of
the atoms in the pure point part of the measure’s Fourier transform.

In this section we use the ideas of [9] to extend the notion of mean to weakly
almost periodic distributions and prove that for distributions with measure Fourier
transform, the relation between the Fourier Bohr coeﬃcients and the pure point
part of the Fourier transform still holds.

Theorem 7.1. Let ψ ∈ WAP(Rd). Then, there exists a constant M(ψ) such that
for all f ∈ D we have

M(ψ ∗ f ) = M(ψ)ZRd

f dλ .

Proof. Let f, g ∈ D. As ψ ∗ f ∈ W AP (Rd) it follows from [9] that

M((ψ ∗ f ) ∗ g) = M(ψ ∗ f )ZRd

g dλ

32

NICOLAE STRUNGARU AND VENTA TERAUDS

and, similarly, that

This implies that

f dλ .

f dλ ,

M((ψ ∗ g) ∗ f ) = M(ψ ∗ g)ZRd
M(ψ ∗ f )ZRd
g dλ = M(ψ ∗ g)ZRd
RRd f dλ

M(ψ ∗ f )

M(ψ) :=

M(ψ ∗ f0)

,

and we see that the ratio

is constant over all f ∈ D with non-zero integral.

This allows us to deﬁne the number

Finally, if g ∈ D is any function, we get

RRd f0 dλ
where f0 ∈ D is an arbitrary function withRRd f0 dλ 6= 0.
g dλ = M(ψ)ZRd

f0 dλZRd
Dividing both sides byRRd f0 dλ 6= 0 we obtain the required identity.

f0 dλ = M(ψ ∗ f0)ZRd

M(ψ ∗ g)ZRd

The constant found in the above theorem is called the mean of ψ.

g dλ .

(cid:3)

Deﬁnition 7.1. Let ψ ∈ WAP(Rd). The mean of ψ is the number M(ψ), deﬁned
by

M(ψ ∗ f ) = M(ψ)ZRd

f (t)dλ(t) for all f ∈ D .

We next show that Theorem 7.1 can be extended to test functions f ∈ S .

Proposition 7.1. Let ψ ∈ WAP(Rd). Then for all f ∈ S we have

M(ψ ∗ f ) = M(ψ)ZRd

f dλ .

Proof. Let g ∈ D with RRd g dλ 6= 0 and let f ∈ S . Then f ∗ g ∈ S and, as

ψ ∈ WAP(Rd), we have

ψ ∗ f ∈ W AP (Rd) ; ψ ∗ g ∈ W AP (Rd) and ψ ∗ (f ∗ g) ∈ W AP (Rd) .

Then by [9],

M((ψ ∗ f ) ∗ g) = M(ψ ∗ f )ZRd

gdλ ,

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

33

and thus, by Lemma 5.1,

M(ψ ∗f )ZRd

gdλ = M((ψ ∗f )∗g) = M(ψ ∗(f ∗g)) = M(ψ ∗(g ∗f )) = M((ψ ∗g)∗f ) .

Now, ψ ∗ g ∈ W AP (Rd) and the convolution (ψ ∗ g) ∗ f of functions can be inter-
preted as the convolution between the measure (ψ ∗ g)λ and the ﬁnite measure f λ.
Therefore, by [9, Prop. 4.3] we have

M((ψ ∗ g) ∗ f ) = M(ψ ∗ g)ZRd

f dλ .

(cid:3)

The claim follows now from Theorem 7.1.

Corollary 7.1. Let ψ ∈ WAP(Rd) and f ∈ S . Then

M(ψ)ZRd

f dλ = lim
n

1

(2n)dZ[−n,n]d

ψ(Ttf−)dt .

As for functions and measures, the mean is linear and is compatible with the oper-
atons of reﬂection and conjugation.

Proposition 7.2. The mean M : WAP(Rd) → C has the following properties:

(i) For all ψ, φ ∈ WAP(Rd) and a, b ∈ C, M(aψ + bφ) = aM(ψ) + bM(φ).
(ii) M(λRd) = 1.
(iii) If f ∈ W AP (Rd) ∩ S then the means of f as function and distribution are

equal.

(iv) If µ ∈ WAP (Rd) ∩ S ′ then the means of µ as measure and distribution are

equal.

(v) For ψ ∈ WAP(Rd), M(ψ) = M(eψ) = M(ψ) and M(ψ-) = M(ψ).

(vi) For ψ ∈ WAP(Rd), x ∈ Rd, M(Txψ) = M(ψ).

Proof. (i) and (ii) follow from [5, Theorem 14.1] and Theorem 7.1.

(iii): If f ∈ W AP (Rd) ∩ S and g ∈ D then as functions we have [9]

M(f ∗ g) = M(f )ZRd

gdλ .

The claim follows now from Theorem 7.1.

(iv): If µ ∈ WAP (Rd) ∩ S ′ and g ∈ D then the convolution µ ∗ g of the measure µ
and the compactly supported continuous function g satisﬁes [9]

M(µ ∗ g) = M(µ)ZRd

gdλ .

34

NICOLAE STRUNGARU AND VENTA TERAUDS

As µ ∗ g is the same if we consider it as the convolution of a tempered distribution
and a Schwartz function, the claim follows again from Theorem 7.1.

(v) and (vi) follow from [5, Theorem 14.1] and Theorem 7.1.

(cid:3)

Recall that for each x ∈ Rd and ψ ∈ S we have

where for x, y ∈ Rd,

dTxψ = χ−xbψ and dχxψ = Txbψ

χx(y) = e2πix·y .

The importance of the mean for diﬀraction theory is given by the following type of
results, see also [6, 9, 15, 10].

Theorem 7.2. Let ψ ∈ S cM. Then, for all x ∈ Rd we have

Proof. Let f ∈ D. Then, bfbψ is a ﬁnite measure, and hence, by [6] we have

f dλ .

bψ({x}) = M(χxψ) .
(cid:16)bfbψ(cid:17) ({0}) = M(ψ ∗ f ) = M(ψ)ZRd

As

bf (0) =ZRd

f dλ ,

For general x ∈ Rd, we then have

it follows that bψ({0}) = M(ψ); that is, our claim is true for χ = 0.
bψ({x}) = T−χxbψ({0}) = \(χxψ)({0}) = M(χxψ) .

(cid:3)

Exactly as in the case of functions and measures, we can characterize the null weakly
almost periodic tempered distributions in terms of means under character multipli-
cation.

Proposition 7.3. Let ψ ∈ WAP(Rd). Then ψ ∈ WAP0(Rd) if and only if for all
x ∈ Rd we have

M(χxψ) = 0 .

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

35

Proof. Note that for f ∈ S , x ∈ Rd, we have

((χxψ) ∗ f )b =(cid:16)Txbψ(cid:17)bf = Tx(cid:16)bψT−xbf(cid:17) ,

(χxψ) ∗ f = χx (ψ ∗ (χ−xf )) .

and thus

(5)

Let ψ ∈ WAP0(Rd). For all f ∈ D and x ∈ Rd, we have (ψ ∗ (χ−xf )) ∈ W AP0(Rd),
and hence by [7],

Then from (5), for all f ∈ D we have

M (χx(ψ ∗ (χ−xf ))) = 0 .

M((χxψ) ∗ f ) = 0 ,

so by the deﬁnition of the mean, we have the forward implication.

Conversely, suppose that M(χxψ) = 0 for all x ∈ Rd. Let f ∈ S . Then

M ((χxψ) ∗ (χxf )) = M(χxψ)ZRd

χxf dλ = 0

for all x ∈ Rd. Applying (5), this yields that

0 = M (χx(ψ ∗ (χ−xχxf ))) = M(χx(ψ ∗ f ))

for all x ∈ Rd and hence [7] we have that ψ ∗ f ∈ W AP0(Rd). As f ∈ S was
arbitrary, we obtain the result.
(cid:3)

Note that in case ψ ∈ S cM, the above result is an immediate corollary of Theorem
7.2.

Combining the results of this section with Proposition 6.2, we obtain the following.

Proposition 7.4. Let ψ ∈ S cM. Then the following are equivalent:

(ii) ψ ∈ WAP0(Rd).
(iii) ψ ∗ f ∈ W AP0(Rd) for all f ∈ D.
(iv) ψ ∗ f ∗ g ∈ W AP0(Rd) for all f, g ∈ D.

(i) bψ is a continuous measure.
(v) ψ ∗ f ∗ ef ∈ W AP0(Rd) for all f ∈ D.

(vi) M(χxψ) = 0 for all x ∈ Rd.

36

NICOLAE STRUNGARU AND VENTA TERAUDS

8. Diffraction of a Weakly Almost Periodic Distribution

In this section we study the diﬀraction of a weakly almost periodic distribution. We
shall see that as long as such a distribution admits an autocorrelation, the diﬀraction
is unique, pure point diﬀractive and can be expressed in terms of the Fourier-Bohr
coeﬃcients of the original distribution.

Theorem 8.1. Let ψ ∈ WAP which has an autocorrelation φ. Then the following
hold.

(i) For all f ∈ D we have

where the RHS denotes the Eberlein convolution of weakly almost periodic
functions 1.

φ ∗ f ∗ ef = (ψ ∗ f ) ⊛ ]ψ ∗ f

(ii) φ is the only autocorrelation of ψ.
(iii) If {hR} is any strong smooth approximate van Hove family for ψ then

φ = lim
R

1

vol(BR)

ψR ∗fψR

(iv) φ ∈ SAP(Rd).
(v) ψ has pure point diﬀraction given by

|M(χxψ)|2 δx .

bφ = Xx∈Rd

Proof. In this proof we follow closely the proofs of [14].

(i): Let Rn → ∞ be such that

φ = lim
n

1

vol(BRn)

ψRn ∗gψRn .

Let f ∈ D and let R > 0 be such that sup(f ) ⊆ BR(0). Let N be such that for all
n > N we have Rn > R.

For any n > N, we note that

(ψRn ∗ f )(t) − hRn(t)(ψ ∗ f )(t) = ψ(hRnTtf−) − hRn(t)ψ(Ttf−) .

If t /∈ BRn+1+R(0) then hRnTtf− ≡ 0 and hence

ψ(hRnTtf−) = 0 .

1See [5, Def. 15.1] for the deﬁnition of Eberlein convolution of weakly almost periodic functions.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

37

In this case we also have hRn(t) = 0. This shows that

(ψRn ∗ f )(t) = hRn(t)(ψ ∗ f )(t) for t /∈ BRn+1+R(0) .

Now, taking n > N, if t ∈ BRn−R(0) we have

hRnTtf− = Ttf− ,

and hence

(ψRn ∗ f )(t) = ψ(hRnTtf−) = ψ(Ttf−) = hRn(t)ψ(Ttf−) = hRn(t)(ψ ∗ f )(t) .

This shows that

(ψRn ∗ f )(t) = hRn(t)(ψ ∗ f )(t) for all t /∈ BRn+1+R(0)\BRn−R(0) .

Moreover, on the compact set BRn+1+R(0)\BRn−R(0), the function ψRn ∗f = hRn(ψ ∗
f ) is bounded as kψ ∗ f k∞ < ∞ by translation boundedness of ψ. Therefore, by a
standard van Hove computation, we have

lim
n

1

vol(BRn)

(ψRn ∗ f ) ∗ (gψRn ∗ ef )(t)

1

− lim
Rn

vol(BRn)

for all t ∈ Rd. Moreover, by the properties of hRn and the van Hove property of
BRn, we have

(hRn(ψ ∗ f )) ∗ (hRn(ψ ∗ f ))e(t) = 0 ,

lim
n→∞

1

vol(BRn)

(hRn(ψ ∗ f )) ∗ (hRn(ψ ∗ f ))e(t)

−

1

vol(BRn)

(1BRn (ψ ∗ f )) ∗ (1BRn (ψ ∗ f ))e(t) = 0 ,

for all t ∈ Rd. Therefore,

lim
n→∞

1

vol(BRn)

(6)

(ψRn ∗ f ) ∗gψRn ∗ ef (t)

1

−

vol(BRn)

for all t ∈ Rd. Now, since ψ ∈ WAP(Rd) we have ψ ∗ f ∈ W AP (Rd). Therefore, the
Eberlein convolution (ψ ∗ f ) ⊛ ^(ψ ∗ f ) is well deﬁned and by [5],

(1BRn (ψ ∗ f )) ∗ (1BRn (ψ ∗ f ))e(t) = 0 ,

(ψ ∗ f ) ⊛ ^(ψ ∗ f )(t) = lim

n

1

vol(BRn)

uniformly in t. Therefore, by (6), for all t ∈ Rd the limit

(1BRn (ψ ∗ f )) ∗ (1BRn (ψ ∗ f ))e(t)

lim
n→∞

1

vol(BRn)

(ψRn ∗ f ) ∗ (gψRn ∗ ef )(t)

38

NICOLAE STRUNGARU AND VENTA TERAUDS

exists and is equal to (ψ ∗ f ) ⊛ ^(ψ ∗ f )(t).

This proves (i).

(ii): Let ϕ be any other autocorrelation of ψ. Then, as (i) holds for any autocorre-
lation, we get that for all f ∈ D we have

Evaluating at t = 0 we get that φ = ϕ on a dense subset of S , and hence φ = ϕ.

φ ∗ f ∗ ef = (ψ ∗ f ) ⊛ ]ψ ∗ f = ϕ ∗ f ∗ ef

(iii): This follows immediately from the compactness of {
from the fact that as R → ∞ this set has a unique cluster point.

1

vol(BR) ψR ∗fψR|R > 1} and

(iv): Since (ψ ∗ f ) ⊛ ^(ψ ∗ f ) ∈ SAP (Rd) [5, Theorem 15.1], we have from (i) that

φ ∗ f ∗ ef ∈ SAP (Rd). The claim now follows from Proposition 6.1.

(v): From (i), for each f ∈ D we have

2

φ ∗ f ∗ ef = (ψ ∗ f ) ⊛ ]ψ ∗ f .
As φ ∈ SAP(Rd) is positive deﬁnite, bφ is a pure point measure by Proposition 6.1.
To prove (iv) we need to show that bφ({x}) = |M(χxψ)|2 for all x ∈ Rd.
Fix x ∈ Rd and take f ∈ D such that bf (x) 6= 0. We have
(cid:12)(cid:12)(cid:12)bf (x)(cid:12)(cid:12)(cid:12)
bφ({x}) = (φ ∗ f ∗ ef )b(x) = M(χx(φ ∗ f ∗ ef )) = M(χx((ψ ∗ f ) ⊛ ^(ψ ∗ f ))) ,
M(χx(ψ ∗ f ) ⊛ ^(ψ ∗ f )) = |M(χx(ψ ∗ f ))|2 = |M(χxψ)|2(cid:12)(cid:12)(cid:12)bf (x)(cid:12)(cid:12)(cid:12)

where we have applied Theorem 7.2 and (i). By [5, Lemma 15.2] we know that the
Fourier Stiltje coeﬃcient M(χx((ψ ∗ f ) ⊛ ^(ψ ∗ f ))) of the Eberlein convolution is
given by

This shows that

.

2

2

(cid:12)(cid:12)(cid:12)bf (x)(cid:12)(cid:12)(cid:12)

bφ({x}) = |M(χxψ)|2(cid:12)(cid:12)(cid:12)bf (x)(cid:12)(cid:12)(cid:12)

2

,

which completes the proof.

(cid:3)

9. Tempered distributions with an autocorrelation

Our primary goal for this section is to introduce few examples of tempered distri-
butions for which the diﬀraction can be calculated explicitly.

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

39

Example 9.1. Returning again to the tempered distribution of Example 2.1, let
ψ = −DδZ on R. Writing

ψ = −Dδ0 ∗ δZ

and observing that Dδ0 ∗ Dδ0 = D2δ0, a simple calculation gives that ψ has auto-
correlation

and diﬀraction

D2δn

φ = D2δZ =Xn∈Z
bφ = 4π2Xn∈Z

n2δn .

This can be easily generalised from the Dirac measure of Z to that of a lattice
Λ ∈ Rn. For a multi-index α, let

ψ := DαδΛ .

Then ψ has autocorrelation given by

φ := dens(Λ)D2αδΛ ,

and hence diﬀraction

bφ = (4π2)|α| dens(Λ)2Xx∈Λ∗

x2αδx .

We will see later in this section that the results of this paper will yield a simpler
derivation of these autocorrelation and diﬀraction measures.

Next, we change a standard probabilistic model to give a new interesting example:

Example 9.2. Construct a distribution ψ the following way: for each integer n ∈ Z
select at random δn or δ′
n with respective probabilities p and 1 − p. This distribution
can be written as

where an, bn ∈ {0, 1} and an + bn = 1. An easy computation shows that the auto-
correlation φ of ψ has the form

ψ =Xn∈Z

anδn + bnδ′
n

φ =Xn∈Z

cnδn + dnδ′

n + enδ′′

n

cn = lim
m

1
2m

mXk=−m

akan+k ,

where

40

NICOLAE STRUNGARU AND VENTA TERAUDS

dn = 2 lim
m

1
2m

akbn+k ,

en = lim
m

1
2m

bkbn+k .

mXk=−m
mXk=−m

Now, if n 6= 0 we have, by the independence of the random variables, that ak and
an+k are both 1 with probability p2, otherwise their product is zero. Therefore, we
get cn = p2. In the same way, dn = 2p(−1p) and en = (1 − p)2.

If n = 0, we have ak = an+k, bk = nn+k, and akbk = 0. Therefore we get cn = p, dn =
0, and en = 1 − p. This gives

φ = p2δZ + 2p(1 − p)DδZ + (1 − p)2D2δZ + (p − p2)δ0 + (1 − p − (1 − p)2)D2δ0 .

The diﬀraction of ψ is hence

bφ =(cid:0)Xn∈Z

(p2 + 2np(1 − p) + n2(1 − p)2)δn(cid:1) +(cid:0)(p − p2) + (1 − p − (1 − p)2)x2(cid:1)λ .

The next result will give us many examples of distributions with pure point diﬀrac-
tion.

Lemma 9.1. Let µ ∈ M∞(Rd) and let ψ = ˇµ ∈ S ′(Rd). If ψ has an autocorrelation
φ, then φ is the unique autocorrelation of ψ, φ ∈ SAP(Rd) and the diﬀraction of ψ
is

bφ = Xx∈Rd(cid:12)(cid:12)µ({x})(cid:12)(cid:12)2δx .

Proof. As ψ ∈ S cM we have ψ ∈ WAP(Rd). Therefore by Proposition 8.1, φ is the
unique autocorrelation of ψ, φ ∈ SAP(Rd) and the diﬀraction of ψ is

Moreover, as ψ ∈ S cM by Theorem 7.2 we have

bφ = Xx∈Rd(cid:12)(cid:12)M( ¯χxψ)(cid:12)(cid:12)2δx .
M( ¯χxψ) = bψ({x}) = µ({x}) .

This completes the proof.

(cid:3)

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

41

Corollary 9.1. Let ψ ∈ S cM be a tempered distribution with autocorrelation φ. Then
the diﬀraction of ψ has the form

2

bφ = Xx∈Rd(cid:12)(cid:12)(cid:12)bψ({x})(cid:12)(cid:12)(cid:12)

δx .

Corollary 9.2. Let Λ ⊆ cRd be a Delone set and let ψ = ˇδΛ.

If ψ admits an
autocorrelation φ then φ is the only autocorrelation of ψ, the diﬀraction of ψ is δΛ
and ψ = φ.

Proof. The ﬁrst part follows from Lemma 9.1. The last claim follows from the fact
that \ψ − φ = δΛ − δΛ = 0.

(cid:3)

Remark 9.1. If Λ is repetitive, has FLC and is not fully periodic, we have δΛ /∈
WAP(Rd) [14]. As the Fourier Transform of any translation bounded measure is a
weakly almost periodic measure [9, 15], it follows that δΛ cannot in this case be the
diﬀraction measure of any translation bounded measure.

Example 9.3. Let Λ be the Fibonacci point set, and ψ = ˇδΛ. If ψ has an autocor-
relation, then the only diﬀraction of ψ is δΛ.

For the next example the existence of the autocorrelation was established in [17].

Example 9.4. Recall from Example 4.1 the tempered distribution

whose Fourier transform is the measure

2

2δ Z

+Xn≥1
bω = 1
ω := δ2Z +Xn≥1

cos(2π(4n − 1)(·))

4n

δ Z
2.4n ,

δ2.4nZ ∗ (δ4n−1 + δ1−4n) .

By Corollary 9.1, the diﬀraction of bω is exactly ω (and hence its autocorrelation is
bω).

We next look at how convolution with a compactly supported distribution aﬀects
the diﬀraction.

Proposition 9.1. Let ψ ∈ S ′ be translation bounded and ϕ be a tempered distribu-
tion with compact support. If φ is an autocorrelation of ψ calculated with respect to

42

NICOLAE STRUNGARU AND VENTA TERAUDS

hRn and if

(cid:26)

1

vol(BRn)

(hRnψ ∗ ϑ) ∗ ^hRnψ ∗ ϑ : n ∈ N(cid:27)

is weak-* precompact, then then φ ∗ ϑ ∗eϑ is the autocorrelation of ψ ∗ ϑ calculated

with respect to hRn.

Proof. It is easy to see that convolution with a ﬁxed compactly supported distribu-
tion is weak-* continuous. Therefore
1

φ ∗ ϑ ∗eϑ = lim

n→∞

vol(BRn)(cid:0)(hRnφ) ∗ ^(hRnφ)(cid:1) ∗ ∗ϑ ∗eϑ

By a similar computation to Lemma 3.3 we get

1

lim
n→∞

vol(BRn)(cid:2)(cid:0)(hRnφ) ∗ ^(hRnφ)(cid:1) ∗ ϑ ∗eϑ −(cid:0)(hRnφ ∗ ϑ) ∗ ^(hRnφ ∗ ϑ)(cid:1)(cid:3)(f ∗ g) = 0

for all f, g ∈ D. Now by our convolution assumption we get by Lemma 3.2 that

φ ∗ ϑ ∗eϑ = lim

n→∞

1

vol(BRn)(cid:0)(hRnφ ∗ ϑ) ∗ ^(hRnφ ∗ ϑ)(cid:1)

in the weak-* topology of S ′, which proves our claim.

(cid:3)

An immediate consequence of this is the following.

Corollary 9.3. Let µ ∈ M be a translation bounded measure and let hR be a smooth
approximate van Hove sequence as in Proposition 3.3. Let hRn be a sequence with
respect to which Dαµ has an autocorrelation φ and µ has autocorrelation γ. Then

and the diﬀraction of ψ is thus

φ = D2αγ

Let us note that in Corollary 9.3, the existence of a sequence hRn is guaranteed by
Proposition 3.2 and Proposition 3.3.

bφ = (2π)2|α|x2αbγ .

Example 9.5. Let Λ be any Delone set. If ψ and γ are autocorrelations of DδΛ
and δΛ calculated with respect to the same choice of the smooth van Hove sequence,
respectively the corresponding van Hove sequence, then

bψ = x2bγ .

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

43

We complete the paper by introducing a non translation bounded tempered distri-
bution which has an autocorrelation. Our example is a measure, and has also the
same autocorrelation as measure.

Example 9.6. Let

µ := δZ +Xn∈N

nδ2n .

As µ has logarithmic growth, it is a tempered distribution. Also, µ is positive and
not translation bounded as a measure, hence not translation bounded as a tempered
distribution.

Now, if we pick any smooth approximate van Hove sequence hR, we have for all
m ∈ N

lim
m

and

hmµ = δZ∩[−m,m] + Xn∈N;2n≤m

nδ2n .

Therefore

1

2m(cid:0)(hmµ) ∗ ghmµ − δZ∩[−m,m] ∗ ^δZ∩[−m,m](cid:1) =

+

1

2m(cid:0) mXk=−m Xn∈N;2n≤m
2m Xn,k∈N;2n≤m;2k≤m

1

nδk−2n + nδ2n−k(cid:1)

nkδ2n−2k .

Now, for each l ∈ Z there are at most 2 log2(m) pairs −k ≤ k ≤ m and n ∈ N
with 2n < m such that k − 2n = l or 2n − k = l. For each such pair, we also have
n ≤ log2(m).

Moreover, using the binary representation of a number, it is easy to see that every
integer l can be written in at most one way as the diﬀerence l = 2k − 2n of two
powers of two. We also have nk < (log2(m))2. Therefore we get

0 ≤

1

2m(cid:0)(hmµ) ∗ ghmµ − δZ∩[−m,m] ∗ ^δZ∩[−m,m](cid:1) ≤

3(log2(m))2δl(cid:1) .

It is easy to see that both as measures and tempered distributions we have

1

1

2m(cid:0) 2mXl=−2m
2m(cid:0)δZ∩[−m,m] ∗ ^δZ∩[−m,m](cid:1) = δZ ,
2m(cid:0) 2mXl=−2m
3(log2(m))2δl(cid:1) = 0 .

1

lim
m

44

NICOLAE STRUNGARU AND VENTA TERAUDS

Therefore

lim
m

1

2m(cid:0)(hmµ) ∗ ghmµ(cid:1) = δZ .

Acknowledgment: The authors are grateful to Michael Baake for stimulating
our interest in these questions, as well as for numerous discussions and comments which
improved the quality of this manuscript. Part of the work was done while NS visited
the University of Bielefeld and NS would like to thank the University for the hospitality.
The work was partially supported by the German Research Foundation (DFG), within the
CRC 701 and partially supported by NSERC with a research grant number 2014-03762
and the authors are grateful for the support.

References

[1] L. N Argabright, J. Gil de Lamadrid, Fourier analysis of unbounded measures on
locally compact abelian groups, Memoirs of the Amer. Math. Soc., Vol 145, 1974.
http://dx.doi.org/10.1090/memo/0145

[2] M. Baake and U. Grimm, Aperiodic Order. Vol. 1: A Mathematical Invitation, Cam-

bridge University Press, Cambridge (2013).

[3] M. Baake and R.V. Moody (2004). Weighted Dirac combs with pure point
diﬀraction, J. reine angew. Math. (Crelle) 573, 61–94. arXiv:math.MG/0203030.
http://dx.doi.org/10.1515/crll.2004.064

[4] C. Berg and G. Forst, Potential theory on locally compact abelian groups, Springer,

New York, 1975.

[5] W.F. Eberlein, Abstract ergodic theorems and weak almost periodic functions, Trans.

Amer. Math. Soc., 67, 217-24, 1949.

[6] W.F. Eberlein, A Note on Fourier-Stiltjes Transforms, Proc. Amer. Math. Soc, Vol

6, No. 2, 310-312, 1955.

[7] W.F. Eberlein, The Point Spectrum of Weakly Almost Periodic Functions , Michigan

Math J. 3, 137-139, 1955-1956.

[8] J. C. Lagarias, Mathematical quasicrystals and the problem of diﬀraction. In: Direc-
tions in Mathematical Quasicrystals (eds. M. Baake and R.V Moody ), CRM Mono-
graph Series, Vol 13, Amer. Math. Soc., Providence, RI, 61-93, 2000.

[9] J

. Gil.

de Lamadrid,

Memoirs
1990)
http://www.ams.org/books/memo/0428/ http://dx.doi.org/10.1090/memo/0428

the Amer. Math. Soc., Vol

(May

of

L. N Argabright, Almost Periodic Measures,
.

85, No.

428

[10] A. Hof, On diﬀraction by aperiodic structures, Commun. Math. Phys. 169 (1995),

25–43.

[11] L. H¨ormander, The Analysis of Linear Partial Diﬀerential Operators I. New York:

Springer-Verlag. (1983)

[12] G. K¨othe, Topological Vector Spaces I. New York: Springer-Verlag. (1969)

DIFFRACTION THEORY AND ALMOST PERIODIC DISTRIBUTIONS

45

[13] D. Lenz and R.V. Moody, Stationary processes with pure point diﬀraction,

arXiv:1111.3617v1.

[14] D. Lenz and N. Strungaru, On Weakly Almost Periodic Measures, in preparation.
[15] R.V. Moody and N. Strungaru (2015). Almost periodic measures and their Fourier
transforms. In Aperiodic Order. Vol. 2: Crystallography and Almost Periodicity, Baake
M. and Grimm U. (eds.), pp. 1–XXX (Cambridge University Press, Cambridge).

[16] W. Rudin, Functional analysis, McGraw-Hill, New York, 1973.
[17] V. Terauds, The inverse problem for pure point diﬀraction – examples and open

questions. J. Stat. Phys. 152 (2013), no. 5, 954–968.

[18] V. Terauds and M. Baake, Some comments on the inverse problem of pure point
diﬀraction, in: Aperiodic Crystals, eds. S. Schmid, R.L. Withers and R. Lifshitz,
Springer, Dordrecht (2013), pp. 35–41.

Department of Mathematical Sciences, MacEwan University, 10700 104 Avenue,
Edmonton, AB, T5J 4S2;, and, Department of Mathematics, Trent University, Pe-
terborough, ON and, Institute of Mathematics “Simon Stoilow”, Bucharest, Ro-
mania

E-mail address: strungarun@macewan.ca

URL: http://academic.macewan.ca/strungarun/

Fakult¨at f¨ur Mathematik, Universit¨at Bielefeld, Postfach 100131, 33501 Biele-
feld, Germany

E-mail address: terauds@math.uni-bielefeld.de

