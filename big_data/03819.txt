Birth(death)/birth-death processes and their

computable transition probabilities with statistical

applications

Lam Si Tung Ho

Jason Xu

Department of Biostatistics

Department of Statistics

University of California, Los Angeles

University of Washington

Forrest W. Crawford

Vladimir N. Minin

Department of Biostatistics

Departments of Statistics and Biology

Yale University

University of Washington

Marc A. Suchard

Departments of Biomathematics, Biostatistics and Human Genetics

University of California, Los Angeles

6
1
0
2

 
r
a

 

M
1
1

 
 
]

O
C

.
t
a
t
s
[
 
 

1
v
9
1
8
3
0

.

3
0
6
1
:
v
i
X
r
a

1

Abstract

Birth-death processes track the size of a univariate population, but many biological

systems involve interaction between populations, necessitating models for two or more

populations simultaneously. A lack of eﬃcient methods for evaluating ﬁnite-time tran-

sition probabilities of bivariate processes, however, has restricted statistical inference in

these models. Researchers rely on computationally expensive methods such as matrix

exponentiation or Monte Carlo approximation, restricting likelihood-based inference

to small systems, or indirect methods such as approximate Bayesian computation. In

this paper, we introduce the birth(death)/birth-death process, a tractable bivariate ex-

tension of the birth-death process. We develop an eﬃcient and robust algorithm to

calculate the transition probabilities of birth(death)/birth-death processes using a con-

tinued fraction representation of their Laplace transforms. Next, we identify several

exemplary models arising in molecular epidemiology, macro-parasite evolution, and in-

fectious disease modeling that fall within this class, and demonstrate advantages of

our proposed method over existing approaches to inference in these models. Notably,

the ubiquitous stochastic susceptible-infectious-removed (SIR) model falls within this

class, and we emphasize that computable transition probabilities newly enable direct

inference of parameters in the SIR model. We also propose a very fast method for

approximating the transition probabilities under the SIR model via a novel branching

process simpliﬁcation, and compare it to the continued fraction representation method

with application to the 17th century plague in Eyam. Although the two methods pro-

duce similar maximum a posteriori estimates, the branching process approximation

fails to capture the correlation structure in the joint posterior distribution.

Keywords

stochastic models, birth-death process, infectious disease, SIR model,

transition probabilities

2

1

Introduction

Birth-death processes has been used extensively in many applications including evolutionary

biology, ecology, population genetics, epidemiology, and queuing theory (see e.g. Novozhilov

et al., 2006; Crawford and Suchard, 2012; Doss et al., 2013; Rabier et al., 2014; Crawford

et al., 2015). However, establishing analytic and computationally practical formulae for

their transition probabilities is usually diﬃcult (Novozhilov et al., 2006). The state-of-the-

art method for computing the transition probabilities of birth-death processes proposed in

Crawford and Suchard (2012) enables statistical estimation for general birth-death processes

using likelihood-based inference (Crawford et al., 2014). Unfortunately, birth-death processes

inherently only track one population, and extending this technique beyond the univariate

case is nontrivial. Many applied models require the consideration of two or more interacting

populations simultaneously to model behavior such as competition, predation, or infection.

Examples of such bivariate models include epidemic models (McKendrick, 1926; Kermack

and McKendrick, 1927; Griﬃths, 1972), predator-prey models (Hitchcock, 1986; Owen et al.,

2015), genetic models (Rosenberg et al., 2003; Xu et al., 2015), and within-host macro-

parasite models (Drovandi and Pettitt, 2011).

The most general extensions of birth-death processes to bivariate processes are competi-

tion processes (Reuter, 1961). These processes allow not only “birth” and “death” events in

each population, but also “transition” events where an individual moves from one population

to the other. Unlike birth-death processes, few attempts have been made to compute the

transition probabilities of competition processes or their special cases. Hence, researchers

usually rely on classical continuous-time Markov chain methods such as matrix exponentia-

tion and diﬀusion approximation. Unfortunately, these methods fail to leverage the speciﬁc

structure of competition processes, and have several intrinsic limitations. Matrix exponenti-

ation methods compute the transition probability matrix P(t) by solving the matrix form of
Kolmogorov’s forward equation P(cid:48)(t) = P(t)Q with initial condition P(0) = I, where Q is

the instantaneous rate matrix of the process. While this equation admits a unique solution

3

P(t) = exp(Qt) (Ephraim and Mark, 2012), numerical evaluation of the matrix exponential

is often troublesome (Moler and Loan, 2003). Its computational cost via eigenvalue decompo-

sition, for instance, is cubic in the size of the state-space and thus becomes computationally

prohibitive even with moderately sized state-spaces (Drovandi and Pettitt, 2011; Crawford

and Suchard, 2012). For example, Keeling and Ross (2008) demonstrate that computing

transition probabilities via matrix exponentiation for the simplest epidemic models is prac-

tical only when modeling spread of an infectious disease through a very small population

(e.g., 100 people). Moreover, matrix exponentiation can introduce serious rounding errors for

certain rate matrices even for biologically reasonable values (Schranz et al., 2008; Crawford

and Suchard, 2012; Crawford et al., 2014). Diﬀusion approximations, on the other hand,

require the state-space to be large in order to justify approximating a discrete process by a

continuous-valued diﬀusion process (Karev et al., 2005; Golightly and Wilkinson, 2005), and

can often remain inaccurate for simulation even in settings with large state-spaces (Golightly

and Wilkinson, 2005). Branching processes form another closely related class of processes,

and have been used in a likelihood-based framework to study bivariate populations (Xu

et al., 2015). Branching processes are at once more general than competition processes,

permitting events that increment populations by more than one, and also more restrictive

in that linearity is implied by an assumption that particles act independently. The latter

assumption is limiting in epidemiological applications, for instance, which commonly feature

non-linear interactions between populations.

The lack of a reliable method for computing transition probabilities in bivariate pro-

cesses forces researchers to apply alternative likelihood-free approaches such as approximate

Bayesian computation (ABC) (Blum and Tran, 2010; Drovandi and Pettitt, 2011; Owen

et al., 2015). The ABC approach uses simulated and observed summary statistics to by-

pass likelihood evaluation. Nonetheless, this is not a panacea approach that can completely

replace traditional likelihood-based methods. The ABC method itself has several sources

for loss of information such as non-zero tolerance, and non-suﬃcient summary statistics

4

(Sunn˚aker et al., 2013). In the context of counting processes, the problem of non-suﬃcient

summary statistics cannot be solved because the data are usually observed partially. Thus,

credible interval estimates under ABC are potentially inﬂated due to the loss of information

(Csill´ery et al., 2010). Also, when suﬃcient summary statistics are not available, the ABC

method can not be trusted in selecting between models (Robert et al., 2011). Because of all

these limitations, direct likelihood-based methods are often more favorable.

In this paper, we develop an eﬃcient and robust method to compute the transition prob-

abilities of a subclass of competition processes with two interacting populations of particles,

enabling likelihood-based inference. We call this subclass birth(death)/birth-death processes,

whose ﬁrst population is increasing (decreasing). A rigorous characterization of this class of

processes and derivation of recursive formulae to compute their transition probabilities are

provided in Section 2. Our main tools are the Laplace transform and continued fractions

that have been successfully applied for univariate birth-death processes in Crawford and

Suchard (2012). These formulae enable accurate and computationally eﬃcient numerical

computation of transition probabilities. We implement this method in the new R package

MultiBD https://github.com/msuchard/MultiBD. In Section 3, we discuss multiple sci-

entiﬁcally relevant applications of birth(death)/birth-death processes including stochastic

susceptible-infectious-removed (SIR) models in epidemiology (McKendrick, 1926; Kermack

and McKendrick, 1927; Raggett, 1982), a birth-death-shift model for transposable elements

(Rosenberg et al., 2003; Xu et al., 2015), and a within-host macro-parasite model (Riley

et al., 2003; Drovandi and Pettitt, 2011). We examine the accuracy of our method in simula-

tion studies, including comparisons to branching process and Monte Carlo approximations.

Finally, we apply our method to estimate infection rates and death rates during the plague

of Eyam in 1666 within a likelihood-based Bayesian framework in Section 4.

5

2 Birth(death)/birth-death processes

2.1 Birth/birth-death processes

A birth/birth-death process is a bivariate continuous-time Markov process X(t) = (X1(t), X2(t)),
t ≥ 0, whose state-space is in N× N, the Cartesian product of the non-negative integers. We

can describe a birth/birth-death process as governing dynamics of a system consisting two

types of particles, where one out of four possible events can happen in inﬁnitesimal time:

(1) a new type 1 particle enters the system; (2) a new type 2 particle enters the system;

(3) a type 2 particle leaves the system; or (4) a type 2 particle becomes a type 1 particle.

In this system, X1(t) and X2(t) track the number of type 1 and type 2 particles at time t

respectively. Mathematically, there are ﬁve possibilities for X(t) during a small time interval

(t, t + dt):

Pr

Pr

Pr

Pr

Pr

X2(t) = b

X1(t) = a

X2(t + dt) = b

X2(t + dt) = b + 1 X2(t) = b

 X1(t + dt) = a + 1 X1(t) = a
 X1(t + dt) = a
 X1(t + dt) = a
 X1(t + dt) = a + 1 X1(t) = a
 X1(t + dt) = a

X1(t) = a
X2(t + dt) = b − 1 X2(t) = b

X2(t + dt) = b − 1 X2(t) = b

X2(t + dt) = b

X1(t) = a

X2(t) = b

ab dt + o(dt)

ab dt + o(dt)

 = λ(1)
 = λ(2)
 = µ(2)
 = γabdt + o(dt)
 = 1 − (λ(1)

ab dt + o(dt)

ab + λ(2)

ab + µ(2)

ab + γab)dt + o(dt),

(1)

where a, b ∈ N, λ(1)
b type 2 particles, λ(2)

ab ≥ 0 is the birth rate of type 1 particles given a type 1 particles and
ab ≥ 0 is the

ab ≥ 0 is the equivalent birth rate of type 2 particles, µ(2)

6

death rate of type 2 particles, and γab is the transition rate from type 2 particles to type
1 particles. We ﬁx λ(1)−1,b = λ(2)

a0 = γ−1,b = γa0 = 0.

a,−1 = µ(2)

Letting P a0b0

ab

(t) = Pr{X(t) = (a, b) | X(0) = (a0, b0)}, the forward Kolmogorov’s equa-

tions for the birth/death-birth process are

(t)

dP a0b0
ab
dt

for all (a, b).

= λ(1)

a−1,bP a0b0

a,b−1P a0b0

a,b−1(t) + µ(2)

a,b+1P a0b0

a,b+1(t)

a−1,b(t) + λ(2)
a−1,b+1(t) − (λ(1)

+ γa−1,b+1P a0b0

ab + λ(2)

ab + µ(2)

ab + γab)P a0b0

ab

(t),

(2)

In general, a birth/birth-death process is a special case of a competition process (Reuter,

1961) with rate matrix Q = {qij} where i, j ∈ N × N and

j

(a + 1, b)

(a, b + 1)
(a, b − 1)
(a + 1, b − 1)

(a, b)

other

qij

λ(1)
ab
λ(2)
ab
µ(2)
ab

γab
ab + λ(2)
ab + µ(2)

−(λ(1)

ab + γab)

0

for i = (a, b). Competition processes are the most general bivariate Markov processes that

only allow transitions between neighboring states. Many practical models in biology are

special cases of these processes such as epidemic models (McKendrick, 1926; Kermack and

McKendrick, 1927; Griﬃths, 1972) and predator-prey models (Hitchcock, 1986; Owen et al.,

2015).

2.1.1 Suﬃcient condition for regularity

Deﬁnition 1. A birth/birth-death process is regular if there is a unique set of transition

probabilities P a0b0

ab

(t) satisfying the system of equations (2).

7

Here, we establish the suﬃcient condition for regularity of a birth/birth-death process.

For k ∈ N, we denote:

Dk = {(a, b) : a + b = k} ∈ N × N, and

λk = max
(a,b)∈Dk

{λ(1)

ab }.
ab + λ(2)

(3)

Theorem 1. The suﬃcient condition for regularity of a general birth/birth-death process is

(cid:80)∞
k=1 1/λk = ∞.
Lemma 1. Let Q = {qij} be a conservative matrix, such that −qii = (cid:80)

Proof. We will apply the following Reuter’s condition (Reuter, 1957):

j(cid:54)=i qij < ∞. A
continuous-time Markov chain associated with Q is regular if and only if for some ζ > 0,
the equation Qy = ζy subject to 0 ≤ yi ≤ 1 has only trivial solution y = 0.

For a general birth/birth-death process, states i and j are in N × N. Let {yab}a,b∈N be a

solution of Qy = ζy such that yab ∈ [0, 1] for any a and b. Then, we have

(ζ + λ(1)

ab + λ(2)

ab + µ(2)

ab + γab)yab = λ(1)

ab ya+1,b + λ(2)

ab ya,b+1 + µ(2)

ab ya,b−1 + γabya+1,b−1.

Deﬁning yk = max(a,b)∈Dk{yab} and (ak, bk) = argmax(a,b)∈Dk

{yab}, we deduce that

(ζ + λ(1)
akbk

+ λ(2)
akbk

ζyk + µ(2)
akbk

)yk ≤ (λ(1)
+ µ(2)
akbk
(yk − yk−1) ≤ (λ(1)

akbk

+ λ(2)
akbk

+ λ(2)
akbk

)yk+1 + µ(2)
akbk
)(yk+1 − yk).

yk−1, and

akbk

Since µ(2)

a−1b−1

= 0, yk is an increasing sequence. Thus,

yk ≤ yk+1 − yk.

ζ
λk

8

(4)

(5)

(6)

Assuming that there exists k0 such that yk0 > 0, we obtain

k−1(cid:88)

i=k0

k−1(cid:88)

i=k0

yk ≥ yk0 + ζ

≥ yk0(1 + ζ

yi
λi

1
λi

),

(7)

that is larger than 1 if k is big enough. Hence yk = 0 for every k. Then, the theorem is

proved by applying Lemma 1.

Note that the condition in Theorem 1 generalizes the classical regularity condition of

a pure birth process (Feller, 1968). From now on, we assume that our birth/birth-death

processes are regular.

2.1.2 Recursive formula for transition probabilities

In this section, we establish a recursion to calculate the transition probabilities P a0b0

ab

(t) of

a birth/birth-death process. Since we assume that our birth/birth-death process is regular,

these transition probabilities are unique.

(t) = 0 for all a < a0. Let fab(s), s ∈ C, be the Laplace transform

We ﬁrst note that P a0b0

ab

of P a0b0

ab

(t), that is

fab(s) = L[P a0b0

ab

(t)](s) =

From (2), we have

(cid:90) ∞

0

e−stP a0b0

ab

(t)dt.

(8)

(9)

sfab(s) − P a0b0

ab

(0) = λ(1)

a−1,bfa−1,b(s) + λ(2)

a,b−1fa,b−1(s) + µ(2)

+ γa−1,b+1fa−1,b+1(s) − (λ(1)

ab + λ(2)

ab + µ(2)

a,b+1fa,b+1(s)
ab + γab)fab(s), (a, b) ∈ N2.

Note that fab(s) is the unique solution of (9) by the uniqueness of P a0b0

ab

(t). We construct the

recursive approximation formulae for fab(s) using continued fractions. Appendix A provides

9

necessary background on continued fractions and their convergents. Denote

xa1 = − 1
µ(2)
a1

yab = −s + λ(1)

, b ≥ 2

; xab = −λ(2)
a,b−2
µ(2)
ab
a,b−1 + µ(2)

a,b−1 + λ(2)

a,b−1 + γa,b−1

µ(2)
ab

and consider the following continued fraction

φ(0)
a0 (s) =

ya1 +

xa1

xa2

ya2 +

xa3

ya3 + ··· .

, b ≥ 1,

(10)

(11)

We can construct the sequence {φ(0)

ab (s)}∞

b=0 (Deﬁnition A.3, Appendix A) as follows:

(s + λ(1)

a0 + λ(2)

a0 )φ(0)

a0 (s) − µ(2)

a1 φ(0)

a1 (s) = 1, and

(s + λ(1)

a,b−1 + λ(2)

a,b−1 + µ(2)

a,b−1 + γa,b−1)φ(0)

a,b−1(s) − λ(2)

a,b−2φ(0)

a,b−2(s) − µ(2)

Comparing the sequences in (12) with (9), we deduce that L−1(cid:104)
ab (t) is a probability distribution, we have (cid:80)
transform of the previous equation, we get(cid:80)

(a,b)∈N×N P a00

P a00

ab (t) = 1. Taking the Laplace

(a,b)∈N×N φ(0)

ab (s) = 1/s. Hence, limb→∞ φ(0)

a0b(s) =

ab φab(s) = 0, b ≥ 2.
(cid:105)

(12)

φ(0)
ab (s)

= P a00

ab (t). Since

0 for every s > 0. By Lemma A.1 (Appendix A), φ(0)

a0 (s) converges for every s > 0, and

b(cid:89)

i=1

xai

φ(0)
ab (s) =

(13)

xa,b+1

Ya,b+1 +

ya,b+2 +

xa,b+2Yab

xa,b+3

ya,b+3 +

xa,b+4

ya,b+4 + ··· ,

10

where Yab is the denominator of the bth convergent of φ(0)

a0 (s).

From (9), we note that

(s + λ(1)

a0b + λ(2)

a0b + µ(2)

a0b + γa0b)fa0b − λ(2)

a0,b−1fa0,b−1(s)− µ(2)

a0,b+1fa0,b+1(s) = 1{b=b0}, b ∈ N. (14)

By Lemma A.2 (Appendix A), fa0b(s) = φ(b0)

a0b (s) where

 (−1)m−b+1Yab

(cid:81)m+1
(cid:81)m+1

µ(2)
a,m+1

−Yam

µ(2)
a,m+1

i=1 xai

i=1 xai

φ(m)
ab (s) =

φ(0)
am(s),

φ(0)
ab (s),

if b ≤ m
if b ≥ m.

(15)

Next, we obtain formulae for approximating fab(s) recursively assuming that we already

have evaluated fa−1,b(s). Again, from (2), we have

(s+λ(1)

ab +λ(2)

ab +µ(2)

ab +γab)fab(s)−λ(2)

a,b−1fa,b−1(s)−µ(2)

a,b+1fa,b+1(s) = λ(1)

a−1,bfa−1,b(s)+γa−1,b+1fa−1,b+1(s),

(16)
for b ∈ N. We approximate fab(s) by solving a truncated version of (16) for 0 ≤ b ≤ B,

where B is suﬃciently large. The intuition of how to choose B follows from the observation

that we want (cid:80)∞

the following approximation:

a=a0

(cid:80)∞
fab(s) ≈ B(cid:88)

b=B+1 P a0b0

ab

(t) to be small. By Lemma A.2 (Appendix A), we have

(cid:104)

λ(1)
a−1,mfa−1,m(s) + γa−1,m+1fa−1,m+1(s)

(cid:105)

φ(m)
ab (s).

(17)

m=0

Therefore, the transition probabilities of a birth/birth-death process can be computed re-

cursively using the following Theorem:

Theorem 2. Let φ(m)

ab (s) be deﬁned as in (11), (13), and (15). We have

P a0b0

ab

(t) =

L−1 [fab(s)] (t),

if a < a0
if a ≥ a0,

(18)

0,

11

where fa0b(s) = φ(b0)

a0b (s) and

fab(s) ≈ B(cid:88)

(cid:104)

λ(1)
a−1,mfa−1,m(s) + γa−1,m+1fa−1,m+1(s)

(cid:105)

φ(m)
ab (s), a > a0.

(19)

m=0

Here, L−1(.) denotes the inverse Laplace transform and B is the truncation level.

If the number of type 2 particles is bounded by B∗, we choose B = B∗. In this case, the

approximation in Theorem 2 is exact.

2.1.3 Numerical approximation of the transitions probabilities

To approximate P a0b0

fractions φ(m)

ab

(t) using Theorem 2, we need to compute two quantities: the continued
ab (s), and the inverse Laplace transform L−1 [fab(s)] (t). We eﬃciently evaluate
ab (s) through the modiﬁed Lentz method (Lentz, 1976; Thompson

the continued fractions φ(m)

and Barnett, 1986); see Appendix B for more details. This algorithm enables us to control
for and limit truncation error. To approximate the inverse Laplace transform L−1 [fab(s)] (t),

we apply the method proposed in Abate and Whitt (1992) using a Riemann sum:

(cid:20)

(cid:18)H

(cid:19)(cid:21)

∞(cid:88)

k=1

(cid:20)

(cid:18) H + 2kπi

(cid:19)(cid:21)

L−1 [fab(s)] (t) ≈ eH/2
2t

R

fab

2t

+

eH/2

t

(−1)kR

fab

.

(20)

2t

Here R[z] is the real part of z and H is a positive real number. Abate and Whitt (1992)
show that the error that arises in (20) is bounded by 1/(eH − 1). Moreover, we can use the

Levin transform (Levin, 1973) to improve the rate of convergence because the series in (20)
is an alternating series when R{fab[(H + 2kπi)/(2t)]} have the same sign. These numerical

methods have been successfully applied by Crawford and Suchard (2012) to compute the

transition probabilities of birth-death processes.

In practice, to handle situations where µ(2)

ab can possibly equal to 0 for some (a, b), we

12

re-parametrize xab and yab as follows:

xa1 = 1; xab = −λ(2)

a,b−2µ(2)

a,b−1, b ≥ 2, and

yab = s + λ(1)

a,b−1 + λ(2)

a,b−1 + µ(2)

a,b−1 + γa,b−1, b ≥ 1.

With this new parametrization, we obtain



φ(m)
ab (s) =

(21)

(22)

((cid:81)m

i=b+1 µ(2)

ai )Yab

if b ≤ m

,

Ya,m+1 +

ya,m+2 +

xa,m+2Yam

xa,m+3

ya,m+3 +

xa,m+4

ya,m+4 + ···

((cid:81)b

i=m+1 λ(2)

ai )Yam

,

if b ≥ m.

Ya,b+1 +

ya,b+2 +

xa,b+2Yab

xa,b+3

ya,b+3 +

xa,b+4

ya,b+4 + ···

We implement our complete algorithm to compute the transition probabilities of birth/birth-

death processes in the function bbd prob in a new R package called MultiBD. The function

ab , λ(2)

ab , µ(2)

ab , γab, A, B as inputs and returns the transition probability
(t)}a0≤a≤A,0≤b≤B. Here, there is no requirement for A while B needs to be large
(t) is small. We can check to see if B is large enough

(cid:80)∞

b=B+1 P a0b0

ab

takes t, a0, b0, λ(1)
matrix {P a0b0

enough such that(cid:80)A
by checking if(cid:80)A

ab

a=a0

a=a0
P a0b0

aB (t) is suﬃciently small.

In practice, the computational complexity of evaluating each term (fab(s))a0≤a≤A,0≤b≤B
is O((A − a0)B2) because the Lentz algorithm terminates quickly. Let K be the number

of iterations required by the Levin acceleration method (Levin, 1973) to achieve a certain

error bound for the Riemann sum in (20). Then, the total complexity of our algorithm is

13

O((A − a0)B2K). However, evaluation of {fab[(H + 2kπi)/(2t)]}K

k=1 can be eﬃciently paral-

lelized across diﬀerent values of k, and we exploit this parallelism via multicore processing,

delegating most of the computational work to compiled C++ code.

2.2 Death/birth-death processes

Similar to the birth/birth-death process, a death/birth-death process is also a special case

of competition processes. The only diﬀerence is that the number of type 1 particles is

decreasing instead of increasing. Mathematically, possible transitions of a death/birth-death

process X(t) = (X1(t), X2(t)) during (t, t + dt) are:

X2(t) = b

X1(t) = a

X2(t + dt) = b

X2(t + dt) = b + 1 X2(t) = b

 X1(t + dt) = a − 1 X1(t) = a
 X1(t + dt) = a
 X1(t + dt) = a
 X1(t + dt) = a − 1 X1(t) = a
 X1(t + dt) = a

X1(t) = a
X2(t + dt) = b − 1 X2(t) = b

X2(t + dt) = b + 1 X2(t) = b

X2(t + dt) = b

X1(t) = a

X2(t) = b

ab dt + o(dt)

ab dt + o(dt)

 = µ(1)
 = λ(2)
 = µ(2)
 = γabdt + o(dt)
 = 1 − (µ(1)

ab dt + o(dt)

Pr

Pr

Pr

Pr

Pr

ab + λ(2)

ab + µ(2)

ab + γab)dt + o(dt),

(23)

where µ(1)

ab ≥ 0 is the death rate of type 1 particles given a type 1 particles and b type 2
ab ≥ 0 is the death rate of type
2 particles, and γab is the transition rate from type 1 particles to type 2 particles. Again,

ab ≥ 0 is the birth rate of type 2 particles, µ(2)

particles, λ(2)

we ﬁx µ(1)

0,b = λ(2)

a,−1 = µ(2)

0,b = γ0,b = γa,−1 = 0.

Following a similar argument as in Section 2.1.1, we obtain a suﬃcient condition for

14

regularity of a death/birth-death process. Denote

Dk = {(a, b) : a + b = k, a ≤ a0} ∈ N × N

λk = max
(a,b)∈Dk

µk = min
(a,b)∈Dk

ab }
{λ(2)
{µ(1)

σ0 = 1, σk =

ab }
ab + µ(2)
λ0 . . . λk−1
µ1 . . . µk

,

(24)

where a0 is the number of type 1 particles at time t = 0. The following Theorem is a direct

application of Theorem 1 in Iglehart (1964)

Theorem 3. A suﬃcient condition for regularity of a death/birth-death process is

(cid:33)

(cid:32)

∞(cid:88)

k=0

k(cid:88)

i=0

1

λkσk

= ∞.

(25)

σi

We note that if we do a transformation for a death/birth-death process X(t) = (X1(t), X2(t))

as follows:

Y1(t) = a0 − X1(t)
Y2(t) = B − X2(t).

(26)

Then, Y(t) = (Y1(t), Y2(t)) can be considered as a birth/birth-death process. Therefore,

the transition probabilities of a death/birth-death process can also be computed using the

(cid:80)a0

(cid:80)∞

a=0

b=B+1 P a0b0

ab

R function bbd prob and the transformation (26). Again, we want to choose B such that

(t) is small. We implement this procedure in the function dbd prob in

our R package MultiBD. The function takes t, a0, b0, µ(1)
returns the transition probability matrix {P a0b0

ab , γab, A, B as inputs and
(t)}A≤a≤a0,0≤b≤B. As for birth/birth-death

ab , λ(2)

ab , µ(2)

ab

processes, there is no requirement for A.

15

3 Applications

Birth(death)/birth-death processes are appropriate for modeling two-type populations where

the size of the ﬁrst population is monotonically increasing (decreasing). Here we examine

our methods in three applications: a within-host macro-parasite model, a birth-death-shift

model for transposable elements, and the stochastic SIR epidemiological model. We demon-

strate that a birth (death)/birth-death process well captures the dynamics of these common

biological problems, and inference using its transition probabilities often outperforms ex-

isting approximations. In particular, we emphasize that the birth (death)/birth-death pro-

cess approach allows us to compute ﬁnite-time transition probabilities in the stochastic SIR

model that were previously considered unknown or intractable without model simpliﬁcation

(Cauchemez and Ferguson, 2008).

3.1 Birth-death-shift model for transposable elements

Transposable elements or transposons are genomic sequences that can either duplicate, with

a new copy moving to a new genomic location, move to a diﬀerent genomic location, or

be deleted from the genome. Rosenberg et al. (2003) model the number of copies of a

particular transposon using a linear birth-death-shift process; a birth is a duplication event,

a death is a deletion event, and shift is a switching position event. Xu et al. (2015) propose

representing this birth-death-shift process by a linear multi-type branching process X(t) =

(Xold(t), Xnew(t)) tracking the number of occupied sites where Xold(t) is the number of initially

occupied sites and Xnew(t) is the number of newly occupied sites. Let λ, µ, and ν be the

birth, death, and shift rates respectively. The transitions of X(t) during a small time interval

16

occur with probabilities

Xnew(t) = xnew

Xnew(t + dt) = xnew

Xold(t) = xold
Xnew(t + dt) = xnew − 1 Xnew(t) = xnew

 Xold(t + dt) = xold − 1 Xold(t) = xold
 Xold(t + dt) = xold
 Xold(t + dt) = xold
 Xold(t + dt) = xold − 1 Xold(t) = xold
 Xold(t + dt) = xold

Xnew(t + dt) = xnew + 1 Xnew(t) = xnew

Xnew(t + dt) = xnew + 1 Xnew(t) = xnew

Xnew(t + dt) = xnew

Xold(t) = xold

Xold(t) = xold

Xnew(t) = xnew

Pr

Pr

Pr

Pr

Pr

 = (µxold)dt + o(dt),
 = (µxnew)dt + o(dt),
 = λ(xold + xnew)dt + o(dt),
 = (νxold)dt + o(dt), and
 = 1 − (µ + λ + ν)xold − (µ + λ)xnewdt + o(dt).

(27)

Equivalent to the branching process representation, notice that in this case X(t) is also a

death/birth-death process. Hence, we can eﬀectively compute its transition probabilities. In

contrast, Xu et al. (2015) consider the probability generating function

Φa0b0(t, s1, s2) = E(cid:16)

sXold(t)
1

sXnew(t)
2

where

P a0b0

ab

(t) = Pr

|Xold(0) = a0, Xnew(0) = b0

(cid:17)
∞(cid:88)
∞(cid:88)
 .
 Xold(t) = a Xold(0) = a0

Xnew(0) = b0

Xnew(t) = b

a=0

b=0

=

P a0b0

ab

(t)sa

1sb

2, (28)

(29)

Because of the model-speciﬁc linearity in terms of a and b of the birth and death rates, one

can evaluate Φjk(t, s1, s2) by solving an ordinary diﬀerential equation. Further transforming

17

s1 = e2πiw1, s2 = e2πiw2, the generating function becomes a Fourier series

Φa0b0(t, e2πiw1, e2πiw2) =

P a0b0

ab

(t)e2πiaw1e2πibw2.

(30)

∞(cid:88)

∞(cid:88)

a=0

b=0

Therefore, Xu et al. (2015) retrieve the transition probabilities through

(cid:90) 1

0

(cid:90) 1
H−1(cid:88)

0

H−1(cid:88)

≈ 1
H 2

u=0

v=0

P a0b0

ab

(t) =

Φa0b0(t, e2πiw1, e2πiw2)e−2πiaw1e−2πibw2dw1dw2

Φjk(t, e2πiu/H, e2πiv/H)e−2πiau/He−2πibv/H,

(31)

where H is chosen suﬃciently large such that the Riemann approximation is accurate. Evalu-
ating {P a0b0
(t)}0≤a,b≤H requires numerically solving H 2 linear ordinary diﬀerential equations

ab

(ODEs). The authors implement this method in the R package bdsem. We perform a simu-

lation to compare the performance between bdsem and our function dbd prob. We use both

functions to compute the transition probabilities of a birth-death-shift process with rates

λ = 0.0188, µ = 0.0147, ν = 0.00268 (estimated from the IS6110 data by Rosenberg et al.
ab (t)}0≤a≤10,0≤b≤50 at three
(2003)) repeatedly a hundred times. Speciﬁcally, we compute {P 10,0
diﬀerent evaluation times t = 1, 5, 10. We use a single thread option for dbd prob. The CPU

matrices U = (uij) and V = (vij) are deﬁned as (cid:107)U − V(cid:107) =(cid:80)

time ratios of bdsem to dbd prob are summarized in Figure 1. The L1 distance between two
estimated transition probabilities is less than 4 × 10−8. Here, the L1 distance between two
i,j |uij − vij|. We see that
dbd prob is about 15 to 30 times faster than the bdsem implementation, while producing

very similar results.

We cannot immediately conclude that our method is faster then the method in Xu et al.

(2015) because computation time depends heavily on implementation. Nonetheless, we can

make some remarks about the performance of both methods. Notably, the bdsem imple-

mentation grows slower as t increases while dbd prob does not. This is expected because

solving ODEs is slower when the domain increases. However, it is worth mentioning that

18

we can use the solution paths to get the solutions of these ODEs at other time points in

the domain. For example, when we solve the ODEs at t = 10, we also get the solutions

at t = 1 and 5 for free. This point becomes important in applications where we need to

compute the transition probabilities at several time points. Another downside of bdsem is
ab (t)}0≤a≤10,0≤b≤50 directly like
that it computes {P 10,0

ab (t)}0≤a,b≤50 instead of evaluating {P 10,0

dbd prob.

Figure 1: CPU compute time ratios of bdsem to dbd prob (left) over 100 replications.

3.2 Within-host macro-parasite model

Riley et al. (2003) posit a stochastic model to describe a within-host macro-parasite pop-

ulation where Brugia pahangi is the parasite and Felis cactus is the host. Brugia pahangi

is closely related to Brugia malayi which infects millions of people in South and Southeast

Asia. The model tracks the number of B. pahangi larvae L(t), the number of mature parasites
M (t), and hosts experience of infection I(t) at time t. The dynamics of {L(t), M (t), I(t)}

19

lllllllllllllllllllllllllllllllllllllllllllllll152025301510time (t)CPU time ratiofollow a system of diﬀerential equations:

(t) = −µLL(t) − βI(t)L(t) − γL(t),
(t) = γL(t) − µM M (t), and
(t) = νL(t) − µII(t)

dL
dt
dM
dt
dI
dt

(32)

where µL is the natural death rate and γ is the maturation rate of larvae; β is the death

rate of larvae due to the immune respond from the host; µM is the death rate of mature

parasites; ν is the acquisition rate and µI is the loss rate of immunity.

Drovandi and Pettitt (2011) propose a simpliﬁcation of this model by applying a pseudoe-

quilibrium assumption for immunity, such that the immunity is constant over time. Under
this pseudoequilibrium assumption, the dynamics of {L(t), M (t)} becomes

(t) = −µLL(t) − η[L(t)]2 − γL(t), and
(t) = γL(t) − µM M (t)

dL
dt
dM
dt

(33)

where η = βν/µI. We illustrate the dynamic of (33) in Figure 2. The corresponding

20

stochastic formulation of this model is:

M (t + dt) = j + 1 M (t) = j

 L(t + dt) = i − 1 L(t) = i
 L(t + dt) = i − 1 L(t) = i
 L(t + dt) = i
 L(t + dt) = i

L(t) = i
M (t + dt) = j − 1 M (t) = j

M (t + dt) = j

M (t) = j

 = (γi)dt + o(dt),
 = (µLi + ηi2)dt + o(dt),
 = (µM j)dt + o(dt), and
 = 1 − (γi + µLi + ηi2 + µM j)dt + o(dt).

(34)

Pr

Pr

Pr

Pr

M (t + dt) = j

M (t) = j

L(t) = i

Notably, {L(t), M (t)} follow a death/birth-death process.

Figure 2: The dynamic of {L(t), M (t)} under the deterministic model (33) with µL =
0.0682, µM = 0.0015, η = 0.0009, γ = 0.04 and {L(0), M (0)} = {100, 0}.

For this model, γ and µM has been estimated at 0.04 and 0.0015 previously (see Drovandi

and Pettitt, 2011, for more details). To estimate the remaining parameters, Drovandi and

21

02550751000100200300400DayPopulationParasiteLarvaeMaturePettitt (2011) examine the number of mature parasites at host autopsy time (at most 400

days) of those injected with approximately 100 juveniles, assume a priori µL and η are

uniform[0,1) and apply ABC to draw inference because the traditional matrix exponentiation

method is computationally prohibitive. The basic idea of ABC involves sampling from an

approximate posterior distribution

f (θ, Y |ρ(Y, Ys) ≤ ) ∝ f (Ys|θ)π(θ)1ρ(Y,Ys)≤,

(35)

where θ is the vector of unknown parameters,  > 0 is an ad hoc tolerance, and ρ(Y, Ys) is a

discrepancy measure between summary statistics of the observed data Y and the simulated

data Ys. Because the suﬃcient statistics are not available for this problem, the authors use

a goodness-of-ﬁt statistic. However, the ABC method can suﬀer from loss of information

because of non-zero tolerance and non-suﬃcient summary statistics (Sunn˚aker et al., 2013).

Therefore, the credible intervals obtained by the ABC approach are potentially inﬂated

(Csill´ery et al., 2010).

In Figure 3, we apply our method to directly visualize the posterior density surface of

(log µL, log η) given the collection of numbers of mature parasites M (t) at autopsy under

this model (see Drovandi and Pettitt, 2011, for more details about the data). Importantly

for this posterior, we are able to eﬃciently integrate out the unobserved larvae counts L(t)

at autopsy. We note that the posterior is ﬂat when η is close to 0, and has an unusual tail

toward the estimate of the ABC method. We suspect that the ABC method fails to explore

the region with high posterior probability because of the loss of information.

3.3 Stochastic SIR model in epidemiology

McKendrick (1926) models the spread of an infectious disease in a closed population by

dividing the population into three categories: susceptible persons (S), infectious persons (I)

and removed persons (R). Since the population is closed, the total population size N obeys

22

Figure 3: Posterior density surface of (log µL, log η) under within-host macro-parasite model.
The “×” symbol represents the estimate from Drovandi and Pettitt (2011) using the ABC
method.

the conservation equation N = S(t) + I(t) + R(t) for all time t. The deterministic dynamics

of these three subpopulations follow a system of nonlinear ordinary diﬀerential equations

(Kermack and McKendrick, 1927):

(t) = −βS(t)I(t),
(t) = βS(t)I(t) − αI(t), and

(t) = αI(t),

(36)

dS
dt
dI
dt
dR
dt

where α > 0 is the removal rate and β > 0 is the infection rate of the disease. This system

of equations cannot be solved analytically, but we can obtain its solution numerically. The

23

−11−10−9−8−7−6−3.0−2.7−2.4−2.1log (mL)log (h)simplest approach is via an implicit Euler’s method (Earn, 2008):

S(t + ∆t) = S(t) − βS(t)I(t)∆t, and
I(t + ∆t) = I(t) + βS(t)I(t)∆t − αI(t)∆t,

(37)

where the step size ∆t is suﬃciently small. An important quantity for the SIR model is the

basic reproduction number R0 = βN/α (Earn, 2008). This quantity determines whether a

spread of an infectious disease becomes an epidemic. In particular, an epidemic can only

occur when R0 > 1.

Unfortunately, the deterministic model is not suitable when the community is small

(Britton, 2010). In these situations, the original stochastic SIR model (McKendrick, 1926)

becomes more appropriate. Moreover, Andersson and Britton (2000) argue that stochastic

epidemic models are preferable when their analysis is possible because (1) stochastics are

the most natural way to describe a spread of diseases, (2) some phenomena do not satisfy

the law of large numbers and can only be analyzed in the stochastic setting (for example,

the extinction of endemic diseases only occurs when the epidemic process deviates from

its expected value), and (3) quantifying the uncertainty in estimates requires stochastic

models. Nonetheless, one can bypass Andersson and Britton’s third argument by imposing

random sampling errors around the deterministic compartments. Therefore, it is important

to distinguish between the deterministic SIR model with sampling errors and the stochastic

SIR model.

Without loss of generality, the stochastic SIR model needs only track S(t) and I(t)
because S(t) + I(t) + R(t) remains constant. All possible transitions of {S(t), I(t)} during

24

a small time interval (t, t + dt) occur with probabilities

S(t) = s

I(t) = i

I(t + dt) = i − 1

 S(t + dt) = s
 S(t + dt) = s − 1 S(t) = s
 S(t + dt) = s

I(t + dt) = i + 1

I(t + dt) = i

S(t) = s

Pr

Pr

Pr

 = (αi)dt + o(dt),
 = (βsi)dt + o(dt), and
 = 1 − (αi + βsi)dt + o(dt).

I(t) = i

I(t) = i

(38)

We see that {S(t), I(t)} is a death/birth-death process with µ(1)

si = λ(2)

s,i = 0, µ(2)

s, = αi,

γsi = βsi.

Due to the interaction between populations and nonlinear nature of the model, mechanis-

tic analysis of the stochastic SIR model is diﬃcult, and the lack of an expression for transition

probabilities has been a bottleneck for statistical inference. Renshaw (2011) remarks that

while one can write out the Kolmogorov forward equation for the system, the “associated

mathematical manipulations required to generate solutions can only be described as heroic.”

Instead, the majority of eﬀorts involve either simulation based methods or simpliﬁcations

and tractable approximations to the SIR model. For instance, the stochastic SIR model can

be analyzed using ABC (McKinley et al., 2009), but we have already mentioned limitations

of this approach. Particle ﬁlter methods can be used to analyze SIR models within maximum

likelihood (Ionides et al., 2006, 2015) and Bayesian frameworks (Andrieu et al., 2010; Dukic

et al., 2012), but these methods are computationally very demanding and often suﬀer from

convergence problems. When examining large epidemics, to make the likelihood tractable

it is reasonable to apply a continuous approximation to the large populations, modeled as

a diﬀusion process with exact solutions (Cauchemez and Ferguson, 2008). However, such

an approach is a poor proxy for the SIR model when observed counts are low. When data

are collected at regular intervals and coincide with disease generation timescales, it is also

25

possible to study discrete-time epidemic models— the time-series SIR (TSIR) model is one

well-known example (Finkenst¨adt and Grenfell, 2000). However, these simpliﬁcations also

have their shortcomings, relying on the relatively strong assumption that populations are

constant over each interval between observation times.

In the death/birth-death framework, our method enables practical computation of these

quantities without any simplifying model assumptions.

In Section 4, we will apply our

method to analyze the population of Eyam during the plague of 1666 (Raggett, 1982) to es-

timate the infection and the death rates of this disease, using the death/birth-death transition

probabilities within a Metropolis-Hastings algorithm. Here, we ﬁrst examine the accuracy

of these transition probabilities themselves. We compare the continued fraction method to

empirical transition probabilities obtained via simulation from the true model as ground-

truth, and to a new two-type branching approximation to the SIR model introduced below.

The branching process approximation is appropriate when transition probabilities need to

be computed for short time intervals, and its simple expressions for transition probabili-

ties enable much more eﬃcient computation. However, we show that as transition time

intervals increase, the branching approximation becomes less accurate, while the transition

probabilities computed under the death/birth-death model remain very accurate.

While branching processes fundamentally rely on independence of each member of the

population, we can nonetheless make a fair approximation by mimicking the interaction

eﬀect of infection over short time intervals. In the branching model, let X1(t) denote the

susceptible population and X2(t) denote the infected population at time t, with details and

derivation included in Appendix C. Over any time interval [t0, t1), we use the initial popu-

lation X2(0) as a constant scalar for the instantaneous rates. This branching process model
has instantaneous infection rate βX2(0)X1(t) and recovery rate αX2(t) for all t ∈ [t0, t1),

closely resembling the true SIR model rates, with the exception of ﬁxing X2(0) in place of

X2(t) in the rate of infection. This constant initial population ﬁxes a piecewise homoge-

neous per-particle birth rate to satisfy particle independence while mimicking interactions,

26

but notice that both populations can change over the interval, oﬀering much more ﬂexibility

than models such as TSIR that assume constant populations and rates between discrete

observations.

This branching model admits closed-form solutions to the transition probabilities that can

be evaluated quickly and accurately. The transition probabilities of the two-type branching

approximation to the SIR model over any time interval of length t are given by

l(cid:88)

Pr{X(t + τ ) = (k, l)|X(τ ) = (m, n)} := P kl

mn(t) =

i=0

B(i) = 0 for all i ≤ n, otherwise,
(1 − e−αt)n−ie−iαt

B(i) =

n!

(n − i)!

where

and

A(l − i)B(i),

(39)

(40)

A(l − i) = 0 for all (l − i) ≤ (m − k), otherwise,
A(l − i) =

1 − βn

e−kβnt

m!

e−αt −

(cid:20)

(cid:18)

1 − βn

βn − α

(cid:19)

e−βnt

(cid:21)m−k−l−i

(cid:20) βn

(m − k − l − i)!
×

βn − α

(e−αt − e−βnt)

βn − α

(cid:21)l−i

.

(41)

The sum over products of expressions (40) and (41) in equation (39) may look unwieldy,

but this sum is computed extremely quickly with a vectorized implementation, and with

high degrees of numerical stability.
In settings when such a model is appropriate and
(X1(t), X2(t)) ≈ (S(t), I(t)), the branching approximation can oﬀer a much more computa-

tionally eﬃcient alternative to the continued fraction method.

27

Figure 4: The plot above displays the values of the nine largest transition probabilities when
t = 0.5 as we vary t from 0.1, . . . , 1.0. Parameters used to generate data are initialized at
I0 = 15, S0 = 110, α = 3.2, β = 0.025. Empirical Monte Carlo 95% conﬁdence intervals over
150, 000 simulations from the true model are depicted in orange. Probabilities computed
using the continued fraction expansion are depicted by purple triangles, while probabilities
computed under the branching approximation are denoted by green squares.

28

MCp0.20.40.60.81.00.0000.0040.008tpmArray[, 2, inds[1, i], inds[2, i]]MCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]Comparison of largest transition probabilitiesMCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]MCp0.20.40.60.81.00.0000.0040.008tpmArray[, 2, inds[1, i], inds[2, i]]Transition probabilityMCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]MCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]MCp0.20.40.60.81.00.0000.0040.008tpmArray[, 2, inds[1, i], inds[2, i]]MCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]Time interval length (dt)MCp0.20.40.60.81.0tpmArray[, 2, inds[1, i], inds[2, i]]Fraction95% CIBranch3.4 Transition probabilities of the SIR model

Figure (4) provides a comparison between methods of computing transition probabilities. In-
cluded are transition probabilities corresponding to the nine pairs of system states {(m, n), (k, l)}j,
j = 1, . . . , 9, such that P kl

mn(t)(cid:9) while varying t between 0.1 and 1.0. We see that transition probabilities

bilities(cid:8)P kl

mn(0.5) is largest. Fixing these indices, we plot the set of proba-

computed using the continued fraction method under the death/birth-death model very

closely match those computed empirically via simulation from the model, taken to be the

ground truth. Almost all such probabilities in Figure 4 fall within the 95% conﬁdence inter-

val, while the branching process transitions follow a similar shape over time, but fall outside

of the conﬁdence intervals for many observation intervals. An additional heatmap visual-

ization comparing the support of transition probabilities is included in the Appendix, and

shows that the branching approximation is accurate with similar support to the empirical

transition probabilities for a shorter time interval of length t = 0.5, but becomes visibly

further from the truth when we increase the observation length to t = 1.0.

4 The Plague in Eyam revisited

We revisit the outbreak of plague in Eyam, a village in the Derbyshire Dales district, England,

over the period from June 18th to October 20th, 1666. This plague outbreak is widely

accepted to originate from the Great Plague of London, that killed about 15% of London’s

population at that time. To prevent further spread of the plague after infestation, the Eyam

villagers did not escape the village, instead isolating themselves from the outside world. At

the end of this horriﬁc event, only 83 people had survived out of an initial population of

350. We summarize data recording the spread of the disease (Raggett, 1982) in Table 1. As

mentioned in Raggett (1982), this data are obtained by counting the number of deaths from

the dead list and estimating the infective population from the list of future deaths assuming

a ﬁxed length of illness prior to death. Then, the susceptible population can be computed

29

easily because the the town is isolated.

0
Susceptible population 254
7
Infective population

0.5
235
14

Time (months)
1
201
22

2
121
20

1.5
153
29

2.5
110
8

3
97
8

4
83
0

Table 1: Susceptible and infectious population size in Eyam from June 18th to October 20th,
1666.

Raggett (1982) analyzes these data using the stochastic SIR model (38). In this model, α is

the unknown death rate of infective people and β is the unknown infection rate of the plague.

The author uses a simple approximation method for the forward diﬀerential equation and

comes up with a point estimate (ˆα, ˆβ) = (3.39, 0.0212). We take a Bayesian approach to

re-analyze these data.

With n observations {(sk, ik)}n

log l(cid:0)α, β(cid:12)(cid:12){(sk, ik)}n

k=1

k=1 at time {tk}n
n−1(cid:88)

(cid:1) =

log Pr

k=1

k=1, the log of the likelihood function is:

 S(tk+1) = sk+1 S(tk) = sk

I(tk+1) = ik+1

I(tk) = ik

.

(42)

Because {S(t), I(t)} is a death/birth-death process, the individual transition probabilities

can be computed eﬃciently using our continued fraction method. Hence, the log of the

likelihood (42) can be computed easily. Since α and β are non-negative, we opt to use log α
and log β as our model parameters and assume a priori that log α ∼ N (µ = 0, σ = 100)
and log β ∼ N (µ = 0, σ = 100). We explore the posterior distribution of (log α, log β)

using a random-walk Metropolis algorithm implemented in the R function MCMCmetrop1R

from package MCMCpack (Martin et al., 2011). We start the chain from Raggett’s estimated

value (log(3.39), log(0.0212)) and run it for 100000 iterations. We discard the ﬁrst 20000

iterations and summarize the posterior distribution of (α, β) using the remaining iterations.

We illustrate the density of this posterior distribution in Figure 5(a). The posterior mean of α

is 3.22 and the 95% Bayesian credible interval for α lies in (2.69, 3.82). Those corresponding

30

quantities for β are 0.0197 and (0.0164, 0.0234). Notice that our credible intervals include

the point estimate (ˆα, ˆβ) = (2.73, 0.0178) from Brauer (2008) using the deterministic SIR

model and Raggett’s point estimate (ˆα, ˆβ) = (3.39, 0.0212).

We also apply the two-type branching approximation to compute the log of the likelihood

(42). Using the same random-walk Metropolis algorithm as before, we explore the posterior

distribution of (α, β) and visualize it in Figure 5(b). The posterior mean of α is 3.237 and the

95% Bayesian credible interval for α is (2.7, 3.84), while those quantities for β are 0.02 and

(0.0171, 0.023). Although the posterior means and the 95% Bayesian credible intervals are

similar to ones from the continued fraction method, we see in Figure 5(b) that this method

fails to fully capture the posterior correlation structure between α and β.

(a) Continued fraction method

(b) Branching approximation method

Figure 5: Posterior distributions (log scale) of the death rate α and the infection rate β
during the plague of Eyam in 1666. The “+” symbol represents the estimate from Brauer
(2008) using the deterministic SIR model, and the “×” symbol represents the Raggett’s
point estimate.

The posterior distribution of the basic reproduction number R0 from the continued frac-

tion method and from the branching approximation method are similar (Figure 6). The

posterior mean of R0 from the continued fraction method is 1.61 and from the branching

31

−4.1−4.0−3.9−3.81.01.11.21.3log (a)log (b)−4.1−4.0−3.9−3.81.01.11.21.3log (a)log (b)approximation method is 1.62. The estimate for R0 from Brauer (2008) is 1.7, from Raggett

(1982) is 1.63. These estimates are similar, and in particular the branching approximation

estimate is very close to that under the continued fraction method, oﬀering a very eﬃcient

way to provide reasonable estimates of quantities such as R0 despite being less accurate than

the continued fraction approach.

Figure 6: Posterior distribution of the basic reproduction number R0 (solid line: contin-
ued fraction method, dashed line: branching approximation method). The “+”, and the
“×” symbols represent the estimate of R0 from Brauer (2008), and from Raggett (1982)
respectively.

From the results, we can see that estimates of R0 from diﬀerent methods are roughly the

same while estimates of α and β are diﬀerent. Although the basic reproduction number R0

is an important quantity in the SIR model, it is not the only parameter driving the dynamic

of the epidemic. Correia-Gomes et al. (2014) demonstrated the important of accurately esti-

mating the transmission parameters between compartments of the SIR model for Salmonella

Typhimurium in pigs.

To facilitate understanding diﬀerences between estimates from deterministic and stochas-

tic SIR models, we simulate 1000 data sets according to the stochastic SIR model with

32

0.00.51.01.52.01.01.52.02.5Basic reproduction number R0density(α, β) = (3.2, 0.0197) and {S(0), I(0)} = (254, 7). Each data set contains values of {S(t), I(t)}
for t = {0, 0.5, 1, 1.5, 2, 2.5, 3, 4}. For each data set, we estimate (α, β) using a least-squares

method for the deterministic model following Chowell et al. (2006) and a maximum likeli-

hood estimator for the stochastic model. Figure 7 (left and middle) shows the diﬀerence

between estimated values and true values of α and β under both methods. We can see that

the estimates under the stochastic model are preferred over the estimates under determinis-

tic model. The mean square errors (MSE) under the deterministic model (MSE(α) = 0.644,
MSE(β) = 2.376×10−5) is about 6 times larger than the mean square errors under stochastic
model (MSE(α) = 0.1, MSE(β) = 0.406 × 10−5). We note that the estimated values for α

are biased for both methods while the estimated values for β remain relatively unbiased.

On the other hand, the estimates of R0 under both models are very similar, except for four

outliers under the deterministic model (Figure 7, right). The MSE for estimates of R0 under

the deterministic model (excluding those outliers) is 0.051 and under the stochastic model

is 0.06.

Figure 7: Diﬀerence between estimated values and true values of the death rate α (left), the
infection rate β (middle), and the basic reproduction number R0 (right) under deterministic
and stochastic SIR models, based on simulated stochastic observations.

33

lllllllllllllllllllllllllllllllll−2024DeterministicStochasticModela^-alllllllllllllllllllll−0.010.000.010.020.03DeterministicStochasticModelb^-blllllllllllllllllllllll0.02.55.07.510.0DeterministicStochasticModelR^0-R05 Discussion

Likelihood-based inference for bivariate continuous-time Markov processes is usually re-

stricted to very small state spaces due to the computational bottleneck of transition proba-

bility calculation. Therefore, in the majority of applications, researchers turn to potentially

poor estimation from diﬀusion approximation methods or appeal to indirect, likelihood-free

approaches such as ABC. In this paper, we provide tools for likelihood-based inference for

birth(death)/birth-death processes by developing an eﬃcient method to compute their tran-

sition probabilities. We provide a complete implementation of the algorithms to compute

these transition probabilities in a new R package called MultiBD. Our functions employ so-

phisticated tools including continued fractions, the modiﬁed Lentz method, the method of

Abate and Whitt for approximate inverse Laplace transforms, and the Levin acceleration

method. Moreover, these methods are naturally amenable to parallelization, and we exploit

multicore processing to speed up the algorithm.

We discuss three scientiﬁc applications for birth(death)/birth-death processes, and per-

form several simulations in these settings comparing our new continued fraction method to

alternative methods such as generating function approaches and ABC. In the birth-death-

shift model of transposon evolution, our death/birth-death implementation (dbd prob) is

about 15 to 30 times faster than the generating function method of Xu et al. (2015) in the

R package bdsem. The method for the ﬁrst time enables us to compute the observed data

likelihood surface of macro-parasite evolution model that was previously analyzed using ap-

proximate methods (Drovandi and Pettitt, 2011). We additionally propose a novel two-type

branching approximation for the SIR model that admits analytic formulae for its transition

probabilities. Consequently, under this approximation, the generating function method is

more computationally eﬃcient than the continued fraction method. We show that accu-

rate estimates of quantities such as basic reproduction number can be obtained using this

method; nonetheless, simulations show that the continued fraction method outperforms in

terms of transition probability accuracy when compared to Monte Carlo estimates from the

34

true model.

We also apply our proposed method to analyze the Eyam plague catastrophe under the

stochastic SIR model. We demonstrate that the estimates for the infection and removal rates

under the stochastic SIR model are preferred over the estimates from a deterministic SIR

model when the data generating process is stochastic. Further, we note that the branch-

ing approximation produces very similar maximum a posteriori estimates of parameters.

However, the branching approximation seems to lose the correlation structure in the joint

posterior; the continued fraction method thus provides a more reliable, principled approach

to full posterior inference.

Finally, we remark that birth(death)/birth-death processes remain a limited subclass of

general multivariate birth-death processes. For example, many population biology problems

require a full bivariate birth-death process including predator-prey models (Hitchcock, 1986;

Owen et al., 2015) and the SIR model with vital dynamics (Earn, 2008). Unfortunately, eﬃ-

ciently computing the transition probabilities of multivariate birth-death processes remains

an open problem. Solving this problem will enable numerically stable statistical inference

under birth-death processes and will be worth the “heroic” eﬀort (Renshaw, 2011).

Acknowledgments

This work was partially supported by the National Institutes of Health (R01 HG006139,

R01 AI107034, and U54 GM111274) and the National Science Foundation (IIS 1251151 and

DMS 1264153). We thank Christopher Drovandi, Edwin Michael, and David Denham for

access to the Brugia pahangi counts.

A Continued fractions

In this section, we give some basic deﬁnitions and properties related to continued fractions.

35

Deﬁnition A.1. A continued fraction φ0 is a scalar quantity expressed in

φ0 =

y1 +

x1

x2

y2 +

x3

y3 + ··· ,

where {xi}∞

i=1 and {yi}∞

i=1 are inﬁnite sequences of complex numbers.

Deﬁnition A.2. The nth convergent of φ0 is

Xn
Yn

=

x1

x2

x3

y1 +

y2 +

(A.1)

(A.2)

yn
Deﬁnition A.3. We deﬁne the corresponding sequence {φn}∞

y3 + ··· +

xn

.

n=0 of a continued fraction (A.1)

by the following recurrence formulae

φ1 = x1 − y1φ0, and
φn = xnφn−2 − ynφn−1 for n ≥ 2.

(A.3)

Murphy and O’Donohoe (1975) provided the following suﬃcient condition for the con-

vergence of (A.1):

Lemma A.1. Assume that there exists N such that inf n>N |Yn| > 0 and limn→∞ φn = 0.

36

Then, the continued fraction (A.1) is convergent. Moreover,

n(cid:89)

i=1

xi

φn =

xn+1

xn+2Yn

xn+3

Yn+1 +

yn+2 +

yn+3 +

xn+4

yn+4 + ··· .

Now, if we consider a more general recurrence formulae

1 = −y1φ(m)
φ(m)
n = xnφ(m)
φ(m)

0 + k11{m=0}
n−2 − ynφ(m)

n−1 + km+11{m=n−1} for n ≥ 2,

then under the assumption of Lemma A.1, we have the following lemma:

Lemma A.2. The solution for (A.5) is

 (−1)m−nkm+1

(cid:81)m+1
km+1(cid:81)m+1

i=1 xi

i=1 xi

φ(m)
n =

Ynφm,

Ymφn,

if n ≤ m
if n ≥ m.

(A.4)

(A.5)

(A.6)

B Modiﬁed Lentz method

Modiﬁed Lentz method (Lentz, 1976; Thompson and Barnett, 1986) is an eﬃcient algorithm

to ﬁnitely approximate the inﬁnite expression of the continued fraction φ0 in (A.1) to within

a prescribed error tolerance. Let φ(n)

0 be the nth convergence of φ0, that is φ(n)

0 = Xn/Yn.

The main idea of Lentz’s algorithm lies in using the ratios

An =

Xn
Xn−1

and Bn =

Yn−1
Yn

37

(B.1)

to stabilize the computation of φ(n)

0 . We can calculate An, Bn, and φ(n)

0

recursively as follows:

An = yn +

xn
An−1
1

yn + xnBn−1

Bn =
0 = φ(n−1)
φ(n)

0

AnBn.

If φ(n)

0

converges to φ0, then Craviotto et al. (1993) show that

(cid:12)(cid:12)(cid:12)φ(n)

0 − φ0

(cid:12)(cid:12)(cid:12) ≤ |Yn/Yn−1|

I[Yn/Yn−1]

(cid:12)(cid:12)(cid:12)φ(n)

0 − φ(n−1)

0

(cid:12)(cid:12)(cid:12) =

|1/Bn|
I[1/Bn]

(B.2)

(B.3)

(cid:12)(cid:12)(cid:12) ,

(cid:12)(cid:12)(cid:12)φ(n)

0 − φ(n−1)

0

where I[Yn/Yn−1] is the imaginary part of Yn/Yn−1 and is assumed to be non-zero. Hence,

the Lentz’s algorithm terminates when

|1/Bn|
I[1/Bn]

(cid:12)(cid:12)(cid:12)φ(n)

0 − φ(n−1)

0

(cid:12)(cid:12)(cid:12)

(B.4)

is small enough. However, An and Bn can equal zero themselves and cause problem. Hence,

Thompson and Barnett (1986) propose a modiﬁcation for Lentz’s algorithm by setting An
and Bn to a very small number, such as 10−16, whenever they equal zero. In practice, the

algorithm often terminates after small number of iterations. However, in some rare cases

where the numerical computation is unstable, it might take too long before the algorithm

terminates. So, we set a predeﬁned maximum number of iterations H as a fallback for these

cases.

C Branching SIR approximation

Here we derive and solve the Kolmogorov backward equations of the two-type branching pro-

cess necessary for evaluating the probability generating functions (PGFs) whose coeﬃcients

yield transition probabilities.

38

C.1 Deriving the PGF

Our two-type branching process is represented by a vector (X1(t), X2(t)) that denotes the

numbers of particles of two types at time t. Let the quantities a1(k, l) denote the rates

of producing k type 1 particles and l type 2 particles, starting with one type 1 particle,

and a2(k, l) be analogously deﬁned but beginning with one type 2 particle. Given a two-

type branching process deﬁned by instantaneous rates ai(k, l), denote the following pseudo-

generating functions for i = 1, 2 as

ui(s1, s2) =

(cid:88)

(cid:88)

k

l

ai(k, l)sk

1sl
2.

We may expand the probability generating functions in the following form:

(C.1)

(C.2)

φ10(t, s1, s2) = E(sX1(t)

1

sX2(t)
2

|X1(0) = 1, X2(0) = 0)

∞(cid:88)
∞(cid:88)

k=0

∞(cid:88)
∞(cid:88)

l=0

=

=

P kl
1,0(t)sk

1sl
2

(1k=1,l=0 + a1(k, l)t + o(t))sk

1sl
2

k=0

l=0

= s1 + u1(s1, s2)t + o(t).

We have an analogous expression for φ01(t, s1, s2) beginning with one particle of type 2

instead of type 1. For short, we will write φ10 := φ1, φ01 := φ2. Thus, we have the following

relation between the functions φ and u:

(t, s1, s2)|t=0 = u1(s1, s2) and
(t, s1, s2)|t=0 = u2(s1, s2).

dφ1
dt
dφ2
dt

(C.3)

To derive the backwards and forward equations, Chapman-Kolmogorov arguments yield

39

the symmetric relations

φ1(t + h, s1, s2) = φ1(t, φ1(h, s1, s2), φ2(h, s1, s2))

(C.4)

= φ1(h, φ1(t, s1, s2), φ2(t, s1, s2)).

First, we derive the backward equations by expanding around t and applying (C.3):

φ1(t + h, s1, s2) = φ1(t, s1, s2) +

= φ1(t, s1, s2) +

(t + h, s1, s2)|h=0h + o(h)
(h, φ1(t, s1, s2), φ2(t, s1, s2)|h=0h + o(h)

dφ1
dh
dφ1
dh

(C.5)

= φ1(t, s1, s2) + u1(φ1(t, s1, s2), φ2(t, s1, s2)h + o(h)).

Since an analogous argument applies for φ2, we arrive at the system

d
dt
d
dt

φ1(t, s1, s2) = u1(φ1(t, s1, s2), φ2(t, s1, s2)) and

(C.6)

φ2(t, s1, s2) = u2(φ1(t, s1, s2), φ2(t, s1, s2)),

with initial conditions φ1(0, s1, s2) = s1, φ2(0, s1, s2) = s2.

Recall in our SIR approximation, we use the initial population X2(0) as a constant that

scales the instantaneous rates over any time interval [t0, t1). The only nonzero rates specifying

this proposed model, in the notation above, are

a1(0, 1) = βX2(0),

a1(1, 0) = −βX2(0),

a2(0, 1) = −α,

a2(0, 0) = α.

(C.7)

For simplicity, call X2(0) := I0, the constant representing the infected population at the

beginning of the time interval. Thus, the corresponding pseudo-generating functions have a

40

simple form:

u1(s1, s2) = βI0s2 − βI0s1 and
u2(s1, s2) = α − αs2 = α(1 − s2).

Plugging into the backward equations, we obtain

(cid:0)φ2(t, s1, s2) − φ1(t, s1, s2)(cid:1) and

d
dt
d
dt

φ1(t, s1, s2) = βI0
φ2(t, s1, s2) = α − αφ2(t, s1, s2).

(C.8)

(C.9)

The φ2 diﬀerential equation corresponds to a pure death process and is immediately solvable;

suppressing the arguments of φ2 for notational convenience, we obtain

φ2 = α − αφ2

d
dt
1
1 − φ2

d
dt

) = α

φ2(
ln(1 − φ2) = −αt + C

(C.10)

φ2 = 1 − exp(−αt + C).

Plugging in φ2(0, s1, s2) = s2, we obtain C = ln(1 − s2), and we arrive at

φ2(t, s1, s2) = 1 + (s2 − 1) exp(−αt)

(C.11)

Substituting this solution into the ﬁrst diﬀerential equation and applying the integrating

factor method provides

(cid:90)

φ1eβI0t =

βI0eβI0t(1 +

s2 − 1
eαt
e(βI0−α)t
= eβI0t + βI0(s2 − 1)
βI0 − α

) dt = eβI0t + βI0(s2 − 1)

+ C.

41

(cid:90)

e(βI0−α)t dt

(C.12)

Plugging in the initial condition φ1(0, s1, s2) = s1 and rearranging yields

φ1 = 1 +

βI0(s2 − 1)
βI0 − α

e−αt + e−βI0t(s1 − 1 − βI0(s2 − 1)
βI0 − α

).

(C.13)

C.2 Transition probability expressions

Transition probabilities are related to the PGF via repeated partial diﬀerentiation; note that

(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0

φmn(t, s1, s2)

P kl

mn(t) =

=

=

1
k!

1
k!

1
l!

1
l!

∂l
∂sl
2

∂k
∂sk
1
∂k
∂sk
1

k(cid:88)

i=0

∂l
∂sl
2
∂l
∂sl
2

(cid:18)k

i

(cid:19) ∂k−i

∂sk−i

1

φm
1 (t, s1, s2)

∂i
∂si
1

φm
1 (t, s1, s2)φn

2 (t, s1, s2)

This expression is generally unwieldy, but notice ∂i
∂si
1

φn
2 (t, s1, s2)

= 0 for all i > 0 in our

model. Remarkably, this allows us to further simplify and ultimately arrive at closed-form

(C.14)

(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0

.

(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0
(cid:12)(cid:12)(cid:12)(cid:12)s1=0

φn
2 (t, s1, s2)

(C.15)

(cid:19)m−k(cid:21)(cid:27)(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0

e−αt
βI0(s2 − 1)
βI0 − α

expressions. Continuing, we see

(cid:19)

(cid:20)(cid:18)k
(cid:26)

∂l
∂sl
2
∂l
∂sl
2

φn
2 (t, s1, s2)

∂k
∂sk
0
1
2 (t, s1, s2) · m!
φn

(m − k)!

φm
1 (t, s1, s2)

e−kβI0t

1 +

(cid:21)(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0
(cid:18)

βI0(s2 − 1)
βI0 − α

− e−βI0t

1 +

(cid:20)
(cid:12)(cid:12)(cid:12)(cid:12)s1=s2=0

φn
2 (t, s1, s2)

P kl

mn(t) =

=

:=

=

:=

∂l
∂sl
2

2 (t, s1, s2) · h(t, s1, s2)]
(cid:19) ∂l−i
(cid:18)l
[φn
l(cid:88)
(cid:18)l
(cid:19)
l(cid:88)

h(t, s1, s2)

∂i
∂si
2

∂sl−i

A(l − i)B(i).

i=0

i

2

i

i=0

42

From here, it is straightforward to take partial derivatives of h(t, s1, s2) and our closed-form

expression of φn

2 (t, s1, s2) to arrive at Conditions (40) and (41). A heatmap visualization of

the diﬀerence between transition probabilities under the branching approximation and those

computed using the continued fraction method for the SIR model is included below.

Figure 8: Heatmap visualizations of transition probabilities near the region of support across
methods for t = 0.5, 1. We see that the branching approximation is noticeably diﬀerent from
the Monte Carlo ground truth when we increase t to 1, while the continued fraction approach
remains accurate.

References

Abate, J. and W. Whitt (1992). The Fourier-series method for inverting transforms of

probability distributions. Queueing Systems 10 (1-2), 5–87.

43

Transition probabilities, t = 0.5Continued fraction expansionTransition probabilities, t = 1Continued fraction expansionMonte Carlo estimatesMonte Carlo estimatesTwo−type branching approximationTwo−type branching approximationAndersson, H. and T. Britton (2000). Stochastic epidemic models and their statistical anal-

ysis, Volume 4. Springer New York.

Andrieu, C., A. Doucet, and R. Holenstein (2010). Particle Markov chain Monte Carlo

methods. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 72 (3),

269–342.

Blum, M. G. and V. C. Tran (2010). HIV with contact tracing: a case study in approximate

Bayesian computation. Biostatistics 11 (4), 644–660.

Brauer, F. (2008). Compartmental models in epidemiology. In Mathematical epidemiology,

pp. 19–79. Springer.

Britton, T. (2010). Stochastic epidemic models: a survey. Mathematical Biosciences 225 (1),

24–35.

Cauchemez, S. and N. Ferguson (2008). Likelihood-based estimation of continuous-time

epidemic models from time-series data: application to measles transmission in London.

Journal of the Royal Society Interface 5 (25), 885–897.

Chowell, G., C. Ammon, N. Hengartner, and J. Hyman (2006). Transmission dynamics

of the great inﬂuenza pandemic of 1918 in Geneva, Switzerland: assessing the eﬀects of

hypothetical interventions. Journal of Theoretical Biology 241 (2), 193–204.

Correia-Gomes, C., T. Economou, T. Bailey, P. Brazdil, L. Alban, and J. Niza-Ribeiro (2014).

Transmission parameters estimated for salmonella typhimurium in swine using susceptible-

infectious-resistant models and a bayesian approach. BMC veterinary research 10 (1), 101.

Craviotto, C., W. B. Jones, and W. Thron (1993). A survey of truncation error analysis

for Pad´e and continued fraction approximants. Acta Applicandae Mathematica 33 (2-3),

211–272.

44

Crawford, F. W., V. N. Minin, and M. A. Suchard (2014). Estimation for general birth-death

processes. Journal of the American Statistical Association 109 (506), 730–747.

Crawford, F. W. and M. A. Suchard (2012). Transition probabilities for general birth–death

processes with applications in ecology, genetics, and evolution. Journal of Mathematical

Biology 65 (3), 553–580.

Crawford, F. W., R. E. Weiss, and M. A. Suchard (2015). Sex, lies, and self-reported counts:

Bayesian mixture models for longitudinal heaped count data via birth-death processes.

Annals of Applied Statistics 9, 572–596.

Csill´ery, K., M. G. Blum, O. E. Gaggiotti, and O. Fran¸cois (2010). Approximate Bayesian

computation (ABC) in practice. Trends in Ecology & Evolution 25 (7), 410–418.

Doss, C. R., M. A. Suchard, I. Holmes, M. Kato-Maeda, and V. N. Minin (2013). Fitting

birth–death processes to panel data with applications to bacterial DNA ﬁngerprinting.

The Annals of Applied Statistics 7 (4), 2315–2335.

Drovandi, C. C. and A. N. Pettitt (2011). Estimation of parameters for macroparasite

population evolution using approximate Bayesian computation. Biometrics 67 (1), 225–

233.

Dukic, V., H. F. Lopes, and N. G. Polson (2012). Tracking epidemics with Google ﬂu

trends data and a state-space SEIR model. Journal of the American Statistical Associa-

tion 107 (500), 1410–1426.

Earn, D. J. (2008). A light introduction to modelling recurrent epidemics. In Mathematical

epidemiology, pp. 3–17. Springer.

Ephraim, Y. and B. L. Mark (2012). Bivariate Markov processes and their estimation.

Foundations and Trends in Signal Processing 6 (1), 1–95.

45

Feller, W. (1968). An Introduction to Probability Theory and its Applications, Volume 1.

John Wiley & Sons.

Finkenst¨adt, B. and B. Grenfell (2000). Time series modelling of childhood diseases: a

dynamical systems approach. Journal of the Royal Statistical Society: Series C (Applied

Statistics) 49 (2), 187–205.

Golightly, A. and D. J. Wilkinson (2005). Bayesian inference for stochastic kinetic models

using a diﬀusion approximation. Biometrics 61 (3), 781–788.

Griﬃths, D. (1972). A bivariate birth-death process which approximates to the spread of a

disease involving a vector. Journal of Applied Probability 9 (1), 65–75.

Hitchcock, S. (1986). Extinction probabilities in predator-prey models. Journal of Applied

Probability 23 (1), 1–13.

Iglehart, D. L. (1964). Multivariate competition processes. The Annals of Mathematical

Statistics 35 (1), 350–361.

Ionides, E., C. Bret´o, and A. King (2006).

Inference for nonlinear dynamical systems.

Proceedings of the National Academy of Sciences, USA 103 (49), 18438–18443.

Ionides, E. L., D. Nguyen, Y. Atchad´e, S. Stoev, and A. A. King (2015).

Inference for

dynamic and latent variable models via iterated, perturbed Bayes maps. Proceedings of

the National Academy of Sciences, USA 112 (3), 719–724.

Karev, G. P., F. S. Berezovskaya, and E. V. Koonin (2005). Modeling genome evolution

with a diﬀusion approximation of a birth-and-death process. Bioinformatics 21 (Suppl 3),

iii12–iii19.

Keeling, M. and J. Ross (2008). On methods for studying stochastic disease dynamics.

Journal of The Royal Society Interface 5 (19), 171–181.

46

Kermack, W. and A. McKendrick (1927). A contribution to the mathematical theory of

epidemics. Proceedings of the Royal Society of London. Series A 115 (772), 700–721.

Lentz, W. J. (1976). Generating Bessel functions in Mie scattering calculations using con-

tinued fractions. Applied Optics 15 (3), 668–671.

Levin, D. (1973). Development of non-linear transformations for improving convergence of

sequences. International Journal of Computer Mathematics 3 (1-4), 371–388.

Martin, A. D., K. M. Quinn, and J. H. Park (2011). MCMCpack: Markov chain Monte

Carlo in R. Journal of Statistical Software 42 (9), 22.

McKendrick, A. (1926). Applications of mathematics to medical problems. Proceedings of

the Edinburgh Mathematics Society 44, 98–130.

McKinley, T., A. R. Cook, and R. Deardon (2009). Inference in epidemic models without

likelihoods. The International Journal of Biostatistics 5 (1), 1557–4679.

Moler, C. and C. Loan (2003). Nineteen dubious ways to compute the exponential of a

matrix, twenty-ﬁve years later. SIAM Review 45, 3–49.

Murphy, J. and M. O’Donohoe (1975). Some properties of continued fractions with applica-

tions in Markov processes. IMA Journal of Applied Mathematics 16 (1), 57–71.

Novozhilov, A. S., G. P. Karev, and E. V. Koonin (2006). Biological applications of the

theory of birth-and-death processes. Brieﬁngs in Bioinformatics 7 (1), 70–85.

Owen, J., D. J. Wilkinson, and C. S. Gillespie (2015). Scalable inference for Markov processes

with intractable likelihoods. Statistics and Computing 25 (1), 145–156.

Rabier, C.-E., T. Ta, and C. An´e (2014). Detecting and locating whole genome duplications

on a phylogeny: a probabilistic approach. Molecular Biology and Evolution 31 (3), 750–762.

47

Raggett, G. (1982). A stochastic model of the Eyam plague. Journal of Applied Statis-

tics 9 (2), 212–225.

Renshaw, E. (2011). Stochastic Population Processes: Analysis, Approximations, Simula-

tions. Oxford University Press Oxford, UK.

Reuter, G. E. H. (1957). Denumerable Markov processes and the associated contraction

semigroups on l. Acta Mathematica 97 (1), 1–46.

Reuter, G. E. H. (1961). Competition processes. In Proc. 4th Berkeley Symp. Math. Statist.

Prob, Volume 2, pp. 421–430.

Riley, S., C. A. Donnelly, and N. M. Ferguson (2003). Robust parameter estimation tech-

niques for stochastic within-host macroparasite models. Journal of Theoretical Biol-

ogy 225 (4), 419–430.

Robert, C. P., J.-M. Cornuet, J.-M. Marin, and N. S. Pillai (2011). Lack of conﬁdence in

approximate Bayesian computation model choice. Proceedings of the National Academy

of Sciences 108 (37), 15112–15117.

Rosenberg, N. A., A. G. Tsolaki, and M. M. Tanaka (2003). Estimating change rates of

genetic markers using serial samples: applications to the transposon IS6110 in Mycobac-

terium tuberculosis. Theoretical Population Biology 63 (4), 347–363.

Schranz, H. W., V. B. Yap, S. Easteal, R. Knight, and G. A. Huttley (2008). Pathological

rate matrices: from primates to pathogens. BMC Bioinformatics 9 (1), 550.

Sunn˚aker, M., A. G. Busetto, E. Numminen, J. Corander, M. Foll, and C. Dessimoz (2013).

Approximate Bayesian computation. PLoS Computational Biology 9 (1), e1002803.

Thompson, I. and A. Barnett (1986). Coulomb and Bessel functions of complex arguments

and order. Journal of Computational Physics 64 (2), 490–509.

48

Xu, J., P. Guttorp, M. Kato-Maeda, and V. N. Minin (2015). Likelihood-based inference for

discretely observed birth–death-shift processes, with applications to evolution of mobile

genetic elements. Biometrics 71 (4), 1009–1021.

49

