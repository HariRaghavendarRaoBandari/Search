Roulettes: A weak lensing formalism for strong lensing

— II. Derivation and analysis —

Chris Clarkson

Department of Mathematics & Applied Mathematics,

University of Cape Town, Cape Town 7701, South Africa.∗

(Dated: March 17, 2016)

We present a new extension of the weak lensing formalism capable of describing strongly lensed
images. This paper accompanies Paper I, where we provide a condensed overview of the approach
and illustrated how it works. Here we give all the necessary details, together with some more explicit
examples. We solve the non-linear geodesic deviation equation order-by-order, keeping the leading
derivatives of the optical tidal matrix, giving rise to a series of maps from which a complete strongly
lensed image is formed. The family of maps are decomposed by separating the trace and trace-free
parts of each map. Each trace-free tensor represents an independent spin mode, which distort circles
into a variety of roulettes in the screen-space. It is shown how summing this series expansion allows
us to create large strongly lensed images in regions where convergence, shear and ﬂexion are not
suﬃcient.

This paper is a detailed exposition of Paper I, arXiv:1603.04698, [1], which presents the key elements of the subject

matter in a wider context.

Contents

I. The non-linear geodesic deviation equation and the lensing maps

A. Initial and boundary conditions, and the lensing map at any order

II. Invariant decomposition of a projected map

A. Decomposition of the map using symmetric trace-free tensors
B. The normal modes in the Cartesian basis
C. The normal modes in the polar basis
D. The normal modes in the helicity basis
E. Relation to convergence, shear and ﬂexion
F. Action of the normal modes – roulettes
G. Finding the roulette amplitudes

III. Lensing roulettes in the weak ﬁeld approximation

A. The weak ﬁeld approximation
B. Circularly symmetric lens in the thin lens approximation
C. Mass distribution and reconstruction in the thin lens approximation
D. Examples of image construction for circular lenses

1. Point Mass
2. Singular Isothermal Sphere

IV. Summary and conclusions

Acknowledgments

A. Notes on the trig integrals

References

∗Electronic address: chris.clarkson@gmail.com

2
3

4
4
5
7
8
9
10
11

13
13
15
17
19
19
22

23

24

24

25

6
1
0
2

 
r
a

 

M
6
1

 
 
]
c
q
-
r
g
[
 
 

2
v
2
5
6
4
0

.

3
0
6
1
:
v
i
X
r
a

2

I. THE NON-LINEAR GEODESIC DEVIATION EQUATION AND THE LENSING MAPS

The computation of the convergence and shear is achieved from the geodesic deviation equation which is linear in

the deviation vector:1

¨ξa + Ra

kbkξb = 0 .

(1)

This applies for an inﬁnitesimal deviation vector only as the Riemann tensor arrises from the ﬁrst term in a series
expansion over the vector. The fully non-linear geodesic deviation equation is extremely complicated, given by the
second derivative of Synge’s world function, and its series expansion beyond second-order in ξ is equally horrendous –
see [3]. As far as gravitational lensing is concerned, however, the most important contributions arise from terms with
the maximum number of screen space derivatives of the metric (or rather the rotation coeﬃcients). In this situation,
we can ‘calculate’ the leading contributions at each order in ξ, by recalling the derivation of (1). Considering two
nearby geodesics, one Taylor expands the Christoﬀel symbols at the ‘end’ of the vector ξ about the point at the ‘start’
of ξ. In this way the Riemann tensor appears as the linear part of this Taylor expansion of the Christoﬀel symbols in
deriving (1):

Only the ﬁrst term is important for us as all the others are sub-dominant. If in the standard textbook derivation of
(1) we keep more terms in the expansion leading to ∂ξΓa
kk/n!, plus subdominant terms. We
can then replace the Riemann tensor in (1) by

n=1 ∂(n)

ξ Γa

kbk (cid:55)→

Ra

1

∇n
ξ Ra

kbk .

(3)

Ra

kξk = ∂ξΓa

kk − ∂kΓa

kξ (+ΓΓ terms) .

kk, we have(cid:80)

∞(cid:88)

(n + 1)!

n=0

(2)

(5)

(6)

The extra n + 1 in the factorial comes about because the ﬁrst term in the Riemann tensor is already the ﬁrst term in
the series expansion. Now, each ξa∇a can be replaced by ξA∇A, as it is the screen space derivatives which are most
important. Now substitute this into (1), and project into the screen space, and we have

¨ξA − RA

BξB =

1

ξA1 ξA2 ··· ξAn ξB∇A1∇A2 ···∇AnRA

B ,

(4)

where RAB = −RAkBk is the optical tidal tensor. Solutions to this may be found by an extension of the method used
in [2]. We can solve this perturbatively in powers of ξA, by writing

∞(cid:88)

(n + 1)!

n=1

∞(cid:88)

m=1

ξA =

m
m!

ξA
(m) ,

where the power of  is just to help us keep track of terms. Inserting this into (4) we have

(cid:16) ¨ξA

∞(cid:88)

m=1

m
m!

(cid:17)

∞(cid:88)

(m) − RA

BξB

(m)

=

1

∇A1∇A2 ···∇AnRA

A0

(n + 1)!

n=1

n(cid:89)

∞(cid:88)

i=0

mi=1

mi
mi!

ξAi
(mi) .

We solve this by equating powers of  on both sides. For m, the term on the right with the largest number of
derivatives of RAB has m − 1 derivatives, and mi = 1 for each i. This implies that the m’th term in the solution
obeys, to leading order,

(m) − RA
¨ξA

BξB

(m) = ξA1

(1)ξA2

(1) ··· ξAm

(1) ∇A1∇A2 ···∇Am−1RA

= F A

(m) .

Am

(7)

The solution to this equation is found by the method presented in [2]. There it was shown that the particular solution
to

¨ξ − Rξ = F

(8)

1 We follow the notation of [2]. a, b, c, · · · denote spacetime indices, A, B, C, · · · are tetrad indices in the screen space, k or ξ as an index

denotes projection of that index in the direction of k or ξ. Ra

bcd is the Riemann tensor. A dot is a derivative along the null curve.

is

(cid:90) λ

λo

ξ =

dλ(cid:48)(cid:2)K(λ) − J (λ)J −1(λ(cid:48))K(λ(cid:48))(cid:3)J T (λ(cid:48))F (λ(cid:48)) ,

3

(9)

where JAB is the Jacobi map and KAB is the reciprocal Jacobi map (written using standard matrix notation above
for simplicity), which are linearly independent solutions to the linear GDE:

¨J = RJ
with K(λo) = 0,
¨K = RK with K(λo) = I,

˙J (λo) = −I .
˙K(λo) = 0 .

(10)

(11)

A.

Initial and boundary conditions, and the lensing map at any order

There are two relevant boundary or initial conditions we can take to give useful solutions to (7): The image-to-
source ((cid:38)) condition and the source-to-image ((cid:45)). Consider the image-to-source case ﬁrst, where we give the initial
conditions at the observer as

ξ(cid:12)(cid:12)observer = 0,

˙ξ(cid:12)(cid:12)observer = −ζ .

((cid:38))

Here ζ is the non-perturbative angle in the image plane at the observer. At ﬁrst order the solution is

(1) = J A
ξA

Bζ B ,

which gives the physical distance between two rays at the source to ﬁrst order given the (exact) observed angular
position between the two rays, ζ. The m’th order solution is (9) plus a homogeneous solution of the same form as (13).
Since the initial conditions are satisﬁed for the ﬁrst-order part, the homogeneous solutions at higher order must be
zero. At each order, then, lensing can be given by the m’th-order map, for m ≥ 2,

where

M(cid:38)

AB1···Bm

(λ) =

((cid:38))

(cid:90) λ

dλ(cid:48)(cid:2)K F

A = M(cid:38)
ξ(m)

AB1···Bm

ζ B1 ··· ζ Bm ,

A (λ) − J D

D (λ(cid:48))K F

A (λ)(J −1) E
(λ(cid:48))∇C1 ···∇Cm−1RGCm(λ(cid:48)) .

λo

J C1

B1

(λ(cid:48))···J Cm

Bm

E (λ(cid:48))(cid:3)J G

F (λ(cid:48))

(12)

(13)

(14)

(15)

(16)

(18)

(19)

This family of maps are written in the conventional way whereby ζ is in the image plane (i.e., the angular separation
between two observed rays) is mapped to ξ in the source plane (the physical distance between the same two rays
at emission.) For m = 1 we write JAB = M(cid:38)
AB, noting that the Jacobi map is deﬁned in this way. Adding up the
ξ(m)’s for an observed deviation angle ζ will give the physical position of the source element (assuming the maps are
known).

Although conventional, this is not necessarily the most intuitive way round: we often want to predict how a source

gets distorted. In this case we are interested in the source-to-image case with the boundary conditions

ξ(cid:12)(cid:12)observer = 0,

ξ(cid:12)(cid:12)source = η ,

((cid:45))

where η is the (non-perturbative) physical distance between two rays at the source. The linear solution is the same
as (13) but now we write

ζ(1) = J −1(λs)η ,

(17)

to reﬂect the fact that the physical distance at the source is given, and the observed (linear) deﬂection angle at the
observer is derived. Consequently, the solution at any point on the geodesic, ξ(1)(λ), with the same angular size at
the image, which we require in (7), is given by

The solution for ξ(m) at order m must be zero at the source since we have ξ(1)(λs) = η = ξ(λs). Consequently,

ξ(1)(λ) = J (λ)J −1(λs)η .
(cid:90) λs

dλ(cid:48)(cid:2)K(λ) − J (λ)J −1(λ(cid:48))K(λ(cid:48))(cid:3)J T (λ(cid:48))F(m)(λ(cid:48)) ,

0 = ξ(m)(λs) = ξhomo

(m) (λs) +

λo

where

and since we must have

(cid:12)(cid:12)observer = ˙ξhomo

(m)

(cid:12)(cid:12)observer ≡ −ζ(m) ,

˙ξ(m)

(m) = J ζ(m) ,
ξhomo

we ﬁnd that the m’th perturbation to the angular size at the image is given by

(cid:90) λs

ζ(m) = −

dλ(cid:48)(cid:2)J −1(λs)K(λs) − J −1(λ(cid:48))K(λ(cid:48))(cid:3)J T (λ(cid:48))F(m)(λ(cid:48)) .

The lensing maps in the source-to-image conﬁguration are then

λo

where

M(cid:45)

AB1···Bm

(λ) = −

(cid:90) λ

dλ(cid:48)(cid:2)(J −1) D

λo

J C1

B1

(λ(cid:48))···J Cm

Bm

((cid:45))

A = M(cid:45)
ζ (m)

AB1···Bm

ηB1 ··· ηBm ,

D (λ(cid:48))(cid:3)J G

F (λ(cid:48))

A (λ)K F
(λ(cid:48))(J −1) D1

D (λ) − (J −1) D

A (λ(cid:48))K F
(λ)··· (J −1) Dm

Cm

C1

(λ)∇D1 ···∇Dm−1RGDm(λ(cid:48)) .

4

(20)

(21)

(22)

(23)

(24)

These maps can be taken as constant at the source or image centre. Note that their dimensions are diﬀerent
because the image-to-source map is contracted with angular sizes, and while the source-to-image map is contracted
] ∼ [length]−m and
with physical distances. Thus, the dimensions of the components of the maps are [M(cid:45)
[M(cid:38)
Notation: In what follows there is essentially no diﬀerence between the maps ((cid:45)) and ((cid:38)), so we use the generic
notation

] ∼ [length].

AB1···Bm

AB1···Bm

(25)
with the understanding that if we are dealing with the image-to-source case ((cid:38)) then ζ represents the observed angle
at the observer, and ξ(m) the m’th order correction to the distance between two rays at the source (with an m! factor).
In the source-to-image case ((cid:45)) we have ζ representing the physical distance at the source (denoted η above), and
ξ(m) is the m’th order correction to the angle at the image.

B1···Bm

(m) = MA
ξA

ζ B1 ··· ζ Bm

II.

INVARIANT DECOMPOSITION OF A PROJECTED MAP

Here we shall give a description of the decomposition of a generic map with no reference to lensing. We shall
perform our decomposition on a plane although the extension to a sphere is relatively straightforward. (The lensing
approximation we have used above already assumes a kind of ﬂat sky approximation, because we have neglected
everything except transverse derivatives in the screen space.) We perform a decomposition of the map in the plane in
a real Cartesian basis, a polar basis, then consider the same in a helicity basis for completeness, which is where the
relation between trace-free tensors and spin is most apparent. The calculation appears a little simpler in the latter,
but the conversion back to real space removes this slight advantage.

A. Decomposition of the map using symmetric trace-free tensors

At each order the map MAB1···Bm can be invariantly decomposed into a family of symmetric trace-free tensors
which give the normal modes of each lensing mode. Note that we are only interested in MA(B1···Bm) since the map is
multiplied by the symmetric tensor ζ B1 ··· ζ Bm or ηB1 ··· ηBm depending on the map in question (we will just use ζ A
from hereon as there is no real distinction between the 2 cases). The ﬁrst split is to separate out the antisymmetric
component from the ﬁrst index:

MAB1···Bm = Msymm

AB1···Bm

+ εA(B1Manti-symm
B2···Bm)

(26)

AB1···Bm

= M(AB1···Bm) is symmetric as is Manti-symm
B2···Bm

where Msymm
tensor on the screen space. Now, any symmetric tensor can be expanded into a sum of invariant STF tensors, which
are the invariant normal modes of the map. For example, for linear weak lensing the split is into a scalar (convergence)
and a rank-2 STF tensor (the shear). The general expansion is a mess, but the general idea is simple. For rank 4, we
have

(B2···Bm) , and AB = −BA is the Levi-Civita

= Manti-symm

MABCD = (cid:99)Mδ(ABδCD) + (cid:99)M(ABδCD) + (cid:99)MABCD,

where a hat denotes that the tensor is trace-free. Similarly for a odd-ranked tensor, say rank 7, we have

and so on. Note that each STF tensor has 2 degrees of freedom, and the number of indices represents the spin of the
mode. First let us consider the case where m is odd, so that the map itself is even:

MABCDEF G = (cid:99)M(AδBCδDEδF G) + (cid:99)M(ABCδDEδF G) + (cid:99)M(ABCDEδF G) + (cid:99)MABCDEF G ,
(cid:20)(cid:99)Mδ(AB1 ··· δBm−1Bm) + (cid:99)M(AB1δB2B3 ··· δBm−1Bm) + ···

ˆζ B1 ··· ˆζ Bm =

Msymm

··· + (cid:99)M(AB1···Bj δBj+1Bj+2 ··· δBm−1Bm) + ··· + (cid:99)M(AB1···Bm−3δBm−1Bm) + (cid:99)MAB1···Bm−1Bm

ˆζ B1 ··· ˆζ Bm ,

AB1···Bm

(cid:21)

where j is odd. In the case where the map is odd, m is even and we have instead

Msymm

AB1···Bm

ˆζ B1 ··· ˆζ Bm =

··· + (cid:99)M(AB1···Bj δBj+1Bj+2 ··· δBm−1Bm) + ··· + (cid:99)M(AB1···Bm−3δBm−1Bm) + (cid:99)MAB1···Bm−1Bm

ˆζ B1 ··· ˆζ Bm ,

(cid:20)(cid:99)M(AδB1B2 ··· δBm−1Bm) + (cid:99)M(AB1B2δB3B4 ··· δBm−1Bm) + ···

5

(27)

(28)

(29)

(30)

where now j ≤ m is also even.

Now consider the anti-symmetric component of the map. In the case where m is odd we have

εA(B1Manti-symm
B2···Bm)

ˆζ B1 ··· ˆζ Bm = εA(B1

(cid:20)
MδB2B3 ··· δBm−1Bm) + MB2B3δB4B5 ··· δBm−1Bm) + ···

··· + MB2B3···Bj δBj+1Bj+2 ··· δBm−1Bm) + ··· + MB2B3···Bm−3 δBm−1Bm) + MB2B3···Bm−1Bm

ˆζ B1 ··· ˆζ Bm , (31)

and for m even,

εA(B1Manti-symm
B2···Bm)

ˆζ B1 ··· ˆζ Bm = εA(B1

(cid:20)
MB2δB3B4 ··· δBm−1Bm) + MB2B3B4δB5B6 ··· δBm−1Bm) + ···

··· + MB2B3···Bj δBj+1Bj+2 ··· δBm−1Bm) + ··· + MB2B3···Bm−3 δBm−1Bm) + MB2B3···Bm−1Bm

B. The normal modes in the Cartesian basis

ˆζ B1 ··· ˆζ Bm .

(32)

(cid:21)

(cid:21)

(cid:21)

To see how these STF tensors relate to normal normal modes like shear and convergence, consider a point in the
screen space given in Cartesian coordinates, ζA = r ˆζA, where ˆζA = (cos θ, sin θ) is the radial unit vector. Two types
of terms appear, those with all indices contracted with ζ’s, and those with all but one contracted. Consider

(cid:99)MA1···An

ˆζ A1 ··· ˆζ An =

cosn−k θ sink θ(cid:99)Mxn−kyk ,

(cid:18)n

(cid:19)

n(cid:88)

k

k=0

where a power on a tensor index means its repeated that many times. (This relation is easy to prove by induction.)
Now let us deﬁne the two normal modes as determined by whether there are an odd or even number of y’s in Mxn−kyk :

αn = (−1)j(cid:99)Mxn−2j y2j
βn = (−1)j(cid:99)Mxn−2j−1y2j+1 ,

(33)

(34)

(35)

where the subscript on the normal modes carries the spin of the mode (we deﬁne β0 = 0). For each n we can deﬁne
a set of irreducible STF basis tensors

eA1···An : ex···x = 1, ex···xy = 0

and ˜eA1···An : ˜ex···x = 0, ˜ex···xy = 1 ,

and then

(cid:99)MA1···An = αn eA1···An + βn ˜eA1···An .

(36)

(37)

6

B).) Note that exn−2j y2j = (−1)j and
(For example, for n = 2 we have eAB = ex
˜exn−2j−1y2j+1 = (−1)j. ) The total projection of the two STF basis tensors along ˆζ (i.e., when all indices are projected
onto ˆζ) are

B and ˜eAB = 2ex

(Aey

Aey

Aex

B − ey
n(cid:88)
n(cid:88)

(cid:19)
(cid:18)n
(cid:19)
(cid:18)n

k

k even

k

k odd

eA1···An

ˆζ A1 ··· ˆζ An =

˜eA1···An

ˆζ A1 ··· ˆζ An =

(−1)k/2 cosn−k θ sink θ = cos nθ ,

(−1)(k−1)/2 cosn−k θ sink θ = sin nθ ,

(38)

(39)

,(40)

.

(41)

(42)

(43)

(44)

while for the case that one index remains unprojected, we have (using column vector notation for the unprojected
index)

eA1···An

ˆζ A2 ··· ˆζ An =

˜eA1···An

ˆζ A2 ··· ˆζ An =

(cid:18)n − 1
(cid:18)n − 1

k

(cid:19)
(cid:19)

n−1(cid:88)
n−1(cid:88)

k=0

k

k=0

cosn−1−k θ sink θ

cosn−1−k θ sink θ

(cid:19)
(cid:18) (−1)k/2 if k even, 0 if k odd
(cid:19)
(cid:18)(−1)(k−1)/2 if k odd, 0 if k even

(−1)(k+1)/2 if k odd, 0 if k even

(−1)k/2 if k even, 0 if k odd

(cid:19)

(cid:18) cos(n − 1)θ
(cid:19)
(cid:18)sin(n − 1)θ

− sin(n − 1)θ

cos(n − 1)θ

=

=

From these key relations we can ﬁnd all the possible projections required for the lensing map.

We have

and

(cid:99)MA1···An
(cid:99)MA1A2···An

ˆζ A1 ··· ˆζ An = αn cos(nθ) + βn sin(nθ) .

(cid:18) αn βn

βn −αn

(cid:19)(cid:18)cos(n − 1)θ

(cid:19)

sin(n − 1)θ

.

ˆζ A2 ··· ˆζ An =

We can now perform a full split of the symmetric part of (cid:99)MAB1···Bm, as it appears in the general lensing map. The
(cid:99)M(AB1···Bj δBj+1Bj+2 ··· δBm−1Bm)

ˆζA (cid:99)MB1···Bj+1

ˆζ B1 ··· ˆζ Bm =

ˆζ B1 ··· ˆζ Bj +

ˆζ B1 ··· ˆζ Bj+1

m − j
m + 1

(cid:19)(cid:21)(cid:18)cos jθ
(cid:19)
(cid:19)(cid:21)(cid:18)cos(j + 2)θ

sin jθ

(cid:19)

sin(j + 2)θ

=

j+1

+ βm

(cid:19)

αm

j+1

0 −1

j + 1
m + 1

(cid:20)
(cid:20)

generic term becomes

m + j + 2
2(m + 1)
m − j
2(m + 1)

(cid:18) 1 0
(cid:18) 1 0
(cid:19)

(cid:99)MAB1···Bj
(cid:18) 0 1
(cid:18) 0 1−1 0
as well if we take it to mean the (cid:99)M term in the even case, with (cid:99)M = αm
(cid:18) 1 0
(cid:18) 1 0
(cid:19)

With this we can now write, for any m,

ˆζ B1 ··· ˆζ Bm =

[1 − (−1)m+s]

m+1(cid:88)

(cid:20)
(cid:20)

Msymm

(m + s + 1)

AB1···Bm

4(m + 1)

0 −1

(cid:26)

αm

j+1

+ βm

j+1

αm
s

1 0

0 1

0 .

s=0

(m − s + 1)

αm
s

+ βm
s

0 1

(cid:19)

+ βm
s

(cid:18) 0 1
(cid:18) 0 1−1 0

1 0

(cid:19)(cid:21)(cid:18)cos(s − 1)θ
(cid:19)
(cid:19)(cid:27)
(cid:19)(cid:21)(cid:18)cos(s + 1)θ

sin(s − 1)θ

sin(s + 1)θ

(45)

We have added an m super-script to the normal mode amplitudes to denote the fact that they arise in a tensor with m
indices contracted as on the lhs (this will be useful below). This formula is for all j, and actually works with j = −1

7
(Note that the factor [1 − (−1)m+s]/2 selects the terms such that m + s is odd.) We have labeled the terms in the
sum such that s carries the spin of the mode.

The general term in the antisymmetric component of the map becomes, using εAB

εAB1MB2B3···Bj δBj+1Bj+2 ··· δBm−1Bm

(cid:20)
ˆζ B1 ··· ˆζ Bm = εAB1
(cid:20)

1
2

=

m−1(cid:88)
(cid:20)

s=0

+

[1 − (−1)m+s]

(cid:19)

4

(cid:18) 0 1−1 0

¯αm
s

− ¯βm

s

ˆζ B = (sin θ,− cos θ),

0 −1

¯αm

1 0

j−1

j−1

+ ¯βm

− ¯βm
j−1

ˆζ B2 ··· ˆζ Bj

(cid:18) 1 0
(cid:19)
(cid:18) 0 1
ˆζ B1MB2B3···Bj
(cid:18) 1 0
(cid:19)
(cid:18) 0 1−1 0
− ¯αm
j−1
(cid:18) 1 0
(cid:19)
(cid:18) 0 1
(cid:19)(cid:27)
(cid:19)(cid:21)(cid:18)cos(s + 1)θ

(cid:18) 1 0

0 −1

− ¯αm

+ ¯βm
s

0 1

1 0

s

sin(j − 2)θ

(cid:19)(cid:21)(cid:18)cos(j − 2)θ
(cid:19)
(cid:19)(cid:21)(cid:18)cos jθ
(cid:19)(cid:21)(cid:18)cos(s − 1)θ

(cid:19)

sin jθ

.

sin(s − 1)θ

0 1

sin(s + 1)θ

.

(cid:19)

(46)

(47)

+

1
2

(cid:26)(cid:20)

This formula works for j = 1 with M = αm

1 . Consequently we have, similarly to the symmetric case above,

εA(B1Manti-symm
B2···Bm)

ˆζ B1 ··· ˆζ Bm =

s are not truly independent modes as they always appear in the combination ¯αm

s cos sθ + ¯βm

s sin sθ

s and ¯βm

Note that ¯αm
(this is the ‘radial mode’ of the tensor).
Our ﬁnal map at m’th order becomes

ˆζ B1 ··· ˆζ Bm =

MAB1···Bm
(cid:20)(cid:20)(cid:18)
(cid:20)(cid:20)(cid:18)

1 +

1 − s

s

m + 1

m + 1

(cid:19)
(cid:19)

s

s + ¯βm
αm
s − ¯βm
αm

s

(cid:26)

[1 − (−1)m+s]

m+1(cid:88)
(cid:21)(cid:18) 1 0
(cid:21)(cid:18) 1 0
(cid:19)

0 −1

s=0

0 1

4

(cid:19)

(cid:20)
(cid:20)

+

+

(cid:18)
(cid:18)

1 +

s

m + 1

1 − s

m + 1

(cid:19)
(cid:19)

βm
s

βm
s

(cid:19)(cid:21)(cid:18)cos(s − 1)θ
(cid:19)
(cid:19)(cid:21)(cid:18)cos(s + 1)θ

sin(s − 1)θ

(cid:21)(cid:18) 0 1
(cid:21)(cid:18) 0 1−1 0

1 0

sin(s + 1)θ

(cid:19)(cid:27)

,

(48)

− ¯αm

s +

+ ¯αm

s +

where we deﬁne

¯αm
m = ¯αm

m+1 = ¯βm

m = ¯βm

m+1 = 0 .

Other αm

s ’s and βm

s ’s which do not appear in the sum (i.e., if m + s is even) can be assumed to be zero.

C. The normal modes in the polar basis

A polar basis at angle θ is

so that ˆζ = er. We can deﬁne a set of radial and angular STF basis tensors as

er = cos θex + sin θey ,
eθ = − sin θex + cos θey

e(r)
A1···An

: e(r)

r···r = 1, e(r)

r···rθ = 0

and e(θ)

A1···An

: e(θ)

r···r = 0, e(θ)

r···rθ = 1 ,

and then for a general STF tensor,

(cid:99)MA1···An = σn e(r)

A1···An

+ ωn e(θ)

A1···An

,

where

σn = αn cos nθ + βn sin nθ ,
ωn = −αn sin nθ + βn cos nθ .

(49)

(50)

(51)

(52)

(53)

That is, the independent degrees of freedom in the polar basis are those in the Cartesian basis, but ‘rotated’ by nθ.
For the projections of an STF tensor with ζ appearing in the general map we have

(cid:99)MA1···As

ˆζ A1 ··· ˆζ As = σs

8

(54)

(55)

(56)

(57)

(58)

(59)

(60)

(61)

(62)

(63)

(64)

and

(cid:99)MA1···As

ˆζ A2 ··· ˆζ As = σs er + ωs eθ .

The generic terms become (cid:99)M(AB1···Bs−1 δBsBs+1 ··· δBm−1Bm)
εAB1MB2B3···Bs+1δBs+2Bs+3 ··· δBm−1Bm

ˆζ B1 ··· ˆζ Bm = σser +
ˆζ B1 ··· ˆζ Bm = −σseθ

s

m + 1

ωseθ

The total map is then

MAB1···Bm

ˆζ B1 ··· ˆζ Bm =

(cid:26)

σm
s er +

(cid:18) s

m + 1

(cid:19)

(cid:27)

eθ

s − σm
ωm

s

[1 − (−1)m+s]

2

m+1(cid:88)

s=0

with σm

m = σm

m+1 = 0

D. The normal modes in the helicity basis

An alternative basis for the analysis is the helicity basis deﬁned by the complex null vectors [5]

e± =

1√
2

(ex ± iey) =

e±iθ√

2

(er ± ieθ) ,

where

e± · e± = 0,

e± · e∓ = 1

and ex =

1√
2

(e+ + e−) ,

ey =

(e− − e+) .

i√

2

The metric and Levi-Civita tensor are

gAB = 2e+
εAB = 2i e+

(Ae−
B) = ex
Aex
[Ae−
B] = 2ex

B + ey
[Aey
B] .

Aey
B ,

In this basis the unit radial vector on the screen space becomes

ˆζ = cos θex + sin θey =

1√
2

In the helicity basis we write the components of ˆζ as

(cid:0)e−iθe+ + eiθe−(cid:1) = − ˆζe+ + +

ˆζe− .

ˆζ∓ = ± ˆζ = ˆζ · e± = e±iθ/

√

2 .

Note that if we lower the index we have ˆζ± = ˆζ∓ = ± ˆζ.

Under a counterclockwise rotation by ψ to a new basis e(cid:48)

helicity basis changes by

A = R(ψ) B

A eB, where R(ψ) B

A is the rotation matrix, the

e(cid:48)
± = e±iψe± .

(65)

Because the vector ˆζ is invariant under this rotation, the components in the helicity basis must change contrary to
the basis, giving

± ˆζ(cid:48) = ˆζ · e(cid:48)

± = e±iψ ˆζ · e± = e±iψ± ˆζ .

(66)

9
The components of ˆζ in the helicity basis are said to have spin weight ±1 because of this transformation property
(which accounts for the slightly perverse notation in 63).

In this basis symmetric, trace-free tensors have a particularly simple representation. Since eA

+eB−(cid:99)M···A···B··· = trace

terms = 0, the two independent components are

and transform as spin ±s quantities from (65) (and the fact that the tensor (cid:99)MA1···As is invariant). The real space

(67)

tensor can then be written in terms of the complex helicity basis as

±s(cid:99)M = (cid:99)MA1···AseA1± ··· eAs± ,

From this we ﬁnd that the two independent modes in the Cartesian basis, αs and βs are related to the spin-modes

±s(cid:99)M in the helicity basis via

.

As

As

A1

A1

··· e+

··· e−

+ +s(cid:99)M e−

(cid:99)MA1···As = −s(cid:99)M e+
±s(cid:99)M = 2s/2−1 (αs ± iβs) = 2s/2−1e±isθ (σs ± iωs) .
−s(cid:99)Me+isθ + +s(cid:99)Me−isθ(cid:17)
(cid:99)MA1···As
ˆζ A2 ··· ˆζ As = 2−(s−1)/2(cid:16)
+ +s(cid:99)Me−i(s−1)θ e−
(cid:32)
(cid:33)(cid:18)e+i(s−1)θ

ˆζ A1 ··· ˆζ As = 2−s/2(cid:16)

−s(cid:99)Me+i(s−1)θ e+
−s(cid:99)M +s(cid:99)M
−s(cid:99)Mi −+s(cid:99)Mi

e−i(s−1)θ

2(s−1)/2

(cid:19)

=

A1

1

.

A1

(68)

(cid:17)

(69)

(70)

(71)

(72)

For the projections of an STF tensor with ζ appearing in the general map we have

and

(cid:99)MA1···As

In the last line the resulting column vector corresponds to the real space Cartesian basis, not the helicity basis. For
the generic term in the symmetric part of the lensing map we have

(cid:99)M(AB1···Bs−1δBsBs+1 ··· δBm−1Bm)
(cid:20)(cid:18)

2(s+1)/2

=

1

ˆζ B1 ··· ˆζ Bm =

(cid:26)(cid:20)(cid:18)

s

1 +

(cid:19)

s

(cid:99)MAB1···Bs−1
−s(cid:99)Me+i(s−1)θ +

(cid:19)

m + 1

(cid:18)

m + 1

−s(cid:99)Me+i(s+1)θ +

(cid:18)

+

1 − s

m + 1

1 +

m + 1

The general term in the antisymmetric component of the map becomes, using εAB

εAB1MB2B3···Bs+1δBs+2Bs+3 ··· δBm−1Bm

(cid:26)(cid:104)
−sMe+i(s−1)θ + +sMe−i(s+1)θ(cid:105)

=

i

2(s+1)/2

A − (cid:104)

e+

ˆζ B1 ··· ˆζ Bm = εAB1

A sum over the spin modes of the last two projections gives us (48) in the helicity basis.

E. Relation to convergence, shear and ﬂexion

ˆζ B1 ··· ˆζ Bs−1 +

ˆζA (cid:99)MB1···Bs
(cid:21)

(cid:19)

m + 1 − s
m + 1

+s(cid:99)Me−i(s+1)θ

e+
A

1 − s

(cid:19)

m + 1

+s(cid:99)Me−i(s−1)θ

(cid:21)

s

e−
A .
√
ˆζ B = i/
ˆζ B1MB2B3···Bs+1

−sMe+i(s+1)θ + +sMe−i(s−1)θ(cid:105)

2(e−iθe+
ˆζ B2 ··· ˆζ Bs+1
e−

A

ˆζ B1 ··· ˆζ Bs

(73)

A − eiθe−
A),
(cid:27)

.

(74)

Let us check this against known results. For m = 1 we have simply the Jaccobi map, which, in this notation has

contributions from s = 0 and s = 2 modes:

MABζ B = r

α1
0

Comparing with the usual ampliﬁcation matrix we see α1
β1
2 are the 2 independent polarizations of the shear. In the radial basis we have

0 is (minus) the convergence, ¯α1

0 is the rotation, and α1

2 and

(cid:19)

(cid:18) 1 0

0 −1

+ α1
2

+ β1
2

(cid:18) 0 1

(cid:19)(cid:21)(cid:18)cos θ

(cid:19)

1 0

sin θ

.

(75)

(cid:20)

(cid:19)

0 1

(cid:19)

+ ¯α1
0

(cid:18) 1 0

(cid:18) 0 1−1 0
MABζ B = r(cid:2)(σ1

0 + σ1

2)er + (−σ1

0 + ω1

2)eθ

(cid:3) .

(76)

FIG. 1: Distortions of the
unit circle induced by the
rotation and reﬂection ma-
trices I, ε, R−, R/,
from
top to bottom. Here we
have plotted ˆζ + 0.25 R ·
p(s) , where R is one of
I, ε, R−, R/.
The ma-
trices I, ε trace out the
same epitrochoid of rota-
tional spin s − 1, rotated
by angles π/2(s − 1) from
each other. The matrices
R−, R/ trace out hypotro-
choids of spin s+1, rotated
by π/2(s + 1).

The second-order map becomes

(cid:26)(cid:18) 4
(cid:19)(cid:18) 1 0
(cid:19)

1
2

r2

3

0 1

(cid:19)(cid:18)1
(cid:19)
(cid:18)
(cid:19)(cid:18) 0 1−1 0

−¯α2

β2
1

+

0

2
3

1 + ¯β2
α2

1

(cid:18)

+

¯α2

1 +

1 +

β2
1

4
3

(cid:19)

(cid:19)(cid:18)0
(cid:19)
(cid:18) 1 0

1

+ 2α2
3

0 −1

MABCζ Bζ C =

(cid:20)(cid:18) 2

3

+

1 − ¯β2
α2

1

10

(cid:19)

+ 2β2
3

(cid:18) 0 1

1 0

(cid:19)(cid:21)(cid:18)cos 2θ

(cid:19)(cid:27)

sin 2θ

.

(77)

The ﬁrst two terms are just a shift in the centre of the source, while the next two correspond to spin-1 F-type ﬂexion,
and the last two spin-3 G-type ﬂexion.

F. Action of the normal modes – roulettes

Let us now investigate each type of normal mode which appears. This is simplest in the Cartesian basis. Generically

we consider the action of a mode as a distortion of the unit circle. Consider the distortion induced by a vector

(78)
This vector traces out a curve with spin s− 1. The 4 independent distortions associated with this mode which appear
in the Cartesian basis in (48) are given by the orthogonal matrices

p(s) = cos sθ ex + sin sθ ey = cos(s − 1)θ er + sin(s − 1)θ eθ .

(cid:19)

(cid:18) 1 0

0 1

(cid:19)

(cid:18) 0 1−1 0

(cid:19)

(cid:18) 1 0

0 −1

(cid:19)

(cid:18) 0 1

1 0

I =

,

ε =

, R− =

, R/ =

,

(79)

The ﬁrst two are rotation matrices (with unit determinant) by 0 and −π/2 respectively, and the second two are
reﬂections in the line y = x and x-axis (with determinant −1). These are the Pauli spin matrices with ε = iσ2, and so
obey similar commutation relations. We show plots of the distortions these induce to the unit circle in Fig. 1, using

where α is a small constant amplitude. The length of this vector varies as

| ˆζ + αR · p(s)|2 = 1 + α2 + 2α

ˆζ + αR · p(s) ,

 cos(s − 1)θ R = I

sin(s − 1)θ R = ε
cos(s + 1)θ R = R−
sin(s + 1)θ R = R/

(80)

(81)

,

11
so the rotation matrices give rise to a spin s − 1 shape, and the reﬂection matrices give rise to spin s + 1 shapes. In
fact, these are all trochoids2 – the ﬁrst two are epitrochoids (formed from a roulette from a circle rolling outside a
circle), and the other two are hypotrochoids (circle rolling inside a circle) [4]. In linear weak lensing, I and R give
convergence and rotation, and R− and R/ give the 2 components of the shear.

Now lets move to the normal modes appearing in the map: the ‘even’ modes αm
We shall start with the odd modes as they are slightly simpler. Consider the ¯αm
in two parts from a reﬂection and a rotation:

s and the ‘odd’ modes ¯αm

s , ¯βm
s , βm
s .
s mode, which distorts a unit circle

(cid:16)−R/ · p(s−1) + R · p(s+1)

(cid:17)

ˆζ (cid:55)→ ˆζ + ¯αm

s

(82)

The ﬁrst correction traces out a hypotrochoid, and the second correction an epitrochoid giving rise to an odd roulette.
Both these curves have s lobes, corresponding to a spin-s mode. These modes are shown in Fig. 2. Note that the
¯βm
s mode is the same but rotated by π/2s. Referring to Fig. 1, we can pick out the two modes giving rise to the odd
distortion. For example, for s = 3 we have a sum of the triangular shape in the bottom row, second column, and the

FIG. 2: The odd modes as a function of ¯αm

s . The ¯βm

s modes are the same, just rotated by π/2s

3-lobed shape two rows above.

For the even modes, we again focus on the αm

s being rotated by π/2s. We show these in Fig. 3.
The even modes are more complicated because they appear in the map with a diﬀerent weighting between the epi-
and hypo-trochoid contributions. Here the roulettes are the distortion of the unit circle given by

s modes, the βm

(cid:20)(cid:18)

(cid:19)

(cid:18)

(cid:19)

(cid:21)

ˆζ (cid:55)→ ˆζ + αm

s

1 +

s

m + 1

R− · p(s−1) +

1 − s

m + 1

I · p(s+1)

(83)

Recall that the relative sizes of s and m occur from splitting oﬀ the traces of the total map. For a ﬁxed m, m (cid:29) s
gives the mode which is mainly traces, whereas s = m + 1 is the part of the map which is entirely trace-free. We show
a selection in Fig. 3 – the two extremes, and the spin mode with one trace removed from the total map s = m − 1.

G. Finding the roulette amplitudes

We can invert the expansion of the map into a sum over normal modes to give the coeﬃcients αs, βs and ¯αs, ¯βs
ˆζ B1 ··· ˆζ Bm , assuming that the coeﬃcients are constant. This then

in terms of the projected map ˆξ(m)

A = MAB1···Bm

2 From Wikipedia: A centred trochoid is the roulette formed by a circle rolling along another circle. An epitrochoid is a roulette traced
by a point attached to a circle of radius r rolling around the outside of a ﬁxed circle of radius R, where the point is a distance d from
the centre of the exterior circle. A hypotrochoid is a roulette traced by a point attached to a circle of radius r rolling around the inside
of a ﬁxed circle of radius R, where the point is a distance d from the centre of the interior circle.

12

FIG. 3: The even modes as a function of αm
s modes are the same, just rotated by π/2s. For a ﬁxed s, 3 m values
are considered, as the ratio between s and m + 1 gives quite diﬀerent normal modes. The 4 enlarged ﬁgures at the top are a
blow-up of the 4 in the rectangle, shown for clarity.

s . The βm

(cid:12)(cid:12)(cid:12)(cid:12)r=0

ˆξ(m)
A =

1
m!

∂m
∂rm ξA

becomes like a 2D Fourier series. Note that we can extract the m’th map from the full ξ just using

We write this in column vector form for the free index A as ˆξ(m) = MB1···Bm
we have removed the factor of rm which appears in ξ(m)
integrating around the unit circle allows us to extract each spin mode, using

A .) Multiplying this on the right with the row vector pT

ˆζ B1 ··· ˆζ Bm . (The ˆ on the ξ denotes
(n) and

.

(84)

(cid:90) π

−π

1
π

dθ p(m)pT

(n) =

Iδm,n
R−δ|m|,n

(cid:19)


(cid:18) 2 0
(cid:2)A−

0 0

n−1I + B−

In (48) this gives, for m, n > 0,

(cid:90) π

−π

1
π

dθ ˆξ(m)pT

(n) =

1
2

m, n > 0
for
for m < 0, n > 0

.

δ0,n for

m = 0

n−1ε + A+

n+1R− + B+

n+1R/

(85)

(86)

(cid:3) ,

where

(cid:18)

A±
s =

1 ± s

m + 1

(cid:19)

s ± ¯βm
αm

s , B±

(cid:19)

βm
s .

13

(87)

(cid:18)

1 ± s

m + 1

Using the fact that the matrices are orthogonal allows us to solve for the coeﬃcients easily: we multiply (86) by each
of the matrices in turn and take a trace to isolate each component – e.g., for n + m even,

s +

s = ∓¯αm
(cid:90) π

1
π

−π

(cid:90) π

−π

A+

n+1 =

1
π

We then have

αm

s =

βm
s =

1
2π
1
2π

for the even modes, and

¯αm

s =

¯βm
s =

(cid:90) π
(cid:90) π

−π

−π

1
2π
1
2π

dθ ˆξA

(m)

dθ ˆξA

(m)

(cid:20)
(cid:20)

−

−

−π

(cid:90) π
(cid:90) π
(cid:18)
(cid:18)

−π

1 +

1 +

dθ tr (R− · ˆξ(m)pT

(n)) =

dθ R−

AB

ˆξA
(m)pB

(n) .

(cid:105)

,

+ R−

ABpB

(s−1)

dθ ˆξA

(m)

p(s+1)
A

dθ ˆξA

(m)

εABpB

(s+1) + R/

ABpB

(s−1)

(cid:105)

,

(cid:19)

(cid:18)

s

s

m + 1

m + 1

εABpB

(s+1) +

p(s+1)
A

+

(cid:18)

1 − s

(cid:19)

m + 1
R−
ABpB

1 − s

m + 1

R/

ABpB

(s−1)

(cid:21)

(s−1)

,

for the odd modes. The spin zero modes are slightly diﬀerent:

αm

0 =

¯αm

0 =

1
2π
1
2π

dθ ˆξA

(m)p(1)
A ,

dθ εAB

ˆξA
(m)pB

(1) .

(cid:104)
(cid:104)
(cid:19)
(cid:19)
(cid:90) π
(cid:90) π

−π

−π

(cid:21)

,

(88)

(89)

(90)

(91)

(92)

(93)

(94)

The extraction of these modes assumes r is constant as a function of θ. If we consider ζ to be on the source plane,
then the integral is taken on circles on the source plane coordinates. Alternatively, if ζ is on the image plane, and
the map projects back to the source, the integrals can be taken as circles on the image.

III. LENSING ROULETTES IN THE WEAK FIELD APPROXIMATION

We have shown so far that the general map which gives ξ(m) at each order may given in terms of the spin coeﬃcients
αs, βs and ¯αs, ¯βs, which are functions of radial distance in the screen space. These independent roulettes are then
summed over as coeﬃcients in a vector Fourier series to give the total map. This decomposition is completely general
and will apply even if we were brave enough to use the fully non-linear GDE to calculate the maps.

We shall now specialise to the standard weak ﬁeld situation – where we linearise around Minkowski space – to

illustrate how this happens.

A. The weak ﬁeld approximation

We shall now linearise around Minkowski space. We shall write our perturbations with respect to the Poisson gauge,

where

ds2 = (cid:2) − (1 + 2Φ)dη2 + (1 − 2Ψ)γijdxidxj(cid:3) .

The Jacobi maps in the background become

J = χI,

K = I .

(95)

(96)

By linearising the Jacobi map we are making an approximation which is not strictly valid in the strong ﬁeld regime.
The projected part of the Riemann tensor is, to leading order in derivatives of the potential,

Here, the screen space derivative acting on a scalar is

RAB = δAB − ∇A∇B(Φ + Ψ) .

χ∇ = ˆeϑ∂ϑ +

ˆeϕ
sin ϑ

∂ϕ ,

(97)

(98)

14

where ϑ, ϕ are coordinates about the observer.
(As we are keeping only the maximum number of screen space
derivatives, we can ignore any rotation coeﬃcients which would appear in a more accurate calculation [2].) From this
(cid:19)
dχ(cid:48)(cid:18) χ
we can give the generic image-to-source map as (for m ≥ 2)
χ(cid:48) − 1

(cid:90) χ

AB1···Bm

= −

M(cid:38)

0

= −χm+1∇A∇B1 ···∇Bm

while the source-to-image map is

M(cid:45)

AB1···Bm

= −

(cid:90) χ

0

dχ(cid:48)(cid:18) 1

χ

− 1
χ(cid:48)

= ∇A∇B1 ···∇Bm

where we have used

(cid:90) χ

0

χ∇A

dχ(cid:48)f (χ(cid:48)) =

0

0

(cid:19)

(Φ + Ψ) ,

dχ(cid:48)(cid:18) χ
χ(cid:48) − 1

(cid:90) χ
χ(cid:48)m+1∇A∇B1 ···∇Bm (Φ + Ψ)
(cid:19) χ(cid:48)m+1
dχ(cid:48)(cid:18) χ
(cid:90) χ
χm ∇A∇B1 ···∇Bm(Φ + Ψ)
χ(cid:48) − 1
(cid:90) χ

(Φ + Ψ) ,

(cid:19)

0

dχ(cid:48)χ(cid:48)∇Af (χ(cid:48)) .

(99)

(100)

(101)

Strictly speaking the indices here are on the spherical screen space about the observer, which is why they do not
commute with the integrals. To convert to a ﬂat sky approximation with Cartesian coordinates we replace ∇A (cid:55)→ ∂A
on the second line in each expression – i.e., with the derivatives outside the integral. (This is because swapping ∇ and
j ···MAB···,
the integrals involves commuting a tetrad vector with the integral. Then, in coordinates, Mij··· = eA
i ∇A, etc.) The Jacobi map arrises when m = 1 and is normally deﬁned as the map from observer to
and ∂i = eA
source. Using (99) to ﬁnd the perturbed part of the Jacobi map, gives:

i eB

JAB = χAAB = χδAB − χ2∇A∇B

(Φ + Ψ) ,

(102)

where we have deﬁned the conventional ampliﬁcation matrix A in the middle. Recognising that χ∇A is a derivative
on the observers celestial sphere, we deﬁne the lensing potential as

(cid:90) χ

(cid:19)
dχ(cid:48)(cid:18) χ
χ(cid:48) − 1

0

(cid:19)

(cid:90) χ

dχ(cid:48)(cid:18) χ − χ(cid:48)

χχ(cid:48)

ψ =

(Φ + Ψ) ,

(103)

giving the ampliﬁcation matrix as

0

(104)
(Note that many authors employ a ﬂat sky approximation replacing ∇A (cid:55)→ ∂A and letting A be a coordinate index
before commuting the derivative with the integral – this gives a diﬀerent form for the lensing potential. ) We therefore
have

AAB = δAB − χ2∇A∇Bψ .

− M(cid:45)

AB1···Bm

= χ−(m+1)M(cid:38)
AB1···Bm
= −χ∇A∇B1 ···∇Bmψ
= χ−1∇A∇B1 ···∇Bm−2ABm−1Bm .

(105)

Given this, let us deﬁne the dimensionless ampliﬁcation tensors as an extension of the ampliﬁcation matrix:

AAB1···Bm = −χm+1∇A∇B1 ···∇Bm ψ

= χ−1M(cid:38)
= −χmM(cid:45)

AB1···Bm
AB1···Bm

.

15

(106)

Constructing the normal modes of this dimensionless tensor will then trivially give both the image-to-source and
source-to-image maps. The fact that this dimensionless map is just angular derivatives of the ampliﬁcation matrix
recovers the usual approach to higher-order lensing such as ﬂexion, as a Taylor expansion of the ampliﬁcation matrix –
but this is only valid in the approximations used here.

B. Circularly symmetric lens in the thin lens approximation

s and βm

The simplest case to consider
is that of a rotationally symmet-
ric lens such as a point source or
an isothermal sphere. Our aim is
to give the amplitudes of the nor-
mal modes αm
s as func-
tions of distance from the lens.
We shall do these for the dimen-
sionless map AAB1···Bm since the
source-to-observer and observer-
to-source modes being trivially
found from (106). Anticipating
the thin lens approximation, we
shall use Cartesian X, Y coordi-
nates centred on the lens in the
lens plane, with the distance from
X 2 + Y 2 (cid:39)
the lens centre R =
χLϑ, where ϑ is the angle at
the observer from the centre of
the lens. For a circularly sym-
metric lens we have the lensing
potential ψ = ψ(R). We de-
note ψ(cid:48) = ∂Rψ(R). (For a more
general lens in the ﬂat sky ap-
proximation, we can just replace
ψ(R) → ψ(X, Y ; χ) and χL → χ
in these expressions below – X, Y
are then coordinates at distance χ
from the observer.) We illustrate
the coordinates we use in Fig. 4.
s we re-

To construct αm

s and βm

√

quire

FIG. 4: The coordinates used in the thin lens approximation.

ˆζ B1 ··· ˆζ Bm

A = AAB1···Bm
ˆξ(m)
m(cid:88)
ˆζ B1 ··· ˆζ Bm∇A∇B1 ···∇Bmψ(R)
cosm−k θ sink θ ∂A∂m−k

= −χm+1
= −χm+1

(cid:18)m
(cid:19)

L

L

k

k=0

(cid:12)(cid:12)(cid:12)(cid:12)source position

X ∂k

Y ψ(R)

.

(107)

Then we have, for s > 0,

Similarly, we ﬁnd

where

The integrals do not evaluate trivially so we deﬁne the symbols

and derive the formula for evaluating them in Appendix A. We have

(cid:90) π

(cid:16) ˆξ(m)
(cid:18)m
m(cid:88)

dθ

αm

s =

1
π

−π
= −χm+1

L

X cos θ + ˆξ(m)

Y

(cid:19)(cid:20)
(cid:18) 1

X

s

k

π

∂m−k+1

=

k=0

−π

−π

1
π

C m(k)

Y ψ(R)

+∂m−k

X ∂k+1

(cid:90) π
(cid:90) π
(cid:18)m
(cid:19)(cid:20)
m(cid:88)
s = −χm+1
αm
(cid:18)m
(cid:19)(cid:20)
m(cid:88)
(cid:90) π

s = −χm+1
βm

k=0

k=0

k

k

L

L

S m(k)

s

=

1
π

−π

(cid:17)

sin θ

∂k
Y ψ(R)

cos sθ

(cid:18) 1

(cid:90) π

π

−π

dθ sink θ cosm−k+1 θ cos sθ

(cid:19)(cid:21)

dθ sink+1 θ cosm−k θ cos sθ

.

dθ sink θ cosm−k+1 θ cos s θ ,

(cid:21)
(cid:21)

∂m−k
X ∂k

Y ψ(R) .

∂m−k
X ∂k

Y ψ(R) ,

C m(k)

s

S m(k)

s

∂X + C m(k+1)

s

∂Y

∂X + S m(k+1)

s

∂Y

dθ sink θ cosm−k+1 θ sin s θ .

(cid:19)

16

(108)

(109)

(110)

(111)

(112)

Eqs. (110) and (111) are the general formula for the amplitudes of the lensing maps at any order or spin, under
the assumption of a weak gravitational ﬁeld and a thin lens with circular symmetry. The odd modes are of course
zero since the ampliﬁcation tensors are symmetric, and the odd modes arise from one anti-symmetric interchange on
the indices. It takes a bit of work to show that they are zero from (107), as the k’th term cancels with part of the
k − 1’th and k + 1’th terms, on using the identities (A12).

We tabulate the ﬁrst few of these moments below. To simplify this we deﬁne the magnitude of a mode as

s =(cid:112)(αm

µm

s )2 + (βm

s )2

(113)

which for a circularly symmetric lens only depends on R not on X or Y individually. The square-root when deﬁning
s below is taken symbolically with the convention that the sign in front of the ψ(cid:48) term is positive. This may not
µm
give a positive deﬁnite magnitude in all cases.

First, m = 1 corresponding to normal linear lensing:

spin-0:

spin-2:

(ψ(cid:48) + Rψ(cid:48)(cid:48)) = κ ,

χ2
µ1
L
0 =
2R
0 = −µ1
β1
α1
0 = 0 ,
0 ,
χ2
(ψ(cid:48) − Rψ(cid:48)(cid:48)) ,
µ1
L
2 =
2R
X 2 − Y 2

2 = −γ1 ,
µ1

α1

2 =

R2

(114)

(115)

(116)

(117)

β1
2 =

2XY
R2 µ1

2 = −γ2 .

We have given the relation with the convergence κ and shear γ1, γ2 as usually deﬁned [6]. Note that the spin-1 mode
is zero in the approximation used in this paper so we do not list it. Now for m = 2 corresponds to weak lensing
ﬂexion:

spin-1:

µ2

1 =

α2

1 =

spin-3:

µ2

3 =

α2

3 =

3χ3
L

4R2 (ψ(cid:48) − Rψ(cid:48)(cid:48) − R2ψ(cid:48)(cid:48)(cid:48)) = − 3

2

F ,

Y
R

µ2
1 ,

µ2
1 ,

β2
1 =

X
R
χ3
4R2 (3ψ(cid:48) − 3Rψ(cid:48)(cid:48) + R2ψ(cid:48)(cid:48)(cid:48)) = G ,
L
X(−X 2 + 3Y 2)

µ2
3 ,

β2
3 =

R3

Y (−3X 2 + Y 2)

R3

(118)

(119)

(120)

(121)

µ2
3 .

17
Again we list only the non-zero spin modes. Here we have made the correspondence with the commonly used F and
G ﬂexion amplitudes [6].

Now for the ﬁrst new modes – m = 3 has

spin-0:

spin-2:

β3
0 = 0 ,

8R3 (ψ(cid:48) − Rψ(cid:48)(cid:48) + 2R2ψ(cid:48)(cid:48)(cid:48) + R3ψ(cid:48)(cid:48)(cid:48)(cid:48))

3χ4
µ3
L
0 =
0 = −µ3
α3
0
χ4
2R3 (3ψ(cid:48) − 3Rψ(cid:48)(cid:48) + R3ψ(cid:48)(cid:48)(cid:48)(cid:48)) ,
µ3
L
2 =
−X 2 + Y 2
2 = − 2XY
β3

2 =

µ3
2 ,

α3

R2 µ3
2 ,

R2

spin-4:

µ3

4 =

α3

4 =

m = 4:

χ4
8R3 (15ψ(cid:48) − 15Rψ(cid:48)(cid:48) + 6R2ψ(cid:48)(cid:48)(cid:48) − R3ψ(cid:48)(cid:48)(cid:48)(cid:48)) ,
L
X 4 − 6X 2Y 2 + Y 4

4XY (X 2 − Y 2)

R4

µ3
4 ,

β3
4 =

R4

µ3
4 .

spin-1:

µ4

1 =

α4

1 =

spin-3:

µ4

3 =

α4

3 =

spin-5:

µ4

5 =

α4

5 =

And so on.

5χ5
L

8R4 (3ψ(cid:48) − 3Rψ(cid:48)(cid:48) + 3R2ψ(cid:48)(cid:48)(cid:48) − 2R3ψ(cid:48)(cid:48)(cid:48)(cid:48) − R4ψ(cid:48)(cid:48)(cid:48)(cid:48)(cid:48)) ,

Y
R

µ4
1 ,

µ4
1 ,

β4
1 =

X
R
5χ5
16R4 (15ψ(cid:48) − 15Rψ(cid:48)(cid:48) + 3R2ψ(cid:48)(cid:48)(cid:48) + 2R3ψ(cid:48)(cid:48)(cid:48)(cid:48) − R4ψ(cid:48)(cid:48)(cid:48)(cid:48)(cid:48)) ,
L
X(X 2 − 3Y 2)

Y (3X 2 − Y 2)

R3

µ4
3 ,

β4
3 =

µ4
3 ,

R3

χ5
16R4 (105ψ(cid:48) − 105Rψ(cid:48)(cid:48) + 45R2ψ(cid:48)(cid:48)(cid:48) − 10R3ψ(cid:48)(cid:48)(cid:48)(cid:48) + R4ψ(cid:48)(cid:48)(cid:48)(cid:48)(cid:48)) ,
L
X(−X 4 + 10X 2Y 2 − 5Y 4)

Y (−5X 4 + 10X 2Y 2 − Y 4)

R5

µ4
5 ,

β4
5 =

R5

(122)

(123)

(124)

(125)

(126)

(127)

(128)

(129)

(130)

(131)

(132)

(133)

µ4
5 .

C. Mass distribution and reconstruction in the thin lens approximation

We can relate these to the lens mass distribution, following [6]. Ignoring peculiar velocity terms we have the Poisson

equation ∇2Φ = 1

2 ρ (in units 8πG = 1 = c) giving

ψ(χS) =

∇−2ρ(χ(cid:48), R) (cid:39)

∇−2

dχ(cid:48)ρ(χ(cid:48), R) ,

(134)

(cid:18) χS − χL

(cid:19)

χSχL

(cid:90) χS

0

where ∇−2 is the inverse 3D Laplacian. In the thin lens approximation we can approximate the integral by the second
step. Writing

(cid:90) χs

0

(cid:19)

χSχ(cid:48)

dχ(cid:48)(cid:18) χS − χ(cid:48)
(cid:90) χS

Σ(R) =

as the projected surface mass density and the critical surface density respectively we have

The projected mass distribution is given by

ψ(R) =

2
χ2
L

ρ(χ, R),

and Σcr =

2χS

χL(χS − χL)

0

(cid:90) R

(cid:90) R2

dR2
R2

0

0

dR1R1

Σ(R1)

Σcr

.

(cid:90) R

0

dR1R1Σ(R1) ,

M (R) = 2π

(135)

(136)

(137)

so that the lensing potential is a ﬁrst integral of the mass:

In terms of the mass, the magnitude of each mode is

ψ(R) =

1
πχ2
LΣcr

(cid:90) R

0

dR2

M (R2)

R2

.

1

2πRΣcr

1

2πRΣcr
χL
3
4

πR2Σcr
χL

2πR2Σcr
3
8

χ2
L

πR3Σcr
χ2
L

2πR3Σcr

χ2
L

χ3
L

2πR3Σcr
5
πR4Σcr
8
5
16

χ3
L

πR4Σcr
χ3
L

,

,

2

R

1
2

− 5
2

M(cid:48) +

[M(cid:48)] ,

− M(cid:48)(cid:21)

M
R
[M(cid:48) − RM(cid:48)(cid:48)] ,

(cid:20)
(cid:20) 4M
RM(cid:48)(cid:48)(cid:21)
(cid:2)M(cid:48) − RM(cid:48)(cid:48) + R2M(cid:48)(cid:48)(cid:48)(cid:3) ,
(cid:2)3M(cid:48) − 3RM(cid:48)(cid:48) + R2M(cid:48)(cid:48)(cid:48)(cid:3) ,
R2M(cid:48)(cid:48)(cid:48)(cid:21)
(cid:20) 12M
(cid:2)3M(cid:48) − 3RM(cid:48)(cid:48) + 2R2M(cid:48)(cid:48)(cid:48) − R3M(cid:48)(cid:48)(cid:48)(cid:48)(cid:3)
(cid:2)15M(cid:48) − 15RM(cid:48)(cid:48) + 6R2M(cid:48)(cid:48)(cid:48) − R3M(cid:48)(cid:48)(cid:48)(cid:48)(cid:3) ,
(cid:20) 24M

RM(cid:48)(cid:48) − 1
4

− 33
4

M(cid:48) +

9
4

R

,

µ1

0 =

µ1

2 =

µ2

1 =

µ2

3 =

µ3

0 =

µ3

2 =

µ3

4 =

µ4

1 =

µ4

3 =

µ4

5 =

18

(138)

(139)

(140)

(141)

(142)

(143)

(144)

(145)

(146)

(147)

(148)

.

(cid:21)

πR4Σcr

R

+

1
16

(−279M(cid:48) + 87RM(cid:48)(cid:48) − 14R2M(cid:48)(cid:48)(cid:48) + R3M(cid:48)(cid:48)(cid:48)(cid:48))

And so on – we list 2 new types of modes at order 3 and 4 to observe the patterns that emerge at higher order.

If we consider the lhs of these equations as observables, we can invert this system to give the derivatives of the lens
s ’s. The

mass distribution directly as linear combinations of them, together with a set of constraints between the µm
mass and its derivatives are given by (the terms are dimensionless)

M

2πR2Σcr

M(cid:48)

2πRΣcr
M(cid:48)(cid:48)
2πΣcr
RM(cid:48)(cid:48)(cid:48)
2πΣcr
R2M(cid:48)(cid:48)(cid:48)(cid:48)
2πΣcr
R3M(cid:48)(cid:48)(cid:48)(cid:48)(cid:48)
2πΣcr

=

1
2

µ1

2 +

µ1
0 ,

1
2

χL

(cid:18) R
(cid:19)
(cid:19)2
(cid:18) R
(cid:18) R
(cid:19)2
(cid:19)2
(cid:18) R

χL

χL

= µ1
0 ,
= − 2
3

=

4
3

=

8
3
= − 4
3

χL

1 + µ1
µ2
0 ,

(cid:18) R
(cid:19)
(cid:18) R
(cid:19)
(cid:18) R

χL

χL

χL

0 − 2
µ3
3

µ3

0 +

2
3
0 − 4
µ3
3

(149)

(150)

(151)

(152)

(153)

(154)

(cid:18) R

(cid:19)4

χL

µ5
0 .

(cid:18) R
(cid:19)3
(cid:19)3
(cid:18) R

χL

µ4
1 ,

µ2
1 ,

1 − 4
(cid:19)
µ2
5
1 − 8
µ2
5

µ4

1 +

8
5

χL

Higher mass derivatives can in principle be reconstructed from the higher order roulettes. These relations can be
viewed as a set of diﬀerential consistency conditions that the µm
s ’s have to satisfy for a circular lens, since each
equation is the derivative of the one above. The higher spin moments are related to the lower spin ones via the

algebraic consistency conditions:

(cid:16) χL

(cid:17)

µ2
1 ,

µ2
1 ,

µ2

3 = 2
4
µ3
µ3
2 =
3
4 = − 1
µ3
3
1
µ4
µ4
3 =
2
5 = − 1
µ4
10

R

R

(cid:17)
(cid:16) χL
2 − 1
µ1
3
(cid:16) χL
(cid:17)
(cid:17)
(cid:16) χL
(cid:17)
(cid:16) χL

4
0 +
3
0 − 4
µ3
3
10
3
1 − 2
µ4

1 +

R

R

R

µ3

µ2

1 + 6
10
0 +
3
0 − 6
µ3

(cid:16) χL
(cid:17)2
(cid:16) χL
(cid:17)2
(cid:16) χL
(cid:17)2

R

R

R

µ1
2 ,

µ2
1 ,

µ2

1 + 24

(cid:16) χL

(cid:17)3

R

µ1
2 .

D. Examples of image construction for circular lenses

Here we shall give some examples to illustrate how the roulettes add together to create a complete image. We
consider examples of a source near the Einstein radius of a lens – where corrections to the ampliﬁcation matrix are of
order unity, and we enter the strong lensing regime. More examples can be found in Paper I.

A point mass can be characterised as Σ(R) ∝ δ(R) implying that the projected mass M is a constant. For this
simple case we can derive general formula for any order. The critical surface density can be recast into the Einstein
radius

1. Point Mass

Then the amplitude of the non-zero modes are given by

Σcr =

M
πR2
E

=

M
πχ2
Lϑ2
E

.

µm

m+1 = m!

R

(cid:18) RE

(cid:19)2(cid:16) χL

(cid:17)m−1
R
s = (−1)sµm

.

19

(155)

(156)

(157)

(158)

(159)

(160)

(161)

(162)

(163)

If we place our source on the X axis then we have βm
s , simplifying things considerably. Recall
that in this formalism these are considered constants over the source/image and so R will be the location of the centre
of the source (say) and does not vary over it.

s = 0 and αm

What do these roulettes do to a source? Consider the image-to-source case. If we have a point on the image plane
ζ = ζ ˆζ = (x, y)/χL, where ζ = r/χL is the radial coordinate in the image plane (or the angular distance measured
by the observer) in coordinates centred at the image, this is mapped to a location on the source plane given by

((cid:38))

ξ(source)
A

= χSζA + χS

AAB1···Bm

ˆζ B1 ··· ˆζ Bm .

ζ m
m!

which becomes in coordinates

((cid:38))

(cid:19)

(cid:18) χL

χS

(cid:19)(cid:18)x(cid:48)

y(cid:48)

(cid:18)cos θ

(cid:19)

sin θ

= r

∞(cid:88)

(−1)m(cid:16) r

(cid:17)m(cid:18) cos mθ

− sin mθ

(cid:19)

.

R

− R2
E
R

m=1

∞(cid:88)

m=1

If we consider this as a set of parametric equations for x(cid:48), y(cid:48), lines of r = const. will be shapes of sources which create
circular images. More usefully, if we consider an intensity proﬁle which is a function of x(cid:48)2 + y(cid:48)2 then the level surfaces
of this function in (x, y) image plane coordinates will be images formed corresponding to circles in the source plane.
These series will only absolutely converge for all angles for r < R, which places a limit on the size of the source
one can usefully consider. This is only important for a large source observed close to the Einstein radius, but it also
means that secondary images cannot be reconstructed using the same series as the primary image; a second series with
diﬀerent X, Y coordinates at the centre of each image can be used for multiple images. The series can be summed

20
however, and analytically continued outside of this region by writing rm cos mθ = (cid:60)(rmeimθ), etc., and using the
geometric series. This gives:

(cid:19)(cid:18)x(cid:48)

(cid:19)

(cid:18) χL

χS

= r

y(cid:48)

(cid:18)cos θ

(cid:19)

sin θ

((cid:38))

(cid:32) r

(cid:33)

+

R2

Er

r2 + R2 + 2rR cos θ

+ cos θ
R
−sin θ

(164)

Consider a large source with a Gaussian intensity proﬁle e−(x(cid:48) 2+y(cid:48)2)/2σ2

This is the usual equation for lensing from a point mass in slightly unfamiliar form, with the centre of the source
shifted by (χS/χL)(R2
E/R). The key diﬀerence from the usual form of this equation is that the formalism here uses
a sort of Born-like approximation: the light on the centre of the source travels on a straight line, so given an image
position, the source position is given in the ‘wrong place’, but with the correct shape.
with σ = 1/6(χL/χS)RE, located near the
Einstein radius, with R = 1.3RE in the lens plane (corresponding to a true unlensed position of (cid:39) (χS/χL)0.53RE
from the centre of the lens). This is something which should normally be considered in the strong lensing regime, but
we can accurately recover the principal image using enough roulettes. (The secondary image is recovered from the
analytic continuation of the full sum of roulettes.) Given that the series is divergent for r ≥ R, we expect (and ﬁnd)
problems at this radius. Even though this is a fairly trivial example, the series tells us a lot about the roulettes which
go into making the whole image.

Consider Fig. 5. This takes each mode individually acting on the source.

In the top row we see the familiar
shearing into an ellipse, and ﬂexion distorting into a triangular shape. Higher roulettes distort into bulging squares,
pentagons, hexagons, etc., with the symmetry of the shape determined by the spin of the mode. The spin is clearly
seen in the second row where the initial image is subtracted oﬀ. In the ﬁnal row we have zoomed out from the central

FIG. 5: A circular source located at apparent location R = 1.3RE from a point mass, with width σ = 1/6(χL/χS)RE
(corresponds to a full width at half maximum of about 0.4(χL/χS)RE). Here we consider the eﬀect of each mode individually.
In the second row red is positive and blue negative (the relative amplitudes between plots is not ﬁxed; the number of contours
is ﬁxed instead).

image to reveal s spurious images originating outside the radius of convergence. These images occur at points where
x(cid:48)2 + y(cid:48)2 = 0, which for the m’th roulette is when

(cid:19)(m+1)/(m−1)

(cid:18) R

RE

r
RE

=

and θ =

m − 2k
m + 1

π,

k ∈ Z ,

(165)

and in the limit of large m these approach the radius of convergence, forming a ring of images around the source
which must be removed. For extended sources, particularly near the Einstein radius, these extra images blend into
the principal image.
Now let us consider how these images ‘sum’ to give a complete lensed image, illustrated in Fig. 6, using the image-
to-source map ((cid:38)). We consider the same lens-source set-up, but now add progressively more roulettes to the image.

21

FIG. 6: The same lens-source conﬁguration as in Fig. 5. Here we consider the eﬀect of summing up to a given mode indicated,
so show how the series converges to give the full principal image. Top left we show the unlensed source, which has a strongly
lensed image shown bottom left. In the middle panel of 12 ﬁgures we add more roulettes to each image (from left to right, then
top to bottom), with m indicating the number of roulettes added. On the right we show a fully formed image surrounded by
a ring of m + 1 spurious images.

In this example we see that the shear and ﬂexion give very poor approximations to the correct image. As we add
more roulettes, the image takes shape by around m ∼ 10, but has problems around the edge where the image blends
into the spurious images. However, for m suﬃciently large the principal image and the spurious images split apart,
and we see the true image appear fully resolved. The secondary image is outside the radius of convergence and is not
recovered. This can be found instead by choosing X, Y at the centre of that image instead.
An alternative way to look at the convergence of the series is to consider the partial sum roulettes in (163) as
parametric equations for (x(cid:48), y(cid:48)) for ﬁxed r and parameter θ ∈ [0, 2π). Such curves show the curves in the source

FIG. 7: Shapes in the source plane that get distorted into a circle of radius shown (with (χL/χS)RE = 1). It’s not a physically
relevant scenario, but we see the equivalent of the spurious images are the cusps in the curves with large radius. Adding more
maps cancels out these cusps order by order.

plane which would be distorted into a circle in the image plane.

For an isothermal sphere, we have, [6],

2. Singular Isothermal Sphere

Σ(R) =

RE
2R

Σcr ⇒ M (R) = πΣcrRER , ψ(R) =

RER
χ2
L

.

22

(166)

The amplitudes of the roulettes cannot be found to obey a simple formula as in the point mass case, as they require
the full set of the trig integrals discussed in the appendix. We tabulate the ﬁrst few as



22m−1Rm
m!REχm−1

L

µm

s =

s = 0

1
0
2
0
12
0
100
0
980
0

m = 1
2
3
4
5
6
7
8
9
10

1
0
3
0
10
0
70
0
630
0

2
1
0
8
0
30
0
224
0

2100

3

4

5

6

7

8

9

10

11

3
0
25
0
98
0
756
0

10
0
84
0
336
0

35
0
294
0

126
0

1056

462
0

1716

1188

0

3861

0

6435

2640

0

4290

0

14300

0

24310

6468

0

7260

0

9438

0

15730

0

53482

0

92378



. (167)

The important thing is the power fall oﬀ with distance from the lens, which is one power of R slower than the point
mass case

(cid:16) χL

(cid:17)m−1

s ∼ RE
µm
R

R

,

(168)

together with the fact that for each mode the higher spin contributions are largest. By contrast with the point mass
case, an SIS induces diﬀerent spin modes at each order, whereas the point mass only produces modes with s = m + 1.
In Fig. 8 we consider the same physical set-up as in the previous example with a point mass lens, again using the
source-to-image map. We show how each roulette modiﬁes the circular source image, by adding a single mode and
subtracting the original source. We then add up the spins for each degree to show how an image is modiﬁed order by
order. We have spin-0 modes for odd degrees, which modify the overall size of the source. This implies that a source
will be larger than the standard convergence would predict. Regarding the other modes, the roulettes with s = m + 1
look similar to the case of a point mass lens, but slightly less distorted as expected (there is less lensing mass inside
a sphere of radius R). Roulettes with s < m + 1 are rather diﬀerent in shape, and the changes to the image happen
father from the image centre for larger m, and s ﬁxed. Note that these ﬁgures are not quite symmetrical, most easily
seen in the s = 1 case (the red kidney is slightly larger than the blue).

Finally, let us consider how those modes sum to a complete image, but using the image-to-source map, for the same
physical consideration. In this case the derived equations for (x, y) can be considered as parametric equations with
parameter θ. (The equations wind up the same, with coordinates shifted to the source plane, but with a sign change
in front of the roulette sum, and we shift the lens position to R = 0.3.) Then, lines of constant r correspond to circles
in the source plane and are mapped to curves in the image plane. When the image has converged we would get the
same picture as using the image-to-source method previously, but the convergence approach is diﬀerent so interesting
to show. We consider in Fig. 9 adding up the modes in two diﬀerent ways. In the top row we add up to a ﬁxed m
shown, including all the spin modes up to that order – this is the natural way to add up the modes as each mode
contributes a factor of RE/R less. So, for m = 1, we include the shear and convergence, and for m = 2 we add in
the ﬂexion. Near the centre of the image this is reasonably accurate, but far from it it is not. For large m we recover
the exact image. It is also instructive to add in each spin type one at a time – we show this in the second row. We
ﬁx m = 26, and add up all the spin-0 modes, then the spin-1 modes and so on, until the image is constructed. Note
that the wobbles and cusps on the outer curves for small m are the equivalent of the spurious images found in the
image-to-source case above, and curves of larger radius display extravagant loops. Even with m ∼ 25, larger circles
than shown have still not converged. The image shown here corresponds to that found by using the exact solution
directly.

23

FIG. 8: A SIS as in Fig. 5, showing how each roulette modiﬁes the image.

FIG. 9: A SIS as in Fig. 5, showing how the series of roulettes sums to give a complete image when added in diﬀerent ways.
The source is shown on the left and the magniﬁed image on the right (calculated with m = 26) – these are shown to scale, with
the Einstein radius of the lens shown for reference. In the top row we ﬁx the maximum m used, and add up all the possible
spins. In the bottom row we add up all possible spins up to the maximum shown.

IV. SUMMARY AND CONCLUSIONS

We have presented a new extension of the usual weak lensing formalism which can be accurately used in the strong
lensing regime to reconstruct the image(s) of the source. By expanding the general solution of the non-linear geodesic
deviation equation in the screen space, one can add to the usual Jacobi map a series of lensing maps of arbitrary order,
given by tensors of increasing rank. We have shown how a map at each order can be invariantly decomposed into
a set of trace-free tensors representing the invariant degrees of freedom and spin modes of the map. Then we show
how to reduce these trace-free tensors into distortions on the plane, which are the normal modes we call roulettes.
These extend the convergence, shear and ﬂexion familiar from weak lensing to arbitrary order, providing a completion

24

of the weak lensing formalism. A complete image can be given as an appropriate two dimensional sum over these
roulettes. The amplitude of each roulette can be found from integrating in a circle around a point in the image.
These amplitudes are related to derivatives of the mass distribution of the lens in the weak ﬁeld approximation. More
generally, they are derivatives of the lensing potential perpendicular to the line of sight. We then gave a couple of
examples of explicit image reconstruction for a point mass and a singular isothermal sphere, complementing those in
Paper I. Although these examples are rather simple, and the exact solutions known, they are really useful to test out
the method and present how an image is constructed in the strong lensing regime.

An intriguing use for this formalism lies, in principle, in being able to reconstruct the mass distribution if one can
extract the amplitudes and orientation of the roulettes. So, given an observation of lensed galaxies around a lens,
each lensed imaged would give an estimate of the mass and its ﬁrst few derivatives at the image position. From
this the entire lens mass distribution could – in principle – be reconstructed. This, together with more accurate lens
modelling, is left for future work.

I would like to thank David Bacon and Julien Larena for discussions. This work is funded by the National Research

Foundation (South Africa).

Acknowledgments

Appendix A: Notes on the trig integrals

Here we collect together some notes on the trig integrals appearing in the spin decomposition of the maps. The key

integrals are

C m(k)

s

=

S m(k)

s

=

dθ sink θ cosm−k+1 θ cos s θ ,

dθ sink θ cosm−k+1 θ sin s θ .

(cid:90) π
(cid:90) π

−π

−π

1
π
1
π

These are surprisingly complicated functions of k, m, s. To evaluate we use the identity

For odd powers these integrals give zero. Now expand the cos sθ and sin sθ using

(cid:90) π/2
(cid:90) π

0

−π

1
π

dθ sin2p−1 θ cos2p−1 θ =

Γ(p)Γ(q)
2Γ(p + q)

,

dθ sin2p θ cos2p θ =

2

4p+q

(2p)!(2q)!
p!q!(p + q)!

.

(−1)k

cosn−2k θ sin2k θ ,

(cid:19)
(cid:18) s
(cid:18) s

2k

(cid:19)

s/2(cid:88)
(s−1)/2(cid:88)

k=0

k=0

cos sθ =

sin sθ =

(−1)k

2k + 1

cosn−2k−1 θ sin2k+1 θ ,

(A1)

(A2)

(A3)

(A4)

(A5)

(A6)

from which it follows

to give

C m(k)

s

=

S m(k)

s

=




s/2(cid:88)

(−1)j

j=0

(cid:18) s

2j

1

2s+m

0

(cid:19) (2(p + j))!(2(q − j))!

(p + j)!(q − j)!(p + q)!

if

k is odd or s + m is even

, where 2p = k, 2q = s + m − k + 1

,

(A7)

(s−1)/2(cid:88)

(−1)j

j=0

1

2s+m

(cid:18) s

2j + 1

0

(cid:19) (2(p + j))!(2(q − j))!

(p + j)!(q − j)!(p + q)!

if

k is even or s + m is even

, where 2p = k + 1, 2q = s + m − k

. (A8)

For small values of k, m, s these integrals are tabulated below. Note that C 1(0)
non-zero values.

0

= 1 and S 2(1)

1

= 1/4 are the ﬁrst

25

TABLE I: Non-zero values of 2mC m(k)

s

.

m = 3 k = 0 k = 2
s = 0
s = 2

2
0

6
4

m = 4 k = 1 k = 3
s = 1
s = 3

2
3

2
1

m = 5 k = 0 k = 2 k = 4
s = 0
s = 2
s = 4

4
−1
−2

4
1
−2

20
15
6

m = 7 k = 0 k = 2 k = 4 k = 6
s = 0
s = 2
s = 4
s = 6

6
0
−4
0

10
4
−4
−4

10
−4
−4
4

70
56
28
8

m = 9 k = 0 k = 2 k = 4 k = 6 k = 8
s = 0
s = 2
s = 4
s = 6
s = 8

12
28
−2 −14
−8
−8
13
3
−6
2

12
28
2
14
−8
−8
−13 −3
−6
2

252
210
120
45
10

TABLE II: Non-zero values of 2mS m(k)

s

m = 6 k = 1 k = 3 k = 5
s = 1
s = 3
s = 5

5
1
−3

3
3
−1

5
9
5

m = 8 k = 1 k = 3 k = 5 k = 7
s = 1
s = 3
s = 5
s = 7

6
8
0
−3

6
4
−4
−1

14
0
−8
5

14
28
20
7

m = 10 k = 1 k = 3 k = 5 k = 7 k = 9
s = 1
s = 3
s = 5
s = 7
s = 9

10
42
−6
10
−5 −11 −21
−5
19
−7
1

14
22
5
−7
−5

42
90
75
35
9

14
6

1
3

An alternative way to calculate these is to use recurrence relations for k, m, s (or just use Maple!). These are easily

derivable from trig identities:

− C m−2(k)

C m(k+2)

s
s−1 + C m(k)
C m(k)

+ C m(k)
s+1 − 2C m+1(k)

s

s

s

= 0 ,

= 0

and by integrating by parts twice:

(m − k + 1)(m − k)C m(k+2)

s

+ [s2 + 2k2 − (2k + 1)(m + 1)]C m(k)

s

+ k(k − 1)C m(k−2)

s

= 0 ,

(A9)

(A10)

(A11)

with similar identities for S m(k)
gravitational ﬁeld approximation. These are found by integrating by parts once:
+ (k − m)C m(k+2)

s

s

. Some identities are essential for proving that the odd modes are zero in the weak

sS m(k+1)
s
sS m(0)
sS m(m+1)

s

s

s

= (k + 1)C m(k)
= −(m + 1)C m(1)
= (m + 1)C m(m)
.

s

s

,

,

(A12)

(A13)

(A14)

Again there are similar identities for C m(k)

s

which are required for ¯βm
s .

[1] C. Clarkson, arXiv:1603.04698 [astro-ph.CO].
[2] C. Clarkson, JCAP 1509, no. 09, 033 (2015) doi:10.1088/1475-7516/2015/09/033, 10.1088/1475-7516/2015/9/033

[arXiv:1503.08660 [gr-qc]].

[3] J. Vines, Gen. Rel. Grav. 47, no. 5, 59 (2015) doi:10.1007/s10714-015-1901-9 [arXiv:1407.6992 [gr-qc]].
[4] M. G. Pawley, Journal of the Franklin Institute, 307 2 155 (1979)
[5] P. G. Castro, A. F. Heavens and T. D. Kitching, Phys. Rev. D 72, 023516 (2005) doi:10.1103/PhysRevD.72.023516 [astro-

ph/0503479].

[6] P. Lasky and C. Fluke, Mon. Not. Roy. Astron. Soc. 396, 2257 (2009) [arXiv:0904.1440 [astro-ph.CO]].

