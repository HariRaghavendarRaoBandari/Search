6
1
0
2

 
r
a

M
 
7
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
2
2
7
5
0

.

3
0
6
1
:
v
i
X
r
a

MODEL ORDER REDUCTION VIA POD-DEIM FOR THE

ESTIMATION OF CARDIAC CONDUCTIVITIES

HUANHUAN YANG, ALESSANDRO VENEZIANI∗

Abstract. Cardiac conductivity estimation in the monodomain model for electrocardiology is
crucial for its use in patient-speciﬁc settings, because the model is strongly sensitive to the conduc-
tivity parameter. Eﬃcient and reliable estimation of this parameter is challenging due to the high
computational cost from the monodomain solver and to the diﬃculty on model reduction resulted
from the speciﬁc features of potential propagation in cardiac tissues (including wave-front propaga-
tion dynamics). This paper aims at applying model reduction techniques to dramatically decrease
the computational cost of solving the inverse problem of cardiac conductivity estimation. The Proper
Orthogonal Decomposition (POD) approach is taken for forward model reduction, along with the
Discrete Empirical Interpolation Method (DEIM) for tackling nonlinearity. A derivative-based opti-
mization is then employed on the reduced model for conductivity estimation. In the application of
this POD-DEIM combination, we eﬀectively sample the parameter space based on polar coordinates
and densify the appropriate region of the sample space utilizing Gaussian nodes. The computational
eﬀort is eventually reduced by at least 90%.

Key words. cardiac conductivity, monodomain model, proper orthogonal decomposition, dis-

crete empirical interpolation

1. Introduction. In recent decades, computational electrocardiology has been
highly attractive to researchers not only in academia but also in medicine. Computa-
tional methods have been continuously reﬁned and made closer to clinical application.
Just to mention one example, the ideal lesion pattern with minimal burn in a cardiac
ablation therapy has been studied in [21] by electrocardiological modeling. However,
to provide reliable and also eﬃcient simulations of cardiac electrical activity is not an
easy task. The current bidomain/monodomain model in electrocardiology depends
on parameters that typically come from empirical constitutive laws, their quantiﬁ-
cation for a speciﬁc patient is diﬃcult.
In particular, the model is strongly sensi-
tive to the cardiac conductivity parameter [19]. While experimental data generally
disagree on the values of conductivities, mathematically sound estimation methods
(generally based on the solution of an inverse problem) have been considered only
recently [18, 35, 36]. In addition, electrocardiological modeling for clinical application
is usually computationally intensive. This is even more true for the associated inverse
problem, as high computational cost arises in many “queries” of forward simulations
with diﬀerent conductivity values. Model-order-reduction techniques have been in-
vestigated in the literature, but their application to cardiac conductivity estimation
is challenging, due to the nonlinearity of the model and the speciﬁc features like
wave-front propagation of its solution. In this paper, we apply model reduction tech-
niques that are expected to dramatically decrease the computational cost of solving
the inverse conductivity problem.

A numerical solution to the forward problem by Galerkin projection can be rep-

n(cid:80)

resented, in general terms, as an expansion uh(x, t) =
ments, the basis {φj}n
j=1 is of general purpose thus leads to a large number of degrees
of freedom n to get an accurate solution. Model reduction techniques aim at cheaply
solving the forward equations in a low-dimensional space still by a Galerkin projec-
tion process. They construct a rather small set of basis functions (known as reduced

uj(t)φj(x, t). In ﬁnite ele-

j=1

∗Department of Mathematics and Computer Science, Emory University, Atlanta (GA) USA,

ale@mathcs.emory.edu, yanghuanhuan85@gmail.com

1

basis) which we deﬁne “educated” so that it includes features of solutions to the for-
ward problem considered. This allows to represent a solution eﬃciently and solve the
degrees of freedom uj cheaply, thanks to the small size n.

Among various techniques for the reduced basis construction (see the recent re-
view [4]), typical ones are the Proper Orthogonal Decomposition (POD) approach [15,
22], the Greedy Reduced Basis (GRB) approach [8, 29], and their combination [20]. In
these approaches, the reduced basis is constructed from a set of parameter-dependant
solutions of the full-order model. The POD approach has drawn widespread attention
for its optimal ability to approximate the snapshots of solution with minimized error
by the selection of the most energetic modes. The GRB approach selects the snap-
shots carefully with a greedy selection process according to a rule controlled by an
eﬀective a posteriori error estimator. Although eﬀective in the small number of snap-
shot computations, the requirement of a rigorous error estimator makes it applicable
only to a limited class of problems where an error estimator is achievable.

In this paper we employ the POD approach as a starting point. The POD ap-
proach has been used in numerous ﬁelds of science and engineering such as ﬂuid-
structure interaction [5] and aerodynamics [9], but its practical application in elec-
trocardiology only starts from [6] in 2011. Although it allows reasonable estimation
of ionic model parameters in [6], a proper technique for nonlinear approximation was
not carried out and no study on the improvement of eﬃciency was reported.

The bidomain/monodomain model considered in this paper is nonlinear, so its
reduced-order model obtained by Galerkin projection has computational complexity
still depending on the full order. Several techniques are available in general to re-
duce the cost of evaluating nonlinear terms, such as the trajectory piecewise-linear
(TPWL [30]) approach, the Best Point Interpolation Method (BPIM [24]), the Empir-
ical Interpolation Method (EIM [2]) and its discrete variant Discrete EIM (DEIM [12]).
Although TPWL was successfully applied to some practical problems, it may not be
eﬀective or eﬃcient for systems with high order of nonlinearity. The BPIM and EIM
approaches are similar [17], both select a small set of spatial interpolation points to
avoid the expensive calculation of inner products and use the points for nonlinear ap-
proximation. BPIM is optimal in the point selection and gains a little improvement
on accuracy, but it is more computational expensive. As a result, we resort to EIM
and use its discrete variant DEIM.

In this paper, we apply the POD-DEIM model reduction approach for the inverse
conductivity problem. The POD-DEIM approach for an eﬀective solution of the
FitzHugh–Nagumo system arising in neuron modeling—which is equivalent to the
monodomain equation in 1D coupled with the FitzHugh–Nagumo ionic model—has
been investigated by Chaturantabut [11]. The model parameters were prescribed a
priori in that study. The present work is an application of the POD-DEIM method
on the parameterized monodomain model in 3D for conductivity estimation, and it
is detailed in [35].
Its application to the bidomain model will be the subject of a
forthcoming work.

After a brief statement of the full-order monodomain inverse conductivity problem
(MICP) in a discrete form (Sec. 2), the POD-DEIM approach is introduced (Sec. 3)
and applied to solve a reduced MICP (Sec. 4) by derivative-based optimization. The
reduced-order model is tested in Sec. 5: we investigate both the eﬃciency and accuracy
of the POD-DEIM approach in conductivity estimation. We report both pitfalls and
successful examples when customizing POD-DEIM to our speciﬁc problem. A rather
small set of samples is obtained by sampling the parameter space based on polar

2

coordinates and reﬁning the sampling in the “small angle–short arc” zone of the
sample space utilizing Gaussian nodes. Using the POD-DEIM reduced order model,
the computational eﬀort can be reduced by at least 90% in conductivity estimation.

2. The full-order monodomain inverse conductivity problem.

The cardiac bidomain and monodomain models. The bidomain model is
considered as the most physiologically founded description for the dynamics of cardiac
electric potentials—the transmembrane potential u and the extracellular potential
ue—at the level of cardiac tissue. Its parabolic-elliptic form (see e.g. [27, 36]) reads

 βCm

∂u
∂t

− ∇ · (σi∇u) − ∇ · (σi∇ue) + βIion(u, w) = Isi

−∇ · (σi∇u) − ∇ · (σi + σe)∇ue = Isi − Ise

in Ω × [0, T ]
in Ω × [0, T ]

(2.1)

with initial condition u(x, 0) = u0(x). Typically, homogeneous Neumann boundary
conditions are prescribed to model an isolated tissue. Here Ω ⊂ R3 is a spatial domain
denoting the interested piece of cardiac tissue and [0, T ] is a ﬁxed time interval. The
symbol Cm is the membrane capacitance per unit area with β being the surface-to-
volume ratio of the membrane; σi (σe) is the intracellular (extracellular) conductivity
tensor; Isi (Ise) represents the intracellular (extracellular) stimulation current. An
explicit form of the total ionic current Iion would be described by a coupled ionic model
in which the gating variable w is used to control the depolarization and repolarization
phases of the cardiac action potential. The time evolution of the gating variable w is
generally modeled in the form

+ g(u, w) = 0

in Ω × [0, T ]

dw
dt

with initial condition w(x, 0) = w0(x).

We can represent the conductivity tensors as σk(x) = σkl(x)alal

T +
T , where k stands for i or e, (al, at, an) are orthonormal vectors related
σkn(x)anan
to the structure of the myocardium with al parallel to the local ﬁbre direction. We
further assume that the tissue is axial isotropic (i.e. σkn = σkt) and postulate the
conductivity [σkl, σkt] to be constant, as has been done by several groups [13, 31] for
conductivity estimation in experiments.

T +σkt(x)atat

The bidomain model has been widely used due to its ability to reproduce cardiac
phenomena [33]. However, its solution for clinical application requires high computa-
tional cost, since the model takes a degenerate system of PDEs and the mesh and time
constraints are signiﬁcant in simulating fast potential variation. The monodomain
model as a heuristic approximation of the bidomain model has been proposed to pro-
vide computational improvements. Its derivation [25] was based upon a proportion-
ality assumption σe = λσi, where λ is a constant. A formulation of the monodomain
model is then obtained, by denoting σm = λ

1+λ σi and Iapp = λ

1+λ Isi + 1

1+λ Ise, as

βCm

∂u
∂t

− ∇ · (σm∇u) + βIion = Iapp

in Ω × [0, T ].

(2.2)

Although the assumption on its derivation lacks physiological foundation, the
monodomain model has been intensively used in clinic-oriented simulations [3, 34]
since it requires signiﬁcantly less computational eﬀorts than the bidomain model.
More importantly, a comparison between the bidomain and monodomain models in [7]

3

Fig. 2.1: The reconstruction of poten-
tial by the monodomain solver, computed
with the estimated conductivity [σml, σmt] =
[1.704, 0.3551], gives an excellent matching
with the bidomain solution, which is com-
puted with [σil, σel, σit, σet] = [3.5, 3, 0.3, 1.8].

concluded that the discrepancy between the models at the continuous level may be
quite small: of order 1% or even below in terms of activation time relative error.

We resort to the monodomain model in this paper for the cardiac conductivity
estimation, following the “potential oriented” line. Namely, we speculate that an
appropriate estimate of the conductivity tensor σm based on our variational procedure
can still lead to an accurate reconstruction of the potential propagation. This is
demonstrated by the numerical result shown in Fig. 2.1, where the bidomain solution
u was computed on a slab mesh with [σil, σel, σit, σet] = [3.5, 3, 0.3, 1.8] and was used
as synthetic measure to estimate the conductivity σm in the monodomain solver. The
reconstruction of potential by the monodomain solver with the estimated conductivity
[σml, σmt] = [1.704, 0.3551] gives an excellent matching with the bidomain solution.

In the following subsection, we describe the time and space discretization schemes
for the full-order monodomain model, and state the monodomain inverse conductivity
problem in a discrete version. In particular, we couple the monodomain solver with
the classical Rogers–McCulloch ionic model [32], given by

Iion(u, w) = Cm[β1(u − Vr)(u − Vth)(u − Vp) + c2(u − Vr)w]
g(u, w) = −β2(u − Vr) + bdw

(2.3)

c1

(Vp−Vr)2 , β2 =

with β1 =
. The values of ionic model parameters are taken
from [16] since they create more realistic action potential than values in the original
publication [32]: Cm = 1 µFcm−2, Vr = −85 mV, Vth = −72 mV, Vp = 15 mV,
c1 = 11.54 ms−1, c2 = 4.4 ms−1, b = 0.012 ms−1, d = 1.

b

Vp−Vr

Time and space discretization. To improve the computational eﬃciency, we
split the monodomain problem into a PDE part and an ODE representing the Rogers–
McCulloch model. The ODE gating variables are integrated with an implicit backward
Euler method. The PDE is solved with a backward diﬀerentiation formula (BDF)
based semi-implicit method. The nonlinear terms are tackled by an explicit second-
order time extrapolation [36]. Let ∆t be the time step, we deﬁne L = T /∆t, tl = l∆t.
Hereafter we use superscripts l and l + 1 for those variables at time tl and tl+1,
respectively.

matrices with entries [Sτ ]jk =(cid:82)

The ﬁnite element method (FEM) is taken for space discretization. Let {φj}n
j=1
be the ﬁnite element basis, we denote by M the mass matrix and by Sτ the stiﬀness
Ω στ∇φk ·∇φjdx, where τ stands for i, e, m. The bold
symbol ul will denote the vector representation of u(x, tl) in the ﬁnite element space.
It is analogous for other variables.

At time t = tl+1, the gating variable wl+1 in the ionic model is updated by

wl+1 − wl

∆t

= −g(˜ul+1, wl+1)

4

(2.4)

time t [ms]050100150200potential u [mV] at one point-100-80-60-40-20020 bidomain sol. u monodomain sol. uwith ˜ul+1 = 2ul − ul−1 (˜u1 = u0 in particular) being the second-order time extrapo-
lation of ul+1 and g(·) being evaluated point-wise. For computational eﬃciency and
for the convenience to apply model reduction which we will see in Sec. 4, we approxi-
mate the nonlinear function Iion and the stimulus Iapp piecewise linearly. Under this
assumption, the discretized monodomain system reads

Amul+1 = bl+1

where Am = βCm

α0
∆t M + Sm and the right-hand side is evaluated as

bl+1 = M(Il+1

app − βIion(˜ul+1, wl+1)) + βCmM

ul+1−i.

αi
∆t

2(cid:88)

i=1

(2.5)

(2.6)

Here αi’s are the coeﬃcients of the BDF (for a BDF of order two we have α0 =
3/2, α1 = 2, α2 = −1/2).
In (2.6), Iion(˜ul+1, wl+1) is a point-wise evaluation.
We will conﬁrm in Sec. 5.3 that this point-wise assumption improves computational
eﬃciency without much lose of accuracy as compared with the exact ﬁnite element
approximation.

The linear system (2.5) can be solved by an ILU preconditioned conjugate gradient
method implemented for instance in the Trilinos package (www.trilinos.org). A
mass lumping technique [28] is employed for the sake of computational stability.

The inverse conductivity problem. The monodomain inverse conductivity

problem (MICP) is formulated as: ﬁnd σ = [σml, σmt] ∈ [mb, Mb]2 that minimizes

Jm(σ) =

1
2

(ul − ul

meas)T Xsite(ul − ul

meas)χl

snap +

R(σ)

α
2

(2.7)

L(cid:88)

l=1

subject to the monodomain system (2.5) coupled with (2.4). Here mb and Mb (mb <
Mb) are positive constants. We assume that the measurement sites are always grid
points and Xsite ∈ Rn×n is the matrix recording observation sites. The oﬀ-diagonal
entries in Xsite are zeros; in the diagonal, [Xsite]ii = 1 if the spatial grid xi is an
observation site and 0 otherwise. We also introduce the snapshot marker χl
snap which
equals 1 if tl is an observation moment and 0 otherwise.

The MICP can be solved by the BFGS optimization [26] approach as done in [36].
However, the computation is intensive since each “query” of the forward system or
its adjoint counterpart is performed in the full-order n by solving large algebraic
systems. Moreover, in practice one may ﬁnd also pathological tissues where scars
inside have diﬀerent (anomalous) values of conductivities, the number of “queries”
will substantially increase due to the increase of the total number of conductivities.
Altogether, in the current scenario, the MICP is too computationally expensive to be
applied in clinic. This motivates us to work on a model reduction investigation with
the aim of reducing signiﬁcantly the computational cost.

3. Model order reduction for nonlinear systems. We consider in general

the discrete system of a parameterized nonlinear steady diﬀerential equation

Aτ y(τ ) = F(y(τ ); τ )

(3.1)

where τ denotes the model parameter of interest in an inverse problem and is contained
in a closed bounded domain D. We assume that the matrix Aτ ∈ Rn×n has aﬃne

5

Our goal is to construct a small set of basis functions {ϕi}N

dependence on τ , and F(·) is a nonlinear function evaluated at the solution y(τ ) =
[y1(τ ),··· , yn(τ )]T componentwise, i.e. F(y(τ ); τ ) = [F (y1(τ ); τ ),··· , F (yn(τ ); τ )]T
with F (·) being a nonlinear scalar-valued function.
i=1 in Rn such that the
solution y(τ ) can be well approximated in the space span{ϕi} (called reduced space).
i=1 form the so-called reduced basis (RB). Let Zy = [ϕ1,··· , ϕN ] ∈
The functions {ϕi}N
Rn×N , we represent the solution in the reduced space as y(τ ) = Zyyr(τ ) with yr(τ )
being the vector of coordinates in the reduced space. A reduced order model (ROM)
of (3.1) is then obtained by Galerkin projection

ZT
y AτZy

yr(τ ) = ZT

y F(Zyyr(τ ); τ ).

(3.2)

(cid:124)

(cid:123)(cid:122)

Ar

(cid:125)

y AτZy ∈ RN×N is a dense matrix but in general it features a
Notice that Ar = ZT
very small size, hence the linear system (3.2) can be tackled with a direct solver. We
simply omit the subscript τ here for simplicity.

The RB is constructed from the full-order model (FOM) (3.1) which is of large
scale, thus the computation is usually expensive and performed oﬄine. In the online
phase, the ROM (3.2) is solved many times for diﬀerent parameter values with remark-
ably lower computational costs than the FOM. Techniques for RB construction start
from a sampling on the parameter τ . We introduce here a sample S = {τ1,··· , τs}
consisting of s distinct parameter points in D. A RB is constructed so to guarantee
that for each τi ∈ S the error of approximating y(τi) in the reduced space is bounded
by a desired tolerance. We follow the POD approach, which usually constructs an
“optimal” reduced basis as speciﬁed below.

3.1. Proper Orthogonal Decomposition (POD). We brieﬂy recall basic fea-
tures of POD for the sake of completeness. More details can be found in [22]. Given
the parameter sample S, we solve the FOM (3.1) for each parameter value in S. The
solutions are called snapshots and denoted by {yi}m
i=1 (m = s in current setting). The
Proper Orthogonal Decomposition (POD) approach seeks an orthonormal POD basis
{ϕ1,··· , ϕN} (also known as a set of POD modes) in Rn of a given rank N (N << m)
that can best approximate the training space X trn = span{yi}m
i=1. Here “best” means
the POD basis solves

(cid:104)yj, ψi(cid:105)ψi||2

s.t. (cid:104)ψi, ψj(cid:105) = δij.

(3.3)

m(cid:88)

||yj − N(cid:88)

j=1

i=1

min{ψi}

We gather the snapshots into the so called snapshot matrix Y = [y1,··· , ym] ∈
Rn×m.
It’s known that the POD modes are given by the N left singular vectors
of Y associated with the N largest singular values [22]. Without lose of generality,
we assume that the snapshot mean is zero.
In fact we can replace each yi with
yi − 1

m(cid:80)

yj.

m

j=1

An eﬃcient way for computing the POD modes through snapshot matrix Y is
to ﬁrst compute the thin QR factorization of Y as Y = QR , and then compute the
singular value decomposition of the small matrix R ∈ Rm×m as R = URSRVT
R. The
POD modes can be extracted in order from the columns of QUR.

Snapshots selection / Sampling. Standard schemes of sampling in the pa-
rameter space include uniform sampling, random sampling, the Latin hypercube sam-
pling (LHS, [23]), and the centroidal voronoi tessellation (CVT) sampling [14]. When

6

sampling a high-dimensional parameter space, the greedy sampling method could be
used [20, 29]. The key feature of greedy sampling is to adaptively select a parameter
at which the estimate of the solution error in the ROM is maximized. Its application
is limited to problems where sharp error estimators are achievable.

For optimal control applications, several online adaptive sampling procedures
have been proposed to let the sampling procedure take into account the optimization
trajectory. The Trust Region POD [1] approach constructs successively improved
POD bases according to parameter values updated during optimization. The updating
procedure was embedded with the trust region method which determines whether
after an optimization step the POD basis should be updated. The Compact POD [10]
uses snapshots of the full-order model solutions as well as their derivatives (known as
sensitivities) with respect to the model parameters of interest.

3.2. Discrete Empirical Interpolation Method (DEIM). In the reduced
system (3.2) obtained by the POD projection, we have to evaluate the nonlinear term

y(cid:124)(cid:123)(cid:122)(cid:125)

n(τ ) = ZT
N×n

(cid:124)

(cid:123)(cid:122)

n×1

(cid:125)

F(Zyyr(τ ); τ )

.

(3.4)

This evaluation has computational complexity depending on the size n of the full-order
system (3.1), which is possibly in the magnitude of hundred thousand. Therefore,
solving the ROM (3.2) without an appropriate methodology may be as expensive as
solving the full one.

The complexity of evaluating (3.4) can be made independent of the full order n by
using the Discrete Empirical Interpolation Method (DEIM [12]). The DEIM provides
an interpolation approximation for the nonlinear term F(Zyyr(τ ); τ ) (simply denoted
as f (τ ) in the sequel) by a projection onto a low-dimensional subspace. For this
purpose, we introduce an M dimensional space (M << n) where we look for an
approximation of f (τ ) for values τ of interest. In particular, we can sample τ , take
snapshots of f (τ ) computed from the FOM with those samples, and then apply the
POD on the snapshots to extract a projection basis {z1,··· , zM}.
Let Zf = [z1,··· , zM ] ∈ Rn×M , the DEIM approximation of f is in the form
f ≈ ˆf = Zf c. To determine the coeﬃcient vector c, the DEIM optimally extracts
M distinct rows from the over-determined system f = Zf c. Speciﬁcally, the DEIM
selects row indices p1,··· , pM in {1, ..., n} and requires:
[f ]pi = [ˆf ]pi. If we denote
P = [ep1,··· , epM ] ∈ Rn×M with epi being the pi-th unit vector in Rn, the coeﬃcient
vector c is solved from PT f = (PT Zf )c. Finally the approximation of f writes

f ≈ ˆf = Zf c = Zf (PT Zf )−1PT f = Zf (PT Zf )−1F(PT Zyyr(τ ); τ ).

(3.5)
The last equality in (3.5) follows from the assumption that the function F(·) evaluates
component-wise at its input vector. The nonlinear term (3.4) can then be eﬃciently
computed through

n(τ ) ≈ ZT

y

(cid:124)

(cid:123)(cid:122)

Zf (PT Zf )−1
N×M

(cid:125)

(cid:124)

(cid:123)(cid:122)

M×1

(cid:125)

F(PT Zyyr(τ ); τ )

.

(3.6)

Zf (PT Zf )−1 ∈ RN×M and PT Zy ∈ RM×N can be pre-
Notice that the matrices ZT
computed so that the computational complexity of evaluating n(τ ) is only O(M N ).
The interpolation indices p1,··· , pM are selected inductively from the projection basis
{z1,··· , zM} by the DEIM (Algorithm 1).

y

7

Algorithm 1 DEIM [12]
l=1 ⊆ Rn linear independent
Input: {zl}M
Output: indices p = [p1,··· , pM ]T ∈ RM
1: [|ρ|, p1] = max{|z1|}
2: Zf ← [z1], P ← [ep1 ], p ← [p1]
3: for l = 2,··· , M do

4:

5:
6:
7:

Solve (PT Zf )c = PT zl
r = zl − Zf c
[|ρ|, pl] = max{|r|}
Zf
aT = eT
pl
Zf ← [Zf zl], P ← [P epl ], p ← [pT pl]T

8:
9: end for

Algorithm 2 Optimization-POD-DEIM
Input: initial guess σ0, POD basis {Zi

parameters {σi

gen}s

i=1

Output: estimated conductivity values σ
1: σ ← σ0
2: k ← 0, i0 ← −1
3: while k < kmax and not converged do
gen||
4:

||σ − σj

Search i∗ = arg min
1≤j≤s
if (i∗ (cid:54)= i0) then

Import the POD basis Zi∗
i0 ← i∗

u and Zi∗

ion

5:
6:

7:
8:
9:
10:
11:

12:
13:

u}s

i=1 and {Zi

ion}s

i=1, POD bases generating

end if
1···L with σ from t1 to tL, using bases Zi∗
Solve ur
Compute the cost function value Jr(σ)
1···L with σ from tL to t1, using bases Zi∗
Solve qr
Compute the gradient ∇Jr(σ) of Jr using (4.10)
Update the inverse Hessian approximation and compute the search direction
Set σ = σ + γkvk where γk ∈ (0,∞) is computed from an Armijo line search
k ← k + 1

u and Zi∗
u and Zi∗

ion

ion

vk (BFGS [26])

14:
15:
16: end while

4. POD-DEIM for the inverse conductivity problem.

The POD basis for the monodomain model. In construction of reduced ba-
sis for the parameterized monodomain model, two ways can be followed as mentioned
in [6]. One is to store a set of solutions of the full-order model computed at diﬀerent
instants with a set of diﬀerent parameter values in a given sample space, then collect
all these solutions to build a unique snapshot matrix, upon which the POD basis is
ﬁnally built. In other words, we treat both the conductivity tensor σ and also the
time t as parameters of the model. Another way for the reduced basis construction is
to build multiple POD bases instead of a unique one. Each POD basis is constructed
from the snapshots of solutions computed with a particular conductivity parameter,
which we call generating parameter and denote by σgen. The idea is that for a given
value of the tensor σ we select the POD basis obtained with the closest generating

8

Fig. 4.1: Singular values of snapshot matrices of u and Iion. Left: snapshots generated by
one parameter value. Right: snapshots generated by four parameter values.

parameter (among all available) to approximate the monodomain problem.

The dynamic of the transmembrane potential u is not smooth in time, due to
the wavefront propagation or the upstroke (depolarization) spreading. Therefore,
the singular values of the snapshot matrix of u do not decay fast in general. We
conﬁrm this by a numerical experiment shown in Fig. 4.1 (left).
In this test, the
time step ∆t = 0.05 ms and the full-order model dimension is 24272. We collected
snapshots of the transmembrane potential u (and the ionic current Iion) computed
with a ﬁxed conductivity parameter σ = [3, 1] for 500 time steps. Slow decay shown
in Fig. 4.1 (left) is apparent especially when compared with other problems, in which
singular values of a snapshot matrix usually decrease fast hence few POD modes are
enough to give an accurate approximation of the solution considered (see e.g. [5]).
Fig. 4.1 (left) shows that the singular value si of snapshots of the transmembrane
potential relative to the leading singular value s1 decays to 10−3 (red dash line in
Fig. 4.1) when i is 49 (113 for the ionic current). It suggests that u (Iion) may still
be well approximated by a POD basis of dimension less than 50 (120), if the model
parameter is close enough to the generating parameter of the POD basis. We also
infer that the ionic current Iion features even more complex nonlinearity than the
transmembrane potential u, since more POD modes are needed for approximating
the ionic current with the same accuracy of the transmembrane potential.

We stress here that building a unique POD basis actually provides worthless
results. This can be identiﬁed from Fig. 4.1 right, in which the leading 500 singular
values of snapshots generated by four diﬀerent conductivity parameters are reported.
The relative singular value si/s1 of snapshots of the transmembrane u decays to 10−3
when i is 136 (399 for the ionic current). Compared with the one-parameter case shown
in Fig. 4.1 left, a combination of snapshots from diﬀerent parameter values does not
reduce the number of POD modes necessary for accurate POD approximation.

Sensitivity equations. One possible way to improve our model reduction is
to add snapshots of the sensitivity of the monodomain solution to the conductivity
tensor. To this aim (explained in Sec. 5), we explicitly report the sensitivity equations.
Applying diﬀerentiation with respect to σmk on the monodomain model ((2.5)

coupled with (2.4)), at time tl+1 we can solve ∂ul+1
∂σmk

from

∂Am
∂σmk

ul+1 + Am

∂ul+1
∂σmk

=

∂bl+1
∂σmk

.

(4.1)

The sensitivity of the ionic current, stated in the continuous form without lose of

9

 i0100200300400500si/s110-2010-1510-1010-510049113uIion i0100200300400500si/s110-810-610-410-2100136399uIiongenerality, can be evaluated through

∂Iion
∂σmk

= ∂uIion

∂u
∂σmk

+ ∂wIion

∂w
∂σmk

where k stands for l or t.



Application of DEIM on the monodomain solver. Let us denote the re-
duced bases for the transmembrane potential u and the ionic current Iion (evaluated
in the degrees of freedom) by Zu and Zion respectively. By projecting the discrete
monodomain system (2.5, 2.6) onto the reduced space Zu , we obtain

ZT
u AmZuul+1
r = bl+1
r = ZT
bl+1
with

r

u bl+1 = ZT

(cid:124)

l ∈ {0, 1,··· , L − 1}
+βCm ZT
u MIl+1
app
N×1
−β ZT

(cid:124) (cid:123)(cid:122) (cid:125)
Iion(Zu(cid:101)ul+1
(cid:123)(cid:122)
(cid:124)

(cid:125)
(cid:123)(cid:122)
u M(cid:124)(cid:123)(cid:122)(cid:125)

u MZu
N×N

r
n×1

2(cid:80)
(cid:125)

i=1

, wl+1)

αi

r(cid:124) (cid:123)(cid:122) (cid:125)
∆t ul+1−i
N×1

(4.2)

N×n

r

is the solution at time t = tl+1 in the reduced space and(cid:101)ul+1

the fact that Iion(Zu(cid:101)ul+1
on the full-order vector Zu(cid:101)ul+1
to Iion(Zu(cid:101)ul+1

r−ul−1
where ul+1
is its second-order extrapolation. As discussed in Sec. 3.2, the complexity in comput-
ing the nonlinear term Iion in the right hand side is O(n). This mainly results from
, wl+1) cannot be precomputed, since it depends nonlinearly
and wl+1. We will apply the DEIM approximation
, wl+1). We use the POD basis Zion ∈ Rn×M of snapshots of Iion as
an input basis for the DEIM algorithm, where M is the number of POD modes. The
DEIM algorithm generates interpolation indices p = [p1,··· , pM ]T for constructing
the extraction matrix P. The DEIM approximation reads then
Iion(PT Zu ˜ul+1

, wl+1) ≈ Zion(PT Zion)−1

Iion(Zu(cid:101)ul+1

r = 2ul

, PT wl+1

(4.3)

).

r

r

r

r

r

(cid:124)

(cid:123)(cid:122)

r
M×1

(cid:125)

(cid:124) (cid:123)(cid:122) (cid:125)

M×1

(cid:125)

(cid:124)

(cid:123)(cid:122)

n×M

(cid:124)

(cid:123)(cid:122)

Zion(PT Zion)−1

u AmZu ∈ RN×N ,
u M(cid:124)(cid:123)(cid:122)(cid:125)
u MZu ∈ RN×N , Miu = ZT
app ∈ RN×1, wl+1
r = PT wl+1 ∈ RM×1, U = PT Zu ∈ RM×N ,
2(cid:80)

− βMiuIion(U(cid:101)ul+1

∆t ul+1−i

r + βCmMu

∈ RN×M ,

u MIl+1

, wl+1

r = Il+1

n×M

N×n

(cid:125)

αi

)

r

r

r

the reduced monodomain system is then formulated as

If we set

Ar = ZT
Mu = ZT

r = ZT
Il+1

 Arul+1

r − wl
wl+1
∆t

r

= −g(U(cid:101)ul+1

r

i=1

, wl+1

r

)

.

(4.4)

The reduced monodomain inverse conductivity problem. We are in posi-
tion of formulating the reduced MICP: ﬁnd σ = [σml, σmt] ∈ [mb, Mb]2 that minimizes

Jr(σ) =

1
2

(Zuul

r − ul

meas)T Xsite(Zuul

r − ul

meas)χl

snap +

R(σ)

α
2

(4.5)

l=1

10

L(cid:88)

subject to the reduced monodomain system (4.4). In order to obtain linear algebra
operations of complexity only O(N ) in computing the cost function Jr, we can rewrite

l

l=1

1
2

((ul

snap +

meas)T ul

r)T Xuul

r + ||(cid:98)(cid:98)u

r − 2((cid:98)ul

L(cid:88)
meas||2)χl
XsiteZu ∈ RN×N . The projected measurements(cid:98)ul
meas ∈ Rn×1 can be precomputed.
meas = Xsiteul
r,··· , rL
r , w1

r } and the Lagrangian functional
r,··· , rL
r,··· , wL
r ) = Jr(σ)
r + βMiuIion(U(cid:101)ul
r − Il
αi
∆t
r − wl−1
wl
∆t

r , σ, q1
r − βCmMu
+ g(U(cid:101)ul

r,··· , qL
2(cid:88)

r)T (Arul

ul−i

r, wl

r)T (

r)).

(ql

(rl

i=1

r

R(σ)

α
2

(4.6)

meas = ZT

u

Xsiteul

meas

r, wl

r))

(4.7)

{q1

As we did in [36] for the full order problem, we introduce the Lagrange multipliers
r,··· , qL
Lr(u1

r,··· , uL

r , r1

r , r1

Jr(σ) =

where Xu = ZT

∈ RN×1 and (cid:98)(cid:98)u

u
l

− L(cid:88)
− L(cid:88)

l=1

l=1

∂Lr
∂ul
r

The adjoint form of the reduced discretized monodomain system can be constructed

by setting

= 0 for l = 1,··· , L. It reads

ZT
u AmZuql

r = dl
r

l ∈ {1,··· , L}

with
r = βUT{MT
dl
− ∂ugUT ˜rl

r } ◦ ∂uIion(U˜ul+2

iuql+2

r

, wl+2

r

) − 2βUT{MT

r } ◦ ∂uIion(U˜ul+1

iuql+1

r

r + (Xuul

r − ˆul

meas)χl

snap + βCmMu

2(cid:88)

i=1

αi
∆t

ql+i

r

.

(4.8)

, wl+1

r

)

Here the operation ◦ means entry-wise product. The dual gating variable rl
by the equation below derived from setting

= 0 for l = 1,··· , L:

r is updated

∂Lr
∂wl
r

r − rl
rl+1
∆t

r

= ∂wgrl

r + β{MT

iuql

r} ◦ ∂wIion(U˜ul

r, wl

r).

For superscripts exceeding L, we set qL+1

Based on the adjoint equations we then get the derivatives of Jr

r

r = 0 = qL+2

and rL+1

r = 0 = rL+2

r

= − L(cid:88)

l=1

DJrDσmk

(ql

r)T Skuul

r +

∂R
∂σmk

α
2

(4.9)

.

(4.10)

u SkZu ∈ RN×N and k stands for l and t. Notice that Ar = ZT

where Sku = ZT
α0
∆t Mu + σmlSlu + σmtStu.
βCm
The reduced inverse conductivity problem is eventually solved by Algorithm 2. In
particular, the norm ||·|| in step 4 of Algorithm 2 could be customized. For instance,
we can use the Euclidean norm of the polar coordinates (see Sec. 5.3).

u AmZu =

5. Numerical results.

11

POD mode 1

POD mode 2

POD mode 3

POD mode 1

POD mode 2

POD mode 3

Fig. 5.1: POD modes of the transmembrane potential constructed with σgen = [3, 2] (ﬁrst
row) and σgen = [4, 0.1] (second row).

5.1. POD-DEIM on the forward problem. To investigate the performance
of the POD-DEIM model reduction technique on the monodomain system, we solved
the ROM on a slab Ω = [0, 5] × [0, 5] × [0, 0.5] ⊆ R3 with 24272 mesh nodes. In each
simulation, ﬁve stimuli of Iapp = 105 µA/cm3 were applied with four at the corners
and one at the center of the domain for a duration of 1 ms. We set the ﬁbers to be
constantly along the x-axis. The snapshots for POD basis construction were taken
every 0.05 ms with a duration of 25 ms.

In Fig. 5.1 (ﬁrst row), we plot the ﬁrst three POD modes of the transmembrane
potential constructed from snapshots of u that were computed with conductivity
parameter σgen = [3, 2]. The parameter chosen has σml/σmt close to one, which
makes the tissue almost isotropic. This explains why the wave front propagated from
the center of the slab tissue is almost circular. We also plot in the second row the
leading POD modes of the transmembrane potential constructed with σgen = [4, 0.1].
The wave front in this case is elliptic since the ratio σml/σmt >> 1. This comparison
suggests that the POD modes constructed with diﬀerent conductivity values are very
weakly correlated. Therefore, the approach of extracting POD modes from combined
snapshots computed with diﬀerent parameter values can not achieve enough dimension
reduction, as shown in Fig. 4.1 (right).
To check the performance of reduced order modeling, we took a uniform sampling
on the conductivity parameter: 25 samples were generated over the domain [1, 5] ×
[0, 2]. For each parameter, a POD basis of the transmembrane potential (ionic current)
was constructed oﬄine from snapshots computed with that one. In this way, 25 POD
bases were available for importing during online computation of the reduced-order
monodomain model (Algorithm 2).

Fig. 5.2 reports the relative error on the the transmembrane potential computed
by the POD-DEIM approach. The errors in Fig. 5.2 (left) are with respect to the
dimension of the POD basis, with dim(Zu) ranging from 34 to 46 and dim(Zion)
ranging from 82 to 106. The test conductivity parameter is σ = [2.6, 1.05]. We
observe that the POD-DEIM method provides stable and accurate approximation
when the POD basis dimension is around 40 for u and 90 for Iion.
In Fig. 5.2 (right) we plot the errors on 16× 16 diﬀerent conductivity parameters,
with ﬁxed POD-basis dimensions: dim(Zu) = 45 and dim(Zion) = 100. We observe

12

uuFig. 5.2: Errors of u by POD-DEIM approximation. Left: errors w.r.t. the dimension of
the POD basis, with dim(Zu) ranging from 34 to 46 and dim(Zion) ranging from 82 to 106 ;
Right: errors on 16× 16 diﬀerent conductivity parameters, with ﬁxed POD-basis dimensions:
dim(Zu) = 45 and dim(Zion) = 100.

that 60.55% of the parameters in this test feature errors below 0.005, 21.48% of them
lead errors greater than 0.01 and they are mainly associated with conductivities at
the boundary of the sample space. These errors indicate that a uniform sampling
with 25 parameter values would be inappropriate for its use in the inverse problem of
conductivity estimation. This is conﬁrmed by other non-reported numerical tests.

5.2. Domain of eﬀectiveness (DOE) of the reduced basis. We have an
impression that a single reduced basis is eﬀective only for problems with parameter
values in a speciﬁc domain. To quantify the role of this basis, we introduce the concept
of “domain of eﬀectiveness” (DOE). This is the region of the parameter space where
a reduced order solution provide accurate results as we specify later on. We carry out
a supportive study on the domains of eﬀectiveness of diﬀerent reduced bases, when
each basis has a unique generating parameter σgen that diﬀers from others in the
conductivity ratio.

r − ul||2/

at σ by the relative error of reduced-order solution e(σ) =

Given a POD basis Zu and a test parameter σ, we measure the eﬀectiveness of Zu
||ul||2

||Zuul
where ul is the full-order solution at time tl given σ and ul
r is the corresponding
reduced-order solution solved with the reduced basis Zu. We study the domains of
eﬀectiveness of diﬀerent reduced bases and plot them in Fig. 5.3. In each picture, a
unique generating parameter σgen (indicated by the red triangle) was used for the
construction of the reduced basis. The reduced-order simulation errors are less than
0.002 at black points, between 0.002 and 0.005 at cyan/gray points, and greater than
0.005 at yellow/white points. The area of our interest is the neighbourhood containing
those black points and cyan points, that we identify as the DOE of the associated
reduced basis.

L(cid:80)

l=1

L(cid:80)

l=1

In Fig. 5.3, the parameter space is partitioned by the red dash lines using an
equi-spaced partition on the range of arctan(σmt/σml). It is interesting to see that the
DOE of a reduced basis is apparently conﬁned to an angular region of its generating
parameter. The region is wide when the arc and the angle of σgen are large (as in
Fig. 5.3 upper left), and is relatively narrow while the arc or the angle is relatively

13

    Fig. 5.3: Domains of eﬀectiveness of diﬀerent reduced bases. The relative errors (denoted
by e) of the ROM solutions are indicated in diﬀerent colors. Black: e ≤ 0.002, Cyan(Gray):
0.002 < e ≤ 0.005, Yellow(White): e > 0.005. The parameter space is partitioned by the
red dash lines using an equi-spaced partition on the range of arctan( σmt
). The POD basis
σml
generating parameter σgen in each picture is indicated by a red triangle.

small (as in Fig. 5.3 upper right, lower left and lower right). This study evidences
that the transmembrane potentials solved from the monodomain model are strongly
sensitive to the conductivity ratio and amplitude [19].

As we mentioned earlier, a natural idea to enlarge the domain of eﬀectiveness of a
reduced basis is to include extra sensitivity snapshots in the POD basis construction.
Following the idea in Compact POD [10], we took snapshots for the transmembrane
potential u as

(cid:21)

,

(cid:20)

u1, δl

∂u1
∂σml

, δt

∂u1
∂σmt

,··· , uL, δl

∂uL
∂σml

, δt

∂uL
∂σmt

where δl and δt are scaling factors applied on the sensitivity snapshots. We also took
snapshots for the ionic current Iion in a similar way. To investigate the feasibility
of this concept, we chose a generating parameter σgen = [3, 0.35] and would like to
compare the DOE of the sensitivity-based RB with the older one shown in Fig. 5.3
lower left. Two sets of scaling factors were chosen in a way such that

σgen + [δl, δt] = [3.8, 1.32]

σgen + [δl, δt] = [4.2, 0.48].

Two reduced bases were generated accordingly and their DOE are plotted in Fig. 5.4.
The ROM in this test took 100 POD modes for u and 250 for Iion which are appropriate
numbers based on our experience. From this test, we notice that adding sensitivity
snapshots is not signiﬁcantly eﬀective for widening the DOE. In addition, the largely
increased necessary number of POD modes makes this idea not feasible for application
in inverse problem such as conductivity estimation.

5.3. POD-DEIM for the inverse problem.

14

σml12345σmt00.511.522.53σml12345σmt00.511.522.53σml12345σmt00.511.522.53σml12345σmt00.511.522.53Fig. 5.4: Domains of eﬀectiveness of sensitivity-based reduced bases both generated by
σgen = [3, 0.35]. The left one is based on σgen + [δl, δt] = [3.8, 1.32] (marked by the red
circle) and the right one takes σgen + [δl, δt] = [4.2, 0.48] (marked by the red circle).

The measures. Considering the loose of accuracy in using the reduced-order
model, we may need to acquire enough measures to maintain the stability of the
inverse conductivity solver. In the following tests, we used 100 × 100 measurement
sites on the tissue surface, which is achievable in experiments1. We took snapshot
every dtsnap = 2 ms for a duration of T = 30 ms .

Fig. 5.5: Left: u computed with exact ﬁnite element approximation on the nonlinear
term Iion; middle: u computed with point-wise evaluation on the nonlinear term Iion; right:
synthetic measure of u generated from the left by adding 15% noise uniformly.

The DEIM approximation for nonlinearity was applied under the assumption that
the nonlinear term Iion was evaluated pointwise in the FOM. This is equivalent to a
piece-wise linear ﬁnite element approximation. This assumption greatly improves the
computational eﬃciency of the full-order system while keeping enough accuracy when
the mesh is ﬁne. This is veriﬁed by a numerical experiment shown in Fig. 5.5. In this
test the mesh contains 76832 nodes. As one can see, the pointwise computation on
Iion (Fig. 5.5 middle) presents small error as compared with the exact ﬁnite element
approximation (Fig. 5.5 left). More importantly, the computational cost is reduced
from 759.284 seconds to 53.6954 seconds with a reduction of more than 90%. Fig. 5.5
(right) displays the synthetic measures generated by adding 15% noise to the poten-
tial u computed with exact evaluation of Iion. This typically represents the way we
generate measures in our numerical tests of the reduced inverse solver.

Sampling. As we have reported in Sec. 5.1, a uniform sampling on the conduc-
tivity parameter to construct POD bases is not a viable approach, since it needs too

1F. Fenton (GA Tech), personal communication.

15

σml12345σmt00.511.522.53σml12345σmt00.511.522.53Fig. 5.6: Ten samples (stars in red)
generated by a nonuniform sampling
on the polar coordinates of conduc-
tivity values. The “small angle–short
arc” zone of the sample space is re-
ﬁned by the use of Gaussian nodes.

many sample points and the corresponding ROM approximation still lacks accuracy.
However, based on the DOE study in Sec. 5.2, a nonuniform sampling with reﬁne-
ment in the “small angle–short arc” zone could substantially decrease the number of
sample points while preserving the accuracy of the ROM approximation. This can
be achieved by a sampling on polar coordinates, so to take advantage of the angular
pattern of the DOE. We illustrate an example in Fig. 5.6, where nine Gaussian nodes
were generated to create the nonuniformity and one extra node is added in the left
corner to slightly extend the coverage of those samples.

Conductivity estimation. We conduct a group of tests on the performance
of the POD-DEIM approach applied in the inverse conductivity problem, using the
ten samples plotted in Fig. 5.6. Six test points (plotted in blue in Fig. 5.6) were
carefully chosen so that they are not too close to the sample points. With each test
point, we solved the full-order monodomain equation with a full approximation (rather
than pointwise computation) of the nonlinear term and then added 15% noise to the
solution to generate the synthetic measures of the transmembrane potential. The
measurement snapshots were taken every 2 ms. We performed the numerical experi-
ments on a 76832-node mesh and also a 24272-node mesh with a common simulation
time step ∆t = 0.025 ms. In each running of the reduced inverse conductivity solver,
35 POD modes were taken for u and 80 for Iion, the norm || · || in step 4 of Algo-
rithm 2 was taken as the Euclidean norm of the polar coordinates. The optimization
iteration started from a prescribed initial guess σinitial = [1.5, 1] and was constrained
by a maximum iteration number 40. We further restricted the admissible domain of
the conductivities into [1, 7] × [0.05, 7] and constrained it by the condition σml
≥ 0.8,
inspired from conductivity measures listed in Table 1 of [36].

σmt

The estimated conductivities are listed in Table 5.1 (corresponding to the 76832-
node mesh). From Table 5.1 we can see: on average each solve of the reduced mon-
odomain system (or its dual), including reduced basis importing, takes about only
3 ms as compared with 140 ms for the full-order model.
In the 24272-node case,
1.5 ms would be compared with 38 ms. The computational cost reduction on the
forward problem is consistently in two order of magnitudes. For conductivity estima-
tion, the reduced inverse solver returns slightly worse estimates than the full-order
inverse solver, due to the lose of accuracy of the ROM. However, the total execution
time can be reduced by at least 90% and the estimation results using ROM are very
satisfying with all the test points except for the last two, whose accuracies are poor
on the conductivity ratio but ﬁne on the magnitude. These two poor estimations can
be improved by adding extra few sample points near the boundary of the admissible
domain σml
= 0.8. Reasonable and similar results were obtained with the coarse
σmt

16

σml123456σmt123456sample pointtest pointTable 5.1: Conductivity estimation on a slab mesh with DOF = 76832. T = 30 ms,
∆t = 0.025 ms, dtsnap = 2 ms, noise = 15%, σinitial = [1.5, 1].

Full Order

Full Order

POD+DEIM

σexact
[3.2, 0.5]
POD+DEIM [3.2, 0.5]
[4.5, 1]
[4.5, 1]
[5.5, 3]
[5.5, 3]
[4, 2]
[4, 2]
[3, 2]
[3, 2]
[6, 5]
[6, 5]

POD+DEIM

Full Order

POD+DEIM

Full Order

Full Order

POD+DEIM

Full Order

POD+DEIM

σestimated
[3.237 0.625]
[3.161 0.393]
[4.535 1.099]
[4.596 0.974]
[5.528 3.064]
[5.384 3.053]
[4.045 2.076]
[3.764 1.968]
[3.054 2.077]
[2.490 2.434]
[5.854 5.121]
[4.820 5.836]

# fwd | bwd

29 | 17
89 | 41
46 | 35
73 | 41
41 | 41
60 | 41
27 | 27
90 | 41
15 | 15
107 | 31
41 | 41
41 | 41

Total exe. time

Exe. time/solve

6211 s
439.6 s
11160 s
353.1 s
12780 s
246.6 s
7525 s
396.1 s
4199 s
396.1 s
12870 s
131.6 s

135.02 s

3.38 s

137.78 s

3.10 s

155.85 s

2.44 s

144.71 s

3.02 s

139.97 s

2.87 s

156.95 s

1.60 s

mesh, which we do not report for the sake of brevity.

The iterations corresponding to the 76832-node case are plotted in Fig. 5.7. Some
of them are also shown in the plane as displayed in Fig. 5.8. We can see that the
optimal pathway in the reduced inverse solver is similar to that in the full-order inverse
solver.

Adaptive POD. We ﬁnally test the viability of adaptation by an online proce-
dure. We generated the potential measures with σexact = [4.5, 1]. Given initial guess
σinitial = [1.5, 1],

1. we solved the full-order monodomain system,
2. extracted the snapshots of u and Iion for POD basis construction online,
3. solved the reduced inverse solver with the current unique basis,
4. took the estimated conductivities to run a full-order simulation,
5. built a new POD basis and solved the reduced inverse solver again with the

new basis and with previous estimate as the initial guess.

These steps were looped until a stopping criterion was fulﬁlled. In the test, we set a
maximum iteration number 20 in each reduced inverse solving. The ﬁrst four cycles of
the iterations are reported in Fig. 5.9. The optimization iterations intensively oscillate
around the exact conductivity value. This is caused by the features of the reduced
monodomain model:
in fact, we use a RB constructed with a unique generating
parameter, but the domain of eﬀectiveness of this kind of RB may be very narrow.
The limited extension of DOE prevents a simple use of POD adaptation for the inverse
conductivity problem. This concept needs to be further explored, customized, and
reﬁned in depth.

6. Conclusions. We have presented some failure and success facts in solving the
reduced monodomain inverse conductivity problem with the POD-DEIM approach.
The monodomain solution features some special properties, not shared by other prob-
lems, that cause diﬃculties in reduced-order modeling.

The main challenge of model reduction lies in the POD basis construction. We
have observed that the DOE of a POD basis based on a single generating parameter
is narrow, especially when the amplitude of the conductivity value is small. This
phenomena has also been shown in [6] where POD was applied to estimate ionic model
parameters. The situation in our case is even worse, considering the fact that we can
not group snapshots for basis construction from diﬀerent generating parameters, due

17

Fig. 5.7: Optimization iterations corresponding to Table 5.1

to the strong sensitivity of the transmembrane potential to the conductivities.
In
other words, a unique POD basis is inadequate for the inverse conductivity problem,
where the simulations are performed with various conductivity parameters. This is

18

Number of optimization iterations51015202530Estimated conductivities0123456σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Number of optimization iterations5101520253035Estimated conductivities0123456σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Number of optimization iterations5101520253035Estimated conductivities01234567σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Number of optimization iterations5101520Estimated conductivities0123456σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Number of optimization iterations2468101214Estimated conductivities0123456σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Number of optimization iterations5101520253035Estimated conductivities0123456σml (Full order)σmt (Full order)σml (POD+DEIM)σmt (POD+DEIM)Fig. 5.8: Optimization trajectory corresponds to Table 5.1 for test points: [4.5, 1], [4, 2],
[6, 5]. The left column corresponds to the full-order inverse solver, while the right column
corresponds to the reduced inverse solver.

conﬁrmed by a numerical test of adaptive POD, which returns intensive oscillation
around the exact values.

Another challenge that deserves to mention is the failure of adding sensitivity
snapshots, which is expected to highly improve the eﬀectiveness of the POD basis in
other problems [10]. We ﬁnd that putting extra sensitivity snapshots into the snapshot
matrix of state variables does not signiﬁcantly enlarge the DOE of the constructed
RB as much as we desire. Even if it did to some extent, the required number of POD
modes is almost tripled, hence it is not appropriate for online application.

19

σml123456σmt0.511.522.53iterationsσestimatedσexactσml123456σmt0.511.522.53iterationsσestimatedσexactσml12345σmt0.511.522.533.54iterationsσestimatedσexactσml12345σmt0.511.522.533.54iterationsσestimatedσexactσml123456σmt123456iterationsσestimatedσexactσml123456σmt123456iterationsσestimatedσexactFig. 5.9: Optimization itera-
tions by adaptive POD oscillate
around the exact conductivity
σexact = [4.5, 1] highlighted by
the dash lines. Each optimiza-
tion cycle is constrained by a
maximum iteration number 20.

Nevertheless, there are still some interesting aspects that ﬁnally lead to a suc-
cess. We detect that the domain of eﬀectiveness of a reduced basis is conﬁned to an
angular region of its generating parameter, and the region would be enlarged if the
parameter amplitude gets larger. Based on this, we sample the parameter space uti-
lizing the polar coordinates and the Gauss–Lobatto nodes. A sample set of size ten is
then obtained. The usage of multiple POD bases, each generated with a sampled pa-
rameter, provides satisfactory results. Overall, by utilizing this POD-DEIM reduced
order model, the computational eﬀort can be reduced by at least 90% in conductivity
estimation.

This work opens several interesting challenges to be investigated in future works.
In particular, we plan to customize adaptive sampling strategies to improve the eﬀec-
tiveness of the reduced basis.

Acknowledgements. This work has been supported by the NSF Project DMS
1412973/1413037 “Novel Data Assimilation Techniques in Mathematical Cardiology”.

REFERENCES

[1] E. Arian, M. Fahl, and E.W. Sachs, Trust-region proper orthogonal decomposition for ﬂow

control, Tech. report, Institute for Computer, 2000.

[2] M. Barrault, Y. Maday, N.C. Nguyen, and A.T. Patera, An ‘empirical

interpolation’
method: application to eﬃcient reduced-basis discretization of partial diﬀerential equa-
tions, Comptes Rendus Mathematique 339 (2004), no. 9, 667 – 672.

[3] B. Barros, R. Santos, M. Lobosco, and S. Alonso, Simulation of ectopic pacemakers in the
heart: Multiple ectopic beats generated by reentry inside ﬁbrotic regions, BioMed Research
International (2015), Article ID 713058, in press.

[4] P. Benner, S. Gugercin, and K. Willcox, A survey of projection-based model reduction methods

for parametric dynamical systems, SIAM Review 57 (2015), no. 4, 483–531.

[5] L. Bertagna and A. Veneziani, A model reduction approach for the variational estimation
of vascular compliance by solving an inverse ﬂuid-structure interaction problem, Inverse
Problems 30 (2014), 055006.

[6] M. Boulakia and J-F. Gerbeau, Parameter identiﬁcation in cardiac electrophysiology using
proper orthogonal decomposition method, Functional Imaging and Modeling of the Heart,
Lecture Notes in Computer Science, vol. 6666, 2011, pp. 315–322.

[7] Y. Bourgault and C. Pierre, Comparing the bidomain and monodomain models in electro-

cardiology through convergence analysis, December 2010.

[8] A. Buﬀa, Y. Maday, A.T. Patera, C. Prud’homme, and G. Turinici, A priori convergence of
the greedy algorithm for the parametrized reduced basis method, ESAIM: Mathematical
Modelling and Numerical Analysis 46 (2012), 595–603.

[9] T. Bui-Thanh, M. Damodaran, and K.E. Willcox, Aerodynamic data reconstruction and inverse
design using proper orthogonal decomposition, AIAA Journal 42 (2004), no. 8, 1505–1516.
[10] K. Carlberg and C. Farhat, A compact proper orthogonal decomposition basis for optimization-
oriented reduced-order models, 12th AIAA/ISSMO Multidisciplinary Analysis and Opti-
mization Conference (2008), no. 2008-5964.

20

Number of optimization iterations1020304050607080Estimated conductivities02468σmlσmt[11] S. Chaturantabut, Dimension reduction for unsteady nonlinear partial diﬀerential equations

via empirical interpolation methods, Master’s thesis, Rice University, 2008.

[12] S. Chaturantabut, Nonlinear model reduction via discrete empirical interpolation, Ph.D. thesis,

Rice University, 2011.

[13] L. Clerc, Directional diﬀerences of impulse spread in trabecular muscle from mammalian heart,

J. Physiol. 255 (1976), 335–346.

[14] Q. Du, V. Faber, and M. Gunzburger, Centroidal voronoi tessellations: Applications and al-

gorithms, SIAM Rev. 41 (1999), no. 4, 637–676.

[15] M. Frangos, Y. Marzouk, K. Willcox, and B. van Bloemen Waanders, Surrogate and reduced-
order modeling: A comparison of approaches for large-scale statistical inverse problems,
Large-Scale Inverse Problems and Quantiﬁcation of Uncertainty, Wiley Online Library,
2011, pp. 123–149.

[16] P. Colli Franzone and L. Pavarino, A parallel solver for reaction-diﬀusion systems in compu-

tational electrocardiology, Math. Mod. Meth. Appl. S. 14 (2004), no. 6, 883–911.

[17] D. Galbally, K. Fidkowski, K. Willcox, and O. Ghattas, Non-linear model reduction for uncer-
tainty quantiﬁcation in large-scale inverse problems, International Journal for Numerical
Methods in Engineering 81 (2010), no. 12, 1581–1608.

[18] L. Graham and D. Kilpatrick, Estimation of

the bidomain conductivity parameters of
cardiac tissue from extracellular potential distributions initiated by point stimulation,
Ann. Biomed. Eng. 38 (2010), no. 12, 3630–3648.

[19] P. Johnston, A sensitivity study of conductivity values in the passive bidomain equation,

Math. Biosci. 232 (2011), no. 2, 142–150.

[20] D.J. Knezevic, N. Nguyen, and A.T. Patera, Reduced basis approximation and a posteriori error
estimation for the parametrized unsteady boussinesq equations, Mathematical Models and
Methods in Applied Sciences 21 (2011), no. 07, 1415–1442.

[21] M.W. Krueger, G. Seemann, K. Rhode, D.U.J. Keller, C. Schilling, A. Arujuna, J. Gill, M.D.
O’Neill, R. Razavi, and O. Dossel, Personalization of atrial anatomy and electrophysiology
as a basis for clinical modeling of radio-frequency ablation of atrial ﬁbrillation, Medical
Imaging, IEEE Transactions on 32 (2013), no. 1, 73–84.

[22] K. Kunisch and S. Volkwein, Galerkin proper orthogonal decomposition methods for a general
equation in ﬂuid dynamics, SIAM Journal on Numerical Analysis 40 (2002), no. 2, 492–515.
[23] M.D. McKay, R.J. Beckman, and W.J. Conover, A comparison of three methods for selecting
values of input variables in the analysis of output from a computer code, Technometrics
21 (1979), no. 2, pp. 239–245.

[24] N.C. Nguyen, A.T. Patera, and J. Peraire, A ‘best points’ interpolation method for eﬃcient
approximation of parametrized functions, International Journal for Numerical Methods in
Engineering 73 (2008), no. 4, 521–543.

[25] B. Nielsen, T. Ruud, G. Lines, and A. Tveito, Optimal monodomain approximation of the

bidomain equations, Appl. Math. Comp. 184 (2007), 276–290.

[26] J. Nocedal and S. Wright, Numerical optimization, second ed., Springer, New York, 2006.
[27] A. Pullan, L. Cheng, and M. Buist, Mathematically modelling the electrical activity of the

heart: From cell to body surface and back again, World Scientiﬁc, Singapore, 2005.

[28] A. Quarteroni (ed.), Numerical models for diﬀerential problems, Modeling, Simulation and

Applications, vol. 2, Springer, 2009.

[29] A. Quarteroni, G. Rozza, and A. Manzoni, Certiﬁed reduced basis approximation for
parametrized partial diﬀerential equations and applications, Journal of Mathematics in
Industry 1 (2011), no. 1, 3.

[30] M.J. Rewie´nski, A trajectory piecewise-linear approach to model order reduction of nonlinear

dynamical systems, Ph.D. thesis, Technical University of Gda´nsk, 2003.

[31] D. Roberts and A. Scher, Eﬀect of tissue anisotropy on extracellular potential ﬁelds in canine

myocardium in situ, Circ. Res. 50 (1982), no. 3, 342–351.

[32] J. Rogers and A. McCulloch, A collocation–galerkin ﬁnite element model of cardiac action

potential propagation, IEEE Trans. Biomed. Eng. 41 (1994), no. 8, 743–757.

[33] N. Trayanova, Deﬁbrillation of the heart:

insights into mechanisms from modelling studies,

Experimental Physiology 91 (2006), 323–337.

[34] C.T. Villongco, D.E. Krummen, P. Stark, J.H. Omens, and A.D. McCulloch, Patient-speciﬁc
modeling of ventricular activation pattern using surface ecg-derived vectorcardiogram in
bundle branch block, Prog Biophys Mol Biol 115 (2014), no. 2–3, 305 – 313.

[35] H. Yang, Parameter estimation and reduced-order modeling in electrocardiology, Ph.D. thesis,

Emory University, 2015, http://pid.emory.edu/ark:/25593/r7mcm.

[36] H. Yang and A. Veneziani, Estimation of cardiac conductivities in ventricular tissue by a

variational approach, Inverse Problems 31 (2015), no. 11, 115001.

21

