6
1
0
2

 
r
a

M
2

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
3
7
6
0
0

.

3
0
6
1
:
v
i
X
r
a

EVENTUALLY STABLE RATIONAL FUNCTIONS

RAFE JONES AND ALON LEVY

Abstract. For a ﬁeld K, rational function φ ∈ K(z), and α ∈ P1(K), we study the
polynomials in K[z] whose roots are given by the solutions in K to φn(z) = α, where φn
denotes the nth iterate of φ. When the number of irreducible factors of these polynomials
stabilizes as n grows, the pair (φ, α) is called eventually stable over K. We conjecture that
(φ, α) is eventually stable over K when K is any global ﬁeld and α is any point not periodic
under φ (an additional non-isotriviality hypothesis is necessary in the function ﬁeld case).
We prove the conjecture when K has a discrete valuation for which φ has good reduction
and acts bijectively on all ﬁnite residue extensions. As a corollary, we prove for these maps
a conjecture of Sookdeo on the ﬁniteness of S-integral points in backwards orbits. We also
give several characterizations of eventual stability in terms of natural ﬁniteness conditions,
and survey previous work on the phenomenon.

1. Introduction

Given a ﬁeld K and f ∈ K[z], many authors have studied the question of whether f is
stable over K, that is, if all iterates f n(z) for n ≥ 1 are irreducible over K. See for example
[1, 7, 9, 16, 17], and also [22, Sections 1 and 2], where the terminology originated. While
stability is appealing in its simplicity, it cannot be expected to hold in great generality; indeed
given any f ∈ K[z] there is a ﬁnite extension L of K over which f is not irreducible, and hence
not stable. Moreover, by focusing on iterates of f , one is making a choice of considering only
properties of the preimages of 0 under iterates of f . In this paper we study a more general
phenomenon in which f may be a rational function, 0 may be replaced by any element α of
P1(K), and iterates of f are allowed to factor non-trivially, but only ﬁnitely often.

Deﬁnition 1.1. Let K be a ﬁeld, ϕ(z) ∈ K(z), and α ∈ P1(K). For each n ≥ 1, choose
coprime fn, gn ∈ K[z] with ϕn(z) = fn(z)/gn(z). If α 6= ∞, we say that the pair (ϕ, α) is
eventually stable if the number of irreducible factors in K[z] of fn(z) − αgn(z) is bounded
by a constant independent of n. We say that (ϕ, ∞) is eventually stable if the number of
irreducible factors of gn(z) is similarly bounded. We say ϕ is eventually stable if (ϕ, 0) is
eventually stable.

Note that fn and gn are determined up to a constant factor, and so the deﬁnition is inde-
pendent of the choice of fn and gn. Also, repeated irreducible factors are counted according
to their multplicity. We remark that the roots of fn(z) − αgn(z), counting multiplicity, are
identical to the preimages (in K) of α under φn, again counting multiplicity. Deﬁnition 1.1
is a generalization of the deﬁnition in [16, Section 4], where the terminology ﬁrst appeared.

MSC 37P05 (primary), 37P15, 11R32, 37P25 (secondary)

The second author’s research was partially supported by the G¨oran Gustafson Foundation.

1

2

RAFE JONES AND ALON LEVY

Eventual stability is invariant under ﬁnite extension of the ground ﬁeld, and has several
other characterizations in terms of natural ﬁniteness conditions, which we enumerate and
prove in Section 2. While less studied than stability, there are some results in the literature
on eventual stability, notably in [13] and [14]. Based in part on these results, and in part
on our Theorem 1.3, we conjecture that eventual stability holds quite generally. In the case
where K is a function ﬁeld with ﬁeld of constants F , we call the pair (φ, α) isotrivial if there
is µ ∈ PGL2(K) with µ ◦ φ ◦ µ−1 ∈ F (z) and µ(α) ∈ P1(F ).

Conjecture 1.2 (Everywhere eventual stability conjecture). Let φ ∈ K(z), and suppose that
α ∈ P1(K) is not periodic under φ.

(1) If K is a number ﬁeld, then (φ, α) is eventually stable over K.
(2) If K is a function ﬁeld and (φ, α) is not isotrivial, then (φ, α) is eventually stable

over K.

Conjecture 1.2 is known just in a few cases, such as when φ is a power map and α is not
a root of unity (see Section 3.4 for this and similar results for Chebyshev polynomials and
some Latt`es maps). When iterated preimages of α under φ carry a Galois action, we give in
Conjecture 2.3 an equivalent version of part (1) of Conjecture 1.2.

Our main result gives a new class of φ for which Conjecture 1.2 holds for all α not peri-
odic under φ. Given a discrete non-archimedean valuation v on a ﬁeld K, denote by p the
associated prime ideal {x ∈ K : v(x) > 0} of the ring R = {x ∈ K : v(x) ≥ 0}. Let k be
the residue ﬁeld R/p, denote by ˜x ∈ P1(k) the reduction modulo p of x ∈ P1(K) (where we
take ˜∞ = ∞ ∈ P1(k)), and denote by ˜f the polynomial obtained from f ∈ R[z] by reducing
each coeﬃcient modulo p. Given φ ∈ K(z), we can choose f, g ∈ R[z] with φ(z) = f (z)/g(z)
and at least one coeﬃcient of f or g is in R∗ We take ˜φ = ˜f /˜g, and note that the degree
of ˜φ is independent of the choice of f and g. We say φ ∈ K(z) has good reduction at v if
deg ˜φ = deg φ. Our main result is the following.

Theorem 1.3. Let v be a discrete valuation on a ﬁeld K, let the residue ﬁeld k be ﬁnite of
characteristic p, and let φ ∈ K(z) have degree d ≥ 2. Suppose that φ has good reduction with
respect to v and

˜φ(z) =

c1zpj
+ c2
c3zpj + c4

,

where j ≥ 1 and c1, c2, c3, c4 ∈ k (so in particular d = pj). Then (φ, α) is eventually stable
for all α ∈ P1(K) not periodic under φ.

In fact we give a bound on the number of irreducible factors that depends on φ and α;
see Corollary 4.9. Maps satisfying the hypotheses of Theorem 1.3 are precisely those that
have good reduction and the property that ˜φ induces a bijection on every ﬁnite extension of
k (see Proposition 4.8). Note that when K is a function ﬁeld, the ﬁniteness of the residue
ﬁeld forces the ﬁeld of constants to be ﬁnite and hence under the assumptions of Theorem
1.3, we have that α is periodic for φ when both are deﬁned over the constant ﬁeld. Thus α
is periodic under φ for all isotrivial (φ, α).

Some basic cases of Conjecture 1.2 remain unresolved. We wish to draw attention to one
in particular. It follows from [13, Theorem 1.6] (or Theorem 1.3) that φ(z) = z2 + c ∈ Q[z] is

EVENTUALLY STABLE RATIONAL FUNCTIONS

3

eventually stable over Q unless c = 0 or c is the reciprocal of an integer. We conjecture that
eventual stability still holds in this case, save for the obvious exceptions.

Conjecture 1.4. Let a ∈ Z with a 6∈ {0, −1}. Then z2 + (1/a) is eventually stable over Q.

Applying Theorem 1.3 with K = Q and v the 2-adic valuation, we prove Conjecture 1.4

when a is odd:

Corollary 1.5. Let a 6= −1 be an odd integer. Then z2 + (1/a) is eventually stable over Q.

When a is even, φ(z) = z2 +1/a has bad reduction for the 2-adic valuation, and so Theorem

1.3 does not apply. When a = −1, 0 is periodic, and again Theorem 1.3 does not apply.

The exceptions in Conjecture 1.2 are necessary. First, recall that α is periodic under φ
if φn(α) = α for some n ≥ 1, and when this holds it follows from (1) in Section 2 that
(z − α) | fn(z) − αgn(z). Furthermore, from (2) in Section 2 we have (fin(z) − αgin(z)) |
(fjn(z) − αgjn(z)) for all i with 1 ≤ i ≤ j. Hence

(z − α) | (fn(z) − αgn(z)) | (f2n(z) − αg2n(z)) | · · · | (fjn(z) − αgjn(z))

for all j ≥ 2. Therefore (fjn(z) − αgjn(z)) has at least j + 1 irreducible factors over K, and
so (φ, α) is not eventually stable over K. Second, isotrivial functions need not be eventually
stable. For example, let Fp be the ﬁnite ﬁeld with p elements, and take K = F5(t) and
φ(z) = z2 + 2 ∈ K(z). As noted in [10], a classical theorem of Stickelberger ([28], [6, Chapter
15]) gives that if p is an odd prime, then the number of irreducible factors of any polynomial
over Fp is even if and only if the discriminant of the polynomial is a square in Fp. Using a
discriminant formula for iterates of quadratic polynomials [16, Lemma 2.6], one sees that the
discriminant of φn(z) is a square in F5 if and only if φn(0) is a square in F5. But the orbit of
0 under φ is 0 7→ 2 7→ 1 7→ 3 7→ 1, and thus φn(0) is a square in F5 precisely when n is even.
Thus φn(z) has an odd number of irreducible factors over F5 when n is odd, and an even
number of factors when n is even; it follows that φn(z) has at least n irreducible factors over
K for each n ≥ 1, and thus (φ, 0) is not eventually stable, even though 0 is not periodic under
φ. In general one does not expect an arbitrary polynomial over a ﬁnite ﬁeld to be eventually
stable; for a conjectural model of the factorization of iterates of such a polynomial, see [4].

Eventual stability has several known consequences, some of which we discuss in Sections
3.1, 3.2, and 3.3. Section 3.1 focuses on a conjecture of Sookdeo that asserts an analogue for
backwards orbits of Silverman’s result on the ﬁniteness of integer points in forwards orbits
[25]. Recall that the backwards orbit O−
φ (α) under φ is by deﬁnition the union over all n ≥ 0
of φ−n(α) := {β ∈ P1(K) : φn(β) = α}. Let K be a number ﬁeld and S a ﬁnite set of places
of K containing all archimedean places. We say that β ∈ P1(K) is S-integral with respect
to γ ∈ P1(K) if there is no prime p of K(β) lying over a prime outside of S, such that the
images of β and γ modulo p coincide. We denote by OS,γ the set of all β ∈ P1(K) that are
S-integral with respect to γ. As an example, if S consists only of the archimedean places of
K, then OS,∞ is the ring of algebraic integers in K. Sookdeo conjectures [27, Conjecture 1.2]
that OS,γ ∩ O−
φ (α) is ﬁnite unless γ is preperiodic for φ. Theorem 1.3 and a result due to
Sookdeo (see Theorem 3.1) allow us to prove:

4

RAFE JONES AND ALON LEVY

Corollary 1.6. Let K be a number ﬁeld, S a ﬁnite set of places of K containing all
archimedean places, and α ∈ P1(K). If φ ∈ K(z) satisﬁes the hypotheses of Theorem 1.3,
then OS,γ ∩ O−

φ (α) is ﬁnite for all γ ∈ P1(K) not preperiodic under φ.

The exclusion of preperiodic γ is necessary; for instance, in the case where φ is a monic
polynomial, γ = ∞, and S consists of the archimedean places of K, we have O−
φ (α) ⊂ OS,γ.
Note that Corollary 1.6 holds even when α is periodic under φ. See Section 3.1 for a proof.
The heart of our method is to generalize one of the most fundamental facts about stability:
Eisentein polynomials are stable (see e.g. [22, Lemma 2.2 (iii)] for a result in a very general
setting). Here, we show that eventually stability holds for rational functions satisfying a weak
version of the Eisenstein criterion:

Theorem 1.7. Let v be a discrete valuation on K, let φ ∈ K(z) have degree d ≥ 2, and let
α ∈ P1(K). Suppose that φ has good reduction at v, φ(α) 6= α, and ˜φ−1(˜α) = {˜α} as a map
of P1(k). Then (φ, α) is eventually stable over K.

We give a more precise result in Theorem 4.5, where we give bounds in terms of φ and α
on the number of irreducible factors of the relevant polynomials. In the case where α = 0 and
φ(z) = f (z) ∈ R[z] has degree d, Theorem 1.7 says that f (z) is eventually stable provided
that ˜f (z) = czd for c ∈ k \ {0}, or in other words when p divides all coeﬃcients of f except
its leading coeﬃcient; this is the aforementioned weak version of the Eisenstein criterion.

2. Characterizations of eventual stability

The recent literature includes several articles where eventual stability appears in diﬀerent
guises (e.g.
[13], [14], [27]). In this section we show these guises are all equivalent (Propo-
sitions 2.1, 2.2), give in Conjecture 2.3 a reformulation of part (1) of Conjecture 1.2 in the
setting where iterated preimages of α carry a Galois action, and discuss the related notion of
settledness studied in [4] (see Question 2.4).

We begin with some general remarks about eventual stability. Let K be a ﬁeld, let φ(z) ∈
K(z) have degree d ≥ 1, let α ∈ P1(K), and for each n ≥ 1 let fn, gn ∈ K[z] be relatively
prime polynomials with φn(z) = fn(z)/gn(z). As noted in the introduction, the roots of
fn(z) − αgn(z), counting multiplicity, are identical to the preimages (in K) of α under φn,
again counting multiplicity:

(1)

fn(z) − αgn(z) = C Yβ∈K:φn(β)=α

(z − β)en(β),

where C ∈ K \ {0} and we write en(β) for eφn(β), the ramiﬁcation index of φn at β (i.e.
the order of vanishing at z = β of φn(z) − φn(β), with suitable modiﬁcations for β = ∞;
see [26, Section 1.2]). For α = ∞, we have a similar statement, but with gn(z) replacing
fn(z) − αgn(z). Given rational functions φ, ψ ∈ K(z) and γ ∈ K, an easy argument on
compositions of power series (see [2, Section 2.5]) gives eφ◦ψ(γ) = eφ(ψ(γ)) · eψ(γ), and hence
for all m ≥ 1 we have eφn+m(γ) = eφn(φm(γ)) · eφm(γ). It follows that, up to a non-zero
multiplicative constant, we have

EVENTUALLY STABLE RATIONAL FUNCTIONS

5

fn+m(z) − αgn+m(z) =

(x − γ)en+m(γ)

Yγ∈K:φn+m(γ)=α

 Yγ∈K:φm(γ)=β
Yβ∈P1(K):φn(β)=α
= gm(z)ǫn Yβ∈K:φn(β)=α

=

(x − γ)en(β)em(γ)


(fm(z) − βgm(z))en(β),

(2)

where ǫn = eφn(∞) if φn(∞) = α and ǫn = 0 otherwise. Factoring out gm(z)em(β) from each
term of the product in (2), and using (1), we obtain

fn+m(z) − αgn+m(z) = Cgm(z)dn

(3)
for C ∈ K\{0}. When α = ∞ we obtain the similar equation gn+m(z) = Cgm(z)dn
(compare with [19, Section 2]).

[fn(fm(z)/gm(z)) − αgn(fm(z)/gm(z))]

[gn(fm(z)/gm(z))]

Having dispensed with these preliminaries, we now state our characterization:

Proposition 2.1. Let K be a ﬁeld, let ϕ(z) ∈ K(z) have degree d ≥ 2, and let α ∈ P1(K).
For each n ≥ 1, choose coprime fn, gn ∈ K[z] with ϕn(x) = fn(z)/gn(z), and let (βn)n≥1
be a sequence of elements of P1(K) satisfying φ(β1) = α and φ(βn) = βn−1 for n ≥ 2. The
following are equivalent:

(a) (φ, α) is eventually stable over K.
(b) (φ, α) is eventually stable over L, for any ﬁnite extension L of K.
(c) There exists n ≥ 1 such that (φn, α) is eventually stable.
(d) (µ ◦ φ ◦ µ−1, µ(α)) is eventually stable for all µ ∈ PGL(2, K).
(e) [K(βn+1) : K(βn)] = d for all n ≥ M , where M depends only on φ and α.
(f ) [K(βn) : K] = Cdn for some C > 0 depending only on φ and α.

Note that in (e) and (f ) of Proposition 2.1, we regard K(∞) as identical to K. Before
proving Proposition 2.1, we give three more equivalent conditions for eventual stability. In
many settings the roots of fn(z) − αgn(z) lie in the separable closure K sep of K, for each
n ≥ 1 (note that this does not require the roots of fn(z) − αgn(z) to be distinct). In this
case we say that the pair (φ, α) is separable. When this holds, the absolute Galois group
GK := Gal (K sep/K) acts naturally on each set φ−n(α) := {β ∈ P1(K) : φn(β) = α}, where
we regard ∞ as deﬁned over K and hence ﬁxed by GK . Indeed, this action extends to an
action by tree automorphisms on

T := Gn≥1

φ−n(α),

which becomes a rooted tree if we assign edges according to the action of the maps φ−n(α) →
φ−n+1(α) induced by φ. Moreover, T is an inverse system under these maps, and we put
φ−n(α), which is sometimes known as the set of ends of T . An element of δT
δT := lim
←−
is a sequence (βn)n≥1 with φ(β1) = α and φ(βn) = βn−1 for each n ≥ 2. Giving φ−n(α)
the discrete topology, we have that δT is a compact topological space. A basis for this

6

RAFE JONES AND ALON LEVY

topology is given by sets of the form π−1
n (S) for S ⊂ φ−n(α), where πn : δT → φ−n(α) is
the natural projection. Note that π−1
n (S) is also closed, since its complement is the open set
π−1
n (Sc). When (φ, α) is separable, the action of GK on T extends to an action on δT , with
σ((βn)n≥1) = (γn)n≥1 if and only if σ(βn) = γn for all n ≥ 1.

Proposition 2.2. With assumptions as in Proposition 2.1, suppose additionally that (φ, α)
is separable. Then the following are equivalent:

(A) (φ, α) is eventually stable over K.
(B) The number of GK -orbits on φ−n(α) is bounded as n grows.
(C) The number of GK -orbits on δT is ﬁnite.
(D) Every GK-orbit on δT is open.

We remark that when K is a global ﬁeld and (φ, α) is separable, there is a ﬁnite GK -orbit
on δT if and only if α is periodic under φ, and such an orbit must consist of a single point
(the element of δT corresponding to the cycle containing α). Indeed, let (βn)n≥1 ∈ δT have
a ﬁnite orbit under GK , and note that the stabilizer of (βn) in GK must have ﬁnite index in
GK , and thus L = K(β1, β2, . . .) is a ﬁnite extension of K. Moreover, if ˆhφ is the canonical
height associated to φ (see [26, Section 3.4] for the deﬁnition and basic properties over number
ﬁelds, and [21] for a more general treatment), then because ˆhφ(φ(γ)) = dˆhφ(γ) for all γ ∈ K,
it follows that {β1, β2, . . .} is a set of bounded height, and hence has ﬁnite intersection with
L. Therefore {β1, β2, . . .} is ﬁnite, implying that βi = βj for some i 6= j, and thus α = βn for
some n, implying the desired statements. We remark that similar conclusions hold when K
is a ﬁnite ﬁeld.

These remarks and part (D) of Proposition 2.2 imply that the following conjecture is

equivalent to part (1) of Conjecture 1.2:

Conjecture 2.3. If K is a number ﬁeld, then every GK -orbit on δT is either open or ﬁnite.

As mentioned in the introduction, one does not expect eventual stability to hold in general
when K is a ﬁnite ﬁeld, as discussed in [4]. Rather, in [4] the authors propose the weaker
condition of settledness, which we can now describe in succinct fashion. Let µn be the
probability measure on φ−n(α) that assigns equal mass to each point, counting multiplicity
(so a root of multiplicity m gets m times the mass of a root of multiplicity 1). We then obtain
a probability measure µ on δT by assigning µ(Σ) = limn→∞ µn(πn(Σ)). That µ is a measure
is not trivial, but follows from pulling back each µn to δT in the obvious way and invoking
the Vitali-Hahn-Saks theorem (see e.g. [15, p. 277]). We say that the pair (φ, α) is settled if
the union U of the open GK-orbits on δT satisﬁes µ(U ) = 1; compare to [4, Deﬁnition 2.1].

Question 2.4. Let K be a ﬁnite ﬁeld, φ ∈ K(x) of degree d, and assume that the character-
istic of K does not divide d. Must (φ, α) be settled for all α ∈ P1(K)?

Very little is known about Question 2.4. In the case where d = 2 and φ is a polynomial,

Conjecture 2.2 of [4] asserts a positive answer to Question 2.4, and gives some evidence.

Proofs of Propositions 2.1 and 2.2. We ﬁrst show (a) ⇒ (e). We suppose that α 6= ∞;
otherwise a similar argument holds with fi(z) − αgi(z) replaced by gi(z). By (a) we may take
M large enough so that fn(z) − αgn(z) has the same number of irreducible factors over K,
for all n ≥ M . Furthermore, there can be at most one n with φn(∞) = α, for otherwise α is

EVENTUALLY STABLE RATIONAL FUNCTIONS

7

periodic under φ, and (a) is violated. Hence, increasing M if necessary, we may assume that
∞ 6∈ φ−n(α) (and in particular βn 6= ∞) for all n ≥ M . Now ﬁx n ≥ M , let h1, . . . , hr ∈ K[z]
be the irreducible factors of fn(z) − αgn(z), and let d1, . . . , dr be their degrees. From (3) we
have

(4)

fn+1(z) − αgn+1(z) = Cg(z)dn

[fn(φ(z)) − αgn(φ(z))] = C

rYj=1

g(z)dj hj(φ(z)),

and because φn+1(∞) 6= α, we have that sj(z) := g(z)dj hj(φ(z)) is a polynomial of degree
djd. Note that (4) already gives a factorization of fn+1(z) − αgn+1(z) into the same number
of irreducible factors over K as fn(z) − αgn(z), and thus each sj(z) is irreducible over K.
Because βn+1 6= ∞, it follows from (1) that there is a unique sℓ with βn+1 as a root, and thus
[K(βn+1) : K] = dℓd. But then βn is a root of hℓ, and so we must have [K(βn) : K] = dℓ and
[K(βn+1) : K(βn)] = d, as desired.

To show (e) ⇒ (f ), let M be as in the previous paragraph. For any n ≥ M , condition (e)
and multiplicativity of degrees gives [K(βn) : K] = Cdn with C = d−M [K(βM ) : K], proving
(f ).

We now prove (f ) ⇒ (a). Suppose that there are inﬁnitely many n with [K(βn+1) :
K(βn)] < d. Then given C > 0 we may take i with ((d − 1)/d)i < C, and we may also take
m large enough so that [K(βn+1) : K(βn)] < d for at least i values of n that are less than m.
Then [K(βm) : K] ≤ (d − 1)idm−i < Cdm, contradicting (f ). Thus there exists M such that
[K(βn+1) : K(βn)] = d for all n ≥ M , and because C is independent of (βn) in (6), M is also
independent of (βn). Further, increase M if necessary so that φn(∞) 6= α for all n ≥ M ; this
is possible because if φn(∞) = α for more than one value of n, then α is periodic under φ,
and thus there is a choice of (βn) with K(βn) = K for all n. We now argue that for n ≥ M ,
fn+1(z)−αgn+1(z) has the same number of irreducible factors as fn(z)−αgn(z), which proves
(a). If not, then one of the polynomials on the right-hand side of (4) is reducible over K,
and letting βn+1 be a root of such a polynomial and βn a root of the corresponding hj, we
have [K(βn+1) : K(βn)] < d, a contradiction.

The implications (b) ⇒ (a), (a) ⇒ (c), and (d) ⇒ (a) are obvious. To show (a) ⇒ (b),
suppose that h(z) ∈ K[z] is irreducible over K and has m irreducible factors over L, with
e being the smallest degree of these factors. Then there exists a degree e extension L′ of L
containing a root of h, whence [L′ : K] ≥ d. This implies [L : K] ≥ d/e ≥ m, and so h has
at most [L : K] irreducible factors over L. It follows that if h has r irreducible factors over
K, then it has at most r[L : K] irreducible factors over L. To show (c) ⇒ (a), let (βi) be a
sequence with φ(β1) = α and φ(βi) = βi−1 for i ≥ 2, Assuming (c), we note that deg φn = dn,
and we may invoke condition (e) to obtain that for j ≥ M , [K(βn(j+1)) : K(βnj)] = dn.
But this implies that [K(βi+1) : K(βi)] = d for all i ≥ nM , which is equivalent to (a). To
show (a) ⇒ (d), note that a given µ ∈ PGL2(K) is deﬁned over a ﬁnite extension of K, but
replacing K with a ﬁnite extension preserves eventual stability by (b), and so without loss we
may take µ ∈ PGL2(K). Let φµ = µ ◦ φ ◦ µ−1, and let (γn) be a sequence with φµ(γ1) = µ(α)
and φµ(γn) = γn−1 for n ≥ 2. Note that φ(µ−1(γ1)) = α and φ(µ−1(γn)) = µ−1(γn−1) for
n ≥ 2. But (a) is equivalent to (e), and thus we have [K(µ−1(γn)) : K(µ−1(γn−1))] = d for
n large enough. But K(µ(γi)) = K(γi), for all i, and so by (e) again we have that (φµ, µ(α))
is eventually stable.

8

RAFE JONES AND ALON LEVY

We turn now to Proposition 2.2. Note that by (1) the number of GK -orbits on φ−n(α) is
the same as the number of irreducible factors of fn(z) − αgn(z), with two caveats: we must
ignore multiplicity when counting irreducible factors of fn(z) − αgn(z), and if ∞ ∈ φ−n(α),
then there is a single GK-orbit on φ−n(α) that does not correspond to an irreducible factor
of fn(z) − αgn(z). However, by Riemann-Hurwitz only ﬁnitely many en(β) are greater than
one, and hence the number of GK -orbits on φ−n(α) diﬀers from the number of irreducible
factors of fn(z) − αgn(z) (counted with multiplicity) by a number bounded independent of
n. Hence conditions (A) and (B) are equivalent.

Note that (D) implies (C) by the compactness of δT and the fact that the GK-orbits on
δT furnish an open cover that is also a partition of δT , and hence has no proper subcovers.
Observe that the projection πn commutes with the action of GK , and thus maps GK -orbits
on δT to GK -orbits on φ−n(α). Because πn is a surjection, we cannot have more GK -orbits
on φ−n(α) than on δT , whence (C) implies (B).

Finally, to show (B) implies (D), take M so that the number of GK -orbits on φ−n(α) is the
same for all n ≥ M . We claim that the inverse image under πM of a GK -orbit on φ−M (α) is a
GK -orbit on δT , which is enough to deduce (D). Let (βn)n≥1 and (γn)n≥1 be two elements of
π−1
M (O), where O is a GK -orbit on φ−M (α). In order for the number of GK -orbits on φ−n(α)
not to grow for n ≥ M , we must have that elements of φ−n(α) that restrict to O form a
GK -orbit. Hence for each n ≥ M there is σn ∈ GK with σn(βn) = γn and σn|L = id if L/K
is Galois and βn 6∈ L, and indeed the same conclusion holds for n ≥ 1. Because GK is the
inverse limit over Gal (L/K) for ﬁnite Galois extensions L of K, there exists σ ∈ GK with
σ(βn) = γn for all n. Hence π−1
(cid:3)

M (O) is a GK-orbit on δT .

3. Applications of and results on eventual stability: a brief survey

3.1. Applications to relative S-integrality of iterated preimages. Let OS,γ and O−
φ (α)
be deﬁned as on p. 3, and recall that γ is preperiodic under φ when φn(γ) = φm(γ) for some
n > m ≥ 0. The following is a result of Sookdeo [27, Theorems 2.5 and 2.6], though there
the result is stated using condition (B) of Proposition 2.2.

Theorem 3.1 ([27]). Let K be a number ﬁeld, S a ﬁnite set of places of K containing all
archimedean places, α ∈ P1(K), and φ ∈ K(z). If (φ, α) is eventually stable, then

(5)

OS,γ ∩ O−

φ (α) is ﬁnite for all γ ∈ P1(K) not preperiodic under φ.

Theorem 3.1 is a natural analogue for backwards orbits of Silverman’s result on the ﬁnite-
ness of integer points in forwards orbits [25]. Sookdeo conjectures [27, Conjecture 1.2] that
(5) holds for all α ∈ P1(K). Thus part (1) of our Conjecture 1.2 implies Sookdeo’s conjecture
in the case where α is not periodic under φ. We remark that one method Sookdeo gives of
proving Theorem 3.1 in the case where α is not preperiodic (other methods are required when
α is preperiodic but not periodic) is to derive (5) under the assumption that

(6)

ˆhφ(β) ≥

ǫ

[K(β) : K]

,

φ (α), where ǫ > 0 depends on φ, K, and α, but not β, and ˆhφ is the canon-
for all β ∈ O−
ical height associated to φ. From the fact that ˆhφ(φn(β)) = dnˆhφ(β), it follows that (6)
is equivalent to condition (f ) of Proposition 2.1. The Dynamical Lehmer Conjecture [26,

EVENTUALLY STABLE RATIONAL FUNCTIONS

9

Conjecture 3.25] asserts that (6) holds for ǫ depending only on φ and K, and hence implies
our Conjecture 1.2. The bound given in Theorem 4.9 on the number of irreducible factors
allows one to obtain information about the constant ǫ in (6) for certain φ, but the bound
depends on α.

Proof of Corollary 1.6. If α is not periodic under φ, then (φ, α) is eventually stable over K
by Theorem 1.3, and the Corollary follows immediately from Theorem 3.1. Suppose that α
is periodic under φ, note that Oφ(α) consists of the cycle containing α, and observe that the
set B := φ−1(Oφ(α)) \ Oφ(α) is ﬁnite and consists of points not periodic under φ. But

O−

φ (α) = Oφ(α) ∪ [β∈B

O−

φ (β),

and by Theorems 1.3 and 3.1, OS,γ ∩ O−

φ (β) is ﬁnite for each β ∈ B.

(cid:3)

t (z) = αt} ⊂ P1 × C.

3.2. Applications to preimage curves. Let K be a ﬁeld, C a curve over K, and K(C)
the function ﬁeld of C. Suppose that φ ∈ K(C)(z) and α ∈ K(C). Given t ∈ C, we
denote the specializations of φ and α above t, should they be deﬁned, by φt(z) ∈ K(z) and
αt ∈ P1(K). Deﬁne the N th preimage curve X Pre
φ,α (N ) to be a smooth projective model of
{φN
In [8], the authors studied the geometry of these curves in the
special case where char(K) 6= 2, C = A1, φ(z) = z2 + t, and α ∈ K is a constant function.
This geometric analysis led to results on the ﬁniteness of the number of rational iterated
preimages of a ∈ Q under z2 + t as t ∈ Q varies; indeed a uniform bound was obtained that
holds for most a ∈ Q. As noted in [14, p. 303], a ﬁrst step towards generalizing this result to
other choices for φ and α is to show that X Pre
φ,α (N ) is well-behaved geometrically. At the very
least, one would hope that the number of irreducible components of X Pre
φ,α (N ) is bounded as
N grows.

Proposition 3.2. Let K be the function ﬁeld of a curve over an algebraically closed ﬁeld,
let φ ∈ K(z), and let α ∈ K. If (φ, α) is separable (see p. 5) and eventually stable, then the
number of irreducible components of the N th preimage curve X Pre
φ,α (N ) is eventually constant
as N → ∞.

Because the result is geometric, we have taken the constant ﬁeld to be algebraically closed.

Proposition 3.2 is an immediate consequence of condition (B) of Proposition 2.2.

3.3. Applications to arboreal Galois representations. When (φ, α) is separable, Propo-
sition 2.2 shows that eventual stability gives some coarse information about the size of the
image of the homomorphism ω : GK → Aut(T ) (notation as on p. 5), also known as the
arboreal Galois representation attached to (φ, α). That is, the image of ω is not “too small” in
the sense that as n grows it acts with a bounded number of orbits on φ−n(α). Thus eventual
stability is a stepping stone to the deeper problem of showing that the image of ω has ﬁnite
index in Aut(T ). An easy argument shows that such ﬁnite index results imply eventual sta-
bility (see Proposition 3.3), and thus it is particularly surprising that in some cases eventual
stability is enough to imply ﬁnite-index results. For instance, assuming the abc conjecture,
this is true for certain quadratic polynomials over Q [11, Section 6], and preliminary observa-
tions of Bridy and Tucker suggest it holds for large classes of cubic polynomials as well. Even

10

RAFE JONES AND ALON LEVY

without the abc conjecture, in some cases one can still use results such as Siegel’s theorem to
deduce from eventual stability signiﬁcant information about the image of ω, often enough to
obtain zero-density results for prime divisors of orbits (see [18, discussion preceding Theorem
4.3]).

3.4. Prior results on eventual stability. The two most general results on eventual sta-
bility prior to the present paper are the following. First, we have [14, Corollary 3]: let K be
a number ﬁeld, φ(x) ∈ K[x] monic of degree d ≥ 2, and suppose there is a prime p of K with
p ∤ d and vp(φn(α)) → −∞ as n → ∞. Then (φ, α) is eventually stable over K. Second, [13,
Theorem 1.6]: let K be a ﬁeld of characteristic ∤ d, φ(x) = xd + c ∈ K[x], d ≥ 2. If there is a
discrete valuation v on K with v(c) > 0, then (φ, 0) is eventually stable over K. The second
result is an immediate consequence of our Theorem 4.5. The ﬁrst result, which is a corollary
of the stronger Theorem 1 of [14] giving information about the p-adic Galois representation
attached to (φ, α), also follows from Theorem 4.5 (see Corollary 4.6).

Additional eventual stability results can be found for certain one-parameter families of
quadratic polynomials. See for instance Propositions 4.5, 4.6, and 4.7 of [16], and note that
similar results can likely be proved for many other families using [16, Proposition 4.2].

To the authors’ knowledge, there is only one other setting where eventual stability results
are known: those rare cases when detailed results are available on the image of the arboreal
representation ω : GK → Aut(T ). These results often show that the image of the homo-
morphism GK → Aut(T ) has ﬁnite index in some prescribed subgroup G ≤ Aut(T ) that
acts transitively on δT . The following elementary proposition shows this implies eventual
stability, using condition (C) of Proposition 2.2:

Proposition 3.3. Let G be a group acting transitively on a set S, and let H be a subgroup
of G whose action on S has at least t orbits. Then [G : H] ≥ t.

Proof. Select elements s1, . . . st ∈ S from distinct orbits of H. By transitivity of the action
of G on S, there exist g1, . . . , gt ∈ G with gi(s1) = si for all i. Let i 6= j, and note that
gig−1
6∈ H,
proving that g1H, . . . , gtH are distinct.
(cid:3)

j maps sj to si. Because si and sj are in diﬀerent orbits of H, we must have gig−1

j

Finite-index results of the kind mentioned above are known principally in the case where
φ is dynamically aﬃne, in the terminology of [26, Section 6.8]. That is, there is a semiabelian
variety A and δ : A → A obtained by composing an endomorphism and a translation on A,
and a ﬁnite separable morphism π : A → P1 such that the following diagram commutes:

A

π

P1

δ

φ

A

π

/ P1

We examine three well-known kinds of rational functions that arise by taking δ to be multi-
plication by an integer.

/
/




/
EVENTUALLY STABLE RATIONAL FUNCTIONS

11

Case 1: A = Gm, δ(z) = zd for d ≥ 2, π = id. This gives φ(z) = zd, and action of GK on
T is determined by Kummer theory (or Artin-Schrier theory when φ is not separable). Let
K be a global ﬁeld of characteristic not dividing d and for given n ≥ 1, let ζdn be a ﬁxed
primitive dnth root of unity and γdn a ﬁxed root of xdn

− α. Then there is a natural map

ω : GK −→ lim
←−

n→∞(cid:18) (Z/dnZ)∗ Z/dnZ

0

1

(cid:19)

(7)

given by σ 7→ (cid:18) a b

0 1 (cid:19) where σ(ζdn ) = ζ a

dn and σ(γdn)/γdn = ζ b

dn for each n ≥ 1. Such an

dnγdn of φ−n(α) to ζ ai+b

automorphism sends an arbitrary element ζ i
dn γdn, and thus evidently
the full group on the right-hand side of (7) acts transitively on each φ−n(α), and thus on δT .
When α ∈ K is not a root of unity, the image of ω in (7) has ﬁnite index in the group on the
right-hand side (see for example [14, p. 302 and proof of Theorem 1]), and hence (zd, α) is
eventually stable.
Case 2: A = Gm, δ(z) = zd for d ≥ 2, π = z + z−1. In this case φ(z) = Td(z), the monic
degree-d Chebyshev polynomial. If β +β−1 = α, γdn is a root of xdn
−β, and ζdn is a primitive
dnth root of unity, then

(α) = {ζ i

dnγdn + (ζ i

T −n
d
So if GK acts on the ζ i
(α) with at most j orbits.
Hence if K is a global ﬁeld of characteristic not dividing d, then by the Kummer-theoretic
argument in Case 1, we have that (Td(z), α) is eventually stable, provided that α is not the
image of a root of unity under π.

dnγdn with j orbits, then it acts on T −n

dnγdn)−1 : i = 1, . . . , dn}.

d

Case 3: A = E is an elliptic curve deﬁned over K and δ is the multiplication-by-ℓ map
for some prime ℓ. In this case φ is a Latt`es map, and π can be taken to be deﬁned over Q
([26, Chapter 6]). Let E[ℓn] ⊂ E(K) be the ℓn-torsion points of E, and suppose that K is a
global ﬁeld of characteristic diﬀerent from ℓ, so that E[ℓn] ∼= (Z/ℓnZ)2. Let β ∈ E(K) satisfy
π(β) = α, let ℓ−n(β) = {γ ∈ E(K) : [ℓn](γ) = β}, and ﬁx γn ∈ ℓ−n(β). Then there is a
natural map

(8)

ω : GK → lim
←−

n→∞(cid:18) Aut(E[ℓn]) E[ℓn]

0

1 (cid:19) ∼=(cid:18) GL2(Zℓ) Z2

1 (cid:19) ,

0

ℓ

where the ﬁrst map is given by σ 7→ (cid:18) a b

0 1 (cid:19) where a = σ|E[ℓn] and b = σ(γn) − γn for

each n ≥ 1 (see [20, Proposition 3.1]). Such an automorphism sends an arbitrary element
un + γn ∈ ℓ−n(β), where un ∈ E[ℓn], to (a(un) + b) + γn, and thus evidently the full group
on the right-hand side of (8) acts transitively on each ℓ−n(β). Suppose that β is non-torsion,
and that E does not have complex multiplication. Then it follows from a well-known result
of Serre [24] and a result due to Bertrand [3, Theorem 2, p. 40] (see [23, Corollary 2.9] for a
generalization) that the image of ω in (8) has ﬁnite index in the right-hand side. Hence by
Proposition 3.3, GK acts on ℓ−n(β) with a bounded number of orbits as n grows. As in Case
2, we have that

φ−n(α) = {π(γ) : γ ∈ ℓ−n(β)}.

12

RAFE JONES AND ALON LEVY

Thus when α is not the image under π of a torsion point, we have that GK acts on φ−n(α)
with a bounded number of orbits as n grows, so (φ, α) is eventually stable.

4. Proofs of Main Theorems

Throughout this section, we use “discrete valuation” to mean a discrete non-archimedean
valuation on a ﬁeld K, normalized so that v(K \ {0}) = Z. We take R to be the ring of
integers {x ∈ K : v(x) ≥ 0}, and p to be the unique maximal ideal {x ∈ K : v(x) > 0} of R.
We let k be the residue ﬁeld R/p and we denote by ˜f the polynomial obtained from f ∈ R[z]
by reducing each coeﬃcient modulo p. We begin with an easy generalization of Eisenstein’s
criterion.

Lemma 4.1. Let v be a discrete valuation on a ﬁeld K, let f (z) = adzd + · · · + a0 ∈ R[z] for
d ≥ 1, and suppose that a0 6= 0, v(ad) = 0 and v(ai) > 0 for all i = 0, . . . , d − 1. Then f (z)
has at most v(a0) irreducible factors over K.

Proof. Write f (z) = adf0(z) with f0(z) ∈ R[z] monic, and let v(f0(0)) = m, which is identical
to v(a0). Suppose that f0(z) = g1(z) · · · gm+1(z) is a factorization of f0 into monics in K[x]

with deg gi = ei ≥ 1 and P ei = d. By Gauss’ Lemma, we may assume gi ∈ R[z] for all i.
v(f0(0)) =P v(gi(0)) > m, a contradiction.

Then ˜gi is again monic of degree ei, and we have zd = ˜g1(z) · · ·
˜gm+1(z) in k[z]. Because k[z]
is a UFD, we must have ˜gi(z) = zei for all i, and hence v(gi(0)) > 0 for all i. This implies
(cid:3)

The following lemma generalizes Lemma 2.2 of [13].

Lemma 4.2. Let v be a discrete valuation on K, let φ, ψ ∈ K(z) have good reduction at v, and
suppose that φ(0) 6= 0, v(φ′(0)) > 0, and v(φ(0)) = v(ψ(0)) = r > 0. Then v(φ(ψ(0))) = r.

Remark. The assumption that φ and ψ have good reduction can be replaced by assuming
that the constant term in the denominator of each function is in R∗. This assumption is
necessary, as illustrated by the example of K = Q, φ(z) = ψ(z) = (z2 + 8)/4, and v the
2-adic valuation.

Proof. Let d = deg ϕ and d′ = deg ψ, and write

ϕ(z) =

adzd + . . . + a0
bdzd + . . . + b0

,

ψ(z) =

dzd′
+ . . . + a′
a′
0
b′
dzd′ + . . . + b′
0

=

f (z)
g(z)

,

with all coeﬃcients in R, at least one of the ai, bj in R∗ and at least one of the a′
j in R∗. By
assumption 0 < r = v(φ(0)) = v(a0) − v(b0), and since b0 ∈ R we must have v(a0) > 0. Then
because φ has good reduction at v we must also have v(b0) = 0, whence v(a0) = r. Similarly,
0) = 0. Note also that φ′(0) = b0a1 − a0b1, and because v(a0b1) > 0 and
v(a′
v(φ′(0)) > 0, we must have v(a1) > 0. Now
adψ(z)d + . . . + a1ψ(z) + a0
bdψ(z)d + . . . + b1ψ(z) + b0

adf (z)d + . . . + a1f (z)g(z)d−1 + a0g(z)d
bdf (z)d + . . . + b1f (z)g(z)d−1 + b0g(z)d ,

0) = r and v(b′

φ(ψ(z)) =

i, b′

=

and hence

(9)

φ(ψ(0)) =

ad(a′
bd(a′

0)d + . . . + a1a′
0)d + . . . + b1a′

0(b′
0(b′

0)d−1 + a0(b′
0)d−1 + b0(b′

0)d
0)d .

EVENTUALLY STABLE RATIONAL FUNCTIONS

13

0(b′

0)d−1 and a0(b′

Because v(a′
a1a′
But v(a1) > 0, and so v(a1a′
the other hand, v(b0(b′
0.

0) = r > 0, all terms in the right-hand side of (9) have valuation at least 2r except
0)d in the denominator.
0)d−1) > r, implying that the numerator has valuation r. On
0)d−1) > 0, so the denominator has valuation
(cid:3)

0)d in the numerator and b1a′

0)d) = 0 and v(b1a′

0(b′

0(b′

0(b′

0)d−1 and b0(b′

Lemma 4.3. Let v be a discrete valuation on K, let φ ∈ K(z) have good reduction at v, and
suppose that φ(0) 6= 0, v(φ(0)) > 0, and v(φ′(0)) > 0. Then v(φn(0)) = v(φ(0)) for all n ≥ 1.

Proof. A straightforward inductive argument, taking ψ = φn−1 in Lemma 4.2.

(cid:3)

To give some intuition for why Lemma 4.3 is true, note that the hypotheses that φ have
good reduction at v, φ(0) 6= 0, and v(φ(0)) > 0 ensure that p contains a ﬁxed point of φ
whose multiplier vanishes modulo p. If we deﬁne a p-adic absolute value on K \{0} by setting
|x| = p−v(x) in the usual way, then such a ﬁxed point is p-adically attracting, and 0 lies in its
p-adic basin of attraction. Thus p-adically the orbit of 0 converges monotonically to this ﬁxed
point, and by the strong triangle inequality every element of this orbit must have constant
absolute value.

Recall that φ ∈ K(z) is normalized if φ(z) = f (z)/g(z) where f, g ∈ R[z] and at least one

coeﬃcient of f or g is in R∗.

Theorem 4.4. Let v be a discrete valuation on K, let φ ∈ K(z) have degree d ≥ 2, and
let φ(z) = f (z)/g(z) be normalized. Suppose that φ has good reduction at v, φ(0) 6= 0, and
˜f = Czd for C ∈ k∗. For each n ≥ 1, let φn(z) = fn(z)/gn(z) be normalized. Then for all
n ≥ 1, fn(z) has at most v(φ(0)) irreducible factors over K. In particular, φ is eventually
stable over K.

Proof. Because φ has good reduction, we have fφn(z) = ˜φn(z) [26, Theorem 2.18]. Because

φn(z) = fn(z)/gn(z) is normalized, we have ˜φn(z) = ˜fn(z)/ ˜gn(z). However, the assumption
/ ˜gn(z) for some Cn ∈ k∗, and thus ˜fn =
that ˜φ(z) = Czd/˜g(z) implies that ˜φn(z) = Cnzdn
Cnzdn
. But deg fn ≤ deg φn = dn, and so deg fn = dn. From Lemma 4.1 we now have that fn
has at most v(fn(0)) factors, provided that fn(0) 6= 0. But φn has good reduction, and hence
v(gn(0)) = 0. It follows that v(fn(0)) = v(φn(0)), which by Lemma 4.3 must equal v(φ(0)).
In particular φn(0) 6= 0, and it follows that fn has at most v(φn(0)) = v(φ(0)) irreducible
factors over K.
(cid:3)

In the following, we take v(∞) = −∞.

Theorem 4.5. Let v be a discrete valuation on K, let φ ∈ K(z) have degree d ≥ 2, and let
α ∈ P1(K). Suppose that φ has good reduction at v, φ(α) 6= α, and ˜φ−1(˜α) = {˜α} as a map
of P1(k). For each n ≥ 1, let φn = fn/gn be normalized. Then fn(z) − αgn(z) (or gn(z) if
α = ∞) has at most v(φ(α) − α) (or v(φ(α)−1 − α−1) if v(α) < 0) irreducible factors over
K. In particular, (φ, α) is eventually stable over K.

Proof. Let φ = f /g be normalized. First suppose that α ∈ R, and let φ0(z) = φ(z + α) − α.
Then the map µ(z) = z + α has good reduction at v, and because φ0 = µ−1 ◦ φ ◦ µ it follows
from [26, Theorem 2.18] that φ0 has good reduction at v. The conditions that φ have good
reduction at v and φ−1(˜α) = {˜α} as a map of P1(k) are equivalent to ˜φ(z)− ˜α = C(z− ˜α)d/˜g(z)

14

RAFE JONES AND ALON LEVY

for C ∈ k∗, implying thatfφ0(z) = Czd/˜g(z + ˜α). Finally, φ(α) 6= α implies φ0(0) 6= 0. Letting

φn
0 = un/tn be normalized, Theorem 4.4 gives that un(z) has at most v(φ0(0)) irreducible
factors over K. Now if φn = fn/gn is normalized, then φn(z + α) − α = un(z)/tn(z) gives
un(z) = fn(z + α) − αgn(z + α), and thus the number of irreducible factors of un(z) over
K is the same as the number of irreducible factors of fn(z) − αgn(z) over K. Because
v(φ0(0)) = v(φ(α) − α), the theorem is proved for α ∈ R.

Assume now that α ∈ (K \ R) ∪ {∞} (i.e. ˜α = ∞), let ψ(z) = 1/φ(1/z), and take 1/α = 0
if α = ∞. Then 1/α ∈ R, ψ has good reduction at v, ψ(1/α) 6= 1/α, and ˜ψ−1(1/˜α) =
{1/˜α} as a map of P1(k). Letting ψn = vn/wn be normalized, the previous paragraph
gives that vn(z) − (1/α)wn(z) has at most v(ψ(1/α) − 1/α) irreducible factors over K. But
vn(z) − (1/α)wn(z) = g∗
n denote the reciprocal polynomials of
fn, gn, and hence vn(z) − (1/α)wn(z) has the same number of irreducible factors over K as
gn(z) − (1/α)fn(z). If α = ∞, then this bounds the number of irreducible factors of gn(z),
while if α 6= ∞ it bounds the number of irreducible factors of (−α)(gn(z) − (1/α)fn(z)) =
fn(z) − αgn(z). The bound is given by v(ψ(1/α) − 1/α), which is v(1/φ(α) − 1/α).
(cid:3)

n(z) − (1/α)f ∗

n(z), where f ∗

n, g∗

Theorem 4.5 allows us to generalize [14, Corollary 3] on the eventual stability of certain
polynomials. Moreover, our proof is purely algebraic, in contrast to the analytic arguments
of [14], where the author constructs a Galois-equivariant p-adic version of the B¨ottcher coor-
dinate from complex dynamics.

Corollary 4.6. Let K be a ﬁeld, let v a discrete valuation on K, and let φ ∈ K[z] have
degree d ≥ 2. If φ has good reduction at v and α ∈ K has v(α) < 0, then φn(z) − α has at
most −v(α) irreducible factors over K. In particular, (φ, α) is eventually stable.

Proof. Note that the hypotheses prohibit φ(α) = α. Moreover, ˜φ is a polynomial, and hence
satisﬁes ˜φ−1(∞) = {∞} as a map of P1(k). The result now follows from Theorem 4.5 and
the observation that for a polynomial adzd + · · · + a0 with v(ad) = 0 and v(ai) ≥ 0 for
i = 1, . . . , d − 1, we have v(1/φ(α) − 1/α) = v(φ(α) − α) − v(αφ(α)), and v(α) > 0 and the
strong triangle inequality force the last expression to be dv(α) − (d + 1)v(α).
(cid:3)

Deﬁnition 4.7. Let v be a discrete valuation on a ﬁeld K, and assume that the reside ﬁeld
k is ﬁnite of characteristic p. We say that φ ∈ K(z) is bijective on residue extensions
for v if ˜φ acts as a bijection on P1(E) for every ﬁnite extension E of k.

The property of being bijective on residue extensions is a strong form of the notion of
exceptional rational function, i.e., a rational function that acts bijectively on inﬁnitely many
residue extensions (see [12] for a further generalization of this deﬁnition to certain maps of
varieties). We now give a characterization of maps that are bijective on residue extensions.
While this characterization is well-known to experts, we include a proof for completeness. For
polynomials this is a result of Carlitz [5, Theorem 3], and the proof we give closely resembles
his argument.

Proposition 4.8. Let v be a discrete valuation on a ﬁeld K, suppose that the residue ﬁeld k
is ﬁnite of characteristic p, and let φ ∈ K(z) have degree d ≥ 2. The following are equivalent:

(A) φ is bijective on residue extensions for v.

EVENTUALLY STABLE RATIONAL FUNCTIONS

15

(B) for each β ∈ P1(k), there is a unique γ ∈ P1(k) with ˜φ(γ) = β (which must in fact

satisfy γ ∈ P1(k)).

(C) ˜φ is non-constant and is of the form (c1zpj

+c2)/(c3zpj

+c4) for j ≥ 0 and c1, c2, c3, c4 ∈

k.

Proof. To show (A) implies (B), let E be the ﬁnite extension of k given by adjoining all γ ∈ k
with ˜φ(γ) = β for some β ∈ P1(k). By (B) we have that ˜φ acts on E as a bijection, from
which it follows that if ˜φ(z) = β has a solution in k, it has a unique such solution. Moreover,
if β ∈ P1(k) is such that ˜φ(z) = β has no solution in k, then ˜φ−1(β) = {∞} as a map of P1(k).
This shows that as a map of k, we have # ˜φ−1(P1(k) = #(P1(k)). But ˜φ(P1(k)) = P1(k), and
so we conclude that ˜φ−1(P1(k)) = P1(k) and hence γ ∈ P1(k).

To show that (B) implies (C), ﬁrst note that (B) precludes ˜φ from being constant. Let
d = deg ˜φ ≥ 1, and consider the set S = {g(z)} ∪ {f (z) − βg(z) : β ∈ k}. By (B), precisely
one element of S is constant, and all others have the form c(z − γ)d for γ ∈ k and c 6= 0.
Thus

(10)

˜φ has one of the forms

c1(z − γ1)d
c3(z − γ2)d ,

c1

c3(z − γ2)d ,

or

c1(z − γ1)d

c3

,

with c1c3 6= 0 and γ1, γ2 ∈ k, γ1 6= γ2.
f (z), f (z) − (f (z) − g(z)) = g(z), and f (z) − (βg(z)) = f (z) − βg(z), we then have

In light of the equations g(z) + (f (z) − g(z)) =

C1(z + γ1)d + C2(z + γ2)d = 1,

where C1, C2 ∈ k, C1C2 6= 0 and we substitute −γi for γi in order to ease notation, which
still preserves γ1 6= γ2. Matching zd-coeﬃcients gives C1 + C2 = 0. Matching lower-degree
coeﬃcients then gives

for i = 1, . . . , d − 1. Suppose now that pe | d for some e ≥ 0. If d > pe, then set i = pe in
(11) and note that z 7→ zpe
2 , and so

induces a bijection on k. Thus γ1 6= γ2 implies γpe

1 6= γpe

(11)

(cid:0) d
d−pe(cid:1) = 0 in k, giving

(12)

C1(cid:18) d

d − i(cid:19)(γi

1 − γi

2) = 0

p |

d(d − 1) · · · (d − pe + 1)

pe(pe − 1) · · · 1

.

But the assumption that pe | d implies that vp(d − i) = vp(pe − i) for all i = 1, . . . , pe − 1,
where vp denotes the p-adic valuation. It then follows from (12) that p | (d/pe), and thus
pe+1 | d. Now write d = pj ·m, where j ≥ 0, and m ≥ 1 is maximal subject to p ∤ m. If m > 1,
then d > pj, and so pj+1 | d, a contradiction. Hence d = pj. It now follows immediately from
(10) that ˜φ has the form given in (C).

To show (C) implies (A), let E be a ﬁnite extension of k, and β ∈ E. Because ˜φ is non-
constant, the equation ˜φ(z) = β has no solutions in E if and only if c3 6= 0 and β = c1/c3,
in which case ˜φ(∞) = β. Otherwise ˜φ(z) = β is equivalent to zpj
= δ, where δ = −(c2 −
βc4)/(c1 − βc3) ∈ k. But E is a ﬁnite ﬁeld of characteristic p, and so z 7→ zpj
gives a bijection
on E, whence zpj
= δ has a (unique) solution in E. This shows that E is contained in the

16

RAFE JONES AND ALON LEVY

image of the map ˜φ : P1(E) → P1(E). But ˜φ(∞) = ∞ if c3 = 0, and otherwise ˜φ(γ) = ∞,
= −c3/c4. Hence ˜φ is a surjection of the ﬁnite set
where γ is the unique solution in E to zpj
P1(E) to itself, and thus a bijection.
(cid:3)

Corollary 4.9. Let v be a discrete valuation on a ﬁeld K, suppose that k is ﬁnite of char-
acteristic p, let φ ∈ K(z) have degree d ≥ 2, and let α ∈ P1(K) be non-periodic for φ. If φ
has good reduction and is bijective on residue extensions at v and φn = fn/gn is normalized,
then fn(z) − αgn(z) (or gn(z) if α = ∞) has at most v(φi(α) − α) (or v(φ(α)−1 − α−1) if
v(α) < 0) irreducible factors over K, where

i = min{n ≥ 1 : ˜φn(˜α) = ˜α} ≤ #(P1(k)).

In particular, (φ, α) is eventually stable, and hence if K is a number ﬁeld or a function ﬁeld,
Conjecture 1.2 holds for φ.
Proof. Because ˜φ acts bijectively on P1(k), there exists i ≥ 1 with ˜φi(˜α) = ˜α. Assume that i
is the minimal such integer, and note that i ≤ #(P1(k)). By condition (B) of Proposition 4.8,
we have ( ˜φi)−1(˜α) = {˜α}. We also have φi(α) 6= α, because α is assumed to be non-periodic
for φ. The corollary then follows from Theorem 4.5 and (c) of Proposition 2.1.
(cid:3)

The authors would like to thank Michael Zieve for pointing out useful references.

Acknowledgements

References

[1] Omran Ahmadi, Florian Luca, Alina Ostafe, and Igor E. Shparlinski. On stable quadratic polynomials.

Glasg. Math. J., 54(2):359–369, 2012.

[2] Alan F. Beardon. Iteration of rational functions, volume 132 of Graduate Texts in Mathematics. Springer-

Verlag, New York, 1991. Complex analytic dynamical systems.

[3] D. Bertrand. Galois representations and transcendental numbers. In New advances in transcendence theory

(Durham, 1986), pages 37–55. Cambridge Univ. Press, Cambridge, 1988.

[4] Nigel Boston and Rafe Jones. Settled polynomials over ﬁnite ﬁelds. Proc. Amer. Math. Soc., 140(6):1849–

1863, 2012.

[5] L. Carlitz. Permutations in ﬁnite ﬁelds. Acta Sci. Math. (Szeged), 24:196–203, 1963.
[6] Lindsay Childs. A concrete introduction to higher algebra. Springer-Verlag, New York-Heidelberg, 1979.

Undergraduate Texts in Mathematics.

[7] Lynda Danielson and Burton Fein. On the irreducibility of the iterates of xn

− b. Proc. Amer. Math. Soc.,

130(6):1589–1596 (electronic), 2002.

[8] Xander Faber, Benjamin Hutz, Patrick Ingram, Rafe Jones, Michelle Manes, Thomas J. Tucker, and
Michael E. Zieve. Uniform bounds on pre-images under quadratic dynamical systems. Math. Res. Lett.,
16(1):87–101, 2009.

[9] Domingo G´omez-P´erez, Alejandro P. Nicol´as, Alina Ostafe, and Daniel Sadornil. Stable polynomials over

ﬁnite ﬁelds. Rev. Mat. Iberoam., 30(2):523–535, 2014.

[10] Domingo G´omez-P´erez, Alina Ostafe, and Igor E. Shparlinski. On irreducible divisors of iterated polyno-

mials. Rev. Mat. Iberoam., 30(4):1123–1134, 2014.

[11] C. Gratton, K. Nguyen, and T. J. Tucker. ABC implies primitive prime divisors in arithmetic dynamics.

Bull. Lond. Math. Soc., 45(6):1194–1208, 2013.

[12] Robert M. Guralnick, Thomas J. Tucker, and Michael E. Zieve. Exceptional covers and bijections on

rational points. Int. Math. Res. Not. IMRN, (1):Art. ID rnm004, 20, 2007.

[13] Spencer Hamblen, Rafe Jones, and Kalyani Madhu. The density of primes in orbits of zd + c. Int. Math.

Res. Not. IMRN, (7):1924–1958, 2015.

EVENTUALLY STABLE RATIONAL FUNCTIONS

17

[14] Patrick Ingram. Arboreal Galois representations and uniformization of polynomial dynamics. Bull. Lond.

Math. Soc., 45(2):301–308, 2013.

[15] Konrad Jacobs. Measure and integral. Academic Press [Harcourt Brace Jovanovich, Publishers], New

York-London, 1978. Probability and Mathematical Statistics, With an appendix by Jaroslav Kurzweil.

[16] Rafe Jones. The density of prime divisors in the arithmetic dynamics of quadratic polynomials. J. Lond.

Math. Soc. (2), 78(2):523–544, 2008.

[17] Rafe Jones. An iterative construction of irreducible polynomials reducible modulo every prime. J. Algebra,

369:114–128, 2012.

[18] Rafe Jones. Galois representations from pre-image trees: an arboreal survey. In Actes de la Conf´erence
“Th´eorie des Nombres et Applications”, Publ. Math. Besan¸con Alg`ebre Th´eorie Nr., pages 107–136.
Presses Univ. Franche-Comt´e, Besan¸con, 2013.

[19] Rafe Jones and Michelle Manes. Galois theory of quadratic rational functions. Comment. Math. Helv.,

89(1):173–213, 2014.

[20] Rafe Jones and Jeremy Rouse. Galois theory of iterated endomorphisms. Proc. Lond. Math. Soc. (3),

100(3):763–794, 2010. Appendix A by Jeﬀrey D. Achter.

[21] Serge Lang. Fundamentals of Diophantine geometry. Springer-Verlag, New York, 1983.
[22] R. W. K. Odoni. The Galois theory of iterates and composites of polynomials. Proc. London Math. Soc.

(3), 51(3):385–414, 1985.

[23] Richard Pink. On the order of the reduction of a point on an abelian variety. Math. Ann., 330(2):275–291,

2004.

[24] Jean-Pierre Serre. Propri´et´es galoisiennes des points d’ordre ﬁni des courbes elliptiques. Invent. Math.,

15(4):259–331, 1972.

[25] Joseph H. Silverman. Integer points, Diophantine approximation, and iteration of rational maps. Duke

Math. J., 71(3):793–829, 1993.

[26] Joseph H. Silverman. The arithmetic of dynamical systems, volume 241 of Graduate Texts in Mathematics.

Springer, New York, 2007.

[27] Vijay A. Sookdeo. Integer points in backward orbits. J. Number Theory, 131(7):1229–1239, 2011.
[28] L. Stickelberger. ¨Uber eine neue eigenschaft der diskriminanten algebraischer zahlk¨orper. Verh. 1 Internat.

Math. Kongresses, 1897, Leipzig, pages 182–193, 1898.

