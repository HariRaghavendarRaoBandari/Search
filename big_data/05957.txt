6
1
0
2

 
r
a

 

M
8
1

.

 
 
]
E
P
o
i
b
-
q
[
 
 

1
v
7
5
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Solutions with a bounded support promote permanence of a

distributed replicator equation

Alexander S. Bratus1,2, Vladimir P. Posvyanskii2 , Artem S. Novozhilov3,∗

1Faculty of Computational Mathematics and Cybernetics,

Lomonosov Moscow State University, Moscow 119992, Russia

2Applied Mathematics–1, Moscow State University of Railway Engineering,

Moscow 127994, Russia

3Department of Mathematics, North Dakota State University, Fargo, ND 58108, USA

Abstract

The now classical replicator equation describes a wide variety of biological phenomena,
including those in theoretical genetics, evolutionary game theory, or in the theories of the
origin of life. Among other questions, the permanence of the replicator equation is well
studied in the local, well-mixed case.
Inasmuch as the spatial heterogeneities are key to
understanding the species coexistence at least in some cases, it is important to supplement the
classical theory of the non-distributed replicator equation with a spatially explicit framework.
One possible approach, motivated by the porous medium equation, is introduced.
It is
shown that the solutions to the spatially heterogeneous replicator equation may evolve to
equilibrium states that have a bounded support, and, moreover, that these solutions are
of paramount importance for the overall system permanence, which is shown to be a more
commonplace phenomenon for the spatially explicit equation if compared with the local
model.

Keywords: Replicator equation, reaction–diﬀusion systems, stability, permanence, uni-
form persistence

AMS Subject Classiﬁcation: Primary: 35K57, 35B35, 91A22; Secondary: 92D25

1

Introduction

The species coexistence is arguably the most important characteristics of a biological (ecological,
chemical, etc) system. The clear understanding of this trivial fact led to highly nontrivial
theories of mathematical permanence [15] or uniform persistence [27], which provide the rigorous
framework for the verbal description that “The presence or the absence of a species is sometimes
the point of interest regardless of some variation in their numbers” [21].

∗Corresponding author: artem.novozhilov@ndsu.edu

1

A signiﬁcant number of results for the species permanence, which mathematically means
that the solutions are separated from both zero and inﬁnity, were obtained for the so-called
replicator equation [16, 15, 26], in the classical form

˙wi = wi(cid:16)(cid:0)Aw(cid:1)i − hw, Awi(cid:17),

i = 1, . . . , n,

(1.1)

where w = (w, . . . , wn) is the vector of frequencies of interacting species, real matrix A describes
the interactions in terms of the catalyzing rates, (u)i is the i-th entry of the vector u, and h·, ·i
is the usual dot product in Rn. Note that if Sn is the standard simplex in Rn then, due to the
normalization term hw, Awi, w(t) ∈ Sn for any time moment, assuming w(0) ∈ Sn, that is the
simplex is invariant with respect to the ﬂow deﬁned by (1.1).

Problem (1.1) is a system of ordinary diﬀerential equations (ODE) and therefore describes
the dynamics of a well mixed system. It is a common wisdom that the spatial structure medi-
ates coexistence [9, 13], and therefore we face an important problem to extend, compare, and
generalize the results obtained for the local system (1.1) to the case when we include the spatial
variables in our equations. The ﬁrst fact that should be clearly understood in this respect is
that there are diﬀerent and non-equivalent ways to add the spatial heterogeneity to the model
(1.1), that is, the results of analysis are model dependent.

One way to model the spatial structure is to assume that the individuals are associated
with vertices of some graph, and two individuals interact if their vertices are connected by an
edge. This approach led to the evolutionary games on graphs (e.g., [22]). Alternatively, it
is also possible to assume that the whole system composed of a number of local populations,
within which the infractions are random, and some dispersal rates between the patches are
speciﬁed (e.g., [25]). It is important to remark that in both of these cases the dynamics of the
structured populations is diﬀerent from that of the underlying well-mixed model; in particular,
an important phenomenon of cooperation can be maintained in structured populations, opposite
to the evolutionary outcomes in local, randomly mixing populations.

One of the most popular ways to add the spatial heterogeneity to the local ODE models
is to consider a corresponding reaction-diﬀusion system, when the Laplace operator, describing
the microscopic Browning motion, is added to the rates of the local model. Note, however,
that it is incorrect to add the Laplace operator directly to system (1.1) (see [23] for a review,
and [5, 7, 6, 10, 11, 19, 18, 30, 29, 31] for additional details and analysis of special cases). A
natural approach to add the spatial heterogeneity through the reaction-diﬀusion mechanism to
the replicator equation (1.1) is to start with the equation for the absolute sizes, and not for the
frequencies as in (1.1), add the Laplace operator, and after this make the change of variables to
reduce the system to the problem on simplex (which becomes integral in this case, see below for
the exact deﬁnition). This idea, which is a mathematical manifestation of the global regulation
was originally used for the quasispecies model [31], see also [4] for more general results, and
in [5] for the hypercycle model; subsequent analysis of the general reaction-diﬀusion replicator
equation was performed in [7, 6]. One of the conclusions that we obtained in the cited works is
that the behavior of solutions of the reaction-diﬀusion replicator equation obtained through the
principle of global regulation is qualitatively similar to the solutions of the local model (1.1),
and in particular the set of all the matrices A, for which the system is permanent, is no bigger
than this set for model (1.1). At the same time the local model (1.1) is not adequate at least in
some cases, as the following example shows.

2

Example 1.1. Consider an in-vitro system of cooperative RNA replicators, analyzed in [28],
which can be schematically represented as in Fig. 1.

Figure 1: A schematic representation of the catalytic network of 6 macromolecules [28]

It was shown that this particular network of macromolecules is capable of sustaining self-
replication (that is, it is permanent, and none of the macromolecules went extinct in experi-
ments). A naive modeling approach would be to consider an interaction matrix

0

0 α 0

0
α 0
0 α 0 γ
γ
0
0 γ

0
0 γ
0

0 γ
0
0 β 0

0 γ
0
0
0
0 β 0
0 β
0









A =

and the corresponding replicator equation (1.1). It can be shown, however (see [8] for additional
details), that this system is not permanent contradicting therefore the experimental results.

Example 1.1 prompts for a modiﬁcation of the local replicator equation (1.1) such that the
model solution would reﬂect the permanent nature of the underlying cooperative network. To
this end, we suggested in [8] another way to arrive to a reaction-diﬀusion equation, motivated
in signiﬁcant part by the diﬀusion equation in the porous medium [2, 20]. In particular, for the
absolute sizes N = (N1, . . . , Nn) we can write

1

φi(N )

∂tNi = (Aw)i + di∆Ni,

i = 1, . . . , n,

where the functions φi specify how the densities aﬀect the diﬀusion rates, and di are some given
parameters. In particular, for the simplest case φi(N ) = Ni we obtain a quasilinear reaction-
diﬀusion PDE

∂tNi = (Aw)iNi + diNi∆Ni,

i = 1, . . . , n.

(1.2)

Equations of this type received much less attention in the literature, compare to the classical
reaction-diﬀusion systems [9], see, e.g., [24] for one example, where a simple model was used to
model the spread of infection in a population of individuals with low mobilities. Such equations,
being quasilinear, pose signiﬁcant mathematical challenges (e.g., [1, 3, 12]).

3

In [8] we performed a numerical and analytical analysis of the reaction-diﬀusion replicator
equation, which is obtained from (1.2) by switching to the vector of frequencies (see below for
the exact expressions). In particular, we proved that for suﬃciently large parameters di > 0 the
equilibria of the reaction–diﬀusion replicator equation are uniform and coincide with equilibria of
(1.1), and, more importantly, identiﬁed the conditions when their stability properties coincide.
Additionally, we found a suﬃcient condition that the distributed spatially heterogeneous system
is permanent. This condition, however, turned out to be more restrictive than that for the local
system. Our two most interesting observations were of a numerical nature. We found that 1) for
a large number of examples of replicator equations including the spatial structure in the form of
equation (1.2) leads to system permanence even if the original local system does not demonstrate
species coexistence, and 2) with time the solutions to the reaction-diﬀusion replicator equation
tend to equilibrium solutions, whose support is only part of the domain in which we consider our
problem. Both of these facts can be observed for the problem in Example 1.1. Here is another
simple example to support and illustrate our claims. This example also serves to motivate the
subsequent analytical analysis.

Example 1.2. Consider the replicator equation with the matrix

A =(cid:20)1.1 1
0(cid:21) .

1

For this example, a straightforward analysis of (1.1) shows that w1(t) → 1and w2(t) → 0 as
t → ∞, and therefore the system is clearly not permanent (Fig. 2a). If, however, we consider a
reaction–diﬀusion replicator equation of the form (1.2), (the parameters are d1 = 1.1/π2, d2 =
0.5/π2), then the numerical experiments show that the spatial heterogeneity stabilizes the sys-
tem, which becomes permanent (see Fig. 2c,d). Note also that in the long run the solutions
concentrate only on a proper subset of the spatial domain Ω = (0, 1) (Fig. 2c).

The goal of the present paper is to provide analytical analysis of both observations made in
[8] and presented in Example 1.2, i.e., to study analytically the appearance of solutions that are
nonzero only on the part of the spatial domain Ω, in the following we call such situations solutions
with bounded support, and provide suﬃcient conditions for the system permanence, which go
beyond those valid for the local system. It turns out, as we show, that these two observations
are inherently interconnected, and the solutions with bounded support play a signiﬁcant role in
the system permanence.

Before embarking on the analysis of our distributed replicator equation, it is important to
mention that the usual deﬁnition of the system permanence (see, e.g., [9], the deﬁnition of the
“ecological permanence”) requires that m ≤ ui(x, t) ≤ M for all t > t0 and all x ∈ Ω, m, M are
given constants. In view of the special solutions we are about to study (Fig. 2c) this deﬁnition
is clearly not satisfactory for us. Therefore, in the rest of the paper the term “permanence”
means that the integral value of the variables, i.e.,

ui(x, t) dx

ZΩ

is separated from 0 for any time t > t0 (see below precise Deﬁnition 2.3).

The rest of the paper is organized as follows. In Section 2 we collect necessary notations and
introduce a key deﬁnition of the resonant parameters. In Section 3 we show how the solutions

4

Figure 2: Comparison of the local and distributed replicator systems with the same interaction
matrix (Example 1.2). (a) Time dependent solutions to the local system. (b) The initial con-
ditions for the spatially distributed replicator equation. (c) The limit of the solutions to the
distributed replicator equation when t → ∞. (d) The time dependent behavior of the integrals
of the solutions in the distributed case

with bounded support naturally appear in our problems. Section 4 is devoted to the study of the
connections between the solutions with bounded support and system permanence. In Appendix
we prove some auxiliary facts.

2 Model statement

In this section we collect necessary notations and facts required for the subsequent analysis.

Let Ω be a bounded domain in Rm, where m is equal to 1, 2, or 3, depending on the
required geometry, with a piecewise-smooth boundary Γ, A = (aij)n×n a given real matrix,

v = v(x, t) = (cid:0)v1(x, t), . . . , vn(x, t)(cid:1) a vector-function, x ∈ Ω, t ≥ 0. We introduce the

5

notations

n

k = 1, . . . , n,

(cid:0)Av(cid:1)k =

hAv, vi =

n

akjvj(x, t),

Xj=1
Xj=1(cid:0)Av(cid:1)jvj(x, t) =

n

Xj,k=1

akjvk(x, t)vj(x, t).

We consider the initial-boundary value problem (here dk > 0, k = 1, . . . , n are parameters)

with the initial and boundary conditions

k = 1, . . . , n,

k = 1, . . . , n,

vk(x, 0) = ϕk(x),

∂vk(x, t)

∂tvk = vk(cid:16)(cid:0)Av(cid:1)k − f s(v) + dk∆vk(cid:17),
(cid:12)(cid:12)(cid:12)(cid:12)x∈Γ
dkk∇vkk2(cid:17) dx.
Xk=1

f s(v) =ZΩ(cid:16)hAv, vi −

= 0,

∂ν

n

where ν is the outward normal to Γ. In the system (2.1) we have

(2.1)

(2.2)

(2.3)

At this point we would like to remark that the system (2.1)–(2.3) is not a classical system of
partial diﬀerential equations (PDE) since f s(v) is a functional on the solutions to the problem
(2.1)–(2.2).

From (2.1)–(2.3) it follows that

vk(x, t) dx! = 0,

d

dt  n

Xk=1ZΩ
Xk=1ZΩ

n

which means that

vk(x, t) dx = const

(2.4)

for any t ≥ 0, where the constant can be chosen arbitrarily, we set it equal to one. This means
that the integral simplex (see below) of the problem (2.1)–(2.3) is invariant.

Problem (2.1)–(2.2) is a spatially explicit replicator equation of the reaction-diﬀusion type
and describes, for instance, the population dynamics of self-replicating and interacting molecules.
In this interpretation vk(x, t) is the relative density of the macromolecules of the k-th type
relative to the total density in the domain Ω at the time moment t. The functional f s(v) is

hence the mean population ﬁtness, and the expression (cid:0)Av(cid:1)k is the ﬁtness of the k-th type of

macromolecules at the point x ∈ Ω at the time moment t.

From the physical meaning of the problem we conclude that the solutions to (2.1)–(2.3)
should be sought among the set of non-negative functions vk(x, t) ≥ 0, x ∈ Ω, t ≥ 0, k = 1, . . . , n.
In the following we assume that the functions vk(x, t), x ∈ Ω, t ≥ 0, k = 1, . . . , n are smooth
with respect to t and, together with their derivatives with respect to t, belong to the Sobolev
space W 1,2, if m = 1, and to W 2,2, if m = 2, 3, for each ﬁxed t > 0. Here W s,2 is the space of

6

square integrable functions in Ω together with their (weak) derivatives up to the order s. We
note that from the embedding theorems (e.g., [14]) it follows that such functions coincide with
continuous functions almost everywhere in Ω.

Denote Ωt = Ω × [0, ∞) and consider the set of functions B(Ωt) with the norm

kz(x, t)kB(Ωt) = max
t≥0

{kz(x, t)kW s,2 + k∂tz(x, t)kW s,2 } ,

s = 1, 2.

Denote Sn(Ωt) the set of non-negative functions v(x, t) = (cid:0)v1(x, t), . . . , vn(x, t)(cid:1) such that

vk(x, t) ∈ B(Ωt) for all k and satisfy (2.4) with the constant equal to one:

n

Xk=1ZΩ

vk(x, t) dx = 1.

(2.5)

The set Sn(Ωt) is the integral simplex in the space of vector-functions, each component of which
belongs to B(Ωt).

The boundary elements (denoted bd Sn(Ωt)) of the integral simplex Sn(Ωt) are the vector-

functions v(x, t) = (cid:0)v1(x, t), . . . , vn(x, t)(cid:1) such that for a non empty set of indexes K0 ⊂

{1, . . . , n}

and vk(t) > 0, k /∈ K0, t ≥ 0. Due to the simplex invariance

vk(t) =ZΩ

vk(x, t) dx = 0,

k ∈ K0,

vk(t) = 1.

Xk /∈K0

(2.6)

The interior elements of the simplex Sn(Ωt) (denoted int Sn(Ωt)) are the vector-functions v(x, t) ∈
Sn(Ωt), for which

vk(t) =ZΩ

vk(x, t) dx > 0,

k = 1, . . . , n,

t ≥ 0.

Furthermore, without loss of generality we assume that the measure of Ω is equal to 1, |Ω| = 1.

Remark 2.1. Since vk(x, t) ∈ W s,2, k = 1, . . . , n for s = 1 or s = 2 for each t ≥ 0, then
from the embedding theorems it follows that they coincide almost everywhere with continuous
functions. Therefore, taking into account non-negativity of the functions, we conclude that if
the mean integral value vk(t) = 0 then vk(x, t) = 0 almost everywhere in Ω. Therefore the set
bd Sn(Ωt) consists of vector-fucntions for which

and also equality (2.6) holds.

vk(x, t) = 0,

k ∈ K0,

We consider weak solutions to (2.1)–(2.3). Vector function v(x, t) ∈ Sn(Ωt) is a weak solution

if the following integral identity holds:

Z ∞
0 ZΩ

∂tvk(x, t)η(x, t) dx dt =Z ∞
0 ZΩ
− dkZ ∞
0 ZΩ

vk(x, t)(cid:16)(cid:0)Av(cid:1)k − f s(v)(cid:17)η(x, t) dx dt

h∇vk(x, t), ∇η(x, t)i dx dt,

7

for each function η(x, t), which for x ∈ Ω is diﬀerential with respect to t has a compact support
for each ﬁxed t ∈ [0, ∞), and also for any t ≥ 0 belongs to W s,2(Ω) for s = 1 or s = 2.

Together with the problem (2.1)–(2.3) we also consider a system of ordinary diﬀerential

equations which can be obtained formally from the original one when dk → 0:

with the initial conditions

Here

˙wk = wk(cid:16)(cid:0)Aw(cid:1)k − f l(w)(cid:17),

k = 1, . . . n,

(2.7)

wk(0) = w0
k,

k = 1, . . . , n.

f l(w) = hAw, wi =

n

Xi,j=1

aijwiwj.

Problem (2.7) is considered on the set on non-negative vector-functions w(t) =(cid:0)w1(t), . . . , wn(t)(cid:1),

which for each time moment t belong to the standard simples Sn, i.e.,

wk(t) = 1, wk(t) ≥ 0,

k = 1, . . . , n.

(2.8)

n

Xk=1

In analogy with the boundary and interior sets for the integral simplex we denote the boundary
bd Sn (there is at least one k such that wk(t) = 0) and the interior set int Sn (for all k = 1, . . . , n,
wk(t) > 0 for all t). The sets bd Sn and int Sn are invariant.

Remark 2.2. For each element v(x, t) ∈ Sn(Ωt) we can identify the element w(t) ∈ Sn, if we
set w(t) = v(t), where, and everywhere else in the text, the bar denotes the mean integral value
through Ω:

vk(t) =ZΩ

vk(x, t) dx,

k = 1, . . . , n,

t ≥ 0.

Due to the reasons discussed informally in Introduction we use the following

Deﬁnition 2.3. The system (2.1)–(2.3) is called permanent, if there are such ε0 > 0 and δ0 > 0
that for all components v(x, t) ∈ Sn(Ωt) of the system (2.1)–(2.3) it holds that

lim inf
t→∞

kvk(x, t)k ≥ ε0 > 0,

k = 1, . . . , n,

if the initial conditions (2.2) satisfy

kϕk(x)k ≥ δ0 > 0.

Here and below k · k denotes the norm in L2(Ω).
A number of necessary and suﬃcient conditions of permanence of (2.7) is given in [15]. The

one which we will use says that the system (2.7) is permanent if

hAw, pi − hAw, wi > 0

(2.9)

for any equilibria w ∈ bd Sn. Here p is some ﬁxed point in int Sn, i.e.,

pk = 1,

pk > 0,

k = 1, . . . , n.

n

Xk=1

8

In [8] we showed that a similar condition can be obtained for the distributed system (2.1)–(2.3).
This condition, opposite to (2.9), must be checked on all elements w ∈ bd Sn and at the same
time the following condition on the parameters dk must be true:

where dmin = mink{dk}, µ is the spectral radius of A, and λ1 is the ﬁrst nonzero eigenvalue of
the boundary value problem

λ1dmin > µ,

(2.10)

− ∆ψ(x) = λψ(x), x ∈ Ω,

= 0.

(2.11)

∂ψ

∂ν(cid:12)(cid:12)(cid:12)(cid:12)x∈Γ

In [8] we proved that if the condition (2.10) holds then all the equilibria of (2.1)–(2.3) coincide
with the equilibria of the local system (2.7), i.e., they are spatially homogeneous. Hence, the
conditions (2.9) and (2.10) provide the system permanence only if the equilibria are spatially
homogeneous. This observation implies that the analysis we presented in [8] cannot rigorously
identify the cases such that the spatial structure would stabilize the system. Therefore it is
important to consider the case when (2.10) does not hold.

Deﬁnition 2.4. We shall say that the set of parameters {di}n
(2.3) is resonant if there exists the eigenvalue λ of the problem (2.11), such that

i=1 of the distributed system (2.1)–

det(A − λD) = 0,

(2.12)

where D = diag(d1, . . . , dn).

For the following we assume that matrix A is non-negative and primitive such that the
conditions of the Frobenius-Perron theorem hold. We denote µ the dominant eigenvalue of A
to which corresponds a positive eigenvector. If D = d0I, then from (2.12) we have that the
maximal value of d0 for which (2.12) holds is

d0 =

µ
λ1

,

(2.13)

where λ1 is the smallest positive eigenvalue of (2.11).

3 Spatially inhomogeneous solutions. Solutions with bounded

support

The stationary solutions to the problem (2.1)–(2.3) satisfy the system

ui(cid:16)(Au)i − ¯f s + di∆ui(cid:17) = 0,

with the boundary conditions

i = 1, . . . , n, x ∈ Ω,

(3.1)

∂ui
∂ν

|x∈Γ = 0,

i = 1, . . . , n.

(3.2)

9

Here

¯f s =ZΩ(cid:16)hAu, ui −

n

Xi=1

dik∇uik2(cid:17) dx.

(3.3)

Together with problem (3.1)–(3.3) consider the equations for the equilibria of the local replicator
equation

Solutions to (3.4) are denoted below ˆw = ( ˆw1, . . . , ˆwn).

wi(cid:16)(Aw)i − hAw, wi(cid:17) = 0, w ∈ Sn,

i = 1, . . . , n.

(3.4)

In [8] we showed that if the the set {di}n

i=1 is not resonant then all the stationary solutions
to (2.1), (2.2) coincide with equilibria ˆw of (3.4). Here our ﬁrst goal is to show that existence of
the resonant parameters implies the existence of spatially inhomogeneous stationary solutions
of the distributed replicator system.

Xs=1

Theorem 3.1. Let the set {di} be resonant with respect to some eigenvalue λs of problem (2.11).
Then there exist nonnegative spatially inhomogeneous solutions to the system (3.1)–(3.3) of the
form

u(x) = ˆw + mcsψs(x),
where ˆw solves (3.4), m is an arbitrary constant, cs = (cs
the eigenfunction of (2.11) corresponding to λs.

1, . . . , cs

n) is a ﬁxed vector, and ψs is

(3.5)

Proof. We will look for a solution to (3.1)–(3.3) in the form

uk(x) = ˆwk + Uk(x),

k = 1, 2, . . . , n,

where

∞

Uk(x) =

ck
s ψs(x).

(3.6)

This is possible since the eigenfunctions form a complete system.

We have

(AU )k − ¯f s

U + dk∆Uk(x) = 0,

k = 1, . . . , n, x ∈ Ω,

¯f s

U =ZΩ(cid:16)hAU , U i −

n

Xi=1

dik∇Uik2(cid:17) dx,

where U = (U1, . . . , Un).

Taking the inner products in the last equality with ψs consecutively and taking into account

the orthogonality and normalization of the eigenfunctions implies

(A − λkD)ck = 0,

k = 1, 2, . . . , s, . . . .

Due to the fact that the set {di} is resonant for k = s we have that det(A − λsD) = 0, and
hence the s-th system has a nontrivial solution. Therefore we conclude that there is a stationary
solution in the form (3.5).

Without loss of generality we can take hck, cki = 1. By choosing the arbitrary constant m

such that

(min
x∈Ω

φs(x))mcs

i + ˆwi ≥ 0,

i = 1, . . . , n,

we guarantee that the found solutions are non-negative, which concludes the proof.

(cid:4)

10

In some cases the spatially heterogeneous solutions, whose existence was proved in Theorem

3.1, can be found explicitly, as the following example shows.

Example 3.2. Consider the stationary solutions of the distributed hypercycle equation in the
spatial domain Ω = (0, 1). This means that (Au)i = aiui−1, i = 1, . . . , n, u0 := un.

We have

di

d2ui
dx2 + aiui−1 − ¯f s = 0,

i = 1, . . . , n.

Let us look for the solution in the form

Then

which implies

ui(x) =

¯f s
ai+1

+ vi(x),

i = 1, . . . , n.

d2v1
dx2 +

a1
d1

vn = 0,

d2vn
dx2 +

an
dn

vn−1 = 0,

d4v1
dx4 −

a1an
d1dn

vn−1 = 0.

We can continue and ﬁnally obtain

d2nv1
dx2n + (−1)n+1Rnv1 = 0, Rn =

ai
di

.

n

Yi=1

Assume that the set {di} is resonant with respect to the ﬁrst eigenvalue λ1 = π2 of the problem
(2.11) on Ω = (0, 1). Equation (2.12) implies that the set {di} will be resonant if

We note that in the special case di = d0, i = 1, . . . , (3.7) turns into

n

Yi=1

di = Qn

i=1 ai
λn
1

.

(3.7)

d0 =

i=1 ai)1/n

.

(Qn

λ1

From (3.7) it follows that

π2 = R1/n
n .

This means that the characteristic polynomial of the diﬀerential equation has a pair of imaginary
roots ±πi. Taking into account the boundary conditions (2.2) we get

where m is a constant. Then

v1(x) = m cos πx,

0 < x < 1,

vn(x) = mπ2 d1
a1

cos πx,

v2(x) = mπ2(n−1) d2 · · · dn
a2 · · · an

cos πx.

11

Finally, from the equality for ¯f s one has

¯f s =

1
γ

,

γ =

1
ai

.

n

Xi=1

We can always choose the constant m such that the found solutions for ui(x) are nonnegative,
and hence we found spatially heterogeneous stationary solutions to the distributed hypercycle
system.

Let again λ1 be the ﬁrst nonzero eigenvalue of the eigenproblem (2.11) and D1 = diag(d1

1, . . . , d1
n)

be the corresponding set of the resonant parameters, that is we assume that

det(A − λ1D1) = 0.

Consider another set of parameters D = diag(d1, . . . , dn) such that

di = δd1
i ,

0 < δ < 1,

i = 1, . . . , n.

(3.8)

(3.9)

Now it follows from simple arguments (see Lemma 5.1) that the equality (3.8) with a new matrix
D should be true for some new λ > λ1. Since the spectrum of the problem (2.11) is discrete
then for δ close enough to 1 we get

det(A − λ1D) 6= 0.

A natural question to ask is what actually happens with the solutions to (3.1)-(3.3) in this case.
An answer is provided by the following theorem, which shows how the changes in the parameters
D yield non homogeneous stationary solutions with a bounded support.

Theorem 3.3. Let Ω = (0, 1) and let condition (3.8) hold for the resonant set D1. Then for
any D satisfying (3.9) there is such 0 < l < 1 for which there exist spatially heterogeneous
solutions to the stationary problem (3.1)–(3.3) with the support Ωl = (0, l).

Proof. The eigenvalues and eigenfunctions of (2.11) for Ωl are

λl
0 = 0,

λl

l (cid:19)2
k =(cid:18) kπ

, k = 1, 2, . . . , φl

0(x) =

1
l

, φl

k(x) =r2

l

cos

πx
l

.

Hence the eigenvalues for Ωl are greater then those for Ω and hence, due to the continuous
dependence of λl

k on l there will be 0 < l < 1 such that

det(A − λl

1D) = 0.

(3.10)

We look for the solutions to (3.1)–(3.3) in the form

vi(x) =

ˆwi
l

+ U l

i (x), U l

i (x) =

cl
sψl

s(x).

∞

Xs=1

Reasoning similarly to the proof of Theorem 3.1 we ﬁnd that for c1 = (c1

1, . . . , c1

n) we have

(A − λl

1D)c1 = 0.

12

Due to (3.10) this system has a nontrivial solution, which we can normalize as hc1, c1i = 1.

The found solutions can be represented for x ∈ Ωl as

vi(x) =

ˆwi

l (cid:16)1 + mc1

i cos

πx

l (cid:17) ,

where m is an arbitrary constant. Let m = |c1
the functions

k|−1, where |c1

k| = max{|c1

1|, . . . , |c1

n|} and consider

ˆwi

ˆwi

i
|c1

ui(x) =

uk(x) =( ˆwk

l (cid:17) , 0 < x < l,

l (cid:16)1 + c1
k| cos πx
l (cid:16)1 − c1
k|(cid:17) ,
l (cid:0)1 + cos πx
l (cid:1) , 0 < x < l,

l ≤ x ≤ 1,

l ≤ x ≤ 1.

i
|c1

0,

,

i 6= k,

(3.11)

By construction functions ui are continuous together with their derivatives at x = l, hence the
obtained solutions are in W 1,2(Ω). Moreover, supp uk = Ωl ⊂ Ω.
(cid:4)

The following example illustrates Theorem 3.3.

Example 3.4. Consider the stationary solutions to the hypercyclic system in the particular
case di = d0, ai = a0, i = 1, 2, . . . , n. Assume that

Clearly there exists 0 < l < 1 such that

d0 <

a0
π2 .

The corresponding stationary solutions with the support given by Ωl are

d0 =

a0
λl
1

,

λl

1 =(cid:16) π
l(cid:17)2

.

ui(x) =( a0

0,

nl (cid:0)1 + cos πx

l (cid:1) , 0 < x < l,

l ≤ x ≤ 1,

,

i = 1, . . . , n.

In this case

l = πr d0

a0

.

It can be directly checked that the results of Theorem 3.3 and Example 3.4 can be explicitly

generalized on some other domains in R2 or R3.

1. We can consider the square Ω = (0, 1) × (0, 1) and a rectangle Ωl1,l2 = (0, l1) × (0, l2). In

this case the corresponding stationary solutions, nonzero only on Ωl1,l2, have the form

ui(x) =( ˆwi

0,

l1l2 (cid:16)1 + cos πx1

l1 (cid:17)(cid:16)1 + cos πx2

l2 (cid:17) , 0 < x1 < l1, 0 < x2 < l2,

l1 ≤ x1 ≤ 1, l2 ≤ x2 ≤ 1.

13

2. In the case of the circle Ω = {(x1, x2) : x2

1 + x2

2 < 1} for the solutions that do not depend

on the polar angle

ui(r) =( ˆwi

π2l(cid:16)1 − c0J0(cid:16) µ1

0,

l (cid:17)(cid:17) , 0 < r < l,

l ≤ r ≤ 1.

1r

1 + x2
J1(r), c0 = (J0(µ1

Here r =px2

2, J0 is Bessel’s function of the ﬁrst kind, µ1
1))−1.

1 is the ﬁrst positive zero of

3. In the case of the sphere Ω = (x1, x2, x3) : x2

1 + x2

2 + x2

3 < 1 for the solutions that do not

depend of angular variables, we ﬁnd

3 ˆwi

4πl3 (cid:16)1 − c1q 2l

πµr sin µr

l (cid:17) , 0 < r < l,

l ≤ r ≤ 1,

0,

ui(r) =

c1 =(cid:18)r 2

πµ

where µ is the ﬁrst positive root of the equation tan r = 2r,

sin µ(cid:19)−1

,

r =qx2

1 + x2

2 + x2
3.

The list of examples can be extended. Which is more important, however, is that in the
general case we can conclude that the stationary spatially heterogeneous solutions with a sup-
port, which is a proper subset of Ω, appear if there exists a domain Ω1 ⊂ Ω with a smooth
boundary Γ1 such that the linear combination of the solutions to the eigenvalue problem (2.11)
in Ω1 allows a continuous extension into the domain Ω \ Ω1 in the case dim Ω = 1 and a smooth
extension in this domain in the case dim Ω = 2 or 3. From the variational principle (e.g., [9]) it
follows that the eigenvalues of (2.11) in Ω1 are bigger than the eigenvalues of the same problem
solved in Ω. Moreover, if the measure of Ω1 decreases the eigenvalues will grow.

We remark that using similar to Theorem 3.3 reasonings it is possible to show more, in
particular that at least some of these spatially heterogeneous solution, which existence was
proved in Theorem 3.3, are attracting. Here is an illustration by an explicit example.

Example 3.5. Consider a hypercyclic system on Ω = (0, 1) with the matrix

k 0(cid:21)
A =(cid:20)0 k

and assume that the parameters in (2.1)–(2.3) are

d1 = d2 = d =

k

(2π)2 .

This means that the parameters are resonant with the second nonzero eigenvalue of (2.11). Let
us look for a solution in the form

vi(x, t) =(gi(t)(1 + cos 2πx),

0,

0 < x < 1/2,
1/2 ≤ x < 2,

(3.12)

14

i = 1, 2. In this case

f s(t) =

From the condition (2.5) it follows that

k

2(cid:16)3g1(t)g2(t) −

1

2(cid:0)g2

1(t) + g2

2(t)(cid:1)(cid:17).

On integrating the system of the equations through Ω and taking into account (3.12), we obtain
the ODE system

g1(t) + g2(t) = 2.

(3.13)

Using (3.13) yields

and hence

therefore

˙g1 =

˙g2 =

k

k

2 (cid:0)g2
2 (cid:0)g2

2 − g2

1 − g2

1(cid:1) ,
2(cid:1) .

˙gi = 2k(1 − gi),

gi(t) = 1 + (gi(0) − 1)e−2kt,

gi(t) → 1,

i = 1, 2, t → ∞,

and therefore all the solutions of this particular form will tend to the equilibrium solution with
a bounded support, namely

lim
t→∞

vi(x, t) = ui(x) =(1 + cos 2πx, 0 < x < 1/2,

1/2 ≤ x < 2.

0,

4 Suﬃcient conditions for permanence

One of the possible suﬃcient conditions for the ODE replicator equation (2.7) to be permanent
takes the following form. If there exists a p ∈ int Sn such that

hp, Awi > hAw, wi

(4.1)

for all equilibria w ∈ bd Sn then system (2.7) is permanent. From Remark 2.2 it follows that we
can identify any function v(x, t) ∈ Sn(Ω) with an element w(t) ∈ Sn, by having w(t) = v(t),
and the same is true for the elements on bd Sn(Ω). Therefore one can expect that an analogous
to (4.1) condition for the distributed replicator system may look

hp, Awi > hAw, wi, w(t) = v(t) ∈ bd Sn, p ∈ int Sn.

(4.2)

This is indeed true, however, we will show that system (2.1)–(2.3) can be permanent even in a
situation when the condition (4.2) does not hold.

First we formulate and prove an auxiliary lemma.

15

Lemma 4.1. Let the set of parameters {dk} of system (2.1)–(2.3) be resonant with respect to
the ﬁrst nonzero eigenvalue of (2.11) in Ω. If there exist spatially nonhomogeneous solutions to
(2.1)–(2.3)

vk(x, t) = wk(t) + Vk(x, t), wk(t) =ZΩ1

vk(x, t) dx,

k = 1, . . . , n,

(4.3)

with the support in Ω1 ⊂ Ω, with the measure S1, such that at least one spatially nonhomogeneous
component (with the index K0) of the solution satisﬁes

kVK0k ≥ δ0 > 0,

(4.4)

(4.5)

then

Φ(V ) =ZΩ1(cid:16)hAV , V i −

n

Xi=1

dik∇Vik2(cid:17) dx ≤ −δ2

0q1(S1),

where q1(S1) is a positive quantity that can only increase if the measure S1 decreases.

Proof. First of all we note that the values of the inner product hAV , V i are determined by the
symmetric part of A. Indeed, consider

A =

1
2

(A + A⊤) +

1
2

(A − A⊤) = A+ + A−,

where A+ is symmetric and A− is skew-symmetric. Then, since hA−V , V i = 0,

hAV , V i = hA+V , V i.

Consider the eigenvalue problem (2.11) in Ω1 and denote the eigenfunctions and eigenvalues
i (x)}∞
i=0 respectively. From the completeness of the system of eigenfunctions it

{ψ1
follows that any solution can be represented as in (4.3), moreover

i=0 and {λ1

i }∞

Vk(x, t) =

j (t)ψ1
ck

j (x),

∞

Xj=1

Vk(x, t) dx = 0,

k = 1, . . . , n.

ZΩ1

and

Let us use the equality

ZΩ1

k∇Vkk2 dx = −ZΩ1

h∆Vk, Vki dx =

∞

Xj=1

Then

∞

λ1
j ck

j (t)cs

j(t).

Φ(V ) =

h(A+ − λ1

j D)cj(t), cj(t)i,

Xj=1

16

(4.6)

(4.7)

(4.8)

j , . . . , cn

j (t)). Since Ω1 ⊂ Ω then λ1

where cj(t) = (c1
of (2.11) in Ω. From Lemma 5.2 it follows that all the eigenvalues of A+ − λ1
and hence

j > λ1 where λ1 is the ﬁrst nonzero eigenvalue
j D will be negative

h(A+ − λ1

j D)cj(t), cj(t)i ≤ qj(S1)kcj(t)k2,

j = 1, 2, . . . .

Here kcj(t)k2 =Pn

k=1(cid:16)ck

j (t)(cid:17)2

, and qj(S1) are positive quantities such that

q1(S1) ≤ q2(S1) ≤ . . . .

(4.9)

Note that q1(S1) may only increase if the measure S1 of Ω1 decreases.

Now we use the condition (4.4) that implies that

kcj(t)k2 ≥

∞

Xj=1

∞

Xj=1

(cK0

j )2 = kVK0(x, t)k2 ≥ δ2
0.

As a result, using (4.9) and (4.8), we obtain (4.5).

Theorem 4.2. Let the conditions of Lemma 4.1 hold and assume that

min

w∈bd Sn

{hp, Awi − hAw, wi} = −m < 0

(cid:4)

(4.10)

for any p ∈ int Sn. Then system (2.1)–(2.3) is permanent if the measure S1 of Ω1 is suﬃciently
small.

Proof. Consider the functional

F (v) = exp Xk

pk log vk(x, t)! , p ∈ int Sn,

(4.11)

deﬁned on the solutions to (2.1)–(2.3) with the support in Ω1 and nonzero initial conditions

vk(x, 0) = ϕ(x) > 0, x ∈ Ω1,

k = 1, . . . , n.

In (4.11)

Then

log vk(x, t) =ZΩ1
F (v)|t=0 = exp Xk

log vk(x, t) dx.

pk log ϕk(x)! = F0 > 0.

(4.12)

If there exists at least one solution vk(x, t) → 0 as t → ∞ then F (v) → 0. On the other hand,
from (4.11) and the equations of system (2.1) it follows

dF (v)

dt

= F (v)ZΩ1(cid:16)hAv, pi − hA+v, vi +X dkk∇vkk2(cid:17) dx.

(4.13)

17

Using the representation (4.3), taking into account (4.6) and (4.7), we get for (4.13)

dF (v)

dt

where Φ(V ) is given by (4.5).

= F (v)(cid:16)hAw, pi − hAw, wi − Φ(V )(cid:17),

Using (4.10) and inequality (4.5) we ﬁnd

If S1 is small enough then

dF (v)

dt

≥ F (v)(−m + δ2

0q1(S1)).

q1(S1) ≥

m
δ2
0

,

hence F (v) ≥ F0 > 0 for any t > 0, which proves the system permanence.

(4.14)

(cid:4)

5 Appendix

In the main text we use several facts about the eigenvalues of nonnegative matrices that we
prove here.

Lemma 5.1. Let A be a nonnegative square matrix, for which the conditions of the Perron–
Frobenius theorem hold. Let D1 and D2 be two diagonal matrices such that 0 < d(1)
for
all j. Then there exist positive λ1 and λ2 such that

j < d(2)

j

det(A − λ1D1) = det(A − λ2D2) = 0,

and in particular

Proof. Matrices B1 = AD−1
satisfy the Perron–Frobenius theorem and
1
clearly B1 < B2. We need to show that the spectral radius λ(B1) of B1 is less than λ(B2).
But this follows from the inequality with a positive x

λ1 > λ2.
and B2 = AD−1
2

B2x = B1x + (B2 − B1)x > λ(B1) + εx

and the general fact that Ax < βx implies λ(A) < β (e.g., [17]).

(cid:4)

Lemma 5.2. Let D be a diagonal matrix with positive elements on the main diagonal, and let
A be a square non-negative matrix for which the Perron–Frobenius theorem holds. If λ0 is the
dominant eigenvalue of AD−1 then the eigenvalues of the matrix

with λ > λ0 have negative real parts.

A − λD

In this case the
Proof. The proof is straightforward in the case when D = diag(d0, . . . , d0).
dominant eigenvalue µ of A is related to d0 as µ = λ0d0. Hence if λ > λ0 then µ − λd0 < 0
and all the eigenvalues of A − λD will have negative real parts. In the general case the same
reasonings are used for the matrix AD−1.
(cid:4)

18

Acknowledgements: ASB and VPP are supported in part by the Russian Foundation for
Basic Research grant #13-01-00779.

References

[1] D. G. Aronson. The porous medium equation. In Nonlinear diﬀusion problems, pages 1–46.

Springer, 1986.

[2] G. I. Barenblatt, V. M. Entov, and V. M. Ryzhik. Theory of ﬂuid ﬂows through natural

rocks. Kluwer Academic Publishers, 1989.

[3] M. Bertsch, R. Dal Passo, and M. Ughi. Discontinuous viscosity solutions of a degenerate
parabolic equation. Transactions of the American Mathematical Society, 320(2):779–798,
1990.

[4] A. S. Bratus, C.-K. Hu, M. V. Safro, and A. S. Novozhilov. On diﬀusive stability of eigens

quasispecies model. Journal of Dynamical and Control Systems, 22(1):1–14, 2016.

[5] A. S. Bratus and V. P. Posvyanskii. Stationary solutions in a closed distributed Eigen–

Schuster evolution system. Diﬀerential Equations, 42(12):1762–1774, 2006.

[6] A. S. Bratus, V. P. Posvyanskii, and A. S. Novozhilov. Existence and stability of sta-
tionary solutions to spatially extended autocatalytic and hypercyclic systems under global
regulation and with nonlinear growth rates. Nonlinear Analysis: Real World Applications,
11:1897–1917, 2010.

[7] A. S. Bratus, V. P. Posvyanskii, and A. S. Novozhilov. A note on the replicator equation with
explicit space and global regulation. Mathematical Biosciences and Engineering, 8(3):659–
676, 2011.

[8] A. S. Bratus, V. P. Posvyanskii, and Novozhilov A. S. Replicator equations and space.

Mathematical Modelling of Natural Phenomena, 9(3):47–67, 2014.

[9] R. S. Cantrell and C. Cosner. Spatial ecology via reaction-diﬀusion equations. Wiley, 2003.

[10] R. Cressman and A. T. Dash. Density dependence and evolutionary stable strategies.

Journal of Theoretical Biology, 126(4):393–406, 1987.

[11] R. Cressman and G. T. Vickers. Spatial and Density Eﬀects in Evolutionary Game Theory.

Journal of Theoretical Biology, 184(4):359–369, 1997.

[12] R. Dal Passo and S. Luckhaus. A degenerate diﬀusion problem not in divergence form.

Journal of diﬀerential equations, 69(1):1–14, 1987.

[13] U. Dieckmann, R. Law, and J. A. J. Metz. The Geometry of Ecological Interactions:

Simplifying Spatial Complexity. Cambridge University Press, 2000.

[14] L. C. Evans. Partial Diﬀerential Equations. American Mathematical Society, 2nd edition,

2010.

19

[15] J. Hofbauer and K. Sigmund. Evolutionary Games and Population Dynamics. Cambridge

University Press, 1998.

[16] J. Hofbauer and K. Sigmund. Evolutionary game dynamics. Bulletin of American Mathe-

matical Society, 40(4):479–519, 2003.

[17] R. A. Horn and C. R. Johnson. Matrix analysis. Cambridge university press, 2012.

[18] V. C. L. Hutson and G. T. Vickers. Travelling waves and dominance of ESS’s. Journal of

Mathematical Biology, 30(5):457–471, 1992.

[19] V. C. L. Hutson and G. T. Vickers. The Spatial Struggle of Tit-For-Tat and Defect. Philo-
sophical Transactions of the Royal Society. Series B: Biological Sciences, 348(1326):393–
404, 1995.

[20] P. Knabner and L. Angerman. Numerical methods for elliptic and parabolic partial diﬀer-

ential equations, volume 44. Springer, 2003.

[21] R. C. Lewontin. The meaning of stability. In Brookhaven symposia in biology, volume 22,

pages 13–24, 1969.

[22] E. Lieberman, C. Hauert, and M. .A Nowak. Evolutionary dynamics on graphs. Nature,

433(7023):312–316, 2005.

[23] A. S. Novozhilov, V. P. Posvyanskii, and A. S. Bratus. On the reaction–diﬀusion replicator
systems: spatial patterns and asymptotic behaviour. Russian Journal of Numerical Analysis
and Mathematical Modelling, 26(6):555–564, 2012.

[24] E. B. Postnikov and I. M. Sokolov. Continuum description of a contact infection spread in

a sir model. Mathematical biosciences, 208(1):205–215, 2007.

[25] S. J. Schreiber and T. P. Killingback. Spatial heterogeneity promotes coexistence of rock–

paper–scissors metacommunities. Theoretical population biology, 86:1–11, 2013.

[26] P. Schuster and K. Sigmund. Replicator dynamics. Journal of Theoretical Biology, 100:533–

538, 1983.

[27] H. L. Smith and H. R. Thieme. Dynamical systems and population persistence, volume 118
of Graduate Studies in Mathematics. American Mathematical Society Providence, RI, 2011.

[28] N. Vaidya, M. L. Manapat, I. A. Chen, R. Xulvi-Brunet, E. J. Hayden, and N. Lehman.
Spontaneous network formation among cooperative rna replicators. Nature, 491(7422):72–
77, 2012.

[29] G. T. Vickers. Spatial patterns and ESS’s. Journal of Theoretical Biology, 140(1):129–35,

1989.

[30] G. T. Vickers. Spatial patterns and travelling waves in population genetics. Journal of

Theoretical Biology, 150(3):329–337, Jun 1991.

20

[31] E. D. Weinberger. Spatial stability analysis of Eigen’s quasispecies model and the less than
ﬁve membered hypercycle under global population regulation. Bulletin of Mathematical
Biology, 53(4):623–638, 1991.

21

