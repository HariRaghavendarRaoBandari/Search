A Semi-Markov Algorithm for Continuous Time Random Walk Limit Distributions

6
1
0
2

 
r
a

 

M
1
1

 
 
]
h
c
e
m

-
t
a
t
s
.
t
a
m
-
d
n
o
c
[
 
 

1
v
2
1
5
3
0

.

3
0
6
1
:
v
i
X
r
a

G. Gilla, P. Straka a 1

a School of Mathematics & Statistics, UNSW Australia

Abstract. The Semi-Markov property of Continuous Time Random Walks (CTRWs) and their
limit processes is utilized, and the probability distributions of the bivariate Markov process (X(t), V (t))
are calculated: X(t) is a CTRW limit and V (t) a process tracking the age, i.e. the time since the
last jump. For a given CTRW limit process X(t), a sequence of discrete CTRWs in discrete time
is given which converges to X(t) (weakly in the Skorokhod topology). Master equations for the
discrete CTRWs are implemented numerically, thus approximating the distribution of X(t). A
consequence of the derived algorithm is that any distribution of initial age can be assumed as an
initial condition for the CTRW limit dynamics. Four examples with different temporal scaling
are discussed: subdiffusion, tempered subdiffusion, the fractal mobile/immobile model and the
tempered fractal mobile/immobile model.

Key words: anomalous diffusion, fractional kinetics, Semi-Markov, fractional derivative
AMS subject classiﬁcation: 60F17, 60G22

1.

Introduction

Subdiffusion is now a well-studied theoretical phenomenon in statistical physics, motivated by
experimental ﬁndings in many different ﬁelds, most prominently biophysics [1, 2, 3, 4, 5, 6]. The
Continuous Time Random Walk (CTRW) has been a particularly successful model for subdiffusion
[1, 7], due to both its tractability and ﬂexibility: i) Probability densities can be computed via the
fractional Fokker-Planck equation [8, 9]; ii) Reaction-subdiffusion equations can be derived from
CTRW dynamics [10, 11] iii) Nonlinear dynamics may be incorporated into CTRWs [12, 13]; iv)
CTRWs, via subordination, can model a variety of scaling behaviours and cross-overs between
scales (See [14, 15] and Section 6 in this article); and v) Via a coupling between jumps and waiting
times, an even greater variety of CTRW processes can be modeled [16, 17], with applications to

1Corresponding author. E-mail: p.straka@unsw.edu.au

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Figure 1: Sample paths of the age process V (t), which renders the CTRW limit X(t) Markovian.

L´evy Walks [18] and relaxation phenomena [19].

CTRWs and their scaling limits, however, do not possess the Markov property, but are in fact
Semi-Markov processes [20]. This means that the calculation of the joint distribution at multi-
ple times (termed “ﬁnite-dimensional distributions” in stochastic process theory) is problematic,
though signiﬁcant progress has been made [21, 22, 23].

In this article, we utilise the Semi-Markov property of scaling limits of CTRWs, and thus
derive a computational algorithm for the calculation of the probability distributions of CTRW limit
processes. Our approach uses the purely Markovian dynamics of (X(t), V (t)), where X(t) is a
CTRW limit process and V (t) the process which tracks the time which has passed since the last
jump. This process has saw teeth sample paths (Figure 1, also see [22]) and is well-known from
renewal theory as the “age” or “backward recurrence time.” Here, we shall refer to V (t) as the
“age” or “residence time.”

The main conceptual difﬁculty with the Semi-Markov property of CTRW limits is that if
V (t) = 0, then in general we also have V (t(cid:48)) = 0 for inﬁnitely many t(cid:48) in any interval (t, t + ε). A
careful analysis of the limiting sample paths is necessary to properly deﬁne V (t) and to establish
the Markov property [20]. It is seemingly necessary to utilize jump processes with inﬁnite L´evy
measures to deﬁne the joint process (X(t), V (t)). The procedure that we use to approximate these
is similar to the approximation of L´evy processes by compound Poisson processes (see e.g. Section
3.4 in [24]). We walk the reader through the main technical steps in Sections 2-4.

2

0.00.20.40.60.81.00.00.20.4tV(t)G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Our algorithm (Section 5) computes the probability densities of (X(t), V (t)), and by the
Markov property and the Chapman-Kolmogorov equations, joint distribution of this process at
multiple times t1, . . . , tk can be calculated. By taking marginal distributions, one thus arrives at
the joint distribution of X(t) at multiple times.

Another important application of our algorithm in the fact that any age distribution may be
taken as an initial condition. This is an important generalization to the Fractional-Fokker-Planck
equation, which implicitly assumes that the initial age of every particle equals 0. For instance,
taking a snapshot of a cell in which protein molecules are undergoing (tempered) subdiffusion,
there is no reason to believe that the time of the snapshot marks the beginning of a waiting time
for each protein molecule. We deem it more likely that an “equilibrium” initial condition for the
molecule residence times is more appropriate (Section 6).

2. CTRWs as random walks in space-time

In this section we set up the theory for scaling limits of CTRWs. Space and time need to be jointly
rescaled in order to arrive at a meaningful limit, in much the same fashion as Brownian motion is
the scaling limit of random walks. Which scaling functions are appropriate will depend on the tail
behaviour of the waiting time and jump distributions. For simplicity, we will later assume nearest
neighbour jumps, and focus on what scaling limits are appropriate for the waiting times, but the
derivation in this Section is held as general as possible, which is of independent interest, and causes
no extra difﬁculty.

The key property of CTRWs, which makes much of their analysis a great deal easier compared
to e.g. fractional Brownian motion, is the renewal property: Every time a walker jumps, its entire
future trajectory becomes independent of its past. The next jump time and the next position thus
only depend on the current time and position; in other words, position and jump time constitute
a Markov chain in space-time Rd+1. The probability distribution of this Markov chain is then
uniquely determined by i) its starting point in space-time and ii) a jump kernel K(dz, dw|x, s)
expressing the probability that conditional on a CTRW arriving at x at time s, its next jump happens
at time s + w and is of size z. It satisﬁes that

1. B × C (cid:55)→ K(B × C|x, s) is a probability measure on Rd × (0,∞) for every (x, s) ∈ Rd+1
2. (x, s) (cid:55)→ K(B × C|x, s) is measurable for any (Borel) B × C ⊂ Rd+1.

For example, to deﬁne a subdiffusive random walk with subdiffusive coefﬁcient 0 < β < 1 in
a space- and time-dependent external force ﬁeld b(x, t), deﬁne the transition probability kernel via

K(B × (w,∞)|x, s) = (1 ∧ w−β)N (B|b(x, s + w), σ2), B ⊂ Rd, w > 0,

where ∧ stands for “minimum” and N (dz|µ, σ2) denotes a Gaußian probability distribution on R
with mean µ and variance σ2. Note that the jump, occurring at time s + w, is biased by the external
force b(x, t), which is accordingly evaluated at the time s + w.

3

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

The above Markov chain deﬁnes a sequence of random points in space-time (x, s) = (A0, D0),
(A1, D1), (A2, D2), . . . from which the CTRW trajectory (X(t))t≥s can be uniquely reconstructed:
If Dk ≤ t < Dk+1, then X(t) = Ak. To avoid confusion, we stress that there are two different
notions of “time”: CTRW jumps occur in physical time (which we denote by t), at epochs given
by Dk, n ∈ N. The jumps of the space-time Markov chain (Ak, Dk)k∈N0 occur at the integer times
k ∈ N, which corresponds to the count of CTRW jumps. In the scaling limit below, this count
becomes continuous, and we dub it the auxiliary time (usually writing r).

We identify a CTRW with its underlying space-time Markov chain. We then give conditions for
a sequence of such Markov chains to converge to a continuum “jump-diffusion” process, whose
state space is Rd+1 (Theorem 1). This convergence holds on the stochastic process level, in the
sense of weak convergence of probability measures on the Skorokhod space of trajectories. Tra-
jectories of this jump-diffusion then again map uniquely to trajectories of CTRW limit processes
(Theorem 5).
Theorem 1. For every n ∈ N, let (An, Dn) = {(An
k )}k∈N0 be a Markov chain on the state
space Rd+1 with starting point (x0, s0) and a transition kernel K n as described above. Assume
that

k , Dn

zizjK n(dz, dw|x, s) = aij(x, s), 1 ≤ i, j ≤ d

(cid:90)

(cid:90)

g(z, w)K n(dz, dw|x, s) =

g(z, w)Π(dz, dw|x, s)

z∈Rd

0≤w

z∈Rd

0≤w

where aij, bi and c are real-valued bounded continuous functions, z = (z1, . . . , zd), Π(· ×
·|x, s) is a L´evy measure (see remark below) for every (x, s) ∈ Rd+1 and g is varying over
all real-valued bounded continuous functions which vanish in a neighborhood of the origin
(0, 0).

2. The operator A given by

(cid:90)

(cid:90)

Af (x, s) = bi(x, s)∂xif (x, s) + γ(x, s)∂sf (x, s) +

(cid:2)f (x + z, s + w) − f (x, s) − zi1((cid:107)z(cid:107) < 1)∂xif (x, s)(cid:3) Π(dz, dw|x, s)

aij(x, s)∂xi∂xj f (x, s)

1
2

+

(2.5)

z∈Rd

w≥0

4

ziK n(dz, dw|x, s) = bi(x, s), 1 ≤ i ≤ d

wK n(dz, dw|x, s) = c(x, s)

1.

lim
ε↓0

lim
ε↓0

lim
n→∞ n

lim
n→∞ n

(cid:90)
(cid:90)

(cid:90)
(cid:90)

(cid:107)z(cid:107)<ε

0≤w<ε

(cid:107)z(cid:107)<ε

0≤w<ε

(cid:90)
(cid:90)

(cid:90)

(cid:90)

lim
ε↓0

lim
n→∞ n

(cid:107)z(cid:107)<ε

0≤w<ε

lim
n→∞ n

(2.1)

(2.2)

(2.3)

(2.4)

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

generates a Feller semigroup of transition probabilities2 (Tr)r≥0 on C0(Rd+1) (the space of
real-valued continuous functions which vanish at ∞).

3. {L(r)}r≥0 is an independent Poisson process with unit intensity.

(cid:110)(cid:16)

(cid:17)(cid:111)

Then the sequence of processes
converges weakly (with respect to the Sko-
rokhod J1 topology) to the Rd+1-valued diffusion process with jumps {(A(r), D(r))}r≥0 starting
at (x0, s0) and governed by the Feller semigroup (Tr)r≥0.

L(nr), Dn

r≥0

An

L(nr)

A proof is given in the appendix.

Remark 2. A sufﬁcient condition for (2.5) to be the generator of a Feller semigroup is that the
coefﬁcients aij(x, s), bi(x, s), c(x, s) and Π(·|x, s) satisfy certain growth and Lipschitz conditions
[25, Ch 6]. In this case there exist unique solutions to stochastic differential equations whose
semigroup is (Tr)r≥0.
Remark 3. That Π(·|x, s) is a L´evy measure for every (x, s) ∈ Rd+1 means that it is supported on

Rd+1 \ {(0, 0)} and satisﬁes(cid:90)

(cid:90)

z∈Rd

w≥0

(cid:0)1 ∧ (cid:107)(z, w)(cid:107)2(cid:1) Π(dz, dw|x, s) < ∞.

Since all measures K n(·|x, s) are supported on Rd×(0,∞) (i.e. waiting times are strictly positive)
it follows that Π(·|x, s) is in fact supported on Rd × [0,∞) \ {(0, 0)}. Readers familiar with L´evy
processes will recognize that the requirement that the limiting process D(t) be strictly increasing

a.s. in fact entails that (cid:90)

(cid:90)

z∈Rd

w≥0

(cid:0)1 ∧ ((cid:107)z(cid:107)2 + w)(cid:1) Π(dz, dw|x, s) < ∞.

Example 4. Deﬁne the kernels K n via
w−β

K n(B × (w,∞)|x, s) =

1 ∧

(cid:18)

(cid:19)

N (B|b(x, s + w)/n, σ2/n · I), B ⊂ Rd, w > 0,

nΓ(1 − β)

where Γ is the Gamma-function, 0 < β < 1, b(x, s) is vector valued and I the d × d unit matrix.
As discussed further above, each kernel K n governs a CTRW process, which is subdiffusive with
coefﬁcient β, meaning that waiting times have the power-law distribution

P(Dn

k+1 − Dn

k > w) = 1 ∧

w−β

nΓ(1 − β)

.

operates on continuous functions vanishing at ∞, via Trf (x, s) =(cid:82)(cid:82) f (y, t)Tr(dy, dt|x, s). The semigroup property

2Tr(dy, dt|x, s) denotes the probability that A(r) ∈ dy and D(r) ∈ dt given A(0) = x, D(0) = s. It thus

reads TrTr(cid:48)f = Tr+r(cid:48)f, and is equivalent to the Chapman-Kolmogorov equations for Markov processes. The Feller
property is a technical condition, see e.g. [25].

5

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Jumps are biased according to the external force b(x, t), which is evaluated at the time of a jump.
It can be checked that the four limit statements from Theorem 1 are satisﬁed with bi(x, s) as given,
aij(x, s) = σ2δij (Kronecker-delta), c(x, s) = 0 and Π(dz, dw|x, s) = δ0(dz)w−1−β dw/Γ(1 − β)
(Here δ0 denotes the Dirac measure concentrated at 0 ∈ Rd).
The continuum process {(A(r), D(r))}r≥0 is then such that D(r) is a β-stable subordinator,
i.e. a L´evy process with non-decreasing sample paths [26]. Since Π in fact puts inﬁnite measure
on the positive real line, D(r) is in fact strictly increasing. and A(r) is a diffusion process with
constant diffusivity σ2 · I and drift given by b(A(r), D(r)) dr. Its representation as a stochastic
differential equation is

dA(r) = b(A(r−), D(r−)) dr + σ2 dW (r)

where W (r) is d-dimensional standard Brownian motion.

3. The Semi-Markov property

We have seen that from the sequence (An
k )k∈N0 the trajectory of a CTRW X n(t) can be
uniquely reconstructed. The Rd-valued CTRW X n(t) is not a Markov process, but the Rd+1-
valued process (X n(t), V n(t)) is; Here, V n(t) is the “residence time” of a CTRW (i.e. the time
which has passed since its last jump), deﬁned as

k , Dn

V n(t) = t − Dn

k , where k is such that Dn

k ≤ t < Dn

k+1.

To see the Markov property, note that for any τ > 0,

E[f (X(t + τ ), V (t + τ ))|(Xs, Vs) : s ≤ t] = E[f (X(t + τ ), V (t + τ ))|(Xs, Vs) : s ∈ [Dn
k , t]]
= E[f (X(t + τ ), V (t + τ ))|(Xs, Vs) : s ∈ [t − V (t), t]] = E[f (X(t + τ ), V (t + τ ))|(Xt, Vt)],

where the ﬁrst equality follows from the renewal property of the CTRW, and the last equality from
X(s) = X(t) and V (s) = V (t) + s − t on s ∈ [t − V (t), t].

The following theorem shows that if the convergence

(cid:8)(cid:0)An

(cid:1)(cid:9)

L(nr), Dn

L(nr)

J1→ {(A(r), D(r))}r≥0

r≥0

of the space-time valued processes holds as in Theorem 1, then the CTRWs & residence time
processes {(X n(t), V n(t))}t≥0 also converge.
Theorem 5. Let K n be a sequence of transition kernels on Rd+1, (x0, s0) a starting point, X n(t)
the corresponding sequence of CTRWs, and V n(t) the sequence of residence time processes. If
assumptions 1. and 2. of Theorem 1 hold and if the process D(r) has a.s. strictly increasing sam-
ple paths, then the process sequence {(X n(t), V n(t))}t≥s0 converges weakly (with respect to the

6

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Skorokhod J1 topology). The limiting Rd+1 valued process {(X(t), V (t))}t≥s0 has sample paths
which are right-continuous with existing left-hand limits, and is given by

X(t) = lim
ε↓0
V (t) = lim
ε↓0

ξ(t + ε),

η(t + ε),

ξ(t) := lim
ε↓0
η(t) := t − lim
ε↓0

A(E(t) − ε)

D(E(t) − ε)

where {(A(r), D(r))}r≥0 is as in Theorem 1 and

E(t) := inf{r ≥ 0 : D(r) > t}.

A proof is given in the appendix.

Remark 6. The limiting process from Theorem 5 has the intuitive shorthand representation

X(t) = (A− ◦ E)+(t),

V (t) = t − (D− ◦ E)+(t),

t ≥ s0

where ◦ is the composition of trajectories and a minus / plus sign in the subscript denotes the
left-continuous / right-continuous version of a trajectory.

The special case where D(r) is a strictly increasing L´evy process (i.i.d. increments) the process
E(t) has continuous sample paths and is called the inverse subordinator (see e.g. [27]). In the often
discussed model of subdiffusion with space- and time-dependent forcing [16], A(r) is a diffusion
process, with drift evaluated at the times D(r) [28]. The time-change of A(r) by r = E(t) is
called subordination. Theorem 5 above, however, holds in the general situation, where jumps of
a walker may be coupled with (i.e. are not independent of) the waiting times in the limit as n →
∞. In Example 4, there is a dependence of the jumps on the preceding waiting time w, through
b(x, s + w). If the external force b(x, s) is evaluated at the beginning of a waiting time, another
type of dependence arises, which results in different sample paths [29]; In the limit n → ∞,
however, this dependence vanishes. Jumps and waiting times remain coupled in the limit if and
only if Π(B|x, s) > 0 for some (x, s) ∈ Rd+1, where B := {(z, w) ∈ Rd+1 : z (cid:54)= 0, w > 0},
but this is not the case in Example 4. The case where π(B|x, s) = 0 for all (x, s) is called the
uncoupled case.
Remark 7. In the uncoupled case, the CTRW limit has the simpler representation

X(t) = A(E(t)),

t ≥ s0.

(see [16]).
Example 8. The sequence X n(t) of subdiffusive CTRWs from Example 4 thus converges to the
process X(t) = (A− ◦ E)+(t), and according to Remark 7 X(t) = A(E(t)). The probability
densities of X(t), if they exist, solve the fractional Fokker-Planck equation

p(x, t) = L ∂1−β
where the Fokker-Planck operator is given by

∂
∂t

∂t1−β p(x, t),

p(x, 0) = p0(x),

Lf (x, t) = σ2∆xxf (x, t) − ∇x[b(x, t)f (x, t)],

(compare [8, 30, 31]). Note that since 0 is the start of a waiting time for all particles, the initial
condition assumes that all particles have age 0, i.e. that P(V0 = 0) = 1.

7

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

4. Discrete Semi-Markov Processes

Theorems 1 and 5 provide limit theorems which are applicable to a large class of CTRW limits, and
show that the Markov property holds for CTRWs as well as for their limit processes. In this section,
we assume that a CTRW limit process X(t) is given, and construct a sequence of discrete CTRWs
X n(t) which converges to X(t). Any member X n(t) assumes values on a discrete spatial lattice, in
a fashion similar to [29]. Rather than integrating into the history of X n(t), however, our goal here
is to implement the Markovian dynamics of (X n(t), V n(t)), and thus to become able to directly
incorporate distributions of residence times into the initial condition. With discrete Markovian
dynamics, the master equations for the evolution of probability functions of (X n(t), V n(t) can
then be straightforwardly implemented, see the next section.

Simplifying Assumptions. Recall that according to Theorem 1, a CTRW limit process is char-
acterized by the coefﬁcient functions aij(x, s), bi(x, t), c(x, t) and the space-time L´evy kernel
Π(dz, dw|x, t). For simplicity, we narrow down the class of CTRW limits that we consider in the
remainder of this article. We assume only nearest neighbor jumps on the spatial lattice, which en-
tails that the L´evy measures have the representation Π(dz, dw|x, t) = δ0(dz)ψ(dw|x, t) for some
measures ψ on (0,∞), and the dynamics are uncoupled. We further assume that ψ(dw|x, t) =
ψ(dw), i.e. waiting times are homogeneous. To avoid speaking of degenerate CTRW limits,
we assume that the measure ψ(dw) is inﬁnite (i.e. has a strong singularity at 0, even though
ψ({0}) = 0)3. Finally, we focus on the one-dimensional case and assume that c(x, s) ≡ c and
a(x, s) ≡ a are constant.

to limw↓0 Ψ(w) = ∞, and the L´evy measure property to(cid:82) 1

Instead of working with the measure ψ(dw), it is more convenient in our setting to analyse the
(right-continuous) tail function Ψ(w) := ψ((w,∞)) instead. Then inﬁniteness of ψ(dw) translates
0 Ψ(w) dw < ∞, as can be seen by
integration by parts. The typical example to have in mind is Ψ(w) = w−β/Γ(1− β) for β ∈ (0, 1),
and ψ(dw) = βw−1−β/Γ(1 − β) dw (subdiffusion). To arrive at a computational algorithm for
t ), we need to give a sequence of transition kernels
the master equations for the laws of (X n
K n(dz, dw|x, s) which are supported on a lattice, and which satisfy (2.1)–(2.4). With this in mind,
we deﬁne

t , V n

H n(w) := 1 ∧ Ψ((cid:100)w/τ(cid:101) τ − τ2)

n

(4.1)
where the ceiling function is deﬁned as (cid:100)x(cid:101) := min{k ∈ Z : k ≥ x}. This H n(w) is the tail
function of a probability measure supported on the lattice τN = {τ, 2τ, 3τ, . . .}. The constants τ
and τ2 depend on n and are deﬁned as follows:

, w > 0,

τ1(n) := Ψ−1(n),

τ2(n) := c/n,

τ (n) := τ1(n) + τ2(n),

c ≥ 0.

3Indeed, if ψ(dw) is a ﬁnite measure, then the process D(r) is a step process, and hence the limiting CTRW is

again a CTRW.

8

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Since H n(w) is decreasing and bounded, it is of ﬁnite variation, and one can deﬁne the Lebesgue-
Stieltjes measure dH n via dH n((a, b]) = H n(b) − H n(a). Note however, that since H n(w) is
decreasing, this measure is negative. Since H n(w) is piecewise constant, with jumps in the set
τN, −dH n is a discrete probability measure. Finally, deﬁne a sequence of CTRW processes X n(t)
(and their residence time processes V n(t)) via their transition kernel:
K n(dz, dw|x, s) := −dH n(w) [(cid:96)(x, s + w)δ−χ(dz) + r(x, s + w)δχ(dz)]

(cid:96)(x, s) := (1 − χb(x, s)/a)/2,

r(x, s) := (1 + χb(x, s)/a)/2, χ2 = a/n.

(4.2)

The probabilities r(x, s) and (cid:96)(x, s) to jump right/left need of course to be positive, which is
satisﬁed for small enough χ. Given a starting point x0 on the lattice χZ = {kχ : k ∈ Z}, the
CTRW X n(t) will remain on this lattice at all times. Moreover, if the starting time is chosen from
the lattice τN, then all jump times will also lie on this lattice.
The following Lemma will show that K n(dz, dw|x, s) satisﬁes requirements (2.2) and (2.4):

Lemma 9. Let Ψ(w) and H n(w) be as above. Then the following two equalities hold:

(cid:90)

(cid:90)

lim
ε↓0

lim
n→∞ n

(0,ε]

lim
n→∞ n

(0,∞)

w dH n(w) = −c,

(cid:90)

(0,∞)

g(w) dH n(w) =

g(w) dΨ(w),

where g ranges over all real-valued differentiable functions with compact support in (0,∞).

A proof is given in the appendix. The following result may be interpreted as the consistency of

our discrete Semi-Markov scheme:

Theorem 10. Let the simplifying assumptions as set out above hold, and consider the sequence
of discrete CTRWs X n(t) with residence time processes V n(t), for n ∈ N, deﬁned via the kernels
(4.2) and starting point x0 at time 0. Then (X n(t), V n(t)) converges4 to the process (X(t), V (t))
as given in Theorem 5. That is, X(t) = A(E(t)), where

i) A(r) is a diffusion process with constant diffusivity a and drift b(A(r), D(r)), with A(0) =

x0

ii) D(r) is a subordinator (strictly increasing L´evy process) with drift c and L´evy measure

ψ(dw), and

iii) E(t) = inf{u : D(u) > t} is an inverse subordinator.
The process V (t) = t − (D− ◦ E)+(t) tracks the residence time of X(t), and (X(t), V (t)) satisfy
the Markov property.

4You guessed it! Weakly with respect to Skorokhod’s J1 topology.

9

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Proof. Noting that χ ↓ 0 as n → ∞ and −dH n(w) → δ(dw) (weakly), it is straightforward to
show that (2.1) and (2.3) are satisﬁed by (4.2). Due to Lemma 9, (2.2) and (2.4) hold as well. Since
the L´evy measure is inﬁnite, D(r) is strictly increasing a.s., and thus Theorem 5 applies.

For large n, we may hence assume that the distribution of (X n(t), V n(t)) for t ∈ τN will be a
good approximation for the distribution of the of the CTRW limit (X(t), V (t)). In the next section
we compute these distributions.

5. Algorithm

We can now derive a time-stepping algorithm which calculates the probability functions of the
discrete process (X n(t), V n(t)), whose state space is χZ × τN, and whose time-steps lie in τN.
Recall that for k ∈ N, H n(kτ ) denotes the probability that a waiting time of the CTRW X n(t) is
(k + 1)τ or longer. Therefore conditioning on V0 = v, we are conditioning on the waiting time
being longer than v, that is v + τ or longer. Hence observing the transition kernel (4.2) we ﬁnd:
P(Xτ ∈ dy, Vτ ∈ du|X0 = x, V0 = v)

(cid:18)

(cid:19)

=

H n(v + τ )

H n(v)

δx(dy)δv+τ (du) +

1 − H n(v + τ )
H n(v)

[(cid:96)(x, τ )δx−χ(dy) + r(x, τ )δx+χ(dy)]δ0(du)

(5.1)

where x ∈ χZ, v ∈ τN and where we set H n(0) := 1. Writing

ξ(i, j, k) := P(Xkτ = iχ, Vkτ = jτ ),

h(j) = H n(jτ ),

we may then write a master equation for the evolution of these probabilities: The ﬁrst term on the
right-hand side of (5.1) corresponds to the case where a particle remains on its site x for another
time step τ, and hence we have

ξ(i, j, k + 1) =

h(j)
h(j − 1)

ξ(i, j − 1, k),

j ≥ 1.

The second term corresponds to the complementary case: a particle jumps to one of the neighbor-
ing lattice sites x− χ or x + χ, and its age is reset to 0. At a given lattice site i the probability mass
is hence obtained by a weighted sum over all residence times of the neighbouring lattice sites:

(cid:18)

∞(cid:88)

j=0

ξ(i, 0, k + 1)

=

1 − h(j + 1)
h(j)

(cid:19)

((cid:96)((i + 1)χ, (k + 1)τ )ξ(i + 1, j, k) + r((i − 1)χ, (k + 1)τ )ξ(i − 1, j, k)) .

The CTRW limit density ρ(x, t) of the process X(t) can then be approximated through

∞(cid:88)

ρ(x, t) ≈

j=0

10

ξ(i, j, k),

i = [x/χ],

k = [t/τ ].

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

In practice, the algorithm runs on a ﬁnite grid

{−L,−L + 1, . . . , 0, . . . , L − 1, L} × {0, 1, . . . , R},

representing the state space, and one has to impose additional boundary conditions.

Spatial Boundary conditions. We only consider the one-dimensional case. For absorbing, or
Dirichlet boundary conditions ρ(b) = 0 where b is a boundary point, a walker is removed if it
walks off the lattice. That is, we set (cid:96)(−mχ, kτ ) = 0 and r(mχ, kτ ) = 0 for all 0 ≤ k ≤ N,
(cid:96)(−mχ, kτ ) = 0; note that on the boundary site, (cid:96) and r hence no longer add to 1.

For reﬂecting, or Neumann boundary conditions, a particle remains at a boundary site whenever

it would jump off the lattice, and adjust (4.2) accordingly.

Residence time boundary conditions. When the residence time of a particle approaches the
lattice end at R, we could force it to jump to a neighboring lattice site and reset its age to 0. This
effectively corresponds to a tail function Ψ(w)1{Ψ(w) ≥ Ψ(Rτ )}, and hence we term this the
cutoff boundary condition.

Below, however, we assume that upon reaching the end of the lattice at R, a particle is not
forced to jump, and allow it to remain at its site x with residence time R if it would not otherwise
jump. That is, we set

ξ(i, R, k + 1) =

h(R)
h(R − 1)

ξ(i, R − 1, k) +

h(R + 1)

h(R)

ξ(i, R, k).

This means that particles with residence time Rτ remain unchanged for a geometrically distributed
number of time steps, with parameter 1 − h(R + 1)/h(R). In the scaling limit, this corresponds to
an exponential distribution, whose rate is

γ(R) :=

ψ(R)
Ψ(R)

, R := lim

n→∞ τ R

(note that as n → ∞, we have τ ↓ 0 and R → ∞). This effectively corresponds to a tail function

Ψ(w)1{Ψ(w) ≥ Ψ(R)} + Ψ(R)e−γ(R)(w−R)1{Ψ(w) < Ψ(R)}

and hence we term this procedure the cross-over boundary condition.

Assume now as a general initial condition a probability measure µ(dx, dv), and that the aim is

to calculate

(cid:90)

P(Xt ∈ dy, Vt ∈ du|X0 = x, V0 = v)µ(dx, dv),

To this end, we set ξ(i, j, 0) = µ([iχ, (i + 1)χ) × [jτ, (j + 1)τ )), and simply run our algorithm
with this initial condition. Note that R needs to be chosen large enough in order to avoid cut-off or
cross-over effects for Ψ(w) as discussed above. A safe choice is always
R = max{j : ξ(i, j, 0) > 0,|i| ≤ L} + N,

where N denotes the number of time steps, though it may of course be infeasible in cases where µ
has unbounded support.

11

G. Gill & P. Straka

6. Examples

CTRWs with Age-Dependent initial condition

Within our framework, we may now compute (approximations of) probability distributions of
CTRW limits, with varying initial residence times, for a variety of models. In particular, we may
assume any subordinator D(r), and thus treat a variety of non-Markovian behaviours (see Table 1).
Two main regimes occur, depending on whether Ψ(t) has integrable tails or not. In the former case,
V (t) admits the equilibrium distribution

(cid:90)

π(B) =

c

c + g

δ0(B) +

1

c + g

B

Ψ(w) dw

(6.1)

where g :=(cid:82) ∞

(cid:90) ∞

t

0 Ψ(w) dw and δ0 denotes a Dirac measure at 0 [32]. In the latter case, there exists

an invariant measure, but it is inﬁnite, and hence an equilibrium cannot be reached.

Tempering. Throughout, β ∈ (0, 1). The tail function Ψ(w) = w−β/Γ(1−β) in the subdiffusive
case is not integrable. The tempered subdiffusive case is obtained by multiplying the L´evy density
with an exponential e−γw [33]. The tail function becomes

Ψ(t|β, γ) =

β

Γ(1 − β)

w−1−βe−γw dw =

t−βe−γt − γΓ(1 − β, t)

Γ(1 − β)

γ ≥ 0

,

where Γ(β, t) denotes the upper incomplete Gamma function. This modiﬁcation makes Ψ(t|β, γ)
integrable for γ > 0, that is, g < ∞. CTRW limits with these “tempered dynamics” appear
subdiffusive on short time scales and diffusive on longer time scales [14, 34, 35]. Note that for
γ = 0 the above reduces to the subdiffusive case.

Subordinator with drift.
If the subordinator D(r) has a positive drift constant c > 0, the result-
ing growth of D(r) at very short times is proportional to cr. Accordingly, the inverse subordinator
E(t) also grows linearly, proportionally to t/c for short times5. For larger time scales, the jumps
of D(r) will dominate the drift c, if g (cid:29) c (or if g = ∞ in the case where Ψ(w) is not integrable).
This means that for long times, the temporal evolution appears subdiffusive if γ = 0 [34]. The
case γ > 0 and c > 0 has been examined in [34]: E(t) ∼ t/c grows linearly for small time scales.
For long time scales, E(t) also grows linearly, although with a smaller slope. To our knowledge,
the cross-over between the two regimes at intermediate time scales has not been looked at in detail
but we predict it will show the signatures of subdiffusive behavior.
Finally, in the case where c > 0 and γ > 0, by the above g < ∞, and c and g admit a nice
physical interpretation: At equilibrium, c/(c + g) is the fraction of “mobile” particles which have
residence time 0, and g/(c + g) is the fraction of “immobile” particles, which have been trapped
for a time w distributed as Ψ(w) dw/(c + g). We deem this to be an interesting tempered extension
of the so called “fractal mobile/immobile model” of [15]. If γ = 0, there exists no equilibrium,
and all mobile particles eventually seep into the immobile phase.

5A law of the iterated logarithm applies for the precise limit, see [26]

12

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

model
Subdiffusion
tempered subdiffusion
fractal mobile-immobile
tempered fractal mobile-immobile

tempering parameter γ

temporal drift c

γ = 0
γ > 0
γ = 0
γ > 0

c = 0
c = 0
c > 0
c > 0

Table 1: We consider four cases of non-Markovian temporal evolutions, governed by the inverse
subordinator E(t).

Varying the initial residence time. When modelling subdiffusion or tempered subdiffusion, the
standard assumption is that the ﬁrst waiting time starts at t = 0, which translates to the initial
condition µ(dx, dv) = ρ0(dx)δ0(dv) (all particles have residence time 0, and their location is dis-
tributed according to ρ0(dx), typically ρ0(dx) = δ0(dx), [8]). Subdiffusive CTRWs are known
to exhibit ageing, which is an indeﬁnite slowing down of the dynamics as t increases. [36] con-
sider dynamics of CTRW limits where the system has been prepared at a time −ta, and study
the dynamics on the interval (0, t), for which e.g. a Fokker-Planck equation has been derived
in [37]. This relates to our approach by taking as initial condition the probability distribution
µ(dx, dv) = P[Xta ∈ dx, Vta ∈ dv|X0 = 0, V0 = 0], and calculating the probability distributions
of P[Xs ∈ dx, Vs ∈ dx|µ] for s ∈ (0, t).

In the subdiffusive setting, we now examine the impact of a varying initial residence time
on the probability function of a CTRW limit. In particular, we calculate the “Green’s functions”
P[Xt ∈ dx, Vt ∈ dv|X0 = 0, V0 = v] where v ≥ 0. For simplicity, we assume symmetric nearest
neighbor jumps with reﬂecting boundary condition, and a fractional parameter β = 0.9. Figure 2,
with v = 0 shows the distinctive cusp shape of subdiffusive CTRW limits (see e.g. [1]). As v
increases, the probability mass at x = 0 (a delta function) increases. This is to be expected, since
in the subdiffusive case, escape probability is a decreasing function of residence time. We also
note that at sites x (cid:54)= 0, all curves coincide up to a multiplicative constant.

Evolution of the residence time distribution. Figure 3 describes the evolution of the densities
of the residence time process Vt. Note again that this distribution has a delta function singularity
at v + t, which is more pronounced on the right (v = 0.05) compared to the left (v = 0). This
is expected, since given an initial condition (X0, V0) = (x, v), a residence time of v + t means
that the particle has not yet moved from its initial position, and (for subdiffusion) larger v means
smaller probability of escape. As time proceeds, the distribution approaches (6.1).

Computational accuracy. Exact analytical solutions to the symmetric subdiffusion equation are
available, and we check our computed densities against these solutions. Following [29], use the
series representation

ρ(x, t) = 1 +

(−1)k2 exp(−(2kπ)2t) cos(2kπx)

∞(cid:88)

k=1

13

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Figure 2: Density ρ(x, t) of a subdiffusive process at t = 5 with varying initial age condition.
The “equilibrium initial age” condition is as in (6.1). Note that for positive initial residence time,
there is a delta function singularity at x = 0, and the remaining probability mass is continuously
distributed on (−∞, 0) ∪ (0,∞).

for the solution ρ(x, t) to the “standard” fractional diffusion equation

∂ρ(x, t)

∂t

∂1−β
∂t1−β

= a

∂2ρ(x, t)

∂x2

.

As shown e.g. in [8], the corresponding CTRW limit process is given by symmetric nearest neigh-
bor jumps, c = γ = 0 and Ψ(w) = w−β/Γ(1 − β). Figure 4 displays the computational errors for
this case, which seem to stabilize as the densities of the discrete CTRW approach the CTRW limit
(as n → ∞).

7. Conclusion

Similar in spirit to [29], we have derived an algorithm for the computation of probability dis-
tributions of CTRW limits, which is based on the stochastic process rather than the fractional

14

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Figure 3: The probability distribution of Vt given V0 = 0 (left) and V0 = 0.05 (right), for the
tempered subdiffusive case. Note again that at v + t there is a delta function singularity, whereas
the remaining mass is continuously distributed on the remaining continuous interval (0, v + t).
Parameters are γ = 1, n = 100, a = 1, c = 0 and β = 0.9.

Figure 4: Computational errors for the standard subdiffusion equation with β = 0.9, using our
algorithm from Section 5. As n increases, results become seemingly more accurate.

15

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Fokker-Planck equation. Additionally, our approach calculates the residence time, or age of a
walker, which is of independent physical interest, and which may be of use for the modelling of
non-Markovian diffusion with distributed age initial condition.

In [38] it is shown that the discrete stochastic processes approach from [29] is also applicable
to model reaction-diffusion problems and nonlinear interactions. Our approach above assumes that
particles do not interact, and there are severe technical obstacles in extending the above mathemat-
ical rigour to CTRW limit processes which interact via reactions, chemotaxis, or otherwise. It is
straightforward, however, to write down master equations with interactions using the Semi-Markov
formalism, and thus to calculate mass distributions, see [12]. The work here may be viewed as an
extension to [12] which can model general subordinated particle dynamics.

In order to focus on the main ideas, we have only considered CTRWs with nearest neighbor
jumps and homogeneous waiting times. By varying the coefﬁcients a, b, c and K and by possibly
making them vary in space and time, one can arrive at a variety of different models; for three such
models, see [30]. It is possible to generalize the Semi-Markov algorithm from Section 5 to coupled
and non-local jump operators, given the formulas derived in [20], though this may of course require
much larger computational effort.

Acknowledgements
P. Straka was supported by the UNSW Science Early Career Research Grant and the Australian
Research Council’s Discovery Early Career Research Award.

References

[1] Ralf Metzler and Joseph Klafter. The random walk’s guide to anomalous diffusion: a frac-

tional dynamics approach. Phys. Rep., 339(1):1–77, dec 2000.

[2] Benjamin M Regner, Dejan Vuˇcini´c, Cristina Domnisoru, Thomas M Bartol, Martin W Het-
zer, Daniel M Tartakovsky, and Terrence J Sejnowski. Anomalous diffusion of single particles
in cytoplasm. Biophys. J., 104(8):1652–1660, 2013.

[3] Brian Berkowitz, Andrea Cortis, Marco Dentz, and Harvey Scher. Modeling non-Fickian
transport in geological formations as a continuous time random walk. Rev. Geophys.,
44(2):RG2003, 2006.

[4] E. Scalas. Five years of continuous-time random walks in econophysics. Complex Netw.

Econ. Interact., 567:3–16, 2006.

[5] Fidel Santamaria, Stefan Wils, Erik De Schutter, and George J. Augustine. Anomalous dif-

fusion in Purkinje cell dendrites caused by spines. Neuron, 52(4):635–48, nov 2006.

[6] Daniel S. Banks and C´ecile Fradin. Anomalous diffusion of proteins due to molecular crowd-

ing. Biophys. J., 89(5):2960–71, nov 2005.

16

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

[7] B.I. I Henry, T. A.M. Langlands, Peter Straka, and T. Langlands. An introduction to fractional
diffusion. In R L. Dewar and F Detering, editors, Complex Phys. Biophys. Econophysical
Syst. World Sci. Lect. Notes Complex Syst., volume 9 of World Scientiﬁc Lecture Notes in
Complex Systems, pages 37–90, Singapore, 2010. World Scientiﬁc.

[8] B I Henry, T. A. M. Langlands, and Peter Straka. Fractional Fokker-Planck Equations for
Subdiffusion with Space- and Time-Dependent Forces. Phys. Rev. Lett., 105(17):170602,
2010.

[9] T.A.M. Langlands and B.I. Henry. The accuracy and stability of an implicit solution method

for the fractional diffusion equation. J. Comput. Phys., 205(2):719–736, may 2005.

[10] Vicenc Mendez, Sergei Fedotov, and Werner Horsthemke. Reaction-Transport Systems:
Mesoscopic Foundations, Fronts, and Spatial Instabilities. Springer Berlin/Heidelberg, 1st
edition, jun 2010.

[11] Christopher N Angstmann, I C Donnelly, and B.I. Henry. Continuous Time Random Walks

with Reactions Forcing and Trapping. Math. Model. Nat. Phenom., 8(2):17–27, apr 2013.

[12] Peter Straka and Sergei Fedotov. Transport equations for subdiffusion with nonlinear particle

interaction. J. Theor. Biol., 366:71–83, feb 2015.

[13] Sergei Fedotov and Nickolay Korabel. Self-organized anomalous aggregation of particles

performing nonlinear and non-Markovian random walks. 87(18):062127, 2015.

[14] Aleksander Stanislavsky, Karina Weron, and Aleksander Weron. Diffusion and relaxation

controlled by tempered α-stable processes. Phys. Rev. E, 78(5):6–11, nov 2008.

[15] Rina Schumer, David A Benson, Mark M. Meerschaert, and Boris Baeumer. Fractal mo-

bile/immobile solute transport. Water Resour. Res., 39(10), oct 2003.

[16] Peter Straka and B I Henry. Lagging and leading coupled continuous time random walks,

renewal times and their joint limits. Stoch. Process. their Appl., 121(2):324–336, feb 2011.

[17] A. Jurlewicz, P. Kern, Mark M. Meerschaert, and H.P. P. Schefﬂer. Fractional governing
equations for coupled random walks. Comput. Math. with Appl., 64(10):3021–3036, nov
2012.

[18] Marcin Magdziarz, H.P. Schefﬂer, Peter Straka, and P. Zebrowski. Limit theorems and gov-

erning equations for L´evy walks. Stoch. Process. their Appl., 125(11):4021–4038, 2015.

[19] K. Weron, A. Jurlewicz, Marcin Magdziarz, A. Weron, and J. Trzmiel. Overshooting and un-
dershooting subordination scenario for fractional two-power-law relaxation responses. Phys.
Rev. E, 81(4):1–7, apr 2010.

[20] Mark M. Meerschaert and Peter Straka. Semi-Markov approach to continuous time random

walk limit processes. Ann. Probab., 42(4):1699–1723, jul 2014.

17

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

[21] Ofer Busani. Finite Dimensional Fokker-Planck Equations for Continuous Time Random

Walks. pages 1–12, oct 2015.

[22] Mark M. Meerschaert and Peter Straka. Fractional Dynamics at Multiple Times. J. Stat.

Phys., 149(5):878–886, nov 2012.

[23] A. Baule and R. Friedrich. A fractional diffusion equation for two-point probability distribu-

tions of a continuous-time random walk. Europhys. Lett., 77(1):10002, jan 2007.

[24] Mark M. Meerschaert and Alla Sikorskii. Stochastic models for fractional calculus. De

Gruyter, Berlin/Boston, 2011.

[25] D. Applebaum. L´evy Processes and Stochastic Calculus, volume 116 of Cambridge Studies

in Advanced Mathematics. Cambridge University Press, 2nd edition, may 2009.

[26] Jean Bertoin. Subordinators: examples and applications, volume 1717 of Lecture Notes in

Mathematics. Springer Berlin Heidelberg, Berlin, Heidelberg, 1999.

[27] Mark M. Meerschaert and Peter Straka. Inverse Stable Subordinators. Math. Model. Nat.

Phenom., 8(2):1–16, 2013.

[28] A. Weron and Marcin Magdziarz. Modeling of subdiffusion in space-time-dependent force

ﬁelds beyond the fractional Fokker-Planck equation. Phys. Rev. E, 77(3):1–6, mar 2008.

[29] C N Angstmann, I C Donnelly, B.I. Henry, T.A.M. Langlands, and Peter Straka. Gener-
alized Continuous Time Random Walks, Master Equations, and Fractional Fokker–Planck
Equations. SIAM J. Appl. Math., 75(4):1445–1468, jan 2015.

[30] Peter Straka. Forward and Backward Governing Equations for Anomalous Diffusion Models
Based on the Continuous Time Random Walk. arXiv Prepr. arXiv1212.1197, pages 1–19,
dec 2012.

[31] Marcin Magdziarz, Janusz Gajda, and Tomasz Zorawik. Comment on Fractional Fokker-
J. Stat. Phys.,

Planck Equation with Space and Time Dependent Drift and Diffusion.
154(5):1241–1250, 2014.

[32] Joseph Horowitz. Semilinear Markov processes, subordinators and renewal theory. Z.

Wahrsch. Verw. Geb., 24(3):167–193, 1972.

[33] J Rosi´nski. Tempering stable processes. Stoch. Process. Appl., 117(6):677–707, jun 2007.

[34] Peter Straka. Continuous Time Random Walk Limit Processes: Stochastic Models for Anoma-

lous Diffusion. PhD thesis, University of New South Wales, 2011.

[35] Janusz Gajda and Marcin Magdziarz. Fractional Fokker-Planck equation with tempered
alpha-stable waiting times: Langevin picture and computer simulation. Phys. Rev. E, 82(1):1–
6, jul 2010.

18

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

[36] Eli Barkai and YC C Cheng. Aging continuous time random walks.

J. Chem. Phys.,

118(14):6167, 2003.

[37] Ofer Busani. Aging uncoupled continuous time random walk limits. pages 1–18.

[38] C.N. Angstmann, I.C. Donnelly, B.I. Henry, B.A. Jacobs, T.A.M. Langlands, and J.A.
Nichols. From stochastic processes to numerical methods: A new scheme for solving re-
action subdiffusion fractional partial differential equations. J. Comput. Phys., 307:508–534,
2016.

[39] J. Jacod and A.N. N Shiryaev. Limit Theorems for Stochastic Processes. Springer, dec 2002.

[40] P. Billingsley. Convergence of Probability Measures. Wiley Series in Probability and Statis-

tics. John Wiley & Sons Inc, New York, second edition, jan 1968.

[41] Edwin Hewitt. Integration by Parts for Stieltjes Integrals. Am. Math. Mon., 67(5):419, may

1960.

A Proofs
Proof of Theorem 1. We apply Th IX.4.8 in [39]. The process {(An
martingale in Rd+1, in the sense of the cited book. Relative to the truncation function

L(nr), Dn

L(nr))}r≥0 is a semi-

(cid:40)

h(y, w) =

(y, w)
(0, 0)

if (cid:107)y(cid:107) < 1 and 0 < w < 1
else

its characteristics are ((Bn, Cn), An, Πn), where

Bn

i (t) =

Cn(t) =

An

ij(t) =

bn
i (An

L(nr), Dn

L(nr))dr,

˜cn(An

L(nr), Dn

L(nr))dr,

˜an
ij(An

L(nr), Dn

L(nr))dr,

bn
i (x, t) = n

˜cn(x, t) = n

˜an
ij(x, t) = n

hi(y, w) K n(dy, dw|x, t)

hd+1(y, w) K n(dy, dw|x, t)

(hihj)(y, w) K n(dy, dw|x, t)

(cid:90)(cid:90)
(cid:90)(cid:90)
(cid:90)(cid:90)

(cid:90) t
(cid:90) t
(cid:90) t

0

0

0

Πn(dy, dw; dr) = K n(dy, dw|An
and where (hihj)(y, w) = hi(y, w)hj(y, w). Observing that

L(nr), Dn

L(nr))dr

n→∞ ˜cn(x, t) = c(x, t) +
lim

n→∞ ˜an
lim

ij(x, t) = aij(x, t) +

hd+1(y, w)Π(dy, dw|x, t),
(hihj)(y, w)Π(dy, dw|x, t),

1 ≤ i, j ≤ d

(A1)

(A2)

(cid:90)(cid:90)
(cid:90)(cid:90)

one veriﬁes that the assumptions of Th IX.4.8 in [39] are satisﬁed.

19

G. Gill & P. Straka

CTRWs with Age-Dependent initial condition

Proof of Theorem 5. We apply Proposition 2.3 in [16], which states the following: The mapping

(α, δ) (cid:55)→ ((α−, δ−) ◦ −)+ ,

Next, apply the continuous mapping theorem [40]: Since the processes (An

deﬁned for c`adl`ag6 trajectories α and δ in Rd resp. R, where δ is increasing and unbounded,
and where (t) := inf{r : δ(r) > t}, is continuous at all trajectories (α, δ) where δ is strictly
increasing. As before, ◦ denotes a composition of trajectories, and a +/− in the subscript denotes
the right-continuous resp. left-continuous version of a trajectory. Continuity is with respect to the
(metrizable) Skorokhod J1 topology on the set of all such trajectories [39].
L(nr)) con-
verge to (A(r), D(r)) as n → ∞, and D(r) is strictly increasing (almost surely), the sequence
of their images (X n(t), Gn(t)) must converge to the image (X(t), G(t)). Here, Gn(t) := (Dn− ◦
L(nr) > t}, and G(t) = (D− ◦ E)+(t) (note that E(t) has a.s. increas-
En−)+(t), En(t) = inf{r : Dn
ing sample paths). It is tedious but not too difﬁcult to check that (X n(t), Gn(t) and (X(t), G(t))
are really the images of (An
Finally, in a similar fashion mapping the process Gn(t) to the process V n(t) = t − Gn(t) also

L(nr)) and (A(r), D(r)) for the above mapping.

L(nr), Dn

L(nr), Dn

deﬁnes a continuous mapping, hence V n(t) also converges to V (t).
Proof of Lemma 9. The measure dH n is concentrated at the steps τN = {τ, 2τ, 3τ, . . .} of the
function H n. We use this and Lebesgue-Stieltjes integration by parts [41] to calculate

(cid:90)

n

w dH n(w) = n

(0,ε]

[τ,ε]

(cid:90)

(cid:90)
(cid:90)
τ − n
= εnH n(ε) − τ nH n(τ ) −

w dH n(w) = [nwH n(w)]ε

H n(w) dw

[τ,ε]

(n ∧ Ψ ((cid:100)w/τ(cid:101)τ − c/n)) dw.

Now examine these terms individually as n → ∞:

[τ,ε]

εnH n(ε) → εΨ(ε)
τ nH n(τ ) = τ (n ∧ Ψ(τ − c/n)) ∼ (τ1 + τ2)Ψ(τ1) = τ1n + c
n ∧ Ψ ((cid:100)w/τ(cid:101)τ − c/n) → Ψ(w)

of the third expression converges to(cid:82)

where ∼ means the two sequences have the same limit. By dominated convergence, the integral
(0,ε] Ψ(w) dw. Since Ψ is integrable at 0, Ψ(w) ≤ Cw−β at
w ↓ 0 where β ∈ (0, 1). Hence τ1n = τ1Ψ(τ1) → 0. Now letting ε ↓ 0 gives the ﬁrst statement.

The second statement follows by integration by parts and dominated convergence:

(cid:90)

−n

(cid:90)

(0,∞)
→

(0,∞)

(cid:90)

(cid:90)

(0,∞)

g(w) dH n(w) = n

g(cid:48)(w)H n(w) dw

g(cid:48)(w)Ψ(w) dw = −

g(w) dΨ(w)

(0,∞)

(note that the boundary terms vanish by deﬁnition of g).

6French acronym for right-continuous with left-hand limits

20

