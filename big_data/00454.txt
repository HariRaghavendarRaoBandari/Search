6
1
0
2

 
r
a

M
8

 

 
 
]

.

O
L
h
t
a
m

[
 
 

2
v
4
5
4
0
0

.

3
0
6
1
:
v
i
X
r
a

THERE ARE NO INTERMEDIATE STRUCTURES BETWEEN

THE GROUP OF INTEGERS AND PRESBURGER ARITHMETIC

GABRIEL CONANT

Abstract. We show that if a ﬁrst-order structure M, with universe Z, is an
expansion of (Z, +, 0) and a reduct of (Z, +, <, 0), then M must be interdeﬁn-
able with (Z, +, 0) or (Z, +, <, 0).

1. Introduction

Suppose M1 and M2 are ﬁrst-order structures, with the same underlying uni-
verse M , in ﬁrst-order languages L1 and L2, respectively. We say M1 is a reduct
of M2 (equivalently, M2 is an expansion of M1) if, for all n > 0, every L1(M )-
deﬁnable subset of M n is also L2(M )-deﬁnable (where Li(M )-deﬁnable means Li-
deﬁnable with parameters from M ). We say M1 and M2 are interdeﬁnable if M1
is a reduct of M2 and M2 is a reduct of M1. Our main result is the following
theorem.

Theorem 1.1. Suppose L is a ﬁrst-order language and M is an L-structure with
universe Z. If M is an expansion of (Z, +, 0) and a reduct of (Z, +, <, 0) then M
is interdeﬁnable with either (Z, +, 0) or (Z, +, <, 0).

This result was originally motivated by a question of Marker on the existence of
a stable structure M, which is both a reduct of (Z, +, <, 0) and a proper expansion
of (Z, +, 0). In recent joint work [5] of the author and Pillay, it is shown that no
such structure exists. More generally, it is shown that there are no proper stable
expansions of (Z, +, 0) of ﬁnite dp-rank 1. Since any reduct of (Z, +, <, 0) has dp-
rank 1, this answers Marker’s question. Therefore, any counterexample to Theorem
1.1 would necessarily have an unstable theory, and so, in some sense, the work in
[5] provides “half” of the proof of Theorem 1.1. However, the proof of Theorem
1.1 given here does not use the work in [5], and therefore also gives an alternate
proof of the answer to Marker’s question, which requires no general technology from
stability theory. It would be interesting to know if there is a more model theoretic
proof of Theorem 1.1, which incorporates the results of [5].

As suggested above, an appropriate model theoretic context for Theorem 1.1 is
the study of dp-rank in NIP ﬁrst-order theories (see, e.g., [18]), with a speciﬁc focus
on proper expansions of (Z, +, 0) of ﬁnite dp-rank. The work in [5] implies that any
such expansion has an unstable theory. Beyond this, relatively little is known, even
under the strongest assumption of dp-minimality (i.e., dp-rank 1). In [2, Question

Date: March 8, 2016.
1Dp-rank (or dependence-rank) is a combinatorial notion of dimension, which most often stud-
ied in theories without the independence property (i.e. NIP or dependent theories). See [18] for
details. Although we are using these notions to provide model theoretic context for our results,
they will not be referenced in the subsequent work nor used in any proofs.

1

2

GABRIEL CONANT

5.32], Aschenbrenner, Dolich, Haskell, Macpherson, and Starchenko ask if every
dp-minimal expansion of (Z, +, 0) is a reduct of (Z, +, <, 0). Combined with our
main result, a positive answer to this question would imply that (Z, +, <, 0) is the
only proper dp-minimal expansion of (Z, +, 0). On the other hand, ﬁnite dp-rank
expansions of (Z, +, <, 0) are completely understood. In fact, Dolich and Goodrick
[7] have recently shown that (Z, +, <, 0) has no proper strong expansions (which
includes expansions of ﬁnite dp-rank). This was ﬁrst shown for dp-rank 1 by Dolich,
Haskell, Macpherson, and Starchenko in [6]. A crucial tool in both proofs is the
fact, due to Michaux and Villemaire [12], that any proper expansion of (Z, +, <, 0)
deﬁnes a unary subset in Z, which is not deﬁnable in (Z, +, <, 0).

In general, there are proper expansions of (Z, +, 0), other than (Z, +, <, 0), which
still satisfy model theoretic notions of “low complexity”. For example, Palacín and
Sklinos [13] and Poizat [15] independently showed that (Z, +, 0, Πq) is superstable,
where, given q > 0, Πq is a predicate for {qn : n ∈ N}. Palacín and Sklinos [13] prove
the same conclusion for (Z, +, 0, Fac), where Fac is a predicate for {n! : n ∈ N}.
None of these structures has ﬁnite dp-rank (see e.g. [5]). Another very interesting
example was recently studied by Kaplan and Shelah in [9]. Speciﬁcally, it is shown
that if Dickson’s Conjecture2 is true, then (Z, +, 0, Pr) is supersimple of U -rank 1,
where Pr is a predicate for {p ∈ Z : |p| is prime}. The authors also show (Z, +, 0, Pr)
is unstable.

Although we are focusing on expansions of (Z, +, 0), all of the results discussed
above are manifestations of the general study of when good properties of ﬁrst-order
structures are preserved when naming new predicates. Of the many more occur-
rences of such results in the literature, we mention one further example, which has a
strong analogy to our main result in the sense that it demonstrates the existence of
two extreme possibilities when focusing on some natural class of structures. Specif-
ically, in [10], Marker shows that if S ⊆ R2n is a semi-algebraic set then, intepreted
as a subset of Cn, S is either constructible (i.e. deﬁnable in the complex ﬁeld
(C, +, ·, 0, 1)) or R is deﬁnable in (C, +, ·, 0, 1, S) (and so any semi-algebraic set is
deﬁnable in this expansion).

A ﬁnal important remark is that most of the results on (Z, +, 0) mentioned
above, including Theorem 1.1, become false if one widens the context to expan-
sions of structures elementarily equivalent to (Z, +, 0). For example, there are or-
dered groups (G, +, <, 0) elementarily equivalent to (Z, +, <, 0) with proper reducts
strictly between (G, +, <, 0) and (G, +, 0) (even ones with stable theories).

We now give a brief summary of the paper. Our proof of Theorem 1.1 will not
require any “model theoretic” results beyond well-known consequences of quantiﬁer
elimination in the theories of (Z, +, 0) and (Z, +, <, 0). Speciﬁcally, we use Cluckers’
cell decomposition of deﬁnable sets in (Z, +, <, 0), given in [4] (see Section 6), as
well as the classiﬁcation of deﬁnable sets in (Z, +, 0) as Boolean combinations of
cosets of subgroups (see Fact 4.1). The rest of the proof of Theorem 1.1 is entirely
geometric, and is summarized as follows.

Section 2 lays out basic deﬁnitions and reformulates Theorem 1.1 as a statement
about individual deﬁnable sets (see Theorem 2.4). Speciﬁcally, we want to show
that, given n > 0, if A ⊆ Zn is deﬁnable in (Z, +, <, 0) then either A is deﬁnable

2Dickson’s Conjecture is a generalization of Dirchlet’s prime number theorem, which, in par-
ticular, implies the existence of inﬁnitely many twin primes and inﬁnitely many Sophie Germain
primes.

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

3

in (Z, +, 0) or the ordering on Z is deﬁnable in the expansion (Z, +, 0, A), where
we use A to denote an n-ary predicate for itself. Formulated this way, the proof
proceeds by induction on n. In Section 3, we prove the base case n = 1, which
is an easy consequence of quantiﬁer elimination in (Z, +, <, 0). We then turn to
several preparatory results needed for the induction step.
In Section 4, we use
the classiﬁcation of sets deﬁnable in (Z, +, 0) to give a kind of cell decomposition
for (Z, +, 0), where “cells” are quasi-cosets, i.e.
cosets of subgroups with some
In Section 5, we prove two easy consequences of a
lower rank piece removed.
result of Kadets [8] concerning the inradius of a polyhedron P in Rn (i.e.
the
supremum over the radii of n-balls contained in P ). Polyhedra arise naturally in
our situation because of the fact, which follows from Cluckers’ cell decomposition,
that if f : Zn −→ Z is deﬁnable in (Z, +, <, 0), then there is a decomposition of Zn
into ﬁnitely many subsets deﬁnable in (Z, +, <, 0) such that, on each subset, f is
the restriction of an aﬃne transformation from Rn to R.

Then, in Section 7, we begin the technical work toward the induction step of the
proof of the main result. In particular, we isolate a subclass of sets deﬁnable in
(Z, +, <, 0) satisfying certain structural properties, and show that, in order to prove
the main result, it suﬃces to only consider sets in this special subclass. Roughly
speaking, this subclass is deﬁned by specifying congruence classes, sorting inﬁnite
ﬁbers from ﬁnite ﬁbers, and uniquely identifying the endpoints of the intervals in
ﬁbers with a ﬁnite collection of aﬃne transformations. Finally, in Section 8, we
combine all of these tools to ﬁnish the main proof.

Acknowledgements. I would like to thank Dave Marker for ﬁrst introducing me
to this project as a graduate student, and for many helpful conversations during that
time. After running into trouble initially, the project was put on hiatus for several
years. However, the proof given here is still based on my work while Marker’s
student. The motivation to return to the problem came from the joint work in
[5] with Anand Pillay, as well as conversations with Sergei Starchenko, Somayeh
Vojdani, and Erik Walsberg.

2. Definitions and reformulation of main result

We assume familiarity with the notion of a ﬁrst-order deﬁnable set in a ﬁrst-order
structure. A thorough introduction can be found in any text on mathematical logic
(e.g. [11]). Given a structure M in a ﬁrst-order language L, we say that a subset
A ⊆ M n is deﬁnable in M to mean A is L-deﬁnable with parameters from M .

Deﬁnition 2.1. Suppose M1 and M2 are ﬁrst-order structures, with the same
underlying universe M , in ﬁrst-order languages L1 and L2, respectively.

(1) We say M1 is a reduct of M2 (equivalently, M2 is an expansion of M1)
if, for all n > 0, every subset of M n, which is deﬁnable in M1, is also
deﬁnable in M2.

(2) We say M1 and M2 are interdeﬁnable if M1 is a reduct of M2 and M2

is a reduct of M1.

Let Z denote the set of integers, and N the set of nonnegative integers. We let

Z∗ denote Z ∪ {-∞, ∞}, and extend the ordering on Z to Z∗ in the obvious way.

Given a sequence of sets (A1, . . . , An), with Ai ⊆ Zni , we deﬁne the expansion
(Z, +, 0, A1, . . . , An) of (Z, +, 0) where, with a slight abuse of notation, Ai is an
ni-ary relation symbol interpreted as Ai.

4

GABRIEL CONANT

Deﬁnition 2.2. Let (A1, . . . , Am) and (B1, . . . , Bn) be sequences of sets, with
Ai ⊆ Zmi and Bi ⊆ Zni .

(1) We say (A1, . . . , Am) is deﬁnable from (B1, . . . , Bn) if (Z, +, 0, A1, . . . , Am)

is a reduct of (Z, +, 0, B1, . . . , Bm).

(2) We say (A1, . . . , Am) and (B1, . . . , Bn) are interdeﬁnable if the structures

(Z, +, 0, A1, . . . , Am) and (Z, +, 0, B1, . . . , Bn) are interdeﬁnable.

It is worth noting that, in the previous deﬁnition, we have been a little careless
with our use of the word deﬁnable.
In particular, it would be more accurate to
say, for instance, “(A1, . . . , Am) is deﬁnable from (B1, . . . , Bn) relative to (Z, +, 0)”.
However, throughout the paper we focus on expansions of (Z, +, 0), and therefore
always assume that we can use the group language when deﬁning sets.

Our two main structures are (Z, +, 0) and (Z, +, <, 0). The latter structure is
often referred to as Presburger arithmetic, since the theory of (Z, +, <, 0) was ﬁrst
formally axiomatized by Presburger [16] in 1929. We use the following terminology.

Deﬁnition 2.3. Fix n > 0 and a subset A ⊆ Zn.

(1) We say A is a Presburger set if A is deﬁnable in (Z, +, <, 0).
(2) We say A deﬁnes the ordering if N is deﬁnable in (Z, +, 0, A).

We can now restate Theorem 1.1.

Theorem 2.4. Given n > 0, if A ⊆ Zn is a Presburger set then either A is
deﬁnable in (Z, +, 0) or A deﬁnes the ordering.
In other words, (Z, +, 0, A) is
either interdeﬁnable with (Z, +, 0) or with (Z, +, <, 0).

It is worth again emphasizing that, for us, “interdeﬁnable” means with param-
eters. For example, 1 is deﬁnable in (Z, +, <, 0) without parameters, but not in
(Z, +, <, 0). Of course, any element of Z is deﬁnable from 1 without parameters,
and so one could avoid this issue by replacing (Z, +, 0) with (Z, +, 0, 1).

Given n > 0 and x, y ∈ Z, we write x ≡n y if x − y ∈ nZ. For a ﬁxed n > 0, the
binary relation ≡n is deﬁnable in (Z, +, 0). The fundamental model theoretic fact,
which is essentially the only model theory necessary for the proof of Theorem 2.4,
is that the theories of (Z, +, 0) and (Z, +, <, 0) both have quantiﬁer elimination in
the languages obtained by adding a constant symbol 1, a binary function symbol
−, and a binary relation symbol ≡n for all n > 0, each of which is interpreted in
the obvious way (see, respectively, Exercise 3.4.6 and Corollary 3.1.21 of [11] for
details). As a result, deﬁnable sets in the two structures can be described explicitly
(see Fact 4.1 for (Z, +, 0), and Fact 6.3 for (Z, +, <, 0)).

The proof of Theorem 2.4 will proceed by induction on n > 0. The base case

n = 1 can be handled easily, and so we will dispense with it right away.

3. The one-dimensional case

In this section, we prove Theorem 2.4 for the case n = 1. The main tool is the

following description of Presburger subsets of Z.

Proposition 3.1. Suppose A ⊆ Z is a Presburger set. Then

k

for some ﬁnite set F , k ∈ N (possibly 0), and a1, . . . , ak, b1, . . . , bk ∈ Z.

[i=1

A = F ∪

{ai + bin : n ∈ N},

[i=1

[i=1

[i=1

[i=1

k∗

l∗

A =

(-∞, 0]ci

m ∪

[0, ∞)di
m

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

5

The proof is omitted.

It follows fairly easily from quantiﬁer elimination for
Presburger arithmetic, and even more easily from cell decomposition for Presburger
sets (due to Cluckers [4], see Section 6). We have formulated Proposition 3.1
to mimic a recent result of Dolich and Goodrick [7, Theorem 2.18], which is a
generalization to archimedean ordered abelian groups with strong theories.

Deﬁnition 3.2. Given a, b ∈ Z∗ and m, c ∈ N, with c < m, deﬁne

[a, b]c

m = {x ∈ Z : a ≤ x ≤ b, x ≡m c}.

Corollary 3.3. Suppose A ⊆ Z is a Presburger set. Then either A is deﬁnable in
(Z, +, 0) or A deﬁnes the ordering.

Proof. Since any ﬁnite set is deﬁnable in (Z, +, 0), we may assume A is inﬁnite.
Since A is interdeﬁnable with A △ F for any ﬁnite F ⊆ Z, we may use Proposition
3.1 to assume

k

l

A =

(-∞, 0]ci

mi ∪

[0, ∞)di
ni ,

where k, l ∈ N (possibly 0), and ci, di, mi, ni ∈ N with ci < mi and di < ni. Let
m be the least common multiple of m1, . . . , mk, n1, . . . , nl. Then, by adding more
terms to the union, we may write

where 0 ≤ ci < m and 0 ≤ dj < m for all 1 ≤ i ≤ k∗ and 1 ≤ j ≤ l∗.

Suppose that there is some 1 ≤ j ≤ l∗ such that dj 6= ci for all 1 ≤ i ≤ k∗. Then

x ∈ N ⇔ dj + mx ∈ A,

and so A deﬁnes the ordering. By a similar argument, if there is some 1 ≤ i ≤ k∗
such that ci 6= dj for all 1 ≤ j ≤ l∗, then A deﬁnes the ordering. So we may assume
{c1, . . . , ck∗} = {d1, . . . , dl∗}. Then

which is deﬁnable in (Z, +, 0).

A =

k∗

[i=1

(-∞, ∞)ci
m,

(cid:3)

From the proof, we have the following useful observation.

Corollary 3.4. Suppose A ⊆ Z is an inﬁnite Presburger set, which is bounded
above or bounded below. Then A deﬁnes the ordering.

4. Quasi-coset decomposition in (Z, +, 0)

In the induction step of the proof of Theorem 2.4, we will use the induction
hypothesis to conclude that if a Presburger set A ⊆ Zn+1 does not deﬁne the
ordering, then the projection of A to Zn is deﬁnable in (Z, +, 0). Therefore, in this
section, we develop a certain decomposition of subsets of Zn deﬁnable in (Z, +, 0).
We remind the reader that when we say “deﬁnable”, with no other speciﬁcation, we
mean “deﬁnable in (Z, +, 0)”.

We start with the following classical fact (see, e.g., [14] or [17]).

6

GABRIEL CONANT

Fact 4.1. A set A ⊆ Zn is deﬁnable in (Z, +, 0) if and only if it is a Boolean
combination of cosets of subgroups of Zn.

The goal of this section is to assign a relative notion of rank to subsets of Zn
using cosets of subgroups. We also want to decompose deﬁnable sets in Zn into
deﬁnable pieces looking as much like cosets as possible.

Recall that, given n > 0, Zn is an example of a free abelian group, meaning it is
an abelian group generated by a linearly independent basis of unique cardinality,
called the rank of the group. Recall also that any subgroup of a free abelian group
is free abelian, which can be shown using the following classical fact (see, e.g., [1,
Theorem 12.4.11]).

Fact 4.2. Suppose G is a free abelian group of rank n and H ≤ G is a nontrivial
subgroup. Then there is a basis {¯a1, . . . , ¯an} of G, an integer k ≤ n, and positive
integers d1, . . . , dk, such that di divides di+1 for all 1 ≤ i < k and {d1¯a1, . . . , dk¯ak}
is a basis for H (in particular, H is free abelian of rank k).

Note that this fact can be used to prove one direction of Fact 4.1, namely, that
Boolean combinations of cosets are deﬁnable. The following corollary of Fact 4.2
will be useful.

Corollary 4.3. Suppose G is a free abelian group of rank n and H ≤ G is a
subgroup of rank k ≤ n. Then [G : H] is ﬁnite if and only if k = n.

We now deﬁne a notion of rank for arbitrary subsets X ⊆ Zn. As usual, the

rank of the trivial subgroup {0} is 0.

Deﬁnition 4.4.

(1) If C ⊆ Zn is a coset of rank k subgroup of Zn, then we set rk(C) = k.
(2) Given a nonempty set X ⊆ Zn, deﬁne the rank of X, denoted rk(X), to be
the minimum integer k ∈ {0, 1, . . . , n} such that X is contained in a ﬁnite
union of cosets of rank at most k. Set rk(∅) = -1.

Using Corollary 4.3, the reader may check that if C ⊆ Zn is a coset then the
rank of C, as deﬁned in part (1) of the previous deﬁnition, agrees with the rank as
deﬁned in part (2). So our notion of rank is well-deﬁned. From the deﬁnitions, it
follows that rk(X ∪ Y ) = max{rk(X), rk(Y )} for any X, Y ⊆ Zn.

Deﬁnition 4.5. Fix linearly independent α = {¯a1, . . . , ¯ak} ⊂ Zn, and let G =
h¯a1, . . . , ¯aki ≤ Zn.

(1) Deﬁne the group isomorphism Φα : G −→ Zk such that

Φα(¯at) = (0, . . . , 0, 1, 0, . . . , 0) ∈ Zk,

where 1 is in the tth coordinate.

(2) Fix ¯c ∈ Zk and set C = ¯c + G. Deﬁne the bijection Φα,¯c : C −→ Zk such

that Φα,¯c(¯x) = Φα(¯x − ¯c).

Note that if α is a basis for a rank k subgroup G ≤ Zn then Φα is a an isomor-
phism of free abelian groups, and therefore can be represented as multiplication
by an integer matrix (see [1, Chapter 12]). In particular, if ¯c ∈ Zn then Φα,¯c is
deﬁnable in (Z, +, 0).

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

7

Lemma 4.6. Let G ≤ Zn be a subgroup with basis α = {¯a1, . . . , ¯ak}. Fix ¯c ∈ Zn,
and let C = ¯c + G. Then the map D 7→ Φα,¯c(D) is a rank-preserving bijection
between the collection of cosets D in Zn such that D ⊆ C, and the collection of
cosets in Zk.

Proof. First, if D is a coset in Zn and D ⊆ C then D = ¯c + ¯g + H for some ¯g ∈ G
and subgroup H ≤ G. A direct calculation then shows Φα,¯c(D) = Φα(¯g + H) =
Φα(¯g) + Φα(H). So Φα,¯c is injective from the collection of cosets D in Zn such that
D ⊆ C, to the collection of cosets in Zk. Note also that, since Φα is an isomorphism,

rk(Φα,¯c(D)) = rk(Φα(H)) = rk(H) = rk(D).

Finally, to show surjectivity, ﬁx K ≤ Zk and ¯u ∈ Zk. Let H = Φ-1
¯g = Φ-1
¯u + K.

α (K) ≤ G and
α (¯u) ∈ G. Then, setting D = ¯c + ¯g + H, we have D ⊆ C and Φα,¯c(D) =
(cid:3)

Corollary 4.7. Let G ≤ Zn be a subgroup with basis α = {¯a1, . . . , ¯ak}. Fix ¯c ∈ Zn,
and let C = ¯c + G. If X ⊆ C then rk(Φα,¯c(X)) = rk(X).

Proof. If X ⊆ C then rk(X) and rk(Φα,¯c(X)) are both bounded above by k =
rk(C). Moreover, in the computation of rk(X) it suﬃces to only consider cosets
of Zn which are subsets of C. Given m ≤ k and a subset X ⊆ C, it follows from
Lemma 4.6 that Φα,¯c(X) is contained in a ﬁnite union of cosets in Zk of rank at
most m if and only if X is contained in a ﬁnite union of cosets in Zn, which are
subsets of C and have rank at most m. By deﬁnition, rk(Φα,¯c(X)) = rk(X).
(cid:3)

Deﬁnition 4.8. Given 0 ≤ k ≤ n, a subset X ⊆ Zn is a quasi-coset of rank k
if X = C\Z, where C is a coset of rank k and Z ⊆ C is deﬁnable with rk(Z) < k.

Note that any quasi-coset in Zn is deﬁnable in (Z, +, 0) by Fact 4.1.

Theorem 4.9. For any n > 0, if A ⊆ Zn is nonempty and deﬁnable in (Z, +, 0),
then A can be written as a ﬁnite union of quasi-cosets in Zn.

Proof. For brevity, we call a deﬁnable subset A ⊆ Zk good if either A = ∅ or A can
be written as a ﬁnite union of quasi-cosets in Zn. By induction on n ≥ 0, we prove
that any deﬁnable subset in Zn is good (where our convention is Z0 = {0}). The
base case n = 0 is trivial. Fix n > 0 and assume that, for any k < n, any deﬁnable
subset A ⊆ Zk is good.
Claim 1 : If X ⊆ Zn is deﬁnable, with rk(X) < n, then X is good.
Proof : Let k = rk(X) < n. Then X ⊆ C1 ∪ . . . ∪ Cm, where each Ci is a coset in
Zn of rank at most k. If we can show that each X ∩ Ci is good then it will follow
that X is good. Therefore, without loss of generality, we assume X is contained
in a single coset C of rank k. Let C = ¯c + G and ﬁx a basis α = {¯a1, . . . , ¯ak} for
G. Let Φ = Φα,¯c. Then Φ(X) is a deﬁnable subset of Zk, and is therefore good by
induction. So we may write

Φ(X) = E1\W1 ∪ . . . ∪ Em\Wm,

where Ei is a coset in Zk of rank ki ≤ k, and Wi ⊆ Ei is deﬁnable with rk(Wi) =
li < ki. Let Di = Φ-1(Ei) and Zi = Φ-1(Wi). Then

X = D1\Z1 ∪ . . . ∪ Dn\Zm.

By Lemma 4.6, each Di is a coset in Zn of rank ki. By Corollary 4.7, each Zi is a
⊣claim
deﬁnable subset of Di of rank li < ki. Altogether, X is good.

8

GABRIEL CONANT

Claim 2 : Any ﬁnite intersection of quasi-cosets in Zn is good.
Proof : It suﬃces to prove the claim for an intersection of two quasi-cosets X and
Y . Let A = X ∩ Y . By Claim 1, we may assume rk(A) = n. Let X = C\U and
Y = D\V where C, D are cosets in Zn and U, V are deﬁnable with U ⊆ C, V ⊆ D,
rk(U ) < n, and rk(V ) < n. Since A is nonempty, C ∩ D is some coset E in Zn.
Setting Z = E ∩(U ∪V ), we have A = E\Z. Then rk(Z) ≤ min{rk(U ), rk(V )} < n,
which means we must have rk(E) = n. Altogether, A is a quasi-coset of rank n,
⊣claim
and is therefore good.
Claim 3 : Let X ⊆ Zn be a quasi-coset. Then ¬X := Zn\X is good.
Proof : Set X = C\Z, where C is a coset of rank k ≤ n and Z ⊆ C is deﬁnable
with rk(Z) < k. Then ¬X = Z ∪ Zn\C. Note that Z is good by Claim 1, and so
it suﬃces to show that Zn\C is good. If k < n then this is immediate, so we may
assume k = n. Let C = ¯c + G for some ¯c ∈ Zn and rank n subgroup G ≤ Zn. By
Corollary 4.3, G has ﬁnite index in Zn. So Zn\C is a ﬁnite union of cosets, and
⊣claim
therefore good.
We now proceed with the induction step. Since any coset in Zn is good, it suﬃces
by Fact 4.1 to show that the good sets in Zn form a Boolean algebra. Since the
union of two good sets is obviously good, it suﬃces to ﬁx a good set A ⊆ Zn and
prove that ¬A is good. Let

A = X1 ∪ . . . ∪ Xn.

where each Xi is a quasi-coset. Then ¬A = ¬X1 ∩ . . . ∩ ¬Xm. By Claim 3, we may
j is a quasi-coset. If

Y i
j , where Ji is some ﬁnite set and each Y i

write ¬Xi = Sj∈Ji
J = J1 × . . . × Jm then ¬A =S¯∈J Y¯ where, given ¯ ∈ J,

j1 ∩ . . . ∩ Y m
jm

Y¯ = Y 1

.

By Claim 2, each Y¯ is good. Altogether, ¬A is good, as desired.

(cid:3)

5. Polyhedra and inscribed balls

Throughout the section we work in Rn for a ﬁxed n > 0.

Deﬁnition 5.1.

(1) A function f : Rn −→ R is an aﬃne transformation if it is of the form

n

f (¯x) = u +

aixi,

Xi=1

for some u, a1, . . . , an ∈ R.
1 ≤ i ≤ n then f is constant.

If u = 0 then f is linear.

If ai = 0 for all

(2) Given a non-constant aﬃne transformation f : Rn −→ R, we deﬁne the

associated aﬃne hyperplane

H(f ) = {¯x ∈ Rn : f (¯x) = 0},

as well as the associated half-spaces

H +(f ) = {¯x ∈ Rn : f (¯x) > 0},
H −(f ) = {¯x ∈ Rn : f (¯x) < 0},
H +(f ) = {¯x ∈ Rn : f (¯x) ≥ 0},
H −(f ) = {¯x ∈ Rn : f (¯x) ≤ 0}.

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

9

(3) A polyhedron in Rn is an intersection of ﬁnitely many half-spaces.3

(4) Given a non-constant linear function f (¯x) = Pn

we deﬁne the plank
S(f, u, v) = {¯x ∈ Rn : u ≤ f (¯x) ≤ v} = H +(f − u) ∩ H −(f − v).
The thickness of the plank S(f, u, v) is u−v
hyperplanes H(f − u) and H(f − v).

|¯a| , i.e., the distance between the

i=1 aixi, and u < v in R,

(5) Given ¯x ∈ Rn and r ≥ 0, we deﬁne the closed ball

Br(¯x) = {¯y ∈ Rn : d(¯x, ¯y) ≤ r}.

(6) The inradius of a convex set P ⊆ Rn is

r(P ) = sup{r ≥ 0 : Br(¯x) ⊆ P for some ¯x ∈ Rn} ∈ R≥0 ∪ {∞}.

For example, if B is a ball of radius r then r(B) = r. If S is a plank of thickness
t then r(S) = t
2 . Moreover, if P ⊆ Rn is convex then r(P ) = 0 if and only if P has
no interior. In particular, any hyperplane, or more generally, any aﬃne translation
of a proper vector subspace of Rn, is a closed polyhedron with inradius 0.

In this section, we derive some consequences, to be used later, of the following

result on convex sets and inscribed balls.

Fact 5.2. (Kadets [8] 2005) Suppose Q, P1, . . . , Pk are closed convex sets in Rn,

with nonempty interior. If Q ⊆ P1 ∪ . . . ∪ Pk then r(Q) ≤Pk

This fact has its roots in a 1932 result of Tarski [19], which essentially deals
with the case in R2 where the Pi are parallel planks. The generalization of Tarski’s
result to Rn was given by Bang [3] in 1951.

i=1 r(Pi).

The following is an immediate consequence of Fact 5.2.

Corollary 5.3. Suppose Q, P1, . . . , Pk are polyhedra in Rn and Q ⊆ P1 ∪ . . . ∪ Pk.
If r(Q) = ∞ then r(Pi) = ∞ for some 1 ≤ i ≤ k.

First, we show that if P is a polyhedron of inﬁnite inradius, deﬁned by some
ﬁnite intersection of half-spaces, then the “opposite” polyhedron, deﬁned by the
intersection of the opposite sides of the same half-spaces, also has inﬁnite inradius.
For a more workable notation, given an aﬃne transformation f : Rn −→ R and
• ∈ {+, −}, we let H •

1 (f ) = H •(f ) and H •

0 (f ) = H •(f ).

Lemma 5.4. Suppose f1, . . . , fk are linear functions from Rn to R and b1, . . . , bk ∈
R. Fix η : {1, . . . , k} −→ {0, 1} and deﬁne

P + =

H +

η(i)(fi − bi) and P − =

k

\i=1

Then r(P +) = ∞ if and only if r(P −) = ∞.

H −

η(i)(fi − bi).

k

\i=1

Proof. Without loss of generality, it suﬃces to assume r(P +) = ∞ and prove
r(P −) = ∞. Deﬁne

Q =

k

\i=1

H −

η(i)(fi + bi).

3We are making a slight departure from standard conventions in allowing polyhedra to be

deﬁned by possibly open half-spaces.

10

GABRIEL CONANT

For any ¯x ∈ Rn, ¯x ∈ P + if and only if -¯x ∈ Q. Since ¯x 7→ -¯x is an isometry of Rn,
it follows that r(Q) = r(P +) = ∞.

Given 1 ≤ i ≤ k, deﬁne

S(fi, -bi, bi)\H(f − bi)
S(fi, -bi, bi)
S(fi, bi, -bi)
S(fi, bi, -bi)\H(fi − bi)

Si =

η(i)(fi − bi) =(H −

H −

Then, for any 1 ≤ i ≤ k, we have

if bi ≥ 0 and η(i) = 0
if bi ≥ 0 and η(i) = 1
if bi < 0 and η(i) = 0
if bi < 0 and η(i) = 1.

η(i)(fi + bi) ∪ Si
η(i)(fi + bi)\Si

H −

if bi ≥ 0
if bi < 0.

Therefore, we may write

P − = A ∪ \bi≥0

H −

η(i)(fi + bi) ∪ \bi<0

H −

η(i)(fi + bi)\S,

where A is some subset of Rn and S =Sbi<0 Si. In particular, Q ⊆ P − ∪ S. Since

S is a ﬁnite union of polyhedra, each of ﬁnite inradius, and r(Q) = ∞, it follows
from Corollary 5.3 that r(P −) = ∞.
(cid:3)

Finally, we show that the integer points on a polyhedron of inﬁnite inradius
cannot be covered by ﬁnitely many polyhedra of ﬁnite inradii, even after removing
some deﬁnable small-rank subset of the integer points.

Lemma 5.5. Suppose X ⊆ Zn is deﬁnable in (Z, +, 0), with rk(X) < n. Let
P ⊆ Rn be a a polyhedron, with r(P ) = ∞. Suppose Q1, . . . , Qk are polyhedra in
Rn such that P ∩ (Zn\X) ⊆ Q1 ∪ . . . ∪ Qk. Then r(Qi) = ∞ for some 1 ≤ i ≤ k.

Proof. By deﬁnition of rank, there are cosets C1, . . . , Cl ⊆ Zn such that X ⊆
C1 ∪ . . . ∪ Cl and, for all 1 ≤ i ≤ l, rk(Ci) = ni < n. For 1 ≤ i ≤ l, let Ci = ¯ci + Gi
for some element ¯ci ∈ Zn and subgroup Gi ≤ Zn of rank ni. Let VGi be the convex
closure of Gi in Rn, and note that VGi is an ni-dimensional subspace of Rn. Set
Ri = ¯c + VGi . Then Ri is a polyhedron with r(Ri) = 0 and Ci ⊆ Ri. Altogether,

(†)

P ∩ Zn ⊆ Q1 ∪ . . . ∪ Qk ∪ R1 ∪ . . . ∪ Rl.

Using an inductive argument, it is straightforward to show that the collection
of subsets of Rn, which can be written as a ﬁnite union of polyhedra, is a Boolean
algebra. Therefore, we may write

(††)

P \(Q1 ∪ . . . ∪ Qk ∪ R1 ∪ . . . ∪ Rl) = S1 ∪ . . . ∪ Sm,

for some polyhedra S1, . . . , Sm. Note that Si ⊆ P for all 1 ≤ i ≤ m, and we have

P ⊆ Q1 ∪ . . . ∪ Qk ∪ R1 ∪ . . . ∪ Rl ∪ S1 ∪ . . . ∪ Sm.

By Corollary 5.3, and since r(Ri) = 0 for all 1 ≤ i ≤ l, it follows that either
r(Qi) = ∞ for some 1 ≤ i ≤ k or r(Si) = ∞ for some 1 ≤ i ≤ m. Suppose, toward
a contradiction, that r(Si) = ∞ for some 1 ≤ i ≤ m. Then we may ﬁnd a point
¯x ∈ Si ∩ Zn. But then ¯x ∈ Si ∩ (P ∩ Zn), which contradicts (†) and (††).
(cid:3)

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

11

6. Cell decomposition for Presburger sets

In this section, we brieﬂy summarize the cell decomposition of sets deﬁnable in

(Z, +, <, 0), which is a result of Cluckers [4]. Recall that Z∗ = Z ∪ {-∞, ∞}.

Deﬁnition 6.1. Fix n > 0.

(1) A function f : Zn −→ Z∗ is extreme if f (¯x) = ∞ for all ¯x ∈ Zn or
f (¯x) = -∞ for all ¯x ∈ Zn. If f is extreme and c ∈ Z then, by convention,
we let f + c = f .

(2) A partial function f : Zn −→ Z is standard Z-linear if there are ¯m, ¯c ∈ Nn

such that ci < mi for all 1 ≤ i ≤ n, dom(f ) = ¯c + ¯mZn, and

f (¯x) = u +

for some u ∈ Z and ¯a ∈ Zn.

n

Xi=1

mi (cid:19) ,
ai(cid:18) xi − ci

(3) A partial function f : Zn −→ Z∗ is Z-linear if it is either extreme or

standard Z-linear.

Deﬁnition 6.2. Given η ∈ 2<ω\{∅}, we deﬁne, by induction on |η|, the notion of
an η-cell in Z|η|.

(1) A (0)-cell is a singleton {x} for some x ∈ Z.
(2) A (1)-cell is an inﬁnite set of the form

[a, b]c

m := {x ∈ Z : a ≤ x ≤ b, x ≡m c}.

where a, b ∈ Z∗ and m, c ∈ N with c < m.

(3) Given η ∈ 2<ω\{∅}, an (η, 0)-cell is a set of the form

X[f ] := {(¯x, y) ∈ Z|η|+1 : ¯x ∈ X, f (¯x) = y},

where X ⊆ Z|η| is an η-cell and f is a standard Z-linear function with
X ⊆ dom(f ).

(4) Given η ∈ 2<ω\{∅}, an (η, 1)-cell is a set of the form

X[f, g]c

m := {(¯x, y) ∈ Z|η|+1 : ¯x ∈ X, y ∈ [f (¯x), g(¯x)]c

m},

where X ⊆ Z|η| is an η-cell, f, g are Z-linear functions such that X ⊆
dom(f ) ∩ dom(g), f (¯x) ≤ g(¯x) for all ¯x ∈ X, c, m ∈ N with c < m, and
there is no uniform ﬁnite bound on the sets [f (¯x), g(¯x)]c

m for ¯x ∈ X.

The following is (a slightly weaker version of) Cluckers’ cell decomposition [4].

Fact 6.3. Any Presburger set in Zn can be written as a ﬁnite union of cells in Zn.

The distinction between (η, 0)-cells and (η, 1)-cells will not be essential for our
work. In particular, if X[f ] is an (η, 0)-cell then, since X[f ] = X[f, f ]0
1, we can
view X[f ] as a “ﬂat” (η, 1)-cell. Precisely, all we will need from cell decomposition
is the following corollary.

Corollary 6.4. Given n > 0, if A ⊆ Zn+1 is a Presburger set then

k

where, for all 1 ≤ t ≤ k, Xt ⊆ Zn is a Presburger set, ft, gt are Z-linear functions
such that Xt ⊆ dom(ft) ∩ dom(gt), and mt, ct ∈ N with ct < mt.

[t=1

A =

Xt[ft, gt]ct
mt

,

12

GABRIEL CONANT

Remark 6.5. A crucial observation is that any standard Z-linear function is de-
ﬁnable in (Z, +, 0). We will use this fact constantly in the subsequent arguments,
and without further mention.

7. Technical reductions toward the main proof

In this section, we develop the technical tools necessary to prove the induction
step of Theorem 2.4. Therefore, throughout the section, we ﬁx an integer n > 0
and consider Presburger sets in Zn+1.

The goal of this section is to isolate a subclass of Presburger sets in Zn+1, satis-
fying certain structural assumptions, such that, in order to prove the induction step
of Theorem 2.4, it suﬃces to only consider sets in this special subclass (see Corol-
lary 7.10 for the precise statement). Roughly speaking, we apply a series of three
reductions, starting with a Presburger set A ⊆ Zn+1 of the form given by Corollary
6.4. Our ﬁrst reduction will be to “sort” the congruence classes ct (mod mt) so that
we may assume all mt’s are the same and all ct’s are 0. The second reduction is to
separate inﬁnite ﬁbers from ﬁnite ﬁbers, and show that it suﬃces to assume A has
ﬁnite ﬁbers. The third reduction is to identify the endpoints of the intervals in the
ﬁbers of A, and show that it suﬃces to assume there is a single ﬁnite collection of
standard Z-linear functions, which, up to some permutation, precisely determine
the endpoints of any ﬁber of A.

For the sake of brevity, we will use the following terminology.

Deﬁnition 7.1. For any n > 0, a Presburger set A ⊆ Zn is peripheral if either
A is deﬁnable in (Z, +, 0) or A deﬁnes the ordering.

Also, given an integer k > 0, we let [k] denote the set {1, . . . , k}.

7.1. Sorting congruence classes. To simplify notation, given X[f, g]c
inition 6.2, if c = 0 then we omit it and write X[f, g]m.

m as in Def-

Deﬁnition 7.2. A set A ⊆ Zn+1 is uniformly congruent if

k

A =

Xt[ft, gt]m,

[t=1

where m > 0 and, for all t ∈ [k], Xt ⊆ Zn is a Presburger set and ft, gt are Z-linear
functions such that Xt ⊆ dom(ft) ∩ dom(gt).

Proposition 7.3. Suppose A ⊆ Zn+1 is a Presburger set. Then A is interdeﬁnable
with a ﬁnite sequence of uniformly congruent Presburger sets in Zn+1.

Proof. By Corollary 6.4, we may write

k

A =

Xt[ft, gt]ct

mt ,

[t=1

where, for all 1 ≤ t ≤ k, Xt ⊆ Zn is a Presburger set, ft, gt are Z-linear functions
such that Xt ⊆ dom(ft) ∩ dom(gt), and mt, ct ∈ N with ct < mt. Let m be the
least common multiple of m1, . . . , mk. Given 0 ≤ d < m, we let

Ad = {(¯x, y) ∈ A : y ≡m d}.

Then A =S0≤d<m Ad and each Ad is deﬁnable from A.

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

13

Claim: Given 0 ≤ d < m there is a set Id ⊆ [k] such that

Xt[ft, gt]d

m.

Ad = [t∈Id
mt . Then Ad = St∈Id

Proof : Let Id = {t ∈ [k] : Ad ∩ Xt[ft, gt]ct
mt
Ad ∩ Xt[ft, gt]ct
Xt[ft, gt]d
Since mt divides m, it follows that d ≡mt ct. Therefore, if (¯x, y) ∈ Xt[ft, gt]d
y ≡m d, and so y ≡mt ct, which means (¯x, y) ∈ Xt[ft, gt]ct
Bt = Xt[ft, gt]d

6= ∅} and, for t ∈ Id, let Bt =
Bt. Fix t ∈ Id. We immediately have Bt ⊆
m. By assumption, there is (¯x, z) ∈ Bt and so z ≡mt ct and z ≡m d.
m then
mt ∩ Ad = Bt. Altogether,
⊣claim
Now, for 0 ≤ d < m, set Cd = {(¯x, y−d) : (¯x, y) ∈ Ad}. Then Cd is interdeﬁnable

m.

with Ad, and so, altogether, A is interdeﬁnable with (Cd)0≤d<m. Moreover,

Xt[ft − d, gt − d]m.

Cd = [t∈Id

In particular, each Cd is uniformly congruent.

(cid:3)

From this result, we obtain our ﬁrst reduction.

Corollary 7.4. If every uniformly congruent Presburger set in Zn+1 is peripheral,
then every Presburger set in Zn+1 is peripheral.

7.2. Eliminating inﬁnite ﬁbers. Similar to before, given a, b ∈ Z∗ and m > 0,
we let [a, b]m = [a, b]0

m.

Deﬁnition 7.5. Let A ⊆ Zn+1 be a Presburger set.

(1) Let π(A) = {¯x ∈ Zn : (¯x, y) ∈ Zn+1 for some y ∈ Z} be the projection of

A to Zn.

(2) Given ¯x ∈ Zn, deﬁne the ﬁber A¯x = {y ∈ Z : (¯x, y) ∈ A}. In particular,

A¯x 6= ∅ if and only if ¯x ∈ π(A).

(3) Fix m > 0 and ﬁnite sets of standard Z-linear functions F = {f1, . . . , fk}
and G = {g1, . . . , gl} for some k, l > 0. We say A has weakly sorted ﬁbers
(witnessed by (F, G, m)) if, for all ¯x ∈ π(A), there is some I(¯x) ⊆ [k] × [l]
such that:

(i) ¯x ∈ dom(fs) ∩ dom(gt) and fs(¯x) ≤ gt(¯x) for all (s, t) ∈ I(¯x), and

(ii) A¯x =S(s,t)∈I(¯x)[fs(¯x), gt(¯x)]m.

Note that, since we assume the functions in F and G are standard, it follows

that if A ⊆ Zn+1 has weakly sorted ﬁbers then A¯x is ﬁnite for all ¯x ∈ Zn.

Proposition 7.6. Assume every Presburger set in Zn is peripheral. Suppose A ⊆
Zn+1 is a uniformly congruent Presburger set. Then A is interdeﬁnable with a ﬁnite
sequence of Presburger sets in Zn+1 with weakly sorted ﬁbers.

Proof. First, if A deﬁnes the ordering then it is interdeﬁnable with N × {0}n, which
has weakly sorted ﬁbers. So we may assume A does not deﬁne the ordering.

By assumption A = Sk

t=1 Xt[ft, gt]m for some Xt, ft, gt and m > 0. Note that
all ﬁbers of A are deﬁnable from A, and therefore Presburger deﬁnable subsets of
Z, which do not deﬁne the ordering. It follows from Corollary 3.4 that any inﬁnite
ﬁber of A is unbounded above and below.

14

GABRIEL CONANT

Let X = π(A), and note that X is deﬁnable from A. Given ¯x ∈ X, let I(¯x) =
In particular, if ¯x ∈ X then ¯x ∈ dom(ft) ∩ dom(gt) for all

{(t, t) : ¯x ∈ Xt}.
(t, t) ∈ I(¯x) and, moreover,

(†)

A¯x = [(t,t)∈I(¯x)

[ft(¯x), gt(¯x)]m.

Set Y1 = {¯x ∈ X : A¯x is inﬁnite} and Y2 = X\Y1.
Claim: For any ¯x ∈ Zn, ¯x ∈ Y1 if and only if A¯x + A¯x = mZ.
Proof : Clearly, if A¯x + A¯x = mZ then A¯x is inﬁnite and so ¯x ∈ Y1. Conversely,
suppose ¯x ∈ Y1. As previously noted, it follows from Corollary 3.4 that A¯x is
unbounded above and below. Combined with (†), there must be s, t ∈ I(¯x) such that
fs = -∞ and gt = ∞, which means there are a, b ∈ Z such that A¯x ∪ [a, b]m = mZ.
Fix z ∈ mZ and choose y ∈ mZ such that y > max{b, z − a}. If x = z − y then
x, y ∈ A¯x and x + y = z. Altogether, A¯x + A¯x = mZ.
⊣claim
It follows from the proof of the claim that if ¯x ∈ Y1 then A¯x is coﬁnite in mZ.

By the claim, Y1 is deﬁnable from A, and therefore so is Y2. For i ∈ {1, 2}, let

Ai = {(¯x, y) ∈ A : ¯x ∈ Yi}.

Then A = A1 ∪ A2 and so A is interdeﬁnable with (A1, A2).

We ﬁrst show that A2 has weakly sorted ﬁbers. Let F be the set of standard ft,
and G the set of standard gt. By (†), if ¯x ∈ Y2 = π(A2) and (t, t) ∈ I(¯x), then ft
and gt are standard. Therefore A2 has weakly sorted ﬁbers, witnessed by (F, G, m).
To ﬁnish the proof, we assume A1 6= ∅ (i.e. X1 6= ∅) and show that A1 is
interdeﬁnable with a set B ⊆ Zn+1 with weakly sorted ﬁbers. In particular, let
B = (Y1 × mZ)\A1 (and so A1 = (Y1 × mZ)\B). Since Y1 ⊆ Zn is deﬁnable
from A, and A does not deﬁne the ordering, it follows that Y1 does not deﬁne the
ordering and therefore is deﬁnable in (Z, +, 0) by assumption. Therefore A1 and B
are interdeﬁnable.

Let F ∗ = {ft − 1 : ft ∈ F } and G∗ = {gt + 1 : gt ∈ G}. If ¯x ∈ π(B) ⊆ X1 then,

using (†), we have

B¯x = mZ\A¯x = \(t,t)∈I(¯x)(cid:18)[-∞, ft(¯x) − 1]m ∪ [gt(¯x) + 1, ∞]m(cid:19).

On the other hand, if ¯x ∈ π(B) then A¯x is coﬁnite in mZ, and so B¯x is ﬁnite.
Therefore, (G∗, F ∗, m) witnesses that B has weakly sorted ﬁbers.
(cid:3)

Combined with Corollary 7.4, we obtain our next reduction.

Corollary 7.7. Assume every Presburger set in Zn is peripheral. If every Pres-
burger set in Zn+1, with weakly sorted ﬁbers, is peripheral, then every Presburger
set in Zn+1 is peripheral.

7.3. Identifying ﬁbers up to permutation of boundary points. Given k > 0,
let Sk denote the group of permutations of [k].

Deﬁnition 7.8. Fix m > 0.

(1) Deﬁne the binary relations <m and ⊳m on Z by

a <m b ⇔ a < x < b for some x ∈ mZ,
a ⊳m b ⇔ a ≤ x ≤ b for some x ∈ mZ.

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

15

(2) Given x ∈ Z, let ρm(x) be the unique element of {0, 1, . . . , m − 1} such that

x ≡m ρm(x). Deﬁne Lm, Rm, L−

m, R−

m : Z −→ mZ such that

Lm(x) = max{y ∈ mZ : y ≤ x} = x − ρm(x),
Rm(x) = min{y ∈ mZ : x ≥ y} = x + ρm(-x),
L−
m(x) = max{y ∈ mZ : y < x} = Lm(x) − m,
R+
m(x) = max{y ∈ mZ : y > x} = Rm(x) + m.

Note that Rm, L−

m, and R−

m are all deﬁnable in (Z, +, 0).

(3) Suppose A ⊆ Zn+1 is is a Presburger set. Fix m > 0 and ﬁnite tuples of
standard Z-linear functions ¯f = (f1, . . . , fk) and ¯g = (g1, . . . , gk) on Zn,
for some k > 0. Then A has sorted ﬁbers (witnessed by ( ¯f , ¯g, m)) if
π(A) ⊆ dom(ft) ∩ dom(gt) for all t ∈ [k] and, for all ¯x ∈ π(A), there are
σ, τ ∈ Sk such that

(i) fσ(t)(¯x) ⊳m gτ (t)(¯x) for all 1 ≤ t ≤ k,
(ii) gτ (t)(¯x) <m fσ(t+1)(¯x) for all 1 ≤ t < k,

(iii) A¯x =Sk

t=1[fσ(t)(¯x), gτ (t)(¯x)]m.

Proposition 7.9. Suppose A ⊆ Zn+1 is a Presburger set with weakly sorted ﬁbers,
witnessed by (F, G, m). Then A is interdeﬁnable with a ﬁnite sequence (Bi) of
Presburger sets in Zn+1 such that each Bi has sorted ﬁbers witnessed by some
( ¯f i, ¯gi, m), with | ¯f i| = |¯gi| ≤ min{|F |, |G|}.

Proof. Let F = {f1, . . . , fk} and G = {g1, . . . , gl}. For ¯x ∈ π(A), let I(¯x) ⊆ [k] × [l]
be as in Deﬁnition 7.5(3), and let I1(¯x) and I2(¯x) be the projections to the ﬁrst
and the second coordinate, respectively. Deﬁne the sets

A− = {(¯x, y) ∈ A : (¯x, L−

m(y)) 6∈ A} and A+ = {(¯x, y) ∈ A : (¯x, R+

m(y)) 6∈ A}.

Note that A− and A+ are each deﬁnable from A.
Claim: For any ¯x ∈ Zn,

A−

¯x ⊆ {Rm(fs(¯x)) : s ∈ I1(¯x)} and A+

¯x ⊆ {Lm(gt(¯x)) : t ∈ I2(¯x)}.

m(y)) 6∈ A, we must have L−

Proof : Fix ¯x ∈ Zk. Suppose y ∈ A−
¯x . Then y ∈ [fs(¯x), gt(¯x)]m for some (s, t) ∈
I(¯x). Since (¯x, L−
m(y) < fs(¯x) ≤ y. Since y ∈ mZ, it
follows that y = Rm(fs(¯x)). The proof of the second containment is similar. ⊣claim
Let P = P([k] × [l]) denote the powerset of [k] × [l]. Given (α, β) ∈ P, deﬁne
α ⊆ Zk such that ¯x ∈ Y β
Y β
α if and only if:
(i) ¯x ∈ π(A), α ⊆ I1(¯x), and β ⊆ I2(¯x),
(ii) A−
(iii) A+
(iv) for all distinct s, t ∈ α, Rm(fs(¯x)) 6= Rm(ft(¯x)), and
(v) for all distinct s, t ∈ β, Lm(gs(¯x)) 6= Lm(gt(¯x)).

¯x = {Rm(ft(¯x)) : t ∈ α},
¯x = {Lm(gt(¯x)) : t ∈ β},

Then Y β

α is deﬁnable from A and, moreover, it follows from the claim that

π(A) = [(α,β)∈P

Y β
α .

α = {(¯x, y) ∈ A : ¯x ∈ Y β

α }. Let Σ = {(α, β) ∈ P : Bβ

α 6= ∅}.

Given (α, β) ∈ P, set Bβ
Then

A = [(α,β)∈Σ

Bβ
α,

16

GABRIEL CONANT

and so A is interdeﬁnable with (Bβ
α)(α,β)∈Σ. Given α ⊆ [k] and β ⊆ [l], deﬁne
¯f α = (fs)s∈α and ¯gβ = (gt)t∈β. To ﬁnish the proof, we ﬁx (α, β) ∈ Σ and show
α has sorted ﬁbers, witnessed by ( ¯f α, ¯gβ, m). To ease notation, let
|α| = |β| and Bβ
Y = Y β
α. Without loss of generality, we also assume α = [p1] and
β = [p2] for some p1 ≤ k and p2 ≤ l.

α and B = Bβ

Fix ¯x ∈ Y . We have

B¯x = A¯x = [(s,t)∈I(¯x)

[fs(¯x), gt(¯x)]m.

Therefore we can write B¯x as a union

p

B¯x =

[at, bt]m,

[t=1

where {a1, . . . , ap} ⊆ {f1(¯x), . . . , fk(¯x)}, {b1, . . . , bp} ⊆ {g1(¯x), . . . , gl(¯x)}, and

a1 ⊳m b1 <m a2 ⊳m b2 <m . . . <m ap ⊳m bp.

Altogether, we want to show p1 = p = p2 and there are σ, τ ∈ Sp such that,
for all 1 ≤ t ≤ p, at = fσ(t)(¯x) and bt = gτ (t)(¯x). To see this, ﬁrst observe
that Rm(a1), . . . , Rm(ap) are distinct elements in A−
¯x and Lm(b1), . . . , Lm(bp) are
distinct elements in A+
¯x , and so ft(¯x) is
a left endpoint of some interval in

¯x . Moreover, if t ∈ α then Rm(ft(¯x)) ∈ A−

I = {[a1, b1]m, . . . , [ap, bp]m}.

Similarly, if t ∈ β then Lm(gt(¯x)) ∈ A+
interval in I. Therefore,

¯x , and so gt(¯x) is a right endpoint of some

{Rm(a1), . . . , Rm(ap)} = {Rm(ft(¯x)) : 1 ≤ t ≤ p1} and
{Lm(b1), . . . , Lm(bp)} = {Lm(gt(¯x)) : 1 ≤ t ≤ p2},

as desired.

(cid:3)

Combined with Corollary 7.7, we have our third and ﬁnal reduction.

Corollary 7.10. Assume every Presburger set in Zn is peripheral. If every Pres-
burger set in Zn+1, with sorted ﬁbers, is peripheral, then every Presburger set in
Zn+1 is peripheral.

7.4. Exchanging parallel functions. In the proof of the main result, we will use
Corollary 7.10 to focus on Presburger sets in Zn+1 with sorted ﬁbers. Given such a
set A, we will assume A does not deﬁne the ordering and prove that A is deﬁnable
in (Z, +, 0). In this section, we prove one ﬁnal technical result, which will allow us
to argue by induction on the number of Z-linear functions used to determine the
ﬁbers of A.
Lemma 7.11. Suppose A ⊆ Zn+1 has sorted ﬁbers, witnessed by ( ¯f , ¯g, m), where
¯f = (f1, . . . , fk) and ¯g = (g1, . . . , gk). Assume π(A) is deﬁnable in (Z, +, 0), and
suppose there are s, t ∈ {1, . . . , k} such that fs − gt is constant on π(A).
(a) Assume gt = fs + c on π(A), for some c ≥ 0, and set

B = {(¯x, y) ∈ A : fs(¯x) ≤ y ≤ gt(¯x)}.

Then B is deﬁnable in (Z, +, 0).

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

17

(b) If k > 1 then A is interdeﬁnable with a ﬁnite sequence of Presburger sets (Bi)
in Zn+1 such that each Bi has sorted ﬁbers, witnessed by some ( ¯f i, ¯gi, m) with
| ¯f i| = |¯gi| < k.

Proof. Without loss of generality, we may assume fk − gk is constant on π(A).

Part (a). Given 1 ≤ p ≤ k, deﬁne the set

Ip = {(i1, j1, . . . , ip, jp) ∈ Z2p : 0 = i1 ≤ j1 ≤ i2 ≤ j2 ≤ . . . ≤ ip ≤ jp = c}.

We claim that (¯x, y) ∈ B if and only if

(1) ¯x ∈ π(A) and y ∈ mZ, and
(2) there are

(i) an integer 1 ≤ p ≤ k,
(ii) injective functions σ, τ : [p] −→ [k], with σ(1) = k and τ (p) = k, and
(iii) a tuple (i1, j1, . . . , ip, jp) ∈ Ip,
such that
• for all 1 ≤ t ≤ p, fσ(t)(¯x) = fk(¯x) + it and gτ (t)(¯x) = fk(¯x) + jt,
• for all s ∈ [k]\ Im σ and t ∈ [k]\ Im τ , neither fs(¯x) nor gt(¯x) is in

[fk(¯x), gk(¯x)], i.e.,

c

^i=0(cid:2)(fs(¯x) 6= fk(¯x) + i) ∧ (gt(¯x) 6= fk(¯x) + i)(cid:3), and

t=1[fσ(t)(¯x), gτ (t)(¯x)], i.e.,

• y ∈Sp

p

jt

_t=1

_i=it

y = fk(¯x) + i.

In particular, since π(A) is deﬁnable in (Z, +, 0) by assumption, this shows that B
is deﬁnable in (Z, +, 0).

To verify that the above data deﬁnes B, ﬁx (¯x, y) ∈ B. Then fk(¯x) ≤ gk(¯x) and
so, since A has sorted ﬁbers, we may ﬁx some p ≤ k for which there are distinct
u1, . . . , up ∈ [k] and distinct v1, . . . , vp ∈ [k] such that:
(∗)1 fk(¯x) = fu1(¯x) ⊳m gv1(¯x) <m . . . <m fup (¯x) ⊳m gup (¯x) = gk(¯x),
(∗)2 for all s 6∈ {u1, . . . , up} and t 6∈ v1, . . . , vp}, neither fs(¯x) nor gt(¯x) is in

[fk(¯x), gk(¯x)], and

(∗)3 A¯x ∩ [fk(¯x), gk(¯x)] =Sp

t=1[fut (¯x), gvt (¯x)]m.

Therefore, letting σ : t 7→ ut, τ : t 7→ vt, and setting it = fut (¯x) − fk(¯x) and
jt = gvt(¯x) − fk(¯x), we have properties (1) and (2) above.

Conversely, suppose (¯x, y) ∈ Zn+1 satisﬁes properties (1) and (2) above, wit-

nessed by 1 ≤ p ≤ k, σ, τ , and (i1, j1, . . . , ip, jp) ∈ Ip. Then we have
• fk(¯x) = fσ(1)(¯x) ≤ gτ (1)(¯x) ≤ . . . ≤ fσ(p)(¯x) ≤ gτ (p)(¯x) = gk(¯x),
• for all s ∈ [k]\ Im σ and t ∈ [k]\ Im τ , neither fs(¯x) nor gt(¯x) is in [fk(¯x), gk(¯x)],

and

t=1[fσ(t)(¯x), gτ (t)(¯x)]m.

• y ∈Sp
Therefore, it suﬃces to show that A¯x ∩ [fk(¯x), gk(¯x)] = Sp

t=1[fσ(t)(¯x), gτ (t)(¯x)]m.
Since ¯x ∈ π(A), there are 1 ≤ p∗ ≤ k, distinct u1, . . . , up∗ ∈ [k], and distinct
v1, . . . , vp∗ ∈ [k] satisfying (∗)1 through (∗)3 above. We want to show that p = p∗
and, for all 1 ≤ t ≤ p, ut = σ(t) and vt = τ (t). First,

p = |{1 ≤ t ≤ k : ft(¯x) ∈ [fk(¯x), gk(¯x)]}| = p∗.

18

GABRIEL CONANT

Next, we have
• fk(¯x) = fu1(¯x) ⊳m gv1(¯x) <m . . . <m fup (¯x) ⊳m gup (¯x) = gk(¯x), and
• fk(¯x) = fσ(1)(¯x) ≤ gτ (1)(¯x) ≤ . . . ≤ fσ(p)(¯x) ≤ gτ (p)(¯x) = gk(¯x).
Therefore it must be the case that, for all 1 ≤ t ≤ p, we have ut = σ(t) and
vt = τ (t).

Part (b). We continue to assume s = t = k. Suppose ﬁrst that gk = fk + c for
some c ≥ 0, and let B be as in part (a). Then A is interdeﬁnable with A∗ := A\B.
If ¯x ∈ π(A∗) then, since A has sorted ﬁbers, there are σ, τ ∈ Sk such that
• fσ(1)(¯x) ⊳m fτ (1)(¯x) <m . . . <m fσ(k)(¯x) ⊳m gτ (k)(¯x), and

t=1[fσ(t)(¯x), gτ (t)(¯x)]m.

• A¯x =Sk

¯x =Sp

Therefore, for some 1 ≤ p ≤ k − 1, there are distinct s1, . . . , sp ∈ [k − 1] and distinct
t1, . . . , tp ∈ [k − 1] such that
• fs1(¯x) ⊳m ft1(¯x) <m . . . <m fsp (¯x) ⊳m gtp (¯x), and
• A∗
In particular, if F = {f1, . . . , fk−1} and G = {g1, . . . , gk−1}, then A∗ has weakly
sorted ﬁbers witnessed by (F, G, m). By Proposition 7.9, A∗ is interdeﬁnable with
a ﬁnite sequence (Bi) of Presburger sets, where each Bi has sorted ﬁbers witnessed
by some ( ¯f i, ¯gi, m), with | ¯f i| = |¯gi| ≤ k − 1.

j=1[fsj (¯x), gtj (¯x)]m.

Now, we must prove the other case: gk = fk + c for some c < 0. The argument
is similar, and equally technical, so we sketch the proof and leave the details to the
reader. First, set

B = {(¯x, y) 6∈ A : gk(¯x) ≤ y ≤ fk(¯x), y ∈ mZ}.

Then, using a similar argument as in part (a), one shows that B is deﬁnable in
(Z, +, 0), and so A is interdeﬁnable with A∗ = A ∪ B. Moreover, similar to the ﬁrst
case, A∗ has weakly sorted ﬁbers, witnessed by (F, G, m) where F = {f1, . . . , fk−1}
and G = {g1, . . . , gk−1}. The result then follows from Proposition 7.9 as in the ﬁrst
case.
(cid:3)

8. Proof of the main result

In this section, we prove Theorem 2.4 by induction on n. The base case n = 1
was done in Corollary 3.3. So ﬁx n > 0 and, for a primary induction hypothesis,
assume that if B ⊆ Zn is a Presburger set then either B is deﬁnable in (Z, +, 0) or
B deﬁnes the ordering.

Claim 8.1. Fix a Presburger set A ⊆ Zn+1, which has sorted ﬁbers, witnessed
by ( ¯f , ¯g, m), where ¯f = (f1, . . . , fk) and ¯g = (g1, . . . , gk) are tuples of standard
Z-linear functions. Assume X := π(A) is a quasi-coset in Zn. Then there are
s, t ∈ {1, . . . , k} such that fs − gt is constant on X.

Proof. Suppose not. Let X = C\Z where C is a coset of rank n∗ ≤ n and Z ⊆ C
is deﬁnable in (Z, +, 0), with rk(Z) < n∗. Let C = ¯c + G where G ≤ Zn is a
subgroup with basis α = {¯a1, . . . , ¯an∗}. Set Φ = Φα,¯c|X , and let W = Φ(Z). Then
Φ : X −→ Zn∗ is an injective function with Im(Φ) = Zn∗\W . By Corollary 4.7,
rk(W ) < n∗. Let Y = Zn∗\W .

For 1 ≤ t ≤ k, deﬁne

˜ft = ft ◦ Φ-1 and ˜gt = gt ◦ Φ-1.

INTERMEDIATE STRUCTURES BETWEEN (Z, +, 0) AND (Z, +, <, 0)

19

Then ˜ft and ˜gt are injective functions from Y to Z. Since Φ : X −→ Y is a bijection,
and A has sorted ﬁbers, it follows that for all ¯x ∈ Y , there are σ, τ ∈ Sk such that

˜fσ(1)(¯x) ≤ ˜gτ (1)(¯x) < . . . < ˜fσ(k)(¯x) ≤ ˜gτ (k)(¯x).

function and Φ-1, which is of the form ¯z 7→ ¯c +Pn∗

For any 1 ≤ t ≤ k, ˜ft and ˜gt are each a composition of a standard Z-linear
i=1 zi¯ai. Therefore ˜ft and ˜gt
determine aﬃne transformations from Rn∗ to R, and our assumption is that ˜fs − ˜gt
is non-constant for all s, t ∈ {1, . . . , k}. Given σ, τ ∈ Sk and • ∈ {+, −}, deﬁne the
polyhedron

k

k−1

P •(σ, τ ) =

\t=1

\t=1

H •(˜gτ (t) − ˜fσ(t)) ∩

H •( ˜fσ(t+1) − ˜gτ (t)).

Then, altogether, we have Y ⊆ Sσ,τ ∈Sk

Fix ¯x ∈ P −(µ, ν) ∩ Y . Then

µ, ν ∈ Sk such that r(P +(µ, ν)) = ∞. Then, by Lemma 5.4, r(P −(µ, ν)) = ∞.

P +(σ, τ ). By Lemma 5.5, we may ﬁx

˜gν(k)(¯x) ≤ ˜fµ(k)(¯x) < . . . < ˜gν(1)(¯x) ≤ ˜fµ(1)(¯x).

On the other hand, there are σ, τ ∈ Sk such that

˜fσ(1)(¯x) ≤ ˜gτ (1)(¯x) < . . . < ˜fσ(k)(¯x) ≤ ˜gτ (k)(¯x).

Then ˜gν(k)(¯x) < ˜gt(¯x) for all t 6= ν(k), and ˜gτ (1)(¯x) < ˜gt(¯x) for all t 6= τ (1), which
means τ (1) = ν(k). But then ˜gν(k)(¯x) ≤ ˜fσ(1)(¯x) ≤ gτ (1)(¯x), and so ˜gν(k)(¯x) =
˜fσ(1)(¯x). Then ˜fσ(1)(¯x) < ˜ft(¯x) for all t 6= µ(k), and so σ(1) = µ(k). Altogether,
we have shown that ˜fµ(k)(¯x) = ˜gν(k)(¯x) for all ¯x ∈ P −(µ, ν) ∩ Y . Therefore ˜fµ(k) =
˜gν(k) on Rn∗ since otherwise P −(µ, ν) ∩ Y would be contained in the hyperplane
H( ˜fµ(k) − ˜gν(k)), contradicting Lemma 5.5.

Now, if ¯x ∈ X then

fµ(k)(¯x) = ˜fµ(k)(Φ(¯x)) = ˜gν(k)(Φ(¯x)) = gν(k)(¯x),

and so fµ(k) = gν(k) on X, which contradicts our original assumption.

(cid:3)

Finally, we proceed with the induction step. Fix a Presburger subset A ⊆ Zn+1,
and assume A does not deﬁne the ordering. We want to show A is deﬁnable in
(Z, +, 0). By Corollary 7.10, we may assume A has sorted ﬁbers witnessed by
( ¯f , ¯g, m), where ¯f = (f1, . . . , fk) and ¯g = (g1, . . . , gk) are tuples of standard Z-
linear functions. We prove, by induction on k, that A is deﬁnable in (Z, +, 0).

Suppose k = 1 and let X = π(A). Then X is deﬁnable from A and therefore
is a Presburger subset of Zn, which does not deﬁne the ordering. By the primary
induction hypothesis, X is deﬁnable in (Z, +, 0). Therefore, by Theorem 4.9, we
may write

X = X1 ∪ . . . ∪ Xp,

where each Xi is a quasi-coset in Zn. For 1 ≤ i ≤ p, let Ai = {(¯x, y) ∈ A : ¯x ∈ Xi}.
i=1 Ai and so A is interdeﬁnable with (Ai)1≤i≤p. Note also that each Ai
still has sorted ﬁbers witnessed by ( ¯f , ¯g, m). Altogether, without loss of generality,
we may assume X = π(A) is a single quasi-coset in Zn.

Then A =Sp

Since A has sorted ﬁbers and k = 1, it follows that, for all ¯x ∈ X, f1(¯x) ≤ g1(¯x)
and A¯x = [f1(¯x), g1(¯x)]m. Therefore, by Claim 8.1, g1 = f1 + c on X for some
c ≥ 0. By Lemma 7.11(a), it follows that A is deﬁnable in (Z, +, 0).

20

GABRIEL CONANT

Now, for a secondary induction hypothesis, ﬁx k > 1 and assume that if B ⊆
Zn+1 is a Presburger set, which does not deﬁne the ordering and has sorted ﬁbers
witnessed by some ( ¯f ′, ¯g′, m) such that | ¯f ′| = |¯g′| < k, then B is deﬁnable in
(Z, +, 0). Let A ⊆ Zn+1 be a Presburger set, which does not deﬁne the ordering and
has sorted ﬁbers witnessed by ( ¯f , ¯g, m), where ¯f = (f1, . . . , fk) and ¯g = (g1, . . . , gk).
As in the secondary base case, it suﬃces to assume X = π(A) is a single quasi-
coset in Zn. By Claim 8.1, there are s, t ∈ {1, . . . , k} such that fs − gt is constant
on X. By Lemma 7.11(b) and the secondary induction hypothesis, it follows that
A is deﬁnable in (Z, +, 0). This completes the proof of Theorem 2.4.

References

[1] Michael Artin, Algebra, Prentice Hall, Inc., Englewood Cliﬀs, NJ, 1991.
[2] Matthias Aschenbrenner, Alf Dolich, Deirdre Haskell, Dugald Macpherson, and Sergei
Starchenko, Vapnik-Chervonenkis density in some theories without the independence prop-
erty, II, Notre Dame J. Form. Log. 54 (2013), no. 3-4, 311–363.

[3] Thøger Bang, A solution of the “plank problem.”, Proc. Amer. Math. Soc. 2 (1951), 990–993.
[4] Raf Cluckers, Presburger sets and p-minimal ﬁelds, J. Symbolic Logic 68 (2003), no. 1,

153–162.

[5] Gabriel Conant and Anand Pillay, Stable groups and expansions of (Z, +, 0), arXiv:1601.05692

[math.LO], 2016.

[6] Alf Dolich, Deirdre Haskell, Dugald Macpherson, and Sergei Starchenko, Vapnik-
Chervonenkis density in some theories without the independence property, I, Trans. Amer.
Math. Soc. 368 (2016), no. 8, 5889–5949.

[7] Alfred Dolich and John Goodrick, Strong theories of ordered abelian groups, arXiv:1511.08274

[math.LO], 2015.

[8] Vladimir Kadets, Coverings by convex bodies and inscribed balls, Proc. Amer. Math. Soc.

133 (2005), no. 5, 1491–1495 (electronic).

[9] Itay Kaplan and Saharon Shelah, Decidability and classiﬁcation of the theory of integers with

primes, arXiv:1601.07099 [math.LO], 2016.

[10] David Marker, Semialgebraic expansions of C, Trans. Amer. Math. Soc. 320 (1990), no. 2,

581–592.

[11]

, Model theory, Graduate Texts in Mathematics, vol. 217, Springer-Verlag, New York,

2002.

[12] Christian Michaux and Roger Villemaire, Presburger arithmetic and recognizability of sets of
natural numbers by automata: new proofs of Cobham’s and Semenov’s theorems, Ann. Pure
Appl. Logic 77 (1996), no. 3, 251–277.

[13] Daniel Palacín and Rizos Sklinos, Superstable expansions of free abelian groups, Notre Dame

J. Form. Log., to appear, available: arXiv 1405.0568.

[14] Anand Pillay, An introduction to stability theory, Oxford Logic Guides, vol. 8, The Clarendon

Press Oxford University Press, New York, 1983.

[15] Bruno Poizat, Supergénérix, J. Algebra 404 (2014), 240–270, À la mémoire d’Éric Jaligot.

[In memoriam Éric Jaligot].

[16] Mojżesz Presburger, Über die Vollständigkeit eines gewissen Systems der Arithmetik ganzer
Zahlen, in welchem die Addition als einzige Operation hervortritt, Comptes Rendus du I
congrès de Mathématiciens des Pays Slaves, Warszawa, 1929, pp. 92–101.

[17] Mike Prest, Model theory and modules, Handbook of algebra, Vol. 3, North-Holland, Ams-

terdam, 2003, pp. 227–253.

[18] Pierre Simon, A guide to NIP theories, vol. 44, Cambridge University Press, 2015.
[19] Alfred Tarski, Uwagi o stopniu równoważności wielokątów, Parametr 2 (1931-1932), 310–314.

Department of Mathematics, University of Notre Dame, Notre Dame, IN, 46656,

USA

