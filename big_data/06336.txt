6
1
0
2

 
r
a

 

M
2
2

 
 
]
P
A
h
t
a
m

.

[
 
 

2
v
6
3
3
6
0

.

3
0
6
1
:
v
i
X
r
a

A uniﬁed approach to the well-posedness of some

non-Lambertian models in Shape-from-Shading theory

Fabio Camilli∗

Silvia Tozza†

March 23, 2016

Abstract

In this paper we show that the introduction of an attenuation factor in the brightness
equations relative to various perspective Shape from Shading models allows to make the corre-
sponding diﬀerential problems well-posed. We propose a uniﬁed approach based on the theory
of viscosity solution and we show that the brightness equations with the attenuation term admit
a unique viscosity solution. We also discuss in detail the possible boundary conditions that we
can use for the Hamilton-Jacobi equations associated to these models.

Keywords: Shape from Shading, perspective model, viscosity solution, maximum princi-

ple, non-Lambertian models, stationary Hamilton-Jacobi equations.

1

Introduction

Shape from Shading (SfS) is the problem to compute a three dimensional shape of a surface
from a single gray-value image of it. The SfS model was formally introduced by Horn who
ﬁrst formulated the problem as a nonlinear ﬁrst order partial diﬀerential equation (PDE) of
Hamilton-Jacobi (HJ) type.
In general, this problem is described by the following so-called
image irradiance equation introduced by Bruss [8]

I(x) = R(N (x)).

(1)

In this equation, the normalized brightness I(x) of the given gray-value image is put in relation
with the reﬂectance map R(N (x)) giving the value of the light reﬂection on the surface as a
function of its orientation (i.e., of the normal N (x)). Depending on how we describe the function
R, diﬀerent reﬂection models are determined. The most studied model is the Lambertian one,
a view independent model that depends only on the incident angle between the normal and
the light source direction ω. Considering this model under an orthographic projection, that is
when a single light source is placed at inﬁnity in the direction of the unit vector ω and assuming
uniform albedo equal to 1 (i.e. the light is completely reﬂected by the surface) the irradiance
equation (1) becomes

I(x)(cid:112)1 + |∇u(x)|2 + ω · (∇u(x),−1) = 0,

(2)

where u is the surface height (our unknown). In general, nonlinear PDEs such as (2) do not
admit smooth solutions and the proper notion of weak solution is the viscosity one (see [4], [9],
[3]). Viscosity solutions in the framework of SfS were considered for the ﬁrst time in [21] and
since then many papers have been devoted to develop a proper existence and uniqueness theory
for (2) and related models. It is worthwhile to note that the orthographic Lambertian model
suﬀers of two main drawbacks:

∗Dip. di Scienze di Base e Applicate per l’Ingegneria, “Sapienza” Universit`a di Roma, via Scarpa 16, 00161 Rome,
†Dipartimento di Matematica, “Sapienza” Universit`a di Roma, P.le Aldo Moro, 5 - 00185 Rome, Italy (e-mail:

Italy, (e-mail:camilli@sbai.uniroma1.it)

tozza@mat.uniroma1.it)

1

(i) From a modeling point of view, the Lambertian model does not take into account the viewer
direction and supposes to deal with smooth object, assumptions not suitable to deal with real-
world data. Moreover, except for few application ﬁelds, as e.g. the astronomical one, the light
source and the camera are not far away from the surface (e.g. applications in medicine, security,
etc.).
(ii) The image irradiance equation (2), even if completed with boundary conditions, does not
admit in general a unique solution. In fact, due to the well-known concave/convex ambiguity
in presence of singular points, i.e. points where the light direction is parallel to the normal to
the surface, there exists an inﬁnite family of viscosity solutions to equation (2) which are all in
between a minimal and a maximal solution.

Concerning the ﬁrst issue, in order to increase the complexity of the model, various extensions
have been proposed. In [19], [15], the orthographic Lambertian model is replaced by a perspective
Lambertian one (pinhole camera and light source at the optical center). In [14], a more general
setup, which combines a spherical surface parametrization with the non-Lambertian Oren-Nayar
reﬂectance model, is considered obtaining a robust approach that allows to deal with an arbitrary
position of the light source. Moreover, models for non-Lambertian surfaces (like e.g.
[18], [6],
[17]) have been proposed in [1, 2, 23, 14]. All these models, when formulated in terms of a
diﬀerential equation, do not resolve the concave/convex ambiguity (see [22] for an analysis on
them).

In order to solve the non uniqueness issue in presence of singular points, in [20], [19] the
authors introduce in the perspective Lambertian model an attenuation factor which takes into
account the distance between the light source and the surface. This new term makes the model
more reliable and thanks to it the notion of singular points does not make sense anymore (even
if some ambiguities in the model still appear [7]). They show that a Hamilton-Jacobi equation,
obtained via an appropriate change of variable in the image irradiance equation, admits a unique
viscosity solution and, therefore, the uniqueness of the solution for the original equation follows.
In this paper, starting from the idea in [19] related to the Lambertian model, we con-
sider non-Lambertian models (Oren-Nayar [17], Phong [18], Blinn-Phong [6]) and we show that
the introduction of an attenuation factor in the perspective case allows to overcome the con-
cave/convex ambiguity for all the corresponding brightness equations and to obtain therefore
the existence of at most one viscosity solution. The uniqueness property is obtained by check-
ing the assumptions of the Maximum Principle for discontinuous viscosity solutions (see [4]).
In this framework, boundary conditions play an important role, hence we discuss the various
type of them which is possible to prescribe for the diﬀerent models. Interesting enough, all the
models (included the Lambertian one) can be studied in a uniﬁed approach which allows to
check the assumptions of the Maximum Principle in a rather straightforward way. Moreover,
this approach can also provide a setup to study other SfS perspective models (see [2]).

Many papers have been devoted to the approximation of the various irradiance equations
arising in SfS theory (see the surveys [24, 10]), but only very few of them discuss the convergence
of the corresponding methods and most of the results are of experimental type. This fact is
essentially due to the lack of a proper characterization of the viscosity solution of the limit
equation. The Maximum Principle for discontinuous viscosity solutions we prove here is a key
ingredient to show the convergence of numerical schemes for SfS equations via the by now
classical method proposed in [5] (we will discuss this point elsewhere).

The paper is organized as follows: after a brief description of the reﬂectance models and the
derivation of the PDEs associated to them in Section 2, in Section 3 we start our analysis of
the four models considered in a uniﬁed formulation, proving properties common to the diﬀerent
models. In Section 4, we focus our attention on viscosity solutions and the role of the various
possible boundary conditions for HJ equations. After that, we move to prove the well-posedness
of the Perspective SfS problem for the non-Lambertian models and we conclude the paper with
ﬁnal comments.

2 Reﬂectance Models and PDE formulation

In this section we will brieﬂy recall the reﬂectance models we will consider and we will describe
the derivation of the corresponding HJ equations. For all the models, we consider as setup the

2

perspective camera projection with one light source located at the optical center of the camera
and an attenuation term of the illumination due to the distance between the light source and
the surface.

Let Ω be an open subset of R2 representing the image domain. Since the CCD sensors have
ﬁnite size, let us assume that Ω is bounded. As in [20, 19, 1, 23], we represent the scene by a
surface parametrized by the function S : Ω → R3 deﬁned by

where f > 0 is the focal length of the camera and u(x) is the unknown height of the surface.
The normal vector at the point x := (x1, x2) of S is given by

f u(x)

S(x) =

(cid:112)|x|2 + f 2
n(x) = Sx1 × Sx2 =(cid:0)f ∇u(x) − f u(x)

(x,−f )

|x|2 + f 2 f(cid:1)

f u(x)

|x|2 + f 2 x,∇u(x) · x +
(cid:112)|x|2 + f 2

.

(3)

(4)

(6)

(7)

(8)

and the unit vector in the direction of the illumination is
(−x, f )

ω(S(x)) =

The unit normal vector N (x) will be N (x) = n(x)

|n(x)| , where

(cid:115)

|n(x)| =

f 2|∇u(x)|2 + (∇u(x) · x)2 + u(x)2

f 2

(f 2 + |x|2)

2.1 Lambertian model (L–model)

The Lambertian model is the most common reﬂectance model ([19, 15, 12, 13]). The brightness
equation for this model is described by

I(x) = γD(x)

cos(θi)

r2

(5)

where I(x) denotes the image intensity, θi represents the angle between the unit normal to
the surface N (x) and the light source direction ω(S(x)), γD(x) is the diﬀuse albedo which
describes the physical properties of the surface reﬂection, and 1/r2 is the attenuation term of
the illumination due to the distance between the light source and the surface [1]. Hence, for a
Lambertian surface, the measured light in the image depends only on the scalar product between
N and ω, independently on the position of the viewer. In the sequel, we suppose uniform albedo
and we put γD(x) = 1, that is all the points of the surface reﬂect completely the light that hits
them (we will not consider absorption phenomena). So in this case the surface of the object has
uniform properties of light reﬂection (see Fig. 1). Under a perspective camera projection with
a single light source located at the optical center of the camera and considering the attenuation
term 1/r2, with r = f u(x), we can associate to (5) the following HJ equation

I(x) =

1

f 2u(x)2

(cid:112)f 2|∇u(x)|2 + (∇u(x) · x)2 + u(x)2Q(x)2

u(x)Q(x)

where

By deﬁning

f(cid:112)f 2 + |x|2

.

Q(x) :=

W (x, p) :=

f 2|p|2 + (p · x)2

Q2

,

we can rewrite Eq. (6) as

I(x) =

1

f 2u(x)2

(cid:112)W (x,∇u(x)) + u(x)2

u(x)

.

3

Figure 1: A Lambertian surface diﬀuses the incident radiation independently from the angle
between the surface normal N and the direction of the observer. Two diﬀerent observers V1 and V2
do not detect any diﬀerence in radiance. The radiance is a function only of the angle θi between ω
and N .

Assuming that the surface S is visible, i.e.
in front of the optical center, then u is a strictly
positive function. Hence, by the change of variable v(x) = log u(x), we can get the following HJ
equation in the new variable v (as in [20, 19])

to which we can associate the Hamiltonian

− e−2v(x) + I(x)f 2(cid:112)W (x,∇v(x)) + 1 = 0,
H L(x, r, p) = −e−2r + I(x)f 2(cid:112)W (x, p) + 1 .

(9)

(10)

2.2 Oren-Nayar model (ON–model)

The Oren-Nayar reﬂectance model [17, 16] represents a rough surface as an aggregation of V-
shaped cavities, each with Lambertian reﬂectance properties. Assuming that there is a linear
relation between the irradiance of the image and the image intensity, the brightness equation
for the ON–model is given by

I(x) = cos(θi)(A + B sin(α) tan(β)M (ϕi, ϕr)).

(11)

In this model, θi represents the angle between the unit normal to the surface N and the light
source direction ω, θr stands for the angle between N and the observer direction V , ϕi is the
angle between the projection of the light source direction ω and the x1 axis onto the (x1, x2)-
plane, ϕr denotes the angle between the projection of the observer direction V and the x1 axis
onto the (x1, x2)-plane, the two variables α and β are given by

α = max{θi, θr} and β = min{θi, θr} .

The non negative constants A and B depend on the statistics of the cavities via the roughness
parameter σ. We set σ ∈ [0, π/2), interpreting σ as the slope of the cavities, and

A = 1 − 0.5 σ2(σ2 + 0.33)−1
B = 0.45σ2(σ2 + 0.09)−1
M (ϕi, ϕr) = max{0, cos(ϕr − ϕi)}.

Let us consider a perspective camera projection, with only one light source located at the optical
center of the camera. As a consequence of this setup, we deﬁne θ := θi = θr = α = β. Adding
the attenuation term 1/r2 of the illumination due to the distance between the light source and
the surface as proposed in [1], the brightness equation becomes

I(x) =

A cos(θ) + B sin2(θ)

r2

4

.

(12)

Since cos(θ) = N (x) · ω(S(x)), hence sin2(θ) = 1 − (N (x) · ω(S(x)))2, and r = f u(x), the
brightness equation (12) becomes

I(x)f 2u(x)2 =

(cid:112)f 2|∇u|2 + (∇u · x)2 + u(x)2Q(x)2
(cid:16)

u(x)2Q(x)2

Au(x)Q(x)

1 −

+B

f 2|∇u|2 + (∇u · x)2 + u(x)2Q(x)2

(cid:17)

(13)

with Q(x) deﬁned as in (7).
By deﬁning W as in (8), we can rewrite Eq. (13) as

I(x)f 2u(x)2 −

(cid:112)W (x,∇u(x)) + u(x)2

Au(x)

− B(1 −

u(x)2

W (x,∇u(x)) + u(x)2 ) = 0

or, equivalently,

I(x)f 2u(x)2(W (x,∇u(x)) + u(x)2) − Au(x)((cid:112)W (x,∇u(x)) + u(x)2) − BW (x,∇u(x)) = 0.

Since u(x) > 0, ∀x ∈ Ω, by the change of variable v(x) = ln u(x) we arrive to the following PDE
in v

If 2e2v(x)(W (x,∇v(x)) + 1) − A(cid:112)W (x,∇v(x)) + 1 − BW (x,∇v(x)) = 0,

which can be written also as follow (Cf. Eq. (10) in [1]):

(W (x,∇v(x)) + 1)

A(cid:112)W (x,∇v(x)) + 1 + BW (x,∇v(x))
A(cid:112)W (x, p) + 1 + BW (x, p)

(W (x, p) + 1)

(cid:34)

= 0,

(cid:35)

.

(14)

(15)

− e−2v(x) + I(x)f 2

to which we associate the following Hamiltonian

H ON (x, r, p) := −e−2r + I(x) f2

Note that the quantity W is the same one deﬁned in the L–model, see (8), and this will be
useful for the uniﬁed approach to the diﬀerent models.

2.3 Phong model (PH–model)

The PH–model is an empirical model that was developed by Phong [18]. This model introduces
a specular component to the brightness function I(x) which can be described in general as

kAIA(x) + kDID(x) + kSIS(x)

where IA(x), ID(x) and IS(x) are the ambient, diﬀuse and specular light components, respec-
tively, and kA, kD and kS indicate the percentages of ambient, diﬀuse and specular components,
respectively, such that their sum is equal to 1. The specular light component IS(x) is given as
a power of the cosine of the angle θs between the unit vectors V and R(x) with R representing
the reﬂection of the light ω on the surface. Then, the brightness equation for the PH–model is

I(x) = kAIA(x) + kDγD(x)(cos θi) + kSγS(x)(cos θs)α,

(16)

where α expresses the specular reﬂection characteristics of a material, γD(x) and γS(x) represent
the diﬀuse and specular albedo, respectively (we will set them to 1 in the following).

Using the same setup adopted for the previous models, that is a perspective camera projec-
tion with only one light source located at the optical center of the camera, we will obtain that
the view direction and the light source direction are the same, hence θs = 2θi (see [23]). By
adding the light attenuation term as done before, the brightness equation (16) becomes

I(x) = kAIA(x) +

1

r2 kD(N (x) · ω(S(x))) + kS(2(N (x) · ω(S(x)))2 − 1)α,

(17)

5

since cos θi = N (x) · ω(S(x)) and cos θs = cos 2θi = 2(cos θi)2 − 1 = 2(N (x) · ω(S(x)))2 − 1.

Following [23], we derive a HJ equation associated to (17). If we use |n(x)| as deﬁned in (4)

and Q(x) as in (7), then (17) is equivalent to

I(x) = kAIA(x) +

1

f 2u(x)2

kD

u(x)Q(x)
|n(x)| + kS(2

.

(18)

(cid:16)

|n(x)|2 − 1)α(cid:17)

u2Q(x)2

Since u(x) is a strictly positive function, by the change of variable v(x) = log u(x) we arrive to
the following HJ equation in v

where

− kSW V BW (x,∇v(x))

(I(x) − kAIA(x))f 2

Q

Q(x)

2Q(x)2

e−2v(x)(cid:16)

(cid:17)α
W V BW (x,∇v(x)) − kDe−2v(x)
W V BW (x,∇v(x))2 − 1
W V BW (x, p) :=(cid:112)f 2|p|2 + (p · x)2 + Q(x)2,
(cid:112)W (x,∇v(x)) + 1
(cid:112)W (x,∇v(x)) + 1

kD + kS

− e−2v(x) + (I(x) − kAIA(x))f 2

as deﬁned in [23]. To our purpose, it is useful to write (19) with the same structure and functions
that appear in the L-model and in the ON-model. Hence, we rewrite (19) as follow

(19)

= 0,

where W (x,∇v(x)) is deﬁned as in (8). Hence, we associate to (20) the following Hamiltonian

(cid:17)α = 0,

1+W (x,∇v(x))

(cid:16) 1−W (x,∇v(x))
(cid:112)W (x, p) + 1
(cid:112)W (x, p) + 1

(cid:16) 1−W (x,p)

(cid:17)α .

1+W (x,p)

(20)

(21)

H P H (x, r, p) := −e−2r + (I(x) − kAIA(x))f 2

kD + kS

From now on we assume that α is an integer and α ≥ 1 (in [18], α ∈ [1, 10]). Note that
H P H (x, r, p) is not well deﬁned if α is irrational. On the other side, as stated also in Vogel et al.
represents the cosine of the specular term, in the Phong model
[23], since the term

(cid:16) 1−W (x,p)

(cid:17)

1+W (x,p)

< 0 and we can rewrite the Hamiltonian

(cid:17)

1+W (x,p)

(cid:16) 1−W (x,p)
(cid:112)W (x, p) + 1

this cosine is replaced by zero if cos θs =
H P H (x, r, p) as follow:



H P H (x, r, p) :=

−e−2r + (I(x) − kAIA(x))f 2
−e−2r + (I(x) − kAIA(x))f 2

if W (x, p) ≥ 1,
(22)
if 0 ≤ W (x, p) < 1.

kD + kS

kD

(cid:112)W (x, p) + 1
(cid:112)W (x, p) + 1
(cid:18) I(x) − kAIA(x)

1+W (x,p)

(cid:17)α

(cid:16) 1−W (x,p)
(cid:19)
f 2(cid:112)W (x, p) + 1.

kD

Remark 2.1. Note that if kS = 0, i.e. if there is no contribution of the specular part, then

H P H (x, r, p) = −e−2r +

Hence, in this case the PH–model reduces to the L–model, up to a constant.

2.4 Blinn-Phong model (BP–model)

A modiﬁcation of the PH–model has been proposed by Blinn [6] introducing an intermediate
vector H, which bisects the angle between the unit vectors ω and V . If the surface is a perfect
mirror, the light reaches the eye only if the surface normal N is pointed halfway between the
light source direction ω and the eye direction V . We will denote the direction of maximum
highlight by H = ω+V
|ω+V | . For less than perfect mirrors, the specular component falls oﬀ slowly
as the normal direction moves away from the specular direction. The cosine of the angle between

6

N and H is used as a measure of the distance of a particular surface from the maximum specular
direction. The degree of sharpness of the highlights is adjusted by taking this cosine to some
power (in [6] it is stated that this power is typically 50 or 60).
For this model, the brightness equation is

I(x) = kAIA(x) + kDγD(x)(cos θi) + kSγS(x)(cos δ)c,

(23)
where c expresses a measure of shininess of the surface (we suppose c ≥ 1) and δ is the angle
between the unit normal N and H. As for the PH–model, γD(x) and γS(x) represent the
diﬀuse and specular albedo, respectively, and in what follows we will set them to 1. Using the
same setup adopted for the previous models, we will obtain that the view direction and the
light source direction are the same. By adding the light attenuation factor as done before, the
brightness equation (23) becomes

1

I(x) = kAIA(x) +

since cos θi = N (x) · ω(S(x)) and cos δ can be expressed as N (x) · ω(S(x)) under this setup.
By using (3) and (4) for the deﬁnition of the unit normal N (x), we arrive to the following HJ
equation

r2 kD(N (x) · ω(S(x))) + kS(N (x) · ω(S(x)))c,
(cid:17)c(cid:17)

(cid:16) u(x)Q(x)

(cid:16)

1

I(x) = kAIA(x) +

f 2u(x)2

kD

u(x)Q(x)
|n(x)| + kS

|n(x)|

,

with |n(x)| deﬁned as in (4) and Q(x) as in (7). By using the change of variable v(x) = log u(x),
as done for the previous models, we obtain the following HJ equation in v

(cid:112)W (x,∇v(x)) + 1

1

+ kS

(cid:112)W (x,∇v(x)) + 1

1

(cid:16)

(cid:17)c

(24)

(I(x) − kAIA(x))f 2e2v = kD

with the function W (x,∇v(x)) deﬁned as in (8). For our purpose, we will rewrite this equation
as

− e−2v(x) + (I(x) − kAIA(x))f 2

(W (x,∇v(x)) + 1)c/2
c−1
2 + kS

kD(W (x,∇v(x)) + 1)

= 0,

(25)

to which we associate the Hamiltonian

H BP (x, r, p) := −e−2r + (I(x) − kAIA(x))f 2

(W (x, p) + 1)c/2
c−1
2 + kS

kD(W (x, p) + 1)

.

(26)

Remark 2.2. For the Blinn-Phong model holds an observation similar to the one reported for
the PH–model in Remark 2.1 , i.e. for kS = 0 it reduces to the L-model, up to a constant.

3 Uniﬁed formulation and analysis

We have seen in the previous section that the four diﬀerent reﬂectance models considered in a
common setup lead to the study of a HJ equation of the form

H(x, v(x),∇v(x)) = 0,

∀x ∈ Ω,

(27)

where the Hamiltonian H is given respectively by (10), (15), (22), (26) and v(x) = log u(x),
with u(x) the unknown height of the surface. We highlight some properties of the general
Hamiltonian H which are common for all the four cases. First of all, note that (27) can be
rewritten as

− e−2v + HM (x,∇v(x)) = 0

(28)

where M is the acronym of the models (M = L, ON, P H, BP ). For W (x, p) deﬁned as in (8),
HM (x, p) corresponds for each model to the following:

Lambertian model

HL(x, p) := I(x)f 2FL(W (x, p))
FL(r) =

r + 1

√

(29)

(30)

7

HON (x, p) = I(x)f 2FON (W (x, p))

FON (r) =

√

r + 1
r + 1 + Br

A

Oren-Nayar model

Phong model

FP H (r) =

Blinn-Phong model

HP H (x, p) = (I(x) − kAIA(x))f 2FP H (W (x, p))

r + 1
kD
kD(r + 1)α + kS(r + 1)1/2(1 − r)α

(r + 1)α+1/2

if r ≥ 1
if 0 ≤ r < 1

√



HBP (x, p) = (I(x) − kAIA(x))f 2FBP (W (x, p))

FBP (r) =

(r + 1)c/2
c−1
2 + kS

kD(r + 1)

.

(31)

(32)

(33)

(34)

(35)

(36)

We give some bounds on W and the various functions FM above deﬁned which will be useful
for our desired uniﬁed analysis.

Lemma 3.1. The following bounds hold:

f 2|p|2 ≤ W (x, p) ≤ C|p|2
|DxW (x, p)| ≤ C|p|2
|DpW (x, p)| ≤ C|p|

(37)

(38)

(39)

with C independent of (x, p) ∈ Ω × R2.

Proof. We have

f 2|p|2 ≤ W (x, p) = |p|2W (x,

which proves (37). Moreover,

DxW (x, p) = 2(p · x)p

|x|2 + f 2

f 2

DpW (x, p) = 2(f 2 + |x|2)p + 2

from which we get (38) and (39).

Lemma 3.2.

p

W (x, q)

|p| ) ≤ |p|2 max
|q|=1
(cid:104)
(p · x)2 + f 2|p|2(cid:105) 2x

+

f 2
(x · p)x

|x|2 + f 2

f 2

(i) For F = FL, FP H , FBP , the function F : [0, +∞) → R is smooth, positive, strictly in-

creasing and satisﬁes

lim

r→+∞ F (r) = +∞
0 < F (cid:48)(r) ≤ C√

r + 1

8

(40)

(41)

(ii) The function FON : [0, +∞) → R is smooth, positive, strictly increasing if A/2 > B and

satisﬁes

lim
r→+∞ FON (r) =
ON (r) ≤ C√

0 < F (cid:48)

1
B

r + 1

Proof.

(i) For the function FL we have

lim
r→+∞ FL(r) = lim
r→+∞
F (cid:48)
L =

1
r + 1

√
2

√

r + 1 = +∞,
for r ∈ [0, +∞),

(42)

(43)

(44)

(45)

and the corresponding properties in the statement easily follow.
Regarding the PH–model, we analyze the function FP H (r) only for r ∈ [0, 1) (otherwise it is
equal to

). For r ∈ [0, 1), we have

FL(r)

kD

=

[kD(r + 1)α + kS(r + 1)1/2(1 − r)α]2

1

Hence,

0 < F (cid:48)

P H (r) ≤

(cid:104)

(

1
2

+ α)

·

2

1

−kS

F (cid:48)
P H (r) =

[kD(r + 1)α + kS(r + 1)1/2(1 − r)α]2

(cid:16)
kD(r + 1)2α−1/2 + kS(r + 1)α(1 − r)α(cid:17) − αkD(r + 1)2α−1/2
(r + 1)α(1 − r)α − α(r + 1)α+1(1 − r)α−1(cid:17)(cid:105)
(cid:16) 1
·(cid:104) 1
kD(r + 1)2α−1/2 + 2αkS(r + 1)α(1 − r)α−1(cid:105)
(cid:104) 1
kD(r + 1)2α−1/2 + 2αkS(r + 1)α(cid:105)
(cid:17)

√
1
r + 1

k2
D(r + 1)2α

2αkS

+

2

2

1

.

+

2αkS
k2
D

2kD

k2
D(r + 1)α
1√
r + 1

.

=

≤ (cid:16) 1

2kD

Moreover,

r→1− F (cid:48)

F (cid:48)
P H (r) =

F (cid:48)
L(1),

1
kD

lim

P H (r) = lim
r→1+

(46)
hence FP H ∈ C 1. By the corresponding properties for FL, it follows that FP H is strictly
increasing and the following bounds hold
1√
r + 1

for r ∈ [0, +∞) and ∀α ≥ 1.

P H (r) ≤ C

0 < F (cid:48)

(47)

For the BP–model, if c = 1 in (36), then FBP (r) = 1
the case c > 1, the function FBP is still smooth and positive. Moreover,

kD+kS

FL(r), hence we can refer to FL. In

r→∞ FBP (r) = +∞

lim

and

F (cid:48)
BP (r) =

c

2 (r + 1) c

2−1(kD(r + 1)

c−1

2 + kS) − (r + 1) c
c−1
2 + kS)2

(kD(r + 1)

2 ( c−1

2 kD(r + 1)

c−1
2 −1)

≤ c

2 (r + 1) c

2−1(kD(r + 1)

c−1
2 + kS)

(kD(r + 1)

c−1
2 + kS)2

2−1

c

2 (r + 1) c
c−1
2 + kS

kD(r + 1)

.

=

9

Hence, the following bounds hold

0 < F (cid:48)

BP (r) ≤ C

1√
r + 1

for r ∈ [0, +∞) and ∀c ≥ 1.

(48)

This shows that also the function FBP is strictly increasing, that concludes the proof of (i).
(ii) For the function FON we have

F (cid:48)
ON (r) =

√
r + 1 − 2B
√
r + 1 + Br]2

A
2[A

for r ∈ [0, +∞).

(49)

Hence, FON is strictly increasing if A/2 > B and the property (43) in the statement easily
follows. Moreover, since limr→+∞ FON (r) = 1/B, it is bounded.

4 Viscosity solutions of Hamilton-Jacobi equations

In view of the study of the general Hamiltonian (27) for the various reﬂectance models introduced
in Section 2, we recall some basic properties of the theory of viscosity solutions emphasizing the
role of the boundary conditions (we refer to [4] for a nice introduction to this theory).
In general, a Hamilton-Jacobi equation such as (27) does not admit a classical solution and the
right notion of weak solution is the one of viscosity solution. Viscosity solutions are typically
Lipschitz continuous and they can be obtained as the limit of regular solutions to second order
problems via the so-called vanishing viscosity method. Moreover, if a classical solution to the HJ
equation exists, it coincides with the viscosity solution. We introduce the deﬁnition of viscosity
subsolution, supersolution and solution. It is useful to have the following notations for a generic
set O ⊂ R2

USC(O) = {upper semicontinuous functions u : O → R}
LSC(O) = {lower semicontinuous functions u : O → R}

Deﬁnition 4.1. A viscosity subsolution of (27) on Ø is a function u ∈ USC(Ø) such that for
any φ ∈ C 1(Ø), if x0 ∈ Ø is a local maximum point of u − φ, one has

H(x0, u(x0),∇φ(x0)) ≤ 0.

A viscosity supersolution of (27) on Ø is a function u ∈ LSC(Ø) such that for any φ ∈ C 1(Ø),
if x0 ∈ Ø is a local minimum point of u − φ, one has

H(x0, u(x0),∇φ(x0)) ≥ 0.

Finally, u is a viscosity solution of (27) if it is both a viscosity subsolution and a viscosity
supersolution.

Note that a viscosity solution of (27) is a continuous function in Ø.

4.1 Strong boundary conditions

In this framework we assume to know the value of the function u on the boundary of the image
domain Ø, hence we consider the Dirichlet problem:

(cid:26) H(x, u(x),∇u(x)) = 0, ∀x ∈ Ω,

u(x) = g(x)

∀x ∈ ∂Ω,

(50)

where g is a real continuous function deﬁned on ∂Ω and the boundary condition is considered
in pointwise sense (boundary condition in strong sense). The following theorem ensures the
uniqueness of the continuous viscosity solution to (50) (see [9, Theorem 3.3] for more details).

10

Theorem 4.2. Let Ω be a bounded subset of R2 and H : Ω × R × R2 → R be continuous and
satisﬁes

for any R > 0, ∃γR > 0 s.t. H(x, u, p) − H(x, v, p) ≥ γR(u − v)
for all x ∈ Ω, −R ≤ v ≤ u ≤ R and p ∈ R2,
|H(x, u, p) − H(y, u, p)| ≤ mR(|x − y|(1 + |p|)) for all x, y ∈ Ω,
−R ≤ u ≤ R, p ∈ R2 where mR(t) → 0 when t → 0.

(H1)

(H2)

Let u ∈ USC(Ø) (respectively v ∈ LSC(Ø)) be a subsolution (respectively, supersolution) of (27)
in Ø and u ≤ v on ∂Ø. Then u ≤ v in Ø.

The previous result implies that there exists at most one viscosity solution u ∈ C(Ø) to
the Dirichlet problem (50) and we will prove that all the Hamiltonians corresponding to the
reﬂectance models introduced in Section 2 satisfy the assumptions (H1)-(H2). Note that the
crucial point for the uniqueness is the assumption (H1), which is in general not satisﬁed by
the SfS models without attenuation factor and/or under a diﬀerent setup, e.g. considering an
orthographic projection instead of a perspective one. However, Theorem 4.2 is not completely
satisfying for the following reasons:

(i) A Dirichlet boundary condition requires the exact value of the solution at the boundary
of the image domain, an additional information which is not always available in the SfS
framework, especially in real contexts.

(ii) It is well known that boundary conditions for ﬁrst order PDEs can be typically prescribed
only on some part of the boundary (active boundary). Hence, imposing a Dirichlet condi-
tion on all the boundary as in (50) leads to an ill-posed problems, i.e. problems for which
there exists no viscosity solution (see [4, cap.
IV]) and in this case the corresponding
numerical schemes return inconsistent or inexact results.

(iii) Many algorithms have been suggested for the SfS problem and a large part of them are
based on the approximation of the partial diﬀerential equations arising in the various mod-
els (see the surveys [24, 10]). Convergence and stability analysis are important points for
the reliability of a numerical approximation, but only a very few papers analyze the theo-
retical properties of various proposed algorithms and most of the results are of empirical
nature.
It is worthwhile recall that there is a huge literature about the approximation of viscosity
solutions (see e.g. the book by Falcone and Ferretti [11]) and a well established technique
to prove the convergence of a numerical scheme is the Barles-Souganidis’ approach [5]:
besides some natural properties of the scheme (stability, consistency, monotonicity), a key
ingredient for this technique is the Maximum Principle for discontinuous viscosity solution,
which in particular requires the formulation in a weak (viscosity) sense of the boundary
conditions for the PDE to be approximated. Since the Dirichlet boundary condition in
(50) is formulated in strong sense, i.e. pointwise, Theorem 4.2 is not suﬃcient for applying
the Barles-Souganidis’ approach and we need a diﬀerent comparison result.

Motivated by the previous remarks, we are going to introduce the notion of boundary conditions
in viscosity sense.

4.2 Weak boundary conditions

In this section we consider a more general boundary value problem of the form

(cid:26) H(x, u(x),∇u(x)) = 0, ∀x ∈ Ω,

B(x, u(x),∇u(x)) = 0

∀x ∈ ∂Ω.

(51)

The operator B : ∂Ø × R × R2 → R represents the boundary condition. For example, the
Dirichlet boundary condition in (50) arises from the choice B(x, r, p) = r − g(x); the Neumann
boundary condition arises if B(x, r, p) = N (x)· p− g(x) where N (x) is the outward unit normal
to x ∈ ∂Ø; the so-called state constraints condition corresponds to B(x, r, p) = r − g(x) with

11

g(x) ≡ −∞. We introduce the notion of (discontinuous) viscosity solution for (51). The main
diﬀerence with Deﬁnition 4.1 is that now the boundary condition is incorporated in the deﬁnition
(boundary condition in weak sense).
Deﬁnition 4.3. A viscosity subsolution of (51) is a function u ∈ USC(Ø) such that for any
φ ∈ C 1(Ø), if x0 is a local maximum point of u − φ, one has

H(x0, u(x0),∇φ(x0)) ≤ 0
min[H(x0, u(x0),∇φ(x0)), B(x0u(x0),∇φ(x0))] ≤ 0

if x ∈ Ø,
if x ∈ ∂Ø.

A viscosity supersolution of (51) is a function u ∈ LSC(Ø) such that for any φ ∈ C 1(Ø), if x0
is a local minimum point of u − φ, one has

H(x0, u(x0),∇φ(x0)) ≥ 0
max[H(x0, u(x0),∇φ(x0)), B(x0u(x0),∇φ(x0))] ≥ 0

if x ∈ Ø,
if x ∈ ∂Ø.

Finally, u is a viscosity solution of (51) if it is both a viscosity subsolution and a viscosity
supersolution.

Note that a viscosity solution of (51) is a continuous function in Ø. We can now state the
Maximum Principle for discontinuous viscosity solutions. We ﬁrst consider the case of a Dirichlet
boundary condition (see [4, Theorem 4.4]).
Theorem 4.4. Let Ω be a bounded subset of R2 with ∂Ø of class W 2,∞, g : ∂Ø → R a
continuous function and H : Ω × R × R2 → R satisﬁes (H1)-(H2). Moreover, there exists a
neighborhood Γ of ∂Ω in R2 such that

for all 0 < R < +∞, there exists mR(t) → 0 when t → 0 such that
|H(x, u, p) − H(x, u, q)| ≤ mR(|p − q|)), for all x ∈ Γ, −R ≤ u ≤ R, p, q ∈ R2,

for all 0 < R < +∞, there exists CR > 0 such that
H(x, u, p + λn(x)) ≤ 0 ⇒ λ ≤ CR(1 + |p|) for all (x, u, p) ∈ Γ × [−R, R] × R2,

for all R1, R2 ∈ R+, H(x, u, p − λn(x)) → +∞

λ → +∞,
uniformly for (x, u, p) ∈ Γ × [−R1, R2] × B(0, R2).

(H3)

(H4)

(H5)

Let u ∈ USC(Ø) (respectively v ∈ LSC(Ø)) be a subsolution (respectively, supersolution) of (51)
with B(x, r, p) = r − g(x). Then u ≤ v in Ø.

Even if the comparison between subsolution and supersolution holds only in Ø and not in all
Ø, the previous result implies the uniqueness of the viscosity solution in Ø, i.e. if u1, u2 ∈ C(Ø)
are two viscosity solutions of (51) then u1 = u2 in Ø. Moreover, Theorem 4.4 is the type
of result needed to prove the convergence of approximation schemes via the Barles-Souganidis
method.
Concerning the other boundary conditions which are typically considered in the SfS framework,
for the validity of the corresponding Maximum Principle it is suﬃcient to assume
(i) for the State Constraints condition B(x, r, p) = r − g(x) with g(x) ≡ −∞, that H is
continuous and satisﬁes (H1)-(H4). Note that in this case the boundary condition reduces
to

H(x, u,∇u) ≥ 0

on ∂Ø

(52)

in viscosity sense and, therefore, it requires no additional information on the solution at
the boundary.

(ii) for the Neumann condition B(x, r, p) = N (x)·p−g(x), that the function g is continuous
on ∂Ø and H is continuous and satisﬁes (H1)-(H3). In this case the Maximum Principle
holds in Ø, i.e. u ≤ v in Ø in Theorem 4.4.

12

5 Well-posedness of the PSfS problem

Aim of this section is to show that the SfS Hamiltonians H L, H ON , H P H , H BP , introduced in
Section 2, completed with appropriate (either strong or weak) boundary conditions, give raise to
well-posed problems (either (50) or (51)), i.e. problems for which the uniqueness of the viscosity
solution holds. In this section we assume that

I(x) is Lipschitz continuous in Ω and there exists
a neighborhood Γ of ∂Ω such that I(x) ≥ δ > 0 in Γ,

(cid:40) I(x)

where

I(x) =

I(x) − kAIA(x)

if H = H L, H ON ,
if H = H P H , H BP .

(53)

(54)

5.1 Validation of assumptions for strong boundary conditions

We start now to prove that the assumptions (H1)-(H2) previously deﬁned in Section 4.1 hold
for our Hamiltonians.

Proposition 5.1. All the SfS Hamiltonians H L, H ON , H P H , H BP deﬁned in (10), (15), (22),
(26) satisfy the assumptions (H1)-(H2).

Proof.

Validation of hypothesis (H1)
Recalling that all the Hamiltonians H L, H ON , H P H or H BP can be written in the form
H(x, u, p) = −e−2u + HM (x, p) for an appropriate function HM (x, p), see (28), then for u, v
such that −R ≤ v ≤ u ≤ R, we have

H(x, u, p) − H(x, v, p) = −e−2u + HM (x, p) + e−2v − HM (x, p)

= −e−2u + e−2v
≥ 2(u − v)e−2R = γR(u − v).

for some c ∈ [v, u]

=

2(u − v)e−2c

Hence, all the Hamiltonians satisfy assumption (H1) with γR = 2e−2R > 0.
Validation of hypothesis (H2)
For H(x, u, p) equal to either H L,H ON , H P H or H BP , by (28) we can write

|H(x, u, p) − H(y, u, p)| = |HM (x, p) − HM (y, p)|,

(55)
where M is the acronym of the models (M = L, ON, P H, BP ). Recalling (53), with I deﬁned
as in (54), we can write

|HM (x, p) − HM (y, p)| = I(x)f 2FM (W (x, p)) − I(y)f 2FM (W (y, p)) ≤
|I(x) − I(y)|f 2FM (W (x, p)) + f 2|I(y)||FM (W (x, p)) − FM (W (y, p))| ≤
f 2(cid:107)DI(cid:107)∞|x − y|FM (W (x, p)) + f 2(cid:107)I(cid:107)∞|FM (W (x, p)) − FM (W (y, p))|.

M (W (x, p))DxW (x, p), we use (37), (38) and (41) for HL, (38), (43)
Since DxFM (W (x, p)) = F (cid:48)
for HON , (38), (47) for HP H and (38), (48) for HBP to obtain (H2) with C depending on (cid:107)I(cid:107)∞
and (cid:107)DI(cid:107)∞.

As an immediate corollary of the previous Proposition 5.1 and Theorem 4.2, we get

Corollary 5.2. The Dirichlet problem (50) for H given by H L, H ON , H P H , H BP admits at
most one viscosity solution.

13

5.2 Validation of assumptions for weak boundary conditions

Let us see now the proof of the assumptions (H3)-(H5) introduced in Section 4.2.

Proposition 5.3. We have

(i) The SfS Hamiltonians H L, H P H , H BP deﬁned in (10), (22), (26), satisfy the assumptions

(H3)-(H5).

(ii) The SfS Hamiltonian H ON deﬁned in (15) satisﬁes (H3).

Proof.

Validation of hypothesis (H3)
For H(x, u, p) equal to either H L, H ON , H P H or H BP , we have

|DpH(x, u, p)| = |DpHM (x, p)| = I(x)f 2|DpFM (W (x, p))|
M (W (x, p))DpW (x, p)|
Hence, by (39) and (53), we get (H3) with mR(t) = Ct for any R ∈ (0, +∞).
Validation of hypothesis (H4)
For H(x, u, p) equal to H L and F equal to FL, we have

= f 2(cid:107)I(cid:107)∞|F (cid:48)

H(x, u, p + λn(x)) ≤ 0 ⇒ F (W (x, p + λn(x))) ≤ e2R
δf 2

for any u ∈ (−R, R), x ∈ Γ and p ∈ R2. Recalling (37) and since F is invertible from [0, +∞)
to [0, +∞), we get

(cid:115)

(cid:18) e2R

(cid:19)

δf 2

|p + λn(x)| ≤

1

f 2 F −1

= CR .

Therefore, we get (H4) for the Lambertian Hamiltonian H L. The previous argument works
exactly in the same way for H(x, u, p) equal to either H P H or H BP since the corresponding
functions FP H and FBP satisfy the same properties of FL (see Lemma 3.2(i)). This is not true
for the Hamiltonian H ON deﬁned in (15) since FON is bounded (see Lemma 3.2(ii)).
Validation of hypothesis (H5)
For H(x, u, p) equal to H L and F equal to FL, we have

H(x, u, p − λn(x)) ≥ e−2R + δf 2F (W (x, p − λn(x)))

= e−2R + δf 2(cid:112)W (x, p − λn(x)) + 1
≥ e−2R + δf 2(cid:112)f 2|p − λn(x)|2

= e−2R + δf 2f|p − λn(x)|

that goes to +∞ for λ → +∞. Hence, we get (H5) for the Lambertian Hamiltonian (10).
The previous argument applies also to the Phong Hamiltonian (22) since for W (x, p) ≥ 1 the
behavior of H P H is as the one of H L.
For the BP–model, considering the associated Hamiltonian H BP deﬁned in (26) we have

H BP (x, u, p − λn(x)) ≥ e−2R + δf 2F BP (W (x, p − λn(x)))

(56)

= e−2R + δf 2

(W (x, p − λn(x)) + 1) c

kD(W (x, p − λn(x)) + 1)

(W (x, p − λn(x)) + 1) c

2

(kD + kS)(W (x, p − λn(x)) + 1)

2
c−1
2 + kS

≥ e−2R + δf 2

= e−2R + δf 2

(cid:112)W (x, p − λn(x)) + 1
(cid:112)f 2|p − λn(x)|2
≥ e−2R + δf 2
= e−2R + δf 2 f|p − λn(x)|
(kD + kS)
that goes to +∞ for λ → +∞. Hence, we get (H5) for H BP .

(kD + kS)

(kD + kS)

c−1
2

(57)

14

As a consequence of the previous Proposition 5.3 and Theorem 4.4, we get the following

Corollary 5.4. We have

(i) For H given by H L, H P H or H BP , the boundary value problem (51) with either Dirichlet,
Neumann or state constraints boundary conditions in viscosity sense satisﬁes the Maxi-
mum Principle for discontinuous viscosity solutions and therefore it admits at most one
viscosity solution.

(ii) For H given by H ON , the boundary value problem (51) with Neumann boundary condition
in viscosity sense satisﬁes the Maximum Principle for discontinuous viscosity solutions
and therefore it admits at most one viscosity solution.

We do not discuss here the existence of a viscosity solution to the boundary value problems
(50) and (51). Since the SfS problem is an inverse problem in Computer Vision, we a priori know
that, if we prescribe the correct boundary conditions, the solution u is given by the height of
the surface to be reconstructed. Moreover, thanks to the Maximum Principle for discontinuous
viscosity solutions, see Theorem 4.4, it is possible to get existence of a solution by proving
the convergence of the various schemes considered in literature (see e.g.
[7, 10]). Finally, the
Maximum Principle is also a key ingredient to get existence of a solution via Perron’s method,
once a subsolution and a supersolution of the problem have been constructed (see [9]).

We conclude with some remarks about the diﬀerent boundary conditions in Shape from
Shading theory. The choice of the boundary condition obviously depends on the chosen model
and on available data. But, as observed in [19], the advantage of the state constraints bound-
ary condition with respect to the Dirichlet and Neumann boundary conditions is that it does
not require any a priori information about the solution at the boundary. Nevertheless, the
approximation of this boundary condition can be diﬃcult. In the next lemma we show that
the solution of a Dirichlet problem with a large constant as boundary data and the solution
of state constraints problem are upper bounded by the same constant M (independent of the
solution). Therefore, in this case, by the very deﬁnition of boundary conditions in weak sense,
the Dirichlet supersolution condition reduces to the state constraint one (52). It follows that to
approximate a problem with state constraints boundary condition is suﬃcient to consider the
corresponding problem with Dirichlet boundary datum given by a constant M suﬃciently large.
Lemma 5.1. For H(x, u, p) equal to either H L, H P H , or H BP , if the intensity image I in
(54) veriﬁes

I(x) ≥ δ > 0,

∀x ∈ Ω,

then the solution of the Dirichlet problem (50) with an appropriately large constant as boundary
data and the solution of the problem (51) with state constrains conditions are upper bounded by
the same constant (dependent only on the data of the problem).
Proof. For H(x, u, p) equal to H L, let us deﬁne M L = − 1
+ I(x)f 2 ≥ 0

H L(x, M L, 0) = −e−2M L

2 ln(δf 2). Then, we have

∀x ∈ Ω.

Therefore, the constant function u(x) ≡ M L is a supersolution of (50) in Ω. Moreover, ∀x ∈ ∂Ω
and ∀ξ ∈ R2, we have

H L(x, M L, ξ) = −e−2M L

(58)
which implies that u(x) ≡ M L is a supersolution of (27) on the boundary and therefore, see
(52), a supersolution of the state constraint boundary problem in Ø. Hence, by Theorem 4.4 and
Corollary 5.4, the solutions of the Dirichlet and state constraints problems with Hamiltonian
H L are upper bounded by M L.

We now prove the same result for the Phong model. Let us deﬁne M P H = − 1

2 ln(

+ I(x)f 2(cid:112)W (x, ξ) + 1 ≥ −e−2M L

+ I(x)f 2 ≥ 0,

We have

H P H (x, M P H , 0) = −e−2M P H

+

= − δf 2

kD + kS

+

15

(I(x) − kAIA(x))f 2
(I(x) − kAIA(x))f 2

kD + kS

kD + kS

δf 2

kD+kS

).

(59)

(60)

that is non-negative since I(x) = (I(x) − kAIA(x)) ≥ δ > 0, ∀x ∈ Ω.
Therefore, the constant function M P H is a supersolution of (51) in Ω for the PH–model. More-
over, ∀x ∈ ∂Ω and ∀ξ ∈ R2, we have
for W (x, p) > 1,

+ (I(x) − kAIA(x))f 2(cid:112)W (x, ξ) + 1

+ (I(x) − kAIA(x))f 2 ≥ 0;

H P H (x, M P H , ξ) = −e−2M P H
≥ −e−2M P H

for 0 ≤ W (x, p) ≤ 1,
H P H (x, M P H , ξ) = −e−2M P H

+ (I(x) − kAIA(x))f 2

kD(W (x, ξ) + 1)α + kS(W (x, ξ) + 1)1/2(1 − W (x, ξ))α

(W (x, ξ) + 1)α+1/2

≥ −e−2M P H

+

(I(x) − kAIA(x))f 2

≥ 0.

kD + kS

So, the constant function M P H for the PH–model is a supersolution of (51) in Ω for both the
Dirichlet problem with boundary datum M P H and the state constraints one.

For the BP–model, we can consider the same constant used for the PH–model and repeat

the same steps to prove the Lemma.

6 Conclusions

In this paper we have shown the well-posedness of several non-Lambertian models in an ana-
lytical way thanks to the introduction of an attenuation term, under a perspective projection
with a unique light source located at the optical center of the camera. We have derived the
Hamilton-Jacobi equations associated to each reﬂectance model and then we have obtained a
uniﬁed formulation showing useful properties for the general Hamiltonian. We have clariﬁed
the diﬀerences between the various models from the point of view of the problem with Dirichlet
boundary conditions (BC), Neumann BC and state constraints BC. This analysis explains (and
corrects) in details the empirical deductions coming from previous works on non-Lmabertian
models (see e.g. the conclusion reported in [1] regarding the concave/convex ambiguity for the
ON-model), focusing the attention on the important role of the boundary conditions and pro-
viding also an useful theoretical tool for the numerical point of view thanks to the last Lemma
5.1.

References

[1] A.H. Ahmed and A.A. Farag. A new formulation for Shape from Shading for non-
Lambertian surfaces. In Proc. IEEE Conference on Computer Vision and Pattern Recog-
nition (CVPR), pages 1817–1824, 2006.

[2] A.H. Ahmed and A.A. Farag. Shape from shading under various imaging conditions. In
IEEE International Conference on Computer Vision and Pattern Recognition CVPR’07,
pages X1–X8, Minneapolis, MN, June 2007.

[3] M. Bardi and I. Capuzzo-Dolcetta. Optimal control and viscosity solutions of Hamilton-

Jacobi-Bellman equations. Modern Birkh¨auser Classics. Birkh¨auser, Boston, 2008.

[4] G. Barles.

Solutions de viscosit´e des ´equations de Hamilton-Jacobi, volume 17 of
Math´ematiques & Applications (Berlin) [Mathematics & Applications]. Springer-Verlag,
Paris, 1994.

[5] G. Barles and P.E. Souganidis. Convergence of approximation schemes for fully nonlinear

second order equations. Asymptotic Anal., 4(3):271–283, 1991.

16

[6] J.F. Blinn. Models of light reﬂection for computer synthesized pictures. Computer Graphics,

11(2):192–198, 1977.

[7] M. Breuß, E. Cristiani, J.-D. Durou, M. Falcone, and O. Vogel. Perspective shape from
shading: Ambiguity analysis and numerical approximations. SIAM J. Imaging Sciences,
5(1):311–342, 2012.

[8] A.R. Bruss. The image irradiance equation: Its solution and application. Technical report

ai-tr-623, Massachusetts Institute of Technology, June 1981.

[9] M.G. Crandall, H. Ishii, and P.L. Lions. User’s guide to viscosity solutions of second order

partial diﬀerential equations. Bull. Amer. Math. Soc. (N.S.), 27(1):1–67, 1992.

[10] J.-D. Durou, M. Falcone, and M. Sagona. Numerical methods for shape-from-shading: A
new survey with benchmarks. Computer Vision and Image Understanding, 109(1):22–43,
2008.

[11] M. Falcone and R. Ferretti.

Hamilton-Jacobi equations.
Philadelphia, PA, 2014.

Semi-Lagrangian approximation schemes for linear and
Society for Industrial and Applied Mathematics (SIAM),

[12] B.K.P. Horn and M.J. Brooks. The variational approach to Shape from Shading. Computer

Vision, Graphics and Image Processing, 33(2):174–208, 1986.

[13] B.K.P. Horn and M.J. Brooks. Shape from Shading (Artiﬁcial Intelligence). The MIT

Press, 1989.

[14] Y.-C. Ju, S. Tozza, M. Breuß, A. Bruhn, and A. Kleefeld. Generalised Perspective Shape
from Shading with Oren-Nayar Reﬂectance. In Proceedings of the 24th British Machine
Vision Conference (BMVC 2013), pages 42.1–42.11, Bristol, UK, 2013. BMVA Press.

[15] T. Okatani and K. Deguchi. Shape reconstruction from an endoscope image by shape from
shading technique for a point light source at the projection center. Computer Vision and
Image Understanding, 66(2):119–131, 1997.

[16] M. Oren and S.K. Nayar. Generalization of the Lambertian model and implications for

machine vision. International Journal of Computer Vision, 14(3):227–251, 1995.

[17] M. Oren and S.K. Nayar. Generalization of lambert’s reﬂectance model. In SIGGRAPH ’94
Proceedings of the 21st annual conference on Computer graphics and interactive techniques,
pages 239–246, Orlando, FL, USA, July 1994.

[18] B.T. Phong. Illumination for computer generated pictures. Communications of the ACM,

18(6):311–317, 1975.

[19] E. Prados and O. Faugeras. Shape from shading: a well-posed problem? In International
Conference on Computer Vision and Pattern Recognition CVPR05, volume 2, pages 870 –
877, San Diego, CA, USA, June 2005.

[20] E. Prados, O. Faugeras, and F. Camilli. Shape from Shading: a well-posed problem?

Technical Report 5297, INRIA, August 2004.

[21] E. Rouy and A. Tourin. A viscosity solutions approach to shape-from-shading. SIAM J.

Numer. Anal., 29(3):867–884, 1992.

[22] S. Tozza and M. Falcone. Analysis and approximation of some Shape–from-Shading models
for non-lambertian surfaces. Journal of Mathematical Imaging and Vision, 2016. http:
//arxiv.org/abs/1502.05197.

[23] O. Vogel, M. Breuß, and J. Weickert. Perspective Shape from Shading with Non-Lambertian
Reﬂectance. In Gerhard Rigoll, editor, Pattern Recognition, volume 5096 of Lecture Notes
in Computer Science, pages 517–526. Springer Berlin Heidelberg, 2008.

[24] R. Zhang, P.-S. Tsai, J.E. Cryer, and M. Shah. Shape from shading: A survey. IEEE

Transactions on Pattern Analysis and Machine Intelligence, 21(8):690–706, 1999.

17

