6
1
0
2

 
r
a

 

M
3
1
 
 
]

.

C
A
h
t
a
m

[
 
 

1
v
2
3
0
4
0

.

3
0
6
1
:
v
i
X
r
a

A FUNCTION DETERMINED BY A HYPERSURFACE OF

POSITIVE CHARACTERISTIC

KOSUKE OHTA (MEIJI UNIVERSITY)

ABSTRACT. Let R = k[[X1, . . . , Xn+1]] be a formal power series ring over a
perfect ﬁeld k of prime characteristic p > 0, and let m = (X1, . . . , Xn+1) be the
maximal ideal of R. Suppose 0 6= f ∈ m. In this paper, we introduce a function
ξf (x) associated with a hypersurface deﬁned on the closed interval [0, 1] in R.
The Hilbert-Kunz function and the F-signature of a hypersurface appear as
the values of our function ξf (x) on the interval’s endpoints. The F-signature
of the pair, denoted by s(R, f t), was deﬁned in [3]. Our function ξf (x) is

integrable, and the integral Z 1

t

ξf (x)dx is just s(R, f t) for any t ∈ [0, 1].

1. Introduction

In this paper, we introduce a function ξf (x) associated with a hypersurface
deﬁned on the closed interval [0, 1] in R. The Hilbert-Kunz function and the
F-signature of a hypersurface appear as the values of our function ξf (x) on the
interval’s endpoints.

Deﬁnition 1.1. Let (R, n, k) be a d-dimensional Noetherian local ring of prime
characteristic p > 0. The Hilbert-Kunz multiplicitiy of R is

eHK (R) = lim
e→∞

ℓ(R/n[pe])

ped

,

where ℓ(R/n[pe]) is the length of R/n[pe], and n[pe] is the ideal generated by all the
pe-th powers of elements of n. Monsky showed that this limit always esists ([8]).

Let (R, n, k) be a d-dimensional Noetherian local ring of prime characteristic
p > 0, and let F : R → R be the Frobenius map, that is F (x) = xp for any x ∈ R.
Taking a positive integer e > 0, we obtain the ring R, denoted by F e
∗ R, viewed
as an R-module via the e-th Frobenius map. The element s in F e
∗ R is sometimes
denoted by F e
s). We deﬁne the
F-signature as follows.

∗ (s). For a, e ∈ R, we have a · F e

∗ (s) = F e

∗ (ape

Deﬁnition 1.2. Let (R, n, k) be a d-dimensional complete Cohen-Macaulay local
ring of prime characteristic p > 0. Assume that R is an F-ﬁnite ring, namely, the
Frobenius map F : R → R is ﬁnite. Suppose F e
∗ R ≃ R⊕ae ⊕ Me with some integer
ae and some R-module Me, where Me has no free direct summands. The number
ae is called e-th F robenius splitting number of R. Then,

s(R) = lim
e→∞

ae
ped

1991 Mathematics Subject Classiﬁcation. 13F25.
Key words and phrases. F-pure threshold; F-signature; F-signature of pair; Hilbert-Kunz func-

tion; hypersurface; Hilbert-Kunz function.

1

2

KOSUKE OHTA

is called the F -signature of R. Tucker showed this limit always exists ([9], Theorem
4.9).

In the rest of this paper, let n ≥ 1. Let R = k[[X1, . . . , Xn+1]] be a formal
power series ring over a perfect ﬁeld k of prime characteristic p > 0, and let m =
(X1, . . . , Xn+1) be the maximal ideal of R. Suppose 0 6= f ∈ m. Rings of the form
R/(f ) are called “n-dimensional hypersurf ace”.

Deﬁnition 1.3. We deﬁne

Me, t =

(f t) + m[pe]
(f t+1) + m[pe] ≃

R

[(f t+1) + m[pe]] : f t ,

where e ≥ 0 and t ≥ 0 are integers.

Then we have, for any t ≥ 0, the surjection

because [(f t+1) + m[pe]] : f t ⊂ [(f t+2) + m[pe]] : f t+1 ⊂ R.

Let R = R/m[pe]. Then, remark that Me, t = f tR/f t+1R.

Me, t → Me, t+1

Deﬁnition 1.4. We deﬁne

pen
where ℓR(Me, t) is the length as an R-module.

Ce, t =

ℓR(Me, t)

,

Then we have

pe ≥ Ce, 0 ≥ Ce, 1 ≥ Ce, 2 ≥ · · · ≥ Ce, pe−1 ≥ Ce, pe = Ce, pe+1 = · · · = 0.

(1)

A sequence of functions {ξf,e : [0, 1] → R}e≥0 is deﬁned by

ξf,e(x) =(Ce, ⌊xpe⌋

Ce, pe−1

(0 ≤ x < 1)
(x = 1)

,

where ⌊xpe⌋ = max {a ∈ Z|xpe ≥ a} is the ﬂoor function. By the deﬁnition, we

0

have Z 1
Z 1

0

ξf,e(x)dx = 1 because

ξf,e(x)dx =

=

=

=

1

pe(cid:0)Ce, 0 + Ce, 1 + Ce, 2 + · · · + Ce, pe−1(cid:1)
1
pe ×
1

pen(cid:0)ℓR(Me, 0) + ℓR(Me, 1) + · · · + ℓR(Me, pe−1)(cid:1)

1

[pe])

pe(n+1) ℓR(R/m
pe(n+1) × pe(n+1)

1

= 1.

Deﬁnition 1.5. We deﬁne the function ξf (x) by

ξf (x) = lim sup

e→∞

ξf,e(x)

for x ∈ [0, 1].

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 3

By the inequalities (1), ξf (x) is decreasing on [0, 1]. If

ξf,e(α) exists, then
ξf,e(α). The sequence {Ce, 0}e is increasing by Lemma 2.1 in section

lim
e→∞

ξf (α) = lim
e→∞
2.

lim
e→∞

Ce, 0 = lim
e→∞

ℓR(Me, 0)

pen

= lim
e→∞

ℓR(R/(f ) + m[pe])

pen

.

This limit exists and is called the Hilbert-Kunz multiplicity of R/(f ), denoted by
eHK(R/(f )). Therefore, by (1), lim sup
ξf,e(α) is not +∞ for any α ∈ [0, 1]. We

e→∞

shall give an example that lim
e→∞
in section 3. We have

ξf,e(α) dose not exist for some f ∈ R and α ∈ [0, 1]

ξf (0) = eHK(R/(f )).

Therefore, ξf (x) is a bounded and decreasing function on [0, 1]. In particular, ξf (x)
is integrable, and has at most countably many points of discontinuity on [0, 1].

The main theorem of this paper is the following:

Theorem 1.6. 1) The function ξf (x) is decreasing. There exists a countable sub-
set C of the interval [0, 1] such that ξf (x) is continuous at any α ∈ [0, 1] − C.
Moreover, ξf (x) is continuous at 0 and 1.

2) If ξf (x) is continuous at α ∈ [0, 1], then lim
e→∞
3) We have ξf (0) = eHK (R/(f )), and also ξf (1) = s(R/(f )).
4) Suppose that ξf (1) = 0, then fpt(f ) = inf{α ∈ [0, 1] | ξf (α) = 0} holds, where
is the F-pure threshold of f , where µf (pe) = min{t ≥

ξf,e(α) = ξf (α).

µf (pe)

fpt(f ) = lim
e→∞
1 | f t ∈ m[pe]}.

pe

5) The function ξf (x) is integrable, and we have Z
integers 0 ≤ a < pe. In particular, Z 1

6) If R/(f ) is normal then ξ′

f (0) = 0, where ξ′

0

ξf (x)dx = 1 holds.

f is the derivative of ξf .

a+1
pe

a
pe

ξf (x)dx =

ℓR(Me, a)
pe(n+1)

for

Remark 1.7. By Theorem 1.1 and Proposition 3.2 (i) in [2], we know that above
fpt(f ) is a positive rational number. Note that F-pure thresholds are deﬁned as the
smallest of the F-jumping exponents in [2].

Remark 1.8. We deﬁne the function ϕf (x) on [0, 1] as follows;

ϕf (x) =Z x

0

ξf (t)dt.

Actually, we have

ϕf (x) = lim
e→∞

1

pe (cid:0)Ce, 0 + Ce, 1 + · · · + Ce, ⌊xpe⌋−1(cid:1) .

Since ξf (x) is bounded and integrable on [0, 1], ϕf (x) is Lipschitz continuous on
[0, 1].
In particular, ϕf (x) is continuous on [0, 1]. We can rewrite 3) and 4) in
Theorem 1.6 as follows;

3’) The function ϕf (x) is diﬀerentiable at x = 0 and 1, and ϕ′

f (0) = eHK(R/(f ))

and ϕ′

f (1) = s(R/(f )).

4

KOSUKE OHTA

4’) Suppose that s(R/(f )) = 0, then

fpt(f ) = inf{α ∈ [0, 1] | ϕf (α) = 1}

holds.

Let (A, n) be an F-ﬁnite regular local ring, and let g ∈ A be a non-zero element. In
[3], the F-signature of the pair (A, gt) for any real number t ∈ [0, 1] is denoted as

s(A, gt) = lim
e→∞

1

pe(n+1) ℓA(cid:18)

A

n[pe] : g⌈t(pe−1)⌉(cid:19) .

Using 5) in Theorem 1.6, we know

1 − ϕf (x) =Z 1

t

ξf (x)dx = s(R, f t)

for t ∈ [0, 1]. Moreover, if we know that ξf (x) is continuous at 0 and 1 (see Theorem
1.6 1)), we obtain 3) in Theorem 1.6 immediately from Theorem 4.4 in [3].

In section 2, we shall prove Theorem 1.6. The following corollary immediately

follows from Theorem 1.6 3) and 5)

Corollary 1.9. eHK(R/(f )) × fpt(f ) ≥ 1.

1 ) =

Example 1.10. Suppose R = k[[X1, X2, . . . , Xn+1]] and α > 0. Then eHK (R/(X α
α and fpt(X α
1 for a linear transformation τ (for
example, f = X1 + X2), then eHK (R/(f )) × fpt(f ) = 1 and s(R/(f )) = 1 (see
section 3). We do not know another example that the equality holds in Corollary
1.9.

. Therefore, if τ (f ) = X α

1
α

1 )) =

Remark 1.11. By Theorem 1.6 1), 3) and 5), we immediately know that eHK(R/(f )) =
1 if and only if s(R/(f )) = 1. These conditions are equivalent to that R/(f ) is reg-
ular by the following results.
1) Let S be an unmixed local ring of positive characteristic. Then eHK (S) = 1 if

and only if S is regular ([10], Theorem 1.5).

2) Let S be a reduced F-ﬁnite Cohen-Macaulay local ring of positive characteristic.

Then s(S) = 1 if and only if S is regular ([5], Corollary 16).

Remark 1.12. Let m < n = dim R/(f ), and set ae = ℓ(Me, pe−1). Assume that
ae = αpem + o(pem), that is lim
e→∞

ae
pem = α. Let ge = ae − αpem. Then

ϕf (1) − ϕf (cid:18) pe − 1

pe (cid:19) =

=

=

holds. Let x =

pe − 1

pe

. Since x − 1 = −

ℓ(Me, i)
pe(n+1) −

pe−2

Xi=0

ℓ(Me, i)
pe(n+1)

pe−1

Xi=0

ℓ(Me, pe−1)

pe(n+1)

α

pe(n−m+1) +
1
pe , we know

ge

pe(n+1)

ϕf (x) = ϕf (1) + (−1)n−mα(x − 1)n−m+1 + o((x − 1)n−m+1).

(2)

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 5

Since ϕf (x) is continuous on [0, 1] from Remark 1.7, ϕf (x) has the form of (2)
around the point x = 1. Therefore, if ϕf (x) is equal to its Taylor series around the
point x = 1, we obtain that

(−1)n−m(n − m + 1)!α (i = n − m + 1)

(i = 1, 2, . . . , n − m)

,

ϕ(i)

f (1) = (0
f (x) = (0

ξ(i)

(−1)n−m(n − m + 1)!α (i = n − m)

(i = 1, 2, . . . , n − m − 1)

.

2. Proof of main theorem

Let F : R → R be the Frobenius map a 7→ ap. Since k is perfect, we have F∗R ≃
(f pt) + m[pe+1]
(f pt+p) + m[pe+1] = Me, t⊗R F∗R ≃

, where F∗R stands for F 1

∗ R. Therefore,

R⊕pn+1

(Me, t)⊕pn+1

for all e, t ≥ 0. Consequently,

p × Ce, t = Ce+1, pt + Ce+1, pt+1 + · · · + Ce+1, pt+p−1,

(3)

where the sum on the right-hand side of (3) has p-terms. That is, Ce, t is the mean
of Ce+1, pt, Ce+1, pt+1, · · · , Ce+1, pt+p−1. Therefore, by (1) and (3), we obtain the
following inequalities immediately.

Lemma 2.1. Ce+1, pt ≥ Ce, t ≥ Ce+1, pt+p−1.

Hence, by (1) and Lemma 2.1, we have

Ce, ⌊xpe⌋−1

≥

by Lemma 2.1

Ce+1, (⌊xpe⌋−1)p+(p−1) ≥ Ce+1, ⌊xpe+1⌋−1

≤

Ce, ⌊xpe⌋

≤

Ce, ⌈xpe⌉

≤

by Lemma 2.1

Ce+1, ⌈xpe⌉p

≤ Ce+1, ⌈xpe+1⌉

≤

Ce+1, ⌊xpe+1⌋

≤

and here, we note that ⌊xpe⌋p ≤ ⌊xpe+1⌋ and ⌈xpe⌉p ≥ ⌈xpe+1⌉. Therefore, the
sequence {Ce, ⌊xpe⌋−1}e is decreasing, the sequence {Ce, ⌈xpe⌉}e is increasing, and
Ce, ⌊xpe⌋−1 ≥ Ce, ⌈xpe⌉ for all e ≥ 0 by the inequalities (1). Consequently, the limits
lim
e→∞

Ce, ⌈xpe⌉ exist in R. In particular,

Ce, ⌊xpe⌋−1 and lim
e→∞

Ce, ⌊αpe⌋−1 ≥ lim
e→∞

Ce, ⌊αpe⌋−1 ≥ ξf (α) ≥ lim
e→∞

Ce, ⌈αpe⌉ ≥ Ce, ⌈αpe⌉ ≥ 0

(4)

holds for any α ∈ (0, 1] and e satisfying ⌊αpe⌋ − 1 ≥ 0.

Lemma 2.2. We set C(α) = lim
e→∞

Ce, ⌈αpe⌉ for α ∈ [0, 1] and C(β) = lim
e→∞

Ce, ⌊βpe⌋−1

for β ∈ (0, 1].
1) For α ∈ [0, 1] and any integer i ≥ 0, {Ce+1, ⌈αpe⌉p+i}e is an increasing sequence.
Ce, ⌈αpe⌉+k exist for any non-negative

The limits lim
e→∞
integers i, k ≥ 0. Furthermore,

Ce+1, ⌈αpe⌉p+i and lim
e→∞

C(α) = lim
e→∞

Ce+1, ⌈αpe⌉p+i = lim
e→∞

Ce, ⌈αpe ⌉+k

(5)

holds.

6

KOSUKE OHTA

2) For β ∈ (0, 1] and any integer i > 0, {Ce+1, ⌊βpe⌋p−i}e is a decreasing sequence.
Ce, ⌊βpe⌋−k exist for any positive integers

Ce+1, ⌊βpe⌋p−i and lim
e→∞

The limits lim
e→∞
i, k > 0. Furthermore,

C(β) = lim
e→∞

Ce+1, ⌊βpe⌋p−i = lim
e→∞

Ce, ⌊βpe⌋−k

(6)

holds.

Proof. Let α ∈ [0, 1] and β ∈ (0, 1], and let k ≥ 0 and ℓ > 0 be integers. We know

((⌈αpe⌉p + k)p = ⌈αpe⌉p2 + kp ≥ ⌈αpe+1⌉p + kp ≥ ⌈αpe+1⌉p + k

(⌊βpe⌋p − ℓ)p + (p − 1) ≤ ⌊βpe⌋p2 − ℓp + (p − 1)ℓ ≤ ⌊βpe+1⌋p − ℓ

,

and therefore

(Ce+1, ⌈αpe⌉p+k ≤ Ce+2, (⌈αpe⌉p+k)p ≤ Ce+2, ⌈αpe+1⌉p+k ≤ lim

Ce+1, ⌊βpe⌋p−ℓ ≥ Ce+2, (⌊βpe⌋p−ℓ)p+(p−1) ≥ Ce+2, ⌊βpe+1⌋p−ℓ ≥ 0

e→∞

Ce, 0

by (1) and Lemma 2.1. Hence, {Ce+1, ⌈αpe ⌉p+k}e is increasing and bounded. {Ce+1, ⌊βpe⌋p−ℓ}e
is decreasing and bounded. Therefore,
exist.

Ce+1, ⌈αpe⌉p+k and lim
e→∞

Ce+1, ⌊βpe⌋p−ℓ

lim
e→∞

Next, we shall show that

C(α) = lim
e→∞
C(β) = lim
e→∞

Ce+1, ⌈αpe⌉p+i

Ce+1, ⌊βpe⌋p−j

(7)

(8)

holds for any integers 0 ≤ i ≤ p − 1 and 1 ≤ j ≤ p. We have

(p × Ce, ⌈αpe ⌉ = Ce+1, ⌈αpe⌉p + Ce+1, ⌈αpe⌉p+1 + · · · + Ce+1, ⌈αpe⌉p+p−1

p × Ce, ⌊βpe⌋−1 = Ce+1, ⌊βpe⌋p−p + Ce+1, ⌊βpe⌋p−(p−1) + · · · + Ce+1, ⌊βpe⌋p−1

by (3). Thus, it holds that

p × lim
e→∞
p × lim
e→∞

Ce, ⌈αpe⌉ = lim
e→∞

Ce+1, ⌈αpe⌉p + · · · + lim
e→∞

Ce+1, ⌈αpe⌉p+p−1

Ce, ⌊βpe⌋−1 = lim
e→∞

Ce+1, ⌊βpe⌋p−p + · · · + lim
e→∞

Ce+1, ⌊βpe⌋p−1

.

On the other hand, we have







lim
e→∞
lim
e→∞

Ce, ⌈αpe⌉ = lim
e→∞

Ce+1, ⌈αpe⌉p ≥ lim
e→∞

Ce+1, ⌈αpe⌉p+1 ≥ · · · ≥ lim
e→∞

Ce+1, ⌈αpe⌉p+p−1

Ce, ⌊βpe⌋−1 = lim
e→∞

Ce+1, ⌊βpe⌋p−1 ≤ lim
e→∞

Ce+1, ⌊βpe⌋p−2 ≤ · · · ≤ lim
e→∞

Ce+1, ⌊βpe⌋p−p

since Ce, ⌈αpe⌉ ≤ Ce+1, ⌈αpe⌉p ≤ Ce+1, ⌈αpe+1⌉ and Ce, ⌊βpe⌋−1 ≥ Ce+1, ⌊βpe⌋p−1 ≥
Ce+1, ⌊βpe+1⌋−1. Consequently, we have the equations (7) and (8).

In order to complete the proof of the assertion 1), we have the inequalities

Ce, ⌈αpe⌉+k ≤ Ce+1, (⌈αpe⌉+k)p
= Ce+1, ⌈αpe⌉p+kp
≤ Ce+1, ⌈αpe⌉p+k
≤ Ce+1, ⌈αpe+1⌉+k

for any k ≥ 1. Hence,

Ce, ⌈αpe⌉+k = lim
e→∞
holds. Therefore, we obtain the equation (5).

lim
e→∞

Ce+1, ⌈αpe⌉p+k

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 7

In order to complete the proof of the assertion 2), we have the inequalities

Ce, ⌊βpe⌋−k ≥ Ce+1, (⌊βpe⌋−k)p+p−1
= Ce+1, ⌊βpe⌋p−(k−1)p−1
≥ Ce+1, ⌊βpe⌋p−k
≥ Ce+1, ⌊βpe+1⌋−k

for any k ≥ 2. Hence,

Ce, ⌊βpe⌋−k = lim
e→∞
holds. Therefore, we obtain the equation (6).

lim
e→∞

Ce+1, ⌊βpe⌋p−k

(cid:3)

Proposition 2.3. 1) For α ∈ [0, 1),

2) For β ∈ (0, 1],

lim

x→β−0

In particular, we have

ξf (x) = lim
e→∞

lim

ξf (x) = lim
e→∞

x→α+0
Ce, ⌊βpe⌋−1 holds.

Ce, ⌈αpe⌉ holds.

lim
x→+0
lim

x→1−0

ξf (x) = lim
e→∞
ξf (x) = lim
e→∞

Ce, 0 = ξf (0)

Ce, pe−1 = ξf (1)

,




that is to say that ξf (x) is continuous at x = 0 and 1.

Proof. 1) First, we show lim

ξf (x) ≤ lim
e→∞
enough number e′, we may assume that αpe′
⌊x0pe′

⌋ − 1. Hence, by the inequalities (1) and (4),

x→α+0

Ce, ⌈αpe⌉. Take x0 > α. For a large
≤ x0pe′

− 2 holds. Then, ⌈αpe′

⌉ ≤

ξf (x0) ≤ Ce′, ⌊x0pe′ ⌋−1 ≤ Ce′, ⌈αpe′ ⌉ ≤ lim
e→∞

Ce, ⌈αpe⌉

as desired.

Next, we shall show the opposite inequality. By Lemma 2.2 1), we have only to

show that

For any e ≥ 0, α <

α < x1 <

⌈αpe⌉ + 1

pe

lim

x→α+0

ξf (x) ≥ lim
e→∞

Ce, ⌈αpe⌉+1.

⌈αpe⌉ + 1

pe

. Hence, there exists a real number x1 ∈ R such that

. Then ⌈x1pe⌉ ≤ ⌈αpe⌉ + 1, and therefore

lim

x→α+0

ξf (x) ≥ ξf (x1) ≥ Ce, ⌈x1pe⌉ ≥ Ce, ⌈αpe⌉+1

for any e ≥ 0 because we have the inequalities (1) and (4), and ξf (x) is decreasing.
Consequenty,

lim

x→α+0

ξf (x) ≥ lim
e→∞

Ce, ⌈αpe⌉+1

as desired.

2) It is proved in the same way as 1).

Remark 2.4. From the inequalities (1), we have

Ce, ⌊αpe⌋−1 ≥ ξf,e(α) = Ce, ⌊αpe⌋ ≥ Ce, ⌈αpe⌉

for any α ∈ [0, 1]. Hence, if

lim
e→∞

Ce, ⌊αpe⌋−1 = lim
e→∞

Ce, ⌈αpe⌉,

(cid:3)

8

KOSUKE OHTA

there exists lim
e→∞

ξf,e(α) in R, and it is eqaul to ξf (α).

Corollary 2.5. If ξf (x) is continuous at α ∈ [0, 1] then lim
e→∞
it is equal to ξf (α).

ξf,e(α) exists, so that

Proof. The proof is obtained from Remark 2.4 immediately.

(cid:3)

We have just shown Theorem 1.6 1).
We obtain the following Corollary 2.6 immediately from Proposition 2.3.

Corollary 2.6. We deﬁne ϕf (x) by

ϕf (x) =Z x

ξf (t)dt

0
for x ∈ [0, 1]. Then we have the followings.
1) ϕf (x) is diﬀerentiable at 0, and ϕ′
2) ϕf (x) is diﬀerentiable at 1, and ϕ′

f (0) = ξf (0) = lim
e→∞
f (1) = ξf (1) = lim
e→∞

Ce, 0 = eHK(R/(f )).
Ce, pe−1.

Set µf (pe) = min{t ≥ 0 | f t ∈ m[pe]} for each e ≥ 0. Since f µf (pe) ∈ m[pe],

f µf (pe)p ∈ m[pe+1]. Hence µf (pe)p ≥ µf (pe+1), and so

1 ≥

µf (pe)

pe ≥

µf (pe+1)

pe+1 ≥ 0.

is decreasing and bounded below, the limit lim
e→∞

µf (pe)

pe

exists

Since (cid:26) µf (pe)

pe (cid:27)e≥0

in R, and it is called the F-pure threshold of f , denoted by fpt(f ). It is easy to see
that fpt(f ) ∈ (0, 1], and fpt(f ) = 1 if and only if µf (pe) = pe for any e ≥ 1.

Lemma 2.7. Ce, t = 0 if and only if t ≥ µf (pe).

Proof. If Me, t = 0, then Me, t = Me, t+1 = Me, t+2 = · · · = Me, pe = 0. Hence,
f t ∈ m[pe], and so t ≥ µf (pe). Conversely if t ≥ µf (pe), then f t ∈ m[pe] holds. (cid:3)

We start to prove Theorem 1.6. The assertion 1) follows from Proposition 2.3.
The assertion 2) follows from Corollary 2.5. The ﬁrst half of 3) follows from the
deﬁnition of Ce, 0. Now, we shall show 4).

Proof. First, we check that

inf{α ∈ [0, 1] | ξf (α) = 0} ≤ fpt(f ).

If fpt(f ) = 1, then the assertion is easy. Assume fpt(f ) < 1. Let 1 > α > fpt(f ).

Since fpt(f ) = inf

e≥0(cid:26) µf (pe)
pe (cid:27),

fpt(f ) ≤

µf (pe1 )

pe1

< α

holds for e1 ≫ 0. Then, it holds that

ξf (α) ≤ ξf(cid:18) µf (pe1 )
pe1 (cid:19)
e,(cid:4) µf (pe1 )

= lim sup

= 0

e→∞

pe1

C

pe(cid:5)

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 9

because, by Lemma 2.7,

Ce1+s, µf (pe1 )ps ≤ Ce1+s, µf (pe1 +s) = 0

for any integers s ≥ 0. Therefore, ξf (α) = 0 for all α > fpt(f ), as desired. Con-
versely, suppose α < fpt(f ). Hence, we have (fpt(f ) − α)pe′
≥ 1 for e′ ≫ 0, and
therefore αpe′

− 1. Then, since we have

≤ fpt(f )pe′

α ≤

fpt(f )pe′
pe′

− 1

<

fpt(f )pe′

pe′

= fpt(f ) ≤

µf (pe′
pe′

)

,

we obtain

Therefore,

α ≤

) − 1

µf (pe′
pe′

.

ξf (α) ≥ ξf   µf (pe′

) − 1

! ≥

e,(cid:6) µf (pe′
holds. We have Ce′, µf (pe′ )−1 6= 0 by Lemma 2.7. Since (C

by (4)

pe′

pe′

lim
e→∞

C

an increasing sequence, we obtain lim
e→∞

C

for all α such that α < fpt(f ), as desired.

e,(cid:6) µf (pe′

pe′

)−1

pe(cid:7)

Next, we shall show 5).

)−1

pe(cid:7)
e,(cid:6) µf (pe′

pe′

)e≥0

is

)−1

pe(cid:7)

(cid:3)

> 0. Therefore, ξf (α) > 0

Proof. Let F =nα ∈h a

pe , a+1

F . Recall that F is a countable set, and lim
e→∞

α is a discontinuity for ξf (x)o and Ω =h a

pe , a+1
ξf,e(α) = ξf (α) for any α ∈ Ω by

pe i−

Thorem 1.6 1), 2). Then, we have

pe i (cid:12)(cid:12)(cid:12)
ξf (x)dx = ZΩ
= ZΩ

a+1
pe

a
pe

Z

ξf (x)dx

lim
e→∞

ξf,e(x)dx

= lim

ξf,e(x)dx

a+1
pe

e→∞ZΩ
e→∞Z
1
pe Ce, a

a
pe

=

= lim

ξf,e(x)dx

by Lebegue’s dominated convergence theorem, as desired.

(cid:3)

We shall show 6).

Proof. Let g, h : N → R be functions. If there exists a positive constant C such
that |h(n)| ≤ Cg(n) for n ≫ 0, then we write h(n) = O(g(n)). If R/(f ) is normal,
then there exists β(R/(f )) ∈ R such that

eHK (R/(f ))pne + β(R/(f ))p(n−1)e = ℓR(Me, 0) + O(p(n−2)e)

10

KOSUKE OHTA

by Huneke-McDermott-Monsky [6]. Since a hypersurface is Gorenstein, that β(R/(f )) =
0 follows from Corollary 1.4 in Kurano [7]. Therefore, we have

eHK(R/(f ))pne = ℓR(Me, 0) + O(p(n−2)e).

(9)

First, we shall show that

−→ 0 (s → ∞).

Since the sequence (cid:8)Cs+i, pi(cid:9)i≥0 is increasing, we have

Ce, ⌊pe−s⌋ ≥ Cs, 1.

ξf(cid:16) 1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ξf(cid:18) 1

1
ps

ps(cid:17) − ξf (0)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
ps(cid:19) = lim sup
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

e→∞

=

Hence, we obtain

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ξf(cid:16) 1

ps(cid:17) − ξf (0)

1
ps

ps(cid:17)
ξf (0) − ξf(cid:16) 1

1
ps

≤

ξf (0) − Cs, 1

1
ps

.

Set λi(e) as eHK(R/(f ))pen − ℓR(Me, i) for each e ≥ 0 and 0 ≤ i ≤ p − 1. Note that

0 ≤ λ0(e) ≤ λ1(e) ≤ · · · ≤ λp−1(e).

Since we have,

p ×

ℓR(Ms−1, 0)

p(s−1)n =

ℓR(Ms, 0)

psn

+

ℓR(Ms, 1)

psn

+ · · · +

ℓR(Ms, p−1)

psn

for any s ≥ 1 by (3), then we obtain

p ×

λ0(s − 1)
p(s−1)n =

λ0(s)
psn +

λ1(s)
psn + · · · +

λp−1(s)

psn

.

Hence, since

it holds that

Therefore,

p ×

λ0(s − 1)
p(s−1)n ≥

λ1(s)
psn ,

p2 ×

λ0(s − 1)
p(s−1)(n−1) ≥

λ1(s)
ps(n−1) ≥ 0.

ξf (0) − Cs, 1

1
ps

=

=

ps
psn (eHK(R/(f ))psn − Cs, 1 × psn)
λ1(s)
ps(n−1)

≤ p2 ×

λ0(s − 1)
p(s−1)(n−1)

=

p2
ps−1 ×

λ0(s − 1)
p(s−1)(n−2)

→ 0 (e → ∞)

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 11

by the equation (9). Consequently, for any positive real number ε > 0, there exists
a nutural number s0 ∈ N such that s ≥ s0 implies that

Let δ =

1
ps0

Therefore,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ξf(cid:16) 1

ps(cid:17) − ξf (0)

1
ps

<

ε
p

.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

. If 0 < x < δ, then there exists s ∈ N such that

1
ps+1 < x <

1
ps ≤

1
ps0

.

ξf (x) − ξf (0)

x

(cid:12)(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)(cid:12)

=

≤

ξf (0) − ξf (x)

x

ξf (0) − ξf (cid:16) 1
ps(cid:17)

1

ps+1

ε
p

≤ p ×

= ε

as desired.

(cid:3)

Finally, we shall prove the last half of 3).

Deﬁnition 2.8. Let (S, n) be a (d + 1)-dimensional regular local ring. Let 0 6= α ∈
n. The pair (ρ, σ) is called a matrix f actorization of the element α if all of the
following conditions are satisﬁed:
(1) ρ : G → F and σ : F → G are S-homomorphisms, where F and G are ﬁnitely

generated A-free modules, and rankSF = rankSG.

(2) ρ ◦ σ = α · idF .
(3) σ ◦ ρ = α · idG.
Actually, if either (2) or (3) is satisﬁed, the other is satisﬁed.

Deﬁnition 2.9. Let (S, n) be a (d + 1)-dimensional regular local ring, and let
0 6= α ∈ n. Let (ρ, σ) and (ρ′, σ′) be matrix factorizations of α. We regard ρ and σ
as r × r matrixes with entries in S, and ρ′ and σ′ as r′ × r′ matrixes with entries
in S. Then, we write

(ρ, σ) ⊕ (ρ′, σ′) =(cid:18)(cid:18) ρ

0 ρ′ (cid:19) ,(cid:18) σ

0 σ′ (cid:19)(cid:19)

0

0

which is a matrix factorization of α.

Deﬁnition 2.10. Let (S, n) be a (d + 1)-dimensional regular local ring, and let
0 6= α ∈ n. A matrix factorization (ρ, σ) of α is called reduced if all the entries of
ρ and σ are in n.

Remark 2.11. Let (S, n) be a (d + 1)-dimensional regular local ring, and let 0 6=
α ∈ n. Let the map α : S → S be multiplication by α ∈ n on S. If (ρ, σ) is a matrix
factorization of α ∈ n, then we can write

(ρ, σ) ≃ (α, idS)⊕v ⊕ (idS, α)⊕u ⊕ (γ1, γ2),

12

KOSUKE OHTA

where v and u are some integers, and (γ1, γ2) is reduced. Therefore,

cok(ρ) ≃ cok(α)⊕v ⊕ cok(idS)⊕u ⊕ cok(γ1)

≃ (S/(α))⊕v ⊕ cok(γ1).

It is known that cok(γ1) has no free direct summands if (γ1, γ2) is reduced ([4],
Corollary 6.3). Consequently, v is equal to the largest rank of a free S/(α)-module
appearing as a direct summand of cok(ρ).

Let F e : R → F e
F e
∗ R. We have f = F e
∗ (f ), F e
(F e

∗ (f pe−1)) is a matrix factorization. We put

∗ R be the e-th Frobenius map. Consider the map f : F e

∗ (f pe

) = F e

∗ (f ) · F e

∗ (f pe−1) = F e

∗ (f pe−1) · F e

∗ R →
∗ (f ). Therefore,

(F e

∗ (f ), F e

∗ (f pe−1)) = (f, idR)⊕ve ⊕ (idR, f )⊕ue ⊕ (reduced).

By Remark 2.11 this implies that ve is the number of R/(f ) appearing as the direct
ve
pen is the F-signature of R/(f ),
summand of

∗ (R/(f )). That is,

∗ R) = F e

∗ R

F e

F e

lim
e→∞

∗ (f )(F e
denoted by s(R/(f )).

Proposition 2.12. ve = ℓR(Me, pe−1).

Proof. We can regard the map F e
matrix A with entries in R;

∗ (f pe−1) : F e

∗ R −→ F e

∗ R as a p(n+1)e × p(n+1)e

Ive

f

. . .

f

B

,





A =





where Ive is the identity matrix of size ve, and B is a matrix with entries in m.
Therefore, we have

ve = dimR/m(cid:16)Im(cid:0)R/m ⊗ F e

∗ (f pe−1)(cid:1)(cid:17) = dimR/mF e

∗ (cid:18) (f pe−1) + m[pe]

m[pe]

(cid:19) = Me, pe−1.

(cid:3)

We completed a proof of Theorem 1.6.

Remark 2.13. Let (S, n, k) be a complete regular local ring of characteristic p > 0.
Suppose that k is perfect. Let I be a ideal of S, and put S = S/I. Suppose that
ae is equal to the largest rank of a free S-module appearing in a direct summand
of F e

∗ S. Then it is known that

ae = dimk

(I [pe] : I) + m[pe]

m[pe]

by Fedder’s lemma (see [1]). If I = (f ), then

ae = dimk

(f pe−1) + m[pe]

m[pe]

.

A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 13

Let f = X α1
1 , X pe

2 , . . . , X pe

1 X α2

2

(X pe

3. Examples

· · · X αn+1

n+1 and α1 ≤ α2 ≤ · · · ≤ αn+1. We set (X pe

) =

n+1) for e ≥ 0. We have an exact sequence

0 −→ Me, t −→

(f t) + (X pe )
for any t ≥ 0. On the other hand, we have an exact sequence

(f t+1) + (X pe )

R

−→

R

−→ 0

0 −→

(f t) + (X pe

)

(X pe

)

−→

R
(X pe

)

−→

R

(f t) + (X pe

)

−→ 0

for any t ≥ 0. Hence,

ℓR(cid:18)

R

(f t) + (X pe

holds. Therefore, we have

)(cid:19) =


n+1

pe(n+1) −

pe(n+1)

Yj=1

(pe − tαj)

(if tαn+1 < pe)

(otherwise)

0

n+1

n+1

Yj=1
Yj=1




ℓR(Me, t) =

(pe − tαj)

n+1

(pe − tαj) −

Yj=1

If t <

pe

αn+1

− 1,

αn+1

(cid:18) pe
(cid:18) pe
(pe − (t + 1)αj) (cid:18)t <

αn+1

≤ t(cid:19)

− 1 ≤ t <

pe

αn+1(cid:19)

.

pe

αn+1

− 1(cid:19)

(10)

ℓR(Me, t) =

=

=

n+1

Yj=1
Xj=1
Xj=1

n+1

n+1

n+1

(pe − tαj) −

Yj=1

(pe − (t + 1)αj)

n+1

(−1)jtjβjpe(n+1−j) −

(−1)j(t + 1)jβjpe(n+1−j)

Xj=1

(−1)j+1 j−1
Xi=0(cid:18)j

i(cid:19)ti! βjpe(n+1−j),

where βj denotes the elementary symmetric polynomial of degree j in α1, α2, . . . , αn+1.
Hence

Ce, t =

ℓR(Me, t)

pen

n+1

=

Xj=1

(−1)j+1 j−1
Xi=0(cid:18)j

pe(j−1)! βj
i(cid:19) ti

holds. We shall calculate ξf (x). If x <

Then,

1

αn+1

, then ⌊xpe⌋ <

pe

αn+1

− 1 for e ≫ 0.

Ce, ⌊xpe⌋ =

n+1

Xj=1

(−1)j+1 j−1
Xi=0(cid:18)j

pe(j−1)! βj.
i(cid:19) ⌊xpe⌋i

14

KOSUKE OHTA

Since xpe − 1 ≤ ⌊xpe⌋ ≤ xpe, we have

lim
e→∞

Consequently,

⌊xpe⌋a

peb =(xa

0

(if a = b)
(if a < b)

.

ξf (x) = β1 − 2β2x + 3β3x2 − · · · + (−1)n(n + 1)βn+1xn

(11)

holds for 0 ≤ x <

By (10), we have

1

αn+1

. In particular, eHK(R/(f )) = ξf (0) = α1 + α2 + · · ·+ αn+1.

ξf (x) = 0

(12)

if x >

1

.

αn+1

Next, we shall calulate ξf(cid:18) 1

αn+1(cid:19). Since

pe

αn+1

− 1 ≤(cid:22) pe

αn+1(cid:23) ≤

pe

αn+1

for any

e ≥ 0,

ℓ(M

αn+1

e,(cid:4) 1

pe(cid:5)) =

where εe ≡ pe (mod αn+1) such that 0 ≤ εe < αn+1, and

δi pe(n−k)εk

e αi1 αi2 · · · αik


n

n

Xk=1 X1≤i1<i2<···<ik≤n
pe(cid:19)k
Xk=1


δk(cid:18) εe

,

εe

αj

αj

αn+1(cid:27)
αn+1(cid:19) pe +
Yj=1(cid:8)(αn+1 − αj)pe + εeαj(cid:9)

αj(cid:27)

αn+1

(αn+1 − αj) +

(αn+1 − αj) +

(αn+1 − αj),

δi αi1 αi2 · · · αik .

= εe

= εe

= εe(cid:18) 1
= εe(cid:18) 1
= εe(cid:18) 1

n+1

n

n

n

pen

Yj=1(cid:26)pe −(cid:22) pe
αn+1(cid:23)αj(cid:27)
Yj=1(cid:26)pe − (pe − εe)
Yj=1(cid:26)(cid:18)1 −
αn+1(cid:19)n n
αn+1(cid:19)n

pen
αn+1(cid:19)n

Yj6=i1,i2,...,ik
X1≤i1<i2<···<ik≤n
αn+1(cid:19)n


Yj=1
Yj=1

Yj=1

n

n

δi =

δk =

Hence,

C

αn+1

e,(cid:4) 1

pe(cid:5) = εe(cid:18) 1

(αn+1 − αj) +

n

Xk=1

,

pe(cid:19)k
δk(cid:18) εe


A FUNCTION DETERMINED BY A HYPERSURFACE OF POSITIVE CHARACTERISTIC 15

and therefore

lim sup

e→∞

C

pe(cid:5) =(cid:18)lim sup

e→∞

αn+1

e,(cid:4) 1

εe(cid:19)(cid:18) 1

αn+1(cid:19)n n
Yj=1

(αn+1 − αj).

(13)

We shall examine whether lim
e→∞

εe exists. Let αn+1 = psq, where q is coprime
to p, and s is a non-negative integer. If p ≡ 1 (mod q), then we can ﬁnd that εe is
constant for any e ≥ s by the Chinese remainder theorem. If p 6≡ 1 (mod q), then
εe is eventually periodic with period more than 1.

From the following Proposition 3.1, we get to know the function ξf (x).

Proposition 3.1. Let f = X α1

1 X α2

2

· · · X αn+1

n+1 with α1 ≤ α2 ≤ · · · ≤ αn+1.

1) We have fpt(f ) =

2)

lim
x→ 1
αn+1

−0

ξf (x) =(cid:18) 1

1

αn+1

. If αn+1 ≥ 2, we have s(cid:0)R/(f )(cid:1) = 0.
αn+1(cid:19)n−1 n
Yj=1

(αn+1 − αj) ≥ 0.

3) The function ξf (x) is continuous on [0, 1] if and only if αn+1 = αn holds.
4) Let αn+1 = psq, where q is coprime to p, and s is a non-negative integer. The

limit lim
e→∞

(mod q).

ξf,e(cid:18) 1

αn+1(cid:19) exists if and only if it satisﬁes that αn+1 = αn or p ≡ 1

Proof. By (11) and (12), we obtain 1) immeiately.

Next we shall prove 2). We set

g(x) = β1 − 2β2x + 3β3x2 − · · · + (−1)n(n + 1)βn+1xn

and

h(x) = (x − α1)(x − α2) · · · (x − αn+1).

Now, since h(x) = xn+1 − β1xn + β2xn−1 − · · · + (−1)n+1βn+1,

xn+1h(cid:18) 1

x(cid:19) = 1 − β1x + β2x2 − · · · + (−1)n+1βn+1xn+1.

Hence, we have the following equation

g(x) = −(cid:26)xn+1h(cid:18) 1

x(cid:19)(cid:27)′

= −(n + 1)xnh(cid:18) 1

x(cid:19) + xn−1h′(cid:18) 1
x(cid:19) .

Since h(αn+1) = 0,

lim
x→ 1
αn+1

−0

ξf (x) = g(cid:18) 1
= (cid:18) 1
= (cid:18) 1

αn+1(cid:19)
αn+1(cid:19)n−1
αn+1(cid:19)n−1 n
Yj=1

h′(αn+1)

(αn+1 − αj) ≥ 0.

The assertion 3) follows from (10), (11) and 2) as above. The assertion 4) follows
from the equation (13).
(cid:3)

16

KOSUKE OHTA

Example 3.2. If α1 = α2 = · · · = αn−2 = 0 and αn−1 6= 0, the derivative

g′(x) = −2(αn+1αn + αn+1αn−1 + αnαn−1) + 6αn+1αnαn−1x.

Let α be the root of g′(x) = 0, that is,

α =

1
3

×

αn+1αn + αn+1αn−1 + αnαn−1

αn+1αnαn−1

.

Then, we have

α −

1

αn+1

=

and so g′(x) < 0 for any x <

1

αn+1 (cid:26) 1

1

αn+1

+

αn−1

αn+1
αn

+ 1(cid:19) − 1(cid:27) ≥ 0,

3(cid:18) αn+1
. Moreover, if αn+1 6= αn we obtain g′(cid:18) 1

αn+1(cid:19) <

In fact, g′′(x) =

0. The second derivative g′′(x) is positive for any x ∈ R.
6αn−1αnαn+1 > 0.

Acknowledgements

This paper was written while the author was a student in a doctor’s course
of Meiji University. I would like to express my deepest gratitude to my advisor
Prof. Kurano who provided helpful comments and suggestions. I would also like to
thank Yuji Kamoi, Akiyoshi Sannai and Kei-ichi Watanabe who gave me invaluable
comments and warm encouragements.

References

[1] I. M. Aberbach and F. Enescu, The structure of F-pure rings, Math. Z. 250 (2005), no. 4,

791–806.

[2] M. Blickle, M. Mustat¸˘a, and K. E. Smith, F-thresholds of hypersurfaces, Trans. Amer.

Math. Soc. 361 (2009), 6549–6565.

[3] M. Blickle, K. Schwede, and K. Tucker, F-signature of pairs: continuity, p-fractals and

minimal log discrepancies, J. London Math. Soc. (2) 87 (2013), 802–818.

[4] D. Eisenbud, Homological algebra on a complete intersection, with an application to group

representations, Trans. Amer. Math. Soc. 260 (1980), no. 1, 35–64.

[5] C. Huneke and G. Leuschke, Two theorems about maximal Cohen-Macaulay modules, Math.

Ann. 324 (2002), no. 2, 391–404.

[6] C. Huneke M. A. McDermott and P. Monsky, Hilbert Kunz functions for normal graded

rings, Math. Res. Letters 11 (2004), 539–546.

[7] K. Kurano, The singular Riemann-Roch theorem and Hilbert-Kunz functions, J. Algebra.

304 (2006), 487–499

[8] P. Monsky, The Hilbert-Kunz function, Math. Ann. 263 (1983), 43–49.
[9] K. Tucker, F-signature exists, Invent. Math. 190 (2012), no. 3, 743–765.
[10] K.-i. Watanabe and K. Yoshida, Hilbert-Kunz multiplicity and an inequality between mul-

tiplicity and colength, J. Algebra. 230 (2000), 295–317.

