Low Complexity Hybrid Precoding and Channel
Estimation Based on Hierarchical Multi-Beam
Search for Millimeter-Wave MIMO Systems

Zhenyu Xiao, Member, IEEE, Pengfei Xia, Senior Member, IEEE and Xiang-Gen Xia, Fellow, IEEE

1

6
1
0
2

 
r
a

M
4

 

 
 
]
T
I
.
s
c
[
 
 

1
v
4
3
6
1
0

.

3
0
6
1
:
v
i
X
r
a

to increase the achievable rate,

Abstract—In millimeter-wave (mmWave) MIMO systems,
while a hybrid digital/analog precoding structure offers the
potential
it also faces the
challenge of the need of a low-complexity design. In speciﬁc,
the hybrid precoding may require matrix operations with a
scale of antenna size, which is generally large in mmWave
communication. Moreover, the channel estimation is also rather
time consuming due to the large number of antennas at both
Tx/Rx sides. In this paper, a low-complexity hybrid precoding
and channel estimation approach is proposed. In the channel
estimation phase, a hierarchical multi-beam search scheme is
proposed to fast acquire NS (the number of streams) multipath
components (MPCs)/clusters with the highest powers. In the
hybrid precoding phase, the analog and digital precodings are
decoupled. The analog precoding is designed to steer along the
NS acquired MPCs/clusters at both Tx/Rx sides, shaping an
equivalent NS ×NS baseband channel, while the digital precoding
performs operations in the baseband with the reduced-scale
channel. Performance evaluations show that, compared with a
state-of-the-art scheme, while achieving a close or even better
performance when the number of radio-frequency (RF) chains or
streams is small, both the computational complexity of the hybrid
precoding and the time complexity of the channel estimation are
greatly reduced.

Index Terms—Hybrid precoding, millimeter-wave, mmWave,

mmWave MIMO, beam search, hierarchical search.

I. INTRODUCTION

M ILLIMETER-WAVE (mmWave) communication is a

promising technology for next-generation wireless
communication owing to its abundant frequency spectrum
resource, which enables a much higher capacity than the
current alternatives. In fact, mmWave communication has
raised increasing attention as an important candidate technol-
ogy in both the next-generation wireless local area network

This work was partially supported by the National Natural Science Founda-
tion of China (NSFC) under grant Nos. 61571025, 61201189, 91338106, and
61231013, the Fundamental Research Funds for the Central Universities under
grant Nos. YWF-14-DZXY-007, WF-14-DZXY-020 and YMF-14-DZXY-027,
National Basic Research Program of China under grant No.2011CB707000,
and Foundation for Innovative Research Groups of the National Natural
Science Foundation of China under grant No. 61221061.

Z. Xiao is with the School of Electronic and Information Engineering, Bei-
jing Key Laboratory for Network-based Cooperative Air Trafﬁc Management,
and Beijing Laboratory for General Aviation Technology, Beihang University,
Beijing 100191, P.R. China.

P. Xia is with the School of Electronics and Information Engineering, Tongji

University, Shanghai, P.R. China.

X.-G. Xia is with the Department of Electrical and Computer Engineering,

University of Delaware, Newark, DE 19716, USA.

(WLAN) [1]–[5] and mobile cellular communication [6]–
[12]. In general, mmWave communication faces the problem
of high propagation loss due to the high carrier frequency.
Thus, mmWave devices usually need large antenna arrays to
compensate for the propagation loss. Fortunately, thanks to
the short wavelength of the mmWave frequency, large antenna
arrays are possible to be packed into small form factors.

Despite the possibility of using large arrays, the high power
consumption of mixed signal components, as well as radio-
frequency (RF) chains, makes it impractical, if not impossible,
to realize a full-blown digital baseband beamforming as used
in the conventional multiple-input multiple-output (MIMO)
systems. In such a case, analog beamforming is considered
for mmWave communication, where all the antennas share
a single RF chain and generally have constant-amplitude
(CA) constraint on their weights [13], [14]. As entry-wise
estimation of channel status information (CSI) is time costly
due to large arrays and subspace observations of the channel
[15], the training approach is generally adopted, including the
power iteration method by exploiting the directional feature of
mmWave channel [16], and the switching beamforming which
probes on a pre-deﬁned codebook and ﬁnds the best codeword
within the codebook [13], [14]. For switching beamforming,
multiple-stage hierarchical search algorithms were proposed
to reduce the number of measurements [3], [13]–[15], [17].
These schemes ﬁrst probe with low-resolution codewords, i.e.
codewords with larger beam widths, and then probe with
high-resolution codewords, i.e. codewords with thinner beam
widths. Although these analog beamforming schemes reduce
search complexity, they generally share the disadvantage of
steering towards only one communication beam, i.e., these
schemes are not capable of achieving multiplexing gain in
addition to array gain.

In order to achieve multiplexing gain, a hybrid analog/digital
precoding structure was then proposed1 [7]–[12], where a
small number of RF chains are tied to a large antenna array.
This structure enables parallel transmission, and thus provides
the potential to approach the capacity bound that can be
achieved via digital precoding. However, the large antenna
size challenges the need of a low-complexity design of the
hybrid precoding and channel estimation. In particular, the
hybrid precoding may require matrix operations with a scale
of antenna size, which is generally large in mmWave commu-

1Beamforming in the case of multi-stream transmission is called precoding

Corresponding Author: Dr. Z. Xiao with Email: xiaozy@buaa.edu.cn.

here.

nication. Moreover, the channel estimation is also rather time
consuming due to the large number of antennas at both Tx/Rx
sides.

In [18], an overall approach was proposed for hybrid
precoding and channel estimation in mmWave MIMO systems.
In the channel estimation phase, a hierarchical codebook was
designed by exploiting the hybrid structure, which is different
from the former ones with only analog combining [13], [14].
Based on the codebook, a hierarchical multi-beam search
method was proposed to acquire Ld (Ld is no less than the
number of streams NS and is generally equal to NS) multipath
components (MPCs)/clusters with the highest powers. With
these MPCs, the channel matrix was reconstructed. In the
precoding phase [18], [19], the optimal precoding matrix is
ﬁrst obtained based on the estimated channel without consid-
ering the CA constraint, and then analog and digital precoding
matrices are determined by minimizing the Frobenius distance
between the product of the analog and digital precoding
matrices and the unconstraint optimal one. By exploiting the
sparse feature on the angle domain, the optimization problem
is modeled to be a sparse reconstruction problem, and is solved
by the orthogonal matching pursuit (OMP) approach.

Although this overall approach [18] is theoretically feasible,
it may not achieve a promising performance when the number
of RF chains or streams is small. Moreover, it has high
computational complexity in the hybrid precoding and high
time complexity in the channel estimation2. The performance
of achievable rate can be degraded by the codebook design in
[18], which depends on both the number of RF chains and Ld.
In fact, only when both of them are large enough, good wide-
beam codewords can be shaped; otherwise there may be deep
sinks within the coverage of a beam, which will result in high-
rate miss detection of MPCs, and in turn poor achievable rate.
Regarding the computational and time complexities, for the
hybrid precoding, the singular value decomposition (SVD) and
matrix multiplication of size the same as the antenna number
are required, which may challenge its practical implementa-
tion, while for the channel estimation, the required number of
time slots (or measurements) is proportional to L3
dM 2, which
is basically too high for a practical mmWave system, where
M is the hierarchical factor deﬁned in Section IV.

In this paper, we propose a low-complexity overall hybrid
precoding and channel estimation approach. The differences
between this approach and the one proposed in [18] are:

• In the channel estimation phase, we propose a new
hierarchical multi-beam search scheme, which uses a pre-
designed analog hierarchical codebook, rather than the
hybrid hierarchical codebook designed in [18]. The pre-
designed analog hierarchical codebook is robust to the
number of RF chains and NS, which guarantees a ro-
bust performance. Moreover, the proposed search scheme
exploits the particular channel structure in mmWave
communication and the hierarchical feature of the pre-
designed codebook, which greatly reduces the required
time slots.

2

• In the hybrid precoding phase, the analog and digital
precodings are decoupled. The analog precoding is de-
signed to steer along the NS acquired MPCs/clusters
at both Tx/Rx sides, shaping an equivalent NS × NS
baseband channel, while the digital precoding operates
on the NS× NS equivalent channel, which greatly lowers
the operation size of the matrices.
Performance evaluations show that, compared with the ap-
proach proposed in [18],
the newly proposed approach
achieves a close performance to the alternative, or even a
better one when the number of RF chains or streams is small.
Moreover, the computational complexity of the hybrid pre-
coding and the time complexity of the channel estimation are
greatly reduced. Speciﬁcally, antenna-size matrix operations
are reduced to stream-size matrix operations for the hybrid
precoding, while L3
dM 2-proportional time slots are reduced
to NSM -proportional time slots for the channel estimation.

The rest of this paper is organized as follows. In Section II,
we introduce the system and channel models, and formulate
the problem. In Sections III, we propose the hierarchical multi-
beam search method for channel estimation. In Section IV, we
present the hybrid precoding operation. In Section V, we show
the performance evaluations. Lastly, we conclude the paper in
Section VI.

Notation: a, a, A, and A denote a scalar variable, a vector,
a matrix, and a set, respectively. (·)∗, (·)T and (·)H denote
transpose and conjugate transpose, respectively.
conjugate,
In addition, [x1, x2, ..., xM ] denotes a row vector with its
elements being xi. Some other operations used in this paper
are deﬁned as follows.

E{·}
|x|
kxk
kxk0
kXkF
[X]i,j
[X]:,i:j

Expectation operation.
Absolute value of scalar variable x.
2-norm of vector x.
0-norm of vector x.
Frobenius norm of X.
The ith-row and jth-column element of X.
The ith to jth columns of X.

II. SYSTEM AND CHANNEL MODELS

A. System Model

Without loss of generality, we consider a downlink point-
to-point multiple-stream transmission in this paper, while the
signal model and the proposed scheme are also applicable for
an uplink transmission. An mmWave MIMO system with a
hybrid digital/analog precoding structure is shown in Fig. 1,
where relevant parameters are listed below.

NS

Data streams transmitted from the base station (BS)
to a mobile station (MS).
The number of RF chains at the BS.
The number of antennas at the BS.

NR
NA
MR The number of RF chains at the MS.
MA The number of antennas at the MS.

2The time complexity of channel estimation refers to the time slots spent

in the channel estimation.

Basically, we have NR ≤ NA and MR ≤ MA, but in practical
mmWave MIMO systems, NR and MR are far less than NA

F
B

F
R

W
R

RF 
Chain

N

S

Streams

Digital 
Precoding

.
.
.

RF 
Chain

N

R

RF Chains

.
.
.

.
.
.

H

.
.
.

.
.
.

Splitters

N

A
Antennas

M

A

Antennas

.
.
.

.
.
.

3

N

S

Streams

Digital 
Combinin

g

W
B

RF 
Chain

.
.
.

RF 
Chain

M

R

Analog Precoding

Base Station (BS)

Analog Combining

RF Chains

Mobile Station (MS)

Fig. 1.

Illustration of the mmWave MIMO system with a hybrid analog/digital precoding and combing structure.

and MA, respectively. Moreover, it is noted that the supported
number of data streams, i.e., NS, is constrained by the number
of RF chains, which means NS ≤ min{NR, MR}.
The BS performs digital precoding in the baseband and
analog precoding in RF, respectively, while the MS performs
analog combining in RF and digital combining in the base-
band, respectively. Let sNS×1 denote the transmitted signal
vector with normalized power, i.e., E(ssH) = INS, where I
is an identity matrix. Considering a narrow-band block-fading
propagation channel as in [18], [19], the received signal vector
at the MS writes

y = √P WH

BWH

(1)

RHFRFBs + WH

BWH

Rn,

where P is the transmission power per stream, FB and FR
are the NR × NS digital and NA × NR analog precoding
the BS, respectively, WB and WR are the
matrices at
MR × NS digital and MA × MR analog precoding matrices
at the MS, respectively, n is a standard white Gaussian noise
vector, i.e., E(nnH) = INS. In addition, we have the entry-
wise CA constraint for the RF precoding matrix FR and
the RF combining matrix WR, respectively. In addition, we
have power normalization for the precoding at the BS, i.e.,
||FRFB||2

F = NS.

B. Channel Model

Since mmWave channels are expected to have limited scat-
tering [?], [11], [18], [20]–[22], MPCs are mainly generated
by reﬂection. Different MPCs have different physical transmit
steering angles and receive steering angles,
i.e., physical
angles of departure (AoDs) and angles of arrival (AoAs).
Consequently, mmWave channels are relevant to the geometry
of antenna arrays. While the algorithms and results developed
in this paper can be applied to arbitrary antenna arrays, we
adopt uniform linear arrays (ULAs) with a half-wavelength
antenna space in this paper. Consequently, the channel can be

expressed as [15], [18], [19], [22]–[24]

H = pNAMA

L

Xℓ=1

λℓg(MA, Ωℓ)g(NA, ψℓ)H,

(2)

where λℓ is the complex coefﬁcient of the ℓth path, L is the
number of MPCs and L ≥ NS, g(·) is the steering vector
function, Ωℓ and ψℓ are cos AoD and AoA of the ℓth path,
respectively. Let θℓ and ϕℓ denote the physical AoD and AoA
of the ℓth path, respectively; then we have Ωℓ = cos(θℓ) and
ψℓ = cos(ϕℓ). Therefore, Ωℓ and ψℓ are within the range
[−1, 1]. For convenience, in the rest of this paper, Ωℓ and
ψℓ are called AoAs and AoDs, respectively, as we design the
hybrid precoding and multi-beam search schemes in the cosine
angle domain. Similar to [18], [22], λℓ can be modeled to be
complex Gaussian distributed3, i.e., λℓ ∼ CN (0, 1/L), while
θℓ and ϕℓ are modeled to be uniformly distributed within
[0, 2π). g(·) is a function of the number of antennas and
AoD/AoA, and can be expressed as

g(N, Ω) =

1
√N

[ejπ0Ω, ejπ1Ω, ..., ejπ(N −1)Ω]T,

(3)

where N is the number of antennas (N is NA at the BS and
MA at the MS), Ω is AoD or AoA. It is easy to ﬁnd that
g(N, Ω) is a periodical function which satisﬁes g(N, Ω) =
g(N, Ω + 2).
Remark 1. Evenly sampling the cosine angle space [−1, 1]
with an interval length 2/N from −1+1/N leads to N steering
vectors g(N,−1 + (2k − 1)/N ), k = 1, 2, ..., N . We say each
vector of them represents a basis beam with a width 2/N .

3Here the non-line-of-sight (NLOS) model is adopted for multi-stream
transmission. For the LOS channel model in mmWave communications, the
energy of the NLOS components is basically much lower than that of the
LOS component [?], [18], [20]–[22]; thus, one-stream transmission may be
more preferable. However, we need to note that the proposed approach is also
feasible in the LOS channel.

C. Problem Formulation

Our target is to maximize the total achievable rate for the
downlink point-to-point transmission. Thus, the problem can
be formulated as [25, Chapters 7 and 8], [26]

R = log2 det(cid:16)I + K−1/2
||FRFB||2
Tr(Q) = P,

F = NS,

W HEQHH

W (cid:17)
E K−H/2

max

FB,FR,WB,WR,Q
subject to

(4)
RWRWB,
where HE = WH
and Q is the power allocation matrix. To solve this problem,
we must solve the following two subproblems.

RHFRFB, KW = WH

BWH

BWH

Subproblem 1: Multi-Beam Search. As we do not know
the channel matrix, we need to estimate it ﬁrst, which is
the ﬁrst subproblem. Apparently it would be rather time
consuming to estimate H entry-wisely, as the antenna size
is large. Fortunately, according to the structure of mmWave
channel in (2), we only need to search the AoDs and AoAs of
several most signiﬁcant MPCs to capture the majority of the
channel energy. The search efﬁciency depends on the design
of the hierarchical codebook and the search scheme. Different
from [18], we are going to propose an improved hierarchical
multi-beam search scheme based on a pre-designed analog
combining codebook.

Precoding. Assuming

Subproblem 2: Hybrid
the most

the
signiﬁcant MPCs have been
AoAs/AoDs of
estimated, the remaining subproblem is the hybrid precoding,
i.e., to obtain FB, FR, WB, WR and Q to maximize R
under the CA constraint. Note that due to the CA constraint, it
is hard to ﬁnd a globally optimal solution to this subproblem.
On the other hand, it may be not worthy at all to ﬁnd the
globally optimal solution at a cost of high computational
complexity, since the channel estimation is already rather
approximate. Hence, we focus on designing a low-complexity
hybrid precoding.

III. HIERARCHICAL MULTI-BEAM SEARCH

In mmWave communication, channel estimation is generally
realized by estimating the coefﬁcients, AoDs and AoAs of
several (NS in the context of this paper) most signiﬁcant
MPCs, as the conventional entry-wise estimation is time
consuming due to the large antenna size. Before we introduce
the proposed hierarchical multi-beam search method, let us
start from the introduction of the bruteforce sequential search
scheme for better understanding.

A. The Sequential Search Scheme

The sequential search scheme is straightforward, i.e., se-
quentially searching the whole Tx/Rx angle plane and ﬁnding
the NS (AoD AoA) pairs with the highest strengths. Therefore,
the codebook for the sequential search consists of steering
vectors with evenly sampled angles in the range of [−1, 1],
i.e., g(N,−1 + 2i−1
KN ), i = 1, 2, ..., KN, where the sampling
interval is
KN , and K is the over-sampling factor. The larger
K is, the smaller the estimation errors of AoDs and AoAs are.

2

(cid:1)ŶŐůĞ(cid:6)(cid:7)ŽŵĂŝŶ

Ͳϭ

dŚĞ(cid:6)ϬͲƚŚ(cid:6)>ĂǇĞƌ

ܟሺͲǡͳሻ

4

нϭ

dŚĞ(cid:6)ϭͲƐƚ(cid:6)>ĂǇĞƌ

ܟሺͳǡͳሻ

ǥ

ܟሺͳǡ ܯሻ

dŚĞ(cid:6)ϮͲŶĚ(cid:6)>ĂǇĞƌ

ܟሺʹǡͳሻ

ǥ ܟሺʹǡ ܯሻ

ǥ

ܟሺʹǡ ܯሺܯ
െ ͳሻ ൅ ͳሻ

ǥ ܟሺʹǡ ܯଶሻ

dŚĞ(cid:6)ܵͲƚŚ >ĂǇĞƌ(cid:6)
;ܵ ൌ ெ ܰͿ
dŚĞ(cid:6)KǀĞƌͲ
^ĂŵƉůŝŶŐ(cid:6)>ĂǇĞƌ

ܟሺܵǡ ͳሻ

܏ଵ̱܏௄

ǥ

ǥ

ܟሺܵǡ ܯௌሻ

܏ ேିଵ ௄ାଵ̱܏ே௄

Fig. 2. Structure of a hierarchical codebook.

Regarding the considered system in Section II, sequen-
tial search is realized by sequentially transmitting training
sequences from the BS with codewords g(NA,−1 + 2j−1
)
and receiving the training sequences at the MS with code-
words g(MA,−1 + 2i−1
) for i = 1, 2, ..., KMA and j =
1, 2, ..., KNA. Consequently, we can obtain the angle-domain
matrix G:

KMA

KNA

[G]i,j = g(MA,−1 +

2i − 1
KMA

)HHg(NA,−1 +

2j − 1
KNA

),

i = 1, 2, ..., KMA, j = 1, 2, ..., KNA.

(5)
Afterwards, it is straightforward to ﬁnd the NS most signiﬁcant
peaks with G on the Tx/Rx angle plane. If we denote the
time period of a training sequence as a time slot (i.e., a
measurement), we need K 2MANA time slots to estimate G
with the sequential search approach. Considering that we have
NR and MR RF chains at the BS and MS, respectively, in each
time slot we can estimate NRMR elements of G, by sending
different orthogonal training sequences on the NR RF chains
with different steering vectors at the BS, and receiving also
with different steering vectors on the MR chains at the MS
(similar to (17) and (18)). Thus, the total time cost to estimate
G is

TSS =

K 2MANA

NRMR

,

(6)

which is proportional to MANA. While this method is feasible,
the time cost would be signiﬁcantly high for large-array
devices.

B. The Hierarchical Multi-beam Search Scheme

To reduce the time cost for channel estimation, we pro-
pose the hierarchical multi-beam search scheme, where a
corresponding hierarchical codebook needs to be designed in
advance.

1) Hierarchial Codebook Design: A typical hierarchial
codebook F is shown in Fig. 2, where F has S + 1 layers
(not including the over-sampling layer). In the kth layer, there
are M k codewords with the same beam width but different
steering angles, k = 0, 1, ..., S, where M is the hierarchical
factor. The union of beam coverage of all the codewords in
each layer equals [−1, 1]. The number of antennas is assumed
to satisfy N = M S, where S is an integer. Let w(k, n) denote
the nth codeword in the kth layer, n = 0, 1, ..., M k. Then the

beam coverage in the angle domain of w(k, n) is the union
of those of {w(k + 1, (n − 1)M + m)}m=1,2,...,M, which
is the critical feature why the codebook is hierarchical. For
convenience we say w(k, n) is a parent codeword of its M
child codewords w(k + 1, (n − 1)M + m), m = 1, 2, ..., M .
There are N codewords in the Sth layer of the codebook,
and they are just the evenly sampled N basis beams mentioned
in Remark 1. The angle resolution is 2/N in this layer. If a
more accurate estimation of AoDs and AoAs is required, we
need the over-sampling layer as shown in Fig. 2, where gi =
g(N,−1 + 2i−1
KN ), i = 1, 2, ..., KN . All these KN codewords
within this layer are the steering vectors to sample the angle
domain with an interval of 2/(KN ). Whether or not this over-
sampling layer is needed depends on practical requirements.
The design of this hierarchical codebook is challenging
due to the CA constraint. In our previous work [23], analog
beamforming was studied, and codewords with wide beams
are designed by turning off part of the antenna elements. In
[18], hybrid analog/digital beamforming was studied, and the
codebook design is formulated as a sparse problem based on
the hybrid structure, and solved by the OMP algorithm. Note
that in [23] only analog combining was used for the codebook
design, rather than the hybrid combining in [18].

However, these two codebooks has separate drawbacks. For
[23], the number of active antennas is usually small when
wide-beam codewords are conﬁgured. Because the transmit
power per antenna is usually limited in mmWave communica-
tions, this would in turn limit the total transmit power in the
beam search, and is undesired in general. For [18], although
multiple RF chains provides additional degrees of freedom,
only when the number of RF chains is large enough, good
wide-beam codewords can be generated; otherwise there will
be deep sinks [18, Fig. 5] within the beam coverage, which
degrades the beam search and the achievable-rate performance.
In this paper, we choose to use the joint sub-array and deac-
tivation (JOINT) codebook design [?] for hybrid beamforming.
Note that in [?] we only proposed the codebook design, while
in this paper we further consider to use it in hierarchical multi-
beam search. Since the codebook with M = 2 is widely used,
we introduce the method to generate the codewords with the
JOINT approach here for the case of M = 2. However, we
must note that the approach can also be used for other cases
where M has other values.

2n−1

Codeword Generation with JOINT:
When k = S = log2(N ), we have w(S, n) = g(N,−1 +
N ), n = 1, 2, ..., N .
When k = S − ℓ, where ℓ = 1, 2, ..., S, we obey the

following procedures to compute w(k, n):

• Separate w(k, 1) into mS = 2⌊(ℓ+1)/2⌋ sub-arrays with
fm = [w(k, 1)](m−1)nS+1:mnS, where ⌊·⌋ is the ﬂooring
integer operation, nS = N/mS, m = 1, 2, ..., mS;
• Set fm as (7), where NA = mS/2 if ℓ is odd, and nA =

M if ℓ is even;

• We have w(k, n) = w(k, 1) ◦ √N g(N, 2(n−1)
n = 2, 3, ..., 2k, and ◦ is the entry-wise product;

• Normalize w(k, n).

N ), where

5

120

60

90

  5

  4

  3

  2

  1

 

30

0

330

240

270

Sparse, 2 RF Chains
Sparse, 4 RF Chains
JOINT

300

150

180

210

 

Fig. 3.
Comparison of beam patterns between JOINT and the approach
in [18] (termed as Sparse). N = 32, and the codewords are in the second
(k = 2) layer. Ld = 1 for the Sparse approach.

fm = 


2m − 1

ejmπg(nS,−1 +
0nS×1, m = nA + 1, nA + 2, ..., M,

nS

), m = 1, 2, ..., nA,

(7)

where nA is the number of active sub-arrays. See [?] for more
details in the codebook design.

Fig. 3 shows the comparison of the beam patterns between
JOINT and the approach in [18], where we can ﬁnd that when
the number of RF chains is small, there are deep sinks within
the beam coverage of the wide-beam codewords, and the sink
is more severe when the number of RF chains is smaller, which
are in accordance with the results in [18] (Fig. 5 therein).
Clearly, if the AoD or AoA of an MPC is along the sink
angle, it cannot be detected with the codeword, which results
in miss detection and in turn degradation of the achievable-rate
performance. Besides, the beam coverage of the codewords in
[18] are sensitive to both Ld and the number of RF chains,
i.e., different system settings need different codebooks. In
contrast, there is no deep sinks within the beam coverage of the
codewords in the JOINT codebook, and the JOINT approach
is robust against the numbers of RF chains and data streams,
because it uses analog combing.

2) Hierarchical Multi-Beam Search: Based on the pre-
designed hierarchical codebook, we next introduce the pro-
posed beam search algorithm to ﬁnd the NS most signiﬁcant
beams on the Tx/Rx angle plane. While it is natural to search
the multi-beams one by one, there are two critical issues to
consider when extending a one-beam search scheme to a multi-
beam search scheme.

The ﬁrst issue is how to cancel the effect of the already
found beams in the on-going beam search. Here we propose to
exploit the particular structure of the mmWave communication
channel shown in (2), where each MPC/cluster has an AoD,
AoA and path coefﬁcient. Let

√P H = pP NAMA

L

Xℓ=1

λℓg(MA, Ωℓ)g(NA, ψℓ)H

,

L

Xℓ=1

βℓg(MA, Ωℓ)g(NA, ψℓ)H.

(8)

Consequently, during the search process we can write H as

√P H = Xℓ∈Ifd
Xn /∈Ifd

βℓg(MA, Ωℓ)g(NA, ψℓ)H+

βng(MA, Ωn)g(NA, ψn)H

(9)

, Hfd + Hnfd,

where Ifd represents the indices of the already found MPCs,
while Hfd and Hnfd represent the already found channel
response and the not yet found channel response, respectively.
During the multi-beam search, we need to perform beamform-
ing measurements over Hnfd, which can be obtained as

MSHfdwBS

,

(10)

computed

{z

}

y = wH

= wH

MS (HnfdwBS + n)

MS(cid:16)√P HwBS + n(cid:17)
}

{z

measured

|

− wH
|

where the second component is just the contribution of the
already found MPCs.

The second issue is how to perform layered search. Accord-
ing to the designed hierarchical codebook. In each layer there
are M candidate child codewords at both the BS and MS.
A straightforward method is to exhaustively measure all the
possible codeword pairs and ﬁnd the best codeword pair [18],
and requires M 2 measurements. In the case of multi-beam
search, the number of measurements becomes M 2L2
d, since
the number of candidate child codewords becomes M Ld in
each layer at both sides [18]. In our scheme we adopt a more
efﬁcient scheme, i.e., BS uses the parent codeword found in
the last-layer search, while MS sequentially measures its M
child codewords and ﬁnds the best one; then, MS uses the
found best codeword, BS sequentially measures its M child
codewords and ﬁnds the best one. Thus, we only need 2M
measurements for the search in each layer.

The proposed hierarchical multi-beam search scheme is
shown in Algorithm 1. There are NS iterations in the search
process, and a single MPC will be searched in each of them.
There are three phases to search a single MPC:

• Search for the initial Tx/Rx codewords. As in mmWave
communication the transmission power is generally lim-
ited, the beamforming gain cannot be too small. Thus,
the beamforming training may not start from the 0th
layer, where the codeword is omni-directional and the
gain is the lowest. Instead, the beamforming training may
need to start from some layer, e.g., the iLYth layer in
Algorithm 1, to provide sufﬁcient start-up beamforming
gain. In this process, there are M iLY candidate codewords
at both BS and MS. Thus, an exhaustive search over all
the BS/MS codeword pairs is adopted to search the best

6

Algorithm 1: Hierarchical Multi-Beam Search Algorithm.
1) Initialization:
S = max{logM NA, logM MA}.
iLY = 2. /∗The initial layer index. It can be other values
depending on practical requirements.∗/
Hfd = 0, /∗The already found channel.∗/
2) Iteration:
for ℓ = 1 : NS do

/∗Search for the initial Tx/Rx codewords in the
iLYth layer.∗/
for m = 1 : M iLY do

for n = 1 : M iLY do

y(m, n) =

wBS(iLY, n)H[√P HwMS(iLY, m) + n] −

wBS(iLY, n)HHfdwMS(iLY, m)

(mMS mBS) = arg max

|y(m, n)|

(m,n)

MS feeds back BS mBS.
/∗Hierarchical reﬁnement.∗/
for s = iLY + 1 : S do
for n = 1 : M do

yMS(n) =

wBS(s − 1, mBS)H[√P HwMS(s, (mMS −
1)M + n) + n] − wBS(s −
1, mBS)HHfdwMS(s, (mMS − 1)M + n)

n

|yMS(n)|

nMS = arg max
mMS = (mMS − 1)M + nMS
for n = 1 : M do

yBS(n) = wBS(s, (mBS − 1)M +
n)H[√P HwMS(s, mMS) + n] −
wBS(s, (mBS − 1)M + n)HHfdwMS(s, mMS)

|yBS(n)|

nBS = arg max
mBS = (mBS − 1)M + nBS
MS feeds back BS mBS.

n

/∗High-resolution reﬁnement.∗/
for m = (mMS − 1)K + 1 : mMSK do
for n = (mBS − 1)K + 1 : mBSK do

y(m, n) =

wBS(iLY, n)H[√P HwMS(iLY, m) + n] −

wBS(iLY, n)HHfdwMS(iLY, m)

(Iℓ, Jℓ) = arg max

(m,n)

|y(m, n)|

βℓ = y(Iℓ, Jℓ)
MS feeds back BS Jℓ.
/∗Updating the already found channel response.∗/
Hfd = Hfd + βℓ(gMS

Iℓ )(gBS

Jℓ )H

3) Result:
The ℓth (ℓ = 1, 2, ..., NS) index pair is (Iℓ, Jℓ) within the
over-sampling layer.

Tx/Rx codeword pair, which are treated as the parent
codewords for the following search.

• Hierarchical reﬁnement. In this process, a staged search
is performed to reﬁne the beam angle step by step. The
search process has (S − iLY) stages, and begins from the
(iLY + 1)th layer. In each stage, there are M candidate
codewords at the BS and MS, which are the M child
codewords of the found parent codeword in the last stage.
At ﬁrst, the BS uses the parent codeword, while the MS
sequentially tests all the M child codewords and ﬁnd the
best one. Then the MS uses the best child codeword just
found, while the BS sequentially tests all the M child
codewords and ﬁnd the best one. The found best child
codewords at the BS and MS are treated as the parent
codewords in the next-stage search.

• High-resolution reﬁnement. After the hierarchical reﬁne-
ment, the AoD and AoA of an MPC have been found
with a resolution of 2/NA and 2/MA. In practice K is
generally small, because a promising performance can be
achieved when K = 2, and further increasing K does not
signiﬁcantly improve the performance, as will be shown
in Section V. Hence, for each index pair (mMS, mBS) of
the codewords found in the hierarchical reﬁnement, we
just need to test all the index pairs within [(mMS−1)K +
1, mMSK] at the MS and [(mBS − 1)K + 1, mBSK] at
the BS, and select the one with the greatest strength as
(Iℓ, Jℓ). The number of required measurements is K 2.

C. Time Complexity Comparison

Since there are multiple RF chains at the BS and MS, each
time slot we can make multiple measurements by sending
different orthogonal training sequences on different RF chains
with different codewords at the BS, and receiving with differ-
ent codewords at the MS. Thus, the total number of time slots
for the hierarchical search method using Algorithm 1 can be
roughly computed as

THS = NS(cid:18)(cid:16) logM (NA) + logM (MA) − 2iLY(cid:17)(cid:24) M

NRMR(cid:25) +

(cid:24) M 2iLY
NRMR(cid:25) +(cid:24) K 2

NRMR(cid:25)(cid:19) ,

(11)
where ⌈·⌉ is the ceiling integer operation, (logM (NA) +
logM (MA) − 2iLY) and ⌈ M
NRMR ⌉ are the total number of
stages and the number of measurements in each stage at
the BS and MS in the hierarchical reﬁnement, respectively,
⌈ M 2iLY
NRMR ⌉ and ⌈ K 2
NRMR⌉ are the numbers of measurements in
the initial codeword search and the high-resolution reﬁnement,
respectively. Since ⌈ M 2iLY
NRMR ⌉ are irrelevant to the
number of antennas, THS is roughly proportional to NSM .
For a fair comparison, we assume the required number
of MPCs Ld is equal to NS. Then the required number of
measurements of the scheme in [18] is4

NRMR⌉ and ⌈ K 2

TSP = M N 2

S (cid:24) M NS

NR (cid:25) logM (cid:18) KNA
NS (cid:19) ,

(12)

4In this formula it was assumed that NA ≥ MA.

7

 

TSS, The Sequential Search
THS, The Proposed Hierarchical Search
TSP, The Scheme in [18]

1200

1000

800

600

400

200

)
s
t

n
e
m
e
r
u
s
a
e
m

(
 
s
t

l

o
s
 

e
m

i
t
 
f

o

 
r
e
b
m
u
N

0

 
0

10

20

30

40

50

60

70

NA

Fig. 4.
Comparison of time complexity between the sequential search,
the proposed hierarchical multi-beam search and the scheme in [18], where
MA = NA, M = 2, K = 2, MR = NR = 4, NS = 3, and iLY = 2.

which is roughly proportional to N 3

S M 2.

Fig. 4 shows the comparison of time complexity,

i.e.,
required time slots for beamforming training, between the
sequential search, the proposed hierarchical multi-beam search
and the scheme in [18], with the parameters listed in the cap-
tion. It can be observed that the proposed hierarchical search
scheme has the lowest
time complexity among the three.
Compared with the scheme in [18], the proposed hierarchical
search scheme achieves a further signiﬁcant reduction on the
required time slots.

IV. LOW-COMPLEXITY HYBRID PRECODING

With the proposed hierarchial multi-beam search approach,
we can obtain the index pairs of the NS strongest MPCs, i.e.,
(I1, J1), (I2, J2), ..., (INS , JNS). In this section, we perform
low-complexity hybrid precoding based on the estimated chan-
nel information. In speciﬁc, we ﬁrst perform analog precoding
without considering the digital precoding, and then compute
the digital precoding matrices in the baseband.

A. Analog Precoding

The target of analog precoding is to steer at the NS most
signiﬁcant MPCs/clusters in the angle domain. Hence, the
analog precoding and combining matrices are

FR = (cid:20)g(NA,−1 +

2J1 − 1
KNA

), g(NA,−1 +

g(NA,−1 +

2J2 − 1
KNA
2JNS − 1
KNA

), ...,

)(cid:21) ,

(13)

and

WR = (cid:20)g(MA,−1 +

2I1 − 1
KMA

), g(MA,−1 +

g(MA,−1 +

2I2 − 1
KMA
2INS − 1
KMA

), ...,

)(cid:21) ,

(14)

respectively.

B. Digital Precoding

While the analog precoding is to steer at the NS most
signiﬁcant MPCs/clusters in the angle domain, the digital
precoding is designed to cancel interference between different
streams and perform power allocation at the BS.

Provided that FR and WR has been designed, we get an

equivalent NS × NS baseband channel
RHFR.

HB = WH

(15)

Thus,

[HB]i,j = [WR]:,i
2Ii

=g(MA,−1 +

KMA

HH[FR]:,j
)HHg(NA,−1 +

2Jj
KNA

).

Since we have obtained Iℓ and Jℓ, ℓ = 1, 2, ..., L,
the
estimation of HB can be easily realized within a single time
slot as follows. Note that this can also be done in the phase
of channel estimation after the multi-beam search.

The BS transmits orthogonal training sequences sj from
the jth RF chain with codeword g(NA,−1 + 2Jj −1
), where
j = 1, 2, ..., NS. Then the MS receives with NS RF chains
simultaneously, where g(MA,−1 + 2Ii−1
) is adopted in the
ith RF chain. Thus, at the ith RF chain of the MS, we observe

KMA

KNA

ri = g(MA,−1 +

2Ii − 1
KMA

)HH

NS

Xj=1

g(NA,−1 +

2Jj − 1
KNA

)sj

=

Ns

Xj=1

g(MA,−1 +

2Ii − 1
KMA

H
)

Hg(NA,−1 +

2Jj − 1
KNA

)sj.

(17)
By multiplying with sk at the ith RF chain of the MS, where

i = 1, 2, ..., NS and k = 1, 2, ..., NS, we get

sH
k ri

NS

Xj=1

=sH
k

g(MA,−1 +
2Ii − 1
=g(MA,−1 +
KMA
=[G]Ii,Jk = [HB]i,k,

2Ii − 1
KMA

H

)

Hg(NA,−1 +
2Jk − 1
KNA

)

)HHg(NA,−1 +

2Jj − 1
KNA

)sj

(18)

where the noise component is neglected.

After the estimation of HB and the analog precoding, the

received signal at the MS can be rewritten as

y = √P WH

Let Rn = WH
n HB. The received signal is equivalent to

RWR, ˜WH

B R

R−1/2

B HBFBs + WH
B = WH

BWH
Rn.
1/2
n , and ˜HB =

(19)

y = √P ˜WH

˜HBFBs + ˜WH

B n.

(20)

B

(16)

C. Computational Complexity Comparison

8

diagonal in a descending order. Then we can determine the
digital precoding matrices for the MS and BS immediately,
i.e.,

and

WB = R−H/2

n UB,

FB = VB,

(21)

(22)

respectively. Note that WB and FB require to be normalized
according to the power normalization constraint on the pre-
coding and combining matrices.

In addition, the power allocation matrix Q can be generated
by water-ﬁlling the total power P on the NS parallel channels
with coefﬁcients on the diagonal of DB.

The proposed hybrid precoding consists of analog precoding
and digital precoding. The computational complexity of the
analog precoding is low, while the digital precoding requires
NS × NS matrix operations, including matrix multiplication,
SVD, etc. Thus, the proposed hybrid precoding scheme has
an overall computational complexity O(N 3
S ) (It is known that
the computational complexity of general matrix multiplication,
matrix inversion, SVD are on the order of O(M 3), where M
is the matrix size [27]).
In contrast, the hybrid precoding approach proposed in [18]
and [19] also requires matrix operations, including matrix
multiplication, SVD, etc. Since it jointly designs the analog
and digital precodings, the involved matrices are with size
NA × MA. Hence, the hybrid precoding in [18] has an overall
computational complexity O(N 3
the proposed low-complexity hybrid precoding
scheme reduces the computational complexity from O(N 3
A)
to O(N 3

S ), where basically NS ≪ NA.

A) (assuming MA = NA).

In brief,

V. PERFORMANCE EVALUATION

In this section, we evaluate the performance of the proposed
low complexity hybrid precoding (LC-HPC) based on the
hierarchical multi-beam search (HIBS). The channel model
introduced in Section II is adopted, where the physical an-
gles of the MPCs are randomly generated within [0, 2π),
and the average strengths of the MPCs are equal, i.e., an
NLOS channel model is considered (see Footnote 3). Each
performance curve is obtained by averaging 103 instantaneous
performances with randomly realized channel responses. In
all the simulations, we set NA = MA = 32, but we note that
we have also evaluated the performances with other numbers
of antennas, and similar results can be observed. In addition,
the other parameters are all set typical values for mmWave
communication in the simulations, e.g., the numbers of MPCs
and streams (i.e., L and NS) are basically small.

Regarding the digital operations, since there is no CA
constraint on FB and ˜WB, they can be determined by SVD
of ˜HB. Let the SVD of ˜HB be ˜HB = UBDBVH
B, where UB
and VB are left and right unitary matrices of ˜HB, and DB is
a diagonal matrix with the singular values of ˜HB listed on the

A. Hierarchial Multi-Beam Search

First, we demonstrate the performance of the HIBS scheme,
for which the most critical ﬁgure of merit is the success rate to
ﬁnd the index pairs of multiple beams. According to (2), there
are L MPCs with different AoDs and AoAs, and HIBS ﬁnds

NS of them. We sequentially decide whether the found NS
MPCs are among the original L MPCs. The decision method
is that if there is an ℓ, 1 ≤ ℓ ≤ L, satisfying |ψℓ − α| <
1/NA and |ωℓ − β| < 1/MA, where 1/NA and 1/MA are the
permitted AoD and AoA errors, α and β are AoD and AoA of
an estimated MPC, we say this MPC is successfully searched.
Only when all the NS MPCs are successfully searched, the
whole search process succeeds; otherwise it fails.

We note that the search of an arbitrary MPC may fail
because of the noise, the effect of the previously found MPCs,
and the mutual effect of MPCs, i.e., spatial fading caused by
MPCs when measured with wide-beam codewords. In fact, we
have simulated the performance with L = 1 and NS = 1, i.e.,
there is only one MPC. The success rate can achieve 100%
with high SNR. This is because there is no mutual effect of
MPCs when L = 1, and there is no effect of the previously
found MPCs when NS = 1.

Figs. 5 and 6 show the success rates of the proposed
HIBS method with varying K and iLY, respectively, where
the SNR refers to the one after correlation operation on the
training sequence. From these two ﬁgures we can ﬁnd that:
(i) Due to the effect of the previously found MPCs and the
mutual effect of MPCs, the success rate cannot consistently
increase as SNR. (ii) Basically when NS is smaller, the success
rate is higher. This is mainly because the contributions of
the already searched MPCs cannot be completely subtracted
off, and they affect the search of the next MPC. The effect
becomes more signiﬁcant as NS increases. (iii) The success
rate is higher when K is larger. This is because larger K
means more-accurate estimation of the AoDs and AoAs, and
further more-accurate contribution subtraction of the already
searched MPCs. From Fig. 5 we can ﬁnd that when NS = 3,
the improvement of success rate by increasing K is more
signiﬁcant than the cases of NS = 2 and NS = 1. (iv) The
success rate is higher when iLY is bigger. Indeed, to start from
a higher layer not only raises the set-up SNR, but also reduce
the possible mutual effect of MPCs when measured with low-
layer codewords. However, a bigger iLY means a higher time
complexity according to (11).

Fig. 7 depicts the comparison of success rates between the
proposed HIBS scheme and the search scheme in [18] (termed
with “Sparse”). From the comparison, we can ﬁnd that the
Sparse scheme is sensitive to the number of RF chains. Even
with 4 RF chains, its performance of success rate is poorer
than the proposed scheme, which requires only 1 RF chain
for MPC estimation. This performance disadvantage is mainly
due to the hierarchical codebook design in [18], where the
wide-beam codewords may have deep sinks within the beam
coverage when the number of RF chains is not large enough,
which may easily result in miss-detection of MPCs.

Moreover, from these three ﬁgures we can observe that
although the desired number of MPCs is NS, the number of
actual found MPCs with either HIBS or the Sparse scheme
may be less than NS, especially when NS is large. In such a
case, the actual number of streams will be equal to the number
of actual found MPCs, which is less than NS, resulting a degra-
dation of the achievable rate. However, in practical mmWave
communications, the number of independent MPCs/clusters

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e

t

a
R
 
s
s
e
c
c
u
S

9

 

NS=1, k=1
NS=2, k=1
NS=3, k=1
NS=1, k=2
NS=2, k=2
NS=3, k=2

 
0
−10

−5

0

5

SNR (dB)

10

15

20

Fig. 5. Success rate of the proposed hierarchical multi-beam search scheme
with varying K, where M = 2, L = 4, NR = MR = 3, iLY = 2.

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

e
t
a
R
 
s
s
e
c
c
u
S

 

NS=1, iLY=1
NS=2, iLY=1
NS=3, iLY=1
NS=1, iLY=2
NS=2, iLY=2
NS=3, iLY=2

 
0
−10

−5

0

5

SNR (dB)

10

15

20

Fig. 6. Success rate of the proposed hierarchical multi-beam search scheme
with varying iLY, where M = 2, L = 4, NR = MR = 3, K = 2.

is not large [?], [20]. Thus, these two search schemes are
basically suitable.

B. Low-Complexity Hybrid Precoding

Next, we evaluate the performance of achievable rate of the
proposed LC-HPC scheme, and learn the effect of K on the
performance.

Fig. 8 shows the achievable rate of LC-HPC with varying
K, where the HIBS scheme is exploited to estimate MPCs.
The training sequence is assumed long enough to provide
sufﬁciently high SNR for the MPC estimation. From this
ﬁgure we ﬁnd that LC-HPC achieves a promising performance.
Speciﬁcally, compared with the rate bound, which is deﬁned
as the achievable rate without the CA constraint, LC-HPC
has almost no loss of multiplexing gain, i.e., the slopes of
the performance curves of LC-HPC are the same as those
of the rate bounds. Although there is increasing SNR loss

10

 

Sparse, 2 RF Chain, NS=1
Sparse, 2 RF Chain, NS=2
Sparse, 2 RF Chain, NS=3
Sparse, 4 RF Chains, NS=1
Sparse, 4 RF Chains, NS=2
Sparse, 4 RF Chains, NS=3
Proposed HIBS, NS=1
Proposed HIBS, NS=2
Proposed HIBS, NS=3

−5

0

5

10

15

20

25

30

SNR (dB)

e
t
a
R
 
s
s
e
c
c
u
S

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

 
0
−10

Fig. 7. Comparison of success rates between the proposed hierarchical multi-beam search scheme with the search scheme in [18] (termed with “Sparse”),
where M = 2, L = 4, NR = MR = 3, K = 2, iLY = 2. For the Sparse scheme, the required resolution is set as KNA, the same as the proposed scheme.

)
z
H
/
s
/
s
t
i

 

t

b
(
 
e
a
R
e
b
a
v
e
h
c
A

i

l

45

40

35

30

25

20

15

10

5

 
0
−30

LC−HPC, K=1
LC−HPC, K=2
LC−HPC, K=3
Rate Bound

 

NS = 3

NS = 2

NS = 1

LC−HPC,NR=1,NS=1
LC−HPC,NR=2,NS=2
LC−HPC,NR=3,NS=3
SP−HPC,NR=4,NS=1
SP−HPC,NR=4,NS=2
SP−HPC,NR=4,NS=3
SP−HPC,NR=2,NS=2
SP−HPC,NR=2,NS=1

35

30

25

20

15

10

5

 

NS = 3

NS = 2

NS = 1

)
z
H
/
s
/
s
t
i

 

t

b
(
 
e
a
R
e
b
a
v
e
h
c
A

i

l

−20

−10

0

10

20

SNR (dB)

 
0
−40

−30

−20

−10

SNR (dB)

0

10

20

Fig. 8. Achievable rate of LC-HPC with varying K, where the HIBS scheme
is exploited to estimate MPCs. M = 2, L = 4, NR = MR = 3, iLY = 2.

Fig. 9.
Comparison of achievable rates of the proposed low-complexity
hybrid precoding (LC-HPC) approach with the sparse precoding approach in
[18] (termed as “SP-HPC”). M = 2, L = 3, K = 2, iLY = 2. MR = NR
for all the curves.

as NS increases, which results from the CA constraint, it is
basically acceptable in practice where NS is generally small.
Moreover, it is clear that the performance of LC-HPC with
K = 2 is better than that with K = 1, but when K ≥ 2,
further increasing K leads to little performance improvement.
Thus, basically K = 2 is suitable for practical usage.

Fig. 9 shows the comparison of achievable rates of the
proposed LC-HPC approach with the sparse precoding ap-
proach in [18] (termed as “SP-HPC”). The HIBS scheme
is exploited for the estimation of MPCs for LC-HPC, while
the search method proposed in [18] is used for the SP-HPC
approach. That is to say, this ﬁgure shows the performance
comparison of the overall solutions proposed in this paper and
[18]. The training sequence is assumed long enough to provide
sufﬁciently high SNR for the MPC estimations in these two
approaches. From this ﬁgure we ﬁnd that LC-HPC achieves a

close performance to SP-HPC. The performance of SP-HPC
gets improved as NS and the number of RF chains increases,
and is basically better than that of LC-HPC when NR and NS
are not small. That is because SP-HPC selects the steering
vectors directly from the optimization of the achievable rate,
while LC-HPC just selects several estimated signiﬁcant MPCs
as the analog precoding matrix. However, when NS or the
number of RF chains is small, LC-PHC behaves even better.
For instance, when NS = 1, LC-PHC with only 1 RF chain
is even better than SP-HPC with 4 RF chains. This is again
due to the hierarchical codebook design in [18], where the
wide-beam codewords may have deep sinks within the beam
coverage when the numbers of RF chains and NS are not large
enough, which may easily result in miss-detection of MPCs.

11

[13] J. Wang, Z. Lan, C. Pyo, T. Baykas, C. Sum, M. Rahman, J. Gao, R. Fu-
nada, F. Kojima, and H. Harada, “Beam codebook based beamforming
protocol for multi-Gbps millimeter-wave WPAN systems,” IEEE Journal
on Selected Areas in Communications, vol. 27, no. 8, pp. 1390–1399,
Oct. 2009.

[14] J. Wang, Z. Lan, C. Sum, C. Pyo, J. Gao, T. Baykas, A. Rahman,
R. Funada, F. Kojima, and I. Lakkis, “Beamforming codebook design
and performance evaluation for 60GHz wideband WPANs,” in IEEE
Vehicular Technology Conference Fall (VTC 2009-Fall). Anchorage,
AK: IEEE, Sept. 2009, pp. 1–6.

[15] S. Hur, T. Kim, D. J. Love, J. V. Krogmeier, T. A. Thomas, and
A. Ghosh, “Millimeter wave beamforming for wireless backhaul and
access in small cell networks,” IEEE Transactions on Communications,
vol. 61, no. 10, pp. 4391–4403, Oct. 2013.

[16] Z. Xiao, L. Bai, and J. Choi, “Iterative joint beamforming training with
constant-amplitude phased arrays in millimeter-wave communications,”
IEEE Communications Letters, vol. 18, no. 5, pp. 829–832, May 2014.
[17] L. Chen, Y. Yang, X. Chen, and W. Wang, “Multi-stage beamforming
codebook for 60GHz WPAN,” in 2011 6th International ICST Con-
ference on Communications and Networking in China (CHINACOM).
Harbin, China: IEEE, Aug. 2011, pp. 361–365.

[18] A. Alkhateeb, O. El Ayach, G. Leus, and R. Heath, “Channel estimation
and hybrid precoding for millimeter wave cellular systems,” IEEE
Journal of Selected Topics in Signal Processing, vol. 8, no. 5, pp. 831–
846, Oct. 2014.

[19] O. El Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. Heath, “Spatially
sparse precoding in millimeter wave MIMO systems,” IEEE Transac-
tions on Wireless Communications, vol. 13, no. 3, pp. 1499–1513, March
2014.

[20] T. S. Rappaport, Y. Qiao, J. I. Tamir, J. N. Murdock, and E. Ben-
Dor, “Cellular broadband millimeter wave propagation and angle of
arrival for adaptive beam steering systems,” in IEEE Radio and Wireless
Symposium (RWS). Santa Clara, CA: IEEE, Jan. 2012, pp. 151–154.
[21] A. M. Sayeed and V. Raghavan, “Maximizing MIMO capacity in sparse
multipath with reconﬁgurable antenna arrays,” IEEE Journal of Selected
Topics in Signal Processing, vol. 1, no. 1, pp. 156–166, June 2007.

[22] Z. Xiao, X.-G. Xia, D. Jin, and N. Ge, “Iterative eigenvalue decomposi-
tion and multipath-grouping Tx/Rx joint beamformings for millimeter-
wave communications,” IEEE Transactions on Wireless Communica-
tions, vol. 14, no. 3, pp. 1595–1607, March 2015.

[23] T. He and Z. Xiao, “Suboptimal beam search algorithm and codebook
design for millimeter-wave communications,” Mobile Networks and
Applications, vol. 20, no. 1, pp. 86–97, Jan. 2015.

[24] J. Nsenga, W. Van Thillo, F. Horlin, V. Ramon, A. Bourdoux, and
R. Lauwereins, “Joint transmit and receive analog beamforming in 60
GHz MIMO multipath channels,” in IEEE International Conference on
Communications (ICC). Dresden, Germany: IEEE, June 2009, pp. 1–5.
[25] D. Tse and P. Viswanath, Fundamentals of Wireless Communication.

New York, USA: Cambridge University Press, 2005.

[26] A. Goldsmith, S. A. Jafar, N. Jindal, and S. Vishwanath, “Capacity limits
of MIMO channels,” IEEE Journal on Selected Areas in Communica-
tions, vol. 21, no. 5, pp. 684–702, June 2003.

[27] “Computational complexity of mathematical operations,” https://en.wiki-
pedia.org/wiki/Computational complexity of mathematical operations.

VI. CONCLUSIONS

In this paper, a low-complexity overall hybrid precoding
and channel estimation approach has been proposed. In the
channel estimation phase, a new hierarchical multi-beam
search scheme, which uses a pre-designed analog hierarchical
codebook and the particular channel structure in mmWave
communication, was proposed. While in the hybrid precoding
phase, the analog precoding is designed to steer along the
NS acquired MPCs/clusters at both Tx/Rx sides, and the
digital precoding operates on the NS×NS equivalent baseband
channel. Performance evaluations show that, compared with
the approach proposed in [18], the newly proposed approach
achieves a close performance to the alternative, or even a
better one when the number of RF chains or streams is
small. Moreover, the computational complexity of the hybrid
S ), where basically
A) to O(N 3
precoding is reduced from O(N 3
NS ≪ NA, while the required time slots for the multi-
beam search is reduced from N 3
S M 2-proportional to NSM -
proportional.

ACKNOWLEDGMENTS

The authors would like to thank the authors of [18] to share
their source code online, and particularly thank Dr. Ahmed
Alkhateeb for his kind help to explain how to use the source
code.

REFERENCES

[1] R. C. Daniels, J. N. Murdock, T. S. Rappaport, and R. W. Heath,
“60 GHz wireless: up close and personal,” IEEE Microwave Magazine,
vol. 11, no. 7, pp. 44–50, Dec. 2010.

[2] K.-C. Huang and Z. Wang, Millimeter Wave Communication Systems.

Hoboken, New Jersey, USA: Wiley-IEEE Press, 2011.

[3] E. Perahia, C. Cordeiro, M. Park, and L. L. Yang, “IEEE 802.11 ad:
deﬁning the next generation multi-Gbps Wi-Fi,” in IEEE Consumer
Communications and Networking Conference (CCNC). Las Vegas, NV:
IEEE, Jan. 2010, pp. 1–5.

[4] S. K. Yong, P. Xia, and A. Valdes-Garcia, 60GHz Technology for Gbps
WLAN and WPAN: from Theory to Practice. West Sussex, UK: Wiley.
[5] Z. Xiao, “Suboptimal spatial diversity scheme for 60 GHz millimeter-
wave WLAN,” IEEE Communications Letters, vol. 17, no. 9, pp. 1790–
1793, Sept. 2013.

[6] F. Khan and J. Pi, “Millimeter-wave mobile broadband: unleashing 3–
300GHz spectrum,” in IEEE Wireless Commun. Netw. Conf., Cancun,
Mexico, March 2011.

[7] A. Alkhateeb, J. Mo, N. Gonz´alez-Prelcic, and R. Heath, “MIMO
precoding and combining solutions for millimeter-wave systems,” IEEE
Communications Magazine, vol. 52, no. 12, pp. 122–131, Dec. 2014.

[8] J. Choi, “On coding and beamforming for large antenna arrays in mm-
wave systems,” IEEE Wireless Communications Letters, vol. 3, no. 2,
pp. 193–196, April 2014.

[9] S. Han, I. Chih-Lin, Z. Xu, and C. Rowell, “Large-scale antenna systems
with hybrid analog and digital beamforming for millimeter wave 5G,”
IEEE Communications Magazine, vol. 53, no. 1, pp. 186–194, Jan. 2015.
[10] W. Roh, J.-Y. Seol, J. Park, B. Lee, J. Lee, Y. Kim, J. Cho, K. Cheun, and
F. Aryanfar, “Millimeter-wave beamforming as an enabling technology
for 5G cellular communications: theoretical feasibility and prototype
results,” IEEE Communications Magazine, vol. 52, no. 2, pp. 106–113,
Feb. 2014.

[11] S. Sun, T. S. Rappaport, R. Heath, A. Nix, and S. Rangan, “MIMO for
millimeter-wave wireless communications: beamforming, spatial multi-
plexing, or both?” IEEE Communications Magazine, vol. 52, no. 12, pp.
110–121, Dec. 2014.

[12] Y. Niu, Y. Li, D. Jin, L. Su, and A. V. Vasilakos, “A survey of millimeter
wave communications (mmwave) for 5g: opportunities and challenges,”
Wireless Networks, vol. 21, no. 8, pp. 2657–2676, 2015.

