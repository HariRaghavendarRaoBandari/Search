6
1
0
2

 
r
a

 

M
1
2

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
4
4
5
6
0

.

3
0
6
1
:
v
i
X
r
a

Nearest Points on Toric Varieties

Martin Helmer and Bernd Sturmfels

Dedicated to Alicia Dickenstein on the occasion of her 60th birthday

Abstract

We determine the Euclidean distance degree of a projective toric variety. This extends
the formula of Matsui and Takeuchi for the degree of the A-discriminant in terms of
Euler obstructions. Our primary goal is the development of reliable algorithmic tools
for computing the points on a real toric variety that are closest to a given data point.

1

Introduction

We are interested in the best approximation of data points in Rn by a model that is given
by a monomial parametrization. Such a model corresponds to a projective toric variety. Our
result is a formula for the Euclidean distance degree (ED degree [8]) of that variety.

Consider the problem of identifying d unknown real numbers t1, t2, . . . , td by sampling

noisy products of any k of these numbers. The input data consists of (cid:0)d

ui1i2···ik that are supposed to be approximations of ti1ti2 · · · tik for 1 ≤ i1 < i2 < · · · < ik ≤ d.
The least squares paradigm suggests the unconstrained polynomial optimization problem

k(cid:1) measurements

Minimize the function L(t1, . . . , td) = X1≤i1<···<ik≤d(cid:0) ti1ti2 · · · tik − ui1i2···ik(cid:1)2.

The critical points of this problem are solutions of the system of polynomial equations

∂L
∂t1

=

∂L
∂t2

= · · · =

∂L
∂td

= 0.

(1)

(2)

The non-zero complex solutions to (2) come in clusters of k solutions that diﬀer by multi-
plication with a k-th root of unity. The number of such clusters for generic data ui1i2···ik is
the ED degree for (1). For instance, if d = 4, k = 2 then (2) is a system of 4 cubics in 4
unknowns that has 28 pairs of solutions {t, −t}. Thus the ED degree of this problem is 28.
Proposition 4.7 generalizes the number 28 to a combinatorial formula in terms of d and k.
The models in this paper are as follows. We ﬁx an integer d×n-matrix A = (a1, a2, . . . , an)
of rank d such that (1, 1, . . . , 1) lies in the row space of A. Each column vector ai corresponds
d . The aﬃne toric variety ˜XA is the closure in Cn of the
to a monomial tai = ta1i

· · · tadi

1 ta2i

2

1

set {(ta1, . . . , tan) : t ∈ (C∗)d}. This is the aﬃne cone over the projective toric variety
XA ⊂ Pd−1 with the same paramatrization. Note that dim(XA) = d − 1 and dim( ˜XA) = d.
For basics on toric geometry and toric algebra we refer to the books [5, 26].

Fix a vector λ = (λ1, . . . , λn) of positive reals and consider the λ-weighted Euclidean
i )1/2. Given u ∈ Rn, we seek to ﬁnd a real point
v ∈ ˜XA that is closest to u. Thus, our aim is to solve the constrained optimization problem:

norm on Rn, deﬁned by ||x||λ = (Pn

i=1 λix2

Minimize ||u − v||λ subject to v ∈ ˜XA ∩ Rn.

This is equivalent to the unconstrained optimization problem

Minimize

n

Xi=1

λi(ui − tai)2 over all t = (t1, . . . , td) ∈ Rd.

(3)

(4)

The number of complex critical points of (3), for generic u and λ, is denoted EDdegree(XA).
This is the generic ED degree (cf. [8, 21]) of the toric variety XA. It governs the intrinsic
algebraic complexity of ﬁnding and representing the exact solutions to (3) and (4).
In
particular, it is an upper bound for the number of local minima. Note that the number of
complex critical points of (4) is the product EDdegree(XA) · [Zd : ZA]. The lattice index
arises as a factor because it is the degree of the given monomial parametrization of XA.
The following formula, inspired by Aluﬃ [1], will be derived and used in this paper.

Theorem 1.1. The Euclidean distance degree of the projective toric variety XA equals

EDdegree(XA) =

d−1

Xj=0

(−1)d−j−1 · (2j+1 − 1) · Vj,

(5)

where Vj is the sum of the Chern-Mather volumes of all j-dimensional faces of P = conv(A).

The lattice polytope P = conv(A) has dimension d − 1 since rank(A) = d. If the toric
variety XA is smooth then P is simple and Vj is the sum of the normalized lattice volumes
of the j-faces of P . In the smooth case, Theorem 1.1 is precisely the formula given in [8,
Corollary 5.11]. What is new here is the extension to the singular case. Indeed, XA is an
arbitrary singular projective toric variety in Pn−1. In particular, XA is generally not normal.
Theorem 1.1 rests on work by Aluﬃ [1, Proposition 2.9] and Matsui-Takeuchi [19]. The
point here is the Chern-Mather volume (or CM volume for short). We will deﬁne this in
Section 2. A key ingredient is the Euler obstruction [4, Chapter 8] of singular strata on XA.
The result of [19] is a formula for the dimension and degree of the A-discriminant [11], that
is, the variety X ∨
A projectively dual to XA. The following is a variant of [19, Theorem 1.4]:

Theorem 1.2. Using notation as above, the polar degrees of the projective toric variety are

δi(XA) =

d

Xj=i+1

(−1)d−j(cid:18) j

i + 1(cid:19)Vj−1.

(6)

The codimension of the A-discriminant is min{c : δc−1 6= 0}. For that c, degree(X ∨

A) = δc−1.

2

We note that the polar degrees of projective varieties are of independent interest in the
study of algorithms for real algebraic geometry. They govern the complexity of methods for
reliably sampling points in each connected component of a semi-algebraic set (cf. [2, 24]).
Foundational results on polar degrees are found in work of Kleiman [16] and Piene [22, 23].
Our focus in this paper is on tools for concrete computations, starting from an integer ma-
trix A. We implemented the formulas for the polar degrees and the ED degree in Macaulay2
[12]. Given an arbitrary integer matrix A as above, our software computes the quantities in
(5)-(6). The code and accompanying discussion can be found at the supplementary website

https://math.berkeley.edu/~mhelmer/Software/toricED

(7)

For a concrete illustration consider the case d = 2, when XA is a toric curve in Pn−1.
After row operations and column permutations, we may assume that our input has the form

A = (cid:18)α1 α2 α3

1

1

1

· · · αn−1 αn
· · ·

1

1 (cid:19) ,

where 0 ≤ α1 < α2 < α3 < · · · < αn−1 < αn and the diﬀerences αi − αj are relatively prime.
Theorem 1.1 implies that the ED degree of the toric curve XA equals 2αn + αn−1 − α2 − 2α1.
This quantity is the expected number of complex solutions to the polynomial system

1
t

∂L
∂s

=

∂L
∂t

= 0,

where

L(s, t) = λ1(sα1t − u1)2 + λ2(sα2t − u2)2 + · · · + λn(sαnt − un)2.

(8)

(9)

A priori knowledge of the ED degree is useful for optimization because it furnishes an upper
bound on the number of local minima of L. The following numerical example illustrates this.

Example 1.3. Let n = 7 and α = (0, 1, 2, 3, 4, 5, 6), so XA is the rational normal curve
in P6. The ED degree is 16. The weight vector λ = (1, 1, 1, 1, 1, 1, 1) exhibits the generic
behavior, by Corollary 4.3. So, we ﬁx unit weights and use standard Euclidean distance.

Consider the data vector u = (11, 1, 3, 1, 3, 1, 11) in R7. We seek to ﬁnd the real point on
the surface ˜XA ∩ R7 that is located closest to u. Equivalently, if we regard u as a symmetric
tensor of format 2×2×2×2×2×2, as in [8, §8] or [21, §4], then the goal is to ﬁnd the best
rank 1 approximation of the tensor u. We do this by minimizing the squared-distance function

L(s, t) = (t − 11)2 + (st − 1)2 + (s2t − 3)2 + (s3t − 1)2 + (s4t − 3)2 + (s5t − 1)2 + (s6t − 11)2.

As expected, the system (8) has 16 complex solutions. Precisely eight of these 16 are real.
By the Second Derivative Test, four of these eight are found to be local minima. They are

s
1

t

L(s, t)

125.71428571428571428
4.5086875578349189693 0.001289116341967935179 139.66300592712833700
.22179403366779357295
139.66300592712833700
173.71428571428571429

10.829114809514133306
3.5714285714285714283

4.4285714285714285717

−1

The global minimum is attained at (s, t) =(cid:0)1, 31/7(cid:1), with value L(s, t) = 880/7.

3

♦

Section 2 develops the relevant results from algebraic geometry. After deﬁning polar de-
grees, Euler obstructions, and CM volumes, we prove Theorems 1.1 and 1.2. Section 3 starts
by illustrating these results for toric surfaces (d = 3). We then focus on toric hypersurfaces.
These are deﬁned by a single binomial equation in Pn−1, and their conormal varieties are
toric too. We write these in terms of a Cayley polytope, and we express (5)-(6) in terms of
the binomial’s exponents. In Section 4 we derive the discriminants in λ and u whose nonva-
nishing ensures that EDdegree(XA) correctly counts the complex critical points of (3). We
also discuss the tropicalization of the conormal variety of XA, along the lines of [6, 7]. We
end the paper by returning to its beginning: a formula for the ED degree of the hypersimplex
reveals the intrinsic algebraic complexity of learning d numbers from noisy k-fold products.

2 Euler Obstructions and Chern-Mather Volumes

The (generic) ED degree of a projective variety X ⊂ Pn−1 is the sum of the polar degrees of
X. The following formula was derived in [8, Theorem 5.4] and used in [21, Corollary 3.2]:

EDdegree(X) = δ0(X) + δ1(X) + · · · + δn−1(X).

(10)

Many authors, including Fulton [10], Holme [13] and Piene [22], deﬁne δj(X) as the degree of
the j-th polar variety of X with respect to a general linear subspace ℓj = Pj+codim(X) ⊂ Pn−1:

Pj = {x ∈ Xsmooth | dim(TxX ∩ ℓj) ≥ j + 1} ⊂ Pn−1.

Following Kleiman [16], we can also deﬁne δj(X) using the multidegree of the conormal
variety Con(X). This approach is used in [1]. It is explained in [8, §5] after equation (5.3).
In practice, we can use the command multidegree in Macaulay2, as shown in Example 3.3.
If X ⊂ Pn−1 is smooth then its polar degrees can be expressed in terms of the Chern
classes of the tangent bundle. Holme [13, page 150] and Piene [23, Thm. 3] give the formula

δi(X) =

d

Xj=i+1

(−1)d−j ·(cid:18) j

i + 1(cid:19) · deg(cd−j(X)).

(11)

This formula also covers the singular case (as shown by Piene [23]) if we replace the Chern
class with the Chern-Mather class. This is the approach to be pursued in this section. We
shall develop the combinatorial meaning of the formula (11) in the case where XA is an
arbitrary singular projective toric variety. As a consequence, we obtain a practical algorithm
(cf. (7)) for computing the polar degrees and the ED degree of XA. We begin by explaining
the results of Matsui and Takeuchi in [19], and thereafter we derive Theorems 1.1 and 1.2.
As above, A = (a1, a2, . . . , an) is an integer d × n-matrix of rank d with (1, 1, . . . , 1) in
its row space. The columns ai span the semigroup NA and the lattice ZA, both in Zd.
The polytope P = conv(A) has dimension d − 1 and it lives in Rd. Let α be an (s − 1)-
dimensional face of P . Its span Rα is a linear subspace of dimension s in Rd. The intersection
Mα := Rα∩ Zd is a lattice of rank s. The quotient group is also free abelian: Zd/Mα ≃ Zd−s.

4

Let Aα denote the set of all columns ai of A that lie in α. The lattice ZAα spanned by
that set is a subgroup of ﬁnite index in Mα. We also consider the image of the set of columns
of A in Zd/Mα. This is a (d − s)-dimensional vector conﬁguration, to be denoted by A/α.

Deﬁnition 2.1. Fix two faces α, β of P such that β ⊂ α. After a change of coordinates, we
may assume that the origin in Zd is contained in the face β. We write Aα/β for the image of
the ﬁnite set Aα in the free abelian group Mα/Mβ. Its convex hull conv(Aα/β) is a polytope
of dimension r = dim(α) − dim(β) in the real vector space (Mα/Mβ) ⊗Z R = Rα/Rβ ≃ Rr.

We deﬁne the subdiagram volume of β in α to be the positive integer

where Vol is the r-dimensional volume that is normalized with respect to the lattice Mα/Mβ.

µ(α/β) = Vol(cid:0) conv(Aα/β) \ conv((Aα/β)\{0})(cid:1)

(12)

Remark 2.2. To compute the subdiagram volume in (12), we use coordinates on Zd that
are adapted to the inclusions Mβ ⊂ Mα ⊂ Zd. Changing coordinates on Zd corresponds to
integer row operations on A. We shall use the following procedure to carry this out:

• First reorder the columns of A so that those in β come ﬁrst, followed by those in α\β,

and the remaining columns last. In other words, we write A in block form as

• Next compute the Hermite normal form of A. It has the triangular block structure

A = (cid:0)Aβ, Aα\β, AP \α(cid:1).

A′ = 


β α\β P \α
∗
0
0

∗
C
0

∗
∗
∗


.

Note that XA = XA′. The integer matrix C has r rows where r = dim(α) − dim(β).
Restricting to these r rows correspond to the appropriate projection Zn → Zr ≃ Mα/Mβ.
To ﬁnd the subdiagram volume in (12), we may use the normalized r-dimensional volumes of
the polytopes conv(C ∪{0}) and conv(C). These considerations imply the following formula:

µ(α/β) = Vol(conv(C ∪ {0})) − Vol(conv(C)).

(13)

MacPherson [18] introduced Euler obstructions in singularity theory. See the book [4]
for subsequent developments. Ernstr¨om [9] related this to polar degrees and dual varieties.
For the case of toric varieties, Euler obstructions admit a combinatorial description in terms
of subdiagram volumes. This was developed by Matsui and Takeuchi in [19, §4.2]. We next
present their recursive formula. The matrix A and the polytope P = conv(A) are as before.

Deﬁnition 2.3. Let β be a face of P . The Euler obstruction of β is an integer Eu(β) that
depends on the point conﬁguration A. It is deﬁned recursively by the following relations:

5

1. Eu(P ) = 1,

2. Eu(β) = Xα s.t. β is a

proper face of α

(−1)dim(α)−dim(β)−1 · µ(α/β) · Eu(α).

If the face β represents a smooth orbit on XA then Eu(β) = 1. We note that the lattice
indices in [19, Theorem 4.7] are subsumed in Deﬁnition 2.1. See also [20, Corollary 1.11.3].

Using the Euler obstruction, we now deﬁne the Chern-Mather volume (CM volume).

Deﬁnition 2.4. The Chern-Mather volume of a face β of P is an integer that depends on A.
It is the product Vol(β)Eu(β) of the normalized volume and the Euler obstruction of β. As
in Theorem 1.1, we write Vj for the sum of the CM volumes of the j-dimensional faces of P :

Vj = Xβ face of P

dim(β)=j

Vol(β)Eu(β).

(14)

Remark 2.5. The primary aim of Matsui and Takeuchi in [19] was to compute the dimension
and degree of the A-discriminant X ∨
A. These are given by the ﬁrst non-zero polar degree: if
δ0 = · · · = δc−2 = 0 and δc−1 > 0 then codim(X ∨
A) = δc−1. This is essen-
tially the content of [19, Theorem 1.4]. However, it is important to note that the quantities
δ• in [19, (1.6)] are not the polar degrees of XA. Instead, they are the alternating sums

A) = c and degree(X ∨

δ0 , δ1 − 2δ0 , δ2 − 2δ1 + 3δ0 , δ3 − 2δ2 + 3δ1 − 4δ0 , δ4 − 2δ3 + 3δ2 − 4δ1 + 5δ0 , . . . .

Note that the ﬁrst non-zero number in this list also gives the codimension and degree of X ∨
A.
We prefer the direct formulation, just using the polar degrees, given in the second and
third sentence of Theorem 1.2. Formula (6) writes the polar degrees in terms of CM volumes.

Proof of Theorem 1.2. For any subvariety X of Pn−1, the ith polar degree can be expressed
in terms of the Euler obstructions of linear sections of X. Ernstr¨om [9, Theorem 2.2] proves

δi(X) = (−1)dim(X)−i(cid:0)χ(Eu(X (i))) − 2χ(Eu(X (i+1))) + χ(Eu(X (i+2)))(cid:1) ,

where X (j) = X ∩ H1 ∩ · · · ∩ Hj for general hyperplanes Hℓ in Pn−1. In their proof of [19,
Theorem 1.4], Matsui and Takeuchi give an explicit expression for the terms in (15) when
X = XA and dim(X) = d − 1. Speciﬁcally, the equations (3.16) and (3.10) in [19] show that

(15)

χ(Eu(X (0)

A )) = χ(Eu(XA))) = V0

and

(16)

(17)

χ(Eu(X (i)

A )) =

(−1)j−i(cid:18)j − 1

i − 1(cid:19)Vj

for i = 1, . . . , d − 1.

d−1

Xj=i

Substituting (16) and (17) into (15) gives the formula

δ0(XA) = (−1)d−1 V0 − 2

d−1

Xj=1

(−1)j−1Vj +

d−1

(−1)j(j − 1)Vj! .
Xj=2

6

Similarly, for i = 1, . . . , d − 1 we obtain

δi(XA) = (−1)d−1(cid:16)Pd−1

j=i (−1)j(cid:0)j−1

i−1(cid:1)Vj − 2Pd−1

j=i+1(−1)j−1(cid:0)j−1

i (cid:1)Vj +Pd−1

j=i+2(−1)j(cid:0)j−1

i+1(cid:1)Vj(cid:17) .

By reindexing the two summations above, and by collecting terms, we obtain the more
compact expression for the polar degrees given in (6). This completes the proof.

Proof of Theorem 1.1. This follows from Theorem 1.2 using the formula (10).

We next justify why we chose the term “Chern-Mather volume” for the quantities Vj
in Deﬁnition 2.4. The Chern-Mather class is a generalization of the total Chern class (of
the tangent bundle) to singular varieties. See [4, Section 10.6] or [10, Example 4.29] for
the deﬁnition. Piene [23] expressed the Chern-Mather class of a projective variety as an
alternating sum of polar degrees. Her formula leads to the following identiﬁcation of the
Chern-Mather class of a toric variety XA with the Chern-Mather volumes Vj of its matrix
A. We regard the Chern-Mather class of XA as an element in the Chow ring A∗(Pn−1) ∼=
Z[h]/hhni of the ambient projective space Pn−1. Here h denotes the hyperplane class.

Proposition 2.6. The Chern-Mather class of the projective toric variety XA ⊂ Pn−1 equals

cM (XA) =

d−1

Xj=0

Vj · hn−j−1 ∈ A∗(Pn−1) ∼= Z[h]/hhni.

(18)

In particular, the CM volume Vj is the degree of the dimension j Chern-Mather class of XA.

Proof. In light of Theorem 1.2, this follows immediately from Piene’s formula [23, Theorem
3] for the Chern-Mather class of a projective variety in terms of polar degrees. The simpli-
ﬁcation of the summations required to arrive at the formula (18) is aided considerably by
employing the Chern-Mather involution formulas of Aluﬃ [1].

Theorem 1.1 is now a special case of [1, Proposition 2.9]. Aluﬃ’s result expresses the ED
degree of an arbitrary projective variety in terms of the Chern-Mather class. While this does
encompass our situation, it does not provide new tools for actually computing polar degrees,
Chern-Mather classes, or ED degrees. Our contribution ﬁlls this gap in the toric case. We
furnish an algorithm for computing these quantities for an arbitrary projective toric variety
XA, not necessarily normal. Our method is implemented in the Macaulay2 package at (7).
Its input is the d × n-integer matrix A, and its output is the numbers in (5) and (6).

Our implementation allows for relatively eﬃcient and extremely scalable computation.
The running time is almost entirely determined by the facial structure of P = conv(A).
While this may make the computation diﬃcult for high-dimensional polytopes with many
faces, it has several important advantages over algebraic methods. First, the running time
of our code has very little direct dependence on the degree of XA. For algebraic methods
(both numerical and symbolic), this will be a bottleneck: computations become infeasible
as degree(XA) grows. Second, for ﬁxed d and large n, the toric ideal of A can become
unmanageable quite rapidly, while an iteration over the faces of P is still feasible. Third, our
combinatorial method is exact, and many portions of the computation could be parallelized.

7

We close this section by summarizing the steps of our algorithm. The input is the matrix
A. It computes the CM volume for each face of P = conv(A). The output is the list of CM
volumes V0, . . . , Vd−1, the polar degrees δ0(XA), . . . , δd−1(XA), and the ED degree of XA.

• Compute the face poset P of the lattice polytope P = conv(A).

• Build a second poset P, isomorphic to P, whose elements are the pairs (α, Aα) for α ∈ P

• For each chain (P, A) ⊃ (α1, Aα1) ⊃ · · · ⊃ (αℓ, Aαℓ) in the poset P, do the following:

– Reorder the columns of the matrix A according to this chain. The new matrix is

˜A = (cid:0) Aαℓ, Aαℓ−1\αℓ, Aαℓ−2\αℓ−1, . . . , Aα1\α2, AP \α1(cid:1).

– Find the Hermite normal form A′ of ˜A, as in Remark 2.2.
– For all pairs 1 ≤ i < j ≤ ℓ, compute the relative subdiagram volumes µ(αi\αj),

using (13) by selecting the appropriate submatrix C of A′.

• Compute the normalized volumes of all elements in the face poset P.

• Combining all subdiagram volumes and face volumes found above, we now compute

the Euler obstruction for each face of P using the formula in Deﬁnition 2.3.

• Compute Vj using formula (14). Compute δi(XA) using (6). Output EDdegree(XA).

3 Dimension Two and Codimension One

In this section we compute the ED degree for instances of low dimension and low codimension.
We start with toric surfaces. Here d = 3 and we assume that the given matrix has the form

A = 


α1 α2 α3
β1 β2 β3
1
1

1

· · · αn−1 αn
· · · βn−1 βn
1
· · ·

1


 .

The lattice polygon P = conv(A) has normalized area V2 = Vol(P ). Its polar degrees are

δ0 = 3V2 − 2V1 + V0 , δ1 = 3V2 − V1 and δ2 = V2.

The ED degree (for generic λ) is equal to the sum of the polar degrees:

EDdegree(XA) = δ0 + δ1 + δ2 = 7V2 − 3V1 + V0.

(19)

(20)

If XA is smooth then V0 and V1 are positive integers. Namely, V0 is the number of vertices
of P , and V1 is number of all lattice points in the boundary of P . Here is a simple example.

8

Example 3.1. Let n = 9 and XA = P1 × P1, embedded in P8 with the line bundle O(2, 2):

A = 


0 0 0 1 1 1 2 2 2
0 1 2 0 1 2 0 1 2
1 1 1 1 1 1 1 1 1




This corresponds to approximating a data vector u ∈ R9 by biquadratic monomials. Then
P = conv(A) is a square of side length 2. The face volumes are V2 = 8, V1 = 8 and V0 = 4,
and hence EDdegree(XA) = 36. For instance, if the weights are λ = (4, 1, 9, 2, 3, 1, 7, 6, 5)
and data point is u = (29, 14, 46, 13, −5, 42, 42, 5, 23) then precisely 14 of the 36 complex
critical points are real. This choice of λ exhibits the generic behavior. The ED degree drops
from 36 to 20 if we take λ = (1, 1, 1, 1, 1, 1, 1, 1, 1); here the unit weights are not generic. ♦

For singular toric surfaces XA, we must consider the CM volumes of the edges and vertices

of the planar conﬁguration A. If XA is normal then the following formula can be used:

Corollary 3.2. Suppose that XA is a toric surface with isolated singularities in Pn. Then
V1 is the number of lattice points in the boundary of P = conv(A), and the CM volume of a
vertex ai of A equals Vol(conv(A\{ai})) + 2 − Vol(P ), where Vol denotes normalized area.
Hence V0 is the sum of these (possibly negative) integers, as ai ranges over all vertices of P .

Proof. This follows from the general results in Section 2. See also [20, Proposition 1.11.7].

The following example illustrates Corollary 3.2. For a non-normal case see Example 3.6.
For any such small instance A, we can always verify our combinatorial computation of toric
ED degrees using the general algebraic method in [8, (5.3)]. This is done by ﬁrst computing
the bigraded prime ideal of the conormal variety Con(XA). Recall that Con(XA) is an
irreducible closed subvariety of dimension n − 2 in Pn−1 × Pn−1. It is the closure of the set of
pairs (x, y) in Pn−1 × Pn−1 such that x is a smooth point in XA and y is a hyperplane tangent
to XA at x. The projection of Con(XA) onto the second factor is the A-discriminant X ∨
A.

Example 3.3. Let n = 6 and let XA be the normal toric surface in P5 given by

A = 


1 0 1 2 3 1
0 1 1 1 1 2
1 1 1 1 1 1


 .

This is the closure of the image of (C∗)3 → P5, (s, t, u) 7→ (su : tu : stu : s2tu : s3tu : st2u).
Figure 1 shows that V2 = 6 and V1 = 4. The four vertices of the polygon P are
a1, a2, a5, a6, and the corresponding complementary areas Vol(conv(A\{ai})) are 3, 4, 4, 3.
Hence the CM volumes of the vertices are −1, 0, 0, −1, for total of V0 = −2. We conclude

EDdegree(XA) = 7V2 − 3V1 + V0 = 7 · 6 − 3 · 4 + (−2) = 28.

We verify this by computing the conormal variety Con(XA) ⊂ P5 × P5. Each point
y ∈ X ∨
A represents a singular curve {y1su + y2tu + y3stu + y4s2tu + y5s3tu + y6st2u = 0} on
the toric surface XA ⊂ P5, and x = (su : tu : · · · : st2u) is the singular point. The conormal

9

a6

a2

a3

a4

a5

a1

Figure 1: The polygon P = conv(A) has normalized area six. The only lattice points in its
boundary are the four vertices. Their CM volumes can be read oﬀ from this triangulation.

variety has dimension 4. Its prime ideal is minimally generated by 17 polynomials in the
6 + 6 homogeneous coordinates of P5 × P5. Among these are four binomial quadrics that
generate the toric ideal of A. The polar degrees are the coeﬃcients of the multidegree of this
ideal, and they are δ0 = 8, δ1 = 14, and δ2 = 6. This is consistent with Theorem 1.2, which
says that δ0 = 3V2 − 2V1 + V0, δ1 = 3V2 − V1 and δ2 = V2. The A-discriminant X ∨
A is a
hypersurface of degree 8. Its deﬁning polynomial is found among our 17 ideal generators.

The following code in Macaulay2 [12] realizes what is described in the previous paragraph.

R = QQ[s,t,u,x1,x2,x3,x4,x5,x6,y1,y2,y3,y4,y5,y6,Degrees=>{{1,1},{1,1},{1,1},
{1,0},{1,0},{1,0},{1,0},{1,0},{1,0}, {0,1},{0,1},{0,1},{0,1},{0,1},{0,1}}];

f = y1*s*u + y2*t*u + y3*s*t*u + y4*s^2*t*u + y5*s^3*t*u + y6*s*t^2*u;
I = ideal(diff(s,f),diff(t,f),diff(u,f),

x1-s*u,

x2-t*u,

x3-s*t*u,

x4-s^2*t*u,

x5-s^3*t*u,

x6-s*t^2*u);

C = eliminate({s,t,u},I);
C = saturate(C,ideal(x1*x2*x3*x4*x5*x6));
C = saturate(C,ideal(y1*y2*y3*y4*y5*y6));
apply(first entries mingens(C),t->degree(t))
multidegree C

The output of the last line is the binary form whose coeﬃcients are the polar degrees. ♦

We next examine toric hypersurfaces. Let XA ⊂ Pn−1 be deﬁned by one binomial equation

xc1
1 · · · xcr

r = xcr+1

r+1 · · · xcn
n .

Here c1, . . . , cn are positive integers that are relatively prime, and they satisfy

c1 + · · · + cr = cr+1 + · · · + cn = deg(XA).

(21)

(22)

Our goal is to express the ED degree and the polar degrees of XA in terms of c1, c2, . . . , cn.
The integer matrix A has format (n−1)×n, and its kernel is spanned by the column vector
(c1, . . . , cr, −cr+1, . . . , −cn)T . The associated lattice polytope P = conv(A) has dimension

10

n − 2, and it has n vertices provided 2 ≤ r ≤ n − 2. We consider the Cayley polytope of P
and its mirror image −P . This is the (n − 1)-dimensional polytope obtained by placing P
and −P into parallel hyperplanes and taking the convex hull. See e.g. [17, Deﬁnition 4.6.1].
The integer matrix representing the Cayley polytope has format n × 2n. It equals

Cay(A, −A) = (cid:18)1

A −A(cid:19) ,

0

where 1 = (1, 1, . . . , 1) and 0 = (0, 0, . . . , 0) in Rn. We shall ﬁrst derive the following result.

Theorem 3.4. The conormal variety Con(XA) is a toric variety of dimension n − 2 in
Pn−1 × Pn−1. It corresponds to the toric variety of Cay(A, −A). The ED degree of XA is the
normalized volume of the Cayley polytope. The polar degrees δi = δi(XA) are given by

Vol(cid:0)λP + µ(−P )(cid:1) =

n−2

Xi=0

δi(cid:18)n − 2

i (cid:19)λiµn−2−i, where λ, µ ∈ R>0.

(23)

The volume in (23) is the normalized lattice volume. Hence δ0 = δn−2 = Vol(P ) is the
integer in (22). The formula (23) conﬁrms the known fact that the polar degrees of a toric
hypersurface are symmetric, i.e. δi−1 = δn−1−i for all i. This symmetry of the polar degrees
holds for any self-dual projective variety. This is known by results of Kleiman [16]; see also
[1]. Before we give the proof of Theorem 3.4, let us present one corollary and one example.

Corollary 3.5. The polar degrees of XA are piecewise linear functions of c1, . . . , cn. Their
regions of linearity are the cones in the arrangement of hyperplanes given by equating a
subsum of {c1, . . . , cr} with a subsum of {cr+1, . . . , cn}, inside the (n−1)-space given by (22).

Proof. The kernel of the matrix Cay(A, −A) is the row span of the n × 2n-matrix

cr −cr−1
0
0

0
0

· · · −cn
· · ·
· · ·

0
0

c1
c2
1 −1
0

c3
0

· · ·
· · ·
1 −1 · · ·
. . .
1 −1
. . .

. . .
· · ·

0

0

0

0

0





0
0
1 −1
0

0
0

0
0
0

· · ·
· · ·
1 −1 · · ·
. . .
1 −1
. . .

. . .
· · ·

0

0
. . .
. . .

· · ·

0

0

. . .
1 −1

0

0

0

0
0
0

0
. . .
. . .

· · ·
· · ·
· · ·

· · ·

0
0
0

0

. . .
1 −1





.

(24)

Each of the (cid:0)2n

n(cid:1) maximal minors of this Gale dual matrix is the diﬀerence of a subsum of

{c1, . . . , cr} and a subsum of {cr+1, . . . , cn}. All 2n − 1 non-zero such linear forms arise.
They deﬁne hyperplanes inside the (n−1)-space deﬁned by (22). We restrict this hyperplane
arrangement to Rn
>0. Up to sign, the maximal minors of the matrix (24) are also the maximal
minors of Cay(A, −A). Hence the oriented matroid of Cay(A, −A) is ﬁxed when (c1, . . . , cn)
ranges over any cone of our arrangement in Rn
>0. The volume of the Cayley polytope is a sum
of certain maximal minors, selected by the oriented matroid. This implies our claim.

11

Example 3.6. Let n = 4 and consider the toric surface XA = {xc1
4 } in P3.
Writing y1, y2, y3, y4 for the coordinates of the dual P3, the conormal variety Con(XA) is the
3 xc4
irreducible surface in P3 × P3 that is deﬁned by xc1
4 together with the constraint
3 xc4−1
c4xc3
y4

1 xc2
c3xc3−1
3
y3

2 = xc3
xc4
4

1 xc2−1
c2xc1
y2

2 = xc3

1 xc2

3 xc4

(25)

2

rank(cid:18)c1xc1−1

1
y1

xc2
2

4

(cid:19) ≤ 1.

This binomial ideal is not prime, but we must saturate with respect to x1x2x3x4 in order to
compute the prime ideal of Con(XA). Performing this saturation one obtains the 2×2-minors
of the following matrix which has the same row space as the matrix above:

rank(cid:18) c1

x1y1 x2y2 x3y3 x4y4(cid:19) ≤ 1.

c2

c3

c4

(26)

After replacing each variable yi by ciyi, we obtain the binomials corresponding to the rows of
the 4 × 8-matrix in (24). Its Gale dual Cay(A, −A) represents the 3-dimensional polytope
obtained by taking the quadrangle P = conv(A) and placing its mirror image −P on a
parallel plane in 3-space. The volume of that 3-dimensional Cayley polytope equals

EDdegree(XA) = δ0 + δ1 + δ2 = 3(c1 + c2) + max(|c1 − c2|, |c3 − c4|).

Here, δ0 = δ2 = c1 + c2 = c3 + c4, and δ1 = δ0 + max(|c1 − c2|, |c3 − c4|). By (23), we ﬁnd
these formulas by measuring the area of the planar polygon λP + µ(−P ).
♦

J be the ideal given by the 2 × 2-minors of (cid:0)J(XA) y(cid:1)T

Proof of Theorem 3.4. The map that attaches tangent hyperplanes to smooth points of XA
is a birational map from XA ⊂ Pn−1 to the conormal variety Con(XA) ⊂ Pn−1 × Pn−1. It is
equivariant with respect to the action of the dense torus of XA. Hence Con(XA) is toric. We
ﬁnd its toric ideal using a procedure analogous to the transformation from (25) to (26). Let
where y = (y1, . . . , yn) and J(XA)
is the gradient vector of (21). This matrix is analogous to (25). Let IA be the ideal of (21).
The ideal deﬁning Con(XA) is (IA + J ) : hJ(XA)i∞. This is a toric ideal. It can also be
obtained by saturating the binomial ideal IA + J with respect to x1 · · · xn since the singular
locus of XA lies in {x1 · · · xn = 0}. Among the generators of that toric ideal are the binomials
cjxiyi − cjxiyi as in (26). We take these for j = i + 1 together with (21) and we write them
as the row vectors of the n × 2n-matrix (24). This matrix is the Gale dual of Cay(A, −A).
This proves the ﬁrst two statements in Theorem 3.4. The next conclusions about the ED
degree and the polar degrees of XA now follow from known results (cf. [17, Proposition 4.6])
about the relationship between mixed volumes and triangulations of Cayley polytopes.

Theorem 3.4 identiﬁed the conormal variety of a toric hypersurface as the toric variety
given by the Cayley polytope. The ED degree is the volume of the Cayley polytope. We
now use the general result in Theorem 1.1 and 1.2 to derive a formula for that volume.

Theorem 3.7. The ith polar degree of the toric hypersurface XA equals

δi = (cid:18)n − 1

i + 1(cid:19) · deg(XA) − Xτ : |τ |=n−i−1

min(cid:0) Xj∈τ ∩{1,...,r}

cj

, Xj∈τ ∩{r+1,...,n}
cj (cid:1).

(27)

12

Proof. The (n − 2)-dimensional polytope P = conv(A) is simplicial. Its minimal non-faces
are {1, . . . , r} and {r+1, . . . , n}. For i ≤ n − 3, we encode each i-simplex in ∂P by the
index set τ ⊂ {1, 2, . . . , n} of those columns ai that are not in the simplex. These τ satisfy
|τ | = n − 1 − i, and both τ + = τ ∩ {1, . . . , r} and τ − = τ ∩ {r+1, . . . , n} are non-empty.

By Corollary 3.5, the polar degrees of XA are linear functions on certain full-dimensional
polyhedral cones in Rn
>0. The lattice points (c1, . . . , cn) with relatively prime coordinates in
such a cone are Zariski dense. Every linear function on Rn is determined by its values on a
Zariski dense subset. Hence, in what follows, we may assume that gcd(ci, cj) = 1 for all i, j.
Given this assumption, we claim that Vol(τ ) = 1 for every proper face τ of P . Suppose
this does not hold. Then Vol(τ ) > 1 for some facet τ , say τ = {r, n} after relabeling. This
facet is the simplex with vertex set γ = {a1, . . . , ar−1, ar+1, . . . , an−1}. There exists p ∈ Zγ
such that, for some i, the lattice spanned by (γ\{ai}) ∪ {p} has index ip ≥ 2 in Zγ. We have

cr = Vol(cid:0) γ ∪ {an}(cid:1) = ip · Vol(cid:0) (γ\{ai}) ∪ {p, an}(cid:1)
and cn = Vol(cid:0) γ ∪ {ar}(cid:1) = ip · Vol(cid:0) (γ\{ai}) ∪ {p, ar}(cid:1).

So, ip divides gcd(cr, cn), a contradiction. Hence Vol(τ ) = 1 for every proper face τ of P .
For every face σ of P that contains τ , the subdiagram volume in Deﬁnition 2.1 equals

µ(σ/τ ) = ( min(cid:0)Pi∈τ + ci , Pj∈τ − cj(cid:1)

1

if σ = P,
otherwise.

(28)

With this, we can solve the recursion in Deﬁnition 2.3. This results in a formula for the Euler
obstruction Eu(τ ), and hence for the CM volume of τ , as an alternating sum of expressions

min(Pj∈σ+ cj , Pj∈σ− cj ). When we write the sum in (14), and thereafter the sum in (6), a

lot of regrouping and cancellation occurs. The ﬁnal result is the expression for δi in (27).

Corollary 3.8. The Euclidean distance degree of the toric hypersurface XA equals

EDdegree(XA) = (2n−1 − 1) · deg(XA) − Xτ ⊂{1,...,n}

min(cid:0) Xj∈τ ∩{1,...,r}

cj

, Xj∈τ ∩{r+1,...,n}
cj (cid:1).

It is instructive to consider the case of surfaces in P3 and to compare with Corollary 3.2.

Example 3.9. Let n = 4 and r = 2 and set D = deg(XA). The polar degrees are δ2 = D,

δ1 = 3D − min(c1, c3) − min(c1, c4) − min(c2, c3) − min(c2, c4) = D + max(cid:0)|c1 − c2|, |c3 − c4|(cid:1),

and δ0 = 3D − c1 − c2 − c3 − c4 = D. Their sum gives us the simple formula

Another toric surface arises for n = 4 and r = 1. In that case, δ0 = δ2 = D and δ1 = 2D. ♦

EDdegree(XA) = 3D + max(cid:0)|c1 − c2|, |c3 − c4|(cid:1).

The results in this paper furnish exact formulas for the algebraic complexity of solving

the optimization problems (3) and (4). We close this section with a numerical example.

13

Example 3.10. Given a list (u1, u2, u3, u4, u5, u6) of six real measurements, we seek to ﬁnd
the best approximation by a real vector (x1, x2, x3, x4, x5, x6) that satisﬁes the model

x22
1 x23

2 x64

3 = x26

4 x14

5 x69
6 .

The general formula in [8, Corollary 2.10] for hypersurfaces of degree d = 109 says that

d ·(cid:0)1 + (d − 1)1 + (d − 1)2 + (d − 1)3 + (d − 1)4 + (d − 1)5(cid:1) = 1, 616, 535, 525, 241

is an upper bound for the algebraic degree of our optimization problem. Corollary 3.8 shows
that the true answer is much smaller: EDdegree(XA) = 1348. Numerical Algebraic Geometry
[3] allows us to compute all complex critical points, and hence all local approximations. ♦

4 Discriminants, Tropicalization and Hypersimplices

We computed the algebraic degree of the optimization problem (3) when the weight vector λ
and the data vector u are generic. This generic behavior fails when these vectors are zeros of
certain discriminants. In what follows we discuss those discriminants. Later in this section,
we explore connections to tropical geometry: building on [6, 7], we discuss the tropicalization
of the conormal variety of a toric variety XA. Thereafter, we conclude by returning to (1).
We begin by examining the genericity condition on the weight vector λ = (λ1, . . . , λn)
i )1/2. Following [21], we can deﬁne the ED degree
of the toric variety XA for any positive λ. However, it may be smaller than the generic one:

that speciﬁes the norm ||x||λ = (Pn

i=1 λix2

EDdegreeλ(XA) ≤ EDdegree(XA).

(29)

Such a drop occurred for λ = (1, 1, . . . , 1) in Example 3.1, but not in Example 1.3. Similar
instances are featured in [8, Example 2.7, Corollary 8.7] and [21, Examples 1.1, Table 1,
Proposition 4.1]. We now oﬀer a characterization of the weights whose ED degree is generic.
A for the A-discriminant, that is, the projective variety dual to XA.

As before, we write X ∨

If the dual X ∨

A is a hypersurface in Pn−1 then we write ∆A for its deﬁning polynomial.

Proposition 4.1. Equality holds in (29) when the vector λ is not in the A-discriminant X ∨
A.

Proof. Theorem 5.4 in [8] states that the ED degree of a variety X ⊂ Pn−1 agrees with
the generic ED degree provided the conormal variety Con(X) is disjoint from the diagonal
∆(Pn−1) in Pn−1×Pn−1. This refers to the usual Euclidean norm || ||1 on Rn. We apply this to
the scaled toric variety X = λ1/2XA whose points are λ1/2x = (λ1/2
n xn)
where x = (x1 : x2 : · · · : xn) = (ta1 : ta2 : · · · : tan) runs over XA. The ED problem for X
with respect to the norm || ||1 is identical to the ED problem for XA with respect to || ||λ.

2 x2 : · · · : λ1/2

1 x1 : λ1/2

The intersection Con(X) ∩ ∆(Pn−1) is non-empty if there exist λ ∈ (C∗)n and t ∈ (C∗)d
such that the hyperplane with normal vector λ1/2x is tangent to X at the point λ1/2x.
This corresponds to the condition that the hypersurface deﬁned by the Laurent polynomial
i=1 λit2ai has a singular point t ∈ (C∗)d. This is equivalent to saying that the hypersurface

i=1 λitai is singular. Hence λ lies in the A-discriminant X ∨
A.

Pn
in (C∗)d deﬁned by Pn

14

The argument in the previous paragraph is reversible if we replace the torus (C∗)d by its
i=1 λit2ai deﬁnes a non-singular hypersurface inside

compactiﬁcation XA. If λ 6∈ X ∨
the toric variety XA, and the conormal variety of X = λ1/2XA is disjoint from ∆(Pn−1).

A then Pn

Example 4.2. Let d = 2, n = 3 and A =(cid:18)0 1 2

1 1 1(cid:19). The function (9) we seek to minimize is

L(s, t) = λ1(t − u1)2 + λ2(st − u2)2 + λ3(s2t − u3)2,

where u1, u2, u3 ∈ R and λ1, λ2, λ3 ∈ R>0 are parameters. We form the partial derivatives of
L(s, t) as in (8). The resultant of these two derivative polynomials with respect to s gives

λ1(4λ1λ3 − λ2

2)2 · t4 + (−48λ3

3u3 − λ1λ4

2u1 − 4λ1λ3

2λ3u3) · t3

3u1 + 16λ2

1λ2
1λ2
+ · · · + (4λ1λ2

2λ3u1 + 16λ2
2λ2

3u1u2

2u3 − λ4

1λ2λ2

2λ3u4

2) = 0.

The degree of this univariate polynomial equals EDdegree(XA) = 4 provided the discriminant
∆A = 4λ1λ3 − λ2
2 is non-zero. If this holds then L(s, t) has 4 critical points for generic u. ♦

Corollary 4.3. For a toric variety XA, the usual norm is ED generic, i.e. EDdegree1(XA) =
i=1 xi = 0 inside XA is non-singular.

EDdegree(XA), whenever the hypersurface deﬁned by Pn

This explains the generic behavior of || ||1 for rational normal curves seen in Example 1.3.

Example 4.4. Consider the toric hypersurface (21). By [11, §9.1], its A-discriminant equals

∆A = uur+1

r+1 · · · uun

n · λu1

1 · · · λur

r − (−1)D · uu1

1 · · · uur
r

· λur+1

r+1 · · · λun
n .

Hence || ||1 is always ED generic when D = deg(XA) is odd. If D is even then the hypothesis

uu1
1 · · · uur
r

6= uur+1

r+1 · · · uun
n

ensures that Corollary 3.8 counts critical points correctly for the usual Euclidean norm. ♦

Suppose now that λ ∈ Rn

A has been ﬁxed. Then the question arises which data
vectors u ∈ Rn exhibit the generic behavior. There are three possible types of degeneracies:

>0\X ∨

• the ED discriminant [8] concerns collisions of critical points in the smooth locus of XA;

• the data singular locus [14, §2.1] concerns critical points in the singular locus of XA;

• the data isotropic locus [14, §2.2] concerns critical points that satisfy Pn

A careful study of all three for toric varieties XA would be worthwhile. Generally none of
these three loci are toric varieties themselves. We oﬀer some preliminary observations:

i=1 λix2

i = 0.

• Example 7.2 in [8] shows that the ED discriminant is complicated and not toric even
when XA has codimension 1. It would be interesting to compute the degree of the ED
discriminant for (21) and to compare it to Trifogli’s formula in [8, Theorem 7.3].

15

• The data singular locus always contains the A-discriminant [14, Theorem 1].

• The data isotropic locus always contains the A-discriminant [14, Theorem 2].

The Matsui-Takeuchi formula for the degree of the A-discriminant given in Theorem
1.2 is an alternating sum of CM volumes of faces of P . A positive formula, as a sum
of combinatorial numbers, was given independently by Dickenstein et al. in [6].
In fact,
Theorem 1.2 in [6] expresses every initial monomial of ∆A explicitly in a positive manner.
Such formulas are derived using Tropical Geometry [17]. Their advantage over [19] is that
they furnish start systems for homotopy continuation in Numerical Algebraic Geometry [3].
In what follows we assume familiarity with basics of tropical geometry, especially on
varieties given by monomials in linear forms [17, §5.5]. The Horn uniformization of the
A-discriminant [6, §4] lifts to the following parametrization of the conormal variety of XA.

Proposition 4.5. Let A be an integer d × n-matrix as above and XA its projective toric
variety in Pn−1. The conormal variety Con(XA) is the closure of the set of points (x, y) in
Pn−1 × Pn−1, where x ∈ XA and x · y ∈ kernel(A). Its tropicalization is the set of points
(u, v) in (Rn/R1)2 where u ∈ rowspace(A) and u + v is in the co-Bergman fan B∗(A).

The tropical variety trop(Con(XA)) is a balanced fan of dimension n−2 in (Rn/R1)2. The
description above was used by Dickenstein and Tabera [7] to study singular hypersurfaces.

Corollary 4.6. The polar degree δi(XA) is the number of points in the intersection

trop(Con(XA)) ∩ (Ln−2−i × Mi) ⊂ (Rn/R1) × (Rn/R1),

where Ln−2−i is a tropical (n − 2 − i)-plane and Mi is a tropical i-plane. These planes can be
chosen as in [17, Corollary 3.6.16], and the count is with multiplicities as in [17, (3.6.5)].

In analogy to [6, Theorem 1.2], this corollary can be translated into an explicit positive
formula for the polar degrees and hence for the ED degree of XA. This should be useful for
developing homotopy methods for solving the critical equations, which can now be written as

x + y = u , x ∈ ˜XA and x · y ∈ kernel(A)

for λ = 1.

(30)

This formulation arises from [8, Theorem 5.2], where all varieties are regarded as aﬃne cones.

We now return to the optimization problem (1). Here n = (cid:0)d

whose columns are the vectors in {0, 1}d that have precisely k entries equal to 1. The
(d − 1)-dimensional polytope P = conv(A) is the hypersimplex ∆d,k. The toric variety XA
represents generic torus orbits on the Grassmannian of k-dimensional linear subspaces in
Cd. The degree of XA is the volume of ∆d,k. This is known (by [25]) to equal the Eulerian
number A(d − 1, k − 1). In what follows we determine the CM volumes, polar degrees and
ED degree for the hyperpsimplex ∆d,k. Table 1 oﬀers a summary of all values for d ≤ 8.
Here we may assume 2 ≤ k ≤ ⌊d/2⌋ because the cases (d, k) and (d, d − k) are isomorphic.
A couple of observations are in place. The last entry in the respective vectors is the
Eulerian number Vol(∆d,k) = A(d − 1, k − 1). The ED degree is the sum of the polar degrees.

k(cid:1) and A is the matrix

16

(20, 30, 30, 25, 11)

(30, 60, 80, 90, 72, 26)

(12, 12, 8, 4)

Chern-Mather volumes

d k
4 2
5 2
6 2
6 3
7 2
7 3
8 2 (56, 168, 336, 560, 784, 784, 464, 120)
8 3 (168, 420, 840, 1610, 2632, . . . , 1191)
8 4

(42, 105, 175, 245, 273, 189, 57)
(105, 210, 350, 560, 714, 644, 302)

(280, 560, 1120, 2240, . . . , 2416)

(60, 90, 120, 150, 132, 66)

Polar degrees

(4, 12, 8, 4)

(5, 20, 40, 30, 11)

(6, 30, 80, 120, 84, 26)

(96, 300, 480, 480, 264, 66)
(7, 42, 140, 280, 336, 210, 57)

(315,1302,2940,3920,3192,1470,302)
(8, 56, 224, 560, 896, 896, 496, 120)
(848, 4256, 12096, 21280, . . . , 1191)
(3816, 16016, 38976, 60480, . . . 2416)

ED degree

28
106
346
1686
1072
13441
3256
86647
236104

Table 1: Computing the ED degree for the toric variety of the hypersimplex ∆d,k

The ﬁrst polar degree δ0 is the degree of the A-discriminant ∆A. For k = 2 this is simply
the determinant of the symmetric matrix with zero diagonal entries. For instance, for d = 4,

∆A(λ) = det


λ12 λ13 λ14
0
λ23 λ24
λ12
0
λ13 λ23
0
λ34
0
λ14 λ24 λ34




.

(31)

A key point is that ∆A(λ) 6= 0 when λ = (1, . . . , 1). This ensures that the usual Euclidean
metric is generic for (1). There is no degree drop due to the weights λ being special.

We close by presenting general formulas for the Chern-Mather volumes of hypersimplices:

Proposition 4.7. The Chern-Mather volumes for the hypersimplex ∆d,k are

V0 =

(cid:0)d
k(cid:1) · min(k, d − k)
Vℓ = Pmin(k,ℓ)
(cid:0) d
ℓ+1(cid:1)(cid:0)d−ℓ−1

k−i (cid:1) · A(ℓ, i − 1)

i=1

for ℓ = 1, . . . , d − 1.

For ℓ = d − 1 this formula gives the Eulerian number Vd−1 = A(d − 1, k − 1) = Vol(∆d,k).

Proof. We apply the algorithm at the end of Section 2 to the face poset of ∆d,k. Since
every face of the hypersimplex is a hypersimplex, it is convenient to proceed by induction.
The base step is the subdiagram volume of a vertex of ∆d,k. Each vertex has (d − k)k
neighbors. These lie on a hyperplane in the ambient (d − 1)-space. Their convex hull is a

product of simplices ∆k−1 × ∆d−k−1. The normalized volume of such a product equals(cid:0)d−2
k−1(cid:1).
Hence the subdiagram volume of any vertex at ∆d,k is (cid:0)d−2
k−1(cid:1). The vertex ﬁgures of any

positive-dimensional face at ∆d,k is a simplex. In fact, the toric variety X∆d,k has isolated
singularities. Hence µ(α/β) = 1 for all subdiagram volumes at faces β with dim(β) ≥ 1.

From Proposition 4.7 one easily computes the polar degrees (6) and the ED degree (5).
This solves an open problem, namely to determine the degree of the A-discriminant for k ≥ 3.
This was asked for d = 6 and k = 3 in [15, Problem 7]. Table 1 reveals that the answer is 96.

17

Acknowledgements. We are grateful to Ragni Piene and Anna Seigal for helpful comments on
drafts of this paper. Martin Helmer was supported by an NSERC postdoctoral fellowship. Bernd
Sturmfels was partially supported by the US National Science Foundation (DMS-1419018).

References

[1] P. Aluﬃ: Projective duality and a Chern-Mather involution, arXiv:1601.05427v2.
[2] B. Bank, M. Giusti, J. Heintz and GM. Mbakop: Polar varieties and eﬃcient real elimination,

Mathematische Zeitschrift 238 (2001) 115–144.

[3] D. Bates, J. Hauenstein, A. Sommese and C. Wampler: Numerically Solving Polynomial Sys-
tems with Bertini, Software, Environments and Tools, Vol 25, SIAM, Philadelphia, PA, 2013
[4] JP. Brasselet, J. Seade and T. Suwa: Vector Fields on Singular Varieties, Lecture Notes in

Mathematics 1987, Springer-Verlag, Berlin, 2009.

[5] D. Cox, J. Little and H. Schenck: Toric Varieties, Graduate Studies in Mathematics, Volume

124, American Mathematical Society, Providence, RI, 2011.

[6] A. Dickenstein, E.M. Feichtner and B. Sturmfels: Tropical discriminants, J. Amer. Math. Soc.

20 (2007) 1111–1133.

[7] A. Dickenstein and L. Tabera: Singular tropical hypersurfaces, Discrete Comput. Geom. 47

(2012) 430–453.

[8] J. Draisma, E. Horobet¸, G. Ottaviani, B. Sturmfels, and R. Thomas: The Euclidean distance
degree of an algebraic variety, Foundations of Computational Mathematics 16 (2016) 99–149.
[9] L. Ernstr¨om: A Pl¨ucker formula for singular projective varieties, Communications in Algebra,

25 (1997) 2897–2901.

[10] W. Fulton: Intersection Theory, Springer, Berlin, 2nd edition, 1998.
[11] IM. Gelfand, M. Kapranov and A. Zelevinsky. Discriminants, Resultants, and Multidimen-

sional Determinants, Birkh¨auser, Boston, 1994.

[12] D. Grayson and M. Stillman: Macaulay2, a software system for research in algebraic geometry,

available at www.math.uiuc.edu/Macaulay2/.

[13] A. Holme: The geometric and numerical properties of duality in projective algebraic geometry,

Manuscripta mathematica 61 (1988) 145–162.

[14] E. Horobet¸: The data singular and the data isotropic loci for aﬃne cones, arXiv:1507.02923.
[15] P. Huggins, B. Sturmfels, J. Yu and D. Yuster: The hyperdeterminant and triangulations of

the 4-cube, Mathematics of Computation 77 (2008) 1653–1679

[16] S. Kleiman: Tangency and duality, Proceedings of the 1984 Vancouver conference in algebraic
geometry, 163–225, CMS Conf. Proc, 6, American Mathematics Society, Providence, RI, 1986.
[17] D. Maclagan and B. Sturmfels: Introduction to Tropical Geometry, Graduate Studies in Math-

ematics, Volume 161, American Mathematical Society, Providence, RI, 2015.

[18] R. MacPherson: Chern classes for singular algebraic varieties, Annals of Mathematics 100

(1974) 423–432.

[19] Y. Matsui and K. Takeuchi: A geometric degree formula for A-discriminants and Euler ob-

structions of toric varieties, Advances in Mathematics 226 (2011) 2040–2064.

[20] B. Nødland: Singular Toric Varieties, Masters Thesis, University of Oslo, Norway, 2015.

18

[21] G. Ottaviani, P-J. Spaenlehauer and B. Sturmfels: Exact solutions in structured low-rank

approximation, SIAM Journal on Matrix Analysis and Applications 35 (2014) 1521–1542.

[22] R. Piene: Polar classes of singular varieties, Annales Scientiﬁques de l’ ´Ecole Normale

Sup´erieure 11 (1978) 247–276.

[23] R. Piene: Cycles polaires et classes de Chern pour les vari´et´es projectives singuli`eres, Intro-

duction `a la th´eorie des singularit´es, Travaux en Cours, 37, 7–34, Hermann, Paris, 1988.

[24] M. Safey El Din and ´E. Schost: Polar varieties and computation of one point in each connected
component of a smooth real algebraic set, Proceedings of the 2003 International Symposium
on Symbolic and Algebraic Computation, pp. 224-231, ACM, August 2003.

[25] R. Stanley: Eulerian partitions of a unit hypercube, Higher Combinatorics (M. Aigner, ed.),

Reidel, Dordrecht-Boston, 1977, p. 49.

[26] B. Sturmfels: Gr¨obner Bases and Convex Polytopes, University Lecture Series, Vol 8, American

Mathematical Society, Providence, RI, 1996.

Authors’ address:

Department of Mathematics, University of California, Berkeley, CA 94720, USA
martin.helmer@berkeley.edu, bernd@berkeley.edu

19

