Coverage gain and Device-to-Device user Density:

Stochastic Geometry Modeling and Analysis

Haﬁz Attaul Mustafa, Muhammad Zeeshan Shakir, Muhammad Ali Imran, Ali Imran, and Rahim Tafazolli

1

6
1
0
2

 
r
a

M
5

 

 
 
]
T
I
.
s
c
[
 
 

1
v
8
9
6
1
0

.

3
0
6
1
:
v
i
X
r
a

Abstract—Device-to-device (D2D) communication has huge
potential
for capacity and coverage enhancements for next
generation cellular networks. The number of potential nodes
for D2D communication is an important parameter that directly
impacts the system capacity. In this paper, we derive analytic
expression for average coverage probability of cellular user and
corresponding number of potential D2D users. In this context,
mature framework of stochastic geometry and Poisson point
process has been used. The retention probability has been
incorporated in Laplace functional to capture reduced path-loss
and shortest distance criterion based D2D pairing. The numerical
results show a close match between analytic expression and
simulation setup.

Index Terms—D2D user density, marked PPP, retention prob-

ability, average coverage probability.

I. INTRODUCTION

T HE homogeneous Poisson point process (PPP) and its

variant marked PPP (MPPP) has special characteristics
to provide mathematical tractability for modeling the spatial
distribution of macro cells, small cells, and cellular users.
These tools are used in [1–3] to derive the analytic expression
for transmission capacity and outage probability of cellular
and D2D users; however, no notion of D2D pairing, based
on some selection criterion (e.g., reduced path-loss), has been
assumed in Laplace functional of point process. This means
every node is in D2D communication even if the nodes
in a feasible cooperation region1. The maximum
are not
achievable transmission capacity of D2D communication in
heterogeneous networks with multi-bands has been analyzed in
[4]. The problem has been formulated as a sum capacity opti-
mization problem for D2D network where outage probabilities
of cellular and D2D users are set as constraints. The results
of [4] are based on MPPP for D2D user density, however,
similar to the previous papers, no analytic representation of
some criterion-based D2D pairing has been considered.

Manuscript received x x, 2015; revised x x, 2015; accepted x x, 2015.
Date of publication x x, 2015; date of current version x x, 2015. This work
was supported by Qatar National Research Fund (a member of the Qatar
Foundation, NPRP grant No. 5-1047-2437) and members of the University of
Surrey 5GIC (http://www.surrey.ac.uk/5gic). The associate editor coordinating
the review of this paper and approving it for publication was J. Lee.

H. A. Mustafa, M. A. Imran, and R. Tafazolli are with Institute for
Communication Systems (ICS), University of Surrey, Guildford, UK. Emails:
{h.mustafa, m.imran, r.tafazolli}@surrey.ac.uk

M. Z. Shakir is with Electrical and Computer Engineering Dept., Texas
A&M University at Qatar, Doha. Email: muhammad.shakir@qatar.tamu.edu
A. Imran is with School of Electrical and Computer Engineering, University

of Oklahoma, Tulsa, USA. Email: ali.imran@ou.edu

1The distance between nodes can be as large as twice the radius of the cell

which is not a realistic assumption for direct communication.

In this letter, we present an analytic framework for the
analysis of average coverage probability of cellular user and
corresponding D2D user density. Using mature framework
of stochastic geometry and MPPP, we introduce retention
probability in Laplace functional of MPPP to capture the
effect of reduced path-loss based selection of D2D pairs.
By assuming every node in D2D communication (no D2D
pairing criterion) and using same transmit power for D2D
pairs, a lower bound on average coverage probability has been
introduced as a special case.

The system model is presented in Section II. Section III
covers retention probability followed by derivation of closed-
form expression for average coverage probability of cellular
user. Numerical results are presented in Section IV followed
by conclusion in Section V.

II. SYSTEM MODEL

Consider small cell base station (SBS), cellular user, and
potential D2D users as shown in Fig. 1. In this model, the

Data Service
Signaling
Interference

r
d

D2D 
Interferer

o

R

SBS

R

r
c

Cellular 
User

Fig. 1: System model for D2D user density.

uplink resources of cellular users are shared by potential D2D
users. The time division duplex (TDD) mode is assumed
between D2D users. The data and signaling is provided by the
SBS to the cellular users whereas only signaling is assumed
for potential D2D users. For average coverage probability of
cellular user, interference is generated by all D2D pairs.

The cellular and potential D2D users are distributed in
the coverage area bounded between SBS radius R and the
protection region R0. All potential D2D users can make pair
with each other, however, due to the small probability of
occurrence, pairing of more than two D2D users with the
reference user is ignored in this work. The distance between
SBS and cellular user is rc which is used to calculate path-
loss. Every successful D2D pair has a distance of rd between
nodes. The channel model assumes distance dependent path-
loss and Rayleigh fading. The simple singular path-loss model

y
t
i
l
i

b
a
b
o
r
P

n
o
i
t
n
e
t
e
R

0.5

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0
 

0

k = 0.5 (Analytical)
k = 0.6 (Analytical)
k = 0.7 (Analytical)
k = 0.8 (Analytical)
(Simulation)

λ = 0.000012 (Analytical)
λ = 0.000012 (Simulation)
λ = 0.000025 (Analytical)
λ = 0.000025 (Simulation)
λ = 0.000050 (Analytical)
λ = 0.000050 (Simulation)
λ = 0.000075 (Analytical)
λ = 0.000075 (Simulation)
λ = 0.000100 (Analytical)
λ = 0.000100 (Simulation)

 

0.5

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

y
t
i
l
i

b
a
b
o
r
P

n
o
i
t
n
e
t
e
R

5

10

15

20

25

30

35

40

45

50

Target distance, µ(m)

0
 
0

5

10

15

20

25

30

Target distance, µ(m)

2

 

35

40

45

50

Fig. 2: Retention probability and tuning factor k for λ = 0.000025.

Fig. 3: Retention probability for k = 0.8, and different λ.

−α) is assumed where the protection region ensures the
(rc
convergence of the model by avoiding rc to lie at the origin.
However, R0 ≪ R such that it can be considered as an atom in
point process terminology i.e., R0 ∼ 0. The received power at
SBS follows exponential distribution. The distance rc follows
uniform probability distribution function (pdf) as follows:

f (rc) =

2rc
R2

, f (θ) =

1
2π

,

(1)

where R0 ≤ rc ≤ R and 0 ≤ θ ≤ 2π.

III. RETENTION AND COVERAGE PROBABILITY

We assume homogeneous MPPP for distribution of potential
D2D users to analyze the average coverage probability of
cellular user. The homogeneous MPPP Φ = {xi, yi} is
deﬁned by marks and labels. The marks represent the spatial
positions on the plane xi ∈ R2 and labels represent the
channel gains yi ∈ R+ of D2D users. In order to incorporate
selection criterion for D2D pairing, we assume reduced path-
loss (shortest distance) between potential D2D users. All nodes
that do not meet this criterion are excluded from D2D pairing.
In this context, we convert Φ to Φp where p : R2 7→ [0, 1]
performs thinning process to analytically capture the shortest
distance based selection of points.

The number of points that generate shot-noise ﬁeld (SN) at a
reference point are implicitly represented in Laplace functional
of MPPP [5] given as:

LΦ(f ) = e− RRd (1−e−f (x))λ dx,

(2)

where f (x) is the real function deﬁned on Rd and λ is the
intensity measure of points (in this case D2D user density). If
we introduce retention probability p(rd < µ) as the probability
that certain points meet some target distance µ, then we can
incorporate it in Laplace functional of MPPP. For notational
convenience, we will use p(rd) in Laplace functional (2) as:

LΦp (f ) = e− RRd (1−e−f (x))p(rd)λ dx,

(3)

In this paper, we introduce p(rd) (based on [6]) with tun-
ing factor k to analytically capture simple reduced path-loss

(shortest distance) based selection of D2D pairs as follows:

p(rd) = 1 − e−kπλµ2

,

(4)

The tuning factor has been determined by simulating the
system model. The retention probability has been plotted for
D2D user density λ, target distance µ, and different values
of k. For illustrative purpose, the value of λ = 0.000025 has
been chosen as shown in Fig. 2. The value of k = 0.8 matches
with the simulation runs for lower values of target distance
(e.g., µ ≤ 50m). For this value of k, the retention probability
for different values of λ has been plotted in Fig. 3. In this
ﬁgure, retention probability depends on two parameters i.e.,
λ and µ. The higher value of λ results in larger number
of potential D2D pairs within a target distance; however,
shortest distance criterion allows only single pair for D2D
communication. This results in mismatch between analytic
expression and simulation curves. For example, the value of
λ = [0.000050, 0.000075, 0.0001] results in higher mismatch
as compared to the lower values ([0.000012, 0.000025]). This
mismatch can be removed if point-to-multipoint D2D links
are considered for direct communication. The higher λ also
increases the retention probability which is intuitive as more
D2D links can meet the target distance criterion. The target
value µ has similar interpretation. For lower target values, few
D2D interferers lie in target distance. This results in close
match between analytic expression of retention probability and
simulation curves. The higher target distance results in more
interferers which is not instructive for realistic scenarios.

In order to derive average coverage probability of cellular
user, we assume interference-limited environment (σ2 = 0).
Hence, the signal-to-interference ratio (SIR) is given as:

SIRSBS =

,

(5)

pcfcr−α

c

Pi∈Φ pifir−α

i

where pc, and pi are the transmit power of cellular user and
D2D interferers, respectively; fc, and fi are respective small-
scale fading. The corresponding distance dependent path-
losses are r−α

, and r−α

.

c

i

The average coverage probability of cellular user distributed

uniformly over plane between R and R0 at a distance rc from
the serving SBS is given as:

where

pc

cov = Erc(cid:2)P[SIRSBS ≥ γ] | rc(cid:3),
)] | rc(cid:3),

γIm
pcr−α

c

= Erc(cid:2)P[(fc ≥
Im = Xi∈Φ

pifir−α

,

i

(6)

(7)

is the interference due to D2D users in the coverage area.

i

c

In (6),

, pi, fi, r−α

the coverage probability depends on a number
. The power
of random variables e.g., pc, fc, r−α
transmitted by the cellular user pc is assumed to be indepen-
dent of the interferers and controlled by the serving SBS. The
fading fc and fi follows Rayleigh distribution with pc and
pi as exponentially distributed. The cellular user is uniformly
distributed in the coverage area of SBS whereas all interferers
are distributed according to MPPP process. Conditioning on
g = {pi, fi}, the coverage probability of cellular user for a
given transmit power pc is

P[SIRSBS ≥ γ] | rc, g = Z ∞

e−xdx,

x= γIm
−α
c

pc r
c rα

= e−γp−1

c Im ,

De-conditioning by g, (8) results into:

c rα

P[SIRSBS ≥ γ] | rc = Eg(cid:2)e−γp−1
= Eg(cid:2)e−scIm(cid:3),
= LIm(cid:0)sc(cid:1),

c Im(cid:3),

where sc = γp−1
Putting the value of Im from (7) into (9)

c .
c rα

e−scpifir−α

LIm(cid:0)sc(cid:1) = EΦ,pi,fi(cid:20)e−sc Pi∈Φ pifir−α
i (cid:21),
= EΦ,pi,fi(cid:20)Yi∈Φ
i (cid:21),
= EΦ,pi(cid:20)Yi∈Φ
Efi(cid:2)e−scpifir−α
= EΦ(cid:20)Yi∈Φ
Epi(cid:18)
= EΦ(cid:20)Yi∈Φ
(cid:18)
|

(cid:3)(cid:21),
i (cid:19)(cid:21),
i (cid:19)
(cid:21),
}

1 + scE[pi]r−α

1 + scpir−α

{z

f (x)

1

1

i

where (10) results from the i.i.d distributions of pi and fi and
further independence from the underlay MPPP process.

The probability generating functional (PGFL) for a function

f (x) with retention probability p(rd) from (4) implies:

E(cid:20) Ym∈Φ

f (x)(cid:21) = e−RR2 (1−f (x))p(rd)λ dx,

0 R 2π
= e−λ p(rd) R ∞
= e−2πλ p(rd) R ∞

0 (1−f (x))xdrdx,
0 (1−f (x))xdx,

(11)

,

3

(12)

(13)

Putting f (x) from (10) into (11) results:

LIm(cid:0)sc(cid:1) = e

= e

−2πλ p(rd) R ∞

−2πλ p(rd) R ∞

R0(cid:0)1−
R0(cid:0)

1

1+sc E[pi]x−α(cid:1)xdx
sc E[pi](cid:1)xdx

,

1

1+ xα

By substituting

xα

sc E[pi] = uα, (12) results

LIm(cid:0)sc(cid:1) = e−2πλ p(rd)(sc)

2
α E[p

2
α

i ] R ∞

R0(cid:0) u

1+uα(cid:1)du,

Since R0 ≪ R, therefore assuming R0 ∼ 0, the integral on
right hand side of (13) can be evaluated as:

0 (cid:18) u
Z ∞

1 + uα(cid:19)du =

π

α sin( 2π
α )

,

(14)

Putting (14) into (13) and using uniform distribution from (1),
the average coverage probability of a cellular user (6) is:

pc

cov = Erc(cid:20)e
=Z R

e

R0

2π2 λ p(rd ) r2
c

−

α sin( 2π
α

pc(cid:1) 2
) (cid:0) γ

α E[p

2
α
i ]

|rc(cid:21),

−

2π2 λ(1−e−kπλµ2

α sin( 2π
α

)

) r2
c

α E[p

pc(cid:1) 2
(cid:0) γ

2
α

i ] 2rc
R2

drc,

(15)

For same transmit power of all D2D interferers, the average
coverage probability of cellular user for path-loss exponent
α = 4 and R0 ∼ 0 reduces to:

pc
cov =

− π2 R2λ

2 q γpi

pc

e
− π2R2λ

2 q γpi

pc

(1−e−kπλµ2

) − 1
(1 − e−kπλµ2 )

,

(16)

The lower bound on average coverage probability of cellular
user is simply the cellular coverage probability without PPP
thinning process. It can be derived by relaxing the shortest
distance criterion and allowing every node to be in D2D pair.
This case shows maximum interference due to full frequency
reuse by all nodes in the coverage area. If we assume p(rd) =
1, it means target distance µ in (4) has no distance constraint
and all nodes in the coverage area can communicate directly
on same channel as used by the cellular user. In this case, the
lower bound on average coverage probability of cellular user
is given as:

e

pc
cov,lb =

−π2R2 λ

2 q γpi

pc − 1

−π2R2λ

2 q γpi

pc

,

(17)

IV. NUMERICAL RESULTS

In this section, we numerically evaluate the analytic expres-
sions of Sec. III by varying the number of different parameters
for a ﬁxed cell of radius R = 500m and a radius of protection
region R0 = 1m. The cell-edge effect is simulated by dropping
D2D users around cell boundary. The D2D pairs are chosen
on reduced path-loss (shortest distance) criterion which is
captured analytically by thinning the Poisson point process
using retention probability (4). The power ratio of cellular user
and D2D transmitter is assumed to be 500 with pc = 100mW
and pi = 0.2mW. In order to calculate the average effect of
coverage probability, 3000 monte-carlo simulations are run.

(8)

(9)

(10)

y
t
i
l
i

b
a
b
o
r
P
e
g
a
r
e
v
o
C

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 
−5

0

5

10

15

20

SIR threshold, γ(dB)

Fig. 4: Coverage probability of cellular user for pi = 0.2mW, pc =100mW,
R0 = 1m, rd ≤ 50m, and µ = 50m.

The average coverage probability of cellular user in (16)
depends on D2D user density λ, D2D transmit power pi
and the transmit power of cellular user pc. For a maximum
target distance of µ = 50m, many nodes meet distance
criterion, however, the pair with meets shortest distance cri-
terion (rd ≪ µ) is chosen for D2D communication. For
such a scenario, it is reasonable to assume same transmit
power for every D2D pair in the coverage area. To analyze
the gain due to introducing retention probability, the average
coverage probability of cellular user has been compared with
the lower bound (conventional modeling) in Fig. 4. In this
ﬁgure, coverage gain can be observed for a cellular user. For
example, for λ = 0.00005, target SIR of γ = -5(dB) results in
average coverage gain of around 27.7% whereas γ = 20(dB)
results in coverage gain of around 19.8%. For higher values
of λ and lower γ, the coverage drop is insigniﬁcant unlike
higher values of γ which scales the effect of interference
more signiﬁcantly. For example, λ = 0.000075 and γ = 20(dB)
results in coverage gain of only 8.7%.

In Fig. 5, the average coverage probability of cellular user
for γ = 0(dB) and variable D2D density has been plotted. The
coverage drop due to increased number of D2D pairs meets
the intuition i.e., for higher value of λ, more D2D pairs can
be made which means higher SN effect and reduced average
coverage probability. Another effect can be seen in case of
thinning where higher values of λ results in divergence from
the analytic expression as mentioned in Sec. III. In case of
no-thinning, every D2D pair act as an interferer resulting in
close match between analytic expression and simulation setup.

V. CONCLUSIONS

In this paper, we introduce retention probability in Laplace
functional of MPPP as the selection criterion for D2D pairing.
Based on reduced path-loss and shortest distance between D2D

 

pairs, the average coverage probability of cellular user has
 

1

4

λ = 0.000050 (Precise Modeling)
Simulation
λ = 0.000050 (Lower Bound)
Simulation

y
t
i
l
i

b
a
b
o
r
P
e
g
a
r
e
v
o
C

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0
 

Thinning of MPPP(Analytical)
(Simulation)
No Thinning of MPPP(Analytical)
(Simulation)

0.5

1

1.5

2

2.5

D2D user density, λ

3
x 10−4

Fig. 5: Coverage probability of cellular user for variable D2D density λ,
rd ≤50m, and µ = 50m.

been analytically and numerically evaluated. The simulation
results veriﬁed the closed-form approximations for different
values of λ. The D2D user density and corresponding number
of D2D pairs can be selected by maintaining the average cov-
erage probability of cellular user. A lower bound on average
coverage probability of cellular user has also been introduced
where no retention probability is considered and every node
is assumed to be in D2D pair. This lower bound corresponds
to the conventional coverage probability of a cellular user.

REFERENCES

[1] X. Xu,

J.

Sun,

“Transmission
Capacity Of D2D Communication Under Cellular
Networks.” Atlantis Press, 2013. [Online]. Available:
http://www.atlantis-press.com/php/paper-details.php?id=6550

Shao,

and

S.

[2] A. Sakr

and E. Hossain,

“Cognitive and Energy
Harvesting-Based D2D Communication in Cellular Net-
works: Stochastic Geometry Modeling and Analysis,”
IEEE Trans. Wireless Commun., vol. 63, no. 5, pp. 1867–
1880, May 2015.

[3] N. Lee, X. Lin, J. Andrews, and R. Heath, “Power
Control for D2D Underlaid Cellular Networks: Modeling,
Algorithms, and Analysis,” IEEE J. Sel. Areas Commun.,
vol. 33, no. 1, pp. 1–13, Jan 2015.

[4] Z. Liu, H. Chen, T. Peng, and W. Wang, “Optimal
density and power allocation of D2D communication
under heterogeneous networks on multi-bands with outage
constraints,” in International Conference on Computing,
Networking and Communications (ICNC), Jan 2013, pp.
1179–1183.

[5] B. Blaszczyszyn, Stochastic Geometry and Wireless Net-

works, Part I: Theory. Now Publishers Inc.

[6] X. Lin, J. Andrews, and A. Ghosh, “Spectrum Sharing for
Device-to-Device Communication in Cellular Networks,”
IEEE Trans. Wireless Commun., vol. 13, no. 12, pp. 6727–
6740, Dec 2014.

