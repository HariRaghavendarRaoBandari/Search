TIME AND DIRECTION OF ARRIVAL DETECTION AND
FILTERING FOR IMAGING IN STRONGLY SCATTERING

RANDOM MEDIA

L. BORCEA ∗, G. PAPANICOLAOU † AND C. TSOGKA ‡

Abstract. We study detection and imaging of small reﬂectors in heavy clutter, using an array
of transducers that emits and receives sound waves. Heavy clutter means that multiple scattering of
the waves in the heterogeneous host medium is strong and overwhelms the arrivals from the small
reﬂectors. Building on the adaptive time-frequency ﬁlter of [15], we propose a robust method for
detecting the direction of arrival of the direct echoes from the small reﬂectors, and suppressing the
unwanted clutter backscatter. This improves the resolution of imaging. We illustrate the performance
of the method with realistic numerical simulations in a non-destructive testing setup.

Key words. array imaging, random media, time-frequency analysis, direction of arrival, data

ﬁltering.

1. Introduction. We study detection and imaging of remote small reﬂectors in
a strongly scattering medium, aka heavy clutter, using an array of N transducers that
emit and receive sound waves. This is a diﬃcult inverse problem because the echoes
arriving directly from the reﬂectors are weak by the time they reach the array and are
overwhelmed by the waves multiply scattered in clutter. We call these waves clutter
backscatter and note that they arrive at the array long before and after the direct
echoes.

The array probes sequentially the medium with pulses emitted from one trans-
ducer at a time, and records the resulting acoustic pressure waves at all the N trans-
ducers. These recordings form the N × N array response matrix P (t), which is a
function of time t. The detection problem is to distinguish in P (t), which is domi-
nated by clutter backscatter, the time and direction of arrival of the weak echoes from
the small reﬂectors. For imaging we need to extract these echoes from P (t), and use
them to localize the reﬂectors.

Heavy clutter arises in applications of imaging through foliage or the turbulent
atmosphere, in nondestructive testing of materials, and so on. It has received much
attention lately, specially in the context of imaging with passive arrays of receivers
which are either near the imaging region or are separated from it by a non scattering
medium [18]. In these problems the waves emitted from remote sources travel through
clutter before reaching the receivers and the small reﬂectors. Due to the favorable
placement of the receivers, the clutter eﬀects can be suppressed by computing the
cross-correlations of the recordings and using appropriate time windowing [5, 18]. The

6
1
0
2

 
r
a

 

M
6
1

 
 
]
h
p
-
p
m
o
c
.
s
c
i
s
y
h
p
[
 
 

1
v
3
2
2
5
0

.

3
0
6
1
:
v
i
X
r
a

∗Department of Mathematics, University of Michigan, Ann Arbor, MI 48109 (borcea@umich.edu)
†Mathematics Department,
(papanico-

Stanford, CA 94305.

Stanford University,

laou@stanford.edu)

‡Mathematics and Applied Mathematics, University of Crete and IACM/FORTH, GR-71409

Heraklion, Greece. (tsogka@uoc.gr)

1

images formed with such cross-correlations are as good as if there were no clutter, as
shown with analysis and numerical simulations in [18].

In many applications it is not possible to place receiver arrays near the imaging
region, or behind the heavy clutter. For example, in nondestructive testing, the
measurements are necessarily conﬁned to the surface of the tested body, and the
small reﬂectors (defects) are buried deep inside, as we assume in this paper. The
suppression of clutter backscatter is much more challenging in this case, and requires
carefully designed data ﬁlters.

A ﬁlter of waves backscattered by a randomly layered medium was proposed and
It is eﬃcient, but since it relies on the layered structure it does
studied in [11].
not generalize to other clutter. The ﬁlter in [3, 4, 2] seeks to separate single from
multiple scattering waves by performing a rotation of the response matrix followed by
a projection. It uses that when the array aperture is small with respect to the distance
to the small reﬂectors, the single scattering part of P (t) i.e., the direct arrivals from
the small reﬂectors, is approximately a Hankel matrix. After the rotation, which
involves discarding a large part of P (t), the ﬁltering is carried out by a projection
on the space of certain rank one matrices. The detection method in [3, 4, 2] requires
measurements of the response matrix from a part of the medium that does not contain
the small reﬂectors.

The detection and ﬁltering method proposed in this paper is an extension of that
in [15]. It analyzes the response matrix P (t) in sequentially reﬁned time windows,
using the singular value decomposition (SVD) of the local-cosine transform (LCT)
of P (t). The point is that in time windows that contain only clutter backscatter,
P (t) resolved over frequencies is a ”noise” matrix∗.
Its SVD analysis reveals that
the larger singular values are clustered together, and have similar behavior across
frequencies. In the windows that contain echoes from the small scatterers, P (t) is a
perturbation of a noise matrix, and detection can be carried out by seeking singular
values that are signiﬁcantly larger than the others across frequencies. The success
of the detection depends on the strength of the perturbation relative to noise. This
improves as we reﬁne the time windows. However, there is a trade-oﬀ. If the windows
are too small, they cannot capture the arrival of the echoes from the small reﬂectors
at all the receivers in the array. The arrival times vary across the array, and the
window selection must take this into account. The adaptive time-frequency algorithm
in [15] is designed to address this trade-oﬀ.

An analysis of the adaptive time-frequency algorithm in [15] was carried out in [1]
in the case of randomly layered media, but the method applies to general clutter. Here
we extend the algorithm so that it also selects the direction of arrival of the echoes
from the small reﬂectors. This leads to improved data ﬁltering and better resolution
of the images obtained with any coherent method. We illustrate this using both the
coherent interferometric imaging method [13, 14, 12] and the Kirchhoﬀ migration

∗The quote stands for the fact that clutter backscatter does not give a usual noise matrix with

identically distributed and uncorrelated entries, such as Gaussian.

2

method [9, 10].

The paper is organized as follows: In section 2 we formulate the problem.

In
section 3 we illustrate with numerical simulations the diﬃculty of imaging in heavy
clutter. In section 4 we present our detection and imaging algorithm. We review its
ﬁrst step from [15] in section 4.1, and describe in detail the new step for direction
of arrival detection and ﬁltering in section 4.2. The performance of the algorithm is
illustrated in section 5 using numerical simulations carried out in a setup relevant to
non-destructive testing. We end with a summary in section 6

2. Formulation of the problem. The array gathers the response matrix P (t)
with entries P (t, (cid:126)xr, (cid:126)xs) by emitting pulses f (t) from (cid:126)xs for s = 1, . . . , N , and record-
ing the scattered waves at the receiver locations (cid:126)xr for r = 1, . . . , N . The measure-
ments are modeled by the solution of the wave equation

1

∂2P (t, (cid:126)x, (cid:126)xs)

v2((cid:126)x)

∂t2

− ∆P (t, (cid:126)x, (cid:126)xs) = f (t)δ((cid:126)x − (cid:126)xs),

(cid:126)x = (x, z) ∈ Rd, (2.1)

for d ≥ 2 and time t > 0, with initial conditions

P (0, (cid:126)x) = 0,

∂P (0, (cid:126)x)

∂t

= 0.

(2.2)

Here we introduced the system of coordinates with range axis z in the direction of
propagation of the waves, pointing from the array to the reﬂectors that we wish to
image, and cross-range x in the plane Rd−1 orthogonal to it.

We model the emitted pulse as

where ωo is the carrier frequency and fB is a function with Fourier transform (cid:98)fB

supported in the interval (−πB, πB), where B is the bandwidth. Then,

f (t) = e−iωotfB(t),

(cid:98)f (ω) =

(cid:90) ∞

−∞

ei(ω−ωo)tfB(t)dt = (cid:98)fB(ω − ωo),

(2.3)

is supported at frequencies ω ∈ (ωo − πB, ωo + πB).

If the small reﬂectors are penetrable inclusions, we can model them and the clutter

by v((cid:126)x) in (2.1), satisfying

1

v2((cid:126)x)

=

1
c2 [1 + εµ((cid:126)x) + ρ((cid:126)x)] .

(2.4)

Here c is the constant reference speed and ρ((cid:126)x) is the reﬂectivity of the inclusions,
supported in the union of the disjoint domains Ωm, centered at points (cid:126)ym, for m =
1, . . . , M . The inclusions are round and small, meaning that their volumes |Ωm| satisfy
|Ωm|1/d < λo, where λo = 2πc/ωo is the central wavelength. However, they have a
much larger reﬂectivity than the heterogeneities in the cluttered medium. This is why
we can hope to image them.

3

If the small reﬂectors are impenetrable, they are modeled with boundary condi-

tions at ∂Ωm. In the simulations they are soft scatterers, so

P (t, (cid:126)x, (cid:126)xs) = 0,

(cid:126)x ∈ ∂Ωm, m = 1, . . . , M,

and the wave speed v((cid:126)x) satisﬁes

1

v2((cid:126)x)

=

1
c2 [1 + εµ((cid:126)x)] .

(2.5)

(2.6)

The clutter is a conglomerate of small and weak heterogeneities, which are impos-
sible to know in detail. They introduce uncertainty in the wave propagation model
which translates into uncertainty of the waves measured at the array. This impedes
the imaging process. We model the uncertainty of v((cid:126)x) with the mean zero random
process µ, which is assumed statistically homogeneous, bounded almost surely, with
integrable autocorrelation

C((cid:126)x) = E[µ((cid:126)x + (cid:126)x(cid:48))µ((cid:126)x(cid:48))],

where E denotes expectation. We normalize the process by C(0) = 1, so ε (cid:28) 1 scales
the small amplitude of the ﬂuctuations.

In imaging we probe a single heterogeneous medium, corresponding to one real-
ization of the process µ. Any heterogeneity in this medium is a weak scatterer when
compared with the reﬂectors that we wish to image, as modeled by ε (cid:28) 1. However,
there are many heterogeneities and their cumulative scattering eﬀects add up over
long distances of propagation of the waves. This cumulative scattering is responsible
for the strong reverberations registered at the array, the heavy clutter backscatter.

The detection problem seeks to identify the time and direction of arrival of the
single scattered waves at the reﬂector locations (cid:126)ym, for m = 1, . . . , M . The goal of
ﬁltering is to suppress the heavy clutter backscatter and emphasize these direct ar-
rivals, so that better estimates of {(cid:126)ym}1≤m≤M can be obtained with coherent imaging
methods such as coherent interferometry (CINT) [14, 12] or Kirchhoﬀ migration (KM)
[9, 10].

The KM imaging function is

J KM((cid:126)y) =

=

N(cid:88)
N(cid:88)

r=1

N(cid:88)
N(cid:88)

s=1

(cid:90) ∞

r=1

s=1

−∞

dω
2π

P (τ ((cid:126)xs, (cid:126)y) + τ ((cid:126)y, (cid:126)xr), (cid:126)xr, (cid:126)xs)

(cid:98)P (ω, (cid:126)xr, (cid:126)xs) exp{−iω [τ ((cid:126)xs, (cid:126)y) + τ ((cid:126)y, (cid:126)xr)]},

(2.7)

where (cid:126)y are the search points in the imaging region. It adds the entries of the response
matrix delayed by the travel time from the sources to the imaging point and then back
to the receivers. The travel times are calculated in the reference medium, at wave
speed c,

τ ((cid:126)x, (cid:126)y) = |(cid:126)x − (cid:126)y|/c,

4

(2.8)

and the evaluation of P (t, (cid:126)xr, (cid:126)xs) at the round trip travel time τ ((cid:126)xs, (cid:126)y) + τ ((cid:126)y, (cid:126)xr) is
called backpropagation to (cid:126)y. The estimates of the reﬂector locations are the peaks
of J KM((cid:126)y). The direct arrivals from the reﬂectors add constructively at points (cid:126)y ∈
{(cid:126)y1, . . . , (cid:126)yM}, and the KM imaging method works well when the clutter backscatter
is weak.

(cid:88)

(cid:88)

(cid:98)P (ω, (cid:126)xr, (cid:126)xs)(cid:98)P (ω(cid:48), (cid:126)xr(cid:48), (cid:126)xs(cid:48))

−∞
exp{−iω[τ ((cid:126)xr, (cid:126)y) + τ ((cid:126)y, (cid:126)xs)] + iω(cid:48)[τ ((cid:126)xr(cid:48), (cid:126)y) + τ ((cid:126)y, (cid:126)xs(cid:48)]} .

s,s(cid:48)∈Sd(ω+ω(cid:48))

r,r(cid:48)∈Sd(ω+ω(cid:48))

(2.9)

The CINT imaging function is given by

(cid:90) ∞

J CINT((cid:126)y) =

dω
2π

dω(cid:48)
2π
|ω−ω(cid:48)|≤Ωd

(cid:90)

(cid:26)

It also uses backpropagation to (cid:126)y via travel time delays, but it does not sum directly
the measurements.
It sums their local cross-correlations, calculated at nearby fre-
quencies ω and ω(cid:48) satisfying |ω − ω(cid:48)| ≤ Ωd, and at nearby sources and receivers, with
indexes in the frequency dependent sets

S (ω + ω(cid:48)) =

r, r(cid:48) = 1, . . . , N,

|(cid:126)xr − (cid:126)xr(cid:48)| ≤ Xd

(cid:18) ω + ω(cid:48)

(cid:19)(cid:27)

.

2

Here Ωd and Xd are the decoherence frequency and length. They deﬁne the frequency
and sensor location oﬀsets over which the waves scattered in clutter decorrelate sta-
tistically. They play an important role in the statistical stabilization of the CINT
imaging function, and can be obtained adaptively during the image formation as ex-
plained in detail in [14, 12, 16]. CINT can mitigate moderate clutter backscatter.
Explicitly, it can image at distances that do not exceed a few transport mean free
paths in the cluttered medium. In this paper we consider stronger clutter backscat-
ter, which cannot be handled by CINT alone, as shown with numerical simulations in
the next section.

(a) The imaging problem setup.

(b) Time traces

Fig. 3.1. (a) Two small, sound soft reﬂectors embedded in a strongly scattering medium. The
array is on the top. The velocity of the medium ﬂuctuates around the constant c = 1Km/s. The
ﬂuctuations are shown with colors. The horizontal axis is cross-range and the vertical axis is range,
in units of λo. (b) The display of P (t, (cid:126)xr, (cid:126)xs) as a function of time on the abscissa and xr on the
ordinate, for the source at (cid:126)xs = (44λo, 2λo).

5

xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4(cid:104)

(cid:18)

(cid:18)

(cid:16)

(cid:17)(cid:105)

(cid:19)

(cid:19)

3. Illustration of heavy clutter eﬀects on imaging. To illustrate how clut-
ter impedes imaging, we present here the results of a numerical simulation in two
dimensions, in the setup depicted on the left in Figure 3.1. There are two small re-
ﬂectors to image, shown with the black dots. They are modeled as sound soft disks
of radius λo/4, centered at (cid:126)y1 = (42λo, 75λo) and (cid:126)y2 = (52λo, 65λo). The array is
linear, and consists of N = 80 transducers. The range axis is orthogonal to it, and
points downward in the ﬁgure. The transducer locations are

(cid:126)xr = (xr, 2λo) ,

xr = 24λo + (r − 1)

λo
2

,

r = 1, . . . , 80,

so the array has aperture a ≈ 40λo, which is about half the range of the reﬂectors.

The clutter is a realization of

µ((cid:126)x) =

1√
2

µi((cid:126)x) + µl

z

,

(3.1)

where µi and µl are mean zero, statistically homogeneous random processes. The ﬁrst
models an isotropic random medium with autocorrelation

E[µi((cid:126)x)µi((cid:126)x(cid:48))] =

1 +

e− |(cid:126)x−(cid:126)x(cid:48)|

(cid:96)

,

(3.2)

|(cid:126)x − (cid:126)x(cid:48)|

(cid:96)

and correlation length (cid:96) = λo/4. The second models a randomly layered medium with
autocorrelation

E[µl(z)µl(z(cid:48))] =

|z − z(cid:48)|

(cid:96)z

1 +

− |z−z(cid:48)|
e

(cid:96)z

,

(3.3)

and correlation length (cid:96)z = λo/50. The amplitude scale of the ﬂuctuations µ((cid:126)x) is
ε = 0.1, and the actual wave speed v((cid:126)x) used in the simulation is shown with colors
in Figure 3.1.

The simulation parameters are typical for an ultrasonic non-destructive testing
experiment [3]. The array probes the medium with Ricker pulses, which are second
derivatives of a Gaussian, with central frequency ωo/(2π) = 10MHz and standard
deviation 10MHz. The reference velocity is c = 1Km/s, so λo = 0.1mm. All the
lengths in Figure 3.1 are scaled by λo.

The array response matrix P (t) is obtained by solving numerically the wave
equation (2.1) in R2, using the perfectly matched absorbing layer technique [8]. The
numerical method uses a ﬁnite element discretization in space of (2.1), written as a
ﬁrst order hyperbolic system [6, 7]. The discretization in time is with standard ﬁnite
diﬀerences.

We display on the right in Figure 3.1 the recordings P (t, (cid:126)xr, (cid:126)xs) for r = 1, . . . , 80
and s = 41. Borrowing terminology from the seismic literature, we call the recordings
time traces. The direct arrivals from the two sound soft disks are weak and cannot
be seen because they are dominated by the clutter backscattered waves, which arrive
before and after them.

6

(a) KM

(b) CINT

Fig. 3.2. Kirchhoﬀ migration (a) and CINT (b) images obtained for the data shown on Figure
3.1(b). The full array response matrix is used to obtain these images and not just the central
illumination data. The true location of the scatterers is shown with black circles.

The KM and CINT images are shown in Figure 3.2, where the two sound soft
reﬂectors are indicated with black circles. We note that both images have peaks near
the locations of the reﬂectors.
In particular, CINT produces a strong peak at the
reﬂector that is closer to the array. However, there are many other peaks, which
are stronger than the peak at the second reﬂector. The algorithm described in the
next section is designed to mitigate the clutter backscatter, and therefore improve the
quality of the images.

4. Detection and ﬁltering of clutter backscatter. Our method of detection
of the arrival of the weak echoes from the small reﬂectors, and of ﬁltering the unwanted
clutter backscatter, consists of two main parts, outlined here.

The ﬁrst part is as in [15], and we review it in section 4.1. It analyzes the re-
sponse matrix P (t) in sequentially reﬁned time windows using the discrete local cosine
transform (LCT). Time windowing is useful because over the entire duration of the
recordings the energy carried by the clutter backscatter (the ”noise”) overwhelms that
of the useful echoes (the ”signal”). As the time windows containing these echoes be-
come smaller and smaller, the signal to noise ratio (SNR) improves. The LCT allows
a systematic window reﬁnement and search, using a tree structure. It decomposes the
entries of P (t) over frequencies, locally in each window, and the detection is done by
tracking the behavior of the leading singular values of the transformed matrix. Data
ﬁltering consists of zeroing the LCT coeﬃcients in the windows where no signal is
detected, projecting on the subspace spanned by the singular vectors of the distin-
guished singular values, and then inverting the LCT transform. We call the ﬁltered
response matrix P

(t), where the index TF stands for time ﬁltering.

T F

The second part of the method is the main contribution of this paper, and is
described in section 4.2. It seeks to detect the direction of arrival of the desired echoes
from the small reﬂectors, in addition to the arrival time, and to improve the data ﬁlter
for better resolution of the images. To do so, we begin with the backpropagation of
(t) using travel time delays from the array transducers to a reference point in
P

T F

7

253035404550556050556065707580253035404550556050556065707580the imaging region. This reference point is at range equal to half the center time
of the selected time window, multiplied by the wave speed c. If more time windows
are selected, than the backpropagation is done for each of them. The purpose of the
backpropagation is to remove the large phase of the entries of P
(t), so that we can
better analyze the data around the detected arrival time.

T F

(t) and its Fourier transform (cid:98)P

BP

BP

BP

(ω).

We call the backpropagated matrix P

(ω). Its
entries are indexed by the receivers located at (cid:126)xr and sources at (cid:126)xs, and we rotate
it next by representing it in the center and diﬀerence coordinates ((cid:126)xs + (cid:126)xr)/2 and
(cid:126)xr − (cid:126)xs. The motivation for the rotation is similar to that in [3, 4, 2]. Assuming
that the array aperture is small with respect to the range of the reﬂectors, we may
use the paraxial approximation to model the direct arrivals from the small reﬂectors,
the useful (coherent) part of the data. After the backpropagation, this part is ap-
proximately independent of the diﬀerence (cid:126)xr − (cid:126)xs, which is why it is advantageous to

We denote the rotation by R, and to suppress the remaining clutter backscatter,
(ω) by a rank one matrix which is inde-
pendent of (cid:126)xr − (cid:126)xs. The approximation is with respect to the Frobenius norm, and

rotate (cid:98)P
we calculate the best approximation of R(cid:98)P
the result is denoted by R(cid:98)P
associated with the single scattered waves, we decompose R(cid:98)P

To determine the direction of arrival of the coherent echoes i.e., the wave vectors
(ω) in plane waves
using Fourier transforms. The detection amounts to seeking maxima of the Fourier
coeﬃcients (the plane wave amplitudes), and the ﬁltering is done by careful tapering
over the other directions. The output of the algorithm is the inverse Fourier transform
of the result, rotated back to the coordinates (cid:126)xr and (cid:126)xs. This is the ﬁltered data to
be used in the image formation.

(ω).

BP

AF

AF

4.1. Adaptive time-frequency detection and ﬁltering. We review here the
steps of the algorithm introduced in [15]. The input is the array response matrix
P (t), for time t ∈ [0, T ] sampled in uniform NT time steps, where NT equals an
integer power of 2. The LCT decomposition [19] is done in time windows arranged
in a binary tree structure. At each level l = 0, . . . , Nl, the recording window [To, T ]
is divided in 2l windows, of size ∆l = (T − To)/2l. The minimum size of the time
windows is determined by the user deﬁned maximum tree level Nl.

Let us index the nodes of the tree by (j, l), with j = 0, . . . , 2l−1 and l = 0, . . . , Nl.

Each node is associated with the subspace spanned by the orthonormal bases

(cid:40)(cid:114) 2

(cid:16) t − tl

j

(cid:17)

Bl

j =

χ

∆l

∆l

(cid:41)

cos[ωl

n(t − tl

j)], n ∈ Z+

,

(4.1)

with discrete times tl
position in the smooth windows χ. For any l, the union over j of the bases Bl
an orthonormal basis of L2[To, T ], and at the next tree level the span of Bl

n = π (n + 1/2)/∆l of the decom-
j forms
j is split in

j = To + j∆l and frequencies ωl

8

two orthogonal subspaces, with bases Bl+1

2j and Bl+1

2j+1. We refer to [19] for details†.

The steps of the time-frequency detection and ﬁtering algorithm are:

1. Computation of the discrete LCT transform of the array response matrix on

a binary tree with maximum level Nl. This gives the N × N matrices

j, ωl

n) =

(cid:98)P l(tl

(cid:110)(cid:98)P l(tl

(cid:111)
(cid:16) t − tl
2. Calculate the singular value decomposition of (cid:98)P l(tl

for j = 0, 1, . . . , 2l − 1 and l = 0, . . . , Nl, with entries

(cid:114) 2

(cid:98)P l(tl

dt P (t, (cid:126)xr, (cid:126)xs)

n, (cid:126)xr, (cid:126)xs) =

n, (cid:126)xr, (cid:126)xs)

j, ωl

j, ωl

(cid:90)

∆l

χ

∆l

(cid:17)

j

,

(4.2)

r,s=1,...,N

cos[ωl

n(t − tl

j)].

(4.3)

j, ωl

n). Let σl,j

q (ωl

n) be the

singular values, for q = 1, . . . N .

3. Choose the frequency band B ∈ (0, πNT /T ) and the number ¯q of largest sin-

gular values to be used in the detection.

4. Detect the time window of interest as follows:

For l = 0 : Nl

Decide if there is at least one window indexed by (j, l), where the largest
singular values are distinguished from the others across the frequencies
in B. If yes, let lo = l and jlo

(cid:63) = j and stop.

For l = l0 + 1 : Nl
(cid:63) + 1} and decide in which of the two windows the
Let j ∈ {2jl−1
largest singular values are better separated from the rest. Call the deci-
sion jl

(cid:63) = j. If the selection is ambiguous, set l = l − 1 and stop.

, 2jl−1

(cid:63)

5. Let the chosen time window be indexed by (jl

(cid:63), l). Set to zero the LCT coeﬃ-
cients in all other windows at level l. This is equivalent to multiplying (4.3)
with the Kronecker δj,jl

.

(cid:63)

6. Project δj,jl

n) on the subspace of low rank matrices with singular
vectors corresponding to the distinguished top singular values. The projection
is done for frequencies ωn ∈ B. All other coeﬃcients are set to zero.

j, ωl

(cid:63)(cid:98)P l(tl

7. The output of the algorithm is the ﬁltered response matrix P

T F

(t) obtained

with the inverse LCT of the entries of the matrix obtained at step (6).

Remarks. The number ¯q of singular values at step (3) should be larger than
the number M of reﬂectors that we wish to image. We also should have enough
measurements, meaning that N (cid:29) ¯q > M . The bandwidth B is the part of the
† In the simulations the basis (4.1) is discretized at the NT points t of the interval [To, T ], and
the frequencies ωl
n sample the same bandwidth (0, πNT /T ) , in steps π/∆l, that increase with the
tree level l. The implementation uses the Wavelab 850 MATLAB package [17] with window χ option
”Sine”.

9

frequency support of the probing pulse over which the reﬂectors are detectable. This
B depends on the clutter, but in general it is at the lower frequencies that the detection
is easier.

the clutter backscatter, so (cid:98)P 0(To, ω0

The details on how the algorithm searches for the distinguishable, leading singular
values are given in [15]. Note that at step (4) we search ﬁrst from the bottom to the
top of the tree. At the root level l = 0, the data is expected to be dominated by
n) are like noise matrices. This is illustrated in
Figure 5.8 and the numerical simulations in [15] by the fact that all singular values
σ0,0
q (ω0
n) are clustered together across the frequencies. There is no distinguished or
signiﬁcant singular value. When the window sizes become small enough, the SNR in
the windows that contain the useful echoes from the reﬂectors (the signal) improves,
and the largest singular values become well separated from the others. This is the
level lo at step (4). The second part of the search at step (4) reﬁnes sequentially the
windows of interest until the selection becomes ambiguous.

The ﬁlters at steps (5) and (6) are for suppressing the clutter backscatter. First,
they remove all the arrivals outside the selected time window and then, they project
the result on the subspace spanned by the singular vectors corresponding to the dis-
tinguishable singular values.

T F

4.2. Direction of arrival detection and ﬁltering. The ﬁltered array response
(t) given by the ﬁrst part of the algorithm is localized in a small time
matrix P
window which contains the echoes from the reﬂectors that we wish to image. Here
we explain how we can detect the direction of arrival of these echoes and how we can
improve the data ﬁltering.

a

θ

L

(cid:126)y = (y, L + η)

η

y

(cid:126)yo = (0, L)

Fig. 4.1. Illustration of an imaging setup with array aperture a that is small compared to the
range L. The reference point (cid:126)yo is determined from the center time of a selected window and is
along the range axis originating at the center of the array.

Suppose that a small reﬂector at (cid:126)y is detected in the selected time window cen-
tered at to.
Its distance to the center of the array, the origin of coordinates, is
approximately L = c/(2to), and we deﬁne the reference point (cid:126)yo = (0, L). As illus-
trated in Figure 4.1, (cid:126)yo is oﬀset from (cid:126)y by y in the cross-range plane and η in range,
meaning that (cid:126)y = (y, L + η).

The useful echoes for imaging, which are single scattered at (cid:126)y, have the determin-
istic phase k(|(cid:126)y − (cid:126)xs| + |(cid:126)y − (cid:126)xr|) for the source receiver pair (s, r), where k = ω/c is
the wavenumber. Assuming that the array is planar, with small aperture with respect

10

to the range L, we let (cid:126)xr = (xr, 0) and obtain with the paraxial approximation that

|(cid:126)y − (cid:126)xs| + |(cid:126)y − (cid:126)xr| =(cid:112)(L + η)2 + |xr − y|2 +(cid:112)(L + η)2 + |xs − y|2

≈ 2(L + η) +

|xr − y|2 + |xs − y|2
|¯xrs|2
|y2|
L
L

|(cid:101)xrs|2

4L

2L

+

− 2¯xrs · y

= 2(L + η) +

where ¯xrs = (xr + xs) and(cid:101)xrs = xr − xs. For the reference point (cid:126)yo we have similarly

|(cid:126)yo − (cid:126)xs| + |(cid:126)yo − (cid:126)xr| =(cid:112)L2 + |xr|2 +(cid:112)L2 + |xs|2

(4.4)

+

L

,

≈ 2L +

|¯xrs|2
L

|(cid:101)xrs|2

4L

,

(4.5)

(cid:19)

so when backpropagating the ﬁltered data P
reduction of the direct arrivals in the selected time window

T F

(t) to (cid:126)yo we achieve the following phase

k(|(cid:126)y − (cid:126)xs| + |(cid:126)y − (cid:126)xr| − |(cid:126)yo − (cid:126)xs| + |(cid:126)yo − (cid:126)xr|) ≈ k

− 2¯xrs · y
nates(cid:101)xrs leads to the detection and ﬁltering algorithm described below.

The observation that these reduced phases are independent of the diﬀerence coordi-

|y2|
L

.

(4.6)

2η +

L

The algorithm can be used for three dimensional problems, but to avoid cum-
bersome index notation we present it here in two dimensions, for a linear array. The
extension to three dimensions requires a modiﬁcation of the indexing in the rotation
operation at step (2) below. The steps of the algorithm are:

1. For the selected time window, centered at to, deﬁne the N × N input matrix

+

(cid:18)

IN

(t) = P

P

T F

(t − to),

(4.7)

(cid:90) ∞

(cid:90) ∞

(cid:98)P

and Fourier transform it with respect to time t,

eiω(t−to)P

T F

(t − to)dt.

(4.8)

IN

(ω, xr, xs), since for the linear array

IN

(ω) =

IN

eiωtP

(t)dt = eiωto

−∞

−∞

(cid:126)xr = (xr, 0), with r = 1, . . . , N .

Denote the entries of this matrix by (cid:98)P
Backpropagate (cid:98)P
by (cid:98)P
(cid:98)P

(ω), with entries deﬁned by

BP

BP

IN

(ω, xr, xs) = (cid:98)Po(ω, xr, xs)e−iωto−ik(|(cid:126)yo−(cid:126)xs|+|(cid:126)yo−(cid:126)xr|),

(ω) to the test point (cid:126)yo, and denote the resulting matrix

r, s = 1, . . . , N.

(4.9)

2. Rotate (cid:98)P

BP

(ω) by ninety degrees, to form a larger (2N − 1)× (2N − 1) matrix,

with entries indexed by the center and diﬀerence coordinates

¯xrs =

xr + xs

2

,

(cid:101)xrs = xr − xs.

The rotation is done with the following commands:

11

H = (cid:98)P

BP

(ω)

RH = zeros(2N − 1, 2N − 1)
For

i =1:N

For

j =1: N

i 1=i+j −1
i 2=i−j −(1−N)+1
RH( i 1 , i 2 )= H( j , i )

end

end

The rotated matrix has a rhombus structure as illustrated in Figure 4.2. The

diagonals in H, which correspond to constant source receiver oﬀsets(cid:101)xrs, form
midpoints ¯xrs, form the rows of RH. The resulting matrix is R(cid:98)P

the columns of RH. The anti-diagonals of H, which correspond to common

(ω).

BP

Fig. 4.2. Illustration of a square 4 × 4 matrix H on the left and its rotation RH on the right.

AF

3. We know from equation (4.6) that the desired, coherent part of the matrix
calculated at step (2) should be independent of the source receiver oﬀsets
(ω) by a matrix
(ω),
i.e., the non-zero elements of the rhombus. Let S be the set of indexes (i, j)
in this support, for i, j = 1, . . . , 2N − 1 enumerating the center and diﬀerence

(cid:101)xrs. Therefore, we calculate the best approximation of R(cid:98)P
R(cid:98)P
(ω) with identical columns (cid:98)p(ω), restricted to the support of R(cid:98)P
locations, renamed henceforth ¯xi and (cid:101)xj, and deﬁne the indicator function

BP

BP

1S (i, j) =

1,
0,

(i, j) ∈ S
otherwise

.

Then, (cid:98)p(ω) is the 2N − 1 column vector with entries p(ω, ¯xi) that minimize

(cid:40)

2N−1(cid:88)

1S (i, j)

We obtain that

(cid:98)p(ω, ¯xi) =

i,j=1

2N−1(cid:88)

j=1

R(cid:98)P

1
ni

BP

(cid:12)(cid:12)(cid:12)R(cid:98)P
(ω, ¯xi,(cid:101)xj), ni =

(cid:12)(cid:12)(cid:12)2
(ω, ¯xi,(cid:101)xj) −(cid:98)p(ω, ¯xi)
2N−1(cid:88)

BP

.

12

j=1

1S (i, j),

(4.10)

000000000000000000000000000000000where ni is is the number of non zero entries of the i−th row in the set S .

Here we used that R(cid:98)P
The approximation R(cid:98)P

BP

(ω) is supported in S .
(ω) is the matrix with entries

AF

R(cid:98)P

(ω, ¯xi,(cid:101)xj) = 1S (i, j)(cid:98)p(ω, ¯xi),

AF

i, j = 1, . . . , 2N − 1.

(4.11)

4. Take the Fourier transform of (4.10) with respect to ¯x. This is a plane wave
decomposition, with wave vector samples κi, the dual variable to ¯xi. The
transformed vector is

˘p(ω) = (˘p(ω, κi))i=1,...,2N−1 .

(4.12)

5. The detection of the direction of arrival of the direct echoes from the reﬂectors
amounts to seeking maxima of (4.12) that are above a user deﬁned tolerance.
If there is one dominant reﬂector for the selected time window, we expect
a single maximum, denoted by κ(cid:63)(ω). For multiple reﬂectors we may have
multiple maxima. If they are well separated, we use them one at a time.

6. To ﬁlter the residual unwanted clutter backscatter, we taper oﬀ the arrivals
from the directions that are diﬀerent than the selected κ(cid:63)(ω) at step (5). The
taper function is determined by the aperture a of the array, which deﬁnes the
resolution of order a/L in the plane wave decomposition.
In theory, the taper should be a sinc function, due to the support of the en-

tries of (cid:98)p(ω) in the interval [−a/2, a/2]. Since we are interested only in the

vicinity of the peak wave vector, we taper using a Gaussian centered at κ(cid:63)(ω),
with standard deviation β determined by minimizing the least squares error
between ˘p(ω, κi) and ˘p(ω, κi) exp[−(κi − κ(cid:63)
i )2/(2β2)] in the vicinity of κ(cid:63),
where ˘p(ω, κi) drops up to half of its peak value.
We denote the tapered vector by ˘p
tion of arrival. Its entries are deﬁned by

(ω), with index DoA standing for direc-

DoA

DoA

˘p

(ω, κi) = ˘p(ω, κi)e

− [κi−κ(cid:63) (ω)]2

2β2

,

i = 1, . . . , 2N − 1.

(4.13)

7. Compute the inverse Fourier transform (with respect to κ) of the tapered

vector (4.13). Its entries are

(cid:98)p

(ω, ¯xi) ∼(cid:98)p(ω, ¯xi) (cid:63)¯x eiκ(cid:63)(ω)¯xi− β2 ¯x2

2

i

,

DoA

where (cid:63)¯x denotes convolution and ∼ denotes equal, up to a multiplicative con-
stant. The phase in the right hand side of this equation carries the direction
of arrival selected at step (6).

8. Deﬁne the ﬁltered, rotated matrix R(cid:98)P

R(cid:98)P

(ω, ¯xi,(cid:101)xj) = 1S (i, j)(cid:98)p

DoA

13

DoA

(ω), with entries

DoA

(ω, ¯xi),

i, j = 1, . . . , 2N − 1.

(4.14)

Rotate it back to obtain the N×N matrix (cid:98)P
(cid:98)P

for r, s = 1, . . . , N .

DoA

9. Undo the back propagation at step (1), equation (4.9), by multiplying

(ω, xr, xs) with exp [iωto + ik(|(cid:126)yo − (cid:126)xs| + |(cid:126)yo − (cid:126)xr|)], for r, s = 1, . . . , N .

(ω) with entries (cid:98)P

DoA

DoA

(ω, xr, xs),

10. The output of the algorithm is the inverse Fourier transform in time of the

matrix calculated at step (9). We call it P

OU T

(t).

Remarks. Equation (4.6), which states that after the backpropagation the di-
rect echoes from the sought-after reﬂectors carry phases that are independent of the
source-receiver oﬀset location, is used by the algorithm in two ways: First, it rotates
at step (2) the backpropagated data matrix to the center and diﬀerence system of

coordinates ¯xi, and (cid:101)xj, and then approximates at step (3) the result by the closest
matrix with identical columns, independent of the oﬀset coordinates (cid:101)xj. Second, it

Fourier transforms the result with respect to the center coordinates ¯xi, to determine
at steps (4) and (5) the wave vector κ(cid:63)(ω) corresponding to the desired direct echoes.
Equation (4.6) says that this should be approximately κ(cid:63)(ω) ≈ 2ky/L. The algorithm
then suppresses the returns with wave vectors away from κ(cid:63)(ω) at step (6). The
remaining steps (7)-(9) undo the rotation and the Fourier transform to return to the
source-receiver coordinates and the time domain in which the array response matrix
is represented.

As stated before, the algorithm applies to three dimensions, with the only diﬀer-
ence being in the indexing in the rotation operation at step (2), and the search for
the direction of arrival at step (5) in two dimensions instead of one.

5. Numerical simulations. We begin in section 5.1 with the illustration of
the direction of arrival detection and ﬁltering algorithm, for the setup considered in
section 3. Then we present in section 5.2 imaging results for two nearby reﬂectors in
three location arrangements and three diﬀerent types of clutter.

Fig. 5.1. From left to right: the real part of (cid:98)P
(ω) and the ﬁltered matrix (cid:98)P

OU T

(cid:98)P

AF

BP

(ω), its approximation by the Hankel matrix
(ω). The axes are the indexes of the transducers and ω/(2π) =

5MHz.

5.1. Illustration of direction of arrival detection and ﬁltering. The nu-
merical simulations in this section are for the setup illustrated in Figure 3.1 and
described in detail in section 3. We focus attention on the reﬂector that is closer

14

ji  10203040506070801020304050607080−40−200204060ji  10203040506070801020304050607080−800−600−400−2000200400600ji  10203040506070801020304050607080−400−300−200−1000100200300400to the array, and illustrate how the algorithm introduced in section 4.2 detects the
arrival of the direct echoes from it and removes the clutter backscatter.

Since there are N = 80 transducers in the simulation, the array response matrix
P (t) is of size 80 × 80, and the time recordings are NT = 213 for the duration
T − To = 13.7748µs. We start the recordings at time To = 6.2252µs and end them at
time T = 20µs. The selection of the time window containing the arrival of the direct
echoes is done as explained in section 4.1 and described in detail in [15]. It identiﬁes
the window at the level l = 4 of the LCT tree, indexed by j4
(cid:63) = 7, and centered at
time

to = To + (j4

(cid:63) + 1/2)∆4, ∆4 = (T − To)/24.

IN

The direction of arrival detection and ﬁltering begins with the matrix P

5.1 the real part of the resulting matrix (cid:98)P
the middle plot we display its approximation (cid:98)P
display the ﬁltered matrix (cid:98)P

(t) de-
ﬁned in equation (4.8). We Fourier transform it and backpropagate it to the reference
point (cid:126)yo = (0, c/(2to)) using equation (4.9), and display in the left plot of Figure
(ω), at frequency ω/(2π) = 5MHz. In
(ω) obtained by rotating the matrix
deﬁned in equation (4.11) to the system of coordinates corresponding to the source
and receiver locations. This is a Hankel matrix by construction. In the right plot we
(ω), the Fourier transform of the output matrix at
step (9) of the algorithm. We compare it in Figure 5.2 with the ideal array response
matrix in the homogeneous medium, which has rank one and entries

OU T

BP

AF

(cid:98)P

HOM

(ω, (cid:126)xr, (cid:126)xs) =

eik(|(cid:126)xr−(cid:126)y)+|(cid:126)xs−(cid:126)y|)
16π2|(cid:126)xr − (cid:126)y||(cid:126)xs − (cid:126)y| .

the right plot of Figure 5.2 we display the rank one approximation of (cid:98)P
matrix with the leading left and right singular vectors and singular value of (cid:98)P

We note that the matrices are quite close, so the ﬁltering algorithm works well. In
(ω), the
OU T
(ω).
The improvement is slight, and has little eﬀect on the images displayed in Figure 5.3.
Comparing these images with those in Figure 3.2 we note the dramatic improvement
brought by the ﬁltering algorithm.

OU T

Fig. 5.2. From left to right: the real part of the ideal response matrix (cid:98)P

geneous medium, the ﬁltered matrix (cid:98)P

(ω) in the homo-
(ω), and its rank one approximation. The axes are the

HOM

OU T

indexes of the transducers and ω/(2π) = 5MHz.

15

ij  10203040506070801020304050607080−0.8−0.6−0.4−0.200.20.40.60.8ji  10203040506070801020304050607080−400−300−200−1000100200300400ji  10203040506070801020304050607080−400−300−200−1000100200300400Fig. 5.3. Kirchhoﬀ migration images formed with the ﬁltered data matrix P

(t) (left) and
the inverse Fourier transform of its rank one approximation (right). They are almost the same.
The abscissa is cross-range in units of λo and the ordinate is range in units of λo.

OU T

Fig. 5.4. We display the absolute value of the entries of ˘p(ω) deﬁned in equation (4.12) (blue
line) and the Gaussian taper in green. The points used to determine the least squares ﬁt by the
Gaussian at step (6) are shown with green stars. The abscissa is scaled by the wavenumber k so the
peak corresponds to 2y/L.

To illustrate the use of the rotation and approximation at step (3) of the algorithm,
equation (4.10) in particular, we plot in Figure 5.4 the entries of the vector ˘p(ω) as a
function of κ. We note that there is a clear peak, corresponding to the arrival of the
coherent echoes from the reﬂector at (cid:126)y, that is ﬁtted with the Gaussian taper shown
in green.

5.2. Imaging two reﬂectors in diﬀerent geometrical conﬁgurations and
types of clutter. We assess in this section the performance of the direction of arrival
ﬁltering algorithm for diﬀerent geometric conﬁgurations of two reﬂectors and diﬀerent
cluttered media, as illustrated in Figures 5.5 and 5.6. We begin with the numerical
setup in section 5.2 and then we show the results in the following sections.

16

2530354045505560505560657075803040506050556065707580−3−2−1012300.10.20.30.40.50.60.70.80.91Fig. 5.5. Combined cluttered medium modeled by the process µ in equation (3.1). Three con-

ﬁgurations of two reﬂectors. We call them conﬁgurations 1, 2 and 3 from left to right.

Fig. 5.6. The third conﬁguration of reﬂectors in three diﬀerent cluttered media. Isotropic on

the left, layered in the middle and combined on the right.

5.2.1. Description of the numerical setup. We consider three geometrical
arrangements of two reﬂectors which are oﬀset either in range, in cross-range or both
directions, as illustrated in Figure 5.5. The reﬂectors are sound soft disks of radius
λo/4, located at (cid:126)y1 = (37λo, 65λo), (cid:126)y2 = (37λo, 72λo) for conﬁguration 1, at (cid:126)y1 =
(42λo, 75λo), (cid:126)y2 = (52λo, 75λo) for conﬁguration 2, and at (cid:126)y1 = (42λo, 75λo), (cid:126)y2 =
(52λo, 65λo) for the third conﬁguration.

We test the direction of arrival ﬁltering algorithm in three diﬀerent types of clutter
modeled by the isotropic random process µi in equation (3.2), the layered one µl in
equation (3.3), and the combined µ in equation (3.1). In all cases, the smooth part
of the speed is constant c = 1km/s, and the ﬂuctuations are generated with random
Fourier series. In the isotropic medium the standard deviation of the ﬂuctuations is
ε = 0.1 and the correlation length is (cid:96) = λo/4. For the layered medium ε = 0.17 and
(cid:96) = λo/50. For the combined medium (3.1) the standard deviation is ε = 0.1. We
display in Figure 5.6 the realizations of the wave speed used in the simulations.

The array is linear, as described in section 3, and gathers the response matrix
by probing the medium with one source at a time, emitting the same Ricker pulse.
The receivers record the echoes in the time window [To, T ] with To = 6.2252µs and
T = 20µs. The time discretization is with NT = 213 steps.

5.2.2. Imaging results for the three reﬂector conﬁgurations. We present
here imaging results in the clutter modeled by the process µ in equation (3.1), for the
three geometric arrangements of the reﬂectors. We begin with Figure 5.7, where we

17

xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4arrayxz  01020304050607080010203040506070800.750.80.850.90.9511.051.11.151.21.25xzarray  01020304050607080010203040506070800.60.70.80.911.11.21.31.4display the KM images formed with the unﬁltered response matrix P (t). Due to the
strong clutter, the images are noisy and diﬃcult to interpret. Repeated simulations,
in diﬀerent realizations of µ, also show that the images change dramatically, and
unpredictably. We do not show the CINT images because they are also not useful in
this strong clutter, as illustrated in Figure 3.2.

Fig. 5.7. KM images for the three conﬁgurations and clutter shown in Figure 5.5. The images
are formed with the unﬁltered response matrix P (t). The abscissa is cross-range in units of λo and
the ordinate is range in units of λo. The reﬂectors are indicated with the black circles.

The ﬁrst part of the ﬁltering algorithm selects the time windows that contain the
direct arrivals from the reﬂectors, at level l = 4 in the LCT tree. They are indexed by
j4
(cid:63) = 7 and j4
(cid:63) = 9 in conﬁguration 2, where
a single window is selected. This is because in the second conﬁguration the reﬂectors
are at the same range location.

(cid:63) = 9 in conﬁgurations 1 and 3 and by j4

(cid:63) = 9 and j4

To illustrate the beneﬁt of time windowing, we plot in Figure 5.8 the singular
values of the array response matrix for the second conﬁguration, at level 0 of the LCT
tree, and then at level 4 for windows j4
(cid:63) = 15. The ﬁrst window is selected
by the algorithm as containing echoes from a reﬂector, and the second contains just
clutter backscatter. We note that it is more diﬃcult to distinguish the singular values
at the root level, because they are clustered together. In the selected time window
there is a clear separation of the larger singular values, signaling the arrival of the
coherent echoes. In the last window, containing the clutter backscatter, the singular
values are smaller and clustered together.

18

253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580j0
(cid:63) = 1

j4
(cid:63) = 9

j4
(cid:63) = 15

Fig. 5.8. The singular values of the array response matrix as a function of frequency for
conﬁguration 2 in the combined medium. The left plot is at root level l = 0 of the LCT tree i.e., for
the entire duration of the recordings. The other plots are at the level l = 4 of the tree, corresponding
to 24 time windows in the recording interval. The middle plot is for the selected window indexed by
j4
(cid:63) = 9 which contains direct echoes from one of the reﬂectors. The right plot is for the unselected
window indexed by j4
(cid:63) = 15 which contains only clutter backscatter. The plots are normalized by
dividing the singular values at each tree level l by the maximum one over all windows and frequencies
at level l.

IN

OU T

The input matrix P

(t) of the detection of the direction of arrival and ﬁlter-
ing algorithm introduced in section 4.2 is calculated using equation (4.7), for each
(cid:63) + 1/2)∆4, with ∆4 = (T − To)/24. The
selected window centered at to = To + (j4
images displayed below are formed with the ﬁltered matrix P
(t), the output of the
algorithm. The direction of arrival selection at step (5) is as easy as in Figure 5.4 in
conﬁgurations 1 and 3, because the selected time windows contain the direct echoes
form a single reﬂector. In the second conﬁguration the echoes from both reﬂectors
arrive in the selected window, and the plot of the vector ˘b(ω) calculated at step (4)
is shown in Figure 5.9. There are two peaks, corresponding to the direction of each
reﬂector.

Fig. 5.9. Absolute value of the entries of ˘p(ω) deﬁned in equation (4.12) (blue line) and
the Gaussian tapers in green and pink. The points used to determine the least squares ﬁt by the
Gaussian at step (6) of the algorithm are shown with green and pink stars. The abscissa is scaled
by the wavenumber k.

19

05101520253000.10.20.30.40.50.60.70.80.9105101520253000.10.20.30.40.50.60.70.80.9105101520253000.10.20.30.40.50.60.70.80.91−3−2−1012300.10.20.30.40.50.60.70.80.91Fig. 5.10. Imaging results for conﬁguration 1 and the clutter shown in Figure 5.5. Top row the
images obtained with the data in the ﬁrst selected time window and bottom row in the second selected
(t). Center column: KM images formed
time window. Left column: KM images formed with P
with P
(t). The abscissa is cross-range in
units of λo and the ordinate is range in units of λo.

(t). Right column: CINT images formed with P

OU T

OU T

IN

Fig. 5.11. Imaging results for conﬁguration 3 and the clutter shown in Figure 5.5. Top row the
images obtained with the data in the ﬁrst selected time window and bottom row in the second selected
(t). Center column: KM images formed
time window. Left column: KM images formed with P
with P
(t). The abscissa is cross-range in
units of λo and the ordinate is range in units of λo.

(t). Right column: CINT images formed with P

OU T

OU T

IN

The imaging results for conﬁgurations 1 and 3 are shown in Figures 5.10 and
5.11, and are a signiﬁcant improvement over those in Figure 5.7. Because the direct
echoes from the reﬂectors are well separated in time and are captured in two diﬀerent
windows, we image one reﬂector at a time. The images are good even before the

20

253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580253035404550556050556065707580ﬁltering over the direction of arrival, but this ﬁltering sharpens the focusing of the
images, specially in the third conﬁguration.

The direction of arrival ﬁltering is important in the second conﬁguration, where
the echoes from both reﬂectors arrive in the same time window. Without it, only one
reﬂector can be seen in the left image in Figure 5.12. The CINT method performs
better than KM, as it mitigates the reverberations between the reﬂectors and the
medium in their vicinity, as seen in the plots in the second row of the ﬁgure.

Fig. 5.12. Imaging results for conﬁguration 2 and the clutter shown in Figure 5.5. There is
a single selected time window containing the echoes from both reﬂectors. Left column: KM image
formed with P
(t). Top row middle and right column: KM images formed with the ﬁltered matrices
P
(t) for the two selected arrival directions in Figure 5.9. Bottom row: CINT images formed
with P
(t) for the two selected arrival directions. The abscissa is cross-range in units of λo and
the ordinate is range in units of λo.

OU T

IN

OU T

21

25303540455055605055606570758025303540455055605055606570758025303540455055605055606570758030405060505560657075803040506050556065707580IN

OU T

Fig. 5.13. Imaging results for conﬁguration 2 in the layered clutter. Left column: KM image
(t). Top row middle and right column: KM images formed with the ﬁltered matrices
formed with P
P
(t)
for the two selected arrival directions. The abscissa is cross-range in units of λo and the ordinate
is range in units of λo.

(t) for the two selected arrival directions. Bottom row: CINT images formed with P

OU T

IN

OU T

Fig. 5.14. Imaging results for conﬁguration 2 in the isotropic clutter. Left column: KM image
(t). Top row middle and right column: KM images formed with the ﬁltered matrices
formed with P
P
(t)
for the two selected arrival directions. The abscissa is cross-range in units of λo and the ordinate
is range in units of λo.

(t) for the two selected arrival directions. Bottom row: CINT images formed with P

OU T

5.2.3. Imaging results for diﬀerent types of clutter. We display in Figures
5.13 and 5.14 the images of the two reﬂectors in the more diﬃcult conﬁguration 2,
in layered and isotropic clutter, respectively. These complement the images in Figure

22

25303540455055605055606570758030405060505560657075803040506050556065707580304050605055606570758030405060505560657075802530354045505560505560657075802530354045505560505560657075802530354045505560505560657075802530354045505560505560657075802530354045505560505560657075805.12. We note that the results are better in the layered case, as expected, because
scattering in such clutter does not scramble the direction of the arrivals. This is why
we can clearly see both reﬂectors in the KM image formed with the matrix P
(t).
The direction of arrival ﬁltering does not improve the focusing of the images, it just
separates the two reﬂectors. In the isotropic clutter the imaging is more diﬃcult, and
the direction of arrival ﬁltering is essential for focusing the images on the reﬂectors.
As was the case in Figure 5.12, CINT gives slightly better images, because it mitigates
the reverberations between the reﬂectors and the nearby clutter.

IN

6. Summary. We introduced and tested with numerical simulations a novel de-
tection and data ﬁltering method for coherent array imaging of small reﬂectors in
strongly scattering media, called heavy clutter. The array is a collection of N trans-
ducers which play the double role of sources and receivers. It uses the sources to probe
the medium with pulses and records the scattered waves. The data is organized in
the N × N response matrix P (t), which is a function of time. Because the medium
reverberations (the clutter backscatter) dominate the recordings, it is diﬃcult to dis-
tinguish the sought-after reﬂectors in the coherent images formed with P (t). These
are noisy and diﬃcult to interpret because they change from one clutter to another.
The clutter is not known in imaging applications, which is why we model the
uncertainty of the wave speed in the medium with a random process. A good imaging
method must produce results that are insensitive to the realizations of the random
wave speed i.e., be statistically stable. When the direct (coherent) arrivals of the waves
scattered at the reﬂectors are strong enough with respect to the clutter backscatter,
statistically stable imaging can be achieved with the coherent interferometric method
(CINT) [14]. Here we consider much stronger clutter, that cannot be handled by
CINT alone.

The detection and ﬁltering method introduced in this paper is an improvement
of that in [15]. It determines both the arrival time and direction of the weak coherent
echoes, and suppresses all the other arrivals, which are clutter backscatter. The arrival
time detection involves an adaptive time-frequency analysis of the response matrix
in sequentially reﬁned time windows, using the singular value decomposition (SVD)
of the local cosine transform (LCT) of P (t). The SVD of the Fourier transformed

matrix (cid:98)P (ω) has been used to improve imaging in many works, see for example [20].
most of the energy over the duration of the recordings. Therefore (cid:98)P (ω) is essentially

However, in our context it is not useful by itself, because the clutter backscatter carries

a ”noise” matrix, with no distinguishable singular values. Our method uses the SVD
in combination with the LCT analysis, to search systematically for the time windows
in which the coherent echoes arrive. These echoes are distinguishable from the clutter
backscatter with the SVD, when the time windows are small enough.

The detection of the direction of arrival of the coherent echoes is carried in the
selected time windows, using their paraxial approximation. This approximation is
justiﬁed for array apertures that are small with respect to the distance from the array
to the reﬂectors, as is usually the case in practice. To use the paraxial approximation,

23

we localize the data in time by backpropagating it to a reference point deﬁned by the
center time of the selected time windows, using travel time delays. This eliminates the
large phase of the coherent echoes and more importantly, it removes their dependence
on the source and receiver location oﬀsets in the array. That is to say, it makes the
coherent part of the backpropagated data a Hankel matrix. The method exploits
this fact by seeking the best approximation of the backpropagated data matrix by a
Hankel matrix, and then uses plane wave decompositions of the result to detect the
direction of arrival of the desired coherent echoes. This leads to improved focusing of
images, as shown with numerical simulations carried in a realistic setup motivated by
the application of non-destructive testing.

Acknowledgements. The work of L. Borcea was partially supported by a

NAKFI Imaging Science award. Support from NSF grant DMS-1510429 is also grate-
fully acknowledged. The work of G. Papanicolaou was partially supported by the
AFOSR grant FA9550-14-1-0275. The work of C. Tsogka was partially supported by
the European Research Council Starting Grant, GA 239959, the PEFYKA project
within the KRIPIS action of the GSRT and the AFOSR grant FA9550-14-1-0275.

REFERENCES

[1] R. Alonso, L. Borcea, G. Papanicolaou, and C. Tsogka. Detection and imaging in strongly

backscattering randomly layered media. Inverse Problems, 27:025004, 2011.

[2] A. Aubry and A. Derode. Detection and imaging in a random medium: A matrix method to

overcome multiple scattering and aberration. J.APPL.PHYS., 106:044903, 2009.

[3] A. Aubry and A. Derode. Random matrix theory applied to acoustic backscattering and imaging

in complex media. Phys. Rev. Lett., 102(8):084301, Feb 2009.

[4] A. Aubry and A. Derode. Singular value distribution of the propagation matrix in random

scattering media. Waves in Random and Complex Media, 20:333–363, 2010.

[5] A. Bakulin and R. Calvert. The virtual source method: Theory and case study. Geophysics,

71:SI139–SI150, 2006.

[6] E. B´ecache, P. Joly, and C. Tsogka. Etude d’un nouvel ´el´ement ﬁni mixte permettant la

condensation de masse. C. R. Acad. Sci. Paris S´er. I Math., 324:1281–1286, 1997.

[7] E. B´ecache, P. Joly, and C. Tsogka. An analysis of new mixed ﬁnite elements for the approxi-

mation of wave propagation problems. SIAM J. Numer. Anal., 37:1053–1084, 2000.

[8] J. B´erenger. A perfectly matched layer for the absorption of electromagnetic waves. Journal

of Comp. Physics, 114:185–200, 1994.

[9] Biondo Biondi. 3D Seismic Imaging. Number 14 in Investigations in Geophysics. Society of

Exploration Geophysicists, Tulsa, 2006.

[10] N. Bleistein, J.K. Cohen, and J.W. Stockwell Jr. Mathematics of multidimensional seismic

imaging, migration, and inversion. Springer, New York, 2001.

[11] L. Borcea, F. Gonz´alez del Cueto, G. Papanicolaou, and C. Tsogka. Filtering random layering

eﬀects in imaging. SIAM Multiscal Modeling and Simulations, 8(3):751–781, 2010.

[12] L. Borcea, J. Garnier, G. Papanicolaou, and C. Tsogka. Enhanced statistical stability in

coherent interferometric imaging. Inverse Problems, 27:085004, 2011.

[13] L. Borcea, G. Papanicolaou, and C. Tsogka. Interferometric array imaging in clutter. Inverse

Problems, 21(4):1419–1460, 2005.

[14] L. Borcea, G. Papanicolaou, and C. Tsogka. Adaptive interferometric imaging in clutter and

optimal illumination. Inverse Problems, 22(4):1405–1436, 2006.

24

[15] L. Borcea, G. Papanicolaou, and C. Tsogka. Adaptive time-frequency detection and ﬁltering

for imaging in heavy clutter. SIAM Imaging Science, 4(3):827–849, 2011.

[16] Liliana Borcea, George Papanicolaou, and Chrysoula Tsogka. Asymptotics for the space-time
Wigner transform with applications to imaging. Stochastic Diﬀerential Equations: Theory
and Applications, Interdiscip. Math. Sci, 2:91–112, 2007.

[17] D. Donoho, A. Maleki, and M. Shahram. Wavelab 850. http://www-stat.stanford.edu/

~wavelab/, 2005.

[18] J. Garnier, G. Papanicolaou, A. Semin, and C. Tsogka. Signal to Noise Ratio analysis in virtual

source array imaging. SIAM Imaging Science, 8:248–279, 2015.

[19] S. Mallat. A wavelet tour of signal processing. Academic Press, second edition, 1999.
[20] C. Prada and M. Fink. Eigenmodes of the time reversal operator: A solution to selective

focusing in multiple-target media. Wave Motion, 20:151–163, 1994.

25

