GeometricHittingSetforSegmentsofFewOrientationsS´andorP.Fekete·KanHuang·JosephS.B.Mitchell·OjasParekh·CynthiaA.PhillipsAbstractWestudyseveralnaturalinstancesofthegeometrichittingsetproblemforinputconsistingofsetsoflinesegments(andrays,lines)havingasmallnumberofdistinctslopes.Theseproblemsmodelpathmonitoring(e.g.,onroadnetworks)usingthefewestsensors(the“hittingpoints”).Wegiveapproximationalgorithmsforcasesincluding(i)linesof3slopesintheplane,(ii)verticallinesandhorizontalsegments,(iii)pairsofhorizontal/verticalseg-ments.Wegivehardnessandhardnessofapproximationresultsfortheseprob-lems.Weprovethatthehittingsetproblemforverticallinesandhorizontalraysispolynomiallysolvable.Keywordssetcover·hittingset·approximationalgorithms1IntroductionThesetcoverproblemisfundamentalincombinatorialoptimization.ItisNP-hardandhasanO(logn)-approximationalgorithm,whichisbestpossibleS.FeketeTUBraunschweig,Braunschweig,GermanyE-mail:s.fekete@tu-bs.deK.HuangStonyBrookUniversity,StonyBrook,NY,USAE-mail:khuang@ams.stonybrook.eduJ.MitchellStonyBrookUniversity,StonyBrook,NY,USAE-mail:jsbm@ams.stonybrook.eduO.ParekhSandiaNationalLabs,Albuquerque,NM,USAE-mail:odparek@sandia.govC.PhillipsSandiaNationalLabs,Albuquerque,NM,USAE-mail:caphill@sandia.govarXiv:1603.06077v1  [cs.CG]  19 Mar 20162Fekete,Huang,Mitchell,Parekh,Phillips(unlessP=NP,[15]).Equivalently,setcovercanbecastasahittingsetproblem:givenacollection,C,ofsubsetsofsetU,ﬁndasmallestcardinalitysetH⊆UsuchthateverysetinCcontainsatleastoneelementofH.Nu-merousspecialinstancesofsetcover/hittingsethavebeenstudied.Ourfocusinthispaperisongeometricinstancesthatariseincovering(hitting)setsof(possiblyoverlapping)linesegmentsusingthefewestpoints(“hitpoints”).Acloselyrelatedproblemisthe“GuardingaSetofSegments”(GSS)prob-lem[5,7,8,28],inwhichthesegmentsmaycrossarbitrarily,butdonotoverlap.SincethisproblemisstronglyNP-complete[7]ingeneral,ourfocusisonspe-cialcases,primarilythoseinwhichthesegmentscomefromasmallnumberoforientations(e.g.,horizontal,vertical).Weprovideseveralnewresultsonhardnessandapproximationalgorithms.Wearemotivatedbythepathmonitoringproblem:givenasetoftrajecto-ries,eachapathoflinesegmentsintheplane,placethefewestsensors(points)toobserve(hit)alltrajectories.Togaintheoreticalinsightintothischalleng-ingproblem,weexaminecleaner,butprogressivelyharder,versionsofhittingtrajectory/line-likeobjectswithpoints.IfthetrajectoriesareonaManhat-tanroadnetwork,thepathsare(possiblyoverlapping)horizontal/verticalseg-ments.Alternatively,onewishestoplacethefewestvendorsorservicestationsinaroadnetworktoserviceasetofcustomertrajectories.Ourresults.Wegivecomplexityandapproximationresultsforseveralgeo-metrichittingsetproblemsoninputsSofline“segments”ofspecialclasses,mostlyofﬁxedorientations.Thesegmentsareallowedtooverlaparbitrarily.Weconsidervariouscasesof“segments”thatmaybebounded(linesegments),semi-inﬁnite(rays),orunboundedinbothdirections(lines).Ourresultsare:(1)Hittinglinesof3slopesintheplaneisNP-hard(greedyisoptimalfor2slopes).Forsetcoverwithsetsizeatmost3,standardanalysisofthegreedyalgorithmgivesanapproximationfactorofH(3)=1+(1/2)+(1/3)=(11/6),andthereisa4/3-approximationbasedonsemi-localoptimization[17].Weprovethatthegreedyalgorithminthisspecialgeometriccaseisa(7/5)-approximation.(2)Hittingverticallinesandhorizontalraysispolytimesolvable.(3)Hittingverticallinesandhorizontal(evenunit-length)segmentsisNP-hard.Ourproofshowshittinghorizontalandverticalunit-lengthsegmentsisalsoNP-hard.WeproveAPX-hardnessforhittinghorizontalandverticalsegments.(4)Hittingverticallinesandhorizontalsegmentshasa(5/3)-approximationalgorithm.(Thisproblemhasastraightforward2-approximation.)(5)Hittingpairsofhorizontal/verticalsegmentshasa4-approximation.Hittingpairshavingoneverticalandonehorizontalsegmenthasa(10/3)-approximation.TheseresultsarebasedonLP-rounding.Moregenerally,hit-tingsetsofksegmentsfromrorientationshasa(k·r)-approximationalgo-rithm.(6)Wegivealinear-timecombinatorial3-approximationalgorithmforhittingtriangle-freesetsof(non-overlapping)segments.RecentlyJoshiandGeometricHittingSetforSegmentsofFewOrientations3Narayanaswamy[28]gavea3-approximationforthisversionofGSSusinglinearprogramming.RelatedWork.Thereisawealthofrelatedworkongeometricsetcoverandhittingsetproblems;wedonotattemptheretogiveanexhaustivesurvey.Thepointlinecover(PLC)problem(see[26,30])asksforasmallestsetoflinestocoveragivensetofpoints;itisequivalent,viapoint-lineduality,tothehittingproblemforasetoflines.ThePLC(andthusthehittingproblemforlines)wasshowntobeNP-hard[33];infact,itisAPX-hard[9]andMax-SNPHard[31].TheproblemhasanO(logOPT)-approximation(e.g.,greedy–see[29]);infact,thegreedyalgorithmforPLChasworst-caseperformanceratioΩ(logn)[18].HassinandMegiddo[25]consideredhittinggeometricobjectswiththefewestlineshavingasmallnumberofdistinctslopes.Theyobservedthat,evenforcoveringwithaxis-parallellines,thegreedyalgorithmhasanapproxima-tionratiothatgrowslogarithmically.Theygaveapproximationsfortheprob-lemofhittinghorizontal/verticalsegmentswiththefewestaxis-parallellines(and,moregenerally,withlinesofafewslopes).GaurandBhattacharya[22]considercoveringpointswithaxis-parallellinesind-dimensions.Theygivea(d−1)-approximationbasedonroundingthecorrespondinglinearprogram(LP).Manyotherstabbingproblems(ﬁndasmallsetoflinesthatstabagivensetofobjects)havebeenstudied;see,e.g.,[16,20,23,24,29,32].Arecentpaper[28]givesa3-approximationforhittingsetsof“triangle-free”segments.Brimkovetal.[5,7,8]havestudiedthehittingsetproblemonlinesegments,includingvariousspecialcases;theyrefertotheproblemas“GuardingaSetofSegments”,orGSS.GSSisaspecialcaseofthe“artgalleryproblem:”placeasmallnumberof“guards”(e.g.,points)sothateverypointwithinageometricdomainis“seen”byatleastoneguard[35,37].Brimkovetal.[6]provideexperimentalresultsforthreeGSSheuristics,includingtwovariantsof“greedy,”showingthatinpracticethealgorithmsperformwellandareoftenoptimalorveryclosetooptimal.Theyprove,however,that,intheory,themethodsdonotprovideworst-caseconstant-factorapproximationbounds.Forthespecialcasethatthesegmentsare“almosttree(1)”(aconnectedgraphisanalmosttree(k)ifeachbiconnectedcomponenthasatmostkedgesnotinaspanningtreeofthecomponent),a(2−ε)-approximationisknown[5].AnimportantdistinctionbetweenGSSandourproblemsisthatweallowoverlapping(orpartiallyoverlapping)segments(rays,andlines),while,inGSS,eachlinesegmentismaximalintheinputsetoflinesegments(theunionoftwodistinctinputsegmentsisnotasegment).Aspecialcaseofourproblemisintervalstabbingonaline:Givenasetofsegments(intervals),arbitrarilyoverlappingonaline,ﬁndasmallesthittingsetofpointsthathitallsegments.Asimplesweepalongthelinesolvesthisproblemoptimally:whenasegmentends,placeapointandremoveallsegmentscoveredbythatpoint.Ifnopointlieswithinthreeormoreobjects,thenthehittingsetproblemisanedgecoverproblemintheintersectiongraphoftheobjects.Inparticu-lar,ifnothreesegmentspassthroughacommonpoint,theproblemcanbe4Fekete,Huang,Mitchell,Parekh,Phillipssolvedoptimallyinpolynomialtime.(Thisimpliesthatinanarrangementof“random”segments,theGSSproblemisalmostsurelypolynomiallysolvable;see[5].)Hittingaxis-alignedrectanglesisrelatedtohittinghorizontalandverticalsegments.Aronov,Ezra,andSharir[2]provideanO(loglogOPT)-approximationforhittingsetforaxis-alignedrectangles(andaxis-alignedboxesin3D),byprovingaboundofO(ε−1loglog(ε−1))ontheε-netsizeofthecorrespond-ingrangespace.Theconnectionbetweenhittingsetsandε-nets[10,13,14,21]impliesac-approximationforhittingsetifonecancomputeanε-netofsizec/ε;recentmajoradvances[1,36]onlowerboundsonε-netsimplythatassociatedrangespaces(rectanglesandpoints,linesandpoints,pointsandrectangles)haveε-netsofsizesuperlinearin1/ε.Remarkably,improved(1+ε)-approximationalgorithms(i.e.,PTASs)forcertaingeometrichittingsetandsetcoverproblemsarepossiblewithsimplelocalsearch.Forexample,MustafaandRay[34]givealocalsearchPTASforcomputingasmallestsubset,ofagivensetofdisks,thatcoversagivensetofpoints.HochbaumandMaas[27]usedgridshiftingtoobtainamuchearlierPTASfortheminimumunitdiskcoverproblemwhendiskscanbeplacedanywhereintheplane,notrestrictedtoadiscreteinputset.2HittingSegmentsSupposeSisasetoflinesegmentsintheplane.Ifallsegmentsarehorizontal,thenwecancomputeanoptimalhittingsetbyindependentlysolvingtheintervalstabbingproblemalongeachofthehorizontallinesdeterminedbytheinput.Ifthesegmentsareoftwodiﬀerentorientations(slopes),thentheprob-lembecomessigniﬁcantlyharder.Withoutlossofgenerality,assumetheseg-mentsarehorizontalandvertical.Weshowtheproblemishardeveniftheaxis-parallelsegmentsareallthesamelength.Thisresult(Corollary1)isaconsequenceofanevenstrongerresult,Theorem5,whichweestablishinSection5.Wereadilyobtaina2-approximationalgorithmbysolvingoptimallyeachofthetwoorientations,andusingtheunionofthehittingpointsforboth.(Thisgeneralizestoak-approximationforhittingsetsofsegmentsofkorientations.)3HittingLinesWhenSisasetofnlinesintheplane,greedygivesanO(logOPT)approx-imationfactor;anyapproximationfactorbetterthanlogarithmicwouldbequiteinteresting.(See[19,30].)Ifthelineshaveonly2slopes,thengreedyisoptimal.GeometricHittingSetforSegmentsofFewOrientations53.1HardnessofHittingLinesof3Slopesin2DWeprovethatthehittingsetproblemisNP-hardwhenlineshavemorethantwoorientations.Considerthedualformulation:(3-Slope-Line-Cover,3SLC)Findaminimum-cardinalitysetofnon-verticallinestocoverasetPofpoints(dualstothesetSoflines),whichareknowntolieonthreeverticallines.Ifaline‘coversipoints,wesaythat‘isani-line.LetP‘denotethesetofpointsofPthatarecoveredbyline‘.IfP‘1∩P‘2=∅,thenwesaythatlines‘1and‘2areindependent.AsetLoflinesisindependentifthelinesarepairwiseindependent;i.e.,‘i∈Land‘j∈Lareindependentforevery‘i6=‘j.Theorem1Theproblem3SLCisNP-complete.ProofOurreductionisfrom3-SAT.Letnandmdenotethenumbersofvari-ablesandclausesrespectively.TheinputpointsParedistributedonthreeverticallines,denotedl1,l2andl3fromlefttoright.Figure1showsavariablegadgetforvariableuina4-clauseinstance.Pointsintheﬁrsttwocolumnscanbehitbyeitheroftwosetsofindependentlines,redorblue.Theserepre-sentthe“True”or“False”settingofthevariableurespectively.Eachvariablegadgethasmpointsonlinel1,mpointsonlinel2and2mpointsonlinel3.Wecanaddthevariablegadgetsonebyoneontothethreecolumnssothatall3-linesarewithinvariablegadgets.Weuseaclausegadgettolinkvariables.Theithclausehasasinglepointc[i]onlinel1.Pointc[i]isconnectedtothenegationsofthevariablesinitsclauseonlinel3.Figure2showsthegadgetforclausec[i]=¯u∨v∨¯w.Weaddtheintersectionsofthesethreelinesegmentswithlinel2tothepointset.Wepickthelocationofc[i]suchthattheadditionofthesefournewpointscreatenonew3-linesotherthanthegreenlinesassociatedwiththeclausegadget.Tocompletetheconstruction,weplacenm+mpointsonlinel1suchthatthesenewpointsarenotonany3-line.Thus,byconstruction,each3-lineisinavariablegadgetoraclausegadget.Thereare2nm+2mpointsonlinel1,nm+3mpointsonlinel2and2nmpointsonlinel3foratotalof5nm+5mpointsonallthreelines.Wenowarguethatthe3-SATformulaissatisﬁableifandonlyifthecorresponding3SLCinstancecanbecoveredby2nm+2mnon-verticallines.Ifthe3-SATformulaissatisﬁable,thereisanindependentsetof3-linesinthevariableandclausegadgetsofsizenm+m.Specﬁcally,therearenmindependent3-linesfromthesatsifyingtruthassignmentforthenvariables.Sincetheformulaissatisﬁable,foreachclause,the3-linecorrespondingtothenegationofonecorrectlysetvariableisindependentofthevariabletruthassignmentpoints,andcanbepartofanindependentset.Thisgivestheothermmembersoftheindependentset.Therearethennm+mpointsonl1,2mpointsonl2andnm−mpointsonl3notpartofthismaximumindependentset.Eachofthenm+mremainingpointsonlinel1canbepairedwithoneoftheremainingnm+mpointsoneitherlinel2orl3.Thus,allpointsare6Fekete,Huang,Mitchell,Parekh,Phillipscoveredwith(nm+m)3-linesand(nm+m)2-linesforatotalof2nm+2mlines.Iftheinstancecanbecoveredwith2nm+2mlines,then,byconstruction,nm+moftheselinesmustbe2-linesinvolvingthepointsonlinel1thatarenotinanyclauseorvariablegadgets.These2-linescancover2nm+2mpoints,leaving3nm+3mtotalpointstobecoveredbytheremainingnm+mlines.Thustheremaininglinesmustallbeindependent3-lines.nmofthesecorrespondtoatruthassignmentforthevariables.Theremainingmmustcomefromclausegadgets.Thuseachclausegadgethasa3-linecompatiblewiththetruthassignmentandthe3-SATinstanceissatisﬁable.ut¯u[3]a[3]b[3]u[2]b[2]a[2]a[1]a[4]b[1]b[4]¯u[1]u[1]¯u[4]u[4]u[3]¯u[2]l1l2l3Fig.1Avariablegadget.u[i]¯v[i]w[i]c[i]l1l2l3d[i,1]d[i,2]d[i,3]Fig.2Aclausegadget.3.2AnalysisoftheGreedyHittingSetAlgorithmforLinesof3Slopesin2DIfnopointliesinmorethanksets,thegreedyalgorithm’sapproximationfactorisH(k)=Pki=1(1/i)[12].Thispropertyholdsforlinesof3slopeswithk=3,givingagreedyapproximationfactorH(3)=11/6.Wegiveanewanalysis,exploitingthespecialgeometricstructureofthehittingsetproblemforlinesof3slopes,toobtainanapproximationfactorof7/5.Letx,yandzbethenumberoflinesineachofthethreeorientationsintheplane.Withoutlossofgenerality,weassumethatx≥y≥z>0.Wecallapointwhereatleasttwolinesmeetavertex.Avertexisa3-intersectionifthreelines,onefromeachorientation,meetatthatpoint.GeometricHittingSetforSegmentsofFewOrientations7Otherwiseitisa2-intersection.Ifthereisno3-intersections,thenallverticesare2-intersections,andthegreedyalgorithmisoptimal.Weanalyzethiscaseinmoredetailbecauseitwillbeusefullaterintheproof.Thegreedyalgorithmplacespointsatany2-intersection,removesthetwolines,andcontinuesuntiltherearenomore2-intersections.Thenitplacesahitpointoneachremainingunhitline(allofwhichareparalleltoeachother).LetOPT2(x,y,z)denotetheoptimalsolutiontoa3-slopeinstancewithno3-intersections.ThenwehaveOPT2(x,y,z)=(cid:26)xifx≥y+z;x+(cid:6)y+z−x2(cid:7)ifx<y+z.Whenthereare3-intersections,thegreedyalgorithmiterativelyplaceshitpointsat3-intersections(inanyorder),removingthe3hitslines,untiltherearenomore3-intersections.Theremaininginstance,withonly2-intersections,nowcannowbesolvedoptimallyasdescribedabove.Theorem2Thegreedyalgorithmyieldsa75-approximationforhittinglinesof3slopesin2D.ProofConsiderthegraphGwhoseverticesarethe3-intersectionsofthein-putsetoflines,withanedgeofGbetweentwoverticesifandonlyifthecorresponding3-intersectionslieonacommonline.LetKdenotethecardi-nalityofamaximumindependentset,Imax,inG.LetN3bethenumberof3-intersectionsthatthegreedyalgorithmselects.TheseN3verticescorrespondtoamaximalindependentsetinG,soK≥N3.Wehave,K≤3N3,since(byindependence)thereisatmostonevertexofImaxalongeachofthe3N3linesthatthegreedyalgorithmhitswith3-intersections.TheoptimalsolutionhasOPThitpoints,withOPT=K+OPT2(x−K,y−K,z−K)(1)ThegreedysolutionyieldsasetofNgreedyhitpoints,withNgreedy=N3+OPT2(x−N3,y−N3,z−N3).(2)Firstsupposex=K,whichmeansthatx=y=z=K.Then,OPT=KandNgreedy=N3+OPT2(K−N3,K−N3,K−N3)=K+(cid:6)K−N32(cid:7).Wehavethreecases,dependingonthevalueofK,mod3:1.K=3l,wherelisaninteger;thus,NgreedyOPT≤1+(cid:24)3l−l2(cid:25)/3l=43.(3)2.K=3l+1;thus,NgreedyOPT≤1+(cid:24)3l+1−(l+1)2(cid:25)/(3l+1)<43.(4)8Fekete,Huang,Mitchell,Parekh,Phillips3.K=3l+2;thus,NgreedyOPT≤1+(cid:24)3l+2−(l+1)2(cid:25)/(3l+2)≤75.(5)Now,supposex≥K+1.Then,wehavethefollowingthreecases:1.Ifx≥y+z−N3,thenx−N3≥y−N3+z−N3,andx−K≥y−K+z−K.Thus,OPT=K+x−K=x,Ngreedy=N3+x−N3=x.2.Ify+z−K≤x<y+z−N3,thenOPT=x,Ngreedy=x+(cid:24)y+z−x−N32(cid:25),(6)NgreedyOPT=1+(cid:24)y+z−x−N32(cid:25)/x≤1+(cid:24)K−N32(cid:25)/(K+1)≤43.Thedetailedanalysisissimilartothecaseinwhichx=K.3.Ifx<y+z−K,thenOPT=x+(cid:24)y+z−x−K2(cid:25)≥K+1+1=K+2,(7)Ngreedy−OPT≤y+z−x−N32+1−y+z−x−K2≤1+K3,NgreedyOPT=1+Ngreedy−OPTOPT≤1+1+K/3K+2.Thus,–whenK=1,OPT=Ngreedy;–whenK=2,3,4,using(6)andtheﬁrstequalityin(7),wehaveNgreedy−OPT=1,sowehaveNgreedyOPT≤1+14=1.25;(8)–whenK≥5,NgreedyOPT≤1+821≈1.381.Thiscompletestheproof.utGeometricHittingSetforSegmentsofFewOrientations93.3Axis-ParallelLinesin3DWhilein2Dthehittingsetproblemforaxis-parallellinesiseasilysolved,in3DweprovethatthecorrespondinghittingsetproblemisNP-hard,usingareductionfrom3-SAT.Theorem3Hittingsetforaxis-parallellinesin3DisNP-complete.xyzC1C2Fig.3Anexampleofavariableloop.vvFig.4Theinsertionoftheorangedetourchangesthecolorofvfromredtoblue.ProofWegiveareductionfrom3-SAT.Wesaythatalineisad-lineifitisparalleltothed-axis;wesaythataplaneisanab-planeifitisparalleltotheplanespannedbythea-axisandtheb-axis.Aclauseisrepresentedbyaz-line.Avariableisrepresentedbyaloopofaxis-parallellineswiththefollowingproperties:1.Notwox-lineslieinthesamexz-plane.(Thisensuresthatwhenaclausez-linemeetsavertexoftheloopwhereanx-linemeetsay-line,itdoesnotalsomeetanothersuchvertex.)2.Thereareanevennumberofedgesineachloop.3.Linesfromtwodiﬀerentloopsdonotintersect.4.Aloopintersectsaclausez-lineifandonlyifthevariablerepresentedbythatloopisintheclauserepresentedbythez-line.Theintersectionpointrepresentsaliteralinthecorrespondingclause.5.Therearetwooptimalhittingsetsforaloop–thesetofoddvertices,andthesetofevenvertices.Allpositive(resp.,negative)literalsshouldbeinthesamehittingset.Figure3showsaportionofaninstanceinwhichclauseC1includesliteralx1andclauseC2includesliteralx1.Inthreedimensions,itisnothardtotakedetourstoavoidunwantedintersections.Thenumberofverticesinaloopcanbeadjustedbyinsertingadetour,asshowninFigure4.Finally,wearguethatallclausez-linescanbehitforfreebytheoptimalhittingsetsofvariableloopsifandonlyifthereisasatisfyingtruthassignmentforthecorresponding3-SATinstance.ut10Fekete,Huang,Mitchell,Parekh,Phillips4HittingRaysandLinesHittingraysis“harder”thanhittinglines,sinceanyinstanceofhittinglineshasacorrespondingequivalentinstanceasahittingraysproblem(placetheapicesoftheraysfarenoughawaythattheyareeﬀectivelylines).Unlikelines,therecanbemanydiﬀerentcollinearrays.Dividecollinearraysintotwogroupsaccordingtothedirectiontheypointalongthecontainingline,‘.Becauseofnesting,weneedkeeponlyoneoftherayspointingineachofthetwodirectionsalong‘.Forexample,amongleft-pointingrays,wekeeponlytheonecontainedinallotherleft-pointingrays.Thisistheonewiththeright-mostapex.Weshowthatthespecialcasewithhorizontalraysandverticallines(ab-breviatedHRVL)isexactlysolvableinpolynomialtime:Theorem4ThehittingsetproblemforverticallinesandhorizontalrayscanbesolvedinO(nT)time,wherenisthenumberofentitiesandTisthetimeforcomputingamaximummatchinginabipartitegraphwithnnodes.Webeginwithahigh-leveloverviewofthealgorithm.Apointcancoveratmost3objects:averticalline,aleft-facingray,andaright-facingray.Thisrequiresthetworaystointersectinasegment,andtheverticallinetointersectthissegment.Wecallpointsatsuchintersections3-hitters.Wecancomputethemaximumpossiblenumberof3-hitters,withnotwosharingalineorasegment,viamaximummatchinginabipartitegraph,whereedgesrepresentintersectionsbetweenverticallinesandhorizontalsegments.Weprovethereexistsanoptimalsolutionwiththismaximumnumberof3-hitters.Thealgo-rithmperformsasweepinwardfromtheleftandright,ﬁndingasuitablesetof3-hitters,ensuringtheremaininglineshavethebestpossiblechancetoshareapointwiththeremainingrays.Onceeverythingthatis3-hitisremoved,theremainingobjectsintersectinatmostpairs.Sowecanﬁnishthehittingbysolvinganedgecoverproblembetweenraysandlines.Weprovethisisoptimal.Wenowgiveadditionalalgorithmicandproofdetails.Wecallahorizontalraytotheleft(resp.,right)anl-ray(resp.r-ray).Inthissection,alllinesarevertical.Iftwocollinearraysaredisjoint,weshiftonerayslightlyupordown,sonotwodisjointraysarecollinear.Theserayscannotbecoveredbyasinglepoint,sothisdoesnotfundamentallyaltertheoptimalsolution.Wealsoassumethatnocollinearrayshavethesameorientation,sinceinthiscaseonerayisasubsetoftheothers,whichareredundant.Ifarayisnotcollinearwithanyotherray,weaddaraytopairwithit.Forexample,ifanr-rayintersectsnol-ray,weaddanintersectingl-raywhoserightendpointistotherightofallverticalinputlines.Thisadditionalraywillnotchangetheoptimalsolution.Ifanl-rayandr-rayintersect,theirintersectionisasegment.Sinceeachrayintersectsexactlyoneotherray,werepresenteachsuchpairofraysbytheirsegment.LetHandVdenotethenumberofsegmentsandlinesrespectively.AnysolutionrequiresVpointstocoverthelines.Thosepointscanhelp“hit”segmentsintwopossibleways:GeometricHittingSetforSegmentsofFewOrientations11(1)Thepointonalinemaybeplacedonasegment.Wecallthecorrespondinglinea3-hitterandsaythatthesegmentis3-hitbytheline.(2)Pointsonlinesmayhiteachrayoutsideitsintersectingsegment.Thisrequirestwopointsontwodistinctlines.Wecalltheleft(resp.,right)lineanl-hitter(resp.,r-hitter).Wesaythesegmentisdouble-hitbythosetwolines.Letv1andv2bethenumberofsegmentshitbytheVpointsintheﬁrst(1)andsecond(2)types,respectively.Then,thenumberofpointsinthesolutionisH+V−v1−v2.Ourgoalistoputapointoneachlinetohitasmanysegmentsaspossible(i.e.,tomaximizev1+v2).GivenaninstanceofHRVL,wecancalculatethemaximumnumberof3-hitters.WeconstructthebipartitegraphGinwhichonesetofnodesisthelinesandtheothersetofnodesisthesegments;thereisanedgebetweentwonodesifandonlyifthelineandthesegmenttheyrepresentintersect.WerefertoGasthelines-segmentsgraph.Maximummatchinginabipartitegraphissolvableinpolynomialtime.AmatchinginthegraphrepresentsasetofindependentintersectionsinthecorrespondingHRVL.Thatis,asetofMedgesinamatchingcorrespondstoawaytohitMsegmentsandMlineswithMpoints.Thesearehittingsoftype(1).Thefollowinglemmashowsthathittingpointsoftype(1)arepreferredoverhittingpointsoftype(2).Lemma1ForanyinstanceofHRVL,thereisamaximummatchingbetweenlinesandsegmentsthatcanbeaugmentedtobeanoptimalsolution.ProofTheproofisbycontradiction.Letv∗1bethelargestv1foranyminimumhittingset.Weassumethatv∗1islessthanm,thecardinalityofthemaximummatchingbetweenlinesandsegments.Thus,thereisanaugmentingpathinthebipartitegraphG;anexampleofsuchapathisshowningreeninFigure5.Becausethecurrentsolutionisoptimal,anyaugmentingpathcannotimproveit.Thisallowsustoinfersomepropertiesoftheﬁrstsegmentandthelastlineontheaugmentingpath.WeconsidertheaugmentingpathPwiththeshortestlength(fewestelements)andtheshortesthorizontaldistancebetweenthelasttwolinesalongthepath.ThenbycaseanalysisonpathP,wearguethereexistsanotheraugmentingpaththatincreasesv∗1orviolatesaminimalityconditionofP.Inmoredetail,anaugmentingpathingraphGcorrespondstoasequenceofalternatingsegmentsandlinesintheHRVLinstance:{e1,l1,e2,l2,...,en,ln}.Inthecurrentsolutionlineli−1ismatchedwithsegmentei.InFigure5thegreenpathisanexampleofanaugmentingpath,wheren=3andbluedotscorrespondtocurrent3-hitterpoints.Becauseoftheoptimalityofthecurrentsolution,anyaugmentingpathcannotimproveit.Thefollowingtwopropertieshold;otherwise,afteraugmenting,thesumofv1andv2willstaythesame,butv∗1wouldbeincreasedby1:–e1isdouble-hitbyotherlines.–lnishelpingtodouble-hitanothersegment.12Fekete,Huang,Mitchell,Parekh,PhillipsWithoutlossofgenerality,weassumetheintersectionofe1andl1istotheleftofln.Alsoassumethatn,thenumberoflinesintheaugmentingpath,isassmallaspossible.Amongaugmentingpathswithsmallestn,wepickonewiththeshortesthorizontaldistancebetweenlinesln−1andln.Weconsiderthefollowingcases:1.Iflinelnisthel-hitterofsomesegmentet,thenthel-hitterofsegmente1cantakeitsjob.Onecandotheaugmentingandassignthel-hitterofe1tol-hitet.Thereforethesolutionisstilloptimalandv∗1increases.2.Supposelinelnisanr-hitterforasegmentet,andletlrbether-hitterforsegmente1.Iflinelristotherightoflineln,thenlinelrcantakethejoboflineln.Thatis,linelrcanbether-hitterforsegmentet.Again,itisnowpossibletoincreasev∗1whilemaintaininganoptimaltotalnumberofpoints.3.Iflinelnisanr-hitterandther-hitterofe1(calledlr)istotheleftofln,weknowthatlinelrwillintersectasegment,eq(with1≤q≤n)oftheaugmentingpath.Thisisbecauseweassumelinelnistotherightoftheintersectionofe1andl1.InFigure5,linel4isapossiblelr.Thus,usinglrgivesashorteraugmentingpath,{e1,l1,...,eq,lr}.Thisnewpatheitherhasstrictlyfewerlinesorhasastrictlyshorterhorizontaldistancebetweenthelastlines.Thiscontradictsthechoiceoftheﬁrstaugmentingpath.utl1l2l3e1e2e3l4Fig.5Agreenaugmentingpath:thematchingsizeincreasesbyreplacingbluecircleswithredcrosses.l1l2l3l4Fig.6Swappingthe(l-hitterorr-hitter)rolesofl2andl3makesbothofthemmoreuseful.Thefollowinglemmagivesadditionalusefulstructureforatleastoneop-timalsolution:Lemma2GivenanoptimalsolutionS,thereisanoptimalsolutionS0thathasthesamesetof3-hittersasS,withitsl-hittersallleftofitsr-hitters.ProofInFigure6twosegmentsaredouble-hitbytwopairsoflines;thebluelinesarel-hittersandtheredlinesarer-hitters.Whenwepairl1tol3andGeometricHittingSetforSegmentsofFewOrientations13pairl2tol4,thetwosegmentsarestilldouble-hit,becausethisswapmovesthel-hitterfurtherleftandther-hitterfurtherright.Asequenceofsuchswapsmovesalll-hitterstotheleftofallr-hitters.utAlgorithm1belowgivesanoptimalsolutionforHRVL.Thealgorithmmaximizesthenumberof3-intersectionsand“balances”theremaininglinesbetweentheleftandrightsidesasmuchaspossible.Wetestthe“criticality”ofalinelbycomputingamaximumcardinalitymatchinginthelines-segmentsgraph,withandwithoutthelinel;ifthematchingcardinalitydropswhenlinelisnotpartofthegraph,thenlineliscritical.Inthealgorithm,wecheckthecriticalityoflines:giventhepreviouschoices,ifacriticallineisnotusedasa3-hitter,thereisnowaytoextendthepreviouschoicestoamaximummatching.Weadda3-hittertooursolutionifandonlyifthelineinvolvediscritical.Non-criticallinesarecountedasl-hitterswhensweepingfromtheleftandasr-hitterswhensweepingfromtheright.Thealgorithmremoveseachnewly-discoverednon-criticallinefromconsiderationasa3-hitter,andswapsthesweepdirection(fromlefttoright,orfromrighttoleft).Thisbalancesthenumberofpresumedl-hittersandr-hittersduringthecourseofthethealgorithm.Whenthesweepencountersasegments,thistriggerstestingoftheﬁrstline(inthesweepdirection)thatintersectss,ifany.Subsequentsweepstepscontinuetoprocesssegmentsuntilitismatchedaspartofa3-hitter,oritisremoved,tobedoublehitattheendofthealgorithm.Wenowarguethattheleft-right-balancedapproachgiveslinesthatobeyLemma2.LetSbethesolutiongivenbyAlgorithm1,andletS0beanoptimalsolutionwiththemaximumcardinalitysetof3-hitters.WeknowthatSandS0havethesamenumberof3-hitters.LetDandD0denotethesetsoflinesleftbehind(not3-hitters)inSandS0,respectively.WeorderlinesinDandD0fromlefttoright.Letkbej|D|2k.Thus,thereareatmostkpairsofdouble-hittersinSandS0.Letlhi(resp.,lh0i)betheithlineofD(resp.,D0).GivenasolutionPandalinel,letE(l,P)denotethenumberofsegmentsontheleftsideoflnothitby3-hittersinP.Alinehavingmoresegmentsonitsrightsideismorelikelytobeanl-hitter.Wewillshowthatlinelhiisatleastascapableofbeinganl-hitterasislinelh0i;speciﬁcally,weshowthatE(lhi,S)≤E(lh0i,S0),i=1,2,..,k.(9)Wesplittheproofof(9)intooneclaimandtwolemmas.Becauseofthecriticalitytestandthechoiceofintersectingsegmente2,wehavethefollowingclaim:ClaimInSifa3-hitterisontheleftsideofanl-hitter,thesegmenthitbythe3-hitterwillnotintersectthatl-hitter.ProofTheproofisbycontradiction.Letlbea3-hitter,matchedtosegmente.Letlhbetheclosestl-hittertotherightoflinelandsupposelhinter-sectssegmente.Therecanbej≥0linesbetweenlandlhwhichmustallbe3-hitters.Letthissetof3-hitterswiththeirmatchedsegmentsbe14Fekete,Huang,Mitchell,Parekh,Phillips1Input:setLofverticallines,setSofhorizontalsegments(rayintersections);2H←[0,0]//Hcounts2-hittersatleftandrightsides;3I3←{}//I3stores3-intersectionsofthesolution;4SD←0;//SDstandsforsweepdirection.0isfromlefttoright;1isreverse;5L2←∅;S2←∅//unmatchedlinesandsegments6stepA:ifthereareany3-intersectionleftthen7sweepalongthedirectionindicatedbySD;8Whenalineandsegmentstartatthesametime,thesegmentisseenﬁrst.9iftheeventisalinel1then10//Donotconsiderthelineasapartofa3-hitter.;11//Sendtotheﬁnaledge-coverproblem;12stepB:;13L←L−{l1};14L2←L2∪{l1};15H[SD]++;16toggleSD;17else18//theeventisasegmente1;19ife1crossessomeline(s)then20l←thelinehittinge1thatisclosestalongSD;21else22//Donotconsidere1asapartofa3-hitter.;23//Sendtotheﬁnaledge-coverproblem;24S←S−{e1};25S2←S2∪{e1};26gotostepA;27end28ifliscriticalthen29//Forexample,ifSDis0,lookattherightendpointsofsegments30//crossedbyl.Picktheonewiththeleftmostrightendpoint31e2←thesegmentcrossinglwiththeclosestendpointtolalongSD;32//puttheintersectionofe2andlintoI3;33I3←I3∪(l,e2);34S←S−{e2};35L←L−{l};36gotostepA;37else38gotostepB;39end40end41else42TheremainingproblemL∪L2andS∪S2canbesolvedoptimallyasanedgecoverproblem;43endAlgorithm1:BidirectionalsweepingalgorithmforHRVL.(l1,e1),(l2,e2),...,(lj,ej).LettbethesizeofthemaximummatchinginGatthetimelinelistestedforcriticality.Thatis,themaximummatchingsizedropstot−1whenlinelisremoved.Whenlinelhistestedforcriticality,thesizeofthemaximummatchingist−j−1whetherlhisincludedornot.LetMbeamaximummatchingwhenlhisnotincluded.WecanaugmentMtoamatchingofsizetthatdoesnotincludelinel:addthejpairingsfromthe3-hittersbetweenlandlhandthenadd(lh,e).SegmenteisnotpartofGeometricHittingSetforSegmentsofFewOrientations15matchingMsinceeisremovedfromthesetofactivesegmentsinline34ofAlgorithm1.Thiscontradictsthecriticalityoflinel.utLemma3lhicannotbeontherightsideoflh0i,i=1,2,..,k.ProofTheproofisbyinduction.Weprovethebasecasebycontradiction.Figure7illustratesthefollowingargument.Wheni=1,weassumethatlh1isontherightsideoflh01.ThismeansthatinS,linelh01isa3-hitter.Supposee1isthecorrespondingsegmenthitbylh01inS.WeknowinS0linelh01doesnothite1(sincelinelh01isnota3-hitterinS0).Thuse1mustbehitbyadiﬀerent3-hitterinS0,sayl3(otherwise,lh0can3-hite1toincreasethenumberof3-hitters,contradictingthechoiceofS0).AgaininS,l3hitse2,whichmeansinS0,e2mustbehitbyanotherlinel4.Claim43guaranteesthatallofthelinesliandthesegmentsejinvolvedinthetracingprocessareontheleftsideoflh1.Thistracingwillstopeventually,becausethereareonlyaﬁnitenumberoflinestotheleftoflinelh1.Thisgivesacontradiction.Nowweassumethatiisthesmallestintegersuchthatlhiistotherightoflh0i.Weagainstarttracingfromlh0i.Thetracingprocesscanonlyendatlhj(j<i);otherwise,acontradictionexists,asinthebasecase.Letthetracingsequencebelh0i,e1,l3,e2,l4,...,lhj.Sincelh0jisontheleftsideoflh0i,soislhj.InS0,wereplace3-hittersofS0inthetracingsequenceby3-hittersofSinthesequence.Now,inS0,lhjbecomesanl-hitterinsteadoflh0i.ThismodiﬁedS0hasimprovedwiththereplacementofanl-hitterwitha“morecapable”(left)l-hitter,whilekeepingthenumberof3-hittersthesame.Now,westartanewtracewiththenewS0.Insummary,ifthetracingendswithanl-hitterinS,weimproveS0andresumetracing.Thisprocessmustendinacontradictionbecausethereareonlyaﬁnitenumberoflines,andeachrevisedS’movesanl-hitterstrictlyleft.utlh01lh1e1l3e2l4Fig.7ThetracingsequenceforthebasecaseoftheproofofLemma3.Theorderitemsarevisitedinthetracingislh1,lh01,e1,l3,e2,l4.Theoriginall-hitterlh1isalwaysblueandtheoriginall-hitterlh01isalwaysred.Thenforeachstepofthetracing,thenewlineorsegmentisgreen,withallolderelementsinblack.16Fekete,Huang,Mitchell,Parekh,PhillipsAnimmediateresultfromthislemmaisE(lhi,S0)≤E(lh0i,S0).(10)GivenasolutionPandalinel,letC(l,P)denotethenumberofsegmentsontheleftsideoflthathavebeen3-hitinP.LetN(l)bethetotalnumberofsegmentsontheleftoflinel.ThefollowinglemmashowsthatthesegmentsthatSleavestobedoublehitarethesegmentsthatareeasiertodouble-hit.Lemma4C(lhi,S)≥C(lhi,S0),i=1,2,..,k.ProofWeshowedinClaim43thatifasegmentis3-hittotheleftofanl-hitterl,thenthesegmentendsbeforereachinglinel.IfC(lhi,S)<C(lhi,S0),thenwereplacethepartofSthatisontheleftsideoflhiwiththecorrespondingpartofS0.Thisgivesusasolutionthathasmore3-hittersthanShas,con-tradictingtheassumptionthatShasthemaximumsetof3-hitters.utThereforeweobtainE(lhi,S)=N(lhi)−C(lhi,S)≤N(lhi)−C(lhi,S0)=E(lhi,S0)≤E(lh0i,S0)..5HittingLinesandSegments5.1HardnessTheorem5HittingsetforhorizontalunitsegmentsandverticallinesisNP-complete.ProofThereductionisfrom3SAT.Considera3SATinstancewithnvariablesandmclauses.SeeFigure8.Eachvariableisrepresentedbyacollinearconnectedsetof2mhorizontalunitsegments,andeachclauseisrepresentedbyaredverticallinethatinter-sectsappropriatepairsofhorizontalvariablesegments(ifthatvariableoccursinaclause)orjustsinglesegments(incaseavariabledoesnotoccurinaclause).Settingappropriateparitiesfortheliteralsinaclauseisachievedbyappropriatehorizontalshiftingofthesegments,asshownintheﬁgure.Thisresultsinaconstructioninwhichtheonlyplacewherethreeoftheelements(segmentsorlines)canbehitinvolvesaverticallinerepresentingaclause,cor-respondingtoliteralsoccurringintherespectiveclauses.(Theseareindicatedbymagentacirclesintheﬁgure.)LetN=4mnbethenumberofhorizontalsegments.Thisincludesthe2mpervariablejustdescribed,and2mmorepervariableatthebottomoftheinstanceasshowninFigure8.TheNhorizontalsegments.arecalledvariablecomponents.WeshowthatanyfeasiblehittingsetwithexactlyN/2pointsinducesatruthassignmentandviceversa.ThereisnopointthathitsmorethantwoofGeometricHittingSetforSegmentsofFewOrientations17x4x2x1c1c3c2x3Fig.8Asetofhorizontalunitsegmentsandverticallinesthatrepresentsthe3SATinstanceI=(x1∨x2∨x3)∧(x2∨x3∨x4)∧(x1∨x2∨x4).Forbettervisibility,collinearsegmentsareslightlyshiftedvertically,withredandgreenpointsindicatingoverlappingsegments.Inanoptimalhittingset,thepointcoveringalabeledhorizontalsegmentinducesatruthvalueforthecorrespondingvariable:selectingoneofitsgreypoints(e.g.,intheindicatedgreenmanner)assignsavalueof“true”;selectingaredpoint,avalueof“false”.Overall,truthassignmentsforeachvariablecorrespondtoasetofgreenorredpoints,respectively.(Notethatthereareseveralequivalentchoicesfromthegreypoints,whichallcorrespondtothesametruthassignments.)Literalsoccurringinclausesareindicatedbymagentacircles;thesearetheonlyplaceswhereapointcanhitthreesegmentsorlinesatonce.thevariablecomponentsatonce.Therefore,stabbingallNofthemrequiresatleastN/2points,andanysolutionconsistingofexactlyN/2pointsmusthiteachvariablecomponentexactlyonce.Consequently,theblackverticallinesandtheblackcollinearsetsofconnectedhorizontalsegmentsinFigure8maybereorderedsothat,withoutlossofgenerality,asolutionwithexactlyN/2pointsdoesnotpickanyofthegraypoints.Eliminatingthegraypointsresultsinanaturalpartitionoftheinstanceintopoint-disjointeven-cardinalityloopsofvariablecomponentsforeachvariable,wherethepointsineachloopalternatebetweenredandgreen.ThusanysolutionofsizeN/2hittingthevariablecomponentsmustselectallredorallgreenpointsfromeachvariable’sloop,correspondingtoatruthassignment.Wegetanoverallfeasiblehittingsetifandonlyifthepointsalsostabtheverticalclauselines,correspondingtoasatisfyingtruthassignment.utAfterappropriateverticalscaling,wecanreplacetheverticallinesbyver-ticalunitsegments,immediatelygivingthefollowingcorollary.18Fekete,Huang,Mitchell,Parekh,PhillipsCorollary1DecidingifthereexistsasetofkpointsintheplanethathitagivensetSofunit-lengthaxis-parallelsegmentsisNP-complete.WenowshowAPX-hardnessfortheall-segmentcase.Theorem6Computingaminimumhittingsetofaxis-parallelsegmentsisAPX-hard.ProofWegiveareductionfromMAX-2SAT(3),maximum2-satisﬁabilityinwhicheachvariableappearsinatmostthreeclauses.MAX-2SAT(3)isknowntobeAPX-hard[3].Inourreduction,aclauseisrepresentedbyaverticalsegment.Avariablegadgetisa“loop”consistingofatmost8horizontalsegmentsandexactly2verticalsegmentsatthefarleft/right,linkingachainofanoddnumber(3,5,or7,dependingifthevariableappearsin1,2,or3clauses)ofcollinearhorizontalsegmentsontheupperportionofthegadgettoasinglehorizontalsegmentclosingtheloopalongthebottomportionofthegadget.RefertoFigure9.Intotal,avariableloopconsistsofanevennumber(6,8,or10)ofsegments,whoseintersectiongraphisanevencycle(nothreeofthemintersect).Weplaceredandgreenpoints,eachrepresentinganedgeofthecyclethatistheintersectiongraph,alternatingaroundthecycle.Thesegreen/redpointsoccuratcrossingswiththeleft/rightverticalsegmentsoftheloop,oratoverlappointsalongthetopchainofhorizontalsegmentsoftheloop.Membershipofavariablexiinaclausecjisrepresentedbyhavingtheclausesegmentpassthroughagreenorredpoint(accordingtowhetherthevariableoritsnegationappearsintheclause)alongthevariableloopforxi,creatinga3-intersectionpointatthecrossing.c1c2c3v1Fig.9Inthisexample,clausec1includestheliteralv1;clausesc2andc3eachincludetheliteralv1.Letmandnbethenumbersofclausesandvariables,respectively,inaninstanceofMAX-2SAT(3).Then,n2≤m≤3n2.Letkbethenumberofpointsinanoptimalsolutionofthecorrespondinghittingsetproblem.Ifthehittingsetdoesnotcontainany3-intersection,weknowthatk≤5n+m≤11m,sinceallofthesegmentsineachvariableloopcanbehitusingatmost5hitpoints.GeometricHittingSetforSegmentsofFewOrientations19SupposeAisanapproximationalgorithmfortheminimumhittingpointproblemonaxis-parallellinesegments,andthatAguaranteesanapproxima-tionfactorof1+ε.ForanyhittingsetH(ofsize|H|≤(1+ε)k)producedbyA,weobtainasolutionforthecorrespondingMAX-2SAT(3)instance,asfollows.Considerthevariableloopforxi.InH,thenumber,hi,of3-intersectionhitpointsalongthevariableloopcouldbe0,1,2,or3.Ifhi=0,thenwereplacethehitpointsofHalongtheloopwithanoptimalsetofhitpointsalongtheloop–eitherthegreenortheredpoints.Thissetsthetruthvalueofxi(greenis“true”,redis“false”).Further,thisexchangehasnotcausedthenumberofhitpointstogoup.Ifhi=1,withone3-intersection(greenorred)pointp,wereplacethehitpointsofHalongtheloopwiththe(optimal)setofallgreenorallredhitpointsalongtheloop.Thissetsthetruthvalueofxi(greenis“true”,redis“false”),andthisexchangehasnotcausedthenumberofhitpointstogoup.Ifhi=2,thenthetwo3-intersectionpointsmight“agree”(bethesamecolor)or“disagree”(bediﬀerentcolors).Iftheyagree,wesetthetruthvalueofthevariableaccordingly,anduseanoptimalsetofhitpointsoftheappropriatecoloralongtheloop.Iftheydisagree,thenweknowthatthenumberofhitpointsofHusedinhittingthevariableloopissuboptimal(byatleast1),sinceHdoesnotuseall-redorall-greenhitpoints.Thus,wesetthevariableeitherway(useanoptimalhittingsetofall-greenorall-red),andwehavealeftoverpointofH,whichweusetohittheclauselinethatbecameunhitintheprocessofsettingthehitpointsettobemonochromatic.Therewasnoincreaseinthenumberofhitpoints.Ifhi=3,thenifthethreepointsallagree(areofthesamecolor),wesetthetruthvalueofxiaccordingly.Otherwise,weknowthatthesetofpointsofHusedtohitsegmentsinthisvariableloopissuboptimal;wesetthetruthvalueofxiaccordingtothemajoritycoloramongthethree3-intersections,andusetheonesavedhitpointtohittheclausethatwaspreviouslyhitbythe(minoritycolor)pointofH,butnowisnot.Inthisway,wehavenowtransformedHintoasetHv∪Hc,with|Hv∪Hc|=|H|,whereHvisanoptimalhittingsetforvariableloops(usinghitpointsofasinglecoloraroundeachloop),plusa(disjoint)setHcofadditionalpointstohitclausesegments.LetalgbethenumberofclausessatisﬁedbythevariablesettingdeterminedbyHv.Then,weknowthatalg≥m−|Hc|.GivenanoptimaltruthassignmentfortheMAX-2SAT(3)instance,achiev-ingoptsatisﬁedclauses,onewaytoconstructahittingsetforallofthesegmentsintheconstructionisthefollowing:Optimallyplacehittingpointswithineachvariableloop,accordingtothetruthassignment(andusingex-actly|Hv|hitpoints),andthenhittheremainingm−optclauselines,notyethitby3-intersectionswithinvariableloops,usingm−optseparatehitpoints.Sincekistheoptimalnumberofhitpointsforthewholeconstruction,weknowthatk≤|Hv|+(m−opt).20Fekete,Huang,Mitchell,Parekh,PhillipsSinceweareassumingthatAisa(1+ε)-approximation,wehavethat|H|=|Hv|+|Hc|≤(1+ε)k,whichimpliesthat|Hc|≤(1+ε)k−|Hv|.Then,puttingthesetogether,andusingthefactsthatopt≥m3andthatk≤11m,wehavealg≥m−|Hc|≥m−(1+ε)k+|Hv|≥m−(1+ε)k+k−m+opt≥(1−33ε)opt.ThisimpliesthatourhittingsetproblemisAPX-hard(aPTASforthemin-imumhittingsetofaxis-parallelsegmentswouldimplyaPTASforMAX-2SAT(3)).ut5.2ApproximationWegivea5/3-approximationforhittingasetVofverticallinesandasetHofhorizontalsegments.Westartbylookingatthelowerbounds:v=|V|isthenumberofverticallines.Itisalowerbound.Lethbethelowerboundonhittinghorizontalsegmentsonly.Wecancomputehexactly;itistheminimumnumberofhitpointsforthehorizontalsegments(computedoneachhorizontalline).Atanystageofthealgorithm,welethandvbethecurrentvaluesoftheselowerboundsforhittingthecurrent(remainingunhit)setsHandV.Instage1,weplacetwokindsofpoints:(a)Weplacehittingpointsonverticallinesthatreduceh(andv)byone.Thesepointsare“maximallyproductive”sincenosinglehittingpointcandomorethantoreducehandveachbyone.Asverticallinesarehit,weremovethemfromV.Similarly,ashorizontalsegmentsarehit,weremovethemfromH.(b)Lookforpairs(ifany)ofpoints,onthesamehorizontallineandontwoverticallines(fromamongthecurrentsetV),thatdecreasehbyone.Letk1andk2bethenumberoftype(a)andtype(b)pointsplacedinthisstage,respectively.Therefore,fortheremaininginstance,thelowerboundhdecreasesbyk1+k2/2,andvdecreasesbyk1+k2.Instage2,wenowhaveasetofverticallinesVandhorizontalsegmentsHsuchthatnosinglepointattheintersectionofaverticallineandahorizontalsegment(orsegments)reducesh,andnopairofpointsontwodistinctverticallinesreducesh.Lemma5ForsuchsetsVandHasinstage2,anoptimalhittingsethassizeatleastv+h,wherev=|V|andhistheminimumnumberofpointstohitH.GeometricHittingSetforSegmentsofFewOrientations21ProofThehitpointsweplaceonV(oneperline)mightconceivablydecreaseh.Weclaimthatthiscannothappen.Assumetothecontrarythatithappens.Let{q1,q2,...,qK}beaminimum-cardinalitysetsuchthateachofthemisonsomelineofVfromlefttorightandhisdecreasedby1afterplacingtheset.Sincethesetisminimum,thepointsinitshouldbeonahorizontallineL.Sincewehavefoundallproductivepointsandpairsofpointsinstage1,Kshouldbeatleast3.Considerthehitpointq2.ThesegmentsonLthatarenothitbyq2areeithercompletelyleftorrightofq2;letHlandHrbethecorrespondingsets.Pointstotheleftofq2donothitHr,andpointstotherightofq2tonothitHl.Ifaddingq1decreasesH,thatmeansq1andq2isaproductivepair,whichshouldbefoundinstage1;otherwisethismeansthatthepointq1isunnecessary,contradictingtheminimalityofK.utTheorem7Thereisapolynomial-time5/3-approximationalgorithmforge-ometrichittingsetforasetofverticallinesandhorizontalsegments.ProofThetotalnumberofpointsselectedbyouralgorithmisk1+k2fromtheﬁrststageandh−k1−k2/2+v−k1−k2fromthesecondstage.ByLemma5,thepointschoseninstage2isalowerboundonthecostofanoptimalsolution:h−k1−k2/2+v−k1−k2≤OPT.(11)Wealsohaveh≤OPTandv≤OPT.Therearetwocases.(i)k1+k2≤2/3·OPT:Inthiscaseweselectatmost2/3·OPTpointsinStages1,andweuse(11)toboundthenumberofpointsselectedinStage2.Weconcludethatouralgorithmselectsatmost5/3·OPTpoints.(ii)k1+k2>2/3·OPT:Thetotalnumberofpointsselectedbyouralgorithmish−k1−k2/2+v≤2·OPT−(k1+k2/2).Sincek1+k2/2≥k1/2+k2/2>1/3·OPT,weobtaina5/3-approximationinthiscaseaswell.utTheorem8Thereisapolynomial-time5/3-approximationalgorithmforge-ometrichittingsetforasetofvertical(downward)raysandhorizontalseg-ments.ProofThe2-stageapproximationalgorithmdescribedaboveworksforthiscaseaswell.Thekeyobservationisthatamonganysetofcollineardownwardrays,wemayremoveallbuttheonewiththelowestapexfromtheinstance.ThereforeafterStage1,thehittingpointsweplaceontheraysnotyethitwillnotdecreaseh.TheargumentisanalogoustothatinLemma5.ut6HittingPairsofSegmentsWeconsidernowthehittingsetproblemforinputsthatareunionsoftwosegments,onehorizontalandonevertical.Whilewearemotivatedbypairs22Fekete,Huang,Mitchell,Parekh,Phillips(andlargersets)ofsegmentsthatformpaths,ourmethodsapplytogeneralpairsofsegments,whichmightmeettoforman“L”shape,a“+”,ora“T”shape,ortheymaybedisjoint.ThishittingsetproblemisNP-hard,sinceitgeneralizesthecaseofhorizontalandverticalsegments.Theorem9Forobjectsthatareunionsofahorizontalandaverticalsegment,thehittingsetproblemhasapolynomial-time4-approximation.ProofForeaseofdiscussion,wecalltheunionoftwosegmentsan“L”.Weuseamethodsimilartothoseusedin[11,23].Brieﬂy,wedothefollowing.Solvethenaturalset-coverlinearprogramming(LP)relaxation.Createtwonewproblems:onethathasonlythehorizontalpieceofsomeoftheLsandanotherthathasonlytheverticalpiecesoftheremainingLs.PlaceanLintotheverticalproblemiftheLPverticalsegmenthasvalueatleast1/2,andintothehorizontalproblemotherwise.Solvethetwonewproblemsinpolynomialtimeusingthecombinatorialmethodforthe1Dproblem,orsolvingtheLPs,whicharetotallyunimodular,andthuswillreturnintegersolutions.Takeallthepointsselectedbyeithernewproblem.Weprovethatthesepointsarea4-approximation.Inmoredetail,supposewehavelunionsofsegmentsasdescribedabove,andletPbethesetofpointsservingasourpotentialhitters.Weassumethat|P|ispolynomialinlbypreprocessingtheinstance,ifnecessary,sothatweonlyconsiderpointsatendpointsandcrossingsofsegments.Foreachsuchunioni,weletSibethesetofpointscoveringtheunion,whileHiandViarethesetsofpointscoveringthehorizontalsegmentandverticalsegmentrespectively.Weemploythestandardsetcoverlinearprogram(LP)relaxationspecializedtoourproblem:minXp∈PxpXp∈Hixp+Xq∈Vixq≥1,∀1≤i≤l(12)0≤xp≤1,∀p∈P.WeuseanoptimalLPsolution,x∗,toconstructanewinstanceoftheprobleminwhicheachunioncontainseitheraverticalsegmentorahorizontalsegment,butnotboth.Thisnewinstanceiseasiertoapproximatebutnolongerprovidesalowerboundontheoriginaloptimumvalue,OPT;however,weshowthatitprovidesalowerboundthatiswithinaconstantfactorofOPT.Foreachunionofsegmentsi,wesetS0i=(Hi,ifPp∈Hix∗p≥1/2Vi,otherwise.(13)NoweachS0icorrespondstoeitherahorizontalorverticalsegment.LetH0={i|S0irepresentsahorizontalsegment},andletV0={1,...,l}\H0.Ouralgorithmisasfollows:GeometricHittingSetforSegmentsofFewOrientations231.SolvetheLP,andletx∗beanoptimalsolution.2.ConstructS0iforeachunionofsegmentsiasdescribedabove.3.Solvethehittingsetproblemsforallthehorizontalsegments,H0,andalltheverticalsegments,V0,independently.Returntheunionofthepoints,Xselectedbyoptimalsolutionstoeachinstance.ThisalgorithmreturnsafeasiblesolutionsinceitselectssomepointinS0i⊆Siforeachunionofsegments.Theﬁrsttwostepsruninpolynomialtime.Hittingsegmentsofasingleorientationissolvableinpolynomialtime;infactthecorrespondingsetcoverLPrelaxationinthiscasehastheconsecutiveonespropertyandistotallyunimodular,hencetheoptimumLPvalueequalstheoptimumintegersolutionvalue.Toseethatitisa4-approximation,lety∗p=min{2x∗p,1}forallp.By(12)and(13)weseethatthefractionalvectory∗isfeasiblefortheLPinstancedeﬁnedbythesegmentscorrespondingtotheS0i.NowwemodifythelatterLPinstancebytakingeachpointpandreplacingthevariablexpwithvari-ablesxp,handxp,v,wherexp,happearsonlyinhorizontalsegmentconstraintswherexpformerlyappeared,andxp,vappearsonlyinsuchverticalsegmentconstraints.TheresultingLPdecouplesthehorizontalandverticalsegmentsandcapturespreciselytheproblemfromStep3ofthealgorithm.SincethisLPistotallyunimodular,wehavethatthenumberofchosenpoints,|X|,isatmostthecostofanyfeasiblefractionalsolution.Inparticularweseethatthefractionalvectorz∗withz∗p,h=z∗p,v=y∗pisfeasibleforthedecoupledLP,andso:|X|≤Xqz∗q=2Xpy∗p.(14)ToobtainourdesiredresultwenotethatPpy∗p≤2Ppx∗pbythedeﬁnitionofy∗,yielding|X|≤4Ppx∗p≤4·OPTby(14).utTheaboveideanaturallyextendstoa4-approximationfortheweightedversionoftheproblem.Forunionsconsistingofatmostksegmentsdrawnfromrorientations,theapproachyieldsa(k·r)-approximation.TheLP-roundingtechniqueintheproofabovewasintroducedbyCarretal.[11]toobtaina2.1-approximationfortheweightededge-dominatingsetproblem.AsimilarideawasintroducedindependentlybyGauretal.[23]toobtaina2-approximationforstabbingaxis-alignedrectangleswithhorizontalandverticallines.Byusingtheapproachaboveinconjunctionwithourap-proximationalgorithmforTheorem7,weobtainanimprovedapproximationfactorinthecasethattheverticalsegmentsarelines.Beforedescribingthisresult,weneedaslightlystrongerversionofTheorem7:Lemma6Thereisapolynomial-time5/3-approximationalgorithmforhit-tingasetofverticallinesandhorizontalsegmentsthatalwaysreturnsasolu-tionofcostwithin5/3thatofanoptimalsolutiontothenaturalsetcoverLPrelaxation.ProofGivenaninstanceofgeometrichittingsetoververticallinesandhor-izontalsegments,letLP∗betheoptimumvalueachievedbythenaturalset24Fekete,Huang,Mitchell,Parekh,PhillipscoverLPrelaxation.WeshowthatthealgorithmusedtoestablishTheorem7satisﬁesstrongerversionsoftheboundsusedintheproofofTheorem7:h≤LP∗,v≤LP∗,andh−k1−k2/2+v−k1−k2≤LP∗.Sincetheverticallinesaredisjoint,bysummingthecorrespondingLPcon-straints,weseethatPpxp≥vforanyfeasiblex.Takingxtobeanoptimalsolution,x∗,wehavethatLP∗=Ppx∗p≥v.Asnotedbefore,thenaturalsetcoverLPrelaxationistotallyunimodularinthecaseofhittingonlyhorizontalsegments.ThusbydroppingtheconstraintscorrespondingtothelinesfromtheLP,weconcludethatLP∗≥h.Fortheﬁnalbound,weneedtoshowthatforthetypeofinstanceobtainedbyour5/3-approximationinStage2,LP∗isequaltoOPT0,theoptimumsizeofahittingset.Lemma5showsthatforsuchinstances,OPT0=v0+h0,wherev0andh0aretheindividualverticalandhorizontallowerboundsfortheinstance.ConsideracollectionofcollinearhorizontalsegmentsfromaStage-2in-stance,andremoveallpointsthatlieonsomeverticallinealongwithallthehorizontalsegmentshitbysuchpoints.TheproofofLemma5showsthatsuchadeletiondoesnotincreasetheoptimalnumberofpointsrequiredtohitsuchaninstance.Hence,appealingtotheintegralityofsuchLPinstanceswhendroppingtheverticallineconstraints,wehavethatPp∈P0\P0Vxp≥h0,whereP0isthesetofpointsofaStage-2instance,andP0Visthesetofpointsthatlieonsomeverticalline.Consideringonlytheverticallineconstraints,asabove,givesusPp∈P0Vxp≥v0.Together,theseinequalitiesyieldthedesiredbound,Pp∈P0xp≥h0+v0.WesubstitutetheseboundsintheproofofTheorem7toconcludethatouralgorithmselectsatmost5/3·LP∗pointsinsteadof5/3·OPTpoints.utUsingsimilarmethodsandtheabovelemma,wealsohavethefollowing:Theorem10Forobjectsthatareunionsofahorizontalsegmentandaver-ticalline,thehittingsetproblemhasapolynomial-time10/3-approximation.ProofOuralgorithmisessentiallythesameasthe4-approximationofTheo-rem9,withadiﬀerentlaststep:1.SolvetheLP,andletx∗beanoptimalsolution.2.ConstructS0iforeachunioniofahorizontalsegmentandaverticalline.3.NoweachS0iiseitherahorizontalsegmentoraverticalline,andweﬁndafeasiblesolutionXforthisinstanceusingour5/3-approximation.utWeconstructy∗justasintheproofofour4-approximation;however,nowweobservethaty∗isfeasibleforthesetcoverLPrelaxationfortheinstancedeﬁnedbytheS0i.Thisisjustaninstanceofhittinghorizontalsegmentsandverticallines,andso:|X|≤5/3·LP∗≤5/3·Xpy∗p.SincePpy∗p≤2Ppx∗pasbefore,wehavethat|X|≤10/3·Ppx∗p≤10/3·OPTasdesired.utGeometricHittingSetforSegmentsofFewOrientations257HittingTriangle-FreeSetsofSegmentsWeconsidernowtheprobleminwhichtheninputsegmentsSareallowedtocrossortoshareendpoints,butnottooverlap(i.e.,theintersectionofanytwoinputsegmentsisnotanon-zerolengthsegment–itiseitheremptyorasinglepoint).LetG=(V,E)denotethe(planar)arrangementgraph,G(S),inducedbythesegmentsS;thus,GhasvertexsetVequaltothesetofallendpointsorcrossingpointsofSandhasedgesetEjoiningeachpairofverticesthatappearconsecutivelyalongasegmentofS.WeassumethatGistriangle-free,meaningthatithasnocycleoflength3(i.e.,itsgirthisatleast4).Itiswellknownthataplanartriangle-freegraphsmusthaveavertexofdegreeatmost3.(Forcompleteness,weprovidetheproof:Inatriangle-freeplanargraph(havingnnodes,eedges,andffaces),eachfacehasatleast4edgesboundingit.Thesumofthenumberofedgesboundingeachofthefacesissimply2e,andinatriangle-freegraphmustbeatleast4f;thus,2e≥4f.ByEuler’sformula(f−e+n=1+c,forc≥1connectedcomponents),weget2e≥4(1+c+e−n)≥4(2+e−n),implyingthate≤2n−4.Thesumofthevertexdegreesisexactly2eandisthusatmost4n−8;thus,notallverticeshavedegree4ormore–theremustbeavertexofdegreeatmost3.)Inthissectionwegivealinear-time3-approximationalgorithmforcom-putingahittingsetofpointsthathitallofthesegmentsofS,assumingthatthearrangementgraphG(S)istriangle-free.Ourapproximationfactorof3matchesthatobtainedrecentlybyJoshiandNarayanaswamy[28];however,theiralgorithmemployslinearprogramming,whileoursisasimple,combina-toriallinear-time(O(m))algorithm.Ouralgorithmisthefollowingclipping/shorteningprocess:(i)Pickavertexv∈Vofdegreeatmost3(itwillnecessarilybeasegmentendpoint);suchavertexmustexist,bythetriangle-freeproperty.(ii)Removethevertexv,andshrinktheincidentsegmentswithendpointvtothenextadjacentvertex.(Inparticular,ifvisaT-junction,wheretwooftheedgesincidenttovlieonacommonsegment,thenonlytheonesegmentwithendpointatvisshrunk,leavingtheothertwoedgesconnected.)(iii)Whenshorteningasegmentsresultsinsegmentsbecomingasinglepoint(vertex),u,establishahittingpointatuandremoveallsegmentsthatpassthroughu.Thefollowinginvariantsholdatanystageoftheprocess:(1)Thereisatmostoneremainingsubsegmentofaninputsegment(i.e.,theportionofanoriginalsegmentsthatremainsisconnected).(2)Allsegmentsthathavebeenremovedarehitbythehittingpointsthathavebeenestablished.(3)Anyhittingsetoftheremainingsegments,togetherwiththeestablishedhittingpointsalreadyfound,formsahittingsetfortheoriginalsetofinputsegments.26Fekete,Huang,Mitchell,Parekh,Phillips(4)ThegraphGremainstriangle-freeduringtheprocess.Theinvariantsimplythatthesetofpointscomputedbythealgorithmisavalidhittingset.Thefollowinglemmaestablishestheapproximationfactor:Lemma7Thenumberofhittingpointsestablishedbythealgorithmisatmost3timesthenumber,|H|,ofpointsinanyhittingsetHforS.ProofPlacetokensontheverticesHandconsiderrunningtheclipping/shorteningprocessonG,withthefollowingactionsonthetokens.Whenthereisatokenonthevertexvthatisabouttobeclipped,replacethetokenwithatmost3clonesofit,oneoneachofthesegmentsthatmeetatv,allowingeachclonetoslidealongwiththeendpointofaclippedsegmentsasthesegmentisshrunk,leavingthecloneatanewvertexu,thenewendpointofsegments.(Theremightalsobeatokenatualready;weallowtwoormoretokens/clonestoaccumulateatavertex.)Wenevercloneaclone;ifacloneassociatedwithasegmentsexistsatavertexvthatisbeingclipped,itremainsonsegments,andslidesalongitasitshrinks.Thus,associatedwitheachpointofHthereiseitherasingletokenorupto3clonesofthetoken(butnotboth).Thisensuresthatthetokens/clonescontinuetohitallsegments,atallstagesoftheclipping/shorteningprocess.(Here,weareusingthedegree-3property,whichallowsustomakesurethattwoedgesincidentonvthatlieonthesamesegmentsarenotcutapartatvinourprocess;thus,apointofHthatliesonscontinuestohittheshrunkversionofsegments.Ifwehadsplitsatv,withnopointofHatv,thennoclonesaregeneratedatv,andthepoint(s)ofHonsegmentsmaynolongerbeavalidhittingsetforthenewarrangementaftersplittingsatv.)Inparticular,whenasegmentshrinkstoapointu,thereisatleastonetoken/clonepresentthere.Thus,thenumberofhittingpointsestablishedbyouralgorithmisatmost3|H|,foranyhittingsetHofS.LettingHbeanoptimalhittingset,wegetthatthenumberofhittingpointsproducedbythealgorithmisatmost3timesoptimal.utTheorem11Thealgorithmyieldsa3-approximationandrunsintimeO(m),wheremisthenumberofedgesintheoriginal(planar)arrangementgraphG.ProofImmediate,sinceweonlyhavetomaintainthegraphGinastan-dardplanarnetworkdatastructure(e.g.,theDoublyConnectedEdgeList(DCEL)[4])thatallowsustoknowvertexdegreesandperformelementaryoperationsinconstanttime.ut8ConclusionWehavegivenavarietyofnewhardnessandapproximationresultsforgeo-metrichittingsetsinvolvinglines,rays,andsegmentsfromasmallnumberofdiscreteorientations.Wehavealsogivenalinear-timecombinatorialalgorithmthatyieldsa3-approximationforhittingtriangle-freesetsofnon-overlappingGeometricHittingSetforSegmentsofFewOrientations27segmentsintheplane,matchingtheapproximationfactorrecentlyobtainedby[28]usinglinearprogrammingmethods.Wenotethatourmethodsapplyaswelltoyieldthesameresults(lowerbounds,upperbounds)forthemoregeneralsettinginwhich“segments”,“rays”,and“lines”aregivenassubsetsoffamiliesofdisjointpseudolinecurves,witheachdisjointfamilyplayingtheroleofan“orientation”oflines.(Thepseudolinepropertyrequiresthatanytwopseudolinecurvesthatintersect(arenot“parallel”)dosoinasinglepointofintersection,wheretheycross.)Naturalopenquestionsaskifanyoftheseapproximationboundscanbeimproved.Notably,webelievethatthetrivial2-approximationforhittingsegmentsoftwoorientationscanbeimproved.Anotherdirectionforfutureresearchisﬁxedparametertractable(FPT)algorithms.Finally,weareinter-estedinoptimalcoverageversionsoftheseproblemsinwhich,e.g.,onedesiresasmallestcardinalitysetoflinesegments,rays,orlines,fromasmallnumberoforientations,inordertocoveragivensetofpoints.AcknowledgementsThisworkissupportedbytheLaboratoryDirectedResearchandDevelopmentprogramatSandiaNationalLaboratories,amulti-programlaboratoryman-agedandoperatedbySandiaCorporation,awhollyownedsubsidiaryofLockheedMartinCorporation,fortheU.S.DepartmentofEnergy’sNationalNuclearSecurityAdministrationundercontractDE-AC04-94AL85000.J.MitchellacknowledgessupportfromtheUS-IsraelBinationalScienceFoundation(grant2010074)andtheNationalScienceFoundation(CCF-1018388,CCF-1526406).References1.Alon,N.:Anon-linearlowerboundforplanarepsilon-nets.Discrete&ComputationalGeometry47(2),235–244(2012)2.Aronov,B.,Ezra,E.,Sharir,M.:Small-sizeε-netsforaxis-parallelrectanglesandboxes.SIAMJournalonComputing39(7),3248–3282(2010)3.Ausiello,G.,Crescenzi,P.,Gambosi,G.,Kann,V.,Marchetti-Spaccamela,A.,Protasi,M.:Complexityandapproximation:Combinatorialoptimizationproblemsandtheirapproximabilityproperties.SpringerScience&BusinessMedia(2012)4.deBerg,M.,Cheong,O.,vanKreveld,M.,Overmars,M.:ComputationalGeometry:AlgorithmsandApplications,3rdedn.Springer-Verlag,Berlin,Germany(2008)5.Brimkov,V.E.:Approximabilityissuesofguardingasetofsegments.InternationalJournalofComputerMathematics90(8),1653–1667(2013)6.Brimkov,V.E.,Leach,A.,Mastroianni,M.,Wu,J.:Experimentalstudyonapproxima-tionalgorithmsforguardingsetsoflinesegments.In:AdvancesinVisualComputing,pp.592–601.Springer(2010)7.Brimkov,V.E.,Leach,A.,Mastroianni,M.,Wu,J.:Guardingasetoflinesegmentsintheplane.TheoreticalComputerScience412(15),1313–1324(2011)8.Brimkov,V.E.,Leach,A.,Wu,J.,Mastroianni,M.:Approximationalgorithmsforageometricsetcoverproblem.Disc.App.Math160,1039–1052(2012)9.Brod´en,B.,Hammar,M.,Nilsson,B.J.:Guardinglinesand2-linkpolygonsisAPX-hard.In:Proc.13thCanadianConf.Comput.Geometry,pp.45–48(2001).URLhttp://www.cccg.ca/proceedings/2001/mikael-2351.ps.gz10.Br¨onnimann,H.,Goodrich,M.T.:AlmostoptimalsetcoversinﬁniteVC-dimension.DiscreteComput.Geom.14,263–279(1995)11.Carr,R.D.,Fujito,T.,Konjevod,G.,Parekh,O.:A21/10-approximationalgorithmforageneralizationoftheweightededge-dominatingsetproblem.In:Algorithms-ESA2000,pp.132–142.Springer(2000)28Fekete,Huang,Mitchell,Parekh,Phillips12.Chv´atal,V.:Agreedyheuristicfortheset-coveringproblem.Mathematicsofoperationsresearch4(3),233–235(1979)13.Clarkson,K.L.:Algorithmsforpolytopecoveringandapproximation.In:AlgorithmsandDataStructures,pp.246–252.Springer(1993)14.Clarkson,K.L.,Varadarajan,K.:Improvedapproximationalgorithmsforgeometricsetcover.Discrete&ComputationalGeometry37(1),43–58(2007)15.Dinur,I.,Steurer,D.:Analyticalapproachtoparallelrepetition.In:Proceedingsofthe46thAnnualACMSymposiumonTheoryofComputing,STOC’14,pp.624–633.ACM,NewYork,NY,USA(2014).DOI10.1145/2591796.2591884.URLhttp://doi.acm.org/10.1145/2591796.259188416.Dom,M.,Fellows,M.R.,Rosamond,F.A.:Parameterizedcomplexityofstabbingrect-anglesandsquaresintheplane.In:WALCOM:AlgorithmsandComputation,pp.298–309.Springer(2009)17.Duh,R.c.,F¨urer,M.:Approximationofk-setcoverbysemi-localoptimization.In:ProceedingsoftheTwenty-ninthAnnualACMSymposiumonTheoryofComputing,STOC’97,pp.256–264.ACM,NewYork,NY,USA(1997).DOI10.1145/258533.258599.URLhttp://doi.acm.org/10.1145/258533.25859918.Dumitrescu,A.,Jiang,M.:Ontheapproximabilityofcoveringpointsbylinesandrelatedproblems.arXivpreprintarXiv:1312.2549(2013)19.Dumitrescu,A.,Jiang,M.:Ontheapproximabilityofcoveringpointsbylinesandrelatedproblems.Comput.Geom.48(9),703–717(2015).DOI10.1016/j.comgeo.2015.06.006.URLhttp://dx.doi.org/10.1016/j.comgeo.2015.06.00620.Even,G.,Levi,R.,Rawitz,D.,Schieber,B.,Shahar,S.M.,Sviridenko,M.:Algorithmsforcapacitatedrectanglestabbingandlotsizingwithjointset-upcosts.ACMTrans-actionsonAlgorithms(TALG)4(3),34(2008)21.Even,G.,Rawitz,D.,Shahar,S.M.:Hittingsetswhenthevc-dimensionissmall.Infor-mationProcessingLetters95(2),358–362(2005)22.Gaur,D.R.,Bhattacharya,B.:Coveringpointsbyaxisparallellines.In:Proc.23rdEuropeanWorkshoponComputationalGeometry,pp.42–45.Citeseer(2007)23.Gaur,D.R.,Ibaraki,T.,Krishnamurti,R.:Constantratioapproximationalgorithmsfortherectanglestabbingproblemandtherectilinearpartitioningproblem.In:Algorithms-ESA2000,pp.211–219.Springer(2000)24.Giannopoulos,P.,Knauer,C.,Rote,G.,Werner,D.:Fixed-parametertractabilityandlowerboundsforstabbingproblems.Comp.Geometry46,839–860(2013)25.Hassin,R.,Megiddo,N.:Approximationalgorithmsforhittingobjectswithstraightlines.DiscreteAppliedMathematics30(1),29–42(1991)26.Heednacram,A.:TheNP-hardnessofcoveringpointswithlines,pathsandtoursandtheirtractabilitywithFPT-algorithms.GriﬃthUniversity(2010)27.Hochbaum,D.S.,Maas,W.:ApproximationschemesforcoveringandpackingproblemsinimageprocessingandVLSI.J.ACM32,130–136(1985)28.Joshi,A.,Narayanaswamy,N.:Approximationalgorithmsforhittingtriangle-freesetsoflinesegments.In:SWAT,pp.357–367.Springer(2014)29.Kovaleva,S.,Spieksma,F.C.:Approximationalgorithmsforrectanglestabbingandintervalstabbingproblems.SIAMJ.DiscreteMath.20(3),748–768(2006)30.Kratsch,S.,Philip,G.,Ray,S.:Pointlinecover:theeasykernelisessentiallytight.In:ProceedingsoftheTwenty-FifthAnnualACM-SIAMSymposiumonDiscreteAlgo-rithms,pp.1596–1606.SIAM(2014)31.Kumar,V.A.,Arya,S.,Ramesh,H.:Hardnessofsetcoverwithintersection1.In:Automata,LanguagesandProgramming,pp.624–635.Springer(2000)32.Langerman,S.,Morin,P.:Coveringthingswiththings.Discrete&ComputationalGeometry33(4),717–729(2005)33.Megiddo,N.,Tamir,A.:Onthecomplexityoflocatinglinearfacilitiesintheplane.OperationsResearchLetters1(5),194–197(1982)34.Mustafa,N.H.,Ray,S.:Improvedresultsongeometrichittingsetproblems.Discrete&ComputationalGeometry44(4),883–895(2010)35.O’Rourke,J.:ArtGalleryTheoremsandAlgorithms.TheInternationalSeriesofMono-graphsonComputerScience.OxfordUniversityPress,NewYork,NY(1987)36.Pach,J.,Tardos,G.:Tightlowerboundsforthesizeofepsilon-nets.JournaloftheAmericanMathematicalSociety26(3),645–658(2013)GeometricHittingSetforSegmentsofFewOrientations2937.Urrutia,J.,etal.:Artgalleryandilluminationproblems.HandbookofComputationalGeometry1(1),973–1027(2000)Theorem0.1Findingaminimumcardinalitystabberforasetofaxis-parallelunitsegmentsisanNP-hardproblem.Proof.WegiveareductionofPlanar3SAT,whichisthesubclassof3-satisﬁabilityproblemsforwhichthevariable-clauseincidencegraphisplanar—seeFigure1(Left).Tothisend,westartwithanarbitrary3SATinstanceIinconjunctivenormalform,anduseittoconstructaprobleminstance(S,T)IthatissolvablebyasetofsmallcardinalityifandonlyifIcanbesatisﬁed;seeFigure1(Right).x4c1c2x3x1x2c3x2c1c3c2Figure1:(Left)Aplanarstraight-linedrawingofthevariable-clauseincidencegraphGIofthePlanar3SATinstanceI=(x1∨x2∨x3)∧(x2∨x3∨x4)∧(x1∨x2∨x4).(Right)Representingavariableanditsincidentedgesbyacycleofunitsegments;notethatoverlappingcollinearsegmentsareslightlyshiftedtogetabetterimageoftheoverlap.“Odd”segmentsareshowndashed,while“even”segmentsaresolid,additionalclausesegmentsarered.Pickingthepointsstabbingodd/evenoverlapswhengoingalongavariablecycleinaclockwiseorientationcorrespondstosettingavariabletotrue,whileeven/oddcorrespondstofalse.Asaﬁrststep,thevariable-clauseincidencegraphGIisembeddedintotheplane,suchthatallverticeshaveintegercoordinatesboundedbyO(n)andtheresultingedgesarerepresentedbyaxis-parallelpaths;thiscanbeachievedinpolynomialtimebyavarietyofgraph-drawingalgorithms[?].LetVvarbethesetofverticesthatrepresentvariables,letVclabethesetofverticesthatrepresentclauses,andletEclabethesetoflinesegmentsthatrepresentedgesinGI.ScalingtheresultinggraphlayoutbyafactorofO(n)resultsinanarrangementinwhicheachpairofverticesareatleastadistanceofΩ(n)apart.Nextwereplaceeachvariablevertexvi∈Vvaranditsincidentedgesbyanevencycleof2si∈O(n2)“variable”linesegments(eachwithcoordinatesatmultiplesof1/n)thatsketchoutthedrawingoftheseincidentedges,suchthatonlydirectlyconsecutivesegmentsoverlap;seeFigure??(Right).Eachcycleconsistsofsi“even”andsi“odd”variablesegments.LetSvarbetheresulting1arXiv:1603.06077v1  [cs.CG]  19 Mar 2016setof2svariablesegments.Eachclausevertexcjgetsreplacedbyasingleunitsegment,suchthatitintersectssegmentpairsofthethreecorrespondingliterals,withparityofthecorrespondingstabbingpointchosentotherespectivelogicalparityoftheliterals;seeFigure2.x3x1x2Figure2:Representingaclausecj=(x1∨x2∨x3)byanadditionalredunitseg-mentthatcrossesthethreecorrespondingvariablecycles,indicatedbysegmentsinblue,purple,green.Theredsegmentcanbestabbedwithoutanadditionalpoint,iﬀtherepresentedclauseissatisﬁedbyacorrespondingtruthassignment.Weclaim:ThereisasetPofspointsthatstaballunitsegments,ifandonlyifthereisasatisfyingtruthassignmentforI.Forthe“if”part,considerthetruthassignmentofavariablexi.Ifxissettobetrue,chooseallsioddstabberpointsforxi;ifxissettobefalse,chooseallsievenvariablesegmentsforxi.Thisstabsallvariablesegments;becauseeachclausehasasatisfyingliteral,theclausesegmentsarealsostabbed.Fortheconverse“onlyif”part,considerforanyvariablexithesetPi⊂Pthatstabtherespectivevariablesegments.Asnopointstabsmorethantwoofthesesegments,itisclearthat|Pi|≥si;asPni=1si=s,weconcludethat|Pi|=si.ThisalsoimpliesthatnotwopointsinPicanstabthesametwosegments,sothepointsinduceaperfectmatchingofthesegments;clearly,thisiseitherthe“even”pairingofsegments,orthe“odd”pairing.(InFigure2,theseareshownwithsolidorhollowpoints)Hence,eachPiinducesaconsistenttruthassignmentforvariablexi.Astherearenoadditionalpointstostabanyvariablesegmentseparately,weconcludethatallvariablesegmentsmustalsobestabbedbyoneofthepointsstabbingthecorrespondingvariablesegments.Thus,eachclausemustcontainasatisfyingvariable,andtheclaimholds.(cid:3)2