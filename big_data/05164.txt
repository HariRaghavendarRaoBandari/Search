6
1
0
2

 
r
a

M
 
6
1

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
4
6
1
5
0

.

3
0
6
1
:
v
i
X
r
a

ROBUST COUPLING OF DPG AND BEM FOR A SINGULARLY

PERTURBED TRANSMISSION PROBLEM

THOMAS F ¨UHRER AND NORBERT HEUER

Abstract. We consider a transmission problem consisting of a singularly perturbed reaction dif-
fusion equation on a bounded domain and the Laplacian in the exterior, connected through stan-
dard transmission conditions. We establish a DPG scheme coupled with Galerkin boundary ele-
ments for its discretization, and prove its robustness for the ﬁeld variables in so-called balanced
norms. Our coupling scheme is the one from [F¨uhrer, Heuer, Karkulik: On the coupling of DPG
and BEM, arXiv:1508.00630], adapted to the singularly perturbed case by using the scheme from
[Heuer, Karkulik: A robust DPG method for singularly perturbed reaction diﬀusion problems,
arXiv:1509.07560]. Essential feature of our method is that optimal test functions have to be com-
puted only locally. We report on various numerical experiments in two dimensions.

1. Introduction

The robust control of ﬁeld variables (in certain norms) is the driving force behind the develop-
ment of the discontinuous Petrov-Galerkin method with optimal test functions (DPG method). By
design, the DPG method provides access to approximation errors in the energy norm [10, 11], and
robustness means that, for singularly perturbed problems, the energy error controls the error in
the ﬁeld variables with constants that do not depend on the singular perturbation parameter. This
robustness has been demonstrated, in theory and experimentally, for convection/reaction domi-
nated diﬀusion problems on bounded domains, cf. [12, 4, 6, 5, 16, 24]. In this paper we extend this
technique to transmission problems in unbounded domains where the interior part of the problem
is singularly perturbed. We use boundary integral equations to represent the exterior problem and
present a coupled DPG-boundary element approximation that provides robust control of both the
ﬁeld and interface variables.

The boundary element method (BEM) is an established tool for solving homogeneous elliptic
or wave problems with constant coeﬃcients in unbounded domains. The BEM is also very useful
when dealing with transmission problems where one can couple domain-based methods (like ﬁnite
elements) with BEM, cf., e.g., [18, 8, 9, 3, 29] to give some classical references. Only recently we
learned how to appropriately couple the DPG method with boundary elements. Our ﬁrst approach
[15] consisted in applying the DPG technology to the whole transmission problem, formulated
in variational form including boundary integral operators to deal with the unbounded part of the
domain. This strategy suﬀers from the fact that, for approximating functions whose support touches
the interface, the calculation (approximation) of optimal test functions is a non-local problem
located on a strip along the interface. This goes against the general DPG strategy of localizing
these problems on individual elements. In [13] we presented a coupling procedure for DPG and BEM
that does not suﬀer from this disadvantage. There, problems for calculating optimal test functions

Date: March 17, 2016.
2010 Mathematics Subject Classiﬁcation. 65N30, 65N38.
Key words and phrases. Reaction dominated diﬀusion, transmission problem, DPG method with optimal test

functions, boundary elements, coupling, ultra-weak formulation, Calder´on projector.

Acknowledgment. Supported by CONICYT through FONDECYT projects 1150056, 3150012, and Anillo

ACT1118 (ANANUM).

1

are entirely local, as in the case of standard DPG, the only diﬀerence being the presence of a non-
trivial kernel on the right-hand side. We presented various coupling variants, of least-squares and
Galerkin types for diﬀerent boundary integral equations. The model problem considered there is the
Poisson equation in a bounded domain and the Laplacian in its complement, subject to standard
transmission conditions. The analysis of some of the coupling variants makes use of the fact that
both operators (in the interior and the exterior) are essentially identical. We also claimed that
the fourth variant (using both equations of the Calder´on identity) can be applied to transmission
problems where the operators are diﬀerent. In this paper we support this very claim.

Our hypothesis is that the DPG-BEM coupling scheme based on the full Calder´on identity can
be extended in a robust way to singularly perturbed transmission problems. This is the case when
the singular perturbation is localized on a bounded domain and can be robustly formulated by the
DPG method. As a model problem we couple reaction dominated diﬀusion on a bounded domain
with the Laplacian in the exterior. The solutions to reaction dominated diﬀusion problems suﬀer
from boundary layers when the source term does not comply with the boundary condition and, for
discontinuous sources, also exhibit interior layers. Various methods are proposed in the literature
dealing, e.g., with layer adapted meshes and/or balanced norms, see [19, 31, 20, 27] to cite a few. For
overviews see also [28, 21]. Corresponding transmission problems suﬀer from layers at interfaces,
cf. [22], and possibly in the interior for discontinuous right-hand side functions. Literature on
the numerical analysis of singularly perturbed transmission problems is scarce.
In [25], Nicaise
and Xenophontos study ﬁnite elements for a one-dimensional transmission problem with diﬀerent
diﬀusion coeﬃcients, and in [26] they consider the hp-version of the FEM for a transmission problem
in two dimensions. Here, the key point is an asymptotic expansion of the solution, based on the
assumption of smooth geometry and analytic data.

In [16] we developed a robust DPG scheme for reaction dominated diﬀusion. This scheme is based
on a speciﬁc ultra-weak variational formulation that comprises three ﬁeld variables (the original
unknown u and scaled unknowns replacing ∇u and ∆u) and skeleton variables (two trace and two
ﬂux variables on the skeleton of the mesh). Our quest for robustness led us to a formulation that
controls the ﬁeld variables robustly in so-called balanced norms. These norms are stronger than
the energy norm stemming from the problem. For reaction dominated problems with standard
boundary layers, Lin and Stynes [20] proved that these norms are balanced in the sense that their
diﬀerent components are of the same order when the diﬀusion parameter ε → 0. In this paper we
show that the robust DPG scheme from [16] can be coupled with the BEM to provide a robust
scheme for the corresponding transmission problem. As already mentioned, we follow the coupling
strategy from [13]. In this case, it turns out, that we have to scale the Calder´on identity by ε−1/2.
We are then able to prove (Theorem 1 in Section 2) uniform equivalence of the energy norm to
a norm that consists in the balanced norms of the ﬁeld variables and scaled norms (by ε−1/2) of
the interface variables (trace and ε times the normal derivative) in standard trace spaces (of orders
±1/2). This uniform equivalence is perturbed by diﬀerently scaled (by powers of ε) fractional-order
Sobolev norms of skeleton variables. This perturbation is not speciﬁc to our coupling procedure
but has appeared previously in DPG results of PDEs.
In fact, for both convection dominated
and reaction dominated problems, skeleton variables are not robustly controlled by the energy
norm, see [12, 16]. In that cases, also the upper bounds for the energy norm suﬀer from slight
ε-perturbations of norms for some skeleton variables. Whereas the loss of robust control of skeleton
variables is not critical since they are not of primary interest, the loss in upper bounds could be
compensated by higher-order approximations of the corresponding skeleton variable. Anyway, as
in standard DPG schemes our method delivers quasi-optimal approximations in the energy norm
(in our case the DPG-energy norm plus scaled norms for interface variables) and this norm controls
robustly the ﬁeld variables in balanced norms and the interface variables in the very norms that

2

constitute the energy norm. This result is immediate consequence of Theorem 1 and is stated in
Corollary 2 (also in Section 2).

The paper is organized as follows. In Section 2 we give a precise mathematical formulation of
the transmission problem, propose the DPG method coupled to BEM and state our main results
(Theorem 1 and Corollary 2). Section 3 deals with some technical results and presents a proof
of Theorem 1. Finally, in Section 4, we support our theoretical results with various numerical
experiments in two dimensions.

Throughout the paper, suprema are taken over sets excluding the null element. The notation

A (cid:46) B is used to say that A ≤ C·B with a constant C > 0 which does not depend on any quantities
the notation A (cid:38) B is used, and A (cid:39) B means that A (cid:46) B and B (cid:46) A.

of interest. In particular, C does not depend on the diﬀusion coeﬃcient ε > 0. Correspondingly,

2. Formulation of coupling method and main results

2.1. Model problem. We consider the following model transmission problem: given a diﬀusion
constant 0 < ε ≤ 1 and some data f ∈ L2(Ω), u0 ∈ H 1/2(Γ), φ0 ∈ H−1/2(Γ), ﬁnd u ∈ H 1(Ω) and
uc ∈ H 1
(1a)

loc(Ωc) such that

(1b)

(1c)

(1d)

(1e)

ε

−ε∆u + u = f in Ω,
−∆uc = 0 in Ωc,
u − uc = u0 on Γ,
∂uc
= φ0 on Γ,
∂nΩ

∂u
∂nΩ −

uc(x) =

(cid:40)
b log |x| + O(|x|−1) d = 2,
O(|x|−1)
d = 3,

as |x| → ∞.

Here, Ω ⊂ Rd, d ∈ {2, 3} is a bounded, simply connected Lipschitz domain with polygonal boundary
Γ, Ωc := Rd \ Ω, and normal vector nΩ on Γ pointing in direction of Ωc. We use the standard
loc(Ωc), trace space H 1/2(Γ) and its dual H−1/2(Γ), see Section 2.2 for
Sobolev spaces H 1(Ω), H 1
precise deﬁnitions. Note that for d = 2, the behavior of uc at inﬁnity involves some constant b ∈ R.
2.2. Sobolev spaces, discrete spaces, and norms. For a Lipschitz domain ω ⊂ Rd we use
the standard Sobolev spaces L2(ω), H 1(ω), H(div , ω). Vector-valued spaces and functions will be
denoted by bold symbols. Denoting by γω the trace operator acting on H 1(ω), we deﬁne the trace
space

and its dual H−1/2(∂ω) :=(cid:0)H 1/2(∂ω)(cid:1)(cid:48),
by (· ,·). Let T denote a disjoint partition of Ω into open Lipschitz sets T ∈ T , i.e.,(cid:83)

and use the canonical norms. Here, duality is understood with respect to L2(∂ω) as a pivot space,
i.e., using the extended L2(∂ω) inner product (· ,·)∂ω. The L2(Ω) inner product will be denoted
T∈T T = Ω.
The set of all boundaries of all elements forms the skeleton S := {∂T | T ∈ T }. By nM we mean
the outer normal vector on ∂M for a Lipschitz set M . On a partition T we use the product spaces

H 1/2(∂ω) :=(cid:8)γωu : u ∈ H 1(ω)(cid:9)

H 1(T ) := {w ∈ L2(Ω) : w|T ∈ H 1(T )∀T ∈ T },

H(div ,T ) := {q ∈ (L2(Ω))d : q|T ∈ H(div , T )∀T ∈ T },
H 1(∆,T ) := {w ∈ H 1(T ) : ∆w|T ∈ L2(T )∀T ∈ T }.

3

(cid:111)

The symbols ∇T , divT , resp. ∆T denote, the T -piecewise gradient, divergence, resp. Laplace
operators. On the skeleton S of T we introduce the trace spaces

H 1/2(S) :=
H−1/2(S) :=
These spaces are equipped with the norms inherited from the balanced norms of their corresponding
volume spaces, i.e.,

(cid:110)(cid:98)u ∈ ΠT∈T H 1/2(∂T ) : ∃w ∈ H 1(Ω) such that(cid:98)u|∂T = w|∂T ∀T ∈ T
(cid:110)(cid:98)σ ∈ ΠT∈T H−1/2(∂T ) : ∃q ∈ H(div , Ω) such that(cid:98)σ|∂T = (q · nT )|∂T ∀T ∈ T
(cid:111)
L2(Ω))1/2 : w ∈ H 1(Ω),(cid:98)u|∂T = w|∂T ∀T ∈ T
L2(Ω))1/2 : q∈ H(div , Ω),(cid:98)σ|∂T = (q · nT )|∂T ∀T ∈T

(cid:107)(cid:98)u(cid:107)1/2,S := inf
(cid:107)(cid:98)σ(cid:107)−1/2,S := inf

For functions(cid:98)u ∈ H 1/2(S),(cid:98)σ ∈ H−1/2(S) and τ ∈ H(div ,T ), v ∈ H 1(T ) we deﬁne
(cid:104)(cid:98)σ|∂T , v(cid:105)∂T .

(cid:104)(cid:98)u , τ · n(cid:105)S :=

L2(Ω) + ε1/2(cid:107)∇w(cid:107)2
L2(Ω) +ε(cid:107)div q(cid:107)2
(cid:88)

(cid:110)
(cid:110)
((cid:107)w(cid:107)2
((cid:107)q(cid:107)2

(cid:88)

(cid:111)

(cid:111)

(2b)

(2a)

.

.

,

,

(cid:104)(cid:98)u|∂T , τ · nT(cid:105)∂T ,
(cid:104)(cid:98)u , τ · n(cid:105)S = (cid:104)(cid:98)u , τ · nΩ(cid:105)Γ

(cid:104)(cid:98)σ , v(cid:105)S :=
and (cid:104)(cid:98)σ , v(cid:105)S = (cid:104)(cid:98)σ , v(cid:105)Γ.

T∈T

T∈T

In particular, for functions in conforming spaces, i.e., τ ∈ H(div , Ω), v ∈ H 1(Ω), we have

2.3. DPG and ultra-weak variational formulation. In this section we recall the DPG formu-
lation of [16]. To this end, let T be a partition of Ω with skeleton S. Deﬁne the vector spaces

(cid:101)U := L2(Ω) × (L2(Ω))d × L2(Ω) × H 1/2(S) × H 1/2(S) × H−1/2(S) × H−1/2(S),
U := {(u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ (cid:101)U : (cid:98)ua|Γ =(cid:98)ub|Γ},
U0 := {(u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ (cid:101)U : (cid:98)ua|Γ = 0 =(cid:98)ub|Γ} ⊆ U,

V := H 1(T ) × H(div ,T ) × H 1(∆,T ),

where in V we introduce the norm
V := ε−1(cid:107)µ(cid:107)2
+ (cid:107)v(cid:107)2

(cid:107)(µ, τ , v)(cid:107)2

L2(Ω) + (cid:107)∇T µ(cid:107)2
L2(Ω) + ε1/2(cid:107)∇T v(cid:107)2

L2(Ω) + ε−1/2(cid:107)τ(cid:107)2

L2(Ω) + (cid:107)divT τ(cid:107)2

L2(Ω)

L2(Ω) + ε3/2(cid:107)∆T v(cid:107)2

L2(Ω).

This norm is induced by the inner product (cid:104)· ,·(cid:105)V .
system

Given the right-hand side f ∈ L2(Ω), we rewrite the interior problem (1a) as the ﬁrst order

ρ − div σ = 0,

ε−1/4σ − ∇u = 0, −ε3/4ρ + u = f.

Testing these equations with v = (µ, τ , v) ∈ V and integration by parts leads to the ultra-weak

formulation: Find u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ U such that

(3a)

(3b)

(3c)

(ρ , µ) + (σ ,∇T µ) − (cid:104)(cid:98)σa , µ(cid:105)S = 0,
ε−1/4(σ , τ ) + (u , divT τ ) − (cid:104)(cid:98)ua , τ · n(cid:105)S = 0,
ε3/4(σ ,∇T v) − ε3/4(cid:104)(cid:98)σb , v(cid:105)S + (u , v)
+ε5/4(ρ , ∆T v) + ε1/4(σ ,∇T v) − ε1/2(cid:104)(cid:98)ub ,∇T v · n(cid:105)S

(cid:41)

4

= (f , v − ε1/2∆T v)

holds for all v = (µ, τ , v) ∈ V . The left-hand side of (3) gives rise to the bilinear form, resp.
functional

b(u, v) := (ρ , µ) + (σ ,∇T µ) − (cid:104)(cid:98)σa , µ(cid:105)S + ε−1/4(σ , τ ) + (u , divT τ ) − (cid:104)(cid:98)ua , τ · n(cid:105)S

+ ε3/4(σ ,∇T v) − ε3/4(cid:104)(cid:98)σb , v(cid:105)S + (u , v),
+ ε5/4(ρ , ∆T v) + ε1/4(σ ,∇T v) − ε1/2(cid:104)(cid:98)ub ,∇T v · n(cid:105)S

(4a)

(4b)

LV (v) := (f , v − ε1/2∆T v)

for u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ U , v = (µ, τ , v) ∈ V .

We deﬁne the (weighted) trial-to-test operator Θβ : U → V with (ﬁxed) β > 0 by the relations

(5)
For the analysis we make use of the strong form of (3) with operator B : U → V (cid:48), i.e.,

Θβ = βΘ and (cid:104)Θu , w(cid:105)V = b(u, w)

for all w ∈ V.

Bu = LV

in V (cid:48).

We stress that B has a non-trivial kernel due to missing boundary conditions. These will be
handled by the transmission conditions (1c)–(1d) and the exterior problem (1b) with radiation
condition (1e). For convenience, we introduce the following restriction operators

Recall that by deﬁnition of the space U we have that (cid:98)ua|Γ = (cid:98)ub|Γ. We directly obtain that these

with (cid:63) ∈ {a, b}.

operators are bounded if we equip H±1/2(Γ) with the norms

γ : U → H 1/2(Γ) × H−1/2(Γ),
γ0 : U → H 1/2(Γ),
γ(cid:63)
n : U → H−1/2(Γ),

(cid:107)(cid:98)u(cid:107)1/2,Γ := inf
(cid:107)(cid:98)σ(cid:107)−1/2,Γ := inf

(cid:110)
(cid:110)
((cid:107)w(cid:107)2
((cid:107)q(cid:107)2

L2(Ω) + ε1/2(cid:107)∇w(cid:107)2
L2(Ω) + ε(cid:107)div q(cid:107)2

γ(cid:63)

γu := ((cid:98)ua|Γ,(cid:98)σa|Γ),
γ0u :=(cid:98)ua|Γ,
nu :=(cid:98)σ(cid:63)|Γ
(cid:111)
L2(Ω))1/2 : w ∈ H 1(Ω),(cid:98)u = w|Γ
L2(Ω))1/2 : q ∈ H(div , Ω),(cid:98)σ = q · nΩ|Γ

,

(cid:111)

.

However, as we use boundary integral operators to tackle the exterior Laplace problem (1b), (1e),
we make use of the canonical trace norms (associated to the Laplacian)

(cid:107)(cid:98)u(cid:107)H 1/2(Γ) := inf(cid:8)
(cid:107)(cid:98)σ(cid:107)H−1/2(Γ) := inf(cid:8)

(cid:107)w(cid:107)H 1(Ω) : w ∈ H 1(Ω),(cid:98)u = w|Γ
(cid:107)q(cid:107)H(div ,Ω) : q ∈ H(div , Ω),(cid:98)σ = q · nΩ|Γ

(cid:9) .

(cid:9) ,

Still we have (non-uniform) boundedness of the restriction operators, since (cid:107)(cid:98)u(cid:107)H 1/2(Γ) ≤ ε−1/4(cid:107)(cid:98)u(cid:107)1/2,Γ
resp. (cid:107)(cid:98)σ(cid:107)H−1/2(Γ) ≤ ε−1/2(cid:107)(cid:98)σ(cid:107)−1/2,S. Also note that (cid:107)(cid:98)σ(cid:107)H−1/2(Γ) (cid:39) supv∈H 1/2(Γ)(cid:104)(cid:98)σ , v(cid:105)Γ/(cid:107)v(cid:107)H 1/2(Γ).

2.4. Boundary integral operators. The exterior part of problem (1) will be dealt with by bound-
ary integral operators. To this end we need some further deﬁnitions. The fundamental solution of
the Laplacian is

Taking the trace and normal derivative leads to the three boundary integral operators

∂nΩ(y)G(x − y)v(y) dsy,

x ∈ Rd \ Γ.

W := −∂nΩ(cid:101)K.

and the corresponding single layer and double layer potentials are

(cid:90)

(cid:101)Vφ(x) :=

(6)

G(x − y)φ(y) dsy,

Γ

V := γΩ(cid:101)V,

G(z) :=

(d = 2),
(d = 3),

(cid:40)
− 1
2π log |z|
1
|z|

1
4π

(cid:90)
(cid:101)Kv(x) :=
K := 1/2 + γΩ(cid:101)K,

Γ

5

They are the single layer, double layer, and hypersingular operators, respectively. The adjoint op-
erator of K is denoted by K(cid:48). These operators are linear and bounded as mappings V : H−1/2(Γ) →
H 1/2(Γ), K : H 1/2(Γ) → H 1/2(Γ), K(cid:48) : H−1/2(Γ) → H−1/2(Γ), and W : H 1/2(Γ) → H−1/2(Γ). We
note that here holds ker(W) = span{1} = ker(K + 1

2 ) and

(cid:107)v(cid:107)2

H 1/2(Γ)

(cid:46) (cid:104)Wv , v(cid:105)Γ

for all v ∈ H 1/2(Γ) with (cid:104)1 , v(cid:105)Γ = 0.

Moreover, assume that diam(Ω) < 1 for d = 2. This ensures the coercivity estimate

(cid:107)ψ(cid:107)2

H−1/2(Γ)

(cid:46) (cid:104)ψ ,Vψ(cid:105)Γ

for all ψ ∈ H−1/2(Γ).

have the so-called Calder´on system(cid:18)
Furthermore, for the exterior Cauchy data of the harmonic function uc ∈ H 1

(cid:19)

(cid:19)(cid:18) uc|Γ

∂nΩuc

(cid:18)0
(cid:19)

0

.

=

(7)

2 + K(cid:48)

W 1
2 − K

1

V

For details and proofs we refer to classical references, e.g. [7, 17, 23].

loc(Ωc) (see (1b)) we

2.5. Coupling scheme. We tackle the interior problem (1a) by solving the ultra-weak formula-
tion (3) by the DPG method with optimal test functions

(8)

b(u, Θβv) = LV (Θβv)

for all v ∈ U.

Note that solutions of this equation are not unique. To incorporate the exterior problem (1b) we
make use of the Calder´on system (7) and the transmission conditions (1c)–(1d). To that end deﬁne

c(((cid:98)u,(cid:98)σ), ((cid:98)v,(cid:98)τ )) := (cid:104)W(cid:98)u ,(cid:98)v(cid:105)Γ + (cid:104)( 1

the bilinear form c : (H 1/2(Γ) × H−1/2(Γ)) × (H 1/2(Γ) × H−1/2(Γ)) → R by
2 − K)(cid:98)v + Vε3/4(cid:98)τ(cid:105)Γ.

2 + K(cid:48))ε3/4(cid:98)σ ,(cid:98)v(cid:105)Γ + (cid:104)ε3/4(cid:98)τ , ( 1
2 − K)(cid:98)u + Vε3/4(cid:98)σ(cid:105)Γ(cid:104)1 , ( 1

2 − K)(cid:98)u(cid:105)Γ + (cid:104)ε3/4(cid:98)τ ,Vε3/4(cid:98)σ(cid:105)Γ

+ (cid:104)1 , ( 1

(9)

Then, if u is the solution to the interior problem (1a), the conditions (1c)–(1d) yield
for all v ∈ U

c((u|Γ, ε1/4∂nΩu), γv) = c((u0, ε−3/4φ0), γv) =: Lca(γv)

(10)
and our coupling scheme reads as follows: Find u ∈ U such that
(11)

b(u, Θβv) + ε−1/2c(γu, γv) = LV (Θβv) + ε−1/2Lca(γv)

for all v ∈ U.

The discrete formulation follows immediately by replacing U with some ﬁnite dimensional subspace
Uhp ⊆ U : Find uhp ∈ U such that
(12)

b(uhp, Θβv) + ε−1/2c(γuhp, γv) = LV (Θβv) + ε−1/2Lca(γv)

for all v ∈ Uhp.

The weights ε−1/2 stem from our analysis and are due to the fact that one has to relate the norm
of the kernel of B corresponding to the interior problem with the norm associated to the exterior
problem.

We introduce the following norms on U :
(cid:107)u(cid:107)2
L2(Ω) + ε(cid:107)ρ(cid:107)2

L2(Ω) + (cid:107)σ(cid:107)2

ε,1 := (cid:107)u(cid:107)2

L2(Ω)

L2(Ω) + (cid:107)σ(cid:107)2

+ ε3/2(cid:107)(cid:98)ua(cid:107)2
1/2,S + ε(cid:107)(cid:98)ub(cid:107)2
1/2,S + ε3/2(cid:107)(cid:98)σa(cid:107)2
−1/2,S + ε5/2(cid:107)(cid:98)σb(cid:107)2
1/2,S + ε−1/2(cid:107)(cid:98)ub(cid:107)2
1/2,S + (cid:107)(cid:98)σa(cid:107)2
−1/2,S + ε1/2(cid:107)(cid:98)σb(cid:107)2
+ (cid:107)(cid:98)ua(cid:107)2
ε,j + ε−1/2(cid:16)
(cid:107)(cid:98)ua(cid:107)2
H 1/2(Γ) + ε3/2(cid:107)(cid:98)σa(cid:107)2
V (cid:48) + ε−1/2((cid:104)W(cid:98)ua ,(cid:98)ua(cid:105)Γ + (cid:104)ε3/4(cid:98)σa ,Vε3/4(cid:98)σa(cid:105)Γ + |(cid:104)1 , ( 1

L2(Ω) + ε(cid:107)ρ(cid:107)2

H−1/2(Γ)

(cid:17)

L2(Ω)

−1/2,S,
for j = 1, 2,

−1/2,S,

6

(cid:107)u(cid:107)2

ε,2 := (cid:107)u(cid:107)2

|||u|||2
(cid:107)u(cid:107)2

j := (cid:107)u(cid:107)2
E := (cid:107)Bu(cid:107)2

2 − K)(cid:98)ua + Vε3/4(cid:98)σa(cid:105)Γ|2).

The following is our main result.

Theorem 1. In the case d = 2 assume that diam(Ω) < 1. There exists β0 > 0 that depends only on
Ω such that for all β ≥ β0 the following holds: Problems (1) and (11) are equivalent and uniquely
solvable. More precisely, let (u, uc) be the solution to (1) and deﬁne

u := (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) with σ := ε1/4∇u, ρ := div (σ),(cid:98)u(cid:63) := u|S,(cid:98)σ(cid:63) := σ · n|S

for (cid:63) ∈ {a, b}. (Here, the notation u|S and σ · n|S is to be understood in the product sense of the
spaces H 1/2(S) and H−1/2(S), respectively.) Then, u solves (11). On the other hand, if u solves
(i) The bilinear forms are bounded in the sense that

(11), then (u, uc) with uc := (cid:101)K((cid:98)u(cid:63)|Γ − u0) −(cid:101)V(ε3/4(cid:98)σ(cid:63)|Γ − φ0) solves (1).
b(u, Θβv) + ε−1/2c(γu, γv) (cid:46) max{β, 1}(cid:107)u(cid:107)E(cid:107)v(cid:107)E

(13a)
for all u, v ∈ U .
(ii) The bilinear form b(·, Θβ(·)) + ε−1/2c(γ(·), γ(·)) is coercive: For all u ∈ U holds
(13b)

(cid:46) b(u, Θβu) + ε−1/2c(γu, γu).

(cid:107)u(cid:107)2

E

(iii) There holds

(13c)

|||u|||1 (cid:46) (cid:107)u(cid:107)E (cid:46) |||u|||2

for all u ∈ U.

A proof of this theorem will be given in Section 3.1. The following corollary is a direct consequence

of Theorem 1 and the Lax-Milgram lemma.
Corollary 2. Let the assumptions of Theorem 1 hold and let Uhp ⊆ U be a ﬁnite dimensional
subspace. Denote by u ∈ U the solution of (11) and by uhp ∈ Uhp the solution of (12). Then,
(14)

inf

|||u − uhp|||1 (cid:46) max{β, 1}

inf

vhp∈Uhp (cid:107)u − vhp(cid:107)E (cid:46) max{β, 1}

vhp∈Uhp |||u − vhp|||2.

(cid:3)

3. Technical results and proof of Theorem 1

In the recent work [13] we have learned that we have to analyze the kernel of B and relate it to

the exterior problem. The candidates of the kernel will be solutions of the problem

−ε∆(cid:101)u +(cid:101)u = 0

in Ω,

(cid:101)u|Γ =(cid:98)u on Γ.

(15)

We refer to these solutions as harmonic extension of(cid:98)u and deﬁne the operator E : H 1/2(Γ) → U by
E(cid:98)u := u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb)
(cid:98)σ(cid:63) = σ · nT|∂T on ∂T, ∀T ∈ T , (cid:63) ∈ {a, b}.

(cid:26) u ∈ H 1(Ω) : u =(cid:98)u on Γ,

ε(∇u ,∇w) + (u , w) = 0 ∀w ∈ H 1

(cid:98)u(cid:63) = u on S,

σ = ε1/4∇u,

ρ = div σ,

0 (Ω),

with

We can state the following properties of E.

Lemma 3. The operator E : (H 1/2(Γ),(cid:107) · (cid:107)H 1/2(Γ)) → (U,(cid:107) · (cid:107)ε,1) is linear, a right-inverse of γ0,
and bounded in the sense of

(cid:107)E(cid:98)u(cid:107)ε,1 (cid:46) ε−1/4(cid:107)(cid:98)u(cid:107)H 1/2(Γ).

7

L2(Ω) + (cid:107)u(cid:107)2

Proof. By construction we have γ0 E(cid:98)u =(cid:98)u for any (cid:98)u ∈ H 1/2(Γ), showing that E is a right-inverse.
Let E(cid:98)u := u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) denote the components as deﬁned above. The continuity of E

follows from the well-posedness of the Dirichlet problem: The weak formulation of the homogeneous
problem and the Cauchy-Schwarz inequality gives us
ε(cid:107)∇u(cid:107)2

L2(Ω) = ε(cid:104)∂nΓu ,(cid:98)u(cid:105)Γ = ε(∇u ,∇v) + (u , v)

involves u and taking the inﬁmum over all extensions v ∈ H 1(Ω) we obtain

for any extension v ∈ H 1(Ω) with v|Γ = (cid:98)u. Dividing by the term of the right-hand side which
Note that (cid:107)(cid:98)u(cid:63)(cid:107)2
(cid:107)E(cid:98)u(cid:107)2

L2(Ω))1/2 ≤ (cid:107)(cid:98)u(cid:107)1/2,Γ ≤ (cid:107)(cid:98)u(cid:107)H 1/2(Γ).
L2(Ω) and (cid:107)(cid:98)σ(cid:63)(cid:107)2
1/2,S + ε(cid:107)(cid:98)ub(cid:107)2

−1/2,S + ε5/2(cid:107)(cid:98)σb(cid:107)2

L2(Ω))1/2(ε(cid:107)∇v(cid:107)2

of (cid:107) · (cid:107)ε,1 we get

−1/2,S ≤ (cid:107)σ(cid:107)2

L2(Ω). By deﬁnition

L2(Ω) + ε(cid:107)ρ(cid:107)2

L2(Ω) + ε(cid:107)ρ(cid:107)2

1/2,S ≤ (cid:107)u(cid:107)2

L2(Ω) + (cid:107)σ(cid:107)2

L2(Ω) + (cid:107)u(cid:107)2

L2(Ω) + (cid:107)v(cid:107)2

(ε(cid:107)∇u(cid:107)2

L2(Ω) + (cid:107)u(cid:107)2

≤ (ε(cid:107)∇u(cid:107)2

L2(Ω))1/2

−1/2,S

L2(Ω) + (cid:107)σ(cid:107)2

+ ε3/2(cid:107)(cid:98)ua(cid:107)2
ε,1 := (cid:107)u(cid:107)2
(cid:46) (cid:107)u(cid:107)2

L2(Ω) + (cid:107)σ(cid:107)2

L2(Ω) + ε(cid:107)ρ(cid:107)2

L2(Ω)

1/2,S + ε3/2(cid:107)(cid:98)σa(cid:107)2
L2(Ω) (cid:39) ε−1/2(cid:16)

L2(Ω).

(cid:107)u(cid:107)2

L2(Ω) + ε(cid:107)∇u(cid:107)2

L2(Ω)

(cid:17)

.

(cid:3)

(cid:107)E(cid:98)u(cid:107)2

Therefore, using σ = ε1/4∇u, ρ = ε1/4∆u = ε−3/4u, we have

ε,1 (cid:39) (cid:107)u(cid:107)2

Thus, (cid:107)E(cid:98)u(cid:107)ε,1 (cid:46) ε−1/4(cid:107)(cid:98)u(cid:107)H 1/2(Γ).

L2(Ω) + ε1/2(cid:107)∇u(cid:107)2

L2(Ω) + ε−1/2(cid:107)u(cid:107)2

Lemma 4. There holds ker B = E H 1/2(Γ) and, in particular,

|||u − E γ0u|||1 (cid:46) (cid:107)Bu(cid:107)V (cid:48)

for all u ∈ U.

The involved constant depends only on Ω but not on ε.
Proof. We note that E H 1/2(Γ) ⊆ ker B follows by construction of the ultra-weak formulation (3),
i.e., integration by parts.
To show the other inclusion, note that γ0(u−E γ0u) = 0, hence, u−E γ0u ∈ U0. Recall from [16,

Theorem 1] that

(cid:107)u0(cid:107)ε,1 (cid:46) (cid:107)Bu0(cid:107)V (cid:48)

for all u0 ∈ U0.

Since E γ0u ∈ ker B we have

(cid:107)u − E γ0u(cid:107)ε,1 (cid:46) (cid:107)B(u − E γ0u)(cid:107)V (cid:48) = (cid:107)Bu(cid:107)V (cid:48)

Choosing u ∈ ker B shows u = E γ0u ∈ E H 1/2(Γ).

for all u ∈ U.

(cid:3)

The following norm equivalence follows by a standard compactness argument. Similar results for

classical coupling methods can be found in [2].

Lemma 5. In the case d = 2 assume that diam(Ω) < 1. There holds
H−1/2(Γ) (cid:39) (cid:104)Wu , u(cid:105)Γ + (cid:104)φ ,Vφ(cid:105)Γ + |(cid:104)1 , ( 1

H 1/2(Γ) + (cid:107)φ(cid:107)2

(cid:107)u(cid:107)2

2 − K)u + Vφ(cid:105)Γ|2

for all (u, φ) ∈ H 1/2(Γ) × H−1/2(Γ). In particular,

(cid:107)u(cid:107)2

H 1/2(Γ) + (cid:107)ε3/4φ(cid:107)2

H−1/2(Γ) (cid:39) (cid:104)Wu , u(cid:105)Γ + (cid:104)ε3/4φ ,Vε3/4φ(cid:105)Γ + |(cid:104)1 , ( 1

2 − K)u + Vε3/4φ(cid:105)Γ|2

and the involved constants depend only on Γ.

We shall make use of the following bound for the H−1/2(Γ) norm.

8

(cid:3)

Lemma 6. There holds

(cid:46) (cid:107)Bu(cid:107)V (cid:48) + (cid:107)u(cid:107)ε,1

ε1/2(cid:107)γa

nu(cid:107)H−1/2(Γ)

for all u ∈ U.

Proof. For given (cid:101)µ ∈ H 1/2(Γ) let µ ∈ H 1(Ω) be its extension with µ|Γ = (cid:101)µ and (cid:107)µ(cid:107)H 1(Ω) =
(cid:107)(cid:101)µ(cid:107)H 1/2(Γ). Since µ ∈ H 1(Ω) there holds
Let u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ U . Then,

(cid:104)(cid:98)σa ,(cid:101)µ(cid:105)Γ = (cid:104)(cid:98)σa , µ(cid:105)S = −(cid:104)(cid:98)σa ,−µ(cid:105)S + (σ ,∇T (−µ)) + (ρ ,−µ) + (σ ,∇T µ) + (ρ , µ)

(cid:104)µ , τ · n(cid:105)S = 0 for all τ ∈ H(div , Ω) with τ · nΩ|Γ = 0.

L2(Ω))1/2(cid:107)µ(cid:107)H 1(Ω)
Moreover, note that with the deﬁnition of the test norm (cid:107) · (cid:107)V we get

≤ b(u, (0,−µ, 0)) + ((cid:107)σ(cid:107)2

L2(Ω) + (cid:107)ρ(cid:107)2

This leads

(cid:107)γa

(cid:101)µ∈H 1/2(Γ)
nu(cid:107)H−1/2(Γ) (cid:39) sup
≤ ε−1/2

(cid:107)µ(cid:107)2

H 1(Ω) ≥ ε(cid:107)(µ, 0, 0)(cid:107)2
V .

nu ,(cid:101)µ(cid:105)Γ
(cid:107)(cid:101)µ(cid:107)H 1/2(Γ)

(cid:104)γa

= sup

µ∈H 1(Ω)

(cid:104)γa
nu , µ|Γ(cid:105)Γ
(cid:107)µ(cid:107)H 1(Ω)

sup

µ∈H 1(Ω)

b(u, (−µ, 0, 0))
(cid:107)(−µ, 0, 0)(cid:107)V

+ ((cid:107)σ(cid:107)2

L2(Ω) + (cid:107)ρ(cid:107)2

L2(Ω))1/2.

Extending the supremum over all functions in V and using the deﬁnition of (cid:107)u(cid:107)ε,1, this ﬁnishes the
(cid:3)
proof.

3.1. Proof of Theorem 1. Integration by parts and the Calder´on system (7) show that the unique
solution u of (1) as deﬁned in the theorem also solves problem (11). It remains to prove that (11)
is uniquely solvable. To that end, we prove boundedness (i) and strong coercivity (ii) below. Then,
by the Lax-Milgram lemma we have a unique solution of (11), which also holds in the discrete
case (12).
Proof of (i): Boundedness in the norm (cid:107) · (cid:107)E is straightforward: Note that b(u, Θβv) deﬁnes
a symmetric, semi-positive deﬁnite bilinear form. Therefore, we can apply the Cauchy-Schwarz
inequality

|b(u, Θβv)| ≤ b(u, Θβu)1/2b(v, Θβv)1/2 = β(cid:107)Bu(cid:107)V (cid:48)(cid:107)Bv(cid:107)V (cid:48).

Then, the mapping properties of the boundary integral operators from Section 2.4 yield

|c(γu, γv)| (cid:46) ((cid:107)γ0u(cid:107)2

H 1/2(Γ) + (cid:107)ε3/4γa

nu(cid:107)2

H−1/2(Γ))1/2((cid:107)γ0v(cid:107)2

H 1/2(Γ) + (cid:107)ε3/4γa

nv(cid:107)2

H−1/2(Γ))1/2.

Together with Lemma 5 this gives

Proof of (ii):
identity

|b(u, Θβv)| + ε−1/2|c(γu, γv)| (cid:46) max{β, 1}(cid:107)u(cid:107)E(cid:107)v(cid:107)E.
Let u = (u, σ, ρ,(cid:98)ua,(cid:98)ub,(cid:98)σa,(cid:98)σb) ∈ U . The deﬁnition of the norm (cid:107) · (cid:107)E and the
2 − K)(cid:98)ua(cid:105)Γ
(cid:104)ε3/4(cid:98)σa ,(cid:98)ua(cid:105)Γ = (cid:104)( 1

2 + K(cid:48))ε3/4(cid:98)σa ,(cid:98)ua(cid:105)Γ + (cid:104)ε3/4(cid:98)σa , ( 1

9

imply

(cid:107)u(cid:107)2

E = (cid:107)Bu(cid:107)2
= (cid:107)Bu(cid:107)2

+ ε−1/2((cid:104)( 1

2 + K(cid:48))ε3/4(cid:98)σa ,(cid:98)ua(cid:105)Γ + (cid:104)ε3/4(cid:98)σa , ( 1

V (cid:48) + ε−1/2((cid:104)W(cid:98)ua ,(cid:98)ua(cid:105)Γ + (cid:104)ε3/4(cid:98)σa ,Vε3/4(cid:98)σa(cid:105)Γ + |(cid:104)1 , ( 1
V (cid:48) + ε−1/2((cid:104)W(cid:98)ua ,(cid:98)ua(cid:105)Γ + (cid:104)ε3/4(cid:98)σa ,Vε3/4(cid:98)σa(cid:105)Γ + |(cid:104)1 , ( 1
V (cid:48) + ε−1/2c(γu, γu) − ε1/4(cid:104)(cid:98)σa ,(cid:98)ua(cid:105)Γ

2 − K)(cid:98)ua + Vε3/4(cid:98)σa(cid:105)Γ|2)
2 − K)(cid:98)ua + Vε3/4(cid:98)σa(cid:105)Γ|2)
2 − K)(cid:98)ua(cid:105)Γ) − ε−1/2(cid:104)ε3/4(cid:98)σa ,(cid:98)ua(cid:105)Γ
n E γ0u ,(cid:98)ua(cid:105)Γ
n E γ0u ,(cid:98)ua(cid:105)Γ ≥ 0. We apply Lemma 6, Lemma 4 and Young’s inequality

V (cid:48) + ε−1/2c(γu, γu) + (cid:104)ε1/2(γa
V (cid:48) + ε−1/2c(γu, γu) + (cid:104)ε1/2(γa
V (cid:48) + ε−1/2c(γu, γu) + ε1/2(cid:107)γa

n E γ0u −(cid:98)σa) , ε−1/4(cid:98)ua(cid:105)Γ − ε1/4(cid:104)γa
n E γ0u −(cid:98)σa) , ε−1/4(cid:98)ua(cid:105)Γ
n E γ0u −(cid:98)σa(cid:107)H−1/2(Γ)(cid:107)ε−1/4(cid:98)ua(cid:107)H 1/2(Γ).
(cid:46) (cid:107)Bu(cid:107)V (cid:48)(cid:107)ε−1/4(cid:98)ua(cid:107)H 1/2(Γ)
2(cid:107)ε−1/4(cid:98)ua(cid:107)2
≤ δ−1
≤ δ−1

2 (cid:107)Bu(cid:107)2
2 (cid:107)Bu(cid:107)2

V (cid:48) + δ
V (cid:48) + δ

2(cid:107)u(cid:107)2
E.

n E γ0u −(cid:98)σa(cid:107)H−1/2(Γ)(cid:107)ε−1/4(cid:98)ua(cid:107)H 1/2(Γ)

H 1/2(Γ)

= (cid:107)Bu(cid:107)2
= (cid:107)Bu(cid:107)2
≤ (cid:107)Bu(cid:107)2
≤ (cid:107)Bu(cid:107)2

ε1/2(cid:107)γa

Here, we also used that (cid:104)γa
with parameter δ > 0 to estimate the last term on the right-hand side by

Putting everything together we get

(cid:46)(cid:16)

(cid:107)u(cid:107)2

E

1 + δ−1

2

(cid:17)

(cid:107)Bu(cid:107)2
(cid:46) β(cid:107)Bu(cid:107)2

V (cid:48) + ε−1/2c(γu, γu) + δ

2(cid:107)u(cid:107)2
E.

Subtracting the last term for a suﬃciently small δ > 0 this proves the existence of β0 > 0 such
that, for all β ≥ β0, there holds (cid:107)u(cid:107)2
Proof of (iii): We start with the lower bound in (13c). By the triangle inequality, Lemma 4,
Lemma 3, and Lemma 5 we obtain

V (cid:48) + ε−1/2c(u, u) = b(u, Θβu) + ε−1/2c(u, u).

E

(16)

(cid:107)u(cid:107)2

ε,1

(cid:46) (cid:107)u − E γ0u(cid:107)2

ε,1 + (cid:107)E γ0u(cid:107)2

ε,1

(cid:46) (cid:107)Bu(cid:107)2

V (cid:48) + ε−1/2(cid:107)γ0u(cid:107)2

H 1/2(Γ)

(cid:46) (cid:107)u(cid:107)2

E,

and it remains to show the upper bound in (13c). By [16, Lemma 3] we have

|b(u, Θv)| (cid:46) (cid:107)u(cid:107)ε,2(cid:107)Θv(cid:107)V .

The deﬁnition (5) of Θ shows
(cid:107)Θv(cid:107)2

V = (cid:104)Θv , Θv(cid:105)V = b(v, Θv) (cid:46) (cid:107)v(cid:107)ε,2(cid:107)Θv(cid:107)V ,

and therefore boundedness b(u, Θv) (cid:46) (cid:107)u(cid:107)ε,2(cid:107)v(cid:107)ε,2 for all u, v ∈ U . Then, as in the proof of (i)
above, boundedness of the involved integral operators show the upper bound. This ﬁnishes the
(cid:3)
proof of Theorem 1.

4. Numerical experiments

In this section we present diﬀerent numerical experiments of our coupling method in two dimen-
sions. In order to show numerically the reliability and robustness of our method for the interior
singularly perturbed problem, the ﬁrst example (Section 4.1) treats a problem with known solution
in the interior and exterior. Also, for the second problem (Section 4.2) we choose a known solution
that exhibits a singularity at a boundary vertex. Lastly, similar to [16], we consider a problem
where the source term f has support within Ω and vanishes on the boundary. In particular, we do
not only expect layers at the boundary but also in the interior (away from the boundary), which
are not aligned with the meshes.

10

Throughout, we consider regular triangulations T with compact triangles. As mesh reﬁnement
strategy we use the newest-vertex bisection (NVB) that preserves shape regularity in the following
sense: Given a sequence T0,T1, . . . of triangulations, where T(cid:96) is a reﬁnement of T(cid:96)−1, it holds

diam(T )2

|T|

sup
T∈T(cid:96)

≤ C sup
T∈T0

diam(T )2

|T|

for all (cid:96) ∈ N0,

where C does not depend on (cid:96). Given a triangulation T , we deﬁne P p(T ) as the space of all
T -piecewise polynomials of order less than or equal to p ∈ N0. The choice for the basis of P p(T ) is
based on Lobatto shape functions as presented in [30, Section 2.2.2–2.2.3]. In the same manner we
deﬁne the S-piecewise polynomial space P p(S). Moreover, set Sp(S) := P p(S) ∩ C(S). We stress
that the skeleton S restricted to Γ induces a triangulation of the boundary. We denote by P p(S|Γ)
the space of S|Γ-piecewise polynomials of degree less than or equal to p ∈ N0 and Sp(S|Γ) :=
P p(S|Γ) ∩ C(Γ). For the lowest-order cases we have P 0(S)|Γ = P 0(S|Γ) and S1(S)|Γ = S1(S|Γ).
The continuous trial space U is replaced by

Uhp :=(cid:0)P 0(T ) × [P 0(T )]2 × P 0(T ) × S1(S) × S1(S) × P 0(S) × P 0(S)(cid:1)

∩ U.

Moreover, we replace the trial-to-test operator Θβ by its discrete analogue Θhp,β deﬁned by the
relation

(cid:104)Θhp,βuhp , vhp(cid:105)V = βb(uhp, vhp)

for all uhp ∈ Uhp, vhp ∈ Vhp,

where

Vhp := P 2(T ) × [P 2(T )]2 × P 4(T ).

That means, we replace V by the discrete subspace Vhp. In the literature this is often called practical
DPG. For the ﬁrst two components the choice of polynomial degree is based on [14], whereas for
the third component we choose a polynomial degree of four, since we also test with the Laplacian
of the test functions. We choose β = 1 for all our experiments.

To steer the adaptive mesh-reﬁnement, we use the local indicators

estΩ(T )2 := (cid:107)R−1

estΓ(E)2 := ε−1/2(cid:16)

hp (LV − Buhp)(cid:107)2
V |T

,

2 + K(cid:48))(φ0 − ε3/4γnuhp)(cid:107)2
(cid:107)2

2 − K)(u0 − γ0uhp) + V(φ0 − ε3/4γnuhp)(cid:1)
(cid:0)( 1
(cid:107)h1/2(W(u0 − γ0uhp) + ( 1
(cid:107)h1/2∇Γ
(cid:88)

(cid:88)

est2

Ω :=

estΩ(T )2,

est2

Γ :=

estΓ(E)2.

(cid:17)

,

L2(E)

L2(E)

for T ∈ T , E ∈ S|Γ. Here, Rhp : Vhp → V (cid:48)hp denotes the Riesz isomorphism, h denotes the mesh-size
function on the boundary and ∇Γ(·) the arc-length derivative. We deﬁne the overall estimators by

T∈T

E∈S|Γ

Note that estΩ is the typical estimator for DPG problems and can be easily computed. It measures
the error in the interior domain, whereas estΓ is an h-weighted residual-based error estimator that
measures — at least heuristically — the error at the boundary. We mark a minimal set of elements
MΩ
(17)

(cid:96) ⊆ T(cid:96) × S(cid:96)|Γ using the criterion
Γ) ≤

(cid:96) × MΓ

estΩ(T )2 +

(cid:88)

(cid:88)

θ(est2

Ω + est2

estΓ(E)2

T∈MΩ

(cid:96)

E∈MΓ

(cid:96)

11

with marking parameter θ ∈ (0, 1). For the examples where the exact solution (u, uc) is known
(Section 4.1–4.2), we compute the following error quantities (with σ = ε1/4∇u, ρ = ε1/4∆u):

err2

err2

Ω := (cid:107)u − uhp(cid:107)2
Γ := ε−1/2(cid:107)h1/2∇Γ(γ0uhp − u0 − uc|Γ)(cid:107)2

L2(Ω) + (cid:107)σ − σhp(cid:107)2

L2(Ω) + ε(cid:107)ρ − ρhp(cid:107)2

L2(Ω),

L2(Γ) + ε−1/2(cid:107)h1/2(ε3/4γnuhp − φ0 − ∂nΩuc)(cid:107)2

L2(Γ).

All experiments are programmed and conducted in MATLAB, where for the assembling of the

discrete boundary integral operators we use the MATLAB library HILBERT [1].

Figure 1. Error and estimator quantities for diﬀerent values of ε for the example
with smooth solution (Section 4.1).

12

10110210310410510610−310−210−11001011234numberofelements#Tε=10−2errΩerrΓestΩestΓ10110210310410510−310−210−11001011234numberofelements#Tε=10−4errΩerrΓestΩestΓ10110210310410510−210−11001011234numberofelements#Tε=10−6errΩerrΓestΩestΓ10110210310410510−1100101102numberofelements#Tε=10−8errΩerrΓestΩestΓ4.1. Smooth solution. Let Ω = (0, 1

2 ) × (0, 1
(cid:16)
u(x, y) := 8(x3(1 + 4y2) + sin(4πx2)

(18a)

2 ). We choose the exact solution

e−4x/√ε + e−2(1−x)/√ε + e−6y/√ε + e−3(1−2y)/√ε(cid:17)

,

(18b)

uc(x, y) :=

+ 2 cos(πy)(x + y)
x + y − α1 − α2

(x − α1)2 + (y − α2)2 ,

1
10

and compute the data f , u0, φ0. The solution u(x, y) is similar as in [20, 16]. Note that we have
scaled Ω such that diam(Ω) < 1. We set α1 = 0.25 = α2. Then, uc satisﬁes ∆uc = 0 in the exterior
domain.

Figure 2. Ratio errΩ / estΩ of the volume error and volume estimator for the ex-
ample with smooth solution (left, Section 4.1) resp. singular solution (right, Sec-
tion 4.2).

For this experiment we use θ = 1

2 in (17). Figure 1 shows the quantities errΩ, errΓ, estΩ, and estΓ
for ε = 10−j with j ∈ {2, 4, 6, 8}. We start our computations with a coarse initial mesh T0 contain-
ing only four elements and observe that as soon as the boundary layers are resolved our method
leads to optimal convergence rate with respect to the number of volume elements, i.e., (#T(cid:96))−1/2.
Additionally, we observe higher convergence rates for the boundary terms, that is (#T(cid:96))−3/4. For
Γ)1/2, hence, ba-
small ε, the boundary estimator estΓ dominates the overall estimator (est2
sically boundary elements are reﬁned in the beginning of our adaptive loop. This is due to the
scaling factor ε−1/4 in the term estΓ. Nevertheless, after a few steps the volume error dominates.
For ε = 10−8 this happens already when reaching approximately 1000 volume elements, see Fig-
ure 1. The left plot in Figure 2 shows the ratio errΩ / estΩ of the volume error and volume estimator.
We observe that this ratio is close to one when the boundary layers are resolved. In any case, the
numerical results illustrate that the “error in energy norm” estΩ from the domain part robustly
controls the error of the ﬁeld variables, i.e., the bound appears to be uniform in ε. In other words,
the robust design of the DPG scheme, taken from [16], is not adversely aﬀected by the coupling
with boundary elements.

Ω + est2

13

1011021031041051060.20.40.60.81numberofelements#TSmoothsolutionε=10−2ε=10−4ε=10−6ε=10−81011021031041051060.511.52numberofelements#TSingularsolutionε=10−1ε=10−2ε=10−4ε=10−54.2. Singular solution. Let Ω denote the L-shaped domain sketched in Figure 3. In the interior
we prescribe the solution

u(x, y) := CεI2/3(r/√ε) cos(2/3ϕ),

where (r, ϕ) denote the polar coordinates of (x, y) ∈ Ω, and Iν with ν ∈ R denotes the modiﬁed
Bessel function of ﬁrst kind. We choose Cε such that (cid:107)u(cid:107)L∞(Ω) = 1. Note that u is harmonic in
the sense that ε∆u − u = 0 and has a singularity at the reentrant corner (x, y) = (0, 0). Moreover,
a closer look unveils that u ∈ H 5/3−s(Ω) for s > 0. Hence, we expect suboptimal convergence rates
in the case of uniform reﬁnement. Therefore, we stick to an adaptive strategy, where we choose
θ = 3
4 in (17). For the solution in the exterior we take the same function as in (18b) with constants
α1 = 0.125 and α2 = 0.

Figure 3. L-shaped domain and its initial triangulation T0 with 12 volume elements.

In Figure 4 we plot the quantities errΩ, errΓ, estΩ, and estΓ for ε = 10−j with j ∈ {1, 2, 4, 5}. We
make the same observations as for the example from Section 4.1. Furthermore, we stress that for ε
close to 1, the meshes are reﬁned towards the singularity, whereas for 0 < ε < 10−2 the boundary
layers get sharper, and the adaptive algorithm then resolves these layers. The right plot in Figure 2
shows the ratio errΩ / estΩ of the volume error and the volume estimator. Again we observe that
after a few steps in the adaptive algorithm (after the layers are resolved) this ratio is close to one.

4.3. Unknown solution. Again we choose Ω to be the L-shaped domain sketched in Figure 3.
For this experiment we choose the data

(cid:40)

u0 :=

1
2

, φ0 := 0,

f (x, y) :=

1
0

if (x − 0.15)2 + y2 < 1
else

100

.

In particular, for this choice of data we expect a boundary layer (since u0 (cid:54)= f on Γ) and a circular
layer away from the boundary. For this experiment we choose θ = 1
In Figure 5 we plot only the estimators estΩ and estΓ since the exact solution is unknown. As
in the previous examples we observe that all estimator quantities converge with the optimal rate
as soon as the layers are resolved.

2 in (17).

14

−0.4−0.200.20.4−0.4−0.200.20.4xyFigure 4. Error and estimator quantities for diﬀerent values of ε for the example
with singular solution (Section 4.2).

For illustration purposes, Figure 6 shows the solution component uhp for diﬀerent choices of ε

on adaptively reﬁned meshes.

References

[1] M. Aurada, M. Ebner, M. Feischl, S. Ferraz-Leite, T. F¨uhrer, P. Goldenits, M. Karkulik, M. Mayr, and D. Prae-

torius. HILBERT—a MATLAB implementation of adaptive 2D-BEM. Numer. Algorithms, 67(1):1–32, 2014.

[2] M. Aurada, M. Feischl, T. F¨uhrer, M. Karkulik, J. M. Melenk, and D. Praetorius. Classical FEM-BEM coupling

methods: nonlinearities, well-posedness, and adaptivity. Comp. Mech., 51(4):399–419, 2013.

[3] J. Bielak and R. C. MacCamy. Symmetric ﬁnite element and boundary integral coupling methods for ﬂuid-solid

interaction. Quart. Appl. Math., 49(1):107–119, 1991.

[4] D. Broersen and R. Stevenson. A robust Petrov-Galerkin discretisation of convection-diﬀusion equations. Comput.

Math. Appl., 68(11):1605–1618, 2014.

15

10110210310410510610−410−310−210−11001234numberofelements#Tε=10−1errΩerrΓestΩestΓ10110210310410510610−410−310−210−11001011234numberofelements#Tε=10−2errΩerrΓestΩestΓ10110210310410510610−410−310−210−11001011234numberofelements#Tε=10−4errΩerrΓestΩestΓ10110210310410510−410−310−210−11001011234numberofelements#Tε=10−5errΩerrΓestΩestΓFigure 5. Error and estimator quantities for diﬀerent values of ε for the example
with unknown solution (Section 4.3).

[5] D. Broersen and R. Stevenson. A Petrov-Galerkin discretization with optimal test space of a mild-weak formu-

lation of convection-diﬀusion equations in mixed form. IMA J. Numer. Anal., 35(1):39–73, 2015.

[6] J. Chan, N. Heuer, T. Bui-Thanh, and L. Demkowicz. Robust DPG method for convection-dominated diﬀusion
problems II: Adjoint boundary conditions and mesh-dependent test norms. Comput. Math. Appl., 67(4):771–795,
2014.

[7] M. Costabel. Boundary integral operators on Lipschitz domains: Elementary results. SIAM J. Math. Anal.,

19:613–626, 1988.

[8] M. Costabel. A symmetric method for the coupling of ﬁnite elements and boundary elements. In J. R. Whiteman,
editor, The Mathematics of Finite Elements and Applications VI, pages 281–288, London, 1988. Academic Press.
[9] M. Costabel and E. P. Stephan. Coupling of ﬁnite elements and boundary elements for inhomogeneous trans-
mission problems in R3. In J. R. Whiteman, editor, The Mathematics of Finite Elements and Applications VI,
pages 289–296, London, 1988. Academic Press.

[10] L. Demkowicz and J. Gopalakrishnan. Analysis of the DPG method for the Poisson problem. SIAM J. Numer.

Anal., 49(5):1788–1809, 2011.

[11] L. Demkowicz and J. Gopalakrishnan. A class of discontinuous Petrov-Galerkin methods. Part II: Optimal test

functions. Numer. Methods Partial Diﬀerential Eq., 27:70–105, 2011.

[12] L. Demkowicz and N. Heuer. Robust DPG method for convection-dominated diﬀusion problems. SIAM J. Numer.

Anal., 51(5):2514–2537, 2013.

[13] T. F¨uhrer, N. Heuer, and M. Karkulik. On the coupling of DPG and BEM. http://arXiv.org/abs/1508.00630,

2015.

[14] J. Gopalakrishnan and W. Qiu. An analysis of the practical DPG method. Math. Comp., 83(286):537–552, 2014.
[15] N. Heuer and M. Karkulik. DPG method with optimal test functions for a transmission problem. Comput. Math.

Appl., 70(5):1504–1518, 2015.

[16] N. Heuer and M. Karkulik. A robust DPG method for singularly perturbed reaction-diﬀusion problems.

http://arXiv.org/abs/1509.07560, 2015.

16

10110210310410510−510−410−310−210−11003412numberofelements#TestΩ,ε=10−2estΓ,ε=10−2estΩ,ε=10−4estΓ,ε=10−4estΩ,ε=10−6estΓ,ε=10−6estΩ,ε=10−8estΓ,ε=10−8Figure 6. Solution component uhp for diﬀerent values of ε for the example with
unknown solution (Section 4.3) on adaptively reﬁned meshes with 15646 (ε = 10−4),
25384 (ε = 10−5), 33550 (ε = 10−6), resp. 59581 (ε = 10−7) volume elements.

[17] G. C. Hsiao and W. L. Wendland. Boundary Integral Equations. Springer, 2008.
[18] C. Johnson and J.-C. N´ed´elec. On the coupling of boundary integral and ﬁnite element methods. Math. Comp.,

35:1063–1079, 1980.

[19] J. Li and I. M. Navon. Uniformly convergent ﬁnite element methods for singularly perturbed elliptic boundary

value problems. I. Reaction-diﬀusion type. Comput. Math. Appl., 35(3):57–70, 1998.

[20] R. Lin and M. Stynes. A balanced ﬁnite element method for singularly perturbed reaction-diﬀusion problems.

SIAM J. Numer. Anal., 50(5):2729–2743, 2012.

[21] T. Linß. Layer-adapted meshes for reaction-convection-diﬀusion problems, volume 1985 of Lecture Notes in Math-

ematics. Springer-Verlag, Berlin, 2010.

[22] A. Maghnouji and S. Nicaise. Boundary layers for transmission problems with singularities. Electron. J. Diﬀer-

ential Equations, pages No. 14, 16 pp. (electronic), 2006.

[23] W. McLean. Strongly Elliptic Systems and Boundary Integral Equations. Cambridge University Press, 2000.
[24] J. M. Melenk and C. Xenophontos. Robust exponential convergence of hp-FEM in balanced norms for singularly

perturbed reaction-diﬀusion equations. Calcolo, 53(1):105–132, 2016.

[25] S. Nicaise and C. Xenophontos. Finite element methods for a singularly perturbed transmission problem. J.

Numer. Math., 17(4):245–275, 2009.

[26] S. Nicaise and C. Xenophontos. Convergence analysis of an hp ﬁnite element method for singularly perturbed
transmission problems in smooth domains. Numer. Methods Partial Diﬀerential Equations, 29(6):2107–2132,
2013.

[27] H.-G. Roos and M. Schopf. Convergence and stability in balanced norms of ﬁnite element methods on Shishkin

meshes for reaction-diﬀusion problems. ZAMM Z. Angew. Math. Mech., 95(6):551–565, 2015.

17

00.2−0.200.200.51ε=10−400.20.40.60.8100.2−0.200.200.51ε=10−500.20.40.60.8100.2−0.200.200.51ε=10−600.20.40.60.8100.2−0.200.200.51ε=10−700.20.40.60.81[28] H.-G. Roos, M. Stynes, and L. Tobiska. Robust numerical methods for singularly perturbed diﬀerential equations,
volume 24 of Springer Series in Computational Mathematics. Springer-Verlag, Berlin, second edition, 2008.
Convection-diﬀusion-reaction and ﬂow problems.

[29] F.-J. Sayas. The validity of Johnson-N´ed´elec’s BEM-FEM coupling on polygonal interfaces. SIAM J. Numer.

Anal., 47(5):3451–3463, 2009.

[30] P. ˇSol´ın, K. Segeth, and I. Doleˇzel. Higher-order ﬁnite element methods. Studies in Advanced Mathematics.

Chapman & Hall/CRC, Boca Raton, FL, 2004.

[31] C. Xenophontos and S. R. Fulton. Uniform approximation of singularly perturbed reaction-diﬀusion problems
by the ﬁnite element method on a Shishkin mesh. Numer. Methods Partial Diﬀerential Equations, 19(1):89–111,
2003.

Facultad de Matem´aticas, Pontificia Universidad Cat´olica de Chile, Vicku˜na Mackenna 4860, San-

tiago, Chile

E-mail address: {tofuhrer,nheuer}@mat.uc.cl

18

