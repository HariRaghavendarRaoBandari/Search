Model Comparison of a Data-Driven

and a Physical Model for Simulating HVAC Systems

Datong Zhou∗, Qie Hu∗, and Claire J. Tomlin

6
1
0
2

 
r
a

 

M
8
1

 
 
]

Y
S
.
s
c
[
 
 

1
v
1
5
9
5
0

.

3
0
6
1
:
v
i
X
r
a

Abstract— Commercial buildings are responsible for a large
fraction of energy consumption in developed countries, and
therefore are targets of energy efﬁciency programs. Motivated
by the large inherent thermal inertia of buildings, the power
consumption can be ﬂexibly scheduled without compromising
occupant comfort. This temporal ﬂexibility offers opportunities
for the provision of
frequency regulation to support grid
stability. To realize energy savings and frequency regulation,
it is of prime importance to identify a realistic model for
the temperature dynamics of a building. We identify a low-
dimensional data-driven model and a high-dimensional physics-
based model for different spatial granularities and temporal
seasons based on a case study of an entire ﬂoor of Sutardja Dai
Hall, an ofﬁce building on the University of California, Berkeley
campus. A comparison of these contrasting models shows that,
despite the higher forecasting accuracy of the physics-based
model, both models perform almost equally well for energy
efﬁcient control. We conclude that the data-driven model is
more amenable to controller design due to its low complexity,
and could serve as a substitution for highly complex physics-
based models with an insigniﬁcant loss of prediction accuracy
for many applications. On the other hand, our physics-based
approach is more suitable for modeling buildings with ﬁner
spatial granularities.

I. INTRODUCTION

According to [1], residential and commercial buildings
account for up to 40% of the total electricity consumption
in developed countries, with an upward trend. Heating,
ventilation and air-conditioning (HVAC) systems are a major
source of this consumption [2]. Nevertheless, their power
consumption can be ﬂexibly scheduled without compromi-
sing occupant comfort, due to the thermal capacity of build-
ings. As a result, HVAC systems have become the focal
point of research, with the goal of utilizing this source of
consumption ﬂexibility. From the point of view of energy
efﬁciency, researchers have studied optimization of building
control in order to minimize power consumption [3], [4].
More recently, it has been proposed to engage buildings
in supporting the supply quality of electricity and the grid
stability, by participating in the regulation of electricity’s
frequency [5], [6], [7], [8].

All of the above research activities are based on a valid
mathematical model describing the thermal behavior of
buildings. Traditionally, buildings have been modeled with
high-dimensional physics-based models such as resistance-
capacitance (RC) models [9], [10], [11], [12], TRNSYS [13]
and EnergyPlus [14]. These models are motivated by the
thermodynamics of the building and explicitly model the heat
transfer between components of the buildings. The advantage
of such models is their high granularity of temperature
modeling, but a drawback is their high dimensionality which

makes them computationally expensive. On the other hand,
a new direction of research attempts to identify lower-
dimensional, data-driven models, e.g. with Input-Output
models [6] and semiparametric regression [15]. The purpose
is to alleviate the computational complexity in expense for
coarser and less accurate temperature predictions.

A crucial question that arises within these two extremes is
the extent to which the estimated temperature model is com-
patible with controller design. Take Model Predictive Control
(MPC) for example, where the classical physics-based mod-
els require an MPC strategy to be solved online with high
computational demand. Even then, the inherent bilinearity
ensuing from the physics of the HVAC system often requires
robustiﬁcation, in the form of stochastic MPC formulations
with chance constraints [16]. In contrast, regression-based
models provide convenient difference equations that are easy
and fast to use for MPC. A logical question to ask is how
lean a model can be for a reasonable control application,
without trading off too much accuracy and granularity of the
temperature predictions.

To the best of our knowledge, data-driven and physical
models for the identiﬁcation of temperature evolution in
commercial buildings have only been studied in isolation and
on individual testbeds (e.g. [17], [3], [6], [18]). The identiﬁed
models are often validated using simulation data [11] or
experimental data collected under controlled environments,
e.g. without occupants [6]. This makes a comparison of the
performance between these two types of models, for a real
building under normal operation, impossible due to their
different nature.

In this paper, we identify a data-driven model, using
semiparametric regression, and adapt our previous physics-
based model for the same building [18], using a one-year
period of experimental data. We provide a quantitative com-
parison using various metrics, including open-loop prediction
accuracy and closed-loop control strategies. We show that,
despite the higher accuracy of the complex physics-based
model compared to the low-dimensional data-driven model,
the optimal control strategy with respect to HVAC operation
cost while maintaining the thermal comfort of occupants is
almost identical for both systems. This indicates that the
data-driven model provides enough accuracy for controller
design, unless controllers that must maintain building tem-
peratures more accurately or with ﬁner spatial granularities
are needed. Finally, a qualitative analysis of the advantages
and disadvantages of each type of model, together with their
suitability for different applications is provided.

The remainder of this paper is organized as follows: In

Section II, we describe the testbed and the data collected for
our research. Section III presents the identiﬁcation process
for a purely data-driven model with semiparametric regres-
sion, followed by Section IV, which details the procedure
for identifying a physics-based model. Section V will then
compare the performance of the data-driven model and the
physical model under different metrics. We conclude in
Section VI with a summary of our current and intended
future work.

II. PRELIMINARIES

A. Testbed for System Identiﬁcation

We model the temperature evolution of the fourth ﬂoor
of Sutardja Dai Hall (SDH), a building on the University
of California, Berkeley campus. This ﬂoor contains ofﬁces
for research staff and open workspaces for students, and is
divided into six zones for modeling purposes (Figure 1).

The building is equipped with a variable air volume (VAV)
HVAC system that is common to 30% of all U.S. commercial
buildings [19]. The system contains large supply fans which
drive air through heat exchangers, cooling it down to a
desired supply air temperature (SAT), and then distribute air
to VAV boxes located throughout the building. There are 21
VAV boxes located on the fourth ﬂoor that govern the airﬂow
to each room. In addition, the supply air may be reheated at
the VAV box before entering the room.

Fig. 1. Zones for the 4th Floor of Sutardja Dai Hall (SDH)

B. Collection of Experimental Data

We collected 51 weeks of one-minute resolution tempera-
ture data for the six zones along with the airﬂow rates of the
21 VAV boxes, SAT and the outside air temperature from the
simple Measurement and Actuation Proﬁle (sMAP). sMAP
is a protocol that collects, stores and publishes time-series
data from a wide variety of sensors [20], [21]. The hourly
global horizontal solar radiation data recorded at a nearby
weather station is obtained [22], from which the incidence
solar radiation of the four geographic directions is calculated
with the PV LIB toolbox [23]. All collected data are down-
sampled or interpolated, respectively, to 15 minute intervals.
These 51 weeks of data span periods when the building
was under normal operation as well as periods with ex-
citation experiments. For accurate parameter identiﬁcation,
temperatures of neighboring zones should not have strong
correlation [24]. Our testbed is a regular ofﬁce building in
operation, thus forced response experiments were performed
during Saturdays to (a) increase identiﬁability of the building
model; (b) minimize effects due to occupancy on our data,

and thus facilitate subsequent parameter identiﬁcation; (c)
minimize disturbance to building operation [18].

C. Data Splitting

Next, we deﬁne the seasons “fall” (early September until
mid December), “winter” (mid December until late January),
and “spring” (late January until mid May) in order to account
for different occupancy levels during the fall and spring
semesters, and the winter break. After the weeks have been
assigned to the seasons, a random portion of the data in each
season (e.g. we chose 90%) is deﬁned as the training data,
and the remaining weeks to be removed prior to the analysis
are declared as the test set, which will be used to assess
the accuracy of the optimal temperature model ﬁtted on the
training data.

III. DATA-DRIVEN MODEL

We identify a difference equation for the temperature
evolution with semiparametric regression, using the collected
data from the 4th ﬂoor of SDH. Semiparametric regression
in buildings has been proposed by [15], where the authors
chose one week of data to model the temperature evolution
including an exogenous heating load that captures the effect
of occupancy, electric devices, VAV supply air temperature,
outside air temperature, and solar radiation. We extend this
approach by taking into account multiple weeks, which we
separate into three seasons (fall, winter, spring) so as to
characterize the different levels of the exogenous heating
load for different temporal seasons.

A. Lumped Zone

1) Model Setup: In order to facilitate analysis, the entire
4th ﬂoor of SDH is treated as a single zone, with the
scalar temperature x corresponding to the area-averaged zone
temperatures and the input u as the sum of the inﬂow of
all 21 VAV boxes. This lumped model assumes a uniform
temperature on the entire ﬂoor, x, and has been commonly
used in literature [16], [25]. Then, the temperature evolution
is assumed to have the following form:
x(k + 1) = ax(k) + bu(k) + c(cid:62)v(k) + qIG(k) + (k), (1)
where u denotes the total air inﬂow to the entire ﬂoor
(cid:62) the vector of
and v := [vTa, vTs, vsolE, vsolN, vsolS, vsolW]
known disturbances that describe ambient air temperature,
the HVAC system’s supply air temperature and solar radia-
tion from each of the four geographical directions. In addi-
tion, qIG represents the internal gains due to occupancy and
electric devices, and  denotes independent and identically
distributed zero mean noise with constant and ﬁnite variance
which is conditionally independent of x, u, v, and qIG.

2) Smoothing of Time Series: The unknown coefﬁcients
a, b, and c are to be estimated using semiparametric regres-
sion [26], [27]. The qIG term of Equation (1) is treated as
a nonparametric term, so that (1) becomes a partially linear
model. By taking conditional expectations on both sides of
(1), we obtain

estimated positively correlates with all components in v and
negatively correlates with the VAV airﬂow. The range of a
is a consequence of Newton’s Law of Cooling.

To ﬁnd the effect of the VAV inﬂow on the 15-minute tem-
perature evolution, we computed the 15-minute incremental
decreases in temperature ∆x recorded during the excitation
experiments. It is assumed that the large inﬂow u dominates
all other effects such that we can assume

(3)

∆x = x(k + 1) − x(k) = b · u(k)

(6)

ˆx(k + 1) = aˆx(k) + bˆu(k) + c(cid:62)ˆv(k)

+ E [qIG(k)|k] + E [(k)|k] ,

(2)
where the conditional expectations ˆx(·) = E [x(·)|·], ˆu(·) =
E [u(·)|·], and ˆv(·) = E [v(·)|·] are used. Noting that
E [(·)|·] = 0 and assuming E [qIG(·)|·] = qIG(·), subtracting
(2) from (1) gives

x(k + 1) − ˆx(k + 1) = a (x(k) − ˆx(k))
+b (u(k) − ˆu(k)) + c(cid:62) (v(k) − ˆv(k)) + (k).

The unknown internal gains term has been eliminated, and
thus the coefﬁcients a, b, c in (3) can be estimated with any
regression method.
The conditional expectations ˆx(·), ˆu(·) and ˆv(·) are ob-
tained by smoothing the respective time series [15]. We
made use of locally weighted linear regression with a tricube
weight function, where we use k-fold cross-validation to
determine the bandwidth for regression. The error measure
used for in-sample estimates is the Root Mean Squared
(RMS) Error between the measured temperatures ¯x(k) and
the model’s predicted temperatures x(k) over a time horizon
of N steps (e.g. we chose a 24 hour time horizon, N = 96):

(cid:18) 1

N

(cid:80)N
k=1 [¯x(k) − x(k)]2

(cid:19)1/2

RMS error =

.

(4)

3) Bayesian Constrained Least Squares: A main chal-
lenge in identifying the model is that commercial buildings
are often insufﬁciently excited. Take SDH for example,
whose room temperatures under regular operation only vary
within a range of 2◦C and inﬂow of the single VAV boxes
hardly vary at all. To overcome this, data collected during
forced response experiments described in Section II-B was
used in training the model. To further compensate for the
lack of excitation, a Bayesian regression method is used,
which allows our prior knowledge of the building physics to
be incorporated in the identiﬁcation of coefﬁcients. More
speciﬁcally, Gaussian prior distributions are used for the
coefﬁcients a and b, i.e., a ∼ N (µa, Σa) and b ∼ N (µb, Σb),
where N (µ, Σ) denotes a jointly Gaussian distribution with
mean µ and covariance matrix Σ. In addition, a, b and c are
constrained to be identical for the different seasons, since
they model the underlying physics of the building which are
assumed to be invariant throughout the year. Therefore the
coefﬁcient identiﬁcation problem is formulated as follows:
(a − µa)(cid:107)2

(ˆa, ˆb, ˆc) = arg min
a,b,c

(Jf + Jw + Js) + (cid:107)Σ−1/2
−1/2
b

(b − µb)(cid:107)2

a

+ (cid:107)Σ

s.t. Ji =(cid:107)xi(k + 1) − ˆxi(k + 1) − a (xi(k) − ˆxi(k))
− b (ui(k) − ˆui(k)) − c(cid:62) (vi(k) − ˆvi(k))(cid:107)2
for i ∈ {f, w, s},
0 < a < 1, b ≤ 0, c ≥ 0,

(5)
where subscripts f, w, and s represent fall, winter and
spring, respectively. The sign constraints on the parameters
b and c translate into the fact that the temperature to be

for all k during the excitation period. The estimated prior
µb can then be isolated from (6). The prior µa was set as
the optimal ˆa identiﬁed by (5) without the prior terms. The
covariance matrices Σa and Σb were chosen subjectively.

4) Estimation of Internal Gains: With the estimated coef-
ﬁcients ˆa, ˆb, ˆc in hand, the internal gains qIG can be estimated
by manipulating (2):

ˆqIG(k) = ˆx(k + 1) −(cid:16)
(cid:124)

ˆaˆx(k) + ˆbˆu(k) + ˆc(cid:62)ˆv(k)

.

(7)

(cid:123)(cid:122)

E[x(k+1)]

(cid:17)
(cid:125)

This can be interpreted as the difference between the
smoothed temperature ˆx(k + 1) and the predicted expected
temperature E [x(k + 1)]. With the estimated parameter coef-
ﬁcients being constant over the different seasons, a distinct
function of internal gains is estimated for each season by
averaging the estimated weekly gains for a given season.

5) Results: The estimated internal gains for each season,
calculated with (7), are shown in Figure 2. Observe that,

Fig. 2. Estimated Internal Gain qIG from the Data-Driven Model by Season,
Lumped Case
for all three seasons, the internal gains exhibit a daily trend
with local peaks around the late afternoon and local minima
at night. Moreover,
the amplitudes of the internal gains
are considerably smaller during the weekends suggesting a
lighter occupancy. It can further be seen that the magnitude
of the internal gains is smallest for the winter season, which
is in accordance with our intuition since most building
occupants are absent during that period.

Lastly, since the Bayesian Constrained Least Squares al-
gorithm (5) has identiﬁed a set of parameter estimates ˆa, ˆb, ˆc
valid for all three seasons to account for the time-invariant
physics of the building, the temperature predictions are of
the same nature for all three seasons. We thus conclude that
the inherent differences between the seasonal temperature
data are captured by the internal gains and can be compared
between the seasons on a relative level.

Day of WeekMonTueWedThuFriSatSunMonInternal Gain [°C]3.944.14.24.34.44.5fallspringwinterThe identiﬁed models for the different seasons found with

(5) are

x(k + 1) = 0.80 · x(k) − 0.18 · u(k)

+ [0.0019, 0.028, 0] v(k) + qIG,i(k)
= 0.80 · x(k) − 0.18 · u(k)
+ 0.0019 · vTa(k) + 0.028 · vTs(k) + qIG,i(k)

for i ∈ {f, w, s}

(8)
The estimated coefﬁcients of c corresponding to the solar
radiation disturbances are very small (< 10−6) compared to
the other estimated coefﬁcients. Since the temperatures are of
the order 10◦C, air inﬂow around 1 kg/s and solar radiation
about 100 W/m2, the effect of solar radiation on the room
temperature is orders of magnitude less than that of other
factors and hence can be neglected.
The average RMS prediction errors are 0.22◦C, 0.17◦C
and 0.23◦C for fall, winter and spring respectively, showing
that our model predicts the temperature reasonably well.

B. Individual Zones

1) Model Setup: Rather than approximating the entire 4th
ﬂoor of SDH as a single zone, in this section, we identify a
multivariate model that describes the thermodynamic behav-
ior of each of the six individual zones:

x(k + 1) = Ax(k) + Bu(k) + Cv(k) + qIG,i(k)

for i ∈ {f, w, s},

(9)
where x, qIG,i ∈ R6, and the control input u ∈ R6 represent
the temperatures, the internal gains of each zone, and the total
air ﬂow to each zone, respectively. In the lumped case, it was
observed that solar radiation only had a negligible effect on
the building’s thermodynamics compared to the input and
other disturbances, and thus we omit the solar radiation in
the subsequent analysis: v := [vTa, vTs]

(cid:62) ∈ R2.

Inspired by Newton’s Law of Cooling, only adjacent zones
inﬂuence each other’s temperature, which deﬁnes the sparsity
pattern of the coefﬁcient matrices that are to be estimated.
Hence

if i = j or (i, j) adjacent
otherwise.

(10)

(cid:40)(cid:54)= 0,

0,

Aij =

The diagonal elements of A denote autoregressive terms for
zone temperatures, whereas non-diagonal elements describe
the heat exchange between adjacent rooms. The matrix B
is diagonal by deﬁnition of u. The sparsity pattern of C
is found by physical adjacency of a respective zone to an
exterior wall of a given geographic direction.

2) Model Identiﬁcation: The procedure for the estimation
of the parameter matrices ˆA, ˆB, ˆC, and the internal gains
follows (5), but with a modiﬁed choice of the (now matrix-
valued) priors µa and µb: µb and the diagonal entries of µa
are obtained by scaling the corresponding priors from the
lumped zone case in order to account for the thermal mass
of the individual zones, which is smaller than in the lumped
case. The off-diagonal elements of µa, which represent the

heat transfer between adjacent zones, were set to a value
close to zero, according to our calculations with the heat
transfer equation ˙q = U · A · ∆x and [28].

3) Results: Figure 3 shows the estimated internal gains for
the three seasons fall, winter, and spring for the six single
zones, computed with the smoothed time series (7). It can
be seen that the different zones exhibit different magnitudes
of internal gains, with average values of the internal gains
ranging between 1.0◦C and 3.6◦C for different zones and
seasons. Similar to the lumped zone case (Figure 2), daily
peaks of the internal gains proﬁles can be recognized, with a
slight decrease in magnitude on weekend days. The average
prediction RMS error by zone and season are reported in
Table I.

Fig. 3. Estimated Internal Gain qIG from the Data-Driven Model by Zone
and Season, Individual Case

Season

Fall
Winter
Spring

Season

Fall
Winter
Spring

NW
0.98
1.41
0.56

NW
0.61
0.55
0.45

Data-Driven Model

W
0.61
0.34
0.25

W
0.46
0.39
0.28

S
0.28
0.29
0.31

S
0.39
0.34
0.24

E
0.42
0.26
0.71

E
0.39
0.32
0.33

Physics-Based Model

NE
0.28
0.25
0.17

NE
0.20
0.18
0.09

C
0.36
0.21
0.34

C
0.32
0.24
0.19

Mean
0.488
0.460
0.390

Mean
0.396
0.338
0.263

RMS BY ZONE AND SEASON FOR DATA-DRIVEN AND PHYSICS-BASED

TABLE I

MODELS

IV. PHYSICS-BASED MODEL

In this section, we describe the physics-based model-
ing approach proposed in [18], which is a Resistance-
Capacitance (RC) model obtained using the Building
Resistance-Capacitance Modeling (BRCM) MATLAB tool-
box [11]. A main advantage of this approach is that the
resulting model has a small number of parameters, even for a

MonTueWedThuFriSatSunMon11.21.41.61.8NorthwestMonTueWedThuFriSatSunMon11.11.21.3WestfallspringwinterMonTueWedThuFriSatSunMon1.61.71.81.92SouthMonTueWedThuFriSatSunMon11.051.11.151.21.25EastDay of WeekMonTueWedThuFriSatSunMonInternal Gain [°C]3.33.43.53.63.7NortheastMonTueWedThuFriSatSunMon1.41.51.61.7Centercomplex multi-zone building; furthermore, these parameters
have strong physical meaning, which aids in their identiﬁca-
tion.

In this paper, we re-identify the building model using the
same training dataset as used in Section III, and estimate
distinct internal gains functions for different seasons.

A. Model Setup

The physics-based building model has the following form

[18]:

x(k + 1) = Ax(k) + Bvv(k) + BIGfIG(k)

+(cid:80)21

(cid:0)Bxui x(k) + Bvuiv(k)(cid:1)ui(k)

(11a)

i=1
y(k) = Cx(k),

(11b)
where the state vector x ∈ R289 represents temperatures
of all building elements on the 4th ﬂoor and y ∈ R6
represents the average temperatures of the six zones shown
in Figure 1. u ∈ R21 denotes the air inﬂow rates, whose i-th
element ui denotes the inﬂow rate from the i-th VAV box.
v := [vTa, vTs](cid:62) is the disturbance vector, which captures
known disturbances from ambient air temperature and the
HVAC system’s supply air temperature. Note that from our
previous studies, heat gains due to solar radiation are orders
of magnitude less than those caused by other disturbances
and inputs and hence, are not included here. Finally, fIG(k) :
N → R6 captures internal gains in each of the six zones on
the 4th ﬂoor and consists of two terms:

fIG(k) = f c

IG + f v

IG,m(k) for m ∈ {f, w, s},

(12)

where f c
IG is an unknown constant vector representing back-
ground heat gains due to idle appliances such as computers
IG,m(·) for m ∈ {f, w, s}, are
and printers. Functions f v
unknown nonparametric functions that capture the time-
varying heat gain due to occupancy, equipment and other
unmodeled uncertainties such as reheating at the VAV boxes
in fall, winter and spring, respectively. The system matrices
A, Bv, BIG, Bxui and Bvui are functions of tuning pa-
rameters: the window heat transmission coefﬁcient (Uwin),
the convection coefﬁcients of the interior wall (γIW), the
exterior wall (γEW), the ﬂoor (γﬂoor), and the ceiling (γceil).

Deﬁne γ := (cid:2)Uwin, γIW, γEW, γﬂoor, γceil, f c(cid:62)

(cid:3)(cid:62) ∈ R11, then

to identify the physics-based model, we need to estimate the
parameter vector γ as well as the functions f v

IG,m(·).

Next, we describe our approach for identifying this model.

IG

B. Model Identiﬁcation

For a fair comparison, the same data used to train and
test the data-driven model is used to train and validate the
physics-based model. The model identiﬁcation process is
performed in two steps: First, the subset of the training
data collected during weekends is used to estimate the
IG,m(·)
parameters, γ. Second, the nonparametric functions f v
are estimated from the complete training dataset.

1) Parameter Estimation: For parameter estimation pur-
IG,m(·) = 0 during the weekend days, and
poses, we ﬁrst set f v
evaluate them at a later point (Equations (16) and (17)). With
IG,m(·) = 0, (11) reduces to a purely parametric model:
f v
x(k + 1) = Ax(k) + Bvv(k) + BIGf c
IG

(cid:0)Bxuix(k) + Bvuiv(k)(cid:1)ui(k),

+(cid:80)21

(13)

i=1
y(k) = Cx(k).

The optimal model parameters are estimated by solving the
following optimization problem:
(Jf + Jw + Js)
k (cid:107)ym(k, γ) − ¯ym(k)(cid:107)2 for m ∈ {f, w, s}

s.t. Jm =(cid:80)

ˆγ = arg min
γ>0

ym(k, γ) and xm(k, γ) satisfy (13) with
xm(0) = xKF,m(0)
um(k) = ¯um(k), vm(k) = ¯vm(k) ∀ k,

(14)
where ¯u, ¯v and ¯y denote the measured inputs, disturbances,
and zone temperatures, respectively. In other words, we
choose γ such that, when the model is simulated with this
set of parameter values and the measured inputs and distur-
bances, the sum of squared errors between the measured zone
temperatures and the simulated temperatures is minimized.
The initial state xm(0) is required to simulate the model,
however, not all states are measurable (the wall temperature
for example is not), thus we estimate the initial states using a
Kalman Filter xKF,m(0), and set xm(0) = xKF,m(0). Further-
more, to compensate for the lack of sufﬁcient excitation of
the building, initial guesses for γ that are physically plausible
are chosen. The optimal parameter values are similar to those
reported in [18], hence are not included here due to space
limitations.

2) Estimation of f v

IG(·) for Each Season: Let Wm =
{1, 2, . . . , nm} denote the set of weeks in the training data
IG,m,w(·) be an instance of the internal
for season m, and let f v
IG,m(·) estimated for week w in Wm. The
gains function f v
IG,m(·) is deﬁned as the average of all estimates
optimal ˆf v
for a given season.
More speciﬁcally, let ˜x(k) and ˜y(k) denote the predicted
IG,m,w(k−1) =

states and zone temperatures at time k, with f v
0, i.e.,
˜x(k) = Ax(k − 1) + Bvv(k − 1) + BIGf c

(cid:0)Bxuix(k − 1) + Bvui v(k − 1)(cid:1)

+(cid:80)21

IG

(15)

i=1

· ui(k − 1),

˜y = C ˜x(k).

By noting x(k) = ˜x(k) + BIGf v
estimate f v
equations using Ordinary Least Squares:

IG,m,w(k − 1), we can
IG,m,w(k−1) by solving the following set of linear
(CBIG) · f v

(16)
where ¯y(k) represents measured zone temperatures at time k.
IG,m(·) is chosen as the average of all the estimates:
Finally, ˆf v

IG,m,w(k − 1) = ¯y(k) − ˜y(k),
(cid:80)nm

ˆf v
IG,m(k) =

w=1 f v
IG,m,w(k)
nm

∀ k.

(17)

Fig. 4.
Estimated Internal Gain fIG from the Physics-Based Model by
Zone and Season
IG,m(·) takes into account
Therefore, the estimated function ˆf v
the effect of hour of the day and day of the week on the
internal gains.

C. Results

gains for fall, winter and spring: BIG ·(cid:0)f c

The identiﬁed model is tested on holdout test weeks from
different seasons. The average daily prediction RMS errors
by zone and season are reported in Table I. Figure 4 shows
the estimated increase in zone temperatures due to internal
m ∈ {f, w, s}, respectively. Similar average internal gains
are observed for all zones and seasons. The zones that cor-
respond to open workspaces and conference rooms (“West”,
“South”, “East” and “Center”) show discernible daily peaks
in their internal gains proﬁles with a slight decrease during
weekends. Furthermore, there is little variation in the internal
gains proﬁles across different seasons.

IG,m(k)(cid:1) for

IG + f v

Fig. 5.
Physics-Based Model (orange) and Actual Temperatures (green)

Simulated Temperatures from the Data-Driven Model (blue),

strategy that minimizes the cost of HVAC operation over
the same week used in Figure 5, while guaranteeing the
temperature to stay within a comfort zone [Tmin, Tmax], which
we chose as [20◦C, 22◦C] [29], and conﬁning the control
input to the physical limits of the HVAC system [umin, umax].
This problem is formulated as follows:

Model A
(9),
(11a), Model B

x(k + 1) =
umin − ε ≤ u(k) ≤ umax + ε

∀k ∈ [0, N − 1]

Tmin ≤ x(k) ≤ Tmax,
Tmin ≤ Cx(k) ≤ Tmax, Model B (11b)

Model A

∀k ∈ [1, N ]

min
u,ε

u(k)2 + ρ(cid:107)ε(cid:107)2

s.t. x(0) = ¯x(0)

(cid:40)

N(cid:88)

k=1

(cid:40)

V. MODEL COMPARISON

A. Prediction Accuracy

The high-dimensional physics-based model (Model B) is
found to have a higher prediction accuracy compared to the
low-dimensional data-driven model for the individual zones
(Model A) presented in Section III-B: According to Table
I, the mean RMS for Model B across zones is more than
0.1 degrees lower than for Model A. This is also illustrated
in Figure 5, which shows 7-day open-loop predictions of
the temperature of a selected holdout test week in the spring
period, simulated with both models instantiated once with an
initial condition that matches the measured temperatures. The
increase in RMS from Model B to Model A is notably larger
in the zones “East” (0.38) and “Center” (0.15), compared to
the other zones (0.11, −0.03, 0.07, and 0.08).
B. Energy Efﬁcient Control

In this section, we compare the performance of Model
A and Model B for the purpose of energy efﬁciency. We
formulate an MPC problem to ﬁnd the optimal control

(18)
The temperature is initialized with the measured temperature
¯x(0) at
the beginning of the week-long simulation. We
use soft constraints on the control
input with a penalty
parameter ρ to ensure the feasibility of the problem. The
penalty represents the cost of increasing the airﬂow beyond
the operating limits (temporary shutdown or overuse, both
of which are harmful to the system). To ﬁnd the optimal
control strategy, we make use of receding horizon control
with a prediction horizon of three 15-minute time steps.

Figure 6 shows the temperature trajectory computed by the
energy efﬁcient controller (18) computed with both models A
and B, together with the measured temperature as a reference.
It can be seen that both control schemes are capable of
maintaining the temperature within [20◦, 22◦], with a control
strategy that is of comparable cost (1,006 and 1,731 for
Model A and Model B, respectively, where ρ = 100), shown
in Figure 7. An interesting observation is that the largest
difference in the control strategies is detected in zones “East”
and “Center”, which show a larger increase in RMS from

MonTueWedThuFriSatSunMon192021222324Northwest MonTueWedThuFriSatSunMon1920212223WestMonTueWedThuFriSatSunMon2020.52121.52222.5SouthMonTueWedThuFriSatSunMon1920212223EastDay of WeekMonTueWedThuFriSatSunMonTemperature [°C]1920212223NortheastMonTueWedThuFriSatSunMon20.52121.52222.523CenterData-DrivenPhysics-BasedMeasuredFig. 6. Optimal Temperature for MPC with Data-Driven Model (blue),
MPC with Physics-Based Model (orange) and Actual Temperature (green)

Fig. 7. Optimal Control Strategy for MPC with Data-Driven Model (blue),
MPC with Physics-Based Model (orange) and Actual Input (green)

Model B to Model A.

The dips of the computed control

trajectory u below
the black dashed lines represent violations of the physical
limits needed to maintain the temperature in the narrow
range [20◦, 22◦]. Furthermore, it is interesting to observe that
variations in the control input do not impact the periodicity
of the temperature qualitatively, which can be explained by
the regularity of the identiﬁed internal gains.

These ﬁndings suggest that both models perform equally
well in designing an energy efﬁcient control strategy. How-
ever, computing this strategy for Model A was cheap (< 5
minutes) compared to Model B (≈ 20 hours) on a 2 GHz
Intel Core i7, 16 GB 1600 MHz DDR3 machine. Further,
we note that in real-world applications, the MPC would
use state feedback to initialize the temperature with sensor
measurements at every time step, whereas in our simulation,
it operates in an “open loop” fashion and hence propagates
the estimation error with time. This, in essence, reduces the
difference in the prediction quality by both controllers, since
the RMS error is now to be evaluated on a much shorter
prediction horizon, thereby further corroborating the ﬁnding
of almost identical control schemes. For temperature-critical
zones in which precise temperature estimations are needed,
however, one might still want to choose the ﬁne-level Model
B for analysis.

C. Qualitative Comparison

regulation, for instance, Model A’s low dimensionality
makes it suitable for reserve determination which must
be computed for a time horizon of 24 hours.

• Identifying Model A with semiparametric regression
only relies on temperature and VAV airﬂow data and
the physical adjacency of zones, in contrast to Model
B, which requires knowledge of the BRCM toolbox and
a large amount of geometry and construction data of
the buildings, many of which are often unknown [18].
Hence, more effort is required to train the model on
new buildings for Model B.

• The higher accuracy of Model B proves useful for
applications such as the control of temperature-critical
zones and evaluation of controller performance through
simulations, whereas Model A is preferably used for
controller design and in applications where less em-
phasis is put on estimation errors, e.g. at night when
building occupancy is low.

• Model A assumes a uniform temperature among zones,
which often encompass several rooms, whereas Model
B can provide estimates for the temperature of individ-
ual rooms in a given zone. The number of parameters of
Model A increases rapidly with the model complexity,
which coupled with insufﬁcient excitation of the system
makes it hard to emulate the higher spatial granularity
with Model A.

We summarize the ﬁndings in the following:
• Model A is more amenable to controller design due
to its low dimensionality and hence considerably faster
operation. This is of particular importance for scala-
bility considerations, since the computation time grows
exponentially with the number of state variables, which
renders Model B computationally intractable for on-
line operation beyond a certain complexity. Indeed we
observe that
the computation for one step of (18)
exceeds 15 minutes − the discretization time − for
a prediction horizon of ﬁve steps. Thus in frequency

VI. CONCLUSION

We identiﬁed state-space models for the thermal behavior
of SDH with semiparametric regression and a physics-based
model. The internal gains due to occupants and electric
devices were identiﬁed for different spatial granularities and
different temporal seasons. We found the high-dimensional
physics-based model to yield lower estimation errors than the
low-dimensional data-driven model due to the inclusion of
analytical temperature models based on physical parameters
of the building, therefore allowing for higher granularity
in temperature predictions. Under an energy efﬁcient MPC

[11] D. Sturzenegger, D. Gyalistras, M. Morari, and R. Smith, “Semi-
Automated Modular Modeling of Buildings for Model Predictive
Control,” BuildSys 2012 – Workshop of SCM SenSys Conference, 2012.
[12] H. Hao, A. Kowli, Y. Lin, P. Barroah, and S. Meyn, “Ancillary Service
for the Grid via Control of Commercial Building HVAC Systems,”
American Control Conference, no. 467-472, June 2013.

[13] M. Duffy, M. Hiller, D. Bradley, W. Keilholz, and J. Thornton,
“TRNSYS - Features and Functionality for Building Simulation,”
IBSPA Conference, pp. 1950 – 1954, 2009.

[14] J. Zhao, K. P. Lam, and B. E. Ydstie, “EnergyPlus model-based
predictive control (EPMPC) by using MATLAB/SIMULINK and
MLE+,” Proceedings of 13th Conference of International Building
Performance Simulation Association, 2013.

[15] A. Aswani, N. Master, J. Taneja, V. Smith, A. Krioukov, D. Culler,
and C. Tomlin, “Identifying Models of HVAC Systems Using Semi-
parametric Regression,” American Control Conference, 2012.

[16] Y. Ma, F. Borrelli, B. Hencey, and B. Coffey, “Model Predictive
Control for the Operation of Building Cooling Systems,” IEEE Trans-
actions on Control Systems Technology, vol. 20, pp. 796–803, 2012.
[17] Y. Ma, G. Anderson, and F. Borrelli, “A Distributed Predictive Control
Approach to Building Temperature Regulation,” American Control
Conference, pp. 2089–2094, 2011.

[18] Q. Hu, F. Oldewurtel, M. Balandat, E. Vrettos, D. Zhou, and C. Tom-
lin, “Model Identiﬁcation of Commercial Building HVAC Systems
During Regular Operation - Empirical Results and Challenges,” Amer-
ican Control Conference (Accepted), 2016.

[19] “Commercial Buildings Energy Consumption Survey (CBECS):
Overview of Commercial Buildings, 2003,” Energy Information
Administration, U.S. Department of Energy, Tech. Rep., 2008.
[Online]. Available: http://www.eia.doe.gov/emeu/cbecs/cbecs2003/
overview1.html
Available: http://www.cs.berkeley.edu/∼stevedh/smap2/

[20] “sMAP: The Simple Measurement and Actuation Proﬁle.” [Online].

[21] S. Dawson-Haggerty, A. Krioukov, and D. E. Culler, “Experiences
Integrating Building Data with sMAP,” University of California,
Berkeley, Tech. Rep., 2012.

[22] “CIMIS

Station Reports,” California

Information System, Tech. Rep.,
http://www.cimis.water.ca.gov/

Irrigation Management
[Online]. Available:

2015.

[23] “PV Performance Modeling Collaborative.” [Online]. Available:

https://pvpmc.sandia.gov/

[24] Y. Lin, T. Middelkoop, and P. Barooah, “Issues in Identiﬁcation of
Control-Oriented Thermal Models of Zones in Multi-Zone Buildings,”
51st IEEE Conference on Decision and Control, December 2012.

[25] F. Oldewurtel, A. Parisio, C. N. Jones, M. Morari, D. Gyalistras,
M. Gwerder, V. Stauch, B. Lehmann, and K. Wirth, “Energy Efﬁcient
Building Climate Control Using Stochastic Model Predictive Control
and Weather Predictions,” American Control Conference, 2010.

[26] D. Ruppert, M. Wand, and R. Carroll, Semiparametric Regression.

Cambridge University Press, 2003.

[27] W. H¨ardle, H. Liang, and J. Gao, Partially Linear Models. Springer,

2000.

[28] S. Koehler and F. Borrelli, “Building Temperature Distributed Control
via Explicit MPC and “Trim and Respond” Methods,” European
Control Conference, 2013.

[29] S. J. Hansen and H. Burroughs, Managing Indoor Air Quality. Lulu

Press, Inc., 2013.

scheme, both models performed equally well, with the dis-
advantage of the physics-based model being computationally
expensive due to its large number of states, which show an
inherent bilinear relationship with inputs.

We note that

the higher ﬁdelity physics-based model
should be used for controlling temperature-critical zones in
buildings, since it provides higher granularity in addition to
higher accuracy. The compact data-driven model, however,
is a good alternative for devising a control strategy when
less emphasis is put on estimation errors, e.g. at night
when occupancy is low. In frequency regulation, the lower-
dimensional data-driven model is more suitable for reserve
determination as it requires planning over a longer time hori-
zon, whereas the more accurate higher-dimensional physics-
based model can be used in reserve provision to maintain
the building temperature within comfort bounds and track
the frequency regulation signal. Furthermore, while semi-
parametric regression can be easily applied on any building
with a modest requirement of recorded data, the physics-
based model requires detailed geometry and construction
data about the building, which in practice is often subject
to large inaccuracies, and therefore hard to obtain.

We are currently designing a control scheme suitable for
frequency regulation in commercial buildings, based on the
ﬁndings outlined in this paper. Further, we will validate the
identiﬁed models by implementing these control schemes
into the building operation system of SDH.

ACKNOWLEDGMENT

We thank Anil Aswani for fruitful discussions.

REFERENCES

[1] L. P´erez-Lombard, J. Ortiz, and C. Pout, “A Review on Buildings
Energy Consumption Information,” Energy and Buildings, no. 40, pp.
394–398, 2008.

[2] U.S. Department of Energy Buildings Energy Data Book. [Online].

Available: http://buildingsdatabook.eren.doe.gov/

[3] J. ˇSiroky, F. Oldewurtel, J. Cigler, and S. Pr´ıvera, “Experimental
Analysis of Model Predictive Control for an Energy Efﬁcient Building
Heating System,” Applied Energy, vol. 88, pp. 3079–3087, 2011.

[4] A. Parisio, L. Fabietti, M. Molinari, D. Varagnolo, and K. H. Johans-
son, “Control of HVAC Systems via Scenario-Based Explicit MPC,”
IEEE Conference on Decision and Control, 2014.

[5] M. Balandat, F. Oldewurtel, M. Chen, and C. Tomlin, “Contract Design
for Frequency Regulation by Aggregations of Commercial Buildings,”
52nd Annual Allerton Conference on Communication, Control, and
Computing, 2014.

[6] Y. Lin, P. Barooah, S. Meyn, and T. Middelkoop, “Experimental Eval-
uation of Frequency Regulation From Commercial Building HVAC
Systems,” IEEE Transactions on Smart Grid, vol. 6, no. 2, 2015.

[7] E. Vrettos, F. Oldewurtel, F. Zhu, and G. Andersson, “Robust Provision
of Frequency Reserves by Ofﬁce Building Aggregations,” Proceedings
of the 19th IFAC World Congress, pp. 12 068 – 12 073, 2014.

[8] F. Baccino, F. Conte, S. Massucco, F. Silvestro, and S. Grillo,
“Frequency Regulation by Management of Building Cooling Systems
through Model Predictive Control,” Power Systems Computation Con-
ference, pp. 1–7, 2014.

[9] M. Maasoumy, M. Razmara, M. Shahbakhti, and A. Sangiovanni-
Vincentelli, “Handling Model Uncertainty in Model Predictive Control
for Energy Efﬁcient Buildings,” Energy and Buildings, 2014.

[10] B. Sun, P. Luh, Q. Jia, Z. Jiang, F. Wang, and C. Song, “Build-
ing Energy Management: Integrated Control of Active and Passive
Heating, Cooling, Lighting, Shading, and Ventilation Systems,” IEEE
Transactions on Automation Science and Engineering, 2012.

