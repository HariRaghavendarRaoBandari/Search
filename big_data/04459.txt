6
1
0
2

 
r
a

 

M
4
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
9
5
4
4
0

.

3
0
6
1
:
v
i
X
r
a

AVERAGE ZSIGMONDY SETS, DYNAMICAL GALOIS GROUPS,

AND THE KODAIRA-SPENCER MAP

WADE HINDES

ABSTRACT. Let K be a global function ﬁeld and let φ P Krxs. For all wandering basepoints b P K,
we show that there is a bound on the size of the elements of the dynamical Zsigmondy set Zpφ, bq
that depends only on φ, the poles of the b, and K. Moreover, when we order b P OK,S by height,
we show that Zpφ, bq is empty on average. As an application, we prove that the inverse limit of the
Galois groups of iterates of φpxq “ xd ` f is a ﬁnite index subgroup of an iterated wreath product of
cyclic groups. Finally, we establish similar results on Zsigmondy sets when K is the ﬁeld of rational
numbers or K is a quadratic imaginary ﬁeld subject to an added stipulation: either zero has ﬁnite
orbit under iteration of φ or the Vojta conjecture for algebraic points on curves holds.

1. Introduction

Given a rational map φ P Kpxq over a global ﬁeld K and a basepoint b P P1pKq, we study
the prime factors of φnpbq as we iterate φ. Speciﬁcally, we are interested in knowing whether or
not φnpbq has a primitive prime factor, that is, whether or not there is a prime dividing φnpbq that
does not divide any lower order iterates. This problem is analogous to a classical problem of Bang
[2], Zsigmondy [49], and Schinzel [33] on the prime factorization of integer sequences deﬁned
dynamically on the multiplicative group.

Our motivation for studying primitive prime divisors comes from the Galois theory of iterates.
For instance, in the family φfpxq “ xd ` f, the existence of d-power free primitive prime divisors
in the orbit of zero implies a dynamical version of Serre’s open image theorem ([8, Theorem 25],
[17, Theorem 3.3] and [35]), and we prove this over global function ﬁelds.

To begin, we ﬁx some notation. Let K be a global ﬁeld and let VK be a complete set of valuations
on K (corresponding to prime ideals). We say that v P VK is a primitive prime divisor of φnpbq if

vpφnpbqq ą 0 and vpφmpbqq “ 0 for all 1 ď m ď n ´ 1
such that φmpbq ‰ 0. Likewise, we deﬁne the Zsigmondy set of φ and b to be
Zpφ, bq :“ tn | φnpbq has no primitive prime divisorsu.

Over number ﬁelds, there are many results regarding the ﬁniteness and size of Zpφ, bq in special
families; see for example [7, 14, 15, 24, 41]. However, it remains difﬁcult to bound Zpφ, bq in
general. Nevertheless, over function ﬁelds K{Fqptq, we show that there is a bound on #Zpφ, bq
depending only on φ, the poles of b, and on K; see Theorem 1.1.
The main technique we use to prove this result is to associate to every element of Zpφ, bq a
rational points on some curve, and then use height bounds for points on curves to bound the size of

Date: March 16, 2016.
2010 Mathematics Subject Classiﬁcation: Primary: 37P15. Secondary: 37P45, 11B37, 14G05, 37P55, 11G99.
Key words and phrases: Arithmetic Dynamics, Rational Points on Curves, Galois Theory.

1

2

WADE HINDES

the corresponding element of the Zsigmondy set. As one may expect, there are certain complica-
tions that arise in characteristic p ą 0 if the associated curve is deﬁned over the ﬁeld of constants.
Therefore, we need the following geometric condition:
Deﬁnition 1. Let K{Fqptq and ℓ ě 2 be an integer coprime to the characteristic of K. Then we say
that φ is dynamically ℓ-power non-isotrivial if there exists an integer m ě 1 such that
(1)

Cℓ,mpφq : Y ℓ “ φmpXq “ pφ ˝ φ ˝ ¨¨¨ ˝ φ

qpXq

m

is a non-isotrivial curve (meaning that the associated Kodaira-Spencer map is non-zero on some
open set [28]) of genus at least 2. As a motivating example, we show that φfpxq “ xd ` f is
dynamically 2-power and d-power non-isotrivial over K “ Fpptq; see Theorem 1.2 below.

In particular, if S Ď VK is any ﬁnite subset, OK,S is the ring of S-integers of K, and φ is

Zpφ, Sq :“ n| n P Zpφ, bq for some b P OK,S, ˆhφpbq ą 0(

dynamically ℓ-power non-isotrivial for some ℓ ě 2, then we show that
(2)
is ﬁnite; in particular, #Zpφ, bq is uniformly bounded over all b P OK,S. Moreover, we prove an
analogous result when K “ Q or K is an imaginary quadratic ﬁeld, assuming the Vojta conjecture.
On the other hand, one expects that Zpφ, bq is empty if we choose the basepoint b P K “at
random”. A reasonable interpretation of this statements can be formulated in terms of averages.
To wit, for all B ě 0, let OK,SpBq be the set of points of OK,S of height at most B, a ﬁnite set by
[42, Theorem 3.7]. Then we study the average

(3)

ĚAvgpZpφq, Sq :“ lim sup

BÑ8

ř bPOK,SpBq

#OK,SpBq

#Zpφ, bq

.

as we vary over all b P OK,S. In particular, we show that ĚAvgpZpφq, Sq “ 0 for all S; in other
words, the naive heuristic is correct: one expects to see primitive prime divisors at every stage
of iteration. Both the uniform bound and average-result are summarized below (in what follows,
Perpφq and PrePerpφq denote the set of periodic and preperiodic points of φ respectively):
Theorem 1.1. Let φ P Krxs be such that degpφq ě 2 and 0 R Perpφq.

(1) When K “ Q or K is a quadratic imaginary ﬁeld, we have the following cases:

(a) If 0 P PrePerpφq, then Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0.
(b) If 0 R PrePerpφq and the Vojta conjecture [47, Conj. 25.1] holds, then Zpφ, Sq is ﬁnite

and ĚAvgpZpφq, Sq “ 0.
is ﬁnite and ĚAvgpZpφq, Sq “ 0.

(2) If K{Fqptq and φ is dynamically ℓ-power non-isotrivial for some ℓ ě 2, then Zpφ, Sq

In other words, there is a bound on the elements of Zpφ, bq depending only on φ, the poles of b,
and K. Moreover, if we order OK,S by height, then Zpφ, bq is empty on average.

As an application, we use Theorem 1.1 to study dynamical Galois groups. For n ě 1, let Knpφq
be the ﬁeld obtained by adjoining all solutions of φnpxq “ 0 to K. Generically, the extension
Knpφq{K is Galois, and we let GK,npφq :“ GalKpφnq be the Galois group of Knpφq{K. Since
Kn´1pφq Ď Knpφq for all n ě 1 (under some mild separability assumptions), we may deﬁne
(4)

GKpφq “ lim
ÐÝ

GK,npφq

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

3

with respect to the restriction maps. Dynamical analogs on P1 of the Galois representations at-
tached to abelian varieties [35] (where one instead considers iterated preimages of multiplica-
tion maps), the groups GKpφq have obtained much attention in recent years; for instance, see
[3, 12, 16, 29, 30, 45], among other places.
Of course, a key difference in this setting is the lack of group structure on projective space, and
as such GKpφq may often only be viewed as a subgroup of a wreath product (or the automorphism
group of a tree) and not inside a group of matrices. Explicitly, let Tpdq denote the inﬁnite d-ary
rooted tree. If we write φn “ fn{gn for some fn, gn P Krxs such that discpfnq ‰ 0 for all n ě 1,
then we may identify Tpdq with the set of iterated preimages of zero (under φ) in sK with the edge
relation given by evaluation; see [3] for more details. In particular, GKpφq ď AutpTpdqq, since
Galois commutes with evaluation.
As in the case of abelian varieties, one expects that GKpφq is a large subgroup of AutpTpdqq.
However, given the unruly nature of AutpTpdqq and its subgroups, we focus our attention on
polynomials of a special form. To do this, ﬁx a faithful permutation representation of the cyclic
group Cd ď Sd and let Wpdq be the inﬁnite iterated wreath product of Cd acting on Tpdq; see
[27] or [20, Defs. 2.3 and 2.4]. In particular, if µd is the group of d-th roots of unity in sK and
φfpxq “ xd ` f for some f P K, then we have the reﬁnement GKpµdqpφfq ď Wpdq ď AutpTpdqq;
see [20, Lemma 2.5]. Moreover, it follows from Theorem 1.1 and some calculations involving the
Kodaira-Spencer map of Cm,ℓpφq, that GKpµdqpφfq ď Wpdq is a ﬁnite index subgroup:
Theorem 1.2. Let K “ Fpptq, let f P K and let let d ě 2 be coprime to p. If f R K p and
φpxq “ xd ` f , then the following statements hold:
(1) Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0 for all ﬁnite subsets S Ď VK.
(2) If d is an odd prime, d ı 1 pmod pq, f P OK and f R Kpµdqd, then GKpµdqpφq ď Wpdq is
In fact, it follows from Theorem 1.2 that GKpµdqpφfq ď Wpdq is a ﬁnite index subgroup for all
non-constant f P Fpptq and d ı 1 pmod pq; see Remark 3.2 below. In particular, the number of
irreducible factors of φn over Fpptq is bounded independently of n (a phenomenon called eventual
stability [16, §5]), and we recover a stronger version of [8, Corollary 7]. For applications of
eventual stability to the study of integral points in reverse orbits, see [18, §3] and [43, Theorem
2.6]. As for characteristic zero function ﬁelds K{kptq, a ﬁnite index statement for GKpµdqpxd`fq ď
Wpdq follows from [7] and [8, Theorem 25]. However, we can improve upon this result, making
the index bounds explicit and uniform when K “ kptq is a rational function ﬁeld.
Theorem 1.3. Let K “ kptq be a rational function ﬁeld of characteristic zero, let d be an odd
prime, and let φpxq “ xd ` f for some non-constant f P krts. Then the following statements hold:

a ﬁnite index subgroup.

Moreover, if φpxq “ xd ` t, then GKpµdqpφq – Wpdq for all d ě 2 (not necessarily prime). In
particular, if k is a number ﬁeld and φcpxq “ xd ` c for some c P k, then there are inﬁnitely many
values of c satisfying Galkpµdqpφn

cq – rCdsn.

(1) If f R Kpµdqd, then we have the index bound
logd rWpdq : GKpµdqs ď

d10 ´ 1
d ´ 1 ` 10.

(2) If GalKpµdqpφ10q – rCds10, then GKpµdqpφq – Wpdq.
(3) If d ě 367 and GalKpµdqpφ5q – rCds5, then GKpµdqpφq – Wpdq

4

WADE HINDES

Acknowledgements: It is a pleasure to thank Rafe Jones, Brian Conrad, Bjorn Poonen, and

Felipe Voloch for the useful discussions related to the work in this paper.

2. Primitive prime divisors and averages

In this section, we make the following conventions:

‚ K is a number ﬁeld or a ﬁnite extension K{Fqptq.
‚ if K is a function ﬁeld, k is its ﬁeld of constants of K.
‚ p is a ﬁnite prime of K.
‚ kp is the residue ﬁeld of p.
‚ if K is a number ﬁeld, then Np :“ log #kp
.
rK:Qs
‚ if K is a function ﬁeld, then Np :“ rkp : ks.

We normalize Np in the number ﬁeld case, since it streamlines our proofs. Moreover, given a ﬁnite
set of primes S Ď VK, we let OK :“ ta P K : vpaq ě 0, v P VKu be the ring of integers
of K and OK,S :“ ta P K : vpaq ě 0, v R Su be the ring of S-integers. Similarly, when K
is a function ﬁeld, we ﬁx a prime p0 and set OK :“  α P K : vppαq ě 0, p ‰ p0( and let
OK,S :“ α P K : vppαq ě 0, p R S( for all S containing p0. Moreover, we let O˚K and O˚S,K be
for more details. If K is a function ﬁeld, then we deﬁne the height of α P K to be
(5)

We now deﬁne the relevant global Weil-height functions; see [42, §3.1] and [44, Theorem 1.4.11]

the corresponding unit groups.

hpαq “ ´ ÿpPVK

minpvppαq, 0q ¨ Np “ ÿpPVK

maxpvppαq, 0q ¨ Np

On the other hand, if K is a number ﬁeld, the height of α P K is
rK : Qs ÿσ:KÑC
(6)

hpαq “ ´ ÿpPVK

minpvppαq, 0q ¨ Np `

1

maxplog |σpαq|, 0q.

Remark 2.1. The key advantage in the function ﬁeld setting when studying primitive prime divisors
is that one can compute heights of integers by keeping track of positive valuations only.

As was mentioned in the introduction, the main technique we use to prove Theorem 1.1 comes
from the theory of rational points on curves. However, over function ﬁelds, we must stipulate that
our curve not be deﬁned over the ﬁeld of constants, otherwise certain results (such as the Mordell
conjecture) are false. The most convenient way to achieve this is to deﬁne the Kodaira-Spencer
map.

To do this, we think of a curve X{K as a surface over k. In particular, X is equipped with a map
f : X Ñ C to a curve C{k satisfying K “ kpCq. The Kodaira-Spencer map (or KS) is constructed
on any open set U Ď C over which f is smooth from the exact sequence

0 Ñ f˚Ω1

U Ñ Ω1

XU Ñ Ω1

XU{U Ñ 0.

by taking the coboundary map KS : f˚pΩXU{Uq Ñ Ω1
(Proof Theorem 1.1). To estimate the size of elements in Zpφ, bq, we reﬁne our proof of the ﬁnite-
ness of Zpφ, bq in [11, Theorem 1] and follow the conventions therein. Note that S Ď S1 implies
Zpφ, Sq Ď Zpφ, S1q. Therefore, to prove that Zpφ, Sq is ﬁnite, we may enlarge S and assume that
(d). OK,S is a UFD,
(a).

U ˆ R1f˚pOXUq.

(b). φ P OK,Srxs

(c). vpadq “ 0 for all v R S

b P OK,S

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

5

We ﬁrst bound Zpφ, bq when 0 R Oφpbq, true of all but ﬁnitely many b P K by Lemma 2.4. To

where ad is the leading term of φ. Note that condition (d) is made possible by the ﬁniteness of the
class group; see [32, Prop. 14.2 ] over function ﬁelds. Likewise, we may assume that p0 P S.
do this, we use the following decomposition of φnpbq into an ℓ and ℓ-free part.
Lemma 2.2. Let φ, K and S be as above and let ℓ ě 2. Then we have a decomposition
(7)

for some dn, yn P OK,S, un P O˚K,S,

φnpbq “ un ¨ dn ¨ yℓ
n,

satisfying the following properties:

(1) 0 ď vppdnq ď ℓ ´ 1 for all p R S,
(2) There is a constant rpSq such that 0 ď vppdnq ď rpSq for all p P S when K{Q
(3) The height hpunq is bounded independently of n.

and all p P S K tp0u when K{Fqptq,

,

1 ¨ pe2

1 ¨ pq2

1 ¨ pe2

2 ¨¨¨ pes

2 ¨¨¨ pes

s `pq1
1 ¨ pq2
dn “ pe1
s ˘ and yn with`yn ¨ pq1

(Proof of Lemma 2.2). By assumptions (a) and (b) on S “ Spφ, bq, we see that φnpbq P OK,S for
n as on (7) since OK,S is a
all n. Hence, for any integer ℓ ď 2, we may write φnpbq “ un ¨ dn ¨ yℓ
UFD. Furthermore, we can assume that 0 ď vpdnq ď ℓ ´ 1 for all v R S. To see this, we use the
correspondence VK K S ÐÑ SpecpOK,Sq discussed in [32, Ch. 14] and write:
pi P SpecpOK,Sq

s ˘ℓ
2 ¨¨¨ pqs
for some integers ei, qi satisfying vpipdnq “ qi ¨ ℓ ` ei and 0 ď ei ă ℓ. In particular, by replacing
dn with`pe1
s ˘, we may assume that 0 ď vpdnq ď ℓ´ 1
2 ¨¨¨ pqs
for all v P VK K S as claimed.
On the other hand, let pi P S when K is a number ﬁeld and pi P S K tp0u when K is a function
ﬁeld. Since the class group of K is ﬁnite, there exists ai P OK and ni ě 1 such that pni
i “ paiq.
In particular, vpipaiq “ ni ą 0 and vppaiq “ 0 for all p P SpecpOKq K tpiu. Therefore, if we
write vpipdnq “ qi ¨ ni ` ri for some 0 ď ri ă ni and set d1n :“ dn{pśi aqi
i q, then we have that
0 ď vppd1nq “ vppdnq ď ℓ ´ 1 for all p R S and vpipd1nq “ ri for all pi. Hence, after replacing dn
with d1n and un with un ¨pśi aqi
i q, we see that conditions (1) and (2) of Lemma 2.2 are satisﬁed for
rpSq :“ maxtriu.
Finally, since O˚K,S is a ﬁnitely generated group ([32, Prop. 14.2 ]), we can absorb ℓ-powers into
t for some basis tuiu of O˚K,S and some integers 0 ď ri ď ℓ ´ 1.
yn and write un “ ur1
In particular, we assume that the height hpunq is bounded independently of n ě 0.

1 ¨ ur2

2 . . . urt

(cid:3)

It is our goal to show that dn P OK contains primitive prime divisors outside of S. To
do this, ﬁrst note that conditions (b) and (c) imply that φ has good reduction (see [42, Theorem.
2.15]) modulo the primes in VK K S. In particular, if p is a prime of OK,S such that vppdnq ą 0 and
vppφmpbqq ą 0 for some 1 ď m ď n ´ 1 and φmpbq ‰ 0, then
(8)
see [42, Theorem. 2.18]. Therefore, if n ě 1 is such that dn has no primitive prime divisors outside
os S, then we have the reﬁned factorization of ideals in OK,S:

φn´mp0q ” φn´mpφmpbqq ” φnpbq ” 0 pmod pq;

(9)

pdnq “ź pej

2].
j , where pjˇˇφtjpbq or pjˇˇφtjp0q for some 1 ď tj ďY n

6

WADE HINDES

Moreover, as noted above, we may assume that 0 ď ej ď ℓ ´ 1. Hence, Lemma 2.2 and Lemma
2.5 imply that there is a constant cpK, Sq such that

(10)

hpdnq ď pℓ ´ 1qˆ t n
2 uÿi“1

hpφipbqq `

hpφjp0qq˙ ` cpK, Sq ;

t n

2 uÿj“1

here, we use that φjp0q ‰ 0 for all j ě 1. Now, choose an integer m “ mφ and ℓ “ ℓφ such that

C :“ Cℓ,mpφq : Y ℓ “ φmpXq

is a nonsingular curve of genus at least two. This is possible in the function ﬁeld case since φ is
dynamically ℓ-power non-isotrivial. As for the number ﬁeld case, since zero is not periodic, the
Riemann-Hurwitz formula implies that #φ´mp0q ě dm´2 for all m ě 1; see [42, Exercise 3.37].
Hence, we may choose m such that #φ´mp0q ě 5. Now choose ℓ coprime to the multiplicities of
all roots of φm, and apply [4, Corollary 2.2] or [44, Proposition 3.7.3].
If n ď mφ for all n P Zpφ, bq with b P OK,S and ˆhφpbq ą 0, then we are done. Otherwise, we

may assume that n ą mφ so that (7) implies that
Pnpbq :“`φn´mφpbq , yn ¨

ℓaun ¨ dn˘ P CpsKq .

It follows from the Vojta Conjecture [47, Conj. 24.1 or 25.1] for number ﬁelds or any of the
bounds (suitable to positive characteristic) discussed in the introductions of [21, 28] for function
ﬁelds, that there are non-negative constants A1 “ A1pd, ℓφ, mφq and A2 “ A2pφ, d, ℓφ, mφq such
that the following inequality holds

(11)
here κpCq is a canonical divisor class of C with associated height function hκpCq : C Ñ Rě0 (see
[22, §2.2]), dpPnpbqq is the logarithmic discriminant of KpPnpbqq{K relative to K (see [47, §23])
over number ﬁelds, and

hκpCqpPnpbqq ď A1 ¨ dpPnpbqq ` A2;

dpPnpbqq :“

2 ¨ genus`Knpbq˘ ´ 2

“Knpbq : K‰

for Knpbq :“ K` ℓaun ¨ dn˘

over function ﬁelds. We note that the bounds on (11) have been made more explicit in [22, §2.2]
over function ﬁelds, although we do not need them here.

On the other hand, if K is a function ﬁeld, then it follows from [44, Prop. 3.7.3] and the remark
[44, Remark 3.7.5] that there is a constant B1 “ B1pgKq, depending only on the genus gK of K,
such that dpPnpbqq ď hpun¨ dnq` B1. Likewise, hpun¨ dnq ď hpdnq` BpK, Sq, since the height of
un is absolutely bounded. Hence, there is a constant BpK, Sq, depending only on K and S, such
that dpPnpbqq ď hpdnq ` BpK, Sq. Similarly, dpPnpbqq ď hpdnq ` BpK, Sq over number ﬁelds;
see [47, §23]. In either case, we deduce from (11) that

(12)
where A3 “ A3pφ, d, mφ, ℓφ, gK , Sq “ pB1pgKq ` B2pK, Sqq ¨ A1pd, mφq ` A2pφ, d, ℓφ, mφq. In
particular, all constants are independent of the basepoint. However, we want a bound relating
hpφn´mpbqq and hpdnq. To do this, we note that if D1 is an ample divisor on C and D2 is an
arbitrary divisor, then

hκpCqpPnpbqq ď A1 ¨ hpdnq ` A3

(13)

lim

hD1pPqÑ8

hD2pPq
hD1pPq “

deg D2
deg D1

,

P P CpsKq;

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

7

see [38, Thm III.10.2]. In particular, if π : C Ñ P1 is the covering πpX, Y q “ X, then a degree one
divisor on P1 (giving the usual height hK on projective space) pulls back to a degpπq divisor D2 on
C satisfying hD2pPq “ hpπpPqq. We deduce from (13) that there exists a constant δ “ δpφ, m, ℓq
satisfying:

(14)

hκpCqpPq ą δ

implies

hpπpPqq ď

ℓ

2gC ´ 2 ¨ hκpCqpPq ` 1 ď

ℓ
2 ¨ hκpCqpPq ` 1

for all P P CpsKq; here gC ě 2 is the genus of C, and degpπq ď ℓ. As an alternative to the height
ratio on (13) over function ﬁelds, we could use explicit calculations of hκpCq in [22, §4]; however,
we prefer a uniform approach over global ﬁelds when possible. On the other hand, we note that
the set of points tPnpbqu Ď CpsKq where (14) fails,
TC :“ Pnpbqˇˇ hκpCqpPnpbqq ď δu Ď P P Cp ¯Kqˇˇ hκpCqpPq ď β and rKpPq : Ks ď ℓ(,
is ﬁnite, since the canonical class κpCq is ample in genus at least two; see [38, Thm. 10.3]. In
particular, we deduce that Pnpbq P TC implies hpφn´mpbqq is bounded. Hence, Lemma 2.4 implies
that n is bounded independently of b as claimed. Conversely, if Pnpbq R TC, then (10), (12) and
(14) imply that

(15)

hpφn´mφpbqq ď

ℓpℓ ´ 1q

2

¨ A1 ¨ˆ t n
2 uÿi“1

hpφipbqq `

hpφjp0qq˙ ` A4,

t n

2 uÿj“1

for A4 “ A4pφ, d, ℓφ, mφ, gK, K, Sq “ ℓ{2 ¨ pA1 ¨ cpK, Sq ` A3q ` 1. However, for wandering
basepoints the left hand side of (15) grows like dn´m, while the right hand side of (15) grows like
dt n
2 u`1. In particular, since m is ﬁxed, n is bounded. To make this formal, we use properties of ˆhφ,
the canonical height function attached to φ. Speciﬁcally, it is known that:

2

(16)

(a). ˆhφ “ h ` Op1q

(b). ˆhφpφspαqq “ ds ¨ ˆhφpαq
d ´ 1 `ˆ ℓpℓ ´ 1q
2 u`1 ´ 1

2

φ,K is positive (see the proof Lemma 2.4), it follows that

`ˆhφpbq ` ˆhφp0q˘A1˙ dt n

for all α P sK and all integers s ě 0; see [42, Thm. 3.20]. In particular, we deduce from (15) that
(17) dn´mφ ¨ ˆhφpbq ďˆ ℓpℓ ´ 1q
A1Bφ˙n ` A5;
here |ˆhφ ´ h| ď Bφ from (16) and A5pφ, d, ℓφ, mφ, gK , K, Sq “ A4 ` Bφ. Moreover, since
ˆhφpbq ‰ 0 and ˆhmin
(18)
where the constants B4, B5, and B6 are all independent of the basepoint. However, such an in-
equality implies for instance that
(19)
where Bmax :“ maxtB4, B5, B6u. Hence, we see that n is bounded, or equivalently

n ď 5 ` 2mφ ` 2 logd`Bmax˘

dn´mφ ď B4 ¨ dt n

2 u`1 ` B5 ¨ n ` B6,

sup nˇˇ n P Zpφ, bq for some ˆhφpbq ą 0, b P OK,S(

is ﬁnite. Therefore, when 0 R Oφpbq, we have shown that #Zpφ, Sq is bounded by a constant that
depends only on φ, S, and K. On the other hand, suppose that 0 P Oφpbq. Lemma 2.4 implies that
there exists nφ (depending only on φ and K) such that φnpaq ‰ 0 for all n ě nφ and all a P K. It
follows that Zφ,K :“ a P K : 0 P Oφpaq( is a ﬁnite set. In particular, the set of primes
S0 :“ primes p P VK : vppφnpaqq ą 0 for some a P Zφ,K, n ď nφ, φnpaq ‰ 0(

8

WADE HINDES

is also ﬁnite. Let S1 “ S0 Y S, where S satisﬁes conditions (a)-(d) above. We have shown (in
the ﬁrst case of Theorem 1.1) that there exists Npφ, S1q such that φnpcq contains primitive prime
divisors outside of S1 for all n ě Npφ, S1q and all c P OK,S K Zφ,K. We apply this to c :“ φnφpbq,
from which it follows that n P Zpφ, bq implies n ď nφ ` Npφ, S1q. As in the previous case, this
bound only depends on φ, S and K.
We note that the use of the Vojta conjecture in the number ﬁeld setting is not necessary to prove
the ﬁniteness of Zpφ, Sq when zero is preperiodic. To see this, note that Lemma 2.2 and (8) imply
that tdnunPZpφ,Sq is ﬁnite, since there are only ﬁnitely many primes not in S dividing elements of
the orbit of zero (equivalently dn has bounded height by Lemma 2.5). Now deﬁne

Kpφ, Sq :“ K` ℓaun ¨ dn : n P Zpφ, Sq˘,

a ﬁnite extension of K. Hence, Faltings’ Theorem [6] implies that the set of Kpφ, Sq rational
points of C is ﬁnite. In particular, φn´mφpbq has bounded height, and Lemma 2.4 implies that n is
bounded as claimed.

As for statements about averages, we consider the set

Tφ,n,S :“ b P OK,S | n P Zpφ, bq, ˆhφpbq ‰ 0(.

(20)
It follows from the fact that Zpφ, Sq is ﬁnite that Tφ,n,S “ ∅ for all n sufﬁciently large. Although
it may be the case that Tφ,n,S is inﬁnite for some n, we will show that Tφ,n,S is always a sparse set
OK,S. With this in mind, for any subset E Ď OK,S we deﬁne the (natural) upper densitysδNat,SpEq

of E to be the quantity

:“ lim sup
BÑ8
In particular, if we set Npφ, Sq :“ suptn : n P Zpφ, Squ, then we see that

sδNat,SpEq :“ lim sup

#tb P E | hpbq ď Bu
#tb P OK,S | hpbq ď Bu

BÑ8

#EpBq
#OK,SpBq

.

(21)

(22)

ĚAvgpZpφq, Sq ď Npφ, Sq ¨ˆ Npφ,Sqÿn“1 sδNat,S`Tφ,n,S˘˙.

Therefore, it sufﬁces to prove that sδNat,SpTφ,n,Sq “ 0 for all 1 ď n ď Npφ, Sq, to deduce that
ĚAvgpZpφq, Sq “ 0. To do this, we make a few auxiliary deﬁnitions: for all rational functions
f P Kpxq and all sets of primes P Ď VK, we deﬁne:
(23)
Here, for any α P K, the support Supppαq is the set of all primes p such that vppαq ą 0. Further-
more, let P0 be the ﬁnite set of prime divisors of the ﬁrst Npφ, Sq-elements of the orbit of zero,
that is P0 :“ tSupppφnp0qqunďNpφ,Sq. Finally, let Pf be the set of primes of bad reduction of f.

If,S,P :“ b P OK,S : Supppfpbqq Ď P(.

In particular, it follows from (8) that

Tφ,n,S Ď Iφn,S,P for P “ S Y P0 Y Pf .

(24)
Therefore, if we let f :“ φn for any n ď Npφ, Sq, then our average-zero result follows from
Lemma 2.3 below. However, because of its possible independent interest, we state Lemma 2.3
for subsets P Ď VK of (Dirichlet) density zero, not just ﬁnite subsets; see [26] and [36, §3] for
the relevant background and results on densities over global ﬁelds. Moreover, in what follows
Nppq “ #kp is the size of the residue ﬁeld.
(cid:3)

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

9

Lemma 2.3. Let f : P1 Ñ P1 be non-constant rational function, let P Ď VK, and let
(25)

sÑ1` řqPP Npqq´s

řqPVK

Npqq´s “ lim

sÑ1` řqPP Npqq´s

logp1{ps ´ 1qq

sδDirpPq :“ lim

be the Dirichlet density of P. IfsδDirpPq “ 0, thensδNat,SpIf,S,Pq “ 0.
Proof of Lemma 2.3. Since, If,S,P1 Ď If,S,P2 whenever P1 Ď P2, we may enlarge P and assume
that P contains both S and Pf . Now let P1 “ tp R P : f has a root pmod pqu, and for p P P1 let ap
be such a root pmod pq; note that this makes sense, i.e f : P1pFpq Ñ P1pFpq is well deﬁned, since
p R Pf . It follows from the Chebotarev Density Theorem, that δDirpP1q is positive. Let P2 be any
ﬁnite subset of P1. By deﬁnition of If,S,P, we see that

(27)

If,S,P Ď b P OK,S : b ı ap pmod pq for all p P P2(.

(26)
Fix p P P2. Since δNat,S is translation invariant, δNat,Spa ` pq is independent of a P OK,S. In
particular, we add up δNat,Spa ` pq over representatives a P OK,S{pOK,S and see that the natural
density of tb P OK,S : b ” ap pmod pqu is 1{ Nppq as expected. In particular, one computes via
the Chinese Remainder Theorem that the natural density of the set displayed on the right hand side
of (26) isśpPP 2`1 ´ 1

Nppq˘. On the other hand,
sδNat,SpIf,S,Pq ď źpPP 1, NppqďB´1 ´
as B Ñ 8 for some positive constant C; see [36, Exercise 3.3.2.2]. In particular, since the density
δDirpP1q ‰ 0, we see thatsδNat,SpIf,S,Pq “ 0 as claimed.
Lemma 2.4. Let B ą 0. There exists a positive integer nφpBq such that hpφnpbqq ď B implies
n ă nφpBq for all b P K satisfying ˆhφpbq ‰ 0.
(Proof of Lemma 2.4). Suppose that b P K and hpφnpbqq ď B. Since ˆhφ “ h ` Op1q and
ˆhφpφnpbqq “ dn ¨ ˆhφpbq, we see that dn ¨ ˆhφpbq “ ˆhφpφnpbqq ď B1 for some positive constant
B1 depending of φ and B. Moreover,

Nppq¯ „ C{ logpBqδDirpP 1q

(cid:3)

1

(28)
is strictly positive. To see this, choose an arbitrary wandering point c0 P P1pKq for φ (possible, for
instance, by Northcott’s Theorem [42, Theorem. 3.12]), and note that

φ,K :“ inf ˆhφpcq | c P P1pKq, ˆhφpcq ą 0(

ˆhmin

ˆhmin

φ,K “ inf ˆhφpcq | c P P1pKq and 0 ă ˆhφpcq ă ˆhφpc0q(.

However, this latter set is ﬁnite and consists of strictly positive numbers; hence ˆhmin

particular, it follows that hKpφnpbqq ď B implies that n ď logd`B1{ˆhmin

Lemma 2.5. If K is one of the global ﬁelds in Theorem 1.1, then

φ,K˘ as claimed.

φ,K ą 0. In

(cid:3)

(29)

ÿpĎOK ,vppαqě0

vppαq ¨ Np “ hpαq

for all nonzero α P OK. On the other hand,řvppαqě0 vppαq Np ď hpαq for all α P K˚.

10

WADE HINDES

Proof. Let K be a function ﬁeld. If α P OK “ Op0 is non-constant, then vp0pαq ă 0, and the
claim follows from (5), i.e. the number of zeros equals the number of poles (when counted with
the correct multiplicity). On the other hand, let K{Q be a number ﬁeld. Then the product formula
implies

(30)

hpαq “ ÿpĎOK ,vppαqě0

vppαq ¨ Np ´

1

rK : Qs ÿσ:KÑC

minplog |σpαq|, 0q.

In particular, if K “ Q or K{Q is an imaginary quadratic extension, then one veriﬁes directly that
|σpαq| ą 1 for all σ : K Ñ C and all non-zero α P OK K O˚K. Therefore, (30) implies the claim for
such integers. Conversely, if α P O˚K, then α is a root of unity and hpαq “ 0. On the other hand,
if α is a unit, then vppαq “ 0 for all p and (29) holds. In either setting, we see that the inequality,
řvppαqě0 vppαq Np ď hpαq for all α P K˚, follows from the product formula.
Remark 2.6. We note that Theorem 1.1 part 1(a) is a strengthening of the main result of [31].
Moreover, for results on Zpφ, bq when 0 P Perpφq, see [14].
Remark 2.7. In characteristic zero, the ﬁniteness of Zpφ, Sq holds for K “ kptq with essentially
the same proof: use the fact that OK,S is unique factorization domain for all S and that ˆhmin
φ,K is
positive [1, Remark 1.7(ii)]. On the other hand, the proof of Theorem 1.1 breaks down when

(cid:3)

K ‰ kptq, since the class group of K is not ﬁnite. Note also that ĚAvgpZpφq, Sq does not make
sense for characteristic zero function ﬁelds, since the Northcott property fails.
Remark 2.8. For number ﬁelds K{Q, the height calculation in Lemma 2.5 fails whenever the group
of units O˚K is inﬁnite. In particular, one cannot in general calculate heights of algebraic integers
by solely keeping track of divisors. Therefore, in order to generalize Theorem 1.1 to all number
ﬁelds, one would need to estimate |φnpbq|σ for the archimedean places σ : K Ñ C as well.
Remark 2.9. Of course, one would like to know whether Theorem 1.1 holds for rational functions.
However, in Lemma 2.2 and elsewhere in the proof of Theorem 1.1, we used that φnpbq P OK,S
for all n, a property that will fail in general. For instance, over number ﬁelds Silverman has shown
that φ2 R sKrxs implies Oφpbq X OK,S is ﬁnite for all b P K; see [40] for Silverman’s integral point

theorem, and see [10] for an average-version.

By analogy with the function ﬁeld case, we conjecture that Theorem 1.1 holds over all number

ﬁelds without assumptions on the orbit of zero.
Conjecture 2.10. Let K{Q and φ P Krxs be a polynomial of degree d ě 2. If φpxq ‰ c ¨ xd, then
Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0 for all ﬁnite subsets S Ď VK.
As for the key condition over function ﬁelds, we expect that most rational functions φ P Kpxq
are dynamically ℓ-power non-isotrivial for some ℓ ě 2; see Deﬁnition 1 above. In fact, it is likely
that one can choose inﬁnitely such exponents.
Conjecture 2.11. Suppose that φ P Krxs KsFprxs satisﬁes the following conditions:
(1) degpφq ě 2,
(2) gcdpdegpφq, pq “ 1,
(3) φpxq ‰ c ¨ xd for all c P sFp .
Then there exists ℓ ě 2 and m ě 1, such that gcdpℓ, pq “ 1 and Cℓ,mpφq : Y ℓ “ φmpXq is a
non-isotrivial curve of genus at least 2.

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

11

However, at present, Conjecture 2.11 seems quite difﬁcult. On the other hand, there are formulas
for the relevant Kodaira-Spencer maps in [22] in terms of the iterated preimages of zero. It is
therefore possible that one can exploit knowledge of GalKpφmq for some (hopefully small) m ě 1,
to show that the KS map is non-zero.
We carry out these calculations for the polynomials φpxq “ xd ` f, where the KS map com-
putation becomes a sum over cyclotomic characters. Although special cases, these polynomials
are important examples in several ways. First of all, the curves Cℓ,1pφq are isotrivial for all ℓ ě 2
while Cd,2pφq and C2,2pφq are not (see 3.3), illustrating that one must in general pass to an iterate
when studying primitive prime divisors. Secondly, we can use Theorem 1.1 to show that the Ga-
lois groups of iterates of φpxq “ xd ` f form a ﬁnite index subgroup of an inﬁnite iterated wreath
product of cyclic groups. In particular, they provide the ﬁrst examples of a dynamical Serre-type
open image theorem over global ﬁelds; compare to results for quadratic rational maps over number
ﬁelds in [7, 19, 45].
Remark 2.12. It is worth pointing out that we could just as well use the more standard notion of
isotriviality in Deﬁnition 1, Theorem 1.1 and Conjecture 2.11: a curve is said to be isotrivial (in
the standard sense) if after a base extension it may be deﬁned over a ﬁnite ﬁeld; see the Appendix
in [48]. Strictly speaking, the key bounds in [21, 28] are for curves with non-zero Kodaira-Spencer
class. However, the general case follows from this one as follows: assuming that Cℓ,mpφq{K is a
non-isotrivial curve (in the the standard sense), there is an r (a power of the characteristic of K)
and a separable extension L{K such that Cℓ,mpφq is deﬁned over Lr and that the Kodaira-Spencer
class of Cℓ,mpφq over Lr is non-zero. Now, if we apply any of the bounds in [21, 28] to Cℓ,mpφq
over Lr, then we achieve the bounds on (11); the rest of the proof of Theorem 1.1 is the same.
However, we prefer the more explicit (computational) condition that the Kodaira-Spencer map be
non-zero.

Eφ : Y 2 “ pX ´ cq ¨ φpXq

On the other hand, given a quadratic polynomial φpxq “ px´ γq2 ` c P Krxs, the curve C2,mpφq

for m ě 2 maps to the elliptic curve
(31)
via pX, Y q Ñ`φm´1pXq, Y ¨pφm´2pXq´ γq˘. In particular, if the j-invariant [39, III.1 Prop. 1.4]
of Eφ is non-constant, then it follows from [11, Proposition 3.3] that C2,mpφq is non-isotrivial (in
the standard sense) for all m ě 2. Therefore, Remark 2.12 implies an explicit form of Theorem
1.1 in the quadratic case:
Corollary 2.13. Let K{Fqptq be a ﬁnite extension of odd characteristic. For all monic, quadratic
polynomials φ P Krxs, write φpxq “ px ´ γq2 ` c by completing the square. If φpγq ¨ φ2pγq ‰ 0
and the quantity

´ 27
1728¯ ¨ jpEφq “ ´ γ6 `6 γ5 c ´ 15 γ4 c2 ` 9 γ4 c ` 20 γ3 c3 ´ 36 γ3 c2 ` ¨¨¨ ` 27c3
γ4 c ´ 4 γ3 c2 ` 6 γ2 c3 ` 2 γ2 c2 ´ 4 γ c4 ´ 4 γ c3 ` c5 ` 2c4 ` c3

is non-constant, then Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0 for all S.
See Corollary 1.2 and Corollary 1.4 of [11] for statements about the Galois groups GKpφq under

the hypotheses of Corollary 2.13 above.

3. Dynamical Galois groups and the Kodaira-Spencer map

We now use our results on dynamical Zsigmondy sets to study dynamical Galois groups. To
do so, we ﬁrst introduce the necessary background material on wreath products, following the
presentation in [42, §3.9] and the results in [20].

12

WADE HINDES

Deﬁnition 2. Let G be a group acting on an index set A, and let H be an abelian group with its
group law written additively. The set of maps pA, Hq is naturally a group: for i1, i2 P pA, Hq,
deﬁne

pi1 ` i ` 2qpaq “ i1paq ` i2paq.
Since G acts on A, it comes equipped with an action on pA, Hq as follows:

pi1 ` 12q : H Ñ H,

g : pA, Hq Ñ pA, Hq,

gpiqpaq “ ipgpaqq

for all g P G, i P pA, Hq, and a P A. The wreath product of G and H (relative to A) is the set
pA, Hq ˆ G with the group law

pg1, i1q ˚ pg2, i2q “ pg2pi1q ` i2 , g1g2q

and is denoted GrHs.
Deﬁnition 3. If G acts on A, then rGsm acts on Am (the cartesian product) for all m ě 1. Therefore,
we may deﬁne the n-th iterated wreath power of G inductively: rGs1 “ G and rGsn “ rGsn´1rGs.
Deﬁnition 4. Since GrHs Ñ G via projection onto the second coordinate, we have a system of
maps rGsn Ñ rGsn´1 allowing us to deﬁne an inverse limit. In the special case when G “ Cd is
the cyclic group of order d (acting on itself by translation), we deﬁne

Wpdq :“ lim

ÐÝ rCdsn.

to be the inﬁnite iterated wreath product of Cd; for more on Wpdq, see [27].

Our primary interest in wreath products comes from their relationship to the Galois groups of

compositions of rational functions. We restate the following result from [20, Lemma 2.5].
Lemma 3.1. Let K be a ﬁeld and let ψ, γ P Krxs with degpψq “ ℓ and degpγq “ d. We assume
that ψ˝ γ has ℓd distinct roots in sK and that ψ is irreducible over K. Let α1, . . . , αℓ be the roots of
ψ, Mi be the splitting ﬁeld of γpxq ´ αi over Kpαiq, and G “ GalKpψq. If H “ GalpMi{Kpαiqq,
then there is an embedding GalKpψ ˝ γq ď GrHs.
As in the introduction, for φ P Kpxq and n ě 1, we let Knpφq be the ﬁeld obtained by adjoining
all solutions of φnpxq “ 0 to K. Since φ has coefﬁcients in K, the extension Knpφq{K is Galois,
and we let GK,npφq :“ GalKpφnq be the Galois group of Knpφq{K. Since Kn´1pφq Ď Knpφq for
all n (with some separability assumptions), we may deﬁne GKpφq to be the inverse limit of the
GK,npφq. Eschewing the generic situation for reasons of complexity, we focus our attention on the
family of iterates of φpxq “ xd ` f for f P Fprts. We now restate and prove a Serre-type ﬁnite
index Theorem for GKpφq from the introduction; this is the ﬁrst (unconditional) result of this form
over any global ﬁeld in the non-quadratic case:
Theorem 1.2. Let K “ Fpptq, let f P K and let let d ě 2 be coprime to p. If f R K p and
φpxq “ xd ` f , then the following statements hold:
(1) Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0 for all ﬁnite subsets S Ď VK.
(2) If d is an odd prime, d ı 1 pmod pq, f P OK and f R Kpµdqd, then GKpµdqpφq ď Wpdq is

a ﬁnite index subgroup.

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

13

Proof. To prove the ﬁrst statement, it sufﬁce to show that φ is dynamically 2-power non-isotrivial;
see Deﬁnition 1 and Theorem 1.1 above. When d “ 2, it sufﬁce to calculate the j-invariant of the
elliptic curve Eφ from (31) above. In particular, we compute that

1
64

jpEφq “ ´f 3 ` 9f 2 ´ 27f ` 27

f 2 ` 2f ` 1

,

which cannot be constant unless f is constant. Therefore, we may assume that d ě 3. If d is odd,
then t xidx

2 ´ 1 is a basis for the space of regular 1-forms [23, Theorem 3] on

y u for 0 ď i ď d2´1

C2,2pφq : Y 2 “ φ2pXq “ pX d ` fqd ` f.

To see that C2,2pφq is non-singular, use the discriminant formula in [17, Lemma 2.6]; there we see
that the discriminant of φ2 is zero if an only if φp0q ¨ φ2p0q “ f ¨ pf d ` fq “ 0. This is impossible,
since f is non-constant.
We now calculate the Kodaira-Spencer map associated to the surface C2,2pφq Ñ P1 using [22].
In keeping with the notation in [22, §5.2], let tPsu for 1 ď s ď d2 be the set of roots of φ2, and let
t denote the partial derivatives of φ2 with respect to x and t respectively. It follows from
x and φ2
φ2
Serre duality that the Kodaira-Spencer matrix with respect to the standard basis above is

(32)

P i`j
s φ2
2φ2

mi,j “ÿs
xpxq “ d2¨pφpxq¨xqd´1 and φ2

tpPsq
xpPsq2

;

see [22, §5.2]. One computes that φ2

tpxq “ f1¨pd¨pφpxqqd´1` 1q. On
the other hand, since 0 “ φ2pPsq “ φpφpPsqq, we may write φpPsq “ ζs ¨ αf where αf :“ d?´f is
a ﬁxed d-th root of ´f in sK and ζs is a d-th root of unity. In particular, it follows from (32) that

mi,j “ˆ f1

2d4f 2˙ ¨ÿs

P i`j´2d`2

s

¨´ζ 2

s α2

f ´ d ¨ αf ¨ f ¨ ζs¯.

(33)

To show that the Kodaira-Spencer map is non-zero, it sufﬁces to ﬁnd a single entry mi,j ‰ 0. To
do this, let i “ d ´ 2 and j “ 0. In this case, we see from (33) that

md´2,0 “ˆ f1

2d4f 2˙ ¨ÿs

1

ζsαf ´ f ¨´ζ 2

s α2

f ´ d ¨ αf ¨ f ¨ ζs¯

On the other hand, the formal identity xn ´ yn “ px ´ yq ¨ pxn´1 ` yxn´2 ` ¨¨¨ ` yn´2x ` yn´1q
applied to n “ d, x “ ζsαf and y “ f implies that
s `ˆ´αd´2
md´2,0 “ˆ f1

s `¨¨¨`ˆ´f d´1

2d4f 2˙ ÿs ˆˆ´αd´1

f d ` f ˙ζ d´2

f´d¨αf¨f¨ζs¯.

s α2

¨ f

f

After regrouping terms and changing the order of summation, we see that

f

f d ` f˙ζ d´1
md´2,0 “ˆ f1

2d4f 2˙¨ˆp1 ´ dq ¨ f
f d´1 ` 1 `

d´1ÿk“1ÿs

ck ζ k

f d ` f˙˙¨´ζ 2
s˙

for some constants ck, depending only on 1 ď k ď d ´ 1 (not on s). However, because the
function sending Ps Ñ ζs is a d : 1 surjection onto µd (the group of d-th roots of unity), the sum
řs ckζ k “ pd2ckqřζPµd

ζ k “ 0 for all indices k. We deduce that

(34)

md´2,0 “ p1 ´ dq ¨ f1
2d4pf d ` fq

.

14

WADE HINDES

In particular, md´2,0 ‰ 0 since f R K p and d ı 1 pmod pq. It follows that C2,2pφq is a non-isotrivial
curve of genus at least two, and Theorem 1.1 implies that Zpφ, Sq is ﬁnite and ĚAvgpZpφq, Sq “ 0
for all ﬁnite subsets S Ď VK as claimed.
On the other hand, essentially the same argument shows that Cd,2 : Y d “ φ2pxq is a non-
isotrivial curve of genus at least two, and we take this approach to prove Theorem 1.2 part (1)
when d ě 4 is even. To see that Cd,2 is non-isotrivial, we use the differentials xd´2dx
y , which
are both holomorphic by [23, Theorem 3], to compute a non-zero entry of the Kodaira-Spencer
matrix. In particular, the same Serre duality argument in [22, §5.2] implies that

yd´1 and dx

(35)

mpd´2,d´1q,p0,1q “ÿs

ResPsˆ xd´2 φ2
x ˙dt “ÿs
xpPsq and px ´ Psq is of degree d; here Res
since yd “ φ2pxq, so that φ2pxq{px ´ Psq|Ps “ φ2
denotes the residue map on the differentials of a curve [9, Theorem 7.14.1]. Hence, mpd´2,d´1q,p0,1q
is nothing but 2{d ¨ md´2,0 from the hyperelliptic case on (32). We deduce that

tpPsq dx
xpPsq2

d´2 φ2
d ¨ φ2

yd φ2

dt,

t dx

Ps

mpd´2,d´1q,p0,1q “ p1 ´ dq f1

d5 pf d ` fq ‰ 0,

which completes the proof of the ﬁrst statement.

Now for the proof of part (2). In what follows, we view φ over Kpµdq. If d is a prime and
f R Kpµdqd, then we ﬁrst show that φn is irreducible over Kpµdq for all n ě 1. To see this, we
must rule out the presence of d-powers in the orbit of zero. Suppose that φnp0q P Kpµdqd for some
n ě 2. Since, φnp0q “ pppf d ` fqd ` fqd ¨¨¨ ` fqd ` f and OKpµdq is a UFD, we may write
φnp0q “ f ¨ gn for some gn P OKpµdq coprime to f. It follows that f and gn must both be d-powers,
a contradiction. Hence, φnp0q R Kpµdqd for all n ě 1, and [8, Theorem 8] implies that all iterates
of φ are irreducible over Kpµdq.
As for the Galois groups of iterates of φ, note that Lemma 3.1 (applied inductively to ψ “ φ
and γ “ φ) implies that GKpµdqpφq ď Wpdq. On the other hand, we see that the proofs of Theorem
1.1 and Theorem 1.2 part (1) imply that the d-free part of all but ﬁnitely many terms of the orbit
Oφpbq contains primitive prime divisors whenever ˆhφpbq ‰ 0. In particular, since degpφnp0qq “
dn ¨ degpfq goes to inﬁnity, this holds for b “ 0. Hence, if Kmpφq is a splitting ﬁeld of φm over
Kpµdq, then GalpKnpφq{Kn´1pφqq – pZ{dZqdn for all but ﬁnitely many n; see [8, Theorem 25].
Therefore, GKpµdqpφq ď Wpdq is a ﬁnite index subgroup as claimed.
Remark 3.2. It follows from Theorem 1.2 that GKpµdqpφfq ď Wpdq is a ﬁnite index subgroup for
all non-constant f P K. To see this, apply Theorem 1.2 to the ﬁeld K0 “ Fppfq – Fpptq “ K and
the polynomial φpxq “ x2 ` t and then use the fact that rFpptq : Fppfqs “ hpfq to get the index
bound

(cid:3)

“Wpdq : GKpµdqpφfq‰ ď“Wpdq : GKpµdqpxd ` tq‰ ¨ hpfq.

In particular, the number of irreducible factors of φn
independently of n (cf. [8, Corollary 7]).
Remark 3.3. We note that Cℓ,1pφq : Y ℓ “ X d ` f is isotrivial for all ℓ ě 2: the map pX, Y q Ñ
´ X
d?f
can compute the Kodaira-Specer map for the surface Cℓ,mpφq. For instance, when ℓ “ 2, it follows

ℓ?f¯ is an isomorphism (deﬁned over sK) onto the curve Y ℓ “ X d ` 1. Alternatively, one

f over Kpµdq (and hence over K) is bounded

, Y

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

15

from [22, §5.2] that

f1 d?´f

2d2

mi,j “

¨ ÿζPµd

ζpyijq,

for some ´ 2d ` 2 ď yij ď ´d ´ 1, yij P Z.

In particular, we see that yij ı 0 pmod dq, from which it follows that mij “ 0 for all indices
y u of regular differentials on a
0 ď i, j ď d´1
hyperelliptic curve. In either case, the examples φpxq “ xd ` f underscore the importance of
passing to an iterate (and its corresponding superelliptic curve) to study primitive prime divisors.

2 ´ 1; here again we use the standard basis t xidx

Remark 3.4. Although it was enough to show that certain KS maps were non-zero to prove The-
orems 1.1 and 1.2, we believe that the KS maps for the curves C2,2pφq : Y 2 “ pxd ` fqd ` f and
Cd,2pφq : Y d “ pxd ` fqd ` f have maximal rank, from which it follows that the best possible
height bounds (involving a main term of 2`ǫ) hold in these families; see [21]. If such a result were
true, then one could give relatively small bounds for the size of the elements of Zpφ, Sq. In prac-
tice, one exploits the fact the KS matrix is symmetric (33) and the fact that the cyclotomic sums
ř ζ m
s and power sums ř P m vanish (a trace-zero fact), to prove that the KS map has maximal

rank.

As for characteristic zero function ﬁelds, we can make the index bounds explicit and uniform
when K “ kptq is a rational function ﬁeld; compare to uniform bounds in the quadratic case
[12]. Here we use work of Schmidt [34] and Mason [25] on Thue Equations over function ﬁelds;
conveniently, we need not worry about isotriviality, since it does not affect the height bounds in
this setting.
Theorem 1.3. Let K “ kptq be a rational function ﬁeld of characteristic zero, let d be an odd
prime, and let φpxq “ xd ` f for some non-constant f P krts. Then the following statements hold:

(1) If f R Kpµdqd, then we have the index bound
logd rWpdq : GKpµdqs ď

d10 ´ 1
d ´ 1 ` 10.

(2) If GalKpµdqpφ10q – rCds10, then GKpµdqpφq – Wpdq.
(3) If d ě 367 and GalKpµdqpφ5q – rCds5, then GKpµdqpφq – Wpdq

cq – rCdsn.

Moreover, if φpxq “ xd ` t, then GKpµdqpφq – Wpdq for all d ě 2 (not necessarily prime). In
particular, if k is a number ﬁeld and φcpxq “ xd ` c for some c P k, then there are inﬁnitely many
values of c satisfying Galkpµdqpφn
Proof. We work over the ground ﬁeld Kpµdq. We have already seen that f R Kpµdqd implies all
iterates of φpxq are irreducible over Kpµdq; see the proof of Theorem 1.2 above. We show that
for all n ě 11, there is a place vn P VKpµdq such that vnpφnp0qq ą 0, vpφnp0qq ı 0 pmod dq and
vpφmp0qq “ 0 for all 1 ď m ď n ´ 1.
n for some (d-power free) dn
satisfying

If there is no such place for some n ě 2, then φnp0q “ dn ¨ yd

degpdnq ď pd ´ 1q

t n

2 uÿi“1

degpφip0qq “ pd ´ 1q ¨

t n

2 uÿi“1

degpfq ¨ di´1 “ degpfq ¨ pdt n

2 u`1 ´ 1q;

16

WADE HINDES

see (9) in the proof of Theorem 1.1. Hence the curve Cpdnqφ
¨ pX d ` fq has an integral
point pφn´1p0q, dn ¨ ynq. Let K1 be a splitting ﬁeld of φ over Kpµdq, let gK1 be the genus of K1,
and let rK1 be the number of inﬁnite places of K1. Then It follows from [25, Theorem 15] that

: Y d “ dd´1

n

hK1pφn´1p0qq ď 18hK1pCpdnqφ

q ` 6gK1 ` 3rK1 ´ 3;

here hK1pCφq is the maximum height (relative to K1) of the coefﬁcients deﬁning Cpdnqφ
. However,
[34, 2.11] implies that hK1pαq “ d ¨ degpαq for all α P Kpµdq, and [34, Lemma H] implies that
gK1 ď pd ´ 1qpdegpfq ´ 1q. In particular, we see that

d ¨ dn´2 ¨ degpfq ď 18 ¨ d ¨ degpfq ¨ dt n

2 u`1 ` 6pd ´ 1qpdegpfq ´ 1q ` 3d ´ 3.

Therefore,

dn´1 ď 18dt n

2 u`2 ` p3d ´ 3q

2 degpfq ´ 1

degpfq

ď 18dt n

2 u`2 ` 6d ´ 6.

We deduce that n ď 2 logdp19q ` 5 ă 10.4 since d ě 3, n ě 2; statements (2) and (3) then follow
from [8, Theorem 2.5].
As for the index bound in statement (1), let Knpφq be the splitting ﬁeld of φn over Kpµdq. One
computes inductively via [5, §3.3 Theorem 19] that rCdsn is a group of order d
d´1 for all n ě 1.
On the other hand, since the subextensions Knpφq{Kn´1pφq are Kummer extensions of degree
ddn´1 for all n ě 11 by [8, Theorem 2.5] and the ﬁrst part of our proof, we have the index bound:

dn´1

logd“ rCdsn : GalKpµdqpφnq‰ “ logd

dn´1
d´1

d

rK10pφq : Kpµdqs ¨śn´1

j“10rKj`1pφq : Kjpφqs

.

dn ´ 1
d ´ 1 ´ pdn´1 ` dn´2 ` . . . d10 ` 10q ď

However, rK10pφq : Kpµdqs ě d10, since φ10 is an irreducible polynomial, and we deduce that
d10 ´ 1
d ´ 1 ` 10.

logd“ rCdsn : GalKpµdqpφnq‰ ď
Finally, we consider the special case φpxq “ xd ` t for all d ě 2 (not necessarily prime). We
note that the discriminant of φnp0q (as an element of krts) is non-zero. In particular, φnp0q is
square-free for all n. To see this, let p|d be a prime. Then the quotient map Z Ñ Z{pZ induces a
ring homomorphism Zrts Ñ pZ{pZqrts given by reducing coefﬁcients. Therefore, if φnp0q is not
square-free in sQrts (hence not square-free in Zrts), then the image of φnp0q P pZ{pZqrts is not
square-free. Hence, [5, §13.5 Prop. 33] implies that φnp0q and its formal derivative in pZ{pZqrts
must share a root. However. one sees that the formal derivative of φnp0q is 1 for all n ě 2 by the
power-rule. We deduce that φnp0q is square-free in krts for all n ě 1. It terms of valuations, this
means that vppφnp0qq “ 1 for all p P VK such that vppφnp0qq ą 0. On the other hand, a simple
degree computation shows

dn´1 ´ 1
degpφnp0qq “ dn´1 ą
d ´ 1 “ dn´2 ` dn´3 ` ¨¨¨ ` 1 “ degpφn´1p0qq ` ¨¨¨ ` degpφp0qq.
Therefore, it is impossible that all prime factors of φnp0q come from lower order iterates. Moreover,
since φnp0q is square-free, it follows from [8, Theorem 8] that all iterates of φ are irreducible over
Kpµdq. We deduce from [8, Theorem 25] that GKpµdqpφq – Wpdq as claimed. The statement about
specializations follows from Hilbert’s irreducibility theorem [37, Theorem 1, Theorem 3.4.1] (cid:3)

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

17

Remark 3.5. The proof of Theorem 1.3 implies that

max  nˇˇ n P Zpxd ` f, 0, dq for some f P krts, degpfq ě 1, d ě 2( ď 10;

here Zpxd ` f, 0, dq is the d-th Zsigmondy set [11, Deﬁnition 2], representing terms which do
not have d-power free primitive prime divisors. Equivalently, after the 10th stage of iteration, we
always see d-power free primitive prime in the orbit of zero (independent of both f P krts and d)
in characteristic zero (c.f [24, Theorem 1.1]).
Remark 3.6. It is tempting to think that the discriminant trick we used to prove GKpµdqpφq – Wpdq
for φpxq “ xd ` t works for all φpxq “ xd ` f satisfying f R Kpµdqd. However, surjectivity
already fails for d “ 2: when φpxq “ x2 ´ pt2 ` 1q, we show in [12] that rWp2q : GKpφqs “ 2,
even though ´pt2 ` 1q is never a square in characteristic zero; this example is essentially due to
Stoll [45]. Likewise, this discriminant trick does not work in prime characteristic: when d “ 5,
p “ 43 and φpxq “ x5 ` t, the discriminant of φ6p0q is zero in Fprts. Nevertheless, a ﬁnite index
statement (not necessarily surjective) holds by Theorem 1.2.
Remark 3.7. To the author’s knowledge, there is not a single pair pd, cq of values d ě 3 and c P Q
for which GalQpµdqpφn
cq is known for large n. Therefore, Theorem 1.3 represents some progress
and solves the inverse Galois problem for rCdsn.
Remark 3.8. To prove the surjectivity of the ℓ-adic Galois representation attached to an elliptic
curve, it sufﬁces to prove the surjectivity onto some ﬁnite quotient. Namely, if G ď GL2pZℓq
is a closed subgroup that surjects onto GL2pZ{ℓnZq for some small n, then G must be equal to
GL2pZℓq; see, for instance, [46]. In particular, this is a fact from group theory. On the other hand,
such a property will fail in general for closed subgroups of Wpdq. Nevertheless, we have proven
this rigidity for subgroups GKpφq ď Wpdq coming from dynamics in Theorem 1.3.

References

[1] M. Baker, A ﬁniteness theorem for canonical heights attached to rational maps over function ﬁelds, Journal f ur

die reine und angewandte Mathematik, Crelle 626 (2009): 205-233.

[2] A. S. Bang, Taltheoretiske Undersogelse, Tidsskrift Mat., 4.5 (1886): 70-80, 130-137.
[3] N. Boston and R. Jones, The Image of an arboreal Galois representation, Pure and Applied Mathematics Quar-

terly 5.1 (Special Issue: in honor of Jean-Pierre Serre, Part 2 of 2) (2009): 213-225.

[4] J. Cahn, R. Jones, and J. Spear, Powers in orbits of rational functions: cases of an arithmetic dynamical Mordell-

Lang conjecture, preprint arXiv:1512.03085

[5] D. Dummit and R. Foote, Abstract algebra, Vol. 1984. Hoboken: Wiley, 2004.
[6] G. Faltings, Endlichkeitss¨atze f¨ur abelsche Variet¨aten ¨uber Zahlk¨orpern, Inventiones mathematicae, 73.3 (1983):

349-366.

[7] C.Gratton, K.Nguyen, and T.Tucker, ABC implies primitive prime divisors in arithmetic dynamics, Bull. London

Math. Soc. 45 (2013): 1194-1208.

[8] S. Hamblen, R. Jones, and K. Madhu, The density of primes in orbits of zd ` c, Int. Math. Res. Not. 7 (2015):

1924-1958.

[9] R. Hartshorne, Algebraic geometry, Vol. 52. Springer Science and Business Media, 1977.
[10] W. Hindes, The average number of integral points in orbits, preprint, arXiv:1509.00752 (2015).
[11] W. Hindes, Prime divisors in polynomial orbits over function ﬁelds, preprint: arXiv:1504.08334.
[12] W. Hindes, Galois uniformity in quadratic dynamics over kptq, J. Number Theory 148 (2015): 372-383.
[13] P. Ingram, Arboreal Galois representations and uniformization of polynomial dynamics, Bull. London Math. Soc.

45.2 (2013): 301-308.

[14] P. Ingram and J. Silverman, Primitive divisors in arithmetic dynamics, Mathematical Proceedings of the Cam-

bridge Philosophical Society. 146. No. 02. Cambridge University Press, 2009.

[15] P. Ingram and J. Silverman, Uniform estimates for primitive divisors in elliptic divisibility sequences, Number

theory, analysis and geometry. Springer US, 2012. 243-271.

18

WADE HINDES

[16] R. Jones, Galois representations from pre-image trees: an arboreal survey, Pub. Math. Besanc¸on (2013): 107-136.
[17] R. Jones, The density of prime divisors in the arithmetic dynamics of quadratic polynomials, J. Lond. Math. Soc.

78.2 (2008): 523-544.

[18] R. Jones and A. Levy, Eventually stable rational functions, preprint, arXiv:1603.00673.
[19] R. Jones and M. Manes, Galois theory of quadratic rational functions, Comment. Math. Helv. 89.1 (2014): 173-

213.

[20] J. Jamie, P. Kurlberg, K. Madhu, and T. Tucker, Wreath products and proportions of periodic points, Int. Math.

Res. Not. (2015): rnv273.

[21] M. Kim, Geometric height inequalities and the Kodaira-Spencer map, Compositio Math. 105.1: 43-54 (1997).
[22] M. Kim, D. Thakur, and J. Voloch, Diophantine approximation and deformation, Bulletin de la Soci´et´e

Math´ematique de France 128.4 (2000): 585-598.

[23] J. Koo, On holomorphic differentials of some algebraic function ﬁeld of one variable over C, Bulletin of the

Australian Mathematical Society 43.03 (1991): 399-405.

[24] H. Krieger, Primitive Prime Divisors in the Critical Orbit of zd ` c, Int. Math. Res. Not. 23 (2012): 5498-5525.
[25] R.C.Mason, Diophantine equations over function ﬁelds, Cambridge University Press,1984.
[26] V. Kumar Murty and J. Scherk, Effective versions of the Chebotarev density theorem for function ﬁelds, C. R.

Acad. Sci. Paris S´er. I Math. 319.6 (1994): 523-528.

[27] A. Mikl´os and B. Vir´ag, Dimension and randomness in groups acting on rooted trees, J. Amer. Math. Soc. 18.1

(2005): 157-192.

[28] A. Moriwaki, Geometric height inequality on varieties with ample cotangent bundles, J. Algebraic Geom., 4.2

(1995): 385-396.

[29] R. W. K. Odoni, The Galois theory of Iterates and Composites of Polynomials, Proc. London Math. Soc., 51.3

(1985): 385-414.

[30] R. Pink, Proﬁnite iterated monodromy groups arising from quadratic polynomials, preprint arXiv:1307.5678.
[31] B Rice, Primitive prime divisors in polynomial arithmetic dynamics, Integers 7.1 (2007): 26.
[32] M. Rosen, Number theory in function ﬁelds. Vol. 210. Springer-Verlag, (2002).
[33] A. Schinzel, Primitive divisors of the expression an ´ bn in algebraic number ﬁelds, J. Reine Angew. 268/269

(1974), 27-33, Collection of articles dedicated to Helmut Hasse on his seventy-ﬁfth birthday, II.

[34] W. Schmidt, Thue’s equation over function ﬁelds, Journal of the Australian Mathematical Society, Society.

(Series A) 25.04 (1978): 385-422.

[35] J.-P. Serre, Abelian ℓ-adic representations and elliptic curves, W.A. Benjamin Inc. New York-Amsterdam 1968.
[36] J-P. Serre, Lectures on NX ppq, CRC Press, 2011.
[37] Serre, Jean-Pierre. Topics in Galois theory, CRC Press, 2007.
[38] J. Silverman, Advanced Topics in the Arithmetic of Elliptic Curves, Graduate Texts in Math. 151, Springer

(1994).

[39] J. Silverman, The Arithmetic of Elliptic Curves, Graduate Texts in Mathematics, Springer-Verlag, GTM 106,

1986, Expanded 2nd Edition, 2009.

[40] J. Silverman, Integer points, Diophantine approximation, and iteration of rational maps, Duke Math. J 71.3

(1993): 793-829.

[41] J. Silverman, Primitive divisors, dynamical Zsigmondy sets, and Vojta’s conjecture, Journal of Number Theory

133.9 (2013): 2948-2963.

[42] J. Silverman, The Arithmetic of Dynamical Systems, Vol. 241, Springer, 2007.
[43] V. Sookdeo, Integer points in backward orbits, J. Number Theory, 131.7 (2011): 1229-1239.
[44] H. Stichtenoth, Algebraic function ﬁelds and codes, Springer-Verlag, Vol. 254, 1993.
[45] M. Stoll, Galois groups over Q of some iterated polynomials, Arch. Math. 59 (1992): 239-244.
[46] A. Vasiu, Surjectivity criteria for p-adic representations, Part 1 Manuscripta Mathematica 112.3 : 325-355.
[47] P. Vojta, Diophantine approximation and Nevanlinna theory, Arithmetic geometry, Springer Berlin Heidelberg,

2010: 111-224.

[48] J.-F. Voloch, Diophantine geometry in characteristic p: a survey, Arithmetic geometry (Cortona 1994), Sympos.

Math. XXXVII (Cambridge University Press, 1997) 260-278.

[49] K. Zsigmondy, Zur Theorie der Potenzreste, Monatsch. Math. Phys. 3 (1892): 265-284.

ZSIGMONDY SETS, GALOIS GROUPS, AND THE KODAIRA-SPENCER MAP

19

Wade Hindes, Department of Mathematics, CUNY Graduate Center, 365 Fifth Avenue, New

York, New York 10016-4309.

E-mail address: whindes@gc.cuny.edu

