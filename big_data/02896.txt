6
1
0
2

 
r
a

M
9

 

 
 
]

.

R
P
n
i
f
-
q
[
 
 

1
v
6
9
8
2
0

.

3
0
6
1
:
v
i
X
r
a

Small-time asymptotics for basket options

- the bi-variate SABR model and
the hyperbolic heat kernel on H3

Martin Forde∗

Hongzhong Zhang†

March 10, 2016

Abstract

We compute a sharp small-time estimate for the price of a basket call under a bi-variate SABR model with
both β parameters equal to 1 and three correlation parameters, which extends the work of Bayer,Friz&Laurence
[BFL14] for the multivariate Black-Scholes ﬂat vol model, and we show that the [BFL14] result has to be adjusted
for strikes above a certain critical value K ∗ where the convolution density admits a higher order saddlepoint. The
result follows from the heat kernel on hyperbolic space for n = 3 combined with the Bellaiche[Bel81] heat kernel
expansion and Laplace’s method, and we give numerical results which corroborate our asymptotic formulae.
Similar to the Black-Scholes case, we ﬁnd that there is a phase transition from one “most-likely” path to two
most-likely paths beyond some critical K ∗. 1

1

Introduction

Basket options (i.e. options on a linear combination of n assets) are both interesting and diﬃcult to price, in part
because there is no closed-form expression for the price of a basket call option even under a simple n-dimensional
ﬂat-vol Black-Scholes model for n ≥ 2, because a sum of independent log-normal random variables is no longer log-
normal and does not admit a closed-form density. Recently, Benaim,Friz&Laurence[BFL14] compute a small-time
estimate for the density associated with pricing a basket call under a two-dimensional Black-Scholes model using
Laplace’s method; somewhat surprisingly, they ﬁnd that there is “phase-transition” from one “most-likely” value
for the two stock price values (S1

T ) at maturity T , to two most-likely values for this vector.

T , S2

Gulisashvili&Tankov[GT15] characterize the implied volatility of a basket call option at small and large strikes,
[GT15] also compute the leading order term for implied volatility when
in a multi-variate Black-Scholes setting.
the asset prices follow the multidimensional Black-Scholes model evaluated at an independent time-change, and
they also deal with a general model where the dependence between assets is described by a copula. Armstrong
et al.[AFLZ16] compute a small-time expansion for implied volatility under a general uncorrelated local-stochastic
volatility model using the Bellaiche[Bel81] heat kernel expansion combined with Laplace’s method; they also con-
sider the case when the correlation ρ ≤ 0 and in this case the approach still works if the drift of the volatility
takes a speciﬁc functional form and there is no local volatility component, which includes the SABR model for
β = 1, ρ ≤ 0.

In this article, we ﬁrst revisit the problem of small-time pricing of basket call options under an uncorrelated two-
dimensional Black-Scholes model. In this setting, we correct an error in the main formula in [BFL14], speciﬁcally
by showing that the “rate function” in the exponent of the saddlepoint approximation is qualitatively diﬀerent
for strikes values greater than some critical strike K∗, where there is a phase transition from one “most-likely”
conﬁguration to two most-likely paths beyond a certain critical. We then compute the small-time behaviour of a
basket call option under a bi-variate uncorrelated SABR model with β parameters equal to 1 with three correlation

∗Dept. Mathematics, King’s College London, Strand, London, WC2R 2LS (Martin.Forde@kcl.ac.uk)
†Dept. Statistics, Columbia University, New York, NY 10027 (hzhang@stat.columbia.edu)
1We thank Stefano de Marco and the HAJ for many useful discussions.

1

parameters for two correlated assets, and (as for the Black-Scholes case) we ﬁnd that the same phase transition
eﬀect occurs at the same critical strike. The result follows from the known expression for the hyperbolic heat kernel
on H3 combined with the Bellaiche small-time heat kernel expansion over compact domains and Laplace’s method
(in a similar spirit to [AFLZ16]). We then extend this result to a correlated bivariate SABR model with three
correlation parameters.

2 The bi-variate Black-Scholes model - amending the [BFL14] formula

We ﬁrst consider the simplest case of two-dimensional Black-Scholes model for two asset price processes S(1)
as discussed in section 2 in [BFL14]:

t

, S(2)

t

( dS(1)

dS(2)

t = S(1)
t = S(2)

t dW 1
t dW 2

t , S(1)
t , S(2)

0 = 1,
0 = 1,

(1)

where W 1, W 2 are two independent standard Brownian motions.

The following proposition corrects Eqs 1a,1b in [BFL14], speciﬁcally by showing that when K > K∗, φ(K) is

no longer equal to [log( 1

2 K)]2.

Theorem 2.1 For the model in (1), we have the following small-time behaviour for the density f (K) of S(1)

t +S(2)

t

:

f (K) =


t

e− φ(K)
4 e− 1

8

1
4

K 3√πt ¯h′′
K ( 1
2 K)
Γ( 1
4 )
2√2πe2 t− 3
( 3
5 )
√πt ¯h′′

2

K (x∗) [x∗(K−x∗)]

[1 + O(t)]

t [1 + o(1)]
e− φ(K)

t

3
2

[1 + O(t)]

(K ∈ (0, K∗]) ,
(K = K∗),

(K > K∗)

¯hK(x) and φ(K) = 1
2

¯hK(x∗(K)). When

where K∗ = 2e, ¯hK(x) = (log x)2 + (log(K − x))2, x∗(K) = argminx∈(0, 1
K ∈ (0, K∗], x∗ and φ simplify to x∗(K) = 1
2 K)]2.
Proof. Set hK(x) = (log x + 1
f (K) of S(1)

2 t)2 + (log(K − x) + 1

is given by the convolution of two log normal densities:

2 K and φ(K) = [log( 1

2 K]

t + S(2)

t

2 t)2. Then proceeding as in [BFL14], we know that the density

0

0

f (K) =Z K
=Z K
=Z K
=Z K

0

0

1

2πt x(K − x)

1

2πt x(K − x)

1

2πt [x(K − x)] 3

2

1

2πt [x(K − x)] 3

2

e− hK (x)

2t dx

e−

¯hK (x)

2t e− 1

2 (log(K−x)+log x)e− 1

4 t dx

e−

e−

¯hK (x)

2t e− 1

4 t dx

¯hK (x)

2t dx · [1 + O(t)] .

(2)

To apply the Laplace’s method (see e.g. Chapter 4, Theorem 7.1 in Olver[Olv74] for a precise statement) in the
small-t limit, we have to minimize ¯hK(x) over x ∈ (0, K), which leads to the ﬁrst-order condition:

¯h′K(x) = 0 .

(3)

[BFL14] found that x = 1
when K ∈ (0, 2e] ; for K > 2e, x = 1
minimizers x∗ = x∗(K) and K − x∗ either side of and equidistant from 1
g(x) = (log x)2; then

2 K is only a global minimizer
2 K becomes a local maximizer, and in this case ¯hK(x) has two global
2 K. We now prove this assertion: consider

2 K solves (3). However, as seen in Lemma 2.2 below, x = 1

¯hK(x) = g(x) + g(K − x)

,

x ∈ (0, K).

2

Clearly, by the deﬁnition of ¯hK, we have ¯hK(x) = ¯hK(K − x) for all x ∈ (0, K), and x = 1
¯hK. Moreover, from g′′(x) = 2 1−log x

x2 we have

2 K is a critical value for

1
4

¯h′′K(

K
2

) =

1
2

g′′(

K
2

) =

2 K)

1 − log( 1
( 1
2 K)2

.

Then we have the following:

Lemma 2.2 Set K∗ = 2e. Then we have the following classiﬁcation for the minimizer(s) of ¯hK(x):

• If K ∈ (0, K∗), ¯h′′K(x) = ¯h′′K(K − x) > 0 for all x ∈ (0, K), so x∗ = 1
• If K = K∗, ¯h′′K(x) = ¯h′′K(K − x) > 0 for all x ∈ (0, K)\{ 1
2 K} and ¯h′′K( 1

2 K is the unique global minimum of ¯hK;

so x∗ = 1

2 K is the unique global minimum of ¯hK;
2 K) > 0,

2 K) = 0 and ¯h′′′′K ( 1

2 K) = ¯h′′′K( 1

• If K ∈ (K∗,∞), ¯hK has two global minima, x∗ and K − x∗, with x∗ ∈ (0, 1

2 K).

Proof of Lemma 2.2. See Appendix A.

For K 6= 2e, from the calculations above, we ﬁnd that

¯hK(x) = ¯hK(x∗) +

1
2

¯h′′K(x∗)(x − x∗)2 + O(x − x∗)3

and ¯h′′K(x∗) > 0. If we now apply the usual Laplace approximation to (2), we ﬁnd that when K ∈ (0, 2e)

f (K) =

=

1

2

8

qπt ¯h′′K(x∗) [x∗(K − x∗)] 3
K 3qπt ¯h′′K( 1

2 K)

¯hK (x∗ )

e−

2t

¯hK (x∗ )

2t

e−

[1 + O(t)]

[1 + O(t)]

(4)

as t → 0, where ¯hK(x∗) = 2[log( 1
2 K)]2 (note that we have ignored the rigour of dealing with the two tail integrals
here; this is deal with in the next section when we look at the bi-variate SABR models). When K > 2e we have
two saddlepoints with equal contributions at x∗ and K − x∗ and ¯h′′K(x∗) = ¯h′′K(K − x∗), so we have

f (K) =

2

¯hK (x∗ )

2t

e−

[1 + O(t)]

qπt ¯h′′K(x∗) [x∗(K − x∗)] 3

2

as t → 0. These equations correct equation 1a) in [BFL14].
At the special value K = 2e, ¯h′′K(x∗) = 0, so the standard Laplace method does not apply. However, since ¯hK(x)
is symmetric about x = 1

2 K, we have that ¯h′′′K(x∗) = 0. Thus, we have

¯hK(x) = ¯hK(x∗) +

1
24

¯h′′′′K (x∗)(x − x∗)4 + O(x − x∗)5.

where h′′′′K (x∗) = 20e−4. Using the identity

as in [BFL14], using (2) we ﬁnd that

Z ∞

−∞

e−ζx4

dx =

Γ( 1
4 )
2ζ 1

4

¯hK (x∗ )

2t

e−

[1 + o(1)]

3

2 2ζ

1
4

t− 3

4 e− 1

t [1 + o(1)]

1
4

(K = K∗)

(K = K∗)

f (K) =

=

=

Γ( 1
4 )

2πt [x∗(K − x∗)]

Γ( 1
4 )
¯h′′′′(x∗))

4πe3 ( 1
48
Γ( 1
4 )
12 ) 1
4πe2 ( 5

4

t− 3

4 e− 1

t [1 + o(1)]

3

(5)

(6)

1.5

1.0

0.5

Figure 1: Here we have plotted φ(K) (in blue) against Λ(K) = [log( 1
for K ≤ K∗ ≈ 5.43656 (dotted line)

2 K)]2 (in grey), and we see that they agree

3

4

5

6

7

8

1.2

1.0

0.8

0.6

0.4

0.2

1.0

1.5

2.0

2.5

3.0

3.5

Figure 2: Here we have plotted the saddlepoint approximation for the convolution density f (K) of S1
t + S2
in Theorem 2.1 (in grey) verses the exact density of S1
numerically (in blue), for t = .05 over the range K ∈ (2, K∗ + 2).

t + S2
t
t obtained by computing the convolution integral

48 h′′′′K (x∗)/t = 5

where ζ = 1
12 e−4t−1 and x∗ = e in this case. Note that we have not justiﬁed that we can ignore the
O(x − x∗)5 error term here; however, the use of Laplace’s method for higher order saddlepoints is made rigorous
in e.g. Eq 7.2.9 in [BH10], but the error term is now only known to be o(1) as opposed to O(t). (6) now corrects
equation 1b) in [BFL14].

Corollary 2.3 For the model in (1), we have the following small-time behaviour for basket call options:

E(S(1)

t + S(2)

t − K)+ = (2 − K)+ +

3

2 e− φ(K)

t

t [1 + o(1)]

2

t

2 K)

K ( 1

Kφ(K)√π ¯h′′
√t [1 + O(t)]
2√π
Γ( 1
4 )
4 e− 1
( 3
5 )
2√2π
(x∗)2+(K−x∗)2
φ(K)√π ¯h′′

t

1
4

5

K (x∗) [x∗(K−x∗)]

[1 + O(t)]

(K = 2)

(K ∈ (0, K∗) \ {2})

(K = K∗)

3

2 e− φ(K)

t

t

3
2

[1 + O(t)]

(K > K∗)




Proof. From the generalized Itˆo formula (sometimes referred to as the Tanaka formula), we have

E(S(1)

t + S(2)

t − K)+ − E(2 − K)+ =

1

2Z t

0

E(δ(S(1)

u + S(2)

u − K)[(S(1)

u )2 + (S(2)

u )2])du

where (here and elsewhere) for two random variables X and Y , E(δ(X − x)F (Y )) := 1

dx E(1X∈dxF (Y )) for a

4

measurable function F . Using the convolution idea of Theorem 2.1, we have that

E(δ(S(1)

u + S(2)

u − K)[(S(1)

u )2 + (S(2)

u − K + x))[x2 + (K − x)2]dx

0

E(δ(S(1)

u − x, S(2)
1

u )2] =Z K
=Z K
=f (K) · [(x∗)2 + (K − x∗)2] · [1 + O(u)].

2πu[x(K − x)]

¯hK (x)

e−

2u

3
2

0

· [x2 + (K − x)2]dx · [1 + O(u)]

We now recall the following asymptotic relation

2e− k2

2t t − k√2πt
√t
2 e− k2

2t

3

+ k√2π Erf(

k
√2t

)

Υ(k, t) :=Z t

0

1
√u

e− k2

2u du =

=

[1 + O(

2
k2 t

t
k2 )]
for k > 0, which just follows from the well known result that Φc(z) ∼ 1
z2 )] as z → ∞. Note
z√2π
that the leading order error term here is O( t
k2 is not ≪ 1,
which is often the case in practice in ﬁnancial applications (we will return to this point in the numerics part in
section 5.3). If we apply (7) to the asymptotic expression for f (K) in Theorem 2.1, we obtain the desired result
for K 6= 2e. Similarly, using
Z t

k2 ) so this approximation will generally work badly if

e−z2/2[1 + O( 1

e−k2/2udu =

√k
2 1

4 e− k2

2
k2 t

(k > 0)

Γ(−

1
u 3

k2
2t

) =

(7)

(8)

1
4

2t

0

,

t

4

4

5

we obtain the stated asymptotic behaviour for K = 2e. For K = 2, we have φ(K) = 0, so using

we see that

du = 2√t

Z t

0

1
√u

E(S(1)

t + S(2)

t − K)+ =

=

=

using that x∗ = 1

2 K and ¯h′′K( 1

2 K) = 4.

√t · [(x∗)2 + (K − x∗)2][1 + O(t)]
√t · [(

K)2][1 + O(t)]

K)2 + (

1
2

1
2

16

16

2 K)

K 3qπ ¯h′′K( 1
K 3qπ ¯h′′K( 1
2
√π

2 K)
√t [1 + O(t)]

3 Background on the heat kernel and hyperbolic space

Consider a diﬀusion process on M = Rn with inﬁnitesimal generator L. In local coordinates, L takes the form

L =

1

2 X1≤i,j≤n

aij (x)

∂2

∂xi∂xj

bi(x)

∂
∂xi

.

+ X1≤i≤n

(see Theorem 3.1 below for the conditions that we impose on b, σ via conditions on M and A). Now furnish M
with a Riemmanian metric gij = (aij)−1 so that M is a smooth Riemmanian manifold with a single chart given by
the identity map. We can write L as 1
∂i(p|g| gij∂j ) is the Laplace-Beltrami operator
and Ai = bi − 1
∂j(p|g| gij) is a smooth ﬁrst-order diﬀerential operator and |g| = | det gij| (recall that
gij = (gij)−1).

2 ∆ + A, where ∆ =Pi,j

1√|g|

1√|g|

2Pj

5

Given such an operator L, the heat kernel p(x; y, t) of L is the fundamental solution to the heat equation
2 ∆)u, which is also the transition density of the diﬀusion X with respect to the Riemannian volume

∂tu = (A + 1
measure p|g| (see [Hsu] for more details); to obtain the transition density ˆp(x; y, t) of X with respect to Lebesgue
measure dx1...dxn, we set

where √g is shorthand for √det g.

ˆp(x; y, t) = p(x; y, t)pg(y) ,

Throughout, we let ρ(x, y) denote the Riemannian distance between two points x, y ∈ M .

Theorem 3.1 (Theorem 4.1 in [Bel81]). Let M be a C4-Riemannian manifold and A a C4-vector ﬁeld. The heat
kernel p(x; y, t) of the operator 1

2 ∆ + A satisﬁes:
2 u0(x, y) e− 1

p(x; y, t) = (2πt)− n

2 ρ(x,y)2/t+A(x,y)[1 + o(1)]

(t → 0)

(9)

for some function u0(x, y) (see e.g. [Hsu02] or [AFLZ16] for details on how to compute u0(x, y)), where (x, y) ∈
(M × M ) \ C(M ) 2, and

A(x, y) =Z 1

0 hA, ˙γ(s)i ds,

for the unique distance-minimizing geodesic γ : [0, 1] −→ M joining x and y. The estimate (9) is uniform on
compact subsets of (M × M ) \ C(M ).

We know that Theorem 1.1 holds in general. However, when M is the upper half space H3 = {(x, y, a) ∈ R3 :
a2 (dx2 + dy2 + da2) and A = 0, from

a > 0}, and the metric (gij) is the Poincar´e metric with line element ds2 = 1
e.g. [GM98] we also have the known exact formula:

p(x; y, t) =

1

ρ

(2πt) 3

2

sinh ρ

e− 1

2 t− ρ2
2t ,

(10)

where ρ is shorthand for ρ(x, y). Equating (10) with (9) for A = 0, we see that we must have that

for this metric.

u0(x, y) =

ρ

sinh ρ

4 The bi-variate SABR model - zero correlation case

We work on a model (Ω,F , P) throughout, with a ﬁltration Ft supporting three independent Brownian motions
which satisﬁes the usual conditions.

We now consider the following bi-variate SABR model for two asset price processes S(1)

t

, S(2)

t

:

dXt = − 1
2 a2
t dt + atdW 1
t ,
dYt = − 1
2 a2
t dt + atdW 2
t ,
dat = atdW 3
t

(11)




where Xt = log S(1)
The law of (Xt − X0, Yt − Y0) is independent of (X0, Y0), so without loss of generality we set X0 = 0, Y0 = 0.

and W 1, W 2, W 3 are three independent standard Brownian motions and a0 > 0.

t

, Yt = log S(2)

t

We ﬁrst recall some facts about the geometry associated with this model:

2C(M ) is the subset of points (x, y) in M × M such that x lies in the cut locus of y

6

• The associated Riemmanian metric (gij ) is the three-dimensional hyperbolic metric on R × R × R+ with line

a2 (dx2 + dy2 + da2), and volume element √g = 1
a3 .

element ds2 = 1

• From e.g. page 179 in [HL08], the geodesic distance between two points x0, y0, a0 and (x0, y0, a0) is given by

ρ = ρ(x0, y0, a0; x, y, a) = cosh−1[1 + |(x − x0)2 + (y − y0)2 + (a − a0)2|

2a0a

] .

(12)

• The straight lines perpendicular to a = 0 and the circles of H3 whose planes are perpendicular to the
hyperplane a = 0 and whose centres are in this hyperplane are the geodesics of H3 (see Proposition 3.1 on
page 127 in doCarmo[doC92]).

• The Laplace-Beltrami operator for H3 is given by

(see e.g. Eq 3.2 in [MY05]).

∆ = a2(∂2

x + ∂2

y + ∂2

a) − a∂a.

• For this model, A is given by Ai = bi − 1

1√g ∂j(√g gij) so A = (− 1

2 a2,− 1

2 a2, 1

2 a). Then we have

2Pj

1

A(x0, y0, a0; x, y, a) =Z 1
0 hA, ˙γi dt
a2A1 dx
=Zγ
[
dx
=Zγ
dt −
[−
1
= −
2

1
2

dt

dy
dt
1
2

1

a2A2 dy

1

a2A3 da

dt

]dt

]dt

+

da
dt

dt
1
2a

+

+

1
2

(x − x0) −

(y − y0) +

1
2

log

a
a0

.

(13)

• Combining (9), (10) and (13), we see that the density of (Xt, Yt, at) has the following small-time behaviour

over any compact set of (x, y, a):

ˆp(x0, y0, a0; x, y, a, t) = ˆp(x, y, a, t) =√g e− 1

2 (x−x0+y−y0) + 1

2 log a
a0

1

ρ

e− ρ2

2t [1 + o(1)]

√a
√a0
1

=

=

1
a3 e− 1
e− 1

√a0a 5

2

2 (x−x0+y−y0)

2t [1 + o(1)]

2

(2πt) 3
ρ

1

sinh ρ
e− ρ2

(2πt) 3

2

sinh ρ

2 (x−x0+y−y0)

1

ρ

(2πt) 3

2

sinh ρ

e− ρ2

2t [1 + o(1)],

(14)

as t → 0.

• Temporarily switching variables, we know that ˆp(x, y, a; x1, y1, a1, t) is a solution to the backward heat equa-

tion

∂t ˆp = −

1
2

a2(ˆpx + ˆpy) +

1
2

a2(ˆpxx + ˆpyy + ˆpaa) ,

subject to ˆp(x, y, a; x1, y1, a1, t) = δ(x − x1, y − y1, a − a1). If we now let

ˆp(x, y, a; x1, y1, a1, t) = e

then the PDE transforms to

1

2 (x−x1+y−y1) + 1

2 log a1

a q(x, y, a; x1, y1, a1, t),

1
2
8 − 1
with q(x, y, a; x1, y1, a1, t) = δ(x − x1, y − y1, a − a1), where V (y) = 3
operator as before.

a2(qxx + qyy + qaa) + V (y)q =

∂tq = −

aqa +

1
2

1
2

∆q + V (y)q,

4 a2 and ∆ is the Laplace-Beltrami

(15)

(16)

7

• The law of (Xt − x0, Yt − y0) is independent of x0, y0, so without loss of generality we set x0 = y0 = 0 from

here on. Then from (16) we see that

ˆp(x0, y0, a0; x, y, a, t) =e− 1

2 (x+y) 1
a3
2 (x+y) 1
a3
2 (x+y) 1
a3

≤e− 1
=e− 1

√a
√a0
√a
√a0
√a
√a0
1

3
8 t

e

3
8 t

e

1

dxdyda

1

dxdyda

EP0

EP0

(e− 1

4 R t

0 a2

sds 1(Xt,Yt,at)∈(dx,dy,da))

( 1(Xt,Yt,at)∈(dx,dy,da))

3

8 t ˆp0(x, y, a, t)

e

=e− 1

2 (x+y)

=e− 1

2 (x+y)

√a0a 5

2

1

√a0a 5

2

1

ρ

2

(2πt) 3
1

sinh ρ
ρ

3
8 t

e

e− 1
8 t

(2πt) 3

2

sinh ρ

e− 1

2 t− ρ2

2t

e− ρ2
2t ,

(17)

where P0 and ˆp0 denote the measure and transition density associated with the Laplace-Beltrami operator
i.e. without the additional A term. (17) provides a global upper bound on the transition density for (Xt, Yt)
we can use to deal with the tail integrals outside the compact set where we are applying the Bellaiche heat
kernel expansion.

From here on (in contrast to the previous section) we work in log space (i.e. x and y will refer to the log of the
ﬁrst and second asset price process), which will be more convenient when working with the hyperbolic metric and
the heat kernel. We also introduce the following quantities which will be needed in Theorem 4.1.

¯HK(x),

2 K)

x∗(k) :=argminx≤log( 1
¯HK(x) := cosh−1s1 +

1
a2
0

[ x2 + (log(K − ex))2],

and

ϕ(k) :=

1
2

[ ¯HK(x∗(k))]2,

a∗(x, y) :=qa2

0 + x2 + y2

y∗ :=y∗(k) = log(K − x∗) ,
ρ(a0, 0, 0; a, x, y)2 ,

Φ(x, y, a) :=

1
2
1
2

Ψ(x) :=

¯HK(x)2.

(18)

(19)

Theorem 4.1 For the uncorrelated model in (11) with X0 = 0, Y0 = 0, we have the following small-time behaviour
for basket call options for K ∈ (2,∞) with K 6= K∗ := 2e:
2 e− ϕ(k)

[1 + o(1)]

(20)

E(S(1)

t + S(2)

3

t

t − K)+ = ψ(k) t

(t → 0)

where k = log K,and

ψ(k) = (1 + 1k>k∗ ) ·

e−y∗

(e2x∗

+ e2y∗

)

e− 1

2 (x∗+y∗)

pa0a∗(x∗, y∗)

p2πΦaa(x∗, y∗, a∗(x∗, y∗)) Ψ′′(x∗)

2 K) and ϕ(k) = 1

1

¯HK(x∗) sinh ¯HK(x∗)

.

When K ∈ (2, K∗], x∗ and ϕ simplify to x∗(K) = log( 1
K = 2e, we have the special behaviour:

2 [cosh−1(q1 + 2

a2
0

(k − log 2)2)]2. For

E(S(1)

t + S(2)

t − K)+ =

1

√a0¯a
, ¯a =q1 + 2

a2
0

5

4 e− ¯H2

2t [1 + o(1)],

1

4πpΦaa(x∗, y∗, ¯a)
1√2a2

and ξ = 5
12

0+4

Γ( 1
4 )
(ξ ¯H) 1

4

1

¯H sinh ¯H

t

.

8

where ¯H = cosh−1q1 + 2

a2
0

1.5

1.0

0.5

Figure 3: Here we have plotted ϕ(k) for the uncorrelated SABR model in (11).

1.5

2.0

2.5

3.0

Proof. We break the proof into several parts.

• Computing the small-time behaviour of E(a2

t δ(Xt − x, Yt − y))

From the generalized Itˆo formula, we have

E(S(1)

t + S(2)

t − K)+ − E(2S0 − K)+ =

u − K)[(S(1)
t δ(Xt− x, Yt− y)) =R ∞
a=0 a2 ˆp(x, y, a, t)da. Fix a
To this end, we ﬁrst compute the small-time behaviour of E(a2
suﬃciently large constant M > 0, let ε = 1
0 + 2M 2}. Using the heat kernel expansion in (14)
over a compact domain (x, y, a) ∈ [−M, M ] × [−M, M ] × [ε, 1/ε] in (14), and Laplace’s method (see [SS03]),
we ﬁnd that

2 min{a0, 1/pa2

u δ(S(1)

u + S(2)

u )2 + (S(2)

u )2])du.

E(a2

(21)

0

1

2Z t

I1 :=Z 1/ε

ε

a2 ˆp(x, y, a, t)da

=

=

and

(a∗(x, y))2

2

1

√a0 (a∗(x, y)) 5
e− 1

pa0a∗(x, y)
a∗(x, y) =qa2

1

ρ∗(x, y)

e− ρ∗ (x,y)2

2t

[1 + o(1)]

e− 1

2 (x+y)

2 (x+y)

1

2πtpΦaa(x, y, a∗(x, y))
2πtpΦaa(x, y, a∗(x, y))

sinh ρ∗(x, y)
ρ∗(x, y)

sinh ρ∗(x, y)

e− ρ∗ (x,y)2

2t

[1 + o(1)],

(22)

0 + x2 + y2,

ρ∗(x, y) = cosh−1[q1 + (x2 + y2)/a2

0 ]

are the minimizer (resp. minimum) of ρ(a0, 0, 0; a, x, y) over all a ∈ R+. Moreover, the function ρ(a0, 0, 0; a, x, y)
is strictly decreasing in a over (0, a∗(x, y)] and is strictly increasing in a over [a∗(x, y),∞). On the other hand,
using the global bound (17) we have that

0 ≤ I2 :=Z ε
≤e− 1

0

a2 ˆp(x, y, a, t)da

2 (x+y) e− 1
8 t
√a0
2 (x+y) e− 1
8 t
√a0

1

(2πt)

1

(2πt) 3

3

0

2 Z ε
2 Z ε

0

1

≤e− 1
≤2√ε e− 1

2 (x+y) 1
√a0

1
√a
1
√a

ρ

sinh ρ

e− ρ2

2t da

ρ(a0, 0, 0; ε, x, y)

sinh ρ(a0, 0, 0; ε, x, y)

e− ρ(a0 ,0,0;ε,x,y)2

2t

da

ρ(a0, 0, 0; ε, x, y)

e− ρ(a0 ,0,0;ε,x,y)2

2t

,

(23)

(2πt) 3

2

sinh ρ(a0, 0, 0; ε, x, y)

where the second line follows from the fact that both
2t are positive, decreasing functions of
ρ > 0, and that ρ(a0, 0, 0; a, x, y) is strictly decreasing for a ∈ (0, ε]. Similarly, ρ ∼ log a as a → ∞ so

ρ

sinh ρ and e− ρ2

9

ρ

sinh ρ = o(e− 3
all a > 1

4 ρ) = o(a− 3

ε and (x, y) ∈ [−M, M ] × [−M, M ]. It follows that

4 ) as a → ∞. Hence there exists a constant C > 0 such that 0 ≤ ρ
0 ≤ I3 :=Z ∞
≤e− 1

a2 ˆp(x, y, a, t)da

1
√a

e− ρ2

sinh ρ

2t da

1/ε

ρ

1

(2πt) 3

sinh ρ ≤ Ca− 3

4 for

2 (x+y) e− 1
8 t
√a0
2 (x+y) e− 1
8 t
√a0

≤e− 1

1/ε

2 Z ∞
2 Z ∞

1/ε

1

C

(2πt) 3

a− 5

4 e− ρ(a0 ,0,0;1/ε,x,y)2

2t

da

≤4 ε

1

4 e− 1

2 (x+y) C
√a0

(2πt) 3

2

e− ρ(a0 ,0,0;1/ε,x,y)2

2t

.

(24)

Since ρ∗(x, y) < min{ρ(a0, 0, 0; ε, x, y), ρ(a0, 0, 0; 1/ε, x, y)}, we know that Ii = o(I1) for i = 2, 3, as t → 0.
Thus, for any (x, y) ∈ [−M, M ] × [−M, M ], we have
E(a2

[1+o(1)], (25)

e− ρ∗ (x,y)2

ρ∗(x, y)

2 (x+y)

e− 1

1

1

2t

t δ(Xt−x, Yt−y)) =

pa0a∗(x, y)

2πtpΦaa(x, y, a∗(x, y))

sinh ρ∗(x, y)

as t → 0, and this expansion is uniform for all (x, y) ∈ [−M, M ] × [−M, M ]. On the other hand, by standard
properties of the Dirac delta function, we also have

E(a2

t δ(S(1)

t − ex, S(2)

t − ey)) =

1
exey E(a2

t δ(Xt − x, Yt − y)) .

• Computing the convolution

Applying a convolution to this we see that

J :=E(a2
=Z K
=Z log K

−∞

ex=0

t δ(S(1)

t + S(2)

E(a2

t δ(S(1)

t

t − K)[(S(1)
t − ex, S(2)

)2 + (S(2)

t

)2])

t − eyK (x))[e2x + e2yK(x)]d(ex)

[e2x + e2yK (x)]

eyK (x)

E(a2

t δ(Xt − x, Yt − yK(x))dx

(26)

(27)

where yK(x) := log(K−ex). Now ﬁx R > 0 suﬃciently large, we may use the estimate in (25) for the compact
domain {(x, y) : x ∈ [−R, log(K − e−R)], ex + ey = K}, we have that

[e2x + e2yK(x)]

eyK(x)

−R

J1 :=Z log(K−e−R)
=[1 + o(1)]Z log(K−e−R)
×

−R
¯HK(x)

sinh ¯HK(x)

e−

2t

¯HK (x)2

E(a2

t δ(Xt − x, Yt − yK(x)))dx

[e2x + e2yK (x)]

e− 1

2 (x+yK(x))

1

eyK (x)

dx

pa0a∗(x, yK(x))

2πtpΦaa(x, yK(x), a∗(x, yK (x)))

as t → 0, where

¯HK(x) = ρ∗(x, yK(x)) = cosh−1q1 + [ x2 + (log(K − ex))2]/a2

0 , .

Note that we can choose R > 0 suﬃciently large so that ¯HK(x) is strictly decreasing over (−∞,−R), and
that ¯HK(x) is strictly increasing over (log(K − e−R), log K). To apply Laplace’s method for J1, we have
to minimize ¯HK(x) over all x in the allowable range [−R, log(K − e−R)]. By the monotonicity of ¯HK(x),
the minimum over [−R, log(K − e−R)] is the same as inf x<log K ¯HK(x). Thus we are faced with the same
minimization problem as the previous section for the Black-Scholes model, namely minimizing x2 +log(K−ex)
over x in this range (note that previously ex was replaced with x). Let us denote by

Ψ(x) :=

1
2

¯HK(x)2

, ϕ(k) := inf
x<k

Ψ(x) > 0, where k = log K.

(28)

10

• K ∈ (0, 2e)

Applying the previous arguments for K ∈ (0, 2e), we see that
J1 =e−y∗

+ e2y∗

2 (x∗+y∗)

(e2x∗

e− 1

1

)

pa0a∗(x∗, y∗)

√2πtpΦaa(x∗, y∗, a∗(x∗, y∗))

1

pΨ′′(x∗)

¯HK(x∗)

sinh ¯HK(x∗)

e− ϕ(k)

t

[1 + o(1)] ,

(29)

where x∗ ≡ x∗(K) = log( 1
y∗ = yK(x∗), and ϕ(k) can be calculated explicitly as

2 K) (i.e. the same as in Theorem 2.1 except now we are working in log space) and

ϕ(k) =

1
2

[cosh−1(s1 +

2
a2
0

(k − log 2)2) ]2

and we can re-write x∗ as x∗ = k− log 2. By trivial adjustment to (29) (using (26)) we also see that the exact
density f (K) of S1

t has the asymptotic behaviour

t + S2

f (K) = e−y∗

1

√a0a∗(x∗, y∗)

5
2

1

√2πtpΦaa(x∗, y∗, a∗(x∗, y∗))

1

pΨ′′(x∗)

¯HK(x∗)

sinh ¯HK(x∗)

e− ϕ(k)

t

[1 + o(1)] ,

• K > 2e

Similarly, for K > 2e we have

J1 =2e−y∗

(e2x∗

+ e2y∗

)

¯HK(x∗)

×

pa0a∗(x∗, y∗)

[1 + o(1)] ,

e− ϕ(k)

t

1

e− 1

2 x∗− 1

2 y∗

1

√2πtpΦaa(x∗, y∗, a∗(x∗, y∗))

1

pΨ′′(x∗)

sinh ¯HK(x∗)
where now x∗ = argminx≤log K
point in Lemma 2.2), y∗ = yK(x∗), and note that we also write this as log argminx∈(0, 1
is deﬁned as in section 2.

¯HK(x) (this equality follows from the second bullet
¯hK(x) where ¯hK(·)

¯HK(x) = argminx≤log( 1

2 K)

2 K]

• The special value K∗ = 2e

At the special value K∗ = 2e, the second derivative term ¯H′′K(x∗) vanishes, and we have

¯HK ∗ (x) = ¯HK ∗ (x∗) + ξ(x − x∗)4 + O((x − x∗)5) ,

so

¯HK ∗ (x)2 = ¯HK ∗ (x∗)2 + 2ξ ¯HK ∗(x∗)(x − x∗)4 + O((x − x∗)5) ,

where x∗ ≡ x∗(K∗) = 1 (and hence y∗ = yK(x∗) = 1), and ξ =

5

24√1+a2

0/2

.

J1 =[1 + o(1)]Z log(K−e−R)

−R
¯HK(x)

×

sinh ¯HK(x)

¯HK (x)2

2t

e−

dx

eyK (x)

[e2x + e2yK (x)]

e− 1

2 (x+yK(x))

1

pa0a∗(x, yK(x))

2πtpΦaa(x, yK (x), a∗(x, yK(x)))

e−ζx4

dx = Γ( 1
4 )
1
4

2ζ

as before, we now obtain

Using the identity R ∞

−∞

J1 =

e2 + e2

e1

=

2

√a0¯a

e− 1

2 (1+1)

1

√a0¯a

1

4πpΦaa(x∗, y∗, ¯a)

1

Γ( 1
4 )

2πtpΦaa(x∗, y∗, ¯a)

¯H

Γ( 1
4 )
(ξ ¯H) 1
4 t 3

4

sinh ¯H

4 t− 1

4

2(ξ ¯HK ∗ (x∗)) 1
e− ¯H2

2t [1 + o(1)]

¯H

sinh ¯H

e− ¯H2

2t [1 + o(1)]

(30)

11

where ¯H = ¯HK ∗(x∗) = cosh−1q1 + 2

a2
0

, ¯a = a∗(x∗, y∗) =q1 + 2

a2
0

(8) as before, after we have shown that the tail integrals in(27) are lower order terms which we can ignore at
the level we are interested in.

. The result then follows on using (7) and

• Controlling the tail integrals
We now control the tail integrals in (27). To this end, denote Tt := R t
Yt|Tt are independent N (− 1

2 Tt, Tt) normal random variables, and hence for all (x, y) ∈ R2,

0 a2

sds. Then we know that, Xt|Tt and

E(δ(Xt − x, Yt − y)|at, Tt) =

1

dxdy

P(Xt ∈ dx, Yt ∈ dy|at, Tt) =

≤

=

Thus, we have

1

dxdy
1
dx

1

P(Xt ∈ dx|at, Tt)
1

√2πTt
E(δ(Xt − x)|at, Tt).

√2πTt

P(Xt ∈ dx|at, Tt)P(Yt ∈ dy|at, Tt)

(31)

(32)

(33)

) in Appendix

0 ≤ J2 :=Z −R

−∞

[e2x + e2yK(x)]

eyK(x)

E(a2

t δ(Xt − x, Yt − yK(x))dx

≤

e−2R + K 2

K − e−R Z −R
e−2R + K 2
K − e−R
e−2R + K 2
K − e−R
By the Cauchy-Schwarz inequality we have

−∞
1

≤

=

√2π Z −R
1
t T − 1
√2π

−∞
E(a2

t

2

E(a2

t δ(Xt − x, Yt − yK(x)))dx

E(a2

t T − 1

t

2

δ(Xt − x))dx

1{Xt≤−R}).

E(a2

t T − 1

t

2

3
2

5
2

t T −1

t 1{Xt≤−R})qE(a
1{Xt≤−R}) ≤qE(a
t ) 4pP(Xt ≤ −R)qE(a
≤ 4qE(a5
π2
4t − t
e
2 t ·
4pP(Xt ≤ −R),
4√2πt
≤a

0 e

)

3
2

5
4

16

t

5

t T −1

t

)

where the last line is due to the fact that a5
B.

t = a5

0 exp(5W 3

t − 5

2 t) and the bound for E(a

3
2

t T −1

t

We now bound the probability P(Xt ≤ −R) by choosing an appropriate R > 0. To that end, let c ≡
8ϕ(k) + π2 > 0. For ﬁxed a0 > 0 and x1 < 0, it can be easily veriﬁed that

a>0{1 +
inf

x2
1 + (a − a0)2

2a0a

} = inf
a>0{

0 + a2

x2
1 + a2
2a0a

} =

1
2a0

a>0{
inf

x2
1 + a2
0

a

+ a} =

1

2a0 · 2qx2

1 + a2

0 =q1 + x2

1/a2
0 .

Thus, by choosing x1 = −a0pcosh2 √2c − 1 = −a0 sinh√2c < 0, from (12) (with y = y0) we see that √2c is
the minimum distance from point (0, a0) to the vertical line x = x1 in H2 = {(x, a) : a > 0}. By Theorem
4.6 of [AFLZ16], for x1 < 0, we know that for all t > 0 suﬃciently small,
E(eXt − ex1)+ − (1 − ex1) ≤ C(x1)e− c

(34)

t t

2 ,

3

where C(x1) > 0 is a constant that depends on x1 only, hence by put-call parity, we have

E(ex1 − eXt )+ = E(eXt − ex1)+ − (1 − ex1) ≤ C(x1)e− c

t t

3

2 .

(35)

12

Finally, observe that

E(ex1 − eXt )+ = E(ex1 − S(1)

t

)+ =Z ∞

0

P((ex1 − S(1)

t

0

0

)+ ≥ u)du =Z ∞
=Z ex1
=Z ex1
≥Z ex1
≥
=

0

1
2
1
2

t ≥ u)du

P(ex1 − S(1)
P(S(1)

t ≤ ex1 − u)du

P(S(1)

t ≤ v)dv

P(S(1)

t ≤ v)dv

1
2 ex1
ex1 P(S(1)

t ≤

1
2

ex1)

ex1 P(Xt ≤ x1 − log 2) .

Combining (35) and (36), we have

P(Xt ≤ x1 − log 2) ≤ 2e−x1C(x1)e− c

t t

3

2 .

(36)

(37)

5

16

2

t

5
4

0 e

E(a2

E(a2

2 t ·

t T − 1

1{Xt≤−R}) ≤ a

π2
4t − t
e
4√2πt
It follows that we can choose any R ≥ log 2 − x1, then we have
1
4√2πt
1
4√2πt
≤a
= 4r C(x1)e−x1
≤ 4r C(x1)e−x1

1{Xt≤−R}) ≤a

t T − 1

39

16 t+ π2

39

16 t+ π2

4t

· a

· a

0 e

5
4

0 e

π

2

t

π

5
4

4t

5
4

0 e

5
4

0 e

4pP(Xt ≤ −R),

4pP(Xt ≤ −R)
4q2e−x1C(x1)e− c

t t 3

2

39

16 t t

1
8 e

π2−c

4t

39

16 te− 2ϕ(k)

t

1
8

t

(38)

(recall that c ≡ 8ϕ(k) + π2, x1 = −a0pcosh2 √2c − 1 and we have chosen R ≥ log 2 − x1). Thus, we have

J2 = o(J1) as u → 0 because we have 2ϕ(k) as opposed to ϕ(k) in the exponent for J2. Similarly, for

log(K−e−R)

J3 :=Z log K
=Z −R

−∞

[e2y + e2xK(y)]

exK(y)

[e2x + e2yK (x)]

eyK (x)

E(a2

t δ(Xt − x, Yt − yK(x))dx

E(a2

t δ(Xt − xK(y), Yt − y)dy,

where xK(y) = log(K − ey), we also have J3 = o(J1) as u → ∞. Overall, we have

J = J1(1 + o(1)) = (1 + o(1))Z log(K−e−R)

−R

[e2x + e2yK (x)]

eyK (x)

E(a2

t δ(Xt − x, Yt − yK(x)))dx,

as t → 0. The result follows from similar argument as in Corollary 2.3.

13

2.0

1.5

1.0

0.5

2.0

2.5

3.0

Figure 4: Here we have plotted the saddlepoint approximation for the density of S1
for the uncorrelated
bivariate SABR model in (11) in grey (using the leading order approximation in (30)), verses the approximate
density of S1
in blue (computed numerically by integrating the leading order approximation to the true
transition density given in (14) for t = .02, which we know is equal to f (K)(1 + O(t)) at t → 0, where f (K) is the
true density of S1

t + S2
t

t + S2
t

t + S2

t ).

5 The general bi-variate SABR model: non-zero correlation

5.1 Small-time asymptotics for basket call options

We now consider a generalized version of the model in (11):

dXt = − 1
t σ2
xdt + σxatdW 1
t ,
dYt = − 1
t σ2
ydt + σyatdW 2
t ,
dat = αatdW 3
t

2 a2
2 a2

(39)




xa + ρ2

t dW 2

t = ρxydt, dW 1

t dW 3

t = ρxadt, dW 2

where dW 1
and ρ2
xy + ρ2

ya < 1
ya − 2ρxyρxaρya < 1, which ensures that the covariance matrix of the three Brownian motions is
xy, ¯ρxa = p1 − ρ2

positive semi-deﬁnite, and we set X0 = Y0 = 0 as before. Throughout, we set ¯ρxy = q1 − ρ2
and ¯ρya =q1 − ρ2

t = ρyzdt with σx, σy, α > 0, ρ2

xy < 1, ρ2

xa < 1, ρ2

t dW 3

ya.

xa

Remark 5.1 A fully general model would be four-dimensional, with one volatility process for each asset, but the
analysis for such a model is signiﬁcantly messier. The one drawback of our existing model is that both assets have
the same vol-of-vol α, which may not be unreasonable if both assets are in the same sector.

The heat equation associated with (39) is given by

1
2

a2(σ2

xux + σ2

∂tu −
Now let τ = α2t, so ∂tu = α2∂τ u. Then this equation transforms to

xuy) +

a2(σ2

1
2

xuxx + σ2

yuyy + α2uaa + 2ρxyσxσyuxy + 2ρxaσxαuxa + 2ρyaσyαuya) = 0 .

a2(σ2

xux + σ2

yuy) +

1
2

α2∂τ u −
or equivalently

∂τ u −

1
2

a2
α2 (σ2

xux + σ2

yuy) +

1
2

1
2

a2(σ2

xuxx + σ2

yuyy + α2uaa + 2ρxyσxσyuxy + 2ρxaσxαuxa + 2ρyaσyαuya) = 0 .

a2(

σ2
x
α2 uxx +

σ2
y
α2 uyy + uaa + 2ρxy

σxσy
α2 uxy + 2ρxa

σx
α

uxa + 2ρya

σy
α

uya) = 0 .

14

If we now set x′ = αx/σx, y′ = αy/σy, then PDE further transforms to

∂τ u −

1
2

a2
α

(σxux + σyuy) +

1
2

a2(ux′x′ + uy ′y ′ + uaa + 2ρxyux′y ′ + 2ρxaux′a + 2ρyauy ′a) = 0 .

(40)

Then the diﬀusion matrix for (40) is given by (aij) = a2ΣΣT , where

Σ = 


β
0
0

γ
¯ρya
¯ρya
0

ρxa
ρya
1




xa − γ2/ ¯ρ2

ya, γ = ρxy − ρxaρya, and this matrix now only involves correlations. Moreover,

and β =q¯ρ2

Σ−1 = 


1

β − γ
0
0

¯ρ2
ya β
1
¯ρya
0

ξ
¯ρ2
ya β

− ρya
¯ρya
1




(41)

(42)

1
2 ,

]

where ξ = ρxyρya − ρxa. The process associated with (40) now takes the form
t + ρxadB3

dB2

t + γ
¯ρya

t ) ,

σx
α dt + at(βdB1
σy
α dt + at(¯ρyadB2

t + ρyadB3

t ) ,

t

dX′t = − 1
2 a2
dY ′t = − 1
2 a2
t
dat = atdB3
t




with (X′0, Y ′0 , a0) = ( α
σx

X0, α
σy

Y0, a0) = (0, 0, a0), where B1, B2, B3 are independent Brownians.

We deﬁne the following two quantities which will be needed in the theorem which follows.

Φ(a) =

Ψ(x) =

d(x, y, a)2,

1
2
d(x, yK (x), a∗(x, y))2

2α2

,

a∗(x, y) =argmina>0d(x, y, a) = [

y2α2β2(¯ρ2

ya + β2γ2)σ2

x − 2xyα2β2γ ¯ρ2
(ξ2 + β2 ¯ρ2

yaσxσy + ¯ρ4
ya)σ2

xσ2
y

ya(x2α2 + a2

0β2σ2

x)σ2
y

ˆA(x, y, a) = −

1
2

(

σx
βα −

γσy
¯ρ2
yaβα

)x −

σy

2α¯ρya

y +

1
2

log

a
a0

.

Theorem 5.1 For the general correlated model in (39) with X0 = 0, Y0 = 0, we have the following small-time
behaviour for a basket call option for K > 2:

E(S(1)

t + S(2)

t − K)+ =

¯ψ(k)
√2π

3

2 e−

t

¯Λ(k)2

2t

[1 + o(1)]

(if Ψ′′(x∗j ) > 0 ∀j = 1...N )

(43)

where k = log K, ¯HK(x, y) = d(x, y, a∗(x, y)), Λ(k) = minx ¯HK(x, yK (x)), ¯Λ(k) = Λ(k)/α2, x∗j = argminx
for j = 1..N where N < ∞ is the number of global minimizers of ¯HK(x, yK(x)), yK(x) = log(K − ex) as before,
y∗j = yK(x∗j ) and

¯HK(x, yK(x))

d(x, y, a) =ρ(Σ−1(0, 0, a0)T, Σ−1(

, a)T) ,

αx
σx

,

αy
σy
ye2y∗
j )

ψ(k) =

N

Xj=1

(a∗j )2 ex∗

j (σ2

xe2x∗
ex∗

j + σ2
j +y∗
j

√g(Σ−1(

αx∗
j
σx

,

αy∗
j
σy

, a∗j )T) χ(x∗j , y∗j , a∗j )

√2παqΦaa(a∗j )Ψ′′(x∗j )

χ(x, y, a) = e

ˆA(Σ−1(0,0,a0)T,Σ−1( αx
σx

, αy
σy

,a)T), ¯ψ(k) = √2π ψ(k) and ρ(., ., .) is deﬁned as in (12).

(detΣ)−1

d(x∗j , y∗j , a∗j ) sinh d(x∗j , y∗j , a∗j )

α4
σxσy

,

15

Proof. (of Theorem 5.1). Let

d ˆXt
d ˆYt
dˆat







= Σ−1


dX′t
dY ′t
dat




= a2

− 1
t Σ−1
2 σx/α
− 1
2 σy/α


0




dt + at


dB1
t
dB2
t
dB3
t




1

β − γ
0
0

¯ρ2
ya β
1
¯ρya
0

ξ
¯ρ2
ya β

− ρya

¯ρya
1

= a2

t 





2

σx
α
σy
α

− 1
0 

− 1



2

dt + at


dB1
t
dB2
t
dB3
t




(44)

with ( ˆX0, ˆY0, ˆa0)T = Σ−1(0, 0, a0)T . Then from Theorem 3.1, we know that the joint density of ( ˆXt, ˆYt, ˆat) behaves
like

ˆp(ˆx, ˆy, ˆa, t) = √g(ˆx, ˆy, ˆa) e

ˆA(ˆx,ˆy,ˆa)

1

ρ

(2πt) 3

2

sinh ρ

e− ρ2

2t [1 + o(1)]

(t → 0)

where ρ = ρ(0, 0, ˆa0; ˆx, ˆy, ˆa) and ˆA(x, y, a) = R 1
joining (0, 0, ˆa0) to (ˆx, ˆy, ˆa) under the metric ds2 = 1
from the drift coeﬃcient in (44) using the formula Ai = bi − 1
(a2(− σx

, 1
2 a) and we have

2βα + γσy

2 ¯ρ2

0 hA, ˙γ(s)ids, where γ is the unique distance-minimizing geodesic
a2 (dx2 + dy2 + da2), and A has to be computed as before
1√g ∂j(√g gij); in this case we ﬁnd that A =

2α ¯ρya

yaβα ),−a2 σy
ˆA(ˆx, ˆy, a) =Z 1

2Pj
a2A2 dˆy

1

+

0 hA, ˙γi dt =Zγ
=Zγ
= −

[

1

dt

a2 A1 dˆx
[(−
1
2

σx
2βα
σx
βα −

(

dt
dˆx
dt

)

]dt

+

1

dt
σy

a2A3 da
+ (−
σy

ˆy +

1
2

2α¯ρya

)ˆx −

2α¯ρya

)

+

dˆy
dt
a
a0

log

.

γσy
yaβα

+

2 ¯ρ2
γσy
¯ρ2
yaβα

1
2a

da
dt

]dt

Then the density of (X′t, Y ′t , at) satisﬁes
ˆp(x′, y′, a, t) = √g(ˆx, ˆy, ˆa) e

ˆA(ˆx,ˆy,ˆa)

1

ρ

(2πt) 3

2

sinh ρ

e− ρ2

2t

1

detΣ

[1 + o(1)]

(t → 0)

where now (ˆx, ˆy, ˆa)T = Σ−1(x′, y′, a)T. Transforming back to the original variables, we now obtain

ˆp(x, y, a, t) =√g(ˆx, ˆy, ˆa) e

ˆA(ˆx,ˆy,ˆa)

1

ρ

(2πα2t)

3
2

sinh ρ

e− ρ2

2α2t

1

detΣ

α2
σxσy

[1 + o(1)]

=√g (Σ−1(

1

detΣ

×

,

αx
σx
α2
σxσy

ˆA(Σ−1(0,0,a0)T,Σ−1( αx
σx

, αy
σy

,a)T)

1

d(x, y, a)

(2πα2t) 3

2

sinh d(x, y, a)

e− d(x,y,a)2

2α2t

αy
σy

, a)T) e

[1 + o(1)]

as t → 0, where d(x, y, a) is deﬁned in the statement of the theorem and we are using that (ˆx, ˆy, ˆa)T = Σ−1( αx
For for future reference we deﬁne

σx

, αy
σy

, a)T.

ˆp1(x0, y0, a0; x, y, a, t) :=√g (Σ−1(

,

αx
σx
α2
σxσy

1

detΣ

×

αy
σy

, a)T) e

ˆA(Σ−1(0,0,a0)T,Σ−1( αx
σx

, αy
σy

,a)T)

1

d(x, y, a)

(2πα2t) 3

2

sinh d(x, y, a)

e− d(x,y,a)2

2α2 t

(45)

to be the leading order approximation here.

From a formal application of Laplace’s method (see below for discussion on justifying this rigorously), we have

E(a2

t δ(Xt − x, Yt − y)) =Z ∞

a=0

a2 ˆp(x, y, a, t)da

=(a∗)2√g (Σ−1(

αx
σx

,

αy
σy

, a∗)T)

χ(x, y, a∗)

d(x, y, a∗)

2παtpΦaa(a∗)

sinh d(x, y, a∗)

e− d(x,y,a∗ )2

2α2 t

1

detΣ

α2
σxσy

[1 + o(1)]

16

where a∗ = a∗(x, y) is the unique minimizer of d(x, y, a). Then applying a convolution as before, we see that

E(a2

t δ(S(1)

t + S(2)
e2x + e2yK

t − K)[(S(1)

t

)2 + (S(2)

t

)2])

,

ex=0

ex+yK

αy
σy

, a∗)T)

χ(x, y, a)

d(x, y, a∗)

[e2x + e2yK(x)]

(a∗)2√g (Σ−1(

αx
σx
(a∗)2√g (Σ−1(

∼Z K
∼Z k
where yK = yK(x) = log(K − ex). Since ¯HK(x, yK(x)) is real analytic in x ∈ (−∞, log K), there can only exists
¯HK(x, yK(x)) = 0 over this domain. It follows that there can only be a ﬁnite
ﬁnitely many roots to the equation d
dx
number of minimizers x∗j ’s such that ¯HK(x∗j , yK(x∗j )) = Λ(k) = minx ¯HK(x, yK(x)). Applying Laplace’s method
again, we can now re-write this expression as

detΣ
e− d(x,yK (x),a∗ )2

2παtpΦaa(a∗)

2παtpΦaa(a∗)

sinh d(x, yK(x), a∗)

d(x, yK(x), a∗)

sinh d(x, y, a∗)

e− d(x,y,a∗ )2

χ(x, yK(x), a)

α2
σxσy

αyK(x)

, a∗)T)

αx
σx

eyK(x)

d(ex)

−∞

α2

σy

2α2 t

2α2t

1

σxσydetΣ

,

dx

ex∗

j [e2x∗
x∗
j

j +e2y∗
j ]
+y∗
j

e

(a∗j )2√g (Σ−1(

αx∗
j
σx

,

αy∗
j
σy

, a∗j )T)

χ(x∗

j ,y∗
j ,a∗
j )
√2παt√Φaa(a∗
j )Ψ′′(x∗
j )

d(x∗

j ,y∗
sinh d(x∗

j ,a∗
j )
j ,a∗
j ,y∗

j ) e−

d(x∗

j )2

j ,a∗

j ,y∗
2α2 t

α2

σxσy detΣ(46)

∼ PN

j=1

where a∗j now refers to a∗(x∗j , y∗j ). Similar to before, we know from the generalized Itˆo formula that

E(S(1)

t + S(2)

t − K)+ − E(2S0 − K)+ =

1

2Z t

0

E((σ2

x + σ2

y)a2

u δ(S(1)

u + S(2)

u − K)[(S(1)

u )2 + (S(2)

u )2])du

(47)

Combining this with (7), we ﬁnd that the asymptotic basket call price is given by

N

Xj=1
×

ex∗

j [σ2

ye2y∗
j ]

xe2x∗
ex∗

j + σ2
j +y∗
j

1

detΣ

α4
σxσy

[1 + o(1)] .

(a∗j )2√g (Σ−1(

αx∗j
σx

,

αy∗j
σy

, a∗j )T)

χ(x∗j , y∗j , a∗j )

√2παqΦaa(a∗j )Ψ′′(x∗j )

d(x∗

j )2

j ,a∗

j ,y∗
2α2 t

3

2 e−

t

d(x∗j , y∗j , a∗j ) sinh d(x∗j , y∗j , a∗j )

The map from (ˆx, ˆy, ˆa) to (x, y, a) is an invertible linear mapping, which maps compact domains to com-
pact domains. Thus, the tail integral (an integer over the complement of a compact set) in the convolution of
ˆpt(x, yK(x), a∗(x, yK (x))) in x also corresponds to a tail integral of relevant joint density in ˆx, which can be
controlled using similar arguments as in the proof of Theorem 4.1.

In particular, from (42) we know that, conditional on the natural ﬁltration generated by (at)t≥0, F a

t , we have

X′t = −

Y ′t = −

1
2

1
2

σx
α

σy
α

0

Tt +Z t
Tt + ¯ρyaZ t

0

as(βdB1

s +

γ
¯ρya

dB2

s ) + ρxa(at − a0),

asdB2

s + ρya(at − a0).

Recall that β = q ¯ρ2
ρxa(at − a0), ¯ρ2
correlation

γ

¯ρxa ¯ρya

xa − γ2/ ¯ρ2

ya, γ = ρxy − ρxaρya so β2 + γ2

¯ρ2

xaTt), (Y ′t |F a

t ) ∼ N (− 1

2

α Tt + ρya(at − a0), ¯ρ2

σy

. Hence, (Xt|F a

t ) ∼ N (− 1

2

σ2
α2 Tt +ρxa
x

σx

α (at−a0), σ2

a0), ¯ρ2
ya

σ2
α2 Tt), Xt and Yt are correlated with correlation ˆρ := γ
y

ya

= ¯ρ2

t ) ∼ N (− 1

xa. It follows that (X′t|F a

yaTt), X′t and Y ′t given F a
α2 ¯ρ2
xaTt) and (Yt|F a
. It follows that, for all (x, y) ∈ R2, we have

σx
α Tt +
t are correlated normal with
t ) ∼ N (− 1
α (at−

σ2
y
α2 Tt +ρya

¯ρxa ¯ρya

σy

2

2

x

E(δ(Xt − x, Yt − y)|F a

t ) =E(δ(Xt − x)|F a
≤E(δ(Xt − x)|F a

t ) · E(δ(Yt − y)|Xt = x,F a
t )
t ) ·
α ¯ρya√2πTtp1 − ˆρ2

σy

1

17

and in the second line we have used that Var(Yt|Xt,F a
Normal distributions. Similar to (32), we then have

t ) = (1 − ˆρ2)Var(Yt|F a

t ) by standard results on conditional

[e2x + e2yK(x)]

eyK(x)

E(a2

t δ(Xt − x, Yt − yK(x))dx

0 ≤Z −R
≤

−∞

−∞

e−2R + K 2

K − e−R Z −R
e−2R + K 2
K − e−R
e−2R + K 2
K − e−R

σy

σy

≤

=

E(a2

t δ(Xt − x, Yt − yK(x)))dx
1
t T − 1

E(a2

t

2

α ¯ρya√2πp1 − ˆρ2 Z −R
α ¯ρya√2πp1 − ˆρ2

E(a2

−∞

1

δ(Xt − x))dx

t T − 1

t

2

1{Xt≤−R})

and we then proceed as in (33).

5.2

Implied volatility

We deﬁne the implied volatility of a basket call option with strike K and maturity t under the model in (39) as
the unique solution ˆσt(k) to:

E(S(1)

t + S(2)

t − K)+ = CBS(2, K, ˆσt, t)

where CBS(S, K, ˆσt, t) is the usual Black-Scholes call option pricing formula with zero interest rates. It will be
convenient to re-write this equation in a normalized form as

1
2

E(S(1)

t + S(2)

t − K)+ = CBS(1, ex1, ˆσt(x1), t)

where ex1 = 1

2 K, and we now show the dependence of ˆσt on x1 explicitly.

Corollary 5.2 For the model deﬁned above, let ˆσt(x1) denote the implied volatility at maturity t for strike K =
2ex1 = ek, with K > 2. Then we have the following asymptotic behaviour for ˆσt(x1):

(48)

(49)

as t → 0, where

ˆσ2
t (x1) = ˆσ0(x1)2 + a(x1)t + o(t) ,

ˆσ0(x1) = |x1|
p2 ¯Λ(k)

,

a(x1) =

2ˆσ4

0(x1)
x2
1

log

¯ψ(k)

1
2

ABS(x, ˆσ0(x1))

.

Proof. If we equate the small-time basket call expansion in Theorem 5.1 (normalized by the eﬀective initial stock
price, which is 2) and the small-time expansion for a standard European call option with initial stock price 1 and
strike price ex1 using the usual Black Scholes call option formula with volatility parameter equal to √σ2 + at and
maturity t (see Proposition 3.4 in [FJL12]) we get

¯ψ(k)
√2π

3

2 e−

t

¯Λ(k)2

2t

[1 + o(1)] =

ABS(x1, σ)

√2π

1
2

e

ax2
1
σ4 t

3

2 e−

x2
1
2σ2 t [1 + o(1)]

where ABS(x1, σ) = σ3
x2
1

e

1

2 x1. Taking the log of both sides and cancelling terms we see that

¯Λ(k)2

2t

−

+ log ¯ψ(k) = −

x2
1
2σ2t

+ log[ABS(x1, σ)] +

1
2

ax2
1
σ4 + o(1)

(50)

(51)

and equating the leading order and correction terms we obtain (49). This equating argument is made rigorous in
section 7.2 of [FJL12] and is a model-independent argument.

18

5.3 Numerical results

Before delving into the numerics, we ﬁrst recall the asymptotic relation

Υ(k, t) :=Z t

0

1
√u

e− k2

2u du =

2
k2 t

3

2 e− k2

2t

[1 + O(

t
k2 )]

(52)

for k > 0 as t → 0 from (7), and we note (again) that the error term inside the bracket is O( t
k2 ). We apply
this relation in the proofs of Theorem 4.1 and 5.1 for third and ﬁnal integration (i.e. the outer integral of the
original triple integral, where we perform the ﬁnal integration over t using the Tanaka formula) and k is given
by k = argmin−∞0<log Kd(x, yK (x), a∗(x, y)). If we apply the saddlepoint approximation formula in Theorem 5.1
for basket calls which are closer to the at-the-money value of K = 2 (and hence not unrealistically exponentially
small in price) t
k2 is not ≪ 1, so the approximation does not work so well. Thus, in practice we recommend using
the exact (closed-form) expression for Υ(k, t) given in (7) in terms of the Erf function for the ﬁnal outer integral
rather than the asymptotic result in (7), but for completeness we compute numerics for both approximations, and
the approximation given in Theorems 4.1 and 5.1 still work very well for basket calls which are further from away
from K = 2. This is an issue with any small-time saddlepoint estimate for out-of-the-money call options under a
stochastic volatility model, and is not speciﬁc to basket call options or this article. We use the NMinimize command
in Mathematica to perform the minimization in computing Λ(k) = minx ¯HK(x, yK (x)).

In the ﬁrst table below, we have tabulated the ratio of the approximate price of the basket call computed numeri-

x=−∞R ∞

y=−∞R ∞

a=0(ex+ey−K)+ ˆp1(x0, y0, a0; x, y, a, t)dadydx

3 to the basket call saddlepoint approximation in (43) (which we call P saddle(K), see the ﬁrst column on the ta-
ble); in the second column we compute the same ratio but we replace the saddlepoint approximation with the
adjusted formula where we use the exact expression for Υ(k, t) for the ﬁnal integration (we call this P saddle,Υ(K)).

cally as a triple integral in Mathematica: P numint(K) :=R ∞
The parameters here are t = .003 (which is of the order of 1 day), and σx = σy = σa = 1/√10 ≈ 0.316,
ρxy = 0.01; ρya = −.05; ρxa = 0.02.). As expected we see that both saddlepoint approximations do not work as well
as K tends to the at-the-money value of 2 (because for K values close to 2 we are in the moderate, not the large
deviations regime), but work very well for larger out-of-the money K-values. The main purpose of this ﬁrst table
is not to show how well the approximation works in practice (because for t = 0.003 the basket call prices here are
too low to be of practical use), but rather to initially verify check that the formula is correct before applying it to
more realistic scenarios, see next paragraph).

In the second table, we consider a more realistic maturity of t = 0.02 (with the same parameters as above but
now ρxy = 0.01, ρya = .05 and ρxa = 0.2) and for the smaller strikes the basket call prices now take sensible values
i.e. not astronomically small, and we see that the P saddle,Υ(K) approximation still works well. In this table we
also compute the implied volatilities ˆσ associated with P numint(K) and P saddlepoint,Υ(K) and the leading order
implied volatility computed from the ﬁrst equation in Eq (49) (these numbers are plotted in Figure 5). In the ﬁnal
three graphs, we plot these same three implied volatility smiles for three diﬀerent sets of parameters with common
maturity t = .01.

Note that we have not used Monte Carlo simulation anywhere because the usual Wilard[Wil97] conditioning
trick cannot be applied in this context because there is no closed-form expression for basket calls under the Black-
Scholes model. The other alternative would be to use importance sampling by changing to a measure under which
the large deviations event becomes likely, but this would involve very messy calculations of the geodesics for the
hyerbolic metric on H3 with a full correlation structure.4.

3where ˆp1 is the leading order approximation to the true transition density given in (45)
4We found a mistake in the Monte Carlo implementation of the previous version and graph it produced was overly ﬂattering because

it was plotted in terms of implied volatility.

19

0.008

0.006

0.004

0.002

7

6

5

4

3

2

1

0.238

0.236

0.234

0.232

0.230

0.228

2.08

2.10

2.12

2.14

1.9

2.0

2.1

2.2

2.10

2.15

2.20

2.25

2.30

2.35

2.40

t (grey) verses the density of S1

Figure 5: In the graph on the left, we have plotted P saddle(K) (grey) verses P numint(K) (blue) for σx = σy =

σa = 1/√10 ≈ 0.316, ρxy = 0.01, ρya = .05 ρxa = 0.2 and t = 0.02 (this is the data in the second table), and
the parameters values given above. In the middle plot we plot the saddlepoint approximation for the density of
S1
t + S2
t via numerical integration (blue), the former is just obtained by making
a trivial adjustment to the prefactors in front of the exponential in (46), similar to what we did for Figure 4 (the
two density approximations are so similar here that it is diﬃcult to make out the blue curve underneath the grey
one). In the right plot we plot the corresponding implied volatility with the same colour scheme and we also plot
the leading order implied volatility ˆσ0(K) using the formula in the ﬁrst equation in Eq (49) (black dashed).

t + S2

K (t = 0.003)
2.1
2.3
2.5
2.7
2.9
3.1
3.3

P numint(K)
P saddle(K)
0.86086
0.98603
1.00044
1.00138
0.99875
0.99957
1.00928

P numint(K)
P saddle,Υ(K)
1.010238
1.008826
1.009752
1.006666
1.002281
1.002183
1.011362

K (t = 0.02) P numint(K)
2.05
2.1
2.15
2.2
2.25
2.3
2.35
2.4

0.0090506
0.0020265
0.000313645
3.37991E-05
2.58363E-06
1.4354E-07
5.95334E-09
1.8942E-10

P saddle,Υ(K)
0.00914671
0.00204746
0.000316796
3.41335E-05
2.60899E-06
1.44944E-07
6.01137E-09
1.91261E-10

P saddle,Υ(K)
P numint(K)
1.010619
1.010308
1.010046
1.009894
1.009816
1.009781
1.009747
1.009719

ˆσnumint,Υ(K)
0.23862
0.23308
0.23122
0.23076
0.23094
0.23145
0.23216
0.23300

ˆσsaddle,Υ(K)
0.23745
0.23248
0.23085
0.23052
0.23077
0.23132
0.23206
0.23291

ˆσ0(K)
0.22545
0.22624
0.22709
0.22799
0.22894
0.22992
0.23094
0.23198

5.4 Quanto and spread options

t /S2

It should be possible to adapt Theorem 5.1 to compute small-time asymptotics for a quanto option which pays
t − K) = (eXt−Yt − K)+, e.g. an option on the EUR/GBP exchange rate but with payout in dollars or a
(S1
spread option which pays (S1
t − K); we defer the details for future research, but for the former case it is clear
that yK(x) should be changed to log K − x.

t − S2

20

0.2370

0.2365

0.2360

0.2380

0.2375

0.2370

0.2365

0.2360

2.15

2.20

2.25

2.30

2.35

2.10

2.15

2.20

2.25

2.30

2.35

0.2370

0.2365

0.2360

2.10

2.15

2.20

2.25

2.30

2.35

Figure 6: Here we have plotted the implied volatility for P saddle(K) (grey) verses the implied volatility for
P numint(K) (blue) verses the leading order implied volatility ˆσ0(K) (black dashed) for σx = 1.1/√10, σy = σa =
1/√10 ≈ 0.316 and t = .01 in all plots with ρxy = ρya = ρxa = 0 (left graph), and ρxy = 0, ρya = .03, ρxa = 0.02
(right graph) and ρxy = 0, ρya = −.02, ρxa = 0.03 (lower graph)

.

21

References

[ABBF03] Avellaneda, M., D.Boyer-Olson, J.Busca, P.Friz, “Application of large deviation methods to the pricing

of index options in ﬁnance”, Comptes Rendus de l’Acad´emie des Sciences - Series I - Mathematique, 2003.

[ABBF04] Avellaneda, M., D.Boyer-Olson, J.Busca, P.Friz, “Reconstructing volatility”, RISK, 2004.

[AFLZ16] Armstrong, J., M.Forde, M.Lorig and H.Zhang, “Small-time asymptotics under local-stochastic volatility

with a jump-to-default: curvature and the heat kernel expansion”, available on arXiv:1312.2281v5, 2016.

[BFL14] Bayer, C., P.K.Friz, and P.Laurence, “On The Probability Density Function Of Baskets”, “Large Devia-
tions and Asymptotic Methods in Finance (P. K. Friz, J. Gatheral, A. Gulisashvili, A. Jacquier, J. Teichmann,
Editors)”, Springer International Publishing Switzerland, 449-472, 2015.

[Bel81] Bellaiche, C., “Comportement asymptotique de p(x; y, t)”, Ast´erisque, 84-85, 151-187, 1981.

[BH10] Bleistein, N. and R.A.Handelsman, “Asymptotic Expansions of Integrals”, Dover Books on Mathematics,

2010.

[doC92] do Carmo, M., “Riemmanian Geometry”, Birkh¨auser, 1992.

[Dav88] Davies, E.B., “Gaussian Upper Bounds for the Heat Kernel of Some Second-Order Operators on Rieman-

nian Manifolds”, J. Funct. Anal., 80, 16-32, 1988.

[DZ98] Dembo, A. and O.Zeitouni, “Large deviations techniques and applications”, Jones and Bartlet publishers,

Boston, 1998.

[Ell09] Richard S. Ellis, “The Theory of Large Deviations and Applications to Statistical Mechanics”, Lecture

Notes for Ecole de Physique Les Houches August 5-8, 2008, updated November 19, 2009.

[FJL12] Forde, M., A.Jacquier and R.Lee, “The small-time smile and term structure of implied volatility under

the Heston model”, SIAM J. Finan. Math., 3, 690-708, 2012.

[FZ14] Forde, M. and H.Zhang, “Sharp tail estimates for the correlated SABR model”, preprint, 2014.

[FP13] Forde, M. and A.Pogudin, “The Large-maturity smile for the SABR and CEV-Heston models”, Int. J.

Theor. Appl. Finance, 16 (8), 2013.

[Forde11] Forde, M., “Exact pricing and large-time asymptotics for the modiﬁed SABR model and the Brownian

exponential functional”, Int. J. Theor. Appl. Finance, 14, 1-19, 2011.

[GM98] Grigor’yan, A. and M.Noguchi,“The Heat Kernel on Hyperbolic Space”, Bull. London Math. Soc.,30 (6):

643-650, 1998.

[GT13] A. Gulisashvili and P. Tankov, “Tail behavior of sums and diﬀerences of log-normal random variables”,

arXiv:1309.3057v1, 2013.

[GT15] Gulisashvili, A. and P.Tankov, “Implied volatility of basket options at extreme strikes” in “Large Deviations
and Asymptotic Methods in Finance (P. K. Friz, J. Gatheral, A. Gulisashvili, A. Jacquier, J. Teichmann,
Editors)”, Springer International Publishing Switzerland, pp. 175-212, 2015.

[HL08] Henry-Labord`ere, P., “Analysis, Geometry, and Modeling in Finance: Advanced Methods in Option Pric-

ing”, Chapman & Hall, 2008.

[Hsu] Hsu, E.P., “A brief introduction to Brownian motion on a Riemmanian manifold”, lecture notes.

[Hsu02] Hsu, E.P., “Stochastic analysis on manifolds”, Graduate Studies in Mathematics, vol. 38, American Math-

ematical Society, Providence, RI, 2002.

[LS14] Linders,D., W.Schoutens, “Basket Option Pricing and Implied Correlation in a L´evy Copula Model”,

preprint, 2014.

[MRTZ15] Ma, J., Z. Ren, N. Touzi and J. Zhang, “Large Deviations for Non-Markovian Diﬀusions and a Path-

Dependent Eikonal Equation”, Annales de l’IHP: Probabilit´es et Statistique.

22

[MY05] Matsumoto, H. and Yor, M., “Exponential functionals of Brownian motion, II: Some related diﬀusion

processes”, Probability Surveys, Vol. 2, 348-384, 2005.

[Olv74] Olver, F.W., “Asymptotics and Special Functions”, Academic Press, 1974.

[SS03] Stein, E.M. and R.Sharkarchi, “Complex Analysis”, Princeton University Press, 2003.

[Wil97] Willard, G., “Calculating Prices and Sensitivities for Path-Independent Derivatives Securities in Multifactor

Models”, The Journal of Derivatives, Fall 1997, Vol. 5, No. 1: pp. 45-61.

A Proof of Lemma 2.2

The following result will be useful:

Lemma A.1 If k(x) is C2 and strictly convex over [a, b], then m(x) := k( a+b
over [0, b−a

2 −x)+k( a+b

2 ].

2 +x) is strictly increasing

Proof. m′′(x) = k′′( a+b
−k′( a+b

2 − x) + k′′( a+b
2 ) = 0. The result follows.

2 ) + k′( a+b

2 + x) > 0, so m′(x) is strictly increasing over [0, b−a

2 ]. But m′(0) =

Recall that g(x) = (log x)2. To simplify notation, we introduce

u(x)

:=

1
2

g′′(x) =

1 − log x

x2

,

x > 0 .

Then we have u′(x) = 2 log x−3
x > e.

x3

, u′′(x) = 11−6 log x

x4

, u(e) = 0 and u(0+) = ∞. Moreover, u(x) < 0 if and only if

• If K ∈ (0, 2e), then u( 1

6 ) ⊃ (0, 2e) ⊃ (0, K), we know that
u(x) is strictly convex over (0, K). Recall that ¯hK(x) = g(x) + g(K − x). Then by convexity of u, we know
that

2 K) > u(e) = 0. Since u′′(x) > 0 for all x ∈ (0, e

11

1
2

¯h′′K(x) = u(x) + u(K − x) ≥ 2u(

1
2

K) > 0 .

(A-1)

Since ¯hK(x) is strictly convex and ¯hK(x) = ¯hK(K − x), there is a unique minimizer of ¯hK(x) at x∗ = 1

2 K.

• The case K = 2e is easily veriﬁed.
• If K ∈ (2e, 2e

2 ], using that u′(K − x) = − d

3

3

decreasing for x ∈ (0, K − e
x ∈ (0, K − e
Furthermore, u(x) is strictly convex for all x ∈ [K − e
and b such that (a + b)/2 = 1

2 ) ⊂ (0, e

2 ]. Thus 1
2

3

3

2 K and (b − a)/2 = e

3

dx u(K − x) = −3+2 log(K−x)

, we see that u(K − x) is strictly
2 ). Similarly, it can be easily seen that u(x) is also strictly decreasing for
2 ).
6 ). By Lemma A.1, choosing choose a

¯h′′K(x) = u(x) + u(K − x) is strictly decreasing for x ∈ (0, K − e

(K−x)3

2 , e

11

3

3

3

2 , e

3

2 ] we know that

3

2 ] ⊂ (0, e

2 − K/2 so [a, b] = [K − e
1
2

K + y),

1
2

3

¯h′′K(

K − y) + u(

1
K − y) = u(
2
2 K]. In other words, ¯h′′K(x) is strictly decreasing for x ∈ [K − e
2 − 1

1
2
2 K].
is strictly increasing for y ∈ [0, e
Overall, we have proved that ¯h′′K(x) is strictly decreasing for x ∈ (0, 1
2 K], hence, there is at most one root to
¯h′′K(x) = 0 over (0, 1
2 K) < 0 we have the existence and uniqueness of the root
to ¯h′′K(x) = 0 over (0, 1
2 K). Denoting this root by y1, then by symmetry, ¯hK(x) is strictly convex on (0, y1),
strictly concave on (y1, K − y1), and strictly convex on (K − y1, K). This implies that there is exactly one
root to ¯h′K(x) = 0 over (0, y1). Otherwise, we would either have at least one root to ¯h′′K(x) = 0 over (0, y1),
2 K) < ¯h′K(y1) ≤ 0, which is a contradiction. Denoting this root by x∗, then we have two minima
or 0 = ¯h′K( 1
of ¯hK(x) at x∗ and K − x∗.

2 K). By ¯h′′K(0+) = ∞ and ¯h′′K( 1

(A-2)

2 , 1

3

23

• If K ∈ (2e

2 ,∞), then using the facts that u(x) is strictly decreasing for x ∈ (0, e

3

3

3

3

2 ], we know that 1
2

2 K). Moreover, since u(e

2 ], and that u(K − x)
¯h′′K(x) = u(x) + u(K − x) is strictly
2 ] ⊃ (0, e
2 ) < u(e) = 0 (since
2 ) < 0. But ¯h′′K(0+) = ∞, we know that there is a unique root to
2 , 1
2 K], we have x > e and K − x > e, so u(x) < 0, u(K − x) < 0,
2 K]. By the same argument as the last bullet point, we can now establish

2 ) < u(e) = 0 and u(K − e

¯h′′K(e

3

3

3

3

3

3

3

2 > e + e

2 ] ( (0, 1
2 ) , we know that 1
2

is strictly decreasing for x ∈ (0, K − e
decreasing for all x ∈ (0, e
K > 2e
¯h′′K(x) = 0 over (0, e
and 1
2
the existence of two minima at x∗ ∈ (0, e

¯h′′K(x) < 0 for all x ∈ [e

2 ). Finally, for all x ∈ [e

2 , 1

3

3

3

2 ) and K − x∗.

3
B Computing E(a
2
t

T −1
t

)

The joint density of (at, Tt) can be found in [MY05]. It particular, P(at ∈ da, dTt ∈ dI) = e
where ψr(t) = R ∞

2I )ψ a
for all r, t > 0. From (14) of [FZ14] it is known that |ψr(t)| ≤ 1
r .

2t −r cosh z sinh z sin πz
t

0 dz e− z2

I 2√a exp(− 1+a2

8√2π3t

Thus,

1

I

π2
2t

− t

(t)dadI

exp(−
1 + a2

2I

1 + a2

2I

)

I
a

dadI

)

dI
I 2

1

I 2√a

exp(−

3
2

0

a
I

0 Z ∞
daZ ∞
1 + a2 da

2

0

0

8

8

e

e

π2
2t − t

π2
2t − t

√2π3t Z ∞
√2π3t Z ∞
√2π3t Z ∞
π2
2t − t
e
√2πt

π2
2t − t

e

0

.

8

8

E(a

3
2

t T −1

t

) =Z ∞

0 Z ∞

0

a

3

2 I−1P(at ∈ da, dTt ∈ dI) ≤

=

=

=

24

