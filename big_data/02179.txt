6
1
0
2

 
r
a

M
7

 

 
 
]

.

O
L
h
t
a
m

[
 
 

1
v
9
7
1
2
0

.

3
0
6
1
:
v
i
X
r
a

Proﬁnite groups with NIP theory and p-adic

analytic groups

Dugald Macpherson∗,
School of Mathematics,

University of Leeds,

Leeds LS2 9JT,

England

h.d.macpherson@leeds.ac.uk

Katrin Tent†,

Mathematisches Institut,

Universit¨at M¨unster,

Einsteinstrasse 62,

48149 M¨unster, Germany
tent@math.uni-muenster.de

March 8, 2016

Abstract

We consider proﬁnite groups as 2-sorted ﬁrst order structures, with a
group sort, and a second sort which acts as an index set for a uniformly
deﬁnable basis of neighbourhoods of the identity. It is shown that if the
basis consists of all open subgroups, then the ﬁrst order theory of such
a structure is NIP (that is, does not have the independence property)
precisely if the group has a normal subgroup of ﬁnite index which is a
direct product of ﬁnitely many compact p-adic analytic groups, for distinct
primes p. In fact, the condition NIP can here be weakened to NTP2. We
also show that any NIP proﬁnite group, presented as a 2-sorted structure,
has an open prosoluble normal subgroup.

1 Introduction

We view a proﬁnite group G as an inverse limit of a given system (Hi)i∈I of
ﬁnite groups, so equipped with a speciﬁed family (Ki : i ∈ I) of open subgroups
of ﬁnite index. We present G as a structure G in a 2-sorted language Lprof
with sorts G, I, with the group language on G, a partial order ≤ on I, and a
relation K ⊂ G × I so that for each i ∈ I, Ki := {x ∈ G : G |= K(x, i)} is
an open subgroup of G, and {Ki : i ∈ I} is a basis of neighbourhoods of 1 in
G; for i, j ∈ I we have i ≤ j if and only if Ki ≥ Kj. We shall say that the
2-sorted proﬁnite group G = (G, I) is full if {Ki : i ∈ I} consists of all the open
subgroups of G.

∗Research partially supported by EPSRC grant EP/K020692/1
†Research partially supported by SFB 878

1

Given a complete ﬁrst order theory T , a formula φ(¯x, ¯y) has the independence
property if there is M |= T and {¯bi : i ∈ N} ⊂ M |¯y| such that for any S ⊂ N
there is ¯aS ∈ M |¯x| with M |= φ(¯aS, ¯bi) if and only if i ∈ S. The theory T is
said to have the independence property if some formula has the independence
property with respect to T , and to be NIP, or dependent, otherwise. This notion
is model-theoretically robust – if a structure N is interpretable in M and M
has NIP theory, then so does N .

There is a notion of rank on partial types in ﬁnitely many variables, namely
dp-rank, which takes ordinal values in NIP theories. For the deﬁnition, see [24,
Chapter 5]. An NIP theory is strongly NIP if all types have ﬁnite dp-rank.

The class of NIP theories properly contains that of stable theories, and has
been the subject of considerable recent attention – see e.g. [24]. In particular, a
complete theory is NIP if and only if, in every model of T , any uniformly deﬁn-
able family of sets has ﬁnite Vapnik-Chervonenkis dimension, a notion important
in statistical learning theory. There has been substantial work on groups deﬁn-
able in a NIP theory. Examples include stable groups, such as abelian groups,
algebraic groups over an algebraically closed ﬁeld, and torsion-free hyperbolic
groups; and in the non-stable setting, the real and p-adic semi-algebraic Lie
groups. We show here that also the compact p-adic analytic groups ﬁt into the
setting of NIP groups even when considered as 2-sorted full proﬁnite groups.

As a basic example, ﬁx a prime p, let G = (Zp, +), let I = ω, and deﬁne
the relation K so that for each i ∈ ω, Ki := piZp. Then G is p-adic analytic,
G = (G, I) is a full pro-p group, and G is interpretable in the p-adic ﬁeld Qp
(with I the non-negative part of the value group), so is NIP.

Recall that, given a complete theory T , a formula φ(¯x, ¯y) has TP2 (the tree
property of the second kind) for T if there is some k ∈ N, some M |= T , and
elements ¯aij ∈ M |¯y| (for i, j ∈ N) such that

(i) for each i ∈ N, the formulas φ(¯x, ¯aij) (for j ∈ N) are k-inconsistent, that

is, any conjunction of k distinct such formulas is inconsistent with T , and

(ii) for any function f : N → N, the set of formulas {φ(¯x, ¯ai,f (i)) : i ∈ N} is

consistent with T .
The theory T is NTP2 if no formula has TP2 with respect to T . These theories
encompass the NIP theories, see e.g. [24], Prop. 5.3.1, and simple theories are
also NTP2. Theories which are NTP2 have been extensively studied recently -
see for example [3, 10].

Our main theorem is the following.

Theorem 1.1. Let G = (G, I) be a full proﬁnite group. Then the following are
equivalent:

1. G has an open normal subgroup N = P1 × . . . × Pt, where the Pi are
compact p-adic analytic groups with respect to distinct primes p1, . . . , pt.

2. Th(G) is strongly NIP.

3. Th(G) is NIP.

4. Th(G) is NTP2.

2

The implication (2. ⇒ 3.) is trivial and (3. ⇒ 4.) well-known, as pointed
It is thus left to show (1. ⇒ 2.) and (4. ⇒ 1.). Part (1. ⇒ 2.)
out above.
of Theorem 1.1 consists essentially of the following proposition, which follows
from known results, especially those of du Sautoy in [6]. The structure Zan
p is an
expansion of the p-adic ﬁeld by restricted analytic functions, and is described at
the start of Section 3. It was introduced by Denef and van den Dries in [4], who
proved that it has quantiﬁer elimination once an additional binary divisibility
function is added to the language. For the deﬁnition of a uniformly powerful
pro-p group, see Section 2.

Proposition 1.2. Let G be a full uniformly powerful pro-p group. Then G is
interpretable in the structure Zan

p , whence Th(G) is strongly NIP.

We recall brieﬂy some background. Following the usual convention, we say
that a set X ⊂ G (topologically) generates the proﬁnite group G if the abstract
subgroup hXi (group-theoretically) generated by X is dense in G, and say that
G is a ﬁnitely generated proﬁnite group if X can be chosen to be ﬁnite. If G
is a ﬁnitely generated proﬁnite group then d(G) denotes the cardinality of the
smallest generating set for G, in the above topological sense. If G is a proﬁnite
group and X ⊆ G, we write ¯X for the topological closure of X in G. The
proﬁnite group G is said to have rank r if every closed subgroup of G has a
topological generating set of size r, and r is minimal with this property. To
avoid confusion with this rank, the model-theoretic rank mentioned earlier is
always called dp-rank.

Note that any compact p-adic analytic group has the structure of a proﬁnite
group. In fact (see [5, Corollary 9.36]) a topological group is a compact p-adic
analytic group if and only if it has an open subgroup of ﬁnite index which is a
pro-p group of ﬁnite rank.

It is immediate that every open subgroup of a proﬁnite group has ﬁnite
index. The following is a converse for ﬁnitely generated proﬁnite groups, and
was proved in the pro-p case by Serre [20, Section 4.2, Exercise 6] and in general
by Nikolov and Segal [16, 17]. It is used occasionally in Section 4, but the uses
are probably not essential.

Theorem 1.3. Let G be a ﬁnitely generated proﬁnite group, and H ≤ G. Then
H is open in G if and only if |G : H| is ﬁnite.

Example 1.4. We mention two similar-looking examples of proﬁnite groups,
which, viewed as 2-sorted full proﬁnite groups, both fail to be NIP, but for
slightly diﬀerent reasons. The ﬁrst is the pro-p group G1 := CpwrZp which
has a closed subgroup (the base group, a Cartesian power of Cp) which is not
topologically ﬁnitely generated. Thus, as a full proﬁnite group G1 is not NIP,
or even NTP2, by Lemma 4.3. The second is the following 2-generator group
mentioned at the end of Chapter 5 of [19]. Let p be a prime, and let (qi : i ∈ N)
be a sequence of distinct primes such that pi|qi − 1 for all i. Let C be the
Cartesian product of the cyclic groups Cqi . Then Zp has a natural action on C,
and the proﬁnite group G2 = C ⋊ Zp has rank 2. Now ﬁnite rank pro-p-groups

3

are p-adic analytic (and so are NIP if presented as full proﬁnite groups), but
ﬁnite rank full proﬁnite groups need not be NIP. The group G2, presented as
a full proﬁnite group, is not NIP, by the Claim in Section 4 below. Note that
G2 is not virtually pronilpotent, but is prosoluble. It would be interesting to
see whether either G1 or G2 could be presented as a 2-sorted (but not full) NIP
proﬁnite group.

On the other hand, compact p-adic analytic groups are all NIP when pre-
sented as full proﬁnite groups. Examples include the groups (Zp, +) and SL2(Zp),
which are compact and semi-algebraic, that is, deﬁnable in the p-adic ﬁeld Qp
in the language of rings. For p > 2, the graph of the p-adic exponential func-
tion (pZp, +) → (1 + pZp, ·) is a compact p-adic analytic group.
It is not
semi-algebraic, but in the ‘analytic’ expansion Zan
p of Zp (see Section 3), it is
isomorphic to a semi-algebraic group, namely (Zp, +).

Section 2 of the paper contains some background on p-adic analytic groups,
and we prove Proposition 1.2 in Section 3. Section 4 contains the remainder of
the proof of Theorem 1.1. There is some further discussion in Section 5. We
show there that any NIP proﬁnite group (without a fullness assumption) has a
prosoluble open subgroup of ﬁnite index (Proposition 5.1).

Acknowledgement: This research was partially supported by EPSRC grant

EP/K020692/1 and SFB 878.

2 Background

We give a rapid introduction to p-adic analytic groups, taken from [5, Chapter
p is non-empty and open, and f = (f1, . . . , fs) : V → Zs
9]. First, if V ⊂ Zr
p
is a function, and y ∈ V , then f is analytic at y if there are F1, . . . , Fs ∈
Qp[[X1, . . . , Xr]] for i = 1, . . . , s and h ∈ N such that fi(y + phx) = Fi(x) for
each i = 1, . . . , s and x ∈ Zr
p. We say f is analytic on V if it is analytic at every
point of V .

If X is a topological space, then a p-adic chart of dimension n of X is a triple
(U, φ, n) where U is an open subset of X, and φ is a homeomorphism from U
onto an open subset of Zn
p . The charts c = (U, φ, n) and d = (V, ψ, m) of X are
compatible if, putting W := U ∩ V , the maps ψ ◦ φ−1|φ(W ) and φ ◦ ψ−1|ψ(W ) are
analytic on φ(W ) and φ(V ) respectively. There is a natural notion of (p-adic)
atlas on the topological space X, consisting of a covering by compatible charts,
and an equivalence relation of compatibility of atlases: two atlases A and B of X
are compatible if every chart of A is compatible with every chart of B. Finally,
a Qp-analytic manifold structure on X is an equivalence class of compatible
atlases on X, and such a structure is called a p-adic analytic manifold.

If G is a topological group, then G is a p-adic analytic group, or p-adic
Lie group, if G has the structure of a p-adic analytic manifold such that the
maps G × G → G and G → G, given by group multiplication and inversion
respectively, are analytic.

4

If H is a subgroup of the group G and n > 0, put H n := h{hn : h ∈
H}i. Recall that if G is a pro-p-group, then G has a series of closed normal
subgroups (the ‘lower p-series’) G = P1(G) ≥ P2(G) ≥ . . ., where Pn+1(G) :=
Pn(G)p[Pn(G), G]. If G is a ﬁnitely generated pro-p-group theb the Pi(G) form
a base of open neighbourhoods of the identity – see e.g. [5, Proposition 1.16(iii)].
The pro-p group G is said to be powerful if p is odd and G/Gp is abelian, or if
p = 2 and G/G4 is abelian. It is uniformly powerful if (i) G is ﬁnitely generated,
(ii) G is powerful, and (iii) |Pi(G) : Pi+1(G)| = |G : P2(G)| for each i. A
major theorem of Lazard [13] states that a compact topological group is a p-
adic analytic group if and only if it has an open subgroup which is a uniformly
powerful pro-p group. Building on this, we have the following characterisations,
combining the work of Lazard, Lubotzky, Mann, Segal, and Shalev.

Theorem 2.1. Let G be a pro-p group. Then the following are equivalent.

(i) G is a compact p-adic analytic group.
(ii) G is ﬁnitely generated and has a uniformly powerful subgroup of ﬁnite

index.

(iii) G has ﬁnite rank.
(iv) G has polynomial subgroup growth, that is, there is α > 0 such that for

each n > 0, G has at most nα open subgroups of index n.

(v) G is ﬁnitely generated and does not involve arbitrarily large wreath prod-

ucts of the form CpwrCpn .

(vi) G is isomorphic to a closed subgroup of GLd(Zp) for some suitable d.

Proof. See for example Theorem 5.11 of [12], together with the main theorem
of [21] for (v).

We will only be using the characterizations given in parts (i)–(iii). Parts (iv)–
(vi) of the last theorem are not used in this paper. Note that by Theorem 1.1,
we may now add to Theorem 2.1 the model-theoretic characterisation

(vii) the full proﬁnite group G = (G, I) is NIP.

3 Proof of Proposition 1.2.

We ﬁrst recall the main results of Denef and van den Dries [4] on the structure
Zan
p . Let X = (X1, . . . , Xm) consist of m commuting indeterminates. If ν =
(ν1, . . . , νm) ∈ Nm is a multi-index, then we put |ν| := ν1 + . . . + νm. Let Zp{X}
denote the ring of all formal power series Σν∈NmaνX ν where aν ∈ Zp for each
ν and |aν|p → 0 as |ν| → ∞ (here |a|p denotes the p-adic norm of a).

The language Lan

D contains for all m ∈ N an m-ary function symbol F for
each F (X) ∈ Zp{X}, a binary function symbol D, and a unary relation symbol
Pn for each n > 0. We interpret Zp as an Lan
D -structure as follows: we interpret
Pn by the set of non-zero nth powers for each n, the m-ary function symbol F
by the function induced by F (X) (which converges on Zm
p ), and we interpret
D : Z2
p → Zp by putting D(x, y) = x/y if |x|p ≤ |y|p and y 6= 0, and D(x, y) = 0
otherwise. Let T an
D . We remark that by

D be the theory of Zp in the language Lan

5

p → Zp is an analytic function, then f is deﬁnable in the
D . This is an elementary application of the topological compactness

[6, Lemma 1.9], if f : Zm
language Lan
of Zm
p .
By Theorem 1.1 of [4] the theory T an

D has quantiﬁer elimination. For us the

following is crucial:

Theorem 3.1. The theory T an

D is strongly NIP.

p is interpretable in Zan

Proof. Let Qan
p denote the p-adic ﬁeld equipped with subanalytic structure; the
function symbols interpreting elements of Zp{X} take value 0 on Qm
p , so
Qan
p is P -minimal,
in the sense of [9]. By [9, Proposition 7.1], any P -minimal theory is NIP. By
7.3, 7.9 and 7.10 of [1], the structure Qan
is dp-minimal, that is, of dp-rank 1,
p
and so is strongly NIP.

p . By [7, Theorem A], the theory of Qan

p \ Zm

In order to prove Proposition 1.2 it suﬃces by Theorem 3.1 to prove that if
G is a uniformly powerful pro-p group, then G together with its family of open
subgroups is deﬁnable in Zan
p . This is essentially contained in Section 2 of [6],
though it is not stated in this form, so we sketch the arguments from there.
(Du Sautoy has a diﬀerent goal, namely to show that certain Poincar´e series
enumerating subgroups of given ﬁnite index are rational.)

Observe ([6, Deﬁnition 1.11]) that if G is a pro-p group, then G admits a
natural action by (Zp, +): for λ ∈ Zp and g ∈ G, put gλ := limn→∞ gan , where
(an) is any sequence from Z with limit λ (this is well-deﬁned). Also, we deﬁne
ω : G → N ∪ {∞} by putting ω(g) = n if g ∈ Pn(G) \ Pn+1(G), and ω(1) = ∞.
The function ω is analogous to a valuation on G.

We next state a key theorem from [6].

Theorem 3.2 (Theorem 1.18 of [6]). Let G be a uniformly powerful pro-p-group
with d(G) = d, and let {x1, . . . , xd} be a topological generating set for G. Then:
(i) for each x ∈ G there are unique λ1, . . . , λd ∈ Zp such that if λ =

(λ1, . . . , λd), then x = xλ1
(ii) the function f : Zd

1 · · · xλd
d
p × Zd
p → Zd

(and is denoted x(λ));

p determined by the rule x(λ).(x(µ))−1 =

x(f (λ, µ)) is an analytic function;

(iii) if x = x(λ) ∈ G, then ω(x) = Min{v(λi) + 1 : 1 ≤ i ≤ d}.

We summarize this as:

Corollary 3.3. Any uniformly powerful pro-p-group G of rank d is (isomorphic
to) a group deﬁnable in the Lan
p. Furthermore,
the function ω is deﬁnable in this structure.

p with domain Zd

D -structure Zan

Proof. Fix an ordered topological generating set (x1, . . . , xd). By (i) of Theo-
rem 3.2, we may identify G with an isomorphic copy of G with domain Zd
p, with
the group structure deﬁnable in Zan
p by (ii). By (iii), ω is also deﬁnable.

We shall refer to an ordered topological generating set for G of size d(G) as
a basis of G. It acts as a system of coordinates for G. It remains to show that
the family of open subgroups is also uniformly deﬁnable. For this we ﬁrst note

6

Lemma 3.4. Let G be a uniformly powerful pro-p group with a basis {x1, . . . , xd}.
Then the action (described above) of Zp on G by exponentiation is deﬁnable in
Zan
p .

Proof. The function g : Zd

p × Zp → Zd

p deﬁned by

x(λ1, . . . , λd)µ = x(g(λ, µ))

is an analytic function on Zd
symbol of Lan

D and so is deﬁnable.

p × Zp (see [6, Lemma 1.19]), so interprets a function

We shall put Gn := Pn(G) for each n ≥ 1. For the following, see the
discussion after [6, Theorem 2.1]. The map x 7→ xp yields an isomorphism fn :
Gn/Gn+1 → Gn+1/Gn+2: if x = x(λ) ∈ Gn (in the notation of Theorem 3.2)
then fn(x(λ)Gn+1) = x(pλ)Gn+2. Let π : Zp → Fp denote the residue map,
and for each n ≥ 1 deﬁne πn : Gn → Fd

p by putting

πn(x(λ)) = (π(p−(n−1)λ1), . . . , π(p−(n−1)λd)).

Then πn is a group homomorphism with kernel Gn+1, so induces a group iso-
morphism Gn/Gn+1 → ((Fp)d, +).

Deﬁnition 3.5 (Deﬁnition 2.2 of [6]). Let G be a uniformly powerful pro-p group
with d(G) = d. If H is an open subgroup of G, then the tuple (h1, . . . , hd) ∈ H d
is a good basis of H if

(i) ω(hi) ≤ ω(hj) whenever i ≤ j, and
(ii) for each n ∈ N, if In := {j : ω(hj) = n} then {πn(hj) : j ∈ In} extends
) : j ∈ I1 ∪ . . . ∪ In−1} to a basis of

the linearly independent set {πn(hpn−ω(hj )
πn(H ∩ Pn(G)).

j

With this deﬁnition we have the following:

Lemma 3.6 (Lemma 2.5 of [6]). Let G be a uniformly powerful pro-p group with
d(G) = d. The tuple (h1, . . . , hd) ∈ Gd is a good basis for the open subgroup H
of G if and only if

(i) ω(hi) ≤ ω(hj) whenever i ≤ j,
(ii) hi 6= 1 for each i = 1, . . . , d,
(iii) {hλ1
(iv) for all λ1, . . . , λd ∈ Zp we have ω(hλ1

1 · · · hλd

d : λi ∈ Zp} is a subgroup of G (and equals H),

1 ≤ i ≤ d}.
Furthermore, by [6, Lemma 2.7], every open subgroup of G has a good basis.

1 · . . . · hλd

d ) = Min{ω(hi) + ν(λi) :

We complete the proof of Proposition 1.2. So let G be a uniformly powerful
pro-p group with d(G) = d, and let G = (G, I) be the corresponding 2-sorted
full proﬁnite group. Since the map ω and the Zp-action on G are deﬁnable in
Zan
p , it follows from Lemma 3.6 that the set of all good bases of open subgroups
of G is deﬁnable in Zan
p .

Furthermore, again using Lemma 3.6, the set of elements of an open subgroup
H is deﬁnable in a uniform way from the good basis as a parameter. Thus, there

7

is a deﬁnable equivalence relation on the collection of all good bases, with two
good bases equivalent if they are good bases for the same open subgroup, and
we may identify the index set I with the set of equivalence classes of good
bases. Since the relation K ⊂ G × I is deﬁnable, the structure G = (G, I)
is interpretable in Zan
D ). Hence, by Theorem 3.1, the theory of G is
p
strongly NIP.

(over Lan

4 Proof of Theorem 1.1.

As noted in the Introduction, the only non-trivial parts of the proof of Theo-
rem 1.1 are 1. ⇒ 2. and 4. ⇒ 1..

Proof of Theorem 1.1(1. ⇒ 2.) Let G satisfy the condition (1.) in Theo-
rem 1.1. By Lazard’s Theorem (contained in Theorem 2.1), any p-adic analytic
group has a uniformly powerful pro-p normal subgroup of ﬁnite index. Thus, we
may suppose that p1, . . . , pt are distinct primes, and that for each i = 1, . . . , t,
there is a uniformly powerful pro-pi-group Pi, and that N := P1 × . . . × Pt is a
normal subgroup of G of ﬁnite index. Let M be the disjoint union of the rings
Zan
pi (viewed in a language in which the rings have formally disjoint languages).
Then M has ﬁnite dp-rank by [11, Theorem 4.8] and hence is strongly NIP. By
Proposition 1.2, each Pi is interpretable in Zan
pi when viewed as a full 2-sorted
proﬁnite group. Furthermore, any open subgroup of N is a direct product of
open subgroups of the Pi, essentially because the same statement holds in ﬁnite
groups – any ﬁnite nilpotent group is a direct product of its Sylow subgroups.
Hence, easily, the full proﬁnite group N is interpretable in M , and thus strongly
NIP.

Let F := G/N . As a group, G is determined by the pair (N, F ) together
with a pair (µ, f ), where µ : F → Aut(N ) and f : F × F → N are functions –
see e.g. Section IV.6 of [2]. Since F is ﬁnite, the map f is deﬁnable in (N, F )
by naming ﬁnitely many constants. In addition, by [6, Theorem 1.18 (iii)], if H
is any uniformly powerful pro-p group living on Zd
p as in the last section, then
any automorphism φ of H corresponds to an analytic (so Zan
p -deﬁnable) map
Φ : Zd

p → Zd

p given by

x(λ)φ = x(Φ(λ)).

Thus, for each g ∈ F , the automorphism µ(g), being a tuple of such maps φ,
is deﬁnable in the strongly NIP structure M . It follows that the group G is
deﬁnable in a strongly NIP structure, namely the disjoint union of M and the
ﬁnite structure F .

It remains to check that the open subgroups of G are uniformly deﬁnable.
However, if H is an open subgroup of G, then H ∩N is an open subgroup of N so
is (uniformly) deﬁnable in the full proﬁnite group N , and H/H ∩ N ∼= HN/N ≤
G/N . Thus, there are h1, . . . , he ∈ H (where e ≤ |G/N |, so is bounded) such
that

H = (H ∩ N )h1 ∪ . . . ∪ (H ∩ N )he.

8

Since the set of all tuples (h1, . . . , he) which yield a subgroup of G in this way
is deﬁnable, and we can deﬁne when two such tuples yield the same group, the
groups H are uniformly deﬁnable in the structure M , as required. ✷

Proof of Theorem 1.1 (4. ⇒ 1.) First, recall the following well-known facts.
If H is a subgroup of the proﬁnite group G we write H ≤O G (respectively
H ≤C G) if H is open (respectively closed) in G; we adopt a corresponding
notation for normal subgroups. If F is a ﬁnite group, then Φ(F ) denotes the
Frattini subgroup of F , that is, the intersection of the maximal subgroups of F .
Extending earlier notation, if G is a ﬁnite group then d(G) denotes the smallest
size of a generating set for G.

Proposition 4.1. (i) Let G be a proﬁnite group. Then

rk(G) := Sup{d(H) : H ≤C G} = Sup{rk(G/N ) : N ⊳O G}

(possibly inﬁnite).

(ii) Let G be a ﬁnite group such that every Sylow subgroup can be generated

by d elements. Then d(G) ≤ d + 1.

(iii) Let P be a ﬁnite p-group, with Frattini subgroup Φ(P ). The P/Φ(P ) is

an elementary abelian p-group of rank d(P ).

Proof. (i) See Proposition 3.11 of [5].

(ii) See the discussion after Proposition 8.2.4 of [25], and the references there

to [14] and [8].

(iii) This is the Burnside Basis Theorem, and is standard.

If G is a proﬁnite group, then Aut(G) denotes the group of all topological
automorphisms of G. The proﬁnite group G is said to virtually have property
P if some open normal subgroup of G has property P. By [5, Theorem 5.3],
if G is a ﬁnitely generated proﬁnite group then Aut(G) has the structure of a
proﬁnite group.

Theorem 4.2 (Theorem 5.7 of [5]). Let G be a ﬁnitely generated proﬁnite group.
If G is virtually a pro-p-group, then Aut(G) is also virtually a pro-p group.

We will need the following general lemma.

Lemma 4.3. Let G be an ∅-deﬁnable group in a structure with NTP2 theory,
and ψ(x, ¯y) a formula implying x ∈ G. Then there is k = kψ ∈ N such that the
following holds. Suppose that H is a subgroup of G, π : H −→ Πi∈J Ti is an
epimorphism to the Cartesian product of the groups Ti, and πj : H −→ Tj is
for each j ∈ J the composition of π with the canonical projection Πi∈J Ti → Tj.
Suppose also that for each j ∈ J, there is a subgroup ¯Rj ≤ G and group Rj < Tj
with ¯Rj ∩ H = π−1
(Rj), such that ﬁnite intersections of the groups ¯Rj are
uniformly deﬁnable by instances of ψ(x, ¯y). Then |J| ≤ k.

j

If the underlying theory is NIP, it suﬃces (for the ﬁnite bound on J) that

the ¯Rj for j ∈ J are uniformly deﬁnable.

9

For each i ∈ I, let ¯Si := Tj∈Ji

Proof. Suppose for a contradiction that this is false. Then for any l ∈ N we
may ﬁnd data J, H, ¯Rj etc. as in the statement, such that |J| ≥ l2. Choose a
partition J = Si∈I Ji of J into ﬁnite sets Ji each of size at least l, with |I| ≥ l.
(Rj ).
By our assumption, for each i ∈ I there is ¯ai such that ¯Si = ψ(G, ¯ai). For each
j ∈ J choose gj ∈ H such that πj(gj) ∈ Tj \ Rj and πi(gj) = 1 for i 6= j. Note
that for any i ∈ I, the elements gj with j ∈ Ji all lie in distinct cosets of Si in
H. Hence the cosets ¯Sigj of ¯Si in G are distinct (for distinct j ∈ Ji) and are
uniformly deﬁnable by some formula φ(x, ¯aigj) with φ dependent only on ψ.

¯Rj, and put Si := ¯Si ∩ H = Tj∈Ji

π−1
j

We claim that the formula φ(x, ¯yz) has TP2. Clearly, for any i, the formulas
φ(x, ¯aigj) (for j ∈ Ji) are 2-inconsistent, since they deﬁne diﬀerent cosets of
the same group. We shall show that if f (i) ∈ Ji for each i ∈ I, then the set
{φ(x, ¯aigf (i)) : i ∈ I} is consistent. This will show that the formula φ(x, ¯yz) has
TP2, for to show there are ¯aij (for i, j ∈ N) satisfying conditions (i) and (ii) of
the deﬁnition of TP2 in Section 1, it suﬃces by compactness to ﬁnd arbitrarily
large ﬁnite such arrays ; we get these by putting ¯aij = (¯ai, gj).

So let i1, . . . , it ∈ I. Observe that if j 6∈ Ji then gj ∈ Si. Let h ∈ H
be the unique element which projects to gi,f (i) in the f (i)-coordinate for each
i = 1, . . . , t, and projects to the identity in other coordinates. Then h ∈ Sigf (i)
for each i = 1, . . . , t, so Vt

i=1 φ(h, ¯aigf (i)) holds, as required.

If the theory is NIP and the ¯Rj are uniformly deﬁnable by χ(x, ¯aj), just pick
gj ∈ π−1
(Tj \ Rj) for each j ∈ J. For a ﬁnite subset F ⊆ J let hF be the unique
element of H such that πj(hF ) = gj if j ∈ F , and πj (hF ) = 1 otherwise. Then
hF ∈ ¯Rj if and only if j 6∈ F , contradicting the NIP assumption.

j

Lemma 4.4. Let G = (G, I) be a 2-sorted full proﬁnite group with NTP2 theory.
Then G has ﬁnite rank (in the sense of proﬁnite groups).

Proof. Suppose for a contradiction that G has inﬁnite rank. Then by Proposi-
tion 4.1(i), for every k there is Nk ⊳O G such that rk(G/Nk) ≥ k + 1. Hence
there is Hk with Nk ≤ Hk ≤ G such that d(Hk/Nk) ≥ k + 1. Thus, by Propo-
sition 4.1(ii), there is a prime p such that some Sylow p-subgroup Qk of Hk/Nk
satisﬁes d(Qk) ≥ k.

Let πk : Hk → Hk/Nk be the natural map, and put Φk := π−1
k (Qk)/Φk is an elementary abelian p-group of rank l ≥ k.

Then π−1

k (Φ(Qk/Nk)).

We now apply Lemma 4.3 to π−1

k (Qk) −→ Πi<l(Z/pZ) to obtain a contra-
diction, using the fact that subgroups P (where Nk < P < G for some k ∈ N)
and their ﬁnite intersections are uniformly deﬁnable.

Proof of Theorem 1.1( 4. ⇒ 1.)
Now suppose that G = (G, I) is a full proﬁnite group with NTP2 theory. By
Lemma 4.4, G has ﬁnite rank. By Theorem 1.3, we may now assume that the
ﬁnite index subgroups of G are open, and so are uniformly deﬁnable in G. By
Corollary 5.4.5 of [19] (extending [25, Theorem 8.4.1]), G has normal subgroups

10

N ≤ A ≤ G such that N is pronilpotent of ﬁnite rank, A/N is ﬁnitely generated
abelian, and G/A is ﬁnite. Here, N is the pro-Fitting subgroup of G, that is, the
group generated by all the subnormal pro-p subgroups of G (over all primes); it
is pronilpotent, so closed. Likewise the subgroup A of G has ﬁnite index in G
and so is open by Theorem 1.3, and hence is closed. Replacing G by a subgroup
of ﬁnite index if necessary, we may assume G = A. We aim to show that after
a further reduction we have in fact G = N and that this is a Cartesian product
of pro-pj groups Pj for j in some ﬁnite set J. In view of the ﬁnite rank of G
and Theorem 2.1 (iii)⇒ (i) this will prove ( 4. ⇒ 1.).

By Proposition 2.4.3 of [25], the group G/N is a Cartesian product of groups
{Ql : l ∈ L}, where Ql is an abelian pro-rl group and {rl : l ∈ L} are distinct
primes. Let πN denote the map G → G/N . For any proper ﬁnite index subgroup
Rl of Ql, the group π−1
N (Rl) has ﬁnite index in G, so by Theorem 1.3 and fullness,
such groups π−1
N (Rl) and their ﬁnite intersections are uniformly deﬁnable in G.
It follows by Lemma 4.3 (with H = G) that the set L is ﬁnite.

Again using [25, Proposition 2.4.3] the pronilpotent group N is a Cartesian
product of pro-pj groups Pj for j ∈ J. We may again assume that the Pj (for
j ∈ J) are pairwise distinct primes.

Claim The set J is ﬁnite.
Proof. Suppose that J is inﬁnite. Deﬁne

J ∗ := {j ∈ J :

for all l ∈ L, rl 6= pj},

and let M be the Cartesian product of the Pj for j ∈ J ∗. Then the supernatural
numbers |M | and |G/M | (see [25, Section 2.1]) are coprime, so by the Schur-
Zassenhaus Theorem for proﬁnite groups ([25, Proposition 2.3.3]), there is B ≤
G such that B ∩M = 1 and G = M ⋊ B; see Proposition 2.3.3 and the preceding
pages of [25] for background here. Each group Pj is ﬁnitely generated, so has
ﬁnitely many proper subgroups of each ﬁnite index, and so (by considering the
intersection of all subgroups of any ﬁxed index greater than 1) has a proper
characteristic ﬁnite index subgroup Rj. Let πj : M = Πi∈J ∗ Pi −→ Pj denote
the canonical projection. Then the group Rj = π−1
(Rj) ⋊ B has ﬁnite index
in G and hence the collection of such groups and their ﬁnite intersections is
uniformly deﬁnable in G. By Lemma 4.3, applied to H = M and the Rj, we see
that J ∗ and consequently J are ﬁnite sets.

j

We may now suppose that N = P1 × . . . × Pt where each Pi is a Sylow
pi-subgroup of N , and G/N = Q1 × . . . × Qt × U , where each Qi is a (possibly
trivial) Sylow pi-subgroup of G/N and U is a direct product of ﬁnitely many
Sylow subgroups of G/N . As before, let πN : G → G/N be the natural map and
for B ≤ G/N let B := π−1
N (B). By the Schur-Zassenhaus Theorem, since the
supernatural numbers |N | and |U | are coprime, we may write ¯U = N ⋊ V for
some V ≤ G. By Theorem 4.2, V induces a ﬁnite group of automorphisms on
N , so, replacing G by a subgroup of ﬁnite index if necessary, we may suppose V
centralises N and so ¯U = N × V . Since N is the maximal pronilpotent subgroup
of G this forces V = 1, so we now assume U = 1.

11

Also, for each i = 1, . . . , t let Ni := Πj6=iPj. Then Ni ⊳ Qi and |Ni| and
Qi/Ni are coprime, so again by the Schur-Zassenhaus Theorem we may write
Qi = Ni ⋊ Di for some pro-pi-group Di ≤ Qi. Again, by Theorem 4.2, each Di
induces a ﬁnite group of automorphisms of Ni, so, replacing G by a subgroup of
ﬁnite index if necessary, we may suppose Di centralises Ni, that is, Qi = Ni ×Di
for each i. Since each Di is a pro-pi-group so pronilpotent, it follows that Qi ≤ N
for each i, that is, G = N = P1 × . . . × Pt. Finally, as noted above, each Pi
has ﬁnite rank by Lemma 4.4, so we obtain condition (1.) of Theorem 1.1 by
applying Theorem 2.1 (iii)⇒ (i) to each Pi. ✷

5 Further Observations

We consider brieﬂy what can be said about NIP proﬁnite groups without the
assumption that they are full. It seems diﬃcult to prove any version of Theo-
rem 1.1 without the fullness assumption, but we obtain the following.

Proposition 5.1. Let G = (G, I) be a NIP proﬁnite group. Then G has a
prosoluble open normal subgroup of ﬁnite index.

Proof. Let {Ki : i ∈ I} be the family of open subgroups of G indexed by I. For
each i ∈ I let Ni := Tg∈G K g
i , which is a ﬁnite intersection as |G : Ki| is ﬁnite.
Hence the Ni are uniformly deﬁnable open normal subgroups of G. Setting
Hi := G/Ni, the Hi are uniformly interpretable. Put C := {Hi : i ∈ I}. Then
any non-principal ultraproduct of members of C is deﬁnable in an ultrapower of
G, so is NIP. It follows by [15, Theorem 1.2] that there is d ∈ N such that for each
H ∈ C, the soluble radical R(H) of H satisﬁes |H : R(H)| ≤ d. Furthermore,
by [26] there is a formula φ(x) such that for each H ∈ C, R(H) = {x ∈ H : H |=
φ(x)}.

It is now easily checked that G has a deﬁnable open normal subgroup G1

such that for all i ∈ I, G1/(Ni ∩ G1) is soluble. Thus, G1 is prosoluble.

It would be interesting to ﬁnd more examples of NIP 2-sorted proﬁnite groups

which are not full. In particular, Chatzidakis has proposed:

Problem 5.2. Find examples of NIP 2-sorted proﬁnite groups G = (G, I), not
p-adic analytic, where I is totally ordered.

The point here is that a chain I cannot witness the independence prop-
erty, and also Lemma 4.3 should not be applicable. The following observation
gives natural examples of non-full NIP 2-sorted proﬁnite groups, with I totally
ordered, which are p-adic analytic.

Lemma 5.3. Let G be a uniformly powerful pro-p-group, and G = (G, I) be
full. Relabelling elements of I, we may suppose that ω ⊂ I, with Kn := Pn(G)
for each n ∈ ω. Then the 2-sorted proﬁnite group G∗ = (G, ω) is deﬁnable in
Qan

p , so is NIP.

12

Proof. We have Pn(G) := {g ∈ G : ω(g) ≤ n}. Thus, it suﬃces to observe that,
by Theorem 3.2(iii), the function ω is deﬁnable in Qan
p .

We note next the following corollary of the characterisation in Theorem 1.1.

Proposition 5.4. Let G = (G, I) be a full proﬁnite group with NTP2 theory T .
Then the closed subgroups of G are uniformly deﬁnable in a NIP expansion of
G,

Proof. (i) We use the characterisation of the group G in Theorem 1.1 (i). First
suppose that G is a powerful pro-p group of rank d. For example by [12, Corol-
lary 5.8], if H is a closed subgroup of G, then there are h1, . . . , hd ∈ H such
that H = hh1i · . . . · hhdi. By [5, Proposition 1.28], each subgroup hhii has the
. Thus, using Proposition 1.2 and in particular Lemma 3.4, the closed
form h
subgroups of G are uniformly deﬁnable in Qan
p . For the general case, we now
argue as in Section 4, at the end of the proof of Theorem 1.1 (1. ⇒ 2).

Zp
i

Remark 5.5. 1. The proof of Proposition 5.1 (together with the proof of
Theorem 3.1 in [15]) suggests the following further observation. Let G = (G, I)
be a NIP proﬁnite group. As above, let {Ki : i ∈ I} be the family of open
subgroups of G indexed by I, and for each i ∈ I let Ni := Tg∈G K g
i , and put
Hi := G/Ni. Let C := {Hi : i ∈ I}. Let L be the language of groups, and let
LP = L∪{Pj : j ∈ I} where each Pj is a unary predicate. View each ﬁnite group
Hi as an LP -structure, interpreting Pj by NiNj/Ni. Let U be a non-principal
ultraﬁlter on I, and let H ∗ be an ultraproduct of the LP -structures Hi with
respect to U.

Now each Pj is interpreted in H ∗ by a ﬁnite index subgroup Pj(H ∗). Let
P ∗ := Tj∈I Pj(H ∗). Then by compactness and ω1-saturation of the LP -structure
G∗, we have H ∗/P ∗ ∼= G. Furthermore, we may also view each Hi in a natural
way as an Lprof -structure, and hence H ∗ as an Lprof -structure H∗ = (H ∗, I ∗),
where I ⊂ I ∗. Clearly H∗ has NIP, being interpretable in an ultrapower of G.
Now H∗ has an elementary extension ( ˜H, J) containing an element j ∈ J such
that I = {i ∈ J : i < j). It follows that I is deﬁnable in ( ˜H, J), so P ∗ is an
externally deﬁnable set in H∗ (see [24, Deﬁnition 3.8]). By a theorem of Shelah
([23], see also [24, Corollary 3.24]), the expansion of any NIP structure by the
collection of all externally deﬁnable sets is NIP. Thus, the expansion (H∗, P ∗) of
H∗, in which P ∗ is named by a unary predicate, itself has NIP theory (though
it will not be pseudoﬁnite, due to the deﬁnability of I ∗).

2. If G is a group deﬁnable in a model M of a theory T , then G◦ is deﬁned

to be the intersection of the ﬁnite index deﬁnable subgroups of G.

By an easy consequence of the Baldwin-Saxl Theorem (see [24, Section
8.1.2]), if T is NIP then ‘G◦ exists’, that is, G◦ is type-deﬁnable over ∅ and
|G : G◦| ≤ 2|T |. Assuming that G is suﬃciently saturated, the quotient G/G◦
does not depend on the particular model G, and so is an invariant of T , and
naturally carries the structure of a proﬁnite group. It can be checked that if
G = (G, I) is a 2-sorted NIP full proﬁnite group with theory T , then this in-
variant quotient is isomorphic to G itself; this holds for example because G has
ﬁnitely many subgroups of index n for each n, and they are all deﬁnable.

13

Recall (see [22]) that if G∗ is a suﬃciently saturated NIP group then G has a
unique smallest type-deﬁnable subgroup (G∗)oo of bounded index (that is, |G :
(G∗)oo| < κ, where the underlying structure is κ-saturated); also (G∗)oo is type-
deﬁnable over ∅ and the quotient G∗/(G∗)oo carries the ‘logic topology’, whose
closed sets are the preimages of type-deﬁnable subsets of G∗. This is a compact
topology on G∗/(G∗)oo (see e.g.
[24, Lemma 8.9]), and the isomorphism type
of G∗/(G∗)oo as a topological group is independent of the choice of (suﬃciently
saturated) G∗. It is shown in [18] – see Corollary 2.4 and the remarks before
Corollary 2.3 – that if G is a compact p-adic analytic group then (G∗)oo = (G∗)o
(this holds where G is a deﬁnable object in the structure Zan
p , and hence where
it is a deﬁnable object in the full 2-sorted structure G, since the ﬁnite index
subgroups are the same). It follows easily from Theorem 1.1 that if G = (G, I)
is any full proﬁnite NIP group, and G is viewed as a deﬁnable group in G, then
(G∗)oo = (G∗)o, and the corresponding quotient G∗/(G∗)oo is isomorphic as a
topological group to G.

3.

If H ∗ is the pseudoﬁnite group arising from a NIP proﬁnite group
G = (G, I) as described in (1), then (H ∗)◦ = P , so G ∼= H ∗/(H ∗)o is the
corresponding invariant for Th(H ∗) in the language LP . Working now in the
language Lprof, if G is full, then H is a quotient of G∗ by some deﬁnable normal
subgroup Ki where i lies in the ultrapower I ∗ of I. It is clear from (2) above
that Ki < (G∗)oo, and hence that (H ∗)oo = (H ∗)o = P , with (H ∗)oo/H ∗ ∼= G
(as topological groups, with the connected components in the language Lprof ).
The last assertions also hold in the language LP .

4. Proposition 2.8 of [18], combined with Theorem 1.1, easily yields that if
G∗ = (G∗, I ∗) is a suﬃciently saturated elementary extension of the full proﬁnite
NTP2 group G = (G, I), then G∗ is compactly dominated by G∗/(G∗)oo; that
is, if π : G∗ → G∗/(G∗)oo is the natural map, and J denotes the ideal of Haar
measure zero sets in G∗/(G∗)oo, then for every deﬁnable X ⊂ G∗,

{x ∈ G∗/(G∗)oo : π−1(x) ∩ X 6= ∅ ∧ π−1(x) ∩ (G∗ \ X) 6= ∅} ∈ J .

We propose the following speculative conjecture as a version of a model-
theoretic one-based/ﬁeld-like dichotomy conjecture for compact p-adic analytic
groups. As above, we below view a ﬁnite group G/Pn(G) as an Lprof -structure,
interpreting Ki for i ∈ I by the group KiPn(G)/Pn(G).

Conjecture 5.6. Let G = (G, I) be a uniformly powerful pro-p group, full as a
proﬁnite group. Then the following are equivalent.

(i) The ring Zp is not interpretable in G.
(ii) For every sentence σ in the language Lprof, there is N ∈ ω such that
either each quotient (G/Pn(G), I) satisﬁes σ for n > N , or each such quotient
satisﬁes ¬σ.

(iii) The group G is nilpotent-by-ﬁnite.

One intuition here is that if G is not nilpotent-by-ﬁnite, then we might hope
to have [Pi(G), Pj (G)] = Pi+j (G), or at least [Pi(G), Pi(G)] = P2i(G), in which
case the index set I inherits some algebraic structure analogous to Presburger
arithmetic, suggesting that (ii) is false.

14

Finally, we ask whether there is any analogue of Theorem 1.1 connecting
NIP pro-algebraic groups to groups deﬁnable in rings such as C[[T ]] over an
analytic language.

References

[1] M. Aschenbrenner, A. Dolich, D. Haskell, H.D. Macpherson, S.
Starchenko, ‘Vapnik-Chervonenkis density in some theories without the
independence property, I’, Trans. Amer. Math. Soc. 368 (2016), 5889–
5949.

[2] K.S. Brown, Cohoology of groups, Springer, Berlin, 1982.

[3] A. Chernikov, I. Kaplan, P. Simon, ‘Groups and ﬁelds with NTP2’, Proc.

Amer. Math. Soc. 143 (2015), 395–406.

[4] J. Denef, L. van den Dries, ‘p-adic and real subanalytic sets’, Ann. Math.

128 (1988), 79–138.

[5] J.D. Dixon, M.P.F. du Sautoy, A. Mann, D. Segal, Analytic pro-p groups,
2nd Ed., Cambridge Studies in Advanced Mathematics vol. 61, Cambridge
University Press, Cambridge, 1999.

[6] M.P.F. du Sautoy, ‘Finitely generated groups, p-adic analytic groups, and

Poincar´e series’, Ann. Math. 137 (1993), 639–670.

[7] L. van den Dries, D. Haskell, H.D. Macpherson, ‘One-dimensional p-adic

analytic subsets’, J. London Math. Soc. (2) 59 (1999), 1–20.

[8] R. Guralnick, ‘On the number of generators of a ﬁnite group’, Arch. Math.

53 (1989), 521–523.

[9] D. Haskell, H.D. Macpherson, ‘A version of o-minimality for the p-adics’,

J. Symb. Logic 62 (1997), 1075–1092.

[10] N. Hempel, ‘Groups with NTP2’, arXiv:1510.01049.

[11] I. Kaplan, A. Onshuus, A. Usvyatsov, ‘Additivity of the dp-rank’, Trans.

Amer. Math. Soc. 365 (2013), 5783–5804.

[12] B. Klopsch, ‘An introduction to compact p-adic Lie groups’, in Lectures
on proﬁnite topics in group theory (Eds. B. Klosch, N. Nikolov, C. Voll),
London Math Soc. Student Texts, 77, Cambridge University Press, Cam-
bridge, 2011, pp. 7-61.

[13] M. Lazard,

‘Groupes analytiques p-adiques’, Inst. Hautes Etudes Sci.

Publ. Math. 26 (1965), 389–603.

[14] A. Lucchini, ‘A bound on the number of generators in a ﬁnite group’,

Arch. Math 42 (1989), 313–317.

15

[15] H.D. Macpherson, K. Tent, ‘Pseudoﬁnite groups with NIP theory and
deﬁnability in ﬁnite simple groups’, in Groups and model theory, Contemp.
Math. 576, Amer. Math. Soc., Providence, RI, 2012, 255-267.

[16] N. Nikolov, D. Segal, ‘On ﬁnitely generated proﬁnite groups, I: strong

completeness and uniform bounds’, Ann. Math. 165 (2007), 171–238.

[17] N. Nikolov, D. Segal, ‘On ﬁnitely generated proﬁnite groups, II: products

in quasisimple groups’, Ann. Math. 165 (2007), 239–273.

[18] A. Onshuus, A. Pillay, ‘Deﬁnable groups and compact p-adic Lie groups’,

J. London Math. Soc. 78 (2008), 233–247.

[19] C.D. Reid, Finiteness properties of proﬁnite groups, PhD thesis, Queen

Mary, University of London, 2010.

[20] J-P. Serre, Galois cohomology, Springer, Berlin, 1997.

[21] A. Shalev, ‘Characterisation of p-adic analytic groups in terms of wreath

products’, J. Algebra 145 (1992), 204–208.

[22] S. Shelah,

‘Minimal bounded index subgroup for dependent theories’,

Proc. Amer. Math. Soc. 136 (2008), 1087–1091.

[23] S. Shelah, ‘Dependent ﬁrst order theories, continued’, Isr. J. Math. 173

(2009), 1–60.

[24] P. Simon, A guide to NIP theories, Lecture Notes in Logic vol. 44, Cam-

bridge University Press, Cambridge, 2015.

[25] J.S. Wilson, Proﬁnite groups, Oxford University Press, Oxford, 1998.

[26] J.S. Wilson, First-order characterization of the radical of a ﬁnite group,

J. Symb. Logic 74 (2009), 1429–1435.

16

