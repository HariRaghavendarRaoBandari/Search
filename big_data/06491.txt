6
1
0
2

 
r
a

 

M
1
2

 
 
]

.

A
C
h
t
a
m

[
 
 

1
v
1
9
4
6
0

.

3
0
6
1
:
v
i
X
r
a

On the regularity of fractional integrals of

modular forms.

Carlos Pastor

Abstract

In this paper we study some local and global regularity properties
of Fourier series obtained as fractional integrals of modular forms. In
particular we characterize the diﬀerentiability at rational points, de-
termine their Hölder exponent everywhere (using several deﬁnitions)
and compute the associated spectrum of singularities. We also show
that these functions satisfy an approximate functional equation, and
use it to discuss the graphs of “Riemann’s example” and of fractional
integrals of cusp forms for Γ0(N). We include some computer plots.

Introduction

1
The function

ϕ(x) = X

n≥1

sin(n2πx)

n2

(1)

was introduced in [24] by Weierstrass as an example supposedly given by
Riemann of a continuous function which is not diﬀerentiable anywhere. It
was later veriﬁed by Hardy [13] that this is indeed the case except perhaps at
the rational numbers of the form odd/odd or even/(4n + 1). The behavior
at the remaining points was not known until 1970, when Gerver proved
in [11, 12] that ϕ is actually diﬀerentiable at those rationals of the form
odd/odd while is not in the other case (these assertions are almost evident
from its graph when plotted with the aid of modern computers; see ﬁgure 1).
In the light of historical analysis [4] it seems probable that Riemann never
made such a claim. In spite of this, ϕ has become known in the literature
as “Riemann’s example”, and its regularity has been extensively studied by
several authors. What lies underneath its apparently chaotic behavior is the
action of a certain subgroup of SL2(Z) on Jacobi’s theta function

θ(z) = X

n∈Z

en2πiz

(=(z) > 0),

1

Figure 1: Riemann’s example.

which is a modular form of weight 1/2. The connection can be formally
stated as 2π−1ϕ0(x) = <θ(x) − 1. This leads to very fruitful strategies
that can be used to study ϕ: for example, in [14] and [17] the derivative is
understood as a certain wavelet transform and general theorems are applied
which relate bounds on one side of the transform with regularity on the
other; while in [7] an approximate functional equation for ϕ is deduced
integrating the one for θ.

In the same spirit, if we are given any modular form of positive weight
for a subgroup of ﬁnite index of SL2(Z) one can perform a formal fractional
integration on its Fourier series to force it to converge to a continuous func-
tion on all the real line. The regularity of the resulting function (understood
in several ways) has been studied for certain limited ranges in [5] and more
recently [6]. In this last paper, for example, Chamizo et al. determine under
some restrictions the so called pointwise Hölder exponent, which measures
how well a function can be locally approximated by polynomials.

In this paper we intertwine the wavelet transform and approximate func-
tional equation approaches in order to study the general case. Indeed neither
technique suﬃces to determine the pointwise Hölder exponent everywhere,

2

0.511.52-1-0.50.51and one needs to resort to a combination of them. We also determine uncon-
ditionally other related local exponents, and characterize the rational points
at which the fractional integral is diﬀerentiable. Moreover we compute the
spectrum of singularities, which consists of the Hausdorﬀ dimension of the
sets where the function attains a certain pointwise Hölder exponent. For
the precise deﬁnitions see §2.

As noted by Duistermaat in [7], the approximate functional equation
deepens our understanding of the graph of these functions. In particular it
shows that around rational numbers we should expect oscillations of the form
xag(1/x), where g is a periodic function also given by a fractional integral
of a modular form (these oscillations are clearly visible in ﬁgure 1). Another
consequence of the functional equation is that these graphs are fractal in the
sense that they satisfy a very particular kind of approximate self-similarity
around rational numbers and quadratic surds. These features are studied in
detail in the case of “Riemann’s example”, and all the possibilities for g are
determined.

We also perform a brief analysis of the case of cusp forms for the group
Γ0(N), that is, the subgroup of SL2(Z) consisting of those matrices whose
bottom-left entry is divisible by N. In this setting the vector space of cusp
forms has a basis consisting of normalized eigenfunctions for all the Hecke
operators, and the elements of this basis are classiﬁed into newforms and
oldforms, depending on whether they originate on Γ0(N) or derive from
forms on Γ0(N1) for some proper divisor N1 of N (see [2]). The modular-
ity theorem (one of the major mathematical achievements of contemporary
mathematics) states that there is a correspondence between isogeny classes
of elliptic curves over Q of conductor N and newforms of weight 2 for the
group Γ0(N) and trivial multiplier system. The coeﬃcients of these new-
forms coincide with those of the Hasse-Weil L-function of any elliptic curve
in the associated isogeny class.

It is known that some arithmetic properties of the curve are encoded
into analytic properties of the L-function: the Birch and Swinnerton-Dyer
conjecture—of which some particular cases have been proven—relates the
rank of the group of rational points of the curve with the order of the zero at
z = 1 of the L-function. In [5] it is shown that some of these analytic proper-
ties are also reﬂected on fractional integrals of the corresponding newforms,
and can be read oﬀ their graphs.

Here we focus on a diﬀerent aspect: we study how the action of the
normalizer of Γ0(N) on Q and on the newform constraints the possible set of
functions g for which we should expect oscillations of type xag(1/x) around
rational numbers. More precisely, we characterize when the normalizer acts

3

transitively on Q and then prove that if some extra conditions are met we
can assure g to be, again, a fractional integral of the original newform.

The layout of this paper is the following: in §2 we state our main results.
§3 contains some preliminary lemmas, while §4 and §5 are devoted to devel-
oping the tools concerning the approximate functional equation and wavelet
approaches. In §6 we focus on determining the Hölder exponents while §7
deals with the spectrum of singularities. Finally, §8 and §9 correspond to
the ϕ and Γ0(N) cases, and include computer-generated images of both of
them.

2 Notation and main results
The notation f(x) (cid:28) g(x), or f = O(g), will be employed to denote that the
inequality |f(x)| ≤ C|g(x)| is satisﬁed for some unspeciﬁed positive constant
C, usually as x converges to a certain point.

We introduce the following spaces of complex-valued functions, deﬁned

either in all R or in an open subset of R.

• For 0 ≤ s ≤ 1 we deﬁne Λs(x0) as the set of all continuous functions

which satisfy a s-Hölder condition at x0, i.e,

|f(x) − f(x0)| (cid:28) |x − x0|s

(x → x0),

and analogously one deﬁnes Λs(Ω) for any subset Ω ⊂ R as the set of
all continuous functions satisfying a uniform s-Hölder condition on Ω.
• For any s ≥ 0 we deﬁne Cs(x0) as the set of all continuous functions
for which there is some polynomial P of degree less than or equal to s
satisfying

|f(x) − P(x − x0)| (cid:28) |x − x0|s

(x → x0).

• For any 0 ≤ s ≤ 1 and any integer k ≥ 0 we deﬁne Ck,s(x0) as the set of
all continuous functions for which f (k) exists in an interval I containing
x0 and veriﬁes f (k) ∈ Λs(x0). Analogously one deﬁnes Ck,s(Ω) for an
open set Ω ⊂ R as the set of all continuous functions for which f (k)
exists in Ω and f (k) ∈ Λs(K) for every compact subset K ⊂ Ω.
Finally one deﬁnes the spaces Λslog, Cslog and Ck,s
in the previous deﬁnitions by |x − x0|s log |x − x0|.

log by replacing |x − x0|s

4

We choose the following Hölder exponents as measures of the local reg-

ularity of a function f at a certain point (cf. [6, 22]):

β(x0) := sup{s : f ∈ Cs(x0)},
β∗(x0) := sup{k + s : f ∈ Ck,s(x0)},
β∗∗(x0) := lim
I→{x0}

sup{k + s : f ∈ Ck,s(I)}.

The ﬁrst one, β(x0), also called the pointwise Hölder exponent, is the
most local in nature and gives precise information about how well the func-
tion can be approximated by a polynomial in arbitrarily small neighborhoods
of x0, even when no derivative exists near that point (note that P in the
deﬁnition of Cs(x0) need not be the Taylor polynomial).
The second one, β∗(x0), also called the restricted local Hölder exponent,
is more demanding in the sense that f must be diﬀerentiable enough times
for it to coincide with β(x0). This is in some sense like imposing that the
polynomial is the actual Taylor polynomial of f.
Finally, β∗∗(x0), the local Hölder exponent, requires f not only to be
diﬀerentiable in open neighborhoods, but also its derivatives to satisfy a
Hölder condition in them. The importance of this last one resides in the fact
that it behaves well under the action of a wide class of pseudo-diﬀerential
operators (cf. [22]).

It is not hard to prove that they satisfy the inequalities

β(x) ≥ β∗(x) ≥ β∗∗(x),

and that there are examples for which both inequalities are strict (it suﬃces
to consider functions of the form xa sin x−b; see [6]).

Unless otherwise stated from now on f will denote a nonzero modular
form of weight r for a subgroup Γ of ﬁnite index of SL2(Z) and multiplier
system {µγ} (cf.
[16, 21]). This means that f is analytic in the upper
half-plane H, transforms by the law

 

!

f(γz) = µγ(cz + d)rf(z)

for every γ =

a b
c d

∈ Γ

(2)

where |µγ| = 1, and has at most polynomial growth when =z → 0+. The
term γz stands for the Möbius transformation (az + b)/(cz + d). We also
introduce the classical notation jγ(z) := cz+d. All the power and logarithm
functions considered in this article correspond to the branch with argument
determination −π < arg z ≤ π.

5

Given any matrix γ in GL+

2(R) we deﬁne the slash operator |γ acting on

f by

(cid:0)jγ(z)(cid:1)r .
f|γ(z) := (det γ)r/2 f(γz)

(3)

n≥0

(z ∈ H).

ma
0

0
√
ma

1/

In particular if γ ∈ Γ we have f|γ = µγf. More generally if the group
γ−1Γγ ∩ SL2(Z) has ﬁnite index in SL2(Z) then f|γ is a modular form of
weight r for this group in the sense deﬁned above, albeit the multiplier
system might change even if γ−1Γγ = Γ. The ﬁniteness condition is satisﬁed
in particular for any γ ∈ SL2(Z). We also note that the slash operator
satisﬁes (f|γ)|δ = f|γδ for any two matrices γ and δ.
We will employ the nonstandard notation f γ to mean the same as f|γ
For a cusp we mean either a rational number or ∞. Under the previous

to avoid complications when adding subscripts.

conditions f admits a “Fourier” expansion at every cusp a (cf. [16])

ne2πi(n+κa)z
aa

f σa(z) = X
(cid:17), ma denoting the width of a. To avoid the ambigu-

In this expression σa stands for a scaling matrix for the cusp a, which corre-
sponds to a product γη where γ is any matrix in SL2(Z) satisfying γ(∞) = a

and η =(cid:16) √

ity of choosing between γ and −γ we will adopt the convention that either
c < 0, or c = 0 and d = 1, where (c, d) is the bottom row of γ. The cusp
parameter 0 ≤ κa < 1 depends only on a, while the coeﬃcients aa
n ∈ C may
assume a ﬁnite number of values, as multiplication of γ on the right by an
unit translation corresponds to the change of variables z 7→ z + 1/ma. Up
to this, they are unique. Moreover if one replaces a with any other cusp
lying in the same orbit modulo Γ, the right hand side of (3) stays invari-
ant up to multiplication by an unimodular constant and the aforementioned
translations.

If either κa > 0 or aa0 = 0 then we say that f is cuspidal at a, or that a
is cuspidal for f, and we deﬁne f(a) = 0. Otherwise we deﬁne f(a) = aa0.
Finally, if f is cuspidal at every cusp we say that f is a cusp form.
We will assume that κa ∈ Q for any cusp a. This is not a big restriction
since any modular form coming from an arithmetic setting satisﬁes this, and
most examples are of this kind. Notice that under this assumption (3) is,
up to a dilation, a Fourier series in the usual sense.
In the case σ∞ = η expression (3) corresponds to

f(mz) = X

n≥0

ane2πi(n+κ)z

(z ∈ H),

(4)

6

where an = a∞
integral of f as the formal series (cf. [5, 6, 7, 17])

n , m = m∞, κ = κ∞. Given α > 0 we deﬁne the α-fractional

fα(mx) := X

n+κ>0

an

(n + κ)α e2πi(n+κ)x.

(5)

For example, with the notation used in the introduction, =θ1(x) = 2ϕ(x).
a Γσa ∩SL2(Z) always has ﬁnite index in SL2(Z) and there-
α makes sense. In this fashion we obtain a collection of

α := (cid:0)f σa(cid:1)

The group σ−1

fore f σa
formal series

α (x) = X

f σa

n+κa>0

aa
n

(n + κa)α e2πi(n+κa)x.

Note that f σa
α is uniquely determined by the orbit of the cusp a up to trans-
lation and multiplication by an unimodular constant. As we will see, these
α are intimately linked one to each other.
f σa

Although the results in this section are stated for an arbitrary modular
form, in the proofs (§§3-6) we will restrict to the case m∞ = 1, κ∞ = 0. This
simpliﬁes some arguments and can be assumed without loss of generality, as
up to dilation any modular form is of this kind.

Our ﬁrst three theorems establish some global and local regularity prop-
erties of fα. We use the following notation: for any real s we denote by [s]
its integer part, i.e., the biggest integer which is smaller than or equal to s,
and by {s} its decimal part s − [s]. We also deﬁne α0 := r/2 if f is a cusp
form and α0 := r otherwise.
Theorem 1 (Global regularity). The following holds:

1. For α ≤ α0 the series (5) deﬁning fα diverges in a dense set.
2. For α > α0 the series (5) deﬁning fα converges uniformly to a contin-
uous function in all the real line. Moreover fα ∈ C[α−α0],{α−α0}(R) if
α − α0 /∈ Z and fα ∈ Cα−α0−1,1

(R) otherwise.

log

3. If 0 < α− α0 ≤ 1 then fα /∈ C1,0(I) for any open interval I. The same

is true for <fα and =fα.

Theorem 2 (Local regularity at rationals). Let x be any rational number
and β(x), β∗(x) and β∗∗(x) the Hölder exponents of either fα, <fα or =fα.
Then:

1. If f is cuspidal at x then β(x) = 2α − r. Otherwise β(x) = α − r.

7

2. If f is a cusp form then

β∗(x) = [α − r/2] + min(cid:0)1, 2{α − r/2}(cid:1).

If f is not a cusp form then

([α − r] + min(cid:0)1, 2{α − r} + r(cid:1)

β∗(x) =

α − r

f cuspidal at x, α − r /∈ Z
f not cuspidal at x or α − r ∈ Z.

3. In any case β∗∗(x) = α − α0.
4. If 0 < α−α0 ≤ 1 then fα (resp. <fα, =fα ) is not diﬀerentiable at any
rational point which is not cuspidal for f. If x is cuspidal for f then
fα (resp. <fα, =fα ) is diﬀerentiable at x if and only if α > (r + 1)/2,
and in this case the derivative is given by

Z

α(x) = (2π)α
f0
(im)αΓ(α)

(x)

(z − x)α−1f0(z) dz.

(cid:26)

(cid:12)(cid:12)(cid:12)(cid:12)x − p

q

(cid:12)(cid:12)(cid:12)(cid:12) (cid:28) 1

The regularity at a particular irrational point depends on how well this
point can be approximated by rationals which are not cuspidal for f. This
is precisely measured by the following quantity:1

τ :

τx := sup

qτ for inﬁnitely many non-cuspidal rationals p

.
(6)
The inequality τx ≥ 2 is not only always satisﬁed for any irrational number
x but, in fact, 2 is always contained in the set on the right hand side of (6).
This follows from Hedlund’s lemma (see [20]).
Theorem 3 (Local regularity at irrationals). Let x be any irrational number
and β(x), β∗(x) and β∗∗(x) the Hölder exponents of either fα, <fα or =fα.
Then:

q

(cid:27)

1. If f is a cusp form then β(x) = β∗(x) = β∗∗(x) = α − r/2.
2. If f is not a cusp form,

(cid:19)

(cid:18)
1 − 1
([α − r] + min(cid:0)1,{α − r} + r/τx
τx

r

(cid:1) α − r /∈ Z

α − r ∈ Z

β(x) = α −

β∗(x) =
α − r
β∗∗(x) = α − r.

1The symbol (cid:28) could be replaced by ≤ in this deﬁnition without aﬀecting the value

of τx, but this convention simpliﬁes some arguments later on.

8

Remark. Regarding the diﬀerentiability of these functions at irrational points
we could not prove anything beside the obvious results: it is not diﬀerentiable
whenever β(x) < 1, while it must be for β(x) > 1.

As mentioned in the introduction an approximate functional equation
plays a key role in the proof of some of these results. This equation has
interest on its own and for this reason we include it here:
Theorem 4 (Approximate functional equation). Let σ = σx0 be any scaling
matrix for the cusp x0 ∈ Q. Then:
fα(x) = Ai−αf(x0)ψ(x − x0) + B|x − x0|2α(x − x0)−rf σ
(
where
α − r /∈ Z
xα−r
xα−r log x α − r ∈ Z .

(cid:0)σ−1x(cid:1) + E(x)

ψ(x) =

α

The constants A and B are real and nonzero, and moreover B > 0. The
error term E(x) is C1,0 outside x0 and satisﬁes E ∈ C2α−r+1(x0).

This theorem is still true for any σ ∈ SL2(R) as long as f σ is a modular
form for a ﬁnite index subgroup of SL2(Z) and the bottom-left entry of σ is
negative (see §4). Note that it may be applied to f σb and σ = σ−1
b σa to link
α for any two rational
the behavior of f σb
cusps a and b. Note also that if σ ∈ Γ then the function f σ coincides up to
constant with f, and hence the result may be understood as an approximate
version of (2), with an extra term appearing if f(x0) 6= 0.

α near σ(∞) with the function f σa

Theorem 4 is a generalization of lemma 3.8 of [6], and was already known
in the literature in the case when f is a classical cusp form of integer weight
r > 2 and α = r − 1. In this context fr−1 is called the Eichler integral of f
and the approximate equation is in fact exact, the error term corresponding
to the period polynomial of f of the Eichler-Shimura theory (cf. [8]):
Corollary 5. If f is a cusp form of weight r > 2 and α = r − 1 then the
error term E(x) in theorem 4 is given by

Z x0+i∞

x0

E(x) =

(2π)r−1

(im)r−1Γ(r − 1)

(z − x)r−2f(z) dz.

If moreover r is an integer then E is a polynomial.

When f is not a cusp form the pointwise Hölder exponent of fα at the
irrational numbers ranges in a continuum between the values α − r and

9

α− r/2 (cf. theorem 3). An interesting concept to study in this case is that
of the spectrum of singularities, which consists of the function d : [0, +∞) →
[0, 1] ∪ {−∞} that assigns to each δ ≥ 0 the Hausdorﬀ dimension of the set
{x : β(x) = δ} if this set is nonempty and −∞ otherwise (cf.
[6, 17]).
If the image of d is not discrete then it is said that fα is a multifractal
function, for the sets where a certain regularity is attained then correspond
to a “continuous collection” of sets with fractional Hausdorﬀ dimension.
Theorem 6 (Spectrum of singularities). Let d be the spectrum of singular-
ities of either fα, <fα or =fα. Then:

1. If f is a cusp form:

d(δ) =



δ = α − r/2
δ = 2α − r

1
0
−∞ in other cases.

2. If f is not a cusp form:



d(δ) =

r

2 + 2 δ−α
0
−∞

α − r ≤ δ ≤ α − r/2
δ = 2α − r
in other cases.

As a corollary the functions fα, <fα and =fα are multifractal if and only

if f is not a cusp form.

3 Preliminary lemmas
We include in this section some auxiliary results that will be used later
on. The ﬁrst ones describe some general aspects of the behavior of modular
forms, and are consequence of (2) and (3). Their proofs are based on §3 of [5].
Lemma 7 (Expansion at the cusps). Let p, q be coprime integers and z =
x+iy ∈ H. Let m = mp/q be the width of the cusp p/q. Suppose the quantity
|qz − p|2/y remains uniformly bounded. Then:

f(z) =

mr/2(cid:0)qz − p(cid:1)r + O

f(p/q)

(cid:16)

y−r/2e−Ky|qz−p|−2(cid:17)

for some constant K > 0 independent of p/q.

10

Proof. A scaling matrix σ = σp/q for the cusp p/q has the following form:

!

  ∗

σ−1 =

∗
√
√
m −p

q

.

m

Once we have ﬁxed δ > 0, from (3) one deduces that for some K0 > 0,

f(σw) =(cid:0)jσ(w)(cid:1)rf(p/q) + O

(cid:16)(cid:12)(cid:12)jσ(w)(cid:12)(cid:12)re−K0=w(cid:17) (=w ≥ δ).

We now perform the change of variables σw = z and use jσ(w) =(cid:0)jσ−1(z)(cid:1)−1
and =w = =z(cid:12)(cid:12)jσ−1(z)(cid:12)(cid:12)−2, from where the desired expansion follows at once.

The constant K may be chosen independent of p/q because there are only
ﬁnitely many equivalence classes of cusps.

meaning of imposing that z lies in the circle

The condition |qz−p|2/y ≤ δ that appeared in lemma 7 has the geometric
(cid:26)

!

(cid:27)

= γ(cid:0){=z ≥ δ−1}(cid:1),

∈ SL2(Z)

γ =

z :

 
p ∗
q ∗

(cid:12)(cid:12)(cid:12)(cid:12)z − p

q

(cid:12)(cid:12)(cid:12)(cid:12) ≤ δ

2q2

− i

δ
2q2

property: SFp/q ⊃ {0 < =z < 1/2}. This is clear from the fact that the

These circles are usually called generalized Ford circles (Speiser circles). In
the particular case δ = 2 we will denote them by Fp/q and use the following
fundamental domain for SL2(Z)\H is contained in {=z ≥ 1/2}.2

We recall that we have deﬁned α0 as r/2 if f is a cusp form and r

otherwise.
Lemma 8. The modular form f satisﬁes

f(z) (cid:28) (=z)−α0

(=z → 0+).

Conversely one has f(x + iy) (cid:29) y−r/2 whenever x is an irrational number
and f(x+iy) (cid:29) y−r whenever x is a non-cuspidal rational point, both bounds
valid for inﬁnitely many values of y → 0+ (not uniformly in x).
Proof. Let z = x + iy with 0 < y < 1/2. By the previous remarks z
must be contained in some Ford circle Fp/q, and hence lemma 7 shows that
f(z) (cid:28) y−r. If f is cuspidal at p/q then by the same argument f(z) (cid:28) y−r/2;
in particular this happens when f is a cusp form.

2The standard Ford circles (case δ = 1) are intimately related to Farey sequences and

diophantine approximation, as is beautifully explained in [10].

11

If x is a non-cuspidal rational point then by lemma 7 applied at p/q = x

we obtain f(z) (cid:29) y−r as y → 0+.
(Lem. 3.4 of [5]) For the remaining case we consider the function g(z) =
yr/2|f(z)|. Since the multiplier µγ in (2) is unimodular it readily follows that
g is Γ-invariant. Now if x is an irrational number then the line {<z = x}
cuts the boundary of inﬁnitely many generalized Ford circles for any δ ≥ 2
at a sequence of points x + iyn with arbitrarily small yn. For each of them
we may ﬁnd an element γ ∈ SL2(Z) sending x+ iyn to a point wn in the line
{=w = δ−1}. We may further assume −1/2 ≤ <wn ≤ 1/2 by composing
γ with a translation if necessary. The inverse of γ can be decomposed as
γ−1 = γ0γi, where γ0 ∈ Γ and γi pertains to a ﬁxed ﬁnite right transversal.
Therefore g(x + iyn) = g(γi(wn)), for some point wn in the segment Iδ =

{=w = δ−1,−1/2 ≤ <w ≤ 1/2}. Since each of the functions gi(z) = g(cid:0)γi(z)(cid:1)

has a ﬁnite number of zeros in every compact subset of H, we may choose δ
so that none of the gi vanish on Iδ, guaranteeing gi(wn) (cid:29) 1. This proves
f(x + iyn) (cid:29) y
Lemma 9. Let τ ≥ 2 and x0 an irrational number. The following holds:

−r/2
n

.

1. If all the non-cuspidal rationals p/q satisfy

then f(x + iy) (cid:28) y−(1− 1

τ for 0 < y < 1/2.

2. If there are inﬁnitely many non-cuspidal rationals p/q satisfying

qτ
τ )r + y−r|x − x0| r

q

(cid:12)(cid:12)(cid:12)(cid:12)x0 − p
(cid:12)(cid:12)(cid:12)(cid:12)x0 − p

q

(cid:12)(cid:12)(cid:12)(cid:12) (cid:29) 1
(cid:12)(cid:12)(cid:12)(cid:12) (cid:28) 1

qτ

(7)

(8)

then f(x0 + iy) (cid:29) y−(1− 1

τ )r for inﬁnitely many values of y → 0+.

Proof. 1) Let z = x + iy with 0 < y < 1/2. Then z must be contained in
one of the circles Fp/q. We will use again the expansion at the cusp given
by lemma 7. If p/q is cuspidal for f then:

f(x + iy) (cid:28) y−r/2 ≤ y−(1− 1

If p/q is not cuspidal we have

f(x + iy) (cid:28) q−r

 (cid:18)

(cid:19)2

x − p
q

12

τ )r.
!−r/2

+ y2

.

By hypothesis p/q must satisfy (7) and therefore

q−r (cid:28)

q

(cid:12)(cid:12)(cid:12)(cid:12)x0 − p
(cid:12)(cid:12)(cid:12)(cid:12)r/τ (cid:28)
(cid:12)(cid:12)(cid:12)(cid:12)r/τ (cid:18)
(cid:12)(cid:12)(cid:12)(cid:12)x − p

q

x − p
q

(cid:12)(cid:12)(cid:12)(cid:12)x − p
(cid:19)2

q

(cid:12)(cid:12)(cid:12)(cid:12)r/τ
+ |x − x0|r/τ .
!−r/2

+ y2

+ y−r|x − x0|r/τ .

Hence:

f(x + iy) (cid:28)

Arguing by cases depending on whether y ≤ |x − p/q| or not it is not hard
to prove that the ﬁrst term is (cid:28) y−(1− 1

2) The case τ = 2 has already been established in lemma 8, so we may
assume τ > 2. By hypothesis there must exist an equivalence class of non-
cuspidal rationals modulo Γ for which inﬁnitely many satisfy (8). For any
of those rationals p/q we choose z = x0 + iy with y = q−τ and note that

τ )r.

|qz − p|2

y

= q2+τ

!

+ y2

(cid:28) q2−τ .

(cid:12)(cid:12)(cid:12)(cid:12)2

 (cid:12)(cid:12)(cid:12)(cid:12)x0 − p
!r/2

q

 

NX

Applying lemma 7 again we obtain:

|f(x0 + it)| = Cy−r/2

y

|qz − p|2

(cid:16)

y−r/2e−Kqτ−2(cid:17) (cid:29) q(τ−1)r,

+ O

the constant C not depending on p/q. Since q(τ−1)r = y−(1− 1
the proof.
Lemma 10. The partial sums in the Fourier expansion (4) satisfy

τ )r this ﬁnishes

ane2πinx (cid:28) N α0 log N.

n=0

Proof. (Lem. 3.2 of [5]) Using the Dirichlet kernel DN(z) = P|n|≤N e2πinz
we may write(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) NX

|f(u + i/N)||DN(x − u − i/N)| du.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) (cid:28)

ane2πinx

Z 1

0

n=0

We apply lemma 8 to bound the ﬁrst factor by N α0. Since kDNk1 (cid:28) log N
we obtain the estimate.

13

Lemma 11. If f is a cusp form then the coeﬃcients in the expansion (4)
satisfy

C1N r ≤ X

n≤N

|an|2 ≤ C2N r

for some C1, C2 > 0.
Proof. (Lem. 3.2 of [5]) Let g(z) = (=z)r/2|f(z)|. We claim that there are
constants C, C0 > 0 such that |{x : g(x + i/N) > C} ∩ [0, 1]| > C0 for every
integer N ≥ 0. Because f is cuspidal the function g, being Γ-invariant and
bounded in a fundamental domain for Γ\H must be globally bounded. Using
Parseval’s identity,
N r (cid:28) N r

|g(u + i/N)|2 du =X

|an|2e−4πn/N (cid:28) N r.

Z 1

0

n

|an|2 (cid:28) N r.

The upper bound implies at onceX
|an|2 ≥X
On the other hand,X

n≤N

n≤KN

n

|an|2e−4πn/N − X

|an|2e−4πn/N

(cid:29) N r − C00e−2πKN r,

n>KN

where the sum after the minus sign has been estimated summing by parts
and using the upper bound. We may now choose K big enough to ﬁnish the
proof.
We still have to justify the previous claim. Let C1, C2 > 0 be constants
to be determined later and consider the intervals |x − p/q| ≤ C2/(qN 1/2)
with C1N 1/2 < q < C2N 1/2. For 2C3
2 < C1 these are disjoint and cover
a positive portion of the interval [0, 1]. Suppose that z = x + i/N with x
lying in one of those intervals and let γ ∈ SL2(Z) satisfying γ(p/q) = ∞.
We may decompose γ−1 = γ0γi, where γ0 ∈ Γ and γi lies in a ﬁxed ﬁnite
right-transversal for Γ. Hence g(z) = gi(γz) where gi(z) = g(γiz). It can
be readily checked that 1/(2C2
1, hence it suﬃces to show
that we may choose C1 and C2 to ensure that every gi is bounded below in
that strip. But this follows from the fact that gi(z)/(=z)r/2 = |f γi(z)| has
a Fourier expansion (3).

2) ≤ =(γz) ≤ 1/C2

The following lemma will be our main tool to study fα. We do not
assume m = m∞ = 1 and κ = κ∞ = 0 because we will need the general
statement in §4.

14

Lemma 12. For α > α0 the series (5) converges uniformly to a continuous
function fα, which admits the following integral representation

Z

(z − x)α−1(cid:0)f(z) − f(∞)(cid:1) dz,

fα(x) = (2π)α

(im)αΓ(α)

(x)

where (x) denotes the vertical ray connecting x with i∞.
Proof. Summing by parts (5) and using the estimates for partial sums given
in lemma 10 it is plain that the series converges uniformly and hence to a
continuous function.

To prove the integral representation we start with

fα(x + iy) = (2π)α
mαΓ(α)

Z ∞

0

tα−1(cid:0)f(x + iy + it) − f(∞)(cid:1) dt,

identity that can be obtained from (4) integrating the series term by term
because of the uniform convergence in the region =z ≥ y. Now it suﬃces
to take the limit y → 0+ on both sides. The left hand side corresponds to
the Abel summation of a converging Fourier series, while in the right hand
side the dominated convergence theorem applies with the bounds obtained
in lemma 8.

Our last lemma is a very particular version of the diﬀerentiation under

the integral sign theorem.
Lemma 13. Let γ ∈ SL2(R) and let I be a bounded open interval whose
closure does not contain the pole of γ. Let g(z, x) be a function continuously
diﬀerentiable with respect to x in I and analytic for z ∈ H. Assume moreover
that both g and gx have exponential decay when =z → +∞ in vertical strips,
and that for some β > 0, η > 0 they satisfy the following estimates when
z → γ(x) uniformly in x ∈ I:

g(z, x) = O(cid:0)(z − γx)β+η−1(=z)−η(cid:1)
gx(z, x) = O(cid:0)(z − γx)β+η−2(=z)−η(cid:1)

F 0(x) =

(γx)

(x ∈ I).

gx(z, x) dz

15

Then the function

F(x) =

g(z, x) dz

(x ∈ I)

(γx)
is in Λβ(I) for 0 < β < 1, in Λlog
1 (I) for β = 1 and in C1,0(I) for β > 1. In
this last case,

Z

Z

Proof. Assume x ∈ I and h 6= 0 satisfying x + h ∈ I. Using Cauchy’s
theorem together with the estimates for g we can write for 0 < u < v:

F(x + h) − F(x) =

Z γ(x)+iv
(cid:0)g(z, x + h) − g(z, x)(cid:1) dz
 
!
e−Kv + uβ + huβ−1 + hβ+η
uη

γ(x)+iu

.

+ O

It is clear now that F must be continuous, as for each ε we may choose u
and v so that for h small enough |F(x + h) − F(x)| ≤ ε.
For the rest of the proof we choose u = h and v = +∞, so that the error

term is of the form O(cid:0)hβ(cid:1). By the mean value theorem:

Z γ(x)+i∞

|gx(z, xz)| |dz| + O(cid:0)hβ(cid:1).

|F(x + h) − F(x)| (cid:28) h

Using the estimates for gx this last integral is of order O(cid:0)hβ−1(cid:1) for 0 < β < 1

γ(x)+ih

and of order O(log h) for β = 1.

Suppose now that β > 1. The estimates for gx justify the use of the
dominated convergence theorem, proving the existence and the formula for
F 0. Finally, the argument used to prove that F is continuous can be applied
directly to F 0 substituting β by β −1 to conclude that F 0 is also continuous.

4 Approximate functional equation
Let σ ∈ SL2(R) such that f σ is a modular form for a ﬁnite index subgroup
of SL2(Z) and assume its bottom-left entry is negative. Fix x0 = σ(∞) ∈ Q
and let x be an arbitrary real number distinct from x0. Moreover set C0 =

(2π)α/(cid:0)iαΓ(α)(cid:1).

Our starting point will be the integral representation given by lemma 12:

Z

(x)

(z − x)α−1(cid:0)f(z) − f(∞)(cid:1) dz.

fα(x) = C0

(9)

For the sake of simplicity we will hide some extra terms that appear along
the way inside the symbol (··· ); we will deal with them afterwards. The
reader can check that they all appear in (10-13).

Splitting the integral and performing the change of variables z = σw in

(9) we have:

16

Z x+2i
Z
(σw − x)α−1(cid:0)jσ(w)(cid:1)r−2(cid:0)f σ(w) − f(x0)(cid:1) dw + (··· ).

(z − x)α−1f(z) dz + (··· )

x

S

fα(x) = C0

= C0

where S corresponds to a subarc of the halfcircle with endpoints σ−1(x) and
σ−1(∞). If σ is not a scaling matrix then by f(x0) we mean the constant
f σ(∞), which might diﬀer from the one introduced in §2. If σ is a scaling
matrix then both deﬁnitions agree.
The integrand in the last equation has exponential decay when =w →
+∞. Applying Cauchy’s theorem to replace S with two vertical rays starting
at the endpoints of S and projecting to i∞:

(σw − x)α−1(cid:0)jσ(w)(cid:1)r−2(cid:0)f σ(w) − f(x0)(cid:1) dw + (··· ).

fα(x) = C0

Z

(σ−1x)

(σ−1x)

(w−σ−1x)α−1(cid:0)jσ(w)(cid:1)r−α−1(cid:0)f σ(w)−f(x0)(cid:1) dw+(··· ).

Substituting the relation (σw − x)jσ(w) = (w − σ−1x)jσ−1(x) [16, (2.4)]:

fα(x) = C0C1(cid:0)jσ−1(x)(cid:1)α−1Z
(cid:0)jσ(w)(cid:1)r−α−1. We will denote by φ(u+) the limit of φ(w) when w → u from
the upper half-plane. Adding and substracting φ(σ−1x+) =(cid:0)jσ−1(x)(cid:1)α−r+1

The constant C1 has the value e−2πiα if x < x0 and 1 otherwise. This
integral is of the form given in lemma 12 except for the extra factor φ(w) =

in the integrand, and using that jσ−1(x) = B1(x − x0) for some B1 > 0, we
arrive to

(σ−1x)

(13)

17

(··· ) = −C0

α

x+2i

The terms we have ignored are the following ones:

(2i)α

fα(x) = B|x − x0|2α(x − x0)−rf σ

α(σ−1x) + (··· ).
(z − x)α−1(cid:0)f(z) − f(∞)(cid:1) dz
!

Z x+i∞
f(∞) + C0
Z x+2i
(z − x)α−1(cid:0)jσ−1(z)(cid:1)−r dz
 
 Z x0+2i
Z x+2i
(cid:0)jσ−1(z)(cid:1)r
f(z) − f(x0)
+ C(x − x0)α−1Z

!
(z − x)α−1
(w − σ−1x)α−1(cid:0)φ(w) − φ(σ−1x+)(cid:1)(cid:0)f σ(w) − f(x0)(cid:1) dw.

+ C0f(x0)

dz (12)

+ C0

(11)

(10)

x0+2i

x

+

x0

The terms (10) and (12) make sense for any x ∈ R and are inﬁnitely many
times diﬀerentiable with respect to this variable. The other ones are dealt
with in the following lemmas:
Lemma 14. The term (11) has the following expansion:
(11) = Ai−αf(x0)ψ(x − x0) + E(x)

where

ψ(x) =

(
α − r /∈ Z
xα−r
xα−r log x α − r ∈ Z .

The constant A 6= 0 is real and the error term E(x) is inﬁnitely many times
diﬀerentiable.

Lemma 15. The term (13) is C1,0 outside x0 and of type O(cid:0)|x− x0|2α−r+1(cid:1)

when x → x0.

These two lemmas together with the previous manipulations constitute

the proof of theorem 4.
Proof of lemma 14. We may assume that f is not cuspidal at x0, since oth-
erwise (11) is equal to zero. Note that in this case by hypothesis α > r.
Renaming x − x0 to x if necessary we may further assume x0 = 0. Hence
up to a nonzero constant of the form Ai−αf(x0) we have to expand asymp-
totically the function

(14)

We will suppose for the moment that x > 0 and α − r /∈ Z. We have

Z 2i

0

zα−1
(x + z)r dz.

g(x) =

Z 2xi

0

zα−1

(cid:16)1 + z

x

(cid:17)r dz +

zα−r−1

(cid:16)1 + x

(cid:17)r dz.

z

Z 2i

2xi

g(x) = x−r

In the ﬁrst integral we perform a linear change of variables, while in the
second one we substitute the Laurent expansion

(cid:18)

1 + x
z

(cid:19)−r

 −r

!
xkz−k

k

=X

k≥0

18

which is uniformly convergent in the region |z| ≥ 2x. Integrating term by
term the expression now results

zα−1

 −r
!
Z 2i
(1 + z)r dz +X
Z 2i
 −r
(1 + z)r dz −X

zα−1

k≥0

k

k

0

0

k≥0

zα−r−k

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2i
 + h(x).

2xi

xk

α − r − k

!(2i)α−r−k

α − r − k

g(x) = xα−r

= xα−r

(15)

where h(x) is a function given by a power series which converges in a neigh-
borhood of 0. Notice that the expression within brackets is a constant A0
satisfying

for any complex T with |T| > 1 and arg T 6= π: the right hand side is indeed
constant as can be easily checked by diﬀerentiating with respect to T. Hence

A0 =

T α−r−k
α − r − k

Z T

 −r

!

0

k

k≥0

zα−1

(1 + z)r dz −X
Z T
!
 −r
(1 + t)r dt − X
 1
! 1
 −r
(1 + t)r − X

0≤k<α−r

tα−1

k

k

0

tr+k

0≤k<α−r



T α−r−k
α − r − k

 dt.

A0 = lim
T→+∞
Z ∞

=

0

tα−1

The sum corresponds to the Taylor expansion of order [α− r] of the function
(1− ξ)−r multiplied by ξr and evaluated at ξ = 1/t. Since all the derivatives
of this function have constant sign for ξ > 0 we deduce A0 6= 0. Although
the exact value of A0 is unimportant, using the integral formula for the error
term in the Taylor expansion one can easily obtain a closed formula in terms
of beta functions.
Suppose now that α− r is an integer. The same argument can be carried
on, but when integrating the Laurent series term by term the term corre-
sponding to k = α − r is now transformed into a logarithm. This term
results

!
xα−r(cid:0)−log(x/i)+log 2−log T(cid:1)

(T = 2i).

  −r

α − r

!
xα−r log z

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)2i

2xi

  −r

α − r

=

The ﬁrst summand corresponds to the main term, while the other two should
be merged into A0. This is relevant, as we will need A0 ∈ R in order to handle

19

the case x < 0. We may replace (15) with:

  −r

α − r

!
xα−r log(x/i) + A0xα−r + h(x).

g(x) = −

(16)

Finally if x < 0, we go back to (14) and notice that

g(x) = (−1)α−rg(−x),

and the very same equation is also satisﬁed by the main and error terms in
equations (15-16). Therefore we may apply the results we have obtained for
x > 0.
Proof of lemma 15. Because of the extra cancelation as w → σ−1x provided
by the second factor inside the integral in (13) and the exponential decay
given by the third factor when =z → +∞, lemma 13 can be applied with
η = α0 and β + η = α + 1. This shows that (13) is C1,0 in the complement
of {x0}.
Z

(w−σ−1x)α−1(cid:0)φ(w)−φ(σ−1x+)(cid:1)(cid:0)f σ(w)−f(x0)(cid:1) dw (cid:28) |x−x0|α−r+2

For the second estimate, it suﬃces to show that

(σ−1x)
when x → x0. Notice that for w = σ−1x + it we have

φ(w) =(cid:0)jσ(w)(cid:1)r−α−1 =
where c is the bottom-left entry of σ. Therefore applying the mean value
(
theorem we obtain for |x − x0| ≤ 1:
t|x − x0|α−r+2
tr−α−1

t ≤ |x − x0|−1
t ≥ |x − x0|−1 .

(−c)(x − x0) + ict

|φ(w) − φ(σ−1x+)| (cid:28)

(cid:19)r−α−1

(17)

(cid:18)

1

We divide now the integration domain in three intervals and use these esti-
mates, together with the trivial ones for f σ, concluding that the left hand
side of (17) is

 Z 1

0

tα(cid:0)1 + t−α0(cid:1) dt +

Z |x−x0|−1

1

!

tαe−Kt dt

(cid:28) |x − x0|α−r+2

Z ∞

+

|x−x0|−1

tr−2e−Kt dt.

This proves (17), since the ﬁrst two integrals are convergent and the last
one has exponential decay when x → x0.

20

Proof of corollary 5. If f is a cusp form then (11) and the ﬁrst summand of
(10) vanish. Moreover since α = r − 1 the function φ in (13) is constant,
and hence this term also vanishes. The remaining terms are:

(··· ) = C0

(cid:18)Z x0+2i
Z

x0

Z x+2i

Z x+i∞

(cid:19)

+

+

x0+2i

x+2i

(z − x)α−1f(z) dz.

= (2π)α
iαΓ(α)

(x0)

(z − x)α−1f(z) dz

5 Wavelet transform
Let α > 0 and suppose that ψ is a function satisfying:

1. ψ(k)(x) (cid:28)(cid:0)1 + |x|(cid:1)−α−1 for all k ≥ 0.
2. R
Z ∞

R xkψ(x) dx = 0 for 0 ≤ k < α.

Z ∞

3. Either

or

| ˆψ(ξ)|2 dξ
ξ

=

0

0

ˆψ(ξ) = 0 if ξ < 0

and

= 1

| ˆψ(−ξ)|2 dξ
Z ∞
ξ

| ˆψ(ξ)|2 dξ
ξ

= 1.

0

Z

ZZ

(cid:18) x − b

(cid:19) db da

Then we say that ψ is an analytic wavelet, and we deﬁne the wavelet trans-
form of a bounded function f with respect to ψ as

W(a, b) := 1

a

f(t) ¯ψ

R

(b ∈ R, a > 0).

dt

(cid:18) t − b

(cid:19)

a

If we also ask f to be periodic, with vanishing integral on each period,
and satisfying ˆf(ξ) = 0 for ξ < 0 in the distributional sense in case the same
is satisﬁed by ψ, then we have the following inversion formula:

f(x) =

W(a, b)ψ

R×R+

a

a2 .

(18)

The proof of this fact can be found in [14]. The outer integral in (18) in
principle has to be understood as an improper Riemann integral, but in our
applications it will be absolutely convergent.

The interesting fact about this transform is that the regularity of f in
a point x0 can be read oﬀ from the behaviour of its wavelet transform W
in a neighborhood of the point (0+, x0), as it is shown in the following two
theorems, which are slight modiﬁcations of the ones appearing in [18].

21

Theorem 16. Let 0 < β < α. If f ∈ Cβ(x0) then
W(a, b) (cid:28) aβ + |b − x0|β

when (a, b) → (0+, x0).
Theorem 17. Let 0 < β0 < β < α. If

W(a, b) (cid:28) aβ + aβ−β0|b − x0|β0

a

a

when (a, b) → (0+, x0) then f ∈ Cβ(x0) if β is not an integer and f ∈ Cβ
otherwise.

in the forms aβ(cid:16)1 + |b−x0|

The bounds involving W(a, b) in these two theorems may also be written
, respectively, from where

(cid:17)β and aβ(cid:16)1 + |b−x0|

log(x0)

(cid:17)β0

it is clear that the second one constitutes a strengthening of the ﬁrst.
Remark. Theorem 17 as stated in [18] is not entirely true: the author omits
that in the special case β ∈ Z the function f can indeed have a “logarithmic
chirp”, i.e., f(x) ≈ (x − x0)β log |x − x0| when x → x0 (as it is shown by
theorem 4; cf. §6). In the mentioned paper the proof is left to the reader for
β ≥ 1, and the range of applicability is somewhat more limited, as Jaﬀard
employs a broader deﬁnition of analytic wavelet for which this theorem is
only true if one adds the extra hypothesis [β] ≤ α − 1.
Proof of theorem 16. We can assume without loss of generality x0 = 0. By
hypothesis there is a polynomial P of degree strictly smaller than α such
that

|f(x) − P(x)| (cid:28) |x|β,

estimate which we may assume to hold globally. Hence, by the property 2
of analytic wavelets,

Z
Z
Z

R

R

|f(t) − P(t)|

(cid:12)(cid:12)(cid:12)(cid:12)ψ
(cid:18) t − b
(cid:12)(cid:12)(cid:12) + 1(cid:17)α+1 dt
(cid:16)(cid:12)(cid:12)(cid:12) t−b
(cid:0)|t| + 1(cid:1)α+1 dt + |b|β

|t|β

|t|β

a

a

(cid:19)(cid:12)(cid:12)(cid:12)(cid:12) dt
Z

(cid:0)|t| + 1(cid:1)α+1

dt

R

W(a, b) (cid:28) 1
(cid:28) 1

a

a

(cid:28) aβ
(cid:28) aβ + |b|β.

R

22

In order to prove theorem 17 we shall use the inversion formula (18),

which for convenience will be written in the following way:

Z

Z

R

where

ω(a, x) = 1

a

W(a, b)ψ

f(x) =

ω(a, x) da
a

R+

(cid:19)

db.

(19)

(20)

(cid:18) x − b

a

We prove ﬁrst some estimates for ω. In particular they show that (19) is an
absolutely convergent integral.
Lemma 18. Under the hypothesis of theorem 17 the function x 7→ ω(a, x) is
inﬁnitely many times diﬀerentiable and satisﬁes for all k ≥ 0 and for some
δ > 0:

∂kω

∂xk (a, x) (cid:28) a−k−1,
∂xk (a, x) (cid:28) aβ−k + aβ−β0−k|x − x0|β0

∂kω

(a ≤ 1,|x − x0| ≤ δ)

(21)

(22)

Proof. It is clear that W(a, b) is uniformly bounded and ψ and all its deriva-
tives have decay (property 1 of analytic wavelets). Therefore we may diﬀer-
entiate (20) under the integral sign obtaining

∂kω

∂xk (a, x) = 1

ak+1

Z

R

W(a, b)ψ(k)(cid:18) x − b

(cid:19)

a

db.

(23)

Integrating by parts in the deﬁnition of W(a, b) and using that the in-
tegral over each period of f vanishes it is readily seen that W(a, b) (cid:28) a−1.
Plugging this into (23) one obtains (21).

To prove (22) we ﬁrst assume without loss of generality that x0 = 0,
and that the bounds in the statement of theorem 17 hold uniformly in the
neighborhood a ≤ 1 and |b| ≤ 2δ. We have for a ≤ 1 and |x| ≤ δ:
∂xk (a, x) (cid:28) 1

ak+1

∂kω

Z

|b|>2δ

|b|≤2δ

(cid:16)(cid:12)(cid:12)(cid:12) x−b

a

db

(cid:12)(cid:12)(cid:12) + 1(cid:17)α+1

(cid:16)(cid:12)(cid:12)(cid:12) x−b
aβ + aβ−β0|b|β0
Z

(cid:12)(cid:12)(cid:12) + 1(cid:17)α+1 db + 1
(cid:0)|t| + 1(cid:1)α+1 dt + 1

|x − at|β0

ak+1

a

ak

dt

(t + 1)α+1

t>δ/a

Z
Z

(cid:28) aβ−k + aβ−β0−k
R
(cid:28) aβ−k + aβ−β0−k|x|β0

.

23

Proof of theorem 17. Again we can assume x0 = 0. Let N = [β] if β is not
an integer and N = β − 1 otherwise. We perform a Taylor expansion of
order N on ω:

NX

k=0

ω(a, x) =

∂kω

∂xk (a, 0) xk

k! + E(a, x).

Using the bounds of lemma 18 we can plug this into (19) to obtain

f(x) = P(x) +

E(a, x) da
a

R+

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

for certain polynomial P of degree at most [β]. It suﬃces to prove that the
integral term has the right behavior when x → 0.
We split the integral. In the range a ≤ |x| we use (22) with either x = 0
Z
Z
or k = 0 to obtain
a≤|x| E(a, x) da
In the complementary range, assuming that β is not an integer, we use the
formula for the Taylor error term together with (22):

|ω(a, x)| da
a

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) da

∂xk (a, 0)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤

|x|k
k!

NX

a≤|x|

a≤|x|

Z

a

+

k=0

(cid:28) |x|β.

a

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Z
a≥|x| E(a, x) da

a

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ≤ |x|N+1

(N + 1)!

Z

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ∂N+1ω

∂xN+1 (a, ξa,x)

a≥|x|

(cid:28) |x|β.

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ∂kω
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) da

a

When β is an integer the same argument works using (22) in the range
|x| ≤ a ≤ 1 and (21) in the range a ≥ 1. The right hand side has to be
replaced by |x|β log |x|.

We will apply these theorems with ψ(x) = (x + i)−α−1 to fα, where f
is a modular form. The reader can easily verify that ψ satisﬁes properties
1 and 2 of analytic wavelets. In order to check property 3 we compute ˆψ.
The integral

Z

ˆψ(ξ) =

e−2πiξx
(x + i)α+1 dx

R

vanishes for ξ ≤ 0 by Cauchy’s theorem. For ξ > 0 we perform a change of
variables obtaining

Z

Z

ˆψ(ξ) = ξαe−2πξ

e−2πiz
zα+1 dz

R+ξi

and by Cauchy’s theorem the integral on the right hand side is a constant
with respect to ξ. The exact value of the constant is not important, since

24

ψ needs not to be normalized for theorems 16 and 17 to hold, although it
can be explicitly computed by means of Hankel’s contour integral for the
reciprocal of the gamma function (cf. [25]).

It is also clear that fα is a periodic function, with vanishing integral
in each period, and whose Fourier transform in the distributional sense is
supported only in the positive frequencies. To compute its wavelet transform
with respect to ψ we just need to compute the one for g(x) = e2πiλx. This
can be done using some basic properties of the Fourier transform:

(

Wg(a, b) = e2πiλb ¯ˆψ(λa) =

Caαλαe2πiλ(b+ai) λ > 0
λ ≤ 0.
0

(24)

(25)

Hence

Wfα(a, b) = Caα(cid:0)f(b + ai) − f(∞)(cid:1).

Corollary 19. If for some 0 < β < α one has fα ∈ Cβ(x0) then

f(b + ai) (cid:28) aβ−α + a−α|b − x0|β

when (a, b) → (0+, x0). Reciprocally, if for some 0 < β0 < β < α one has

f(b + ai) (cid:28) aβ−α + aβ−β0−α|b − x0|β0

when (a, b) → (0+, x0), then fα ∈ Cβ(x0) if β is not an integer and fα ∈
Cβ
log(x0) otherwise. Moreover both statements remain true if one replaces fα
by its real or imaginary parts.
Proof. The part of the theorem concerning fα follows at once from theo-
rems 16 and 17 and (25). Also note that if fα ∈ Cβ(x0) or fα ∈ Cβ
log(x0)
then the same must hold for the real and the imaginary parts of fα.
On the other hand, <fα and =fα are bounded functions, and hence their
wavelet transforms are well deﬁned. By rewriting the sine and cosine func-
tions involved in their Fourier series by sums of exponentials and applying
(24) one obtains

Wfα(a, b) = 2W<fα(a, b) = 2iW=fα(a, b).

And since the inversion formula (18) is not used in the proof of theorem 16,
we may also apply this theorem to <fα and =fα.

25

6 Regularity theorems
The aim of this section is proving theorems 1, 2 and 3.
Lemma 20. If fα is in Ck,0(x) for k < α − α0, but cannot be continuously
diﬀerentiated k + 1 times in any open interval containing x, then

β∗(x) = k + min{1, βα−k(x)},

(k)
α = (2πi)kfα−k and the deﬁnition of

where βα−k denotes the pointwise Hölder exponent of fα−k. This formula
extends to <fα and =fα if both these functions satisfy the hypothesis and
their pointwise Hölder exponents coincide.
Proof. This follows at once from f
β∗.
Remark. In order to prove theorems 1 and 2 we anticipate two very simple
results which will come in handy. Applying corollary 19 with the bounds
from lemma 8 we obtain β(x) = α− r/2 for f cuspidal and x irrational and
β(x) = α − r for f not cuspidal and x any non-cuspidal rational.
Proof of theorem 1. 1) (Proposition 3.1 of [5]) If the series deﬁning fα con-
verge at a certain point for α < α0 then summing by parts the series deﬁning
fα0 must also converge at that point, and therefore we may reduce to this
case.

Suppose ﬁrst that f is cuspidal, we will prove that fr/2 diverges at
any irrational point x. Considering the kernels of summability ϕ1(u) =
!
e−2πu(ur/2 + 1) and ϕ2(u) = e−2πu, we have (see Th. III.1.2 of [26]):

 X

n>0

Anϕ1(ny) −X

n>0

lim
y→0+

yr/2f(x + iy) = lim
t→0+

Anϕ2(ny)

= 0

with An = an
lemma 8.

nr/2 e2πinx, as long as fr/2 converges at x; but this contradicts
Suppose now that f is not cuspidal. We prove that fr is not Abel
summable at any non-cuspidal rational point x. If this were not the case
then by lemma 12 we would have for some ‘ ∈ C,

Z ∞

y

(t − y)r−1(cid:0)f(x + it) − f(∞)(cid:1) dt.

‘ = lim
y→0+

fr(x + iy) = lim
y→0+

(2π)α
Γ(α)

But since by the expansion at the cusp the term f(x + it) behaves like Ct−r
for small t, the right hand side diverges.

26

tation given by lemma 12 repeatedly.

2) The result follows from applying lemma 13 to the integral represen-
3) Suppose ﬁrst that f is not cuspidal. If α−r < 1 then neither fα nor its
real or imaginary parts are diﬀerentiable at any non-cuspidal rational, since
they are at most (α−r)-Hölder at these points. Only the limit case α = r+1
remains. But now we may appeal to theorem 4, since 2α − r = r + 2 > 1
implies that both the second term and the error term are diﬀerentiable at the
rational x0, but the ﬁrst term is not if x0 is non-cuspidal. A more detailed
analysis shows that neither the real nor the imaginary parts of the function
Cx log x are diﬀerentiable at 0 for any complex constant C.
(Lem. 3.8 of [6]) Suppose now that f is cuspidal. If fα is in C1,0(I) then
by theorem 4 it is also in C1,0(γ(I)) for any γ ∈ Γ. It follows that f0
α must
exist and be continuous everywhere, and by Bessel’s inequality

2 (cid:29) X

n>0

kf0

αk2

|an|2
n2α−2 .

But the right hand side diverges for α − r/2 ≤ 1 as can be checked by
summing by parts and using the estimates of lemma 11.
Finally assume that either <fα or =fα is in C1,0(I). Since the periodic
Hilbert transform preserves the Sobolev space H1 (cf. §3 of [15]) and sends
a Fourier series to its conjugate series (and therefore <fα to =fα and =fα
to −<fα, cf. §II.5 of [26]), the function fα must, at least, have a weak
derivative in L2(I0) for some smaller interval I0. This is enough to carry on
the previous argument.
Proof of theorem 2. Let x0 be a rational number.

1) If f is not cuspidal at x0 then we already know β(x0) = α − r. Hence
may assume that f is cuspidal at x0. Choose a scaling matrix σ satisfying
σ(∞) = x0 and apply theorem 4. We deduce that fα ∈ C2α−r(x0) and that
fα /∈ C2α−r+ε(x0) for any ε > 0, since the term σ−1x diverges to ∞ when
x → x0 and f σ
α is a nonzero periodic function. Hence β(x0) = 2α − r.
The same must be true for <fα and =fα as long as the image f σ
α(R) is not
contained in any one-dimensional subspace of C. This is indeed the case as
α corresponds to a Fourier series with only positive frequencies.
f σ
2) The exponent β∗ is determined by applying lemma 20 with k = [α−α0]
if α − α0 /∈ Z and k = α − α0 − 1 otherwise (cf. theorem 1).
3) To determine β∗∗ note ﬁrst that theorem 1 implies β∗∗(x) ≥ α − α0.
Since this exponent also satisﬁes β∗∗(x) ≤ lim inf t→x β(t), as can be readily
seen from its deﬁnition, and we have β(x) = α − α0 for a dense set (the

27

irrational numbers if f is cuspidal and the non-cuspidal rationals otherwise)
we conclude β∗∗(x) = α − α0 for all x.

4) The case x0 non-cuspidal has already been treated in the proof of
theorem 1, part 3. Hence we may suppose that f is cuspidal at x0. We
appeal again to theorem 4 but now we will need the explicit expression for
the error term (cf. §4):

fα(x) = B|x − x0|2α(x − x0)−rf σ

α(σ−1x) + (10) + (12) + (13).

Hence whenever f0

Terms (10) and (12) are everywhere diﬀerentiable, while term (13) can be
diﬀerentiated at x0 by lemma 15. Hence fα is diﬀerentiable at x0 if and
only if the ﬁrst summand is. Since f σ
α is bounded, nonzero and periodic this
will happen if and only if 2α − r > 1. The same must be true for the real
and imaginary parts of fα, since the image of f σ
α is not contained in any
one-dimensional subspace of C.

α(x0) exists it is given by the sum of the derivatives
of the terms (10) and (12) evaluated at x0 (the other terms have vanishing
derivative at x0). Diﬀerentiating under the integral sign and integrating by
parts one obtains the desired formula.
Proof of theorem 3. Let x0 an irrational number. The pointwise Hölder ex-
ponent β(x0) is deduced by applying corollary 19 to the estimates of lemma 8
if f is a cusp form and of lemma 9 otherwise. The exponent β∗(x0) follows
from lemma 20, while β∗∗(x0) was already determined in the proof of theo-
rem 2, part 3.

7 Spectrum of singularities
In order to prove theorem 6 we will need some tools from diophantine anal-
ysis. More concretely we will need a reﬁnement of the following classic
theorem:
Theorem 21 (Jarník-Besicovitch). Let τ ≥ 2. The Hausdorﬀ dimension of
the set

(26)
is 2/τ. Moreover, if we denote by Ht the t-dimensional outer Hausdorﬀ
measure,

(cid:12)(cid:12)(cid:12)(cid:12) (cid:28) 1
qτ for inﬁnitely many rationals p
(cid:18) \

Aτ :=

(cid:12)(cid:12)(cid:12)(cid:12)x − p

q

(cid:26)

(cid:27)

q

(cid:19)

x :

H2/τ

Aτ0

> 0.

τ0<τ

28

case τ = 2 we adopt the convention that T

For the proof of theorem 21 when τ > 2 we refer the reader to the book
[9]: the ﬁrst statement corresponds to proposition 10.3, while the second one
is an immediate consequence of propositions 8.5, 8.6 and 10.4. In the limit
τ0<2 Aτ0 = A2 (equality which is
true anyway if one considers Aτ0 to be deﬁned for 1 < τ0 < 2). The proof
in this case follows from the fact that A2 is the set of all irrational numbers
(cf. theorem 5 of [10]).

Throughout this section it will be convenient to redeﬁne “cusp” to mean
an equivalence class of rationals modulo Γ (denoted by a, b, ...). The theorem
we need is the following, which takes into account that rational numbers are
well distributed among the diﬀerent cusps of Γ.
Theorem 22. Let a be a cusp for Γ and τ ≥ 2. The Hausdorﬀ dimension
of the set

(cid:26)

(cid:12)(cid:12)(cid:12)(cid:12)x − p

q

(cid:12)(cid:12)(cid:12)(cid:12) (cid:28) 1

τ :=
Aa

x :

(cid:27)
∈ a

is 2/τ. Moreover, if we denote by Ht the t-dimensional outer Hausdorﬀ
measure,

qτ for inﬁnitely many rationals p
(cid:18) \

(cid:19)

q

Aa
τ0

> 0.

H2/τ

τ0<τ

Theorem 22 is a particular case of more general results about Fuchsian
groups (cf. [23]). We provide here an elemental proof based on theorem 21.
Proof. Before beginning the proof, we note that we may assume without
loss of generality that Γ is a normal subgroup of SL2(Z). If this is not the
case, we simply replace Γ with the biggest normal group it contains, i.e.,
the intersection of all its conjugates.
τ. We
claim that if p/q is a rational number in a neighborhood of x and q0 denotes
the denominator of γ(p/q) then q0 (cid:28) q. Indeed q0 = cp + dq, and p (cid:28) q
because |p/q| ∼ |x|. From this together with the mean value theorem applied
to |γ(x) − γ(p/q)| we deduce that γ(x) ∈ Aγ(a)
. The argument can also be
applied to γ−1 and therefore:

Let γ be any matrix in SL2(Z) and x an irrational number in Aa

τ

γ(Aa

τ) = Aγ(a)

τ

.

(27)

Note that the normality of Γ implies that γ(a) is again a cusp for the same
group.

29

Ht(cid:0)ϕ(Ω)(cid:1) ≤ CtHt(Ω).

For any Lipschitz function ϕ with Lipschitz constant C and any set Ω

we have

(28)
This follows from the deﬁnition of Hausdorﬀ outer measure. We want to
apply this to prove that all the sets Aa
τ have roughly the same size when a
ranges through the cusps of Γ, but the Möbius transformation γ is not
Lipschitz in any neighborhood of its pole. This problem has a simple
workaround. Let m be the width of the cusp ∞ and I any interval of
length m not containing the pole of γ, and whose image J = γ(I) is also of
length m. Then from (27) we have

Applying (28),

τ ∩ I) = Aγ(a)
γ(Aa
τ
τ + m = Aa
Aa
τ .

∩ J

Ht(Aγ(a)

τ

) (cid:28) Ht(Aa
τ).

The opposite inequality is also true and hence the Hausdorﬀ dimension of
τ must be independent of a. Since we also know by theorem 21
the set Aa
τ must have

that Aτ =S
The very same argument applied toT

τ has dimension 2/τ, we conclude that all the Aa

exactly that dimension.

τ0 instead of Aa

τ yields

τ0<τ Aa

a Aa

(cid:18) \

τ0<τ

(cid:19)

Aa
τ0

.

H2/τ

Aγ(a)
τ0

(cid:18) \
(cid:19)
τ0 = \
We claim the following is true:[
\
From (29) and (30) we must have H2/τ(cid:0)T

τ0<τ

τ0<τ

Aa

(cid:28) H2/τ

τ0<τ

a

Aτ0.

(30)

τ0(cid:1) > 0, since otherwise we

τ0<τ Aa

would contradict the second statement of theorem 21.

We prove (30) now. The inclusion ⊂ follows from Aa
τ ⊂ Aτ. For the
opposite inclusion suppose x pertains to the set of the right hand side, i.e.,
that for every τ0 < τ there is a constant Cτ0 > 0 such that

(29)

(31)

(cid:12)(cid:12)(cid:12)(cid:12)x − p
τ0<τ Ξτ0 and, therefore, x ∈T

q

b ∈T

(cid:12)(cid:12)(cid:12)(cid:12) ≤ Cτ0

qτ0

τ0.
τ0<τ Ab

30

is satisﬁed for inﬁnitely many rationals p/q. Let Ξτ0 be the set of the cusps
a for which (31) is satisﬁed for inﬁnitely many rationals p/q ∈ a. This set is
ﬁnite, nonempty and decreases with τ0. This implies that there exists some

Corollary 23. Let 2 ≤ τ ≤ +∞. The Hausdorﬀ dimension of the set
{x : τx = τ} is 2/τ.

For the deﬁnition of τx see (6).

Proof. Assume τ > 2 and let Ξ be the set of all the cusps at which f is not
cuspidal. We have the identity

{x : τx = τ} = \

[

τ0\ [

Aa

[

τ0<τ

a∈Ξ

τ0>τ

a∈Ξ

Aa

τ0.

By theorem 22 the set on the right hand side has Hausdorﬀ dimension at
most 2/τ. On the other hand from the same theorem one deduces that for
τ < +∞ we have

(cid:18) \

[

τ0<τ

a∈Ξ

H2/τ

(cid:19)

Aa
τ0

> 0,

H2/τ

Aa
τ0

= 0.

(cid:19)

(cid:18) [

[

τ0>τ

a∈Ξ

This implies the other inequality for the Hausdorﬀ dimension.

The case τ = 2 follows from the fact that τx ≥ 2 for every irrational

number x (cf. [20]).
Proof of theorem 6. The set {x : β(x) = δ} is completely determined by
theorems 2 and 3.
Its Hausdorﬀ dimension in the case of cuspidal f is
immediate, while if f is noncuspidal it follows from corollary 23.

8 Riemann’s example
In this section we employ the developed machinery to explain some aspects of
the graph of Riemann’s example (1), plotted in ﬁgure 1. A similar but more
detailed exposition is given by Duistermaat in [7]. Our analysis, however, is
readily applicable to any other modular form.
to Jacobi’s theta function θ(z) = P
Riemann’s example ϕ satisﬁes 2ϕ(x) = =θ1(x), where θ corresponds
n∈Z en2πiz. This is a modular form of
(cid:0) odd even
weight 1/2 for the group Γθ, consisting of all matrices in SL2(Z) of the form
even odd
all the rationals p/q with either p even and q odd, or p odd and q even. All
the remaining rationals (p/q with both p and q odd) constitute the Γθ-orbit
of 1. The modular form θ is cuspidal at 1 but not at 0 and the associated
multipliers µγ are always 8th roots of unity. The proofs of these statements
can be consulted in [7].

(cid:1). The Γθ-orbit of 0 corresponds to ∞ together will

(cid:1) or (cid:0) even odd

odd even

31

Note that the previous facts are enough to recover Hardy’s and Gerver’s
theorems and determine the Hölder exponents of ϕ at every point.
Its
spectrum of singularities, ﬁrst obtained by Jaﬀard in [17], also follows from
theorem 6.

Jacobi’s function θ is classically denoted ϑ3, as it has two companions

which are also modular forms of weight 1/2 for conjugated groups of Γθ:
(−1)nen2πiz.

and θ(z + 1) = ϑ4(z) = X

˜θ(z) = ϑ2(z) = X

e(n+ 1
2)2

πiz

n∈Z

n∈Z

The nomenclature ˜θ is not standard but we employ it here as a convenient
way to avoid problems with subscripts.
Given any matrix σ ∈ SL2(Z) the modular form θσ is either a multiple
of ϑ2 = ˜θ, ϑ3 = θ or ϑ4(z) = θ(z + 1), the constant being an 8th root of
unity (see theorem 7.1.2 of [21]). Since θσ is cuspidal at ∞ if and only if

θ(cid:0)σ(∞)(cid:1) = 0, one concludes that:

(

θσ(z) =

Cθ(z) or Cθ(z + 1)
C ˜θ(z)

if σ(∞) ∈ Γθ · 0
if σ(∞) ∈ Γθ · 1.

We now apply theorem 4 with α = 1, r = 1/2, to study the behavior of
2=θ1 in the neighborhood of a given rational point x0. The resulting

ϕ = 1
expansion around x0 is of the form:

(cid:21)

(cid:20)
(cid:21)
C0(x − x0)3/2f1(σ−1x + τ)

+ h(x).

ϕ(x) = =

C

x − x0

+ =

(cid:20)

√

The constant C is nonzero if and only if x0 ∈ Γ · 0, and in this case f = θ.
Otherwise f = ˜θ. The constant C0 is always nonzero, and both constants
have the argument of an 8th root of unity. Finally, τ is either 0 or 1.

Some deductions are immediate. The ﬁrst one being that ϕ has singular-
ities of square root type at every rational of the form odd/even or even/odd
(either at one side or both sides of the rational), while it is diﬀerentiable at
every rational of the the form odd/odd. The second one is that at either side
of any rational number ϕ mimics the graph of some periodic function =C0f1.
Note that as σ−1 has a simple pole at x0, this pattern repeats indeﬁnitely
towards the rational, with its amplitude decreasing as a 3/2 power of the
remaining distance and its frequency roughly proportional to |x− x0|−1. See
ﬁgure 2 for some examples of this behavior, where the square root singular-
ities are also clearly visible.
Since the argument of C0 is an integer multiple of π/4 we also deduce
that =C0f1 is either <f1, =f1 or <f1 + =f1, or the mirror image of one

32

Figure 2: Detail of ϕ near 1/2, 1/3 and 2/3, respectively.

33

0.30.40.50.60.70.50.60.70.80.911.11.20.310.320.330.340.350.360.50.550.60.650.70.640.650.660.670.680.6911.051.11.151.21.25of these functions, i.e., the result of performing the change of variables
x 7→ −x either in the domain, in the codomain or both. The situation is
even simpler when f = ˜θ, as all these functions are then translates of each
other (cf. theorem 7.1.2 of [21]). Hence the graph of =C0f1 corresponds, up
to symmetries, to one of the four genuinely distinct patterns that appear in
ﬁgure 3. Note that in ﬁgure 2 all four patterns appear.

Figure 3: Graphs of <θ1 (top-left), =θ1 (top-right), <θ1 +=θ1 (bottom-left)
and =˜θ1 (bottom-right).

The previous discussion shows that the graph of ϕ is a fractal in the sense
that a slightly deformed version of itself appears at the sides of some rational
numbers (for example on the left of 1/2, see ﬁgure 2). But it is also a fractal
in the sense that it exhibits approximate self-similarity around every rational
number, as can be seen from theorem 4 by choosing a parabolic matrix σ
in Γ ﬁxing a certain rational. The same argument can be employed to show
local self-similarity around quadratic surds, as each of these points is ﬁxed by
some hyperbolic transformation in Γθ (see [7] for details). We remark that
both statements are also true for any other ﬁnite index subgroup Γ of SL2(Z).
Indeed, if σ is parabolic (hyperbolic) and ﬁxes a certain point, then some
power σn lies in Γ, is also parabolic (hyperbolic) and ﬁxes the same point.

34

0.511.52-1-0.50.511.50.511.52-1-0.50.510.511.52-1.5-1-0.50.511.52468-4-2249 Cusp forms for Γ0(N)
Fix an arbitrary integer N ≥ 1 and let f be a cusp form of integer weight
r for the group Γ0(N) and trivial multiplier system. Note that r must
necessarily be even. For any α > r/2 the function fα is well-deﬁned and we
may consider g = <fα or =fα. Since the factor B|x−x0|2α−r in theorem 4 is
always positive, the analysis of §8 shows that the graph of g “repeats itself”
near rational points in the orbit Γ0(N) · ∞, in the sense that we should
expect oscillations of the form (x− x0)2α−rg(σ−1x) near these points. What
is less obvious is that this might also happen for other rationals not lying in
the orbit of ∞, for example if we are able to ﬁnd some matrix σ ∈ SL2(R)
with prescribed σ(∞) and for which the form f σ = f|σ equals Cf for some
real constant C. A particular case of this is shown in ﬁgure 4.
A good place to look for such a σ is in the normalizer of Γ0(N), as
this automatically implies that f|σ is also a modular form for the same
group and trivial multiplier system. In this section we give some suﬃcient
conditions that guarantee the existence of such σ for every rational number,
and study some particular cases where the pattern repeating around some
rational numbers bears little resemblance with the global graph of g.

Figure 4: Left: Plot of −<f9/5, where f is the newform on Γ0(14). Right:
detail of <f9/5 at 1/2. This rational is not in Γ0(14) · ∞, but the matrix
σ = ( 7 3

14 7 ) satisﬁes σ(∞) = 1/2 and f|σ = −f.
Some notation ﬁrst. For any two integers n and m we denote by (n, m) its
greatest common divisor, and for every prime p we denote by [n]p the largest
power of p dividing n. For every divisor Q | N satisfying (Q, N/Q) = 1 we
deﬁne the matrix

 

ωQ :=

!

y

Qx
N z Qw

,

x, y, z, w ∈ Z,

det ωQ = Q,

35

0.20.40.60.81-1-0.50.510.460.480.50.520.54-1-0.95-0.9-0.85which is unique up to left and right multiplication by elements of Γ0(N). The
Q ∈ Γ0(N)
matrices ωQ are called Atkin-Lehner involutions and satisfy Q−1ω2
and ωQωQ0 = some ωQQ0 whenever (Q, Q0) = 1. For the sake of clarity we
also set ωp := ω[N]p for each prime p | N. Finally for any integer n > 0 we
consider the matrix

 1 1/n
!

,

1
which corresponds to a translation by 1/n.

0

Sn :=

A theorem of Atkin and Lehner stated without proof in [2] assures that
when N is not divisible by 4 nor 9 the normalizer of Γ0(N) is generated by
Γ0(N) and the Atkin-Lehner involutions ωp for primes p | N. When N is
divisible by 4 or by 9 one has to include some extra generators: S2 if [N]2 = 4
or 8, S4 if [N]2 = 16 or 32 and S8 if 64 | N; and S3 if 9 | N. Note that
we are thinking of the normalizer of Γ0(N) as a group of linear fractional
transformations, as otherwise one also needs to include any real multiple
of the previous generators. This theorem also provides the structure of the
quotient between these two groups (which we do not need), although this
part seems to have some mistakes and a corrected version is proved by Bars
in [3].

Asai observed in [1] that the Atkin-Lehner involutions act transitively on
Q if and only if N is square-free. The following proposition is a generalization
of this fact.
Proposition 24. The normalizer of Γ0(N) acts transitively on Q if and
only if N = 2a3bN0 for some a < 8, b < 4 and a square-free integer N0 not
divisible by 2 nor by 3.
Proof. Assume ﬁrst that N is of the prescribed form. We begin by proving
that every rational u/v is related by the Atkin-Lehner involutions to some
| v0. All the integers u, u0, . . . and v, v0, . . .
other rational u0/v0 with N0
involved are assumed to satisfy (u, v) = 1, (u0, v0) = 1, etc.
Write N0 = p1 ··· pn for distinct primes p1, . . . , pn. We may assume upon
reordering of the pi that p1 ··· pm | v and pi (cid:45) v for m < i ≤ n. Choosing
Q = 2a3bpm+1 ··· pn we have

u0/v0 = ωQ(u/v) =

N

(cid:16)

Qxu + yv
zu + w v
N/Q

(cid:17) .

The numerator of the right hand side is not divisible by any of the pi as
a consequence of the determinant condition imposed on ωQ and therefore
N0 | v0.

36

Next we prove that the rational u0/v0 is related to some u00/v00 with 2aN0 |
v00. In order to do this we employ ω2 and the translations S2, S4 or S8 that lie
in the normalizer. It is easy to check that all these transformations preserve
(v0, 3aN0) and therefore they may be applied in any order without worrying
about the condition N0 | v00. Let 2s = [v0]2 and assume that s < a, since
otherwise we are ﬁnished. It is also easy to check that if u00/v00 = ω2(u0/v0)
then [v00]2 = 2a−s. This means that applying ω2 if necessary we may assume
s ≤ [a/2]. We now apply repeatedly S2, S4 or S8 to arrive to a rational with
s = 0, and the image of this rational by ω2 satisﬁes s ≥ a.
The same argument can now be applied mutatis mutandis to relate the
rational u00/v00 to some u000/v000 with N | v000, i.e., lying in the orbit Γ0(N)·∞.
This ﬁnishes the proof of the direct implication.

To prove that the normalizer action is not transitive when N is not of the
prescribed form it suﬃces to show a subset of Q invariant under this action.
Suppose ﬁrst that for some prime p 6= 2, 3 we have p2 | N and pc = [N]p.
Then one such set is that of the rational numbers u/v with [v]p = ps with
0 < s < c. The invariance of this set follows from the following facts:
the translations and the Atkin-Lehner involutions ωQ with p (cid:45) Q leave [v]p
invariant, while [v0]p = pc−s for u0/v0 = ωQ(u/v) with p | Q.
The remaining cases are 28 | N or 34 | N. If 28 | N then a ≥ 8 and one
such set is that of the rational numbers u/v with [v]2 = 2a/2 if a is even
and [v]2 = 2[a/2] or [v]2 = 2[a/2]+1 if a is odd. An analogous set works when
34 | N.

Suppose now that f is a newform. Atkin and Lehner proved in [2] that
f|ωp = ±f for every prime p | N. In the same paper they also prove that
when 4 | N all the even coeﬃcients of f vanish, and therefore f|S2 = −f.
For the rest of translations considered above (S4, S8 and S3), however, it is
not generally true that f|Sn = Cf for some real constant C, not even when
Sn belongs to the normalizer of Γ0(N). In fact f|Sn might not be a newform
at all, as it is shown below. These translations are necessary to make the
action of the normalizer transitive on Q when 24 | N or 9 | N (cf. proof of
proposition 24), and therefore chances are that there will be some rationals
p/q for which no matrix σ satisﬁes σ(∞) = p/q and f|σ = Cf.

There is an exception to this: when the space of cuspidal forms has
dimension 1 (i.e. there are no oldforms and every cusp form is a multiple
of f).
In this case all the matrices in the normalizer of Γ0(N) commute
under the slash operator, and therefore if η is any of these matrices we must
have f|η = f|ωQS = ±f|S for some Q | N and some translation S. Note
that as long as the action of the normalizer on Q is transitive we are free to

37

Figure 5: Plot of =f7/4 where f is the newform on Γ0(45).

choose η(∞). The matrix σ = ηS−1 now lies in the normalizer and satisﬁes
σ(∞) = η(∞) and f|σ = ±f.
We conclude that the graph of <fα or =fα repeats itself around every
rational number as long as N = 2aN0 with a < 4 and N0 odd and square-
free, or if the space of cusp forms on Γ0(N) has dimension 1 and N = 2a3bN0
with a < 8, b < 4 and N0 square-free and not divisible by 2 nor 3.

We now give some examples for which a diﬀerent pattern appears around
some rational numbers. These are of weight 2 and therefore associated
to elliptic curves over Q (cf. §1). By direct examination of the table of
newforms found at [19] we see that the lowest value of N for which neither
of the previous conditions is satisﬁed is N = 45, as the associated space of
cusp forms happens to be of dimension 3, containing an oldclass generated
by the newform on Γ0(15). Denote by f the newform on Γ0(45) and by g the
one on Γ0(15). These correspond to the isogeny classes of the elliptic curves

y2 + xy = x3 − x2 − 5

and

y2 + xy + y = x3 + x2,

respectively. The matrix σ = S3ω45, where ω45 is the Atkin-Lehner involu-
tion determined by x = w = 0, y = 1 and z = −1, lies in the normalizer of

38

0.20.40.60.81-1-0.50.51Figure 6: Left: Detail of =f7/4 around 1/3 where f is the newform on Γ0(45).
Right: Graph of the imaginary part of the right hand side of (32).

Γ0(45) and sends ∞ to 1/3. The function f|σ is therefore again a modular
form for Γ0(45), and in fact it has the following decomposition:

f|σ(z) = 1

2 f(z) − i

1
√
2

3 g(z) − i

3

√
3
2 g(3z).

α(x) = 1
f σ

To obtain the coeﬃcients one ﬁrst decomposes f|S3 by directly comparing
coeﬃcients, and then applies |ω45. The Atkin-Lehner eigenvalues are tab-
ulated in [19], and the action of this operator on oldforms is described by
lemma 26 of [2]. As an immediate consequence
3 gα(x) −

(32)
In ﬁgure 5 we have plotted =f7/4, while in ﬁgure 6 the reader can compare
the imaginary part of the right hand side of (32) for α = 7/4 with the
pattern that repeats near σ(∞) = 1/3 for =f7/4.
The lowest value of N for which the normalizer is not transitive on Q
and there is some nonzero newform is N = 49. This newform is associated
to the isogeny class of the curve

√
2 fα(x) − i
2

i

2 · 3α−3/2 gα(3x).

y2 + xy = x3 − x2 − 2x − 1.

The cusp 1/7 is not related to ∞, not even by the normalizer, and in ﬁgure 7
the reader can appreciate that the global graph and the pattern appearing
around this point have a diﬀerent aspect.

To ﬁnish this section we note that although Jacobi’s theta function θ
was presented in §8 as modular for the group Γθ, the closely related func-
tion θ(2z) is a modular form for Γ0(4). The normalizer of Γ0(4) does act

39

0.3150.320.3250.330.3350.340.3450.350.550.60.650.20.40.60.81-0.6-0.4-0.20.20.40.60.8Figure 7: Left: Plot of <f7/4 where f is the newform on Γ0(49). Right:
Detail around 1/7.

transitively on Q. The reason four possible patterns can appear around
rational points is that in this case the multiplier system is not trivial, and
therefore it might change when one applies the slash operator |σ.

Acknowledgments
The author is indebted to Fernando Chamizo for his encouragement and
suggestions during the elaboration of this article. This work has been sup-
ported by the ”la Caixa”-Severo Ochoa international PhD programme at
the Instituto de Ciencias Matemáticas (CSIC-UAM-UC3M-UCM).

The graphics included in the article have been plotted using Sage, and
the same software system has been used to compute the Fourier coeﬃcients
of newforms. The partial sums were calculated using simple C++ programs.

References
[1] T. Asai. On the Fourier coeﬃcients of automorphic forms at various
cusps and some applications to Rankin’s convolution. J. Math. Soc.
Japan, 28(1):48–60, 1976.

[2] A. O. L. Atkin, J. Lehner. Hecke operators on Γ0(m). Math. Ann.,

185:134–160, 1970.

[3] F. Bars. The

group structure of

arXiv:math/0701636v1.

the normalizer of Γ0(N).

40

0.20.40.60.81-0.50.510.1250.130.1350.140.1450.150.1550.160.450.50.550.60.650.7[4] P. I. Butzer, E. I. Stark. “Riemann’s example” of a continous nondif-
ferentiable function in the light of two letters (1865) of Christoﬀel to
Prym. Bull. Soc. Math. Belg., 38:45–73, 1986.

[5] F. Chamizo. Automorphic Forms and Diﬀerentiability Properties.

Trans. Amer. Math. Soc., 356(5):1909–1935 (electronic), 2004.

[6] F. Chamizo, I. Petrykiewicz, S. Ruiz-Cabello. The Hölder exponent of

some Fourier series. arXiv:1504.04998v1, 2015. Preprint.

[7] J. J. Duistermaat. Selfsimilarity of “Riemann’s Nondiﬀerentiable Func-

tion”. Nieuw Arch. Wisk., 9(3):303–337, 1991.

[8] M. Eichler. Eine Verallgemeinerung der Abelschen Integrale. Math. Z.

67:267–298, 1957.

[9] K. Falconer. Fractal geometry. John Wiley and sons, 2003.
[10] J. R. Ford. Fractions. Amer. Math. Monthly, 45(9):586–601, 1938.
[11] J. Gerver. The diﬀerentiability of the Riemann function at certain ra-

tional multiples of π. Amer. J. Math., 92:33–55, 1970.

[12] J. Gerver. More on the diﬀerentiability of the Riemann function. Am.

J. Math., 93(1):33–41, 1971.

[13] G. H. Hardy. Weierstrass’s nondiﬀerentiable function. Trans. Amer.

Math. Soc., 17(3):301–325, 1916.

[14] M. Holschneider, Ph. Tchamitchian. Pointwise analysis of Riemann’s

“nondiﬀerentiable” function. Invent. Math., 105(1):157–175, 1991.

[15] R. Iorio, V. Iorio. Fourier Analysis and Partial Diﬀerential Equations.
Vol. 70 of Cambridge Stud. Adv. Math.. Cambridge Univ. Press, 2001.
[16] H. Iwaniec. Topics in Classical Automorphic Forms. Vol. 17 of Graduate

Studies in Mathematics, Amer. Math. Soc., 1997.

[17] S. Jaﬀard. The spectrum of singularities of Riemann’s function. Rev.

Mat. Iberoamericana, 12(2):441–460, 1996.

[18] S. Jaﬀard. Local behaviour of Riemann’s function. In Harmonic analysis
and operator theory (Caracas, 1994), vol. 189 of Contemp. Math., pp
287–307. Amer. Math. Soc, 1995.

[19] The LMFDB Collaboration. The L-functions and Modular Forms
Database. http://www.lmfdb.org, 2013. [Online; accessed 4 March
2016].

[20] S. J. Patterson. Diophantine approximation in Fuchsian groups. Phil.

Trans. R. Soc. Lond. A, 262:527–563, 1976.

[21] R. A. Rankin. Modular forms and functions. Cambridge Univ. Press,

1977.

41

[22] S. Seuret, J. L. Véhel. The local Hölder function of a continuous func-

tion. Appl. Comput. Harmon. Anal., 13(3):263–276, 2002.

[23] S. L. Velani. Diophantine approximation and Hausdorﬀ dimension in

Fuchsian groups. Math. Proc. Cam. Phil. Soc., 113:343–354, 1993.

[24] K. Weierstrass. Über continuierliche Functionen eines reellen Argu-
ments, die für keinen Werth des letzteren einen bestimmten diﬀeren-
tialquotienten besitzen. In Mathematische Werke II, pp 71-74. Königl.
Akad. Wiss., 1872.

[25] E. T. Whittaker, G. N. Watson. A course in modern analysis. Cam-

bridge Univ. Press, 1915.

[26] A. Zygmund. Trigonometric series. Vol I, II. Cambridge Univ. Press,

2002.

42

