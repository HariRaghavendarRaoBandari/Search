6
1
0
2

 
r
a

M
7

 

 
 
]

.

M
Q
o
i
b
-
q
[
 
 

1
v
6
6
2
2
0

.

3
0
6
1
:
v
i
X
r
a

Compartmental analysis of dynamic nuclear
medicine data: models and identiﬁability

Fabrice Delbary1, Sara Garbarino2 and Valentina Vivaldi2
1 Institut f¨ur Mathematik, Johannes Gutenberg-Universit¨at Mainz
2 Dipartimento di Matematica and CNR-SPIN, Genova

Abstract. Compartmental models based on tracer mass balance are extensively used
in clinical and pre-clinical nuclear medicine in order to obtain quantitative information
on tracer metabolism in the biological tissue. This paper is the ﬁrst of a series of two
that deal with the problem of tracer coeﬃcient estimation via compartmental modeling
in an inverse problem framework. Speciﬁcally, here we discuss the identiﬁability
problem for a general n-dimension compartmental system and provide uniqueness
results in the case of two-compartment and three-compartment catenary models. The
second paper will utilize this framework in order to show how non-linear regularization
schemes can be applied to obtain numerical estimates of the tracer coeﬃcients in the
case of nuclear medicine data corresponding to brain, liver and kidney physiology.

1. Introduction

functional

Nuclear medicine imaging is a class of
imaging modality that utilizes
radioactive tracers to investigate speciﬁc physiological processes. Such tracers are
in general short-lived isotopes that are injected in the subject’s blood and linked to
chemical compounds whose metabolism is highly signiﬁcant to understand the function
or malfunction of an organ. Positron Emission Tomography (PET) [18] is the most
modern nuclear medicine technique, utilizing isotopes produced in a cyclotron and
providing dynamical images of its metabolism-based accumulation in the tissues. While
decaying, the isotope emits positrons that annihilates with the electrons of the tissue
thus emitting two collimated gamma rays. These rays are detected by the PET
collimators to provide a rather precise indication of their temporal and spatial origin.
Applications of PET in the clinical workﬂow depend on the kind of tracer employed
and on the kind of metabolism that such tracer is able to involve. For example, in
oncological applications, [18F ]FDG [1, 4, 14] and F M ISO [25] are the most commonly
used tracers; neuroimaging studies of Alzheimer desease utilizes 11C and 15O [26], while
myocardium perfusion analysis considers 82Rb and again [18F ]FDG as the most accurate
tracers [2].

From a computational viewpoint, PET experiments involve two kinds of inverse
problems. In the ﬁrst one, image reconstruction techniques are applied to reconstruct
the spatio-temporal location of tracer concentration from the radioactivity measured

Compartmental analysis identiﬁability

2

by the detectors [17, 12, 24]. The second problem utilizes these reconstructed dynamic
PET data to estimate physiological parameters that describe the functional behavior of
the inspected tissues and therefore the ﬂow of tracer between their diﬀerent constitutes.
The present paper is the ﬁrst one of a series of two that focus on this second problem
for PET data analysis and that aim to describe it in an ill-posed inverse problems
framework.

Models in pharmacokinetics [22, 23] typically assume that in the organ under
investigation there co-exist functionally separated pools of tracer, named compartments,
that can exchange tracer between each other. With the help of the global observation
of the organ along time provided by reconstructed PET images, compartmental analysis
[5, 6, 7, 8, 9, 10] aims at retrieving information on the radioactive tracer exchange
rates between compartments. From a mathematical viewpoint, the time dependent
concentrations of tracer in each compartment constitutes the state variables that can
be determined from PET data and the time evolution of the state variables can be
modeled by a system of diﬀerential equations for the concentrations, expressing the
principle of tracer balance during exchange processes. Assuming that the exchange
rates are time independent, the mathematical model for the compartmental problem
becomes a linear system of Ordinary Diﬀerential Equations (ODEs) with constant
coeﬃcients. This paper describes the analytical properties of this forward problem
in the case of the general n-compartment system and in the more speciﬁc (but highly
realistic) cases of the two-compartment and three-compartment catenary systems. For
all these compartmental problems, the constant coeﬃcients describe the input/output
rate of tracer for each compartment and represent the physiological parameters assessing
the system’s metabolism. Therefore such coeﬃcients are the unknowns to be estimated
in compartmental analysis inverse problem. We provide the ﬁrst general discussion of
uniqueness for this inverse problem by proving some identiﬁability results in the case of
the two-compartment and three-compartment catenary models. In a future paper we
will provide a general scheme for the numerical solution of these inverse problems and
apply it against both synthetic data and experimental measurements acquired by means
of a PET system for small animals.

The plan of the present paper is as follows. Section 2 will introduce the formalism for
the most general n-th compartment model and for its specialization to the catenary case.
Section 3 and Section 4 will provide the identiﬁability results for the two-compartment
and three-compartment catenary models. Our conclusions will be oﬀered in Section 5.

Compartmental analysis identiﬁability

2. The n-compartment systems

3

Figure 1. n-compartment system

We ﬁrst consider the very general n-compartment model depicted in Figure 1. In
all nuclear medicine modalities, the tracer injected into the body may assume diﬀerent
metabolic status. Since the spatial resolution provided by these imaging modalities is
not suﬃcient to anatomically distinguish these diﬀerent status, they are modeled as
compartments, each one just playing a functional role that describes a speciﬁc tracer
metabolic condition. We denote with Cp the non-negative concentration function of the

tracer in the compartment p ∈(cid:74)1, n(cid:75). We also assume that the compartment p receives

the radioactive tracer from outside the compartmental system with a concentration
function Cpe and at a constant non-negative rate kpe and excretes the tracer from inside
at a constant non-negative rate kep. Further, the constant non-negative rate at which the
compartment p receives the tracer from a compartment q (cid:54)= p is denoted with kpq and,
ﬁnally, all input concentration functions (Cpe)p∈(cid:74)1,n(cid:75) are supposed to be non-negative

and continuous. Then the evolution of the tracer concentrations in each compartment
is governed by the following linear system of Ordinary Diﬀerential Equations (ODE)
with constant coeﬃcients

n(cid:88)

q=1

˙Cp =

kpqCq + kpeCpe,

with the initial conditions

p ∈(cid:74)1, n(cid:75),
where, for p ∈ (cid:74)1, n(cid:75), kpp = −(cid:16)(cid:80)

Cp(0) = 0,

implied. That is

p ∈(cid:74)1, n(cid:75),
(cid:17)

q(cid:54)=p kqp + kep

. Dependence on t is omitted but

(1)

˙C = M C + W,

C(0) = 0,

(2)

Compartmental analysis identiﬁability

where

C =

 ,

 C1

...
Cn

and the matrix M is given by

Mpq = kpq,

W =

 k1eC1e
p, q ∈(cid:74)1, n(cid:75).

kneCne

...

 ,

4

(3)

(4)

PET-scan images allow one to know the total amount of radioactive tracer in the tissue
or organ of interest, which is modeled by the compartmental system; each compartment
contributes to the intensity of the PET image linearly with respect to the amount of
tracer in the compartment. Hence, in practice, PET-scan data give access to ˜C such
that the measurements and the model are related by the functional equation

˜C(t) = αT C(t),

t ∈ R+,

(5)

where α ∈ R∗
problem is the one of recovering the exchange rates K ∈ Rn2+n, where

n is a known constant vector. Thus, the general n-compartmental inverse

+



K =

kep,
kp−n(cid:98) p−1
k(p−n2)e

n (cid:99),1+(cid:98) p−1
n (cid:99),

p ∈(cid:74)1, n2(cid:75), p ≡ 1 (mod n + 1),
p ∈(cid:74)1, n2(cid:75), p (cid:54)≡ 1 (mod n + 1),
p ∈(cid:74)n2 + 1, n2 + n(cid:75),

using measurements of ˜C.

2.1. Properties of n-compartment systems

In this subsection, we propose to recall some properties of n-compartment systems which
will be useful for our study of two particular cases. In the following of the document,
for a positive integer n and K ∈ Rn2+n, we denote by ˆK ∈ Rn2 the ﬁrst n2 components
of K and ˇK ∈ Rn the last n components of K. For a positive integer n, we denote by
M the following linear operator

where for all H ∈ Rn2

M : Rn2 → Mn(R)
H (cid:55)→ M(H),

−H1+(n+1)(p−1) − n(cid:88)

M(H)pq =



Hp+n(p(cid:48)−1),

p(cid:48) = 1
p(cid:48) (cid:54)= p

p, q ∈(cid:74)1, n(cid:75), p = q,
p, q ∈(cid:74)1, n(cid:75), p (cid:54)= q,

Hp+n(q−1),
so that for all H ∈ Rn2
of all, for general n-compartment systems, we have the following theorem [11]

+ , M(H) is the matrix deﬁned in (4) for the parameters H. First

(6)

Compartmental analysis identiﬁability
Theorem 2.1. Consider H ∈ Rn2
+ . Then the eigenvalues of the matrix M = M(H) as
deﬁned in (6) have a non-positive real part and if an eigenvalue has a zero real part,
then the eigenvalue is 0, moreover, dim(ker(M )) = m0 where m0 is the multiplicity of
0. In addition, the solution C to

5

C(0) = C0,

˙C = M C + W,
+ and W : R+ → Rn

+, veriﬁes Cp(t) ≥ 0 for all p ∈(cid:74)1, n(cid:75) and t ∈ R+.

where C0 ∈ Rn
Remark 2.2. As remarked in [11], physically, it is conservation of mass applied to the
system (7) where W = 0, which insures that the eigenvalues of M have a non-positive
real part and that the multiplicity of the eigenvalue 0 is the dimension of the nullspace
of M (the solutions are bounded) and that the only possible eigenvalue with a zero real
part is 0 (if any oscillations occur, they are damped). The positiveness of C is simply
the fact that the concentrations are positive quantities.

(7)

Some additional properties on the system matrix M lead to more restrictions on

its eigenvalues. In particular, we have [11]
Theorem 2.3. Consider H ∈ Rn2

then 0 is an eigenvalue of M if and only if kep = 0 for p ∈(cid:74)1, n(cid:75), where for p ∈(cid:74)1, n(cid:75),

+ and denote by M = M(H). If M is irreducible,

+ , denote by M = M(H) and suppose that there exist

n such that for all p, q ∈(cid:74)1, n(cid:75), p (cid:54)= q

kep = H1+(n+1)(p−1) (no excretion). In other terms, 0 is an eigenvalue of M if and only
if the n-compartment system of exchange rates H ∈ Rn2
+ and without input is closed.
Moreover, in that case, 0 is a simple eigenvalue.
Theorem 2.4. Consider H ∈ Rn2
(ap)p∈(cid:74)1,n(cid:75) in R∗
where for all p, q ∈ (cid:74)1, n(cid:75), p (cid:54)= q, kpq = Hp+n(q−1), then M is diagonalizable and its
the excretion rates kep = H1+(n+1)(p−1) for p ∈(cid:74)1, n(cid:75).
balance for the n-compartment closed system of exchange rates (kpq)p,q∈(cid:74)1,n(cid:75),p(cid:54)=q.

eigenvalues are real and non-positive. Note that the condition (8) does not depend on

Remark 2.5. Again, as remarked in [11], the equation (8) is the principle of detailed

(8)

+

kpqaq = kqpap,

The theorem 2.4 applies in particular to sign-symmetric systems with no cycle as
the catenary compartmental system we will use in the following. We end this subsection
recalling a result on the multiplicity of the eigenvalues of the matrix of a n-compartment
system [19]

Theorem 2.6. Consider a sign-symmetric cycle-free connected n-compartment system.
Then an eigenvalue λ of the system matrix M is multiple if and only if there exists a
compartment p, directly connected to at least three other compartments p1, p2, p3, such
that λ is an eigenvalue of the matrices N1, N2, N3 of the respective connected subsystems
containing p1, p2, p3 and not p.

Compartmental analysis identiﬁability

2.2. The n-compartment catenary case

6

Figure 2. n-compartment catenary system

A n-compartment catenary system is composed of n compartments such that

kep ≥ 0,
kpq > 0,
kpq = 0,
kpe ≥ 0,

p ∈(cid:74)1, n(cid:75),
p, q ∈(cid:74)1, n(cid:75),|p − q| = 1,
p, q ∈(cid:74)1, n(cid:75),|p − q| > 1,
p ∈(cid:74)1, n(cid:75).

According to the theorems 2.1, 2.3, 2.4, 2.6 of the previous subsection 2.1, we have the
following theorem

Theorem 2.7. The matrix M of a n-compartment catenary system is diagonalizable
and its eigenvalues are real, non-positive and simple. Moreover, 0 is an eigenvalue of

M if and only if the system with no input is closed, that is kep = 0 for all p ∈(cid:74)1, n(cid:75).

2.3. Identiﬁability deﬁnition

We now recall the deﬁnition of identiﬁability [5, 16]. In order to introduce it, we need
to denote by W the following linear operator

W : C 0(R+, R)n → L(Rn, C 0(R+, R)n)

ˇC (cid:55)→ W( ˇC),

where for all ˇC ∈ C 0(R+, R)n, H ∈ Rn and p ∈ (cid:74)1, n(cid:75), [W( ˇC)(H)]p = Hp
ˇCp, so that
for all vector of input concentrations functions ˇC = (Cpe)p∈(cid:74)1,n(cid:75) ∈ C 0(R+, R+)n and
H ∈ Rn
+, W( ˇC)(H) is the vector deﬁned in (3) for the input concentrations functions ˇC
and the parameters H. We denote by C the following function

C : C 0(R+, R)n → L(Rn2+n, C 1(R+, R)n)

ˇC (cid:55)→ C( ˇC),

where for all ˇC ∈ C 0(R+, R)n and K ∈ Rn2+n, C = C( ˇC)(K) ∈ C 1(R+, R)n is the
unique solution to

˙C = M C + W,

C(0) = 0,

Compartmental analysis identiﬁability
where M = M( ˆK) and W = W( ˇC)( ˇK). For α ∈ R∗

Cα : C 0(R+, R)n → L(Rn2+n, C 1(R+, R))

ˇC (cid:55)→ (cid:2)K (cid:55)→ αT (C( ˇC)(K))(cid:3) .

+

n, Cα is the function deﬁned by

7

Consider a positive integer n, input concentration functions ˇC ∈ C 0(R+, R+)n, α ∈ R∗
n
+
and a subset Ω of Rn2+n
of admissible exchange rates K. Denote by ˜C = Cα( ˇC) and by
˜CΩ the restriction of ˜C to Ω.

+

Deﬁnition 2.8.
(i) The model of equations (2)-(5) is said globally identiﬁable at K ∈ Ω,

if

Ω ({ ˜C(K)}) = {K}.
˜C−1

(ii) The model of equation (2)-(5) is said locally identiﬁable at K ∈ Ω if there exists
Ω,K,({ ˜C(K)}) = {K} where ˜CΩ,K, denotes the restriction of ˜CΩ

 > 0 such that ˜C−1
to the open ball BK, of Ω, with center K and radius .

(iii) The model of equation (2)-(5) is said structurally globally identiﬁable if it is globally

identiﬁable at all K ∈ Ω.

(iv) The model of equation (2)-(5) is said structurally locally identiﬁable if it is locally

identiﬁable at all K ∈ Ω.
When we have a general n-compartment compartmental model,

(cid:110)
r ∈ R :(cid:82) +∞

e−rtCpe(t) dt < +∞(cid:111)

it is hard to
ﬁnd a precise characterization of identiﬁability, but we can say some weak things,
leading, in particular cases, to a more precise identiﬁability results. In the following

of the document, we consider n-compartment systems where for p ∈ (cid:74)1, n(cid:75), the input
concentration functions Cpe from R+ to R+ are Laplace-transformable. For p ∈(cid:74)1, n(cid:75),
so that they are Laplace-transformable and for p ∈ (cid:74)1, n(cid:75), rpe ≤ 0. The Laplace
functions ˇC = (Cpe)p∈(cid:74)1,n(cid:75) ∈ C 0(R+, R+)n, α ∈ R∗
Then, for α ∈ R∗
convergence r veriﬁes

will denote the abscissa of convergence of
rpe = inf
Cpe. Note that in practical applications, the input concentration functions are bounded
transform will be denoted by L and for r ∈ R, we denote by Cr = {z ∈ C : (cid:60)e(z) > r}.
Lemma 2.9. Consider a positive integer n, Laplace-transformable input concentration
n and exchange rates K ∈ Rn2+n
.
n, ˜C = Cα( ˇC)(K) is Laplace-transformable and its abscissa of

+

+

0

+

(9)

where

r ≤ rm = max ({re

m} ∪ sp(M )) ,
m = max ({rpe : p ∈(cid:74)1, n(cid:75)}) ,

re

n(cid:88)

p=1

L ˜C(z) =

αpkpe

Qp(z)
P (z)

LCpe(z),

(10)
and sp(M ) denotes the spectrum of the matrix M = M( ˆK). Moreover for all z ∈ Crm,
we have

Compartmental analysis identiﬁability

8

where the unitary polynomial P of degree n is the characteristic polynomial of M and

for p ∈(cid:74)1, n(cid:75), Qp is a unitary polynomial of degree n − 1 given by

Qp(z) =

αT adj(zIn − M )ep

,

αp

where adj(zIn − M ) denotes the adjugate matrix of zIn − M .
Proof. The ﬁrst statement of the lemma is obvious. In addition, since C = C( ˇC)(K)
veriﬁes (2), for all z ∈ Crm, we have

L ˜C(z) =

kpeαT (zIn − M )−1ep LCpe(z).

Since

p=1

(zIn − M )−1 =

adj(zIn − M )
det(zIn − M )

=

adj(zIn − M )

P (z)

,

where P is the characteristic polynomial of M , we have
LCpe(z).

αT adj(zIn − M )ep

L ˜C(z) =

kpe

P (z)

n(cid:88)

n(cid:88)

p=1

Moreover, it can be easily remarked that the only cofactors of zIn − M of degree n − 1
in z are the diagonal cofactors and that the coeﬃcient of the monomial zn−1 in these

cofactors is 1, so that for all p ∈ (cid:74)1, n(cid:75), the polynomial αT adj(zIn − M )ep in z is of

degree n − 1 and its leading coeﬃcient is αp.

and for α ∈ R∗

+

For a positive integer n, we denote by P the function

P : Rn2 → R[X]

H (cid:55)→ det(XIn − M(H)),
n, we denote by Qα the function
Qα : Rn2 → R[X]n

(cid:18) αT adj(XIn − M(H))ep

H (cid:55)→

αp

(cid:19)
p∈(cid:74)1,n(cid:75) .

For r ∈ R, we denote by M(Cr) the ﬁeld of meromorphic functions on Cr and by
R(X) the ﬁeld of rational fractions in the indeterminate X with coeﬃcients in R. In
the following, for r ∈ R, M(Cr) will be regarded as a vector space over R(X). As an
immediate consequence of lemma 2.9, we have

Corollary 2.10. Consider a positive integer n and Laplace-transformable input

concentration functions ˇC = (Cpe)p∈(cid:74)1,n(cid:75) ∈ C 0(R+, R+)n such that Cpe = 0 for
p ∈ (cid:74)1, n(cid:75) \ {p(cid:96) : (cid:96) ∈ (cid:74)1, k(cid:75)}, where k ≥ 1 and (p(cid:96))(cid:96)∈(cid:74)1,k(cid:75) are k distinct elements of
(cid:74)1, n(cid:75). We recall that for exchange rates K ∈ Rn2+n
of K, that is, for p ∈(cid:74)1, n(cid:75), ˇKp = kpe. Consider α ∈ R∗
If the functions (LCp(cid:96)e)(cid:96)∈(cid:74)1,k(cid:75) of M(Cre
is deﬁned by (10), then for K ∈ Rn2+n

, ˇK denotes the last n components
n and denote by ˜C = Cα( ˇC).
m) are linearly independent over R(X), where re
, the exchange rates ( ˇKp(cid:96)e)(cid:96)∈(cid:74)1,k(cid:75) are uniquely

m

+

+

+

Compartmental analysis identiﬁability
determined by the function ˜C(K), that is, for all K(cid:48) ∈ Rn2+n
only if ˇKp(cid:96)e = ˇK(cid:48)

only if the previous condition holds and for all (cid:96) ∈(cid:74)1, k(cid:75)

p(cid:96)e for all (cid:96) ∈ (cid:74)1, k(cid:75). More precisely, we have ˜C(K(cid:48)) = ˜C(K) if and

9
, we have ˜C(K(cid:48)) = ˜C(K)

+

Qα(K(cid:48))p(cid:96)
P(K(cid:48))

=

Qα(K)p(cid:96)
P(K)

.

Otherwise, in a more general case, we have

Corollary 2.11. Consider a positive integer n and Laplace-transformable input

concentration functions ˇC = (Cpe)p∈(cid:74)1,n(cid:75) ∈ C 0(R+, R+)n, then, there exist k distinct
elements (p(cid:96))(cid:96)∈(cid:74)1,k(cid:75) of (cid:74)1, n(cid:75), where k ∈ (cid:74)0, n(cid:75) (k = 0 if all input concentration
functions are identically zero) such that the functions (LCp(cid:96)e)(cid:96)∈(cid:74)1,k(cid:75) of M(Cre
m) are
linearly independent over R(X), where re
p ∈(cid:74)1, n(cid:75) \ {p(cid:96) : (cid:96) ∈(cid:74)1, k(cid:75)}, LCpe ∈ span({LCp(cid:96)e : (cid:96) ∈(cid:74)1, k(cid:75)}). Consider α ∈ R∗
m is deﬁned by (10), and such that for all
n and
denote by ˜C = Cα( ˇC). For all K ∈ Rn2+n and z ∈ Crm, where rm is deﬁned by (9), we
then have

+

L ˜C(z) =

k(cid:88)
(z)LCp(cid:96)e(z),
where for all (cid:96) ∈ (cid:74)1, k(cid:75), F
˜C(K) = ˜C(K(cid:48)) if and only if for all (cid:96) ∈(cid:74)1, k(cid:75)

ˇC,K,α
(cid:96)

ˇC,K,α
(cid:96)

(cid:96)=1

F

ˇC,K(cid:48),α
(cid:96)

F

= F

ˇC,K,α
(cid:96)

.

∈ R(X). Moreover, for K, K(cid:48) ∈ Rn2+n, we have

In the next sections, we will speciﬁcally study two common compartmental catenary
models. The ﬁrst one is composed of 2 compartments and the second one on 3
compartments. Both systems will have only one input and one output, both on the
ﬁrst compartment of the system.

3. Study of a 2-compartment catenary system

Figure 3. 2-compartment catenary model

Compartmental analysis identiﬁability

10

We introduce now the case of a 2-compartment catenary system. The low degree of
complexity of this 2-compartmental model, allows its daily clinical utilization in post-
processing PET images, without high computational request. For this reason, this
model is very popular in literature, handling with FDG-PET scans in particular, in
organs in which the FDG metabolism can be simpliﬁed in just two chemical phases: a
free intracellular phase and a metabolized ones [6, 7, 20]. We recall that the evolution
equations in a 2-compartment catenary system as in Figure 3 are given by

˙C1 = − (ke1 + k21) C1 + k12C2,
˙C2 = k21C1 − k12C2,

with initial conditions

C1(0) = 0,

C2(0) = 0.

That is

˙C = M C + W,

C(0) = 0,

where M ∈ M2(R), C ∈ C 1(R+, R)2, W ∈ C 0(R+, R)2 are given by

(cid:18)−(ke1 + k21)

(cid:19)

,

k12
−k12

(cid:18) C1

(cid:19)

(11)

(cid:19)

(cid:18) C1e

0

,

C2

k21

C =

W = k1e

M =
PET-scan images allow to access C∗ = (1 − V )(C1 + C2) + V C1e where V is a known
fraction in (0, 1) and represent the blood fraction in the tissue under examination. Since
C1e is the concentration of tracer in blood, it is directly measurable [15, 21]. So it is
possible to rewrite previous equation as ˜C = (1 − V )(C1 + C2), where ˜C = C∗ − V C1e
which is accessible from PET-scans. The inverse problem consists in recovering k1e, ke1,
k21, k12 from the knowledge of V , C1e and

= k1eC1ee1.

˜C = αT C,

where α = ( 1 − V

1 − V ) .

(12)

More generally, we will study the identiﬁability of this 2-compartment catenary system
on Ω = R∗
4. For sake of simplicity, in the following of the document, the exchange rates
of the system are denoted by a, b, c, k where

+

M and W are then rewritten

a = ke1,

b = k21,

(cid:18)−(a + b)

b

c
−c

M =

c = k12,

k = k1e.

(cid:19)

,

W = kC1ee1.

We recall that according to theorem 2.7, M is diagonalizable and its eigenvalues are
simple and negative. We suppose that C1e is bounded and not identically zero. Hence,
according to corollary 2.10, we ﬁrst have the following lemma
Lemma 3.1. k is uniquely determined by the knowledge of ˜C.

Now, in order to know the solutions of the inverse problem, we have to search for

the matrices Mx ∈ M2(R)

(cid:18)−(xa + xb)

xb

(cid:19)

,

xc
−xc

Mx =

Compartmental analysis identiﬁability
where xa, xb, xc ∈ R∗
+, such that Fx = F , with F = Q/P and Fx = Qx/Px, where P is
the characteristic polynomial of M , Px is the characteristic polynomial of Mx and Q, Qx
are deﬁned by

11

Q(X) = αT adj(X − M )e1,

Qx(X) = αT adj(X − Mx)e1.

That is

P (X) = X 2 + (a + b + c)X + ac,
Q(X) = (1 − V )(X + b + c),
Px(X) = X 2 + (xa + xb + xc)X + xaxc,
Qx(X) = (1 − V )(X + xb + xc).

First of all, write the rational fraction by splitting the polynomial P

,

and λ2 = − a+b+c−

(1 − V )(X + b + c)
(X − λ1)(X − λ2)
F (X) =
√
(a+b+c)2−4ac
where λ1 = − a+b+c+
. Remark that in
2
this simple example, we can easily verify the statement theorem 2.7. Indeed, we have
0 < (a + b− c)2 + 4bc = (a + b + c)2 − 4ac < a + b + c so that λ1 and λ2 are real, negative
and distinct. Moreover, we have λ1, λ2 (cid:54)= −(b+c), hence, the rational fraction F is in its
irreducible form. Since deg Px = deg P = 3 and deg Qx = deg Q = 2, Fx = F only if the
rational fraction Fx is irreducible too (but as we have just seen, since xa, xb, xc > 0, it is
always irreducible). In addition, since the leading coeﬃcients of Px and P are identical,
as well as those of Qx and Q, Fx = F if and only if Px = P and Qx = Q, that is

√

(a+b+c)2−4ac
2

xa + xb + xc = a + b + c,
xaxc = ac,
xb + xc = b + c.

Hence Fx = F if and only if xa = a, xb = b, xc = c, that is Mx = M . Consequently, we
have the following theorem

Theorem 3.2. The model of equations (11)-(12) is structurally globally identiﬁable.

Compartmental analysis identiﬁability

12

4. Study of a 3-compartment catenary system

Figure 4. 3-compartment catenary model

We now introduce a 3-compartment catenary system, which is the classical evolution of
the previous 2-compartment catenary model [21]. In this model, in the particular FDG
studies, the third compartment usually accounts for the presence of a blood stream that
carries tracer inside the organ under examination. In 2-compartment models, this is
approximated by using directly the tracer concentration in input C1e. There are also
tracers that intrinsically have a three-phase behaviour, as for example 11C, and in these
studies, it is quite natural to use a 3-compartment compartmental system [13]. We
recall that the evolution equations in a 3-compartment catenary system as in Figure 4
are given by

˙C1 = − (ke1 + k21) C1 + k12C2 + k1eC1e,
˙C2 = k21C1 − (k12 + k32) C2 + k23C3,
˙C3 = k32C2 − k23C3,

with initial conditions

C1(0) = 0,

C2(0) = 0,

C3(0) = 0.

That is

˙C = M C + W,

C(0) = 0,

(13)

where M ∈ M3(R), C ∈ C 1(R+, R)3, W ∈ C 0(R+, R)3 are given by

−(ke1 + k21)
 C1
 ,

k21
0

C2
C3

M =

C =

k12

−(k12 + k32)

k32

 C1e

0
0

W = k1e

 ,
 = k1eC1ee1.

0
k23
−k23

Compartmental analysis identiﬁability
13
PET-scan images allow to access ˜C = V C1 + (1 − V ) (C2 + C3) where V is a known
fraction in (0, 1), representing the blood fraction in the tissue under examination. The
inverse problem consists in recovering k1e, ke1, k21, k12, k32, k23 from the knowledge of
V , C1e and

˜C = αT C,

where α = ( V

1 − V

1 − V ) .

(14)

More generally, we will study the identiﬁability of this 3-compartment catenary system
on Ω = R∗
6. For sake of simplicity, in the following of the document, the exchange rates
of the system are denoted by a, b, c, d, e, k where

+

a = ke1,

b = k21,

c = k12,

d = k32,

M and W are then rewritten

−(a + b)

b
0

M =

c

−(c + d)

d

0
e
−e

 ,

e = k23,

k = k1e.

W = kC1ee1.

We recall that according to theorem 2.7, M is diagonalizable and its eigenvalues are
simple and negative. We suppose that C1e is bounded and not identically zero. Hence,
according to corollary 2.10, we ﬁrst have the following lemma
Lemma 4.1. k is uniquely determined by the knowledge of ˜C.

Using the properties of the n-compartment catenary system given in theorem 2.7
in the special case of one input
and the corollary 2.10 of the preliminary results,
concentration function, we can write the following theorem, whose proof can be found
in the appendix A.
Theorem 4.2. If V ≥ 1/2, the model of equations (13)-(14) is structurally globally
identiﬁable. Otherwise, the model is neither structurally globally nor structurally locally
identiﬁable. However, the model is locally identiﬁable at points (a, b, c, d, e, k) ∈ R∗
6
such that

+

(cid:16)
(c + d + e)V + (1 − V )b ±(cid:112)∆Q

(cid:17)

.

a (cid:54)=

1 − 2V
2V (1 − V )

More precisely, in that case, the model is globally identiﬁable at points (a, b, c, d, e, k) ∈
R∗
6 such that one of the following exclusive conditions of lemma A.4 holds: 1, 2.1, 2.2.1,
2.2.2.1, 3.1.1, 3.1.2.1.1, 3.1.2.2, 3.2.1, 3.2.2.1, 3.2.2.2.1, 3.3.1.1, 3.3.2.1. Otherwise,
the inverse problem has two distinct solutions. In the case where

+

(cid:16)
(c + d + e)V + (1 − V )b ±(cid:112)∆Q

(cid:17)

,

1 − 2V
2V (1 − V )

a =

the model is neither globally nor locally identiﬁable. More precisely, the set of solutions
of the inverse problem is a curve of R6.

Compartmental analysis identiﬁability

14

5. Conclusions

This paper discusses the general mathematical model for the compartmental analysis of
nuclear medicine data and provides some identiﬁability results in the case of the two-
and three-compartment catenary models. We think that the main advantage of our
approach is its notable degree of generality, which allows a rather uniﬁed approach to the
deﬁnition of the model and, particularly, to the proof of the uniqueness results. Further
generalization of the identiﬁability results to n-compartment models, with n > 3, are
certainly diﬃcult although some uniqueness conditions can be probably formulated
in the case of low dimension non-catenary models and catenary models with higher
dimension.

A second paper concerned with two- and three-compartment catenary models is
under preparation, which will address the inverse problem of numerically determining
the tracer coeﬃcients by means of a general quasi-Newton regularized scheme. In this
paper applications concerning cerebral, hepatic, and renal functions will be considered,
involving experimental measurements acquired by means of a PET system for small
animals. Further investigation will deal with the formulation of a compartmental model
in which the tracer coeﬃcients are local parameters and therefore the numerical solution
of the inverse problem leads to the construction of parametric images.

References

[1] Adams S, Baum R, Stuckensen T, Bitter T and Hoer G 1998 Prospective comparison of FDG-PET
with conventional imaging modalities (CT, MRI, US) in lymph node staging of head and neck
cancer Eur. J. Nucl. Med 25

[2] Bateman T M, Heller G V, McGhie A I, Friedman J D, Case J A, Bryngelson J R, Hertenstein
G K, Moutray K L, Reid K, Cullom S J 2006 Diagnostic accuracy of rest/stress ECG-gated
Rb-82 myocardial perfusion PET: comparison with ECG-gated Tc-99m sestamibi SPECT J.
Nucl. Cardiol. 13 24–33

[3] Basu A, Basu R, Shah P, Vella A, Johnson C, Nair K, Jensen M, Schwenk W and Rizza R 1994
Evaluation of the eﬀect of glucose ingestion and kinetic model conﬁgurations of FDG in the
normal liver J. Nucl. Med. 35 2055–2060

[4] Diederichs C, Staib L, Glatting G, Beger H and Reske S 1998 FDG PET: elevated plasma glucose
reduces both uptake and detection rate of pancreatic malignancies J. Nucl. Med. 39 1030–1033
[5] Evans N D, Errington R J, Chapman M J, Smith P J, Chappell M J and Godfrey K R 2005
Compartmental modelling of the uptake kinetics of the anti-cancer agent topotecan in human
breast cancer cells Internat. J. Adapt. Control Signal Process. 19 395–417 ISSN 0890-6327 URL
http://dx.doi.org/10.1002/acs.856

[6] Garbarino S, Caviglia G, Brignone M, Massollo M, Sambuceti G and Piana M 2013 Estimate of
FDG excretion by means of compartmental analysis and Ant Colony Optimization of nuclear
medicine data Comput. Math. Methods. Med. 2013 793142

[7] Garbarino S, Caviglia G, Sambuceti G, Benvenuto F and Piana M 2014 A novel description of
FDG excretion in the renal system: application to metformin treated models Phys. Med. Biol.
59 2469–2484

[8] Garbarino S, Vivaldi V, Delbary F, Caviglia G, Piana M, Marini C, Capitanio S, Calamia I,
Buschiazzo A and Sambuceti G 2015 A new compartmental method for the analysis of liver

Compartmental analysis identiﬁability

15

FDG kinetics European Journal of Nuclear Medicine and Molecular Imaging Research 2015
5-35

[9] Gunn R, Gunn S and Cunningham V 2001 Positron emission tomography compartmental models

J. Cereb. Blood Flow Metab. 21 635–652

[10] Gunn R, Gunn S, Turkheimer F, Aston J and Cunningham V 2002 Positron emission tomography
compartmental models: a basis pursuit strategy for kinetic modeling J. Cereb. Blood Flow Metab.
22 1425–1439

[11] Hearon J Z 1963 Theorems on Linear SystemAnn. New York Acad. Sci. 108 36–68
[12] Hudson H and Larkin R 1994 Accelerated image reconstruction using ordered subsets of projection

IEEE Trans. Med. Imaging 13 601–609

[13] Koeppe R A, Holthoﬀ V A, Frey K A, Kilbourn M R and Kuhl D E 1991 Compartmental Analysis of
[11C]Flumazenil Kinetics for the Estimation of Ligand Transport Rate and Receptor Distribution
Using Positron Emission Tomography J. Cereb. Blood Flow Metab. 11 735–744

[14] Kostakoglu L, Schoder H and Johnson J 2012 Interim FDG PET imaging in stage I/II non bulky
Hodgkin lymphoma: Would using combined PET and CT criteria better predict response than
each test alone Leuk. Lymphoma 53 2143–2150

[15] Kudomi N, Jarvisalo M, Kiss J, Borra R, Viljanen A, Viljanen T, Sauvunen T, Knuuti J, Iida H,
Nuutila P and Iozzo P 2009 Non-invasive estimation of hepatic glucose uptake from [18F]FDG
PET images using tissue-derived input functions Eur. J. Nucl. Med. Mol. Imaging 36 2014–2026
[16] Miao H, Xia X, Perelson A S and Wu H 2011 On Identiﬁability of Nonlinear ODE Models and
Applications in Viral Dynamics SIAM Rev. 53 3–39 ISSN 0036-1445 URL http://dx.doi.org/
10.1137/090757009

[17] Natterer F 2001 Inversion of the attenuated Radon transform Inverse Problems 17 113
[18] Ollinger J M and Fessler J A 1997 Positron-emission tomography IEEE Sign. Proc. Mag. 14 43–55
[19] Parter S 1960 On the eigenvalues and eigenvectors of a class of matrices J. Soc. Indust. Appl.

Math. 8 376–388

[20] Qiao H, Bai J, Chen Y and Tian J 2007 Kidney modelling for FDG excretion with PET Int. J.

Biomed. Imaging 2007 63234

[21] Rani S and Nemanich S and Fettig N and Shoghi K 2013 Kinetic analysis of FDG in rat liver:

eﬀect of dietary intervention on arterial and portal vein input Nucl. Med. Biol. 40 537–546

[22] Rescigno A 1997 Clearance, turnover time, and volume of distribution Pharm. Res. 35 189–193
[23] Rescigno A 2009 Compartmental Analysis and its Manifold Applications to Pharmacokinetics The

AAPS Journal 12 61–72

[24] Shepp L and Vardi Y, Maximum likelihood reconstruction for emission tomography 1982 IEEE

Trans. Med. Imag. 1 113–122

[25] Wang W, Georgi J C, Nehmeh S A, Narayan M, Paulus T, Bal M and Humm J L 2009 Evaluation
of a compartmental model for estimating tumor hypoxia via FMISO dynamic PET imaging
Phys. Med. Biol. 10 3083–3099

[26] Zhou Y, Resnick S and Wong F 2007 Using a reference tissue model with spatial constraint
to quantify [11C] Pittsburgh compound B PET for early diagnosis of Alzheimer’s disease
Neuroimage 2 298–312

A. APPENDIX
In order to prove theorem 4.2 we ﬁrst need to search for the matrices Mx ∈ M3(R)

−(xa + xb)

xb
0

Mx =

 ,

xc

−(xc + xd)

xd

0
xe
−xe

Compartmental analysis identiﬁability
where xa, xb, xc, xd, xe ∈ R∗
+, such that Fx = F , with F = Q/P and Fx = Qx/Px, where
P is the characteristic polynomial of M , Px is the characteristic polynomial of Mx and
Q, Qx are deﬁned by

16

Q(X) = αT adj(X − M )e1,

Qx(X) = αT adj(X − Mx)e1.

That is

P (X) = X 3 + (a + b + c + d + e)X 2 + (ac + ad + ae + bd + be + ce)X + ace,
Q(X) = V X 2 + (V (c + d + e) + (1 − V )b)X + (V ce + (1 − V )(d + e)b),
Px(X) = X 3 + (xa + xb + xc + xd + xe)X 2

+(xaxc + xaxd + xaxe + xbxd + xbxe + xcxe)X + xaxcxe,

Qx(X) = V X 2 + (V (xc + xd + xe) + (1 − V )xb)X + (V xcxe + (1 − V )(xd + xe)xb).
We ﬁrst begin with some preliminary results about the polynomials P and Q and the
rational fraction F . The discriminant of Q is given by

∆Q = (V (c + d + e) + (1 − V )b)2 − 4V (V ce + (1 − V )(d + e)b),

thus 0 < ∆Q < V (c + d + e) + (1 − V )b. Hence Q has two distinct real negative roots

= ((−c + d + e)V − (1 − V )b)2 + 4cdV 2,

µq = −(c + d + e)V + (1 − V )b + (−1)q(cid:112)∆Q

2V

,

q ∈ {1, 2},

Hence, the rational fraction F can be written as
V (X − µ1)(X − µ2)

F (X) =

(X − λ1)(X − λ2)(X − λ3)

,

where λ1 < λ2 < λ3 < 0 are the eigenvalues of M . In the following, we will need to know
the irreducible form of the rational fraction F , that is, the number of roots common to
P and Q. For the moment, we have three possibilities.

x P and Q have no common root, i.e. they are coprime, so that F is irreducible,
y P and Q have one common root λp = µq, p ∈ {1, 2, 3}, q ∈ {1, 2}, hence

,

where p(cid:48), p(cid:48)(cid:48) ∈ {1, 2, 3} \ {p}, q(cid:48) ∈ {1, 2} \ {q},

z P and Q have two common roots, i.e. Q|P , µ1 = λp, µ2 = λp(cid:48), p, p(cid:48) ∈ {1, 2, 3}, p (cid:54)=

V (X − µq(cid:48))

F =

(X − λp(cid:48))(X − λp(cid:48)(cid:48))

p(cid:48), hence

F =

V

X − λp(cid:48)(cid:48)

,

where p(cid:48)(cid:48) ∈ {1, 2, 3} \ {p, p(cid:48)}.

We observe that P and Q are not coprime if and only if their resultant res(P, Q) is 0.
The resultant res(P, Q) of P and Q is given by

res(P, Q) = −b2cd(cid:0)V (1 − V )2a2 − (1 − V )(1 − 2V )(V (c + d + e) + (1 − V )b)a

+ (1 − 2V )2(V ce + (1 − V )(d + e)b)(cid:1) .

Compartmental analysis identiﬁability
17
In particular, we can see that if V = 1/2, res(P, Q) = −a2b2cd/8 (cid:54)= 0, otherwise, it can
be easily remarked that

(cid:18)
− 1 − V
1 − 2V
Hence, for V (cid:54)= 1/2, res(P, Q) = 0 if and only if − 1−V
V > 1/2, then − 1−V
We recall that the same result holds for V = 1/2, thus we have the following lemma
Lemma A.1. If V ≥ 1/2, then P and Q are coprime so that F is irreducible.

1−2V a is a root of Q. In particular, if
1−2V a > 0. However, the roots of Q are negative, thus res(P, Q) (cid:54)= 0.

res(P, Q) = −b2cd(1 − 2V )2Q

(cid:19)

a

.

If now V < 1/2 and − 1−V

1 − 2V
2V (1 − V )

a =

1−2V a is a root of Q, that is

(cid:16)
(c + d + e)V + (1 − V )b + (−1)q(cid:112)∆Q

(cid:17)

then P (X) = (X − µq) ˘P (X), where

(2 − 3V )(c + d + e) + (1 − V )b − (−1)q(cid:112)∆Q

,

q ∈ {1, 2},

˘P (X) = X 2 +

that is

˘P (X) = X 2 +

− V
Since Q(X) = (X − µq) ˘Q(X), with

˘Q(X) = V

X +

1 − 2V
1 − V

(cid:18)

X +

2(1 − V )

1 − 2V

a + b − 1 − 2V
1 − V

(cid:19)
(c + d + e)V + (1 − V )b − (−1)q(cid:112)∆Q

(c + d + e)

X +

(cid:33)

ce,

1 − 2V
1 − V

ce.

,

˘Q(X) = V

F (X) =

˘P (µq(cid:48)) =

2V

,

a +

b + c + d + e

1 − V
V

(cid:19)
V b + c + d + e(cid:1)
1−V (c + d + e)(cid:1) X + 1−2V
(cid:19)

X − 1 − V
1 − 2V
V (cid:0)X − 1−V
X 2 +(cid:0)− V
1−2V a + b − 1−2V
(cid:18)
1 − 2V
bV + (1 − V )d − V (1 − V )
((−c + d + e)V − (1 − V )b + (−1)q(cid:112)∆Q).
1 − 2V
V 2
= −1 − 2V

1−2V a + 1−V

1−V ce

e

.

,

Thus P and Q have two commons roots if and only if ˘P (µq(cid:48)) = 0 where q(cid:48) ∈ {1, 2}\{q}.
However

Since ∆Q = ((−c+d+e)V −(1−V )b)2+4cdV 2, we have(cid:112)∆Q > |(−c+d+e)V −(1−V )b|,

2V 2

hence ˘P (µq(cid:48)) (cid:54)= 0. We thus have the following lemma

(cid:32)
(cid:18)

that is

we have

Compartmental analysis identiﬁability

18

Lemma A.2. If V < 1/2, P and Q have at most one common root. This happens if
and only if − 1−V

1−2V a is a root of Q, that is

(cid:16)
(c + d + e)V + (1 − V )b + (−1)q(cid:112)∆Q

(cid:17)

,

q ∈ {1, 2},

1 − 2V
2V (1 − V )

a =

where

∆Q = (V (c + d + e) + (1 − V )b)2 − 4V (V bc + (1 − V )(d + e)b),

= ((−c + d + e)V − (1 − V )b)2 + 4cdV 2.

In this case, we have F = ˘Q/ ˘P , where ˘P and ˘Q are coprime and

(cid:18)
− V
1 − 2V
X − 1 − V
1 − 2V

(cid:18)

a + b − 1 − 2V
1 − V

1 − V
V

(cid:19)

(cid:19)

(c + d + e)

X +

1 − 2V
1 − V

ce,

˘Q(X) = V

a +

b + c + d + e

.

˘P (X) = X 2 +

We are now ready to seek the solutions of the inverse problem and study the
identiﬁability of the system. We ﬁrst treat the case where P and Q are coprime and
ﬁnish the study with the case where they are not.

A.1. Coprimality of P and Q

We suppose here that P and Q are coprime. Since F is irreducible and deg Px = deg P =
3 and deg Qx = deg Q = 2, Fx = F only if the rational fraction Fx is irreducible too. In
addition, since the leading coeﬃcients of Px and P are identical, as well as those of Qx
and Q, Fx = F if and only if Px = P and Qx = Q, that is

(15a)

(15b)

V (xc + xd + xe) + (1 − V )xb = V (c + d + e) + (1 − V )b,
V xcxe + (1 − V )(xd + xe)xb = V ce + (1 − V )(d + e)b,
xa + xb + xc + xd + xe = a + b + c + d + e,
(xc + xd + xe)xa + (xd + xe)xb + xcxe = (c + d + e)a + (d + e)b + ce,
xaxcxe = ace.
(15e)
Doing (15a)−V (15c) to replace (15a), followed by (1− 2V )(15c)−(15a) to replace (15c),
then by (1 − V )(15d)−(15b) to replace (15d), the system (15) is equivalent to
− V xa + (1 − 2V )xb = −V a + (1 − 2V )b,
V xcxe + (1 − V )(xd + xe)xb = V ce + (1 − V )(d + e)b,
1 − V
1 − 2V
(xc + xd + xe) +
a,
1 − V
1 − 2V

1 − V
1 − 2V

xa = (c + d + e) +

(xc + xd + xe)

a + ce,

(16d)

(16a)

(16b)

(15c)

(15d)

(16c)

1 − V
1 − 2V
xa = ce

xa + xcxe = (c + d + e)
1 − V
1 − 2V

a.

1 − V
1 − 2V

xcxe

(16e)

Compartmental analysis identiﬁability
The equations (16c), (16d), (16e) are veriﬁed if and only if xc+xd+xe±
and 1−V

1−2V xa are the roots of the polynomial R of degree 3

(cid:18)
X − 1 − V
1 − 2V
(cid:1) = 0, although the new system is redundant considering equations (16c),

where ˘R(X) = X 2 − (c + d + e)X + ce.

Hence, the system (16) is equivalent to the one obtained by including the equation

R(cid:0) 1−V

(xc+xd+xe)2−4xcxe

R(X) =

˘R(X),

(cid:19)

√

19

a

2

1−2V xa

(16d), (16e) and the newly included one. The system (16) is then equivalent to

− V xa + (1 − 2V )xb = −V a + (1 − 2V )b,
V xcxe + (1 − V )(xd + xe)xb = V ce + (1 − V )(d + e)b,
1 − V
1 − 2V
(xc + xd + xe) +
a,
1 − V
1 − 2V

1 − V
1 − 2V

xa = (c + d + e) +

(xc + xd + xe)

xa + xcxe = (c + d + e)
1 − V
1 − 2V

a,

a + ce,

1 − V
1 − 2V
xa = ce

(cid:19)

xa

= 0.

xcxe

(cid:18) 1 − V

1 − V
1 − 2V
1 − 2V

R

(17a)

(17b)

(17c)

(17d)

(17e)

(17f)

1−2V xa < 0, then ˘R(cid:0) 1−V

(cid:1) (cid:54)= 0 and the unique solution of (17f) is xa = a, so

The solution xa = a to the equation (17f) leads to xb = b, xc = c, xd = d, xe = e, that is
Mx = M . In addition, since 0 < (−c + d + e)2 + 4cd = (c + d + e)2 − 4ce < (c + d + e)2,
the roots of ˘R are distinct, real and positive. However, for V > 1/2 and xa > 0, we
have 1−V
that the unique solution of the inverse problem is Mx = M . We recall that we had the
same result for V = 1/2. In addition, we also recall that according to lemma A.1, P
and Q are always coprime for V ≥ 1/2, thus, we have the following lemma
Lemma A.3. If V ≥ 1/2, the inverse problem has a unique solution.

1−2V xa

(cid:17)

b , x±

a , x±

(cid:1) = 0. These

the solutions of ˘R(cid:0) 1−V
1−2V a(cid:1) (cid:54)= 0, they are given by

Suppose now that V < 1/2, then (17f) has at least two distinct solutions
since the roots of ˘R are distinct and at most three distinct solutions. Consider
for the moment the solutions of (17) in R5 regardless of their sign and denote by
a = 1−2V
x±
2(1−V )
solutions lead to two solutions (x±
and (1 − 2V )bc − (1 − V )(x±
1 − 2V
2(1 − V )
V

(cid:16)
c + d + e ±(cid:112)(c + d + e)2 − 4ce
a − a)(cid:0)b − V
(cid:16)
(cid:17)
c + d + e ±(cid:112)(c + d + e)2 − 4ce
a − a)(cid:0)b − V
1−2V a(cid:1)
(cid:1)

1−2V xa
e ) to (17), provided b+ V

x±
a =
x±
b = b +

a −a) (cid:54)= 0

a − a),
(x±

1−2V (x±

1 − 2V

x±
c =

c , x±

d , x±

(18b)

(18a)

,

,

bQ(cid:0)− 1−V

(1 − 2V )bc − (1 − V )(x±
(1 − 2V )x±
1−V c − x±
2x±

1−2V a(cid:1)(cid:0) 1−2V

(1 − 2V )x±

a

b

b

c

,

(18c)

(18d)

x±
d =

Compartmental analysis identiﬁability

(cid:18) 1 − V

(cid:19)2 x∓

a

20

(18e)

x±
e = a

x±
c
a , x+
Remark that if both solutions (x+
have

1 − 2V

.

b , x+

c , x+

d , x+

e ) and (x−

a , x−

b , x−

c , x−

d , x−

e ) exist, we

c x+
x+

d x−

c x−

d = −16cde2(1 − V )2 Ξ2
Υ2 ,

where
Ξ = a(c + d + e)(1 − V )(1 − 2V )2 − b(d + e)(1 − V )(1 − 2V )2 + ab(1 − 2V )(1 − V )2

−ceV (1 − 2V )2 − a2V (1 − V )2,

and
Υ = ((c + d + e)V (1 − 2V ) + 2b(1 − V )(1 − 2V ) − 2aV (1 − V ))2

−V 2(1 − 2V )2(cid:0)(c + d + e)2 − 4ce(cid:1)2 .

e

(cid:17)

c x+

a (cid:54)=

d +x±

d , x−

c , x−

c , x+
c x±

(x±
c +x±
2

c x−
d x−
d < 0. Moreover, since x±
c and x−
√
e . In addition, x+
c +x±
d +x±
e )2−4x±
e ±
d (cid:54)= 0, one and only one of x+

d ≤ 0 and we have x+
c x−
d x−
c x+
Hence x+
c x−
d x−
c x+
otherwise x+
e have the same sign as well as x−
and x+
e neither, since x±
negative and x−
polynomial R, thus positive. Hence, if x±
is negative so that we have one of the two exclusive cases: x+
c > 0 and x−
x−
precisely, considering (18) and the previous remark, we have the following lemma

d = 0 if and only if x+
d = 0,
a > 0, according to equation (17e), x+
c
d , x+
e are not all
are roots of the
c , x−
d , x−
c , x+
d
c > 0 and x+
d > 0 or
d > 0. Consequently, the inverse problem has at most two solutions. More

d = 0 or x−

Lemma A.4. If V < 1/2 and the polynomials P and Q are coprime, that is

(cid:16)
(c + d + e)V + (1 − V )b ±(cid:112)∆Q
1−2V a(cid:1) ≤ 0. Then the inverse problem has a
a − a)(cid:0)b − V
1−2V a(cid:1) and
a − a)(cid:0)b − V
(cid:17)2
(cid:16)
(cid:17)2

then, we have one of the exclusive cases:
1−2V a − b. Then the inverse problem has a unique solution: (a, b, c, d, e).
1)
1−2V a − b < V
2)
2.1) (1 − 2V )bc − (1 − V )(x+
unique solution: (a, b, c, d, e).
2.2) 0 < (1 − 2V )bc − (1 − V )(x+
2.2.1) ((−c + d + e)V − (1 − V )b)2 + 4cdV 2 <
Then the inverse problem has a unique solution: (a, b, c, d, e).

(c + d + e)V + (1 − V )b − 2V (1−V )
1−2V a

1 − 2V
2V (1 − V )

a ≤ V
a ≤ V

1−2V x+
1−2V x−

1−2V x+

< ((−c + d + e)V − (1 − V )b)2 + 4cdV 2

(c + d + e)V + (1 − V )b − 2V (1−V )
1−2V a

2.2.2)
and
2.2.2.1) a = x+
a . Then the inverse problem has a unique solution: (a, b, c, d, e).
2.2.2.2) a (cid:54)= x+
a . Then the inverse problem has two solutions:
a , x+
(x+
d , x+
e ).
1−2V a − b < V
1−2V x−
3)
aV (1−V )(x+
(1−2V )((1−V )(x+

a −a)−(1−2V )c))

a and
a −a)

3.1) b =

c , x+

b , x+

and

(a, b, c, d, e) and

a and

(cid:16)

.

V

V

V

,

(cid:16)

21

(cid:17)2

1−2V a and

(c + d + e)V + (1 − V )b − 2V (1−V )
1−2V a

1−2V a ≤ 0. Then the inverse problem has a unique solution: (a, b, c, d, e).

Compartmental analysis identiﬁability
3.1.1) b − V
3.1.2) 0 < b − V
3.1.2.1) ((−c + d + e)V − (1 − V )b)2+4cdV 2 <
and
3.1.2.1.1) a = x−
a . Then the inverse problem has a unique solution: (a, b, c, d, e).
3.1.2.1.2) a (cid:54)= x−
a . Then the inverse problem has two solutions:
c , x−
a , x−
d , x−
(x−
e ).
(c + d + e)V + (1 − V )b − 2V (1−V )
3.1.2.2)
1−2V a
4cdV 2. Then the inverse problem has a unique solution: (a, b, c, d, e).
3.2) b =
3.2.1) 0 ≤ b − V
3.2.2) b − V
3.2.2.1) ((−c + d + e)V − (1 − V )b)2+4cdV 2 <
Then the inverse problem has a unique solution: (a, b, c, d, e).

1−2V a. Then the inverse problem has a unique solution: (a, b, c, d, e).

(c + d + e)V + (1 − V )b − 2V (1−V
1−2V a

(1−2V )((1−V )(x−

1−2V a < 0 and

a −a)−(1−2V )c))

aV (1−V )(x−

b , x−

< ((−c + d + e)V − (1 − V )b)2 +

(a, b, c, d, e) and

(cid:17)2

(cid:16)

(cid:16)

a −a)

and

(cid:17)2

.

(cid:17)2

(cid:16)

(a, b, c, d, e) and

< ((−c + d + e)V − (1 − V )b)2 + 4cdV 2

a −a)

(cid:16)

b , x+

(c + d + e)V + (1 − V )b − 2V (1−V
1−2V a

aV (1−V )(x±

a −a)−(1−2V )c))

c , x+
and
(1−2V )((1−V )(x±
(c + d + e)V + (1 − V )b − 2V (1−V
1−2V a

3.2.2.2)
and
3.2.2.2.1) a = x+
a . Then the inverse problem has a unique solution: (a, b, c, d, e).
3.2.2.2.2) a (cid:54)= x+
a . Then the inverse problem has two solutions:
a , x+
(x+
d , x+
e ).
3.3) b (cid:54)=

(cid:17)2
a − a)(cid:0)b − V
1−2V a(cid:1) and
(cid:16)
1−2V a(cid:1) and

a − a)(cid:0)b − V

a . Then the inverse problem has a unique solution: (a, b, c, d, e).
a . Then the inverse problem has two solutions:
e ).

3.3.1)
and 0 < (1 − 2V )bd − (1 − V )(x+
3.3.1.1) a = x+
3.3.1.2) a (cid:54)= x+
(x+
d , x+
3.3.2) ((−c + d + e)V − (1 − V )b)2 + 4cdV 2 <
and 0 < (1 − 2V )bd − (1 − V )(x−
3.3.2.1) a = x−
a . Then the inverse problem has a unique solution: (a, b, c, d, e).
3.3.2.2) a (cid:54)= x−
a . Then the inverse problem has two solutions:
d , x−
(x−
e ).

a , x−

c , x−

b , x−

a , x+

c , x+

b , x+

(c + d + e)V + (1 − V )b − 2V (1−V
1−2V a

< ((−c + d + e)V − (1 − V )b)2 + 4cdV 2

(a, b, c, d, e) and

(a, b, c, d, e) and

(cid:17)2

A.2. Non-coprimality of P and Q

We suppose here that P and Q are not coprime. Then, according to lemma A.1, V < 1/2,
moreover, according to lemma A.2, − 1−V

(cid:16)
(c + d + e)V + (1 − V )b + (−1)q(cid:112)∆Q

1−2V a is a root of Q, that is

(cid:17)

,

q ∈ {1, 2},

1 − 2V
2V (1 − V )

a =

Compartmental analysis identiﬁability

22

where

∆Q = (V (c + d + e) + (1 − V )b)2 − 4V ((1 − V )(d + e)b + V ce),

= ((−c + d + e)V − (1 − V )b)2 + 4cdV 2.

Moreover, F = ˘Q/ ˘P where ˘P and ˘Q are coprime and

˘Q(X) = V

˘P (X) = X 2 +

a

(cid:18)

1 − 2V

X + c + d + e +

(c + d + e) + b − V
(cid:19)
b − 1 − V
1 − 2V
(cid:17)
(xc + xd + xe)V + (1 − V )xb + (−1)qx(cid:112)∆Qx

1 − V
V

a

.

(cid:16)

Fx = F only if Px and Qx are not coprime, that is − 1−V

1−2V xa is a root of Qx

1 − V

xa =

2V (1 − 2V )

,

qx ∈ {1, 2},

(cid:18)
−1 − 2V
1 − V

(cid:19)

X +

1 − 2V
1 − V

ce,

where
∆Qx = (V (xc + xd + xe) + (1 − V )xb)2 − 4V ((1 − V )(xd + xe)xb + V xcxe),

= ((−xc + xd + xe)V − (1 − V )xb)2 + 4xcxdV 2.

So that, Fx = ˘Qx/ ˘Px where ˘Px and ˘Qx are coprime and

(cid:18)
−1 − 2V
1 − V

(cid:18)

˘Px(X) = X 2 +

˘Qx(X) = V

X + xc + xd + xe +

(xc + xd + xe) + xb − V
xb − 1 − V
1 − 2V

1 − V
V

1 − 2V

xa

.

xa

(cid:19)

(cid:19)

X +

1 − 2V
1 − V

xcxe,

Since ˘Qx/ ˘Px and ˘Q/ ˘P are irreducible and the leading coeﬃcients of ˘Px and ˘P are
identical, as well as those of ˘Qx and ˘Q, Fx = F only if ˘Px = ˘P and ˘Qx = ˘Q. Hence,
Fx = F if and only if

(cid:18) 1 − V

1 − 2V

V

(cid:19)2

−1 − 2V
1 − V

(xc + xd + xe) + xb

− V

1 − 2V
V (xc + xd + xe) + (1 − V )xb
−V (1 − V )
1 − 2V
(cid:19)2

(cid:18) 1 − V

V

1 − 2V

xa

xa = V (c + d + e) + (1 − V )b − V (1 − V )
1 − 2V

(19d)
Hence, doing (19d)−(1 − V )(19c) to replace (19c), followed by (1 − V )(19d)-V (19c) to
replace (19d), we get

a.

+ ((1 − V )(xc + xe)xb + V xdxe)

xa

+ ((1 − V )(xd + xe)xb + V xcxe)

−(V (xc + xd + xe) + (1 − V )xb)
xcxe = ce,

1 − V
1 − 2V

xa = 0,

xa = −1 − 2V
1 − V

(c + d + e) + xb − V

1 − 2V

a,

(19a)

(19b)

(19c)

Compartmental analysis identiﬁability

1 − V
1 − 2V

−(V (xc + xd + xe) + (1 − V )xb)
xcxe = ce,
xc + xd + xe = c + d + e,
(1 − 2V )xb − V xa = (1 − 2V )b − V a.

xa = 0,

Replacing xa in (20a) by a + 1−2V

V

(xb − b) given by (20d), we get

(xc + h)xb =

V
1 − V

(h2 + (xc + xd + xe)h + xcxe),

where h = 1−V

(21a), we get (cid:18)

xcxe = ce,
xc + xd + xe = c + d + e,
(1 − 2V )xb − V xa = (1 − 2V )b − V a,
V b − 1−V

a

xc +

b − 1 − V
1 − 2V

1 − V
V
xcxe = ce,
xc + xd + xe = c + d + e,
(1 − 2V )xb − V xa = (1 − 2V )b − V a.

xb =

c +

23

(20a)

(20b)

(20c)

(20d)

(21a)

(21b)

(21c)

(21d)

1−2V a. Then, replacing xc + xd + xe by c + d + e and xcxe by ce in

(cid:19)

(cid:18)

(cid:19)

1 − V
V

b − 1 − V
1 − 2V

a

b,

(22a)

(22b)

(22c)

(22d)

V b − 1−V

The set of solutions (xa, xb, xc, xd, xe) to (22) is a curve given by the intersection of two
cylindrical hypersurfaces over hyperbolas (22a, 22b) and two hyperplanes (22c, 22d). If
c + 1−V
1−2V a = 0, the cylindrical hypersurface given by (22a) degenerates into two
hyperplanes whose respective equations are xb = 0 and xc = c so that the set of solutions
of (22) is composed of the line of equations (1 − 2V )xb − V xa = (1 − 2V )b − V a, xc =
c, xd = d, xe = e and the hyperbola of equations xa = 0, xb = 0, xc + xd + xe =
c + d + e, xcxe = ce. Considering the inverse problem, we thus have the following lemma

Lemma A.5. If V < 1/2 and the polynomials P and Q are not coprime

P (X) = X 3 + (a + b + c + d + e)X 2 + (ac + ad + ae + bd + be + ce)X + ace,
Q(X) = V X 2 + (V (c + d + e) + (1 − V )b)X + (V ce + (1 − V )(d + e)b),
then, if c+ 1−V
is given by the open half-line of R5 of parametric equation
t ∈

t (cid:55)→ (a + (1 − 2V )t, b + V t, c, d, e) ,

V b− 1−V

, +∞

(cid:18)

(cid:19)

1−2V a = 0, the set of solutions (xa, xb, xc, xd, xe) to the inverse problem

.

− b
V

(cid:32)

Otherwise, the set of solutions (xa, xb, xc, xd, xe) to the inverse problem is given by the
curve of R5 of parametric equation
t (cid:55)→

(1 − 2V )(c − t)b

a +

,

,

,

b, t, c + d + e − t − ce
t

ce
t

c + 1−V
t + 1−V

V b − 1−V
1−2V a
V b − 1−V
1−2V a

V t + (1 − V )b − V (1−V )
1−2V a

(cid:33)

Compartmental analysis identiﬁability

(cid:19)(cid:19)

,

if V a − (1 − 2V )b < 0,

24

,

if 0 ≤ V a − (1 − 2V )b < (1 − 2V )V c,

if (1 − 2V )V c < V a − (1 − 2V )b,

.

where

β−, min

t ∈

max

(cid:18)
(cid:18)
(cid:18)



β+,

(cid:18)
(cid:18) 1 − V
(cid:18)

1 − 2V

β+,

β−, min

where

β± =

(1 − 2V )bc

(1 − 2V )b − V a

a +

1 − V
1 − 2V
a − 1 − V
1 − V
1 − 2V

b, β−(cid:19)
a − 1 − V

V

(cid:19)
(cid:19)(cid:19)

, β+

b

,

V

c + d + e ±(cid:112)(c + d + e)2 − 4ce

2

