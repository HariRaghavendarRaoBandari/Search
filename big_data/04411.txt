6
1
0
2

 
r
a

 

M
4
1

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
1
1
4
4
0

.

3
0
6
1
:
v
i
X
r
a

Generalized automorphic sheaves and the proportionality principle

of Hirzebruch-Mumford

Mathematisches Institut, Albert-Ludwigs-Universit¨at Freiburg

Fritz H¨ormann

March 2016

2010 Mathematics Subject Classiﬁcation: 14J15, 11F55, 14G35

Keywords: Automorphic vector bundles, modular forms, generalized automorphic sheaves, cusp forms, Jacobi forms,

Fourier-Jacobi categories, toroidal compactiﬁcations of mixed Shimura varieties, Chern classes, Hirzebruch-Mumford

proportionality

Abstract

We axiomatize the algebraic structure of toroidal compactiﬁcations of Shimura varieties and their
automorphic vector bundles. We propose a notion of generalized automorphic sheaf which includes
the sheaves of sections of automorphic vector bundles with all kinds of prescribed vanishing orders
along strata in the compactiﬁcation, their quotients, as well as e.g. Jacobi forms, and almost
holomorphic modular forms. Using this machinery we give a short and purely algebraic proof of
the proportionality theorem of Hirzebruch and Mumford. The main motivation was however to
create a theory which can be applied to other compactiﬁed moduli spaces to be able to investigate
“modular forms” on them and their “Fourier-Jacobi expansions” purely algebraically.

Notation
We write [n] for the unordered set {1, . . . , n} and ∆n for the poset {1≤ 2 ⋅ ⋅ ⋅ ≤ n} also regarded as a
category. For a scheme, formal scheme, or stack X we write [ X-Coh ] (or sometimes [ OX-Coh ])
for the category of coherent sheaves on X and [ X-Qcoh ] for the category of quasi-coherent

sheaves. For an algebraic group G we denote by g its Lie algebra.

Contents

1 Introduction

2

2 Toroidal compactiﬁcations

5
5
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1 Formally toroidal schemes
2.2 Modules and diﬀerentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
2.3 Abstract toroidal compactiﬁcations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.4 Toroidal compactiﬁcations of (mixed) Shimura varieties . . . . . . . . . . . . . . . . . . 12

1

3 Automorphic data

12
3.1 Automorphic data on an abstract toroidal compactiﬁcation . . . . . . . . . . . . . . . 12
3.2 Generalized ﬂag varieties and representations of quasi-parabolic subgroups . . . . . . 15
3.3
Jet bundles on generalized ﬂag varieties . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.4 Fourier-Jacobi categories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
3.5
Jet bundles in the Fourier-Jacobi categories . . . . . . . . . . . . . . . . . . . . . . . . . 23
. . . . 25
3.6 Automorphic data on toroidal compactiﬁcations of (mixed) Shimura varieties

4 Hirzebruch-Mumford proportionality

27
4.1 Chern classes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
4.2 Proportionality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

1

Introduction

This article was motivated by the search for an axiomatization of the algebraic structure of toroidal
compactiﬁcations of Shimura varieties and their automorphic vector bundles, which might also be
applied to other moduli spaces (which, for instance, carry certain families of Calabi-Yau threefolds)
to study “modular forms” on them and their “Fourier expansions” and “Fourier-Jacobi expansions”
purely algebraically. While this is the content of work in progress, this article focuses on the axiom-
atization, and explains that the axioms ﬁt the situation for toroidal compactiﬁcations of Shimura
varieties. To show that the language is suﬃciently powerful we distill a few simple axioms that
imply the famous proportionality theorem of of Hirzebruch [6] and Mumford [12], thus providing a
purely algebraic proof thereof.
We now describe the axiomatization more in detail. All varieties and formal schemes are understood
over a ﬁeld k of characteristic zero. We deﬁne a formally toroidal scheme (Deﬁnition 2.1.3) to be
a formal scheme together with an action of Mn
m, where Mm is the multiplicative monoid on the
aﬃne line, which looks like the completion of a (partially) compactiﬁed Gn
m-torsor on a variety
along a boundary stratum. An abstract toroidal compactiﬁcation (Deﬁnition 2.3.2) is deﬁned as a
smooth variety M with a divisor of strict normal crossings D such that the completions along all
strata (of the stratiﬁcation deﬁned by D) carry the structure of a formally toroidal scheme in a
compatible way w.r.t. the partial ordering of the strata. In Section 2.4 we explain that toroidal
compactiﬁcations of mixed Shimura varieties in the sense of Pink [13] indeed give rise to such
objects.
Moreover, we introduce the notion of automorphic data (Deﬁnition 3.1.1) on an abstract toroidal
compactiﬁcation. If D = ∅ this is just the datum of a “compact dual” M ∨ and a “period torsor”
B equipped with morphisms

πo

M

B

p

/ M ∨

where π ∶ B → M is a right-torsor under a reductive group PM and M ∨ a component of the moduli
space of parabolics of PM (a ﬂag variety). The morphism p is PM -equivariant.
This situation is well-known in the theory of Shimura varieties. In this case B is called the standard
principal bundle and is (philosophically) the bundle of trivializations of the de Rham realization
of the universal motive (associated with a representation ρ of the deﬁning group PM ) together
with its natural PM -structure. The morphism p in this case is induced by the Hodge ﬁltration.
If M ∨

The diagram can also be seen as a morphism Ξ ∶ M → [M ∨~PM] to the quotient stack.
contains a k-rational point then the quotient stack is isomorphic to the classifying stack [⋅~QM] of

a parabolic QM ⊂ PM . Therefore the datum is essentially the same as a QM -torsor over M . This

2

o
/
allows to deﬁne a vector bundle Ξ∗E on M associated with any representation E of QM (or with a

PM -equivariant vector bundle on M ∨). These are called automorphic vector bundles.
This situation generalizes to the case in which D is non-trivial.
consist of the following: for any stratum Y a diagram

In this case automorphic data

CY(M)

πo

BY

p

/ M ∨
Y

where CY means formal completion along Y , and π ∶ BY → CY(M) is again a right-torsor under

a — now arbitrary — linear algebraic group PM and M ∨ is a component of the moduli space of
quasi-parabolics of PM . The morphism p is again PM -equivariant. Furthermore the action of MnY
m
lifts to BY (the lifted action is part of the datum) such that p becomes invariant. For any two
strata Z ≤ Y we suppose given an open embedding M ∨
Y and a morphism BZ → BY both
equivariant for a given homomorphism PZ → PY .
Such a datum is present on toroidal compactiﬁcations of Shimura varieties. This is probably
less well-known, and was ﬁrst described in this form in [7] (cf. [8, 2.5]). It exists (philosophically)
because the PM -structure of the de Rham realization of the universal motive becomes a PY -structure
near the boundary stratum Y (in the formal sense) because of a natural weight ﬁltration on the
realization there, leading to a family of mixed Hodge structures.
The more general situation of an (abstract) toroidal compactiﬁcation equipped with automorphic
data allows one to deﬁne generalized automorphic sheaves (Deﬁnition 3.4.3) on M . In the situation
of toroidal compactiﬁcations of (mixed) Shimura varieties these include for instance:

Z ↪ M ∨

• sheaves of sections of automorphic vector bundles with certain vanishing conditions along the

boundary (e.g. bundles of cusp forms, subcanonical extensions, etc.),

• the structure sheaf OD of the boundary or the structure sheaf OY of a closed stratum thereof,

• bundles of Jacobi-forms,

• bundles Ωi(M) and jet bundles of automorphic vector bundles,

• bundles of “almost holomorphic” modular forms.

To deﬁne generalized automorphic sheaves, the category of PM -equivariant vector bundles on M ∨ is
not suﬃcient as input category. For this purpose, we deﬁne an Abelian category, the Fourier-Jacobi
category (Deﬁnition 3.4.1). The objects are speciﬁed by a collection of functors

FY ∶ ZnY →[ [M ∨

Y~PY]-Coh ]

namely they should be left Kan extensions of functors deﬁned on some bounded subregion of ZnY .

for each stratum Y , where nY = codim(Y). These are supposed to fulﬁll a ﬁniteness condition,
In particular, the sheaves FY(v + λei) become constant for suﬃciently large λ and we require that
they are isomorphic to FW(pr(v)) restricted to M ∨
3.4.3 that such a datum {FY} deﬁnes a sheaf Ξ∗({FY}) on M . The essential tool to deﬁne those
to glue Ξ∗({FY}) from sheaves on the various completions. The latter are, by deﬁnition, formally
toroidal, and the functor FY describes the parts of CY(Ξ∗({FY})) of varying weight under GnY

sheaves is the theory of descent on formal/open coverings developed in [9]. This theory enables

Y where W is a larger stratum. It is explained in

m .

Example 1. Let M be the compactiﬁcation of a (ﬁne) moduli space of elliptic curves. There are
only two types of strata: Y = M is the open stratum or Y is a point (a cusp). In the ﬁrst case

3

o
/
PM = GL2 and M ∨ = P1 = PM~QM while in the second case PY = ∗ ∗

1 and M ∨ = A1 = PY~Gm.

The bundle of modular forms of weight k (with “vanishing” order νY ∈ Z at the cusp Y ) is given
by the following input datum:

for the open stratum, where L is the standard one-dimensional representation of weight k of QM ,

and

FM ∶=L⊗k

FY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩

L⊗k A1

0

if v ≥ νY ,
otherwise,

for the cusps.

Example 2. Let M ′ be the universal elliptic curve over a (ﬁne) moduli space of elliptic curves.
Let M the Poincar´e line bundle over M ′ associated with the standard polarization. It is the partial
compactiﬁcation of a Gm-torsor M over M ′. The variety M is a mixed Shimura variety associated
with the group PM = GL2 ⋉W , where W is a Heissenberg group, a central extension of G2
a:

0

/ U ≅ Ga

/ W

/ V ≅ G2
a

/ 0.

(Here GL2 acts on V via the natural 2-dimensional representation and on U via the determinant.)
In this case there is only one boundary stratum Y ≅ M ′ apart from M . Consider the following
input datum:

FM ∶= 0

and

FY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩
L⊗k

0

if v = i,
otherwise.

for L as before, extended (considered as a representation) to the present QM in the only possible

way. The associated generalized automorphic sheaf is then the bundle of Jacobi forms of weight
k and index i (it has support on Y ≅ M ′). Here we completely ignored the behaviour along the
boundary of M ′ for simplicity, which can be achieved by considering a full compactiﬁcation of M
instead.

We ﬁnally consider the notion of (logarithmic) connection on automorphic data, and certain (purely
algebraic) axioms regarding it:

(F) ﬂatness of the logarithmic connection (3.1.2),

(T) inﬁnitesimal Torelli (3.1.3),

(M) unipotent monodromy condition (3.1.4),

(B) boundary vanishing condition (3.1.6).

(These axioms are of course not all expected to hold in this form for generalizations of the theory to
other moduli spaces.) For example (F) and (T) imply that — on the open stratum — the formation
of automorphic vector bundles commutes with the formation of sheaves of diﬀerential forms and
jet bundles (Section 3.3). If (M) holds, even the sheaves of diﬀerential forms and the jet bundles
— on the compactiﬁcation — can be deﬁned as generalized automorphic sheaves (Section 3.5), as
opposed to their logarithmic variants which are always usual automorphic vector bundles. Finally,

4

/
/
/
/
if in addition (B) holds, Hirzebruch-Mumford proportionality holds for the compactiﬁcation (Sec-
tion 4.2). In the compact case (M) and (B) are vacuous, and this becomes much easier. The validity
of the axioms for automorphic data on toroidal compactiﬁcations of (mixed) Shimura varieties is
explained in section 3.6.
We prove the proportionality theorem of Hirzebruch and Mumford in Section 4 in the following
form:

Theorem 4.2.1. Let M be a toroidal compactiﬁcation of dimension n equipped with automorphic
data with logarithmic connection which satisﬁes the axioms (F, T, M, B) and such that PM is
reductive. There is c ∈ Q such that for all polynomials p of degree n in the graded polynomial ring

Q[c1, c2, . . . , cn] and all PM -equivariant vector bundles E in [ [M ∨~PM]-Coh ] the proportionality

p(c1(E), . . . , cn(E)) = c ⋅ p(c1(Ξ∗E), . . . , cn(Ξ∗E))

holds true.

The idea of the proof is as follows. Following Atiyah [2] the polynomials in the Chern classes of

vector bundles can be computed as an element in H n(M , ω) ≅ k, resp. H n(M ∨, ω) ≅ k by a purely

homological algebra construction starting from the extensions

0

/ 0.

(1)

for E and similar extensions for Ξ∗E. This construction works in every Abelian tensor category. It
suﬃces therefore to ﬁnd an Abelian tensor category A which maps via an exact tensor functor to

/ Ω1 ⊗E

/ J 1E

/ E

[ M -Coh ], and [ M ∨-Coh ],

0.

Extn

A(O, ω′) is one-dimensional where ω′ is the pre-image of both ωM and ωM ∨.

respectively, such that an extension like (1) exists in A and maps to the extensions J 1E, and
J 1(Ξ∗E), respectively. Furthermore, this Abelian tensor category has to satisfy the property that
In the compact case the category[ [M ∨~PM]-Coh ] of PM -equivariant vector bundles on M ∨ can be
taken as A. This does not work in general because Ξ∗ωM ∨ = ωM(log) and mostly H n(M , ω(log)) =
In the non-compact case, the Fourier-Jacobi categories can be taken as A. Here the boundary
A(O, ω′) is indeed one-dimensional. (Strictly speaking we only construct the tensor product on

vanishing condition comes into play which, by an easy homological algebra argument, implies that
Extn
a subcategory of “torsion-free” objects in the Fourier-Jacobi-categories and show that Ξ∗ respects
it. For the reasoning above this is however suﬃcient.)
This article would never have been realized without many interesting discussions with Emanuel
Scheidegger, whom I would like to thank very much. Special thanks also to Wolfgang Soergel to
whom I am indebted for his aid.

2 Toroidal compactiﬁcations

2.1 Formally toroidal schemes

Let k be a ﬁeld of characteristic 0, ﬁxed for the whole article. Let Mm be A1 with its
2.1.1.
unital multiplicative monoid structure over k and, as usual, Gm ↪ Mm the open subscheme of the
multiplicative group. Denote by ε the unit of Mm or Gm and by µ the multiplication.

5

/
/
/
/
Let n be a positive integer and let X be a formal scheme over k with an action of Mn
given morphism

m, i.e. with a

such that

Mn
m

× X

ρ

/ X

Mn
m

× Mn
m

× X

µ×id

Mn
m

× X

id ×ρ

ρ

Mn
m

× X

ρ

/ X

is commutative and such that the composition

X

ε×id /

/ Mn
m

× X

ρ

/ X

is the identity.

Lemma 2.1.2. Let X = spf R be an aﬃne formal scheme over k. It is equivalent to give an action
of Mn
≥0-grading on R, i.e. collection of subrings Rv ⊆ R for each
v ∈ Zn

m on X or a (topological) Zn
≥0 such that

1. For all v, w ∈ Zn

≥0, we have

Rv ⋅ Rw ⊆ Rv+w.

2. Each x ∈ R has a unique expression as an inﬁnite converging sum

x = Qv∈Zn

≥0

xv

with xv ∈ Rv.

We denote by e1, . . . , en the standard basis of Zn.

Deﬁnition 2.1.3. A formal scheme X with an action of Mn
is an aﬃne covering by spf R’s such that the action restricts to Mm
n

m is called formally toroidal if there
× spf R → spf R and such that

1. All Rv have the discrete topology.

2. The induced map

has dense image and induces an isomorphism between the completion of R0[Re1 , . . . , Ren] at
the ideal (Re1 , . . . , Ren) and R.

R0[Re1 , . . . , Ren] → R

3. The Rei (and hence by 2. all Rv) are locally free R0-modules of rank 1.

It follows that, up to restricting to a smaller open cover, we have

R ≅ R0Jx1, . . . , xnK

with its natural topological Zn

≥0-grading. The xi however are only determined up to R×
0 .

6

/
/
/




/
/
2.1.4. On a formally toroidal scheme X we also have a ring-sheaf OX0 which locally gives the
R0’s and the OX,v which are coherent OX0-submodules of OX . The topological space X together
with OX,0 is a scheme and it is isomorphic to the categorical quotient (in the category of formal

It is denoted by X0. Furthermore there is an obvious

schemes) of X w.r.t. the action of Mn
m.
section (a closed embedding) X0 ↪ X.

Example 2.1.5. The standard example starts from a Gn
compactiﬁed by glueing in the partial compactiﬁcation Gn
given by the origin of Mn
m.

m-bundle on a variety X which gets partially
m ↪ Mn
m and then completed at the section

2.2 Modules and diﬀerentials

In the following we consider the integers Z as a category via the natural inclusion of posets into
categories. In other words, there is a morphism (and a unique one) n → n′ if and only if n ≤ n′.

Proposition 2.2.1. Let X with action of Mn
equivalent to give

m be a noetherian formally toroidal scheme.

It is

1. a coherent OX -Module M with an extension of the Gn
2. a collection of coherent OX0-modules Mw for w ∈ Zn together with an associative multiplication

m-action (not necessarily the Mn

m-action);

morphism for v ∈ Zn

≥0:

OX,v ⊗OX0

Mw → Mv+w

giving for v = 0 just the module-structure, such that there are N ′, N ∈ Z with the property that
for all w such that wi ≥ N , all i, and v = ei the morphism is an isomorphism and for all w
such that some wi < N ′ the module Mw is zero;

3. a functor with values in OX0-coherent sheaves

M ∶ Zn → [ OX0-Coh ]

v ↦ M(v)

a functor ∆n

such that there are N, N ′ ∈ Z with the property that for all i and for all w with wi ≥ N the

N −N ′ →[ OX0-Coh ] where ∆N −N ′ is considered as an interval [N ′, N] ⊂ Z.

morphism M(w → w + ei) is an isomorphism and for all w such that wi < N ′ for some i the
module M(w) is zero. In other words the functor is isomorphic to the left Kan extension of
Proof (sketch). 1 ↔ 2: Given a module M the associated Mv is just the OX0-submodule of elements
2 ↔ 3: A collection Mv is associated with the functor v ↦ M(v) ∶= Mv ⊗OX,−v. Here OX,v for
arbitrary v ∈ Zn is deﬁned by ࣹiO⊗αi

transforming with weight v under Gn
modules Mv.

m. Conversely, the module M is given as the product of the

for v =∑ αiei.

And a morphism v → w in Zn is mapped to the morphism

X,ei

induced by

Mv ⊗OX,0 OX,−v → Mw ⊗OX,0 OX,−w

OX,w−v ⊗OX,0 Mv → Mw.

The functoriality of the functor M is equivalent to the associativity of the multiplication on the
module M .

7

Deﬁnition 2.2.2. Let X with an action of Mn

m be a noetherian formally toroidal scheme. Coherent
m-action as in Proposition 2.2.1 form an Abelian category which we

OX -modules with compatible Gn
denote by [ OX-TCoh ].
Lemma 2.2.3. Under the correspondence above, we have M(v) are torsion-free OX,0-modules and
M(v → w) are monomorphisms for all v ≤ w, if and only if M is torsion-free.
Remark 2.2.4. We deﬁne the full subcategory Fun(Zn,[ OX0-Coh ])f.g. of Fun(Zn,[ OX0-Coh ])

as those functors M which are bounded below and have the property stated in Proposition 2.2.1, 3.
Hence we have an equivalence

[ OX -TCoh ] ≅ Fun(Zn,[ OX0-Coh ])f.g..

2.2.5. Let M be a coherent sheaf on X with a compatible action of Gn

functor M ∶ Zn → [ OX0-Coh ]. As said, there is an N such that M(∑ αiei) is (essentially)
constant in αi if αi > N . We denote this sheaf by limα→∞ M(v + αei). Note that also expressions
like limα1→∞,...,αj →∞ M(v +α1ei1
+⋯ +αjeij) do make sense (up to isomorphism). Given an injection
β ∶ [j] ↪ [n] we will regard this construction w.r.t to the missing indices in the image of β as a

m. We have its associated

functor

∶ Fun(Zn,[ OX0 -Coh ])f.g. → Fun(Zj ,[ OX0-Coh ])f.g..

lim
β

We just write “lim” for this construction w.r.t. all indices.

For coherent, torsion-free sheaves M and N we can describe the tensor product M ⊗ N

2.2.6.
with its natural Mn

m action by the functor

M ⊗ N(v) = Qv1+v2 =v

M(v1) ⊗ N(v2)

where the sum is formed in (lim M) ⊗(lim N).
2.2.7. For any injection β ∶[j] ↪[n] deﬁne a sheaf OX[β−1] as the sheaﬁﬁcation of the pre-sheaf,

deﬁned (for small enough U ) by

U ↦OX(U)[x−1

β(j)]
β(1), . . . , x−1

m-action we may still associate (in the same way as in Proposition 2.2.1)

where the xi are generators of OX,ei. To a coherent (in the sense of modules on ringed spaces)
OX[β−1]-module with Gn
a functor in Fun(Zn,[ OX0-Coh ]). This yields a fully-faithful functor
[ OX[β−1]-TCoh ] → Fun(Zn,[ OX0-Coh ]
Let β⊥ ∶[n − j] ↪[n] be a (to β) complementary injection. The diagram

which has the property that the functors in the image are constant in the direction of the eβ(i).

[ OX -TCoh ]

[ OX0[β−1]-TCoh ]

Fun(Zn,[ OX0-Coh ])f.g.

limβ⊥

/ Fun(Zn−j,[ OX0-Coh ])f.g.

p∗
β⊥

/ Fun(Zn,[ OX0-Coh ])

is commutative. Here p∗

β⊥ is the pullback induced by the projection pβ⊥ ∶ Zn → Zn−j induced by
β⊥. The sheaf OX[β−1] can be completed afterwards w.r.t. any of the ideals generated by OX,ei for

8

/
/




/
/
i~∈ im(β). This process might be repeated. Any sheaf R of OX-algebras so obtained (which carries

still an action of Gn

m) still yields a fully-faithful functor

[ R-TCoh ] → Fun(Zn,[ OX0-Coh ])

whose image in contained in those functors which are constant in the direction of the eβ(i) for those
i such that (locally) a generator Xi has been inverted. An inverse functor on the essential image
might be quite complicated to describe. It is given as a subset of the inﬁnite product that was
considered in Proposition 2.2.1 but the sequences might be e.g. bounded below in some direction,
point-wise w.r.t. another direction. Since we will not need it we will not elaborate on this.
A Gn

[n]]-Module M is equivalent to just an OX0-module via M ↦
M(0). Each OX0-module M0 in turn has a canonical extension to an OX -Module with Mn

m-equivariant coherent OX[id−1

m-

action, given by means of the functor

M0(v) =

M0
0

if v ∈ Zn
≥0,
otherwise,

⎧⎪⎪⎨⎪⎪⎩

or equivalently by M ∶= M0 ⊗OX,0 OX with its natural Mn
of [ OX -TCoh ] consisting of canonical extensions by [ OX -TCoh-can ].

We have a morphism ‘constant term’ of functors:

m-action. We denote the full subcategory

c.t. ∶ M ⊗OX OX[β−1] → lim

β

M.

2.2.8.
sheaves on X:

There is the following exact sequence (equivariant w.r.t. the action of Mn

m) of coherent

0

/ ΩX0

/ ΩX

⊗OX0 OX

/ ∑iOX,ei

⊗OX0 OX

/ 0

⊗OX0OX is isomorphic to the bundle ΩX X0. ΩX is not a canonical extension. There
where ∑iOX,ei
is the larger bundle ΩX(log) which is locally generated by ΩX and by the rational diﬀerentials d xi
Consider the Atiyah extensions on X0 associated with the line bundles OX,ei

.
m. We proceed to describe the associated functors

m-equivariant vector bundles ΩX and ΩX(log).

The latter are invariant under the action of Mn
of the Mn

xi

and their amalgamed sum

0

/ ΩX0

pi

/ Ei

0

/ ΩX0

ࣷ pi /

/ E

/ OX0

/ ࣷiOX0

/ 0

/ 0

(2)

Then ΩX(log) is just the canonical extension of E, i.e. it is given by the functor

ΩX(log)(v) =

E if v ≥ 0,
0

otherwise.

⎧⎪⎪⎨⎪⎪⎩

Proposition 2.2.9. The functor associated with ΩX is given by

ΩX(v) =
as a subfunctor of ΩX(log).

⎧⎪⎪⎨⎪⎪⎩

{e ∈ E   pi(e) = 0 ∀i ∶ αi = 0}

0

if v =∑ αiei ≥ 0,

otherwise,

9

/
/
/
/
/
/
/
/
/
/
/
2.3 Abstract toroidal compactiﬁcations

Let M be a smooth k-variety. Consider an open embedding M ↪ M into a smooth
2.3.1.
k-variety (which will mostly assumed to be proper), such that D ∶= M ∖ M is a divisor with strict

that all components of D are closures of a stratum in the ﬁnite set S. M itself will be the unique
open stratum. Let nY be the codimension of Y . Consider furthermore a formally toroidal action ρY
of MnY
subscheme X0. For a pair of strata Y, Z we write Z ≤ Y if Z ⊂ Y .

normal crossings. Consider the coarsest statiﬁcation M = ⋃Y ∈S Y into locally closed subsets such
m on the formal completion X = CY(M) of M along Y which establishes Y as the invariant
Deﬁnition 2.3.2. The embedding M ↪ M together with the collection {ρY}Y is called a (partial,
map βZY ∶[nY] ↪[nZ] such that the natural morphism of formal schemes

if M is not proper) toroidal compactiﬁcation if for each pair Z ≤ Y of strata we have an injective

is equivariant w.r.t. the action of MnY

CZ(M)
m , where MnY

/ CY(M)
m acts via βZY and ρZ on CZ(M).

Remark 2.3.3. The map βZY is uniquely determined by the condition in the deﬁnition and hence
for strata W ≤ Z ≤ Y we have βW Z βZY = βW Y .

canonical extensions, however.

m -action whose completions are all canonical extensions (2.2.7).

patible GnY
those sheaves with compatible GnY

We will regard objects on M such as coherent sheaves etc. always with a compatible action of the
GnY

m -actions on the various completions. It has a full subcategory [ O

m (not necessarily MnY
Deﬁnition 2.3.4. In particular, we have a category [ O

m ) on their completion on CY(M) for all strata Y in a compatible way.
M -TCoh ] of coherent sheaves with com-
M -TCoh-can ] of
For example Ωi(M), T(M) and O
M -TCoh ]. The former two are no
2.3.5. Each closed stratum Y is itself a (partial) toroidal compactiﬁcation. The completion CZ(Y)
is the following formal subscheme of CZ(M). It is in local coordinates given by R0JRei, . . . , RenZ
K
modulo the ideal generated by Reβ(1), . . . , Reβ(nY ) (where β = βZY ). It carries an action of GnZ−nY
.
Here the missing indices not in the image of β can be numbered in any way. We denote the corre-
∶[nZ −nY] ↪[nW −nY]
sponding injective map by β⊥
ZY
of the transition maps βW Z for W ≤ Z ≤ Y the scheme Y becomes a toroidal compactiﬁcation. The
following commutative diagram shows the compatibility of the chosen numberings:

∶[nZ −nY] ↪[nZ]. With the restriction β′

M and are sheaves in [ O

m

W Z

[nZ − nY] 
[nZ] 

β⊥

ZY

 β′

W Z /

βW Z

[nW − nY]
/ [nW]

β⊥

W Y

Lemma 2.3.6. Let E be a coherent sheaf on M with compatible GnY

completion EY on CY(M). Then for any stratum Z ≤ Y and v ∈ ZnY we have that

m -action on the respective

EY(v)

is the coherent sheaf on Y which (w.r.t. to the restricted structure of toroidal compactiﬁcation of
2.3.5) corresponds to the functor w.r.t. Z:

z ↦ EZ(βZY(v) + β⊥

ZY(z)).

10

/
/

_



_



/
Lemma 2.3.7 (Glueing lemma). Consider for each stratum Y be a functor

FY ∶ ZnY →[ Y -TCoh-can ]

which satisﬁes the conditions of Proposition 2.2.1, 3., where [ Y -TCoh-can ] is the category of

toroidal coherent sheaves on Y which are canonical extensions (see 2.3.4). Consider for all Z ≤ Y
an isomorphism of functors

κZY ∶ ι∗

ZY FY

∼

Ð→ lim
βZY

FZ

(3)

which are compatible w.r.t. Y ≤ Z ≤ W in the obvious way. Here ιZY ∶ CZ(M) → CY(M) is the
m on CY(E) for all Y ,

natural morphism of formal schemes.
Then there exists a coherent sheaf E on M with compatible actions of GnY
such that there are isomorphisms of functors

which are compatible with the functors κZY in the sense that for all v ∈ Z nY the diagram

λY ∶ CY(E)(v) Y ≅ FY(v) Y
FY(v)

CY(E) Y(v)

λY

CZ(E)[β−1

ZY](v)

λZ

(limβZY FZ)(v)

κZY

(4)

is commutative.
determined (up to unique isomorphism) by this property and the isomorphisms κ.

In particular E is isomorphic to FM on the open stratum M . E is uniquely

M -algebras RY of [loc. cit.] are isomorphic

Proof. We apply [9, Main theorem 7.6]. The sheaves of O

to the restriction of the sheaf CY(OX) to any open subset U ⊂ M such that U ∩ Y = Y . We write as
usual CY(OX) Y for this sheaf. All ring sheaves are considered on the topological space underlying

M . Note that they are not quasi-coherent as OX -modules, except for the open stratum M itself.
For any pair of strata Z ≤ Y the sheaf of O

product is formed in the category of ring sheaves. The sheaf of O

to CY(RZ ⊗OM
also isomorphic to a completion of the localization CZ(OX)[β−1
coordinates in CZ(OX) by the zero locus of xβ(1), . . . , xβ(nY ) for β = βZY .

OU) where U is any open subset such that U ∩ Y = Y and where the tensor
OU) is
Y Z] since Y is given in formal local

M -algebras CY(RZ ⊗OM

M -algebras RY,Z of [loc. cit.]

is, by deﬁnition, equal

By the nature of toroidal compactiﬁcation of M we have an action of GnY
GnZ

m on RY,Z which are compatible (via βZY ) with the inclusion

m on RY and an action of

RY ↪ RY,Z.

The category of RY -coherent sheaves with GnY

m -action is equivalent to the category

Hence the given collection of functors {FY}Y gives such objects by restricting FY to Y .

From the category of RY,Z-coherent sheaves with GnZ
into the sub-category of

m -action we have still a fully-faithful embedding

consisting of functors which are constant in the directions ei for i ~∈ im(βZY). For each Z ≤ Y
M -modules which is by construction an object in [ O

we get such an object taking limβZY FZ . The glueing datum required by [loc. cit.] can therefore
be given by diagram (4). Hence, by the main theorem of [loc. cit.], we get the requested sheaf of
O

M -TCoh ].

Fun(ZnY ,[ OY -TCoh ])f.g..

Fun(ZnZ ,[ OZ -TCoh ])

11







_
?
o
o
o
o
2.4 Toroidal compactiﬁcations of (mixed) Shimura varieties

2.4.1. The standard examples of abstract toroidal compactiﬁcations in the sense of Deﬁnition 2.3.2
are toroidal compactiﬁcations of Shimura varieties [1]. Since we are interested only in the situation
over a ﬁeld, we can use the theory of canonical models of toroidal compactiﬁcations of mixed
Shimura varieties due to Pink [13, 2.1] which has been extended in [7] (cf. also [8, 2.5]) to the
integral (good reduction) case. For the automorphic data referred to in the next section we rely on
[8, 2.5] also for the rational case. In that case the ideas for the proofs of the theorems in [8, 2.5.]
(which are given in [7]) are essentially due to Harris [3–5].

2.4.2.

Furthermore for each smooth K-admissible rational polyhedral cone decomposition ∆ for X (cf. [8,

For each pure (or mixed) rational Shimura datum X = (PX, DX, hX) in the sense of [8,
2.2.3]1 or [13, 2.1], and for each suﬃciently small compact open subgroup K ⊂ PX(A(∞)) there is
an associated Shimura variety M(K X) which is a smooth quasi-projective variety deﬁned over the
reﬂex ﬁeld E(X).
∆ X) which contains M(K X) as an open
2.2.23]) there is a (partial) toroidal compactiﬁcation M(K
∆ X) is a smooth projective variety deﬁned over the reﬂex ﬁeld
projective and complete then M(K
∆ X) as considered in 2.3.1. Each
E(X). This situation thus gives rise to a stratiﬁcation of M(K
this stratiﬁcation there is a mixed Shimura datum BY = (PBY , DBY , hBY) such that PBY is a

subvariety whose complement is a divisor with strict normal crossings. This and the following
is a summary of [8, Main Theorem 2.5.9]).
If ∆ is chosen (and this is always possible) to be

stratum corresponds furthermore to a rational polyhedral cone in ∆. For each stratum Y in

subgroup of PX (actually this is a certain normal subgroup of the Q-parabolic of PX describing the
corresponding boundary component in the Baily-Borel compactiﬁcation). BY is determined only
up to conjugation. Furthermore, ∆ restricts to a rational polyhedral cone decomposition ∆Y for

BY . The partial toroidal compactiﬁcation of the mixed Shimura variety M(KY
stratum ̃Y and there is an isomorphism of formal schemes (assuming that K is small enough)

BY) has a matching

∆Y

CY M(K

∆ X) ≅ C̃Y

M(KY

∆Y

BY).

Furthermore the mixed Shimura variety M(KY BY) is a torus torsor over another mixed Shimura
variety M(K ′
Y BY~U) where U is a subgroup of UBY (the center of the unipotent radical of PBY )
BY) (cf. [8, 2.5.8]). The acting torus gets identiﬁed
and the action of the torus extends to M(KY
BY) becomes a formally toroidal scheme in the sense of 2.1.3. The functoriality of the
∆ X) is

with GnY
By construction of the toroidal compactiﬁcation this action extends to MnY
C̃Y
theory implies that the actions of the tori match for pairs of strata Z ≤ Y . Thus M ∶= M(K

m by means of the basis of the nY -dimensional rational polyhedral cone describing Y .
m in such a way that

an abstract toroidal compactiﬁcation in the sense of Deﬁnition 2.3.2.

M(KY

∆Y

∆Y

3 Automorphic data

3.1 Automorphic data on an abstract toroidal compactiﬁcation

Let M be an abstract toroidal compactiﬁcation (Deﬁnition 2.3.2).

Deﬁnition 3.1.1. Automorphic data on the toroidal compactiﬁcation M consists of a collection

{PY , M ∨

Y , BY , . . .}Y indexed by the strata Y of M where

1where the integrality property has to be ignored.

12

1. PY is a linear algebraic group (not necessarily reductive).

2. M ∨

Y is an open and closed subscheme of the moduli space of quasi-parabolic subschemes of
PY . We will call these spaces generalized ﬂag varieties. If PY is reductive then they are
projective. We consider the action of PY on M ∨

Y as a right-action.

3. We are given a diagram

CY(M)

πo

BY

p

/ M ∨
Y

in which π is a right PY -torsor and p is a PY -equivariant map.

4. We are given a lift of the MnY

m -action to BY in a PY -equivariant way, and p is MnY

m -invariant.
We assume that BY is a canonical extension, i.e. isomorphic to Π−1BY for some bundle on
Y with its induced MnY
m -action, where Π ∶ CY M → Y is the projection. (Such a datum is
basically equivalent to a QY -principal bundle on Y where QY corresponds to a k-rational
point of M ∨ if it exists.)

For strata Z ≤ Y we suppose given closed embeddings of algebraic groups αZY ∶ PZ ↪ PY which
Z ↪ M ∨
induce open embeddings M ∨
m -equivariant morphisms BZ → BY such
that the diagram of formal schemes

Y and given PZ - and MnY

CZ(M)

CY(M)

πo

BZ

πo

BY

p

p

/ M ∨
Z

/ M ∨
Y

commutes. The morphisms have to be functorial w.r.t. three strata W ≤ Z ≤ Y .
In other words, if M ∨ contains a k-rational point QM , automorphic data is roughly given by a QM -
principal bundle BM on M such that the structure group restricts to QY on the formal completion
along Y in an MnY
3.1.2. Consider the following sequence of vector bundles on BY (which are all MnY
n -equivariant
and canonical extensions). We assume given a logarithmic Ehresmann connection on BY , i.e. a
section sY which is PY -invariant and MnY

m -equivariant way. Here QY is any parabolic in M ∨

Y(k).

n -equivariant:

0

/ OBY

⊗ gY = T π−vert

BY

/ TB(log)

sY

/ π∗TCY (M)(log)

/ 0.

Since everything is MnY
of the sequence

n -equivariant and a canonical extension, this is equivalent to give a section

0

/ OBY  Y

⊗ gY = T π−vert

BY  Y

s′
Y

/ TB(log) Y

/ π∗TCY (M)(log) Y

/ 0.

Furthermore these sections are supposed to be compatible w.r.t. the relation Z ≤ Y on strata.
Such a datum will be called automorphic data with logarithmic connection on the toroidal
compactiﬁcation M .
We deﬁne the PY -sub vector bundle T horz
sition:

as the image of sY , and get a PY -equivariant decompo-

BY

We say that the connection is ﬂat, if

TBY(log) = T π−vert

BY

⊕ T horz

BY

.

13

o
/


o


/
_


o
/
/
/
/
s
s
/
/
/
/
r
r
/
(F) T horz

BY

is closed under the Lie bracket.

We call P vert
morphism of ring-sheaves

and P horz

π

π

the corresponding projection operators. If sY is ﬂat, it induces a homo-

ν ∶ π−1DMY(log) → DBY(log).

(5)

(6)

3.1.3. We say that the automorphic data satisﬁes Torelli2, if we have in addition

(T) a direct sum decomposition

TBY(log) = T p−vert
(log) is the intersection of T p−vert

(log) ⊕ T horz
with TBY(log) in TBY .

BY

BY

BY

where T p−vert

BY

and P horz
We then denote by P vert
Torelli (T) induces an isomorphism

p

p

the corresponding projection operators.

p∗TM ∨ ≅ π∗TM(log).

In the same way, if sY is ﬂat and Torelli holds, we also get a homomorphism of ring-sheaves

µ ∶ p−1DM ∨

Y

→ DBY(log).

3.1.4.
sequence (2)

Note that, by the structure of toroidal compactiﬁcation, we have a sequence dual to

0

/ ࣷnY

i=1

O

CY (M)

⋅ cani,M

/ TCY (M)(log)

/ Π∗TY

/ 0

where cani,M are the fundamental vector ﬁelds for the GnY
to Y .
We also consider the following compatibility axiom (called the unipotent monodromy condi-
tion)

m -action on M , and Π is the projection

(M) We have P vert

π

dimensional normal unipotent subgroup Ga ≅ U (i) ⊂ PY .

(cani,BY) ∈ u

(i)
Y

(i)
⊗ OBY , where u
Y

is a sub-Lie-algebra of pY given by a 1-

Axiom (M) has the following immediate consequence:

Lemma 3.1.5. We have p(P vert
where T (i)
normal unipotent subgroup Ga ≅ U (i) ⊂ PY .

(cani,BY)) ∈ p∗T

M ∨ is the subbundle of TM ∨ induced by a subalgebra u

M ∨ (or equivalently p(P horz

(i)
M ∨),
(i)
Y of pY given by a 1-dimensional

(cani,BY)) ∈ p∗T

(i)

π

π

3.1.6. We also consider the following axiom (called the boundary vanishing condition):

(B) For all strata Y ~= M we have: H i([M ∨

Y~PY] , ωM ∨

Y) = 0 for i ≥ dim(Y).

(cf. Section 3.2 for the notation). Here ωM ∨
of diﬀerential forms on M ∨
Y .

Y

= Ωn

M ∨
Y

is the highest power of the PY -equivariant sheaf

2this rather corresponds to classical inﬁnitesimal Torelli theorems

14

/
/
/
/
3.2 Generalized ﬂag varieties and representations of quasi-parabolic subgroups

3.2.1. For a linear algebraic group P and a quasi-parabolic subgroup Q we have several functors
between Q-representations, P -representations and (equivariant) coherent sheaves on the quasi-

projective variety M ∨ = QƒP (generalized ﬂag variety)3. These functors are best understood in

the language of Artin stacks. We will not use this theory explicitly but mention it as a guiding
principle because it so much clariﬁes the relations. All representations are, of course, understood
to be algebraic. We have the following diagram of morphisms of Artin stacks where all stacks are
quotient stacks (even schemes in the right-most column):

[⋅~Q]

a
∼

/ [M ∨~P]
[⋅~P]

b

c

M ∨

d

f

e

. spec(k)

(7)

We denote the categories of (quasi-)coherent sheaves on a stack X by [ X-(Q)Coh ] or sometimes
by [ OX -(Q)Coh ]. For the particular stacks above, we get

[ [⋅~Q]-Coh ]
[ [⋅~P]-Coh ]
[ [M ∨~P]-Coh ]
[ M ∨-Coh ]
[ spec(k)-Coh ]

category of ﬁnite-dimensional algebraic Q-representations in k-vector spaces;
category of ﬁnite-dimensional algebraic P -representations in k-vector spaces;
category P -equivariant ﬁnite dimensional vector bundles on M ∨;
category of coherent sheaves on M ∨;
category of ﬁnite-dimensional k-vector spaces,

and similarly for the categories of quasi-coherent sheaves.
The corresponding pull-back and (derived) push-forward functors between the categories of (quasi-)coherent
sheaves are given as follows.

a∗ associates with a Q-representation V a locally free P -equivariant sheaf on M ∨. The total

space can be described as (V × P)~Q where Q acts on V and P . It deﬁnes an equivalence of

the category of ﬁnite-dimensional Q-representations and coherent P -equivariant sheaves on
M ∨.

a∗ is the inverse of a∗, evaluation at the choosen base point of M ∨.

b∗ global sections on M ∨, remembering the induced P -action. The right derived functors are

cohomology on M ∨ equipped with the induced P -action.

b∗ associates with a P -representation V the coherent sheaf V ⊗ OM ∨ with the natural P -action.

c∗ forgets the P -action.

d∗ global sections on M ∨. The right derived functors are the cohomology on M ∨.

d∗ associates with a vector space V the coherent sheaf V ⊗ OM ∨.

e∗ induction IndP

e (−), associates with a vector space V the P -representation V ⊗ O(P).

e∗ forgets the P -action.

3Hence, in contrast to the last section, we explicitly assume for simplicity that M ∨ has a k-rational point with

corresponding quasi-parabolic Q.

15

/




o
o
.
n
n
f∗ associates with a P -representation the vector space of P -invariants. This functor is exact if
P is reductive. Otherwise the right derived functors are the (Hochschild) group cohomology
of P with values in the respective representation.

f ∗ equips a vector space V with the trivial P -representation.

The composed functor a∗b∗ is the forgetful functor considering a P -representation as a Q-representation.
Q(−) but it is not exact in
Its right adjoint, the composed functor b∗a∗, is therefore also called IndP
general.
For a stack X, we denote by H i(X, E) the higher derived functors of π∗ evaluated at E, where π
is the structural morphism. For example H i([⋅~P] , E) denotes the (Hochschild) cohomology of P

with values in the representation E.
We will use the following Lemma and its obvious consequences when one of the functors is exact
without further mentioning.

Lemma 3.2.2. For all compositions of push-forward functors along morphisms of Artin stacks we
have corresponding Grothendieck spectral sequences of composed functors.

Proof. See e.g. [10] for elementary statements regarding the stacks appearing in this section.

3.3 Jet bundles on generalized ﬂag varieties

3.3.1. We start with a general discussion of jet bundles and diﬀerential operators. Let X be a
smooth k-variety and X(n) the n-th diagonal, i.e.

where J is the ideal sheaf of the diagonal. Let E be a vector bundle on X.
We have the two projections:

X(n) ∶= OX×X~J n

X
One deﬁnes the n-th jet bundle J nE by

pr1

|③③③③③③③③③

X(n)

pr2

"❉❉❉❉❉❉❉❉❉

X

which is always equipped with a surjective map

J nE → E,

J nE = pr1,∗ pr∗

2 E

induced by the unit E → ∆∗∆∗E. Since OX (n) = pr∗
map in the case E = O:

1 OX = pr∗

2 OX there is also a splitting of this

O → J nO.

3.3.2. For two vector bundles E and F the sheaf of diﬀerential operators (of degree ≤ n) is deﬁned
as

D≤n(E, F) ∶= HOMOX(J nE, F).

The bundle J nE has also a diﬀerent OX -module structure coming from pr2, which we denote as an
action on the right. We have

where the tensor-product is formed w.r.t. this second OX-module structure.

J nOX ⊗ E ≅ J nE

16

"
|
into the sheaf of k-linear morphisms of sheaves (but not OX -linear). For an open subset U ⊂ X, a

3.3.3. There is an inclusion

D≤n(E, F) ↪ HOMk(E, F)

section s ∈ H 0(U, E) here is considered to be a morphism

and the composition

OU → EU

OU → pr1,∗ pr∗

1 OU = pr1,∗ pr∗

2 OU → pr1,∗ pr∗

2 E = J nE

yields a section in H 0(U, J nE) and then, via application of an element of H 0(U, HOM(J nE, F))
a section in H 0(U, F). The second OX-module structure on J nE here dualizes to pre-composition

with a section of OX . We write D≤n
X is generated
X
by OX and TX with the only relations coming from the Lie bracket of vector ﬁelds and diﬀerentiation
of functions.
Similarly to the case of jet bundles, we have

∶= D≤n(OX , OX). The ring sheaf DX ∶= colimn D≤n

D≤n(E, O) = D≤n

X

⊗ E ∗

where the tensor product is formed w.r.t. the right-OX -module structure.

3.3.4.
(compatible with the ﬁltration by degree):

In the special case X = G, where G is an algebraic group, we have a natural isomorphism

DG = colimn D≤n
G

= OG ⊗ U(g).

Elements of g are considered to be vector ﬁelds using the action by left-translation. They are
invariant under the action of G on G by right-translation. The isomorphism is hence G-equivariant
under right-translation, where G acts on the right hand side only on OG. It is G-equivariant under
left-translation if G on the right hand side acts on OG by left translation and via Ad on g.

3.3.5. We now consider the special case X = QƒP , where Q is a quasi-parabolic subgroup of P .
Y in the last section. Hence we assume that M ∨

These are the generalized ﬂag varieties, denoted M ∨
has a k-rational point Q in the sequel.

Proposition 3.3.6. Let E be a P -representation and

the corresponding P -equivariant vector bundle on QƒP . Then we have

D(E ∗, O) = Qƒ(P × U(p) ⊗U(q) E)

where Q acts on U(p) via Ad and on E via the given representation.
Proof. A section on U ⊂ QƒP of the bundle Qƒ(P × U(p) ⊗U(q) E) can be considered as a Q-
invariant section s on π−1U of the constant bundle U(p) ⊗U(q) E. Such sections act on the space
H 0(U, E ∗) = H 0(π−1U, E∗)Q as follows: Let f ∈ H 0(π−1U, E∗)Q. A tensor s = g(X ⊗ v) acts as

E = Qƒ(P × E)

f ↦ g(Xv(f)).

In local coordinates one checks that this induces an isomorphism with the appropriate sheaf of
diﬀerential operators.

17

Deﬁnition 3.3.7. We deﬁne

J nE ∶=((U(p) ⊗U(q) E∗)≤n)∗.

Corollary 3.3.8 (to Proposition 3.3.6). The PY -equivariant sheaf on M ∨
representation J nE is J nE.

Y associated with the

3.3.9. There is a logarithmic version of the sheaves of diﬀerential operators deﬁned in the last
section. Let X = M be a smooth k-variety equipped with a divisor with normal crossings. We
deﬁne

as the subsheaf of diﬀerential operators generated by vector ﬁelds in TX(log). Wet set

D≤n(E, F)(log) ⊂ D≤n(E, F)
logE ∶= D≤n(E, OX)(log)∨.

J n

The following theorem was shown in [4] for the case of Shimura varieties.

vector bundle on M . Then the automorphic vector bundle associated with J nV is precisely J n
log

Theorem 3.3.10. Let V be a representation of QM , and V ∶= Ξ∗̃V the corresponding automorphic
Proof. Let ̃V denote the bundle Qƒ(V × P) on QƒP . It suﬃces to show, dually, that the auto-
morphic vector bundle associated with the P -equivariant vector bundle D≤n(̃V ∗, O) on QƒP is
D≤n(log)(V ∗, O).

Let Y be a stratum. For the proof it suﬃces to take Y = M , however, we will need the more
reﬁned discussion later. There are PY -equivariant homomorphisms of ring sheaves (which respect
the ﬁltrations by degree), cf. (3.1.2–3.1.3):

V.

µ ∶ π−1DMY(log) → DBY(log)
→ DBY(log)

ν ∶ p−1DM ∨

Y

given by the ﬂat connection sY (and the Torelli axiom). They are compatible with the left- and
right-module structure under p−1OM ∨
⋅ ν(D≤n

, resp. π−1OMY . Furthermore, we have
Y) = Dhorz

MY(log)),
is the sub-ring sheaf of DBY generated by OBY and T horz

⋅ µ(D≤n

= OBY

OBY

where Dhorz
BY

M ∨

BY

BY

.

Y

The bundle D≤n(̃V , O) on M ∨

Y is isomorphic to

D≤n
M ∨
Y

⊗OM ∨

Y ̃V ∗

where the tensor product has been formed w.r.t. the OM ∨
Furthermore, we have a PY -equivariant isomorphism:

Y

-right-module structure on D≤n
M ∨
Y

.

(Lemma 3.3.11 below). Now, PY acts on OBY

p∗(D≤n

M ∨
Y

⊗OM ∨

Y ̃V) ≅ OBY

⋅ µ(D≤n
MY(log)) ⊗OBY
MY(log)) exclusively on the ﬁrst factor, i.e.
⋅ µ(D≤n

p∗̃V

(OBY

⋅ µ(D≤n

MY(log)))PY ≅ D≤n

MY(log)

using the identiﬁcation of PY -invariant sections of a PY -bundle on BY with the sections of a vector
bundle on MY . Conclusion:

(p∗(D≤n

M ∨
Y

⊗OM ∨

Y ̃V))PY ≅ D≤n

MY(log) ⊗OMY (p∗̃V)PY .

18

Lemma 3.3.11. The submodule OBY
we have:

M ∨

⋅ ν(D≤n
Y ̃V) ≅(OBY

p∗(D≤n

M ∨
Y

⊗OM ∨

Y) of DBY(log) is also a right-OBY -submodule, and

⋅ ν(D≤n

Y)) ⊗OBY

M ∨

p∗̃V

where the tensor product in both cases is formed w.r.t. the right-module structure.

Proof. This follows by induction on the degree from the fact that ν is compatible with the right-
p−1OM ∨

-module structure.

Y

3.4 Fourier-Jacobi categories

Deﬁnition 3.4.1. Let M be a toroidal compactiﬁcation equipped with automorphic data. We deﬁne

the Fourier-Jacobi category [ M -FJ ] of M . The objects are collections of functors

FY ∶ ZnY →[ [M ∨

Y~PY]-Qcoh ]

for each stratum Y , satisfying the following conditions:

1. For each j there is an N ∈ Z such that for all v with vj ≥ N the objects

do not depend on vj and for all v ≤ v′ with vj, v′
j

≥ N the morphisms

FY(v)

FY(v → v′)

do not depend on vj and are identities if vi = v′
isomorphic to a left Kan extension of a functor ZnY
≤N

i for all i ~= j. In other words, the FY are
We denote the respective constant value by limλ→∞ FY(v + λej). Note that also expressions
like limλ1,λ2→∞ FY(v + λ1ej + λ2ek) etc. make sense.
2. For all Z ≤ Y with corresponding map βZY ∶[nY] ↪[nZ] and morphism αZY ∶ PZ → PY there

Y~PY]-Qcoh ]4.

→[ [M ∨

is an isomorphism:

µZY(v) ∶ α∗

ZY FY(v) ∼

Ð→

lim
λk1 ,...,λkl

→∞

FZ(βZY(v) + λk1 ek1

+ ⋯ + λklekl)

for all v ∈ ZnY . Here {k1, . . . , kl} is the complement of im(βZY). These isomorphisms are

supposed to be natural transformations of functors in v and to be functorial w.r.t. three strata
W ≤ Y ≤ Z.

The morphisms in the category [ M -FJ ] are collections of morphisms of functors {FY → F ′
Y}Y
for all strata which are compatible with the isomorphisms µZY(v).
In the same way, we deﬁne categories [ Y -FJ ], where the objects only consist of functors FZ for
Z ≤ Y . We also deﬁne [ Y -FJ ], whose objects are just functors FY satisfying property 1. All

Fourier-Jacobi categories are Abelian categories.

4This would rather only say that the FY become constant up to isomorphism, but there is no harm in requiring

that they are actually constant.

19

Deﬁnition 3.4.2. We deﬁne the following full subcategories of the Fourier-Jacobi categories:

1. [ M -FJ-≥ ]: We ask in addition that for each stratum Y there is an N ∈ Z such that

FY(v) = 0
n →[ [M ∨

for all Y and v. Such elements shall be called coherent.

considered as an interval [N, N + n] ⊂ Z.

if some vj < N . Such elements shall be called bounded below. It means that FY is actually
a left Kan extension from a functor ∆nY

Y~PY]-Qcoh ] for some n ∈ N, where ∆n is
2. [ M -FJ-coh ]: As before but with the additional condition that FY(v) is ﬁnite dimensional
3. [ M -FJ-≥ N ], [ M -FJ-≥ N -coh ]: As before but with ﬁxed N .
4. [ M -FJ-tf ]: All bounded-below objects, such that in addition for all v ≤ w, the morphism
5. [ M -FJ-lf ]: All torsions-free objects, such that for a diagram

FY(v) → FY(w) is a monomorphism. Such elements shall be called torsion-free.

the corresponding diagrams

v

v + ei

v + ej

/ v + ei + ej

FY(v)
FY(v + ej)

FY(v + ei)
/ FY(v + ei + ej)

are Cartesian. Such elements shall be called locally free.

6. [ M -FJ-lf-coh ]: All locally free and coherent objects.

3.4.3. Obviously the deﬁnition of Fourier-Jacobi category mimics the situation for vector bundles
on toroidal compactiﬁcations and we now proceed to deﬁne an exact functor

Ξ∗ ∶[ M -FJ-coh ] →[ M -TCoh ]

as follows: For each FY(v) ∈[ PY -Vect on M ∨

on Y . It carries an action of MnZ −nY

on

m

Y ] we form p∗(FY(v))PY Y which is a vector bundle

CZ(p∗

Y(FY(v))PY Y) ≅(p∗

Z(α∗

ZY FY(v))PZ) Y

which is a canonical extension (cf. 2.2.7).
The functors

F ′
Y

∶ ZnY →[ Y -TCoh-can ]

(where Y is equipped with its structure as restricted toroidal compactiﬁcation) together with the
maps induced by the µZY satisfy the requirements of Lemma 2.3.7. Hence we get a coherent sheaf

Ξ∗({FY}) on M which carries a GnY

m action on CY(Ξ∗({FY})).

We call the sheaves in the image of Ξ∗ generalized automorphic sheaves.

20

/
/




/
/
/




/
Example 3.4.4. The easiest case is just

where V is a bundle on [ M -FJ-coh ] = [ [M ∨~PM]-Coh ].

canonical extension itself and can be described by the collection of functors

It is a vector bundle which is a

Ξ∗V ∶=(p∗

M V)PM

FY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩

Y M V

α∗
0

v ∈ ZnY
≥0
otherwise.

Sheaves of this form are locally free and called automorphic vector bundles.

Remark 3.4.5. The Fourier-Jacobi categories are related to the classical Fourier-Jacobi expansions

as follows. For each F ∈[ M -FJ ] and stratum Y there is a morphism Fourier-Jacobi expansion:

H 0(M , Ξ∗F) → Mv∈ZnY

H 0(M , Ξ∗Fv),

where Fv is the following element of F ∈[ Y -FJ ]. On Y it is deﬁned by

Fv,Y(w) =

⎧⎪⎪⎨⎪⎪⎩
FY(v)

0

for w = v,
otherwise.

and is a similar restriction of F on strata Z ≤ Y and 0 on all other. Note that Ξ∗Fv has support
on Y .

Deﬁnition 3.4.6. For the category [ M -FJ-tf-coh ] we deﬁne a tensor product mimimicing the
tensor product of 2.2.6. Let F and G be objects of [ M -FJ-tf-coh ]. We deﬁne

(F ⊗ G)Y ∶ v ↦ Qv1+v2 =v

FY(v1) ⊗ GY(v2)

where the sum is formed in (limv→∞ FY(v)) ⊗(limv→∞ GY(v)).

Lemma 3.4.7. The exact functor (cf. 3.4.3)

Ξ∗ ∶[ M -FJ-coh ] →[ M -TCoh ]
preserves the tensor product when restricted to [ M -FJ-tf-coh ].
3.4.8. For each pair (Y, v) where Y is a stratum and v ∈ ZnY there exist restriction functors:

Y

(v)∗
(v)∗
(v)∗

Y

Y

∶

∶

∶

[ M -FJ-≥ N -coh ] → [ [M ∨
[ M -FJ ] → [ [M ∨
[ M -FJ-≥ N ] → [ [M ∨

Y~PY]-Coh ]
Y~PY]-Qcoh ]
Y~PY]-Qcoh ]

given by F ↦ FY(v). Those are exact and have each an exact right-adjoint (v)Y,∗ which is given as
follows. ((v)Y,∗V)Y is given by the right Kan-extension v∗, where v ∶{⋅} ↪ ZnY , resp. v ∶{⋅} ↪ ZnY

also denotes the inclusion of v. In other words we have

≥N

((v)Y,∗V)Y(w) =

⎧⎪⎪⎨⎪⎪⎩

V

0

if w ≤ v (and p.r.n. wi ≥ N for all i)
otherwise.

21

Note that v ≤ w means that vi ≤ wi for all i. For any stratum Z ≤ Y we deﬁne

((v)Y,∗V)Z(v) ∶= α∗

ZY((v)Y,∗V)Y(pr(v))

where pr ∶ ZnZ → ZnY is the projection induced by βZY . In the bounded case it is set identically

zero if vi < N for any i. For all other strata Z the functor ((v)Y,∗V)Z is set identically zero. The so
deﬁned object (v)Y,∗V satisﬁes conditions 1. and 2. of the deﬁnition of the Fourier-Jacobi category

3.4.1.

3.4.9. For each stratum Y and each N ∈ Z, there are exact restriction functors

ι∗
N

∶[ Y -FJ-coh ] →[ Y -FJ-≥ N -coh ]

which have an exact left-adjoint

ιN,! ∶[ Y -FJ-≥ N -coh ] ↪[ Y -FJ-coh ]

which is given by the natural inclusion (or, in other words, by extension by zero or left Kan extension
for the individual FZ ).

Corollary 3.4.10. For Y and v ∈ ZnY appropriate, there are fully-faithful functors of categories

(v)Y,∗ ∶ D([ [M ∨

Y~PY]-Coh ]) ↪ D([ M -FJ-≥ N -coh ])

ιN,! ∶ D([ M -FJ-≥ N -coh ]) ↪ D([ M -FJ-coh ])

and

for  ∈{b, +, −, ∅}.

Proof. We have in each case a pair of adjoint functors in which the unit, resp. the counit, is an
isomorphism. Since all four functors are exact, they induce functors on the derived categories
without modiﬁcation, and form again pairs of adjoint functors (because the counit/unit-equations
still hold). Since also the unit, resp. the counit, is still an isomorphism we get the requested
fully-faithfulness of the left- (resp. right-) adjoint.

In particular, for Y = M and N = 0 we get that the canonical extension functor (cf. Example 3.4.4)
is fully-faithful on the level of derived categories.

Remark 3.4.11. The statement of Corollary 3.4.10 is also true for the functors

and

(v)Y,∗ ∶ D([ [M ∨

Y~PY]-Qcoh ]) ↪ D([ M -FJ-≥ N ])

ιN,! ∶ D([ M -FJ-≥ N ]) ↪ D([ M -FJ ]).

We also have the following two lemmas, which however will not be needed in the sequel.

Lemma 3.4.12. The categories [ M -FJ-≥ N ] and [ M -FJ ] do have enough injectives (while
[ M -FJ-≥ ] does not).

22

Proof. For any object {FY} we deﬁne an injective resolution by
Y F)

M(Y,v),vi ≤NY
Y F) is an injective resolution of (v)∗

where I((v)∗
to general products in [ M -FJ-≥ N ] and [ M -FJ ]).

(v)Y,∗I((v)∗
Y F in the category [ [M ∨

right-adjoints of exact functors and ∏ preserve injective objects. Here NY is some appropriate
upper bound for the stratum Y . Note that because of the bound, the product exists (as opposed

Y~PY]-Qcoh ]. Note that

Lemma 3.4.13. The functors

D([ M -FJ-≥ N -coh ]) ↪ D([ M -FJ-≥ N ])

D([ M -FJ-coh ]) ↪ D([ M -FJ-≥ ])

Proof. Follows from (the dual of) [11, Theorem 13.2.8].

are fully-faithful for  ∈{b, −}.
These two lemmas imply, in particular, that Db([ M -FJ-≥ N -coh ]) and Db([ M -FJ-coh ]) are

locally small.

3.5 Jet bundles in the Fourier-Jacobi categories

3.5.1. We write MY ∶= CY(M) and MY Y for the formal open subscheme on Y . Recall the
deﬁnition of the vector bundle ΩM(log) on a variety with divisor of normal crossings. Locally the
bundle CY(ΩM(log)) Y is the bundle ΩMY  Y(log) (deﬁned in 2.2.8) on the formally toroidal formal
scheme MY Y , but not on MY ! Recall the description of the associated functor of ΩMY  Y(log) on
MY Y from 2.2.8.
By Theorem 3.3.10 the vector bundle ΩM(log) on M can therefore be obtained by glueing and is
associated with the following element in [ M -FJ-lf-coh ]:

FY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩

ΩM ∨
0

Y

if v ≥ 0,

otherwise.

Note that for Z ≤ Y the restriction α∗
supposed to be an open embedding by deﬁnition.
If the given automorphic data with ﬂat logarithmic connection satisﬁes the unipotent monodromy
axiom (M) then the subbundle ΩM can be described by the following functor

is canonically isomorphic to ΩM ∨

because αZY is

ZY ΩM ∨

Z

Y

{ξ ∈ ΩM ∨

Y   pi(ξ) = 0 ∀i ∶ vi = 0}

0

if v ≥ 0,

otherwise.

(8)

FY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩

Y

⊂ TM ∨

Here pi is given as follows: We have by the unipotent monodromy axiom that there are subbundles
T (i)
given by the Lie algebras ui of 1-dimensional normal unipotent subgroups Ui ⊂ GY . (In
M ∨
Y
other words, choosing a base point QY ∈ M ∨
is normal, the associated PY -equivariant bundles do not depend on the choice of base point.) pi is
then deﬁned as the projection dual to this inclusion. By the unipotent monodromy axiom (M) we
have OBY

Y , this is induced by the inclusion ui → pY~qY . Since ui

Y) under the natural PY -equivariant isomorphism

⋅ π−1(cani,MY) ≅ p∗(T (i)

M ∨

π∗TMY(log) ≅ p∗TM ∨

Y

.

It follows therefore from the proof of Theorem 3.3.10 that ΩM is associated with this subfunctor.

23

3.5.2. Assume for the rest of the section that there exists a k-valued point in M ∨ and let QM
be the corresponding quasi-parabolic subgroup of PM . The discussion in the preceeding paragraph
enables us to reﬁne Theorem 3.3.10. Given a QM -representation V or equivalently a PM -equivariant

vector bundle ̃V on M ∨ we deﬁne the object (J ñV)′ in [ M -FJ-lf-coh ] by

(J ñV)′

Y

∶ v ↦ J n(̃V)v

where we deﬁne a ZnY -indexed ﬁltration on J n(̃V) induced by the dual of the ﬁltration on
(U(pY) ⊗U(qY ) V ∗)≤n given by the trivial ﬁltration on V ∗ and the ﬁltration on U(pY) which is
the quotient of the induced ﬁltration on T(pY) (tensor algebra) of the following ﬁltration on pY :

pY(v) =

(This is essentially the dual of (8).)

⎧⎪⎪⎪⎪⎨⎪⎪⎪⎪⎩

pY

ui
0

v ≥ 0

vi = −1 and vj ≥ 0 ∀j ~= i

otherwise.

⊂

morphic vector bundle on M . Then the generalized automorphic sheaf associated with the element

Theorem 3.5.3. Let V be a representation of QM , and let V ∶= Ξ∗̃V be the corresponding auto-
(J ñV)′ in [ M -FJ-lf-coh ] is precisely J nV.
3.5.4. Deﬁne ωM(log) ∶= Λn(ΩM(log)), where n = dim(M). By Proposition 3.3.10, this is an
ωM(log) is a generalized automorphic sheaf on M given by the functors

automorphic line bundle associated with ωM ∨ and by the above discussion the subbundle ωM

if vi ≥ 1 ∀i,
otherwise.

We also deﬁne the following generalized automorphic sheaves ωY associated with the functor in

ωY ∶ v ↦⎧⎪⎪⎨⎪⎪⎩
In other words it is given by ι1,! (0)M,∗ ωM ∨, where (0)Y,∗ is considered as a functor with val-
is associated with the QY -representation Λn(pY~qY).
ues in [ M -FJ-≥ 1-coh ]. Note that ωM ∨
[ Y -FJ-coh ]:
(ωY)Y ∶ v ↦⎧⎪⎪⎨⎪⎪⎩
It extends (as canonical extension along smaller strata) to an element ωY in [ Y -FJ-coh ] (cf.
3.4.8). In other words ωY is given by ι0,! (0)Y,∗ ωM ∨
, where (0)Y,∗ is considered as a functor with
values in [ M -FJ-≥ 0-coh ].
Lemma 3.5.5. There is an exact sequence in [ M -FJ-coh ]

ωM ∨
0

ωM ∨
0

Y

otherwise.

if v = 0,

Y

Y

Y

0

/ ω

/ ωM ∨

/ ࣷY codim 1 strata ωY

/ ࣷY codim 2 strata ωY

/ ⋯

where the sums go over certain multi-sets of strata which we will not specify because we do not need
them explicitly.

24

/
/
/
/
/
3.6 Automorphic data on toroidal compactiﬁcations of (mixed) Shimura vari-

eties

3.6.1. The toroidal compactiﬁcations of (mixed) Shimura varieties are naturally equipped with
automorphic data with logarithmic connection in the sense of Deﬁnition 3.1.1. We only sketch the
relation with the theory of mixed Shimura varieties and their toroidal compactiﬁcations in this
section, hinting at the reasons for the axioms to be satisﬁed. The only exception is the boundary
vanishing axiom which will be investigated more in detail.
Firstly we may ﬁx the particular boundary component BY in its conjugacy class such that for Z ≤ Y
we get a boundary map BZ → BY , i.e. a closed embedding PBZ
↪ PBY together with a compatible
open embedding DBY into DBZ . By [8, Main Theorem 2.5.12] to each of these boundary components

BY there exists a “compact” dual M∨(BY) (which is only proper for BY = X, i.e. Y = M , if X

is itself pure). It is of the form M ∨
Y as required in the deﬁnition of automorphic data, i.e. a PB-
equivariant component in the classifying space of quasi-parabolics for PB. Except possibly in the
case Y = M if M is already proper (i.e. where there is nothing to compactify) M ∨ is even deﬁned

over Q and there is a Q-rational point in M ∨(BY), i.e. a quasi-parabolic QY ⊂ PBY such that
= PBY~QY . For the deﬁnition of automorphic data, we will, however, consider all varieties and
groups as schemes over the reﬂex ﬁeld E(X).
is a PBY -principal bundle B(KY
M(KY

B) over the mixed Shimura variety M(KY
BY)

The following is a summary of [8, Main Theorem 2.5.14]. For each stratum Y there

BY) together with an

equivariant map to the “compact” dual:

/ M∨(BY)

BY)

B(KY

∆Y

3.6.2.

p

π

∆Y

∆Y

M ∨
Y

∆Y

Because of the functoriality (the torus action comes from a morphism of mixed Shimura data) the
morphism p is MnY
m -invariant. These data are compatible
in the sense that if we have strata Z ≤ Y then there is a commutative diagram

m -equivariant and the morphism π is MnY

CZ M(K

∆ X)

∼ /

/ C ̃Z

M(KZ

∆Z

BZ)

CY M(K

∆ X)

∼ /

/ C̃Y

M(KY

∆Y

BY)

p

p

C

p−1 ̃Z

B(KZ

∆Z

BZ)

/ M∨(BZ)

C

p−1 ̃Y

B(KY

∆Y

BY)

/ M∨(BY)

where the maps are functorial w.r.t. relations W ≤ Z ≤ Y of strata.
The ﬂat logarithmic connection can be deﬁned analytically by means of the ﬂat section ξ on the
universal cover given as follows:

DBY

× PBY(A(∞))~KY

ξ∶[τ,g]↦[τ,1,g]

,❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳❳
PBY(Q)ƒDBY

× PBY(A(∞))~KY

PBY(Q)ƒDBY
That the corresponding connection is deﬁned over E(G, X) can be deduced from [3, 3.4].

In
purely algebraic constructions of Shimura varieties as moduli spaces it comes from the Gauss-
Manin connection on the cohomology bundle.

× PBY(C) × PBY(A(∞))~KY

PBY(C)~QY(C)

25

o
o
/




o
o


/


o
o
/


,
/
/
o
o
3.6.3. The Torelli axiom (T) is immediately clear analytically from the picture above since the
composition

DBY

× PBY(A(∞))~KY → PBY(C)~QY(C)

is the Borel open embedding (after projection to the ﬁrst factor). In purely algebraic constructions
of Shimura varieties it corresponds to inﬁnitesimal Torelli theorems of the parametrized objects
which can be proven purely algebraically.

3.6.4. The unipotent monodromy axiom (M) is satisﬁed because the cone σ describing a boundary
a is a normal subgroup of PBY . By

≅ Gu

component sits per deﬁnition in UBY ,R(−1) and UBY
universal cover correspond to the basis-vectors of (UBY

construction the fundamental vector ﬁelds cani of the action of GnY

BY) lifted to the
∩ KY)(−1) spanning σ. In cases, in which

m on M(KY

the mixed Shimura variety is constructed using a moduli problem of 1-motives as in [8, 2.7], the
unipotent monodromy axiom can be read oﬀ from the construction.

∆Y

Proposition 3.6.5 (Boundary vanishing condition (B)). Let Y be a mixed Shimura datum (e.g.

one of the boundary components BY ), let n be the dimension of M∨(Y), let Q be one of the
quasi-parabolics parametrized by M∨(Y), let ω be the Q-representation corresponding to the PX-

M∨(Y) on M∨(Y), and let u be the dimension of UY. Then we have:

equivariant bundle Ωn

H i([⋅~Q] , ω) = 0

for all i ≥ n − u provided u ~= 0.
satisfy dim(Y) ≥ n − u.

Note that all boundary strata Y which come from rational polyhedral cones in the unipotent cone

Proof. W.l.o.g. we may assume that the base ﬁeld of the category of Q-representations is C and
that all algebraic groups involved are deﬁned over C. We have the following zoo of connected linear
algebraic groups (cf. [8, 2.2] or [13]):

S = G2
m

P = PY = G ⋅ V ⋅ U
G = GY
V = VY ≅ G2v
a
U = UY ≅ Gu
a

is a maximal reductive subgroup

h ∶ S → G

any homomorphism in hY(DY)

R = K ⋅ R+ = G ∩ Q

is a parabolic in G (with its Levi decomposition)

R+, R− ≅ Gn0
a

V = V + ⋅ V −
V + = Q ∩ V

Q = R ⋅ V + is the quasi-parabolic deﬁning M ∨(Y)

By deﬁnition of a mixed Shimura datum the Lie algebras of these groups have the following weights
under S:

Lie(U)

(−1, −1)

Lie(V +)
Lie(V −)

(−1, 0)
(0, −1)

26

Lie(R+)
Lie(K)
Lie(R−)

(−1, 1)
(0, 0)
(1, −1)

We have the following sequence of aﬃne morphisms

M ∨(Y) = P~(R ⋅ V +) → G ⋅ V~(R ⋅ V +) → G~R

of relative dimensions u = dim(U), and v = dim(V −), respectively. G~R is a projective ﬂag variety
of dimension n0 = dim(R+).

STEP 1: We have

H i([⋅~P] , ω) = H i([⋅~V + ⋅ R+] , ω)K

because K is reductive. Furthermore since ω is 1-dimensional and hence trivial as a V + and R+
representation, we have as K-representations

H i([⋅~V + ⋅ R+] , ω) = H i([⋅~V + ⋅ R+] , C) ⊗ ω.

STEP 2: V + and R+ commute (because there is no part of the Lie algebra of weight (−2, 1)).
Hence H i([⋅~V + ⋅ R+] , C) is just the cohomology of Gn0+v
H i([⋅~V + ⋅ R+] , C) = Λi(Lie(V +)∗ ⊕ Lie(R+)∗) as natural Aut(V + ⋅ R+)-modules [10, p.64, Remark
2)]. Therefore H i([⋅~V + ⋅ R+] , C) = 0 for i > n0 + v and

w.r.t. the trivial representation. Hence

a

H n0+v([⋅~V + ⋅ R+] , C) = Λn0+v(Lie(V +)∗ ⊕ Lie(R+)∗) ≅ C.

STEP 3: Since the last isomorphism is compatible w.r.t. the natural Aut(V + ⋅ R+)-actions, we see
that H n0+v([⋅~V + ⋅ R+] , C) is one-dimensional of weight
(v + n0, −n0)

under S. Also ω is one-dimensional of weight

(−u − v − n0, n0 − u).

Therefore

H n0+v([⋅~V + ⋅ R+] , C) ⊗ ω

has weight

(−u, −u)

and therefore cannot have any K-invariants as long as u ~= 0.
4 Hirzebruch-Mumford proportionality

4.1 Chern classes

4.1.1.
Let X be a smooth projective complex variety of dimension n. There are several ways
of constructing the Chern classes of vector bundles on X. We will use the following, cf. [2]. Let
E be a vector bundle on X. It deﬁnes an Atiyah extension (where J 1 is the ﬁrst jet bundle (cf.
Section 3.3))

Tensoring with E ∗ and pulling back along the unit OX → E ∗ ⊗ E we get an extension

0

/ Ω1
X

⊗ E

/ J 1E

/ E

/ 0.

0

/ Ω1
X

⊗ End(E)

/ A

/ OX

/ 0.

This might be seen as a morphism

OX → Ω1
X

⊗ End(E)[1]

27

/
/
/
/
/
/
/
/
in Db([ OX -Coh ]). The coeﬃcients of the characteristic polynomial of this “endomorphism” give

morphisms

ci(E) ∶ OX → Ωi

X[i].

Furthermore, any polynomial p in the graded polynomial ring Q[c1, c2, . . . , cn] (where deg(ci) = i)

of degree n gives a morphism

p(c1(E), . . . , cn(E)) ∶ OX → Ωn

X[n] =∶ ωX[n].

The corresponding extension p(c1(E), . . . , cn(E)) ∈ Extn(OX , ωX) can be constructed explicitly
using only locally free sheaves. Using the trace map tr ∶ Extn(OX , ωX) → k of Serre duality, we get
elements tr(p(c1(E), . . . , cn(E))) ∈ k. The compatibility with other constructions of Chern classes
using algebraic cycles shows that even tr(p(c1(E), . . . , cn(E))) ∈ Q.

4.2 Proportionality

Theorem 4.2.1 (Hirzebruch-Mumford proportionality). Let M be a toroidal compactiﬁcation of
dimension n equipped with automorphic data with logarithmic connection which satisﬁes the axioms
(F, T, M, B) and such that PM is reductive. There is c ∈ Q such that for all polynomials p of

degree n in the graded polynomial ring Q[c1, c2, . . . , cn] and all PM -equivariant vector bundles E in
[ [M ∨~PM]-Coh ] the proportionality

p(c1(E), . . . , cn(E)) = c ⋅ p(c1(Ξ∗E), . . . , cn(Ξ∗E))

holds true.

Proof. Starting from the sequence in [ M -FJ-coh ] (cf. 3.5.2 for the deﬁnition of J 1(E)′):

0

/ (Ω1)′ ⊗ E

/ J 1(E)′

/ E

/ 0

by the procedure described in the last section we can construct an element

̃p(E) ∈ Extn

[ M -FJ-coh ](O, ω).

Note that in the construction only the tensor product of locally free objects is involved and the
exactness of ⊗ on sequences involving those.
Consider the following two compositions of functors

Db([ M -FJ-coh ])

Db(Ξ∗)

/ Db([ O

M -Coh ])

Db([ M -FJ-coh ])
The images of the morphism ̃p(E) ∶ O → ω[n] give

/ Db([ M -FJ-coh ])

p(c1(E), . . . , cn(E))

and

Db([ [M ∨~PM]-Coh ])

/ Db([ OM ∨-Coh ]).

p(c1(Ξ∗E), . . . , cn(Ξ∗E))

respectively. Here it is used that Ξ∗ is an exact functor that is compatible with the tensor product
when restricted to locally free (or even torsion-free) objects, that by Theorem 3.5.3 the image of

J 1(E)′ under Ξ∗ is precisely J 1(Ξ∗E), and that the image under the second functor is J 1(E) where
the PM -action on E is forgotten (by deﬁnition of J 1(E)′).

The theorem therefore follows from Proposition 4.2.2 below. In the compact case, i.e. if M = M ,
and PM is reductive, this is easier and Lemma 4.2.3 can be applied.

28

/
/
/
/
/
/
/
Proposition 4.2.2. If PM is reductive, we have

dim(Extn

[ M -FJ-coh ](O, ω)) ≤ 1.

Proof. By Proposition 3.5.5 we have an exact sequence

0

/ ω

/ ωM ∨

/ D

/ 0

and a ﬁnite resolution

0

/ D

/ ࣷY codim 1 strata ωY

/ ࣷY codim 2 strata ωY

/ ⋯

(9)

We get the long exact sequence

Extn−1(O, D)

/ Extn(O, ω)

/ Extn(O, ωM ∨)

/ Extn(O, D)

(all Ext-groups are computed in the category [ M -FJ-coh ]). By Lemma 4.2.3 below the dimension
of Extn(O, ωM ∨) is at most one. Hence it suﬃces to show that Extn−1(O, D) = 0. Splitting up the
exact sequence (9) into short exact sequences one sees that it suﬃces to show that Exti(O, ωY) = 0
for i ≤ dim(Y) and for Y ~= M . We have fully-faithful embeddings (cf. Corollary 3.4.10)

Db([ [⋅~PY]-Coh ]) ↪ Db([ M -FJ-≥ 0-coh ])) ↪ Db([ M -FJ-coh ])

such that the image of ωM ∨
Furthermore we have

Y

= Λn

pY~qY under the composition is ωY .

Hence

HomDb([ M -FJ-coh ])(ι0,! ι∗
= HomDb([ M -FJ-≥ 0-coh ])(ι∗
= HomDb([ M ∨

Y ~PY (cid:6)-Coh ])(OM ∨
Y~PY] , ωM ∨
H i([M ∨

Y

0 O.

O = ι0,! ι∗
0 O, ι0,!(0)∗ ωM ∨
0 O,(0)∗ ωM ∨
Y[i])
Y[i])

, ωM ∨

Y[i])

Y) = 0 for i ≥ dim(Y).

Therefore the Proposition follows from boundary vanishing condition (axiom B):

(fully-faithfulness)
(adjunction)

Lemma 4.2.3. If PM is reductive, we have

dim(Extn

[ M -FJ-coh ](O, ωM ∨)) ≤ 1.

Proof. We have a fully-faithful embedding (cf. Corollary 3.4.10)

Db([ [M ∨~PM]-Coh ]) ↪ Db([ M -FJ-coh ]).

The functor R Hom(O, −) is the same as the composion

Db([ [M ∨~PM]-Coh ]) → Db([ [⋅~PM]-Coh ]) → Db([ spec(k)-Coh ])

where the ﬁrst functor is the right derived functor of taking global sections and the second is the
functor of PM -invariants. However, the last functor is exact (because PM is reductive) and therefore
we have

Since H n(M ∨, ωM ∨) is one-dimensional by Serre duality, the Lemma follows.

Extn

[ M -FJ-coh ](O, ωM ∨) = H n(M ∨, ωM ∨)PM .

Remark 4.2.4. For the compact dual associated with a pure Shimura datum this can also be seen
from the explicit calculation in the proof of Proposition 3.6.5, which shows that the dimension is in
fact one.

29

/
/
/
/
/
/
/
/
/
/
/
References

[1] A. Ash, D. Mumford, M. Rapoport, and Y.-S. Tai. Smooth compactiﬁcations of locally sym-
metric varieties. Cambridge Mathematical Library. Cambridge University Press, Cambridge,
second edition, 2010. With the collaboration of Peter Scholze.

[2] M. F. Atiyah. Complex analytic connections in ﬁbre bundles. Trans. Amer. Math. Soc., 85:

181–207, 1957.

[3] M. Harris. Arithmetic vector bundles and automorphic forms on Shimura varieties. I. Invent.

Math., 82(1):151–189, 1985.

[4] M. Harris. Arithmetic vector bundles and automorphic forms on Shimura varieties. II. Com-

positio Math., 60(3):323–378, 1986.

[5] M. Harris and S. Zucker. Boundary cohomology of Shimura varieties. I. Coherent cohomology

on toroidal compactiﬁcations. Ann. Sci. ´Ecole Norm. Sup. (4), 27(3):249–344, 1994.

[6] F. Hirzebruch. Automorphe Formen und der Satz von Riemann-Roch. In Symposium interna-
cional de topolog´ıa algebraica International symposium on algebraic topology, pages 129–144.
Universidad Nacional Aut´onoma de M´exico and UNESCO, Mexico City, 1958.

[7] F. H¨ormann. The arithmetic volume of Shimura varieties of orthogonal type. PhD thesis,

Humboldt-Universit¨at zu Berlin, 2010.

[8] F. H¨ormann. The geometric and arithmetic volume of Shimura varieties of orthogonal type,
volume 35 of CRM Monograph Series. American Mathematical Society, Providence, RI, 2014.

[9] F. H¨ormann. Descent for coherent sheaves along formal/open coverings. arXiv: 1603.02150,

2015.

[10] J. C. Jantzen. Representations of algebraic groups, volume 107 of Mathematical Surveys and
ISBN

Monographs. American Mathematical Society, Providence, RI, second edition, 2003.
0-8218-3527-0.

[11] M. Kashiwara and P. Schapira. Categories and sheaves, volume 332 of Grundlehren der
Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-
Verlag, Berlin, 2006.

[12] D. Mumford. Hirzebruch’s proportionality theorem in the noncompact case. Invent. Math.,

42:239–272, 1977.

[13] R. Pink. Arithmetical compactiﬁcation of mixed Shimura varieties. Bonner Mathematische
Schriften [Bonn Mathematical Publications], 209. Universit¨at Bonn, Mathematisches Institut,
Bonn, 1990. Dissertation, Rheinische Friedrich-Wilhelms-Universit¨at Bonn, Bonn, 1989.

30

