6
1
0
2

 
r
a

M
 
7
1

.

 
 
]
P
E
h
p
-
o
r
t
s
a
[
 
 

1
v
2
6
6
5
0

.

3
0
6
1
:
v
i
X
r
a

MNRAS 000, 1–12 (2016)

Preprint 21 March 2016

Compiled using MNRAS LATEX style ﬁle v3.0

Bayesian priors for transiting planets

David M. Kipping1(cid:63) and Emily Sandford1
1Dept. of Astronomy, Columbia University, 550 W 120th Street, New York NY 10027

Accepted . Received ; in original form

ABSTRACT

As astronomers push towards discovering ever-smaller transiting planets, it is in-
creasingly common to deal with low signal-to-noise ratio (SNR) events, where the
choice of priors plays an inﬂuential role in Bayesian inference. In the analysis of exo-
planet data, the selection of priors is often treated as a nuisance, with observers typi-
cally defaulting to uninformative distributions. Such treatments miss a key strength of
the Bayesian framework, especially in the low SNR regime, where even weak a priori
information is valuable. When estimating the parameters of a low-SNR transit, two
key pieces of information are known: (i) the planet has the correct geometric align-
ment to transit and (ii) the transit event exhibits suﬃcient signal-to-noise to have been
detected. These represent two forms of observational bias. Accordingly, when ﬁtting
transits, the model parameter priors should not follow the intrinsic distributions of
said terms, but rather those of both the intrinsic distributions and the observational
biases. In this work, we derive the shape of these priors for trapezoidal transits and
occultations, including the case of grazing events. These results naturally explain why
the observed population shows a bias towards equatorial transits and why the observa-
tional bias of ratio-of-radii is super-quadratic, scaling as (RP/R(cid:63))5/2. We may account
for these observational biases by adding on log likelihood penalty terms, for which we
provide PYTHON code to generate, ExoPriors.

Key words: eclipses — planets and satellites: detection — methods: statistical —
methods: analytical

1 INTRODUCTION

Bayesian parameter estimation has propagated through the
exoplanet community in recent years, to such a degree that it
has become integrated within most standard analysis pack-
ages (e.g. ExoFit, Balan & Lahav 2009; TAP, Gazak et al.
2012; EXOFAST, Eastman et al. 2013). Bayesian inference
is attractive since it attempts to determine the probability
distribution of the true parameters of interest, rather than
the distribution expected by repeating a parameter mea-
surement many times over (which underpins the frequentist
framework).

In Bayesian parameter estimation, one seeks to infer
the probability distribution of some model parameters, Θ,
conditioned upon some observational data, D. This distri-
bution, usually referred to as the posterior distribution in
Bayesian parlance, is denoted Pr(Θ|D). Bayesian parameter
estimation is predicated upon Bayes’ theorem, which allows
us to express the posterior as

(cid:63) E-mail: dkipping@astro.columbia.edu

c(cid:13) 2016 The Authors

(cid:122) (cid:125)(cid:124) (cid:123)
(cid:122)(cid:125)(cid:124)(cid:123)
(cid:124)(cid:123)(cid:122)(cid:125)

likelihood
Pr(D|Θ)
Pr(D)

prior
Pr(Θ)

evidence

(cid:124) (cid:123)(cid:122) (cid:125)

Pr(Θ|D)
posterior

=

.

(1)

In the case of Bayesian parameter estimation using a
single model, the evidence is usually ignored since it is com-
putationally expensive and functionally independent of Θ.
Accordingly, the posterior is proportional to the product of
the likelihood and the prior.

The prior formally encodes what we already know about
Θ (and in most cases, we do know something, however sub-
tle). In the classic pedagogical example of testing positive
for a rare disease, the posterior is strongly inﬂuenced by
our prior knowledge that the disease is rare; even in the
case of a positive result from a highly accurate test (a high
likelihood), we conclude that the probability that the pa-
tient actually has the disease is low (a low posterior). In a
similar vein, if an exoplanet observer ﬁnds that their data
supports an orbital eccentricity of e = 0.99, their initial re-
action is to be skeptical, because they know from experience

2 Kipping & Sandford

that such high eccentricities are rare (Kipping 2013). The
prior therefore encodes previous experience and knowledge,
demanding that extraordinary conclusions require extraor-
dinary evidence.

Since the posterior is the product of the likelihood and
the prior, a prior which is much less informative than the
likelihood will have little eﬀect on the posterior. In this
regime, observers are justiﬁed in spending little eﬀort deﬁn-
ing their priors, and “uninformative” choices are the norm.
However, when the likelihood is weakly informative, as is the
case of low signal-to-noise data, the prior becomes more in-
ﬂuential. Indeed, in the limit of no data, the posterior simply
returns the prior.

The analysis of low signal-to-noise ratio (SNR) exo-
planet data is increasingly common, and consequently the
inﬂuence of priors is on the rise, which ultimately motivates
this work. Early conﬁrmed exoplanets were discovered at
high signiﬁcance thanks to high SNR data. For example,
PSR B1257+12 (Wolszczan & Frail 1992) and 51-Pegasi
(Mayor & Queloz 1995) were (cid:38) 10 σ signiﬁcant detections
(Kipping 2011). This extreme signiﬁcance threshold demon-
strates Bayesian principles at work once again—in a ﬁeld
with a history of spurious detections (e.g. Van de Kamp
1963), a high likelihood was necessary to overwhelm the sci-
entiﬁc community’s low prior belief. With thousands of ex-
oplanets now known and exoplanet discoveries announced
routinely, the community’s prior has risen such that lower
SNR discoveries have become more common, and 3 σ conﬁ-
dence is presently used as a signiﬁcance threshold (e.g. Rowe
et al. 2014).

Low SNR events are also increasingly subject to
Bayesian parameter estimation in hierarchical population
modeling (Hogg et al. 2010; Wolfgang et al. 2015; Chen &
Kipping 2016). For every high SNR event, there are many
more low SNR events, which together provide useful infor-
mation on the ensemble population. Naturally, one wishes
to include these low SNR data, which necessitates a careful
treatment of priors.

In this work, we consider the issue of priors for a tran-
siting planet, or more generally any eclipsing body. We ar-
gue that two biases aﬀect the inference of the basic transit
parameters: a geometric bias and a detection bias. The geo-
metric bias of transits is generally well-known, where partic-
ular attention has been given to the subtle bias which results
from eccentricity (Barnes 2007; Burke 2008). This geometric
bias can be expressed analytically, which allows one to write
down an analytic expression for a prior which includes the
bias (Kipping 2014). Armed with this expression, it is sim-
ple to conduct Bayesian parameter estimation accounting
for the bias.

In contrast, the detection biases aﬀecting transits are
usually computed using numerical simulations, typically
through injection/recovery tests (e.g. Petigura et al. 2013;
Dressing & Charbonneau 2015). Such models are attractive
because they can simulate complex eﬀects in the detection
pipeline, including instrument-speciﬁc eﬀects. A drawback
is that one cannot easily write down an analytic prior which
describes the resulting distributions, and to a certain de-
gree, the blackbox of numerical simulations masks deeper
insights about the problem. Finally, such results are typ-
ically tailored to the survey of interest, leaving it unclear
which trends are due to the general nature of detection bias

and which are instrument-speciﬁc. In this work, we derive an
analytic prior which accounts for both geometric and detec-
tion bias, providing a general prior suitable for the analysis
of transits from any survey.
The paper is organized as follows. In §2, we ﬁrst derive
an analytic expression for the SNR of a trapezoidal tran-
sit, including grazing geometries. In §3, we show how mak-
ing some approximations to these results allow us to write
down a simple form for the joint prior distribution of the
transit parameters. We build upon this work in §4, deriving
a more accurate set of expressions for the joint prior and the
marginalized distributions that result and extending the for-
malism to include occultations. Finally, we summarize our
ﬁndings in §5 and highlight our publicly available software,
ExoPriors, to allow the community to easily adopt our pri-
ors.

2 SIGNAL-TO-NOISE RATIO OF A TRANSIT

2.1 SNR of a Trapezoidal Transit

In order to derive the prior describing detection bias, we
begin by deriving the SNR of the transit light curve as a
function of the basic transit parameters.

A transit is a decrease in the apparent brightness, or
more speciﬁcally the received intensity I(t), of a star as a
function of time t. The received intensity may be deﬁned as
the number of photons received per unit time. Away from
transit events (“out-of-transit”), then, a “vanilla” star dis-
playing no changes in brightness would cause our detector
to receive an intensity

Iout(t) = Γ,

(2)

where Γ represents the nominal photon collection rate.
In order to actually measure the photon collection rate, we
have to collect photons over a speciﬁc time interval (t1 →
t2) and then divide by said interval. This is equivalent to
calculating the mean of the function I(t) via
(cid:82) t2
(cid:82) t2

I =

(3)

t=t1 I(t)dt
t=t1 dt

.

In the out-of-transit case, the above yields the simple

result Iout = Γ.

In the case of a star accompanied by a transiting planet,
the intensity will be periodically attenuated by the eclipse of
the planet. Following Carter et al. (2008), we approximate
the shape of the transit light curve as a trapezoid in what
follows. As was shown in Figure 1 of Carter et al. (2008),
four key times (t1 < t2 < t3 < t4), as well as a depth, δ , deﬁne
the shape of the transit:

 1− δ

1− δ (t−t1)
t2−t1
1− δ (t4−t)
t4−t3

Iin(t) = Γ

t2 (cid:54) t (cid:54) t3
t1 < t < t2
t3 < t < t4

.

(4)

The fractional change in the measured intensity deﬁnes
the “signal” in the case of transits. We express the signal as

MNRAS 000, 1–12 (2016)

Iout − Iin

,

S =

Iout
where the subscripts “in” and “out” denote in- and out-
of-transit. Evaluating Iin using Equations (3) & (4), then
substituting into Equation (5) and replacing (t4 − t1) and
(t3 −t2) with T14 and T23 respectively, yields

(5)

(cid:16) T14 + T23

(cid:17)

δ .

S =

2T14

(6)
In the limit of a box-like transit, we have T14 → T and

T23 → T , which reproduces the classic result of S = δ .

Having calculated the “signal,” we now turn our atten-
tion to the “noise.” Since Iin and Iout are independent of one
another, the error on S, which we deﬁne as σS (the “noise”),
may be calculated via quadrature as

σ 2
S =(∂Iout
Iout

=

S)2σ 2
Iout
2σ 2
+ Iin
Iin
4
Iout

+ (∂Iin
2σ 2
Iout

S)2σ 2
Iin

,

.

(7)

Since our detector is essentially a photon counter, the
uncertainty on the terms Iin and Iout may be calculated using
Poisson statistics. Speciﬁcally, one expects the uncertainty
on the mean intensity I(t) to be given by

(cid:113)(cid:82) t2
(cid:82) t2

t=t1 I(t)dt
t=t1 dt

σI =

(cid:115)

σS =

.

(8)

Evaluating σIin

and σIout

using Equation (8) and then

substituting the results into Equation (7), we ﬁnd

(T14 −Wδ )(Tobs + T14 −Wδ )

T 2
14TobsΓ

,

(9)

where W ≡ (T14 + T23)/2 and Tobs is the duration over
which the out-of-transit intensity is observed. Finally, then,
the SNR of a trapezoidal transit is

SNRsingle =

(cid:112)(T14 −Wδ )(Tobs + T14 −Wδ )

√
TobsΓ

Wδ

.

(10)

In most instances, the out-of-transit baseline is much
longer than the in-transit observations in order to reduce
the uncertainty in the transit measurement. In the limit of
Tobs (cid:29) T14, then, we have
√
Γ

(11)

lim

Tobs(cid:29)T14

SNRsingle =

(cid:112)T14 −Wδ

Wδ

In the small-planet case of δ (cid:28) 1 (appropriate even for

the Jupiter-Sun system), this becomes

√
Γ

W√
T14

lim
δ(cid:28)1

SNRsingle = δ

lim
(12)
Tobs(cid:29)T14
In what follows, Tobs (cid:29) T14 and δ (cid:28) 1 are adopted as
assumptions, and we do not explicitly state them in subse-
quent expressions.

.

MNRAS 000, 1–12 (2016)

Bayesian priors for transiting planets

3

2.2 Accounting for Grazing Transits

Equation (12) provides a simple and practical estimate for
the SNR of a trapezoidal transit. However, it is framed in
terms of the depth, δ , which is not equal to p2 (the ratio-
of-radii squared) in cases where (1− p) < b < (1 + p), corre-
sponding to so-called “grazing” transits. In such instances,
δ < p2 and requires calculating the area of partial overlap
between the planet’s disk and that of the star. This is com-
monly done using the λ function, deﬁned in Equation (1) of
Mandel & Agol (2002) as

(cid:32)

(cid:114) 4S 2 − (1− S 2 − p2)2

(cid:33)

4

λ (p, S ) =

1
π

p2κ0 + κ1 −

where

κ0 ≡ cos−1(cid:16) p2 + S 2 − 1
κ1 ≡ cos−1(cid:16) 1− p2 + S 2

2pS

2S

(cid:17)
(cid:17)

,

,

,

(13)

(14)

(15)

where S is the sky-projected planet-star separation in

stellar radii. Accordingly, we now express

δ (p,b) =

λ (p,b)
0

0 (cid:54) b < 1− p
1− p (cid:54) b < 1 + p
1 + p (cid:54) b < ∞

.

(16)

We may now modify the SNRsingle expression (Equa-

tion (12)) to account for grazing events as

(cid:17)

(cid:16) T14+T23
(cid:16)√
(cid:17)

√
T14
2
T14
2

0

p2√
Γ
√
Γ 1− p (cid:54) b < 1 + p
λ (p,b)

0 (cid:54) b < 1− p

1 + p (cid:54) b < ∞

SNRsingle =

,

(17)

 p2


where the grazing case is evaluated by appreciating that

T23 = 0 in such instances.

2.3 Approximating the SNR Equation

In order to understand the relationship between SNR and
impact parameter, b, we need to re-write Equation (17) by
evaluating the various durations. To this end, we employ the
“one term” transit duration function from Kipping (2010)
(Equation 15 of that work) in what follows.

We initially seek a simple and approximate formula,
since the goal of this work is to derive prior distributions
from which we can draw samples, necessitating simple an-
alytic forms. However, the full SNR expression of Equa-
tion (17) serves as a useful comparison for the accuracy of
proposed approximate formulae.
We start by assuming that p (cid:28) 1, the small-planet ap-
proximation, for which the ﬁrst implication is that grazing
transits contribute negligibly to the SNR function, and thus
we need only consider trapezoidal transits. Under this ap-
proximation, it also true that one expects W = (T14 +T23)/2(cid:39)
˜T , as deﬁned in Kipping (2010), which reduces two of
the duration terms to just one. We then proceed to make
a small-angle approximation on the inverse sine functions

4 Kipping & Sandford
(sin−1(x) (cid:39) x) within the duration terms, equivalent to as-
suming aR (cid:29) 1, which is valid for the vast majority of exo-
planets. In total, then, we approximate aR (cid:29) 1, W → ˜T and
p (cid:28) 1, such that

lim
aR(cid:29)1

lim
p(cid:28)1

lim
W→ ˜T
where we have deﬁned

SNRsingle = νsingle(1− b2)1/4 p2,
(cid:33)1/6

(cid:32)

(cid:32)

ρ−1/6

(cid:63)

P1/6

(1− e2)1/4
(1 + esinω)1/2

νsingle ≡

3
Gπ2

(18)

(19)

(cid:33)

Γ1/2.

The accuracy of Equation (18) versus the the more ac-

curate Equation (17) is illustrated later in Figures 2 & 3.

Whilst the above is derived for single transits, one of-
ten deals with multiple events, in which case the SNR is
expected to increase with the square root of the number
of events. Within a given baseline of observations, Tobs, we

therefore expect the SNR to increase by (cid:112)Tobs/P, since

shorter period planets ﬁt more transits in within Tobs, such
that

lim
aR(cid:29)1

lim
p(cid:28)1

lim
W→ ˜T
where

(cid:32)

νmulti ≡

3
Gπ2

SNRmulti = νmulti(1− b2)1/4 p2,
(cid:33)1/6

(cid:32)

ρ−1/6

(cid:63)

P−1/3

(1− e2)1/4
(1 + esinω)1/2

(cid:33)(cid:112)ΓTobs.

(20)

(21)

3 CONDITIONAL PRIORS

3.1 Probability of Detection

ˆd to denote “transit
In what follows, we use the symbol
detected.” Let us group the various parameters in Equa-
tion (20) into a vector Θ = {p,b,P,ρ(cid:63),e,ω}. We deﬁne the
probability of detecting a transit conditioned upon these
transit parameters and that the geometry permits the planet
to transit at all as Pr( ˆd|Θ, ˆb), where ˆb is short-hand for b < 1.
In what follows, a basic assumption of this work is that

Pr( ˆd|Θ, ˆb) ∝ SNRmulti,

(22)

which states that the probability of detecting a transit is
proportional to its SNR. Whilst this assumption is intuitive,
it is worth pausing to consider its validity in the case of the
most comprehensive transit survey to date, Kepler .

The formal criterion for a Kepler detection is that the
transit events display a SNR exceeding 7.1 (Jenkins et al.
2010). This assumption implies that the probability of de-
tection, Pr( ˆd|Θ, ˆb), follows a cumulative normal distribution
centered on 7.1 with a standard deviation of unity (Chris-
tiansen et al. 2015), as shown in Figure 1.

In practice, this simple model has been found to be an
unrealistic representation of the Kepler detections. Fressin
et al. (2013) argue that modeling Pr( ˆd|Θ, ˆb) as linearly pro-
portional to SNR (the same assumption we make here) de-
scribes the data far better. However, recently, Christiansen

Figure 1. Probability of detecting an injected transit of a known
SNR into the Kepler pipeline for FGK dwarfs (data taken from
Christiansen et al. 2015). The top-left key lists various models in
chronological publication order, where the last is derived here us-
ing updated parameters for the Fressin et al. (2013) ramp, which
provides a reasonable description with a suﬃciently analytically
simple model to make progress within this work.

et al. (2015) used injection/recovery simulations to show
that Pr( ˆd|Θ, ˆb) is best described by a Γ cumulative distri-
bution, as shown in Figure 1. Nevertheless, ﬁtting updated
parameters to the Fressin et al. (2013) ramp model1 condi-
tioned on the FGK dwarf injection tests of Christiansen et
al. (2015) reveals that a linear model still provides an excel-
lent description, as evident in Figure 1. Due to its analytic
convenience, reasonable accuracy, and general applicability
to other surveys, we adopt the linearly proportional assump-
tion throughout.

We also note that detection functions tend to truncate
to unity probability at a high SNR. Our model does not di-
rectly account for this truncation, but we argue that this
does not aﬀect our results for the following reason: in the
limit of high SNR, the priors have little eﬀect on the pos-
teriors, since the data overwhelms any prior assumptions.
Therefore, although we do not truncate our probability func-
tion, it is, practically speaking, unnecessary. We caution that
this would not be true for those wishing to use our formalism
for hierarchical modeling of occurrence rates or population
parameters.

3.2 Joint Prior of the Transit Parameters
Using Bayes’ theorem, the prior distribution of Θ, condi-
tioned upon ˆd and ˆb, is given by

Pr(Θ| ˆd, ˆb) ∝ Pr( ˆd|Θ, ˆb)Pr(Θ|ˆb),

(23)
We take a brief aside to explore the Pr(Θ|ˆb) term. From
Kipping (2014), Equation (2), the prior probability of a tran-
sit, deﬁned as being b < 1, modiﬁed to replace aR → ρ(cid:63), is
given by

1 For those interested, we determined a ramp from SNR of 5.5 to
11.5 for the FGK dwarfs.

MNRAS 000, 1–12 (2016)

�������+���σ����������+���σ����������+�����������+����������������+Γ������������+Γ�������-���������������-��������������������������������������(�|Θ��)(cid:33)1/3

(cid:32)

3π
G

Pr(ˆb|Θ) =

P−2/3ρ−1/3

(cid:63)

(cid:32)

(cid:33)

.

1 + esinω
1− e2

(24)

The above essentially assumes p (cid:28) 1, since grazing
events do not contribute as “transits.” Using Bayes’ theo-
rem, then, one may write that

Bayesian priors for transiting planets

5

In the above, one can see that the usual a posteriori
probability, Pr(Θ|D), which does not account for observa-
tional bias, is one of the two multiplicative terms. Conse-
quently, modifying Pr(Θ|D) → Pr(Θ|D, ˆd, ˆb) is equivalent to
modifying Pr(D|Θ) → Pr( ˆd, ˆb|Θ)Pr(D|Θ). In other words, the
log likelihood function is modiﬁed as

Pr(Θ|ˆb) ∝ Pr(ˆb|Θ)Pr(Θ),

and thus

(25)

log L → log L + log[Pr( ˆd, ˆb|Θ)].

(33)

Therefore, we may implement the prior via log likeli-

hood penalization. Using Equation (28) allows us to write

Pr(Θ| ˆd, ˆb) ∝ Pr( ˆd|Θ, ˆb)Pr(ˆb|Θ)Pr(Θ).

(26)
where it is evident from Equation (24) that Pr(ˆb|Θ)
is in fact independent of p and b. Since Pr( ˆd, ˆb|Θ) ∝
Pr( ˆd|Θ, ˆb)Pr(ˆb|Θ), we may re-write Equation (26) as

log[Pr( ˆd, ˆb|Θ)] = logκ + 2log p +

log[1− b2],

1
4

(34)

where

Pr(Θ| ˆd, ˆb)

∝

Pr( ˆd, ˆb|Θ)

(cid:124)

(cid:123)(cid:122)

(cid:125)

(cid:124)

(cid:123)(cid:122)

(cid:125)

overall prior

observational bias

(cid:124)(cid:123)(cid:122)(cid:125)

Pr(Θ)

intrinsic prior

.

(27)

logκ ≡ −log[P]− 1
2

log[ρ(cid:63)]− 3
4

log[1− e2] +

1
2

log[1 + esinω].

(35)

where Pr( ˆd, ˆb|Θ) is proportional to the product of Equa-

tions (20) & (24), yielding

Pr( ˆd, ˆb|Θ) ∝ P−1ρ−1/2

(cid:63)

(1− e2)−3/4(1 + esinω)1/2(1− b2)1/4 p2.
(28)

It is worth noting that in the above, all of the terms
except e and ω are separable, and Equation (28) can be
expressed as

Pr( ˆd, ˆb|Θ) ∝ Pr( ˆd, ˆb|P)Pr( ˆd, ˆb|ρ(cid:63))Pr( ˆd, ˆb|e,ω)Pr( ˆd, ˆb|b)Pr( ˆd, ˆb|p).
(29)

3.3 Implementing the Prior

In order to show how to employ the derived priors, we con-
sider the typical usage, which is to infer the posterior dis-
tribution of Θ, conditioned upon some data (in our case a
photometric time series) D. We may express the joint pos-
terior probability of the parameters as

(cid:124)

Pr(Θ|D, ˆd, ˆb)
posterior, P

∝ Pr(D|Θ, ˆd, ˆb)
likelihood, L

(cid:125)

(cid:124)

(cid:123)(cid:122)

(cid:123)(cid:122)

(cid:125)

(cid:124)

(cid:123)(cid:122)

Pr(Θ| ˆd, ˆb)
prior,π

(cid:125)

.

(30)

In the above, our posterior probability is conditioned
on i) the available data, D ii) the fact the planet transits,
ˆb, and iii) the fact the transit is detectable, ˆd. Formally, the
likelihood is also conditioned upon ii) and iii), in addition to
the data, yet the likelihood is actually independent of these
terms, i.e.

Pr(D|Θ, ˆd, ˆb) = Pr(D|Θ).

(31)

Substituting Equations (27) & (31) into Equation (30),

we may write

Pr(Θ|D, ˆd, ˆb) ∝ Pr( ˆd, ˆb|Θ)Pr(D|Θ)Pr(Θ)

.

(32)

(cid:124)

(cid:123)(cid:122)

∝Pr(Θ|D)

(cid:125)

MNRAS 000, 1–12 (2016)

Note that we do not consider the scaling with respect
to Γ or Tobs, since the photon collection rate and temporal
baseline are known to high precision and are independent of
the basic parameters describing the transit.

As practical advice, those wishing to account for the
observational bias (including the geometric bias) need only
penalize their log likelihood function using Equation (34).
In doing so, they are still free to use any intrinsic priors
they desire, including covariant priors, yet the observational
bias terms are separable to a good approximation and easily
accounted for using the above.

4 ADVANCED PRIORS

4.1 A More Accurate SNR

Based on the analytical form for the SNR of a trapezoidal
transit and the geometric bias of the transit method, we
have derived the a priori probability of the basic transit
parameters for a planet detected to transit, Pr(Θ| ˆd, ˆb).

In order to do this, we made various approximations
to the SNR expression shown in Equation (17). The result
of these approximations was a simple, elegant log likelihood
penalization term (Equation 34). Whilst this is undoubtedly
useful, especially for illustrating overall trends, we discuss
here a more accurate estimate.

The biggest problem with using Equation (34) is that
b = 1 has zero probability, but the SNR should not go to
zero until b = (1 + p). Therefore, our proposed simple form
truncates a part of parameter space. To derive a superior
approximation, we return to Equation (17).
In the case of non-grazing events, we ﬁrst tried approx-
imating (T14 + T23)/2 (cid:39) ˜T (see Kipping 2010 for deﬁnitions).
However, this approximation becomes increasingly inaccu-
rate as b → (1− p) (see Figure 2). For a more accurate ex-
pression, we only apply aR (cid:29) 1, allowing us to make small-
angle approximations, to show that:

6 Kipping & Sandford

Figure 2. Comparison of three approximations (colored lines)
to the full SNR expression (black) for non-grazing transits. We
here adopt p = 0.1, P = 3 days, aR = 10, e = 0.1 and ω = 0. Whilst
the most approximate form (Equation 20) only broadly repro-
duces the shape, assuming only aR (cid:29) 1 (Equation 36) provides an
excellent approximation.

Figure 3. Comparison of three approximations (colored lines)
to the full SNR expression (black) for grazing transits. We here
adopt p = 0.1, P = 3 days, aR = 10, e = 0.1 and ω = 0. The most
approximate form (Equation 20) poorly reproduces the shape, but
assuming aR (cid:29) 1 and λ → fλ (Equation 37) provides an excellent
approximation.

lim
aR(cid:29)1

SNRnon-grazing

multi

=

νmulti

(cid:16)(cid:113)

2

((1 + p)2 − b2)−1/4 p2
(1 + p)2 − b2 +

(cid:113)
(1− p)2 − b2(cid:17)

,

(36)

where the superscript “non-grazing” deﬁnes the condi-
tion under which the above is valid. In the limit of p → 0,
this SNR expression reduces to the simpler approximation
of Equation (20).

In the case of a grazing event, we formally need to use

the λ function deﬁned earlier in Equation (13):

lim
aR(cid:29)1

SNRgrazing

multi =

νmulti

2

((1 + p)2 − b2)1/4λ .

(37)

The λ function (Equation 13) can be approximated to
high accuracy using the fλ derived in Appendix A (see Equa-
tion A7). Using this approximation, we may write

lim
aR(cid:29)1

lim
λ→ fλ

SNRgrazing

multi =

νmulti

2
(1 + p− b)2

((1 + p)2 − b2)1/4

(cid:32)
1− 2log4

4

(cid:104) 1 + p− b

2p

(cid:105)(cid:33)

.

(38)

As shown in Figure 3, this approximation provides an
excellent match to the true function with a considerably
simpler form than that of the λ function.
As expected, Equations (36) & (38) are equivalent in
the limit of b → (1− p), meaning that these two functions
join together at the boundary dividing them.

In Figure 4, we plot a sample of trapezoidal light curves
following our model, with the associated b and SNRsingle val-
ues listed as a visual guide.

Figure 4. Examples of the trapezoidal transits following our
model (colored lines). The adopted parameters are those of a typ-
ical hot-Jupiter, except for b, which is evenly spaced in (1− b2)
space. For each example transit, we list both the b value and the
associated SNRsingle (relative to the b = 0 case).

4.2 Updated Log Likelihood Penalty

The a priori probability of the transit parameters, condi-
tioned upon the fact that a planet transits and the transit is
detectable, is directly proportional to the SNR, as shown in
Equations (22) & (26). Furthermore, the only terms which
have been modiﬁed in the updated SNR equation are the
b and p terms. Therefore, we can continue to use the log
likelihood penalty scheme described in §3.3, except that we
modify the 2log p and 1

4 log(1− b) terms appropriately.

As an additional improvement, we modify the geomet-
ric bias (Equation 24) to include grazing events, such that
transits are now deﬁned as b < 1 + p. Following the method-
ology described in Kipping (2014), it may be shown that this
modiﬁes Pr(ˆb|Θ) → (1 + p)Pr(ˆb|Θ).

MNRAS 000, 1–12 (2016)

�����������≫����λ→�λ��������≫����λ→�λ��������≫�����→�����≪���������≫�����→�����≪�������-������������������-�����������������������������������������������������������������������������������������/(����→����)�����������≫����λ→�λ��������≫����λ→�λ��������≫�����→�����≪���������≫�����→�����≪��������������������������������������������������������������������������������������������������/(����→����)��������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������-������=�-������=��������=�������=��-�����-���-�����-�����-�����������������������������Accordingly, we may express the log likelihood penalty

Bayesian priors for transiting planets

7

,

(39)

logκ + logζ
−∞

to the transit parameters as

log(cid:2)Pr( ˆd, ˆb|Θ)(cid:3) =

1− p (cid:54) b < 1 + p
1 + p (cid:54) b < ∞
where κ is deﬁned in Equation (35), and

 logκ + logη 0 (cid:54) b < 1− p
log(cid:2)(1 + p)2 − b2(cid:3)
(cid:113)
(1− p)2 − b2(cid:3),
logζ ≡ log[1 + p] + 2log(cid:2)1 + p− b(cid:3) +

logη ≡ log[1 + p] + 2log p− 1
4
(1 + p)2 − b2 +

log4− log(cid:2)1 + p− b(cid:3) + log p

1
4

+ log(cid:2)(cid:113)
(cid:104)

+ log

(40)

log(cid:2)(1 + p)2 − b2(cid:3)
(cid:105)− log[log16].

(41)
In the above, the constant −log[log16] provides a con-
tinuous log-likelihood penalty over the range 0 < b < (1 + p)
and should not be discarded.

4.3 Marginalized Priors

We ﬁrst note that, as in the simple case, the observational
bias priors are largely separable, with the exceptions of e &
ω, and now p & b, being covariant:

Pr( ˆd, ˆb|Θ) ∝ Pr( ˆd, ˆb|P)Pr( ˆd, ˆb|ρ(cid:63))Pr( ˆd, ˆb|e,ω)Pr( ˆd, ˆb|b, p).

(42)

If we further assume that the intrinsic priors are
fully separable, then the above simpliﬁes the derivation of
marginalized priors, since we can write, for example,

Pr(P| ˆd, ˆb) ∝

Pr( ˆd, ˆb|Θ)Pr(Θ)dpdbdρ(cid:63) dedω

(cid:90) (cid:90) (cid:90) (cid:90) (cid:90)
∝ Pr( ˆd, ˆb|P)Pr(P),

(43)

where in the case of the above, adopting a log-uniform
period prior (∝ P−1), would mean that Pr(P| ˆd, ˆb) ∝ P−2. Re-
peating this for the other terms allows us to write

Pr(P| ˆd, ˆb) ∝ P−1Pr(P),
Pr(ρ(cid:63)| ˆd, ˆb) ∝ ρ−1/2
Pr(ρ(cid:63)),
Pr(e,ω| ˆd, ˆb) ∝ (1 + esinω)1/2
Pr(b, p| ˆd, ˆb) ∝ Pr( ˆd, ˆb|b, p)Pr(b)Pr(p),

(1− e2)3/4 Pr(e)Pr(ω),

(cid:63)

(44)

(45)

(46)

(47)

where we do not write out the last function due to its
split-domain nature (see §4.3.1 and §4.3.2 for discussion).
First, though, note that we do not impose speciﬁc intrinsic
priors in the above, allowing for ﬂexibility in their usage.
The only critical assumption in deriving the above is that
the intrinsic priors are separable.

4.3.1 The Case of p

In the case of the simple priors derived earlier, p and b are
separable, in which case one can show that

MNRAS 000, 1–12 (2016)

Figure 5. Red line shows the analytic (but highly elaborate)
functional dependency of Pr( ˆd, ˆb|p) with respect to p, which is
clearly super-quadratic (gray line) and very well approximated
by a power law of index 5/2 (black line). The pink line shows the
full function in the case where V-shaped (i.e., grazing) transits
are not considered “detections”.

Pr(b| ˆd, ˆb) ∝ (1− b2)1/4Pr(b),
Pr(p| ˆd, ˆb) ∝ p2Pr(p).

(48)

(49)

The latter expression reﬂects our intuition that detected
transits are biased towards larger planets with a quadratic
scaling. The bias evident in Pr(b| ˆd, ˆb) is likely unfamiliar to
the reader, but we show in Figure 9 that this provides a
good match to observations.
For the more advanced case, calculating the one-
dimensional marginalized Pr(p| ˆd, ˆb) and Pr(b| ˆd, ˆb) can only
be accomplished by assuming an intrinsic prior for Pr(p) and
Pr(b). For impact parameter b, a uniform prior is reasonable
and expected, but p is somewhat non-trivial. Before tackling
this issue, though, the fact that we can deﬁne Pr(b) means
we can marginalize it out to derive Pr(p| ˆd, ˆb). Doing so leads
to a highly elaborate expression (which cannot be compactly
written out here) involving generalized hypergeometric func-
tions.
Plotting our solved function, Pr(p| ˆd, ˆb) (which is purely
dependent on p) in Figure 5 reveals that the function is
super-quadratic with respect to p. This implies that if one
assumed a detection bias of p2, one would underestimate
the true number of small planets, since the bias towards p
is actually sharper than this. Additionally, we observe that
the plotted function closely resembles a power-law for which
which can ﬁt the index. We therefore approximate

Pr(p| ˆd, ˆb) ∝ pαPr(p).

(50)
A least-squares ﬁt of samples suggests α = 2.424, but
plotting even α = 5/2 reveals excellent agreement. It is im-
portant to stress that this value is not dependent upon any
assumption regarding the intrinsic priors except that impact
parameter is uniformly distributed and separable from p.
Under this assumption, and the assumption that detectabil-
ity is proportional to SNR, geometric eﬀects conspire to
favor the detection of planets with a scaling of p5/2. We

�(���|�)�(���|�)�(���|�)∨�<�-��(���|�)∨�<�-�~��~��~��/�~��/������������������������-��-�������������������8 Kipping & Sandford

Figure 6. Colored lines show the analytic (but highly elaborate)
functional dependency of Pr( ˆd, ˆb|b) with respect to b.

also tried repeating the derivation marginalizing over only
b < 1− p, which is equivalent to insisting that V-shaped tran-
sits are not considered “detections.” This line, plotted in pink
in Figure 5, reveals a turn-over at p = 0.696, since it is in-
creasingly unlikely for the disk of a large planet to fully pass
in front of the star.

4.3.2 The Case of b

We are unable to derive a closed-form expression for the
marginalized prior Pr(b| ˆd, ˆb). Instead, we perform the inte-
gral numerically over a grid of b values in order to plot the
functional form of the expression. For this calculation, we as-
sume that the logarithm of p is distributed uniformly from
10−3 to a ﬁxed upper limit, which we try varying.

The results, shown in Figure 6, illustrate that the func-
tional form is generally ﬂat at low b and follows the ap-
proximate shape of the simple form derived earlier (i.e.
(1− b2)1/4). The eﬀect of the p marginalization largely ap-
pears to be that of a convolution kernel, smoothing out the
distribution.

4.3.3 The Case of e

For eccentricity and argument of periastron, we assume that
ω has a uniform intrinsic prior. Regardless of the intrinsic
prior for e, we ﬁnd that marginalizing over ω is possible
analytically, as

(cid:90) 2π

ω=0

Pr(e| ˆd, ˆb) ∝ Pr(e)

giving

Pr(e| ˆd, ˆb) ∝

Pr(e)

(1− e2)3/4

Pr(e,ω| ˆd, ˆb)Pr(ω)dω,

(cid:32)√

1− eE

(cid:105)

(cid:104) 2e

e− 1

√
1 + eE

+

(51)

(cid:105)(cid:33)

,

(cid:104) 2e

e + 1

(52)

where E(x) is the complete elliptic integral of x. The
above is essentially an exponential-like function multiplied

Figure 7. Solid colored lines show Pr(ω| ˆd, ˆb), whereas dashed
lines show Pr(ω|ˆb) for comparison, using the same inputs. Includ-
ing detection bias somewhat suppresses the strong bias towards
periastron transits.

by the intrinsic e prior and thus distorts the observed eccen-
tricity distribution towards more elliptical orbits than the
true underlying distribution.

4.3.4 The Case of ω
Repeating this trick for ω is more challenging and is func-
tionally dependent upon the assumed form for Pr(e). In what
follows, we adopt a Beta distribution for e, for reasons dis-
cussed in Kipping (2013). Whilst a closed-form expression
was not found, numerically marginalizing over e for three
diﬀerent choices of the Beta shape parameters allows us to
visualize the eﬀect of the detection bias, as shown in Fig-
ure 7.

In this ﬁgure, we compare the results of including both
detection bias and geometric bias (this work), versus the ge-
ometric bias alone (expressions of Kipping 2014). It is clear
that our expressions signiﬁcantly suppress the ω biases, lead-
ing to a population more evenly distributed with respect
to ω. This can be understood by considering that apastron
transits, whilst geometrically disfavored, have a signiﬁcant
detection enhancement due to their longer transit durations.

4.4 Testing the Priors

We decided to test that our proposed log likelihood penalty
function produces the expected distributions in the case of a
numerical simulation. For this test, we performed a numeri-
cal parameter exploration using MultiNest (Feroz & Hob-
son 2008; Feroz et al. 2009), where the likelihood function
was completely determined by the transit priors of Equa-
tion (39).

To this end, we wrote a simple PYTHON code to com-
pute the log likelihood function, ExoPriors, which we make
publicly available at this URL. For the intrinsic parameter
priors, we used a log-uniform distribution for p, ρ(cid:63) & P, a
uniform distribution for b & ω, and a Beta distribution for e,
setting α = 1 and β = 3. We plot the 105 a posteriori samples
as a triangle plot in Figure 8.

MNRAS 000, 1–12 (2016)

~(�-��)�/�~(�-��)�/��(���|�)∨�<��(���|�)∨�<��(���|�)∨�<����(���|�)∨�<����(���|�)∨�<����(���|�)∨�<����(���|�)∨�<����(���|�)∨�<������������������������������������������������(ω|�(cid:2)��(cid:2))�(ω|�(cid:2)��(cid:2))�~ℬ[���]�~ℬ[���]�~ℬ[���]�~ℬ[���]�~ℬ[����]�~ℬ[����]�(ω|�(cid:2))�(ω|�(cid:2))�π�π��π�π�π��π��π��π���������������������ω[����]�������������The one-dimensional marginalized forms derived in §4.3
display excellent agreement with the numerical results. This
demonstrates that the log-likelihood function derived in this
work produces the expected a priori distributions.

4.5 Extension to Occultation Events

Occultations, or secondary eclipses, represent a particu-
larly useful application of the priors developed here. If
the occultation is primarily due to reﬂected light from the
planet, then the eclipse depth is attenuated by a factor of
Ag(a/R(cid:63))−2, where Ag is the geometric albedo, compared to
the transit. If due to thermal emission from the planet, then
the eclipse depth is attenuated by a factor of ∼ (TP/T(cid:63)) (in
the Rayleigh-Jeans limit), where TP is temperature of the
planet. In either case, the depth δ will be much lower for the
occultation than the transit, meaning that one is more likely
to make inferences of parameters in the low SNR regime,
where the assumed priors will have a greater inﬂuence on
the posteriors. Additionally, our trapezoidal model for the
eclipse shape is nearly perfect in the case of occultations due
to the lack of limb darkening eﬀects.

In practice, occultations are usually only detected for
well-known transiting planets, which implies the extra con-
dition that the planet is known to transit, ˆb. In such cases,
there is no need to include the bias ˆd, since the planet transit
event is likely a very high SNR event and thus far beyond
the detection bias ramp (see §3.1). Therefore, observers are
perhaps most interested in Pr(Θ| ˆbocc,
ˆdocc, ˆb). The case with-
out any detection bias, Pr(Θ| ˆbocc, ˆb), may be expressed via
Bayes’ theorem as

Pr(Θ| ˆbocc, ˆb) ∝ Pr( ˆbocc|Θ, ˆb)Pr(ˆb|Θ)Pr(Θ).

(53)

If a transit is known to occur, then we know b < (1 + p).
The impact parameter of the occultation event is given by2

(cid:32)

(cid:33)

bocc = b

1 + esinω
1− esinω

,

(54)

so bocc,max = (1 + p)(1 +esinω)(1−esinω)−1. Computing
the geometric probability of an occultation in the usual way
(see e.g. Equation 2 of Kipping 2014) but including this limit
allows us to write

Pr( ˆbocc|Θ, ˆb) = Min

(cid:104) 1− esinω
(cid:105)
1 + esinω ,1

,

(55)

which we re-write as

1 + esinω(2H[ω − π]− 1)

Pr( ˆbocc|Θ, ˆb) =

1 + esinω

(56)
where H is the Heaviside step function. Having deﬁned
the relevant terms in the expression for Pr(Θ| ˆbocc, ˆb), we use
Bayes’ theorem to incorporate detection bias:

.

Pr(Θ).

(58)

(cid:33)

(59)

Bayesian priors for transiting planets

9

Pr(Θ| ˆdocc,

ˆbocc, ˆb) ∝ Pr( ˆdocc|Θ,

ˆbocc, ˆb)Pr(Θ| ˆbocc, ˆb).

(57)

In order to make further progress, we make the approx-

imation that Pr(Θ| ˆdocc,

ˆbocc, ˆb) ∝ Pr(Θ| ˆdocc,

ˆbocc) to write

Pr(Θ| ˆdocc,

ˆbocc, ˆb) ∝ Pr( ˆdocc|Θ,

(cid:124)

(cid:123)(cid:122)

ˆbocc)Pr( ˆbocc|Θ, ˆb)Pr(ˆb|Θ)
observational bias

(cid:125)

(cid:32)

We then use Pr(Θ| ˆdocc,

ˆbocc) ∝ SNRocc to write

Pr(Θ| ˆdocc,

ˆbocc, ˆb) ∝SNRocc

1 + esinω(2H[ω − π]− 1)

1− e2
(1 + p)Pr(Θ).

P−2/3ρ−1/3

(cid:63)

SNRocc may be calculated from SNRtransit, given by
Equations (36) and (38), by ﬁrst noting that the signal-to-
noise ratio in the occultation case is essentially attenuated
by a factor of δocc/δ . Second, since occultations occur at
superior, rather than inferior, conjunction, we modify the
term (1 + esinω) → (1− esinω). Finally, we replace b with
bocc, deﬁned in Equation (54). We may then express the log
likelihood penalty terms in the occultation case as:

logκocc ≡ −log[P]− 1
2

log[ρ(cid:63)]− 3
4

log[1− e2]
+ log[1 + esinω(2H[ω − π]− 1)]− 1
2

log[1− esinω].

(60)

and

logηocc ≡ log[1 + p] + logδocc − 1
4
(1 + p)2 − b2

log(cid:2)(1 + p)2 − b2
(cid:113)
logζocc ≡ log[1 + p] + 2log(cid:2)1 + p− bocc
(cid:3) +
(cid:3) + log p
log4− log(cid:2)1 + p− bocc

+ log(cid:2)(cid:113)
(cid:104)

occ
(1− p)2 − b2
occ

occ +

1
4

+ log
+ logδocc − 2log p− log[log16].

(cid:3)
(cid:3),

(61)

log(cid:2)(1 + p)2 − b2
(cid:105)

occ

(cid:3)

(62)

4.6 Blended Systems

We note that the eﬀect of blending for both transits and
occultations is to, again, attenuate the depth by a factor of B,
where B is equal to the ﬂux of the target star plus the blend
source, divided by the ﬂux of the target star (see Equation 5
of Kipping & Tinetti 2010). Thus, one only needs to add
the term −logB to the log likelihood penalty to account for
blends.

5 DISCUSSION

2 In what follows, we deﬁne the impact parameters of the tran-
sit and occultation as the sky-projected separation between the
planet and the star at the instant of inferior and superior con-
junction, respectively. Technically, this is a low-eccentricity ap-
proximation, as explained in Kipping (2011).

In this work, we have derived, from ﬁrst principles, the a
priori probability distribution of the basic transit parame-
ters conditioned upon the fact a transit is detectable. Impos-
ing this condition and making several reasonable approxima-
tions allows us to write down a simple analytic expression

MNRAS 000, 1–12 (2016)

10 Kipping & Sandford

Figure 8. Triangle plot of the posterior distributions from a ﬁt with no data and using a likelihood deﬁned by our priors. The solid
blue lines overlaid on each histogram follow the one dimensional marginalized forms derived in §4.3, displaying good agreement. The
pink lines denote the intrinsic priors assumed (before accounting for detection bias).

for these priors. We suggest observers use these priors in an-
alyzing their transit data, particularly in the regime of low
SNR events (typical for occultations), where the posterior
distributions will be more heavily inﬂuenced by the priors.

A prior basically accounts for the observer’s expecta-
tion. For example, if one were to ﬁt a random transit light
curve and derive a near-grazing conﬁguration, the appro-
priate response would be to be skeptical on the basis that

such events are relatively diﬃcult to discover due to their
shorter durations. Adopting the prior Pr(b| ˆd, ˆb) would for-
mally account for this expectation. Of course, strong data
can overwhelm the prior and still result in a near-grazing
event.

In the case of the impact parameter b, our derived prior
is consistent with observed trends from transit surveys. We
turn to Swift et al. (2015), who derived homogeneous poste-

MNRAS 000, 1–12 (2016)

Bayesian priors for transiting planets

11

ACKNOWLEDGMENTS

This research has made use of
the Exoplanet Orbit
Database and the Exoplanet Data Explorer at exoplan-
ets.org, and the corner.py code by Dan Foreman-Mackey
at github.com/dfm/corner.py.

REFERENCES

Balan, S. T. & Lahav, O., 2009, MNRAS, 394, 1936
Barnes, J. W., 2007, PASP, 119, 986
Burke, C. J., 2008, ApJ, 679, 1566
Carter, J. A., Yee, J. C., Eastman, J., Scott, S. B. & Winn, J. N.,

2008, ApJ, 689, 499

Chen, J. & Kipping, D. M., 2016, submitted
Christiansen, J. L. et al., 2015, ApJ, 810, 95
Dressing, C. D. & Charbonneau, D., 2015, ApJ, 807, 45
Eastman, J., Gaudi, S. B. & Agol, E., 2013, PASP, 125, 83
Feroz, F. & Hobson, M. P., 2008, MNRAS, 384, 449
Feroz, F., Hobson, M. P. & Bridges, M., 2009, MNRAS, 398, 1601
Fressin, F. et al., 2013, ApJ, 766, 81
Gazak, J. Z., Johnson, J. A., Tonry, J., Dragomir, D., Eastman,

J., Mann, A. W. & Agol, E., 2012, Adv. Astron., 2012, 30
Hogg, D. W., Myers, A. D. & Bovy, J., 2010, ApJ, 725, 2166
Jenkins, J. M. et al., 2010, ApJ, 713, 87
Kipping, D. M., 2010, MNRAS, 407, 301
Kipping, D. M. & Tinetti, G., 2010, MNRAS, 407, 2589
Kipping, D. M., 2011, Ph.D. thesis, University College London

(arXiv e-prints:1105.3189)

Kipping, D. M., 2013, MNRAS, 434, L51
Kipping, D. M., 2014, MNRAS, 444, 2263
Mandel, K. & Agol, E., 2002, ApJ, 580, 171
Mayor, M. & Queloz, D., 1995, Nature, 378, 355
Petigura, E. A., Howard, A. W. & Marcy, G. W., 2013, PNAS,

110, 19273

Rowe, J. F., Bryson, S. T., Marcy, G. W. et al., 2014, ApJ, 784,

45

Swift, J. J., Montet, B. T., Vanderburg, A., Morton, T., Muir-

head, P. S. & Johnson, J. A., 2015, ApJ, 218, 26

Van de Kamp, P., 1963, AJ, 68, 515
Wolfgang, A., Rogers, L. A. & Ford, E. B., 2015, ApJ, submitted

(arXiv e-prints:1504.07557)

Wolszczan, A. & Frail, D. A., 1992, Nature, 355, 145

APPENDIX A: AN APPROXIMATION FOR λ
The expression for λ (Equation 13) is restrictive for further
analytic work, and thus we seek an approximation via a
simple polynomial, aiming to capture both the curvature
and boundary conditions of the function. Consider using a
so-called “smooth-step” function, f [x], over the interval 0 <
x < 1, where f [x] varies smoothly from f [0] = 0 to f [1] = 1.
The function λ is approximated by

λ (cid:39) p2 f [S (cid:48)],
1 + p− S
S (cid:48) =

2p

.

(A1)

The simplest function we might propose is f1[x] = x,
which is simply a straight line. A common smooth-step func-
tion used in computer graphics is

Figure 9. Cumulative distribution of the impact parameter for
the sample of Kepler planetary candidates studied in Swift et
al. (2015). The measured distribution (green) is reasonably well
approximated by the (simple case) prior Pr(b| ˆd, ˆb) of Equation (28)
derived in this work.

rior distributions for the basic transit parameters, including
b, of 163 Kepler planetary candidates. The cumulative dis-
tributions of these terms are shown in Figure 9 of that work,
of which we reproduce a version in Figure 9 here.

Despite the fact that Swift et al. (2015) impose a uni-
form prior on b, the cumulative distribution drops oﬀ at high
b, reproducing our a priori expectation that such cases are
indeed less frequent in a SNR-limited survey such as Ke-
pler . Figure 9 compares the measured distribution to that
predicted by the prior Pr(b| ˆd, ˆb) in the simple case3 of Equa-
tion (28), which displays a reasonable match to the observed
shape.

We note that our prior does not involve Γ or SNR as
direct terms. In the case of inﬁnite (or very large) SNR, the
condition of detecting a transit should no longer aﬀect the
posteriors. This statement remains true even in our current
parametrization, since in such a limit of inﬁnite SNR, the
data will completely overwhelm the priors in any case, and
thus our priors, as expected, will have no eﬀect on the ﬁnal
result.

We may quantify the information gained by invoking
our modiﬁed prior using the Kullback-Leibler divergence.
Ignoring P and ρ(cid:63) due to their non-trivial intrinsic priors
and assuming uniform intrinsic priors for all other terms,
we ﬁnd the information gain is 2.796 nats. Our prior, then,
eﬀectively shrinks the uninformative prior volume by a fac-
tor of exp(2.796), or a factor of (cid:39) 16.

We have written a PYTHON code in the publicly available
package ExoPriors to allow the community to use our priors.
The code can produce priors under a variety of conditions,
such as in the limit of inﬁnite SNR (where only the geometric
bias, not the detection bias, is included), in the case where
grazing events are not considered detections, and in the case
of occultations.

3 Since the more advanced priors display covariance between b
and p, we cannot plot these without knowledge of the intrinsic p
distribution.

f2[x] = 3x2 − 2x3.

(A2)

MNRAS 000, 1–12 (2016)

��������������������������������������������������12 Kipping & Sandford

Figure A1. Comparison of several “smooth-step” approxima-
tions to the λ function. Our newly derived function, fλ , provides
an excellent match.

Several other smooth-step functions exist at higher or-

der, such as

f3[x] = 6x5 − 15x4 + 10x3,
f4[x] = −20x7 + 70x6 − 84x5 + 35x4.

(A3)

(A4)

Plotting these functions in Figure A1, it apparent that
the true function, λ , lies between f1[S (cid:48)] and f2[S (cid:48)]. We
therefore seek to generalize the f2[S (cid:48)] expression by writing:

fλ [x] = (α + 1)xβ − αxγ .

(A5)

We note

the λ function intersects

1
that
for
2
limp→0 λ (p,1) = 1
2 ] = 1
2 , which implies that we expect fλ [ 1
2 .
Imposing the above and solving for α allows us to replace
α = − 2γ−1(2β − 2)

2β − 2γ

.

(A6)

Experimenting with diﬀerent low-integer combinations
of β and γ, we ﬁnd that setting β = γ = 2 yields a close
match. Indeed, setting β = γ and applying a least squares
ﬁt for β converges to 2. Adopting this value, we therefore
use the following approximate expression for λ (plotted in
Figure A1):

fλ [x] = x2(1− log4 x2).

(A7)

This paper has been typeset from a TEX/LATEX ﬁle prepared by
the author.

MNRAS 000, 1–12 (2016)

λ[�]λ[�]��[�]��[�]��[�]��[�]��[�]��[�]��[�]��[�]�λ[�]�λ[�]�-���+����/���λ