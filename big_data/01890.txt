6
1
0
2

 
r
a

M
6

 

 
 
]
h
p
-
t
n
a
u
q
[
 
 

1
v
0
9
8
1
0

.

3
0
6
1
:
v
i
X
r
a

A Quantum Extended Kalman Filter

Muhammad F. Emzir, Matthew J. Woolley, and Ian R. Petersen
School of Engineering and IT , University of New South Wales, ADFA, Canberra, ACT 2600,
Australia

E-mail: m.emzir@student.adfa.edu.au

March 2016

Abstract. A stochastic ﬁlter uses a series of measurements over time to produce estimates of unknown
variables based on a dynamic model[1]. For a quantum system, such an algorithm is provided by a
quantum ﬁlter [2], which is also known as a stochastic master equation (SME)[3]. For a linear quantum
system subject to linear measurements and Gaussian noise, the quantum ﬁlter reduces to a quantum
Kalman ﬁlter [4, 5].
In this article, we introduce a quantum extended Kalman ﬁlter (quantum EKF), which applies a
commutative approximation and a time-varying linearization to non-commutative quantum stochastic
diﬀerential equations (QSDEs). We will show that there are conditions under which a ﬁlter similar to
the classical EKF can be implemented for quantum systems. The boundedness of estimation errors
and the ﬁltering problems with ‘state-dependent’ covariances for process and measurement noises are
also discussed.
We demonstrate the eﬀectiveness of the quantum EKF by applying it to systems which involve multiple
modes, nonlinear Hamiltonians and simultaneous jump-diﬀusive measurements.

1. Introduction

In light of recent advances in quantum engineering, the need to eﬀectively measure and
control complex quantum systems has become more crucial. One requirement is to
infer unknown observables of a quantum system from noisy measurements based on a
dynamic model, a process known as a ﬁltering. The quantum ﬁlter was developed in
the 1980’s by Belavkin [2, 6, 7, 8]. It has recently been used in experimental systems
such as trapped ions [9], cavity QED systems [10], and optomechanical systems [11].
The real-time application of the quantum ﬁlter demands an eﬃcient computational
algorithm. The quantum ﬁlter in the Schr¨odinger picture, also known as the stochastic
master equation, solves the stochastic evolution of the conditional density operator based
on the measurement record. In practice, to numerically compute the ﬁlter, one has to
truncate the Hilbert space basis. The computation time then scales exponentially with
the size of the Hilbert space basis which makes the quantum ﬁlter diﬃcult to implement
in real-time.
In the Heisenberg picture, the quantum ﬁlter dynamics reduce to the dynamics of the
systems observables xt. However, for general nonlinear systems, the quantum ﬁlter

A Quantum Extended Kalman Filter

2

in the Heisenberg picture cannot be interpreted as an explicit solution to the ﬁltering
problem [12].
These two facts lead to the need for new approximation techniques. Among these are
a Gaussian approximation of the conditional density operator [13, 14]. This work is
rather heuristic and lacks an evaluation of the estimation error. Number phase Wigner
particle ﬁlters have also been suggested[15], but like most particle ﬁlter based techniques,
they are computationally expensive and not suitable for real-time ﬁltering. Recently
a Volterra series approximation [16] was introduced. Although this approach has a
tractable error bound [17], estimating the Volterra kernel is complicated in general, and
the ﬁlter structure is not recursive.
Our approach is to use a commutative operator approximation of the non-commutative
nonlinear QSDE. A ﬁrst order Taylor expansion of the nonlinear quantum Markovian
generator is then used to compute the ﬁlter gain. We refer to our approach as the
quantum extended Kalman ﬁlter (quantum EKF), due to the similarity of its structure to
the classical extended Kalman ﬁlter (EKF). Classical EKF estimation error convergence
has been well studied [18, 19, 20, 21, 22], which has resulted in some criteria that
guarantee local convergence behavior.
The main diﬃculty in this approach is that the quantum system, in contrast to a classical
system, is governed by a QSDE which involves non-commutative operators. This non-
commutativity implies that there is no isomorphism that could map the dynamics into
a standard stochastic diﬀerential equation (SDE). Due to the non-commutative nature
of the QSDE, generally the ordinary partial diﬀerentiation with respect to a system
observable may not be well deﬁned [23, 24]. Further, the sub-optimality condition of
the estimation error has to be deﬁned diﬀerently since the system’s observables are
operators in Hilbert spaces and not scalar random variables.
In this article, we provide a mathematical description of a quantum EKF. We then
establish a suﬃcient criterion under which the quantum EKF will satisfy a dissipativity
condition, which ensures the boundedness of the quadratic estimation error. The cases
where the quantum systems and their measurements have a state-dependent covariance,
i.e. they are functions of the system observables, are treated as an extension of the
quantum EKF. We show that it is suﬃcient to modify the behavior of the Riccati
diﬀerential equation to guarantee an equivalent dissipativity condition as the original
quantum EKF.
Finally, we demonstrate the application of the quantum EKF to two estimation
problems. The ﬁrst problem is the estimation of quadratures of two cavity modes
with Kerr nonlinearities [25] subject to homodyne detection. The second example is the
estimation of quadratures of a cavity subject to simultaneous homodyne detection and
photon counting measurements.
The readers are referred to [26] for an introduction to quantum probability, quantum
stochastic calculus, and quantum non-demolition measurements. We shall use the term
‘classical’ to refer to commutative dynamics and ﬁlters. We shall also use the term
‘state-dependent’ covariance to refer to covariance matrices that are functions of the

A Quantum Extended Kalman Filter

3

system observables.
The article is organized as follows. The second section will contain some preliminary
facts that are used in this article. The main section will describe the main contribution
of this work. The ﬁrst is the mathematical description of the quantum EKF and its
existence. The computational complexity of the quantum EKF is analyzed as compared
to the SME. Next, we analyze the convergence of the quantum EKF. Lastly, we show an
extension of the quantum EKF for state-dependent quantum systems. The third section
will be examples of quantum EKF applications, and the last section is the conclusions.

1.1. Notation

Classical probability spaces are denoted by a triple (Ω, (cid:70), µ). Plain letters (e.g. P )
will be used to denote elements of an algebra. (cid:80) will be used for a measure from a
von Neumann algebra (cid:65) to a complex number (cid:67), that is positive and normalized, i.e.
(cid:80) (A∗A) ≥ 0 and (cid:80) ((cid:49)) = 1. We also use (cid:69)(cid:80) (·|(cid:65)) to denote a conditional expectation
with measure (cid:80) with respect to a commutative von Neumann algebra (cid:65). Script face
(e.g. (cid:72) for Hilbert space) is used to denote a spaces as well as any type of algebra. A
class of operators will be denoted by calligraphic face, e.g., for bounded linear operators

from a Hilbert space (cid:72), to a Hilbert space (cid:75), we denote B ((cid:72), (cid:75)), and also we denote
B ((cid:72)) ≡ B ((cid:72), (cid:72)). Bold letters (e.g. y) will be used to denote a matrix whose elements
are operators on a Hilbert space. Hilbert space adjoints, are indicated by ∗, while the
complex conjugate transpose will be denoted by †, i.e. (X∗)
= X†. For single-element
, while their anti-commutator is given by {x, y} = xy(cid:62) +(cid:0)yx(cid:62)(cid:1)(cid:62)
[x, y] = xy(cid:62)−(cid:0)yx(cid:62)(cid:1)(cid:62)
operators we will use ∗ and † interchangeably. The commutator of x and y is given by
.

(cid:62)

2. Preliminary

α

(1)

In the classical stochastic case, the optimal nonlinear ﬁlter is given by the Kushner-
Stratonovich equation [27]. This equation is based on the existence of a sample
path, Xt, whose dynamics is described by a stochastic diﬀerential equation, e.g.
dXt = b(Xt)dt + σ(Xt)dWt. The nonlinear ﬁlter for a function of Xt, f (Xt), is then
given via the generator of the Markov process f (Xt),

Lf (Xt) ≡ lim
dt↓0

(cid:69) [f (Xt+dt)|Xt = x] − f (x)

.

dt

In the nonlinear quantum ﬁlter, the sample path of the underlying process Xt generally
does not exist [26], but instead, we have an equivalent evolution of a unitary operator.
By means of the evolution of the unitary operator, for open quantum system with
Hamiltonian (cid:72)t, and bath coupling operator (cid:76)t, the equivalent quantum Markovian
generator for a set of observables xt is given by [28]

(cid:16)

(cid:62)(cid:17)(cid:62)

L(xt) = − i

¯h

[xt, (cid:72)t] +

1
2

†
t [xt, (cid:76)t]

(cid:76)

+

1
2

(cid:62)

∗
t , xt]

[(cid:76)

(cid:76)t.

(2)

A Quantum Extended Kalman Filter

4

We begin our formulation by considering Hilbert spaces for the system and the
environment. First, let the system Hilbert space and the ﬁeld Boson Fock space, be
given by (cid:72)s and Γ((cid:104)). The total Hilbert space is given by (cid:72)T = (cid:72)s ⊗ Γ((cid:104)) and
(cid:72)T[0,t] = (cid:72)s ⊗ Γ((cid:104))[0,t]. The unitary evolution of the system interaction with the ﬁeld
is described by Ut ∈ U ((cid:72)s ⊗ Γ((cid:104))[0,t]), where U is the class of unitary operators on
the associated Hilbert spaces. Let the evolution of a system operator X be given by
t (X ⊗ (cid:49)) Ut where (cid:49) is identity operator in Γ((cid:104)). Furthermore, without loss of
Xt = U∗
generality, we will assume that the ﬁeld is initially on the vacuum state. Let the system
and ﬁeld’s initial density operators be given by ρ ∈ S((cid:72)s) , ω ∈ S(Γ((cid:104))), where S is
the class of unity trace operator on the associated Hilbert spaces.
The fundamental quantum processes as in [29] are given by dA∗
t , dAt, dΛt, the
annihilation, creation and conservation processes. These processes are forward time
t , dAt, dΛt ∈ B((cid:72)T[t,t+δt]) and hence commute with xt. The counting
diﬀerential, i.e. dA∗
and B[t,t+δt] ≡ B(cid:0)(cid:72)T[t,t+δt]
process dλt is deﬁned as the diagonal element of dΛt. From now on we let B ≡ B ((cid:72)T)
Furthermore, for given system and ﬁeld initial density operators (ρ ⊗ ω) there is a
corresponding measure (cid:80), called a state, which is positive linear and normalized. For a
bounded operator X ∈ Bt], (cid:80) (X) = Tr [Xρ ⊗ ω], see [29, Proposition 9.19].
Let us now ﬁx the von Neumann algebra (cid:78) = B, and the set of bounded self adjoint
operators in total Hilbert space, O = O ((cid:72)T) ⊂ (cid:78). We denote xt ∈ Ot to be a set of

(cid:1), B t] ≡ B(cid:0)(cid:72)T t]

(cid:1).

system observables evolved up to time t.
In the quantum probability setting, a quantum probability space is deﬁned by specifying
a von Neumann algebra (cid:78) and a state (cid:80). Let (cid:65) ⊂ (cid:78) be a commutative von Neumann
sub algebra. We call the set (cid:65)(cid:48) = {B ∈ (cid:78) : AB = BA, ∀A ∈ (cid:65)} the commutant of
(cid:65) in (cid:78). The conditional expectation in the quantum probability setting is deﬁned as
follows.
Deﬁnition 2.1. [26] For a given quantum probability space ((cid:78), (cid:80)), let (cid:65) ⊂ (cid:78) be a
commutative von Neumann sub-algebra. Then the map (cid:69)(cid:80) [·| (cid:65)] : (cid:65)(cid:48) → (cid:65) is called the
conditional expectation from (cid:65)(cid:48) onto (cid:65) if (cid:80) ((cid:69)(cid:80) [B| (cid:65)] A) = (cid:80) (BA) , ∀A ∈ (cid:65), B ∈ (cid:65)(cid:48).
The following theorem is fundamental to obtain the relation between quantum
probability and the classical Kolmogorov probability axioms. In addition, we will use
this theorem to show the implementation of the quantum EKF as a classical EKF in
the following section. The proof of the theorem is given in [30, §1.1.8][26].
Theorem 2.1. Let (cid:65) be a commutative von Neumann algebra. Then (cid:65) is ∗-isomorphic
to L∞ (Ω, (cid:70), µ), with ∗-isomorphism τ . Furthermore, a normal state (cid:80) on (cid:65) deﬁnes
a probability measure µP , which is absolutely continuous with respect to µ, such that,
(cid:80) (A) = (cid:69)µP (τ (A)), for all A ∈ (cid:65).

We notice here that the commutative von Neumann algebra (cid:65) corresponds to a

classical ﬁeld (cid:70), and every projection operator in (cid:65) corresponds to a classical event.

A Quantum Extended Kalman Filter

5

then

In the following discussion, we will use (cid:107)·(cid:107) the following semi-norm on B: if x ∈ Bn×1,
This quantity is not a norm since, (cid:80)(cid:0)x†x(cid:1) can be zero for non zero x that is

(cid:107)x(cid:107) ≡ (cid:80)(cid:0)x†x(cid:1) 1

(3)

2 .

perpendicular to the density operator. Furthermore, a partial order of two operators,
A > B is taken in the sense of (cid:80), where A > B in (cid:80) denotes (cid:80) (A − B) > 0. Now
suppose we have two operator vectors x ∈ (cid:65)(cid:48), ˆx ∈ (cid:65), where (cid:65) is a commutative von
Neumann algebra. Under semi-norm(3), by Deﬁnition 2.1, we obtain

(cid:16)
(cid:16)

(cid:104)

(cid:17)1/2

(cid:107)x − ˆx(cid:107) = (cid:80)

= (cid:80)

(x − ˆx)
†

(x − ˆx)

(x − ˆx)
†

(x − ˆx)

(cid:69)(cid:80)

(cid:12)(cid:12)(cid:12) (cid:65)

(cid:105)(cid:17)1/2

.

(4)

The last equation implies that, for any  > 0, {ω : (cid:107)x − ˆx(cid:107) < } ∈ (cid:65). That is, the event
that (cid:107)x − ˆx(cid:107) <  is (cid:65)− measurable. Later on we will use this fact to deﬁne a Markov
time when we are dealing with the stochastic stability of the quantum EKF, see Section
3.3.
For a self adjoint element T ∈ (cid:78) there is a ∗-isomorphism f → f (T ) from a continuous
function in the spectrum of T , IT = sp(T ) ∈ (cid:82), namely C(IT ), onto the C∗-subalgebra
C∗(T ) of (cid:78) generated by T and the identity element (cid:49).

The following two propositions show how one can deﬁne a partial derivative for an
operator diﬀerentiable mappings which will be used in the ﬁlter algorithm. Both have
been proved in [31, 32], but we mention the proof here again for the sake of completeness.
For the two propositions, we will recall the following deﬁnitions,
Deﬁnition 2.2. [33, 31]If (cid:88) and (cid:89) are Banach spaces with norm (cid:107)·(cid:107)(cid:88) and (cid:107)·(cid:107)(cid:89)
respectively, a mapping f : (cid:68) → (cid:89) on a subset (cid:68) of (cid:88) is Fr´echet diﬀerentiable at
T ∈ (cid:68) if there is a bounded linear operator D(f,T ) in B ((cid:88), (cid:89)), the class of linear

bounded functions from (cid:88) to (cid:89), such that,

(cid:13)(cid:13)f (T + S) − f (T ) − D(f,T )S(cid:13)(cid:13)(cid:89)

lim
S →0

(cid:107)S(cid:107)(cid:88)

= 0.

(5)

If D(f,T ) is deﬁned for every T ∈ (cid:88), then f is Fr´echet diﬀerentiable on (cid:68).
Deﬁnition 2.3. [31] Let (cid:85) be any unitary C-* algebra, and (cid:83) is the corresponding self
adjoint sub-algebra. For any continuous function f on the compact interval I, f ∈ C (I)

is said to be operator diﬀerentiable if the operator function

f : (cid:83)I → (cid:85),

is Fr´echet diﬀerentiable on (cid:68) = (cid:83)I, symbolically f ∈ C 1
op(I), then f ∈ C 1 (I)
Proposition 2.1. [32, 31] If f ∈ C 1

op(I).

A Quantum Extended Kalman Filter

6

Proof. Without losing of generality, we may assume that I is bounded,

i.e I =
{x ∈ (cid:82) : a ≤ i ≤ b}, and f : (cid:85) → (cid:85). Set (cid:85) = Cb (I), the set of a bounded continuous
functions on I. Since f ∈ C 1
op(I), the diﬀerentiability of f at a function g ∈ (cid:85) implies
that for every  > 0, there exists δ > 0 such that for any function h,(cid:107)h(cid:107) < δ

(cid:13)(cid:13)f (g + h) − f (g) − D(f,g)h(cid:13)(cid:13) ≤ (cid:107)h(cid:107) ,

(6)
which shows that, D(f,g)h : h → (f(cid:48) ◦ g) h. Suppose there exist two arbitrary points
x1, x0 ∈ I, satisfying |x1 − x0| < δ. Now let g(x) equal the identity function, and
h(x) = x0 − x1 constant. We get, (cid:107)h(cid:107) < δ, and at x = x1,

f (x1 + x0 − x1) − f (x1) − f(cid:48) (x1) (x0 − x1) = f (x0) − f (x1) − f(cid:48) (x1) (x0 − x1).

Next interchanging x0 and x1, we get,

f (x1) − f (x0) − f(cid:48) (x0) (x1 − x0).

Adding this and the previous equation, and dividing by (cid:107)x1 − x0(cid:107), we get

(cid:107)f(cid:48) (x0) − f(cid:48) (x1)(cid:107) < 

which shows the continuity of f(cid:48) on I.
Proposition 2.2. [31] If f ∈ C 1
commutative C-∗ algebra, then

op(I),

for any two elements S, T ∈ (cid:85), a unital

D(f,T )S = f(cid:48)(T )S.

Proof. Let S, T ∈ (cid:85), a unital commutative C-∗ algebra on the space (cid:88). We write,
f (T )(x) = f (T (x)),∀x ∈ (cid:88), so that, as the previous proposition, f (T ) = f ◦ T . Since
f ∈ C 1

op(I), by deﬁnition, there exists a diﬀerential DT f ∈ B ((cid:85), (cid:85)), such that,

f (T + S)(x) = f (T )(x) + D(f,T )S(x) + R(x),

(7)

where lim
→0

R = 0. By Proposition 2.1, it follows that,

D(f,T )S(x) = f(cid:48)(T (x))S(x),

as desired.

By deﬁnition the last proposition is also true for a commutative von Neumann

algebra, since any von Neumann algebra is a C-∗ subalgera of B ((cid:72)) that is strongly

closed and contains the identity, for (cid:72) is any Hilbert space [34].
The condition that (cid:85) is commutative in Proposition 2.2 is essential.

was proven that one can construct a C 1 function that is not operator diﬀerentiable [35].
Moreover, if f ∈ C 2, then its extension is operator diﬀerentiable, see [36, 37]. Hence
C 2 ⊆ C 1

In addition, it

op ⊆ C 1.

A Quantum Extended Kalman Filter

7

Deﬁnition 2.4. An operator A in a Hilbert space (cid:72) is single valued, if it can be written
as a scalar times an identity,

A = a(cid:49), a ∈ (cid:67).

(8)

A matrix A whose each elements are operators in (cid:72) is single valued if each element of
A is single valued.

3. Main Statement

3.1. Extended Kalman ﬁlter for a class of open quantum quantum systems with
diﬀusive and Poissonian measurements

t

t

, (cid:72) ∈ Om×1

Let G be an m channel open quantum system with parameters ((cid:83), (cid:76), (cid:72)), (cid:83) ∈ (cid:67)m×m, (cid:76) ∈
Bm×1
and (cid:83)(cid:83)† = (cid:83)†(cid:83) = I. The class of open quantum system that we
consider here is the one which has covariance matrices independent of xt. A more general
class of open quantum system with state-dependent covariances will be considered in the
following section. The smallest von Neumann algebra generated from the measurement
up to time t is given by (cid:89)t. As in the classical setting, we can always assume that the

von Neumann algebra (cid:89)t is right continuous, by taking (cid:89)t = (cid:89)t+ =(cid:84)

We assume that the scattering matrix (cid:83) is single valued. This implies that for any
Xt = U
system evolution can be described by a diﬀusive QSDE as follows[39]:

(cid:3) = 0. This ensures that the open quantum

t XUt, Tr(cid:2)(((cid:83)†Xt(cid:83)) − Xt)dΛ(cid:62)

s>t (cid:89)t [38].

†

t

dxt = f (xt)dt + G(xt)dA∗

t + G(xt)∗dAt,

(9a)

with,

f (xt) = L(xt),
G(xt) = [xt, (cid:76)t] (cid:83)

∗
t .

We shall assume that the number of measurements subject to the open quantum system

G also equal to m. The class of measurements of the quantum system above are assumed

to be a collection of m functions of output ﬁeld creation, annihilation, and conservation
processes, as below

dyt = Etd ˜A∗

t + E∗

t d ˜At + Ntd˜λt,

(10a)

where,

d˜λt = diag

(cid:16)

(cid:17)

d ˜Λt

,

d ˜At = (cid:83)tdAt + (cid:76)tdt,
∗
t dA∗
t (cid:76)

d ˜Λt = (cid:83)

(cid:62)
t + (cid:83)

∗
t dΛ(cid:83)

(cid:62)
t + (cid:76)

∗
t dA(cid:62)
t (cid:83)

(cid:62)
t + (cid:76)

∗

(cid:62)dt.

(cid:76)

A Quantum Extended Kalman Filter

8

To satisfy the non-demolition and self-nondemolition properties, Et and Nt have to
satisfy the algebraic condition in Theorem 3.1 of [12]. We could then simplify (10a) to

where Nt ∈ Om×m, and

dyt =h(xt)dt + L(xt)dA∗
∗
t + Ntlt,

h(xt) =E∗
L(xt) = (Et + Nt ¯(cid:76)) (cid:83)

t (cid:76)t + Et(cid:76)

∗
t ,

(cid:76)1,t
dαt = diag(cid:0)(cid:83)

¯(cid:76) =

0
0

0
0

···
(cid:76)i,t
···
(cid:76)m,t
(cid:62)
∗
t dΛ(cid:83)
t

(cid:1) .

t + L(xt)∗dAt + Ntdαt,

, lt =

 (cid:76)∗

1,t(cid:76)1,t
...

(cid:76)∗
m,t(cid:76)m,t

,

(11a)

(11b)

(11c)

Now, we deﬁne the variance and covariance of the system’s observables and
measurements as follows,

Qt =

Rt =

St =

1
2dt
1
2dt
1
2dt

(cid:69)(cid:80) [{dxt, dxt}| (cid:89)t] ,

(cid:69)(cid:80) [{dyt, dyt}| (cid:89)t] ,
(cid:69)(cid:80) [{dxt, dyt}| (cid:89)t] .

(12a)

(12b)

(12c)

The use of anti-commutator in (12) above ensures that each element of the variance
matrices is a self adjoint operator. In the remainder of the article, we require that Rt
is a positive deﬁnite matrix of operators in (cid:89)t, i.e τ (R)t,ω > 0, ∀t ≥ 0, ω ∈ Ω, where τ
is the ∗−-isomporhism from (cid:89)t to L∞ (Ω, (cid:70), µ).

We will use Proposition 2.2 to calculate the partial derivative of the nonlinear quantum
Markovian process generator f (x). As we will show shortly, we could establish a mild
condition on the quantum systems parameters (cid:83), (cid:76), (cid:72) so that fi, hj ∈ C 1
op((cid:82))∀i ≤
n, j ≤ m. The following proposition gives a suﬃcient condition under which fi, hj ∈
C 1
op((cid:82))∀i ≤ n, j ≤ m belongs to C 1
Proposition 3.1. In order to have fi, hj ∈ C 1
require that (cid:72), (cid:76) ∈ C 1
op((cid:82))
Proof. To prove this, we will ﬁrst claim that for any two function, g1, g2 ∈ C 1
I ⊆ (cid:82) , then g1g2 ∈ C 1
(cid:107)S(cid:107)(cid:85) = 1. Letting ε → 0, the linear operator Dgi,T as in (5) is given by

op(I), with
op(I). Without loss of the generality, we can ﬁx any S ∈ (cid:85), where

op((cid:82))∀i ≤ n, j ≤ m, it is suﬃcient to

op((cid:82)) and Et, Nt ∈ C 1

op((cid:82)).

gi (T + εS) − gi (T )

.

Dgi,T = lim
ε→0

ε

Therefore, we can write for g1g2,

g1g2 (T + εS) − g1g2 (T )

Dg1g2,T = lim
ε→0

ε

A Quantum Extended Kalman Filter

9

(g1 (T + εS) − g1 (T )) g2 (T + εS)

ε

g1 (T ) (g2 (T + εS) − g2 (T ))

ε

+ lim
ε→0

= lim
ε→0

= Dg1,T g2 + g1Dg2,T ,
which shows that g1g2 ∈ C 1

op(I).

Since I is arbitrary, the desired result follows

immediately by applying the claim to f and h.

Since the system’s observables belong to the commutant of the commutative von
Neuman algebra (cid:89)t, (cid:89)(cid:48)
t , it is reasonable to approximate each element of xt, xi,t, with
a set of commutative estimates ˆxi,t ∈ (cid:89)t. The diﬀerence ˜xi,t = xi,t − ˆxi,t also belongs
to the commutant algebra (cid:89)(cid:48)
t . Then for each ˜xi,t, both ˜xi,t and (cid:89)t generate a larger
commutative algebra (cid:90)i,t for which the Proposition 2.2 can be invoked to infer the
partial derivative of f (xt) with respect to xt at ˆxt. We could not go further beyond the
ﬁrst order term of the Taylor series as in the classical nonlinear ﬁlter since the second
order partial derivative of f (xt) will generally involve multiplication of two elements of
˜xi,t ˜xj,t ∈ (cid:89)(cid:48)
t which generally do not commute with each other, and consequently a larger
commutative algebra (cid:90)ij,t generally does not exist.
Our approximation begins by conjecturing that it is possible to construct a ﬁlter
algorithm such that if the estimate ˆxt is initially in the measurement algebra, it will
always be inside it in the future, ˆx0 ∈ (cid:89)0 ⇒ ˆxt ∈ (cid:89)t ∀t ≥ 0.
In contrast to the
formulation of quantum Kalman ﬁlter in[40, 5], since we will neglect the residual terms
of Taylor series in our ﬁlter structure, ˆxt is no longer optimal in the sense of the distance
from xt to a projection on (cid:89)t, i.e ˆxt (cid:54)= (cid:69)(cid:80) [xt| (cid:89)t]. Nonetheless, each element of ˆxt
is commutative with respect to the other elements, as they are belong to the same
commutative von Neumann algebra (cid:89)t.
Since we require that fi ∈ C 1

op((cid:82)) and ˆxt ∈ (cid:89)t, ˜xt ∈ (cid:89)(cid:48)

t , the condition in Proposition

2.2 is satisﬁed. Consequently, we can write

f (xt) = f (ˆxt) +

˜xt + rf ( ˆxt, ˜xt) ,

(13a)

(cid:12)(cid:12)(cid:12)(cid:12)xt=ˆxt

∂f (ˆxt)

∂xt

(cid:12)(cid:12)(cid:12)(cid:12)xt=ˆxt
(cid:12)(cid:12)(cid:12)(cid:12)xt=ˆxt

∂xt

,

,

with

and

F(ˆxt) ≡ ∂f (xt)
∂xt

(cid:12)(cid:12)(cid:12)(cid:12)xt=ˆxt

˜xt + rh (ˆxt, ˜xt) ,

(13b)

(13c)

(13d)

h(xt) = h(ˆxt) +

∂h(xt)

H(ˆxt) ≡ ∂h(xt)
∂xt

where r(·) is the residual term of the Taylor expansion. The measurement error operator
is given by

dyt − dˆyt = (H(ˆxt)˜xt + rh (ˆxt, ˜xt)) dt + L(xt)dA∗

t + L(xt)∗dAt + Ntdαt.

(14)

A Quantum Extended Kalman Filter
To construct a quantum EKF, we deﬁne a matrix of operators Pt ≡ 1
that is the Hermitian variance of the estimation error.
The quantum EKF problem is then given as follows. For a given open quantum
system subjected to measurements with corresponding QSDEs given in (9a) and (11)
respectively, the following conditions are assumed :

2 (cid:69)(cid:80) [{˜xt, ˜xt}| (cid:89)t],

10

(i) Variances and cross correlation matrices Qt, Rt, St are single valued.
(ii) Rt is invertible.
(iii) Initially ˆx0 ∈ (cid:89)0.
We ﬁnd a matrix Kt ∈ (cid:89)t corresponding to (15) below, such that ˆxt ∈ (cid:89)t,∀t ≥ 0 and
Pt evolves according to the following Riccati diﬀerential equation upon neglecting the
residual term of the Taylor series,

dˆxt = f (ˆxt)dt + Kt (dyt − dˆyt) ,

= F(ˆxt)Pt + PtF(ˆxt)(cid:62) + Qt −(cid:2)PtH(ˆxt)(cid:62) + St

(cid:3) R−1

t

(cid:2)PtH(ˆxt)(cid:62) + St

(cid:3)(cid:62)

(15)

.

(16)

dPt
dt

We notice that since we neglect the non linear residual term in (16), Pt is no longer
interpreted as the variance of the estimation error, but rather a general positive deﬁnite
matrix of operators which will be involved in the dynamics of the ﬁlter. Without loss of
the generality, we can assume that P0 ∈ (cid:89)0. The following theorem shows the existence
of a quantum EKF satisfying the condition above.

Theorem 3.1. Consider an open quantum system described by the QSDEs given in (9a)
subjects to the measurements given in (10a). Then, there exists a Kalman gain Kt ∈ (cid:89)t,

Kt =(cid:2)PtH(ˆxt)(cid:62) + St

(cid:3) R−1

(17)
such that if the quantum extended Kalman ﬁlter is given by (15), then ˆxt ∈ (cid:89)t,∀t ≥ 0
and Pt evolves according to (16) upon neglecting the residual term of the Taylor series
in (13).

,

t

Proof. To establish the ﬁrst part of the theorem, we need to show that there exists
Kt ∈ (cid:89)t, such that ˆxt ∈ (cid:89)t,∀t ≥ 0. The condition that ˆxt ∈ (cid:89)t,∀t ≥ 0 follows from
the causality of the quantum EKF given in (15). But to make it clear, let Kt ∈ (cid:89)t. We
observe that the diﬀerential equation of the quantum EKF can be written in integral
form as below

(cid:90) t

(cid:90) t

(cid:90) t

dˆxs =

[f (ˆxs) − Ksh (ˆxs)] ds +

0

0

0

Ksdys,

where the ﬁrst term of the right hand side involves Reimann-Stieltjes integration. Since
the integral above is deﬁned then, there exists a partition of times 0 = t0 ≤ t1 ≤ . . . tN =
t, ∆ti ≡ ti − ti−1, such that we can deﬁne an inﬁnite sum, by taking lim
N→∞ supi ∆ti = 0,
regarding the second integration in dys in the Itˆo sense,
[f (ˆxti) − Ktih (ˆxti)] ∆ti+1 + lim
N→∞

(cid:0)yti+1 − yti

ˆxt = ˆx0 + lim
N→∞

N−1(cid:88)

N−1(cid:88)

(cid:1) .

Kti

i=0

i=0

A Quantum Extended Kalman Filter
11
Hence, it is clear that if ˆx0,∈ (cid:89)0, then ˆxt ∈ (cid:89)t,∀t ≥ 0 , since it is in the span of yti and
ˆxti ∀ti < t.
For the second part of the theorem, let us now expand dˆxt according to the Taylor
expansion in (13a) and (13c). Doing that leads us to the following equation,

dˆxt = f (ˆxt)dt + Kt ((H(ˆxt)˜xt + rh (ˆxt, ˜xt)) dt + L(xt)dA∗

t + L(xt)∗dAt + Ntdαt) .

From the equation above, the estimation error can be given by the following equations,

d˜xt = (F(ˆxt) − KtH(ˆxt)) ˜xtdt + rdt + (G(xt)∗ − KtL(xt)∗) dAt

+ (G(xt) − KtL(xt)) dA∗
rt (ˆxt, ˜xt) = rf ( ˆxt, ˜xt) − Ktrh ( ˆxt, ˜xt) .

t − KtNtdαt,

(18a)

(18b)

Using the quantum Itˆo multiplication rule[29], we can obtain the estimation variance
dynamics as follow

dPt
dt

= (F(ˆxt) − KtH(ˆxt)) Pt + Pt (F(ˆxt) − KtH(ˆxt))
(cid:62)

+ Θ(ˆxt, ˜xt) +

(cid:69)(cid:80) [{d˜xt, d˜xt}| (cid:89)t] ,

¯h
2

with,

Θ(ˆxt, ˜xt) ≡ 1
2

(cid:69)(cid:80) [{rt (ˆxt, ˜xt) , ˜xt}| (cid:89)t] .

(19a)

(19b)

Now, from (19a), by the deﬁnition of variances given in (12a),(12b) and (12c), and that
Kt ∈ (cid:89)t, we obtain

dPt
dt

−(cid:16)

Kt

= F(ˆxt)Pt + PtF(ˆxt)(cid:62) + Qt + KtRtKt

(cid:0)H(ˆxt)Pt + S(cid:62)

t

(cid:62)

(cid:1) +(cid:0)H(ˆxt)Pt + S(cid:62)

t

(cid:17)

(cid:1)(cid:62)

K(cid:62)

t

(20)

+ Θ(ˆxt, ˜xt).

Since Pt,Rt,St, and ˆxt belong to (cid:89)t, then the Kalman gain given in (17) also belongs
to (cid:89)t. Substituting (17) to (20), and ignoring the nonlinearity Θ we obtain the desired
result as in (16).

Before we go further, we would like to address the implementability of the quantum
EKF in (15). In practical applications, we would often be given initial values of ˆxt and
Pt, rather than a complete description of a set of operators in an underlying Hilbert
space. Furthermore, in many cases, the interest is only to estimate the mean value and
covariance of xt.
Given such conditions, we would like to see the relation between the quantum EKF and
the classical EKF. From (15), we have the evolution of ˆxt ∈ (cid:89)t, which can be written as

dˆxt = [f (ˆxt) − Kth (ˆxt)] dt + Ktdyt.

(21)

A Quantum Extended Kalman Filter
12
By deﬁnition dyt ∈ (cid:89)t and hence by Theorem 2.1 there exist a ∗− isomorphism τ
from (cid:89)t to L∞ (Ω, (cid:70), µ). From now on, we write τ (·)t,ω ∈ (cid:67) as (·)t,ω. Then we write
∀ω ∈ Ω,∀t ≥ 0,

dˆxt,ω = [f (ˆxt,ω) − Kt,ωh (ˆxt,ω)] dt + Kt,ωdyt,ω ,

(22)
which is an ordinary stochastic diﬀerential equation. Using the same ∗− isomorphism
τ , the dynamics of the estimation error variance, (see the Riccati equations in (16)) can
also be transformed into classical Riccati diﬀerential equations. This transformation
in turn makes the quantum EKF implementable as a recursive ﬁlter in a digital signal
processor.

Remark 3.1. It is worth emphasizing that the essential diﬀerence between the quantum
EKF and the classical EKF is the fact that the set of the system’s observables xt do
not belong to a commutative von Neumann algebra. In addition, the dynamics of xt
generally consist of non-commutating operators and hence there is no ∗− isomorphism
that can transform xt and its dynamics into a measurable function on a classical
probability space (Ω, (cid:70), µ). Otherwise, if this is the case, then the quantum EKF
problem is reduced to the classical EKF problem.

For photon counting measurements, a Poisson processes can be written as a sum
of two independent quantum Gaussian noises as in (10). This enables us to treat a
ﬁltering problem for both diﬀusive and jump measurements simultaneously. This is
unique to quantum stochastic ﬁltering, since in a classical settings, one can never have
a transformation from a jump random process into a continuous processes, [26].

3.2. One Step Computational Complexity of the SME and the quantum EKF

Here we present a comparison of the computational complexity of the SME and the
quantum EKF. The SME for m output measurement channels is given by [12],

(cid:21)

(cid:20)

dρt =

−i [(cid:72), ρt] + (cid:76)

(cid:62)ρt(cid:76)

∗ − 1
2

(cid:76)

†

(cid:76)ρt − 1
2

†

(cid:76)

ρt(cid:76)

dt + ζ(cid:62)

ρ Γ−(cid:62)dW.

(23)

In this equation, ρt is the system’s conditional density operator and dW is the error
vector between the expected value and the measurement. The weighting function ζ(cid:62)
ρ Γ−(cid:62)
relates the contribution of each measurement to the total increment of the conditional
density operator. Now, suppose we have Nm subsystems, and under truncation let
each system’s Hilbert space dimension be Ns. The computational complexity of

)3(cid:1) = O(cid:0)NmN 3Nm

(23), will be of order O(cid:0)Nm(N Nm
calculate Tr [ρtxi] , i ≤ n, which is on the order of O(cid:0)n(N Nm
eﬀort ∼(cid:0)(ζ1n + ζ2Nm) N 3Nm

(cid:1), for some ζ1, ζ2 > 1.

(cid:1). Now, suppose we want to
)3(cid:1). Consequently to

s

estimate n observables of the system. Then after propagating the SME, we need to

propagate n observables from each subsystem from SME, we will need a calculation

s

s

s

In contrast, after transforming the Riccati and quantum EKF equations to the standard
SDE, the computational complexity of the quantum EKF is the same as that of the
classical EKF. The EKF computational eﬀort only depends on n, m and Nm, and the

A Quantum Extended Kalman Filter

13

complexity of evaluating f , and the Jacobian matrices F and H . In a single time step,

one has to propagate the Riccati equation in (16), which has the complexity O(cid:0)n3Nm(cid:1),
(cid:17)

calculation of the Jacobian matrices F and H which could vary depend on the type of
the function involved, plus solving the quantum EKF (15). Evaluating (15) involves the
calculation of f which also can vary, and matrix-vector calculation in Kt
,
which is O(m2(nNm)).

(cid:16)

dy − ˆdy

3.3. Convergence analysis

Here we will establish a stochastic convergence condition for the quantum EKF. The
approach we pursue here is closely related to the stochastic convergence analysis of the
classical extended Kalman ﬁlter and deterministic nonlinear observer design [22, 41, 42].
In essence, the main diﬀerence between the classical EKF stochastic convergence proof
and what we present here is the use of the semi-norm in (3) in the place of Euclidean
norm, and the quantum Markovian process generator. Moreover, due to the coupling
nature of the measurement and process noise in every open quantum system, we need
to assume the positive deﬁniteness of Qt − StR−1
t . The following assumptions,
deﬁnitions, and lemmas will serve as a foundation for the local convergence condition
of the quantum EKF estimation errors.

t S(cid:62)

Assumption 3.1. With the deﬁnition of semi-norm given in (3), together with our
previous assumption that Rt is positive deﬁnite matrix of operators in (cid:89)t, we also need
the following assumptions in our analysis.
AI Let (cid:69)f , (cid:69)h ⊂ (cid:89)t. For (cid:69)f = {ˆxt : (cid:107)xt − ˆxt(cid:107) ≤ f}, (cid:69)h = {ˆxt : (cid:107)xt − ˆxt(cid:107) ≤ h},
f , h > 0, ∃rh, rf > 0, such that the residual term of rf and rh satisfy the following
rate constraint

(cid:107)rf(cid:107) < rf (cid:107)˜xt(cid:107)2 ,∀ˆxt ∈ (cid:69)f ,
(cid:107)rh(cid:107) < rh (cid:107)˜xt(cid:107)2 ,∀ˆxt ∈ (cid:69)h,

AII The operator valued matrix H, and the cross correlation S are bounded from above,

(cid:107)H (x)(cid:107) ≤ ¯h,
(cid:107)S(cid:107) ≤ ¯s.

(24)

(25)

This assumption follows from the fact that we restrict our observable to the von

Neumann algebra (cid:78) = B. Moreover, since h ∈ C 1
AIII Pt is always greater than zero and bounded, i.e,

op ⊂ C 1, H is bounded.

0 < pI ≤ Pt ≤ ¯pI ,∀t ≥ 0.

(26)

If we consider Pt as an estimation error covariance, this condition will generally
be valid in quantum mechanical system estimation since the Heisenberg inequality
dictates that 0 < pI. Furthermore, it seems also natural to consider Pt to be
bounded from above.

A Quantum Extended Kalman Filter

AIV

Qt − StR−1

t S(cid:62)

t ≥ 0, ∀t ≥ 0.

14

(27)

t S(cid:62)

As we will encounter later on in Lemma 3.3, to satisfy the dissipative inequality, we
require that Qt − StR−1
t > 0 is always satisﬁed. However, as we will show in the
t ≥ 0.
Proposition 3.2, we can only obtain a suﬃcient condition that mQt−StR−1
In the next section, we will show how to deal with this restriction.
We will now show the inequality, mQt − StR−1

t ≥ 0, by using the following

t S(cid:62)

t S(cid:62)

Lemma,

Lemma 3.1. If a set of m measurement yt satisfying self-non demolition property, then
[dyi,t, dyj,t] = 0 ∀i, j ≤ m, t ≥ 0.

Proof. To see this, we ﬁrst examine that if yt satisfying self-non demolition property,
we could write for i, j ≤ m

d [yi,t, yj,t] = 0

= [dyi,t, yj,t] + [yi,t, dyj,t] + [dyi,t, dyj,t] ,

but [dyi,t, yj,t] = [yi,t, dyj,t] = 0. This can be seen from dyi,t = (cid:80)
where dbk ∈ {dAi, dA∗
where y ∈ B (Γ((cid:104))t}). Hence [dyi,t, dyj,t] = 0.

i , dαi, dt} , i ≤ m, and z ∈ B ((cid:72)s), whilst yj,t = U∗

k U∗

t (zk ⊗ (cid:49)) Utdbk,
t ((cid:49) ⊗ y) Ut,

Proposition 3.2. For an open quantum system with QSDEs and measurement given
in (9a) and (10a) respectively, the covariance matrices Qt, Rt, St satisfy the following
inequality

mQt − StR−1

t S(cid:62)

t ≥ 0, ∀t ≥ 0.

(28)

Proof. Let xi,t and yj,t denote the i and j th elements of xt and yt respectively. From
Lemma 3.1, we have [dyi,t, dyj,t] = 0 ∀i, j ≤ m, t ≥ 0.
Let ¯St = dxtdy(cid:62)
t = dytdy(cid:62)
= dxtdx(cid:62)
t .
We ﬁrst claim that there exists a symmetric matrix of operators Mt ∈ (cid:89)(cid:48)
t such that
{dxt, dxt} as below,

t , St = dytdx(cid:62)

, and ¯Rt = R(cid:62)

t , ¯Qt = Q

t

t

(cid:1)(cid:62)
{dxt, dxt} = ¯StMtSt +(cid:0)¯StMtSt
(cid:34) m,m(cid:88)
(cid:34) m,m(cid:88)

(cid:35)

.

dyk,tMk,k(cid:48)dyk(cid:48),t

dxj,t + dxj,t

k,k(cid:48)=1

(29)

(cid:35)

dyk(cid:48),tMk,k(cid:48)dyk,t

dxi,t,

To see this, we can write

{dxt, dxt} i,j = dxi,t

by requiring,

k,k(cid:48)=1

m,m(cid:88)

i,j =1

dyi,tMi,jdyj,t = (cid:49).

(30)

A Quantum Extended Kalman Filter
From (30), since Mt ∈ (cid:89)(cid:48)

t , we have,

m,m(cid:88)

m,m(cid:88)

dyi,tMi,jdyj,t = (cid:49) =

dyi,tdyj,tMi,j =

i,j =1

i,j=1

15

dyi,tdyj,tMj,i = Tr(cid:2) ¯RtMt

(cid:3).

m,m(cid:88)

i,j=1

t S(cid:62)
Hence, selecting Mt = 1
t
m
is a convex function with respect to both St and Rt (see [43, Proposition 8.6.17 (xiv)]),
by the Jensen inequality

t the assertion is veriﬁed. Now since StR−1

t ∈ (cid:89)t ⊂ (cid:89)(cid:48)
¯R−1

(cid:20) 1

2

(cid:0)¯S(cid:62)

(cid:69)(cid:80)

t + St

(cid:21)

(cid:1)(cid:12)(cid:12)(cid:12)(cid:12) (cid:89)t

t

2

(cid:69)(cid:80)

(cid:1)(cid:12)(cid:12)(cid:12)(cid:12) (cid:89)t
(cid:20) 1
(cid:21)
(cid:0)¯St + S(cid:62)
(cid:0)¯S(cid:62)
(cid:1) ¯R−1
(cid:2)(cid:0)¯St + S(cid:62)
(cid:104) ¯St
t St +(cid:0)¯St
(cid:104) ¯StMtSt +(cid:0)¯StMtSt
(cid:17)(cid:12)(cid:12)(cid:12)(cid:12) (cid:89)t
(cid:20) 1
(cid:21)
(cid:16) ¯Qt + Q(cid:62)

¯R−1

¯R−1

2

t

t

t

(cid:12)(cid:12) (cid:89)t
(cid:2) ¯Rt
(cid:3)−1
(cid:1)(cid:12)(cid:12) (cid:89)t
(cid:3)
(cid:1)(cid:62)(cid:12)(cid:12)(cid:12) (cid:89)t
(cid:105)
(cid:1)(cid:62)(cid:12)(cid:12)(cid:12) (cid:89)t
(cid:105)

t + St

t St

StR−1

t S(cid:62)

t =

1
dt
≤ 1
dt
≤ 1
dt
m
dt
m
dt

=

=

(cid:69)(cid:80)

1
4
1
2
1
2

(cid:69)(cid:80)

(cid:69)(cid:80)

(cid:69)(cid:80)

(cid:69)(cid:80)

= mQ,

which completes the proof.

The following Lemma gives a bound on the nonlinear residual rate based on
Assumption 3.1, see also [22, Lemma 3.3] for an analogous of result for the classical
EKF.

Lemma 3.2. Consider a functional φ that is a function of the residual rt and the
estimation error ˜xt given below,

φ(rt, ˜xt) ≡r(cid:62)

t P−1

t ˜xt + ˜x(cid:62)

t P−1

(31)
Then under Assumptions 3.1, there exists positive  and κ such that for every (cid:107)˜xt(cid:107) ≤ ,
then

t rt.

From AI, taking  = min(f , h)

(cid:107)φ(rt, ˜xt)(cid:107) ≤2

(cid:107)˜xt(cid:107)3 ≡ κ(cid:107)˜xt(cid:107)3 .

Proof. From (18b), we have
f P−1

φ(rt, ˜xt) = r(cid:62)

t ˜xt + ˜x(cid:62)

t P−1

Furthermore using AIII and AII,

(32 )

(cid:3) .

t P−1

t ˜xt + ˜x(cid:62)

t P−1

t Ktrh

(cid:107)φ(rt, ˜xt)(cid:107) ≤ κ(cid:107)˜xt(cid:107)3 .

h K(cid:62)

t rf −(cid:2)r(cid:62)
(cid:0)¯p¯h + ¯s(cid:1)
(cid:21)

r

¯k + rf
p

.

(cid:20)rh

¯k ≡ (cid:107)Kt(cid:107) ≤

A Quantum Extended Kalman Filter

16

To examine the convergence behavior of the coupling dynamics between the
estimation error and the covariance, we consider a Lyapunov positive operator V ∈
O+ ((cid:72)T) given by

V (˜xt) = ˜x(cid:62)

t P−1

t ˜xt.

(33)

Deﬁnition 3.1 (Class K, and class KR function). [44] A function α(·) : (cid:82)+ → (cid:82)+
belongs to class K if it is continuous and strictly increasing, where α(0) = 0. A function
α(·) is said to belong class KR if α is of class K and in addition, lim

z→∞ α(z) = ∞.

Notice that, under AIII, the Lyapunov candidate functional V is positive deﬁnite

and decresent. That is we can ﬁnd α((cid:107)x(cid:107)), β((cid:107)x(cid:107)) of class K, such that

α((cid:107)˜xt(cid:107)) ≤ (cid:80) (V (˜xt)) ≤ β((cid:107)˜xt(cid:107)).

The following Lemma shows the dissipativity of the quantum EKF estimation error.

Lemma 3.3. Consider an open quantum system QSDE given in (9a), and measurement
given in (10a). With the quantum EKF given in (15), and κ,  ≥ 0 in Lemma 3.2. Under
Assumptions 3.1, there exist (cid:48) > 0 such that if (cid:107)˜xt(cid:107) ≤ (cid:48),∀t ≥ 0, there exist γ, δ > 0
such that the Lyapunov positive operator (33) satisﬁes the dissipation inequality below

L (V ) ≤ − γV (˜xt) + δ.

(34)

Proof. We could write the time derivative of P−1

t

as below.

∂P−1
t
∂t

= − P−1

t

∂Pt
∂t

P−1

t

.

Then by Itˆo expansion, we have
t d˜xt + d˜x(cid:62)

dV = ˜x(cid:62)

t P−1

t P−1

t ˜xt + d˜x(cid:62)

t P−1

t d˜xt − ˜x(cid:62)

t P−1

t

∂Pt
∂t

P−1
t ˜xtdt.

The quantum Markov generator for the Lyapunov positive operator V is then given by

L (V ) = ˜x(cid:62)

t P−1
+ Tr

t

L (V ) ≤ −˜x(cid:62)
≤ −˜x(cid:62)

t

t

From Lemma 3.2, (18a), (17), and (16), there exists  > 0 such that,
t + κ(cid:107)˜xt(cid:107) P2

t

t

t

t

(cid:62)

P−1

∂Pt
∂t

P−1
t ˜xt
P−1
t ˜xt.

[(F(ˆxt) − KtH(ˆxt)) ˜xt + r] + [(F(ˆxt) − KtH(ˆxt)) ˜xt + r]
(cid:62)
(G(xt)∗ − KtL(xt)∗)
t P−1

(G(xt) − KtL(xt))

(cid:104)
t HtP −(cid:2)StR−1
(cid:2)Qt + PH(cid:62)
(cid:2)P−1
(cid:1) + Pt
(cid:2)H(cid:62)
(cid:2)(cid:0)Qt − StR−1
(cid:2)P−1
(cid:13)(cid:13)(cid:0)Qt − StR−1
t Ht − κ(cid:107)˜xt(cid:107)(cid:3) Pt
(cid:2)H(cid:62)
(cid:1) + Pt
(cid:18) qe
(cid:19)

(cid:105) − ˜x(cid:62)
(cid:3) ˜xt + δ
(cid:3)(cid:3) P−1
(cid:3) P−1
t Ht − κ(cid:107)˜xt(cid:107)(cid:3) Pt
(cid:3) ˜xt + δ.
(cid:13)(cid:13) ≥ 0.

t R−1
t S(cid:62)
t > 0. Now select (cid:48), such that, ∀(cid:107)˜xt(cid:107) ≤ (cid:48)

t S(cid:62)
t R−1

t R−1

t S(cid:62)

t

t

t

t

(cid:48) = min

, 

,

¯p2κ

By assumption AIV, Qt − StR−1
t S(cid:62)

t

This fulﬁlled by taking,

A Quantum Extended Kalman Filter

t S(cid:62)

t

where qe = inf(cid:13)(cid:13)Qt − StR−1
(cid:13)(cid:13)x(cid:62)
(cid:0)P−1
(cid:104)

γ = inf
x

t

t

δ = sup
xt

Tr

The result then follows immediately.

(cid:13)(cid:13). Taking (cid:107)˜xt(cid:107) ≤ (cid:48), there exists
(cid:0)Qt − StR−1
(cid:13)(cid:13)˜x(cid:62)

t + H(cid:62)
t P−1
t ˜xt

(cid:1) P−1

t R−1

t S(cid:62)

(cid:13)(cid:13)

t

17

(cid:13)(cid:13)

.

t Ht − κ(cid:48)(cid:1) ˜xt
(cid:105)

Moreover, since xt is bounded, then there exists δ which is given by,

(G(xt)∗ − KtL(xt)∗)
(cid:62)

P−1

t

(G(xt) − KtL(xt))

.

In contrast to the proof of the stochastic convergence of a classical EKF given in
[22, Theorem 3.2], having (cid:107)˜x0(cid:107) ≤ (cid:48) does not guarantee that in the future the estimation
error will always remain in the region (cid:107)˜xt(cid:107) ≤ (cid:48). Consequently, since the last dissipative
inequality is only valid in the region (cid:107)˜xt(cid:107) ≤ (cid:48) then we can only state the quadratic
bound of the estimation error before it leaves the region (cid:107)˜xt(cid:107) ≤ (cid:48). From the deﬁnition
of the semi-norm in (3), by (4) we obtain,

(cid:107)xt − ˆxt(cid:107) = (cid:80)

(xt − ˆxt)
†

(xt − ˆxt)

(cid:69)(cid:80)

(35)
Consequently, the set all events such that the estimation error is greater than (cid:48) is (cid:89)t
measurable, i.e. {(cid:107)xt − ˆxt(cid:107) > (cid:48)} ∈ (cid:89)t. Let (cid:69)(cid:48) = {ˆxt : (cid:107)xt − ˆxt(cid:107) ≤ (cid:48)} ⊂ (cid:89)t. Now,
deﬁne the Markov time τ(cid:48) (ˆx0) : {τ(cid:48) (ˆx0) ≤ t} ∈ (cid:89)t to be the ﬁrst time that the
trajectory ˆxt leaves (cid:69)(cid:48) given that it begins inside it. The following theorem describes
the quantum EKF’s estimation error quadratic bound.

.

(cid:105)(cid:17)1/2

(cid:12)(cid:12)(cid:12) (cid:89)t

(cid:16)

(cid:104)

Theorem 3.2. If the set of system observables xt has an evolution given by the QSDE
in (9a) that satisﬁes Assumption 3.1 and if initially (cid:107)˜x0(cid:107) ≤ (cid:48), where (cid:48) is given in
Lemma 3.3, then for all t(cid:48) = min (τ(cid:48) (ˆx0) , t) ≥ 0

t(cid:48) ˜xt(cid:48)(cid:12)(cid:12) (cid:89)t(cid:48)(cid:3) ≤ ¯p
(cid:2) ˜x(cid:62)

(cid:69)(cid:80)

(cid:2) ˜x(cid:62)

0 ˜x0

(cid:12)(cid:12) (cid:89)t(cid:48)(cid:3) e−γt(cid:48)

(cid:69)(cid:80)

p

(cid:16)

1 − e−γt(cid:48)(cid:17)

+

δ
γp

.

(36 )

Proof. The proof of this theorem makes use of the proof of the classical ultimate bound
of quadratic moments given in [45], except that in this theorem, we replace the generator
of the classical Markov process with the quantum Markov process generator (Lindblad
generator) in (2). We also use the operator inequality with respect to the state (cid:80) in (cid:89)t.
First, we observe that t(cid:48) is a (cid:89)t(cid:48) measurable random variable [27, Lemma 1.5]. By our
deﬁnition of a Lyapunov positive operator in (33), we may apply the Itˆo formula, and
therefore we obtain,

(cid:69)(cid:80) [ V (˜xt(cid:48))| (cid:89)t(cid:48)] = V (˜x0) +

(cid:69)(cid:80)

(37)

The equation above indicates that the expectation (cid:69)(cid:80) [V (˜xt(cid:48))| (cid:89)t(cid:48)]
continuous in t(cid:48) since L (V (˜xs)) is Lebesgue integrable, and hence for almost all s ≥ 0

is absolutely

(cid:90) t(cid:48)

0

(cid:2)L (V (˜xs))(cid:12)(cid:12) (cid:89)t(cid:48)(cid:3) ds.

d(cid:69)(cid:80) [V (˜xs)| (cid:89)t(cid:48)]

ds

≤ −γ(cid:69)(cid:80) [V (˜xs)| (cid:89)t(cid:48)] + δ.

A Quantum Extended Kalman Filter

Multiplying by the factor eγs, we have

18

d (eγs(cid:69)(cid:80) [V (˜xs)| (cid:89)t(cid:48)])

ds

≤ δeγs.

By (37), eγs(cid:69)(cid:80) [V (˜xs)| (cid:89)t(cid:48)] is also absolutely continuous, and hence by integrating the
last inequality, we obtain,

(cid:69)(cid:80) [V (˜xt(cid:48))| (cid:89)t(cid:48)] ≤ (cid:69)(cid:80) [V (˜x0)| (cid:89)t(cid:48)] e−γt(cid:48)

+

From AIII, we obtain

t(cid:48) ˜xt(cid:48)(cid:12)(cid:12) (cid:89)t(cid:48)(cid:3) ≤ (cid:69)(cid:80) [V (˜xt(cid:48))| (cid:89)t(cid:48)]
(cid:2) ˜x(cid:62)

p(cid:69)(cid:80)

≤ (cid:69)(cid:80) [V (˜x0)| (cid:89)t(cid:48)] e−γt(cid:48)
≤ ¯p(cid:69)(cid:80)

(cid:12)(cid:12) (cid:89)t(cid:48)(cid:3) e−γt(cid:48)

(cid:2) ˜x(cid:62)

0 ˜x0

+

+

δ
γ

δ
γ
δ
γ

(cid:16)

1 − e−γt(cid:48)(cid:17)

.

(cid:16)
1 − e−γt(cid:48)(cid:17)
1 − e−γt(cid:48)(cid:17)
(cid:16)

.

Dividing the last result by p gives the desired result.

Remark 3.2. Using a treatment similar to [22, Theorem 4.2], it can be shown that
the condition in AIII can be replaced with the uniform detectability of the pair
F (ˆx) , H (ˆx) ,∀x ∈ (cid:89)t to obtain the same result in the Theorem 3.2, see [46, Theorem
7].

3.4. Robust quantum nonlinear ﬁlter for a class of open quantum system with
state-dependent noise

In the previous subsection, the quantum EKF is developed for a class of an open
quantum systems where the noise variances are known. We also notice that the
dissipation inequality given in Lemma 3.3 is a very conservative condition and often
rather diﬃcult to validate. Moreover, for many open quantum systems, the variances
of the system observables and the measurements are state-dependent. As an example,
the covariance of photon counting is indeed a stochastic process, for which is a ’doubly
stochastic Poisson’ or Cox process [47, 48].
In classical systems, doubly stochastic
Poisson processes have been treated in a variety of ways, e.g. by solving a conditional
probability density evolution, or a ﬁltered martingale problem approach [47, 49, 50, 51].
In this subsection, we will show how to modify the quantum EKF to include open
quantum systems and measurements with state-dependent noise variance and cross
correlation, while at the same obtain a stronger condition of convergence than Lemma
3.3. The treatment we present here uses Riccati diﬀerential equation shaping, which
is to some extent similar to the treatment of the deterministic nonlinear observer in
[41, 42].
We will still use the same ﬁlter dynamics as in (15). We will also use the same notation
Pt to denote a positive deﬁnite matrix of operators, whose dynamics is shaped to achieve

A Quantum Extended Kalman Filter

19

robustness of the estimation error dynamics.
Since the variance and covariance are functions of xt, we will use the estimates of Rt
and St in the Kalman ﬁlter, and therefore we have

Kt =

(cid:62)
PtH(ˆxt)

+ S(ˆxt)

R(ˆxt)

−1.

(38)

(cid:104)

(cid:105)

Furthermore, we shape the Riccati diﬀerential equation, where for given µ, λ > 0, with
ˆQ > µI,

dPt
dt

=F(ˆxt)Pt + PtF(ˆxt)(cid:62) + ˆQ + λPt

2 − KtR(ˆxt)K(cid:62)
t .

(39)

We state our result in the following theorem,

Theorem 3.3. Consider an open quantum system QSDE given in (9a),
the
measurement given in (10a), and the quantum EKF given in (15). Also assume
Assumptions AI, AII, and AIII, and (cid:107)˜xt(cid:107) ≤ ,∀t ≥ 0, where  = min (f , h) in
AI. Then there exist µ, λ > 0 in (39) and γ, δ > 0 such that the Lyapunov positive
operator given in (33), satisﬁes the dissipation inequality below

L (V ) ≤ − γV (˜xt) + δ.

(40)

Proof. Using the same argument as in Lemma 3.3,

L (V ) = ˜x(cid:62)

(cid:104)

t P−1
+ Tr

t

[(F(ˆxt) − KtH(ˆxt)) ˜xt + r] + [(F(ˆxt) − KtH(ˆxt)) ˜xt + r]
(cid:62)
(G(xt)∗ − KtL(xt)∗)
(cid:62)
t P−1

(G(xt) − KtL(xt))

P−1

t

t

P−1
t ˜xt
P−1
t ˜xt.

∂Pt
∂t

(cid:105) − ˜x(cid:62)

With the same δ as in the Lemma 3.3, then from Lemma 3.2, we can select suﬃciently
large  = min (f , h), and use (18a), (38), and (39) to obtain

L (V ) ≤ −˜x(cid:62)

t P−1

t UP−1

t ˜xt + δt,

(cid:104)

with

U = Pt

H (ˆx) R(ˆxt)

−1H (ˆx)

(cid:62)

+ (λ − κ) I

Pt +

(cid:105)

(cid:104) ˆQ − S(ˆxt)R(ˆxt)

−1S(ˆxt)

(cid:62)(cid:105)

,

where I is the identity matrix. Furthermore, selecting

ˆQ = µI + S(ˆxt)R(ˆxt)

−1S(ˆxt)

(cid:62)

,

and λ > κ, from the fact that R(ˆxt)
U = inf x U, γ is given by γ =

(cid:107)U(cid:107)
¯p , which completes the proof.

−1 > 0, we infer that U > 0. Furthermore, with

The quadratic bound on the estimation error follows immediately by similar

assertions in the Theorem 3.2, by replacing (cid:48) with .
We notice that we could independently select  suﬃciently large due to extra freedom
introduced by µ and λ. These two parameters remove the positive deﬁniteness restriction
of Qt − StR−1
t , as in Assumption AIV. λ is selected to directly dominate the
nonlinearity eﬀect κ in the ﬁlter that can lead to the divergence of the estimation
errors. On the other hand, µ increases the convergence, ensuring the inequality in Pt
AIII, while at the same time increases the noise level of the estimation.

t S(cid:62)

A Quantum Extended Kalman Filter

20

4. Application Examples

In this section, we consider some examples of the application of the quantum EKF. We
begin with the estimation of position and momentum quadratures of two optical cavity
modes with Kerr nonlinearities and subject to homodyne detection. In this example the
variance matrices Q, R and S are constant matrices. Next, we show the estimation of
the position and momentum quadratures in an optical cavity subjected to simultaneous
homodyne and photon counting detections, which corresponds to the case where the
variance matrices R and S are a state-dependent matrices. The constant ¯h is assumed
to be one. As before, we will denote the isomorphically transformed operator in (cid:89)t,
τ (·)t,ω ∈ (cid:67) as (·)t,ω.

4.1. Estimating the quadratures of multiple optical modes with a Kerr Hamiltonian

In this example, we would like to estimate the quadratures of two cavity modes
(cid:62)
xi,t = [qi pi]
, i = 1, 2. Each mode has an identical Kerr Hamiltonian and a direct
coupling Hamiltonian. For n cavity modes, the direct coupling Hamiltonian is given by
˘Sijxj,t. The parameters for the optical

[52], (cid:72)int =

√
γij

n(cid:80)

n(cid:80)

(cid:16)

(cid:17)

x(cid:62)

aja

i

Let Σ =

. The quantum Markovian generator for xt, is given by fi(xt) =

Aijxj,t + fi,Kerr(xi,t), while Gi = iΣCi. Now Aij is given by the following matrices

j=0

Aij =

(cid:17)

CiC

†
i

−Σ(cid:61)(cid:16)

Σ˘Sij

, i = j
, i (cid:54)= j

.

fi,Kerr(xt) is the nonlinearity from the Kerr Hamiltonian, we have

(cid:34)
(cid:34)

fi,Kerr =

χ
4

Fi (x) = χ

i,t + q2
i,t + p2

i,tpi,t + 2qi,tpi,tqi,t − 8pi,t
i,tqi,t + 2pi,tqi,tpi,t − 8qi,t

4p3

i,t + pi,tq2
i,t + qi,tp2

−(cid:0)4q3
i,t + 0.5(cid:0)q2

−(3q2

qi,tpi,t + pi,tqi,t
i,t + p2
i,t

(cid:1) − 2)

(cid:1)(cid:35)
i,t + 0.5(cid:0)q2

,

(cid:35)
(cid:1) − 2

.

3p2

i,t + p2
i,t

−(qi,tpi,t + pi,tqi,t)

We consider homodyne detection on each cavity mode as measurement such that
E = I, N = 0. From Figure 1c, it can be seen that under a small error at time zero,
the quantum EKF still maintains the estimation error to be bounded, which shows the

cavity, are given by (cid:83) = I, (cid:76)i =

i xi,t, and

†
j

=

i=1

i − aia
†
√
γai = C(cid:62)
n(cid:88)

2

j=i+1

†
i

χia

a2
i +

(cid:72) =

i,t

n(cid:88)

i=1

i=1

j=i+1

x(cid:62)

i,t

˘Sijxj,t.

i,j=1
i(cid:54)=j

(cid:34)

0
−1

(cid:35)

1
0

n(cid:80)

A Quantum Extended Kalman Filter

21

(a) tSM E/tqEKF

(b) MISE comparison

(c) q1 Error

(color online) Application of the quantum EKF to estimate quadratures of two cavity
Figure 1.
modes with Kerr Hamiltonians. Here, we use a cavity with damping constant γi = 32 and Kerr
nonlinearity constant χi = 0.3π. The Hilbert space basis for each modes is of order to 32. Figure 1a
shows the ratio of one time-step computational time between the SME and the quantum EKF for
various number of modes, and order of the Hilbert space basis used for solving the SME. The ratio
increases dramatically when the number of modes increases. Figure 1b shows a comparison of the mean
integral of squared quadratic error, 1
t,ω ˜xt,ωdt)1/2, for the quantum EKF and SME estimation,
with various diﬀerent orders of the Hilbert space basis, against diﬀerent initial coherent amplitudes α.
The error ˜xt,ω is approximated by subtracting the estimate of the quantum EKF and the SME against
the estimate of the SME with the largest Hilbert space basis (32). Figure 1c shows the estimation of
the ﬁrst mode quadrature with diﬀerent initial errors. The initial value of the quantum EKF is given
by ˆx0,ω = ˆxSM E(0,ω) + ζ[1 − 1 − 1 1](cid:62). ζ corresponds to the magnitude of the initial estimation error.
In this simulation, the trajectories of the SME and the quantum EKF estimation are generated from
identical measurement records.

T ((cid:82) T

0 ˜x(cid:62)

05101520253010−1100101102103104105106107SMEHilbertSpaceBasisOrdertSME/tqEKF  Nm=1Nm=2Nm=300.511.522.533.54α/√3210-4010-3010-2010-101001010MISESME28SME24SME20SME16SME12SME8SME4qEKF00.050.10.150.20.250.30.350.40.450.5t-0.500.511.522.533.544.5hq1iSMEζ=0ζ=0.1ζ=1A Quantum Extended Kalman Filter

22

(a) q1 averaged

(b) p1 averaged

(c) Phase space

(d) q2 averaged

(e) p2 averaged

(f) Phase space

Figure 2. (color online) As in Figure 1, this simulation shows a comparison of the quantum EKF,
the SME, and the quantum Kalman Filter (KF) estimation results. The black line with a shaded area
corresponds to the mean with one standard deviation range from 100 Monte Carlo trials of the SME’s
estimation (Hilbert space basis of order 20 for each mode). The red line with a shaded area is the
quantum EKF and the blue line is the estimation of the quantum KF where we simply ignore the
nonlinearity. Initial errors are set to zero for these simulations.

convergence of the quantum EKF.
We can observe from Figure 2 that the area of mean and one standard deviation of the
quantum EKF on the q1,p1,q2 and p2 are quite narrow and contained in the estimation
of SME. In contrast, the quantum KF estimation has a substantially larger deviation
from the truncated SME mean although it has a narrower standard deviation range.
Regarding the computational time, with a Hilbert space basis of order 20 on each mode,
the SME requires nearly 200 times that of the quantum EKF. The SME will require
170,000 times that of the quantum EKF if the number of modes equals to three, see also
Figure 1a. From Section 3.2, generally for every single mode increase in the quantum
systems, the required time of the SME single step computation will be increased to by
a factor of N 3
s .
In terms of estimation error, the quantum EKF can mantain a fairly low slope of the
mean integral of squared quadratic error, 1
t,ω ˜xt,ωdt)1/2 regardless of the initial
state of the estimated quantum system. This is another beneﬁt, since for the SME, the
MISE could make a huge diﬀerence if the initial state needs a higher order Hilbert space
basis, see Figure 1b.

T ((cid:82) T

0 ˜x(cid:62)

A Quantum Extended Kalman Filter

23

Figure 3. Simultaneous photon counting and homodyne detection at either output port of a beam
splitter in a quantum optics experiment, and the corresponding quantum network depiction of the
quantum optics setup, [12].

4.2. Estimating the quadratures of an optical cavity subject to simultaneous homodyne
detection and photon counting

Figure 3 shows an optical cavity with the simultaneous homodyne detection and photon
counting setup as considered in [12]. The involvement of photon counting in this optical
setup makes the covariance matrix of the measurement R state-dependent.

Let G1 be our system of interest, with parameters ((cid:49),
concatenated into our system by G2, whose parameters are ((cid:49), 0, 0). The beam splitter
is given by G3, with parameters ((cid:83), 0, 0). By taking the series and the concatenation
by G =(cid:0)G1 (cid:1) G2

products [39], the parameters of the composite quantum system in Figure 3 are given

√
γa, (cid:72)). The vacuum noise is

(cid:32)√

(cid:33)

(cid:33)

(cid:32)

γa
0

, (cid:72)

.

The beam splitter matrix (cid:83), bath coupling (cid:76) and Hamiltonian (cid:72) are given by the
following

(cid:83), (cid:83)

(cid:1) (cid:66) G3, with
(cid:34)√
η∗a2 − ηa†2(cid:17)

1 − r2
ir

(cid:16)

(cid:72) = i

(cid:83) =

(cid:35)

√
ir
1 − r2
, η ∈ (cid:67).

, r ≥ 0, (cid:76) = (cid:83)C(cid:62)xt,

Figures 4c-4d show a sample of Monte Carlo simulation of the SME (black), and the
extension of the quantum EKF developed in Section 3.4 (rqEKF) (blue). In this trial,
the system’s density operator is a superposition between a coherent and a Fock state.
It is clear from Figs. 4c-4d that rqEKF estimation gives a good approximation to the
solution of the SME after a transient period. In the event of photon detection however,
the rqEKF tends to have a slightly higher instantaneous jumps compared to the SME.
Figures 4a-4b shows how the rqEKF performs against the truncated SME in terms of
the average estimate of 100 Monte Carlo trials and their one standard average region.
We ﬁrst observe that the area of mean and one stdev of the rqEKF for qt and pt gives
a qualitatively good approximation after a small transient time similar to those of the
SME.

A Quantum Extended Kalman Filter

24

(a) q

(b) p

(c) q-trial

(d) p-trial

Figure 4. (color online) These ﬁgures show the estimation of the optical cavity quadratures subject
to simultaneous homodyne detection and photon counting. The system’s Hilbert space basis (N)
is of order 40. The system’s initial vector state (unnormalized) is | ˜ψ(cid:105)0 = 0.5|n(cid:105) + 0.5|α(cid:105), with

n = N/2, α = (cid:112)N/2 exp(iπ/4), while the reﬂectivity factor r2 is 0.5. Figures 4a-4b show the mean

and one standard deviation range of 100 Monte Carlo trajectories of the SME (black) and the robust
quantum EKF. Figures 4c-4d, show q and p values from a sample of Monte Carlo trials.

5. Conclusion

In this article we have developed a quantum EKF for a class of nonlinear QSDEs
describing an open quantum system subject to measurement. We derived a suﬃcient
condition for the quantum EKF to achieve local quadratic exponential convergence in
the estimation error. We also extended the quantum EKF to the class of quantum
systems and measurements with state-dependent covariance matrices. Finally, we have
illustrated via two examples the eﬀectiveness of the quantum EKF approximation.

00.10.20.30.40.50.60.70.80.9t-2-1.5-1-0.500.511.522.53q00.10.20.30.40.50.60.70.80.9t-0.500.511.522.533.5pA Quantum Extended Kalman Filter

25

6. References

[1] Anderson B D O and Moore J B 1979 Optimal Filtering (Prentice-Hall)
[2] Belavkin V P 1980 Radiotechnika i Elektronika 25 1445–1453
[3] Wiseman H M and Milburn G J 2010 Quantum Measurement and Control (Cambridge University

Press) ISBN 9780521804424

[4] Doherty A C and Jacobs K 1999 Phys. Rev. A: At., Mol., Opt. Phys. 60(4) 2700–2711
[5] Yamamoto N 2006 Phys. Rev. A: At., Mol., Opt. Phys. 74 032107
[6] Belavkin V P 1983 Automatica and Remote Control 44 178–188
[7] Belavkin V P 1989 Nondemolition measurements, nonlinear ﬁltering and dynamic programming of
quantum stochastic processes Modeling and Control of Systems (Lecture Notes in Control and
Information Sciences vol 121) ed Blaquire A (Springer Berlin Heidelberg) pp 245–265 ISBN
978-3-540-50790-1

[8] Belavkin V P 1992 Comm. Math. Phys. 146 611–635
[9] Hume D B, Rosenband T and Wineland D J 2007 Phys. Rev. Lett. 99(12) 120502
[10] Sayrin C, Dotsenko I, Zhou X, Peaudecerf B, Rybarczyk T, Gleyzes S, Rouchon P, Mirrahimi M,

Amini H, Brune M et al. 2011 Nature 477 73–77

[11] Wieczorek W, Hofer S G, Hoelscher-Obermaier J, Riedinger R, Hammerer K and Aspelmeyer M

2015 Phys. Rev. Lett. 114(22) 223601

[12] Emzir M F, Woolley M J and Petersen I R 2015 J. Phys. A-Math. Theor. 48 385302
[13] Doherty A C, Habib S, Jacobs K, Mabuchi H and Tan S M 2000 Phys. Rev. A 62
[14] Steck D A, Jacobs K, Mabuchi H, Habib S and Bhattacharya T 2006 Phys. Rev. A: At., Mol.,

Opt. Phys. 74(1) 012322

[15] Hush M R, Szigeti S S, Carvalho A R R and Hope J J 2013 New J. Phys. 15 113060
[16] Tsang M 2015 Phys. Rev. A 92
[17] Mathews V and Sicuranza G 2000 Polynomial signal processing Wiley series in telecommunications

and signal processing (Wiley) ISBN 9780471034148

[18] Ljung L 1979 IEEE Trans. Automat. Contr. 24 36–50 ISSN 0018-9286
[19] Song Y and Grizzle J 1992 The extended kalman ﬁlter as a local asymptotic observer for nonlinear

discrete-time systems Amer. Control Conf., 1992 pp 3365–3369

[20] La Scala B, Bitmead R and James M 1995 Math. Control Signal 8 1–26 ISSN 0932-4194
[21] Boutayeb M, Rafaralahy H and Darouach M 1997 IEEE Trans. Automat. Contr. 42 581–586 ISSN

0018-9286

[22] Reif K, Unbehauen R, Yaz E and G¨unther S 2000 IEE Proceedings - Control Theory and

Applications 147 45–52

[23] Nazaikinskii V E, Shatalov V E and Sternin B Y 1996 Methods of Noncommutative Analysis

(Walter de Gruyter GmbH)

[24] Birman M S and Solomyak M 2003 Integr. Equat. Oper. Th. 47 131–168
[25] Walls D F and Milburn G J 1994 Quantum Optics (Springer Science Business Media)
[26] Bouten L, Handel R V and James M R 2007 SIAM J. Contr. & Optim. 46 2199–2241
[27] Lipster R S and Shiryayev A N 2001 Statistics of Random Processes:

I. General Theory
Applications of mathematics : stochastic modelling and applied Probability (Springer) ISBN
9783540639299

[28] Lindblad G 1976 Comm. Math. Phys. 48 119–130
[29] Parthasarathy K R 1992 An Introduction to Quantum Stochastic Calculus Modern Birkh¨auser

classics (Springer)

[30] Sakai S 1971 C∗-algebras and W∗-algebras vol 60 (Springer Science & Business Media)
[31] Pedersen G K 2000 Publ. Res. Inst. Math. Sci. 36 139–157
[32] Widom H 1983 When are diﬀerentiable functions diﬀerentiable ?

(Springer Verlag) chap 4

Operator Theory, pp 184–188 Lecture Notes in Mathematics

[33] Hutson V and Pym J 2005 Applications of Functional Analysis and Operator Theory Mathematics

A Quantum Extended Kalman Filter

26

in Science and Engineering (Elsevier Science) ISBN 9780080527314

[34] Conway J B 2000 A course in operator theory vol 2 (American Mathematical Society)
[35] Farforovskaya Y B 1975 J. Math. Sci. 4 426–433
[36] Arazy J, Barton T and Friedman Y 1990 Integr. Equat. Oper. Th. 13 461–487
[37] Kissin E and Shulman V S 1996 Funct. Anal. Appl. 30 280–282
[38] Klebaner F C 2012 Introduction to Stochastic Calculus with Applications (World Scientiﬁc Pub Co

Pte Lt)

[39] Gough J and James M 2009 IEEE Trans. Automat. Contr. 54 2530–2544
[40] Wiseman H M and Doherty A C 2005 Phys. Rev. Lett. 94(7) 070405
[41] Reif K, Sonnemann F and Unbehauen R 1998 Automatica 34 1119–1123
[42] Reif K, Sonnemann F and Unbehauen R 1999 IEEE Trans. Automat. Contr. 44 203–208
[43] Bernstein D 2009 Matrix Mathematics: Theory, Facts, and Formulas (Second Edition) Princeton

reference (Princeton University Press) ISBN 9780691140391

[44] Sastry S 1999 Nonlinear systems: analysis, stability, and control vol 10 (Springer)
[45] Zakai M 1967 SIAM J. on Contr. 5 588–593
[46] Baras J S, Bensoussan A and James M R 1988 SIAM J. Appl. Math. 48 1147–1158
[47] Snyder D L 1972 IEEE Trans. Inform. Theory 18 91–102 ISSN 0018-9448
[48] Segall A and Kailath T 1975 IEEE Trans. Automat. Contr.
[49] Segall A, Davis M and Kailath T 1975 IEEE Trans. Inform. Theory 21 143–149
[50] Ceci C and Colaneri K 2012 Adv. in Appl. Probab. 44 678–701
[51] Ceci C and Colaneri K 2014 Appl. Math. Optim. 69 47–82
[52] Wiseman H M and Milburn G J 1994 Phys. Rev. A: At., Mol., Opt. Phys. 49(5) 4110–4125

