Distributed Spectral Efﬁciency Maximization in

Full-Duplex Cellular Networks

José Mairton B. da Silva Jr⋆, Yuzhe Xu⋆, Gábor Fodor⋆†, Carlo Fischione⋆

⋆KTH, Royal Institute of Technology, Stockholm, Sweden

†Ericsson Research, Kista, Sweden

6
1
0
2

 
r
a

M
6

 

 
 
]
T
I
.
s
c
[
 
 

2
v
1
7
6
0
0

.

3
0
6
1
:
v
i
X
r
a

the management of

Abstract—Three-node full-duplex is a promising new trans-
mission mode between a full-duplex capable wireless node and
two other wireless nodes that use half-duplex transmission and
reception respectively. Although three-node full-duplex transmis-
sions can increase the spectral efﬁciency without requiring full-
duplex capability of user devices, inter-node interference – in
addition to the inherent self-interference – can severely degrade
the performance. Therefore, as methods that provide effective
self-interference mitigation evolve,
inter-
node interference is becoming increasingly important. This paper
considers a cellular system in which a full-duplex capable base
station serves a set of half-duplex capable users. As the spectral
efﬁciencies achieved by the uplink and downlink transmissions
are inherently intertwined, the objective is to device channel
assignment and power control algorithms that maximize the
weighted sum of the uplink-downlink transmissions. To this end
a distributed auction based channel assignment algorithm is
proposed,
in which the scheduled uplink users and the base
station jointly determine the set of downlink users for full-
duplex transmission. Realistic system simulations indicate that
the spectral efﬁciency can be up to 89 % better than using
the traditional half-duplex mode. Furthermore, when the self-
interference cancelling level is high, the impact of the user-to-user
interference is severe unless properly managed.

I. INTRODUCTION

Traditional cellular networks operate in half-duplex (HD)
transmission mode, in which a user equipment (UE) or the
base station (BS) either transmits or receives on any given
frequency channel. However, the increasing demand to support
the transmission of unprecedented data quantities has led the
research community to investigate new wireless transmission
technologies. Recently,
in-band full duplex (FD) has been
proposed as a key enabling technology to drastically increase
the spectral efﬁciency of conventional wireless transmission
modes. Due to recent advances in antenna design, interference
cancellation algorithms, self-interference (SI) suppression tech-
niques and prototyping of FD transceivers, FD transmission
is becoming a realistic technology component of advanced
wireless – including cellular – systems, especially in the low
transmit power regime [1], [2].

In particular, in-band FD and three node full duplex (TNFD)
transmission modes can drastically increase the spectral ef-
ﬁciency of conventional wireless transmission modes since
both transmission techniques have the potential to double the

José Mairton B. da Silva Jr. would like to acknowledge CNPq, a Brazilian
research-support agency. The simulations were performed on resources pro-
vided by the Swedish National Infrastructure for Computing (SNIC) at PDC
Centre for High Performance Computing (PDC-HPC).

SI

BS

Freq. Channel 1

Freq. Channel 2
UE-to-UE Interf.
Self-Interf. (SI)

UE2

UE3

UE4

UE1

Figure 1. A cellular network employing FD with two UEs pairs. The base
station selects pairs of UEs, represented by the ellipses, and jointly schedules
them for FD transmission by allocating frequency channels in the UL and DL.
To mitigate UE-to-UE interference, it is advantageous to co-schedule DL/UL
users for FD transmission that are far apart, such as UE1-UE2 and UE3-UE4.
spectral efﬁciency of traditional wireless systems operating in
HD [3], [4]. TNFD involves three nodes, but only one of them
needs to have FD capability. The FD-capable node transmits
to its receiver node while receiving from another transmitter
node on the same frequency channel.

As illustrated in Figure 1, FD operation in a cellular en-
vironment experiences new types of interference, aside from
the inherently present SI. Because the level of UE-to-UE
interference depends on the UE locations and their transmission
powers, coordination mechanisms are needed to mitigate the
negative effect of the interference on the spectral efﬁciency
of the system [5]. A key element of such mechanisms is UE
pairing and frequency channel selection that together determine
which UEs should be scheduled for simultaneous UL and
DL transmissions on speciﬁc frequency channels. Hence, it
is crucial to design efﬁcient and fair medium access control
protocols and physical layer procedures capable of supporting
adequate pairing mechanisms. Furthermore, in future cellular
networks the idea is to move from a fully centralized to a more
distributed network [6], where the infrastructure of the BS can
be used to help the UEs to communicate in a distributed manner
and reduce the processing burden at the BS, which is further
increased by SI cancellation.

To the best of our knowledge, the only work to consider a
distributed approach for FD cellular networks is reported in [7].
However, the authors tackle the problem of the UE-to-UE
interference from an information theoretic perspective, without
relating to resource allocation and power control. Conversely,
some works consider the joint subcarrier and power allocation

problem [8] and the joint duplex mode selection, channel
allocation, and power control problem [9] in FD networks. The
cellular network model in [8] is applicable to FD mobile nodes
rather than to networks operating in TNFD mode. The work re-
ported in [9] considers the case of TNFD transmission mode in
a cognitive femto-cell context with bidirectional transmissions
from UEs and develops sum-rate optimal resource allocation
and power control algorithms. However, none of these two
works consider a distributed approach for FD cellular networks.
In this paper we formulate the joint problem of user pairing
(i.e. co-scheduling of UL and DL simultaneous transmis-
sions on a frequency channel), and UL/DL power control as
a mixed integer nonlinear programming (MINLP) problem,
whose objective is to maximize the overall spectral efﬁciency
of the system. Due to the complexity of the MINLP problem
proposed, our solution approach relies on Lagrangian duality
and a distributed auction algorithm in which UL users offer
bids on desirable DL users. In this iterative auction process, the
BS – as the entity that owns the radio resources – accepts or
rejects bids and performs resource assignment. This algorithm
is tested in a realistic system simulator that indicates that the
bidding process converges to a near optimal pairing and power
allocation.

II. SYSTEM MODEL AND PROBLEM FORMULATION

A. System Model

We consider a single-cell cellular system in which only the
BS is FD capable, while the UEs served by the BS are only
HD capable, as illustrated by Figure 1. In Figure 1, the BS is
subject to SI and the UEs in the UL (UE2 and UE4) cause UE-
to-UE interference to co-scheduled UEs in the DL, that is to
UE1 and UE3 respectively. The number of UEs in the UL and
DL is denoted by I and J, respectively, which are constrained
by the total number of frequency channels in the system F , i.e.,
I ≤ F and J ≤ F . The sets of UL and DL users are denoted
by by I = {1, . . . , I} and J = {1, . . . , J} respectively.

We consider frequency ﬂat and slow fading, such that the
channels are constant during the time slot of a scheduling
instance and over the frequency channels assigned to co-
scheduled users. Let Gib denote the effective path gain between
transmitter UE i and the BS, Gbj denote the effective path gain
between the BS and the receiving UE j, and Gij denote the
interfering path gain between the UL transmitter UE i and the
DL receiver UE j. To take into account the residual SI power
that leaks to the receiver, we deﬁne β as the SI cancellation
coefﬁcient, such that the SI power at the receiver of the BS is
βP d

j when the transmit power is P d
j .
The vector of transmit power levels in the UL by UE i is
I ], whereas the DL transmit powers
denoted by pu = [P u
by the BS is denoted by pd = [P d
J ]. As illustrated in
Figure 1, the UE-to-UE interference is much dependent on the
geometry of the co-scheduled UL and DL users, i.e., the pairing
of UL and DL users. Therefore, UE pairing is a key functions
of the system. Accordingly, we deﬁne the assignment matrix,

1 . . . P u

1 . . . P d

X ∈ {0, 1}I×J, such that

xij =(1,

0, otherwise.

if the UL UEi is paired with the DL UEj,

The signal-to-interference-plus-noise ratio (SINR) at the BS
of transmitting user i and the SINR at the receiving user j of
the BS are given by
i Gib
j=1 xij P d
j β

P d
j Gbj
i=1 xij P u

respectively, where xij in the denominator of γu
the SI at the BS, whereas xij in the denominator of γd
for the UE-to-UE interference caused by UEi to UEj.

i accounts for
j accounts

σ2 +PJ

σ2 +PI

γu
i =

i Gij

, γd

j =

, (1)

P u

i ) and C d

j = log2(1 + γd

i = log2(1 + γu

Thus, the achievable spectral efﬁciency for each user is given
by the Shannon equation (in bits/s/Hz) for the UL and DL as
j ), respectively.
C u
In addition to the spectral efﬁciency, we consider weights for
the UL and DL users, which are denoted by αu
i and αd
j ,
respectively. The idea behind weighing is that it allows the
system designer to choose between the commonly used sum
rate maximization and important fairness related criteria such
as the well known path loss compensation typically employed
in the power control of cellular networks [10]. For the weights
j , we can account for sum rate maximization with
i and αd
αu
i = G−1
i = αd
αu
and αd

j = 1 and for path loss compensation with αu

ib

j = G−1
bj .

B. Problem Formulation

Our goal is to jointly consider the assignment of UEs in the
UL and DL (pairing), while maximizing the weighted sum
spectral efﬁciency of all users. Speciﬁcally, the problem is
formulated as

J

Xj=1

maximize
X,pu,pd

αu
i C u

i +

subject to γu
i ≥ γu
j ≥ γd
γd
P u
i ≤ P u
P d
j ≤ P d
I

th, ∀i,
th, ∀j,
max, ∀i,
max, ∀j,

xij ≤ 1, ∀j,

xij ≤ 1, ∀i,

I

Xi=1

J

Xi=1
Xj=1

αd
j C d

j

(2a)

(2b)
(2c)
(2d)
(2e)

(2f)

(2g)

xij ∈ {0, 1}, ∀i, j.

(2h)
The main optimization variables are pu, pd and X. Constraints
(2b) and (2c) ensure a minimum SINR to be achieved in the
DL and UL, respectively. Constraints (2d) and (2e) limit the
transmit powers whereas constraints (2f)-(2g) assure that only
one UE in the DL can share the frequency resource with a
UE in the UL and vice-versa. Note that constraints (2b)-(2c)
require that the SINR targets for both UL and DL be deﬁned
a priori.

Problem (2) belongs to the category of MINLP, which is
known for its high complexity and computational intractability.
Thus, to solve problem (2) we will rely on Lagrangian duality,

2

which is described on Section III. We develop the optimal
power allocation for a UL-DL pair and the optimal closed-
form solution for the assignment, which can be solved in a
centralized manner. However, in future cellular networks the
idea is to move from a fully centralized to a more distributed
network [6], ofﬂoading the burden on the BS. With this
objective, in Section IV we use the optimal power allocation
to create a distributed solution for the assignment between UL
and DL users.

III. A SOLUTION APPROACH BASED ON LAGRANGIAN

DUALITY

From problem (2), we form the partial Lagrangian function
by considering constraints (2b)-(2c) and ignoring the integer
(2f)-(2h) and power allocation constraints (2d)-(2e). To this
end, we introduce Lagrange multipliers λu, λd, where the
superscript u and d denote the dimensions of I and J, respec-
tively. The partial Lagrangian is a function of the Lagrange
multipliers and the optimization variables X, pu, pd as follows:

I

J

L(λu, λd, X, pu, pd) , −

αu
i C u

i −

αd
j C d

j +

Xi=1
i(cid:17) +

J

Xj=1

Xj=1
j(cid:16)γd

j(cid:17).

th − γu

λd

th − γd

(3)

+

I

Xi=1

λu

i(cid:16)γu

Let g(λu, λd) denote the dual function obtained by mini-
mizing the partial Lagrangian (3) with respect to the variables
X, pu, pd. That is, the dual function is

g(λu, λd) =

inf

L(λu, λd, X, pu, pd),

(4)

X∈X pu ,pd ∈P

where X and P are the set where the assignment and power
allocation constraints are fulﬁlled, respectively. Notice that we
can rewrite the dual as
N

g(λu, λd) = inf

X∈X pu ,pd∈P

in (X, pu, pd) + qd

jn (X, pu, pd)!,

(5)
where we assume N = I = J is the maximum number of
UL-DL pairs, in and jn are the UL and DL users of pair n,
respectively. Moreover,

Pn=1 qu

in (X, pu, pd) , λu
qu

th − γu

i C u
in ,

(6a)

in(cid:16)γu
jn(cid:16)γd

in(cid:17) − αu
jn(cid:17) − αd

jn (X, pu, pd) , λd
qd

(6b)
We can ﬁnd the inﬁmum of (5) if we maximize the SINR
of the N UL-DL pairs. Thus, we can write a closed-form
expression for the assignment xij as follows:

jn C d
jn .

th − γd

x⋆

ij =


1,

if (i, j) = arg max

i,j

0, otherwise,

jn (cid:17)
(cid:16)qu,max
in + qd,max

(7)

where for simplicity we denoted an ordinary pair as (i, j).
Notice that x⋆
ij and equation (7) uniquely associate an UL user
with a DL user. However, the solutions are still tied through the
SINRs γu
j , i.e., the solution to the assignment problem
is still complex and – through (7) – is intertwined with the
optimal power allocation.

i and γd

Since the SINRs on the UL are not separable from those on
the DL, we cannot analyse them independently. Consequently,

3

we need to ﬁnd the powers that jointly minimize (5). To this
end, we ﬁrst analyse the dual problem, given by

maximize

λu, λu

g(λu, λd)

(8a)

λu
i , λd

th − γu

subject to

j , ≥ 0, ∀i, j,

i(cid:16)γu

(8b)
where recall that g(λu, λd) is the solution of problem (4).
Notice that if constraints (2b)-(2c) are fulﬁlled in the inequality
or equality, λu
negative or zero. If the terms are negative, then λu
j will be
j will not impact g(λu, λd).
zero. Thus, the terms with λu
Therefore, the dual is easily solved by assigning zero to λu
i or
j whose corresponding UL and DL user fulﬁls the inequalities
λd
(2b)-(2c). If there are users that do not fulﬁl the inequalities,
the problem is unbounded.

j(cid:17) will be either

i(cid:17) and λd

j(cid:16)γd

i and λd

th − γd

i or λd

Therefore, we now turn our attention to the power allocation
j –,

problem, and – based on the above considerations on λu
we formulate the power allocation problem as:

i or λd

I

J

minimize

pu,pd

−

Xi=1

Xj=1

αu
i C u

i −

αd
j C d

j

(9a)

i or P d

subject to pu, pd ∈ P.

(9b)
From Gesbert et al. [11], the optimal transmit power allocation
max, given
will have either P u
that i and j share a frequency channel and form a pair.
Moreover, from Feng et al. [12, Section III.B], the optimal
power allocation lies within the admissible area for pair (i, j),
where we do not show the explicit expressions for the optimal
power allocation here due to space limit.

max or P d

j equal

to P u

Therefore, with the optimal transmit powers for any given
pair (i, j), and with the closed-form solution for the assignment
in Eq. (7), we can solve the dual problem (8). To compute the
optimal assignment as given by Eq. (7) requires checking N !
assignments [13, Section 1], or we could apply the Hungarian
algorithm in a fully centralized manner [13, Section 3.2], that
has worst-case complexity of O(N 3).

However, we are not

interested in such centralized and
demanding solutions that would increase the burden on the BS.
Since we are in a network-controlled environment with the BS,
we use its resources to provide a distributed solution for the
assignment, whereas the power allocation would remain cen-
tralized, because distributed power allocation schemes require
too many iterations to converge. Therefore, in the next section
we reformulate the closed-form solution in Eq. (7) and propose
a fully distributed assignment based on Auction Theory [14].

IV. DISTRIBUTED AUCTION SOLUTION

With the optimal power allocation for a pair (i, j) at
hand, and as mentioned in Section III, we are interested in
a distributed solution for the closed-form solution for the
assignment in Eq. (7) in order to reduce the burden on the
BS by supporting a more distributed system. In Section IV-A
we reformulate the closed-form expression as an asymmetric
assignment problem, whereas Section IV-B introduces the
fundamental deﬁnitions necessary to propose the distributed
auction algorithm in Section IV-C. Furthermore, we give one
of the core results in this paper in Section IV-D, where we show

that the number of iterations of the algorithms is bounded and
that the feasible assignment provided at the end is within a
bound of desired accuracy around the optimal assignment.

A. Problem Reformulation

We can rewrite the closed form expression (7) as an asym-

metric assignment problem, given by

I

J

maximize

X

subject to

cijxij

Xj=1

xij = 1, ∀j,

xij = 1, ∀i,

(10a)

(10b)

(10c)

I

Xi=1
Xi=1
Xj=1

J

j C d

i C u

i + αd

(10d)
xij ∈ {0, 1}, ∀i, j,
j for a pair (i, j) assigned to the
where cij = αu
same frequency and it can be understood as the beneﬁt of
assigning UL user i to DL user j. Constraint (10b) ensures
that the DL users are associated with one UL user. Similarly,
constraint (10c) ensures that all
the UL users need to be
associated with a DL user. To solve this problem in a distributed
manner, we use Auction Theory.

B. Fundamentals of the Auction

We consider the assignment problem (10), where we want
to pair I UL and J DL users on a one-to-one basis, where
the beneﬁt for pairing UL user i to DL user j is given by cij.
Initially, we assume that J = I and J ≤ F , whereas the set
of DL users to which UL user i can be paired is non-empty
and is denoted by A(i). We deﬁne an assignment S as a set
of UL-DL pairs (i, j) such that j ∈ A(i) for all (i, j) ∈ S and
for each UL and DL user there can be at most one pair (i, j) ∈
S, respectively. The assignment S is said to be feasible if it
contains I pairs; otherwise the assignment is called partial [14].
Lastly, in terms of the assignment matrix X, the assignment is
feasible if constraints (10b)-(10c) are fulﬁlled for all i ∈ I and
j ∈ J .

An important notion for the correct operation of the auction
algorithm is the ǫ-complementary slackness (ǫ-CS), which
relates a partial assignment S and a price vector ˆp = [ˆp1 . . . ˆpJ ].
In practice, the DL user j that supports more interference from
a UL user i will get a higher price, i.e., the prices reﬂect how
much a UL user i is willing pay to connect to DL user j. The
couple S and ˆp satisfy ǫ-CS if for every pair (i, j) ∈ S, DL
user j is within ǫ of being the best candidate pair for UL user
i [14], i.e.,

cij − ˆpj ≥ max
k∈A(i)

{cik − ˆpk} − ǫ, ∀(i, j) ∈ S.

(11)

For the sake of clarity we deﬁne cij − ˆpj as the utility that
UL user i can obtain from DL user j. The auction algorithm is
iterative, where each iteration starts with a partial assignment
and the algorithm terminates when a feasible assignment is
obtained.

The iteration process consists of two phases: the bidding
and the assignment. In the bidding phase, each UL user bids

4

for a DL user that maximizes the associated utility (cij − ˆpj),
and the BS evaluates the bid received from the UL users. In
the assignment phase, the BS (responsible for the transmission
to DL users), selects the UL user with the highest bid and
updates the prices. In fact, this bidding and assignment process
implies that the UL users select the DL users which they
will be paired with. However, the information exchange occurs
between UL users and the BS, rather than between the UL-DL
users. Therefore, we propose a forward auction in which the
UL users and the BS determines the pairing of UL-DL users in
a distributed manner, where the UL is responsible for bidding
and the BS for the assignment phase.

In the following, we present some necessary deﬁnitions for
the iteration process. First, we deﬁne vi as the maximum utility
achieved by UL user i on the set of possible DL users A(i),
which is given by

vi = max
j∈A(i)

{cij − ˆpj}.

(12)

The selected DL user ji is the one that maximizes vi, which
is given by

ji = arg max
j∈A(i)

vi.

(13)

The best utility offered by other DL users than the selected ji
is denoted by wi and is given by

wi = max

j∈A(i),j6=ji

{cij − ˆpj}.

(14)

The bid of UL user i on resource ji is given by

biji = cij − wi + ǫ.

(15)
Let P(j) denote the set of UL users from which DL user j
received a bid. In the assignment phase the prices are updated
based on the highest bid received, which is given by

ˆpj = max
i∈P(j)

{bij}.

(16)

Subsequently, the BS adds the pair (ij, i) to the assignment S,
where ij refers to the UL user i ∈ P(j) that maximizes bij
in eq. (16) for DL user j. At UL user i, ˆPi = [ ˆPi1 . . . ˆPiJ ]
denotes the price vector of associating with DL user j and it is
informed by the BS. Differently from ˆPij, ˆpj is the up-to-date
maximum price of DL user j.

Summarizing, in the bidding phase the UL users need to
evaluate vi, ji, wi and biji, whereas in the assignment phase
the BS receives the bids and decides to update the prices ˆpj or
not. In the next section, we propose the distributed auction that
is executed in an asynchronous manner, where the UL users
perform the bidding, and the BS performs the assignment.

C. The Distributed Auction Algorithm

Algorithm 1 and Algorithm 2 show the steps of the iterative
process of the bidding and assignment phases, where the
bidding is performed at each UL user and the assignment at the
BS. We deﬁne messages M1, M2, M3 and M4 that enable the
exchange of information between the UL users and the BS.
Message M1 informs UL user i that the bid was accepted.
Message M2 informs that the bid is not high enough and
it also contains the most updated price ˆpj of the demanded
DL user ji. Message M3 informs that a feasible assignment
was found, which allows the auction algorithm to terminate.

Algorithm 1 Distributed Auction Bidding at UL user i
1: Input: ci, ǫ
2: Deﬁne Pi = 0, ij = ∅ and A(i) = J
3: while Message M3 is not received do
4:
5:
6:
7:

Disconnect from previous DL user ji and set ji = ∅
Update prices ˆPij = ˆpj

if Message M2 is received then

end if
Bidding Phase at the UL users
if ji = ∅ then

Evaluate vi according to Equation (12)
Select the DL user ji according to Equation (13)
Evaluate wi according to Equation (14)
Evaluate the bid biji according to Equation (15)
Report the selected DL user ji and the bid biji and wait response
if Message M1 is received then
Store the assigned DL user ji

8:
9:
10:
11:
12:
13:
14:
15:
16:
end if
17:
18: end while
19: Message M4 is received with the assigned DL user ji and the power pi

end if

Message M4 informs the UL and DL users their respective pairs
and transmitting powers. Notice that all these messages can be
exchanged between the BS and the UL/DL users using control
channels, such as physical uplink control channel (PUCCH)
and physical downlink control channel (PDCCH) [15].

UL user i requires as inputs the beneﬁts ci and the ǫ for
the bidding phase (see line 1 on Algorithm 1). Then, the price
vector is initialized with zero, as well as the associated DL user
is initially empty and the set of DL users it can associate with
is the set J (see line 2 in Algorithm 1). The auction algorithm
at the UL users will continue until message M3 is received (see
line 3 on Algorithm 1). If message M2 is received, UL user i
disconnects from the previously associated DL user ji and set
it to ∅. Next, the price received from the BS is updated (see
lines 5-6 on Algorithm 1). Notice that message M2 implies that
either the previously associated DL user has a new association
or the bid was lower than the current price (the bid was placed
with an outdated price).

Subsequently, if UL user i is not associated with a DL
user, the bidding phase starts. In this phase, the necessary
variables – vi, ji, wi and biji – are evaluated (see lines 9-12
on Algorithm 1). UL user i reports the selected DL user and bid
to the BS and wait for the response on line 13 on Algorithm 1.
If the response is message M1, then the association to the
selected DL user ji is stored.

The BS runs Algorithm 2 and initially needs to acquire or
estimate all channel gains from UL and DL users, which can be
done using reference signals similar to those standardized by
3rd Generation Partnership Project (3GPP) [15]. Next, the BS
evaluates the optimal power allocation pu, pd for all possible
pairs based on the solution of problem (9) (see lines 1-2 on
Algorithm 2). Then, the assignment beneﬁts cij are evaluated
and the corresponding row of each UL user i is sent (see line 3
on Algorithm 2). The value of ǫ is ﬁxed and sent on line 3 of
Algorithm 2. The selected UL users ij for all DL users j is
initially empty, and the set of possible UL users that a DL user
may associate is deﬁned as the set of UL users I (see line 4
on Algorithm 2). The prices ˆpj and the assignment matrix X
are initialized with zero (see line 5).

5

Algorithm 2 Distributed Auction Assignment at the BS
1: Estimate the channel gains Gib, Gbj and Gij for all UL and DL users
2: Evaluate the optimal power allocation pu, pd for every pair (i, j) based

3: Evaluate cij and then send to all UL users its respective row (ci =

on the solution of problem (9)

[ci1 . . . ciJ ]T ) along with ǫ

4: Initialize the selected UL users ij = ∅, ∀j and P(j) = I, ∀j
5: Initialize the prices ˆpj = 0, ∀j and the assignment matrix X = 0

if receive request from UL user i then

Assignment Phase at the BS

6: while X is not feasible do
7:
8:
9:
10:

if bij − ˆpj ≥ ǫ then

Update prices according to Equation (16)
Report M2 to the previous assigned user ij and the updated prices

# Bid accepted

else

end if

Report M2 and the updated prices ˆpj to UL user i

Update ij = i and report M1 to UL user i
Update assignment X and if feasible, report M3 to UL user ij

11:
12:
13:
14:
15:
16:
17:
end if
18:
19: end while
20: Output: X, pu, pd
21: Report M4 to the UL and DL user their respective pairs and powers

Remain assigned to the UL user on iteration t

else

The assignment phase at the BS continues until the assign-
ment matrix X is not feasible (see line 6). If the BS receives
request from UL user i and the bid is accepted, the prices are
updated based on the new bid and the BS reports M2 to the
previously assigned user ij with the updated prices (see lines 6-
10 on Algorithm 2). Then, the BS updates the assigned user,
reports message M1 to UL user i and update the assignment
X (see lines 11-12 on Algorithm 2). If the new assignment is
feasible, the BS reports M3 to all UL users.

However, if the bid proposed by UL user i is not accepted,
then the BS reports M2 to UE i with the updated prices (see
line 14 on Algorithm 2). Notice that while the BS does not
received requests, the assignment does not change (see line 17).
Once a feasible assignment is found and message M3 is sent,
the algorithm has as outputs the matrix assignment X and the
power vectors pu and pd. With the assignment and the power
vectors, message M4 is sent to UL and DL users with their
respective pairs and powers.

Therefore, by using Algorithms 1 and 2, we solve in a
distributed manner problem (10), but it is important to know
how many iterations the algorithms execute until a partial
assignment is found, and how far this assignment is from the
optimal solution. In order to address all these questions, in
Section IV-D we show that the algorithms terminate within a
bounded number of iterations and that the assignment given at
the end is within Iǫ of being optimal.
D. Complexity and Optimality

In this subsection we derive a bound on the number of
iterations of our proposed distributed auction algorithms in
Theorem 1. Moreover, in Theorem 2 we show that the given
assignment solution by Algorithms 1 and 2 is within Iǫ of
being optimal.
Theorem 1. Consider I UL users and J DL users in a TNFD
network. The distributed auction algorithms 1 and 2 terminate

within a ﬁnite number of iterations bounded by IJ 2⌈∆/ǫ⌉,
where ∆ = max
∀i,j

cij − min
∀i,j

cij.

Proof: The proof of this theorem is along the lines of Xu
et al. [16, Chapter 5], where we do not provide the complete
proof herein due to the lack of space.

Theorem 1 shows that our algorithms terminate in a ﬁnite
number of iterations bounded by IJ 2⌈∆/ǫ⌉. However, we
still need to know how far the solution is from the optimal
assignment. In Theorem 2 we show that the feasible assignment
at the end of the distributed auction is within Iǫ of being
optimal, and if the beneﬁts cij are integer and ǫ < 1/J, the
solution is optimal.
Theorem 2. Consider problem (10). The distributed auction
algorithm described by Algorithms 1 and 2 terminate with a
feasible assignment that is within Iǫ of being optimal. This
feasible assignment is optimal if cij , ∀i, j is integer and ǫ <
1/J.

Proof: Once more, the proof of this theorem is along the

lines of [16, Chapter 5].

Based on Theorems 1 and 2, the distributed auction solution
proposed by Algorithms 1 and 2 terminate within IJ 2⌈∆/ǫ⌉
iterations, and in addition the feasible assignment at the end
of the algorithms is within Iǫ of being optimal. Notice that
in practice the beneﬁts cij are seldom integer, implying that
our solution to problem (10) is near optimal. Moreover, since
the primal problem (2) is MINLP, the duality gap between
the primal and dual solution is not zero,
i.e., we should
also take into account the duality gap on top of the gap
between the distributed auction and the optimal assignment
for problem (10). However, as we show in Section V, the
gap between the exhaustive primal solution and the distributed
auction is small.

V. NUMERICAL RESULTS AND DISCUSSION

In this section we consider a single cell system operating in
the urban micro environment [17]. The maximum number of
frequency channels is F = 25 that corresponds to the number
of available frequency channel blocks in the a 5 MHz Long
Term Evolution (LTE) system [17]. The total number of served
UE varies between I + J = 8...50, where we assume that
I = J. We set the weights αu
j based on a path loss
compensation rule, where αu
bj . The
parameters of this system are set according to Table I.

i and αd
i = G−1

j = G−1

and αd

ib

To evaluate the performance of the distributed auction in
this environment, we use the RUdimentary Network Emulator
(RUNE) as a basic platform for system simulations and ex-
tended it to FD cellular networks. The RUNE FD simulation
tool allows to generate the environment of Table I and perform
Monte Carlo simulations using either an exhaustive search
algorithm to solve problem (2) or the distributed auction.

Initially, we compare the optimality gap between the exhaus-
tive search solution of the primal problem (2), named herein as
E-OPT, the optimal solution of the dual problem (8) using the
power allocation based on the corner points and the centralized
Hungarian algorithm for the assignment, named herein as C-
HUN, and ﬁnally the solution of the dual problem (8) with the
optimal power allocation but now with the distributed auction

6

Table I

SIMULATION PARAMETERS

Parameter
Cell radius
Number of UL UEs [I = J]
Monte Carlo iterations
Carrier frequency
System bandwidth
Number of freq. channels [F ]
LOS path-loss model
NLOS path-loss model
Shadowing st. dev. LOS and NLOS
Thermal noise power [σ2]
SI cancelling level [β]
Max power [P u
Minimum SINR [γ u
Step size [ǫ]

max] = [P d
max]
th = γ d
th ]

Value
100 m
[4 5 6 25]
400
2.5 GHz
5 MHz
[4 5 6 25]
34.96 + 22.7 log10(d)
33.36 + 38.35 log10(d)
3 dB and 4 dB
−116.4 dBm/channel
[−70 − 100 − 110] dB
24 dBm
[0] dB
0.1

1

0.8

0.6

0.4

0.2

F
D
C

0
10

P-OPT-I+J=8
C-HUN-I+J=8
D-AUC-I+J=8
P-OPT-I+J=10
C-HUN-I+J=10
D-AUC-I+J=10
P-OPT-I+J=12
C-HUN-I+J=12
D-AUC-I+J=12

20
50
Sum Spectral Efficiency [bps/Hz]

40

30

60

Figure 2. CDF of the optimality gap of the sum spectral efﬁciency for different
users’ load. We notice that the optimality gap between the proposed D-AUC
and the exhaustive search solutions of the primal and dual, E-OPT and C-HUN,
is low, which suggests that we can use a distributed solution based on the dual
and still be close to the centralized optimal solution of the primal.
solution for the assignment, named herein as D-AUC. In the
following, we compare how the distributed auction solution
performs in comparison with a HD system, named herein as
HD, and also a basic FD solution with random assignment and
equal power allocation (EPA) for UL and DL users, named
herein as R-EPA. Notice that since in HD systems two different
time slots are required to serve all the UL and DL users, which
implies that the sum spectral efﬁciency is divided by two.

In Figure 2 we show the sum spectral efﬁciency between
E-OPT, C-HUN and the proposed D-AUC as a measure of
the optimality gap. We assume a small system with reduced
number of users, 4 UL and DL users, and frequency channels,
where we increase its number from 4 to 8. Moreover, we
consider a SI cancelling level of β =−100 dB. We notice
that the differences between the exhaustive search solutions,
either E-OPT OR C-HUN, to the D-AUC is negligible, where
in some cases the D-AUC achieves a higher performance than
E-OPT due to lack of computational power to ﬁnd the best
powers. Figure 2 clearly shows that the optimality gap is low
for the distributed auction when compared to the centralized
dual solution (C-HUN) and also to the primal solution (E-
OPT). Therefore, we can use a distributed solution to solve
the primal problem (2) and still achieve a solution close to the
centralized optimal solution.

Figure 3 shows the sum spectral efﬁciency between the
current HD system, a naive FD implementation named R-EPA,
and the proposed distributed solution D-AUC. We assume a
small system fully loaded with 25 UL, DL users, and frequency

F
D
C

1

0.8

0.6

0.4

0.2

0

0

89% of

gain

R-EPA(SI:-110)
D-AUC(SI:-110)
R-EPA(SI:-70)
D-AUC(SI:-70)
HD

20
80
Sum Spectral Efficiency [bps/Hz]

60

40

100

Figure 3. CDF of the sum spectral efﬁciency among all users for different SI
cancelling levels. We notice that with β =−110 dB the UE-to-UE interference
is the limiting factor, where D-AUC mitigates this new interference and
outperforms the HD mode and the R-EPA. When β =−70 dB, the SI is
the limiting factor, where the mitigation of the UE-to-UE interference is not
enough to bring gains to FD cellular networks.
channels, where we analyse the impact of the solutions for
different SI cancelling levels of −110 dB and −70 dB, i.e.,
β =−110 dB and −70 dB. Notice that with a SI cancelling
level of −110 dB we achieve 89 % relative gain in the spectral
efﬁciency at the 50th percentile, which is close to the expected
doubling of FD networks. Moreover, the naive R-EPA performs
approximately 43 % worse than the HD mode, which shows
that despite the high SI cancelling level, we do not have
any gain of using FD networks. This behaviour shows that
we should also optimize the UL-DL pairing and the power
allocation of the UL user and of the BS. When the SI level
is −70 dB, HD outperforms the D-AUC and R-EPA with a
relative gain of approximately 23 % and 81 % at
the 50th
percentile, respectively. This means that with low SI cancelling
levels the D-AUC algorithm is not able to overcome the high
self-interference, although the difference to HD is not high.
As for the R-EPA, notice that its performance is even worse
than before, which once more indicates that we should not use
naive implementation of user pairing and power allocation on
FD cellular networks. Overall, we notice that when the SI can-
celling level is high, the UE-to-UE interference is the limiting
factor, where our proposed D-AUC outperforms a naive FD
implementation that disregards this interference. When the SI
cancelling level is low, then the SI is the limiting factor, where
optimizing the UE-to-UE interference is not enough to bring
gains to FD cellular networks.

VI. CONCLUSION

In this paper we considered the joint problem of user pairing
and power allocation in FD cellular networks. Speciﬁcally,
our objective was to maximize the weighted sum spectral
efﬁciency of the users, where we can tune the weights to
sum maximization or path loss compensation. This problem
was posed as a mixed integer nonlinear optimization, which
is hard to solve directly,
thus we resorted to Lagrangian
duality and developed a closed-form solution for the assign-
ment and optimal power allocation. Since we were interested
in a distributed solution between the BS and the users, we
proposed a novel distributed auction solution to solve the
assignment problem, whereas the power allocation was solved

7

in a centralized manner. We showed that the distributed auction
converges and that it has a guaranteed performance compared
to the dual. The numerical results showed that our distributed
solution drastically improved the sum spectral efﬁciency in
a path loss compensation modelling, i.e. of the users with
low spectral efﬁciency, when compared to current HD modes
when the SI cancelling level is high. Furthermore, we noticed
that with a high SI cancelling level, the impact of the UE-to-
UE interference is severe and needs to be properly managed.
Conversely, when the SI cancelling level
is low, a proper
management of the UE-to-UE interference is not enough to
bring gains to FD cellular networks. Studying the case of
asymmetric assignment, that is the case of unequal number of
UL and DL users and the impact of the number of iterations and
processing delays in the auction algorithm are left for future
works.

REFERENCES

[1] M. Heino, D. Korpi et al., “Recent Advances in Antenna Design and
Interference Cancellation Algorithms for In-Band Full Duplex Relays,”
IEEE Communications Magazine, vol. 53, no. 5, pp. 91–101, May 2015.
[2] L. Laughlin, M. A. Beach et al., “Electrical Balance Duplexing for Small
Form Factor Realization of In-Band Full Duplex,” IEEE Communications
Magazine, vol. 53, no. 5, pp. 102–110, May 2015.

[3] D. Bharadia, E. McMilin, and S. Katti, “Full Duplex Radios,” SIGCOMM

Comput. Commun. Rev., vol. 43, no. 4, pp. 375–386, Oct. 2013.

[4] K. Thilina, H. Tabassum et al., “Medium Access Control Design for Full
Duplex Wireless Systems: Challenges and Approaches,” IEEE Commu-
nications Magazine, vol. 53, no. 5, pp. 112–120, May 2015.

[5] S. Goyal, P. Liu et al., “Full Duplex Cellular Systems: Will Doubling
Interference Prevent Doubling Capacity ?” IEEE Communications Mag-
azine, vol. 53, no. 5, pp. 121–127, May 2015.

[6] A. Osseiran, F. Boccardi et al., “Scenarios for 5G mobile and wireless
communications: the vision of the METIS project,” IEEE Communica-
tions Magazine, vol. 52, no. 5, pp. 26–35, May 2014.

[7] J. Bai and A. Sabharwal, “Distributed full-duplex via wireless side-
channels: Bounds and protocols,” IEEE Transactions on Wireless Com-
munications, vol. 12, no. 8, pp. 4162–4173, Aug. 2013.

[8] C. Nam, C. Joo, and S. Bahk, “Joint Subcarrier Assignment and Power
Allocation in Full-Duplex OFDMA Networks,” IEEE Transactions on
Wireless Communications, vol. 14, no. 6, pp. 3108–3119, Jun. 2015.

[9] M. Feng, S. Maoa, and T. Jiang, “Joint Duplex Mode Selection, Channel
Allocation, and Power Control for Full-Duplex Cognitive Femtocell
Networks,” Digital Communications and Networks, vol. 1, no. 1, pp.
30–44, Apr. 2015.

[10] A. Simonsson and A. Furuskar, “Uplink power control in LTE - overview
and performance,” in Proc. of the IEEE Vehic. Tech. Conf. (VTC), 2008.
[11] A. Gjendemsjø, D. Gesbert et al., “Binary power control for sum rate
maximization over multiple interfering links,” IEEE Transactions on
Wireless Communications, vol. 7, no. 8, pp. 3164–3173, Aug. 2008.

[12] D. Feng, L. Lu et al., “Device-to-Device Communications Underlaying
Cellular Networks,” IEEE Transactions on Communications, vol. 61,
no. 8, pp. 3541–3551, Aug. 2013.

[13] R. E. Burkard and E. Çela, “Linear Assignment Problems and Exten-
sions,” in Handbook of Combinatorial Optimization, D.-Z. Du and P. M.
Pardalos, Eds. Springer US, 1999, pp. 75–149.

[14] D. P. Bertsekas, Network Optimization: Continuous and Discrete Models.

Cambridge, MA: MIT Press, 1998.

[15] 3GPP, “Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Universal Terrestrial Radio Access Network (E-UTRAN); Over-
all description; Stage 2,” 3rd Generation Partnership Project (3GPP), TS
36.300, Sep. 2015.

[16] Y. Xu, “Decentralized Network Optimization in Wireless Networks,” pp.

viii, 112, 2014.

[17] 3GPP, “Evolved Universal Terrestrial Radio Access (E-UTRA); Further
layer aspects,” 3rd Generation

advancements for E-UTRA physical
Partnership Project (3GPP), TR 36.814, Mar. 2010.

