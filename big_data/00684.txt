A RANDOM MODEL FOR THE PALEY GRAPH

RUDI MRAZOVI ´C

Abstract. For a prime p we deﬁne the Paley graph to be the graph with the set of ver-
tices Z{pZ, and with edges connecting vertices whose sum is a quadratic residue. Paley
graphs are notoriously diﬃcult to study, particularly ﬁnding bounds for their clique num-
bers. For this reason, it is desirable to have a random model. A well known result of Graham
and Ringrose shows that the clique number of the Paley graph is Ωplog p log log log pq (even
Ωplog p log log pq, under the generalized Riemann hypothesis) for inﬁnitely many primes p
– a behaviour not detected by the random Cayley graph which is hence deﬁcient as a ran-
dom model for for the Paley graph. In this paper we give a new probabilistic model which
incorporates some multiplicative structure and as a result captures the Graham-Ringrose phe-
nomenon. We prove that if we sample such a random graph independently for every prime,
then almost surely (i) for inﬁnitely many primes p the clique number is Ωplog p log log pq,
whilst (ii) for almost all primes the clique number is p2 ` op1qq log p.

6
1
0
2

 
r
a

M
2

 

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
4
8
6
0
0

.

3
0
6
1
:
v
i
X
r
a

1. Introduction

Let N be a prime and R Ă Z{N Z be the set of quadratic residues. We deﬁne the so-called
Paley sum graph ΓR to be the graph with the set of vertices Z{N Z, and edges connecting
vertices whose sum is in R. It is a well known open problem to ﬁnd good asymptotics for the
clique number ωpΓRq of this graph, that is the size of the largest complete subgraph.

Cohen [Coh88] proved the lower bound p1{2` op1qq log N (all logarithms in this paper will
be with base 2). On the other hand, using basic Fourier analysis and standard estimates for
Gauss sums, one can easily prove the upper bound ?N . There are only minor improvements
of this bound. For example, it can be shown [San] that for primes of the form N “ m2 ` 1
for integer m ą 2, the clique number is at most m ´ 1 (unfortunately, it is not even known
that there are inﬁnitely many primes of this form).

It is widely believed that the set of quadratic residues should have properties similar to
a random subset of density 1{2, which leads to an obvious question of ﬁnding the clique
number of the random Cayley sum graph ΓA. As the notation suggests, ΓA is obtained by
ﬁrst choosing a random subset A Ă Z{N Z by putting each element in it independently with
probability 1{2, and then joining vertices x, y P Z{N Z if and only if x ` y P A. Recently,
Green and Morris [GM15] proved that with high probability ωpΓAq “ p2 ` op1qq log N which
suggests that the clique number of the Paley sum graph might also be close to this value.

However, it is known that the clique number of the Paley sum graph is a little bit bigger
than 2 log N for inﬁnitely many primes N . Indeed, Graham and Ringrose [GR90] proved that

1

2

RUDI MRAZOVI ´C

for inﬁnitely many primes N the lowest quadratic nonresidue q is Ωplog N log log log Nq, that
is at least c log N log log log N for some constant c ą 0. Obviously, for these primes the set
t1, 2, . . . , q{2u forms a large clique in ΓR. Moreover, Montgomery [Mon71, page 122] proved
that this result can, under generalized Riemann hypothesis, be improved to Ωplog N log log Nq.

On the other hand, it is easily seen from the method used by Green and Morris that

PpωpΓAq ą 10 log Nq ď 1{N 2.

It follows, by Borel-Cantelli lemma, that if we sample a random Cayley sum graph for each
prime N , the clique number of only boundedly many of them would be greater than 10 log N ,
which is in contrast to the result of Graham and Ringrose.

In this paper we introduce a diﬀerent random graph model for the Paley graph. We show
that this model usually gives the same clique number as in the random Cayley sum graphs,
but also has the phenomena present in the result of Graham and Ringrose.

To motivate the construction, notice that the multiplicative structure present in the set of
quadratic residues makes it relatively easy to have a large clique. For example, if we know
that all the primes up to, say, 100 are quadratic residues, then all the numbers 1, . . . , 100 are
also quadratic residues, and hence t1, . . . , 50u spans a clique.

This suggests the following model.

Deﬁnition 1. Let Q ě 1 be an integer. We deﬁne a random function f : Z{N Z Ñ t´1, 1u in
the following way. For every prime p P r1, Qs (here we embed Z{N Z inside Z in an obvious
way), we set fppq to be uniform ˘1 random variable, and we make all these random variables
independent. Next, we extend f to be completely multiplicative on r1, Qs. Finally, for each
x R r1, Qs we set fpxq to be again uniform ˘1 random variable, independently of all other
choices. We will say that f is a Q-multiplicative random function. Let Γf be the random
graph with vertex set Z{N Z and edges connecting x ‰ y if and only if fpx ` yq “ 1. We will
say that Γf is generated by f .

N˘
Of course, the intuition here is that f is a random model for the quadratic character` ¨

and thus the set tx P Z{nZ : fpxq “ 1u is a random model for the set of the quadratic residues
In Section 3 we will sketch why the decision to take values fppq (for small primes p)
R.
independently was sensible.

The majority of the paper will be devoted to proving that the clique number in our random

model is with high probability of the same size as in the random Cayley graph.

Theorem 2. There exists a positive constant c ă 1{2, such that for Q “ c log N log log N the
following holds. Let ǫ ą 0 and f be the Q-multiplicative random function. Then

Ppp2 ´ ǫq log N ď ωpΓfq ď p2 ` ǫq log Nq “ 1 ´ op1q.

We prove the upper and lower bounds from this theorem in Sections 4 and 5, respectively.

A RANDOM MODEL FOR THE PALEY GRAPH

Let R be a subset of the primes. We deﬁne its relative density in primes to be limM Ñ8

3

|RXr1,M s|

πpM q

(if the limit exists), where πpMq denotes, as usual, the number of primes up to M . As an easy
consequence of the previous theorem we will prove the following, which shows that although
there will be inﬁnitely many N for which the clique number is Ωplog N log log Nq, for most N
it will be about 2 log N .

Theorem 3. Let ǫ ą 0 and c ą 0 be a constant for which Theorem 2 holds. For each prime
N sample a random graph ΓpN q
, independently for each N . Then, almost surely, the clique
number ωpΓpN q
q will be at least Q{2 for inﬁnitely many primes N . However, for N lying in
a set of relative density in primes equal to 1, the clique number ωpΓpN q
q would be between
p2 ´ ǫq log N and p2 ` ǫq log N .

f

f

f

We give the proof of this theorem in the last section.

2. Notation

Xp`Y “ tx ` y : x P X, y P Y, x ‰ yu. We will use standard O-notation:

Although most of the notation was implicitly deﬁned in the introduction, we include it
here for the reader’s convenience. For sets X, Y Ă Z{N Z we will denote their sumset by
X ` Y , so X ` Y “ tx ` y : x P X, y P Y u. We will also consider their restriced sumset
if f, g are two
functions on positive integers we will write fpnq “ Opgpnqq and gpnq “ Ωpfpnqq if there exists
C ą 0 such that |fpnq| ď C|gpnq| for all large enough n. We will write fpnq “ Θpgpnqq if
there exist constants c, C ą 0 such that c|gpnq| ď |fpnq| ď C|gpnq| for all large enough n.
Additionally, fpnq “ opgpnqq means that fpnq{gpnq tends to 0 as n tends to inﬁnity. rA, Bs
will, depending on the context, denote the set of all integers n such that A ď n ď B, and its
image in Z{N Z. Finally, for an integrable function g : Z Ñ R and θ P r0, 1s, we deﬁne the
corresponding Fourier coeﬃcient by

Here, as usual, epψq “ e2πiψ.

ˆgpθq “ÿn

gpnqep´θnq.

3. Independence

The purpose of this section is to somehow formalize the intuition that p q

pq are independent
for diﬀerent primes q, which was the motivation for our model. We note that most of the
results from this section are already present in the literature (see e.g. [GS03, Proposition 9.1]),
although possibly in a slightly diﬀerent form.

Let x be an integer, and y an integer to be chosen later (one should think of y as being
substantially smaller than x). For each prime p ď x, let vppq be a vector of all p q
pq where q
runs over primes less than y (all instances of p and q in this section will denote primes). We

4

RUDI MRAZOVI ´C

deﬁne the counting function N by setting, for each s P t´1, 1uπpyq,

Npsq “ #tp ď x : vppq “ su.

Notice that this can also be expressed as

Npsq “ 2´πpyq ÿpďxźqďy´1 ` p q

pqsq¯ .

(3.1)

Our aim is to prove that VarsNpsq is small. Before doing that, we would like to mention
that if pvppqqpďx were independent random vectors, each uniformly distributed on t´1, 1uπpyq
(and hence each with independent coordinates), we would have
EvVarsNpsq “ Θp2´πpyqx{ log xq.

(3.2)

For comparison, this is much smaller than the theoretical maximum Op2´πpyqx2{plog xq2q.
Let Py “śqďy q. Notice that we can identify the characters on t´1, 1uπpyq with the set of
divisors of Py by assigning to each divisor m of Py the character s ÞÑśq|m sq.

By Parseval’s formula we have

(3.3)

(3.4)

pqsqq

Now, for ﬁxed m ‰ 1 from (3.1) we have

VarsNpsq “ EsNpsq2 ´ pEsNpsqq2 “ ÿ1‰m|Py
|pNpmq|2.
pqqźq∤m
Esqp1 ` p q

Esqpsq ` p q

sq “ 2´πpyq ÿpďxźq|m
p q
pq.

pNpmq “ EsNpsqźq|m
“ 2´πpyq ÿpďxźq|m

Assume for a moment that m is even. Notice that by the quadratic reciprocity and the

supplementary formula for p 2
¨ q we have
źq|m
p q
pq “ p´1q

p

2

´1

8 ź2‰q|m
p p
qqp´1q

p´1

2 p´1q

q´1
2 .

The conclusion is that there exists a primitive Dirichlet character χm of modulus at most 4m
such that the left-hand side is equal to χmppq or ´χmppq with, of course, the same choice of
˘ sign for all p. We may assume that it is the former, since we will only be interested in
bounding the absolute value of (3.4). The same conclusion follows for m odd.

The following proposition is quite standard and will be our main tool in bounding |pNpmq|.

A proof can be found in e.g. [MV07, Theorem 13.7].

Proposition 4. Let χ be a nonprincipal Dirichlet character of modulus r. Then, if General-
ized Riemann Hypothesis holds,

ˇˇˇˇˇÿpďx

χppqˇˇˇˇˇ ! x1{2 log rx.

A RANDOM MODEL FOR THE PALEY GRAPH

5

Using this and the well-known fact that Py “ eOpyq, we get from (3.4) that for m ‰ 1

Plugging this into (3.3) we get

|pNpmq| ! 2´πpyqx1{2plog x ` yq.
VarsNpsq ! 2´πpyqxpplog xq2 ` y2q.

For y “ c log x log log x this is comparable (within a power of log x) to the situation one has
in the random model described above (i.e. (3.2)).

We can now easily recover the conditional result of Montgomery [Mon71] mentioned in

Section 1.

Proposition 5. There exists a constant c and inﬁnitely many primes p such that the smallest
quadratic nonresidue modulo p is at least c log p log log p.

Proof. Let y “ c log x log log x, where c is a constant to be chosen later. Obviously, it is
enough to prove that for every large enough x there exists a prime p with desired properties
between x and 2x. Moreover, by multiplicativity it is enough to prove that p q
pq “ 1 for every
prime q ď y.

Using the same procedure as above, we can bound VarsN 1psq where

N 1psq “ #tx ă p ď 2x : vppq “ su.

We get

If, on the other hand, N 1pp1, . . . , 1qq “ 0, then

VarsN 1psq ! 2´πpyqxpplog xq2 ` y2q.

VarsN 1psq " 2´3πpyqx2{plog xq2.

However, these two bounds are incompatible if c is small enough.

(cid:3)

4. Proof of the upper bound

We now prove the upper bound from Theorem 2. Throughout this section we will work
with a ﬁxed value of ǫ ą 0, and consider the cardinality k “ p2 ` ǫq log N . Without loss of
generality we may assume that ǫ is suﬃciently small when needed.

We prove that with high probability there is no subset of Z{N Z with k elements which

spans a clique in Γf . Obviously, this is equivalent to proving that

P¨˝ ďA : |A|“k

tfpAp`Aq “ 1u˛‚“ op1q.

It is evident from the deﬁnition of the function f , that our argument would split into two
parts – one dealing with r1, Qs which is number-theoretical and the other dealing with its

6

RUDI MRAZOVI ´C

complement which is more additive-combinatorial. Roughly speaking, for each set A of size
k we will decide, using the following proposition, into which of these two cases it falls.

Proposition 6 (Trichotomy). Let L ě 1, Q “ L log N , δ ą 0 and A be a subset of Z{N Z of
size k. Then A must satisfy at least one the following possibilities:

(i) (type 1 set) |pAp`Aq X r1, Qs| ď δ|Ap`A|.
(ii) (type 2 set) There exists A1 Ă A such that |A1| ě p1´δq|A| and pA1p`A1qXr1, Qs “ H.
such that |C|,|D| ě δ5

(iii) (type 3 set) There exist sets C, D Ă A, each contained in an interval of size log N ,

6L4 log N and C ` D Ă r´Q, 2Qs.

In the proof of this proposition we will need the following well known result. For the proof

see the book by Tao and Vu [TV06].

Proposition 7 (Pl¨unnecke-Ruzsa). Let A Ă Z be a ﬁnite set such that |A ` A| ď K|A| for
some K ě 1. Then for all nonnegative integers m and n we have

|mA ´ nA| ď K m`n|A|.

We will also need the following result proven by Schoen [Sch02] which shows that we can

easily shift between sumsets and restricted sumsets.

Lemma 8. Let B be a subset of Z{N Z of size l. Then

Proof of Proposition 6. Suppose A is not a type 1 set. Then

|B ` B| “ p1 ` olÑ8p1qq|Bp`B|.

2δ|Ap`A| ď 2Q ď L|A|,

and so by Lemma 8 we have |A ` A| ď K|A| for K “ L{δ.

We now split Z{N Z into disjoint intervals, each of length log N (except possibly one).
First of all, we prove that only few of these intervals are hit by A. Denote this number by
h and choose points a1, . . . , ah P A, one from each of these h intervals. Notice that we can
choose at least
l) such that the distance
between any two of them is at least Q ` 1. Indeed, any translate of r´Q, Qs intersects at
most 2L ` 2 intervals, and hence eliminates at most this many points. Obviously, translates
a1
i ` pA ˆ`Aq X r1, Qs for i “ 1, . . . , l are all disjoint and hence

2L`2 of these points (we denote them by a1

1, . . . , a1

h

|A ` ppA ˆ`Aq X r1, Qsq| ě

h

2L ` 2 ¨ δ|A ˆ`A| ě

δh|A|
3L

.

On the other hand, using Proposition 7 (Pl¨unnecke-Ruzsa) we get

|A ` ppA ˆ`Aq X r1, Qsq| ď |A ` A ` A| ď K 3|A|.

Conclusion is that h ď 3K 3L{δ.

A RANDOM MODEL FOR THE PALEY GRAPH

7

Let β “ δ2

3K 3L . We call an interval good if it contains at least β log N elements from A. Let

A1 be the intersection of A with the union of all good intervals. Obviously,

|AzA1| ď h ¨ β log N ď δ|A|

r1, Qs ‰ H, then there exist two good intervals I1 and I2 such that

ppA X I1qp`pA X I2qq X r1, Qs ‰ H.

and hence A is a type 2 set if A1p`A1 is disjoint from r1, Qs. If, on the other hand, pA1p`A1q X
Let C 1 “ A X I1 and D1 “ A X I2; by the previous line we have C 1p`D1 Ă r´Q, 2Qs, and so
the only thing left to do to prove that A is a type 3 set is to replace the restricted sumset by
a genuine sumset. Without loss of generality, we may assume that |C 1| ď |D1|. Let C Ă C 1
be a set of |C 1|{2 elements, and let D Ă D1 be a set |D1|{2 elements, disjoint from C. Then
C ` D Ă C 1p`D1 and we can conlude that A is a type 3 set.

Our main tool for dealing with type 1 and type 2 sets is the following proposition, the proof

(cid:3)

of which occupies the majority of [GM15].

Theorem 9. For every m deﬁne

Then

Sm

k “ tA Ă Z{N Z : |A| “ k and |Ap`A| “ mu.

k | ď 2p1´ǫ3qm.
|Sm

We note that in the proof of this theorem diﬀerent strategies are used depending on the
size of m. [GM15] deals with the cases m “ Opkq and m “ Ωpk2q, whereas the claim for other
values of m was already proven in [Gre05].

We now shift the attention to our method for dealing with type 3 sets. The rough idea is
to ﬁrst prove that with high probability all of the Fourier coeﬃcients of (the restriction of)
function f will be quite small. On the other hand, we will show that the existence of sets C
and D as in the deﬁnition of type 3 sets, which additionally satisfy fpC ` Dq “ 1, implies
the existence of a large Fourier coeﬃcient, so we will be able to conclude that this is quite
unlikely to happen.

We will work with the function g : Z Ñ R deﬁned by

The following proposition covers the ﬁrst part of the strategy outlined above, namely that

it is unlikely that g has a large Fourier coeﬃcient.

Proposition 10. For any l ď Q we have

for ´ Q ď x ď 2Q,
otherwise.

fpx mod Nq
0

gpxq “$&%
Pˆ sup
0ďθď1|pgpθq| ě l˙ ď Q4`op1q{l5.

8

RUDI MRAZOVI ´C

Proof. Let ψ P r0, 1s. We have

E|pgpψq|4 “

ď

ÿ
ÿ

´Qďn1,n2,n3,n4ď2Q

´Qďn1,n2,n3,n4ď2Q

Egpn1qgpn2qgpn3qgpn4q ¨ eppn1 ` n2 ´ n3 ´ n4qψq

|Egpn1qgpn2qgpn3qgpn4q|

Notice that the expectation appearing in the sum would be 0 unless the product of those
nis that take values inside r1, Qs is a square, and no number outside this interval is equal to
the odd number of nis. We will call such quadruples bad. Obviously, there are OpQ2q bad
quadruples for which all ni are outside r1, Qs. At the other extreme, consider bad quadruples
for which all ni are inside r1, Qs. Their product is a square smaller than Q4, which we can
choose in Q2 ways. Additionally, by the divisor bound we can choose four of its divisors (that
is, nis) in at most Qop1q ways, giving in total Q2`op1q bad quadruples. The remaining case is
when two of the nis are equal to a number outside r1, Qs, and the product of the remaining
two is a square. In the same way as before, we can see that there are at most Q2`op1q such
bad quadruples. We can now conclude that

By Markov’s inequality this gives us

E|pgpψq|4 ď Q2`op1q.

Deﬁne

Pp|pgpψq| ě l{2q ď Q2`op1q{l4.

θj “ jl{80Q2,

for j “ 0, . . . , t80Q2{lu.

For any θ P r0, 1s there is j such that |θ ´ θj| ă l{80Q2. For such j we have

|eppθj ´ θqnq ´ 1| ď l{2,

where the last inequality follows from |epαq ´ 1| ď 2π|α| which holds for all real α.

From (4.1), (4.2), and the union bound we have

|pgpθjq ´pgpθq| ď ÿ´Qďnď2Q
Pˆ sup
0ďθď1 |pgpθq| ě l˙ ď Pˆmax

j

(4.1)

(4.2)

(cid:3)

and this is what we wanted to prove.

|pgpθjq| ě l{2˙ ď Q4`op1q{l5,

The following proposition covers the second part of our strategy, namely the existence of a
large Fourier coeﬃcient. The proof is quite standard, but the brevity of the argument allows
us to include it here for completeness.

Proposition 11. Let C and D be two sets of integers such that gpC ` Dq “ 1. Then

sup

0ďθď1|pgpθq| ě |C|1{2|D|1{2.

A RANDOM MODEL FOR THE PALEY GRAPH

9

Proof. From the given condition we have

gpxqż epθpx ´ c ´ dqq dθ

fpxq1x“c`d

|C||D| “ ÿ´Qďxď2QÿcPC ÿdPD
“ ÿ´Qďxď2QÿcPC ÿdPD
“ż pgpθqx1Cpθqx1Dpθq dθ
0ďθď1|pgpθq| ¨ż |x1Cpθq||x1Dpθq| dθ
0ďθď1|pgpθq| ¨ }x1C}L2pr0,1sq}x1D}L2pr0,1sq “ sup

ď sup

sup

0ďθď1|pgpθq| ¨ |C|1{2|D|1{2,

By using Cauchy-Schwarz inequality and Parseval’s identity we can bound this further by

and this gives the inequality from the statement.

(cid:3)

We now have all the tools needed and are in the position to start the proof.

Proof of the upper bound in Theorem 2. Set L “ Q{ log N , as in Proposition 6, and δ “ ǫ4.
As we mentioned before, our aim is to prove that with high probability ωpΓfq ă k “ p2 `
ǫq log N . Obviously, this is equivalent to proving that

P¨˝ ďA : |A|“k

tfpAp`Aq “ 1u˛‚“ op1q.

(4.3)

First of all, we apply Proposition 6 which shows that every set A of interest is of at least one
of the types 1, 2, and 3. Denote these families of sets by F1, F2, F3, respectively.

First we deal with type 1 sets which is quite easy. Indeed, using the notation introduced

in this section, we have

P˜ ďAPF1

tfpAp`Aq “ 1u¸ ď ÿAPF1
ď ÿměk´1

P`fpAp`Aq “ 1˘ ď ÿměk´1 ÿAPSm
k |2´p1´δqm ď ÿměk´1
|Sm

k XF1

P`fpAp`Aq “ 1˘

2´pǫ3´ǫ4qm “ op1q.

(4.4)

Here we used Theorem 9 to obtain the last inequality.

Let A now be a type 2 set. After possibly discarding some extra elements, we see that

there is a subset A1 Ă A of size k1 “ p1 ´ δqp2 ` ǫq log N ą p2 ` ǫ2q log N such that A1p`A1 is

10

RUDI MRAZOVI ´C

disjoint from r1, Qs. This implies that

P˜ ďAPF2

tfpAp`Aq “ 1u¸ ď P¨˝ ď|A1|“k1tfpA1p`A1q “ 1u˛‚ď ÿ|A1|“k1
P`fpAp`Aq “ 1˘ “ ÿměk1´1

P`fpA1p`A1q “ 1˘

k1 | ¨ 2´m
|Sm

“ ÿměk1´1 ÿAPSm
ď ÿměk´1

k1

2´ǫ6m “ op1q.

Finally, we deal with type 3 sets. For these the situation is somewhat trickier since one
can show that the expected number of type 3 sets that span a clique tends to inﬁnity. Thus,
the union bound (i.e. ﬁrst moment method) used for type 1 and 2 sets wouldn’t work.
Let A be a type 3 set. By the deﬁnition there are subsets C, D Ă A, each of size δ5

6L4 log N
such that C ` D Ă r´Q, 2Qs and both C and D are contained in intervals of size log N .
Because of the last property, after possible translations, we get two subsets of Z whose sumset
is contained in r´Q, 2Qs. We will abuse the notation and denote these sets by C and D as
well. By Proposition 11, we get

(4.5)

Indeed,

(4.6)

(cid:3)

However, by Proposition 10, we know that the probability of this is quite small.
taking l “ δ5

6L4 log N , we have

6L4 log N .

sup

0ďθď1 |pgpθq| ě δ5

From this we can ﬁnally conclude that

Pˆ sup
6L4 log N˙ ď L25{plog Nq1´op1q.
0ďθď1|pgpθq| ě δ5
tfpAp`Aq “ 1u¸ ď L25{plog Nq1´op1q “ op1q,
P˜ ďAPF3

for L “ c log log N . Combining (4.4), (4.5), and (4.6) we get (4.3).

5. Proof of the lower bound

In this section we prove the lower bound from Theorem 2. First of all, we would like to
point out that the same bound also holds for random Cayley sum graphs. Although we are
not aware of a proof of this fact in the literature, it is certainly a trivial consequence of the
much more diﬃcult result about the chromatic number by Green [Gre15]. In this section we
will give a proof for our model which works also, with few easy modiﬁcations, for the random
Cayley sum graph model.

We ﬁx k “ p2 ´ ǫq log N . Let U be the family of all sets A Ă rN{4, N{2s of size k such

2˘. Let R be the number of sets A P U such that fpAp`Aq “ 1. We will prove

that |Ap`A| “`k

A RANDOM MODEL FOR THE PALEY GRAPH

11

that with high probability R ě 1 which, of course, proves that with high probability there is
a clique of size k.

First we prove that almost all subsets of rN{4, N{2s of size k belong to U .

Lemma 12. |U| “ p1 ` op1qq`N {4
k ˘.

Proof. Let A Ă rN{4, N{2s be a random subset of size k. There are at most pN{4q3 quadruples
of diﬀerent elements x1, x2, x3, x4 P rN{4, N{2s such that x1 ` x2 “ x3 ` x4 and for each of
these the probability that it is included in A is Opk4{N 4q. By the union bound, probability
that A contains at least one such quadruple is Opk4{Nq “ op1q which is what we had to
prove.

(cid:3)

(5.1)

2˘, let Vl be the family of all

(5.2)

pk

pk

By the previous lemma we have
ER ě 1

2`N {4
k ˘2´pk

VarR “

2q ě 2k log N ´k2{2`opk2q.
We now focus on bounding the variance of R. For each l ď`k
pairs of sets A, B P Vl such that |pAp`Aq X pBp`Bq| “ l. We have
2qÿl“0 ÿpA,BqPVl
covp1f pAp`Aq“1, 1f pBp`Bq“1q
2qÿl“1
|Vl|PpfpAp`Aq “ 1, fpBp`Bq “ 1q
ď
“ 2´kpk´1q pk
2qÿl“1
A P U the set Ap`A is disjoint from r1, Qs.
possible B P U such that |pAp`Aq X pBp`Bq| “ l.
ˆs
2˙ ă l ďˆs ` 1
2 ˙.

Consider one such set. Let s be the unique integer such that

|Vl|2l.

Here the last equality holds because of our choice of family U which ensured that for every

The next step is to bound Vl. For each ﬁxed A P U we are going to bound the number of

following way.

We prove that we can order the elements of B and ﬁnd a subset B1 Ă B of s elements such
that for each b1 P B1 there is a smaller b P B such that b ` b1 P Ap`A. We can do this in the
Form a graph with vertex set B and edges joining b and b1 if b ` b1 P Ap`A. For each of

the connected components B1, . . . , Br of this graph, choose an element bi P Bi. Now take
an arbitrary order of elements of B which satisﬁes the sole condition that if b and b1 come
from the same component Bi, and distance from b to bi is less then distance from b1 to bi,
then b ă b1. One can easily construct this by ordering component by component. Obviously,

12

RUDI MRAZOVI ´C

b1, . . . , br are the only elements in this order that don’t satisfy the required condition. Given
that our graph has k vertices and at least l edges, the problem boils down to ﬁnding the
maximal possible number of connected components in such a graph. It is intuitively clear
(and one can easily show) that a maximizer for this optimization problem is a graph with
k ´ s connected components, all but one of which are singletons, and the remaining one
contains s` 1 vertices and l edges. In this graph, we can take B1 to be equal to the nontrivial
component, apart from the smallest element in it.

Using this observation, we make an enumerative argument as follows – we can choose set
A in at most pN{4qk ways, ordering in k! ways, positions in the order that would be occupied
by elements from B1 in ks ways, elements on positions outside B1 in pN{4qk´s and elements
from B1 in pk3qs ways (each element from B1 is uniquely determined by choosing one of at
most k2 possible sums from Ap`A and one of at most k predecessors from B). Putting all this
Since l ď`k

|Vl| ď pN{4qkk!kspN{4qk´spk3qs ď 2p2k´sq log N `opk2q.
2˘ we have s ď k ´ 1 and so
l ´ s log N ďˆs ` 1

2 ˙ ´ s log N ď p 1

2´ǫqk2 ` Opkq,

together we get

2 ´ 1

and these two bounds together with (5.2) give

VarR ď 22k log N ´p 1

2 ` 1

2´ǫ qk2`opk2q.

By Chebyshev’s inequality, (5.1) and (5.3) we now have

which is what we wanted to prove.

PpR “ 0q ď

VarR

pERq2 “ op1q,

(5.3)

(5.4)

6. Proof of Theorem 3

Theorem 3 is a straightforward consequence of Theorem 2 and the following strengthening

of Borel-Cantelli lemma. For the proof of it, see e.g. the book by Chung [Chu01, page 83]

Proposition 13 (Generalized second Borel-Cantelli lemma). Let pAnqně1 be a sequence of

independent events such thatřn PpAnq “ 8. Then PpAn happens for inﬁnitely many nq “ 1

and

lim

mÑ8 řm
n“1 1An
řm
n“1 PpAnq “ 1 almost surely.

Proof of Theorem 3. Notice that

PpωpΓpN q

f

q ě Q{2q ě Ppfpr1, Qsq “ 1q “ Ppfppq “ 1, for all primes p P r1, Qsq

“ 2´πpQq ě 1{N,

A RANDOM MODEL FOR THE PALEY GRAPH

13

where the last inequality follows from the prime number theorem and the assumption Q ď
log N log log N . The ﬁrst part of the claim from the proposition follows by Borel-Cantelli
lemma. To prove the second part, for each prime N let

Since we have proven that PpANq “ op1q, we obviously have that

f

q ą p2 ` ǫq log Nqu.

AN “ tωpΓpN q

f

q ă p2 ´ ǫq log N or ωpΓpN q
ÿN ďM,N prime

PpANq “ opπpMqq,

and the conclusion follows from Proposition 13.

(cid:3)

Acknowledgements. We would like to thank Ben Green for suggesting this project, Freddie
Manners for helpful discussions, and Kannan Soundararajan for giving a reference for some
of the results contained in Section 3. We would also like to thank Sean Eberhard for the idea
of ordering the elements of B when bounding VarR in Section 5.

References

[Chu01] Kai Lai Chung. A course in probability theory. Academic Press, Inc., San Diego, CA, third edition,

2001.

[Coh88] S. D. Cohen. Clique numbers of Paley graphs. Quaestiones Math., 11(2):225–231, 1988.
[GM15] B. Green and R. Morris. Counting sets with small sumset and applications. Combinatorica, 35(1),

2015.

[GR90] S. W. Graham and C. J. Ringrose. Lower bounds for least quadratic nonresidues. In Analytic number
theory (Allerton Park, IL, 1989), volume 85 of Progr. Math., pages 269–309. Birkh¨auser Boston,
Boston, MA, 1990.

[Gre05] B. Green. Counting sets with small sumset, and the clique number of random Cayley graphs. Com-

binatorica, 25(3):307–326, 2005.

[Gre15] Ben Green. On the chromatic number of random cayley graphs. Combin. Probab. Comput., to appear,

2015.

[GS03] Andrew Granville and K. Soundararajan. The distribution of values of lp1, χdq. Geom. Funct. Anal.,

13(5):992–1028, 2003.

[Mon71] Hugh L. Montgomery. Topics in multiplicative number theory. Lecture Notes in Mathematics, Vol.

227. Springer-Verlag, Berlin-New York, 1971.

[MV07] Hugh L. Montgomery and Robert C. Vaughan. Multiplicative number theory. I. Classical theory,
volume 97 of Cambridge Studies in Advanced Mathematics. Cambridge University Press, Cambridge,
2007.
T. Sanders. Personal communication.

[San]
[Sch02] T. Schoen. The cardinality of restricted sumsets. J. Number Theory, 96(1):48–54, 2002.
[TV06] T. Tao and V. Vu. Additive combinatorics, volume 105 of Cambridge Studies in Advanced Mathemat-

ics. Cambridge University Press, Cambridge, 2006.

Mathematical Institute, Andrew Wiles Building, Radcliffe Observatory Quarter, Wood-

stock Road, Oxford OX2 6GG

E-mail address: Rudi.Mrazovic@maths.ox.ac.uk

