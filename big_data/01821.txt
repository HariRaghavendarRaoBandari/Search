6
1
0
2

 
r
a

 

M
5
1

 
 
]
S
D
h
t
a
m

.

[
 
 

3
v
1
2
8
1
0

.

3
0
6
1
:
v
i
X
r
a

BLOWUP FOR FLAT SLOW MANIFOLDS WITH

APPLICATIONS TO REGULARIZATION OF PIECEWISE
SMOOTH SYSTEMS USING TANH AND A MODEL OF

AIRCRAFT GROUND DYNAMICS

K. U. KRISTIANSEN

Department of Applied Mathematics and Computer Science,

Technical University of Denmark,

2800 Kgs. Lyngby,

DK

Abstract. In this paper we demonstrate a method for extending the blowup
method, in the formulation of Krupa and Szmolyan, to ﬂat slow manifolds
that lose hyperbolicity beyond any algebraic order. Although these manifolds
have inﬁnite co-dimension, they do appear naturally in certain settings. For
example in (a) the regularization of piecewise smooth systems by tanh, (b) a
model of aircraft landing dynamics, and ﬁnally (c) in a model of earthquake
faulting. We demonstrate the approach on a simple model system and the
examples (a) and (b).

Contents

Introduction

1.
1.1. Overview
2. A method for ﬂat slow manifolds
2.1. Blowup
2.2. A ﬂat slow manifold
2.3. How to deal with ﬂat slow manifolds
2.4. Chart κ1
2.5. Conclusion
3. Regularization of PWS systems by tanh
3.1. Regularization: Slow-fast analysis
3.2. Geometry of regularization
3.3. Main result
3.4. Chart ¯ε = 1
3.5. Chart ¯y = 1
3.6. Chart κ1
3.7. Chart κ2
3.8. Chart κ3
4. A ﬂat slow manifold in a model for aircraft ground dynamics
4.1. Setup
4.2. Equations at inﬁnity
4.3. Main result
4.4. Chart κ1
4.5. Chart κ2

Date: March 17, 2016.

1

2
4
5
6
7
7
8
9
10
10
13
15
15
16
18
20
22
25
26
27
29
30
34

2

K. U. KRISTIANSEN

4.6. Final remarks
5. Conclusion
Acknowledgement
Appendix A. Proof of Theorem 3.3 using blowup
A.1. Chart κ1
A.2. Chart κ2
A.3. Scaling down
Appendix B. Proof of Theorem 3.4 by direction integration
References

1. Introduction

In this paper we focus on slow-fast systems on (x, y) ∈ Rns×nf of the form

x(cid:48) = εf (x, y, ε),
y(cid:48) = g(x, y, ε),

36
37
37
37
38
39
40
40
41

(1.1)

where ()(cid:48) = d
dτ denotes diﬀerentiation with respect to the fast time τ . System
(1.1) is called the fast system. Near points where g(x, y, ε) = O(1) the variables
x ∈ Rns and y ∈ Rnf vary on separate time scales for ε (cid:28) 1. The variable y is
therefore called fast, while x is said to be slow. On the other hand, near points
where g(x, y, ε) = O(ε) then the variables both evolve on the slow time scale t = ετ .
This is described by the slow system:

˙x = f (x, y, ε),

ε ˙y = g(x, y, ε),

(1.2)

with ˙() = d
systems: (1.1)ε=0:

dt . Setting ε = 0 in (1.1) and (1.2) gives rise to two diﬀerent limiting

x(cid:48) = 0,
y(cid:48) = g(x, y, 0),

called the layer problem, and (1.2)ε=0:

˙x = f (x, y, 0),

0 = g(x, y, 0),

called the reduced problem. The set

C = {(x, y)|g(x, y, 0) = 0},

(1.3)

(1.4)

(1.5)

is called the critical manifold. Eq. (1.4) is only deﬁned on the set C, while C is
a set of critical points of (1.3). Subsets S ⊂ C, where the linearization of (1.3)
about (x, y) ∈ S only has as many eigenvalues with zero real part as there are slow
variables ns, are called normally hyperbolic. Due to the special structure of (1.3)
normally hyperbolicity is equivalent to all eigenvalues λi, i = 1, . . . , nf , of ∂yg(x, y),
(x, y) ∈ S, satisfying Re λi (cid:54)= 0. A normally hyperbolic subset S of C can, by the
implicit function theorem applied to g(x, y) = 0 with ∂yg(x, y) (cid:54)= 0, be written as
a graph

S :

y = h0(x),

x ∈ U.

BLOWUP FOR FLAT SLOW MANIFOLDS

3

Fenichel’s geometric singular perturbation theory [9, 10] establishes for ε (cid:28) 1 (a)
the smooth perturbation of S in (1.5) with U compact to

Sε :

y = h0(x) + O(ε),

for ε (cid:28) 1, and (b) the existence and smoothness of stable and unstable manifolds of
Sε, tangent at (x, y) ∈ S for ε = 0 to the associated linear spaces of the linearization
of (1.3). As a consequence, the dynamics of (1.2), in a vicinity of a normally
hyperbolic critical manifold S, is accurately described for ε (cid:28) 1 as a concatenation
of orbits, respecting the direction of time, of the layer problem and the reduced
problem. For an extended introduction to the subject of slow-fast theory, the
reader is encouraged to consult the references [15, 16, 29].

Fenichel’s theory does not apply near singular points where C is nonhyperbolic.
To deal with such degeneracies, and extend the theory of geometric singular per-
turbations, the blowup method [5, 6, 7], in particular in the formulation of Krupa
and Szmolyan [25, 26, 27], have proven extremely useful. The method blows up
the singularity to a higher dimensional geometric object, such as a sphere or a
cylinder. By appropriately choosing weights associated to the transformation, it
is in most situations possible to divide the resulting vector-ﬁeld by a power of a
polar-like variable measuring the distance to the singularity. This gives rise to a
new vector-ﬁeld, only equivalent to the original one away from the singularity, for
which hyperbolicity has been (partially) gained on the blowup of the singularity.
Sometimes this approach of blowing up singularities has to be used successively, see
e.g. [1, 18]. In this paper we study situations where the blowup approach does not
apply directly.

In combination Fenichel’s geometric singular perturbation theory and the blowup
method have been very successful in describing global phenomena in slow-fast mod-
els. A frequent occurring phenomena in such models are relaxation oscillations,
characterized by repeated switching of slow and fast motions. A prototypical sys-
tem where these type of periodic orbits occur is the van Pol system [27, 29] but they
also appear in many other models, in particular in those arising from neuroscience
[14].

Recently more complicated examples of relaxation oscillations have been stud-
In [19], for example, the authors consider a
ied using these geometric methods.
model for the embryonic cell division cycle at the molecular level in eukaryotes.
This model is an example of a slow-fast system not in the standard form (1.1): The
slow-fast behaviour is in some sense hidden. Furthermore, the chemistry imposes
particular nonlinearities that give rise to special self-intersections of the set of crit-
ical points. Using the blowup method, the authors show that this in turn results in
a novel type of relaxation oscillation in which segments of the periodic orbit glue
close to the self-intersections of the critical set. In [17] another interesting oscil-
latory phenomenon is studied involving an unbounded critical manifold. Finally,
the reference [18] provides a detailed description of relaxation oscillations occurring
in a model describing glycolytic oscillations with two small singular parameters.
The references [17] and [18] both apply blowup methods. These examples illustrate
that each problem is unique; models have their own peculiar degeneracies, and a
unifying framework is not possible. Yet the blowup method provides a foundation
from which these systems can be dealt with rigorously. However, recently in [1],

4

K. U. KRISTIANSEN

the authors consider a model from [8]:

˙x = ez(x + (1 + α)z),
˙y = ez − 1,
ε ˙z = −e−z

(cid:18)

y +

x + z

ξ

(cid:19)

,

(1.6)

(using the variables introduced in [1, Eq. (1)]), describing earthquake faulting, for
which the blowup method, in its original formulation, fails. We will explain why in
the following.

The system (1.6) has a degenerate Hopf bifurcation at α = ξ, ε = 0 within an

everywhere attracting, but unbounded, critical manifold

y +

x + z

ξ

= 0.

(1.7)

A vertical family of periodic orbits emerges from this bifurcation for ε = 0. The
analysis of the perturbation of these periodic orbits is initially complicated by the
loss of compactness. Using Poincar´e compactiﬁcation, the authors study the critical
manifold at inﬁnity. There the critical manifold is shown to lose normal hyperbol-
icity. This is due to the fact that the non-trivial eigenvalue of the linearization
of (1.6)ε=0 about (1.7) decays exponentially as z → ∞. The blowup method re-
quires the homogeneity of algebraic terms to leading order, and this approach does
therefore not directly apply to the exponential loss of hyperbolicity that occurs in
this model. Applying the method presented in the present paper, the authors of [1]
nevertheless managed to obtain a new geometric insight into the peculiar relaxation
oscillations that occur in this model. In particular, a locally invariant manifold was
found, diﬀerent from the critical manifold of the system, and not directly visible
prior to blowup, which organizes the dynamics at inﬁnity. The basic idea of the
method in the present paper is to embed the system into a higher dimensional model
by augmenting a new dynamic variable in such a way that the resulting system is
algebraic to leading order at the degeneracy and therefore amendable to blowup.

Another example, where blowup does not apply (or seem to be useful), is a
slow-fast system undergoing a dynamic Hopf bifurcation. Similar problems occur
in Hamiltonian systems with fast oscillatory behaviour. Such systems are studied
in [11, 21, 20] using separate techniques. However, in the case of dynamic Hopf, it
is shown in [13] that blowup can be successfully applied when combined with the
technique, popularized by Neishtadt in [31, 32], of complex time. Similarly, the
blowup approach does not appear to help when applied directly to the problem of
bifurcation delay [35]. However, recently in [3], the authors showed that a transfor-
mation of the fast variable by a ﬂat function, can bring the system into a system
that is amendable to blowup.

1.1. Overview. In section 2 we present the general problem and illustrate our ap-
proach by considering an extension of a set of models considered by Kuehn in [28].
We do not aim to provide a general geometric framework for our approach. This
must be part of future research. Instead we will focus on successful applications of
our approach. In particular, in section 3 we apply the method to study regulariza-
tion of piecewise smooth (PWS) systems. PWS systems are of great signiﬁcance in
applications [4]; they occur in mechanics (friction, impact), in biology (genetic reg-
ulatory networks) and in variable structure systems in control engineering [37]. But

BLOWUP FOR FLAT SLOW MANIFOLDS

5

these systems also pose many problems, both computationally and mathematically.
A frequent approach is therefore to apply regularization. This has for example been
done in the references [22, 23, 24], to deal with problems associated with lack of
uniqueness in PWS systems, and in [34]. These references, however, exclude reg-
ularization functions such as tanh due its special asymptotic properties that leads
to loss of hyperbolicity at an exponential rate. We will in this paper demonstrate
how the approach of this paper can be used to study the regularization by tanh.

In section 4 we ﬁnally consider a model from [33] of aircraft ground dynamics.
The model is a 6D rigid body model but displays 2D slow-fast phenomena such as
a canard-like explosion of limit cycles. The authors of [33] do not investigate the
origin of the slow-fast structure but present the following 2D slow-fast model:

˙u = −ε(α − v),
˙v = −u − (v − a)evb.

(1.8)

see [33, Eqs. (7) and (8)], as a minimal model capturing the key features. Here
(u, v) describes the planar velocity of the center of mass of the aircraft in body ﬁxed
coordinates. See [33, Figs. (3) and (4)]. The critical manifold of this system loses
hyperbolicity beyond any algebraic order as v → −∞. We will apply the method
of this paper to describe the special canard explosion occurring in this model.

2. A method for flat slow manifolds

Kuehn in [28, Proposition 6.3] studies the following slow-fast system

˙u = εµ,
˙v = 1 − vnu,

(2.1)

with ε (cid:28) 1, µ (cid:54)= 0, (u, v) ∈ R2, and n ∈ N. Here we focus on v ≥ c > 0 and n ≥ 2.
In comparison with [28] we have also replaced x, y, s by v, u and n, respectively.
The set

Sa :

u = v−n,

v ≥ c > 0,

is an attracting critical manifold of (2.1). Indeed the linearization of (2.1) about
Sa gives −nvn−1u as a single non-trivial negative eigenvalue. By Fenichel’s theory,
ﬁxed compact subsets of Sa smoothly perturb into an attracting, locally invariant
slow manifolds Sa,ε. The reference [28] investigates how far as v → ∞ the manifold
Sa,ε can be extended as a perturbation of Sa. For this the author applies the change
of coordinates (u, v) = (x, y−1) to compactify v ≥ c. This gives

˙x = εµyn,
˙y = y2(x − yn),

(2.2)

after a nonlinear transformation of time that corresponds to multiplication of the
right hand side by yn. This desingularizes the dynamics within y = 0.
In the
(x, y)-variables, Sa becomes

Sa :

x = yn.

We continue to use the same symbol for Sa in the new (x, y)-variables. The manifold
Sa is nonhyperbolic at y = 0. This is due to the asymptotic alignment of the tangent
spaces T Sa for v → ∞ with the critical ﬁbers in the original (u, v)-variables. The

6

K. U. KRISTIANSEN

result [28, Proposition 6.3] then states that Sa,ε extends within x ≥ 0, y ≥ 0 as a
perturbation of Sa up until a neighborhood of (x, y) = 0 that scales like

(cid:16)O(εn/(n+1)),O(ε1/(n+1))
(cid:17)

(x, y) =

with respect to ε → 0.

,

(2.3)

2.1. Blowup. To prove (2.3), Kuehn, in [28], applies the following blowup trans-
formation

x = ¯rn ¯x,

y = ¯r¯y,

ε = ¯rn+1¯,

(¯r, (¯x, ¯y, ¯)) ∈ R+ × S2,

(2.4)

of (x, y, ε) = 0. Here

S2 = {(¯x, ¯y, ¯)|¯x2 + ¯y2 + ¯2 = 1}.

We introduce the blowup method by considering this example. Let B = R+ × S2
denote the blowup space. Then the blowup (2.4) can be viewed as a mapping:

blowing up the nonhyperbolic point

Φ : B → R3,

x = y = ε = 0,

to a sphere (¯x, ¯y, ¯) ∈ S2 within ¯r = 0. The map Φ transforms the vector-ﬁeld
X in (2.2) to a vector-ﬁeld X = Φ∗(X) on B by pull-back. Here X|¯r=0 = 0 but
the exponents, or weights, of ¯r in the blowup (2.13), n, 1 and n + 1, respectively,
have been chosen so that X has a power of ¯r, here ¯rn+1, as a common factor.
The vector-ﬁeld can therefore be desingularized through the division of ¯rn+1. In
particular, ˆX ≡ ¯r−(n+1)X is well-deﬁned and non-trivial ˆX|¯r=0 (cid:54)= 0. To described
the dynamics of ˆX on the blowup space we could use spherical coordinates to
describe S2. But as demonstrated in [25] the dynamics across the blowup sphere
varies signiﬁcantly in general and it is therefore almost mandatory to use directional
charts. For (2.4), the chart ¯y = 1, for example, can be used to describe the subset
B ∩{¯y > 0} of the blowup space. The corresponding coordinate change is obtained
by setting ¯y = 1 in (2.4):

(2.5)
using a stereographic-like projection to parametrize S2 ∩ {¯y > 0}. Here we use
subscripts to distinguish the variables in (2.5) from those appearing in (2.4).

y = r1,

1,

x = rn

1 x1,

ε = rn+1

1

Diﬀerent blowups and charts will appear during the manuscript. We will use
the same notation and often identical symbols for each blowup. Although this can
potentially lead to confusion we also believe that it stresses the standardization
of the method, emphasizing the similarities of the arguments and the geometric
constructions. Blowup variables are given a bar, such as (¯x, ¯y, ¯) in (2.4). Charts
such as (2.5) will be denoted by κi, using subscripts to distinguish between the
charts and the corresponding local coordinates. Similarly, we will use the (standard)
convention that manifolds, sets and other dynamical objects in chart κi are given
a subscript i. An object (set, manifold), say Mi obtained in chart κi, will in the
blowup variables be denoted by M . Finally, if Mi in chart κi is visible in chart κj
then it will be denoted by Mj in terms of the coordinates in this chart.

BLOWUP FOR FLAT SLOW MANIFOLDS

7

2.2. A ﬂat slow manifold. Now, we return to (2.2) and ask the following question:
What happens if we replace yn in (2.2) by e−y−1

? Then

and

˙x = εµe−y−1
˙y = y2(x − e−y−1

,

),

Sa :

x = e−y−1

,

(2.6)

(2.7)

re-deﬁning Sa again, is a critical manifold of (2.6). It is ﬂat as a graph over y at
y = 0 in the sense that all derivatives of the right hand side of (2.7) vanish at y = 0.
The linearization of (2.6) about Sa in (2.7) gives

−e−y−1

,

(2.8)

as a single non-trivial eigenvalue. Hence Sa is therefore attracting for y > 0 but
loses hyperbolicity at an exponential rate as y → 0+. Then, as outlined in the
introduction, the blowup method does not directly apply. The blowup method
requires homogeneity of the leading order terms to enable the desingularization,
and letting n → ∞ in (2.2) and (2.3) is clearly hopeless. We will in the following
demonstrate our approach by extending the slow manifold of (2.6) near y = 0.
Generalizations of the approach to more general examples of ﬂat functions, such as
yαe−y−β

with β > 0, are straightforward.

2.3. How to deal with ﬂat slow manifolds. The basic idea of our approach is
to augment the exponential:

q = e−y−1

,

(2.9)

which is also the negative of the eigenvalue (2.8), as a new dynamic variable. Dif-
ferentiating (2.9) gives

˙q = e−y−1

y−2 ˙y = e−y−1

(x − e−y−1

) = q(x − q),

using (2.6) in the second equality and (2.9) in the third. But then using (2.9) in
(2.6) we obtain an extended system

˙x = εµq,
˙y = y2(x − q),
˙q = q(x − q),
˙ε = 0,

(2.10)

on (x, y, q, ε) ∈ R× R3
+. Introducing q by (2.9) automatically embeds a hyperbolic-
center structure into the system: To illustrate this simple fact, suppose time is
so that y has algebraic, center-like decay as O(1/t) for t → ∞. Then q decays
hyperbolically as O(e−t). This construction will therefore enable the use of center
manifold theory and normal form methods to study systems like (2.6).

The set

Q :

q = e−y−1

,

(2.11)

8

K. U. KRISTIANSEN

is by construction an invariant set of (2.10). However, the invariance of Q is implicit
in (2.10) and we can invoke it when needed. Now Sa in (2.7) becomes

Sa :

x = q, ε = 0,

(2.12)

using the same symbol in the new variables (x, y, q, ε). This is a critical manifold
of the extended system (2.10) for ε = 0. The linearization now has −q as a single
non-trivial eigenvalue. The manifold Sa in (2.12) is nonhyperbolic at q = 0 but
now, again by construction, the loss of hyperbolicity is algebraic. We therefore
apply the following blowup transformation:

y = ¯y,

(¯y, ¯r, (¯x, ¯q, ¯)) ∈ R2

+ × S2,

ε = ¯r¯,

q = ¯r ¯q,

x = ¯r¯x,

(2.13)
of (x, q, ε) = 0. In this case the blowup transformation blows up the line y ≥ 0, x =
q = ε = 0 to a cylinder (¯y, (¯x, ¯q, ¯)) ∈ R+ × S2 and desingularization is obtained
In this section we shall only
through division of the resulting vector-ﬁeld by ¯r.
focus on the following entry chart

κ1 :

¯q = 1 :

(2.14)
with r1 ≥ 0, to cover S2 ∩ {¯q > 0} of the blowup sphere. Notice that y is not
transformed and we will therefore for simplicity continue to use this symbol in
chart κ1 (a convention we frequently follow).

x = r1x1, q = r1, ε = r11,

2.4. Chart κ1. Insertion of (2.14) into (2.10) gives

˙r1 = r1(x1 − 1),
˙x1 = (1 − x1)x1 + 1µ,
˙y = y2(x1 − 1),
˙1 = (1 − x1)1,

(2.15)

after division of the right hand side by r1. The set Q in (2.11) becomes

Q1 :

r1 = e−y−1

.

Remark 2.1. Notice that the r1-equation decouples in (2.15). This is possible in
the chart ¯q = 1 in all the models and settings that I have considered. Indeed, beyond
the leading order, one can just eliminate r1 using the invariance of Q1. For system
(2.10), this eﬀectually means that the dimension of the resulting system is the same
as the dimension of the chart ¯y = 1 associated with the blowup in (2.4) of (2.1).

Note that y = δ corresponds to

within Q1. Let

r1 = e−δ−1

,

ρ(δ) = e−δ−1

.

Then we consider the following set

U1 = {(r1, x1, y, 1)|r1 ∈ [0, ρ(δ)], 1 ∈ [0, ν], y ∈ [0, δ], x1 ∈ [0, ξ−1]},

with δ, ν and ξ all suﬃciently small.

The critical manifold Sa in (2.12) becomes

Sa,1 :

x1 = 1.

BLOWUP FOR FLAT SLOW MANIFOLDS

9

The advantage of the blowup is that we have gained hyperbolicity of Sa,1 at r1 =
1 = 0. Indeed, the linearization of (2.15) about a point with x1 = 1, r1 = 0, 1 = 0
gives −1 as a single non-zero eigenvalue. The associated eigenvector is purely in the
x1-direction. The center space is, on the other hand, spanned by two eigenvectors,
purely in the direction of r1 and y, respectively, and the eigenvector (0, 1, 0, µ−1).
By center manifold theory we therefore directly obtain the following:

Proposition 2.2. Within U1 there exists a center manifold

M1 :

x1 = 1 − 1µ(1 + O(1)).

M1 has invariant foliations by Q1 and
E1 :

ε = r11,

due to the conservation of ε. Furthermore, M1 contains Sa,1 within 1 = 0 as set
of equilibria and

C1 :

x1 = 1 − 1µ(1 + O(1)),

r1 = y = 0,

(2.16)

contained within r1 = y = 0, as a center sub-manifold. The sub-manifold C1 is
overﬂowing (inﬂowing) if µ > 0 (µ < 0).

This result can be viewed as an extension of [28, Lemma 5.4] to a ﬂat slow

manifold. In the following we present some conclusions from this result.

2.5. Conclusion. The center manifold M1 is foliated by two invariant sets Q1 and
E1. The intersection M1 ∩ Q1 ∩ E1 is the extension of Fenichel’s slow manifold,
being O(e−c/ε)-close to Sa,ε at r1 = ρ(δ). It intersects {1 = ν} with

x1 = 1 − νµ(1 + O(ν)),

e−y−1

= εν−1,

using the conservation of Q1 and E1. Blowing back down using (2.14) we realize
that we have extended the slow manifold as a center manifold up to

x = εν−1(1 − νµ(1 + O(ν)),
−1(ε−1ν)-close to C1 in (2.16).

y = ln

−1(ε−1ν),

where it is ln
perturbation of Sa up until a neighborhood of (x, y) = 0 that scales like

In other words, Sa,ε extends as a

(2.17)
Remark 2.3. It is interesting to note that letting n → ∞ formally in (2.3), de-
scribing the extension of Sa,ε for (2.2), gives

−1 ε−1)(cid:1) .
(x, y) =(cid:0)O(ε),O(ln
(x, y) =(cid:0)O(ε),O(ε0)(cid:1) .

To continue C1 across the blowup sphere one may consider the scaling chart

For system (2.10) this chart corresponds to

κ2 :

ε = 1.

y = y, x = r2x2, q = r2q2, ε = r2.

We will skip the details here for this introductory system and instead focus on
our two main examples: Regularization of PWS systems by tanh and a model of
aircraft ground dynamics, to be considered in the following sections. However, we
will here note that 1 = ν in chart ¯q = 1 in general, due to the conservation of ε,
corresponds to r1 = o(1) with respect to ε. In (2.10) we have r1 = ε/ν at ε = ν.
Therefore by the invariance of Q, we always have y = o(1) (logarithmically with

10

K. U. KRISTIANSEN

respect to ε as in (2.17)) in the scaling chart κ2 and this will eﬀectively enable the
decoupling of y in scaling chart.

3. Regularization of PWS systems by tanh

In this section we shall consider the following planar (x, y) PWS vector-ﬁeld

X = (X +, X−) with X + = (1, 2x) deﬁned on Σ+ : y > 0:

and X− = (0, 1) deﬁned on Σ− : y < 0:

˙x = 1,

˙y = 2x,

˙x = 0,

˙y = 1.

(3.1)

(3.2)

This system is a PWS normal form for the planar visible fold, see [12, Proposition
3.4].1 The discontinuity set

is called the switching manifold and T = (0, 0) ∈ Σ is a visible fold point since the
orbit y = x2 of X + has a quadratic tangency with Σ at T while X−(T ) (cid:54)= 0. The
point T ∈ Σ divides Σ into a (stable) sliding region

Σ :

y = 0,

and a crossing region

Σsl :

x < 0,

See Fig. 1. For p ∈ Σsl the vectors X±(p) are in opposition and to continue orbits
forward in time one has to deﬁne a vector-ﬁeld Xsl on Σsl. A natural choice is to
follow the Filippov convention and deﬁne the sliding vector-ﬁeld:

Σcr :

x > 0.

Xsl = λX + + (1 − λ)X−,

λ(x) =

X−
2 (x, 0)
2 (x, 0) − X +
X−

2 (x, 0)

,

(3.3)

which has a nice geometric interpretation illustrated in Fig. 2. For (3.1) and (3.2)
we have λ = 1

1−2x and

Xsl :

˙x =

1

1 − 2x

, ˙y = 0,

(x, y) ∈ Σsl.

(3.4)

This gives the PWS phase portrait illustrated in Fig. 1. Notice in particular that
all orbits that reach Σsl leave Σ at T following Xsl and {y = x2|x > 0}.
3.1. Regularization: Slow-fast analysis. In [34] the authors regularize the
PWS system X = (X +, X−), described by (3.1) and (3.2), through a Sotomayor
and Teixeira regularization:

1
2
See [36]. Here φ belongs to the following set C k
ST of functions:

X +(1 + φ(yε−1)) +

X−(1 − φ(yε−1).

Xε =

1
2

Deﬁnition 3.1. The set C k
φ satisfy:

ST of Sotomayor and Teixeira regularization functions

1In comparison with [12, Proposition 3.4] we have replaced their (x, y, t) by (2x, 2y, 2t).

BLOWUP FOR FLAT SLOW MANIFOLDS

11

Figure 1. PWS phase portrait of (3.2) and (3.1).

Figure 2. Illustration of the Filippov vector-ﬁeld (3.3).

1◦ Finite deformation:

φ(y) =

2◦ Monotonicity:



∈ (−1, 1)

1
−1

for

for

for

y ≥ 1,
y ∈ (−1, 1),
y ≤ −1,

(3.5)

φ(cid:48)(y) > 0 within y ∈ (−1, 1).

(3.6)
3◦ Finite C k-smoothness: φ ∈ C∞ within y ∈ (−1, 1) but there exists a small-

est k ≥ 1 so that φ(k+1) is discontinuous at y = ±1: φ(k+1)(±1∓) (cid:54)= 0.

12

K. U. KRISTIANSEN

An example of a C 1

ST regularization function within this class is the following

function

2 y3 + 3
2 y
±1

for
for

y ∈ (−1, 1),
y ≷ ±1.

φ(y) =

(3.7)
Here φ(1)(±1∓) = 0 but φ(2)(±1∓) = ∓3 (while φ(2)(±1±) = 0) and hence k = 1 in
3◦ of Deﬁnition 3.1 for this example. For simplicity, we restrict attention to k ≥ 1
and therefore exclude consideration of the following C 0-function:

(cid:26) − 1

(cid:26) y

±1

y ∈ (−1, 1),
y ≷ ±1.
Note that 1◦ excludes analytic functions such as tanh.

φ(y) =

for
for

In terms of (x, ˆy), where

ˆy = yε−1,

(3.8)

the system Xε is slow-fast, with x slow and ˆy fast. For Eqs. (3.1) and (3.2) we
have

˙x =

1
2

(1 + φ(ˆy)),

ε ˙ˆy = x(1 + φ(ˆy)) +

or in terms of the fast time τ = ε−1t:

ε
2

x(cid:48) =
(1 + φ(ˆy)),
ˆy(cid:48) = x(1 + φ(ˆy)) +

Hence the layer problem for this system is

x(cid:48) = 0,
ˆy(cid:48) = x(1 + φ(ˆy)) +

while

(1 − φ(ˆy)),

(1 − φ(ˆy)).

(1 − φ(ˆy)),

1
2

1
2

1
2

˙x =

1
2

(1 + φ(ˆy)),

0 = x(1 + φ(ˆy)) +

(1 − φ(ˆy)),

1
2

(3.9)

(3.10)

(3.11)

(3.12)

is the reduced problem.

The Filippov convention appears naturally in mechanics, but it also has the

following desirable property:

Theorem 3.2. [22, 30] The C k
ST -regularized system Xε possesses an attracting
critical manifold Sa for ε = 0 which is a graph over Σsl. The reduced equations for
the slow variable x coincides with Filippov’s sliding equations. The critical manifold
is nonhyperbolic at x = 0.

Proof. We demonstrate this result by considering our model system (3.9). The
critical manifold:

φ(ˆy) =

1 + 2x
1 − 2x

,

(3.13)

BLOWUP FOR FLAT SLOW MANIFOLDS

13

is only a graph over Σsl; within Σcr the expression on the right hand side becomes
≷ ±1. By linearizing (3.11) about (3.13) we realise that the manifold (3.13) is
attracting within Σsl but nonhyperbolic at x = 0 since φ(cid:48)(1) = 0 there, cf. 3◦ of
Deﬁnition 3.1.

The reduced equations for the slow variable then becomes

1
2

1

,

˙x =

1 − 2x

(1 + φ(ˆy)) =

using (3.13). This expression coincides with (3.4).

(3.14)
(cid:3)
The proof does not use 1◦ and k < ∞ in 3◦ of Deﬁnition 3.1. This result
therefore applies to a larger set of functions φ, including analytic functions such as
tanh, satisfying:

ˆy → ±∞.

φ(ˆy) ∈ [−1, 1], φ(cid:48)(ˆy) > 0 for ˆy ∈ (−1, 1), φ(ˆy) → ±1
By Fenichel’s theory, compact subsets of Sa perturb to slow invariant manifolds
Sa,ε for ε suﬃciently small. The ﬂow on Sa,ε converges to the ﬂow of the reduced
problem for ε → 0. The authors in [34] investigate, among other things, the in-
ST , 0 ≤ k < ∞. We ﬁnd
tersection of Sa,ε with a ﬁxed section {y = θ} for φ ∈ C k
it easier to study the intersection of Sa,ε with {x = θ} rather than {y = θ}, but
essentially the result of [34, Theorem 2.2] for k ≥ 1 is the following:
Theorem 3.3. Consider φ ∈ C n−1

(3.15)

for

Then the slow manifold Sa,ε intersects {x = θ} in (θ, yθ(ε)) with

(3.16)

ST , n ≥ 2. Let
r2 = ε1/(2n−1).
(cid:19)2/(2n−1)

(cid:18) 2

φ[n]

yθ(ε) = θ2 + ε − r2n

2

η(n)2(1 + r2F (r2)),

(3.17)

where

• F is smooth;
• φ[n] = (−1)n+1
• η(n) > 0 is a positive constant depending only on n.
√

φ(n)(1) > 0;

n!

√
y, α+ = −1/

Proof. This result is to order ε obtained by setting x+
y, in the
expression for Pε(x) in the second point of the itemize in [34, Theorem 2.2], and
(cid:3)
solving Pε(x) = θ for y.

0 =

The authors in [34] use asymptotic methods. We will in Appendix A demonstrate
an alternative proof using the blowup method which will give rise to the complete
expression in (3.17).

3.2. Geometry of regularization. In this paper we shall extend Theorem 3.3 to
the description of the intersection of Sa,ε with {x = θ} for the analytic regulariza-
tion function

φ(ˆy) = tanh(ˆy).

In terms of the application of slow-fast theory, this adds a signiﬁcant amount of
complexity since here φ(cid:48) > 0 for all ˆy ∈ R. This implies, in contrast to the case of
ST -functions, that the critical manifold loses hyperbolicity at inﬁnity ˆy → ∞. To
C k
handle this, it is useful to consider the scaling y = εˆy in (3.8) as part of a blowup:

y = π ¯y,

ε = π¯,

π ≥ 0, (¯y, ¯) ∈ S1

14

K. U. KRISTIANSEN

Figure 3. Singular slow-fast geometry for φ ∈ C k

ST .

Then y = εˆy becomes a chart

¯ε = 1 :

y = ˆπ ˆy, ε = ˆπ.

In the (x, ˆy)-system the layer problem has ˙x = 0 for ε = 0. The PWS system is
therefore not visible in this chart for ε = 0. To connect to the PWS system, one
can consider the two charts

¯y = ±1 :

y = ±ˆπ, ε = ˆπ ˆε.

to cover ¯y > 0 and ¯y < 0, respectively, of the sphere (¯y, ¯ε) ∈ S1. The advantage of
ST -functions is that the charts ¯y = ±1 are not needed. Indeed, if φ ∈ C k
the C k
then φ(ˆy) = ±1 for ˆy ≷ ±1 cf. 1◦ in Deﬁnition 3.1, whence

ST

Xε = X± for

y ≷ ±ε.

Therefore we can just scale back down and return to y (as it was done in [23]) when-
ever ˆy /∈ (−1, 1) (corresponding to y /∈ (−ε, ε) using (3.8)). This then leads to the
following interpretation of phase space in the case of C k
ST -functions: We continue
orbits of X± that reach y = ±ε, respectively, within ˆy ∈ (−1, 1) using (3.10). Once
an orbit of (3.10) reaches ˆy = ±1 again then this orbit can be continued using the
PWS vector-ﬁelds X± from y = ±ε, respectively. This also leads to a (singular)
description for ε = 0. Geometrically, it corresponds to blowing up the plane y = 0
to ˆy ∈ [−1, 1] for ε = 0. See Fig. 3. However, for regularization functions such
as tanh within the class (3.15), this construction is not possible and we need the
charts ¯y = ±1 to connect y = O(ε) with y = O(1). But furthermore, which is
relevant for our purposes, tanh(ˆy) is ﬂat for ˆy → ±∞. Indeed, let ˆy = ˆε−1. Then

tanh(ˆε−1) = 1 − 2e−2ˆε−1
1 + e−2ˆε−1 ,

(3.18)

with all derivatives at ˆε = 0 vanishing.

On the other hand, the system (3.9) with φ(ˆy) = tanh(ˆy) is in fact so simple that
it can be integrated directly (see Appendix B). This example therefore provides a

BLOWUP FOR FLAT SLOW MANIFOLDS

15

useful forum in which to introduce our geometric approach. Needless to say, our
method, relying only on hyperbolic methods and normal form theory, applies to
regularization by tanh of my complicated systems, such as nonlinear versions of
X± and PWS systems in higher dimensions.

3.3. Main result. Using the geometric methods developed in this paper we prove
the following:

Theorem 3.4. Consider the analytic regularization function φ(ˆy) = tanh(ˆy). Then
the slow manifold of (3.9) intersects {x = θ} in (θ, yθ(ε)) with

(cid:18) 1

(cid:16) π

ε−1(cid:17)

(cid:19)

√
+ R(

ε)

,

for some smooth function R(

yθ(ε) = θ2 + ε

ln

√

4

2
ε) = O(e−cε−1

).

Remark 3.5. We notice that the leading order correction in Theorem 3.4 for yθ(ε)
is O(ε ln ε−1) while the corresponding expression in Theorem 3.3, describing the
2 (cid:28) ε cf. (3.16)). Furthermore,
regularization by C n−1
we notice that the expression in Theorem 3.3 is a smooth function of ε and r2. In
comparison, the expression in Theorem 3.4 is only smooth as function of ε, ln ε−1
and

ST -functions, is O(ε) (since r2n

ε. Our approach identiﬁes the origin of these terms.

√

We prove Theorem 3.4 using our geometric approach in the following. First we
present the results of the slow-fast analysis in chart ¯ε = 1. Then we study the chart
¯y = 1 by introducing

ˆε = y−1ε = ˆy−1.

(3.19)

Due to (3.18) the critical manifold loses hyperbolicity at an exponential rate in this
chart. To deal with this loss of hyperbolicity we proceed as in section 2 and extend
the phase space dimension by introducing

q = e−2ˆε−1

,

(3.20)

as a new dynamic variable. We then blowup the singularity (q, ˆ, x) = 0 to a
sphere using a weighted blowup and study the slow manifold near this sphere using
desingularization and three diﬀerent directional charts. We illustrate the geometry
in Fig. 4. The blowup allows us to extend Sa (blue in Fig. 4) onto the blowup
sphere (green in Fig. 4) and connect Sa with the visible fold of the PWS system.
This in turn help us guide Fenichel’s slow manifold Sa,ε (red in Fig. 4) up until
the section {x = θ}. In Appendix B we show that the result in Theorem 3.4 is in
agreement with the result obtained by integrating the equations directly.

3.4. Chart ¯ε = 1. In this chart we obtain the equations in (3.9) with φ(ˆy) =
tanh(ˆy). For simplicity we eliminate time and consider the following system:

˙x = 1,

ε ˙ˆy = 2x +

1 − tanh(ˆy)
1 + tanh(ˆy)

= 2x + e−2ˆy.

(3.21)

In accordance with Theorem 3.2, this system possesses an attracting critical mani-
fold Sa as a graph over Σsl. By Fenichel’s theory compact subsets of this manifold
perturbs to an invariant slow manifold Sa,ε for ε suﬃciently small. A simple com-
putation shows the following:

16

K. U. KRISTIANSEN

Figure 4. Illustration of the geometry associated to the analysis
of Xε.

Lemma 3.6. For ε (cid:28) 1 the attracting slow manifold Sa,ε intersects {ˆy = ξ−1},
with ξ small but ﬁxed, in (xξ(ε), ξ−1) with
e−2ξ−1

(3.22)
Proof. The critical manifold intersects {y = ξ−1} in (xξ(0), ξ−1). Since Sa,ε is
O(ε)-smoothly-close to Sa the result follows from a simple computation.
(cid:3)
By (3.14) x increases on Sa and therefore also on Sa,ε for ε (cid:28) 1. We continue

xξ(ε) = − 1
2

+ O(ε2).

Sa,ε near ˆy = ∞ by considering the chart ¯y = 1 and (3.19).

e2ξ−1

ε
2

+

3.5. Chart ¯y = 1. Inserting (3.19) into (3.21) gives the following system of equa-
tions

˙x = ε,

(cid:16)
˙ˆε = −ˆε2(cid:16)

2x + e−2ˆε−1(cid:17)
2x + e−2ˆε−1(cid:17)

˙y = ε

,

(3.23)

,

after passing to the fast time. The critical manifold from chart ¯ε = 1 becomes

Setting ε = 0 in (3.23) gives a new layer problem:

x = − 1
2

e−2ˆε−1

.

˙x = 0,

˙y = 0,

˙ˆε = −ˆε2(cid:16)

2x + e−2ˆε−1(cid:17)

,

(3.24)

(3.25)

in which (3.24) becomes a set of ﬁx-points. In agreement with the analysis in chart
¯ε = 1 this set is attracting for x < 0 but it loses hyperbolicity at (x, y, ˆε) = (0, 0, 0)

BLOWUP FOR FLAT SLOW MANIFOLDS

17

at an exponential rate. Indeed, the linearization of (3.25) about (3.24) gives

−2e−2ˆε−1

,

as a single nontrivial eigenvalue.
We then introduce q = e−2ˆε−1

, as in (3.20), and consider the extended system:

˙x = ε,

˙y = ε(2x + q),
˙ˆε = −ˆε2(2x + q),
˙q = −2q(2x + q).

(3.26)

This system is obtained by diﬀerentiation of (3.20):

˙q = 2e−2ˆε−1

ˆε−2 ˙ˆε = 2q ˆε−2 ˙ˆε.

and using (3.20) in (3.23). The set

Q :

q = e−2ˆε−1

,

(3.27)

obtained from (3.20) is then by construction an invariant set of (3.26). However, it
is implicit in (3.26) and we will evoke this invariance only when needed.

The quarter-plane

y ≥ 0, ˆε ≥ 0, x = 0, q = 0, ε = 0,

(3.28)

is a set of nonhyperbolic critical points of (3.26). We therefore consider the following
blowup:

x = ¯r¯x, ε = ¯r2¯, q = ¯r ¯q,

(3.29)

leaving y and ˆε untouched. The blowup transformation (3.29) gives rise to a vector-
ﬁeld ¯X on

(y, ˆε, ¯r, (¯x, ¯, ¯q)) ∈ R3

+ × S2.

Here ¯X|¯r=0 = 0 but the weights of r in the blowup in (3.29) are chosen so that
ˆX ≡ ¯r−1 ¯X|¯r=0 is non-trivial. It is ˆX that we shall study in the following. We do
so by considering the following charts:

and

κ1 :

κ2 :

¯q = 1 :

¯ = 1 :

x = r1x1, ε = r2
x = r2x2, ε = r2

11, q = r1,
2, q = r2q2,

κ3 :

¯x = 1 :

x = r3, ε = r2

33, q = r3q3.

(3.30)

(3.31)

(3.32)

Notice that y and ˆε are not transformed by this blowup transformation and we
therefore keep (as promised) using these symbols in the diﬀerent charts. Geometri-
cally, the quarter-plane of critical points (3.28) is upon (3.29) blown up to a cylinder
+ × S2. In the following sections we analyze the diﬀerent charts κ1, κ2 and κ3.
R2

18

K. U. KRISTIANSEN

3.6. Chart κ1. Inserting (3.30) into (3.26) gives the following equations:

˙r1 = −2r1(2x1 + 1),
˙x1 = 1 + 2x1(2x1 + 1),
˙y = ε(2x1 + 1),
˙ˆε = −ˆε2(2x1 + 1),
˙1 = 41(2x1 + 1),

(3.33)

after desingularization through division of the right hand side by r1. Let

ρ(ξ) = e−2ξ−1

.

(3.34)

Then ˆε = ξ corresponds to r1 = ρ(ξ) cf. (3.20).

We consider the following set

(cid:26)

U1 =

(r1, x1, y, ˆε, 1)|r1 ∈ [0, ρ(ξ)], ˆε ∈ [0, ξ],

y ∈ [0, χ−1], x1 ∈ [−χ−1, χ−1]

,

(cid:27)

with ξ and χ positive but small and ﬁxed. The critical manifold Sa from above
becomes

Sa,1 :

x1 = − 1
2

,

y = 0, ˆε > 0.

The set (3.27) becomes

Q1 :

r1 = e−2ˆε−1

.

(3.35)

Since ε = r2

11 the system (3.33) possesses another invariant:

E1 :

ε = r2

11.

The advantage of the blowup method is that we have gained hyperbolicity of Sa,1
for r1 = 1 = 0. Indeed, we have the following:

Lemma 3.7. Within U1 there exists an attracting center manifold:

Ma,1 :

x1 = − 1
2

+

1
2

1(1 + O(1)).

The manifold Ma,1 contains Sa,1 within y = 0, 1 = 0 as a set of ﬁx points. The
center sub-manifold

C1 :

x1 = − 1
2

+

1
2

1(1 + O(1)), r1 = 0, y = 0, ˆε = 0.

is unique as a center manifold contained within r1 = 0, y = 0, ˆε = 0.
Proof. The linearization (3.33) about x1 = −1, r1 = 1 = 0 gives −2 as a single
non-trivial eigenvalue. The associated eigenvector, spanning the stable space, is
purely in the x1-direction. On the other hand, the 4D center space is spanned
by three eigenvectors, purely in the direction of r1, y and ˆε, respectively, and the
eigenvector (0, 1, 0, 0, 2). The result then follows from straightforward computa-
(cid:3)
tions. The manifold C1 is unique since it is overﬂowing.

BLOWUP FOR FLAT SLOW MANIFOLDS

19

Figure 5. The reduced ﬂow within Ma,1. The intersection of
Ma,1 with Q1 and E1 provides an extension of the Fenichel slow
manifold up to ˆε = O(ln

−1 ε−1).

Remark 3.8. The set Ma,1∩Q1∩E1 is O(e−c/ε)-close to Sa,ε at r1 = ρ(ξ). Notice
εν−1 within E1. Further restriction to Q1
also that 1 = ν corresponds to r1 =
gives ˆε = O(ln
−1 ε−1). The manifold Ma,1 ∩ Q1 ∩ E1 is therefore the continuation
Sa,ε,1 of Fenichel’s slow manifold Sa,ε up to ˆε = O(ln
−1 ε−1). We illustrate the
geometry in Fig. 5.

√

In this particular case, note that the expression for Ma,1 is in agreement with
(3.6) using (3.29). In fact, this expression can be taken to be independent of r1.
Since Ca,1 is unique this allows us to select a unique Ma,1 and therefore a unique
Sa,ε,1. We shall apply this selection henceforth.

On Ma,1 we obtain the following reduced problem

˙r1 = −2r1,
˙y = ε,
˙ˆε = −ˆε2,
˙1 = 41,

(3.36)

after division by 1(1 + O(1)). This division desingularizes the dynamics within
Sa,1, just as the passage to slow time desingularized the dynamics within the critical
manifold.

We describe (3.36) in the following lemma:

Lemma 3.9. Consider the reduced problem (3.36) on M1 and the mapping

P1 :

(y, ˆε, 1) (cid:55)→ (r+

1 , y+, ˆε+),

20

K. U. KRISTIANSEN

from {(r1, y, ˆε, 1)|r1 = ρ(ξ)} to {(r1, y, ˆε, 1)|1 = ν} obtained by the forward ﬂow.
Then

P1(εξ−1, ξ, ρ(ξ)−2ε) =

(3.37)

 √

1

εν−1
4 ε ln(νε−1)
−1(νε−1)
4 ln



In particular, the image P1(εξ−1, ξ, ρ(ξ)−2ε) converges to the intersection
ν(1 + O(ν)), 1 = ν,

C1 ∩ {1 = ν} :

r1 = 0, y = 0, ˆε = 0, x1 = − 1
2

as ε → 0.
Proof. From the r1- and the 1-equation we obtain a travel time of T = 1
Integrating the y-equation then gives

1
2

+

(3.38)

4 ln(cid:0)ρ2νε−1(cid:1).

(cid:18)

ln(cid:0)ρ2νε−1(cid:1)(cid:19)

.

y(T ) = εξ−1 + εT = ε

Using (3.34) this then simpliﬁes to

ξ−1 +

1
4

Finally, since ˆε = y−1ε we also obtain the ﬁnal component of P1 in (3.37).

ε ln(νε−1).

1
4

(cid:3)

We continue the point (3.37) forward in time by moving to chart κ2. The coor-
dinate change between κ1 and κ2 is easily obtained from (3.30) and (3.31). It is
given as

√

1,

√
x2 = x1/

1,

r2 = r1

√

q2 = 1/

valid for 1 > 0.

1,

(3.39)

(3.40)

3.7. Chart κ2. Inserting (3.31) into (3.26) gives

˙x2 = 1,
˙y = ε(2x2 + q2),
˙ˆε = −ˆε2(2x2 + q2),
˙q2 = −2q2(2x2 + q2),
˙r2 = 0,

after division by r2. In chart κ2 the point (3.37), using (3.39), becomes:

ε ln(νε−1), ˆε = 4 ln

−1(νε−1),

1
4

y =
x2 = ν−1/2

(cid:18)

(3.41)
ε. We will in this section guide (3.41) up until the section {x2 = η−1/2}
and r2 =
using the forward ﬂow of (3.40). For this we ﬁrst note that (3.38) within κ2 becomes

√

+

ν(1 + O(ν))

, q2 = ν−1/2,

− 1
2

1
2

(cid:19)

(cid:19)

x2 = ν−1/2

+ ν(1 + O(ν))

, q2 = ν−1/2,

(cid:18)

− 1
4

BLOWUP FOR FLAT SLOW MANIFOLDS

21

contained within r2 = 0, y = 0, ˆε = 0. We therefore consider r2 = 0, y = 0, ˆε = 0
and obtain the following system

= −2q2(2x2 + q2),

dq2
dx2

upon elimination of time. Integrating this ﬁrst order ODE, gives a solution

q2 = m2(x2) ≡

√

2e−2x2
√
2π(1 + erf (

2

,

2x2))

(3.42)

with

erf (u) =

2√
π

(cid:90) u

0

e−s2

ds,

which corresponds to C2 = κ21(C1). It intersects {x2 = η−1/2} in
r2 = 0, y = 0, ˆε = 0, x2 = η−1/2, q2 = m2(η−1/2).

(3.43)

Hence, we obtain
Proposition 3.10. The manifold M2 ≡ κ21(M1) intersects {x2 = η−1/2} with

(cid:32)

q2 = m2(η−1/2),
ε ln ε−1 + ε

y =

1
4

(cid:32)√

(cid:16)

(cid:16)(cid:112)

(cid:17)(cid:17)(cid:33)(cid:33)

(3.44)

.

(3.45)

η−1 +

1
2

ln

2π
2

1 + erf

2η−1

Proof. The expression (3.44) follows directly from (3.43) and the fact that (3.40)
is independent of r2. To obtain (3.45) we consider

dy
dx2

= ε(2x2 + m(x2)),

(3.46)

obtained by inserting (3.44) into (3.40) We can then integrate (3.46) from

x2 = x20 ≡ m−1
to x2 = η−1/2. For this we use the fact that

m2(x2)dx2 = ln(cid:0)1 + erf (

√

(cid:90)

where we in the last equality have used Eq. (3.42). Therefore

2 (ν−1/2),

2x2)(cid:1) − ln
(cid:32)

2√
2π

= ln

2

e−2x2
m2(x2)

,

e−2η−1
m2(η−1/2)

− ln

20

e−2x2
ν−1/2

(3.47)

(cid:33)

y =

=

1
4

1
4

ε ln(νε−1) + ε(η−1 − x2

ε ln ε−1 + εη−1 +

ε
2

ln

ln

20) +

ε
2
e−2η−1
m2(η−1/2)

,

using the initial condition from (3.41) and the second equation in (3.47). Using
(cid:3)
(3.42) we then obtain the expression in (3.45).

Remark 3.11. In a more general setting where Ma,2 is not independent of r2, then
one would have to apply regular perturbation theory in this chart. This would give
rise to O(r2)-terms in (3.44) and (3.45).

22

K. U. KRISTIANSEN

Figure 6. The dynamics within chart κ2.

We illustrate the dynamics in Fig. 6. Finally, we move to chart κ3. Cf. (3.31)

and (3.32) the coordinate change between the charts κ2 and κ3 is given as

q3 = x−1

2 q2,

r3 = r2x2,

3 = x−2
2 ,

valid for x2 > 0.

3.8. Chart κ3. Inserting (3.31) into (3.26) gives

˙r3 = r33,
˙y = ε (2 + q3) ,
˙ˆε = −ˆε2 (2 + q3) ,
˙q3 = −2q3 (2(2 + q3) + 3) ,
˙3 = −22
3,

(3.48)

(3.49)

after desingularization through division of the right hand side by r3. We consider
the following set:

(cid:26)

U3 =

(r3, y, ˆε, q3, 3)|r3 ∈ [0, θ], y ∈ [0, θ−1],

(cid:27)

ˆε ∈ [0, ξ], 3 ∈ [0, η]

.

The point (3.43) becomes

r3 = 0, y = 0, ˆε = 0, q3 = η1/2m2(η−1/2), 3 = η,

(3.50)

using the coordinate transformation in (3.48). The set

N3 :

q3 = 0,

is an attracting (but inﬂowing and non-unique) center manifold of (3.49). We use
Fenichel’s normal form to straighten out the stable ﬁbers:

BLOWUP FOR FLAT SLOW MANIFOLDS

23

Proposition 3.12. For ε suﬃciently small, there exists a smooth transformation
(r3, y, 3) (cid:55)→ (r3, ˜y, 3) within U3:

y = ˜y + ε

ln

1 +

S3(3)

,

(3.51)

(cid:18)

− 1
2

(cid:18)

(cid:16)

q3
2

(cid:18)(cid:113)

(cid:17)(cid:19)
(cid:19)(cid:19)

2π−1

3 e2

−1
3

1 − erf

2−1

3

= 1 + O(3),

with

S3(3) =

(cid:113)

(3.52)

(3.53)

transforming (3.49) into:

˙r3 = r33,
˙˜y = 2ε,
˙ˆε = −2ˆε2,
˙q3 = −2q3 (2(2 + q3) + 3) ,
˙3 = −22
3.

Proof. The existence of the transformation follows from Fenichel’s normal form [15].
The expression in (3.51) follows by considering the r3 = 0 system:

˙y = ε(2 + q3),
˙q3 = −q3(2(2 + q3) + 3),
˙3 = −22
3,

and applying a transformation y = ˜y + εW (q3, 3) with W having the property that

This gives rise to the following equation for W (q3, 3)

˙˜y = 2ε.

Using the method of characteristic we obtain a solution

q3 = ∂q3W ˙q3 + ∂3W ˙3.

(cid:16)

W = − 1
2

ln

1 +

q3
2

(cid:17)

S3(3)

,

(3.54)

with S3 as in (3.52). The smoothness of S3 and the expansion in (3.52) follows
from the following asymptotics of erf (u) for u → ∞:

erf (u) = 1 − e−u2√

πu

(cid:0)1 + O(u−2)(cid:1) .

(cid:3)

(cid:19)

.

S3(x−2
2 )

Using (3.48) we can write (3.54) as

(cid:18)

W = − 1
2

ln

1 +

(cid:32)

x−1
2 q2
2

(cid:33)

In particular for q2 = m2(x2) with m2 as in (3.42)
= − 1
2

√
1 − erf (
√
1 + erf (

W = − 1
2

2x2)
2x2)

1 +

ln

ln

√
erf (

2
2x2) + 1

.

24

K. U. KRISTIANSEN

Therefore (3.45) becomes

˜y =

+

=

1
4

1
2

1
4

in terms of ˜y.

ε ln ε−1 + ε

η−1 +

1 + erf ((cid:112)2η−1)

2

ln

ln

1
2

(cid:19)

ε ln ε−1 + ε

η−1 +

1
4

(cid:18)

(cid:18)

(cid:33)

(cid:112)

2η−1))

(1 + erf (

(cid:32)√

2π
2

(cid:19)

ln(2π)

,

(3.55)

Lemma 3.13. Consider the reduced problem (3.53)q3=0 on N3 and the mapping

P3 :

(r3, ˜y, ˆε) (cid:55)→ (˜y+, ˆε+, +
3 )

from {(r3, ˜y, ˆε, 3)|3 = η} to {(r3, ˜y, ˆε, 3)|r3 = θ} obtained by the forward ﬂow.
Then

(cid:112)

P3(

εη−1, ˜y, ˜y−1ε) =

 ˜y + θ2 − εη−1

(˜y + θ2 − εη−1)−1ε



εθ−2

Proof. To solve (3.53) we initially decouple the ˆε-equation and consider

˙r3 = 2r3,

3 = 2r3 ˙r3 =

˙˜y = 4r2
˙3 = −43,

dr2
3
dt

,

obtained using ε = r2
initial conditions:

33 and division of the right hand side by 1

2 3. Then with

(cid:112)

r3(0) =

εη−1, 3(0) = η,

and r3(T ) = θ, 3(T ) = εθ−2 we obtain a travel time of T = 1
Therefore

2 ln

˜y(T ) = ˜y(0) + r3(T )2 − r3(0)2 = y(0) + θ2 − εη−1,

which completes the proof.

(cid:16)

√

θ

νε−1

(cid:17)

.

(cid:3)

Finally, applying P3 to the initial condition (3.55) we conclude using (3.51) and

q3(T ) = O(e−c/ε) that the slow manifold intersects {r3 = θ} with

(cid:18) 1
ε−1(cid:17)

4

ε ln ε−1 + ε

y = θ2 +

1
4

= θ2 + ε

(cid:18) 1

4

(cid:16) π

2

ln

ln

π
2

(cid:19)

+ R(
√

+ R(

ε)

,

(cid:19)

√

ε)

√
where R(
completes the proof of Theorem 3.4.

ε) = O(e−cε−1

) is smooth. We illustrate the geometry in Fig. 7. This

BLOWUP FOR FLAT SLOW MANIFOLDS

25

Figure 7. The dynamics within chart κ3.

4. A flat slow manifold in a model for aircraft ground dynamics

In this section we consider the system (1.8), repeated here for convinience:

˙u = ε(α − v),
˙v = u + (v − a)evb,

(4.1)

with parameters a and b ﬁxed and use α as a bifurcation parameter. In comparison
with [33] we have replaced b by b−1. The system (4.1) possesses a critical manifold
which is a graph over the fast variable v:

C = {(u, v)|u = (a − v)evb}.

Linearization (4.1) about C for ε = 0 gives

− (b(v − a) − 1) evb,

(4.2)

as a single non-trivial eigenvalue. The manifold C therefore splits into an attracting
critical manifold:2

ˆS = C ∩ {v > a − b−1},

a fold point:

with

F = (uf , vf ),

uf = b−1e(a−b−1)b,

vf = a − b−1,

and a repelling critical manifold:

S = C ∩ {v < a − b−1},

2Here we do not use Sa and Sr for attracting and repelling critical manifolds because we ﬁnd

that this becomes confusing when we later reverse the direction of time.

26

K. U. KRISTIANSEN

Figure 8. Diﬀerent limit cycles: without head, with head and
relaxation-type oscillations, near the canard explosion for a = b =
1, ε = 10−3 and α ≈ −10−3.

Compact subsets of ˆS and S perturb by Fenichel’s theory to ˆSε and Sε. The
system undergoes a Hopf bifurcation near the fold F at a parameter value α =
αH ≡ a − b−1 + O(ε) which leads to the a canard explosion phenomenon near the
canard value αc ≡ a−b−1 +O(ε) where the limit cycles born in the Hopf bifurcation
undergoes O(1)-changes within parameter regime of width O(e−c/ε), c > 0. See
[27]. Examples of limit cycles computed using AUTO are shown in Fig. 8 near
αc ≈ −10−3 for a = b = 1 and ε = 10−3. The small limit cycles, following the
repelling manifold Sε before jumping directly towards the attracting manifold ˆSε,
are frequently called canard cycles without head. Similarly, the canard cycles that
leave Sε on the other side, escaping towards inﬁnity v → −∞ before returning
to ˆSε, are said to be with head. Eventually the canard cycles become relaxation
oscillations that escape directly towards inﬁnity v → −∞ at the fold F . Note how
trajectories cross S for v (cid:28) 0. This is due to the fact that S loses hyperbolicity
at inﬁnity v → −∞. Similar transition to relaxation oscillations occur in [2, Fig.
4] and [17], but in (4.1) the loss of hyperbolicity occurs at an exponential rate
O(evb). Therefore the classical theory of canard explosion [27] does not describe
the transition from canard cycles without head to those with head. The aim of this
section is to apply our approach to (4.1) and obtain a description of this transition
that in turn establishes the existence of large canard cycles.

4.1. Setup. To obtain large amplitude limit cycles near the canard value, we pro-
ceed as in the classical analysis [27], and consider two sections at v = vf :

Γ = {(u, v)|u ∈ [−c−1, c−1], v = vf},
Λ = {(u, v)|u ∈ [−c−1 + uf , c−1 + uf ], v = vf},

(4.4)
for c suﬃciently small. See Fig. 9. Let (u, v) ∈ Γ and consider the forward orbit

(4.3)

BLOWUP FOR FLAT SLOW MANIFOLDS

27

Figure 9. Illustration of the critical manifold C = M ∪ {F} ∪ S
and the two sections Γ and Λ.

γε(u, α) and backward orbit ˆγε(u, α). Denote their intersection with Λ by dε(u, α)
and ˆdε(u, α), respectively. For u ≥ ¯c−1 > 0, with ¯c > c ﬁxed but large, the standard
theory applies. Indeed, by the transverse intersection of (ﬁxed copies of) ˆSε and
Sε at α = αc it is possible to solve dε(u, α) = ˆdε(u, α) for α = αc + O(e−c/ε) by
the implicit function theorem. This argument fails near u = 0 due to the loss of
hyperbolicity of S at u = 0. Geometrically, the loss of hyperbolicity, as in the
models (2.1) considered by Kuehn in [28], is due to the asymptotic alignment for
v → −∞ of the tangent spaces T S with the critical ﬁbers.
In the following we
will study S using our methods and describe the limit cycles that intersect Γ with
u ≈ 0. For this we reverse time so that S becomes attracting and consider the
equations:

(4.5)

˙u = ε(α − v),
˙v = u + (v − a)evb.

x = −uv−1,

y = −v−1,

4.2. Equations at inﬁnity. To deal with loss of hyperbolicity for v → −∞ we
introduce the following chart:

(4.6)
based upon Poincar´e compactiﬁcation. Then y = 0+ corresponds to v = −∞.
It is convenient if the fold F is visible in this chart (4.6) and we shall therefore
henceforth assume that

vf = a − b−1 < 0.

28

K. U. KRISTIANSEN

Figure 10. The limit cycles from Fig. 8 in the (x, y)-variables.

This allows us to only work in the (x, y)-variables. Using (4.5) and (4.6) we obtain
the following equations:

(cid:16)

x − (1 + ay)e−y−1b(cid:17)

˙x = ε(1 + αy) + x

,

(4.7)

(cid:16)

x − (1 + ay)e−y−1b(cid:17)

.

˙y = y

The critical manifold S from above becomes

S :

x = (1 + ay)e−y−1b,

y ∈ (0, yf )

in the (x, y)-variables while the fold F becomes

F = (xf , yf ).

f , yf = −v−1

Here xf = −uf v−1
f . The manifold ˆS is only partially visible (v < 0
only) in the (x, y)-variables. We will continue to denote ˆS, S and F by the same
symbols in the new variables (x, y). The set S is still a set of critical points of
(4.7)ε=0. But opposed to (4.5), where the ﬁbers were vertical: Fu0 = {(u0, v)|v ∈
R} for ε = 0, the singular ﬁbers are now tilted:

Fu0 = {(x, y)|x = u0y},

with respect to the (x, y)-variables. See also Fig. 10 where segments of the limit
cycles in Fig. 8 are illustrated in the (x, y)-variables.

The ﬁbers to the left of S all emanate from the unstable ﬁbers of ˆS. Note again
that S loses hyperbolicity at y = 0 at an exponentially rate since the linearization
of (4.7)ε=0 about S yields

−y−1be−y−1b(1 + (a − b−1)y),

as a single non-trivial eigenvalue.

BLOWUP FOR FLAT SLOW MANIFOLDS

29

The section Γ in (4.3) becomes

Γ = {(x, y)|x ∈ [−ν, ν], y = yf},

f , in the new variables. We again use the same symbol for this

with ν = −c−1v−1
section.
4.3. Main result. By Fenichel’s theory, the slow manifold Sε intersects {y = δ}
in (xδ(ε), δ) with

xδ(ε) ≡ (1 + aδ)e−δ−1b + O(ε),

with δ < yf . We consider the following section

Σ = {(x, y)|x ∈ [xδ(ε) − ν, xδ(ε) + ν], y = δ},

together with the following mapping

Pε :

Γ → Σ,

obtained by the forward ﬂow of (4.7). We will then prove the following:

Theorem 4.1. Fix ν suﬃciently small. Then for ε suﬃciently small, the mapping
Pε is a strong contraction, satisfying the following estimates

Pε(x) = xδ(ε) + O(e−c/ε), P (cid:48)

ε(x) = O(e−c/ε).

We will focus on the details of subsets of Γ with x = o(1) with respect to ε. For

this we proceed as described in section 2 by introducing the following function

as a new dynamic variable and consider the extended system:

q = (1 + ay)e−y−1b,

˙x = y (ε(1 + αy) + x (x − q)) ,
˙y = y2 (x − q) ,
˙q = q (x − q)

(cid:18)

(cid:19)

b +

(4.8)

(4.9)

ay2

1 + ay

.

This system is obtained by diﬀerentiating (4.8) with respect to time and using (4.7)
and (4.8) to eliminate the exponential e−y−1b. We have also multiplied the right
hand side by y. This corresponds to a nonlinear transformation of time for y > 0
which de-singularizes the system for y = 0. The set

Q :

q = (1 + ay)e−y−1b,

(4.10)

obtained from (4.8) is by construction an invariant set of (4.9). Again it is implicit
in (4.9) and we can invoke it when needed. We could also have set q = e−y−1b,
the analysis would be almost identical. However, some of the resulting expressions
simplify using (4.8). In particular, S just reads:

S :

x = q.

(4.11)

The set S in (4.11) is a set of critical points of (4.9)ε=0. It is nonhyperbolic for
x = q = 0, but now the system is algebraic to leading order. To deal with this loss
of hyperbolicity we may therefore consider the following blowup:
r ≥ 0, (¯q, ¯x, ¯) ∈ S2,

q = r ¯q, x = r¯x, ε = r2¯,

(4.12)

30

K. U. KRISTIANSEN

together with the following charts:

κ1 :

κ2 :

¯q = 1 :

¯ = 1 :

q = r1, x = r1x1, ε = r2
11,
q = r2q2, x = r2x2, ε = r2
2.

Notice that y is not part of the transformation (4.12) so geometrically x = q = ε = 0
is blown-up to a cylinder of spheres: (y, (¯q, ¯x, ¯)) ∈ R+ × S2.

4.4. Chart κ1. In this chart we obtain the following equations from (4.9)

(cid:19)

ay2

1 + ay
ay2

,

(cid:19)

− y

˙r1 = −r1(1 − x1)

b +

˙x1 = x1(1 − x1)
˙y = −y2(1 − x1),
˙1 = 21(1 − x1)

b +

(cid:19)

1 + ay

ay2

1 + ay

,

b +

(cid:18)
(cid:18)
(cid:18)

(4.13)

+ y1(1 + αy),

after division by r1. In this chart the invariant set Q in (4.10) becomes:

Q1 :

r1 = (1 + ay)e−y−1b.

The hyperbolas

are also invariant. We consider the following set:

E1 :

ε = r2

11,

(cid:26)

U1 =

(r1, x1, y, 1)|1 ∈ [0, µ−1],

x1 ∈ [−ξ−1, ξ−1],
r1 ∈ [0, ρ(δ)],
y ∈ [0, δ]

(cid:27)

,

with µ, ξ and δ small but ﬁxed with respect to ε. As always, the two planes {1 = 0}
and {r1 = 0} are invariant. Within the former we re-discover S from (4.11) as

Using the blowup we have gained hyperbolicity of S. We have:

S1 :

x1 = 1, r1 = 0.

Proposition 4.2. For δ suﬃciently small, the following holds: Within U1 there
exists a center manifold:

x1 = 1 + m1(y, 1), m1(y, 1) ≡ 1y(cid:0)b−1 + O(y)(cid:1) ,

(4.14)

M1 :

which is foliated by the invariant sets E1 and Q1. The manifold M1 contains S1
and

as manifolds of equilibria within 1 = 0 and r1 = y = 0, respectively.

C1 :

x1 = 1, r1 = 0, y = 0,

BLOWUP FOR FLAT SLOW MANIFOLDS

31

Proof. The set {U1|x1 = 1, y = 0} is a set of equilibria. The linearization about a
point in this set gives three zero eigenvalues and one non-zero λ = −b with associ-
ated eigenvector (−r1, 1, 0, 21). The 3D center space is spanned by two eigenvec-
tors, purely in the r1 and 1-direction, respectively, and a generalized eigenvector
(cid:3)
(0, 1, b, 0). The result then follows from standard center manifold theory.

Remark 4.3. Note here that the center manifold in chart κ1 is only truly local in
y. In U1 we may take 1 large (but ﬁxed with respect to ε). Notice also that

M1 ∩ E1 ∩ Q1,

by Fenichel’s theory, is O(e−c/ε)-close to Sε at r1 = ρ(δ). We shall therefore view
M1 ∩ E1 ∩ Q1as the continuation of Fenichel’s slow manifold Sε into chart κ1 by
the backward ﬂow.

On M1 we obtain the following reduced system

(cid:19)−1

ay2

1 + ay

(cid:18)
(cid:17)

˙r1 = r1,

(cid:16)

˙y = y2
b +
˙1 = −21,
b + ay2
1+ay

(4.15)

,

= 1y(cid:0)b2 + O(y)(cid:1) which desingularizes the

after division of m1(y, 1)
ﬂow within 1 = 0 and y = 0.

The system (4.13) also has a 1D center manifold

D1 :

r1 = 0, x1 = 0, 1 = 0,

within U1, which emanates from the equilibrium:

r1 = 0, x1 = 0, y = 0, 1 = 0.

(4.16)

Indeed the linearization about (4.16) yields the following eigensolutions (λi, vi)

λ1 = −b, v1 = (1, 0, 0, 0),
λ2 = b, v2 = (0, 1, 0, 0),
λ3 = 0, v3 = (0, 0, 1, 0),
λ4 = 2b, v4 = (0, 0, 0, 1).

Each eigenvector vi spans an invariant set. In particular, W s
loc(0) = span v1 and
D1 = span v3. We illustrate the dynamics within Q1 in Fig. 11 using a projection
onto the (y, x1, 1)-space.

The following proposition describes the set of initial conditions close to the stable

manifold of D1.

Proposition 4.4. Consider the following interval of x1-values:

√

√

X = [−ξ

ε ln ε−1, ξ

ε ln ε−1].

Then for ε suﬃciently small the following holds: The mapping from
Λ1 ≡ {U1|r1 = ρ(δ), x1 ∈ X, y = δ, 1 = ερ(δ)−2},

to

Γ1 ≡ {U1|x1 ∈ [−c, c], 1 = µ−1},

32

K. U. KRISTIANSEN

Figure 11. The dynamics within Q1 in κ1 using a projection onto
the (y, x1, 1)-space.

with c suﬃciently large, obtained by the forward ﬂow of (4.13), is well-deﬁned and
the image values of r1 and x1, (r+

1 , x+
1 )(x1), satisfy:
√

εµ,

r+
1 (x1) =
1 )(x1) = O(ε−1/2 ln
(x+
1 )(cid:48)(x1) = O(ε−1/2 ln
(x+
Since r1 = (1 + ay)e−y−1b we also have y+ = ln
Proof. We drop the subscripts in (4.15) and divide the right hand side by 1 − x:

−1 ε−1x1)
−1 ε−1).
−1 ε−1/2(1 + o(1)) within Γ1.

(4.17)

+ y

1 + αy
1 − x

,

(4.18)

(cid:19)

(cid:18)
(cid:18)

b +

˙x = x
˙y = −y2,

˙ = 2

b +

ay2

1 + ay

ay

1 + ay

− y

(cid:19)

.

Here (x, y, ) = 0 is a nonhyperbolic equilibrium. The eigenvalues of the lineariza-
tion are 1, 0, 2. The resonance leads us to consider the following blowup:

x = ¯w¯x,

 = ¯w2¯,

( ¯w, (¯x, ¯)) ∈ R+ × S1,

(4.19)

BLOWUP FOR FLAT SLOW MANIFOLDS

33

and the following chart:

Insertion gives:

˙x2 = −y

¯ = 1 :

x = w2x2,  = w2
2.

(cid:18)
(cid:18)

x2 − w2

1 + αy
1 − w2x2
ay2

(cid:19)−1

,

1 + ay

˙y = −y2

b +

(cid:19)(cid:18)

b +

ay2

1 + ay

(cid:19)−1

,

(4.20)

˙w2 = w2,

after division of the right hand side by

b +

ay2

1 + ay

> 0.

The linearization about y = 0, w2 = 0 now gives 0 as a double eigenvalue. Hence
w2 = 0 is an unstable center manifold. To prove the proposition, we need to describe
the mapping from {y = δ} to {w2 = µ−1/2}, corresponding to {1 = µ−1} in the
original variables, obtained by the forward ﬂow of (4.20) for initial conditions with
x2 ∈ [−ξ2 ln ε−1, ξ2 ln ε−1], ξ2 = ρ(δ)ξ. We will describe this mapping in terms of
the variables introduced in the following lemma:

Lemma 4.5. There exists a smooth transformation

that transforms (4.20) into

,

(4.21)

(x2, y) = (˜x2, ˜y) + O(˜x2 ˜yw2),

(cid:18)
(cid:18)

˙˜x2 = −˜y˜x2

b +

a˜y2

1 + a˜y

˙˜y = −˜y2

˙w2 = w2.

b +

a˜y2

1 + a˜y

(cid:19)−1
(cid:19)−1

,

Proof. The transformation is just obtained by straightening out the unstable ﬁbers.
(cid:3)

Consider the initial conditions (˜x20, ˜y0, w20) with

√

ερ(δ)−1,

w20 =

corresponding to 1 = ε/ρ(δ)2 at r1 = ρ(δ), and

˜y0 = δ(1 + O(x20w20δ)),

Then the solution of (4.21) is

˜x2(t) =

˜y(t) =

w2(t) =

˜x20

1 + ˜y0τ2(t, ˜y0)

˜y0

1 + ˜y0τ2(t, ˜y0)
√
ερ(δ)−1et,

,

,

34

K. U. KRISTIANSEN

where τ2(t, ˜y0) solves

or by integration

(cid:18)

=

b +

dτ2
dt

a˜y2

1 + a˜y

(cid:19)−1

,

τ2(0, ˜y0) = 0,

t = bτ2 + ln

(1 + a˜y0)(1 + τ2 ˜y0)

1 + (a + τ2)˜y0

.

Clearly τ2 = O(t) for t → ∞.

Setting w2(T ) = µ−1/2 gives T = ln(ρ(δ)/(
˜x20

√

µε)) and hence

˜x2(T ) =

˜y(T ) =

1 + ˜y0τ2(ln(ρ(δ))/
√
1 + ˜y0τ2(ln(ρ(δ)/

˜y0

√

,

µε), ˜y0)

.

µε), ˜y0)

In terms of x2 we therefore obtain

x2(T ) =

˜x20(1 + O(ln
1 + ˜y0τ2(ln(ρ(δ)/

−1 ε−1))
√

µε), ˜y0)

,

Finally, we return to x (or x1) and y and obtain the expression in (4.17).

(cid:3)

Using the chart ¯x = 1 of the blowup (4.19) it is possible to guide the set of initial

conditions:

x1 ∈ [ξ

√

ε ln ε−1, χ], χ < ν,

x1 ∈ [−χ,−ξ

ε ln ε−1],

√

within r1 = ρ(δ) towards {x1 = ν} for ν suﬃciently small, and eventually prove
the statement of Theorem 4.1 for this set of initial conditions using the uniform
contraction along M1. Similarly, the set

(4.22)
can be guided towards {x1 = −ν} using the chart ¯x = −1 of the blowup (4.19).
From there this set can be continued using the chart ¯x = −1 of (4.12). We skip the
details because it is lengthy and, more importantly, because it is largely independent
of the methods promoted in this paper.

The image points described in Proposition 4.4 are continued into chart κ2 in the

following section.

4.5. Chart κ2. Insertion gives

˙x2 = y ((1 + αy) + x2 (x2 − q2)) ,
˙y = y2 (x2 − q2) ,
˙q2 = q2 (x2 − q2)

(cid:18)

(cid:19)

ay2

b +

,

1 + ay

after division by r2. We consider the following set

U2 =

(x2, y, q2, r2)|x2 ∈ [−ξ−1, ξ−1]

˙r2 = 0,

(cid:26)

(cid:27)

(4.23)

(4.24)

BLOWUP FOR FLAT SLOW MANIFOLDS

35

We enter chart κ2 from chart κ1 (corresponding to initial conditions described

in Proposition 4.4) within

Γ2 :

q2 = µ1/2,

y = ln

−1 ε−1/2(1 + o(1)),

x2 ∈ [−c, c],

(4.25)

with c > 0 large. For ε = 0 we therefore have y = 0 and only dynamics on q2:

˙x2 = 0,
˙q2 = q2(x2 − q2).

(4.26)

Initial conditions within Γ2 with x2 ≥ 0 and r2 = 0 therefore contract towards

C2 = {U2|q2 = x2, x2 ≥ 0, r2 = 0},

while initial conditions with x2 < 0 contract towards the invariant set

I2 = {U2|q2 = 0},

for ε = 0. Here I2, as a set of critical points of (4.26), undergoes a transcritical
bifurcation at x2 = 0, going from asymptotically stable for x2 < 0 to asymptotically
unstable for x2 > 0. This produces the set C2. This set is just C1 for x2 ≥ µ1/2
from chart K1. It is nonhyperbolic at x2 = 0. Using the following blowup:

x2 = ¯ρ¯x2, y = ¯ρ2 ¯y, q2 = ¯ρ¯q2,

(¯ρ, (¯x2, ¯y, ¯q2)) ∈ R+ × S2,

and the chart ¯q2 = 1 it is possible to study C2 and M2 = κ21(M1), recall (4.14), near
this singularity. This enable us to guide initial conditions x2 = O(ln
−1 ε−1) along
M2 and eventually back into chart K1. This establishes the result of Theorem 4.1
for these set of initial conditions. The analysis is very similar to the analysis used
in proving Proposition 4.4 so we again skip the details. More interestingly, we note
that for x2 < 0, we obtain a delayed stability phenomenon due to the attraction
(repulsion) of the invariant set I2 for x2 < 0 (x2 > 0). In this model, this is where
the transition from canards without head to canards with head occurs. See also
Fig. 12 where we, for easing the comparison with Fig. 8, use the original direction
of time.

We describe the delayed stability in the following proposition:

Proposition 4.6. Consider ε suﬃciently small and initial conditions in Γ2 with
x2 ≤ −c−1, c > 0 but large. Then for µ suﬃciently small the forward ﬂow of (4.23)
gives rise to a return mapping x2 (cid:55)→ x+
2 (x2) = −x2 + o(1),
x+

2 (x2) on Γ2 which satisﬁes:
2 )(cid:48)(x2) = −1 + o(1),
(x+

as ε → 0.
Proof. The proof of this statement follows the proof of the delayed stability phe-
nomenon in planar slow-fast systems studied in [35]. This classical result basically
uses appropriate lower and upper solutions to properly bound the motion of the
fast variable. To translate this into the current context we need to bound y. For
this we note the following: For q2 = 0 we can write (4.23) as

y(cid:48)(x2) =

yx2
2 + αy

1 + x2

.

The solution through y(0) = y0 is

(cid:112)(αy0 + 1)2 + x2

y = y0

2(2α + 1) + αy0

= y0

1 + 2αy0

(cid:113)

2 + 1(1 + O(y0)).
x2

36

K. U. KRISTIANSEN

Figure 12. Illustration of the delayed stability that causes the
transition from canards without head to canards with head. The
return mapping to Γ2 is described by Proposition 4.6. We have here
used the original orientation of time also used in Fig. 8. Hence,
the arrows should be reversed when time is as in (4.23).

Therefore for α suﬃciently small we have that y of (4.9), with initial conditions
from (4.25), is bounded as

(cid:113)

(cid:113)

y0

2 + 1(1 − α) ≤ y ≤ y0
x2

x2
2 + 1(1 + α).

Here y0 = O(ln
−1 ε−1) cf. the initial conditions (4.25) and y0 will play the role of
the small parameter. From here we can bound the fast variable by considering the
following two upper ¯q2 and lower solutions q
obtained from the following equations:

¯q(cid:48)
2(x2) =

q(cid:48)

2

(x2) =

y0

y0

2

(cid:112)x2
(cid:112)x2

q

¯q2(x2 + α)
2 + 1(1 − α)
(x2 − α)
2 + 1(1 + α)

2

,

,

after possibly decreasing α further. Proceeding as in [35] gives the desired result.
(cid:3)

From x+

2 (x2) we use the attraction of C2 to follow the trajectory back into chart

K1. This proves the statement of Theorem 4.1 for this set of initial conditions.

4.6. Final remarks. The initial conditions within X3 in (4.22) in chart κ1 can
be followed into chart ¯x = −1 of (4.12) and then subsequently into charts κ2 and
¯x = 1. These orbits will for decreasing values of x1 remain closer to I2 for a longer
period of time before jumping towards M2. Eventually the fast jump along the
critical ﬁbers will occur so that the forward orbit no longer intersects Λ close to
Sε ∩ Λ.
In fact, ultimately the forward orbit does not intersect Sε at all. We
skip the details of this because this can be obtained without the introduction of q.
For the original model, which is just obtained by reversing time, this gives rise to
the transition from canards with head to relaxation oscillations that (a) follow the

BLOWUP FOR FLAT SLOW MANIFOLDS

37

attracting branch ˆSε, then (b) jump near the fold F towards inﬁnity. Here (c) the
orbit follows I2 until it (d) takes oﬀ along a critical ﬁber in chart K1 to return to
ˆSε. See Fig. 10. Using the charts ¯x = ±1 it is straightforward to show that for
√
these orbits the value of y is O(
√
ε) with respect to ε during the passage near I2.
Using (4.6), we obtain v = O(1/
ε) in terms of the original fast variable in (4.1).

5. Conclusion

We have presented a novel approach to deal with ﬂat slow manifolds that appear
in slow-fast systems. The basic idea of this method is to embed the system into a
higher dimensional version for which the standard blowup approach, in the formu-
lation of Krupa and Szmolyan, can be applied to deal with the loss of hyperbolicity.
In this paper, we did not aim to put our approach into a general framework (this
should be part of future work) but instead we demonstrated its use on two exam-
ples: Regularization of PWS systems using tanh and a model of aircraft ground
dynamics. In the future, it would also be interesting to pursue applications of our
approach to areas outside the realm of the classical geometric singular perturbation
theory.

Acknowledgement

The author would like to thank C. Kuehn for pointing me in the direction [33],
Elena Bossolini, Morten Brøns and Peter Szmolyan for useful discussions, and ﬁ-
nally Stephen Schecter for providing valuable feedback.

Appendix A. Proof of Theorem 3.3 using blowup

We consider the following system

˙x = ε(1 + φ(ˆy)),
˙ˆy = 2x(1 + φ(ˆy)) + 1 − φ(ˆy),

(A.1)

with φ ∈ C n−1

ST , n ≥ 2 (see Deﬁnition 3.1). Here
1 + 2x
1 − 2x

Sa : φ(ˆy) =

,

x < 0,

is an attracting critical manifold. It loses hyperbolicity at (x, ˆy) = 0 in a degenerate
fold (in particular, a cusp for n = 3). Indeed, the linearization of (A.1) about Sa
gives an eigenvalue

(2x − 1)φ(cid:48)(ˆy).

This eigenvalue vanishes at ˆy = 0 since φ(cid:48)(ˆy) = 0 by 3◦ in Deﬁnition 3.1. For
x ∈ [−c,−ρ], ρ suﬃciently small, the critical manifold Sa perturbs to a Fenichel
slow manifold Sa,. We will initially seek to guide Sa,ε up until ˆy = 1. For this we
will use the following expansion of φ(ˆy) about ˆy = 1

where

φ(ˆy) = 1 − φ[n](−˜y)n(1 + ˜yR(˜y))),

ˆy = 1 + ˜y, φ[n] =

(−1)n+1

n!

φ(n)(1) > 0.

38

K. U. KRISTIANSEN

Here R(˜y) is smooth by Taylor’s theorem. This expression is valid for ˜y ∈ (−2, 0]
and follows directly from Deﬁnition 3.1. This gives the following equations:

˙x = ε,

˙˜y = 2x +

1
2

φ[n](−˜y)n(1 + ˜yQ(˜y))).

(A.2)

for some smooth Q(˜y), after division of the right hand side by

1 + φ(ˆy) = 2 − φ[n](−˜y)n(1 + ˜yR(˜y))) > 0 within ˜y ∈ (−2, 0).

Now we apply the following blowup:

x = rn ¯x, ˜y = r¯y, ε = r2n−1 ¯ε,

(r, (¯x, ¯y, ¯)) ∈ R+ × S2,

and consider the following two charts:

κ1 :

1 x1, ˜y = −r1, ε = r2n−1
2 x2, ˜y = r2y2, ε = r2n−1
.
(cid:19)
A.1. Chart κ1. In this chart we obtain the following system:

¯y = −1 :
¯ε = 1 :

x = rn

x = rn

(cid:18)

κ2 :

1

2

ε1,

˙x1 = 1 + x1

2x1 +

˙r1 = −r1

2x1 +

1
2

(cid:18)

˙1 = (2n − 1)

2x1 +

φ[n](1 − r1Q(−r1))

1
2

(cid:18)

φ[n](1 − r1Q(−r1))

1
2
φ[n](1 − r1Q(−r1))

(cid:19)

,

,

(cid:19)

1,

after desingularization through the division by rn−1
chart Sa becomes

1

on the right hand side. In this

Sa,1 :

x1 = − 1
4

φ[n](1 − r1Q(−r1)),

r1 ≥ 0.

We consider the following set

U1 = {(x1, r1, 1)|x1 ∈ [−ξ−1, 0], r1 ∈ [0, ρ], 1 = [0, ν]},

with ξ, ρ, ν suﬃciently small. Center manifold theory applied to the equilibrium
x1 = − 1
4 φ[n], r1 = 1 = 0 as a partially hyperbolic equilibrium gives the following:
Proposition A.1. There exists a center manifold within U1:

M1 :

x1 = − 1
4

φ[n](1 − r1Q(−r1)) + 1m1(r1, 1),

with

m1(r1, 1) =

+ O(r1 + 1).

2
φ[n]

The manifold M1 is foliated by invariant hyperbolas

E1 :

ε = r2n−1

1

ε1,

and contains the critical manifold Sa,1 within 1 = 0, as a set of critical points, and

Ca,1 :

x1 = − 1
4

φ[n] + 1m1(0, 1),

within r1 = 0, as a unique center sub-manifold.

BLOWUP FOR FLAT SLOW MANIFOLDS

39

Proof. The proof of this is straightforward. The uniqueness of Ca,1 follows from
the fact that ˙1 > 0 within Ca,1 ∩ {1 > 0}.
(cid:3)
Remark A.2. As usual M1 ∩ E1 is O(e−c/ε)-close to Fenichel’s slow manifold
Sa,ε,1 at r1 = ρ and we shall therefore view M1 ∩ E1 as the extension of Fenichel’s
slow manifold. At 1 = ν we have r1 = (ν−1ε)1/(2n−1) within E1 and therefore the
proposition provides an extension of Sa,ε,1 satisfying:

x1 = − 1
4

Sa,ε,1 ∩ {1 = ν} :

φ[n] + νm1(0, ν) + ε1/(2n−1)Q1(ε1/(2n−1)),

(A.3)
with Q1 smooth. In other words, Sa,ε,1 is ε1/(2n−1)-smoothly close to Ca,1 at 1 = ν.
We continue Sa,ε,1 into chart κ2 in the following. For this we will use the close-
ness of Sa,ε,1 to Ca,1 and therefore guide Sa,ε,1 by following Ca,1. The change of
coordinates between κ1 and κ2 is given as
y2 = −

r2 = r11/(2n−1)

−1/(2n−1)
1

,

x2 = 

−n/(2n−1)
1

x1,

1

.

We will denote Ca,1 and Sa,ε,1 by Ca,2 and Sa,ε,2, respectively, in chart κ2.

A.2. Chart κ2. Insertion gives

˙x2 = 1,

1
2

˙y2 = 2x2 +

˙r2 = 0,

φ[n](−y2)n(1 + r2y2Q(r2y2)),

(A.4)

after desingularization through division of the right hand side by rn−1
ε1/(2n−1). We have
Lemma A.3. The forward ﬂow of Ca,2 ⊂ {r2 = 0} intersects {y2 = 0} in

2

. Here r2 =

where η(n) only depends upon n and

(x2, y2, r2) = (cxη(n), 0, 0),

(cid:19)1/(2n−1)

(cid:18) 2

φ[n]

cx =

.

(A.5)

Proof. We scale x2 and y2 by introducing:

x2 = cxu,

y2 = cyv,

with cx as in (A.5) and

This transforms (A.4) into

cy = −2c2
x.

˙u = 1,
˙v = −u − vn,

for r2 = 0 and v ≥ 0, after scaling time by cx. The result then follows from [34,
(cid:3)
Proposition 3.10].
Now, using the ε1/(2n−1)-smooth closeness of Sa,ε,2 to Ca,2 at y2 = −ν−1/(2n−1),
we can apply regular perturbation theory and blow back down to conclude the
following:

40

K. U. KRISTIANSEN

(cid:19)1/(2n−1)

(cid:18) 2

φ[n]

Proposition A.4. The forward ﬂow of Fenichel’s slow manifold Sa,ε intersects
ˆy = 1 in (x, ˆy) = (xε, 1) with

xε = rn
2

η(n)(1 + r2Q2(r2)),

(A.6)

with r2 = ε1/(2n−1) and Q(r2) smooth.

A.3. Scaling down. To continue Sa,ε beyond ˆy = 1 and towards x = δ we scale
back down using (3.8) and return to the (x, y)-variables:

˙x = 1,

˙y = 2x.

We then use (x, y) = (xε, ε) as an initial condition and obtain, through simple
integration,

at x = θ. This then completes the proof of Theorem 3.3.

yθ(ε) = θ2 + ε − x2
ε,

Appendix B. Proof of Theorem 3.4 by direction integration

The system (3.9) with φ(ˆy) = tanh(ˆy) can be written as

dy
dx

= 2x +

1 − tanh(y−1)
1 + tanh(y−1)

= 2x + e−2y−1

,

upon elimination of time and returning to y through (3.8). Integrating this gives

does not contain any fast components.
unique slow manifold. Now using (B.1)+ we obtain

It therefore represents a geometrically

y(θ) = θ2 + ε

in agreement Theorem 3.4.

y(x) = x2 +

1
2

ε ln

where C is an integration constant and
2√
π

erf (u) =

e−s2

ds,

is the Gauss error function satisfying

erf (u) = ±1 − e−u2√

πu

By (B.1)− it follows that the solution with C = 1:

2ε

erf

(cid:16)√

(cid:18)(cid:114) π

(cid:16)
(cid:90) u
(cid:0)1 + O(u−2)(cid:1)
(cid:18)(cid:114) π
(cid:16)√
(cid:16)

0

erf

2ε

(cid:18) 1

4

ln(cid:0)2πε−1(cid:1) + O(cid:16)

(cid:17)

(cid:17)(cid:19)

2ε−1x

+ C

for u → ±∞

2ε−1x

+ 1

(cid:17)(cid:19)
(cid:17)
e−2ε−1θ2(cid:17)(cid:19)

,

y(x) = x2 +

1
2

ε ln

,

,

(B.1)±

BLOWUP FOR FLAT SLOW MANIFOLDS

41

References

[1] E. Bossolini, M. Brøns, and K. Uldall Kristiansen. Singular limit analysis of the BKR model

for Earthquake Faulting. arXiv:1603.02448, 2016.

[2] M. Brøns. Canard explosion of limit cycles in templator models of self-replication mechanisms.

Journal of Chemical Physics, 134(144105), 2011.

[3] Peter De Maesschalck and Stephen Schecter. The entry-exit function and geometric singular

perturbation theory. Journal of Diﬀerential Equations, 260(8):6697–6715, 2016.

[4] M. di Bernardo, C. J. Budd, A. R. Champneys, and P. Kowalczyk. Piecewise-smooth Dy-

namical Systems: Theory and Applications. Springer Verlag, 2008.

[5] F. Dumortier. Local study of planar vector ﬁelds: Singularities and their unfoldings. In
H. W. Broer et al, editor, Structures in Dynamics, Finite Dimensional Deterministic Studies,
volume 2, pages 161–241. Springer Netherlands, 1991.

[6] F. Dumortier. Techniques in the theory of local bifurcations: Blow-up, normal forms, nilpo-
tent bifurcations, singular perturbations. In Dana Schlomiuk, editor, Bifurcations and Peri-
odic Orbits of Vector Fields, volume 408 of NATO ASI Series, pages 19–73. Springer Nether-
lands, 1993.

[7] F. Dumortier and R. Roussarie. Canard cycles and center manifolds. Mem. Amer. Math.

Soc., 121:1–96, 1996.

[8] B. Erickson, B. Birnir, and D. Lavalle. A model for aperiodicity in earthquakes. 2008.
[9] N. Fenichel. Persistence and smoothness of invariant manifolds for ﬂows. Indiana University

Mathematics Journal, 21:193–226, 1971.

[10] N. Fenichel. Asymptotic stability with rate conditions. Indiana University Mathematics Jour-

nal, 23:1109–1137, 1974.

[11] V. Gelfreich and L. Lerman. Almost invariant elliptic manifold in a singularly perturbed

Hamiltonian system. Nonlinearity, 15:447–557, 2002.

[12] M. Guardia, T. M. Seara, and M. A. Teixeira. Generic bifurcations of low codimension of
planar ﬁlippov systems. Journal of Diﬀerential Equations, J. Diﬀer. Equ, J Diﬀ Equa, J
Diﬀer Equations, J Diﬀerential Equations, J Diﬀer Equ, 250(4):1967–2023, 2011.

[13] Michael G. Hayes, Tasso J. Kaper, Peter Szmolyan, and Martin Wechselberger. Geometric
desingularization of degenerate singularities in the presence of fast rotation: A new proof of
known results for slow passage through Hopf bifurcations. Indagationes Mathematicae, 2015.
[14] E. M. Izhikevich. Dynamical Systems in Neuroscience: The geometry of Excitability and

Bursting. The MIT Press, 2007.

[15] C.K.R.T. Jones. Geometric Singular Perturbation Theory, Lecture Notes in Mathematics,

Dynamical Systems (Montecatini Terme). Springer, Berlin, 1995.

[16] T. Kaper. An introduction to geometric methods and dynamical systems theory for singular

perturbation problems. Proceedings of Symposia in Applied Mathematics, 56, 1999.

[17] I. Kosiuk and P. Szmolyan. Geometric singular perturbation analysis of an autocatalator

model. Discrete and Continuous Dynamical Systems - Series S, 2(4):783–806, 2009.

[18] I. Kosiuk and P. Szmolyan. Scaling in singular perturbation problems: Blowing up a relaxation
oscillator. Siam Journal on Applied Dynamical Systems, Siam J. Appl. Dyn. Syst, Siam J a
Dy, Siam J Appl Dyn Syst, Siam Stud Appl Math, 10(4):1307–1343, 2011.

[19] I. Kosiuk and P. Szmolyan. Geometric analysis of the Goldbeter minimal model for the

embryonic cell cycle. Journal of Mathematical Biology, J. Math. Biol, J Math Biol, 2015.

[20] K. U. Kristiansen. Periodic orbits near a bifurcating slow manifold. Journal of Diﬀerential

Equations, 259(9):4561–4614, 2015.

[21] K. U. Kristiansen and C. Wulﬀ. Exponential estimates of symplectic slow manifolds. ArXiv

e-prints, August 2012.

[22] K. Uldall Kristiansen and S. J. Hogan. On the use of blowup to study regularizations of singu-
larities of piecewise smooth dynamical systems in R3. SIAM Journal on Applied Dynamical
Systems, 14(1):382–422, 2015.

[23] K. Uldall Kristiansen and S. J. Hogan. Regularizations of two-fold bifurcations in planar
piecewise smooth systems using blowup. SIAM Journal on Applied Dynamical Systems,
14(4):1731–1786, 2015.

[24] K. Uldall Kristiansen and S. J. Hogan. On the interpretation of the piecewise smooth visible-
invisible two-fold singularity in R3 using regularization and blowup. arXiv:1602.01026, 2016.

42

K. U. KRISTIANSEN

[25] M. Krupa and P. Szmolyan. Extending geometric singular perturbation theory to nonhyper-
bolic points - fold and canard points in two dimensions. SIAM Journal on Mathematical
Analysis, 33(2):286–314, 2001.

[26] M. Krupa and P. Szmolyan. Extending slow manifolds near transcritical and pitchfork singu-

larities. Nonlinearity, 14(6):1473, 2001.

[27] M. Krupa and P. Szmolyan. Relaxation oscillation and canard explosion. Journal of Diﬀer-

ential Equations, 174(2):312–368, 2001.

[28] C. Kuehn. Normal hyperbolicity and unbounded critical manifolds. Nonlinearity, 27(6):1351,

2014.

[29] C. Kuehn. Multiple Time Scale Dynamics. Springer-Verlag, Berlin, 2015.
[30] J. Llibre, P. R. da Silva, and M. A. Teixeira. Sliding vector ﬁelds via slow-fast systems.

Bulletin of the Belgian Mathematical Society-Simon Stevin, 15(5):851–869, 2008.

[31] A. I. Neishtadt. Persistence of stability loss for dynamical bifurcations .1. Diﬀerential Equa-

tions, 23(12):1385–1391, 1987.

[32] A. I. Neishtadt. Persistence of stability loss for dynamical bifurcations .2. Diﬀerential Equa-

tions, 24(2):171–176, 1988.

[33] J. Rankin, M. Desroches, B. Krauskopf, and M. Lowenberg. Canard cycles in aircraft ground

dynamics. Nonlinear Dynamics, 66(4):681–688, 2011.

[34] C. B. Reves and T. M. Seara. Regularization of sliding global bifurcations derived from the

local fold singularity of Filippov systems. arXiv preprint arXiv:1402.5237, 2014.

[35] S. Schecter. Persistent unstable equilibria and closed orbits of a singularly perturbed equa-

tions. Journal of Diﬀerential Equations, 60:131–141, 1985.

[36] J. Sotomayor and M. A. Teixeira. Regularization of discontinuous vector ﬁelds. In Proceedings

of the International Conference on Diﬀerential Equations, Lisboa, pages 207–223, 1996.

[37] V. I. Utkin. Variable structure systems with sliding modes. IEEE Trans. Automatic Control,

22:212–222, 1977.

