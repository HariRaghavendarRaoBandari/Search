6
1
0
2

 
r
a

 

M
0
1

.

 
 
]
I
S
n
i
l
n
[
 
 

1
v
1
4
3
3
0

.

3
0
6
1
:
v
i
X
r
a

SEMICLASSICAL LIMIT OF THE FOCUSING NLS: WHITHAM

EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

APPROACH

ALEXANDER TOVBIS

Department of Mathematics, University of Central Florida, 4000 Central Florida

Blvd. P.O. Box 161364, Orlando, FL 32816-1364

GENNADY A. EL

Department of Mathematical Sciences, Loughborough University, Loughborough,

LE11 3TU, UK

Abstract. The main goal of this paper is to put together: a) the Whitham
theory applicable to slowly modulated N -phase nonlinear wave solutions to
the focusing nonlinear Schr¨odinger (fNLS) equation, and b) the Riemann-
Hilbert Problem approach to particular solutions of the fNLS in the semiclas-
sical (small dispersion) limit that develop slowly modulated N -phase nonlinear
wave in the process of evolution. Both approaches have their own merits and
limitations. Understanding of the interrelations between them could prove
beneﬁcial for a broad range of problems involving the semiclassical fNLS.

In this paper we consider the focusing Nonlinear Schr¨odinger (fNLS) equation

1. Introduction

ε2∂2

xψ + |ψ|2ψ = 0,

1
2

iε∂tψ +

(1.1)
where x ∈ R and t ≥ 0 are space-time variable and ε > 0. In the semiclassical (small
dispersion) limit we take ε → 0+. The fNLS is a basic model for self-focusing and
self-modulation, for example, it governs nonlinear transmission of light in optical
ﬁbers; it can also be derived as a modulation equation for a broad class of nonlinear
systems. It was ﬁrst integrated (with ε = 1) by Zakharov and Shabat [38], who
produced a Lax pair for it and used the inverse scattering procedure to describe
the time evolution of general decaying potentials (lim|x|→∞ ψ(x, 0, ε) = 0) in terms
of the scattering data, that is, radiation and solitons.

Integrability of the fNLS enables the existence of the ﬁnite-gap solutions, the
non-decaying quasi-periodic potentials with many remarkable properties [1]. Slow
modulations of these potentials are described by the Whitham modulation equa-
tions [37], a system of quasilinear equations derived by the averaging procedure ap-
plied to fNLS. The remarkable feature of the fNLS evolution is that the modulated

E-mail addresses: Alexander.Tovbis@ucf.edu, G.El@lboro.ac.uk.

1

2 SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

ﬁnite-gap potentials arise as asymptotic solutions in the initial value problems for
the fNLS with non-oscillating initial conditions (e.g. Gaussian or sech initial data
for (1.1)). This has been understood in the framework of the Riemann-Hilbert prob-
lem (RHP) approach to the inverse scattering yielding both the ﬁnite-gap potentials
and their modulations within the rigorous asymptotic description of the semiclas-
sical fNLS evolution. However, the connections between the Whitham modulation
theory and the RHP approach have not been properly traced.

The main results of the present paper:

• We link the main objects of the Whitham theory (Riemann invariants, their
characteristic velocities, fundamental diﬀerentials dp, dq) with the corre-
sponding objects coming from the RHP approach, which are expressed in
terms of the g-function from the RHP approach and the corresponding
hyperelliptic Riemann surface R;
• We derive several equivalent forms of the modulation equations (by which
we mean systems of transcendental equations for the branchpoints of R),
and use them to show that various forms of the generalized hodograph
solutions of the Whitham equations are satisﬁed;
• we use the g-function to establish the role of the potential for the diﬀer-
entials dp, dq in determining the breaking (phase transition) curves and
double point velocities for the fNLS.

The ﬁrst (spatial) equation of the Lax pair for the fNLS is known as Zakharov

- Shabat (ZS) system

(1.2)

iε

d
dx

W =

ψ
¯ψ −z

W ,

(cid:18)z

(cid:19)

where z is a spectral parameter and W is a 2 by 2 matrix-function.

The scattering data, corresponding to the initial data ψ(x, 0, ε), consist of the
reﬂection coeﬃcient r0(z, ε), as well as of the points of the discrete spectrum, if
any, together with their norming constants. The time evolution of the scattering
data is simple ([38]). The corresponding evolution of a given potential is obtained
through the inverse scattering transformation (IST) of the evolving scattering data.
The inverse scattering transform for the fNLS equation (1.1) at the point x, t can
be cast as the following matrix Riemann-Hilbert Problem (RHP) in the spectral
z-plane: ﬁnd a 2× 2 matrix-valued function m(z) = m(z; x, t, ε), which depends on
the asymptotic parameter ε and the external parameters x, t, such that: i) m(z) is
analytic in C\Γ, where the contour Γ = R has the natural orientation; ii)

(cid:19)
ε (2z2t+zx)] and m±(z) = limδ→0 m(z±

= m−V

(1.3)

m+ = m−

¯r
1
on the contour Γ, where r(z, ε) = r0(z, ε) exp[ 2i
iδ) with δ > 0 and z ∈ R; iii) limz→∞ m(z) = 1, where 1 denotes the identity ma-
trix.
In the presence of solitons the contour Γ contains additional small circles
around the eigenvalues with the corresponding jump-matrices (see, for example,
[30] or [19]).

(cid:18)1 + r¯r

r

A complementary approach to the analysis of nonlinear dispersive equations is
provided by the Whitham modulation theory which produces a system of quasilin-
ear partial diﬀerential equations governing slow modulations of periodic or quasi-
periodic waves. A prominent area where the Whitham method proved extremely
useful is the theory of dispersive shock waves (DSWs) [16], [11]

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM 3

We consider an N -phase quasi-periodic solution of the fNLS equation (1.1),
ηj = kjx + ωjt + η0
j .

ψ = ψN (ε−1η1, ε−1η2, . . . , ε−1ηN ; α, ¯α), where

(1.4)
j=0 ∈ CN and c.c. are the branchpoints of the hyperelliptic Riemann
Here α ≡ {αj}N
surface of genus N on which (1.4) lives [1], the (normalized by ε) wavenumbers kj
and the frequencies ωj are deﬁned in terms of the branchpoints, and η0
j are arbitrary
initial phases. Now, if the parameters αj, ¯αj are allowed to vary slowly in space
and time they must satisfy the Whitham modulation equations,

(1.5)

(αj)t = V (N )

j

(α, ¯α)(αj)x,

(¯αj)t = V

(N )
j

(α, ¯α)(¯αj)x,

j = 0, . . . , N ,

so that αj, ¯αj are Riemann invariants. The characteristic velocities V (N )
are
expressed in terms of the Riemann invariants αj through hyperelliptic (for N ≥ 2)
or complete elliptic (for N = 1) integrals. For N = 0 the Whitham system (1.5)
has the form

, V

j

(N )
j

(1.6)

(α0)t = ( 3

2 α0 + 1

2 ¯α0)(α0)x,

(¯α0)t = ( 3

2 ¯α0 + 1

2 α0)(¯α0)x ,

and is equivalent to the dispersionless limit of (1.1)

(1.7)

ρt + (ρu)x = 0,

ut + uux − ρx = 0 ,

where the Riemann invariants and characteristic speeds in (1.6) are expressed in
terms of the hydrodynamic “density” ρ = |ψ|2 ≥ 0 and “velocity” u = −iε−1(arg ψ)x
as

(1.8)

α0 = −(

u
2

√
+ i

ρ),

V (0)
0 = 3

2 α0 + 1

√
2 ¯α0 = −(u + i

ρ) .

One can see that the characteristics of (1.7) are complex unless ρ = 0 implying
nonlinear modulational instability of the NLS equation (1.1) in the long-wave limit,
and hence, ill-posedness of the initial-value problem for (1.6) for all but analytical
initial data.

For N ≥ 1 the characteristic velocities V (N )

in (1.5) are also complex, however,
vanishing of the imaginary parts for some Vj’s is possible. This “partial hyperbolic-
ity” property makes the Whitham systems for N ≥ 1 radically diﬀerent compared
to the genus zero case and has major implications in terms of stability of some
solutions [10].

j

There are (at least) two ways of looking at the Whitham equations. Originally,
they were introduced in [35] as the equations obtained by the averaging of disper-
sive conservation laws over the family of periodic or quasi-periodic solutions. Later,
Whitham put his method in the very general variational principle framework [36].
Another approach leading to the same set of equations is the multiple-scale (non-
linear WKB) expansions method [24].
If the original dispersive equation is IST
integrable, the associated Whitham system turns out to be also integrable in the
sense which will be explained later on.

Using the ﬁnite-gap theory of the KdV equation [26], [21] Flaschka, Forest and
McLaughlin [14] showed that the endpoints of the spectral bands of quasi-periodic
ﬁnite-gap potentials of the quantum-mechanical Schr¨odinger operator are Riemann
invariants of the Whitham modulation system associated with the KdV equation.
Analogous result for the fNLS equation was obtained by Forest and Lee [15] and
Pavlov [27].

The second context in which the Whitham equations appear is due to Lax, Lev-
ermore and Venakides [22], [33], [23] who derived them as the equations governing

4 SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

the zero dispersion limit of the KdV equation. The dispersion parameter ε deter-
mines the typical scale of nonlinear oscillations in the KdV solution so the limit
as ε → 0 exists only in a weak sense. Venakides provided the bridge between the
Flaschka-Forest-McLaughlin (wave packet averages) and Lax-Levermore (weak lim-
its) results by developing the higher-order Lax-Levermore theory [34]. Finally, the
all-encompassing approach to the small-dispersion KdV was developed by Deift,
Venakides and Zhou [5], who introduced the nonlinear steepest descent method for
the RHP associated with the (semi-classical) inverse scattering problem.

The Whitham equations naturally arise in the RHP construction as the equations
governing the evolution of the spectral branch points αj, ¯αj. To be precise, the RHP
theory yields the hodograph solution to the Whitham equations as the combination
of the moment conditions and the Boutroux conditions. Although the connection
of the Whitham equations with the RHP construction of the semi-classical limit is
generally well known it has not been explored to any depth for the fNLS equation.
The apparent reason for such an omission is twofold: (i) the existing rigorous
analyses of the IVPs for the fNLS equation (see [19], [30] and references therein),
performed within the RHP framework, already contain all the information about
slow modulations of the solution so there is no need to recover it with the aid of
a more restricted Whitham approach; (ii) the Whitham equations (1.5) are elliptic
so their application to the problems outside the ﬁrmly established facts of the
existence and convergence of the relevant solution was suspect. Nevertheless, the
success of the application of the Whitham theory to dispersively modiﬁed hyperbolic
conservation laws, particularly in the DSW theory for the KdV and defocusing
NLS equations (see [11] and references therein), provides a strong incentive for
the development of a similar theory for the elliptic, focusing case, which is also
supported by the extensive numerical evidence that the key features of the small-
dispersion “hyperbolic” nonlinear dynamics, such as the co-existence of smooth and
rapidly oscillating regions and weak convergence, hold true for at least some cases
of the semi-classical fNLS evolution (see, e.g., [3], [4], [10]).

The modulation theory approach to the description of the small dispersion limit
of integrable “hyperbolic” equations, such as KdV or defocusing NLS, involves solu-
tion of a nonlinear free boundary problem for the associated Whitham modulation
system via the so-called matching regularization procedure. This procedure repre-
sents an extension of the original Gurevich-Pitaevskii method of the modulation
description of a DSW in the KdV equation [13] and prescribes the solution genus
increase every time it undergoes a gradient catastrophe. The modulation solutions
of diﬀerent genera are “glued” in a spectial way along the breaking curves which
are free boundaries and whose determination is part of the solution (see e.g.
[12]
for the detailed description of the matching regularization procedure for the KdV
equation with monotone initial conditions).

The matching regularization procedure can be relatively easily implemented in
the problems involving the fNLS solutions with N = 0 and N = 1. This was done
in [7], [20], [10] for the fNLS dam-break problem. The modulation solution of [7],
[20] was rigorously conﬁrmed in [17] within the RHP analysis of the semi-classical
fNLS with the square barrier initial data. The breaks involving N ≥ 2 as in the
ﬁrst break for the sech potential ([19], [30]), or any higher breaks have not been
considered within the Whitham theory with the only exception [10], where the
modulation solution beyond the second break was used to predict the generation

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM 5

of rogue waves (note, however, that the second break was considered in [25] in the
framework of the RHP approach).

The above discussion strongly suggests that it would be highly desirable to de-
velop a method for solving the fNLS-Whitham equations in problems involving
formation of oscillatory regions characterized by the genus N ≥ 2. It is also clear
that the RHP analysis, in particular, the nonlinear steepest descent method with
the g-function mechanism, can provide valuable clues to the structure of the modu-
lation solutions. Indeed, certain elements of the RHP approach oﬀer an elegant way
to circumvent the matching regularization procedure which could be quite awkward
when matching modulation solutions with N ≥ 2. Thus, a closer exploration of the
interconnections between the RHP theory of the small-dispersion fNLS limit and
the counterpart Whitham modulation theory seems a worthwhile task. Indeed, an
appropriate combination of the Whitham theory and some key elements of the RHP
which could be termed a “formal RHP analysis”, complemented by careful numer-
ical simulations recently proved very eﬀective for solving problems of immediate
physical interest [10].

The paper is organized as follows.

In Sections 2, 3 we present the general
Whitham theory approach and the RHP approach respectively, as applied to semi-
classical fNLS. These two approaches are compared in the case of genus zero in
Section 4. In Section 5 we derive an explicit expression for the g-function (in the
determinantal form) in higher genera regions for the box-type potentials and discuss
its connections with the corresponding hyperelliptic Riemann surface R. Solutions
of the Whitham equations in terms of g-function are discussed in Section 6. The
results of this section are based on Theorem 6.1 about three equivalent forms of
modulation equations. The results of Sections 5, 6 in the case of analytic potentials
were discussed in Section 7. Transitions between the regions of diﬀerent genera
and the characteristic velocities along breaking curves are discussed in Section 8.
In particular, we show that, in the square barrier (“box”) potential case, a pair of
collided branchpoints on the breaking curve always has real characteristic velocity.

2. Whitham equations and hodograph solution

The Whitham equations for the fNLS 1.1 can be represented as a single gener-

ating conservation equation [15], [27]

(2.1)

∂tdp = ∂xdq,

where dp(z, α, ¯α) and dq(z, α, ¯α) are certain meromorphic diﬀerentials of the second
kind (the quasimomentum and the quasienergy) on the hyperlliptic Riemann surface
j=0(z − αj)(z − ¯αj) where z is the
R of genus N deﬁned by the radical R(z) =
complex spectral parameter. The branch points α = (α0, . . . , αN ) and c.c. are the
points of simple spectrum of the periodic Zakharov-Shabat operator (1.2).

(cid:113)(cid:81)N

by the following properties [15]:

The quasimomentum and quasienergy diﬀerentials dp and dq are uniquely deﬁned
(a) dp and dq have the poles of order two and three respectively at ∞± on R

and no other poles;

6 SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

(b) the expansions of dp and dq in the local coordinate z = ζ−1 near ∞± are

(2.2)

dp ∼ ±[− 1
dq ∼ ±[− 2

ζ 2 + holomorphic part] near ∞±,
ζ 3 + holomorphic part] near ∞±
(cid:73)

(cid:73)

(c) dp and dq satisfy the normalization conditions

(2.3)

dp =

dq = 0 ,

j = 1, . . . , N,

ˆγj

ˆγj

where ˆγj is a clockwise loop around the branchcut connecting αj and ¯αj (the A-
cycle).

Note that dp, dq are Schwarz symmetrical diﬀerentials, so that normalization
conditions (2.3) are equivalent to Boutroux normalization conditions for dp, dq: all
the cycles of dp, dq on R are real.

The integrals over the B-cycles, canonically conjugated to the A-cycles, give the

fundamental wavenumbers kj and frequencies ωj:

(cid:73)

(cid:73)

(2.4)

kj =

dp , ωj =

dq .

Bj

Bj

An alternative useful representation for the wave numbers and frequencies in terms
of holomorphic diﬀerentials is:
(2.5)
kj = −4πiκN,j ,

(αk + ¯αk) κN,j + κN−1,j

ωj = −4πi

,

j = 1, . . . , N,

(cid:34)

(cid:35)

N(cid:88)

k=0

1
2

where κj,k(α, ¯α) are the coeﬃcients of the normalized holomorphic diﬀerentials
found from the system

(cid:73)

N(cid:88)

κm,k

i=1

ˆγk

(2.6)

zm
R(z)

dz = δmk , m, k = 1, . . . , N.

Here δmk is the Kronecker symbol.

The generating equation (2.1) has several fundamental consequences:
(i) By multiplying (2.1) by (z−α)3/2 and letting z → αj one obtains the diagonal

system (1.5) with the characteristic speeds Vj given by

(2.7)

Vj =

dq
dp

,

V j =

dq
dp

(cid:12)(cid:12)(cid:12)(cid:12)z=αj

(cid:12)(cid:12)(cid:12)(cid:12)z= ¯αj

.

(ii) By expanding (1.5) near z = ∞ we obtain an inﬁnite series of averaged local
conservation laws of the form ∂tPj(α, ¯α) = ∂xQj(α, ¯α), where Pj are the averaged
densities of the NLS conservation laws and Qj the corresponding averaged ﬂuxes.
Any 2N + 2 of these conservation laws are independent.

(iii) By integrating (1.5) over each of the N B-cycles we obtain, on using (2.4),

N equations for conservation of waves

(2.8)

∂
∂t

kj(α, ¯α) =

∂
∂x

ωj(α, ¯α),

j = 1, . . . , N .

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM 7

Since (2.8) must be consistent with (1.5) we obtain a compact and physically
insightful representations for Vj’s as nonlinear group velocities is (see [8], [9], [11]).

(2.9)

V (N )
j =

∂ωi
∂αj

/

∂ki
∂αj

,

for any i = 1, . . . , N.

We note that equations (2.8) represent the consistency conditions in the formal
averaging procedure [36, 37] as well as in the the WKB-type multiple-scale ex-
pansions [24], [37], [6] leading to the same Whitham system (1.5). Within this
(general) modulation theory framework the wavenumbera kj and the frequences ωj
in the modulated wave are deﬁned as the derivatives of the phase ηj:

(2.10)

kj = (ηj)x, ωj = (ηj)t,

j = 1, . . . , N.

Clearly, the deﬁnitions (2.10) by Clairaut’s theorem are consistent with the wave
conservation equation (2.8).

The Whitham system (1.5) can be integrated using the Tsarev generalized hodo-
graph transform [32]. This method was originally developed for hyperbolic systems
of hydrodynamic type but is equally applicable to elliptic systems. Tsarev’s result
in the application to our present problem can be formulated as follows. Any local
non-constant solution of the modulation system (1.5) for a given genus N is given in
an implicit form by the system of N algebraic equations with complex coeﬃcients

(2.11) x+Vj(α, ¯α)t = wj(α, ¯α),
where the characteristic speeds Vj(α, ¯α) ≡ V (N )
(α, ¯α) are given by (2.9), (2.5).
The 2N unknown complex functions wj, ¯wj, j = 1, 2, . . . , N satisfy the system of
linear partial diﬀerential equations

x+V j(α, ¯α)t = ¯wj(α, ¯α),

j = 1, 2, . . . , N,

j

∂αj wk
wk − wj

=

∂αj Vk
Vk − Vj

k (cid:54)= j ,

(2.12)
where ∂αj ≡ ∂
. System (2.12) is overdetermined but compatible for the NLS case
studied here owing to the integrability of fNLS being preserved under the Whitham
averaging [6].

j, k = 1, 2, . . . , N,

and c.c.;

∂αj

We now note that, for the solution q(x, t; ε) of the semi-classical fNLS to have
an asymptotic representation in the form of the modulated ﬁnite-band potential
locally depending on N “torus” phases ε−1ηj = ε−1(kjx + ωjt + η0
j ) (see (1.4)),
and at the same time to satisfy the general kinematic conditions (2.10) one must
require that the “initial phases” η0
j are not constants but depend on x, t via the
branch points α, ¯α. To this end we introduce the modulation phase shift functions
j = −Υj(α, ¯α) so that the normalized phases ηj assume the form
Υj(α, ¯α) by η0
(see [10], [11])

(2.13)

ηj = kjx + ωjt − Υj(α, ¯α).

Then the deﬁnition of the local wavenumber in (2.10) implies

(2.14)

kj =

∂(kjx + ωjt − Υj)

∂x

,

j = 1, 2,

which yields

(2.15)

∂kj
∂αm

x +

∂ωj
∂αm

t =

∂Υj
∂αm

,

and c.c.,

j, m = 1, 2, . . . , N.

8 SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

provided ∂αj/∂x (cid:54)= 0, ∂ ¯αj/∂x (cid:54)= 0, j = 1, 2. Here kj(α, ¯α) and ωj(α, ¯α) are
deﬁned by (2.5), and Υj’s are yet to be found. Note that the second condition
(2.10) leads to the same set of equations (2.15). As we shall see, only half of the
equations (2.15) are independent, so it is suﬃcient to consider either j = 1 or j = 2.
We also note that equations (2.15) admit a compact and elegant representation in
the form of the stationary phase conditions:

(2.16)

∂ηj
∂αm

= 0,

∂ηj
∂ ¯αm

= 0,

j, m = 1, 2, . . . , N.

For given functions Υj(α, ¯α) equations (2.15) fully deﬁne the modulations α(x, t),
¯α(x, t) (assuming invertibility of (2.15), which is not guaranteed a priori). Com-
paring equations (2.15) with the hodograph solution (2.11) and using the represen-
tation (2.9) for the characteristic speeds Vj(α, ¯α) in (2.11) one readily makes the
identiﬁcation

(2.17)

wm =

∂αm Υj
∂αm kj

and c.c.,

j, m = 1, 2, . . . , N .

Now we observe that formula (2.17) must yield the same function wm(α, ¯α) for
all values of j. This is a consequence of the consistency of the genus N Whitham
modulation system with N “extra” conservation laws (2.8) (the same argument
was used to establish the ‘nonlinear group velocity’ representation (2.9) for the
characteristic speeds of the Whitham modulation system). Thus, it is suﬃcient to
consider any N of the equations (2.15) for any given j.

Summarizing, the integration of the Whitham equations reduces to the deter-
mination of the “modulation phase shift” vector function Υ(α, ¯α). As we shall
see, this function naturally arises in the RHP construction, thus enabling one to
circumvent the complicated matching regularization procedure necessary for the
determination of the dependence of Υ(α, ¯α) on the fNLS initial conditions within
the Whitham modulation theory framework. Another feature of the RHP analysis
enhancing the modulation theory is that it reveals the precise mechanism of the
genus change across a breaking curve. We note that within the Whitham mod-
ulation theory the genus change determination is essentially an “educated guess”
process which must be conﬁrmed by the construction of the full modulation solu-
tion.

3. RHP approach to the inverse scattering for the fNLS. The

g-function.

It is well known (see, for example [39]) that the RHP (1.3) has a unique solution
z + O(z−2) as z → ∞, and that the
m(z) that has asymptotics m(z) = 1 + m1
solution to the NLS (1.1) is given by ψ(x, t, ε) = −2(m1)12, where (m1)12 denotes
the (1, 2) entry of matrix m1. In the case when r0(z, ε) has analytic continuation
into the upper halfplane, the RHP for m(z) is simpliﬁed by factorizing the jump
matrix

(3.1)

V =

(cid:18)1 + r¯r

r

(cid:19)

¯r
1

(cid:18)1

0

=

(cid:19)(cid:18)1

r

¯r
1

(cid:19)

0
1

= V−V+ ,

and, thus, “splitting” the jump condition (1.3) into two jumps: one with triangular
jump matrix V+ along some contour Γ+ in the upper halfplane ¯C+ and the other
with triangular jump matrix V− along some contour Γ− in the lower halfplane ¯C−
(here we assume that R is included in ¯C±). Contours Γ± are deformations of R.

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM 9

Due to the Schwarz symmetry of the ZS problem, contours Γ± can be chosen to
be symmetric to each other with respect to the real axis, and we can restrict our
attention only to the contour Γ+ ⊂ ¯C+. For simplicity, we assume Γ to be a simple,
smooth (except for a ﬁnitely many points) contour without self-intersections.

The central idea of the Deift-Zhou nonlinear steepest descent method for as-
ymptotic analysis of RHPs is proper factorization of a jump matrix accompanied
by the proper deformation of the contour Γ. That is why we assumed that r0(z; ε)
has analytic continuation from R into ¯C+. Another essential element in the non-
linear steepest descent analysis is the concept of g-function. We use the g-function
g(z) = g(z; x, t) to deﬁne a transformation, that reduces the RHP (1.3) to another
RHP that, in the small ε limit, has piece-wise constant (in z) jump matrices. In
some sense, the g function can be compared with the oscillatory phase function in
the WKB method, which reduces a singularly perturbed ODE (like, for example,
(1.2)) to a system that can be solved by a power series in the small parameter ε
(or a fractional power of ε).

The g is build for a particular solution of the fNLS (1.1), given by the correspond-
ing scattering data. Thus, the g function will be deﬁned by a Schwarz symmetric
function f0(z), that can be associated with a scaled logarithm of r0(z). We assume
f0(z) to be analytic, or at least, piece-wise analytic, in some Schwarz symmetrical
domains that contain Γ+ and Γ− respectively. The meaning of piece-wise analytic-
ity will be addressed below.
Because of Schwarz symmetry, f0(z) may have a purely imaginary jump 2i(cid:61)f0
on R. Depending on whether or not (cid:61)f0(z) ≡ 0 on some interval of R, f0(z) may
have either one or two analytic components in some region containing R. In general,
f0(z) may also depend on ε.

Examples 3.1. 1) In the case of of the box (barrier) potential ψ(x, 0, ε) = qχ[−L,L],
where q > 0 is the hight of the box and χ[−L,L] is the characteristic function of the segment
[−L, L] with L > 0 being the length of the box, the (modiﬁed) reﬂection coeﬃcient r(z, ε)
from (1.3) is given by ([17])

(cid:17)
(cid:16) 2Lν(z)
(cid:17) − iz sin

ε

−q sin

(cid:16) 2Lν(z)

ε

(cid:16) 2Lν(z)

(cid:17) e

ε

(3.2)

r(z; ε) =

ν(z) cos

where

∞(cid:88)

−2tz2−2xz−2Lz

ε

=

ρk(z)eiθk(z)/ε,

k=0

(z)(1 − ρ2

0(z)), k = 1, . . . ,

θk(z) = 2tz2 + 2(x − L)z + 4kLν(z), ρk(z) = ρ2k−1

0

(3.3)

with ν(z) = (cid:112)z2 + q2 and ρ0 =

−iq
ν(z)+z . In this case f0(z) is piece-wise analytic, taking
values f0(z) = θk(z)− 2tz2− 2xz in diﬀerent parts of the spectral plane as will be discussed
below. Notice that f0(z) does not have a jump along R, so that there is one analytic
component of f0 containing R.
ε , the function f0(z),
which is the leading order approximation of −iε ln r0(z, ε) as ε → 0, was calculated ([30])
as

2) In the case of a sech potential with phase ψ(x, 0, ε) = cosh−1− 2i

f0(z) = (z − 1) [iπ + 2 ln(1 − z)] − 2z ln z, (cid:61)z ≥ 0.

(3.4)
It follows from (3.4) that (cid:61)f0(z) (cid:54)= 0 as z ∈ R except at z = ±1. Thus, the Schwarz
symmetrical function f0(z) has the jump 2i(cid:61)f0(z) on R, except at z = ±1. So, f0(z) has
two disjoint analytic components in a region surrounding R.

10SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

Remark 3.1. The Schwarz-symmetric function f0(z) from (3.4) in a more general
setting can be associated with both the reﬂection coeﬃcient and/or the density func-
tion, deﬁned on the locus of accumulating (in the limit ε → 0) discrete eigenvalues.
−1(x), considered in [19], corresponds to
For example, the case of ψ(x, 0, ε) = cosh
r(z; ε) ≡ 0 if ε = 1
N , N ∈ N, so that f0(z) is deﬁned by the density function only.
From the point of view of this paper, a particular “source” of f0(z) in (3.5)-(3.6)
is irrelevant.

In order to control the growth of r(z, ) on the contour Γ, we split it into a number
of arcs of 2 diﬀerent types: main arcs (bands) and complementary arcs (gaps).
Main arcs are always bounded whereas complementary arcs are either unbounded
(we do not consider them as they do not aﬀect the g-function) or bounded arcs that
neighbor main arcs at each endpoint. The number and the positions of the endpoints
of these arcs depend on the initial potential as well as on a particular point (x, t) of
the physical (space-time) variables. The number of bounded complementary arcs
(called simply complementary arcs) does not exceed the number n ∈ N of main
arcs. Because of Schwarz symmetry, each main arc either has a complex conjugate
(with anti complex conjugate orientation) or is Schwarz-symmetrical itself, and in
this case it crosses the real axis. The same is true for complementary arcs. We use
notations γm,j, γc,j for the j-th pair of complex conjugate main and complementary
arcs respectively (that also include single self-symmetrical arcs), whereas γ±
m,j, γ±
c,j
denote parts of γm,j, γc,j in the upper or lower half-planes respectively, see Figure
1, Left. Here we discuss the general setting of the problem for the g-function.

The complex valued Schwarz symmetrical g-function is deﬁned as satisfying the

following jump and analyticity conditions:

g+ + g− = f + Wj on the main arc γm,j, j = 0,··· , n
g+ − g− = Ωj on the complementary arc γc,j, j = 0, 1,··· , n

g(z) is analytic in ¯C \ γ,

(3.5)

where the function

(3.6)

f (z) = f0(z) + 2zx + 2tz2

is a given input to the problem and the real constants Wj and Ωj are to be deter-
mined (we take W0 = 0). Note that conditions (3.5) form a scalar RHP for the
g-function g(z).

By the Sokhotski-Plemelj formula,

(cid:90)

(cid:35)

(cid:34)(cid:90)
n(cid:88)
(cid:113)(cid:81)

j=0

(3.7)

g(z) =

R(z)
2πi

f (ζ) + Wj
(ζ − z)R+(ζ)

dζ +

γm,j

Ωj

(ζ − z)R(ζ)

dζ

.

γc,j

Here the radical R(z) =
taken over all the endhpoints αj of γm,j, j = 0, 1,··· , n,

j(z − αj) has branchcuts γm,j, where the product is
Let us assume for simplicity that each γm,j, j = 1,··· , n, consists of two arcs
and γm,0 is a single arc. Other possible conﬁgurations can be considered similarly.
Then the total number of endpoints is 4n + 2 and the hyperelliptic Riemann surface
R of R(z) has the genus N = 2n and there are no more than 2n complementary

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM11

Figure 1. Left: Main and complementary arcs with n = 2 (genus
4) for sech potential, where f0(z) has a jump across R. Right:
Deformation of main and complementary arcs into vertical branch-
cuts.

arcs γc,j, j = 1, . . . , n. We ﬁx the branch of R(z) by the requirement

(3.8)
on the main sheet of R. Due to the analyticity of f , the integrals over γm,j, γc,j in
(3.7), can be deform into the corresponding loop integrals ˆγm,j, ˆγc,j on R around
γm,j, γc,j respectively. Thus,

lim
z→∞

R(z)
zN +1 = 1

(3.9)

g(z) = O(z − ak)

1
2

around any endpoint αk of a main arc. Here and henceforth ee will refer to the
endpoints αj as branchpoints (of R).
The scalar RHP (3.5) for g(z; x, t) is completely deﬁned if we know the genus N
of R, the branchpoints αk and the real constants Wj, Ωj. From the point of view
of solving RHP (3.5), the exact location of the main arcs γm,j is not crucial, as,
due to the analyticity of f (z), they can be deformed without changing g.
The real constants in the RHP (3.5) are determined by the requirement that g
is analytic at z = ∞ and will be discussed in Section 5 below. What conditions
determine the genus N and the branchpoints? Without going into the details of
g-function mechanism, we will state that the function

(3.10)
must satisfy the following “sign distribution” conditions in C+:

h(z; x, t) = 2g(z; x, t) − f (z; x, t)

(cid:61)h < 0 on both sides of each main arc γm,j, j = 0, 1,··· , n,
(cid:61)h > 0 along each complementary arc γc,j, j = 1,··· , n.

(3.11)

The corresponding inequalities in the lower half-plane, due to Schwarz symmetry,
have the opposite signs.) Note that according to (3.5), (3.10), h+(z)+h−(z) = 2Wj
on γm,j, so that all the main arcs lie on zero level curves of (cid:61)h(z). Conditions (3.11)

ν4∼ν1∼ν3∼ν∼2ν∼0ννννννννm,2m,1νm,−1m,−2m,0c,1c,−1c,2c,−2αααααααααα012344321012SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

can be violated in no more than a ﬁnite number of points. If this is the case, the
corresponding value of (x, t) = (xb, tb) is called a breaking point.

At any branchpoint, where a main and a complementary arcs meet (movable

branchpoint), conditions (3.11), combined with (3.9), imply that

(3.12)

(cid:61)h(z; x, t) = O(z − ak)

3
2

Equations (3.12), are known in the RHP literature as the modulation equations
(although they essentially are solutions of the (diﬀerential) Whitham equations),
determine the location of all movable (with x, t) branchpoints. Fixed branchpoints
(“hard edges”) are known to appear in some non-analytic cases (see, for example,
[17], for the box initial data). If two or more branchpoints collide at some α, we
will have

(3.13)

(cid:61)h(z; x, t) = o(z − ak)

3
2

instead of (3.12). Now, the only remaining question is: how is the genus N deﬁned?
Usually, the genus N is deﬁned for some special values of x, t, say, for the initial
data t = 0. As we then continuously deform external parameters x, t, the branch-
points αj move according to (3.12), pulling (deforming) main and complementary
arcs of the contour γ = γ(x, t) with them. The genus will be preserved under such
deformation until a breaking point (xb, tb) is reached. A regular breaking point is
attained by changing the topology of the zero level of (cid:61)f (z; x, t), called pinching:
the required inequalities (3.11) failed in one or several points on the main and/or
complementary arcs. Such points are called double points. Another cause of break-
ing points is interaction of the Riemann-Hilbert contour of g (the collection of the
main and complementary arcs) with singularities of f0(z), or, in the case of piece-
wise analytic f0(z), the interaction of the Riemann-Hilbert contour with various
elements of f0(z).

The continuation principle ([29]) states that, in the case of a regular breaking
point (xb, tb), we can continue deformation of x, t (with sign conditions satisﬁed)
past (xb, tb) with the appropriate change of the genus N .

The scalar RHP (3.5) and the modulation equations (3.12) is the starting point of
our analysis. Various forms of Whitham equations from Section 2 and conservation
equations can be derived from (3.5) and (3.12).

4. The genus 0 case

In the case of n = 0 there are no real constants in the RHP (3.5). Then the
modulation equations (3.12), deﬁning the branchpoints of R(x, t), can be written
as

(cid:73)

(4.1)

f (ζ)

(ζ − α)R(ζ)+

dζ = 0 ,

ˆγm

and its complex conjugate, where α = α0, f is given by (3.6) and ˆγm is a negatively
(clockwise) oriented loop around the main arc (band) that intersects R only at some

point µ. Here R(z) =(cid:112)(z − α)(z − ¯α).

Clearly, (4.1) and (3.6) yield

(4.2)

2x + 2((cid:60)α + α)t = − 1
2πi

(cid:73)

ˆγm

f0(ζ)

(ζ − α)R(ζ)+

dζ

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM13

(cid:73)

together with its complex conjugate. Comparison of (4.2) and the hodograph equa-
tion (2.11) yields

(4.3)

V (α, ¯α) =

3
2

(α + ¯α), w(α, ¯α) = − 1
4πi

f0(ζ)

(ζ − α)R(ζ)+

dζ

ˆγm

and their complex conjugates, where the velocity coincides with (1.6). In the genus
zero case there is only one Tsarev equation (2.12)

(4.4)

∂ ¯αw
w − ¯w

=

∂ ¯αV
V − ¯V

and its complex conjugate, that can be shown true by immediate calculation. Thus,
we proved that α, ¯α satisfy the corresponding genus zero Whitham equations (1.6).
In fact, (4.1) and its complex conjugate represent the hodograph solution to the
Whitham equations (1.6).

According to (3.7) and (3.10), in the genus zero case

(4.5)

h(z) =

R(z)
2πi

f (ζ)

(ζ − z)R(ζ)+

dζ,

ˆγm

(cid:73)

as there are no complementary arcs and the constants W0 can be choosen as zero.
Using

(4.6)

and (4.5), we obtain

(4.7)

∂
∂α

R(z)
R(ζ)

=

1
2

(z − α)(ζ − α)

ζ − z

∂
∂α

h(z) =

R(z)
2(z − α)

· h(ζ)
R(ζ)

R(z)
R(ζ)

(cid:12)(cid:12)(cid:12)(cid:12)ζ=a

and its complex conjugate. Since, according to (4.1), the last fraction is equal to
zero, we obtain

(4.8)

∂
∂α

h(z) ≡ 0 ⇔ modulation equations.

According to (4.8) and (3.6), we have

(4.9)

h(z) = h(z; x, t, α) = xhx(z) + tht(z) + h0, where h0 =

and

(cid:73)

ˆγm

R(z)
2πi

f0(ζ)

(ζ − z)R(ζ)+

dζ

hx(z) = 2R(z), ht(z) = 2(z + a)R(z)

(4.10)
were calculated in [30]. Here a = (cid:60)α and hx, ht are partial derivatives in the
corresponding variables, which, according to (4.8), coincide with “full” derivatives
on the solutions of modulation equations α = α(x, t). Obviously,

(4.11)

∂xht ≡ ∂thx,

and one can check directly that this condition is equivalent to to the modulation
equation (4.1). Moreover, dhx, dht are meromorphic diﬀerential of the second kind
on R with the only poles at ∞± and, according to (2.2),
(4.12)

dp = dhx, dq = dht.

Thus, p = hx(z), q = ht(z) are primitive functions for the meromorphic diﬀerentials
dp, dq, and h(z) is a potential for p, q. So, we come to the conclusion that the

14SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

topology of zero level curves of the imaginary part of the potential for p, q that
is deﬁned by a particular solution, determines the change of genus of Whitham
equations.

5. Determinantal formula for g when f0(z) is real analytic on an

interval of R

Consider the case when the (generally piece-wise) analytic function f0(z) does
not have a jump on some interval I ⊂ R. Let us assume for the moment that all the
branchpoints αj in the upper half-plane have distinct real parts Then, deforming
the main and complementary arcs, as shown in Figure 1, Right, we can reduce the
RHP (3.5) for g(z) to the equivalent RHP with jumps along the vertical contours
˜γj with the branchpoints ¯αj, αj, j = 0, . . . , N :

g+ + g− = f + ˜ηj on the vertical contour ˜γj, j = 0,··· , N

g(z) is analytic in ¯C \ ∪˜γj,

(5.1)

where the real constants ˜η2j are expressed as diﬀerences of constants W, Ω on the
neighboring main and complementary arcs. For example, we have ˜η2j = Wj −Ωj+1,
˜η2j+1 = Wj+1 − Ωj+1 for the conﬁguration, shown on Figure 1, Right. The g
functions, deﬁned by the RHPs (3.5) and (5.1) coincide outside the region, encircled
by the “old” main and complementary arcs and “new” vertical cuts (called bands),
see Figure 1, Right. Inside this region, the “new” g(z) coincides with: the “old” g(z)
up to appropriate real constant Ωj on the positive (left) side of any two neighboring
bands ˜γ; the values of the “old” g(z) from the second sheet of R up to appropriate
real constant Wj on the negative (right) side of any two neighboring bands ˜γ (note
the opposite orientation of the neighboring bands). Thus, the modulation equations
(3.12) remains valid for the “new” g, so that either RHP (3.5) or RHP (5.1) can
be used to calculate the branchpoints αj, the Whitham equations, conservation
equations, etc.

Introducing now ˜g = g − ˜η0

2 , we obtain the RHP

˜g+ + ˜g− = f + ηj on the band ˜γj, j = 0,··· , 2n

˜g(z) is analytic in ¯C \ γ,

(5.2)
where η2j = ˜η2j − ˜η0. In the conﬁguration of Figure 1, Right, η2j = Wj −Ωj+1 +Ω1,
η2j+1 = Wj+1 − Ωj+1 + Ω1. The constants η = (η1, . . . , η2n) are exactly the
constants from the argument of the multi-phase nonlinear wave solution (given
through the Riemann Theta function) of the model problem, see [30], Section 8.
They are also introduced in (1.4) as fundamental phases. With a mild abuse of
notation, we will use g(z) instead of ˜g(z) below and use R to denote the hyperelliptic
Riemann surface with branchcuts along ˜γj. Here and henceforth we also assume
that all the bands are oriented upwards. This orientation does not change any jump
conditions (5.2).
Remark 5.1. The vertical branchcuts ˜γj of R can be bent to avoid intersection of
diﬀerent ˜γj, ˜γk when (cid:60)αj = (cid:60)αk. They can also be appropriately bent to intersect
R within the interval I ⊂ R, where f0(z) is real analytic.

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM15

.

Example 5.1. In the case of the box potential, the piece-wise analytic function
f (z) is deﬁned by

see [18], where ν(z) =(cid:112)z2 + q2. The number of the bands depends on the particular

f (z) = 2tz2 + 2z(x − L) + 4kLν(z) on ˜γ2k ∪ ˜γ2k+1,

(5.3)

values of (x, t).

In the case of genus not exceeding one, the g-function, deﬁned by (5.2), coincides
with the one from [17] up to a real constant. By Sokhotski-Plemelj formula, we
have

 N(cid:88)
(cid:112)(z − αj)(z − ¯αj), ˆ˜γj denotes the negatively (clockwise) ori-

where R(z) =(cid:81)2n

(ζ − z)R(ζ)

(ζ − z)R(ζ)

 ,

R(z)
2πi

2g(z) =

f (ζ)dζ

(cid:73)

(cid:73)

(5.4)

ηjdζ

∪ˆ˜γk

j=1

ˆ˜γj

+

j=0

ented loop around ˜γj and f (z) is analytically continued from ˜γj to ˆ˜γj. We assume
the loops ˆ˜γj do not intersect each other. With a mild abuse of notation, we will
keep using ˆγ instead of ˆ˜γ.

The N real constants ηj, deﬁned by the requirement that g from (5.4) is analytic

at inﬁnity, satisfy the system of N real linear equations

(5.5)

1
2πi

ζ kf (ζ)
R(ζ)

dζ +

1
2πi

∪ˆγj

dζ = 0

k = 0, 1,··· , N − 1.

(cid:73)

(cid:73)

N(cid:88)

j=1

ˆγj

ηjζ k
R(ζ)


(cid:72)
(cid:72)

dζ

R(ζ)

ˆγ1

···

dζ

R(ζ)

···
···
···

(cid:72)
(cid:72)

ˆγ1

ˆγN



ζN−1dζ
R(ζ)
···
ζN−1dζ
R(ζ)

It is well known that the matrix of this system

(5.6)

D =

ˆγN
is invertible and its inverse matrix

(5.7)

D−1 = (κm,j)

consists of the coeﬃcients of the normalized holomorphic diﬀerentials

κN,jzN−1 + ··· + κ1,j

(5.8)

of the Riemann surface R, deﬁned by(cid:72)

ωj(z) =

R(z)

dz =

pj(z)dz

R(z)

, j = 1, . . . , N

ωk = δmk, see (2.6).

Consider now the determinant
dζ

(5.9)

K(z) =

×

1
2πi

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:72)

R(ζ)

ˆγ1

···

dζ

R(ζ)
f (ζ)dζ
R(ζ)

ˆγN
∪ˆγj

(cid:72)
(cid:72)

ˆγ1

(cid:72)

ˆγm

···
···
···
···

ζN−1dζ
R(ζ)
···
ζN−1dζ
R(ζ)

ˆγN
∪ˆγj

ζN−1f (ζ)dζ

R(ζ)

(cid:72)
(cid:72)
(cid:72)

ˆγ1

ˆγN
∪ˆγj

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) .

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
f (ζ)dζ
(ζ−z)R(ζ)

dζ

Multiplying the j-th row by ηj and adding it to the last row for each j = 1, . . . , N ,
we obtain, according to (5.4) and (5.5),

(5.10) 2g(z) =

R(z)

|D| K(z), z ∈ S, h(z) − ηj =

R(z)
|D| K(z), z inside the loop ˆγj,

16SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

where S is a region in C, consisting of the points that are outside any loop ˆγj,
j = 0, . . . , N .
Note that

(5.11)

K(z) =

h(z) − ηj
R(z)

|D|

is analytic inside the loop ˆγj. Thus, according to (5.10), (5.9), the modulation
equations for all movable branchpoints αk become

(5.12)

K(αk) = 0.

In the case of distinct branchpoints αj, considered in the paper, we have K(z)
having a simple zero at every movable branchpoint αk.

Equation (5.10) allows us to represent g(z) near z = ∞ as

(5.13)

Indeed, expanding R(z) = zN +1(cid:80)∞

g(z) =

j=0

(5.14)

ˆKm =

−1
4πi|D|

∞(cid:88)

j=0

ˆKjz−j, where

j=0

gjz−j.

2|D| = z−1(cid:80)∞
(cid:72)
(cid:72)

ζN−1dζ
R(ζ)
···
ζN−1dζ
R(ζ)

ˆγ1

ζN−1f (ζ)dζ

ˆRjz−j, K(z)
···
···
···
···

ˆγN
∪ˆγj

(cid:72)

(cid:72)

R(ζ)

(cid:72)
(cid:72)

ˆγ1

ζN +mdζ

R(ζ)

···

ζN +mdζ

R(ζ)

ˆγN
∪ˆγj

ζN +mf (ζ)dζ

R(ζ)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ,

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:72)

dζ

R(ζ)

ˆγ1

···

dζ

R(ζ)
f (ζ)dζ
R(ζ)

ˆγN
∪ˆγj

= 4πi [βmt + κN,mx] − Υm,

N(cid:88)

k=0

(cid:60)αk + κN−1,m, Υm = −

(cid:73)

f0(ζ)pm(ζ)dζ

∪ˆγj

R(ζ)

.

we obtain

(5.15)

g(z) = zN

∞(cid:88)

(

j(cid:88)

j=0

m=0

ˆRm ˆKj−m)z−j.

Note that (5.14) was obtained by factoring −z−1 from the last column of (5.9)
and expanding (1 − ζ
z )−1. The condition that g(z) = O(1) at inﬁnity implies
that the ﬁrst N coeﬃcients in (5.15) are zeroes and we obtain (5.13), where gj =

(cid:80)j+N

ˆRm ˆKj+N−m.

m=0
We can also use (5.9) to calculate the fundamental phases ηj. Indeed, taking the

proper linear combinations of the ﬁrst N columns of K in (5.9), we obtain

···
···
···
···

(cid:72)

∪ˆγj

0
···
1

f (ζ)pN (ζ)dζ

R(ζ)

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
f (ζ)dζ
(ζ−z)R(ζ)

dζ

ˆγ1

ˆγN
∪ˆγj

(cid:72)
(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) ,

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:73)

(cid:72)

1
···
0

∪ˆγj

f (ζ)p1(ζ)dζ

R(ζ)

f (ζ)pm(ζ)dζ

∪ˆγj

R(ζ)

(5.16) K(z) =

|D|
2πi

×

which implies that

(5.17)

ηm = −

where (see (3.6))

(5.18)

βm = κN,m

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM17

Comparing (5.17) with (2.13) one can see that the phases Υm in (5.17) coincide
with the “modulation phase shifts” introduced in Section 2 in order to provide con-
sistency of the “torus” phases ηj linearly depending on x and t with the kinematic
deﬁnitions (2.10) of the local wavenumbers and frequencies. These phase shifts can
be viewed as the key objects of the modulation analysis as they generate via (2.15)
the generalized hodograph solution to the Whitham equations. The RHP approach
oﬀers a direct route to ﬁnding the phases Υm in terms of the scattering data f0
of the initial potential, thus enabling one to circumvent the complicated matching
regularization procedure. In particular, for the box potential we have

(5.19)

Υm = 4L

To calculate (5.17)- (5.19) we used expansions

iπκN,m +

(cid:34)
(cid:73)
N(cid:88)
= z−N−1 + (cid:60)(cid:88)

k=0

1

R(z)

[ k
2 ]pm(ζ)ν(ζ)dζ

R(ζ)

ˆγk

αjz−N−2 + . . .

(cid:35)

.

(5.20)

(2tz2 + 2xz)pj(z) = 2tκN,jzN +1 + [2xκN,j + 2tκN−1,j] zN + . . . .

In the next section we will show that expressions for Υm in (5.18) indeed generate,
via (2.15), the required hodograph solution to the Whitham equations.

6. Whitham equations for movable branchpoints and their solutions

Theorem 6.1. Let α denote an arbitrary branchpoint αj, j = 0, 1, . . . , N , or their
complex conjugate, in the set of 2N + 2 distinct branchpoints. Then the following
∂α ≡ 0 for all z ∈ C,
statements are equivalent: 1) K(α) = 0; 2) ∂(cid:126)η
where (cid:126)η = (η1, . . . , ηN ).

∂α = 0; 3) ∂g(z)

Proof. Combining (5.4), (5.10), (5.9) with the identity

(cid:20)

(cid:21)

∂
∂α

R(z)

(ζ − z)R(ζ)

= −

R(z)

2(z − α)(ζ − α)R(ζ)

,

(6.1)

we obtain

(6.2)

(6.3)

(6.4)

2

∂g(z)

∂α

= − R(z)K(α)

2(z − α)|D| +

R(z)
2πi

∂ηj
∂α

dζ

(ζ − z)R(ζ)

,

ˆγj

(cid:73)

N(cid:88)

j=1

where z is outside all the loops ˆγj.

Equation (5.13) shows that

Let K(α) = 0. Then (6.3) implies the system of linear equations

∂g(z)

∂α

is analytic at ∞.

(cid:73)

N(cid:88)

j=1

∂ηj
∂α

ˆγj

ζ kdζ
R(ζ)

= 0, k = 0, 1 . . . , N − 1

for ∂(cid:126)η
∂α . Since the matrix D of this system is invertible, see (5.7), and the right
hand side is zero, the system (6.4) has only zero solution. Hence, we proved that
1) implies 2). Similarly, (6.3) combined with ∂(cid:126)η
∂α = 0 imply 3), that is, 2) implies
3).

18SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

Let us now assume 3), that is, ∂g(z)

α the jump conditions in (5.2) (away from the branchpoints), we obtain ∂(cid:126)η
Now 1) follows from (6.2).

∂α ≡ 0 for all z ∈ C. Then, diﬀerentiating in
∂α = 0.
(cid:3)

Here and henceforth we assume that the modulation equations K(αj) = 0 and
their complex conjugate hold for all movable branchpoints αj. As an immediate
consequence of Theorem 6.1, we obtain the following corollary.

Corollary 6.1. For any j = 1, . . . , N we now have (2.5), namely
(6.5)

d
dx

ηj =

∂
∂x

ηj = 4πiκN,j = kj,

d
dt

ηj =

∂
∂t

ηj = 4πi

κN,j

(cid:60)αk + κN−1,j

(cid:32)

N(cid:88)

k=0

(cid:33)

= ωj,

where d

dx , d

dt denote full derivatives and kj, ωj are given by (1.4).

The corollary follows directly from Theorem 6.1 and (5.17), (5.18). One can see
that expressions (6.5) agree with the kinematic relations (2.10), which are intro-
duced in the modulation theory as deﬁnitions of the local wavenumbers kj and the
local frequencies ωj. Moreover, Theorem 6.1 implies the stationary phase condi-
tions (2.16) that can be written in the form of hodograph equations (2.15). As
earlier, the conservation of waves equations (2.8) follows from Clairaut’s theorem.

Corollary 6.2. If all the branchpoints αj, j = 0, 1, . . . , N , and their complex
conjugates are distinct, then

(6.6)

d
dx

g(z; x, t) =

dx of g denotes the “full” derivative in x that include(cid:80)

g(z; x, t) =

g(z; x, t),

∂
∂t

g(z; x, t),

(cid:16) ∂

∂
∂x

d
dt

where d
The same holds for d

dt of g.

j

∂αj

∂αj
∂x + ∂
∂ ¯αj

∂ ¯αj
∂x

(cid:17)

.

According to (5.10) and Corollary 6.2,

(6.7)

2

d
dx

g(z; x, t) =

R(z)
|D|

∂
∂x

K(z; x, t), 2

d
dt

g(z; x, t) =

R(z)
|D|

∂
∂t

K(z; x, t),

where z is outside all of the loops ˆγj and
(6.8)

h(z; x, t) − (ηj)x =

d
dx

R(z)
|D|

∂
∂x

K(z; x, t),

h(z; x, t) − (ηj)t =

d
dt

R(z)
|D|

∂
∂t

K(z; x, t),

where z is inside any loop, see (3.10). Then, direct calculations show that

(6.9)

∂
∂x

K(z) = 2

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

R(ζ)

ˆγ1

···

dζ

R(ζ)

ˆγN

···
···
···

(cid:72)
(cid:72)

ζN−2dζ
R(ζ)
···
ζN−2dζ
R(ζ)

ˆγ1

ˆγN

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) +

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)

dζ

ˆγ1

ˆγN

2z|D|
R(z)

χS(z)

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM19

and

(6.10)

∂
∂t

K(z) = 2

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

R(ζ)

ˆγ1

···

dζ

R(ζ)

ˆγN

(cid:72)
(cid:72)

ˆγ1

ˆγN

···
···
···

ζN−3dζ
R(ζ)
···
ζN−3dζ
R(ζ)

2N(cid:88)

+2

j=0

(cid:72)
(cid:72)

ˆγ1

ˆγN

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)

dζ

(cid:60)αj

∂
∂x

K(z) +

(cid:72)
(cid:72)

ˆγ1

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

ζN−1dζ
R(ζ)
···
ζN−1dζ
R(ζ)

χS(z) .

ˆγN

2z2|D|
R(z)

where χS(z) denotes the characteristic function of the set S, which contains all the
points of ¯C outside the loops. Since we will evaluate ∂
∂t K(z) mostly at the
branchpoints, we should disregard the last terms in (6.9), (6.10) in the formulae
below.

∂x K(z), ∂

Lemma 6.1. Functions ∂
only poles at ∞± and attaining the values
(6.11)

∂x h(z; x, t), ∂

hx(αj) = hx(¯αj) = (ηj)x, ht(αj) = ht(¯αj) = (ηj)t, j = 0, 1, . . . , N,

∂t h(z; x, t) are meromorphic on R with the

where η0 = 0.

Proof. According to (6.7) and (6.9), (6.10), functions ∂
∂t g(z; x, t) are
analytic on S, where analyticity at z = ∞ can be shown by diﬀerentiating (5.13).
Let us collapse the loops ˆγj onto the bands ˜γj, j = 0, . . . , N , that are the branchcuts
of R. Then ∂
Let us ﬁx some z ∈ ˜γj and denote by g±(z), h±(z) the limiting values of g, h as

∂t g(z; x, t) will be analytic on S = ¯C \ ∪∞

∂x g(z; x, t), ∂

∂x g(z; x, t), ∂

0 ˜γj.

we collapse ˆγj onto ˜γj. Then, according to (6.7)-(6.10),

(6.12)

2(gx)+ − [(hx)+ − (ηj)x] = 2z + (ηj)x, on ˆγj, to the left of ˜γj
2(gx)− − [(hx)− − (ηj)x] = 2z + (ηj)x, on ˆγj to the right of ˜γj,
(hx)+ − (ηj)x + (hx)− − (ηj)x = 0, on ˜γj,

so, adding these jumps, we obtain

(6.13)

Similarly,

(6.14)

(gx)+ + (gx)− = 2z + (ηj)x on the band ˜γj, j = 0,··· , N .

(gt)+ + (gt)− = 2z2 + (ηj)t on the band ˜γj, j = 0,··· , N .

Note also that, according to (6.7)-(6.10), the limiting values (gx)±, (gt)± on the
branchcuts ˜γj are continuous and bounded functions. So, gx, gt satisfy the RHPs
similar to (5.2), and, correspondingly, can be written as
(6.15)

(ηj)xdζ

(ζ − z)R+(ζ)

,

∂g(z)

∂t

= z2 +

R(z)
4πi

(ηj)tdζ

(ζ − z)R+(ζ)

.

(cid:73)

N(cid:88)

j=1

ˆγj

= z +

R(z)
4πi

∂g(z)

∂x

Thus,

(cid:73)

N(cid:88)

j=1

ˆγj

∂h(z)

∂g(z)

∂h(z)

∂g(z)

− 2z,

(6.16)
are meromorphic on R with the only poles at ∞±. Equations (6.11) follow from
(cid:3)
(6.8).

∂x

∂x

∂t

∂t

=

=

− 2z2

20SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

This lemma could also be proven using the fact that the RHP (5.2) for g(z)
dt , because the boundary values g±, as well as (gx)±, (gt)±

dx , d

commutes with d
belong to L2

loc along the jump contours ∪N
In the particular case of N = 2, we have

j=0˜γj.

(6.17)

and

(6.18)

∂
∂x

∂
∂t

K(z) = 2

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

K(z) = −2

ˆγ1

dζ

(ζ−z)R(ζ)
(ζ−z)R(ζ)

dζ

dζ

R(ζ)

dζ

R(ζ)

ˆγ1

ˆγ2

(ζ−z)R(ζ)
(ζ−z)R(ζ)

dζ

ˆγ1

ˆγ2

ζdζ
R(ζ)
ζdζ
R(ζ)

ˆγ1

ˆγ2

(cid:60)αj

∂
∂x

K(z)

(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

ˆγ2

(cid:72)
(cid:72)
(cid:20) ∂ ln|D|

∂α

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:72)
(cid:72)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) + 2
(cid:21)

2(cid:88)

j=0

Lemma 6.2. Let α denote any movable αj, j = 0, 1, . . . , N , or its complex conju-
gate, and the modulation equations (5.12) hold. Then

(6.19)

∂K(z)

∂α

=

1

+

2(z − α)

K(z).

In particular, if β denote another movable branchpoint, then

(6.20)

K(β) = 0 if α (cid:54)= β and

∂
∂α

∂
∂α

K(α) =

K(cid:48)(z)|z=α.

1
2

Proof. Formula (6.19) a direct consequence of Theorem 6.1 and (5.10), whereas
(cid:3)
(6.20) follows from (5.9), (5.12) and analyticity of K(z) at z = αj.

As a consequence of Lemma 6.2 and the modulation equations (5.12), we obtain

(6.21)

∂K(αj)

∂αj

(αj)x = − ∂
∂x

K(αj),

∂K(αj)

∂αj

(αj)t = − ∂
∂t

K(αj) ,

for any movable branchpoint αj and its complex conjugate. Thus, we obtain the
corresponding Whitham partial diﬀerential equations

(6.22)

(αj)t = Vj(α, ¯α)(αj)x, where Vj(α, ¯α) =

∂
∂t K(αj)
∂
∂x K(αj)

as it was stated in (1.5), Section 1.

We also obtain the ordinary diﬀerential equations

(6.23)

∂t(αj) = − 2∂tK(αj)
K(cid:48)(αj)

, ∂x(αj) = − 2∂xK(αj)
K(cid:48)(αj)

,

for (time) trajectories and (space) isochrones of any movable branchpoint. Note
that, according to Lemma 6.2, (αj)x, (αj)t are bounded provided that all the
branchpoints are distinct.

Using the fact that f (z) in the last row of the determinant K in (5.9) is linear
in x, t, we can rewrite the modulation equations (5.12) for movable singularities αj
and their complex conjugates as

(6.24)

Kx(αj)x + Kt(αj)t + K0(αj) = 0,

where K0(z) is obtained from K(z) by replacing f (ζ) with f0(ζ). Equation (6.24)
is another form of the hodograph equations (see (2.11))

(6.25)

x + Vjt = wj, where Vj =

Kt(αj)
Kx(αj)

and wj = − K0(αj)
Kx(αj)

.

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM21

Using (5.16), we obtain

Kx(z) = −2|D| N(cid:88)
Kt(z) = −2|D| N(cid:88)

j=1

κN,j

(cid:73)
(cid:32)
κN,j(cid:60) N(cid:88)

ˆγj

j=1

k=1

(6.26)

dζ

(ζ − z)R(ζ)

dζ,

αk + κN−1,j

(cid:33)(cid:73)

ˆγj

dζ

(ζ − z)R(ζ)

dζ.

Then, according to (6.25), we obtain the following new expressions for the charac-
teristic velocities

= (cid:60) N(cid:88)

k=1

αk +

(cid:72)

(cid:80)N
(cid:80)N

k=1

k=1

(cid:72)

κN−1,k
κN,k

dζ

(ζ−αj )R(ζ) dζ
ˆγk
(ζ−αj )R(ζ) dζ

dζ

ˆγk

(6.27)

Vj =

(αj)t
(αj)x

=

Kt(αj)
Kx(αj)

in terms of the meromorphic diﬀerentials on R. Tsarev equations (2.12) for wj
follow immediately from (6.25).

Lemma 6.3. If

(6.28)

p = − 1
2

hx = z − gx(z), q = − 1
2

ht = z2 − gt(z)

then diﬀerentials dp, dq are fundamental meromorphic diﬀerentials, uniqely deter-
mined by the conditions a)-c) at the beginning of Section 2, see (2.2), (2.3).

Proof. According to Lemma 6.1, p, q are meromorphic on the hyperelliptic surface
R, with the only poles at ∞±. Then

dp = − 1
2

hxzdz = (1 − gxz(z))dz, dq = − 1
2

(6.29)
are meromorphic diﬀerentials of the second kind with the only poles at ∞± satis-
fying (2.2).
the A-cycles of R and

To prove the normalization (2.3) of dp, dq, we notice that ˜γj, j = 1, . . . , N are

htzdz = (2z − gtz(z))dz

(6.30)

dp = −

hxzdz = hx(¯αj) − hx(αj) = 0,

˜γj

¯αj

the latter follows from (6.11). Similar argument based on (6.8), (6.10) works for
(cid:3)
dq.

Corollary 6.3. The generating conservation equation ∂tdp = ∂xdq, see (2.1), is
obviously true, as now it reduces to hxzt = htzx (or gxzt = gtzx).

(cid:73)

(cid:90) αj

Since the cycle Bj is a path, connecting αj with α0 and returning back on the

second sheet of R, we obtain (2.4) by

(cid:73)
(cid:73)

Bj

(cid:90) α0
(cid:90) α0

αj

dp = −

hxzdz = hx(αj) − hx(α0) = (ηj)x = kj,

dq = −

htzdz = ht(αj) − ht(α0) = (ηj)t = ωj,

(6.31)

Bj

αj

where we used (6.11).

22SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

Finally, to prove (2.7), we notice that at any movable branchpoint αj (and its

c.c.)
(6.32)

(R2(z))(cid:48)
2|D|R(z)

Kx(αj) + O(z − αj)

1

hxz(z) =
as z → αj. Then, according to (6.29), (6.32) and (6.22),

2 , htz(z) =

(R2(z))(cid:48)
2|D|R(z)

Kt(αj) + O(z − αj)

1

2 ,

(6.33)

So, we proved (2.7).

dq
dp

=

htz
hxz

=

Kt(αj)
Kx(αj)

= Vj.

(cid:12)(cid:12)(cid:12)(cid:12)αj

7. Determinantal formula for g when f0(z) has a jump on R

In the case when n f0(z) has a jump on R we have to work with the RHP (3.5)
for the g-function. Similarly to (5.5), the real constants Wj, Ωj ∈ R, j = 1, 2,··· , n
in (3.7) are deﬁned by
(7.1)

Wj
2πi

ˆγm,j

ζ kdζ
R(ζ)

+

Ωj
2πi

ζ kdζR(ζ) =

1
2πi

ˆγc,j

ζ kf (ζ)dζ

R(ζ)

k = 0, 1,··· , 2n−1.

(cid:73)

n(cid:88)

j=1

n(cid:88)

j=1

(cid:73)

n(cid:88)

j=1

ˆγm,j

This is a system of N = 2n real linear equations for 2n real unknowns Wj, Ωj that
can be written as

(7.2)
where (cid:126)W , (cid:126)Ω ∈ Rn are row vectors with components Wj, Ωj respectively, (cid:126)f ∈ R2n
denotes the row vector of the right hand sides of (7.1) multiplied by 2πi, and

( (cid:126)W , (cid:126)Ω)D = (cid:126)f ,

It was shown in [28] that if all the branchpoints are distinct then |D| (cid:54)= 0.

Let us assume, for simplicity, that the function f0(z) is analytic in some region

containing all the γ+

m,j Introducing the determinant K(z) = K(z; x, t) by

(cid:72)
(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,n

ˆγm,1

R(ζ)

ζ2n−1dζ
···
ζ2n−1dζ
R(ζ)
ζ2n−1dζ
···
ζ2n−1dζ
ˆγc,n
ζ2n−1f (ζ)dζ

R(ζ)

R(ζ)

ˆγc,1

ˆγ

R(ζ)

(cid:72)
(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

ˆγc,n

ˆγ

dζ

dζ

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
f (ζ)dζ
(ζ−z)R(ζ)

dζ

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

,

dζ

ˆγm,1

R(ζ)

···

ˆγm,n

dζ

R(ζ)
dζ

ˆγc,1

R(ζ)

···

dζ

ˆγc,n

R(ζ)
f (ζ)dζ
R(ζ)

ˆγ

···
···
···
···
···
···
···

(7.4)

K(z) =

×

1
2πi

(cid:12)(cid:12)(cid:12)(cid:12)αj

(cid:73)


(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

(cid:72)
(cid:72)
(cid:72)
(cid:72)
(cid:72)

(7.3)

D =

(cid:72)
(cid:72)
(cid:72)
(cid:72)

dζ

ˆγm,1

R(ζ)

···

ˆγm,n

dζ

R(ζ)
dζ

ˆγc,1

R(ζ)

···

dζ

R(ζ)

ˆγc,n

···
···
···
···
···
···

(cid:72)
(cid:72)
(cid:72)
(cid:72)

R(ζ)

ζ2n−1dζ
···
ζ2n−1dζ
R(ζ)
ζ2n−1dζ
···
ζN−1dζ
R(ζ)

R(ζ)

ˆγm,1

ˆγm,n

ˆγc,1

ˆγc,n



SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM23

we observe that, according to (7.2), (3.7),
(7.5)

R(z)

2g(z) =

|D| K(z), z outside ˆγ, h(z) − ηj =

R(z)
|D| K(z), z inside ˆγ but outside ˆγj
for all j = 1, . . . , N . here the negatively oriented contour ˆγ is going around all the
all main arcs (it is pinched to γm,0 at µ, where {µ} = γm,0 ∩ R).

Combining this considerations with (4.1), we obtain a new form of modulation

equations

(7.6)

K(αj) = 0, j = 0, 1,··· , 4n + 1 .

We can now state Theorem (6.1) for the g-function, deﬁned by the RHP (3.5).

Theorem 7.1. Let α denote an arbitrary branchpoint αj, j = 0, 1, . . . , 4n + 1, in
the set of 4n+2 distinct branchpoints. Then the following statements are equivalent:
1) K(α) = 0; 2) ∂( (cid:126)W ,(cid:126)Ω)t

∂α ≡ 0 for all z ∈ C.

∂α = 0; 3) ∂g(z)

The proof of the theorem is almost identical to that of Theorem (6.1). As an

immediate consequence of Theorem (7.1), we obtain

(7.7)

d
dx

h(z; x, t) =

R(z)
|D|

∂
∂x

K(z; x, t),

d
dt

h(z; x, t) =

R(z)
|D|

∂
∂t

K(z; x, t),

where z is inside ˆγ but outside all the loops ˆγm,j, ˆγc,j. Without any lost of generality,
we can take limit when contour ˆγ in (7.4) becomes inﬁnitely large. Then, direct
calculations show that

(cid:72)
(cid:72)
(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

ˆγm,1

R(ζ)

···

ˆγm,n

dζ

R(ζ)
dζ

ˆγc,1

R(ζ)

···

dζ

R(ζ)

ˆγc,n

···
···
···
···
···
···

(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

R(ζ)

ζ2n−2dζ
···
ζ2n−2dζ
R(ζ)
ζ2n−2dζ
···
ζ2n−2dζ

R(ζ)

(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

ˆγc,n

R(ζ)

ˆγc,n

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
(ζ−z)R(ζ)
···
(ζ−z)R(ζ)

dζ

dζ

(7.8)

and
(7.9)

K(z) = −2

∂
∂t

∂
∂x

K(z) =

(cid:72)
(cid:72)
(cid:72)
(cid:72)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

dζ

ˆγm,1

R(ζ)

···

ˆγm,n

dζ

R(ζ)
dζ

ˆγc,1

R(ζ)

···

dζ

R(ζ)

ˆγc,n

···
···
···
···
···
···

(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

R(ζ)

ζ2n−3dζ
···
ζ2n−3dζ
R(ζ)
ζ2n−3dζ
···
ζ2n−3dζ

R(ζ)

(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

dζ

dζ

(ζ−z)R(ζ)
···
(ζ−z)R(ζ)
(ζ−z)R(ζ)
···
(ζ−z)R(ζ)

dζ

dζ

(cid:72)
(cid:72)
(cid:72)
(cid:72)

ˆγm,1

ˆγm,n

ˆγc,1

R(ζ)

ζ2n−1dζ
···
ζ2n−1dζ
R(ζ)
ζ2n−1dζ
···
ζ2n−1dζ

R(ζ)

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)

4n+1(cid:88)

+

j=0

αj

∂
∂x

K(z) .

ˆγc,n

R(ζ)

ˆγc,n

ˆγc,n

R(ζ)

Collapsing the loops ˆγm,j, ˆγc,j back to the main and complementary arcs γm,j, γc,j
respectively, we ﬁnd that hx(z) satisfy the RHP with jumps and asymptotics

(hx)+ + (hx)− = 2Wj on the main arc γm,j, j = 0,··· , n
(hx)+ − (hx)− = 2Ωj on the complementary arc γc,j, j = 0, 1,··· , n

hx = −2z + O(1) asz → ∞

(7.10)

.

24SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

The similar RHP is satisﬁed by ht(z). It also follows from (7.7), (7.8), (7.9) that
hx, ht are bounded at the branchpoints.

We can now deform contours γm,j, γc,j in the same way as we did in the beginning
of Section 5, to obtain jumps of hx, ht on N + 1 vertical bands ˜γj, j = 0, . . . , N ,
where N = 2n. These jumps 2(ηk)x, 2(ηk)t are given by (η2j)x = (Wj)x−(Ωj+1)x +
(Ω1)x, (η2j+1)x = (Wj+1)x − (Ωj+1)x + (Ω1)x and similar expressions for 2(ηk)t.
Solutions hx(z), ht(z) to these deformed RHPs are meromorphic functions on the
corresponding hyperelliptic surface R and their diﬀerentials, dp = − 1
2 hxzdz, dq =
− 1
2 htzdz, satisfy conditions a)-c) from Section 2. Thus, the results of Section 5 are
also valid in our case.

8. Phase transitions and characteristic velocities along breaking

curves

As we move in the (x, t) (physical) plane along some (smooth) curve , the
(movable) branchpoints αj = αj(x, t) move in the z (spectral) plane according
to the modulation (Whitham) equations. As they move, the function h(z; x, t) =
hN (z; x, t), where N denotes the genus, changes according to (5.10) (or (7.5)) and,
at some point (xb, tb) ∈ , called a breaking point, one (or more) of the inequalities
(3.11) can fail at a some point z0 (or at several points). Note that if z0 (cid:54)∈ R, then
(3.11) should also fail at ¯z0 due to Schwarz symmetry of hN . Assuming that hN (z)
is analytic at z0, we readily obtain that
(8.1)

z (z0) = 0 and (cid:61)hN (z0) = 0
hN

x and qN = − 1

form a system of 3 real equations for 4 real variables (x, t, z0) that determines the
If z0 ∈ γm,j, then two
breaking curve. The point z0 is called a double point.
new complementary arcs open at z0 and at ¯z0 as we cross the breaking curve and
the genus of R = R(x, t) increases by two. (Generically, it will increase only by
one if z0 ∈ R.) Similarly, if z0 ∈ γc,j, two new main arcs open at z0 and at ¯z0.
Moving along  through (xb, tb) in the opposite direction, we would observe two
branchpoints collide at the double point z0 and then disappear.
The function hN (z) = hN (z; x, t) is the potential function for the meromorphic
on R functions pN = − 1
t , whose diﬀerentials dpN , dqN de-
termine the system of Whitham equations. This potential function contains the
information about the particular fNLS solution. Changes of the dimension of this
system (in the genus of R) are caused by changes in the topology of zero level
curves of (cid:61)hN (z; x, t) = 0.
Examples 8.1. 1) As an example, consider the transition from genus zero to genus
two for the “sech” potential (initial data cosh−1− 2i
ε ), represented by f0 given by (3.4),
see Figure 2. This transition was studied in [30]. In this case, the double point z0 is in
the upper halfplane, (Figure 2, center), so the genus changes by two. The change in the
topology of zero level curves of (cid:61)h, associated with the break, is shown on Figure 2. Note
that h0(z; xb, tb) ≡ h2(z; xb, tb).
2) In the case of the box potential, the double point z0 ∈ R and, therefore, the genus

2 hN

2 hN

changes from zero to one ([17]).

We are now interested in the properties of the characteristic velocities at a double

point z0. Direct calculations ([30]) show that the Jacobian

(8.2)

(∂hN

z , ∂(cid:61)hN )
(∂z0, ∂t)

= |hN

zz(z0)|2(cid:61)hN

t (z0).

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM25

Figure 2. Left: Zero level curves of (cid:61)h0, pre-break. Center:
Zero level curves of (cid:61)h0; this is a breaking point in the transi-
tion from genus zero to two; Notice the appearance of the double
point. Right: Zero level curves of (cid:61)h2, post-break

(∂hN

z ,∂(cid:61)hN )
(∂z0,∂t)

If (xb, tb) is a the regular breaking point, then hN
it was proven in [29] that |(cid:61)hN

zz(z0) (cid:54)= 0. Let z0 (cid:54)∈ R. In this case
x (z0)| (cid:54)= 0. Thus, either the Jacobian
is nonzero at z0. Without any loss of generality, we
can assume that the Jacobian (8.2) is nonzero at z0. Then, there exists a unique
breaking curve t = t(x) passing through (xb, tb) and a unique curve z0(x) passing
through z0 at x = xb. Then, diﬀerentiating (8.1) along t(x), z0(x), we obtain

t (z0)| + |(cid:61)hN

z ,∂(cid:61)hN )
(∂z0,∂x)

or (∂hN

(cid:18)

(cid:19)

(8.3)

(cid:61)

hN
x + hN
t

dt
dx

= 0, hN
zz

dz0
dx

+ hN

xz + hN
tz

dt
dx

= 0.

Thus, the slope dt

dx of the breaking curve at xb and the velocity

(8.4)

V =

hN
tz
hN
xz

=

dqN
dpN

of the double point z0 are are given by
(8.5)

hN
zz
hN
xz

t

or

dt
dx

dt
dx

· dz0
dx + 1
dt/dx

, V = −

= −(cid:61)pN

= −(cid:61)hN
x(cid:61)hN
.
In the case z0 ∈ R, according to (8.1), hN (z) does not have a jump at z0 ∈ R.
Thus, it is natural to consider the case when hN (z) is analytic in a neighborhood of
z0. Then, (cid:61)hN ≡ 0 on R near z0, and the second condition in (8.1) becomes trivial.
But then, if zero level curves of (cid:61)hN are pinching R at z0, we have six level curves
of (cid:61)hN = 0 emanating from z0. Thus, we obtain new breaking curve conditions
(8.6)

(cid:61)qN , V = −

hN
z (z0) = 0 and hN

zz(z0) = 0,

dx + 1

hN

zzdz

dpN · dz0

dt/dx

which imply

(8.7)

V = − dx
dt

,

= − hN

zzz

dt
dx

dz0
dx + hN
hN
zzt

zzx

.

Thus, a real double point has a real velocity.

Examples 8.2. 1) In the transition from genus zero (with a movable branchpoint α =
a + ib) to a higher genus, the velocity V of the double point z0, according to (4.10), is
given by V = 2z0 + b2
z0−a , Using the large t asymptotics of z0 and of the breaking curve
from [31], we can show that in the case “sech” potential, of V (cid:54)∈ R.

−+++++++++++−−−−−−−−−−−−−−−−−−−−µ/2µ/2α−−−−−−−−0−++++++++++−−−−−−−−−−−−−−−−−−−−µ/2µ/2α−−−−−−−−0α =α24−++++++++++−−−−−−−−−−−−−−−−−−−−µ/2µ/2α−−−−−−−−0α α 4226SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

2) In the case of “box” potential, see Examples 3.1, the double point z0 ∈ R. The ﬁrst

equation in (8.6) becomes

(8.8)

4tz2

0 + 2(x − L)z0 + 2tq2 = 0,

whereas the second equation in (8.6) means that the discriminant of (8.6) is zero. Thus
we obtain the breaking curve (see [17], [10])

(8.9)

L − x

t

√

= 2

2q

and the double point

z0 =

q√
2

.

ν(z) , so that, according to (8.4), V =

Notice that the double point is stationary. Further direct calculations yield h0
zx = − 2z
h0
We now want to prove that if αj approaches a double point z0 then Vj approaches
Indeed, meromorphic diﬀerentials dp, dq on the Riemann

the velocity V of z0.
surface R of genus m ∈ N with poles at ∞± given by (6.29) can be written as

√

2q.

zt = − 4z2
ν(z) ,

(8.10)

dp =

P (z)
R(z)

dz, dq =

Q(z)
R(z)

dz

where P = P (z; (cid:126)α), Q = Q(z; (cid:126)α) are polynomials of degrees m + 1 and m + 2
respectively, where (cid:126)α ∈ C2m+2 denotes the set of 2m+2 distinct branchpoints of R.
Let (cid:126)α → (cid:126)β, where (cid:126)β ∈ C2m+2 denotes the set (cid:126)α after several pairs of branchpoints
collided into the corresponding double points (more complicated clustering is also
allowed) forming a singular Riemann surface, whose desingularization we denote
by R0. It was proven in [2] that Boutroux deformations of dp, dq are continuous in
(cid:126)α ∈ C2N +2 and
(8.11)

(z − zj)Q0(z; (cid:126)β),

(z − zj)P0(z; (cid:126)β),

(cid:89)

Q(z; (cid:126)α) =

P (z; (cid:126)α) =

lim
(cid:126)α→(cid:126)β

j

lim
(cid:126)α→(cid:126)β

(cid:89)

j

R0(z) dz are continuous limits of dp, dq on R0, which
where dp0 = P0(z;(cid:126)β)
is the Riemann surface for the radical R0, P0, Q0 are the corresponding polynomials
and the product goes over all the double points zj. Then, according to (8.10), (8.11),

R0(z) dz, dq0 = Q0(z;(cid:126)β)

(8.12)

lim
αj→z0

Vj = lim
αj→z0

dq
dp

= lim
αj→z0

Q(αj; (cid:126)α)
P (αj; (cid:126)α)

=

P0(z0; (cid:126)β)
Q0(z0; (cid:126)β)

=

dq0
dp0

(cid:12)(cid:12)(cid:12)(cid:12)z0

,

(cid:12)(cid:12)(cid:12)(cid:12)αj

the latter being the velocity of the double point z0.

Acknowledgements The work was supported in part by the Banﬀ International
Research Station, University of British Columbia, Vancouver, Canada. The work of
the ﬁrst author was supported in part by London Mathematical Society. The work
of the second author was supported in part by the Department of Mathematics,
University of Central Florida, Orlando, FL 32816-1364.

References

[1] E.D. Belokolos, A.I. Bobenko, V.Z. Enol’skii, A.R. Its and V.B. Matveev, Algebro-Geometric

Approach to Nonlinear Integrable Equations Berlin etc., Springer-Verlag, 1994

[2] M. Bertola and A. Tovbis. Meromorphic diﬀerentials with imaginary periods on degenerating

hyperelliptic curves. Analysis and Mathematical Physics, 5(1):1–22, 2015.

[3] J.C. Bronski and J. N. Kutz, Numerical simulation of the semi-classical limit of the focusing

nonlinear Schr¨odinger equation, Phys. Lett. A 254 (1999) 325 -336

[4] H.D. Ceniceros and F.-R. Tian, A numerical study of the semi-classical limit of the focusing

nonlinear Schr¨odinger equation, Phys. Lett. A 306 (2002) 25 - 34.

SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM27

[5] P. Deift, S. Venakides and X. Zhou New Results in the Small-Dispersion KdV by an Extension
of the Method of Steepest Descent for Riemann-Hilbert Problems, IMRN, 6, 285-299, 1997.
[6] B.A. Dubrovin and S.P. Novikov, Hydrodynamics of weakly deformed soliton lattices. Diﬀer-

ential geometry and Hamiltonian theory. Russian Math. Surveys, 44, 35-124, 1989.

[7] G.A. El, A.V. Gurevich, V.V. Khodorovskii and A.L. Krylov, Modulational instability and
formation of a nonlinear oscillatory structure in a focusing medium, Phys Lett A, 177, 357-
361, 1993.

[8] G.A. El, Generating function of the Whitham-KdV hierarchy and eﬀective solution of the

Cauchy problem, Phys. Lett. A., 222, 393-399 1996.

[9] G.A. El, A.L. Krylov and S. Venakides, Uniﬁed approach to KdV modulations, Commun.

Pure Appl. Math. 54, 1243-1270 2001.

[10] G.A. El, E.G. Khamis and A. Tovbis. Dam break problem for the focusing nonlinear

Schr¨odinger equation and the generation of rogue waves. arXiv:1505.01785. (2015)

[11] G.A. El and M.A. Hoefer, Dispersive shock waves and modulation theory, arXiv:1602.06163

(2016)

[12] T. Grava and F.-R. Tian, The generation, propagation, and extinction of multiphases in the

KdV zero-dispersion limit, Comm. Pure Appl. Math. 55, (2002) 1569-1639.

[13] A. V. Gurevich, L. P. Pitaevskii, Nonstationary structure of a collisionless shock wave, Sov.

Phys. JETP 38, (1974) 291–297.

[14] H. Flaschka, G. Forest and D.W. McLaughlin, Multiphase averaging and the inverse spectral
solutions of the Korteweg – de Vries equation, Comm. Pure Appl. Math. 33, 739-784, 1980.
[15] M.G. Forest and J.E. Lee. Geometry and modulation theory for periodic nonlinear
Schr¨odinger equation, in Oscillation Theory, Computation, and Methods of Compensated
Compactness, Eds. C. Dafermos et al, IMA Volumes on Mathematics and its Applications
2, Springer, N.Y., 1987.

[16] M. Hoefer and M. Ablowitz, Dispersive shock waves. Scholarpedia, 4(11) 5562, 2009.
[17] R. Jenkins, K. D. T.-R. McLaughlin. The semiclassical limit of focusing NLS for a family of

square barrier initial data. Comm. Pure Appl. Math., 67 246–320, 2014.

[18] R. Jenkins and A. Tovbis. Generation of multiphase waves from a barrier potential in the

semiclassical limit of the focusing nonlinear Schr¨odinger equation. In preparation

[19] S. Kamvissis, K. D. T.-R. McLaughlin, and P. D. Miller. Semiclassical soliton ensembles for
the focusing nonlinear Schr¨odinger equation, volume 154 of Annals of Mathematics Studies.
Princeton University Press, Princeton, NJ, 2003.

[20] A.M. Kamchatnov, New approach to periodic solutions of integrable equations and nonlinear

theory of modulational instability. Phys. Rep. 286, 199-270, 1997.

[21] P.D. Lax, Periodic solutions of the KdV equation, Comm. Pure Appl. Math., 28, 141 - 188,

1975.

[22] P. D. Lax, C. D. Levermore, The small dispersion limit of the Korteweg-de Vries equation:

1-3, Comm. Pure Appl. Math. 36, 253–290; 571–593; 809–830, 1983.

[23] P. D. Lax, C. D. Levermore, S. Venakides, The generation and propagation of oscillations in
dispersive initial value problems and their limiting behavior, in: A. Focas, V. E. Zakharov
(Eds.), Important Developments in Soliton Theory, Springer, Berlin, 205–241, 1994.

[24] J. C. Luke, A perturbation method for nonlinear dispersive wave problems, Proc. Roy Soc.

A.

292 403–412 1966.

[25] G. Lyng and P. Miller, The N -soliton of the focusing nonlinear Schr¨odinger equation for N

large, CPAM 60, 951-1026, 2006.

[26] S.P. Novikov, The periodic problem for the Korteweg - de Vries equation. I. Funktsional.

Anal. i Prilozhen. 8 54 - 56, 1974.

[27] M.V. Pavlov, Nonlinear Schr¨odinger equation and the Bogolyubov-Whitham method of av-

eraging, Theor. Math. Phys. 71, 351 1987.

[28] A. Tovbis and S. Venakides. Determinant form of the complex phase function of the steepest
descent analysis of Riemann-Hilbert problems and its application to the focusing Nonlinear
Schr¨odinger equation. Int. Math. Res. Not., rnp011, 2056–2080, 2009.

[29] A. Tovbis and S. Venakides, Nonlinear steepest descent asymptotics for semiclassical limit
of integrable systems: Continuation in the parameter space. Comm. Math. Phys., 295(1),
139–160, 2010.

[30] A. Tovbis, S. Venakides, and X. Zhou. On semiclassical (zero dispersion limit) solutions of
the focusing nonlinear Schr¨odinger equation. Comm. Pure Appl. Math., 57(7), 877–985, 2004.

28SEMICLASSICAL NLS: WHITHAM EQUATIONS AND THE RIEMANN-HILBERT PROBLEM

[31] A. Tovbis, S. Venakides, and X. Zhou. On long time behavior of semiclassical (zero dispersion)
limit of the focusing Nonlinear Schroedinger Equation: Pure radiation case, Comm. Pure
Appl. Math., 59, 1379-1432, 2006.

[32] S.P. Tsarev, On Poisson brackets and one-dimensional systems of hydrodynamic type, Soviet

Math. Dokl. 31, 488 1985.

[33] S. Venakides, The zero-dispersion limit of the Korteweg-de Vries equation with non-trivial

reﬂection coeﬃcient, Comm. Pure Appl. Math., 38 125–155 1985.

[34] S. Venakides, The Korteweg-de Vries equation with small dispersion: higher order Lax-

Levermore theory, Comm. Pure Appl. Math. 43 335–361, 1990.

[35] G.B. Whitham, Non-linear dispersive waves, Proc. Roy. Soc., A283, 238–291 1965.
[36] G.B. Whitham, A general approach to linear and non-linear dispersive waves using a La-

grangian, Journal of Fluid Mechanics, 22 273–283 1965.

[37] G.B. Whitham, Linear and Nonlinear Waves. Wiley–Interscience, New York, 1974.
[38] V. E. Zaharov and A. B. ˇSabat. Integration of the nonlinear equations of mathematical
physics by the method of the inverse scattering problem. II. Funktsional. Anal. i Prilozhen.,
13(3):13–22, 1979.

[39] X. Zhou, Zakharov-Shabat inverse scattering. In Scattering and inverse scattering in pure

and applied science, pages 1707–1716. Academic Press, London, 2002.

