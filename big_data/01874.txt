6
1
0
2

 
r
a

M
6

 

 
 
]
E
M

.
t
a
t
s
[
 
 

1
v
4
7
8
1
0

.

3
0
6
1
:
v
i
X
r
a

Instrumental Variable with Competing Risk

Model
Cheng Zheng

Joseph. J. Zilber School of Public Health, University of Wisconsin-Milwaukee, Milwaukee, WI

e-mail: zhengc@uwm.edu

and

Ran Dai

Department of Statistics, University of Chicago, Chicago, IL

and

Parameswaran Hari

Division of Hematology and Oncology, Medical College of Wisconsin, Milwaukee, WI

and

Mei-Jie Zhang

Division of Biostatistics, Medical College of Wisconsin, Milwaukee, WI

Abstract: In this paper, we discuss causal inference on the efﬁcacy of a treatment or
medication on a time-to-event outcome with competing risks. Although the treatment
group can be randomized, there can be confoundings between the compliance and the
outcome. Unmeasured confoundings may exist even after adjustment for measured co-
variates. Instrumental variable (IV) methods are commonly used to yield consistent
estimations of causal parameters in the presence of unmeasured confoundings. Based
on a semi-parametric additive hazard model for the subdistribution hazard, we pro-
pose an instrumental variable estimator to yield consistent estimation of efﬁcacy in
the presence of unmeasured confoundings for competing risk settings. We derived the
asymptotic properties for the proposed estimator. The estimator is shown to be well per-
formed under ﬁnite sample size according to simulation results. We applied our method
to a real transplant data example and showed that the unmeasured confoundings lead
to signiﬁcant bias in the estimation of the effect (about 50% attenuated).

Primary 62N01, 62N02, 62P10.
Keywords and phrases: Additive Hazard Model, Competing Risk, Instrumental Vari-
able, Survival Analysis.

1. Introduction

In clinical trials, randomization of the treatment group can only guarantee an unbiased
estimation of the intent to treat (ITT) effect. In most cases, the true efﬁcacy of a new
drug or treatment is of more interest. However, to yield a causal interpretation of the as-
sociation between the drug intake/treatment and the effect, we need to remove potential
confoundings between the compliance and the outcome. The assignment of treatments
and the compliance to the treatments are highly dependent on the interactions between

1

C. Zheng et al./Instrumental Variable with Competing Risk Model

2

the physician and the patients. It is often hard to make all confoundings controlled
by adjusting measured covariates. One important technique to handle the confound-
ing issues in causal inference is the use of instrumental variables (IV) [1], which was
ﬁrst introduced in econometric literatures and then applied in the ﬁeld of biomedical
sciences [2, 3]. The concept of instrumental variable had a srong inﬂuence on causal
inference studies and inspired methods such as mediation analysis [4] and Mendelian
randomization [5]. By deﬁnition, an instrumental variable is a variable that is related
to the exposure variable of interest but not directly linked to the outcome variable. For
example, researchers used children’s birthdates as an instrument to assess the effect of
education on earning [6] since this variable is correlated with years of education (the
exposure variable) but not directly associated with ﬁnal earnings (the response).

In this paper, we are interested in estimating the efﬁcacy of rituximab drug on dif-
fuse large B Cell Lymphoma (DLBCL) patients. The decision of whether to use the
drug depends on complicated factors and we are not able to fully control the treatment
process and remove the confoundings correspondingly. Since the FDA approval of rit-
uximab affects its use frequencies in clinical practice and the calendar time is highly
associated with the use of rituximab [7], we can consider the calendar time as an in-
strumental variable. This variable has an inﬂuence on the patients’ usage of rituximab,
but does not change rituximab’s drug effect.

In linear models, two commonly used instrumental variable estimators are two-stage
least squares (TSLS) [8] and generalized method of moments (GMM) [9]. The ﬁrst
method is easier to implement using the existing regression softwares while the second
is potentially more efﬁcienct when there are many instruments to use and when the
model is over-identiﬁed. To use instrumental variables in the context of time-to-event
data with censoring, Robins and Tsiatis [10] proposed an IV method to handle noncom-
pliance with the requirement that the censoring time is known (administrative censor-
ing), which was extended to proportional hazard model by Loeys and Goetghebeur[11].
IV methods that rely on other parametric model assumptions were also proposed [12].
Recently, Li et al. [13] proposed an IV based two-stage estimator for a semi-parametric
additive hazard model[14] and Chan [15] extended the TSLS method to allow exposure
dependent censoring.

Competing risks data are commonly encountered in biomedical research. In compet-
ing risks data analysis, we are often interested in studying the covariate effects on the
cumulative incidence function (CIF) of one speciﬁc cause of failure. Regression mod-
eling, such as Cox proportional hazards model, was considered as a standard approach
to model the cause-speciﬁc hazard function for each cause of failure [16, 17, 18, 19].
It is hard to summarize the covariate effects on CIF of a particular type of failure since
modeling of the cause speciﬁc hazards would result in a complex nonlinear relationship
for the CIFs. To bypass this difﬁculty, methods that directly model the subdistribution
hazard function of a speciﬁc cause were proposed[20, 21, 22]. However there is a gap
in handling confounding issues in competing risk data analysis. Scheike et al. [23, 24]
proposed a class of ﬂexible regression models, including multiplicative model and ad-
ditive model for competing risks data through a direct binomial regression modeling
approach. The idea for the construction of this model is natural and it is easy to accom-
modate the model assumptions with additive model in IV analysis for the competing
risks data. To ﬁll the gap, we extend the method of Li et al. [13] to the competing risks

C. Zheng et al./Instrumental Variable with Competing Risk Model

3

data analysis using an additive hazard subdistribution model.

In section 2, we present our proposed model followed by detailed assumptions and
estimation procedures. In section 3, the theoretical asymptotic results are provided. In
section 4, we show extensive simulation results and discuss the performance of our
proposed estimator for ﬁnite sample size compared with the simple additive hazard
model ﬁtting without using IV. In section 5, we apply our proposed method to a real
data example and compare our results with the original ﬁtting without using IV. In
section 6, we provide more discussions of the model and its extensions. The detailed
proofs can be found in the appendix.

2. Model

2.1. Notation

Consider a competing risk study with K types of failures. Let T and C denote the fail-
ure time and censoring time.  ∈ {1,··· , K} indicates the cause of failure. Consider
right censoring, we observe a composite outcome, T ∗ = min(T, C) and δ = I(T ≤
C). Denote Xe as exposure of primary interest. Denote X o ∈ Rp and X u ∈ Rq as
the observed and unobserved exogenous risk factors. Denote XI as the instrumental
variable. Here we begin with one dimension of Xe and one dimension of XI which ﬁts
our motivation example. The general form with more predictors of interest and over-
identiﬁed model are discussed in later sections. Without loss of generality, we assume
that all covariates are centered at zero. Based on our notation above, our observed data
sets are {T ∗, δ, δ, Xe, X o, XI}. Let X = {Xe, X o, X u, XI}, we model the cause
speciﬁc cumulative incidence function as F1(t|X) = P (T ≤ t,  = 1|X) for the
subgroup with covariate X. For notation simplicity, we treat X as time-independent.
Our method can be extended to the external time-varying covariate process (i.e. inter-
actions between time and baseline covariates) when the covariate process is available
after the event occurs. We denote Ni(t) = I(Ti ≤ t, i = 1), Yi(t) = 1 − Ni(t−).
Since Ni(t) and Yi(t) are not observable for all time points of censored subjects, we
introduce ri(t) = I(Ci ≥ Ti ∧ t), then both ri(t)Ni(t) and ri(t)Yi(t) are computable
for all time points.

2.2. Structural Additive Model for Sub-distribution Hazard

Given the important feature that for additive hazard model, the effect is collapsible over
unmeasured effects, we consider an IV analysis based on an additive subdistribution
hazard model. Suppose we are interested in cause 1, then we model the subdistribution
hazard for cause 1 as

λ1(t|X) = − d
dt

log {1 − F1(t|X)} ,

our model will be in the form of

λ1(t|X) = h0(t) + βeXe + βT

oX o + βT

uX u,

C. Zheng et al./Instrumental Variable with Competing Risk Model

4

Thus, we have

where βe ∈ R, βo ∈ Rp and βu ∈ Rq.
(cid:27)
(cid:90) t
(cid:110)−βeXet − βT

−
= 1 − H0(t) exp

F1(t|X) = 1 − exp

λ1(s|X)ds

(cid:26)

0

(cid:111)

,

oX ot − βT

uX ut

(cid:26)

−

(cid:90) t

0

(cid:27)

where H0(t) = exp

h0(s)ds

. So

λ1(t|Xe, X o)
= − d
dt
= − d
dt
= − d
dt
= − d
dt

(cid:26)(cid:90)
(cid:26)

log

log

(cid:17)

X o

βo + βT

uαT

o

log {1 − F1(t|Xe, X o)}
log [1 − E{F1(t|X)|Xe, X o}]

H0(t) exp

H0(t) exp

oX ot − βT

uX ut

dF (X u|Xe, X o)

(cid:16)−βeXet − βT
(cid:16)−βeXet − βT
(cid:110)
(cid:104)

oX ot

(cid:17)
(cid:16)−βT
(cid:17)
(cid:17)|Xe, X o

uX ut

(cid:111)(cid:105)

(cid:17)(cid:90)
(cid:16)−βT

exp

dF (X u|Xe, X o)

(cid:27)

(cid:27)

oX o − d
dt

.

log

E

uX ut

= h0(t) + βeXe + βT
exp
oX o and Var(X u|X o, Xe) = σ2
We assume E(X u|X o, Xe) = αeXe + αT
αe is a (q× 1)-vector and αT
(cid:17)
the above expression can be further simpliﬁed by the following approximation,

uI, where
o is a (q× p)-matrix. Then by second order approximation,
(cid:16)
uβu. Since X u is confounding, αe (cid:54)= 0,
where ˜h0(t) = h0(t) + β2
thus the regression estimator for the treatment effect based on observed variables will
be biased. The above approximation holds exactly when X u = αeXe + αT
oX o + eu,
with eu normally distributed and is independent of Xe and X o.

(cid:0)αeXe + αT

(cid:1) = ˜h0(t) +

˜h0(t) + βeXe + βT

oXo + βT

ut and β2

βe + βT

u = βT

Xe +

oX o

(cid:16)

uσ2

uαe

In order to obtain a consistent estimator of βe, we need to use the instrumental

u

variable XI. Assuming that Xe can be modeled as:

Xe = γ0 + γI XI + γT

oX o + γT

uX u + e.

We present detailed assumptions required for the instrumental variable analysis in
the following section. We denote Ri(t) = ri(t)G(t)/G(Ti ∧ t), Y ∗
i (t) = Ri(t)Yi(t)
i (t) = Ri(t)Ni(t). Denote ˆRi(t) = ri(t) ˆG(t)/ ˆG(Ti ∧ t), where G(t) =
and N∗
P (C ≥ t) and ˆG(t) is estimated from either Kaplan-Meier estimator when assum-
ing random censoring or from semiparametric regression model when ˆGi(t) = P (C ≥
t|X oi, XIi) depends on X o and XI. Denote ˆYi(t) = ˆRi(t)Yi(t) and ˆNi(t) = ˆRi(t)Ni(t).
We assume that censoring distribution C is conditionally independent of (T, ) condi-
tioning on variables XI and X o (Assumption 6), which is stronger than traditional

C. Zheng et al./Instrumental Variable with Competing Risk Model

5

assumption that C is conditionally independent of (T, ) conditioning on variables XI,
Xe and X o. This assumption is needed since Xe will not be included in the model for
the second stage of the two-stage estimator. Other assumptions are parallel to those re-
quired for traditional additive hazard model. Thus, when Assumption 6 holds, the two
models’ results are comparable.

Now we propose the two-stage estimation procedure. In the ﬁrst stage, we ﬁt a model
of Xe on XI and X o to obtain ˆγ0, ˆγI and ˆγT
o. Then compute ˆXei = ˆγ0 + ˆγI XIi +
ˆγT
oX oi. In the competing risk model, we regress on ˆXei and X oi rather than Xei and
X oi to obtain consistent estimator ˆβe. For the ﬁrst stage estimator, by the result of
ordinary least square, we can estimate ˆγ = (ˆγ0, ˆγI , ˆγo)T with

ˆγ = [XT

IoX Io]−1[XT

IoX e],

o

where X Io = [1, X I , X o] is a n × (p + 2) matrix. It is obvious that ˆγ0, ˆγI, ˆγT
are consistent estimators of γ0, γI, γT
o. Thus deﬁne ˜X e = X Ioγ, then we have ˆX e =
IoX Io]−1XT
X Io ˆγ = X Io[XT
Io
is the projection matrix on X Io. The ordinary linear regression result guarantees that
ˆX e converge to ˜X e uniformly in probability in a compact set of X Io.

IoX e = H IoX e, where H Io = X Io[XT

IoX Io]−1XT

In the second stage, we ﬁt a subdistribution additive hazard model on covariates ˆXei,
X oi. To ﬁt this model, we applied the estimator proposed by Sun et al. [21] and used
the R programming method developed by Scheike and Zhang [25]. We use estimated
ˆXei as our ﬁnal estimator for βe. To see why this works, we make the following brief
derivation:
λ1(t| ˜Xei, X oi) = − d
dt
= − d
dt

t| ˜Xei, X oi, X ui, ei

X ui, ei| ˜Xei, X oi

1 − F1
1 −

t| ˜Xei, X oi

(cid:17)(cid:111)

(cid:110)
(cid:26)

(cid:16)

(cid:16)

(cid:17)

(cid:16)

(cid:90)

log

log

dF

F1

(cid:17)(cid:27)

.

F1

log

(cid:90)

(cid:16)

1 −

(cid:27)

(cid:26)

dF (X ui, ei)

t| ˜Xei, X oi, X ui, ei

According to the regularity conditions (see assumption 1, 4 and 5), it can be further
written as
− d
dt
= − d
dt
= − d
dt
= − d
dt
= h∗
0(t) + βe ˜Xei + βT

(cid:17)
(cid:110)−βe
(cid:16) ˜Xei + γT
(cid:110)−βe ˜Xeit − βeeit − βT
(cid:111)(cid:90)
(cid:110)−βe ˜Xeit − βT

(cid:17)
oX oit − (βT
(cid:110)−βeieit −(cid:16)

(cid:20)(cid:90)
(cid:20)(cid:90)
(cid:20)

(cid:111)
(cid:111)
(cid:17)

oX oit − βT

βT
u + βeγT

u + βeiγT

uX ui + ei

t − βT

H0(t) exp

H0(t) exp

H0(t) exp

u)X uit

uX uit

oX oit

oX oi,

exp

log

log

log

where h∗

0(t) = h0(t) − d
dt

log

exp{−βeeit − (βu + βeγu) X uit} dF (Xui, ei)

.

(cid:20)(cid:90)

(cid:21)

(cid:21)
(cid:21)

dF (X ui, ei)

dF (X ui, ei)

(cid:111)

(cid:21)

X uit

dF (Xui, ei)

u

(cid:111)

dt − Ri(t)Yi(t)dΛ0(t)

.

C. Zheng et al./Instrumental Variable with Competing Risk Model

6

i=1

(cid:17)

Ri(t)Yi(t)

(cid:90) τ

0 =

0 =

n(cid:88)
n(cid:88)

Denote βT = (βe, βT

o). We have the following unbiased estimating equations

dRi(t)Ni(t) − Ri(t)Yi(t)βT(cid:16) ˜Xei, X oi
(cid:110)
(cid:16) ˜Xei, X oi
(cid:17)
(cid:34)

(cid:110)
dRi(t)Ni(t) − Ri(t)Yi(t)βT(cid:16) ˜Xei, X oi
(cid:17)−1

Replace the unknown quantity Ri(t) and ˜Xei by their consistently estimated version
T
ˆRi(t) and ˆXei, we can solve the following estimation equation to obtain ˆβ
o).
, which is a (p + 1) × (p + 2) matrix.

dt − Ri(t)Yi(t)dΛ0(t)

Denote X IOE =

= ( ˆβe, ˆβ

Ri(t)Yi(t)

XT

eX Io

XT

IoX Io

i=1

0

(cid:17)

(cid:16)

(cid:35)

T

(cid:111)

With known weighting function wi(t),we have

(0p, 0p, Ip)

wi(t) ˆYi(t)

d ˆNi(t) − ˆYi(t)βTX IOEXIoidt − ˆYi(t)dΛ0(t)

wi(t) ˆYi(t)X IOEXIoi

d ˆNi(t) − ˆYi(t)βTX IOEX Ioidt − ˆYi(t)dΛ0(t)

.

(cid:110)

n(cid:88)
n(cid:88)

i=1

(cid:90) τ

i=1

0

0 =

0 =

(cid:111)

(cid:111)

(cid:111)

.

(cid:41)(cid:35)

(cid:110)

(cid:40)

(cid:110)
(cid:80)n

From the ﬁrst equation, we obtain

i=1 wi(s) ˆYi(t)

dˆΛ0(t) =

d ˆNi(t) − ˆYi(t)βTX IOEX Ioi
i=1 wi(t) ˆY 2

i (t)

Plug the ﬁrst equation solution into the second, we have

(cid:80)n

(cid:34)

(cid:90) τ

n(cid:88)

(cid:80)n
(cid:80)n

0 =

X IOE

i=1

0

× wi(t) ˆYi(t)

(cid:110)

X Ioi −

j=1 X Iojwj(t) ˆY 2
j=1 wj(t) ˆY 2
j (t)
d ˆNi(t) − ˆYi(t)βTX IOEX Ioidt

So we have

n−1
(cid:32)

n−1

(cid:90) τ
n(cid:88)
(cid:90) τ
n(cid:88)

i=1

0

(cid:40)
(cid:40)

(cid:34)
(cid:34)

X IOE

X IOE

ˆβ =

×

X Ioi −

X Ioi −

i=1

0

= S−1

2n (ˆγ, ˆΛc)S1n(ˆγ, ˆΛc)

(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n

j (t)

j=1 wj(t) ˆY 2

j=1 X Iojwj(t) ˆY 2
j (t)
j=1 X Iojwj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2

j (t)

.

j (t)

(cid:111)
(cid:41)(cid:35)⊗2
(cid:41)(cid:35)

−1
(cid:33)

wi(t) ˆY 2

i (t)dt

wi(t) ˆYi(t)d ˆNi(t)

where a⊗2 = aaT.
timate h∗

The baseline hazard is not identiﬁable due to the confounding of X u, i.e., we can es-
0(t) but we are not able to estimate h0(t). However, we are still able to estimate

C. Zheng et al./Instrumental Variable with Competing Risk Model

covariate speciﬁc subdistribution cumulative incident function since it can be repre-
sented by h∗
We can obtain ˆF1(t|Xe, X o) = 1 − exp

(cid:16)−h∗
(cid:17)
0(t) instead of h0(t), then we have F1(t|Xe, X o) = 1−exp
(cid:111)
T
(cid:90) t
oX o

0(t) − t ˆβeXe − tˆβ

X IOEX Ioids

(cid:80)n

i=1 wi(s) ˆYi(s)

with

7

T

(cid:16)−ˆh∗
(cid:110)
(cid:80)n

d ˆNi(s) − ˆYi(s)ˆβ
i=1 wi(s) ˆY 2
i (s)

ˆh∗
0(t) =

0

0(t) − tβeXe − tβT

oX o

(cid:17)

.

3. Theoretical Results

We assume the following regularity conditions hold throughout the paper.
Assumption 1: XI, X u and X o are mean zero random variables. γT

correlated with X o and Xe, i.e., E(cid:0)γT
Var(cid:0)γT

(cid:1) = σ2.

uX u + e|X o, Xe

constant, i.e.,

uX u + e|X o, Xe

(cid:1) = 0. The variance is

uX u + e is un-

Assumption 2: The instrumental variable XI is associated with Xe conditional on X o

and X u, i.e., αI (cid:54)= 0.

Assumption 3: XI is not directly associated with the outcome event, i.e., XI is inde-

pendent of (T, , X u) conditional on X o.

Assumption 4: The error term e has mean 0. e is independent of XI, X o and X u.
Assumption 5: X o and X u are independent.

The assumptions above are parallel to the traditional IV assumptions, with the
uncorrelated assumption replaced by independence assumption since our model
is nonlinear. Since we are considering the additive hazard subdistribution model,
we also need the following assumptions related to the additive hazard model.

Assumption 6: Independent censoring, i.e. C is conditionally independent of (T, ),

conditional on variables XI and X o.

Assumption 7: Covariates X o, XI, X u, Xe have bounded supports and β is an inte-
Assumption 8: When the time period of interest is [0, τ ], we require P (C ≥ t|X o, XI )

rior point of the possible parameter space.
to be bounded away from 0 for t ∈ [0, τ ].
X Ioi −

X IOE

Assumption 9: n−1

wi(t)Y ∗2

i

(t)dt

converge uniformly with probability 1 to a positive deﬁnite matrix process Ωτ .

Assumption 10: n−1

X IOE

X Ioi −

converges uniformly with probability 1 to a positive deﬁnite matrix process Ψτ .

0

i=1

(cid:34)
(cid:90) τ
n(cid:88)
(cid:34)
(cid:90) τ
n(cid:88)
(cid:90) τ
(cid:40)

i=1

0

0

X Ioi −

X IOE

(cid:40)
(cid:40)

j (t)

(cid:80)n
(cid:80)n
j=1 X Iojwj(t)Y ∗2
(cid:80)n
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

j=1 wj(t)Y ∗2

j (t)

(cid:41)(cid:35)⊗2
(cid:41)(cid:35)⊗2

(cid:41)(cid:35)

{X Ioi −

(cid:34)
(cid:40)(cid:80)n
(cid:80)n
j=1 X Iojwj(t)Y ∗2
(cid:80)n
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

(cid:41)(cid:35)T

j (t)

wi(t)Y ∗2

i

(t)dt

wi(t)Y ∗2

i

(t)dN∗

i (t)

(cid:16)

(cid:17)−1

X Ioi

XT
Ioi

XT

IoX Io

Assumption 11:

n(cid:88)

i=1

σ2β2
0e
n

(cid:34)

×

X IOE

C. Zheng et al./Instrumental Variable with Competing Risk Model

8

converges uniformly with probability 1 to a positive deﬁnite matrix process Στ .
Assumption 12: For τ < ∞, there exist bounded continuous functions g(t) and Γ(t)

such that

and

(cid:13)(cid:13)(cid:13)(cid:13)(cid:90) t
(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)
(cid:90) t

0

0

i=1 w2

n−1(cid:80)n
[n−1(cid:80)n
i (s)Y 2∗
i=1 wi(s)Y ∗2
(cid:80)n
(cid:80)n
j=1 X Iojwj(s)Y ∗
j=1 wj(s)Y ∗2

i

i

(s)dN∗

i (s)

(s)]2 − g(t)
j (s)dN∗
j (s)

j (s)

X IOE

(cid:13)(cid:13)(cid:13)(cid:13)∞

− Γ(t)

(cid:13)(cid:13)(cid:13)(cid:13)(cid:13)∞

converge to 0 in probability uniformly over t ∈ (0, τ ].

We provide theoretical results in this section with brief proof outline. The technical

details of the proofs can be found in appendix.

Theorem 1: Under assumptions 1-11, ˆβ converges to β0 with probability 1.

Proof: Since ˆγ and ˆΛc converge to γ and Λc uniformly and the regularity conditions
ensure that the function space is in Glivenko Cantelli class, we have ˆβ = S−1
converges to ˜β = S−1
2n (γ, Λc)S1n(γ, Λc) uniformly with probability 1. By the conver-
gence result for the additive subdistribution hazard model, we know that ˜β converges
to β0 with probability 1. Thus ˆβ converges to β0 with probability 1.

For simplicity of the variance form, we will choose Kaplan-Meier estimator for ˆG(t)
and assume random censoring. In practice, if we believe censoring depends on Xo and
XI, we can model it via certain semiparametric models. Under the correct speciﬁcation
of such models, the consistency and asymptotic normality results still hold though the
variance will have a more complicated form and the Bootstrap will be recommended
for.

2n (ˆγ, ˆΛc)S1n(ˆγ, ˆΛc)

Theorem 2: Under assumptions 1-11, we have

√

n(ˆβ − β0) →d N (0, Ω−1

τ (Ψτ + Στ )Ω−1
τ )

using an empirical version of ˆΦi of Φi and compute n−1(cid:80)n

with inﬂuence function Φi as deﬁned in appendix. The variance can be estimated by
to estimate EΦ⊗2
.

i=1 Φ⊗2

i

i

See Appendix for a detailed expression of inﬂuence function Φi.

Theorem 3: Under assumptions 1-12, we have

| ˆF1(t|xe, xo) − F1(t|xe, xo)| →p 0

sup
t∈(0,τ ]

√

n( ˆF1(t|xe, xo) − F1(t|xe, xo)) converges weakly to a mean zero Gaussian pro-

and
cess with covariance matrix
K(s, t) = (1 − F1(t|xe, xo))(1 − F1(s|xe, xo))

[g(t ∧ s) + ts(xe, xo)Ω−1

τ (Ψτ + Στ )Ω−1

τ (xe, xo)T + (xe, xo)Ω−1

τ (Γ(t)s + Γ(s)t)].

C. Zheng et al./Instrumental Variable with Competing Risk Model

9

4. Simulation
We randomly sample XI from {0, 1} with equal probability. Xo and Xu are sampled
from independent standard normal distributions. Xe is generated as Xe = (1, XI , Xo, Xu)γT
with γ = (0, γ2, 0.5,−1). By changing γ2 from 0.2 to 0.4, we mimic the setting with
weak and strong instrumental variables. We vary the sample size n = 100, 400, 1000.
Let t0 = 0.6 be a ﬁxed time point and denote t∗ = min(t, t0). We simulate event time
data from the following subdistribution rate

F (t,  = 1) = 1 −(cid:8)1 − p(cid:0)1 − e−t(cid:1)(cid:9) exp{−βeXet − βoXot − βuXut}

F (t,  = 2) =

(1 − p) (1 − e−t) exp{−βeXet∗ − βoXot∗ − βuXut∗}

exp{−βeXet0 − βoXot0 − βuXut0}

In this way, we gaurantee that P ( = 1) = p and P ( = 2) = 1 − p have a sum
F (∞,  = 1) + F (∞,  = 2) = 1 and both F (t,  = 1) and F (t,  = 2) are increasing
functions. We ﬁrst generate  and then generate T1 and T2 given  by

F (t| = 1) =

F (t| = 2) =

1 − {1 − p(1 − e−t)} exp{−βeXet∗ − βoXot∗ − βuXut∗}

1 − (1 − p) exp{−βeXet0 − βoXot0 − βuXut0}

exp{−βeXet∗ − βoXot∗ − βuXut∗}
exp{−βeXet0 − βoXot0 − βuXut0}

We set censoring time as exponentially distributed with parameters set to make 30%
and 50% censoring rate. We set p = 0.8, β = (0.5, 0.2, β3). When setting β3 = 0, we
have the case of no unmeasured confoundings. When setting β3 = 0.2 and 0.4, we have
the cases with weak and strong unmeasured confoundings. The results are summarized
in table 1.

From the results, we can see that when IV is strong, the IV method has small bias
and correct coverage rate for its 95% nominal conﬁdence interval. However, when IV
becomes weak, the IV estimator performance becomes unsatisfactory, especially in the
small sample size case (i.e. n=100). When IV assumption does not hold and the instru-
mental variable is independent of the exposure, the IV method fails (with very large
bias and variance) as we expected. When IV is strong, we compare the IV method and
the traditional regression method. When there are no unmeasured confoundings, both
methods yield small bias and correct coverage rates for their 95% nominal conﬁdence
interval, although the IV estimator is not as efﬁcient as regression based estimator.
However, as confounding effects increase, we observe the dramatic increase of bias
and smaller coverage rate for regression method while the IV estimator still maintain
small bias and the standard error increases very slightly. The coverage rate is approxi-
mately at its nominal level.

5. Real transplant data example

We now apply the proposed instrumental variable analysis method to a real data ex-
ample. We considered data from the Center for International Blood and Marrow Trans-
plant Research (CIBMTR), on 994 Diffuse Large B Cell Lymphoma (DLBCL) patients,

C. Zheng et al./Instrumental Variable with Competing Risk Model

10

Simulation results comparing IV and traditional regression methods in terms of Bias, Standard error (SE),

Coverage rate (CR) of 95% nominal conﬁdence interval under different confounding levels

TABLE 1

(none/weak/strong) and IV strength (none/weak/strong).

50% Censoring

30% Censoring

IV method

Regression method

IV method

Regression method

IV
None
None
None
Weak
Weak
Weak
Strong
Strong
Strong
None
None
None
Weak
Weak
Weak
Strong
Strong
Strong
None
None
None
Weak
Weak
Weak
Strong
Strong
Strong

n
100
400
1000
100
400
1000
100
400
1000
100
400
1000
100
400
1000
100
400
1000
100
400
1000
100
400
1000
100
400
1000

Bias
5.78
5.62
-1.75
-0.08
-0.02
0.07
-0.03
-0.01
0.03
5.66
5.61
-1.56
-0.04
-0.04
0.06
-0.03
-0.02
0.02
3.49
4.01
-2.21
0.08
-0.02
0.03
0.00
-0.00
0.02

SE
37.62
47.21
32.13
1.64
0.63
0.44
0.71
0.32
0.23
34.67
52.28
39.24
1.74
0.69
0.50
0.77
0.35
0.25
30.60
55.30
41.40
2.07
0.74
0.54
0.89
0.38
0.28

CR
96%
97%
97%
96%
98%
93%
94%
98%
95%
96%
97%
92%
95%
97%
93%
96%
97%
93%
95%
97%
91%
96%
97%
91%
95%
96%
93%

Bias
0.02
-0.00
-0.01
-0.01
0.01
-0.00
-0.02
0.00
0.00
-0.22
-0.20
-0.21
-0.22
-0.18
-0.18
-0.18
-0.15
-0.13
-0.45
-0.40
-0.41
-0.41
-0.36
-0.37
-0.32
-0.28
-0.27

SE
0.52
0.24
0.13
0.50
0.24
0.13
0.44
0.20
0.12
0.55
0.28
0.14
0.53
0.27
0.14
0.46
0.23
0.13
0.58
0.31
0.16
0.57
0.30
0.16
0.52
0.26
0.15

CR
93%
90%
95%
92%
94%
97%
94%
94%
97%
92%
84%
73%
91%
83%
80%
91%
88%
88%
84%
67%
28%
87%
68%
37%
84%
73%
50%

Bias
3.96
3.17
-4.51
-0.14
0.02
0.06
-0.06
0.02
0.02
3.75
3.59
-3.90
-0.08
0.02
0.05
-0.04
0.01
0.02
2.48
2.10
-4.35
0.02
0.04
0.05
-0.02
0.02
0.03

SE
33.22
37.01
25.77
1.37
0.54
0.39
0.57
0.27
0.19
32.58
33.77
29.79
1.41
0.58
0.43
0.61
0.29
0.22
19.67
35.71
30.16
1.71
0.61
0.47
0.69
0.31
0.23

CR
97%
97%
96%
97%
98%
94%
96%
98%
96%
97%
98%
93%
96%
98%
94%
98%
97%
95%
96%
97%
94%
96%
98%
93%
96%
98%
94%

Bias
-0.01
-0.01
-0.01
-0.03
-0.00
-0.01
-0.04
-0.00
0.00
-0.23
-0.21
-0.21
-0.23
-0.18
-0.18
-0.18
-0.14
-0.13
-0.45
-0.41
-0.41
-0.41
-0.36
-0.36
-0.32
-0.27
-0.27

SE
0.41
0.21
0.12
0.41
0.20
0.12
0.36
0.17
0.11
0.45
0.23
0.13
0.44
0.23
0.13
0.39
0.19
0.12
0.48
0.26
0.15
0.47
0.24
0.15
0.42
0.22
0.13

CR
94%
92%
95%
95%
92%
94%
95%
95%
95%
90%
82%
64%
89%
86%
69%
90%
88%
81%
82%
57%
25%
84%
64%
27%
81%
70%
42%

Confounding

None
None
None
None
None
None
None
None
None
Weak
Weak
Weak
Weak
Weak
Weak
Weak
Weak
Weak
Strong
Strong
Strong
Strong
Strong
Strong
Strong
Strong
Strong

who are 18 to 76 years old, and had an autologous hematopoietic stem cell transplan-
tation (TX) between 1996 and 2003 [7]. The CIBMTR is comprised of clinical and
basic scientists who share data on their blood and bone marrow transplant patients,
with the CIBMTR Data Collection Center located at the Medical College of Wiscon-
sin. The CIBMTR has a repository of information regarding the results of transplants
at more than 450 transplant centers worldwide. The speciﬁc aim of the study was to
compare the clinical outcomes between whether rituximab was (+R cohort, N=176) or
was not (−R cohort, N=818) administered as therapy prior to the transplant. The clini-
cal outcomes compared include relapse/progression of DLBCL, non-relapse mortality
(NRM: deﬁned as death without relapse/progression), progression-free survival (PFS)
and overall survival (OS). Here relapse/progression and NRM are two competing risks.
The CIBMTR study treated the Year of TX (2000-2003 versus 1996-1999) as a reg-
ular covariate which needs to be adjusted if it is signiﬁcant in the regression mode,
and concluded that pre-TX rituximab did not affect NRM (Hazard Ratio (HR)=0.70,
p=0.18) with Year of TX to be included in the model (HR=0.63, p=0.05).The risk of
relapse/progression was lower in the +R cohort compared to the −R cohort (HR=0.67,
p=0.004) without Year of TX to be included in the ﬁnal model since it was not signiﬁ-
cant (HR=0.86, p=0.25).

In the CIBMTR study cohort, there were 18% (174/986) patients who received
rituximab in pre-transplant therapy and only 1% (6/482) had rituximab among those
transplanted prior to 1999. Calendar time (Year of TX) was highly associated with the
use of rituximab since increase in use rituximab was a result of approval by the US
Food and Drug Administrations in 1998. Prior to 1998 Rituximab was available only
in clinical trials. However, calendar time (i.e. before or after FDA approval) will not
change rituximab’s drug effect, and there were no major clinical practice changes over

C. Zheng et al./Instrumental Variable with Competing Risk Model

11

Fitting results for CIBMTR study using traditional regression with “Year of TX" (Model: 1) and without

“Year of TX" (Model: 2) and using “Year of TX" as an instrumental variable (Model: 3). Adjusted

TABLE 2

covariates include age, disease status and number of lines of chemotherapy for relapse/progression and

age, time from diagnosis to treatment (DX to TX), Karnofsky Score for NRM.

Outcome Model
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
Relapse
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM
NRM

1
1
1
1
1
2
2
2
2
3
3
3
3
1
1
1
1
1
1
2
2
2
2
2
3
3
3
3
2

Variable
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Disease Status: Other vs CR1/PIF
Prior lines of therapy: > 2 vs ≤ 2
Yr of TX: 2000-03 vs 1996-99
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Disease Status: Other vs CR1/PIF
Prior lines of therapy: > 2 vs ≤ 2
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Disease Status: Other vs CR1/PIF
Prior lines of therapy: > 2 vs ≤ 2
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Time from DX to TX: > 1 vs ≤ 1 Yr
Karnofsky Score: ≥ 90 vs < 90
Karnofsky Score: Unknown vs < 90
Yr of TX: 2000-03 vs 1996-99
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Time from DX to TX: > 1 vs ≤ 1 Yr
Karnofsky Score: ≥ 90 vs < 90
Karnofsky Score: Unknown vs < 90
Ritux: Yes vs No
Age: ≥ 55 vs < 55
Time from DX to TX: > 1 vs ≤ 1 Yr
Karnofsky Score: ≥ 90 vs < 90
Karnofsky Score: Unknown vs < 90

P-value
Coef. Est. (SE)
−.0022 (0.0016)
0.1774
0.0320
0.0033 (0.0015)
0.0065 (0.0015)
< .0001
0.0081 (0.0019)
< .0001
−.0035 (0.0015)
0.0162
−.0043 (0.0015)
0.0036
0.0346
0.0033 (0.0016)
0.0067 (0.0015)
< .0001
0.0083 (0.0019)
< .0001
−.0104 (0.0031)
0.0007
0.0175
0.0038 (0.0016)
0.0063 (0.0015)
< .0001
0.0088 (0.0019)
< .0001
−.0006 (0.0007)
0.3595
0.0133
0.0015 (0.0006)
0.1163
0.0009 (0.0006)
−.0013 (0.0006)
0.0302
0.8103
0.0004 (0.0017)
−.0019 (0.0006)
0.0012
−.0017 (0.0006)
0.0060
0.0218
0.0014 (0.0006)
0.1307
0.0009 (0.0006)
−.0013 (0.0006)
0.0328
−.0006 (0.0016)
0.7263
−.0049 (0.0012) < .0001
0.0018 (0.0006)
0.0040
0.1390
0.0008 (0.0006)
−.0014 (0.0006)
0.0273
0.9510
0.0001 (0.0018)

this short study time period that would have an impact on transplant. Thus, includ-
ing calendar time (Year of TX) as a regular covariate in a regression analysis could
lead to a biased conclusion since we cannot estimate the true effect of rituximab in
the presence of Year of TX. Besides observed adjusted covariates (see [7]), there exist
some unobserved covariates, such as molecular subtype of lymphoma (e.g. germinal
center vs. activated B cell vs double hit lymphoma) [26]. These additional prognostic
covariates were unknown at the time that these patients were treated and the analysis
was done. Such unobserved covariates may affect clinical outcomes and maybe imbal-
anced between the +R and −R cohorts. It is reasonable to assume that the calendar
time over such short study time period will not be associated with any of potential un-
observed covariates. We use Year of TX (before or after the FDA approval the drug)
as an instrumental variable (IV) in proposed IV additive regression model to analyze
competing risks data. Risk factors adjusted were AGE, Disease Status and Number
of Lines of Chemotherapy for relapse/progression and were AGE, Time from diag-
nosis (DX) to TX and Karnofsky Score for NRM. The analysis results for ﬁtting a
regular regression including Year of TX (Model 1), without Year of TX (Model 2), and

C. Zheng et al./Instrumental Variable with Competing Risk Model

12

IV regression analysis (Model 3) are given in Table 2. When Year of TX was incor-
rectly to be included in the regression models, pre-transplant rituximab did not affect
both on relapse/progression and NRM since part of the drug effects were counted by
the artiﬁcial effect of calendar time of Year of TX. Without adjusting Year of TX,
estimated rituximab effects were underestimated, where estimated effect size of ritux-
imab by regular regression compared to IV analysis were increased from −0.0043 to
−0.0104 (relatively, 1.42 times increasing) for relapse/progression and increased from
−0.0017 to −0.0049 (relatively, 1.88 times increasing) for NRM. Increasing in the size
of rituximab effect on the cumulative incidence function (CIF) can be seen in the plot of
predicted CIF for +R cohort versus −R cohort. At 72 months since TX, the rituximab
effect in CIF of relapse/progression were 20% and 7% by IV regression analysis and
by regular regression analysis, respectively (Figure 1). Similarly, the rituximab effect
in CIF of NRM were 23% and 8% by IV regression analysis and by regular regression
analysis, respectively (Figure 2). We observe signiﬁcant increase in rituximab effect by
IV regression modeling.

With calendar time of before or after the FDA approval of rituximab (Year of TX)
as an instrumental variable, we conﬁrmed rituximab effect both on relapse/progression
and NRM. In conclusion, it is important to identify instrumental variable, and to model
and analyze the instrumental variable appropriately in regression analyses.

6. Discussion

In this paper, we proposed consistent estimators of efﬁcacy of treatment in the presence
of unmeasured confoundings. We showed the asymptotic results of these estimators and
studied their performance under ﬁnite sample size using simulation. The data example
shows that by adjusting unmeasured confounding using instrumental variable, we are
able to identify stronger treatment effects. One limitation of this method is that due to
the nature of additive models, in certain cases it is hard to guarantee the subdistribution
hazard to be positive. Although it is quite clear in our example that the approval from
FDA will not directly affect the survival outcome, ﬁnding a valid instrumental variable
may be challenging in some other settings. The sensitivity analysis is required if we are
not sure whether the exclusion restriction assumption holds.

Although we assume time-independent effects in our model, the method can be
straightforwardly extended to allow time-varying effects β(t) for the two-stage esti-
mator with a more complicated theoretical variance form. In general we can replace
the two-stage approach by the following one-stage approach:

0 = E[I(T > t,  = 1) exp{−βT(t)(Xe, X o)}(XI − EXI|X o)]

Since I(T > t,  = 1) is not always observable due to the censoring, we can use the
IPCW method with weights derived in Zhang et al. [27]. The estimating equation can
be written as

0 = E[R(t)I(T > t,  = 1) exp{−βT(t)(Xe, X o)}(XI − EXI|X o)]

This allows weaker assumptions (i.e. uncorrelated assumption rather than indepen-
dence assumption for XI and outcome conditional on Xe, X o) and more efﬁcient

C. Zheng et al./Instrumental Variable with Competing Risk Model

13

FIGURE 1. Predicted cumulative incidence function of Relapse comparing IV ﬁtting to regular regression
analysis

results. One the other hand, the advantage of the two-stage approach is computational
and it is easy to be implemented using current available softwares.

In conclusion, the two stage least square estimator is a useful method to handle un-
measured confounding variables for competing risk data analysis and it has good ﬁnite
sample size and asymptotic performance. The two stage approach is easy to implement
using available softwares and can be used in various settings including time-varying
effect and time-varying covariate X o. The design of measuring useful instrument vari-
able shall provide us better understanding of the treatment effect under potential con-
founding for compliance.

Appendix

A.1. Proof of Theorem 1:

We ﬁrst study the behavior of S1n(ˆγ, ˆΛc). We denote ˜X i = ( ˜Xei, X oi) and ˆX i =
( ˆXei, X oi). Denote M∗
i dΛi(t) as an square integrable martingale.

i (t) = N∗

i (t)−(cid:82) t

0 Y ∗

012243648607284960.00.20.40.60.81.0Months Since TransplantProbabilityPredicted CIF of RelapseIV: Ritux=NoIV: Ritux=YesRegular: Ritux=NoRegular: Ritux=Yes01224364860728496−0.30−0.25−0.20−0.15−0.10−0.050.00Months Since TransplantProbabilityDifference of Predicted CIF of Relapse(Ritux: Yes − No)IV: Ritux=Yes − NoRegular: Ritux=Yes − NoC. Zheng et al./Instrumental Variable with Competing Risk Model

14

FIGURE 2. Predicted cumulative incidence function of NRM comparing IV ﬁtting to regular regression anal-
ysis

We can rewrite S1n(ˆγ, ˆΛc) as

S1n(ˆγ, ˆΛc) = n−1

= n−1

 wi(t) ˆYi(t)d ˆNi(t)
 wi(t) ˆYi(t)dM∗
 wi(t) ˆYi(t)( ˆRi(t) − Ri(t))dNi(t)

i (t)

0

i=1

 ˆX
(cid:90) τ
n(cid:88)
 ˆX
(cid:90) τ
n(cid:88)
 ˆX
(cid:90) τ
n(cid:88)

i=1

0

i=1

0

T

i −

T

i −

j=1

(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n

j=1

j=1

ˆX

T
j wj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2

j (t)

ˆX

T
j wj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2

j (t)

+n−1

T

i −

ˆX

T
j wj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2

j (t)

= S11n + S12n

For Kaplan Meier estimator, we have

ˆRi(t) − Ri(t) = − G(t)I(Ti < t)

G(Ti)

(cid:90) t

n(cid:88)

j=1

Ti

(cid:80)n
dM c
k=1 I(Tk ≥ u)

j (u)

012243648607284960.00.20.40.60.81.0Months Since TransplantProbabilityPredicted CIF of NRMIV: Ritux=NoIV: Ritux=YesRegular: Ritux=NoRegular: Ritux=Yes01224364860728496−0.30−0.25−0.20−0.15−0.10−0.050.00Months Since TransplantProbabilityDifference of Predicted CIF of NRM(Ritux: Yes − No)IV: Ritux=Yes − NoRegular: Ritux=Yes − No ˆX

T

i −

So we have

S11n = n−1

j=1

(cid:80)n
(cid:80)n
(cid:90) τ
n(cid:88)

i=1

0

ˆX

T
j wj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2

j (t)

 ˜X

T

i −

(cid:80)n
(cid:80)n

j=1

j=1

T

i −

 ˜X
(cid:80)n
(cid:80)n
 wi(t)Y ∗

C. Zheng et al./Instrumental Variable with Competing Risk Model

15

0 I(Ti ≥ t)dΛc(t). Due to the consistency of

where M c
ˆγ and uniform convergence of ˆG(·), we have

j (u) = I(Ti ≤ u, i = 0) −(cid:82) u
n(cid:88)

(cid:90) τ

j=1

T

S12n = n−1

(cid:80)n
(cid:80)n

 ˜X

i −

i=1

0

T

j wj(t)Y ∗2
˜X
j=1 wj(t)Y ∗2
j (t)

j (t)

 wi(t)Y ∗

i (t)( ˆRi(t) − Ri(t))dNi(t) + op(1)

So we have S12n is an average of martingale integrals with respect to the censoring
ﬁltration F c(u) = {I(Ti ≤ u, i = 0), I(Ti ≥ t), X i, i = 1,··· , n, t ≤ u}. Under
regularity condition, this term is dominated by a bounded function and converge in
probability to 0 uniformly in a compact neighborhood of β0 [28]. Due to the consis-
tency of ˆγ and uniform convergence of ˆG(·), we also have

 wi(t) ˆYi(t) =

 wi(t)Y ∗

i (t) + op(1)

T

j wj(t)Y ∗2
˜X
j=1 wj(t)Y ∗2
j (t)

j (t)

T

j wj(t)Y ∗2
˜X
j=1 wj(t)Y ∗2
j (t)

j (t)

i (t)dM∗

i (t) + op(1)

Due to the consistency of ˆγ and uniform convergence of ˆG(·), we can approximate

S2n(ˆγ, ˆΛc) by

S2n(ˆγ, ˆΛc) = n−1

 ˜X

(cid:90) τ

n(cid:88)

i=1

0

(cid:80)n
(cid:80)n

j=1

T

i −

T

j wj(t)Y ∗2
˜X
j=1 wj(t)Y ∗2
j (t)

j (t)

⊗2

wi(t)Y ∗2

i

(t)dt + op(1)

Based on the consistency results for traditional additive competing risk model with-
out instrumental variable, ˜β = S2n(γ, Λc)−1S1n(γ, Λc) converge to β0. Since we
have shown that our estimator ˆβ − ˜β = op(1), so we obtain the consistency for ˆβ.

A.2. Proof of Theorem 2:
Denote Un(β) = S2nβ − S1n, we have S2n converge to positive deﬁnite matrix Ωτ .
To obtain distribution of ˆβ, we know

√

n(ˆβ − β0) = A−1

τ

√

nUn(β0) + op(1)

= n−1/2

X IOE(X Ioi −

wi(t)Y ∗

i (t)dM∗

i (t)

wi(t) ˆYi(t)[d ˆNi(t) − ˆYi(t)βT

0X IOEX Ioidt]

wi(t) ˆYi(t)dM∗

i (t)

)

wi(t) ˆY 2

i (t)βT

0X IOEX Ioidt]

wi(t) ˆYi(t)[ ˆRi(t) − Ri(t)]dMi(t)

wi(t)Y ∗2

i

(t)βT

0X IOEX Ioidt]

wi(t)Y ∗

i (t)[ ˆRi(t) − Ri(t)]dMi(t) + op(1)

)

C. Zheng et al./Instrumental Variable with Competing Risk Model

16

So, we just need to provide an expansion of

√

nUn(β0)

= n−1/2

= n−1/2

0

0

i=1

i=1

(cid:34)
(cid:90) τ
n(cid:88)
(cid:34)
(cid:90) τ
n(cid:88)
(cid:90) τ
n(cid:88)
(cid:90) τ
n(cid:88)
(cid:34)
(cid:90) τ
n(cid:88)
(cid:90) τ
n(cid:88)
(cid:90) τ
n(cid:88)

i=1

i=1

i=1

i=1

0

0

0

0

(cid:34)

(cid:34)

−

(cid:34)

−

(cid:34)

+n−1/2

+n−1/2

+n−1/2

+n−1/2

i=1

0

= S21n + S22n + S23n

X IOE(X Ioi −

X IOE(X Ioi −

X IOE(X Ioi −

X IOE(X Ioi −

X IOE(X Ioi −

X IOE(X Ioi −

√

)

)

(cid:35)
(cid:35)

nUn(β0). We have

j (t)

j (t)

j=1 wj(t) ˆY 2

j=1 X Iojwj(t) ˆY 2
j (t)
j=1 X Iojwj(t) ˆY 2
j (t)

j=1 wj(t) ˆY 2
j=1 X Iojwj(t) ˆY 2
j (t)
j (t)

(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
(cid:80)n
j=1 wj(t) ˆY 2
(cid:80)n
j=1 X Iojwj(t) ˆY 2
(cid:80)n
j=1 wj(t) ˆY 2
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)
(cid:80)n
j=1 wj(t)Y ∗2
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
(cid:80)n
j=1 wj(t)Y ∗2
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

)

j (t)

j (t)

(cid:35)
(cid:35)

)

j (t)

)

(cid:35)

(cid:35)

(cid:35)

For the ﬁrst term, it is in the form of martingale integration and we have

S21n = n−1/2

Φ1i(τ ) + op(1)

n(cid:88)

i=1

and

V ar(S21n) = n−1

(cid:90) τ

n(cid:88)

i=1

0

(cid:34)

converge to Ψτ with probability 1.

For the second term, we have

X IOE(X Ioi −

S22n = n−1/2

= n−1/2

= n−1/2

(cid:90) τ
(cid:90) τ

0

(cid:34)
(cid:34)

−

−

i=1

n(cid:88)
n(cid:88)
n(cid:88)

i=1

i=1

0

Φ2i(τ ) + op(1)

X IOE(X Ioi −

X IOE(X Ioi −

j (t)

j=1 wj(t)Y ∗2

(cid:80)n
(cid:80)n
j=1 XIojwj(t)Y ∗2
j (t)
(cid:80)n
(cid:80)n
j=1 X Iojwj(t)Y ∗2
(cid:80)n
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

j=1 wj(t)Y ∗2

j (t)

j (t)

(cid:35)⊗2

)

wi(t)Y ∗

i (t)dN∗

i (t) + op(1)

(cid:35)
(cid:35)

)

)

wi(t)Y ∗2

i

(t)βT

0 X IOEX Ioidt]

wi(t)Y ∗2

i

(t)XT

IoiXT

IOEβ0dt]

C. Zheng et al./Instrumental Variable with Competing Risk Model

17

Notice XT

IOEβ0 = β0e[XT

IoX Io]−1XT

(cid:90) τ

n(cid:88)

(cid:34)

n−1/2

−β0e

X IOE(X Ioi −

i=1

0

V ar(S22n) =

(cid:34)

(cid:90) τ

n(cid:88)

i=1

0

σ2β2
0e
n

(cid:34)

×

XIOE(X Ioi −

(cid:80)n
IoXe, we can approximate S22n by
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

j (t)

XT

Ioi[XT

)

(cid:35)

X IOE(X Ioi −

(cid:80)n
(cid:80)n
j=1 X Iojwj(t)Y ∗2
(cid:80)n
j (t)
(cid:80)n
j=1 X Iojwj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2
j (t)

j=1 wj(t)Y ∗2

(cid:35)T

)

IoXewi(t)Y ∗2

i

(t)dt]

IoX Io]−1XT
(cid:35)

j (t)

XT

Ioi[XT

IoX Io]−1X Ioi

)

wi(t)Y ∗2

i

(t)dt + op(1)

converge to Στ with probability 1. The covariance between S11n and S22n converge to
0 with probability 1 as in [13].

Now we look at the last term S23n. Under same argument as [20], the empirical

process and Lenglart’s inequality [29] with there approximations provide us

√

nS23n = n−1/2

where

q(u) = −limn→∞n−1

(cid:90) τ

n(cid:88)

i=1

0

(cid:90) τ

0

n(cid:88)
n(cid:88)

i=1

π(u) = limn→∞n−1

I(Ti ≥ u)

n(cid:88)

i=1

q(u)
π(u)

dM c

i (u) + op(1) = n−1/2

Φ3i(τ ),

X IOE(X Ioi −

(cid:80)n
(cid:80)n

j=1

T

i wi(t)Y ∗2
˜X
j=1 wi(t)Y ∗2
(t)

i

i

(t)

 wi(t)Y ∗

i (t)dMi(t)I(t ≥ u ≥ Ti)

)

i=1

So the third term variance is 0 and thus is ignorable comparing to the ﬁrst two terms.
As weighted estimating equation approach, the third term is asymptotically uncorre-
lated with ﬁrst two terms and thus we obtain the asymptotic variance of the ˆbeta as
τ (Ψτ + Στ )Ω−1
Ω−1

τ with inﬂuence function Φi = Φ1i + Φ2i + Φ3i.

A.3. Proof of Theorem 3:
We will ﬁrst study the performance of − log(1− ˆF1(t|Xe = xe, X o = xo)) = ˆh∗
t ˆβT[xe, xo]. We can write this as

0(t)+

n1/2(ˆh∗

0(t) + tˆβ

(cid:90) t
(cid:90) t

0

0

0[xe, xo])

T

[xe, xo] − h∗

(cid:80)n
i=1 wi(s) ˆYi(s)[d ˆNi(s) − ˆYi(s)ˆβ
(cid:80)n
i=1 wi(s) ˆY 2
i (s)
i (s) − Y ∗
i=1 wi(s)Y ∗
i (s)ˆβ
i=1 wi(s)Y ∗2
(s)

0(t) − tβT
(cid:80)n
(cid:80)n

i (s)[dN∗

T

i

= n1/2(

= n1/2(

X IOEX Ioids]

− h∗

0(t) + t(ˆβ − β0)T[xe, xo])

T

X IOEX Ioids]

− h∗

0(t) + t(ˆβ − β0)T[xe, xo]) + op(1)

C. Zheng et al./Instrumental Variable with Competing Risk Model

18

i=1 ζ1i with covariance between two time t

The ﬁrst term can be written as n−1/2(cid:80)n
n−1(cid:80)n
[n−1(cid:80)n

(cid:90) t∧t(cid:48)

and t(cid:48) as

i=1 w2

0

i (s)Y 2∗
i=1 wi(s)Y ∗2

(s)dN∗
(s)]2

i

i

i (s)

converge to g(t ∧ t(cid:48)) in probability uniformly.

The second term has the covariance between two time t and t(cid:48) as

tt(cid:48)(xe, xo)Ω−1

τ (Ψτ + Στ )Ω−1

τ (xe, xo)T

The covariance between two time t and t(cid:48) for ﬁrst term and second term converge

in probability to

(xe, xo)Ω−1

τ Γ(t)t(cid:48)

So the Martingale Central limit theory provide the asymptotic of − log(1− ˆF1(t|Xe =

xe, X o = xo)). Using ∆−method, we can obtian the results in theorem 3.

References

[1] Bowden, R.J., and Turkington, D.A. (1984). Instrumental Variables., Cambridge,

England: Cambridge University Press.

[2] Imbens, G., and Angrist, J.D. (1994). Identiﬁcation and estimation of local average

treatment effects. Econometrica, 62, 467–476. DOI: 10.2307/2951620

[3] Angrist, J.D., Imbens, G., and Rubin, D.B. (1996). Identiﬁcation and causal effects
using instrumental variables. Journal of the American Statistical Association, 91,
444–455. DOI: 10.2307/2291629

[4] Zheng, C., and Zhou, X.H. (2015). Causal mediation analysis in the multilevel
intervention and multicomponent mediator case. Journal of the Royal Statistical
Society Series B, 77, 581–615. DOI: 10.1111/rssb.12082

[5] Didelez V., and Sheehan, N. (2007). Mendelian randomization as an instrumental
variable approach to causal inference. Statistical Methods in Medical Research,16,
309–330. DOI: 10.1177/0962280206077743

[6] Angrist, J.D., and Evans, W.N. (1996). Children and their parents’ labor supply:
Evidence from exogenous variation in family size. The American Economic Review,
88, 450–477. DOI: 10.3386/w5778

[7] Fenske, T.S., Hari, P.N., Carreras, J., Zhang, M.J., Kamble, R.T., Bolwell, B.J.,
Cairo, M.S., Champlin, R.E., Chen, Y.B., Freytes, C.O., Gale, R.P., Hale, G.A., Il-
han, O., Khoury, H.J., Lister, J., Maharaj, D., Marks, D.I., Munker, R., Pecora, A.L.,
Rowlings, P.A., Shea, T.C., Stiff, P., Wiernik, P.H., Winter, J.N., Rizzo, J.D., van Be-
sien, K., Lazarus, H.M., and Vose, J.M. (2009). Impact of pre-transplant Rituximab
on survival after autologous hematopoietic stem cell transplantation for diffuse large
B-cell lymphoma. Biology of Blood and Marrow Transplantation, 15,1455–1464.
DOI: 10.1016/j.bbmt.2009.07.017.

[8] Wright, S. (1928). Appendix to The Tariff on Animal and Vegetable Oils, by P. G.

Wright, New York: MacMillan.

C. Zheng et al./Instrumental Variable with Competing Risk Model

19

[9] Hansen, L.P. (1982). Large sample properties of generalized method of moments

estimators. Econometrica, 50, 1029–1054. DOI: 10.2307/1912775

[10] Robins, J., and Tsiatis, A. (1991). Correcting for non-compliance in random-
ized trials using rank preserving structural failure time models. Communication in
Statistics-Theory and Methods, 20, 2609–2631. DOI: 10.1080/03610929108830654
[11] Loeys, T., and Goetghebeur, E. (2003). A causal proportional hazards estimator
for the effect of treatment actually received in a randomized trial with all-or-nothing
compliance. Biometrics, 59, 100–105. DOI: 10.1111/1541-0420.00012

[12] Chen, S., Hsiao, C., and Wang, L. (2011). Measurement errors and cen-
sored structural latent variables models. Econometric Theory, 28, 696–710. DOI:
10.2307/23257649

[13] Li, J., Fine, J, and Brookhart, A. (2014). Instrumental variable additive hazard

models. Biometrics, 71, 122–130. DOI: 10.1111/biom.12244

[14] Lin, D. Y., and Ying, Z. (1994). Semi parametric analysis of the additive risk

model. Biometrika, 81, 61–71. DOI: 10.1093/biomet/81.1.61

[15] Chan, K. C. (2016). Instrumental variable additive hazards models with exposure-

dependent censoring. Biometrics, Epub ahead of print. DOI: 10.1111/biom.12471

[16] Cheng, S.C., Fine, J.P., and Wei, L.J. (1998). Predication of Cumulative Inci-
dence Function under the Proportional Hazards Model. Biometrics,54, 219–228.
DOI: 10.2307/2534009

[17] Shen, Y. and Cheng, S. C. (1999). Conﬁdence Bands for Cumulative Inci-
dence Curves under the Additive Risk Model. Biometrika,55, 1093–1100. DOI:
10.1111/j.0006-341X.1999.01093.x

[18] Scheike, T.H., and Zhang, M.J.

(2002). An Additive-Multiplicative Cox-
Aalen Model. Scandinavian Journal of Statistics, 28, 75–88. DOI: 10.1111/1467-
9469.00065

[19] Scheike, T.H., and Zhang, M.J. (2003). Extensions and Applications of the
Cox-Aalen Survival Models. Biometrics, 59, 1033–1045. DOI: 10.1111/j.0006-
341X.2003.00119.x

[20] Fine, J, and Gray, R.J. (1999). A proportional hazards model for the subdistribu-
tion of a competing risk. Journal of the American Statistical Association, 94, 496–
509. DOI: 10.2307/2670170

[21] Sun, L., Liu, J., Sun, J., and Zhang, M. (2006). Modeling the subdistribution of a

competing risk. Statistica Sinica, 16, 1367–1385.

[22] Eriksson, F., Li J., Scheike, T. and Zhang, M. (2015). The proportional odds
cumulative incidence model for competing risks. Biometrics, 71, 687–695. DOI:
10.1111/biom.12330

[23] Scheike, T.H., and Zhang, M.J. (2008). Flexible competing risks regres-
sion modelling and goodness-of-ﬁt. Lifetime Data Analysis, 14, 464–483. DOI:
10.1007/s10985-008-9094-0

[24] Scheike, T., Zhang, M.J., and Gerds, T. (2008). Predicting Cumulative Inci-
dence Probability by direct binomial regression. Biometrika, 95, 205–220. DOI:
10.1093/biomet/asm096

[25] Scheike, T.H., and Zhang, M.J. (2011). Analyzing competing risk data using the

R timereg package. Journal of the Statistical Software, 38, 1–15.

[26] Bagg A. (2011). B cells behaving badly: a better basis to behold belligerence in

C. Zheng et al./Instrumental Variable with Competing Risk Model

20

B-cell lymphomas. Hematology Am Soc Hematol Educ Program, 2011, 330–335.
DOI: 10.1182/asheducation-2011.1.330

[27] Zhang, X., Zhang, M., and Fine, J. (2011). A proportional hazards regression
model for the subdistribution with right-censored and left-truncated competing risks
data. Statistics in Medicine, 30, 1933–1951. DOI: 10.1002/sim.4264.

[28] Newey, W., and McFadden, D. (1993). Estimation in large samples. Handbook of

Econometrics, 5 eds. D. McFadden and R. Engler, Amsterdam: North-Holland.

[29] Lenglart, E. (1997). Relation de domination entre deux processus. Annales Insti-

tut Henri Poincare, 13, 171–179.

