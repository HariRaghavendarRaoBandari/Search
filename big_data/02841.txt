6
1
0
2

 
r
a

 

M
0
3

 
 
]

.

O
C
h
t
a
m

[
 
 

2
v
1
4
8
2
0

.

3
0
6
1
:
v
i
X
r
a

IMPROPER COLORING OF GRAPHS ON SURFACES

ILKYOO CHOI AND LOUIS ESPERET

Abstract. A graph G is (d1, . . . , dk)-colorable if its vertex set can be partitioned into
k sets V1, . . . , Vk, such that for each i ∈ {1, . . . , k}, the subgraph of G induced by Vi has
maximum degree at most di. The Four Color Theorem states that every planar graph is
(0, 0, 0, 0)-colorable, and a classical result of Cowen, Cowen, and Woodall shows that every
planar graph is (2, 2, 2)-colorable. In this paper, we extend both of these results to graphs
on surfaces. Namely, we show that every graph embeddable on a surface of Euler genus
g > 0 is (0, 0, 0, 9g − 4)-colorable and (2, 2, 9g − 4)-colorable. Moreover, these graphs are
also (0, 0, O(√g), O(√g))-colorable and (2, O(√g), O(√g))-colorable. We also prove that
every triangle-free graph that is embeddable on a surface of Euler genus g is (0, 0, O(g))-
colorable. This is an extension of Gr¨otzsch’s Theorem, which states that triangle-free
planar graphs are (0, 0, 0)-colorable. Finally, we prove that every graph of girth at least 7
that is embeddable on a surface of Euler genus g is (0, O(√g))-colorable. All these results
are best possible in several ways as the girth condition is sharp, the constant maximum
degrees cannot be improved, and the bounds on the maximum degrees depending on g
are tight up to a constant multiplicative factor.

1. Introduction

For a sequence (d1, d2, . . . , dk) of k integers, we say that a graph G is (d1, d2, . . . , dk)-
colorable if each vertex of G can be assigned a color from the set {1, 2, . . . , k} in such
a way that for each i ∈ {1, . . . , k}, a vertex colored i has at most di neighbors colored
i. In other words, each color class i induces a subgraph of maximum degree at most di.
Note that a proper coloring is the same as a (0, 0, . . . , 0)-coloring. For an integer d, a
(d, d, . . . , d)-coloring is sometimes called a d-improper coloring or d-defective coloring.

The Four Color Theorem [1, 2] states that every planar graph is (0, 0, 0, 0)-colorable,
and it was proved by Cowen, Cowen, and Woodall [6] that every planar graph is also
(2, 2, 2)-colorable. For any integer k, it is not diﬃcult to construct a planar graph that is
not (k, k)-colorable; one can even ﬁnd such planar graphs that are triangle-free (see [13]).
A natural question to ask is how these results can be extended to graphs embeddable
on surfaces with higher (Euler) genus. Cowen, Cowen, and Woodall [6] proved that every
graph of Euler genus g is (c4, c4, c4, c4)-colorable with c4 = max{14, 1
3(4g − 11)}, and
conjectured that the same should hold with three colors instead of four. This was proved by
Archdeacon [3], who showed that every graph of Euler genus g is (c3, c3, c3)-colorable with

Ilkyoo Choi is supported by the National Research Foundation of Korea (NRF) grant funded by the

Korea government (MSIP) (NRF-2015R1C1A1A02036398).

Louis Esperet is partially supported by ANR Project Stint (anr-13-bs02-0007), and LabEx

PERSYVAL-Lab (anr-11-labx-0025).

1

2

ILKYOO CHOI AND LOUIS ESPERET

2(3g − 8)}. The value c3 was subsequently improved to max{12, 6 +√6g} by
c3 = max{15, 1
Cowen, Goddard, and Jesurum [7], and eventually to max{9, 2+√4g + 6} by Woodall [14].

In this paper, we will show that in the original result of Cowen, Cowen, and Woodall [6],
it suﬃces that only one of the four color classes is not a stable set. Namely, we will
prove that every graph that is embeddable on a surface of Euler genus g > 0 is both
(0, 0, 0, 9g − 4)-colorable and (2, 2, 9g − 4)-colorable. These come as natural extensions of
the fact that planar graphs are (0, 0, 0, 0)-colorable and (2, 2, 2)-colorable. Interestingly,
there is a constant c1 > 0 such that the bound 9g − 4 in these results cannot be replaced
by c1 · g, so there is no hope to obtain a bound of the same order as c3 above. In other
words, the growth rate of the bound 9g − 4 cannot be improved to a sublinear function of
g in both results.
However, when two color classes are allowed to have non-constant maximum degrees, we
show that the bound 9g − 4 can be improved to a sublinear function of g in both results.
Namely, any graph embeddable on a surface of Euler genus g is both (0, 0, K1(g), K1(g))-
colorable and (2, K2(g), K2(g))-colorable with K1(g) = 20 + √48g + 481 and K2(g) =
38 + √84g + 1682. We also show that the growth rate of K1(g) and K2(g) are tight in
terms of g.

A famous theorem of Gr¨otzsch [10] states that every triangle-free planar graph is 3-
colorable.
In this paper, we prove that this can be extended to graphs embeddable on
surfaces as follows: every triangle-free graph embeddable on a surface of Euler genus g is
(0, 0, K3(g))-colorable where K3(g) = (cid:100) 10g+32
(cid:101). We prove that K3(g) cannot be replaced by
a sublinear function of g, even for graphs of girth at least 6. It was proved by ˇSkrekovski [13]
that for any k, there exist triangle-free planar graphs that are not (k, k)-colorable. This
shows that there does not exist any 2-color analogue of our result on triangle-free graphs
on surfaces.

3

Finally, we prove that every graph of girth at least 7 embeddable on a surface of Euler

constant c2 > 0 such that for inﬁnitely many values of g, there exist graphs of girth at

Choi, Choi, Jeong, and Suh [5] proved that every graph of girth at least 5 embeddable
on a surface of Euler genus g is (1, K4(g))-colorable where K4(g) = max{10,(cid:100) 12g+47
(cid:101)}.
They also show that the growth rate of L(g) cannot be replaced by a sublinear function of
g. On the other hand, for each k, Borodin, Ivanova, Montassier, Ochem, and Raspaud [4]
constructed a planar graph of girth 6 that is not (0, k)-colorable.

genus g is (0, 5 +(cid:6)√14g + 22(cid:7))-colorable. On the other hand, we show that there is a
least 7 embeddable on a surface of Euler genus g, with no (0,(cid:98)c2√g(cid:99))-coloring.
The results of this paper together with the aforementioned results completely solve1 the
following problem: given integers (cid:96) (cid:54) 7, k, and g, ﬁnd the smallest k-tuple (d1, . . . , dk)
in lexicographic order, such that every graph of girth at least (cid:96) embeddable on a surface of
Euler genus g is (d1, . . . , dk)-colorable.

7

1up to a constant multiplicative factor for the maximum degrees di, depending on g.

IMPROPER COLORING OF GRAPHS ON SURFACES

3

2. Preliminaries

2.1. Graphs on surfaces. All graphs in this paper are simple, which means without loops
and multiple edges. In this paper, a surface is a non-null compact connected 2-manifold
without boundary. We refer the reader to the monograph of Mohar and Thomassen [12]
for background on graphs on surfaces.
A surface is either orientable or non-orientable. The orientable surface Sh of genus h
is obtained by adding h (cid:62) 0 handles to the sphere, and the non-orientable surface Nk
of genus k is formed by adding k (cid:62) 1 cross-caps to the sphere. The Euler genus eg(Σ)
of a surface Σ is deﬁned as twice its genus if Σ is orientable, and as its genus if Σ is
non-orientable.
We say that an embedding is cellular if every face is homeomorphic to an open disc
of R2. Euler’s Formula states that if G is a graph with a cellular embedding in a surface Σ,
with vertex set V , edge set E, and face set F , then |V | − |E| + |F| = 2 − eg(Σ).
If f is a face of a graph G cellularly embedded in a surface Σ, then a boundary walk of f
is a walk consisting of vertices and edges as they are encountered when walking along the
whole boundary of f , starting at some vertex and following some orientation of the face.
The degree of a face f , denoted d(f ), is the number of edges on a boundary walk of f .
Note that some edges may be counted more than once.

Let G be a graph embedded in a surface Σ. A cycle C of G is said to be non-contractible
if C is non-contractible as a closed curve in Σ. Also, C is called separating if C separates
Σ in two connected pieces, otherwise C is non-separating. It is well known that only three
types of non-contractible cycles exist (see [12]): 2-sided separating cycles, 2-sided non-
separating cycles, and 1-sided cycles (the latter only appear in non-orientable surfaces,
and are non-separating).

The following fact, which is often called the 3-Path Property, will be used: if P1, P2, P3
are three internally disjoint paths with the same endpoints in G, and P1 ∪ P2 is a non-
contractible cycle, then at least one of the two cycles P1∪P3, P2∪P3 is also non-contractible;
see for instance [12, Proposition 4.3.1].
We will need the following simple observation about shortest non-contractible cycles.

The proof presented here is due to Gwena¨el Joret.

Observation 1. Let G be a graph embedded on some surface. If C is a shortest non-
contractible cycle in G, then C is an induced cycle and each vertex of G has at most 3
neighbors in C.

Proof. It is easy to see that if C has a chord, then by the 3-Path Property, G contains a
non-contractible cycle shorter than C (recall that G is simple), a contradiction. This shows
that C is an induced cycle, and in particular, every vertex of C has at most 2 neighbors
in C.
Assume now that some vertex v not in C has k (cid:62) 4 neighbors in C (in particular, C
contains at least 4 vertices). Each subpath of C whose end points are neighbors of v and
whose internal vertices are not adjacent to v is called a basic subpath of C. Note that the
edges of C are partitioned into k basic subpaths of C. Since v has at least 4 neighbors in

4

ILKYOO CHOI AND LOUIS ESPERET

C, each basic subpath contains at most |C| − 3 edges. A basic cycle is obtained from a
basic subpath P of C with endpoints u, w by adding the vertex v and the edges vu and
vw, which are the rays of the basic cycle.

The embedding of G gives an order on the edges incident to v. If the rays of some basic
cycle are not consecutive (among the rays of basics cycles) in the order around v, then
this basic cycle cannot bound a region homeomorphic to an open disk, and is thus non-
contractible. Since this basic cycle has length at most |C|−3+2 < |C|, this contradicts the
minimality of C. We can therefore assume the two rays of each basic cycle are consecutive
in the order around v, and each basic cycle bounds a region homeomorphic to an open
disk. By gluing these k regions together, we obtain that C bounds a region homeomorphic
(cid:3)
to an open disk, which contradicts the fact that C is non-contractible.

2.2. Coloring Lemmas. For two integers j < k, let d1, d2, . . . , dk be such that d1 = ··· =
dj = K and max{dj+1, . . . , dk} < K. In this section, we study the properties of a graph Gj,k
that is not (d1, . . . , dk)-colorable, while all its induced subgraphs are (d1, . . . , dk)-colorable.
Let c1, . . . , ck be the k colors of a (d1, . . . , dk)-coloring ϕ such that the maximum degree of
the graph induced by the color ci is at most di for i ∈ {1, . . . , k}. A vertex v is ci-saturated
if ϕ(v) = ci and v has di neighbors colored ci. Note that by deﬁnition, a ci-saturated vertex
has at least di neighbors.
For any integer d, a d-vertex is a vertex of degree d, a d+-vertex is a vertex with degree
at least d, and a d−-vertex is a vertex with degree at most d . The same notation applies
to faces instead of vertices.

Lemma 2. A (K +k−1)−-vertex of Gj,k has at least j neighbors that are (K +k)+-vertices.
Proof. Assume for the sake of contradiction that a (K + k − 1)−-vertex v has at most j − 1
neighbors that are (K + k)+-vertices. By hypothesis, Gj,k − v has a (d1, . . . , dk)-coloring ϕ.
Obtain a coloring ϕ(cid:48) from ϕ by recoloring each neighbor of v with a color from cj+1, . . . , ck,
if possible. Now, the colors c1, . . . , ck must all appear in the neighborhood of v, since
otherwise we can extend ϕ(cid:48) to Gj,k by coloring v with the missing color from c1, . . . , ck.
Since v is adjacent to at most j − 1 vertices of degree at least K + k, there exists a color cl
with l ∈ {1, . . . , j} such that no neighbor of v that is a (K + k)+-vertex is colored with cl.
If there is a cl-saturated neighbor u of v, then we can recolor u with a color that is not cl.
This is because u cannot be both cl-saturated and have colors c1, . . . , ck all appear in its
neighborhood since u has degree at most K + k − 1. Therefore, we can extend the coloring
ϕ(cid:48) to all of Gj,k by letting ϕ(cid:48)(v) = cl. We obtained a (d1, . . . , dk)-coloring of Gj,k, which is
(cid:3)
a contradiction.

Lemma 3. There are at least 1 +(cid:80)k
that |H| (cid:54)(cid:80)k

i=2(di + 1) vertices in Gj,k that are (K + k)+-vertices.
Proof. Let H be the set of (K+k)+-vertices of Gj,k, and assume for the sake of contradiction
i=2(di + 1). Partition H into k − 1 sets S2, . . . , Sk such that |Si| = di + 1 for
i ∈ {2, . . . , k}.
Let ϕ be a (d1, . . . , dk)-coloring of H where a vertex in Si receives the color ci for
i ∈ {2, . . . , k}. Since each Si has at most di + 1 vertices, the maximum degree of the graph

IMPROPER COLORING OF GRAPHS ON SURFACES

5

induced by Si cannot be more than di, so ϕ is indeed a (d1, . . . , dk)-coloring of H. We now
extend ϕ to a (d1, . . . , dk)-coloring ϕ(cid:48) of Gj,k in the following greedy fashion: consider a
ﬁxed ordering of the vertices in V (Gj,k) − H and for each vertex v in this ordering, we do
the following: if the neighborhood of v does not contain some color ci with i (cid:62) 2 then we
assign ci to v, and otherwise we assign c1 to v.
To verify that ϕ(cid:48) is a (d1, . . . , dk)-coloring of Gj,k, we only need to check that the vertices
colored with c1 induce a graph of maximum degree at most d1 + 1. Since no vertex in H is
colored with c1 we know that a vertex v colored with c1 has degree at most K + k− 1. Also,
v must have neighbors colored with c2, . . . , ck by the greedy algorithm. Now, v cannot have
K + 1 neighbors colored with c1 since it has degree at most K + k − 1. This shows that ϕ(cid:48)
(cid:3)

is a (d1, . . . , dk)-coloring of Gj,k, which is a contradiction.

2.3. Discharging procedure. When an embedding of a counterexample G is ﬁxed, we
can let F (G) denote the set of faces of this embedding. We will prove that G cannot
exist by assigning an initial charge µ(z) to each z ∈ V (G) ∪ F (G), and then applying a
discharging procedure to end up with ﬁnal charge µ∗(z) at z. The discharging procedure
will preserve the sum of the initial charge, yet, we will prove that the ﬁnal charge sum is
greater than the initial charge sum, and hence we ﬁnd a contradiction to conclude that the
counterexample G does not exist.

3. Graphs on Surfaces

3.1. One part with large maximum degree. Given a connected subgraph H of a graph
G, let G/H denote the graph obtained from G by contracting the edges of H into a single
vertex.

The proof of the next result uses a technique that is similar to a tool introduced in [11],

yet our presentation is quite diﬀerent.

Theorem 4. For every g > 0, every connected graph G of Euler genus g, and every vertex
v of G, the graph G has a connected subgraph H containing v, such that G/H is planar
and every vertex of G has at most 9g − 4 neighbors in H.
Proof. We will prove the theorem by induction on g. Let G(cid:48) be a connected graph of Euler
genus g(cid:48) with 0 (cid:54) g(cid:48) < g, and let P be a shortest path between two vertices u and w of
G(cid:48). Since P is a shortest path, each vertex of G(cid:48) has at most 3 neighbors in P . Note that
the graph G∗ = G(cid:48)/P , which is the graph obtained from G(cid:48) by contracting P into a single
vertex v∗, has Euler genus at most g(cid:48). If g(cid:48) = 0, then both G(cid:48) and G∗ are planar. If g(cid:48) > 0,
then by the induction hypothesis, G∗ has a connected subgraph H∗ containing v∗, such
that G∗/H∗ is planar and every vertex of G∗ has at most 9g(cid:48)
− 4 neighbors in H∗. Let
H(cid:48) be the subgraph of G(cid:48) induced by the vertices of H∗ and P . Since H∗ contains v∗, we
know that H(cid:48) is connected, and thus G(cid:48)/H(cid:48) is well-deﬁned. Note that G(cid:48)/H(cid:48) is planar. For
a vertex x of G(cid:48), if x is on P , then x has at most two neighbors in P and at most 9g(cid:48)
− 4
− 2 neighbors in H(cid:48). Otherwise x (cid:54)∈ P ,
neighbors in H∗, and therefore x has at most 9g(cid:48)
and x has at most three neighbors in P and at most 9g(cid:48)
− 4 neighbors in H∗ (including v∗
− 2 neighbors in H(cid:48).
if x has a neighbor in P ), and therefore x has at most 9g(cid:48)

6

ILKYOO CHOI AND LOUIS ESPERET

We proved that for any 0 (cid:54) g(cid:48) < g, any connected graph G(cid:48) of Euler genus g(cid:48), and any
pair u, w of vertices of G(cid:48), there is a connected subgraph H(cid:48) of G(cid:48) containing u and w such
that G(cid:48)/H(cid:48) is planar and every vertex of G(cid:48) has at most max{3, 9g(cid:48)
− 2} neighbors in H(cid:48).
This argument shall be used repeatedly in the remainder of the proof and we sometimes
call it the reﬁned induction. Note that the reﬁned induction holds for graphs with Euler
genus g(cid:48)
∈ {0, . . . , g − 1} whereas the induction only works when g(cid:48)

∈ {1, . . . , g − 1}.

Given a graph G with positive Euler genus g and a speciﬁed vertex v, let C be a shortest
non-contractible cycle. Such a cycle exists, since otherwise G would be embeddable in the
plane and we would have g = 0.

1 and G∗

1 of G∗
2 of G∗

1/H∗

1 and G∗

2/H∗

1 is planar, and every vertex of G∗

1/H∗
2 is planar, and every vertex of G∗

Assume ﬁrst that C is a 2-sided separating cycle. By cutting along C (as described in [12,
Section 4.2], for example), we obtain two graphs G1 and G2 embedded in two surfaces Σ1
and Σ2 of Euler genus g1 > 0 and g2 > 0, respectively, such that g = g1 + g2. By symmetry,
we can assume that v lies in G1. Note that C corresponds to a face f1 and a face f2 in G1
and G2, respectively. For i = 1, 2, let G∗
i be the graph obtained from Gi by contracting all
the vertices of fi into a single vertex vi. Note that G∗
2 are embeddable on surfaces
of Euler genus g1 and g2, respectively.
By the reﬁned induction hypothesis, there is a connected subgraph H∗
1 containing
v and v1, such that G∗
1 has at most 9g1−2 neighbors in
H∗
1 . By the induction hypothesis, there is also a connected subgraph H∗
2 containing
2/H∗
v2, such that G∗
2 has at most 9g2 − 4 neighbors in
1 , C, and H∗
2 . Let H be subgraph of G induced by the vertices of H∗
H∗
2 . We know that
H is connected and contains v. Moreover, G/H is also planar since it is obtained by
identifying v1 and v2 from the two planar graphs G∗
2 . Since C is a shortest
non-contractible cycle, it follows from Observation 1 that C is an induced cycle and each
vertex not in C has at most three neighbors in C. As a consequence, each vertex of C has
at most (9g1 − 2) + (9g2 − 4) + 2 = 9g − 4 neighbors in H, and each vertex not in C has at
most max{(9g1 − 2) + 2, (9g2 − 4) + 2} (cid:54) 9g − 9 neighbors in H. Thus, we have obtained
a connected subgraph H containing v such that G/H is planar and every vertex of G has
at most 9g − 4 neighbors in H, as desired.
Assume now that C is a 1-sided cycle. By cutting along C we obtain a graph G(cid:48)
embedded in a surface Σ(cid:48) of Euler genus g(cid:48)
∈ {0, . . . , g − 1} in which C corresponds to a
face f . Contract all the vertices of f into a single vertex v∗, and note that the resulting
graph G∗ can also be embedded in Σ(cid:48). By the reﬁned induction hypothesis, G∗ has a
connected subgraph H∗ containing v and v∗ such that G∗/H∗ is planar and every vertex
− 2} (cid:54) 9g(cid:48) + 3 (cid:54) 9g − 6 neighbors in H∗. Using the same
of G∗ has at most max{3, 9g(cid:48)
argument as above, the subgraph H of G induced by vertices of H∗ and C is connected,
G/H is planar, and every vertex of G has at most 9g − 6 < 9g − 4 neighbors in H.
cutting along C yields a graph G(cid:48) embeddable on a surface Σ(cid:48) of Euler genus g(cid:48) (cid:54) g − 2, in
which C corresponds to two faces f1 and f2 lying in the same connected component. We
take a shortest path P between f1 and f2 in G(cid:48), and then contract all the vertices of f1,
P , and f2 into a single vertex v∗. Note that the resulting graph G∗ is embeddable on Σ(cid:48).

It remains to consider the case when C is a 2-sided non-separating cycle. In this case,

IMPROPER COLORING OF GRAPHS ON SURFACES

7

By the reﬁned induction hypothesis, G∗ has a connected subgraph H∗ containing v and v∗
− 2} (cid:54) 9g(cid:48) + 3
such that G∗/H∗ is planar and every vertex of G∗ has at most max{3, 9g(cid:48)
neighbors in H∗. Let H be the subgraph of G induced by the vertices of C, P , and H∗.
Since H is connected, G/H is well-deﬁned and is therefore planar. Let u be a vertex of
G not in C ∪ P . Since C is a shortest non-contractible cycle in G, by Observation 1 the
vertex u has at most 3 neighbors in C. Since P is a shortest path in G(cid:48), v has at most
3 neighbors in P and therefore v has at most 6 neighbors in C ∪ P .
It follows that u
has at most (9g(cid:48) + 3) + 6 − 1 = 9g(cid:48) + 8 (cid:54) 9g − 10 neighbors in H. By Observation 1, a
vertex u of C ∪ P has at most 3 + 2 = 5 neighbors in C ∪ P . It follows that u has at
most (9g(cid:48) + 3) + 5 (cid:54) 9g − 10 neighbors in H. Consequently, H is a connected subgraph
containing v such that G/H is planar and each vertex of G has at most 9g − 4 neighbors
(cid:3)
in H, as desired.

We are now able to obtain the two following results as simple consequences of Theorem 4.
Theorem 5. For each g > 0, every graph of Euler genus g has a (0, 0, 0, 9g − 4)-coloring.
Proof. Let G be a graph of Euler genus g > 0. We may assume that G is connected,
since we can color each connected component independently (and each of its connected
components has Euler genus at most g). By Theorem 4, G has a connected subgraph H
such that G/H is planar and every vertex of G has at most 9g − 4 neighbors in H. By the
Four Color Theorem, G/H has a proper 4-coloring. Assume without loss of generality that
the vertex v of G/H resulting from the contraction of H has the fourth color. We extend
this coloring to G by assigning the fourth color to all vertices of H. Since each vertex of
H has at most 9g − 4 neighbors in H, and each neighbor of a vertex of H outside H does
not have the fourth color, the obtained coloring is indeed a (0, 0, 0, 9g − 4)-coloring of G,
(cid:3)
as desired.
Theorem 6. For each g > 0, every graph of Euler genus g has a (2, 2, 9g − 4)-coloring.
Proof. Let G be a graph of Euler genus g > 0. As before, we may assume that G is
connected, since we can color each connected component independently. By Theorem 4, G
has a connected subgraph H such that G/H is planar and every vertex of G has at most
9g − 4 neighbors in H. Cowen, Cowen, and Woodall [6] proved that for every planar graph
G(cid:48) and any speciﬁed vertex v(cid:48) in G(cid:48), the graph G(cid:48) has a (2, 2, 2)-coloring in which v(cid:48) has
no neighbor of its color. It follows that G/H has a (2, 2, 2)-coloring in which the vertex v
of G/H resulting from the contraction of H has no neighbor of its color; without loss of
generality assume that v has the third color. We extend this coloring to G by assigning the
third color to all vertices of H. Since each vertex of H has at most 9g − 4 neighbors in H,
and each neighbor of a vertex of H outside H does not have the third color, the obtained
(cid:3)
coloring is indeed a (2, 2, 9g − 4)-coloring of G, as desired.

We now prove that Theorems 5 and 6 are best possible, up to the multiplicative constant
9. More precisely, we will show that 9g − 4 cannot be replaced by a sublinear function of
g in Theorems 5 and 6.

8

ILKYOO CHOI AND LOUIS ESPERET

Given a graph H and an integer k, we construct the graph S(H, k) as follows. We start
with a copy of H, which we call the basic copy of H. For each vertex v in the basic copy,
we add all possible edges between v and k new pairwise disjoint copies of H. Observe that
if H has n vertices and m edges, then S(H, k) has n + kn2 vertices and m + kn(n + m)
edges.

that G1 is a graph of Euler genus g with no (0, 0, 0,(cid:100) g−48

Consider the graph G1 = S(K4, k + 1), for some integer k. Note that G1 has at most
40k + 46 edges, and hence G1 has Euler genus at most 40k + 48. Assume for the sake of
contradiction that G1 has a (0, 0, 0, k)-coloring, say with colors 1, 2, 3, 4, where the fourth
color induces a graph with maximum degree at most k. Since colors 1, 2, 3 induce stable
sets, at least one of the vertices of the basic copy of K4, call it v, is colored 4. Since v has
at most k neighbors colored 4, at least one of the copies of K4 joined to v has no vertex
colored 4, and hence is properly colored with 1, 2, 3, which is a contradiction. It follows
40 (cid:101))-coloring (and such a graph can
We now consider G2 = S(K7, k + 1), for some integer k. The graph G2 has at most
196k + 217 edges, and therefore Euler genus at most 196k + 219.
If G2 admits some
(2, 2, k)-coloring with colors 1, 2, 3, where colors 1, 2 induce a graph with maximum degree
2 and color 3 induces a graph with maximum degree k, then some vertex v of the basic
copy of K7 in G2 has color k. As before, v has to be joined to a copy of K7 in which all
the vertices have color 1 or 2, which is a contradiction. Therefore, we found, for inﬁnitely

be constructed for inﬁnitely many values of g).

many values of g, a graph with Euler genus g with no (2, 2,(cid:100) g−219

196 (cid:101))-coloring.

By considering the graph S(Kn, (cid:96)), for large n and (cid:96), it is not diﬃcult to see that for
any k, there is a constant  > 0 such that we can construct (for inﬁnitely many values of
g) graphs of Euler genus g with no (k, k,(cid:100) g(cid:101))-coloring.
Note however that if we let the maximum degree of the second color class to be a function
in g, then the maximum degree of the third color class can be made sublinear: it can be
derived from the main result of [14] that every graph of Euler genus g is (9, O(√g), O(√g))-
In the next subsection, we will prove that every graph of Euler genus g is
colorable.
(2, O(√g), O(√g))-colorable and the constant 2 there is best possible.
It is a folklore
result that for any k, there exist planar graphs that are not (1, k, k)-colorable. Since we
have not been able to ﬁnd a reference of this result, we include a construction below for
the sake of completeness. This result implies that Theorems 5, 6, 7, and 9 cannot be
improved by reducing the number of colors, or the maximum degree of the monochromatic
components (except for the color classes whose degree depends on g).

Construction of planar graphs that are not (1, k, k)-colorable.

In a (1, k, k)-
coloring, let 1, k1, k2 be the three colors where the vertices of color 1, k1, k2 induce a graph
of maximum degree at most 1, k, k, respectively. Given a planar graph G and two adjacent
vertices x and y, by thickening the edge xy we mean adding 2k + 1 paths on 3 vertices to
G, and making all the newly added vertices adjacent to both x and y (see Figure 1, left).
Note that this can be done in such way that the resulting graph H is also planar. We claim
that in any (1, k, k)-coloring c of H, we do not have {c(x), c(y)} = {k1, k2}. Otherwise,

IMPROPER COLORING OF GRAPHS ON SURFACES

9

some path on 3 vertices joined to x and y would not contain colors k1 and k2, and then
some vertex of color 1 would have two neighbors colored 1, a contradiction.

Now, take a cycle C on 3k + 1 vertices, and add a vertex v adjacent to all the vertices of
C. The obtained graph Gv is planar. Now, thicken all the edges of G joining v and C, and
call the resulting graph Hv (see Figure 1, center). We claim that in any (1, k, k)-coloring c
of Hv, c(v) = 1. Suppose for the sake of contradiction that v has color k1 or k2 (say k1 by
symmetry). Then at least 2k + 1 of the neighbors of v in C have color 1 or k2. Since no
three consecutive vertices of C have color 1, at least one vertex u of C has color k2. Since
the edge uv was thickened, this contradicts the previous paragraph.

Figure 1. A construction of a planar graph that is not (1, k, k)-colorable.

Our construction now proceeds as follows. Start with a triangle uvw, and then identify
u with the vertex u of some copy of Hu, v with the vertex v of some copy of Hv and w with
the vertex w in some copy of Hw (see Figure 1, right). Note that in any (1, k, k)-coloring
of this graph, at least one of u, v, w has a color distinct from 1. It then follows from the
previous paragraph that this graph is not (1, k, k)-colorable.

3.2. Two parts with large maximum degrees.

Theorem 7. A graph embeddable on a surface of Euler genus g is (2, K, K)-colorable where
K = K(g) = 38 + √84g + 1682.
Proof. Assume for the sake of contradiction that there is a graph G embeddable on a
surface of Euler genus g that is not (2, K, K)-colorable. We choose g minimum, and with
respect to this, we choose G such that the sum of the number of vertices and the number
of edges is minimum. By the minimality of g we may assume that G is cellularly embedded
on a surface of Euler genus g (see [12, Propositions 3.4.1 and 3.4.2]) and from now on, we
ﬁx this embedding.

By the minimality of G, we can also assume that G is connected and has minimum
degree at least 3. A high and low vertex is a vertex of degree at least K + 3 and at most

xyxy...z···zabc10

ILKYOO CHOI AND LOUIS ESPERET

K + 2, respectively. By Lemma 2, every low vertex is adjacent to at least two high vertices.
By Lemma 3, G contains at least K + 5 high vertices.

Claim 8. No two vertices of degree at most 4 are adjacent.

Proof. Assume for the sake of contradiction that two vertices u, v of degree at most 4 are
adjacent. By the minimality of G, the graph obtained from G by removing the edge uv
has a (2, K, K)-coloring c. Let the three colors be 2, k1, k2 so that the maximum degree
of the graph induced by 2, k1, k2 is at most 2, K, K, respectively. Since G itself is not
(2, K, K)-colorable, both u and v are colored 2 and at least one of u, v, say u, has two
neighbors (distinct from v) that are also colored 2. As a consequence, either k1 or k2 does
not appear in the neighborhood of u. We can therefore recolor u with the missing color to
(cid:3)
get a (2, K, K)-coloring of G, a contradiction.

We will use the discharging procedure laid out in Subsection 2.3. For a vertex v and a
face f of G, the initial charge is d(v) − 6 and 2d(f ) − 6, respectively. The initial charge
sum is 6g − 12 by Euler’s formula.
Here are the discharging rules:

(R1) Each face distributes its initial charge (evenly) to its incident vertices of degree 3.
(R2) Each high vertex sends charge 13
(R3) For each high vertex v and each sequence of three consecutive neighbors u1, u2, u3 of
28 to each of u1

v in clockwise order around v such that u2 is high, v sends charge 13
and u3.

14 to each low neighbor.

(R4) Every low vertex of degree at least 5 sends charge 3

14 to each neighbor of degree at

most 4.

We now analyze the charge of each vertex and each face after the discharging procedure.
Since every face has degree at least 3, every face has nonnegative initial charge and does
not send more that its initial charge by (R1). Therefore, the ﬁnal charge of each face is
nonnegative.

14 (by (R2)) and 13

For a 3-vertex v, let x, y, z be the neighbors of v. By the claims above, we may assume
without loss of generality that x, y are high and z has degree at least 5. First, assume
that the face f incident to the edges vx and vy is a triangle, which implies that x and y
are adjacent. Then v receives charge 13
28 (by (R3)) from x, and the same
amount from y. Note that v also receives 3
14 from z by (R4). As a consequence, the ﬁnal
28 + 3
14 + 2 · 13
charge of v is at least −3 + 2 · 13
14 = 0. Now assume that the face f has degree
d (cid:62) 4. Then, v receives charge 13
14 from each of x and y by (R2), and 3
14 from z by (R4).
(cid:62) 1 to v
But since f contains at least two big vertices, it also sends charge at least 2d−6
d−2
(since d (cid:62) 4). As a consequence, the ﬁnal charge of v is at least −3 + 2 · 13
14 + 1 = 1
14 + 3
14.
Let v be a vertex of degree 4. Since v has at least two high neighbors, and all the
neighbors of v have degree at least 5, v receives charge at least 2 · 13
14 by
(R4). The ﬁnal charge of v is therefore at least −2 + 2 · 13

14 by (R2) and 2 · 3
14 = 2
7.

14 + 2 · 3

(cid:62) 3
14.

14

IMPROPER COLORING OF GRAPHS ON SURFACES

11

14d = d

14 − (d − 2) 3

14d by (R2) and (R3) and its ﬁnal charge is at least d− 6− 13

Let v be a low vertex of degree d (cid:62) 5. Then v receives charge at least 2· 13
14 by (R2) since
it has at least two high neighbors, and sends charge at most (d − 2) 3
14 by (R4). Therefore,
the ﬁnal charge of v is at least d − 6 + 2 · 13
Finally, let v be a high vertex of degree d (recall by deﬁnition, d (cid:62) K + 3). Then v sends
14 − 6 (cid:62)
charge at most 13
K−81
14 .
Since there are at least K + 5 high vertices, the total ﬁnal charge (which equals 6g − 12)
14 . We obtain K 2 − 76K − 84g − 237 (cid:54) 0, and this contradicts our
is at least (K + 5) K−81
(cid:3)
choice of K since K satisﬁes K 2 − 76K − 84g − 237 = 1.
We now prove that the order of magnitude of K(g) in Theorem 7 is best possible. For a
given k (cid:62) 0, we construct the following graph Gk. Start with a copy of K4 (which we call
the basic copy of K4), together with k + 1 other disjoint copies of K4, and add all possible
edges between the vertices of the basic copy of K4 and the vertices of the other copies of
K4 (but no edge between two non-basic copies of K4). These edges are called the support
edges of the construction. Now, for each support edge uv, create 2k + 1 new disjoint copies
of K4 and join u and v to all the newly created vertices. Note that the resulting graph Gk
has 128k2 + 196k + 72 vertices and 448k2 + 694k + 252 edges. In particular, this graph has
genus at most 448k2 + 694k + 254. Consider any (2, k, k)-coloring of Gk. We adopt the
same convention as in the previous proof (the colors are named 2, k1, k2). Then at least
one of the 4 vertices of the basic copy of K4, call it u, is colored k1 or k2, say k1. Since
u is adjacent to all the vertices in the k + 1 non-basic copies of K4, at least one of them
contains a vertex v of color k2. At most k of the 2k + 1 copies of K4 joined to both u, v
contain a vertex colored k1, and at most k of them contain color k2. Therefore, at least one
copy of K4 contains vertices only colored with 2, which is a contradiction. It follows that
Gk is not (2, k, k)-colorable. Consequently, there is a constant c > 0 and inﬁnitely many
values of g, for which we can construct a graph embeddable on a surface of Euler genus g,

with no (2,(cid:98)c√g(cid:99),(cid:98)c√g(cid:99))-coloring.

Note that the same analysis shows that Gk is not (0, 0, k, k)-colorable. We can even
replace each copy of K4 by a triangle, and this property remains true. Therefore this graph
also shows that we can construct, for inﬁnitely many values of g, a graph embeddable on a

surface of Euler genus g, with no (0, 0,(cid:98)c√g(cid:99),(cid:98)c√g(cid:99))-coloring. The next result shows that

this is also asymptotically best possible.

Theorem 9. A graph embeddable on a surface of Euler genus g is (0, 0, K, K)-colorable,
with K = K(g) = 20 + √48g + 481.
Proof. Assume for the sake of contradiction that there is a graph G embeddable on a
surface of Euler genus g that is not (0, 0, K, K)-colorable. We choose g minimum, and
with respect to this, we choose G such that the sum of the number of vertices is minimum.
By the minimality of g we may assume that G is cellularly embedded on a surface of Euler
genus g (see [12, Propositions 3.4.1 and 3.4.2]) and from now on, we ﬁx this embedding.

Moreover, we can assume that G is edge-maximal with respect to this embedding (and
such that G is simple), since if a supergraph of G can be (0, 0, K, K)-colored, then G

12

ILKYOO CHOI AND LOUIS ESPERET

can also be (0, 0, K, K)-colored.
In particular, it follows that for every vertex v, there
is a circular ordering on the neighbors of v such that any two consecutive vertices in
this ordering are adjacent (note that G does not necessarily triangulate the surface it is
embedded in).

By the minimality of G, we can also assume that G is connected and has minimum
degree at least 4. A high and low vertex is a vertex of degree at least K + 4 and at most
K + 3, respectively. By Lemma 2, every low vertex is adjacent to at least two high vertices.
By Lemma 3, G contains at least K + 4 high vertices.

Claim 10. Let v be a 4-vertex with neighbors u1, u2, u3, u4. If vu1u2, vu2u3, vu3u4, and
vu4u1 are triangular faces, then u1u3 and u2u4 are edges in G.

Proof. Without loss of generality, assume that u1 and u3 are not adjacent. Remove v
and identify u1 and u3 into a single vertex. Note that this can be done in such a way
that the resulting graph is still embeddable on the same surface. By the minimality of
G, the resulting graph is (0, 0, K, K)-colorable and any (0, 0, K, K)-coloring can easily be
(cid:3)
extended to v since only three colors appear in its neighborhood, a contradiction.

We will use the discharging procedure laid out in Subsection 2.3. For a vertex v and a
face f of G, the initial charge is d(v) − 6 and 2d(f ) − 6, respectively. The initial charge
sum is 6g − 12 by Euler’s formula.
Here are the discharging rules:
(R1) Each face of degree at least 4 sends charge 1
(R2) Each high vertex sends charge 7
(R3) For each high vertex v and each sequence of three consecutive neighbors u1, u2, u3 of
16 to each of u1

v in clockwise order around v such that u2 is high, v sends charge 7
and u3.

4 to each incident vertex of degree 4.

8 to each low neighbor.

(R4) Every low vertex of degree at least 5 sends charge 1

4 to each neighbor of degree 4.

sends at most d

We now analyze the charge of each vertex and each face after the discharging procedure.
Every face of degree 3 has initial charge 0, and since it is not involved in any discharging

Let v be a vertex of degree 4. Then v receives charge 7

4 by (R1). The ﬁnal charge of f is therefore at least 2d − 6 − d

rules, the ﬁnal charge is also 0. Every face f of degree d (cid:62) 4 starts with charge 2d− 6 and
8 from each of its (at least) two
high neighbors by (R2). If v either has another neighbor of degree at least 5 or is incident
to a face of degree at least 4, then v receives an additional charge of 1
4 and its ﬁnal charge
is therefore at least −2 + 7
4 = 0. Otherwise, we can assume that v is adjacent to
precisely two high vertices u1, u3 and two vertices u2, u4 of degree 4, and is incident to four
triangular faces. Note also that if vu1u3 is a face of G, then by rule (R3) v receives an
additional charge of 7

16 and therefore its ﬁnal charge is −2 + 7

As a consequence, we can assume without loss of generality that the faces incident with
v are vu1u2, vu2u3, vu3u4, and vu4u1. It follows from Claim 10 that u1 and u3 are adjacent
and u2 and u4 are adjacent. Recall that the embedding of G is edge-maximal, and thus
there is an ordering of the neighbors of u1 such that any two consecutive vertices in the

8 + 7

8 + 1

8 + 7

8 + 7

16

(cid:62) 1.

4

(cid:62) 3
16.

IMPROPER COLORING OF GRAPHS ON SURFACES

13

Let v be a low vertex of degree d (cid:62) 5. Then v receives charge 7

ordering are adjacent. Since u1 has more than 4 neighbors, it follows that at least one of
v, u2, u4 is adjacent to a vertex not in {v, u1, u2, u3, u4}, a contradiction.
least) two high neighbors by (R2), and sends at most (d − 2) 1
therefore at least d − 6 + 7
Finally, let v be a high vertex. Then v sends charge at most 7
new charge is at least d − 6 − 7
charge at least K−44
equals 6g − 12) is at least (K + 4) K−44
contradicts our choice of K since K satisﬁes K 2 − 40K − 48g − 80 = 1.

We proved that each vertex and face has nonnegative charge, and each high vertex has
. Since there are at least K + 4 high vertices, the total charge (which

. We obtain K 2 − 40K − 48g − 80 (cid:54) 0, and this
(cid:3)

8 from each of its (at
4 by (R4). Its ﬁnal charge is

8d by (R2) and (R3), so its

8 + 7

4

8 − (d − 2) 1
8d = d

(cid:62) 0.
8 − 6 (cid:62) K−44

8

.

8

8

4. Triangle-free graphs on surfaces

3

(cid:101), and the growth rate of K(g) is tight.

Theorem 11. A triangle-free graph embeddable on a surface of Euler genus g is (0, 0, K)-
colorable where K = K(g) = (cid:100) 10g+32
Proof. Assume for the sake of contradiction that there is a triangle-free graph G embed-
dable on a surface of Euler genus g that is not (0, 0, K)-colorable. We choose g minimum,
and with respect to this, we choose G such that the sum of the number of vertices and the
number of edges is minimum. By the minimality of g we may assume that G is cellularly
embedded on a surface of Euler genus g (see [12, Propositions 3.4.1 and 3.4.2]) and from
now on, we ﬁx this embedding.

By the minimality of G, we can also assume that G is connected and has minimum
degree at least 3. A high and low vertex is a vertex of degree at least K + 3 and at most
K + 2, respectively. A 4+-vertex that is not high is a medium vertex. By Lemma 2, every
low vertex has at least one high neighbor.

We will also assume that for a (partial) (0, 0, K)-coloring ϕ of G, the three colors will
be a, b, k and the graph induced by the color a, b, k has maximum degree at most 0, 0, K,
respectively.

Claim 12. A 3-vertex in G that is adjacent to at least two 3-vertices is incident to a
5+-face.

Proof. Assume for the sake of contradiction that there is a 3-vertex v that is adjacent to two
3-vertices and is incident to only 4-faces. Note that v cannot be adjacent to three 3-vertices
since it must be adjacent to a high vertex by Lemma 2. Let u1, u2, u3 be the neighbors of
v where u2 and u3 are 3-vertices. Also, for i ∈ {1, 2, 3}, let wi be the neighbor of ui so that
v, ui, wi, ui+1 are the vertices of a 4-face in this order (where u4 = u1). See Figure 2 (where
the white vertices do not have incident edges besides the ones drawn, and the black vertices
may have other incident edges). It is easy to check that v, u1, u2, u3, w1, w2, w3 must be all
distinct vertices, since v, u2, u3 are 3-vertices and G has no 3-cycles. Also, u2 and w3 have
no common neighbors, since that would create a 3-cycle. Since u2 and w3 have no common
neighbor, removing v and adding the edge u2w3 results in a smaller graph H that has no
3-cycles and is embeddable on the same surface. Thus, H has a (0, 0, K)-coloring ϕ.

14

ILKYOO CHOI AND LOUIS ESPERET

We will

extend this

coloring of H to G to obtain a contradiction.

If
{ϕ(u1), ϕ(u2), ϕ(u3)} (cid:54)= {a, b, k}, then we can use the missing color on v to extend the
coloring. Moreover, it must be that ϕ(u1) = k, otherwise we could color v with the color k
since K (cid:62) 4. We know that ϕ(w2) = k since {ϕ(u2), ϕ(u3)} = {a, b}. Also, ϕ(w3) = k since
{ϕ(u2), ϕ(u3)} = {a, b} and u2w3, u3w3 are edges in H. Now we can color v with ϕ(u3)
and recolor u3 with ϕ(u2). This is a (0, 0, K)-coloring of G, which is a contradiction. (cid:3)

Figure 2. Obtaining H from G in Lemma 12

By Lemma 3, G contains at least three high vertices. By using the fact that the graph

is triangle-free, we can guarantee more high vertices.

Claim 13. There are at least six high vertices in G.

Proof. Let S be the set of high vertices in G, and assume for the sake of contradiction that

|S| (cid:54) 5. If S induces a bipartite subgraph of G, we color S properly with colors a and b.

Otherwise, since G is triangle-free, it follows that S induces a 5-cycle C. In this case, we
color the vertices of C using colors a, b, a, b, k, in this order, and call v the unique vertex of
C colored k. Let N be the set of neighbors of v not in C. Since G is triangle-free, N is a
stable set and each vertex u ∈ N has at most one neighbor in C distinct from v. It follows
that the coloring of C can be properly extended to N by assigning colors a and b only.
We now complete the coloring of G greedily (by considering the uncolored vertices in an
arbitrary order) as follows: if w has no neighbor colored a or b, then assign the free color
to w. Otherwise, assign color k to w. Note that each vertex that has been colored k during
the greedy coloring has degree at most K + 2, and at least one neighbor colored a and one
neighbor colored b. Therefore, it has at most K neighbors colored k. This shows that G is
(cid:3)
(0, 0, K)-colorable, which is a contradiction.

We will use the discharging procedure laid out in Subsection 2.3. For a vertex v and a
face f of G, the initial charge is d(v)− 4 and d(f )− 4, respectively. The initial charge sum
is 4g − 8 by Euler’s formula.
(R1) Each high vertex sends charge 4
(R2) Each medium vertex sends charge 1

5 to each adjacent vertex.

Here are the discharging rules:

5 to each adjacent 3-vertex.

vu1w1u2w2u3w3G⇒u1w1u2w2u3w3=vHIMPROPER COLORING OF GRAPHS ON SURFACES

15

(R3) Each 5+-face sends charge 1

5 to each incident 3-vertex.

The discharging rules (R1) and (R2) indicate how the vertices send their charge to

adjacent vertices. Rule (R3) is the only rule where a face is involved.

5 = 4d(f )

We now analyze the charge of each vertex and each face after the discharging procedure.
Let f be a face. Since G has no 3-cycles, the length of f is at least 4. If f is a 4-face,

vertex by Lemma 2. Also, by (R2), v sends charge 1

then no rule applies to f , thus µ∗(f ) = µ(f ) = d(f ) − 4 = 0. If f is a 5+-face, then (R3)
is the only rule that applies to f , and therefore µ∗(f ) (cid:62) d(f ) − 4 − d(f )
5 − 4 (cid:62) 0.
If v is a 3-vertex, then µ(v) = d(v) − 4 = −1. Also, v receives charge 4
5 by (R1), since v
is adjacent to a high vertex by Lemma 2, By Lemma 12, v is either adjacent to at most one
3-vertex or incident to a 5+-face. If v is adjacent to at most one 3-vertex, then v receives
5 by (R2). Thus, µ∗(v) (cid:62) −1+ 4
either an additional charge of 4
5 by (R1) or charge 1
5 = 0.
5 by (R3). Thus, µ∗(v) (cid:62) −1+ 4
If v is incident to a 5+-face, then v receives charge 1
5 = 0.
If v is a medium vertex, then v receives charge 4
5 by (R1) since v is adjacent to a high
5 to each adjacent 3-vertex. Thus,
5 to each neighbor. Thus, µ∗(v) = d(v) − 4 −
− 4 (cid:62) 10g+32

µ∗(v) (cid:62) d(v) − 4 + 4
> 0.
If v is a high vertex, then it sends charge 4
5 = d(v)
high vertex v has ﬁnal charge greater than 2g−4
According to Claim 13, there are at least six high vertices. Since each high vertex has
ﬁnal charge greater than 4g−8
and every other vertex and face has nonnegative ﬁnal charge,
the sum of the ﬁnal charge is greater than 4g − 8. This is a contradiction since the initial
(cid:3)
charge sum was 4g − 8. Therefore, a counterexample to Theorem 11 does not exist.

5 − d(v)−1
5 − 4 =

5 = 4d(v)−15
(cid:101)+3
(cid:100) 10g+32
5

5 − 4 (cid:62) K(g)+3

− 4 = 10g−19

15 > 2g−4

3

3 +3
5

.

3

5

3

6

4d(v)

5 + 1
5 + 1

. Thus, each

4.1. Tightness example. In this subsection, we will show that the growth rate of K(g)
in Theorem 11 is tight by constructing, for some constant  > 0 and inﬁnitely many values
of g, a triangle-free graph that is embeddable on a surface of Euler genus g but is not
(0, 0,(cid:100)g(cid:101))-colorable. We will actually do better and construct a graph with girth 6 that
is not (0, 0,(cid:100)g(cid:101))-colorable. Our construction is inspired by a classical construction of
Blanche Descartes [8].
Given a set S of seven vertices that are pairwise distance at least 3 apart from each
other, let “adding C7 to S” mean that you add a disjoint copy of C7 and add a perfect
matching between the seven new vertices and vertices in S. Note that this operation does
not create 3-, 4-, or 5-cycles.

Now, construct Hk by starting with seven disjoint copies D1, . . . , D7 of C7. For every set
{v1, . . . , v7} of seven vertices where vi ∈ Di for i ∈ {1, . . . , 7}, do the operation of “adding
C7 to {v1, . . . , v7}” 7k + 1 times.
For every (0, 0, k)-coloring of Hg, there is a vertex ui colored with the third color in
each Di for i ∈ {1, . . . , 7}, since a 7-cycle cannot be properly colored with two colors. Now
consider the 7k +1 copies of C7 added to {u1, . . . , u7}. Since each vertex ui is adjacent to at
most k vertices of the third color, there must exist a copy of C7 where none of the vertices
are colored with the third color, a contradiction. Hence, Hk is not (0, 0, k)-colorable.

16

ILKYOO CHOI AND LOUIS ESPERET

Note that Hk has 2 · 78(7k + 1) + 49 edges, and therefore Hk has Euler genus at most
2 · 78(7k + 1) + 51. Hence, Hk is a graph with girth 6 that is embeddable on a surface of
Euler genus at most 2 · 79k + 2 · 78 + 51 and is not (0, 0, k)-colorable. It follows that there
is a constant  > 0 and inﬁnitely many values of g, for which we can construct a graph of
girth 6 that is embeddable on a surface of Euler genus g but is not (0, 0,(cid:100)g(cid:101))-colorable.

5. Graphs of girth at least 7 on surfaces

Theorem 14. A graph of girth at least 7 embeddable on a surface of Euler genus g is

(0, K)-colorable where K = K(g) = 5 +(cid:100)√14g + 22(cid:101), and the growth rate of K(g) is tight.

Proof. Assume for the sake of contradiction that there is a graph G with girth at least
7 embeddable on a surface of Euler genus g that is not (0, K)-colorable. We choose g
minimum, and with respect to this, we choose G such that the sum of the number of
vertices and the number of edges is minimum. By the minimality of g we may assume that
G is cellularly embedded on a surface of Euler genus g (see [12, Propositions 3.4.1 and
3.4.2]) and from now on, we ﬁx this embedding.

By the minimality of G, we can also assume that G is connected and has minimum
degree at least 2. A high and low vertex is a vertex of degree at least K + 2 and at most
K + 1, respectively. By Lemma 2, every non-high vertex is adjacent to at least one high
vertex. By Lemma 3, G contains at least two high vertices. By using the fact that the
graph has girth at least 7, we can guarantee more high vertices.

We will also assume that for a (partial) (0, K)-coloring ϕ of G, the two colors will be 0
and k, and the graph induced by the color 0 and k has maximum degree at most 0 and at
most K, respectively.

Claim 15. There are at least K + 2 high vertices.

Proof. Assume for the sake of contradiction that the set H of high vertices has size at most
K + 1. First color all the vertices of H with the color k. Let M be the set of vertices not
in H that have at least one neighbor in H, and let S be a maximum independent set in
M . Now color all vertices of S with the color 0 and color all vertices of M − S with the
color k. For the remaining vertices, we proceed by a greedy algorithm: if a vertex v has a
neighbor colored 0, then use color k on v, otherwise, use color 0 on v.

We now show that this coloring is indeed a (0, K)-coloring of G. For a vertex v in H,
the neighbors of v that are colored with k are partitioned into two sets T1 and T2 where
T1 ⊆ H and T2 ⊆ M . Consider a vertex u ∈ T2. It follows from the deﬁnition of S that
u is adjacent to a vertex u1 in M that is colored 0. This vertex u1 must have a neighbor
u2 in H, since u1 is in M . Moreover, since G has girth at least 7, we know that u2 (cid:54)∈ T1
and for any two vertices u, w ∈ T2, we have u2 = w2 if and only if u = w. Therefore the
number of neighbors of v that are colored with k is at most |T1| + |T2| (cid:54) |H| − 1 (cid:54) K.
A vertex in V (G) − H that is colored with k must be adjacent to a vertex of color 0,
and thus has at most K neighbors colored with k. It is easy to check that a vertex in
V (G) − H that is colored with 0 does not have a neighbor colored with 0. Hence, we

IMPROPER COLORING OF GRAPHS ON SURFACES

17

obtain a (0, K)-coloring of G, which is a contradiction. It follows that there are at least
(cid:3)
K + 2 high vertices.

We will use the discharging procedure laid out in Subsection 2.3. For a vertex v and a
face f of G, the initial charge is 5d(v)− 14 and 2d(f )− 14, respectively. The initial charge
sum is 14g − 28 by Euler’s formula.

Here is the unique discharging rule:

(R1) Every high vertex v sends charge 4 to each of its neighbors

We now analyze the charge of each vertex and each face after the discharging procedure.
Observe that the charge of a face remains the same, and since G has girth at least 7,
all faces have nonnegative ﬁnal charge. A non-high vertex v starts with initial charge

and therefore the ﬁnal charge of v is also nonnegative. Finally, since a high vertex v sends

5d(v) − 14 (cid:62) −4 and receives a charge of 4 from each of its (at least one) high neighbors,
a charge of 4 to each of its neighbors, its ﬁnal charge is 5d(v) − 14 − 4d(v) = d(v) − 14 (cid:62)
K + 2 − 14 = K − 12.
Consequently, the total charge 14(g − 2) is at least (K + 2)(K − 12). This is equivalent
to K 2 − 10K + 4− 14g (cid:54) 0, which contradicts the deﬁnition of K (K satisﬁes K 2 − 10K +
(cid:3)
4 − 14g > 0).

5.1. Tightness example. We now construct, for some constant c > 0 and inﬁnitely many
values of g, a graph of girth at least 7 embeddable on a surface of Euler genus g, with no

(0, K)-coloring where K = K(g) = (cid:98)c√g(cid:99).

In a (0, K)-coloring, let 0 and k be the two colors where the vertices of color 0 and k
induce a graph of maximum degree at most 0 and K, respectively. A 2-star is obtained
from a star by subdividing every edge once. Take a 2-star with 3K + 2 leaves, and for any
two leaves u and v, add an edge between u and v and then subdivide this edge exactly
twice (in other words, replace it by a path on 3 edges). Let SK be the resulting graph.
Now, take two copies of SK, and join their centers by an edge (see Figure 3 for the case
K = 1). The resulting graph has 3(3K + 2)(3K + 1) + 12K + 9 = 27K 2 + 39K + 15 edges,
and therefore has Euler genus at most 27K 2 + 39K + 17.

At least one of the two centers is colored with k. Consider the corresponding copy of
SK. At least 2K + 2 of the neighbors of the center (in the copy of SK) are colored with 0.
The corresponding 2K + 2 leaves of the 2-star are then colored with k. Let L be the set
of these leaves, and let D be the sum, over all vertices v of L, of the number of neighbors
of v colored k. Observe that in each added path on 3 edges, at least one of the newly
added vertices is colored with k, so each added path on 3 edges between two vertices of L
contributes at least 1 to D. Since there are |L|(|L| − 1)/2 such paths, at least one of the
vertices of L has at least (|L| − 1)/2 vertices colored k. If (|L| − 1)/2 > K, then this is a
contradiction.
It follows that there is a constant c > 0 and inﬁnitely many values of g, for which we
can construct a graph of girth at least 7 embeddable on a surface of Euler genus g, with

no (0,(cid:98)c√g(cid:99))-coloring.

18

ILKYOO CHOI AND LOUIS ESPERET

Figure 3. A construction of a graph with girth 7 that is not (0, K)-colorable.

6. Open problems

A natural question is to ﬁnd a version of Theorem 14 for graphs of arbitrary large girth.
A slight variation of the proof of Theorem 14 easily shows that a graph of girth at least
(cid:96) embeddable on a surface of Euler genus g is (0, O(
g/(cid:96)))-colorable, where the hidden
constant depends on neither g nor (cid:96). We conjecture the following stronger statement.

(cid:112)

Conjecture 16. There is a function c = o(1) such that any graph of girth at least (cid:96)
embeddable on a surface of Euler genus g is (0, O(gc((cid:96))))-colorable.

Note that a graph that is (0, k)-colorable has a proper coloring with k + 2 colors (since
a graph with maximum degree k has a proper (k + 1)-coloring). As a consequence, the
1
following result of Gimbel and Thomassen [9] gives a lower bound of the order
2(cid:96)+2 on such
a function c.

Theorem 17 ([9]). For any (cid:96), there exist a constant c > 0 such that for arbitrarily small
 > 0 and suﬃciently large g, there are graphs of girth at least (cid:96) embeddable on surfaces of

Euler genus g that have no proper coloring with less than c g

Acknowledgments

1−
2(cid:96)+2 colors.

The authors would like to thank Gwena¨el Joret for the interesting discussions on short

non-contractible cycles.

References

[1] K. Appel and W. Haken, Every planar map is four colorable. Part I. Discharging, Illinois J. Math.

21 (1977), 429–490.

[2] K. Appel and W. Haken, Every planar map is four colorable. Part II. Reducibility, Illinois J. Math.

21 (1977), 491–567.

[3] D. Archdeacon, A note on defective colorings of graphs in surfaces, J. Graph Theory 11 (1987),

517–519.

[4] O.V. Borodin, A.O. Ivanova, M. Montassier, P. Ochem, and A. Raspaud, Vertex decompositions of
sparse graphs into an edgeless subgraph and a subgraph of maximum degree at most k, J. Graph Theory
65(2) (2010), 83–93.

IMPROPER COLORING OF GRAPHS ON SURFACES

19

[5] H. Choi, I. Choi, J. Jeong, and G. Suh, (1, k)-coloring of graphs with girth at least 5 on a surface,

Manuscript. http://arxiv.org/pdf/1412.0344v1.pdf

[6] L.J. Cowen, R.H. Cowen and D.R. Woodall, Defective colorings of graphs in surfaces: partitions into

subgraphs of bounded valency, J. Graph Theory 10 (1986), 187–195.

[7] L. Cowen, W. Goddard and C.E. Jesurum, Defective coloring revisited, J. Graph Theory 24 (1997),

205–219.

[8] B. Descartes, Solution to advanced problem No. 4526., Amer. Math. Monthly 61 (1954), 532.
[9] J. Gimbel and C. Thomassen, Coloring graphs with ﬁxed genus and girth, Trans. Amer. Math. Soc.

349(11) (1997), 4555–4564.

[10] H. Gr¨otzsch, Ein Dreifarbensatz f¨ur dreikreisfreie Netze auf der Kugel, Wiss. Z. Martin-Luther-Univ.

Halle-Wittenberg Math.-Natur. Reihe 8 (1959) 109–120.

[11] K. Kawarabayashi and C. Thomassen, From the plane to higher surfaces, J. Combin. Theory Ser. B

102 (2012), 852–868.

[12] B. Mohar and C. Thomassen, Graphs on Surfaces. Johns Hopkins University Press, Baltimore, 2001.
[13] R. ˇSkrekovski, List improper colourings of planar graphs, Combin. Probab. Comput. 8 (1999), 293–

299.

[14] D.R. Woodall, Defective choosability of graphs in surfaces, Discuss. Math. Graph Theory 31 (2011),

441–459.

Department of Mathematical Sciences, KAIST, Daejeon, South Korea
E-mail address: ilkyoo@kaist.ac.kr

Laboratoire G-SCOP (CNRS, Universit´e Grenoble-Alpes), Grenoble, France
E-mail address: louis.esperet@grenoble-inp.fr

