6
1
0
2

 
r
a

M
5

 

 
 
]

.

A
N
h
t
a
m

[
 
 

1
v
1
6
7
1
0

.

3
0
6
1
:
v
i
X
r
a

OVERRESOLVING IN THE LAPLACE DOMAIN FOR CONVOLUTION QUADRATURE METHODS

T. BETCKE˚, N. SALLES:, AND W. ´SMIGAJ;

Abstract. Convolution quadrature (CQ) methods have enjoyed tremendous interest in recent years as an efﬁcient tool for solving time-
domain wave problems in unbounded domains via boundary integral equation techniques. In this paper we consider CQ type formulations
for the parallel space-time evaluation of multistep or stifﬂy accurate Runge-Kutta rules for the wave equation. In particular, we decouple
the number of Laplace domain solves from the number of time steps. This allows to overresolve in the Laplace domain by computing more
Laplace domain solutions solutions than there are time steps. We use techniques from complex approximation theory to analyse the error
of the CQ approximation of the underlying time-stepping rule when overresolving in the Laplace domain and show that the performance is
intimately linked to the location of the poles of the solution operator. Several examples using boundary integral equation formulations in the
Laplace domain are presented to illustrate the main results.

Key words. boundary integral equations, convolution quadrature method

AMS subject classiﬁcations. 35P25, 65M38

1. Introduction. Let Ω be a bounded domain with boundary Γ. We consider the wave equation in the

exterior Ω` :“ R3zΩ given by

(1.1)

$’’’&’’’%

B2u
Bt2 pt; xq ´ c2∆xupt; xq “ 0, x P Ω`,
up0; xq “ Bu
x P Ω`,
Bt
upt; xq “ gpt; xq,
x P Γ.

p0; xq “ 0,

With the rise in massively parallel computing in recent years it has become important not only to achieve par-
allelism in space for the solution of (1.1), but also to exploit parallelism in time. One way to achieve this is
by a Fourier or Laplace transform of the wave equation. This allows us to solve for a range of frequencies in
parallel and to reassemble the time-solution by an inverse transform. Closely related to this approach are space-
time parallel convolution quadrature (CQ) type schemes. Consider a sequence of equally spaced discrete-time
approximations

udpt0; xq, udpt1; xq, udpt2; xq, . . .

generated by, e.g., a multistep or Runge-Kutta scheme, such that udptn; xq « uptn; xq for n “ 0, 1, . . . and
tn “ n∆t. We now apply a Z-transform to this sequence and deﬁne the function

Udpz; xq :“

udptn; xqzn.

8ÿ

n“0

ż

It turns out (see Section 2) that for each evaluation of Udpz; xq for a given value z, we need to solve m modiﬁed
Helmholtz problems with typically complex wavenumber and known boundary data arising from a Z-transform
of g. For multistep schemes we have m “ 1. For Runge-Kutta schemes m is the number of stages of the scheme.
The time-stepping values udptn; xq can then be recovered by a simple Cauchy integral as

(1.2)

udptn; xq “ 1
2πi

Upz; xq
zn`1 dz.

C

(1.2) can be efﬁciently evaluated by a trapezoidal rule with Nf discretisation points, making necessary the solu-
tion of m ˆ Nf independent modiﬁed Helmholtz problems to recover the time steps.
˚ Department of Mathematics, University College London, UK, t.betcke@ucl.ac.uk.
:Department of Mathematics, University College London, UK, n.salles@ucl.ac.uk. Timo Betcke and Nicolas Salles are supported
;Simpleware Ltd, Exeter, UK, w.smigaj@simpleware.com.

by Engineering and Physical Sciences Research Council Grant EP/K03829X/1.

1

Convolution quadrature methods were introduced by Lubich in [22, 23, 24]. In recent years they have seen
tremendous interest for the solution of exterior time-domain scattering problems via boundary integral equation
formulations, see e.g. [7, 11, 2, 8, 12, 21]. The application to Maxwell problems is discussed in [13, 1]. A recent
excellent overview of the literature on CQ type methods is also contained in [3] and [17].
In this paper we take a slightly different approach to CQ methods. We do not consider the overall convergence
of convolution quadrature methods to the continuous wave equation, but rather ask the question how well con-
volution quadrature approximates the time steps udptn; xq generated by the underlying time-stepping scheme.
The crucial approximation here is the evaluation of the Cauchy integral in (1.2) via a trapezoidal rule. Based on
classical analyticity results for the solution operator of the Helmholtz equation in the frequency domain we will
give precise error bounds for the approximation of (1.2) as the number of evaluation frequencies Nf tends to
inﬁnity. Moreover, the analysis will show how many frequency evaluations will be at least necessary to obtain
an acceptable accuracy. As a byproduct the analysis in this paper will give decay estimates of the time-stepping
values udptn; xq similar in ﬂavour to classical energy decay estimates for the continuous solution upt; xq of (1.1).
In order to turn this convolution quadrature approach into a numerical method, a solver for the modiﬁed Helmholtz
equation in the Laplace domain is needed. Here, we focus on boundary integral formulations, as they are most
frequently used in the context of CQ methods, and we analyse how the spectral properties of different formula-
tions (e.g. integral equation of the ﬁrst or second kind, combined formulations) inﬂuence the rate of convergence
of the trapezoidal rule for (1.2). Other types of solvers in the Laplace domain are possible such as ﬁnite elements
with a PML condition [9, 20], and the type of analysis presented in this paper immediately extends to these
formulations.
The paper is structured as follows. In Section 2 we give an overview of parallel convolution quadrature methods
with a particular focus on the role of the underlying Z-transform. In Section 3 we discuss the analyticity of
the solution operator in dependence of the exterior resonances of a related Helmholtz problem. This is needed
for the convergence analysis in Section 4. In Section 5 we turn our attention to boundary integral formulations
and discuss the inﬂuence of the poles of the solution operators for various integral equation formulations on the
convergence results. In Section 6 we present numerical results, including a precise convergence estimate of the
CQ approximation of the underlying time-stepping rule in case of a three dimensional trapping domain. We ﬁnish
with conclusions in Section 7.

2. Convolution quadrature as a Z-transform method. In this section we review the CQ method. The
derivation is similar to those given in [7, 2] but focuses explicitly on the representation in terms of a Z-transform
and its inversion via Cauchy integrals. To simplify the presentation we rewrite (1.1) as a ﬁrst order system of the
form

(2.1)

where Y pt; xq “

„


upt; xq
BuBt pt; xq

1
c

, L “

„

BY pt; xq
Bt
c
Y p0; xq “ 0,


BY pt; xq “ Fpt; xq,

“ LY pt; xq, x P Ω`,
x P Ω`,
„
x P Γ,

0
∆x

I
0

, B “

I
0

0
0

, and Fpt; xq “

„

gpt; xq

0

.

$’’&’’% 1

nÿ

1

c∆t

j“0

We ﬁrst write the frequency problems to be solved when applying a multistep scheme, and then we will see how
to apply a m-stages Runge-Kutta scheme [5, 6, 4].

2.1. Multistep schemes. We start by applying a multistep rule to the ﬁrst order system (2.1). The general

form of the discrete scheme is then

(2.2)

γn´jYdptj; xq “ LYdptn; xq.

Here, Ydptn; xq is the sequence of discrete approximations to Y ptn; xq generated by the multistep rule, and the
γn´j are the coefﬁcients of the multistep rule. For example, in the case of implicit Euler we have γ0 “ 1,
γ1 “ ´1, and γj “ 0, j ą 1. For convenience we will always assume that γ is an inﬁnite sequence, where all but
a ﬁnite number of elements (corresponding to the multistep rule) are zero.

2

8ÿ

n“0

ż

We want to apply the Z-transform to (2.2). We use the following deﬁnition for the Z-transform ZtXu of a general
sequence tXnu with n ě 0:

(2.3)

ZtXupzq :“

Xnzn,

z P C.

Hence, the elements of the sequence become the Taylor coefﬁcients of the function ZtXupzq. The inverse trans-
form is given by a Cauchy integral as

(2.4)

Xn :“ 1
2πi

ZtXupzq
zn`1

dz,

C

where C is a contour around 0 inside the domain of analyticity of ZtXupzq. Typically, we use a circle of radius
0 ă λ ď 1. The following well knwon result holds for the existence of the Z-transform.
PROPOSITION 2.1. Let tXnu be a sequence with |Xn| ď Ce´αn, C ą 0, α P R. Then the Z-transform of tXnu
exists and ZtXupzq is analytic inside every closed disk around 0 with radius λ ă eα.
Proof. Let |z| “ λ. Then

8ÿ

n“0

˘

8ÿ

`

n“0

|ZtXupxq| ď

|Xnzn| ď C

λe´α

n

,

which converges if λ ă eα.
Hence, if the sequence tXnu decays exponentially, then ZtXupzq is analytic within a disk of radius λ ą 1. On
the other hand, if the sequence is only bounded or grows exponentially, we require λ ă 1.
The Z-transform of (2.2) is given by

«

nÿ

8ÿ

ﬀ

8ÿ

1

(2.5)

c∆t

ř8
j“0
n“0 γnzn and Ydpz; xq “

n“0

ř8
n“0 Ydptn; xqzn. Then, the left-hand side of (2.5) is a convolution

n“0

Deﬁne γpzq “
of the Taylor coefﬁcients of γpzq and Ydpz; xq. (2.5) is therefore equivalent to

γn´jYdptj; xq

zn “ L

Ydptn; xqzn.

γpzqYdpz; xq “ LYdpz; xq.

1

c∆t

Translating into a second order form, we obtain the modiﬁed Helmholtz problem

$’&’%

˙

ˆ
γpzq
c∆t
ř8
Udpz; xq “ Gpz; xq,
n“0 udptn; xqzn and Gpz; xq “

2

(2.6)

Udpz; xq ´ ∆xUdpz; xq “ 0, x P Ω`,
x P Γ,

ř8
n“0 gptn; xqzn. We still need to deﬁne suitable boundary
where Udpz; xq “
conditions towards inﬁnity. Consider a sphere S of radius r0 ą 0 surrounding the domain Ω. Then in the exterior
of S the solution of (1.1) is outgoing, and the appropriate boundary conditions for (2.6) are outgoing boundary
conditions. For a general Helmholtz problem of the form

with possibly complex wavenumber k, outgoing boundary conditions can be deﬁned by requiring that v can be
expanded into a series of the form

(2.7)

(2.8)

∆vpxq ` k2vpxq “ 0, x P Ω`
8ÿ

nÿ

vpxq “

an,mhp1q

n pkrqY m

n pˆxq

n“0

m“´n

3

p1q
n is a spherical Hankel function of the ﬁrst kind, the Y m

for r “ |x| ą r0. Here, ˆx “ x{|x|, h
n are spherical
harmonics, and the an,m are expansion coefﬁcients of the solution v [20]. In the case of a real wavenumber k
vpxq “ 0, and generalises the
(2.8) is equivalent to the Sommerfeld radiation condition lim|x|Ñ8 |x|
Sommerfeld radiation condition to arbitrary complex wavenumbers.
Hence, suitable conditions towards inﬁnity of (2.6) are given by (2.8) with wavenumber k :“ kz, where

Bx ´ ik

` B

˘

(2.9)

kz :“ i

For each given z we can now evaluate Udpz; xq by solving the boundary value problem (2.6) together with outgo-
ing boundary conditions speciﬁed above. Once we have computed Udpz; xq, the time-stepping values udptn; xq
are obtained by applying the inverse Z-transform (2.4) as

(2.10)

udptn; xq “ 1
2πi

Udpz; xq
zn`1 dz,

|z|“λ

where we integrate over a circle around the origin with radius λ. In order to turn this into a numerical method
we need to approximate this contour integral. The natural choice is the trapezoidal rule, since it converges ex-
ponentially in the number Nf of integration points for periodic analytic functions. Let zk “ λe
Nf with
k “ 1, . . . , Nf . The trapezoidal rule applied to the above contour integral gives
Udpzk; xq

Nfÿ

2πi k

udptn; xq « uNf

d ptn; xq :“ 1
Nf

k“1

zn
k

.

(2.11)

Using the fact that Udpz; xq “ Udpz; xq, we do not need to solve problem (2.6) for Nf different frequencies but
only for half the frequencies (see [7, Section 4.1]). Furthermore, the Z-transform of the boundary data and the
inverse Z-transform of the solution Ud can be efﬁciently evaluated via FFT.
We can summarize the multistep convolution quadrature method in three steps:

1. Compute ωj “ γpzjq{pc∆tq for equally distributed points zj located on the circle with radius λ used as

contour for the inverse Z-transform to get the wavenumbers for the modiﬁed Helmholtz problem.

2. For each wavenumber ωj, approximate the solution of problem (2.6) using a boundary integral equation

formulation or other method.

3. Perform the inverse Z-transform using (2.11) to evaluate the time-domain solution.

2.2. Runge-Kutta schemes. In order to apply a m-stages Runge-Kutta method to the ﬁrst order sys-
tem (2.1), we introduce the internal stages pViqi“1...m. A Runge-Kutta method is deﬁned by the matrix A “
pai,jq1ďi,jďm and the two vectors b “ pbiq1ďjďm and c “ pcjq1ďjďm (see Appendix A). The general form of
the discrete scheme applied to (2.1) is then [5]

(2.12)

„

Viptn; xq “ Ydptn; xq ` c∆t
j“1
Ydptn`1; xq “ Ydptn; xq ` c∆t


j“1

mÿ
ai,jLVjptn; xq

bjLVjptn; xq,

for i P t1, . . . , mu ,

I
0

0
∆x

. The third vector, pcjqj“1...m, that characterises the Runge-Kutta scheme does not appear

where L “
at this stage; it will appear later for the evaluation of the right-hand side, see (2.21).
By applying the Z-transform to (2.12), one has

$’’’’&’’’’%

mÿ

˙

.

γpzq
c∆t

ˆ

ż

(2.13)

$’’’’&’’’’%

Vipz; xq “ Ydpz; xq ` c∆t

j“1
z´1Ydpz; xq “ Ydpz; xq ` c∆t

mÿ
ai,jLVjpz; xq,

bjLVjpz; xq.

j“1

mÿ

4

We have to point out that by using a stifﬂy accurate Runge-Kutta scheme (that means am,j “ bj, j P t1, . . . , mu),
from (2.12) we obtain the equality

From the second expression of (2.13), we get

which can be used in the ﬁrst expression of (2.13),

Vipz; xq “ c∆t

bj ` ai,j

LVjpz; xq,

for |z| ă 1, i “ 1 . . . m.

Taking into account the fact that Vj can be decomposed as Vjpz; xq “ rRjpz; xq, Sjpz; xqst and L “
we obtain a system of equations of the second order:

„



0
∆x

I
0

,

Vmpz; xq “ z´1Ydpz; xq.

mÿ

c∆t

j“1

bjLVjpz; xq
˙

Ydpz; xq “ z
1 ´ z
ˆ

mÿ

z
1 ´ z

j“1

for |z| ă 1, z P C,

$’’’&’’’%Ripz; xq “ c∆t

Sjpz; xq “ c∆t

ˆ
ˆ

mÿ
mÿ

j“1

˙
˙
bj ` ai,j

b(cid:96) ` aj,(cid:96)

z
1 ´ z
z
1 ´ z

Sjpz; xq,

∆xR(cid:96)pz; xq.

(cid:96)“1

˙

ˆ

∆pzq
c∆t

2 Rpz; xq “ ∆xRpz; xq,
ˆ

˙´1

(2.14)

(2.15)

(2.16)

(2.17)

where

By introducing Rpz; xq “ pR1pz; xq, R2pz; xq, . . . , Rmpz; xqq, we can write

∆pzq “

A ` z
1 ´ z

1bt

(2.18)
with 1 “ p1, . . . , 1qt P Rm.
We have to diagonalize ∆pzq in order to decouple the system of equations and be able to apply a boundary
element method. We assume for the radius λ of the integration contour that λ ă 1. In this case ∆pzq always
exists [2]. However, ∆pzq may not be diagonalizable for certain values of z within the unit disk. For example, in
the case of Radau IIa this occurs for z “ 3
3 ´ 5 (see [2, Prop. 3.4] or Appendix A). In Section 3.2 we discuss
this case in more detail.
Let Ppzq be the matrix of eigenvectors of ∆pzq and Dpzq the diagonal matrix containing the associated eigenval-
ues such that

?

∆pzq “ PpzqDpzqP´1pzq, and Dpzq “ diagpγ1pzq, . . . , γmpzqq .

(2.19)

Then we get the independent equationsˆ
with Wj “ mÿ

j,(cid:96) R(cid:96)pz; xq.

P´1pzq

(2.20)

`

˘

(cid:96)“1

˙

γjpzq
c∆t

2

Wjpz; xq “ ∆xWjpz; xq

We still need to deﬁne the boundary conditions for the frequency problems. Since Viptn; xq in (2.12) is an internal
stage, we have the boundary condition (see [27, subsection 2.2] and [3, section 2] for example)

(2.21)

BVjptn; xq “ Fptn ` cj∆t, xq,

x P Γ,

5

where cj is the jth coefﬁcient of the vector c that deﬁnes the Runge-Kutta scheme and Fpt; xq “
g the Dirichlet data of the acoustic problem.
Taking into account (2.21) and applying the Z-transform, one has the following boundary condition for Rj:

0

with

ÿ

„


gpt; xq

Finally, the boundary condition for equation (2.20) writes as

Rjpz; xq “ Gjpz; xq :“
`

ně0

gptn ` cj∆t; xqzn,
˘
P´1pzq

(cid:96),j Gjpz; xq,

x P Γ.

x P Γ.

(2.22)

(2.23)

j“1

W(cid:96)pz; xq “ mÿ
˙
ˆ
Wjpz; xq “ mÿ

γipzq
c∆t

2

(cid:96)“1

`

The frequency problems to solve are:$’’’&’’’%

(2.24)

Wjpz; xq “ ∆xWjpz; xq,

˘

x P Ω`,
j,(cid:96) G(cid:96)pz; xq, x P Γ,

P´1pzq

with radiation conditions for Wj at inﬁnity (see (2.8) and [20]). If we use a stifﬂy accurate Runga-Kutta scheme
(2.14), we now obtain

(2.25)

Udpz; xq “ zRmpz; xq “ z

pPpzqqm,j Wjpz; xq,

mÿ

j“1

and formulas (2.10) and (2.11) provide respectively the solution of our problem and its approximation by trape-
zoidal rule.

3. Scattering poles and analyticity of the Laplace domain problem. Crucial for the analysis of the CQ
method presented in Section 2 is the analyticity of Udpz; xq with respect to z P C. Consider the Helmholtz
equation (2.7) with outgoing boundary data (2.8) and given Dirichlet boundary conditions v “ g on Γ.
Then one can deﬁne the solution operator Bpkq, which maps the boundary data g into a solution v of the associated
Helmholtz problem with Dirichlet boundary data. The following result holds for the analyticity of B (see e.g. [29,
Section 9.7, Corollary 7.5]).
THEOREM 3.1. The solution operator B is a meromorphic operator-valued function of k. The poles pj, j “
1, 2, . . . of Bpkq are located in the lower half of the complex plane, that is Imtpju ă 0 for all j.
At the poles pj the solution operator B loses injectivity, and there exist exponentially growing outgoing waves
that satisfy zero Dirichlet boundary conditions on Γ. These poles are also called scattering poles associated with
the Helmholtz problem.

3.1. Analyticity of multistep schemes. Now consider the solution operator BUpzq associated with the
modiﬁed Helmholtz problem (2.6) that maps boundary data Gpz; xq into the solution Udpz; xq. It follows that
Udpz; xq “ BpkzqGpz; xq “ BUpzqGpz; xq with kz as deﬁned in (2.9). Hence, BUpzq “ Bpkzq, and from the
analyticity of B with respect to kz it follows that BUpzq is analytic with respect to z, since kz is a polynomial in
z. We therefore obtain the following result.
THEOREM 3.2. The solution operator BUpzq is a meromorphic function of z. It can only have singularities at
values zj satisfying pj “ i
It follows that BU is an analytic function of z in the interior of the disk with radius λB deﬁned by

γpzjq
c∆t

¯

´

.

(3.1)

λB :“ min

j

t|zj|u.

6

ř8
Analyticity of the solution operator BU alone does not guarantee analyticity of Udpz; xq. Since Udpz; xq “
BUpzqGpz; xq the radius of analyticity of the boundary data G is crucial. Remember that Gpz; xq “
n“0 gptnqzn. Hence, the radius of analyticity G depends on the rate of decay of the time data gptn; xq.
Consider boundary data given in the form

gptn; xq “ e´βt sin5p2tqfpxq

for some sufﬁciently smooth function f on Γ and β ą 0 (see e.g. [2, Section 6.1]). Then the radius λG of
analyticity of Gpz; xq is determined by the requirement that
8ÿ

|Z tgp¨; xqupzq| ď

e´βn∆t|fpxq|λn

G ă 8,

n“0

and therefore λG ă eβ∆t. Hence, as ∆t Ñ 0 the radius of analyticity becomes effectively λG “ 1.
Another example is an incident wave ui deﬁned by a Gaussian beam of the form
e´pt´tp´ d¨x
c q2

uipt; xq “ cos

t ´ d ¨ x

ˆ

ˆ

˙

˙

2π

f

2σ2

,

c

and gpt; xq :“ ´uipt; xq. The values gptn; xq now decay super-exponentially as n Ñ 8. It follows that the
associated function Gpz; xq is an entire function with λG “ 8.
We note that the above Gaussian beam does not satisfy the initial condition of (1.1) for t “ 0, introducing a weak
singularity in the solution. In practice this is not relevant if the beam starts sufﬁciently far away from the obstacle,
and therefore the size of the boundary data at the obstacle at t “ 0 is effectively zero in machine precision. A
rigorous way to obtain smooth boundary data satisfying the initial conditions is to deﬁne the modiﬁed data

ˆ

˙

˜gpt; xq :“

1 ´ e

´ t2

2σ2
w

gpt; xq

with a suitably chosen σw. Then, if the beam is starting sufﬁciently far away from the obstacle we have ˜gpt; xq «
gpt; xq with an exponentially small error, once the beam arrives at the obstacle. However, ˜gp0; xq “ B˜gBtp0; xq “ 0,
satisfying the initial conditions. Furthermore, λ ˜G “ 8 still holds.
Combining the analyticity results for BUpzq and Gpz; xq, we obtain the following statement for the analyticity of
Udpz; xq with respect to z.
THEOREM 3.3. Let λU :“ mintλB, λGu. Then the function Udpz; xq is analytic with respect to z for all |z| ă λU .
Proof. We have Ud “ BUpz; xqGpz; xq. Hence, Ud is analytic with respect to z if both BUpzq and Gpz; xq are
analytic with respect to z.

3.2. A remark on analyticity for Runge-Kutta schemes. To compute the radius of analyticity of Ud in the
Runge-Kutta case we could exploit the diagonalisation (2.19) of ∆pzq and using formula (2.25) write the solution
as

(3.2)

Udpz; xq “ zRmpz; xq “ z

pPpzqqm,j

mÿ

j“1

˜
Bpjq

W pzq mÿ

(cid:96)“1

`

˘
P´1pzq

¸
j,(cid:96) G(cid:96)pz; xq

,

W pzq “ Bpk

pjq
z q is the solution operator related to the wavenumber k

where Bpjq
j “ 1, . . . , m. If
∆pzq is diagonalisable everywhere for |z| ă 1, then the only singularities are those of the scalar solution operator
(assuming the boundary data is sufﬁciently smooth).
However, this diagonalisation may break down at values of z for which ∆pzq has a multiple eigenvalue, such as
at z “ 3
3 ´ 5 for Radau IIa. Hence, in the particular case of Radau IIa this would only give analyticity within
?
the disk of radius 3

pjq
z “ i γjpzq
c∆t ,

3 ´ 5.

?

7

In the case of Runge-Kutta methods, instead of a scalar solution operator for a scalar PDE we need to consider
the solution operator BRpzq for the vector modiﬁed Helmholtz equation

(3.3)

$&%∆xRpz; xq ´
for |z| ă 1 with outgoing boundary condition
8ÿ

´
∆pzq
c∆t
Rpz; xq “ Gpz; xq,
nÿ

Rpz; xq “

n“0

(cid:96)“´n

¯
2 Rpz; xq “ 0, x P Ω`,
x P Γ,
ˆ

˙

an,(cid:96)Y (cid:96)

npˆxq,

r

hp1q

n

∆pzq
z∆t

i

´

¯

for sufﬁciently large r “ |x|. Here, an,(cid:96) is a vector of m coefﬁcients. The matrix function h
deﬁned, since ∆pzq has no eigenvalue at 0.
If in a certain domain D Ă C the matrix valued function ∆pzq is diagonalisable as ∆pzq “ PpzqDpzqPpzq´1 with
Ppzq, Dpzq and P´1pzq analytic with respect to z P D by diagonalisation the solution operator BR is analytic if
and only if the associated scalar solution operator BU is analytic. However, the question about what happens in
a neighbourhood of points z for which ∆pzq is not analytically diagonalisable remains open. In Section 6.4 we
?
show numerical results that indicate that for Radau IIa the singularity of ∆pzq at z “ 3
3´ 5 does not inﬂuence
the rate of convergence, and that as in the scalar case the rate of convergence is dominated by the singularities of
the scalar solution operator.

∆pzq
z∆t r

is well

p1q
n

4. Convergence of the convolution quadrature method. The convergence results in this section describe
how well the approximate solution uNf
d , obtained using Nf frequencies in the Laplace domain, approximates ud,
the exact solution of the underlying time-stepping rule. We do not consider the question of convergence of ud
against the exact solution u, which depends on well known properties of multistep or Runge-Kutta schemes.
The discretisation uNf
is obtained by applying a trapezoidal rule to the contour integral (2.10). The analysis pre-
d
sented in this section is therefore based on classical convergence estimates for the trapezoidal rule (see e.g. [30,
Theorem 2.1]). However, we have chosen to present the convergence analysis in detail as it highlights the con-
nections between the time-domain values udptn; xq and the analyticity of the Laplace domain function Udpz; xq.
The results in this section only require the analyticity radius λU of the Laplace domain solution. While in principle
the results could therefore also be applied to Runge-Kutta methods, precise estimates of the analyticity radius are
only available for the multistep case.

Using the analyticity of the frequency solution, we can get the following exact error representation.
THEOREM 4.1. Let ud and uNf
d
analyticity of Ud as deﬁned in Theorem (3.3). For the error uNf

be deﬁned by (2.10) and (2.11). Let 0 ă λ ă λU , where λU is the radius of

d ptn; xq ´ udptn; xq we have

(4.1)

d ptn; xq ´ udptn; xq “
uNf

λκNf udptn`κNf ; xq.

REMARK 4.2. This error representation is well known in the context of trapezoidal rule approximations of ana-
lytic functions. However, it highlights immediately that a CQ approximation is accurate either if λ is sufﬁciently
small or if the wave at time step udptn; xq and all subsequent time steps have already left the area of observation,
that is the values of x we are interested in.
Proof. We choose 0 ă λ ă λU . Then Ud is analytic in the disc of radius λ, and it can be expanded as a Taylor
series

8ÿ

κ“1

8ÿ

n“0

cnzn

(4.2)

Udpz; xq “

8

Then, inserting (4.2) into (2.11), it follows that

ż

|z|“λ

Udpz; xq
zn`1 dz “ udptn; xq.

8ÿ

κ“0

λκNf udptj`κNf ; xq

(cid:96) “

udptn; xqzn´j
8ÿ

λκNf udptj`κNf ; xq,

κ“1

λκNf Nf
0

if p “ j ` κNf , κ P N,
otherwise.

with coefﬁcients

(4.3)

(4.4)

since by aliasing

d ptj; xq “ 1
uNf
Nf

cn “ 1
2πi
Nfÿ

8ÿ

(cid:96)“1

n“0
“ udptj; xq `
#
Nfÿ

zp´j
(cid:96) “

(cid:96)“1

ˇˇˇuNf

ˇˇˇ . We ﬁrst need to obtain a bound on the time-domain values udptn; xq. We have the

In order to determine the asymptotic rate of convergence of this CQ method, we have to bound the error
d ptn; xq ´ udptn; xq
following Lemma.
LEMMA 4.3. Let the radius of analyticity λU of Udpz; xq be deﬁned as in Theorem 3.3. Then for any 0 ă ˆλ ă λU
we have

(4.5)

It therefore follows that

|udptn; xq| ď max
|z|“ˆλ
`

|udptn; xq| “ O

|Udpz; xq|ˆλ´n
˘

pλU ´ q´n

for any  ą 0 arbitrarily small.
Proof. Since Udpz; xq is analytic with respect to z inside every closed disk of radius ˆλ ă λU , the value of the
integrand in (4.3) is independent of ˆλ, and we can estimate

|udptn; xq| “ |cn| ď max
|z|“ˆλ

|Udpz; xq|ˆλ´n.

The second statement follows by choosing ˆλ arbitrarily close to λU .
REMARK 4.4. The result in Lemma 4.3 is reminiscent of classical energy decay estimates for the wave equation
with zero Dirichlet conditions and nonzero initial conditions in the exterior of a non-trapping obstacle. Let S
be a sphere of radius R such that S surrounds Ω and the support of the initial data is contained in S. Let
}upt;¨q}E,R :“
be the local energy in SzΩ and }up0;¨q}E the total energy of
the initial data in S.
In [26] it is shown that

”ş
SzΩ |∇upt; xq|2 ` |utpt; xq|2

ı

1{2

}upt;¨q}E,R ď Ce´βt}upt;¨q}E

for C, β ą 0.
The estimate in Lemma 4.3 is an asymptotic estimate as n Ñ 8 and does not depend on whether Ω is trapping
or not. It only depends on the location of the resonances and the behaviour of the Dirichlet boundary data. Note
also that if λU ă 1 then Lemma 4.3 becomes a growth estimate. This is for example the case if g is exponentially
growing in time. We also note that the transient behaviour of udptn; xq may look rather different, for example in

9

CλU

pole

γp
zqc

λ

∆

U

t

γpλzq
c∆t

Cλ

FIGURE 4.1. Contour for the contour integral with the backward Euler scheme, closest pole to the contour and λ and λU .

multiple scattering conﬁgurations. The transient behaviour depends on the geometry and the evaluation point x
of the time-domain solution.
Combining Lemma 4.3 and Theorem 4.1, we can bound the error
THEOREM 4.5. Let 0 ă λ ă λU . Then

d ptn; xq ´ udptn; xq

ˇˇˇ as n Ñ 8.

ˇˇˇuNf

ˇˇˇuNf

˜ˆ

ˇˇˇ “ O

¸

˙´Nf

d ptn; xq ´ udptn; xq

´ 

λU
λ

ˇˇˇuNf

as Nf Ñ 8.
Proof. Let 0 ă λ ă ˆλ ă λU . Inserting (4.5) into (4.1), we obtain
¯
´
λκNf|udptn`κNf ; xq|
´
1 ´

d ptn; xq ´ udptn; xq

|Udpz; xq|ˆλ´n

ď max
|z|“ˆλ

ˇˇˇ ď

8ÿ

(4.6)

κ“1

λ
ˆλ

Nf

¯

λ
ˆλ

Nf

˜ˆ

“ O

´ 

λU
λ

¸

˙´Nf

for any  ą 0 as Nf Ñ 8 since we can choose ˆλ arbitrarily close to λU .
REMARK 4.6. The analysis shows that we can increase the rate of convergence by choosing λ small. However,
while the rate of convergence indeed increases, choosing λ too small creates numerical instabilities that limit the
achievable accuracy, as indicated in [2, Subsection 4.2] and also demonstrated in Figure 6.1(b).
Theorem 4.5 is depicted again in Figure 4.1 for the case of backward Euler, where γpzq “ 1 ´ z. The rate of
convergence depends on the relative distance of the closest pole to Cλ the red circle with radius λ.

5. Boundary integral formulations of the frequency domain problem. The frequency domain problem
(2.6) is posed in an unbounded domain. In order to solve it numerically, we need to formulate a problem on a
bounded domain, either by using boundary integral formulations or by discretising a ﬁnite domain together with
an absorbing boundary condition such as Perfectly Matched Layers (PML) [18] or Hardy space inﬁnite elements
[19]. Both introduce additional poles in the solution operator. A PML layer will lead to an additional continuous
spectrum from zero to inﬁnity [20]. Boundary integral formulations have resonances, which are related to the
corresponding interior problems. Hence, the convergence results depicted in Section 4 depend not only on the
scattering poles, but also on the poles introduced by the formulation of the frequency domain problem on a ﬁnite
domain.
This section gives an overview of possible integral equation formulations for the frequency domain problem and
discusses how these formulations introduce additional poles into the solution operator. The frequency domain

10

problem is a modiﬁed Helmholtz problem of the form

(5.1)

#

ω2Upxq ´ ∆Upxq “ 0, x P Ω`,
Upxq “ Gpxq,
x P Γ,

ż

ż

ż

ż

with ω P C and outgoing boundary conditions towards inﬁnity as described in Section 2. The Green’s function
associated with the modiﬁed Helmholtz problem is gωpx, yq :“ e´ω|x´y|
4π|x´y| .
We deﬁne the single and double layer potential operators for the modiﬁed Helmholtz equation as

rSωφspxq “

gωpx, yqφpyqdspyq,

rKωφspxq “

Γ

Γ

B
Bnpyq gωpx, yqφpyqdspyq,

x P Ω`.

Both operators satisfy the modiﬁed Helmholtz equation in the exterior of the domain. We also need the single
layer boundary operator Sω and the double layer boundary operator Kω deﬁned by

Γ

rSωφspxq “

gωpx, yqφpyqdspyq,

rKωφspxq “
Let γ0 be the exterior trace operator. Then Sω “ γ0Sω and 1
Details of mapping properties for these operators can be found in [16].
In this paper we only consider indirect boundary integral formulations. The results for direct boundary integral
formulations are very similar.

2 I ` Kω “ γ0Kω, where I is the identity operator.

x P Γ.

B
Bnpyq gωpx, yqφpyqdspyq,

Γ

5.1. Indirect ﬁrst kind integral formulation. An integral formulation of the ﬁrst kind to solve the modiﬁed

Helmholtz equation (5.1) for a given parameter ω P C is given by
x P Γ,
(5.2)
The solution in the exterior Ω` is then obtained as U “ Sω ˝ S´1
ω G. This representation holds for all ω such
that iω ‰ kj and iω ‰ pj, where the pj are the scattering poles as deﬁned in Theorem 3.1, and the kj are the
eigenfrequencies of the interior Dirichlet eigenvalue problem, satisfying
j vpxq, x P Ω,
x P Γ,

rSωφspxq “ Gpxq,
#

´∆vpxq “ k2
vpxq “ 0,

for some nonzero v P H 1pΩq (see [15]). The situation is depicted in Figure 5.1(a) for the case of backward Euler
and a unit sphere as domain. The red dots show the Dirichlet eigenvalues closest to the contour given by the
time-stepping rule.

5.2. Indirect second kind integral formulation. Using an indirect second kind formulation, we obtain the

integral equation

(5.3)

„ˆ

˙



I ` Kω

1
2

pxq “ Gpxq,

φ

x P Γ,
`

˘´1

which gives the representation of the exterior solution in Ω` as U “ Kω
Similar to the case of the indirect ﬁrst kind formulation, this representation is valid for all ω such that iω ‰ pj
and iω ‰ µj, where the µj are the eigenfrequencies of the interior Neumann eigenvalue problem, satisfying

2 I ` Kω

G.

1

$&%´∆v “ µ2v

“ 0

Bv
Bn

in Ω,
on Γ,

for some v P H 1pΩq. We recall that n is the outgoing normal to Ω. However, since 0 is always an eigenvalue
of the interior Neumann eigenvalue problem, the value ω “ 0 is always a pole for the representation as indirect

11

second kind integral equation. Suppose that we use backward Euler as time-stepping rule. Then γpzq “ 1 ´ z,
and if the Z-transform of the boundary data has a sufﬁciently large radius of analyticity, it follows that λU “ 1.
Applying Theorem 4.5, we obtain the simple convergence estimate

d ptn; xq ´ udptn; xq

pλ ` qNf

(5.4)
for any  ą 0 and λ ă 1. Figure 5.1(b) shows the location of the poles with respect to the contour given by the
backward Euler rule for the case of the indirect second kind formulation. The pole at zero is always closest to the
contour and dominates the convergence behaviour.

´

ˇˇˇ “ O

¯

ˇˇˇuNf

(a) First Kind Integral Formulation.

(b) Second Kind Integral Formulation.

FIGURE 5.1. Poles located near the contour for the indirect ﬁrst and second kind integral formulations.

5.3. Indirect combined integral formulation. The indirect formulation of the second kind always has a
pole at zero while the indirect formulation of the ﬁrst kind has a pole related to the ﬁrst eigenvalue of the interior
Dirichlet problem. It is therefore sensible to consider a combined formulation to try to push away the smallest
magnitude pole introduced by the boundary integral formulation. A combined formulation to solve (5.1) takes
the form

(5.5)

φpxq “ Gpxq,

x P Γ.

The representation of the solution in Ω` is therefore given by

„



1
2

I ` Kω ` ηSω
ˆ

U “ rKω ` ηSωs

I ` Kω ` ηSω

1
2

˙´1

G.

The following result is a reformulation of [14, Theorem 3.33] for the modiﬁed Helmholtz equation (5.1).
THEOREM 5.1. Let η ‰ 0 with Retηu “ 0 and ImtηuImtωu ě 0. Then the combined formulation (5.5) is
uniquely solvable for all frequencies ω satisfying Retωu ě 0.
In addition to singularities at the scattering poles, the combined formulation has resonances at the eigenfrequen-
cies ν of the modiﬁed interior impedance eigenvalue problem
´∆v “ ´ν2v
BvBn ` ηv “ 0

in Ω,
on Γ

#

(5.6)

for some v P H 1pΩq. For real η it can be readily seen that all eigenfrequencies ν lie on the imaginary axis.
Moreover, as η Ñ 0 the smallest eigenfrequency ν approaches 0 since η “ 0 corresponds to the Neumann case.
For η Ñ 8 the smallest eigenfrequency ν approaches the smallest eigenfrequency of the Dirichlet case.

12

42024Re42024Im42024Re42024ImIf Imtηu ą 0, then by Theorem 5.1 and the fact that if ν is an eigenfrequency, then also ´ν is an eigenfrequency,
it follows that the interior impedance eigenvalues can only be located in the lower right quadrant and in the upper
left quadrant of the complex plane. Hence, singularities can occur close to or in the interior of the contour deﬁned
by the values γpzq
c∆t , |z| “ λ. This is demonstrated in Figure 5.2(a) for η “ i. We now have a pole inside the
contour given by the backward Euler rule, and we have to modify the contour (e.g. by choosing λ ă 1) to remedy
the situation.
To avoid this problem, one strategy is to choose η “ ω in (5.5). The mapping properties of the resulting combined
ﬁeld operator were analysed in [25]. There it is shown that the combined potential operator has a bounded L2
inverse for all wavenumbers satisfying Retωu ą 0. The corresponding situation is depicted in Figure 5.2(b). The
location of poles in this combined formulation is not symmetric any more. However, as in the case of the second
kind integral formulation, we still have a pole at zero. Hence, for the asymptotic rate of convergence of the CQ
approximation for the backward Euler rule there is no difference between the second kind formulation and the
combined formulation with η “ ω.

(a) Combined Integral Formulation with η “ i

(b) Combined Integral Formulation with η “ ω

FIGURE 5.2. Poles located near the contour for two different combined integral formulations for the scattering by the unit sphere.

6. Numerical results. In this section we demonstrate the numerical behaviour of the CQ method as the

number of frequencies Nf is increased for ﬁxed time Nt. The model problem is the acoustic wave equation

$’’’&’’’%

B2u
Bt2 pt; xq ´ c2∆xupt; xq “ 0, x P Ω`,
up0; xq “ Bu
p0; xq “ 0,
x P Ω`,
Bt
upt; xq “ gpt; xq,
x P Γ,
ˆ
ˆ
t ´ d ¨ x

˙

˙

2π

f

e´pt´tp´ d¨x
c q2

2σ2

,

gpt; xq “ ´ cos

c

(6.1)

with boundary condition

(6.2)

Here, we use the parameters tp “ 10´3, σ “ 6
2000π , c “ 343, d “ p1, 0, 0qt. The ﬁnal time is Tf “ 20¨ 10´3 and
the number of time steps is Nt “ 40. We recall that gptn; xq decreases exponentially as n Ñ 8. Hence, for the
radius of analyticity λG of the Z-transform of the boundary data we obtain λG “ 8 and according to Theorem
3.3, λU “ λB with λB deﬁned by (3.1). In the ﬁrst part of this section Ω will be the unit sphere in R3. Later, we
will present results for a more challenging trapping domain.
We evaluate the time-domain solution in the observation domain

!
x P r´3, 3s, y P r´3, 3s, z “ 0;

)
a
x2 ` y2 ą 1

.

Ωobs “

13

42024Re42024Im42024Re42024ImThe maximum pointwise error in Ωobs is measured as

(6.3)

AbsDiffpNfq “ max
nPr0,Nts

d ptn; xq ´ urefptn; xq

›››uNf

›››

L8pΩobsq .

Reference solutions are computed by using a very high number of frequencies Nf in the Laplace domain. All
numerical results in this section were computed using the boundary element package BEM++ (www.bempp.
org) [28].

6.1. Validation of the theoretical rate of convergence. We ﬁrst compare the predicted rate of convergence
in Theorem (4.5) with the observed convergence in the case of the indirect second kind integral formulation (5.3)
and backward Euler time-stepping rule. The location of the poles for this formulation was depicted in Figure
5.1(b). The pole at zero dominates the convergence. Comparisons of the theoretical estimated rate of convergence
and the measured decay of AbsDiffpNfq for various λ are shown in Figure 6.1(a). There is a very close match
between the theoretical estimate and the achieved rate of convergence. It is interesting to consider the point
Nf “ Nt, where we have the same number of frequency domain solves as there are time-steps. This corresponds
to previously proposed CQ methods. As expected, the error becomes smaller at this point as λ decreases. However,
for very small λ the convergence soon starts to level off due to numerical instabilities with small λ. This is further
shown in Figure 6.1(b), where the maximum achievable accuracy in dependence of λ is demonstrated for the
second kind formulation.

¯
We now demonstrate how the rate of convergence changes for different coupling coefﬁcients in the combined
integral formulation (5.5). We ﬁx λ “ 0.95. Figure 6.2(a) shows the convergence for constant real η “ 1. In this
Nf « 0.9182Nf , whereas for the standard
case we have λU « 1.0346 and therefore a convergence rate of
second kind formulation we would only expect a rate of convergence of 0.95Nf . The combined formulation with
η “ ω converges with a rate of 0.95Nf , the same rate as the second kind formulation, as shown in Figure 6.2(b).
However, comparing Figure 6.2(b) and 6.1(a) it becomes obvious that the combined formulation with η “ ω is
signiﬁcantly more accurate than the second kind formulation for the same number of frequencies. Indeed, at the
point Nf “ Nt we have an error of 3.106 ¨ 10´1 for the second kind formulation and an error of 8.572 ¨ 10´3 for
the combined formulation. Hence, in practice the combined formulation may be preferable.
When η “ i and λ “ 0.95, there is a pole inside the contour and so Theorem 4.5 is no longer usable, but the
solution still seems to converge when Nf Ñ 8, as demonstrated in Figure 6.3. However, the rate of convergence
does not seem to be exponential.

´

λ
λU

6.2. Comparison of the rate of convergence for backward Euler and BDF-2. It is interesting to compare
backward Euler with BDF-2 as Nf Ñ 8. Figure 6.4(a) depicts the contour for backward Euler and BDF-2.
We observe that the pole is closer to the BDF-2 contour than to the backward Euler contour. Hence, the rate of
convergence of the convolution quadrature approximations to the exact time-stepping values will be slower for
BDF-2 than for backward Euler, unless the pole is at zero, in which case both rates of convergence are identical.

Figure 6.4(b) conﬁrms this by presenting the measured and the theoretical rate of convergence for these two
schemes using a combined integral formulation with η “ 20 and λ “ 0.9. In the case of backward Euler we have
λU « 1.1318 and for BDF-2 λU « 1.0118. We note, however, that BDF-2 is still a signiﬁcantly more accurate
scheme for the solution of the underlying wave equation, as it is second order in time, while backward Euler is
only ﬁrst order accurate.

6.3. Trapping domain. Until now, we were studying the solution of problem (6.1) when Ω is the unit
sphere. We now consider the elliptic cavity shown in Figure 6.3. It is a three dimensional version of the elliptic
cavity studied in [10]. For the two dimensional case it was shown in that paper that there exists a sequence
of wavenumbers along the real axis for which the norm of the combined potential operator for the Helmholtz
equation grows exponentially.

“
For the three dimensional elliptic cavity it is not possible to evaluate explicitly the poles of the solution op-
erator. Denote by Apωq the matrix obtained from a Galerkin discretisation of the combined potential opera-
on the boundary Γ of the trapping domain. Let M be the associated mass matrix and
tor

2 I ` Kω ` ηSω

‰

1

14

(a) Theoretical and numerical results for the scattering by the unit sphere using the
indirect second kind integral formulation.

(b) Limit of achievable accuracy when λ is small for the unit sphere using the
indirect second kind integral formulation.

FIGURE 6.1. Convergence on the unit sphere for the indirect second kind integral equation.

M “ CC H its Cholesky decomposition. Then a simple way to have an idea of the location of the poles is to plot

››C´1Apωq´1C´H

››

2 .

››A´1pωq

››
L2pΓq “

ppωq “

If z is a pole, then ppωq Ñ 8 when ω Ñ z. We used η “ 1 in order to have poles on the imaginary axis. Figure
6.6(a) shows ppωq for ω P r0, 4is and allows to ﬁnd the closest pole z1 « 1.7718i, giving an estimated rate of
convergence of 0.90896Nf for backward Euler. The observed rate of convergence in 6.6(b) matches very closely
this predicted rate. Figure 6.7 provides snapshots of the corresponding time-domain solution at four different time
steps.

6.4. Convergence of Runge-Kutta methods. We solve problem (6.1) with incident wave (6.2), but this
time using the Radau IIa Runge-Kutta method. We use a combined integral formulation with η “ ω. Hence, for
the scalar problem zero is the closest pole. The interesting question is how the vector Helmholtz problem (3.3)
underlying the Radau IIa formulation inﬂuences the rate of convergence, and in particular whether the singularity

15

0100200300400500600N_f, Number of frequencies10-1510-1410-1310-1210-1110-1010-910-810-710-610-510-410-310-210-1100Absolute differenceNt=Nfλ = 0.950.900.850.800.750.700.65Theory050100150200250300N_f, Number of frequencies10-1410-1210-1010-810-610-410-2100102104Absolute differenceNt=Nfλ = 0.900.850.800.75(a) Absolute difference for the unit sphere using the indirect combined
integral formulation with real combining coefﬁcient η “ 1.

(b) Absolute difference for the unit sphere using the indirect combined
integral formulation with varying coefﬁcient η “ ω.

FIGURE 6.2. Two indirect combined integral formulations.

FIGURE 6.3. Convergence of the numerical solution when a pole is inside the contour (case η “ i and λ “ 0.95).

?

of the eigenvalue decomposition of ∆pzq at z “ 3
3 ´ 5 is reﬂected in the observed convergence rate. Figures
6.8(a) and 6.8(b) show the absolute difference between the numerical solutions obtained for different numbers
of frequencies and a reference result computed with a large number of frequencies, respectively for λ “ 0.90
and λ “ 0.95. It is interesting to observe that the convergence consists of two phases: an initial phase with
a signiﬁcantly faster rate of convergence and then an asymptotic (at least to machine precision) behaviour that
shows the same rate of convergence as we would expect for the corresponding scalar solution operator. Hence, the
3 ´ 5 does not seem to inﬂuence the convergence
singularity of the eigenvalue decomposition of ∆pzq at z “ 3
behavior. At a much smaller scale, the initial superconvergence behavior can also be observed for the multistep
case in Figure 6.3. Our current asymptotic analysis does not explain these transient phenomena.

?

6.5. Stability of the solution. While previously we considered the rate of convergence of the convolution
to the exact time stepping solution ud for various boundary integral formulations,
to the exact solution u for different

quadrature approximation uNf
d
we want to conclude the numerical examples with a comparison of uNf
d
boundary integral formulations.
We use a boundary condition of the form

(6.4)

fptq “ bpatqme´pt,

16

050100150200250300350Nf10-1510-1310-1110-910-710-510-310-1101Absolute differenceNt=NfAbs. Difference(λ/λU)Nf0100200300400500600Nf10-1510-1310-1110-910-710-510-310-1101Absolute differenceNt=NfAbsolute Difference0.95Nf0100200300400500600Nf10-410-310-210-1100101Absolute differenceNt=NfAbsolute Difference(a) Contour used for backward Euler (black) and BDF-2
(blue).

(b) Absolute difference of the backward Euler and BDF-2 schemes.

FIGURE 6.4. Comparisons between the backward Euler and BDF-2 schemes.

FIGURE 6.5. Geometry of the trapping domain.

to get the exact radiating solution

(6.5)

uepr, tq “ bH

ˆ
t ` 1 ´ r

c

˙ˆ

a

˙˙

ˆ
t ` 1 ´ r

c

m

e´ ppt` 1´r
c q

r

,

where H denotes the Heaviside function. We use the 2-stages Runge-Kutta Radau IIa scheme to discretize in
time and 4 different integral formulations:

‚ an indirect ﬁrst kind integral formulation, see (5.2), denoted SL,
‚ a second kind integral formulation, see (5.3), denoted DL,
‚ an indirect combined integral formulation, see (5.5), with η “ 1,
‚ an indirect combined integral formulation, see (5.5), with η “ ω, the wavenumber.

The numerical comparison is performed using the boundary condition (6.4) with a “ 25, b “ 300, m “ 10 and
p “ 150 and evaluating the solution at points located on a circle of radius 1.1. The ﬁnal time is Tf “ 0.30. We
use Nt “ 80 time steps and λ “ 0.95. To demonstrate the inﬂuence of the number of frequency solves on the
number of time steps we performed the computation with Nf “ 100 and Nf “ 400 frequency solves.
In Figure 6.9 we compare the error of the numerically computed solution to the exact solution for growing time
t. It is remarkable that the two formulations with a pole at the origin (DL and η “ w) deteriorate quickly while

17

20406080100120140160180Nf10-1610-1410-1210-1010-810-610-410-2100102Maximum absolute differencetNt=tNfAbs. Diff backward EulerAbs. Diff BDF2Theory backward EulerTheory BDF2(a) L2-norm of the inverse of the combined potential along the imag-
inary axis.

(b) Convergence of the solution for the elliptic cavity.

FIGURE 6.6. Trapping domain: Location of the nearest pole and absolute difference using an indirect combined formulation with
η “ 1 and backward Euler. The closest pole is located at 1.7718i and therefore λU « 1.045, giving a predicted rate of convergence of
pλ{λUqNf « 0.90896Nf .

the two solutions with poles away from 0 have a small relative error throughout the observed time interval. This
behavior is independent on wheter we choose Nf “ 100 or Nf “ 400. The bottom plot shows as comparison the
absolute error for Nf “ 400. It shows that as the analytical solution converges to zero the DL and η “ ω case
remain bounded away from zero.
Figure 6.9 also nicely demonstrates the inﬂuence of the error of the underlying time-stepping scheme. For Nf “
100 the error of the η “ 1 formulation is larger than that of the SL formulation. However, for Nf “ 400
both errors are identical and indeed there is no difference in error for the SL formulation between Nf “ 100
and Nf “ 400. This means that already for Nf “ 100 frequencies the best possible error is achieved for the
SL formulation, given the underlying time-stepping scheme. In contrast, for the η “ 1 scheme the convolution
quadrature approximation introduces errors that are larger than the underlying time-stepping rule for Nf “ 100,
while again for Nf “ 400 the error of the time-stepping scheme seems to dominate.

7. Conclusion. Convolution quadrature methods have become a popular tool to solve wave propagation
problems in unbounded domains. In this paper we have shown how the convergence of convolution quadrature
methods depends on the location of the poles of the underlying solution operator. It therefore makes a signiﬁcant
difference whether we use a ﬁrst kind, second kind or combined integral equation formulation. The numerical
convergence results together with the comparison to the analytical solution in Figure 6.9 demonstrate the impor-
tance of the location of the poles of the solution operator. Indeed, the results in this paper are only a ﬁrst step
to fully understand the inﬂuence of the poles of the frequency problems on the numerical approximation of the
time-domain solution.

An interesting aspect of these results is that although for a purely theoretical analysis only the scattering poles of
the solution operators are relevant, in practice we need to reduce the exterior domain onto a problem on a ﬁnite
domain, either by using a boundary integral formulation, or by introducing a PML layer. Both lead to additional
poles that usually dominate the rate of convergence, as we have discussed in the case of a boundary integral
equation formulation.

An import practical conclusion from the results in this paper is that it may be useful to overresolve in the frequency
domain by computing more frequency solutions than there are time steps. This is important if the overall error is
dominated not by the underlying time-stepping rule, but by the convolution quadrature approximation as depicted
in the comparison of the error results for Nf “ 100 and Nf “ 400 in Figure 6.9.
Extensions of this current work to Maxwell problems are currently under investigation. Finally, all results in
this paper have been computed using the freely available boundary element library BEM++ (www.bempp.

18

050100150200250300Nf10-1410-1210-1010-810-610-410-2100Absolute differenceNt=NfAbsolute differenceTheory(a) Time-domain solution at time 0.0045s.

(b) Time-domain solution at time 0.0075s.

(c) Time-domain solution at time 0.01s.

(d) Time-domain solution at time 0.0125s.

FIGURE 6.7. Solution of the scattering by the sphere with the elliptic cavity with backward Euler (Figure 6.3) in the plane z “ 0 for

different time steps with η “ 1 using Nf “ 300, Nt “ 40, Tf “ 20 ¨ 10´3s and λ “ 0.95.

org), which provides a Python based interface to solve Laplace, Helmholtz and Maxwell boundary integral
formulations. A time-domain toolbox for BEM++ is in planning.

Acknowledgements. The authors would like to thank Lehel Banjai from Heriot-Watt University Edinburgh
and Peter Monk and Francisco Javier-Sayas, both in Delaware, for introducing them to this topic and for many
fruitful discussions on convolution quadrature methods and the results of this paper.

Appendix A. The 2-stages Runge-Kutta Radau IIa scheme. A Runge-Kutta scheme can be described by its
Butcher tableau of the form

(A.1)

a1,m
a2,m
...
am,m
bm
where b, c P Rm and A P Rmˆm, with m the number of stages, and by

c1
a1,2
a2,2
c2
...
...
cm am,1 am,2
b2

. . .
. . .
...
. . .
. . .

a1,1
a2,1
...

b1

ˆ

(A.2)

∆pzq “

,

˙´1

1bt

A ` z
1 ´ z
19

(a) Convergence for λ “ 0.90.

(b) Convergence for λ “ 0.95.

FIGURE 6.8. Convergence of the solution obtained with a 2-stages Radau IIa Runge-Kutta scheme for the Combined integral formula-

tion with η “ ω for the scattering by the unit sphere for two different radii of the contour.

with 1 “ p1, . . . , 1qt P Rm. The 2-stages Radau IIa scheme of order three is deﬁned by the tableau of the form

(A.3)

1{3
1

5{12 ´1{12
3{4
1{4
3{4
1{4

.

We can diagonalize ∆pzq explicitly when z ‰ 3

?

∆pzq “ PpzqDpzqP´1pzq with Dpzq “ diagpγ1pzq, γ2pzqq

and

(A.4)

3 ´ 5:
a
a

γ1pzq “ 2 ` z ´
γ2pzq “ 2 ` z `

´2 ` 10z ` z2
´2 ` 10z ` z2

In case of higher order Radau IIa schemes it is not possible to obtain an explicit diagonalization for each z and
the eigenvalues, and eigenvectors need to be approximated numerically.

REFERENCES

[1] J. BALLANI, L. BANJAI, S. SAUTER, AND A. VEIT, Numerical solution of exterior Maxwell problems by Galerkin BEM and Runge–

Kutta convolution quadrature, Numerische Mathematik, 123 (2013), pp. 1–28.

[2] LEHEL BANJAI, Multistep and multistage convolution quadrature for the wave equation: Algorithms and experiments, SIAM J. Sci.

[3] L. BANJAI AND M. KACHANOVSKA, Fast convolution quadrature for the wave equation in three dimensions, Journal of Computa-

[4] LEHEL BANJAI AND CHRISTIAN LUBICH, An error analysis of Runge–Kutta convolution quadrature, BIT Numerical Mathematics,

Comput., 32 (2010), pp. 2964–2994.

tional Physics, 279 (2014), pp. 103–126.

51 (2011), pp. 483–496.

[5] LEHEL BANJAI, CHRISTIAN LUBICH, AND JENS MARKUS MELENK, Runge–Kutta convolution quadrature for operators arising in

wave propagation, Numerische Mathematik, 119 (2011), pp. 1–20.

[6] LEHEL BANJAI, MATTHIAS MESSNER, AND MARTIN SCHANZ, Runge–Kutta convolution quadrature for the boundary element

method, Computer Methods in Applied Mechanics and Engineering, 245 (2012), pp. 90–101.

[7] LEHEL BANJAI AND STEFAN SAUTER, Rapid solution of the wave equation in unbounded domains, SIAM J. Numerical Analysis, 47

[8] LEHEL BANJAI AND MARTIN SCHANZ, Wave propagation problems treated with convolution quadrature and BEM, in Fast Boundary

Element Methods in Engineering and Industrial Applications, Springer, 2012, pp. 145–184.

[9] JEAN-PIERRE BERENGER, A perfectly matched layer for the absorption of electromagnetic waves, Journal of Computational Physics,

(2008), pp. 227–249.

114 (1994), pp. 185–200.

20

20406080100120140160180200Nf10-1610-1410-1210-1010-810-610-410-2100Absolute differenceNt=NfAbsolute Difference0.90Nf2.86e−7∗0.90Nf050100150200250300350400Nf10-1610-1410-1210-1010-810-610-410-2100Absolute differenceNt=NfAbsolute Difference0.95Nf2.86e−7∗0.95NfFIGURE 6.9. Top: Analytic solution for r “ 1.1 and various time steps. Second ﬁgure: Relative error of various schemes for Nf “ 100

frequencies. Third Figure: The same as before but with Nf “ 400 frequencies. Bottom plot: Absolute error for Nf “ 400 frequencies.

[10] T. BETCKE, S. N. CHANDLER-WILDE, I. G. GRAHAM, S. LANGDON, AND M. LINDNER, Condition number estimates for com-
bined potential integral operators in acoustics and their boundary element discretisation, Numer. Methods Partial Differential
Equations, 27 (2011), pp. 31–69.

[11] DAVID J. CHAPPELL, A convolution quadrature Galerkin boundary element method for the exterior Neumann problem of the wave

equation, Mathematical Methods in the Applied Sciences, 32 (2009), pp. 1585–1608.

[12]

, Convolution quadrature Galerkin boundary element method for the wave equation with reduced quadrature weight computa-

tion, IMA Journal of Numerical Analysis, 31 (2011), pp. 640–666.

[13] Q. CHEN, P. MONK, X. WANG, AND D. WEILE, Analysis of convolution quadrature applied to the time-domain electric ﬁeld integral

equation., Communications in Computational Physics, 11 (2012), p. 383.

[14] DAVID COLTON AND RAINER KRESS, Integral equation methods in scattering theory, John Wiley & Sons Inc., New York, 1983.
[15]
[16] MARTIN COSTABEL, Boundary integral-operators on Lipschitz-domains – elementary results, SIAM J. Math. Anal., 19 (1988),

, Inverse acoustic and electromagnetic scattering theory, vol. 93, Springer-Verlag, Berlin, second ed., 1998.

pp. 613–626.

[17]

, Time-dependent problems with the boundary integral equation method, Encyclopedia of Computational Mechanics, (2004).

21

0.000.050.100.150.200.250.30t0.00.51.01.52.02.5Exact solution0.000.050.100.150.200.250.30t10-510-410-310-210-1100101102103104105106107Rel. err, Nf=1000.000.050.100.150.200.250.30t10-610-510-410-310-210-1100101102103104105106107Rel. err, Nf=4000.000.050.100.150.200.250.30t10-1610-1510-1410-1310-1210-1110-1010-910-810-710-610-510-410-310-2Abs. err,Nf=400SLeta=1DLeta=w[18] ISAAC HARARI, MICHAEL SLAVUTIN, AND ELI TURKEL, Analytical and numerical studies of a ﬁnite element PML for the Helmholtz

equation, Journal of Computational Acoustics, 8 (2000), pp. 121–137.

[19] THORSTEN HOHAGE AND LOTHAR NANNEN, Hardy space inﬁnite elements for scattering and resonance problems, SIAM Journal

[20] SEUNGIL KIM AND JOSEPH PASCIAK, The computation of resonances in open systems using a perfectly matched layer, Mathematics

on Numerical Analysis, 47 (2009), pp. 972–996.

of Computation, 78 (2009).

[21] ANTONIO R. LALIENA AND FRANCISCO-JAVIER SAYAS, Theoretical aspects of the application of convolution quadrature to scat-

tering of acoustic waves, Numerische Mathematik, 112 (2009), pp. 637–678.

[22] CHRISTIAN LUBICH, Convolution quadrature and discretized operational calculus. I, Numerische Mathematik, 52 (1988), pp. 129–

145.

[23]
[24]

, Convolution quadrature and discretized operational calculus. II, Numerische Mathematik, 52 (1988), pp. 413–425.
, On the multistep time discretization of linear initial-boundary value problems and their boundary integral equations, Nu-

merische Mathematik, 67 (1994), pp. 365–389.

[25] PETER MONK AND QIANG CHEN, Discretization of the time domain CFIE for acoustic scattering problems using convolution quadra-

ture, SIAM Journal on Mathematical Analysis, 46 (2014), pp. 3107–3130.

[26] CATHLEEN S. MORAWETZ, JAMES V. RALSTON, AND WALTER A. STRAUSS, Decay of solutions of the wave equation outside

nontrapping obstacles, Communications on Pure and Applied Mathematics, 30 (1977), pp. 447–508.

[27] ACHIM SCH ¨ADLE, MAR´IA L ´OPEZ-FERN ´ANDEZ, AND CHRISTIAN LUBICH, Fast and oblivious convolution quadrature, SIAM J.

Scientiﬁc Computing, 28 (2006), pp. 421–438.

[28] WOJCIECH ´SMIGAJ, TIMO BETCKE, SIMON ARRIDGE, JOEL PHILLIPS, AND MARTIN SCHWEIGER, Solving boundary integral

problems with BEM++, ACM Transactions on Mathematical Software, 41 (2015), pp. 6:1–6:40.

[29] M. E. TAYLOR, Partial Differential Equations II: Qualitative Studies of Linear Equations, 2nd Edition, Springer, 2010.
[30] LLOYD N. TREFETHEN AND J. A. C. WEIDEMAN, The exponentially convergent trapezoidal rule, SIAM Review, 56 (2014).

22

